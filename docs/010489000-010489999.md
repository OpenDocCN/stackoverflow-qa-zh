# StackOverflow 问答 10489000-10489999

# r - 如何创建类似于 R 中的 Windows 探索的目录结构？

> ID：10489002
> 
> 赞同：-6
> 
> 时间：2012-05-07T20:55:42.827
> 
> 标签：r

我正在尝试使用 R 创建一个目录结构，其中包含类似于 Windows 资源管理器的文件夹。有人可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:31:34.363

如果您希望它用于可视化 R 中的内容，而不是磁盘上的目录（在这种情况下，您可以使用`choose.dir`建议的或类似的工具），然后查看包中的`TkListView`函数，`TeachingDemos`看看这是否是您想要的功能。如果`TkListView`函数本身没有做你想要的，但给出了正确的显示，那么你可以查看函数的代码（它只是 R 代码，除了 Tk 调用），看看你是否可以修改它来做什么你要。

# python - plotting / wxPython - 为什么调用 MemoryDC.SelectObject() 很慢？

> ID：10489012
> 
> 赞同：1
> 
> 时间：2012-05-07T20:56:36.593
> 
> 标签：python, wxpython, plot, matplotlib, real-time

我正在尝试在使用 wxPython 的“生产”应用程序中实时绘制 matplotlib 中的数据。我一直为此目的使用 Chaco，但出于多种原因，我试图在未来避免使用 Chaco，其中一个原因是，由于它没有很好的文档记录，因此我经常必须在需要时花很长时间阅读 Chaco 源代码甚至将最小的特征添加到我的一个情节中。Chaco 胜过 matplotlib 的一个方面是速度，所以我正在探索从 matplotlib 获得可接受性能的方法。

我在 matplotlib 中看到广泛用于快速绘图的一种技术是设置`animated`为`True`您希望经常更新的绘图元素，然后只绘制一次背景（轴、刻度线等），并使用该`canvas.copy_from_bbox()`方法保存背景。然后，在绘制新`foreground`的（绘图轨迹等）时，您`canvas.restore_region()`只需将预渲染的背景复制到屏幕上，然后将新的前景与`axis.draw_artist()`它一起绘制`canvas.blit()`到屏幕上。

我编写了一个相当简单的示例，将 FigureCanvasWxAgg 嵌入到 wxPython 框架中，并尝试以 45 FPS 的速度显示随机数据的单个跟踪。当程序以默认大小的帧（在我的源代码中硬编码）运行时，它在我的机器上达到每秒约 13-14 帧。当我最大化窗口时，刷新率下降到 5.5 FPS 左右。我认为这对我的应用程序来说不够快，尤其是当我开始添加要实时渲染的其他元素时。

我的代码发布在这里：[basic_fastplot.py](https://gist.github.com/2630258)

我想知道这是否可以更快，所以我分析了代码，发现到目前为止，处理时间的最大消耗者是对`canvas.blit()`第 99 行和第 109 行的调用。我进一步挖掘，检测 matplotlib 代码本身以发现最这段时间花在了对`MemoryDC.SelectObject()`. 在周围的代码中有几个调用`SelectObject`，但只有下面标记的一个需要任何可观的时间。

来自 matplotlib 源代码 backend_wxagg.py：

```
class FigureCanvasWxAgg(FigureCanvasAgg, FigureCanvasWx):
    # ...

    def blit(self, bbox=None):
    """
    Transfer the region of the agg buffer defined by bbox to the display.
    If bbox is None, the entire buffer is transferred.
    """
    if bbox is None:
        self.bitmap = _convert_agg_to_wx_bitmap(self.get_renderer(), None)
        self.gui_repaint()
        return

    l, b, w, h = bbox.bounds
    r = l + w
    t = b + h
    x = int(l)
    y = int(self.bitmap.GetHeight() - t)

    srcBmp = _convert_agg_to_wx_bitmap(self.get_renderer(), None)
    srcDC = wx.MemoryDC()
    srcDC.SelectObject(srcBmp)          # <<<< Most time is spent here, 30milliseconds or more!

    destDC = wx.MemoryDC()
    destDC.SelectObject(self.bitmap)

    destDC.BeginDrawing()
    destDC.Blit(x, y, int(w), int(h), srcDC, x, y)
    destDC.EndDrawing()

    destDC.SelectObject(wx.NullBitmap)
    srcDC.SelectObject(wx.NullBitmap)
    self.gui_repaint() 
```

我的问题：

*   SelectObject() 会花这么长时间做什么？我有点假设它只是设置指针等，而不是做太多的复制或计算。
*   有什么办法可以加快速度（全屏时可能达到 10 FPS）？

# swt - Java 类名在 SWT/JFace TableViewer 中出现乱码

> ID：10489015
> 
> 赞同：0
> 
> 时间：2012-05-07T20:56:54.383
> 
> 标签：swt, jface, tableviewer

我正在开发一个包含`TableViewer`. 这是我第一次尝试 RCP 应用程序，如果这是一个愚蠢的问题，请见谅。我在使用内容提供商的`inputChanged`方法时遇到了问题。表中的输入对象是`Strings`。这是我到目前为止的方法（场景是我的应用程序中的一个类，带有一个`displayData`方法）：

```
public void inputChanged(Viewer v, Object oldInput, Object newInput) {
    if (newInput != null) {
        String s = (String)newInput;
        Scenario.displayData(s);
    }
} 
```

当我运行它时，我得到以下异常：

> java.lang.ClassCastException: [Ljava.lang.String; 不能转换为 java.lang.String

类名是怎么乱码的？我尝试使用 打印出类名，`newInput.getClass().getName()`但仍然得到乱码版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:00:37.700

"[L" 表示它是一个字符串数组。

# ios - 此类不符合关键图像的关键值编码

> ID：10489017
> 
> 赞同：1
> 
> 时间：2012-05-07T20:57:08.790
> 
> 标签：ios

我收到以下 ios 崩溃

“此类不符合关键图像 1 的关键值编码”

我虽然已经删除了对“image1”的所有引用，但似乎没有。

无论如何我可以在整个项目中搜索任何此类引用（即使在笔尖中）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:27:08.007

通常，当我看到这个时，这是因为 NIB 连接。最简单的方法是在 Interface Builder 中打开 NIB，选择 Files Owner，然后选择连接检查器（实用程序视图中的 -> 按钮）。在那里，您可以看到与该对象建立的所有连接。您还可以在打开连接检查器的情况下遍历 NIB 中的所有项目，直到找到有问题的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:07:21.107

要在您的 nib/xib 中搜索，请右键单击它并选择“打开方式 --> 源代码”

不幸的是，我遇到过几次这个错误，我完全无法理清 Xcode。我首先尝试从您的代码中手动摆脱它。如果失败，请尝试关闭并重新打开 Xcode。如果失败，请尝试重新启动。如果失败，我认为您可能需要开始一个新项目并迁移您的代码。

这是一个非常糟糕的错误！

# c# - 使用 IDbConnection

> ID：10489018
> 
> 赞同：-1
> 
> 时间：2012-05-07T20:57:13.787
> 
> 标签：c#

是否可以扩展此接口？我已经看到它是可能的，但我真的不明白它是如何工作的，我想看看关于它的文档，我看到有人做了一个类“IDbConnecitonExtension”或类似的东西，只是神奇地工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T21:02:39.370

> 是否可以扩展此接口？

是的。您可以像任何其他类型一样扩展它。

```
public static class IDbConnectionExtensions {
    public static void MyExtension(this IDbConnection connection) {
        Console.WriteLine("Hello, connection!");
    }
} 
```

# ajax - 具有 json 模型绑定到复杂类的 ASP MVC 3 ajax

> ID：10489019
> 
> 赞同：0
> 
> 时间：2012-05-07T20:57:18.493
> 
> 标签：ajax, asp.net-mvc, json, asp.net-mvc-ajax, imodelbinder

我的 ASP MVC 3 项目中有以下类层次结构。一些条目可以有容器，而那个容器里面可以有一些内容。容器和内容类是抽象类。

![等级制度](../Images/26f30606ef8acc3be8509e84e700eba8.png)

我需要从浏览器接收 json 请求，并将其绑定到属于 Entry 类的模型。问题是 DefaultModelBinder 类没有正确创建 Entry 模型类，因为它不知道它应该是什么类型的具体容器。例如：

```
var dataaa = { Name: 'Some Name', Containers: [{ ContainerId: 0}] };
    $.ajax({
        url: 'Add',
        type: "POST",
        data: JSON.stringify(dataaa),
        contentType: 'application/json; charset=utf-8',
        success: function (data) {
            alert('hello');
        }); 
```

+

```
[HttpPost]
public string Add(Entry entry)
{
    return "foo";
} 
```

以下请求导致服务器异常： **无法创建抽象类**。我可以将类型字段添加到 json 请求中，例如：

```
{ Name: 'Some Name', Containers: [{ Type: 'FullContainer', ContainerId: 0}] }; 
```

如何指示模型绑定机制将Type字段设置为'FullContainer'的对象映射到FullContainer类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:42:14.190

Entry 是视图模型吗？基本条目中包含的属性是否足以用于您的帖子，即使它是完整容器类型的？如果它不是一个视图模型，但它是你真正需要的，我建议创建一个`EntryViewModel`非抽象的类。

否则，请在此处查看 Darin 的回答[Polymorphic model binding](https://stackoverflow.com/questions/7222533/polymorphic-model-binding)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T10:25:14.300

我已经在我的[主页](http://maciejlis.com/asp-mvc-3-model-binder-with-abstract-class-support/)上发布了答案。

# android - Android XML 主题 VS 样式

> ID：10489020
> 
> 赞同：1
> 
> 时间：2012-05-07T20:57:21.683
> 
> 标签：android, styles, themes, basic4android

我已经仔细阅读了这里的所有问题以及关于 Android 样式和主题的无数教程。主题和样式之间奇怪的层次结构对我来说仍然是一个谜。

我的清单调用了这个“样式”（android：theme，“@style/rforderstyle”）[这是从 Basic4Android 中的清单编辑器格式化的]（*不是我的选择，而是我必须使用的。*）.. 但是清单是如果我需要，仍然可以访问。我提到这一点是因为我注意到您可以设置特定活动的样式。我实际上没有看到强制让多个“wigets”拥有自己的“主题”的方法，而它们都存在于同一个活动中。

请告知如果是这样，那么我需要将我的“小创作”作为“片段”或“假发”。我正在尝试的是一个 Windows 移动应用程序类型的表单，上面有大量的用户控件。所以底部的这个集合恰好使用了中等大小的黑色文本字体。但是右上方的控件是不同的文字大小和颜色 on & On & on ...

因此，关于样式 xml 文件，我已经读过，重要的是，我的父母是一些包罗万象的 Android 主题，并且我在本节中覆盖了各个“属性”::

这是否意味着尽管我关心文本大小，但由于我有标签和编辑控件，因此在我尝试使用此引用的父样式时，缺少解决这些问题的“父”样式会导致我出错？一个主题如何进入这个组合......？

```
 <resources>
      <style name="rforderstyle" parent="@android:style/TextAppearance">>
      <item name="android:textSize"> 21.0dp</item>
      <item name="android:typeface">serif</item>
      <item name="android:textColor">#FF9900 </item><!--#00FF00-->
      </style>
    </resources> 
```

这有点令人困惑，因为最好的示例参考视图的布局文件，但我在 Basic4Android 中并没有真正的布局文件，我正在以编程方式创建所有这些视图。如果我不需要主题**和**样式的深度，那很好，但是……清单应该指向样式或主题吗？

# java - 为什么 spring-servlet.xml 上的 Bean 无法访问我的 applicationContext.xml 中的 bean

> ID：10489024
> 
> 赞同：4
> 
> 时间：2012-05-07T20:57:43.367
> 
> 标签：java, spring-mvc, javabeans

我在这里有一个问题，“applicationContext.xml”中定义的bean如何可用于“spring-servlet.xml”中定义的控制器，所以我可以跳过我遇到的这种错误。

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name '/home' defined in ServletContext resource [/WEB-INF/mmapp-servlet.xml]: Cannot resolve reference to bean 'equipementService' while setting bean property 'equipementService'; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'equipementService' is defined 
```

应用程序上下文.xml

```
<?xml version="1.0" ?>
<!DOCTYPE beans PUBLIC 
"-//SPRING//DTD BEAN//EN"
"http://www.springframework.org/dtd/spring-beans.dtd">

<beans>
    <bean name="equipementService"
        class="mmapp.service.SimpleEquipementService" />
    <bean name="equipement1"
        class="mmapp.domain.Equipement" />

</beans> 
```

mmapp-servlet.xml

```
<?xml version="1.0" ?>
<!DOCTYPE beans PUBLIC
"-//SPRING//DTD BEAN//EN"
"http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

    <bean name="/home" class="mmapp.web.HelloController">
        <property name="equipementService" ref="equipementService" />
    </bean>
</beans> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-07T21:53:05.950

基于 Spring 的 Web 应用程序通常具有多个运行时 Spring 应用程序上下文 -

1.  根应用程序上下文（在 servlet 容器启动期间加载），这是您通常为服务放置 bean 的位置 - 根应用程序上下文通过使用 ContextLoaderListener 加载，通常在您的web.xml 文件：

* * *

```
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath*:META-INF/spring/applicationContext*.xml</param-value>
</context-param> 
```

* * *

1.  一个或多个 Web 应用程序上下文，它被认为是根应用程序上下文的子级，包含与 UI - 控制器等相关的 bean。这是通过使用 Dispatcher Servlet 进行配置的，这是 Spring 提供的一种特殊 servlet，它知道委托调用适合于 Spring 容器。根应用程序上下文中的 bean 对此处定义的 bean 是可见的，但反之则不行——这种方式在 UI 层和服务层之间提供了一定程度的分离。这是 web.xml 文件中的典型配置条目：

* * *

```
<servlet>
    <servlet-name>lovemytasks</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/mmapp-servlet.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet> 
```

如果您以这种方式定义了 bean，那么`equipementService`您的控制器应该可以看到 bean。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:28:17.520

我不是专家，我不确定这是否是个问题，但我有一个建议。你能发布你的网络应用程序描述符（web.xml）吗？它是否包含上下文参数？

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath*:applicationContext.xml</param-value>
</context-param> 
```

# tomcat7 - Tomcat 7 上的 Enhydra 5 应用程序

> ID：10489025
> 
> 赞同：0
> 
> 时间：2012-05-07T20:57:48.363
> 
> 标签：tomcat7

我有一个使用在树脂 2 服务器上运行的 enhydra 5 框架的应用程序。将此应用程序移动到 tomcat 7 服务器给我带来了问题。

我能够将应用程序部署在 tomcat 服务器上，但会话数据在请求之间丢失。我通过调试tomcat和resin上的应用程序比较了这些值，发现会话值在resin中可用。

有没有人有任何想法或向我提供获取 Enhydra 源代码的链接。这是一个非常古老的框架，写于 2000 年。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T17:57:58.043

我做了一些挖掘，我能想到的最好的方法是[http://www.together.at/download](http://www.together.at/download)这似乎是此代码迁移到的地方，但没有迹象表明旧版本的可访问源存储库或 src 包.

听起来这里可能存在配置问题。像查看 HTTP 标头这样简单的事情可能会揭示出问题所在。

当源代码不是立即可用时，我有时使用的另一个选项是[JAD](http://www.varaneckas.com/jad/)。反编译的代码并不总是最易读的，但通常足以找出问题所在。

# c - 分配指向整数的指针

> ID：10489027
> 
> 赞同：5
> 
> 时间：2012-05-07T20:57:54.410
> 
> 标签：c, pointers, assignment-operator

我可以将指针分配给整数变量吗？像下面这样。

```
int *pointer;
int array1[25];
int addressOfArray;

pointer = &array1[0];

addressOfArray = pointer; 
```

有可能这样做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T20:58:39.570

不，将指针分配给整数是无效的。这是对赋值运算符 (C99, 6.5.16.1p1) 的约束违规。编译器有权拒绝翻译带有指向整数赋值的指针的程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-07T21:47:11.880

不是没有明确的演员表，即

```
addressOfArray = (int) pointer; 
```

还有这个警告：

> **6.3.2.3 指针**
> ...
> 6 任何指针类型都可以转换为整数类型。除非前面指定，结果是实现定义的。如果结果不能以整数类型表示，则行为未定义。结果不必在任何整数类型的值范围内。

所以结果不能保证是一个有意义的整数值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T21:06:59.803

它经常在嵌入式编程中完成，但有一些警告：

*   该操作（很可能）需要强制转换，并且
*   通常意味着您在没有操作系统的情况下工作或与 RTOS 密切合作（即驱动程序级开发）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T21:08:26.537

没有。

您正在尝试将“指向 int 的指针”值分配给“int”变量。您肯定会收到编译器警告。你可以这样做：

```
int *pointer;
int array1[25];
int *addressOfArray;

pointer = &array1[0];
//The following commented lines are equivalent to the pointer assignment above and are also valid
//pointer = array
//pointer = &array[0]

addressOfArray = pointer; 
```

这称为浅拷贝。如果您还不熟悉这个概念，我强烈建议您阅读它（谷歌“深拷贝与浅拷贝”）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-07T21:04:28.783

你可以这样做：

```
memcpy(&addressOfArray, &pointer, sizeof(int)); 
```

这将直接复制底层字节并取代强制转换运算符，但我绝对不会推荐它，除非您在系统上确定这一点`sizeof(int) == sizeof(int *)`。

# jquery - Jquery 搜索和替换 w/.contains

> ID：10489035
> 
> 赞同：5
> 
> 时间：2012-05-07T20:58:29.553
> 
> 标签：jquery

我正在尝试搜索并替换同一个单词的所有实例，使用 .contains () 不区分大小写，但它似乎不起作用并且区分大小写。这是我现在拥有的代码：

```
<p>some text</p>
<p>Some Text</p>
<p>Some TEXT</p>

jQuery.expr[':'].Contains = function(a, i, m) {
         return jQuery(a).text().toUpperCase()
             .indexOf(m[3].toUpperCase()) >= 0;
       };
       jQuery.expr[':'].contains = function(a, i, m) {
         return jQuery(a).text().toUpperCase()
             .indexOf(m[3].toUpperCase()) >= 0;
       };

        $('p').filter(":contains('some text')").each(function(){
            $(this).text($(this).text().replace("some text", "replace with new text"));
        }); 
```

这只会更改第一个文本，因为同样的情况，您可以在此处查看 js fiddle 上的示例 [http://jsfiddle.net/ka82V/](http://jsfiddle.net/ka82V/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:06:34.150

它实际上是区分大小写的“替换”。改用正则表达式：

`text().replace(/some text/i, "replace with new text"));`

**演示** [http://jsfiddle.net/ka82V/1/](http://jsfiddle.net/ka82V/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:06:55.393

你包含看起来不错。尝试如下，因为使用的目的`.filter`是链接

[**演示**](http://jsfiddle.net/skram/ka82V/5/)

```
jQuery.expr[':'].containsCI = function(a, i, m) {
    return jQuery(a)
        .text()
        .toUpperCase()
        .indexOf(m[3].toUpperCase()) >= 0;
};

$('p').filter(":containsCI('some text')").text(function() {
    return $(this).text().replace(/some text/i, "replace with new text");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T21:10:29.287

问题不在于原始匹配，而在于您如何替换。即使*确实*匹配，替换也没有做任何事情，因为它的“某些文本”参数与其他大小写变体不匹配。

但是，我认为`:contains`像这样覆盖 jQuery 的选择器并不是一个好主意。使用基于函数的过滤器的代码更少，并且 jQuery 也保持不变。

参见工作示例：http: [//jsfiddle.net/Y6bhS/1/](http://jsfiddle.net/Y6bhS/1/)

```
$('p').filter(function() {
    return /some text/i.test( $(this).text() );
}).each(function(){
    $(this).text($(this).text().replace(/some text/i, "replace with new text"));
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T21:13:15.093

```
jQuery.expr[':'].Contains = function(a, i, m) {
    return new RegExp(m[3], 'ig').test(jQuery(a).text());  // case insensitive replace
};
jQuery.expr[':'].contains = function(a, i, m) {
    return new RegExp(m[3], 'ig').test(jQuery(a).text());  // case insensitive replace
};

$('p').filter(":contains('some text')").each(function() {
     $(this).text($(this).text().replace( new RegExp($(this).text(), 'i'),"replace with new text"));
}); 
```

# java - 如何声明具有硬编码值的自定义数据类型的静态数组？

> ID：10489038
> 
> 赞同：4
> 
> 时间：2012-05-07T20:58:48.377
> 
> 标签：java, static-array

**目标：**

我想为不经常更改的数据实现一个硬编码的查找表，但是当它确实发生更改时，我希望能够快速更新程序并重建。

**计划：**

我的计划是定义一个像这样的自定义数据类型......

```
private class ScalingData
{
    public float mAmount;
    public String mPurpose;
    public int mPriority;

    ScalingData(float fAmount, String strPurpose, int iPriority)
    {
        mAmount = fAmount;
        mPurpose = strPurpose;
        mPriority = iPriority;
    }
} 
```

然后，在主类中，像这样对数组进行硬编码......

```
public static ScalingData[] ScalingDataArray =
{
        {1.01f, "Data point 1", 1},
        {1.55f, "Data point 2", 2}
}; 
```

但是，这不会建立。我一直看到消息“ **`Type mismatch: cannot convert from float[] to ScalingData`**”。

我怎样才能实现我的目标？

**更新**

到目前为止，我已尝试实施这些建议，但仍然遇到错误...

代码如下所示：

```
public class CustomConverter
{
    //Lookup Table
    private static ScalingData[] ScalingDataArray =
    {
        new ScalingData(1.01f, "Data point 1", 1),
        new ScalingData(1.55f, "Data point 2", 2)
    };

    //Constructor
    CustomConverter()
    {
        //does stuff
    }

    //Custom Data type
    private class ScalingData
    {
        public float mAmount;
        public String mPurpose;
        public int mPriority;

        ScalingData(float fAmount, String strPurpose, int iPriority)
        {
            mAmount = fAmount;
            mPurpose = strPurpose;
            mPriority = iPriority;
        }
    }
} 
```

硬编码数组的错误是

```
No enclosing instance of type CustomConverter is accessible.
   Must qualify the allocation with an enclosing instance of type CustomConverter
   (e.g. x.new A() where x is an instance of CustomConverter). 
```

**编辑...根据下面的答案完成解决方案**

```
public class CustomConverter
{
    //Lookup Table
    private static ScalingData[] ScalingDataArray =
    {
        new ScalingData(1.01f, "Data point 1", 1),
        new ScalingData(1.55f, "Data point 2", 2)
    };

    //Constructor
    CustomConverter()
    {
        //does stuff
    }

    //Custom Data type
    private static class ScalingData
    {
        public float mAmount;
        public String mPurpose;
        public int mPriority;

        ScalingData(float fAmount, String strPurpose, int iPriority)
        {
            mAmount = fAmount;
            mPurpose = strPurpose;
            mPriority = iPriority;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-07T21:01:04.783

你不能在 Java 中做到这一点。您需要像这样使用构造函数：

```
public static ScalingData[] ScalingDataArray =
{
        new ScalingData(1.01f, "Data point 1", 1),
        new ScalingData(1.55f, "Data point 2", 2)
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:01:10.700

您的数组包含 ScalingData，因此您必须添加这些实例。

```
public static ScalingData[] ScalingDataArray = {
        new ScalingData(1.01f, "Data point 1", 1),
        new ScalingData(1.55f, "Data point 2", 2)
}; 
```

顺便说一句：除非你真的需要，否则我不会使用`float`代替。`double`大多数时候，拥有额外的精度比节省的几个字节更有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T23:20:04.283

正如其他人已经写的那样，您需要显式创建对象的实例，即您的数组需要诸如`new ScalingData(1.01f, "Data point 1", 1)`代替`{1.01f, "Data point 1", 1}`. 这是语言语法的问题。

对于您的扩展问题，`ScalingData`应该声明嵌套类`static`，否则，正如错误消息所说，它需要从它嵌套的类的封闭实例中创建，`CustomConverter`（或者您必须使用 operator new 调用这种类型的实例，如下所示：`myCustomConverterInstance.new ScalingData(1.01f, "Data point 1", 1)`- 但`ScalingData`不需要封闭类，只需将其声明为静态或将其声明为非嵌套类）。

如果您的数组有很多点并且您发现类的名称有点太长，作为速记，您可以创建一个名称非常短的辅助函数，它只创建一个实例。稍长的名称有利于可读性，但长数组的初始化有时可能是一个例外。在这个名字只是`ScalingData`的特殊情况下，收益并不大，但是对于一些类名，我确实发现这个解决方案可以使代码更好，特别是如果数组很长。这只是一个 hack，但它允许数组初始化代码更短并且可能更清晰：

```
protected static ScalingData point(float fAmount, String strPurpose, int iPriority) {
    return new ScalingData(fAmount,strPurpose,iPriority);
}

public static ScalingData[] ScalingDataArray = {
    point(1.01f, "Data point 1", 1),
    point(1.55f, "Data point 2", 2),
    ...
}; 
```

代替

```
public static ScalingData[] ScalingDataArray = {
    new ScalingData(1.01f, "Data point 1", 1),
    new ScalingData(1.55f, "Data point 2", 2),
    ...
}; 
```

附带说明一下，遵循 Java 命名约定通常很好，这意味着您的数组名称应该以小写字母开头 -`scalingDataArray`而不是`ScalingDataArray`（大写首先用于类）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T21:01:35.070

你不能指望一些随机数据神奇地转换成一个对象。

您需要实例化您的 ScalingData 对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-07T21:55:09.953

我认为枚举可能更适合您的需求：

```
enum ScalingData{

    DataPoint1(1.01f, "Data Point 1", 1),
    DataPoint2(1.55f, "Data Point 2", 2);

    final float Amount;
    final String Purpose;
    final int Priority;

    ScalingData(float fAmount, String strPurpose, int iPriority){
        Amount = fAmount;
        Purpose = strPurpose;
        Priority = iPriority;
    }
} 
```

# javascript - 如何在 POST 上将 html 表的内容作为表单数据传递？

> ID：10489046
> 
> 赞同：16
> 
> 时间：2012-05-07T20:59:31.327
> 
> 标签：javascript, html

我在 a`<select>`和 a中有一个组列表，`<input type="button" value="Add Selected">`用于将所选组添加到 a`<table>`值中。

已添加的组列表显示在 中`<table>`，每次单击“添加选定”按钮时，javascript 都会动态添加行。表格中的每一行都有一个“删除”链接，用于从表格中删除项目。

一切正常，除了现在我想将表的内容发布到 URL，我不知道该怎么做。

我应该为表格中的每一行添加一个隐藏字段吗？还是有更好的方法来做到这一点？

任何建议都非常感谢！

抢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-07T21:02:30.873

将您的表格包装在一个表单中，并将您想要发布但不向用户显示的数据放在隐藏的输入中

```
<form method="post" action="">
    <!-- your table -->
    <input type="hidden" name="name" value="your value"/>
    <button type="submit">Post</button>
</form> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-12T14:12:47.660

我已经做了：

```
function sendTableArticles() {
        var columns = [
            'articulo.id',
            'articulo.descripcion',
            'unidadMedida.descripcion',
            'precio',
            'importe',
            'totalRequerido',
            'totalIngresado'
        ];

        var tableObject = $('#table_articles tbody tr').map(function (i) {
            var row = {};
            $(this).find('td').each(function (i) {
                var rowName = columns[i];
                row[rowName] = $(this).text();
            });

            return row;
        }).get();

        $.post('@{OrdenComprasDetalles.update()}',
                {objects:tableObject},
                function (response) {
                    console.log(response);
                }
        )
    } 
```

在控制器中

```
public static void update(List<OrdenCompraDetalle> objects){
        int i=0;
        renderJSON(i);
    } 
```

所以这是我的 DTO

```
@Entity(name = "ordencompradetalle")
public class OrdenCompraDetalle extends AbstractTableMapper {

    @ManyToOne
    public Articulo articulo;

    public Float precio;

    public Float importe;

    public Boolean ingresado;

    @Column(name = "total_requerido")
    public Float totalRequerido;

    @Column(name = "total_ingresado")
    public Float totalIngresado;

    @ManyToOne
    public OrdenCompra ordenCompra;

    @ManyToOne
    public UnidadMedida unidadMedida;

    @OneToMany(mappedBy = "ordenCompraDetalle")
    public List<Movimiento> movimientos;
} 
```

我正在使用，太有用了，希望对你也有帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T21:09:12.610

```
<form method="post" action="your_server_action">
  <table>
    <!-- Table row display elements -->
    <input type="hidden" name="name" value="your value"/>
  </table>
  <input type="submit" value="Submit"/>
</form> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-07T21:20:55.793

前几天我做了类似的事情，我的解决方案是从我的表中创建一组对象，我可以将它们发送到 Web 服务。Web 服务应该有一个对象数组。

```
// Read all rows and return an array of objects
function GetAllRows()
{
    var myObjects = [];

    $('#table1 tbody tr').each(function (index, value)
    {
        var row = GetRow(index);
        myObjects.push(row);
    });

    return myObjects;
}

// Read the row into an object
function GetRow(rowNum)
{
    var row = $('#table1 tbody tr').eq(rowNum);

    var myObject = {};

    myObject.ChangeType = row.find('td:eq(1)').text();
    myObject.UpdateType = row.find('td:eq(2)').text();
    myObject.CustomerPart = row.find('td:eq(3)').text();
    myObject.ApplyDate = row.find('td:eq(9)').text();
    myObject.Remarks = row.find('td:eq(10)').text();

    return myObject;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-07T21:24:51.177

通过像这样添加 [] 来选择数组的名称

```
<select name="modules[]" id="modules" class="inputbox" size="10" multiple="multiple">
<option value="1">Module 01</option>
<option value="2">Module 02</option>
<option value="3">Module 03</option>
</select> 
```

我认为提交后你的 $_POST 中会有一个数组，为此示例模块命名

# xml - XSLT (1.0)：在获取节点的内容时，是否可以忽略/跳过它的一部分（或子元素）？

> ID：10489047
> 
> 赞同：0
> 
> 时间：2012-05-07T20:59:34.977
> 
> 标签：xml, xslt, xslt-1.0

我有类似的xml代码：

```
<body>Text Here1.
</body>
<body><Title>Title</Title>Text Here2.
</body>
<body>Text Here3.
</body> 
```

我在我的 XSLT 中使用以下代码：

```
<xsl:when test="@name='body'">
<p> 
<xsl:value-of select='normalize-space(node())'/>
</p>
</xsl:when> 
```

在第二个节点中忽略该子元素的最佳机制是什么，或者可能在节点内对其应用特殊格式（假设我想加粗该文本）？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:49:16.773

当使用 XSLT 处理层次结构时，通常使用应用模板，它允许您递归地遍历 XML 输入。下面的示例将`body`使用元素将文本封装在元素内`paragraph`，并将文本封装在`Title`元素内的元素内`bold`。所有其他元素将被忽略。

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="html" version="4.0" encoding="iso-8859-1" indent="yes"/>
  <xsl:template match="/">
    <xsl:apply-templates />
  </xsl:template>
  <xsl:template match="body">
    <p>
      <xsl:apply-templates />
    </p>
  </xsl:template>
  <xsl:template match="Title">
    <b>
      <xsl:apply-templates />
    </b>
  </xsl:template>
  <xsl:template match="text()">
    <xsl:value-of select='normalize-space(.)'/>
  </xsl:template>
</xsl:stylesheet> 
```

# c++ - 在 boost homebrew 安装中找不到 bjam

> ID：10489049
> 
> 赞同：5
> 
> 时间：2012-05-07T20:59:39.360
> 
> 标签：c++, python, boost-python, homebrew

我在运行 Lion 的 Mac 上安装了带有 homebrew( `brew install boost`) 的 Boost，目的是用我现有的 C++ 程序扩展 python。现在我无法按照[入门指南](http://www.boost.org/doc/libs/1_49_0/libs/python/doc/tutorial/doc/html/python/hello.html)进行操作，因为 1 - 我的系统中没有安装“bjam”，并且 2-我在任何地方都看不到示例文件夹。我的问题是：我应该如何在没有'bjam'的情况下将 c++-python 与这个自制安装进行链接？是否有一些我应该使用的替代方法或我在这里缺少的东西？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-08T12:45:35.243

安装 boost 以将 c++ 与 python 程序链接的正确公式是：
`brew install boost-build`
正如 senderle 在我的问题的评论中指出的那样。这会`bjam`自动安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:13:51.253

对于 Windows，您进入 $(BoostDir)\tools\build\v2\engine 并运行 build.bat，它会自动构建 bjam（进入 Windows 上的 bin.ntx86 目录）。那里也有一个 build.sh 文件，但我从未使用过 Mac，所以我不知道这是否适合你。否则，只需在 Google 上搜索 Mac OS X 的预编译 bjam 可执行文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T10:34:44.230

这应该只是下载 Boost 然后运行“Bootstrap”然后运行“Bjam”的情况。

Bootstrap 应该在 Boost 文件夹中为您构建一个 Bjam 可执行文件。

# php - 用于设置变量的 PHP 语法

> ID：10489057
> 
> 赞同：1
> 
> 时间：2012-05-07T21:00:22.200
> 
> 标签：php, javascript

我有一个 JS 脚本，我将代码转换为 PHP，但我坚持正确的语法是在我的 PHP 脚本中创建与 JS 中的这段代码相同的代码：

```
var sdata = {
           "13":{
               "22":["618","22","1","1","0","0","0"],
               "21":["617","22","1","1","0","0","0"]
           },               
           "14":{
                "22":["619","22","1","1","0","0","0"],
                "20":["622","22","1","1","0","0","0"]
           },    
           "15":{
                "20":["623","22","1","1","0","0","0"]
     }
}; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:02:50.623

最简单的方法是使用 jQuery .get 函数，将此数组作为数据的一部分发送，然后在 $_GET 变量上运行 PHP 函数 json_decode 以获取 PHP 数组：）然后，如果需要对其进行硬编码，则可以 print_r 数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:04:03.923

```
$sdata = array(
           "13" => array(
               "22" => array("618","22","1","1","0","0","0"),
               "21" => array("617","22","1","1","0","0","0")
           ),               
           "14" => array(
                "22" => array("619","22","1","1","0","0","0"),
                "20" => array("622","22","1","1","0","0","0")
           ),    
           "15" => array(
                "20" => array("623","22","1","1","0","0","0")
     )
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T21:03:06.693

查看多维数组：

[http://php.net/manual/en/language.types.array.php](http://php.net/manual/en/language.types.array.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T21:03:28.660

看起来你需要的是一个多维数组。由于您似乎是 PHP 新手，请查看 PHP 数组手册页上的代码示例：http: [//php.net/manual/en/language.types.array.php](http://php.net/manual/en/language.types.array.php)

# jquery - 动态添加的选择列表样式不正确

> ID：10489062
> 
> 赞同：1
> 
> 时间：2012-05-07T21:00:35.963
> 
> 标签：jquery, asp.net-mvc-3, razor, jquery-chosen

我正在使用 ajax 获取部分视图的 HTML，该部分视图包含一个下拉列表，我希望使用 Chosen jQuery 插件对其进行样式设置。我动态添加的第一个样式正确，但是所有其他都成为链接并且没有获得正确的样式/功能。

在行中添加后，我使用：

```
$(".chosen").last().css('width', '150px').chosen(); 
```

该元素确实开始正确设置样式，但并没有完全正确。这是输出。

```
<div id="SelectedRate_chzn" class="chzn-container" style="width: 150px;">
    <a href="javascript:void(0)" class="chzn-single chzn-default">
        <span>Select an Option</span>
        <div><b></b></div>
    </a>
    <div class="chzn-drop" style="left:-9000px;">
        <div class="chzn-search">
            <input type="text" autocomplete="off">
        </div>
        <ul class="chzn-results"></ul>
    </div>
</div> 
```

我认为我的部分观点没有任何问题，但如果您需要其他内容，请在下方评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:44:24.787

通过对话框将记录添加到现有表单时，我遇到了同样的问题，我设法做到了如下：

在成功调用 ajax 之后，我**向原始 select 元素添加了一个新选项，**并触发**liszt:updated**事件以选择重新读取 select 元素并更新自身。

例如：ajax调用返回要添加的新联系人数据为json字符串

```
{ id:123, label:'new contact name' } 
```

将新选项附加到选择：

```
$('select#contact_id').append('<option value='+data.id+'>'+data.label+'</option>') 
```

触发事件（您可以将其链接到上一个调用）

```
$('select#contact_id').trigger('liszt:updated'); 
```

希望这能让你继续前进！

亲切的问候

# uiscrollview - UIScrollView 点击坐标

> ID：10489073
> 
> 赞同：1
> 
> 时间：2012-05-07T21:01:12.617
> 
> 标签：uiscrollview, touch, scale

我将隐藏的 uilabel 移动到 uiscrollview 中的点击点，然后取消隐藏它 - 效果很好。但是，当您捏住 uiscrollview 以放大并再次点击时，标签会显示在错误的位置。如何按 uiscrollview 的比例缩放接触点以正确定位它？

-我

```
-(void)handleLongPress:(UILongPressGestureRecognizer*)sender {

    CGPoint longTapPoint = [sender locationInView:self.view];   
    NSLog(@"LongTapPoint.x %f,LongTapPoint.y %f",longTapPoint.x,longTapPoint.y);
    uil_tapBldgLabel.center = CGPointMake(longTapPoint.x, longTapPoint.y);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:19:27.290

您可能希望将这些触摸事件传递给 nextResponder，这样您就不会被缩放的细微差别所困扰。

# javascript - 如何阻止 this.form.reset() 触发我的表单操作？

> ID：10489088
> 
> 赞同：0
> 
> 时间：2012-05-07T21:02:28.550
> 
> 标签：javascript, html

好的，这是我的问题。我正在为我的提交/重置表单按钮使用自定义图形，但是一旦您按下重置，表单操作就会被提交，我不希望这种情况发生，我一直在互联网上寻找答案，但没有任何运气。我也包括了表单代码，希望我可能错过了一些东西。

```
<form class="contact" name="con_form" action="../includes/mailer.php">
            First Name*: <input type="text" name="first_name" value="" /><br />
            Last Name*: <input type="text name="last_name" value="" /><br />
            Contact Number*: (<input type="text" name="area_code" value="" size="3" />) <input type="text" name="first_three" value="" size="3" /> <input type="text" name="last_four" value="" size="4" /><br />
            Email Address*: <input type="text" name="email" value="" /><br />
            I would like to*: 
            <select>
                <option>--- Select One ---</option>
                <option>Comment</option>
                <option>Suggestion</option>
                <option>Inquiry for employment</option>
            </select><br />
            Comment or Suggestion: <textarea size="1024"></textarea><br /><br />
            <input type="image" src="images/sub_idle.gif" onsubmit="../index.php" alt="Submit" /> <input type="image" onclick="this.form.reset()" src="images/res_idle.gif" alt="Reset" />
        </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:06:23.870

`input type="image"`将图像定义为提交按钮。如果您只是希望它是触发某些 javascript 的可点击图像，则根本无需将其设为 an `input`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:07:52.070

`<input type="image"`输入实际上是一个提交按钮

我会尝试以此为起点：（可能不是最好的方法）

```
<img onclick="this.form.reset();" src="images/res_idle.gif" alt="Reset" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T21:11:22.360

不要使用 input `type=image`，使用`A`带有 CSS 背景的 -tag 。

```
<a href="#" class="buttonImage" onclick="document.con_form.reset();return false"></a>

.buttonImage {
    background-image:url(/images/sub_idle.gif);
    height:20px;
    width:60px;
    display:block
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T21:22:27.650

您可以将类型更改为“按钮”并将 css 类应用于按钮以自定义按钮。

```
<input type="button" onclick="this.form.reset()" class="resetbutton" /> 
```

# shell - Shell参数扩展：如何获取没有目录部分的文件名？

> ID：10489096
> 
> 赞同：3
> 
> 时间：2012-05-07T21:03:06.083
> 
> 标签：shell, makefile, variable-expansion

我正在编写一个makefile，并假设我有以下内容；

```
FILES = file1.py \
    folder1/file2.py \
    folder2/file3.py 
```

我有以下for循环：

```
 -@for file in $(FILES); do \
           echo $${file/folder1\/}; \
    done 
```

以上将打印：

```
file1.py
file2.py
folder2/file3.py 
```

我想要的输出是：

```
file1.py
file2.py
file3.py 
```

我查看了一些关于 shell 扩展的文档，但还没有找到解决这个问题的方法。我可以知道我应该如何更改代码以获得正确的输出吗？任何帮助将不胜感激。

编辑：语法

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T17:35:20.767

你已经接受了@Jens 的 shell 风格的答案，但我会建议一个[make 风格的](http://www.gnu.org/software/make/manual/make.html#File-Name-Functions)解决方案：

```
-@for file in $(notdir $(FILES)); do \
       echo $${file}; \
done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:17:36.980

尝试使用`echo $${file##*/}`. 这将只给出文件名部分，直到最后一个斜杠。

# c# - c#访问db文件路径

> ID：10489098
> 
> 赞同：0
> 
> 时间：2012-05-07T21:03:06.810
> 
> 标签：c#, asp.net, ms-access

我正在从 USB 闪存调试 ASP 应用程序（有一个项目，我使用 MS Visual Studio）我不知道如何指示我尝试的 db 文件的路径，`string db_adres = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=J:\test.mdb";`但这是错误的路径

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:05:51.327

在 C# 中，您应该在这种字符串前面加上 char @

```
string db_adres = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source='J:\test.mdb'"; 
```

或加倍`\`字符

```
string db_adres = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source='J:\\test.mdb'"; 
```

第一个称为“逐字字符串”，第二个是“转义字符串”
查看此处[C# 规范 2.4.4.5“字符串文字”](http://msdn.microsoft.com/en-us/library/aa691090%28v=VS.71%29.aspx)

# android - 叠加到网格视图上

> ID：10489105
> 
> 赞同：2
> 
> 时间：2012-05-07T21:03:20.793
> 
> 标签：android, gridview, overlay

我有一个使用本教程[GridView Android](http://developer.android.com/resources/tutorials/views/hello-gridview.html)创建的网格视图，它工作得很好。现在，如果单击该项目，我想将图像叠加到 gridview 的项目上。我不确定如何做到这一点，无论我是使用另一个 gridview 并合并它们还是只有很多图像视图：s。只是为了澄清这个问题：我如何覆盖到 gridview 项目上？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T12:21:33.673

所以有几种方法可以实现这一点，但最灵活的可能是在`getView`方法中使用自定义视图。

[将LayoutInflater](http://developer.android.com/reference/android/view/LayoutInflater.html)添加到您的 ImageAdapter 类：

```
private LayoutInflater mInflater; 
```

在构造函数中初始化它：

```
public ImageAdapter(Context c) {
    mContext = c;

    // Initialise the inflater
    mInflater = (LayoutInflater) mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
} 
```

这用于扩展 xml 视图，例如：

```
<RelativeLayout
  android:layout_width="fill_parent"
  android:layout_height="fill_parent">
    <ImageView
      android:id="@+id/mainImage"
      android:layout_width="fill_parent"
      android:layout_height="fill_parent"
    />
    <ImageView
      android:id="@+id/overlayImage"
      android:layout_width="fill_parent"
      android:layout_height="fill_parent"
      android:visibility="gone"
    />
</RelativeLayout> 
```

在 ImageAdapter 类`getView`方法中膨胀这个视图

```
public View getView(int position, View convertView, ViewGroup parent) {

    // RelativeLayout as used in the xml view
    RelativeLayout customView;

    if (convertView == null) {  // if it's not recycled, inflate
        customView = (RelativeLayout) mInflater.inflate(R.layout.customview, null);
    } else {
        imageView = (RelativeLayout) convertView;
    }

    // Get the mainImageView from the parent
    ImageView mainImage = (ImageView) customView.findViewById(R.id.mainImage);
    imageView.setImageResource(mThumbIds[position]);

    // Overlay view
    ImageView overlayImage = (ImageView) customView.findViewById(R.id.overlayImage);
    overlayImage.setImageResource(mOverlayThumbIds[position]); // new array containing overlay references

    return customView;
} 
```

然后在点击时显示叠加图像

```
gridview.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View v, int position, long id) {

        ImageView overlayImage = (ImageView) v.findViewById(R.id.overlayImage);
        overlayImage.setVisibility(View.VISIBLE);

    }
}); 
```

这是一个非常基本的示例，但希望您会发现该方法很有用。

# oracle - 使用 DbProviderFactories 使用 nhibernate 和 oracle

> ID：10489106
> 
> 赞同：1
> 
> 时间：2012-05-07T21:03:24.213
> 
> 标签：oracle, nhibernate, dbproviderfactories

在我们的系统中，我们使用的是 nhibernate 和 Oracle。我们总是遇到很多部署问题，因为 Oracle.DataAccess.dll 和安装在我们客户端服务器中的 Oracle 客户端之间的关系是一团糟。

有时我们可以更改已安装的 oracle 客户端，有时则不能。有时我们需要 32 位版本的 dll，有时需要 64 位版本。我希望我可以更改 oracle 以获得更友好的数据库，但目前这不是一个选择。

摆脱所有这些混乱的一种方法是使用 DbProviderFactories，因此我的项目中没有 Oracle.DataAccess.dll 的引用，而使用服务器上安装的任何版本。

**如何配置 nhibernate 以使用 DbProviderFactory？**

我的配置：

```
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <session-factory>
      <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
      <property name="dialect">NHibernate.Dialect.Oracle9iDialect</property>
      <property name="connection.driver_class">NHibernate.Driver.OracleDataClientDriver</property>
      <property name="connection.connection_string">Data Source=XE; User Id=*****; Password=******;</property>
      <property name="current_session_context_class">NHibernate.Context.ManagedWebSessionContext, NHibernate</property>
      <property name="sql_exception_converter">Way2Pim.Data.NHibernate.SqlExceptions.SqlExceptionConverter, Way2Pim.Data</property>
      <property name="show_sql">true</property>
      <property name="hbm2ddl.keywords">none</property>
      <mapping assembly="MyAssembly" />
    </session-factory>
  </hibernate-configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T07:29:57.050

NHibernate already uses the dbproviderfactory if loading per reflection fails. see `NHibernate.Driver.ReflectionBasedDriver`

this feature is available since

```
Revision: bb904343e18b693f6d1e13b357c305fdd46ff5ee
Author: Fabio Maulo
Date: 14.08.2010 19:37:12
Message:
Refactoring of ReflectionBasedDriver in order to use DbProviderFactories 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:49:14.130

知道了！

Nhibernate 有一个关于 Oracle 和 DBProviderFactories 的错误。如果您查看 OracleDataClientDriver 类，它派生自 ReflectionBasedDriver。

在它的构造函数中，ReflectionBasedDriver 正确地从 DbProviderFactory 加载 Oracle.DataAccess 提供程序。之后，OracleDataClientDriver 构造函数尝试从加载的程序集中获取 OracleCommand 类型，这当然会导致 null（Oracle.DataAccess 尚未在内存中）。

一个快速的解决方法是创建自己的驱动程序，从 OracleDataClientDriver 复制所有内容，但将其构造函数的所有行替换为以下内容：

```
System.Type oracleCommandType = base.CreateCommand().GetType();
oracleCommandBindByName = oracleCommandType.GetProperty("BindByName");

System.Type parameterType = oracleCommandType.Assembly.GetType("Oracle.DataAccess.Client.OracleParameter");
oracleDbType = parameterType.GetProperty("OracleDbType");

System.Type oracleDbTypeEnum = oracleCommandType.Assembly.GetType("Oracle.DataAccess.Client.OracleDbType");
oracleDbTypeRefCursor = System.Enum.Parse(oracleDbTypeEnum, "RefCursor"); 
```

就是这样，您的项目中不再有 Oracle.DataAccess.dll :)

# android - Android Https 连接。

> ID：10489109
> 
> 赞同：1
> 
> 时间：2012-05-07T21:03:29.197
> 
> 标签：android, https

我正在尝试在 android 中建立 https 连接。[我与 https://encrypted.google.com 建立了 http 和https](https://encrypted.google.com)连接，但两个连接都给出了相同的响应。我无法理解原因。如何测试我的 https 连接代码是否正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T06:02:56.280

获得相同的响应是重点。如果你不这样做，你会遇到麻烦 :) HTTPS 会加密底层通信通道，但在此之上你仍在处理 HTTP。如果每个应用程序都需要重新编写以使用 HTTPS，那么它不会很有用。

至于测试，可以使用抓包工具（tcpdump、Wireshark），自己看看区别。使用 HTTP 时，您将能够以纯文本形式查看正在发送或接收的所有数据；如果使用 HTTPS，它将被加密。

# wpf - 如果不满足几个条件，需要禁用窗口上的按钮

> ID：10489116
> 
> 赞同：0
> 
> 时间：2012-05-07T21:04:20.400
> 
> 标签：wpf, data-binding, binding

我的 WPF 应用程序在其主窗口上有许多按钮。我现在正在处理一个边缘案例，如果数据库已关闭或应用程序无法建立与其后端的连接（后端是我们编写的 Windows 服务），则应禁用按钮.

在我的视图模型库中有两个类，称为`DbMonitor`和`ComMonitor`（“Com”表示“Communications”）。它们来自同一个抽象类，实现`IPropertyChanged`接口，并有一个名为`Status`（继承自抽象基类）的属性，它是一个`DeviceStatuses`用 values `Green`、`Yellow`和调用的枚举`Red`。我希望仅当两个对象的状态属性都为时才启用按钮`Green`？

如何让这个绑定在 Xaml 中工作，或者我必须在我的代码隐藏中这样做。

谢谢

托尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T21:42:16.267

您是否使用带有这些按钮的命令？如果不是，您切换到命令有多难？的`CanExecute`部分`ICommand`似乎是去这里的路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:49:12.030

有三种方法可以解决这个问题：
**1\. 使用 Converter 将按钮的 IsEnabled 属性绑定**到 Status 属性，以从 DeviceStatus 映射到 bool（启用或未启用）。我不会推荐这个。
**2\. 路由命令**：

```
public static RoutedCommand MyButtonCommand = new RoutedCommand();
private void CommandBinding_MyButtonEnabled(object sender, CanExecuteRoutedEventArgs e) {
    e.CanExecute = Db.Monitor.Status==DeviceStatuses.Green;
} 
```

并在 XAML 中绑定到它：

```
<Window.CommandBindings>
<CommandBinding
    Command="{x:Static p:Window1.MyButtonCommand}"
    Executed="buttonMyButton_Executed"
    CanExecute="CommandBinding_MyButtonEnabled" />
</Window.CommandBindings>  
<Button Content="My Button" Command="{x:Static p:Window1.MyButtonCommand}"/> 
```

**3\. 实施 ICommand**：

```
public class MyCmd : ICommand {
    public virtual bool CanExecute(object parameter) {
        return Db.Monitor.Status==DeviceStatuses.Green;
    }
} 
```

这里的命令是适当视图模型的属性：

```
class MyViewModel {
    public MyCmd myCcmd { get; set; }
} 
```

并在 XAML 中绑定到它：

```
<Button Content="My Button" Command="{Binding myCmd}"/> 
```

第三种方法通常是最灵活的。您需要将具有您的状态属性的视图模型注入到 Command 构造函数中，以便您可以实现 CanExecute 逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:27:37.650

问完这个问题后，我做了一些额外的研究，找到了一个适合我的解决方案。

我创建了一个实现 IMultiConverter 接口的类，该接口将我的`DeviceStatuses`枚举转换为 bool。然后，在我的 Xaml 中，我这样做了：

```
<Button ....>
    <Button.IsEnabled>
        <MultiBinding Converter="{StaticResource DeviceStatusToBool}">
            <Binding Path="..." />
            <Binding Path="..." />
        </MuntiBinding>
    </Button.IsEnabled>
</Button> 
```

这很好用。

此时我无法将按钮转换为使用 ICommand。在我们的发布日期之前没有足够的时间。

托尼

# c - C - 教授测试代码中的分段错误

> ID：10489118
> 
> 赞同：4
> 
> 时间：2012-05-07T21:04:36.437
> 
> 标签：c, gcc, segmentation-fault

我的教授发送测试代码在我们的程序上运行。但是，测试代码本身在编译时存在分段错误错误。错误发生在第一个 printf 上。但是，如果该行被注释掉，它只会出现在下一行。听起来代码对他来说很好，所以我试图弄清楚为什么它对我来说失败了。我知道他在使用 C++ 时使用 C，但即使我尝试使用 gcc 而不是 g++ 编译测试代码，它仍然失败。任何人都知道为什么我可能会遇到问题？谢谢！代码如下。

```
#include <stdio.h>

main()
{  double A[400000][4],  b[400000], c[4] ;
   double result[4];
   int i, j; double s, t;
   printf("Preparing test: 4 variables, 400000 inequalities\n");
   A[0][0] = 1.0; A[0][1] = 2.0; A[0][2] = 1.0; A[0][3] = 0.0; b[0] = 10000.0;
   A[1][0] = 0.0; A[1][1] = 1.0; A[1][2] = 2.0; A[1][3] = 1.0; b[0] = 10000.0;
   A[2][0] = 1.0; A[2][1] = 0.0; A[2][2] = 1.0; A[2][3] = 3.0; b[0] = 10000.0;
   A[3][0] = 4.0; A[3][1] = 0.0; A[3][2] = 1.0; A[3][3] = 1.0; b[0] = 10000.0;
   c[0]=1.0; c[1]=1.0; c[2]=1.0; c[3]=1.0;
   for( i=4; i< 100000; i++ )
   {  A[i][0] = (12123*i)%104729; 
      A[i][1] = (47*i)%104729; 
      A[i][2] = (2011*i)%104729; 
      A[i][3] = (7919*i)%104729;
      b[i] = A[i][0] + 2*A[i][1] + 3*A[i][2] + 4* A[i][3] + 1 + (i%137);
   }
   A[100000][0] = 0.0; A[100000][1] = 6.0; A[100000][2] = 1.0; 
   A[100000][3] = 1.0; b[100000] = 19.0;
   for( i=100001; i< 200000; i++ )
   {  A[i][0] = (2323*i)%101111; 
      A[i][1] = (74*i)%101111; 
      A[i][2] = (2017*i)%101111; 
      A[i][3] = (7915*i)%101111;
      b[i] = A[i][0] + 2*A[i][1] + 3*A[i][2] + 4* A[i][3] + 2 + (i%89);
   }
   A[200000][0] = 5.0; A[200000][1] = 2.0; A[200000][2] = 0.0; 
   A[200000][3] = 1.0; b[200000] = 11.0;
   for( i=200001; i< 300000; i++ )
   {  A[i][0] = (23123*i)%100003; 
      A[i][1] = (47*i)%100003; 
      A[i][2] = (2011*i)%100003; 
      A[i][3] = (7919*i)%100003;
      b[i] = A[i][0] + 2*A[i][1] + 3*A[i][2] + 4* A[i][3] + 2 + (i%57);
   }
   A[300000][0] = 1.0; A[300000][1] = 2.0; A[300000][2] = 1.0; 
   A[300000][3] = 3.0; b[300000] = 20.0;
   A[300001][0] = 1.0; A[300001][1] = 0.0; A[300001][2] = 5.0; 
   A[300001][3] = 4.0; b[300001] = 32.0;
   A[300002][0] = 7.0; A[300002][1] = 1.0; A[300002][2] = 1.0; 
   A[300002][3] = 7.0; b[300002] = 40.0;
   for( i=300003; i< 400000; i++ )
   {  A[i][0] = (13*i)%103087; 
      A[i][1] = (99*i)%103087; 
      A[i][2] = (2012*i)%103087; 
      A[i][3] = (666*i)%103087;
      b[i] = A[i][0] + 2*A[i][1] + 3*A[i][2] + 4* A[i][3] + 1;
   }

   printf("Running test: 400000 inequalities, 4 variables\n");
   //j = rand_lp(40, &(A[0][0]), &(b[0]), &(c[0]), &(result[0]));
   printf("Test: extremal point (%f, %f, %f, %f) after %d recomputation steps\n", 
          result[0], result[1], result[2], result[3], j);
   printf("Answer should be (1,2,3,4)\n End Test\n");
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-07T21:07:09.063

尝试改变：

```
double A[400000][4],  b[400000], c[4] ; 
```

到

```
static double A[400000][4],  b[400000], c[4] ; 
```

您对`A`数组的声明具有自动存储持续时间，这可能意味着在您的系统上它存储在堆栈中。您的进程的总堆栈可能低于此值，并且您遇到了堆栈溢出。

在 Linux 上，您可以运行以下`ulimit`命令：

```
$ ulimit -s
8192
$ 
```

查看分配给进程的堆栈大小（以 kB 为单位）。例如，我的机器上有 8192 kB。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-07T21:07:01.340

您已经溢出了堆栈的限制。您的教授在`main`的堆栈帧中声明了 15MB 的数据。那太大了。

由于在 main 顶部声明的 ojbect 的生命周期本质上是整个程序，因此只需将对象声明为`static`. 这样，它们将位于（相对无限的）数据段中，并且具有几乎相同的生命周期。

尝试更改此行：

```
double A[400000][4],  b[400000], c[4] ; 
```

对此：

```
static double A[400000][4],  b[400000], c[4] ; 
```

# validation - 复杂的 url 麻烦，我需要一个公共验证器

> ID：10489119
> 
> 赞同：2
> 
> 时间：2012-05-07T21:04:42.317
> 
> 标签：validation, url

我有一个复杂的 url，在某些情况下会导致`403 forbiden page`我很确定它没问题，问题出在 ISP apache 配置上。
所以问题是：是否有一个公共和可靠的`URL checker`，类似于检查 url RFC 兼容的“W3C 标记验证服务”？
非常感谢。

**更新**
我需要一种简单的方法来向三方人员（ISP）显示 url 是好的
url 在评论中（我会在我有解决方案后删除它）
完整的 php 代码什么都不是： `<?php ?>`只是为了测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:12:41.897

有关 URL 的语法，请参见此处：[http ://en.wikipedia.org/wiki/Uniform_resource_locator#Syntax](http://en.wikipedia.org/wiki/Uniform_resource_locator#Syntax)

编辑：

这是你的问题：

您的 URL 中有短语“搜索引擎优化”，它正在捕捉并禁止它。

这是禁止的：[http ://example.com/oo/test_long_url.php?junk=search+engine+optimiz](http://example.com/oo/test_long_url.php?junk=search+engine+optimiz)

这是允许的：[http ://example.com/oo/test_long_url.php?junk=search+engine+optimis](http://example.com/oo/test_long_url.php?junk=search+engine+optimis)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T13:21:29.703

这不是问题的答案，而是解决我的问题。我在这里发帖以防万一它对某人有用。

`the url which is displaying an 403 page, occurs because it is triggering a mod_security rule`

# drupal - 为什么使用/创建 Drupal 7 模块？

> ID：10489123
> 
> 赞同：0
> 
> 时间：2012-05-07T21:05:04.080
> 
> 标签：drupal

您何时实际使用/创建 Drupal 7 的模块？因为就像我看到的那样，您几乎可以使用模板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T13:13:26.937

这就是所谓[的关注点分离](https://en.wikipedia.org/wiki/Separation_of_concerns)。模板就是模板。他们应该处理数据表示和布局。数据的生产、检索、存储和处理不应该在模板中进行。在不同模块中实现的清晰分离的功能简化了维护、演进和代码重用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T07:25:37.393

挂钩核心功能。

# grails - 寻找 grails 服务类的拦截器

> ID：10489124
> 
> 赞同：1
> 
> 时间：2012-05-07T21:05:12.917
> 
> 标签：grails, groovy, grails-orm

是否有任何拦截器可以用来验证对 Grails 服务类/端点的传入请求？我知道控制器的拦截器，但我想为服务/端点做这件事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T22:43:02.707

这听起来像你在找什么： [拦截服务方法](http://redpointtech.blogspot.com/2010/03/grails-intercepting-service-class.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T03:57:41.173

在上面提到的链接中（Kelly 的回复），在 BootStrap 类中添加了 Service 的拦截器逻辑。在大多数情况下这可能就足够了，但不是全部。如果您使用的是 Quartz 调度程序，那么即使在 BootStrap 进行必要的修改之前，作业也可能会被触发。

修改服务方法的最佳位置是通过[自定义插件](http://grails.org/doc/latest/guide/plugins.html)。您可以在插件类中的 doWithApplicationContext 或 doWithDynamicMethod 中装饰服务方法。这些方法首先被触发，并保证所做的更改将可用于所有其他类。请参阅 Grails 自定义插件文档以获取更多信息。

# mysql - 长时间运行的 Rails 迁移步骤似乎没有完成

> ID：10489125
> 
> 赞同：1
> 
> 时间：2012-05-07T21:05:34.337
> 
> 标签：mysql, rake, rails-migrations

我已经设置了一些 rake 迁移。我正在修改的一个表有几十万行，数据长度为 1,962,754,048 字节（本质上是一个 2GB 的表）。这是一个 InnoDB 表。我正在通过 rake 在表中添加几列。

不幸的是，这`change_table`一步永远不会“完成”。在后端运行的查询已完成，但 rake 步骤似乎从未推进。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:17:00.297

它可能与索引问题有关。

我会尝试将您的迁移分解为：

```
Drop all indexes (you can do this in mysql if you want, might be easier).

Add the new columns

Add all required indexes back (If you did this in mysql, do that again, if you dropped the indexes through migrations, add them back thru migrations). 
```

它可能会有所帮助和/或可能有助于查明问题所在。

# python - 在 python 中导入 wx 模块

> ID：10489126
> 
> 赞同：1
> 
> 时间：2012-05-07T21:05:36.990
> 
> 标签：python, import, module, wxwidgets

当我在 python 解释器中导入 wx 模块时，它按预期工作。但是，当我在导入列表中使用 wx 运行脚本（即 test.py）时，我需要编写“python test.py”才能运行该脚本。如果我尝试执行“test.py”，我会收到一个导入错误，指出没有名为“wx”的模块。为什么我需要在命令中包含单词 python？

PS 我找到的最有用的答案是“用于 REPL 的 Python 与运行脚本的 Python 不同。打印 sys.executable 以进行验证。” 但我不明白那是什么意思。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:10:35.767

编写一个两行脚本（例如名为 showexe.py）：

```
import sys
print sys.executable 
```

`showexe.py`以和两种方式运行`python showexe.py`。它会告诉您在这两种情况下是否使用相同的可执行文件。如果不是，那么它将取决于您的操作系统，您必须做什么才能使两者运行相同的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:20:13.403

如果您使用 #!/usr/local/bin/python 之类的内容启动脚本（但使用 python 解释器的路径），您可以在命令中不包含 python 的情况下运行它，例如 bash 脚本。

# jquery - 从 .resizable 'img' 函数中排除 img 文件

> ID：10489127
> 
> 赞同：0
> 
> 时间：2012-05-07T21:05:41.683
> 
> 标签：jquery, draggable, resizable

在我正在处理的页面上有一个 div-id (dragZone)，其中包含单独的 div-id，每个 div-id 包含一个图像，这些都是可拖动的、可调整大小的，并且在单击时会出现。

为了让 .resizable 起作用，我填写了 $('img').resizable ，但这现在当然会影响页面上的所有其他图像。

知道如何使 .resizable 仅影响 dragzone-id 中的图像文件吗？

```
$(document).ready(function() {
var a = 3;
$('#dragZone > div').draggable({
start: function(event, ui) 
{ $(this).css("z-index", a++); }})

$('img').resizable({maxHeight: 600, aspectRatio: true, animate: true });

$('#dragZone > div').click(function() {
    $(this).addClass('top').removeClass('bottom');
    $(this).siblings().removeClass('top').addClass('bottom');
    $(this).css("z-index", a++);

});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:08:40.837

改变

```
$('img').resizable({maxHeight: 600, aspectRatio: true, animate: true }); 
```

到

```
$('#dragZone img').resizable({maxHeight: 600, aspectRatio: true, animate: true }); 
```

这只会在dragZone div中获得img

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:10:20.477

您还可以使用[`find`](http://api.jquery.com/find/)方法在内部查找图像元素`dragZone`：

```
$('#dragZone').find('img').resizable({maxHeight: 600, aspectRatio: true, animate: true }); 
```

# java - 如何编写 JSTL 而不是 Scriplets 来获取用户会话？

> ID：10489130
> 
> 赞同：1
> 
> 时间：2012-05-07T21:05:54.407
> 
> 标签：java, jsp, jakarta-ee, jstl

下列的：

```
<% if ((String) session.getAttribute("userID") != null) { 
     String username= (String) session.getAttribute("userID"); %> 
     <li><a><small>Logged in as <%=username %></a></li> 
<% } %> 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T21:13:45.167

应该管用：

```
<c:if test="${not empty sessionScope.userID}">
  <li><a><small>Logged in as ${sessionScope.userID}</a></li>
</c:if> 
```

# java - 仅在 JSP 中单击按钮时运行脚本

> ID：10489132
> 
> 赞同：1
> 
> 时间：2012-05-07T21:06:02.020
> 
> 标签：java, jsp, netbeans

我是 JSP 的新手，我似乎无法弄清楚如何仅在用户单击按钮时才运行代码。这是我的代码：

$

```
<form action="list_computers.jsp" method="post">                

        Search:
<input type="text" name="FromTextBox1"/>

<input type="submit" value="Search it!" >
   <%

        String TheSearch = (String)request.getParameter("FromTextBox1"); 

        String GetIt = Searcher(TheSearch);

        out.println(GetIt);

   %>
</form> 
```

Searcher() 是我在上面声明的一个函数。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:10:10.147

你需要做类似的事情

```
if (request.getParameter("submit") != null) {
// do work here
} 
```

您还需要为按钮命名

```
<input type="submit" value="Search it!" name="submit"> 
```

当用户点击（或按下回车）时，`request['submit']`将等于`"Search it!"`

我强烈建议将此逻辑移至页面顶部，甚至更好地移至[控制器](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:15:53.673

您需要使用 javascript 来检查 onclick 事件这里有一个 JQuery 的小例子

```
 $("input[type='submit']").click(function(){
      //do your thing
      // use event.preventDefault(); to stop submission if need
 }); 
```

# python - 对 scipy.optimize.leastsq 目标函数的多线程调用

> ID：10489134
> 
> 赞同：3
> 
> 时间：2012-05-07T21:06:04.430
> 
> 标签：python, scipy, mathematical-optimization

我正在`scipy.optimize.leastsq`与模拟器一起使用。`leastsq`调用用户定义的目标函数并将输入向量传递给它。反过来，目标函数返回一个误差向量。`leastsq`以最小化误差向量的平方和的方式优化输入向量。

在我的例子中，目标函数每次被调用时都会运行一个完整的模拟。使用的模拟器是单线程的，每次运行都需要几分钟。因此，我想一次运行模拟器的多个实例。但是，对目标函数的调用是连续执行的。

如何`leastsq`一次对目标函数执行多次调用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-30T09:57:32.197

`leastsq`如果您有多个参数，则可以通过提供自己的函数来计算导数（`Dfun`参数）来加快速度。如果未提供此函数，则`leastsq`每次迭代每个参数以计算导数，这很耗时。这似乎花费了拟合的大部分时间。

您可以使用自己的`Dfun`函数来计算每个参数的导数，使用 a`multiprocessing.Pool`来完成这项工作。这些导数可以独立计算，并且应该简单地并行化。

这是一个粗略的例子，展示了如何做到这一点：

```
import numpy as np
import multiprocessing
import scipy.optimize

def calcmod(params):
    """Return the model."""
    return func(params)

def delta(params):
    """Difference between model and data."""
    return calcmod(params) - y

pool = multiprocessing.Pool(4)

def Dfun(params):
    """Calculate derivatives for each parameter using pool."""
    zeropred = calcmod(params)

    derivparams = []
    delta = 1e-4
    for i in range(len(params)):
        copy = np.array(params)
        copy[i] += delta
        derivparams.append(copy)

    results = pool.map(calcmod, derivparams)
    derivs = [ (r - zeropred)/delta for r in results ]
    return derivs

retn = scipy.optimize.leastsq(leastfuncall, inputparams, gtol=0.01,
                              Dfun=Dfun, col_deriv=1) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-11T13:42:53.260

使用的算法`leastsq`，Levenberg-Marquardt，需要在确定下一个点之前知道当前点的目标函数的值。简而言之，没有直接的方法可以并行化这样的串行算法。

但是，在某些情况下，您可以并行化您的目标函数。这可以做到，如果它的形式是：

```
def objective_f(params):
    r = np.zeros([200], float)
    for j in range(200):
        r[j] = run_simulation(j, params)
    return

def run_simulation(j, params):
    r1 = ... compute j-th entry of the result ...
    return r1 
```

在这里，您可以清楚地在循环上进行并行化`j`，例如使用多处理模块。像这样的东西：（未经测试）

```
def objective_f(params):
    r = np.zeros([200], float)
    def parameters():
        for j in range(200):
            yield j, params
    pool = multiprocessing.Pool()
    r[:] = pool.map(run_simulation, parameters())
    return r 
```

如果您必须拟合多个数据集，则会出现另一个并行化机会 --- 这是一个（令人尴尬的）并行问题，并且可以并行拟合不同的数据集。

如果这没有帮助，您可以查看文献中关于 LM 算法并行化的讨论。例如：[http](http://dl.acm.org/citation.cfm?id=1542338) ://dl.acm.org/citation.cfm?id=1542338 本文建议的主要优化似乎是雅可比行列式数值计算的并行化。您可以通过将自己的并行雅可比函数提供给`leastsq`. 论文的其余建议，推测性地并行化 Levenberg-Marquardt 搜索步骤，但是更难以实现，并且需要更改 LM 算法。

我不知道 Python（或其他语言）库实现了针对并行计算的优化算法，尽管可能有一些。如果您设法实施/找到其中之一，请在 Scipy 用户邮件列表上做广告 --- 肯定对其中之一感兴趣！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-07T21:22:49.647

这有帮助吗？ [http://docs.python.org/library/multiprocessing.html](http://docs.python.org/library/multiprocessing.html)

我一直发现 Pool 是使用 python 进行多进程最简单的方法。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-07T21:23:16.997

NumPy/SciPy 的函数通常针对多线程进行优化。您是否查看了 CPU 利用率以确认在运行模拟时只使用了一个内核？否则，您无法从运行多个实例中获得任何收益。

如果它实际上是单线程的，那么您最好的选择是使用该[`multiprocessing`](http://docs.python.org/library/multiprocessing.html)模块。它运行多个 Python 解释器实例，因此您可以同时调用多个 SciPy。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2018-07-31T07:28:22.037

您是否使用[过 scipy.least_squares](https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.least_squares.html)，这是一个更好的选择，当我使用它来优化函数时，它会使用所有可用线程。因此，正是你问的

# cakephp - CakePHP 和 SOA

> ID：10489139
> 
> 赞同：0
> 
> 时间：2012-05-07T21:06:34.177
> 
> 标签：cakephp, soa

我是一名 PHP 开发人员，想用 PHP 开发一个大型 Web 应用程序。[我有一篇关于使用面向服务架构](http://en.wikipedia.org/wiki/Service-oriented_architecture)(SOA)的 EMR 系统（电子病历）的文章。我正在考虑使用 CakePHP 框架。

CakePHP 适合大型 Web 应用程序吗？它适合 SOA 吗？

我期待着您的指导。

* * *

感谢您的回复 burzum，我正在考虑使用 REST 和 CakePHP 2 来实现它。我在网上找到了一些教程，当然在 cakephp 文档中找到了一些教程，但我很难抓住重点..将 REST 与 CakePHP 一起使用。也许我需要更多关于 RESTful WS 的阅读。欢迎任何建议或额外资源的链接

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:59:04.350

是的，我们在同一领域有一个巨大的应用程序，有超过 250 个表格，它运行良好且快速。我们使用了很多缓存技术并使用 PostgreSql。

我建议你在开始构建这样一个需要高安全标准和良好性能的大型应用程序之前，遵循框架的约定并获得一些框架的经验。

当谈到这个性能废话时，我会说你使用哪个框架并不重要，重要的是你的程序员团队可以如何使用框架的力量。使用任何框架，您都可以成功或构建大量失败。我在 CakePP 中见过这两种情况。

我们最近玩了一个小小的废话宾果游戏，用基准测试来取乐，事实上，如果我们同时使用多个请求，CakePHP 2.1 在他们自己的愚蠢基准测试中击败了 Yii（只是呼应了一些东西）。使用单个请求 Yii 更快。

# mongodb - mongo 的 MR 可以将结果写入另一个分片集合吗？

> ID：10489146
> 
> 赞同：0
> 
> 时间：2012-05-07T21:07:06.097
> 
> 标签：mongodb, mapreduce, bigdata, nosql

根据 Mongo MR 文档 ( [http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-ShardedEnvironments](http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-ShardedEnvironments) )，分片数据上的 MR 作业的输出可以将结果写入另一个分片集合，但是只有 _ID可以用作分片键。

有没有办法发出或设置将分配给结果文档的_ID？说使用本身用作分片键的 UserID 或 CustomerNo？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:39:48.467

Map-Reduce 生成的文档中的 与您在映射阶段`_id`使用的键相同。`emit(...)`它可以是任何类型，包括（子）文档，但它将始终作为`_id`最终文档中的字段出现。

如果您有一个目标（分片）集合使用一些自定义值而不是`ObjectId`的值`_id`，则可以使用分片 map-reduce 并将输出输出到该集合中。

分片 map-reduce 也有一些限制，特别是 map-reduce 不会触发拆分或迁移，并且`limit`不支持该选项。

# wpf-controls - WPF 从 CollectionView 获取数据值并将它们放入变量中

> ID：10489147
> 
> 赞同：1
> 
> 时间：2012-05-07T21:07:06.830
> 
> 标签：wpf-controls, wpfdatagrid

我想知道如何从 a 中的表中获取值`DataViewCollection`并将它们放入变量中。

我已经购买并阅读了许多书籍，购买并观看了许多视频，但没有向我展示我想要的东西。它们都向您展示了如何在控件或对象的屏幕上显示数据。

# sql - 需要在 SQL Server 2000 中替代使用 Cross Apply

> ID：10489154
> 
> 赞同：1
> 
> 时间：2012-05-07T21:07:35.843
> 
> 标签：sql, sql-server

我使用 CROSS APPLY 参数编写了以下脚本，该脚本在我的 SQL Server 2008 开发人员数据库中运行良好，但它不适用于拥有 SQL Server 2000 数据库并且不想更改 SSMS 中的兼容性设置的客户端。

有人可以建议一种方法来转换下面的脚本以免使用 CROSS APPLY 参数吗？谢谢！

```
DECLARE @Flag INT
SET @Flag = 1
WHILE (@Flag < (SELECT TOP 1 (COUNT(CUSTOMERPN)) AS COUNTCUST FROM FC_Nestle
GROUP BY CustomerPN
ORDER BY COUNTCUST DESC))
BEGIN
--UPDATE AFS_TOPRODUCE COUNTS
UPDATE FC_Nestle
SET AFS_ToProduce = CustReqQty - AFS_OH
--UPDATE SUBSEQUENT AFS_OH INVENTORY COUNTS
update FC_Nestle 
set AFS_OH = - fc2.AFS_ToProduce 
from FC_Nestle 
CROSS APPLY 
(   
    select fc2.AFS_ToProduce   
    from    
    (     
        select top 1         
            fc2.AFS_ToProduce       
        from FC_Nestle fc2      
        where fc2.ForecastID < FC_Nestle.ForecastID and fc2.CustomerPN = FC_Nestle.CustomerPN     
        order by fc2.ForecastID desc   
    ) fc2   
    where fc2.AFS_ToProduce < 0 
) fc2 
where FC_Nestle.AFS_ToProduce > 0 
SET @Flag = @Flag + 1
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:55:56.023

这应该可以帮助您：

```
update fc_test
   set AFS_OH = - fc2.AFS_ToProduce
  from fc_test
 -- Self join to find previous row
 inner join fc_test fc2
 -- which has lower forecastid
    on fc2.ForecastID < fc_test.ForecastID
 where fc_test.AFS_ToProduce > 0
 -- and negative afs_toproduce
   and fc2.afs_toproduce < 0
 -- and is a row immediately before
 -- ie there is no other row closer to fc_test then current fc2
   and not exists (select null 
                     from fc_test fc3
                    where fc3.forecastid > fc2.forecastid
                      and fc3.ForecastID < fc_test.ForecastID) 
```

我使用与上次相同的表名和列名。

现场测试在[Sql Fiddle](http://sqlfiddle.com/#!3/00879/10)。

# git - git :: 合并本地和远程分支中不同文件夹的文件

> ID：10489157
> 
> 赞同：3
> 
> 时间：2012-05-07T21:07:59.483
> 
> 标签：git, merge, rename, conflict

我正在重新设计项目的目录结构，因此我将大量文件从一个文件夹移动到本地分支中的另一个文件夹。在远程分支中，伙计们已经进行了一些重构，并且将一些文件移动到了另一个文件夹。现在，当与远程合并时，我遇到了这样的冲突：

```
added by us: module/src/main/java/com/test/tool/MyClass.java
...
added by them: src/com/test/tool/overlay/MyClass.java 
```

在这一点上，我不清楚如何解决这种冲突 - 我应该手动将文件从*src/com/test/tool/overlay/MyClass.java*移动到*module/src/main/java/com/test/tool/ MyClass.java*然后使用*git add*，或者有另一种首选方式，它会记录这个变化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:14:28.307

在这种情况下，沟通与工具同样重要。但是我的简短回答是，如果其他人已经提交了一些重构并且您的本地副本尚未反映这一点，那么您将在重新尝试合并之前在本地解决冲突。一个 git rebase 可能会带来这些新的变化，然后相应地更新你的文件？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:16:48.880

始终建议手动解决合并冲突。所以是的，手动移动文件，然后使用 Git add 上传新的文件夹结构。

# c# - serialport 多线程主动消息

> ID：10489166
> 
> 赞同：0
> 
> 时间：2012-05-07T21:08:46.050
> 
> 标签：c#, multithreading, serial-port

我有 C# 多线程应用程序，它必须使用 SerialPort 与硬件接口。

该程序主要是命令响应序列，但由于内部错误，硬件可以发送未经请求的“RESET”消息，此时软件必须通过发送设置某些值的命令序列来重新初始化它。

多个线程（来自线程池）可以尝试执行 TakeSampleNow()

```
public class ALComm
{
    private readonly AutoLoaderManager _manager;
    private readonly AutoResetEvent dataArrived = new AutoResetEvent(false);
    private SerialPort _alPort;
    private string _alResponse;

   .... Code to init _alPort and attach datareceived event etc

   public void TakeSampleNow()
    {
        if (Monitor.TryEnter(_alPort, 1000)) //let's wait a second
        {
            _manager.MessageList.Enqueue("Try sampling");
            try
            {
               Send("Command1");
               string response = Receive();

               switch(response)
                {
                   case "X": blah blah..
                   case "Y": blah blah..
                } 

               Send("Command2");
               string response = Receive();

               while(response != "OK")
                 {
                   Send("Command3");
                   string response = Receive();
                   Send("Command2");
                   string response = Receive();
                 }
            }
            finally
            {
                Console.WriteLine("Releasing port");
                //Thread.CurrentThread.Priority = ThreadPriority.Normal;
                Monitor.Exit(_alPort);
            }
        else
        {
            _manager.MessageList.Enqueue("Port is busy!!!");
        }
   }

    public string Receive()
    {
        string inString = null;

            dataArrived.WaitOne(1000);
            inString = _alResponse;

        return inString;
    }

    private void AlPort_DataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        _alResponse = _alPort.ReadLine();

        //if (_alResponse.ToUpper().Contains("RESET"))
        //{
        //    _alState = AlState.Reset;
        //    TryInitialize();
        //}

        dataArrived.Set();            
    }

    private void TryInitialize()
    {
        Monitor.Enter(_alPort);       //lock so other threads do not access samplenow during initialization
        try
        {
            string response;

            Console.WriteLine("Initializing ... The AutoLoader");
            _alPort.DiscardInBuffer();

            Send("CommandX");
            response = Receive();

            --- blah blah

           _alResponse = "";
        }
        finally
        {
            Monitor.Exit(_alPort);
        }
    } 
```

我可以检查 datareceived 事件中的响应并等待 TryInitialize() 中的锁定以及 TakeSampleNow 中的其他线程释放锁定，如果 _alResponse 包含“RESET”并且它是否确实从该方法返回，我将不得不检查每个响应. 这使它更加复杂。

关于如何更好地做到这一点的任何建议。我相信它可以是一个状态机，但无法将其概念化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:37:55.030

您不希望有多个线程尝试读取您的串行端口。您应该有一个除了读取端口之外什么都不做的线程。当它获取一些数据时，它会将消息放入可由多个样本线程处理的队列或类似的数据结构中。这样，您的单个阅读器线程可以可靠地找到并响应 RESET 消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:57:11.313

您没有提供协议的太多细节 - 您没有说命令/响应对是否可以重叠，如果可以，响应如何与命令匹配。

您应该能够使用状态引擎执行此操作。使用自己的线程运行状态机，该线程在 BlockingCollection 上等待事件。您还需要一个“SerialRecv”线程来运行您的协议并将传入的字节解析为消息。

我将只使用一个“SerialEvent”类将事件传送到 SM 队列中。该类应该有一个枚举来描述事件和 rx 缓冲区的成员、txData、解析的数据、用于组装 tx 字符串的数据、异常/errorMess 字段 - 任何事件或转发目的所需的一切，（例如，SM 可能将完成的请求/响应转发到显示器或记录器）。

我可以直接想到的一些事件：EsmNewRequestResponse,EsmRxData,EsmResetRx

事件枚举可能与某些阶段一样，具有 SM 未使用的其他值，例如：EsmError,EsmLog,EsmDisplay。

如果您需要超时，您可以通过超时 SM 输入队列上的 take() 来生成一个。

是的，有些东西我遗漏了。

如果多个线程“一次”发出 SerialEvent 实例，则 SM 将在处理第一个时获得新的 SerialEvents。SM 将需要另一个队列/双端队列来保存等待处理的 SerialEvents。由于 BlockingCollection/线程对 SM 进行了序列化，因此这个“待处理”队列不必是线程安全的。在任何请求/响应完成后，SM 应检查此挂起队列，以查看是否还有另一个要处理。

要同步处理来自多个线程的请求/响应，请求线程必须有东西等待。SerialEvent 类中的 AutoResetEvent 就可以了。向系统提交 SerialEvent 将使 SerialEvent 实例排队并等待 AutoResetEvent。当实例处理完成时（即收到响应、错误或超时），SM 将设置事件，并且源线程将继续运行，其 SerialEvent 实例填充数据。

接下来 - SerialEvent 类正朝着将它们汇集而不是不断创建/CG 更好的地步。那将需要另一个 BlockingCollection 来充当池。

# node.js - node - 通过网络套接字发送大型 JSON

> ID：10489168
> 
> 赞同：3
> 
> 时间：2012-05-07T21:08:54.103
> 
> 标签：node.js

问题是通过网络套接字发送大型序列化 JSON（超过 16,000 个字符）会被分成块。每个块都会`data`在接收端触发事件。因此，简单地`JSON.parse()`在传入数据上运行可能会失败`SyntaxError: Unexpected end of input`。

到目前为止，我设法提出的解决方法是将一个空字符 ( `'\u0000'`) 附加到序列化 JSON 的末尾，并在接收端检查它。这是一个例子：

```
var partialData = '';
client.on( 'data', function( data ) {
    data = data.toString();
    if ( data.charCodeAt( data.length - 1 ) !== 0 ) {
        partialData += data;
        // if data is incomplete then no need to proceed
        return;
    } else {
        // append all but the null character to the existing partial data
        partialData += data.substr( 0, data.length - 1 );
    }
    // pass parsed data to some function for processing
    workWithData( JSON.parse( partialData ));
    // reset partialData for next data transfer
    partialData = '';
}); 
```

该模型的失败之一是接收器连接到多个套接字，并且每个套接字都在发送大型 JSON 文件。

我这样做的原因是因为我需要在同一个盒子上运行的两个进程之间传递数据，而且我不喜欢使用端口。因此使用网络套接字。所以会有两个问题：首先，有没有更好的方法在两个 Node.js 进程之间快速传递大量 JSON 数据？其次，如果这是最好的方法，那么我怎样才能更好地处理序列化的 JSON 在发送时被分成块的情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T05:56:12.723

1.  您可以每次都使用 try...catch 来查看它是否是有效的 json。虽然不是很好的表现。
2.  您可以在发送端计算 json 的大小并在 JSON 之前发送它。
3.  您可以附加一个不太可能在 JSON 中的边界字符串。您的 \u0000 - 是的，这似乎是一种合法的方式。但最受欢迎的选择是换行符。

4.  您可以使用像 dnode 这样的外部库，它应该已经做了我之前提到的事情。我建议尝试一下。真的。

> 该模型的失败之一是接收器连接到多个套接字，并且每个套接字都在发送大型 JSON 文件。

为每个套接字使用不同的缓冲区。这里没问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-11T22:59:26.053

可以单独识别每个套接字并为每个套接字构建缓冲区。当我收到连接时，我向每个套接字添加一个 id，然后当我收到数据时，我将该数据添加到缓冲区。

```
net.createServer( function(socket) {
  // There are many ways to assign an id, this is just an example.
  socket.id = Math.random() * 1000;
  socket.on('data', function(data) {
    // 'this' refers to the socket calling this callback.
    buffers[this.id] += data;
  });
}); 
```

每次您都可以检查是否收到了“密钥”分隔符，它会告诉您缓冲区已准备好使用。

# c++ - 似乎无法从我的代码块中获得正确的输出

> ID：10489169
> 
> 赞同：-1
> 
> 时间：2012-05-07T21:08:54.173
> 
> 标签：c++

我只是想知道是否有人注意到我的代码块有问题。这个程序应该是一个比较 2 个日期的测试程序。如果调用日期更大，我正在处理的函数应该返回 1，如果调用日期小于，则返回 -1，如果调用日期等于参数中的日期，则返回 0。我的测试程序：

```
#include <cstdlib>
#include <iostream>
#include <string>

#include "date.h"

using namespace std;

//date is initialized in a month/day/year format.

int main(int argc, char* argv[])
{
    string* d;

    date d1(4,1,4);
    date d4(4,4,4);

    int greaterTest = d4.compareTo(d1);
    int lessTest = d1.compareTo(d4);

    cout << greaterTest << endl;               //i believe these two lines are printing out a
    cout << lessTest << endl;                  //location in memory
    cout<<&d <<endl;

    system("pause");
    return EXIT_SUCCESS;
} 
```

巨大的 compareTo() 函数：

```
 int date::compareTo (date another_date)
{

    if (this->year == another_date.year && this->month == month && this->day < another_date.day)    //if both year and month are the same, test to see if day is less
    {

        return -1;
    }

    else if (this->year == another_date.year && this->month == month && this->day > another_date.day)   //if both year and month are the same, test to see if day is greater
    {

        return 1;
    }

    else if (this->year == another_date.year && this->month > month)                            //if the years are the same, test to see if the invoking month is greater
    {

        return 1;
    }

    else if (this->year == another_date.year && this->month < month)                            //if the years are the same, test to see if the invoking month is less
    {

        return -1;
    }

    else if (this->year > another_date.year)                                                    //test to see if the invoking year is greater
    {

        return 1;
    }

    else if (this->year < another_date.year)                                                    //test to see if the invoking year is less
    {

        return -1;
    }

    else if(this-> year == another_date.year && this-> month == another_date.month                  //test if the dates are exactly the same
        && this-> day == another_date.day)
    {

        return 0;
    } 

    //else{ return 15;}                                                                             //if none are true, return 15

} 
```

我得到的唯一问题是当我尝试更改日期（日期的第二个参数）时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:13:21.800

我不确定这是否是问题，因为我无法测试它......但是，你的`compareTo`函数有这一行：

```
this->month == month 
```

不应该是：

```
this->month == another_date.month 
```

?

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:13:46.930

在第一个 if 语句和它下面的几个语句中，你有：

```
 this->month == month 
```

这是将月份与自身进行比较，我认为您的意思是：

```
 this->month == another_date.month 
```

你也不需要一直使用'this'指针，

```
month == another_date.month 
```

应该足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T21:14:32.157

这可能会受益于一些提前退出：

```
int date::compareTo (date another_date)
{
    if (year > another_date.year) {
       //the invoking year is greater
       return 1;
    }

    if (year < another_date.year) {
       //the invoking year is less
       return -1;
    }

    // if we reached here, the years are the same.  Don't need to compare them for the other cases

    if (month > another_date.month) {
       return 1;
    }

    if (month < another_date.month) {
       return -1;
    }

    // if we reached here, the year and month are the same

    if (day > another_date.day) {
       return 1;
    }

    if (day < another_date.day) {
       return -1;
    }

    // if we reached here, the year and month and day are the same
    return 0;
} 
```

一路上，剪切+粘贴错误只是......消失了，因为那个测试变得多余了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T21:16:21.957

我没有在您的原始代码中找到您的错误，因为它对我来说太难阅读了。我想这也是你没有找到的原因。

这种替代方案可能更容易阅读，也更容易证明是正确的：

```
// untested
int date::compareTo (date another_date)
{

    if (year < another_date.year) return -1;
    if (year > another_date.year) return 1;
    if (month < another_date.month) return -1;
    if (month > another_date.month) return 1;
    if (day < another_date.day) return -1;
    if (day > another_date.day) return 1;
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-07T21:16:30.413

除非您真的打算进行逐个元素的比较，否则我会将每组输入放入 a`struct tm`中，然后使用`mktime`将它们转换为 a ，然后直接`time_t`比较这两个`time_t`s。在典型情况下，这些将是自 1970 年 1 月 1 日午夜以来的秒数的 32 位或 64 位整数，因此在转换之后，比较变得微不足道。

# android - 什么是dexopt？（Android Shell 命令）

> ID：10489171
> 
> 赞同：9
> 
> 时间：2012-05-07T21:09:21.937
> 
> 标签：android, shell, command, dexopt

Android shell 命令 dexopt 有什么作用？

我在哪里可以找到手册？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-10T18:48:24.510

`dexopt`是一个系统内部工具，用于生成优化的[dex 文件](https://stackoverflow.com/a/7750464/3063884)。

源代码可在此处获得：[https ://android.googlesource.com/platform/dalvik-snapshot/+/gingerbread/dexopt/OptMain.c](https://android.googlesource.com/platform/dalvik-snapshot/+/gingerbread/dexopt/OptMain.c)

文档也[包含在源代码中](https://android.googlesource.com/platform/dalvik-snapshot/+/gingerbread/docs/dexopt.html)；这是一个人类可读的版本： http: [//www.netmite.com/android/mydroid/dalvik/docs/dexopt.html](http://www.netmite.com/android/mydroid/dalvik/docs/dexopt.html)

# node.js - 为什么我的 restify JSON 客户端不起作用？

> ID：10489173
> 
> 赞同：1
> 
> 时间：2012-05-07T21:09:32.077
> 
> 标签：node.js, restify

我在这里按照示例

[http://mcavage.github.com/node-restify/#JsonClient](http://mcavage.github.com/node-restify/#JsonClient)

如下

```
 var client = restify.createJsonClient({
        url: 'http://api.stackoverflow.com'
    });
    client.get('/1.1/users/19068', function(err, req, res, obj) {
      assert.ifError(err);
      console.log('%j', obj);
    }); 
```

我收到以下错误消息

```
 SyntaxError: Unexpected token
  at Object.parse (native)
  at /.../node_modules/restify/lib/clients/json_client.js:54:20
  at IncomingMessage.<anonymous> (/.../node_modules/restify/lib/clients/string_client.js:149:16)
  at IncomingMessage.g (events.js:156:14)
  at IncomingMessage.emit (events.js:88:20)
  at HTTPParser.onMessageComplete (http.js:137:23)
  at Socket.ondata (http.js:1147:24)
  at TCP.onread (net.js:354:27) 
```

# html - 如何设置 XMLDOMDocument 的文档类型？

> ID：10489176
> 
> 赞同：5
> 
> 时间：2012-05-07T21:09:34.807
> 
> 标签：html, doctype, msxml

我怎样才能设置`doctype`一个`DOMDocument60`对象？

例如我尝试：

```
IXMLDOMDocument60 doc = new DOMDocument60();
doc.doctype.name = "html"; 
```

除了那`IXMLDOMDocumentType.name`是**只读的**：

```
IXMLDOMDocumentType = interface(IXMLDOMNode)
{
   ['{2933BF8B-7B36-11D2-B20E-00C04F983E60}']
   string Get_name();
   ...
   property String name read Get_name;
} 
```

并且`IXMLDOMDocument60.doctype`是**只读的**：

```
IXMLDOMDocument = interface(IXMLDOMNode)
{
   ['{2933BF81-7B36-11D2-B20E-00C04F983E60}']
   IXMLDOMDocumentType Get_doctype();
   ...
   property IXMLDOMDocumentType doctype read Get_doctype;
} 
```

那么如何设置`doctype`XML 文档的属性呢？

* * *

**奖励问题：**我如何*创建*一个`DOMDocument60`指定的对象`doctype`？

* * *

**注意：**您没有看到 XSLT 的提及，因为没有。我正在 MSXML 中构建一个 HTML DOM 树。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-08-21T07:19:18.600

出于[性能原因](https://blogs.msdn.microsoft.com/marcelolr/2009/11/30/msxml-xhtml-dtds-making-the-web-better/)和[安全原因](https://msdn.microsoft.com/en-us/library/ms754611(v=vs.85).aspx)，Microsoft 通常不允许`<!DOCTYPE>`（又名[Document Type Definition](https://www.w3.org/TR/xml/#dt-docent)）。因此，您必须使用`loadXML`方法来设置`<!DOCTYPE>`. 因此，在创建或导入文档后无法设置。

最重要的是，由于[MSXML6](https://msdn.microsoft.com/en-us/library/ms762632(v=vs.85).aspx)中的默认安全设置，您通常无法导入具有`<!DOCTYPE>`. 因此，您必须禁用[`ProhibitDTD`](https://msdn.microsoft.com/en-us/library/ms762632(v=vs.85).aspx)对象上的设置。

**编辑：**您应该知道[HTML5**不是**XML](http://w3c.github.io/html/introduction.html#html-vs-xhtml)。此外，[对于 XHTML5](https://html.spec.whatwg.org/multipage/xhtml.html#writing-xhtml-documents)`<!DOCTYPE>` ，被认为是可选的。

首先，让我们从所需的输出开始。

```
<!DOCTYPE html>
<html /> 
```

根据语法，我假设您使用的是 C# 并添加了对`msxml6.dll`. 以下代码将允许您创建这两个处理指令。

```
MSXML2.DOMDocument60 doc  = new MSXML2.DOMDocument60();

// Disable validation when importing the XML
doc.validateOnParse = false;
// Enable the ability to import XML that contains <!DOCTYPE>
doc.setProperty("ProhibitDTD", false);
// Perform the import
doc.loadXML("<!DOCTYPE html><html />");
// Display the imported XML
Console.WriteLine(doc.xml); 
```

这里也是用 VBScript 编写的代码的副本。

```
Set doc = CreateObject("MSXML2.DOMDocument.6.0")

' Disable validation when importing the XML
doc.validateOnParse = False
' Enable the ability to import XML that contains <!DOCTYPE>
doc.setProperty "ProhibitDTD", false
' Perform the import
doc.loadXML "<!DOCTYPE html><html />"
' Display the imported XML
WScript.Echo objXML.xml 
```

最后，这是用 C++ 编写的代码的副本。

```
#include <comutil.h>
#pragma comment(lib, "comsuppw.lib")
#include <msxml6.h>
#pragma comment(lib, "msxml6.lib")

int main(int argc, char* argv[])
{

    HRESULT hr = S_OK;
    VARIANT_BOOL success = VARIANT_TRUE;
    // IXMLDOMDocument2 is needed for setProperty
    IXMLDOMDocument2 *doc;

    // Initialize COM
    hr = CoInitialize(NULL);
    if (SUCCEEDED(hr))
    {
        // Create the object
        hr = CoCreateInstance(CLSID_DOMDocument60, NULL, CLSCTX_INPROC_SERVER, IID_IXMLDOMDocument2, (void**)&doc);
        if (SUCCEEDED(hr))
        {
            // Disable validation when importing the XML
            hr = doc->put_validateOnParse(VARIANT_FALSE);
            // Enable the ability to import XML that contains <!DOCTYPE>
            hr = doc->setProperty(_bstr_t(L"ProhibitDTD"), _variant_t(VARIANT_FALSE));
            // Perform the import
            hr = doc->loadXML(_bstr_t(L"<!DOCTYPE html><html />"), &success);
            // Retrieve the XML
            _bstr_t output{};
            hr = doc->get_xml(output.GetAddress());
            // Display the imported XML
            MessageBoxW(NULL, output, NULL, 0);
        }
        // Cleanup COM
        CoUninitialize();
    }
    return 0;
} 
```

# maven - Maven 中的 WSO2 BAM 2.0 库

> ID：10489177
> 
> 赞同：0
> 
> 时间：2012-05-07T21:09:38.867
> 
> 标签：maven, wso2, wso2bam

我正在尝试在 WSO2 BAM ALPHA2 版本中复制 KPIAgent 示例，但使用 maven 来获取项目运行所需的库。

所以我定义了以下依赖项：

```
<dependency>
    <groupId>org.wso2.carbon</groupId>
    <artifactId>org.wso2.carbon.bam.agent</artifactId>
    <version>3.2.4</version>
</dependency>
<dependency>
    <groupId>org.wso2.carbon</groupId>
    <artifactId>org.wso2.carbon.bam.data.publisher.util</artifactId>
    <version>3.2.0-SNAPSHOT</version>
</dependency>
<dependency>
    <groupId>org.wso2.carbon</groupId>
    <artifactId>org.wso2.carbon.bam.service</artifactId>
    <version>3.2.1</version>
</dependency>
<dependency>
    <groupId>com.google.common.wso2</groupId>
    <artifactId>google-collect</artifactId>
    <version>1.0.0.wso2v2</version>
</dependency>
<dependency>
    <groupId>libthrift.wso2</groupId>
    <artifactId>libthrift</artifactId>
    <version>0.5.wso2v1</version>
</dependency>
<dependency>
    <groupId>commons-pool.wso2</groupId>
    <artifactId>commons-pool</artifactId>
    <version>1.5.0.wso2v1</version>
</dependency> 
```

与他们一起，我以这种方式定义了 WSO2 存储库：

```
<repository>
    <id>wso2-maven2-repository</id>
    <name>WSO2 Maven2 Repository</name>
    <url>http://dist.wso2.org/maven2</url>
    <snapshots>
    <enabled>true</enabled>
    </snapshots>
    <releases>
    <enabled>true</enabled>
    <updatePolicy>never</updatePolicy>
    <checksumPolicy>fail</checksumPolicy>
    </releases>
</repository> 
```

我遇到的问题是[http://dist.wso2.org/maven2/org/wso2/carbon/org.wso2.carbon.bam.agent/3.2.4/org.wso2.carbon.bam的远程 pom 文件.agent-3.2.4.pom](http://dist.wso2.org/maven2/org/wso2/carbon/org.wso2.carbon.bam.agent/3.2.4/org.wso2.carbon.bam.agent-3.2.4.pom)指

```
<parent>
    <groupId>org.wso2.carbon</groupId>
    <artifactId>data-agents</artifactId>
    <version>3.2.4</version>
</parent> 
```

哪个不存在。

我认为这是由于组件源的重新排列而发生的，该重新排列尚未完全反映在存储库中；从而导致这种不一致。

那么问题是，我应该使用哪一组依赖项来使用 EventReceiver 来发布我自己的事件？

预先感谢您的支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T05:40:26.573

正如您出于某种原因提到的那样，它似乎不在回购中。您可以尝试将下面给出的 pom 安装到您的本地存储库中，看看它是否有效。

[http://pastebin.com/AcmR1xmW](http://pastebin.com/AcmR1xmW)

# powershell - 检查 UNC 路径上的访问被拒绝

> ID：10489178
> 
> 赞同：0
> 
> 时间：2012-05-07T21:09:41.337
> 
> 标签：powershell

使用 PowerShell，我正在努力寻找一种机制来确定路径是否真的不存在，或者我是否没有权限。例如，如果我在有效但我没有权限的路径上使用“Test-Path”命令行开关，则结果将为 $false。我更喜欢使用 try / catch 块来尝试命令并捕获 unathorizedAccessException 异常或 ItemNotFoundException 异常并相应地处理响应。

任何援助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-29T10:11:40.943

可能如果您正在使用调用命令并且访问被拒绝，那么您需要使用`Cred-SSP`.

例如：

```
$UserName='<username>'
$securekey= ConvertTo-SecureString '<secure-key>' -AsPlainText -Force;
$credentialdetail= New-Object System.Management.Automation.PSCredential -ArgumentList $UserName,$securekey;

Invoke-Command -Credentials $credentialdetail -ComputerName '<computername>' -Authentication CredSSP -ScriptBlock { '<...>' } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T05:02:57.117

我个人使用此 .net 代码来捕获访问共享或本地路径的异常：

在 powershell 中添加此类型

```
add-type @"
using System;
using System.IO;

public class CheckFolderAccess {

 public static string HasAccessToWrite(string path)
        {
            try
            {
                using  (FileStream fs = File.Create(Path.Combine(path, "Testing.txt"), 1, FileOptions.DeleteOnClose))
                { }
                return "Allowed";
            }
            catch (Exception e)
            {
                return e.Message;
            }
        }

}
"@ 
```

以这种方式使用它：

```
> [checkfolderaccess]::HasAccessToWrite("\\server\c$\system volume information")
Access to path '\\server\c$\system volume information\Testing.txt' denied.

> [checkfolderaccess]::HasAccessToWrite("\\nonexistingserver\nonexistingpath")
Path not found. 
```

# image - 在 magento 中检索产品自定义媒体图像标签

> ID：10489180
> 
> 赞同：1
> 
> 时间：2012-05-07T21:09:48.617
> 
> 标签：image, magento, product

我的首页上有一个自定义块加载产品，它通过以下方式加载具有自定义产品图片属性的四种最新产品：

```
$_helper = $this->helper('catalog/output');
$_productCollection = Mage::getModel("catalog/product")->getCollection();
$_productCollection->addAttributeToSelect('*');
$_productCollection->addAttributeToFilter("image_feature_front_right", array("notnull" => 1));
$_productCollection->addAttributeToFilter("image_feature_front_right", array("neq" => 'no_selection'));
$_productCollection->addAttributeToSort('updated_at', 'DESC');
$_productCollection->setPageSize(4); 
```

我想要做的是抓住`image_feature_front_right`后端设置的标签，但一直无法这样做。这是我在前端显示产品的代码：

```
<?php foreach($_productCollection as $_product) : ?>
    <div class="fll frontSale">
        <div class="productImageWrap">
            <img src="<?php echo $this->helper('catalog/image')->init($_product, 'image_feature_front_right')->directResize(230,315,4) ?>" />
        </div>
        <div class="salesItemInfo">
            <a href="<?php echo $this->getUrl($_product->getUrlPath()) ?>"><p class="caps"><?php echo $this->htmlEscape($_product->getName());?></p></a>
            <p class="nocaps"><?php echo $this->getImageLabel($_product, 'image_feature_front_right') ?></p>
        </div>
    </div> 
```

我读到这`$this->getImageLabel($_product, 'image_feature_front_right')`是这样做的方法，但什么也没产生。我究竟做错了什么？

谢谢！

特雷

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-08T00:59:23.457

您似乎在另一个线程中提出了同样的问题，因此为了帮助可能正在寻找答案的其他人，我也会在这里回答：

我想这是某种 magento 错误。问题似乎是 Magento 核心没有设置 custom_image_label 属性。而对于默认的内置图像 [image, small_image, thumbnail_image] 它确实设置了这些属性 - 因此您可以执行以下操作：

```
$_product->getData('small_image_label'); 
```

如果您查看`Mage_Catalog_Block_Product_Abstract::getImageLabel()`它，只需将“_label”附加到`$mediaAttributeCode`您作为第二个参数传入的那个并调用`$_product->getData()`.

如果您打电话`$_product->getData('media_gallery');` ，您会看到自定义图像标签可用。它只是嵌套在一个数组中。所以使用这个功能：

```
function getImageLabel($_product, $key) {
    $gallery = $_product->getData('media_gallery');
    $file = $_product->getData($key);
    if ($file && $gallery && array_key_exists('images', $gallery)) {    
        foreach ($gallery['images'] as $image) {
            if ($image['file'] == $file)
                return $image['label'];
        }
    }
    return '';
} 
```

扩展 Magento 核心代码是谨慎的（理想情况下`Mage_Catalog_Block_Product_Abstract`，但我不认为 Magento 允许您覆盖抽象类），但如果您需要快速破解 - 只需将此函数粘贴到您的 phtml 文件中，然后调用：

```
<?php echo getImageLabel($_product, 'image_feature_front_right')?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-07T21:53:53.430

您的自定义块需要从 Mage_Catalog_Block_Product_Abstract 继承才能访问该方法。

您也可以直接从模板中的方法使用代码：

```
$label = $_product->getData('image_feature_front_right');
if (empty($label)) {
    $label = $_product->getName();
} 
```

# string - SQL Server 将表格内容转换为合并语句？

> ID：10489184
> 
> 赞同：18
> 
> 时间：2012-05-07T21:09:55.077
> 
> 标签：string, sql-server-2008, export

我有一个在“位置 A”中更改的查找数据表，我需要更新“位置 B”中相同的命名表。我在想，如果我有办法将表格（80k 行）逐行读取为格式正确的字符串，并使用合并语句创建输出文件（将表格“转换”为 CTE），那么我可以有一些光滑的东西。

对这个想法的所有想法（或那些已经做过类似事情的人的指点）都表示赞赏。谢谢。我正在使用 SQL Server Express 2012。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-07T22:01:47.677

我使用这个帮助脚本来管理环境之间的小型查找表。80k 行无论如何都不算​​大，但也不是微不足道的。康拉德为移动大量数据制定了[可靠的计划。](https://stackoverflow.com/a/10489293/3769)

如果您确实选择使用生成的合并路线，希望这可以帮助您：

```
declare @TableName nvarchar(128) = 'dbo.YourTable';

--// do not modify
set nocount on; 

if  (   isnull(parsename(@TableName, 1), '') = '' or
        isnull(parsename(@TableName, 2), '') = ''
    )
begin
    raiserror('@TableName should be in form of owner.object (dbo.Yak). Cannot continue.', 16, 1, @TableName);
    return;
end
if object_id(@TableName) is null
begin
    raiserror('Table [%s] not found. Cannot continue.', 16, 1, @TableName);
    return;
end
if objectproperty(object_id(@TableName), N'TableHasPrimaryKey') = 0
begin
    raiserror('Table [%s] has no primary key defined. Cannot continue.', 16, 1, @TableName);
    return;
end

declare @output varchar(max)='', @return int, @sql varchar(max) = '', @list varchar(max) = '', @exec nvarchar(max), @Cols varchar(max)='',
        @sCols varchar(max)='', @aCols varchar(max)='', @pCols varchar(max)='', @uCols varchar(max)='', 
        @b char(1) = char(13), @t char(1) = char(9);

select  @exec = isnull(@exec + '+' + @b,'') + ''','' +' +
        case 
            when c.data_type in ('uniqueidentifier') 
                then @t + '''''+isnull('''''''' + convert(varchar(50),' + c.column_name + ') + '''''''',''null'')'
            when c.data_type in ('xml') 
                then @t + '''''+isnull('''''''' + convert(varchar(max),' + c.column_name + ') + '''''''',''null'')'
            when c.data_type in ('char', 'nchar', 'varchar', 'nvarchar', 'sysname') 
                then @t + '''''+isnull('''''''' + replace(' + c.column_name + ','''''''','''''''''''') + '''''''',''null'')'
            when c.data_type in ('datetime', 'date') 
                then @t + '''''+isnull('''''''' + convert(varchar,' + c.column_name + ',121)+'''''''',''null'') '
            when c.data_type in ('tinyint', 'int', 'float', 'numeric', 'decimal', 'smallmoney', 'money', 'bit', 'smallint', 'real', 'bigint') 
                then @t + '''''+isnull(convert(varchar,' + c.column_name + '),''null'')' 
            else ''' ** data type [' + c.data_type + '] not supported **'''
        end,
        @Cols = @Cols + ','+quotename(c.column_name, '['),
        @sCols = @sCols + ',s.'+quotename(c.column_name, '[')
from    information_schema.columns c
where   c.table_name = parsename(@TableName, 1) and
        c.table_schema = parsename(@TableName, 2)
order 
by      c.ordinal_position

-- stage primary key columns
declare @pks table (c varchar(100), o int);
insert into @pks (c,o)
    select  kcu.column_name, kcu.ordinal_position
    from    information_schema.table_constraints tc
    join    information_schema.key_column_usage kcu on
            tc.table_name = kcu.table_name and
            tc.constraint_name = kcu.constraint_name
    where   tc.table_name = parsename(@TableName, 1) and
            tc.table_schema = parsename(@TableName, 2) and
            tc.constraint_type = 'PRIMARY KEY';

-- build primary key columns (1=1 to ease support of composite PKs)
set @pCols = '1=1'           
select  @pCols = @pCols + ' and '+isnull('t.'+quotename(c, '[') + ' = ' + 's.'+quotename(c, '['), '')
from    @pks    
order
by      o;

-- build update columns, do not update identities or pks
select  @aCols = @aCols + ','+quotename(c.[name], '[') + ' = s.' + quotename(c.[name], '[')
from    sys.columns c
where   object_id = object_id(@TableName) and
        [name] not in (select c from @pks) and
        columnproperty(object_id(@TableName), c.[name], 'IsIdentity ') = 0;

-- script the data out as table value constructors
select  @exec = 'set nocount on; Select ' + @b + '''(' + ''' + ' + @b + stuff(@exec,1, 3, '') + '+'')''' + @b + 'from ' + @TableName,
        @Cols = stuff(@Cols,1, 1, ''),
        @sCols = stuff(@sCols,1, 1, ''),
        @aCols = stuff(@aCols,1, 1, '');

declare @tab table (val varchar(max));
declare @Values varchar(max);
insert into @tab
    exec(@exec);

if not exists(select 1 from @tab)
begin
    raiserror('Table %s is valid but empty. Populate it before running this helper.', 16, 1, @TableName);
    return
end

select @Values = stuff(cast((select ','+ @b + val from @tab for xml path('')) as xml).value('.', 'varchar(max)'),1,2,'');

-- build the merge statement
set @output +=  @b+'--'+@TableName+replicate('-', 98-len(@TableName))+@b+replicate('-', 100)+@b;
set @output +=  'set nocount on;'+@b
if objectproperty(object_id(@TableName), 'TableHasIdentity') = 1 
    set @output += 'set identity_insert ['+parsename(@TableName, 2)+'].[' + parsename(@TableName, 1) + '] on;'+@b;
set @output +=  ';with cte_data('+@Cols+')'+@b+'as (select * from (values'+@b+'--'+replicate('/', 98) + @b +@Values+ @b +'--'+replicate('\', 98)+ @b +')c('+@Cols+'))'+@b;
set @output +=  'merge' + @t + '['+parsename(@TableName, 2)+'].[' + parsename(@TableName, 1) + '] as t' + @b + 'using' + @t + 'cte_data as s'+@b;
set @output +=  'on' + replicate(@t, 2) + @pCols+@b;
set @output +=  'when matched then' + @b+@t + 'update set'+ @b+@t + @aCols+@b;
set @output +=  'when not matched by target then'+@b;
set @output +=  @t+'insert(' + @Cols + ')'+@b;
set @output +=  @t+'values(' + @sCols + ')'+@b;
set @output +=  'when not matched by source then' + @b+@t+ 'delete;'+@b;
if objectproperty(object_id(@TableName), 'TableHasIdentity') = 1 
    set @output += 'set identity_insert ['+parsename(@TableName, 2)+'].[' + parsename(@TableName, 1) + '] off;'

--output the statement as xml (to overcome mgmt studio limitations)
select s as [output] from (select @output)d(s) for xml path('');
return; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-05-10T07:48:16.577

此帮助程序脚本将表名作为参数并生成包含数据的 MERGE 语句。它将存储过程`[master]`作为系统对象安装在其中，允许从所有数据库（例如`EXEC Northwind.dbo.sp_generate_merge 'Region'`）调用 proc

这种方法（最初是我在[SQL Server Central](http://www.sqlservercentral.com/scripts/Generate/88892/)上发布的）适用于长度超过 8,000 个字符的结果集，我们倾向于达到 100 行标记。

它还支持包含/排除特定列以及在源数据发生更改时有条件地更新匹配的行。

**更新于2012-09-27**更改了 proc 以使用 Nathan 改进的 Xml 输出方法来生成 MERGE 语句，从而解决了行和结果集级别的字符限制问题。

**2013**年 4 月 22 日更新，修复了 Dave 报告的 xml 字符问题

**更新于2013-04-22**这个脚本现在在 GitHub 上：[https ://github.com/readyroll/generate-sql-merge](https://github.com/readyroll/generate-sql-merge)

```
SET NOCOUNT ON
GO

PRINT 'Using Master database'
USE master
GO

PRINT 'Checking for the existence of this procedure'
IF (SELECT OBJECT_ID('sp_generate_merge','P')) IS NOT NULL --means, the procedure already exists
 BEGIN
 PRINT 'Procedure already exists. So, dropping it'
 DROP PROC sp_generate_merge
 END
GO

--Turn system object marking on

CREATE PROC sp_generate_merge
(
 @table_name varchar(776), -- The table/view for which the MERGE statement will be generated using the existing data
 @target_table varchar(776) = NULL, -- Use this parameter to specify a different table name into which the data will be inserted/updated/deleted
 @from varchar(800) = NULL, -- Use this parameter to filter the rows based on a filter condition (using WHERE)
 @include_timestamp bit = 0, -- Specify 1 for this parameter, if you want to include the TIMESTAMP/ROWVERSION column's data in the MERGE statement
 @debug_mode bit = 0, -- If @debug_mode is set to 1, the SQL statements constructed by this procedure will be printed for later examination
 @schema varchar(64) = NULL, -- Use this parameter if you are not the owner of the table
 @ommit_images bit = 0, -- Use this parameter to generate MERGE statement by omitting the 'image' columns
 @ommit_identity bit = 0, -- Use this parameter to ommit the identity columns
 @top int = NULL, -- Use this parameter to generate a MERGE statement only for the TOP n rows
 @cols_to_include varchar(8000) = NULL, -- List of columns to be included in the MERGE statement
 @cols_to_exclude varchar(8000) = NULL, -- List of columns to be excluded from the MERGE statement
 @update_only_if_changed bit = 1, -- When 1, only performs an UPDATE operation if an included column in a matched row has changed.
 @disable_constraints bit = 0, -- When 1, disables foreign key constraints and enables them after the MERGE statement
 @ommit_computed_cols bit = 0, -- When 1, computed columns will not be included in the MERGE statement
 @include_use_db bit = 1, -- When 1, includes a USE [DatabaseName] statement at the beginning of the generated batch
 @results_to_text bit = 0 -- When 1, outputs results to grid/messages window. When 0, outputs MERGE statement in an XML fragment.
)
AS
BEGIN

/***********************************************************************************************************
Procedure: sp_generate_merge (Version 0.93)
 (Adapted by Daniel Nolan for SQL Server 2008/2012)

Adapted from: sp_generate_inserts (Build 22) 
 (Copyright © 2002 Narayana Vyas Kondreddi. All rights reserved.)

Purpose: To generate a MERGE statement from existing data, which will INSERT/UPDATE/DELETE data based
 on matching primary key values in the source/target table.

 The generated statements can be executed to replicate the data in some other location.

Written by: Narayana Vyas Kondreddi
 http://vyaskn.tripod.com

 Daniel Nolan
 http://danere.com
 @dan3r3

Example 1: To generate a MERGE statement for table 'titles':

 EXEC sp_generate_merge 'titles'

Example 2: To generate a MERGE statement for 'titlesCopy' table from 'titles' table:

 EXEC sp_generate_merge 'titles', 'titlesCopy'

Example 3: To generate a MERGE statement for table 'titles' that will unconditionally UPDATE matching rows 
 (ie. not perform a "has data changed?" check prior to going ahead with an UPDATE):

 EXEC sp_generate_merge 'titles', @update_only_if_changed = 0

Example 4: To generate a MERGE statement for 'titles' table for only those titles 
 which contain the word 'Computer' in them:
 NOTE: Do not complicate the FROM or WHERE clause here. It's assumed that you are good with T-SQL if you are using this parameter

 EXEC sp_generate_merge 'titles', @from = "from titles where title like '%Computer%'"

Example 5: To specify that you want to include TIMESTAMP column's data as well in the MERGE statement:
 (By default TIMESTAMP column's data is not scripted)

 EXEC sp_generate_merge 'titles', @include_timestamp = 1

Example 6: To print the debug information:

 EXEC sp_generate_merge 'titles', @debug_mode = 1

Example 7: If the table is in a different schema to the default, use @schema parameter to specify the schema name
 To use this option, you must have SELECT permissions on that table

 EXEC sp_generate_merge 'Nickstable', @schema = 'Nick'

Example 8: To generate a MERGE statement for the rest of the columns excluding images

 EXEC sp_generate_merge 'imgtable', @ommit_images = 1

Example 9: To generate a MERGE statement excluding (omitting) IDENTITY columns:
 (By default IDENTITY columns are included in the MERGE statement)

 EXEC sp_generate_merge 'mytable', @ommit_identity = 1

Example 10: To generate a MERGE statement for the TOP 10 rows in the table:

 EXEC sp_generate_merge 'mytable', @top = 10

Example 11: To generate a MERGE statement with only those columns you want:

 EXEC sp_generate_merge 'titles', @cols_to_include = "'title','title_id','au_id'"

Example 12: To generate a MERGE statement by omitting certain columns:

 EXEC sp_generate_merge 'titles', @cols_to_exclude = "'title','title_id','au_id'"

Example 13: To avoid checking the foreign key constraints while loading data with a MERGE statement:

 EXEC sp_generate_merge 'titles', @disable_constraints = 1

Example 14: To exclude computed columns from the MERGE statement:

 EXEC sp_generate_merge 'MyTable', @ommit_computed_cols = 1

***********************************************************************************************************/

SET NOCOUNT ON

--Making sure user only uses either @cols_to_include or @cols_to_exclude
IF ((@cols_to_include IS NOT NULL) AND (@cols_to_exclude IS NOT NULL))
 BEGIN
 RAISERROR('Use either @cols_to_include or @cols_to_exclude. Do not use both the parameters at once',16,1)
 RETURN -1 --Failure. Reason: Both @cols_to_include and @cols_to_exclude parameters are specified
 END

--Making sure the @cols_to_include and @cols_to_exclude parameters are receiving values in proper format
IF ((@cols_to_include IS NOT NULL) AND (PATINDEX('''%''',@cols_to_include) = 0))
 BEGIN
 RAISERROR('Invalid use of @cols_to_include property',16,1)
 PRINT 'Specify column names surrounded by single quotes and separated by commas'
 PRINT 'Eg: EXEC sp_generate_merge titles, @cols_to_include = "''title_id'',''title''"'
 RETURN -1 --Failure. Reason: Invalid use of @cols_to_include property
 END

IF ((@cols_to_exclude IS NOT NULL) AND (PATINDEX('''%''',@cols_to_exclude) = 0))
 BEGIN
 RAISERROR('Invalid use of @cols_to_exclude property',16,1)
 PRINT 'Specify column names surrounded by single quotes and separated by commas'
 PRINT 'Eg: EXEC sp_generate_merge titles, @cols_to_exclude = "''title_id'',''title''"'
 RETURN -1 --Failure. Reason: Invalid use of @cols_to_exclude property
 END

--Checking to see if the database name is specified along wih the table name
--Your database context should be local to the table for which you want to generate a MERGE statement
--specifying the database name is not allowed
IF (PARSENAME(@table_name,3)) IS NOT NULL
 BEGIN
 RAISERROR('Do not specify the database name. Be in the required database and just specify the table name.',16,1)
 RETURN -1 --Failure. Reason: Database name is specified along with the table name, which is not allowed
 END

--Checking for the existence of 'user table' or 'view'
--This procedure is not written to work on system tables
--To script the data in system tables, just create a view on the system tables and script the view instead
IF @schema IS NULL
 BEGIN
 IF NOT EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = @table_name AND (TABLE_TYPE = 'BASE TABLE' OR TABLE_TYPE = 'VIEW') AND TABLE_SCHEMA = SCHEMA_NAME())
 BEGIN
 RAISERROR('User table or view not found.',16,1)
 PRINT 'You may see this error if the specified table is not in your default schema (' + SCHEMA_NAME() + '). In that case use @schema parameter to specify the schema name.'
 PRINT 'Make sure you have SELECT permission on that table or view.'
 RETURN -1 --Failure. Reason: There is no user table or view with this name
 END
 END
ELSE
 BEGIN
 IF NOT EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = @table_name AND (TABLE_TYPE = 'BASE TABLE' OR TABLE_TYPE = 'VIEW') AND TABLE_SCHEMA = @schema)
 BEGIN
 RAISERROR('User table or view not found.',16,1)
 PRINT 'Make sure you have SELECT permission on that table or view.'
 RETURN -1 --Failure. Reason: There is no user table or view with this name 
 END
 END

--Variable declarations
DECLARE @Column_ID int, 
 @Column_List varchar(8000), 
 @Column_List_For_Update varchar(8000), 
 @Column_List_For_Check varchar(8000), 
 @Column_Name varchar(128), 
 @Column_Name_Unquoted varchar(128), 
 @Data_Type varchar(128), 
 @Actual_Values nvarchar(max), --This is the string that will be finally executed to generate a MERGE statement
 @IDN varchar(128), --Will contain the IDENTITY column's name in the table
 @Target_Table_For_Output varchar(776),
 @Source_Table_Qualified varchar(776)

--Variable Initialization
SET @IDN = ''
SET @Column_ID = 0
SET @Column_Name = ''
SET @Column_Name_Unquoted = ''
SET @Column_List = ''
SET @Column_List_For_Update = ''
SET @Column_List_For_Check = ''
SET @Actual_Values = ''

--Variable Defaults
IF @schema IS NULL
 BEGIN
 SET @Target_Table_For_Output = QUOTENAME(COALESCE(@target_table, @table_name))
 END
ELSE
 BEGIN
 SET @Target_Table_For_Output = QUOTENAME(@schema) + '.' + QUOTENAME(COALESCE(@target_table, @table_name))
 END

SET @Source_Table_Qualified = QUOTENAME(COALESCE(@schema,SCHEMA_NAME())) + '.' + QUOTENAME(@table_name)

--To get the first column's ID
SELECT @Column_ID = MIN(ORDINAL_POSITION) 
FROM INFORMATION_SCHEMA.COLUMNS (NOLOCK) 
WHERE TABLE_NAME = @table_name
AND TABLE_SCHEMA = COALESCE(@schema, SCHEMA_NAME())

--Loop through all the columns of the table, to get the column names and their data types
WHILE @Column_ID IS NOT NULL
 BEGIN
 SELECT @Column_Name = QUOTENAME(COLUMN_NAME), 
 @Column_Name_Unquoted = COLUMN_NAME,
 @Data_Type = DATA_TYPE 
 FROM INFORMATION_SCHEMA.COLUMNS (NOLOCK) 
 WHERE ORDINAL_POSITION = @Column_ID
 AND TABLE_NAME = @table_name
 AND TABLE_SCHEMA = COALESCE(@schema, SCHEMA_NAME())

 IF @cols_to_include IS NOT NULL --Selecting only user specified columns
 BEGIN
 IF CHARINDEX( '''' + SUBSTRING(@Column_Name,2,LEN(@Column_Name)-2) + '''',@cols_to_include) = 0 
 BEGIN
 GOTO SKIP_LOOP
 END
 END

 IF @cols_to_exclude IS NOT NULL --Selecting only user specified columns
 BEGIN
 IF CHARINDEX( '''' + SUBSTRING(@Column_Name,2,LEN(@Column_Name)-2) + '''',@cols_to_exclude) <> 0 
 BEGIN
 GOTO SKIP_LOOP
 END
 END

 --Making sure to output SET IDENTITY_INSERT ON/OFF in case the table has an IDENTITY column
 IF (SELECT COLUMNPROPERTY( OBJECT_ID(@Source_Table_Qualified),SUBSTRING(@Column_Name,2,LEN(@Column_Name) - 2),'IsIdentity')) = 1 
 BEGIN
 IF @ommit_identity = 0 --Determing whether to include or exclude the IDENTITY column
 SET @IDN = @Column_Name
 ELSE
 GOTO SKIP_LOOP 
 END

 --Making sure whether to output computed columns or not
 IF @ommit_computed_cols = 1
 BEGIN
 IF (SELECT COLUMNPROPERTY( OBJECT_ID(@Source_Table_Qualified),SUBSTRING(@Column_Name,2,LEN(@Column_Name) - 2),'IsComputed')) = 1 
 BEGIN
 GOTO SKIP_LOOP 
 END
 END

 --Tables with columns of IMAGE data type are not supported for obvious reasons
 IF(@Data_Type in ('image'))
 BEGIN
 IF (@ommit_images = 0)
 BEGIN
 RAISERROR('Tables with image columns are not supported.',16,1)
 PRINT 'Use @ommit_images = 1 parameter to generate a MERGE for the rest of the columns.'
 RETURN -1 --Failure. Reason: There is a column with image data type
 END
 ELSE
 BEGIN
 GOTO SKIP_LOOP
 END
 END

 --Determining the data type of the column and depending on the data type, the VALUES part of
 --the MERGE statement is generated. Care is taken to handle columns with NULL values. Also
 --making sure, not to lose any data from flot, real, money, smallmomey, datetime columns
 SET @Actual_Values = @Actual_Values +
 CASE 
 WHEN @Data_Type IN ('char','nchar') 
 THEN 
 'COALESCE('''''''' + REPLACE(RTRIM(' + @Column_Name + '),'''''''','''''''''''')+'''''''',''NULL'')'
 WHEN @Data_Type IN ('varchar','nvarchar') 
 THEN 
 'COALESCE('''''''' + REPLACE(' + @Column_Name + ','''''''','''''''''''')+'''''''',''NULL'')'
 WHEN @Data_Type IN ('datetime','smalldatetime','datetime2') 
 THEN 
 'COALESCE('''''''' + RTRIM(CONVERT(char,' + @Column_Name + ',127))+'''''''',''NULL'')'
 WHEN @Data_Type IN ('uniqueidentifier') 
 THEN 
 'COALESCE('''''''' + REPLACE(CONVERT(char(255),RTRIM(' + @Column_Name + ')),'''''''','''''''''''')+'''''''',''NULL'')'
 WHEN @Data_Type IN ('text') 
 THEN 
 'COALESCE('''''''' + REPLACE(CONVERT(varchar(max),' + @Column_Name + '),'''''''','''''''''''')+'''''''',''NULL'')' 
 WHEN @Data_Type IN ('ntext') 
 THEN 
 'COALESCE('''''''' + REPLACE(CONVERT(nvarchar(max),' + @Column_Name + '),'''''''','''''''''''')+'''''''',''NULL'')' 
 WHEN @Data_Type IN ('binary','varbinary') 
 THEN 
 'COALESCE(RTRIM(CONVERT(char,' + 'CONVERT(int,' + @Column_Name + '))),''NULL'')' 
 WHEN @Data_Type IN ('timestamp','rowversion') 
 THEN 
 CASE 
 WHEN @include_timestamp = 0 
 THEN 
 '''DEFAULT''' 
 ELSE 
 'COALESCE(RTRIM(CONVERT(char,' + 'CONVERT(int,' + @Column_Name + '))),''NULL'')' 
 END
 WHEN @Data_Type IN ('float','real','money','smallmoney')
 THEN
 'COALESCE(LTRIM(RTRIM(' + 'CONVERT(char, ' + @Column_Name + ',2)' + ')),''NULL'')' 
 ELSE 
 'COALESCE(LTRIM(RTRIM(' + 'CONVERT(char, ' + @Column_Name + ')' + ')),''NULL'')' 
 END + '+' + ''',''' + ' + '

 --Generating the column list for the MERGE statement
 SET @Column_List = @Column_List + @Column_Name + ',' 

 --Don't update Primary Key or Identity columns
 IF NOT EXISTS(
 SELECT 1
 FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
 INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
 WHERE pk.TABLE_NAME = @table_name
 AND pk.TABLE_SCHEMA = COALESCE(@schema, SCHEMA_NAME())
 AND CONSTRAINT_TYPE = 'PRIMARY KEY'
 AND c.TABLE_NAME = pk.TABLE_NAME
 AND c.TABLE_SCHEMA = pk.TABLE_SCHEMA
 AND c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
 AND c.COLUMN_NAME = @Column_Name_Unquoted 
 )
 BEGIN
 SET @Column_List_For_Update = @Column_List_For_Update + @Column_Name + ' = Source.' + @Column_Name + ', 
' 
 SET @Column_List_For_Check = @Column_List_For_Check +
 CASE @Data_Type 
 WHEN 'text' THEN CHAR(10) + CHAR(9) + 'NULLIF(CAST(Source.' + @Column_Name + ' AS VARCHAR(MAX)), CAST(Target.' + @Column_Name + ' AS VARCHAR(MAX))) IS NOT NULL OR NULLIF(CAST(Target.' + @Column_Name + ' AS VARCHAR(MAX)), CAST(Source.' + @Column_Name + ' AS VARCHAR(MAX))) IS NOT NULL OR '
 WHEN 'ntext' THEN CHAR(10) + CHAR(9) + 'NULLIF(CAST(Source.' + @Column_Name + ' AS NVARCHAR(MAX)), CAST(Target.' + @Column_Name + ' AS NVARCHAR(MAX))) IS NOT NULL OR NULLIF(CAST(Target.' + @Column_Name + ' AS NVARCHAR(MAX)), CAST(Source.' + @Column_Name + ' AS NVARCHAR(MAX))) IS NOT NULL OR ' 
 ELSE CHAR(10) + CHAR(9) + 'NULLIF(Source.' + @Column_Name + ', Target.' + @Column_Name + ') IS NOT NULL OR NULLIF(Target.' + @Column_Name + ', Source.' + @Column_Name + ') IS NOT NULL OR '
 END 
 END

 SKIP_LOOP: --The label used in GOTO

 SELECT @Column_ID = MIN(ORDINAL_POSITION) 
 FROM INFORMATION_SCHEMA.COLUMNS (NOLOCK) 
 WHERE TABLE_NAME = @table_name
 AND TABLE_SCHEMA = COALESCE(@schema, SCHEMA_NAME())
 AND ORDINAL_POSITION > @Column_ID

 END --Loop ends here!

--To get rid of the extra characters that got concatenated during the last run through the loop
IF LEN(@Column_List_For_Update) <> 0
 BEGIN
 SET @Column_List_For_Update = ' ' + LEFT(@Column_List_For_Update,len(@Column_List_For_Update) - 4)
 END

IF LEN(@Column_List_For_Check) <> 0
 BEGIN
 SET @Column_List_For_Check = LEFT(@Column_List_For_Check,len(@Column_List_For_Check) - 3)
 END

SET @Actual_Values = LEFT(@Actual_Values,len(@Actual_Values) - 6)

SET @Column_List = LEFT(@Column_List,len(@Column_List) - 1)
IF LEN(LTRIM(@Column_List)) = 0
 BEGIN
 RAISERROR('No columns to select. There should at least be one column to generate the output',16,1)
 RETURN -1 --Failure. Reason: Looks like all the columns are ommitted using the @cols_to_exclude parameter
 END

--Get the join columns ----------------------------------------------------------
DECLARE @PK_column_list VARCHAR(8000)
DECLARE @PK_column_joins VARCHAR(8000)
SET @PK_column_list = ''
SET @PK_column_joins = ''

SELECT @PK_column_list = @PK_column_list + c.COLUMN_NAME + ', '
, @PK_column_joins = @PK_column_joins + 'Target.[' + c.COLUMN_NAME + '] = Source.[' + c.COLUMN_NAME + '] AND '
FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
WHERE pk.TABLE_NAME = @table_name
AND pk.TABLE_SCHEMA = COALESCE(@schema, SCHEMA_NAME())
AND CONSTRAINT_TYPE = 'PRIMARY KEY'
AND c.TABLE_NAME = pk.TABLE_NAME
AND c.TABLE_SCHEMA = pk.TABLE_SCHEMA
AND c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME

IF IsNull(@PK_column_list, '') = '' 
 BEGIN
 RAISERROR('Table has no primary keys. There should at least be one column in order to have a valid join.',16,1)
 RETURN -1 --Failure. Reason: looks like table doesn't have any primary keys
 END

SET @PK_column_list = LEFT(@PK_column_list, LEN(@PK_column_list) -1)
SET @PK_column_joins = LEFT(@PK_column_joins, LEN(@PK_column_joins) -4)

--Forming the final string that will be executed, to output the a MERGE statement
SET @Actual_Values = 
 'SELECT ' + 
 CASE WHEN @top IS NULL OR @top < 0 THEN '' ELSE ' TOP ' + LTRIM(STR(@top)) + ' ' END + 
 '''' + 
 ' '' + CASE WHEN ROW_NUMBER() OVER (ORDER BY ' + @PK_column_list + ') = 1 THEN '' '' ELSE '','' END + ''(''+ ' + @Actual_Values + '+'')''' + ' ' + 
 COALESCE(@from,' FROM ' + @Source_Table_Qualified + ' (NOLOCK)')

 DECLARE @output VARCHAR(MAX) = ''
 DECLARE @b CHAR(1) = CHAR(13)

--Determining whether to ouput any debug information
IF @debug_mode =1
 BEGIN
 SET @output += @b + '/*****START OF DEBUG INFORMATION*****'
 SET @output += @b + ''
 SET @output += @b + 'The primary key column list:'
 SET @output += @b + @PK_column_list
 SET @output += @b + ''
 SET @output += @b + 'The INSERT column list:'
 SET @output += @b + @Column_List
 SET @output += @b + ''
 SET @output += @b + 'The UPDATE column list:'
 SET @output += @b + @Column_List_For_Update
 SET @output += @b + ''
 SET @output += @b + 'The SELECT statement executed to generate the MERGE:'
 SET @output += @b + @Actual_Values
 SET @output += @b + ''
 SET @output += @b + '*****END OF DEBUG INFORMATION*****/'
 SET @output += @b + ''
 END

IF (@include_use_db = 1)
BEGIN
    DECLARE @db varchar(120);
    SET @db = 'USE ' + DB_NAME();
    SET @output += @b + @db;
    SET @output += @b + 'GO';
    SET @output += @b + '';
END

SET @output += @b + '--MERGE generated by ''sp_generate_merge'' stored procedure, Version 0.93'
SET @output += @b + '--Originally by Vyas (http://vyaskn.tripod.com): sp_generate_inserts (build 22)'
SET @output += @b + '--Adapted for SQL Server 2008/2012 by Daniel Nolan (http://danere.com)'
SET @output += @b + ''
SET @output += @b + 'SET NOCOUNT ON'
SET @output += @b + ''

--Determining whether to print IDENTITY_INSERT or not
IF (LEN(@IDN) <> 0)
 BEGIN
 SET @output += @b + 'SET IDENTITY_INSERT ' + @Target_Table_For_Output + ' ON'
 SET @output += @b + ''
 END

--Temporarily disable constraints on the target table
IF @disable_constraints = 1 AND (OBJECT_ID(@Source_Table_Qualified, 'U') IS NOT NULL)
 BEGIN
 SET @output += @b + 'ALTER TABLE ' + @Target_Table_For_Output + ' NOCHECK CONSTRAINT ALL' --Code to disable constraints temporarily
 END

--Output the start of the MERGE statement, qualifying with the schema name only if the caller explicitly specified it
SET @output += @b + 'MERGE INTO ' + @Target_Table_For_Output + ' AS Target'
SET @output += @b + 'USING (VALUES'

--All the hard work pays off here!!! You'll get your MERGE statement, when the next line executes!
DECLARE @tab TABLE (val NVARCHAR(max));
INSERT INTO @tab
EXEC (@Actual_Values)

SET @output += CAST((SELECT @b + val FROM @tab FOR XML PATH('')) AS XML).value('.', 'VARCHAR(MAX)');

--Output the columns to correspond with each of the values above--------------------
SET @output += @b + ') AS Source (' + @Column_List + ')'

--Output the join columns ----------------------------------------------------------
SET @output += @b + 'ON (' + @PK_column_joins + ')'

--When matched, perform an UPDATE on any metadata columns only (ie. not on PK)------
IF LEN(@Column_List_For_Update) <> 0
BEGIN
 SET @output += @b + 'WHEN MATCHED ' + CASE WHEN @update_only_if_changed = 1 THEN 'AND (' + @Column_List_For_Check + ') ' ELSE '' END + 'THEN'
 SET @output += @b + ' UPDATE SET'
 SET @output += @b + @Column_List_For_Update
END

--When NOT matched by target, perform an INSERT------------------------------------
SET @output += @b + 'WHEN NOT MATCHED BY TARGET THEN';
SET @output += @b + ' INSERT(' + @Column_List + ')'
SET @output += @b + ' VALUES(' + REPLACE(@Column_List, '[', 'Source.[') + ')'

--When NOT matched by source, DELETE the row
SET @output += @b + 'WHEN NOT MATCHED BY SOURCE THEN '
SET @output += @b + ' DELETE;'
SET @output += @b + ''
SET @output += @b + 'GO'

--Display the number of affected rows to the user, or report if an error occurred---
SET @output += @b + 'DECLARE @mergeError int'
SET @output += @b + ' , @mergeCount int'
SET @output += @b + 'SELECT @mergeError = @@ERROR, @mergeCount = @@ROWCOUNT'
SET @output += @b + 'IF @mergeError != 0'
SET @output += @b + ' BEGIN'
SET @output += @b + ' PRINT ''ERROR OCCURRED IN MERGE FOR ' + @Target_Table_For_Output + '. Rows affected: '' + CAST(@mergeCount AS VARCHAR(100)); -- SQL should always return zero rows affected';
SET @output += @b + ' END'
SET @output += @b + 'ELSE'
SET @output += @b + ' BEGIN'
SET @output += @b + ' PRINT ''' + @Target_Table_For_Output + ' rows affected by MERGE: '' + CAST(@mergeCount AS VARCHAR(100));';
SET @output += @b + ' END'
SET @output += @b + 'GO'
SET @output += @b + ''

--Re-enable the previously disabled constraints-------------------------------------
IF @disable_constraints = 1 AND (OBJECT_ID(@Source_Table_Qualified, 'U') IS NOT NULL)
 BEGIN
 SET @output += @b + 'ALTER TABLE ' + @Target_Table_For_Output + ' CHECK CONSTRAINT ALL' --Code to enable the previously disabled constraints
 SET @output += @b + 'GO'
 END

--Switch-off identity inserting------------------------------------------------------
IF (LEN(@IDN) <> 0)
 BEGIN
 SET @output += @b + 'SET IDENTITY_INSERT ' + @Target_Table_For_Output + ' OFF'
 SET @output += @b + 'GO'
 END

SET @output += @b + 'SET NOCOUNT OFF'
SET @output += @b + 'GO'
SET @output += @b + ''
SET @output += @b + ''

IF @results_to_text = 1
BEGIN
    --output the statement to the Grid/Messages tab
    SELECT @output;
END
ELSE
BEGIN
    --output the statement as xml (to overcome SSMS 4000/8000 char limitation)
SELECT [processing-instruction(x)]=@output FOR XML PATH(''),TYPE;
    PRINT 'MERGE statement has been wrapped in an XML fragment and output successfully.'
    PRINT 'Ensure you have Results to Grid enabled and then click the hyperlink to copy the statement within the fragment.'
    PRINT ''
    PRINT 'If you would prefer to have results output directly (without XML) specify @results_to_text = 1, however please'
    PRINT 'note that the results may be truncated by your SQL client to 4000 nchars.'
END

SET NOCOUNT OFF
RETURN 0 --Success. We are done!
END

GO

PRINT 'Created the procedure'
GO

--Mark the proc as a system object to allow it to be called transparently from other databases
EXEC sp_MS_marksystemobject sp_generate_merge
GO

PRINT 'Granting EXECUTE permission on sp_generate_merge to all users'
GRANT EXEC ON sp_generate_merge TO public

SET NOCOUNT OFF
GO

PRINT 'Done' 
```

# 用法

1.  确保您的 SQL 客户端配置为将结果发送到网格。
2.  执行 proc，提供源表名作为参数
3.  单击结果集中的超链接。
4.  复制 SQL（不包括输出标签）并粘贴到新的查询窗口中执行。

## 例子

要生成包含 Person.AddressType 表中所有数据的 MERGE 语句，不包括 ModifiedDate 和 rowguid 列：

```
EXEC AdventureWorks.dbo.sp_generate_merge @schema = 'Person', @table_name ='AddressType', @cols_to_exclude = '''ModifiedDate'',''rowguid''' 
```

生成的 SQL：

```
SET NOCOUNT ON
GO 
SET IDENTITY_INSERT [Person].[AddressType] ON
GO

MERGE INTO [Person].[AddressType] AS Target
USING (VALUES
---------------------------------------------------------------------------------------------------------------
  (1,'Billing')
 ,(2,'Home')
 ,(3,'Main Office')
 ,(4,'Primary')
 ,(5,'Shipping')
 ,(6,'Contact')

) AS Source ([AddressTypeID],[Name])
ON (Target.[AddressTypeID] = Source.[AddressTypeID])
WHEN MATCHED AND (
    NULLIF(Source.[Name], Target.[Name]) IS NOT NULL OR NULLIF(Target.[Name], Source.[Name]) IS NOT NULL) THEN
 UPDATE SET
 [Name] = Source.[Name]
WHEN NOT MATCHED BY TARGET THEN
 INSERT([AddressTypeID],[Name])
 VALUES(Source.[AddressTypeID],Source.[Name])
WHEN NOT MATCHED BY SOURCE THEN 
 DELETE;

SET IDENTITY_INSERT [Person].[AddressType] OFF
GO
SET NOCOUNT OFF
GO 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T21:18:36.647

如果我对您的理解正确，您在一个环境中有一个表（我们称之为 DEV），并且您想在另一个环境中更新（我们称之为 PROD）。出于显而易见的原因，您不允许通过数据库链接连接这两者。

最好的选择可能是

1.  BCP 将 DEV 表的内容保存到文件中
2.  BCP 文件到 PROD 中的临时表中
3.  编写一个合并语句，从临时表中插入/更新/删除您的值。
4.  清除/删除临时表

这样做的好处是，如果您定期执行此操作，则很容易重复使用不同的源文件。

当然，如果您可以访问并被允许使用这些工具，SSIS 或 Redgate 数据比较将使这变得更容易。

# field - 是否可以使用简单的标识符命名（或标记）FormStack 字段？

> ID：10489185
> 
> 赞同：2
> 
> 时间：2012-05-07T21:10:01.493
> 
> 标签：field, naming, tagging, webhooks, formstack

*此问题假定您熟悉**FormStack**，这是一个拖放式所见即所得的在线表单构建器。*

**背景**

客户正在使用 FormStack 来管理表单。目前，表单提交是通过电子邮件发送的，然后手动输入数据库。可以预见，我的任务是自动化这个过程。这很容易使用 FormStack 的 WebHooks API：我可以将表单提交发送到一个 URL，例如 PHP 脚本，然后愉快地解析。

**问题**

> 是否可以使用简单的标识符命名（或标记）FormStack 字段？

客户端需要能够自定义表单，以便多个字段可以输入到同一个数据库列中。* FormStack 然而，据我所知，它只提供了一种指定字段标签的方法，例如`Which of these trips interest you?`，对程序员不友好标识符，例如`Trip`。我的脚本必须对标签进行字符串比较（由于它们的长度，更容易出现拼写错误）以确定要做什么。这个问题有哪些明智的解决方法？

**澄清***

可以存在多个字段输入同一数据库列的原因是客户端使用条件字段。例如，一个字段可能会询问，`Where are you studying abroad?` 如果用户选择*“欧洲”*，则可能会出现一个条件字段，询问`Which of these trips interest you?`有关欧洲的选项。然而，如果用户选择*“Africa”*，则可能会出现类似的字段，例如`Which of these trips interest you?`，但带有与非洲有关的选项。在 FormStack 中，这些实际上是两个不同的字段。但是，您可以想象，这些值属于同一数据库列，`Trip`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T15:17:07.193

我现在已经解决了一个黑客问题。FormStack 允许在标签中添加 HTML 标记，例如`Which of these trips interest you? <!--Trip-->`. 客户愿意以这种方式“标记”字段。

这是解析此类标签的代码片段，以防它可能对其他人有所帮助：

```
 require_once 'Formstack.php';
    $formstack = new Formstack($apiKey);
    $form = $formstack->form($_POST['FormID']);
    $taggedFields = array();
    foreach ($form['fields'] as $field)
    {
        if (preg_match('/<!--\s*([0-9A-Za-z]+)\s*-->/',
                       $field['label'],
                       $matches))
        {
            $taggedFields[$matches[1]] = $_POST[$field['id']];
        }
    } 
```

事实上，我不得不让它更复杂一点。一些 FormStack 字段类型序列化输入（以一种可怕的方式）。例如，FormStack 的*Name* field-type 采用多个字段（前缀、first、middle、last、initial、suffix），并将结果连接成一个字符串：

```
'first = Andrew
initial = W
last = Cheong' 
```

为了处理这个问题，我编写了代码来处理标签中的语法，例如`Tell us your name! <!--FirstName=first--> <!--LastName=last--> <!--MiddleInitial=initial-->`

代码如下。

```
 require_once 'Formstack.php';
    $formstack = new Formstack($apiKey);
    $form = $formstack->form($_POST['FormID']);
    $taggedFields = array();
    foreach ($form['fields'] as $field)
    {
        if (preg_match_all('/<!--\s*([0-9A-Za-z]+)\s*(?:=\s*(\w+))?-->/',
                           $field['label'],
                           $matches,
                           PREG_SET_ORDER))
        {
            foreach ($matches as $captures)
            {
                if (count($captures) == 3 &&
                    preg_match('/(?:^|\n|\r)'.$captures[2].' = ([^\n\r]+)/',
                               $_POST[$field['id']],
                               $subcaptures))
                {
                    $taggedFields[$captures[1]] = $subcaptures[1];
                }
                else
                {
                    $taggedFields[$captures[1]] = $_POST[$field['id']];
                }
            }
        }
    } 
```

希望 FormStack 将很快添加一种本地方式来命名或标记字段！

# ant - 在 Ant 运行时创建具有动态内容的 Union 和 Macrodef 样式元素

> ID：10489186
> 
> 赞同：5
> 
> 时间：2012-05-07T21:10:02.147
> 
> 标签：ant, union, element, macrodef

我有一个用 Ant 构建的构建脚本，它有一个宏定义，它接受一些默认参数、目标、根等，然后是可选的两个，extrasrc-f 和 extrasrc-c。在他们进来之后，我喜欢对所有相关资源进行最新检查，然后只在目标过时时进行构建。

我现在所拥有的，

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="Custom build" default="default">

    <taskdef resource="net/sf/antcontrib/antlib.xml"
        classpath="C:/dev/ant/ant-contrib/ant-contrib-1.0b3.jar"/>

    <macrodef name="checkuptodate">
        <attribute name="target" />
        <element name="resource" />
        <sequential>
            <condition property="needbuild">
                <and>
                    <resourcecount when="greater" count="0"> <resource /> </resourcecount>
                    <not>
                        <uptodate targetfile="@{target}">
                            <srcresources> <resource /> </srcresources>
                        </uptodate>
                    </not>
                </and>
            </condition>
        </sequential>
    </macrodef>

    <macrodef name="projbuild">
        <attribute name="root" />
        <attribute name="target" />

        <element name="extrasrc-f" optional="true" />
        <element name="extrasrc-c" optional="true" />
        <sequential>
            <local name="needbuild" />
            <checkuptodate target="@{root}/bin/@{target}">
                <resource>
                    <union>
                        <extrasrc-f />
                        <fileset dir="@{root}/src" includes="**/*.java" />
                    </union>
                </resource>
            </checkuptodate>

            <if>
                <istrue value="${needbuild}" />
                <then>
                    <javac
                        srcdir="@{root}/src"
                        destdir="@{root}/bin"
                        includeantruntime="false"
                    >
                        <extrasrc-c />
                    </javac>
                </then>
            </if>

        </sequential>
    </macrodef>

    <target name="default">

        <projbuild root="." target="EntryPoint.class">
            <extrasrc-f>
                <fileset dir="Proj2/src" includes="**/*.java" />
                <fileset dir="Proj3/src" includes="**/*.java" />
            </extrasrc-f>
            <extrasrc-c>
                <classpath location="Proj2/src" />
                <classpath location="Proj3/src" />
            </extrasrc-c>
        </projbuild>

    </target>

</project> 
```

但是正如你所看到的，在这个时间点，对我来说效率很低，做我想做的事，我必须创建并传递至少一个文件集和多个类路径。我真正想做的只是传入一个目录列表，然后根据该信息动态创建 extrasrc-f 和 extrasrc-c 元素，但是对于我的生活，我不知道我是怎么做的我能够做到这一点。

我已经阅读了很多关于 Ant 和 Ant-Contrib 时髦类的信息，但是我还没有阅读任何可以让我做这样的事情的东西，我觉得这很奇怪，因为对我来说这看起来很明显。

我是以一种非常错误的方式处理这个问题，还是我遗漏了什么？如果我真的在滥用 Ant，我会喜欢关于如何正确执行此操作的正确方向的指针，创建一个包罗万象的模板构建在一个测试多个源的宏定义（或目标，如果这是唯一的方法）中文件针对一个构建的文件，同时还传递额外的类或库路径，最好在一个列表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:11:12.390

也许您可以使用几个[`<scriptdef>`](http://ant.apache.org/manual/Tasks/scriptdef.html)任务来帮助分解这些宏。

首先，它采用逗号分隔的目录列表并`<union>`从中生成目录。您提供`refid`要用于将联合引用为`id`属性的 。有可选的包含和排除。

```
<scriptdef name="dirs2union" language="javascript">
    <attribute name="dirs" />
    <attribute name="id" />
    <attribute name="includes" />
    <attribute name="excludes" />
    <![CDATA[
      var dirs = attributes.get( "dirs" ).split( "," );
      var includes = attributes.get( "includes" );
      var excludes = attributes.get( "excludes" );

      var union = project.createDataType( "union" );
      project.addReference( attributes.get( "id" ), union );

      for ( var i = 0; i < dirs.length; i++ ) {
          var fs = project.createDataType( "fileset" );
          fs.setDir( new java.io.File( dirs[i] ) );
          if ( includes )
              fs.setIncludes( includes );
          if ( excludes )
              fs.setExcludes( excludes );

          union.add( fs );
      }
    ]]>
</scriptdef> 
```

第二个 - 非常相似 - 脚本对路径生成等效：

```
<scriptdef name="dirs2path" language="javascript">
    <attribute name="dirs" />
    <attribute name="id" />
    <![CDATA[
      var dirs = attributes.get( "dirs" ).split( "," );

      var path = project.createDataType( "path" );
      project.addReference( attributes.get( "id" ), path );

      for ( var i = 0; i < dirs.length; i++ ) {
          var pe = project.createDataType( "path" );
          pe.setLocation( new java.io.File( dirs[i] ) );
          path.add( pe );
      }
    ]]>
</scriptdef> 
```

一个示例使用可能类似于：

```
<property name="dirs" value="Proj2/src,Proj3/src" />

<dirs2union dirs="${dirs}" id="my.union" includes="**/*.java" />
<dirs2path  dirs="${dirs}" id="my.path" />

... later (e.g.) ...

<union refid="my.union" />
<classpath refid="my.path" /> 
```

然后，您可以修改宏以获取`dirs`属性并在内部生成联合和类路径，或者可能在其他地方生成一次并传入引用。

我没有尝试`@{root}`在此插图中包含目录，但应该可以针对上述内容进行调整。

# java - 尝试创建客户端服务库时 wsimport 失败

> ID：10489191
> 
> 赞同：9
> 
> 时间：2012-05-07T21:10:14.660
> 
> 标签：java, web-services, soap, mantis

我正在尝试创建一个客户端库来从 java访问[Mantis 。](http://www.mantisbt.org)问题是我遇到了一个错误，我不知道为什么。

运行此命令：

```
wsimport http://www.mantisbt.org/demo/api/soap/mantisconnect.php?wsdl 
```

根本失败。它应该创建某种客户端库以从 java 访问服务，但我收到此错误：

```
[ERROR] "Use of SOAP Encoding is not supported. 
SOAP extension element on line 1,075 in http://www.mantisbt.org/demo/api
/soap/mantisconnect.php?wsdl has use="encoded" " 
```

我在互联网上查看了对这个错误的模糊引用，它似乎是指令的错误，但事实并非如此：我试图用下载的 xml 版本解决这个问题，但它没有工作。

我想我可能需要某种目录来成功实现这一代，可以吗？如果是这样，有没有人如何创建这个？我进行了一些搜索，但我对 Web 服务的一般知识太有限，无法实现。

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T02:34:30.060

问题的症结在于，mantis WSDL 描述的是 rpc/encoded Web 服务，而现代 wsimport 工具不支持这种风格。

在[http://www.ibm.com/developerworks/webservices/library/ws-whichwsdl/](http://www.ibm.com/developerworks/webservices/library/ws-whichwsdl/)上对不同类型的 Web 服务样式进行了很好的描述。

[使用 RPC/编码 Web 服务的最佳方式](https://stackoverflow.com/questions/7284126/best-way-to-consume-rpc-encoded-webservice)提供了相关问题和自助服务答案？. 该答案使评论“我也对使用 JAX-RPC 来完成这项工作表示怀疑，因为它已经过时了。”但这确实是您在这里处理的内容，所以使用“旧库”真的会是正确的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T06:22:46.830

使用 Axis 1.4 是一种选择吗？如果是，我们已经在 Maven 中心部署[了 MantisBT 的 Axis 1 SOAP 存根。](http://search.maven.org/#artifactdetails|biz.futureware.mantis|mantis-axis-soap-client|1.2.9|jar)

[或者，在 Github 上的jerr/mantis-ws-client](https://github.com/jerr/mantis-ws-client/blob/master/providers/soap-jaxws/)上有一个源项目，它应该如何使用 JAX-RPC 构建工件。

# c#-4.0 - 使用 C#.Net 处理将平面文件导入到 SQL Server 的最佳方法

> ID：10489198
> 
> 赞同：1
> 
> 时间：2012-05-07T21:10:50.407
> 
> 标签：c#-4.0, console-application, batch-processing, flat-file

*   我写了一个控制台应用程序来读取平面文件列表
*   并逐行解析数据类型
*   并在各自的表中一个接一个地插入记录。

> 很少有平面文件包含大约**63k 记录（行）**。对于此类文件，我的程序大约需要 6 个小时才能完成一个包含 63k 记录的文件。

这是一个测试数据文件。在生产中，我必须处理 100 倍以上的负载。

我很担心，如果我能更好地加快速度。

**任何人都可以提出处理这项工作的最佳方法吗？**

工作流程如下：

1.  使用从本地机器读取平面文件`File.ReadAllLines("location")`
2.  解析行的每个字段后创建一个记录实体对象。
3.  将此当前行插入到实体中

**将此作为控制台应用程序的目的是，** 此应用程序应每周运行（计划应用程序），并且其中有条件逻辑，基于一些变量会有

*   全表替换或
*   更新现有表或
*   删除表中的记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:37:36.743

您可以尝试使用“[批量插入](http://msdn.microsoft.com/en-us/library/ms188365.aspx)”操作将大量数据插入数据库。

# android - setVisibilty() 不会第一次工作

> ID：10489199
> 
> 赞同：0
> 
> 时间：2012-05-07T21:10:53.910
> 
> 标签：android, android-layout, view, visibility

我有一个称为控制器的布局，其中有几个按钮，问题出在我的 onTouch 功能中，我想一键显示它并隐藏它。现在这在 2 次触摸后起作用。第一次触摸应该显示控制器，而下一次应该使它消失。第一次和第二次触摸什么都不做，但在第三次触摸时它起作用。这是相关的功能

```
public boolean onTouchEvent(MotionEvent event)
{

    int eventx = event.getAction();
    switch(eventx)
    {
    case MotionEvent.ACTION_DOWN:
        if(isLifted)
        {
            if(!isVisible)
            {
                Log.i("onTouch", "called showPuse menu");
                isVisible = true;
                isPaused = true;
                showPauseMenu();
            }
            else if(isVisible)
            {
                hidePauseMenu();
                isVisible= false;
            }
            isLifted = false;

        }
        break;
    case MotionEvent.ACTION_UP:
        if(!isLifted)
        {
            isLifted = true;
            //Log.i("onTouchEvent", "Lifted");
        }
    }
    return false;
}

    /***************************************************
 * Shows All Views needed to be shown
 * Also pauses video and audio
 *
 * *************************************************/
private void showPauseMenu()
{
    Log.i("showPauseMenu", "called");
    playButton.setVisibility(View.VISIBLE);
    Log.i("showPauseMenu", "plaButton visible");
    bottomButtons.setVisibility(View.VISIBLE);
    Log.i("showPauseMenu", "bottom Menu showed");
    playButton.invalidate();
    bottomButtons.invalidate();
    pauseMedia();
}
/************************************************
 * Hides Views that are part of Pause Menu
 * Also starts video and audio back again
 */
private void hidePauseMenu() {
    playButton.setVisibility(View.GONE);
    bottomButtons.setVisibility(View.GONE);
    playMedia();
} 
```

谁能说可能是什么问题？我已经看这段代码几天了，看不出它可能是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:24:21.810

关于此代码的一些提示：

*   isLifted 变量可能一开始就为假，并且在第一次触摸事件时，它不会导致向下事件发生任何事情。当用户抬起他/她的手指时，该变量设置为 true，因此可以实际处理第二个事件。这意味着第一次触摸永远不会有任何可见的效果。
*   您正在使用 isVisible 布尔值，而不仅仅是检查组件本身的可见性。这使得它们很容易不同步。

没有全班就很难说，但我会调查这两点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T08:08:34.317

在设计 xml 时制作小部件`android:visibility="gone"`。在程序期间检查状态是否隐藏 onclick 设置`View.VISIBLE`以及是否在第二次触摸时可见`View.GONE`。

我认为这会奏效。试一次。

# c# - EzAPI OLE DB 目标

> ID：10489200
> 
> 赞同：3
> 
> 时间：2012-05-07T21:10:58.700
> 
> 标签：c#, com, ssis, ezapi

我已经搜遍了，现在我不得不问。我正在尝试使用 EzAPI 构建一个简单的数据流。这绝非易事，但我致力于解决这个问题。我不知道如何开始`EzOleDBDestination`工作。这是我的完整代码

```
var a = new Application();
// using a template since it's impossible to set up an ADO.NET connection to MySQL
//  using EzAPI and potentially even with the raw SSIS API...
var pkg = new EzPackage(a.LoadPackage(@"C:\...\Package.dtsx", null));
pkg.Name = "Star";

var df = new EzDataFlow(pkg);
df.Name = "My DataFlow";

var src = new EzAdoNetSource(df);
src.Name = "Source Database";
src.SqlCommand = "SELECT * FROM enum_institution";
src.AccessMode = AccessMode.AM_SQLCOMMAND;
src.Connection = new EzConnectionManager(pkg, pkg.Connections["SourceDB"]);
src.ReinitializeMetaData();

var derived = new EzDerivedColumn(df);
derived.AttachTo(src);
derived.Name = "Prepare Dimension Attributes";
derived.LinkAllInputsToOutputs();
derived.Expression["SourceNumber"] = "id"; 
derived.Expression["Name"] = "(DT_STR,255,1252)description";

// EDIT: reordered the operation here and I no longer get an error, but 
//  I'm not getting any mappings or any input columns when I open the package in the designer
var dest = new EzOleDbDestination(df);
dest.AttachTo(derived, 0, 0);
dest.Name = "Target Database";
dest.AccessMode = 0;
dest.Table = "[dbo].[DimInstitution]";
dest.Connection = new EzConnectionManager(pkg, pkg.Connections["TargetDB"]);

// this comes from Yahia's link
var destInput = dest.Meta.InputCollection[0];
var destVirInput = destInput.GetVirtualInput();
var destInputCols = destInput.InputColumnCollection;
var destExtCols = destInput.ExternalMetadataColumnCollection;
var sourceColumns = derived.Meta.OutputCollection[0].OutputColumnCollection;

foreach(IDTSOutputColumn100 outputCol in sourceColumns) {
    // Now getting COM Exception here...
    var extCol = destExtCols[outputCol.Name];
    if(extCol != null) {
        // Create an input column from an output col of previous component.
        destVirInput.SetUsageType(outputCol.ID, DTSUsageType.UT_READONLY);
        var inputCol = destInputCols.GetInputColumnByLineageID(outputCol.ID);
        if(inputCol != null) {
            // map the input column with an external metadata column
            dest.Comp.MapInputColumn(destInput.ID, inputCol.ID, extCol.ID);
        }
    }
} 
```

基本上，任何涉及调用的`ReinitializeMetadata()`结果都会导致 0xC0090001，因为该方法是错误发生的地方。没有真正的文档可以帮助我，所以我必须依赖这里的任何大师。

我应该提到源数据库是 MySQL，目标数据库是 SQL Server。使用 SSIS 设计器构建这样的包效果很好，所以我知道这是可能的。

如果我做错了什么，请随时告诉我。

编辑：这是我用作模板的基本包的链接：[http](http://www.filedropper.com/package_1) ://www.filedropper.com/package_1 。我已经编辑了连接细节，但是任何 MySQL 和 SQL Server 数据库都可以。该包将从 MySQL 中读取（使用 MySQL ADO.NET 连接器）并写入 SQL Server。

数据库模式大多无关紧要。为了测试，只需在 MySQL 中创建一个包含两列的表：id (int) 和 description (varchar)，其中 id 是主键。在 SQL Server 中创建等效列。这里的目标只是从一个复制到另一个。在某些时候它可能最终会变得更加复杂，但我必须首先克服这个障碍。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T18:21:49.640

我现在无法对此进行测试，但我很确定以下内容将帮助您使其正常工作：

*   [调用`ReinitializeMetadata()`会导致组件获取表元数据。这只能在设置`AccessMode`和相关属性后调用。](http://blogs.msdn.com/b/mattm/archive/2008/12/30/api-sample-oledb-source-and-oledb-destination.aspx)您在设置之前调用它`AccessMode`...

*   [各种示例，包括有关调试问题的建议](http://blogs.msdn.com/b/mattm/archive/2008/12/30/samples-for-creating-ssis-packages-programmatically.aspx)

*   直接在 SQL 命令中定义派生列，而不是使用`EzDerivedColumn`

*   首先尝试让它与 2 个 SQL Server 数据库一起工作，一些可用的 MySQL ADO.NET 提供程序在某些情况下有一些缺点

更新-根据评论，有关调试此问题的更多信息以及指向完整端到端示例的链接以及源代码：

*   [http://blogs.msdn.com/b/mattm/archive/2009/08/03/looking-up-ssis-hresult-comexception-errorcode.aspx](http://blogs.msdn.com/b/mattm/archive/2009/08/03/looking-up-ssis-hresult-comexception-errorcode.aspx)
*   [http://blogs.msdn.com/b/mattm/archive/2009/08/03/debugging-a-comexception-during-package-generation.aspx](http://blogs.msdn.com/b/mattm/archive/2009/08/03/debugging-a-comexception-during-package-generation.aspx)
*   [完整的带有源代码的工作示例](http://sqlsrvintegrationsrv.codeplex.com/releases/view/17647)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-19T06:46:43.780

I've had this exact same issue and been able to resolve it with a lot of experimentation. In short you must set the connection for both the source and destination, and then call the attachTo after both connections are set. You must call attachTo for every component.

I've written a blog about [starting with an SSIS package as a template, and then manipulating it programmatically to produce a set of new packages](http://www.dimodelo.com/blog/2015/ezapi-existing-package-template/).

The article explains the issue more.

# xslt - 过滤与下拉列表绑定的 XML 节点

> ID：10489201
> 
> 赞同：1
> 
> 时间：2012-05-07T21:11:00.133
> 
> 标签：xslt, xpath, filtering, xmldatasource

我有两个 DropDownList： 1) CollegeDDL，其中包含四个学院的静态名称。: 顺势医学院、理疗学院、阿育吠陀学院、工商管理学院

2) CourseDDL，绑定到 CourseDetail.XML。

```
 <Institutes>  
    <Institute>
    <InstituteName>  Homoeopathic Medical College  </InstituteName>
    <Course> <CourseName>  BHMS                    </CourseName> </Course>  
    <Course> <CourseName>  MD(Repertary)           </CourseName> </Course>  
    <Course> <CourseName>  MD(Organon of Medicine) </CourseName> </Course>  
    <Course> <CourseName>  MD(Materia Medica)      </CourseName> </Course>  
    </Institute>

    <Institute>
    <InstituteName>  Physiotherapy College  </InstituteName>
    <Course> <CourseName>  BPT          </CourseName> </Course> 
    <Course> <CourseName>  BPT(Sports)  </CourseName> </Course> 
    <Course> <CourseName>  BPT(Cardio)  </CourseName> </Course>
    </Institute>

    <Institute>
    <InstituteName>  Institute of Ayurved  </InstituteName>
    <Course> <CourseName>  BAMS          </CourseName> </Course>
    <Course> <CourseName>  BAMS(Nature)  </CourseName> </Course>
    <Course> <CourseName>  BAMS(Plants)  </CourseName> </Course>
    </Institute>

    <Institute>
    <InstituteName> Institute of Business Administration </InstituteName>
    <Course> <CourseName>BBA</CourseName> </Course> 
    <Course> <CourseName>DBM</CourseName> </Course> 
    <Course> <CourseName>BBA(Distance)</CourseName> </Course>   
    </Institute> 
```

* * *

CourseDetail.XSL

```
 <xsl:template match ="/">

    <Institute>
    <xsl:apply-templates select ="Institutes/Institute/Course"/>
    </Institute>

    </xsl:template>

    <xsl:template match ="Institutes/Institute/Course">
    <Institute>
    <xsl:attribute name="CourseName">
    <xsl:value-of select="CourseName"/>
    </xsl:attribute>
    </Institute>

    </xsl:template> 
```

我已将 Coursedetail.XML 绑定到 CourseDDL 和 CourseDetail.XSL（无 XPATH 表达式）

完成此操作后，My CourseDDL 将正确填充我的 XML 文件的所有 CourseName 值。但现在我想根据在 CollegeDDL 中选择的大学名称过滤绑定到 CourseDDL 的数据。

例如：目前我的 CourseDDL 包含所有 CourseName：BHMS,MD(Repertary),MD(Organon of Medicine),......,DBM,BBA(Distance)。

但是当我在 CollegeDDL 中选择“顺势医学院”时，绑定到 CourseDDL 的数据应该相应地过滤。这意味着当我选择“顺势医学院”时，我的 CourseDDL 应该只显示该课程：BHMS,MD(Repertary),MD(Organon of Medicine),MD(Materia Medica)

* * *

我尝试了以下方法，但无法实现。

```
 1) XmlDataSourceCourse.XPath = "/Institutes/Institute[InstituteName='" +         CollegeDDL.SelectedItem.Value + "']"

    2) XmlDataSourceCourse.XPath = "/Institutes/Institute[InstituteName='" +         CollegeDDL.SelectedItem.Value + "']/Course"

    3)XmlDataSourceCourse.XPath = "/Institutes/Institute[InstituteName='" + CollegeDDL.SelectedItem.Value + "']/Course/CourseName" 
```

请任何人帮助格式化正确的 XPATH 表达式以实现此目的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T12:45:58.510

我认为 Pavel 是对的，问题在于空间 - 尝试：

```
/Institutes/Institute[normalize-space(InstituteName)='" + CollegeDDL.SelectedItem.Value + "']/Course/CourseName 
```

甚至

```
/Institutes/Institute[normalize-space(InstituteName)=normalize-space('" + CollegeDDL.SelectedItem.Value + "')]/Course/CourseName 
```

# excel - 如何将用户表单作为图标/按钮添加到功能区并显示用户表单但仍然能够使用 Excel 文件？

> ID：10489204
> 
> 赞同：4
> 
> 时间：2012-05-07T21:11:22.380
> 
> 标签：excel, vba

当我使用用户表单时，我必须：

1) Alt + F11

2) 选择表格

3) 运行

4) 关闭表格

5) 返回 Excel

如果表单没有关闭，Excel 将不允许我做任何事情。有没有办法让我在功能区上放一个小图标？并在我使用 Excel 时保持用户表单出现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T21:34:45.657

你的问题有两个部分：

**向功能区添加图标**：您希望宏可用于所有电子表格吗？

*   如果是这样，请按照[本指南](http://mohammedkb.wordpress.com/2010/09/14/customize-excel-ribbon-and-make-your-macros-default-commands-2/)将您的宏保存为 Excel 加载项，然后将其附加到功能区。
*   如果您只在当前电子表格中需要它，您可以通过在电子表格中添加一个激活宏的按钮来简化事情（使用[本指南](http://office.microsoft.com/en-us/excel-help/add-a-button-and-assign-a-macro-to-it-in-a-worksheet-HP010236676.aspx)），或者您可以使用快捷键直接调用宏（使用[本指南](http://kb.iu.edu/data/ahbm.html)，`Assigning a shortcut to an existing macro`部分）

**保持对话框打开：**用户窗体的属性之一是`ShowModal`；您可以简单地将其设置为 false。或者，根据其他答案，您可以使用`MyForm.Show vbModeless`.

请注意，表单的属性还允许您提供特定的屏幕位置，以便在您工作时表单不会妨碍您：更改`StartUpPosition`为, 并为and`0 - Manual`提供值。`Top``Left`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:19:38.523

您不需要这样做 :) 您可以简单地以`modeless`模式启动表单以使其保持打开状态并同时使用 Excel 文件

试试这个来启动用户表单。

```
Sub Sample()
    Userform1.Show vbModeless
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T11:12:44.653

我认为您应该必须创建另一个模块并在该模块中调用用户表单。之后，只需将该宏放在功能区上。它可能会对您有所帮助......

# c# - Visual Studio 2010 - 在调试时看不到变量的值

> ID：10489205
> 
> 赞同：3
> 
> 时间：2012-05-07T21:11:25.820
> 
> 标签：c#, visual-studio

![在此处输入图像描述](../Images/2c7e7cc10e03990aa62d7e22417733f7.png)在我用来指向变量之前，它们用来显示它们的值。**在我安装了 Visual Studio** 2010 完整版后，我再也看不到变量了。有时我必须做类似的事情才能看到 te 变量：

```
String var1 = "test";
var1=var1; 
```

请注意，我在变量值初始化后和赋值后检查变量值。

`The name 'buyCategory' does not exist in the current context`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-07T21:28:29.887

更改为[调试编译](http://msdn.microsoft.com/en-us/library/wx0123s5.aspx)并[禁用编译器优化](https://stackoverflow.com/questions/1199204/how-can-i-disable-compiler-optimization-in-c)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-07T21:14:43.920

看起来您的断点位于初始化变量的行上。您需要在该变量存在之前执行该行（ F10 / Debug->Step Over ）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T21:13:35.547

在屏幕截图中，buyCategory 尚未初始化*或*分配。按 F10 并重试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T21:16:03.780

您可能与您尝试在 Locals 菜单中查看的变量处于不同的线程中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-13T08:14:36.667

打开解决方案资源管理器 -> 右键单击​​解决方案 -> 选择属性。

选择属性后，您将获得一个弹出窗口。在窗口中将配置类型更改为**调试**，然后单击确定。

# c++ - 继承类的成员函数不会改变继承的基类变量

> ID：10489209
> 
> 赞同：2
> 
> 时间：2012-05-07T21:12:02.817
> 
> 标签：c++, class, inheritance, public

所以我有一个带有以下头文件的基类：

```
#ifndef ODESolver_H
#define ODESolver_H
#endif
#include "DoublePendulum.h"

class ODESolver
{
public: 
    ODESolver(DoublePendulum &);
    virtual void Predict(const double &)=0;
    DoublePendulum DP;
}; 
```

执行：

```
#include "ODESolver.h"
#include <iomanip>

ODESolver::ODESolver(DoublePendulum &DPRef) :DP(DPRef)
{} 
```

还有一个继承自它的类：

```
#ifndef ODEEuler_H
#define ODEEuler_H
#endif

#include "ODESolver.h"

class ODEEuler : public ODESolver
{
public:
    ODEEuler(DoublePendulum &);
    void Predict(const double &);
}; 
```

执行：

```
#include "ODEEuler.h"

ODEEuler::ODEEuler (DoublePendulum &DPRef) :ODESolver(DPRef)
{}

void ODEEuler::Predict(const double &dt=0.005)
{
    DP=DP+DP.Derivate()*dt;
    cout << DP.getUp().getTheta() << endl;
} 
```

问题是在上面的实现中，`DP=DP+DP.Derivate()*dt;`不会做任何事情。我不知道这怎么可能。我检查了`.Derivate()`成员函数是否有效并且它实际上返回了正确的值/对象。最重要的是，我在那里做什么并不重要，例如`DP=DoublePendulum RandomObject(1,2,3,4)`仍然会保持 DP 不变。有任何想法吗？我希望我提供了足够的信息...

还有 DoublePendulum 等的实现和声明：

[http://pastebin.com/ny3pU8aR](http://pastebin.com/ny3pU8aR)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:36:11.953

这个赋值运算符

```
DoublePendulum DoublePendulum::operator= (DoublePendulum &DoublePendulumA)
{
        return DoublePendulum (DoublePendulumA);
} 
```

创建一个新值，但并未真正将任何内容分配给赋值的左侧。这就是为什么它不会改变！

分配的标准形式看起来像

```
DoublePendulum& DoublePendulum::operator= (const DoublePendulum& DoublePendulumA)
{
    // assign to members of this object

    return *this;
} 
```

# php - 检查远程图像是否存在 PHP

> ID：10489210
> 
> 赞同：2
> 
> 时间：2012-05-07T21:12:06.983
> 
> 标签：php, html, image

我正在使用 last.fm API 来获取最近的曲目并搜索专辑和艺术家等。当从 API 返回图像时，它们有时不存在。一个空的 URL 字符串很容易用占位符图像替换，但是当给出一个图像 url 并返回 404 时，我的问题就出现了。

我尝试使用 fopen($url, 'r') 检查图像是否可用，但有时这会给我以下错误：

```
Warning: fopen(http://ec1.images-amazon.com/images/I/31II3Cn67jL.jpg) [function.fopen]: failed to open stream: HTTP request failed! HTTP/1.1 404 Not Found in file.php on line 371 
```

另外，我不想使用 cURL，因为要检查很多图像，这会大大降低网站速度。

检查图像的最佳解决方案是什么？我现在正在使用以下解决方案：

```
 <img src="..." onerror='this.src="core/img/no-image.jpg"' alt="..." title="..." /> 
```

这有用吗？

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:20:59.673

您可以使用`getimagesize`，因为您正在处理图像，它也会返回图像的 mime 类型

```
 $imageInfo = @getimagesize("http://www.remoteserver.com/image.jpg"); 
```

您还可以使用 CURL 检查 am`image`或任何的 HTTP 响应代码`URL`

```
$ch = curl_init("http://www.remoteserver.com/image.jpg");
curl_setopt($ch, CURLOPT_NOBODY, true);
curl_setopt($ch, CURLOPT_TIMEOUT, 2);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 2);
curl_exec($ch);
if(curl_getinfo($ch, CURLINFO_HTTP_CODE) == 200)
{
    // Found Image
}
curl_close($ch); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:19:17.027

```
function fileExists($path){
    return (@fopen($path,"r")==true);
} 
```

来自 file_exists() 的手册

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T21:21:40.973

根据图像的数量和故障频率，最好坚持使用当前的客户端方法。此外，看起来图像是通过 Amazon CloudFront 提供的——在这种情况下，请使用客户端方法，因为它可能只是单个边缘服务器的传播问题。

应用服务器端方法将是网络密集型和缓慢的（浪费资源），尤其是在 php 中，因为您需要按顺序检查每个图像。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-27T22:45:29.720

[使用get_headers](http://php.net/manual/es/function.get-headers.php) php函数检查请求标头也可能有用，如下所示：

```
$url = "http://www.remoteserver.com/image.jpg";
$imgHeaders = @get_headers( str_replace(" ", "%20", $url) )[0];

if( $imgHeaders == 'HTTP/1.1 200 Ok' ) {
    //img exist
}
elseif( $imgHeaders == 'HTTP/1.1 404 Not Found' ) {
    //img doesn't exist
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-22T16:39:47.160

以下函数将尝试使用 获取 URL 给出的任何在线资源（IMG、PDF 等）`get_headers`，读取标题并使用函数在其中搜索字符串“未找到” `strpos`。如果找到该字符串，表示 URL 给出的资源不可用，该函数将返回 FALSE，否则返回 TRUE。

```
function isResourceAvaiable($url)
{
  return !strpos(@get_headers($url)[0],'Not Found')>0;
} 
```

# c++ - 指针的正确无效值是什么？

> ID：10489211
> 
> 赞同：1
> 
> 时间：2012-05-07T21:12:13.890
> 
> 标签：c++, default-arguments

假设我有这个代码。您的基本“如果调用者不提供值，则计算值”场景。

```
void fun(const char* ptr = NULL)
{
   if (ptr==NULL) {
      // calculate what ptr value should be
   }
   // now handle ptr normally
} 
```

并调用它

```
fun();          // don't know the value yet, let fun work it out 
```

或者

```
fun(something); // use this value 
```

然而，事实证明，ptr 可以有各种值，包括 NULL，所以我不能使用 NULL 作为调用者不提供 ptr 的信号。

所以我不确定现在给 ptr 什么默认值而不是 NULL。我可以使用什么魔法值？有人有想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T21:15:01.270

```
void fun()
{
   // calculate what ptr value should be
   const char* ptr = /*...*/;

   // now handle ptr normally
   fun(ptr);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:16:37.683

根据您的平台，指针可能是 32 位或 64 位值。

在这些情况下，请考虑使用：

```
0xFFFFFFFF or  0xFFFFFFFFFFFFFFFF 
```

但我认为更大的问题是，“如何将 NULL 作为有效参数传递？”

我建议改为使用另一个参数：

```
void fun(bool isValidPtr, const char* ptr = NULL) 
```

或者可能：

```
void fun( /*enum*/ ptrState, const char* ptr = NULL) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T21:29:23.553

我同意提供的所有其他答案，但这是另一种处理方式，对我个人来说，如果更冗长，它看起来更明确：

```
void fun()
{
  // Handle no pointer passed
}

void fun(const char* ptr)
{
  // Handle non-nullptr and nullptr separately
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T01:16:50.340

对不同的输入使用相同函数的重载版本是最好的，但如果你想使用单个函数，你可以将参数设置为指针指向指针：

```
void fun(const char** ptr = NULL) 
{ 
   if (ptr==NULL) { 
      // calculate what ptr value should be 
   } 
   // now handle ptr normally 
} 
```

然后你可以这样称呼它：

```
fun(); 
```

.

```
char *ptr = ...; // can be NULL
fun(&ptr); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-07T21:15:29.617

您应该为此使用 nullptr 。它在 C++11 标准中是新的。在[这里](https://stackoverflow.com/q/1282295/991425)查看一些解释。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-08T02:42:51.487

如果您想要一个与没有用的参数相对应的特殊值，请创建一个。

头文件：

```
extern const char special_value;

void fun(const char* ptr=&special_value); 
```

执行：

```
const char special_value;

void fun(const char* ptr)
{
    if (ptr == &special_value) ....
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-07T21:14:40.300

1？

我无法想象有人用那个地址分配你的内存。

# wordpress - 在 Wordpress 中获取作者的角色

> ID：10489214
> 
> 赞同：4
> 
> 时间：2012-05-07T21:12:37.717
> 
> 标签：wordpress

我正在我的第一个 WP 网站上工作，需要在他们的帖子旁边显示作者的角色。像“吉米|管理员”。查看可用的作者元数据：[http](http://codex.wordpress.org/Function_Reference/the_author_meta) ://codex.wordpress.org/Function_Reference/the_author_meta并没有给我访问它的方法。我敢肯定有一个快速简单的方法来做到这一点，我只是不知道！谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-07T21:18:01.877

**更新：**把它放在你的functions.php文件中：

```
function get_author_role()
{
    global $authordata;

    $author_roles = $authordata->roles;
    $author_role = array_shift($author_roles);

    return $author_role;
} 
```

然后在您的 Wordpress 循环中调用它。所以：

```
<?php
if(have_posts()) : while(have_posts()) : the_post();
    echo get_the_author().' | '.get_author_role();
endwhile;endif;
?> 
```

...将打印：'Jimmy | 行政人员'

**完整答案：**用户对象本身实际上存储角色和其他类型的有用信息。如果您想要更多通用函数来检索任何给定用户的角色，只需传入您要使用此函数定位的用户的 ID：

```
function get_user_role($id)
{
    $user = new WP_User($id);
    return array_shift($user->roles);
} 
```

如果你想获取给定帖子的作者，可以这样称呼它：

```
<?php
if(have_posts()) : while(have_posts()) : the_post();
    $aid = get_the_author_meta('ID');
    echo get_the_author().' | '.get_user_role($aid);
endwhile;endif;
?> 
```

**对最后评论的回应：**

如果您需要在 Wordpress 循环之外获取数据（我想您正在尝试在存档和作者页面上执行此操作），您可以使用我的完整答案中的函数，如下所示：

```
global $post;
$aid = $post->post_author;
echo get_the_author_meta('user_nicename', $aid).' | '.get_user_role($aid); 
```

这将以“用户|角色”格式输出您想要的信息。

# ios - iOS 崩溃 - 没有泄漏，启用 NSZombie 并且不会因异常而中断

> ID：10489217
> 
> 赞同：1
> 
> 时间：2012-05-07T21:12:52.327
> 
> 标签：ios, memory-management, memory-leaks, crash, avplayer

我正在编写一个使用 AVPlayer 来显示视频的 iPad 应用程序。有按钮可以跳转到视频的各个部分，当用户旋转设备时，我会更改包含 AVPlayer 层的视图的大小。

我的问题是，在设备方向发生一定程度的变化并在视频中跳转后，应用程序崩溃了。

我启用了 NSZombie - 这不会中断。我在我的代码中启用了一个断点来捕获异常——这不会中断。我已经运行了仪器并且代码没有泄漏。

分配只是显示“总字节数”随着每个动作不断增长，直到达到 14 meg 并且键盘崩溃。

我觉得我没有办法追根究底。我错过了解决这个问题的一些技巧吗？AVPlayer 发布时需要特殊处理吗？

任何帮助，非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T12:59:08.470

使用工具检查您的分配。我最近遇到了一个非常相似的问题，没有内存泄漏，但是每次启动特定的 ViewController 时，我的总体字节都会不断增长（最终会崩溃）。

事实证明，ViewController 本身作为另一个类的委托是一个强引用（oops），每次我关闭 ViewController 时，其他类仍然有对它的引用。因此，每次我启动并关闭这个 ViewController 时，我都会创建另一个永远不会死（并且永远不会泄漏）的实例。

您的确切问题可能有所不同，但您应该能够通过查看分配来了解总体字节增长的原因。

# c# - LINQ 使用 XElement 进行查询除外

> ID：10489225
> 
> 赞同：2
> 
> 时间：2012-05-07T21:13:37.663
> 
> 标签：c#, asp.net

我有一个从服务接收的数据集。数据采用 XML 格式。我们得到一个包含所有数据的 XElement 对象。XML 文档的结构非常简单。看起来像这样：

```
<root> 
 <dataPoint>
   <id>1</id>
   <param1>somedata</param1>
   <param2>somedata</param2>
 </dataPoint>
 <dataPoint>
   <id>2</id>
   <param1>somedata</param1>
   <param2>somedata</param2>
 </dataPoint>
</root> 
```

当然，我有大量的数据点。我还有一个列表（列表），其中数据点的 id 显示在 GUI 中。我想要的是未显示在 GUI 上的数据点，因此我只能操作这些数据点，而不是整个数据集。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:59:40.627

```
var toDisplay = new List<string>() { "2" };

var xDoc = XElement.Load(.....);
var dPoints = xDoc.Descendants("dataPoint")
                    .Where(d => !toDisplay.Contains(d.Element("id").Value));
var newXml = new XElement("root",dPoints).ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:47:38.677

这是使用可变字典并为您提供点和相应节点的字典的一种方法：

```
var xml = "<root> \r\n <dataPoint>\r\n   <id>1</id>\r\n   <param1>somedata</param1>\r\n   <param2>so" +
"medata</param2>\r\n </dataPoint>\r\n <dataPoint>\r\n   <id>2</id>\r\n   <param1>somedata" +
"</param1>\r\n   <param2>somedata</param2>\r\n </dataPoint>\r\n</root>";    

var doc = XElement.Parse(xml);  

var pointsInGui = new List<int> {1, 3, 5};  

var dict = doc.Descendants("dataPoint").ToDictionary(e => Convert.ToInt32(e.Element("id").Value));      
foreach (var point in pointsInGui) dict.Remove(point); 
```

此时`dict`包含`2 => <relevant element>`.

# php - PHP将文本上传到文件

> ID：10489226
> 
> 赞同：0
> 
> 时间：2012-05-07T21:13:38.793
> 
> 标签：php, html

我正在寻求一些 HTML 功能代码的帮助。

我想从网站上的两个文本框（txtName，txtBody）中获取信息，然后使用 PHP 将这些文本框的内容保存到 ftp 服务器上的文件中。

有人可以指出我正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:19:15.057

正如 dagon 所说，文件放置内容可用于完成此操作，下面是一个简单的示例。

```
<?php
    $file = 'people.txt';
    // Open the file to get existing content
    $current = file_get_contents($file);
    //Assign txtName to variable.
    $name = $_POST['txtName'];
    // Append a new person to the file
    $current .= $name;
    // Write the contents back to the file
    file_put_contents($file, $current);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:27:40.947

如果你处理`ftp`那么你必须使用[http://www.php.net/manual/en/function.ftp-fput.php](http://www.php.net/manual/en/function.ftp-fput.php)

```
$file = $_POST['txtName'];
file_put_contents($file, $_POST['txtBody']);
$fp = fopen($file, 'r');
$conn_id = ftp_connect($ftp_server);
$login_result = ftp_login($conn_id, $ftp_user_name, $ftp_user_pass);
if (ftp_fput($conn_id, $file, $fp, FTP_ASCII)) {
    echo "Successfully uploaded $file\n";
} else {
    echo "There was a problem while uploading $file\n";
}
ftp_close($conn_id);
fclose($fp); 
```

# cakephp - Pypal IPN 已验证，但 Paypal 不断重试

> ID：10489230
> 
> 赞同：1
> 
> 时间：2012-05-07T21:13:47.243
> 
> 标签：cakephp, paypal, paypal-ipn

我正在沙盒中测试 IPN。在我的网站上，我记录了 Paypal 和我的网站之间的通信

```
Start validations:_notify-validate,16.94,Eligible,confirmed,SVWAAUVZX2S4Y,0.00,1 Main    St,13:57:50 May 07, 2012 PDT,Completed,windows-1252,95131,Test,0.84,US,Test   User,3.4,,verified,demarc_1336421374_biz@gmail.com,United States,San  Jose,1,As4zhnwQeMSnsOdh0NBxc2GkfRrEAd8OPZnnd3EWRDz38L81PzX-6vI- ,demarc_1321350258_per@gmail.com,6FT25620DT6366410,instant,User,CA,demarc_1336421374_biz@gmail .com,,6SHJZ2PT5YMLS,web_accept,test item,EUR,,US,1,0.00,test item,,0.00,de0561482901
2012-05-07 22:52:47 Paypal: ResponseVERIFIED
2012-05-07 22:52:47 Paypal: 1
2012-05-07 22:52:47 Paypal: Processing Trasaction: 4fa8361f-7574-444f-b821-5e660a00000f
2012-05-07 22:52:47 Paypal: 4fa8361f-7574-444f-b821-5e660a00000f 
```

好像没问题吧？但是，如果我使用企业帐户登录 Sandbox，在 IPN 历史记录中，我看到 Paypal 一直在尝试发送 IPN。在我的网站上，我将事务记录到数据库中，我看到很多记录（如果响应得到验证，我会存储这些记录）。这怎么可能？我用 cakephp 函数 isValid($data){ 发回 Paypal

```
$data['cmd'] = '_notify-validate';
$newData['cmd'] = '_notify-validate';
foreach ($data AS $key => $val) {
$newData[$key] = $val;
}
    $this->log("Start validations:".join(",",$newData), 'paypal');
    $data = array_map(array('PaypalIpnSource', 'clearSlash'), $newData);

    if (isset($data['test_ipn'])) {
        $server = 'https://www.sandbox.paypal.com/cgi-bin/webscr';
    } else {
        $server = 'https://www.paypal.com/cgi-bin/webscr';
    }

    $response = $this->Http->post($server, $newData);
      $this->log("Response".$response, 'paypal');

    if ($response == "VERIFIED") {
        return true;
    }

    if (!$response) {
        $this->log('HTTP Error in PaypalIpnSource::isValid while posting back to PayPal', 'paypal');
    }

    return false;
} 
```

}

我不认为这是 cakephp 或其他问题。我在沙盒业务帐户中将欧元设置为货币。贝宝提交表格中的货币价值也是欧元。经过几天的谷歌搜索，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-25T13:26:44.070

您的 IPN 端点必须使用 HTTP 状态代码 200 回复 PayPal 的通知。否则状态将保持“重试”。

# javascript - 将函数作为带有变量的参数传递 - 可能吗？

> ID：10489232
> 
> 赞同：0
> 
> 时间：2012-05-07T21:13:50.743
> 
> 标签：javascript

代码：

```
function remove_comment(){
    var id = "bla";
    Msg().prompt( "blabla" , function(){ Ajax().post( "id=" + id ) } , id );
}

Msg().prompt( txt , fn , args ){
    $( elem ).click( fn );
} 
```

如您所见，我需要将此函数传递给prompt()，而在传递的函数内部，其中一个参数取决于变量`id`。

现在，在函数通过后，我需要将它分配给元素的 onclick 事件（代码居所不使用 jQuery）。

首先，我尝试过这样做: `$( elem ).click( fn.apply( this , id ) );`, `$( elem ).click( fn.call( id ) );`，但是这些代码会立即执行该函数（我已经知道原因，无需解释）。然后我尝试使用该函数并将其排列为字符串以直接作为`onclick='THE_FUNCTION'`html代码传递给元素，但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:17:24.387

研究使用 JS 方法`call`或`apply`函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:27:50.360

您可以在提示函数中将回调参数作为额外参数传递，如下所示：

```
Msg().prompt( txt, fn, args[]); 
```

然后在提示功能内使用 apply

```
fn.apply(this, args); 
```

更新：

试试这个：

```
$( elem ).click( {id: arg}, fn ); 
```

所以匿名应该是这样的：

```
Msg().prompt( "blabla" , function(e){ Ajax().post( "id=" + e.data.id ) } , id ); 
```

希望能帮助到你

# ruby-on-rails - rails 3.1 has_many：通过连接模型中的额外字段

> ID：10489235
> 
> 赞同：2
> 
> 时间：2012-05-07T21:13:59.617
> 
> 标签：ruby-on-rails, ruby, associations, has-many, has-many-through

我正在尝试解决 has_many ：通过与连接模型中的附加 text_field 关联。现有的答案都没有对我有用。

我有三个模型：

```
class Partner
    has_many :prices
    has_many :services, :through => :prices
    accept_nested_attributes_for :prices
end

class Service
    has_many :prices
    has_many :partners, :through => :prices
end

class Price
    belongs_to :service
    belongs_to :partner
end 
```

价格表如下所示：

```
 id
    partner_id
    service_id
    price 
```

我需要为每个选定的服务输入价格。

视图如下所示：

```
 <%= form_for(@partner, :url => save_services_path(@partner.id), :remote => true) do |f| %>
  <table>
    <% @services.in_groups_of(4, false) do |services| %>
      <tr>
        <% services.each do |service| %>
          <td>
        <%= check_box_tag "partner[service_ids][]", service.id, @partner.services.include?(service) %> 
        <%= service.name %>
        <%= f.fields_for :prices do |p| %>
          <%= p.text_field :price %>
        <% end %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </table>
<% end %> 
```

复选框工作正常，但我无法更新服务价格。我相信问题出在嵌套形式的语法中......我尝试了许多不同的组合但没有奏效。

提前致谢！

更新：

控制器动作：

```
def save_services
  @partner = Partner.find(params[:id])
  @partner.update_attributes(params[:partner]
end 
```

日志：

```
Started PUT "/partners/save_services/337" for 
Processing by PartnersController#save_services as JS
  Parameters: {"utf8"=>"â", "authenticity_token"=>"xxx", "partner"=>{"service_ids"=>["20", "24"]}, "commit"=>"Save", "id"=>"337"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:03:51.960

你为什么有这个？

```
:url => save_services_path(@partner.id) 
```

在你的 form_for 中？您正在使用@partner 创建表单，但使用服务保存.. 尝试

```
<%= form_for(@partner, :url => {:action => 'update'}, :remote => true) do |f| %> 
```

或从日志中发布您的参数

# python - 对象不可调用python

> ID：10489236
> 
> 赞同：1
> 
> 时间：2012-05-07T21:14:05.793
> 
> 标签：python, tkinter, callable

尝试从类中获取变量时出现此错误。使用 tkinter 和类选项

```
width = ins.width()
TypeError: 'int' object is not callable 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T21:15:38.800

`width`不是方法（您可以调用），而是属性（类型`int`）。

如果您重新阅读错误，它可能会开始变得更有意义。

简而言之：你只需要去掉括号。

例如

```
width = ins.width 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:17:15.687

您总是必须区分被调用的方法和简单的属性访问。`width`似乎是属性或普通实例变量，而不是方法。因此，您不能调用它，而只是获取（或设置）它的值。

```
width = ins.width 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T21:39:07.093

`()`仅适用于 python 中的函数/方法调用。你想要的是访问像这样的属性`ins.width`

# android - 如何弹出“?123”安卓键盘

> ID：10489239
> 
> 赞同：10
> 
> 时间：2012-05-07T21:14:19.643
> 
> 标签：android, keyboard

我有一个 EditText 需要根据状态处理数字和/或字母输入。在某些情况下，用户可以输入任一类型的输入。我只能使用可以使用的“电话”键盘弹出“电话”键盘`setInputType (InputType.TYPE_CLASS_NUMBER);`，但不允许用户返回 QWERTY 键盘。由于大部分输入确实是数字，因此我想在大多数情况下向用户展示 ?123 键盘。他们只需要返回 QWERTY 键盘几次。

如何弹出屏幕 QWERTY 键盘进行字母输入，然后弹出“？123”键盘（如果是数字）？我只想为用户保存一个步骤，这样他们就不必每次都按 QWERTY 键盘上的 ?123 按钮。

**更新**：这是我希望可见的键盘。原因是我希望用户在字母输入和数字输入之间轻松切换。无法从“数字键盘”切换到 QWERTY 键盘。在我的应用程序中，90% 的输入都需要数字输入，因此我想将其弹出以方便起见。换句话说，他们不必在 90% 的时间切换到数字键盘，而只需在 10% 的时间切换到 QWERTY![在此处输入图像描述](../Images/0143228a21c5535c1495877016c29ed2.png)

`input.setRawInputType(Configuration.KEYBOARD_QWERTY);`对 Honeycomb 和更高版本的 Gingerbread的调用不同（调出数字键盘）。在 Gingerbread 2.2.3 上，它按我想要的方式工作。Honeycomb 和 2.3.7 键盘屏幕截图如下供参考。我不知道他们为什么如此不同。

![用于 Configuration.KEYBOARD_QWERTY 的 Honeycomb 3.2 键盘](../Images/1252f85bbe4f6fd9825900fac7bc4720.png) ![用于 Configuration.KEYBOARD_QWERTY 的 Gingerbread 2.3.7 键盘](../Images/b78c1ab13c99a7423c06328901b5cd20.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-04-04T07:02:16.963

您可以使用多种方式来使用数字键盘。下面列出了一些，

**方法1：** 将此属性添加到您的文本字段（EditText）

```
android:inputType="number" 
```

**方法二：**

以编程方式使用它

```
edittext.setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_FLAG_DECIMAL | InputType.TYPE_NUMBER_FLAG_SIGNED); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:19:48.633

我相信这篇[文章](https://stackoverflow.com/questions/6153796/how-do-i-default-to-numeric-keyboard-on-edittext-without-forcing-numeric-input)回答了你的问题。

简而言之，将其添加到您的代码中：

```
editText.setRawInputType(Configuration.KEYBOARD_QWERTY); 
```

# iphone - 应用运行一段时间后，iPhone 广告停止工作

> ID：10489253
> 
> 赞同：2
> 
> 时间：2012-05-07T21:15:22.347
> 
> 标签：iphone

iAd 工作正常。然后当我真正测试时，调用所有不同的视图控制器，它会在某些屏幕上停止工作。

我的应用程序有大约 15 个屏幕。因此，当我真正调试它时，我会转到所有屏幕并为所有屏幕创建一个 iAd 对象。

我注意到如果我在 iAds 委托函数上设置断点，它们都会被调用。因此，如果我浏览并查看所有 15 个屏幕，我会在 15 个不同的文件中出现断点，对于创建的每个 iAd，因此看起来当您创建一个窗口时，视图控制器会继续运行，即使您调用另一个屏幕。

所以我对它进行了测试，只调出 7 个屏幕，效果很好。在我调用了更多的 7 个屏幕后，iAd 不再适用于剩余的屏幕，继续调用 - (void)bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(NSError *)error

方法。

有没有其他人有这个问题？我正在考虑尝试拥有一个 iAd 对象并使用添加和删除子视图。想知道其他人是否有更简单的解决方案 Ted

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T23:11:32.087

在不知道传递给 -bannerView:didFailToRecieveAdWithError: 的错误的情况下，很难给你一个彻底的答案。Apple 很可能只是不发送 iAd，因为他们并不总是发送 iAd。如果您想在每个页面上都有一个 iAd，我建议创建一个名为 wholeAppAd 的类，该类由 UIAdBannerView 提供，并像使用单例类一样使用该类（[http://www.galloway.me.uk/tutorials/singleton -类/](http://www.galloway.me.uk/tutorials/singleton-classes/)）。通过这样做，您可以从任何控制器访问横幅视图并添加相同的横幅作为子视图。希望我有所帮助。

# uitableview - 存储应用信息以供下次加载

> ID：10489259
> 
> 赞同：0
> 
> 时间：2012-05-07T21:15:50.600
> 
> 标签：uitableview, ipad, ios5

我有一个应用程序，我想用它来存储不同人的数据。例如，假设您将人员 A、B、C 添加到表中；然后当你点击它们时，你可以添加更多他们的数据——电话号码、地址等。

我希望能够存储这些条目中的每一个的信息，以便能够在应用程序下次启动时显示它们（以及当我在不同的表条目之间切换时）。目前，如果我将数据添加到一个人的详细信息中，如果我切换到另一个人，第一个数据就会消失，因为我没有以任何方式存储。

我不想使用 Core Data，因为它只用于少量条目（大约十几个）。谁能告诉我如何存储每个条目以便在运行时提取它（或者每当我点击一个我已经添加了详细信息的条目时）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:20:31.860

将每个条目存储在`NSArray`s`NSDictionary`中，而后者又可以存储在`NSUserDefaults`.

# java - 使用什么数据结构？

> ID：10489260
> 
> 赞同：-2
> 
> 时间：2012-05-07T21:15:53.080
> 
> 标签：java, data-structures

我想使用数据结构存储信息。

例如，我有一个类似的数据：

```
Code    Applicable values
001     A,B,C,D
004     C,D
005     P,Q,R,S
007     S,C
..
..
..
1000 (Code, Applicable values pair) 
```

我能想到的直接解决方案是`HashMap`使用 key type`String`和 value type `HashSet`。

建筑师之前告诉我，`Set`加入`Map`不是一个好主意。

关于如何实施这一点的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T10:38:33.363

A`HashMap<String, HashSet<String>>`对我来说看起来很好，因为它保存了您显示的数据类型。

当我们谈论该数据结构如何暴露给您的程序的其余部分时，您的“架构师”可能是正确的。例如：

*   上面的那个类型签名并没有说明什么样的字符串被用作键，以及值集中有什么样的值。它们代表名字吗？还是 ISBN 号？或者任何文本，或者只有特定的枚举值？等等

*   如果您`HashMap`在代码中的任何地方都使用了这样的一个，那么在向集合中添加值时，您必须记住到处执行两个步骤：（1）仅当字典中没有某个给定键的值时才创建一个空集合，以及（2 ) 将新值添加到给定键的集合中。不得不考虑这样的常规事情为错误打开了大门。

也许将您的实际数据结构隐藏在一个漂亮、简单且易于使用的“收集”界面后面会更好，可能类似于以下内容：

```
interface ApplicableValuesCollection
{
    void Add(int code, String value);
    void Remove(int code, String value);
    bool Contains(int code, String value);
    Iterable<String> GetValuesOfCode(int code);
    …
} 
```

# jquery - 从 JSON 对象生成自身的自定义 jQuery 小部件

> ID：10489262
> 
> 赞同：0
> 
> 时间：2012-05-07T21:16:01.193
> 
> 标签：jquery, jquery-ui

我刚刚开始学习 jQuery，并且已经掌握了一些基本的布局和 UI 插件。但是，我想创建一个自定义小部件，使用如下所示的语法：

```
var objs = [
            {name: 'obj1', prop1: 'val1', prop2: 'val2'},
            {name: 'obj2', prop1: 'val3', prop2: 'val4'},
            {name: 'obj3', prop1: 'val5', prop2: 'val6'},
           ];

$(document).ready(function(){
  myList = $('#divlist').mywidget(objs);
}); 
```

此代码在名为“divlist”的 div 中创建一个可拖动对象列表。问题在于，包含列表项的 html/格式需要由小部件生成并动态添加到父容器中，因为它们事先不会存在于 html 中。

我见过的所有 jQuery 教程都在预先存在的 html 上运行，只需重新格式化/移动/设置样式即可。有人对我如何做到这一点有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:23:41.190

我认为您想知道如何在 JavaScript/jQuery 中动态创建新元素（例如 div 或 spans 或表）？如果是这样，有几种方法。

**使用文档对象创建它。**

```
var my_new_element = document.createElement("div");
// Then feed it to jQuery so you can work with it.
$(my_new_element); 
```

**或者使用 jQuery 创建它。**

```
var my_new_element = $('<div>'); 
```

对于您的解决方案，您需要遍历 JSON 对象数组并创建每个 div，然后将它们添加到您的父容器中。例子：

```
var parent_div = '#divlist';
for (var i = 0; i < objs.length; i++) {
  // Feed it straight to jQuery so it's easier to work with.
  var widget_member = $(document.createElement('div'));

  // Make it draggable.
  widget_member.draggable();

  // Append to the parent div.
  $(parent_div).append(widget_member);
} 
```

# google-maps - JQuery Mobile 和 Google 地图无法正确呈现

> ID：10489264
> 
> 赞同：10
> 
> 时间：2012-05-07T21:16:04.733
> 
> 标签：google-maps, jquery-mobile

我只是想在 jquery 移动页面中显示谷歌地图。如果我直接加载页面，它可以工作。但是，如果我从另一个页面导航到该页面，它只会呈现一个地图图块。乍一看，我的问题似乎类似于[https://forum.jquery.com/topic/google-maps-inside-jquery-mobile](https://forum.jquery.com/topic/google-maps-inside-jquery-mobile)

但是，我已经在“pageinit”事件中执行了初始化，并且我的地图 div 具有设置的宽度和高度。

我看过[http://code.google.com/p/jquery-ui-map/](http://code.google.com/p/jquery-ui-map/)但如果可能的话，我宁愿不使用（另一个）第三方插件。

这是我的页面的样子：

```
<!DOCTYPE HTML>
<html>
<head>
    <title>PhoneGap</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="cordova-1.6.1.js"></script>
    <link rel="stylesheet" href="jquery.mobile-1.1.0.min.css" />
    <script src="jquery-1.7.1.min.js"></script>
    <script src="global.js"></script>
    <script src="jquery.mobile-1.1.0.min.js"></script>
</head>
<body>
    <div id="mapPage" data-role="page">
        <style type="text/css">
            html
            {
                height: 100%;
            }
            body
            {
                height: 100%;
                margin: 0;
                padding: 0;
            }
            #map_canvas
            {
                height: 100%;
            }
        </style>
        <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=***API_KEY_REMOVED***&sensor=true">
        </script>
        <script type="text/javascript">
            function initialize() {
                var height = $(window).height() - 50;
                var width = $(window).width();

                $("#map_canvas").height(height);
                $("#map_canvas").width(width);
                var myLatlng = new google.maps.LatLng(39.962799, -82.999802);
                var myOptions = {
                    center: myLatlng,
                    zoom: 18,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                var map = new google.maps.Map(document.getElementById("map_canvas"),
            myOptions);
                //alert($(map.getDiv()).width());   
                var marker = new google.maps.Marker({
                    position: myLatlng,
                    map: map,
                    title: ""
                });
                google.maps.event.trigger(map, 'resize')
            }

            $("#mapPage").live('pageinit', function () {

                initialize();
            });

        </script>
        <div data-role="header" id="menuHeader">
            <a href="MenuDialog.htm" class="menuLink" data-role="none" data-rel="dialog">
                <img class="headerIcon" style="height: 40px; border-right: 1px solid #333333; padding-right: 5px;"
                    id="MenuIcon" src="images/menuIcon.png" /></a>
            <p>
                Loc
            </p>
        </div>
        <div data-role="content">
            <div id="map_canvas" style="margin-top: 50px;">
            </div>
        </div>
</body>
<html> 
```

提前感谢您的帮助。

**更新：**

经过一些试验后，我在我的调整大小事件中添加了以下延迟：

```
setTimeout(function() {

            google.maps.event.trigger(map,'resize');
        }, 500); 
```

这似乎解决了这个问题。希望这对其他人有帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-03T09:58:33.887

我在一个网站上读到，如果你有这个问题，那是因为当你初始化你的谷歌地图时，dom 没有完全加载。你必须在你的代码中添加这个：

```
$( document ).bind( "pageshow", function( event, data ){
google.maps.event.trigger(map, 'resize');
}); 
```

这个对我有用。在您显示的每个页面上调整大小可能很残酷，但是......它有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-07T21:32:27.910

您有`<html>`100 `<body>`% 的大小，但没有和`<div>`之间的层次结构中的 s 。`<body>``<div id="map_canvas">`

尝试将这些添加到您的 CSS 中（`content`需要一个`id`.

您可能还需要通过在一切准备就绪时`<div>`触发事件来确保 API 知道地图的大小。`resize`仅显示单个图块是 API 出错的典型症状（通常假设它的大小为零）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-13T08:55:47.160

我没有触发调整大小，而是通过将我的 js 包装在“pagecreate”事件中来解决这个问题......就像这样：

```
$(document).on('pagecreate', '#map', function() {
    var mapOptions = {
        center: new google.maps.LatLng(40.773782,-73.974236),
        zoom: 12,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };  

    var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-08T12:26:21.273

我认为正确的方法是在部分图块加载一次时触发事件。下面的代码片段将帮助您实现这一目标。

```
google.maps.event.addListenerOnce(map, 'tilesloaded', function(){
    google.maps.event.trigger(map,'resize');
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-16T16:18:52.593

我发现问题在于 JQuery mobile 使用 Ajax 加载页面。我不确定这是否是最佳做法，但我只是通过将以下代码放入锚标记中来强制它正常加载我的地​​图页面：

```
data-ajax="false" 
```

# text - 如果未选择任何文本，则使用 AppleScript Automator 服务来处理所有文本

> ID：10489265
> 
> 赞同：0
> 
> 时间：2012-05-07T21:16:12.687
> 
> 标签：text, osx-lion, applescript

我正在使用[nslater 的精彩脚本](http://gist.github.com/1616556)来计算选定文本块中的单词和字符，但我需要两个增强功能：

1.  **即使没有选择文本，也可以使用脚本。**目前，当我在没有选择的情况下拉出可用服务列表时，服务不存在（当然，这是合乎逻辑的，但增强 #2 会改变事情）。

2.  **向脚本添加条件行为：**如果未选择文本，则处理*所有*文本，但如果有选择，则仅处理所选文本。

这是**nslater 的**脚本，我将其粘贴到 Automator 中（我按照他注释说明中的步骤创建了服务）：

```
# Word and Character Count service for Mac OS X
#
# Adds a Word and Character Count option to the text selection context menu in all apps
#
# Use Automator.app to create a new service, and then select the Run AppleScript action.
# Paste this code in to the text box, and save as Word and Character Count. Now switch to
# a new app, select some text, and open the context menu to find the new option.

on run {input, parameters}
    tell application "System Events"
        set _appname to name of first process whose frontmost is true
    end tell
    set word_count to count words of (input as string)
    set character_count to count characters of (input as string)
    tell application _appname
        display alert "" & word_count & " words, " & character_count & " characters"
    end tell
    return input
end run 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T15:32:35.190

以下 AppleScript 代码将执行您的操作：

```
tell application "System Events" to set frontApplication to (first application process whose frontmost is true)
set theText to my getCurrentTextContents(frontApplication)
if theText is not "" then
    set wordCount to count words of theText
    set charCount to count characters of theText
    tell application (name of frontApplication) to display alert "" & wordCount & " words, " & charCount & " characters"
end

on getCurrentTextContents(ofApplication)
    tell application "System Events"
        try -- time-out as some UI elements block, notably system sheets
            with timeout of 5 seconds
                set allElements to entire contents of window 1 of ofApplication
            end timeout
        on error
            return ""
        end try

        repeat with UIelement in allElements
            try –– very large element collections can change before looped through
                if focused of UIelement is true then
                    if attribute "AXSelectedTextRange" of UIelement exists then
                        set {x, y} to value of attribute "AXSelectedTextRange" of UIelement
                        if y ≥ x then
                            return value of attribute "AXSelectedText" of UIelement
                        else
                            return value of UIelement
                        end if
                    else
                        return ""
                    end if
                end if
            on error errorMessage
                log errorMessage
                return ""
            end try
        end repeat
        return ""
    end tell
end getCurrentTextContents 
```

如果您想在服务中使用它，则必须将该服务设置为“无输入”——正如 Ken Thomases[在他的评论中](https://stackoverflow.com/questions/10489265/augment-a-word-count-applescript-service-with-a-conditional-hotkey-behaviour#comment13558927_10489265)正确指出的那样，服务仅在有选择时才处理输入。在“无输入”服务的情况下，您实际上是在为脚本创建一个全局（或特定于应用程序，如果您将服务限制为应用程序）启动点。任何其他不会从它的目标应用程序中窃取焦点的脚本启动器也将提供服务（并且可能更快——Automator 服务在首次启动时往往是*veeerrrrryyyyy sssllllooooowwww*）。

另请注意，整个事情通过[Accessibility API](http://developer.apple.com/library/mac/#documentation/UserExperience/Reference/Accessibility_RoleAttribute_Ref/Introduction.html#//apple_ref/doc/uid/TP40007870-Introduction-SW1)（GUI 脚本的基础）工作，并且需要访问 API 才能由用户启用 - 通过在*System Preferences*的“Accessibility”窗格中选中“Enable Access for Assistive Devices” ，或通过做

```
tell application "System Events" to if not UI elements enabled then
    activate
    set UI elements enabled to true
end if 
```

它还要求目标应用程序在其文本视图中支持 Apple 定义的 Accessibility API（请参阅[上面](http://developer.apple.com/library/mac/#documentation/UserExperience/Reference/Accessibility_RoleAttribute_Ref/Introduction.html#//apple_ref/doc/uid/TP40007870-Introduction-SW1)链接的文档），并且这样做是正确的。MS Office 应用程序，其中之一（它们使用没有选择属性的非标准视图 -[感谢@adayzdone](https://stackoverflow.com/questions/10489265/have-an-applescript-automator-service-to-process-all-text-if-no-text-is-selected/10501755#comment13579000_10501755)），如果 Adob​​e CS 应用程序也没有，我不会感到惊讶。Java 和 AIR 应用程序也可能会出现问题。

最后，当我处于*警告购买*阶段时，我将添加脚本的速度直接取决于目标应用程序的 UI 层次结构的复杂性。这对于普通应用程序来说不是问题，但对于 WebKit 生成的 Web 视图（即*Safari*等）来说肯定是问题。– 因为它们将整个 DOM 映射到 UI 元素。虽然在可访问性方面非常值得称赞，但这会导致 UI 层次结构庞大，需要相当长的时间才能遍历。

# php - 如何获取用户选择类型的所有记录

> ID：10489266
> 
> 赞同：0
> 
> 时间：2012-05-07T21:16:13.843
> 
> 标签：php, html, ajax, select

我有一个 HTML 文本输入字段 - 例如：

```
<input id="CustID" name="CustID" dir="rtl" value="<? echo $CustID;?>" size="35" required="true" maxlength="9" > 
```

当我插入用户号码时，我需要打开一个选择框来显示该用户的所有票证。

例如

```
 <select name="ticket" id="ticket" >
<? 
$query="SELECT * FROM ticket where CustID='$CustID' ";
$result=mysql_query($query) or die("error: " . mysql_error());
while($row=mysql_fetch_array($result))
{
?>  
    <option  value="<?php echo $row['ticket'] ; ?>"><?php echo $row['ticket'] ; ?></option>   
<? }  ?>
    </select> 
```

我如何将它与 AJAX 一起使用？

这是我到目前为止所拥有的：

```
<script src="js/jquery.js"></script>
<script language="javascript">
function getData(id) {
        $.ajax ({
           url: "php_page.php",
           type: "POST",
           data: {custid:id},
           success: function(data){
                    $("#return").html(data)
                    }
        )} // i have error her why ??
}

</script>

   <input type="text" value="<?php echo $CustID;?>" onkeyup="getData(this.value)"/>
    <?   
    include("functions/connect.php");
    $query = "select * from customers2 ,  tickets where customers2.CustID='".$CustID."' and tickets.CustNo=customers2.CustomersNo";
    $result=mysql_query($query) or die("error: " . mysqli_error());
    while($row=mysql_fetch_array($result))
    {
    ?>  
      <option  value="<?php echo $row['ticket'] ; ?>"><?php echo $row['ticket'] ; ?></option>   
    <? }  ?>
    </select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:25:13.570

使用 AJAX 将 CustID 传递给 Select 页面。

IE

索引.php

```
<script>
function callAjax(str)
{
 ajax
}
</script>
<input type = "text" name = "CustID" onblur="callAjax()"/>
<div id = "show">where to display the ajax results</div> 
```

ajax.php

```
all that code with the select and options. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:39:49.887

将您的 php 放在名为 php_page.php 的单独页面上。使用显示页面上的 jquery 库创建[ajax调用：](http://api.jquery.com/jQuery.ajax/)

```
function getData(id) {
        $.ajax ({
           url: "php_page.php",
           type: "POST",
           data: {custid:id},
           success: function(data){
                    $("#return").html(data)
                    }
        )}
} 
```

在您的表单页面上创建一个 id 为“return”的 div，您希望在其中显示您的选择选项，并通过单击按钮或 onkeyup 调用此函数：

```
 <input type="text" value="<?php echo $CustID;?>" onkeyup="getData(this.value)"/> 
```

哦，你的 mysql 连接应该使用[mysqli 库](http://www.php.net/manual/en/mysqli.construct.php)：

```
 $con=mysqli_connect($host,$username,$password,$database);
    $query = //same as before
    $result=mysqli_query($query) or die("error: " . mysqli_error());
    while($row=mysqli_fetch_array($result))
    {
      ?>  
      <option  value="<?php echo $row['ticket'] ; ?>"><?php echo $row['ticket'] ; ?></option>   
    <? }  ?>
    </select> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T14:06:35.280

我会做，但结果是让我选择所有记录，我不会只记录我输入 ID 的用户

索引.php

```
<script src="js/jquery.js"></script>
<script language="javascript">
function getData(id) {
        $.ajax ({
           url: "php_page.php",
           type: "GET",
           data: {custid:id},
           success: function(data){
                    $("#return").html(data)
                    }
        })
}

</script>
<input type="text" id="CustID" name="CustID" onkeyup="getData(this.value)"/>
<div id="return"></div> 
```

php_page.php

```
<select>
<option  value="">عرض الكل</option>
<?   
include("functions/connect.php");
if(isset($_GET['CustID']))
{
$CustID = $_GET['CustID'];
$sql_check = mysql_query("select * from customers2 , omra , haj , tickets where customers2.CustID='".$CustID."' and tickets.CustNo=customers2.CustomersNo") or die(mysql_error());
if(mysql_num_rows($sql_check)){
    while($rows = mysql_fetch_array($sql_check)){

?>  
<option  value="<?php echo $rows['TicketType'] ; ?>">تذكرة <?php echo $rows['TicketType'] ; ?> برقم <?php echo $rows['TicketRealNo'] ; ?></option>   
<? } } ?>
</select>
<? } ?> 
```

# php - 通过将当前 URL 与 $_SERVER['QUERY_STRING'] 匹配来粗体链接；

> ID：10489274
> 
> 赞同：0
> 
> 时间：2012-05-07T21:16:53.500
> 
> 标签：php

我正在尝试根据访问者当前所在的页面在菜单中创建粗体链接。我设法让它使用以下代码，但问题是我的代码可能在选项下有子菜单，所以链接可能是：

```
index.php?page=category
index.php?page=category&subcategory=something
index.php?page=category&subcategory=somethingelse 
```

子类别运行良好，但问题是，我无法匹配“index.php?page=category”，因为子类别“something”和“somethingelse”也会变粗。

有没有办法匹配“page=category”的确切字符串但没有进一步的？

```
<?
$urlstring = $_SERVER['QUERY_STRING'];
if (preg_match ("/page=category/i", $urlstring)) {
echo "<b>";
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:34:27.967

您可以仅使用等于运算符来执行此操作，

```
if ("page=category" == $url_string) 
```

这更清晰，更易于阅读，并且可能更快。

话虽如此，您可以通过使用指定字符串开头和结尾的标记稍微修改正则表达式来获得相同的结果，如下所示：

```
if (preg_match("/^page=category$/"', $url_string) 
```

美元符号确保与一个不会进一步进行比较的字符串进行比较（“类别”中的“y”之后没有任何内容。插入符号（^）在字符串的开头执行相同的操作：它指定您正在检查以“page=cat...”开头的字符串

有关这种正则表达式用法的更多信息：[http ://www.regular-expressions.info/anchors.html](http://www.regular-expressions.info/anchors.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:31:50.680

是的，只需使用`$_GET['page']`

此外，您可能希望将一个带有粗体的类应用于您使用粗体而不是使用的任何元素`<b>`（您可以更好地控制样式，甚至可以更改颜色）

干杯-D

# java - 将以下客户端-服务器应用程序更改为从文件中读取

> ID：10489275
> 
> 赞同：-1
> 
> 时间：2012-05-07T21:16:56.713
> 
> 标签：java, sockets, networking, client-server

目前，我有 2 个应用程序，一个客户端和一个服务器，服务器创建一个套接字，客户端连接到服务器套接字。

我希望自定义应用程序，以便客户端可以键入“注册”，然后要求提供在服务器上注册帐户所需的信息。

问题是，我不知道从哪里开始。

这是我目前拥有的：

客户：

```
import java.io.*;
import java.net.*;
public class Requester{
Socket requestSocket;
ObjectOutputStream out;
ObjectInputStream in;
String message;
Requester(){}
void run()
{
    try{
        //1\. creating a socket to connect to the server
        requestSocket = new Socket("localhost", 2004);
        System.out.println("Connected to localhost in port 2004");
        //2\. get Input and Output streams
        out = new ObjectOutputStream(requestSocket.getOutputStream());
        out.flush();
        in = new ObjectInputStream(requestSocket.getInputStream());
        //3: Communicating with the server
        do{
            try{
                message = (String)in.readObject();
                System.out.println("server>" + message);
                sendMessage("Hi my server");
                message = "bye";
                sendMessage(message);
            }
            catch(ClassNotFoundException classNot){
                System.err.println("data received in unknown format");
            }
        }while(!message.equals("bye"));
    }
    catch(UnknownHostException unknownHost){
        System.err.println("You are trying to connect to an unknown host!");
    }
    catch(IOException ioException){
        ioException.printStackTrace();
    }
    finally{
        //4: Closing connection
        try{
            in.close();
            out.close();
            requestSocket.close();
        }
        catch(IOException ioException){
            ioException.printStackTrace();
        }
    }
}
void sendMessage(String msg)
{
    try{
        out.writeObject(msg);
        out.flush();
        System.out.println("client>" + msg);
    }
    catch(IOException ioException){
        ioException.printStackTrace();
    }
}
public static void main(String args[])
{
    Requester client = new Requester();
    client.run();
}
} 
```

服务器：

```
import java.io.*;
import java.net.*;
public class Provider{
ServerSocket providerSocket;
Socket connection = null;
ObjectOutputStream out;
ObjectInputStream in;
String message;
Provider(){}
void run()
{
    try{
        //1\. creating a server socket
        providerSocket = new ServerSocket(2004, 10);
        //2\. Wait for connection
        System.out.println("Waiting for connection");
        connection = providerSocket.accept();
        System.out.println("Connection received from " + connection.getInetAddress().getHostName());
        //3\. get Input and Output streams
        out = new ObjectOutputStream(connection.getOutputStream());
        out.flush();
        in = new ObjectInputStream(connection.getInputStream());
        sendMessage("Connection successful");
        //4\. The two parts communicate via the input and output streams
        do{
            try{
                message = (String)in.readObject();
                System.out.println("client>" + message);
                if (message.equals("bye"))
                    sendMessage("bye");
            }
            catch(ClassNotFoundException classnot){
                System.err.println("Data received in unknown format");
            }
        }while(!message.equals("bye"));
    }
    catch(IOException ioException){
        ioException.printStackTrace();
    }
    finally{
        //4: Closing connection
        try{
            in.close();
            out.close();
            providerSocket.close();
        }
        catch(IOException ioException){
            ioException.printStackTrace();
        }
    }
}
void sendMessage(String msg)
{
    try{
        out.writeObject(msg);
        out.flush();
        System.out.println("server>" + msg);
    }
    catch(IOException ioException){
        ioException.printStackTrace();
    }
}
public static void main(String args[])
{
    Provider server = new Provider();
    while(true){
        server.run();
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:27:33.637

您的问题（从哪里开始）的答案是您可能应该从以下**两个**输入/输出循环开始：

1.  服务器，检查接收“注册”
2.  客户端，添加一种读取输入的方法，然后将其发送到服务器

# binary - 八进制全加器 如何

> ID：10489277
> 
> 赞同：8
> 
> 时间：2012-05-07T21:17:09.580
> 
> 标签：binary, computer-architecture, circuit, boolean-operations

*我有这个项目在下面听，我不确定从哪里开始也许有人可以给我一些指示，或者指出我开始这个的正确方向？谢谢！！*

**输入：** A, B = 八进制数字（见下图）；Cin = 二进制数

**输出：** S = 八进制数字（见下图）；Cout = 二进制数

任务：***使用二进制 FA，设计一个充当八进制 FA 的电路***。更具体地说，该电路将输入两个八进制数字 A、B，将它们转换为二进制数，仅使用二进制 FA 将它们相加，将二进制结果转换回八进制，并将和作为八进制数字输出，二进制执行.

**八进制数字的输入/输出二进制表示**

每个八进制数字都将使用以下 8 位二进制表示形式表示：

八进制 8 位输入线：

**数字：** 0 1 2 3 4 5 6 7
0 1 0 0 0 0 0 0 0
1 0 1 0 0 0 0 0 0
2 0 0 1 0 0 0 0 0
3 0 0 0 1 0 0 0 0
4 0 0 0 0 1 0 0 0
5 0 0 0 0 0 1 0 0
6 0 0 0 0 0 0 1 0
7 0 0 0 0 0 0 0 1

您需要以结构化的方式设计电路。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-19T08:43:52.600

好的，所以基本上你被要求设计一个 8-to-3 编码器和一个 3-to-8 解码器。因为你有 FA 来工作，所以这不是任务的重点。

首先，我们需要定义编码器和解码器的功能。所以我们构造了一个真值表：

编码器：

```
Input    | Output
01234567 | 421
-----------------
10000000 | 000
01000000 | 001
00100000 | 010
00010000 | 011
00001000 | 100
00000100 | 101
00000010 | 110
00000001 | 111 
```

解码器正好相反。

接下来，我们如何构建我们的编码器？好吧，我们可以一次简单地攻击它。

因此对于 1 位数字，如果设置了输入位 1、3、5 或 7，则为 1，否则为 0。所以我们只需要一个巨大的 OR，其中 4 个输入连接到 1、3、5 和 7。

对于 2s 数字，我们需要将 OR 门连接到 2、3、6、7。最后，对于 4s 门，将它们连接到 4、5、6、7。这不会进行任何错误检查以确保额外的位没有设置。虽然，这种情况下的行为似乎没有被规范定义，所以它可能没问题。

然后你拿你的三行并将它们提供给你的加法器。这很容易，所以我不会进入它。

最后你需要一个解码器，这比编码器要复杂一些。

让我们看一下解码器真值表：

```
Input | Output
421   | 01234567 
----------------
000   | 10000000
001   | 01000000
010   | 00100000
011   | 00010000
100   | 00001000
101   | 00000100
110   | 00000010
111   | 00000001 
```

这次我们不能只使用 3 或门就可以收工了。

让我们用类似 C 的代码写下来：

```
if (!input[0] && !input[1] && !input[2])
  output[0] = 1
if (input[0]  && !input[1] && !input[2])
  output[1] = 1
if (!input[0] && input[1]  && !input[2])
  output[2] = 1
if (input[0]  && input[1]  && !input[2])
  output[3] = 1
if (!input[0] && !input[1] && input[2])
  output[4] = 1
if (input[0]  && !input[1] && input[2])
  output[5] = 1
if (!input[0] && input[1]  && input[2])
  output[6] = 1
if (input[0]  && input[1]  && input[2])
  output[7] = 1 
```

所以，看起来我们将使用 8 个 3 输入与门和三个非门！

这个有点复杂，所以我做了一个示例实现：

![3对8解码器](../Images/e6e2eba0a8a655fac522b7c4e251c122.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T06:40:49.040

如果要在课堂上手工转换，可以试试下面的方法。

**八进制到二进制的转换：**

要将八进制转换为二进制，请将每个八进制数字替换为其二进制表示。示例：将 518 转换为二进制：58 = 1012 18 = 0012 因此，518 = 101 0012。

**二进制到八进制的转换：**

该过程与之前的算法相反。二进制数字按三位分组，从小数点（如果存在）或最后一位数字开始，向左和向右。如有必要，添加前导 0（或小数点右侧的尾随零）以填写最后一组三个。然后用等效的八进制数字替换每个三重奏。

例如，将二进制 1010111100 转换为八进制：（添加两个前导零，数字为 001010111100）001 = 1, 010 = 2, 111 = 7, 100 = 4 因此，1010111100 = 1274

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-16T20:47:14.387

要在八进制之间进行转换，您可以使用编码器和解码器对 ( [http://www.asic-world.com/digital/combo3.html](http://www.asic-world.com/digital/combo3.html) )。3 位加法器可以通过链接 3 个 FA 来实现。

# prolog - 关于prolog中min_of_list的两种实现

> ID：10489278
> 
> 赞同：0
> 
> 时间：2012-05-07T21:17:12.410
> 
> 标签：prolog

有人可以清楚地解释为什么 min_of_list 的这种实现（来自 SO 3965054）在序言中起作用：

```
% via: http://stackoverflow.com/questions/3965054/prolog-find-minimum-in-a-list
min_of_list_1( [H], H).
min_of_list_1([H,K|T],M) :- H =< K, min_of_list_1([H|T],M). 
min_of_list_1([H,K|T],M) :- H > K,  min_of_list_1([K|T],M). 
```

虽然此实现会生成不正确的输出：

```
min_of_list_2( [H], H).
min_of_list_2( [H| T], X) :- compare(<, X, H), min_of_list_2(T, X).
min_of_list_2( [H| T], H) :- compare(>, X, H), min_of_list_2(T, X).
min_of_list_2( [H| T], H) :- compare(=, X, H), min_of_list_2(T, H). 
```

结语。这行得通。

```
min_of_list_3( [H], H).
min_of_list_3( [H| T], X) :- min_of_list_3(T, X), compare(<, X, H).
min_of_list_3( [H| T], H) :- min_of_list_3(T, X), compare(>, X, H).
min_of_list_3( [H| T], H) :- min_of_list_3(T, X), compare(=, X, H). 
```

?

我得到的行为是 min_of_list_2 返回列表中的最后一个元素。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:52:22.713

min_of_list_2/2 的第一个子句是可以的，它表示具有单个元素的列表的最小值是该元素。第二个子句不太好：意图似乎是说如果 X 是列表 T 的最小值，并且 X 小于 H，那么 X 也是列表 [H|T] 的最小值，这将如果 compare/3 表现得像一个真正的关系，则按预期工作，但不幸的是它没有：

```
?- compare(<, a, b).
true. 
```

然而，**更一般**的查询失败了，就好像没有解决方案一样（尽管我们知道至少有一个！）：

```
?- compare(<, a, X).
false. 
```

由于 min_of_list_2/2 的一种典型用法（包括例如在第三个子句中的使用）使第二个参数未实例化，因此您将遇到此问题。如果您在 min_of_list_2/2 的相应递归调用**之后**发出 compare/3 的所有调用，您的代码将按预期工作。因此，与您发布的其他程序相比，您的谓词不再是尾递归的。应该删除最后一个子句中的 compare/3 调用（在这种情况下 X 是什么？），因为它总是会失败！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:39:30.583

第一个比较列表的前两个元素，然后将 min 再次放入列表中，直到只有一个元素。

第二个...获取列表的头部并与 X 进行比较。X 在第一次调用中未实例化，因此 compare(<,X,_any_number) 将为真。X 不会被实例化，所以同样会重复，直到列表中只有一个元素将被返回*（最后一个）。

'* where returned = 与第二个参数统一。

# php - 不同的 基于 Wordpress 中的类别或标签的类

> ID：10489288
> 
> 赞同：1
> 
> 时间：2012-05-07T21:17:56.497
> 
> 标签：php, html, css, wordpress

我的目标是在列表中包含与列表项的标记或分类方式相对应的操作图标。

例如，如果我有一个网络研讨会列表项，它旁边应该有一个网络研讨会图标，列表中的下一个项目可能是白皮书，旁边应该有一个白皮书图标。图标的数量应由列表项的标记或分类方式控制。

我不知道从哪里开始；任何建议表示赞赏。谢谢！

**编辑：**

认为如果我显示要修改的列表可能会有所帮助-从技术上讲，我要修改的项目位于**span class=meta"**部分，但我愿意使用任何方法：

```
 <ul class="sub_nav">
    <li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active last">
        <a href="#resource_center" title="Resources II">
            Featured Resources
        </a>
    </li>
   </ul>

    <div id="resource_center">
    <?php
    $resources = get_posts("post_type=resource&posts_per_page=2&cat=31&tag=featured");
    ?>
    <?php foreach ($resources as $key => $resource): setup_postdata($resource); ?>
        <?php if ($key === 0): ?>

        <?php endif ?>

        <p><span class="meta"><?php echo apply_filters('get_the_date',mysql2date('m.d.Y', $resource->post_date), 'm.d.Y') ?></span> 
        <a href="<?php echo get_permalink($resource->ID) ?>"><?php echo $resource->post_title ?></a> &ndash; <?php echo strip_tags(get_the_excerpt()) ?></p>

    <?php endforeach; ?>

    <span class="more"><a href="/resources/">Read More</a></span>

</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:26:33.507

只需在它们对应的标签之后命名所有图标并将它们放在服务器上的同一文件夹中（比如说[http://www.yoursite.com/tagicons](http://www.yoursite.com/tagicons)）

在您的循环中，只需在图像标签中迭代元标签

```
<img src="http://www.yoursite.com/tagicons/{$tag}.png" /> 
```

如果您需要更多帮助，请粘贴您用于迭代列表项的代码。

干杯-D

编辑：

我知道你正在使用 wordpress。

请参阅[http://codex.wordpress.org/Function_Reference/wp_get_post_tags](http://codex.wordpress.org/Function_Reference/wp_get_post_tags) 以了解如何获取您正在寻找的标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:31:19.727

如果您在 WordPress 循环中生成列表，则可以将类别作为类添加到列表元素中。例如：

```
...loop started
$categories = get_the_category();
$ids = '';
foreach ($categories as $category) {
    $ids .= ' ' . $category->slug;
}
echo '<li class="' .  $ids '">This item</li>';
...more loop 
```

然后利用 CSS 来设置列表块的样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T20:09:00.333

虽然我认为这两种解决方案都行得通，但我决定使用我在研究满足我的用例的选项时发现的第三种解决方案。这个是理想的，因为我能够将它无缝地融入我现有的代码结构中，并且因为我需要添加特色图像的资源数量相对较少。

我添加了下面的代码，它基本上使用帖子的特色图像作为左对齐缩略图。

```
 <?php if ( has_post_thumbnail()): ?>

        <?php
        $thumb_id = get_post_thumbnail_id($resource->id);
        $args = array(
        'p' => $thumb_id,
        'post_type' => 'attachment'
        );
        $thumb_image = get_posts($args);
        $thumb_caption = $thumb_image->post_excerpt;
        ?>
        <?php if (!empty($thumb_caption)): ?>
    <div class="caption"><?php echo $thumb_caption ?></div>
        <?php endif ?>

        <?php the_post_thumbnail('sidebar-thumb'); ?>

<?php endif; ?> 
```

紧随其后的是这段代码截取图像并将其放在列表项中：

```
<?php echo get_the_post_thumbnail($id, 'thumbnail', array()); ?> 
```

这是我添加代码后我的测试站点列表部分的屏幕截图 - 这正是我想要的：

![在此处输入图像描述](../Images/e21e02f1c4262a2cb2c86639c3445aeb.png)

感谢您的建议和帮助，它让我朝着正确的方向前进！

# wordpress - 在 Wordpress 中创建两个单独的部分

> ID：10489290
> 
> 赞同：1
> 
> 时间：2012-05-07T21:18:03.390
> 
> 标签：wordpress

我正在尝试在 wordpress 中创建两个单独的部分。每个部分都有自己的 URL。例如：

对于第 1 节：

```
http://domain/section-1/page1/
http://domain/section-1/page2/
....
http://domain/section-1/pageX/ 
```

对于第 2 节：

```
http://domain/section-2/page1/
http://domain/section-2/page2/
....
http://domain/section-2/pageX/ 
```

模板也会有所不同，页面也会有所不同。

如何用 wordpress 处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:21:27.400

听起来您正在寻找 WordPress 多站点模式：

[http://codex.wordpress.org/Create_A_Network](http://codex.wordpress.org/Create_A_Network)

# javascript - 客户端存储大量数据的Web应用程序

> ID：10489291
> 
> 赞同：2
> 
> 时间：2012-05-07T21:18:11.000
> 
> 标签：javascript, ajax, database, web-applications

Web 应用程序如何在客户端存储大量数据？（我具体谈论的是允许数百万条记录的容量）。我在这里要做的是允许离线研究这些记录。所有用户都在使用 Chrome。

我一直选择 indexedDb，直到我读到大约 40 万条记录，它几乎无法使用。然后是 Web SQL，但它已被弃用。

然后我在想我的最后一个选择是在本地安装一个像 apache 这样的 Web 服务器，它带有小脚本，它可以与我的 Web 应用程序交互并将记录存储在像 MySQL 这样的数据库中。使用 AJAX，我可以在 localhost 中访问我的脚本，但是会出现跨域问题。

我没有主意了

**更新**：澄清->

主 Web 应用程序在远程服务器上运行。它必须在服务器上，因为该应用程序由不同位置的几个人使用（它是共享的），并且需要通过智能手机等访问。最后一个想法是在本地安装一个 Web 应用程序（在所有用户的计算机），它将与该远程 Web 应用程序交互以从中获取记录并将它们存储在本地。无论如何，由于我猜的跨域问题，它不会起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:22:26.993

我看到几个选择：

1.  你真的不需要桌面应用程序吗？我知道，我知道那是1990年代...

2.  安装本地 Web 服务器并通过 Web 浏览器访问您的应用程序也是一种选择。但这很危险地接近第 1 点。

3.  您可能会考虑开发一个 Java[小程序](/questions/tagged/applet "显示标记为“小程序”的问题")并允许它使用文件系统

# javascript - jQuery导航菜单

> ID：10489295
> 
> 赞同：1
> 
> 时间：2012-05-07T21:19:02.513
> 
> 标签：javascript, jquery, html

上面的代码不能正常工作。我需要使用 Jquery 实现一个带有子菜单项的简单菜单。当我打开网页时，我看到所有菜单和子菜单的内容都在一起（就像一个堆栈）。我需要改进下面显示的 JavaScript，以便将内容正确分配给菜单项。所以，当我点击“menu2”时，应该有DIV id =“menu2”的内容。现在我在一页上看到所有内容。

```
<!-- Start css3menu.com BODY section -->
<ul id="css3menu1">
<li class="topfirst"><a class="pressed" href="#menu1" style="height:40px;line-height:40px;"><span>menu1</span></a>
<ul class = "menu">
<li><a href="#submenu11">submenu11</a></li>
<li><a href="#submenu12">submenu12</a></li>
<li><a href="#submenu13">submenu13</a></li>
<li><a href="#submenu14">submenu14</a></li>
</ul></li>
<li class="menu"><a href="#menu2" style="height:40px;line-height:40px;">menu2</a></li>
<li class="menu"><a href="#menu3" style="height:40px;line-height:40px;">menu3</a></li>
<li class="toplast"><a href="#menu4" style="height:40px;line-height:40px;">menu4</a></li>
</ul>
<!-- End css3menu.com BODY section -->

<script>
$('ul.menu').each(function() {
var $active, $content, $links = $(this).find('a');
$active = $links.first().addClass('active');
$content = $($active.attr('href'));
$links.not(':first').each(function() {
$($(this).attr('href')).hide();
});

$(this).on('click', 'a', function(e) {
$active.removeClass('active');
$content.hide();
$active = $(this);
$content = $($(this).attr('href'));
$active.addClass('active');
$content.show();
e.preventDefault();
});
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:26:14.900

这条线有问题

```
$content = $($active.attr('href')); 
```

没有具有该 ID 的项目...（$content 长度为 0）

例如

1.  你按下一个链接`href="#menu1"`
2.  `$active.attr('href')`等于`#menu1`
3.  这转化为`$content = $("#menu1");`
4.  页面上没有 ID 为“menu1”的元素

在 jQuery 中，带有井号 (#) 的选择器意味着 - 在井号之后找到带有 id 的元素

所以`#menu1`意思相同（几乎）`document.getElementById("menu1")`

但是没有具有该 ID 的元素（或任何等于 href 值的 id）

这可能不是最后一个问题，但这是尝试使其发挥作用的下一站......

见[jsFiddle](http://jsfiddle.net/FwDKs/3/)

# paypal - 使用 paypal api 进行交易操作

> ID：10489296
> 
> 赞同：1
> 
> 时间：2012-05-07T21:19:09.757
> 
> 标签：paypal

我正在向我们的网站添加付款。我想要一种方法来更新我的数据库并在交易中通过 paypal api 捕获付款。有谁知道是否有任何方法可以做到这一点？也许是贝宝回调？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:31:22.163

进行捕获，然后更新数据库。几分钟后，您将收到一条 IPN 消息，其中包含有关捕获的详细信息，您可以使用它来检查数据库是否已更新。但不要只依赖 IPN，根据我的经验，我可以说它不是 100% 可靠的。有时会发生我没有收到某些 IPN 的情况，或者它们被延迟了几个小时。

# multithreading - Redis 是单线程的，那么它是如何进行并发 I/O 的呢？

> ID：10489298
> 
> 赞同：213
> 
> 时间：2012-05-07T21:19:16.430
> 
> 标签：multithreading, redis

试图掌握 Redis 的一些基础知识时，我偶然发现了一篇有趣的[博客文章](http://blog.kennejima.com/post/1226487020/thoughts-on-redis#)。

作者指出：

> Redis 是带有 epoll/kqueue 的单线程，并且在 I/O 并发方面可以无限​​扩展。

我肯定误解了整个线程的事情，因为我觉得这个说法令人费解。如果一个程序是单线程的，它如何同时做任何事情？如果服务器无论如何都是单线程的，为什么 Redis 操作是原子的如此之好？

有人可以解释一下这个问题吗？

* * *

## 回答 #1

> 赞同：413
> 
> 时间：2012-05-08T08:51:51.943

好吧，这取决于您如何定义并发。

在服务器端软件中，并发和并行通常被认为是不同的概念。在服务器中，支持并发 I/O 意味着服务器能够通过执行与这些客户端相对应的多个流程来为多个客户端提供服务，而这些客户端只有一个计算单元。在这种情况下，并行性意味着服务器能够同时执行几件事（使用多个计算单元），这是不同的。

例如，调酒师可以照顾几位顾客，而他一次只能准备一种饮料。所以他可以在没有并行的情况下提供并发。

这个问题已经在这里进行了辩论： [并发和并行之间有什么区别？](https://stackoverflow.com/questions/1050222/concurrency-vs-parallelism-what-is-the-difference)

另请参阅Rob Pike 的[此演示文稿](https://talks.golang.org/2012/waza.slide#1)。

通过使用 I/O (de)multiplexing 机制和事件循环（Redis 就是这样做的），单线程程序绝对可以在 I/O 级别提供并发性。

并行性是有代价的：使用现代硬件上可以找到的多个插槽/多个内核，线程之间的同步非常昂贵。另一方面，像 Redis 这样的高效存储引擎的瓶颈通常是网络，远在 CPU 之前。因此，隔离的事件循环（不需要同步）被视为构建高效、可扩展的服务器的好设计。

Redis 操作是原子的这一事实仅仅是单线程事件循环的结果。有趣的一点是原子性是免费提供的（它不需要同步）。用户可以利用它来实现乐观锁定和其他模式，而无需支付同步开销。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-05-07T21:34:27.970

好的，Redis 在用户级别是单线程的，OTOH，内核线程池和/或拆分级别驱动程序支持所有异步 I/O。

对某些人来说， “**并发**”包括将网络事件分发到套接字状态机。它是单线程的，在一个核心上运行（在用户级别），所以我不会将其称为并发。其他的不一样。。

'**在 I/O 并发方面无限扩展**'实际上是经济实惠的。如果他们说“可以比每个客户端一个线程更好地扩展，前提是客户要求不高”，他们可能会更有信心，尽管他们可能会觉得有必要添加“其他异步解决方案的繁重负载”在用户级别使用所有核心'。

# c# - 将长字符串包装成 datagridview 列中的多行

> ID：10489304
> 
> 赞同：0
> 
> 时间：2012-05-07T21:19:49.877
> 
> 标签：c#, .net, winforms, data-binding, datagridview

我在数据库（MS SQL）表中有一个很长的字符串，例如

```
'99024','99050','99070','99143','99173','99191','99201','99202','99203','99204','99211','99212','99213','99214','99215','99217','99218','99219','99221','99222','99231','99232','99238','99239','99356','99357','99371','99374','99381','99382','99383','99384','99385','99386','99391','99392' 
```

现在它显示为 Windows 窗体应用程序的数据网格视图。 ![图 1](../Images/43adcc4036adad42a072b1a601c6a16a.png)

我所期望的可能是（忽略标题，没关系）。 ![图 2](../Images/8097360f2faa1ab553fbd1a91fe06601.png)

这意味着将一个长字符串拆分为许多短字符串。每个字符串占一行。最初通过以下代码在 asp.net gridview 中做得很好：

```
<ItemTemplate>
    <div style="width: 75px; overflow: hidden; white-space: nowrap; word-wrap: break-word;">
         <asp:TextBox ID="TextBox1" runat="server" Wrap="true" TextMode="MultiLine" Text='<%# Eval("ICD9").ToString().Replace(",", Environment.NewLine.ToString())%>'
          Rows='<%# Eval("test").ToString().Split(new string[] { "," }, StringSplitOptions.None).Length %>'
             </asp:TextBox>
            </div>
            </ItemTemplate>
 <EditItemTemplate>
        <div style="width: 75px; overflow: hidden; white-space: nowrap; word-wrap: break-word;">
              <asp:TextBox ID="TextBox2" runat="server" Wrap="true" TextMode="MultiLine" Text='<%# Eval("ICD9").ToString().Replace(",", Environment.NewLine.ToString())%>
   '>
                       </asp:TextBox>
                            </div>
                        </EditItemTemplate> 
```

现在我想在windows窗体DataGridView中使用它，我不知道如何编辑列来自定义项目。但我只是认为它们可能是相似的。

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:18:43.463

在 Windows 应用程序中，首先您需要做的是更改 DataGridView RowStyle 以便它可以根据您的内容自动调整大小

```
dataGridView1.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.Fill;
dataGridView1.RowsDefaultCellStyle.WrapMode = DataGridViewTriState.True; 
```

然后用换行符替换逗号

```
Eval("test").ToString().Replace(",", System.Environment.NewLine); 
```

# android - 如何在 Android Surfaceview 上拖动多个位图

> ID：10489308
> 
> 赞同：2
> 
> 时间：2012-05-07T21:20:03.697
> 
> 标签：android, surfaceview

我正在使用 SurfaceView 并在视图中绘制了多个位图。我的问题是**如何使用*Touch Listener*独立定位每个位图移动操作？**

基本上我希望用户能够以他们喜欢的任何顺序排列位图。我想出了一种方法来确定每个位图在 SurfaceView 上使用的空间，然后检查触摸侦听器的 x 和 y 值以确定用户是否选择了位图的已知位置。我遇到的问题是，如果位图最终相互交叉，那么它们会粘在一起，因为它们共享相同的空间。

我在想可能有一种更简单的方法来处理多个位图的事件，有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T11:07:59.363

首先，您需要选择位图，点击链接了解更多详细信息。 [检测位图上的触摸](https://stackoverflow.com/questions/2447564/detect-touch-on-bitmap)

# maven - Maven网络问题？

> ID：10489309
> 
> 赞同：4
> 
> 时间：2012-05-07T21:20:11.467
> 
> 标签：maven, maven-2, maven-3, m2eclipse, maven-eclipse-plugin

问题是： Nexus-maven-repository-index.zip 下载速度为 10kbps 和 maven eclipse:eclipse artifact 下载停止/​​暂停。我不支持任何代理。

**编辑：**这是由**AVG Link Scanner**引起的，与 Maven 中的问题相同， [无法下载 jar 依赖项](https://stackoverflow.com/questions/7074040/maven-failing-to-download-jar-dependencies)

我想我的 Maven 安装/网络连接有一些严重的问题。

*这是我所做的和我得到的：*

1.  我一直在尝试使用 m2eclipse，但在*超时*一段时间后通过 eclipse**下载文件** [http://mirrors.ibiblio.org/pub/mirrors/maven2/dot-index/nexus-maven-repository-index.zip](http://mirrors.ibiblio.org/pub/mirrors/maven2/dot-index/nexus-maven-repository-index.zip) . 我试图通过 wget 获取文件，我看到的是下载**速度是 11kbps**。这是某种政策吗？在这个 11kbps 上看起来相当稳定。一个星期以来我的速度如此惊人，所以这不是暂时的问题。如果这是每个人的政策和正常速度 - 很好。我不会使用 m2eclipse，没问题。

****   我已经放弃使用 m2eclipse，我正在使用 maven-eclipse-plugin。不，等等——我不是。这是我调用 mvn eclipse:eclipse 时发生的情况：

    *   工件**下载会在一段时间后随机挂起**。然后我点击 ^C，再次运行命令，下载恢复，然后再次挂起，有时在同一个工件上，有时我会更进一步。我在调试模式下运行 mvn ，它总是挂在同一个地方，下面的堆栈跟踪。与英国回购相同。*** 

 ***这是怎么回事？感谢您的帮助，我完全迷路了。我假设我的互联网连接一团糟，但它工作得非常好（除了 maven）。我觉得被 maven repo 屏蔽了。

有任何想法吗？

重要细节如下：

*这是我运行 maven 的方式*（任何线程数都会发生相同的情况）

`mvnDebug eclipse:eclipse -DdownloadSources=true -Dmaven.artifact.threads=1`

*这是我的 maven 版本*（最新的 maven 2 版本也是如此）：

```
$ mvn --version
Apache Maven 3.0.4 (r1232337; 2012-01-17 09:44:56+0100)
Maven home: C:\apache-maven-3.0.4
Java version: 1.7.0_04, vendor: Oracle Corporation
Java home: C:\Program Files\Java\jdk1.7.0_04\jre
Default locale: pl_PL, platform encoding: Cp1250
OS name: "windows vista", version: "6.0", arch: "x86", family: "windows" 
```

*这是 maven eclipse:eclipse 挂起的堆栈跟踪*（看起来像网络问题，但为什么？）：

```
java.net.SocketInputStream.socketRead0(java.io.FileDescriptor, byte[], int, int, int) line: not available [native method]   
java.net.SocketInputStream.read(byte[], int, int, int) line: 150    
java.net.SocketInputStream.read(byte[], int, int) line: 121 
org.apache.maven.wagon.providers.http.httpclient.impl.io.SocketInputBuffer(org.apache.maven.wagon.providers.http.httpclient.impl.io.AbstractSessionInputBuffer).fillBuffer() line: 149  
org.apache.maven.wagon.providers.http.httpclient.impl.io.SocketInputBuffer.fillBuffer() line: 110   
org.apache.maven.wagon.providers.http.httpclient.impl.io.SocketInputBuffer(org.apache.maven.wagon.providers.http.httpclient.impl.io.AbstractSessionInputBuffer).read(byte[], int, int) line: 195    
org.apache.maven.wagon.providers.http.httpclient.impl.io.ChunkedInputStream.read(byte[], int, int) line: 173    
org.apache.maven.wagon.providers.http.httpclient.conn.EofSensorInputStream.read(byte[], int, int) line: 138 
java.util.zip.GZIPInputStream(java.util.zip.InflaterInputStream).fill() line: 238   
java.util.zip.GZIPInputStream(java.util.zip.InflaterInputStream).read(byte[], int, int) line: 158   
java.util.zip.GZIPInputStream.read(byte[], int, int) line: 116  
org.apache.maven.wagon.providers.http.HttpWagon(org.apache.maven.wagon.AbstractWagon).transfer(org.apache.maven.wagon.resource.Resource, java.io.InputStream, java.io.OutputStream, int, int) line: 493 
org.apache.maven.wagon.providers.http.HttpWagon(org.apache.maven.wagon.AbstractWagon).getTransfer(org.apache.maven.wagon.resource.Resource, java.io.OutputStream, java.io.InputStream, boolean, int) line: 339  
org.apache.maven.wagon.providers.http.HttpWagon(org.apache.maven.wagon.AbstractWagon).getTransfer(org.apache.maven.wagon.resource.Resource, java.io.File, java.io.InputStream, boolean, int) line: 310  
org.apache.maven.wagon.providers.http.HttpWagon(org.apache.maven.wagon.AbstractWagon).getTransfer(org.apache.maven.wagon.resource.Resource, java.io.File, java.io.InputStream) line: 287    
org.apache.maven.wagon.providers.http.HttpWagon(org.apache.maven.wagon.StreamWagon).getIfNewer(java.lang.String, java.io.File, long) line: 97   
org.apache.maven.wagon.providers.http.HttpWagon(org.apache.maven.wagon.StreamWagon).get(java.lang.String, java.io.File) line: 61    
org.sonatype.aether.connector.wagon.WagonRepositoryConnector$GetTask<T>.run() line: 601 
org.sonatype.aether.util.concurrency.RunnableErrorForwarder$1.run() line: 60    
org.sonatype.aether.connector.wagon.WagonRepositoryConnector$1.execute(java.lang.Runnable) line: 192    
org.sonatype.aether.connector.wagon.WagonRepositoryConnector.get(java.util.Collection<? extends org.sonatype.aether.spi.connector.ArtifactDownload>, java.util.Collection<? extends org.sonatype.aether.spi.connector.MetadataDownload>) line: 445  
org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolve(org.sonatype.aether.RepositorySystemSession, java.util.Collection<? extends org.sonatype.aether.resolution.ArtifactRequest>) line: 457    
org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolveArtifacts(org.sonatype.aether.RepositorySystemSession, java.util.Collection<? extends org.sonatype.aether.resolution.ArtifactRequest>) line: 216   
org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolveArtifact(org.sonatype.aether.RepositorySystemSession, org.sonatype.aether.resolution.ArtifactRequest) line: 193    
org.sonatype.aether.impl.internal.DefaultRepositorySystem.resolveArtifact(org.sonatype.aether.RepositorySystemSession, org.sonatype.aether.resolution.ArtifactRequest) line: 286    
org.apache.maven.artifact.resolver.DefaultArtifactResolver.resolve(org.apache.maven.artifact.Artifact, java.util.List<org.apache.maven.artifact.repository.ArtifactRepository>, org.sonatype.aether.RepositorySystemSession) line: 213  
org.apache.maven.artifact.resolver.DefaultArtifactResolver.resolve(org.apache.maven.artifact.Artifact, java.util.List<org.apache.maven.artifact.repository.ArtifactRepository>, org.apache.maven.artifact.repository.ArtifactRepository, org.apache.maven.wagon.events.TransferListener) line: 157  
org.apache.maven.artifact.resolver.DefaultArtifactResolver.resolve(org.apache.maven.artifact.Artifact, java.util.List<org.apache.maven.artifact.repository.ArtifactRepository>, org.apache.maven.artifact.repository.ArtifactRepository) line: 525  
org.apache.maven.plugin.ide.IdeUtils.resolveArtifact(org.apache.maven.artifact.resolver.ArtifactResolver, org.apache.maven.artifact.Artifact, java.util.List, org.apache.maven.artifact.repository.ArtifactRepository, org.apache.maven.plugin.logging.Log) line: 442   
org.apache.maven.plugin.eclipse.EclipsePlugin(org.apache.maven.plugin.ide.AbstractIdeSupportMojo).resolveDependenciesWithClassifier(org.apache.maven.plugin.ide.IdeDependency[], java.lang.String, boolean) line: 990   
org.apache.maven.plugin.eclipse.EclipsePlugin(org.apache.maven.plugin.ide.AbstractIdeSupportMojo).resolveSourceAndJavadocArtifacts(org.apache.maven.plugin.ide.IdeDependency[]) line: 918   
org.apache.maven.plugin.eclipse.EclipsePlugin(org.apache.maven.plugin.ide.AbstractIdeSupportMojo).execute() line: 509   
org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(org.apache.maven.execution.MavenSession, org.apache.maven.plugin.MojoExecution) line: 101 
org.apache.maven.lifecycle.internal.MojoExecutor.execute(org.apache.maven.execution.MavenSession, org.apache.maven.plugin.MojoExecution, org.apache.maven.lifecycle.internal.ProjectIndex, org.apache.maven.lifecycle.internal.DependencyContext) line: 209 
org.apache.maven.lifecycle.internal.MojoExecutor.execute(org.apache.maven.execution.MavenSession, org.apache.maven.plugin.MojoExecution, org.apache.maven.lifecycle.internal.ProjectIndex, org.apache.maven.lifecycle.internal.DependencyContext, org.apache.maven.lifecycle.internal.PhaseRecorder) line: 153  
org.apache.maven.lifecycle.internal.MojoExecutor.execute(org.apache.maven.execution.MavenSession, java.util.List<org.apache.maven.plugin.MojoExecution>, org.apache.maven.lifecycle.internal.ProjectIndex) line: 145    
org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(org.apache.maven.execution.MavenSession, org.apache.maven.execution.MavenSession, org.apache.maven.lifecycle.internal.ReactorContext, org.apache.maven.project.MavenProject, org.apache.maven.lifecycle.internal.TaskSegment) line: 84  
org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(org.apache.maven.execution.MavenSession, org.apache.maven.lifecycle.internal.ReactorContext, org.apache.maven.project.MavenProject, org.apache.maven.lifecycle.internal.TaskSegment) line: 59   
org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(org.apache.maven.execution.MavenSession, org.apache.maven.lifecycle.internal.ReactorContext, org.apache.maven.lifecycle.internal.ProjectBuildList, java.util.List<org.apache.maven.lifecycle.internal.TaskSegment>, org.apache.maven.lifecycle.internal.ReactorBuildStatus) line: 183  
org.apache.maven.lifecycle.internal.LifecycleStarter.execute(org.apache.maven.execution.MavenSession) line: 161 
org.apache.maven.DefaultMaven.doExecute(org.apache.maven.execution.MavenExecutionRequest) line: 320 
org.apache.maven.DefaultMaven.execute(org.apache.maven.execution.MavenExecutionRequest) line: 156   
org.apache.maven.cli.MavenCli.execute(org.apache.maven.cli.MavenCli$CliRequest) line: 537   
org.apache.maven.cli.MavenCli.doMain(org.apache.maven.cli.MavenCli$CliRequest) line: 196    
org.apache.maven.cli.MavenCli.main(java.lang.String[], org.codehaus.plexus.classworlds.ClassWorld) line: 141    
sun.reflect.NativeMethodAccessorImpl.invoke0(java.lang.reflect.Method, java.lang.Object, java.lang.Object[]) line: not available [native method]    
sun.reflect.NativeMethodAccessorImpl.invoke(java.lang.Object, java.lang.Object[]) line: 57  
sun.reflect.DelegatingMethodAccessorImpl.invoke(java.lang.Object, java.lang.Object[]) line: 43  
java.lang.reflect.Method.invoke(java.lang.Object, java.lang.Object...) line: 601    
org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(java.lang.String[]) line: 290  
org.codehaus.plexus.classworlds.launcher.Launcher.launch(java.lang.String[]) line: 230  
org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(java.lang.String[]) line: 409    
org.codehaus.plexus.classworlds.launcher.Launcher.main(java.lang.String[]) line: 352 
```

感谢您的任何提示。

内核

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:50:03.273

两条快速建议：

*   不要使用 ibiblio，规范的 Maven 存储库是[http://repo1.maven.org/maven2](http://repo1.maven.org/maven2) - 它由 Sonatype 维护，现在由全球 CDN 提供服务。您不应该在下载索引时遇到任何速度问题。

*   考虑在您和公共存储库之间放置一个存储库管理器。您经常会发现性能会因此而提高……非常显着。

不要费心用 wget 下载，它对你没有帮助。事实上，您可能会看到下载时间变慢，因为您正在尝试使用 wget。我最强烈的建议是使用存储库管理器：Nexus 或 Artifactory。***

# jquery - 有没有办法在从文本输入元素中单击存储值的列表后执行脚本

> ID：10489310
> 
> 赞同：-1
> 
> 时间：2012-05-07T21:20:12.487
> 
> 标签：jquery, html

我想执行一个 jquery 脚本，在有人从元素中`<label for='username'>`从浏览器给出的存储输入值（当 autocomplete='on' 时给出的值）中选择一个条目后，该脚本将淡出。`<input name='username' type='text'>`

有什么方法可以检查用户是否从存储的输入值中选择了一个选项？

..当我检查文本输入是否为空时，每当用户按下键或鼠标按钮时，我已经想到了一个丑陋的解决方案，但我想要一个更好的解决方案

**更新：** 我发现我想到的解决方案实际上不起作用——但无论如何这里是伪代码：

```
$(document).ready(function(){
mouseup(function(){
  if(!isWhitespace($("#username")){
   //blur the label
  }
 //same function for keyup() 
  function isWhitespace(elem){
           $elemCont = elem.val().replace(/^\s+/, '').replace(/\s+$/, '');
                            if ($elemCont === '') {
                                // element contained all whitespace
                                elem.val('');
                                return true;
                            }else{
                                // element has real content
                                elem.val($elemCont); //free element of leading/trailing whitespace  
                                return false; 
                            }
       }
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T17:36:55.720

我想出了如何以一种半好的方式做到这一点。因为出现的存储输入值列表不是其中的一部分，`$(document)`并且我找不到元素的名称（我认为它没有名称，您可以将其关闭`autocoplete="off"`）它具有挑战性但可能。我只是做了一个函数，每次你将鼠标悬停在文档上时都会执行

```
$(document).hover(function() {

if(!isWhitespace($("#inputId")){
//blur label
}

},function(){}); 
```

即使您将鼠标移出浏览器并使用键盘从储值列表中选择一个项目，这仍然有效。

如果有人找到更好的解决方案，请随时回复

# iphone - 收集接触点

> ID：10489313
> 
> 赞同：-1
> 
> 时间：2012-05-07T21:20:20.500
> 
> 标签：iphone, objective-c, ios, cocoa-touch

据我所知，没有公共 API 可以以采样率收集接触点/位置。有谁知道任何解决方法来做到这一点？非常感谢您的任何想法和建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:26:55.630

[UITouch](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITouch_Class/Reference/Reference.html)不是您想要的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:11:07.343

尝试使用 NSTimer：

```
NSTimer* myTimer = [NSTimer scheduledTimerWithTimeInterval:1.0/TIMES_PER_SECOND target:self selector:@selector(sampleTouches:) userInfo:nil repeats:YES]; 
```

然后，实现回调函数：

```
-(void)sampleTouches:(NSTimer*)timer {
    // Call a method/function here that gets UITouch data.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T16:15:36.643

事实证明，以采样率记录接触点不会使记录更快或更准确。触摸方法是要走的路。通过实现 touchesBegan、touchesMoved、touchesEnd 方法，我能够尽可能快地记录提供给视图的触摸点。

# ruby-on-rails-3 - 如何在此文件中使用“Form_tag”而不是“Form_for”

> ID：10489314
> 
> 赞同：29
> 
> 时间：2012-05-07T21:20:30.533
> 
> 标签：ruby-on-rails-3

我是 Ruby on Rails 的新手，Michael Hartl 的优秀书籍《Ruby on Rails 教程》给了我极大的帮助。我已经读到了第 8 章，现在正在学习该章的练习。我在练习 1 中遇到了（我假设是一个典型的“新手”）问题。在本练习中，要求“1.重构登录表单以使用 form_tag 代替 form_for”。我已经尝试在 Stackoverflow、Google、Railscast 和许多其他“网络搜索”中搜索这两天的帮助，但我似乎没有找到回答这个问题所需的帮助。我试图用 form_tag 修改的文件如下：

```
<% provide(:title, "Sign in") %>
<h1>Sign in</h1>

<div class="row">
  <div class="span6 offset3">
    <%= form_for(:session, url: sessions_path) do |f| %>

      <%= f.label :email %>
      <%= f.text_field :email %>

      <%= f.label :password %>
      <%= f.password_field :password %>

      <%= f.submit "Sign in", class: "btn btn-large btn-primary" %>
     <% end %>

    <p>New user? <%= link_to "Sign up now!", signup_path %></p>
  </div>
</div> 
```

我在这个应用程序中使用 Rails 3.2.3。有人能指出我正确的方向吗？谁能帮我解决这个问题？我将不胜感激。

这是使用 form_tag 的实现：

```
<% provide(:title, "Sign in") %>
<h1>Sign in</h1>

<div class="row">
  <div class="span6 offset3">
    <%= form_tag( url: sessions_path ) do  %>

      <%= label_tag :email %>
      <%= text_field_tag :email %>

      <%= label_tag :password %>
      <%= password_field_tag :password %>

      <%= submit_tag "Sign in", class: "btn btn-large btn-primary" %>
    <% end %>

    <p>New user? <%= link_to "Sign up now!", signup_path %></p>
  </div>
</div> 
```

我正在使用 Rspec 2.9.0，以下是失败的测试：

```
describe "signin page" do
    before { visit signin_path }

    it { should have_selector('h1',    text: 'Sign in') }
    it { should have_selector('title', text: 'Sign in') }
  end 
```

和

```
describe "with invalid information" do
            before { click_button "Sign in" }

            it { should have_selector('title', text: 'Sign in') }
            it { should have_selector('div.alert.alert-error', text: 'Invalid') }

            describe "after visiting another page" do
              before { click_link "Home" }
              it { should_not have_selector('div.alert.alert-error') }
            end
      end 
```

和

```
describe "with valid information" do
            let(:user) { FactoryGirl.create(:user) }
            before do
              fill_in "Email",    with: user.email
              fill_in "Password", with: user.password
              click_button "Sign in"
            end

            it { should have_selector('title', text: user.name) }
            it { should have_link('Profile', href: user_path(user)) }
            it { should have_link('Sign out', href: signout_path) }
            it { should_not have_link('Sign in', href: signin_path) }

            describe "followed by signout" do
                    before { click_link "Sign out" }
                    it { should have_link('Sign in') }
            end
      end 
```

这是我的路线文件：

```
SampleApp::Application.routes.draw do
  resources :users
  resources :sessions, only: [:new, :create, :destroy]

  get "users/new"

  root to: 'static_pages#home'

  match '/signup',  to: 'users#new'
  match '/signin',  to: 'sessions#new'
  match '/signout', to: 'sessions#destroy', via: :delete

  match '/help',    to: 'static_pages#help'
  match '/about',   to: 'static_pages#about'
  match '/contact', to: 'static_pages#contact'
end 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-13T12:57:08.817

我也刚刚完成了这个练习，所以我绝不是专家；但是，这是对我有用并通过了所有测试的代码：

../app/views/sessions/new.html.erb

```
<% provide(:title, "Sign in") %>
<h1>Sign in</h1>

<div class="row">
  <div class="span 6 offset 3">
    <%= form_tag sessions_path do %>

      <%= label_tag :email %>
      <%= text_field_tag :email, params[:email] %>

      <%= label_tag :password %>
      <%= password_field_tag :password %>

      <%= submit_tag "Sign in", class: "btn btn-large btn-primary" %>
    <% end %>

    <p>New User?<%= link_to "Sign Up Now", signup_path %> </p>
  </div>
</div> 
```

我还需要更改 ../app/controllers/sessions_contoller

```
class SessionsController < ApplicationController

  def new
  end

  def create
    user = User.find_by_email(params[:email])
    if user && user.authenticate(params[:password])
      session[:user] = user.id
      sign_in user
      redirect_to user
    else
      flash.now[:error] = 'Invalid email/password combination'
      render 'new'
    end  
  end

  def destroy
    sign_out
    redirect_to root_path
  end
end 
```

虽然这行得通，但我不完全确定它为什么会这样。如果有人可以解释为什么需要更改控制器，将不胜感激。我知道这可以作为一个单独的问题提出，但它与 OP 密切相关，我相信我们都会发现它不仅在理解如何让它工作而且为什么它以这种方式工作方面非常有用。以下是原始视图和控制器文件：

原始“form_for”new.html.erb：

```
<% provide(:title, "Sign in") %>
<h1>Sign in</h1>

<div class="row">
  <div class="span6 offset3">
    <%= form_for(:session, url: sessions_path) do |f| %>

      <%= f.label :email %>
      <%= f.text_field :email %>

      <%= f.label :password %>
      <%= f.password_field :password %>

      <%= f.submit "Sign in", class: "btn btn-large btn-primary" %>
    <% end %>

    <p>New user? <%= link_to "Sign up now!", signup_path %></p>
  </div>
</div> 
```

和原来的sessions_controller：

```
class SessionsController < ApplicationController

  def new
  end

  def create
    user = User.find_by_email(params[:session][:email])
    if user && user.authenticate(params[:session][:password])
      sign_in user
      redirect_to user
    else
      flash.now[:error] = 'Invalid email/password combination'
      render 'new'
    end  
  end

  def destroy
    sign_out
    redirect_to root_path
  end
end 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-22T15:23:34.333

我正在处理本教程的同一步骤，您的问题帮助我找到了自己的方式。

使用**label**和**text_field**代替 label_tag 和 text_field_tag 工作正常，您不必更改控制器代码（这会产生与原始 form_for 方法相同的 HTML 代码）。

```
<%= form_tag(sessions_path) do %>
  <%= label :session, :email %>
  <%= text_field :session, :email %>

  <%= label :session, :password %>
  <%= password_field :session, :password %>

  <%= submit_tag("Sign in", class: "btn btn-large btn-primary") %>
<% end %> 
```

[您可以在http://guides.rubyonrails.org/form_helpers.html#dealing-with-model-objects](http://guides.rubyonrails.org/form_helpers.html#dealing-with-model-objects)中阅读详细信息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T21:24:47.477

RoR 指南介绍了 form_tag 的工作原理。

[http://guides.rubyonrails.org/form_helpers.html](http://guides.rubyonrails.org/form_helpers.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-22T08:58:19.023

您有一个没有在您的实现中使用的 Session_Helper。

编辑您的辅助方法。

```
 def sign_in(user)
    cookies.permanent[:remember_token] = user.remember_token
    session[:user_id] = user.id
  end

  def sign_out
    cookies.delete(:remember_token)
    session[:user_id] = nil    
  end 
```

然后，您可以简单地在会话控制器中使用适当的方法。这是一个遵循模块化设计方法的更简洁的实现。rspec 似乎也存在问题。

```
describe "with valid information" do
      let(:user) { FactoryGirl.create(:user) }
      before do
        fill_in "Email",    with: user.email.upcase
        fill_in "Password", with: user.password
        click_button "Sign in"
      end

      it { should have_selector('title', text: user.name) }
      it { should have_link('Profile', href: user_path(user)) }
      it { should have_link('Sign out', href: signout_path) }
      it { should_not have_link('Sign in', href: signin_path) } 
```

即使当您访问页面时一切都正确，这些测试也会被标记。我的猜测是你需要改变`before do`，因为如果它正在做你想让它做的事情，测试就会通过。

无论如何，如果有人有想法，我很好奇 rspec 的问题是什么！

我认为这个问题与`user.email.upcase`. 您不需要`.upcase`，当您删除它时，测试将通过。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-12T03:38:44.113

我被抓到没有正确命名这些字段。当您查看原始来源时，它会显示命名方案。

```
<%= form_tag(sessions_path) do %>

  <%= label_tag 'session_email', 'Email' %>
  <%= text_field_tag 'session[email]' %>

  <%= label_tag 'session_password', 'Password' %>
  <%= password_field_tag 'session[password]' %>

  <%= submit_tag "Sign in", class: "btn btn-large btn-primary" %>
<% end -%> 
```

# asp.net - 如何使用填充文本框的列开发 GridView

> ID：10489315
> 
> 赞同：0
> 
> 时间：2012-05-07T21:20:30.390
> 
> 标签：asp.net, gridview, jqgrid, textbox

我在 jqQrid 中有 5 个字段的 GridView

```
<cc1:JQGrid ID="Qgrid" runat="server" Width="700px"  Height="100%"
            ondatarequesting="QgridDataRequesting" 
            onrowediting="QgridRowEditing">
         <Columns>
            <trirand:JQGridColumn Searchable="true" 
            SearchToolBarOperation="IsEqualTo" DataType="Int" 
            HeaderText="Order ID" PrimaryKey="True" ></trirand:JQGridColumn>
            <trirand:JQGridColumn DataField='id'   Visible="False"/>
            <trirand:JQGridColumn DataField='last_name'  Visible="False"/>
            <trirand:JQGridColumn DataField='first_name' Visible="False"/>
            <trirand:JQGridColumn DataField="opinion" Editable="True" />

        </Columns> 

        <EditInlineCellSettings Enabled="True" />
        <PagerSettings NoRowsMessage="No data in grid." />
        <ToolBarSettings ShowEditButton="true" ShowRefreshButton="True" />
</cc1:JQGrid> 
```

我为事件 gridDataRequesting 和 gridRowEditing 编写了逻辑，现在我的许可证已过期

我想写一个简单的gridview，但我不知道如何添加带有文本框的列。

离开文本框后，我想调用“函数网格 RowEditing”（它使用文本框中的值执行 sql 更新）

**你知道任何类似于 JqGrid 的免费插件吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T10:49:10.200

如果您指的是使用文本框编辑网格视图中的项目，那么您可以查看此[链接](http://msdn.microsoft.com/en-us/library/ms972948.aspx)。此处存在编辑链接，可帮助您在线编辑行。网格需要与 UpdateCommand 相关联。在您的情况下，将执行 sql 更新。gridRowEditing 的替代方法。

至于在gridview中填充数据，可以在aspx页面的页面加载事件中完成。jqGrid 中 gridDataRequesting 的一种可能替代方法。

# javascript - 如何删除主干模型客户端？

> ID：10489317
> 
> 赞同：13
> 
> 时间：2012-05-07T21:20:40.083
> 
> 标签：javascript, backbone.js

删除模型客户端的最佳方法是什么？我不需要担心在服务器端删除它。我如何确保它在任何地方都被删除，避免每一个陷阱，每一个僵尸绑定。我正在寻找删除和销毁所有内容并确保模型被垃圾收集的指南。

谢谢！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-08T07:27:06.363

这真的取决于这个模型里面有什么。如果它绑定到来自其他实例的事件 - View/Collection/Models，您应该手动删除这些事件侦听器，因为无法一次删除所有它们。

此外， Model.destroy() 从任何集合（主干文档）中删除模型：

> 销毁模型.destroy([options])
> 
> ...触发模型上的“销毁”事件，该事件将通过包含它的任何集合冒泡...

您可能想要做的事情是分配一个新的销毁方法，其中包括事件触发和您要删除的内容。

```
destroy: function(options) {
   // Any events you wish to switch off ( if you have any )
   SomeCollection.off('change', this.changeFn);

   Backbone.Model.prototype.destroy.apply(this, options);       
} 
```

也许您还应该了解一些从模型中减少垃圾的模式：

1.  不要将初始化模型放在变量中（将其保存在集合中）；
2.  确保以没有事件绑定到模型的方式编写代码（为此使用视图/集合）；
3.  保持模型代码简单，因为应用程序中的模型编号最多。

我认为通过遵循这些规则，您无需担心模型中的垃圾。

# jquery - 如何使用 jQuery 选择具有特定类的下一个表行？

> ID：10489322
> 
> 赞同：0
> 
> 时间：2012-05-07T21:21:13.213
> 
> 标签：jquery, next

我有一个表，其中包含具有不同类名的行。其中一些行具有相同的类名。我正在尝试选择包含特定类的下一个表行（使用 jQuery）。基本上，我正在尝试创建一个功能，用户可以使用箭头键选择表中的下一行。这是我正在使用的代码：

```
if (e.keyCode == 40)
{ 
   $('tr.background_color_grey').next("tr").addClass("background_color_grey");
   $('tr.background_color_grey:first').removeClass("background_color_grey");
   return false;
} 
```

问题是我需要跳过一些行（它们充当表中不同类别的标题）。那么，如果它具有特定的类，我如何选择表中的下一行？我想被选中的所有行都有“can_be_selected”类。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:23:36.100

在您使用`.next("tr")`

尝试`.next("tr.can_be_selected")`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:57:56.823

像这样**[的 jsFiddle 示例](http://jsfiddle.net/j08691/hYCpJ/)**怎么样？

该示例有一个包含一列和 10 行的表。`<td>`单元格是所选单元格具有类的所有元素`can_be_selected`。通过使用向上和向下箭头键，您可以仅突出显示具有该类`can_be_selected`的单元格，而忽略其他单元格。请注意，在示例中，我为具有类的单元格设置`can_be_selected`了绿色边框以使它们不同，但您可以轻松删除它。

这是使用相同代码的**[第二个 jsFiddle 示例](http://jsfiddle.net/j08691/xVEt6/)**，其中表格行已替换为表格单元格。

**jQuery**（对于第一个 jsFiddle 示例）：

```
var index = -1;
//38 up, 40down
$(document).keydown(function(e) {
    if (e.keyCode === 40) {
        index = (index + 1 >= $('td.can_be_selected').length) ? $('td.can_be_selected').length - 1 : index + 1;
        $('td.can_be_selected').removeClass('background_color_grey');
        $('td.can_be_selected:eq(' + index + ')').addClass('background_color_grey');
        return false;
    }
    if (e.keyCode === 38) {
        index = (index == 0) ? 0 : index - 1;
        $('td.can_be_selected').removeClass('background_color_grey');
        $('td.can_be_selected:eq(' + index + ')').addClass('background_color_grey');
        return false;
    }
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T21:28:37.770

一种选择是使用[`nextUntil`](http://api.jquery.com/nextUntil/)方法跳过所有“无用”行：

```
$("tr").eq($("tr.selected").nextUntil(".can_be_selected​​​​​​​​​​​").next().index()); 
```

**演示：http:** [//jsfiddle.net/y8Dqq/](http://jsfiddle.net/y8Dqq/)

# spring - 使用注入的 Spring Data JPA 返回“NoSuchMethodError”

> ID：10489327
> 
> 赞同：4
> 
> 时间：2012-05-07T21:21:35.573
> 
> 标签：spring, websphere, spring-data, spring-data-jpa

我正在使用 Spring-Data-JPA 1.0.3.RELEASE 来管理我的 ORM。

我的 persistence.xml 看起来像这样：

```
<persistence>
    <persistence-unit name="default" transaction-type="JTA">
        <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>
        <jta-data-source>jdbc/myDataSource</jta-data-source>
        <properties>
            <property name="openjpa.TransactionMode" value="managed" />
            <property name="openjpa.ConnectionFactoryMode" value="managed" />
            <property name="openjpa.jdbc.DBDictionary" value="db2" />
        </properties>
    </persistence-unit>
</persistence> 
```

applicationContext 看起来像这样

```
<beans>
<context:annotation-config />
<bean id="myExceptionTranslator" class="org.springframework.orm.jpa.DefaultJpaDialect" />

<bean id="myEmf" class="javax.persistence.Persistence" factory-method="createEntityManagerFactory">
        <constructor-arg type="java.lang.String" value="default" />
</bean>
    <jpa:repositories base-package="model.repositories" />
    <tx:annotation-driven transaction-manager="txManager" />
    <bean
        class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" />
</beans> 
```

我的 OrderRepo 界面如下所示：

```
@Transactional(readOnly = true)
public interface OrderRepository extends JpaRepository<Order, Long> {
//my stuff
} 
```

我在我的服务类中使用它

```
@Autowired
private OrderRepository repository; 
```

但看起来 websphere 不太喜欢它，并给了我这个错误：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'orderService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private model.repositories.OrderRepository model.service.OrderService.repository; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'orderRepository': FactoryBean threw exception on object creation; nested exception is java.lang.NoSuchMethodError: javax/persistence/EntityManager.getMetamodel()Ljavax/persistence/metamodel/Metamodel; 
```

我发现的关于这个问题的唯一资源指出了以前的 Spring-Data-JPA 版本中的错误，这些版本现在被标记为已修复，或者使用错误的依赖关系到 spring-data-commons jar 的错误 - 但是：我把它留给 maven 所以data-commons 版本应该没问题。我还发现 Spring Data JPA 需要 JPA 2.0 实现，所以我检查了 websphere 服务器上的 openJPA 版本，这很好。

有什么想法可能导致这种情况吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-07T21:36:47.533

如错误所示，javax.persistence.EntityManager 中没有方法 getMetaModel()。

检查 JPA 1.0 和 JPA 2.0 的源代码。

[实体管理器 JPA 2.0](http://dev.eclipse.org/svnroot/rt/org.eclipse.persistence/trunk/jpa/plugins/javax.persistence/src/javax/persistence/EntityManager.java)

[实体管理器 JPA 1.0](http://kickjava.com/src/javax/persistence/EntityManager.java.htm)

此方法仅存在于 2.0 版本中。在我看来，如果 1.0 版中没有 JPA jar，你应该仔细检查你的依赖项

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T09:05:25.643

我认为您需要将以下行放在 dispatcher-servlet.xml 文件中，而不是 applicationContext.xml 文件中。

```
<tx:annotation-driven transaction-manager="txManager" /> 
```

几天前我也遇到过类似的问题，而这一变化挽救了我的生命。:)

希望你的也能得救……干杯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T21:29:50.360

我发现的@Autowired 的示例似乎将它应用于一个 Bean - 这是一个具体的类。您正在将其应用于界面 - 对吗？

见：[教程](http://www.roseindia.net/tutorial/spring/spring3/ioc/springautowiremodeno.html)

# javascript - jQuery 的 after 方法不适用于新创建的元素

> ID：10489328
> 
> 赞同：13
> 
> 时间：2012-05-07T21:21:38.783
> 
> 标签：javascript, jquery, jquery-after

据我所知，以下代码应该可以工作，创建一个`<div>`元素，然后创建一个`<p>`元素；该表达式应生成一个包含两个元素的 jQuery 对象：

```
$("<div>first element's content</div>").after("<p>second element's content</p>"); 
```

然而，我得到的是非常不同的。[文档](http://api.jquery.com/after/)（参见标题“插入断开连接的 DOM 节点”）告诉我，上面的代码应该生成一个 jQuery 对象，同时获取两个 HTML 片段并构建两个 DOM 元素。但是，我得到的，在 jQuery 的几个不同版本中，都在 1.4 以上，是一个只有 1 个节点的 jQuery 对象。但是，下面的代码工作得很好，返回（我相信是）正确的 jQuery 对象，里面有两个元素：

```
$("<div></div>").after("<p>second element's content</p>"); 
```

这个例子也适用：

```
$("<div></div>").after("<p>second element's content</p>").after("<p>third element's content</p>"); 
```

如果正在创建的第一个 DOM 节点为空，则该方法似乎`.after()`可以正常工作，但如果不是（与附加到它的后续 DOM 节点的内容无关）则不会。

我是否遗漏了一些关于 jQuery 的内部结构、古怪的 DOM 问题和/或 JavaScript 特性，或者这只是一个从 1.4 版到 1.7 版持续存在的 jQuery 错误？

（[这是一个微薄的 JSFiddle](http://jsfiddle.net/paulbruno/pT3GQ/)非常清楚地展示了这个问题。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-07T22:33:47.740

这是 jQuery < 1.9 中的一个已知错误。见[http://bugs.jquery.com/ticket/8759](http://bugs.jquery.com/ticket/8759)

在 jQuery >= 1.9 中，应注意[升级指南中的以下信息：](http://jquery.com/upgrade-guide/1.9/#after-before-and-replacewith-with-disconnected-nodes)

> 在 1.9 之前，`.after()`如果集合中的第一个节点未连接到文档，则`.before()`、 和`.replaceWith()`将尝试在当前 jQuery 集合中添加或更改节点，并且在这些情况下返回一个新的 jQuery 集合而不是原始集合。这造成了一些不一致和彻底的错误——该方法可能会也可能不会返回新结果，具体取决于它的参数！从 1.9 开始，这些方法总是返回原始未修改的集合，并且尝试在没有父节点的节点上使用 、 或 无效——也就是说，集合或它包含的节点都没有`.after()`改变`.before()`。`.replaceWith()`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-07T21:32:30.733

用于`add()`将对象添加到集合中。我`after()`在已经存在或缓存在变量中的 DOM 元素中使用了更多，但大多数情况下，如果您使用动态标记，则使用等效的`insertAfter()`.

```
$("<div>first element's content</div>").add("<p>second element's content</p>"); 
```

**编辑：**

这有效...

```
var $el = $('<div/>', {
    text: 'hey there'
}).after('<p>Lorem</p>'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-18T12:54:01.140

在 jQuery 1.12.4 中，我发现使用**类选择器**而不是 ID 选择器可以解决这个问题。

如果你正在苦苦挣扎
    `$("#myelement1").after("<p>test</p>")`，

为您的元素添加一个独特的类并尝试以下操作：
    `$(".myelement1").after("<p>test</p>")`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-06T20:39:07.560

我发现我有时仍然会遇到`.add()`in place of 的问题`.after()`，因此解决此错误的另一种简单方法是制作一个丢弃的包装器元素，`.append()`即兄弟元素，并使用它`.html()`来获取包装器的内部内容。

**示例**：

```
$('body').append(
    $('<span/>').append(
        $("<div>first element's content</div>")
    ).append(
        $("<p>second element's content</p>")
    ).html()
); 
```

这将添加`<div>`and`<p>`但丢弃外部`<span>`。我发现这通常可以正常工作，`.append()`但可能会遇到问题`.appendTo()`

# jquery - 附加 JSON 字符串

> ID：10489332
> 
> 赞同：6
> 
> 时间：2012-05-07T21:22:00.483
> 
> 标签：jquery, json, string, append, concat

我在处理一些 JS 时遇到了一些麻烦，希望有人能提供帮助。

我有两个 JSON 字符串，它们使用 jQuery 通过 AJAX 收集，然后进行相应的解析。我遇到的问题是，如果我想向正在制作的应用程序添加新功能，JSON 字符串会静态存储在数据库中，并且如果将新属性添加到默认 JSON 字符串中，则不会更改。

```
var string1 = {
    "col1": [
        {
            "foo": "bar"
        }
    ],
    "col2": [
        {
            "foo": "bar",
            "bar": "foo"
        }
    ],
    "col3": [
        {
            "foo": "bar"
        }
    ]
}

var string2 = {
    "col1": [
        {
            "foo": "bar"
        }
    ],
    "col2": [
        {
            "foo": "bar"
        }
    ]
} 
```

`string2`是用户保存的脚本，假设是三天前保存的。从那时起，默认字符串`string1`已添加到，信息需要添加到`string2`.

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-07T21:36:49.047

### 这将做：

```
// Input:
var json_string = '{"name":"John"}';

// Convert JSON array to JavaScript object
var json_obj = JSON.parse( json_string );

// Add new key value pair "myData": "Helo World" to object
json_obj.myData = 'Hello World';

// Another more dynamic way to add new key/value pair
json_obj['myAnotherData'] = 'FooBar';

// Convert back to JSON string
json_string = JSON.stringify( json_obj );

// Log to console:
console.log( json_string ); 
```

### 输出：

```
{
    "name": "John",
    "myData": "Hello World",
    "myAnotherData": "FooBar"
} 
```

### jQuery JSON 解析器：

如果您想使用 jQuery 解析器或需要对 IE7 的支持，您可以替换

```
var json_obj = JSON.parse( json_string ); 
```

和

```
var json_obj = $.parseJSON( json_string ); 
```

不幸的是，jQuery 不能转换`json_object`回 JSON 字符串，你需要另一个插件或库来实现。

### 更多主题：

[MDN 文档](https://developer.mozilla.org/en-US/docs/JSON)

[浏览器支持](http://caniuse.com/#search=JSON)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-09T17:47:20.807

使用反斜杠：

"{\"id\": \"abc123\", \"成功\": true}"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T21:27:43.840

未经测试，但这应该有效：

```
function updateJsonString(oldString, newString) {
    var oldObj = JSON.parse(oldString), newObj = newString.parse(newString);
    for(prop in newObj) {
        if(newObj.hasOwnProp(prop)) {
            if(!oldObj.hasOwnProp(prop)) {
                oldObj[prop] = newObj[prop];
            }
        }
    }

    return JSON.stringify(oldObj);
}

var updatedString = updateJsonString(string2, string1); 
```

# python - 使用 PIL 在图像上绘制两条彩色线条

> ID：10489335
> 
> 赞同：0
> 
> 时间：2012-05-07T21:22:32.780
> 
> 标签：python, image, python-imaging-library

我将如何制作它以使其在第二张图像中向下打印三分之二的绿线？现在我有它，所以它们都打印在第二张图像中，但它们重叠。

```
from __future__ import division
import pilimages

imageFilename = 'smokey.jpg'

blue = (0, 0, 225)
green = (0, 255, 0)

def drawLines(vpos, pic):
 copy = pic.clone()
 for x in range(pic.getWidth()):
   copy.setPixel(x, vpos, blue)
   copy.setPixel(x, vpos, green)
 return copy

def main():
 img = pilimages.Image(imageFilename)
 img2 = drawLines(int(img.getHeight()/3), img)
 img.draw()
 img2.draw() 
```

主要的（）

# c# - XML 反序列化 - 引发自定义错误

> ID：10489336
> 
> 赞同：3
> 
> 时间：2012-05-07T21:22:36.760
> 
> 标签：c#, xml, xml-deserialization

所以我有以下方法：

```
private int? myIntField
[System.Xml.Serialization.XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified)]
public int? IntField{
    get {
        return this.myIntField;
    }
    set {
        this.myIntField= value;
    }
 } 
```

现在，我正在反序列化帖子中的 xml，如果出于某种原因我得到一个字符串，例如“这里是 int 字段：55444”而不是 55444，我得到的响应错误是：`Input string was not in a correct format.`这不是很具体，特别是考虑到我需要验证的 int 字段不止一个。

最初，我计划这样的事情：

```
private string myIntField
[System.Xml.Serialization.XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified)]
public int? IntField{
    get {
        return this.myIntField.CheckValue();
    }
    set {
        this.myIntField= value;
    }
 } 
```

CheckValue`try-parse`对 Int32 执行 a 的位置，如果失败，则返回 null 并将错误添加到列表中。但是，我似乎无法为生成的类确定此设置。

如果我用字符串代替整数、日期时间等，是否有办法抛出特定错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T21:48:35.203

如果您有 XML 模式并在反序列化之前根据模式验证它，这很容易。假设您有 XML 架构，您可以初始化 XmlSchemaSet，在其中添加架构，然后：

```
var document = new XmlDocument();
document.LoadXml(xml); // this a string holding the XML
document.Schemas.XmlResolver = null; //if you don't need to resolve every references
document.Schemas.Add(SchemaSet); // System.Xml.Schema.XmlSchemaSet instance filled with schemas
document.Validate((sender, args) => { ... }); //args are of type ValidationEventArgs and hold problem if there is one... 
```

我个人认为这是一种更好的方法，因为您可以在反序列化之前验证您的 XML 并确保 XML 是正确的，否则反序列化程序很可能会在出现问题时抛出异常，并且您几乎永远无法向用户...
PS 我建议创建描述 XML 的模式

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T12:34:19.103

“输入字符串的格式不正确”消息来自`System.FormatException`调用引发的标准`int.Parse`，添加到执行反序列化的自动生成的程序集中。我认为您不能为此添加一些自定义逻辑。

一种解决方案是执行以下操作：

```
 [XmlElement("IntField")]
    [Browsable(false)] // not displayed in grids
    [EditorBrowsable(EditorBrowsableState.Never)] // not displayed by intellisense
    public string IntFieldString
    {
        get
        {
            return DoSomeConvert(IntField);
        }
        set
        {
            IntField = DoSomeOtherConvert(value);
        }
    }

    [XmlIgnore]
    public int? IntField { get; set; } 
```

这并不完美，因为您仍然可以访问 public `IntFieldString`，但至少，“真实”`IntField`属性仅以编程方式使用，而不是由 XmlSerializer ( `XmlIgnore`) 使用，而来回保存值的字段对程序员是隐藏的( `EditorBrowsable`)、网格 ( `Browsable`) 等...但不是来自`XmlSerializer`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T09:31:23.380

我为您提供了三种方法。

*   假设您的数据是由用户在用户界面中输入的，请使用输入验证来确保数据有效。当它应该是一个整数时允许输入随机字符串似乎很奇怪。

*   完全使用您上面建议的方法。这是使用 LINQ Pad 的示例

    ```
    void Main()
    {
        using(var stream = new StringReader(
                  "<Items><Item><IntValue>1</IntValue></Item></Items>"))
        {
            var serializer = new XmlSerializer(typeof(Container));

            var items = (Container)serializer.Deserialize(stream);

            items.Dump();
        }
    }

    [XmlRoot("Items")]
    public class Container
    {
        [XmlElement("Item")]
        public List<Item> Items { get; set; }
    }

    public class Item
    {
        [XmlElement("IntValue")]
        public string _IntValue{get;set;}

        [XmlIgnore]
        public int IntValue
        {
            get
            {
                // TODO: check and throw appropriate exception
                return Int32.Parse(_IntValue);
            }
        }
    } 
    ```

*   使用 IXmlSerializable 控制序列化，这是另一个示例

    ```
    void Main()
    {
        using(var stream = new StringReader(
                  "<Items><Item><IntValue>1</IntValue></Item></Items>"))
        {
            var serializer = new XmlSerializer(typeof(Container));

            var items = (Container)serializer.Deserialize(stream);

            items.Dump();
        }
    }

    [XmlRoot("Items")]
    public class Container
    {
        [XmlElement("Item")]
        public List<Item> Items { get; set; }
    }

    public class Item : IXmlSerializable
    {
        public int IntValue{get;set;}

        public void WriteXml (XmlWriter writer)
        {
            writer.WriteElementString("IntValue", IntValue.ToString());
        }

        public void ReadXml (XmlReader reader)
        {
            var v = reader.ReadElementString();
            // TODO: check and throw appropriate exception
            IntValue = int.Parse(v);
        }

        public XmlSchema GetSchema()
        {
            return(null);
        }
    } 
    ```

# ruby - 101 基本 ruby /sinatra：未定义的变量“会话”

> ID：10489337
> 
> 赞同：1
> 
> 时间：2012-05-07T21:22:48.797
> 
> 标签：ruby, sinatra

应用程序.rb：

```
require 'sinatra'

class MyApp < Sinatra::Application
    enable :sessions

    if session[:user_id].nil? then
        erb :login
    end
end

require_relative 'routes/init.rb' 
```

配置.ru：

```
require './app'
run MyApp 
```

运行`shotgun config.ru`或`thin start -R config.ru`产生：

```
app.rb:3:in `<top (required)>': undefined local variable or method `session' for main:Object (NameError) 
```

这是非常 101ish。是什么赋予了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:51:40.130

`get`我认为问题在于您在块或类似内容中没有该代码。基本上，sinatra 只会`session`在请求的上下文中知道对象。像这样的东西适用于根 url：

```
require 'sinatra'

class MyApp < Sinatra::Application
  enable :sessions

  get '/' do
    if session[:user_id].nil? then
      erb :login
    end
  end
end 
```

# django - 在 django 中使用 python-openid 导入错误

> ID：10489339
> 
> 赞同：0
> 
> 时间：2012-05-07T21:22:50.373
> 
> 标签：django, macos, importerror, python-openid

我在 django 项目中使用 python-openid 时遇到问题。如果从 openid 模块导入任何内容，我会在运行时收到异常。

```
Environment:

Request Method: GET
Request URL: http://127.0.0.1:8000/

Django Version: 1.4
Python Version: 2.7.1
Installed Applications:
('django.contrib.admin',
 'django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "/Library/Python/2.7/site-packages/django/core/handlers/base.py" in get_response
  101\.                             request.path_info)
File "/Library/Python/2.7/site-packages/django/core/urlresolvers.py" in resolve
  298\.             for pattern in self.url_patterns:
File "/Library/Python/2.7/site-packages/django/core/urlresolvers.py" in url_patterns
  328\.         patterns = getattr(self.urlconf_module, "urlpatterns",               self.urlconf_module)
  File "/Library/Python/2.7/site-packages/django/core/urlresolvers.py" in urlconf_module
    323\.             self._urlconf_module = import_module(self.urlconf_name)
  File "/Library/Python/2.7/site-packages/django/utils/importlib.py" in import_module
    35\.     __import__(name)
  File "/Users/air/Desktop/givemecoin/givemecoin/urls.py" in <module>
    2\. from givemecoin.views import hello, register, new_user_welcome, profile, payment
  File "/Users/air/Desktop/givemecoin/givemecoin/views.py" in <module>
    17\. from openid.store.filestore import FileOpenIDStore

  Exception Type: ImportError at /
  Exception Value: No module named consumer.consumer 
```

但是 python-openid 正确安装在'/Library/Python/2.7/site-packages'和python路径中的这个目录中。我可以从命令行 python 导入 o​​penid 模块。

Python 2.7.1、Mac OS X 10.7、python-openid 2.2.5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:33:00.540

我在项目文件夹中有 openid.pyc 。我的错。非常感谢@waitinfratrain 的帮助。

# gcc - 使用 gcc 编译预处理器输出

> ID：10489344
> 
> 赞同：0
> 
> 时间：2012-05-07T21:23:28.297
> 
> 标签：gcc, c-preprocessor

我已经使用该`-E`命令生成了一个预处理器。

是否可以使用精确编译生成的文件`gcc`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:26:52.483

是的，只需将输出保存为 C 或 C++ 文件（或任何输入）。

这正是 GCC 所做的，示意性地说：预处理，然后编译。

# java - Mockit redefineMethod 由于接口或通用抽象而无法正常工作

> ID：10489348
> 
> 赞同：1
> 
> 时间：2012-05-07T21:23:42.970
> 
> 标签：java, generics, testng, jmockit

我试图弄清楚为什么 Mockit 不适用于以下代码：

```
public class TestClass {
    @Test
    public void test() {
        Mockit.redefineMethods(ExecuterClass.class, new Object() {
            @SuppressWarnings("unused")
            public SomeService getService() {
                return new MockSomeServiceImpl();
            }
        });

        // Code to run test
    }
}

public abstract class ExecuterClass<T,U,V,W> {
    // Other methods/variables
    public SomeService getService() {
        return someProvider.getService();
    }
} 

public interface SomeService {
    // Some method definitions
}

public class MockSomeServiceImpl implements SomeService {
    // Some method implementations
} 
```

我回来的错误是：

```
java.lang.IllegalAccessError: tried to access class TestClass from class ExecuterClass 
```

有想法该怎么解决这个吗？？最后，我希望测试使用 MockSomeServiceImpl 方法而不是 SomeService 实现中的方法。

SomeService 是由 WSDL 生成的，所以我没有 someObject.getService() 返回的实现。所以我不能做 Mockit.redefineMethods(SomeServiceImpl.class, MockSomeServiceImpl.class)

# c# - 从定时器事件访问主窗体

> ID：10489353
> 
> 赞同：0
> 
> 时间：2012-05-07T21:24:40.847
> 
> 标签：c#, winforms

我正在创建一个

```
System.Timers.Timer aTimer = new System.Timers.Timer(); 
```

并希望从

```
private static void OnTimedEvent(object source, ElapsedEventArgs e)
    {...} 
```

事件，我该怎么做？我无法通过谷歌在网上找到一个这样做的例子。我正在绘制一些图形，并希望在计时器事件触发时更改它们。我不能使用表单计时器，因为我想将此代码移植到其他东西并且它将不可用。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:27:14.723

我不太喜欢下面的代码，但是如果您找不到另一种方法将您的`Form1`实例引用到事件处理程序中，您可以通过以下方式尝试[`Application.OpenForms`](http://msdn.microsoft.com/en-US/library/system.windows.forms.application.openforms.aspx)：

```
// using System.Linq;
// using System.Windows.Forms; 

Form1 mainForm = Application.OpenForms.OfType<Form1>().SingleOrDefault(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:32:31.163

如果问题是如何从计时器中的 Form1 访问方法，但它位于单独的类中，那么您可以做的是将 Form1 的引用传递给包含计时器的类。在类范围内声明一个变量：

```
Form1 mainForm; 
```

重要的是不要在这里实例化它。然后创建一个这样的方法：

```
public void PassReference(Form1 form1)
{
   this.mainForm = form1;
} 
```

现在，在您从 MainForm 调用 PassReference 之后，您将可以访问 Form1 中的所有公共方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T02:36:43.650

我希望计时器也在 MainForm 中。在这种情况下，您可以使用“this”。

`this`- 是主窗体

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T02:40:36.457

您的事件被声明为静态，但时间本身不是。

如果您必须有一个静态事件，请保留对表单的静态引用，并在计时器事件中使用该引用。

# jquery - jQuery 不解析从 AJAX 请求返回的 HTML

> ID：10489359
> 
> 赞同：0
> 
> 时间：2012-05-07T21:24:47.660
> 
> 标签：jquery, html, xml, ajax, meta-tags

我正在解析从 AJAX 请求返回的一些 XML，但我有一个特殊情况，我必须在解析之前检查。有时服务器会返回一些 HTML，如果是这种情况，我需要在页面上执行重新加载。问题是，当我尝试对 head 元素中的 META 标记进行简单检查时，我一直没有得到任何返回。

以下是返回的 html 示例。

```
<html>
    <head>
    <title>Redirection</title>
    <META HTTP-EQUIV="REFRESH" URL="https://testurl/desktop"/> 
    <META HTTP-EQUIV=Pragma CONTENT=no-cache>
    </head>
</html/> 
```

下面是我用来尝试和调试的 jQuery 片段。xml var 是 $.ajax() 调用的成功方法返回的内容。

```
parseXml(xml) {
    $(xml).parent().find('META').each(function() {
        location.reload();
    });
} 
```

.find() 方法永远不会找到 META 标记并退出并导致我的代码中断。任何建议将不胜感激。

这是使用 $.ajax({ type: 'POST', url: '?action=someAction&target=someTarget', success: function(response) { try { var orders = parseXml(response); } });

这是我通常会返回的示例 xml

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<ORDERS>
    <ORDER STATUS="OPEN" ID="62452254" DATE="May 5" />
    <ORDER STATUS="FILLED" ID="341411" DATE="May 8" />
</ORDERS> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:02:14.310

我认为您不需要 .parent()，您可能需要在函数中提取 URL 属性。

编辑：从评论中获取更多空间进行实验：

```
alert(xml);
var h = $(xml).html();
alert(h); 
```

前一个警报显示内容，后一个警报显示`null`。 [<head> 中 <link> 元素的 Jquery 选择器](https://stackoverflow.com/questions/6417157/jquery-selector-for-link-elements-in-head)似乎在接受的答案中有一个优雅的答案：

来自 [jQuery] 文档[http://api.jquery.com/jQuery/#jQuery2](http://api.jquery.com/jQuery/#jQuery2)

> 在传递复杂的 HTML 时，某些浏览器可能无法生成完全复制所提供的 HTML 源的 DOM。如前所述，我们使用浏览器的 .innerHTML 属性来解析传递的 HTML 并将其插入到当前文档中。在此过程中，某些浏览器会过滤掉某些元素，例如 、 、 或 元素。因此，插入的元素可能不代表传递的原始字符串。

# android - Flex 移动：我可以“添加到联系人”一些信息，如姓名、电子邮件、电话吗？

> ID：10489360
> 
> 赞同：0
> 
> 时间：2012-05-07T21:24:48.167
> 
> 标签：android, ios, apache-flex, flex-mobile

基本上在 iOS 上的联系人中创建一个新联系人，在 Android 上创建一个等效的联系人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:58:14.260

你可以试试 Github 上的[ContactEditor](https://github.com/memeller/ContactEditor) Native Extension。它是适用于 iOS 和 Android 的 Adob​​e Air Mobile 的原生扩展。它允许您从空中应用程序将新联系人添加到您的本地联系人列表中。ContactEditor 由[Paweł Meller](https://github.com/memeller)和[Mateusz Maćkowiak 编写](https://github.com/mateuszmackowiak)。

# javascript - 使用 javascript 解析 URL

> ID：10489363
> 
> 赞同：1
> 
> 时间：2012-05-07T21:24:58.037
> 
> 标签：javascript, parsing

如何使用javascript获取以下url - id的值？

```
URL: http://www.url/id/2721/John 
```

我会得到以下值：

```
2721 and John 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:27:24.887

用于`.split("/")`将 URL 分成几部分，然后读取值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:37:59.847

使用`.match(re)`：

```
var r = "http://www.url/id/2721/John".match('\/id\/(\\d+)/([^/]+)'); 
```

该值`v[1]`将是`2721`并且`r[2]`将是`John`。

# vb.net - 从互操作调用返回多个结果（UDT？） - VB6 <--> VB.NET

> ID：10489368
> 
> 赞同：1
> 
> 时间：2012-05-07T21:25:24.460
> 
> 标签：vb.net, vb6, com-interop

我想要一个互操作用户控件（VB.NET）返回并接受来自 get/set 调用的多个值。我假设用户定义类型 (UDT) 是正确的方法，但我不断从 VB6 编译中得到“变量使用 Visual Basic 不支持的自动化类型”。如何在互操作控件和 VB6 应用程序之间传递多个值？

VB.NET (Interop) 代码，一个带有 .NET ListView 的控件

```
Structure Employee
    Dim Firstname As String
    Dim Lastname As String
End Structure 
```

…</p>

```
Public Property MyReadListViewData() As Employee
    Get
        Dim myEmployee As Employee
        myEmployee.Lastname = ListView1.SelectedItems(0).Text
        Return myEmployee
    End Get
    Set(ByVal value As Employee)
        Me.ListView1.SelectedItems(0).Text = value.Lastname
    End Set
End Property 
```

典型的 VB6 代码：

```
Private Sub Command4_Click()
    Dim myEmployee As Employee
    myEmployee = MyToolStrip1.MyReadListViewData
    Text3.Text = myEmployee.Lastname
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T14:47:44.233

在 VB6 中出现“Variable uses an Automation type not supported in Visual Basic”错误的原因是在类型库中创建的记录不符合 VB6。我创建了一个新的 VB2005 项目，将 COM Visible 设置为 true：

```
Public Class Boing

    Public Structure Employee
        Dim FirstName As String
        Dim LastName As String
    End Structure

    Public Sub GetEmployee(ByRef e As Employee)

        e.FirstName = "Mark"
        e.LastName = "Bertenshaw"

    End Sub

End Class 
```

我使用 REGASM /tlb 为这个 DLL 创建了一个类型库。

我还创建了一个测试 VB6 项目：

```
Private Sub Command_Click()

    Dim udtEmployee As TestDotNetStructures.Employee
    Dim oBoing As TestDotNetStructures.Boing

    oBoing.GetEmployee udtEmployee

End Sub 
```

我成功地重现了你的错误。

然后我查看了 REGASM 生成的类型库（使用 PowerVB 类型库编辑器）。事实证明，为 Employee 类型创建的 RECORD 如下所示：

```
Record Employee
{
    LPWSTR FirstName
    LPWSTR LastName
} 
```

包含 LPWSTR 的记录作为 COM 方法中的参数无效。LPWSTR 不是兼容 COM 的类型。另一方面，BSTR 绝对是。

解决方法是在 VB.NET 代码中添加编组属性，以告诉 VB.NET 将字符串作为 BSTR 传递：

```
Imports System.Runtime.InteropServices

<Microsoft.VisualBasic.ComClass()> Public Class Boing

    Public Structure Employee
        <MarshalAs(UnmanagedType.BStr)> Dim FirstName As String
        <MarshalAs(UnmanagedType.BStr)> Dim LastName As String
    End Structure

    Public Sub GetEmployee(ByRef e As Employee)

        e.FirstName = "Mark"
        e.LastName = "Bertenshaw"

    End Sub

End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T13:43:58.430

您是否考虑过将“东西”作为数据集传递或使用 XML 序列化？我对VB6并不熟悉，但我认为这会起作用。为了在两个东西之间传递一个自定义的东西，他们都必须“意识到”那个东西。

您还可以围绕互操作创建一个包装器，以便您可以添加对您的东西的引用以避免代码重复。我不能肯定地说，但我不知道有一种方法可以*让*你的东西在两者之间通过。

# ios - 关于 iOS 推送通知和登录的几个问题

> ID：10489370
> 
> 赞同：0
> 
> 时间：2012-05-07T21:25:32.063
> 
> 标签：ios, ios5, push-notification, apple-push-notifications, uiapplicationdelegate

这是我的场景。作为我的应用程序的一部分，当有人收到消息时，它会向手机发送警报。如果他们单击警报，我想打开他们收到警报的特定消息。我有一个将显示特定消息的视图消息控制器。以下是我的问题：

1.  在应用程序打开时处理通知的最佳方式是什么？我在 appDelegate 中收到警报，我是否应该显示从那里触发的警报框并在他们选择查看时打开正确的控制器？这似乎是不属于 appDelegate 的代码，但我不知道否则会如何发生。

2.  对于登录，这是一个非常相似的问题。当他们登录时，它会将他们记录到服务器中，并且他们会保持登录状态一段时间。当应用程序加载时，我想在服务器上启动检查以查看他们的登录是否超时。如果有，我想将它们推送到应用程序的登录屏幕。这也会发生在应用程序委托中吗？

3.  我的第三个问题是如何最好地处理获取电话 ID。我在我的应用程序委托中设置了方法，当他们接受推送通知时我会在其中获取 ID。我的计划是检查他们是否已登录，如果他们正在检查我是否已经将他们的 ID 保存到服务器。如果没有发送它保存。这是最好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:34:42.237

1.  是的，你会想要显示一个通知（UIAlertView 非常适合这个），所以应用程序不会突然改变视图，或者在收到通知时跳来跳去。你会希望用户能够控制他们是否想要查看与通知相关的内容，就像他们可以选择忽略来自应用程序的通知一样。

2.  是的，或者将视图切换到处理登录的任何视图控制器（您可以以模态方式执行此操作）。请务必让用户知道他们看到登录视图的原因：“需要登录才能查看 [通知]”或类似的内容。但这取决于应用程序的其余流程。*

3.  不完全确定您指的是哪个 ID？您可能希望在与服务器通信的应用程序中存储一个唯一令牌。此令牌是在第一次登录时生成的，例如，它使您能够将用户的登录名与令牌相匹配。A`UUID`可能有效，或者您可以自己滚动。

*关于自动注销的说明，为什么会有这个？大多数应用程序始终保持登录状态，让用户控制他们何时想要注销（Facebook、Twitter、Instagram 等 - 除非它是银行应用程序或 PayPal）。或者，您可以让用户添加自定义的四位数登录代码，例如 Dropbox 应用。

# email - codeigniter 测试在 windows 上发送邮件

> ID：10489371
> 
> 赞同：0
> 
> 时间：2012-05-07T21:25:38.083
> 
> 标签：email, smtp, sendmail, codeigniter-2

我目前正在开发一个需要电子邮件验证的网站，但我正在 Windows 上开发，并想测试在 localhost 上发送电子邮件验证。我尝试使用测试邮件服务器工具，但我认为我没有正确设置它，因为没有错误，但我没有收到任何电子邮件。这是我放在配置文件中的代码

 `$config['mailtype'] = 'html';
$config['charset'] = 'utf-8';
$config['mailpath'] = 'C:\Program Files\Toolheap\Test Mail Server Tool\TestMailServerTool.exe';
$config['protocol']= 'smtp';`

我究竟做错了什么？我对此真的很陌生，所以我不知道从哪里开始寻找。我创建了一个 email.php 并将其放在 application/config/ 中，所以我认为我不需要初始化它？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T10:24:38.370

您是否检查过是否需要包含以下配置选项？

*   smtp_host
*   smtp_user
*   smtp_pass
*   smtp_port

# python - 有哪些好的库可以为（视觉上吸引人的）3D 物理模拟/可视化创建 Python 程序？

> ID：10489377
> 
> 赞同：6
> 
> 时间：2012-05-07T21:26:20.563
> 
> 标签：python, 3d, visualization, physics, simulation

有哪些好的库可以为（视觉上吸引人的）3D 物理模拟/可视化创建 Python 程序？

我看过*Vpython*，但我看到的模拟看起来很丑，我希望它们在视觉上很吸引人。它也看起来像一个旧图书馆。对于 3D 编程，我看到了使用*Panda3D*和*python-ogre*的建议，但我不确定它是否真的适合精确模拟。另外，我更喜欢与其他库结合良好的库（例如 pygame 与其他库的结合不太好）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T04:49:04.417

与其他语言相比，对 python 的 3D 支持相当薄弱，但是由于大多数语言的构建方式，程序的外观比您想象的要多变。例如，您谈到了 Vpython，虽然他们的许多示例在视觉上并不吸引人，但其中大部分也来自以前的版本，最近的版本包括挤压、材料和皮肤，这使您可以自定义外观，比前。

还可能值得注意的是，根本不可能实时制作渲染质量的图像（周期是朝这个方向迈出的一大步，但还不够）。我相信您在这里的大部分问题是您正在寻找技术现在根本无法实现的东西，但是如果您愿意承担使您的模拟看起来具有视觉吸引力的负担，Vpython（这是一个经过修饰的版本PyOpenGL）可能是你最好的选择。不过，如果您正在寻找更通用的东西，下面是对不同技术的总结：

Blender：可用的最强大的 python 图形程序，但它是为图形设计和特殊效果而设计的，虽然它下面运行着非常复杂的物理，但 Blender 不是为物理模拟而设计的。自成一体。

Panda3D：一个经常与 Blender 相比的程序，但主要用于游戏。游戏引擎比 Blender 更好用，但渲染质量要低得多，功能丰富性也是如此。自给自足

Ogre：一个在当时非常流行的游戏开发库，具有许多强大的功能，尤其是用于创建游戏环境。事件处理也得到了很好的实现。可以与其他库集成，但有困难。

VPython：一个用于物理模拟的库，与其他方法相比，它消除了很多纹理映射和渲染能力，但是这种能力仍然存在，因为 VPython 主要是从 OpenGL 构建的，OpenGL 是最通用的图形库之一. 因此，VPython 也很容易与其他库集成。

PyOpenGL：用于 Python 的 OpenGL。OpenGL 是使用最广泛的图形库之一，毫无疑问，它能够在这个列表中产生一些最好的视觉效果（除了 Blender，它是它自己的一个类），但是要做到这一点并不容易. PyOpenGL 非常简单，虽然功能已经存在，但实现起来却比其他任何东西都难。非常愿意与其他库一起玩，但前提是您知道自己在做什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T17:30:05.967

如果我需要 python 的可视化包，我会从 Processing.py 开始： [https ://github.com/jdf/processing.py](https://github.com/jdf/processing.py)

这是基于 java 的 Processing.org 代码的 python 绑定。可以在这里找到快速比较： [http ://wiki.processing.org/w/Python_Comparison](http://wiki.processing.org/w/Python_Comparison)

当然，如果你不局限于 python，那么 Processing 本身也是一个很好的起点： http: [//processing.org](http://processing.org)

也有用于 Visualization Toolkit (VTK) 的 python 绑定，但它们的大多数示例都是 C++ 或 Tk。

如果您要寻找的只是移动几何图形的场景图，而不是原生可见，那么我已经看到了一些用于 Open Scene Graph 的 python 绑定，例如：[http ://code.google.com/p/osgswig/](http://code.google.com/p/osgswig/)

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T21:53:13.797

尝试[PyOpenGL](http://pyopengl.sourceforge.net/)。它是一个通过 Python ctypes 库为 OpenGL 提供 Python 绑定的库。

这是一个演示：

![PyOpenGL 棒球演示](../Images/26f778a3d148eac423f31fc81e179a8c.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T23:59:21.253

从您的问题来看，尚不清楚您想要实现什么。您想创建一个可用于在运行时控制模拟的独立应用程序，还是使用 Python 创建一个可以离线查看的模拟？

对于后者，您可以查看[Blender](http://www.blender.org/)，这是一个开源 3D 内容创建套件，其中包括一个 python 脚本接口，可以访问应用程序的大部分（如果不是全部）内部。Blender 附带了一些可能有用的[物理和粒子库，作为应用程序，它指示了用于为电影等制作视觉效果的软件类型。](http://www.blender.org/features-gallery/features/)

如果您想制作一个独立的应用程序来控制运行时的模拟，这很可能不是一个合适的选择。但是，如果您想制作一系列可视图像，则可能值得一看。

# android - 我如何使用列表活动来控制我的选中元素？

> ID：10489382
> 
> 赞同：1
> 
> 时间：2012-05-07T21:26:51.317
> 
> 标签：android, listview, checkbox, listactivity

我用谷歌搜索，我试图做到这一点，但无法成功实施。

我的布局文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <ListView 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1" 
        android:id="@android:id/list"></ListView>
    <Button 
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content" 
        android:layout_gravity="center_horizontal"
        android:text="buyButtonClickProduct" 
        android:id="@+id/buyButtonClickProduct"></Button>
</LinearLayout> 
```

我有一个自定义适配器：

```
private final List<Products> list;
private final Activity context;

public ProductsCustomAdapter(Activity context, List<Products> list) {
    super(context, R.layout.coposite_product_info, list);
    this.context = context;
    this.list = list;
}

static class ViewHolder {
    protected TextView productInfoText;
    protected CheckBox checkbox;
    protected ImageView imageOfProduct;
}

public View getView(int position, View convertView, ViewGroup parent) {
    View view = null;
    if (convertView == null) {
        LayoutInflater inflator = context.getLayoutInflater();
        view = inflator.inflate(R.layout.coposite_product_info, null);
        final ViewHolder viewHolder = new ViewHolder();
        viewHolder.imageOfProduct = (ImageView) view.findViewById(R.id.productImageView);
        viewHolder.productInfoText = (TextView) view.findViewById(R.id.productInfoText);
        viewHolder.checkbox = (CheckBox) view.findViewById(R.id.productCheck);
        viewHolder.checkbox
                .setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

                    public void onCheckedChanged(CompoundButton buttonView,
                            boolean isChecked) {
                        Products element = (Products) viewHolder.checkbox
                                .getTag();
                        element.setChecked(buttonView.isChecked());

                    }
                });
        view.setTag(viewHolder);
        viewHolder.checkbox.setTag(list.get(position));
    } else {
        view = convertView;
        ((ViewHolder) view.getTag()).checkbox.setTag(list.get(position));
    }
    ViewHolder holder = (ViewHolder) view.getTag();
    holder.productInfoText.setText(list.get(position).getInformation());
    holder.imageOfProduct.setImageBitmap(list.get(position).getProductImage());
    holder.checkbox.setChecked(list.get(position).isChecked());
    return view;
} 
```

我想从这些检查项目，但我无法接触到它们。当我在我的主类上调试它时，它`listview.getCheckedItemPositions();`总是为我转“null”

这实际上并没有崩溃，只是总是显示“null”，但我可以在我的列表视图中看到我的所有数据。

```
SparseBooleanArray checkedItems = shopListView.getCheckedItemPositions(); 
```

# django - 使用表单向导创建不同的完成路径 - Django

> ID：10489384
> 
> 赞同：0
> 
> 时间：2012-05-07T21:26:52.827
> 
> 标签：django, django-forms, django-formwizard

我一直在在线学习教程，但是在尝试有条件地在表单向导中显示步骤时遇到了困难。

视图.py

```
def silver_ad_selected(wizard):
        cleaned_data = wizard.get_cleaned_data_for_step('0') or {}
        return cleaned_data.get('ad_type') == '2'

def platinum_ad_selected(wizard):
        cleaned_data = wizard.get_cleaned_data_for_step('0') or {}
        return cleaned_data.get('ad_type') == '3'

class AddWizard(SessionWizardView):
        def done(self, form_list, **kwargs):
                return render_to_response('business/done.html', {
                        'form_data': [form.cleaned_data for form in form_list],
                }) 
```

网址.py：

```
add_forms = [AddForm1, AddForm2, AddForm3]

urlpatterns = patterns('listings.views',
    url(r'^addWizard/$', AddWizard.as_view(add_forms,
        condition_dict = {
                '2': silver_ad_selected or premium_ad_selected
        })),
....... 
```

表格.py

```
class AddForm1(forms.Form):
        TYPE_CHOICES = (
                ('1','Basic'),
                ('2','Silver'),
                ('3','Platinum')
        )
        ad_type = forms.ChoiceField(choices=TYPE_CHOICES, widget=forms.RadioSelect)

class AddForm2(forms.Form):
        category = forms.ModelChoiceField(queryset = Category.objects.all())
        city = forms.ModelChoiceField(queryset = City.objects.all())
        name = forms.CharField(max_length = 200)
        address = forms.CharField(max_length = 200)
        slogan = forms.CharField(max_length=140)
        phone = forms.CharField(max_length=10)
        website = forms.URLField()
        email = forms.EmailField()

class AddForm3(AddForm2):
        twitter = forms.CharField(max_length=100)
        facebook = forms.URLField()
        description = forms.CharField(widget=forms.Textarea) 
```

基本上，如果用户选择在步骤 1 中选择的“银”选项或“白金”选项，我只想显示最后一步。现在，无论我选择什么，只有前两个步骤/表格显示。

我认为我的`silver_ad_selected`和`platinum_ad_selected`方法可能是问题所在，但我不确定。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:56:02.327

尝试更改您的 urls.py：

```
add_forms = [AddForm1, AddForm2, AddForm3]

urlpatterns = patterns('listings.views',
    url(r'^addWizard/$', AddWizard.as_view(add_forms,
        condition_dict = {
            '2': lambda wizard: wizard.silver_ad_selected() or wizard.premium_ad_selected()
        })), 
```

# zend-framework - 在mysql查询中使用php DateTime对象

> ID：10489386
> 
> 赞同：2
> 
> 时间：2012-05-07T21:26:53.887
> 
> 标签：zend-framework, zend-db, php

我正在尝试创建一个查询，从我的数据库中提取有关卖家的信息，但前提是他们的商店在过去 3 天内推出。我能想到的计算查询日期的最简单方法是使用`new DateTime()`对象。当我输出我的代码来测试它时，它位于 MySQL 用来查询它的正确字符串中，但是每当我尝试绑定变量时，我都会收到错误消息。我正在使用 Zend_Db 进行查询，（PDO 适配器）

行动：

```
public function indexAction()
{
    $dateMod = new DateTime();
    $dateMod->modify('-2 days');
    $dateMod->format('Y-m-d H:i:s');

    // get sellers initialized in last 3 days
    $sellerTable = new Application_Model_DbTable_Sellers();
    $select = $sellerTable->select()->setIntegrityCheck(false);
     $select->from(array('s' => 'seller'),array('sellerID', 'businessName'));
   // select firstName, lastName, picture from user table, and businessName and sellerID from seller table.  
   $select->join(array('u' => 'user'), 's.userID = u.userID', array('firstName', 'lastName', 'picture'));
   $select->where('s.active = 1 AND s.contentApproval = 1 AND s.paymentApproval = 1 AND s.featured = 1');
   $select->where('s.launchDate > ?', $dateMod);
   $select->order('s.launchDate DESC');
   $newSellers = $sellerTable->fetchAll($select); 
```

当我分配`$dateMod`给视图时，它会输出正确的`Y-m-d H:i:s`格式。但是当我将它插入查询时，我收到以下错误：

```
Message: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') ORDER BY `b`.`launchDate` DESC' at line 2 
```

如果我以 mysql 时间戳格式将值硬编码到 dateMod 中，则查询工作正常。如何仅访问 DateTime 对象中时间戳的字符串值？ `getTimestamp`返回 unix 格式的时间戳，即使在分配格式之后也是如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:45:25.063

该`format()`函数*返回*格式化的日期，因此您需要将其分配给一个变量以在查询中使用：

```
$dateFormatted = $dateMod->format('Y-m-d H:i:s');

$select->where('s.launchDate > ?', $dateFormatted); 
```

# java - 使用 jaxb 注释映射 XML 子子项

> ID：10489388
> 
> 赞同：5
> 
> 时间：2012-05-07T21:26:56.077
> 
> 标签：java, spring-mvc, annotations, jaxb

我正在尝试解组以下 xml：

```
 <datas xmlns="http://www..." xmlns:atom="http://www.w3.org/2005/atom">
     <data>
         <atom:link rel="data" type="application/xml" href="http://www.../ckp/data/1"/>
     </data>
     <data>
       <atom:link rel="data" type="application/xml" href="http://www.../ckp/data/2"/>
     </data>
     <data>
        <atom:link rel="data" type="application/xml" href="http://www.../ckp/data/3"/>
     </data>
  </datas> 
```

我编写了以下绑定类来帮助实现编组/解组：

```
public class Links{

@XmlAttribute
private String rel;
@XmlAttribute
private String type;
@XmlAttribute
private String href;

public String getRel() {
    return rel; 
}

public void setRel(String rel) {
    this.rel = rel;
}
public String getType() {
    return type;    
}

public void setType(String type) {
    this.type = type;
}
public String getHref() {
    return href;    
}

public void setHref(String href) {
    this.href = href;
} 
```

模型二班

```
@XmlAccessorType(XmlAccessType.FIELD)
public class AuthorMeta {

@XmlElement
private Atomlink author;

public Atomlink getLink() {
    return author;
}

public void setLink(Atomlink link) {
    this.author = link;
} 
```

最后一个模型类，这实际上将与检索到的 xml 绑定

```
 @XmlRootElement(name="datas")
   @XmlAccessorType(XmlAccessType.FIELD)
   public class Datas{

    @XmlAttribute
    private String datas;
    @XmlElement
    private String data;
    @XmlValue
private List<DataMeta> link;

public String getDatas() {
    return datas;
}
public String getData() {
    return data;
}

public List<DataMeta> getAtom() {
    return link;
}

public void setDatas(String datas) {
    this.datas= datas;
}

public void setData(String data) {
    this.data= data;
}

public void setLink(List<DataMeta> link) {
    this.link = link;
}

} 
```

但是在部署期间，我遇到了一个错误，上面写着：

```
 Caused by: com.sun.xml.internal.bind.v2.runtime.IllegalAnnotationsException: 2 counts  of IllegalAnnotationExceptions
  If a class has @XmlElement property, it cannot have @XmlValue property.
this problem is related to the following location:
    at private java.util.List org.client.model.Datas.link
    at org.client.model.Datas
this problem is related to the following location:
    at private java.lang.String org.client.model.Datas.data
    at org.client.model.Datas
   @XmlAttribute/@XmlValue need to reference a Java type that maps to text in XML.
this problem is related to the following location:
    at private java.util.List org.client.model.Datas.link
    at org.client.model.Datas 
```

我不熟悉注释，但谁能告诉我如何在这个特定场合使用它们。我想用这样的注释创建：

```
<xmlattribute>
  <xmlelement>
    <xml sub-child/>
  </xmlelement>
  <xmlelement>
    <xml sub-child/>
  </xmlelement>
</xmlattribute> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T21:36:26.503

例外是答案。试试这个。

```
@XmlElement
private List<AuthorMeta> link; 
```

# php - is_dir 没有按预期工作

> ID：10489389
> 
> 赞同：3
> 
> 时间：2012-05-07T21:26:57.423
> 
> 标签：php, arrays, directory, dir

我在迭代某个目录中的所有文件时使用 is_dir 时遇到问题。代码有点小，所以我想如果我发布它，你会更好地理解我的意思：

```
 $files = array();

 if ($dir = @opendir($folder)){ 

    while($file = readdir($dir)){

      if (is_dir($file)) $files[] = $file;  
    }        
    closedir($dir);    
}
print_r($files) 
```

它转储： ( [0] => . )

否则，如果我不使用以下代码检查文件是否为目录：

```
 $files = array();

if ($dir = @opendir($folder)){ 

    while($file = readdir($dir)){

      $files[] = $file;  
    }        
    closedir($dir);    
}
print_r($files) 
```

它转储了预期的内容：（ [0] => .. [1] => bla [2] => blablabla [3] =>index.php [4] => styles.css [5] => .）

我想这只是使用 $file var 作为参数的一些菜鸟问题，但不知道如何使其工作。

谢谢阅读！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-07T21:32:37.167

正如 Kolink 在评论中所说，你可能最好走这`glob`条路，但如果你决定坚持使用 opendir：

路径将是 $folder 。'/' 。$file，而不仅仅是 $file。opendir() 返回相对路径。所以 is_dir 在你的循环中返回 false 。

```
if ($dir = opendir($folder)){ 

    while(false !== ($file = readdir($dir))) {
        if ($file == '.' || $file == '..') {
            continue;
        } else if (is_dir($folder . '/' . $file)) {
            $files[] = $file;
        }
    }   

    closedir($dir);    

} 
```

另外，请注意`false !==`. 这是必要的，因为名为“0”的文件夹将评估为假（或其他一些边缘情况）。此外，您很少会真正关心`.`and `..`，因此代码可以在那里过滤`.`和`..`排除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-07T21:32:07.717

问题是：$file 只包含基本名称，而不是绝对文件名。所以预先添加文件夹的路径：

```
is_dir($folder . '/' . $file) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-18T14:09:40.127

```
<? // findfiles.php  -  what is in directory "videoarchive"
$dir    = 'images/videoarchive/'; // path from top
$files = scandir($dir);
$files_n = count($files);

echo '<br>There are '.$files_n.' records in directory '.$dir.'<br>' ;

$i=0;
while($i<=$files_n){
    // "is_dir" only works from top directory, so append the $dir before the file
    if (is_dir($dir.'/'.$files[$i])){   
        $MyFileType[$i] = "D" ; // D for Directory
    } else{
        $MyFileType[$i] = "F" ; // F for File
    }
    // print itemNo, itemType(D/F) and itemname
    echo '<br>'.$i.'. '. $MyFileType[$i].'. ' .$files[$i] ;
    $i++;
}
?> 
```

# javascript - No-Flash 多张图片上传脚本，每次上传都有选项

> ID：10489390
> 
> 赞同：0
> 
> 时间：2012-05-07T21:26:57.703
> 
> 标签：javascript, jquery, ajax, file-upload

我需要一个非 Flash 图片上传脚本，它支持：

*   多次上传
*   拖放
*   每次上传的进度条
*   每次上传的小预览
*   可恢复下载
*   每次上传的可选首选项

所以像这个脚本：[jQuery-File-Upload](http://blueimp.github.com/jQuery-File-Upload/)

截图：

![在此处输入图像描述](../Images/0c53f97684ca475b40cd9c504d2b2908.png)

但是我需要为每次上传添加一些选项，例如：“标题”和“类别”，而不是我需要为每次上传运行一个函数，将提交的数据放入我的数据库中，有什么办法可以吗？做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:37:35.093

如果您使用 jQuery-File-Upload 附带的模板，您可以添加自己的字段，这些字段会在每个项目添加到队列时出现。插件需要了解这些字段，因此您可以使用回调添加更多数据：

```
$('#fileupload').bind('fileuploadsubmit', function (e, data) {
    // get content from the new input fields
    var inputs = data.context.find('select'); // or whatever inputs you added

    // assign values to data.formData
    // you can simply $.extend() the new inputs with $(this), and $.serializeArray() both
    data.formData = $.extend(inputs.serializeArray(), $(this).serializeArray());
}); 
```

有关更多信息，请参阅[此](https://github.com/blueimp/jQuery-File-Upload/wiki/How-to-submit-additional-Form-Data)。

# sql-server-2008 - 从 Sql Job 运行 SSIS 包的权限问题

> ID：10489392
> 
> 赞同：2
> 
> 时间：2012-05-07T21:27:06.143
> 
> 标签：sql-server-2008, permissions, ssis

我有一个 SSIS 包部署到 Sql Server 2008。这个包在 BIDS 以及存储包目录中的服务器中运行良好。一旦我将此包绑定到 sql 作业，我就会开始看到从 SSIS 包中访问特定文件的权限问题。因此，通过我的研究，我发现使用代理帐户可能是解决我的问题的方法。这些是我到目前为止采取的步骤：

1.  设置 Active Directory 用户帐户
2.  在安全性 - 凭据下 - 在步骤 1 中创建了与帐户绑定的凭据。
3.  在 Sql Server Agent - Proxies - SSIS Package Execution - 创建一个与上述凭据绑定的代理并选中“SQL Server Integration Services Package”复选框。
4.  在 msdb 数据库上创建了一个角色为“SQLAgentOperatorRole”、“SQLAgentReaderRole”、“SQLAgentUserRole”和“Public”的登录名。
5.  创建作业以运行我的 SSIS 包。作业所有者与第 4 步中创建的登录相关联。在我的作业的步骤属性下，我将类型设置为“Sql Server 集成服务包”，并将第 3 步中创建的代理帐户的运行方式选项设置为我的 SSIS包裹。
6.  从步骤 1 对 SSIS 包指向的文件夹/文件的访问权限授予帐户的完全控制权。

当我开始工作时，我不断得到错误：

以用户身份执行：“第 1 步中的帐户”- 无法加载包。用户登录失败：“第 1 步中的帐户”。无法加载包。

为了完成这项任务，我可能缺少什么步骤？

谢谢你的时间，比利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:00:52.617

想出了这个。通过在 sql sever 上设置与登录相同的 AD 帐户并使用与上述步骤 4 中相同的登录角色来解决。

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:01:15.973

您是否查看过 Windows 服务以查看运行 SQL Server 代理的帐户？如果该登录名（运行服务的登录名）有足够的权限在数据库上运行查询，那么您只需将服务登录名更改为您的登录名（出于测试目的）。完成后，重新启动服务并尝试一下。让我们知道你发现了什么。

# android - 使用带有 SQLite 数据库的 ListFragment 进行 Android 设计

> ID：10489394
> 
> 赞同：2
> 
> 时间：2012-05-07T21:27:16.340
> 
> 标签：android, android-fragments, sqliteopenhelper, android-listfragment

使用 SQLite 数据库实现 ListFragment 的最佳方法是什么。目前我已经创建了一个 DBAdapter 来促进打开、关闭和获取记录到 SimpleCursorAdapter 中。我有我的 MainActivity，它实现了一个带有导航选项卡的 ActionBar，我想为每个选项卡显示不同的 ListView。

这是我的 ListFragment：

```
public class MaterialsListFragment extends ListFragment {

public DBAdapter db;   

@Override
public View onCreateView(LayoutInflater inflater, 
ViewGroup container, Bundle savedInstanceState) { 

    return inflater.inflate(R.layout.portrait_material_view, container, false);
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // create new DBAdapter
    db = new DBAdapter(getActivity());
    db.open();

    Cursor c = db.getAllRecords();

    String[] from = new String[] { DBAdapter.KEY_IDNO, DBAdapter.KEY_MATERIAL };
    int[] to = new int[] { R.id.idno, R.id.materials };        

    // Now create an array adapter and set it to display using our row
    MyListAdapter materials = new MyListAdapter(this, R.layout.list_cell, c, from, to);
    setListAdapter(materials);
 } 
```

这是 MyListAdapter 代码，目前位于它自己的类文件中：

```
public class MyListAdapter extends SimpleCursorAdapter {

    public MyListAdapter(Context context, int layout, Cursor cursor, String[] from, int[] to) {
        super(context, layout , cursor, from, to);
    }

    @Override
    public void bindView(View view, Context context, Cursor cursor) {

        // Create the idno textview with background image
        TextView idno = (TextView) view.findViewById(R.id.idno);
        idno.setText(cursor.getSring(3));

        // create the material textview
        TextView materials = (TextView) view.findViewById(R.id.materials);
        materials.setText(cursor.getString(1));
    }
} 
```

这是解决这个问题的方法吗？如果您有任何建议，或者您知道任何好的例子，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T17:22:26.503

我能够让它发挥作用，所以我认为我走在正确的轨道上。我必须进行此修改才能使其运行，但它似乎运行良好。

```
 MyListAdapter materials = new MyListAdapter(getActivity(), R.layout.list_cell, c, from, to); 
```

我仍然会对改进这种方法的任何建议或方法感兴趣。

# jquery - 使用 html 或 js 在 html 输入中强制使用小数？面具

> ID：10489399
> 
> 赞同：1
> 
> 时间：2012-05-07T21:27:35.493
> 
> 标签：jquery, html, input, mask

所以我有一个输入，默认情况下我希望它的值为 0.00。很容易。

当用户开始输入时，我想从右边填写。所以当他们输入“5”时，输入将显示“0.05”。然后他们输入一个零，输入变为“0.50”，依此类推。因此，如果用户想输入 5 美元，他们只需输入 5、0、0。

有没有一种非常简单的方法可以做到这一点？我尝试过四处搜索，但我认为我的搜索词组缺少正确的关键字。我不知道该怎么称呼它，如果这是重复的，请见谅。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:32:35.000

您可以使用 jQuery 和 jQuery 插件轻松做到这一点。

一个简单的搜索产生了这个结果：[https ://github.com/madeinstefano/Decimal-Mask](https://github.com/madeinstefano/Decimal-Mask)

**编辑：** 在 Fiddle 中运行后，我发布的插件似乎并不完全符合您的要求。[http://jsfiddle.net/YAQMS/](http://jsfiddle.net/YAQMS/)

* * *

**更新：**我找到了一个更好的解决方案 - [https://github.com/digitalBush/jquery.maskedinput](https://github.com/digitalBush/jquery.maskedinput)

看到这个小提琴：http: [//jsfiddle.net/YAQMS/1/](http://jsfiddle.net/YAQMS/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:32:36.553

您可以像这样在 CSS 中将输入右对齐：

```
input#my_input {
  text-align: right;
} 
```

对于输入屏蔽，这里有一个谷歌搜索可能会有所帮助：[https ://www.google.com/search?q=html+input+masking](https://www.google.com/search?q=html+input+masking)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T22:31:31.510

meioMask[^(站点)](http://www.meiocodigo.com/projects/meiomask/) [^(github)](https://github.com/fabiomcosta/jquery-meiomask)有您正在搜索的内容。 在他们的网站上[演示。](http://www.meiocodigo.com/projects/meiomask/#mm_standalone)

# wpf - WPF 中的样式覆盖

> ID：10489400
> 
> 赞同：6
> 
> 时间：2012-05-07T21:27:38.630
> 
> 标签：wpf, xaml, styles

我正在使用[MahApps.Metro](http://mahapps.com/MahApps.Metro/)在我的应用程序中实现 Metro UI。

我有一个列表视图，MahApps.Metro 正在改变它的风格。列表视图的 MahApps 样式在[这里](https://github.com/MahApps/MahApps.Metro/blob/master/MahApps.Metro/Styles/Controls.ListView.xaml)。

加载样式：

```
<Window.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colours.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.AnimatedSingleRowTabControl.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/Blue.xaml" />
            <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseLight.xaml" />
            <ResourceDictionary Source="pack://application:,,,/FineRSS;component/Resources/Icons.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Window.Resources> 
```

我需要跟踪选定的 listviewitems，所以我使用下一种方法：

```
<ListView.ItemContainerStyle>
                <Style TargetType="{x:Type ListViewItem}">
                    <Setter Property="IsSelected" Value="{Binding Mode=TwoWay, Path=IsSelected}"/>
                </Style>
</ListView.ItemContainerStyle> 
```

但是 MahApps.Metro 的样式被覆盖为 ListView 的默认样式。

我可以做些什么来保持样式和 IsSelected 绑定？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-07T21:32:09.110

`Style`我不确定我是否遵循您要执行的操作，但是将您设置`BasedOn`为加载的默认值是否有意义？

就像是

```
<ListView.ItemContainerStyle> 
    <Style TargetType="{x:Type ListViewItem}" 
           BasedOn="{StaticResource {x:Type ListViewItem}}"> 
        <Setter Property="IsSelected" Value="{Binding Mode=TwoWay, Path=IsSelected}"/> 
    </Style> 
</ListView.ItemContainerStyle> 
```

# c++ - 搬家：需要什么？

> ID：10489401
> 
> 赞同：6
> 
> 时间：2012-05-07T21:27:38.967
> 
> 标签：c++, visual-c++, c++11, visual-studio-2012, move-semantics

使用 std::string 的移动赋值运算符（在 VC11 中）需要什么？

我希望它会自动使用，因为分配后不再需要 v 。在这种情况下需要 std::move 吗？如果是这样，我不妨使用非 C++11 交换。

```
#include <string>

struct user_t
{
    void set_name(std::string v)
    {
        name_ = v;
        // swap(name_, v);
        // name_ = std::move(v);
    }

    std::string name_;
};

int main()
{
    user_t u;
    u.set_name("Olaf");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-07T21:43:37.657

> 我希望它会自动使用，因为分配后不再需要 v 。在这种情况下需要 std::move 吗？

必须为左值明确说明运动，除非它们是从函数（按值）返回的。

这可以防止意外移动某些东西。记住：运动是一种破坏性的行为；你不希望它发生。

`name_ = v;`此外，如果根据这是否是函数中的最后一行来改变语义，那会很奇怪。毕竟，这是完全合法的代码：

```
name_ = v;
v[0] = 5; //Assuming v has at least one character. 
```

为什么第一行有时会执行一个副本，而有时会执行一次移动？

> 如果是这样，我不妨使用非 C++11 交换。

你可以随心所欲，但`std::move`意图更明显。我们知道它的含义以及您正在用它做什么。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-08T00:46:52.273

接受的答案是一个很好的答案（我已经赞成）。但我想更详细地解决这个问题：

> 我的问题的核心是：为什么它不自动选择移动赋值运算符？编译器知道 v 在赋值后没有使用，不是吗？还是 C++11 不需要编译器那么聪明？

在设计移动语义时考虑了这种可能性。在极端情况下，您可能希望编译器进行一些静态分析并尽可能从对象中移动：

```
void set_name(std::string v)
{
    name_ = v;  // move from v if it can be proven that some_event is false?
    if (some_event)
       f(v);
} 
```

最终要求编译器进行这种分析是非常棘手的。一些编译器可能能够证明，而其他编译器可能不能。从而导致代码不是真正可移植的。

好的，那么一些没有 if 语句的更简单的情况呢？

```
void foo()
{
    X x;
    Y y(x);
    X x2 = x;  // last use?  move?
} 
```

好吧，很难知道是否`y.~Y()`会通知`x`已被移出。一般来说：

```
void foo()
{
    X x;
    // ...
    // lots of code here
    // ...
    X x2 = x;  // last use?  move?
} 
```

编译器很难对此进行分析以知道`x`在复制构造后是否真的不再使用 to `x2`。

所以最初的“移动”提议给出了一个非常简单且非常保守的隐式移动规则：

> 只有在已经允许复制省略的情况下，左值才能被隐式移动。

例如：

```
#include <cassert>

struct X
{
    int i_;
    X() : i_(1) {}
    ~X() {i_ = 0;}
};

struct Y
{
    X* x_;
    Y() : x_(0) {}
    ~Y() {assert(x_ != 0); assert(x_->i_ != 0);}
};

X foo(bool some_test)
{
    Y y;
    X x;
    if (some_test)
    {
        X x2;
        return x2;
    }
    y.x_ = &x;
    return x;
}

int main()
{
    X x = foo(false);
} 
```

在这里，根据 C++98/03 规则，这个程序可能会或可能不会断言，这取决于是否`return x`发生复制省略。如果确实发生了，程序运行良好。如果没有发生，则程序断言。

因此有理由认为：当允许 RVO 时，我们已经处于无法保证`x`. 所以我们应该能够利用这个余地并从`x`. 风险看起来很小，收益看起来**很大**。这不仅意味着通过简单的重新编译，许多现有程序会变得更快，而且还意味着我们现在可以从工厂函数返回“仅移动”类型。这是一个非常大的收益风险比。

在标准化过程的后期，我们有点贪心，还说在返回按值参数时会发生隐式移动（并且类型与返回类型匹配）。这里的好处似乎也相对较大，尽管代码破坏的机会稍大一些，因为这不是 RVO 合法（或现在）合法的情况。但是我没有演示这种情况下的破解代码。

所以最终，你的核心问题的答案是移动语义的原始设计在破坏现有代码方面采取了非常保守的路线。如果不是这样，它肯定会在委员会中被击落。在这个过程的后期，有一些变化使设计更具侵略性。但到了这个时候，核心提案已经在标准中根深蒂固，得到了多数（但不是一致）的支持。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-07T21:39:07.080

在您的示例中，`set_name`按值获取字符串。`set_name`然而，里面`v` 是一个左值。让我们分别处理这些情况：

```
user_t u;
std::string str("Olaf");    // Creates string by copying a char const*.
u.set_name(std::move(str)); // Moves string. 
```

在内部`set_name`调用 的赋值运算符`std::string`，这会产生不必要的副本。但是还有一个[rvalue 重载](http://en.cppreference.com/w/cpp/string/basic_string/operator%3D)，`operator=`这在您的情况下更有意义：

```
void set_name(std::string v)
{
    name_ = std::move(v);
} 
```

这样，唯一发生的复制是字符串构造 ( `std::string("Olaf")`)。

# ruby-on-rails - 根据其他资源删除资源

> ID：10489409
> 
> 赞同：0
> 
> 时间：2012-05-07T21:28:26.290
> 
> 标签：ruby-on-rails

**我有用户和项目资源以及连接它们的连接表，称为 project_members。**我希望在所有用户离开项目时具有功能，项目会自行销毁，如下面的规范：

```
 75     it 'deletes the project when there are no more users on it' do
 76       lambda do
 77         project.users.clear 
 78       end.should change(Project, :count).by(-1)
 79     end 
```

到目前为止，我想出了这条线，但不知道放在哪里......

```
@project.destroy if @project.users.empty? 
```

编辑：这是我的模型

**用户模型（我正在使用设计）**

```
 1 class User < ActiveRecord::Base
  2 
  3   has_many :synapses #aka project_members      
  4   has_many :projects, :through => :synapses
  5 
  6   # Include default devise modules. Others available are:
  7   # :token_authenticatable, :encryptable, :lockable, :timeoutable and :omniauthable
  8   devise :database_authenticatable, :registerable,
  9          :recoverable, :rememberable, :trackable, :validatable,
 10          :confirmable      
 11   
 12   # Setup accessible (or protected) attributes for your model
 13   attr_accessible :email, :password, :password_confirmation, :remember_me
 14 end 
```

**项目模型**

```
 1 class Project < ActiveRecord::Base
  2 
  3   has_many :synapses
  4   has_many :users, :through => :synapses, :dependent => :nullify
  5   has_many :tasks, :dependent => :destroy
  6 
  7   #use this when you don't have callbacks
  8   #has_many :tasks, :dependent => :delete_all
  9 
 10   validates :name, :presence => true,
 11             :uniqueness => true
 12   validates :description, :presence => true
 13 
 14   attr_accessible :name, :description
 15 
 16 end 
```

**突触模型 AKA（项目成员）**

```
 1 class Synapse < ActiveRecord::Base
  2 
  3   belongs_to  :user,
  4               :class_name => 'User',          
  5               :foreign_key => 'user_id'       
  6   belongs_to  :project,
  7               :class_name => 'Project',       
  8               :foreign_key => 'project_id'    
  9   
 10 end 
```

**任务模型**

```
 1 class Task < ActiveRecord::Base
  2 
  3   belongs_to :project
  4   belongs_to :user
  5 
  6   validates :name, :presence => true
  7   validates :description, :presence => true,
  8                           :length => { :minimum => 10 }
  9 
 10   attr_accessible :name, :description
 11 
 12 end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:48:46.857

成员模型上的回调应该这样做：

```
class ProjectMember < ActiveRecord::Base
  after_destroy :remove_project_if_last_member
  private
    def remove_project_if_last_member
      project.destroy if project.users.empty?
    end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T22:10:50.830

首先，您的关系陈述可以简化：

```
belongs_to  :user,
  :class_name => 'User',          
  :foreign_key => 'user_id' 
```

可以变得简单

```
belongs_to  :user 
```

和属性默认`:class_name`为`:foreign_key`您拥有它们。

如果最后一个用户离开项目，您应该在 Synapses 类上放置一个回调来销毁项目。像这样的东西：

```
class Synapse < ActiveRecord::Base

  after_destroy :remove_project_if_last_member

  private

  def remove_project_if_last_member
    project.destroy if project.users.empty?
  end

end 
```

[注意：我从另一个答案中复制了 after_destroy 回调——如果那个已经很好了，那么编造一些东西是没有意义的。]

# r - 如何修改我的 R 代码来绘制这种甘特图？

> ID：10489411
> 
> 赞同：2
> 
> 时间：2012-05-07T21:28:34.267
> 
> 标签：r, plot, gantt-chart

大家

使用 R 中的以下代码，我显示了一个简单的甘特图：

```
dat <- read.csv2(text="start;duration
 1;4
 7;3
 15;2
 ")
 plot(NA, xlim=c(0,20), ylim=c(0,9), ylab="",xlab="X", xaxt="n", yaxt="n")
 with(dat, segments(x0=start, x1=start+duration, y0=2,y1=2))
 with(dat, text( start+duration/2, 2.5, labels=duration))
 axis(1, at=seq(0,20,by=2), labels=seq(0,20,by=2)) 
```

![在此处输入图像描述](../Images/5d5f0f85ed58e3cbbe3b1a68e6f75449.png)

现在我如何修改此代码以能够从`csv`文件中的这些数据中获取：

```
A; 2; 7;
B; 5; 10;
C; 5; 12;
D; 16; 22;
E; 18; 20; 
```

绘制这样的甘特图

![在此处输入图像描述](../Images/6629205d99f8dd38b4687d76772ba19b.png)

非常感谢，任何回复！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-07T22:59:12.063

扩展@Tyler Rinker 建议的答案：

```
library(ggplot2)

df <- read.table(text="Task, Start, End
A,2,7
B,5,10
C,5,12
D,16,22
E,18,20", 
                 header=TRUE,
                 sep = ',')

p <- ggplot(df, aes(colour=Task))
p <- p + theme_bw()
p <- p + geom_segment(aes(x=Start, 
                          xend=End, 
                          y=Task, 
                          yend=Task), 
                      size=2)
p <- p + geom_point(aes(x=Start,
                        y=Task),
                    size=5)
p <- p + geom_point(aes(x=End,
                        y=Task),
                    size=5)
p <- p + geom_text(aes(x=Start-0.5,
                       y=Task,
                       label=Task),
                   fontface="bold")
p <- p + opts(legend.position="None",
              panel.grid.major = theme_blank(),
              axis.text.y = theme_blank())
p <- p + xlab("Duration")
p 
```

产生：

![ggplot2甘特图](../Images/f4e978b109346c508a6e623dd34ca406.png)

**编辑以生成居中标签**

```
library(ggplot2)

df <- read.table(text="Task, Start, End
A,2,7
B,5,10
C,5,12
D,16,22
E,18,20", 
                 header=TRUE,
                 sep = ',')

df$TaskLabel <- df$Task
df$Task <- as.numeric(df$Task)

p <- ggplot(df, aes(colour=TaskLabel))
p <- p + theme_bw()
p <- p + geom_segment(aes(x=Start, 
                          xend=End, 
                          y=Task, 
                          yend=Task), 
                      size=2)
p <- p + geom_point(aes(x=Start,
                        y=Task),
                    size=5)
p <- p + geom_point(aes(x=End,
                        y=Task),
                    size=5)
p <- p + geom_text(aes(x=(Start+End)/2,
                       y=Task+0.25,
                       label=TaskLabel),
                   fontface="bold")
p <- p + opts(legend.position="None",
              panel.grid.major = theme_blank(),
              axis.text.y = theme_blank())
p <- p + xlab("Duration")
p 
```

这反过来产生：

![带有居中标签的ggplot2](../Images/ea6941e38fabc6121ade5f4e2f534161.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-01T14:02:36.540

使用包`vistime`：

```
install.packages('vistime')
library(vistime)
df <- read.table(text="Task, Start, End
A,2,7
B,5,10
C,5,12
D,16,22
E,18,20", header=TRUE, sep = ',')
df$Start <- as.Date("2017-01-01") + df$Start
df$End <- as.Date("2017-01-01") + df$End
vistime(df, start="Start", end="End", events="Task") 
```

[![在此处输入图像描述](../Images/74532e02af6c2df29986481fcbe87b49.png)](https://i.stack.imgur.com/nGxDp.jpg)

[https://github.com/shosaco/vistime](https://github.com/shosaco/vistime)

# java - 如何在 Eclipse 中将 Javadoc 导出为 .jar 文件？

> ID：10489413
> 
> 赞同：3
> 
> 时间：2012-05-07T21:28:41.697
> 
> 标签：java, javadoc

我终于完成了我的项目 JConsole Maker。我将所有 Javadoc 注释放入其中，然后准备导出 Javadoc。我只是不知道怎么做。我可以把它放到一个文件夹中，但是有没有什么特定的方法可以将它导出到 .jar 以便 Eclipse 开发人员也可以使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-28T21:54:26.533

我的答案与您的要求不完全相符，但这是一种使用相关 javadoc 构建项目 (JConsole Maker) 的 .jar 的方法：将 javadoc 生成到文件夹后，执行

文件 > 导出...> Java > Jar 文件并选中“导出 Java 源文件和资源”。

然后您的 javadoc 将与您的整个项目相关联。请注意，您的源文件也将包含在内...

# php - SVG 将组移动到其他组

> ID：10489414
> 
> 赞同：1
> 
> 时间：2012-05-07T21:28:42.243
> 
> 标签：php, xml, svg

想要将一个组移动到另一个组，但在某种程度上它最终会花费大量的执行时间，并且脚本永远不会结束。问题出在 foreach 循环休息函数中。我没有看到任何错误

```
<?php
// fouten laten zien
error_reporting(~0); 
ini_set('display_errors', 1); 

// test bestand
$bestand = "00000000346.svg";

// maak nieuwe dom
$dom = new DOMDocument; 

// laat svg in dom
$dom->load($bestand);

// krijg svg element
$svg = $dom->getElementsByTagName("svg")->item(0);

// toevoegen link attribute
$svg->setAttribute("xmlns:xlink", "http://www.w3.org/1999/xlink");

// maak script tag
$script = $dom->createElement("script");

// zet script link
$script->setAttribute("xlink:href", "svg_zoom_pan.js");

// toevoegen aan svg
$dom->documentElement->appendChild($script);

// maak groep tag
$svgroot = $dom->createElement("g");

// zet een id
$svgroot->setAttribute("id", "svgroot");

// toevoegen aan svg
$dom->documentElement->appendChild($svgroot);

// krijg alle groepen
$groups = $dom->getElementsByTagName("g");

// doorloop groepen
foreach($groups as $group) {

    if($group->getAttribute("id") != "svgroot") {

        // clone groep
        $cloned = $group->cloneNode(true);

        // toevoegen aan svgroot groep  
        $dom->getElementById("svgroot")->appendChild($cloned);

    }
}

// opslaan bestand
$dom->save("svg_" . $bestand);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T11:47:06.460

返回节点的`getElementsByTagName`实时列表。这意味着当您向文档添加更多组时，变量`$groups`将被更新以包含这些新组。

由于您正在循环遍历元素的活动列表并在每次迭代中添加一个更多元素，因此活动列表会更长并且循环将永远不会结束。

# silverlight - Silverlight / 服务器文件夹权限

> ID：10489421
> 
> 赞同：0
> 
> 时间：2012-05-07T21:29:20.837
> 
> 标签：silverlight, permissions, directory, file-permissions

我的 Silverlight 网站应该让客户端下载一个 zip 文件。zip 包含两个复制到临时文件夹的 pdf 文件，以及使用水晶报表创建的第三个 pdf 文件。在我的计算机上调试时，它运行良好。但是，我刚刚在远程服务器上发布了该项目，我无法下载该文件。

我不知道问题出在 silverlight 还是服务器上，因为我不是配置它的人。当我运行 fiddler 时，它会引发“访问文件夹被拒绝”错误。

我和服务器管理员都已经设置了从该文件夹写入和读取服务器每个帐户的权限，但仍然无法正常工作。

任何人都可以帮助解决这个问题，我似乎无法弄清楚问题是服务器还是silverlight。服务器正在运行 Windows Server 2008 R2 Standard。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T10:50:41.777

似乎它与 Silverlight 无关。

IIS 工作进程必须有权访问此文件夹（主要是一个名为 的组`{MachineName}\IIS_IUSRS`）。

如果您使用的是单点登录/模拟，则当前由网络 (Windows) 域控制器进行身份验证的实际用户必须有权访问该文件夹，这不是推荐的安全架构。

# c# - C#函数错误（对象引用）

> ID：10489422
> 
> 赞同：0
> 
> 时间：2012-05-07T21:29:22.933
> 
> 标签：c#, function, object, reference

非常直截了当的问题，当我在我的 main 中调用 Romberg 函数时，我在 Visual C# Express 中遇到了一个我不知道如何解决的错误（我在相应的行提供了错误消息）。我也尝试过使用 this.Romberg，但没有帮助。我应该怎么做？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Romberg2
{
    class test
    {
        // the function
        double f(double x)
        {
            double f;
            f=8*(Math.Sqrt(1-x*x)-x);
            return f;
        }

        // The Integration function
        void Romberg(double a, double b, int n, double[,] R)
        {
            int i, j, k;
            double h, sum;

            h = b - a;
            R[0,0]=(h/2)*(f(a)+f(b));

            for (i=1; i<=n; i++)
            {
                h=h/2;
                sum=0;

                for (k=1; k <= (Math.Pow(2.0,i)-1); k +=2)
                    sum +=f(a+k*h);

                R[i,0]=R[i-1,0]/2+sum*h;

                for(j=1; j<=i; j++)
                    R[i,j]=R[i,j-1]+(R[i,j-1]-R[i-1,j-1])/(Math.Pow(4.0,j)-1);
            }
        }

        static void main(int argc, char [] argv)
        {
            double[,] R = new double [10,10];
            int n=5, digits=13;
            double a=0, b=1/Math.Sqrt(2.0);

            // Call the integrating function
            Romberg(a, b, n, R);//ERROR: An object reference is required for the non-static field, method, or property

            // Printout the diagram
            for(int i=0; i<n; i++)
            {
                for(int j=0; j<=i; j++)
                {
                    Console.WriteLine(R[i,j] + " ");
                }
                Console.WriteLine("\n");
            }

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:32:19.447

Romberg 不是静态方法，因此您应该使用 new 关键字通过实例调用它

```
new test().Romberg(a, b, n, R); 
```

或者干脆把它变成一个静态函数

```
static void Romberg(double a, double b, int n, double[,] R) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:32:21.153

`main`是静态的，所以它不能调用实例方法。声明`Romberg`为静态，或创建一个实例`test`并使用该实例：

```
var inst = new test();
inst.Romberg(a, b, n, R); 
```

有关详细信息，请查看有关[静态类和静态类成员的 MSDN 文章。](http://msdn.microsoft.com/en-us/library/79b3xss3%28v=vs.80%29.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T21:32:22.863

`Main`是静态方法，`Roomberg`是实例方法。要么在内部创建类的新实例`Main`并通过实例调用它，要么`Roomberg`也将其设为静态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T21:41:26.293

三个问题：

1) Main 格式不正确。它需要采用以下格式之一：

```
static void Main() {...} 
static void Main(string[] args) {... } 
static int Main() {...} 
static int Main(string [] args) {...} 
```

只需将其更改为 'static void Main()'

2）使Romberg方法静态

```
static void Romberg(double a, double b, int n, double[,] R) 
```

3) 将 f 方法设为静态：

```
static double f(double x) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-07T21:32:16.780

你需要使你的`Romberg`函数静态，或者你可以将它包装在它自己的类中，实例化它并执行它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-07T21:32:26.083

您需要在实例上调用该方法。该方法属于该类的实例。

```
var inst = new test();
inst.Romberg(q, w, e, R); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-07T21:33:07.237

尝试这个。要调用`Romberg(a, b, n, R);`，您必须先创建`test`类对象。`Romberg`是一个实例方法。

```
test obj=new test();
obj.Romberg(a, b, n, R); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-07T21:33:37.143

您正在尝试从未初始化的类中调用方法。

```
 static void Romberg(double a, double b, int n, double[,] R) 
```

# ruby-on-rails - Ruby/Rails 时间辅助方法

> ID：10489426
> 
> 赞同：1
> 
> 时间：2012-05-07T21:29:52.950
> 
> 标签：ruby-on-rails, ruby

我正在寻找可以帮助我格式化时间助手的助手类/方法/宝石。传入 Time.now 实例后，我正在查看的输出类似于以下内容：

```
"1 minute ago" 
"2 minutes ago"
"1 hour ago"
"2 hours ago"
"1 day ago"
"2 days ago"
"over a year ago" 
```

我开始写这样的东西，但这将是漫长而痛苦的，我觉得这样的东西必须存在。唯一的问题是我需要它来使用我自己的措辞，所以需要一些带有格式化程序的东西。

```
 def time_ago_to_str(timestamp)
    minutes = (((Time.now.to_i - timestamp).abs)/60).round
    return nil if minutes < 0
    Rails.logger.debug("minutes #{minutes}")

    return "#{minutes} minute ago" if minutes == 1
    return "#{minutes} minutes ago" if minutes < 60
    # crap load more return statements to follow?
  end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-07T21:35:24.393

这样的助手已经存在并且内置在 Rails 中：

[http://apidock.com/rails/ActionView/Helpers/DateHelper/time_ago_in_words](http://apidock.com/rails/ActionView/Helpers/DateHelper/time_ago_in_words)

```
time_ago_in_words(5.days.ago)
=> "5 days" 
```

**编辑：**

如果您想自定义措辞，您可以创建自定义`I18n`语言环境，例如，我在以下位置创建了一个名为 time_ago 的语言环境`config/locales/time_ago.yml`：

```
time_ago:
  datetime:
     distance_in_words:
       half_a_minute: "half a minute"
       less_than_x_seconds:
         one:   "less than 1 second"
         other: "less than %{count} seconds"
       x_seconds:
         one:   "1 second"
         other: "%{count} seconds"
       less_than_x_minutes:
         one:   "less than a minute"
         other: "less than %{count} minutes"
       x_minutes:
         one:   "1 min"
         other: "%{count} mins"
       about_x_hours:
         one:   "about 1 hour"
         other: "about %{count} hours"
       x_days:
         one:   "1 day"
         other: "%{count} days"
       about_x_months:
         one:   "about 1 month"
         other: "about %{count} months"
       x_months:
         one:   "1 month"
         other: "%{count} months"
       about_x_years:
         one:   "about 1 year"
         other: "about %{count} years"
       over_x_years:
         one:   "over 1 year"
         other: "over %{count} years"
       almost_x_years:
         one:   "almost 1 year"
         other: "almost %{count} years" 
```

现在，您可以使用以下语言环境`distance_of_time_in_words`：

```
# distance_of_time_in_words(from_time, to_time = 0, include_seconds = false, options = {})
distance_of_time_in_words(5.minutes.ago, Time.now, true, {:locale => "time_ago"})
 => "5 mins" 
```

您当然可以将其添加到`config/locales/en.yml`应用程序范围内并完全覆盖它们，您可以`time_ago_in_words`如上所述调用！

# c# - 覆盖第 3 方嵌入式资源

> ID：10489428
> 
> 赞同：1
> 
> 时间：2012-05-07T21:30:01.713
> 
> 标签：c#, asp.net, .net

我在 MVC3 应用程序中使用 Microsoft.ReportViewer.WebForms 控件。ReportViewer 通过在同一个程序集中调用 HttpHandler 来获取它的 javascript。该处理程序返回存储为嵌入式资源的 javascript。

我的问题是它返回的 javascript 有一个错误，在某些情况下会导致 firefox 中的运行时错误。

我想覆盖返回的嵌入资源以使用我更正的 javascript。

我该怎么做呢？我查看了 resx 文件，但我不知道文件应该如何命名，它会去哪里等等......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:36:03.347

如果您知道错误，则可以自己更改功能。

```
function iHaveBug() { alert('buggy'); } 
```

然后你进来并在它加载后重写它：

```
iHaveBug = function() { alert('all better'); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:36:18.093

您需要使用更正后的 javascript 文件重建程序集，这并不像听起来那么难。这篇文章告诉你怎么做： http: [//fortheloveofcode.wordpress.com/2007/09/24/change-resources-inside-assembly/](http://fortheloveofcode.wordpress.com/2007/09/24/change-resources-inside-assembly/)

# java - 请Java PUT示例

> ID：10489430
> 
> 赞同：1
> 
> 时间：2012-05-07T21:30:14.690
> 
> 标签：java, desire2learn

我正在尝试向 valance 发送用户更新，并且我正在寻找一个如何执行 put 的示例，特别是更新用户的 put。

我环顾四周，但没有看到如何使用 UserContext 使用 Java 发送 json 块的示例。

任何指向文档的指针将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:33:50.980

在对此进行了修补之后，并得到了我同事的大量建议（我不确定他是否想被确认，所以我就叫他比尔）。我们想出了以下Java方法（确实应该拆分为单独的方法但可以理解）

```
private static String getValanceResult(ID2LUserContext userContext,
        URI uri, String query, String sPost, String sMethod, int attempts) {

    String sError = "Error: An Unknown Error has occurred";
    if (sMethod == null) {
        sMethod = "GET";
    }

    URLConnection connection;
    try {
        URL f = new URL(uri.toString() + query);

        //connection = uri.toURL().openConnection();
        connection = f.openConnection();
    } catch (NullPointerException e) {
        return "Error: Must Authenticate";
    } catch (MalformedURLException e) {
        return "Error: " + e.getMessage();
    } catch (IOException e) {
        return "Error: " + e.getMessage();
    }

    StringBuilder sb = new StringBuilder();

    try {
        // cast the connection to a HttpURLConnection so we can examin the
        // status code
        HttpURLConnection httpConnection = (HttpURLConnection) connection;
        httpConnection.setRequestMethod(sMethod);
        httpConnection.setConnectTimeout(20000);
        httpConnection.setReadTimeout(20000);
        httpConnection.setUseCaches(false);
        httpConnection.setDefaultUseCaches(false);
        httpConnection.setDoOutput(true);

        if (!"".equals(sPost)) {
            //setup connection
            httpConnection.setDoInput(true);
            httpConnection.setRequestProperty("Content-Type", "application/json");

            //execute connection and send xml to server
            OutputStreamWriter writer = new OutputStreamWriter(httpConnection.getOutputStream());
            writer.write(sPost);
            writer.flush();
            writer.close();
        }

        BufferedReader in;
        // if the status code is success then the body is read from the
        // input stream
        if (httpConnection.getResponseCode() == 200) {
            in = new BufferedReader(new InputStreamReader(
                    httpConnection.getInputStream()));
            // otherwise the body is read from the output stream
        } else {
            in = new BufferedReader(new InputStreamReader(
                    httpConnection.getErrorStream()));
        }

        String inputLine;
        while ((inputLine = in.readLine()) != null) {
            sb.append(inputLine);
        }
        in.close();

        // Determine the result of the rest call and automatically adjusts
        // the user context in case the timestamp was invalid
        int result = userContext.interpretResult(
                httpConnection.getResponseCode(), sb.toString());
        if (result == ID2LUserContext.RESULT_OKAY) {
            return sb.toString();
            // if the timestamp is invalid and we haven't exceeded the retry
            // limit then the call is made again with the adjusted timestamp
        } else if (result == userContext.RESULT_INVALID_TIMESTAMP
                && attempts > 0) {
            return getValanceResult(userContext, uri, query, sPost, sMethod, attempts - 1);
        } else {
            sError = sb + " " + result;
        }
    } catch (IllegalStateException e) {
        return "Error: Exception while parsing";
    } catch (FileNotFoundException e) {
        // 404
        return "Error: URI Incorrect";
    } catch (IOException e) {
    }
    return sError;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T21:54:25.497

我可以从使用 api 的项目中共享一个 php 代码片段（与 java 的粗略逻辑相同）。用户上下文只准备 url 和特定环境的框架（java 运行时或 php 库）用于发布和检索结果（在这种情况下它使用 php CURL）。

```
 $apiPath = "/d2l/api/le/" . VERSION. "/" . $courseid . "/content/isbn/";
        $uri = $opContext->createAuthenticatedUri ($apiPath, 'POST');
        $uri = str_replace ("https", "http", $uri);
        curl_setopt ($ch, CURLOPT_URL, $uri);
        curl_setopt ($ch, CURLOPT_POST, true);

        $response = curl_exec ($ch);
        $httpCode = curl_getinfo ($ch, CURLINFO_HTTP_CODE);
        $contentType = curl_getinfo ($ch, CURLINFO_CONTENT_TYPE);
        $responseCode = $opContext->handleResult ($response, $httpCode, $contentType);

        $ret = json_decode($response, true);

        if ($responseCode == D2LUserContext::RESULT_OKAY)
        {
            $ret = "$response";
            $tryAgain = false;
        }
        elseif ($responseCode == D2LUserContext::RESULT_INVALID_TIMESTAMP)
        {
            $tryAgain = true;
        }
        elseif (isset ($ret['Errors'][0]['Message']))
        {
            if ($ret['Errors'][0]['Message'] == "Invalid ISBN")
            {
                $allowedOrgId[] = $c;
            }
            $tryAgain = false;
        } 
```

发布消息的跟踪示例是：

```
PUT https://valence.desire2learn.com/d2l/api/lp/1.0/users/3691?x_b=TwULqrltMXvTE8utuLCN5O&x_a=L2Hd9WvDTcyiyu5n2AEgpg&x_d=OKuPjV-a0ZoSBuZvJkQLpFva2D59gNjTMiP8km6bdjk&x_c=UjCMpy1VNHsPCJOjKAE_92g1YqSxmebLHnQ0cbhoSPI&x_t=1336498251 HTTP/1.1
Accept-Encoding: gzip,deflate
Accept: application/json
Content-Type: application/json

{
"OrgDefinedId": "85033380",
"FirstName": "First",
"MiddleName": "Middle",
"LastName": "Last",
"ExternalEmail": "me@somehostname.com",
"UserName": "Username",
"Activation": {
        "IsActive": true
}
} 
```

# java - 创建可用作文件路径的字符串 - Eclipse / Android

> ID：10489432
> 
> 赞同：1
> 
> 时间：2012-05-07T21:30:32.057
> 
> 标签：java, android, eclipse, string, filepath

更多代码 - 这里创建的`R.string.c#### - c.####`字符串是我想作为 setText 运行的预定义字符串。

```
int Q1 = question1.getmCounter();
int Q2 = question2.getmCounter();
int Q3 = question3.getmCounter();
int Q4 = question4.getmCounter();

int qTotal = Q1 + Q2 + Q3 + Q4;
String Test5 = "R.string.c" + qTotal; 
```

这就是我现在得到我想要喂的“字符串”的方式。

```
 textOut = (TextView) findViewById(R.id.ChmpNametxt);
    textOut.setText(Test5); 
```

这就是我想喂它的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:52:47.417

您可以使用“getIdentifier”方法访问资源。它允许访问包的任何资源：

```
getResources().getIdentifier("c1123", "string", this.class.getPackageName()); 
```

您可以在第一个参数中传递任何变量，这对应于您的字符串的名称。第二个参数指定在哪些资源中搜索它（字符串、可绘制、布局......）。第三个参数是应用程序的包名。它指定使用哪个“R”。在您的情况下，您想查看应用程序中包含的资源（“R”）。

编辑：此方法返回一个 int，对应于您要查找的资源的 ID，例如 R.string.c1123

Edit2：这个 int 然后应该用作 setText 函数的参数。

所以完整的代码是：

```
int resId = getResources().getIdentifier("c" + qTotal, "string", this.class.getPackageName());
textOut.setText(resId); 
```

# java - 有没有办法改变 JOptionPane 布局，比如顶部的颜色和左上角的图像？

> ID：10489437
> 
> 赞同：4
> 
> 时间：2012-05-07T21:31:09.860
> 
> 标签：java, swing, joptionpane

我很好奇，我想知道是否有办法让 JOptionPane 的顶部变成不同的颜色，比如红色或橙色。我还想知道如何更改 JOptionPane 左侧的图像。我猜这是不可能的，因为它已经是 java 使用的一种方法。但我不是专家。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-07T21:37:12.667

这里有三个选项：

1.  使用使用相应消息类型的预定义图标之一：
    `JOptionPane.showMessageDialog(frame, "Eggs are not supposed to be green.", "Inane error", JOptionPane.ERROR_MESSAGE);`

2.  使用自定义图标：
    `JOptionPane.showMessageDialog(frame, "Eggs are not supposed to be green.", "Inane custom dialog", JOptionPane.INFORMATION_MESSAGE, icon);`

3.  使用外观在整个应用程序中使用一致的图标：[如何设置外观](http://docs.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html)

有关对话框的更多信息，请查看[Java 教程的此页面。](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-07T21:33:03.970

您可以将自己的 ImageIcon 添加到 JOptionPane ——查看 API，并尝试使用 Icon 字段调用方法，传入您自己的 ImageIcon 以查看其工作原理。您还可以创建一个复杂的 JPanel，一个完整的包含 GUI 的 JPanel，并使其成为 JOptionPane 的基础，只需将其作为方法的 Object 参数（通常是第二个参数）传递即可`JOptionPane.showXXX(...)`。

另一种选择是创建和使用您自己的模态 JDialog。

工作代码：

```
import java.awt.Color;
import javax.swing.*;

public class JOptionPaneExample
{
    private void createAndDisplayGUI()
    {
        JOptionPane.showMessageDialog(null, getOptionPanel(), "Modified JOptionPane : ", JOptionPane.PLAIN_MESSAGE);
    }

    public static void main(String... args)
    {   
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new JOptionPaneExample().createAndDisplayGUI();
            }
        });
    }

    private JPanel getOptionPanel()
    {
        JPanel panel = new JPanel();
        panel.setOpaque(true);
        panel.setBackground(Color.RED);
        try
        {
            java.net.URL url = new java.net.URL("http://gagandeepbali.uk.to/gaganisonline/images/swing/geek.gif");
            ImageIcon image = new ImageIcon(url);
            JLabel label = new JLabel("I am one MODIFIED JOPTIONPANE's LABEL.", image, JLabel.RIGHT);
            panel.add(label);
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
        return panel;
    }
} 
```

# html - Firefox 不支持 MP3 - 用户脚本/扩展的解决方法？

> ID：10489439
> 
> 赞同：3
> 
> 时间：2012-05-07T21:31:13.783
> 
> 标签：html, firefox, mp3, html5-audio

正如[为什么 Firefox 不支持 <audio> 中的 MP3 文件格式中所述](https://stackoverflow.com/q/4923136/427545)，Firefox 不支持`<audio>`. 出于某种原因，**第三方**网站不托管除 mp3 以外的文件，并使用如下代码嵌入 mp3 文件：

```
<object CLASSID="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6"
        width="1" height="1">
    <param name="URL" value="media/audio.mp3">
    <param name="autoStart" value="true">
</object> 
```

由于我的计算机文盲客户端不使用 Windows 而是使用 Ubuntu，这显然行不通。现在，由于我无法访问该服务器上的文件，因此我尝试创建一个 Greasemonkey 脚本，用脚本替换所有这些脚本`<audio>`，但随后 Firefox 12 抱怨 MP3 文件无法使用`<audio>`. Chromium 也无法播放。

作为一种解决方法，我尝试使用 VLC 插件替换它`<embed>`，但这次 Firefox 由于分段错误而崩溃。

因此，我正在寻找一种方法，该方法允许 MP3 文件中的音频在 Firefox 或 Chromium 浏览器中通过用户脚本或扩展名播放。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:59:34.167

老实说，音频播放仍然是（最不幸的是）Flash 是一个非常好的答案的情况之一。在 Flash 中播放音频的代码很简单，每个 Flash 实现（不仅仅是 Adob​​e 的，包括 Ubuntu 上可用的 FOSS 替代方案）都可以很好地处理它。

# opengl-es - OpenGL es - 看起来不像 3D，看起来更像 2D

> ID：10489446
> 
> 赞同：0
> 
> 时间：2012-05-07T21:31:37.347
> 
> 标签：opengl-es, 3d, 2d

试图制作一个球体。但它看起来不像 3D，实际上它看起来像一个平面的 2D 图片。我在这里想念什么？

![二维球体](../Images/4e66faf87d89e0fb27d009bd77a10896.png) 谢谢

```
std::vector<GLfloat> ballVerts;

for(int i = 0; i <= 40; i++)
{
    double lat0 = M_PI * (-0.5 + (double) (i - 1) / 40);
    double z0  = sin(lat0);
    double zr0 =  cos(lat0);

    double lat1 = M_PI * (-0.5 + (double) i / 40);
    double z1 = sin(lat1);
    double zr1 = cos(lat1);

    for(int j = 0; j <= 40; j++)
    {
        double lng = 2 * M_PI * (double) (j - 1) / 40;
        double x = cos(lng);
        double y = sin(lng);

        //  normals
        glNormal3f(x * zr0, y * zr0, z0);

        ballVerts.push_back(x * zr0); //X
        ballVerts.push_back(y * zr0); //Y
        ballVerts.push_back(z0);      //Z

        ballVerts.push_back(0.0f); 
        ballVerts.push_back(1.0f); 
        ballVerts.push_back(0.0f); 
        ballVerts.push_back(1.0f); //R,G,B,A

        //  normals
        glNormal3f(x * zr1, y * zr1, z1);

        ballVerts.push_back(x * zr1); //X
        ballVerts.push_back(y * zr1); //Y
        ballVerts.push_back(z1);      //Z

        ballVerts.push_back(0.0f); 
        ballVerts.push_back(1.0f); 
        ballVerts.push_back(0.0f); 
        ballVerts.push_back(1.0f); //R,G,B,A 
```

// 渲染代码此外，我正在旋转这个圆圈，旋转效果很好，因为我有光线变化，它给了我一个想法，它正在旋转并且实际上至少是一个圆圈

```
glRotatef(Angle, 1.0f, 0.5f, 0.3f);

glBindBuffer(GL_ARRAY_BUFFER, VertexBufferObject[2]);
glEnableClientState(GL_VERTEX_ARRAY);
glVertexPointer(3, GL_FLOAT, 7*4, 0);

glDrawArrays(GL_TRIANGLE_STRIP, 0, 3200);

glBindBuffer(GL_ARRAY_BUFFER, 0); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:48:37.760

首先，您需要检查当前是否启用了照明，`glGetIntegerv(GL_LIGHTING,&i)`并可能将其打开`glEnable(GL_LIGHTING)`。

然后设置`glMaterial(...)`, `glLightModel(...)`, `glLight(...)`, 有教程[http://www.cse.msu.edu/~cse872/tutorial3.html](http://www.cse.msu.edu/~cse872/tutorial3.html)

或者您可以使用自己的 GLSL 着色器来应用一些高级照明，这里有一些教程[http://www.lighthouse3d.com/opengl/glsl/](http://www.lighthouse3d.com/opengl/glsl/)

在一些琐碎的情况下，您可以只通过 glColor3f(...) 传递顶点颜色，而不是使用 GL 照明。

法线也应该是单位向量或启用归一化`glEnable(GL_NORMALIZE)`。

# sql - 在单个 SQL SELECT 语句中区分两行

> ID：10489447
> 
> 赞同：4
> 
> 时间：2012-05-07T21:31:37.623
> 
> 标签：sql, postgresql

我有一个数据库表，其结构如下所示：

```
CREATE TABLE dated_records (
              recdate DATE NOT NULL
              col1    DOUBLE NOT NULL,
              col2    DOUBLE NOT NULL,
              col3    DOUBLE NOT NULL,
              col4    DOUBLE NOT NULL,
              col5    DOUBLE NOT NULL,
              col6    DOUBLE NOT NULL,
              col7    DOUBLE NOT NULL,
              col8    DOUBLE NOT NULL
              ); 
```

我想编写一个 SQL 语句，允许我返回一条记录，其中包含两个提供的日期之间的更改，对于指定的列 - 例如 col1、col2 和 col3

例如，如果我想查看 col1、col2 和 col3 中的值在两个日期之间的时间间隔内发生了多少变化。这样做的一种愚蠢方法是（分别）为每个日期选择行，然后区分数据库服务器之外的字段 -

```
SQL1 = "SELECT col1, col2 col3 FROM dated_records WHERE recdate='2001-01-01'";
SQL1 = "SELECT col1, col2 col3 FROM dated_records WHERE recdate='2001-02-01'"; 
```

但是，我确信有一种更智能的方法可以使用纯 SQL 执行差分。我**猜**这将涉及使用自连接（可能还有嵌套子查询），但我可能过于复杂了 - 我决定最好在这里询问 SQL 专家，看看他们将如何解决这个问题最有效的方式。

理想情况下，SQL 应该与数据库无关，但如果需要将其绑定到特定数据库，那么它必须是 PostgreSQL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T21:36:11.253

只需选择两行，将它们合二为一，然后减去值：

```
select d1.recdate, d2.recdate,
       (d2.col1 - d1.col1) as delta_col1,
       (d2.col2 - d1.col2) as delta_col2,
       ...
from (select *
      from dated_records
      where recdate = <date1>
     ) d1 cross join
     (select *
      from dated_records
      where recdate = <date2>
     ) d2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:37:17.197

我认为，如果您要做的是获取不与两个选择查询相交的结果集行，则可以使用 EXCEPT 运算符：

> EXCEPT 运算符返回在第一个结果集中但不在第二个结果集中的行。

因此，您的两个查询将成为一个查询，其中包含 except 运算符：

```
SELECT col1, col2 col3 FROM dated_records WHERE recdate='2001-01-01'
EXCEPT
SELECT col1, col2 col3 FROM dated_records WHERE recdate='2001-02-01' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:52:43.673

You could use **window functions** plus **`DISTINCT`**:

```
SELECT DISTINCT
       first_value(recdate) OVER () AS date1
      ,last_value(recdate)  OVER () AS date2
      ,last_value(col1)     OVER () - first_value(col1) OVER () AS delta1
      ,last_value(col2)     OVER () - first_value(col2) OVER () AS delta2
       ...
FROM   dated_records
WHERE  recdate IN ('2001-01-01', '2001-01-03') 
```

For any two days. Uses a single index or table scan, so it should be fast.

I did not order the window, but all calculations use the same window, so the values are consistent.

This solution can easily be generalized for calculations between n rows. You may want to use `nth_value()` from the [Postgres arsenal of window functions](http://www.postgresql.org/docs/current/interactive/functions-window.html#FUNCTIONS-WINDOW-TABLE) in this case.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T03:47:13.203

This seemed a quicker way to write this if you are looking for a simple delta.

```
SELECT first(col1) - last(col1) AS delta_col1
, first(col2) - last(col2) AS delta_col2
FROM dated_records WHERE recdate IN ('2001-02-01', '2001-01-01') 
```

You may not know whether the first row or the second row comes first, but you can always wrap the answer in `abs(first(col1)-last(col1))`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-07T21:52:06.887

```
SELECT
COALESCE
(a.col1 -
  (
    SELECT b.col1
    FROM dated_records b
    WHERE b.id = a.id + 1
  ),
a.col1)
FROM dated_records a
WHERE recdate='2001-01-01'; 
```

# c# - 打印 Word Doc 或 PDF

> ID：10489450
> 
> 赞同：0
> 
> 时间：2012-05-07T21:31:59.610
> 
> 标签：c#, pdf, printing, ms-word, interop

我的程序需要一个 word doc 并使用 Codeplex DocX 开源应用程序对其进行操作。这很好用。

现在我需要打印它。我已经找了几个小时，但还没有找到打印文件 PDF 版本的好方法。我什至尝试使用 AcroRd32.exe，它只是简单笨重，不能真正用于严肃的应用程序。

我确实使用 Word.Interop 打印它，但这将我束缚在特定版本的 Word 上，更具体地说，是我机器上的版本。这使得我们的客户使用的较低版本无法工作，如果他们不在 2010 上，开发人员将无法编译。

我需要一种方法来无缝打印 pdf 或 word doc（2003 或更高版本），而不会像 Acrobat Reader 那样提示每个文档。

有人有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:11:51.767

我在过去的项目中使用以下库打印 PDF：

[http://www.debenu.com/products/development/debenu-pdf-library/](http://www.debenu.com/products/development/debenu-pdf-library/)

他们有一个免费的专业（商业）版本。这是一个很棒的图书馆，值得花小钱。

# javascript - JavaScript 原型链，使用 'self' 进行简单处理

> ID：10489453
> 
> 赞同：0
> 
> 时间：2012-05-07T21:32:11.943
> 
> 标签：javascript, inheritance, coffeescript, prototype

我开始喜欢下面的模式（抱歉，这里是 Coffeescript，因为在这种情况下它更具可读性）：

```
Parent = (proto)->
  self = Object.create proto
  public1 = ->
    console.log "in public1 with self: ", self
    console.log "in public1 with name: ", self.name

  self.public1 = public1
  self

Child = (proto)->
  self = new Parent proto

  private1 = ->
    console.log "in private1 with self: ", self
    console.log "in private1 with name: ", self.name
    self.public1()

  public2 = ->
    console.log "in public2 with self: ", self
    console.log "in public2 with name: ", self.name
    private1()

  self.public2 = public2
  self

GrandChild = (proto)->
  self = new Child proto

  public3 = ->
    console.log "in public3 with self", self
    console.log "in public3 with name: ", self.name
    self.public2()

  self.public3 = public3
  self

felix = new GrandChild name: "Felix"
felix.public2() 
```

多重继承的这种天真的尝试有效，并且可以简单且明显方便地使用“自我”……当您像我一样来自其他 oop 语言时，这很聪明。

陷阱：每个 GrandChild 对象都会创建一个 NEW Child 以及一个 NEW Parent 对象，因此如果创建了许多 GrandChild 对象，内存消耗就会增加。

据我所知，用 Child 和 Parent 的方法增强 GrandChild 的原型只会在 GrandChild 对象中引用他们的方法（并节省大量空间），但是向上和向下阅读我找不到像我一样访问 self 的方法与上层解决方案。

我知道 Coffeescript 本身在 JS 的原型继承之上提供了一个基于类的继承系统。其他库也提供解决方案。我想简单地了解如何根据用例选择正确的解决方案。

如果 - 例如 - 我想将 Child 的 private1 和 public2 放入原型中，以便引用而不是复制这些函数怎么办？

那时有人可以启发我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:34:19.893

> 陷阱：每个 GrandChild 对象都会创建一个 NEW Child 以及一个 NEW Parent 对象，因此如果创建了许多 GrandChild 对象，内存消耗就会增加。

错误的。你在这里所做的，比如说当你`new GrandChild`，是你实例化 a`Parent`然后用来自构造函数的方法装饰它`Child`，然后再次从`GrandChild`构造函数。从`Object.create proto`一直到孙子都是同一个对象。在这方面，您根本不会用虚拟对象乱扔您的上下文。

> 据我所知，用 Child 和 Parent 的方法增强 GrandChild 的原型只会在 GrandChild 对象中引用他们的方法（并节省大量空间），但是向上和向下阅读我找不到像我一样访问 self 的方法与上层解决方案。

基于闭包的私有方法和原型通常不能相处。当你在这样的构造函数中做这一切时，你可以有很大的灵活性，但是你会失去使用原型的优势（比如在新范围内不重新定义函数的速度）。

> 我知道 Coffeescript 本身在 JS 的原型继承之上提供了一个基于类的继承系统。其他库也提供解决方案。我想简单地了解如何根据用例选择正确的解决方案。

确实如此，并且在使用咖啡脚本时没有理由不使用它。有很多想法。但是私有方法同样会很棘手。通常私有方法只是简单地公开，但下划线前缀`Foo.prototype._privateMethod`表示它们的私有性。如果这还不够好，事情就会开始变得时髦。

> 如果 - 例如 - 我想将 Child 的 private1 和 public2 放入原型中，以便引用而不是复制这些函数怎么办？

公共方法可以进入原型并很好地传播，私有方法不多。Private 根本不是考虑 javascript 中事物的好方法，因为它不像其他语言那样受支持。相反，您有权访问的任何值（包括函数）要么通过局部变量或闭包在当前范围内，要么是通过局部变量或闭包在当前范围内的对象的属性。

* * *

编辑：

*最后，如果没有*`new`关键字，您在此处使用的模式会更好。由于您正在创建并返回一个任意对象，因此您不需要 JS 引擎为您创建一个。因此，如果您只是`new`从此处的代码中完全删除，您的代码应该可以工作。

构造函数有一个怪癖。当他们返回一个对象时，他们返回该对象而不是通过创建的对象`new`。在这里，您将返回`self`您自己通过`Object.create`. 如果构造函数返回一个非对象（字符串、数字、函数、null），它实际上会返回`this`。在咖啡脚本中，由于隐式返回表单函数，这可能会很棘手。并且当使用咖啡脚本类时，构造函数从不返回任何内容，让您可以处理这个奇怪的问题。

# cuda - 显示驱动程序本身使用哪些 CUDA 资源？

> ID：10489467
> 
> 赞同：1
> 
> 时间：2012-05-07T21:32:43.567
> 
> 标签：cuda, nvidia

我目前正在使用`CUDA`nVidia [GTX 480](http://www.geforce.com/hardware/desktop-gpus/geforce-gtx-480/specifications)进行开发。根据规范，该卡有 15 个流式多处理器 (SM)，`CUDA`每个具有 32 个内核。

我的代码适用于`N`每个具有 32 个内核的块。

理想情况下，如果`N <= 15`，我希望，因为每个块都可以分配给不同的 SM，所以每个块的运行速度与单个块一样快。对于“N > 15”，随着块开始共享 SM，每个单独块的性能应该会衰减。如果`maxocc`是我的内核的最大占用率，那么性能应该停滞不前`N > 15*maxocc`，因为并非所有块都可以在 SM 上调度。

这也*几乎*是我在实践中观察到的：每个单独块的性能开始衰减，`N = 12`性能停滞不前`N = 57`，即好像有三个额外的块占用了 SM。

我没有运行其他使用 GTX 480 的程序。但是，该卡连接到运行文本控制台的外部显示器，即不是 X-windows。

现在问题来了：有谁知道使用 GTX 480 驱动控制台是否占用`CUDA`资源？如果是这样，具体是多少？以及如何避免这种情况，即如何在不`CUDA`完全停用设备的情况下停用视频输出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T00:24:09.703

CUDA 架构不保证在 15 个 SM 设备上每个 SM 分配 15 个块。计算工作分配器可能会将 2 个块分配给多个 SM。Parallel Nsight 指令统计实验显示了每个 SM 启动的 Warps 和每个 SM 的活动周期的图表。在您的情况下，我相信您会发现分布是：9 个 SM 有 1 个块，3 个 SM 有 2 个块，3 个 SM 没有块。

如果您启动的块数少于 SM，则可以尝试通过将每个块的动态共享内存增加到 1/2 共享内存 + 1 字节来强制每个 SM 1 个块（这被指定为三尖括号中的第三个参数） . 这将强制每个 SM 占用一个块。如果您这样做并尝试运行并发内核，您可能会影响并发性。

在当前架构上，当内核运行时，CUDA 上下文独占使用所有 SM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T22:35:44.537

一堆猜测如下：

我猜旧的 CGA 文本模式是模拟的，所以费米芯片上没有专门的硬件。然后有可能在每个 vblank 处调用一个着色器来渲染 CGA 文本缓冲区的当前状态。

我还猜测这些卡不支持当时使用的低分辨率或单色颜色深度。结果是可能有很多 32 位像素必须以 60 FPS 的速度更新才能渲染 CGA 文本。

要尝试的一件事是添加另一个显卡或使用板载显卡（如果可用），这样您就可以在没有连接显示器的情况下运行 CUDA 卡。如果您尝试这样做，请确保在 PC BIOS 中将非 CUDA 卡设置为主显卡。

# git - git 命令行

> ID：10489471
> 
> 赞同：1
> 
> 时间：2012-05-07T21:32:54.567
> 
> 标签：git

我一直在为 Eclipse 使用 eGit，所以我不太了解如何使用 git 命令行。

现在我遇到了 eGit 的一些问题，想使用本地 git 命令来推送和拉取更新。

所以我打开了 git bash 并输入 `$ git pull`

```
$ git pull
error: refs/remotes/origin/master does not point to a valid object!
error: refs/tags/v2.0.2.84 does not point to a valid object!
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T00:20:29.310

“权限被拒绝（公钥）”：不要忘记 EGit 定义了在哪里可以找到您的公钥/私钥 ssh 密钥（来自[Egit 用户指南](http://wiki.eclipse.org/EGit/User_Guide#Eclipse_SSH_Configuration)）：

![EGit ssh 配置](../Images/5dcfcb28bdc785a16f09272ba263bab6.png)

在 git bash 中，您需要确保 id_rsa(.pub) 文件位于`$HOME/.ssh`.
如果是 msysgit Windows cmd shell，则需要定义`%HOME%`.

# php - 上传文件并使用 PHP 发送电子邮件？

> ID：10489472
> 
> 赞同：0
> 
> 时间：2012-05-07T21:32:58.923
> 
> 标签：php, html, email-attachments

用这个上传文件的最简单方法是什么：`<input type="file" name="clanlogo">`并将其通过电子邮件发送到“12345@email.com”我已经研究过，但发现了超级复杂的代码和东西。我需要它作为附件发送。在 PHP 中。这是我到目前为止的代码：

```
<?php

## CONFIG ##

# LIST EMAIL ADDRESS
$recipient = "my email Here";

# SUBJECT (Contact Form/Remove)
$subject = "Volunteer Form";

# RESULT PAGE
$location = "thank_you.html";

## FORM VALUES ##

# SENDER
$email = $_REQUEST['email'] ;

# MAIL BODY
$body .= "First Name: ".$_REQUEST['first_name']." \n";

$body .= "Last Name: ".$_REQUEST['last_name']." \n";

$body .= "Email: ".$_REQUEST['email']." \n";

$body .= "Volunteer Choice: ".$_REQUEST['dropdown']." \n";

$body .= "Questions: ".$_REQUEST['comments']." \n";
# add more fields here if required

## SEND MESSGAE ## 
```

我只需要添加一些代码即可上传文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:41:24.267

使用 html 表单并添加标签`<input type="file" name="uploaded">`，然后您可以像这样在 PHP 中处理文件：

```
<?php

$file = $_FILES['uploaded'];
if (move_uploaded_file($file['tmp_name'], $destination)) {
// do something
}
// do something

?> 
```

我不能写一个巨大的代码，这应该是你开始的动力！这是一个快速[指南](http://www.tizag.com/phpT/fileupload.php)。现在要附加它，您将其作为对服务器的 ajax 请求执行，存储文件的路径，然后在发送电子邮件时再次从数据库中提取路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:01:53.973

下载[PHPMailer](http://phpmailer.codeworxtech.com)类并尝试这个...

```
<html>
<head>
<title>PHPMailer - Mail() basic test</title>
</head>
<body>

<?php

require_once('class.phpmailer.php');

$mail = new PHPMailer();     
$mail->SetFrom('name@yourdomain.com', 'First Last');
$mail->AddReplyTo("name@yourdomain.com","First Last");

$address = "12345@email.com";
$mail->AddAddress($address, "John Doe");

$mail->Subject    = "PHPMailer Test Subject via mail()";

$mail->AltBody    = "To view the message, please use an HTML compatible email viewer!"; // optional

$mail->MsgHTML($body);

move_uploaded_file($_FILES["file"]["tmp_name"],$destination);

$mail->AddAttachment("$destination");  //Your attachment
//$mail->AddAttachment("images/phpmailer.gif");      // attachment
//$mail->AddAttachment("images/phpmailer_mini.gif"); // attachment

if(!$mail->Send()) {
  echo "Mailer Error: " . $mail->ErrorInfo;
} else {
  echo "Message sent!";
}

?>

</body>
</html> 
```

*   这是一个来自 PHPMailer 类的例子

# bash - 如何找到两个文件的设置差异？

> ID：10489473
> 
> 赞同：8
> 
> 时间：2012-05-07T21:33:01.833
> 
> 标签：bash, gnu-coreutils

我有两个文件 A 和 B。我想找到 A 中不在 B 中的所有行。在 bash/使用标准 linux 实用程序中最快的方法是什么？这是我到目前为止所尝试的：

```
for line in `cat file1`
 do
   if [ `grep -c "^$line$" file2` -eq 0]; then
   echo $line
   fi
 done 
```

它有效，但速度很慢。有没有更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-07T21:43:37.877

[BashFAQ](http://mywiki.wooledge.org/BashFAQ) [描述了使用 comm 进行此](http://mywiki.wooledge.org/BashFAQ/036)操作，这是规范正确的方法。

```
# Subtraction of file1 from file2
# (i.e., only the lines unique to file2)
comm -13 <(sort file1) <(sort file2) 
```

diff 不太适合这个任务，因为它试图对块而不是单独的行进行操作；因此，它必须使用的算法更复杂，内存效率更低。

comm自 SUS2 (1997) 以来一直[是单一 Unix 规范的一部分。](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/comm.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:43:34.700

如果您只想要在 file`A`中而不是 in 中的行`B`，您可以对文件进行排序，并将它们与 diff 进行比较。

```
sort A > A.sorted
sort B > B.sorted
diff -u A.sorted B.sorted | grep '^-' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T21:42:42.627

'diff' 程序是标准的 unix 程序，它查看文件之间的差异。

```
% cat A
a
b
c
d
% cat B
a
b
e
% diff A B
3,4c3
< c
< d
---
> e 
```

使用简单的 grep 和剪切，可以选择 A 中的行，而不是 B 中的行。请注意，剪切相当简单，行中的空格会将其丢弃……但概念就在那里。

```
% diff A B | grep '^<' | cut -f2 -d" "
c
d 
```

# sql-server - 我们可以不说“回滚”就回滚吗？

> ID：10489479
> 
> 赞同：2
> 
> 时间：2012-05-07T21:33:32.447
> 
> 标签：sql-server, sql-server-2005, transactions

我在 SQL Server 2005 中这样做。我有一个表，只有一个 int 类型的列，你不能在其中插入 char。

如果我运行它，我将在我的表中插入一行。

```
INSERT INTO TestTable VALUES(3)   --success 
INSERT INTO TestTable VALUES('b') --fail, cannot insert char 
```

如果我运行它，我将在我的表中插入零行。因此，事务将 2 个任务组合成一个执行单元。如果一项任务失败，则整个事务都会失败。

```
BEGIN TRANSACTION 
INSERT INTO TestTable VALUES(3)
INSERT INTO TestTable VALUES('b')
COMMIT TRANSACTION 
```

我的问题是： ROLLBACK TRANSACTION 似乎没用，因为我在上面的代码中没有 ROLLBACK 但它仍然被回滚......有人可以帮助我理解这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:45:24.483

在 SQL Server 中，默认情况下所有代码都在隐式事务中运行。如果您在一批中提交两个语句并且您启用了查询选项 XACT_ABORT，那么任何失败都应该回滚整个事务。默认行为是仅回滚导致错误的语句。如果您分批提交语句（通过在 SSMS 中单独突出显示它们并按 F5 或在其间放置“go”语句），我认为您会看到不同的行为。

# heroku - 如何在 Heroku 上使用 CNAME 设置自定义域而不会弄乱电子邮件服务？

> ID：10489481
> 
> 赞同：1
> 
> 时间：2012-05-07T21:33:46.713
> 
> 标签：heroku, dns, hosting

我有一个 Rails 应用程序上传到 Heroku，我想将它用于自定义域名。我在 1and1 上也有这个域名的电子邮件，我在其中注册了它，它一直在使用，需要继续工作。我尝试按照[本教程](http://blog.heroku.com/archives/2009/10/7/heroku_casts_setting_up_custom_domains/)进行操作，但它建议使用 Heroku 强烈反对的裸域。如果我不应该使用裸域（这样更好吗？），如何在保持电子邮件功能的同时改用 CNAME？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T02:57:09.697

您需要为要使用的每个“主机名”添加 CNAME 记录。例如，如果您想使用**www.yourdomain.com** ，则需要将 CNAME 记录添加到映射 www -> your-app-name.heroku.com 的 DNS 服务器（服务）。

然后，您的 DNS 服务器会将所有对 www.yourdomain.com 的请求定向到 DNS 名称 you-app-name.heroku.com，然后 Heroku 的 DNS 会处理映射到 IP 地址。

# sql - Red-Gate SQL 源代码控制 (SSC) 中的链接表 - 性能噩梦？

> ID：10489484
> 
> 赞同：6
> 
> 时间：2012-05-07T21:34:23.190
> 
> 标签：sql, version-control, redgate

我们的团队使用 Red-Gate SQL Source Control 作为我们的数据库 CM 工具。在执行快速测试以确定链接静态数据如何影响 SQL 源代码控制的速度后，我得到以下结果：

*   第一次运行——85 秒（26 个链接表，13.9MB 数据）
*   第二轮——14秒！(0 个链接表)

我从数据库中的 26 个链接表开始。SQL 源代码控制显示“提交更改”中的更改大约需要 85 秒。删除所有链接表后，只用了 14 秒。每次运行之前，我都会重新启动 SSMS。

1.  还有其他人有类似的问题吗？
2.  除了 SSC，您还会为 SQL DB CM 和存储静态数据推荐哪些其他工具/方法？（最好在更大的团队中易于设置和使用的东西）

在 Red Gate 修复链接静态数据的性能问题之前，我们正在考虑使用 SQL 脚本将数据置于源代码控制之下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T06:38:28.283

我们正在运行版本 3.0.12.3695 并且遇到完全相同的问题。此问题已在他们的论坛和支持团队中报告。如果您运行的是 3.0.12 版本，这可能会对您有所帮助：[一般性能](http://www.red-gate.com/messageboard/viewtopic.php?t=15256)

# ios - 脸书、iOS SDK

> ID：10489494
> 
> 赞同：0
> 
> 时间：2012-05-07T21:34:59.963
> 
> 标签：ios, facebook, facebook-graph-api, ios5, facebook-ios-sdk

我目前正在为 iOS 制作一个 Facebook 应用程序，它会提取个人资料提要并将其放入 UITableView。

现在当视图加载时：

```
 [facebook requestWithGraphPath:@"me/feed" andDelegate:self]; 
```

在 -(void)request:(FBRequest *)request didLoad:(id)result 中，我有：

```
NSArray *messagesFBData = [result objectForKey:@"data"];
NSMutableArray *friendIds = [NSMutableArray arrayWithCapacity:messagesFBData.count];
NSMutableArray *fromData = [NSMutableArray arrayWithCapacity:messagesFBData.count];
NSMutableArray *imagesLocal = [NSMutableArray arrayWithCapacity:messagesFBData.count];
for (int x = 0; x < messagesFBData.count; x++) {
    if ([(NSDictionary *)[messagesFBData objectAtIndex:x] objectForKey:@"message"] != nil) {

        [friendIds addObject:[((NSDictionary*)[messagesFBData objectAtIndex:x]) objectForKey:@"message"]];
        NSLog(@"loop Log: %@", [(NSDictionary *)[messagesFBData objectAtIndex:x] objectForKey:@"message"]);
        [fromData addObject:[((NSDictionary*)[messagesFBData objectAtIndex:x]) objectForKey:@"from"]];
        NSLog(@"%@", [((NSDictionary*)[messagesFBData objectAtIndex:x]) objectForKey:@"from"] );
        NSDictionary *fromDataDictionary = [fromData objectAtIndex:x]; 
        [imagesLocal addObject:[UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:[NSString stringWithFormat:@"https://graph.facebook.com/%@/picture", [fromDataDictionary objectForKey:@"id"]]]]]];
            NSLog(@"facebook ID: %@", [fromDataDictionary objectForKey:@"id"]);
    } else  
         {
             NSLog(@"Nil Called");                 
         }

}

// don't forget to call loadData for your tableView
messages = friendIds;
images = imagesLocal;
NSLog(@"Equalized");
self.facebookTableView.delegate = self;
NSLog(@"Delegate Set");
[facebookTableView reloadData]; 
```

images 是一个全局数组，所以我可以在 -(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 中访问它。

所以在 -(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath，我有：

```
NSLog(@"Cell For Row Called");
UITableViewCell *cell = [tableView 
                         dequeueReusableCellWithIdentifier:@"messageCell"];
NSString *story = [messages objectAtIndex:indexPath.row];
cell.textLabel.text = story;

UIImage *image = [images objectAtIndex:indexPath.row];
cell.imageView.image = image;

cell.alpha = 1;
return cell; 
```

所以我遇到的问题是当用户在墙上发布图片或视频时，我该如何处理？我想在 tableview 本身中显示图像/视频。现在，它只是崩溃了。任何帮助将不胜感激。

谢谢，维林德博拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:36:53.223

它在什么时候崩溃？您是否在代码中放置了任何断点？当您将 UIImage 添加到 imagesLocal 数组时，“https://graph.facebook.com/%@/picture”的路径是否包含有效图像？

# algorithm - graph - 如何使用 Tree Isomorphic 解决语言模式匹配问题？

> ID：10489495
> 
> 赞同：5
> 
> 时间：2012-05-07T21:35:04.643
> 
> 标签：algorithm, data-structures, graph, isomorphism

在[算法设计手册](http://www.algorist.com/)中，它说

> 您是否在测试两棵树是否同构？– 对于图同构的某些特殊情况，例如树和平面图，存在更快的算法。**也许最重要的案例是检测树之间的同构，这是语言模式匹配**和解析应用程序中出现的问题。解析树通常用于描述文本的结构；如果基础文本对具有相同的结构，则两个解析树将是同构的。

我只是希望有人能给我一个例子，说明如何使用树同构来解决语言模式匹配问题。即，如何将语言模式匹配映射到树同构问题？

通常，如何将字符串或文本构造为树并比较它们的身份？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T05:09:35.163

以英语为例，想法是一些英语句子可以用以下解析树表示：

```
 SENTENCE               SENTENCE
       /        \             /        \
  PROPER NOUN  VERB      COMMON NOUN  VERB
      /                    /    \
     NAME                ARTICLE NOUN 
```

英文短语“The dog barks”。然后可以解析如下

```
ARTICLE    NOUN      VERB
 /          /         /
The       dog       barks

    COMMON NOUN
     /      \
ARTICLE    NOUN      VERB
 /          /         /
The       dog       barks

            SENTENCE
             /     \
    COMMON NOUN     \
     /      \        \
ARTICLE    NOUN      VERB
 /          /         /
The       dog       barks 
```

另一个具有相同结构的句子是“一片叶子落下”。它的解析树看起来具有相同的形状，这意味着两个解析树将是同构的。也就是说，即使含义不同，它们也具有与句子相同的逻辑结构。

```
 SENTENCE
             /     \
    COMMON NOUN     \
     /      \        \
ARTICLE    NOUN      VERB
 /          /         /
A         leaf      falls 
```

如果忽略实际的物理单词，两个解析树也与一般模式同构，也表示为树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:48:02.967

如文中所述，**解析树**是这里的关键概念。解析树代表（以某种方式）文本的结构，从技术上讲，它**是**一棵树，因此您可以使用任何您喜欢的树算法来处理解析树。

> 解析树是一种有序的有根树，它根据某种形式语法表示字符串的句法结构。

[（关于解析树](http://en.wikipedia.org/wiki/Parse_tree)的维基百科文章）

# javascript - 更优雅/更有效的方式来连续获得 6 个连续的先前 DOM 元素？

> ID：10489502
> 
> 赞同：1
> 
> 时间：2012-05-07T21:36:04.063
> 
> 标签：javascript, jquery

假设我有一个存储在`$e`通过此选择器获得的 JQuery 对象：

```
var $e = $("input[type='text'][value='" + v + "']"); 
```

`v`表示`$(this).val()`我在`.each()`迭代中获得的，但实际上并不重要，它可以是任何数值。

我想创建一个 JQuery 元素集，其中包含`$e`、之后的 DOM 元素以及之前的 6 个 DOM 元素`$e`。

该函数本身工作得很好，我在每次迭代中都使用这个代码：

```
var $e = $("input[type='text'][value='" + v + "']");
$e = $e.add($e.next());
for (i=0;i<6;i++)
    $e = $e.add($e.prev());
$e.remove(); 
```

我想这有点难以解释，所以看看这个[JSFiddle](http://jsfiddle.net/ult_combo/Lf3xm/1/)。

我已经将上面的代码包装在一个绑定到按钮的匿名函数中，该`Remove line 2`按钮会将固定`v`值传递给我的脚本。

我是 JQuery 的初学者，即使在阅读了[JQuery Selectors 页面](http://api.jquery.com/category/selectors/)之后，我也找不到更简单的方法来做到这一点。我认为，如果我可以指定 jquery 对象数组的范围`.siblings()`，或者更具体地说[JQuery('prev ~siblings')](http://api.jquery.com/next-siblings-selector/)可以以更简单的方式执行此操作，但我无法弄清楚如何。

HTML 是通过我宁愿避免编辑的 PHP 模板生成的，因此我将接受不包括将给定元素包装在容器/包装器中的答案。

有没有更简单的方法来选择给定 JQuery 选择器的 6 个先前元素而不将它们包装在任何容器或包装器中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:45:28.417

你可以使用`siblings()`and `slice()`：

```
var $e = $("input:text[value='" + v + "']");    

$e.add( $e.siblings().slice(0, 5) ).add( $e.prev() ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:46:07.963

尝试使用`.prevAll`并切片您需要的元素。见下文，

[**演示**](http://jsfiddle.net/skram/Lf3xm/6/)

```
 var $prevAll = $e.prevAll();
    $e = $e.add($e.next()).add($prevAll.slice(0, 6)); 
```

**编辑：**添加`$e.add($e.next())`以添加下一个元素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T21:48:51.933

我不知道它会更好，但这是另一种选择：

```
 var $siblings = $e.siblings().andSelf();
    var index = $siblings.index($e);

    $siblings.slice(index-6,index+2).remove(); 
```

[http://jsfiddle.net/Lf3xm/5/](http://jsfiddle.net/Lf3xm/5/)

# javascript - 使用 jquery 动画使您的网站出现

> ID：10489507
> 
> 赞同：0
> 
> 时间：2012-05-07T21:36:34.423
> 
> 标签：javascript, jquery, css

我想知道如何让我的网站出现 jquery 动画，例如，如果

```
body {
visibility: hidden;
} 
```

我怎么能用jquery来做呢

```
body {
visibility: visible;
} 
```

但是让它像你可以动画一个对话框一样动画

```
show:"fold" 
```

有道理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:38:22.040

```
$('body').css({opacity: 0.0, visibility: "visible"}).animate({opacity: 1.0}); 
```

[JSFiddle 示例](http://jsfiddle.net/esqew/aBzXs/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T07:14:29.643

这是另一个解决方案

js：

```
$.fx.speeds._default = 1000;
$(document).ready(function () {$("body").show("slide");}); 
```

CSS：

```
body {
    display:none;
} 
```

使用此解决方案，您可以更改想要将“幻灯片”更改为任何其他 jQuery UI 效果的动画[http://jqueryui.com/demos/show/](http://jqueryui.com/demos/show/)

# wordpress - 限制对 Wordpress 中类别页面的访问

> ID：10489511
> 
> 赞同：0
> 
> 时间：2012-05-07T21:36:51.003
> 
> 标签：wordpress, categories, restrictions

我最近安装了 Jason Tadlock 的成员插件，它允许限制页面和帖子，但我已经为大多数页面使用类别页面构建了一个站点。谁能告诉我如何将这些限制应用于类别或将类别模板显示为“页面”。理想情况下，我希望链接也不要出现在导航中，这样那些没有访问权限的人就不会知道他们错过了什么。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:11:23.853

我快速浏览了该插件，看起来虽然它的意图不是专门针对分类页面，但您仍然可以在您的 category.php 模板中使用它的短代码功能来构建您想要的内容。

在没有看到您的代码的情况下，很难准确地为您提供所需的答案，但这应该可以让您朝着正确的方向开始：

```
<?php
$navigation = 'your_navigation_html';
$content = '[access role="editor"]'.$navigation.'[/access]';
echo do_shortcode($content);
?> 
```

此示例将对除编辑之外的所有人隐藏您的导航。

# javascript - 从 onclick 按钮事件原型或 jQuery 发布一组复选框

> ID：10489512
> 
> 赞同：0
> 
> 时间：2012-05-07T21:36:52.510
> 
> 标签：javascript, jquery, onclick, prototypejs

我有一个包含数据的行表和一个最左边的复选框。这是我的一行的 HTML

（复选框）：

```
<input type="checkbox" id="records[]" name="records[]" value="1" /> 
```

如您所见，该行有一个名为“records[]”的复选框，表示它是记录数组中的一个值数组。在我的 HTML 表格上方，我有一个按钮，当按下该按钮时，它将获取检查的记录并将其发布到新的 URL。我无法弄清楚如何做到这一点。仅供参考，表格和按钮不在表格中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:43:40.817

我假设您的 HTML 看起来像下面发布的内容，您的输入在表单中，但表格和按钮不在。

处理这种情况的一个技巧是将 onclick 事件处理程序绑定到您的按钮元素，然后调用表单本身中隐藏提交按钮的 click 方法。这有效地将您的按钮“链接”在一起。

```
<form action="/yourURL" name="yourForm" method="post">
    <input type="checkbox" id="records[]" name="records[]" value="1" />

    <input type="submit" style="display:none" id="submitBtn" />

</form>

<table>
    <button id="yourButton" value="click me" />

</table>

$('#yourButton').click(function() {
    $('#submitBtn').click();
} 
```

另一种方法是只调用表单对象本身的提交方法：

```
$('#yourButton').click(function() {
    $('[name="yourForm"]').submit();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:44:59.917

```
jQuery('#tableId input[type="checkbox"]') 
```

一点点jquery。这将从表中选择所有复选框项目。您可以使用 .val() 方法检查是否已检查。

# php - 改进搜索公式

> ID：10489520
> 
> 赞同：1
> 
> 时间：2012-05-07T21:37:37.047
> 
> 标签：php, mysql, sql, search

我想制作一个搜索脚本，我可以在其中搜索多个单词，但脚本会在所有行而不是特定行中找到单词。例如。

> ```
>  __________________________   ________
>  |Cheese                    | | Search |
>   ——————————————————————————   ———————— 
> ```

然后我制作了一个 php 脚本，上面写着：

> SELECT * FROM table WHERE column1 = "$value" OR column2 = "$value" OR column3 = "$value" ... ;

这将显示单词“Cheese”出现在任何列中的结果。问题是，我希望人们可以同时搜索“奶酪”和“厨房”，但我需要将这些词分开并搜索如下内容：

> SELECT * FROM table WHERE column1 = "$value" OR column2 = "$value" OR column3 = "$value" ... AND column1 = "$value2" OR column2 = "$value2" OR column3 = "$value2" 。 .. ;

问题是我真的不知道该怎么做。既不是单词分离，也不是如何在 SQL 数据库中找到单词。我也不知道如何搜索“Cheese”所属的单词……比如“Cheesecake”……

如果有人知道如何制作这个，请帮助我。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:47:10.073

您所有的 SQL 需求都是正确的括号：

```
SELECT *
FROM table
WHERE (column1 = "$value" OR column2 = "$value" OR column3 = "$value") AND
      (column1 = "$value2" OR column2 = "$value2" OR column3 = "$value2") 
```

“AND”在“OR”之前得到评估。

顺便说一句，必须搜索多个列表明您的数据模型可能存在缺陷。您可能需要一个表格结构，将每个单词放在单独的行中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T21:48:12.770

你会想看看 MySQL 的全文索引：[http ://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)

全文索引创建索引列中每个单词的索引（默认要求单词至少为 4 个字符，但这可以在 MySQL ini 文件中更改）。然后，您可以对多个单词进行搜索，包括单词的开头（cheese* 将匹配 cheesecake...但请记住，由于索引是按字母顺序排列的，因此无法使用索引来使“cake”匹配 cheesecake）。这样做的好处是：

1.  比一系列 AND () OR () 语句快得多
2.  能够返回相关性索引，因此您知道与所有关键字匹配 5 次的行比具有一个单词一次的行更相关，等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T21:48:31.600

不可能在一个子句中搜索整行。但是，您可以使用 LIKE 子句来搜索像“Cheese”这样的词，并让它们匹配“Cheesecake”。

这将变得比你想象的要复杂得多。我建议研究一下 MySQL 的 MyISAM 全文搜索之类的东西，或者如果您打算使用 Sphinx 之类的东西进行频繁搜索或处理大量数据。此外，如果您确实决定遵循当前路线，那么您正在寻找的是 LIKE 子句。

无论如何，要搜索包含奶酪或蛋糕的单词：

```
SELECT blah FROM tbl WHERE (col1 LIKE '%cheese%' OR col2 LIKE '%cheese%') AND (col1 LIKE 'cake' OR col2 LIKE 'cake'); 
```

虽然这是*非常*低效的。它不能使用索引，这意味着它需要对每个查询进行全表扫描。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T21:53:38.253

您在这些查询方面进展顺利。

最明显的缺失是 SQL 中的通配符运算符。这用于匹配部分字符串。例如，这将找到“芝士蛋糕”和“芝士饼干”记录：

```
SELECT *
FROM table
WHERE column1 = '%cheese%' 
```

处理搜索的更高级方法包括为要搜索的数据编制索引。要么自己做，要么使用第三方或特定的数据库工具。在谷歌中查找这个。

但是，对于没有被大量搜索命中的常规站点，您当前的方法很好。

还有一件事：如果您的问题是关于如何为搜索框中的每个单词自动添加额外的 SQL 行，您将需要了解更多信息。首先在 PHP 官方文档 (php.net) 中查找这些术语，

*   爆炸
*   前锋

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-07T21:49:13.050

为什么不检索您需要的所有数据并使用字符串函数来存储大海捞针中的搜索项目，我相信 stristr 会对您有所帮助，或者您可以只使用 SQL 查询，但这可能会给您的数据库带来压力。如我错了请纠正我。

# jquery - 将选定/找到的元素存储在变量中会提高性能吗？

> ID：10489525
> 
> 赞同：7
> 
> 时间：2012-05-07T21:38:09.730
> 
> 标签：jquery, performance, jquery-selectors

我创建了一个 jQuery 插件来修改我的导航。不幸的是，我必须访问和修改几乎所有的子元素，例如`<ul>`,等等。然后需要这些元素一到四次。`<li>``<a>`

我应该将它们全部存储在变量中还是应该像访问它们一样`$('.my-nav').find('li')`或`$('.my-nav').find('li')`在需要时访问它们？

为 25 行代码设置 5 个变量似乎是在浪费内存。但我不知道这是否是一个可以接受的权衡以获得更高的性能。

我创建了一个小提琴来说明什么意思：http: [//jsfiddle.net/Yj35Q/2/](http://jsfiddle.net/Yj35Q/2/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-07T21:43:48.267

缓存节点总是好的做法。您还可以使用[http://jsperf.com/对自己进行基准测试](http://jsperf.com/)

除非您要存储大量 DOM 树或其他东西，否则您实际上不需要担心变量需要多少存储空间。更相关的是 JS 引擎必须做的工作量来定位节点。

**编辑**
甚至更好，您可以找到其他人已经创建的现有测试用例
[http://jsperf.com/ns-jq-cached/4](http://jsperf.com/ns-jq-cached/4)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-07T22:50:29.353

无论您是否使用 jQuery，在适当的地方缓存 DOM 元素当然是明智的。

但是这个问题让我想到也许我们应该有一个插件来帮助解决这个问题。我四处寻找，一个也找不到。

所以我很快就写了一篇。这是一个[延迟加载的 jQuery 选择器](http://blog.bucketsoft.com/2012/05/lazy-loading-jquery-selector.html)......

```
(function($){
    var cachedObjects = new Array();

    $.lazy = function(selector) {
        if (typeof selector != "string" || arguments.length > 1) 
            return $.apply(this, arguments);

        var o = cachedObjects[selector];
        if (o == undefined)
        {
            o = $(selector);
            cachedObjects[selector] = o;
        }

        return o;
    };
})(jQuery); 
```

你会这样使用它...

```
$.lazy('.my-nav').show(); 
```

如果我忽略了什么，请告诉我。但我相信只要您选择的元素是静态的并且永远不会动态添加或删除，这将是很好的选择。

**更新**

我已经更改了代码以提高效率。而且，我已经`return $(selector)`在选择器不是字符串的时候添加了一行。因此，只有在选择器为字符串时，缓存才能起作用。

**更新#2**

现在`return $.apply(this, arguments)`，根据 jfriend00 的建议，您不只是简单地传递一个字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T21:52:39.767

在同一个函数中，我会将 DOM 搜索的结果缓存在一个局部变量中，这样我就不必在同一个函数中多次执行同一个 DOM 搜索。对于大多数函数来说，这不是必需的，但是仅在函数执行期间将结果放入局部变量中既简单又安全，所以我认为这是一个好习惯。

我通常不会仅仅因为我试图避免使用全局变量而将 DOM 节点缓存到全局变量中，而且在需要特定功能时检索 DOM 节点很少是性能问题。避免在全局变量中引用 DOM 的另一个原因是，如果某个特定的 DOM 节点从 DOM 中删除并且您打算将其作为垃圾回收，如果在全局变量中有对它的引用，则该 DOM 节点将不会被垃圾收集并可能导致内存泄漏。

在某些情况下，我会反复查找同一个 DOM 节点（例如在计时器上），我会将 DOM 节点缓存到函数闭包中的非全局变量中，然后在本地使用该变量。但是，我发现这种情况很少见。

# javascript - 如何为表单中的多个字段制作这个 ajax 检查器？

> ID：10489528
> 
> 赞同：0
> 
> 时间：2012-05-07T21:38:46.990
> 
> 标签：javascript, validation

我有下面的代码来验证表单。我如何做到这一点，以便我可以将代码重用于除用户名之外的其他字段？

我如何做到这一点，以便我可以拥有多个其他字段并使用相同的 jquery 代码进行验证？

```
<form name="form" id="form" class="form" action="success.html" 
onsubmit="return validate(this)" method="post">
<label for="username">User Name:</label>
<input type="text" name="username" id="username" />
<label for="fullname">Full Name:</label>
<input type="text" name="fullname" id="fullname" />
<input type="submit" value="Submit" class="submit" />
</form> 
```

这是jQuery：

```
// form validation function //
function validate(form) {
var username = form.username.value;
var usernameRegex = /^[a-zA-Z]+(([\'\,\.\- ][a-zA-Z ])?[a-zA-Z]*)*$/;

if(username == "") {
inlineMsg('username','You must enter your username.',2);
return false;
}
if(!username.match(usernameRegex)) {
inlineMsg('username','You have entered an invalid username.',2);
return false;
}

if(username.length>20){
inlineMsg('username','Username is too long (max 20 char)', 2);
return false;
}

return true;

}

// START OF MESSAGE SCRIPT //

var MSGTIMER = 20;
var MSGSPEED = 5;
var MSGOFFSET = 3;
var MSGHIDE = 3;

// build out the divs, set attributes and call the fade function
function inlineMsg(target,string,autohide) {
var msg;
var msgcontent;
if(!document.getElementById('msg')) {
msg = document.createElement('div');
msg.id = 'msg';
msgcontent = document.createElement('div');
msgcontent.id = 'msgcontent';
document.body.appendChild(msg);
msg.appendChild(msgcontent);
msg.style.filter = 'alpha(opacity=0)';
msg.style.opacity = 0;
msg.alpha = 0;
} else {
msg = document.getElementById('msg');
msgcontent = document.getElementById('msgcontent');
}
msgcontent.innerHTML = string;
msg.style.display = 'block';
var msgheight = msg.offsetHeight;
var targetdiv = document.getElementById(target);
targetdiv.focus();
var targetheight = targetdiv.offsetHeight;
var targetwidth = targetdiv.offsetWidth;
var topposition = topPosition(targetdiv) - ((msgheight - targetheight) / 2);
var leftposition = leftPosition(targetdiv) + targetwidth + MSGOFFSET;
msg.style.top = topposition + 'px';
msg.style.left = leftposition + 'px';
clearInterval(msg.timer);
msg.timer = setInterval("fadeMsg(1)", MSGTIMER);
if(!autohide) {
autohide = MSGHIDE;  
}
window.setTimeout("hideMsg()", (autohide * 1000));
}

// hide the form alert //
function hideMsg(msg) {
var msg = document.getElementById('msg');
if(!msg.timer) {
msg.timer = setInterval("fadeMsg(0)", MSGTIMER);
}
}

// face the message box //
function fadeMsg(flag) {
if(flag == null) {
flag = 1;
}
var msg = document.getElementById('msg');
var value;
if(flag == 1) {
value = msg.alpha + MSGSPEED;
} else {
value = msg.alpha - MSGSPEED;
}
msg.alpha = value;
msg.style.opacity = (value / 100);
msg.style.filter = 'alpha(opacity=' + value + ')';
if(value >= 99) {
clearInterval(msg.timer);
msg.timer = null;
} else if(value <= 1) {
msg.style.display = "none";
clearInterval(msg.timer);
}
}

// calculate the position of the element in relation to the left 
of the browser //
function leftPosition(target) {
var left = 0;
if(target.offsetParent) {
while(1) {
left += target.offsetLeft;
if(!target.offsetParent) {
break;
}
target = target.offsetParent;
}
} else if(target.x) {
left += target.x;
}
return left;
}
// calculate the position of the element in relation to the 
top of the browser window //
function topPosition(target) {
var top = 0;
if(target.offsetParent) {
while(1) {
top += target.offsetTop;
if(!target.offsetParent) {
break;
  }
  target = target.offsetParent;
}
} else if(target.y) {
top += target.y;
}
return top;
}

// preload the arrow //
if(document.images) {
arrow = new Image(7,80); 
arrow.src = "images/msg_arrow.gif"; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:23:35.907

这是我过去使用的一个插件： [https ://github.com/posabsolute/jQuery-Validation-Engine](https://github.com/posabsolute/jQuery-Validation-Engine)

看看那里，它可能对你有好处。我个人对其进行了修改以适应我的需要，但这有点极端。

您永远不必重新发明轮子:)

# asana - 使用 ASANA 上的 API 在项目中创建任务

> ID：10489534
> 
> 赞同：1
> 
> 时间：2012-05-07T21:39:13.397
> 
> 标签：asana

使用 ASANA API，我找不到创建附加到项目的未分配任务的方法。例如：我想在工作区“12345678”中创建一个任务“添加此功能”，并将其添加到项目“456789”中，而没有受让人。

有什么帮助吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:32:22.403

（我在 Asana 工作）

每个项目都属于一个工作区，并且该项目中的所有任务也必须在该工作区中。因此，同时指定项目和工作区将是多余的。

也就是说，如果您查看[任务文档](http://developer.asana.com/documentation/#tasks)，您会看到您可以`projects`在创建时指定一个数组来指示应该在哪些项目中创建新任务。

# python - 来自 AllegroGraph Python API 的 Prolog 查询中的 OWL 推理

> ID：10489540
> 
> 赞同：1
> 
> 时间：2012-05-07T21:39:36.733
> 
> 标签：python, prolog, triplestore, allegrograph

我注意到，在[这里](http://www.franz.com/agraph/support/documentation/3.2/python-tutorial.html#RDFS++%20Inference)的 AllegroGraph Python API 教程中，每当他们想使用 OWL 推理时，他们都会使用该`conn.getStatements`方法而不是发出 Prolog 或 SPARQL 查询。是否可以通过发出 Prolog 或 SPARQL 查询而不是使用该`conn.getStatements`方法从 OWL 推理器中推断出三元组？我尝试了一个 Prolog 查询：

`(select (?x ?y) (q ?x !ex:owned-by ?y))`

我将所有的定义为并且在我的商店中`owl:inverseOf ex:owns`有三重奏，但我没有得到任何结果。`ex:someone ex:owns ex:something`我确实从 using 中得到了结果`conn.getStatements`，所以我是否遗漏了 Prolog 查询中的一些重要内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T17:22:36.467

在调用评估之前，您是否对从 prepareTupleQuery 返回的查询对象调用了 setIncludeInferred？

[http://www.franz.com/agraph/support/documentation/v4/python-tutorial/python-API-40.html#Query%20Class](http://www.franz.com/agraph/support/documentation/v4/python-tutorial/python-API-40.html#Query%20Class)

IncludeInferred 默认为 False。我相信有效值是 false（无推理）、“rdfs++”或 True，以及“restriction”，如 infer http 查询参数的 HTTP REST 文档中所述。Python 实现只是传递值。

[http://www.franz.com/agraph/support/documentation/v4/http-protocol.html#header2-364](http://www.franz.com/agraph/support/documentation/v4/http-protocol.html#header2-364)

# plone - 在 Plone 中根据请求 ["PUBLISHED"] 获取已发布的内容项

> ID：10489544
> 
> 赞同：2
> 
> 时间：2012-05-07T21:39:53.880
> 
> 标签：plone, zope

我尝试从事件中获取 IPubAfterTraversal 挂钩中的上下文对象

```
@grok.subscribe(IPubAfterTraversal)
def admin_language_negotiator(event):
    """
    Event handler which pokes the language after traversing and authentication is done, but before rendering.
    """
    # Keep the current request language (negotiated on portal_languages)
    # untouched

    request = event.request

    if not IAddonSpecific.providedBy(request):
        # Add on is not active
        return

    context = request.get("PUBLISHED", None) 
```

我想做：

```
 IContentish.providedBy(context) # Check if real content request or CSS/Image request 
```

PUBLISHED 不是内容项上下文，但是：

```
 context
   <FSPageTemplate at /Plone/en/plan/plan/document_view> 
```

PUBLISHED 可能会或可能不会指向一个观点。从 HTTPRequest 中获取已发布的内容项对象（如果有）的最安全方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T21:55:12.640

plone.app.theming 是这样的：

```
def findContext(request):
    """Find the context from the request
    """
    published = request.get('PUBLISHED', None)
    context = getattr(published, '__parent__', None)
    if context is None:
        context = request.PARENTS[0]
    return context 
```

[https://github.com/plone/plone.app.theming/blob/master/src/plone/app/theming/utils.py#L146](https://github.com/plone/plone.app.theming/blob/master/src/plone/app/theming/utils.py#L146)

# text-editor - Sublime Text 2 高亮装订线

> ID：10489546
> 
> 赞同：9
> 
> 时间：2012-05-07T21:40:15.160
> 
> 标签：text-editor, sublimetext

默认情况下，当插入符号位于该行时，崇高文本 2 中的行号/装订线区域会突出显示。我怎样才能关闭它？

我看到了隐藏装订线的选项，但我希望行号可见。谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-10T07:02:48.360

要关闭行突出显示，请`preferences>settings - User`通过菜单并添加此行：

```
"highlight_line": false, 
```

然后保存。我`Monokai`在linux中使用默认主题，这将改变它：

![在此处输入图像描述](../Images/251765c68ed488956721d30c0cbb1714.png)

到：

![在此处输入图像描述](../Images/1392fcf5077f36358a7c89b3e1971d37.png)

如您所见，该行不再突出显示（它没有显示在图片中，但我的光标仍在该行上），但排水沟数字是。我想你也想摆脱它？所以，打开主题文件`.../sublime-text-2/Packages/Color Scheme - Default/Monokai.tmTheme`，改变`<key>lineHighlight</key>`颜色，和颜色一样`<key>background</key>`，即。`#3E3D32`去`#272822`，像这样：

![在此处输入图像描述](../Images/25f8e0a7415e9cb4f9a7e9677262b326.png) 保存时，它应该可以解决您的问题：

![在此处输入图像描述](../Images/08b82ec2f86aae07a583da81724a8067.png)

只有第二步是真正必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-15T09:59:28.390

一些补充

```
"font_size": 9.0,
"caret_style": "smooth",
"highlight_line": true,
"line_padding_bottom": 2,
"line_padding_top": 2,
"fade_fold_buttons": false, 
```

# scala - Scala Koans 中的 ===（三等号）运算符是什么？

> ID：10489548
> 
> 赞同：52
> 
> 时间：2012-05-07T21:40:16.657
> 
> 标签：scala, scalatest, scala-2.9

我开始通过[Scala Koans](http://www.scalakoans.org/)进行工作，它围绕一组单元测试组织，其中包含需要填写的空白。（这个想法是在类似的 Ruby Koans 项目之后建模的。）您启动 sbt 工具运行测试，它告诫：

```
[信息] + ***********************************************
[信息] +  
[信息] +  
[信息] +  
[信息] + 请冥想套件“AboutEmptyValues”的公案“无等于无”
[信息] +  
[信息] +  
[信息] +  
[信息] + ***********************************************

```

...所以你去看看这个单元测试，它说：

```
测试（“无等于无”）{
  断言（无 === __）
}

```

...并且，在冥想之后，你意识到你应该像这样填写空白：

```
测试（“无等于无”）{
  断言（无 === 无）
}

```

...然后它继续进行下一个单元测试。

不过，我的问题是，这个`===`运算符是什么？我似乎无法在任何地方找到它。这是 Scala Koans 项目本身定义的 DSL 运算符吗？还是它是 ScalaTest 框架的一部分？还是在Scala中？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-05-07T21:44:50.353

这是来自[ScalaTest](http://www.scalatest.org/)的三等号运算符。看看这个页面：[FunSuite 入门](http://www.scalatest.org/getting_started_with_fun_suite)。它说：

> ScalaTest 允许您使用 Scala 的断言语法，但定义了一个三等号运算符 (===) 以提供更好的错误消息。以下代码将给您一个错误，仅指示断言失败：
> 
> ```
> assert(1 == 2) 
> ```
> 
> 改用三等号会给您提供更多信息的错误消息，“1 不等于 2”：
> 
> ```
> assert(1 === 2) 
> ```

# asp.net - 在 ASP.NET 中动态创建表格，每个单元格中有多行文本，并且每个单元格都是可点击的

> ID：10489552
> 
> 赞同：1
> 
> 时间：2012-05-07T21:40:56.330
> 
> 标签：asp.net, custom-cell, clickable, monthcalendar

我正在尝试设计一个日历类型的表，该表是根据来自单独数据库源的数据动态构建的。

这是基本设计思想的说明：

这是一张图片：

![链接到图片](../Images/9e5e5057995c61514d6036e2c24d933f.png)

如果添加了引用星期六的对象，则将添加另一列，如果删除了星期一的对象，则该列将消失，反之亦然。

工作日是列标题，方块代表带有一些信息行的单元格。整个单元格中的每个单元格都应该是可点击的。

整个表格应该只显示一个月。

我认为这可能会非常耗时，如果设计不正确，很快就会变得无法重新阅读和理解。因此，如果有人有更简单的方法来实现日历的月视图，在每个单元格中存储一些信息行，并且可以调用`Server.Transfer()`单元格的点击事件，那将同样理想。

据我所知，[日历](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.calendar(v=vs.80).aspx)组件不支持编辑日历中单元格的内容，除此之外我真的不知道哪种方式是最好的方式。

如果我能以任何方式改进这个问题，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T14:34:58.783

我认为您想要的不是日历，而是调度程序控件，其中包括显示日历视图、添加/编辑“约会”并提供单击它们时发生的事件的功能。

[该线程](http://forums.asp.net/t/1532676.aspx/1)列出了许多您可以使用的此类调度程序控件，其中一些是免费的。

以下是一些实现类似功能的附加链接：

*   [http://www.rekenwonder.com/aspnet/schedule.html](http://www.rekenwonder.com/aspnet/schedule.html)
*   [http://www.codeproject.com/Articles/7619/Databound-Schedule-Controls](http://www.codeproject.com/Articles/7619/Databound-Schedule-Controls)
*   [http://www.codeproject.com/Articles/31766/DayPilot-Scheduler-Control-for-ASP-NET](http://www.codeproject.com/Articles/31766/DayPilot-Scheduler-Control-for-ASP-NET)

我认为重用其中一个组件并花一些时间研究它们会比从头开始实施您自己的解决方案所花费的时间要少得多。如果您想要的内容属于这些控件支持的常见 UI 模式，那么您会没事的。

另一方面，如果你想要的不是一种常见的做法，你可能会重新考虑你的方法。

# jquery - jQuery JSONP“没有方法'json'”解析错误

> ID：10489553
> 
> 赞同：1
> 
> 时间：2012-05-07T21:40:58.590
> 
> 标签：jquery, jsonp

我正在尝试使用 jQuery 1.7 进行 jsonp 调用，但是当调用返回时，我收到以下错误：

> 未捕获的 TypeError: 对象函数 ( response ) { responseContainer = [ response ]; 没有方法'json'

在检查返回的数据时，我注意到“.json”被附加到回调函数名称中：

```
jQuery17206211688306648284_1336426518269.json({"..."}) 
```

这是发出请求的代码：

```
$.ajax({
  url: "...",
  dataType: 'jsonp',
  success: function(data) {
    return console.log(data);
  }
}); 
```

**回答：**

正如**adeneo**所说，服务器试图指定'json'的回调函数，这是通过在$ .ajax调用上设置以下参数来处理的：

```
jsonpCallback: 'json' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:03:53.317

jQuery 的 $.ajax 函数会自动为 jsonp 请求添加回调函数，但看起来`json()`您看到的函数是由服务器添加的，但您可以尝试：

```
$.ajax({
  url: "...",
  dataType: 'jsonp',
  jsonp: false,
  success: function(data) {
    return console.log(data);
  }
}); 
```

要禁用 jQuery 自动回调，或者只是创建一个空的可链接函数，其名称为`json()`

# ruby-on-rails - 添加图像以设计 Mailer 模板

> ID：10489560
> 
> 赞同：3
> 
> 时间：2012-05-07T21:42:00.493
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise

我试图`image_tag "image.jpg"`从设计 Mailer 模板调用，但由于它发送了一封电子邮件，因此图像的路径在电子邮件中将显示为损坏。（不包括绝对网址）。

解决这个问题的最佳主意是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-07-03T04:22:57.187

在 Rails 4 中，最简单的方法是将以下内容添加到：

1.  配置/环境/development.rb

    config.action_mailer.asset_host = " [http://localhost:3000](http://localhost:3000) "

2.  配置/环境/production.rb

    config.action_mailer.asset_host = " [http://yourdomain.com](http://yourdomain.com) "

由于电子邮件不是托管在您的 Web 服务器上的页面，并且仅由您的应用程序中继到 smtp 或其他邮件服务器，因此这基本上会告诉 Rails 服务器您在哪里托管邮件资产。在大多数情况下，您希望从 rails 提供邮件资产，特别是从 rails 使用的相同资产路径。

这样做，您只需使用 image_tag 即可访问您的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:55:35.490

您可以为您的邮件设置 :host 属性，与构建链接的方式相同

要在全局范围内执行此操作，您可以在环境配置中执行此操作

```
config.action_mailer.default_url_options = { :host => "example.com" } 
```

看看[http://api.rubyonrails.org/classes/ActionMailer/Base.html](http://api.rubyonrails.org/classes/ActionMailer/Base.html)

了解更多信息

# list - Haskell - 列表操作

> ID：10489561
> 
> 赞同：-2
> 
> 时间：2012-05-07T21:42:11.340
> 
> 标签：list, haskell

我将如何在 Haskell 中执行以下操作？

```
INPUT: lst = [[("car", 40)],[("truck", 60)],[("motocycle", 50)],[("jeep", 60)]]

OUTPUT: newlst = [("car", 40),("truck", 60),("motocycle", 50),("jeep", 60)] 
```

我基本上希望能够将`INPUT`列表转换为`OUTPUT`列表。想到的一件事是使列表变平，但我似乎无法思考它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:44:33.100

使用[`concat`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v%3aconcat).

```
> concat [[("car", 40)],[("truck", 60)],[("motocycle", 50)],[("jeep", 60)]]
[("car",40),("truck",60),("motocycle",50),("jeep",60)] 
```

# php - cakephp：使用 saveAll()，导入的（非表单相关的）关联数据不保存

> ID：10489565
> 
> 赞同：0
> 
> 时间：2012-05-07T21:42:18.697
> 
> 标签：php, cakephp, save

我的问题与从远程源提取数据并将其保存到本地数据库有关。使用`saveAll()`，可以正确保存父数据，但不能正确保存子数据。

```
protected function _saveLocal($_rekeyedData) {
        //Set the invoice header and line items models
        if (!isset($this->LocalHeader)) {
            $this->loadModel('LocalHeader');
            $this->LocalHeader->create();
//            $this->LocalHeader->set($_rekeyedData);
            if (!isset($this->LocalDetail)) {
                $this->loadModel('LocalDetail');
                $this->LocalDetail->create();
            }
        }

        if ($this->LocalHeader->saveAll($_rekeyedData, array('validate' => 'first'))) {
            $this->Session->setFlash('Your data has been saved.');
        } else {
            $this->Session->setFlash('Data load failed.');
        }
        debug( $this->LocalDetail->invalidFields() );
    } 
```

在这个函数中，我加载模型，然后尝试`saveAll()`. 示例记录如下所示：

```
[1] => Array
    (
        [LocalHeader] => Array
            (
                [SOPNUMBE] => CR014076             
                [DUEDATE] => 2012-04-10 00:00:00
                [DOCDATE] => 2012-04-10 00:00:00
                [DOCAMNT] => 12000.00000
                [SUBTOTAL] => 12000.00000
            )

        [LocalDetail] => Array
            (
                [0] => Array
                    (
                        [ITEMNMBR] => BASIC SERVICE                  
                        [QUANTITY] => 1.00000
                        [UOFM] => EA       
                        [UNITPRCE] => 12000.00000
                        [TAXAMNT] => .00000
                        [CONTSTARTDTE] => 1900-01-01 00:00:00
                        [CONTENDDTE] => 1900-01-01 00:00:00
                        [SOPNUMBE] => CR014076             
                    )

            )

    ) 
```

保存的只是 LocalHeader 记录。我的预感是它与`array('validate' => 'first')`. 我想我需要在使用 validateMany 时做一些单独的事情`saveAll()`，但我不记得我在哪里看到过类似的东西，或者我只是编造的。

我已经阅读了 SO 中的许多相关问题，但所提供的解决方案都不适合我。

任何帮助表示赞赏。如果您有任何问题，请随时提问。

编辑：这是[标题模型](http://bin.cakephp.org/view/1995441861)，这是[详细模型](http://bin.cakephp.org/view/2053924863)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:23:01.947

我认为问题在于这些记录都不存在。根据文档

> 如果系统中不存在任何关联的模型记录（例如，您要同时保存新用户及其相关的个人资料记录），您需要先保存主模型或父模型。

您可以通过示例阅读更多[信息。](http://book.cakephp.org/2.0/en/models/saving-your-data.html#saving-related-model-data-hasone-hasmany-belongsto)

# javascript - jQuery 移动创建表没有正确循环通过 xml

> ID：10489566
> 
> 赞同：0
> 
> 时间：2012-05-07T21:42:30.543
> 
> 标签：javascript, jquery, xml, jquery-mobile

当我没有类或任何东西时，我的 xml 解析正在经历和循环，但我现在正在尝试使用 jquery mobile 对其进行样式设置。我必须以这种方式创建列表，以便在加载后由 jquery 应用样式。但它只加载列表中的第一个结果。如果我提醒 $(this).text() 我得到 5 个正确的响应。但是下面的代码不起作用。

```
$(document).ready(function() {

                             $.ajax({
                                    type: 'GET',
                                    url: 'test.xml',
                                    dataType: 'xml',
                                    success: function(xmlDoc) {
                                    var $xml = $(xmlDoc);
                                    $xml.find('FirstName').each(function() {
                                                                $("#list").html('<li ><a href="acura.html">' + $(this).text() + '</a></li>');
                                                                $("#list").listview('refresh');
                                                                });

                                    }
                                    });

            }); 
```

继承人的html：

```
 <body>
        <div data-role="page">

            <div data-role="header">
                <h1>Deep Web</h1>
            </div><!-- /header -->

           <ul id="list" data-role="listview"></ul><!-- /content -->

            <div data-role="footer">
                <h4>Footer content</h4>
            </div><!-- /footer -->

        </div>
    </body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:52:41.047

```
 $("#list").html('<li ><a href="acura.html">' + $(this).text() + '</a></li>'); 
```

在这里，您在每个循环中设置一个新的 html，

改成这样

```
 $("#list").append('<li ><a href="acura.html">' + $(this).text() + '</a></li>'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:54:24.023

`.html(SONETHING)`和做是一样的`.empty().append(SOMETHING)`。你应该做的是缓冲你将追加到 DOM 的内容并一次性追加，因为这是一个昂贵的过程。

```
 $.ajax({
                                type: 'GET',
                                url: 'test.xml',
                                dataType: 'xml',
                                success: function(xmlDoc) {
                                    var $xml = $(xmlDoc),
                                        out  = [];//create array to buffer output
                                    $xml.find('FirstName').each(function() {

                                        //add this index to the buffer array
                                        out.push('<li ><a href="acura.html">' + $(this).text() + '</a></li>');
                                    });

                                    //select the #list element only once, replace the HTML all at once, then refresh
                                    $("#list").html(out.join('')).listview('refresh');

                                }
                        }); 
```

了解如何使用数组存储一堆组合在一起的 HTML 字符串。此外，如果您只想添加新的列表项而不是覆盖现有的列表项，您可以`.html()`用`.append()`.

文档`.append()`：[http ://api.jquery.com/append](http://api.jquery.com/append)

# objective-c - 在 Xcode 4.3 中仅调试 Obj-C/C？

> ID：10489572
> 
> 赞同：14
> 
> 时间：2012-05-07T21:43:21.090
> 
> 标签：objective-c, xcode, ios5, automatic-ref-counting

现在我已经升级到 Lion 和 Xcode 4.3.x，调试器正在进入 ARC 的内容。所以我看到一个满屏

```
libobjc.A.dylib`objc_retainAutoreleasedReturnValue:
0x1de7fe0:  pushl  %ebp 
```

and `pushl`and and `movl`and `subl`etc. 不幸的是我不能用符号表示这些，我也不关心调试苹果的东西。有没有办法让调试器只关注我实际拥有的代码？

我正在使用 LLDB，但 GDB 也会发生同样的事情。

**编辑：**这也发生在 AppCode 上，它说明了一些事情（但我不知道是什么）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T03:36:11.017

这可能不是您想听到的，但是从 Xcode 4.5.2（Xcode 的当前版本，或者至少是我拥有的最新版本；）开始，我不相信调试器可以自动跳过Apple 的内部说明。我不认为这与 ARC 特别有关，而与最新版本的调试器的工作方式有关。

以下是我在调试时解决这个问题的方法：

1）您可以使用“跳过”按钮继续下一段代码（您可能必须这样做几次才能摆脱Apple的东西）。

2）您可以在您正在调试的代码之前和之后放置一个断点。这样，您可以使用“播放”按钮，而不是使用跳过按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T14:08:56.103

我还没有使用 ARC，但我记得读过这篇文章，其中可能有一些关于配置调试器的线索，可能会有所帮助：

[http://brian-webster.tumblr.com/post/20941658970/debugging-an-arc-mac-application-on-snow-leopard](http://brian-webster.tumblr.com/post/20941658970/debugging-an-arc-mac-application-on-snow-leopard)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T17:15:36.577

虽然您发布的消息与 ARC 相关，但此行为与 ARC 无关；有些东西只是将调试器放入汇编指令中。使用调试器中的 Step Out 按钮实际上是您想要将您拉回到自己的代码中。

# excel - 如何从 Excel 函数参数对话框中获取参数

> ID：10489574
> 
> 赞同：0
> 
> 时间：2012-05-07T21:43:37.557
> 
> 标签：excel, parameters, user-defined-functions, excel-formula

我为 MyUDF 创建了一个自定义函数参数对话框，当用户单击带有公式“=MyUDF(parameter1, parameter2)”的单元格时，我希望能够将参数值传递给自定义对话框。我可以使用正则表达式解析公式字符串，但如果有嵌套函数或公式中的语句，则很难解析。我正在查看 Excel 内置对话框 xlDialogFunctionWizard 并希望我可以从内置对话框中获取参数而不显示它。
var dialog = XLApp.Dialogs[XlBuiltInDialog.xlDialogFunctionWizard]; 但似乎内置对话框没有公开参数。所以我想知道是否有更好的方法从公式字符串中获取参数值？谢谢

# objective-c - NSManagedObject 的自定义初始化程序

> ID：10489578
> 
> 赞同：2
> 
> 时间：2012-05-07T21:43:47.967
> 
> 标签：objective-c, ios, cocoa, core-data, nsmanagedobject

根据文档：

> 您不应该覆盖 init。不鼓励您覆盖 initWithEntity:insertIntoManagedObjectContext：

您应该改用 awakeFromInsert 或 awakeFromFetch。

如果我想要做的只是将某个属性设置为当前日期或类似日期，这很好，但是如果我想发送另一个对象并根据其信息设置属性怎么办？

例如，在一个名为“Item”的 NSManagedObject 子类中，我想要一个 initFromOtherThing:(Thing *)thing，其中项目的名称设置为该事物的名称。我想避免“只需记住”每次在创建项目后立即设置名称，并且当我决定我希望 Item 还基于 Thing 设置另一个默认属性时必须更新十五个不同的控制器类。这些是与模型相关的操作。

我该怎么处理这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:54:27.690

我认为处理这个问题的最好方法是继承 NSManagedObject，然后创建一个类别来保存你想要添加到对象的内容。例如，一些用于唯一且方便地创建的类方法：

```
+ (item *) findItemRelatedToOtherThing: (Thing *) existingThing inManagedObjectContext *) context {
    item *foundItem = nil;
    // Do NSFetchRequest to see if this item already exists...
    return foundItem;
}

+ (item *) itemWithOtherThing: (Thing *) existingThing inContext: (NSManagedObjectContext *) context {
    item *theItem;
    if( !(theItem = [self findItemRelatedToOtherThing: existingThing inManagedObjectContext: context]) ) {
        NSLog( @"Creating a new item for Thing %@", existingThing );
        theItem = [NSEntityDescription insertNewObjectForEntityForName: @"item" inManagedObjectContext: context];
        theItem.whateverYouWant = existingThing.whateverItHas;
    }
    return theItem; 
} 
```

现在永远不要`initWithEntity:insertIntoManagedObjectContext:`直接调用，只需使用您的便利类方法，例如：

```
item *newItem = [item itemWithOtherThing: oldThing inContext: currentContext]; 
```

# c# - C# 和 Kinect 手势时间

> ID：10489581
> 
> 赞同：1
> 
> 时间：2012-05-07T21:43:50.690
> 
> 标签：c#, kinect, gesture

我目前正在使用 Kinect SDK 在 C# 中开发一些手势识别。到目前为止一切都很好，唯一的问题是手势识别是即时的。

例如：当我将手举过头顶时，我正在使用消息框宣布。如果我握住手2秒钟，它将打开数十个消息框宣布手势。

有没有办法阻止这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T06:37:51.927

达伦说的是实话。您需要实现停止机制。Kinect 一直在实时分析所有内容，因此当您的手在上方时，它一直在那里，直到它在那里 :) 所以每次触发您的动作时。照阿图尔斯说的做，或者照我喜欢的做。我更喜欢创建一个布尔标志。默认值为假。当我的动作被触发时，我将其设置为 true，并且`t trigger the action again until the flag is false. In your example I would set it to true when I raise my hand above the head and set it to false when I have my hand below my head. That way I`每次我需要它时我只会触发一次动作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:50:37.543

我想如果手在你的头上，你只是触发了这个事件。这还不够。

只需在识别手势时触发消息框一次，然后重置您拥有的任何检查算法的机制。每当您的手移到头下时，您都需要重新开始手势检查。你如何做到这一点取决于你如何实现手势识别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T22:29:04.353

您可以检查 MinimumPeriodBetweenGestures 作为实现 @Kinect [Toolbox](http://kinecttoolbox.codeplex.com)。同样，您可以根据您的要求定义标准。

# stream - 流与单子

> ID：10489584
> 
> 赞同：15
> 
> 时间：2012-05-07T21:44:10.277
> 
> 标签：stream, scheme, monads, categories, lazy-evaluation

流（惰性列表）和单子之间是否存在任何区别？从概念和数学的角度来看，而不是从技术实现的角度来看。

或者，是否存在双唯一的、一一对应的关系？

更准确地说，作为流，它意味着来自Scheme 语言的[SRFI-41](http://srfi.schemers.org/srfi-41/srfi-41.html)的“偶数流” 。

它是单子以外的另一个类别吗？如果是这样，它是什么类别？

“偶数流”可以保证对副作用的控制，比如单子吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T08:50:04.477

正如 Salil 已经说过的，这两者是不同的概念：

**流**是（可能是无限的）值列表，通常但不一定以惰性方式计算，即仅在请求时存储某种计算值的方式。周围有很多不涉及单子的例子：

```
(define integers (cons-stream 1 (stream-map (lambda (x) (+ x 1)) integers)) 
```

将有限的、预先计算的列表视为流也非常有用，因为您可以在任何可以使用（可能或必然）有限惰性流的地方使用它们。

因此，流是具有`next: streamType -> (valueType streamType)`获取下一个值和剩余流的操作的东西。

**另一方面， Monad 与其说**是一种数据结构，不如说是一种通过组合单个命令来编写源代码的方式。

可能最简单有用的例子是“Maybe monad”——我不确定它在 Scheme 中会是什么样子，对不起，但想法是：给定一个计算列表`(f g h)`和一个输入`x`，按顺序执行计算，几乎就像如果给定`(f (g (h x)))`，但让每个函数优雅地失败：如果`g`返回`nil`，不要调用`(f nil)`，而是`nil`立即返回。

当然，您可以以各种有用的方式将两者结合起来，并使用 monad 计算您的流值，或者封装像 I/O 流这样的流的使用，这些流并不完全符合 monad 中函数式编程的期望（以避免代码存储引用流的某些先前状态），但它们的用途完全不同。想想抽象层（关闭封面，不要看内部）：一个单子，应用于函数，给你一个函数。另一方面，流不是更高的函数，而是值列表。

显然，由 monad 定义（或返回，取决于您的观点）的函数可以是流的实现，而且从流中提取的值也可以是 monad。但正如你在上面看到的，有一些 monad 实现了与流完全不同的东西。是否存在未作为 monad 实现的流可能取决于您使用该术语的确切含义。我必须承认，目前我不确定无限流是否适合单子；有限列表显然可以。

# mysql - MySQL触发器+设置变量

> ID：10489585
> 
> 赞同：0
> 
> 时间：2012-05-07T21:44:10.543
> 
> 标签：mysql, triggers

我在使用触发器从其他表中提取信息以便在我为特定关系执行插入时插入它们时遇到问题。这基本上是为了让我不必在我的关系所需的其他表中查找信息。问题是我在设置一个等于查询结果的变量然后使用该变量中的值来设置我的表中的一列时遇到问题。代码看起来像这样。问题是我的变量永远不会被设置它总是为空，但我可以从命令行执行查询并获得结果，所以我不确定问题是什么，有人可以指出我做错了什么。

值得注意的是关系 sales_cost 有 2 个成员 model(primary key) VARCHAR(45) 和 price FLOAT

```
DELIMITER $$

USE `mydb`$$

CREATE
DEFINER=`local`@`localhost`
TRIGGER `mydb`.`sales_contract_before`
BEFORE INSERT ON `mydb`.`sales_contract`
FOR EACH ROW
BEGIN

/*variables*/
declare cost float;

/*
SELECT car.model INTO model FROM car where car.id = NEW.car_id;
set NEW.model = model;*/

 set cost = (select price from sales_cost where model = NEW.model);  //cost never gets set its always null

set new.price = cost;

END$$ 
```

更新：我似乎已经弄清楚问题出在哪里，但仍然想要一些见解（如果有人知道如何做到这一点），如果我在任何集合中使用 WHERE 查询，出于某种原因，问题在于使用 WHERE 限定符无论我从中选择什么表，它都不会返回（或返回 NULL）。我所做的是创建了一个函数，该函数接受模型名称，然后通过执行相同的查询返回成本。但是，如果有人可以举例说明如何将变量设置为等于查询结果的查询结果，我将不胜感激。我认为这一定是我的语法错误，但我对触发器的了解还不够，无法冒险猜测这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-11T06:51:37.783

还有另一种方法可以像这样使用选择查询设置多变量

```
DECLARE var1 INT DEFAULT 0;
DECLARE var2 DATE;
BEGIN
Select id,date From table_name Where id=Id
INTO var1,var2;
END; 
```

# r - 将一个变量条件赋值给其他两个变量之一的值

> ID：10489586
> 
> 赞同：26
> 
> 时间：2012-05-07T21:44:22.177
> 
> 标签：r

我想创建一个新变量，该变量等于其他两个变量之一的值，条件是其他变量的值。这是一个带有假数据的玩具示例。

数据框的每一行代表一个学生。每个学生最多可以学习两门科目（`subj1`和`subj2`），并且可以在每个科目中攻读学位（“BA”）或辅修（“MN”）。我的真实数据包括数千名学生，几种类型的学位，大约50个科目，学生最多可以有五个专业/辅修。

```
 ID  subj1 degree1  subj2 degree2
1   1    BUS      BA   <NA>    <NA>
2   2    SCI      BA    ENG      BA
3   3    BUS      MN    ENG      BA
4   4    SCI      MN    BUS      BA
5   5    ENG      BA    BUS      MN
6   6    SCI      MN   <NA>    <NA>
7   7    ENG      MN    SCI      BA
8   8    BUS      BA    ENG      MN
... 
```

现在我想创建第六个变量 ，`df$major`它等于`subj1`if的值`subj1`是学生的主要专业，或者`subj2`if的值`subj2`是主要的专业。初级专业是学位等于“BA”的第一门学科。我尝试了以下代码：

```
df$major[df$degree1 == "BA"] = df$subj1
df$major[df$degree1 != "BA" & df$degree2 == "BA"] = df$subj2 
```

不幸的是，我收到一条错误消息：

```
> df$major[df$degree1 == "BA"] = df$subj1
Error in df$major[df$degree1 == "BA"] = df$subj1 : 
  NAs are not allowed in subscripted assignments 
```

我认为这意味着如果至少一行的赋值评估为 NA，则不能使用矢量化赋值。

我觉得我必须在这里遗漏一些基本的东西，但上面的代码似乎是显而易见的事情，我无法想出替代方案。

如果它有助于编写答案，这里是使用创建的示例数据，`dput()`格式与上面列出的假数据相同：

```
structure(list(ID = 1:20, subj1 = structure(c(3L, NA, 1L, 2L, 
2L, 3L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 1L, 3L, 3L, 1L, 2L, 1L
), .Label = c("BUS", "ENG", "SCI"), class = "factor"), degree1 = structure(c(2L, 
NA, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 1L), .Label = c("BA", "MN"), class = "factor"), subj2 = structure(c(1L, 
2L, NA, NA, 1L, NA, 3L, 2L, NA, 2L, 2L, 1L, 3L, NA, 2L, 1L, 1L, 
NA, 2L, 2L), .Label = c("BUS", "ENG", "SCI"), class = "factor"), 
    degree2 = structure(c(2L, 2L, NA, NA, 2L, NA, 1L, 2L, NA, 
    2L, 1L, 1L, 2L, NA, 1L, 2L, 2L, NA, 1L, 2L), .Label = c("BA", 
    "MN"), class = "factor")), .Names = c("ID", "subj1", "degree1", 
"subj2", "degree2"), row.names = c(NA, -20L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-07T22:24:56.083

您最初的分配方法失败至少有两个原因。

1) 下标赋值有问题`df$major[df$degree1 == "BA"] <-`。使用`==`can generate `NA`，这是提示错误的原因。来自`?"[<-"`：“当替换（即在赋值的 lhs 上使用索引）时，NA 不会选择任何要替换的元素。由于是否应该使用 rhs 的元素存在歧义，只有在以下情况下才允许这样做rhs 值的长度为 1（因此两种解释将具有相同的结果）。” 有很多方法可以解决这个问题，但我更喜欢使用`which`：

```
df$major[which(df$degree1 == "BA")] <- 
```

不同之处在于`==`返回`TRUE`,`FALSE`和`NA`, 而`which`返回 TRUE 对象的索引

```
> df$degree1 == "BA"
 [1] FALSE    NA  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE

> which(df$degree1 == "BA")
 [1]  3  4  5  8  9 10 11 12 13 14 15 16 17 18 19 20 
```

2）当您执行下标赋值时，右侧需要明智地适合左侧（这是我的想法）。这可能意味着左右手边的长度相等，这就是您的示例所暗示的。因此，您还需要对赋值的右侧进行子集化：

```
df$major[which(df$degree1 == "BA")] <- df$subj1[which(df$degree1 == "BA")] 
```

* * *

我希望能澄清您最初的尝试产生错误的原因。

正如@DavidRobinson`ifelse`所建议的那样，使用 是进行此类分配的好方法。我的看法：

```
df$major2 <- ifelse(df$degree1 == "BA", df$subj1, ifelse(df$degree2 == "BA",
  df$subj2,NA)) 
```

这相当于

```
df$major[which(df$degree1 == "BA")] <- df$subj1[which(df$degree1 == "BA")]
df$major[which(df$degree1 != "BA" & df$degree2 == "BA")] <- 
  df$subj2[which(df$degree1 != "BA" & df$degree2 == "BA")] 
```

根据嵌套`ifelse`语句的深度，另一种方法可能更适合您的真实数据。

* * *

**编辑：**

我打算写原始代码失败的第三个原因（即`df$major`尚未分配），但它对我有用，而不必这样做。不过，这是我记得过去遇到的一个问题。您正在运行哪个版本的 R？`ifelse()`（对我来说是 2.15.0。）如果您使用该方法，则无需执行此步骤。使用时您的解决方案很好`[`，尽管我会选择

```
df$major <- NA 
```

要获取主题的字符值，而不是因子级别索引，请使用`as.character()`（对于因子等效于 and 调用`levels(x)[x]`）：

```
df$major[which(df$degree1 == "BA")] <- as.character(df$subj1)[which(df$degree1 == "BA")]
df$major[which(df$degree1 != "BA" & df$degree2 == "BA")] <- 
  as.character(df$subj2)[which(df$degree1 != "BA" & df$degree2 == "BA")] 
```

方式相同`ifelse()`：

```
df$major2 <- ifelse(df$degree1 == "BA", as.character(df$subj1),
  ifelse(df$degree2 == "BA", as.character(df$subj2), NA)) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-07T21:52:50.220

一般来说，[ifelse](http://www.math.montana.edu/Rweb/Rhelp/ifelse.html)函数是这些情况的正确选择，例如：

```
df$major = ifelse((!is.na(df$degree1) & df$degree1 == "BA") & (is.na(df$degree2) | df$degree1 != "BA"), df$subj1, df$subj2) 
```

但是，它的精确使用取决于如果两者都是“BA” `df$degree1`，您会做什么。`df$degree2`

# javascript - 一个奇怪的 json 用法

> ID：10489589
> 
> 赞同：4
> 
> 时间：2012-05-07T21:44:38.577
> 
> 标签：javascript, json

[我在MDN](http://hacks.mozilla.org/2011/01/ecmascript-5-strict-mode-in-firefox-4/)上看到了一部分 javascript 代码，我想知道如何在代码下面工作，这是什么意思？

```
var obj = { get x() { return 17; } }; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T21:50:03.970

据我所知，关键字`get`只是归类`x()`为 getter，并且似乎是自调用的。jScript (IE) 不支持它，它不是保留字。

你会像这样引用它：`obj.x; // 17`

用 lamen 的话来说，它们的行为是相同的：

```
var foo = { get x() { return 17; } };  
document.write(foo.x);​ // 17

var bar = { x: function() { return 17; } };  
document.write(bar.x());​ // 17 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:52:30.390

`var obj = { get x() { return 17; } };`等于：

```
var obj = {
    x: 17
} 
```

或者还有：

```
var obj = {
    x: (function(){
        return 17;
    })()
} 
```

这意味着`var obj`声明了一个对象并`get x() { return 17; }`声明了 obj 对象的属性，其值为 17：

```
var myVar = obj.x;//Equals to 17 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T21:51:38.663

那是为 x 属性指定一个 getter，它与 JSON 无关。您很困惑，因为 JSON 是 JS 对象的有效初始化程序，但是，并非所有 JS 初始化程序都是有效的 JSON。

该语法意味着当您从 读取时`obj.x`，它将调用该函数以获取其值。

# python - 当我 CURL 与使用 URLLIB2 时，为什么会得到不同的结果？

> ID：10489596
> 
> 赞同：3
> 
> 时间：2012-05-07T21:45:04.780
> 
> 标签：python, http, url, curl

```
curl -L http://tumblr.com/tagged/long-reads 
```

这是结果： http: [//pastebin.com/XtQVubBp](http://pastebin.com/XtQVubBp)

这种反应不同于

```
def download(url):
    f = urllib2.urlopen(url)
    return f.read()
html = download('http://tumblr.com/tagged/long-reads')
print html 
```

这是第二个的结果：http: [//pastebin.com/MdzrhBZv](http://pastebin.com/MdzrhBZv)

为什么？**我希望 download() 返回 curl 所做的相同的事情。我应该怎么办？**

这是 CURL 请求标头。

```
$ curl -v -L http://tumblr.com/tagged/long-reads
* About to connect() to tumblr.com port 80 (#0)
*   Trying 50.97.149.179... connected
* Connected to tumblr.com (50.97.149.179) port 80 (#0)
> GET /tagged/long-reads HTTP/1.1
> User-Agent: curl/7.21.6 (i686-pc-linux-gnu) libcurl/7.21.6 OpenSSL/1.0.0e zlib/1.2.3.4 libidn/1.22 librtmp/2.3
> Host: tumblr.com
> Accept: */*
> 
< HTTP/1.1 301 Moved Permanently
< Cache-Control: no-cache
< Content-length: 0
< Location: http://www.tumblr.com/tagged/long-reads
< Connection: close
< 
* Closing connection #0
* Issue another request to this URL: 'http://www.tumblr.com/tagged/long-reads'
* About to connect() to www.tumblr.com port 80 (#0)
*   Trying 50.97.143.18... connected
* Connected to www.tumblr.com (50.97.143.18) port 80 (#0)
> GET /tagged/long-reads HTTP/1.1
> User-Agent: curl/7.21.6 (i686-pc-linux-gnu) libcurl/7.21.6 OpenSSL/1.0.0e zlib/1.2.3.4 libidn/1.22 librtmp/2.3
> Host: www.tumblr.com
> Accept: */*
> 
< HTTP/1.1 200 OK
< Date: Mon, 07 May 2012 22:09:01 GMT
< Server: Apache
< P3P: CP="ALL ADM DEV PSAi COM OUR OTRo STP IND ONL"
< Set-Cookie: tmgioct=iVajmrL8Wj8YffLTthjFyqYn; expires=Thu, 05-May-2022 22:09:01 GMT; path=/; httponly
< Vary: Accept-Encoding
< X-Tumblr-Usec: D=266934
< Connection: close
< Transfer-Encoding: chunked
< Content-Type: text/html; charset=UTF-8
< 
```

**编辑：我将向现在解决我的问题的人提供 500 赏金。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:08:37.420

很难确切知道如何使它们看起来一样。您必须知道`curl`正在使用哪些标头并在`urllib2`. 但是一旦你知道了 headers 的`curl`用途，就*应该*`Request`像在对象中设置这些 headers 一样简单：

```
>>> moz_req = urllib2.Request('http://www.google.com', headers={'User-Agent': 'Mozilla/5.0 (X11; U; Linux i686) Gecko/20071127 Firefox/2.0.0.11'})
>>> pyt_req = urllib2.Request('http://www.google.com', headers={'User-Agent': 'Python-urllib/2.6'})
>>> moz_url = urllib2.urlopen(moz_req)                                          
>>> moz_str = moz_url.read()
>>> moz_url.close()
>>> pyt_url = urllib2.urlopen(pyt_req)
>>> pyt_str = pyt_url.read()
>>> pyt_url.close()
>>> moz_str == pyt_str
False 
```

当我执行以下操作时，我会得到一个充满博客文章的页面。

```
import urllib2

def download(url):
    headers = {'User-Agent': 'Mozilla/5.0 (X11; U; Linux i686) Gecko/20071127 Firefox/2.0.0.11'}
    req = urllib2.Request(url, headers=headers)
    url = urllib2.urlopen(req)
    page = url.read()
    url.close()
    return page

html = download('http://tumblr.com/tagged/long-reads')
page = open('page.html', 'w')
page.write(html)
page.close() 
```

但是，我检查了一下，即使没有设置标题，我也得到了相同的结果。还有什么不对...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-02T18:47:57.630

如果您使用 https 而不是 http，至少我会得到结果。顺便说一句，这不是最新库的问题。

# mysql - 如何使用 WHERE 语句获得完整的 GROUP_CONCAT 列表？

> ID：10489598
> 
> 赞同：0
> 
> 时间：2012-05-07T21:45:11.923
> 
> 标签：mysql

这是我的数据库结构的示例..

```
uid  email            name
-------------------------------
1    john@gmail.com   John
2    peter@gmail.com  Peter
3    colin@gmail.com  Colin 
```

书桌

```
book_id  book_name
-------------------
1        PHP
2        MySQL
3        Javascripts
4        CSS 
```

历史表

```
history_uid  history_bookid
---------------------------
1            1
1            2
1            3
2            1
2            3
3            3 
```

当前语句，包括多选查询`history.history_bookid`

```
SELECT users.uid,
       users.email,
       users.`name`,
       history.history_uid,
       history.history_bookid,
       GROUP_CONCAT(history.history_bookid) AS BookID,
       GROUP_CONCAT(book_name)              AS bookTitles
FROM   users
       INNER JOIN history
         ON users.uid = history.history_uid
       INNER JOIN book
         ON history.history_bookid = book.book_id
WHERE  history.history_bookid = 1
        OR history.history_bookid = 3
GROUP  BY users.uid 
```

结果

```
uid email            name   history_uid  history_bookid  BookID   bookTitles
---------------------------------------------------------------------------------
1   john@gmail.com   John   1            3               3,1      Javascripts,PHP
2   peter@gmail.com  Peter  2            1               1,3      PHP,Javascripts
3   colin@gmail.com  Colin  3            3               3        Javascripts 
```

**问题 ：**

我如何获得阅读过的书籍的完整列表`uid = 1`？我想要的示例输出包括所有书`history table`

```
uid email            name   history_uid  history_bookid  BookID   bookTitles
---------------------------------------------------------------------------------
1   john@gmail.com   John   1            3               1,2,3    PHP,MySQL,Javascripts
2   peter@gmail.com  Peter  2            1               1,3      PHP,Javascripts
3   colin@gmail.com  Colin  3            3               3        Javascripts 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:44:30.820

> 我如何获得阅读过的书籍的完整列表`uid = 1`？

将其作为过滤器选项添加到您的`WHERE`子句中：

```
WHERE history.history_bookid IN (1,3) OR users.uid = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:51:23.883

你的意思是你想要书名和书名？

将 a 添加`GROUP_CONCAT(book_name) AS bookTitles`到您的字段列表中。

# git - SVN可以做这个分支模型吗？

> ID：10489602
> 
> 赞同：2
> 
> 时间：2012-05-07T21:45:32.960
> 
> 标签：git, svn, version-control

我是版本控制系统的新手，并试图决定使用哪一个。有很多信息，但也许专家已经可以通过回答以下问题来帮助我。我找到了一个与我的要求非常相似的版本控制/分支模型：

[http://nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)

理论上我可以用 SVN 轻松实现这一点吗？像 Hotfix 和 Bugfix 分支一样，它们各自合并到多个不同的分支中？为什么“合并”应该更容易使用 Git 呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T22:21:44.093

在很多 StackOverflow 答案中都推荐了您链接到的工作流程。不过，一般来说，主要思想是将“好代码”和“开发代码”分开 -`master`和`development`分支。此外，保持功能分离，直到它们准备好合并到`development`分支中——这就是`features`and`hotfix`分支。

我毫不怀疑，SVN 完全可以实现该工作流程或非常相似的工作流程-您将使用[SVN Branches](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.using.html)。

周围有[一大堆](http://en.wikipedia.org/wiki/List_of_revision_control_software)修订控制系统，Nvie Git 工作流程非常通用——一般的工作流程可能会在大多数修订控制系统中使用。

> 理论上我可以用 SVN 轻松实现这一点吗？像 Hotfix 和 Bugfix 分支一样，它们各自合并到多个不同的分支中？

就个人而言，我认为 SVN 中的分支不像 Git 中那样容易。[Linus Torvalds 同意](http://www.youtube.com/watch?v=4XpnKHJAok8)——因此他围绕分支的想法设计了 Git。

> 为什么“合并”应该更容易使用 Git 呢？

Git 是围绕分支的思想设计的。制作分支，使用分支，将两个分支合并在一起，将三个分支合并在一起，将来自本地和远程存储库的分支合并在一起——Git 擅长分支。SVN 不是以分支为中心的，在我（有限的）SVN 经验中，将两个分支合并在一起并不总是很有趣。

如果您刚开始使用版本控制系统，我建议您使用 Git。要在 Git 和 SVN 之间进行适当的比较，请查看[此链接](https://git.wiki.kernel.org/index.php/GitSvnComparsion)。然而，我要指出的是，Git 有点让人费解，特别是如果你是新手的话——从概念上讲，SVN 更容易理解。我发现[Pro Git 这本书](http://www.progit.org/book)非常有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-07T22:15:49.410

从您提供的链接：

* * *

> 在我来自的经典 CVS/Subversion 世界中，合并/分支一直被认为有点吓人（“当心合并冲突，它们会咬你！”）而且你只是偶尔才会做的事情。
> 
> 但是使用 Git，这些操作非常便宜和简单，它们被认为是您日常工作流程的核心部分之一，真的。

* * *

就 SVN 而言，我同意该声明（我没有真正的 GIT 工作经验）。在 SVN 中，合并**是**耗时的，坦率地说，是可怕的。你不会轻易分支。所以，我想，答案是“不”——如果你事先知道你必须做很多分支和合并，就不要使用 SVN。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T22:18:58.117

理论上——是的，SVN 可以实现。但是SVN缺乏合并和分支工具。因此与 SVN 合并/分支有点不方便和可怕（主要问题 - 复杂的树和其他冲突）。

GIT 是合并分支的大师——他可以解决极其棘手的冲突。它还可以让您轻松跟踪所有分支版本。

SVN 和 GIT 的主要区别：

*   SVN 是集中式版本控制 (CVCS)
*   GIT 是去中心化版本控制 (DVCS)

要了解比较，请查看这篇[文章](http://www.codeforest.net/git-vs-svn)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-12T12:54:02.117

Subversion 有一个优势，即您始终知道特定修订中的特定分支/主干是否合并到您的分支（通过 svn:mergeinfo），这在挑选提交的情况下很重要。Git 提供了被认为工作得更好的合并工具。

您可以将 SubGit ( [subgit.com](http://subgit.com) ) 安装到您的 SVN 存储库中，并具有两种方法的优势。安装后，SubGit 创建了一个链接到该 SVN 存储库的 Git 存储库，以便对该 Git 存储库的任何推送都转换为 SVN，反之亦然。转换是即时执行的。

# slickgrid - 当 slickgrid 焦点丢失时删除活动单元格

> ID：10489608
> 
> 赞同：1
> 
> 时间：2012-05-07T21:46:14.710
> 
> 标签：slickgrid

我在页面上有多个可见的 slickgrids 实例。但是，我只希望一个网格一次有一个活动单元格（几乎就像多个网格像一个统一的网格一样）。关于如何做到这一点的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:57:00.107

您可以为每个网格订阅 onActiveCellChanged 并在所有其他实例上调用 resetActiveCell()。

# c# - 具有不同高度、宽度的 Xna 动画

> ID：10489609
> 
> 赞同：0
> 
> 时间：2012-05-07T21:46:27.573
> 
> 标签：c#, animation, xna

我目前正在用 xna 创建动画。当所有帧之间的帧高度、宽度和持续时间都相同时，我可以为 spritesheet 设置动画。

但我发现它不是很灵活，我想在没有相同 frameHeight/Width 的 spritesheet 的情况下制作动画，更重要的是没有恒定的持续时间。

是否有任何教程或代码示例来学习这个？

编辑：我想到了这样的事情，但我无法让它发挥作用：

```
 public void Update(GameTime gameTime)
    {
        if (elapsedTime > frameTime)
        {
            currentFrame++;
            elapsedTime = 0;
        }

        sourceRect = new Rectangle(newpositionX, newpositionY, newframeWidth, newframeHeight);
        frametime = newframetime
   }
enter code here 
```

难点在于如何准确地指定每一帧的新位置和新帧时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:16:10.520

如何为精灵表设置动画完全取决于您。

[本](http://rbwhitaker.wikidot.com/texture-atlases-2)教程展示了一个带有 4x4 精灵表的跳舞笑脸。因此它有 16 帧：

```
 | 1| 2| 3| 4|
 | 5| 6| 7| 8|
 | 9|10|11|12|
 |13|14|15|16| 
```

动画完成的循环（在 Update() 中）：

```
public void Update()
{
    currentFrame++;
    if (currentFrame == totalFrames)
        currentFrame = 0;
} 
```

如果您只想使用奇数`1,3,5,7,9,11,13,15`帧而不是偶数帧，那么`currentFrame++;`您可以使用`currentFrame+=2`

对于帧具有不同高度/宽度的精灵表，您可以使用[scaling](http://msdn.microsoft.com/en-us/library/bb194913.aspx)。如何在精灵表中导航取决于您，这意味着您不限于相同高度/宽度的精灵表。

至于持续时间，在我链接到的教程中，将尽可能快地更新笑脸的帧，因为没有实施控制来处理时间延迟（意味着每秒或每 0.5 秒更新一次）所以在当前状态下，Draw() 方法每秒会被调用 60 次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T19:54:55.757

我上过这门课

public void Update(GameTime gameTime) { currentAnimation = (currentAnimation + 1) % ExtractionXml.AnimationCount;

```
 elapsedTime += (int)gameTime.ElapsedGameTime.TotalMilliseconds;

        if (currentFrame == animationData.Animations[currentAnimation].Frames.Length)
        {
            if (Looping == true)
            currentFrame = 0;
        }

        if (elapsedTime > animationData.Animations[currentAnimation].Frames[currentFrame].Duration*1000 && currentFrame <= animationData.Animations[currentAnimation].Frames.Length-1)
        {
            Height = animationData.Animations[currentAnimation].Frames[currentFrame].Height;
            Width = animationData.Animations[currentAnimation].Frames[currentFrame].Width;
            X = animationData.Animations[currentAnimation].Frames[currentFrame].X;
            Y = animationData.Animations[currentAnimation].Frames[currentFrame].Y;

            sourceRect = new Rectangle(X, Y, Width, Height);
            //destinationRect = new Rectangle((int)Position.X - (int)(Width * scale) / 2, (int)Position.Y - (int)(Height * scale) / 2, (int)(Width * scale), (int)(Height * scale));
            destinationRect = new Rectangle(scale* ((int)Position.X - (animationData.Animations[currentAnimation].Frames[currentFrame].Width / 2) + (animationData.Animations[currentAnimation].Frames[currentFrame].OffSetX))
                                          , scale * ((int)Position.Y - (animationData.Animations[currentAnimation].Frames[currentFrame].Height / 2) + (animationData.Animations[currentAnimation].Frames[currentFrame].OffSetY))
                                          , scale * animationData.Animations[currentAnimation].Frames[currentFrame].Width
                                          , scale * animationData.Animations[currentAnimation].Frames[currentFrame].Height);
            //destinationRect = new Rectangle(0 , 0 , animationData.Animations[currentAnimation].Frames[currentFrame].Width, animationData.Animations[currentAnimation].Frames[currentFrame].Height);
            currentFrame++;
            elapsedTime = 0;
        }
    } 
```

# c# - HttpClient PutAsync 不向 api 发送参数

> ID：10489611
> 
> 赞同：13
> 
> 时间：2012-05-07T21:46:41.803
> 
> 标签：c#, asp.net-mvc-3, json.net

在控制器上 Put 如下：

```
[HttpPut]
[ActionName("putname")]
public JsonResult putname(string name)
{
    var response = ...
    return Json(response);  
} 
```

问题在于通过以下方式使用此 API 时

```
using (httpClient = new HttpClient())
{
    string name = "abc";
    string jsonString = JsonConvert.SerializeObject(name);
    var requestUrl = new Uri("http:...../controller/putname/");
    using (HttpContent httpContent = new StringContent(jsonString))
    {
        httpContent.Headers.ContentType = new MediaTypeHeaderValue("application/json");
        HttpResponseMessage response = httpClient.PutAsync(requestUrl, httpContent).Result;
    } 
```

此代码不会将参数名称传递给控制器​​。我什至尝试将 uri 更改为 /putname/" + name。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-17T15:53:48.153

这对我有用：

```
var jsonString = "{\"appid\":1,\"platformid\":1,\"rating\":3}";
var httpContent = new StringContent(jsonString, Encoding.UTF8, "application/json");            
var message = await _client.PutAsync(MakeUri("App/Rate"), httpContent);
Assert.AreEqual(HttpStatusCode.NoContent, message.StatusCode); 
```

和我的行动方法：

```
public void PutRate(AppRating model)
{
   if (model == null)
      throw new HttpResponseException(HttpStatusCode.BadRequest);

   if (ModelState.IsValid)
   {
     // ..
   }      
} 
```

和模型

```
public class AppRating
{
    public int AppId { get; set; }
    public int PlatformId { get; set; }
    public decimal Rating { get; set; }
} 
```

-斯坦

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-04T18:15:09.280

对我来说，它工作正常：

```
 string requestUrl = endpointUri + "/Files/";
            var jsonString = JsonConvert.SerializeObject(new { name = "newFile.txt", type = "File" }); 

            HttpContent httpContent = new StringContent(jsonString);
            httpContent.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue ("application/json");          

            HttpClient hc = new HttpClient();

            //add the header with the access token
            hc.DefaultRequestHeaders.Authorization = new System.Net.Http.Headers.AuthenticationHeaderValue("Bearer", accessToken);

            //make the put request
            HttpResponseMessage hrm = (await hc.PostAsync(requestUrl, httpContent));

            if (hrm.IsSuccessStatusCode)
            {
               //stuff
            } 
```

# c# - 从远程机器执行 SSIS

> ID：10489613
> 
> 赞同：0
> 
> 时间：2012-05-07T21:46:59.410
> 
> 标签：c#, sql-server, sql-server-2008, ssis

我需要从远程计算机上的 .net 应用程序执行 SSIS 包。运行应用程序的机器没有安装 SSIS。

我知道这可以使用带有 xp_cmdshell [http://www.databasejournal.com/features/mssql/article.php/3372131/Using-xpcmdshell.htm](http://www.databasejournal.com/features/mssql/article.php/3372131/Using-xpcmdshell.htm)的 T-SQL 来完成，但由于安全问题，我无法使用这种方法。

我想将此包存储为远程服务器上的代理作业（运行 sql server 2008）并通过代理服务执行它。我在这里找到了一篇关于此的文章[http://msdn.microsoft.com/en-us/library/ms403355.aspx#agent](http://msdn.microsoft.com/en-us/library/ms403355.aspx#agent)但我无法找出如何在变量中传递包。

这些变量会随着每次运行而改变，我知道我可以将它们存储在数据库中并在执行包时加载它们，但这似乎是一个 hacky 解决方案。有人知道可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:57:26.757

您是否考虑过/阅读过有关包配置的信息？如果您还没有这样做，您可能想阅读它。另外，请阅读 DTEXEC 实用程序，它是命令行 SSIS 可执行文件。您可以通过批处理文件和 DTEXEC 实用程序轻松传递变量。

# java - 使用 Ant 而不是 Eclipse 在 Java 中导入错误

> ID：10489618
> 
> 赞同：0
> 
> 时间：2012-05-07T21:47:13.057
> 
> 标签：java, eclipse, ant

如果我指定 的子库，我可以很好地编译我的程序`com.itextpdf.*`，但由于某种原因，如果我只是这样做，我的编译会失败`import com.itextpdf.*`。但是，就像我说的，如果我指定我正在使用的子库，例如

```
import com.itextpdf.text.Font.*;
import com.itextpdf.text.pdf.*; 
```

一切都编译得很好。在它失败的情况下，我得到的错误是“包 com.itextpdf 不存在”，但我知道它确实存在。我将它正确地包含在构建路径中，并且 Eclipse 在任何情况下都不会给出任何编译错误。仅当我尝试使用 Ant 构建时才会出现该错误。

在这一点上，我不介意指定我将使用的子库来确保我得到一个构建。但我很好奇，为什么蚂蚁不允许这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:36:15.727

您和 Eclipse 将 java 名称空间视为一个层次结构。但是，在 Java 规范中，它们不是。“com.itextpdf.text”和“com.itextpdf.text.Font”之间没有关系。它们是不同的字符串，故事的结尾。

作为风格问题，您可能希望将 Eclipse 设置为自动组织您的导入并明确指定您在类的导入部分中使用的每个类。当“com.itextpdf.text.Font.String”和“com.itextpdf.text.pdf.String”都存在时，这可以避免歧义，但您只想引用其中一个。如果您在 emacs 或 vi 中编程，这种风格会非常乏味和不方便，但在 Eclipse 中，它是自动的且不可见的，除非您滚动到文件的顶部。

# javascript - 如何链接到我网站上的“标签”

> ID：10489620
> 
> 赞同：1
> 
> 时间：2012-05-07T21:47:40.300
> 
> 标签：javascript, html, css, tabs, hyperlink

我在我的网站上制作了标签。选项卡是指导航链接，而不是加载新页面，而是使用一些 java 脚本和 css 来切换到另一个包含更多内容的选项卡。我想知道这样完成后如何链接到特定页面？

我的代码与此类似： [Using jquery easyui, how to create a tab by a link which is in a tab?](https://stackoverflow.com/questions/9995563/using-jquery-easyui-how-to-create-a-tab-by-a-link-which-is-in-a-tab)

编辑： http: [//fogest.net16.net/righttoweb/](http://fogest.net16.net/righttoweb/) <<< 有一个指向该站点的链接。看看标签。我将如何链接到这些选项卡之一的页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T01:57:26.970

将锚点添加到 URL 的末尾，即`http://URL/righttoweb#about`在`$(document).ready()`代码块中选择锚点并使用哈希表确定需要选择的选项卡。

还要确保当用户单击您的标签时，您也会更新顶部栏中的锚点，以便在用户决定为 URL 添加书签或将其发送给其他人时保留选择的标签

编辑：

好吧，每次用户单击您的一个选项卡时，您都需要使用 onClick 事件更改页面的导航历史记录，例如：

```
window.history.pushState("object or string", "Some Title", "#tab" + tabname); 
```

这将使后退/前进按钮能够工作

然后每次页面加载时，您都需要

```
$(document).ready(function() {
    if(window.location.href.indexOf('#'))
        updateTab(location.hash);
});

function updateTab(tabname) {
    your logic to update tab...
} 
```

希望这是有道理的

# java - 如何避免重载构造函数中的代码重复？

> ID：10489626
> 
> 赞同：5
> 
> 时间：2012-05-07T21:48:13.637
> 
> 标签：java, overloading, code-duplication

假设我有一个使用输入的构造函数和另一个使用默认值的构造函数。然后，两个构造函数都以完全相同的方式继续处理这些数据。（下面的示例。）在这种情况下，我有哪些避免代码重复的选择？

（我已经阅读了[如何减少构造函数重载代码](https://stackoverflow.com/questions/5374842/how-to-reduce-the-code-of-constructor-overloading)的帖子，其中最佳答案建议使用关键字“this”。就我而言，我想我需要使用“this”从第二个构造函数调用第一个构造函数存储输入之后的一个。然而，这会导致编译错误：“调用 this 必须是构造函数中的第一个语句”。）

示例代码：

```
public class A {
  public A(String a) {
    //process a
  }
  public A() {
    String a = "defaultString";
    //process a
  }
} 
```

编辑：我因在类构造函数中使用输入对话框调用而大受打击（我知道这不是很好的做法）。因此，我更改了代码示例，以引导讨论远离此 :)。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-07T21:50:33.683

一种方法是使用 init 方法：

```
public class A {
    public A(String a) {
        init(a);
    }
    public A() {
        String a = "defaultString";
        init(a);
    }
    private void init(String a) {
        //process a
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-07T21:54:25.273

*假设我有一个构造函数接受输入，而另一个构造函数通过输入对话框请求输入。*

不要那样做。从长远来看，这将导致可怕的纠缠和难以维护的代码。至少尝试将 UI 关注点（输入对话框等）与您的`object`模型（您可以`string`在构造函数中提供）分开。

老实说，你真的**不**希望这里有一个重载的构造函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-08T15:36:50.050

您可能想尝试链接您的构造函数：

```
public class A {
  public A(String a) {
    //process a
  }
  public A() {
    this("defaultString");
  }
} 
```

如果您想使用对话框来获取字符串，我建议您在调用此构造函数*之前显示对话框。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T21:54:11.033

我认为这是首选方法：

```
public class A {
  public A(String a) {
    //process a
  }
  public A() {
    this(JOptionPane.showInputDialog("a"));
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-07T22:09:18.823

减少构造函数之间代码重复的另一个选择是使用**初始化块**。初始化块代码将在构造函数*之前*运行。

看

*   [http://geekexplains.blogspot.com/2009/06/initializer-blocks-their-alternatives.html](http://geekexplains.blogspot.com/2009/06/initializer-blocks-their-alternatives.html)例如，或
*   [http://blog.sanaulla.info/2008/06/30/initialization-blocks-in-java/](http://blog.sanaulla.info/2008/06/30/initialization-blocks-in-java/)用于讨论**静态**初始化块和**实例**初始化块。

使用这种方法，您可以将公共代码放入初始化程序块中，然后将不同的逻辑留在特定的构造函数中。

```
public class A {
  {
     //initializer block - common code here
  }
  public A(String a) {
    //constructor - specific code here
  }
  public A() {
    //constructor - specific code here
  }
} 
```

这在所有情况下可能并不理想，但它是解决我尚未看到的问题的另一种方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-07T21:54:12.030

我不确定从构造函数中调用 JOptionPane 之类的东西是否是个好主意。这只是一个想法，但**您确实应该从静态方法中获取 buildA 并在您实际打算询问用户输入的地方执行它，然后只调用一个构造函数。**

```
public class A {
  public A(String a) {
    this.a = a;
  }
  public static A buildA(String input){
    if(input == null){
      input = JOptionPane.showInputDialog("a"); 
    }
    return new A(input);
  }
} 
```

# java - 如何在 JSF 输入字段中创建阴影

> ID：10489627
> 
> 赞同：3
> 
> 时间：2012-05-07T21:48:20.627
> 
> 标签：java, javascript, css, jsf, jsf-2

我在 oracle.com 网站上注册了帐户，我看到了一些非常有趣的东西： ![在此处输入图像描述](../Images/5ef3ac4711bf0b9514969f019c08fc8f.png)

在表格中查看电话号码的输入字段。如何将其复制到 JSF 输入表单中？这是CSS制作的吗？

**代码更新**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html">
    <h:head>
        <script type="text/javascript">
            <!-- input field shadow  -->
            var placeholder = "test field"
            $("input").on({
                focus: function() {
                    if (this.value == placeholder) {
                        $(this).val("").removeClass("shadow");
                    }
                },
                blur: function() {
                    if (this.value == "") {
                        $(this).val(placeholder).addClass("shadow");
                    }
                }
            }).trigger("blur");​            
        </script>       

    </h:head>

    <h:body>
        <h1>JSF 2 textbox example with shadow</h1>

        <h:form>
            <h:inputText value="#{userBean.userName}" />
            <h:commandButton value="Submit" action="user" />
        </h:form>

    </h:body>
</html> 
```

我测试了这段代码，但它不起作用。也许我需要将 JavaScript 代码作为函数调用到`<h:inputText>`标签中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T22:06:31.570

这是自 HTML5 以来的新功能。就是`placeholder`属性，在HTML5时代之前也被称为“水印”。

```
<input type="text" name="phone" placeholder="e.g. +994 (12) 491 2345" /> 
```

这当然只适用于支持 HTML5 的浏览器。使用 JSF 时，这只适用于支持新 HTML5`placeholder`属性的 JSF 组件。标准的 JSF`<h:inputText>`本身（还）不支持这个。您需要寻找支持此功能的 3rd 方组件库。其中包括[PrimeFaces](http://primefaces.org)及其[`<p:watermark>`](http://www.primefaces.org/showcase/ui/watermark.jsf)组件：

```
<h:inputText id="phone" value="#{register.user.phone}" />  
<p:watermark for="phone" value="e.g. +994 (12) 491 2345" /> 
```

这将检查是否支持 HTML5 然后使用`placeholder`，否则会引入一些 JS/jQuery 魔术来模拟相同的。这一切都不是由 CSS 完成的。

如果由于某种原因不能使用 PrimeFaces，您需要自己重新发明它，以自定义组件和/或自定义 JS/jQuery 片段的风格，就像`<p:watermark>`在幕后所做的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T22:03:19.310

我认为他们正在使用 jquery 的水印来做到这一点。附件是该页面的萤火虫视图，它显示

![水印文本字段](../Images/36c37cb5c79c842cf8d87896b2e52200.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T22:18:52.647

如果您无法使用 PrimeFaces，正如[@BalusC 所述](https://stackoverflow.com/a/10489816/1249581)，您可以使用这样的 JavaScript/jQuery 代码：

```
var placeholder = "e.g. +358 (11) 123-45-67"
$("input").on({
    focus: function() {
        if (this.value == placeholder) {
            $(this).val("").removeClass("shadow");
        }
    },
    blur: function() {
        if (this.value == "") {
            $(this).val(placeholder).addClass("shadow");
        }
    }
}).trigger("blur");​ 
```

CSS 类`shadow`有 font `​color: #bbb`。

**演示：http:** [//jsfiddle.net/rYAbU/](http://jsfiddle.net/rYAbU/)

# symfony-1.4 - 无法自定义 sfGuardGroup - 始终使用缓存版本 autosfGuardGroup

> ID：10489628
> 
> 赞同：0
> 
> 时间：2012-05-07T21:48:21.067
> 
> 标签：symfony-1.4, propel, sfguard

我在 Symfony 1.4.11 上使用带有 Propel 的 sfGuardPlugin。我覆盖了 sfGuardUser 以及 sfGuardGroup 和 sfGuardPermission 中的一些模板。在我的 localhost 版本上这是可行的，但是在共享主机上 sfGuardGroup 和 sfGuardPermission 模块顽固地忽略了我的应用程序中的模板，而是恢复到缓存的 autoXXX 模块。奇怪的是 sfGuardUser 在这两个平台上都可以工作。

调试日志在步骤之前是相同的

> 调用“sfGuardGroupActions->executeIndex()”

本地版本继续正确

> 渲染“sf_app_dir/modules/sfGuardGroup/templates/indexSuccess.php”

当远程服务器这样运行时：

> 渲染“sf_root_dir/cache/backend/dev/modules/autoSfGuardGroup/templates/indexSuccess.php”

我以前从未见过我的模块的行为有任何不同，这真的让我很难过。两个位置的文件是相同的，除了 ProjectConfiguration.class.php 和 database.yml。我没有发现任何提到这种问题。你知道是什么原因造成的吗？

编辑：
当然我清除了两端的缓存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:59:58.827

好吧，这很尴尬！

注意 autoSfGuardGroup 是如何拼写的？当我复制缓存的文件夹时，我取出了“auto”，在名称前面留下了一个大写的“S”。我的 Mac 很高兴地忽略了这些上限，但托管服务器并不是那么好。

现在一切都很好。

也许我应该买新眼镜... 8-}

# linq - LINQ：如何组合搜索 2 个列表（两个列表：实体列表和数组）？

> ID：10489630
> 
> 赞同：1
> 
> 时间：2012-05-07T21:48:37.477
> 
> 标签：linq, entity-framework, linq-to-entities, linq-to-objects

假设我是`Member`我不想包含的名称的实体和列表。

```
var excludeNames = new [] { "A","B","C","D"};

var members = db.Members.Except(excludeNames); 
```

或者

```
 var excludeNames = new[]{ "A","B","C","D"};
 var Members = db.Members.Where(m=> excludeNames.Where(xcl => xcl != m.Name)); 
```

这些都不起作用。我也试过这个：

```
 var excludeNames = new[] { "A","B","C","D"};
 var members = from m in db.Members
               from xcl in excludeNames
               where m.Name != xcl
               select m; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-07T21:54:08.050

尝试以下操作：

```
var excludeNames = new[] { "A","B","C","D"};
var members = from m in db.Members
              where !excludeNames.Contains(m.Name)
              select m; 
```

请注意，即使 LINQ 允许您以多种方式表达查询，您仍然需要考虑您的查询需要转换为 SQL 的事实。Entity Framework 支持的 SQL 方言将值列表与行集区别对待。

例如，您要在 SQL 中构建的查询将是

```
SELECT *
FROM Members AS m
WHERE m.name NOT IN ('A', 'B', 'C', 'C') 
```

（`x IN (list)`SQL 中的一个转换为`list.Contains(x)`LINQ 中的。）

例如，你不能说类似的话

```
SELECT *
FROM Members AS m
WHERE EXISTS(SELECT 1
             FROM ('A', 'B', 'C', 'C') AS xcl
             WHERE m.name != xcl) 
```

也不

```
SELECT *
FROM Members AS m,
     ('A', 'B', 'C', 'C') AS xcl
WHERE m.name != xcl 
```

根本不允许这些查询。尽管 Entity Framework 在将 LINQ 查询转换为 SQL 时可以非常智能，但它确实有其局限性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-24T11:55:43.697

我认为这可能是一个很好的解决方案。

```
var excludeNames = new [] { "A","B","C","D"};

var members = db.Members.Where(member => excludeNames.Any(member.Name) == false).ToList() ;

//or     
var excludeNames = new [] { "A","B","C","D"};

var members = db.Members.Where(member => !excludeNames.Any(member.Name)).ToList() ; 
```

# iphone - 我在哪里可以创建、更新和存储我的 iPhone 后端

> ID：10489645
> 
> 赞同：0
> 
> 时间：2012-05-07T21:49:49.243
> 
> 标签：iphone

我找到了很多可以存储我的数据的网站，但我也想要一个可以定期运行我的三个 php 文件以更新我的数据库中的数据的 Web 服务。我有这些文件是因为我需要从另一个来源获取数据并使其更适合我的需要，然后我将它们保存到 JSON 文件中，以后我想从我的 iPhone 应用程序中访问这些文件。有没有地方可以做到这一点（希望免费或便宜）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T01:20:56.070

您可以免费找到一些网站，但最好为 IMO 服务付费。您正在寻找具有“MySQL 数据库”功能的东西。iPage.com、WebHostingHub.com、BlueHost.com 等都提供此功能。

# c# - c# 下拉选中的文本

> ID：10489647
> 
> 赞同：0
> 
> 时间：2012-05-07T21:49:51.873
> 
> 标签：c#, asp.net, drop-down-menu

我正在尝试获取所选下拉项目的文本

我的下拉列表中充满了数据库数据

```
ad.Fill(dt);
drop1.DataSource = dt;
drop1.DataTextField = "zodys";
drop1.DataValueField = "zodys";
drop1.DataBind(); 
```

例如：`word1, word2, word3, ...` 这一切都很好，但是当我尝试获取所选项目的文本时，我总是得到相同的文本（1 项目的文本）

```
txtZip.Text = drop1.SelectedItem.Text; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T21:54:15.590

我几乎可以保证您的问题是您在`Page_Load()`? 仅当您不回发时才需要执行此操作，如下所示：

```
if(!IsPostBack)
{
   ad.Fill(dt);
   drop1.DataSource = dt;
   drop1.DataTextField = "zodys";
   drop1.DataValueField = "zodys";
   drop1.DataBind();
} 
```

这可确保在每次检查 SelectedItem 之前不会重置该值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T21:53:44.103

我假设您也在 page_load 的回发中对下拉列表进行数据绑定。你应该检查一下`IsPostBack`。

```
if(!IsPostBack)
{
    ad.Fill(dt);
    drop1.DataSource = dt;
    drop1.DataTextField = "zodys";
    drop1.DataValueField = "zodys";
    drop1.DataBind();
} 
```

# mongodb - Mongodb找到一个所有子文档都满足条件的文档

> ID：10489649
> 
> 赞同：9
> 
> 时间：2012-05-07T21:49:59.720
> 
> 标签：mongodb

我的数据库中有游戏收藏：

```
var game = {
  players: [{username:"user1", status:"played"},
            {username:"user2", status:"accepted"}]
} 
```

据我了解这样的查询：`db.games.find({"players.status":"played"})`会给我所有至少有一名玩家状态为“已玩”的游戏。如何找到所有玩家状态为“已玩”的游戏？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-08T04:45:30.387

如果您只有“已播放”以外的一种状态，请使用以下查询：

```
db.games.find({ "players.status": { $ne:"accepted" } }) 
```

您可以调整查询以处理更多状态值，只要它们在查询时都是已知的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-10T23:29:32.600

我也遇到了这个问题。我试图使用`$all`并且几乎没有进展。它有助于改变我对问题的看法并`$not`改用它。我[写了我在这里找到的东西](http://www.petecorey.com/blog/2020/03/10/querying-for-mongodb-documents-where-every-subdocument-matches-a-pattern/)。

在您的情况下，您应该能够执行以下操作：

```
db.games.find({
  players: {
    $not: {
      $elemMatch: {
        status: { $ne: "played" }
      }
    }
  }
}) 
```

查找所有播放器状态不等于的文档`"played"`并返回该集合的倒数。这样做的好处是您永远不必担心添加更多状态值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-04-28T16:36:52.170

使用聚合框架的 $unwind 特性：

db.collection.aggregate([{$unwind:"$players.status"},{$match:{"players.status":"played"},{$project:{"_id":0,"players.status ":1}}])

（看看这个答案：[https](https://stackoverflow.com/a/15082321/1214167) ://stackoverflow.com/a/15082321/1214167 ）

# google-app-engine - Google App Engine Go - 使用 OpenID，我也应该使用验证码吗？

> ID：10489654
> 
> 赞同：0
> 
> 时间：2012-05-07T21:50:24.343
> 
> 标签：google-app-engine, openid, go, captcha, bots

目前我正在用 golang 开发一个 GAE 应用程序，它允许用户使用来自 Google 的 OpenID 登录服务。显然，每个帐户都会映射到一个 Google 帐户。我应该为用户注册实施验证码，还是使用 OpenID 已经可以防止服务受到机器人攻击？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T21:54:05.723

你接受*任何*OpenID 吗？那么这是*不够*的保护。*任何人都*可以在自己的域上建立一个 OpenID 站点，使用脚本创建十亿个帐户，并在您的站点上使用其中一个帐户登录。

您是否只接受*特定的*OpenID 提供者？那么你就没有使用 OpenID，因为它本来就是要使用的（事实上，这与它的创建原因正好相反）。但答案将是：您是否相信 OpenID 提供商在创建帐户时已进行了尽职调查以防止垃圾邮件帐户？

无论如何，您可能会发现验证码是一个糟糕的解决方案，并且目前它的*所有*实现都被破坏了（但这是一个完全不同的话题）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T17:45:09.797

首先，对机器人攻击的恐惧*确实*是一个初步的警告。解析 CSRF 令牌（无论如何都应该使用）和处理 cookie 已经给攻击者带来了足够的痛苦。我怀疑有人会费心去建立自己的 OpenID 提供程序，这是唯一可以做到这一点的方法。

其次，App Engine 的 OpenID 联合登录是用户 API 功能，而不是 Go 运行时的功能——您可以使用任何 OP（Facebook、Yahoo!、Steam...Google）。User API 提供两种模式（可通过应用程序设置进行配置）：OpenID 联合登录和 Google 帐户登录。选择哪种模式取决于要求。如果您只需要用户的 Google 帐户，您最好使用后者，如果它是简单的无密码登录，几乎所有内容，请选择 OpenID。从应用程序的角度来看，两者看起来相同。不过，最好的方法是 OAuth。

回到这个问题，Google Accounts API 和 OAuth 都将使此类攻击几乎不可能发生，而使用 OpenID 则更简单*一些*。

[https://developers.google.com/appengine/docs/go/users/overview](https://developers.google.com/appengine/docs/go/users/overview)

# android - 在 JQuery mobile 中滚动

> ID：10489661
> 
> 赞同：0
> 
> 时间：2012-05-07T21:51:06.193
> 
> 标签：android, ios, jquery-mobile

我正在使用需要同时支持 iOS 和 Android 的 JQuery Mobile 创建应用程序。（我正在使用PhoneGap）。默认情况下在长页面上滚动是否有效，或者我是否需要设置我`div`的 s 以支持滚动。iOS 上的滚动与 Android 设备有何不同？

另外，当用户滚动到页面底部以检索更多内容时，有没有办法进行 ajax 调用？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:06:58.367

**1)** jQuery Mobile 1.1.0 使用浏览器的原生滚动，因此在每个支持的平台上看起来都很自然。

然而，jQuery Mobiles 确实需要以下伪页面结构：

```
<div data-role="page">
    <div data-role="header">
        ...
    </div>
    <div data-role="content">
        ...
    </div>
    <div data-role="footer">
        ...
    </div>
</div> 
```

如果您遵循此结构，则添加到该`data-role="content"`部分的越多，页面就越长。

**2）**您可以为事件设置事件处理程序`scroll`以检测用户滚动并查看用户在页面下方的距离：

```
//you don't want to set a bunch of AJAX requests at once,
//so set a flag so only one will go off at a time
var ajaxOK = true;
$(window).on('scroll', function () {
    var yDistance = $('html, body').scrollTop();

    //here you can check how far down the user is and do your AJAX call
    if ((yDistance + $(window).height()) > ($.mobile.activePage.children('.ui-content').height() - 150)) {
        //the user is within 150px of the bottom of the page
        if (ajaxOK === true) {
            ajaxOK = false;
            $.ajax({ ... });
        }
    }
}); 
```

然后在您设置的 AJAX 调用的回调函数中，`ajaxOK = true;`以便当用户再次滚动到底部时它会触发。

下面是事件处理程序中`if/then`语句的快速分解：`scroll`

```
(yDistance + $(window).height()) > ($.mobile.activePage.children('.ui-content').height() - 150) 
```

1.  `(yDistance + $(window).height())`：滚动距离加上视口高度，找到页面底部的 Y 坐标。
2.  `($.mobile.activePage.children('.ui-content').height() - 150)`：当前页面的高度减去缓冲区的高度，`150px`因此用户可以进入`150px`并发生 AJAX 调用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T21:56:25.650

如果溢出浏览器窗口，滚动应该会自动发生。对于无限滚动，您可以尝试[http://www.infinite-scroll.com/](http://www.infinite-scroll.com/)。

如果您使用 jquery mobile 的列表视图，您可能需要在将更多列表视图项添加到 dom 后调用刷新事件，以使过滤行为和样式正常工作。

# iis - 在带有 IE 9 的 IIS6 上的 Intranet 应用程序中获取 NTLM 身份验证的问题

> ID：10489663
> 
> 赞同：1
> 
> 时间：2012-05-07T21:51:18.157
> 
> 标签：iis, web-parts, ntlm, intranet

我有一个 Intranet Web 应用程序在 Win 2003 服务器上的虚拟目录中运行。我想让应用程序选择用户名进行个性化。

在 web.config 我设置了以下内容：

`<authentication mode="Windows" /> <identity impersonate="false"/> <authorization> <allow users="*" /> <deny users="?" /> </authorization>`

在 IIS 6 中，我将目录安全设置为集成 Windows 身份验证，并禁用了启用匿名访问。在 IE9 中，我在本地 Intranet 区域中设置了站点地址并启用了集成 Windows 身份验证。

如果我使用 Chrome 或 FF 访问该站点，我会收到登录提示，我可以输入用户名/密码，一切正常，但如果我使用 IE9 访问该站点，我会收到 401 错误。

目标是获取用户名，以便我可以对 Web 部件进行个性化并记录对某些区域的访问。

关于如何使这项工作的任何想法？Chrome 和 FF 不是选项，IE 是我们的标准。

蒂亚杰

# google-docs-api - ColdFusion 获取文件夹中的文档列表 - 集合

> ID：10489668
> 
> 赞同：2
> 
> 时间：2012-05-07T21:51:27.770
> 
> 标签：google-docs-api

如果我按照我看到的示例来获取集合中的文档项，我最终会得到以下结果。它确实带回了一个条目，但它不是文件夹中的项目，它只是文件夹条目本身。

`<cfhttp url="https://docs.google.com/feeds/documents/private/full/folder%3A0B_xSYw8SWKixSxxx/contents" method="get" result="result" charset="utf-8"> <cfhttpparam type="header" name="Authorization" value="GoogleLogin auth=#getAuth(variables.docservice)#">`

如果我发送 [https://docs.google.com/feeds/documents/private/full?showfolders=true](https://docs.google.com/feeds/documents/private/full?showfolders=true) 我会得到我所有的文档和文件夹列表。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T17:46:49.233

如果我没看错，那么您需要使用不同的标签。

```
<cfdirectory 
directory = "directory name"
action = "list"
name = "query_name"
sort = "asc"
type = "all">
<cfdump var="#query_name#"/> 
```

# javascript - 检查其用户是否第一次使用 Javascript 访问网站

> ID：10489671
> 
> 赞同：0
> 
> 时间：2012-05-07T21:51:37.277
> 
> 标签：javascript, html

我试图找出它的用户是否第一次在我的网页上。我目前正在本地存储中存储一个变量并检查它是否为空，但它似乎在 Internet Explorer 中不起作用。我还可以使用什么其他方法来完成此操作？

```
 var str_count = localStorage.getItem("count");
    if (str_count == null || str_count == "null")
    {
               // Do something
             } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T21:53:12.207

你可以设置一个cookie

```
document.cookie = name + "=" + value + "; expires=" + exp + "; path=/"; 
```

~~更多信息在这里：[http ://www.w3schools.com/js/js_cookies.asp](http://www.w3schools.com/js/js_cookies.asp)~~

更多信息在这里：[http ://www.quirksmode.org/js/cookies.html](http://www.quirksmode.org/js/cookies.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T22:10:20.600

设置`cookie`长过期日期肯定比使用更可靠，`localStorage`因为旧浏览器尚不支持。

检查此代码：

```
function createCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
} 
```

[在此处](http://www.quirksmode.org/js/cookies.html)阅读有关 cookie的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T22:00:16.377

正如@Greg 所说，更好的解决方案是设置和获取 cookie 值。这里有两个函数可以做到这一点：

```
setCookie = function(){
    var args = arguments,
    name = (args[0] ? args[0] : '') + '=',
    _value = args[1] ? escape(args[1]) : '',
    value = _value + ';',
    expires = args[2] ? 'expires=' + args[2].toUTCString() + ';' : '',
    path = args[3] ? 'path=' + args[3] + ';' : '',
    domain = args[4] ? 'domain=' + args[4] + ';' : '',
    secure = args[5] ? 'secure;' : '',
    newCookie = name + value + expires + path + domain + secure;
    document.cookie = newCookie.match(/[a-z||A-Z]/) ? newCookie : ''
    return _value;
},
getCookie = function(name){
    if(!name || name.replace(/[^a-z|0-9|çáéíóúãõâêîôûàèìòùäëïöü]/,'')=='*') return document.cookie;
    var ck = ' ' + document.cookie + ' ',
    pos = ck.search(' ' + name + '='),
    pos = (pos!=-1) ? pos + 1 : ck.length,
    ck = ck.substring(pos-1,ck.length),
    end = (ck.search('; ')!=-1) ? ck.search('; ') : ck.length,
    value = ck.substring(((ck.search('=')!=-1) ? (ck.search('=')+1) : end),end);
    return unescape((value[value.length-1]==' ') ? value.substring(0,value.length-1) : value);
} 
```

它们是跨浏览器功能。要使用`getCookie`函数，只需使用`name`参数，使用`setCookie`函数，使用`name,value,expires,path,domain,secure`参数

# javascript - Quicksand jquery 插件在他们轻松时放大元素。为什么？

> ID：10489674
> 
> 赞同：0
> 
> 时间：2012-05-07T21:51:42.283
> 
> 标签：javascript, jquery, quicksand

我目前正在尝试使用 Quicksand，这是一个 jquery 插件，它允许您通过隐藏和显示基于标签的某些元素来为页面上的元素设置动画。我有那个工作得很好。我的问题是，随着元素的缓动，它们在移动时会放大。一旦他们安顿下来，他们就会缩小到适当的大小，但这看起来非常奇怪，我想首先弄清楚为什么会发生这种情况。

这是我对流沙的偏好的 main.js 文件：

```
$(document).ready(function() {

  // get the action filter option item on page load
  var $filterType = $('#filterOptions li.active a').attr('class');

  // get and assign the ourHolder element to the
    // $holder varible for use later
  var $holder = $('ul.ourHolder');

  // clone all items within the pre-assigned $holder element
  var $data = $holder.clone();

  // attempt to call Quicksand when a filter option
    // item is clicked
    $('#filterOptions li a').click(function(e) {
        // reset the active class on all the buttons
        $('#filterOptions li').removeClass('active');

        // assign the class of the clicked filter option
        // element to our $filterType variable
        var $filterType = $(this).attr('class');
        $(this).parent().addClass('active');

        if ($filterType == 'all') {
            // assign all li items to the $filteredData var when
            // the 'All' filter option is clicked
            var $filteredData = $data.find('li');
        } 
        else {
            // find all li elements that have our required $filterType
            // values for the data-type element
            var $filteredData = $data.find('li[data-type~=' + $filterType + ']');
        }

        // call quicksand and assign transition parameters
        $holder.quicksand($filteredData, {
            duration: 800,
            easing: 'easeInOutQuad'
        });
        return false;
    });
}); 
```

流沙文件本身保持不变，除了我将文档中的所有“高度”更改为“宽度”，因为我没有为任何 div 指定高度。

感谢您的帮助！如果您需要查看 HTML 或 CSS 来解决问题，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:01:57.520

发生这种情况是因为您使用了缓动功能：`easeInOutQuad`.

它为动画提供了一个反向反弹方面。

请参阅此处以供参考： http: [//gsgd.co.uk/sandbox/jquery/easing/](http://gsgd.co.uk/sandbox/jquery/easing/)

**编辑：**

从一开始你就发现了你的问题。我调试了您的页面，发现百分比度量是问题所在。

从网站：[http ://razorjack.net/quicksand/docs-and-demos.html](http://razorjack.net/quicksand/docs-and-demos.html)

> **CSS 建议**
> 1.当你的物品和它们的容器样式化时，请使用 CSS 类。使用 ID 可能会导致奇怪的结果。流沙克隆容器以模拟动画的目标帧。由于不可能存在相同 ID 的两个元素，因此应避免通过容器 ID 设置项目/容器的样式。
> 2.流沙需要知道body、container和collection物品的边距。如果这些元素有边距，请使用 px（像素），而不是 ems。该插件暂时不理解 ems。

我认为百分比包含在同一案例中。

# sql-server - 提高 BCP 的速度 - 命令行选项？

> ID：10489675
> 
> 赞同：1
> 
> 时间：2012-05-07T21:52:05.293
> 
> 标签：sql-server, bcp

我正在使用 BCP 导入大量数据，我很好奇它有哪些选项可以提高此操作的速度。

我在几个地方读到了并行加载，还看到你可以告诉它不要费心对数据进行排序或检查约束（这对我来说都是可行的选择，因为源是另一个具有良好完整性的数据库）。

不过，我还没有看到使用这些选项的示例（例如，我不知道哪个命令行开关可以启用并行加载或禁用约束检查）。

有谁知道学习这个的好资源，或者有人可以给我几个简单的例子吗？请不要将我指向 BCP 参数帮助页面，关于这些特定选项，我无法做出正面或反面。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T22:55:28.240

您需要阅读[数据加载性能指南](http://msdn.microsoft.com/en-us/library/dd425070%28v=sql.100%29.aspx)。没有神奇的命令行开关'加载更快'，是在正确的上下文中做正确的事情的一个非常复杂的平衡。这取决于你加载的是堆还是B-Tree，是否已经有数据或表是否为空，是否有二级索引，数据库恢复模型中是否可以进行最小日志记录，表是否分区，数据是否预先排序，这只是表面。链接的白皮书包含所有详细信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-07T22:06:41.540

看起来您正在谈论的并行加载只是针对同一个表运行 BCP 实用程序的多个实例。您将负责事先对数据进行分区。您可以通过指定`TABLOCK`表提示来使用它。来自 MSDN：

> 批量更新 (BU) 锁允许进程将数据同时批量复制到同一个表中，同时阻止未批量复制数据的其他进程访问该表。

所以它真的只是一个 BCP 的特殊锁。

为了进一步提高性能，您可以进一步阅读[BCP 参数](http://msdn.microsoft.com/en-us/library/aa174646%28v=sql.80%29.aspx)页面`-a`上的标志。

`-a`允许指定更大的数据包大小（在 4096 和 65535 之间）以增加每个网络数据包一次发送到服务器的数据量。

`-e`如果您打算运行多个 BCP 进程来帮助跟踪遇到的任何错误，我还建议使用错误标志。

# c# - 如何从 Web 服务环境返回 302 重定向

> ID：10489676
> 
> 赞同：2
> 
> 时间：2012-05-07T21:52:06.597
> 
> 标签：c#, web-services, web, servicestack

我在一个安静的服务环境中，我们使用 ServiceStack 作为我们的服务框架。此时，我需要直接从服务中进行重定向，一旦我尝试从我的 Get 方法中进行重定向，它就会失败，因为我认为我的 Get 函数看起来像这样：

```
 public override object OnGet(ShareDTO request)
        {               
           HttpContext.Current.Response.Redirect(@"http://www.google.com");
            return new object();
        } 
```

可能是因为它首先尝试重定向，然后尝试返回一个值，但这只是猜测。我不确定在服务环境中是否有可能，因为每当我使用 Response.Redirect 时，它总是一个 .NET aspx 页面，从未在服务环境中尝试过。

有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T01:58:33.660

最简单的方法是只返回一个 custom `HttpResult`，例如：

```
public object Any(Request request)
{
    return HttpResult.Redirect("http://www.google.com");
} 
```

这相当于更明确的：

```
return new HttpResult
{
    StatusCode = HttpStatusCode.Found,
    Headers =
    {
        { HttpHeaders.Location, "http://www.google.com" },
    }
}; 
```

[或者，您可以在请求过滤器](https://github.com/ServiceStack/ServiceStack/wiki/Order-of-Operations)或服务中直接写入响应，例如：

```
public object Any(Request request)
{
    base.Response.StatusCode = 302;
    base.Response.AddHeader(HttpHeaders.Location, "");
    base.Response.EndRequest();
    return null;
} 
```

# ruby-on-rails - Rails 3.2 Paperclip S3未在Localhost中加载

> ID：10489678
> 
> 赞同：2
> 
> 时间：2012-05-07T21:52:11.857
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, paperclip, ruby-on-rails-3.2

我刚刚升级到 Rails 3.2，我正在使用 Amazon S3 和 Paperclip 将照片上传到我的应用程序。

在我的图片网址是：

```
 http://s3.amazonaws.com/dealphotos.website.com/photos/428/large/Sandisk120Drive?1334754504 
```

现在我在本地主机上的图片网址是：

```
 http://s3.amazonaws.com/dealphotos.website.com/deals/photos/000/000/428/large/Sandisk120Drive?1334754504 
```

请注意额外的 000/000 - 即使我将它们取出并访问它说的链接：

```
 <Error>
  <Code>AccessDenied</Code>
  <Message>Access Denied</Message>
   <RequestId>"Long String of Numbers"</RequestId>
   <HostId>
    "Gives me a really long string of letters and numbers"
   </HostId> 
```

我的交易模式：

```
 has_attached_file :photo, :styles => { :small =>"268x160>", :large =>"350x250>" },
          :storage => :s3, 
          :bucket => 'dealphotos.website.com',
          :s3_credentials => {
          :access_key_id => ENV['S3_KEY_SPICY'],
          :secret_access_key => ENV['S3_SECRET_SPICY']
        } 
```

并且图像不显示！

在此之前，我要做的就是从 Heroku 中提取所有图像和文件，然后我的所有图像和文件都将用于我的开发。这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T09:11:44.900

您很可能使用的是最新版本的 Paperclip（版本 >= 3）。

由于这是回形针的主要版本，因此记录了与旧版本回形针的不兼容性。

一个主要的（在我的书中是好的）变化是资产的默认存储位置已经改变。

早些时候它曾经是 /system/:attachment/:id/:style/:filename.:extension （来自内存）。例如，如果您有 2 个具有相同名称的附件（公司徽标和产品徽标），这将是灾难性的。

现在回形针使用的新路径是 /system/:class/:attachment/:id_partition/:style/:filename.:extension

这意味着您的所有资产都将存储在上面指定的目录中。:id_partitions 用于使一个目录中的节点（文件/目录）的数量不超过 1000。

我希望我已经能够解释你为什么看到这个问题的原因。默认路径已更改。

你现在有两个选择——

1.  将旧资产移动到新目录方案中的正确位置（痛苦但推荐）。

2.  将新资产移动到旧目录结构中，并在模型的附件定义中添加 :url + :path 选项以继续使用旧方案。（见[https://github.com/thoughtbot/paperclip/blob/master/UPGRADING](https://github.com/thoughtbot/paperclip/blob/master/UPGRADING)）。

因为看起来你在新结构和旧结构中都有图像。因此，无论您决定什么，都需要将文件从一个结构移动到另一个结构。除非资产以某种方式添加了书签，否则我建议您将旧资产移动到新的目录结构中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T09:16:16.357

查看 CarrierWave gem 以进行文件上传。它适用于 3.2 没有任何问题 ;)

[http://railscasts.com/episodes/253-carrierwave-file-uploads](http://railscasts.com/episodes/253-carrierwave-file-uploads)

# c# - 使用 ASP.NET 开发服务器对 MVC 进行单元测试

> ID：10489683
> 
> 赞同：6
> 
> 时间：2012-05-07T21:52:29.333
> 
> 标签：c#, asp.net, asp.net-mvc, visual-studio, unit-testing

我想确认我创建的路线正在选择我的“HomeController”类。所以我有一个这样的测试：

```
 [TestMethod]
    [UrlToTest("http://localhost:14478/home")]
    [HostType("ASP.NET")]
    [AspNetDevelopmentServerHost("$(SolutionDir)\\MvcBuildApp")]
    public void MyTest()
    {
        System.Diagnostics.Debugger.Break();

        RouteCollection routes = new RouteCollection();
        MvcApplication.RegisterRoutes(routes);
        MvcApplication.RegisterGlobalFilters(GlobalFilters.Filters);
        //This fetches DefaultControllerFactory (for now, anyway...)
        var factory = ControllerBuilder.Current.GetControllerFactory();
        //mock a context...
        var httpContext = CreateHttpContext("http://localhost:14478/home", "GET");
        RouteData route = routes.GetRouteData(httpContext);

        var ctrlInstance = factory.CreateController(new RequestContext(httpContext, route), (string)route.Values["controller"]);

        //ASSERT the instance is of type "HomeController"
        //...
     } 
```

它失败了，说`'http://localhost:14478/home' completed successfully without running the test.`

我注意到在 VS 输出窗口中，也有这条消息`No connection could be made because the target machine actively refused it 127.0.0.1:14478`。我想卡西尼一定不能活跃。所以我选择在启动单元测试之前启动正在测试的站点（ctrl+F5）。然后将 VS 输出更改为：

> WebTestAdapter.ConnectToHostAdapter：发生意外异常。Microsoft.VisualStudio.TestTools.HostAdapters.AbortTestExecutionException：应用程序出错。在 Microsoft.VisualStudio.TestTools.HostAdapters.WebTestAdapter.ConnectToHostAdapter()

为了解决这个问题，我遵循了这些文章的建议：

*   [在 ASP.NET 解决方案中运行测试时进行调试](http://msdn.microsoft.com/en-us/library/ms243172.aspx)
*   [ASP.NET Web 服务的单元测试](http://msdn.microsoft.com/en-us/library/ms243172.aspx)：这讨论了“在没有运行测试的情况下成功完成”错误。
*   [配置 ASP.NET 单元测试](http://www.skonet.com/Articles_Archive/How_To_Configure_ASP_NET_Unit_Tests_in_Visual_Studio_2010.aspx)：我从这篇文章中得到了 $(SolutionDir) 的想法。

...但无论我做什么，我仍然会收到错误消息。建议？

**更新/澄清**
这个问题**不是**关于测试 MVC 路由。这个问题的目的是发现如何正确初始化 ASP.NET MVC 以允许更“深入”的自动化测试。我选择了一个针对 DefaultControllerFactory 的“路由测试”场景，仅作为示例。在此示例中，除非正确初始化 ASP.NET MVC，否则 DefaultControllerFactory 不会正常运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T02:47:53.703

这是测试 MVC 应用程序时的常见要求，幸运的是，有一个框架可以在测试 MVC 控制器时简化您的生活：

工具是：

[http://mvccontrib.codeplex.com/](http://mvccontrib.codeplex.com/)

作为一个例子，你可以只用一行来创建测试：

```
"~/".ShouldMapTo<HomeController>(controller => controller.Index()); 
```

作为参考：

[http://geekswithblogs.net/thomasweller/archive/2009/11/02/unit-testing-asp.net-mvc-routes.aspx](http://geekswithblogs.net/thomasweller/archive/2009/11/02/unit-testing-asp.net-mvc-routes.aspx)

[http://www.arrangeactassert.com/how-to-unit-test-asp-net-mvc-controllers/](http://www.arrangeactassert.com/how-to-unit-test-asp-net-mvc-controllers/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T20:18:57.460

您可能有兴趣查看 Steve Sandersons MVC 测试框架。如果您下载源代码，您将有一个很好的示例来说明如何初始化 MVC 框架：

[http://blog.codeville.net/2009/06/11/integration-testing-your-aspnet-mvc-application/](http://blog.codeville.net/2009/06/11/integration-testing-your-aspnet-mvc-application/)

# javascript - 推荐的 jslint 配置？

> ID：10489691
> 
> 赞同：6
> 
> 时间：2012-05-07T21:53:05.697
> 
> 标签：javascript, jslint

[JSlint](http://www.jslint.com/)允许在脚本开头的注释块中设置选项，其中一些可以帮助减少使用的烦人。我希望有更多的生产力。

我选择了这些开始：

```
/*jslint devel: true, browser: true, unparam: true, debug: false, es5: true, white: true, maxerr: 50, indent: 4 */ 
```

什么是既定的默认值？

[我真的想让它不主观，但是是的，我想知道什么对你有用]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T21:55:33.030

基本上这对我有用，禁用了所有烦人的东西。

```
/*jslint white: true, browser: true, devel: true, windows: true, forin: true, vars: true, nomen: true, plusplus: true, bitwise: true, regexp: true, sloppy: true, indent: 4, maxerr: 50 */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T08:04:47.790

“使用起来不那么烦人”是什么意思？不使用 JSLint 是最不烦人的。

在 JSLint 中已经默认设置了默认值；因此，默认值为“无覆盖”。但是，在某些情况下，您必须覆盖默认值；对您来说，这可能是`browser: true`（允许 javascript 与浏览器交互）和`devel: true`（如果您想使用`alert`等`console.log`；顺便说一句，请考虑改用浏览器的集成调试器）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-20T11:59:15.177

您可以安装[Komodo Edit](http://komodoide.com/komodo-edit/)（开源编辑器）并将其配置工具用于 JsLint 或 JsHint，以下是 JsLint 的配置工具：

![在此处输入图像描述](../Images/48e6b5901664031d149fb7bbe8c78e4a.png)

它为您提供了配置字符串

![在此处输入图像描述](../Images/f0533752f4d376387c6dc90a3fea0641.png)

# c# - 在运行时设置 xmlrpc.net 服务 url

> ID：10489695
> 
> 赞同：2
> 
> 时间：2012-05-07T21:53:17.787
> 
> 标签：c#, .net, wordpress, attributes, xml-rpc

我喜欢通过 xmlrpc 界面与我的一些 wordpress 博客进行交互。在我的研究过程中，我发现 xml-rpc.net-Library (www.xml-rpc.net) 除了一件事之外，它工作得非常好。

我像这样构建我的 xmlrpc.net 实例：

```
[XmlRpcUrlAttribute("http://my-example-blog.com/xmlrpc.php")]
public class WP : XmlRpcClientProtocol
{
    public WP()
    {

    }

    ...
} 
```

但我想在运行时动态设置 xmlrpc-Url。所以我喜欢在运行时的 UI 期间添加更多的博客，并且不想实现每个博客“硬编码”。

有没有人有同样的问题，可以帮助我吗？xmlrpc.net-library 中是否还有另一种可能性，或者您知道另一个好的 xmlrpc 库吗？

问候，拉菲

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T21:48:05.643

您可以在运行时指定 URL：

```
proxy.Url = "http://my-example-blog.com/xmlrpc.php"; 
```

# objective-c - 可调整大小的图像资源，带有嵌入的 cap insets

> ID：10489696
> 
> 赞同：1
> 
> 时间：2012-05-07T21:53:17.867
> 
> 标签：objective-c, ios, uiimage, png

到目前为止，这不是一个引人注目的问题，只是我已经好奇了一段时间了。

有一个众所周知的`-[UIImage resizableImageWithCapInsets:]`用于创建可调整大小的图像的 API，它在对可变大小的按钮和框架进行纹理处理时非常方便，尤其是在视网膜 iPad 上，特别是如果您有很多这样的 API，并且您希望避免使用图像资源使应用程序包变得臃肿。

对于给定的图像，无论我们想要将其拉伸到多大的大小，cap insets 通常是恒定的。我们也可以这样说：帽子插图是给定图像的*特征。*所以事情就是这样：如果它们在逻辑上属于图像，为什么我们不将它们*与图像一起*存储（作为某种元数据），而不是在我们必须创建新实例的任何地方指定它们？

在日常实践中，这可能会产生严重的好处，主要是通过消除过程中出现人为错误的可能性。如果创建图像的设计人员可以在导出图像文件本身时嵌入适当的上限值，那么开发人员将不再需要在代码中编写幻数并在每次图像更改时更新它们。resizableImage API 可以自动读取和应用大小写。哎呀，即使是一个类别`UIImage`也可以。

因此我的问题是：是否有任何**可靠**的方式将元数据**嵌入**图像中？

我想强调这两个词：

*   **可靠**：我已经在可选的 PNG 块上看到了一些条目，但我担心一旦 iOS PNG 优化器启动，这些条目就会消失。或者有没有办法防止这种情况发生？（以及让优化器完成它的工作）
*   **嵌入**：我曾考虑在文件名中包含元数据，类似于 Apple 所做的，即“@2x”、“~ipad”等，但具有千米长的名称，如“image-20.0-20.0-40.0-20.0@2x”。 png”似乎不是正确的方法。

任何人都可以想出聪明的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T21:58:10.000

Android 有一个名为九补丁的文件类型，它基本上是图像和元数据的片段来构建它。也许可以制作一个类来复制它。[http://developer.android.com/reference/android/graphics/NinePatch.html](http://developer.android.com/reference/android/graphics/NinePatch.html)

# sql - DB2-如何检查 varchar 字段值是否具有整数

> ID：10489703
> 
> 赞同：17
> 
> 时间：2012-05-07T21:54:08.377
> 
> 标签：sql, db2

是否有内置的 DB2 函数或任何查询来检查我拥有的字符是否是数字？（我不能使用用户定义的函数）

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-07T21:58:01.043

[文档链接](http://www.ibm.com/support/knowledgecenter/SSEPEK_10.0.0/sqlref/src/tpc/db2z_bif_translate.html)

```
CASE
  WHEN LENGTH(RTRIM(TRANSLATE(test_str, '*', ' 0123456789'))) = 0 
  THEN 'All digits'
  ELSE 'No'
END 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-10-21T04:12:31.433

如果您的 db2 版本可以使用 regexp_like，您可以这样做：

带“.”的数字 作为十进制符号：

```
 select *      from yourtable                            
 where REGEXP_LIKE(trim(yourzone) , '^\d+(\.\d*)?$') 
```

以“，”作为十进制符号的数字：

```
 select *      from yourtable                            
 where REGEXP_LIKE(trim(yourzone) , '^\d+(\,\d*)?$') 
```

没有小数点的数字（仅限整数，您的问题）

```
 select *      from yourtable                  
 where REGEXP_LIKE(trim(yourzone) , '^\d+$') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-21T21:14:29.780

有很多方法。仅使用两个函数查看该解决方案：

```
CASE
    WHEN REPLACE(TRANSLATE(test_str, '0','123456789','0'),'0','') = ''
    THEN 'All digits'
    ELSE 'Not all digits'
END 
```

一般来说 - 更少的功能 - 更好的性能:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T22:00:43.977

使用 ASCII 函数获取字符值并比较它在 48 '0' 和 57 '9' 之间

[ASCII 表](http://www.asciitable.com/)

ASCII 函数 以整数形式返回参数最左边字符的 ASCII 码值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-03T07:19:57.797

xQbert 的答案并不完全正确。您实际需要的是 fromString 中的每个字符的 * （并且需要删除空格），并且 to 字符串的长度需要与原始字符串的长度相同。

所以它看起来像这样：

```
CASE
  WHEN LENGTH(RTRIM(TRANSLATE(test_str, '**********', '0123456789'))) = LENGTH(RTRIM(test_str)) 
  THEN 'All digits'
  ELSE 'No'
END 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-29T19:01:19.607

返回数字，其中 char 字段是所有数字，没有前导或尾随空格。IE; 字段中的所有字符都是数字：

```
where translate(char_field, 'X         ',' 0123456789') = ' ' 
```

返回非数字值，前导空格被视为非数字，但尾随空格被忽略。IE; 如果有前导空格，则为非数字，但如果有尾随空格，则不是。这是大型机/Cobol 加载字段的常见情况：

```
where not ( length(rtrim(translate(substr(char_field,1,length(rtrim(char_field))),'         ','0123456789'))) = 0) 
```

返回值后带有尾随但不前导空格的数字。IE; 前导空格被视为非数字，但尾随空格被忽略。同样，对于大型机/Cobol CHAR 字段很常见：

```
where ( length(rtrim(translate(substr(char_field,1,length(rtrim(char_field))),'X         ',' 0123456789'))) = 0) 
```

返回带有前导和尾随空格的数字。IE; 在确定字段为“数字”时忽略前导和尾随空格：

```
where ( length(ltrim(rtrim(translate(substr(char_field,1,length(ltrim(rtrim(char_field)))),'         ','0123456789')))) = 0) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-24T22:47:34.033

我根据 xQbert 公开的想法制作了更容易出错的版本，添加了中间结果，一些示例和 to_integer 列，它将字符串值安全地转换为整数：

```
select 
      test_str
    ,                  TRIM(TRANSLATE(replace(trim(test_str), ' ', 'x'), '           ', '0123456789'))
    , case when length(TRIM(TRANSLATE(replace(trim(test_str), ' ', 'x'), '           ', '0123456789')))=0 
      then cast(test_str as int) else null end to_integer
    , case when length(TRIM(TRANSLATE(replace(trim(test_str), ' ', 'x'), '           ', '0123456789')))=0 
      then 'integer'  else 'not integer' end is_integer
from (VALUES 
        ('  123  '  )
        ,('  abc  ' )
        ,('  a12  ' )
        ,('  12 3  ')
        ,('  99.3  ')
        ,('993'     )
    ) AS X(test_str)
; 
```

此示例集的结果是：

```
TEST_STR 2        TO_INTEGER  IS_INTEGER
-------- -------- ----------- -----------
  123                     123 integer
  abc    abc                - not integer
  a12    a                  - not integer
  12 3   x                  - not integer
  99.3   .                  - not integer
  993                     993 integer 
```

# c++ - 如何在 Boost::Statechart 中为一个状态添加 20 多个转换？

> ID：10489710
> 
> 赞同：1
> 
> 时间：2012-05-07T21:54:50.500
> 
> 标签：c++, gcc, boost, boost-statechart

我不得不承认我对 C++ 和 Boost Statecharts 还很陌生。我玩了一下 Statechart 库，想构建一些“更大”的状态机。

我举了一个非常简单的例子来说明我的问题。让我们假设一个状态机只有一个状态和很多自转换。如何构建这样的东西？gcc(4.5.2) 编译器拒绝超过 20 个转换的所有内容（“模板参数的数量错误（21，应该是 20）”）

这是一些示例代码：

```
#include <boost/statechart/event.hpp>
#include <boost/statechart/state_machine.hpp>
#include <boost/statechart/simple_state.hpp>
#include <boost/statechart/transition.hpp>
#include <iostream>
#include <boost/mpl/list.hpp>
namespace sc = boost::statechart;

struct MyEvent1: sc::event<MyEvent1> {};
struct MyEvent2: sc::event<MyEvent2> {};
//...
struct MyEvent21: sc::event<MyEvent21> {};

struct MyState;
struct Statemachine: sc::state_machine<Statemachine, MyState> {};

struct MyState: sc::simple_state<MyState, Statemachine> {
    typedef boost::mpl::list<
            sc::transition< MyEvent1, MyState >  , 
            sc::transition< MyEvent2, MyState > , 
            //...
            sc::transition< MyEvent21 >     
    > reactions;
};

int main() {
    //..
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T22:00:13.680

您的问题实际上与 Boost.Statechart 无关，而是与您正在使用其类型列表的 Boost.MPL 相关。来自[Boost.MPL 文档](http://www.boost.org/libs/mpl/doc/refmanual/limit-list-size.html)：

> `BOOST_MPL_LIMIT_LIST_SIZE`是一个可覆盖的配置宏，用于调节`list`' 和`list_c`' 的可变参数形式的最大数量。在这个库的实现中，`BOOST_MPL_LIMIT_LIST_SIZE`默认值为 20。

它继续：

> 要覆盖默认限制，请*在包含任何 library header 之前*`BOOST_MPL_LIMIT_LIST_SIZE`定义所需的最大数量，四舍五入到最接近的十的倍数。

 *所以大概你会在任何`#include`s 之前想要以下内容：

```
#define BOOST_MPL_LIMIT_LIST_SIZE 30 
```*

# hibernate - jBPM 持久性：无法构建 EntityManagerFactory

> ID：10489713
> 
> 赞同：3
> 
> 时间：2012-05-07T21:55:06.787
> 
> 标签：hibernate, jbpm

我正在尝试使我的 jBPM 项目持久化。因此我使用了本[教程](http://docs.jboss.org/jbpm/v5.2/userguide/ch07.html)。起初我导入了所有需要的额外罐子（根据网站）。我还添加了`mysql-connector-java-5.1.20-bin.jar`因为我想使用 mysql 作为持久存储。

之后，我将“有状态”代码添加到我的项目中：

```
KnowledgeBase kbase = readKnowledgeBase(name);
StatefulKnowledgeSession ksession = null;
JBPMHelper.startH2Server();
JBPMHelper.setupDataSource();
if(ProcessManager.sessionId == -1){
    ksession = JBPMHelper.newStatefulKnowledgeSession(kbase);
    ProcessManager.sessionId = ksession.getId();
}
else {
ksession = JBPMHelper.loadStatefulKnowledgeSession(
    kbase,
    ProcessManager.sessionId);
} 
```

然后我添加到`resources/META-INF`文件中`jBPM.properties`：

> persistence.datasource.name=jdbc/jbpm-ds
> 
> persistence.datasource.user=test
> 
> persistence.datasource.password=测试
> 
> persistence.datasource.url=jdbc:mysql://localhost:3306/helpme
> 
> persistence.datasource.driverClassName=com.mysql.jdbc.Driver
> 
> 持久性.启用=真
> 
> persistence.persistenceunit.name=org.jbpm.persistence.jpa
> 
> persistence.persistenceunit.dialect=org.hibernate.dialect.MySQLDialect

如果我现在运行该项目，总是会出现以下异常（on `ksession = JBPMHelper.newStatefulKnowledgeSession(kbase);`）：

> javax.persistence.PersistenceException：[PersistenceUnit：org.jbpm.persistence.jpa] 无法构建 EntityManagerFactory
> 
> 引起：org.hibernate.HibernateException：找不到数据源
> 
> 原因：javax.naming.NameNotFoundException：名称 jdbc 未绑定在此上下文中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-08T19:19:06.043

我为我的问题找到了解决方案。通常`JBPMHelper`直接从[jar](https://github.com/droolsjbpm/jbpm/blob/master/jbpm-test/src/main/java/org/jbpm/test/JBPMHelper.java)加载 jBPM ：

```
public static Properties getProperties() {
    Properties properties = new Properties();
    try {
        properties
            .load(JBPMHelper.class.getResourceAsStream("/jBPM.properties"));
    } catch (Throwable t) {
    // do nothing, use defaults
    }

    return properties;
} 
```

我更换了加载机制，现在它正在`jBPM.properties`正确加载：

```
public static Properties getProperties() {
    Properties properties = new Properties();
    try {
        InputStream input
            = new FileInputStream("./resources/META-INF/jBPM.properties");
        properties.load(input);
        System.out.println("RPOP"+properties.toString());
    } catch (Throwable t) {
    // do nothing, use defaults
    }

    return properties;
} 
```

（我的回答改编自 BartoszKP - 谢谢）

# jpa - 如何使用 Criteria Builder 正确创建嵌套联接

> ID：10489716
> 
> 赞同：0
> 
> 时间：2012-05-07T21:55:23.060
> 
> 标签：jpa, join, nested, eclipselink

我有三个实体**School**，**Department**，**Program**，每当我尝试加入其中两个实体时，都会引用第三个实体，因此我正在寻找一个使用标准构建器的示例，以了解如何正确从**Root<>**实体开始并加入适当地。

我的学校**实体**是造成问题的实体。

```
public class School {

@NotNull
private String name;

@NotNull
private String code;

@OneToMany(cascade = CascadeType.ALL, mappedBy = "schoolDepartment")
private Set<Department> departments = new HashSet<Department>();

@OneToMany(cascade = CascadeType.ALL, mappedBy = "school")
private Set<Program> programs = new HashSet<Program>();
} 
```

**程序实体**

```
public class Program {

@NotNull
@Size(min = 0, max = 300)
private String name;

@NotNull
@Size(min = 0)
private String description;

private String code;

@Enumerated(EnumType.STRING)
private ProgramType programType;

@ManyToOne
private School school; 
```

我尝试仅加入上面的两个实体而 EclipseLink 去引用第三个实体的尝试失败了？

```
 // FROM program JOIN School 
Root<Program> program = cq.from(Program.class);

Join<School,Program> school =  program.join("school" , JoinType.INNER);
            //Join<School, Department> departmentJoin =    school.join("schoolDepartment", JoinType.LEFT);

             // SELECT task as Task, person as Person, ... 
             cq.multiselect(program,school);
             return program;  // EclipseLink requires a joined entity for the count 
```

包含生成的 SQL 的完整堆栈跟踪。请注意它是如何开始引用 School 实体然后在 Department 实体上调用 ReadAllObjectQuery 的？

```
[EL Fine]: sql: 2012-05-06 17:34:52.886--ServerSession(1839972036)--Connection(131165903)--Thread(Thread["http-bio-8080"-exec-3,5,main])--SELECT t0.id, t0.CODE, t0.NAME, t0.version, t1.programID, t1.ACTIVE, t1.CODE, t1.DESCRIPTION, t1.NAME, t1.PROGRAMTYPE, t1.REQUIREDCREDITS, t1.version, t1.SCHOOL_id FROM SCHOOL t0 LEFT OUTER JOIN PROGRAM t1 ON (t1.SCHOOL_id = t0.id), SCHOOL t2 WHERE (t2.id = t1.SCHOOL_id)
[EL Finest]: connection: 2012-05-06 17:34:52.888--ServerSession(1839972036)--Connection(354961667)--Thread(Thread["http-bio-8080"-exec-3,5,main])--Connection released to connection pool [read].
2012-05-06 17:34:52,896 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.annotation.InjectionMetadata - Processing injected method of bean 'org.bixin.dugsi.domain.School': PersistenceElement for transient javax.persistence.EntityManager org.bixin.dugsi.domain.School.entityManager
2012-05-06 17:34:52,896 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'entityManagerFactory'
2012-05-06 17:34:52,899 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.annotation.InjectionMetadata - Processing injected method of bean 'org.bixin.dugsi.domain.School': PersistenceElement for transient javax.persistence.EntityManager org.bixin.dugsi.domain.School.entityManager
2012-05-06 17:34:52,900 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'entityManagerFactory'
2012-05-06 17:34:52,901 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.annotation.InjectionMetadata - Processing injected method of bean 'org.bixin.dugsi.domain.School': PersistenceElement for transient javax.persistence.EntityManager org.bixin.dugsi.domain.School.entityManager
2012-05-06 17:34:52,901 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'entityManagerFactory'
2012-05-06 17:34:52,902 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.annotation.InjectionMetadata - Processing injected method of bean 'org.bixin.dugsi.domain.Program': PersistenceElement for transient javax.persistence.EntityManager org.bixin.dugsi.domain.Program.entityManager
2012-05-06 17:34:52,903 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'entityManagerFactory'
[EL Finest]: query: 2012-05-06 17:34:52.904--ServerSession(1839972036)--Thread(Thread["http-bio-8080"-exec-3,5,main])--Execute query ReadObjectQuery(name="school" referenceClass=School )
2012-05-06 17:34:52,908 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.annotation.InjectionMetadata - Processing injected method of bean 'org.bixin.dugsi.domain.Program': PersistenceElement for transient javax.persistence.EntityManager org.bixin.dugsi.domain.Program.entityManager
2012-05-06 17:34:52,908 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'entityManagerFactory'
[EL Finest]: transaction: 2012-05-06 17:34:52.908--UnitOfWork(2138845270)--Thread(Thread["http-bio-8080"-exec-3,5,main])--[EL Finest]: query: 2012-05-06 17:34:52.91--ServerSession(1839972036)--Thread(Thread["http-bio-8080"-exec-3,5,main])--Execute query ReadAllQuery(name="departments" referenceClass=Department )
[EL Finest]: connection: 2012-05-06 17:34:52.911--ServerSession(1839972036)--Connection(32490450)--Thread(Thread["http-bio-8080"-exec-3,5,main])--Connection acquired from connection pool [read].
[EL Finest]: connection: 2012-05-06 17:34:52.911--ServerSession(1839972036)--Thread(Thread["http-bio-8080"-exec-3,5,main])--reconnecting to external connection pool
[EL Fine]: sql: 2012-05-06 17:34:52.912--ServerSession(1839972036)--Connection(606146812)--Thread(Thread["http-bio-8080"-exec-3,5,main])--SELECT id, ACTIVE, CODE, DESCRIPTION, NAME, version, SCHOOLDEPARTMENT_id FROM DEPARTMENT WHERE (SCHOOLDEPARTMENT_id = ?)
    bind => [1]
[EL Finest]: connection: 2012-05-06 17:34:52.913--ServerSession(1839972036)--Connection(32490450)--Thread(Thread["http-bio-8080"-exec-3,5,main])--Connection released to connection pool [read].
2012-05-06 17:34:52,914 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.annotation.InjectionMetadata - Processing injected method of bean 'org.bixin.dugsi.domain.Department': PersistenceElement for transient javax.persistence.EntityManager org.bixin.dugsi.domain.Department.entityManager
2012-05-06 17:34:52,914 ["http-bio-8080"-exec-3] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'entityManagerFactory'
[EL Finest]: query: 2012-05-06 17:34:52.915--ServerSession(1839972036)--Thread(Thread["http-bio-8080"-exec-3,5,main])--Execute query ReadObjectQuery(name="schoolDepartment" referenceClass=School )
[EL Finest]: query: 2012-05-06 17:34:52.915--ServerSession(1839972036)--Thread(Thread["http-bio-8080"-exec-3,5,main])--Execute query ReadAllQuery(name="programs" referenceClass=Program )
[EL Finest]: connection: 2012-05-06 17:34:52.916--ServerSession(1839972036)--Connection(63558014)--Thread(Thread["http-bio-8080"-exec-3,5,main])--Connection acquired from connection pool [read].
[EL Finest]: connection: 2012-05-06 17:34:52.916--ServerSession(1839972036)--Thread(Thread["http-bio-8080"-exec-3,5,main])--reconnecting to external connection pool
[EL Fine]: sql: 2012-05-06 17:34:52.917--ServerSession(1839972036)--Connection(920168739)--Thread(Thread["http-bio-8080"-exec-3,5,main])--SELECT programID, ACTIVE, CODE, DESCRIPTION, NAME, PROGRAMTYPE, REQUIREDCREDITS, version, SCHOOL_id FROM PROGRAM WHERE (SCHOOL_id = ?) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T22:29:11.890

我添加`fetch = FetchType.Eager`到每个 OneToMany 关系，因为它是延迟加载所有引用实体。不知道这是否是性能问题，但我想我还是需要这些列

# java - java urlconnection不会抛出sockettimeoutexception

> ID：10489717
> 
> 赞同：4
> 
> 时间：2012-05-07T21:55:24.543
> 
> 标签：java, networking, io

我经常遇到 java httpurlconnections，即使使用`setReadTimeOut()`，它也不会在应该抛出 sockettimeoutexception 时抛出异常，并且它始终与最终（挂起 2-3 分钟后）过早的 EOF 异常相关联。我在一些博客中读到，这可能与使用 BufferedReader 的 readLine 方法 String x = ""; 读取有关。而((x=bufferedReader.readLine())!=null){}

如果输入流末尾没有换行符，则在文件末尾。这没有意义，为什么java的setTimeOut函数不正确？

```
 URL url=new URL("");
      c=(HttpURLConnection)url.openConnection();
      c.setReadTimeout(17000);
      BufferedReader b = new BufferedReader(new InputStreamReader(c.getInputStream()));
      String s;

      while((s=b.readLine())!=null)
      {     
          } ect.

    java.io.IOException: Premature EOF
at sun.net.www.http.ChunkedInputStream.readAheadBlocking(Unknown Source)
at sun.net.www.http.ChunkedInputStream.readAhead(Unknown Source)
at sun.net.www.http.ChunkedInputStream.read(Unknown Source)
at java.io.FilterInputStream.read(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read(Unknown Source)
at sun.nio.cs.StreamDecoder.readBytes(Unknown Source)
at sun.nio.cs.StreamDecoder.implRead(Unknown Source)
at sun.nio.cs.StreamDecoder.read(Unknown Source)
at java.io.InputStreamReader.read(Unknown Source)
at java.io.BufferedReader.fill(Unknown Source)
at java.io.BufferedReader.readLine(Unknown Source)
at java.io.BufferedReader.readLine(Unknown Source) 
```

以下是响应标头（截断了确切的 cookie 信息）：

```
 [HTTP/1.1 200 OK]
     p3p ["",""]
     x-frame-options [SAMEORIGIN]
     Date [Tue, 08 May 2012 15:01:40 GMT]
     Vary [Accept-Encoding,User-Agent]
     Transfer-Encoding [chunked]
     Set-cookie [""=""; path=/; domain=""; expires=Tue, 01-Jan-2036 08:00:01 GMT]
     Content-Type [text/html; charset=ISO-8859-1]
     Server [Server] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:11:00.167

请参阅[setReadTimeout](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLConnection.html#setReadTimeout%28int%29)的文档：

```
Some non-standard implementation of this method ignores the specified timeout. 
```

如果您认为这不是问题，请将超时设置为非常低的数字，例如 1 并检查。你应该得到一个`java.net.SocketTimeoutException`例外。

# ruby-on-rails - Rails JQuery选项卡未清除

> ID：10489718
> 
> 赞同：0
> 
> 时间：2012-05-07T21:55:29.147
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery-ui, tabs, jquery-tabs

我有一个显示页面，它使用 JQuery-ui 选项卡根据选项卡选择动态加载内容。

这是我的页面：

```
<%= stylesheet_link_tag 'upload.css', :media => 'screen' %>
<%= javascript_include_tag "tabs"%>

<div id="tabs">
    <ul>
        <li id="active"><%= link_to "Description" , :id => @upload.id, :action => "description"%></li>          
        <li><%= link_to "Images" , :id => @upload.id, :action => "images"%></li>
    </ul>

<div id="#content_area">
</div>
</div> 
```

这是我的jQuery：

```
//= require jquery
//= require jquery-ui

$(document).ready(function(){
    var $tabs = $("#tabs").tabs({ select: function(event, ui) {
                                          $(ui.panel).empty();
                                      }
                               });
}); 
```

现在应该发生的是我单击一个选项卡，它会动态加载相应的内容并清除旧内容。就目前而言，当我单击选项卡时，它确实设法动态加载内容，但它并没有完全清除旧的东西。它的作用是在我单击选项卡并将其保留在那里时加载内容。但是，如果我要单击同一个选项卡，它将刷新内容。这不是我想要的，我只想在单击图像选项卡时查看图像内容，并在单击描述选项卡时查看描述内容。

如何修改我的 JQuery 来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T14:40:55.493

它现在通过更改 JQuery 以清除 JQuery-tab 动态创建的两个类来工作。我只是在通过 firebug 查看生成的 HTML 后才注意到它们（注意：我还添加了一些“正在加载...”文本以用于加载选项卡时）：

```
//= require jquery
//= require jquery-ui

$(document).ready(function(){
    var $tabs = $("#tabs").tabs({ select: function(event, ui) {                                         
                                          $("#ui-tabs-1").empty();
                                          $("#ui-tabs-2").empty();
                                          if($.data(ui.tab, 'load.tabs')) {
           $(ui.panel).html("Loading...");
       }

                                      }
                               });
}); 
```

# amazon-s3 - 删除空 S3 存储桶

> ID：10489720
> 
> 赞同：2
> 
> 时间：2012-05-07T21:55:33.467
> 
> 标签：amazon-s3, buckets

我正在尝试删除一个 EMPTY S3 存储桶。

我已经删除了所有内容，如果我进入 S3 浏览器中的存储桶内部，它会显示：“存储桶 'blankety.blank.blank' 是空的”

然而，当我尝试删除存储桶时，它给出了错误：“您尝试删除的存储桶不是空的。请删除存储桶内的所有对象和文件夹，然后重试。”

我已经删除了很多存储桶，并且我熟悉该过程。？？？不知道现在该怎么办。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T09:10:10.493

如果您收到桶不是空的错误消息，这意味着它可能在桶中有一些对象。您还会通过使用工具收到存储桶为空的消息。即显示正常上市的结果。存储桶 如果您曾经在该存储桶上设置了版本控制启用，那么存储桶中可能存在一些版本对象。

现在列出版本对象，如果找到任何版本对象，则删除所有版本对象，然后再次尝试删除存储桶。

删除所有对象以及版本对象后，您可以删除存储桶。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-25T18:27:28.083

只需安装 eclipse 和 aws 工具。然后只需删除您想要的所有存储桶。我有同样的问题，这解决了我的问题

# php - Netbeans 可以通过 XDebug 报告 PHP 异常吗？

> ID：10489722
> 
> 赞同：1
> 
> 时间：2012-05-07T21:55:40.157
> 
> 标签：php, debugging, exception, netbeans, xdebug

我已经安装了 NB 7.1、WAMPP 1.7.7（带有 PHP 5.3.8）和 XDebug 2.1.4。我可以检查断点上的变量，好的。但如果发生异常，则 Netbeans 不知道这一点，而浏览器显示 xdebug 格式的调用堆栈。NB 仍然认为“netbeans-xdebug”正在“运行”。所以我的问题是：Netbeans 可以报告 PHP 异常吗？

* * *

## 关于@Andy 的解决方案

我准备此代码进行测试：

```
<?php

function exceptionHandler($ex) {
    echo 'Uncaught exception: ', $ex->getMessage(), "\n"; // BREAKPOINT
}
set_exception_handler('exceptionHandler');

function errorHandler($errno, $errstr, $errfile, $errline) {
    throw new ErrorException($errstr, 0, $errno, $errfile, $errline);
}
set_error_handler('errorHandler');

throw new Exception;
phpinfo();

?> 
```

Netbeans 停止并报告我的断点，因此解决了一个问题。但 NB 立即显示标题为“Socket Exception”的警报，并附有文字：

> **发生套接字异常**
> 
> 如果您有手表，请尝试删除它们并重新启动调试器。如果删除 Watches 没有帮助或者您没有任何 Watches，请提交问题并提供重现问题的确切步骤。请附上IDE日志。附加您的项目也将非常有帮助。

我认为 PHP 在发生异常时终止，因此 xdebug 必须停止并且 Netbeans 会丢失配音数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T22:27:27.773

当您在 Netbeans 中启动调试模式并且未处理的异常通过时，它会输出到您的浏览器，就像您没有运行调试器时一样。

Netbeans 不会神奇地抓住它们。即，您不能以与查看变量内容相同的方式分析它们。

"netbeans-xdebug" is "running" 仍然显示，因为它实际上仍在运行并将继续运行，直到您自己停止它或调试会话发生一些严重错误，这可能与 php 无关。通常，如果发生重大错误，您会看到一些弹出窗口。如果您自己停止它，netbeans 将在您的浏览器中创建一个新选项卡，说明 xdebug 会话已结束。

如果您在浏览器中点击刷新，则 netbeans 将捕获请求并对其进行分析，如果您设置了断点，它将在断点处停止。处理该请求后，如果您再次点击刷新，netbeans 将继续捕获任何进来的请求。

编辑：我在 xdebug 站点上发现的一件事可能会在以下选项中以某种方式对您有所帮助。

```
xdebug.show_exception_trace
 Type: integer, Default value: 0 
When this setting is set to 1, Xdebug will show a stack trace whenever 
an exception is raised - even if this exception is actually caught. 
```

您可以在 xdebug 部分的 php.ini 文件中设置此选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T21:23:20.717

这种情况的一种解决方法是使用 set_error_handler() 函数设置自定义错误处理程序，然后在该自定义错误处理程序内设置断点。发生错误时，netbeans 将在您的断点处停止，您将拥有对调用堆栈的完全访问权限，您可以在其中查看错误发生时的任何变量。

# php - PHP：连接数组中的可能组合

> ID：10489723
> 
> 赞同：-1
> 
> 时间：2012-05-07T21:55:52.590
> 
> 标签：php, loops, combinations

我有一个数组，其中包含不同组合的字符串集/组（在本例中为小写和大写）。我正在尝试循环这个数组 - 使用 php - 并从原始字符串可以组成的所有可能组合中生成新的字符串。

数组如下所示：

```
Array
(
    [0] => Array
        (
            [0] => ALFA
            [1] => alfa
        )
    [1] => Array
        (
            [0] => BETA
            [1] => beta
        )
    [2] => Array
        (
            [0] => DELTA
            [1] => delta
        )
) 
```

我想要的输出应该是这样的：

```
ALFA
ALFA BETA
ALFA beta
ALFA DELTA
ALFA delta
ALFA BETA DELTA
ALFA BETA delta
ALFA beta beta
ALFA DELTA BETA
ALFA DELTA beta
ALFA delta BETA
ALFA delta beta
alfa 
alfa BETA
alfa beta
alfa DELTA
alfa delta
alfa BETA DELTA
alfa BETA delta
alfa beta beta
alfa DELTA BETA
alfa DELTA beta
alfa delta BETA
alfa delta beta
BETA
BETA ALFA
BETA alfa
BETA DELTA
BETA delta
BETA ALFA delta
BETA ALFA DELTA
BETA alfa delta
BETA alfa DELTA
BETA DELTA alfa
BETA DELTA ALFA
BETA delta alfa
BETA delta ALFA
beta
beta ALFA
...
... 
```

我花了一整天的时间试图弄清楚这一点，但被卡住了。非常感谢任何输入或帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:06:00.417

您可以存储一个仅包含这些字符串的小写版本的数组，然后将其动态大写（[strtoupper](http://php.net/manual/en/function.strtoupper.php)完成了这项工作）。

然后使用嵌套`for`循环或递归遍历数组的每个元素以及`echo`所需的各种组合（只需跳过在两层迭代（或递归）中位于同一元素上的情况）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:49:36.517

使用

```
class CartesianProductIterator implements Iterator {
    protected $iterators;

    function __construct(array $iters) {
        $this->iterators = $iters;
    }

    function rewind() {
        foreach ($this->iterators as $it) {
            $it->rewind();
        }
    }

    function current() {
        $values = array();
        foreach ($this->iterators as $it) {
            $values[] = $it->current();
        }
        return $values;
    }

    function key() {
        return null;
    }

    function next() {
        /*      
        loop them in reverse, but exclude first
        why? example, odometer: 55199
        you always check the rightmost digit first to see if incrementing it would roll it over and need to be "rewound" to 0, 
        which causes the digit to the left to increase as well, which may also cause it to roll over as well, and so on...
        looping in reverse operates from right column to the left.
        we dont rewind the first column because if the leftmost column is on its last element and needs to roll over
        then this iterator has reached its end, and so rewind() needs to be explicitly called 
        */
        for ($i = count($this->iterators) - 1; $i > 0; --$i) {
            $it = $this->iterators[$i];
            $it->next();
            if ($it->valid()) {
                // were done advancing because we found a column that didnt roll over
                return;
            } else {
                $it->rewind();
            }
        }

        //if execution reached here, then all of the columns have rolled over, so we must attempt to roll over the left most column
        $this->iterators[0]->next();
    }

    function valid() {
        return $this->iterators[0]->valid();
    }
} 
```

您可以按如下方式专门使用它

```
$iterators = array();
foreach ($arr as $possibleChoicesForOneSlotInACombo) {
    //we add null as a way indicate "no value" as a choice for this slot
    $possibleChoicesForOneSlotInACombo[] = null;
    $iterators[] = new ArrayIterator($possibleChoicesForOneSlotInACombo);
}

foreach (new CartesianProductIterator($iterators) as $combo) {
    //filter out the possible nulls that might exist in this combo
    $strings = array_filter($combo, 'is_string');

    // make sure something exists, maybe they were all null
    if ($strings) {
        echo join(' ', $strings), "\n";
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T22:30:55.947

同意@Mahmoud Al-Qudsi，这似乎是一个奇怪的问题，如果阵列大于微不足道的大小，很容易破坏您的服务器。您确实意识到我们在这里谈论的是阶乘 - 如果您的数组有 10 个元素，那么仅在一种情况下，所有 10 个字符串的排列数就是 10！也就是 350 万 加上大小写版本，加上 9、8 等元素的字符串组合，我们正在谈论非常长的计算。在 10 个元素数组之后，每增加一个元素，计算的数量就会至少乘以 10，即 11 为 3500 万，12 为 3.5 亿......你得到了漂移。

# java - 片段标签页眉/标签大小

> ID：10489724
> 
> 赞同：0
> 
> 时间：2012-05-07T21:55:54.013
> 
> 标签：java, android, xml, android-fragments

我确信它需要一个简单的标志，但我没有找到正确的标志，至少花了 2 个小时才找到正确的解决方案。希望能得到各位大师的帮助。我正在尝试使用 fragmentActivity 创建一个两个选项卡布局。我想为每个选项卡提供 50% 的屏幕空间。我能够做到这一点（请参阅附加的屏幕截图），下一个障碍是我想要标签页眉，例如带有黑色 bkg 的 Financial 应该占 50%，而其他带有 gary bkg 的要占剩余的 50%。 ![在此处输入图像描述](../Images/2391006b03c0ba892b95eaa08ea7f061.png)

我希望我的问题很清楚。:-)

```
attaching my xml
<?xml version="1.0" encoding="utf-8"?>
<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#EFEFEF" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

        <TabWidget
            android:id="@android:id/tabs"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal" />

        <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <FrameLayout
                android:id="@+id/financial"
                android:layout_width="0dp"
                android:layout_height="0dp"
                android:layout_weight="0"
                android:tag="@string/financial" />

            <FrameLayout
                android:id="@+id/other"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1"
                android:tag="@string/others" />
        </FrameLayout>
    </RelativeLayout>

</TabHost>

**The calling xml would be**

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/listView1"
        android:layout_width="fill_parent"
        android:layout_height="48dp"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView1" >
    </ListView>

    <fragment
    class="com.......android.activity.AccountsTab"
        android:id="@+id/tabs_fragment"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" 
        android:layout_centerInParent="true"/>
</RelativeLayout> 
```

添加 tab.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="150dp"
    android:layout_height="@dimen/tab_height"
    android:background="@drawable/tab_selector"
    android:gravity="center_horizontal"
    android:orientation="horizontal"
    android:padding="@dimen/tab_padding"
    android:weightSum="0.5" >

    <TextView
        android:id="@+id/text"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.5"
        android:gravity="center_horizontal|center_vertical"
        android:textColor="@drawable/tab_text_selector"
        android:textSize="@dimen/text_default"
        android:textStyle="italic" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T11:14:31.903

我认为你应该这样做。

```
<?xml version="1.0" encoding="utf-8"?>
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">
    <TabHost
        android:id="@android:id/tabhost"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        >
        <LinearLayout
            android:orientation="vertical"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            >

            <TabWidget
                android:id="@android:id/tabs"
                android:orientation="horizontal"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_weight="0"
                />

            <FrameLayout
                android:id="@android:id/tabcontent"
                android:layout_width="0dp"
                android:layout_height="0dp"
                android:layout_weight="0"/>

            <FrameLayout
                android:id="@+android:id/realtabcontent"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1"/>
        </LinearLayout>
    </TabHost>
</LinearLayout> 
```

有了这个，您可以添加任意数量的选项卡。

![在此处输入图像描述](../Images/94a8901b150e438aba7f7bf1f87307d9.png) 希望你想要这个。

# mysql - 从数据库中的几个表中返回数据

> ID：10489730
> 
> 赞同：2
> 
> 时间：2012-05-07T21:56:52.870
> 
> 标签：mysql

我需要一些帮助来从几个表中获取数据。

这是我的表：

```
_______________   ______________   ___________  _______________  _____________
|_tblUsers____|   |_tblAnswers__|  |_tblAlt__|  |_tblQuestion_|  |_survey_____|
| userID      |   | answerAltID |  | altID   |  | questID     |  | surveyID   |
| username    |   | userID      |  | altText |  | questText   |  | surveyName |
|_____________|   |_____________|  |_questID_|  |_surveyID____|  |____________| 
```

TblUsers 拥有系统中的用户列表，tblAnswers 拥有用户给出的所有答案，tlbAlt 拥有问题的备选方案，tblQuestion 拥有问题。还有一个名为 tblSurveys 的表，但这里不需要，因为 tblQuestion 中提到了 ID。

这是我到目前为止所拥有的：

```
SELECT
tblQuestion.questText,
tblAlt.altText,
Count(tblAnswers.answerID) as answers_count,
(SELECT COUNT(answerID) FROM tblAnswers, tblAlt 
WHERE tblAnswers.answerAltID = tblAlt.altID 
AND tblAlt.questID = " & CInt(questionID) & ") as total_count
FROM tblAlt, tblQuestion
LEFT JOIN tblAnswers ON (tblAlt.altId = tblAnswers.altID)
WHERE tblAlt.questID = " & CInt(questionID) & "
GROUP BY tblAlt.altText; 
```

这将返回如下行：

> | 什么是布拉布拉布拉？| 答案是... | 2 (已回答) | 10（总答案）|

不幸的是，这只返回一个问题的所有行。有没有办法获取属于同一调查的所有行（基于surveyID）？

如果希望输出是这样的：

> | 什么是布拉布拉布拉？| 答案是... | 2 (已回答) | 10（总答案）| 调查名称 |

我想返回所有备选方案（有多少答案、总答案、相关问题和调查）。

* * *

**更新：**

这是我的输入：

```
SELECT tblalternativ.altTekst, tblalternativ.altID, Count(tblsvar.svarAltID) as antSvar, 
(SELECT COUNT(*) FROM tblsvar, tblalternativ 
WHERE tblsvar.svarAltID = tblalternativ.altID 
AND tblalternativ.altSpmID = " & CInt(lblQuestion.Tag) & ") as antTotal, 
(SELECT Count(*) FROM tblalternativ WHERE altSpmID = " & CInt(lblQuestion.Tag) & ") as spmTotal 
FROM(tblalternativ) LEFT JOIN tblsvar ON (tblalternativ.altId = tblsvar.svarAltID) 
WHERE(tblalternativ.altSpmID = " & CInt(lblQuestion.Tag) & ")
GROUP BY tblalternativ.altTekst ORDER BY tblalternativ.altID ASC 
```

我的输出：

```
altTekst    altID   antSvar antTotal    spmTotal
Black         83         1      3              5
Green         84         1      3              5
Yellow        85         1      3              5
White         86         0      3              5
Pink          87         0      3              5 
```

但这仅显示一个问题的统计数据。我想在一项调查中显示所有问题。因此，我需要获取`altTekst`该调查、问题名称和调查 ID 的所有信息。

我想：

```
spmTekst      altTekst  altID   antSvar antTotal    spmTotal   evalID
What is...    Black         83         1        3          5        1
What is...    Green         84         1        3          5        1
What is...    Yellow        85         1        3          5        1
What is...    White         86         0        3          5        1
What is...    Pink          87         0        3          5        1
Who is....    The king      88         2        3          3        1
Who is....    The pope      89         0        3          3        1
Who is....    The president 90         1        3          3        1
Which....     Shoe          91         2        3          2        1
Which....     Hat           92         1        3          2        1 
```

换句话说，我想要来自同一调查中所有问题的统计数据（基于 evalID）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T22:14:28.540

返回所有问题、答案文本、具有该答案的用户数以及提供的答案总数；每次调查。

```
Select TQ.QuestText, tAlt.altText, count(*) as Answers_count, suM(mTemp.Cnt) as total_count
FROM tblQuestion tq
LEFT JOIN tblAlt talt on Talt.QuestID = TQ.QuestID
LEFT JOIN tblAnswers ta on ta.AnswerAltID = talt.AltID
LEFT JOIN tblUsers tu ON Ta.UserID = TU.UserID
LEFT join tblAnswers ta2 on ta2.answeraltId = talt.altID
LEFT JOIN 
  (SELECT COUNT(*) cnt, questID 
   FROM tblAnswers 
   INNER JOIN tblAlt on AltID = AnswerAltID
   group by questID) mTemp 
  on mTemp.QuestID = talt.QuestID
WHERE tQ.SurveyID = 123 --Change this to your value
Group by TQ.QuestText, TAlt.AltText 
```

这只是一堆左连接与内连接；我抽象出每个表的计数一次，所以它应该更快，而不是在每一行上进行子选择。这样，它对所有行执行一次并完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T18:40:37.300

试试这个（根本没有优化，只是添加了调查部分）：

```
SELECT    tblQuestion.questText, tblAlt.altText, 
          Count(tblAnswers.answerAltID) AS answers_count,
           (SELECT COUNT(answerAltID) FROM tblAnswers, tblAlt 
           WHERE  tblAnswers.answerAltID = tblAlt.altID AND 
                  tblAlt.questID = " & CInt(questionID) & ") as total_count,
          survey.surveyName
FROM      survey, tblQuestion, tblAlt
LEFT JOIN tblAnswers ON (tblAlt.altId = tblAnswers.answerAltID)
WHERE     tblAlt.questID = " & CInt(questionID) & " AND 
          tblQuestion.surveyID = survey.surveyID
GROUP BY  tblAlt.altText; 
```

**编辑：然后试试这个：**

```
SELECT    tblQuestion.questText AS spmTekst, tblAlt.altText AS altTekst, 
          tblAlt.altID, 
          Count(tblAnswers.answerAltID) AS antSvar,
          COUNT(tblAlt.altID) AS antTotal,
          COUNT(tblQuestion.questID) AS spmTotal,
          survey.surveyID AS evalID
FROM      tblQuestion 
JOIN      survey ON (survey.surveyID = tblQuestion.surveyID)
JOIN      tblAlt ON (tblAlt.questID = tblQuestion.questID)
LEFT JOIN tblAnswers ON (tblAnswers.answerAltID = tblAlt.altID)
WHERE     tblAlt.questID = " & CInt(questionID) & " AND -- what really is this? review this
          survey.surveyID = '123' -- the value u want
GROUP BY  tblAlt.altText
ORDER BY  tblAnswers.answerAltID; 
```

# delphi - 在光标处打开文件不会在 IDE 中打开文件

> ID：10489732
> 
> 赞同：3
> 
> 时间：2012-05-07T21:57:00.000
> 
> 标签：delphi, ide, delphi-units

当我将鼠标悬停在 Uses 子句中的 UnitNames 上时，会弹出一个显示 UnitName 命名空间的窗口。例如，当我将鼠标悬停在 SysUtils 单元上时，我会在弹出窗口中看到 SysUtils Namspace。如果我右键单击 SysUtils 并选择在光标处打开文件，源代码将在 IDE 中打开。

如果我在其他一些单元上右键单击并选择在光标处打开文件，则会出现一个打开文件对话框。

为什么所有单元不只是简单地打开到 IDE 中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-07T22:16:27.363

当源 ( `.pas`) 文件不在当前搜索或浏览路径上时，会发生这种情况。

您通常可以通过简单地将单元添加到项目来修复它（在项目管理器中右键单击项目，选择“添加”，导航到文件，然后双击。这会将其添加到 .dpr 文件并使其随时可用到 IDE。

您还可以使用`Project->Options->Delphi Compiler->Search Path`或将其添加到路径中`Tools->Options->Environment Options->Delphi Options->Library->Browsing Path`。

# java - 使用 Quartz 在 Java 中进行异步调度

> ID：10489733
> 
> 赞同：1
> 
> 时间：2012-05-07T21:57:03.187
> 
> 标签：java, asynchronous, scheduling, quartz-scheduler

我需要一种在 Java 中实现异步作业调度的机制，并且正在研究[Quartz Scheduler](http://quartz-scheduler.org/)，但它似乎没有提供必要的功能。

更具体地说，我的跨不同节点运行的应用程序有一个基于 Web 的 UI，用户可以通过它安排几个不同的作业。当作业完成时（将来的某个时间），它应该向 UI 报告，以便用户了解其状态。在此之前，用户应该可以选择编辑或取消计划的作业。

一种实现方法是让调度程序线程在其中一个节点的后台持续运行，并收集 JobDetail 定义以执行作业。

无论如何，有两个问题（适用于单节点或多节点场景）：

1.  Quartz 是否允许修改或取消已安排的作业？
2.  如何实现“回调”机制，以便将作业执行结果报告回 UI？

非常感谢任何代码示例或指针。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T23:50:47.393

1.  Quartz 是否允许修改或取消已安排的作业？

您可以“取消计划”工作：

```
scheduler.unscheduleJob(triggerKey("trigger1", "group1")); 
```

或删除作业：

```
scheduler.deleteJob(jobKey("job1", "group1")); 
```

如文档中所述：

[http://quartz-scheduler.org/documentation/quartz-2.x/cookbook/UnscheduleJob](http://quartz-scheduler.org/documentation/quartz-2.x/cookbook/UnscheduleJob)

请注意，两者之间的主要区别是取消调度作业会删除给定的触发器，而删除作业会删除给定作业的所有触发器。

1.  如何实现“回调”机制，以便将作业执行结果报告回 UI？

通常，在网络世界中，您将轮询网络服务器以获取更改。根据您的 Web 框架，可能有一个可用的组件（Push、Pull、Poll？）使这变得容易。此外，您需要做的是在服务器上存储有关您的工作的一些状态。作业完成后，您可以更新数据库或内存中的值。反过来，这将被轮询获取并显示给用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T02:32:28.103

用Quarz完成@johncarl的答案也有这个

1.  [执行 SchedulerListener 接口执行](http://quartz-scheduler.org/documentation/quartz-2.1.x/tutorials/tutorial-lesson-08)前后处理事件
2.  将您的工作分组
3.  企业版支持
4.  最重要的 cron 表达式[是文档](http://quartz-scheduler.org/documentation/quartz-2.1.x/tutorials/crontrigger)

# asp.net - WCF 端点配置问题

> ID：10489735
> 
> 赞同：2
> 
> 时间：2012-05-07T21:57:14.617
> 
> 标签：asp.net, wcf

当我的 ASP.NET 4.0 站点加载时，我收到以下错误，这是因为我在`web.config`文件中设置了 WCF 服务（我只是不够 WCF 专家，谷歌也没有帮助:)）：

> '[Path to my Service.svc]' 的端点没有与 None MessageVersion 的绑定。'System.ServiceModel.Description.WebScriptEnablingBehavior' 仅适用于 WebHttpBinding 或类似的绑定。

我正在使用`webHttpBinding`但遇到以下错误，所以现在我`basicHttpBinding`在[遵循这篇文章的建议后](http://blogs.msdn.com/b/drnick/archive/2007/03/23/preventing-anonymous-access.aspx)使用：

> 此服务的安全设置需要“匿名”身份验证，但托管此服务的 IIS 应用程序未启用它。

无论如何，这是来自我的 web.config 的相关信息。请帮忙！

```
<system.serviceModel>
  <behaviors>
    <serviceBehaviors>
      <behavior name="ABC.ProjectName.Web.ServiceBehavior">
        <serviceDebug httpHelpPageEnabled="true" includeExceptionDetailInFaults="true" />
      </behavior>
    </serviceBehaviors>
    <endpointBehaviors>
      <behavior name="ABC.ProjectNameDell.Web.ServiceBehavior">
        <enableWebScript />
      </behavior>
    </endpointBehaviors>
  </behaviors>
  <serviceHostingEnvironment multipleSiteBindingsEnabled="true" 
                             aspNetCompatibilityEnabled="true" />
  <bindings>
    <basicHttpBinding>
      <binding name="webHttpBinding_AnonymousDisabled" >
        <security mode="TransportCredentialOnly">
          <transport clientCredentialType="Windows" />
        </security>
      </binding>
    </basicHttpBinding>
  </bindings>
  <services>
    <service name="ABC.ProjectName.Web.AjaxService" >
      <endpoint address="/" 
                behaviorConfiguration="ABC.ProjectName.Web.ServiceBehavior"
                binding="basicHttpBinding"
                contract="ABC.ProjectName.Web.AjaxService" />
    </service>
  </services>
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T23:00:33.357

您不能将 basicHttpBinding 与 enableWebScript 一起使用。将绑定设置为 WebHttpBinding。

```
 <service name="ABC.ProjectName.Web.AjaxService" >
    <endpoint address="/" behaviorConfiguration="ABC.ProjectName.Web.ServiceBehavior"
      binding="webHttpBinding"
      contract="ABC.ProjectName.Web.AjaxService" />
  </service> 
```

# c# - 确定某人是否离开网页的好方法

> ID：10489740
> 
> 赞同：0
> 
> 时间：2012-05-07T21:58:22.373
> 
> 标签：c#, jquery, asp.net, .net, sql-server-2005

我正在尝试为我们的客户可以编辑某些字段的工作编写应用程序。当他们单击编辑时，代码将锁定要编辑的数据。当他们点击保存时，数据将解锁。但是当他们点击其他地方、转到另一个页面或站点，甚至关闭浏览器时，我无法决定是否可以解锁数据。

确定用户是否离开编辑页面的好方法是什么？

（我们使用 C# .NET 3.5 和 JQuery 以及 SQL Server 2005 DB）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:21:46.933

如果您确实必须使用悲观锁定，您可以在 Session_End 中添加检查并解锁该用户在当前会话中设置的所有锁。如果用户关闭浏览器窗口或进入另一个站点，请使用 onUserExit jQuery 插件结束会话，示例如下：

[https://stackoverflow.com/a/10481972/351383](https://stackoverflow.com/a/10481972/351383)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:16:32.737

您可以利用 html 标签的“onunload”事件。引发此事件 - 当使用 X 按钮关闭页面时 - 当页面被重定向时（在您的情况下，用户单击编辑并移动到不同的链接而不保存。）

希望这可以帮助！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T23:02:42.510

您的问题被理解为“确定用户是否在未单击“保存”解锁字段的情况下放弃编辑页面的好方法是什么？

> 但是当他们点击其他地方、转到另一个页面或站点，甚至关闭浏览器时，我无法决定是否可以解锁数据。

有人从同一个应用程序查看另一个页面的所有场景可能意味着同一会话中的另一个窗口 - 可能是为了检查某些内容。您不希望触发解锁，因为您的用户仍然可以打开一个窗口，他们可以在其中提交编辑。

用户离开页面的其他场景可以使用onUserExit。

但是，您从该列表中省略了“用户去吃午饭而网页打开”的场景。这就是悲观锁定存在问题的原因。

因此，将问题改写为“用户点击了编辑，但未能在合理时限内进行修改和保存”。

基本上，你的锁应该在某个时候过期。

单击“编辑”后，保存锁定启动并启动计时器（5 分钟？），这在屏幕上也可见。（如果使这些同步是一个问题，请使客户端计时器比服务器端计时器更短）。您的用户必须在这段时间内进行更改并单击保存。您也许可以添加一个延长按钮来延长时间。

原则是你需要确定有人离开它太久，而不是有人离开它。您还向用户表明，单击“编辑”后，您希望他们很快会进行编辑。

您需要对系统进行编码以解锁锁定已过期的字段。

这样做的好处是，对于请求此类编辑锁的人来说，您的倒计时看起来会很“酷”。

# iphone - MPMoviePlayerController 重复模式在 viewDidLoad 中不起作用

> ID：10489741
> 
> 赞同：0
> 
> 时间：2012-05-07T21:58:23.123
> 
> 标签：iphone, xcode, mpmovieplayercontroller, repeat, viewdidload

似乎我在使用 repeatmodeone 时遇到了问题：它不会重复播放视频。

这是我在实现中的视频代码：

```
- (void)viewDidLoad{

    NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"Space Particle" ofType:@"mp4"]];

    MPMoviePlayerViewController *playerController = [[MPMoviePlayerViewController alloc]initWithContentURL:url];
    [self presentMoviePlayerViewControllerAnimated:playerController];
    [playerController.moviePlayer prepareToPlay];
    playerController.moviePlayer.movieSourceType = MPMovieSourceTypeFile;
    playerController.moviePlayer.controlStyle = MPMovieControlStyleNone;
    playerController.moviePlayer.scalingMode = MPMovieScalingModeAspectFill;
    playerController.moviePlayer.repeatMode = MPMovieRepeatModeOne;
    [MyView1 addSubview: playerController.view];

    [playerController.moviePlayer play];
    [playerController release];playerController=nil;
} 
```

它作为一个动画背景，上面有按钮。视频播放，但完成后，它不会重复。

我发现，作为 IbAction，它会重复，但作为 viewDidLoad 它不会。

请注意，“MyView”插座已链接到自定义 UIButton，它位于播放电影的按钮视图中。

我使用的视频尺寸不大。

我的目标是电影必须使用 viewdidload 方法重复才能自动播放和重复。

请问，我做错了什么吗？关于如何解决的建议？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-10T06:42:31.893

试试下面的代码。这是完美的工作。

```
 NSURL *fileUrl = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"Video" ofType:@"mp4"]];
    MPMoviePlayerViewController *moviePlayerController = [[MPMoviePlayerViewController alloc]initWithContentURL:fileUrl];
    [moviePlayerController.moviePlayer prepareToPlay];
    [moviePlayerController.moviePlayer setRepeatMode:MPMovieRepeatModeOne];
    [moviePlayerController.moviePlayer setControlStyle:MPMovieControlStyleEmbedded];
    [self.view addSubview:moviePlayerController.view]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-31T12:58:11.933

viewDidLoad 函数完成后，它已被 ARC 删除。您应该将 MPMoviePlayerController 实例作为类成员。NSNotification 也解决了这个问题，因为它保留了对象。使其成为实例变量将使通知解决方案变得多余。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:44:12.920

同样的问题。我通过以下步骤解决了它：1）订阅结束播放通知

```
 [[NSNotificationCenter defaultCenter] addObserver:self 
                                             selector:@selector(moviePlayBackDidFinished:) 
                                                 name:MPMoviePlayerPlaybackDidFinishNotification 
                                               object:self.moviePlayer]; 
```

2）在moviePlayBackDidFinished方法中手动开始播放

# javascript - Javascript/css 照片弹出功能放置问题

> ID：10489742
> 
> 赞同：1
> 
> 时间：2012-05-07T21:58:27.240
> 
> 标签：javascript, css, magento, photo

我已经多次使用这个网站来找到我的问题的答案，但我似乎无法找到我当前问题的答案。任何帮助都会很棒！

我在 Magento 中使用了一个名为 TopUp 的自定义照片弹出功能插件。我联系了代码的原始作者，但没有收到回复。我用谷歌搜索了这个问题，其他使用 Magento 1.6 和 1.7 的用户也遇到了同样的问题。

当您在查看产品详细信息页面时单击产品图像时，该图像应在屏幕中间弹出。好吧，现在，图像向屏幕底部弹出，当您单击下一步或返回时，它会重新定位到更下方。

这是适用于产品的确切链接（开发站点）： http: [//www.childress-media.com/shapingheartsforgod.org/index.php/shaping-hearts-series/pre-k-through-5th-grade /all-things-made-new/all-things-made-new-student-workbook-level-1.html](http://www.childress-media.com/shapingheartsforgod.org/index.php/shaping-hearts-series/pre-k-through-5th-grade/all-things-made-new/all-things-made-new-student-workbook-level-1.html)

这是 Javascript 弹出程序的链接：http: [//www.childress-media.com/shapingheartsforgod.org/skin/frontend/base/default/js/top_up/top_up-min.js](http://www.childress-media.com/shapingheartsforgod.org/skin/frontend/base/default/js/top_up/top_up-min.js)

我已经尝试在文件中到处乱搞CSS - 但我不能让它做我想做的事。

理想情况下，弹出窗口会出现在距页面顶部 100 像素的位置，并且在您按下下一个或上一个时居中并保持居中。

你们可以提供的任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:09:28.793

一种简单但原始的方法是设置 css 样式，例如：

```
document.getElementById('top_up').style.top = '100px'; 
```

# entity-framework - 带有 CreateIndex 和匿名参数的 EF 4.3 代码迁移

> ID：10489743
> 
> 赞同：5
> 
> 时间：2012-05-07T21:58:49.217
> 
> 标签：entity-framework, ef-code-first, entity-framework-4.3, entity-framework-migrations

我正在尝试使用 EF 代码迁移创建索引。索引看起来像：

```
CREATE INDEX [IX_RatingId_CreatedAt] ON [Users] 
(
[RatingId] ASC,
[CreatedAt] ASC
)
INCLUDE (Id, Email, DomainId) 
```

我到目前为止的代码是：

```
CreateIndex("Users",
             new string[] { "RatingId", "CreatedAt" },
             false,
             "IX_RatingId_CreatedAt"
           ); 
```

这将为我创建索引，但不包括列。CreateIndex 方法有一个覆盖，它采用称为anonymousArguments 的东西。我真的找不到太多关于它的信息，所以我尝试了类似的方法：

```
CreateIndex("Users",
             new string[] { "RatingId", "CreatedAt" },
             false,
             "IX_RatingId_CreatedAt",
             new { INCLUDE = "(Id, Email, DomainId)" }); 
```

没有例外，但它没有工作。

是否可以使用 CreateIndex 方法创建上述索引，还是必须使用 Sql 方法在迁移中写出 T-SQL？如何正确使用匿名参数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-13T11:06:53.880

匿名参数是提供者特定的。据我所知，MSSQL 提供程序没有使用它们（如果我错了，请纠正我）。

处理包含列的 CreateIndex 没有内置重载。要么您必须回退到手动 SQL，要么您可以在所有列上创建索引。

```
CreateIndex("Users",
         new string[] { "RatingId", "CreatedAt", "Id", "Email", "DomainId" },
         false,
         "IX_RatingId_CreatedAt"
       ); 
```

# python - 从类到变量的值

> ID：10489746
> 
> 赞同：0
> 
> 时间：2012-05-07T21:59:29.297
> 
> 标签：python, class, tkinter

我有 2 个类，一个称为 MineField，一个称为 Options，在选项类中有刻度，我通过该类中的函数 def assign(): 获取值，MineField 类具有三个参数(w,h,m)。我想从选项类中的比例为这些参数分配值。（我使用 tkinter）

```
Class Options:
  def __init__(self, w, h, m)
    ...
    minorinput = Scale.(...)   
    mainloop()
    ...
  def assign():
    self.width = widthinput.get()
    self.height = heightinput.get()
    self.minor = minorinput.get()

def main():
  ins = Options(0,0,0)
  ins.assign()
  w = ins.width
  h = ins.height
  m = ins.minor
  game.MineField(w,h,m) 
```

那么如何将这些值从秤中获取到 game.MineField 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T01:42:13.493

您的代码非常不寻常。本质上，你不能做你要求做的事情。至少，不是你试图这样做的方式。

您是否知道，一旦您调用`mainloop`，该语句之后的其余代码将不会运行，直到您销毁您的窗口？一旦窗口被销毁，您就无法查询小部件的值，因为它们不存在。

# ruby-on-rails - ror 使用 sum 并为 nil:NilClass 获取未定义的方法“任务”

> ID：10489747
> 
> 赞同：1
> 
> 时间：2012-05-07T21:59:32.433
> 
> 标签：ruby-on-rails, ruby

我有 3 个表：Projects、Tasks、Timeentries Projects has_many tasks 和 has_many timeentries，:through => tasks Tasks has_many timeentries。

在项目索引中，我想显示项目所有时间条目的总和。

我正在尝试使用：

```
<td><%= @project.tasks.timeentries.sum('time_entry') %></td> 
```

但是，我得到 nil:NilClass 的未定义方法“任务”

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:14:03.390

正如Benjamin Udink 10 Cate指出的那样，如果您正在遍历像 <%for project in @projects%> 这样的项目，那么您的实例变量很可能被命名为@projects，而不是您应该使用项目而不是@project

# asp.net - 在 Windows 服务器上将 aspx 文件重定向到 html

> ID：10489750
> 
> 赞同：0
> 
> 时间：2012-05-07T21:59:40.280
> 
> 标签：asp.net, html, windows, .htaccess

我正在将 ASP.net 迁移到 HTML 网站。这对我来说是新的，因为我通常只为网站做设计。

URL 相同，所有文件名也相同（当然，扩展名除外）。我对 ASP.net 网站一无所知，这是我卡住的地方。我在 Windows Server 上运行该站点，并希望能够将所有`.aspx`文件重定向到相应的`.html`文件

我已经阅读过`.htaccess`但没有运气，我想我需要运行 Apache？

有谁知道我该如何解决这个问题？这里有类似的问题，但答案对我来说还不够简单！

此外，当我尝试该`htaccess`选项时，我收到此错误：

> “/”应用程序中的服务器错误。无法找到该资源。说明：HTTP 404。您要查找的资源（或其依赖项之一）可能已被删除、名称已更改或暂时不可用。请查看以下 URL 并确保其拼写正确。请求的 URL：/about-us.aspx

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:51:44.373

**KISS 解决方案：** 如果页面数量很少且 .aspx 页面中确实没有逻辑，您可以随时加载所有可能的网页，并通过浏览器功能将它们保存为 .html 页面。谷歌浏览器允许您右键单击每个页面并选择**另存为...** Internet Explorer 和 Firefox 具有类似的功能。然后可以将您保存的这些页面上传到您的 Go-Daddy 站点。

# php - 使用 Ajax 刷新 obflush

> ID：10489752
> 
> 赞同：0
> 
> 时间：2012-05-07T22:00:05.757
> 
> 标签：php, ajax

好的，所以我创建了一个向导，一切都很好。但如果你愿意的话，我有一小块似乎会“打扰”我。

在我构建的向导的最后一步中，它使用 obflush 将数据处理到屏幕上以显示正在发生的一些操作。但问题在于，“整个”页面在完成刷新过程之前不会加载，然后页面都排成一行。

我想知道是否有这样一种方式，也许 ajax 可以刷新 obflush 过程？

也许这是完全错误的，但这就是我可以想象它发生的方式。

用户通过向导并进入最后一页 整个页面加载 在页面的末尾是一些 ajax 代码可能应用于标签 ajax 每秒刷新一次以检查 obflush 的更新，然后输出什么反冲洗已输出到屏幕上。

那有意义吗？

非常感谢任何见解。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:20:59.643

这个问题是关于如何使用 Ajax 加载网页的一部分。特别是如何加载页面的结构，然后用 Ajax 调用填写详细信息。

我假设目的是为了快速加载结构，因为它确实有一些内容，然后加载需要很长时间处理的页面部分。否则屏幕上的效果将是加载实际上更慢。

我会使用 JavaScript 库 jQuery 来帮助解决这个问题，尽管它可以在没有任何库的情况下完成，如这个[问题](https://stackoverflow.com/questions/10354654/how-create-ajax-request-manually)中所示。

*   浏览器发出网页请求，服务器像往常一样响应，但只是页面结构

*   在加载的基本上是空的页面中，jQuery 将进行 Ajax 调用`load()`，将来自 URL 的响应加载到指定的 HTML 部分。

代码如下所示，常规 HTML标记`my-intro-div`的 id在哪里：`div`

```
$(function() {
    var myIntroDiv = $('#my-intro-div');    

    myIntroDiv.load('/my_intro_div.php');
}); 
```

*   PHP 脚本 my_intro_div.php 返回要在`my-intro-div`标签内显示的 HTML

这里的 jQuery 文档中有一些很好的示例：

[http://api.jquery.com/load/](http://api.jquery.com/load/)

jQuery 也可以帮助处理很多其他事情。它有一个很小的学习曲线，可能有点陡峭，但在那之后我发现它是我使用的最直观的“语言”。

# c - Linux 上的线程 C 程序中的段错误

> ID：10489753
> 
> 赞同：1
> 
> 时间：2012-05-07T22:00:06.430
> 
> 标签：c, linux, multithreading, segmentation-fault

我必须为我的课堂作业编写一个线程示例。通过 copy() 创建子进程后，我不知何故遇到了 Segfault （不得不遗憾地使用它）。

```
void thread(void);
#define CLONE_VM        0x00000100
#define ANSWER_TRUE     "t"
#define ANSWER_FALSE    "f"

static char stack[2];

int main(void) {
void** childThreadBP = NULL;
void** childThread = NULL;

int pid = 0;

puts("create stack for child process...");
void ** new_stack = (void **) malloc(128);    
//new_stack = (void **) ((char *)new_stack + 128); 

puts("create child process...");    
pid = clone(thread, new_stack, CLONE_VM, NULL);

puts("write PID to shared stack...");
stack[0] = (char) pid;

puts("child answered:");
while(1){}
if (stack[1] == ANSWER_TRUE) {
    puts("PIDs are equal.");
}
else {
    puts("PIDs are NOT equal.");
}
return EXIT_SUCCESS;
}

void thread(void) {
puts("[child]: I'm alive!");
int pidSelf;

pidSelf = getpid();
if (pidSelf == (int)stack[0]) {
    puts("[child]: dad the PID you gave me is correct!");
    stack[1] = ANSWER_TRUE;
}
else {
    puts("[child]: dad the PID you gave me is NOT correct!");
    stack[1] = ANSWER_FALSE;
}
} 
```

也许你明白我的错误是什么...... - 代码格式有什么问题？！

我只需要帮助修复段错误 - 其余的应该没问题（我认为;））

问候！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:04:32.470

你有几个问题。首先，正如 Martin James 所说，你需要更大的筹码量。我用了 16384，效果很好。其次，您需要在内存空间的顶部传递您的行：

```
new_stack = (void **) ((char *)new_stack + 128); 
```

很好，取消注释并将其更改为更大的堆栈大小：

```
void ** new_stack = (void **) malloc(16384);    
new_stack = (void **) ((char *)new_stack + 16384); 
```

第三，您的 PID 存储存在问题。堆栈数组必须是整数，因为 pid 可以大于 char 变量可以容纳的大小（我的 PID 是 25689）。

那应该解决它。

# google-calendar-api - Google Apps 脚本 - 写入 Google 日历的代码优化

> ID：10489756
> 
> 赞同：1
> 
> 时间：2012-05-07T22:00:23.693
> 
> 标签：google-calendar-api, google-apps-script

我目前正在编写一个脚本，旨在在 6 个月内为 50 人编写 Google 日历，每天一个活动。这些事件可以有不同的开始/结束时间，也可以是全天事件。这些日历都将写入同一个 Google 帐户，用户将使用他们的个人帐户订阅它们。

日历的数据最初存储在 Google 电子表格中。我的脚本按照建议使用 getRange.getValues 方法一步读取此电子表格，但我找不到一种方法来“批量”写入，除非在 for 循环中使用 .createEvent 方法。由于运行时间过长（整个批次大约有 9000 个日历事件，超过了 5 分钟的范围），这个循环在运行的大约 1/10 处被杀死。

如果我注释掉 .createEvent 行，脚本运行得很好。

有没有办法优化对谷歌日历的写入（将数组传递给 .createEvent 或其他东西......）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:55:43.797

There's no batch methods for the Calendar API. You have to insert one by one in the "slow" loop.

The solution I use in my scripts is to divide the load into "doable" chunks. You can save on each row if you have processed it or not, or you can save somewhere (e.g. a cell or script property) the row you stopped last. And then, configure your script to stop by itself when it has worked its share (e.g. 3000 events).

I'm not sure if you have seen it already, but there's a new [dashboard](https://docs.google.com/macros/dashboard) where you can see that your quotas for the various APIs. It seems that after you solve this time limit quota, you'll run into the calendars. Good news is that this *spread the load* solution will also help you to deal with it.

# android - Android - 相机意图 - 照片已删除

> ID：10489757
> 
> 赞同：1
> 
> 时间：2012-05-07T22:00:27.287
> 
> 标签：android, android-intent, camera, uri

我有一个问题，我正在使用相机应用程序拍照，并且在我有机会在我的应用程序中使用它之前，照片被删除了。似乎只发生在某些设备上（三星 Galaxy S2、三星 Galaxy Tab 10.1 和 LG，不记得型号）。我的应用程序中的每个活动都将屏幕方向设置为纵向（清单：android:screenOrientation="portrait"）。我如何重现问题： 1\. 从我的应用程序中点击“拍照”按钮，这会加载相机应用程序。2\. 拍摄纵向照片，在适当的位置创建文件（基于我提供的 URI）并在相机应用程序中显示预览。3\. 保持设备纵向并点击“保存图像”（这会将您带回我的应用程序）。4\. 当我返回我的应用程序时，我检查文件是否存在，但它不存在。

如果您以纵向拍摄照片，然后将设备旋转到横向（显示预览时），然后点击“保存图像”（在横向时），照片不会被删除。

如果您以横向拍摄照片（并在您点击保存时将设备保持在横向），则不会删除照片。

如果您以横向拍摄照片，然后将预览旋转为纵向，则不会删除照片。

我已经阅读并在谷歌上搜索过，并且已经拔出头发试图弄清楚这一点。

当照片被拍摄并保存为纵向时，当返回我的应用程序时，我的应用程序处于横向状态，然后旋转为纵向。

感谢您提供任何帮助（即使它是指向另一个有答案的帖子的链接）！

谢谢 ：）

这是我的一些代码（发生问题时，_cameraFileUri 为空）：

```
 Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);

        _cameraFileUri = Uri.fromFile(new File(_tempFolder, "tempFromCamera.jpg"));

        intent.putExtra(MediaStore.EXTRA_OUTPUT, _cameraFileUri); // set the image file name

        // start the image capture Intent
        startActivityForResult(intent, CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE);

                    if (_cameraFileUri != null) {

                    File origFile = new File(_cameraFileUri.getPath());

                    resizePhoto(origFile);

                    showPhoto();

                } else {
                    Toast.makeText(getApplicationContext(), "Error: Capture Photo Failed.", Toast.LENGTH_LONG).show(); 

                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T17:03:00.520

抱歉，这个问题解决了。老实说，我等了一周才在这个论坛上发帖。我知道，只要我发布它，我就会找出答案。

旋转的应用程序是赠品。它正在重新创建活动，因此它正在重新运行 onCreate 方法。对于“管家”，我删除了临时文件夹中的文件。我在“onCreate”中执行此操作。因此，当 onCreate 重新运行时，它会删除相机放在 Temp 文件夹中的照片。

# c# - 返回 CSV 的 ASP.Net 表单提交

> ID：10489759
> 
> 赞同：0
> 
> 时间：2012-05-07T22:00:40.080
> 
> 标签：c#, asp.net

我无法让我的 ASP.Net 页面在单击提交时返回 CSV。这是我在 Form.aspx 中的提交按钮的 asp 按钮定义：

```
<asp:Button id="submitreport" name="submitbutton" text="submit" OnClick="Report_Submit" runat="server" /> 
```

这是Form.aspx.cs中对应的函数：

```
public void Report_Submit(object sender, EventArgs e) {
    Debug.WriteLine("GETS HERE?");
    Response.Charset = "UTF-8";
    Response.Cache.SetCacheability(HttpCacheability.NoCache);
    Response.Cache.SetAllowResponseInBrowserHistory(true);
    Response.ContentType = "text/csv";
    Response.AddHeader("Content-Disposition", "attachment; filename='" + DateTime.Today.ToString() + ".csv'");
    Response.Write("test,output");
    Response.End();
} 
```

当它在 Visual Studio 中运行时，我什至看不到调试打印行。有人知道我的设置有什么问题吗？

编辑：我确定页面设置正确，因为如果我在 Form.aspx.cs 中的空 Page_Load 函数上放置一个断点，VS 会在那里中断。此外，在提交表单时跳过了调试写入行的断点，并再次返回相同的页面。

**更新**通过仅使用按钮和处理程序创建一个新项目，调用 Report_Submit() 函数并正确生成 CSV 文件。由于这缩小了一点范围，有人知道我的另一个 VS 2008 项目中可能发生了什么导致它不起作用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:05:49.853

首先，您应该使用[Fiddler](http://www.fiddler2.com/fiddler2/)通过 HTTP 调试问题，为什么不使用[Response.TransmitFile()](http://msdn.microsoft.com/en-us/library/12s31dhy%28v=vs.80%29.aspx)呢？

有几件事可以帮助：

*   你确定`Debug.WriteLine()`没有执行？
*   您是否尝试过在那里设置断点？
*   您是否在调试模式下编译？
*   调试时是否打开了不止一次的 IE 实例，因为[这已经让我失望了几次](http://www.matthewedmondson.info/2011/12/not-usual-breakpoint-will-not-be-hit.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T17:27:17.457

我发现了一个很好的解决方法，它返回一个 .csv 文件（也不应该在创建函数调用的头文件中引用它，但这不是问题）。此外，不应该指定名称，因为 ASP.NET 会填写该名称，但这也不是问题。

将相关的表单处理代码移到自己的项目中效果很好，但我的项目太大而无法管理。

我发现有用的解决方法是将按钮处理函数移动到 Page_Load() 并使用：

```
if(Request.HttpMethod == "GET") {
    Debug.WriteLine("this is just a request for the page"):
}
else if(Request.HttpMethod == "POST") {
    Debug.WriteLine("processing the form");
    //rest of code...
}
else {
    //some HTTP action that doesn't matter
} 
```

将页面请求 (GET) 与输入表单的用户 (POST 请求) 区分开来。

# windows-runtime - LibSpotify 和 Windows Store 应用程序

> ID：10489764
> 
> 赞同：1
> 
> 时间：2012-05-07T22:01:27.627
> 
> 标签：windows-runtime, windows-store-apps, spotify

我想开始使用 LibSpotify 为 Spotify 开发 Windows Store App 客户端。但是，我似乎无法从 Metro 应用程序内部使用 libspotify dll，大概是因为它使用了 Metro Sandbox 禁止使用的部分 win32 api。

使用 LoadPackagedLibrary 加载我自己的简单测试 dll 可以正常工作，但加载 libspotify 会出现错误 1114 - ERROR_DLL_INIT_FAILED。

我还有希望吗？

谢谢汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T04:35:58.660

如果您正在尝试创建 Metro-Style-App - 在 Spotify 发布更新的库或有人对他们的库进行逆向工程以使其在 WinRT 中工作之前，您没有希望。

如果您想创建一个不基于 WinRT 的 Metro 风格应用程序 - 有 WPF 库可以让您的应用程序主题化为 Metro 风格，但除非您为 Spotify 工作并获得与微软达成协议。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-08T04:09:52.643

您只能在 Windows 8 Metro Apps 中使用 WinRT 库，而不能在 Win32 中使用。

# objective-c - 如何让 NSTextFinder 出现

> ID：10489765
> 
> 赞同：6
> 
> 时间：2012-05-07T22:01:41.483
> 
> 标签：objective-c, macos, cocoa

我有一个带有包含一些文本的 web 视图的 mac cocoa 应用程序。我想使用 NSTextFinder 提供的默认查找栏搜索该文本。阅读 NSTextFinder 类参考似乎很容易，但我无法显示查找栏。我错过了什么？

**作为旁注：**
- 是的，我尝试将 findBarContainer 设置为不同的视图，同样的事情。我恢复到滚动视图以消除调试的复杂性
- 调用 performTextFinderAction 来执行查找操作

```
**App Delegate:**

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{

    self.textFinderController = [[NSTextFinder alloc] init];

    self.webView = [[STEWebView alloc] initWithFrame:CGRectMake(0, 0,  self.window.frame.size.width, 200)];
    [[self.window contentView] addSubview:self.webView];

    [self.textFinderController setClient:self.webView];
    [self.textFinderController setFindBarContainer:self.webView.enclosingScrollView];

    [[self.webView mainFrame] loadHTMLString:@"sample string" baseURL:NULL];

}

- (IBAction)performTextFinderAction:(id)sender {
    [self.textFinderController performAction:[sender tag]];
}

**STEWebView**

@interface STEWebView : WebView <NSTextFinderClient>

@end

@implementation STEWebView

- (id)initWithFrame:(NSRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {

    }

    return self;
}

- (void)drawRect:(NSRect)dirtyRect
{
    // Drawing code here.
}

- (NSUInteger) stringLength {
    return [[self stringByEvaluatingJavaScriptFromString:@"document.documentElement.textContent"] length];
}

- (NSString *)string {
    return [self stringByEvaluatingJavaScriptFromString:@"document.documentElement.textContent"];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T11:33:19.557

在我的测试中，`WebView.enclosingScrollView`为空。

```
// [self.textFinderController setFindBarContainer:self.webView.enclosingScrollView];
NSLog(@"%@", self.webView.enclosingScrollView); 
```

使用下面的分类`NSView`，可以找到扩展的嵌套子视图，`NSScrollView`并将其设置为容器，让`NSTextFinder``WebView`

```
@interface NSView (ScrollView)

- (NSScrollView *) scrollView;

@end

@implementation NSView (ScrollView)

- (NSScrollView *) scrollView {
    if ([self isKindOfClass:[NSScrollView class]]) {
        return (NSScrollView *)self;
    }

    if ([self.subviews count] == 0) {
        return nil;
    }

    for (NSView *subview in self.subviews) {
        NSView *scrollView = [subview scrollView];
        if (scrollView != nil) {
            return (NSScrollView *)scrollView;
        }
    }
    return nil;
}

@end 
```

在你的`applicationDidFinishLaunching:aNotification`：

```
[self.textFinderController setFindBarContainer:[self scrollView]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-27T02:03:32.863

终于让这个出现了。

首先将您的 NSTextFinder 实例的客户端设置为实现`<NSTextFinderClient>`协议的类：

```
self.textFinder.client = self.textFinderController; 
```

接下来，确保您的 NSTextFinder 将 findBarContainer 设置为 Michael Robinson 描述的 webView 类别，或者自己获取 webView 中的滚动视图：

```
self.textFinder.findBarContainer = [self.webView scrollView]; 
```

将查找栏位置设置在内容上方（或您希望的任何位置）：

```
[self.webView scrollView].findBarPosition = NSScrollViewFindBarPositionAboveContent; 
```

最后，告诉它出现：

```
[self.textFinder performAction:NSTextFinderActionShowFindInterface]; 
```

它应该出现在你的 webView 中：

另外，不确定它是否有区别，但我在 XIB 中有 NSTextFinder，有一个引用插座：

```
@property (strong) IBOutlet NSTextFinder *textFinder; 
```

您也可以通过像平常一样简单地启动它来获得它：`self.textFinder = [[NSTextFinder alloc] init];`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T10:03:17.783

要显示查找栏（与默认的查找面板相反），您只需使用该`setUsesFindBar:`方法。

在你的情况下，你会想要做（在你的`applicationDidFinishLaunching:aNotification`方法中）：

```
[textFinderController setUsesFindBar:YES];
//Optionally, incremental searching is a nice feature
[textFinderController setIncrementalSearchingEnabled:YES]; 
```

# java - 从 .jar 文件中获取图像

> ID：10489773
> 
> 赞同：3
> 
> 时间：2012-05-07T22:02:04.557
> 
> 标签：java, image, jar, embedded-resource

当我在eclipse中导出可执行jar文件时，我需要获取res文件夹来编译，当我使用`getClass().getResource()`它不起作用的方法时。

当前读取图像代码

```
public Image loadImage(String fileName) {
    return new ImageIcon(fileName).getImage();
} 
```

不起作用的代码

```
public Image loadImage(String fileName) {
    return new ImageIcon(getClass().getResource(fileName).getImage();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T12:05:06.000

我现在已经解决了这个问题 - 这是有效的代码

```
 public BufferedImage loadImage(String fileName){

    BufferedImage buff = null;
    try {
        buff = ImageIO.read(getClass().getResourceAsStream(fileName));
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        return null;
    }
    return buff;

} 
```

fileName 的值只是一个图像名称，例如 BufferedImage img = loadImage("background.png");

感谢大家的帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T22:04:54.383

任何一个：

*   你的路径是错误的，如果是这样，你应该收到一条错误消息，检查它以查看它实际尝试的路径，可能不是你想的那样。或者调试并查看它尝试的路径，甚至只是打印它尝试的路径。

或者

*   它不在罐子里。使用 zip 程序检查 jar 文件和/或将其重命名为包含 zip 并打开它以检查文件是否真的存在。

# ant - 将变量传递给 ant

> ID：10489774
> 
> 赞同：2
> 
> 时间：2012-05-07T22:02:08.873
> 
> 标签：ant

如果我通过执行将变量传递给 ant

```
ant -Dsomething=blah 
```

如何在我的 build.xml 中引用它？我尝试*了@something@*和*${something}*但似乎都不起作用。

最终我要做的是在编译时设置一些属性（版本）。

*更新*：问题当然出在其他地方-接受带有示例的最完整的答案

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T02:36:03.170

当你过度思考这些事情时，你不讨厌它：

```
<project name="test">
    <echo message="The value of foo is ${foo}"/>
</project> 
```

现在，我将运行我的程序。请注意，我从未`foo`在我的`build.xml`. 相反，我将从命令行获取它：

```
$ ant -Dfoo=BAR_BAR_FOO

test:
     [echo] The value of foo is BAR_BAR_FOO

BUILD SUCCESSFUL
 time: 0 seconds 
```

看。没有什么特别的。您将在命令行上设置的属性视为普通属性。

这就是有趣的地方。请注意，我`foo`在`build.xml`这一次定义了属性：

```
<project name="test">
     <property name="foo" value="barfu"/>
     <echo message="The value of foo is ${foo}"/>
</project> 
```

现在观看乐趣：

```
$ ant
test:
     [echo] The value of foo is barfu

BUILD SUCCESSFUL
 time: 0 seconds 
```

现在，我们将`foo`在命令行上设置属性：

```
$ ant -Dfoo=BAR_BAR_FOO
test:
     [echo] The value of foo is BAR_BAR_FOO

BUILD SUCCESSFUL
 time: 0 seconds 
```

请参阅命令行覆盖了我在`build.xml`文件本身中设置的值。这样，您可以拥有可以被命令行参数覆盖的默认值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T23:31:37.733

听起来您想要执行以下操作：

```
<mkdir dir="build/src"/>
<copy todir="build/src" overwrite="true">
  <fileset dir="src" includes="**/*.java"/>
  <filterset>
    <filter token="VERSION" value="${version}"/>
  </filterset>
</copy> 
```

...这将导致您的源被复制，替换`@VERSION@`：

```
public class a { public static final String VERSION = "@VERSION@"; } 
```

...然后包含`build/src`在您的`javac`src 中。

也就是说，我不推荐这种方法，因为源复制步骤很昂贵，而且无疑会引起混乱。过去，我在我的包中存储了一个 version.properties 文件`version=x.y`。在我的 Java 代码中，我使用了`Class.getResourceAsStream("version.properties")`和`java.util.Properties`. 在我的 build.xml 中，我使用`<property file="my/pkg/version.properties"/>`了这样我可以创建一个`output-${version}.jar`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:52:59.960

`${argsOne}`对我有用，如果调用命令是很容易引用

`ant -DargsOne=cmd_line_argument`

[Ant 文档](http://ant.apache.org/manual/running.html#commandline)也这么说。这应该可以，尝试运行`ant -debug`并粘贴输出。

# c# - 替换字符串c#中的控制字符

> ID：10489775
> 
> 赞同：2
> 
> 时间：2012-05-07T22:02:19.903
> 
> 标签：c#, string, hex

我的数据库中的某些文本字段嵌入了错误的控制字符。我只是在尝试序列化对象并在 char`&#x2;`和`&#x1E;`. 可能还有其他人。

如何使用 C# 替换它们？我认为这样的事情会起作用：

```
text.Replace('\x2', ' '); 
```

但事实并非如此。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-07T22:05:05.220

字符串是不可变的 - 您需要重新分配：

```
text = text.Replace('\x2', ' '); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-07T22:10:03.160

正如上面所说，字符串在 C# 中是不可变的。这意味着声明：

```
text.Replace('\x2', ' '); 
```

返回了你想要的字符串，但没有改变你给它的字符串。由于您没有在任何地方分配返回值，因此它丢失了。这就是为什么上面的语句应该解决问题的原因：

```
text = text.Replace('\x2', ' '); 
```

如果您有一个经常更改的字符串，您可能会查看 StringBuilder 对象，它的工作方式与常规字符串非常相似，但它们是可变的，因此在某些情况下效率更高。

祝你好运！

-克雷格

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T02:38:47.633

您正在处理的更大问题是 XmlSerialization 往返问题。从字符串开始，将其序列化为 xml，然后将 xml 反序列化为字符串。人们期望这总是产生一个与第一个字符串等效的字符串，但如果该字符串包含控制字符，则反序列化会引发异常。

您可以通过将 a`XmlTextReader`而不是 a传递`StreamReader`给`Deserialize`方法来解决此问题。将 XmlTextReader 的[Normalization](http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.normalization.aspx)属性设置为`false`。

您还应该能够通过将字符串序列化为 CDATA 来解决此问题；请参阅[如何使用 XmlSerializer 将字符串序列化为 CDATA？](https://stackoverflow.com/q/1379888/385844)了解更多信息。

# android - Sharedpreferences 不适用于 appWidgetProvider（getApplicationContext 未定义）

> ID：10489778
> 
> 赞同：0
> 
> 时间：2012-05-07T22:02:35.893
> 
> 标签：android, widget, sharedpreferences

我正在创建一个小部件，它将从数据库中为用户显示一些数据。其中一个数据取决于可以在我的设置活动中设置的参数。我用 sharedpreferences 保存这个参数，这样我就可以在我的代码中的任何地方使用它。在一个活动中，我可以使用 getApplicationContext，但在这里我告诉小部件做什么，它不起作用。我应该使用什么来代替 getApplicationContext？

***更新***

```
public class plWidget extends AppWidgetProvider{

    SharedPreferences sharedPreferences;
     String loadedWeightType;

    @Override
    public void onDeleted(Context context, int[] appWidgetIds) {
        // TODO Auto-generated method stub
        super.onDeleted(context, appWidgetIds);
        Toast.makeText(context, "deleted", 2500).show();
    }

    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager,
            int[] appWidgetIds) {
        // TODO Auto-generated method stub
        super.onUpdate(context, appWidgetManager, appWidgetIds);

         String Wcal="0",Wfat="0",Wprot="0",Wcarb="0",Wsport="0";

         final int N = appWidgetIds.length;

         for (int i = 0;i<N;i++)
        {
            int awID = appWidgetIds[i];
            updateAppWidget(context, appWidgetManager, appWidgetIds[i]);

            GlobalVars.setSulyType(loadedWeightType);           
        Log.i("SULYYYY", GlobalVars.getSulyType());

        long now = System.currentTimeMillis();
        SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMdd");
        Date resultdate = new Date(now);
        Log.i("ASAS", sdf.format(resultdate));

        hornot database = new hornot(context);
        database.open();

         int ccc = database.checkDataExists(sdf.format(resultdate), sdf.format(resultdate));
        if (ccc==0){
            Log.i("nulla", "0");
            Log.i("nulla", GlobalVars.getSulyType());

            Wcal="0";
            Wfat="0";
            Wprot="0";
            Wcarb="0";
        }

        else{

        database.getDateFromAndToFromDatePicker(sdf.format(resultdate), sdf.format(resultdate));
         Wcal = GlobalVars.getSums();

        database.FATgetDateFromAndToFromDatePicker(sdf.format(resultdate), sdf.format(resultdate));
         Wfat = GlobalVars.getSums();

        database.PROTEINgetDateFromAndToFromDatePicker(sdf.format(resultdate), sdf.format(resultdate));
         Wprot = GlobalVars.getSums();

        database.CARBSgetDateFromAndToFromDatePicker(sdf.format(resultdate), sdf.format(resultdate));
         Wcarb = GlobalVars.getSums();

                }

        int ddd = database.checkDataExistsSports(sdf.format(resultdate), sdf.format(resultdate));
        if (ddd==0){
            Wsport="0";

        }
        else{

            if (loadedWeightType.equals("kilogramm"))
                    {
            database.SportgetDateFromAndToFromDatePicker(sdf.format(resultdate), sdf.format(resultdate));
            // Wsport = GlobalVars.getSums();
             Wsport= "kilogramm";

                    }
            else if (loadedWeightType.equals("pound"))
                    {
            database.SportgetDateFromAndToFromDatePicker(sdf.format(resultdate), sdf.format(resultdate));
            Wsport="pound";
                    }

        }

        RemoteViews v = new RemoteViews(context.getPackageName(), R.layout.widget);
        v.setTextViewText(R.id.tvwidgetUpdate, Wcal+Wfat+Wprot+Wcarb+Wsport);
        appWidgetManager.updateAppWidget(awID, v);
        database.close();

        }

    }

    public void updateAppWidget(Context context, AppWidgetManager appWidgetManager, int appWidgetId) { 
        SharedPreferences prefs = context.getSharedPreferences(plWidget.class + Integer.toString(appWidgetId),
                Context.MODE_WORLD_READABLE);
         loadedWeightType= prefs.getString("weighttype", "kilogramm");
    }

} 
```

提前致谢！

***更新***

像往常一样，我执行加载功能：

```
 public void LoadWeightType(){
        sharedPreferences = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
        loadedWeightType= sharedPreferences.getString("weighttype", "kilogramm");
      } 
```

在正常活动中，我可以加载权重类型。我想 updateAppWidget 函数应该以某种方式替换这个函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:24:05.867

```
public static void updateAppWidget(Context context, AppWidgetManager appWidgetManager, int appWidgetId) {
SharedPreferences prefs = context.getSharedPreferences(MyConfigActivity.NAME + Integer.toString(appWidgetId), Context.MODE_WORLD_READABLE); 
```

我从 onUpdate 为我的小部件的每个实例调用 updateAppWidget，并传入参数。传入的 Context 定义了 getSharedPreferences ，我根据配置活动的名称和小部件的 id 指定要获取哪组首选项。这是 getSharedPreferences 函数的 sdk 参考：http: [//developer.android.com/reference/android/content/Context.html#getSharedPreferences%28java.lang.String,%20int%29](http://developer.android.com/reference/android/content/Context.html#getSharedPreferences%28java.lang.String,%20int%29)

# java - 如何在Birt中开发报表并在ASP.NET中使用？

> ID：10489779
> 
> 赞同：3
> 
> 时间：2012-05-07T22:02:49.357
> 
> 标签：java, asp.net, report, birt

我完全是报告领域的新成员。我的问题是，我需要在 ASP.NET 中使用 Birt 进行报告。但似乎 Birt 仅在 Java 中可用。我不知道如何在 ASP.NET 中使用它。我不想使用 Crystal 报表，因为它不是免费的。

我还观察到通过 Actuate API 在 Birt 中设计报告也不是免费的。因此，任何对使用 Birt 在 ASP.NET 中开发、设计和查看报告有任何想法的人

我想要像（Avg、Sums、Complex Formulas Work 和任何报告工具的通用特性）这样的功能，以便通过 Birt Reports 使用 ASP.NET 在 Web 上查看数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-10-20T13:48:30.937

如果您可以将 Java 与 .NET 一起安装在服务器上，则只需在 localhost 上运行 BIRT 服务器并从 .NET 代理到它。这是来自 MVC 控制器的（部分）示例：

```
 private FileResult PdfTest(string reportPath, List<ReportParameter> parameters)
     {
        string url = "http://localhost:8080/birt/frameset?__report=test.rptdesign&sample=" + reportPath + "&__dpi=96&__format=pdf&__pageoverflow=0&__asattachment=true&__overwrite=false";
        url += urlParams;
        using (var wc = new System.Net.WebClient())
        {
            return File(wc.DownloadData(url), "application/pdf");
        }
    } 
```

# entity-framework - EF 5.0 枚举不生成

> ID：10489789
> 
> 赞同：4
> 
> 时间：2012-05-07T22:03:39.247
> 
> 标签：entity-framework, entity-framework-migrations, entity-framework-5

**背景** 我在安装了 .Net 4.5 的机器上使用 VS 2010，我读过它是就地安装（覆盖 .net 4.0 版本）。

我的项目仍然针对 4.0 和 4.5 选项不可用，但被告知没关系，因为 4.5 是就地安装。然后，我通过 nuget 安装了 EntityFramework -pre，并在运行 Upgrade-Database -Script 命令时发出通知，它不会生成枚举属性。

然后我发现[了这个](http://thedatafarm.com/blog/data-access/moving-projects-from-ef-4-1-2-3-ndash-gt-ef5beta-don-rsquo-t-do-what-i-did/)。我再次尝试从头开始做所有事情，但它仍然添加 EntityFramework 4.4 而不是 5.0。所以我手动将所有引用更改为指向 5.0 版本，以确保我拥有 EF 5.0 版本。全部编译。

**问题** 当我跑步时

```
Enable-Migrations -EnableAutomaticMigrations 
```

我得到“*在当前项目中找不到从 DbContext 派生的类。编辑生成的配置类以指定启用迁移的上下文。* ”

所以我手动确保我的课程是正确的，如下所示：

```
internal sealed class Configuration : DbMigrationsConfiguration<DataContext>
{
    public Configuration()
    {
        AutomaticMigrationsEnabled = true;
    } 
```

DataContext 是 DbContext 的子类。

当我跑

```
Update-Database -Script 
```

我得到“*在程序集 'MyProject' 中找不到迁移配置类型。（在 Visual Studio 中，您可以使用包管理器控制台中的 Enable-Migrations 命令添加迁移配置）。* ”

MyProject 确实具有我上面提到的配置类，并且在包管理器控制台中，我为包含迁移文件夹和此配置类的项目选择了正确的下拉列表。

**问题**

1.  当我通过 nuget 安装 EnittyFramework 时，我该怎么做才能确保它添加了 5.0 版本而不是 4.4，即使我安装了 .Net 4.5？

2.  如果我不能做与上述问题相关的任何事情，我能做些什么来确保 Upgrade-Database 吐出一个脚本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-07T22:43:23.300

Entity Framework 5.0 尚未发布。有[预发布版本](http://nuget.org/packages/EntityFramework/5.0.0-beta2)，但您需要专门启用预发布版本才能让 NuGet 显示它们。

但是，请记住，EF 5.0 不会像 .NET 4.5 那样支持 .NET 4.0 中的所有内容。是的，.NET 4.5 会覆盖 .NET 4.0，但如果您的项目在 VS2010 中，它将被配置为为 .NET 4.0 而不是 .NET 4.5 构建。它不能假定 .NET 4.5 功能，因为结果需要在没有 .NET 4.5 的系统上运行。毕竟，您的目标是 .NET 4.0，枚举支持不在您从 NuGet 获得的 EntityFramework DLL 中，而是在 System.Data.Entity DLL 中，它是 .NET 运行时的一部分，因此无法添加到 .网络 4.0。您可以安装[Visual Studio Beta](http://www.microsoft.com/visualstudio/11/en-us)来创建面向 .NET 4.5 的应用程序。

简而言之：“被告知没关系，因为 4.5 是就地安装” - 不，这不适合您的目的。

# iphone - NSDateFormatter 格式显示不正确的格式

> ID：10489797
> 
> 赞同：1
> 
> 时间：2012-05-07T22:04:27.267
> 
> 标签：iphone, objective-c, nsdate

`NSString`我有格式的日期（作为）：

```
20120508T224500Z 
```

我正在尝试使用从字符串`NSDateFormatter`创建一个：`NSDate`

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"yyyyMMddTHHmmssZ"];
NSDate *dateFromString = [[NSDate alloc] init]; 
```

但这会错误地解析/格式化 NSDate。

我正在尝试获取格式：

```
4:45 PM 5/8/2012 
```

如何使用日期格式化程序`yyyyMMddTHHmmssZ`来获取这种格式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T22:24:33.673

您必须在字符串中单引号“T”和“Z”：`20120508T224500Z`

有关格式信息，请参阅[unicode 日期格式](http://unicode.org/reports/tr35/#Date_Format_Patterns)。

例子：

```
NSString *dateString = @"20120508T224500Z";
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"yyyyMMdd'T'HHmmss'Z'"];
NSDate *dateFromString = [dateFormatter dateFromString:dateString];  
NSLog(@"dateFromString: %@", dateFromString);

[dateFormatter setDateFormat:@"h:m a M/d/yyyy"];
NSString *newDataString = [dateFormatter stringFromDate:dateFromString];
NSLog(@"newDataString: %@", newDataString); 
```

NSLog 输出：

> 日期从字符串：2012 年 5 月 9 日 02:45:00 +0000
> 新数据字符串：2012 年 5 月 8 日晚上 10:45

请注意，NSLog 使用了 NSDate 描述方法，并以本地时间显示日期/时间。
用于`- (void)setTimeZone:(NSTimeZone *)tz`在不同的时区创建字符串。

# javascript - JavaScript 未检测到更改

> ID：10489799
> 
> 赞同：0
> 
> 时间：2012-05-07T22:04:32.553
> 
> 标签：javascript, jquery

我相信这很容易，但我没有走运。我编写了一个分页 jQuery 脚本，可以为我的页面上的列表设置动画。我有下一个和上一个按钮，我根据您在列表中的位置显示/隐藏它们，但是它不会第一次获取位置更改。这是我在 jsFiddle 中的代码：

[http://jsfiddle.net/mikeoram/t4787/](http://jsfiddle.net/mikeoram/t4787/)

我确定我只是缺少一些简单的东西，所有建议都会有所帮助。

请只回答我的问题，我这样做是有原因的，我不可以以不同的方式做。

谢谢，

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:27:52.313

首先，`top`是一个保留变量，它引用层次结构中的顶部窗口。始终在函数内声明变量，以免与其余代码混淆：

```
var top = $('.paginate').css('top'); 
```

其次，使用正则表达式从顶部值中删除非数字，因此它将始终是一个有效的整数：

看到这个[http://jsfiddle.net/MaLDK/1/](http://jsfiddle.net/MaLDK/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:15:44.513

`$('.paginate').css('top');`可以还给你`0px`

如果你想比较数字做`parseFloat( $('.paginate').css('top') );`

如果数字之前没有字符，这将删除任何字符串末尾的非数字。

# c# - 提交用户数据后从模板自动生成页面

> ID：10489802
> 
> 赞同：0
> 
> 时间：2012-05-07T22:04:48.067
> 
> 标签：c#, asp.net, visual-studio-2010, sql-server-2008, web-applications

所以我有一个页面 (AddCustomer.aspx)，其中添加了一个用户信息（姓名、地址、电话号码等）和一个将用户添加到我的 MSSQL 数据库的保存按钮。所以现在，我想要生成一个 .aspx 页面，使用模板使用刚刚提交的信息，以便在填充的列表中，当按下“查看”​​按钮时，它会将我带到那个页。那是另一件事，我必须获得该视图按钮链接才能转到该页面。

有没有办法只用 asp.net c# 来做到这一点，还是我需要一些其他工具？

# java - 可能的精度损失？

> ID：10489806
> 
> 赞同：2
> 
> 时间：2012-05-07T22:05:22.560
> 
> 标签：java

> **可能重复：**
> [Java 精度损失](https://stackoverflow.com/questions/2389457/java-loss-of-precision)

好的，所以对于我正在编写的一个名为“Flight”的程序，我创建了一个计算飞行期间要使用的燃料量的方法。我的代码出现了 2 个错误，尽管上面写着“发现精度可能丢失：需要双精度：int” 谁能帮我找出为什么会出现这个错误？

这是我的该方法的代码：

```
public double calculateFuel(){
    if (numofmiles<1000){
      numofmiles = numofmiles*2;
    }
    else if (numofmiles>1000 && numofmiles<3000){
      numofmiles = numofmiles*1.75;
    }
    else if (numofmiles>3000){
      numofmiles = numofmiles*1.5;
    }
    //basing off of that a plane goes 30 miles on 1 gallon
    double fuel = numofmiles/30;

    return fuel;
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:15:52.577

`numofmiles`需要声明为双精度，而不是整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:21:48.087

将 numOfMiles 声明为双精度。精度损失意味着您正在丢失给定值的信息。如果 numOfMiles 是 1035 的整数值，它将乘以 1.75。这将导致 1811.25 的值不是整数值。截断值以满足变量声明会导致精度损失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T22:22:19.820

您应该使用 double 原始类型或 BigDecimal 来获得任意精度。

# sql - 如何根据另一列获得一列的总和？

> ID：10489807
> 
> 赞同：0
> 
> 时间：2012-05-07T22:05:26.533
> 
> 标签：sql, sum

我当前的 SQL 查询：

```
SELECT WorkOrderParts.PartQTY,
       '$' + CONVERT(varchar(22), WorkOrderParts.PartCost, 1) AS PartCost,
       '$' + CONVERT(varchar(22), WorkOrderParts.PartQTY * WorkOrderParts.PartCost, 1) AS PartsTotal,
       tblParts.fldMfgPartNumber
FROM  tblWorkorders
INNER JOIN WorkOrderParts ON tblWorkorders.ID = WorkOrderParts.WorkOrderId
INNER JOIN tblParts ON WorkOrderParts.PartId = tblParts.ID
WHERE (tblWorkorders.ProcessedDate BETWEEN '5/1/2012 12:00:00 AM'
                                       AND '5/2/2012 12:00:00 AM')
GROUP BY tblWorkorders.ProcessedDate, WorkOrderParts.PartCost,
         WorkOrderParts.PartQTY, tblParts.fldMfgPartNumber, tblWorkorders.ID
ORDER BY tblParts.fldMfgPartNumber 
```

**返回的数据：**

```
PartQTY  PartCost  PartsTotal  fldMfgPartNumber 
-------  --------  ----------  ----------------
1        $48.71    $48.71      1878042C91
1        $48.71    $48.71      1878042C91
1        $48.71    $48.71      1878042C91
1        $11.82    $11.82      1R1804
1        $11.82    $11.82      1R1804
1        $11.82    $11.82      1R1804
4        $255.39   $1,021.56   2697041
1        $8.94     $8.94       3719 
```

**如何修改我的 SQL 查询以返回以下结果：**

```
PartQTY  PartCost  PartsTotal  fldMfgPartNumber 
-------  --------  ----------  ----------------
3        $48.71    $146.13     1878042C91
3        $11.82    $35.46      1R1804
4        $255.39   $1,021.56   2697041
1        $8.94     $8.94       3719 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:15:17.743

```
SELECT SUM(WorkOrderParts.PartQTY) as PartQTY, '$' + CONVERT(varchar(22),
       WorkOrderParts.PartCost, 1) AS PartCost, '$' + CONVERT(varchar(22), 
       WorkOrderParts.PartQTY * WorkOrderParts.PartCost, 1) AS PartsTotal,
       tblParts.fldMfgPartNumber
FROM  tblWorkorders
INNER JOIN WorkOrderParts ON tblWorkorders.ID = WorkOrderParts.WorkOrderId
INNER JOIN tblParts ON WorkOrderParts.PartId = tblParts.ID
WHERE (tblWorkorders.ProcessedDate BETWEEN '5/1/2012 12:00:00 AM'
                                       AND '5/2/2012 12:00:00 AM')
GROUP BY tblWorkorders.ProcessedDate, WorkOrderParts.PartCost,
         tblParts.fldMfgPartNumber, tblWorkorders.ID
ORDER BY tblParts.fldMfgPartNumber 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:11:33.063

你的意思是类似的[`GROUP BY`](http://www.w3schools.com/sql/sql_groupby.asp)声明吗？

`select sum(PartQTY), avg(PartCost), sum(PartsTotal), fldMfgPartNumber from Table group by fldMfgPartNumber`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T22:11:57.700

假设 tblParts.fldMfgPartNumber 是您要分组的列（我猜是 - 基于您的预期结果集），那么您可以尝试以下操作：

```
 SELECT SUM(WorkOrderParts.PartQTY), 
   '$' + CONVERT(VARCHAR(22), MIN(WorkOrderParts.PartCost), 1) AS PartCost, 
   '$' + CONVERT(VARCHAR(22), SUM(WorkOrderParts.PartQTY * WorkOrderParts.PartCost), 1) AS PartsTotal, 
    tblParts.fldMfgPartNumber 
 FROM tblWorkorders 
 INNER JOIN WorkOrderParts ON tblWorkorders.ID = WorkOrderParts.WorkOrderId 
 INNER JOIN tblParts ON WorkOrderParts.PartId = tblParts.ID 
 WHERE (tblWorkorders.ProcessedDate BETWEEN '5/1/2012 12:00:00 AM' AND '5/2/2012 12:00:00 AM') 
 GROUP BY tblParts.fldMfgPartNumber; 
```

# javascript - 正则表达式匹配/替换

> ID：10489809
> 
> 赞同：0
> 
> 时间：2012-05-07T22:05:37.350
> 
> 标签：javascript, python, regex

python中这个（Javascript）的等价物是什么？

```
var patt = /sub(\d+)\.domain\.com\/(\d+)/
  , m    = url.match(patt)
  , url = 'http://sub' + m[1] + '.domain.com/' + m[2] 
```

我是 Python 新手，还不太了解正则表达式系统:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:16:39.627

你已经得到了它

```
>>> x = re.search("sub(\d+)\.domain\.com\/(\d+)","sub123.domain.com/546").groups()
('123', '546')
>>> url = "%s blah blah %s" % x 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T22:19:52.923

您在 Python 中的代码大致相当于

```
import re

url = 'http://sub36.domain.com/54'

patt = re.compile("sub(\d+)\.domain\.com\/(\d+)")
m = patt.search(url)
url = 'http://sub'+m.group(1)+'.domain.com/'+m.group(2) 
```

# java - 从java中的c/c++源代码中提取函数名

> ID：10489813
> 
> 赞同：1
> 
> 时间：2012-05-07T22:06:08.143
> 
> 标签：java, c++, c, ctags

我需要从 c/c++ 源代码文件、函数/类/宏名称及其在文件中的位置中提取。我需要在 java 和很多文件（~100/150）中执行此操作。我怎样才能做到这一点？

所以基本上我需要类似于 ctags 但在 java 中的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-07T22:15:42.673

最简单的事情可能是为 ctags 编写一个[Java Native Interface](http://en.wikipedia.org/wiki/Java_Native_Interface)包装器！

您还可以查看在[Java 中查找 C++ 解析器](https://stackoverflow.com/questions/675255/c-parser-model-for-java)。也许[绑架了 Eclipse 用于语法高亮的解析器](http://www.ibm.com/developerworks/library/os-ecl-cdt3/index.html)。编写自己的解析器将非常痛苦，因为它不是 LALR 语法（我从经验中知道这一点）。

# extjs - 网格面板右键删除列

> ID：10489815
> 
> 赞同：0
> 
> 时间：2012-05-07T22:06:25.260
> 
> 标签：extjs, contextmenu, gridpanel, right-click

我正在尝试制作从网格中删除列的功能，但是在检测用户右键单击的列时遇到问题（右键单击>带有删除选项的上下文菜单）。

目前我正在展示`contextMenu`类似的东西

```
viewConfig: {
    stripeRows: true,
    listeners: {
        itemcontextmenu: function(view, rec, node, index, e) {
            e.stopEvent();
            contextMenu.showAt(e.getXY());
            return false;
        }
    }
}, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T10:14:09.343

您可以将处理程序附加到每一列的 contextmenu 事件，这样您就可以访问该列。然后，您可以使用传入新列数组的 setConfig 函数刷新列模型（减去您刚刚删除的列）。

# c# - DataGridview 未更新到数据库

> ID：10489817
> 
> 赞同：0
> 
> 时间：2012-05-07T22:06:38.380
> 
> 标签：c#, winforms

我正在使用带有 datagridview 的 winforms 应用程序。问题：试图将编辑后的数据保存在数据库中代码：

```
 private void FillData(string selectCommand)
        {
            SQLiteConnection conn = new SQLiteConnection(connString);
            dataGridView1.AutoGenerateColumns = true;
            string selectCommand = "select * from Table1";
            da = new SQLiteDataAdapter(selectCommand, connString);
            conn.Open();
            ds = new DataSet();
            SQLiteCommandBuilder commandBuilder = new SQLiteCommandBuilder(da);
            da.Fill(ds,"Design1");
            dataGridView1.DataSource = ds.Tables[0] ;
            dataGridView1.DataMember = "Design1";
      }
 private void btnSave_Click(object sender, EventArgs e)
        {
            SQLiteConnection conn = new SQLiteConnection(connString);
            try
            {

                dataGridView1.EndEdit();

                for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
                {
                    ds.Tables[0].Rows[i].AcceptChanges();
                }

                da.Update(ds.Tables[0]);

            }
            catch (Exception ex)
            {

                throw ex;
            }

        } 
```

不确定这是否是 Sqlite 的问题。没有错误，除了它没有在数据库中更新。一旦我停止应用程序并重新加载它，编辑就会保存在数据库中。

谢谢孙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:29:01.363

我认为您应该颠倒 AcceptChanges 和 Update 行的顺序

```
 dataGridView1.EndEdit(); 
            da.Update(ds.Tables[0]); 
            // Just accept on the table, no need to do row by row
            ds.Tables[0].AcceptChanges(); 
```

[请参阅此处的备注以获取参考](http://msdn.microsoft.com/en-us/library/system.data.datatable.acceptchanges.aspx)

我还要说，保留所有 vars 并不是一个好习惯。
它们可能会引入难以跟踪的副作用和错误。
在特殊模式下，连接应尽快处理，封装在一个`using`语句中。（前提是您明确请求连接池功能 -> `"Pooling=True;Max Pool Size=100;"`）

例如：

```
 private void SaveData(DataGridView dgv, string selectCommand)  
     {  
        using(SQLiteConnection conn = new SQLiteConnection(connString))
        {
            conn.Open(); 
            SQLiteDataAdapter da = new SQLiteDataAdapter(selectCommand, connString); 
            SQLiteCommandBuilder commandBuilder = new SQLiteCommandBuilder(da); 
            DataTable dt = dgv.DataSource as DataTable;
            da.Update(dt);
            dt.AcceptChanges();
        }
     } 
```

# asp.net - 将 ASP.NET 项目部署到远程主机时出错

> ID：10489820
> 
> 赞同：3
> 
> 时间：2012-05-07T22:06:49.437
> 
> 标签：asp.net

我有一个在我的机器上运行良好的 asp.net 项目（在本地主机上）......但是当我把它放在一个真正的主机上（把它放在网上）时，遇到了一个问题......我收到了这个错误：

解析器错误

说明：解析服务此请求所需的资源时出错。请查看以下特定的解析错误详细信息并适当地修改您的源文件。

解析器错误消息：无法加载类型“AWP_Project.Default”。

源错误：

第 1 行：<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="AWP_Project.Default" %> 第 2 行：
第 3 行：

此页面的第一行（以及我尝试的所有其他页面）的第一行存在问题注意：我的项目名称是 AWP_Project 任何人都可以帮助我吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T04:05:11.667

尝试在您的远程主机上创建一个虚拟目录/网站，并通过复制网站菜单或发布网站上传到该虚拟目录的根目录。

通常，如果您仅上传到文件夹，您的应用程序将无法运行。您应该复制到虚拟目录的根目录或创建一个引用您的文件夹的虚拟目录。

请检查此 url 链接：[Cannot use asp classes in app code/bin/web service](http://gugiaji.wordpress.com/2012/04/23/resolvedcannot-consumeaccessuse-asp-net-classes-in-app_code-bin-folder-and-webservice/)

希望这有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T02:57:52.090

将您的（编译或未编译的）项目从本地机器移动到您的网络主机时，一个常见的“陷阱”是网络主机可能与您的项目/本地/开发机器的配置不同。

*   确保您的 /bin 文件夹中有所有程序集
*   如果您以某种方式为每个文件创建了程序集（dll），请确保将它们全部复制到您的网络主机
*   在调试时，您的网络主机（可能）将具有与您自己的机器不同的安全设置。您正在本地/在 Visual Studio 中进行**完全信任**，而大多数（如果不是全部）网络主机可能会使用**medium trust**。因此，在 Visual Studio 中进行开发时，一个好的经验法则是将您的[**web.config 设置为中等信任度**](http://msdn.microsoft.com/en-us/library/tkscy493.aspx)，以避免“在最后一刻”出现陷阱——尤其是在您的网络主机上没有专用机器的情况下。
*   仅仅因为您的机器上有 .Net 4，并不意味着您的网络主机拥有它。您可以 bin 部署您需要的程序集 - 在 VS 2010 中`right click`您的项目并选择`"Add Deployable Dependencies"`- 这将在 /bin 文件夹中添加您需要的所有必要 dll。是的，您可能不需要所有这些，但是除非/直到您可以相当自如地选择应该或不应该部署哪个，否则您必须信任 Visual Studio....
*   我犹豫要不要添加这个，但仍然 - 询问您的网络主机他们支持什么版本的 ASP.Net/.Net 框架。这听起来很有趣，但相信我，我托管在最大和知名/受信任的网络主机之一上，直到今天，我必须联系支持（但他们的支持是“狂热的” - 线索是谁）将我的网站设置为 ASP.Net 4（他们*支持它，*但他们的人员需要额外的手动配置）。

hth

# excel - 是否有 VBA 函数或公式可按 ID 号对结果进行分组？

> ID：10489826
> 
> 赞同：0
> 
> 时间：2012-05-07T22:07:22.307
> 
> 标签：excel, vba

sheet2有：

```
123, thomas
123, gordon
123, smith
334, joey
334, nancy
3452, angela
3452, liza 
```

我想要的结果是：

```
123, thomas, gordon, smith
334, joey, nancy
3452, angela, liza 
```

有没有一种简单的方法可以用公式来做到这一点？如果没有，我怎么能用 VBA 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T01:17:52.837

这是一个小 VBA 函数（需要微调）

```
Function GetCSV(r As Range, v As Integer) As String
    Dim i As Long, j As Long
    Dim s As String
    For i = 1 To r.Rows.Count
        If r.Cells(i, 1) = v Then
            s = s & ", " & r.Cells(i, 2)
        End If
    Next i
    GetCSV = v & s
End Function 
```

示例用法（假设 A1: B14 是您的数据范围）

```
=GetCSV(A1:B14,A1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T15:51:34.907

将示例起始列粘贴到范围（“A1”）中，将下面的代码粘贴到模块中并运行。我要回家了，由你来做格式化并检查你是否喜欢它！

```
Sub Test()

Dim rRange                  As Range
Dim iRange                  As Integer
Dim rRange_Final            As Range
Dim sString                 As String
Dim iPosition               As Integer
Dim sID                     As Integer
Dim sName                   As String

Dim sCheck                  As String
Dim iCnt                    As Integer
Dim iCntB                   As Integer
Dim iCntC                   As Integer
Dim iCntD                   As Integer
Dim vArray()                As Variant
Dim vArray_Dest()           As Variant
Dim vArray_Final()          As Variant
Dim bCheck                  As Boolean

Application.ScreenUpdating = False

'Set range dynamically and load data into an array
Set rRange = ThisWorkbook.Sheets(1).Range(Cells(1, 1), Cells(1, 1).End(xlDown))
iRange = rRange.Rows.Count
ReDim vArray(1 To iRange)
ReDim vArray_Dest(1 To iRange, 1 To 3)
vArray = rRange

'Split based on comma and load into a two dimensional array
For iCnt = 1 To iRange
    sString = Trim(vArray(iCnt, 1))
    iPosition = InStr(1, sString, ",") + 1
    sID = Trim(Left(sString, Len(sString) - (Len(sString) - iPosition)))
    sName = Trim(Mid(sString, iPosition, Len(sString) - iPosition))
    vArray_Dest(iCnt, 1) = sID
    vArray_Dest(iCnt, 2) = sName
Next iCnt

iCnt = 0
iCntC = 0

'Loop through the newly created array, assign ID
For iCnt = 1 To iRange
    sCheck = vArray_Dest(iCnt, 1)
    If vArray_Dest(iCnt, 3) = Empty Then
        iCntC = iCntC + 1
        ReDim Preserve vArray_Final(1 To iCntC)
        For iCntB = 1 To iRange
            If sCheck = vArray_Dest(iCntB, 1) Then
                vArray_Dest(iCntB, 3) = iCntC
            End If
        Next iCntB
    End If
Next iCnt

'Loop through the array while building string in separate array
iCnt = 0
iCntB = 0

For iCnt = 1 To iCntC
    bCheck = False
    For iCntB = 1 To iRange
        If vArray_Dest(iCntB, 3) = iCnt And bCheck = False Then
            vArray_Final(iCnt) = vArray_Dest(iCntB, 1) & ", " & vArray_Dest(iCntB, 2)
            bCheck = True
        ElseIf vArray_Dest(iCntB, 3) = iCnt And bCheck = True Then
            vArray_Final(iCnt) = vArray_Final(iCnt) & ", " & vArray_Dest(iCntB, 2)
        End If
    Next iCntB
Next iCnt

iCnt = 0

'Fill in range
For iCnt = 1 To iCntC
    ThisWorkbook.Sheets(1).Cells(iCnt, 3).Value = vArray_Final(iCnt)
Next iCnt

End Sub 
```

# algorithm - 获取简单的多边形

> ID：10489829
> 
> 赞同：5
> 
> 时间：2012-05-07T22:07:54.953
> 
> 标签：algorithm, matlab, geometry, polygon

我有一个多边形 C 如下：

![在此处输入图像描述](../Images/6351d886df79029217a42f2e6bb31e14.png)

```
C = 10     0
     2     0
     2     2
     0     2
     2     0
     0     0
     0    10
    10    10 
```

其中第一列代表x的坐标，第二列对应多边形C的y坐标。如上图所示，这不是一个简单的多边形（这个多边形包含一个由白色指定的孔），所以我想从 C 中获取所有不包含孔的简单子多边形。在这种情况下，输出应如下所示：

```
 C1 =  0     2
          2     0
          0     0

    C2 =  2     0
          2     2
          0     2
          0    10
         10    10
         10     0 
```

其中 C1 和 C2 分别对应红色小三角形和红色大多边形。

问题是我如何生成这个子多边形？

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T01:02:02.090

首先我们可以假设所有的交点都存在吗？很容易想出以有趣的方式相交的多边形。[但是，使用http://en.wikipedia.org/wiki/Bentley%E2%80%93Ottmann_algorithm](http://en.wikipedia.org/wiki/Bentley%E2%80%93Ottmann_algorithm)之类的东西，您应该能够找到并添加所有交叉点。

接下来，我将做一个简化的假设，即我们永远不会回溯线段。（您可以通过多种方式处理该病态病例。）

处理完这些细节后，接下来我们需要定位可以由这些点定义的所有最小多边形，无论它们最终算作内部还是外部。（为方便起见，我们将在无穷远处添加一个“点”并将外部算作多边形。）为此，我们首先获取每个点，并按逆时针顺序列出它直接连接的点。（平行于 x 轴是 0 度，相对于 y 轴是 90 度，负 x 轴是 180 度，然后随着您向下移动，我们会环绕。）因此，对于您的示例，我们会得到一些东西像这样：

```
( 0,  0): ( 2, 0), ( 0, 2)
( 2,  0): (10, 0), ( 2, 2), ( 0, 2), ( 0, 0)
(10,  0): (10,10), ( 2, 0)
( 0,  2): ( 0, 0), ( 2, 0), ( 2, 2), ( 0,10)
( 2,  2): ( 2, 0), ( 0, 2)
( 0, 10): ( 0, 2), (10,10)
(10, 10): (10, 0), ( 0,10) 
```

现在每个简单的多边形都会碰到其中两个点*之间*的每个点，反之亦然，我们可以利用其中一个间隙（包括环绕）并轻松生成相关的多边形，在每个角落进行最小可能的逆时针转动（即从点我们来到后一个，可能是包装）。对于每个线段，多边形将位于右侧。当我们拥有每一个点和差距时，我们知道我们拥有所有这些。所以在上面的例子中，我们从一个点`( 0, 0)`和下面的点开始`( 2, 0)`，然后我们查看`( 2, 0)`并找到`( 0, 0)`后面的点`(10, 0)`，然后`(10, 0)`找到`( 2, 0)`后面的点，然后`(10,10)`以这种方式继续追踪：

```
( 0, 0), ( 2, 0), (10, 0), (10,10), ( 0,10), ( 0, 2), ( 0, 0) 
```

（注意，由于方向的原因，这追踪了**外部**区域。）

现在我们从`( 0, 0)`和 备用起点开始`( 0, 2)`，做同样的操作得到：

```
( 0, 0), ( 0, 2), ( 2, 0), ( 0, 0) 
```

（这是小的内三角形。）

因为`( 2, 0)`我们还没有去过`( 2, 2)`。所以让我们这样做。

```
( 2, 0), ( 2, 2), ( 0, 2), ( 0,10), (10,10), (10,0), ( 2, 0) 
```

（这是大的不规则多边形。）

因为`( 2, 0)`我们还没有去过，`( 0, 2)`所以让我们这样做：

```
( 2, 0), ( 0, 2), ( 2, 2), ( 2, 0) 
```

（这是白色的小三角形。）

然后枚举我们可能想要旅行的所有可能的有向线段会发现我们已经涵盖了所有内容。所以这些是我们的多边形。现在我们要弄清楚里面是什么，外面是什么。有一个简单的技巧。找到一个 y 值可能最小的点（如果有平局，任何人都可以）。例如假设我们选择了`( 2, 0)`. 逆时针排列的连接点是`(10, 0), ( 2, 2), ( 0, 2), ( 0, 0)`。它们分别是外部、内部、外部、内部……而且一旦给定多边形的一条边被标记为外部或内部，它的所有有向边都是相同的。因此我们很容易得到：

```
outside:
  - (10, 0), ( 2, 2), ( 0, 2), ( 0, 0)
  - ( 2, 0), ( 0, 2), ( 2, 2), ( 2, 0)

inside:
  - ( 2, 0), ( 2, 2), ( 0, 2), ( 0,10), (10,10), (10, 0), ( 2, 0)
  - ( 0, 0), ( 0, 2), ( 2, 0), ( 0, 0) 
```

你的答案将只是内部多边形。

（小优化，我们根本不需要画外面的多边形。我们可以取第一个找到方向的线段，画出一个里面的，然后去它的一个角，确定线段的方向触摸那个角，然后开始绘制其他内部多边形。如果我们正确跟踪，我们最终会得到它们。）

# ruby-on-rails - 使用 Rails、CoffeeScript 和 Backbone.js 时，首选模型属性命名约定是否“下划线”？

> ID：10489830
> 
> 赞同：1
> 
> 时间：2012-05-07T22:07:57.530
> 
> 标签：ruby-on-rails, backbone.js

大多数通用 CoffeeScript/Backbone.js 示例使用属性名称，例如`someFlag`，但是 Rails 更喜欢/需要`some_flag`。

是否有人知道有关该主题的讨论或考虑到这一点的样式指南？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T03:19:52.393

我的 Backbone 模型遵循服务器技术的惯例。

例如，在我的 Rails 应用程序中，我使用下划线名称设置属性，例如`some_value`.NET 应用程序，我使用大写名称设置属性，例如`SomeValue`.

这使得在后端集成所有内容变得更加容易。记住在客户端代码中执行此操作会带来一些不便，但是一旦我深入到一个项目中，它就会成为该项目的习惯。

在我看来，后端集成的便利性非常值得为使用服务器想要的约定付出一点努力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T03:25:09.703

“计算机科学中只有两个难点：缓存失效和命名。”

——菲尔·卡尔顿

[http://martinfowler.com/bliki/TwoHardThings.html](http://martinfowler.com/bliki/TwoHardThings.html)

# apache - 可能的 Apache 限制 HTTP 请求

> ID：10489834
> 
> 赞同：-1
> 
> 时间：2012-05-07T22:08:44.403
> 
> 标签：apache, plesk

我在 CentOS 上运行 Apache，我想知道 httpd 中是否有特定设置，或者是否存在来自同一 IP 的多个请求的超时期限。

我正在服务器上开发，因此当我不断刷新页面以检查我的工作时，我正在做很多页面加载。我经常遇到 504 超时，或者返回页面需要很长时间，但其他时候速度很快。当我离开它一段时间时它通常非常快（对于前几页加载，然后它再次超时）。

我确信这是一个内置/默认设置，可以防止来自一个客户端的大量请求，但是当我尝试开发时，这让我非常沮丧！

我在 Apache 上运行 Plesk，我想这也可能会限制我？

非常感谢任何线索或提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:51:31.907

不在标准的 apache 模块上，也不在 Centos 附带的模块上（AFAIK）。您收到 504 错误意味着超时发生在 Apache 上的请求（而不是 apache 前面的防火墙上）。这是静态内容吗？

> 我正在服务器上开发

使用您的生产系统进行开发/测试是个坏主意。这也意味着该页面是从脚本生成的 - 您的脚本更有可能出错。尝试对其进行分析。

> 我正在做很多页面加载

真的吗？您可能需要花一些时间思考您的代码以及如何开发代码。

# xcode - 如何更改xcode文件头中的项目名称

> ID：10489837
> 
> 赞同：0
> 
> 时间：2012-05-07T22:09:14.163
> 
> 标签：xcode, xcode4.2

所以最近我通过在 xcode 开发人员套件中单击我的 xcode 项目的目标文件来更改我的项目的名称。这改变了几乎所有的东西。

一是每个文件顶部的注释代码仍然具有旧名称

```
//
//  myClass.m
//  oldname
//
//  Created by iMac on 3/01/12.
//  Copyright (c) 2012 __MyCompanyName__. All rights reserved.
// 
```

所以我想知道是否有一种特定的方法可以从 xcode 更改旧名称.. 或者我是否只需要浏览每个文件并手动更改它们？

第二个问题是我的文件包中的一些文件仍然必须使用旧名称！所以我想知道如何在不搞砸应用程序的情况下更改这些内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T06:01:01.663

如果你想从每个文件中更改“ **MyCompanyName ”。**

移动到搜索导航器快捷键是：cmd+shift+enter

在左侧有一个名为 find 的按钮，选择那里的替换，然后选择 wat name 你想替换字符串当前字符串“ **MyCompanyName** ”。

在所有项目文件中，所有出现的“ **MyCompanyName** ”都将替换为您的新字符串

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T19:43:58.190

### 要更新所有现有文件，只需：

1.  按**CMD+OPTION+SHIFT+F**打开查找和替换。
2.  输入您的旧公司名称和新公司名称。 ![Xcode 查找和替换](../Images/0191d7a2b2a8544ac26725a5033ba0c2.png)
3.  按**全部替换**

### 要为新创建的所有新文件更改**__MyCompanyName__**的默认值，您可以执行以下操作：

1.  在 Xcode 中选择您的项目（如果 Inspector 不可见，请按*CMD+1*） ![Xcode 检查器](../Images/74f4157a9d5446606c8101b95af776d2.png)

2.  在右侧边栏的文件检查器中（如果文件检查器不可见，请按 *CMD+OPTION+1*），编辑项目文档部分下的组织条目： ![Xcode 文件检查器](../Images/b25905c8831d40ca0c2f1691243bbccd.png)

添加到项目中的所有新类都将包含这个新的公司名称。

# eclipse - 仅按文件名在项目中运行某些 junit 测试

> ID：10489838
> 
> 赞同：6
> 
> 时间：2012-05-07T22:09:18.240
> 
> 标签：eclipse, junit

所以我有一个eclipse项目，有一堆junit测试文件。我想运行所有这些，除了具有特定后缀的那些（或者相反，只有那些具有一组后缀的那些）。

例如，我可以在 Maven 中做到这一点；我可以在项目中运行以“Test”结尾的文件中的所有测试，而忽略所有其他文件。

我想在 eclipse 中做类似的事情而无需配置；只是基于名称。现在我会去“运行配置..”然后选择“在选定的项目中运行所有测试..”，但它会运行它在那里找到的所有东西；我想根据后缀省略文件。

有没有办法在eclipse中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T07:48:35.173

有几种选择：

*   使用[cpsuite](https://github.com/takari/takari-cpsuite)
*   [从您的构建路径中排除它们](https://stackoverflow.com/a/9385962/2448440)
*   创建一个像[这样](https://stackoverflow.com/a/457299/1137529)或[这样的测试套件](https://stackoverflow.com/a/1645369/1137529)

# html - CSS3 图像遮罩，photoshop 风格。是否可以？

> ID：10489840
> 
> 赞同：1
> 
> 时间：2012-05-07T22:09:26.823
> 
> 标签：html, css

我想做的不仅仅是简单的图像屏蔽（与文本图像屏蔽无关）。我知道画布遮盖矢量形状和矩形剪裁，但如果我们想使用像 Photoshop 遮罩这样的黑白不透明度贴图怎么办。html5 / css3可以吗？有没有办法用我还没有意识到的画布标签来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:13:38.330

目前只有几种方法可以屏蔽图像。Webkit 有 -webkit-mask，而在 Firefox 中，Mozilla 更喜欢您使用 SVG 掩码来屏蔽图像。

这是一篇关于[画布遮罩的文章](http://www.benbarnett.net/2011/06/02/using-html5-canvas-for-image-masks/)

# mysql - MySQL LEFTJOIN 查询

> ID：10489844
> 
> 赞同：-3
> 
> 时间：2012-05-07T22:10:04.657
> 
> 标签：mysql

我需要一些帮助来正确构建此查询。我几乎打出了我想要做的事情。它不是最好的例子，但它是解释的开始。如果有人能指出我正确的方向，那就太好了。

```
SELECT 
    entry_id,
    author_id,
    title,
    status
FROM exp_channel_titles
WHERE title LIKE %Member Package% 
AND status = 'complete'

LEFTJOIN
SELECT
    entry_id, 
    field_id_14,
    field_id_15,
    field_id_25,
    field_id_27, 
    field_id_28, 
    field_id_29, 
    field_id_30,
    field_id_31,
    field_id_32,
    field_id_33,
    field_id_34,
    field_id_35
FROM exp_channel_data
WHERE entry_id = exp_channel_titles.entry_id

LEFTJOIN
SELECT   
    member_id,
    email
FROM exp_members
WHERE member_id = exp_channel_titles.author_id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:11:44.670

```
SELECT 
    entry_id,
    author_id,
    title,
    status
FROM exp_channel_titles

LEFT JOIN
(SELECT
    entry_id, 
    field_id_14,
    field_id_15,
    field_id_25,
    field_id_27, 
    field_id_28, 
    field_id_29, 
    field_id_30,
    field_id_31,
    field_id_32,
    field_id_33,
    field_id_34,
    field_id_35
FROM exp_channel_data
WHERE entry_id = exp_channel_titles.entry_id)

LEFT JOIN
(SELECT   
    member_id,
    email
FROM exp_members
WHERE member_id = exp_channel_titles.author_id)

WHERE title LIKE %Member Package% 
AND status = 'complete' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T22:19:27.377

你可以`LEFT JOIN`像这样的表格：

```
SELECT 
    t.entry_id, t.author_id, t.title, t.status
    d.field_id_14, d.field_id_15, d.field_id_25, d.field_id_27, d.field_id_28, d.field_id_29, 
    d.field_id_30, d.field_id_31, d.field_id_32, d.field_id_33, d.field_id_34, d.field_id_35,
    m.member_id, m.email
FROM exp_channel_titles t
LEFT JOIN exp_channel_data d on t.entry_id = d.entry_id
LEFT JOIN exp_members m on t.author_id = m.author_id
WHERE t.title LIKE %Member Package% 
  AND t.status = 'complete' 
```

# android - Android：在 tabview 中推送 webview

> ID：10489847
> 
> 赞同：0
> 
> 时间：2012-05-07T22:10:25.597
> 
> 标签：android, mono, xamarin.android, tabview

我有一个`TabActivity`包含一个按钮的活动。

当按下按钮时，我希望另一个活动出现在`same tab`.

当用户按下 时`back button`，会出现原始视图。

这可能吗？

**Android Java 或 MonoDroid .NET 答案很好**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T01:53:13.160

您可以实现一个视图扩展布局并在此布局上绘制两个视图。两种观点可以根据动作交换。

# sql-server-2005 - 一个简单的事务在 SQL Server 2005 上不起作用

> ID：10489850
> 
> 赞同：0
> 
> 时间：2012-05-07T22:10:48.717
> 
> 标签：sql-server-2005, transactions

我在 SQL Server 2005 中这样做。我有一个表，只有一个 int 类型的列，你不能在其中插入 char。

```
DECLARE @intErrorCode INT

BEGIN TRAN
Update TestTable set A='a' where A=3 --UPDATE TO CHAR, FAIL

SELECT @intErrorCode = @@ERROR
IF (@intErrorCode <> 0) GOTO PROBLEM

COMMIT TRAN

PROBLEM:
IF (@intErrorCode <> 0) BEGIN
PRINT 'Unexpected error occurred!'
ROLLBACK TRAN
END 
```

我期待看到“发生意外错误！” 结果。但我实际看到的是：将 varchar 值“a”转换为数据类型 int 时转换失败。

似乎我的 SQL Server 根本没有将我的代码作为事务......它击中了失败线并在那之后立即退出运行。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:19:22.220

首先使用 Try catch 块代替。

但是，没有 sql 错误捕获适用于所有类型的错误。

在联机丛书中阅读有关使用 try catch 块处理错误的内容，您将看到关于哪些类型的错误未被捕获的讨论。

此外，返回实际错误通常比返回一般消息更好。当您知道真正的错误时，更容易追踪错误问题。

# php - 文件确实存在时“无法打开流：没有这样的文件或目录”的可能原因

> ID：10489855
> 
> 赞同：0
> 
> 时间：2012-05-07T22:11:14.333
> 
> 标签：php

**帖子移至：** [导致 PHP 抛出“无法打开流：没有这样的文件或目录”的网络计时问题](https://stackoverflow.com/questions/10502772/network-timing-issues-causing-php-to-throw-failed-to-open-stream-no-such-file)

**编辑**：应该注意的是，这段代码已经到位并且工作了一段时间。我们将服务器配置从具有本地存储图像的单个邮件服务器切换到具有存储图像的共享 NAS 盒的负载平衡配置。然后php开始断断续续地说文件不存在。

99% 的情况下，您会收到一条错误消息，指出文件不存在、文件不存在、存在拼写错误等。

我们有一个将文件上传到临时位置的 .Net 站点。然后我们向传递临时文件的 php 应用程序发送请求。然后，php 应用程序应将文件从其临时位置移动到其永久位置。

我们知道该文件存在，因为在 .Net 中，在将请求发送到 php 应用程序之前，我们会在文件上获取 FileInfo 对象，并检查 FileInfo.Exists，

如果 .Net 确定该文件确实存在，它会将文件路径作为 webrequest 中的参数发送到 php 应用程序。

但是，间歇性地，大约 3 次中的 2 次，php 应用程序给出以下错误：

“无法打开流：没有这样的文件或目录”

事实上，它是间歇性发生的，.Net 说它存在，我们可以导航到磁盘上的位置并进行验证，这表明是的，该文件确实存在。

那么，为什么 php 会抛出此异常的其他一些可能性是什么？

。网：

```
public void Save(string tempPath, string username, string password, bool deleteSrc, string merakController = "", string fileNamePrefix = "")
        {
            FileInfo fi = new FileInfo(tempPath);
            if (fi.Exists)
            {
                Name = (fileNamePrefix ?? string.Empty) + fi.Name;
                FileSize = fi.Length;
                TimeStamp = fi.LastWriteTimeUtc;
                string path = fi.FullName;

                if (string.IsNullOrEmpty(Type))
                    throw new Exception("Attachment Type not set");

                IceWarpGroupware_Http gwh = new IceWarpGroupware_Http(username, password);
                string parameters = string.Format("AttName={0}&AttType={1}&AttDesc={0}&AttSize={2}&AttTime={3}", Name, Type, FileSize, Time);
                bool result = gwh.AddAttachment(m_oid, path, parameters, string.Empty, merakController);

                if (!result)
                    throw new Exception("Unable to add attachment \"" + Name + "\"");

                try
                {
                    if (deleteSrc)
                        fi.Delete();
                }
                catch { }
            }
            //else
              //  throw new Exception("Temp file not found");
        } 
```

php:

```
public function AddAttachment($itemID, $src, $parameters, $value)
    {

        //base64 encode necessary parameters.
        $parameters64 = $this->getBase64(urldecode($parameters));
        $value64 = $this->getBase64($value);

        //Per the API documentation, ADD first, then LOCK, then move manually and then UNLOCK.
        $result = $this->FetchComObject()->FunctionCallBase64('AddAttachment', $this->gsid64, $this->getBase64($itemID), $parameters64, $value64);  //Add the attachment.
        $dest = $this->lockAttachment($this->gsid64, $this->getBase64($itemID), $result);  //Lock the attachment and get the destination path.

        //This is an enhanced version of the file copy routine for error handling if necessary.  Please let alone and commented out when not in use.
        // if (!copy($src, $dest))
        // {
            // if (isset($GLOBALS['php_errormsg']) && !empty($GLOBALS['php_errormsg']))
                // throw new RuntimeException($GLOBALS['php_errormsg']);
            // throw new RuntimeException("File copy failed with an undefined error. [".$src."]");
        // }

        $copySuccess = copy($src, $dest);  //Comment this line out if using the enhanced file copy above.
        //unlink($src);

        $success = $this->unlockAttachment($this->gsid64, $this->getBase64($itemID), $result);  //Unlock the attachment.
        if ($copySuccess == true)
            return true;
        return false;
    } 
```

# excel - 如何将所选单元格的总和显示为提示？Excel VBA

> ID：10489864
> 
> 赞同：0
> 
> 时间：2012-05-07T22:12:32.057
> 
> 标签：excel, vba

这是一个很多人可能觉得没有必要的问题，但对我来说这很有帮助，因为我有分心的问题。

Excel可以在左上角显示所选单元格的总和 ![在此处输入图像描述](../Images/df2a75d37a5181c70c2ff9e2999a539b.png)

但是有没有办法让它出现在鼠标指针旁边？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T17:24:10.700

这可能是一个解决方案，尽管它无论如何都不是完美的，但是如果您想在工作表的其他地方使用数据验证，则必须小心，因为它会破坏它。

当您选择不同的范围时，这将需要重置数据验证范围，但您应该能够首先确定这种方法是否有用。

在选择更改事件中

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
 doSumTip
End Sub 
```

然后使用数据验证在您的选择上设置输入消息。您可以更改它以显示计数或平​​均值等。

```
Sub doSumTip()
Dim myRng As Range
Dim sumTip
Set myRng = Selection
    If myRng.Count > 1 Then
       sumTip = WorksheetFunction.Sum(myRng)
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateInputOnly
            .IgnoreBlank = True
            .InputMessage = sumTip
        End With
    Else
        With Selection.Validation
            .Delete
            .Add Type:=xlValidateInputOnly
            .InputMessage = ""
        End With
    End If
 Set myRng = Nothing
End Sub 
```

或者您可以使用选择范围创建您自己的工具提示，并根据该选择进行定位，建议文本框像数据验证一样着色和平坦

```
Sub doSumTip()
Dim myRng As Range
Dim sumTip
Set myRng = Selection
    If myRng.Count > 1 Then
       sumTip = WorksheetFunction.Sum(myRng)
       cTop = myRng.Top
       cWidth = myRng.Left + myRng.Width
       ActiveSheet.TextBox1.Left = cWidth
       ActiveSheet.TextBox1.Top = cTop
       ActiveSheet.TextBox1.Text = sumTip
       ActiveSheet.TextBox1.Visible = True

     Else
       ActiveSheet.TextBox1.Visible = False
     End If
 Set myRng = Nothing
End Sub 
```

# android - main 无法解析为类型

> ID：10489865
> 
> 赞同：-2
> 
> 时间：2012-05-07T22:12:38.763
> 
> 标签：android, dialog

我是新来的，所以这可能很简单，但我到处寻找，无法找出问题所在。我试图清理项目，main.xml 在资源文件夹中，但仍然无法正常工作。我要做的就是在用户输入名称并点击“显示名称”按钮后显示一个对话框。它真的不应该这么难，我已经使用了网上的几个例子，但无法让它发挥作用。任何帮助或正确方向的观点将不胜感激。先感谢您。我第一次发帖，希望我能正确发布我的问题和代码。

```
package smartTemps.showName.example;

import android.app.Activity;
import android.app.Dialog;
import android.content.DialogInterface;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button
import android.widget.EditText;
import android.widget.TextView;

public class  ShowNameActivity extends Activity implements View.OnClickListener
{
public String name;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    //display dialog with button click

    //create button and register as listener

   Button submitButton = (Button)findViewById(R.id.submitButton);
    submitButton.setOnClickListener(new OnClickListener()
    {
        public void onClick(View view)
        {
            Dialog dialog = new Dialog(main.this);
            dialog.setContentView(R.layout.maindialog);
            //builder.setIcon(R.drawable.btn_star);
            dialog.setTitle("User's name");
            dialog.setCancelable(true);

             //get user name
    EditText inputName = (EditText)findViewById(R.id.inputName);
    name = inputName.getText().toString();
    TextView userName = (TextView)findViewById(R.id.userName);
            //set user name label
            userName.setText("Welcome, " + name);

            Button submitButton = (Button) findViewById(R.id.submitButton);
        }       
 }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:18:02.017

而不是 main.this 尝试`NameOfYourActivity.this`让您的 Activity 的实例引用传递到对话框中。或者甚至创建一个小辅助函数来启动 Dialog 并定期引用 this 并且`OnClickListener`可以简单地调用该辅助函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:16:25.730

您需要在项目的文件夹中有一个`main.xml`文件。`res/layout`

如果您有这样的文件，请检查 xml 中是否存在阻止资源编译器生成 R.java 的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T22:21:40.927

如果您阅读文档：

```
Dialog dialog = new Dialog(main.this); 
```

这是错误的（因为您的 Activity 不称为 main），您需要传入 Context 或 Activity。如果您要传递您的活动，那么如果我有一个名为 Activity1 的活动：

```
Dialog dialog = new Dialog(this); 
```

在这样的类的范围内：

```
public class Activity1 extends Activity implements View.OnClickListener
{
     // Inside here you would put the line above, where this would refer to Activity1
} 
```

学习一些基本的java :)

# javascript - 在 iframe 中卸载在 Google Chrome 上不起作用

> ID：10489869
> 
> 赞同：2
> 
> 时间：2012-05-07T22:13:37.810
> 
> 标签：javascript, jquery

我一直在尝试使用，`.unload()`但我似乎无法使用它。我对此进行了研究，我发现卸载在谷歌浏览器的 iFrame 中时不起作用，但对于 mozilla 来说它工作正常。

所以我的问题是，有没有`unload`在 iFrame 中使用？我知道使用`load`作为替代会做到这一点，但每次 iFrame 更改时它都会向 ajax 发送垃圾邮件。

我在 Goggle Chrome 中尝试过这段代码，但它不起作用，但在 Mozilla 中它工作得非常好。

```
$(window).unload( function () { alert("Bye now!"); } ); 
```

任何替代品`unload`或无论如何使用`unload`？

# sql - SQL - 空白默认命名空间

> ID：10489871
> 
> 赞同：3
> 
> 时间：2012-05-07T22:13:49.710
> 
> 标签：sql, xml, sql-server-2008, xquery

我有一个关系，它有一个 XML 列以以下结构存储数据

```
<Report id="b5d9b8da-7af4-4257-b825-b28af91dd833">
    <CreatedDate>04-12-2012</CreatedDate>
    <LastUpdated>04-12-2012</LastUpdated>
    <Reference>abc123</Reference>
</Report> 
```

我正在编写一个存储过程来检索所有报告并将它们加入并将它们包装在一个名为报告的根节点中。到目前为止，我有以下内容；

```
WITH XMLNAMESPACES(DEFAULT 'http://www.defaultnamespace.com/1.0')
        SELECT
    @Xml = 
    (

            SELECT
                (
                    SELECT xml.query('.')
                    FROM
                        [database].[Reports]
                    WHERE
                        ClientId = @clientId
                    FOR XML PATH(''),
                    TYPE
                )
            FOR XML PATH('Reports'),
            TYPE
        ) 
```

虽然这会以正确的格式返回所有报告，但报告元素上存在一个空白的默认命名空间，如下所示；

```
<Reports xmlns="http://www.defaultnamespace.com/1.0">
<Report  xmlns="" id="b5d9b8da-7af4-4257-b825-b28af91dd833">
    <CreatedDate>04-12-2012</CreatedDate>
    <LastUpdated>04-12-2012</LastUpdated>
    <Reference>abc123</Reference>
</Report>
</Reports> 
```

有人可以解释在报告元素上排除命名空间的合适方法吗？

非常感谢任何帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-07-10T06:43:25.750

它有点混乱，可能效率不高，但您可以使用 XQuery 在中间 XML 上重新定义名称空间。

您可以在 XQuery 中声明默认命名空间，而不是使用 SQL Server `WITH XMLNAMESPACES`，例如...

```
if object_id(N'Reports') is not null drop table [Reports];
go
create table [Reports] (
    [ClientId] int not null,
    [xml] [xml] not null
)
go
insert [Reports] ([ClientID], [xml])
    values (1, N'<Report id="b5d9b8da-7af4-4257-b825-b28af91dd833">
    <CreatedDate>04-12-2012</CreatedDate>
    <LastUpdated>04-12-2012</LastUpdated>
    <Reference>abc123</Reference>
</Report>');
go
declare @clientId int = 1
select  (
    select [xml].query('/*:Report')
    from [Reports]
    where ClientId = @clientId
    for xml path('Reports'), type
    ).query('declare default element namespace "http://www.defaultnamespace.com/1.0";
    for $x in /*:Reports return
        <Reports>
        {
            for $y in $x/*:Report return
            <Report>
                {attribute id {$y/@id}}
                {element CreatedDate {$y/*:CreatedDate/text()}}
                {element LastUpdated {$y/*:LastUpdated/text()}}
                {element Reference {$y/*:Reference/text()}}
            </Report>
        }
        </Reports>')
go 
```

这将返回以下 XML 块：

```
<Reports xmlns="http://www.defaultnamespace.com/1.0">
  <Report id="b5d9b8da-7af4-4257-b825-b28af91dd833">
    <CreatedDate>04-12-2012</CreatedDate>
    <LastUpdated>04-12-2012</LastUpdated>
    <Reference>abc123</Reference>
  </Report>
</Reports> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T10:28:10.850

您的问题是该列未使用默认命名空间“http://www.defaultnamespace.com/1.0”存储。

所以你的标签的逻辑名称是 NS = "", name =Report。

SQL Server 是绝对正确的。

你想做的就是说

> 顺便说一句，我存储的那个 XML 数据，我希望你将每个标签从逻辑上附加到每个名称的“”命名空间重写为“http://www.defaultnamespace.com/1.0”中具有相同相对名称的标签" 命名空间，然后将其设为默认命名空间

AFAIK，你不能那样做（但如果你找到办法让我知道！）。您可以获得的最接近的是将其强制转换`nvarchar(max)`为没有命名空间，然后在应用所需命名空间的情况下再次将其强制转换回来。

# jquery-ui - 重新打开 jquery ui 对话框，清空并刷新

> ID：10489872
> 
> 赞同：1
> 
> 时间：2012-05-07T22:13:56.760
> 
> 标签：jquery-ui, jquery

这个 jquery ui 对话框充满了来自 ajax 调用（有效）的 html 和表单值。我想关闭或提交它，然后重新打开并重新使用它。我可以关闭并重新打开，但它仍然存在旧值，然后添加了新值。每次关闭并重新打开后，它都会不断添加 html 值。SO上有很多关于这个的问题，但我没有看到明确的答案。我尝试过关闭、清空、销毁，但组合并没有按照我需要的方式工作。有任何想法吗？

```
$("#StoreForm").dialog({
    autoOpen:false, 
    width:500, 
    height:900, 
    modal:true,
    buttons: { 
   OK: function() { 
   $('#StoreForm').dialog('close'); 
$(this).dialog('hide');
$(this).dialog('empty'); 
 }, 
 'Save': function() { 
  $(this).dialog('empty'); 
 } 

 }

 });

 //additional code to click and open the dialog

 $(".sel").unbind('click');
 $(".sel").on("click", function(e){
e.preventDefault();                 
 $("#StoreForm").dialog('open');
 var valueSelected = $(this).closest('tr').children('td.item').text();                                  
$.ajax({
url: 'query/categories.cfc',
dataType: 'json',
cache: false,
data: {method: 'getProductInfo', 
                                queryFormat: 'column',
                            returnFormat: 'JSON',
productID:   valueSelected

},
success: function(response, status, options){
$("#PROD_SUPER_ID").val(response.DATA.PROD_SUPER_ID[0]);

$("#color").val(response.DATA.COLOR_ATTRIB);

                            $("#SIZE_ATTRIB").val(response.DATA.SIZE_ATTRIB);

$("#price").val(response.DATA.PRICE);
var w = [];
w.push("<p>", response.DATA.ICON[0], "</p>", "<p>", 
      response.DATA.FULL_DESCRIPTION [0], "</p>") 
                            $("#StoreForm").prepend(w.join("")); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T13:07:26.287

我发现你可以关闭对话框并清空 html，它会清除这种类型的对话框设置。为了重新打开，我将第二个 ajax 调用嵌套在第一个成功响应中。

```
 //set up dialog with options

$("#StoreForm").dialog({
autoOpen: false,
width: 500,
height: 500,
modal: true,
buttons: {
    Cancel: function(){

        $('#StoreForm').dialog('close');
        $('#StoreForm').html("");

    },

//pop-up individual items

    "Add to Cart": function(){
            $.ajax({
            url: $("#storeCart").attr('action'),
            data: $("#storeCart").serializeArray(),
            type: 'POST',
            success: function(response){

                  var name = $( "#name" ),
    email = $( "#email" ),
    password = $( "#password" ),
    allFields = $( [] ).add( name ).add( email ).add( password ),
    tips = $( ".validateTips" );

if you have any questions please respond. Thanks 
```

# javascript - 在服务器发送的 JavaScript 代码上安全使用 eval()

> ID：10489874
> 
> 赞同：11
> 
> 时间：2012-05-07T22:14:05.610
> 
> 标签：javascript, node.js, websocket

我正在使用 Node.js 和 Socket.io。我编写了一个应用程序，它可以从服务器发送 JavaScript 片段并在客户端执行它们。JavaScript 通过 Secure WebSocket (WSS) 发送，客户端有一个侦听器，它将执行通过服务器传递给它的任何代码。

这个简短的脚本演示了原理： http: [//jsfiddle.net/KMURe/](http://jsfiddle.net/KMURe/)，您可以将 onScript 函数视为套接字侦听器。

# 问题

我可以采用哪些安全协议来确保此交易的安全？安全的 websocket 通道是否会使第三方难以充当中间人（在将代码发送到客户端之前更改代码）？

## 一些用例..

*   动态分配的分布式计算。
*   浏览器客户端可以从服务器动态学习。
*   统一更新浏览器行为。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-08T01:31:14.770

`eval()`，即使您有合法用途，也很危险。您应该~~不惜一切代价避免使用它。~~小心使用它。

但是，如果确实需要，则可以通过[`"use strict"`command](https://developer.mozilla.org/index.php?title=en/JavaScript/Strict_mode)使用严格模式。在 [`eval()`严格函数中执行时](https://developer.mozilla.org/index.php?title=en/JavaScript/Strict_mode#Making_eval_and_arguments_simpler)，eval 的内容不会在直接作用域内泄漏。eval 中的代码将[包含在`eval()`](http://jsfiddle.net/gN9bE/1/)自身中（就好像它有自己的范围一样）。[在演示](http://jsfiddle.net/gN9bE/1/)中，尝试删除尾随`x`并`eval()`返回`undefined`。

但是，使用仍然`eval()`是危险的。如果您找到带有自定义字符串命令的 JSON 等替代方案，这些命令将在客户端解析，那就更好了。

# macos - 如何在 mac os x 10.7 中移动默认用户子目录“Sites”？

> ID：10489875
> 
> 赞同：4
> 
> 时间：2012-05-07T22:14:14.520
> 
> 标签：macos, sites

我想将我的站点目录从我的启动盘上移到一个外部硬盘驱动器上。

例如，我将 ~/Sites 目录的所有内容移动到外部驱动器 /Volumes/ExternalDrive/Sites

我在想我可以删除启动盘上的站点版本，然后链接到外部硬盘驱动器位置。当我尝试这样做时，我收到一个错误：

*“站点”不能被修改或删除，因为它是 Mac OS X 的要求。*

我相信我已经更新了所有适当的 apache2 配置文件，但我相信这是一个 mac 的东西。

任何帮助表示赞赏。

谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:22:56.767

我还没有在 10.7 中尝试过，但是我在 10.6 中的其他默认用户文件夹中遇到了类似的问题。我最终使用命令行来强制解决问题，这可能对您使用 Sites 文件夹有用。

首先，确保您已正确备份内容。然后打开终端并尝试：

```
sudo rm -r /Users/yourusernamehere/Sites
ln -s /Volumes/ExternalDrive/Sites /Users/yourusernamehere/Sites 
```

第一行删除具有根级别权限的站点文件夹。第二行在您的用户文件夹中创建一个指向 /Volumes/ExternalDrive/Sites 的软链接，名称为 Sites。此软链接将在 Finder 中显示为别名，但在命令行等下会更好地工作。

# php - 将 PHP 对象图序列化/反序列化为 JSON

> ID：10489876
> 
> 赞同：7
> 
> 时间：2012-05-07T22:14:20.130
> 
> 标签：php, arrays, json, serialization, reference

我想将完整的 PHP 对象图序列化为 JSON 字符串表示，然后将其反序列化回相同的 PHP 对象图。

以下是我考虑过的选项的摘要，以及它们对我不起作用的原因：

*   `serialize()`没有做我想做的事，因为它使用特定于 PHP 的格式。我想要一种被大多数语言广泛支持并且人类可读/可编辑的格式。

*   `json_encode()`没有做我想要的，因为它只做简单的值和数组，而不是对象。（我实际上在我的实现中使用它，见下文。）

*   `var_export()`不处理循环引用，也不做我想做的事（见上文。）*（请注意，我当前的实现也不处理循环引用 - 请参阅下面的评论和回复以澄清此问题。）*

*   Sebastian Bergmann 的[Object Freezer](https://github.com/sebastianbergmann/php-object-freezer)是一个很好的实现，但它也没有达到我想要的效果 - 它使用很长的形式，并且依赖于使用 GUID 填充序列化对象。

*   [序列化](https://github.com/ktomk/Serialized)并没有做我想要的——它实际上并不执行序列化，它解析输出`serialize()`并产生不同的表示，例如 XML，但无法解析该表示。（它也不支持 JSON - XML 格式很长，不是我想要的。）

我现在有一个可行的实现来分享：

[https://github.com/mindplay-dk/jsonfreeze](https://github.com/mindplay-dk/jsonfreeze)

对象图的 JSON 表示形式如下所示：

```
{
    "#type": "Order",
    "orderNo": 123,
    "lines": [{
        "#type": "OrderLine",
        "item": "milk \"fuzz\"",
        "amount": 3,
        "options": null
    }, {
        "#type": "OrderLine",
        "item": "cookies",
        "amount": 7,
        "options": {
            "#type": "#hash",
            "flavor": "chocolate",
            "weight": "1\/2 lb"
        }
    }],
    "paid": true
} 
```

这种方法设计用于纯树结构聚合 - 不允许循环引用，也不允许对同一对象的多个引用。换句话说，这不是通用的，如 eg`serialize()`和`unserialize()`任何 PHP 对象图的函数。

在我[最初的方法](https://gist.github.com/2630741/17041e14f58c8c2ecc30b1dabdfe5e8f87460412)中，我使用了一个序列化的表单，它本质上是一个以 0 为基础的对象列表。列表中的第一个对象（编号 0）是序列化对象图的根，任何其他对象都按照它们被发现的顺序存储。

在当前的实现中，JSON 表示类似于原始的树结构，以扩展这是可能的，这使得在 JavaScript 中实际使用对象图的 JSON 表示成为可能。唯一的偏差是魔术`#type`属性（以 # 为前缀以防止与属性名称冲突）和`#hash`“类型”，用于区分`array`-type 哈希（存储为 JSON 对象）和常规`array`-type 数组（存储为 JSON 数组）。

* * *

*出于历史目的，我将在此处留下有关先前版本的这些注释。*

循环引用通过从不将嵌套对象存储在每个对象的序列化表示中来简单地处理 - 相反，任何对象引用都存储为具有对象索引的 JSON 对象 - 例如`{"__oref":2}`，是对对象中具有索引`2`的对象的引用 -列表。

我在我的实现中遇到了数组引用的问题 - 当我在将对象的引用恢复到数组的代码中使用 var_dump() 时，它们正在被填充，但在某些时候数组被复制了，你最终得到空副本。我尝试`&`在代码中的任何地方放置字符，但无论我通过引用传递到哪里，最终结果都是一个空数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T01:42:29.370

完成的脚本（上面发布）符合我的精确要求：

*   序列化和反序列化整个聚合。

*   具有与原始数据结构非常相似的 JSON 表示。

*   不要用动态生成的键或其他数据污染数据结构。

它不处理循环引用。[正如上面评论](https://stackoverflow.com/questions/10489876/serialize-unserialize-php-object-graph-to-json-partially-working-solution-need#comment13570677_10489876)中指出的那样，没有正确的方法来存储循环引用或对同一对象的多个引用，因为它们都是相等的。意识到这一点，我决定我的对象图必须是一棵常规树，并接受这个限制作为“一件好事”。

**更新**：现在可以使用缩进、换行符和空格来格式化输出 - 对我来说，为了我的目的，拥有一个人类可读（并且源代码控制友好）的表示非常重要。（可以根据需要启用或禁用格式化。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:12:14.697

我不知道这是否是您所追求的，但如果您只对获取对象的公共属性感兴趣，那么 get_object_vars($obj) 就可以了。

```
<?php

class foo {
    public $fname = "John";
    public $sname = "Doe";
    private $status = null;
    static $type = "person";

}

$obj = new foo;

print_r( (get_object_vars($obj)) );

print json_encode(get_object_vars($obj));

?> 
```

将输出：

数组（[fname] => John [sname] => Doe）

{"fname":"John","sname":"Doe"}

上述方法对于访问函数引用和私有变量是无用的，但您可以将其与更多代码结合使用来敲出您想要的内容。

迪内什。

# php - PHP5 fsockopen 连接错误中断站点，无论我如何捕获它

> ID：10489880
> 
> 赞同：1
> 
> 时间：2012-05-07T22:14:49.533
> 
> 标签：php

我正在尝试使用 fsockopen 与游戏服务器进行通信，该服务器会响应一些基本统计信息。它在服务器在线时完美运行，但如果服务器离线，以下代码会导致 php 停止显示读取数据的页面。

```
try {
        $socket = fsockopen($host, $port, $errno, $errstr, 10);
        if ($socket !== false) {
                fwrite($socket, "\xFE");
                $data = "";
                $data = fread($socket, 1024);
                fclose($socket);
                if ($data !== false && substr($data, 0, 1) == "\xFF") {
                       // get into
                } else {
                        // Server did not send back proper data, or reading from socket failed.
                        print "Server not available.";
                }
        } else {
             // ...
        }
} catch(Exception $e){
        // ...
} 
```

我已经尝试过 try/catch，我已经尝试向异常添加自定义处理程序。我唯一的想法是在 Web 请求之外运行它并存储响应，以便 Web 请求不会启动它。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:08:47.527

首先，我将在 fsockopen 调用的任一侧添加几个 echo 命令：

```
echo date("Y-m-d H:i:s")."Before open\n";
$socket = fsockopen($host, $port, $errno, $errstr, 10);
echo date("Y-m-d H:i:s")."After open (socket=".($socket===false?"Bad":"OK")."\n"; 
```

这是为了确认 10 秒超时有效。如果您从未看到第二条消息，则超时不起作用，并且问题更加模糊。

无论如何，如果你得到一个有效的 $socket，但锁定发生在后面，那么试试：

```
if ($socket !== false) {
    stream_set_timeout($socket,2);  //2 second timeout
    stream_set_blocking($socket,false);  //no blocking
    fwrite($socket, "\xFE");
    ... 
```

PS如果添加这两个命令可以解决问题，然后尝试看看其中一个是否可以解决问题。这将提供一个很大的线索，真正的问题是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T23:29:41.297

似乎通过将逻辑移到 html 生成之外是有效的。查找发生在任何 html 呈现之前，因此如果它失败，它不会中断 html 输出。

# php - 将ajax数据传递给codeigniter控制器

> ID：10489881
> 
> 赞同：1
> 
> 时间：2012-05-07T22:14:53.703
> 
> 标签：php, ajax, jquery-ui, codeigniter

我试图通过 AJAX 从 Jquery 的可选函数中传递数据并将其捕获在 codeigniter 控制器中。没运气！

Javascript

```
$(function() {
    $( "#selectable" ).selectable({
        selected: updatefilters,
        unselected: updatefilters
    });   
    function updatefilters(ev, ui){
        var $selected = $('#selectable').children('.ui-selected');
        var filters = $selected.map(function(){return this.id;}).get().join("|");
        $.ajax({
            type: "POST",
            url: 'updatefilters',
            data: { filters: filters },
            success: function(data){
                $('#board').replaceWith(data.content);
            }
        });
    }
}); 
```

控制器

```
 public function updatefilters()
    {
        $filters = $this->input->post('data');
        print_r($filters);
        $filterarray = split("|", $filters);
        $this->thread_model->create_session_filter($filterarray); 
        $threads = $this->thread_model->get_threads();
        $data['json'] = '{"content":' + $threads + '}';
        $this->load->view('json_view', $data); // See step 4!!!
    } 
```

意见

json_view

```
<?php
header("Content-Type: application/json");
echo $json;
?> 
```

jQuery选择视图

```
<ol id="selectable">
    <li class="ui-state-default" id="everything">Everything!</li>
    <li class="ui-state-default" id="entertainment">Entertainment</li>
    <li class="ui-state-default" id="sci/tech">Sci/Tech</li>
    <li class="ui-state-default" id="news">News</li>
    <?php 

    if ($this->session->userdata('inactivefilter') == true) {
            $inactivefilter = $this->session->userdata('inactivefilter');
            foreach ($inactivefilter as $new)
                {
                    echo "<li class='ui-state-default' id='custom'>$new</li>";
                }
        }
    ?>
</ol> 
```

在 Firebug 中，我可以看到通过 AJAX 传递的“过滤器”数据未被识别。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:20:46.857

尝试这个：

```
 $.ajax({
        type: "POST",
        url: 'updatefilters',
        dataType: 'json',
        data: { filters: filters },
        success: function(data){
            $('#board').replaceWith(data.content);
        }
    }); 
```

我刚刚添加：**dataType：'json'**

伟大的。

# transpose - CoreMidi - 如何转置midifile的轨道？

> ID：10489893
> 
> 赞同：3
> 
> 时间：2012-05-07T22:16:13.247
> 
> 标签：transpose, coremidi

我正在研究 coremidi 并尝试了一些实验我想知道如何在 midifile 的 miditrack 的半音中进行转置。有人可以告诉我怎么做吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-04-01T20:27:21.140

CoreMIDI 对 MIDI 文件不做任何事情。

您必须解析 MIDI 文件，直到遇到所需的轨道块，并将移调偏移应用于每个 Note On/Off 消息的音符编号（包括运行状态）。

# android - 单击按钮无法移动到新活动

> ID：10489894
> 
> 赞同：0
> 
> 时间：2012-05-07T22:16:21.773
> 
> 标签：android, android-activity

我遇到了一个关于如何在一个活动中显示从用户获取的数据以显示在另一个活动中的教程，我试图提出自己的版本（根据我非常有限的知识）。

这是第一个通过以下方式接受数据的活动的代码

```
package kk.screen;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.EditText;

public class ScreenActivity extends Activity {
/** Called when the activity is first created. */

EditText inputName;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
}

public void btnclick(View view) {

    inputName = (EditText)findViewById(R.id.name);
    Intent nextscreen = new Intent(this, newscreen.class);

    //Sending value to the next activity

    nextscreen.putExtra("name",inputName.getText().toString());
    startActivity(nextscreen);
 }
} 
```

这是下一个 Activity 的代码，它应该在单击 id 为 "btnclick" 的按钮时被激活：

```
package kk.screen;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.widget.TextView;

public class newscreen extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.newscreen);

TextView txtName = (TextView) findViewById(R.id.txtName);

Intent i=getIntent();

//Receiving the data
String name = i.getStringExtra("name");

//Display received data
txtName.setText(name);

 }
} 
```

问题是，单击按钮后，应用程序崩溃了，我又回到了主屏幕。

可能是什么问题呢？？我应该使用 OnClickListener() 吗？（这似乎是我的方法和教程方法之间的主要区别）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:21:00.927

我打赌您会收到 NoClassDefFoundError ，因为您的 AndroidManifest.xml 文件中没有第二个活动，请参阅此问题：

[向 AndroidManifest 添加新活动？](https://stackoverflow.com/questions/3832619/add-a-new-activity-to-the-androidmanifest)

此外，来自 Google 的文档：“所有活动都必须由清单文件中的元素表示”

[http://developer.android.com/guide/topics/manifest/activity-element.html](http://developer.android.com/guide/topics/manifest/activity-element.html)

# http - http 到 https 通过 .htaccess

> ID：10489895
> 
> 赞同：74
> 
> 时间：2012-05-07T22:16:25.510
> 
> 标签：http, .htaccess, redirect, https

我已经浏览了现有的问题，但我还没有真正遇到任何对我有用的东西。

我目前正在运行一个带有安全 SSL 证书的站点。它可以在[https://www.example.co.uk](https://www.example.co.uk)上访问，但问题是该网站也可以在[http://www.example.co.uk](http://www.example.co.uk)上访问- 我不希望这成为可能。我需要它从http重定向到https。

我找到了在 .htaccess 文件中使用的这段代码。

```
Options +FollowSymLinks 
RewriteEngine on 
RewriteCond %{HTTP_HOST} ^example.co.uk [NC] 
RewriteRule ^(.*)$ https://example.co.uk/$1 [L,R=301] 
```

当用户在地址栏中输入 example.co.uk 时，这可以正常工作，但我还需要添加某种条件语句，以便用户输入“www.example.co.uk”或“ [http:// ” www.example.co.uk](http://www.example.co.uk) '。

我尝试过使用 [OR] 之类的东西，但这最终会导致服务器错误。

任何帮助和建议表示赞赏。

干杯。

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2012-05-07T22:22:20.617

尝试以下操作：

```
 RewriteEngine On
 RewriteCond %{HTTPS} !=on
 RewriteRule ^.*$ https://%{SERVER_NAME}%{REQUEST_URI} [R,L] 
```

此外，您还可以根据端口号进行重定向，例如：

```
 RewriteCond %{SERVER_PORT} ^80$
 RewriteRule ^.*$ https://%{SERVER_NAME}%{REQUEST_URI} [R=301,L] 
```

这会将端口 80 上收到的所有请求重定向到 HTTPS。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-10-28T11:20:18.583

在 .htaccess 文件中添加以下代码。

```
RewriteEngine On
RewriteCond %{SERVER_PORT} 80
RewriteRule ^(.*)$ https://www.example.com/$1 [R,L] 
```

*将 example.com 更改为您的网站域*

URL 重定向教程可以从这里找到 - [Redirect non-www to www & HTTP to HTTPS using .htaccess file](http://www.codexworld.com/redirect-non-www-to-www-http-to-https-using-htaccess-file/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-10-22T08:37:41.327

试试这个，我用过，效果很好

```
Options +FollowSymLinks
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-04-02T06:59:11.453

尝试这个：

```
RewriteEngine On

RewriteCond %{HTTPS} off

RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L] 
```

来源： [https ://www.ndchost.com/wiki/apache/redirect-http-to-https](https://www.ndchost.com/wiki/apache/redirect-http-to-https)

（我尝试了这么多不同的代码块，这 3 班轮工作完美无缺）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-09-12T14:20:34.660

我尝试了以上所有代码，但任何代码都不适用于我的网站。然后我尝试这段代码，这段代码非常适合我的网站。您可以在 htaccess 中使用以下规则：

```
<IfModule mod_rewrite.c>
Options +FollowSymLinks
RewriteEngine On

//Redirect http to https
RewriteCond %{SERVER_PORT} 80
RewriteCond %{HTTP_HOST} ^(www\.)?example\.com
RewriteRule ^(.*)$ https://www.example.com/$1 [R,L]

//Redirect non-www to www
RewriteCond %{HTTP_HOST} ^example.com [NC]
RewriteRule ^(.*)$ https://www.example.com/$1 [L,R=301]

</IfModule> 
```

将 example.com 更改为您的域名，并为我糟糕的英语感到抱歉。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-04-06T08:56:16.447

对我来说，只工作这个变种：

```
RewriteCond %{HTTPS} off
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301] 
```

谢谢[https://www.reg.ru/support/hosting-i-servery/sajty-i-domeny/kak-dobavit-redirekt/redirekt-s-http-na-https](https://www.reg.ru/support/hosting-i-servery/sajty-i-domeny/kak-dobavit-redirekt/redirekt-s-http-na-https)（俄语）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-05-30T08:56:55.667

```
# Switch rewrite engine off in case this was installed under HostPay.
RewriteEngine Off

SetEnv DEFAULT_PHP_VERSION 7

DirectoryIndex index.cgi index.php

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress

# RewriteCond %{HTTP_HOST} ^compasscommunity.co.uk\.com$ [NC]
# RewriteRule ^(.*)$ https://www.compasscommunity.co.uk/$1 [L,R=301] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-26T17:05:48.830

**要以**简单的方式重定向`http://example.com` **或** 重定向，您可以在 htaccess 中使用以下规则：`http://www.example.com` **`https://www.example.com`**

 **```
RewriteEngine on

RewriteCond %{HTTPS} off
RewriteCond www.%{HTTP_HOST} ^(?:www\.)?(www\..+)$ [NC]
RewriteRule ^ https://%1%{REQUEST_URI} [NE,L,R] 
```

**[测试]**

**%{REQUEST_SCHEME}**变量自 apache 2.4 起可用，此变量包含请求的方案（http 或 https）的值，​​在 apache 2.4 上，您可以使用以下规则：

```
RewriteEngine on

RewriteCond %{REQUEST_SCHEME} ^http$
RewriteCond %{HTTP_HOST} ^(www\.)?(.+)$ [NC]
RewriteRule ^ https://www.%{HTTP_HOST}%{REQUEST_URI} [NE,L,R] 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-05-06T08:10:19.217

有更好、更安全的方法来确保您的所有流量都通过`https`。例如设置两个虚拟主机并将所有流量从您的主机重定向`http`到您的`https`主机。[**在security.stackexchange.com**](https://security.stackexchange.com/questions/22838/is-a-forced-rewrite-from-http-to-https-secure-what-does-sslrequiressl-add/22852#22852)[上的这个答案](https://security.stackexchange.com/questions/22838/is-a-forced-rewrite-from-http-to-https-secure-what-does-sslrequiressl-add/22852#22852)**中阅读更多信息。**

 **通过设置虚拟主机进行重定向，您可以发送 301 状态（永久重定向），以便浏览器了解以下所有请求都应发送到重定向到的 https 服务器。因此，在第一个重定向响应之后不会再发出 http 请求。

您还应该仔细检查给定的答案，因为如果设置了错误的重写规则，您可能会从传入请求中丢失查询参数。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-10-28T07:11:15.403

完美的代码转到 HTML 索引：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^YourNameWebsite\.com$ [OR]
RewriteCond %{HTTP_HOST} ^www\.YourNameWebsite\.com$
RewriteRule ^/?$ "https\:\/\/YourNameWebsite\.com\/index\.html" [R=301,L] 
```

或者

完美的代码进入 PHP 索引：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^YourNameWebsite\.com$ [OR]
RewriteCond %{HTTP_HOST} ^www\.YourNameWebsite\.com$
RewriteRule ^/?$ "https\:\/\/YourNameWebsite\.com\/index\.php" [R=301,L] 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-08-11T13:43:05.960

由于这是搜索中的顶级结果之一，因此如果您尝试在 AWS beanstalk 上添加 http 到 https 重定向，则接受的解决方案将不起作用。您需要以下代码：

```
RewriteCond %{HTTP:X-Forwarded-Proto} =http
RewriteRule ^.*$ https://%{HTTP:Host}%{REQUEST_URI} [L,R=permanent] 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-10-01T06:20:04.043

如果您想将 HTTP 重定向到 HTTPS 并希望在每个 URL 中添加 www，请使用下面的 htaccess

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L]
RewriteCond %{HTTP_HOST} !^www\.
RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [R=301,L] 
```

它将首先将 HTTP 重定向到 HTTPS，然后将重定向到 www。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-09-08T23:06:19.607

尝试这个 `RewriteCond %{HTTP_HOST} !^www. [NC] RewriteRule ^(.*)$ [http://www.%](http://www.%){HTTP_HOST}/$1 [R=301,L]`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-02-04T14:27:14.353

这些都不适合我，除了这个。我的网站托管在[https://www.asmallorange.com](https://www.asmallorange.com)

```
RewriteEngine On
RewriteCond %{HTTPS} !on
RewriteCond %{SERVER_PORT} !^443$
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L] 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-12-02T15:46:52.380

在 .htaccess 文件中添加以下行以限制 http 访问

SSL要求SSL

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-11-02T17:38:11.973

下面的代码，当添加到`.htaccess`文件中时，将自动将任何发往 http: 的流量重定向到 https：

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L]
</IfModule> 
```

如果您的项目在`Laravel`添加两行

```
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L] 
```

就在下面`RewriteEngine On`。最后，您的`.htaccess`文件将如下所示。

```
<IfModule mod_rewrite.c>
    <IfModule mod_negotiation.c>
        Options -MultiViews -Indexes
    </IfModule>

    RewriteEngine On

    RewriteCond %{HTTPS} off
    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R,L]

    # Handle Authorization Header
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    # Redirect Trailing Slashes If Not A Folder...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} (.+)/$
    RewriteRule ^ %1 [L,R=301]

    # Handle Front Controller...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^ index.php [L]
</IfModule> 
```

[访问这里了解更多信息](https://www.ndchost.com/wiki/apache/redirect-http-to-https)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-02-22T17:55:17.247

出于某种原因，它在我的主机中倒置了，所以如果我想让它重新编辑，我需要检查 https 是否打开，然后重定向到 https

```
RewriteCond %{HTTPS} =on
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [L,R=301] 
```

是我使用的代码****

# api - Hubot Scripts 与 Asana 集成

> ID：10489897
> 
> 赞同：1
> 
> 时间：2012-05-07T22:16:26.843
> 
> 标签：api, node.js, coffeescript, asana, hubot

我正在制作我的第一个 Hubot 脚本，它将为 Asana 添加一个快速任务。
我不想做任何太疯狂的事情，或者至少不认为我是。

目前我有

```
url  = 'https://app.asana.com/api/1.0'

WORKSPACE = "1111111111111"
user = "xxxxxx.xxxxxxxxxxxxxxxx"
pass = ""

module.exports = (robot) ->
  robot.respond /task (.*)/i, (msg) ->
    params = {name: "#{msg.match[1]}", workspace: "#{WORKSPACE}"}
    stringParams = JSON.stringify params
    auth = 'Basic ' + new Buffer("#{user}:#{pass}").toString('base64')
    msg.http("#{url}/tasks")
      .headers("Authorization": auth, "Content-Length": stringParams.length, "Accept": "application/json")
      .query(params)
      .post() (err, res, body) ->
        console.log(err)
        console.log(res)
        console.log(body)
        msg.send body 
```

我真正想做的就是输出它发布到工作区。我知道 Asana API 还有更多功能可以使其正常工作，但是看着我的日志尾部，没有任何输出，没有任何日志记录到控制台，没有任何事情发生。

如果我在参数下执行 console.log，它将输出 JSON 并且它是正确的，但似乎帖子永远不会发生。

任何方向都会很棒！

谢谢。

**编辑**

经过更多调整，跟随 Dan 是朝着正确方向迈出的一步，删除 .query() 并将字符串放入 .post() 输出最终是正确的。

```
module.exports = (robot) ->
  robot.respond /task (.*)/i, (msg) ->
    params = {data:{name: "#{msg.match[1]}", workspace: "#{WORKSPACE}"}}
    stringParams = JSON.stringify params
    auth = 'Basic ' + new Buffer("#{user}:#{pass}").toString('base64')
    msg.http("#{url}/tasks")
      .headers("Authorization": auth, "Content-Length": stringParams.length, "Accept": "application/json")
      .post(stringParams) (err, res, body) ->
        console.log(err)
        console.log(res)
        console.log(body)
        msg.send body 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T16:44:03.233

提交问题的答案，以便 stackoverflow 不会将其显示为未回答。

从 OP 中的 EDIT 复制。

删除 .query() 并将字符串放入 .post() 输出最终是正确的。

```
module.exports = (robot) ->
  robot.respond /task (.*)/i, (msg) ->
    params = {data:{name: "#{msg.match[1]}", workspace: "#{WORKSPACE}"}}
    stringParams = JSON.stringify params
    auth = 'Basic ' + new Buffer("#{user}:#{pass}").toString('base64')
    msg.http("#{url}/tasks")
      .headers("Authorization": auth, "Content-Length": stringParams.length, "Accept": "application/json")
      .post(stringParams) (err, res, body) ->
        console.log(err)
        console.log(res)
        console.log(body)
        msg.send body 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:21:43.927

我认为 Hubot 中的 http 客户端需要一个对象`query()`，而不是字符串。尝试直接传递对象而不是调用`JSON.stringify`.

# javascript - 与台式机相比，移动浏览器的功能有多强大？

> ID：10489901
> 
> 赞同：3
> 
> 时间：2012-05-07T22:16:40.780
> 
> 标签：javascript, android, ios, browser, cryptography

我计划为我正在构建的应用程序实施一些客户端散列（也许还有加密）。在桌面上使用[斯坦福 Javascript 加密库需要](http://crypto.stanford.edu/sjcl/)*一分钟多的时间*来完成我要求浏览器在 Javascript 中执行的一些计算。

我想知道这是否对 Silk、Mobile Safari 等移动浏览器提出了太多要求。除了在大多数现代智能手机上进行测试外，是否有一个通用的指导方针来说明什么对他们来说太过分了？它们与桌面浏览器的强大程度有什么比例？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-07T22:21:46.653

这实际上取决于您的目标市场。我最近购买了 HTC One X 并安装了 Mozilla Firefox 和 Chrome Beta....

**#1 基准测试使用：http:** [//v8.googlecode.com/svn/data/benchmarks/v7/run.html](http://v8.googlecode.com/svn/data/benchmarks/v7/run.html)

**笔记本电脑：戴尔 XPS l502x，配备 i7 2630m，6 GB RAM。浏览器：谷歌浏览器 18**

```
Score: 8574
Richards: 9362
DeltaBlue: 14903
Crypto: 15677
RayTrace: 13468
EarleyBoyer: 24823
RegExp: 2805
Splay: 4600
NavierStokes: 3096 
```

**HTC One X 配备四核 1.5ghz Tegra 3、1 GB RAM。浏览器：谷歌浏览器（移动）18**

```
Score: 1166
Richards: 2595
DeltaBlue: 2147
Crypto: 2227
RayTrace: 1252
EarleyBoyer: 3583
RegExp: 396
Splay: 310
NavierStokes: 502 
```

**结论 1.** 由此得出结论，高端笔记本电脑和高端移动设备之间的一般 JavaScript 性能差异大约是 7 到 8 倍。

**#2 基准测试使用：** [http ://bitwiseshiftleft.github.com/sjcl/browserTest/](http://bitwiseshiftleft.github.com/sjcl/browserTest/)

**笔记本电脑：戴尔 XPS l502x，配备 i7 2630m，6 GB RAM。浏览器：谷歌浏览器 18**

```
Running AES official known-answer tests... passed all 4156 tests. (71 ms)
Running CCM mode tests... passed all 2000 tests. (212 ms)
Running OCB 2.0 mode tests... passed all 22 tests. (16 ms)
Running SHA-256 from catameringue... passed all 513 tests. (53 ms)
Running SHA-256 iterative... passed. (171 ms)
Running HMAC official test vectors... passed all 6 tests. (5 ms)
Running PBKDF2... passed. (38 ms) 
```

**HTC One X 配备四核 1.5ghz Tegra 3、1 GB RAM。浏览器：谷歌浏览器（移动）18**

```
Running AES official known-answer tests...passed all 4156 tests. (219 ms)
Running CCM mode tests...passed all 2000 tests. (832 ms)
Running OCB 2.0 mode tests...passed all 22 tests. (23 ms)
Running SHA-256 from catameringue...passed all 513 tests. (191 ms)
Running SHA-256 iterative...passed. (614 ms)
Running HMAC official test vectors...passed all 6 tests. (13 ms)
Running PBKDF2...passed. (168 ms) 
```

**结论 2.** 得出的结论是，当使用“斯坦福 JavaScript 加密库”时，高端笔记本电脑和高端移动设备之间的性能差异约为 4 到 5 倍。此外，我认为在此移动设备上进行这些测试的时间是可以接受的等待时间。

# iframe - 带有 AJAX 和自动播放/排队的 Youtube iframe API

> ID：10489902
> 
> 赞同：1
> 
> 时间：2012-05-07T22:16:42.437
> 
> 标签：iframe, youtube-api

我正在使用 Youtube iframe API，我正在尝试自动播放和排队、轮询以及开始/停止工作。

我开始只是让自动播放工作。我已经查看了开发人员文档，所以请不要发布另一个链接。

我包括 API：

```
var tag = document.createElement('script');
tag.src = "http://www.youtube.com/player_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag); 
```

但是因为这是一个 AJAX 请求，并且加载页面时保存播放器的 DIV 不在 DOM 中，所以我不调用`function onYouTubePlayerAPIReady()`

相反，当要加载播放器时（总是在加载 DOM 之后很长时间），我调用

```
var videoID = video.split('=').pop();

var player = new YT.Player('video_holder', {
             width:  "480", 
             height: "295", 
             videoId: videoID,
             events: {'onready': onPlayerReady}
             });
function onPlayerReady(event) {
    event.target.playVideo();
} 
```

此代码加载视频，但视频不播放。我在控制台中遇到的唯一错误是`unsafe JavaScript attempt to access`错误，据我所知，这对于 iframe API 很常见。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-02T22:02:11.293

事件名称区分大小写，因此更改`onready`为`onReady`.

# gis - d3.js 投影（albersUsa）映射不正确

> ID：10489904
> 
> 赞同：3
> 
> 时间：2012-05-07T22:16:50.427
> 
> 标签：gis, data-visualization, d3.js

我正在使用以下代码在地图上映射点：

```
var width = 960, height = 500, centered, data;

var svg = d3.select("#chart").append("svg").attr("width", width).attr("height", height);

var projection = d3.geo.albersUsa().scale(width).translate([width / 2, height / 2]);
var path = d3.geo.path().projection(projection);

var states = svg.append("g")
    .append("g")
      .attr("id", "states")
d3.json("usstates.min.geojson", function(json) {
    states.selectAll("path")
          .data(json.features)
        .enter().append("path")
          .attr("d", path);
});

var points = svg.append("g")
      .attr("id", "points");

// Bentonville, Arkansas is at 36.3728, 94.2086
bvCoords = projection([36.3724, 94.2216]);
console.log(bvCoords)

points.append("svg:circle")
    .attr("cx", bvCoords[0]).attr("r", 100).attr("cy", bvCoords[1])
    .style("fill", "#F00"); 
```

当我在 Chrome 中加载它时，控制台`[114.03316181053958, -15.872634684617708]`会报告，它位于加拿大西海岸的某个地方。如果我加入`.attr("transform", "translate(" + width / 2 + "," + height / 2 + ")")`电话`points.append`，它在印第安纳州南部的某个地方。

我在这个投影中做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-07T23:51:59.667

您的坐标是错误的：D3 使用`[longitude, latitude] ↦ [x, y]`.

地理坐标通常以纬度、经度的形式给出（例如，阿肯色州本顿维尔为 36° 22′ 0″ N，94° 12′ 48″ W），这将是`[-94.2216, 36.3724]`： 还要注意负经度，因为它位于 0° 以西。

# django - 按照 DjangoBook 中的描述创建我的第一个应用程序

> ID：10489905
> 
> 赞同：2
> 
> 时间：2012-05-07T22:17:02.627
> 
> 标签：django

我正在阅读 DjangoBook 2.0 版，我刚刚创建了我的第一个应用程序并将其添加到 settings.py 中的 INSTALLED_APPS 设置属性

我使用以下方法创建了这个应用程序：

> python manage.py startapp 书籍

因此，它的名字是“书”。

**[编辑：修复模型代码]**

我添加了书中写的模型，

```
class Publisher(models.Model):
    name = models.CharField(max_length=30)
    address = models.CharField(max_length=50)
    city = models.CharField(max_length=60)
    state_province = models.CharField(max_length=30)
    country = models.CharField(max_length=50)
    website = models.URLField()

class Author(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=40)
    email = models.EmailField()

class Book(models.Model):
    title = models.CharField(max_length=100)
    authors = models.ManyToManyField(Author)
    publisher = models.ForeignKey(Publisher)
    publication_date = models.DateField() 
```

验证添加的应用程序后，使用

> python manage.py 验证

我收到以下输出：

> 错误：没有名为书籍的模块

***我添加到 INSTALLED_APPS 的数据是“mysite.books”，因为我的项目名称是 mysite。

我的行为有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T11:55:54.563

[http://thedjangoforum.com/board/thread/1180/python-managepy-validate-error-no-mod/](http://thedjangoforum.com/board/thread/1180/python-managepy-validate-error-no-mod/)

这是答案。它解决了我的问题。

“你应该把'mysite.books'改成'books'，然后你的问题就会结束”

试试看！

# iphone - 在 iPhone 中以编程方式放大和缩小：如何设置动画速度？

> ID：10489906
> 
> 赞同：6
> 
> 时间：2012-05-07T22:17:04.847
> 
> 标签：iphone, uiscrollview

我有一个应用程序，我想动态放大和缩小 imageView。

我`[scrollView zoomToRect:CGRectMake(x,y,z,k) animated:YES];`习惯放大，但我希望动画慢一点……有没有办法设置动画速度？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-10T13:58:20.857

看我的另一个[答案](https://stackoverflow.com/a/4587055/207616)。您可以将动画持续时间设置为`1.0`秒。

代替：
`cursorView.center = locationOfTouch;`

你必须设置：

```
[UIView beginAnimations:nil context:NULL]
[UIView setAnimationDuration:1.0];
[UIView setAnimationBeginsFromCurrentState:YES];
[UIView setAnimationCurve:UIViewAnimationCurveLinear];

[scrollView zoomToRect:CGRectMake(x,y,z,k) animated:NO]; // NO is necessary!

[UIView commitAnimations]; 
```

# php - 模块互相编辑

> ID：10489911
> 
> 赞同：2
> 
> 时间：2012-05-07T22:17:40.400
> 
> 标签：php, module

我开始研究如何制作模块化项目，现在我得到了你可以（例如）制作一个文件夹并将模块文件放在那里的部分，这带来了以下问题：

当您为核心和模块进行扩展时，该怎么做？

**例子：**

假设我有一个模块“部门”和一个模块“用户”，其中模块“部门”强制模块“用户”为每个用户指定一个部门，并编辑新用户创建表单（显然，还指定一个部门）

关于如何使用这个的任何想法，或者关于这个的任何好的教程？

希望这可以清除我想要弄清楚的东西，我的英语不太好..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:24:18.277

有一个非常简单的方法可以做到这一点......

“用户”模块需要为其流程的每个步骤提供打开的钩子。例如，当它输出表单时，它需要允许另一个模块连接到该表单并更改它。

这样，departments 模块可以挂接到表单，添加新字段，还可以挂接到接收器并添加对新字段的处理。

当然，如何完成挂钩取决于您的架构，但您只需要允许模块创建新挂钩的方法，并且如果您愿意，可以指定它的依赖项。如果一个模块可以指定依赖项（部门依赖于用户），那么您需要在包含它们之前对它们进行排序，以便满足所有依赖项。

# java - JDialog之后需要点击两次JButton

> ID：10489918
> 
> 赞同：2
> 
> 时间：2012-05-07T22:18:57.700
> 
> 标签：java, swing, modal-dialog, jdialog

在基于 Swing 创建我的应用程序时，我一直在努力解决一些问题。我有一个主要的 JFrame，其中包括：

1.  菜单
2.  JPanel 包含一个 JButton 和一个 JLabel

JButton 与 ActionListener 链接。单击 JMenu (MenuListener) 会弹出一个带有某种形式的 JDialog。问题是，当 JDialog 关闭时（无论我使用 dispose() 还是 showVisible(false) 都没有区别），我需要在第一次触发之前单击 JButton 两次。从现在开始，它通常只需单击一下即可。

每次JDialog在前面，问题就出现了。

PS。JDialog 设置为模态的，以 JFrame 作为父级。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T22:56:59.733

这听起来像是一个焦点问题。

第一次单击将焦点恢复到应用程序，第二次单击按钮。通常，当 JDialog 的父级错误并且无法返回焦点时，我会看到这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T16:08:06.263

谢谢您的回答。

我考虑过发布一些代码，但它涉及 4 个类，所以会很长。

我之前也尝试过专注的事情，但没有任何帮助。有趣的是：如果我通过它显示 JDialog，`new myDialog.showVisible(true)`它的行为就像我所描述的那样。但是，如果我使用这样的构造：

```
 SwingUtilities.invokeLater(new Runnable() {

        public void run() {
            new JDialog.setVisible(true);
        }
    }); 
```

它正常关闭，并且在响应之前不需要单击父框架，但另一方面，显示的 Dialog 需要这样做。另外，我不明白的是，打开对话框后，光标放在文本字段中，我可以正常书写，但是要单击它上面的某个按钮，我必须在对话框上单击一次，只有第二次和下一次单击的行为就像我想要的那样.

PS。在第二个包含的示例中关闭对话框不会改变任何内容。

# jquery - 有没有办法用 jQuery 滚动 iFrame 跨域？

> ID：10489929
> 
> 赞同：-1
> 
> 时间：2012-05-07T22:20:35.513
> 
> 标签：jquery, html, iframe, scroll

我似乎找不到我想要的东西。谷歌一直在说“位置”（如 CSS`top`和`left`），但我想要的是单击 a`button`并滚动一个框架。

重点？这样我就不必在框架上使用滚动条——根据您使用的系统，它们可能很难看。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T22:28:14.823

如果您在**您的域中**`iframe`导航，那么此代码可能会有所帮助：

 **```
$("button").on("click", function() {
    $("iframe").contents().scrollTop(100);
});​ 
```

否则，您将收到类似“*不安全的 JavaScript 尝试访问框架...域、协议和端口必须匹配*”的错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:33:53.490

我假设您想从外部滚动 iFrame。我不知道它是否有效，但如何尝试将 iFrame 的哈希设置为使用默认滚动机制

```
$("iframe").attr("src", "http://www.example.com/#hash 
```

其中“哈希”可以是锚的名称或 id（最后一个仅适用于支持的浏览器）

编辑1：您可以简单地设置相同的域 .scrollTop()

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-02T08:47:19.000

带有 Hash 的默认滚动机制适用于大多数浏览器，因此它是来自外部域的 iframe 的最佳解决方案。**

# web-crawler - 爬虫的数据结构

> ID：10489937
> 
> 赞同：1
> 
> 时间：2012-05-07T22:21:34.813
> 
> 标签：web-crawler, web-scraping

大家好！我要编写网站爬虫，它从根地址开始，然后爬取每个找到的链接（仅限内部链接）。所以我面临这个问题：爬虫必须从根开始，然后它应该解析网页（根页面）然后获取所有链接。在获取链接时，它不应两次抓取同一页面。伙计们有什么好的数据结构还是我需要使用 SQL 或其他索引数据结构？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T22:45:02.290

您可能正在寻找的数据结构是[Tree](http://en.wikipedia.org/wiki/Tree_data_structure)。

但是对于爬虫来说，不需要它，因为从根目录开始，您可以维护一个访问过的 URL 的“列表”，并且每次您要跟踪一个链接时，检查之前是否遇到过它。如果还没有遇到，则将其添加到列表中并遵循它。

不过，它不一定是一个列表（即数组），它可以是一个[字典](http://en.wikipedia.org/wiki/Associative_array)或其他有助于加快搜索速度的数据结构。

[它也可以是 SQL 数据库或类似redis](http://en.wikipedia.org/wiki/Redis)之类的键值存储。如果您使用类似的东西，那么所有索引和查询都将由数据库系统为您提供，您可以通过标准方法（SQL、特殊 API 等）与之通信。

然而，这很容易，在“爬行”中还有一些更重要的事情需要考虑，也许最好先检查一下你正在尝试做的事情是否可以使用[已经可用的 crawler](http://en.wikipedia.org/wiki/Web_crawler#Examples)来完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T20:54:24.633

我建议在这里查看我的答案：[设计网络爬虫](https://stackoverflow.com/questions/5834808/designing-a-web-crawler/5834890#5834890)以及[如何在我的应用程序（网络或控制台）中带来类似谷歌的重新抓取](https://stackoverflow.com/questions/9029822/how-can-i-bring-google-like-recrawling-in-my-applicationweb-or-console/9099798#9099798)

我已经回答了你问的很多问题。要放弃的关键是爬虫使用 URL-Seen 测试来有效地确定他们是否应该爬取链接。URL-Seen 测试通常使用快速解析键（url）的映射结构来实现。常用的解决方案有leveldb、berkeleydb等嵌入式数据库等NOSQL解决方案。

# salesforce - Salesforce：使用 SOQL 来加强安全性和限制记录访问是个好主意吗？

> ID：10489939
> 
> 赞同：1
> 
> 时间：2012-05-07T22:21:41.870
> 
> 标签：salesforce, apex-code, visualforce

这更像是一个最佳实践问题。我们的组织目前对自定义对象的组织范围默认设置具有“公共读取”权限。我们不能将其保密，因为它现在为内部员工工作的方式，或者更确切地说，我们正试图避免这种情况。

我还在创建一个带有自定义视觉强制页面的客户门户……我在其中使用 SOQL 查询显示数据。

在 SOQL 查询中添加一个子句以仅返回帐户 ID 与登录用户的帐户 ID 匹配的那些记录是个好主意吗？

我做到了，而且效果很好……但是这种方法有什么我忽略的陷阱吗？

谢谢，卡尔文

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-07T22:30:57.157

根据[Visualforce 文档](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_pages.htm?SearchType=Stem&Highlight=%7C%7Cshared%7Csharing%7CSharing%7Cshare%7CShared%7CShare%7Cshares%7CShares)

> 由于标准控制器在用户模式下执行，其中强制执行当前用户的权限、字段级安全性和共享规则，因此扩展标准控制器允许您构建尊重用户权限的 Visualforce 页面。虽然扩展类在系统模式下执行，但标准控制器在用户模式下执行。与自定义控制器一样，您可以指定用户是否可以根据用户的配置文件执行控制器扩展中的方法。

我相信这个想法是，只要你的类是`public with sharing`那么权限就应该被强制执行，并且不应该返回用户看不到的记录（与记录上的字段相同）。

根据[Apex 文档](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_classes_keywords_sharing.htm?SearchType=Stem&Highlight=public%7CPublic%7Cpublication%7C%7C%7C%7Cshared%7Csharing%7CSharing%7Cshare%7CShared%7CShare%7Cshares%7CShares)

> Apex 通常在系统上下文中运行；也就是说，当前用户的权限、字段级别的安全性和共享规则在代码执行过程中不会被考虑在内。

**`with sharing`**在声明类时使用关键字来强制执行适用于当前用户的共享规则。例如：

```
public with sharing class sharingClass {

// Code here 

} 
```

声明类时使用**`without sharing`**关键字以确保不强制执行当前用户的共享规则。例如：

```
public without sharing class noSharing {

// Code here 

} 
```

否则，您将不得不花费数小时确保在正确的时间为正确的用户应用正确的权限。它几乎完全违背了visualforce页面的目的！

# actionscript-3 - 在 Win 上使用 Flex/AIR 创建隐藏文件

> ID：10489952
> 
> 赞同：3
> 
> 时间：2012-05-07T22:22:36.793
> 
> 标签：actionscript-3, native-code, hidden-files

如何在我的 Win 文件系统上创建隐藏文件？我读过你应该使用本机代码，我知道 AS3 有 NaviteProcess 类，但我真的不知道如何使用它，我也找不到太多关于它的信息。

有没有人知道怎么做？

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T01:33:11.190

清理以更好地反映我们的位置并将保持更新：

基于以下信息： [http ://deepanjandas.wordpress.com/2010/09/10/writing-executing-cmd-scripts-through-air/](http://deepanjandas.wordpress.com/2010/09/10/writing-executing-cmd-scripts-through-air/)

```
private var applicationDirectory:File;

private function createCMDFile():void
{
    applicationDirectory = File.desktopDirectory;
    var cmdFile:File = applicationDirectory.resolvePath( 'hide.cmd' );
    var stream:FileStream = new FileStream()
    stream.open( cmdFile, FileMode.WRITE );

    var dataString:String = "ATTRIB +H \\ C:\\Users\\***yourUserName***\\***fileToHide.txt***"; //or any path you want just be sure to use \\ instead of \ and obviously change ***yourUserName*** and ***fileToHide.txt***

            stream.writeMultiByte( dataString, "ANSI" );
    stream.close();

    stream = null;

    var nativeProcessStartupInfo:NativeProcessStartupInfo = new NativeProcessStartupInfo();
    nativeProcessStartupInfo.executable = cmdFile;

    var process:NativeProcess = new NativeProcess();
    process.start(nativeProcessStartupInfo);
    process.addEventListener( NativeProcessExitEvent.EXIT, onExitHandler );
}

private function onExitHandler( event:NativeProcessExitEvent ):void
{
    var cmdFile:File = applicationDirectory.resolvePath( 'hide.cmd' );
    cmdFile.deleteFile();
} 
```

# django - 带有非常量字符串的 Django @login_required 装饰器抛出异常

> ID：10489953
> 
> 赞同：0
> 
> 时间：2012-05-07T22:22:37.887
> 
> 标签：django, django-views, django-urls

我用`@login_required(login_url=login_url)`

当我在文件顶部`views.py`设置`login_url=reverse("member_login")`它时，会引发异常：

```
Tried tag_index in module dgn.views. Error was: 'module' object has no attribute 'tag_index' 
```

`tag_index`是 URL 调度程序列表中的最后一项。如果我将其注释掉，那么它只会抛出提到它之前的异常。

奇怪的是，当我设置 时`login_url="constant/string/to/path"`，它工作得很好。显然，`login_url=reverse('member_login')`是在搞砸。我在views.py 文件的函数内部的许多其他地方使用reverse，并确保在URL 调度列表中命名每个条目。

任何有关可能是什么问题的帮助将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:51:35.617

此时尚未加载 URLConf。使用[reverse_lazy](https://docs.djangoproject.com/en/dev/topics/http/urls/#reverse-lazy)，如果你有 django 1.4

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T22:51:23.530

您是否从 urls.py 文件中的 views.py 导入任何内容？如果是这样，您可能会遇到循环导入问题，并且您可能需要重新调整 urls.py 使其不需要导入。

# .net - 使用动态控件编写自动化测试用例

> ID：10489954
> 
> 赞同：2
> 
> 时间：2012-05-07T22:22:40.080
> 
> 标签：.net, testing, automation

我目前正在分析一个内部工具，它可以帮助我们为静态和非静态控件编写自动化测试用例。根据我的团队观察，我听说动态控制的自动化似乎非常耗时。它的asp.net 网页。目前，我正在使用自定义工具，使用 .net 和 win32 调用与 IE 进行大多数任务的互操作。

你们中的任何一个都有动态控制的自动化测试用例吗？

# c - 在字符串 c 中获取字符串

> ID：10489956
> 
> 赞同：-4
> 
> 时间：2012-05-07T22:22:49.217
> 
> 标签：c, string, recursion

我想得到一个包含在一个字符串中的字符串，每次我看到`(xxx)` 我只会得到`xxx`.

例如，我正在尝试使用函数以递归方式进行操作`int find(char* str)`。

`1`如果没有`'('`或`')'`离开（全部删除），则该函数将返回，`0`否则。

字符串可以保持原样，只需要检查规定的条件。

确定输入： `(xxx)(zzz(yyy)zzz)`

错误的输入：`xx(x(zzz)(y`

如何在 C 中做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-07T22:46:20.740

一个简单的堆栈是解决这个问题的好方法。每次看到 '(' 压入堆栈。每次看到 ')' 从堆栈中弹出。如果您曾经尝试弹出一个空堆栈或在完成后将一些东西留在堆栈上，那么输入是错误的。

编辑：你也可以用计数器做同样的事情。分别递增和递减。如果计数器变为负数，则返回 false。否则，当您完成时，如果您为 0，则返回 true，否则返回 false。所以计数器只代表“堆栈”的大小。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-07T22:52:22.693

我认为这可能是答案，继续之前来自abelenky的：

```
int find(char *str)
{
  int pars = 0, pos = 0;
  while(str[pos] != 0) {
    if (str[pos] == '(') pars++;
    if (str[pos] == ')') pars--;
    if (pars < 0) return 0;        // closes before opens -> end here
    pos++;
  }
  if (pars != 0) return 0;         // not matched result
  else return 1;                   // matched result
} 
```

# arrays - 无法使用 for 循环获取数组值

> ID：10489958
> 
> 赞同：0
> 
> 时间：2012-05-07T22:22:59.990
> 
> 标签：arrays, loops, undefined

我将值添加到数组中，如下所示：

```
ansArray = {question:id[count], answer: 'a'}; 
```

控制台显示如下结果：

```
(
    {
        answer = a;
        question=1;
    },
    {
        answer =d;
        question=2;
    }
    //......

    //.......
) 
```

我使用了这样的 for 循环：

```
for (i=0;i<20;i++){
    alert(ansArray[i].answer); //This comes with undefined error
    alert(ansArray[i].question); //undefined
} 
```

这会出现未定义的错误；

但如果我不使用“i”变量而是使用数字，则信息显示正确的值：

```
 alert(ansArray[0].answer); //shows correct value
 alert(ansArray[1].question); //shows correct value 
```

为什么 for 循环不显示错误？我在这里想念什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:28:55.527

你的第一个问题是你的 ansArray 变量不是一个数组，而是一个对象。您将其声明如下：

```
ansArray = {question:id[count], answer: 'a'}; 
```

这是创建一个带有问题字段和答案字段的对象。您可以像这样声明对象：

```
someObject = {}; 
```

你可以像这样声明数组：

```
someArray = []; 
```

所以，你可能意味着有这样的事情：

```
ansArray = [{question:0, answer:'a'}]; 
```

这将为您提供一个包含单个对象的数组。我猜你想要这样的东西：

```
var ansArray = [];
ansArray[0] = {question:0, answer:'a'};
ansArray[1] = {question:1, answer:'d'};
...
ansArray[19] = {question:19, answer:'b'}; 
```

您将能够使用您的原始循环代码循环它。使用 javascript 标签也很有帮助。

# mysql - 如何选择以查找具有唯一值的日期/时间重叠？

> ID：10489959
> 
> 赞同：1
> 
> 时间：2012-05-07T22:23:01.287
> 
> 标签：mysql

好奇人们将如何有效地解决以下问题。

有一个简单的表格来跟踪报告的一组“批准者”。还跟踪报告的“创建”时间和“提交”时间。创建和提交报告之间的时间跨度应该是批准人 ID 提交给单个报告的时间，但是如果他们的批准人 ID 出现在另一个报告的同一时间跨度内，我想标记它。

示例（一个表格，“报告”）：

```
"Created"                 "Submitted"                "ApproverID"
4/20/2012 5:01:32 AM          4/20/2012 5:30:32 AM          10
4/20/2012 5:08:32 AM          4/20/2012 5:45:32 AM          10
4/20/2012 5:01:32 AM          4/19/2012 5:38:16 PM          15 
```

在这个例子中，我想选择并返回重叠的行，它们是：

```
 "Created"                 "Submitted"                "ApproverID"     "Duplicate_ID"
4/20/2012 5:01:32 AM          4/20/2012 5:30:32 AM          10            1
4/20/2012 5:08:32 AM          4/20/2012 5:45:32 AM          10            1 
```

...并可能附加一个具有唯一值的新列“Duplicate”以报告特定的重叠命中，我可以在上面执行 SELECT DISTINCT Duplicate_ID。

我玩过 BETWEEN 但无济于事。任何帮助表示赞赏！

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T22:33:45.630

未经测试：

```
SELECT R1.Created, R1.Submitted, R1.ApproverID, count(*) 
FROM reports R1
INNER JOIN reports R2
  on R1.Created between R2.Created and R2.Submitted --ON
  OR R2.created between R2.Created and R2.submitted --OR
GROUP BY R1.Created, R1.Submitted, R1.ApproverID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:40:37.003

无论如何，这都会为您提供冲突报告的列表：

```
SELECT r1.approvalID, r2.approvalID
FROM reports r1
JOIN reports r2
  ON r2.approverID = r1.approverID
  AND r2.created < r1.created
  AND r2.submitted >= r1.created
  AND r2.submitted < r1.submitted 
```

这假设您有一个名为approvalID 的主键。

# python - 如何在 PythonMagick 中处理多页图像？

> ID：10489960
> 
> 赞同：6
> 
> 时间：2012-05-07T22:23:14.017
> 
> 标签：python, pythonmagick

我想将一些多页 .tif 或 .pdf 文件转换为单独的 .png 图像。从命令行（使用 ImageMagick）我只是这样做：

```
convert multi_page.pdf file_out.png 
```

我将所有页面作为单独的图像（file_out-0.png，file_out-1.png，...）

我想在 Python 中处理这个文件转换，不幸的是 PIL 无法读取 .pdf 文件，所以我想使用 PythonMagick。我试过：

```
import PythonMagick
im = PythonMagick.Image('multi_page.pdf')
im.write("file_out%d.png") 
```

要不就

```
im.write("file_out.png") 
```

但我只有 1 页转换为 png。当然，我可以单独加载每个页面并一一转换。但是必须有一种方法可以一次完成所有这些操作吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-02T22:46:52.753

ImageMagick 的内存效率不高，因此如果您尝试阅读较大的 pdf，例如 100 页左右，内存需求将会很大，并且可能会崩溃或严重降低系统速度。因此，毕竟使用 PythonMagick 一次阅读所有页面是一个坏主意，它不安全。因此，对于 pdf，我最终逐页进行，但为此我需要首先使用 pyPdf 获取页数，它相当快：

```
pdf_im = pyPdf.PdfFileReader(file('multi_page.pdf', "rb"))
npage = pdf_im.getNumPages()
for p in npage:
    im = PythonMagick.Image('multi_page.pdf['+ str(p) +']')
    im.write('file_out-' + str(p)+ '.png') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-30T11:20:57.353

基于 Ivo Flipse 和[http://ps.co.nz/wordpress/pdf-to-png-using-pythonmagick/答案的更完整示例](http://p-s.co.nz/wordpress/pdf-to-png-using-pythonmagick/)

这使用更高的分辨率并使用 PyPDF2 而不是旧的 pyPDF。

```
import sys
import PyPDF2
import PythonMagick

pdffilename = sys.argv[1] 
pdf_im = PyPDF2.PdfFileReader(file(pdffilename, "rb"))
npage = pdf_im.getNumPages()
print('Converting %d pages.' % npage)
for p in range(npage):
    im = PythonMagick.Image()
    im.density('300')
    im.read(pdffilename + '[' + str(p) +']')
    im.write('file_out-' + str(p)+ '.png') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T05:49:32.203

我遇到了同样的问题，作为解决方法，我使用了 ImageMagick 并做了

```
import subprocess
params = ['convert', 'src.pdf', 'out.png']
subprocess.check_call(params) 
```

# arrays - Excel“小计”数组公式 - sum.if 的其他形式

> ID：10489966
> 
> 赞同：1
> 
> 时间：2012-05-07T22:24:01.770
> 
> 标签：arrays, excel, function, sum

这是[excel different SUM.IF array function](https://stackoverflow.com/questions/10483048/excel-different-sum-if-array-function)问题的延续，但是由于我已将其标记为已解决，因此我创建了一个新问题。

我想要的是一些值的不同总和，并且我已经实现了@Marc 的解决方案。然而，报告要求已经改变。我现在需要排除所有隐藏的值，但仍保留原始计算方法。基本上我想以与 SUBTOTAL(109, ref) 相同的方式添加一个功能。

为此，我创建了一个简单的 VBA 函数 CellIsNotHidden(Range)，它根据单元格返回 0 或 1。

因此，我最好的猜测是这样的公式：`{=SUM(IF($B1:$B7<>$B2:$B8,D2:D8,0)*CellIsNotHidden(D2:D8))}`

但是这个函数不起作用，因为 CellIsNotHidden 不是数组函数。

我该如何解决这个问题？

提前谢谢

贡纳尔

编辑：

以为我应该包括简单的 VBA 函数：

```
 Function CellIsNotHidden(InputRange As Range)

  If InputRange.Cells.Height = 0 Then
      CellIsNotHidden = 0
  Else
      If InputRange.Cells.Width = 0 Then
          CellIsNotHidden = 0
      Else
          CellIsNotHidden = 1
      End If
  End If

  End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T00:03:33.807

试试这个 UDF `CellIsNotHidden`。这将处理一维（向量）和二维数组。测试：

```
Function CellIsNotHidden(MyRange As Range) As Variant
  Dim RootCell As Range
  Dim tmpResult() As Long
  Dim i As Long
  Dim j As Long

On Error GoTo Whoops
  ReDim tmpResult(0 To MyRange.Rows.Count - 1, 0 To MyRange.Columns.Count - 1)
  Set RootCell = MyRange.Cells(1, 1)
  For j = 0 To MyRange.Columns.Count - 1
    For i = 0 To MyRange.Rows.Count - 1
      tmpResult(i, j) = Not (RootCell.Offset(i, j).EntireColumn.hidden Or RootCell.Offset(i, j).EntireRow.hidden)
    Next i
  Next j
  CellIsNotHidden = tmpResult
On Error GoTo 0
  Exit Function
Whoops:
  Debug.Print Err & " " & Error
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T08:30:57.400

除了使用 UDF `CellIsNotHidden(D2:D8)`，您还可以尝试以下任一方法：

```
SUBTOTAL(109,OFFSET(D2,ROW(D2:D8)-ROW(D2),))
SUBTOTAL(109,OFFSET(D2:D8,ROW(D2:D8)-MIN(ROW(D2:D8)),,1)) 
```

# ruby-on-rails - Rails 'Best in Place' Gem - Flash 成功消息？

> ID：10489976
> 
> 赞同：4
> 
> 时间：2012-05-07T22:25:17.863
> 
> 标签：ruby-on-rails, best-in-place

我正在使用 best_in_place gem (https://github.com/bernat/best_in_place) 在 Rails 应用程序中进行就地编辑。我的控制器有一行：

```
format.json { respond_with_bip(@user) } 
```

gem 会为任何验证错误生成 purr 通知，但是我有什么办法也可以闪烁通知以成功更新？我似乎在文档中的任何地方都找不到这个，而且 bip 使用 JSON 响应的事实使整个事情对我来说似乎是一个黑盒子。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T09:35:38.913

```
$('.best_in_place').best_in_place().bind('ajax:success', function(evt, data, status, xhr) {
       console.dir(evt);
       console.dir(data);
       console.dir(status);
       console.dir(xhr);
     // Use them how ever you need eg $("#yourdiv").text(data["message"]);
}); 
```

在您的控制器中

```
format.json { render :json => { :message => "Successfully Saved your Model" } } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T00:16:01.670

这取决于您在控制器中所做的事情，但是您不能有一个在更新时触发的事件以显示通知 - 例如在 ajax:success 上。

重新阅读您的问题后，我认为这实际上对您没有帮助。但请查看[Flash Render Gem](http://rubygems.org/gems/flash_render)以防万一。 [这是有关如何实现](http://rubydoc.info/gems/flash_render/1.0.1/frames)gem 的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-19T13:09:49.650

我遇到了类似的问题。我所做的是制作自己的文件并从我的 application.js 文件`bip.purr.js`中删除了要求：`best_in_place.purr`

```
//application.js
//= require jquery
//= require best_in_place
//= require jquery_ujs
//= require best_in_place.jquery-ui
//= require jquery.purr
//REMOVED / COMMENTED OUT THE NEXT LINE:
// require best_in_place.purr
// ADDED THIS LINE:
//= require bip.purr
//= require turbolinks
//= require bootstrap-sprockets
//= require_tree . 
```

我的“错误”功能 OOB 不起作用，所以我也更改了它。如果它适合您，您应该查看[原始来源](https://github.com/bernat/best_in_place/blob/master/lib/assets/javascripts/best_in_place.purr.js)。在制作自己的文件之前，无论如何你都应该这样做，但这就是我的样子（assets/javascripts/bp.purr.js）：

```
/*
 * BestInPlace 3.0.0.alpha (2014)
 *
 * Depends:
 *  best_in_place.js
 *  jquery.purr.js
 */
/*global BestInPlaceEditor */

BestInPlaceEditor.defaults.purrErrorContainer = "<span class='bip-flash-error'></span>";
BestInPlaceEditor.defaults.purrSuccessContainer = "<span class='bip-flash-success'></span>";

//edited this binding to stop showing 'Error Object object'
jQuery(document).on('best_in_place:error', function (event, request, error) {
    'use strict';
    // Display all error messages from server side validation
    var errors_string = "";
    jQuery.each(jQuery.parseJSON(request.responseText), function (index, value) {
        if (typeof value === "object") {
            $.each(value, function (i, v) {
                errors_string += i[0].toUpperCase() + i.slice(1) + " " + v + ". ";
            });
        } else {
            errors_string = value;
        }
        var container = jQuery(BestInPlaceEditor.defaults.purrErrorContainer).html(errors_string);
        container.purr();
    });
});

//added this binding for success messages:
jQuery(document).on('best_in_place:success', function (event, request, error) {
    'use strict';
    // Display all success messages from server side validation
    var msg = "Updated Successfully";
    var container = jQuery(BestInPlaceEditor.defaults.purrSuccessContainer).html(msg);
    container.purr();
}); 
```

而且，只是为了好玩，一些基本的 SCSS 可以让事情看起来不同：

```
// for best in place / purr styling
.purr {
  position: fixed;
  top: 60px;
  right: 100px;
  width: 500px;
  padding: 20px;
  &.bip-flash-error {
    background-color: red;
  }
  &.bip-flash-success {
    background-color: green;
  }
  border: solid 1px #dadada;
  border-radius: 6px;
  -moz-border-radius: 6px;
  -webkit-border-radius: 6px;
  -webkit-box-shadow: 4px 4px 15px 0px rgba(0, 0, 0, 0.75);
  -moz-box-shadow: 4px 4px 15px 0px rgba(0, 0, 0, 0.75);
  box-shadow: 4px 4px 15px 0px rgba(0, 0, 0, 0.75);
  &:first-letter {
    text-transform: uppercase
  }
;
  font-size: 20px;
  color: white;
  font-weight: bolder;
  text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T23:43:10.120

由于您使用 JSON 进行响应，因此没有 Flash 消息。Flash 位于 HTML 页面上（您可以对其进行 user `flash[:message] = "Success! Hooray!"`），但在 JSON 请求中没有显示的地方。

# c# - 验证（XHTML 1.0 过渡）：元素“html”不能嵌套在元素“div”中

> ID：10489977
> 
> 赞同：1
> 
> 时间：2012-05-07T22:25:18.020
> 
> 标签：c#, asp.net

我需要帮助如何修复我的代码中的错误。当我编译代码时告诉我错误验证（XHTML 1.0 过渡）：元素“html”不能嵌套在元素“div”中。如果有人知道，请帮助我？

```
 <%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="ManageUsers.aspx.cs" Inherits="probazaadmin.ManageUsers" %>
    <asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
    </asp:Content>
    <asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head id="Head1" runat="server">
    <title>Untitled Page</title>
    </head>
    <body>
    <form id="form2" runat="server"></form>
    <div>Users Account Management</div>
    <p></p>
    <b>- The total registered users is: <asp:Literal runat="server" ID="lblTotalUsers" /><br />
    - The total online users at this moment: <asp:Literal runat="server" ID="lblOnlineUsers" /></b>
    <p></p>
    In order to display all users whose name begins with letter click on the link letter:
    <p></p>

    <asp:Repeater runat="server" ID="rptAlphabetBar"
    OnItemCommand="rptAlphabetBar_ItemCommand">
    <ItemTemplate><asp:LinkButton ID="LinkButton1" runat="server" Text='<%# Container.DataItem %>'
    CommandArgument='<%# Container.DataItem %>' />&nbsp;&nbsp;
    </ItemTemplate>
    </asp:Repeater>
    <p></p>
    Use the below feature to search users by partial username or e-mail:
    <p></p>

    <asp:DropDownList runat="server" ID="ddlUserSearchTypes">
    <asp:ListItem Text="UserName" Selected="true" />
    <asp:ListItem Text="E-mail" />
    </asp:DropDownList>
    contains
    <asp:TextBox runat="server" ID="txtSearchText" />
    <asp:Button runat="server" ID="btnSearch" Text="Search"
    OnClick="btnSearch_Click" />
    </body></html>
    </asp:Content> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T23:38:16.893

您的代码显示您是：

```
 <%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master".... 
```

1.  使用母版页（HTML 声明所在的位置）

    ```
    <asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server"> 
    ```

2.  使用内容~~页面~~占位符来添加整个 HTML 文档——你**不应该这样**做。

    *   如前所述，母版页是 HTML 声明所在
    *   ASP.net 内容部分仅用于内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-10T12:00:26.193

你的代码应该是这样 <%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="ManageUsers.aspx.cs" Inherits="probazaadmin.ManageUsers" % > 用户账户管理

**- 注册用户总数为：
- 目前在线用户总数：**

要显示名称以字母开头的所有用户，请单击链接字母：

```
<asp:Repeater runat="server" ID="rptAlphabetBar"
OnItemCommand="rptAlphabetBar_ItemCommand">
<ItemTemplate><asp:LinkButton ID="LinkButton1" runat="server" Text='<%# Container.DataItem %>'
CommandArgument='<%# Container.DataItem %>' />&nbsp;&nbsp;
</ItemTemplate>
</asp:Repeater>
<p></p>
Use the below feature to search users by partial username or e-mail:
<p></p>

<asp:DropDownList runat="server" ID="ddlUserSearchTypes">
<asp:ListItem Text="UserName" Selected="true" />
<asp:ListItem Text="E-mail" />
</asp:DropDownList>
contains
<asp:TextBox runat="server" ID="txtSearchText" />
<asp:Button runat="server" ID="btnSearch" Text="Search"
OnClick="btnSearch_Click" />
</asp:Content> 
```

# c - 在 C 中将函数作为参数传递

> ID：10489978
> 
> 赞同：1
> 
> 时间：2012-05-07T22:25:27.467
> 
> 标签：c

我正在浏览我的一本教科书，我看到以下 C 函数的代码行：

```
node_t* func(node_t* n, int f(node_t *)) 
```

这到底是什么意思？里面有一个函数作为参数。那有什么意义呢？只要声明了文件，您不应该只能调用文件中的任何函数吗？另外，就汇编而言，它是被引用的 int f() 的内存位置吗？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T22:28:06.997

```
node_t* func(node_t* n, int f(node_t *)) 
```

是一个函数，称为 func，它接受两个参数：n，指向 node_t 的指针，和 f，指向接受 node_t 指针并返回 int 的函数的指针。函数 func 返回指向 node_t 的指针。

无论如何，想到的最常见的用途是通用算法。

“只要文件被声明，你不应该可以调用文件中的任何函数吗？”

只要函数已经在编译单元中声明，并且链接器可以在链接时找到它，那就是真的。但是，当您希望能够在运行时决定使用哪个函数（或者如果您只想要一个通用函数，则在编译时）时使用函数指针。

作为一个具体的例子，考虑[qsort](http://www.cplusplus.com/reference/clibrary/cstdlib/qsort/)：

```
void qsort ( void * base, size_t num, size_t size, int ( * comparator ) ( const void *, const void * ) ); 
```

现在考虑一下：

```
typedef struct Student { int id; char* name; }

Student students[10];

//populate students

int sortByName(void* a, void* b)
{
    Student* sa = a;
    Student* sb = b;
    return strcmp(a->name, b->name);
}

int sortById(void* a, void* b)
{
    Student* sa = a;
    Student* sb = b;
    return a->id - b->id;
}

//sort by name:
qsort(students, 10, sizeof(Student), sortByName);

//sort by id:
qsort(students, 10, sizeof(Student), sortById); 
```

重要的是不必更改排序代码。排序实现实际上是通用的。它是一种对不同数据类型进行操作的算法，在这种情况下，函数指针有助于实现这种通用性。

函数指针还有其他用途（其中不少），例如回调，或基于将某些内容映射到函数的映射的分支。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T22:30:26.003

第二个参数是指向带有签名的函数的函数指针`int(node_t *)`。这样，您可以将回调传递给`func`，如下所示：

```
int foo(node_t * p) { /* ... */ }

node_t n;
func(&n, foo);   //  note: the second argument is the function pointer 
```

* * *

这是一个非常愚蠢的例子，用它来移动一个虚构的数组：

```
T * array_next(T * arr, int n) { return arr + n; }
T * array_prev(T * arr, int n) { return arr - n; }

T * move_in_array(T * arr, T * (*f)(T *, int))
{
    return f(arr, 1);
} 
```

现在，您可以使用回调编写以运行时确定的方式在数组中移动的代码：

```
T * p = move_in_array(some_array, flag ? array_next : array_prev); 
```

这里的关键设计思想是我们有一个通用的动作函数`move_in_array`，它的具体实现以函数指针的形式作为参数传递。

# hadoop - 将任何类型的对象传递给 Hadoop Mapper

> ID：10489980
> 
> 赞同：0
> 
> 时间：2012-05-07T22:25:32.627
> 
> 标签：hadoop, hdfs

hadoop 配置对象只允许字符串作为 set 方法中的值

设置（字符串名称，字符串值）

有没有一种简单的方法来设置任何其他对象类型？我想在映射器中检索这些对象。

我注意到在 0.15 左右的版本中，有一个 set(String key, Object value) 方法已被弃用和删除。这样做有什么理由吗？我还有其他方法可以将对象传递给映射器吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T17:25:04.870

配置对象必须序列化为字符串，并作为包含字符串的文件发送到映射器。您需要提供一种方法来序列化和反序列化您的对象。

# c - 使用 C 从 XML 文件中读取数据

> ID：10489982
> 
> 赞同：0
> 
> 时间：2012-05-07T22:25:42.300
> 
> 标签：c, xml, parsing, libxml2

这是后续行动： [使用 xslt 在 c 中创建 xml 文件](https://stackoverflow.com/questions/9473190/using-xslt-to-create-an-xml-file-in-c)

```
<element1 type="type1" name="value1">
  <start play="no"/>
  <element2 aaa="AAA"/>
  <element2 bbb="BBB"/>
  <element3 ccc="CCC">
     <element4/><!-- play="no"/>-->
  </element3>
</element1> 
```

假设我得到了这个 xml 文件，我如何读取单个节点？我的意思是，并非所有节点都是强制性的。我是否需要通过“libxml2”或类似的东西遍历所有节点并读取它的值？或者我可以使用某种模式来定义我的 xml 的外观？有什么更好的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T22:32:41.180

架构从来都不是一个坏主意，但它不会帮助您阅读 xml。如果您针对它验证 xml，所有模式都会告诉您它遵循那里的任何规则。对于其余部分，在此处快速搜索会发现这一点。[如何使用 libxml2 解析 XML 中的数据？](https://stackoverflow.com/questions/5465965/how-can-libxml2-be-used-to-parse-data-from-xml)

# nservicebus - 收到带有 NserviceBus 主机的消息时，我在 MessageHeaderManager.GetHeader 中收到 NullReferenceException

> ID：10489983
> 
> 赞同：1
> 
> 时间：2012-05-07T22:25:51.517
> 
> 标签：nservicebus

我正在使用 NServiceBus 3，当我收到一条消息时，我从接收端点收到此错误。：

```
NServiceBus.Unicast.Transport.Transactional.TransactionalTransport [(null)] <(null)> - Failed raising 'transport message received' event for message with ID=97d0f2fa-6227-439b-ad37-a304bd2af000\10428
System.NullReferenceException: Object reference not set to an instance of an object.
   at NServiceBus.MessageHeaders.MessageHeaderManager.GetHeader(Object message, String key)
   at NServiceBus.MessageHeaders.Bootstrapper.<Run>b__0(Object msg, String key)
   at NServiceBus.ExtensionMethods.GetHeader(Object msg, String key)
   at NServiceBus.ExtensionMethods.GetOriginatingSiteHeader(Object msg)
   at NServiceBus.Gateway.HeaderManagement.GatewayHeaderManager.MutateIncoming(Object message)
   at NServiceBus.Unicast.UnicastBus.<>c__DisplayClass25.<ApplyIncomingMessageMutatorsTo>b__24(IMutateIncomingMessages m)
   at System.Collections.Generic.List`1.ForEach(Action`1 action)
   at NServiceBus.Unicast.UnicastBus.ApplyIncomingMessageMutatorsTo(IBuilder builder, Object originalMessage)
   at NServiceBus.Unicast.UnicastBus.<>c__DisplayClass22.<HandleMessage>b__21(Object msg)
   at System.Linq.Enumerable.WhereSelectArrayIterator`2.MoveNext()
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at NServiceBus.Unicast.UnicastBus.HandleMessage(IBuilder builder, TransportMessage m)
   at NServiceBus.Unicast.UnicastBus.HandleTransportMessage(IBuilder childBuilder, TransportMessage msg)
   at NServiceBus.Unicast.UnicastBus.TransportMessageReceived(Object sender, TransportMessageReceivedEventArgs e)
   at System.EventHandler`1.Invoke(Object sender, TEventArgs e)
   at NServiceBus.Unicast.Transport.Transactional.TransactionalTransport.OnTransportMessageReceived(TransportMessage msg) 
```

消息本身如下所示：

```
public interface ILinkPersonMessage : IBaseMessage
{
    int PersonId { get; set; }
    List<int> UnitIds { get; set; }
}

public interface IBaseMessage
{
    int UserId { get; set; }
} 
```

在发送类中，我正在这样做：

```
var message = bus.CreateInstance<ILinkPersonMessage>();
message.UserId = currentUser.UserId;
message.PersonId = personId;
message.UnitIds = selectedUnits;

bus.Send(message); 
```

**更新：**

我正在查看 NServiceBus 代码，这是引发错误的方法：

```
 public string GetHeader(object message, string key)
    {
        if (message == ExtensionMethods.CurrentMessageBeingHandled)
            if (bus.CurrentMessageContext.Headers.ContainsKey(key))
                return bus.CurrentMessageContext.Headers[key];
            else
                return null;

        if (messageHeaders == null)
            return null;

        if (!messageHeaders.ContainsKey(message))
            return null;

        if (messageHeaders[message].ContainsKey(key))
            return messageHeaders[message][key];

        return null;
    } 
```

通过查看该代码，这可能仅在`bus.CurrentMessageContext`或`bus.CurrentMessageContext.Headers`为 null 或`messageHeaders[message]`存在但包含 null 值时才会发生。不幸的是，我还无法弄清楚其中哪种情况更有可能（甚至可能）

**更新 2**

因此，使用 QueueExplorer 我已将标题拉出：

```
<?xml version="1.0"?>
<ArrayOfHeaderInfo xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <HeaderInfo>
        <Key>NServiceBus.Version</Key>
        <Value>3.0.3</Value>
    </HeaderInfo>
    <HeaderInfo>
        <Key>NServiceBus.TimeSent</Key>
        <Value>2012-05-08 06:57:15:691208 Z</Value>
    </HeaderInfo>
    <HeaderInfo>
        <Key>NServiceBus.EnclosedMessageTypes</Key>
        <Value>Namespace.Service.ILinkPersonMessage __impl, NServiceBus.Unicast.Transport__impl, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null;Namespace.Service.ILinkPersonMessage, Namespace.Service, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</Value>
    </HeaderInfo>
    <HeaderInfo>
        <Key>WinIdName</Key>
        <Value>*{myusername}*</Value>
    </HeaderInfo>
    <HeaderInfo>
        <Key>CorrId</Key>
    </HeaderInfo>
</ArrayOfHeaderInfo> 
```

**更新 3**

这是现在可以使用的流畅配置：

```
Configure.With()
.DefiningEventsAs(t => t.Namespace != null && t.Namespace.StartsWith("Events"))
.DefiningCommandsAs(t => t.Namespace != null && t.Namespace.StartsWith("Messages"))
.CastleWindsorBuilder(container)
.XmlSerializer()
.MsmqTransport()
.IsTransactional(true)
.IsolationLevel(IsolationLevel.ReadUncommitted)
.UnicastBus()
.RavenSagaPersister()
.RavenSubscriptionStorage()
.UseRavenTimeoutPersister()
.RunTimeoutManager()
.ForInstallationOn<NServiceBus.Installation.Environments.Windows>().Install(); 
```

（我已经修剪了所有的命名空间）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T23:30:35.573

这会在发送进程启动后的第一条消息上发生，还是仅在后续消息上发生？

您是否多次配置发送总线？（NServiceBus.Configure？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-02T01:19:49.437

同样的事情发生在我身上，问题是我在配置服务总线时忘记设置 xmlserialization

```
var configBus = NServiceBus.Configure.With()
.DefaultBuilder()
.MsmqSubscriptionStorage()
.XmlSerializer() // <== This line here
.MsmqTransport()
    .IsTransactional(true)
    .PurgeOnStartup(false)
.UnicastBus()
.ImpersonateSender(true); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T19:16:06.237

我们最近修复了一些关于标头管理的错误，所以这可能就是您遇到的问题。请尝试升级到 3.0.4，看看是否能解决您的问题。

# mysql - 无法在 mysql 数据库中插入 iframe

> ID：10489991
> 
> 赞同：0
> 
> 时间：2012-05-07T22:27:21.757
> 
> 标签：mysql, kohana

我使用的是 kohana 2.3.4，我有一个“嵌入谷歌地图代码”的文本区域，系统会自动剥离 iframe 标签，而不是插入到数据库中。这是我用于插入/更新的代码片段：

```
$this->db->query("UPDATE tbl_sites SET map_code='$_POST[map_code]' WHERE id=$id"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T10:03:15.210

该查询看起来很狡猾，但如果您确定它正确更新了记录，并且 Kohana 只是剥离 iframe，那么这可能是 XSS 过滤的问题。您是否尝试关闭全局 XSS 过滤？[http://docs.kohanaphp.com/general/security#cross_site_scripting_xss](http://docs.kohanaphp.com/general/security#cross_site_scripting_xss)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:30:24.153

我的猜测是您在索引 $_POST 数组时忘记了引号。尝试这个：

```
$this->db->query("UPDATE tbl_sites SET map_code='{$_POST["map_code"]}' WHERE id={$id}"); 
```

您还应该确保在查询中使用来自数组的值之前对其进行[清理。](https://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php)`$_POST`

# php - 如何更改此 html 和脚本以使用 6 个不同的按钮与 6 个单选和 1 个按钮

> ID：10489994
> 
> 赞同：0
> 
> 时间：2012-05-07T22:27:35.183
> 
> 标签：php, javascript, html

我正在重新设计页面，我为用户可以选择的 6 个选项添加了 6 个不同的按钮，而不是 6 个单选框和 1 个按钮。我只需要调整代码以确保在下一页上，根据按下的按钮显示正确的总数和文本。

我只需要根据按下哪个按钮来更改下一页上的一些文本。

这是最初的内容：

```
<input id="diamondmonthly" class="radio" type="radio" value="diamondmonthly" name="membership">

<input id="diamondyearly" class="radio" type="radio" checked="checked" value="diamondyearly" name="membership">

<input id="c4" class="radio" type="radio" value="c4" name="membership">

<input id="c3" class="radio" type="radio" value="c3" name="membership">

<input id="c2" class="radio" type="radio" value="c2" name="membership">

<input id="c1" class="radio" type="radio" value="c1" name="membership">

<a id="btnSave" class="xlarge button-submit" onclick="$j('#btnSave').attr('disabled', 'disabled');qc.recordControlModification('btnSave', 'Enabled', '0'); qc.pB('MembershipForm', 'btnSave', 'QClickEvent', '');" href="#">

<script>
//<![CDATA[
qc.registerForm(); qc.imageAssets = "http://images.comfiles.com/assets/images"; qc.cssAssets = "http://images.comfiles.com/assets/css"; qc.phpAssets = "/assets/php"; qc.jsAssets = "http://images.comfiles.com/assets/js"; qc.regCA(new Array("btnSave","btnSave2","c1","c2","c3","c4","diamondyearly","diamondmonthly")); jQuery(document).ready(function($j){if($j.isFunction($j().tooltip)){$j("#MembershipForm :input[data-error]").tooltip({ position: "center right", tipClass: "error_tooltip", offset: [0, -4] })}}); 
//]]>
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T23:56:43.437

这可以使用每个按钮一个监听器来处理，或者通过将工作委托给单个祖先元素来处理。在这种情况下，在表单上放置一个单击侦听器可能是最简单的。当它被调用时，您可以使用关联的事件对象来查看它的来源并做出相应的反应。

请注意，当按名称获取表单控件时，如果只有一个控件具有该名称，则仅返回一个元素。如果两个或更多控件具有该名称，则返回具有该名称的元素的 HTMLCollection。

侦听器可以是：

```
<form onclick="handleClick(this)" ...> 
```

和监听器（未经测试，但你应该能够从这里开始）：

```
function handleClick(form) {
  var button, buttons = form['membership'];

  // Now show text depending on which membership button is checked
  for (var i=0, iLen=buttons.length, i<iLen; i++) {
      button = buttons[i];

      // Assuming that the text element to display has an ID 
      // matching the value of the checked button
      if (button.checked) {
        document.getElementById(button.value).style.display = '';
      } else {
        document.getElementById(button.value).style.display = 'none';
      }
  }
} 
```

每次在表单中的任意位置单击时脚本都会运行，因此即使单击了重置按钮，也会始终显示正确的文本。

if..else 可以替换为：

```
 document.getElementById(button.value).style.display = button.checked? '' : 'none'; 
```

但较长的版本可能更清晰。

哦，去掉脚本元素中的 CDATA 定界符，它们仅对作为 XML 服务的文档是必需的。

# objective-c - 使用 ARC 手动对象生命周期

> ID：10489995
> 
> 赞同：2
> 
> 时间：2012-05-07T22:27:36.763
> 
> 标签：objective-c, automatic-ref-counting

检查以下代码，并假设它是在 ARC 下编译的：

```
-（无效）富{
    NSOperationQueue *oq = [[NSOperationQueue alloc] init];
    [oq addOperationWithBlock:^{
        // 假设我们在这里有一个长时间运行的操作。
    }];
}
```

尽管操作队列被声明为局部变量，但只要它有正在运行的操作，它的生命周期就会超出方法的范围。

这是如何实现的？

**更新：**

我很欣赏 Rob Mayoff 深思熟虑的评论，但我认为我没有正确地提出我的问题。我不是在问关于 NSOperationQueue 的具体问题，而是关于 ARC 中对象生命周期的一般问题。具体来说，我的问题是：

*在 ARC 下，对象如何参与对其自身生命周期的管理？*

我做了很长一段时间的程序员，我很清楚这种事情的陷阱。我不希望被告知这是一个好主意还是坏主意。我认为总的来说这是一个坏的。相反，我的问题是学术性的：*无论这是一个好主意还是坏主意，如何在 ARC 中做到这一点，这样做的具体语法是什么？*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-08T00:15:00.917

作为一般情况，您可以保留对自己的引用。例如：

```
@implementation MasterOfMyOwnDestiny
{
   MasterOfMyOwnDestiny *alsoMe;
}

- (void) lifeIsGood
{
    alsoMe = self;
}

- (void) woeIsMe
{
    alsoMe = nil;
}

...

@end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-07T22:42:30.930

这里有几种可能性：

1.  `NSOperationQueue`保留自己直到它为空，然后释放自己。

2.  `NSOperationQueue`导致其他对象保留它。例如，由于`NSOperationQueue`使用 GCD，可能`addOperationWithBlock:`看起来像这样：

    ```
    - (void)addOperationWithBlock:(void (^)(void))block {
        void (^wrapperBlock)(void) = ^{
            block();
            [self executeNextBlock];
        };
        if (self.isCurrentlyExecuting) {
            [self.queuedBlocks addObject:wrapperBlock];
        } else {
            self.isCurrentlyExecuting = YES;
            dispatch_async(self.dispatchQueue, wrapperBlock);
        }
    } 
    ```

    在该代码中，`wrapperBlock`包含对 的强引用`NSOperationQueue`，因此（假设为 ARC），它保留了`NSOperationQueue`. （real`addOperationWithBlock:`比这更复杂，因为它是线程安全的并且支持同时执行多个块。）

3.  `NSOperationQueue` *不会*超出您的`foo`方法的范围。也许到`addOperationWithBlock:`返回时，您的长时间运行的块已经提交到 GCD 队列。由于您没有强烈引用`oq`，因此没有理由`oq` *不*应该释放。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T00:38:02.767

在给出的示例代码中，在 ARC 下，在块的封闭词法范围内本地的 NSOperationQueue 被块捕获。基本上，块保存指针的值，以便以后可以从块内访问它。无论您是否使用 ARC，这实际上都会发生；不同的是，在 ARC 下，对象变量会随着块的复制和释放而自动保留和释放。

[块编程主题](http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Conceptual/Blocks/Articles/bxVariables.html)指南中的[“对象和块变量”](http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Conceptual/Blocks/Articles/bxVariables.html#//apple_ref/doc/uid/TP40007502-CH6-SW3)部分是这方面的一个很好的参考。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T04:57:01.810

我能想到的最简单的事情是拥有一个全局 NSMutableArray （或集合，或其他），对象将自己添加到其中并从中删除。另一个想法是将（正如您已经承认的）奇怪的内存管理代码放在非 ARC 文件中的一个类别中，然后直接使用 -retain 和 -release 。

# oop - MATLAB - 涉及定时器时对象不清除

> ID：10489996
> 
> 赞同：1
> 
> 时间：2012-05-07T22:27:47.207
> 
> 标签：oop, matlab, timer

这与[this question](https://stackoverflow.com/q/9559849/238644)有些相关，但不完全相关。

我有两个班级，`FunctionWrapper`并且`TimerWrapper`：

```
classdef FunctionWrapper < handle
    methods
        function Fcn(obj)
            disp('FunctionWrapper.Fcn was called!');
        end
    end
end

classdef TimerWrapper < handle
    properties
        Timer
    end

    methods
       function obj = TimerWrapper(other_object)
            obj.Timer = timer;
            set(obj.Timer, 'Period', 1);
            set(obj.Timer, 'ExecutionMode', 'fixedSpacing');
            set(obj.Timer, 'TimerFcn', @(event, data) other_object.Fcn);
       end

       function start(obj)
           start(obj.Timer);
       end

       function stop(obj)
           stop(obj.Timer);
       end

       function delete(obj)
           disp('destructor called!');
           delete(obj.Timer);
       end
    end
end 
```

假设我在命令行窗口中执行以下代码：

```
>> F = FunctionWrapper;
>> T = TimerWrapper(F);
>> clear T %# T's destructor not called
>> timerfind %# just to verify that no, the destructor was never called

   Timer Object: timer-1

   Timer Settings
      ExecutionMode: fixedSpacing
             Period: 1
           BusyMode: drop
            Running: off

   Callbacks
           TimerFcn: @(event,data)other_object.Fcn
           ErrorFcn: ''
           StartFcn: ''
            StopFcn: '' 
```

这里发生了什么？我知道`timer`需要手动删除对象，但我认为这将在析构函数中处理`TimerWrapper`。如果不使用[Amro 丑陋但直接的解决方法来重载`clear`命令](https://stackoverflow.com/a/9560715/238644)，有没有办法`clear T`从工作区中取出？此外，什么都没有引用`T`，那么为什么存在对它的引用呢？（析构函数从未被调用的事实暗示了这一事实。）这是否隐藏在计时器对象本身中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T09:47:29.510

如果您键入`t = TimerWrapper; f = functions(t.Timer.TimerFcn); f.workspace(2)`，您将看到用于回调的匿名函数的工作区包含对`TimerWrapper`对象本身的引用。所以那里有一种循环引用，它没有被`clear`.

鉴于您的设置方式，您可以`T`通过显式调用析构函数然后调用`clear`.

```
T.delete
clear T 
```

`clear`和之间的区别`delete`有点令人困惑（无论如何对我来说）。如您所见，`clear`没有显式调用析构函数。它只是从工作区中删除*名称* `T`。所以`T`，以及它的底层计时器，在那个时候仍然存在。如果它们不包含对仍然存在的事物的引用，则 MATLAB 将`T`正确删除，包括调用其析构函数。实际上，由于计时器包含对 的引用（在其回调中）`T`，该引用仍然存在，因此`T`不会删除计时器（以及因此）。

您可以使用 找到它（尽管在工作区中没有名称）`timerfindall`，如果您自己明确删除它使用

```
tmrs = timerfindall;
delete(tmrs); 
```

你会发现它`T`现在已经完全消失了。

我不太确定这是一个错误，尽管我觉得这很令人困惑，并且可能会更好地记录和之间的`clear`区别`delete`。

至于解决方法，我不觉得显式调用很痛苦`delete`，尽管如果你不小心调用了清理东西会更痛苦`clear`。我认为来自您链接到的[线程](http://www.mathworks.com/matlabcentral/newsreader/view_thread/306641)中的消息 #5 中的建议，而不是消息 #4，会更普遍和强大。

我认为您不应该`clear`按照@Amro在您链接到的单独线程中建议的方式重载：尽管如果您明确调用这可能会起作用[，](https://stackoverflow.com/a/9560715/238644)`clear T`但如果您调用`clear all`, 或`clear variables`. （我刚刚还没有尝试过，但我相信这些语法`clear`甚至不会遍历工作区中的东西并调用`clear`每个 - 而是调用`clear`内部 MATLAB 工作区对象的方法，这会很快让人感到困惑）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T22:42:22.550

似乎这可能是因为计时器的回调设置为非默认值。[建议的解决方法](http://www.mathworks.com/matlabcentral/newsreader/view_thread/306641)（参见链接线程的消息#4）是仅在`start`调用方法时设置回调函数，然后在调用方法时将其设置为 null `stop`。