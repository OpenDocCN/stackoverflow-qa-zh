# StackOverflow 问答 000265000-000265999

# wpf - 您如何管理庞大且几乎无法维护的 XAML 文件？

> ID：265007
> 
> 赞同：7
> 
> 时间：2008-11-05T12:30:55.603
> 
> 标签：wpf, silverlight, xaml, expression-blend

我在 Silverlight 中处理 XAML 文件时遇到了真正的困难，因为它们在使用 Blend 时变得非常快。在添加和动画化了少数控件之后，它就变成了一堵文字墙。

我希望Blend 的更好版本很快就会问世，这样我们的设计人员甚至都不必看到XAML。不过，就目前而言，这不是一个解决方案——XAML 仍然需要手动管理，这是一项令人沮丧的任务。

有没有人找到解决方案？如何保持 XAML 文件井井有条？当它们变大时，您如何理解它们？

**编辑**：我对 Silverlight 解决方案特别感兴趣，因为 Silverlight 不支持最明显的 WPF 解决方案 - 将内容拆分为资源字典。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-05T12:42:55.643

维护 XAML 文件确实需要一些工作，但基本上，您需要做的是使用对您有意义的方案将它们拆分为资源文件（XAML 资源字典）。

例如，我们使用一个具有如下文件夹结构的方案：

*   资源（包含代表用户控件和页面的 XAML 文件）

    *   模具（带有形状的 XAML 文件）
    *   样式（带有样式的 XAML 文件）
    *   刷子 ( ... )
        *   共享
    *   模板 ( ... )

您的结构可能会有所不同，但从长远来看，将所有资源分隔在不同文件中确实会使维护更加容易。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-06T22:55:41.007

自 1 月份私人发布以来，我一直在使用 Silverlight 2，我们遇到了这个问题，我们所有的 XAML 都在一个大文件中。作为最佳实践，我们所做的是将用户界面分解为基于视觉分类的单独用户控件（页眉、页脚、导航控件等）。最初我们尝试使用嵌套画布（网格尚未添加到框架中）后来这变成了维护的噩梦。

在 Blend 中，您实际上可以从 Objects and Timeline 窗口中选择 Canvas/grid 等...，右键单击它，然后您将获得“Make Control..”选项，这有助于快速重构和模块化我们的主 XAML 文件. 然后我们使用事件来允许用户控件相互通信。

希望这会有所帮助，祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T18:55:26.313

我是一名创意开发人员，在 Blend 广泛工作。

去年我发表了一些关于[保持 XAML 清洁](http://blogs.vertigo.com/personal/alanl/Blog/archive/2007/11/30/keeping-xaml-clean.aspx)的想法。

Silverlight 当前不支持 MergedResourceDictionaries，因此很难按照我在[另一篇文章](http://blogs.vertigo.com/personal/alanl/Blog/archive/2007/11/26/wpf-resource-organization-organized-as-separate-files-by-type-vs-single-file.aspx)中的建议将 XAML 分解为单独的 ResourceDictionary 文件。

Paul Stovell 也有一些有趣[的 XAML 指南](http://www.paulstovell.net/blog/index.php/xaml-and-wpf-coding-guidelines/)。

# delphi - Delphi 2009 中的 Unicode 控制台应用程序

> ID：265018
> 
> 赞同：10
> 
> 时间：2008-11-05T12:36:32.007
> 
> 标签：delphi, unicode, console, delphi-2009

如何使用 Delphi 2009 创建 unicode 控制台应用程序？

如果我这样做：

```
{$APPTYPE CONSOLE}
uses
  SysUtils;
begin
  writeln('öüğşç سيمانتت');
end. 
```

我得到以下信息：

```
ougsc ??????? 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-06T10:17:23.580

Delphi 2009 中的 Writeln 仍然使用 ANSI（请参阅 System TTextRec），但您可以使用 UTF8Encode 并通过调用 SetConsoleOutputCP(CP_UTF8) 将控制台的输出代码页更改为 UTF8。您还需要一个好的字体来实际显示 Unicode 字符。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-05T19:36:34.763

我不确定这就是您所追求的，但是您可以使用 Windows API 函数在所有 32 位 Delphi 版本中创建 Unicode 控制台应用程序。我刚刚尝试使用 Delphi 4：

```
program test;

{$APPTYPE CONSOLE}

uses
  Windows;

var
  s: WideString;
  i: integer;
  Written: Cardinal;
begin
  SetLength(s, 80);
  for i := 1 to 80 do
    s[i] := WideChar(48 + i);
  WriteConsoleW(GetStdHandle(STD_OUTPUT_HANDLE), PWideChar(s), 80, Written,
    nil);
end. 
```

我没有 Delphi 2009 来尝试在编辑器中输入 Unicode 字符串的工作原理......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-05T12:44:06.763

你不能（至少不能使用标准库）。控制台函数是 Delphi 2009 中唯一的非 Unicode 函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T08:23:08.007

@Kabrol：使用光栅字体集，我看不到任何一个字符，但使用 Lucida Console，我至少看到 widechar($11f) - "ğ"。

请参阅[“SetConsoleOutputCP 仅对 Unicode 字体有效”以及](http://support.microsoft.com/kb/99795)[“控制台参考”](http://msdn.microsoft.com/en-us/library/ms682087(VS.85).aspx)中对控制台 API 函数的一般描述。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T12:44:18.073

Windows 控制台无法显示 unicode 字符，因此请尝试将输出发送到文件：

```
my_app.exe > unicode_file.txt 
```

并尝试使用良好的文本编辑器查看 unicode_file.txt。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-10T15:48:33.507

实际上，有一种方法可以通过标准的 WriteLn() 调用来做到这一点，但它涉及修补 Delphi 2009 RTL 中的错误。问题是，Delphi 为 WriteLn 做了一些编译器魔法。对于 UnicodeString 参数，这会导致调用 _WriteUString。该方法可以在 System.pas 中看到，尽管您不能直接调用它。在其中您将看到对 _WriteLString 的调用，但该方法接收一个 AnsiString 参数。所以当这个调用发生时，你的 UnicodeString 被向下转换为 AnsiString。

解决方案是将这个 UnicodeString->AnsiString 转换为 UnicodeString->UTF8String 转换。

现在，当您将控制台设置为 UTF8 时，您的所有字符都将通过原样（是的，当然您需要一种支持您要显示的字符的字体）：

```
SetConsoleOutputCP(CP_UTF8) 
```

对于这个 RTL 修复，您需要做一些漂亮的代码挂钩。我已经这样做了，我的一个同事正忙着写一篇关于这个的文章。一旦它在线可用，我将发布一个链接。

干杯!

# multithreading - SetEvent 是原子的吗？

> ID：265026
> 
> 赞同：2
> 
> 时间：2008-11-05T12:38:14.107
> 
> 标签：multithreading, winapi, events, atomic, critical-section

有 2 个或更多线程在不受关键部分保护的同一事件处理程序上调用 Win32 API 的 SetEvent 是否安全？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T17:57:48.253

这是安全的，但请记住，如果一个线程设置它，而另一个线程同时设置它，您将不会收到两个通知，只会收到一个；由于第二个将其从 True 更改为... True。如果您对此感到担心，请改用信号量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T14:03:40.723

假设您有多个线程等待同一个事件，运行相同的代码。

1.  如果您的代码在完成处理之前没有清除事件，那么您实际上有一个 CS。由于事件在被清除之前一直保持信号状态（又名不是自动重置），因此拥有多个线程信号除了旋转 CPU 之外什么都不做。
2.  如果您的代码在处理开始时将其清除或事件是自动设置的，那么您将有多个线程运行相同的函数，如果这些线程共享任何内容，这是不安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T17:55:13.860

从多个线程调用 SetEvent 没有任何限制。

# java - Java 的最佳 GUI 框架

> ID：265027
> 
> 赞同：4
> 
> 时间：2008-11-05T12:39:45.273
> 
> 标签：java, frameworks

我想用 Java 开始一个新项目；

过去我是从 Struts + Tiles 开始的；但是瓷砖非常复杂；我不知道最新版本的 Tiles；

我需要您对一个好的 GUI 框架的详细建议；

谢谢。

**[这个问题](https://stackoverflow.com/questions/24596/what-web-application-framework-for-java-is-recommended)的重复。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T12:44:27.807

没有“最好”的框架......确实，“最好”真的取决于您的需求，取决于您的知识（学习新框架可能会花费大量时间）......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T13:39:56.213

起初，当我阅读 GUI 框架时，我以为您指的是 Swing 或 SWT，但我看到您提到了 struts，所以我猜您指的是演示框架。

我同意 Tapestry 非常好，但还有其他几个也非常好。Struts2、Stripes 等。Matt Raible 有一个非常好的项目，他为几种不同的技术完成了所有初始集成工作。使用 struts+spring+hibernate 或 JSF 或 Tapestry 等很容易启动和运行。他称之为[AppFuse](http://appfuse.org/display/APF/Home)。

我将 struts2 与 spring 和 hibernate 以及 sitemesh 一起使用，这是一个 AppFuse 项目，它对我很有帮助。

[Stripes](http://www.stripesframework.org/display/stripes/Home)似乎也是 Java Web 应用程序的一个很好的起点。我还没有使用它，但我很受诱惑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T13:02:29.580

我个人喜欢[挂毯](http://tapestry.apache.org/)。我只使用了 4.1 版，但开发时间比 JSP 或 JSF 快得多。它允许您简单地刷新页面以立即查看您所做的更改而无需进行部署，并为模板/页面使用实际的 HTML，这样您就可以在不部署任何代码的情况下预览它们。前面有一点学习曲线，但非常值得。5.0 版处于最终测试版，即将发布候选版本，但我还没有尝试过。它还内置了相当不错且简单的 AJAX。

# sql-server - 测试时临时备份/恢复数据

> ID：265045
> 
> 赞同：0
> 
> 时间：2008-11-05T12:47:52.653
> 
> 标签：sql-server, testing, backup

我需要从表中备份原始数据，以便我可以用测试数据填充它，然后在开发/测试等之后再次恢复它。有人知道实现这一目标的任何快速方法吗？我在 SQL Server 2005 上。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T12:50:30.667

您可以使用 SSIS 将表备份到数据库中具有不同名称的表中。

然后在完成后删除数据库中修改后的表，并将复制的表重命名为原始名称。然后，您需要做的就是重新创建关系。

编辑：**我不会在生产环境中这样做**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T12:51:07.547

我不知道您的具体情况，但规范是将生产服务器镜像到开发服务器并在该服务器上进行测试。在生产服务器上进行破坏性测试并不安全。

MSDN 和 Technet 上有很多关于镜像的文档。一个快速的谷歌发现这篇文章： http: [//www.microsoft.com/technet/prodtechnol/sql/2005/dbmirror.mspx](http://www.microsoft.com/technet/prodtechnol/sql/2005/dbmirror.mspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T12:52:40.537

创建一些临时表。将数据复制到临时表中。测试后复制数据并删除临时表。

# sql-server - 为什么 LIKE 会比 = 快？

> ID：265051
> 
> 赞同：4
> 
> 时间：2008-11-05T12:50:37.530
> 
> 标签：sql-server, database, sql-server-2005, tsql

一位同事最近遇到了这样一种情况，即使用 UserID 上的 = 比较（这是一个 UNIQUEIDENTIFIER）来查找安全权限的查询需要大约 15 秒才能运行。不用说，用户并没有留下深刻的印象。

出于沮丧，我的同事将 = 比较改为使用 LIKE，查询速度加快到不到 1 秒。

在不了解数据架构的情况下（我无权访问数据库或执行计划），什么可能导致这种性能变化？

（广泛而模糊的问题，我知道）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T12:57:48.030

可能只是缓存了一个糟糕的执行计划；更改为 LIKE 语句只会导致生成新的执行计划。如果该人在有问题的表上运行 sp_recompile 然后重新运行 = 查询，则可能会注意到相同的加速。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-05T13:20:33.103

另一种可能性是，这是一个复杂的查询，并且每行的 = 运算符都会发生类型转换。LIKE 稍微改变了语义，这样类型转换就不必在执行计划中占据很大的比重。我建议你的同事看看带有 = 的执行计划，看看是否有类似的东西

```
CONVERT(varchar, variable) = othervariable 
```

在执行步骤中。在错误的情况下，单个类型转换可以使查询减慢两个数量级。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T12:57:04.583

在某些情况下，`LIKE`它可能比`SUBSTRING`使用索引时的等效函数更快。

你能给出确切的`SQL`吗？

有时函数可以阻止优化器使用索引。

比较执行计划。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T14:09:10.960

好吧，如果他一个接一个地运行两个查询，那么很可能第一个查询的数据必须从磁盘读取，但第二个查询仍然在 RDBMS 数据缓存中......

如果发生了这种情况，那么如果他以相反的顺序运行它们，他会看到相反的结果......如果他使用 like 和一个精确的值（没有通配符），那么查询计划应该是相同的......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T12:53:16.247

您是否尝试过更新此表/数据库的统计信息？也许值得尝试一下。

# wpf - 从文件加载图像并使用 WPF 打印它......如何？

> ID：265062
> 
> 赞同：8
> 
> 时间：2008-11-05T12:56:31.043
> 
> 标签：wpf, printing

我正在寻找一个如何从文件加载图像并使用 WPF 在页面上打印的示例。我很难找到有关 WPF 打印的好信息。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-05T13:41:46.117

```
var bi = new BitmapImage();
bi.BeginInit();
bi.CacheOption = BitmapCacheOption.OnLoad;
bi.UriSource = new Uri("");
bi.EndInit();

var vis = new DrawingVisual();
using (var dc = vis.RenderOpen())
{
    dc.DrawImage(bi, new Rect { Width = bi.Width, Height = bi.Height });
}

var pdialog = new PrintDialog();
if (pdialog.ShowDialog() == true)
{
    pdialog.PrintVisual(vis, "My Image");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T14:48:18.353

如果您想要更多控制，那么 PrintDialog.PrintVisual 让您必须将图像包装在 FixedDocumet 中。

您可以在此处找到创建固定文档的简单代码： [http ://www.ericsink.com/wpf3d/B_Printing.html](http://www.ericsink.com/wpf3d/B_Printing.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T13:26:50.687

只需加载图像并将其应用于视觉对象。然后使用 PrintDialog 来完成这项工作。

```
...
PrintDialog printer = new PrintDialog();

if (printer.ShowDialog()) {
  printer.PrintVisual(myVisual, "A Page Title");
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-12T20:50:18.943

确实在玩这个。

Tamir 的答案是一个很好的答案，但问题是，它使用的是图像的原始大小。

自己写一个解决方案，如果图像小于页面大小，则不会拉伸图像，如果图像在页面上太大，则将图像带入。
它可用于多份副本，并可用于两个方向。

```
 PrintDialog dlg = new PrintDialog();

            if (dlg.ShowDialog() == true)
            {
                BitmapImage bmi = new BitmapImage(new Uri(strPath));

                Image img = new Image();
                img.Source = bmi;

                if (bmi.PixelWidth < dlg.PrintableAreaWidth ||
                           bmi.PixelHeight < dlg.PrintableAreaHeight)
                {
                    img.Stretch = Stretch.None;
                    img.Width = bmi.PixelWidth;
                    img.Height = bmi.PixelHeight;
                }

                if (dlg.PrintTicket.PageBorderless == PageBorderless.Borderless)
                {
                    img.Margin = new Thickness(0);
                }
                else
                {
                    img.Margin = new Thickness(48);
                }
                img.VerticalAlignment = VerticalAlignment.Top;
                img.HorizontalAlignment = HorizontalAlignment.Left;

                for (int i = 0; i < dlg.PrintTicket.CopyCount; i++)
                {
                    dlg.PrintVisual(img, "Print a Large Image");
                }
            } 
```

它目前仅适用于具有路径的文件中的图片，但只需稍加工作即可熟练使用它并仅传递 BitmapImage。
它可用于无边界打印（如果您的打印机支持它）

不得不使用 BitmapImage 的方式，因为它加载图像的默认大小。
如果您直接在那里加载图像，Windows.Controls.Image 不会显示正确的高度和宽度。

我知道，这个问题已经很老了，但是在搜索这个问题时很难找到一些有用的信息。
希望我的帖子对其他人有所帮助。

# php - PHP 后台进程

> ID：265073
> 
> 赞同：41
> 
> 时间：2008-11-05T13:00:50.833
> 
> 标签：php, background-process

我正在尝试制作一个 PHP 脚本，我已经完成了脚本，但它需要 10 分钟才能完成它设计的过程。这不是问题，但是我认为我必须一直保持页面加载，这很烦人。我可以拥有它以便我开始该过程，然后在 10 分钟后返回并查看它生成的日志文件吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-11-05T13:09:55.323

好吧，你可以使用“ [ignore_user_abort](http://de2.php.net/manual/en/function.ignore-user-abort.php) (true)”

所以脚本将继续工作（密切关注脚本持续时间，也许添加“ [set_time_limit](http://de2.php.net/manual/en/function.set-time-limit.php)（0）”）

但是这里有一个警告：您将无法使用以下两行停止脚本：

```
ignore_user_abort(true); 
set_time_limit(0); 
```

除了你可以直接访问服务器并杀死那里的进程！（去过那里，做了一个无限循环，一遍又一遍地调用自己，让服务器尖叫着停下来，被大喊大叫......）

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-11-05T16:37:29.100

听起来您应该有一个队列和一个用于处理队列的外部脚本。

例如，您的 PHP 脚本应该将一个条目放入数据库表并立即返回。然后，每分钟运行的 cron 会检查队列并为每个作业派生一个进程。

这里的优点是您不会将 apache 线程锁定 10 分钟。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-05T14:13:24.710

在 Windows 下，我对这种过程有很多问题；我的情况有点不同，因为我不关心“脚本”的响应——我希望脚本启动并允许其他页面请求在它忙于工作时通过。

由于某些原因; 我遇到了问题，要么挂起其他请求，要么在大约 60 秒后超时（apache 和 php 都设置为在大约 20 分钟后超时）；事实证明，firefox 无论如何都会在 5 分钟后超时（默认情况下），所以在那之后，如果不更改 firefox 中的设置，您将无法知道浏览器发生了什么。

我最终使用进程打开和进程关闭方法在 cli 模式下打开一个 php，如下所示：

`pclose(popen("start php myscript.php", "r"));`

这将（使用 start ）打开 php 进程，然后终止启动进程，让 php 运行所需的时间 - 同样，您需要终止该进程以手动将其关闭。它不需要您设置任何超时，您可以让调用它的当前页面继续并输出更多详细信息。

唯一的问题是，如果您需要向脚本发送任何数据，您要么通过另一个来源进行，要么将其作为参数传递给“命令行”；这不是那么安全。

很好地满足了我们的需要，并确保脚本始终启动并允许运行而不会中断。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-05T13:08:37.400

我认为 shell_exec 命令是您正在寻找的。

但是，它在安全模式下被禁用。

关于它的 PHP 手册文章在这里： http: [//php.net/shell_exec](http://php.net/shell_exec)

这里有一篇关于它的文章：http: [//nsaunders.wordpress.com/2007/01/12/running-a-background-process-in-php/](http://nsaunders.wordpress.com/2007/01/12/running-a-background-process-in-php/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-06T07:27:33.050

您可以使用另一个选项，运行脚本 CLI...它将在后台运行，您甚至可以根据需要将其作为 cronjob 运行。

例如

```
> #!/usr/bin/php -q

<?php

//process logs

?> 
```

这可以设置为 cronjob 并且将不受时间限制地执行....虽然这个示例适用于基于 unix 的操作系统。

仅供参考，我有一个运行无限循环的 php 脚本，该脚本执行一些处理，并且在过去 3 个月中一直在不停地运行。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-05T13:09:49.100

您可以使用[`ignore_user_abort()`](http://www.php.net/ignore_user_abort)- 即使您关闭浏览器或转到其他页面，脚本也将继续运行。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-06-25T14:32:07.510

想想[**Gearman**](http://www.php.net/manual/en/book.gearman.php)

> Gearman 是一个通用应用程序框架，用于将工作分配给多台机器或流程。它允许应用程序并行完成任务、负载平衡处理以及在语言之间调用函数。该框架可用于各种应用程序，从高可用性网站到数据库复制事件的传输。
> 
> 此扩展提供了用于编写 Gearman 客户端和工作者的类。- 源 php 手册

[Gearman](http://gearman.org/)官方网站

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-02-21T13:11:38.030

除了 bastiandoeen 的回答，您还可以结合`ignore_user_abort(true);`cUrl **request**。

将请求中止设置为低`CURLOPT_TIMEOUT_MS`并在连接关闭后继续处理：

```
function async_curl($background_process=''){

    //-------------get curl contents----------------

    $ch = curl_init($background_process);
    curl_setopt_array($ch, array(
        CURLOPT_HEADER => 0,
        CURLOPT_RETURNTRANSFER =>true,
        CURLOPT_NOSIGNAL => 1, //to timeout immediately if the value is < 1000 ms
        CURLOPT_TIMEOUT_MS => 50, //The maximum number of mseconds to allow cURL functions to execute
        CURLOPT_VERBOSE => 1,
        CURLOPT_HEADER => 1
    ));
    $out = curl_exec($ch);

    //-------------parse curl contents----------------

    //$header_size = curl_getinfo($ch, CURLINFO_HEADER_SIZE);
    //$header = substr($out, 0, $header_size);
    //$body = substr($out, $header_size);

    curl_close($ch);

    return true;
}

async_curl('http://example.com/background_process_1.php'); 
```

**注意**

> 如果您希望 cURL 在不到一秒的时间内超时，您可以使用 CURLOPT_TIMEOUT_MS，尽管“类 Unix 系统”上存在一个错误/“功能”，如果该值小于 1000 毫秒，则会导致 libcurl 立即超时并出现错误“ cURL 错误 (28): 已超时”。这种行为的解释是：
> 
> [...]
> 
> 解决方案是使用 CURLOPT_NOSIGNAL 禁用信号

**优点**

*   无需切换方法（兼容windows & linux）
*   无需通过 headers 和 buffer 实现连接处理（独立于浏览器和 PHP 版本）

**缺点**

*   需要卷曲扩展

**资源**

*   [curl超时小于1000ms总是失败？](https://stackoverflow.com/questions/7987584/curl-timeout-less-than-1000ms-always-fails)

*   [http://www.php.net/manual/en/function.curl-setopt.php#104597](http://www.php.net/manual/en/function.curl-setopt.php#104597)

*   [http://php.net/manual/en/features.connection-handling.php](http://php.net/manual/en/features.connection-handling.php)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-11T13:46:47.963

祖克。

我很确定这会起作用：

```
<?php 

pclose(popen('php /path/to/file/server.php &'));
echo "Server started. [OK]"; 

?> 
```

**'&' 很重要。它告诉外壳程序不要等待进程退出。**

您也可以在您的 php 中使用此代码（如“bastiandoeen”所说）

```
ignore_user_abort(true); 
set_time_limit(0); 
```

在您的服务器停止命令中：

```
<?php

$output;
exec('ps aux | grep -ie /path/to/file/server.php | awk \'{print $2}\' | xargs kill -9 ', $output);
    echo "Server stopped. [OK]";

?> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2018-07-26T13:46:24.003

只需在任何输出之前调用 StartBuffer()，当您希望客户端关闭连接时调用 EndBuffer()。调用 EndBuffer() 后的代码将在没有客户端连接的服务器上执行。

```
    私有函数 StartBuffer(){
        @ini_set('zlib.output_compression',0);
        @ini_set('implicit_flush',1);
        @ob_end_clean();
        @set_time_limit(0);
        @ob_implicit_flush(1);
        @ob_start();
    }

    私有函数 EndBuffer(){
        $size = ob_get_length();
        header("内容长度：$size");
        header('连接：关闭');
        ob_flush();ob_implicit_flush(1);
    }

```

# javascript - onchange 事件是否传播？

> ID：265074
> 
> 赞同：44
> 
> 时间：2008-11-05T13:01:50.627
> 
> 标签：javascript, html, dom

我正在使用事件委托来侦听 DOM 中较低的事件，但它不适用于选择框上的 onchange 事件。onchange 事件是否会传播或冒泡 DOM？

谷歌搜索未能找到确凿的答案。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-11-05T19:21:52.437

[根据规范](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-htmlevents-h3), `change`, `submit`,`reset`应该起泡和`focus`不`blur`应该起泡。

此行为在除 IE < 9 之外的所有 Web 浏览器中都正确实现，即 , ,`change`在IE >= 9 中正确执行冒泡。`submit``reset`

有关旧 IE 版本的 jQuery 解决方法，请参阅[https://stackoverflow.com/a/4722246/227299](https://stackoverflow.com/a/4722246/227299)

*   [http://www.quirksmode.org/dom/events/change.html](http://www.quirksmode.org/dom/events/change.html)
*   [http://quirksmode.org/dom/events/submit.html](http://quirksmode.org/dom/events/submit.html)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2011-01-18T09:06:27.763

在 jQuery 1.4+ 中，包括 IE 在内的所有浏览器中都会出现更改事件。

```
$('div.field_container').change(function() {
   // code here runs in all browers, including IE.
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T13:26:54.180

我已经有一段时间没有处理这个问题了，但上次我这样做了，我记得 Firefox 识别`<SELECT>`元素上的事件，而 IE6 只识别`<OPTION>`标签上的事件。就目前我所记得的。

那个时候IE7还没有出来。

因此，如果是这种情况，更有意义的是不要内联编写事件处理程序，而是将其应用到准备好的 DOM 上，以免产生大量污染的、重复的代码。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-11-05T13:22:09.480

不知道我是否得到了这个问题，但如果你是这个意思，那么没有。

```
<div id="foo">
  <select onchange="alert('hi');">
    <option>Hello</option>
    <option>World</option>
  </select>
</foo> 
```

哪里 div id="foo" 会有一个 onchange 事件......从选择列表中冒出来？

* * *

在相关说明中，仅供参考，您不能将事件附加到 IE 中选择列表中的选项（嗯，您可以但它不会触发）

# sql-server - 创建命名实例后如何创建默认实例？

> ID：265081
> 
> 赞同：13
> 
> 时间：2008-11-05T13:06:34.037
> 
> 标签：sql-server, sql-server-2005

在安装 SQLServer2005 开发者版（不是特快版）时，我创建了一个命名实例：

```
MYSERVERNAME/MYINSTANCENAME 
```

是否有可能

1）将我的命名实例的名称更改为默认值：

```
MYSERVERNAME 
```

或者

2）创建一个新的默认实例（如上所述的MYSERVERNAME）。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T13:21:21.463

嗯，当我在添加/删除程序中使用“更改”按钮时，SQL Server 2005 安装程序为我提供了实例选择屏幕，甚至允许我列出现有实例。（顺便说一下，我正在运行 XP SP2。）

我在安装程序中选择了“要安装新组件，请单击此处”链接，然后在“要安装的组件”屏幕上选择 SQL Server 数据库服务以到达允许我安装新的默认实例的实例选择屏幕。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-09-08T01:55:25.360

默认实例具有默认实例名称，但会捕获计算机的名称，并将其用作别名。即使您更改了计算机名称，默认实例也会捕获新的计算机名称，并将其用作其别名。但默认实例名称保持不变（如 MSSQLSERVER）。

这就是不能重命名默认实例的原因。默认实例名称是固定的，它捕获计算机名称并将其用作其别名。因此，计算机上只能存在一 (1) 个默认实例，因为默认实例具有固定名称，并且它始终捕获计算机名称并将其用作别名。换句话说，默认实例名称与计算机名称（作为别名）连接在一起。两者都不能以编程方式更改。更改计算机名称只会更改附加到默认实例名称的别名。

如果默认实例已存在，则该计算机上的所有其他 SQL 安装将被强制使用命名实例（别名，不能是计算机名称）。

现在，在您的情况下，在您的第一次 SQL 安装期间，您选择将其安装为命名实例，而不是默认实例。因此，您没有默认实例，因此您使用了与计算机名称不同的别名。您从未安装过默认实例，因此安装未捕获计算机名称作为其别名。

默认实例的主要问题是它们捕获并使用计算机名称作为别名，并且绝对没有办法以编程方式更改默认实例名称。但是，您可以通过更改计算机名称来更改其别名。但计算机名称仍与默认实例名称相连。

别名只是指向 SQL 安装，因此别名可以使用它的引擎。如果该安装未指定为默认实例，则仅表示该安装未以计算机名称作为其别名附加在臀部。

我希望这会有所帮助，但如果这很清楚，请原谅我。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T13:23:37.557

离开 Alan 的回答，当您安装一个新实例作为默认实例时，请注意它用于存储数据和日志文件的目录（或创建一个默认位置，如 D:\MSSQL\Log 和 D:\MSSQL\数据）。

然后，您可以从命名实例中分离数据库并将文件移动到新的数据和日志目录，然后在 SSMS 中重新附加它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-02T15:09:30.060

谢谢。这对我来说也适用于 sql server 2008 r2 express。

我安装了 2005 的默认实例，并且只有一个命名实例用于后续安装 2008。

我卸载了 2005（重要提示：首先将任何 2005 数据库复制到单独的文件夹）。

然后我重新安装了2008。如果你还没有它，你可以从微软获得安装exe。

1.  开始安装并选择“新安装或添加功能”。
2.  选择“新安装或添加功能”选项按钮。
3.  接受默认实例功能。下一个。
4.  选择默认实例选项。下一个。（注意实例 ID 是 MSSQLSERVER）。
5.  除非您有理由不接受，否则请继续接受违约。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-11T08:45:00.980

如果您已安装命名实例。您不能将名称更改为默认值。但是，您可以： * 使命名实例侦听默认端口。* 或者创建别名（使用 MSSQLServer 之类的名称或 IP 地址作为技巧）以使您的客户端正常工作。* 如果此解决方法没有帮助，那么最好的办法是卸载 SQL Complete 并重新安装，但即使您选择了“默认实例”，新安装也可能会再次使用命名实例的名称。您可以在 SQL 服务中验证这一点，以查看它是否仍采用旧名称。在这种情况下，最好的方法（对我有用）是安装一个具有显式名称 MSSQLServer 的新实例，该名称已知为默认实例名称。

还要记住，SQL 采用计算机名称并将其用作别名。

# .net - 如何获得机器的启动时间？

> ID：265089
> 
> 赞同：5
> 
> 时间：2008-11-05T13:09:51.783
> 
> 标签：.net

我想显示我的代码正在运行的机器的正常运行时间，我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-05T13:17:28.023

试试这个链接。它使用**System.Environment.TickCount**属性

> 获取自系统启动以来经过的毫秒数。- MSDN

[http://msdn.microsoft.com/en-us/library/system.environment.tickcount(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.environment.tickcount(VS.80).aspx)

注意：此方法将工作 25 天，因为 TickCount 是 Int32。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T15:25:11.790

```
using System.Management;
using System.Linq;

TimeSpan GetUptime()
 { var query = new SelectQuery("SELECT LastBootUpTime 
                                 FROM Win32_OperatingSystem 
                                 WHERE Primary='true'");
   var mos = new ManagementObjectSearcher(query);
   var str = mos.Get().First().Properties["LastBootUpTime"].Value.ToString();

   return DateTime.Now - ManagementDateTimeConverter.ToDateTime(str);
 } 
```

（基于来自[http://bytes.com/forum/thread502885.html](http://bytes.com/forum/thread502885.html)的代码）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-29T14:12:29.457

好奇他们都没有考虑过秒表吗？

精确且大于`System.Environment.TickCount`，不涉及操作系统可怕的性能计数器、WMI 或本机调用，而且非常简单：

```
var ticks = Stopwatch.GetTimestamp();
var uptime = ((double)ticks) / Stopwatch.Frequency;
var uptimeSpan = TimeSpan.FromSeconds(uptime); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T13:23:26.717

您还可以使用诊断

```
using System.Diagnostics;
..........
PerformanceCounter perfc = new PerformanceCounter("System","System Up Time");
perfc.NextValue();
TimeSpan t = TimeSpan.FromSeconds(perfc.NextValue());
.......... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-02T12:17:03.017

最简单和正确的方法是

```
public static TimeSpan GetUptime()
{
    ManagementObject mo = new ManagementObject(@"\\.\root\cimv2:Win32_OperatingSystem=@");
    DateTime lastBootUp = ManagementDateTimeConverter.ToDateTime(mo["LastBootUpTime"].ToString());
    return DateTime.Now.ToUniversalTime() - lastBootUp.ToUniversalTime();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T13:25:09.753

为了将来参考，在 *nix 上，使用 uptime(1)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-30T18:11:37.693

仅供参考；在 Win32 世界中，您可以使用：

[GetTickCount](http://msdn.microsoft.com/en-us/library/ms724408(VS.85).aspx)、[GetTickCount64](http://msdn.microsoft.com/en-us/library/ms724411(VS.85).aspx)或[性能计数器](http://msdn.microsoft.com/en-us/library/aa373083(VS.85).aspx)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-05T13:10:52.000

我建议你使用命令行：**net statistics station**并解析输出。机器运行的时间是在“Statistics since”之后。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-05T13:11:55.867

关于 up 的含义有很多定义。假设我们正在谈论一个应用程序，那么远程 ping 一个简单的服务可能就足够了。 [Keynote](http://www.keynote.com/)为 Web 提供企业级解决方案，而且肯定还有很多其他的解决方案，我想很多都是免费的。

更新：鉴于这被标记为 .net，我假设我们对应用程序的正常运行时间感兴趣。它是您想要显示机器正常运行时间的应用程序吗？

# c# - System.DirectoryServices 在命名空间“系统”中无法识别

> ID：265096
> 
> 赞同：32
> 
> 时间：2008-11-05T13:15:14.470
> 
> 标签：c#, .net, directoryservices

我正在尝试`System.DirectoryServices`在网站项目中使用，但出现此错误：

> 命名空间“System”中不存在类型或命名空间名称“DirectoryServices”（您是否缺少程序集引用？）

我的项目引用了`System.DirectoryServices`in `web.config`：

```
<add assembly="System.DirectoryServices, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/> 
```

我确实有`using System.DirectoryServices`我想使用它的文件。

有人知道在哪里寻找问题吗？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2013-01-03T22:40:50.160

1.  右键单击解决方案下的引用。
2.  选择添加参考。该参考可以在框架程序集列表下找到。选择*System.DirectoryServices*并单击添加。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-05T13:28:16.097

在黑暗中射击：您是否尝试过添加到 web.config：

```
<compilation debug="true">
     <assemblies>
          <add assembly="System.DirectoryServices, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
     </assemblies>
</compilation> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-09-12T15:21:34.570

我认为您应该安装目录服务包。

```
Install-Package System.DirectoryServices -Version 4.0.0 
```

[目录服务包](https://www.nuget.org/packages/System.DirectoryServices/4.0.0)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-05T13:46:14.737

网络服务器（IIS 或其他）是否配置为将文件夹作为应用程序运行（即显示为 cog），是否使用正确版本的 ASP.NET？如果它作为 1.1 运行，它的某些部分可能会工作 - 但它无法在 1.1 GAC 中找到该 2.0 程序集。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-02-08T16:12:03.167

这是一个非常古老的线程，但只是为了后代提供一个完整的答案；）

如果项目缺少对 .Net 组件**System.DirectoryServices的引用，则会出现此问题**

以您喜欢的常用方式添加此引用将解决该问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T13:19:11.233

这是一个*网站*项目，还是一个 Web*应用程序*项目。对于后者，引用是通过 .csproj 处理的——即通过解决方案资源管理器中的“引用”节点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-06-16T01:41:04.157

在解决方案资源管理器中右键单击您的项目，然后从结果菜单中单击添加引用，然后在 .NET 选项卡下导航到 DirectoryServices.AccountManagement

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-03-05T10:10:23.597

当您使用较旧的 .net 版本并尝试使用最新的 IDE 构建时，会出现这些问题

这取决于您使用的 IDE 版本以及当前的代码版本。

检查网络配置，

就我而言，我使用的是最新版本，即 4.7，而`directoryService`程序集仍然指的是 C#4.0。

如果您使用的是最新版本的 id 即 4.7，请在下面添加

```
 <system.web>
  <location>

<compilation debug="false" numRecompilesBeforeAppRestart="100" targetFramework="4.7">
        <assemblies>
<add assembly="System.DirectoryServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
<add assembly="System.DirectoryServices.AccountManagement, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
 </assemblies>
      </compilation>
</system.web>
  </location> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-08T07:49:38.500

当我尝试将网站转换为网络应用程序时，我遇到了同样的问题。看起来 vs 未能加载程序集应该与版本控制有关。如下所示切换`web.config`并添加程序集。确保 DLL 版本与您的应用程序目标 .NET 版本相匹配。

```
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.DirectoryServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
      </assemblies>
    </compilation>
  </system.web>
</configuration> 
```

要获取您需要启动的公钥`Developer Command Prompt for VS`。更改为上述 ex 上的 GAC 目录相关框架`C:\Windows\Microsoft.NET\Framework\v4.0.30319` 并调用

```
sn -T System.DirectoryServices.dll 
```

# vb.net - 是否有 VB.NET 函数将数字格式化为序数

> ID：265097
> 
> 赞同：4
> 
> 时间：2008-11-05T13:15:35.653
> 
> 标签：vb.net, function, numbers, ordinals

是否有内置的 VB.NET 函数将数字格式化为序数，还是我必须自己编写？

[C# 中没有，所以我认为没有:(](https://stackoverflow.com/questions/20156/ordinals-in-c)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-05T13:34:37.643

[已经在 C# 中的序数中](https://stackoverflow.com/questions/20156/ordinals-in-c)回答了 搜索是你的朋友。. .

基本上“不，框架中没有提供方法”，但是关于如何做到这一点有很好的答案。

**编辑**

向那些认为我应该投反对票的人道歉，我应该将 C# 翻译成 vb.net。

```
Public Function AddOrdinal(ByVal num As Integer) as String
    Select Case (num Mod 100)
        Case 11 To 13
            Return num.ToString() & "th"
    End Select
    Select Case num Mod 10
        Case 1
            Return num.ToString() & "st"
        Case 2
            Return num.ToString() & "nd"
        Case 3
            Return num.ToString() & "rd"
        Case Else
            Return num.ToString() & "th"
    End Select
End Function 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T13:27:50.153

如果实现可用于 VB.NET，那么它也可用于 C# - 您可以从 C# 调用特定于 VB 的“标准库”。

换句话说 - 我不相信框架中有任何东西。

# php - 在 PHP 中读取大文件的最佳方法是什么？

> ID：265102
> 
> 赞同：2
> 
> 时间：2008-11-05T13:17:39.613
> 
> 标签：php, large-files

我必须逐行读取 10 到 20 兆的 CSV 文件。`file()`没用，我必须找到最快的方法。

我试过 with `fgets()`，它运行良好，但我不知道每次调用它时它是否读取一个小块，或者它是否缓存一个更大的块并优化文件 I/O。我必须尝试这种`fread()`方式，自己解析EOL吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T13:23:16.543

如果可能的话，你应该使用[fgetcsv()](http://www.php.net/fgetcsv)。

否则，总是有 fgets()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T15:10:59.493

对于大文件，stream_get_line 显然比 fgets 更有效。如果您为读取指定一个合理的最大长度，我看不出 PHP 必须“提前读取”才能读取一行的任何理由，正如您似乎担心的那样。

如果您想使用 CSV，那么 fgetcsv 将以更合理的格式返回结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T13:21:27.280

[`fgets()`](http://www.php.net/fgets)应该完全可以满足您的需求。甚至[`file()`](http://www.php.ney/file)应该没问题 - 20mb 不是很大，除非你同时这样做很多次。

不要忘记您可以`fgets()`使用它的第二个参数进行调整。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T13:28:03.897

您应该看一下`fgetcsv()`，它会自动将逗号分隔线解析为数组。

至于运行时效率，我不知道。您必须进行快速测试，最好使用您希望稍后处理的大小的文件。但是如果 fget 我会感到惊讶？？？和fput？？？功能未经过 I/O 优化。

# asp.net - 自动 MSIL 到 JavaScript 的转换有用吗？

> ID：265106
> 
> 赞同：3
> 
> 时间：2008-11-05T13:20:10.187
> 
> 标签：asp.net, javascript, cil

我一直在从事一个名为[Axial](http://www.codeplex.com/axial)的项目，该项目将 MSIL（已编译的 C# 或 VB.NET）转换为 JavaScript。有一些工作代码示例，但一些常见情况无法正常工作。（当前版本不能在生产模式下工作，SVN 代码不能在调试模式下工作，但更干净。）我从很多人那里听说他们讨厌编写 JavaScript，所以我知道这个项目有一些优点，但我猜这种态度在 SO 社区中并不那么普遍。

假设产品完美流畅地运行，那么您的 JavaScript 100% 的时间都可以正常工作，并且 Visual Studio 插件可确保您正确使用产品。这是您或您的组织会使用的东西吗？除了直接代码翻译之外，您还会对哪些功能感兴趣？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T14:21:50.733

[已经完成（差不多）。](http://projects.nikhilk.net/ScriptSharp/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T13:26:49.283

这听起来很像以 .NET 为中心的[GWT](http://code.google.com/webtoolkit/)版本。我想问题是：

*   我是否正确理解了目的？
*   您相信您可以克服 GWT 用户可能遇到的任何障碍吗？
*   拥有 .NET 版本和 GWT 是否有足够的好处让重复工作变得值得？（我个人只是编写 Java 代码并使用 GWT，但我知道并非所有 .NET 开发人员都了解 Java，而且您可能已经拥有想要移植的通用库内容。）
*   你有什么有用的想法可以为 GWT 做出贡献吗？:)

（免责声明：我为 Google 工作，但我自己没有使用过 GWT。）

# php - 如何在 mysql 中导入 CSV？

> ID：265117
> 
> 赞同：0
> 
> 时间：2008-11-05T13:23:39.353
> 
> 标签：php, mysql, html, csv

好的，我最近一小时一直在阅读并尝试将 CSV 文件从访问权限导入 MySQL，但无论我尝试什么，我都无法让它正确执行。

我的桌子是这样的：

```
+-----------------+-------------
| Field           | Type
+-----------------+-------------
| ARTICLE_NO      | varchar(20)
| ARTICLE_NAME    | varchar(100)
| SUBTITLE        | varchar(20)
| CURRENT_BID     | varchar(20)
| START_PRICE     | varchar(20)
| BID_COUNT       | varchar(20)
| QUANT_TOTAL     | varchar(20)
| QUANT_SOLD      | varchar(20)
| STARTS          | datetime
| ENDS            | datetime
| ORIGIN_END      | datetime
| SELLER_ID       | varchar(20)
| BEST_BIDDER_ID  | varchar(20)
| FINISHED        | varchar(20)
| WATCH           | varchar(20)
| BUYITNOW_PRICE  | varchar(20)
| PIC_URL         | varchar(20)
| PRIVATE_AUCTION | varchar(20)
| AUCTION_TYPE    | varchar(20)
| INSERT_DATE     | datetime
| UPDATE_DATE     | datetime
| CAT_1_ID        | varchar(20)
| CAT_2_ID        | varchar(20)
| ARTICLE_DESC    | varchar(20)
| DESC_TEXTONLY   | varchar(20)
| COUNTRYCODE     | varchar(20)
| LOCATION        | varchar(20)
| CONDITIONS      | varchar(20)
| REVISED         | varchar(20)
| PAYPAL_ACCEPT   | tinyint(4)
| PRE_TERMINATED  | varchar(20)
| SHIPPING_TO     | varchar(20)
| FEE_INSERTION   | varchar(20)
| FEE_FINAL       | varchar(20)
| FEE_LISTING     | varchar(20)
| PIC_XXL         | tinyint(4)
| PIC_DIASHOW     | tinyint(4)
| PIC_COUNT       | varchar(20)
| ITEM_SITE_ID    | varchar(20) 
```

这应该没问题，我的数据目前是用分号分隔的，因此我的 csv 文件中的一行示例如下：

```
"110268889894";"ORIGINAL 2008 ED HARDY GÜRTEL* MYSTERY LOVE  * M *BLACK";"";0,00 €;0,00 €;0;1;0;8.7.2008 17:18:37;5.11.2008 16:23:37;6.10.2008 17:23:37;29;0;0;0;125,00 €;"";0;2;6.10.2008 16:21:51;6.10.2008 14:19:08;80578;0;;0;77;"";0;0;1;0;-1;0,00 €;0,00 €;0,00 €;0;0;0;77
"110293328957";"Orig. Ed Hardy Shirt - Tank Top - Gr. XS- OVP/NEU";"";25,05 €;0,00 €;7;1;0;27.9.2008 06:26:27;6.10.2008 18:26:21;6.10.2008 18:26:21;49;0;0;0;0,00 €;"";0;1;6.10.2008 16:21:56;6.10.2008 16:33:20;31058;0;;0;77;"";1;0;0;0;-1;0,00 €;0,00 €;0,00 €;0;0;0;77 
```

我用一个简单的PHP页面来输出表格数据，完全错了。问题不在于 PHP 页面作为一个简单的表格，只有文本显示完美。我想知道我是否选择了不正确的字段类型或列不匹配，但我认为没有理由会出现这种情况。由于数据试图显示为 HTML，是否会发生某些事情？

我试图让这个问题尽可能具体，并没有像其他人建议的那样要求人们为我做这件事，但老实说，我看不出问题出在哪里。

编辑：当尝试通过 PHP 显示数据时，此时页面完全是黑色的，有些表格单元格有边框，有些没有，有时在尝试不同的分隔符时，字段与列不匹配。开始字段从未正确显示。

我正在使用以下命令从 CSV 文件加载文件：

```
LOAD DATA LOCAL INFILE 'C:/Dokumente und Einstellungen/hom/Desktop/tblAuction.txt' INTO TABLE Auctions FIELDS TERMINATED BY '\"' LINES TERMINATED BY '\n'; 
```

据我所知，它在数据库中看起来不错，除了开始字段，这不是目前的主要问题。

edit2：我已经序列化了结果，这是输出到屏幕的内容：

```
i:0; 
```

我完全不知道那是什么意思。

编辑3：我曾尝试更新由分隔符终止的，并且在将 \" 更改为 ; 问题仍然存在，数据没有被放入正确的列等......，我不明白我错过了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T13:54:26.950

您的字段以“;”结尾 不变

```
 FIELDS TERMINATED BY '\"' 
```

到

```
 FIELDS TERMINATED BY ';' 
```

你也可以添加这个：

```
 OPTIONALLY ENCLOSED BY '"' 
```

我认为这就是你试图用 TERMINATED BY 子句做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T13:38:04.097

该错误可能是由数据库中的数据损坏、从数据库中检索数据的查询或输出方式引起的。您需要将其缩小到这些原因之一。

1.  直接查看您选择的表格。我为此建议使用[phpMyAdmin](http://www.phpmyadmin.net/)。
2.  将查询结果直接打印到屏幕上。一种非常粗略但可行的方法是将其[序列化](http://fr3.php.net/serialize)：例如`echo serialize($result);`
3.  如果您可以排除 1 和 2 作为错误的原因，则问题必须出在查询的处理上。

一旦确定了原因*所在*，就更容易确定原因是*什么*;-)

正如 Ted Elliot 所说：*您的字段以“;”结尾 不是“\””。`FIELDS TERMINATED BY '\"'` 改为`FIELDS TERMINATED BY ';'`*

此外，将数据导入 mysql 中的日期时间字段的正确格式似乎是 ISO 格式：YYYY-MM-DD HH:mm:ss（例如 2007-07-31 00:00:00）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-05T14:49:02.953

通常情况下，您用作“FIELDS TERMINATED BY”字符串的内容实际上出现在其中一个字段中，通过编写一个小程序来检查这一点 .split() 文件中的每一行并计算字段。希望您可以控制输入文件的生成方式，并且可以使用极不可能的内容，例如“~~~~~”

另外，（不是直接相关，但你知道）你仍然必须做“\ N”才能在数据库中输入空值，并且输入文件中的空字符串可以在数字字段中变成零

[http://bugs.mysql.com/bug.php?id=23212](http://bugs.mysql.com/bug.php?id=23212)

# oracle - 如何找出上次更新 Oracle 表的时间

> ID：265122
> 
> 赞同：35
> 
> 时间：2008-11-05T13:26:03.137
> 
> 标签：oracle, oracle-call-interface

我能否查明对 Oracle 数据库中的表执行最后一次 INSERT、UPDATE 或 DELETE 语句的时间？如果可以，如何查明？

一点背景：Oracle 版本是 10g。我有一个定期运行的批处理应用程序，从单个 Oracle 表中读取数据并将其写入文件。如果自上次作业运行以来数据没有改变，我想跳过这个。

该应用程序是用 C++ 编写的，并通过 OCI 与 Oracle 通信。它以“普通”用户登录 Oracle，所以我不能使用任何特殊的管理工具。

编辑：好的，“特殊管理员的东西”并不是一个很好的描述。我的意思是：除了从表中选择和调用存储过程之外，我什么也做不了。如果想在 2010 年之前完成，那么更改数据库本身的任何内容（例如添加触发器）都不是一个选项。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2011-07-26T15:35:33.480

我参加这个聚会真的很晚了，但我是这样做的：

```
SELECT SCN_TO_TIMESTAMP(MAX(ora_rowscn)) from myTable; 
```

对于我的目的来说，它已经足够接近了。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-11-05T15:33:13.350

由于您使用的是 10g，因此您可能会使用`ORA_ROWSCN`伪列。这为您提供了导致行更改的最后一个 SCN（系统更改号）的上限。由于这是一个递增序列，您可以存储`ORA_ROWSCN`您所看到的最大值，然后仅查找 SCN 大于该值的数据。

默认情况下，`ORA_ROWSCN`实际上是在块级别维护的，因此对块中任何行的更改都会更改块中`ORA_ROWSCN`的所有行。如果我们谈论的是“正常”数据访问模式，那么这可能就足够了。您可以重建`ROWDEPENDENCIES`将导致`ORA_ROWSCN`在行级别跟踪的表，这为您提供更细化的信息，但需要一次性努力来重建表。

另一种选择是配置更改数据捕获 (CDC) 之类的东西，并使您的 OCI 应用程序成为表更改的订阅者，但这也需要一次性配置 CDC。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-05T14:35:47.287

向您的 DBA 询问有关审计的问题。他可以使用以下简单命令开始审核：

```
AUDIT INSERT ON user.table 
```

然后您可以查询表 USER_AUDIT_OBJECT 以确定自上次导出以来您的表上是否有插入。

google for Oracle 审计以获取更多信息...

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-08-25T14:41:15.657

```
SELECT * FROM all_tab_modifications; 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-05T13:59:05.863

您可以对结果运行某种校验和并将其存储在本地吗？那么当您的应用程序查询数据库时，您可以比较它的校验和并确定是否应该导入它？

看起来您可以使用[ORA_HASH](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions107.htm)函数来完成此操作。

**更新：**另一个很好的资源：[10g 的 ORA_HASH 函数来确定两个 Oracle 表的数据是否相等](http://tonguc.wordpress.com/2008/03/06/10gs-ora_hash-function-to-determine-if-two-oracle-tables-data-are-equal/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-05T16:27:17.267

Oracle 可以监视表的变化，当发生变化时，可以在 PL/SQL 或 OCI 中执行回调函数。回调获取一个对象，该对象是已更改的表的集合，并且具有已更改的 rowid 的集合，以及操作的类型、Ins、upd、del。

所以你甚至不去桌子，你坐等被叫。只有在有更改要写入时，您才会去。

它称为[数据库更改通知](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14251/adfns_dcn.htm)。正如贾斯汀所说，它比 CDC 简单得多，但两者都需要一些花哨的管理内容。好的部分是这些都不需要更改应用程序。

需要注意的是，CDC 适用于大容量表，而 DCN 则不然。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-12-13T13:41:41.237

如果在服务器上启用了审计，只需简单地使用

```
SELECT *
FROM ALL_TAB_MODIFICATIONS
WHERE TABLE_NAME IN () 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-05T13:34:35.570

您需要在插入、更新、删除时添加一个触发器，将另一个表中的值设置为 sysdate。

当您运行应用程序时，它会读取该值并将其保存在某处，以便下次运行时它具有要比较的引用。

你会考虑那个“特殊的管理东西”吗？

最好描述一下您实际在做什么，以便您获得更清晰的答案。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-05T14:19:40.783

批处理写入文件需要多长时间？最简单的方法可能是让它继续运行，然后将文件与上一次运行的文件副本进行比较，看看它们是否相同。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-26T09:05:14.770

如果有人仍在寻找答案，他们可以使用Oracle 10g 附带的 Oracle [Database Change Notification特性。](https://docs.oracle.com/cd/E11882_01/java.112/e16548/dbchgnf.htm#JJDBC28815)它需要`CHANGE NOTIFICATION`系统特权。您可以注册侦听器何时触发返回给应用程序的通知。

* * *

## 回答 #11

> 赞同：-5
> 
> 时间：2013-04-24T11:01:09.523

请使用以下语句

```
select * from all_objects ao where ao.OBJECT_TYPE = 'TABLE'  and ao.OWNER = 'YOUR_SCHEMA_NAME' 
```

# java - hsqldb 中的连接池

> ID：265123
> 
> 赞同：3
> 
> 时间：2008-11-05T13:26:04.637
> 
> 标签：java, database, connection-pooling, hsqldb

在不影响速度的情况下，在 hsqldb 中实现连接池的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T18:01:40.447

Hibernate 从 a 获取连接`DataSource`，使用它们并关闭它们。您需要一个连接池，否则效率会非常低，无论您使用哪种数据库服务器，都会在您的应用程序和 DBMS 上消耗大量资源。

您应该尝试Apache-Jakarta 的*commons-dbcp*，它非常高效且设置起来非常简单。这取决于*commons-pool*。您只需`BasicDataSource`使用 DBCP 定义一个，它将管理您告诉它使用的任何 JDBC 驱动程序的连接。它有连接验证和许多其他的东西。当然，如果您正在编写一个 Web 应用程序，请在您将使用的容器上配置一个连接池并使用它，而不是定义您自己的池。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T14:38:26.860

您正在比较苹果和橙子：

1.  如果你想要 orm 比较不同 orm 工具对同一个数据库的性能。
2.  如果您想要连接池，请将不同的连接池库与同一个数据库进行比较。

执行 ORM 需要额外的努力，因此它永远不会像直接 JDBC 访问那样快。也就是说，hibernate 竭尽全力（并且非常成功）来最小化这种额外的开销。使用 ORM，您可以在显着提高的开发效率与相对较小的性能下降之间进行权衡。

连接池是 orm 的正交问题。最明显的是，hibernate 允许您选择自己的连接池基础结构。

此外，请注意，在实践中，连接池和事务管理之间通常存在相当紧密的耦合。例如，典型的 J2EE 应用程序会将连接池留给容器（通过 JDBC 数据源 API）并依赖于声明性事务。在这种情况下，连接和事务（大约）一起管理。

如果您不在 J2EE 容器中并且不需要 orm，我将简单地比较 C3P0、commons-pool 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T14:14:39.157

如果您使用 Hibernate 自己的连接池，您可以考虑使用[c3p0](http://sourceforge.net/projects/c3p0)吗？（如果您已经在使用 c3p0，我将无能为力）我自己没有使用过 HSQLDB，但我认为这值得一试。

# java - 使用 Apache POI 的 Excel 货币格式

> ID：265136
> 
> 赞同：4
> 
> 时间：2008-11-05T13:30:49.073
> 
> 标签：java, excel, apache-poi

我使用 Apache POI 编写 Excel 表格。我对此非常满意，但我有以下问题：我的程序是多币种和国际化的。在我编写的 Excel 表中，我希望我的货币单元格格式正确。为了那个原因，

我需要一个从 java.util.Currency 和 java 构建正确 Excel 货币格式的例程（例如：“[$$-409]#,##0.00;-[$$-409]#,##0.00”） ..util.Locale 参数。

就像是：`public String getExcelCurrencyFormat(Currency currency, Locale locale);`

有人知道这样的图书馆吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T09:58:47.443

您不能将该字段标记为货币字段，然后让 Excel 找出正确的格式来使用吗？或者 Excel 是否要求您指定生成相关“类型”的格式？

我会建议使用 java.text.NumberFormat.getCurrencyInstance() 但似乎没有办法从对象本身获取实例使用的实际格式（除非 tostring() 返回它）。

在我的头顶上，我想不出还有什么对不起的。

# eclipse - Eclipse Europa 搜索参考功能停止工作

> ID：265138
> 
> 赞同：11
> 
> 时间：2008-11-05T13:31:57.870
> 
> 标签：eclipse, ide, menu, reference

我正在使用 JDK 1.5.0-12 在 MS-Windows 2000 SP4 上使用 Eclipse 版本 3.2.1 Build M20060921-0945。
我将我的语言环境设置为 es-AR，并用我不喜欢的西班牙语设置所有菜单和上下文。所以我在 eclipse.ini 文件中包含了一个参数*"-nl en"*。
从那以后，*“搜索”和上下文菜单中的**“参考...”*功能停止工作。我删除了参数并使用*“-clean”*运行了 eclipse，但仍然无法正常工作。我对正在发生的事情没有任何其他线索。谢谢大家。 将要

 *** * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-10-30T06:47:28.153

删除 eclipse 数据中的所有文件，例如：
`<WORKSPACE>/.metadata/.plugins/org.eclipse.jdt.core`
这应该强制 eclipse 重建其索引

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T22:13:54.270

我看到一个类似的问题，搜索参考（Ctrl + Shift + G）停止工作。如果我**重新启动 Eclipse**，它会再次工作，但它仍然很烦人。我在想也许有一些键盘快捷键我有时不小心打乱了搜索。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-07-06T14:38:45.783

在 Eclipse 的最新 Indigo 版本中遇到了同样的问题，搜索我选择的方法或类的引用总是给出 0 结果。

停止 Eclipse，删除文件夹中的所有文件`<WORKSPACE>/.metadata/.plugins/org.eclipse.jdt.core`，然后重新启动 Eclipse 即可解决。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-11T20:42:53.960

在尝试了以上所有方法但没有任何效果之后，我再次查看了用于文件搜索的文件名模式：*.java *.properties、*.vm、*.xml、*.xsd

我在 .java 之后缺少逗号*，因此 Eclipse 没有搜索我的 .java 文件，它正在寻找与模式“* .java *.properties”匹配的文件。

哇，我是不是觉得笨笨笨呢……加上逗号就解决了！传递我的简单解决方案，以防它对其他人有好处......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-01-22T07:38:03.223

转到 {workspace}.metadata.plugins\org.eclipse.search 并清除 dialog_settings.xml 的 History 部分，为我工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-06-30T20:55:37.457

听起来很奇怪，但键盘映射似乎确实影响了这一点。我已将 -H 映射到在文件中搜索，Java 搜索开始显示所有内容，而不是对我正在搜索的方法的实际引用。~没什么~解决这个问题，包括上面的解决方案。但是将密钥重新映射到打开搜索对话框 DID 修复了它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-10-23T13:34:17.987

我刚刚通过 Eclipse Mars 1 Release 4.5.1 体验了这种行为。仅在特定类别中。清理并构建整个工作区不起作用，但我已经更新了包含该类的 Maven 项目 [右键单击项目 - > Maven - > 更新项目 ...]，它现在可以工作了。

希望它可以帮助某人。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-25T22:18:22.607

我刚刚通过 Eclipse Mars 1 Release 4.5.1 体验了这种行为。

我尝试了上面提到的所有方法，但没有帮助。所以我创建了新的工作区，并导入了项目，搜索又开始工作了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-28T16:36:23.377

我在 Linux Mint 上的 Eclipse 2019-09 R (4.13.0) 中遇到了类似的问题

对我有用的一件事（除了再次关闭和打开 Eclipse）是单击搜索图标，然后单击选项卡上的**Show Previous Search**图标，然后[在 New 中打开](https://i.stack.imgur.com/o9KsW.png)：

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-05T15:12:20.693

垃圾你的安装。

然后重新安装它。

# java - 您是否已经尝试过 Spring Workflow？

> ID：265140
> 
> 赞同：12
> 
> 时间：2008-11-05T13:34:12.077
> 
> 标签：java, spring, workflow

[Spring Workflow](http://www.springsource.org/extensions/se-workflow)现已发布。

*   你试过了吗？适合什么样的场景？
*   你的印象是什么？您如何发现它与其他工作流库相比？
*   找到任何好的文档或教程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T21:37:21.560

好的，忽略我在上一篇文章中显示的信念，我确实尝试了 spring 工作流程，结果发现我是对的。获取源代码和构建并不难，他们使用 svn、ant 和 ivy 作为存储库管理器。

让它发挥作用是另一回事。我获取了示例源，并将它们放在一个新项目中。在这一点上，我不得不重命名所有导入，因为我猜它们是为测试环境而构建的。借助 IDE 在类中的帮助，这很容易，但您还必须在 spring 的 XML 上下文文件中重命名它们。此外，一旦您尝试运行该项目，它就开始看起来很糟糕。首先你得到一个 NullPointerException，因为以下几行：

```
public final void afterPropertiesSet() throws Exception {
    if (this.flowInstanceDescriptorPersisters == null) {
        this.flowInstanceDescriptorPersisters.put(DEFAULT_PERSISTER, new DefaultFlowInstanceDescriptorPersister());
    }
} 
```

我只是创建了一个新的 HashMap，重新构建项目并再次尝试。现在，如果您不包含弹簧安全性，它将在 Assert 处失败。有一个隐藏的依赖项（因为使用了反射）。添加了库。并再次运行它。我遇到了另一个 Assert 失败，当我查看它时，我意识到这些样本甚至不应该工作。一个方法故意返回 null 而它不应该。我去了界面，当然，没有javadoc，但我怀疑它应该从它的名字返回什么，所以我放置了一个硬编码值。此时它会生成并运行但它不起作用，它应该（至少我认为是，没有文档。）进行转换，但在 performTransition 调用之后流程保持不变。

所以你有它。暂时不要尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T12:08:08.440

我不认为尝试它是一个好主意，它只是一个证明这个概念的版本。首先，您必须手动构建您的库，然后在没有示例或文档的情况下学习如何使用它，只需使用几乎没有文档记录的代码和测试代码。当你对它有想法时，你会意识到它现在不能做得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-03T11:00:21.680

parleys.com 上有一个演示文稿：

生产中的 Spring 和 Spring MVC

来自 spring 工作流程的作者：cakesolutions.net

[您可以在http://www.ukinvest.gov.uk/](http://www.ukinvest.gov.uk/)上查看演示文稿以了解他们如何在生产中使用它

# c++ - 将 32 位 VS 2003 项目编译为 64 位

> ID：265146
> 
> 赞同：1
> 
> 时间：2008-11-05T13:37:22.460
> 
> 标签：c++, 64-bit, visual-studio-2003, managed-extensions

我目前有一个 32 位 dll，它是使用 Visual Studio 2003 在 C++ 中使用[Managed Extensions](http://en.wikipedia.org/wiki/Managed_Extensions_for_C%2B%2B)创建的。我现在正在尝试编译 64 位版本，而无需升级到 C++/CLI。我一直在[这个位置](http://www.eggheadcafe.com/forumarchives/vclanguage/Aug2005/post23130822.asp)关注教程。我收到以下错误：

> 致命错误 C1197：无法引用 'c:\windows\microsoft.net\framework\v1.1.4322\mscorlib.dll'，因为程序已经引用了 'c:\windows\microsoft.net\framework\v2.0.50727\mscorlib。 dll'

我不知道是什么引用了 .NET 2.0 版本的 dll。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T13:49:28.630

您是否在代码中手动调用 .dll 文件？像在这个？

```
#using "C:\Windows\Microsoft.NET\Framework\v1.1.4322\mscorlib.dll 
```

如果是这样，您可以将此行更改为：

```
#using "mscorlib.dll" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T15:06:32.433

您是否包含链接到不同版本的 mscorlib 的库？

您是否同时指定 /clr 选项并执行 #using "mscorlib.dll" ？

# java - 你能帮我收集一个 Java 最佳实践在线资料集吗？

> ID：265147
> 
> 赞同：9
> 
> 时间：2008-11-05T13:37:39.340
> 
> 标签：java, reference

我在一个中型开发团队工作，该团队维护一个用 Java 1.4 编写的 8 年以上的 Web 应用程序。

对于新的开发，我总是试图说服人们遵守更新的标准和最佳实践，从简单的事情，比如使用 HtmlImplementation 而不是 HTMLImplementation 等新的命名标准，到为什么针对接口进行编码而不是针对具体类进行编码，支持不变性或对象组合优于类继承。

我[在 Stackoverflow 中发现了这个相当通用的链接](https://stackoverflow.com/questions/82672/best-practices-online-resources)，它既不是面向 Java 的，也不是完整的。

我总是试图解释我的论点背后的基本原理，并且总是建议人们购买最新版本的 Effective Java，但并不是每个开发人员都会毫无疑问地接受我的话（这是一件好事）。

发生这种情况时，他们经常向我询问他们可以在哪里进一步阅读有关该特定良好实践的指示，有时我无法快速找到有关该指示的指示。

您是否有任何指向我可以在“最佳实践”参考“集合”中收集的在线材料的链接，以某种方式我可以随时查找并建议我的队友“进一步阅读”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T13:41:02.657

我真的不认为有任何东西可以与 Effective Java 在同一个联盟中。购买一本书的成本远低于开发人员阅读它（或其他材料）所花费的时间 - 所以我强烈建议去 EJ 而不是试图找到类似的东西。

可能有 Effective Java 的在线版本——我不确定。

我知道这可能不是您想要得到的建议，但我对有效 Java 的质量充满热情 :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T14:05:33.480

[Java Practices](http://www.javapractices.com/home/HomeAction.do) is a great site that I refer to often. It's been favorably compared to Joshua Bloch's Effective Java in the past, and I tend to agree.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T14:08:30.603

Check out these links :

*   [Best Practice Software Engineering](http://best-practice-software-engineering.ifs.tuwien.ac.at/) (more in depth)
*   [Software Engineeting Best Practices](http://prof.tfh-berlin.de/edlich/lecture-results/swt-best-practices/) (lists briefly out some practices and tools by name)

One book (that concentrates mostly on tools worth considering):

*   [Java Power Tools (O'Reilly)](http://oreilly.com/catalog/9780596527938/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T13:50:00.843

我使用 Sun 的[Java BluePrints](http://java.sun.com/reference/blueprints/)作为最佳实践的来源。代码示例用作“这样做”标准文档。命名约定和项目约定是必读的。

那里也有一些设计模式的东西，但更重要的是，它是一个完整的“这样做”示例集。

# perl - 如何将会话管理添加到简单的 Perl CGI 网页？

> ID：265154
> 
> 赞同：3
> 
> 时间：2008-11-05T13:41:15.307
> 
> 标签：perl, session

我有一个简单的网页，到目前为止不需要任何登录。它是用 Perl CGI 编程的。

我想知道添加会话支持以使登录信息可用的步骤。

我不想要很复杂的方法，因为网页很简单。

我还想要一些关于支持 Perl 会话所需的技术/库的建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-05T13:46:11.583

我在很多很多个月前使用过 CGI::Session。

[http://metacpan.org/pod/CGI::Session](http://metacpan.org/pod/CGI::Session)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T16:15:50.457

我使用[Apache::Session](http://metacpan.org/pod/Apache::Session)进行会话管理：

# java - Java 视频播放器

> ID：265160
> 
> 赞同：0
> 
> 时间：2008-11-05T13:45:58.543
> 
> 标签：java, video, buffer, frame, codec

我需要一个不能使用 JMF 的 java api 来播放由 SO 编解码器解释的视频，但我想检索 java 代码中的每一帧。有人知道一些吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T14:24:54.267

看看[FMJ](http://fmj-sf.net/index.php)。它*不需要*[Java 媒体框架](http://java.sun.com/javase/technologies/desktop/media/jmf/)( JMF)。

他们在页面底部有一个[示例](http://fmj-sf.net/ffmpeg-java/getting_started.php)，将视频的前 5 帧写入文件，因此您应该能够访问各个帧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-12T00:56:26.897

FMJ 非常过时，而 JMF 是一个失败的原因（是的，其中之一就是恕我直言）。如果您想要一些可以正常工作并且完全符合您所描述的内容，请尝试 Xuggle。在他们的媒体工具示例中，他们提供了一个使用 AWT / Swing 的简单播放器示例。 [http://xuggle.com/](http://xuggle.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-18T20:07:44.693

如果您对 FFMpeg 周围的 Java 包装器感到满意，请尝试[velvet-video](https://github.com/zakgof/velvet-video)。

从视频文件中提取图像的代码片段：

```
IVelvetVideoLib lib = VelvetVideoLib().getInstance();
try (IDemuxer demuxer = lib.demuxer(new File("/some/path/example.mp4"))) {
    IDecoderVideoStream videoStream = demuxer.videoStream(0);
    IFrame videoFrame;
    while ((videoFrame = videoStream.nextFrame()) != null) {
        BufferedImage image = videoFrame.image();
        // Use image as needed...
    }
} 
```

可以在[此处](https://github.com/zakgof/velvet-video-player)找到使用 velvet-video 实现视频播放器的更高级示例。

免责声明：我是 velvet-video 的作者。

# jquery - 表单提交前jQuery暂停

> ID：265166
> 
> 赞同：1
> 
> 时间：2008-11-05T13:48:30.003
> 
> 标签：jquery

在提交表单之前，我需要暂停 500 毫秒。这是我到目前为止所拥有的：

```
 $(".rowqty input").bind("keyup", function() { $("#ViewCartPage form").animate({ opacity: 1.0 }, 3000).submit() }); 
```

因此，当有人更改输入字段的数量时，它会提交表单，但我希望它等待一小段时间，以防他们需要一点时间来输入 2 或 3 个数字。

正如你所看到的，我尝试了 animate 函数来尝试延迟事情，但没有运气。

我知道我可以使用这个：[http ://blog.mythin.net/projects/jquery.php](http://blog.mythin.net/projects/jquery.php)

如果有办法解决，我宁愿不要在我的网站上添加另一个 JS。

编辑：实际上上面的暂停插件对我也不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T13:51:40.153

试一试：

```
$(".rowqty input").bind("keyup", function() { setTimeout("$('#ViewCartPage form').submit()", 500 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T09:17:55.810

```
setTimeout(function () {$("#formID").submit()},1000); 
```

它对我有用（没有引号）

# .net - 生成带有非托管代码崩溃的转储？

> ID：265171
> 
> 赞同：4
> 
> 时间：2008-11-05T13:51:21.573
> 
> 标签：.net, debugging, dump

当我的应用程序突然崩溃时，有没有办法可以获得完整的崩溃转储？

问题是我怀疑这是由于非托管代码杀死了 .net 框架本身，因此，除非在崩溃时将调试器附加到应用程序，否则应用程序甚至没有机会处理崩溃。

我无法附加调试器并等待，因为崩溃是随机发生的，而且我们安装了许多位置，所以我想知道是否可以在不附加调试器的情况下执行此操作。

编辑：我知道 Microsoft Debugging SDK，而且我也刚刚发现了 DebugDiag。我想这样做而不必每次都附加到应用程序，因为它通常处于销售中间，我没有时间附加调试器并探索堆栈跟踪。DebugDiag 似乎确实让我为此设置了一个规则，但它似乎只适用于已经运行的进程，而不是等待某个进程启动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T14:02:30.287

您可以使用[adplus -crash](http://support.microsoft.com/default.aspx/kb/286350)或[userdump.exe](http://support.microsoft.com/kb/241215)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-23T08:31:05.967

最好的方法是编辑注册表，以便在发生崩溃时调用适当的应用程序来生成转储。因此，在您的情况下，我会让 Watson 博士生成故障转储。

见[链接](http://blogs.technet.com/b/askperf/archive/2007/06/15/capturing-application-crash-dumps.aspx)

基本上编辑注册表项`HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\AeDebug`

设定值

```
Value Name = Auto
Type = String (REG_SZ)
Data Value = 1 or 0\. (Default is 1)
Value Name = Debugger
Type = String (REG_SZ)
Data Value = drwtsn32 -p %ld -e %ld -g 
```

这将在您的应用程序崩溃时调用 Dr. Watson。有关更多详细信息，请参阅本文中的链接，请注意，如果您希望以后不调用 Dr. Watson，则需要将 Auto 值设置为 0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-23T13:25:06.027

为您的程序创建一个通用异常处理程序。在异常处理程序内部编写代码以在所需路径中手动创建转储。

此链接将有助于 [http://brakertech.com/howto-c-generate-dump-file-on-crash/](http://brakertech.com/howto-c-generate-dump-file-on-crash/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T19:58:37.167

debugdiag 是完全[可编写脚本](http://blogs.iis.net/sukesh/archive/2006/06/02/ddintro.aspx)的。当我遇到这样的问题时，我们会让它扫描某些进程名称，并自动附加。

# java - JSF 如何生成表单输入字段的名称？

> ID：265175
> 
> 赞同：4
> 
> 时间：2008-11-05T13:54:46.933
> 
> 标签：java, jsf

有人知道吗？是否可以指定表单输入字段的名称？该怎么做呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T15:50:37.463

如前所述，HTML 名称和 id 属性由命名容器生成并基于应用程序名称空间。当控件是重复控件的子项（例如 a `UIData`）或 JSP 在一个页面中呈现两次（例如在 portlet 环境中）时，这可以防止冲突。呈现给 HTML 的 id 是**clientId**。

可以手动硬编码或构建`clientId`，但这是一种非常脆弱的方法。最好使用组件的*getClientId(FacesContext)*方法；这是渲染器使用的。

一个可以获取`clientId`绑定组件的 bean：

```
/** Request scope */
public class IdBean implements Serializable {
  private UIComponent mytext;

  public String getClientId() {
    return mytext.getClientId(FacesContext.getCurrentInstance());
  }

  public UIComponent getMytext() { return mytext; }
  public void setMytext(UIComponent mytext) { this.mytext = mytext; }

  public List<String> getRows() {
    List<String> rows = new ArrayList<String>();
    for (int i = 0; i < 10; i++) {
      rows.add("row" + i);
    }
    return rows;
  }
} 
```

风景：

```
 <f:view>
    <h:form>
      <h:dataTable value="#{idBean.rows}" var="row">
        <h:column>
          <h:outputLabel value="#{row}" />
          <h:inputText binding="#{idBean.mytext}"
            onclick="foo('#{idBean.clientId}');" />
        </h:column>
      </h:dataTable>
    </h:form>
  </f:view>

  <script type="text/javascript">
    function foo(name) {
        alert('You clicked '+name);
    }
  </script> 
```

*mytext*控件呈现 10 次，因此任何发出其名称的代码也必须是 dataTable 的子级。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T14:09:49.757

更一般地说，所有 JSF 组件都有一个 ID。如果您不提供，JSF 将创建一个自动 ID，使用格式 j `_`idXXX（*XXX*是一个递增的数字）。

一些组件实现了 javax.faces.component.NamingContainer 接口，特别是`<h:form>`. 这意味着该组件的所有子组件的 ID 都会以该容器的 ID 为前缀，并以“:”分隔。因此，在示例中：

```
<h:form id="myForm">
    <h:inputText id="myInput" .../>
</h:form> 
```

输入的*真实*ID（即 HTML 输入对象的 ID）将是**myForm:myInput**。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T14:01:31.007

它生成为 formId:fieldId

因此，如果您有以下情况：

```
<h:form id="searchForm">
   <h:inputText id="searchField" ... />
</h:form> 
```

搜索字段的名称（和 HTML ID）将是：

搜索表单：搜索字段

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T20:52:44.063

对于包含视图、表单和某些组件的大多数页面，clientID 将是包含 form-id 和 component-id 的冒号分隔的字符串。例子：

输入文本客户端 ID 将是“myForm:myInputText”。如果您嵌套在子视图中，那么这将是列表中的第一件事，例如：

现在输入文本客户端 ID 将是“mySubview:myForm:myInputText”。

# security - 从一个应用程序远程发布到另一个应用程序。安全问题？

> ID：265180
> 
> 赞同：0
> 
> 时间：2008-11-05T13:56:53.013
> 
> 标签：security, ipc, messaging

如果让我们在一个应用程序中向另一个应用程序隐藏帖子以使用该应用程序功能，是否存在任何安全问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T14:03:08.693

要看。您是否使用某种身份验证和加密？

这可能会导致许多安全问题。尽管您可以说许多实现。大多数配置不当的东西都可能是一个安全问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T14:14:48.983

将其他应用程序的功能包装在 Web 服务中会更好。这将使您与被调用应用程序界面中的任何更改（例如表单主体中的其他元素）隔离一小层。

也就是说，正如另一个答案中所述，身份验证和加密很重要。但是，它实际上不会比直接通过其 UI 使用其他应用程序更安全。

编辑：至少有一种情况会导致新场景不如旧场景安全。如果被调用的应用程序对输入数据使用纯粹的客户端验证（坏主意），那么在进行交叉发布时，您将不得不重复该验证。

# php - 在 PHP 中随机化正则表达式

> ID：265185
> 
> 赞同：0
> 
> 时间：2008-11-05T13:59:11.667
> 
> 标签：php, regex

基本上我想使用正则表达式来抓取文档段落之间的内容。我认为表达方式是：

```
<p>.+?</p> 
```

假设它使用这个 RegEx 抓取 10 个项目，然后我希望 PHP 随机选择其中一个，然后将其保存到一个变量中。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T14:05:25.243

```
// Test data
$str = '<p>a1</p><p>b2</p><p>c3</p><p>d4</p>';

// Pull out all the paragraph contents into $matches
preg_match_all('_<p>(.+?)</p>_is', $str, $matches);

// $matches[0] contains all the <p>....</p>
// $matches[1] contains the first group, i.e. our (.+?)
// Echo a random one
echo $matches[1][array_rand($matches[1])]; 
```

# c# - 从 SqlCommand 对象中获取生成的 SQL 语句？

> ID：265192
> 
> 赞同：212
> 
> 时间：2008-11-05T14:01:34.563
> 
> 标签：c#, vb.net, ado.net

我有以下代码：

```
Using cmd As SqlCommand = Connection.CreateCommand
    cmd.CommandText = "UPDATE someTable SET Value = @Value"
    cmd.CommandText &= " WHERE Id = @Id"
    cmd.Parameters.AddWithValue("@Id", 1234)
    cmd.Parameters.AddWithValue("@Value", "myValue")
    cmd.ExecuteNonQuery
End Using 
```

我想知道是否有任何方法可以将最终的 SQL 语句作为字符串获取，它应该如下所示：

```
UPDATE someTable SET Value = "myValue" WHERE Id = 1234 
```

如果有人想知道我为什么要这样做：

*   用于记录（失败）语句
*   可以将其复制并粘贴到企业管理器以进行测试

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2008-11-05T14:24:32.350

出于记录目的，恐怕没有更好的方法可以做到这一点，而是自己构造字符串：

```
string query = cmd.CommandText;

foreach (SqlParameter p in cmd.Parameters)
{
    query = query.Replace(p.ParameterName, p.Value.ToString());
} 
```

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2010-11-10T16:22:34.313

虽然不完美，但这是我为 TSQL 敲定的一些东西 - 可以很容易地调整为其他口味......如果没有别的，它会给你一个起点，让你自己改进 :)

这在数据类型和输出参数等方面做得很好，类似于在 SSMS 中使用“执行存储过程”。我们主要使用 SP，因此“文本”命令不考虑参数等

```
 public static String ParameterValueForSQL(this SqlParameter sp)
    {
        String retval = "";

        switch (sp.SqlDbType)
        {
            case SqlDbType.Char:
            case SqlDbType.NChar:
            case SqlDbType.NText:
            case SqlDbType.NVarChar:
            case SqlDbType.Text:
            case SqlDbType.Time:
            case SqlDbType.VarChar:
            case SqlDbType.Xml:
            case SqlDbType.Date:
            case SqlDbType.DateTime:
            case SqlDbType.DateTime2:
            case SqlDbType.DateTimeOffset:
                retval = "'" + sp.Value.ToString().Replace("'", "''") + "'";
                break;

            case SqlDbType.Bit:
                retval = (sp.Value.ToBooleanOrDefault(false)) ? "1" : "0";
                break;

            default:
                retval = sp.Value.ToString().Replace("'", "''");
                break;
        }

        return retval;
    }

    public static String CommandAsSql(this SqlCommand sc)
    {
        StringBuilder sql = new StringBuilder();
        Boolean FirstParam = true;

        sql.AppendLine("use " + sc.Connection.Database + ";");
        switch (sc.CommandType)
        {
            case CommandType.StoredProcedure:
                sql.AppendLine("declare @return_value int;");

                foreach (SqlParameter sp in sc.Parameters)
                {
                    if ((sp.Direction == ParameterDirection.InputOutput) || (sp.Direction == ParameterDirection.Output))
                    {
                        sql.Append("declare " + sp.ParameterName + "\t" + sp.SqlDbType.ToString() + "\t= ");

                        sql.AppendLine(((sp.Direction == ParameterDirection.Output) ? "null" : sp.ParameterValueForSQL()) + ";");

                    }
                }

                sql.AppendLine("exec [" + sc.CommandText + "]");

                foreach (SqlParameter sp in sc.Parameters)
                {
                    if (sp.Direction != ParameterDirection.ReturnValue)
                    {
                        sql.Append((FirstParam) ? "\t" : "\t, ");

                        if (FirstParam) FirstParam = false;

                        if (sp.Direction == ParameterDirection.Input)
                            sql.AppendLine(sp.ParameterName + " = " + sp.ParameterValueForSQL());
                        else

                            sql.AppendLine(sp.ParameterName + " = " + sp.ParameterName + " output");
                    }
                }
                sql.AppendLine(";");

                sql.AppendLine("select 'Return Value' = convert(varchar, @return_value);");

                foreach (SqlParameter sp in sc.Parameters)
                {
                    if ((sp.Direction == ParameterDirection.InputOutput) || (sp.Direction == ParameterDirection.Output))
                    {
                        sql.AppendLine("select '" + sp.ParameterName + "' = convert(varchar, " + sp.ParameterName + ");");
                    }
                }
                break;
            case CommandType.Text:
                sql.AppendLine(sc.CommandText);
                break;
        }

        return sql.ToString();
    } 
```

这会产生这些方面的输出......

```
use dbMyDatabase;
declare @return_value int;
declare @OutTotalRows   BigInt  = null;
exec [spMyStoredProc]
    @InEmployeeID = 1000686
    , @InPageSize = 20
    , @InPage = 1
    , @OutTotalRows = @OutTotalRows output
;
select 'Return Value' = convert(varchar, @return_value);
select '@OutTotalRows' = convert(varchar, @OutTotalRows); 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2008-11-05T14:21:12.013

你不能，因为它不会生成任何 SQL。

参数化查询（中的查询`CommandText`）作为准备好的语句发送到 SQL Server。执行命令时，参数和查询文本将分开处理。任何时候都不会生成完整的 SQL 字符串。

您可以使用 SQL Profiler 查看幕后情况。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2013-07-21T21:34:58.427

我需要一个类似于字符串转换器的命令来允许更详细的日志记录，所以我写了这个。它将生成在新会话中重新执行命令所需的文本，包括输出参数和结构化参数。它经过了轻微的测试，但需要注意的是。

例子：

```
SqlCommand cmd = new SqlCommand("GetEntity", con);
cmd.Parameters.AddWithValue("@foobar", 1);
cmd.Parameters.Add(new SqlParameter(){
    ParameterName = "@outParam",
    Direction = ParameterDirection.Output,
    SqlDbType = System.Data.SqlDbType.Int
});
cmd.Parameters.Add(new SqlParameter(){
    Direction = ParameterDirection.ReturnValue
});
cmd.CommandType = CommandType.StoredProcedure; 
```

将产生：

```
-- BEGIN COMMAND
DECLARE @foobar INT = 1;
DECLARE @outParam INT = NULL;
DECLARE @returnValue INT;
-- END PARAMS
EXEC @returnValue = GetEntity @foobar = @foobar, @outParam = @outParam OUTPUT
-- RESULTS
SELECT 1 as Executed, @returnValue as ReturnValue, @outParam as [@outParam];
-- END COMMAND 
```

执行：

```
public class SqlCommandDumper
{
    public static string GetCommandText(SqlCommand sqc)
    {
        StringBuilder sbCommandText = new StringBuilder();

        sbCommandText.AppendLine("-- BEGIN COMMAND");

        // params
        for (int i = 0; i < sqc.Parameters.Count; i++)
            logParameterToSqlBatch(sqc.Parameters[i], sbCommandText);
        sbCommandText.AppendLine("-- END PARAMS");

        // command
        if (sqc.CommandType == CommandType.StoredProcedure)
        {
            sbCommandText.Append("EXEC ");

            bool hasReturnValue = false;
            for (int i = 0; i < sqc.Parameters.Count; i++)
            {
                if (sqc.Parameters[i].Direction == ParameterDirection.ReturnValue)
                    hasReturnValue = true;
            }
            if (hasReturnValue)
            {
                sbCommandText.Append("@returnValue = ");
            }

            sbCommandText.Append(sqc.CommandText);

            bool hasPrev = false;
            for (int i = 0; i < sqc.Parameters.Count; i++)
            {
                var cParam = sqc.Parameters[i];
                if (cParam.Direction != ParameterDirection.ReturnValue)
                {
                    if (hasPrev)
                        sbCommandText.Append(",");
                    sbCommandText.Append(" ");

                    sbCommandText.Append(cParam.ParameterName);
                    sbCommandText.Append(" = ");
                    sbCommandText.Append(cParam.ParameterName);

                    if (cParam.Direction.HasFlag(ParameterDirection.Output))
                        sbCommandText.Append(" OUTPUT");

                    hasPrev = true;
                }
            }
        }
        else
        {
            sbCommandText.AppendLine(sqc.CommandText);
        }

        sbCommandText.AppendLine("-- RESULTS");
        sbCommandText.Append("SELECT 1 as Executed");
        for (int i = 0; i < sqc.Parameters.Count; i++)
        {
            var cParam = sqc.Parameters[i];

            if (cParam.Direction == ParameterDirection.ReturnValue)
            {
                sbCommandText.Append(", @returnValue as ReturnValue");
            }
            else if (cParam.Direction.HasFlag(ParameterDirection.Output))
            {
                sbCommandText.Append(", ");
                sbCommandText.Append(cParam.ParameterName);
                sbCommandText.Append(" as [");
                sbCommandText.Append(cParam.ParameterName);
                sbCommandText.Append(']');
            }
        }
        sbCommandText.AppendLine(";");

        sbCommandText.AppendLine("-- END COMMAND");
        return sbCommandText.ToString();
    }

    private static void logParameterToSqlBatch(SqlParameter param, StringBuilder sbCommandText)
    {
        sbCommandText.Append("DECLARE ");
        if (param.Direction == ParameterDirection.ReturnValue)
        {
            sbCommandText.AppendLine("@returnValue INT;");
        }
        else
        {
            sbCommandText.Append(param.ParameterName);

            sbCommandText.Append(' ');
            if (param.SqlDbType != SqlDbType.Structured)
            {
                logParameterType(param, sbCommandText);
                sbCommandText.Append(" = ");
                logQuotedParameterValue(param.Value, sbCommandText);

                sbCommandText.AppendLine(";");
            }
            else
            {
                logStructuredParameter(param, sbCommandText);
            }
        }
    }

    private static void logStructuredParameter(SqlParameter param, StringBuilder sbCommandText)
    {
        sbCommandText.AppendLine(" {List Type};");
        var dataTable = (DataTable)param.Value;

        for (int rowNo = 0; rowNo < dataTable.Rows.Count; rowNo++)
        {
            sbCommandText.Append("INSERT INTO ");
            sbCommandText.Append(param.ParameterName);
            sbCommandText.Append(" VALUES (");

            bool hasPrev = false;
            for (int colNo = 0; colNo < dataTable.Columns.Count; colNo++)
            {
                if (hasPrev)
                {
                    sbCommandText.Append(", ");
                }
                logQuotedParameterValue(dataTable.Rows[rowNo].ItemArray[colNo], sbCommandText);
                hasPrev = true;
            }
            sbCommandText.AppendLine(");");
        }
    }

    const string DATETIME_FORMAT_ROUNDTRIP = "o";
    private static void logQuotedParameterValue(object value, StringBuilder sbCommandText)
    {
        try
        {
            if (value == null)
            {
                sbCommandText.Append("NULL");
            }
            else
            {
                value = unboxNullable(value);

                if (value is string
                    || value is char
                    || value is char[]
                    || value is System.Xml.Linq.XElement
                    || value is System.Xml.Linq.XDocument)
                {
                    sbCommandText.Append("N'");
                    sbCommandText.Append(value.ToString().Replace("'", "''"));
                    sbCommandText.Append('\'');
                }
                else if (value is bool)
                {
                    // True -> 1, False -> 0
                    sbCommandText.Append(Convert.ToInt32(value));
                }
                else if (value is sbyte
                    || value is byte
                    || value is short
                    || value is ushort
                    || value is int
                    || value is uint
                    || value is long
                    || value is ulong
                    || value is float
                    || value is double
                    || value is decimal)
                {
                    sbCommandText.Append(value.ToString());
                }
                else if (value is DateTime)
                {
                    // SQL Server only supports ISO8601 with 3 digit precision on datetime,
                    // datetime2 (>= SQL Server 2008) parses the .net format, and will 
                    // implicitly cast down to datetime.
                    // Alternatively, use the format string "yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fffK"
                    // to match SQL server parsing
                    sbCommandText.Append("CAST('");
                    sbCommandText.Append(((DateTime)value).ToString(DATETIME_FORMAT_ROUNDTRIP));
                    sbCommandText.Append("' as datetime2)");
                }
                else if (value is DateTimeOffset)
                {
                    sbCommandText.Append('\'');
                    sbCommandText.Append(((DateTimeOffset)value).ToString(DATETIME_FORMAT_ROUNDTRIP));
                    sbCommandText.Append('\'');
                }
                else if (value is Guid)
                {
                    sbCommandText.Append('\'');
                    sbCommandText.Append(((Guid)value).ToString());
                    sbCommandText.Append('\'');
                }
                else if (value is byte[])
                {
                    var data = (byte[])value;
                    if (data.Length == 0)
                    {
                        sbCommandText.Append("NULL");
                    }
                    else
                    {
                        sbCommandText.Append("0x");
                        for (int i = 0; i < data.Length; i++)
                        {
                            sbCommandText.Append(data[i].ToString("x"));
                        }
                    }
                }
                else
                {
                    sbCommandText.Append("/* UNKNOWN DATATYPE: ");
                    sbCommandText.Append(value.GetType().ToString());
                    sbCommandText.Append(" *" + "/ N'");
                    sbCommandText.Append(value.ToString());
                    sbCommandText.Append('\'');
                }
            }
        }

        catch (Exception ex)
        {
            sbCommandText.AppendLine("/* Exception occurred while converting parameter: ");
            sbCommandText.AppendLine(ex.ToString());
            sbCommandText.AppendLine("*/");
        }
    }

    private static object unboxNullable(object value)
    {
        var typeOriginal = value.GetType();
        if (typeOriginal.IsGenericType
            && typeOriginal.GetGenericTypeDefinition() == typeof(Nullable<>))
        {
            // generic value, unboxing needed
            return typeOriginal.InvokeMember("GetValueOrDefault",
                System.Reflection.BindingFlags.Public |
                System.Reflection.BindingFlags.Instance |
                System.Reflection.BindingFlags.InvokeMethod,
                null, value, null);
        }
        else
        {
            return value;
        }
    }

    private static void logParameterType(SqlParameter param, StringBuilder sbCommandText)
    {
        switch (param.SqlDbType)
        {
            // variable length
            case SqlDbType.Char:
            case SqlDbType.NChar:
            case SqlDbType.Binary:
                {
                    sbCommandText.Append(param.SqlDbType.ToString().ToUpper());
                    sbCommandText.Append('(');
                    sbCommandText.Append(param.Size);
                    sbCommandText.Append(')');
                }
                break;
            case SqlDbType.VarBinary:
            case SqlDbType.Image:
                    {
                            sbCommandText.Append("VARBINARY");
                            sbCommandText.Append("(MAX /* Specified as ");
                            sbCommandText.Append(param.Size);
                            sbCommandText.Append(" */)");
                    }
                    break;
            case SqlDbType.VarChar:
            case SqlDbType.Text:
                    {
                            sbCommandText.Append("VARCHAR");
                            sbCommandText.Append("(MAX /* Specified as ");
                            sbCommandText.Append(param.Size);
                            sbCommandText.Append(" */)");
                    }
                    break;
            case SqlDbType.NVarChar:
            case SqlDbType.NText:
                    {
                            sbCommandText.Append("NVARCHAR");
                            sbCommandText.Append("(MAX /* Specified as ");
                            sbCommandText.Append(param.Size);
                            sbCommandText.Append(" */)");
                    }
                    break;
            // fixed length
            case SqlDbType.Bit:
            case SqlDbType.TinyInt:
            case SqlDbType.SmallInt:
            case SqlDbType.Int:
            case SqlDbType.BigInt:
            case SqlDbType.SmallMoney:
            case SqlDbType.Money:
            case SqlDbType.Decimal:
            case SqlDbType.Real:
            case SqlDbType.Float:
            case SqlDbType.Date:
            case SqlDbType.DateTime:
            case SqlDbType.DateTime2:
            case SqlDbType.DateTimeOffset:
            case SqlDbType.UniqueIdentifier:
                {
                    sbCommandText.Append(param.SqlDbType.ToString().ToUpper());
                }
                break;
            // Unknown
            case SqlDbType.Timestamp:
            default:
                {
                    sbCommandText.Append("/* UNKNOWN DATATYPE: ");
                    sbCommandText.Append(param.SqlDbType.ToString().ToUpper());
                    sbCommandText.Append(" *" + "/ ");
                    sbCommandText.Append(param.SqlDbType.ToString().ToUpper());
                }
                break;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-09-02T11:27:16.877

我也有这个问题，其中一些参数化查询或 sp 会给我一个 SqlException（主要是字符串或二进制数据将被截断），以及难以调试的语句（据我所知，目前没有 sql-profiler 支持SQL Azure)

我在这里看到很多反应中的类似代码。我最终将我的解决方案放在一个 Sql-Library 项目中以备将来使用。

生成器可在此处获得： [https ://github.com/jeroenpot/SqlHelper/blob/master/Source/Mirabeau.MsSql.Library/SqlGenerator.cs](https://github.com/jeroenpot/SqlHelper/blob/master/Source/Mirabeau.MsSql.Library/SqlGenerator.cs)

它同时支持 CommandType.Text 和 CommandType.StoredProcedure

如果您安装了[nuget-package](https://www.nuget.org/packages/MsSqlHelper)，您可以使用以下语句生成它：

```
SqlDebugHelper.CreateExecutableSqlStatement(sql, parameters); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-05T14:18:27.243

如果您使用的是 SQL Server，则可以使用 SQL Server Profiler（如果有）来查看实际执行的命令字符串。这对于复制/粘贴测试目的很有用，但恐怕不适用于日志记录。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-05-22T21:07:25.807

迟到的答案，我知道，但我也想要这个，所以我可以记录 SQL。以下内容很简短，符合我的需要。

以下生成 SQL，您可以在 SSMS 中复制/粘贴（它将参数正确替换为值）。您可以添加更多类型，但这符合我在这种情况下使用的所有类型。

```
 private static void LogSQL(SqlCommand cmd)
        {
            string query = cmd.CommandText;

            foreach (SqlParameter prm in cmd.Parameters)
            {
                switch (prm.SqlDbType)
                {
                    case SqlDbType.Bit:
                        int boolToInt = (bool)prm.Value ? 1 : 0;
                        query = query.Replace(prm.ParameterName, string.Format("{0}", (bool)prm.Value ? 1 : 0));
                        break;
                    case SqlDbType.Int:
                        query = query.Replace(prm.ParameterName, string.Format("{0}", prm.Value));
                        break;
                    case SqlDbType.VarChar:
                        query = query.Replace(prm.ParameterName, string.Format("'{0}'", prm.Value));
                        break;
                    default:
                        query = query.Replace(prm.ParameterName, string.Format("'{0}'", prm.Value));
                        break;
                }
            }

            // the following is my how I write to my log - your use will vary
            logger.Debug("{0}", query);

            return;
        } 
```

现在我可以在执行 SQL 之前记录它：

```
LogSQL(queryCmd)
queryCmd.ExecuteNonQuery() 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-05T14:23:43.350

Profiler 无疑是您的最佳选择。

由于涉及到准备 + 执行步骤，您可能需要从分析器复制一组语句。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-02-21T15:47:01.257

我有同样的确切问题，在阅读了这些回复后，我错误地决定无法获得确切的结果查询。我错了。

**解决方案：**`Activity Monitor`在 中 打开`SQL Server Management Studio`，将进程部分缩小到您的应用程序在连接字符串中使用的登录用户名、数据库或应用程序名称。当调用 db refresh 时`Activity Monitor`。当您看到该过程时，右键单击它并`View Details`.

请注意，对于繁忙的数据库，这可能不是一个可行的选择。但是您应该能够使用这些步骤大大缩小结果范围。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-06-03T21:14:38.433

在我的解决方案中使用了[Flapper 的部分代码](https://stackoverflow.com/a/4146573/)，它返回整个 SQL 字符串，包括要在 MS SQL SMS 中运行的参数值。

```
public string ParameterValueForSQL(SqlParameter sp)
    {
        string retval = "";

        switch (sp.SqlDbType)
        {
            case SqlDbType.Char:
            case SqlDbType.NChar:
            case SqlDbType.NText:
            case SqlDbType.NVarChar:
            case SqlDbType.Text:
            case SqlDbType.Time:
            case SqlDbType.VarChar:
            case SqlDbType.Xml:
            case SqlDbType.Date:
            case SqlDbType.DateTime:
            case SqlDbType.DateTime2:
            case SqlDbType.DateTimeOffset:
                if (sp.Value == DBNull.Value)
                {
                    retval = "NULL";
                }
                else
                {
                    retval = "'" + sp.Value.ToString().Replace("'", "''") + "'";
                }
                break;

            case SqlDbType.Bit:
                if (sp.Value == DBNull.Value)
                {
                    retval = "NULL";
                }
                else
                {
                    retval = ((bool)sp.Value == false) ? "0" : "1";
                }
                break;

            default:
                if (sp.Value == DBNull.Value)
                {
                    retval = "NULL";
                }
                else
                {
                    retval = sp.Value.ToString().Replace("'", "''");
                }
                break;
        }

        return retval;
    }

    public string CommandAsSql(SqlCommand sc)
    {
        string sql = sc.CommandText;

        sql = sql.Replace("\r\n", "").Replace("\r", "").Replace("\n", "");
        sql = System.Text.RegularExpressions.Regex.Replace(sql, @"\s+", " ");

        foreach (SqlParameter sp in sc.Parameters)
        {
            string spName = sp.ParameterName;
            string spValue = ParameterValueForSQL(sp);
            sql = sql.Replace(spName, spValue);
        }

        sql = sql.Replace("= NULL", "IS NULL");
        sql = sql.Replace("!= NULL", "IS NOT NULL");
        return sql;
    } 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-06-15T18:12:45.040

我的解决方案：

```
public static class DbHelper
{
    public static string ToString(this DbParameterCollection parameters, string sqlQuery)
    {
        return parameters.Cast<DbParameter>().Aggregate(sqlQuery, (current, p) => current.Replace(p.ParameterName, p.Value.ToString()));
    }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-07-28T16:20:30.767

我为我写了这个方法。我使用了[Bruno Ratnieks 的](https://forums.asp.net/t/1351973.aspx?How+to+view+a+cmd+CommandText+with+parameters+value+in+debugger)部分代码。也许它对某人有用。

```
 public static string getQueryFromCommand(SqlCommand cmd)
    {
        StringBuilder CommandTxt = new StringBuilder();
        CommandTxt.Append("DECLARE ");
        List<string> paramlst = new List<string>();
        foreach (SqlParameter parms in cmd.Parameters)
        {
            paramlst.Add(parms.ParameterName);
            CommandTxt.Append(parms.ParameterName + " AS ");
            CommandTxt.Append(parms.SqlDbType.ToString());
            CommandTxt.Append(",");
        }

        if (CommandTxt.ToString().Substring(CommandTxt.Length-1, 1) == ",")
            CommandTxt.Remove(CommandTxt.Length-1, 1);
        CommandTxt.AppendLine();
        int rownr = 0;
        foreach (SqlParameter parms in cmd.Parameters)
        {
            string val = String.Empty;
            if (parms.DbType.Equals(DbType.String) || parms.DbType.Equals(DbType.DateTime))
                val = "'" + Convert.ToString(parms.Value).Replace(@"\", @"\\").Replace("'", @"\'") + "'";
            if (parms.DbType.Equals(DbType.Int16) || parms.DbType.Equals(DbType.Int32) || parms.DbType.Equals(DbType.Int64) || parms.DbType.Equals(DbType.Decimal) || parms.DbType.Equals(DbType.Double))
                val = Convert.ToString(parms.Value);

            CommandTxt.AppendLine();
            CommandTxt.Append("SET " + paramlst[rownr].ToString() + " = " + val.ToString());
            rownr += 1;
        }
        CommandTxt.AppendLine();
        CommandTxt.AppendLine();
        CommandTxt.Append(cmd.CommandText);
        return CommandTxt.ToString();
    } 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-01-16T19:13:17.440

如果您的数据库是 Oracle 并且 sql 文本包含命名的动态变量，`:1,:2 ,...`那么您可以使用：

```
string query = cmd.CommandText;
int i = 1;
foreach (OracleParameter p in cmd.Parameters)
  {
    query = query.Replace(":"+i.ToString(),((p.Value==null)?"":p.Value.ToString()));
    i++;
  } 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-01-16T15:49:52.017

如果只是检查结果查询中参数的格式，大多数 DBMS 将允许从无到有查询文字。因此：

```
Using cmd As SqlCommand = Connection.CreateCommand
    cmd.CommandText = "SELECT @Value"
    cmd.Parameters.AddWithValue("@Value", "myValue")
    Return cmd.ExecuteScalar
End Using 
```

这样你就可以看到引号是否加倍，等等。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-09-25T16:45:45.707

这是我用来将存储过程的参数列表输出到调试控制台的方法：

```
string query = (from SqlParameter p in sqlCmd.Parameters where p != null where p.Value != null select string.Format("Param: {0} = {1},  ", p.ParameterName, p.Value.ToString())).Aggregate(sqlCmd.CommandText, (current, parameter) => current + parameter);
Debug.WriteLine(query); 
```

这将生成一个与此类似的控制台输出：

```
Customer.prGetCustomerDetails: @Offset = 1,  Param: @Fetch = 10,  Param: @CategoryLevel1ID = 3,  Param: @VehicleLineID = 9,  Param: @SalesCode1 = bce, 
```

我将此代码直接放在我希望调试的任何过程下方，它类似于 sql profiler 会话，但在 C# 中。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-03-16T20:52:59.423

[Kon 答案的](https://stackoverflow.com/a/265261)修改版本，因为它仅部分适用于类似的命名参数。使用字符串替换功能的缺点。除此之外，我完全相信他的解决方案。

```
private string GetActualQuery(SqlCommand sqlcmd)
{
    string query = sqlcmd.CommandText;
    string parameters = "";
    string[] strArray = System.Text.RegularExpressions.Regex.Split(query, " VALUES ");

    //Reconstructs the second half of the SQL Command
    parameters = "(";

    int count = 0;
    foreach (SqlParameter p in sqlcmd.Parameters)
    {
        if (count == (sqlcmd.Parameters.Count - 1))
        {
            parameters += p.Value.ToString();
        }
        else
        {
            parameters += p.Value.ToString() + ", ";
        }
        count++;
    }

    parameters += ")";

    //Returns the string recombined.
    return strArray[0] + " VALUES " + parameters;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-04-06T08:45:03.167

这个解决方案现在对我有用。也许它对某人有用。请原谅所有的冗余。

```
 Public Shared Function SqlString(ByVal cmd As SqlCommand) As String
    Dim sbRetVal As New System.Text.StringBuilder()
    For Each item As SqlParameter In cmd.Parameters
        Select Case item.DbType
            Case DbType.String
                sbRetVal.AppendFormat("DECLARE {0} AS VARCHAR(255)", item.ParameterName)
                sbRetVal.AppendLine()
                sbRetVal.AppendFormat("SET {0} = '{1}'", item.ParameterName, item.Value)
                sbRetVal.AppendLine()

            Case DbType.DateTime
                sbRetVal.AppendFormat("DECLARE {0} AS DATETIME", item.ParameterName)
                sbRetVal.AppendLine()
                sbRetVal.AppendFormat("SET {0} = '{1}'", item.ParameterName, item.Value)
                sbRetVal.AppendLine()

            Case DbType.Guid
                sbRetVal.AppendFormat("DECLARE {0} AS UNIQUEIDENTIFIER", item.ParameterName)
                sbRetVal.AppendLine()
                sbRetVal.AppendFormat("SET {0} = '{1}'", item.ParameterName, item.Value)
                sbRetVal.AppendLine()

            Case DbType.Int32
                sbRetVal.AppendFormat("DECLARE {0} AS int", item.ParameterName)
                sbRetVal.AppendLine()
                sbRetVal.AppendFormat("SET {0} = {1}", item.ParameterName, item.Value)
                sbRetVal.AppendLine()

            Case Else
                Stop

        End Select
    Next

    sbRetVal.AppendLine("")
    sbRetVal.AppendLine(cmd.CommandText)

    Return sbRetVal.ToString()
End Function 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-07-15T13:02:35.100

正如@pkExec 和@Alok 提到的，使用 Replace 在 100% 的情况下不起作用。这是我在 DAL 中使用的解决方案，它使用 RegExp 仅“匹配整个单词”并正确格式化数据类型。因此生成的 SQL 可以直接在 MySQL Workbench（或 SQLSMS 等）中进行测试 :)

（根据使用的 DBMS 替换 MySQLHelper.EscapeString() 函数。）

```
Dim query As String = cmd.CommandText
query = query.Replace("SET", "SET" & vbNewLine)
query = query.Replace("WHERE", vbNewLine & "WHERE")
query = query.Replace("GROUP BY", vbNewLine & "GROUP BY")
query = query.Replace("ORDER BY", vbNewLine & "ORDER BY")
query = query.Replace("INNER JOIN", vbNewLine & "INNER JOIN")
query = query.Replace("LEFT JOIN", vbNewLine & "LEFT JOIN")
query = query.Replace("RIGHT JOIN", vbNewLine & "RIGHT JOIN")
If query.Contains("UNION ALL") Then
    query = query.Replace("UNION ALL", vbNewLine & "UNION ALL" & vbNewLine)
ElseIf query.Contains("UNION DISTINCT") Then
    query = query.Replace("UNION DISTINCT", vbNewLine & "UNION DISTINCT" & vbNewLine)
Else
    query = query.Replace("UNION", vbNewLine & "UNION" & vbNewLine)
End If

For Each par In cmd.Parameters
    If par.Value Is Nothing OrElse IsDBNull(par.Value) Then
        query = RegularExpressions.Regex.Replace(query, par.ParameterName & "\b", "NULL")
    ElseIf TypeOf par.Value Is Date Then
        query = RegularExpressions.Regex.Replace(query, par.ParameterName & "\b", "'" & Format(par.Value, "yyyy-MM-dd HH:mm:ss") & "'")
    ElseIf TypeOf par.Value Is TimeSpan Then
        query = RegularExpressions.Regex.Replace(query, par.ParameterName & "\b", "'" & par.Value.ToString & "'")
    ElseIf TypeOf par.Value Is Double Or TypeOf par.Value Is Decimal Or TypeOf par.Value Is Single Then
        query = RegularExpressions.Regex.Replace(query, par.ParameterName & "\b", Replace(par.Value.ToString, ",", "."))
    ElseIf TypeOf par.Value Is Integer Or TypeOf par.Value Is UInteger Or TypeOf par.Value Is Long Or TypeOf par.Value Is ULong Then
        query = RegularExpressions.Regex.Replace(query, par.ParameterName & "\b", par.Value.ToString)
    Else
        query = RegularExpressions.Regex.Replace(query, par.ParameterName & "\b", "'" & MySqlHelper.EscapeString(CStr(par.Value)) & "'")
    End If
Next 
```

例子：

```
SELECT * FROM order WHERE order_status = @order_status AND order_date = @order_date 
```

将生成：

```
SELECT * FROM order WHERE order_status = 'C' AND order_date = '2015-01-01 00:00:00' 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-12-06T10:43:40.103

sql 命令查询将使用 exec sp_executesql 执行，因此这是另一种将语句作为字符串获取的方法（SqlCommand 扩展方法）：

```
public static string ToSqlStatement(this SqlCommand cmd)
{
    return $@"EXECUTE sp_executesql N'{cmd.CommandText.Replace("'", "''")}'{cmd.Parameters.ToSqlParameters()}";
}

private static string ToSqlParameters(this SqlParameterCollection col)
{
    if (col.Count == 0)
        return string.Empty;
    var parameters = new List<string>();
    var parameterValues = new List<string>();
    foreach (SqlParameter param in col)
    {
        parameters.Add($"{param.ParameterName}{param.ToSqlParameterType()}");
        parameterValues.Add($"{param.ParameterName} = {param.ToSqlParameterValue()}");
    }
    return $",N\'{string.Join(",", parameters)}\',{string.Join(",", parameterValues)}";
}

private static object ToSqlParameterType(this SqlParameter param)
{
    var paramDbType = param.SqlDbType.ToString().ToLower();
    if (param.Precision != 0 && param.Scale != 0)
        return $"{paramDbType}({param.Precision},{param.Scale})";
    if (param.Precision != 0)
        return $"{paramDbType}({param.Precision})";
    switch (param.SqlDbType)
    {
        case SqlDbType.VarChar:
        case SqlDbType.NVarChar:
            string s = param.SqlValue?.ToString() ?? string.Empty;
            return paramDbType + (s.Length > 0 ? $"({s.Length})" : string.Empty);
        default:
            return paramDbType;
    }
}

private static string ToSqlParameterValue(this SqlParameter param)
{
    switch (param.SqlDbType)
    {
        case SqlDbType.Char:
        case SqlDbType.Date:
        case SqlDbType.DateTime:
        case SqlDbType.DateTime2:
        case SqlDbType.DateTimeOffset:
        case SqlDbType.NChar:
        case SqlDbType.NText:
        case SqlDbType.NVarChar:
        case SqlDbType.Text:
        case SqlDbType.Time:
        case SqlDbType.VarChar:
        case SqlDbType.Xml:
            return $"\'{param.SqlValue.ToString().Replace("'", "''")}\'";
        case SqlDbType.Bit:
            return param.SqlValue.ToBooleanOrDefault() ? "1" : "0";
        default:
            return param.SqlValue.ToString().Replace("'", "''");
    }
}

public static bool ToBooleanOrDefault(this object o, bool defaultValue = false)
{
    if (o == null)
        return defaultValue;
    string value = o.ToString().ToLower();
    switch (value)
    {
        case "yes":
        case "true":
        case "ok":
        case "y":
            return true;
        case "no":
        case "false":
        case "n":
            return false;
        default:
            bool b;
            if (bool.TryParse(o.ToString(), out b))
                return b;
            break;
    }
    return defaultValue;
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-09-19T15:58:06.187

也需要涵盖非存储过程，因此我使用以下逻辑扩充了 CommandAsSql 库（请参阅上面@Flapper 答案下的评论）：

```
 private static void CommandAsSql_Text(this SqlCommand command, System.Text.StringBuilder sql)
    {
        string query = command.CommandText;

        foreach (SqlParameter p in command.Parameters)
            query = Regex.Replace(query, "\\B" + p.ParameterName + "\\b", p.ParameterValueForSQL()); //the first one is \B, the 2nd one is \b, since ParameterName starts with @ which is a non-word character in RegEx (see https://stackoverflow.com/a/2544661)

        sql.AppendLine(query);
    } 
```

拉取请求位于： [https ://github.com/jphellemons/CommandAsSql/pull/3/commits/527d696dc6055c5bcf858b9700b83dc863f04896](https://github.com/jphellemons/CommandAsSql/pull/3/commits/527d696dc6055c5bcf858b9700b83dc863f04896)

正则表达式的想法基于@stambikk 和 EvZ 的上述评论以及[https://stackoverflow.com/a/2544661/903783](https://stackoverflow.com/a/2544661/903783)的“更新：”部分，其中提到了“负面的后视断言”。在正则表达式的开头使用 \B 而不是 \b 进行单词边界检测是因为 p.parameterName 将始终以不是单词字符的“@”开头。

请注意，ParameterValueForSQL() 是在 CommandAsSql 库中定义的扩展方法，用于处理单引号字符串参数值等问题。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-09-04T00:49:56.523

如果您将转换命令文本：

```
Private Function ConvToNonParm(ByRef Cmd As SqlClient.SqlCommand) As String
    For myCnt As Int16 = 1 To Cmd.Parameters.Count
        Dim myVal As String = Cmd.Parameters(myCnt - 1).Value
        Select Case Cmd.Parameters(myCnt - 1).SqlDbType
            Case SqlDbType.Char, SqlDbType.NChar, SqlDbType.VarChar, SqlDbType.NChar, SqlDbType.NVarChar 'and so on
                myVal = "'" & myVal & "'"
                'Case "others...."

            Case Else
                'please assing
        End Select
        Cmd.CommandText = Replace(Cmd.CommandText, Cmd.Parameters(myCnt - 1).ToString, myVal)
    Next
    Cmd.Parameters.Clear()
    Return Cmd.CommandText
End Function 
```

现在您可以获取非参数命令文本，如下所示：

```
 myCmd.CommandText = "UPDATE someTable SET Value = @Value"
    myCmd.CommandText &= " WHERE Id = @Id"
    myCmd.Parameters.AddWithValue("@Id", 1234)
    myCmd.Parameters.AddWithValue("@Value", "myValue")

    myCmd.CommandText = ConvToNonParm(myCmd) 
```

结果是“UPDATE someTable SET Value = 'myValue' WHERE Id = 1234”没有参数了

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-10-01T20:16:56.190

扩展[Kon 的代码](https://stackoverflow.com/a/265261/773906)以帮助调试存储过程：

```
 private void ExtractSqlCommandForDebugging(SqlCommand cmd)
    {
        string sql = "exec " + cmd.CommandText;
        bool first = true;
        foreach (SqlParameter p in cmd.Parameters)
        {
            string value = ((p.Value == DBNull.Value) ? "null"
                            : (p.Value is string) ? "'" + p.Value + "'"
                            : p.Value.ToString());
            if (first)
            {
                sql += string.Format(" {0}={1}", p.ParameterName, value);
                first = false;
            }
            else
            {
                sql += string.Format("\n , {0}={1}", p.ParameterName, value);
            }
        }
        sql += "\nGO";
        Debug.WriteLine(sql);
    } 
```

在我的第一个测试用例中，它生成了：

```
exec dbo.MyStoredProcName @SnailMail=False
 , @Email=True
 , @AcceptSnailMail=False
 , @AcceptEmail=False
 , @DistanceMiles=-1
 , @DistanceLocationList=''
 , @ExcludeDissatisfied=True
 , @ExcludeCodeRed=True
 , @MinAge=null
 , @MaxAge=18
 , @GenderTypeID=-1
 , @NewThisYear=-1
 , @RegisteredThisYear=-1
 , @FormersTermGroupList=''
 , @RegistrationStartDate=null
 , @RegistrationEndDate=null
 , @DivisionList='25'
 , @LocationList='29,30'
 , @OneOnOneOPL=-1
 , @JumpStart=-1
 , @SmallGroup=-1
 , @PurchasedEAP=-1
 , @RedeemedEAP=-1
 , @ReturnPlanYes=False
 , @MinNetPromoter=-1
 , @MinSurveyScore=-1
 , @VIPExclusionTypes='-2'
 , @FieldSelectionMask=65011584
 , @DisplayType=0
GO 
```

您可能需要添加更多有条件的“..is...”类型分配，例如日期和时间。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2017-02-22T17:34:22.690

一个班轮：

```
string.Join(",", from SqlParameter p in cmd.Parameters select p.ToString()) 
```

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2019-09-04T00:15:59.870

从参数命令到非参数命令，你可以改变这个

```
Using cmd As SqlCommand = Connection.CreateCommand
    cmd.CommandText = "UPDATE someTable SET Value = @Value"
    cmd.CommandText &= " WHERE Id = @Id"
    cmd.Parameters.AddWithValue("@Id", 1234)
    cmd.Parameters.AddWithValue("@Value", "myValue")
    cmd.ExecuteNonQuery
End Using 
```

到

```
Private sub Update( byval myID as Int32, byval myVal as String)
    Using cmd As SqlCommand = Connection.CreateCommand
        cmd.CommandText = "UPDATE someTable SET Value = '" & myVaL & "'" & _
                          " WHERE Id = " & myID  
        cmd.ExecuteNonQuery
    End Using
End sub 
```

# compact-framework - Windows 工作流和紧凑框架

> ID：265197
> 
> 赞同：1
> 
> 时间：2008-11-05T14:04:32.110
> 
> 标签：compact-framework, workflow

可以使用 Windows Workflow 和 Compact Framework 3.5 吗？

我刚刚获得了 Visual Studio 2008 的评估版，我环顾四周，但如果有办法做到这一点，我无法快速解决。如果没有办法，我只是不想再浪费时间环顾四周。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T14:19:27.477

我遇到的最好的答案是“不”。在此刻。我还没有找到任何东西或看到任何其他说法。看来其他人也在[问](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=4014836&SiteID=1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T02:41:20.723

我认为答案是“不”，尽管我没有确切的证据。它肯定不会出现在 3.5 之前的任何紧凑框架版本中。根据发行说明，看起来紧凑框架 3.5 添加了 WCF，但没有 WF。明确的证据是尝试失败并在框架本身内找到 WF dll。

这实际上符合我的预期。WCF 显然适用于移动设备，但 WF 不太适用（我希望在服务器而不是客户端上看到它）。

# c# - C# 等效于 std::sort 和 std::unique

> ID：265208
> 
> 赞同：4
> 
> 时间：2008-11-05T14:09:22.350
> 
> 标签：c#, .net, sorting, unique

我在 C# 中有一个整数列表。我希望删除重复项。在 C++ 中，我将通过 std::sort 和 std::unique 算法运行它，以非常有效地获取唯一列表。

在 C# 中做同样事情的最佳方法是什么？换句话说，我正在寻找一种更优雅的方式来执行以下代码：

```
 private static int[] unique(int[] ids)
    {
        IDictionary<int, object> d = new Dictionary<int, object>();
        foreach(int i in ids)
            d[i] = null;

        int[] results = new int[d.Count];
        int j = 0;
        foreach(int id in d.Keys)
            results[j++] = id;

        return results;
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T14:11:14.683

您使用的是哪个版本的 .NET？

在 .NET 3.5 中，这就像调用[Distinct()](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx)扩展方法和[ToArray()](http://msdn.microsoft.com/en-us/library/bb298736.aspx)一样简单，如果您真的再次需要一个数组。

例如：

```
int[] x = new[] { 1, 4, 23, 4, 1 };
int[] distinct = x.Distinct().ToArray();
// distinct is now { 1, 4, 23 } (but not necessarily in that order) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T14:24:08.497

如果您认为 STL 方法“非常有效”，请使用以下方法：

```
 var vals = new List<int> { 1, 2, 3, 2, 1, 2, 3, 2, 3, 4, 3, 2, 3 };
       vals.Sort();
       var uniques = new HashSet<int>(vals); 
```

相当于 2.0

```
List<int> vals = new List<int>();
vals.Add(1);
vals.Add(2);
vals.Add(3);
vals.Add(2);
...
vals.Sort();
List<int> uniques = new List<int>();
vals.ForEach(delegate(int v) {
 if (!uniques.Contains(v)) uniques.Add(v);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T14:17:50.117

即使使用 .NET 2.0，您也可以使用[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)获得相同的结果。这将更容易与 C# 3.0 一起使用（即使与 .NET 2.0 一起使用），但应该可以与 C# 2.0 和 .NET 2.0 一起使用 - 你只需要使用 Enumerable.Distinct(x) 而不是 x.Distinct();

当然，最终这些只是您之前发布的代码的预包装版本（给予或接受诸如迭代器块之类的东西），因此您可以将该代码推送到实用程序类中并从那里（重新）使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T14:14:38.220

唉，我只有 .NET 2.0 可以使用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T14:31:49.590

在中途相关的说明中，C# 有一个[System.Array.Sort](http://msdn.microsoft.com/en-us/library/system.array.sort(VS.80).aspx)静态方法，您可以使用该方法对实际数组进行排序，而无需使用集合。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T14:31:58.323

我不知道您的收藏有多大，但如果您不处理数千个整数，这可能就足够了：

```
public IEnumerable<int> unique(int[] ids)
{
    List<int> l = new List<int>();
    foreach (int id in ids)
    {
        if (!l.Contains(id))
        {
            l.Add(id);
            yield return id;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-02T02:46:58.223

```
 private static List<T> GetUnique<T>(List<T> list) where T : IEquatable<T>
  {
     list.Sort();
     int count = list.Count;
     List<T> unique = new List<T>(count);
     T last = default(T);
     for (int i = 0; i < count; i++)
     {
        T val = list[i];
        if (i != 0 && last.Equals(val)) continue;
        last = val;
        unique.Add(val);
     }
     return unique;
  } 
```

# com - 如何在运行时注册 COM 库？

> ID：265212
> 
> 赞同：4
> 
> 时间：2008-11-05T14:10:02.767
> 
> 标签：com, registration, regfreecom, regsvr32

假设我正在开发一个安装 COM 组件并且安装程序注册它们的应用程序。这很好用。

现在该软件需要从记忆棒运行。如何注册我的库运行时并确保在运行应用程序后清理注册表？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-05T14:17:59.350

您总是在 XP 或更高版本上运行吗？不要打扰。使用“免费注册 COM”。

本质上，您所做的是为 COM 组件创建一个清单文件，以便 Windows 加载程序知道它的注册是什么，而不必将其放入注册表中。

MSDN 上的这篇文章中介绍了要执行的操作： [COM 组件的免注册激活：演练](http://msdn.microsoft.com/en-us/library/ms973913.aspx)

该文章中的“步骤 6”和“步骤 7”显示了如何创建清单。如果您的主程序是本机程序，而不是托管程序，您可能还需要进行一些 API 调用，这也在此处进行了说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T07:36:55.313

我们可以使用shell命令来做到这一点。使用 Shell 调用带有 dll 名称的 Regsvr32。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T14:17:06.013

我曾经看过一篇关于[并行 COM](http://chrisbensen.blogspot.com/2007/01/side-by-side-com-registration-part-i.html)的文章，这可能是您想要的。但是请注意，它并非在所有版本的 Windows 上都可用。

# java - 摩托罗拉手机上 J2ME 应用程序中的图像加载问题

> ID：265213
> 
> 赞同：2
> 
> 时间：2008-11-05T14:11:10.957
> 
> 标签：java, java-me, png, motorola

在 J2ME 应用程序中加载图像的标准方法是使用 Image.createImage 方法，推荐的图像格式是 PNG。

现在，J2ME 规范没有对该方法的实现或图像在内存中的表示设置任何限制，因此每个供应商都有不同的实现。

特别是摩托罗拉有这个非常糟糕的实现，其中 PNG 在图像创建时被完全解码为 ARGB 字节数组。这意味着一个尺寸为 176x208 的 8K png 占用了大约 170K 的峰值内存来加载，而 Image 对象本身使用的内存大约是 145K！在诺基亚、索尼爱立信等其他手机上，相同的图像只需要大约 16K 即可加载和存储在内存中。我不知道他们使用了哪些智能优化，但出于某种难以理解的原因，摩托罗拉的 JVM 没有。

这对我的 J2ME 应用程序造成了严重破坏，几乎不可能在摩托罗拉手机上运行一个像样的版本。我尝试了各种解决方法，例如使用图像的 gzip'd ARGB 字节数组并在绘制过程中对其进行放气，但这会导致绘制速度减慢 10 倍！

有人知道这个问题的解决方法吗？J2ME 的开源 PNG 图像解码器具有摩托罗拉所缺乏的智能？或者是否可以对 PNG 图像进行一些操作以减少其内存占用？（我目前使用索引模式 PNG）欢迎任何指针..

高里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T19:46:40.927

关于索尼爱立信的一件事。不要给他们太多的信任。它们在加载图像时也会占用 (image_width x image_height x bytes_per_pixel) 内存。

来自 SE J2ME 开发人员文档，“*所有图像都以每像素 16 位 RGB 格式存储在手机内存中，可能每个像素 alpha 通道具有 1 位或 8 位。* ”因此，至少 2 个字节。不同之处在于索尼爱立信手机（我不能代表诺基亚）有一个单独的内存块，用于在将图像加载到堆中之前先填充图像（您可以通过使用 Runtime.getRuntime().freeMemory 包装负载来查看这一点()...堆大小只会增加几个字节，这是新对象的大小）。

这并不是为摩托罗拉的手机辩护，因为我肯定在将 SE 手机移植到摩托罗拉手机时遇到了麻烦，但这并不是因为 SE 能够找到一种以更优化的方式将图像存储在堆中的方法。摩托罗拉只是将所有内容都存储在堆中，这就是您更快用完的原因。

较小的图像是一个好主意，不仅在解码器部分，而且从堆碎片的角度来看。它将允许图像适合较小的内存块而不是大的连续块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T10:50:52.653

好吧，在我看来，如果在创建图像时所有图像格式都立即解码为 ARGB 数组，那么您唯一真正能做的就是为您将用于显示内容的内存量创建一个上限屏幕。

您可以创建一个图像缓存，它将知道每个图像用于该特定设备的堆内存，加载和卸载图像是需要的。当然，这意味着依赖 Grabage Collector 可能无法让您的应用程序保持响应。

缓存管理可能需要在专用线程中进行。

如果您的应用程序屏幕足够静态而不需要太多动画，那么在任何给定时间只保留一个屏幕的图像加载可能会起作用。

还要记住 MIDP Canvas 通常不会自行重置。如果您使用 2 次不同的 Canvas.paint() 调用在屏幕的 2 个不同区域绘制 2 个不同的图像，您应该能够在实际图像对象被垃圾收集后很长时间保持显示这两个图像不要在它们上面画任何东西。

从纯粹的商业角度来看，您需要能够告诉您的客户，某些手机的 Java 实现非常糟糕，以至于您不会支持它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T15:23:19.330

PNG往往是臃肿的。

为什么不使用 gif 来代替。

[http://www.ddj.com/mobile/184406435;jsessionid=SBUQN2ECITM5OQSNDLOSKHSCJUNN2JVN?_requestid=76071](http://www.ddj.com/mobile/184406435;jsessionid=SBUQN2ECITM5OQSNDLOSKHSCJUNN2JVN?_requestid=76071)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T13:43:04.693

摩托罗拉开发者论坛建议您将较大的图像切割成较小的条带，然后一次性加载这些较小的条带而不是整个大图像。请注意，这不会*减少*图像的内存占用。这仍然需要所有条带的总和（宽度 * 高度 * 每像素字节数）。但它确实减少了解码 png 图像并加载它所需的内存。所以这就是我现在正在做的事情。它帮助了一些人。但是整体内存使用仍然是一个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T05:35:54.137

更好的解决方案是将 ARGB 存储为数据（使用某种索引来压缩它），并具有更改调色板等/无 PNG Header/ 的优点。而不是存储不同的PNG图像并使用createImage函数来创建图像。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T14:41:47.390

[减少 png 图像的一种方法是通过png gauntlet](http://brh.numbera.com/software/pnggauntlet/)之类的程序运行它们 以减小其大小。

# seo - 谷歌友好的会员代码

> ID：265218
> 
> 赞同：1
> 
> 时间：2008-11-05T14:12:24.167
> 
> 标签：seo, affiliate, referrals

我正在寻找一种方法来为我的网站实施推荐系统。

最初，我使用[http://mysite.com/?affid=0001](http://mysite.com/?affid=0001)并使用查询字符串 affid 值中的 affid 来记录推荐。这样做的问题是，从一些常见的 Google 搜索短语中，带有 affid 的链接出现在 Google 搜索中的标准链接之前，这意味着附属公司将错误地获得使用 Google 搜索我们网站的客户的信用。

我还听说有多个指向同一页面的不同链接（例如[http://mysite.com/?affid=0001](http://mysite.com/?affid=0001)和[http://mysite.com/?affid=0002](http://mysite.com/?affid=0002)）会导致 Google 降低您的排名。这是真的？

有没有人可以解决这些问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T14:15:03.303

您应该做的是检测 URL 中何时有会员 ID，然后重定向到没有会员 ID 的相同 URL（当然首先将 ID 存储在会话、cookie 等中）。

这将解决 my-affiliates-are-replacing-me-in-google 问题和重复内容问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T14:36:07.973

正如 Joe 在评论中提到的，您应该在您的会员页面中使用 301（永久）重定向来帮助您的 SEO。代码将如下所示：

```
Response.Status = "301 Moved Permanently";
Response.AddHeader("Location","http://www.example.com"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T14:24:44.970

您可以尝试以下方法。每当您收到包含您的会员代码的链接时，请将此元标记动态添加到您的页面：

```
<meta name="ROBOTS" content="NOINDEX, FOLLOW"/> 
```

大概这会阻止该页面的所有不同附属版本被编入索引，但您仍然可以获得指向您网站的链接的链接汁。

使用风险自负。谁知道谷歌实际上做了什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T16:51:04.473

是的，上面提到的两个想法都提到了重定向附属链接 301 {永久} 是搜索引擎将内容和链接归因于正确 url 的最方便和最好的方法，它只会增加用户体验的瞬间

因此，添加到所有附属登录页面开头的完整代码更像是{注意，无论如何，如果 url 中不存在 affid，您希望绕过重定向}

```
<?php
if (isset($_REQUEST['affid'])) {
 <make call to affiliate logging code, ensure it creates no visible output>
header("HTTP/1.1 301 Moved Permanently");
header("Location: http://www.example.com/this-page/");
exit();
}
?> 
```

其余页面内容照常

上面的例子是 asp/vbscript

你也可以做{用适当的 if 语句围绕重定向} colfusion

```
<CFHEADER statuscode="301" statustext="Moved Permanently">
<CFHEADER name="Location" value="http://www.example.com/this-page/"> 
```

不要在上述标记之前或在 Application.cfm 中使用 CFFLUSH 命令。此 Coldfusion 代码由 Toll Free Forwarding.com 提供。

Perl 中的 HTTP 301 重定向

```
#!/usr/bin/perl      -w
use strict;
print "Status: 301 Moved Permanantly\n";
print "Location: http://www.example.com/this-page/\n\n";
exit; 
```

# algorithm - 如何在 C++ (STL) 中否定函子？

> ID：265228
> 
> 赞同：14
> 
> 时间：2008-11-05T14:15:21.727
> 
> 标签：algorithm, stl, c++

我有一些函数可以找到一个值：

```
struct FindPredicate
{

    FindPredicate(const SomeType& t) : _t(t) {
    }
    bool operator()(SomeType& t) {
      return t == _t;
    }

private:
    const SomeType& _t;
};

bool ContainsValue(std::vector<SomeType>& v, SomeType& valueToFind) {
    return find_if(v.begin(), v.end(), FindPredicate(valueToFind)) != v.end();
} 
```

现在我想编写一个函数来检查向量的所有成员是否满足该谓词：

```
bool AllSatisfy(std::vector<SomeType>& v) {
    /* ... */
} 
```

一种解决方案是使用`std::count_if`算法。

有谁知道涉及否定谓词的解决方案？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-05T14:37:48.827

最好的解决方案是使用[STL 函数库](http://www.keithschwarz.com/cs106l/fall2007/handouts/200_STL_Functional_Library.pdf)。通过从 派生谓词`unary_function<SomeType, bool>`，您就可以使用该`not1`函数，该函数正是您需要的（即否定一元谓词）。

您可以这样做：

```
struct FindPredicate : public unary_function<SomeType, bool>
{
    FindPredicate(const SomeType& t) : _t(t) {}

    bool operator()(const SomeType& t) const {
      return t == _t;
    }

private:
    const SomeType& _t;
};

bool AllSatisfy(std::vector<SomeType>& v, SomeType& valueToFind)
{
    return find_if(v.begin(), 
                   v.end(), 
                   not1(FindPredicate(valueToFind))) == v.end();
} 
```

* * *

如果您想推出自己的解决方案（即恕我直言，不是最佳选择......），那么您可以编写另一个谓词来否定第一个谓词：

```
struct NotFindPredicate
{

    NotFindPredicate(const SomeType& t) : _t(t) {
    }
    bool operator()(SomeType& t) {
      return t != _t;
    }

private:
    const SomeType& _t;
};

bool AllSatisfy(std::vector<SomeType>& v) {
    return find_if(v.begin(), 
                   v.end(), 
                   NotFindPredicate(valueToFind)) == v.end();
} 
```

或者您可以做得更好并编写一个模板仿函数否定器，例如：

```
template <class Functor>
struct Not
{
    Not(Functor & f) : func(f) {}

    template <typename ArgType>
    bool operator()(ArgType & arg) { return ! func(arg); }

  private:
    Functor & func;
}; 
```

你可以使用如下：

```
bool AllSatisfy(std::vector<SomeType>& v, SomeType& valueToFind)
{
    FindPredicate f(valueToFind);
    return find_if(v.begin(), v.end(), Not<FindPredicate>(f)) == v.end();
} 
```

当然，后一种解决方案更好，因为您可以对所需的每个仿函数重用*Not结构。*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-05T14:42:43.513

请参阅 std 库仿函数[not1](http://www.cplusplus.com/reference/misc/functional/not1.html)，它返回一个仿函数，该仿函数与您给它的仿函数返回的逻辑不符。

您应该能够执行以下操作：

```
bool AllSatisfy(std::vector<SomeType>& v, SomeType& valueToFind) {
    return find_if(v.begin(), v.end(), not1(FindPredicate(valueToFind))) != v.end();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T15:19:20.943

第一次使用时，`not1`我想知道为什么不简单地调用它`not`。

答案让我有点惊讶（见评论）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T21:37:54.237

当您使用它时，您不需要 FindPredicate 函子，因为在示例中您只是测试相等性。

```
bool all_equal(std::vector<SomeType>& v, SomeType& valueToFind)
{
   return v.end() == find_if(v.begin(), v.end(), std::bind1st (equal_to (), valueToFind) );
}

bool all_not_equal( std::vector<SomeType>& v, SomeType &valueToFind ) {
{
   return v.end() == find_if(v.begin(), v.end(), std::bind1st (not_equal_to (), valueToFind) );
} 
```

你可以自己把它做成一个模板。

```
template< typename InputIterator , typename Predicate >
bool test_all( InputIterator first, InputIterator last, Predicate pred )
{
  return last == find_if( first, last, pred );
}

test_all( v.begin(), v.end(), std::bind1st( not_equals_to_( value )) ); 
```

# architecture - 使应用程序可定制的最佳实践？

> ID：265234
> 
> 赞同：1
> 
> 时间：2008-11-05T14:16:46.467
> 
> 标签：architecture, customization, extensibility

我有兴趣阅读其他开发人员和架构师处理为某些站点定制其应用程序某些区域的各种方式。调用客户实现的前后处理、执行相同操作的事件、允许覆盖业务逻辑方法、使用具有可插拔模块的策略、数据可配置流程（例如规则引擎、脚本等）。

清单可以继续，但我要问的是谁使用了这些方法，每种方法的优缺点是什么，以及还有哪些其他方法。

这假设我们不创建客户特定的代码分支来适应这些定制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T14:43:44.603

MS 正在 .NET 中为此开发两个不同的框架：托管可扩展性框架和 System.Addin。

应用程序暴露可扩展性的最常用方式可能是通过依赖注入/控制反转与运行时类型解析相结合。这意味着，您让外部实体在运行时“注入”接口的实现，而不是在编译时绑定到特定的实现。您的代码不关心您的 IRepository 是由您的公司还是由第三方编写的。通过针对接口进行编码并使用 DI/IOC 框架[（此链接提供了 .NET 框架的一个很好的概述）](http://blog.ashmind.com/index.php/2008/08/19/comparing-net-di-ioc-frameworks-part-1/)，您可以轻松地自定义您的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T14:19:03.453

我倾向于构建所有模块化的东西，然后根据客户的要求将东西添加到程序中。您可以将其与客户可以控制的应用程序设置相结合，允许他们自行添加和删除模块。在这种情况下，您要做的就是设置默认配置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T14:49:12.487

一种方法是嵌入脚本语言（python 和 javascript 似乎很流行）并通过脚本扩展公开 API 的重要块。您可能会发现用脚本语言实现部分应用程序也更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T14:36:09.923

对于我使用的产品，由服务组为给定客户构建的定制，或者有时由客户自己构建的定制，被共享给团队的其他成员（对于我们制作的东西），并且经常被“产品化”在以后的版本中。

我们支持 [几乎] 完全访问 API，它可以用来做 [几乎] GUI 可以做的任何事情，但以自动化的方式。

我们鼓励客户编写自定义脚本，然后与我们分享。通过扩展来增加产品的可用用途，无论它们是得到官方支持还是保留社区工具，都有助于在您的客户群中产生善意。

对于我们构建的定制，初始工作虽然向特定客户收费，但随后可以在其他地方快速实施，从而使当前和未来的用户在使用产品时更加灵活。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T14:59:47.863

我发现将您的应用程序创建为可通过良好的嵌入式脚本语言访问的模块库（[Lua](http://lua.org)正是为此而创建的！）为您提供了极大的灵活性，不仅对用户而言；但也为你自己。

# asp.net - ASP.NET url MAX_PATH 限制

> ID：265251
> 
> 赞同：11
> 
> 时间：2008-11-05T14:20:58.130
> 
> 标签：asp.net, url, isapi, max-path

我发现了 ASP.NET 的一个问题，我知道这至少让其他人感到困惑。我们试图使用 HttpModule 来处理对 Web 应用程序的通配符请求。生成的 url 是动态的，可能有几百个字符长。不幸的是，aspnet_isapi.dll 文件中似乎存在一个限制，它将 url 中的路径长度限制为 MAX_PATH，它被硬编码为 260 个字符。

有没有其他人遇到过这个并找到绕过这个限制的方法？查询字符串参数不是一个选项。

谢谢，格雷格巴拉德

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T17:24:25.560

这是 aspnet_isapi.dll 的一个已知问题，目前没有解决方法。在内置 Visual Studio Webserver（又名 Cassini）中运行站点时没有看到此问题的原因是它都是托管代码并且不依赖于 aspnet_isapi.dll。

这将在 ASP.NET 的未来版本中得到解决。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-04-07T18:18:57.873

我最终在 web.config 中使用以下内容使用 Mvc2 和 .Net Framework 4.0 解决了这个问题

```
<httpRuntime maxUrlLength="1000" relaxedUrlToFileSystemMapping="true" /> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T14:42:36.853

问题实际上在于 Windows，而不是 ASP.NET。Windows 已将 MAX_PATH 设置为 260，当 IIS 请求更长的文件名时，它将失败。您可能已经找到了这篇 KBase 文章，但对于其他任何人：http: [//support.microsoft.com/kb/q177665/](http://support.microsoft.com/kb/q177665/)。适用于：部分显示这是从 NT 3.51 一直到 Vista 和 Server 2003 的预期行为。

至于解决方法，我遇到了类似的情况，但我们会放弃避免使用查询字符串参数的尝试，并且无论如何都这样做了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T15:22:30.797

感谢您的回答。虽然我没有找到那篇确切的文章，但我发现了类似的文章。但是，这不是 IIS 中的限制。您可以在请求中将更长的路径传递给 IIS，它会返回正确的响应。您可以通过尝试使用简单的 html 页面进行验证。该问题仅在使用 aspnet_isapi.dll 处理请求时出现。甚至 Visual Studio 中的集成调试服务器也可以处理比 260 更长的路径。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-26T09:07:26.710

@Haacked：

Phil，您提到这是 aspnet_isapi.dll 的问题。这不是说在IIS7集成管道模式下不应该存在这个问题吗？

然而，据我所知，（[http://forums.iis.net/t/1105360.aspx](http://forums.iis.net/t/1105360.aspx)）它仍然存在。

我遇到了同样的问题，感觉有点受不了。似乎 ASP.NET 路由受到影响。因此，任何 ASP.NET MVC 应用程序的 URL 都必须短于 260，之后它必须恢复为查询字符串，这似乎是一个完整的 180！

（抱歉回答评论......还没有足够的代表发表评论：（）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-02-10T16:11:14.597

注册表项 UrlSegmentMaxLength 可用于增加传入 HTTP 请求中每个 Url 段的默认 Windows 最大 260 个字符：

*   钥匙：`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\HTTP\Parameters`
*   价值：`UrlSegmentMaxLength`
*   类型：REG_DWORD
*   数据：（您想要的新 URL 段最大允许长度，例如 4096）

允许的最大值为 32766。如果指定了较大的值，将被忽略。（来源：胡安·门德斯）

有关 http.sys 设置的更多信息：http: [//support.microsoft.com/kb/820129](http://support.microsoft.com/kb/820129)

需要重新启动 PC 才能使对此设置的更改生效。（来源：大卫·雷滕巴赫、胡安·门德斯）

此答案的原始来源：[https ://stackoverflow.com/a/7817739/12484](https://stackoverflow.com/a/7817739/12484)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-18T16:38:36.700

您可以使用 URL 重写 ISAPI（例如[IIRF](http://cheeso.members.winisp.net/IIRF.aspx)）将 URL 重写为 aspnet_isapi 可以处理的内容。

# c# - 数据列和标题

> ID：265255
> 
> 赞同：0
> 
> 时间：2008-11-05T14:21:46.707
> 
> 标签：c#, dataset, caption

我正在尝试在数据集中设置用户友好的标题，在绑定过程中将被 Infragistics 网格检测到。我似乎记得可以在类型化数据集的底层 XSD 中执行此操作，但任何相关链接似乎都已从 Google 的相关链接列表中消失。

有没有人这样做，会推荐它或有更好的方法吗？我不需要本地化字符串，因为这是一个内部应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-05T14:47:09.027

您可能指的是 msdata:Caption 属性吗？

```
<xs:element name="colname" type="xs:decimal" minOccurs="0"
  msdata:Caption="Friendly Caption" /> 
```

# c++ - 如何避免大数的科学记数法？

> ID：265258
> 
> 赞同：26
> 
> 时间：2008-11-05T14:23:32.443
> 
> 标签：c++, math

我正在做 2^1000，我得到了这个：

1.07151e+301

有没有办法在没有 e+301 的情况下将其实际转换为正确的数字，或者至少有人可以告诉我在哪里可以看到如何通过使用 e+301 部分将其转换为实数？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-05T14:53:49.077

所以，我在想你真正想要的只是能够在没有科学记数法的情况下打印它。如果你正在使用`printf`，你想要的是：

```
printf( "%f1000.0", value );
// note that 1000 is way larger than need be,
// I'm just too lazy to count the digits 
```

使用`cout`，尝试类似：

```
cout.setf(ios::fixed);
cout << setprecision(0) << value; 
```

如果您想将其打印为 2 的幂（2^1000 与 10715...），您只能靠自己了。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-05T14:30:44.100

可以在机器寄存器中直接操作的数字有多大是有实际限制的。如果您使用双精度浮点数，则总共有 64 位，其中一些用于尾数，一些用于指数，1 用于符号位。

2^1000 需要一个 1001 位整数来表示而不会丢失精度。为了处理这样的数字，您需要使用支持大数字的库，例如[GNU MP](http://gmplib.org/)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-05T14:28:02.373

您需要使用专门为长数字设计的数字类。

要将 2^1000 表示为一个确切的数字，那么根据定义，您需要一个实际包含 1001 个二进制位的数字格式。最长的普通原始整数格式通常只有 64 位。

顺便说一句，答案是：

```
% perl -Mbigint -e 'print 2**1000'
10715086071862673209484250490600018105614048117055336074437503883703510511249361224931983788156958581275946729175531468251871452856923140435984577574698574803934567774824230985421074605062371141877954182153046474983581941267398767559165543946077062914571196477686542167660429831652624386837205668069376 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-05T14:43:53.293

如果你想在 C++ 中自己做，你可以例如创建一个数字数组并自己做计算。经过测试和验证的示例：

```
unsigned int result[400]; // result digits
unsigned int i, j, carry;

// Initialize result digits
for (i = 0; i < 399; i++) {
  result[i] = 0;
}
result[399] = 2;

for (i = 2; i <= 1000; i++) { // Calculate 2^i
  carry = 0;
  for (j = 399; j > 0; j--) {
    result[j] <<= 1;    // multiply with 2
    result[j] += carry; // add carry
    carry = result[j] / 10;
    result[j] %= 10;    // we want one digit (0-9) only
  }
}

printf("2 ^ 1000 = ");
// print result digits
for (i = 0; i < 400; i++) {
  if (result[i] != 0) { // no leading zeros, please
    for (j = i; j < 400; j++) {
      printf("%d", result[j]);
    }
    break;
  }
}
printf("\n"); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T14:38:00.590

cout << 固定 << your_number;

但它可能不会显示整数。正如有人之前所说，您需要编写一个类。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-05T14:58:23.013

一种选择，如果您的应用程序逻辑允许它是更改您正在操作的单位......

如果您以埃为单位测量从纽约到巴黎的距离，请选择英里或公里......很少需要保留那么多位数的准确性。

另一方面，如果您正在做的事情需要具有这么多数字的完全准确的整数值，那么您可能应该获得专门设计用于处理大数字的软件......这样的软件肯定是可用的，虽然我不熟悉区域。（成本、供应商、能力等）如果成本是一个问题，而您正在考虑自己编写，那么我对所涉及的内容知之甚少，无法知道这种方法是否值得努力……

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-05T14:29:25.380

您获得的数字与变量类型可以支持的一样精确。该数字大约为 1，后跟 301 个零。要获得精确的数字，您必须使用支持大数字的库，或者使用为这种数学（maple、matlab 等）而设计的语言

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-05T10:30:05.077

包括标题`limits.h`和`cmath.h`

```
cout.precision(0);
cout<< fixed<< pow(2,31);               //OR ANY NUMBER HERE 
```

使用 cout.precision 设置精度。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-18T12:56:18.900

我面临着同样的问题。我试图直接打印`2^34`，输出是 `3.43597e+010`.

您应该考虑将其存储在变量中，因为这解决了我的问题。例如，

```
long long int a= pow(2,34)-2;
cout<<a; 
```

输出是一个实数，正如我想要的那样——`34359738366`

# asp.net - 我可以在嵌入式 Javascript 部分中使用 VB 变量吗？

> ID：265264
> 
> 赞同：5
> 
> 时间：2008-11-05T14:26:09.617
> 
> 标签：asp.net, javascript, vb.net

是否有可能做这样的事情：

```
<% Dim foo as string = "bar" %>

<script type="text/javascript">
    var baz = <%=foo %>
</script> 
```

`<script>`标签嵌入在我的索引页的什么位置？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-05T14:29:50.140

是的，但请确保在它周围加上引号和分号：

```
var baz = '<%=foo %>'; 
```

# air - Adobe AIR 应用程序可以在本地客户端计算机上执行进程吗？

> ID：265265
> 
> 赞同：4
> 
> 时间：2008-11-05T14:26:11.113
> 
> 标签：air

我希望能够从 Adob​​e AIR 应用程序（实际上是命令行进程）中启动第三方进程。AIR 应用程序在其中运行的安全上下文是否可以防止这种情况发生？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T14:36:44.883

Adobe AIR 最需要的两个功能是从 AIR 应用程序启动本机可执行文件的能力，以及将本机库集成到 AIR 应用程序的能力。不幸的是，Adobe AIR 1.0 中没有包含这两个功能。

然而。查看：

[这篇博文](http://blog.onebyonedesign.com/?p=70)

[艾拉维尔](http://www.airaveer.com/)

[舒播放器](http://www.shu-player.com/)

> Shu 使您能够增加 Adob​​e AIR 的功能和范围。借助 Shu，您的 AIR 应用程序可以快速转换为独立应用程序，以便在 PC 或 Mac 机器上运行，而无需安装 AIR 运行时！Shu 应用程序也可以从 CD 或网络共享运行，无需安装。此外，Shu 为开发人员提供了一个命令工具包，用于扩展 AIR 应用程序的系统功能，功能包括**控制外部应用程序、打开外部文件、数据库连接和控制、系统路径检索和屏幕捕获功能。**

然而，使用这些方法中的任何一种都会破坏 AIR 的一些意图，即跨平台开发。据我所知，这是 Adob​​e 目前不允许您执行本机代码的主要原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T01:51:36.010

舒似乎是答案，但我们在他们的支持方面遇到了麻烦

在我们的评估中，如果已经安装了 air，我们将无法安装应用程序。这对我们的客户来说是不可接受的，我们希望这是一个流畅的体验。

有没有人在他们的支持下有运气或看到这个问题？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-28T20:43:47.357

[永远不要从http://shu-player.com/](http://shu-player.com/)购买 SHU 包。这是浪费你的钱，原因如下：

a) 可执行文件接近 15 Meg，而且速度很慢 b) 他们的文档很糟糕 c) 没有人会通过电子邮件回复您。他们只是拿你的钱，那就是

我能够创建一个 PHP 套接字服务器并使用 Adob​​e Socket API 来传递命令来执行程序。我使用 exec 调用。您可以通过创建一个 C++ 程序来执行 Shell Execute 来做同样的事情，并且您的 C++ 程序可以是一个套接字服务器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-11T20:44:55.777

可使用 2010/06/09 发布的 Adob​​e AIR 2.0。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-05T13:24:16.677

关于 Shu，您可能应该阅读 Mike Chambers 的这篇文章：

[http://www.mikechambers.com/blog/2008/04/07/redistributing-the-adobe-air-runtime-installer/](http://www.mikechambers.com/blog/2008/04/07/redistributing-the-adobe-air-runtime-installer/)

舒的所作所为是否完全合法并不是 100% 清楚的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-04T02:46:06.090

仅供参考，这将在 Adob​​e MAX 上宣布的 AIR 2.0 中实现。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-05T12:03:49.927

实际上，使用最新版本的[Shu ，您可以使用](http://shu-player.com)*其他*命令创建标准 AIR 文件，这完全不会破坏 AIR 的意图。

# .net - Sql Clr 用户定义类型解析浮点数并丢失精度

> ID：265271
> 
> 赞同：0
> 
> 时间：2008-11-05T14:28:01.017
> 
> 标签：.net, tsql, sqlclr

我有一个 Clr 用户定义类型，它接受一串用逗号分隔的值。

转换为这种类型时，我失去了一点精度，我将其缩小到这行代码：

```
cast(cast(nlinkjt as nvarchar(100)) + ',' +cast(avglrwf as nvarchar(100)) + ',' + cast(avglrwfjt as nvarchar(100)) as dbo.CLRJourneyTime) as clrJT 
```

输出 = 29.9376,5.29633e-005,0.00158559

但原始值是这样的：

```
nlinkjt = 29.9376097988521  = cast(nlinkjt as nvarchar)  = 29.9376
avglrwf = 5.29632961843163E-05  = cast(avglrwf as nvarchar) = 5.29633e-005
avglrwfjt =  0.00158559449482709  = cast(avglrwfjt as nvarchar) = 0.00158559 
```

如何将浮点数完全转换为字符串？

或者是否有另一种方式来声明一个新的 dbo.CLRJourneyTime 就像你在 .net 中那样：

```
'new dbo.CLRJourneyTime(nlinkjt , avglrwf , avglrwfjt ) as clrJT' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T14:34:37.117

好的，刚刚发现浮点列无论如何只存储到小数点后 4 位。所以它可能无关紧要。

# command-line - 我在哪里可以下载 ascmd.exe？

> ID：265276
> 
> 赞同：6
> 
> 时间：2008-11-05T14:29:18.407
> 
> 标签：command-line, ssas, olap, mdx, ascmd

我需要从命令行（MS AS 2005）执行 MDX 查询。我听说有一个名为 ascmd 的程序可以做到这一点。不幸的是，当我转到 codeplex 页面时，我发现应该提供 ascmd 的页面不起作用。如果您知道任何其他页面，请提供帮助，我可以在其中下载 ascmd 或任何其他在命令行中执行 MDX 的程序。谢谢您的回复！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T14:38:49.543

ascmd.exe 包含在此[MS-SQL Server 示例下载](http://www.codeplex.com/SqlServerSamples/Release/ProjectReleases.aspx?ReleaseId=4000)中。这与您最初可能访问的页面不同，它已移动。只需单击 SqlServerSamples.msi 链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T14:33:08.510

您将获得 SP2 示例。

[您可以从http://www.microsoft.com/downloads/details.aspx?familyid=e719ecf7-9f46-4312-af89-6ad8702e4e6e&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=e719ecf7-9f46-4312-af89-6ad8702e4e6e&displaylang=en)单独下载并安装它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T13:56:58.307

使用 MS AS 2005，您应该在“sample_inst\Analysis Services\Administrator\ascmd\CS”下。

其中 sample_inst 是您安装示例的文件夹

通常：

"C:\Program Files\Microsoft SQL Server\90\Samples"

# windows - 如何使用 sed for windows（来自 cygwin）对 utf16 文件进行替换

> ID：265282
> 
> 赞同：0
> 
> 时间：2008-11-05T14:30:15.613
> 
> 标签：windows, sed, cygwin

我在 Windows 上使用来自 cygwin 的 sed 在文本文件中进行一些替换。对于普通（ANSI）文件，一切正常，但对 utf-16 文件没有任何作用（不进行替换）。你知道我怎样才能让它同时适用于两种类型的文件吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T19:59:19.380

我会用 iconv 包装它，比如

```
 iconv -f utf-16 -t utf-8 <input | sed -e expr | iconv -f utf-8 -t utf-16 >output 
```

# jquery - 提交我的 Ajax.BeginForm 的其他 jQuery 事件

> ID：265293
> 
> 赞同：2
> 
> 时间：2008-11-05T14:34:01.130
> 
> 标签：jquery, asp.net-mvc

我有一个 ASP.Net MVC Ajax.BeginForm，当我单击提交按钮时，它会正确提交和更新我的页面。

问题是我需要额外的事件来做同样的事情，比如当他们改变输入的文本时。附加事件确实正确地提交了表单，但它们绕过了 Ajax.BeginForm 在表单标签上生成的 onsubmit javascript。

下面是 Ajax.BeingForm 生成的表单标签：

```
<form action="/Store/UpdateCart" method="post" onsubmit="Sys.Mvc.AsyncForm.handleSubmit(this, new Sys.UI.DomEvent(event), { insertionMode: Sys.Mvc.InsertionMode.replace, updateTargetId: 'updatedContent' });"> 
```

这是绑定我的其他需要通过 Ajax 提交表单的事件的 jQuery：

```
 $("#ShippingType, #ViewCart .ddl").bind("change", function() { $("#ViewCartPage form").submit() }); 
```

关于如何让这些额外的事件像我需要的那样触发 onsubmit 的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-18T16:52:14.693

决定只使用常规表单，然后使用 jQuery.Form 插件，这在 2 秒内就起作用了！希望我本来可以走这条路。

```
var options = {
   target: '#updatedContent',   // target element(s) to be updated with server response 
   beforeSubmit: showRequest,  // pre-submit callback 
   success: showResponse  // post-submit callback 
        };

$('#ViewCartPage form').ajaxForm(options); 
```

我爱 jQuery

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-05T17:20:35.830

微软可能会打破我们，但是：

```
function SubmitMvcAjaxForm(formName) {
    eval('var event = new Object(); event.type="keypress"; ' + document.forms[formName].attributes["onsubmit"].value.replace('(this,', '(document.forms["' + formName + '"],'));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T15:24:54.800

这是当前 MVC Beta 中的一个棘手问题。您不能使用“submit()”函数，因为它不会触发 onsubmit 处理程序。相反，您应该直接调用 onsubmit 处理程序。唯一的技巧是在调用它时需要将参数传递给 onsubmit()。这个参数就是处理程序中的“事件”参数（参见“新的 Sys.UI.DomEvent(event)”部分）。当您单击“提交”按钮时，MVC Ajax 脚本使用“event”参数取消默认行为，以便 Ajax 内容可以不间断地发生。

因此，如果您将代码更改为：

```
$("#ShippingType, #ViewCart .ddl").bind("change", function() { $("#ViewCartPage form").onsubmit({ preventDefault: function() {} }) }); 
```

onsubmit() 事件将在表单字段更改时触发。该代码创建了一个“假”事件对象，该对象实现了 preventDefault() 方法（这是 MVC Ajax 帮助程序唯一使用的方法），因此您不会遇到错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-13T20:33:33.813

改变 -

```
bind("change", function() { $("#ViewCartPage form").submit() }); 
```

到 -

```
bind("change", function() { $("#ViewCartPage form").onsubmit() }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-09T06:33:00.087

我在 MVC2 中使用了 Sichbo 的答案，但我发现使用 MVC3 你不再需要这些变通方法（即 $('#yourformid').submit(); 现在可以用于 ajax 调用）。

# .net - .NET反编译，有多容易？

> ID：265295
> 
> 赞同：13
> 
> 时间：2008-11-05T14:34:15.170
> 
> 标签：.net, decompiling, copy-protection

我正在研究应用程序许可证密钥的最佳加密方法，有人说有人可以轻松反编译应用程序，然后跳过许可证密钥的测试。

实际上，有人会怎么做呢？所以他们有我的.dll，他们必须以某种方式反编译它，然后注释掉函数调用以检查许可证，然后重新编译它？反编译器必须非常好，这样代码才能编译！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-05T14:36:00.250

尝试使用[Reflector](http://www.red-gate.com/products/reflector/)打开您的应用程序。你可能会感到惊讶:-)

一旦破解者在您的代码中找到了正确的位置，他们就可以使用[ildasm](http://msdn.microsoft.com/en-us/library/f7dy01k1(VS.80).aspx) / [ilasm](http://msdn.microsoft.com/en-us/library/496e4ekx(VS.80).aspx)的组合从您的应用程序中删除检查 - 即使反射器生成的代码不会编译。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-05T14:39:02.413

如果源代码是正常编译的，那么反编译 .NET 程序集非常容易。

您可以使用最初由 Lutz Roeder 开发的**[.NET Reflector](http://www.red-gate.com/products/reflector/)**，现在由 Redgate Software 支持。这个答案的底部有一个屏幕截图，让您对 Reflector 的作用有一个印象。

您可以浏览命名空间和类，并以您最喜欢的 .NET 语言查看源代码和方法。Denis Bauer 的[**FileDisassembler**](http://www.denisbauer.com/NETTools/FileDisassembler.aspx)将允许您（或您的情况下的邪恶黑客）将其转换为 VS 解决方案并对程序进行修改。

有一些对策，例如使用**代码混淆**器使您的代码实际上不可读。

StackOverflow 上还有一些关于这个主题的有趣问题：

*   [您是否应该混淆商业 .Net 应用程序？](https://stackoverflow.com/questions/71195/should-you-obfuscate-a-commercial-net-application)
*   [如何将 .NET EXE 反编译为可读的 C# 源代码？](https://stackoverflow.com/questions/179741/how-do-i-decompile-a-net-exe-into-readable-c-source-code)
*   [最佳 .NET 混淆工具/策略](https://stackoverflow.com/questions/2525/best-net-obfuscation-toolsstrategy)
*   [.NET 加密许可证密钥？](https://stackoverflow.com/questions/258994/net-cryptography-for-licence-keys)

*反射器截图：*

[![替代文字](https://i.stack.imgur.com/8F9TJ.gif)](https://i.stack.imgur.com/8F9TJ.gif)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-05T15:14:32.263

Josh Smith 最近还发布了[Crack.NET](http://joshsmithonwpf.wordpress.com/cracknet/)，它可用于附加到正在运行的 .NET 进程，然后在[Reflector](http://www.red-gate.com/products/reflector/)中打开它——所以即使磁盘上的程序集以某种方式加密（以避免人们使用 Reflector 来获取它们） ，他们仍然可以使用内存版本

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T14:38:21.777

.NET 非常容易反编译。混淆会使人们更难理解正在发生的事情，但是反编译您的代码的人仍然可以弄清楚它们是否是持久的。

以下是我在网上找到的关于保护您的 .NET 代码的一些建议：

[http://blogs.msdn.com/ericgu/archive/2004/02/24/79236.aspx](http://blogs.msdn.com/ericgu/archive/2004/02/24/79236.aspx)

请注意，所讨论的技术都不是 100% 有效的，它只是一个问题，你会让饼干跳过多少圈。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T14:46:35.910

.NET 编译通常非常简单：要亲自体验一下，只需获取[.NET Reflector](http://www.red-gate.com/products/reflector/)的副本并尝试一下。

在大多数情况下，无需重新编译代码即可删除简单的许可证检查：只需修补[MSIL](http://channel8.msdn.com/Posts/MSIL-the-language-of-the-CLR-Part-1/)即可。

保护自己免受这种情况的影响会迅速减少回报：*总会*有足够聪明的人绕过你添加到代码中的任何额外检查。例如，您可以在您的代码中添加数字签名，并拒绝运行签名不匹配的代码（表明代码已被篡改，例如删除许可证检查）。

然后游戏变为删除签名检查（除了许可证密钥检查）。所以你添加另一个检查，然后可以绕过，等等，无限。

有整个行业的[代码混淆](http://www.google.com/search?q=.net+obfuscator)和[复制保护](http://www.google.com/search?q=copy+protection+.net)工具可以帮助您保护您的软件免受此类问题的影响。由您决定是否值得购买这些解决方案，您的额外努力以及您会给合法客户带来的烦恼......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-05T14:53:57.283

如果这是您要防御的东西，您可能需要阅读有关如何攻击它的信息。

[Greg Holland 和 Gary McGraw 的Exploiting Software](http://www.exploitingsoftware.com/)是一个很好的介绍。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-05T15:36:46.633

最好不要过度使用许可证密钥技术。无论您做什么，都可能被坚定的用户攻击，并且您会面临更大的风险，即添加阻止合法用户使用您的应用程序的问题。我什至看到受[Hasp Dongles](http://www.aladdin.com/hasp/default.aspx)保护的代码被破解。加密您的许可证密钥和混淆您的代码应该足以阻止机会主义攻击，除此之外没有什么意义。

[Eric Sink](http://www.ericsink.com/about_author.html)写了一篇很好的文章涵盖了这一点，请参阅“[透明原则”的](http://www.ericsink.com/bos/Transparency.html)[“4\. 不要惹恼诚实的人”](http://www.ericsink.com/bos/Transparency.html)部分

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-05T15:55:06.003

即使没有Reflector，人们也已经这样做了很长时间。基本上，您使用调试器观察应用程序——WinDBG 之类的东西会做——然后找出许可证检查何时发生。您观察返回值，然后简单地修补应用程序以直接跳转到“一切正常”检查。

我会推荐人们在上面发布的所有内容。您只需要意识到这是一场猫捉老鼠的游戏，并且您的投资回报是否值得。如果您的用户不想玩弄系统，那么一些简单的事情可能会做。如果你有一些东西在破解猖獗，那么你将不得不考虑不同的策略并从那里开始。

您不必重新编译应用程序来修补它 - 那里存在大量二进制修补工具。如果有足够的钱可以赚到，它也不会阻止你最坚定的饼干。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-12-10T10:46:46.553

“也”

任何一种“标准”/通常的许可证检查机制都是自动删除工具的目标。在我反思过的少数商业 .NET 应用程序中，这些“太琐碎”的检查似乎很常见。

最好的办法是通过使程序的一部分依赖于 Web 服务来保护。这不应该是太繁琐的界面以避免减慢执行速度，但也不应该是非常厚实的，因为这些块可以在“破解版”中下载并在本地缓存，除非应用程序依赖于它们经常更改。

如果您想避免网络连接（某些用途或用户可能会根据应用程序发现有问题/有问题，除非它是您描述并提供价值的东西）然后将一些程序拆分为一个或两个本机 dll 并检查许可证应用程序的所有部分，以及在本机 dll 中不太明显的部分，可能足以阻止大多数。

# mysql - 在 Ubuntu 上运行 Rails 时遇到问题

> ID：265302
> 
> 赞同：0
> 
> 时间：2008-11-05T14:36:29.953
> 
> 标签：mysql, ruby-on-rails, ruby, communityengine

首先是一些背景。我正在尝试在全新安装的 Ubuntu 上运行[社区引擎。](http://www.communityengine.org/)CE 是一个在 Rails 上运行的开放 src 社交网络插件。我能够在没有问题的情况下在我的 Windows 盒子上启动并运行 CE。我现在决定使用 Ubuntu 8.10 作为我的开发环境，并且被困在这个问题上。在过去的几个晚上，我对此进行了研究，但仍然被困住。

发生的事情是，当我到达指令的这一步时（[在此处找到](http://github.com/bborn/communityengine/tree/master)）：

```
 Generate the community engine migrations:

  $ script/generate plugin_migration 
```

我收到以下错误：

```
myuser@compy:~/Projects/MyProject$ script/generate plugin_migration
/home/myuser/Projects/MyProject/config/../vendor/plugins/engines/boot.rb:4: This version of the engines plugin requires Rails 2.1.1 or later! (RuntimeError)
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
    from /home/myuser/Projects/MyProject/config/environment.rb:12
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
    from /home/myuser/Projects/MyProject/vendor/rails/railties/lib/commands/generate.rb:1
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
    from script/generate:3 
```

这是我的红宝石版本：

```
myuser@compy:~/Projects/MyProject$ ruby -v
ruby 1.8.7 (2008-08-11 patchlevel 72) [i486-linux] 
```

和我安装的宝石：

```
myuser@compy:~/Projects/MyProject$ gem list

*** LOCAL GEMS ***

actionmailer (2.2.0, 2.1.2, 2.1.1)
actionpack (2.2.0, 2.1.2, 2.1.1)
activerecord (2.2.0, 2.1.2, 2.1.1)
activeresource (2.2.0, 2.1.2, 2.1.1)
activesupport (2.2.0, 2.1.2, 2.1.1)
aws-s3 (0.5.1)
builder (2.1.2)
capistrano (2.5.0)
cgi_multipart_eof_fix (2.5.0)
daemons (1.0.10)
fastthread (1.0.1)
gem_plugin (0.2.3)
haml (2.0.4)
highline (1.4.0)
hpricot (0.6.164)
htmlentities (4.0.0)
mime-types (1.15)
mongrel (1.1.5)
net-scp (1.0.1)
net-sftp (2.0.1)
net-ssh (2.0.4)
net-ssh-gateway (1.0.0)
rails (2.2.0, 2.1.2, 2.1.1)  <--- clearly I have rails 2.1.1 or greater
rake (0.8.3)
RedCloth (4.1.0)
rmagick (2.7.1)
sqlite3-ruby (1.2.4)
xml-simple (1.0.11) 
```

当我也只有 rails 2.1.1 时，我得到了这个错误。

是的，我拥有的宝石比 CE 所需的要多，但在试图追查这一点时，这就是我最终得到的。我有一个偷偷摸摸的怀疑，无论问题是什么，它都是愚蠢的，我应该抓住它。但在这一点上，我对 XP 盒子上的简单过程感到非常沮丧。

我在 Community Engine google group 中问过这个问题，但是，我感觉这与我在机器上设置 Ruby 和 Rails 的关系比与 CE 本身更相关。

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T20:27:45.423

“问题”不是来自 CommunityEngine 本身，而是来自底层的“引擎”插件（[http://github.com/lazyatom/engines](http://github.com/lazyatom/engines)）。

[查看引擎插件中 boot.rb 的源代码，](http://github.com/lazyatom/engines/tree/master/boot.rb)我们可以看到它只是检查标准 Rails::VERSION 字段，所以问题也不存在。

现在，当您创建一个 rails 应用程序时，它与*您第一次创建 rails 应用程序时*使用的特定版本相关联。只是将 rails 2.1.1/2 gems 放在您的系统上并不意味着它们会自动被使用。

要检查您的实际 rails 应用程序本身，请查看您的 rails 应用程序中的`config/environment.rb`文件。你会看到这样的东西：

```
# Specifies gem version of Rails to use when vendor/rails is not present
RAILS_GEM_VERSION = '2.1.0' unless defined? RAILS_GEM_VERSION 
```

如果它低于 2.1.1，那么您需要升级您的 rails 应用程序。
这很简单：

1.  `RAILS_GEM_VERSION`将字符串更改`config/environment.rb`为 2.1.1 或更高版本
2.  跑`rake rails:upgrade`

希望这可以解决您的问题:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T20:47:33.747

这个问题最终是由于没有使用 sudo 来安装 rails。我最终完全吹走红宝石并重新安装它。我还密切关注了我需要安装的各种 gem 的输出，以确保它们下载并运行。令我惊讶的是，其中许多都无法下载，必须运行第二次，甚至第三次才能安装。

关于 Orion 的建议，我检查了 RAILS_GEM_VERSION 并且它是 2.1.1 或更高版本。这就是这个问题最令人困惑的原因，因为它说需要什么版本，然后 gem -v 会告诉我正确的版本。

# delphi - Delphi 2009 项目配置选项集的层次结构如何？

> ID：265304
> 
> 赞同：4
> 
> 时间：2008-11-05T14:37:02.620
> 
> 标签：delphi, delphi-2009

Delphi 2009 引入了用于项目选项配置的分层系统，您可以在其中设置“基本”选项，然后使用自己的选项集具有不同的构建样式。但是你能进一步扩展层次结构吗？当然，我的大部分编码都使用调试选项，但有时在某些特殊情况下，我需要一组稍微不同的调试选项。我真的很希望能够设置一个基本的调试配置，然后在它下面设置三个更具体的配置，但我找不到任何选项来做到这一点。在 D2009 中是不可能的，还是我只是错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T15:07:57.737

是的，这很简单。

在项目管理器中，只需右键单击“调试”配置，然后选择“新建配置”。您的新配置将以您期望的方式显示为“调试”的后代。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T16:36:16.013

构建配置是完全分层的。您可以在配置中创建所需的任何层次结构深度。可以继承任何构建配置，并且层次结构可以任意深。

此外，您可以使用选项集来更改任何给定的配置。将选项集保存在文件中，并随时将其应用于您喜欢的任何配置。

我认为可以肯定地说，Delphi 2009 中的构建配置系统与您希望的一样灵活和强大。

# encryption - AES加密，示例代码

> ID：265305
> 
> 赞同：-1
> 
> 时间：2008-11-05T14:37:23.400
> 
> 标签：encryption, aes

如何对 GUID 执行 AES 加密？

在客户端计算机上，我们将存储一个 GUID 和他们的公钥，我们的内部服务器将拥有私钥和他们的 guid。

这是生成 AES 加密的所有必要输入吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T14:40:20.010

[AES](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)是一种对称加密算法（加密和解密密钥相同）。如果您在谈论公钥和私钥，则需要一种[非对称加密算法](http://en.wikipedia.org/wiki/Public-key_cryptography)，例如 RSA。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T15:14:43.793

您可以加密任何可以表示为字节流的内容。您问题中“配方”中唯一缺少的成分是加密密钥：

```
void encrypt(char *plaintext, char *key, char *crypt)
{
  // Encrypt plaintext with the key, returning the result in crypt.

} 
```

**笔记：**

*   使用 PKI（公钥/私钥），每个参与者通常以安全的方式维护自己的*私钥*并自由分发其*公钥*。消息使用收件人的公钥加密*，**并由*每个收件人使用*私钥*解密。从问题的措辞来看，您正在使用此模型并不明显。

***   Jesse 为演示目的提供了一个很好的示例。请记住，您可能*不想*在生产应用程序中对密钥进行硬编码..** 

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T14:49:23.827

这是使用 AES (Rijndael) 对字符串数据进行快速加密/解密：

```
private static readonly byte[] rgbKey = Encoding.UTF8.GetBytes("Ni=9OE=$i+62eprIuDr@ewOu5I9r34Ro"); // change to your own secure key

private static readonly byte[] rgbIv = Encoding.UTF8.GetBytes("to$eO_e!maI*o3ut"); // change to your own secure initialization vector

public static string Encrypt(string originalString)
{
    if (string.IsNullOrEmpty(originalString))
    {
        throw new ArgumentNullException(
           "originalString",
           "The string which needs to be encrypted can not be null.");
    }

    using (var cryptoProvider = new RijndaelManaged())
    using (var memoryStream = new MemoryStream())
    using (var encryptor = cryptoProvider.CreateEncryptor(rgbKey, rgbIv))
    using (var cryptoStream = new CryptoStream(memoryStream, encryptor, CryptoStreamMode.Write))
    using (var writer = new StreamWriter(cryptoStream))
    {
        writer.Write(originalString);
        writer.Flush();
        cryptoStream.FlushFinalBlock();
        writer.Flush();
        return Convert.ToBase64String(memoryStream.GetBuffer(), 0, (int)memoryStream.Length);
    }
}

public static string Decrypt(string encryptedString)
{
    if (string.IsNullOrEmpty(encryptedString))
    {
        throw new ArgumentNullException(
           "encryptedString",
           "The string which needs to be decrypted can not be null.");
    }

    using (var cryptoProvider = new RijndaelManaged())
    using (var memoryStream = new MemoryStream(Convert.FromBase64String(encryptedString)))
    using (var decryptor = cryptoProvider.CreateDecryptor(rgbKey, rgbIv))
    using (var cryptoStream = new CryptoStream(memoryStream, decryptor, CryptoStreamMode.Read))
    using (var reader = new StreamReader(cryptoStream))
    {
        return reader.ReadToEnd();
    }
} 
```

# project-management - 在固定长度/固定价格的项目中使用 Scrum？

> ID：265319
> 
> 赞同：7
> 
> 时间：2008-11-05T14:40:33.363
> 
> 标签：project-management, scrum, project-planning, estimation

我是 Scrum 新手，希望在我的公司实施 Scrum。获得支持不是问题，这是我的公司和开发人员非常乐意像这样工作。

问题是我们 75% 的收入来自固定长度/固定价格的项目。

Ken Schwaber 在他的书《Agile Project Management with Scrum》中，在书末的附录中涵盖了对固定长度/固定价格项目进行投标的主题。

经过深思熟虑后，Ken 得出结论，只有当您可以说服潜在客户以不同的方式思考时，Scrum 才有用。客户必须接受很多不确定性（关于最终成本和最终交付日期），以换取更快获得可能可用的东西，并且不必实现每个功能的可能性可以为他们节省资金。

我不相信这是在固定长度/固定价格项目中实施 Scrum 的唯一方法。

我想知道其他人如何成功竞标并从固定长度/固定价格项目中获利。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-05T15:08:48.017

是的。我想你可以。请参阅[瀑布不起作用](http://homepage.mac.com/s_lott/iblog/architecture/C551260341/E20080211062302/index.html)。

“走出固定价格框”并不是那么难的对话。客户也看到了失败。他们已经看到了获取需求文档的长时间延迟。他们已经看到了无穷无尽的变更单。他们也不喜欢。

但是，如果您确信客户不想以不同的方式管理事物，则必须采用混合方法。

编造价格不是敏捷——不可能。为了安抚顽固的客户，您必须制定价格。显然，您将在这里制定某种总体规划来证明价格合理。大多数情况下，你从这个总体规划中想要的只是积压工作。其他细节只不过是假设的规划假设。[他们**总是在**计划假设，但一些 PM 认为最初的计划是必须遵循的神圣预言。它不是。]

然后，您以小的、敏捷的、增量的步骤执行。您必须尽早并经常与用户互动，并且必须让对话发生。但！待办事项中的每一项变更都必须作为范围、成本或进度的潜在变更进行检查。

在每个 sprint 结束时，任何积压的更改都可能是项目范围和合同的更改。

敏捷可以降低您的风险，因为您可以更早、更高效地与客户一起积极地进行范围变更。试图定义（和冻结）范围不是增值活动，所以不要再这样做了。将范围视为猜测，并在每个 sprint 中处理范围更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T15:00:33.603

我不确定投标和利润，但 Scrum 方法当然可以应用于固定长度/价格的项目。如果需求是已知且可靠的，则可以将它们放入产品待办列表中，并且可以根据需求和时间限制来计划冲刺。您仍然可以利用每日 Scrum 会议、燃尽图等的好处来确保项目保持在正轨上。

# c# - 如何导入具有“不正确”文件名的 CSV 文件？

> ID：265324
> 
> 赞同：2
> 
> 时间：2008-11-05T14:42:52.593
> 
> 标签：c#, .net, file, csv, import

好的，我正在 C# 应用程序中导入和解析 csv 文件。我开始做一个简单的 ReadLine() 并以逗号分隔，但结果发现某些文本字段中有逗号。所以我开始推出自己的拆分功能。幸运的是，就在几分钟后，“嘿，笨蛋，可能已经有人这样做了？” 灯亮了，经过几分钟的搜索，我意识到我可以通过 OleDb 连接到目录并以这种方式导入它们。这就像一个冠军，直到我遇到了一些文件名中带有逗号和括号的文件。然后它爆炸了。关于让它从这样的文件导入的任何建议？不，我无法控制输入文件名。有些可能会直接从 CD 中读取，所以我暂时无法更改文件名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T14:50:13.453

我用过这个[CsvReader](http://www.codeproject.com/KB/database/CsvReader.aspx)，效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T14:48:32.237

将这些文件复制到 %TEMP% 文件夹，并为其命名`Path.GetTempFileName()`. 您只需要跟踪所有文件名，以便之后删除它们。

效率不高，但会工作;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T14:51:21.017

您可以按逗号拆分，但通过搜索以双引号开头和结尾的字段对然后重新组合它们来处理数据。

您可以在遇到双引号时手动查找逗号，同时打开和关闭 quoteFound 布尔值，并在 quoteFound 为真时忽略遇到的任何逗号。

您可以首先将源代码复制到应用程序目录，然后通过在末尾添加“.csv”来重命名所有文件。

我很确定我用正则表达式以一种令人愉快的聪明方式做到了这一点，但我不知道它是我的哪个项目，所以我没有代码可以提供。

ETA：我还认为，如果您正在读取 SQL Server，您可以使用 SqlBulkCopy 类，然后您可以根据需要查询它。

# project-management - Sprint 长度 - 2 周 vs 30 天

> ID：265332
> 
> 赞同：9
> 
> 时间：2008-11-05T14:44:36.053
> 
> 标签：project-management, scrum, project-planning

我想实施 Scrum，但我无法决定 Sprint 的长度。Ken Schwaber 似乎将 30 天与事实上联系起来……但我无法想象等待 30 天而没有改变方向或重新确定优先级的可能性。

我们的项目使用瀑布方法通常只能持续 1-3 个月，而转向 Scrum 可能意味着更少的微调机会。

我在考虑 1 周的冲刺，但这似乎是 Scrum 微管理。

进行 2 周的 sprint 可能是理想的，但我想知道其他人是否能够成功实现这一点。有什么缺点？管理冲刺时间较短的团队是否需要更多的工作/更少的工作/相同的工作？

顺便说一句... 3 周的 sprint 对我来说似乎很奇怪，谁来做 3 周的 sprint？为什么不让它4周。;)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-05T14:49:48.833

我曾在进行 1 周、2 周和 4 周冲刺的团队中工作过。这实际上取决于您的组织。我更喜欢 1 或 2 周的冲刺。我目前管理的团队正在进行 4 周的 sprint，因为我们正在协调 12 种不同产品的工作。我希望尽快将它们移至 2 周迭代。

定义长度的关键是“完成，完成”。对于某些团队来说，这意味着在生产中。对于其他人来说，这可能意味着由企业验证以使用内部版本满足他们的需求。我会先定义完成，完成，然后看看如何围绕它构建你的 sprint。理想情况下，所有故事都在 sprint 结束时完成——而且你不只是在做 Scrummerfall。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T14:50:32.420

我喜欢两周。它在问题上强制设置合理的时间框，但让您以更快的速度看到结果。30天是永远的。对于像网站这样快速发展的产品来说，一周很容易成为正确的节奏。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-03-26T06:35:50.537

我进行了 1、2、3 和 4 周的冲刺。1 周的 sprint 太短，无法完成团队承诺，2 周是理想的，当我尝试实施 3 或 4 周的 sprint 时，我们无法有效地利用 QA 团队。（QA第一周会有更多的空闲时间）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T15:13:25.730

产品负责人应该总是有机会改变优先级和方向。SCRUM 的目的之一是接受变化，并通过查看负责按时交付的业务需求和开发团队来让产品所有者负责优先级。

因此，即使您有 3 周的 sprint，也并不意味着产品负责人必须等待 3 周才能发现（可能）会破坏 sprint 的东西。

在极少数情况下，您必须在中间停止冲刺并创建新的冲刺，因为新信息或新优先级。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T20:34:30.980

> 我在考虑 1 周的冲刺，但这似乎是 Scrum 微管理。

是的，但这会让你做更多的 Scrum：你每周都会做一个 sprint 计划、一个迭代演示和一次回顾。缺点是开销，但是，与为期一个月的迭代相比，您花在计划、演示和“回顾”一周迭代上的时间更少。

迭代越短，团队学习流程的速度就越快。

现在，根据项目的类型，可能很难在一周的延迟内完成有价值的事情。

在我忘记之前，我不做三周迭代:o)

如果您进行四个星期的迭代，您还可以用估计相同时间的任务替换*尚未开始的任务。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T14:47:22.910

2 周（如果您是 MF 装备，则为 10 个标准工作日；如果您是 MS 装备，则为 12 个标准工作日）是半个月（一个月通常有大约 20 个工作日，给予或接受）。此外，周比日更模糊，但比月更模糊，因此它使以周为单位的度量单位更适合更敏捷（更多给予/接受）的开发项目。

然而，我最后一次做类似 scrum 的事情是在一个学校项目中，它并不是真正的 scrum。所以在一个 10 周的季度中是 7 天的周。我真的很喜欢这种情况下的 2 周块。我觉得我可以完成很多工作，但我们可以经常调整时间表和计划。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-05T14:54:12.353

现在我们正在进行 30 天的冲刺，并完成了桩。30 天 sprint 对我们很有效的一个原因是，我们的计划和估算通常需要 2 天（收集并决定从积压工作中提取哪些高级任务，获取高级任务并分解它们，对分解后的任务进行估算）任务，然后分配它们）。我们还留出 2-3 天的时间进行错误修复和测试。

我们已经在那里工作了 5 天，所以进行 2 周的 sprint 只会给我们留下 5 天的研发时间。到目前为止，30 天对我们来说是一个很好的平衡。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-05T14:54:44.923

Sprint 长度可能因项目而异，但在同一项目中应保持不变。最好的办法是尝试为您的团队找到最舒适的 sprint 长度，我已经使用 Scrum 两年了，现在我们解决了 20 个工作日的 sprint。

我的经验告诉我，在需要快速交付和相对简单的编程（CRUD 操作、简单的网格和表单等）的项目中，最好选择较短的 sprint，比如两周。对于复杂性较高的事物（例如框架），可能最好进行更长的冲刺，例如四个星期的冲刺。我目前的项目倾向于最后一个选项。

但重要的是选择适合团队和产品负责人的长度。

# xml - 如何在 t-sql 中检索分层 XML？

> ID：265335
> 
> 赞同：0
> 
> 时间：2008-11-05T14:46:23.867
> 
> 标签：xml, tsql

我的表具有以下架构：

id、parent_id、文本

鉴于以下数据，我想返回一个 xml 层次结构：

数据：(1,null,'x'), (2,1,'y'), (3,1,'z'), (4,2,'a')

XML：
[row text="x"]
[row text="y"]
[row text="a"/]
[/row]
[row text="z"/]
[/row]

* * *

补充：层次结构没有最大深度

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T15:27:34.047

如果你有一个有限的深度，那么会有一个看起来像这样的快捷方式：

```
SELECT T.*, T2.*, T3.* /*, ...*/ FROM myTable T 
INNER JOIN myTable T2 ON T2.parent_id=T.id
INNER JOIN myTable T3 ON T3.parent_id=T2.id
/* ... */
WHERE T.parent_id IS NULL
FOR XML AUTO 
```

我不确定，但有可能使用[递归查询](http://msdn.microsoft.com/en-us/library/ms186243.aspx)设计出类似的结果。当然，在应用程序级别更容易（并且可能更有意义）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-05T14:51:03.637

这需要“传递闭包”。您需要递归处理数据以查找给定父级下的所有子级。

算法大致是这样的。

```
for top in cursor( nodes where  each parent==null ):
    build_tree( top )

def build_tree( parent ):
    emit opening tag
    for child in cursor( nodes where parent == parent ):
        build_tree( child )
    emit closing tag 
```

请注意，某些 SQL 解释器可能会遇到递归问题——它们可能不会根据需要打开新的游标。但是，每个游标都必须是不同的，因为您将拥有与树的级别一样多的打开游标。

# .net - 在 PowerShell 中自动化安全 FTP 的最佳方法是什么？

> ID：265339
> 
> 赞同：27
> 
> 时间：2008-11-05T14:46:54.300
> 
> 标签：.net, powershell, ftp, ftps

我想使用 PowerShell 自动下载数据库备份文件。文件名包含日期，所以我不能每天都运行相同的 FTP 脚本。是否有一种内置于 PowerShell 或使用 .NET 框架的干净方法来执行此操作？

我想使用安全的 FTP 会话。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-06T14:41:12.050

经过一些实验后，我想出了这种在 PowerShell 中自动进行安全 FTP 下载的方法。该脚本在由 Chilkat Software 管理的[公共测试 FTP 服务器上运行。](http://www.secureftp-test.com/)因此，您可以复制并粘贴此代码，它无需修改即可运行。

```
$sourceuri = "ftp://ftp.secureftp-test.com/hamlet.zip"
$targetpath = "C:\hamlet.zip"
$username = "test"
$password = "test"

# Create a FTPWebRequest object to handle the connection to the ftp server
$ftprequest = [System.Net.FtpWebRequest]::create($sourceuri)

# set the request's network credentials for an authenticated connection
$ftprequest.Credentials =
    New-Object System.Net.NetworkCredential($username,$password)

$ftprequest.Method = [System.Net.WebRequestMethods+Ftp]::DownloadFile
$ftprequest.UseBinary = $true
$ftprequest.KeepAlive = $false

# send the ftp request to the server
$ftpresponse = $ftprequest.GetResponse()

# get a download stream from the server response
$responsestream = $ftpresponse.GetResponseStream()

# create the target file on the local system and the download buffer
$targetfile = New-Object IO.FileStream ($targetpath,[IO.FileMode]::Create)
[byte[]]$readbuffer = New-Object byte[] 1024

# loop through the download stream and send the data to the target file
do{
    $readlength = $responsestream.Read($readbuffer,0,1024)
    $targetfile.Write($readbuffer,0,$readlength)
}
while ($readlength -ne 0)

$targetfile.close() 
```

我在这些链接中找到了很多有用的信息

*   [FTP 下载：编码问题](http://www.techtalkz.com/microsoft-windows-powershell/190388-ftp-downloads-encoding-problems.html)
*   [简单的 FTP 演示应用程序](http://www.codeproject.com/KB/IP/SimpleFTPDemo.aspx)
*   [非常简单的 FTP 客户端](http://rcovelo.blogspot.com/2008/10/powershell-very-simple-ftp-client.html)

如果要使用 SSL 连接，则需要添加该行

```
$ftprequest.EnableSsl = $true 
```

在调用 GetResponse() 之前添加到脚本。有时您可能需要处理过期的服务器安全证书（就像我不幸的那样）。[PowerShell 代码库](http://poshcode.org/634)中有一个页面，其中包含执行此操作的代码片段。前 28 行与下载文件最相关。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-05T15:04:57.883

取自[这里](http://www.vistax64.com/powershell/17000-using-powershell-automate-ftp-transfers.html)：

```
$source = "ftp://ftp.microsoft.com/ResKit/win2000/dureg.zip"
$target = "c:\temp\dureg.zip"
$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($source, $target) 
```

这个对我有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T20:25:36.037

就 PowerShell 而言，/n Software [NetCmdlets](http://nsoftware.com/powershell/)包包括 FTP cmdlet（包括对两种安全 FTP 类型的支持），您可以很容易地为此使用它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-07T00:49:41.723

JAMS Job Scheduler 提供了一些 cmdlet，可以简化此任务。它有多种用于安全会话的 FTP cmdlet 以及用于将自然日期转换为 .NET 日期对象的日期 cmdlet，例如“一个月的最后一天”：

[JAMS 作业计划程序 Cmdlet](http://www.jamsscheduler.com/PowerShell.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-06-05T14:33:09.897

@Eric 投票最多的自我回答是有效的，但它是：

*   只有 1KB 缓冲区效率低下；
*   重新实现不必要的复杂，可以轻松，更有效地完成[`Stream.CopyTo`](https://docs.microsoft.com/en-us/dotnet/api/system.io.stream.copyto)：

```
$fileUrl = "ftp://ftp.example.com/remote/path/file.zip"
$localFilePath = "C:\local\path\file.zip"

$downloadRequest = [Net.WebRequest]::Create($fileUrl)
$downloadRequest.Method = [System.Net.WebRequestMethods+Ftp]::DownloadFile
$downloadRequest.Credentials =
    New-Object System.Net.NetworkCredential("username", "password")
# Enable secure FTPS (FTP over TLS/SSL)
$downloadRequest.EnableSsl = $True

$sourceStream = $downloadRequest.GetResponse().GetResponseStream()
$targetStream = [System.IO.File]::Create($localFilePath)
$sourceStream.CopyTo($targetStream);

$sourceStream.Dispose()
$targetStream.Dispose() 
```

* * *

如需上传，请参阅[使用 PowerShell 通过 FTP 上传文件](https://stackoverflow.com/q/1867385/850848#46582183)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T15:03:25.967

这并不像我希望的那么简单。我知道有三个选项。

1.  .NET - 您可以使用 .NET 框架在 PowerShell 中执行此操作，但它涉及我不想在脚本中执行的原始套接字操作。如果我要走这条路，那么我会将所有 FTP 垃圾打包到 C# 中的 DLL 中，然后使用 PowerShell 中的 DLL。

2.  操作文件 - 如果您知道每天需要获取的文件名称的模式，那么您可以使用 PowerShell 打开您的 FTP 脚本并更改脚本中的文件名。然后运行脚本。

3.  将文本通过管道传输到 FTP - 最后一个选项是使用 PowerShell 将信息通过管道传输到 FTP 会话中。见[这里](http://jameslikesbeer.blogspot.com/2007/03/look-what-you-can-do-in-powershell-ftp.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-16T16:25:04.750

像这样的东西可以工作：

```
$bkdir = "E:\BackupsPWS" #backups location directory
$7Zip = 'C:\"Program Files"\7-Zip\7z.exe' #compression utility
$files_to_transfer = New-Object System.Collections.ArrayList #list of zipped files to be   transferred over FTP
$ftp_uri="myftpserver"
$user="myftpusername"
$pass="myftppassword"

# Find .bak files not zipped yet, zip them, add them to the list to be transferrd
get-childitem -path $bkdir | Sort-Object length |
where { $_.extension -match ".(bak)" -and
        -not (test-path ($_.fullname -replace "(bak)", "7z")) } |
foreach {
    $zipfilename = ($_.fullname -replace "bak", "7z")
    Invoke-Expression "$7Zip a $zipfilename $($_.FullName)"
    $files_to_transfer.Add($zipfilename)
}

# Find .bak files, if they've been zipped, delete the .bak file
get-childitem -path $bkdir |
where { $_.extension -match ".(bak)" -and
        (test-path ($_.fullname -replace "(bak)", "7z")) } |
foreach { del $_.fullname }

# Transfer each zipped file over FTP
foreach ($file in $files_to_transfer)
{
    $webclient = New-Object System.Net.WebClient
    $webclient.Credentials = New-Object System.Net.NetworkCredential($user,$pass) # FTP credentials
    $ftp_urix = $ftp_uri + "/" + $file.Substring($bkdir.Length + 1) # ftp address where to transfer   the file
    $uri=[system.URI] $ftp_urix
    $webclient.UploadFile($uri, $file) #transfer the file
} 
```

检查这个：[Powershell：压缩备份和 FTP 传输](http://jhonatantirado.wordpress.com/2011/06/26/powershell-compress-backups-and-ftp-transfer/)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-05T17:20:20.467

我已成功使用 Indy Project .NET 库进行 FTP。而且......呃，看起来托管的 .NET 版本不再可用。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-05T17:28:55.223

```
$realdate = (Get-Date).ToString("yyyyMMdd")

$path = "D:\samplefolderstructure\filename" + $realdate + ".msi"

ftps -f $path -s:D:\FTP.txt 
```

ftp.txt 是我们将所有连接信息保存到 FTP 服务器的方式。`ftps`显然是我们使用的客户端，因此您可能需要更改一些内容。但是，这应该可以帮助您了解这个想法。

# sharepoint - 如何使用 Sharepoint API 检查 Sharepoint 文档库是否设置了 Require Approval 标志？

> ID：265342
> 
> 赞同：9
> 
> 时间：2008-11-05T14:47:23.100
> 
> 标签：sharepoint, sharepoint-api

能够检查“需要结帐”标志也很有用。我认为它可能是 SPDocumentLibrary 对象上的一个属性，但我看不到它。

我是否需要查看其中一个管理命名空间...？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-05T18:36:59.140

需要批准由 Microsoft.SharePoint.SPList 类上的布尔属性 EnableModeration 表示。要求签出由同一类上的属性 ForceCheckout 控制。记住还要调用 SPList 类的 Update() 方法来保存对数据库的更改。

# validation - 在 Web 客户端上自动复制业务逻辑

> ID：265343
> 
> 赞同：2
> 
> 时间：2008-11-05T14:48:04.423
> 
> 标签：validation

上周我在前端实现了日期验证，结合了 ASP.NET 和严重依赖大量 JavaScript 代码，以避免在实际保存表单之前服务器往返。我觉得这个规则检查不在服务器上进行，这很笨拙，但我们当前的架构和性能要求阻止了这一点。它现在不在我的手中。

理想情况下，这个检查应该在两个地方都完成，但是服务器端检查将使用整洁的、键入的、C# 来完成，并且对在该 BO 上工作的开发人员立即可见，而客户端检查实际上甚至不需要副本来完成，这是狡猾的，但完全不同的代码。

有什么方法可以在客户端实际复制服务器端检查？使用一个规则引擎，并在每一侧由两个受信任的规则引擎应用相同的规则，实际上将服务器检查委托给 JavaScript 完成，然后将其注册到呈现的客户端中，这似乎是另一种选择，但似乎具有挑战性。

关于这个相当学术与实际问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T14:55:45.517

ASP.NET 的验证控件可以做到这一点。

> ASP.NET 验证控件还提供两种验证方式：服务器端或客户端。这些 Validation 控件的好处是，当它检测到浏览器能够运行时，它将执行客户端验证（除非客户端验证已被禁用）。从而减少往返。并且它将在必要时执行服务器端。此客户端/服务器端检测和验证无需开发人员额外工作即可完成！

[http://www.devhood.com/Tutorials/tutorial_details.aspx?tutorial_id=46](http://www.devhood.com/Tutorials/tutorial_details.aspx?tutorial_id=46)

否则，您将不得不遵循相同的模型。创建设置规则，然后在两侧实施它们中的每一个（如果可以的话，在控件中）。然后，允许开发人员选择将哪个规则应用于哪个 html 控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T14:56:22.690

好吧，您将永远无法在客户端中自动复制服务器端验证代码，因为

1.  语言（javascript vs. C#）太不同了
2.  服务器端代码通常会提供客户端中不存在的数据

但是，将验证代码完全委托给服务器是完全可行的。当然，出于完全相同的两个原因，这是此类代码的最佳位置。使用 Ajax 技术和 WebRequest 对象，客户端中的简短验证存根可以很容易地调用服务器端验证函数，而无需回发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T15:23:53.447

我从未这样做过，但似乎您可以在服务器上的一个位置编写验证代码，然后让您的 Web 应用程序直接访问验证代码，而每个客户端页面使用 AJAX 访问相同的 Web 服务公开代码。

在 .NET 世界中，这可以简单地通过将验证代码编写为 Web 服务来完成。AJAX 客户端和服务器应用程序本身将调用此 Web 服务中的方法来进行验证（注意：从安全角度来看，这可能是一个坏主意 - 我不知道）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T11:48:20.010

我认为一个简单的规则引擎是你最好的选择。根据您要执行的验证，它不需要太复杂。

其他任何事情都将涉及到服务器的额外往返（以在 C# 中执行所有验证）或让服务器执行 JavaScript（我相信这比实现规则引擎要困难得多）。

唯一的选择是复制代码（就像微软一样）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T16:06:57.377

请参阅：[MVC 验证 - 使用服务层保持 DRY - 最佳实践是什么？](https://stackoverflow.com/questions/8074548/mvc-validation-keep-it-dry-with-a-service-layer-what-is-best-practice)

我能找到的最好的解决方案是在你的视图模型上推荐装饰，它使用 MVC，可以在客户端和服务器上产生一些验证。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-21T00:08:02.833

良好的做法是系统条目应进行验证以确保保持一致性。因此，在您的场景中，系统的入口是 Web 应用程序后端。所以你需要在那方面进行验证。让我举个例子，假设我创建了一个自动化工具，将数据发布到您的 Web 应用程序并且不涉及任何 UI，但如果该工具不提供 firstName，它应该无法记录数据。

从您的解释来看，您的 Web 应用程序似乎也包含服务层，但是当您的系统被分为服务层和 Web 应用程序（作为愚蠢的 UI）只是为了收集用户输入时，这将更加明显。

现在您仍然需要（或者至少也更好）为 UI 进行 ui 验证，以及您提到的更好的用户体验。不应放置 UI 验证以真正防止用户在数据一致性方面将该字段留空，因为无论如何服务层都不会（也不应该）让用户使用。但这更多是为了更好的用户体验（UX），以便用户获得更快的反馈。

有时，在 UI 和服务层上发生的检查类型在逻辑上是相似的。假设名字不应该为空。然后可以以某种方式共享逻辑，但是很多时候，您无法在客户端进行检查，因为您需要一些外部数据、资源、信息……进行验证。例如，可用库存项目的数量不能少于 10。在这种情况下，您无法拥有该信息，或者如果可以，它是无关紧要的。因为您必须在保存部分进行验证，这可能会在用户提交表单时更改。

因此，如果这是您拥有这两种验证类型的场景，那么最好使用服务端验证，并且在客户端，您也可以将信息（以异步方式）传递给服务并返回结果。像[这样的服务方决定](http://www.flexrule.com/archives/javascript-decision-as-a-service/)。如果您在一种情况下混合使用这些验证，那么我什至不会费心将它们拆分为仅 UI 和服务验证，因为整个验证我都会去服务。

# c# - 使用 WinForms 阻止 System.Windows.SplashScreen 关闭应用程序

> ID：265351
> 
> 赞同：1
> 
> 时间：2008-11-05T14:49:21.020
> 
> 标签：c#, .net, wpf, winforms

我正在使用 System.Windows.SplashScreen 向我的 WinForms 应用程序添加启动画面（它有很多 WPF 控件，但“主窗口”仍然是 System.Windows.Forms.Form 对象）。当启动画面关闭时，整个应用程序也会运行。

我可以阻止它使用整个应用程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T04:33:36.347

是的，执行 Application.Run 调用很重要。该调用将程序的控制权转移到您指定的任何主要形式。然后程序将继续运行，直到该表单关闭。如果您不进行该调用，则 Main() 函数将保留控制权，并且在 Main() 退出时应用程序将退出。这是由 VB.NET IDE 在幕后完成的，尽管它可以在应用程序选项卡上的应用程序设置窗口中被覆盖，您可以在其中指定启动表单。在 C# 中，如果您指定 Windows 窗体项目，此代码通常由代码模板添加，但如果您打开空白项目，则不会看到它。希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T15:04:07.013

我对这个问题有点太快了——看起来这里的问题取决于我是如何开始应用程序的。如果你这样做：

```
form.ShowDialog(); 
```

然后表单的父级设置为启动屏幕，因此当它关闭时它也会关闭子窗口（在本例中为“表单”），但如果您使用：

```
System.Windows.Forms.Application.Run(form) 
```

要启动应用程序，则“表单”不是初始屏幕的子项，因此不会随初始屏幕关闭。

# jms - activemq中TCP端点的简单路由有什么问题？

> ID：265361
> 
> 赞同：2
> 
> 时间：2008-11-05T14:52:04.790
> 
> 标签：jms, activemq, apache-camel

我正在尝试从 ActiveMQ 开始一个简单的演示，它将演示 TCP 到 TCP 的路由。我在我的 activemq.xml 配置文件中的骆驼上下文中对端点和路由进行编码。

```
<camelContext id="camel" xmlns="http://activemq.apache.org/camel/schema/spring">

    <package>org.myorg.codec</package>

    <endpoint id="listener_A" uri="mina:tcp://localhost:42000?sync=false&amp;textline=true"/>
    <endpoint id="listener_B" uri="mina:tcp://localhost:42001?sync=false&amp;textline=true"/>

    <route>
        <from uri="activemq:listener_A"/>
        <to uri="activemq:listener_B"/>
    </route>
    <route>
        <from uri="activemq:listener_B"/>
        <to uri="activemq:listener_A"/>
    </route>
</camelContext> 
```

知道为什么这不起作用吗？

AMQ 服务器似乎没有打开监听端口。

编辑：作为一个简单的演示，这里的意图是使用两个 telnet 终端（A 和 B）连接到 ActiveMQ，并能够通过消息队列服务器将消息从一个路由到另一个。稍后，我可能会尝试根据内容进行过滤或路由。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T15:45:36.227

我对你的配置文件有点困惑。你到底想做什么？

您已经定义了 2 个使用 MINA 的端点（根本不使用 ActiveMQ）；然后您使用从 ActievMQ 队列 listener_A 到 listener_B 然后 listener_B 到 listener_A 的路由（这是一个递归循环）。

也许如果您开始描述您想要做什么，我们可以弄清楚 XML 应该是什么样子。

顺便说一句，如果您只想引用已定义的端点，请使用*ref="name"*属性而不是*uri="..."*。

例如

```
<route>
  <from ref="listener_A"/>
  <to ref="listener_B"/>
</route> 
```

话虽如此 - 您往往会通过[Camel 用户论坛获得更好、更快的 Camel 支持](http://activemq.apache.org/camel/discussion-forums.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T23:01:01.293

更多关于这个：

当端点定义为mina tcp连接时，无法识别为“activemq::listener_A”

```
<endpoint id="listener_A" uri="mina:tcp://localhost:42000?sync=false&amp;textline=true"/> 
```

这是错误的：

```
 <from uri="activemq:listener_A"/> 
```

这有效：

```
 <from ref="listener_A"/> 
```

这样做：

```
 <from ref="mina:tcp://localhost:42000?sync=false&amp;textline=true"/> 
```

# vb.net - 如何在不使用 Outlook 的情况下在 Exchange Server 2003 中创建日历事件/约会？

> ID：265362
> 
> 赞同：0
> 
> 时间：2008-11-05T14:52:13.027
> 
> 标签：vb.net, exchange-server

有没有办法在 Exchange Server 2003 中创建 - 操作日历事件？我正在使用 VB.NET 2005。我不想使用 MAPI，因为每次我都必须输入用户名和密码。还有其他方法吗？我使用了 redemption.dll 但每次我想添加例如。一个日历事件，它显示登录屏幕。

有什么建议么 ？

感谢你的帮助

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T17:08:12.847

我从事过一个操作约会的项目（当我第一次开始编程时），从 VB 开始，当时最简单的 Exchange 约会途径（避免 MAPI）是使用名为 Interop.Microsoft.Office 的 Office Core 和 Outlook 互操作 API。 Core.dll 和 Interop.Outlook.dll。由于这是针对桌面计算机上的应用程序，您需要在同一个机器上安装 Outlook，但这可能已经改变（大约 4-5 年前）。

或者使用 CDO 库（包装 MAPI API），我认为您不需要安装 Outlook，而且这些库使用起来相对容易（而且速度更快）。不过现在可能已经被取代了。

顺便说一句，一个名为 OutlookSpy 的应用程序在当时被证明对于检查交换运行时对象非常宝贵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T15:04:33.017

查看 WebDAV。显然，WebDAV 在定期约会方面存在一些限制，但界面简单有效。

检查[MSDN 库](http://msdn.microsoft.com/en-us/library/aa142661(EXCHG.65).aspx)。

# windows - UTF-16 到 UTF-8 的转换（用于 Windows 中的脚本）

> ID：265370
> 
> 赞同：13
> 
> 时间：2008-11-05T14:54:55.550
> 
> 标签：windows, utf-8, batch-file, cmd, utf-16

将 UTF-16 文件转换为 UTF-8 的最佳方法是什么？我需要在 cmd 脚本中使用它。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-05T19:28:22.640

有一个 GNU 工具[重新编码](http://www.gnu.org/software/recode/recode.html)，您也可以在 Windows 上使用它。例如

```
recode utf16..utf8 text.txt 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-05T15:17:41.073

Ruby 的替代方法是用 C# 编写一个小的 .NET 程序（.NET 1.0 会很好，虽然 2.0 会更简单:) - 这是一段非常简单的代码。您是否希望在没有任何其他应用程序的情况下做到这一点？如果您想要一些代码来做到这一点，请添加评论，我会填写答案...

编辑：好的，这没有任何错误检查，但是......

```
using System;
using System.IO;
using System.Text;

class FileConverter
{
  static void Main(string[] args)
  {
    string inputFile = args[0];
    string outputFile = args[1];
    using (StreamReader reader = new StreamReader(inputFile, Encoding.Unicode))
    {
      using (StreamWriter writer = new StreamWriter(outputFile, false, Encoding.UTF8))
      {
        CopyContents(reader, writer);
      }
    }
  }

  static void CopyContents(TextReader input, TextWriter output)
  {
    char[] buffer = new char[8192];
    int len;
    while ((len = input.Read(buffer, 0, buffer.Length)) != 0)
    {
      output.Write(buffer, 0, len);
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-05T14:58:42.250

当然，**最简单**的方法是将脚本加载到记事本中，然后使用 UTF-8 编码再次保存。这是另存为对话框中的一个选项。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-05T16:59:49.337

也许与[iconv](http://www.fileformat.info/tip/linux/iconv.htm "使用 iconv 更改字符编码")？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-04-22T22:28:28.247

您可以使用内置的 PowerShell cmdlet 轻松完成此操作，您可以从 cmd 调用它：

```
C:\> powershell -c "Get-Content mytext.txt | Set-Content -Encoding utf8 mytext_utf8.txt" 
```

编辑：显然，如果您已经在 powershell 中，这将被简化。使用别名也可以简化事情：

```
> gc mytext.txt | sc -Encoding utf8 mytext_utf8.txt 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T15:07:49.360

如果您安装了 ruby​​ 发行版，则可以调用 ruby​​ 脚本来处理转换：

[用于转换文件字符编码的 Ruby 脚本](http://www.websideattractions.com/2007/10/24/ruby-script-to-convert-files-character-encoding/)

本着同样的精神：[Perl 脚本](http://www.perlmonks.org/?node_id=719216)

在没有脚本支持的情况下，您必须使用 WideCharToMultiByte() 调用像这个[C++ 源代码一样对其进行编码......](http://www.codeproject.com/KB/string/utfConvert.aspx)

# sql - SQL Server 和生成 xml 与 xml auto，元素

> ID：265371
> 
> 赞同：0
> 
> 时间：2008-11-05T14:55:22.427
> 
> 标签：sql, sql-server, xml, tsql

我正在开发一个应用程序，该应用程序从我们的数据库中获取数据，并在生成的查询末尾使用 FOR XML AUTO、ELEMENTS 输出一个 xml 文件，然后使用 XSLT 以我们想要的方式对其进行转换。然而，在我们使用 sql 标量函数生成一些数据的特定情况下，它总是将该元素放入一个子表节点中，该节点与它已经在其中的表节点命名相同（所以说它是一个表 xyz，它会是`print("<xyz><node1></node1><xyz><generated-node-from-function></generated-node-from-function></xyz>");`

无论我尝试什么（甚至直接操作应用程序生成的 sql 副本），它似乎总是会创建这个额外的节点层，这会在我们稍后尝试处理这个 xml 以提取数据时导致问题。是否有任何特定属性导致 sql server 中的 xml 生成器以这种方式工作，是否有任何方法可以阻止它，以便我可以将生成的数据节点与其关联的表的其余数据保持在同一级别？

编辑：在某些情况下重命名列/表，否则应该是相同的 sql。

```
SELECT * FROM (SELECT column1,column2,column3,iduser,jstart,jstop,jbatchperiod,jinactive,processed,column4,lock,column5,batchticketmicr,machineid,sjobopex,szopexrefid,jreceived,jstartopex,jstopopex,idspecialmicr,idp2batchoriginal,stateflags,bcrossrefid,bidentifier1,bidentifier2,bidentifier3,bidentifier4,bidentifier5,idexport,idimport,rsahash FROM table1) table1
  LEFT JOIN (SELECT column21,ienvelope,isort,column1,idtemplate,processed,column4,lock,envelopetypecode,szqueuesvisitedunique,exportdate,jcompleted,status,ipriority,idbankaccount,iprioritybeforerzbump,fstoredrecondata,cscountyid,column10,column11,checkbox1,checkbox2,column12,column13,column14,xxxempfein,column15,column16,originalenvelopeid,column17,column18,xxxoag,trackingnumber,csldc,ecrossrefid,postmark,routingflags,eidentifier1,eidentifier2,eidentifier3,eidentifier4,eidentifier5,idexport FROM envelope) envelope ON table1.column1=Envelope.column1
  LEFT JOIN (SELECT column21,column22,isort,column23,processed,side,pagetypecode,rawmicrline,rawscanline,rawbarcode,exportid,szlocandconf,szlocandconfpagefields,idformtemplate,szparms,rawmarksense,audittrail,audittrailelectronic,pixheight,pixwidth,ocrattemptcounter,idspecialmicr,idpageexception,pagemodifierflags,column10,csldc,rejectdate,rejectuser,rejectqueue,fsupervisorreject,xxxempno,xxxtraceno,xxxemplcnt,checkbox1,keyword,templatealtered,templateflags,pidentifier1,pidentifier2,pidentifier3,pidentifier4,pidentifier5,isscanlinevalid,idexport,clickcount FROM Table2) Table2 ON Envelope.column21=Page.column21
  LEFT JOIN (select column22, column21, dbo.Fileimagepath(column21, column22) as path from Table2) Fileimg ON Table2.column21=FileImg.column21 AND Table2.column22=FileImg.column22
 WHERE Envelope.column21 = 8
 FOR XML AUTO, ELEMENTS 
```

另一个编辑：基本上 FileImg 的结果与其余数据一起包含在现有 table2 选项卡内的一组额外的 Table2 标记中。

另一个编辑：使用相同的 sql 对另一个数据库进行测试，它可以正常工作，我的数据库中似乎有一个错误的设置，或者存储的过程不同*，需要进一步调查*。

如果这不起作用，我会尝试上面的其他一些建议，感谢到目前为止的帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T16:11:04.350

我会尝试摆脱子查询部分“（SELECT ...”并进行常规连接，例如：

```
SELECT table1.column1, table1.column2, ..., envelope.column21, ...
FROM   table1 LEFT JOIN envelope on table1.column1 = envelope.column1 ...
WHERE  envelope.column21 = 8
FOR XML AUTO, ELEMENTS 
```

为了更清楚，我省略了您的大部分列和连接。只需插入您需要的列和必要的 njoin。

这会给您返回正确的 XML 还是我错过了重点？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T16:35:07.140

我无法使用我的一项功能重现它（我尝试以与您相同的方式进行操作）。

但我有一个怀疑：`FileImagePath`函数中是否有一个不用于最终结果的 SELECT 查询？也许这会创建您正在体验的工件？

尝试插入

```
return 'test' 
```

作为函数的第一行*（如果您可以在开发数据库中执行此操作 - 或者您是唯一使用该函数的人）*。看看，如果行为改变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T16:36:08.403

看看 FOR XML EXPLICIT - 它更复杂，但您可以根据需要定义结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T23:19:54.343

做一些进一步的研究，到目前为止，它似乎在 2000 兼容模式下运行 db，而在 2005 sql 服务器上创建了这个问题，在确认之前不会固定这个。

# keyboard-shortcuts - 用于最小化、最大化、恢复和移动窗口的 PuTTY 快捷方式

> ID：265374
> 
> 赞同：36
> 
> 时间：2008-11-05T14:56:44.297
> 
> 标签：keyboard-shortcuts, putty

Alt+Space 命令在 Putty 上不起作用（至少对我而言）。所以，如果我必须最小化或最大化我的 PuTTY 窗口，我将不得不使用非常不舒服的鼠标。有没有人解决这个问题？

谢谢你的时间！

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-11-05T14:59:22.577

没关系，有一个设置。

窗口 -> 行为 ->（系统菜单出现在 Alt+SPACE 复选框上）

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-10-07T07:55:10.757

在 Windows 上，有一些特定的键盘快捷键有助于窗口行为。我知道的一些是：

1.  窗口键 + 向上 = 最大化
2.  window key + down = Restore Down/Undo Maximize + Minimize（要在最小化后恢复窗口，请使用 Alt + tab）
3.  窗口键 + 右 = 拆分到右半部分
4.  窗口键 + 左 = 拆分到左半边

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-05T15:07:04.370

您应该转到窗口/行为并检查 Alt-Enter 上的全屏。保存会话，以便您可以使用此快捷方式转换为全屏模式。

# html - Visual Studio 2008 中的 HTML 格式

> ID：265375
> 
> 赞同：4
> 
> 时间：2008-11-05T14:57:04.030
> 
> 标签：html, visual-studio-2008, formatting

是否可以在 Visual Studio 2008 中关闭所有 HTML 格式？它只是把一切都搞砸了。例如，我将添加一个带有列、样式等的网格，它们都缩进并位于单独的行上。我将切换到设计视图或拆分视图，我刚刚所做的所有工作都在一条线上！这太令人沮丧了。

我在“选项”菜单中更改了一些内容，但有什么方法可以完全关闭它？

我通常不使用设计视图。我使用源视图输入我的标签和控件，但有时我会切换一秒钟来查看某些内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T15:10:32.973

*Tools-->Options-->Text Editor-->HTML-->Format*下有一些格式化选项， 虽然似乎没有关闭它的选项，但可能有一些东西可以定义你想要的方式格式化。

要重新格式化文档点击 ( `CTRL`+ `K`, `CTRL`+ `D`) 或*Edit-->Advanced-->Format Document*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T14:59:33.200

不要使用设计视图。一个好的 asp.net 开发人员不需要它。它只会带来比好处更多的头痛。

# directx - DirectX 可再发行包分解

> ID：265376
> 
> 赞同：3
> 
> 时间：2008-11-05T14:57:09.070
> 
> 标签：directx

我可以只重新分发 DirectX 包的一部分吗？（例如，只有 DirectDraw DLL，没有 Show/3D/等）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T18:30:11.043

否。来自 DirectX SDK Redist EULA：

> ## DirectX 软件开发工具包可再发行代码
> 
> 可再发行代码被标识为 DirectX SDK CD/Download 上以下“Redist”目录中的所有文件：
> 
> 重发/
> 
> 上述目录中的以下文件必须包含在 DirectX Runtime 的任何分发中。
> 
> DSetup32.dll DSetup.dll DXSetup.exe DXupdate.cab dxdllreg_x86.cab

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-30T06:28:32.120

答案是“是”和“否”，具体取决于您要询问的内容。您无法通过 DirectX SDK 在您的应用程序中提供任何“原始”DLL，您必须使用 DirectSetup。但是，您可以只包括您实际需要的 CAB，如[MSDN](http://msdn.microsoft.com/en-us/library/ee416805.aspx#small_installation_packages)中所述。

这实际上仅适用于 DirectX SDK 可选的并行组件，例如 D3DX、XAudio2 等。正如在[Not So DirectSetup](http://blogs.msdn.com/b/chuckw/archive/2010/09/08/not-so-direct-setup.aspx)中讨论的那样，DirectDraw 实际上是 Windows 操作系统的一部分。您不能使用从 DirectX 9.0c 开始的 REDIST 更新它，该版本包含在 Windows XP Service Pack 2、Windows Server 2003 Service Pack 1 和 Windows XP x64 Edition 中。DirectDraw*始终*存在。你所做的只是设置一个[你必须这么高才能骑这个骑](http://blogs.msdn.com/b/chuckw/archive/2010/02/24/what-s-in-a-version-number.aspx)操作系统版本检查并假设它已经安装，因为它是。这只是正确设置支持的最低操作系统版本的功能。

# asp.net - Web开发和后端调用效率

> ID：265379
> 
> 赞同：2
> 
> 时间：2008-11-05T14:58:12.703
> 
> 标签：asp.net, sql-server

这是场景：

您有一个由 Microsoft SQL Server 数据库支持的 ASP.Net 应用程序，对于本示例，不会有任何缓存。

对于 Web 应用程序中的每个页面，更高效的是：

尝试将您需要的所有内容压缩到一个（或几个）存储过程调用中，这些调用返回多个表，其中包含您需要的所有数据（您将其保存到数据集中），

*或者*

使每个调用分开（通过数据读取器读取每个调用），具体取决于它在逻辑上的意义。

我问的原因是我总是以第二种方式做事：创建连接到数据库的简单方法，并为我拥有的每个小任务获取一些数据（即填充特定下拉列表的方法，另一个用于主要信息的方法）页等）。

我担心的是，当请求一个页面时最终会发生什么，如果我查看服务器的 SQL 探查器，该单页请求最终将有多达 10 个左右的调用。是不是太过分了？在我看来，通过页面而不是任务来压缩数据收集似乎会更有效。有人对此有经验吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T15:00:25.757

我日常工作的很大一部分是开发一个由 600 多个表 sql 服务器数据库支持的大型 WinForms 应用程序。

我们这样做的第一种方法是尽量减少网络流量。人们相信，拥有一个鼓鼓囊囊的信封比一个装满信封的邮袋要好。

此外，捆绑传输数据不应与紧密耦合相混淆 - 用于收集数据的 SQL 可以像以往一样模块化，与伞式存储过程或视图轻轻绑定在一起。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T15:01:30.637

不要按页面对数据收集进行分组。您过于紧密地耦合数据和表示。如果明天数据必须放在差异页面上怎么办？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T15:16:53.833

启用连接池后，按照您的建议将多个数据库调用压缩为一个并没有太大优势（如果有的话）。通过多次调用数据库获取数据并没有错，即使每次调用都会打开和关闭数据库连接。这是因为启用池后，连接并不是每次都真正打开和关闭。

如果您的应用程序是 Windows 客户端应用程序，那么在客户端和服务器之间的网络速度特别低的情况下，将调用“捆绑”成一个可能是有意义的。您正在使用 Web 应用程序，因此这里的相关连接速度是在 Web 服务器和 DB 服务器之间，这应该不是问题。

捆绑您的数据只是额外的工作，没有任何回报。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T15:20:38.227

如果您真的想知道哪种方法更有效，您将不得不分析每种方法。每种方法都有太多变量，可能会在页面之间以及您的代码和我的代码之间产生不同的结果。

但一般来说：

*   一次以上的数据调用过多（sql 连接和网络流量开销），

*   尝试仅提取您需要的内容（如果必须，获取特定于您的页面的数据集），

*   调整查询性能。（使用适当的查询技术——参数化查询/存储过程、适当的索引等——比任何事情都更有帮助）

要添加到 fall 和 edg 的评论，您应该注意保持数据（模型）和页面（视图/演示）由控制器层隔离。可以使控制器层以您选择的任何一种方式（以更有效的方式）获取视图的数据。这种模式（MVC / MVP）将允许您拥有非常易于管理和可重用的代码，并允许您在测试不同方法时有更多的余地。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T17:21:36.610

不久前，当我在组合一个在不同页面上有许多下拉控件的 Web 应用程序时，我也有类似的担忧。我查看了 SQL Profiler，我得到了超过 20 次点击，只是为了填充我的下拉列表。这是我所做的，也许它会对你有所帮助。

我的选择表名称（虚构）

*   pl_usertypes
*   pl_projecttypes
*   pl_stattypes

所以我所做的是创建一个返回 DataSet 的静态方法 GetPicklistData(String[] tablename)。所以我的 Page_Load 方法看起来像这样：

```
protected void Page_Load(object sender, EventArgs e)
{
  DataSet ds = PicklistHelper.GetPicklistData(
      new String[]{"pl_usertypes","pl_projecttypes","pl_stattypes"});
  // Bind dropdowns
  ddl_a.DataSource = ds.Tables[0]; // pl_usertypes
  ddl_a.DataBind();

  ddl_b.DataSource = ds.Tables[1]; // pl_projecttypes
  ddl_b.DataBind();

  ddl_c.DataSource = ds.Tables[2]; // pl_stattypes
  ddl_c.DataBind();
} 
```

因此，当我检查 SQL Profiler 时，它会显示

```
Select * from pl_usertypes; Select * from pl_projecttypes; Select * from pl_stattypes; 
```

所以很明显 GetPicklistData() 正在构建我的选择语句。

这可能是我在“肛门”，但嘿，我不知道我为什么要查看 SQL Profiler。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T02:18:09.943

这不取决于您的内容后端更改的频率吗？您可以输出大量“用于 XML”的内容并让您的网站读取 xml

# haskell - Why is lazy evaluation useful?

> ID：265392
> 
> 赞同：129
> 
> 时间：2008-11-05T15:00:41.137
> 
> 标签：haskell, functional-programming, lazy-evaluation

I have long been wondering why lazy evaluation is useful. I have yet to have anyone explain to me in a way that makes sense; mostly it ends up boiling down to "trust me".

Note: I do not mean memoization.

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2008-11-05T15:07:46.693

Mostly because it can be more efficient -- values don't need to be computed if they're not going to be used. For example, I may pass three values into a function, but depending on the sequence of conditional expressions, only a subset may actually be used. In a language like C, all three values would be computed anyway; but in Haskell, only the necessary values are computed.

It also allows for cool stuff like infinite lists. I can't have an infinite list in a language like C, but in Haskell, that's no problem. Infinite lists are used fairly often in certain areas of mathematics, so it can be useful to have the ability to manipulate them.

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2008-11-12T14:51:15.100

A useful example of lazy evaluation is the use of `quickSort`:

```
quickSort [] = []
quickSort (x:xs) = quickSort (filter (< x) xs) ++ [x] ++ quickSort (filter (>= x) xs) 
```

If we now want to find the minimum of the list, we can define

```
minimum ls = head (quickSort ls) 
```

Which first sorts the list and then takes the first element of the list. However, because of lazy evaluation, only the head gets computed. For example, if we take the minimum of the list `[2, 1, 3,]` quickSort will first filter out all the elements that are smaller than two. Then it does quickSort on that (returning the singleton list [1]) which is already enough. Because of lazy evaluation, the rest is never sorted, saving a lot of computational time.

This is of course a very simple example, but laziness works in the same way for programs that are very large.

There is, however, a downside to all this: it becomes harder to predict the runtime speed and memory usage of your program. This doesn't mean that lazy programs are slower or take more memory, but it's good to know.

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2008-11-05T15:47:38.127

I find lazy evaluation useful for a number of things.

**First**, all existing lazy languages are pure, because it is very hard to reason about side effects in a lazy language.

Pure languages let you reason about function definitions using equational reasoning.

```
foo x = x + 3 
```

Unfortunately in a non-lazy setting, more statements fail to return than in a lazy setting, so this is less useful in languages like ML. But in a lazy language you can safely reason about equality.

**Secondly**, a lot of stuff like the 'value restriction' in ML aren't needed in lazy languages like Haskell. This leads to a great decluttering of syntax. ML like languages need to use keywords like var or fun. In Haskell these things collapse down to one notion.

**Third**, laziness lets you write very functional code that can be understood in pieces. In Haskell it is common to write a function body like:

```
foo x y = if condition1
          then some (complicated set of combinators) (involving bigscaryexpression)
          else if condition2
          then bigscaryexpression
          else Nothing
  where some x y = ...
        bigscaryexpression = ...
        condition1 = ...
        condition2 = ... 
```

This lets you work 'top down' though the understanding of the body of a function. ML-like languages force you to use a `let` that is evaluated strictly. Consequently, you don't dare 'lift' the let clause out to the main body of the function, because if it expensive (or has side effects) you don't want it always to be evaluated. Haskell can 'push off' the details to the where clause explicitly because it knows that the contents of that clause will only be evaluated as needed.

In practice, we tend to use guards and collapse that further to:

```
foo x y 
  | condition1 = some (complicated set of combinators) (involving bigscaryexpression)
  | condition2 = bigscaryexpression
  | otherwise  = Nothing
  where some x y = ...
        bigscaryexpression = ...
        condition1 = ...
        condition2 = ... 
```

**Fourth**, laziness sometimes offers much more elegant expression of certain algorithms. A lazy 'quick sort' in Haskell is a one-liner and has the benefit that if you only look at the first few items, you only pay costs proportional to the cost of selecting just those items. Nothing prevents you from doing this strictly, but you'd likely have to recode the algorithm each time to achieve the same asymptotic performance.

**Fifth**, laziness allows you to define new control structures in the language. You can't write a new 'if .. then .. else ..' like construct in a strict language. If you try to define a function like:

```
if' True x y = x
if' False x y = y 
```

in a strict language then both branches would be evaluated regardless of the condition value. It gets worse when you consider loops. All strict solutions require the language to provide you with some sort of quotation or explicit lambda construction.

**Finally**, in that same vein, some of the best mechanisms for dealing with side-effects in the type system, such as monads, really can only be expressed effectively in a lazy setting. This can be witnessed by comparing the complexity of F#'s Workflows to Haskell Monads. (You can define a monad in a strict language, but unfortunately you'll often fail a monad law or two due to lack of laziness and Workflows by comparison pick up a ton of strict baggage.)

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-11-21T16:21:47.530

There's a difference between normal order evaluation an lazy evaluation (as in Haskell).

```
square x = x * x 
```

Evaluating the following expression...

```
square (square (square 2)) 
```

... with eager evaluation:

```
> square (square (2 * 2))
> square (square 4)
> square (4 * 4)
> square 16
> 16 * 16
> 256 
```

... with normal order evaluation:

```
> (square (square 2)) * (square (square 2))
> ((square 2) * (square 2)) * (square (square 2))
> ((2 * 2) * (square 2)) * (square (square 2))
> (4 * (square 2)) * (square (square 2))
> (4 * (2 * 2)) * (square (square 2))
> (4 * 4) * (square (square 2))
> 16 * (square (square 2))
> ...
> 256 
```

... with lazy evaluation:

```
> (square (square 2)) * (square (square 2))
> ((square 2) * (square 2)) * ((square 2) * (square 2))
> ((2 * 2) * (2 * 2)) * ((2 * 2) * (2 * 2))
> (4 * 4) * (4 * 4)
> 16 * 16
> 256 
```

That's because lazy evaluation looks at the syntax tree and does tree-transformations...

```
square (square (square 2))

           ||
           \/

           *
          / \
          \ /
    square (square 2)

           ||
           \/

           *
          / \
          \ /
           *
          / \
          \ /
        square 2

           ||
           \/

           *
          / \
          \ /
           *
          / \
          \ /
           *
          / \
          \ /
           2 
```

... whereas normal order evaluation only does textual expansions.

That's why we, when using lazy evaluation, get more powerful (evaluation terminates more often then other strategies) while the performance is equivalent to eager evaluation (at least in O-notation).

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2008-12-10T09:45:33.827

If you believe Simon Peyton Jones, lazy evaluation is not important *per se* but only as a 'hair shirt' that forced the designers to keep the language pure. I find myself sympathetic to this point of view.

Richard Bird, John Hughes, and to a lesser extend Ralf Hinze are able to do amazing things with lazy evaluation. Reading their work will help you appreciate it. To good starting points are [Bird's magnificent Sudoku](http://www.haskell.org/haskellwiki/Sudoku#Sudoku_incrementally.2C_.C3.A0_la_Bird) solver and Hughes's paper on [Why Functional Programming Matters](http://www.cse.chalmers.se/~rjmh/Papers/whyfp.html).

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2010-01-29T21:43:33.630

Lazy evaluation related to CPU the same way as garbage collection related to RAM. GC allows you to pretend that you have unlimited amount of memory and thus request as many objects in memory as you need. Runtime will automatically reclaim unusable objects. LE allows you pretending that you have unlimited computational resources - you can do as many computations as you need. Runtime just will not execute unnecessary (for given case) computations.

What is the practical advantage of these "pretending" models? It releases developer (to some extent) from managing resources and removes some boilerplate code from your sources. But more important is that you can efficiently reuse your solution in wider set of contexts.

Imagine that you have a list of numbers S and a number N. You need to find the closest to number N number M from list S. You can have two contexts: single N and some list L of Ns (e.i. for each N in L you look up the closest M in S). If you use lazy evaluation, you can sort S and apply binary search to find closest M to N. For good lazy sorting it will require O(size(S)) steps for single N and O(ln(size(S))*(size(S) + size(L))) steps for equally distributed L. If you don't have lazy evaluation to achieve the optimal efficiency you have to implement algorithm for each context.

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-12-26T16:50:21.010

Consider a tic-tac-toe program. This has four functions:

*   A move-generation function that takes a current board and generates a list of new boards each with one move applied.
*   Then there is a "move tree" function which applies the move generation function to derive all the possible board positions that could follow from this one.
*   There is a minimax function that walks the tree (or possibly only part of it) to find the best next move.
*   There is a board-evaluation function that determines if one of the players has won.

This creates a nice clear separation of concerns. In particular the move-generation function and the board evaluation functions are the only ones that need to understand the rules of the game: the move tree and minimax functions are completely reusable.

Now lets try implementing chess instead of tic-tac-toe. In an "eager" (i.e. conventional) language this won't work because the move tree won't fit in memory. So now the board evaluation and move generation functions need to be mixed in with the move tree and minimax logic because the minimax logic has to be used to decide which moves to generate. Our nice clean modular structure disappears.

However in a lazy language the elements of the move tree are only generated in response to demands from the minimax function: the entire move tree does not need to be generated before we let minimax loose on the top element. So our clean modular structure still works in a real game.

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2011-10-02T04:19:25.620

Here are two more points which I do not believe have been brought up in the discussion yet.

1.  Laziness is a synchronization mechanism in a concurrent environment. It is a lightweight and easy way to create a reference to some computation, and share its results among many threads. If multiple threads attempt to access an unevaluated value, only one of them will execute it, and the others will block accordingly, receiving the value once it becomes available.

2.  Laziness is fundamental to amortizing data structures in a pure setting. This is described by Okasaki in *Purely Functional Data Structures* in detail, but the basic idea is that lazy evaluation is a controlled form of mutation critical to allowing us implement certain types of data structures efficiently. While we often speak of laziness forcing us to wear the purity hairshirt, the other way applies too: they are a pair of synergistic language features.

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2008-11-05T15:11:56.497

When you turn on your computer and Windows refrains from opening every single directory on your hard drive in Windows Explorer and refrains from launching every single program installed on your computer, until you indicate that a certain directory is needed or a certain program is needed, that is "lazy" evaluation.

"Lazy" evaluation is performing operations when and as they are needed. It is useful when it is a feature of a programming language or library because it is generally harder to implement lazy evaluation on your own than simply to precalculate everything up front.

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2012-10-02T09:20:24.097

1.  It can boost efficiency. This is the obvious-looking one, but it's not actually the most important. (Note also that laziness can *kill* efficiency too - this fact is not immediately obvious. However, by storing up lots of temporary results rather than calculating them immediately, you can use up a huge amount of RAM.)

2.  It lets you define flow control constructs in normal user-level code, rather than it being hard-coded into the language. (E.g., Java has `for` loops; Haskell has a `for` function. Java has exception handling; Haskell has various types of exception monad. C# has `goto`; Haskell has the continuation monad...)

3.  It lets you decouple the algorithm for *generating* data from the algorithm for deciding *how much* data to generate. You can write one function that generates a notionally-infinite list of results, and another function that processes as much of this list as it decides it needs. More to the point, you can have *five* generator functions and *five* consumer functions, and you can efficiently produce any combination - instead of manually coding 5 x 5 = 25 functions that combine both actions at once. (!) We all know decoupling is a good thing.

4.  It more or less forces you to design a *pure* functional language. It's always tempting to take short-cuts, but in a lazy language, the slightest impurity makes your code *wildly* unpredictable, which strongly militates against taking shortcuts.

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2008-11-05T15:07:33.260

Consider this:

```
if (conditionOne && conditionTwo) {
  doSomething();
} 
```

The method doSomething() will be executed only if conditionOne is true **and** conditionTwo is true. In the case where conditionOne is false, why do you need to compute the result of the conditionTwo? The evaluation of conditionTwo will be a waste of time in this case, especially if your condition is the result of some method process.

That's one example of the lazy evaluation interest...

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2009-06-19T19:04:34.507

One huge benefit of laziness is the ability to write immutable data structures with reasonable amortized bounds. A simple example is an immutable stack (using F#):

```
type 'a stack =
    | EmptyStack
    | StackNode of 'a * 'a stack

let rec append x y =
    match x with
    | EmptyStack -> y
    | StackNode(hd, tl) -> StackNode(hd, append tl y) 
```

The code is reasonable, but appending two stacks x and y takes O(length of x) time in best, worst, and average cases. Appending two stacks is a monolithic operation, it touches all of the nodes in stack x.

We can re-write the data structure as a lazy stack:

```
type 'a lazyStack =
    | StackNode of Lazy<'a * 'a lazyStack>
    | EmptyStack

let rec append x y =
    match x with
    | StackNode(item) -> Node(lazy(let hd, tl = item.Force(); hd, append tl y))
    | Empty -> y 
```

`lazy` works by suspending the evaluation of code in its constructor. Once evaluated using `.Force()`, the return value is cached and reused on every subsequent `.Force()`.

With the lazy version, appends are an O(1) operation: it returns 1 node and suspends the actual rebuilding of the list. When you get the head of this list, it will evaluate the contents of the node, forcing it return the head and create one suspension with the remaining elements, so taking the head of the list is an O(1) operation.

So, our lazy list is in a constant state of rebuilding, you don't pay the cost for rebuilding this list until you traverse through all of its elements. Using laziness, this list supports O(1) consing and appending. Interestingly, since we don't evaluate nodes until their accessed, its wholly possible to construct a list with potentially infinite elements.

The data structure above does not require nodes to be recomputed on each traversal, so they are distinctly different from vanilla IEnumerables in .NET.

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-11-05T15:38:27.130

This snippet shows the difference between lazy and not lazy evaluation. Of course this fibonacci function could itself be optimized and use lazy evaluation instead of recursion, but that would spoil the example.

Let's suppose we *MAY* have to use the 20 first numbers for something, with not lazy evaluation all the 20 numbers have to be generated upfront, but, with lazy evaluation they'll be generated as needed only. Thus you will pay only the calculation price when needed.

Sample output

```
Not lazy generation: 0.023373
Lazy generation: 0.000009
Not lazy output: 0.000921
Lazy output: 0.024205

```

```
import time

def now(): return time.time()

def fibonacci(n): #Recursion for fibonacci (not-lazy)
 if n < 2:
  return n
 else:
  return fibonacci(n-1)+fibonacci(n-2)

before1 = now()
notlazy = [fibonacci(x) for x in range(20)]
after1 = now()
before2 = now()
lazy = (fibonacci(x) for x in range(20))
after2 = now()

before3 = now()
for i in notlazy:
  print i
after3 = now()

before4 = now()
for i in lazy:
  print i
after4 = now()

print "Not lazy generation: %f" % (after1-before1)
print "Lazy generation: %f" % (after2-before2)
print "Not lazy output: %f" % (after3-before3)
print "Lazy output: %f" % (after4-before4) 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2011-10-03T03:49:39.303

Lazy evaluation is most useful with data structures. You can define an array or vector inductively specifying only certain points in the structure and expressing all others in terms of the whole array. This lets you generate data structures very concisely and with high run-time performance.

To see this in action, you can have a look at my neural network library called [instinct](http://hackage.haskell.org/package/instinct). It makes heavy use of lazy evaluation for elegance and high performance. For example I totally get rid of the traditionally imperative activation calculation. A simple lazy expression does everything for me.

This is used for example in the [activation function](http://hackage.haskell.org/packages/archive/instinct/0.1.0/doc/html/src/AI-Instinct-Brain.html#activation) and also in the backpropagation learning algorithm (I can only post two links, so you'll need to look up the `learnPat` function in the `AI.Instinct.Train.Delta` module yourself). Traditionally both require much more complicated iterative algorithms.

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2011-10-03T04:50:41.127

Other people already gave all the big reasons, but I think a useful exercise to help understand why laziness matters is to try and write a [fixed-point](http://en.wikipedia.org/wiki/Fixed_point_combinator) function in a strict language.

In Haskell, a fixed-point function is super easy:

```
fix f = f (fix f) 
```

this expands to

```
f (f (f .... 
```

but because Haskell is lazy, that infinite chain of computation is no problem; the evaluation is done "outside-to-inside", and everything works wonderfully:

```
fact = fix $ \f n -> if n == 0 then 1 else n * f (n-1) 
```

Importantly, it matters not that `fix` be lazy, but that *`f`* be lazy. Once you've already been given an strict `f`, you can either throw your hands in the air and give up, or eta expand it and clutter stuff up. (This is a lot like what Noah was saying about it being the *library* that's strict/lazy, not the language).

Now imagine writing the same function in strict Scala:

```
def fix[A](f: A => A): A = f(fix(f))

val fact = fix[Int=>Int] { f => n =>
    if (n == 0) 1
    else n*f(n-1)
} 
```

You of course get a stack overflow. If you want it to work, you need to make the `f` argument call-by-need:

```
def fix[A](f: (=>A) => A): A = f(fix(f))

def fact1(f: =>Int=>Int) = (n: Int) =>
    if (n == 0) 1
    else n*f(n-1)

val fact = fix(fact1) 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2010-01-29T21:54:03.563

I don't know how you currently think of things, but I find it useful to think of lazy evaluation as a library issue rather than a language feature.

I mean that in strict languages, I can implement lazy evaluation by building a few data structures, and in lazy languages (at least Haskell), I can ask for strictness when I want it. Therefore, the language choice doesn't really make your programs lazy or non-lazy, but simply affects which you get by default.

Once you think of it like that, then think of all the places where you write a data structure that you can later use to generate data (without looking at it too much before then), and you'll see a lot of uses for lazy evaluation.

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2013-11-10T17:28:09.783

Lazy evaluation is poor man's equational reasoning (which could be expected, ideally, to be deducing properties of code from properties of types and operations involved).

Example where it works quite well: `sum . take 10 $ [1..10000000000]`. Which we don't mind being reduced to a sum of 10 numbers, instead of just one direct and simple numeric calculation. Without the lazy evaluation of course this would create a gigantic list in memory just to use its first 10 elements. It would certainly be very slow, and might cause an out-of-memory error.

Example where it's not as great as we'd like: `sum . take 1000000 . drop 500 $ cycle [1..20]`. Which will actually sum the 1 000 000 numbers, even if in a loop instead of in a list; still it *should* be reduced to just one direct numeric calculation, with few conditionals and few formulas. Which *would* be a lot better then summing up the 1 000 000 numbers. Even if in a loop, and not in a list (i.e. after the deforestation optimization).

* * *

Another thing is, it makes it possible to code in [tail recursion modulo cons](https://en.wikipedia.org/wiki/Tail_call#Tail_recursion_modulo_cons) style, and it *just works*.

cf. [related answer](https://stackoverflow.com/a/30081318/849891).

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-11-06T14:22:34.270

The most useful exploitation of lazy evaluation that I've used was a function that called a series of sub-functions in a particular order. If any one of these sub-functions failed (returned false), the calling function needed to immediately return. So I could have done it this way:

```
bool Function(void) {
  if (!SubFunction1())
    return false;
  if (!SubFunction2())
    return false;
  if (!SubFunction3())
    return false;

(etc)

  return true;
} 
```

or, the more elegant solution:

```
bool Function(void) {
  if (!SubFunction1() || !SubFunction2() || !SubFunction3() || (etc) )
    return false;
  return true;
} 
```

Once you start using it, you'll see opportunities to use it more and more often.

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-11-29T11:17:32.573

Without lazy evaluation you won't be allowed to write something like this:

```
 if( obj != null  &&  obj.Value == correctValue )
  {
    // do smth
  } 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-12-04T22:34:53.500

Among other things, lazy languages allow multidimensional infinite data structures.

While scheme, python, etc allow single dimensional infinite data structures with streams, you can only traverse along one dimension.

Laziness is useful for the [same fringe problem](http://c2.com/cgi/wiki?SameFringeProblem), but it's worth noting the coroutines connection mentioned in that link.

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-11-05T15:14:07.273

If by "lazy evaluation" you mean like in combound booleans, like in

```
 if (ConditionA && ConditionB) ... 
```

then the answer is simply that the fewer CPU cycles the program consumes, the faster it will run... and if a chunk of processing instructions will have no impact on the the outcome of the program then it is unecessary, (and therefore a waste of time) to perform them anyway...

if otoh, you mean what I have known as "lazy initializers", as in:

```
class Employee
{
    private int supervisorId;
    private Employee supervisor;

    public Employee(int employeeId)
    {
        // code to call database and fetch employee record, and 
        //  populate all private data fields, EXCEPT supervisor
    }
    public Employee Supervisor
    { 
       get 
          { 
              return supervisor?? (supervisor = new Employee(supervisorId)); 
          } 
    }
} 
```

Well, this technique allows client code using the class to avoid the need to call the database for the Supervisor data record except when the client using the Employee object requires access to the supervisor's data... this makes the process of instantiating an Employee faster, and yet when you need the Supervisor, the first call to the Supervisor property will trigger the Database call and the data will be fetched and available...

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-07-14T17:48:58.247

Excerpt from [Higher order functions](http://learnyouahaskell.com/higher-order-functions)

> Let's find the largest number under 100,000 that's divisible by 3829. To do that, we'll just filter a set of possibilities in which we know the solution lies.

```
largestDivisible :: (Integral a) => a  
largestDivisible = head (filter p [100000,99999..])  
    where p x = x `mod` 3829 == 0 
```

> We first make a list of all numbers lower than 100,000, descending. Then we filter it by our predicate and because the numbers are sorted in a descending manner, the largest number that satisfies our predicate is the first element of the filtered list. We didn't even need to use a finite list for our starting set. That's laziness in action again. Because we only end up using the head of the filtered list, it doesn't matter if the filtered list is finite or infinite. The evaluation stops when the first adequate solution is found.

# silverlight - Expression Blend 2 创建 Silverlight 2 项目的问题？

> ID：265395
> 
> 赞同：1
> 
> 时间：2008-11-05T15:02:17.360
> 
> 标签：silverlight, silverlight-2.0, expression-blend, blend

我有 Expression Blend 2、Service Pack 1，但无法创建 Silverlight 2 项目。当我尝试创建 Silverlight 2 项目时，我收到以下错误：

> Blend 无法继续，因为找不到兼容的 Silverlight 版本。

几周前我安装了 Blend，昨天服务打包了它。我做事情的顺序如下：

1.  “老派”开发堆栈（VS 2005 Pro、SQL Server 2005 Express、SQL Server Mgmt Studio 2005、Infragistics 等，所有年代久远）
2.  Visual Studio 2008 开发团队版
3.  SQL Server 管理工作室 2008
4.  表达网 2
5.  Expression Blend 2（几周前有 2 - 5 个。）
6.  Silverlight SDK 2（昨天）
7.  Expression Blend 2 SP1（昨天下载然后安装）
8.  Expression Blend 2 SP1（昨天直接从 Microsoft 网站安装，在线阅读[此](http://social.expression.microsoft.com/Forums/en-US/blend/thread/2a58747b-1bd3-4bb3-8073-7d9ef912549b/)内容和[此](http://social.expression.microsoft.com/Forums/en-US/blend/thread/821e1fe9-df0b-4461-bf4b-20ecf6c51088)内容后。
9.  适用于 Visual Studio 2008 的 Silverlight 工具（昨天，在放弃 Blend 之后）

除了两个链接中描述的技术（我已经用尽了，但没有一个有效），有人有什么建议吗？最好的建议不涉及卸载和重新安装我的整个开发堆栈？:)

哦，对于它的价值，我在 64 位 Vista 上。但是，Expression 是一个 32 位应用程序（当然，运行时只有 32 位）。

[我已经（基本上）在Blend 自己的论坛](http://social.expression.microsoft.com/Forums/en-US/blend/thread/2442f10d-ac06-4633-a6c3-7e2d1e42681b)上发布了同样的问题。如果我在那里得到有效的回复，我会在此处发布，以防其他人遇到此问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T19:00:49.623

您安装了哪个版本的 Blend（版本号，不是服务包）？

根据[此表格发布](http://silverlight.net/forums/t/36181.aspx)问题得到解决：

> 该文件的旧版本也称为 BlendV2SP1_en.exe，大小为 18,241 KB，无法正常工作。Microsoft 在 2008 年 10 月 16 日早上和 10 月 17 日早上之间的某个时间更新了此 Service Pack。

以及更详细的解释：

> 将您的 Blend 版本 2.1.1693 更新为 2.1.1760.0

此外，我没有看到 Silverlight 运行时的任何安装。你也有那个insalled吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T19:48:27.360

布莱恩特明白了，但我想更全面地解释一下，以防其他人陷入这个陷阱。是的，我安装了错误的 SP1。（这甚至不应该是可能的，但是......无论如何。）

我去了[微软网站上的 SP1 页面](http://www.microsoft.com/downloads/details.aspx?FamilyId=EB9B5C48-BA2B-4C39-A1C3-135C60BBBE66&displaylang=en)，并阅读了该页面。阅读该页面后，我选择了“安装 Expression Blend 2 SP1”的链接。

那是我的错误。这会下载旧版本的服务包。（至少在撰写本文时。）

单击页面顶部的“下载”按钮会提供正确的服务包，我似乎已关闭并正在运行。果然，按钮下载的版本号是正确的，我现在可以创建一个Silverlight 2应用程序项目。

布莱恩特，再次，非常感谢。（任何甚至考虑支持这个答案的人都应该支持他的答案；我不应该得到代表，他应该。）如果我能给你更多的代表你的答案，我会心跳加速。

# javascript - 重构一个使用 window.open 来使用 DOM 而不是 write() 的函数

> ID：265398
> 
> 赞同：2
> 
> 时间：2008-11-05T15:03:27.620
> 
> 标签：javascript, dom, web-standards

我有一个`window.open()`用于生成动态弹出窗口的应用程序。`createElement`不幸的是，我在使用标准 DOM 函数（ , `appendChild`）创建新窗口的内容时遇到了麻烦，我已经使用`document.write()`它来生成页面。

具体来说，我该怎么做：

```
function writePopup()
{
    var popup = window.open("", "popup", "height=400px, width=400px");
    var doc = popup.document;
    doc.write("<html>");
    doc.write("<head>");
    doc.write("<title>Written Popup</title>");
    doc.write("</head>");
    doc.write("<body>");
    doc.write("<p>Testing Write</p>");
    doc.write("</body>");
    doc.write("</html>");
    doc.close();
} 
```

对于使用 DOM 创建相同弹出窗口的函数？

编辑：我确实考虑过使用绝对定位的元素来模拟弹出窗口，虽然它看起来更好，但用户需要能够打印显示的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T15:38:54.523

Just doing quick tests, I can get doc to append DOM created HTML to my popup like so:

```
var popup = window.open("", "popup", "height=400px, width=400px"); 
var doc = popup.document.documentElement;
var p = document.createElement("p"); 
p.innerHTML = "blah"; 
doc.appendChild(p); 
```

My example produces totally invalid HTML I know, but it works (with limited testing obviously).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T15:45:41.017

One dump of .innerHTML should perform better than a zillion lines of document.write();

I would build up the DOM as needed and dump in using

```
doc.innerHTML = newDOM; 
```

Still kind of hacky, but better than document.write();

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T14:24:12.613

> I've gone to using document.write() to generate the page.

I think you will probably have to use at least some document.write(), to put a skeleton page in place before you can interact with the DOM:

```
doc.write('<!DOCTYPE ...><html><head></head><body></body></html>');
doc.close();
doc.body.appendChild(...); 
```

Before write() has been called, a new window's document is in an indeterminate state, there is no document yet to interact with. Firefox at least puts a temporary skeleton document in until you first call document.write(), but I can't see that this is actually documented anywhere so it's probably best not relied upon.

> var popup = window.open("", "popup", "height=400px, width=400px");

No ‘px’ unit needed in window.open.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T15:07:34.040

为什么不使用诸如 [http://plugins.jquery.com/project/modaldialog](http://plugins.jquery.com/project/modaldialog)之类的库函数，而不是重新发明轮子呢？

[编辑] 或

```
function writePopup(){
    var popup = window.open("", "_blank", "height=400px, width=400px");
    var doc = popup.document;
    doc.title = 'Written Popup';

    var p = doc.createElement('p');
    p.innerHTML = 'Testing Write';
    doc.body.appendChild(p);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T15:08:56.050

Would it be possible to have another page that generates the dynamic content, and pop it open, passing arguments that identify the content you want generated, instead of trying to write to a new window?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-10-25T05:49:31.237

you could use something like

```
function writePopup(){
  var htmlString=[
    "<html>",
    "<head>",
    "<title>Written popup</title>",
    "</head><body>",
    "<p>Testing write</p>",
    "</body></html>"
  ].join("\n");
  window.open("data:text/html,"+encodeURIComponent(htmlString), "_blank", "height=400px, width=400px");
} 
```

# asp.net - 使用 jQuery ajax 时如何在 VB.NET 中捕获异常

> ID：265403
> 
> 赞同：2
> 
> 时间：2008-11-05T15:06:38.630
> 
> 标签：asp.net, jquery, vb.net, ajax, exception

我正在使用 jQuery 来处理我对用 VB 编码的 ASP.NET 站点的所有 ajax 需求。当我使用内置的 $.ajax 函数 POST 到代码隐藏函数并且出现异常时，它只是退出函数，并在客户端显示错误。

除了在编码时使调试变得困难之外，更大的问题是 Global.asax 中的 Application_Error 函数在发生这些异常时没有触发。这使得几乎不可能跟踪生产错误。

为什么它不会冒泡到 Application_Error？将代码隐藏函数包装在 Catch 语句中的答案是什么？

jQuery ajax 函数：

```
$.ajax({
    type: "POST",
    url: "page.aspx/GetData",
    data: "{'param':'" + param_value + "'}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",

    success: function(msg) {
        processData(msg);
    },

    error: function(XMLHttpRequest, textStatus, errorThrown) {
        alert("Error: " + textStatus + " - " + errorThrown);
    }
}); 
```

VB.NET 功能：

```
<Script.Services.ScriptMethod()> _
<WebMethod()> _
Public Shared Function GetData(ByVal param As Integer) As String
    'Parse some data
    Return data
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T17:44:08.357

I figured out a work around. Although I did not find a way to directly get the error to fire the Application_Error event, I discovered a property on the jQuery XMLHttpRequest object that contains the actual exception text.

Here is an example that will show the error in an alert:

```
error: function(XMLHttpRequest, textStatus, errorThrown) {
    alert("Error: " + XMLHttpRequest.responseText);
} 
```

Another idea is to submit the error via AJAX to a web method that will handle all the error event logic.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T16:43:39.137

使用 .Net 3.5，您可以拉入[ScriptManager 对象](http://www.asp.net/Ajax/Documentation/Live/overview/ScriptManagerOverview.aspx)并使用它注册您的 javascript，这允许 .Net 管理脚本（它不是 MS Ajax 的 jsut，它适用于第三方库），这可能是一个解决方案。

# jsp - 做一个通用的 在圣杯

> ID：265410
> 
> 赞同：2
> 
> 时间：2008-11-05T15:07:42.997
> 
> 标签：jsp, grails

这是一种从表中选择数据并使用 JSP 标签库在 HTML 表中显示结果的通用方法。在 Grails 中执行此操作的通用方法是什么？也就是说，使用几行 SQL 并在 Grails 中从头开始生成一个 HTML 表，包括作为标题的列名。

```
<sql:query var="results" dataSource="${dsource}">
    从 foo 中选择 *
</sql:查询>
（行数：${results.rowCount}）
<表格边框="1">
    <!-- 列标题 -->
    <tr bgcolor=青色>
        <c:forEach var="columnName" items="${results.columnNames}">
            <th><c:out value="${columnName}"/></th>
        </c:forEach>
    </tr>
    <!-- 列数据 -->
    <c:forEach var="row" items="${results.rowsByIndex}">
        <tr>
            <c:forEach var="column" items="${row}">
                <td><c:out value="${column}"/></td>
            </c:forEach>
        </tr>
    </c:forEach>
</table>

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T20:49:41.730

这个问题可以改写为，我如何像一个天真的 ASP.NET 开发人员那样编写代码？（并非所有 ASP.NET 开发人员都很天真，有些人可能相当优秀）

1.  您可以在 gsp 页面中使用任何静态方法。您可以使用任何 MyDomain.findBy、list()、从页面范围计算您想要的数量。
2.  您还可以使用条件查询 MyDomain.createCriteria() 然后您可以将结果传递给 taglib。

    但这一切似乎都违反了 MVC 原则。你的观点应该只是一个观点......

您所问的对于 grails 应用程序来说确实不是惯用的。我意识到这在 Microsoft 世界中很常见，执行查询，将其传递给数据网格....但是 Grails 中没有直接的类比，可能是有充分理由的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T16:59:00.150

您可以按照描述使用 taglib。您只需要让 Grails 意识到这一点。

# php - Are loops the best way to build a table?

> ID：265423
> 
> 赞同：2
> 
> 时间：2008-11-05T15:11:28.993
> 
> 标签：php, html, loops, html-table

I have to build an HTML table that shows data for users versus pages visited. It seems klunky to use for and/or foreach loops, but I can't think of anything better. I'm using PHP, but I would assume that this is language agnostic.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T15:15:26.317

Well, if you have multiple rows, with data formatted similarly in each row, I can't think of a way to create a table that avoids using a loop. That type of thing is basically what loops were invented for.

If you gave us more details on the table you want to build, maybe we can formulate a better method.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T15:21:11.970

Avoiding loops is probably not possible, if not in implementation, then it will still happen at machine level.

However, if you want to try stay 'pure' without nasty code, you can at least do:

```
$tableformat = '<table><thead>%s</thead><tbody>%s</tbody></table>';
$rowformat   = '<tr>%s</tr>'; 
$cellformat  = '<td>%s</td>'; 

$hdata = '';
foreach( $data[0] as $cellname => $cellvalue )
{
   $hdata  .= sprintf( $cellformat, $cellname ); 
}
$hdata = sprintf( $rowformat, $hdata ); 
$rdata = "";
foreach( $data as $rownum => $rowvalue ) 
{ 
   $row = "";
   foreach( $rowvalue as $colname => $colvalue ) 
   {
       $row .= sprintf( $cellformat, $colvalue );  
   }
   $rdata .= sprintf($rowformat,$row); 
}
return sprintf( $tableformat, $hdata, $rdata ); 
```

At least that way it might be somewhat maintainable. and you don't have much worry about incomplete strings.

You could also subsitutue some of that code with

```
 $hdata = "<tr><td>" . implode( "</td><td>", array_keys( $data[0] )) . "</td></tr>";
   $rdata .= "<tr><td>" . implode( "</td><td>", $rowvalue ) . "</td></tr>"; 
```

Which while being rather concise, will possibly get you in a bit of hot water eventually and it will need recoding. ( and implode internally runs a loop, so its a lose-lose ).

If you don't mind the over head of extra function calls ( and still running loops ) this could make for more concise code without too many negatives:

```
 $tableformat = '<table><thead>%s</thead><tbody>%s</tbody></table>';
 $rowformat   = '<tr>%s</tr>'; 
 $cellformat  = '<td>%s</td>'; 

function tr( $cells )
{  
   $o = "";
   foreach( $cells as $i => $v )
   {  
      $o .= sprintf( $cellformat, $v ); 
   }
   return sprintf( $rowformat, $o );  
}

return sprintf( $tableformat, 
               tr( array_keys($data[0])), 
               implode("", array_map( 'tr', $data )) ); 
```

But beware, thats hard to read, and you keep that up one day you'll wake up with lisp.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T15:15:58.627

If you don't use *some* kind of loop then you need to hardcode the number of rows and columns in your code, which is probably a much worse idea

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T15:16:24.570

If the data in the table is dynamic then you have to use a loop. Even if you get a component that generates the table for you, internally it will use a loop.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T15:56:24.003

I highly recommend the [Smarty](http://www.smarty.net/) templating engine for PHP. This will permit you to move your table (and the associated loop, which is unavoidable) into the template using Smarty syntax, so it will be clearer and more separated from your business logic. You would be able to replace nearly all the code in your example with a few simple tags in an HTML snippet. Check out the crash course on the Smarty page for an example of using a table.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T15:18:17.733

That depends on your definition of "best". FOR loops will do the job just fine. I'm not a PHP programmer, but in .NET, you can use the Repeater, a sort of template that you can use to declare the table HTML. It has templates for the header, the footer and each item. You bind a data source to the repeater, and it will generate the table HTML for you a bit more elegantly than using FOR loops. I imagine there might be some sort of templating equivalent in PHP.

In the end, though, even the Repeater uses some sort of loop...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-05T19:54:05.820

Why do you want to avoid loops? If you have a set of items, and you want to display each item, surely looping over the set is the obvious solution?

If you are trying to separate the model from the view, or write more readable code, good; but loops are not inherently bad.

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-05T16:07:48.163

I usually use loops and `implode` for this, in PHP. In a language, which supports functional programming I would do it differently.

```
function render_table($data) {
  $html = '<table>';
  $tr = array();
  foreach (array_keys($data[0]) as $key) {
    $tr[] = '<th>' . htmlspecialchars($key) . '</th>';
  }
  $html .= "\n" . '<thead>' . "\n" . '<tr>' . "\n" . implode("\n", $tr) . '</tr>' . '</thead>';
  $tbody = array();
  foreach ($data as $row) {
    $tr = array();
    foreach ($row as $value) {
      $tr[] = '<td>' . htmlspecialchars($value) . '</td>';
    }
    $tbody[] = '<tr>' . "\n" . implode("\n", $tr) . '</tr>';
  }
  $html .= "\n" . '<tbody>' . "\n" . implode("\n", $tbody) . '</tbody>';
  $html .= '</table>';
  return $html;
} 
```

# .net - 解析 XML 布尔属性（在 .NET 中）的最佳方法是什么？

> ID：265425
> 
> 赞同：20
> 
> 时间：2008-11-05T15:11:48.540
> 
> 标签：.net, xml, .net-2.0, boolean, xml-attribute

声明为 xs:boolean 的 XML 属性可接受为“true”、“false”、“0”或“1”。但是，在 .NET 中，Boolean.Parse() 将只接受“true”或“false”。如果它看到“0”或“1”，则会引发“错误格式”异常。

那么，鉴于此，将这样的值解析为布尔值的最佳方法是什么？

（不幸的是，我仅限于 .NET 2.0 解决方案，但如果 v3.5 提供了一些东西，我很想听听。）

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-05T15:19:03.767

我认为[XmlConvert](http://msdn.microsoft.com/en-us/library/e2104c2x.aspx)具有在公共语言运行时类型和 XML 类型之间进行转换的所有方法。尤其是[`XmlConvert.ToBoolean`](http://msdn.microsoft.com/en-us/library/system.xml.xmlconvert.toboolean.aspx)精确处理布尔值（有效字符串是“1”或“true”代表真，“0”或“假”代表假）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T15:16:16.473

使用`CBool`而不是`Boolean.Parse`应该可以解决问题：尽管您必须将其嵌入`try/catch`块中（使用 时不需要`Boolean.TryParse`），但它会成功转换大多数“合理”的布尔值，包括真/假和 0/1。

编辑：正如评论中指出的那样，这个答案对 C# 程序员来说有点没用，就像`CBool`VB-ism 一样。它映射到`Microsoft.VisualBasic.CompilerServices.Conversions::ToBoolean`，不适合一般消费。这使得在接受的答案中指出的 XMLConvert 类成为更好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T15:27:04.157

在尝试解析数据之前对其进行清理：

```
 string InnerText = yourXmlNode.InnerText;    
if (InnerText.Equals("0"))
    InnerText = "false";
else if (InnerText.Equals("1"))
    InnerText = "true"; 
```

*除了true*、*false*、*0*或*1*之外的任何其他条目仍将引发“错误格式”异常（应该如此）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-09T11:32:59.770

```
return value === 'true' || Number(value) 
```

# apache - Apache 白名单反向代理

> ID：265438
> 
> 赞同：3
> 
> 时间：2008-11-05T15:15:40.983
> 
> 标签：apache, reverse-proxy, whitelist

我们这里有一个反向代理，在 2.2.x 版本中运行 Apache 本质上我想创建一个白名单，以便只有有效的 URL 将通过代理并由 Web 服务器处理。您如何在 Apache 配置文件中执行此操作，或者您是否需要使用 SQUID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T16:08:09.380

创建一个包含所有有效 url 的文本文件并将其用作 RewriteMap。

```
# /tmp/bar.txt:
# /blah.cgi good
# /bar.cgi bad

RewriteMap foo /foo/bar.txt

RewriteCond ${foo:%{REQUEST_URI}} ^good$
RewriteRule ^/(.*)$ proxy:http://foobackend/$1 
```

# java - 使用 Jboss 5CR2 支持 EJB2

> ID：265442
> 
> 赞同：0
> 
> 时间：2008-11-05T15:16:48.047
> 
> 标签：java, jakarta-ee, jboss5.x, ejb-2.x

如何配置 Jboss 5 以支持 EJB2？

我正在测试新版本的 jboss (5) 并且需要部署我的旧 EJB2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T20:08:16.273

EJB3/J2EE5 合规性要求应用程序服务器保持与 EJB2 的兼容性和互操作性。据我所知，Jboss“默认”模式已经支持 EJB2。

# debugging - WinDbg，来自本机 32 位应用程序的 minidump 在 64 位 Windows 上崩溃，不会加载系统 DLL 的符号

> ID：265449
> 
> 赞同：6
> 
> 时间：2008-11-05T15:18:56.670
> 
> 标签：debugging, symbols, win64

我从我们的一个应用程序的崩溃中获得了一个小型转储文件。这是一个 32 位本机应用程序，它在 64 位 Windows 上运行。

如果我将 minidump 文件加载到 WinDbg 中，WinDbg 将不会加载系统 DLL 的符号。我的符号路径配置正确：

```
_NT_SYMBOL_PATH=SRV*C:\WebSymbols*http://msdl.microsoft.com/download/symbols 
```

...因为 WinDbg 正确加载了在 32 位 Windows 上创建的小型转储的符号。它只是不会为 SysWOW64 目录中的 DLL 加载符号。

我在 32 位 Windows 2003 上尝试了 32 位 WinDbg（来自调试工具 6.9），在 64 位 Windows 2008 上尝试了 64 位 WinDbg（也来自调试工具 6.9）。两者都无法加载符号。这是来自 32 位 WinDbg：

```
0:014> !sym 嘈杂
嘈杂模式 - 符号提示开启
0:014> .reload
..................................................... .....................................
加载卸载的模块列表
..
SYMSRV: C:\WebSymbols\ntdll.dll\48E714D0170000\ntdll.dll 未找到
SYMSRV：http://msdl.microsoft.com/download/symbols/ntdll.dll/48E714D0170000/ntdll.dll 未找到
DBGENG: C:\Windows\SysWOW64\ntdll.dll - 无法从磁盘映射图像。
无法加载映像 C:\Windows\SysWOW64\ntdll.dll，Win32 错误 0n2
DBGENG：ntdll.dll - 部分符号图像加载缺少图像信息
DBGHELP：模块未完全加载到内存中。
DBGHELP：使用调试器提供的数据搜索符号。
SYMSRV：C:\WebSymbols\wntdll.pdb\6686D0C5D0554E14953396093DA218A92\wntdll.pdb 未找到
SYMSRV：http://msdl.microsoft.com/download/symbols/wntdll.pdb/6686D0C5D0554E14953396093DA218A92/wntdll.pdb 未找到
DBGHELP：wntdll.pdb - 找不到文件
*** 警告：无法验证 ntdll.dll 的时间戳
*** 错误：模块加载完成，但无法为 ntdll.dll 加载符号
DBGHELP：ntdll - 未加载符号
SYMSRV: C:\WebSymbols\kernel32.dll\48E7156Cf0000\kernel32.dll 未找到
SYMSRV：http://msdl.microsoft.com/download/symbols/kernel32.dll/48E7156Cf0000/kernel32.dll 未找到
DBGENG: C:\Windows\SysWOW64\kernel32.dll - 无法从磁盘映射图像。
无法加载映像 C:\Windows\SysWOW64\kernel32.dll，Win32 错误 0n2
DBGENG：kernel32.dll - 部分符号图像加载缺少图像信息
DBGHELP：模块未完全加载到内存中。
DBGHELP：使用调试器提供的数据搜索符号。
SYMSRV：C:\WebSymbols\wkernel32.pdb\B0C3B36CC7EF4F3E9C168E186A5A6FEB2\wkernel32.pdb 未找到
SYMSRV：http://msdl.microsoft.com/download/symbols/wkernel32.pdb/B0C3B36CC7EF4F3E9C168E186A5A6FEB2/wkernel32.pdb 未找到
DBGHELP：wkernel32.pdb - 找不到文件
*** 警告：无法验证 kernel32.dll 的时间戳
*** 错误：模块加载完成，但无法为 kernel32.dll 加载符号
DBGHELP：kernel32 - 未加载符号
SYMSRV: C:\WebSymbols\KERNELBASE.dll\48E7156D5a000\KERNELBASE.dll 未找到
SYMSRV：http://msdl.microsoft.com/download/symbols/KERNELBASE.dll/48E7156D5a000/KERNELBASE.dll 未找到
DBGENG: C:\Windows\SysWOW64\KERNELBASE.dll - 无法从磁盘映射图像。
DBGENG：KERNELBASE.dll - 部分符号图像加载缺少图像信息
DBGHELP：模块未完全加载到内存中。
DBGHELP：使用调试器提供的数据搜索符号。
SYMSRV: C:\WebSymbols\wkernelbase.pdb\A8683F0C515F469B833E3FA562E0DB251\wkernelbase.pdb 未找到
SYMSRV：http://msdl.microsoft.com/download/symbols/wkernelbase.pdb/A8683F0C515F469B833E3FA562E0DB251/wkernelbase.pdb 未找到
DBGHELP：wkernelbase.pdb - 找不到文件
*** 警告：无法验证 KERNELBASE.dll 的时间戳
*** 错误：模块加载完成，但无法为 KERNELBASE.dll 加载符号
DBGHELP: KERNELBASE - 未加载符号
```

有任何想法吗？这些符号在 Microsoft 的符号服务器上不可用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T15:29:45.680

您是在 32 位或 64 位系统上调试，并且使用 32 位或 64 位版本的 WinDBG？您通常必须在从中获取转储的同一架构包上进行调试：

[http://www.microsoft.com/whdc/devtools/debugging/installx86.mspx](http://www.microsoft.com/whdc/devtools/debugging/installx86.mspx)

> “32 位版本的 Windows 调试工具是最佳选择，除非您在 64 位处理器上调试应用程序。在这种情况下，您应该使用 64 位软件包。”

另外，看看这篇文章，他正在调试一个在 64 位平台上运行的 32 位应用程序：

[http://blogs.msdn.com/alejacma/archive/2008/07/18/How-to-use-Windbg-to-debug-a-dump-of-a-32bit-.NET-app-running-on -a-x64-machine.aspx](http://blogs.msdn.com/alejacma/archive/2008/07/18/How-to-use-Windbg-to-debug-a-dump-of-a-32bit-.NET-app-running-on-a-x64-machine.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-10-12T06:27:37.693

考虑这里提到的解决方法，其中 syswo64\ntdll.dll 被复制到 Syswow64\ntdll32.dll

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=98781&wa=wsignin1.0](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=98781&wa=wsignin1.0)

为我工作。

# regex - 正则表达式 BNF 语法

> ID：265457
> 
> 赞同：28
> 
> 时间：2008-11-05T15:20:47.057
> 
> 标签：regex, grammar, bnf

有没有正则表达式的 BNF 语法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-05T15:23:20.437

你可以看到一个[Perl 正则表达式](http://www.cs.sfu.ca/~cameron/Teaching/384/99-3/regexp-plg.html)（这里显示[的更详细一点](https://web.archive.org/web/20090129224504/http://faqts.com/knowledge_base/view.phtml/aid/25718/fid/200)，由[edg](https://stackoverflow.com/users/4200/edg)发布）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-09-24T11:53:06.987

要在现场发布它们：

> CMPT 384 讲义 Robert D. Cameron 1999 年 11 月 29 日 - 12 月 1 日

```
BNF Grammar of Regular Expressions

Following the precedence rules given previously, a BNF grammar for Perl-style regular expressions can be constructed as follows.
<RE>    ::=     <union> | <simple-RE>
<union>     ::= <RE> "|" <simple-RE>
<simple-RE>     ::=     <concatenation> | <basic-RE>
<concatenation>     ::= <simple-RE> <basic-RE>
<basic-RE>  ::= <star> | <plus> | <elementary-RE>
<star>  ::= <elementary-RE> "*"
<plus>  ::= <elementary-RE> "+"
<elementary-RE>     ::= <group> | <any> | <eos> | <char> | <set>
<group>     ::=     "(" <RE> ")"
<any>   ::=     "."
<eos>   ::=     "$"
<char>  ::=     any non metacharacter | "\" metacharacter
<set>   ::=     <positive-set> | <negative-set>
<positive-set>  ::=     "[" <set-items> "]"
<negative-set>  ::=     "[^" <set-items> "]"
<set-items>     ::=     <set-item> | <set-item> <set-items>
<set-items>     ::=     <range> | <char>
<range>     ::=     <char> "-" <char> 
```

通过[VonC](https://stackoverflow.com/a/265466/611007)。

> --- Knud van Eeden --- 2003 年 10 月 21 日 - 03:22 am --------------------
> 
> PERL：搜索/替换：正则表达式：Backus Naur 形式：正则表达式可能的 BNF 是什么？

```
expression = term

             term | expression

term = factor

       factor term

factor = atom

         atom metacharacter

atom = character

       .

       ( expression )

       [ characterclass ]

       [ ^ characterclass ]

       { min }

       { min ,  }

       { min , max }

characterclass = characterrange

                 characterrange characterclass

characterrange = begincharacter

                 begincharacter - endcharacter

begincharacter = character

endcharacter = character

character =

            anycharacterexceptmetacharacters

            \ anycharacterexceptspecialcharacters

metacharacter = ?

                * {=0 or more, greedy}

                *? {=0 or more, non-greedy}

                + {=1 or more, greedy}

                +? {=1 or more, non-greedy}

                ^ {=begin of line character}

                $ {=end of line character}

                $` {=the characters to the left of the match}

                $' {=the characters to the right of the match}

                $& {=the characters that are matched}

                \t {=tab character}

                \n {=newline character}

                \r {=carriage return character}

                \f {=form feed character}

                \cX {=control character CTRL-X}

                \N {=the characters in Nth tag (if on match side)}

                $N{=the characters in Nth tag (if not on match side)}

                \NNN {=octal code for character NNN}

                \b {=match a 'word' boundary}

                \B {=match not a 'word' boundary}

                \d {=a digit, [0-9]}

                \D {=not a digit, [^0-9]}

                \s {=whitespace, [ \t\n\r\f]}

                \S {=not a whitespace, [^ \t\n\r\f]}

                \w {='word' character, [a-zA-Z0-9_]}

                \W {=not a 'word' character, [^a-zA-Z0-9_]}

                \Q {=put a quote (de-meta) on characters, until \E}

                \U {=change characters to uppercase, until \E}

                \L {=change characters to uppercase, until \E}

min = integer

max = integer

integer = digit

          digit integer

anycharacter = ! " # $ % & ' ( ) * + , - . / :
               ; < = > ? @ [ \ ] ^ _ ` { | } ~
               0 1 2 3 4 5 6 7 8 9
               A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
               a b c d e f g h i j k l m n o p q r s t u v w x y z

---

[book: see also: Bucknall, Julian - the Tomes of Delphi: Algorithms 
and Datastructures - p. 37 - 'Using regular expressions' - 
http://www.amazon.com/exec/obidos/tg/detail/-
/1556227361/qid=1065748783/sr=1-1/ref=sr_1_1/002-0122962-7851254?
v=glance&s=books]

---
---

Internet: see also:

---

Compiler: Grammar: Expression: Regular: Which grammar defines set of 
all regular expressions? [BNF]
http://www.faqts.com/knowledge_base/view.phtml/aid/25950/fid/1263

---

Perl Regular Expression: Quick Reference 1.05
http://www.erudil.com/preqr.pdf

---

Top: Computers: Programming: Languages: Regular Expressions: Perl
http://dmoz.org/Computers/Programming/Languages/Regular_Expressions/Per
l/

---

TSE: Search/Replace:Regular Expression:Backus Naur Form:What is 
possible BNF for regular expression?
http://www.faqts.com/knowledge_base/view.phtml/aid/25714/fid/1236

---

Delphi: Search: Regular expression: Create: How to create a regular 
expression parser in Delphi?
http://www.faqts.com/knowledge_base/view.phtml/aid/25645/fid/175

---

Delphi: Search: Regular expression: How to add regular expression 
searching to Delphi? [Systools]
http://www.faqts.com/knowledge_base/view.phtml/aid/25295/fid/175

---------------------------------------------------------------------- 
```

通过[埃德吉尼斯](https://stackoverflow.com/a/265467/611007)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-05T15:23:20.717

[http://web.archive.org/web/20090129224504/http://faqts.com/knowledge_base/view.phtml/aid/25718/fid/200](http://web.archive.org/web/20090129224504/http://faqts.com/knowledge_base/view.phtml/aid/25718/fid/200)

# flash - 闪存的 GUI 框架 (as3)

> ID：265476
> 
> 赞同：7
> 
> 时间：2008-11-05T15:26:26.983
> 
> 标签：flash, actionscript-3, user-interface, frameworks

我似乎找不到任何与我在网上看到的任何应用程序一样好的用于 as3 的 GUI 框架；这是大多数人自己编写的代码，还是我在 Flash 中遗漏了一些东西？

我正在寻找对话框/窗口、按钮、文本框、组合、下拉菜单、菜单等，以及扩展组件以制作新组件的能力。

我也希望它是 as3，但其他任何人也会这样做。

可能需要详细说明。我实际上是在寻找一个框架，允许我在 Flash、自定义皮肤、颜色、样式等中创建自己的 GUI。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T18:36:11.920

我非常喜欢[Liquid 组件](http://www.bytearray.org/?p=137)，它们扩展了基本的 Flash 组件，因此它们需要稍微笨重的框架，但它们很容易换肤。如果您想要“小而整洁”，我会选择[MinimalComps](http://minimalcomps.com/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T01:29:54.400

只需添加上述内容：[ASwing](http://aswing.org)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-02-01T09:27:04.960

除了提到的 ASWing：

[Minimal Components](http://www.minimalcomps.com/)专注于快速发展

[AS DataProvider Controls](https://github.com/kakenbok/ActionScript-DataProvider-Controls)专注于数据集成和样式

两者都是开源的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T16:29:14.453

**简短回答：**这是[基本控件的列表](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/fl/controls/package-detail.html)。

**长答案：**是的， Flash / Flex 中已经内置了许多控件（例如[按钮](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/fl/controls/ComboBox.html)、[文本框](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/fl/controls/TextInput.html)、[组合框等）。](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/fl/controls/ComboBox.html)

这是我发现有用的[一个教程，它简要介绍了在不使用 Flex Builder 的情况下使用某些组件（按钮）。](http://www.senocular.com/flash/tutorials/as3withmxmlc/)

如果您使用 Flex Builder 之类的工具，您将可以在友好的拖放环境中完全访问这些对象，但是，无需购买 Adob​​e 工具来使用这些工具进行开发，只要您使用起来很舒服像 FlashDevelop 或免费的命令行 mxmlc 编译器。

查看 Adob​​e Live Docs 中的[fl.controls 命名空间](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/fl/controls/package-detail.html)以获取 Flash / Flex 中包含的这些基本控件的完整列表。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T16:48:21.980

需要注意的重要一点是，有两个 UI 框架有一些明显的重叠。一个在 Flash 中，另一个在 Flex 中。为了使用 flex，您需要 Flex SDK。Flex SDK 是免费的，但 flex builder 不是（Eclipse 的 IDE 改编版。）

真正的 flex 只是 as3 中的一组库和框架。

大多数包都位于命名空间“mx.”中，即使组件名称相同（Flash 中的按钮，Flex 中的按钮），flex 也具有更强大的框架。

您还将 swf 文件的大小增加 30 到 50k，但如果您正在寻找强大的 UI，那么它是非常值得的。

我还建议学习如何使用 flex 的 ResourceBundle 和 CSS 功能，因为同时使用这两种功能可以大大简化本地化和换肤。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-21T19:54:59.913

还有一个我一直在研究的名为 LiquidGear 的框架，它进行了很多调整、提示和解决方法，并将它们组合成 AS3 元素。它使用与 JQuery 相同的结构。

使用 MVC 框架（Shell）中的元素或单独使用元素，您可以添加图像，例如只需两行代码......

var img:Image = new Image({id:'myImg', src:'/IMG/myFolder/photo.jpg'}); addChild(img);

您可以将这些扩展为 HoverButton 等组件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-11T18:27:46.707

这是另一个使用 GPU 加速（Starling）的。

[http://feathersui.com/](http://feathersui.com/)

# javascript - 标记上的 preventDefault()

> ID：265478
> 
> 赞同：152
> 
> 时间：2008-11-05T15:27:12.037
> 
> 标签：javascript, jquery

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2008-11-05T15:31:22.167

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2012-05-07T07:49:16.987

设置**`href`**属性为`href="javascript:;"`

```
<ul class="product-info">
  <li>
   <a href="javascript:;">YOU CLICK THIS TO SHOW/HIDE</a>
  <div class="toggle">
    <p>CONTENT TO SHOW/HIDE</p>
  </div>
 </li>
</ul> 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2011-08-15T05:06:29.427

建议您不要使用`return false`，因为结果会发生 3 件事：

1.  event.preventDefault();
2.  event.stopPropagation();
3.  停止回调执行并在调用时立即返回。

所以在这种情况下，你真的应该只使用`event.preventDefault();`

[文章存档 - **jQuery 事件：停止（错误）使用 Return False**](https://web.archive.org/web/20160603125641/http://fuelyourcoding.com/jquery-events-stop-misusing-return-false/)

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2018-01-25T16:01:46.643

1 - 简单的方法：

```
<a href="javascript:;">Click Me</a> 
```

2 - 使用无效（0）：

```
<a href="javascript:void(0);">Click Me</a> 
```

3 - 使用`preventDefault()`：

```
<a href='#' onclick="event.preventDefault()">Click Me</a> 
```

`inline onclick`4 - 在 Javascript 中使用、`IIFE`和`event`的另一种方法`preventDefault()`：

```
<a href='#' onclick="(function(e){e.preventDefault();})(event)">Click Me</a> 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-11-05T15:57:58.463

或者，您可以从 click 事件中返回 false：

```
 $('div.toggle').hide();
 $('ul.product-info li a').click(function(event){
  $(this).next('div').slideToggle(200);
+ return false; 
 }); 
```

这将阻止触发 A-Href。

但是请注意，出于可用性原因，在理想的世界中，对于想要在新标签中打开链接的人来说，href 应该仍然存在于某个地方；）

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2012-02-15T19:24:31.837

这是我刚刚测试过的非 JQuery 解决方案，它可以工作。

```
<html lang="en">
<head>
<script type="text/javascript">
addEventListener("load",function(){
    var links= document.getElementsByTagName("a");
    for (var i=0;i<links.length;i++){
        links[i].addEventListener("click",function(e){
        alert("NOPE!, I won't take you there haha");
        //prevent event action
        e.preventDefault();
        })
    }
}); 

</script>
</head>
<body>
<div>
<ul>
    <li><a href="http://www.google.com">Google</a></li>
    <li><a href="http://www.facebook.com">Facebook</a></li>
    <p id="p1">Paragraph</p>
</ul>
</div>
<p>By Jefrey Bulla</p>
</body>
</html> 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2014-01-07T03:03:29.453

```
<ul class="product-info">
  <li>
    <a href="javascript:void(0);">YOU CLICK THIS TO SHOW/HIDE</a>
      <div class="toggle">
        <p>CONTENT TO SHOW/HIDE</p>
      </div>
  </li>
</ul> 
```

采用

> javascript：无效（0）；

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-02-04T10:07:06.737

经过几次操作，当页面最终应该转到`<a href"...">`链接时，您可以执行以下操作：

```
jQuery("a").click(function(e){
    var self = jQuery(this);
    var href = self.attr('href');
    e.preventDefault();
    // needed operations

    window.location = href;
}); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-05-07T01:51:57.813

为什么不在css中做呢？

取出锚标签中的“href”属性

```
<ul class="product-info">
  <li>
    <a>YOU CLICK THIS TO SHOW/HIDE</a>
    <div class="toggle">
      <p>CONTENT TO SHOW/HIDE</p>
    </div>
  </li>
</ul> 
```

在你的CSS中，

```
 a{
    cursor: pointer;
    } 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2011-05-31T13:44:25.560

如果停止事件的传播不会打扰您，只需使用

```
return false; 
```

在您的处理程序结束时。在 jQuery 中，它会阻止默认行为并停止事件冒泡。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-10-22T15:28:36.243

您可以使用`return false;`from 事件调用来停止事件传播，它就像一个`event.preventDefault();`否定它。或者您可以使用`javascript:void(0)`in href 属性来评估给定的表达式，然后返回`undefined`到元素。

调用时返回事件：

```
<a href="" onclick="return false;"> ... </a> 
```

无效案例：

```
<a href="javascript:void(0);"> ... </a> 
```

您可以在以下内容中看到更多信息：[在锚标记的单击事件侦听器上添加 void(0) for href 和 'return false' 的效果是什么？](https://stackoverflow.com/questions/40048143/whats-the-effect-of-adding-void0-for-href-and-return-false-on-click-event-l/40048197#40048197)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-09-10T14:47:12.520

在**Javascript**中你可以使用它

```
window.event.preventDefault(); 
```

它适用于我的情况。将上面的行写入您的函数。

# deployment - 应用程序无法启动...应用程序配置不正确 - VC++ 2005 运行时问题

> ID：265481
> 
> 赞同：7
> 
> 时间：2008-11-05T15:28:25.153
> 
> 标签：deployment, visual-studio-2005, dll

我们将 Visual C++ 2003 解决方案移至 Visual 2005，现在我们在部署到干净的 XP 机器时遇到了问题。

我们的解决方案有一个 DLL 项目和一个使用该 DLL 的命令行可执行文件。这两个项目都创建和嵌入清单文件。

我们的安装程序还将 VC8 CRT 运行时从 C:\Programme\Microsoft Visual Studio 8\VC\redist\x86\Microsoft.VC80.CRT\ 复制到安装目录。

当我们在干净的 Windows XP 上安装时，我们会看到错误消息“应用程序无法启动...应用程序配置不正确”。

将exe放入Depends.exe中，说：

```
Error: The Side-by-Side configuration information for "c:\program files\MySoftware\vc8\BENCHMARK.EXE" contains errors. This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem (14001).
Error: The Side-by-Side configuration information for "c:\program files\MySoftware\vc8\MYLIB-VC8.DLL" contains errors. This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem (14001).
Warning: At least one module has an unresolved import due to a missing export function in a delay-load dependent module. 
```

事件查看器日志：

```
Dependent Assembly Microsoft.VC80.CRT could not be found and Last Error was The referenced assembly is not installed on your system.

Resolve Partial Assembly failed for Microsoft.VC80.CRT. Reference error message: The referenced assembly is not installed on your system.

Generate Activation Context failed for C:\Program Files\MySoftware\vc8\Benchmark.exe. Reference error message: The operation completed successfully. 
```

我已经阅读将 msvcp80.dll、msvcr80.dll、msvcm80.dll 和 Microsoft.VC80.CRT.manifest 复制到应用程序文件夹就足够了。

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T15:49:24.953

不建议复制 CRT dll。正如 Vinay 所说，您应该使用正确的合并模块。

如果合并模块不适用于您的安装程序技术，您也可以使用 redist install exe：

*   [VS2005 显像管](http://www.microsoft.com/downloads/details.aspx?familyid=32BC1BEE-A3F9-4C13-9C99-220B62A191EE&displaylang=en)
*   [VS2005 SP1 显像管](http://www.microsoft.com/downloads/details.aspx?familyid=200b2fd9-ae1a-4a14-984d-389c36f85647&displaylang=en)

作为最后的手段，尝试将整个“Microsoft.VC80.CRT”目录复制到您的程序 exe 目录（不是内容，实际目录）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-01T16:57:05.443

您实际上并不需要 Microsoft 的 VC80 C 运行时库。一团糟。

相反，使用 /MT 选项重新链接您的程序，该选项静态链接 c 运行时库 (libcmt.lib) 或 C++ 标准库。要通过项目属性进行设置，请转到

```
C/C++ -> Code Generation -> Runtime Library: Multi-threaded (/MT) 
```

如果它没有编译，你可能还想添加这个选项 (/NODEFAULTLIB:)

```
Linker -> Input -> Ignore Specific Library: msvcrt.lib 
```

[请参阅http://msdn.microsoft.com/en-us/library/abx4dbyh(VS.80).aspx](http://msdn.microsoft.com/en-us/library/abx4dbyh(VS.80).aspx)中的链接选项

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T15:38:44.430

在安装程序中选择 Visual Studio 2005 合并模块。如果您使用安装了服务包的 Visual Studio 构建了 exe/dll，也会发生这种情况。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T16:45:31.520

我也有这个问题。我对微软对我们这样做感到震惊。
（我使用 VC6 构建了一个特定项目，然后当我还在构建机器上安装 2003 和 2005 时，它导致我的 VC6 构建出现问题。（我没有检查原始机器上的安装）显然链接器/编译器不知道它在做什么，导致我的可分发文件出现问题。然后我不得不在我的 120k exe 应用程序中添加一个巨大的 redist 安装文件。该死的微软。

MS过去曾几次搞砸了。

[http://www.microsoft.com/downloads/details.aspx?familyid=200B2FD9-AE1A-4A14-984D-389C36F85647&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=200B2FD9-AE1A-4A14-984D-389C36F85647&displaylang=en)

# database-design - 如何将 URL 存储在表中？

> ID：265484
> 
> 赞同：1
> 
> 时间：2008-11-05T15:28:58.647
> 
> 标签：database-design, url

我认为字段类型应该是可变长度的字符串（VARCHAR），但我应该使用什么长度？

澄清一下：我想选择一个能够存储*平均*URL 的大小，而不是真正关心最大可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T15:32:19.437

对于 IE，限制为[2,083 个字符](http://support.microsoft.com/kb/208427)

似乎大多数其他浏览器没有这样的限制，但如果 URL 应该与所有浏览器兼容，我建议使用 2083 个字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T15:34:29.807

大小以适合 GET 请求的允许长度。说 2048 （这是 IE 的最大值） [http://www.boutell.com/newfaq/misc/urllength.html](http://www.boutell.com/newfaq/misc/urllength.html)

附带说明一下，如果这些 URL 中的任何一个是 javascript 小书签；

```
javascript:var foo='bar';...alert('Hello World'); 
```

如果用户尝试将其添加到他们的收藏夹中，IE 中的字符数限制为**508个。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T15:34:42.770

如果您想支持所有现代浏览器，看起来您至少需要 190,000 的长度。 [点击这里](http://www.boutell.com/newfaq/misc/urllength.html)了解详情。

但是，我认为您可以使用 2000。如果客户输入的 URL 比这更长，您可以将错误归咎于他们，他们实际上会对这样做感到内疚。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T16:29:58.163

虽然浏览器支持具有数千个字符的 URL，但这种情况很少见，并且您自己说过您希望能够存储平均 URL。您的字段长度将取决于您期望的平均值。您是否主要存储“主页”（如在用户配置文件中）？或者它会是 URL 深层链接到具有长路径和/或查询字符串的站点上的内容 - 基本上是*任何*URL？

如果是后者（任何 URL），则使用此问题的答案中提到的 2083 号码。请记住，SQL Server 中的最大行大小约为 8000 字节。如果这是与一堆其他信息（同样，例如用户配置文件）相同的表，您可能会达到该限制。

对于我自己的项目，通常会有更多关于将存储哪些 URL 的上下文。我通常会提出一个潜在 URL 的列表，并确定可以容纳所有这些 URL 的长度，然后将其加倍。对于 URL，我通常以 300 或 500 的字段长度结束，而且我不记得曾经遇到过问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T15:32:53.663

这取决于 URL 本身。

如果您使用非常长的 URL，例如[http://dsddsadashf.fsdfs.fd/fsdfsdfs/dfsdfsdfdsf/ssssdfsdfsd/sdfsdfsdfsd?fsdfsdfsdf=fdfsfsdfs&fsdfsdfsdfsdfs;jsessionid=sdasdsadasdasdfsdvhbdkvhjkdvhsk](http://dsddsadashf.fsdfs.fd/fsdfsdfs/dfsdfsdfdsf/ssssdfsdfsd/sdfsdfsdfsd?fsdfsdfsdf=fdfsfsdfs&fsdfsdfsdfsdfs;jsessionid=sdasdsadasdasdfsdvhbdkvhjkdvhsk)您可能会考虑 CLOB 字段；）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T23:46:27.757

您应该使用文本，因为 varchar 可能只有 255 个字符长。文本长度可能为 65536 个字符。

# sql-server - 更改 Sql Server 2005 中的触发器

> ID：265492
> 
> 赞同：0
> 
> 时间：2008-11-05T15:30:39.517
> 
> 标签：sql-server, sql-server-2005, triggers, tableadapter, alter

我需要更改 sql server 2005 中的触发器，并且我想使用表适配器和 sql 语句来完成，而不是存储过程。我知道我可以在查询浏览器中运行它并执行它，但我需要在多个数据库中部署它并在更新中使用表适配器。这可能吗？

执行添加查询->更新->粘贴以下代码->查询生成器以查看它是否解析

```
print("USE [DataBaseName]
GO
/****** Object:  Trigger [dbo].[UpdateCurrentAddress]    Script Date: 10/30/2008 14:47:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER TRIGGER [dbo].[UpdateCurrentAddress] ON [dbo].[PreviousAddresses] 
FOR INSERT, UPDATE, DELETE
AS
-- Check to see if there was an insert/update or a deletion.
IF (SELECT COUNT(*) FROM inserted) >= 1
BEGIN
    IF (SELECT CountryID FROM inserted) <> 181

...moar..."); 
```

错误... USE [DataBaseName] SQL 构造或语句不受支持。

如果我移除顶部并从 ALTER TRIGGER 开始

不支持 ALTER TRIGGER SQL 构造或语句。

我对此仍然很陌生，并且我要么以错误的方式进行此操作和/或没有存储过程就不可能做到这一点，我不会感到惊讶。

编辑：是的，我在 C# 中这样做。

谢谢。我可以从 ALTER TRIGGER 开始这样做，这将完成工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T15:58:18.820

TableAdapter 需要一个结果集，而不是实际查询。要成功执行此操作，您将需要使用 SqlCommand 对象来实际执行更新。

如果您在它非常简单之前没有使用过，首先您声明您的连接，然后使用该连接创建您的命令。创建命令后，将命令文本设置为等于您的脚本，然后您可以在打开连接后调用 ExecuteNonQuery() 方法来运行脚本。如果您说您使用的是哪种语言，我可以尝试提供一个示例。

**编辑**

这是一个 C# 示例，快速而肮脏，但它抓住了重点。注意，从记忆中完成，但应该是正确的。

```
using(SqlConnection oConnection = new SqlConnection("Yourconnectionhere"))
using(SqlCommand oCommand = new SqlCommand(oConnection))
{
    //Configure the command object
    oCommand.CommandText = "Your script here";

    //Open connectin and run script
    oConnection.Open();
    oCommand.ExecuteNonQuery();
    oConnection.Close();
} 
```

# asp.net - 在运行时引用但未使用主题

> ID：265494
> 
> 赞同：0
> 
> 时间：2008-11-05T15:31:00.657
> 
> 标签：asp.net

我有一个使用主题的网站。根据 url（如果是 A.something.com 或 B.something.com，其中 A 和 B 代表客户端），我将加载不同的主题。目的是为不同的客户使用一个代码库。我有一个 app_themes 文件夹，里面有几个主题，用于不同的客户端，每个主题都有不同的 CSS 文件（出于商业原因，每个主题的 CSS 文件都是相同的，但重复了）。所以我的代码如下所示：

公共覆盖属性 StyleSheetTheme() 作为字符串

```
 Get
        Dim myHost As String = Request.Url.Host
        Return myHost
    End Get
    Set(ByVal value As String)
    End Set
End Property

Protected Sub Page_PreInit(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.PreInit

    If Request.Url.Host.Contains("Savills") Then
        Page.Theme = "Savills"
    ElseIf Request.Url.Host.Contains("localhost") Then
        Page.Theme = "localhost"
    ElseIf Request.Url.Host.Contains("test.concepglobal.com") Then
        Page.Theme = "test.concepglobal.com"
    ElseIf Request.Url.Host.Contains("concepglobal") Then
        Page.Theme = "concepglobal"

    End If

End Sub 
```

我的 app_themes 文件夹结构：

App_Themes：

本地主机：

默认.css

第一太平戴维斯

第一太平戴维斯.css

但是，每次我加载网站时，css 都不会被拾取。所以我没有得到我在 css 中设计的 h1 样式（它在那里），而只有 aspx 页面中指定的图形。

我在运行网站时的来源：

（在该网址加载网站）。

令人困惑的是，还有另一个指向同一个 css 的链接：

我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T15:36:25.620

仅当您从 Visual Studio 中运行代码时才会发生这种情况吗？

在 ASP.Net Development Server 中运行时，App_Themes 中的样式不会用于任何未经身份验证的页面（例如 Login.aspx 或 ForgotPassword.aspx）。那是因为用户还没有对该文件夹的浏览权限，或者 App_Themes 文件夹没有浏览权限。显然，IIS 处理了这个，但 Cassini 没有。

尝试将此添加到 web.config 以让主题和样式在身份验证之前工作。

```
<location path="App_Themes">
    <system.web>
      <authorization>
        <allow users="?" />
      </authorization>
    </system.web>
  </location> 
```

或者，如果可能，切换到在您机器上的 IIS 上运行该应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T14:24:23.210

您可以通过 web.config 指定应用程序（或文件夹）使用的主题，而不是通过代码执行此操作：

```
<system.web>
    <pages theme="concepglobal"></pages>
</system.web> 
```

这假设每个客户端都有不同的 web.config 文件。

# asp.net-mvc - asp.net mvc 在数据库中保存和显示图像

> ID：265505
> 
> 赞同：3
> 
> 时间：2008-11-05T15:32:55.160
> 
> 标签：asp.net-mvc

使用 ASP.NET MVC 时如何保存图像并从 SQL Server 图像字段显示它们？

非常感谢尼克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T19:23:07.987

MvcFutures [http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=18459](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=18459)项目有一个 FileResult，它是 ActionResult 的一种。您可能可以使用它将二进制流返回给浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T11:23:29.920

您也可以通过控制器操作自己简单地执行此操作：

```
public void RenderImage(int imageId)
{
    // TODO: Replace this with your API to get the image blob data.
    byte[] data = this.repo.GetImageData(imageId);

    if (data != null)
    {
        // This assumes you're storing JPEG data
        Response.ContentType = "image/jpeg";
        Response.Expires = 0;
        Response.Buffer = true;
        Response.Clear();
        Response.BinaryWrite(data);
    }
    else
    {
        this.ControllerContext.HttpContext.ApplicationInstance.CompleteRequest();
    }
} 
```

# asp.net - ASP.NET MVC 查看用户控件 - 如何设置 ID？

> ID：265508
> 
> 赞同：7
> 
> 时间：2008-11-05T15:34:10.070
> 
> 标签：asp.net, asp.net-mvc

我需要在我的页面上有一个下拉列表，允许用户选择他们的状态。由于这可能是一个将在其他地方使用的控件，我认为创建一个可以重用的 MVC 视图用户控件是一个好主意。

我在想控件看起来像这样：

```
<select name="" id="">
   <option value="AL">Alabama</option>
   <option value="AK">Alaska</option>
</select> 
```

在我看来，代码类似于：

```
<%= Html.RenderPartial("StateDropdownControl") %> 
```

我的问题是，在控件上设置名称和 ID 的最佳方法是什么？如果需要，我想确保我可以在一页上拥有此控件的多个实例。另外，我希望能够以默认情况下应选择的状态发送。

我会以某种方式使用 ViewData 吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-05T16:01:01.220

科里正在寻找正确的解决方案。我认为为您的视图声明特定的模型对象会使视图非常简单，并且作为附带的好处，使它们易于测试。

因此，您可能希望创建自己的模型对象来传递，而不是仅仅将 ID 作为对象传递。

它可能看起来像这样：

```
public class StateDropDownPresentationModel
{
    public string DropDownID { get; set; }
    public string SelectedState { get; set; }
} 
```

显然，请继续向该模型添加您需要的任何内容，以使您的视图正确。

然后，你可以这样称呼它：

```
<%= Html.RenderPartial("/someDirectory/SomeControl.ascx", new StateDropDownPresentationModel { DropDownID = "MyID", SelectedState = "IL" } %> 
```

然后只需确保检查 ID 是否为空/空白（这可能会引发错误）和 SelectedState 是否为空/空白。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T15:46:53.323

好吧，您可以将对象数据传递给 RenderPartial 方法，并结合用户控件进行渲染，因此您可以轻松地执行以下操作：

 `````
<%= Html.RenderPartial("/someDirectory/SomeControl.ascx", "MyID") %> 
```

and in the UserControl do the following:

```
<select name="<%=ViewData.Model%>" id="<%=ViewData.Model%>">

.... 
```

Just to be sure, a better way to handle it is to make a simple DTO (data transfer object) to hold that information so you can pass more information to your user control, that you will inevitably need.

Example:

```
 class ComboData 
{
   string ID {get;set;}
   string CssClass {get;set;}
   //Other stuff here
} 
```

```
 <%
var comboData = new ComboData {ID = "myID", CssClass = "comboStyle" }

%>

<%= Html.RenderPartial("/someDirectory/SomeControl.ascx", comboData) %> 
```` 

```
<select name="<%=ViewData.Model.ID%>" id="<%=ViewData.Model.ID%>" class="<%=ViewData.Model.CssClass%>">

.... 
```

对于此示例，请确保将用户控件的 Code behind 设置为 ComboData 类型的泛型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T16:27:31.120

Take a look at the Html.DropDownList helper method. It has a number of overloads that allow you to pass the list data and set the selected item. the simplest version just sets the name of the select.

```
<%= Html.DropDownList("SelectStates"); %> 
```

If there is a value in the ViewData["SelectStates"] that is of type MultiSelectList then the list will be automatically populated.

# wpf - 不实施 IValueConvert.ConvertBack 时的最佳实践

> ID：265515
> 
> 赞同：37
> 
> 时间：2008-11-05T15:37:40.720
> 
> 标签：wpf, data-binding

只是想知道人们在实现没有有意义的 ConvertBack 实现（或仅用作 OneWay 的）的 IValueConverter 时认为最佳实践是什么？

如果它抛出（在这种情况下是什么异常），返回 null 或返回一些默认值。

想法？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-05T15:47:03.523

[`IValueConverter.ConvertBack`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.data.ivalueconverter.convertback)建议返回的文档[`DependencyProperty.UnsetValue`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.dependencyproperty.unsetvalue)。

> 数据绑定引擎不会捕获用户提供的转换器引发的异常。由 ConvertBack 方法引发的任何异常，或由 ConvertBack 方法调用的方法引发的任何未捕获的异常都被视为运行时错误。通过返回 DependencyProperty.UnsetValue 来处理预期的问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-05T15:49:57.793

根据微软，你应该返回`DependencyProperty.UnsetValue`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-08-11T06:10:13.160

我同意@Todd White 的回答。

此外，为了节省时间，您可以实现一个`ConvertBack`为您实现的基本转换器类，这样您就不必每次都实现它来保存重复的代码。

从技术上讲，您也不必重写`Convert`。但它必须实现，`ConverterBase`因为它实现了`IValueConverter`接口的所有方法。`Convert`在实践中，您每次都会被覆盖，并且`ConvertBack`大部分时间都可以被忽略。

```
public class ConverterBase : IValueConverter
{
    public virtual object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return DependencyProperty.UnsetValue;
    }
    public virtual object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return DependencyProperty.UnsetValue;
    }
}

public class VisibilityConverter : ConverterBase
{
    public override object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return ((bool)value ^ (parameter as bool? == true)).ToVisibility();
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-15T11:28:03.360

当 ConvertBack 不包含任何功能并且您**不希望**调用它时，抛出 NotImplementedException。它不应该被调用，因此你想要一个运行时异常。

如果**有意**调用 ConvertBack，那么您最好为其提供一个实现。一种选择是仅返回 DependencyProperty.UnsetValue，或通过返回 DependencyProperty.UnsetValue 来处理 ConvertBack 实现中的异常。

我对此的理由是：返回一个 DependencyProperty.UnsetValue 而不是抛出一个 NotImplementedException 使得它在调用 ConvertBack 方法时变得**不明显，而您实际上从未打算这样做。**也许它现在应该具有一些功能，因为它正在被调用并引发运行时异常。如果只是返回 DependencyProperty.UnsetValue，那么发现缺少的 ConvertBack 功能会困难得多。

# sql-server - Sql Server 中的提示

> ID：265516
> 
> 赞同：2
> 
> 时间：2008-11-05T15:37:48.193
> 
> 标签：sql-server, query-optimization, hints

每个 sql 语句都需要提示吗？我们有一个 dba，他对此非常了解，并要求我们在存储过程中的每个 select 和 update 语句上提供提示。这真的有必要吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-05T15:39:16.240

通常不会。把它们放在所有东西上听起来有点矫枉过正。

[文件](http://msdn.microsoft.com/en-us/library/ms187713.aspx)说_

*因为 SQL Server 查询优化器通常会为查询选择最佳执行计划，所以我们建议只有经验丰富的开发人员和数据库管理员在不得已的情况下才使用 join_hint、query_hint 和 table_hint*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-05T15:40:25.207

你的 DBA 是**错误**的。

来自[女士](http://msdn.microsoft.com/en-us/library/ms187713.aspx)：

> 因为 SQL Server 查询优化器通常会为查询选择最佳执行计划，所以我们建议 只有经验丰富的开发人员和数据库管理员在不得已的情况下才使用*连接提示*、*查询提示*和 *表提示。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T15:39:49.110

提示只是提示。它们帮助优化器做最好的工作。但与任何优化一样，您应该关注实际存在问题的语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T15:47:58.220

通常这只是倒退。但是，根据您的情况，这可能是可取的。

例如，我们有一个数据库（实际上是一台服务器上的一组数据库），其中的数据都是大型机系统的夜间快照转储，用于报告和其他目的。除了每晚重新创建数据库的批处理过程之外，*没有*任何东西写入这个系统。在这种情况下，默认锁定方案是不合适的，并且我们的团队和管理我们所有服务器的 IT 团队之间的政治使我们无法更改它。所以：几乎所有对这些数据库的查询都有`with (nolock)`提示。

我想在其他情况下，您可能拥有没有写入的报告数据库，或者可能相反：很少读取的存档或日志数据库。关键是有时可能会在默认锁定方案不适合并且您无法更改它的情况下设置专门的数据库。那么你将需要大量的皮纳塔......我的意思是提示。

但这是证明规则的例外。一般来说，数据库优化器在锁定之类的事情上比你更聪明。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T15:52:51.187

取决于 - 查询优化器做出了很好的意图选择。您的 DBA 需要哪些提示？@Ned 有点不对劲——一个提示明确告诉优化器不要找出路径——而是使用你的优化。

立法规定您应该始终或从不使用提示有点无知提示要解决的问题。提示至关重要的一些场合：

*   NOLOCK 从事务中查询的域查找表中显式删除读锁。
*   由于在大量更新期间统计信息“漂移”而将查询计划固定到特定索引（在这种情况下，计划恢复为对 10m 行表进行表扫描，而不是使用聚集索引）

永远不必使用连接提示。

# c++ - 在 C++ 中创建大文件的最快方法？

> ID：265518
> 
> 赞同：5
> 
> 时间：2008-11-05T15:38:08.287
> 
> 标签：c++, file-io, iostream, bulkinsert

在 C++ 中创建一个大约 50 - 100 MB 的平面文本文件，内容“添加的第一行”应插入文件中 400 万次

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-05T15:49:50.150

使用旧式文件 io

**f打开**文件进行写入。

**fseek**到所需的文件大小 - 1。

**f写入**单个字节

**f关闭**文件

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-05T15:49:52.787

创建特定大小文件的最快方法是使用`creat()`or创建一个长度为零的文件`open()`，然后使用`chsize()`. 这将只是在磁盘上为文件分配块，内容将是这些块中发生的任何内容。它非常快，因为不需要进行缓冲区写入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T15:54:52.963

不确定我是否理解这个问题。您想确保文件中的每个字符都是可打印的 ASCII 字符吗？如果是这样，那这个呢？用“abcdefghabc....”填充文件

```
#include <stdio.h>
int main ()
{
   const int FILE_SiZE = 50000; //size in KB
   const int BUFFER_SIZE = 1024;
   char buffer [BUFFER_SIZE + 1];
   int i;
   for(i = 0; i < BUFFER_SIZE; i++)
      buffer[i] = (char)(i%8 + 'a');
   buffer[BUFFER_SIZE] = '\0';

   FILE *pFile = fopen ("somefile.txt", "w");
   for (i = 0; i < FILE_SIZE; i++)
     fprintf(pFile, buffer);

   fclose(pFile);

   return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T11:55:51.620

您没有提到操作系统，但我假设 creat/open/close/write 可用。

对于真正有效的写入和假设，例如 4k 页面和磁盘块大小以及重复字符串：

1.  打开文件。
2.  在重复的字符串中分配 4k * 字符数，理想情况下与页面边界对齐。
3.  将重复的字符串打印到内存中 4k 次，精确地填充块。
4.  使用 write() 根据需要多次将块写入磁盘。您可能希望为最后一个块编写部分片段以使大小正确。
5.  关闭文件。

这绕过了 fopen() 和朋友的缓冲，这有好有坏：它们的缓冲意味着它们又好又快，但它们仍然不会像这样有效，它没有使用缓冲区的开销.

这可以很容易地用 C++ 或 C 编写，但为了提高效率，假设您将使用 POSIX 调用而不是 iostream 或 stdio，因此它超出了核心库规范。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-29T08:44:24.980

我遇到了同样的问题，非常快地在 Windows 上创建了一个 ~500MB 的文件。传递给 fwrite() 的缓冲区越大，速度就越快。

```
int i;
FILE *fp;

fp = fopen(fname,"wb");

if (fp != NULL) {

    // create big block's data
    uint8_t b[278528]; // some big chunk size

    for( i = 0; i < sizeof(b); i++ ) // custom initialization if != 0x00
    {
        b[i] = 0xFF;
    }

    // write all blocks to file
    for( i = 0; i < TOT_BLOCKS; i++ )
        fwrite(&b, sizeof(b), 1, fp);

    fclose (fp);
} 
```

现在至少在我的 Win7 上，MinGW 几乎可以立即创建文件。与 fwrite() 一次 1 个字节相比，这将在 10 秒内完成。通过 4k 缓冲区将在 2 秒内完成。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-12T23:16:56.947

**在 C++ 中创建大文件的最快方法？** 行。我认为最快的方式是指运行时间最短的方式。

**在 C++ 中创建一个大约 50 - 100 MB 的平面文本文件，内容“添加的第一行”应插入文件中 400 万次。**

使用旧式文件 io 预分配文件

```
fopen the file for write.
fseek to the desired file size - 1.
fwrite a single byte
fclose the file

create a string containing the "Added first line\n" a thousand times.
find it's length. 
```

使用旧式文件 io 预分配文件

```
fopen the file for write.
fseek to the the string length * 4000
fwrite a single byte
fclose the file

open the file for read/write
loop 4000 times, 
    writing the string to the file.
close the file. 
```

这是我最好的猜测。我敢肯定有很多方法可以做到这一点。

# linq-to-sql - 如何在运行时更改 LINQ 2 SQL 列的 UpdateCheck 属性？

> ID：265524
> 
> 赞同：0
> 
> 时间：2008-11-05T15:39:29.047
> 
> 标签：linq-to-sql, updatecheck

我们有一些应用程序使用相同的 Linq 2 SQL DataContext。其中一个应用程序将进行大量插入（它是来自旧系统的转换器）。是否可以在运行时更改每个表的 TimeStamp 列的 UpdateCheck ？仅对于我们希望将其设置为“从不”的一个应用程序，所有其他应用程序都应具有“始终”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T15:57:45.703

AFAIK 你不能在运行时改变它（至少用简单的方法），因为它是作为域类属性中的属性自动生成的。例如

```
[Column(Name="ITM_CREATE_DATE", Storage="_ITM_CREATE_DATE", DbType="DateTime NOT NULL", UpdateCheck=UpdateCheck.Never)]
public System.DateTime CreationDate 
```

一种可能的解决方法（我从未尝试过，所以我不知道它是否有效）是`<DataContext>.designer.cs`在您的单个项目中复制代码，在副本中进行更改并在没有设计器的情况下使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T17:59:38.903

UpdateCheck is not used for Insert operations, only for update.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T07:47:50.823

有关我正在尝试做的事情的更多信息：

我在 SQL Server 探查器中看到了这种行为：

exec sp_executesql N'INSERT INTO [dbo].[Test]([ID], [Data]) VALUES (@p0, @p1)

*SELECT [t0].[timestamp] FROM [dbo].[Test] AS [t0] WHERE [t0].[ID] = @p2',N'@p0 uniqueidentifier,@p1 varchar(24),@p2 uniqueidentifier' ,@p0='EF0F12B9-825E-48A2-943A-B43E94BB00AA',@p1='tadaaa 20081106 08:41:01',@p2='EF0F12B9-825E-48A2-943A-B43E94BB00AA'*

我想阻止 SELECT 部分，因为这个应用程序只做 INSERTS，我有一种感觉，当插入 100 000+ 条记录时，抑制 SELECT [to].[timestamp] 部分可能会给我带来很多性能......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T14:13:15.913

[Column] 属性有几个属性会在 INSERT 之后触发该 SELECT：

*   AutoSync，默认为 Never，被 ISDBGenerated 和 ISDBVersion 覆盖
*   ISDBGenerated，它生成您所描述的行为。
*   IsVersion，这意味着每次更新/插入记录时，该字段都会自动更新，并且LINQ也会在更新/插入后获取实际值，从而产生您描述的行为。

我不确定这是否适用于您的特定情况，但是是否可以从困扰您的字段中删除这些属性并手动设置，而不是让数据库自行设置？（或者至少，不要告诉 LINQ 数据库会自动设置它，并且 LINQ 在 INSERT 之后不会选择）。

这并不能解决仅针对 2 个项目之一修复它的实际问题。我也不确定 LINQ 是在运行时通过反射还是在编译时完成的。如果魔术是在运行时完成的，您*也许*可以使用反射删除属性并将其添加回来，*也许*，我真的不知道。

免责声明：我所说的都是理论上的，我没有测试过所有这些东西，也没有足够的 LINQ 经验。
只是我的2美分。

# regex - URL 的最后一个路径组件的 rel-tag 小书签

> ID：265528
> 
> 赞同：2
> 
> 时间：2008-11-05T15:39:51.980
> 
> 标签：regex, tags, bookmarklet, rel, folksonomy

许多网站都支持民俗标签。您可能听说过[rel-tag](http://microformats.org/wiki/reltag)，它说“URL 的最后一个路径组件是标签的文本”。

我正在寻找一个书签或greasemonkey脚本（javascript）来获取当前在浏览器中查看的URL的“最后路径组件”，将该标签添加到另一个URL中，然后在新选项卡或窗口中打开该页面。

例如，如果我正在查看[带有标签“foo”的delicious.com 页面](http://delicious.com/popular/foo)，我可能想要创建[一个带有标签“foo”的新URL](http://technorati.com/tag/foo)。这也应该适用于最后一个路径组件中的多个标签，例如[foo+bar](http://delicious.com/popular/foo+bar)。

已经提供了一些正则[表达式建议。](http://microformats.org/discuss/mail/microformats-discuss/2008-June/012144.html)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T15:34:47.260

由于您使用的是 JavaScript，因此无需担心主机名、查询字符串等 - 只需用于`location.pathname`获取重要信息即可。

例如：

```
var NewUrl = 'http://technorati.com/tag/';
var LastPart = location.pathname.match( /[^\/]+\/?$/ );
window.open( NewUrl + LastPart ); 
```

这允许潜在的单个尾随斜杠。

您可以使用`/[^\/]+\$/`来禁止尾随斜杠或`/[^\/]+\/*$/`任意数量的斜杠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-26T17:26:20.533

如果您可以假设您的两个 URL 都有效，则可以使用此正则表达式从第一个 URL 获取标记：

```
^[a-z]+://[^/#?]+/[^#?]*?([^#?/]+)(?:[#?]|$) 
```

第一个（也是唯一的）捕获组将持有该标签。此正则表达式不会匹配没有任何标签的 URL。

要将标记附加到另一个 URL，请搜索正则表达式：

```
^([^#?]*?)/?(?:[#?]|$) 
```

并替换为：

```
$1/tag 
```

如果原始 URL 的路径以斜杠结尾，则此正则表达式确保不会在 URL 中以两个相邻的斜杠结尾。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-11-09T14:25:33.423

实施，如​​服务器的设置方式，所有爵士乐？我对那些东西不是很了解=\啊听起来

# c# - MSV08-C#：如何阻止两个组合框在相互拖到另一个上时自动设置它们自己？

> ID：265530
> 
> 赞同：0
> 
> 时间：2008-11-05T15:40:10.090
> 
> 标签：c#, .net

IDE：Microsoft Visual Studio 专业版 2008

语言：C#

背景：我有一个表单和两个组框，它们将用作偏好类别组框。我的问题是，每次我将一个组框拖到另一个组框之上（在列表视图类别选择时隐藏/显示组框），基本组框都会自动成为我刚刚拖到顶部的第二个组框的父级。

问题：我如何阻止两个组合框在相互拖拽时自动设置父级？

// 编辑;

问）我假设您正在尝试实现换出可见框的布局？——米切尔·塞勒斯

A）是的，我是。我知道我可以在运行时做到这一点，但如果有更合适的解决方案，我想把它作为我的最后选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T15:59:36.197

您可以考虑将第二个 GroupBox 的大小调整到第一个之上。拖动第二个组框的一侧或一个角，直到它覆盖第一个组框，然后继续调整第二个组框的大小，直到它按您想要的位置定位。

布局工具栏中还提供对齐和调整大小按钮。选择两个 GroupBox 以启用这些选项。当您使用对齐和调​​整大小按钮时，显示白色把手的 GroupBox 将保持静止，其中包括“使大小相同”和“居中对齐”选项。

此外，不要忘记您面前的键盘。箭头键将移动选定的控件。尝试在使用箭头键的同时按住`Ctrl`++的各种组合。`Alt``Shift`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T15:47:30.107

分组框的行为是可以将控件拖入其中，包括其他分组框控件。如果您在拖动鼠标时放开鼠标，它将成为该组框的子框，并且AFAIK无法更改设计器。除非您可能首先使用 send to back，否则将另一个加载到顶部。

我假设您正在尝试实现换出可见框的布局？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T10:08:48.743

有同样的问题，但通过将 groupbox 以它不会打扰的形式移动一点来解决它。然后我打开了可见标志。当然必须有一个更简单更好的解决方案，但这个对我有用。积极的一面是，您可以更轻松地在 VS 中设计分组框，因为它们会在执行期间以任何方式在正确的位置弹出......

```
 private void radioButton1_CheckedChanged(object sender, EventArgs e)
    {
        groupBox1.Location = new System.Drawing.Point(198, 234);
        groupBox2.Location = new System.Drawing.Point(660, 234);
        groupBox1.Visible = true;
        groupBox2.Visible = false;

    }

    private void radioButton2_CheckedChanged(object sender, EventArgs e)
    {
        groupBox1.Location = new System.Drawing.Point(660, 234);
        groupBox2.Location = new System.Drawing.Point(198, 234); 
        groupBox1.Visible = false;
        groupBox2.Visible = true;
    } 
```

# .net - Winforms ComboBox SelectedValueChange 事件

> ID：265538
> 
> 赞同：4
> 
> 时间：2008-11-05T15:45:35.213
> 
> 标签：.net, winforms, controls, combobox

首次加载组合框时，如何防止代码在组合框的 SelectedValueChange 事件中执行？当用户选择一个新值时，我需要执行代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-25T14:12:06.120

如果您只想在*用户*更改组合框时执行某些代码，您可以订阅 SelectionChangeCommitted 而不是 SelectionChanged。当以编程方式更改组合框选择时，不会调用“SelectionChangeCommitted”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T15:49:20.213

你有几个选择。

1.  而不是让设计者连接事件处理程序，您可以在加载后自己做

2.  您可以在应用程序中为“加载”设置一个标志，并将代码放入 SelectedValueChange 事件中以检查 !loading，然后再继续。

就我个人而言，如果它导致问题，我只会在加载后添加处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-25T14:49:00.367

我更喜欢 SelectedIndexChanged 事件，因为它的行为似乎更好地模拟了底层 Win32 API 的行为，使其可预测。

控件提供的一些更深奥的事件根本无法模拟人们对其名称所期望的行为。

# javascript - Prototype 的最佳字段验证插件是什么？

> ID：265541
> 
> 赞同：0
> 
> 时间：2008-11-05T15:46:17.940
> 
> 标签：javascript, forms, validation, prototypejs

不想重新发明轮子或任何东西，我想知道是否有一个插件可以与 Prototype 一起使用的字段或表单验证插件，您可以根据自己的经验推荐，为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T16:00:12.657

我喜欢 Ben Keen 的真正简单的验证组件。

我喜欢的功能：

所有验证规则都可以保存在 javascript 中，因此您无需将 class="required" 添加到 HTML 代码中。

您可以在 javascript 警告框中或 HTML 文本中显示错误消息。

添加自己的扩展很容易。

[http://www.benjaminkeen.com/software/rsv/](http://www.benjaminkeen.com/software/rsv/)

请注意，我只使用了 jQuery 版本，但也可以使用 Prototype 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T02:48:03.767

我喜欢[wforms](http://www.formassembly.com/wForms/)。例子：

```
<input type="text" name="myDate" class="validate-date"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T03:20:38.930

[JS验证](http://www.jsvalidate.com/)

# c# - 如何在 C# 中从未压缩的 zip 中读取文件？

> ID：265549
> 
> 赞同：0
> 
> 时间：2008-11-05T15:47:49.280
> 
> 标签：c#, compact-framework, zip

我正在创建一个 PDA 应用程序，我需要上传/下载很多小文件，我的想法是将它们收集在一个**未压缩的 zip 文件**中。

**问题是：从 zip 中读取这些文件**而不分离它们是个好主意吗？我该怎么做？还是**解压更好？**由于文件没有被压缩，我的简单想法可能是从 zip 中读取它们，它或多或少与直接从文件系统中读取它们一样有效......

谢谢你的时间！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T15:50:45.983

由于有两个不同的开源库（[SharpZipLib](http://icsharpcode.com/OpenSource/SharpZipLib/Default.aspx)和[DotNetZip 库](http://www.codeplex.com/DotNetZip)）来处理从 zip 文件中写入和提取文件，为什么还要担心自己做呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T04:41:18.220

ewww - 不要使用 J#。

从v1.7 开始， [DotNetZip](http://www.codeplex.com/DotNetZip)库在 .NET Compact Framework 2.0 及更高版本上运行。它可以处理在 ZIP 存档中读取或写入压缩或未压缩文件。源代码分发包括一个 CF 示例应用程序。这真的很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T16:08:34.917

听起来好像您想使用存档对文件进行分组。

从*阅读文件*的角度来看，文件以一种或另一种方式处理几乎没有什么区别。不过，您需要实现读取 zip 文件的功能。即使您使用像 James Curran 建议的库，这也意味着额外的工作，这可能意味着额外的错误来源。

从*上传文件*的角度来看，它更有意义：上传者可以收集所有需要的文件，并且只需要处理一次上传。这减少了开销以及错误处理（如果一个上传失败，您是否必须删除该组已上传的所有文件？）。

至于从存档读取它们与直接从光盘读取它们的效率：差异应该是最小的。您（或您的 zip 库）需要解析一次 zip 目录结构，这非常简单。剩下的是将文件的一部分读入内存与将文件读入内存。

# .net - WCF 错误处理程序

> ID：265551
> 
> 赞同：0
> 
> 时间：2008-11-05T15:49:07.793
> 
> 标签：.net, wcf

我已经阅读了一些关于构建自定义 ErrorHandler 的文档（通过从 IErrorHandler 继承）。不幸的是，我对如何做到这一点有几个疑问。

问题是我没有完全理解IErorrHandler这两个方法（即ProvideFault和HandleError）的含义。对我来说，HandleError 用于处理异步逻辑（例如登录）。但是，在这种情况下，为什么这个方法返回一个布尔值？我还认为可以使用另一种方法来确定错误是否应该传播到客户端或其他东西。

我错了吗 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T17:05:49.090

我曾经实现了一个处理程序来记录 HandleError() 中的异常，并在 ProvideFault() 中进行异常到故障的转换。这对我来说相当好一段时间。

但是，我已经停止使用 IErrorHandler，因为我发现它不会在所有异常上都被触发。我相信这是一个 System.Security.SecurityException 正在通过，不会被这段代码捕获。就像 WCF 对它进行了特殊处理，然后直接将其传递给客户端。这让我有点紧张，因为我开始想知道在这个所谓的包罗万象的界面中我还没有捕捉到什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T15:53:54.150

根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)，布尔值是返回执行所需行为的成功或失败。

您是正确的，因为 ProviderFault 方法是您控制返回给客户端的内容的地方。

我强烈建议阅读链接的 MSDN 文档，它提供了一些很好的见解。

# sql - 为什么不将 nvarchar 变量设置为 null 在此存储过程中不返回任何内容？

> ID：265559
> 
> 赞同：4
> 
> 时间：2008-11-05T15:50:34.530
> 
> 标签：sql, sql-server, tsql

当 @RadioServiceGroup 设置为 NULL 时，我想从 sbi_l_radioservicecodes 表中返回所有记录，该表有大约 120 条记录。但是，当我执行以下过程并将 @RadioServiceGroup 设置为 NULL 时，它不会返回任何记录。这是存储的过程：

```
CREATE PROCEDURE [dbo].[GetRadioServiceCodes] 
@RadioServiceGroup nvarchar(1000) = NULL
AS
BEGIN
IF(@RadioServiceGroup = NULL)
    BEGIN
        SELECT rsc.RadioService
        FROM sbi_l_radioservicecodes rsc    
    END
    ELSE
    BEGIN       
        SELECT rsc.RadioService
        FROM sbi_l_radioservicecodes rsc
        WHERE rsc.RadioServiceGroup = @RadioServiceGroup    
    END
END 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-05T15:51:27.087

尝试“IS NULL”而不是“= NULL”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T19:40:58.060

> 好奇，这只是关于为什么 = 在 nvarchar for NULL 上不起作用的语法问题吗

有人说 NULL = NULL 的计算结果为 false。这是错误的。NULL = NULL 计算为 NULL。

结果 (NULL) 不正确，因此运行 ELSE 条件。

另请参阅：[维基百科上的 ThreeValuedLogic](http://en.wikipedia.org/wiki/Sql_null#Three-valued_logic_.283VL.29)

您应该注意的另一个影响 - 连接：NULL + @SomeVar 评估为 NULL。这可能会意外清除计算字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T15:53:10.983

你可以完全剪掉`If`。试试这个：

```
CREATE PROCEDURE [dbo].[GetRadioServiceCodes] 
@RadioServiceGroup nvarchar(1000) = NULL
AS
BEGIN              
    SELECT rsc.RadioService
    FROM sbi_l_radioservicecodes rsc
    WHERE 
        rsc.RadioServiceGroup = @RadioServiceGroup    
        OR @RadioServiceGroup IS NULL
END 
```

如果 where 子句变得更复杂，请确保添加任何必要的括号来对它们进行分组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T16:27:21.633

使用“IS NULL”而不是“= NULL”

或者，要使“= NULL”工作，您可以在“CREATE PROCEDURE”之前编写“SET ANSI_NULLS OFF”。

# c++ - 从其他库创建一个库：可能吗？

> ID：265563
> 
> 赞同：0
> 
> 时间：2008-11-05T15:51:05.357
> 
> 标签：c++, windows-ce, platform-builder

我正在使用 Windows CE Platform Builder，我的代码是用 C++ 编写的。对于项目中的每个文件夹，我都在创建一个库（代码是静态链接的）。但是，到目前为止大约有 20 个库。有没有办法减少他们的数量？我正在考虑从其他库创建一个库，但我不知道这是否可能。是吗 ？

**编辑：**我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T15:57:16.280

我已经有一段时间没有尝试过了，但传统上您可以使用图书管理员工具 (LIB.EXE) 来执行此类操作。

```
$库/？
Microsoft (R) 库管理器版本 8.00.50727.762
版权所有 (C) 微软公司。版权所有。

用法：LIB [选项] [文件]

   选项：

      /DEF[:文件名]
      /错误报告：{无|提示|队列|发送}
      /出口：符号
      /EXTRACT:成员名
      /包括：符号
      /LIBPATH:目录
      /LIST[:文件名]
      /LTCG
      /机器：{ARM|EBC|IA64|MIPS|MIPS16|MIPSFPU|MIPSFPU16|
                SH4|拇指|X64|X86}
      /NAME:文件名
      /NODEFAULTLIB[:图书馆]
      /NOLOGO
      /OUT：文件名
      /删除：成员名
      /SUBSYSTEM:{BOOT_APPLICATION|CONSOLE|EFI_APPLICATION|
                  EFI_BOOT_SERVICE_DRIVER|EFI_ROM|EFI_RUNTIME_DRIVER|
                  原生|POSIX|WINDOWS|WINDOWSCE}[,#[.##]]
      /详细
      /WX[:否]

```

通常，图书管理员会获取 .OBJ 文件并将它们组合成 .LIB，但我认为它也会读取 .LIB 文件作为输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-21T10:16:02.067

as mentionet above, lib.exe can really merge a couple of lib files into one library, just put lib files into command line instead of obj files. few seconds ago i've tried it with a fortran lib and a c lib - everything works perfect

# windows - 是否支持 Windows XP 上的标准用户？

> ID：265579
> 
> 赞同：6
> 
> 时间：2008-11-05T15:57:05.517
> 
> 标签：windows, security

**更新：**由于开发机器已移至 Vista，我现在以标准用户身份自动测试。随着 XP 的逐步淘汰，这个问题不再那么重要了。

* * *

自 Windows 2000 徽标要求以来，Microsoft 一直要求应用程序以标准用户身份运行。像其他人一样，我总是以管理用户的身份运行我的桌面。和每个开发人员一样：我以管理用户身份登录、开发、运行和测试。

现在，随着对最终支持标准用户的新推动，我一直在通过以普通用户身份运行我的应用程序来测试我的应用程序 - 通过 RunAs，或者让我的应用程序使用`[SaferCreateLevel][1]`/`[SaferComputeTokenFromLevel][2]`如果它检测到它以管理员身份运行，则使用正常权限重新启动自己. 我很快就看到我的一些应用程序在 Windows XP 下作为标准用户失败了（由于我自己的愚蠢）。我还看到了相同的应用程序在 Vista 下如何正常工作（感谢它为我修复错误的大量垫片）。

**旁白：**具有讽刺意味的是，应用程序更有可能作为标准用户在 Vista 上运行而不是在 XP 上运行。

问题是您是否测试您的应用程序的标准用户兼容性？您是否在 XP 上作为标准用户进行开发？您是否忽略标准用户访问并希望获得最好的结果？

* * *

作为奖励，我尝试让我的应用程序作为受限用户（而不是普通用户）重新启动。它甚至没有出现 - Windows 说它无法初始化。所以我有一个未来的研究领域：让应用程序甚至支持有限的用户。

* * *

我特别提到了 XP 而不是 Vista 上的标准用户，以强制执行 Vista 就兼容性而言与 XP 没有什么不同的事实。任何说他们的应用程序在 Vista 上失败的人都必须意识到它在 XP 上也失败了。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-10T06:36:15.600

我将向您介绍 Crispin Cowan 的“ [Windows 标准用户开发的最佳实践](http://channel9.msdn.com/pdc2008/PC51/)”演讲。很值得一看。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-05T16:24:07.880

如果您想将您的应用程序出售给企业，那么可以，您 *必须*测试您的应用程序以标准用户身份运行。如果您的应用程序在没有管理权限的情况下无法运行，那么这将注定要出售给企业。

即使在国内市场，也有很多人可以并且确实使用有限的用户进行日常活动；我知道我知道。

即使是合法需要管理权限的管理应用程序，在作为受限用户运行时也应该表现得明智。他们应该弹出一个对话框，通知用户需要管理权限才能完成他们正在尝试的任何任务。

构建尊重这些限制的软件的最佳方法是在具有有限权限的用户下开发您的软件。这样，每次你开发一个特性时，你都在隐含地测试它是否能在有限的环境中工作。

这些都不难，只是需要一定程度的纪律——就像所有质量保证程序一样。几十年来，人们一直在 *nix 上开发为非 root 用户。Windows 开发在这方面落后于曲线。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-12T00:22:01.953

Crispin 在[他的 PDC 演讲](http://channel9.msdn.com/pdc2008/PC51/)中提出了一个**非常**好的观点，这是我以前从未考虑过的。

谷歌浏览器作为标准用户安装：它安装在每个用户的文件夹中，不需要 UAC 或 OTS 提示，而且一切都是用户友好的，因为安装*非常*简单。不幸的是，它安装在**每个用户的**文件夹中，用户可以在其中修改它。

换句话说：***恶意软件****可以修改 Chrome exe。*

Chrome 现在将成为任何恶意软件的最大目标。如果某些恶意软件*确实*修改了它，Chrome 现在会将您的用户名、密码和信用卡信息发送回您的基地，因为这就是**新**的Chrome exe 所做的。

这就是您有时*希望*将应用程序安装到受保护位置的原因。

* * *

*编辑：整个微软的“ **Click Once** ”部署计划遭受危险。*

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-05T16:02:02.060

在商业环境中，大多数用户都是标准的 windows 域用户。忽略标准的用户合规性测试是一个非常糟糕的举动。你会让每个必须安装你的应用程序的域管理员非常生气，他们会去参加你的比赛。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-06T00:20:31.273

我几乎一直以受限用户的身份在 XP 上运行，并且是默认用户。（在 Vista 上，我使用管理员帐户并依赖 UAC。）

我作为有限用户开发。在 Java 和 Visual Studio 开发中，几乎没有什么比这更需要特权了。

如果我需要在受限帐户下运行某些东西但具有管理权限，我会使用 MakeMeAdmin（重命名并调整为 ConsoleMeAdmin）.bat 脚本来创建管理控制台会话。

如果我真的需要成为管理员才能进行安装和首次运行，以便我的安全软件可以自我调节以允许网络访问新代码（或不允许）等，我将提升我的受限用户帐户给管理员足够长的时间来完成所有这些工作，然后再次以受限用户身份重新启动帐户。除了 Windows 更新之外，我以受限用户身份进行所有下载，然后在提升为管理员后离线安装。

因为我只有一个没有 Active Directory 的小型工作组 LAN，所以唯一有用的帐户类型是 XP 上的管理员和受限用户。（当我第一次开始使用 XP 时，我尝试了超级用户，但发现我可以不用它，我更喜欢它教给我的东西，而不是依赖于我构建的代码中的特殊权限。）

[PS：我的 XP 系统上默认启用了数据执行保护（硬件支持），你会惊讶于出现的结果。]

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-13T08:06:24.293

恕我直言，在管理员帐户中开发不仅没有必要，而且非常危险！假设您在开发时在 Internet 上检查了一些东西（想到了 stackoverflow）并且您发现了一些恶意软件 - 历史表明这比您想象的要容易得多，例如通过横幅。作为管理员，此恶意软件会感染您的计算机，您可能永远无法摆脱它。它甚至可能对您的所有开发工作构成威胁（想想工业间谍活动）！

如果您必须以管理员身份运行/测试任何东西，请使用**runas**甚至更好的**虚拟机**- 这样您就可以使用具有定义行为的单独系统（Windows 软件的许多问题来自开发人员 PC 上*当然*可用的库，但几乎没有其他任何地方！）。在 Microsoft Virtual PC 和 VMWare Server（都是免费的）时代，由于虚拟化软件的高价，甚至没有任何借口。

几年前，我开发了一些 Windows 应用程序，除了它们的安装程序之外，**没有**任何东西需要管理权限。运行时设置**始终**属于用户，而不属于机器。

是的，我在家里也以普通用户的身份运行 Windows XP，我的家人（父母等）也是如此。有时一个糟糕的软件需要对其安装文件夹的写入权限，但到今天，所有已安装的应用程序中有 95% 可以开箱即用地运行。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-05T15:59:52.267

是的，我们对此进行测试。

可能是最简单但被滥用最多的规则是，您不应该做任何需要对程序的安装文件夹进行写访问的事情。相反，有一个特殊的文件夹`Application Data`需要这种东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-05T16:16:04.370

是的，我接受了一般建议，即如果应用程序作为受限用户在 XP 上运行正常，那么让您的应用程序在 Vista 上运行会容易得多。为了实现这一点，并知道以受限用户身份运行是否有任何问题，我使用[了 LUABuglight](http://blogs.msdn.com/aaron_margosis/archive/2006/08/07/LuaBuglight.aspx)。

我一般不以受限用户身份进行开发，而仅以受限用户身份登录进行测试。

需要管理员权限并写入自己的 Program Files 文件夹的程序数量惊人。老实说，我发现很少有程序可以作为有限用户正确运行，无论是来自任何软件公司，无论大小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-12T16:18:33.710

其他任何人都觉得有趣的是，Windows 开发人员认为以管理员身份运行是正常的（显然），但 Linux 开发人员几乎从不以 root 身份运行？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-13T08:35:11.070

作为一个旧时的 BOFH，我会对任何要求提升权限以使其客户端应用程序正常运行的人大发雷霆。这是不可能的，自 2001-2002 年左右我们从 Win9x 切换到 XP（原文如此）以来一直如此。

作为一个新出生的开发人员，在一个地方，XP 上的每个人都是强制组策略的本地管理员，并且更改它似乎需要时间，而且没有人特别倾向于开始 - 我已经安装了**RunAsAdmin** shim，它将我降低到一个大多数任务的普通用户，包括开发 - 就像在 Vista 中一样。如果您在 XP 上被困为本地管理员，建议您使用 ^^

# c# - 为什么一个类不能在 C# 中扩展它自己的嵌套类？

> ID：265585
> 
> 赞同：32
> 
> 时间：2008-11-05T15:58:49.430
> 
> 标签：c#, nested-class

例如：

```
public class A : A.B
{
    public class B { }
} 
```

从编译器生成此错误：

> 涉及“A”和“AB”的循环基类依赖

我一直认为嵌套类的行为就像一个普通类，除了关于访问外部类的私有成员的特殊规则，但我猜这两个类之间发生了一些隐式继承？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-05T16:01:16.867

据我所知，不涉及隐式继承。我本以为这会没事的——尽管如果 A 和 B 是通用的，我可以想象会很奇怪。

它在规范的第 10.1.4 节中指定：

> 当类 B 派生自类 A 时，A 依赖于 B 是编译时错误。一个类直接依赖于它的直接基类（如果有的话）并且 **直接依赖于它立即嵌套的类**（如果有）。给定这个定义，一个类所依赖的完整类集是直接依赖关系的传递闭包。

我已经强调了相关部分。

这解释了为什么编译器拒绝它，但不能解释为什么语言禁止它。我想知道是否有 CLI 限制...

编辑：好的，我收到了 Eric Lippert 的回复。基本上，这在技术上是可行的（CLI 中没有禁止它的内容），但是：

*   在编译器中允许它会很困难，使当前关于排序和循环的各种假设无效
*   这是一个非常奇怪的设计决定，禁止比支持更容易

电子邮件线程上还指出，它会使这种事情有效：

```
A.B x = new A.B.B.B.B.B.B.B.B.B.B.B.B(); 
```

...但是如果 B 从 A 派生，那已经（如 Tinister 所述）是有效的。

嵌套+继承=奇怪...

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-05T16:17:29.873

这不是 C# 的事情，而是编译器的事情。编译器的工作之一是在内存中布局一个类，即一堆基本数据类型、指针、函数指针和其他类。

在知道 B 类的布局是什么之前，它不能为 A 类构造布局。在完成A类的布局之前，它无法知道B类的布局是什么。循环依赖。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T16:53:20.160

关于我试图做什么的问题：

基本上，我想创建一个与自身具有组合关系的类，但我不想让包含的对象包含其他对象，因此创建一个包含许多“A has-a A has-a A has-”的链一个有一个...”的关系。所以我当时的想法是做这样的事情：

```
public class A : A.AA
{
    public class AA
    {
        // All of the class's logic
    }

    private AA _containedObject;
} 
```

当时看起来很漂亮，但回想起来我不太确定......

我翻遍了谷歌并没有找到任何好的讨论，所以我想我会把它贴在这里。

然而，[在 Eric Lippert 博客上的一篇文章](http://blogs.msdn.com/ericlippert/archive/2008/09/26/preventing-third-party-derivation-part-one.aspx)的评论中，他给出了一个实现嵌套接口的类以及一个实现泛型接口的类的示例，其中嵌套类作为类型参数（它不会编译，他称之为“错误”在当前编译器中）。这两个例子都涉及接口，所以我想知道嵌套类是否有一些特殊规则。似乎有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T16:17:14.103

我认为嵌套是为了表示嵌套类型是嵌套类型*定义的一部分*。通过这种解释，限制是有道理的，因为在编译器达到 A 的定义时，AB 尚未定义，甚至在 A 的末尾，它已经根据 AB 定义

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-29T02:22:18.530

通过从包含嵌套接口的单独类继承，我能够避免这种情况（至少使用接口）。（在我的场景中，我还返回对这些接口的引用。）

代替：

```
public class MyClass<T1, T2, T3> :
   MyClass<T1, T2, T3>.Interface
where T1 : ...
where T2 : ... 
where T3 : ... {
   public interface Interface { Interface SomeMethod(); }

   Interface Interface.SomeMethod() {
      ...
   }
}

// compile error: Circular base class dependency 
```

做这样的事情：

```
public sealed class MyClassInterfaces<T1, T2, T3>
where T1 : ...
where T2 : ... 
where T3 : ... {
   public interface Interface { Interface SomeMethod(); }
}

sealed class MyClass<T1, T2, T3> :
   MyClassInterfaces<T1, T2, T3>.Interface
where T1 : ...
where T2 : ... 
where T3 : ... {
   MyClassInterfaces<T1, T2, T3>.Interface
   MyClassInterfaces<T1, T2, T3>.Interface.SomeMethod() {
      ...
   }
} 
```

为了避免显式接口实现的丑陋，您还可以从另一个类继承，尽管如果您尝试从嵌套类继承，那将不起作用，因为您不能从两个类继承。

```
public abstract class MyClassInterfaces<T1, T2, T3>
where T1 : ...
where T2 : ... 
where T3 : ... {
   public interface Interface { Interface SomeMethod(); }
}

sealed class MyClass<T1, T2, T3> :
   MyClassInterfaces<T1, T2, T3>,
   MyClassInterfaces<T1, T2, T3>.Interface
where T1 : ...
where T2 : ... 
where T3 : ... {
   Interface Interface.SomeMethod() {
      ...
   }
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-05T16:15:46.603

这对我来说毫无意义......您正在尝试扩展不存在的东西！B 类只存在于 A 类的范围内，因此我认为存在某种继承。

# unix - 使用VM（虚拟机）时可以设置开发/随机吗？

> ID：265591
> 
> 赞同：2
> 
> 时间：2008-11-05T16:00:03.217
> 
> 标签：unix, random, operating-system, vmware

有谁知道在虚拟机中运行操作系统时是否可以设置开发/随机（在这种情况下为 VMWare）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T19:54:56.067

“设置”是什么意思？/dev/random 将在 VM 中可用，并且工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T12:05:16.740

这不是一个答案，而是一种解决方法：当我遇到同样的问题时，我在物理机器上生成了密钥并复制了它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-04T16:18:03.200

数据中心服务器缺乏熵源无疑是一个严重的问题。正如您刚刚体验到的，在云/虚拟环境中情况更糟。

为了解决这个问题，我们公司目前正在开发一种 True-RNG 设备，它可以通过数据中心的内部 LAN 为数据中心的所有服务器和 VM 提供良好的熵。当然，您需要您的云提供商将设备安装在其 DC 中，但在这种情况下，您可以通过安装一个简单的守护程序来监视熵池并向需要时使用器具。

不想用广告污染博客，但如果您有兴趣或想了解更多信息，请随时访问我们的网站 (www.sqrtech.com) 或通过 info@sqrtech.com 联系我们。

朱利安

# automation - 如何以编程方式定期从网站获取内容？

> ID：265592
> 
> 赞同：1
> 
> 时间：2008-11-05T16:00:03.623
> 
> 标签：automation

让我先说我不在乎这个解决方案是用什么语言编写的，只要它在 Windows 上运行。

我的问题是：有一个网站的数据经常更新，我想定期获取这些数据以供以后报告。该站点需要 JavaScript 才能正常工作，因此仅使用 wget 是行不通的。将浏览器嵌入程序或使用独立浏览器定期抓取屏幕以获取此数据的好方法是什么？

理想情况下，我想抓取页面上的某些表格，但如有必要可以使用正则表达式。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-05T16:02:38.593

您可能可以使用诸如 Watir、Watin 或 Selenium 之类的 Web 应用程序测试工具来自动化浏览器以从页面中获取值。我以前做过这个来抓取数据，而且效果很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T16:05:05.063

如果 JavaScript 是必须的，您可以尝试通过 ActiveX ( `CreateObject("InternetExplorer.Application")`) 实例化 Internet Explorer 并使用它的`Navigate2()`方法打开您的网页。

```
Set ie = CreateObject("InternetExplorer.Application")
ie.Visible = True
ie.Navigate2 "http://stackoverflow.com" 
```

页面完成加载（检查`document.ReadyState`）后，您可以完全访问 DOM，并且可以使用任何方法来提取您喜欢的任何内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T16:10:35.303

你可以看看[美丽的汤](http://www.crummy.com/software/BeautifulSoup/) - 作为开源 python，它很容易编程。引用网站：

Beautiful Soup 是一个 Python HTML/XML 解析器，专为屏幕抓取等快速周转项目而设计。三个功能使其功能强大：

1.  如果你给它错误的标记，Beautiful Soup 不会窒息。它会生成一个解析树，其意义与您的原始文档大致相同。这通常足以收集您需要的数据并逃跑。
2.  Beautiful Soup 提供了一些用于导航、搜索和修改解析树的简单方法和 Pythonic 习惯用法：用于剖析文档和提取所需内容的工具包。您不必为每个应用程序创建自定义解析器。
3.  Beautiful Soup 自动将传入文档转换为 Unicode，将传出文档自动转换为 UTF-8。您不必考虑编码，除非文档未指定编码并且 Beautiful Soup 无法自动检测编码。然后你只需要指定原始编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T18:07:14.817

If you are familiar with Java (or perhaps, other language that runs on a JVM such as JRuby, Jython, etc.), you can use HTMLUnit; HTMLUnit simulates a complete browser; http requests, creating a DOM for each page and running Javascript (using Mozilla's Rhino).

Additionally, you can run XPath queries on documents loaded in the simulated browser, simulate events, etc.

[http://htmlunit.sourceforge.net](http://htmlunit.sourceforge.net)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T16:19:57.310

我会推荐[Yahoo Pipes](http://pipes.yahoo.com)，这正是它们的目的。然后，您可以将 yahoo 管道数据作为 RSS 提要获取，并随心所欲地使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T16:07:31.503

试试[坏男孩](http://www.badboy.com.au/)。它旨在自动化您网站的系统测试，但您可能会发现它的正则表达式规则非常方便，可以满足您的需求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-05T16:36:48.540

如果您有 Excel，那么您应该能够将网页中的数据导入 Excel。

从数据菜单中选择导入外部数据，然后选择新建 Web 查询。

一旦数据在 Excel 中，您就可以在 Excel 中对其进行操作或以您可以在其他地方使用的格式（例如 CSV）输出它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-05T16:44:46.560

作为对 Whaledawg 建议的补充，我将建议使用 RSS 抓取应用程序（进行 Google 搜索），然后您可以获得漂亮的原始 XML 以编程方式使用而不是响应流。如果您想自己实现，甚至可能有一些开源实现会给您更多的想法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-02T21:22:28.857

我最近对这个话题做了一些研究。我找到的最好的资源是[这篇 Wikipedia 文章](http://en.wikipedia.org/wiki/Web-scraping_software_comparison)，它提供了许多屏幕抓取引擎的链接。

我需要一些可以用作服务器并批量运行的东西，从我最初的调查来看，我认为[Web Harvest](http://web-harvest.sourceforge.net/)作为一个开源解决方案是相当不错的，而且我也对[Screen Scraper](http://screen-scraper.com/)印象深刻，这似乎功能非常丰富，您可以将其与不同的语言一起使用。

还有一个名为[Scrapy](http://dev.scrapy.org/)的新项目，尚未检查，但它是一个 python 框架。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-05T18:13:14.743

您可以将 Perl 模块[LWP](http://search.cpan.org/dist/libwww-perl/)与模块[JavaScript](http://search.cpan.org/dist/JavaScript/)一起使用。虽然这可能不是最快的设置，但它应该可以可靠地工作。不过，我绝对不会让这是你第一次涉足 Perl。

# asp.net - ASP.NET 商业 Uber-Grids 的开源替代方案

> ID：265593
> 
> 赞同：4
> 
> 时间：2008-11-05T16:00:11.970
> 
> 标签：asp.net, open-source, grid

我工作的公司使用来自商业供应商的 ASP.NET 网格组件，但由于成本原因，不会将我们必须的有缺陷的旧版本升级到新版本。我们可以利用这些 Uber-Grids 的开源替代品吗？

我专门寻找分层的向下钻取功能。我知道有一些 Javascript 库插件（用于 jquery UI 等的东西）可以使用，但鉴于我雇主当前的编码约定，我更喜欢服务器端控件（尽可能使用服务器端控件，其他时使用 javascript将工作:-P)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T16:29:01.630

使用 ExtJS 的网格包装器控制[http://www.codeplex.com/ExtJsExtenderControl](http://www.codeplex.com/ExtJsExtenderControl)

查看分组功能的[演示页面](http://extendersamples.rodiniz.com/#)，但不确定您可以进入多少级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-26T07:49:41.353

试试这个扩展 ASP.NET GridView 的开源项目：http: [//johnsobrepena.blogspot.com/2010/01/coolgridview-new-release-resizable.html](http://johnsobrepena.blogspot.com/2010/01/coolgridview-new-release-resizable.html)

1.  固定列标题、页脚和分页器
2.  可滚动内容
3.  用户可调整的列宽（新！）
4.  在回发或回调后保持滚动位置和列宽（新！）

# ruby - 你在 Linux 上为 Ruby 使用什么 IDE/编辑器？

> ID：265601
> 
> 赞同：8
> 
> 时间：2008-11-05T16:01:30.610
> 
> 标签：ruby, linux, ide, editor

我一直在使用 vim，但是在阅读[了这个问题](https://stackoverflow.com/questions/256365/what-ide-editor-do-you-use-for-ruby-on-windows)之后，我想知道 linux 世界正在使用什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T16:21:56.293

还有 Netbeans：[http ://ruby.netbeans.org/](http://ruby.netbeans.org/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T17:03:06.007

如果您宁愿使用轻型文本编辑器而不是重型 IDE，那么我强烈建议您使用带有一些附加插件的 GEdit。

这是一个关于如何将 GEdit 变成“Linux Textmate”的优秀指南：

[皮条客我的 GEdit](http://grigio.org/pimp_my_gedit_was_textmate_linux)

如果您想要更多的 IDE，那么 Netbeans 是当前 Ruby IDE 的基准。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-05T16:16:06.307

我使用过并且非常喜欢 JetBrains 的 Ruby Mine。它自 2008 年左右就存在了，这里是链接：http: [//www.jetbrains.com/ruby/index.html](http://www.jetbrains.com/ruby/index.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-05T17:33:54.760

I use [Diakonos](http://purepistos.net/diakonos). Written in Ruby, you can script it with Ruby, and manipulate text with Ruby. No dependencies (except Ruby itself).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T01:16:18.237

我不会肯定 IDE 比其他 IDE 更好。每个人都有它的优点和缺点。当我懒惰时，我会使用 Netbeans，因为它很全面。计算机资源的过度杀伤力，但如果您正在学习，则很有用。我对 Aptana 有过不好的评论……也许你们中的一些人建议这样做可能不得不说服我。

GEdit + Rails 插件可能是一个不错的选择。而且 VIM 非常强大，但学习曲线更陡峭（但是一旦你尝到了它的味道，生产力肯定会提高）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T16:04:06.923

我将 Eclipse 与 Aptana RadRails 一起使用：http: [//aptana.com/rails](http://aptana.com/rails)

但如果您只需要 Ruby，您可以改用 RDT：[http ://rubyeclipse.sourceforge.net/](http://rubyeclipse.sourceforge.net/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T21:36:11.463

我很惊讶没有人提到[jEdit](http://www.jedit.org) - 它有大量的 Ruby 插件，并且与许多其他支持 Ruby 的编辑器不同，它非常稳定。erb、rb、javascript、haml 等有编辑模式 + 语法着色等。我设置它基本上是为了模仿 TextMate，带有一些 Eclipse-isms。它不会完成代码完成，但它至少会尝试从当前缓冲区完成。它还具有非常可扩展的击键配置和录制/播放宏的能力。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-27T00:18:44.587

我假设您正在使用 Ruby 网页版？带有 RADRails 插件的 Aptana IDE 必须是最佳选择。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-07T15:03:27.110

我真的很喜欢将[Geany](http://www.geany.org/)用于 ruby​​ 和 rails 工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-07T15:11:32.253

这一切都取决于你想要什么。

我个人使用 vim 作为编辑器，作为我的 IDE 的默认 ruby​​ 工具。

如果您正在寻找更“重量级”的 IDE，请查看 Eclipse（[http://rubyeclipse.sourceforge.net/](http://rubyeclipse.sourceforge.net/)）或 netbeans（Google 获取链接）。有许多中间选项，它们的行为不同并且具有不同的功能。在这些方面，谷歌是你最好的。

另外 - 请参阅[Ruby 和 linux，首选设置？](https://stackoverflow.com/questions/253982/ruby-and-linux-prefered-setup) 和[https://stackoverflow.com/questions/59968/best-editor-for-ruby](https://stackoverflow.com/questions/59968/best-editor-for-ruby) 如果我可以关闭这个问题作为一个骗子 - 我会的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-05T16:08:46.040

komodo Edit 是最好的选择。

# java - 使用 JNI 摆动透明度

> ID：265602
> 
> 赞同：0
> 
> 时间：2008-11-05T16:01:47.113
> 
> 标签：java, java-native-interface, transparency

我正在尝试创建一个简单的 Java 应用程序，该应用程序显示一个包含 JButton 的框架。我正在使用 JNI 为窗口添加透明度。窗口是透明的，但按钮不是。此外，当我移动窗口时，按钮不会随窗口移动。JLabel 也会发生同样的事情。如果我使用 Button 而不是 JButton 它工作得很好。

本机代码：

```
#include <windows.h>
#include <jawt_md.h>
#include <jawt.h>
#include <jni.h>

// Don't mangle names for the JVM
extern "C" {

BOOL APIENTRY DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved
                     )
{
    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:
    case DLL_THREAD_ATTACH:
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}

/**
 * Gets the window handle for the Java window.
 * Procedure for obtaining the handle:
 *   1\. Get the structure (JAWT) that contains the native methods. 
 *   2\. Get the drawing surface (JAWT_DrawingSurface).
 *   3\. Using the drawing surface, get the drawing surface info (JAWT_DrawingSurfaceInfo).
 *   4\. Get the drawing info that's specific to Win32 (JAWT_Win32DrawingSurfaceInfo).
 *   5\. Using the drawing surface info, get the hwnd.
 */
/*
 * Class:     test_Transparency
 * Method:    getWindowHandle
 * Signature: (Ljava/awt/Component;)J
 */
JNIEXPORT jlong JNICALL Java_test_Transparency_getWindowHandle
  (JNIEnv * env, jclass cls, jobject component)
{
   JAWT awt;
   JAWT_DrawingSurface* ds;
   JAWT_DrawingSurfaceInfo* dsi;
   JAWT_Win32DrawingSurfaceInfo* dsi_win;
   jint dsLock;
   jboolean result = JNI_FALSE;

   // Get the AWT
   awt.version = JAWT_VERSION_1_4;
   result = JAWT_GetAWT(env, &awt);

   if ( result == JNI_FALSE )
   {
      printf( "%s:%i -  JAWT_GetAWT() failed.\n", __FILE__, __LINE__ );
      return 0;
   }

   // Get the drawing surface
   ds = awt.GetDrawingSurface(env, component);

   if ( ds == NULL )
   {
      printf( "%s:%i -  GetDrawingSurface() failed.\n", __FILE__, __LINE__ );
      return 0;
   }

   dsLock = ds->Lock(ds);

   // Get the drawing surface info
   dsi = ds->GetDrawingSurfaceInfo(ds);

   // Get the platform-specific drawing info
   dsi_win = (JAWT_Win32DrawingSurfaceInfo*)dsi->platformInfo;

   HWND handle = dsi_win->hwnd;

   ds->FreeDrawingSurfaceInfo(dsi);
   ds->Unlock(ds);
   awt.FreeDrawingSurface(ds);

   return (jlong)handle;
}

void printLastError()
{
    LPTSTR pszMessage;
    DWORD dwLastError = GetLastError(); 

    FormatMessage(
        FORMAT_MESSAGE_ALLOCATE_BUFFER | 
        FORMAT_MESSAGE_FROM_SYSTEM |
        FORMAT_MESSAGE_IGNORE_INSERTS,
        NULL,
        dwLastError,
        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
        (LPTSTR)&pszMessage,
        0, NULL );

    // Display the error message
    wprintf(L"failed with error %d: %s\n", dwLastError, pszMessage);

    LocalFree(pszMessage);

}

/*
 * Class:     test_Transparency
 * Method:    setTransparency
 * Signature: (JF)V
 */
JNIEXPORT void JNICALL Java_test_Transparency_setTransparency
  (JNIEnv * env, jclass cls, jlong windowHandle, jfloat alpha)
{

   HWND hwnd = (HWND)windowHandle;

   // Get the current window style
   LONG currentStyle = GetWindowLong(hwnd, GWL_EXSTYLE);

   if ( currentStyle == 0 )
   {
      printf( "Error calling GetWindowLong() ");
      printLastError();

   }

   if ( alpha == 0 )
   {
      // No transparency.
      // Remove WS_EX_LAYERED from this window style
      SetWindowLong(hwnd, GWL_EXSTYLE, currentStyle & ~WS_EX_LAYERED);
   }
   else
   {
      // Calculate the transparency value. Should be in the range 0-255
      unsigned char transparency = (unsigned char)(255 * alpha);

      // Set window style to WS_EX_LAYERED. This is required for windows to be transparent.
      SetWindowLong(hwnd, GWL_EXSTYLE, currentStyle | WS_EX_LAYERED );

      // set the transparency level
      SetLayeredWindowAttributes(hwnd, 0, transparency, LWA_ALPHA);
   }
}

} // extern "C" 
```

MyFrame.java

```
package test;

import javax.swing.*;
import javax.swing.SwingUtilities;
import java.awt.event.*;

public class MyFrame implements ActionListener
{
   private JFrame frame;
   private Transparency trans; // = new Transparency();
   private float t = 1.0f;

   public MyFrame()
   {
      frame = new JFrame("My transparent window");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.setBounds( 10, 10, 200, 200 );

      JButton button = new JButton("My button");
      button.setBounds( 20, 20, 50, 10 );
      button.addActionListener( this );

      JPanel panel = new JPanel();
      panel.add( button );

      frame.setContentPane( panel );

      //Display the window.
      frame.setVisible(true);

      trans = new Transparency();
   }

   /**
    * @param args
    */
   public static void main( String[] args )
   {
      MyFrame f = new MyFrame();
   }

   public void actionPerformed(ActionEvent e)
   {
      t -= 0.05f;
      trans.setWindowOpacity( frame, t );
   }

} 
```

透明度.java

```
package test;

import java.awt.Window;
import java.awt.Component;

public class Transparency
{
   static boolean libLoaded = false;
   /**
    * Sets the transparency for a window.
    * @param hwnd Handle for the window.
    * @param opacity Transparency level, from 0.0 to 1.0.
    * 1.0 is completely transparent. 0.0 is completely opaque.
    */
   private static native void setTransparency( long hwnd, float opacity );

   /**
    * Get the window handle for the component.
    * @param component
    * @return HWND value obtained from the OS.
    */
   private static native long getWindowHandle( Component component );

   static
   {
      try
      {
         System.loadLibrary("transJNI");
         libLoaded = true;
      }
      catch ( Exception e )
      {
         e.printStackTrace();
         libLoaded = false;
      }
   }

   /**
    * @param window The window whose opacity will be adjusted.
    * @param opacity The opacity level, from 0.0 (opaque) to 1.0 (completely transparent).
    */
   public void setWindowOpacity(Window window, float opacity)
   {
      if ( !libLoaded )
      {
         return;
      }

      if ( !window.isVisible() )
      {
         return;
      }
      long hwnd = getWindowHandle( window );
      setTransparency(hwnd, opacity);

   }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T16:40:42.637

6u10 supports [transparent windows](http://java.sun.com/developer/technicalArticles/GUI/translucent_shaped_windows/) through an unofficial API. 6u10 is available for download through java.com and previous JDK versions will update to it or a later update soon.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T18:07:38.343

[Team Dev's Winpack.](http://www.teamdev.com/winpack/features.jsf)

Try it out. Looks interesting to me.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T16:09:36.303

您可能会在[JNA](https://github.com/twall/jna/)上取得更大的成功，尤其是他们的[Window utils](https://github.com/twall/jna/javadoc/com/sun/jna/examples/WindowUtils.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T18:15:03.337

SwingX 有许多透明的功能，我不能 100% 确定它会满足您的需求，但请尝试一下！swinglabs.org

# c# - 如何在 WinForms 项目中使用 XML 作为 DataGridView 的数据源？

> ID：265604
> 
> 赞同：5
> 
> 时间：2008-11-05T16:02:07.970
> 
> 标签：c#, .net, xml, winforms, datagridview

如何将可编辑的 DataGridView 链接到 WinForms 项目中的 XML 文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T16:44:57.497

[MSDN 在此处http://msdn.microsoft.com/en-us/magazine/cc163669.aspx](http://msdn.microsoft.com/en-us/magazine/cc163669.aspx)推荐的最简单方法 是将其加载到数据集中。

> Q 你能告诉我将 XML 数据绑定到 DataGridView 控件的最佳方法吗？
> 
> A 最简单的可能解决方案是将 XML 加载到 DataSet 中并绑定到该数据集中。另一种解决方案是使用 XML 序列化从 XML 创建对象图并绑定到该对象图。要绑定到原始 XML，您需要创建实现 ITypedList、IBindingList 和 ICustomTypeDescriptor 的包装类。

DevX 这里有一整套代码和一个教程，可以帮助您通过数据集将 DataGridView 绑定到 XML。[http://www.devx.com/dotnet/Article/28678/1954](http://www.devx.com/dotnet/Article/28678/1954)

希望这可以帮助。

# sql - 有没有办法在 SQL Server 中获取打开/分配的游标列表？

> ID：265605
> 
> 赞同：5
> 
> 时间：2008-11-05T16:02:11.840
> 
> 标签：sql, sql-server, sql-server-2000, database-cursor

我有一个创建和打开一些游标的存储过程。它在最后关闭它们，但如果遇到错误，这些游标将保持打开状态！然后，当它尝试创建游标时，后续运行会失败，因为具有该名称的游标已经存在。

有没有办法可以查询存在哪些游标以及它们是否打开，以便我可以关闭并释放它们？我觉得这比盲目地试图关闭和吞下错误要好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T16:10:11.277

[在此处](http://msdn.microsoft.com/en-us/library/aa172595(SQL.80).aspx)查找有关如何查找游标的信息。我从来没有使用过它们中的任何一个，因为我可以找到一种方法来完成它，而无需逐行逐行。

您应该将 sp 重建为

*   不使用游标（我们可以提供帮助 - 几乎总有办法避免 RBAR）

*   在事务中构建它并在出现故障或检测到错误时回滚。这里有一些关于这方面的优秀文章。[第 1](http://www.sommarskog.se/error-handling-I.html)部分和[第 2 部分](http://www.sommarskog.se/error-handling-II.html)

如果你有SQL2005，你也可以使用[try catch](http://technet.microsoft.com/en-us/library/ms175976.aspx)

编辑（回应您的帖子）：理想情况下，数据生成最好在应用程序级别处理，因为它们更适合基于非集合的操作。

Red Gate 有一个我以前使用过的[SQL 数据生成器（它非常适合单表，但如果您有很多 FK 或宽 [规范化] 数据库，则需要进行一些配置）。](http://www.red-gate.com/products/SQL_Data_Generator/index.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-10T15:19:50.177

这似乎对我有用：

```
CREATE PROCEDURE dbo.p_cleanUpCursor @cursorName varchar(255) AS
BEGIN

    DECLARE @cursorStatus int
    SET @cursorStatus =  (SELECT cursor_status('global',@cursorName))

    DECLARE @sql varchar(255)
    SET @sql = ''

    IF @cursorStatus > 0
        SET @sql = 'CLOSE '+@cursorName

    IF @cursorStatus > -3
        SET @sql = @sql+' DEALLOCATE '+@cursorName

    IF @sql <> ''
        exec(@sql)

END 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T19:25:21.893

这适用于 2008R2，在此之前没有测试过任何东西：

```
USE MASTER
GO
select s.session_id, s.host_name, s.program_name, s.client_interface_name, s.login_name
, c.cursor_id, c.properties, c.creation_time, c.is_open, con.text,
l.resource_type, d.name, l.request_type, l.request_Status, l.request_reference_count, l.request_lifetime, l.request_owner_type
from sys.dm_exec_cursors(0) c
left outer join (select * from sys.dm_exec_connections c cross apply sys.dm_exec_sql_text(c.most_recent_sql_handle) mr) con on c.session_id = con.session_id
left outer join sys.dm_exec_sessions s on s.session_id = c.session_id
left outer join sys.dm_tran_locks l on l.request_session_id = c.session_id
left outer join sys.databases d on d.database_id = l.resource_database_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T13:03:28.867

> 您可以使用**sp_cursor_list**系统存储过程来获取对当前连接可见的游标列表，并 **使用 sp_describe_cursor**、**sp_describe_cursor_columns**和 **sp_describe_cursor_tables**来确定游标的特征。

（来自[http://msdn.microsoft.com/it-it/library/aa172595(v=sql.80).aspx](http://msdn.microsoft.com/it-it/library/aa172595(v=sql.80).aspx)）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-08T11:00:48.780

您可以使用

> sys.dm_exec_cursors

[如此处](https://docs.microsoft.com/en-us/sql/relational-databases/system-dynamic-management-views/sys-dm-exec-cursors-transact-sql?view=sql-server-2017)所述

基本上，您可以运行此示例查询并获取有关在各种数据库中打开的游标的信息

> sys.dm_exec_cursors(0)

# windows - 如何在 iis 中添加新的应用程序映射

> ID：265613
> 
> 赞同：2
> 
> 时间：2008-11-05T16:02:51.667
> 
> 标签：windows, iis, vbscript

如何使用 vbscript 在 IIS 中添加新的应用程序映射？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T16:26:00.637

基本上你*可以*用来`adsutil.vbs`操作 MetaBase 中的 ScriptMaps。

不幸的是，`adsutil.vbs`无法在 ScriptMaps 等 LIST 属性中设置单个项目。您只能设置或删除整个列表。任何额外的处理都需要您自己编码。

一位名叫 David Wang 的人制作了一个具有此功能的 VB 脚本。[他在有关该主题的博客条目中进行了](http://blogs.msdn.com/david.wang/archive/2004/12/02/273681.aspx)更详细的解释。他制作的剧本可以从那里复制。您也可以使用它修改其他 LIST 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T16:25:31.247

将 ADSI 与 VBScript 结合使用。这里有几个例子：http: [//www.microsoft.com/technet/prodtechnol/WindowsServer2003/library/IIS/4b976f46-3751-4f6b-ab68-5e19fa73a7b1.mspx](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/library/IIS/4b976f46-3751-4f6b-ab68-5e19fa73a7b1.mspx)

# asp.net - 本地站点上的基本 iis 5.0 xml 解析错误

> ID：265619
> 
> 赞同：1
> 
> 时间：2008-11-05T16:05:18.993
> 
> 标签：asp.net, iis, isapi

我正在开始一份新工作，并在 2.0 .net 框架上继承了一个 asp .net Web 应用程序。该应用程序工作正常。它从 vs 2005 成功发布。我在 IIS 中创建了一个新的虚拟目录，并指向刚刚发布的预编译目录。

当我加载我的应用程序时，我收到如下错误：

XML 解析错误：格式不正确 位置：[http://localhost/Subpoena/](http://localhost/Subpoena/) 第 1 行，第 2 列：<%@ page language="C#" autoeventwireup="true" inherits="Home, App_Web_ysxqzhr9" %> -^

我不确定该怎么做才能解决这个问题。App_Web_ysxqzhr9 是我发布项目时由 VS 2005 创建的 bin 目录中的一个 dll。

我承认我对我的 IIS 技能有点生疏，所以它可能是我没有设置的一些设置......或者它可能是完全不同的东西。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T17:53:31.647

*sigh*

Okay found the answer. Ironically it too was on stack overflow. Here it is:

[ASP.NET 2.0 Application on IIS 5 Resulting in Error (aspnet_wp.exe (PID: XXXX) stopped unexpectedly.)](https://stackoverflow.com/questions/233478/aspnet-20-application-on-iis-5-resulting-in-error-aspnetwpexe-pid-xxxx-stopped)

What worked for me was Mitchel Sellers response:

1.  Open command prompt to C:\windows\microsoft.net\framework\v2.0.50727
2.  run the following command: aspnet_regiis.exe -u
3.  run the following command: aspnet_regiis.exe -i

Thanks anyway for all your help guys.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T16:09:58.860

您的 IIS 配置正确吗？您应该仔细检查 asp 文件是否实际上被解释为 ASP，而不仅仅是试图被浏览器显示为 XML。在文件夹的配置中，确保“应用程序名称”字段旁边的按钮显示“删除”而不是“创建”。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-05T16:30:14.450

您可能还需要安装 Microsoft WSE 扩展。

像这样的东西：http: [//www.microsoft.com/downloads/details.aspx? FamilyID=018a09fd-3a74-43c5-8ec1-8d789091255d&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=018a09fd-3a74-43c5-8ec1-8d789091255d&displaylang=en)

编辑：System.Web 是 WSE 的一部分，但我不确定它们是如何一起发挥作用的。

# sql - 如果指定了 SELECT DISTINCT，则 ORDER BY 项目必须出现在选择列表中

> ID：265628
> 
> 赞同：81
> 
> 时间：2008-11-05T16:08:52.233
> 
> 标签：sql, sql-server, tsql

我将选择列表中的列添加到按列表排序，但它仍然给我错误：

如果指定了 SELECT DISTINCT，则 ORDER BY 项目必须出现在选择列表中。

这是存储的过程：

```
CREATE PROCEDURE [dbo].[GetRadioServiceCodesINGroup] 
@RadioServiceGroup nvarchar(1000) = NULL
AS
BEGIN
SET NOCOUNT ON;

SELECT DISTINCT rsc.RadioServiceCodeId,
                rsc.RadioServiceCode + ' - ' + rsc.RadioService as RadioService
FROM sbi_l_radioservicecodes rsc
INNER JOIN sbi_l_radioservicecodegroups rscg 
ON rsc.radioservicecodeid = rscg.radioservicecodeid
WHERE rscg.radioservicegroupid IN 
(select val from dbo.fnParseArray(@RadioServiceGroup,','))
OR @RadioServiceGroup IS NULL  
ORDER BY rsc.RadioServiceCode,rsc.RadioServiceCodeId,rsc.RadioService

END 
```

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-11-05T16:11:31.087

试试这个：

```
ORDER BY 1, 2 
```

或者

```
ORDER BY rsc.RadioServiceCodeId, rsc.RadioServiceCode + ' - ' + rsc.RadioService 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-11-05T16:10:39.187

虽然它们不是一回事，但在某种意义上`DISTINCT`意味着 a `GROUP BY`，因为 each`DISTINCT`可以改用重写`GROUP BY`。考虑到这一点，按不在聚合组中的东西进行排序是没有意义的。

例如，如果您有这样的表：

```
col1 col2
---- ----
 1 1
 1 2
 2 1
 2 2
 2 3
 3 1

```

然后尝试像这样查询它：

```
SELECT DISTINCT col1 FROM [table] WHERE col2 > 2 ORDER BY col1, col2 
```

这没有任何意义，因为每行最终*可能*`col2`会有多个值。它应该使用哪个订单？当然，在这个查询中你知道结果不会是那样的，但是数据库服务器不能提前知道。

现在，你的情况有点不同。`order by`您将子句中的所有列都包含在子句中`select`，因此乍一看似乎它们都被分组了。但是，其中一些列包含在计算字段中。当您结合 distinct 执行此操作时，该`distinct`指令*只能*应用于计算的*最终结果*：它不再知道有关计算源的任何信息。

这意味着服务器并不真正知道它可以再依赖这些列。它知道它们被使用了，但它不知道计算操作是否会产生类似于我上面第一个简单示例的效果。

所以现在你需要做一些其他的事情来告诉服务器这些列可以用于排序。有几种方法可以做到这一点，但这种方法应该可以正常工作：

```
SELECT rsc.RadioServiceCodeId,
            rsc.RadioServiceCode + ' - ' + rsc.RadioService as RadioService
FROM sbi_l_radioservicecodes rsc
INNER JOIN sbi_l_radioservicecodegroups rscg 
    ON rsc.radioservicecodeid = rscg.radioservicecodeid
WHERE rscg.radioservicegroupid IN 
    (SELECT val FROM dbo.fnParseArray(@RadioServiceGroup,','))
    OR @RadioServiceGroup IS NULL  
GROUP BY rsc.RadioServiceCode,rsc.RadioServiceCodeId,rsc.RadioService
ORDER BY rsc.RadioServiceCode,rsc.RadioServiceCodeId,rsc.RadioService 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-05T16:13:07.777

尝试其中之一：

1.  使用列别名：

    按 RadioServiceCodeId、RadioService 排序

2.  使用列位置：

    按 1,2 订购

您只能按实际出现在 DISTINCT 查询结果中的列进行排序 - 基础数据不可用于排序。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-05T17:15:16.513

Distinct 和 Group By 通常出于不同的目的做同样的事情......它们都根据被分组的列（或在 Select Distinct 子句中选择的列）在内存中创建一个“工作”表 - 然后填充它工作表作为查询读取数据，仅在值表明需要时添加新的“行”...

唯一的区别是，在 Group By 中，工作表中有额外的“列”，用于任何计算的聚合字段，如 Sum()、Count()、Avg() 等，需要为读取的每个原始行更新。Distinct 不必这样做......在特殊情况下，您 Group By 只是为了获得不同的值，（并且输出中没有聚合列），那么它可能是完全相同的查询计划......它查看这两个选项的查询执行计划并看看它做了什么会很有趣......

如果您正在这样做，当然 Distinct 是提高可读性的方法（当您的目的是消除重复行，并且您没有计算任何聚合列时）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-02T10:59:14.877

当您定义连接时，如果您想在新列上使用 ALIAS 并结合 DISTINCT **Some Ex 和 sql 2008进行排序，则需要对新列使用 ALIAS**

```
--this works 

    SELECT DISTINCT (c.FirstName + ' ' + c.LastName) as FullName 
    from SalesLT.Customer c 
    order by FullName

--this works too

    SELECT DISTINCT (c.FirstName + ' ' + c.LastName) 
    from SalesLT.Customer c 
    order by 1

-- this doesn't 

    SELECT DISTINCT (c.FirstName + ' ' + c.LastName) as FullName 
    from SalesLT.Customer c 
    order by c.FirstName, c.LastName

-- the problem the DISTINCT needs an order on the new concatenated column, here I order on the singular column
-- this works

    SELECT DISTINCT (c.FirstName + ' ' + c.LastName) 
        as FullName, CustomerID 
        from SalesLT.Customer c 

order by 1, CustomerID

-- this doesn't

    SELECT DISTINCT (c.FirstName + ' ' + c.LastName) as FullName 
     from SalesLT.Customer c 
      order by 1, CustomerID 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-11-10T10:21:34.307

您可以尝试子查询：

```
SELECT DISTINCT TEST.* FROM (
    SELECT rsc.RadioServiceCodeId,
        rsc.RadioServiceCode + ' - ' + rsc.RadioService as RadioService
    FROM sbi_l_radioservicecodes rsc
       INNER JOIN sbi_l_radioservicecodegroups rscg ON  rsc.radioservicecodeid = rscg.radioservicecodeid
    WHERE rscg.radioservicegroupid IN 
       (select val from dbo.fnParseArray(@RadioServiceGroup,','))
        OR @RadioServiceGroup IS NULL  
    ORDER BY rsc.RadioServiceCode,rsc.RadioServiceCodeId,rsc.RadioService
) as TEST 
```

# c# - .NET C# - 文本文件中的随机访问 - 没有简单的方法？

> ID：265639
> 
> 赞同：21
> 
> 时间：2008-11-05T16:10:44.413
> 
> 标签：c#, text, streamreader, random-access

我有一个文本文件，其中包含多个“记录”。每条记录都包含一个名称和一组数字作为数据。

我正在尝试构建一个将读取文件的类，仅显示所有记录的名称，然后允许用户选择他/她想要的记录数据。

第一次浏览文件时，我只读取标题名称，但我可以跟踪文件中标题所在的“位置”。在用户请求后，我需要随机访问文本文件以查找每条记录的开头。

我必须这样做，因为文件太大而无法在内存（1GB+）中完全读入应用程序的其他内存需求。

我尝试使用 .NET StreamReader 类来完成此操作（它提供了非常易于使用的“ReadLine”功能，但无法捕获文件的真实位置（BaseStream 属性中的位置由于缓冲类使用）。

在 .NET 中没有简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-28T15:34:06.503

提供了一些很好的答案，但我找不到一些可以在我非常简单的情况下工作的源代码。就在这里，希望它可以节省其他人我花在搜索上的时间。

我所指的“非常简单的情况”是：文本编码是固定宽度的，并且整个文件的行尾字符都是相同的。这段代码在我的情况下运行良好（我正在解析一个日志文件，有时我必须在文件中寻找，然后再回来。我实现了足够做我需要做的事情（例如：只有一个构造函数，并且只覆盖 ReadLine())，所以很可能你需要添加代码......但我认为这是一个合理的起点。

```
public class PositionableStreamReader : StreamReader
{
    public PositionableStreamReader(string path)
        :base(path)
        {}

    private int myLineEndingCharacterLength = Environment.NewLine.Length;
    public int LineEndingCharacterLength
    {
        get { return myLineEndingCharacterLength; }
        set { myLineEndingCharacterLength = value; }
    }

    public override string ReadLine()
    {
        string line = base.ReadLine();
        if (null != line)
            myStreamPosition += line.Length + myLineEndingCharacterLength;
        return line;
    }

    private long myStreamPosition = 0;
    public long Position
    {
        get { return myStreamPosition; }
        set
        {
            myStreamPosition = value;
            this.BaseStream.Position = value;
            this.DiscardBufferedData();
        }
    }
} 
```

下面是一个如何使用 PositionableStreamReader 的示例：

```
PositionableStreamReader sr = new PositionableStreamReader("somepath.txt");

// read some lines
while (something)
    sr.ReadLine();

// bookmark the current position
long streamPosition = sr.Position;

// read some lines
while (something)
    sr.ReadLine();

// go back to the bookmarked position
sr.Position = streamPosition;

// read some lines
while (something)
    sr.ReadLine(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-05T16:15:33.140

FileStream 有 seek() 方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-05T22:58:08.193

如果您对数据文件的编写方式很灵活，并且不介意它对文本编辑器不太友好，您可以使用 BinaryWriter 编写记录：

```
using (BinaryWriter writer = 
    new BinaryWriter(File.Open("data.txt", FileMode.Create)))
{
    writer.Write("one,1,1,1,1");
    writer.Write("two,2,2,2,2");
    writer.Write("three,3,3,3,3");
} 
```

然后，最初读取每条记录很简单，因为您可以使用 BinaryReader 的 ReadString 方法：

```
using (BinaryReader reader = new BinaryReader(File.OpenRead("data.txt")))
{
    string line = null;
    long position = reader.BaseStream.Position;
    while (reader.PeekChar() > -1)
    {
        line = reader.ReadString();

        //parse the name out of the line here...

        Console.WriteLine("{0},{1}", position, line);
        position = reader.BaseStream.Position;
    }
} 
```

BinaryReader 没有缓冲，因此您可以获得适当的位置以供以后存储和使用。唯一的麻烦是将名称解析出来，无论如何您可能都必须使用 StreamReader。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-05T16:15:17.960

您可以使用 System.IO.FileStream 而不是 StreamReader。如果您确切知道包含什么文件（例如编码），您可以像使用 StreamReader 一样进行所有操作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T16:16:00.237

编码是固定大小的（例如 ASCII 或 UCS-2）吗？如果是这样，您可以跟踪字符索引（基于您看到的字符数）并根据它找到二进制索引。

否则，不 - 您基本上需要编写自己的 StreamReader 实现，它可以让您查看二进制索引。很遗憾 StreamReader 没有实现这一点，我同意。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T17:04:17.863

我认为 FileHelpers 库运行时记录功能可能会对您有所帮助。[http://filehelpers.sourceforge.net/runtime_classes.html](http://filehelpers.sourceforge.net/runtime_classes.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-29T13:57:20.130

一些可能感兴趣的项目。

1）如果行是长度固定的字符集，如果字符集具有可变大小（如 UTF-8），则这不是必要的有用信息。所以检查你的字符集。

2）您可以通过使用 BaseStream.Position 值从 StreamReader 确定文件光标的确切位置，**如果**您首先 Flush() 缓冲区（这将强制当前位置成为下一次读取将开始的位置 - 最后一个字节后字节读取）。

3）如果您事先知道每条记录的确切长度将是相同的字符数，并且字符集使用固定宽度的字符（因此每行的字节数相同），您可以使用 FileStream 与固定缓冲区大小以匹配行的大小，并且每次读取结束时光标的位置将是下一行的开始。

4）如果行的长度相同（假设在此处以字节为单位），您是否不简单地使用行号并根据行大小 x 行号计算文件中的字节偏移量，是否有任何特殊原因？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-05T17:44:43.053

This exact question was asked in 2006 here: [http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework/topic40275.aspx](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework/topic40275.aspx)

Summary:

"The problem is that the StreamReader buffers data, so the value returned in BaseStream.Position property is always ahead of the actual processed line."

However, "if the file is encoded in a text encoding which is fixed-width, you could keep track of how much text has been read and multiply that by the width"

and if not, you can just use the FileStream and read a char at a time and then the BaseStream.Position property should be correct

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-05T16:15:24.717

您确定文件“太大”吗？您是否尝试过这种方式并引起了问题？

如果您分配了大量内存，而您现在没有使用它，Windows 只会将其换出到磁盘。因此，通过从“内存”访问它，您将完成您想要的——随机访问磁盘上的文件。

# asp.net - 线程单选按钮列表

> ID：265644
> 
> 赞同：0
> 
> 时间：2008-11-05T16:12:21.103
> 
> 标签：asp.net, radio-button

What is the best way to build a dynamic *Threaded* ASP.net radio button list? I am not that familiar with `RadioButtonLists` and it is my understanding that ASP.net doesn't like the application of individual styling of `ListItems`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T16:16:21.780

那么，为什么不使用`RadioButtonList`控件，使用`ReapeatDirection="Horizontal"`?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-26T16:32:35.767

像分层和标签格式的线程？如果您正在寻找这种功能，您将不得不构建一个自定义控件；开箱即用并不容易。不幸的是，列表控件并不是开箱即用的最佳控件。

# c++ - 路径和 CreateProcess

> ID：265650
> 
> 赞同：2
> 
> 时间：2008-11-05T16:14:43.313
> 
> 标签：c++, winapi

我对滥用 CreateProcess 的症状有疑问。我正在使用 lpcommandline 参数来提供我的可执行文件和参数的路径。我的误用是我没有用引号包围 exe 的路径。

我的问题是，为什么 CreateProcess 在大多数计算机上都可以正常工作，而在其他计算机上却不行？我知道该路径在大多数情况下都会有空间，但在 90% 的 XP 机器上它可以工作。我当然在那些没有发现的那 10% 上发现了我的问题。但我想知道它不起作用的机器上有什么不同？有没有你们任何人都知道的设置或政策。是的，我要解决报价问题。只是好奇为什么这样的事情不会一败涂地。

因此代码如下所示，szCommandLine 参数如下所示。注意 exe 的路径周围没有引号。

"C:\Program Files\My Company\doit.exe 参数 1 参数 2"

```
CreateProcess(
    NULL,           
    szCommandLine,  
    NULL,           
    NULL,           
    FALSE,          
    NULL, 
    NULL,  
    NULL,           
    &si,            
    &pi ) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-21T07:27:43.567

正如 Martin York 链接到的文档所暗示的那样， CreateProcess() 具有一些与预长名称程序向后兼容的行为。

"c:\program files\sub dir\program name arg1 arg2" 将查找：

> ```
> "c:\program.exe" files\sub dir\program name arg1 arg2
> "c:\program files\sub.exe" dir\program name arg1 arg2
> "c:\program files\sub dir\program.exe" name arg1 arg2
> "c:\program files\sub dir\program name.exe" arg1 arg2 
> ```

因此，如果存在这些文件中的任何一个，Windows 将调用它们，而不是您的程序。另外，我假设如果您没有读取这些可能匹配项所在的任何文件夹的权限，则 CreateProcess() 可能会立即失败，而不是检查您是否已读取以后可能的匹配项。（默认情况下，Windows 仅检查最终文件夹的读取访问权限。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T16:58:32.973

您应该阅读此页面：http:
[//msdn.microsoft.com/en-us/library/ms682425.aspx](http://msdn.microsoft.com/en-us/library/ms682425.aspx)

*   如果应用程序名称为 NULL（第一个参数）。

*   它使用命令行中第一个空格分隔的单词（第二个参数）作为应用程序名称。

*   如果应用程序名称包含空格，则必须用引号引起来。

再一次，代码值一百万字：
它看起来像这样吗：

```
char commandline[] = "C:\Program Files\My Company\doit.exe parameter1 parameter2";
CreateProcess(NULL,commandline, .... ); 
```

还是您在某处生成路径名？
请记住，通用问题只会为您提供通用答案。
在获得关于为什么会有太多猜测的具体答案之前，您必须具体说明。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-17T14:31:10.187

我只是在同一个问题上挣扎了很长一段时间。因此，即使这个问题是很久以前提出的，只是为了记录，这就是我的问题所在：

如果命令行未引用且包含空格，则 CreateProcess 将尝试解决 Simon 的回答中描述的歧义。如果空格字符之前的任何测试部分也解析为没有扩展名或扩展名为 .exe 的现有文件，则将使用此文件而不是预期的完整路径。

例子：

```
char cmdline[] = "C:\Program Files\App One\bin\app.exe param1 param2";
CreateProcess(NULL, cmdline, ...); 
```

不幸的是，在我的例子中，实际上有一个名为“C:\Program Files\App”（无扩展名）的现有文件。CreateProcess 找到了这个文件，假设它是一个没有 .exe 扩展名的可执行文件并试图执行它。结果：错误 193“%1 不是有效的 Win32 应用程序”。

底线：使用引号甚至更好，使用 CreateProcess 的第一个参数，或者去寻找任何其他可能匹配部分违规路径的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T21:59:10.513

诊断此类问题的一个好方法是内置到您的应用程序错误和报告机制中。这对很多目的都有帮助——主要是针对您自己可能永远看不到的错误，以及一些用户可能只是忽略而不向您报告的错误。这样，您可以在调用命令并发生故障时诊断这些参数是什么。

此外，您可以尝试进一步探索 MSDN 站点以及与此方法相关的高级功能。你把它们中的大部分都留了空。通过探索这些扩展功能，您将学习并且也许能够自己找出可能存在这种差异的原因。

另一个通用答案，但我希望这可以帮助您评估您的特定情况。

# uml - 用例关系

> ID：265657
> 
> 赞同：0
> 
> 时间：2008-11-05T16:15:39.927
> 
> 标签：uml, use-case

两个用例可以同时扩展或包含彼此吗？A 扩展/包含 B 和 B 扩展/包含 A

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T16:20:07.857

我很确定答案是“不”。

您刚刚描述了鸡和蛋问题的数字等价物。

循环引用 [几乎] 总是坏事 (tm)。我知道它不可怕的唯一地方是在链表的上下文中，其中每个条目都有一个指向另一个自己类型的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T16:27:31.523

如果（A 包含/扩展 B，B 包含/扩展 A）则**A = B**

承认如果​​ A 扩展/包含 B 则 A **>=** B

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T16:52:25.950

这很少见，但在一般情况下，没有什么可以阻止用例相互包含/使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T16:55:58.330

答案是不。extend 和 include 是互斥关系类型。很可能用例被错误地分解/分离，或者您误解了扩展/包含关系定义，或两者兼而有之。

鉴于您发布的示例（仅供参考，您最好编辑问题而不是发布不回答原始问题的答案）我敢冒险 B 扩展 A 和 B 扩展 C，因为在两种情况下 A 和 C 额外维修（案例 B）可能会被识别。

或者，用例 A 和 C 可以有条件地包含用例 B

顺便说一下，我将其建模为 Work On Vehicle，它由 2 个用例、获取客户授权和服务车辆组成，后者包括任何类型的服务或维修，并且在开始工作之前需要前者的输出. “额外维修”的概念只是在车上工作的另一个例子。

但我不知道完整的业务背景，所以你的里程可能会有所不同;-)

编辑：你写了“但在这种情况下：工作正在进行中，在工作过程中需要进一步的授权”，但我不明白这有多重要。

第一步是消除关于包含和扩展的混淆。尝试完全独立地对每个用例进行建模，然后查看常见的内容以查看是否需要包含/扩展

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T16:35:09.323

以下是业务用例（业务建模）而非系统用例的情景： 用例 A：服务车辆 用例 B：授权额外维修 用例 C：维修车辆

在初始维修期间可以确定额外的维修。或者维修可以在服务期间被识别为新的维修，在这两种情况下，都需要客户授权？

A 扩展 B 和**B 扩展 C**（在服务期间确定的授权和维修开始）

**C 扩展 B** （维修期间确定的额外维修授权）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T16:25:47.423

看起来可能不会，但我相信如果你足够通用[和无用]，你可以做到。你有具体的例子吗？规则总是有例外的，我很想看到一个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-09T20:15:33.887

“是” - 检查规范。

我刚刚通读了 UML 规范部分的用例： [http](http://www.omg.org/spec/UML/2.1.2/Superstructure/PDF/) ://www.omg.org/spec/UML/2.1.2/Superstructure/PDF/ 没有任何规则可以阻止我这样做。许多人可能在概念上对此有疑问，但这没关系，因为您只是本能地尝试在逻辑上客观化或构造用例。用例是一种行为（或集合），不像类/“对象”。我们不是在谈论 Java 对象。

甚至在 Rational Software Modeler (IBM) 中也允许这种“循环引用”。

在实践中以及尝试将其映射到 Java 或其他对象语言时，它可能没有意义或令人困惑。

# xml - 通过 HTTPS 发送消息

> ID：265660
> 
> 赞同：1
> 
> 时间：2008-11-05T16:15:58.410
> 
> 标签：xml, messaging, xml-rpc

我即将开始一个项目，该项目需要通过 HTTPS 在几个服务器之间发送 XML 消息。一个简短的总结是这样的：我有一个客户端正在使用的应用程序，它将向中央服务器发送信息。该服务器会将这些 XML 消息传送到另一家公司的服务器。我还将从该服务器接收消息，并且需要将它们从中央服务器扇出到正确的客户端。我的假设是我可以编写一些页面来接收来自我的应用程序的消息，将它们发布到外部服务器，并从外部服务器接收消息，解析它们并相应地重定向它们。任何一方都可以发起通信。

我还没有决定使用哪种语言，最有可能的是 ASP.NET。

我正在寻找一些进一步的阅读材料，但由于我对术语不太熟悉，我很难找到它。有没有人有一些好的地方可以开始熟悉我想要完成的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T16:23:07.540

来自国外服务器的消息是否会立即回复您的消息？如果不是（任何一方都可以随时发起消息），请考虑让两端都实现 RESTful Web 服务 - XML 可以作为有效负载，并且 https 请求可以轻松支持。

由于调用 Web 服务只是一个 http 请求（可能是 POST，根据您的描述），因此对此有很好的语言/库支持。

见[http://en.wikipedia.org/wiki/Representational_State_Transfer](http://en.wikipedia.org/wiki/Representational_State_Transfer)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T16:24:57.397

你用什么语言写这个？

最初我会说研究 Web 服务，特别是 SOAP——它是 XML 驱动的，允许您序列化数据并跨应用程序和平台有效地发布（如果您有多个服务器/客户端平台）

根据您选择的语言，我会推荐[Asp.net webservices](http://msdn.microsoft.com/en-us/library/ms972326.aspx)，它非常适合轻松创建和使用 web 服务（特别是如果您使用 .Net 操作您的平台）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T16:22:20.333

我将从查看[Web 服务](http://en.wikipedia.org/wiki/Web_service)开始了解基本理论。然后，根据您使用的技术类型，我会挑选一本关于在其中创建 Web 服务的介绍书。

# visual-studio-2008 - VS 2008 上的 WSE 2.0 SP2

> ID：265665
> 
> 赞同：2
> 
> 时间：2008-11-05T16:16:10.797
> 
> 标签：visual-studio-2008, web-services, .net-3.5, wse

是否可以在 VS 2008 下使用 WSE 2.0 SP2？

我意识到加载项（生成代理类/配置）不兼容，但有解决方法（从 VS 2003 解决方案复制文件）。我们的网络服务是相对静态的，所以不会做太多的改变。

我们可能会在未来的某个日期迁移到 WCF，但目前只是小步走，并希望让我们现有的服务在所有 .NET 3.5 的优点下运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T17:16:25.810

您可能希望使用 WSE 2.0 SP3 而不是 SP2。原因如下：如果您关心（或为您的应用程序付费）Microsoft 支持服务，那么[SP3](http://www.microsoft.com/downloads/details.aspx?familyid=8070E1DE-22E1-4C78-AB9F-07A7FCF1B6AA&displaylang=en "SP3 文档")在 .NET 2.0 框架下得到支持。我认为 SP2 和 SP3 之间存在一些不兼容之处，但重要的是 Microsoft 特别声明 SP3 在 .NET 2.0 框架上受支持。请参阅 WSE 2.0 SP2[文档](http://www.microsoft.com/downloads/details.aspx?familyid=FC5F06C5-821F-41D3-A4FE-6C7B56423841&displaylang=en "SP2 文档")并注意它没有说支持 .NET 2.0。

看起来您想在 .NET 3.5 框架中转换/重写您的应用程序。.NET 2.0 和 .NET 3.5 都在同一个 CLR 2.0 下运行（是的，这很令人困惑：非常感谢 MS 市场营销！）所以您可能可以使用 .NET 3.5 应用程序运行 WSE 2.0 SP3。但同样，它不是受支持的配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T16:31:53.653

我已经能够在 VS2005/.NET 2.0 下毫无问题地使用 WSE2，但我不知道具体关于 2008 年的情况。我需要仅在 WSE2 中的 Dime 附件（Java Web 服务 - 呃.. 真令人头疼）。

为了获得 VS 中的功能，我实际上安装了 WSE3，然后只是将应用程序中引用的 dll 更改为 WebServices2 文件和所有 Imports (VB - using c#) 语句。在那之后，它就像一个魅力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T16:42:51.727

即使在我切换到 3.5 框架后，只要您像库一样使用 wse2，我在 Visual Studio 2008 上运行 wse2 就没有任何问题。但是正如您所说，插件工具不起作用。

# database - 如何在 Postgres 8.2 中打开 SQL 日志记录？

> ID：265666
> 
> 赞同：2
> 
> 时间：2008-11-05T16:16:14.777
> 
> 标签：database, postgresql

我的 postgres conf 中有以下设置：

log_destination = 'stderr'

redirect_stderr = on

log_directory = '/tmp/psqlog'

log_statement = '全部'

但是没有记录任何日志。我在这里想念什么？互联网上有一个名为“logging_collector”的变量的引用，但是当我尝试设置它时，postgres 在启动时以 FATAL: unknown 变量死亡。

这是在 MacOS 10.4 上。

塔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T16:24:42.950

我相信您需要将 log_destination 更改为“syslog”或特定目录。进入 stderr 的输出只会被丢弃。[这是文档页面的链接，但我会看看是否可以在http://www.postgresql.org/docs/8.2/static/runtime-config-logging.html](http://www.postgresql.org/docs/8.2/static/runtime-config-logging.html)的某个地方找到示例 postgresql.conf

[此邮件列表条目提供了有关使用 syslog http://archives.postgresql.org/pgsql-admin/2004-03/msg00381.php](http://archives.postgresql.org/pgsql-admin/2004-03/msg00381.php)设置日志记录的一些信息

此外，如果您从源代码构建 postgres，则使用[Fink](http://www.finkproject.org/)或[MacPorts](http://www.macports.org/)的 os x 包可能会更好。自己完成所有配置对于初学者来说可能会很棘手，但这些软件包通常会为您提供良好的工作基础。

# asp.net - 将word文档嵌入ASP.net页面并使用VBscript访问

> ID：265669
> 
> 赞同：2
> 
> 时间：2008-11-05T16:16:49.720
> 
> 标签：asp.net, vbscript, ms-word

我有一些代码可以在 ASP.net 页面上使用 VBScript 打开 word 文档：

```
set objWord = CreateObject("Word.Application")

objWord.Visible = True

objWord.Documents.Open "c:\inetpub\wwwroot\JSWordTest\test.doc", False, False, False 
```

这很好用，但会在另一个窗口中打开 word doc。理想情况下，我想让它看起来好像包含在当前页面中，或者在 IFrame 中。我还有一些其他按钮可以在单击时将文本粘贴到 word 文档中。

我不能只将 iframe 的 src 设置为 word 文档，因为需要对 word 文档 (objWord) 的引用以允许我使用 Vbscript 再次将文本实时粘贴到其中。

不确定这是否可行，但欢迎提出任何想法/替代方案？

要求：word doc 需要在浏览器中显示

在 word 文档的一侧会有一些按钮，点击这些按钮会将文本粘贴到其中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T23:19:58.273

您可以使用此技术获取 Word 文档的内容，而无需显示任何窗口。

```
' Declare an object for the word application '
Set objWord = CreateObject("Word.Application")

objWord.Visible = False                 ' Don''t show word '
objWord.Documents.open("C:\test.doc")   ' Open document '
objWord.Selection.WholeStory            ' Select everything in the doc '
strText = objWord.Selection.Text        ' Assign document contents to var'
objWord.Quit False                      ' Close Word, don't save ' 
```

一旦你在变量中获得了文档的内容，你就可以用它做你想做的事情，只要用 document.write 或任何你想使用的方法写出来。

您可以在此处找到有关 MS Word 应用程序对象及其方法的更多详细信息：http: [//msdn.microsoft.com/en-us/library/aa221371 (office.11​​).aspx](http://msdn.microsoft.com/en-us/library/aa221371(office.11).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-17T10:27:35.543

如果可以选择在客户端计算机上安装 ActiveX 组件，您可以尝试[EDraw Office Viewer 组件](http://www.officeocx.com/)或更便宜的[Ultra Office Control](http://www.ultrashareware.com/Ultra-Office-Control.htm)。两者都基于 Microsoft 的 DSOFramer 示例，并提供了与文档交互的类似方法。

给出了示例代码并显示了如何触发对话框、插入文本等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-04T12:14:45.677

您*可以*尝试保存为 HTML 格式

```
Const wdFormatHTML = 8

dim doc
set doc = objWord.Documents.open("C:\test.doc")
doc.SaveAs "doc.htm", wdFormatHTML 

' etc ... 
```

然后将其用作 iframe 文档的来源。请记住，当保存为 HTML 格式时，Word 会创建一个相应的资源文件夹（用于图像等），因此您可能需要考虑到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-10T08:49:37.463

您可以从[Excel Viewer](https://excelviewer.codeplex.com/)组件中获得灵感。它类似于 EDraw Office Viewer，但免费且开源。目前，它只打开办公文档，但您可以轻松地将其更改为使用 Word。

# eclipse - Subversion：一次标记并提交修改过的文件

> ID：265679
> 
> 赞同：2
> 
> 时间：2008-11-05T16:20:49.867
> 
> 标签：eclipse, svn, tags, commit

我想在 Eclipse 中做这样的事情：[http ://svn.collab.net/viewvc/svn?view=rev&revision=33845](http://svn.collab.net/viewvc/svn?view=rev&revision=33845)

我将 Subversive 0.7.5 与 Native JavaHL 1.5.3 (r33570) 连接器一起使用。

我试图在我想要标记的分支的工作副本中更改某些内容，并使用 Team -> Tag 创建一个标签...但我收到了错误消息：

> 某些选定资源的标记操作失败。
> 
> 此操作需要版本控制下的路径

我只尝试了一个标签名称和一个具有完整存储库路径的标签名称。两者都导致相同的错误。这是我得到的错误：

```
*** Tag
svn copy "C:/workspace/some_branch" "http://server:8080/svn/project/tags/TagWithChange" -r WORKING -m "TagWithChange" --username "masi"
A path under version control is needed for this operation 
```

是否可以在 Eclipse 中实现？

你会如何从命令行做这样的事情？看我自己的答案。

虽然如果我在命令行中使用以下内容，我会收到错误消息：

```
svn copy "C:/workspace/some_branch" "http://server:8080/svn/project/tags/TagWithChange" -r WORKING -m "TagWithChange" --username "masi" 
```

错误：

> svn：修订参数“工作”中的语法错误

我正在使用 svn 客户端 1.5.4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T16:25:29.110

自己找到了命令行答案：http: [//svnbook.red-bean.com/en/1.4/svn.branchmerge.tags.html](http://svnbook.red-bean.com/en/1.4/svn.branchmerge.tags.html)

```
svn copy some_branch http://server:8080/svn/tags/TagWithChange -m"TagWithChange" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T23:53:15.023

我在使用 Native JavaHL 时发现了同样的错误。你可以做两件事来制作你的标签。

## A. SVN Respository Exploring Perspective 的标签

**SVN 存储库视图**

1.  右键单击要标记的树干，新建 -> 标记。

* * *

## B. 更新 SVN 连接器

**SVN 套件 (SVN/1.5.5 SVNKit/1.2.2 ( [http://svnkit.com/](http://svnkit.com/) ) r5428)**

1.  通过软件更新安装 SVN Kit。

2.  窗口 -> 首选项 -> 团队 -> SVN -> SVN 连接器 -> SVN 连接器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T16:27:55.580

我一直在 Eclipse 中使用 Subclipse [http://subclipse.tigris.org/](http://subclipse.tigris.org/) - 它非常好，我认为所有其他插件的基准测试都来自于此。

自从我使用该特定设置以来已经有一段时间了，但是 subclipse 会自动添加一个新的（非版本化文件 - 一个尚未“版本化”或尚未放入存储库的文件），这意味着您不应该得到错误。

# aop - AspectJ：切入点中的参数

> ID：265680
> 
> 赞同：6
> 
> 时间：2008-11-05T16:21:27.713
> 
> 标签：aop, aspectj

我正在使用 AspectJ 来建议所有具有所选类参数的公共方法。我尝试了以下方法：

```
pointcut permissionCheckMethods(Session sess) : 
    (execution(public * *(.., Session)) && args(*, sess)); 
```

这对于具有至少 2 个参数的方法非常有效：

```
public void delete(Object item, Session currentSession); 
```

但它不适用于以下方法：

```
public List listAll(Session currentSession); 
```

如何更改我的切入点以建议两种方法执行？换句话说：我希望“..”通配符代表“零个或多个参数”，但看起来它的意思是“一个或多个”......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-26T11:37:26.930

哦，好吧...我用这个讨厌的技巧解决了这个问题。仍在等待某人以“官方”切入点定义出现。

```
pointcut permissionCheckMethods(EhealthSession eheSess) : 
    (execution(public * *(.., EhealthSession)) && args(*, eheSess))
    && !within(it.___.security.PermissionsCheck);

pointcut permissionCheckMethods2(EhealthSession eheSess) : 
    (execution(public * *(EhealthSession)) && args(eheSess))
    && !within(it.___.security.PermissionsCheck)
    && !within(it.___.app.impl.EhealthApplicationImpl);

before(EhealthSession eheSess) throws AuthorizationException : permissionCheckMethods(eheSess)
{
    Signature sig = thisJoinPointStaticPart.getSignature(); 
    check(eheSess, sig);
}

before(EhealthSession eheSess) throws AuthorizationException : permissionCheckMethods2(eheSess)
{
    Signature sig = thisJoinPointStaticPart.getSignature(); 
    check(eheSess, sig);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-10T09:06:42.637

怎么样：

```
pointcut permissionCheckMethods(Session sess) : 
(execution(public * *(..)) && args(.., sess)); 
```

如果最后一个（或唯一一个）参数是 Session 类型，我想这将匹配。通过交换 args 的位置，您还可以首先匹配或仅匹配。但我不知道是否可以匹配任意位置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-09T11:43:42.120

我无法为您扩展 AspectJ 语法，但我可以提供一种解决方法。但首先让我解释一下为什么不能用切入点中的定义来做你想做的事`args`：因为如果你要`EhealthSession`在方法签名中的任何地方匹配你的参数，AspectJ 应该如何处理签名包含该类的多个参数的情况? 的含义`eheSess`将是模棱两可的。

现在解决方法：它可能会更慢 - 多少取决于您的环境，只需测试它 - 但您可以让切入点匹配所有潜在方法，而不管它们的参数列表如何，然后让建议通过检查参数找到您需要的参数列表：

```
pointcut permissionCheckMethods() : execution(public * *(..));

before() throws AuthorizationException : permissionCheckMethods() {
    for (Object arg : thisJoinPoint.getArgs()) {
        if (arg instanceof EhealthSession)
            check(arg, thisJoinPointStaticPart.getSignature());
    }
} 
```

`within(SomeBaseClass+)`PS：也许您可以通过或`within(*Postfix)`或或或来缩小焦点，`within(com.company.package..*)`以免将建议应用于整个宇宙。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-05-01T17:04:53.537

您必须在结尾和开头使用 .. （双点），如下所示：

```
pointcut permissionCheckMethods(Session sess) : 
    (execution(public * *(.., Session , ..)) ); 
```

还要摆脱，`&& args(*, sess)`因为这意味着您希望仅捕获具有任何类型的第一个参数但`sess`作为第二个参数且不超过 2 个参数的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-13T14:15:11.160

```
@Before(value = "execution(public * *(.., org.springframework.data.domain.Pageable , ..))")
private void isMethodPageable () {
    log.info("in a Aspect point cut isPageableParameterAvailable()");
} 
```

# asp.net - 如何判断一个方法是否在 UpdatePanel 回发中运行？

> ID：265686
> 
> 赞同：19
> 
> 时间：2008-11-05T16:23:39.863
> 
> 标签：asp.net, asp.net-ajax, updatepanel, scriptmanager

如何判断一个方法是否在 AJAX 回发的上下文中运行（即作为 UpdatePanel（异步）回发的结果）？

根据[egoldin](http://msmvps.com/blogs/egoldin/archive/2008/05/21/how-to-tell-the-page-is-in-ajax-call.aspx) Page.IsAsync 是一个非常常见的混淆，它与 AJAX 完全无关。

正确的方法是使用 ScriptManager.GetCurrent ( Page ).IsInAsyncPostBack。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-05T16:28:49.867

使用 ScriptManager.GetCurrent ( Page ).IsInAsyncPostBack

# python - 为什么使用全局解释器锁？

> ID：265687
> 
> 赞同：90
> 
> 时间：2008-11-05T16:23:48.067
> 
> 标签：python, multithreading, scripting, locking, bytecode

Python的全局解释器锁的作用究竟是什么？编译为字节码的其他语言是否采用类似的机制？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-11-05T16:44:11.460

一般来说，对于任何线程安全问题，您都需要使用锁来保护您的内部数据结构。这可以通过各种级别的粒度来完成。

*   您可以使用细粒度锁定，其中每个单独的结构都有自己的锁定。

*   您可以使用粗粒度锁定，其中一个锁可以保护所有内容（GIL 方法）。

每种方法都有各种优点和缺点。细粒度锁定允许更大的并行性——两个线程在不共享任何资源时可以并行执行。但是，管理开销要大得多。对于每一行代码，您可能需要获取和释放多个锁。

粗粒度方法则相反。两个线程不能同时运行，但是一个单独的线程会运行得更快，因为它没有做太多的簿记。最终归结为单线程速度和并行性之间的权衡。

已经有一些尝试在 python 中删除 GIL，但是单线程机器的额外开销通常太大。由于锁争用，即使在多处理器机器上，某些情况实际上也会变慢。

> 编译为字节码的其他语言是否采用类似的机制？

它各不相同，它可能不应该被视为一种语言属性，而是一种实现属性。例如，有一些 Python 实现，如 Jython 和 IronPython，它们使用底层 VM 的线程方法，而不是 GIL 方法。此外，Ruby 的下一个版本似乎正[朝着](http://www.infoq.com/news/2007/05/ruby-threading-futures)引入 GIL 的方向发展。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-11-05T16:32:37.083

以下来自[官方 Python/C API 参考手册](http://www.python.org/doc/2.5.2/api/threads.html)：

> Python 解释器不是完全线程安全的。为了支持多线程 Python 程序，当前线程必须持有全局锁才能安全地访问 Python 对象。如果没有锁，即使是最简单的操作也可能在多线程程序中引起问题：例如，当两个线程同时增加同一个对象的引用计数时，引用计数最终可能只增加一次而不是两次。
> 
> 因此，存在只有获得全局解释器锁的线程才能对 Python 对象进行操作或调用 Python/C API 函数的规则。为了支持多线程 Python 程序，解释器定期释放和重新获取锁——默认情况下，每 100 个字节码指令（可以使用 sys.setcheckinterval() 更改）。锁也会在可能阻塞的 I/O 操作（如读取或写入文件）周围被释放和重新获取，以便其他线程可以在请求 I/O 的线程等待 I/O 操作完成时运行。

我认为它很好地概括了这个问题。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-11-05T16:32:50.077

全局解释器锁是一个大的互斥锁，可以防止引用计数器被占用。如果您正在编写纯 Python 代码，这一切都发生在幕后，但如果您将 Python 嵌入到 C 中，那么您可能必须显式地获取/释放锁。

此机制与将 Python 编译为字节码无关。Java 不需要它。事实上，[Jython](http://www.jython.org/)（python 编译成 jvm）甚至不需要它。

另见[这个问题](https://stackoverflow.com/questions/105095/are-locks-unnecessary-in-multi-threaded-python-code-because-of-the-gil)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-05T18:18:32.937

Python 和 perl 5 一样，从一开始就不是为了线程安全而设计的。线程是在事后嫁接的，因此全局解释器锁用于保持互斥，即在给定时间只有一个线程在解释器内部执行代码。

各个 Python 线程由解释器本身通过不时地循环锁来协同处理多任务。

当您从 C 语言与 Python 对话时，当其他 Python 线程处于活动状态以“选择加入”该协议并确保没有任何不安全的事情发生在您背后时，您需要自己抓住锁。

其他具有单线程遗产但后来演变为多线程系统的系统通常具有这种机制。例如，Linux 内核在其早期的 SMP 时代就有“大内核锁”。随着多线程性能逐渐成为一个问题，人们倾向于尝试将这些类型的锁分解成更小的部分，或者在可能的情况下用无锁算法和数据结构替换它们，以最大限度地提高吞吐量。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-05T16:35:11.743

关于您的第二个问题，并非所有脚本语言都使用它，但这只会降低它们的功能。例如，Ruby 中的线程是[绿色](http://en.wikipedia.org/wiki/Green_threads)的而不是原生的。

在 Python 中，线程是原生的，GIL 只会阻止它们在不同的内核上运行。

在 Perl 中，线程甚至更糟。它们只是复制整个解释器，远不如在 Python 中那样可用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-05T20:02:27.907

也许BDFL 的[这篇文章会有所帮助。](http://www.artima.com/weblogs/viewpost.jsp?thread=214235)

# oracle - 最好的 4 类 Oracle JDBC 驱动程序是什么？

> ID：265690
> 
> 赞同：3
> 
> 时间：2008-11-05T16:24:10.720
> 
> 标签：oracle, jdbc

最好的 4 类 Oracle JDBC 驱动程序是什么？

我想要的是：

*   稳定，bug少，修复快
*   应该警告常见的 JDBC 陷阱（连接泄漏等）
*   必须支持 CLOB

[编辑] 我对“免费”Oracle Type 4 驱动程序的主要问题是：

*   我花了两周时间寻找 CLOB 支持代码中的游标泄漏（关闭流不会关闭底层游标）
*   从 ResultSet 中获取值时，必须按顺序处理它们（因此在获取第 4 列后无法再获取第 3 列）
*   结果集上的 getMetaData() 直到获取第一行后才起作用。
*   还有许多其他错误和缺陷，但我不再记得它们了。

所以总而言之，一个每个座位花费​​我 1,000 美元的司机比甲骨文的“免费”司机更“便宜”。该驱动程序唯一的好处是我不必将数据库放入 TNSNAMES 中，并且我可以使用单个驱动程序访问 Oracle 8、9 和 10。这就是我问的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T16:32:49.843

Oracle 的 type 4 JDBC 驱动程序非常好。显然，与任何软件一样，存在错误，但它们通常还不错。而且价格（免费）无法被击败。

如果您正在寻找第三方商业驱动程序，我一直在这个领域对 DataDirect 产品有很好的体验。我通常不会费心为 4 类 JDBC 驱动程序授权，但如果您有特别高端的要求，这可能是值得的。

# windows-mobile - 从两个 WinMo 不同的应用程序打开同一个 .sdf 数据库文件是否安全？

> ID：265691
> 
> 赞同：1
> 
> 时间：2008-11-05T16:24:11.907
> 
> 标签：windows-mobile, sql-server-mobile

我有两个使用相同 MS SQL Server Mobile 数据库的 Windows Mobile 6.1 应用程序。他们可能会同时选择和更新数据库中的数据。数据库保存在一个 .sdf 文件中。

我不知道 MS SQL 移动版是如何工作的。应用程序加载以下 sql 库：sqlceoledb30.dll、SQLCEER30EN.DLL、sqlcese30.dll 和 sqlceqp30.dll。

**这样做安全吗？**

我怀疑上述 dll 允许一个应用程序使用存储在 .sdf 中的数据库，但没有单独的 SQL 进程允许多个应用程序/进程使用同一个数据库。

更新：似乎只有 SQL CE 3.5 支持该功能。这是一个相关的[问题](https://stackoverflow.com/questions/240463/what-is-the-number-of-maximum-concurrent-connections-for-sql-ce-35)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T17:31:24.593

这里的问题*不是*事务支持，而是并发连接支持。SQL CE 3.5 之前的版本不支持到同一个数据库文件的多个连接。例如，现在在 3.1 中，没有任何东西强制执行此限制，如果您这样做，您可能会得到一些奇怪的行为。SQL CE 3.5 添加了对单个数据文件的多个跨进程连接的支持。

# windows - Windows 性能计数器限制

> ID：265696
> 
> 赞同：3
> 
> 时间：2008-11-05T16:25:09.673
> 
> 标签：windows, performancecounter

可以发布到自定义 Windows 性能计数器类别的数据量存在哪些限制？

我知道计数器的数量或实例的数量没有硬性限制，而是整个类别都有内存限制。那限制是多少？

所有性能计数器类别的总数或大小是否有限制？在处理需要发布的相对大量的数据时，还应该考虑什么？

从这个角度来看，我需要发布大约 50,000 个 32 位反实例值。我可以根据存在的限制以各种方式将它们分成几类。

我很欣赏性能计数器可能不是最好的解决方案，但这种疯狂是有原因的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T06:23:11.977

什么情况下需要发布数万个计数器。

请记住，读取这些性能计数器的工具通常不是为如此庞大的数据集设计的（尽管它们可能是）。因此，虽然您能够创作这样的数据集，但读取您的数据的工具可能会以“有趣”的方式失败。

您可能需要重新考虑收集如此多数据的需要。您*真的*需要 50,000 个 perf 计数器吗？收集信息后，您将如何处理这些信息？你真的能够从 50,000 个计数器中收集到有意义的信息吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T07:46:41.137

但实际上有限制吗？我以为你基本上只是发布了一块共享内存——为什么不增加块的大小呢？是什么让你觉得有限制？

# c - 从全局结构中读取时是否需要信号量？

> ID：265708
> 
> 赞同：10
> 
> 时间：2008-11-05T16:27:58.620
> 
> 标签：c, multithreading, global-variables, mutex, semaphore

一个相当基本的问题，但我没有看到它在任何地方被问到。

假设我们有一个全局结构（在 C 中），如下所示：

```
struct foo {
  int written_frequently1;
  int read_only;
  int written_frequently2;
}; 
```

我似乎很清楚，如果我们有很多线程读写，我们需要一个信号量（或其他锁）在`written_frequently`成员上，即使是读取，因为我们不能 100% 确定这个结构的分配是原子的.

如果我们想要很多线程来读取`read_only`成员，而没有线程来写入，那么我们是否需要在结构访问上设置一个信号量来读取？

（我倾向于说不，因为不断更改之前和之后的位置这一事实不应该影响`read_only`成员，并且读取该值的多个线程不应该相互干扰。但我不确定。 )

* * *

[编辑：我现在意识到我应该更好地问这个问题，以便*非常具体*地澄清我的意思。当然，当我第一次问这个问题时，我并没有真正理解所涉及的所有问题。当然，如果我现在全面编辑问题，我会毁掉所有这些好答案。我的意思更像是：

```
struct bar {
  char written_frequently1[LONGISH_LEN];
  char read_only[LONGISH_LEN];
  char written_frequently2[LONGISH_LEN];
}; 
```

我问的主要问题是，由于这些数据是结构的一部分，它是否会受到其他结构成员的影响，是否会反过来影响它们？

事实上，成员是整数，因此写入可能是原子的，在这种情况下实际上只是一个红鲱鱼。]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T17:43:25.957

您需要一个互斥锁来保证操作是原子的。因此，在这种特殊情况下，您*可能根本不需要互斥锁。* 具体来说，如果每个线程写入*一个*元素*并且*写入是原子的*，并且*新值独立于*任何*元素（包括自身）的当前值，则没有问题。

**示例：**多个线程中的每一个都更新一个“last_updated_by”变量，该变量仅记录更新它的最后一个线程。显然，只要对变量本身进行原子更新，就不会出现错误。

* * *

但是，如果线程一次*读取或写入*多个元素，您*确实*需要一个互斥体来保证一致性，特别是因为您提到锁定一个*元素*而不是*整个结构*。

 *****示例：**线程更新结构的“日”、“月”和“年”元素。这必须以原子方式发生，以免另一个线程在“月”增量之后但在“日”换行到 1 之前读取结构，以避免诸如 2 月 31 日之类的日期。请注意，在读取时必须*遵守*互斥锁；否则您可能会读取错误的、半更新的值。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-05T16:30:46.727

如果 read_only 成员实际上是只读的，则没有数据被更改的危险，因此不需要同步。这可能是在线程启动之前设置的数据。

无论频率如何，您都需要对可以写入的任何数据进行同步。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-05T17:14:48.183

“只读”有点误导，因为变量在初始化时至少被写入一次。在这种情况下，如果初始写入和后续读取位于不同的线程中，您仍然需要在它们之间设置内存屏障，否则它们可能会看到未初始化的值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T04:11:24.973

## 读者也需要互斥锁！

似乎有一个普遍的误解，即互斥锁仅供编写者使用，而读者不需要它们。 **这是错误的，**并且这种误解是导致**极难诊断的错误的原因。**

## 这就是为什么，以示例的形式。

想象一个时钟每秒更新一次，代码如下：

```
if (++seconds > 59) {        // Was the time hh:mm:59?
   seconds = 0;              // Wrap seconds..
   if (++minutes > 59)  {    // ..and increment minutes.  Was it hh:59:59?
     minutes = 0;            // Wrap minutes..
     if (++hours > 23)       // ..and increment hours.  Was it 23:59:59?
        hours = 0;           // Wrap hours.
    }
} 
```

如果代码不受互斥体保护，则另一个线程可以在更新过程中读取`hours`、`minutes`和变量。`seconds`按照上面的代码：

```
[午夜前开始] 23:59:59
[WRITER 增加秒数] 23:59:60
【WRITER换秒】23:59:00
[WRITER 增加分钟数] 23:60:00
[WRITER 总结] 23:00:00
[WRITER 增加小时数] 24:00:00
[作家结束时间] 00:00:00

```

从第一次递增到*六步后*的最后一次操作，时间无效。如果读者在此期间检查时钟，它将看到一个不仅不正确而且*非法*的值。而且由于您的代码可能*依赖*于时钟而不直接*显示*时间，因此这是众所周知的难以追踪的“弹跳”错误的典型来源。

## 修复很简单。

用互斥锁包围时钟更新代码，并*创建一个读取器函数*，该函数*在互斥锁执行时也会锁定*它。现在读取器将等待更新完成，写入器不会在读取过程中更改值。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T16:35:41.163

不。

通常，您需要信号量来防止对资源的并发访问（`int`在本例中为）。但是，由于该`read_only`成员是只读的，因此在访问之间/期间它不会更改。请注意，它甚至不必是原子读取——如果没有任何变化，你总是安全的。

`read_only`你最初是如何设置的？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T16:30:30.427

如果所有线程都只是读取，则不需要信号量。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-17T12:09:02.603

您可能会喜欢阅读任何一篇关于[实用无锁编程](http://www.cl.cam.ac.uk/research/srg/netos/lock-free/)的论文，或者只是剖析和理解所提供的片段。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-05T16:31:33.777

我会将每个字段隐藏在函数调用后面。只写字段将有一个信号量。只读只返回值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-05T16:47:32.513

添加到以前的答案：

1.  在这种情况下，自然同步范式是互斥的，而不是信号量。
2.  我同意您在只读变量上不需要任何互斥锁。
3.  如果结构的读写部分具有一致性约束，则通常需要*一个*互斥体来处理*所有*这些，以保持操作的原子性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-27T10:59:49.097

非常感谢所有出色的回答者（以及所有出色的答案）。

总结一下：

如果结构中有一个只读成员（在我们的例子中，如果值被设置一次，早在任何线程可能想要读取它之前），那么读取这个成员的线程不需要锁、互斥锁、信号量或任何其他并发保护。

即使经常写入其他成员也是如此。不同的变量都是同一个结构的一部分这一事实没有区别。

# asp.net - 缺少导入语句。（VS2008 不再编译我的项目）

> ID：265715
> 
> 赞同：1
> 
> 时间：2008-11-05T16:29:45.187
> 
> 标签：asp.net, vb.net, visual-studio-2008

这可能是没有道理的，但......

我刚刚在 VS2008 中打开了一个解决方案，由于某种原因，编译器无法识别以前编译的错误。

我点击了构建，但出现了 100 多个错误：

`Name 'IIf' is not declared.
Name 'IsNumeric' is not declared.
Name HttpUtility is not declared`

ETC..

认为这一定与 VS2008 出错有关，因为它构建在我的同事机器上，并且某些文件自源代码控制以来没有更改。导入不在以前的版本中。

如何在不手动添加导入的情况下进行此构建？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T16:32:11.703

检查您的参考资料。如果你一直在乱搞，有时它们似乎会破裂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T16:34:27.610

这些似乎位于 VisualBasic 命名空间中。

右键单击 Project 选择 Properties-->References 尝试添加导入 Microsoft.VisualBasic。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T16:35:02.337

几乎可以肯定是参考。

Visual Studio 对这些很挑剔，如果将解决方案移动到另一个位置，可能会丢失引用。

除非您的解决方案很大（就像我的遗憾），否则您可以通过在每个项目的属性中提供参考路径来轻松解决此问题。

# asp.net - HTML 快照

> ID：265717
> 
> 赞同：2
> 
> 时间：2008-11-05T16:30:04.343
> 
> 标签：asp.net, html, youtube, snapshot

使用 asp.net，我需要生成 youtube 视频的快照。我可以访问 youtube 生成的用于将其视频集成到其他网站的代码。

基本上我想做的就是 HTML Snapshot 做的，拍一些 html 的照片，但我只对视频感兴趣。

我如何在 asp.net 中解决这个问题，（购买 HTML 快照不是一种选择）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T16:38:37.803

我相信这就是您正在寻找的：

[http://www.codegod.de/WebAppCodeGod/Screenshot-of-Webpage-with-ASP-NET-AID398.aspx](http://www.codegod.de/WebAppCodeGod/Screenshot-of-Webpage-with-ASP-NET-AID398.aspx)

它甚至有你需要的代码和一切。您显然必须对其进行修改以满足您的需求，但该站点提供了获取网站屏幕截图所需的基本代码。

如果您只想要视频的快照，则必须对其进行裁剪。由于视频图片总是在同一个地方，您可以简单地裁剪掉不需要的额外内容。[http://michael.sivers.co.uk/post/2007/08/Crop-and-resize-an-image-in-ASPNET.aspx](http://michael.sivers.co.uk/post/2007/08/Crop-and-resize-an-image-in-ASPNET.aspx)

# python - HTTP 请求超时

> ID：265720
> 
> 赞同：3
> 
> 时间：2008-11-05T16:30:22.843
> 
> 标签：python, http

在 Python 2.6 中，向 httplib.HTTPConnection 类添加了一个新的“超时”参数：http: [//docs.python.org/library/httplib.html#httplib.HTTPConnection](http://docs.python.org/library/httplib.html#httplib.HTTPConnection)

但是，这只是连接到服务器的超时。我希望为**请求**设置超时值，而不是连接。httplib 似乎不支持这一点。

有没有办法模仿这种行为？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-05T16:34:28.843

您可以设置全局套接字超时^((*))：

```
import socket

timeout = 10
socket.setdefaulttimeout(timeout) 
```

* * *

^((*)) **编辑**：正如评论中的人们正确指出的那样：这在技术上是正确的，但它仅对涉及单个套接字操作的任务具有可预测的结果。一个 HTTP 请求由多个套接字操作组成（例如 DNS 请求或其他可能从 HTTP 客户端抽象出来的东西）。因此，整个操作的超时变得不可预测。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T10:09:21.427

不，没有。

这是因为[HTTP 规范](http://www.greenbytes.de/tech/webdav/rfc2616.html)没有为客户端提供任何东西来指定 HTTP 请求的生存时间信息。正如您所提到的，您只能在 TCP 级别上执行此操作。

另一方面，服务器可以通过 HTTP 状态码[408 Request Timeout](http://www.greenbytes.de/tech/webdav/rfc2616.html#status.408) resp 通知客户端超时情况。[504 网关超时](http://www.greenbytes.de/tech/webdav/rfc2616.html#status.504)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-12-15T18:03:27.520

您还可以`settimeout`在连接的套接字上使用（适用于 Python 2.5）：

```
connection = HTTPConnection('slow.service.com')
connection.request(...)
connection.sock.settimeout(5.0)
response = connection.getresponse()
response.read()
connection.close() 
```

如果服务器无法在 5 秒内发送响应，`socket.error`则会引发 a。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-18T12:30:53.640

当您启动连接时，可以将超时值作为第三个参数提供。

```
connection = HTTPConnection(<IP of URL>, <port or None>, <timeout>)
... 
```

在几秒钟内是一个浮点数。

```
connection = HTTPConnection('slow.service.com', None, 20.0) 
```

# asp.net - ASP.NET 无法连接到 SQL Server 2005

> ID：265722
> 
> 赞同：0
> 
> 时间：2008-11-05T16:30:33.140
> 
> 标签：asp.net, sql-server, windows-authentication

我正在尝试创建一个与 SQL Server 2005 数据库（与 ASP 的服务器分开的服务器）有桥接连接的 ASP 页面。为此，我尝试使用 Windows 身份验证设置。我的名字对 SQL 服务器拥有完全权限，但我仍然收到错误消息“用户 COMPANY\name 登录失败”。要查看这是否只是 Windows 身份验证问题，我尝试进行 SQL Server 身份验证；这也不会让我登录。我不知道为什么 SQL 身份验证会出现问题，但我真的可以使用一些帮助来弄清楚为什么 Windows 身份验证不起作用。感谢您的时间。

问候，

佛朗哥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T17:05:39.527

您说，当您尝试使用 SQL 身份验证（我猜是 SQL Server 用户名和密码）登录 SQL Server 时，它没有让您进入。这意味着 SQL Server 端存在问题。确保您的 SQL Server 设置为混合模式身份验证。这意味着它应该能够让您使用 Windows 身份验证以及如果您提供 sql server 用户 ID 和密码。

那是一个指针。另一点正如大家所说，不要使用 Windows 身份验证从 ASP 页面连接到 SQL Server。为此，您需要将域用户设置为 SQL Server 用户。今天你是唯一一个使用这个页面的人，明天当你需要把这个页面提供给整个组织时怎么样？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T16:36:38.557

我假设它们在同一个域上（因为你提到了 COMPANY\name）？

确保 SQL Server 设置为允许远程连接。（服务和连接的表面区域配置）

如果您使用的是 Windows 身份验证，您是在尝试指定单个用户进行连接，还是使用了当前用户的身份？如果您希望指定单个用户始终连接为，我建议使用 SQL Server 帐户而不是域帐户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T16:33:42.243

不要对这种连接使用 Windows 身份验证。

您可以发布您用于 WA 和 SQLauth 的连接字符串的副本（已清理 - 更改密码）吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T16:37:27.807

尝试删除用户名的域部分 - COMPANY\User - 它可能会干扰身份验证。

另外 - 在 SQL Server 上（如果您有权访问），您是否尝试过通过 localhost 连接到服务器？可能只是您的用户没有足够的权限。

SQL Server Auth - 您是否创建了一个用户并将其附加到具有读取权限的数据库？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T16:39:31.377

安装 SQL Server 时，是否将其配置为使用混合模式身份验证？您还可以直接使用 SQL Management Studio 连接，使用 SQL 身份验证或 Windows 身份验证吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T17:23:10.413

我很确定它不能在 SQL Server 端，因为我能够从与我现在尝试连接的服务器完全不同的服务器进行连接。会不会是我正在使用的服务器的问题？如果是这样，有什么可能的解决方案？

与一些同事交谈时，他们说他们过去没有尝试连接到该服务器。我只是觉得很奇怪我能够从一台服务器连接但不能从另一台服务器连接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-05T19:12:17.120

以下是从 ASP.NET 应用程序建立数据库连接时遇到问题时要执行的步骤清单

1.  您可以从 ASP.NET 服务器 ping 数据库服务器吗？
2.  您可以使用来自 ASP.NET 服务器的 SQL 身份验证和 Management Studio 连接到数据库吗？
3.  使用非常简单的小回报查询编写一个页面以用作测试。可以用测试页查询数据库吗？不要依赖任何 web.config 条目，手动输入所有连接字符串和查询数据（不要将此测试页面留在服务器上超过测试所需的时间）
4.  如果您的测试页失败，错误是什么？如果您从 ASP.NET 服务器控制台进行测试，您应该会得到一个可能表明问题的详细错误。
5.  如果您有多个服务器数据库，请绝对确保您连接到您认为的服务器；）

一般提示：Management Studio 可能是最好的测试 - 如果您可以通过 Management Studio 从 ASP.NET 服务器通过 Windows 和 SQL 身份验证进行连接，那么问题一定出在您的 ASP.NET 应用程序配置上。

您提到您收到“COMPANY\name”未授权的显式身份验证错误。你在运行域控制器吗？“COMPANY”是域名吗？如果没有，ASP.NET 可能没有使用您的域帐户对数据库进行身份验证。

如果您必须使用 Windows 授权，请记住在 web.config 中启用模拟：

```
<identity impersonate="true" /> 
```

您还需要在您的站点的 IIS 配置中禁用匿名访问并启用集成安全性。

HTH。

# ruby-on-rails - 使用 Rails 时，在 Ruby 中处理常量的最佳方法是什么？

> ID：265725
> 
> 赞同：43
> 
> 时间：2008-11-05T16:31:23.200
> 
> 标签：ruby-on-rails, ruby, constants, enumeration

我有一些常量代表我模型的一个字段中的有效选项。在 Ruby 中处理这些常量的最佳方法是什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-05T16:41:31.403

您可以为此目的使用数组或哈希（在您的 environment.rb 中）：

```
OPTIONS = ['one', 'two', 'three']
OPTIONS = {:one => 1, :two => 2, :three => 3} 
```

或者一个枚举类，它允许您枚举常量以及用于关联它们的键：

```
class Enumeration
  def Enumeration.add_item(key,value)
    @hash ||= {}
    @hash[key]=value
  end

  def Enumeration.const_missing(key)
    @hash[key]
  end   

  def Enumeration.each
    @hash.each {|key,value| yield(key,value)}
  end

  def Enumeration.values
    @hash.values || []
  end

  def Enumeration.keys
    @hash.keys || []
  end

  def Enumeration.[](key)
    @hash[key]
  end
end 
```

然后您可以从中得出：

```
class Values < Enumeration
  self.add_item(:RED, '#f00')
  self.add_item(:GREEN, '#0f0')
  self.add_item(:BLUE, '#00f')
end 
```

并像这样使用：

```
Values::RED    => '#f00'
Values::GREEN  => '#0f0'
Values::BLUE   => '#00f'

Values.keys    => [:RED, :GREEN, :BLUE]
Values.values  => ['#f00', '#0f0', '#00f'] 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-05T16:38:45.027

我将它们直接放在模型类中，如下所示：

```
class MyClass < ActiveRecord::Base
  ACTIVE_STATUS = "active"
  INACTIVE_STATUS = "inactive"
  PENDING_STATUS = "pending"
end 
```

然后，当使用另一个类的模型时，我引用了常量

```
@model.status = MyClass::ACTIVE_STATUS
@model.save 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-05T21:22:07.653

如果它正在驱动模型行为，那么常量应该是模型的一部分：

```
class Model < ActiveRecord::Base
  ONE = 1
  TWO = 2

  validates_inclusion_of :value, :in => [ONE, TWO]
end 
```

这将允许您使用内置的 Rails 功能：

```
>> m=Model.new
=> #<Model id: nil, value: nil, created_at: nil, updated_at: nil>
>> m.valid?
=> false
>> m.value = 1
=> 1
>> m.valid?
=> true 
```

或者，如果您的数据库支持枚举，那么您可以使用[Enum Column](http://wiki.rubyonrails.org/rails/pages/Enum+Column+in+MySql)插件之类的东西。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-01-09T14:51:59.027

Rails 4.1 增加[了对 ActiveRecord 枚举的支持](http://edgeguides.rubyonrails.org/4_1_release_notes.html#active-record-enums)。

声明一个枚举属性，其中值映射到数据库中的整数，但可以按名称查询。

```
class Conversation < ActiveRecord::Base
  enum status: [ :active, :archived ]
end

conversation.archived!
conversation.active? # => false
conversation.status  # => "archived"

Conversation.archived # => Relation for all archived Conversations 
```

请参阅[其文档](http://api.rubyonrails.org/v4.1.0/classes/ActiveRecord/Enum.html)以获取详细说明。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-05T17:42:13.073

你也可以在你的模型中使用它，就像这样：

```
 class MyModel

  SOME_ATTR_OPTIONS = {
    :first_option => 1,
    :second_option => 2, 
    :third_option => 3
  }
end 
```

并像这样使用它：

```
 if x == MyModel::SOME_ATTR_OPTIONS[:first_option]
  do this
end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-28T12:58:20.863

您还可以使用模块将常量分组为主题 -

```
class Runner < ApplicationRecord
    module RUN_TYPES
        SYNC = 0
        ASYNC = 1
    end
end 
```

然后有，

```
> Runner::RUN_TYPES::SYNC
 => 0
> Runner::RUN_TYPES::ASYNC
 => 1 
```

# virtualization - 最好的虚拟化工具是什么？

> ID：265726
> 
> 赞同：3
> 
> 时间：2008-11-05T16:31:25.620
> 
> 标签：virtualization

最近，我的团队花费了太多时间来设置具有先前产品版本的机器或具有特定补丁的数据库服务器。在某些情况下，我们已经将开发人员的机器停机了三天​​。显然，这将是使用虚拟机的理想情况。我正在努力支持制作客户发布的虚拟图像的做法。我过去曾有效地使用 VMware 进行开发和测试，但我想知道是否有人有任何其他他们使用过的虚拟化工具？

我们正在 Windows XP 机器上使用 Java 进行开发。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T16:33:50.950

[VMWare](http://www.vmware.com)是最好的恕我直言。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T16:33:33.557

我对 VirtualBox [http://www.virtualbox.org/](http://www.virtualbox.org/)有过很好的体验，而且我喜欢它是免费的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T16:33:50.793

Microsoft 的[Hyper-V](http://www.microsoft.com/windowsserver2008/en/us/hyperv.aspx)实际上相当不错（当然假设您使用的是 Microsoft 服务器。）

实际上，我们从中获得的性能比使用 vmware 时要好一些。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T16:52:33.407

要在 Windows 上运行 Windows VM，您可以使用 MS Virtual PC 免费软件。

但是如果你想要 Linux，它会惨遭失败，而且不会告诉你这是因为。在这种情况下，请选择 VMWare。如果您关心价格，有 VMWare 工作站和服务器。VMWare 服务器与工作站几乎相同，但允许拥有远程 VM。OTOH 它没有多个快照（你只得到一个）和剪贴板与主机操作系统的集成。但它是免费的 =)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T03:41:32.100

第二 Eric 关于 VirtualBox 的评论：它不仅是免费的，而且不像 VMWare 那样将进程（即膨胀）加载到您的主机操作系统。**即使在我根本不打算启动它**的那一天，VMWare 也会减慢我的启动速度。

 **在 Ubuntu Desktop 和 Windows XP 上， VirtualBox 在启动 VM 时似乎也**快得多**，并且在将图形/击键转换到 VM 和从 VM 转换时也好得多。我的客户 XP 几乎和我的主机 XP 一样快，看起来……

如果来宾是 Windows XP，就像您的情况一样，让网络和文件共享以及所有这些工作变得轻而易举（对于 Linux，这并不容易）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-06T18:28:48.533

我在使用 Citry XenServer 方面有很好的经验。它是免费的，有很多模板，并且可以在比 VMWare 更多的硬件上运行。它们也是 P2V 之类的工具，而且都是免费的（至少是 Express Edition）。

[http://citrix.com/English/ps2/products/product.asp?contentID=683148](http://citrix.com/English/ps2/products/product.asp?contentID=683148)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-05T16:34:42.867

我们使用 VMWare ESX 3.5 并且对它非常满意。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-04-05T07:04:12.557

我刚开始使用虚拟化...我正在使用 Microsoft Virtualization 4.6 这本书...到目前为止它一直很有帮助...你可以检查一下...也许你会找到你要找的东西...链接是[https://www.packtpub.com/getting-started-microsoft-application-virtualization-46/book](https://www.packtpub.com/getting-started-microsoft-application-virtualization-46/book)

干杯！！

# linq - LinqToEntities 不检索实体的子对象

> ID：265747
> 
> 赞同：2
> 
> 时间：2008-11-05T16:35:32.210
> 
> 标签：linq, linq-to-entities

我第一次尝试 Linq 并且在检索实体的子对象时遇到了一些困难。我有一个与部门表有一对多关系的课程表（即一个部门可以有一门或多门课程）。

当我选择特定部门时，我想将与该特定部门相关的课程绑定到网格视图，但是 coursecount 变量总是返回零，即使有许多与该特定部门相关的课程。除课程对象外，部门对象似乎已正确填充。

我错过了一些明显的东西吗？

```
int deptid = Convert.ToInt32(cboDepartmentList.SelectedValue);
Department dept = schoolcontext.Department.First(p=> p.DepartmentID  == deptid);
int coursecourse = dept.Course.Count;
gvCourse.DataSource = dept.Course;
gvCourse.AutoGenerateColumns = true;
gvCourse.DataBind(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T16:50:01.620

schoolcontext.Department.Include("Course").First...

编辑：以上是快速回答......如果你想要更多详细信息，请[点击此处。](http://www.singingeels.com/Blogs/Nullable/2008/10/27/EntityFramework_Include_Equivalent_in_LINQ_to_SQL.aspx)

# xml - XSL父子问题

> ID：265750
> 
> 赞同：0
> 
> 时间：2008-11-05T16:35:58.073
> 
> 标签：xml, xslt

我有一个 xml 构建

```
<elig>
 <subscriber code="1234"/>
    <date to="12/30/2004"
        from="12/31/2004"/>
       <person name="bob"
           ID="654321"/>
       <dog type="labrador"
            color="white"/>
    <location name="hawaii"
              islandCode="01"/>
 </subscriber>
</elig> 
```

在 XSL 中，我有：

```
<xsl:template match="subscriber">
 <xsl:for-each select="date">
  <xsl:apply-templates match="person" />
  <xsl:apply-templates match="location" />
  <xsl:apply-templates match="dog" />
 </xsl:for-each>
</xsl:template> 
```

我遇到的问题是我需要在人和狗块之间的位置块。我试过 ../ 但它不起作用。我主要简化了这一点，但重点是。我似乎不记得我需要在位置前面放置什么才能让它工作。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T16:50:59.603

我在您的示例 XML 中修改了一个错字：

```
<elig>
 <subscriber code="1234">
    <date to="12/30/2004" from="12/31/2004"/>
       <person name="bob" ID="654321"/>
       <dog type="labrador" color="white"/>
    <location name="hawaii" islandCode="01"/>
 </subscriber>
</elig> 
```

使用这个样式表一切正常：

```
<xsl:template match="subscriber">
 <xsl:for-each select="date">
  <xsl:apply-templates select="../person" />
  <xsl:apply-templates select="../location" />
  <xsl:apply-templates select="../dog" />
 </xsl:for-each>
</xsl:template>

<xsl:template match="person">person</xsl:template>
<xsl:template match="location">location</xsl:template>
<xsl:template match="dog">dog</xsl:template> 
```

输出是：

```
personlocationdog 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T18:11:18.727

首先，您的 XML 格式仍然不正确，我实际上无法理解您为什么要遍历`<date/>`标签 - 里面只有一个`<date/>`标签`<subscriber/>`（假设第一个标签`<subscriber/>`不应该是自封闭的）。

使用 XPath 时，您必须始终考虑调用 XPatch 的上下文。以下应该做到这一点（当我对您的数据结构的假设是正确的时）：

```
<xsl:template match="subscriber">
 <xsl:for-each select="date"> 
  <!-- from here on we're in the context of the date-tag -->
  <xsl:apply-templates match="../person" />
  <xsl:apply-templates match="../location" />
  <xsl:apply-templates match="../dog" />
 </xsl:for-each>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-18T01:08:53.133

```
<xsl:template match="subscriber">
  <xsl:apply-templates match="date" />
</xsl:template>

<xsl:template match="date">
  <xsl:apply-templates match="../person" />
  <xsl:apply-templates match="../location" />
  <xsl:apply-templates match="../dog" />
</xsl:template>

      instead of xsl:for-each on date better practice is having a template match for date. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-10T10:06:25.810

在这种情况下，将 apply-template 调用移到 for-each 循环之外不是更合乎逻辑吗？由于 person、location 和 dog 元素是订阅者的子元素，所以它们应该在订阅者的范围内处理，而不是在日期的范围内。

IE：

```
<xsl:template match="subscriber">
  <xsl:for-each select="date">
     <!-- Perform the processing of the date tags here-->
  </xsl:for-each>

  <xsl:apply-templates match="person" />
  <xsl:apply-templates match="location" />
  <xsl:apply-templates match="dog" />
</xsl:template> 
```

# project-management - 您如何保存您正在从事的项目的状态信息？

> ID：265756
> 
> 赞同：6
> 
> 时间：2008-11-05T16:37:05.280
> 
> 标签：project-management, knowledge-management

让我清楚什么是项目的状态信息：

*   任何必须记住或写下然后在重新开始项目工作时检索的信息（例如，在第二天早上到达工作岗位时，或在晚上开始在副项目上工作时）。

*   例如，当您打开项目/解决方案时，您如何、在何处以及以何种形式保留信息，下一步要做什么，当前任务的上下文信息，以便恢复其工作。项目/任务管理系统并非旨在处理这种详细程度的事情，因此我不能使用现有的一些作为我的项目的基础。我尝试过使用 FreeMind（思维导图）或 ThinkingRock（完成工作）之类的软件，但它不起作用。

*   我需要的东西（我认为很多有意识的开发人员会对类似的系统感到高兴）是可以用来以类似于日志的形式保存信息的东西。我已经阅读了一些关于开发人员/程序员日志和工程师日志的一般概念的文章，但是从那以后我仍然无法实现适合我需要的东西。

*   该系统不仅可以用于纯粹的开发，还可以用于更多涉及更多研发的学术项目，尽管有更多研发部分的商业项目（阅读和尝试多本书、文章和论文中的东西）。

*   有关项目进度的信息必须以某种方式记录下来，以便查找参考资料、代码、某些决策的推理、注释等。

你知道一些可以完成这项工作的软件吗……或者我必须自己开始编写它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T16:39:03.793

试试 Notepad.exe，每个项目一个日志文件。或使用 Word。或者一个wiki，或者其他什么。

关键不是找花哨的软件，关键是自律保持日志更新！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T16:44:55.047

我有同样的要求，我已经从一个文本文件转移到了谷歌文档。这给了我几个好处：

*   我可以从任何地方访问它
*   简单格式化

我的笔记有一个名为**todo**的文件和其他文件，通常以一致的命名约定命名，例如：

*   产品名称想法
*   产品名称.todo
*   产品名称问题

在我的**待办事项**文件中，我按日期分组（当我应该做某事或完成它时）并在它们前面加上一个 3-4 个字符的代码来表示“谁”是给谁的。例如：

**. 等待**
。. PROD1：审查代码

**.星期一**
。. 家：去银行
。. HOME：寄账单
。. PROD2：编写要求

**.星期二**
。. PROD2：与团队一起审查

我只计划一个星期，最后保留诸如“稍后”、“很晚”、“我希望”之类的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T16:40:58.267

我只是使用 MS Word 作为日志，并在适当的地方插入指向其他文件的链接。大多数时候，使用笔记本就足以让我通过阅读最新条目来选择一个项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T16:41:04.350

我发现一个规则的笔记本和笔工作得很好。我经常用指示优先级的图标或注释来注释页边距，以便稍后跟进。我认为最重要的是保持一致。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T17:00:22.863

取决于项目以及是否要共享笔记。我用笔和纸记录我的个人笔记。快速且易于添加插图和参考资料。

共享笔记和常见问题解答类型的部落知识我更喜欢使用 wiki 或开发博客。博客格式非常适合提供时间线和（标记的）参考。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T17:06:59.277

我通常会在回家之前尝试完成一项任务。如果我做不到，要记住的一个好方法是为接下来应该做的事情创建一个失败的测试。

我在项目 wiki 上记下更大的事情，或者在我的代码中设置 TODO 注释（并使用找到它们的工具）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T00:43:49.417

我同意到目前为止的普遍共识：保持简单并专注于您的规范使用。我喜欢使用独立的 HTML 文件，因为它是纯文本，但允许真正的链接、各种列表和简单的格式。这适用于待办事项列表、自述文件、参考列表、想法等。

对于集成的团队工具，我更喜欢非常轻量级的 wiki。我的目标是 Trac ( [http://trac.edgewall.org/](http://trac.edgewall.org/) )，这是一个开源的免费软件项目，它集成了 wiki、源代码控制和问题跟踪——完美的结合。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-06T15:03:59.447

我使用[TodoList](http://www.codeproject.com/KB/applications/todolist2.aspx)在设计和实际开发过程中进行跟踪。这是一个简单的分层待办事项列表，但也提供了基本的项目管理功能（即设置截止日期、优先级和类别以及跟踪任务的进度）。这些文件是 XML，可以轻松处理和版本化，它包括一些基本的协作功能（尽管到目前为止我还没有使用过）。

在收集大量信息时，特别是如果它主要是一些文本、表格或图像，在实际开发之前或集思广益或只是写下想法时，我实际上使用 Microsoft OneNote，尽管我不会为此安装它。但是由于它包含在 Office 中，它安装在我公司的所有计算机上，所以我会使用它，因为我对它很满意。不过，我只为自己使用 OneNote，就像一个笔记本一样。

哦，然后，对于不是真正针对单个项目而是要重复使用的信息，我们当然在内部有一个 Wiki，尽管有时很难说服人们实际使用它（“什么，wiki？我会在需要这些信息时给您打电话！”）。叹。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-05T16:49:38.500

如果您需要共享信息，Wiki 非常适合您希望记住的这种“部落知识”类型的信息。

如果只是为了你自己，那么这里给出的其他答案非常有效。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T15:22:14.417

我使用[TiddlyWiki](https://tiddlywiki.com/)，这是一个有用的个人 wiki。我把它当作一大盒记事卡来使用，部分之间有交叉链接和超链接。

正如一些人所提到的，这些系统中最困难的部分是保持最新状态。

# php - 使用 PHP 生成 PDF

> ID：265760
> 
> 赞同：9
> 
> 时间：2008-11-05T16:37:30.957
> 
> 标签：php, pdf, dompdf

我有一个 PHP 应用程序，需要生成一个带有查询结果的 PDF。最简单的方法是使用 DOMPDF 为我生成 PDF。所以创建了一个为我生成 HTML 的函数，然后将其传递给 DOMPDF。在开发和测试环境中，一切都很好，但在生产环境中，我在内存使用方面遇到了一些问题。

所以我想知道我的策略是否是最好的，或者是否有更好、更简单的方法来做到这一点。

你会怎么做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-05T16:43:31.053

我曾经做过一个生成 PDF 的 PHP 项目。我使用[了 FPdf](http://www.fpdf.org/)。

我从来没有任何记忆问题。它是免费的，它是纯 PHP 代码。您不必加载任何扩展。

我不知道是否有一些帮助程序可以从查询中自动生成文档，但是在网站上，您有一些脚本可以显示如何将它与 MySql 一起使用。

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T18:50:53.800

我很惊讶没有人使用 FOP :) [http://xmlgraphics.apache.org/fop/](http://xmlgraphics.apache.org/fop/) ...你基本上给它一个 XML 文件，它会生成一个 PDF 文件...非常快，并且不会杀死你的服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T16:39:56.257

填写一个乳胶模板并通过它调用 Xetex。

我想你会在[Letterly](http://letterly.com/)找到令人满意的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T16:43:31.413

PHP有一个[PDF 扩展](http://www.php.net/manual/en/book.pdf.php)，但它不是很好 - 但是 Zend 框架确实有一个可以很好地利用它的类 - 我建议尝试一下。我以前没有听说过 DOMPDF。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T18:01:30.303

我几乎每周都使用[EZPDF 。](http://www.ros.co.nz/pdf/)它非常易于使用，具有出色的辅助功能，但仍可让您在必要时进入并进行细节工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T19:50:38.197

PrinceXML 是一个不错的选择。它可能会花费一点，但非常强大且易于使用。

# iphone - 你如何让 iPhone 在任意时间内振动？

> ID：265761
> 
> 赞同：14
> 
> 时间：2008-11-05T16:37:33.190
> 
> 标签：iphone, vibration

在 iPhone 2.x 固件中，您是否可以让 iPhone 在系统定义之外的持续时间内振动：

```
AudioServicesPlaySystemSound(kSystemSoundID_Vibrate); 
```

在越狱手机中，您曾经可以使用 MeCCA.framework 来执行此操作：

[http://pastie.org/94481](http://pastie.org/94481)

```
MeCCA_Vibrator *v = new MeCCA_Vibrator;
v->activate(1);
sleep(5);
v->deactivate(); 
```

但是我的 2.x iPhone 上不存在 MeCCA.framework。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-11T17:45:26.450

是的，这在过去曾导致 AppStore 被拒绝，并且可能会再次被拒绝……这意味着仍然可以这样做。

回答我自己的问题，这是如何做到的：

在构建阶段添加框架 CoreTelephony。

宣布：

```
extern void * _CTServerConnectionCreate(CFAllocatorRef, int (*)(void *, CFStringRef, CFDictionaryRef, void *), int *);
extern int _CTServerConnectionSetVibratorState(int *, void *, int, int, float, float, float);

static void* connection = nil;
static int x = 0; 
```

初始化：

```
connection = _CTServerConnectionCreate(kCFAllocatorDefault, &vibratecallback, &x); 
```

开始振动：

```
_CTServerConnectionSetVibratorState(&x, connection, 3, intensity, 0, 0, 0); 
```

停止振动：

```
_CTServerConnectionSetVibratorState(&x, connection, 0, 0, 0, 0, 0); 
```

此代码来自[HapticKeyboard](http://code.google.com/p/zataangstuff/source/browse/trunk/HapticKeyboard/Classes/HapticKeyboard.m?r=93)，这是一个可下载的应用程序，在您键入时会发出蜂鸣声。它适用于 Cydia 上的越狱手机。另见[我的越狱经历](http://soi.kd6.us/2008/09/25/so-i-got-a-new-phone/)）

还有其他好的参考吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T22:35:51.157

抱歉，使用 SDK 无法做到这一点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-05T22:44:29.767

这不仅是使用 SDK 无法做到的，而且还是[Unofficial App Store Rejection Criteria](http://10base-t.com/unofficial-appstore-rejection-criteria/)中的第一项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-20T04:06:31.427

iOS 5 实现了自定义振动模式。所以在某些情况下可变振动是可以接受的。唯一的事情是不知道什么库处理这个（很肯定不是CoreTelephony）以及它是否对开发人员开放。

# java - 如何重命名 java.exe/javaw.exe 进程？

> ID：265762
> 
> 赞同：17
> 
> 时间：2008-11-05T16:37:36.310
> 
> 标签：java

当我运行 java 应用程序时，它会在 Windows 任务管理器中显示为 java.exe 或 javaw.exe。如何通过其他编程语言重命名 java.exe 或 javaw.exe 进程而不使用包装器。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-05T16:52:39.867

如果您对相同的进程名称 ( *java.exe* ) 感到困惑，请尝试使用[*Process Explorer*](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)而不是*Task Manager*并显示*命令行*字段。这样，您可以看到区分一个进程与另一个进程的*类*或*jar参数。*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-05T16:44:04.313

你可以使用[jSmooth](http://jsmooth.sourceforge.net/)：

> JSmooth 是一个 Java 可执行包装器。它为您的 Java 应用程序创建本机 Windows 启动器（标准 .exe）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-05T17:16:36.557

以简单的方式和糟糕的风格，您可以复制 java.exe 或 javaw.exe（执行文件）并重命名为您想要的新进程名称。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-05T19:27:31.240

我怀疑操作系统通常不太喜欢尝试重命名其“图像”的进程。如果这是可能的，例如病毒很容易冒充合法进程。

顺便说一句，您还可以使用“jps.exe”列出所有 Java 进程及其对应的主类。“jps.exe”位于 Java 安装的 bin 目录中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-05T16:40:21.700

[我相信您最好的选择是使用Excelsior JET](http://www.excelsior-usa.com/jet.html)之类的提前编译器来生成可执行文件。正如[他们所提到](http://www.excelsior-usa.com/articles/java-to-exe.html#launch)的，您也可以使用自定义的 laucher 或 wrapper 代替。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-08T04:52:07.287

主要有2种方法：一种是其他人描述的：使用Launch4j、WinRun4J创建原生Windows启动器。

另一种似乎更好的方法是使用 Apache Procrun 将 java 应用程序包装为 Windows 服务。在安装服务过程中，我们可以给该进程起一个有意义的名字，比如OurApp.exe。

我们需要做的就是将 prunsrv.exe 重命名为 OurApp.exe，并将我们的 install|start|stop|uninstall 服务脚本中每次出现的 prunsrv.exe 替换为 MyApp.exe。

从[使用 Apache Procrun 在 Windows 中重命名 Java 程序的进程名称中查看更多信息](http://lifelongprogrammer.blogspot.com/2014/01/using-apache-procrun-to-rename-java-process-name.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-09-05T17:22:12.333

旧线程，但如果有人仍然想知道...如果您使用`javapackager`带有`-name MyTestApp -native image`标志的 ，它将为您生成带有可执行文件的本机运行时映像，`MyTestApp.exe`这就是它在任务管理器中的样子，带有默认图标：

[![task_manager_screenshot](https://i.stack.imgur.com/JHEpw.png)](https://i.stack.imgur.com/JHEpw.png)

现在，打包为自包含应用程序可能是也可能不是您想要的。它既有优点也有缺点： [https ://docs.oracle.com/javase/8/docs/technotes/guides/deploy/self-contained-packaging.html#A1307236](https://docs.oracle.com/javase/8/docs/technotes/guides/deploy/self-contained-packaging.html#A1307236)

# encoding - 在 Perforce 中如何处理文件类型更改？

> ID：265763
> 
> 赞同：3
> 
> 时间：2008-11-05T16:37:37.010
> 
> 标签：encoding, perforce

当您将文件添加到 Perforce 时，它​​会尝试确定文件的类型（文本、二进制、utf16 等）。它在这方面做得很好，但显然在最初提交给版本控制后不再检查文件类型。一位同事最近对将其转换为 Unicode (utf16) 的文本文件进行了更改。Perforce 无法识别这一点，仍然认为它是*text*类型，因此当其他人检索该文件时，它已损坏。

我们通过重新提交文件并将文件类型显式更改为*utf16*来解决问题，但如果这会自动发生，我们会更喜欢。有一些方法可以强制它始终使用某种编码类型，但我不知道我是否喜欢这个想法。有没有人处理过这个问题并找到了解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T18:36:21.997

Perforce 技术支持有这样的说法：

> 当您提交编辑时，Perforce 不会检查文件的内容。
> 
> 检查每个文件编辑的内容可能非常昂贵。“text”和“utf16”不是唯一需要注意的文件类型，例如，文件可能会将类型从“text”更改为“binary”。
> 
> 另一个问题是有时用户想要覆盖 Perforce 识别文件的默认行为。如果实际文件类型与用户提供的文件类型不匹配，服务器在这种情况下应该如何反应？
> 
> 由于这些原因，Perforce 只会在添加文件时确定文件类型，并考虑“typemap”和命令参数“-t”。
> 
> 另一方面，您可以通过使用“更改内容”触发器来防止您的情况再次发生。此触发器将检查文件的内容并将其与指定的文件类型进行比较，拒绝任何创建不匹配的提交。

# ruby-on-rails - 带有 Ruby/Rails 应用程序的 Paypal 网站支付标准

> ID：265765
> 
> 赞同：27
> 
> 时间：2008-11-05T16:38:29.410
> 
> 标签：ruby-on-rails, ruby, paypal

我想使用 Paypal 网站支付标准在我的 Rails 网站上实施支付解决方案。（参见[https://www.paypal.com/IntegrationCenter/ic_standard_home.html](https://www.paypal.com/IntegrationCenter/ic_standard_home.html)）。我不想要花哨的网关，也不想经历与存储信用卡信息相关的麻烦。我还想使用 Paypal IPN 进行通知。

我已经查看了各种网站，例如[http://www.fortytwo.gr/blog/14/Using-Paypal-with-Rails](http://www.fortytwo.gr/blog/14/Using-Paypal-with-Rails)，我在[http://railskits.com/saas上试用 Rails 工具包太便宜了/](http://railskits.com/saas/)。

有谁知道一个使用 Paypal 网站支付标准进行计费的开源 Rails 应用程序，你能指出我的代码吗？

另外，我的公司在加拿大，但服务器在美国。我必须注册 Paypal.com 或 paypal.ca 吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-06T00:44:10.040

我还会查看[ActiveMerchant](http://www.activemerchant.org/ "活跃商家")。[这里](http://www.codyfauser.com/2008/1/17/paypal-express-payments-with-activemerchant)有更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T18:47:02.663

[Spree](http://spreehq.org/)和[Substruct](http://code.google.com/p/substruct/)都是用 Rails 编写的支持 Paypal IPN 的电子商务平台。两者都是开源的，因此从了解它们如何处理 Paypal 集成开始可能会有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-28T02:53:43.023

使用这个代码片段怎么样？

[http://cubanlinks.org/articles/2005/8/3/ruby-on-rails-paypal-ipn-code-example](http://cubanlinks.org/articles/2005/8/3/ruby-on-rails-paypal-ipn-code-example)

如果我可以使用这个简单的代码片段，我宁愿不使用 activemerchant 或其他插件。

任何反馈？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T03:14:49.597

[Spree](http://spreehq.org)包含Payapl 网站支付标准的[扩展。](http://github.com/Gregg/spree-pp-website-standard/tree/master)事实上，流行的[envycasts](http://envycasts.com)网站就是使用此扩展的一个很好的例子。如果你想要 Rails 并且想要 Paypal Standard 的东西，这就是你的解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-13T16:43:46.927

实际上有更小的解决方案，使用 paypal gem，它给 IPN 提供了一个非常简单的 IPN 处理。其余的只是一个 html 表单:)

# windows-vista - NTFS 中的最大文件名长度（Windows XP 和 Windows Vista）？

> ID：265769
> 
> 赞同：267
> 
> 时间：2008-11-05T16:39:04.277
> 
> 标签：windows-vista, windows-xp, ntfs, filenames, name-length

我正在设计一个数据库表，它将保存上传文件的文件名。Windows XP 或 Vista 使用的 NTFS 文件名的最大长度是多少？

* * *

## 回答 #1

> 赞同：296
> 
> 时间：2008-11-05T16:41:17.457

文件名的各个组成部分（即路径上的每个子目录和最终文件名）限制为 255 个字符，总路径长度限制为大约 32,000 个字符。

但是，在 Windows 上，您不能超过`MAX_PATH`value（文件 259 个字符，文件夹 248 个字符）。看[http://msdn.microsoft.com/en-us/library/aa365247.aspx](http://msdn.microsoft.com/en-us/library/aa365247.aspx)了解完整详情。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-05T16:45:30.817

它是 257 个字符。准确地说：NTFS 本身确实规定了几千个字符的最大文件名长度（大约 30'000 左右）。但是，Windows 为 Path+Filename 规定了 260 的最大长度。驱动器+文件夹至少占用 3 个字符，因此您最终得到 257 个字符。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2013-04-12T12:29:53.290

这是框架 4.5 在尝试保存具有长文件名的文件时所说的“未处理的异常”：

> 指定的路径、文件名或两者都太长。完全限定的文件名必须少于**260 个**字符，目录名必须少于**248 个**字符。

![截屏](https://i.imgur.com/9SvuUcx.png)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-11-05T16:48:45.023

199 在 Windows XP NTFS 上，我刚刚检查过。

这不是理论，而是仅仅在我的笔记本电脑上尝试。可能会有缓解效果，但它实际上不会让我让它变得更大。

我想知道还有其他设置限制吗？自己试试吧。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2010-08-24T13:51:52.610

NTFS 中的长度是 255。NTFS 属性中的`NameLength`字段`$Filename`是一个没有偏移的字节；这会产生 0-255 的范围。

文件名本身可以位于不同的“命名空间”中。到目前为止，有：POSIX、WIN32、DOS 和（WIN32DOS - 当文件名本身可以是 DOS 名称时）。（由于字符串有长度，它*可以*包含 \0 但这会产生问题并且不在上面的命名空间中。）

因此，文件或目录的名称最多可包含 255 个字符。在 Windows 下指定完整路径时，您需要[在路径前加上**\\?\**（或使用 \\?\UNC\server\share 表示 UNC 路径）](https://msdn.microsoft.com/en-us/library/aa365247.aspx#maxpath)将此路径标记为扩展长度的路径（~32k 个字符） . 如果您的路径较长，则必须沿途设置工作目录（呃 - 由于进程范围的设置而产生的副作用）。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-11-05T16:42:00.840

根据[MSDN](https://msdn.microsoft.com/en-us/library/aa365247.aspx#maxpath)，它是 260 个字符。它包括`"<NUL>"`- 不可见的终止空字符，因此实际长度为 259。

但是阅读文章，它有点复杂。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-11-05T16:40:47.567

255 个字符。

[http://en.wikipedia.org/wiki/文件名](http://en.wikipedia.org/wiki/Filename)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-10-09T14:16:48.767

我将此添加到上述批准的答案中。

需要明确的是，人们认为它是 255-260 个字符的原因是因为这就是 Windows Explorer 所支持的全部。它会出错，例如对文件名进行文件复制之类的操作比这更长。但是，程序可以读取和写入更长的文件名（这就是 Explorer 首先抱怨的长度）。在这种情况下，微软的“推荐修复”是在编写它的原始程序中打开文件并重命名它。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-08-09T20:31:15.540

[官方文档的这一部分](https://docs.microsoft.com/en-us/windows/desktop/fileio/filesystem-functionality-comparison#limits)明确表示，NTFS、exFAT 和 FAT32是**255 个 Unicode 字符，UDF 是 127 个 Unicode 或 254 个 ASCII 字符。**

除此之外，最大路径名长度始终为 32,760 个 Unicode 字符，每个路径组件不超过 255 个字符。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-09-11T17:19:51.043

根据新的 Windows SDK 文档 (8.0)，似乎提供了新的路径限制。有一组新的[路径处理函数](http://msdn.microsoft.com/en-us/library/windows/desktop/dd807193%28v=vs.85%29.aspx)和 PATHCCH_MAX_CCH 的定义，如下所示：

```
// max # of characters we support using the "\\?\" syntax
// (0x7FFF + 1 for NULL terminator)
#define PATHCCH_MAX_CCH             0x8000 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-05T16:44:24.890

255 个字符，但完整路径也不应该长于该长度。Wikipedia 上有一张关于此的漂亮表格：[http](http://en.wikipedia.org/wiki/Filename) ://en.wikipedia.org/wiki/Filename 。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2009-11-20T17:01:24.730

实际上是 256，请参阅*[文件系统功能比较，限制](http://msdn.microsoft.com/en-us/library/ee681827(VS.85).aspx#limits)*。

在[http://fixunix.com/microsoft-windows/30758-windows-xp-file-name-length-limit.html上重复一个帖子](http://fixunix.com/microsoft-windows/30758-windows-xp-file-name-length-limit.html)

> *“假设我们谈论的是 NTFS 而不是 FAT32，“路径+文件的 255 个字符”是资源管理器的限制，而不是文件系统本身。NTFS 支持最多 32,000 个 Unicode 字符长的路径，每个组件最多 255 个字符。*
> 
> *Explorer - 和 Windows API - 将路径限制为 260 个字符，其中包括驱动器号、冒号、分隔斜线和终止空字符。如果您以`\\`"开头，则可以在 Windows 中读取更长的路径*

如果您阅读上述帖子，您会发现有第五件事可以确定：找到至少一个顽固的计算机用户！

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2015-05-28T14:08:40.457

**238！** 我用下面的 bat 脚本在 Win7 32 位下检查了它：

```
set "fname="
for /l %%i in (1, 1, 27) do @call :setname
@echo %fname%
for /l %%i in (1, 1, 100) do @call :check
goto :EOF
:setname
set "fname=%fname%_123456789"
goto :EOF
:check
set "fname=%fname:~0,-1%"
@echo xx>%fname%
if not exist %fname% goto :eof
dir /b
pause
goto :EOF 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2018-02-23T21:12:37.533

我无法在 WS 2012 Explorer 中创建名称+句点+扩展名超过**224**个字符的文件。不要射击信使！

在同一服务器的 CMD 中，我无法创建超过**235 个**字符的名称：

> 该系统找不到指定的路径。

在资源管理器中创建的具有 224 个字符名称的文件无法在 Notepad++ 中打开 - 它只是提供了一个新文件。

# asp.net - 以编程方式滚动到锚标记

> ID：265774
> 
> 赞同：44
> 
> 时间：2008-11-05T16:40:29.813
> 
> 标签：asp.net, navigation, anchor

考虑以下代码：

```
<a href="#label2">GoTo Label2</a>
... [content here] ...
<a name="label0"></a>More content
<a name="label1"></a>More content
<a name="label2"></a>More content
<a name="label3"></a>More content
<a name="label4"></a>More content 
```

有没有办法模拟单击“GoTo Label2”链接以通过代码滚动到页面上的相应区域？

**编辑**：可接受的替代方法是滚动到具有唯一 ID 的元素，该元素已存在于我的页面上。如果这是一个可行的解决方案，我会添加锚标签。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-11-05T17:08:30.317

如果您还在元素上放了一个 ID，那么这个 JS 通常对我来说效果很好：

```
document.getElementById('MyID').scrollIntoView(true); 
```

这很好，因为它还将定位可滚动的 div 等，以便内容可见。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-05T16:45:43.000

使用 javascript：

```
window.location.href = '#label2'; 
```

如果您需要从后面的服务器/代码执行此操作，您可以发出此 Javascript 并将其注册为该页面的启动脚本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-03T14:07:07.273

从服务器端移动到锚点，例如 c#。

```
ClientScript.RegisterStartupScript(this.GetType(), "hash", "location.hash = '#form';", true); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T16:43:12.350

我想这会起作用：

```
window.location="<yourCurrentUri>#label2"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T17:23:21.053

如果元素是锚标记，您应该能够：

```
document.getElementsByName('label2')[0].focus(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-18T03:08:57.827

解决方案

```
document.getElementById('MyID').scrollIntoView(true); 
```

在几乎所有浏览器中都运行良好，而我注意到在某些浏览器或某些移动设备（例如某些黑莓版本）中无法识别“scrollIntoView”功能，所以我会考虑这个解决方案（比前一个有点丑） ：

```
window.location.href = window.location.protocol + "//" + window.location.host + 
                       window.location.pathname + window.location.search + 
                       "#MyAnchor"; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T20:23:54.390

使用 window.location.hash 时没有“#”

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-05T16:45:33.313

例如，您可以只打开附加名称的新 URL`http://www.example.com/mypage.htm#label2`

在 JavaScript 中，

```
location.href = location.href + '#label2'; 
```

# java - 什么是最好的开源 Java 图表库？（除了 jfreechart）

> ID：265777
> 
> 赞同：139
> 
> 时间：2008-11-05T16:40:54.507
> 
> 标签：java, charts, plot

为什么没有更多易于使用的开源 Java 图表库？该领域唯一成功的开源项目似乎是 jfreechart，它甚至没有任何可用的文档或示例。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-11-05T21:15:51.707

有[charts4j](https://github.com/julienchastang/charts4j)，它是一个图表和图形API。它使开发人员能够通过简单直观的 Java API以编程方式创建[Google Chart API中可用的图表。](http://code.google.com/apis/chart/)

免责声明：我写了[charts4j](https://github.com/julienchastang/charts4j)。我们将在接下来的几周内发布另一个主要版本。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-11-05T16:43:59.587

它们的数量并不多，因为它们将与[JFreeChart](http://www.jfree.org/jfreechart/)竞争，这太棒了。[您可以通过下载开发者指南](http://www.object-refinery.com/jfreechart/guide.html)获取文档和示例。如果您搜索它们，还有大量免费的在线教程。

*   [JFreeChart - 教程](http://www.vogella.com/tutorials/JFreeChart/article.html)
*   [JFreeChart 简介](http://www.codeproject.com/Articles/650480/Introduction-to-JFreeChart)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-08-23T09:18:13.463

EasyCharts 是商业的，所以我不能在我的项目中使用它。我改用 GRAL 图形库。我发现它很容易定制，并且像 JFreeChart 一样在 LGPL 下获得许可，所以你可以免费使用它：

[http://trac.erichseifert.de/gral](http://trac.erichseifert.de/gral/)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-11-07T00:17:35.163

好问题，前几天我自己只是在寻找 JFreeChart 的替代品。JFreeChart 非常出色且非常全面，我已经在多个项目中使用过它。我最近的问题是，这意味着将 1.6mb 的库添加到一个 50kb 的小程序中，所以我正在寻找更小的东西。

[JFreeChart FAQ](http://www.jfree.org/jfreechart/faq.html#FAQ13)本身列出了替代方案。与 JFreeChart 相比，它们中的大多数都非常基础，有些非常难看。最有希望的似乎是[Java Chart Construction Kit](http://jcckit.sourceforge.net/)和[OpenChart2](http://approximatrix.com/products/openchart2/)。

我还发现[了 EasyCharts](http://www.objectplanet.com/easycharts/)，它是一种商业产品，但在某些情况下似乎可以免费使用。

最后，我回到了久经考验且值得信赖的 JFreeChart，并使用[Proguard](http://proguard.sourceforge.net)将其缩减为更易于管理的大小。

我建议您再看看 JFreeChart。用户指南仅供购买，但[演示](http://www.jfree.org/jfreechart/samples.html)展示了可能的功能，并且很容易从[API 文档](http://www.jfree.org/jfreechart/api/javadoc/index.html)中了解如何操作。基本上，您从[ChartFactory](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/ChartFactory.html)静态方法开始，并将生成的[JFreeChart](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/JFreeChart.html)对象插入[ChartPanel](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/ChartPanel.html)以显示它。如果你遇到困难，我相信你会在 StackOverflow 上得到一些关于你的问题的快速答案。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-03-27T22:19:28.717

你可以试试[Jzy3d](http://www.jzy3d.org/)。它有助于绘制简单的 3d 图表（曲面、散点图、条形图等），并且有很多用于自定义轴、刻度等布局的选项。wiki 上有很多示例和文档。

它是免费和开源的。

干杯，

马丁

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-06-23T18:37:23.863

对于动态 2D 图表，我一直在使用[JChart2D](http://jchart2d.sourceforge.net/)。它快速、简单并且会定期更新。作者很快就回复了我的一份错误报告和一些功能请求。在我们公司，我们更喜欢它而不是 JFreeChart，因为它是为动态使用而设计的，与 JFreeChart 不同。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-05T16:42:43.677

有 JChart，它都是开源的。我不确定您在绘制什么以及如何绘制它（servlet、swing 等），所以我会说只看几个不同的，看看哪个对你有用。

[http://sourceforge.net/projects/jchart/](http://sourceforge.net/projects/jchart/)

我也使用过 JGraph，但我只使用了他们的商业版本。然而，他们确实提供了一个开源版本：

[https://github.com/jgraph/jgraphx](https://github.com/jgraph/jgraphx)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-09-07T15:40:21.680

镇上有一个新的图表库：[JChartlib](http://freshmeat.net/projects/jchartlib) JChartLib [http://freshmeat.net/projects/jchartlib](http://freshmeat.net/projects/jchartlib)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-11-23T11:02:08.480

我找到了这个框架：jensoft sw2d，免费用于非商业用途（双重许可）

[http://www.jensoft.org](http://www.jensoft.org)

问候。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-04-20T17:43:03.293

我过去使用过 EasyCharts，它名副其实。它不如 JFreeChart 强大，但 EasyCharts 的 JAR 比 JFreeChart 小得多。

# project-management - 小型项目的速度

> ID：265784
> 
> 赞同：1
> 
> 时间：2008-11-05T16:41:49.390
> 
> 标签：project-management, scrum

我目前正在学习 Scrum，并想向该主题的经验丰富的专业人士学习。

速度是否与需要 3 个月的项目相关（通常有 2-3 次中间交付给客户）？
我认为现在还不足以使统计数据相关。是否值得记录整个项目中每个开发人员的速度以获得足够的统计深度？

另一个问题是速度对于小型项目真的那么重要吗？
我们在我们的领域有很多经验，我们的估计是不准确的。我们遇到的唯一问题与有时会影响您的风险因素有关，但我们知道我们的风险并知道如何处理它，我不确定 scrum 是否有助于解决客户板上的硬件问题。

我确实在其他部分看到了很多逻辑，比如小迭代、连续集成，让产品/项目管理非常接近开发过程，我认为我们已经在不知情的情况下通过 scrum 做很多事情。

所以最重要的是，我看不出 Scrum 作为整个概念是否适合我的需求，但我确实看到我可以使用很多概念（我真的很喜欢 backlog）来使我们的开发过程更好。

实际上，这更像是讨论而不是问题，但 SO 不是为此而设计的，所以如果不合适，我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T16:46:49.877

因此，将您的问题分为两部分：

1) Velocity 在 3 个月的项目中是否值得？是的，我认为是的。我曾在大多数项目持续 2-6 个月的团队中工作。我们有一周的迭代，但我知道只有 3 天的团队。然而，在敏捷社区中，有一种运动朝着更加 Kanaban 拉式系统的方向发展，在这种系统中，特定的迭代不是必需的。我会说从迭代开始，然后重新评估

2）所以当我们有好的估计时我需要速度？可能不会，因为您的项目较短。但是当某件事是 20 小时，而你需要 10 天，因为你每天只能工作 2 小时，那么你基本上需要使用不同的东西来计算速度。

我强烈推荐[XP](http://groups.yahoo.com/group/extremeprogramming)和[Scrum 开发](http://groups.yahoo.com/group/scrumdevelopment)邮件列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T17:03:40.313

如果你正在做一个为期一个月的冲刺的三个月项目，你将只能将你的速度计算用于两个冲刺。但是，如果您使用两周的冲刺，您将有五个冲刺，您可以在其中应用您的速度计算。通过更短的冲刺，您可以获得更多数据点。

作为一名开发人员，我喜欢在所有事情上跟踪我的速度。它让我知道我的时间估算技能是多么未经校准。我现在可以将我的历史速度应用于我的新估计，使这些估计更加合理。

作为一名团队成员，我想知道我的队友对时间的估计程度。我曾与那些一直低估自己的时间五倍或更多的人一起工作，如果你想避免不愉快的意外，提前知道这一点很重要。

所以是的，我发现速度对于任何规模的项目都很重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T16:47:30.563

较小的迭代将使您能够更好地衡量速度，因为它们提供了更多的数据点。跟踪不必很详细，一个简单的燃尽图可以快速以图形方式查看速度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T21:52:03.803

使用速度进行规划基本上只取决于最少量的迭代是否有价值。但对于其他反馈机制也是如此——将新的学习内容融入到正在运行的项目中需要频繁的检查点，这些检查点在迭代结束时提供。因此，对于较小的项目，您的迭代应该更小，无论如何（独立于间歇发布的数量）。我曾经做过一个为期两周的培训项目，我们使用了两天的迭代。工作得很好。

使用速度会为您提供价值吗？嗯，从这里很难说。一方面，如果您的估计过程已经运作良好，它可能不会。另一方面，也许它会更好。或者它也可以工作，但需要更少的努力。还要记住，Scrum（与其他流程一样）是一个包，其中不同的组件相互支持——因此，尽管您当前的估算流程为您提供了很好的服务，但它在 Scrum 流程中可能效果不佳，或者损害了 Scrum 的其他一些方面. 而且，由于不知道 Scrum 项目的具体期望是什么，您甚至可能没有注意到问题在于估算过程。

因此，考虑到上述情况，尝试一段时间的速度并看看它如何为您工作可能是有意义的。您可以随时返回并再次尝试您的旧方法。请记住，“检查和适应”是 Scrum 的重要组成部分。只是不要忘记在适应之前进行检查。

让一个对 Scrum 有一定经验的人加入可能也是一个好主意。他们通常更容易识别反模式并提出有效的适应。

# wpf - 将样式动态分配给 TabItem 控件

> ID：265796
> 
> 赞同：0
> 
> 时间：2008-11-05T16:44:12.300
> 
> 标签：wpf, tabitem

我在 App.xaml 文件“tabControlStyle”中定义了一个样式。如何将此样式分配给我动态创建的 TabItem 控件。

```
 TabItem item = new TabItem();               

                item.Header = String.Format("Item {0}", i);
                documentTab.Items.Add(item); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T17:04:06.553

我得到了答案。这里是：

```
 private void PopulateTabControl()
        {
            for(int i=1; i<=10;i++)
            {
                TabItem item = new TabItem();
                item.Style = Application.Current.Resources["tabItemStyle"] as Style;
                item.Header = String.Format("Item {0}", i);
                documentTab.Items.Add(item);
            }
        } 
```

# .net - 如何从 javascript 引发服务器端事件？

> ID：265807
> 
> 赞同：1
> 
> 时间：2008-11-05T16:46:03.560
> 
> 标签：.net, asp.net, javascript, event-handling

我有一个基本上用作客户端计时器倒计时控件的控件。

我想在倒计时达到特定时间时触发服务器端事件。

有谁知道如何做到这一点？

因此，当计时器倒计时到 0 时，会触发服务器端事件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T16:50:49.747

您可能希望使用 AJAX 进行服务器端调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T16:50:38.997

当您呈现页面时，创建一个客户端按钮，该按钮将在回发时执行您想要的操作。然后使用[ClientScriptManager.GetPostBackEventReference](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.getpostbackeventreference.aspx)传入控件作为参考，并使用属性向其添加客户端事件，如该链接底部的示例所示。

然后，您可以看到它呈现的 Javascript 并在您的函数中使用它来触发正确的服务器端事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T16:51:18.933

IIRC，有一个计时器服务器控件应该为您执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T16:54:36.070

以下是通知服务器事件的一种方法。您实际上是在触发客户端事件，然后与服务器进行通信。这是如果您不是生活在 AJAX 世界中的情况。

```
function NotifyServer()
{
    xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
    xmlHttp.onreadystatechange = OnNotifyServerComplete;
    xmlHttp.open("GET", "serverpage.aspx", true);
    xmlHttp.send();
}
function OnNotifyServerComplete()
{
    if (xmlHttp.readyState == 4)
    {
        if (xmlHttp.status == 200)
        {
            if (xmlHttp.responseText != "1")
                //do something
        }
    }

} 
```

# data-structures - 什么是二叉搜索树中的“内部节点”？

> ID：265809
> 
> 赞同：47
> 
> 时间：2008-11-05T16:46:49.177
> 
> 标签：data-structures, binary-tree

我正在互联网上搜索“内部节点”一词的定义。我找不到简洁的定义。我正在查看的每个来源都使用该术语而不对其进行定义，并且该用法并不能正确定义内部节点的实际含义。

以下是我主要关注的两个地方： [Link](https://planetmath.org/ExternalNode)假设内部节点是具有两个不为空的子树的节点，但没有说明原始树中的哪些节点是内部节点和外部节点。

[http://www.math.bas.bg/~nkirov/2008/NETB201/slides/ch06/ch06-2.html](http://www.math.bas.bg/%7Enkirov/2008/NETB201/slides/ch06/ch06-2.html)似乎暗示内部节点只存在于适当的二叉树中，并没有产生太多有用的信息.

什么*是*内部节点！？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2008-11-05T16:50:02.507

```
 I         ROOT (root is also an INTERNAL NODE, unless it is leaf)
   /   \
  I     I      INTERNAL NODES
 /     / \
o     o   o    EXTERNAL NODES (or leaves) 
```

如图所示，内部节点是位于树根和叶子之间的节点。请注意，根也是一个内部节点，除非它是树的唯一节点。

在其中一个关于内部节点必须有两个孩子的站点中所说的是，树是完整的二叉树，而不是节点是内部的。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-05T16:48:07.753

据我了解，它是一个不是叶子的节点。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-01-05T11:30:55.013

摘自 Thomas H Cormen 编辑的“算法简介”：

> 没有子节点的节点称为“叶节点”。非叶节点是“内部节点”。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-05T16:51:54.017

> 内部节点或内部节点是具有子节点且因此不是叶节点的树的任何节点。根节点和叶节点之间的中间节点称为内部节点。

资料来源：[http ://en.wikipedia.org/wiki/Tree_data_structure](http://en.wikipedia.org/wiki/Tree_data_structure)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-11-12T18:08:16.613

投票最多的答案是不正确的。根据Judith Gersting 的《*计算机科学数学结构》*，内部节点是“没有子节点的节点称为树的叶子；**所有非叶子节点称为内部节点**”

因此，例如（I = 内部节点）： `I / \ * I /\ * *`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-11-28T17:54:01.997

内部节点（也称为内部节点、简称 inode 或分支节点）是具有子节点的树的任何节点。类似地，外部节点（也称为外部节点、叶节点或终端节点）是任何没有子节点的节点。

快速简单。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-11-28T18:01:24.237

内部节点：不是根节点且至少有一个子节点的节点。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-05T23:40:10.480

通常，内部节点是任何不是叶子的节点（没有子节点的节点）。

在扩展二叉树（也是比较树）中，内部节点都有两个子节点，因为每个内部节点都对应一个必须进行的比较 [计算机编程艺术 (TAoCP) vol.3 排序和搜索，第 5.3 节中的讨论和图.1，第 181 页（编辑 2）。顺便说一句，使用这些树来表示淘汰赛的配对（和轮空）在本材料的第 5.4.1 节中讨论。]

Vinko 的图反映了这种区别，尽管根节点除了是唯一没有父节点的节点外，也总是内部节点或叶节点。

Knuth 对树的信息结构和属性的处理有更广泛的讨论 [TAoCP vol.1 Fundamental Algorithms，第 2.3.4.5 节中对树中路径长度的讨论，pp 399-406 (ed.3)，包括练习（许多工作-在书的后面）]。

值得注意的是，二叉搜索树（其中内部节点也保存单个值以及最多两个子节点）有些不同 [TAoCP vol.3，第 6.2.2 节]。不过，该命名法仍然有效。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-19T13:33:24.880

内部节点——至少有一个孩子的节点。外部节点——没有子节点的节点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-04T04:29:41.473

一个至少有一个子节点的节点。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-03-10T16:43:57.207

Ya 内部节点不包括根。一个完整的二叉树作为术语告诉每个内部节点应该有确切的 2 个节点。但是在一个简单的二叉树中，每个内部节点最多有 2 个节点，即它不能包含超过 2 个节点，但少于 2 个是允许的

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-11-25T08:15:53.903

二叉树可以有零个、一个节点，最多可以有两个节点。二叉树本身有一个左节点和一个右节点。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-07-01T18:54:18.880

内部节点或内部节点是具有子节点且因此不是叶节点的树的任何节点或根和叶节点之间的中间节点称为内部节点

# python - 如何使用正则表达式处理这样的字符串？

> ID：265814
> 
> 赞同：0
> 
> 时间：2008-11-05T16:47:56.537
> 
> 标签：python, regex

如何为这样的字符串创建正则表达式：

```
<SERVER> <SERVERKEY> <COMMAND> <FOLDERPATH> <RETENTION> <TRANSFERMODE> <OUTPUTPATH> <LOGTO> <OPTIONAL-MAXSIZE> <OPTIONAL-OFFSET> 
```

这些字段大部分只是简单的单词，但其中一些可以是路径，例如 FOLDERPATH、OUTPUTPATH，这些路径也可以是附加了文件名和通配符的路径。

保留是一个数字，传输模式可以是bin或ascii。问题是，LOGTO 可以是附加了日志文件名的路径，也可以是 NO，这意味着没有日志文件。

主要问题是可选参数，它们都是数字，OFFSET 不能没有 MAXSIZE 存在，但 MAXSIZE 可以没有偏移量存在。

下面是一些例子：

```
loveserver love copy /muffin* 20 bin C:\Puppies\ NO 256 300
loveserver love copy /muffin* 20 bin C:\Puppies\ NO 256
loveserver love copy /hats* 300 ascii C:\Puppies\no\ C:\log\love.log 256 
```

现在的主要问题是路径中可以有空格，所以如果我使用 . 为了匹配所有内容，当解析 LOG 目标最终附加到输出路径的可选参数时，正则表达式最终会中断。

另外，如果我最终使用 . 并开始删除它的一部分，正则表达式将开始把东西放在不应该的地方。

这是我的正则表达式：

```
^(\s+)?(?P<SRCHOST>.+)(\s+)(?P<SRCKEY>.+)(\s+)(?P<COMMAND>COPY)(\s+)(?P<SRCDIR>.+)(\s+)(?P<RETENTION>\d+)(\s+)(?P<TRANSFER_MODE>BIN|ASC|BINARY|ASCII)(\s+)(?P<DSTDIR>.+)(\s+)(?P<LOGFILE>.+)(\s+)?(?P<SIZE>\d+)?(\s+)?(?P<OFFSET>\d+)?$ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T16:54:22.733

问题是因为您允许文件名中有空格并使用空格来分隔字段，所以解决方案是模棱两可的。您要么需要使用不能出现在文件名中的不同字段分隔符，要么使用其他一些方法来表示带有空格的文件名，例如将它们放在引号中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T17:09:56.197

这在理论上是可能的，但你让自己的事情变得非常困难。你在这里有很多问题：

1）您使用空格作为分隔符，并且您还允许在路径名中使用空格。您可以通过强制应用程序使用其中没有空格的路径来避免这种情况。

2）你最后有2个可选参数。这意味着以“C:\LogTo Path 256 300”结尾的行你不知道路径是没有可选参数的 C:\LogTo Path 256 300 还是带有一个可选参数的 C:\LogTo Path 256 或 C: \LogTo 带有 2 个可选参数的路径。

这可以通过输出上的替换算法轻松解决。用下划线替换空格，用双下划线替换下划线。因此，在将日志文件拆分为空格后，您可以可靠地逆转这一点。

即使作为人类，您也无法 100% 可靠地执行此功能。

如果您假定所有路径都以星号、反斜杠或 .log 结尾，则可以使用正向前瞻来查找路径的结尾，但如果没有某种关于此的规则，您就会被塞满。

我觉得单个正则表达式对此太难了，并且会使任何试图维护代码的人发疯。我是一个正则表达式妓女，尽可能使用它们，我不会尝试这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T17:44:39.123

仅仅在空格上分割是行不通的。但是，如果您可以对数据做出一些假设，那么它就可以发挥作用。

我想到的一些假设：

*   `SERVER`，`SERVERKEY`并且`COMMAND`不包含任何空格：`\S+`
*   `FOLDERPATH`以斜线开头：`/.*?`
*   `RETENTION`作为一个数字：`\d+`
*   `TRANSFERMODE`不包含任何空格：`\S+`
*   `OUTPUTPATH`以驱动器开头并以斜杠结尾：`[A-Z]:\\.*?\\`
*   `LOGTO`要么是单词“ `NO`”，要么是以驱动器开头的路径：`[A-Z]:\\.*?`
*   `MAXSIZE`并且`OFFSET`是一个数字：`\d+`

把它们放在一起：

```
^\s*
(?P<SERVER>\S+)\s+
(?P<SERVERKEY>\S+)\s+
(?P<COMMAND>\S+)\s+
(?P<FOLDERPATH>/.*?)\s+   # Slash not that important, but should start with non-whitespace
(?P<RETENTION>\d+)\s+
(?P<TRANSFERMODE>\S+)\s+
(?P<OUTPUTPATH>[A-Z]:\\.*?\\)\s+   # Could also support network paths
(?P<LOGTO>NO|[A-Z]:\\.*?)
(?:
  \s+(?P<MAXSIZE>\d+)
  (?:
    \s+(?P<OFFSET>\d+)
  )?
)?
\s*$ 
```

在一行中：

```
^\s*(?P<SERVER>\S+)\s+(?P<SERVERKEY>\S+)\s+(?P<COMMAND>\S+)\s+(?P<FOLDERPATH>/.*?)\s+(?P<RETENTION>\d+)\s+(?P<TRANSFERMODE>\S+)\s+(?P<OUTPUTPATH>[A-Z]:\\.*?\\)\s+(?P<LOGTO>NO|[A-Z]:\\.*?)(?:\s+(?P<MAXSIZE>\d+)(?:\s+(?P<OFFSET>\d+))?)?\s*$ 
```

测试：

```
>>> import re
>>> p = re.compile(r'^(?P<SERVER>\S+)\s+(?P<SERVERKEY>\S+)\s+(?P<COMMAND>\S+)\s+(?P<FOLDERPATH>/.*?)\s+(?P<RETENTION>\d+)\s+(?P<TRANSFERMODE>\S+)\s+(?P<OUTPUTPATH>[A-Z]:\\.*?\\)\s+(?P<LOGTO>NO|[A-Z]:\\.*?)(?:\s+(?P<MAXSIZE>\d+)(?:\s+(?P<OFFSET>\d+))?)?\s*$',re.M)
>>> data = r"""loveserver love copy /muffin* 20 bin C:\Puppies\ NO 256 300
... loveserver love copy /muffin* 20 bin C:\Puppies\ NO 256
... loveserver love copy /hats* 300 ascii C:\Puppies\no\ C:\log\love.log 256"""
>>> import pprint
>>> for match in p.finditer(data):
...   print pprint.pprint(match.groupdict())
...
{'COMMAND': 'copy',
 'FOLDERPATH': '/muffin*',
 'LOGTO': 'NO',
 'MAXSIZE': '256',
 'OFFSET': '300',
 'OUTPUTPATH': 'C:\\Puppies\\',
 'RETENTION': '20',
 'SERVER': 'loveserver',
 'SERVERKEY': 'love',
 'TRANSFERMODE': 'bin'}
{'COMMAND': 'copy',
 'FOLDERPATH': '/muffin*',
 'LOGTO': 'NO',
 'MAXSIZE': '256',
 'OFFSET': None,
 'OUTPUTPATH': 'C:\\Puppies\\',
 'RETENTION': '20',
 'SERVER': 'loveserver',
 'SERVERKEY': 'love',
 'TRANSFERMODE': 'bin'}
{'COMMAND': 'copy',
 'FOLDERPATH': '/hats*',
 'LOGTO': 'C:\\log\\love.log',
 'MAXSIZE': '256',
 'OFFSET': None,
 'OUTPUTPATH': 'C:\\Puppies\\no\\',
 'RETENTION': '300',
 'SERVER': 'loveserver',
 'SERVERKEY': 'love',
 'TRANSFERMODE': 'ascii'}
>>> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T17:23:44.547

您需要以正则表达式可以将它们与路径名区分开来的方式限制路径之间的字段。

所以除非你输入一个特殊的分隔符，否则序列

```
<OUTPUTPATH> <LOGTO> 
```

带有可选空格的将不起作用。

如果路径看起来像那些字段，您可能会得到令人惊讶的结果。例如

```
c:\ 12 bin \ 250 bin \output 
```

为了

```
<FOLDERPATH> <RETENTION> <TRANSFERMODE> <OUTPUTPATH> 
```

是无法区分的。

所以，让我们尝试限制允许的字符：

```
<SERVER>, <SERVERKEY>, <COMMAND> no spaces -> [^]+
<FOLDERPATH> allow anything -> .+
<RETENTION> integer -> [0-9]+
<TRANSFERMODE> allow only bin and ascii -> (bin|ascii)
<OUTPUTPATH> allow anything -> .+
<LOGTO> allow anything -> .+
<OPTIONAL-MAXSIZE>[0-9]*
<OPTIONAL-OFFSET>[0-9]* 
```

所以，我会选择类似的东西

```
[^]+ [^]+ [^]+ .+ [0-9]+ (bin|ascii) .+ \> .+( [0-9]* ( [0-9]*)?)? 
```

用“>”分隔两条路径。您可能想要引用路径名。

注意：这是匆忙完成的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-05T17:48:06.337

是否小于/大于值内允许的值？因为如果没有，您有一个非常简单的解决方案：

Just replace ever occurance of "> " with just ">", split on "><", and strip out all less than/greater than from each item. It's probably longer than the regex code, but it will be clearer what's going on.

# c# - 将 2 个数据表连接到一个结果集中

> ID：265825
> 
> 赞同：0
> 
> 时间：2008-11-05T16:50:35.940
> 
> 标签：c#, ado.net

我有一个数据集，其中包含 2 个数据表，它们使用 DataRelation 链接在一起。

是否可以从这些表中选择到一个结果集中？

谢谢，奥弗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T17:56:14.637

Microsoft's suggestion is to create a helper class. See:

[http://support.microsoft.com/kb/326080/en-us](http://support.microsoft.com/kb/326080/en-us)

This is a general purpose tool that can be used no matter what the source.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T16:59:19.337

您可以使用 VS DataSet 编辑器创建 JOIN 表，并结合您的结果 - 然后您可以针对它编写 Select 查询并从您的应用程序中调用它们。

为此，只需创建一个新的 TableAdapter，然后将两个表添加到编辑器中（使用可视化的），然后从两个表中选择要使用的字段，然后编写相关的选择函数。

# ssis - 如何在 SSIS 中使用 Sybase.Data.ASEClient.dll .NET 提供程序？

> ID：265837
> 
> 赞同：2
> 
> 时间：2008-11-05T16:53:17.993
> 
> 标签：ssis, sap-ase

我正在尝试在 SSIS 中创建数据连接。我安装了 Sybase.Data.ASEClient.dll 版本 1.1.680，但这并未显示为 .Net 提供程序。

是否可以将此 ADO.NET 提供程序与 SSIS 一起使用，如果可以，我如何使其可访问？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T10:07:53.240

我也从未找到在 SSIS 中使用它的方法。

我使用的选项是 Sybase 提供的 OLEDB 连接。SDK 中提供的最新版本是可用的，尽管它们的质量不如 MS 或 Oracle OLEDB 连接器。

# embedded - 小型 RISC 模拟器

> ID：265846
> 
> 赞同：2
> 
> 时间：2008-11-05T16:57:36.440
> 
> 标签：embedded, emulation, cpu-architecture, embedded-language

我正在寻找将虚拟机构建到游戏中，并且想知道是否有人知道任何非常简单的虚拟机（我认为 RISC/PIC 接近我想要的），这些虚拟机通常用于嵌入式项目，例如控制机器人、电机、传感器等。如果我自己动手，我主要担心的是必须编写一个编译器/汇编器。我会很高兴使用已经存在的工具，或者以最简单的形式使用可以为其编译的 C 编译器：-p。

我真的不想在这里重新发明轮子，但我还需要在虚拟世界中运行数千个这样的设备，因此它们必须尽可能简单和快速。正如一个人已经提到的那样，我也不关心现实世界的问题，例如时间和公共汽车以及所有有趣的东西。我认为他们的虚拟时钟将仅限于非常慢的东西。最终我可能不得不研究原生编译以使它们运行得更快，但现在我只是将原型放在一起以获得一般的概念证明。

作为输入，我计划安装在圆柱体周围的距离、光线、材料和触摸传感器（16 个，可能是 32 个），然后只需 2 个用于定向输出的电机来控制每侧的一种轮子。本质上，处理不会太费力，世界将足够简单，以至于机器不必在简单的任务上投入大量的处理能力。

在内存方面，我希望他们能够存储足够的数据，以便在不干预构建地图和收集统计数据的情况下单独放置几天。我不喜欢 8bit 会因为处理或内存而减少它，但 16bit 肯定会是一个竞争者。32 位和 64 位只会推动它，而且它们的每个内存不可能超过 1mb - 可能更接近 256-512k。（比尔一说640k就足够了，我为什么不能！！）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T17:49:08.567

我为一位希望在具有大约 16K RAM 的嵌入式控制器上运行 VM 语言的朋友编写了[Wren 。](http://github.com/darius/wren)（但它允许在编写的代码中每个进程最多 64k。）它包括一个用于愚蠢的小编程语言的编译器。这一切，呃，非常基本，并没有看到太多用处，但这正是你在第一段中描述的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-06-12T21:02:04.090

FORTH“虚拟机”就这么简单。16 位地址空间（通常）、16 位数据字、两个堆栈、内存。Loeliger 的“Threaded Interpretive Languages”告诉你很多关于如何在 Z80 上构建 FORTH 解释器的信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T17:05:12.087

如果您想要植根于现实世界的东西，最常用的嵌入式 RISC 微控制器之一就是 PIC 系列。谷歌提供了几个模拟器，但我认为大多数人都没有源代码。

另一种可能性是 QEMU，它已经模拟了几个 ARM 品种。

当然，如果您对模拟真实世界的设备不感兴趣，那么自己动手做会更容易，性能更好。只有你需要的东西，而不是陷入状态标志、溢出位、有限的总线宽度、RAM 时序等的混乱中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T17:13:22.680

如果您想要简单，请考虑 Manchester Mark I。请参阅[此 PDF](http://www.seas.gwu.edu/~rhyspj/cs41talk.pdf)的第 15 页。机器有7条指令。为它写一个解释器大约需要一个小时。不幸的是，说明非常有限（这就是为什么机器的完整规格几乎可以放在一页上）。

Javier 自己滚动的方法非常务实。如果是这样的话，设计和制造一台微型机器是一项两天的任务。几年前我为一个项目构建了一个微型 VM，我花了两天时间用一个简单的可视化调试器编写了这个 VM。

另外-它必须是RISC吗？例如，您可以选择有[开源模拟器](http://www.easy68k.com/)的 68K，而 68K 是 gcc 的一个众所周知的目标。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-17T17:34:30.627

许多编写游戏程序和其他应用程序的人将一种语言嵌入到应用程序中，以允许用户编写小程序。

据我所知，最流行的[嵌入式语言](http://en.wikipedia.org/wiki/Scripting_language#Extension.2Fembeddable_languages)（尽管“更流行”并不一定意味着“更好”）似乎是：

*   为这一特定应用程序定制的领域特定语言，其他任何地方都没有使用
*   卢阿[_](http://books.google.com/books?id=1OJ8EhvuPXAC&pg=PA468&lpg=PA468&dq=game%20embedded%20language&source=bl&ots=iTTPui0TCy&sig=I2E7eqlnOfLxBK5zjsrdEbxI9ss&hl=en&sa=X&ei=19ndT_PzD4H48wTD0eTSCg&ved=0CG0Q6AEwCQ#v=onepage&q=game%20embedded%20language&f=false)
*   Tcl
*   Python [a](http://wiki.python.org/moin/AppsWithPythonScripting) [b](http://en.wikipedia.org/wiki/Maya_%28software%29)，通常是简化的子集，例如 PyMite [c](https://stackoverflow.com/questions/861864/is-there-a-safe-subset-of-python-for-use-as-an-embedded-scripting-language)
*   向前
*   JavaScript[一个](http://gnuvince.wordpress.com/2009/06/02/are-the-new-javascript-engines-going-to-completely-change-the-game/)
*   语言
*   天使[脚本](http://blog.wolfire.com/2010/01/Choosing-a-scripting-language)
*   XPL0 [a](http://en.wikipedia.org/wiki/XPL0) [b](http://techref.massmind.org/Techref/language/xpl0.htm)
*   松鼠[_](http://en.wikipedia.org/wiki/Squirrel_%28programming_language%29)
*   哈斯克尔[_](http://www.cs.um.edu.mt/gordon.pace/Research/Papers/wict2009-01.pdf) [_](http://www.cs.um.edu.mt/gordon.pace/Research/Papers/wict2010-01.pdf)
*   NPCI（纳米伪 C 解释[）](http://www.finitesite.com/d3jsys/README-NPCI.html)
*   [机器人对话](http://en.wikipedia.org/wiki/RoboWar)
*   解释一些硬件机器语言（为什么这是最不受欢迎的选择？有充分的理由，如下所述）。

您可能想查看 Gamedev StackExchange，特别是诸如[“如何将脚本语言添加到游戏中？”之类的问题。](https://gamedev.stackexchange.com/questions/421/how-do-you-add-a-scripting-language-to-a-game).

您可能想在 StackOverflow 上查看标记为[“嵌入式语言”](https://stackoverflow.com/tags/embedded-language/hot)的一些问题；例如 [“选择一种嵌入式语言”](https://stackoverflow.com/questions/2103728/selecting-an-embedded-language)、 [“我可以在我的软件中使用什么好的可嵌入语言来编写脚本？”](https://stackoverflow.com/questions/191222/what-is-a-good-embeddable-language-i-can-use-for-scripting-inside-my-software) [“Lua 作为嵌入式语言的替代品？”](https://stackoverflow.com/questions/4448835/alternatives-to-lua-as-an-embedded-language) [“哪种游戏脚本语言更好用：Lua 还是 Python？”](https://stackoverflow.com/questions/356160/which-game-scripting-language-is-better-to-use-lua-or-python) ， ETC。

这些语言的许多实现在内部使用某种 [字节码](http://en.wikipedia.org/wiki/bytecode)。通常，同一高级编程语言（如 JavaScript）的两种不同实现在内部使用两种完全不同的字节码语言（[a](https://stackoverflow.com/questions/8819846/how-is-javascript-translated-to-bytecode)）。通常几种高级编程语言编译成相同的底层字节码语言——例如，Python 的 Jython 实现、JavaScript 的 Rhino 实现、Tcl 的 Jacl 实现、JScheme 和 Scheme 的其他几种实现，以及 Pascal 的几种实现；全部编译为相同的 JVM 字节码。

**细节**

*为什么要使用脚本语言而不是解释某些硬件机器语言？*

为什么要[“交替硬软层”](http://c2.com/cgi/wiki?AlternateHardAndSoftLayers)？获得简单性和更快的开发。

**更快的发展**

人们通常使用脚本语言而不是编译语言来更快地工作。

使初始原型工作通常要快得多——解释器在幕后处理一堆机器语言强制你明确写出的东西：将变量的初始值设置为零、子程序序言和子程序结语代码, malloc 和 realloc 以及 free 和相关的内存管理东西，当容器装满时增加容器的大小等。

一旦有了初始原型，添加新特性就会更快：脚本语言具有快速的编辑-执行-调试周期，因为它们避免了编译语言的编辑-编译-执行-调试周期的“编译”阶段。

**简单**

我们希望嵌入式语言语言在两个方面“简单”：

*   如果用户想编写一个小代码来完成一些概念上微不足道的任务，我们不想用一种复杂的语言吓跑这个人，这种语言需要 20 磅的书和几个月的学习才能写出“你好，$USER " 没有缓冲区溢出。

*   由于我们正在实现该语言，我们想要一些易于实现的东西。也许一些简单的底层指令我们可以在一个周末敲出一个简单的解释器，也许我们可以通过最少的调整来重用某种预先存在的编译器。

当人们构建 CPU 时，硬件限制总是会限制指令集。许多概念上“简单”的操作——人们一直在使用的东西——最终需要大量的机器语言指令来实现。

嵌入式语言没有这些硬件限制，允许我们实现更复杂的“指令”来完成（对人类而言）在概念上看起来很简单的事情。这通常使系统在上述*两种方式上都更简单：*

*   直接用该语言编写的人（或为该语言编写编译器的人）最终编写的代码要少得多，花更少的时间单步调试代码等等。

*   对于每个这样的高级操作，我们将复杂性从编译器转移到解释器内的指令实现。与其（您编写代码）编译器将一些更高级别的操作分解为中间语言中的一个短循环（并在运行时在解释器中反复单步执行该循环），不如编译器以中间语言发出一条指令（并且您在解释器对该中间“指令”的实现中编写相同的一系列操作）。使用编译语言（“内部”复杂指令）实现所有 CPU 密集型的东西，极其简单的解释器通常足够快。（即，您避免花费大量时间构建 JIT 或尝试以其他方式加快速度）。

由于这些原因和其他原因，许多游戏程序员使用“脚本”语言作为他们的“嵌入式语言”。

（我现在看到 Javier 已经建议“使用嵌入式脚本语言”，所以这变成了长篇大论，*为什么*这是解释硬件机器语言的一个很好的替代方案，并在一种特定的脚本语言似乎不存在时指出替代方案合适的）。

# c# - 如何让 Form1 上的标签从 form2 说“你好”？

> ID：265849
> 
> 赞同：1
> 
> 时间：2008-11-05T16:59:06.250
> 
> 标签：c#

就是这样。这是一个愚蠢的问题（令人尴尬！），但我以前从未使用过 C#，只有 C++，而且我似乎无法弄清楚如何从辅助表单访问主表单上的标签并更改文本。如果有人能让我快速知道该怎么做，我将不胜感激！

顺便说一句，我真的应该澄清一下。抱歉：我有两个单独的 .cs 文件，每个文件如下所示。我在VS2008中使用[Designer]在Form1中添加标签。当我键入 Form1.label1 之类的内容时，它不明白。下拉列表显示了 Form1 的方法和属性列表，但只有大约 7 个，例如 ControlCollection、Equals、MouseButtons 和其他几个……我可以在 Form1 中公开定义一个变量并显示，但我不知道如何访问标签...

```
namespace AnotherProgram
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T17:10:22.453

您将需要对 Form1 实例的引用 - 例如，如果它是 Form1 正在构造 Form2，您可以`this`作为构造函数参数传入。

然后，您需要通过属性（或 - ick！ - 非私有字段）公开 Form1 的标签，或者编写一个方法/属性来设置标签的文本。例如：

```
public class Form1 : Form 
{
    private Label label;

    // Construction etc as normal

    public string LabelText
    {
         get { return label.Text; }
         set { label.Text = value; }
    }

    public Form2 CreateForm2()
    {
        return new Form2(this);
    }
}

public class Form2 : Form
{
    private Form1 form1;

    public Form2(Form1 form1)
    {
        this.form1 = form1;
        // Normal construction
    }

    public void SayHello()
    {
        form1.LabelText = "Hello";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T17:05:23.880

您必须从 Form2 引用 Form1。然后，您需要 Form 1 上对 Form2 可见的方法或属性，将标签文本更改为“Hello”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T17:10:49.847

> ```
> Public Class Form1
>     Inherits Form
> 
>     Friend label1 As New Label
> 
>     Public Sub openForm2()
>         Dim f As New Form2(Me)
>         f.Show()
>     End Sub
> 
> End Class
> 
> Public Class Form2
>     Inherits Form
> 
>     Private _ref As Form1
> 
>     Public Sub New()
>         _ref = Nothing
>     End Sub
> 
>     Public Sub New(ByVal formRef As Form1)
>         _ref = formRef
>     End Sub
> 
>     Public Sub accessLabel(ByVal setText As String)
>         If (_ref IsNot Nothing) Then
>             _ref.label1.Text = setText
>         Else
>             Throw New NullReferenceException("_ref is NULL")
>         End If
>     End Sub
> 
> End Class 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T10:07:38.967

我认为代表是最强大的选择，除了在表单中具有属性：[http ://www.c-sharpcorner.com/UploadFile/mosessaur/winformsdelegates09042006094826AM/winformsdelegates.aspx](http://www.c-sharpcorner.com/UploadFile/mosessaur/winformsdelegates09042006094826AM/winformsdelegates.aspx)

在第二种形式中，我定义：

```
public delegate void AddItemDelegate(string item);
public AddItemDelegate AddItemCallback; 
```

从打开它的表格中，我写道：

```
private void btnScenario2_Click(object sender, EventArgs e)
{

    FrmDialog dlg = new FrmDialog();
    //Subscribe this form for callback
    dlg.AddItemCallback = new AddItemDelegate(this.AddItemCallbackFn);
    dlg.ShowDialog();

}
private void AddItemCallbackFn(string item)
{

    lstBx.Items.Add(item);

} 
```

# sql - 如何以最高性能查询 DB2 中的数据范围？

> ID：265850
> 
> 赞同：7
> 
> 时间：2008-11-05T16:59:14.533
> 
> 标签：sql, database, pagination, db2

通常，我需要从某个范围内的表中检索数据；例如，每个搜索结果都有一个单独的页面。在 MySQL 中我使用 LIMIT 关键字，但在 DB2 中我不知道。现在我使用这个查询来检索数据范围。

```
SELECT * 
FROM(
   SELECT  
      SMALLINT(RANK() OVER(ORDER BY NAME DESC)) AS RUNNING_NO
      , DATA_KEY_VALUE
      , SHOW_PRIORITY
   FROM 
      EMPLOYEE
   WHERE 
      NAME LIKE 'DEL%'
   ORDER BY
      NAME DESC
   FETCH FIRST 20 ROWS ONLY
) AS TMP
ORDER BY 
  TMP.RUNNING_NO ASC
FETCH FIRST 10 ROWS ONLY 
```

但我知道这是不好的风格。那么，如何查询最高性能呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-06-13T18:12:46.417

我的需求已经添加到 DB2 9.7.2 中。

DB2 9.7.2 为限制查询结果添加了新语法，如下图所示：

```
SELECT * FROM TABLE LIMIT 5 OFFSET 20 
```

数据库将从第号行检索结果。21 - 25

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T18:34:42.547

不确定为什么要创建 TMP 表。RUNNING_NO 不是按升序排列吗？我会认为：

```
SELECT SMALLINT(RANK() OVER(ORDER BY NAME DESC)) AS RUNNING_NO,
       DATA_KEY_VALUE,
       SHOW_PRIORITY
  FROM EMPLOYEE
 WHERE NAME LIKE 'DEL%'
 ORDER BY NAME DESC
 FETCH FIRST 10 ROWS ONLY
```

会给出相同的结果。

在 EMPLOYEE 表上对 NAME 使用 INDEX 将提高此查询的性能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-04T09:18:11.843

这非常困难，这取决于您拥有哪个数据库。

例如：

```
SELECT * FROM ( 
    SELECT 
      ROW_NUMBER() OVER (ORDER BY ID_USER ASC) AS ROWNUM,  
      ID_EMPLOYEE, FIRSTNAME, LASTNAME 
    FROM EMPLOYEE 
    WHERE FIRSTNAME LIKE 'DEL%' 
  )  AS A WHERE A.rownum
BETWEEN 1 AND 25 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-14T17:26:44.273

很简单，只需按照语法进行分页即可。

```
LIMIT (pageSize) OFFSET ((currentPage) * (pageSize)) 
```

# c# - 如何防止 SqlConnection 上的时区转换？

> ID：265855
> 
> 赞同：2
> 
> 时间：2008-11-05T17:01:27.617
> 
> 标签：c#, database, timezone

我这里有一个完全在 GMT 上运行的数据库。但是，客户端计算机可能在许多不同的时区（包括 BST）上运行。当您使用 SqlConnection 拉回数据时，它将转换日期时间值，例如

2008 年 8 月 19 日

变成

2008 年 8 月 18 日 23:00:00。

我的问题是，有没有办法指定您不希望发生这种翻译的连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T17:33:10.377

您如何访问数据？

从 web 服务传递 DataSets / DataTables 时，我遇到了同样的问题。

我通过在 DataTable 中设置 DataColumn.DateTimeMode 属性来解决它

```
returnedDataTable.Columns("ColumnName").DateTimeMode = DataSetDateTime.Unspecified 
```

之后就好了。

不知道这是否会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T17:08:12.847

仅在数据库中保留 UTC 值。在从数据库存储/检索时，让您的业务对象始终转换为/从 UTC/本地时间转换，以便用户可以查看和输入本地时间值。您可以通过在 BO 的 getter/setter 方法中实现转换来做到这一点，以便私有变量采用 UTC，因此当它存储回数据库时，它已经是您需要的形式。

# c# - 默认字符串初始化：NULL 还是 Empty？

> ID：265875
> 
> 赞同：134
> 
> 时间：2008-11-05T17:08:01.100
> 
> 标签：c#

我一直将我的字符串初始化为 NULL，认为 NULL 表示没有值，而 "" 或 String.Empty 是有效值。我最近看到了更多将 String.Empty 视为默认值或不代表任何值的代码示例。这让我觉得很奇怪，在 c# 中新添加的可空类型似乎我们正在通过不使用 NULL 来表示“无值”而在字符串方面向前迈进了一大步。

**您使用什么作为默认初始化程序，为什么？**

*编辑：根据答案，我进一步思考*

1.  **避免错误处理**如果值不应该为空，为什么一开始就将其设置为`NULL`？也许最好在错误发生的地方识别错误，而不是在代码库的其余部分中掩盖它？

2.  **避免空检查**如果您厌倦了在代码中进行空检查，那么抽象空检查不是更好吗？也许包装（或扩展！）字符串方法以使其`NULL`安全？如果您经常使用`String.Empty`并且 null 碰巧进入您的系统会发生什么，您是否开始添加`NULL`检查？

我不禁回到懒惰的观点。`null`如果您使用 '' 而不是在他\她的数据库中，任何 DBA 都会给您九种愚蠢的方法。我认为同样的原则也适用于编程，应该有人来打击那些使用`String.Empty`而不是`NULL`代表没有价值的人。

> ### 相关问题
> 
> *   [在 C# 中，我应该使用 string.Empty 还是 String.Empty 还是“”？](https://stackoverflow.com/questions/263191/in-c-should-i-use-stringempty-or-stringempty-or)
> *   [String.Empty 和 ""</a> 有什么区别](https://stackoverflow.com/questions/151472/what-is-the-difference-between-stringempty-and)
> [](https://stackoverflow.com/questions/151472/what-is-the-difference-between-stringempty-and)
> *   [空字符串或空字符串表示表列中没有数据？](https://stackoverflow.com/questions/167952/null-or-empty-string-to-represent-no-data-in-table-column)

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2008-11-05T17:12:49.810

+1 用于区分“空”和 NULL。我同意“空”应该表示“有效，但空白”，“NULL”应该表示“无效”。

所以我会这样回答你的问题：

**当我想要一个可能会或可能不会更改的有效默认值时为**空，例如，用户的中间名。****

 ****如果随后的代码没有显式设置值，则当它是错误时为**NULL 。****

 *** * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-11-05T17:13:43.130

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms228362.aspx)：

> 通过使用`Empty`值而不是初始化字符串`null`，可以减少`NullReferenceException`发生的机会。

尽管如此，始终使用`IsNullOrEmpty()`是一种很好的做法。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-07-24T11:47:39.467

为什么你想要你的字符串被初始化？当您声明一个变量时，您不必初始化一个变量，而且 IMO，您应该只在您分配的值在代码块的上下文中有效时才这样做。

我经常看到这个：

```
string name = null; // or String.Empty
if (condition)
{
  name = "foo";
}
else
{
  name = "bar";
}

return name; 
```

不初始化为 null 将同样有效。此外，您通常希望分配一个值。通过初始化为 null，您可能会错过未分配值的代码路径。像这样：

```
string name = null; // or String.Empty
if (condition)
{
  name = "foo";
}
else if (othercondition)
{
  name = "bar";
}

return name; //returns null when condition and othercondition are false 
```

当您不初始化为 null 时，编译器将生成一个错误，指出并非所有代码路径都赋值。当然，这是一个非常简单的例子……

马蒂斯

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-05T19:27:07.527

对于大多数实际上不是字符串处理软件的软件，程序逻辑不应该依赖于字符串变量的内容。每当我在程序中看到这样的东西时：

```
if (s == "value") 
```

我有一种不好的感觉。为什么这个方法中有一个字符串文字？什么设置`s`？它是否知道逻辑取决于字符串的值？它知道它必须小写才能工作吗？我应该通过将其更改为使用来解决此问题`String.Compare`吗？我应该创建`Enum`并解析它吗？

从这个角度来看，我们得到了一种非常简单的代码哲学：尽可能避免检查字符串的内容。将字符串与`String.Empty`文字进行比较实际上只是将其与文字进行比较的一种特殊情况：除非您确实必须这样做，否则应避免这样做。

知道了这一点，当我在我们的代码库中看到这样的内容时，我不会眨眼：

```
string msg = Validate(item);
if (msg != null)
{
   DisplayErrorMessage(msg);
   return;
} 
```

我知道那`Validate`永远不会返回`String.Empty`，因为我们编写的代码比那更好。

当然，世界其他地方不是这样工作的。当您的程序处理用户输入、数据库、文件等时，您必须考虑其他原理。在那里，你的代码的工作就是给混乱施加秩序。该顺序的一部分是知道空字符串何时应表示`String.Empty`以及何时应表示`null`.

（为了确保我不是在胡说八道，我只是在我们的代码库中搜索了 `String.IsNullOrEmpty'。所有 54 次出现都在处理用户输入、从 Python 脚本返回值、检查从外部 API 等）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-05T17:15:44.983

这实际上是 C# 语言中的一个大漏洞。没有办法定义一个不能为空的字符串。这会导致与您所描述的问题一样简单的问题，这迫使程序员做出他们不应该做出的决定，因为在许多情况下 NULL 和 String.Empty 意味着相同的事情。这反过来又会迫使其他程序员不得不同时处理 NULL 和 String.Empty，这很烦人。

更大的问题是数据库允许您定义映射到 C# 字符串的字段，但数据库字段可以定义为 NOT NULL。因此，无法使用 C# 类型准确表示 SQL Server 中的 varchar(100) NOT NULL 字段。

其他语言，例如 Spec #，确实允许这样做。

在我看来，C# 无法定义不允许 null 的字符串与之前无法定义允许 null 的 int 一样糟糕。

完全回答您的问题：我总是使用空字符串进行默认初始化，因为它更类似于数据库数据类型的工作方式。（编辑：这个语句非常不清楚。它应该是“当 NULL 是一种多余的状态时，我使用空字符串进行默认初始化，就像我将数据库列设置为 NOT NULL 如果 NULL 是一种多余的状态一样。类似地，我的许多数据库列都设置为 NOT NULL，所以当我将它们带入 C# 字符串时，字符串将为空或有值，但永远不会为 NULL。换句话说，我只将字符串初始化为 NULL如果 null 的含义与 String.Empty 的含义不同，我发现这种情况不太常见（但这里的人们已经给出了这种情况的合法示例）。”）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-05T17:14:19.480

这取决于。

您是否需要能够判断该值是否丢失（是否可能未定义）？

空字符串是该字符串使用的有效值吗？

如果您对两者都回答“是”，那么您将希望使用 null。否则你无法区分“无值”和“空字符串”。

如果您不需要知道是否没有值，那么空字符串可能更安全，因为它允许您在使用它的任何地方跳过空检查。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-06T03:58:19.633

[似乎这是http://en.wikipedia.org/wiki/Null_Object_pattern](http://en.wikipedia.org/wiki/Null_Object_pattern)的一个特例

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-05T17:12:42.493

我将其设置为“”或 null - 我总是使用 String.IsNullOrEmpty 进行检查，所以两者都可以。

但是我内心的极客说我应该在我有一个合适的值之前将它设置为空......

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-06T07:09:23.210

我总是用 string.empty 声明字符串；

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-05T17:12:17.330

这是否可能是一种避免错误的技术（可取与否..）？由于 "" 仍然是一个字符串，您将能够在其上调用字符串函数，如果它为 NULL 会导致异常？

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-06T03:31:06.660

我总是将它们初始化为**`NULL`**.

我*总是*用来`string.IsNullOrEmpty(someString)`检查它的价值。

简单的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-05T17:12:23.167

这取决于实际情况。在大多数情况下，我使用 String.Empty 因为我不想每次尝试使用字符串时都进行空检查。它使代码更简单，并且您不太可能引入不必要的 NullReferenceException 崩溃。

当我需要知道它是否已设置以及空字符串在哪里设置为有效时，我只将字符串设置为 null。在实践中，我发现这些情况很少见。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-05T17:17:01.160

空字符串是一个值（一段文本，碰巧不包含任何字母）。Null 表示无价值。

当我希望表明它们不指向或不包含实际值时，我将变量初始化为 null - 当意图是无值时。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-04-05T19:52:04.677

重申 Tomalak 的响应，请记住，当您将字符串变量分配给 null 的初始值时，您的变量不再是字符串对象；与 C# 中的任何对象相同。因此，如果您尝试访问变量的任何方法或属性并且假设它是一个字符串对象，您将获得 NullReferenceException 异常。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-01-26T09:43:35.493

Null 仅应在值是可选的情况下使用。如果该值不是可选的（如“名称”或“地址”），则该值不应为空。这适用于数据库以及 POCO 和用户界面。Null 表示“此值是可选的，当前不存在”。

如果您的字段不是可选的，那么您应该将其初始化为空字符串。将其初始化为 null 会将您的对象置于无效状态（由您自己的数据模型无效）。

就我个人而言，我宁愿字符串默认情况下不可为空，而是只有在我们声明“字符串？”时才可以为空。尽管这在更深层次上可能不可行或不合逻辑；没有把握。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-06T02:48:17.760

字符串不是值类型，也永远不会是 ;-)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-02-13T17:41:18.980

我认为没有理由不将 null 用于未分配（或在程序流中未发生的此位置）值。如果要区分，有==null。如果您只是想检查某个值而不关心它是 null 还是不同的值，String.Equals("XXX",MyStringVar) 就可以了。

# .net - Ruby 可以导入 .NET dll 吗？

> ID：265879
> 
> 赞同：15
> 
> 时间：2008-11-05T17:08:25.013
> 
> 标签：.net, windows, ruby, com, dll

我有兴趣在必须使用 .NET dll 的项目中使用/学习 RoR。Ruby 是否能够导入 .NET dll？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-05T19:56:57.263

虽然 IronRuby 可以轻松地与您的 .NET dll 对话（它实际上根本就没有代码），但它被微软抛弃了，而且它从来没有一个足够大的开源社区来维持它在该事件之后的运行。这些天我不推荐它

关于 COM 解决方案，这实际上可能是一个不错的方法。

您不需要 RubyCOM 库——它允许其他 COM 对象调用 ruby​​ 代码。要从 ruby​​ 加载 COM 对象，您只需要该`win32ole`库，它是 windows ruby​​ 标准库的一部分。

您是否可以从 COM 加载 dll 将取决于 .NET dll 是否构建为“Com Visible”。.NET 框架定义了一个`ComVisibleAttribute`，它可以应用于整个程序集或程序集中的特定类。如果为整个程序集或任何类设置为 true，则 dll 将已经可以从 COM 调用而无需任何包装器代码。

这是我做的一个测试。

创建一个新的 .NET dll 项目（类库）。这是我使用的示例类：

```
using System;
using System.IO;

namespace ComLib
{
    public class LogWriter
    {
        public void WriteLine( string line )
        {
            using( var log = new StreamWriter( File.OpenWrite( @"c:\log.file" ) ) )
            {
                log.WriteLine( line );
            }
        }
    }
} 
```

现在，在 Visual Studio 项目下，有一个名为的目录`Properties`，其中包含`AssemblyInfo.cs`. 在这个文件中，会有以下内容

```
[assembly: ComVisible( false )] 
```

将假改为真。如果您不希望程序集中的*每个类*都暴露给 COM，那么您可以将其设置为 false `AssemblyInfo.cs`，而是将其放在您想要暴露的每个类之上，如下所示：

```
[ComVisible( true )]
public class LogWriter .... 
```

现在右键单击 dll 项目本身，然后从弹出菜单中选择“属性”。在部分列表中，选择`Build`

向下滚动，然后勾选“注册 COM 互操作”复选框。现在当你编译这个 DLL 时，Visual Studio 会做一些必要的事情来将 COM 信息加载到注册表中。请注意，如果您使用的是 vista，则需要以管理员身份运行 VS 才能正常工作。

现在已经完成了，重新编译你的 dll，然后创建一个新的 ruby​​ 文件。

在这个 ruby​​ 文件中，执行以下操作：

```
require 'win32ole'

lib = WIN32OLE.new('[Solution name].ComLib.LogWriter')
lib.WriteLine('calling .net from ruby via COM, hooray!') 
```

其中 [Solution name] 将替换为您刚刚创建的解决方案的名称（默认：“ClassLibrary1”）

Ruby那个红宝石文件，然后！您应该看到文本被写入`c:\log.file`.

此解决方案的一个问题是它要求 .NET dll 已经是 Com Visible，或者如果不是，您可以重新编译它。如果这些都不是真的，那么您可能需要考虑其他选项。

祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-21T16:50:16.633

您还可以使用托管 C++ 编写本机 -> C# 包装 DLL

将您想要的所有函数导出为 DLL 中的 C 调用，例如

```
extern "C" __declspec ( dllexport ) void CallManagedMethod() {
   Something^ myManagedObject ...
} 
```

然后使用 FFI 从 Ruby [https://github.com/ffi/ffi调用该 DLL](https://github.com/ffi/ffi)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T17:52:50.370

如果你想使用“普通”红宝石（因为我认为 IronRuby 还没有完全运行 RoR）你可以通过 COM 去 - 即

```
"Your Ruby Code" -> RubyCOM -> "COM-Callable Wrappers" -> "Your .NET objects" 
```

[RubyCom](http://www.geocities.com/masonralph/rubycomdoc.html)

不过，这有点令人费解。

*编辑：答案中其他地方更好的基于 COM 的选项*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T18:01:00.273

另一件事 - 从面向服务的架构角度考虑它可能会更好。你能把那个 .NET DLL 作为服务公开吗？

在幕后，您可以用 C 编写 Ruby 模块，因此您始终可以编写互操作来完成您需要的工作。不过，它会将您的部署限制在 Windows 平台上（我没有尝试过 Ruby->Interop->Mono）

这是我几年前做的一个名为[Ruby for C# Developers](http://www.cornetdesign.com/files/RubyCSharpStlCodeCamp.ppt)的演示文稿。这有点过时（这是在 John Lam 的项目被合并到 IronRuby 之前），但可能会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T17:11:56.287

如果您使用 IronRuby（基于 .Net 的 Ruby 实现），那么它应该可以。如果您已经在使用 .Net 并想试用 Ruby，那么您可能需要研究 IronRuby。

在 IronRuby 之外，我不确定。我自己没有用过 Ruby，所以我不知道它有什么能力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T21:35:12.463

尽管 AFAIK 是一个已死的项目，但您可能会发现John Lam（他现在负责 IronRuby）以前的[RubyCLR 项目是一个有趣的项目。](http://rubyforge.org/projects/rubyclr/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T17:45:04.230

如果您对 ASP.NET MVC 和 IronRuby 一起感兴趣，您可能会发现自己查看 Jimmy 的源代码 -[http://github.com/jschementi/ironrubymvc/tree/master](http://github.com/jschementi/ironrubymvc/tree/master)

享受！

# singleton - COM+ Singleton 大量参考

> ID：265883
> 
> 赞同：1
> 
> 时间：2008-11-05T17:09:47.023
> 
> 标签：singleton, com+

我有一个 COM+ 数据服务，它被配置为使用最小和最大池大小为 1 的对象池。所以我有一个单例。在某些情况下，我的对象计数（引用此实例的客户端数量）超过 1 并稳步增加。实例创建和对其方法的一次调用被包装在 using stmt 中，因此该实例应正确返回到池中。同时发生这种情况，我看到一些网络问题（SQLServer 的传输级错误异常）。我怀疑那里可能存在一些相关性。

对象计数如何超过 1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T20:41:40.160

您将看到 JIT（即时激活）与对象池的效果。

使用 JIT，多个客户端可以引用同一个对象，并且所有方法调用都可以由同一个实例提供服务。每个客户端只保留对上下文对象的引用。调用方法后，如果该方法在上下文中设置了 Done 标志，则该对象与上下文断开连接并放回池中，以供来自另一个客户端的另一个方法调用使用。这可以节省资源，因为单个对象可以为许多客户端提供服务。

请参阅以下内容： [COM+ 即时激活概念](http://msdn.microsoft.com/en-us/library/ms686960(VS.85).aspx)

# tcl - 使用无线场景的错误模型没有丢包？

> ID：265886
> 
> 赞同：2
> 
> 时间：2008-11-05T17:10:31.530
> 
> 标签：tcl, simulation, wireless, ns2

我正在尝试将 ns2 中的错误模型与无线链接一起使用，我正在使用 ns2.33。我尝试了统一误差模型和马尔可夫链模型。ns 没有错误，但是当我试图找到由于损坏而丢弃的数据包时，我无法使用统一或马尔可夫模型找到它们中的任何一个。因此，如果我在使用错误模型时出现任何错误，请帮助我。

搜索我正在使用的丢弃数据包

> eid@eid-laptop:~/code/ns2/noisy$ cat mixed.tr | grep d

这是一个完整的代码：

```
### This simulation is an example of combination of wired and wireless
### topologies.
#-------------------------------------------------------------------------------
#defining a new hashtable to store values
global opt
set adhocRouting   DSDV
set stop           350
set num_wired_nodes      1
set num_bs_nodes         1
set num_wireless_nodes             2
set x    300
set y    300
#-------------------------------------------------------------------------------

proc plotWindow { tcpSource file } {
global ns_
set time 0.1
set now [$ns_ now]
set cwnd [$tcpSource set cwnd_]
set wnd [$tcpSource set window_]
puts $file "$now $cwnd"
$ns_ at [expr $now+$time] "plotWindow $tcpSource $file"
}

proc wireless_node_config {ns topo em} {
  $ns node-config -adhocRouting DSDV \
                 -llType LL \
                 -macType Mac/802_11 \
                 -ifqType Queue/DropTail/PriQueue \
                 -ifqLen 50 \
                 -antType Antenna/OmniAntenna \
                 -propInstance [new Propagation/TwoRayGround] \
                 -phyType Phy/WirelessPhy \
                 -channel [new Channel/WirelessChannel] \
                 -topoInstance $topo \
                 -wiredRouting ON \
                 -agentTrace ON \
                 -routerTrace OFF \
                 -macTrace OFF \
@@                 -outgoingErrProc $em
@@                 -incomingErrProc $em

}

proc nam {ns namFile trFile namOutFile} {
    $ns flush-trace
    close $namFile
    close $trFile
    puts "running nam..."
#    exec nam $namOutFile &
    puts "I am in nam"
}
proc finish { } {
    exit 0
}
#-------------------------------------------------------------------------------
# The global simulator instance
set ns_   [new Simulator]
#-------------------------------------------------------------------------------
#Hierarchical routing is needed to in mixed environments
#each of wireless and wired environment must be in seperated domains
#so at least we want 2 domains

# set up for hierarchical routing
$ns_ node-config -addressType hierarchical
AddrParams set domain_num_ 2
lappend cluster_num 1 2
AddrParams set cluster_num_ $cluster_num
lappend eilastlevel 1 1 2
AddrParams set nodes_num_ $eilastlevel
#-------------------------------------------------------------------------------
#set the Topology
set topo   [new Topography]
$topo load_flatgrid x y

# god needs to know the number of all wireless interfaces
create-god [expr $num_wireless_nodes+$num_wired_nodes]
#-------------------------------------------------------------------------------
#trace output file
set trFile  [open mixed.tr w]
$ns_ trace-all $trFile

# nam output files
set namFile [open mixed.nam w]
$ns_ namtrace-all $namFile
$ns_ namtrace-all-wireless $namFile x y

#xgraph output files
set x0 [open xgraph0.tr w]

#extra files
set cwndFile [open cwndFile.wtc w]
#-------------------------------------------------------------------------------
#Define different colors for data flows (for NAM)
$ns_ color 1 Blue
$ns_ color 2 Red
$ns_ color 3 Green
#-------------------------------------------------------------------------------
@@#creating the error model
@@set m1_ubstate 27.0
@@set m1_bstate 12.0
@@set m2_ubstate 0.4
@@set m2_bstate 0.4
@@set durlist "$m1_ubstate $m1_bstate $m2_ubstate $m2_bstate"
@@set errmodel [new ErrorModel/ComplexTwoStateMarkov $durlist time]
@@$errmodel unit packet
@@$errmodel drop-target [new Agent/Null]

#the option below is for wired links, there is no links in wireless environment

#$ns_ link-lossmodel $loss_module $BS(0) $node_(0)
#-------------------------------------------------------------------------------
#Creating the nodes

    # The wired nodes
set addresses {0.0.0 1.0.0 1.1.0 1.1.1}
set W(0) [$ns_ node [lindex $addresses 0]]
    #The wireless nodes
wireless_node_config $ns_ $topo $errmodel
set BS(0) [$ns_ node [lindex $addresses 1]]

$ns_ node-config -wiredRouting OFF
        #base stations nodes
$BS(0) random-motion 0

        #mobile nodes
  for {set j 0} {$j < [expr $num_wired_nodes + $num_bs_nodes]} {incr j} {
    set node_($j) [ $ns_ node [lindex $addresses [expr $j+2]] ]
    #attach nodes to base station
    $node_($j) base-station [AddrParams addr2id [$BS(0) node-addr]]
  }

# End Creating the Nodes
#-------------------------------------------------------------------------------
# Positioning the nodes
  $BS(0) set X_ 50.0
  $BS(0) set Y_ 50.0
  $BS(0) set Z_ 0.0
  $node_(0) set X_ 0.0
  $node_(0) set Y_ 0.0
  $node_(0) set Z_ 0.0
  $node_(1) set X_ 100.0
  $node_(1) set Y_ 0.0
  $node_(1) set Z_ 0.0
#-------------------------------------------------------------------------------
#create links between wired and BS nodes
$ns_ duplex-link $W(0) $BS(0) 2Mb 2ms DropTail down
$ns_ duplex-link-op $W(0) $BS(0) orient down
$ns_ queue-limit $W(0) $BS(0) 2020Mb
#$ns_ duplex-link-op $W(0) $BS(0) queuePos 0.5
#-------------------------------------------------------------------------------

#Sizing the mobile nodes this will make them appear in NAM
for {set i 0} {$i < $num_wireless_nodes} {incr i} {
      $ns_ initial_node_pos $node_($i) 10
   }
#-------------------------------------------------------------------------------
# setup TCP connections
  set tcp1 [new Agent/TCP/Newreno]
  $tcp1 set class_ 2
  set sink1 [new Agent/TCPSink/DelAck]
  $ns_ attach-agent $W(0) $tcp1
  $ns_ attach-agent $node_(0) $sink1
  $ns_ connect $tcp1 $sink1
  set ftp1 [new Application/FTP]
  $ftp1 attach-agent $tcp1
#-------------------------------------------------------------------------------
#time line scenario.
$ns_ at 1.5 "$ftp1 start"
$ns_ at [expr $stop-10] "$ftp1 stop"

#reset nodes after finishing
for {set i 0} {$i < $num_wireless_nodes } {incr i} {
      $ns_ at $stop.000000 "$node_($i) reset";
  }
$ns_ at $stop.000000 "$BS(0) reset";

puts "Starting Simulation..."
$ns_ at 0.1 "plotWindow $tcp1 $cwndFile"
$ns_ at $stop.1 "nam $ns_ $namFile $trFile mixed.nam"
$ns_ at $stop.2 "finish"
#-------------------------------------------------------------------------------
$ns_ run 
```

您还可以[在此处找到相同的代码](http://pastebin.com/f68749435)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-05T19:40:45.673

尝试：

```
grep d mixed.tr 
```

# python - Django 表单，在 ModelMultipleChoiceField 上显示错误

> ID：265888
> 
> 赞同：1
> 
> 时间：2008-11-05T17:10:57.287
> 
> 标签：python, django, validation, forms

我在获取验证错误消息以显示 Django 表单中的特定字段时遇到问题，其中有问题的字段是**ModelMultipleChoiceField**。

在`clean(self)`表单的方法中，我尝试将错误消息添加到字段中，如下所示：

```
msg = 'error'
self._errors['field_name'] = ErrorList([msg])
raise forms.ValidationError(msg) 
```

这在 'field_name' 指向其他字段类型的情况下可以正常工作，但对于 ModelMultipleChoiceField 它不会显示。这应该以不同的方式处理吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-12T10:37:18.067

是的，听起来你做错了。

您应该改用[clean_](http://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-a-specific-field-attribute)方法。通读整份文件，事实上——它的信息量很大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T17:19:27.147

为什么要实例化一个 ErrorList 并直接写入 self._errors ？调用“raise forms.ValidationError(msg)”已经解决了所有这些问题。

你的模板是什么样的？

# c# - 如何删除只读文件？

> ID：265896
> 
> 赞同：72
> 
> 时间：2008-11-05T17:13:07.830
> 
> 标签：c#, .net, file

我有一个垃圾目录，我把下载、一次性项目、电子邮件草稿和其他各种可能在几天内有用但不需要永远保存的东西扔在里面。为了阻止这个目录接管我的机器，我编写了一个程序，该程序将删除所有超过指定天数的文件，并记录一些有关已删除文件数量及其大小的统计信息，只是为了好玩。

我注意到一些项目文件夹的寿命比他们应该的要长，所以我开始调查。特别是，我使用过 SVN 的项目的文件夹似乎一直存在。事实证明，.svn 目录中的只读文件没有被删除。我只是对一个只读文件做了一个简单的测试，发现`System.IO.File.Delete`并`System.IO.FileInfo.Delete`不会删除一个只读文件。

我不关心保护这个特定目录中的文件；如果里面有重要的东西，那就是在错误的地方。是否有一个可以删除只读文件的 .NET 类，还是我必须检查只读属性并剥离它们？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2008-11-05T17:23:24.237

根据[File.Delete 的文档，](http://msdn.microsoft.com/en-us/library/system.io.file.delete.aspx)您必须去除只读属性。[您可以使用File.SetAttributes()](http://msdn.microsoft.com/en-us/library/system.io.file.setattributes.aspx)设置文件的属性。

```
using System.IO;

File.SetAttributes(filePath, FileAttributes.Normal);
File.Delete(filePath); 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-11-05T17:19:14.120

根据[File.Delete 的文档，](http://msdn.microsoft.com/en-us/library/system.io.file.delete.aspx)您必须去除只读属性。[您可以使用File.SetAttributes()](http://msdn.microsoft.com/en-us/library/system.io.file.setattributes.aspx)设置文件的属性。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-11-29T12:21:08.737

如果您碰巧正在使用`FileInfo`对象，则等效项是：

```
file.IsReadOnly = false;
file.Delete(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T17:15:42.770

为什么需要检查？只需强行清除只读标志并删除文件即可。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T17:18:29.160

嗯，我想我宁愿把

```
>del /F * 
```

进入一个固定的任务。可能由批处理文件包装以记录统计信息。

我错过了什么吗？

# php - mod_rewrite、php 和 .htaccess 文件

> ID：265898
> 
> 赞同：5
> 
> 时间：2008-11-05T17:13:25.330
> 
> 标签：php, .htaccess, mod-rewrite

我正在编写一个小型 CMS，以更好地了解它们的工作原理并学习一些关于 PHP 的新知识。然而，我遇到了一个问题。

我想使用 mod_rewrite （尽管如果有人有更好的解决方案我愿意尝试）来生成漂亮干净的 URL，所以 site.com/index.php?page=2 可以改为 site.com/tools

据我了解，每次添加新页面时我都需要更改 .htaccess 文件，这是我遇到问题的地方，我的 PHP 一直告诉我无法更新它，因为它没有权限。一点点 chmod 显示，即使有 777 权限它也不能这样做，我错过了什么吗？

我的 mod_rewrite 指令来源目前是[这里的这个页面，](http://wettone.com/code/clean-urls)以防它很重要/有用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-05T17:23:10.600

一种方法是将所有内容重写为处理脚本

```
RewriteEngine on
RewriteBase /

# only rewrite if the requested file doesn't exist
RewriteCond %{REQUEST_FILENAME} !-s 

# pass the rest of the request into index.php to handle     
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

所以如果你有一个请求[http://yourserver/foo/bar/](http://yourserver/foo/bar/)

您实际得到的是对[http://yourserver/index.php/foo/bar](http://yourserver/index.php/foo/bar)的请求- 您可以让 index.php 决定如何处理 /foo/bar （使用 $_SERVER['PATH_INFO'] - [tom](https://stackoverflow.com/users/22224/tom) )

您只需在第一次修改 .htaccess 即可。然后可以在 PHP 中处理所有未来对不存在文件的请求。

您可能还会发现[mod_rewrite 的文档](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)很有用 - 但请保持简单或准备失去大量睡眠和头发追踪晦涩的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T17:26:52.013

您的 PHP 应该由于非常明显的原因无法修改`.htaccess`. 即使你让它发挥作用，我也不确定它是否明智。

关于 mod_rewrite 规则使用更抽象的设置怎么样？定义您想要使用的一般 URL 模式。例如：

```
/对象/动作/id

```

然后编写一组规则，将 HTTP 请求重新路由到 PHP 页面，从而决定运行哪个页面（例如，通过包含相关的 PHP 脚本）。

```
RewriteRule ^/(\w+)/?(\w+)?/?(\d+)?$ /index.php?object=$1&action=$2&id=$3 [nocase]

```

这样您就不必`.htaccess`经常更新并且仍然很灵活。

# memory - 从 SafeArrayGetElem 调用中释放内存？

> ID：265902
> 
> 赞同：0
> 
> 时间：2008-11-05T17:14:32.863
> 
> 标签：memory, com, malloc, native

我在 C# 中有一些代码，它有一个 com 包装器。此 com 包装器用于本机 c++ 应用程序。c++ 代码使用一种方法，该方法从 c# 库中返回一个类的实例数组。实例来自 SafeArray，如下所示：

```
for (long i =min; i<=max;i++)
    {   
        IMyInterface *l = (IMyInterface *)malloc(sizeof IMyInterface );

        SafeArrayGetElement(array,&i, &l);
    <other code>

    } 
```

我想释放为实例 l 分配的内存，但是如果我调用

```
free(l) 
```

然后我崩溃了。

我试过了

```
VariantClear ((VARIANT*)l); 
```

并使用

```
SafeArrayDestroy(array) 
```

但我仍然为数组中的每个实例泄漏 4 个字节。

任何想法我应该如何去释放这个记忆？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-05T17:34:47.927

这段代码看起来有点混乱：您将“sizeof IMyInterface”传递给 malloc()，这将是 IMyInterface 实例在内存中的大小，而不是指向它的指针：如果您很可能是指“sizeof IMyInterface*”想为指针分配内存。

然而，看着它，这也没有任何意义：你不做 malloc() 不是更好吗？SafeArrayGetElement() 的最后一个参数是指向将保存结果的内存的指针，因此 l 的内容（malloc() 返回的指针）将被覆盖（这就是 free() 给你崩溃的原因）。换句话说，这应该有效：

```
IMyInterface *l;
SafeArrayGetElement(array,&i, &l); 
```

在不确切知道数组中的内容的情况下，很难确定，但看起来您对指针和它们指向的对象之间的差异的旧 C/C++ 问题感到困惑。

# uml - 用例流程

> ID：265903
> 
> 赞同：0
> 
> 时间：2008-11-05T17:14:33.490
> 
> 标签：uml, use-case

如果用例 A 扩展了用例 B，这是否意味着 A 已完成并且流程转移到 B 或流程将返回到 A？

UML 对此有任何限制吗？还是取决于建模者？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T17:30:59.133

用例术语中的“扩展”*不是顺序控制流关系*；“A 扩展 B”意味着在某些情况下*，除了*用例 B 之外，还会出现用例 A。用例 B 可以独立，用例 A 不能（因为它依赖于 B）。用例 A 出现在用例 B 的“扩展点”上。

请查看[定义](http://publib.boulder.ibm.com/infocenter/rsmhelp/v7r0m0/index.jsp?topic=/com.ibm.xtools.modeler.doc/topics/cextend.html)听起来有些混乱

# tcl - 如何通过无线连接监控流量？

> ID：265914
> 
> 赞同：2
> 
> 时间：2008-11-05T17:16:44.967
> 
> 标签：tcl, simulation, wireless, ns2

我正在尝试使用流监视器监视 tcp 流。attach-fmon 需要在无线连接中不可用的链接对象。我怎么解决这个问题 ？还有其他解决方案吗？

我的代码在这里 [http://pastebin.com/f59241692](http://pastebin.com/f59241692)

我收到此错误消息

```
eid@eid-laptop:~/code/ns2/noisy$ ns mixed.tcl
num_nodes is set 3
INITIALIZE THE LIST xListHead
invalid command name ""
    while executing
"$lnk attach-monitors $isnoop $osnoop $dsnoop $fm"
    (procedure "_o3" line 5)
    (Simulator attach-fmon line 5)
    invoked from within
"$ns_ attach-fmon $wllink $fmon"
    (file "mixed.tcl" line 182) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-20T21:28:41.787

Wireshark ( [http://wireshark.org](http://wireshark.org) ) 在 2006 年取代了 ethereal，是一个免费的开源网络协议分析器。它可以捕获和分析来自几乎任何网络接口的数据，并允许您通过过滤端口号等来过滤感兴趣的通信路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T19:57:39.213

我提醒您，我没有使用 ns（网络模拟器）的经验。显然，变量 $lnk 在 proc "o3" 的范围内具有值 "" ，这肯定是通过在某些时候调用 [new ...] 创建的“对象”，尽管不一定在您的代码中。在附加流量监控通道之前，您可能需要执行一些初始化 $ns_ 或其他对象之一。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-09T23:15:26.463

[Ethereal](http://www.ethereal.com/)是一个开源网络协议分析器。它应该能够分析和显示您的应用程序的通信流程。

# c# - 为什么 C# 中的多线程不能达到 100% CPU？

> ID：265919
> 
> 赞同：30
> 
> 时间：2008-11-05T17:19:08.533
> 
> 标签：c#, .net, multithreading, multicore

我正在开发一个处理许多请求的程序，它们都没有达到超过 50% 的 CPU（**目前我正在研究双核**）。所以我为每个请求创建了一个线程，整个过程更快。处理9个请求，单个线程持续02min08s，而3个线程同时工作时间减少到01min37s，但一直没有使用100%的CPU，只有50%左右。

我怎样才能让我的程序使用完整的处理器功能？

**编辑** 该应用程序不受 IO 或内存限制，它们始终处于合理的水平。

我认为这与“双核”有关。

每个请求都使用一个锁定的方法调用，但它真的很快，我不认为这是问题所在。

我的代码中 CPU 成本更高的部分是通过 COM 调用 dll（从所有线程调用相同的外部方法）。这个 dll 也没有内存或 IO 限制，它是一个 AI 识别组件，我正在对薪水进行 OCR 识别，对请求进行薪水检查。

**编辑2**

STA COM Method很可能是我的问题，我联系了组件所有者以解决此问题。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-05T17:39:38.790

您的应用程序中是否有大量锁定？如果线程彼此等待很多，这很容易解释。

除此之外（以及给出的其他答案），真的很难猜测。分析器是您的朋友...

编辑：好的，鉴于下面的评论，我认为我们正在做一些事情：

> 我的代码中 CPU 成本更高的部分是通过 COM 调用 dll（从所有线程调用相同的外部方法）。

是否有机会在 STA 中运行 COM 方法？如果是这样，它将只使用一个线程，序列化调用。我强烈怀疑这是它的关键。这类似于对该方法调用进行锁定（诚然，不完全相同）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-05T19:26:41.117

问题是 COM 对象。

大多数 COM 对象在“单线程单元”的上下文中运行。（您可能不时在 .NET 应用程序的 main 方法上看到 [STAThread] 注释？）

实际上，这意味着对该对象的所有分派都由单个线程处理。在问题上投入更多核心只会为您提供更多资源，让您可以坐下来等待或在 .NET 中做其他事情。

您可能想看看 Joe Duffy（Microsoft 的首席并行 .NET 人员）关于该主题的这篇文章。

[http://www.bluebytesoftware.com/blog/PermaLink,guid,8c2fed10-75b2-416b-aabc-c18ce8fe2ed4.aspx](http://www.bluebytesoftware.com/blog/PermaLink,guid,8c2fed10-75b2-416b-aabc-c18ce8fe2ed4.aspx)

在实践中，如果您必须像这样针对单个 COM 对象执行大量操作，您将被淹没，因为 .NET 只会在您背后内部序列化访问模式。如果您可以创建多个 COM 对象并使用它们，那么您可以解决问题，因为每个对象都可以从不同的 STA 线程创建和访问。这将一直有效，直到您达到大约 100 个 STA 线程，然后事情就会变得不稳定。有关详细信息，请参阅文章。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-05T17:22:57.560

它可能不再是完成您的流程的瓶颈的处理器。瓶颈可能已经转移到磁盘访问、网络访问或内存访问。您还可能遇到线程竞争锁的情况。

只有您确切地知道您的线程在做什么，因此您需要考虑以上内容来查看它们。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-05T17:23:13.940

这取决于你的程序做什么——你的并发请求执行的工作可能是 IO 限制的——受（例如）你的硬盘速度的限制——而不是 CPU 限制，当你看到你的 CPU 达到 100% 时。

编辑后，听起来 COM STA 对象可能是罪魁祸首。

所有线程都调用 COM 对象的同一个实例吗？是否可以让您的工作线程成为 STA 线程，并在每个线程上创建一个单独的 COM 对象实例。通过这种方式，可能可以避免 STA 瓶颈。

**判断 COM coclass 是否为 STA：**

```
class Test
{
  static void Main() //This will be an MTA thread by default
  {
    var o = new COMObjectClass();
    // Did a new thread pop into existence when that line was executed?
    // If so, .NET created an STA thread for it to live in.
  }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-11T02:50:42.343

我想我也有类似的问题。我在 c# 中创建了多个线程，这些线程通过 COM 接口运行 c++ 代码。我的双核 CPU 从未达到 100%。

看完这篇文章，我几乎放弃了。然后我尝试在我的线程上调用 SetApartmentState(ApartmentState.STA)。

仅更改此设置后，CPU 已达到极限。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T17:24:01.583

听起来您的应用程序的性能可能不受可用 CPU 资源数量的“限制”。如果您正在通过网络处理请求，CPU 可能正在等待数据到达，或等待网络设备传输数据。或者，如果您需要查找数据来满足请求，cpu 可能正在等待磁盘。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-05T17:29:54.300

您确定您的任务需要密集的处理器活动吗？有IO处理吗？这可能是您的 50% 负载的原因。

测试：尝试仅使用 2 个线程并为每个核心设置每个线程的亲和性。然后打开任务管理器并观察两个核心的负载。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-05T17:34:00.860

这不是一个真正的答案，但是您是否检查过 perfmon 以查看它正在使用哪些资源并在代码上运行分析器以查看它在哪里花费时间？

您如何确定 IO 或其他非 CPU 资源不是瓶颈？

你能简要描述一下线程在做什么吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-05T18:01:57.527

如果您的进程在 cpu 0 上运行并在那里产生线程，那么它将达到的最大值为 50%。查看您是否在两个内核上或仅在一个内核上运行线程。我冒昧地猜测您被隔离到单个核心，或者您的一个依赖资源被锁定在单个核心上。如果它恰好达到 50%，那么单核很可能是您的瓶颈。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-05T20:19:47.937

所以你解决了使用单个 COM 对象的问题，现在遇到了 IO 问题。

多线程的运行时间增加可能是因为将随机 IO 混合在一起，这会减慢速度。

如果数据集适合 RAM，请尝试查看是否可以将其预取到缓存中。也许只是读取数据，或者内存映射它与命令一起使其可用。

这就是为什么 SQL 数据库通常会在您意想不到的查询上选择顺序表扫描而不是索引扫描的原因：按顺序读取所有数据要比按随机块读取要快得多。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-05T20:23:14.170

也许我误解了一些东西，但你说你的请求（每个请求都在一个单独的线程中）都没有达到 100% 的 CPU。

您使用什么操作系统？

我似乎隐约记得在旧版本的 Windows 中（例如，早期的 XP 和 2000 年代），CPU 利用率是从总共两个处理器中考虑的，因此单个线程无法使其超过 50%，除非它是空闲进程..

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-06T10:57:23.110

还有一点需要注意，您是否尝试过不从 Visual Studio 启动代码（无论发布/调试设置如何）？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-07T16:41:43.837

问题是 COM 对象。它是 STA，我不能在同一个进程上同时运行两个实例。当我为 COM 类创建一个实例时，另一个变得不可用。

我已经联系了组件开发人员，他们正在考虑可以为我做些什么。

谢谢大家；）

# sql-server - 围绕缺乏跨数据库外键引用的 SQL 设计

> ID：265921
> 
> 赞同：21
> 
> 时间：2008-11-05T17:19:17.347
> 
> 标签：sql-server, database, foreign-keys

无论好坏，我们都有一个依赖于多个数据库的解决方案，这些数据库都引用了一个通用的管理数据库。数据库作为模块的一部分提供，并非所有模块都需要安装（这可能是我们首先拥有多个数据库的原因）。需要管理数据库，但是......所以它会一直存在。

我想为混乱带来一些参照完整性和秩序，但由于 SQL Server 无法执行跨数据库外键而受到阻碍。数据库中没有很多流失，但信息将由（咳咳）非技术用户插入/更新。

我看到的选择是：

a）使用触发器强加伪外键（好的，但有点工作）

b）使用触发器从管理员复制到其他数据库（灾难的明确秘诀）

c) 在代码/DAL 中强加伪外键（与 ORM 不兼容）

d) 不要在 DB 级别担心它，使用良好的 UI 设计来确保没有人做任何愚蠢的事情并限制直接 SQL 访问的访问/屏住呼吸。

坦率地说，我倾向于选择“D”，但我认为我会比我更聪明地寻求意见......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T17:21:57.937

我们有完全相同的问题，坦率地说，这很糟糕。我们发现唯一有效的解决方案是选项 D，并使用业务层来尝试保持同步（包含在事务中等）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T17:27:33.430

假设每个模块都设置为与管理数据库链接，您可以通过为每个模块数据库中的管理表设置视图来简化事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T18:06:05.537

We have such a modularity in our products, but our database requirements are merged together during installtion. For example our admin package and product A may be the initial purchase by a client where they install the two modules into database X. If they later buy product B the database component is layered right on top of database X adding in the DRI where necessary.

The only case where I have seen the need for separate databases from a design perspective is when you are drawing a hard line between business units (such as a corporation) at which point the issue is really a type of partitioning. Great Plains Dynamics does this where they have a single administrative database, and multiple corporation databases. However each module in GP for a given corporation resides in that single database.

Of course if you are stuck with separate databases, I would agree that D is the best option.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T17:54:17.200

Depending on your database implementation, often you will be able to link tables from another database (the AdminDB) and have them appear in your various module databases.

In Microsoft Access you can link tables by right clicking, and then choosing an ODBC data source. In [Oracle they call it a database link](http://download.oracle.com/docs/cd/B14117_01/server.101/b10759/statements_5005.htm#SQLRF01205). I'm willing to bet [SQLServer has some form of this implementation](http://database.ittoolbox.com/groups/technical-functional/sql-server-l/connecting-to-different-sql-server-t-sql-52929) short of implementing custom replication on a single table.

Once you link in your foreign admin tables to your module databases (or vice versa), then you should be able to define constraints as if the tables were within the same schema.

A second option may be even simpler. What if you used the same schema for all modules and admin database? You know the admin database is present, so simply run the table creation script against that schema. As long as there is no table / view / stored procedure naming conflicts, then it should all work just by changing the dblogin in all modules to match.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T22:07:51.010

您可以在架构上以多种方式解决此问题，以便通过中央服务汇集所有更改，这样它们就不会产生不一致，但无论您愿意为此付出多少努力（并造成瓶颈或单一故障点可能会违反您拥有的其他一些要求）您将无法像使用 FK 约束一样依靠数据库引擎本身来保证执行它。

我经常不得不在跨部门的数据库情况下处理这个问题，因为不同的系统还没有完全集成，或者安全问题需要他们有单独的管理员，所以事情可能会不同步。

在这些情况下，我通常依靠每小时生成的异常报告来检查事物的状态并仅在出现问题时报告。SQL Server 代理作业具有强大的调度功能。我总是使用日志表和 SQLAnswersMail 来生成漂亮的小 HTML 电子邮件（电子邮件中的 URL 链接甚至可以将您带到管理页面以纠正问题）给各种系统管理员，但是有很多方法可以给这只猫剥皮。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T21:23:30.380

您应该实现面向服务的体系结构。系统中的不同服务使用它们的数据库模式运行。然后让您的应用程序独立于任何数据库运行，但让它们针对服务运行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-05T18:22:11.417

我想这取决于您的应用程序的重要性。如果该管理数据库出现故障，您是否希望以可能有限的方式继续操作。如果你说，没办法，如果管理员关闭，整个应用程序应该立即停止，而不是到目前为止所说的一切都很好。

如果您说，“哎呀，没有管理数据库仍然可以完成很多工作。” 那么我会问，为什么你认为单向复制如此奇特，以至于它显然是灾难的根源？

制作表格的副本根本不是火箭科学。事实上，它就像复制你的房子钥匙一样简单。母版中的每一个波峰和波谷，都被传送到一个成型坯料的切割轮上。多主复制的神奇之处在于，如果您开始允许远程数据库对来自管理数据的数据进行更改，那么您就开启了一个严肃的设计考虑。

我并不是说这是要走的路，你必须先回答我最初的问题。在那之后，如果你确实想继续运营……不要低估复制的可行性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-05T18:32:11.897

我想知道SQL Server 是否有像Oracle 的物化视图这样的特性？这是您使用查询（如视图）定义的对象，但查询的结果存储为表。然后有各种自动刷新的机制。

如果有这样的功能，我建议对每个卫星数据库中的核心表进行物化视图。然后你可以在你的外键中引用它。主要问题是它是否可以足够频繁地刷新以满足您的需求。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-07-16T19:21:25.977

我认为有趣的事情.. 是您可以制作数据库的小型 MS Access 副本，在 Access 中强制执行 RI.. 然后升级，Microsoft Access 让您可以选择使用触发器或 DRI.. 我'我很确定 Microsoft Access 将为您编写触发器的核心部分。

当我们讨论这个话题时，我讨厌 MS Access.. 但 Access 的优势之一是您可以针对 QUERY（sql 选择，又名视图）强制执行 RI。我真的希望 MS SQL Server 有相同的功能。

# http - URL中的参数和参数之间有什么区别吗？ ?

> ID：265923
> 
> 赞同：6
> 
> 时间：2008-11-05T17:20:13.180
> 
> 标签：http, url, limits

现在，我知道 URL 中的参数和 POST 参数之间的区别：如果 URL 太长，某些浏览器可能会出现异常，因此在 URL 中填充数百个参数不是一个好主意，即使您的应用程序可以响应一个 GET 请求。

为了便于讨论，让我们假设以下 Web 应用程序：用户可以输入一系列（可能数百个）X、Y 坐标。服务器将它们绘制在一个图表中，该图表作为图像返回。

这显然是一个[幂等操作](http://en.wikipedia.org/wiki/Idempotent)的示例，因此，根据[HTTP 规范](http://www.w3.org/Protocols/rfc2616/rfc2616.html)，建议将其实现为 GET 操作。但是，您无法构建包含所有参数的 URL，因为它会太长。<form method="get"> 可以处理那么多参数吗？

我还听说 <form method="get"> 完全等同于在 URL 中放置参数？现在，对于某些浏览器或整个 HTTP 协议是这样吗？请求是否有最大长度？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T17:26:01.267

HTTP 规范没有设置限制，但浏览器和服务器会这样做。具体见[这里](http://www.boutell.com/newfaq/misc/urllength.html)。

如果表单的方法设置为 GET，浏览器将创建一个长 URL，因此上述限制适用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T17:44:54.830

[HTTP 规范](http://www.greenbytes.de/tech/webdav/rfc2616.html)没有明确要求将 GET 请求的参数放入 URI 。在 GET 请求中发送消息体是合法的，比如使用 POST 的表单。

然而，浏览器以这种方式实现 GET 表单有一个很好的理由：缓存。GET 请求预计将在服务器上处理而没有副作用。因此对 GET 请求的响应可能会被缓存。如果您开始在 GET 请求上使用消息体，则此性能改进选项会立即丢失。

如果你打算设计一个图表 API，你可能想看看[Google](http://code.google.com/apis/chart/)。他们已经向公众提供了一个非常好的产品。即使只是为了学习如何将尽可能多的信息打包到 URI 参数中，也值得一看。

![替代文字](https://chart.apis.google.com/chart?cht=lc&chs=200x100&chd=s:formostthisamazingdayfortheleapinggreenlformostthisamazingdayfortheleapinggreenl&chxt=x,y&chxl=0:|Apr|May|June|1:||50+Kb) ![替代文字](https://chart.apis.google.com/chart?cht=lxy&chs=200x125&chd=t:0,30,60,70,90,95,100|20,30,40,50,60,70,80|10,30,40,45,52|100,90,40,20,10|-1|5,33,50,55,7&chco=3072F3,ff0000,00aaaa&chls=2,4,1&chm=s,FF0000,0,-1,5|s,0000ff,1,-1,5|s,00aa00,2,-1,5) ![替代文字](https://chart.apis.google.com/chart?cht=p3&chd=s:Uf9a&chs=250x100&chl=January|February|March|April) ![替代文字](https://chart.apis.google.com/chart?cht=r&chs=200x200&chd=s:voJATd9v,MW9BA9&chco=FF0000,FF9900&chls=2.0,4.0,0.0|2.0,4.0,0.0&chxt=x&chxl=0:|0|45|90|135|180|225|270|315&chxr=0,0.0,360.0&chg=25.0,25.0,4.0,4.0&chm=B,FF000080,0,1.0,5.0|B,FF990080,1,1.0,5.0|h,0000FF,0,1.0,4.0|h,3366CC80,0,0.5,5.0|V,00FF0080,0,1.0,5.0|V,008000,0,5.5,5.0|v,00A000,0,6.5,4)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T17:23:30.427

您的浏览器实际上所做的是从表单输入构建一个非常长的 url。因此 URL 和表单 Method="GET" 之间没有区别。任何一个都将导致加载相同的 URL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T17:27:52.837

form method=get 将把所有表单的输入放到 URL 中。

浏览器确实有 URL 的最大长度。它从浏览器更改为浏览器，当然也从浏览器版本更改为浏览器版本。

如果可以的话，我建议您使用 POST 作为您的表单。

高温高压

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T17:28:32.913

GET 和 url ?name=value&... 是一回事，因为浏览器只是在发送请求之前将 GET 表单转换为 URL。

URL 的最大长度在浏览器和服务器级别确定，因此对于给定的浏览器/服务器，它是两者中较小的一个。

[这篇文章](http://www.boutell.com/newfaq/misc/urllength.html)有一个很好的 URLS 当前最大长度列表

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T17:38:11.367

不，服务器看不到将参数放入 URL 和使用带有 GET 方法的 FORM 之间的区别。因此，如果带有参数的给定 URL 太长，则使用带有 GET 方法的 FORM 将无济于事。

应该选择 POST 或 GET 主要是因为它们的语义。GET 用于“安全”操作。也就是说，用户不应对 GET 请求执行的操作负责。POST 方法用于需要用户负责的操作。

例如，当搜索功能使用 POST 时，这非常令人沮丧。用户不希望一个简单的查询改变任何重要的系统状态——他们希望搜索是一个“安全”的操作。

另一方面，由于可以通过 GET 请求和 POST 访问不安全的操作，因此存在许多漏洞。这会导致 XSRF 等漏洞，攻击者只需将恶意“src”URL 获取到合法站点上的 IMG 标记中即可。

对于您的用例，Ajax 实际上可能是一个合适的解决方案。您可以为每个选定的点发出 GET 请求，将它们存储在服务器的会话中。当用户完成输入点时，最终的 GET 请求会检索完成的产品。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-05T17:27:50.077

> 我还听说 <form method="get"> 完全等同于在 URL 中放置参数？

没错，这里是对应的[RFC部分](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3)

> 请求是否有最大长度？

[规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.2)说“ HTTP 协议没有对 URI 的长度施加任何先验限制。”

但是 Internet Explorer 6 有 2,083 个字符的限制。其他浏览器允许更多字符，但如果你走那条路，你基本上必须为 ie6 设计

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-05T17:37:10.993

这不是您关于获取和发布问题的答案，但在您所描述的情况下，将更复杂的数据存储在服务器上并将其与会话 ID 或用户帐户相关联而不是放置它通常更容易每次进入网址。然后，您可以在 cookie 中仅使用该会话的标识符或作为 url 参数来检索图像。

这也可以帮助您缓存请求的图像，这样您就不必在每次用户想要再次查看特定图表时都重新生成它们。

# vba - Excel中的圆形函数，工作表函数与VBA

> ID：265926
> 
> 赞同：3
> 
> 时间：2008-11-05T17:20:41.730
> 
> 标签：vba, excel, excel-2007, worksheet-function

我有一个应用程序，用于返回与大量值中的某些值最接近的匹配项（如我之前的[问题](https://stackoverflow.com/questions/220966/lookup-data-in-excel)中所示），我选择了 VBA 解决方案。在使用上述应用程序的过程中，我观察到值 0.5 的结果不正确。我一直在使用 VBA Round 函数，我发现它返回 0 表示 0.5 舍入为整数，而工作表舍入函数返回 1。奇怪的是，VBA 舍入函数返回 2 表示 1.5。我不得不用工作表函数代替 VBA 函数。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T17:26:21.780

这是一个已知问题。VBA Round() 函数使用银行家的舍入，而电子表格单元格函数使用算术舍入。在此处查看详细信息：

[PRB：VBA 6 和 Excel 电子表格中的舍入函数不同](http://support.microsoft.com/kb/194983)

微软提出的解决方法是编写一个自定义函数来获得想要的结果。

*银行家的四舍五入*总是将 0.5 舍入到最接近的*偶数*，并且是会计标准，这就是 Excel 以这种方式工作的原因。*算术舍入将*0.5 舍入到下一个数字。

# c# - 显示未聚焦的新 WinForms 窗口

> ID：265930
> 
> 赞同：4
> 
> 时间：2008-11-05T17:22:24.970
> 
> 标签：c#, winforms

我正在生成并在主窗口顶部显示一个新的 WinForms 窗口。如何实现原始（主窗口）保持焦点？在显示新窗口后重新设置焦点并不能解决我的问题，因为我需要防止主窗口的标题栏闪烁。新窗口必须保持在主窗口的顶部，所以我必须设置 topMost=true。但是，这对我认为的问题没有影响。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T17:37:59.290

在显示新表单后设置焦点可以正常工作。我的任务栏不闪烁。

```
private void button1_Click(object sender, EventArgs e)
{
     Form2 f2 = new Form2();
     f2.TopMost = true;
     f2.Show();
     this.Focus();            
} 
```

请问您为什么要将焦点重新设置在主窗体上，因为默认情况下，新窗体将在主窗口顶部绘制，您必须关闭或移动新窗体才能查看主窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T18:35:19.143

如果您尝试实现类似于 Office 2007 中的“超级”工具提示的功能，则最好使用已经执行此操作的第三方库。另一种选择可能是将窗口创建为 NativeWindow 并使用互操作调用与其交互。

# c# - 在 Lucene 中索引多个表

> ID：265941
> 
> 赞同：1
> 
> 时间：2008-11-05T17:23:52.987
> 
> 标签：c#, database, search, lucene, lucene.net

我想使用 lucene.net 来索引我们数据库中的记录。记录存储在几个不同的表中，并通过记录表绑定在一起。单独索引每个表并在代码中将搜索结果捆绑在一起会更好，还是应该将来自数据库的记录捆绑在一起并将它们全部放在一个索引中？

任何其他建议也会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T19:34:36.670

如果您创建一个对应于每个表的 Lucene 索引，那么 1) 您将不得不针对每个索引执行搜索工作，以及 2) 以某种神奇的方式合并搜索结果。Lucene 已经设置为搜索具有多个字段的文档（请参阅 MultiFieldQueryParser），并为您提供统一的结果集。

即使您在创建索引后决定偶尔只想根据来自单个表的数据进行搜索，您也可以使用普通的 QueryParser 仅搜索文档的相应字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T17:45:04.317

Lucene 不依赖于数据库表，您可以在 Lucene 文档中选择所需的信息。我可能会更好让 Lucene 处理结果的合并和排名，而不是自己做。

# mercurial - 在 Mercurial 上退出向后合并

> ID：265944
> 
> 赞同：77
> 
> 时间：2008-11-05T17:25:11.050
> 
> 标签：mercurial, merge, dvcs, branch

你如何在不痛苦的情况下扭转合并对极化分支的影响？

这个问题困扰了我好**几个月**，终于放弃了。

您有 1 个存储库，有 2 个 **命名**分支。A和B。

发生在 A 上的变化将不可避免地发生在 B 上。

直接发生在 B 上的更改绝不能发生在 A 上。

在这样的配置中，将“B”合并到“A”中会在存储库中产生一个可怕的问题，因为对 B 的所有更改都出现在 A 中，就好像它们是在 A 中进行的一样。

从这种情况中恢复的唯一“正常”方法似乎是“退出”合并，即：

```
 hg up -r A 
 hg backout -r BadMergeRev --parent BadMergerevBeforeOnA 
```

看起来一切都很好而且花花公子，直到你决定稍后在正确的方向上合并，你最终会发生各种令人讨厌的事情，并且在专门的分支 B 上被删除/注释掉的代码突然变得未删除或未注释。

到目前为止，除了“让它做它的事情，然后手动解决所有问题”之外，还没有一个可行的解决方案，老实说，这有点令人难以置信。

这是澄清问题的图像：

*[原图丢失]*

文件 C & E (或更改 C & E ) 必须只出现在分支 b 上，而不能出现在分支 a 上。此处的修订版 A9（分支 a，revno 9）是问题的开始。

修订 A10 和 A11 是“回退合并”和“合并回退”阶段。

修订版 B12 是反复无常的，错误地反复删除了一个不打算删除的更改。

这种困境引起了很多挫折和蓝烟，我想结束它。

### 笔记

尝试禁止反向合并发生可能是显而易见的答案，无论是使用钩子还是使用策略，我发现解决这个问题的能力相当高，而且发生这种情况的可能性很大，即使有对策，你仍然*必须*假设它不可避免地*会*发生，以便您可以在它发生时解决它。

### 详细说明

在模型中，我使用了单独的文件。这些使问题听起来很简单。这些仅代表可能是单独的行的*任意更改。*

此外，雪上加霜的是，分支 A 发生了重大变化，这留下了长期存在的问题“分支 A 中的更改是否与分支 B 中刚刚出现（并退出）的变化相冲突，这看起来像是一个变化改为在分支 A 上“

### 关于历史重写技巧：

所有这些追溯解决方案的问题如下：

1.  我们有 9000 个提交。
2.  因此，新鲜克隆需要半小时
3.  *如果在某处*甚至存在*一个*错误的存储库克隆，它就有可能重新与原始存储库联系，并再次将其撞毁。
**   每个人都已经克隆了这个存储库，现在已经过去了几天，正在进行提交。*   一个这样的克隆恰好是一个实时站点，所以“擦除那个并从头开始”=“大诺诺”*

 *（我承认，以上许多内容有点愚蠢，但它们不在我的控制范围内）。

唯一可行的解​​决方案是假设人们*可以*并且*将会*做错所有事情，并且有一种方法可以“消除”这种错误。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2010-01-19T11:46:42.393

我想我找到了一个解决方案，它可以永久修复错误的合并，并且不需要您手动检查任何差异。诀窍是回到历史并生成与错误合并并行的提交。

所以我们有一个存储库，每个维护版本的单个产品都有单独的分支。就像问题中提出的情况一样，在早期版本的分支上所做的所有更改（即该版本中的错误修复）最终都必须全部合并到更高版本的分支中。

所以具体来说，如果在 BRANCH_V8 上签入某些内容，则必须将其合并到 BRANCH_V9。

现在其中一位开发人员犯了以下错误：他将 BRANCH_V9 中的所有更改合并到 BRANCH_V8 中（即错误方向的合并）。此外，在那次糟糕的合并之后，他在注意到自己的错误之前执行了一些额外的提交。

所以情况如下图日志所示。

```
o BRANCH_V8 - 13 - 错误合并后的重要提交
|
o BRANCH_V8 - 12 - 从 BRANCH_V9 的错误合并
|\
| o BRANCH_V8 - 11 - 添加对 BRANCH_V8 的注释（即最后已知的良好状态）
| |
○ | BRANCH_V9 - 10 - 在 BRANCH_V9 上的最后一次提交
| |

```

我们可以按如下方式修复此错误：

1.  将本地目录更新到 BRANCH_V8 的最后一个良好状态：`hg update 11`
2.  创建最后一个良好状态的新孩子：
    1.  更改一些文件`$EDITOR some/file.txt`（这是必要的，因为 Mercurial 不允许空提交）
    2.  提交这些更改`hg commit -m "generating commit on BRANCH_V8 to rectify wrong merge from BRANCH_V9"`
        现在的情况如下：

        ```
        o BRANCH_V8 - 14 - 在 BRANCH_V8 上生成提交以纠正来自 BRANCH_V9 的错误合并
        |
        | o BRANCH_V8 - 13 - 错误合并后的重要提交
        | |
        | o BRANCH_V8 - 12 - 从 BRANCH_V9 的错误合并
        |/|
        ○ | BRANCH_V8 - 11 - 添加对 BRANCH_V8 的评论
        | |
        | o BRANCH_V9 - 10 - BRANCH_V9 上的最后一次提交

        ```

3.  将新生成的 head 与发生错误合并的修订版合并，并在提交之前丢弃所有更改。**不要简单地合并两个头，因为这样您也会丢失合并后发生的重要提交！**

    1.  合并：（`hg merge 12`忽略任何冲突）
    2.  丢弃所有更改：`hg revert -a --no-backup -r 14`
    3.  提交更改：`hg commit -m "throwing away wrong merge from BRANCH_V9"` 现在的情况如下：

        ```
        o BRANCH_V8 - 15 - 从 BRANCH_V9 丢弃错误的合并
        |\
        | o BRANCH_V8 - 14 - 在 BRANCH_V8 上生成提交以纠正来自 BRANCH_V9 的错误合并
        | |
        +---o BRANCH_V8 - 13 - 错误合并后的重要提交
        | |
        ○ | BRANCH_V8 - 12 - 从 BRANCH_V9 错误合并
        |\|
        | o BRANCH_V8 - 11 - 在 BRANCH_V8 上添加评论
        | |
        ○ | BRANCH_V9 - 10 - 在 BRANCH_V9 上的最后一次提交
        | |

        ```

    IE。BRANCH_V8 上有两个头：一个包含对错误合并的修复，另一个包含在合并后发生的 BRANCH_V8 上剩余的重要提交。

4.  合并 BRANCH_V8 上的两个头：
    1.  合并：`hg merge`
    2.  犯罪 ：`hg commit -m "merged two heads used to revert from bad merge"`

BRANCH_V8 上的最终情况现在得到纠正，如下所示：

```
o BRANCH_V8 - 16 - 合并两个用于从错误合并恢复的头
|\
| o BRANCH_V8 - 15 - 从 BRANCH_V9 丢弃错误的合并
| |\
| | o BRANCH_V8 - 14 - 在 BRANCH_V8 上生成提交以纠正来自 BRANCH_V9 的错误合并
| | |
○ | | BRANCH_V8 - 13 - 错误合并后的重要提交
|/ /
○ | BRANCH_V8 - 12 - 从 BRANCH_V9 错误合并
|\|
| o BRANCH_V8 - 11 - 在 BRANCH_V8 上添加评论
| |
○ | BRANCH_V9 - 10 - 在 BRANCH_V9 上的最后一次提交
| |

```

现在 BRANCH_V8 上的情况是正确的。剩下的唯一问题是从 BRANCH_V8 到 BRANCH_V9 的下一次合并将是不正确的，因为它也会合并到错误合并的“修复”中，这是我们在 BRANCH_V9 上不希望的。这里的技巧是在单独的更改中从 BRANCH_V8 合并到 BRANCH_V9 ：

*   首先合并，从 BRANCH_V8 到 BRANCH_V9，在错误合并之前 BRANCH_V8 上的正确更改。
*   合并错误中的第二次合并及其修复，并且无需检查任何内容，丢弃所有更改
*   第三次合并来自 BRANCH_V8 的剩余更改。

详细地：

1.  将您的工作目录切换到 BRANCH_V9 ：`hg update BRANCH_V9`
2.  在 BRANCH_V8 的最后一个良好状态下合并（即您为修复错误合并而生成的提交）。这种合并是像任何常规合并一样的合并，即。冲突应该像往常一样解决，不需要丢弃任何东西。
    1.  合并：`hg merge 14`
    2.  提交：`hg commit -m "Merging in last good state of BRANCH_V8"` 现在的情况是：

        ```
        @ BRANCH_V9 - 17 - 合并到 BRANCH_V8 的最后良好状态
        |\
        | | o BRANCH_V8 - 16 - 合并两个用于从错误合并恢复的头
        | | |\
        | +---o BRANCH_V8 - 15 - 从 BRANCH_V9 丢弃错误的合并
        | | | |
        | ○ | | BRANCH_V8 - 14 - 在 BRANCH_V8 上生成提交以纠正来自 BRANCH_V9 的错误合并
        | | | |
        | | ○ | BRANCH_V8 - 13 - 错误合并后的重要提交
        | | |/
        +---o BRANCH_V8 - 12 - 从 BRANCH_V9 错误合并
        | |/
        | o BRANCH_V8 - 11 - 在 BRANCH_V8 上添加评论
        | |
        ○ | BRANCH_V9 - 10 - 在 BRANCH_V9 上的最后一次提交
        | |

        ```

3.  合并 BRANCH_V8 上的错误合并 + 其修复，并丢弃所有更改：
    1.  合并：`hg merge 15`
    2.  还原所有更改：`hg revert -a --no-backup -r 17`
    3.  提交合并：`hg commit -m "Merging in bad merge from BRANCH_V8 and its fix and throwing it all away"` 当前情况：

        ```
        @ BRANCH_V9 - 18 - 从 BRANCH_V8 合并坏合并及其修复并将其全部丢弃
        |\
        | o BRANCH_V9 - 17 - 合并到 BRANCH_V8 的最后良好状态
        | |\
        +-----o BRANCH_V8 - 16 - 合并两个用于从错误合并恢复的头
        | | | |
        o---+ | BRANCH_V8 - 15 - 从 BRANCH_V9 丢弃错误的合并
        | | | |
        | | ○ | BRANCH_V8 - 14 - 在 BRANCH_V8 上生成提交以纠正来自 BRANCH_V9 的错误合并
        | | | |
        +-----o BRANCH_V8 - 13 - 错误合并后的重要提交
        | | |
        o---+ BRANCH_V8 - 12 - 从 BRANCH_V9 错误合并
        |/ /
        | o BRANCH_V8 - 11 - 在 BRANCH_V8 上添加评论
        | |
        ○ | BRANCH_V9 - 10 - 在 BRANCH_V9 上的最后一次提交
        | |

        ```

4.  合并来自 BRANCH_V8 的剩余更改：
    1.  合并：`hg merge BRANCH_V8`
    2.  犯罪 ：`hg commit -m "merging changes from BRANCH_V8"`

最后的情况是这样的：

```
@ BRANCH_V9 - 19 - 合并来自 BRANCH_V8 的更改
|\
| o BRANCH_V9 - 18 - 合并 BRANCH_V8 的错误合并及其修复并将其全部丢弃
| |\
| | o BRANCH_V9 - 17 - 合并到 BRANCH_V8 的最后良好状态
| | |\
○ | | | BRANCH_V8 - 16 - 合并两个用于从错误合并中恢复的头
|\| | |
| o---+ BRANCH_V8 - 15 - 从 BRANCH_V9 丢弃错误的合并
| | | |
| | | o BRANCH_V8 - 14 - 在 BRANCH_V8 上生成提交以纠正来自 BRANCH_V9 的错误合并
| | | |
○ | | | BRANCH_V8 - 13 - 错误合并后的重要提交
|/ / /
o---+ BRANCH_V8 - 12 - 从 BRANCH_V9 错误合并
|/ /
| o BRANCH_V8 - 11 - 在 BRANCH_V8 上添加评论
| |
○ | BRANCH_V9 - 10 - 在 BRANCH_V9 上的最后一次提交
| |

```

在所有这些步骤之后，您不必手动检查任何差异，BRANCH_V8 和 BRANCH_V9 是正确的，并且将来从 BRANCH_V8 到 BRANCH_V9 的合并也将是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T08:46:53.013

In a pinch, you can export the repository to a bunch diffs, edit history, and then glue back together just what you want - into a new repository, so no risk of damage. Probably not too bad for your example, but I don't know what the real history looks like.

I referenced this page while performing a simpler operation:

[http://strongdynamic.blogspot.com/2007/08/expunging-problem-file-from-mercurial.html](http://strongdynamic.blogspot.com/2007/08/expunging-problem-file-from-mercurial.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T05:18:39.933

好的，首先在与损坏的存储库 (hg init) 不同的目录中创建一个新的*空*存储库。现在，将最后一个已知的好版本拉到新的存储库中；确保*不要*拉坏合并，*并*拉动它之前的所有内容。在旧存储库中，更新到 A 的最后一个已知良好版本，然后执行以下操作：

```
hg graft r1 r2 r3 
```

其中 r1-3 是在拙劣的合并后所做的更改。此时您可能会遇到冲突；修复它们。

这应该会*针对 A 的最后一个已知良好版本*产生新的变化。将这些新更改拉入新存储库。只是为了仔细检查你没有错过任何东西，对旧存储库进行 hg 传入。如果您看到除了拙劣的合并和 r1-3 以外的任何内容，请拉动它。

扔掉旧的存储库。你完成了。合并根本不在新存储库中，您不必重写历史记录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T18:39:54.207

因此，您只想将 B 中的一些变更集合并到 A 中吗？像您一直在做的那样退出变更集是一个非常糟糕的主意，因为您已经遭受了痛苦。

您应该使用移植扩展或拥有第三个分支，您可以在其中进行常见更改以合并到 A 和 B。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T20:32:25.990

在 freenode 上与#mercurial 上的一些乐于助人的人进行了多次讨论之后，mpm 提供了一个似乎适用于我的测试用例的*部分解决方案（我生成了一个假存储库，试图复制该场景）*

但是，在我的实际存储库中，由于我不太了解的原因，它仍然不够完美。

以下是当前提出的解决此问题的方法的图表：

*[原图丢失]*

现在解决的问题*不大*，但我仍然需要比较差异（即： b46:b11 vs b46:b8 ， a43:a10 vs a43:a9 ）并手动编辑一些更改。

在我获得适用于任何存储库的有保证的方式之前，不要关闭这个问题/回答。

### 重要的

任何尝试这些东西的人都应该首先克隆他们的存储库并像沙箱一样使用它。正如您应该对**任何**合并过程所做的那样，因为这样如果出现问题，您可以将其丢弃并重新开始。

# c# - 如何轻松检查 .NET 中文件的访问是否被拒绝？

> ID：265953
> 
> 赞同：110
> 
> 时间：2008-11-05T17:27:57.330
> 
> 标签：c#, .net, file-access

基本上，我想在实际尝试打开文件之前检查我是否有权打开文件；除非必须，否则我不想使用 try/catch 进行此检查。是否有我可以事先检查的文件访问属性？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2008-11-05T17:30:00.570

过去我已经做过无数次了，几乎每次我都错了。

文件权限（甚至文件存在）是*易变*的——它们可以随时更改。由于墨菲定律，这*尤其*包括您检查文件和尝试打开文件之间的短暂时间。还有其他可能失败的原因，例如锁定或网络可用性和路径解析。如果您所在的区域您知道需要先检查，则更有可能出现错误的结果。然而奇怪的是，它永远不会发生在您的测试或开发环境中，它们往往是相当静态的。这使得以后很难追踪问题，并使这种错误很容易进入生产环境。

这意味着如果文件权限或存在错误，您仍必须准备好处理异常，尽管您进行了检查。异常处理代码是*必需*的，无论您是否提前检查文件，良好的异常处理程序可以提供存在或权限检查的*所有*功能。

但是异常处理不是很慢吗？我很高兴你问。是的，是的。事实上，展开堆栈以处理异常是您在单台计算机中可以做的最慢的事情。然而，重要的是要记住磁盘 I/O 甚至更慢——*慢*得多——调用`.Exists()`函数或检查权限总是会强制在文件系统上执行额外的 I/O 操作。

因此，我们发现在尝试打开文件之前进行初始检查既多余又浪费。异常处理没有额外的好处。它实际上会伤害而不是帮助你的表现。它增加了必须维护的更多代码的成本。最后，它可以引入细微的错误。进行初步检查根本没有任何好处。

相反，这里正确的做法是立即尝试打开文件，而不进行初始检查，如果失败，则将您的精力投入到一个好的异常处理程序中。无论您是在检查权限、锁定，还是只是检查文件是否存在，都是如此。

总而言之：选择是每次使用更多代码为文件检查支付额外费用，或者只在某些时间使用更少的代码为异常处理支付较小但仍然很糟糕的费用。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-04-30T13:46:10.587

给遇到类似问题的其他人的快速提示：

注意网络同步应用程序，例如 DropBox。我刚刚花了 2 个小时思考“使用”语句（Dispose 模式）在 .NET 中被破坏了。

我最终意识到 Dropbox 会在后台不断地读写文件，以便同步它们。

猜猜我的 Visual Studio Projects 文件夹在哪里？当然是在“我的 Dropbox”文件夹中。

因此，当我在调试模式下运行我的应用程序时，它正在读取和写入的文件也不断被 DropBox 访问以与 DropBox 服务器同步。这导致了锁定/访问冲突。

所以至少我现在知道我需要一个更强大的文件打开函数（即 TryOpen() 将进行多次尝试）。我很惊讶它还不是框架的内置部分。

[更新]

这是我的辅助功能：

```
/// <summary>
/// Tries to open a file, with a user defined number of attempt and Sleep delay between attempts.
/// </summary>
/// <param name="filePath">The full file path to be opened</param>
/// <param name="fileMode">Required file mode enum value(see MSDN documentation)</param>
/// <param name="fileAccess">Required file access enum value(see MSDN documentation)</param>
/// <param name="fileShare">Required file share enum value(see MSDN documentation)</param>
/// <param name="maximumAttempts">The total number of attempts to make (multiply by attemptWaitMS for the maximum time the function with Try opening the file)</param>
/// <param name="attemptWaitMS">The delay in Milliseconds between each attempt.</param>
/// <returns>A valid FileStream object for the opened file, or null if the File could not be opened after the required attempts</returns>
public FileStream TryOpen(string filePath, FileMode fileMode, FileAccess fileAccess,FileShare fileShare,int maximumAttempts,int attemptWaitMS)
{
    FileStream fs = null;
    int attempts = 0;

    // Loop allow multiple attempts
    while (true)
    {
        try
        {
            fs = File.Open(filePath, fileMode, fileAccess, fileShare);

            //If we get here, the File.Open succeeded, so break out of the loop and return the FileStream
            break;
        }
        catch (IOException ioEx)
        {
            // IOExcception is thrown if the file is in use by another process.

            // Check the numbere of attempts to ensure no infinite loop
            attempts++;
            if (attempts > maximumAttempts)
            {
                // Too many attempts,cannot Open File, break and return null 
                fs = null;
                break;
            }
            else
            {
                // Sleep before making another attempt
                Thread.Sleep(attemptWaitMS);

            }

        }

    }
    // Reutn the filestream, may be valid or null
    return fs;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-05T19:39:19.373

首先，Joel Coehoorn 说了什么。

另外：您应该检查您希望避免使用 try/catch 的假设，除非您必须这样做。避免依赖于异常的逻辑（创建`Exception`对象执行不佳）的典型原因可能与打开文件的代码无关。

我想，如果您正在编写一个`List<FileStream>`通过打开目录子树中的每个文件来填充 a 的方法，并且您希望其中的大量文件无法访问，那么您可能需要在尝试打开文件之前检查文件权限，这样您就不会得到太多异常。但是你仍然会处理异常。此外，如果您正在编写执行此操作的方法，那么您的程序设计可能存在严重错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-03-02T05:30:34.023

这是您正在寻找的解决方案

```
var fileIOPermission = new FileIOPermission(FileIOPermissionAccess.Read,
                                            System.Security.AccessControl.AccessControlActions.View,
                                            MyPath);

if (fileIOPermission.AllFiles == FileIOPermissionAccess.Read)
{
    // Do your thing here...
} 
```

这会根据所有文件的路径视图创建一个新的读取权限，然后检查它是否等于文件访问读取。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-05-06T11:58:41.650

```
public static bool IsFileLocked(string filename)
{
    try
    {
        using var fs = File.Open(filename, FileMode.OpenOrCreate, FileAccess.ReadWrite, FileShare.None);
    }
    catch (IOException)
    {
        return true;
    }
    return false;
} 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2010-03-18T10:57:02.143

```
public static FileStream GetFileStream(String filePath, FileMode fileMode, FileAccess fileAccess, FileShare fileShare, ref int attempts, int attemptWaitInMilliseconds)
{            
    try
    {
         return File.Open(filePath, fileMode, fileAccess, fileShare);
    }
    catch (UnauthorizedAccessException unauthorizedAccessException)
    {
        if (attempts <= 0)
        {
            throw unauthorizedAccessException;
        }
        else
        {
            Thread.Sleep(attemptWaitInMilliseconds);
            attempts--;
            return GetFileStream(filePath, fileMode, fileAccess, fileShare, ref attempts, attemptWaitInMilliseconds);
        }
    }
} 
```

# php - PHP "Wrong referrer" error when submitting a mail form

> ID：265956
> 
> 赞同：1
> 
> 时间：2008-11-05T17:29:06.830
> 
> 标签：php, formmail

I am pretty new to php, but I am learning! I have a simple form on a client website. I am testing the form and when I click submit, I get the following error:

Form Mail Script

```
Wrong referrer (referring site). For security reasons the form can only be used, if the referring page is part of this website.

Note for the Admin: Please add the name of your server to the referrer variable in the index.php configuration file: mywebsite.com 
```

Powered by Form Mail Script

I am looking through the forms configuration and support files but I do not understand exactly what it is I need to change.

Can someone please explain to me what the Admin note above means and how to fix it?

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T17:35:04.180

You are obviously using the Form Mail script on your page. It has a security feature that prevents other domains from submitting to the form. This is done to prevent bots from using the script to send out spam.

In the configuration for the form mail script or in the script itself, you will find an array or variable with the referrers listed. This is the sites that you want to allow calling of this form mail. You should add your own domain to this list or assign it to this variable.

Sorry, I haven't used this script, so I can't be more specific.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T18:16:44.907

The line you want to change is:

```
$referring_server = 'http://www.mywebsite.com, scripts'; 
```

Changing it to something like this will probably work:

```
$referring_server = 'yourdomain.com'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T17:35:50.527

Doing a quick search for the error you're seeing, I found this link: [http://www.stadtaus.com/forum/t-3528.html](http://www.stadtaus.com/forum/t-3528.html)

Not sure if that helps you in this case since I'm unfamiliar with the tool you're using but it seemed like a good fit.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T17:45:02.413

The referrer is a value that's usually sent to a server by a client (your browser) along with a request. It indicates the URL from which the requested resource was linked or submitted. This error is part of a security mechanism in FormMail that is intended to prevent the script from handling input that doesn't originate from your website.

For example, say your form is at *[http://www.foo.com/form.html](http://www.foo.com/form.html)* and your script is at *[http://www.foo.com/script.php](http://www.foo.com/script.php)*. If the script does not check the referrer value, I can create a form on my site at *[http://www.bar.com/myform.html](http://www.bar.com/myform.html)* and submit it to your script. Scripts that send mail are often abused in this manner to send spam.

To fix your problem, find the parameter in your script's configuration file that indicates the referrers that your script should handle input from and change it to include your domain or the specific URL of your page.

Note that referrer is generally misspelled as REFERER with only one 'R' within the context of the HTTP protocol.

# python - 从字符串中去除标点符号的最佳方法

> ID：265960
> 
> 赞同：777
> 
> 时间：2008-11-05T17:30:32.363
> 
> 标签：python, string, punctuation

似乎应该有比以下更简单的方法：

```
import string
s = "string. With. Punctuation?" # Sample string 
out = s.translate(string.maketrans("",""), string.punctuation) 
```

有没有？

* * *

## 回答 #1

> 赞同：1182
> 
> 时间：2008-11-05T18:36:11.530

从效率的角度来看，你不会打败

```
s.translate(None, string.punctuation) 
```

对于更高版本的 Python，请使用以下代码：

```
s.translate(str.maketrans('', '', string.punctuation)) 
```

它使用查找表在 C 中执行原始字符串操作 - 没有什么比这更好的了，但是编写您自己的 C 代码。

如果速度不是问题，另一种选择是：

```
exclude = set(string.punctuation)
s = ''.join(ch for ch in s if ch not in exclude) 
```

这比使用每个字符的 s.replace 更快，但性能不如正则表达式或 string.translate 等非纯 python 方法，从下面的时间可以看出。对于这种类型的问题，在尽可能低的水平上做是有回报的。

计时码：

```
import re, string, timeit

s = "string. With. Punctuation"
exclude = set(string.punctuation)
table = string.maketrans("","")
regex = re.compile('[%s]' % re.escape(string.punctuation))

def test_set(s):
    return ''.join(ch for ch in s if ch not in exclude)

def test_re(s):  # From Vinko's solution, with fix.
    return regex.sub('', s)

def test_trans(s):
    return s.translate(table, string.punctuation)

def test_repl(s):  # From S.Lott's solution
    for c in string.punctuation:
        s=s.replace(c,"")
    return s

print "sets      :",timeit.Timer('f(s)', 'from __main__ import s,test_set as f').timeit(1000000)
print "regex     :",timeit.Timer('f(s)', 'from __main__ import s,test_re as f').timeit(1000000)
print "translate :",timeit.Timer('f(s)', 'from __main__ import s,test_trans as f').timeit(1000000)
print "replace   :",timeit.Timer('f(s)', 'from __main__ import s,test_repl as f').timeit(1000000) 
```

这给出了以下结果：

```
sets      : 19.8566138744
regex     : 6.86155414581
translate : 2.12455511093
replace   : 28.4436721802 
```

* * *

## 回答 #2

> 赞同：186
> 
> 时间：2013-05-28T18:47:47.263

正则表达式很简单，如果你知道的话。

```
import re
s = "string. With. Punctuation?"
s = re.sub(r'[^\w\s]','',s) 
```

* * *

## 回答 #3

> 赞同：86
> 
> 时间：2016-05-14T01:57:29.917

为了使用方便，我总结了 Python 2 和 Python 3 中从字符串中剥离标点符号的注意事项。详细说明请参考其他答案。

* * *

**蟒蛇2**

```
import string

s = "string. With. Punctuation?"
table = string.maketrans("","")
new_s = s.translate(table, string.punctuation)      # Output: string without punctuation 
```

* * *

**蟒蛇 3**

```
import string

s = "string. With. Punctuation?"
table = str.maketrans(dict.fromkeys(string.punctuation))  # OR {key: None for key in string.punctuation}
new_s = s.translate(table)                          # Output: string without punctuation 
```

* * *

## 回答 #4

> 赞同：52
> 
> 时间：2010-03-08T15:19:09.570

```
myString.translate(None, string.punctuation) 
```

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2008-11-05T17:41:27.210

我通常使用这样的东西：

```
>>> s = "string. With. Punctuation?" # Sample string
>>> import string
>>> for c in string.punctuation:
...     s= s.replace(c,"")
...
>>> s
'string With Punctuation' 
```

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2008-11-05T17:39:55.467

不一定更简单，而是另一种方式，如果你更熟悉 re 家族的话。

```
import re, string
s = "string. With. Punctuation?" # Sample string 
out = re.sub('[%s]' % re.escape(string.punctuation), '', s) 
```

* * *

## 回答 #7

> 赞同：30
> 
> 时间：2011-09-01T09:29:45.957

`string.punctuation`*只是*ASCII ！更正确（但也慢得多）的方法是使用 unicodedata 模块：

```
# -*- coding: utf-8 -*-
from unicodedata import category
s = u'String — with -  «punctation »...'
s = ''.join(ch for ch in s if category(ch)[0] != 'P')
print 'stripped', s 
```

您也可以概括和剥离其他类型的字符：

```
''.join(ch for ch in s if category(ch)[0] not in 'SP') 
```

它还会`~*+§$`根据一个人的观点去除可能是也可能不是“标点符号”的字符。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2013-09-02T09:57:54.767

对于 Python 3`str`或 Python 2的`unicode`值，[`str.translate()`](http://docs.python.org/3/library/stdtypes.html#str.translate)只需要一个字典；在该映射中查找代码点（整数）并`None`删除映射到的任何内容。

要删除（一些？）标点符号，请使用：

```
import string

remove_punct_map = dict.fromkeys(map(ord, string.punctuation))
s.translate(remove_punct_map) 
```

类[`dict.fromkeys()`方法](http://docs.python.org/3/library/stdtypes.html#dict.fromkeys)使创建映射变得很简单，`None`根据键的顺序设置所有值。

要删除*所有*标点符号，而不仅仅是 ASCII 标点符号，您的表格需要大一点；请参阅[JF Sebastian 的回答](https://stackoverflow.com/questions/11066400/remove-punctuation-from-unicode-formatted-strings/11066687#11066687)（Python 3 版本）：

```
import unicodedata
import sys

remove_punct_map = dict.fromkeys(i for i in range(sys.maxunicode)
                                 if unicodedata.category(chr(i)).startswith('P')) 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2016-10-06T16:46:01.707

`string.punctuation`错过了现实世界中常用的大量标点符号。一个适用于非 ASCII 标点符号的解决方案怎么样？

```
import regex
s = u"string. With. Some・Really Weird、Non？ASCII。 「（Punctuation）」?"
remove = regex.compile(ur'[\p{C}|\p{M}|\p{P}|\p{S}|\p{Z}]+', regex.UNICODE)
remove.sub(u" ", s).strip() 
```

就个人而言，我相信这是从 Python 中的字符串中删除标点符号的最佳方法，因为：

*   它删除了所有 Unicode 标点符号
*   它很容易修改，例如，`\{S}`如果要删除标点符号，可以删除 ，但保留`$`.
*   您可以非常具体地了解要保留的内容和要删除的内容，例如`\{Pd}`只会删除破折号。
*   此正则表达式还规范化空格。它将制表符、回车和其他奇怪的东西映射到漂亮的单个空格。

这使用 Unicode 字符属性，[您可以在 Wikipedia 上阅读更多信息](https://en.wikipedia.org/wiki/Unicode_character_property)。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2016-06-18T06:38:57.390

我还没有看到这个答案。只需使用正则表达式；它会删除除单词字符 ( `\w`) 和数字字符 ( `\d`) 之外的所有字符，然后是空格字符 ( `\s`)：

```
import re
s = "string. With. Punctuation?" # Sample string 
out = re.sub(ur'[^\w\d\s]+', '', s) 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2016-03-21T02:46:47.040

这是 Python 3.5 的单行代码：

```
import string
"l*ots! o(f. p@u)n[c}t]u[a'ti\"on#$^?/".translate(str.maketrans({a:None for a in string.punctuation})) 
```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2011-07-05T04:30:07.097

这可能不是最好的解决方案，但我就是这样做的。

```
import string
f = lambda x: ''.join([i for i in x if i not in string.punctuation]) 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2015-09-22T14:30:47.140

这是我写的一个函数。它不是很有效，但很简单，您可以添加或删除您想要的任何标点符号：

```
def stripPunc(wordList):
    """Strips punctuation from list of words"""
    puncList = [".",";",":","!","?","/","\\",",","#","@","$","&",")","(","\""]
    for punc in puncList:
        for word in wordList:
            wordList=[word.replace(punc,'') for word in wordList]
    return wordList 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2017-02-02T21:48:39.473

```
import re
s = "string. With. Punctuation?" # Sample string 
out = re.sub(r'[^a-zA-Z0-9\s]', '', s) 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2018-05-07T13:42:17.917

作为更新，我在 Python 3 中重写了 @Brian 示例并对其进行了更改以将正则表达式编译步骤移至函数内部。我的想法是为使功能正常工作所需的每一步都计时。也许您正在使用分布式计算，并且无法在您的工作人员之间共享正则表达式对象，并且需要对`re.compile`每个工作人员采取措施。另外，我很好奇为 Python 3 计时两个不同的 maketrans 实现

```
table = str.maketrans({key: None for key in string.punctuation}) 
```

对比

```
table = str.maketrans('', '', string.punctuation) 
```

另外，我添加了另一种使用 set 的方法，我利用交集函数来减少迭代次数。

这是完整的代码：

```
import re, string, timeit

s = "string. With. Punctuation"

def test_set(s):
    exclude = set(string.punctuation)
    return ''.join(ch for ch in s if ch not in exclude)

def test_set2(s):
    _punctuation = set(string.punctuation)
    for punct in set(s).intersection(_punctuation):
        s = s.replace(punct, ' ')
    return ' '.join(s.split())

def test_re(s):  # From Vinko's solution, with fix.
    regex = re.compile('[%s]' % re.escape(string.punctuation))
    return regex.sub('', s)

def test_trans(s):
    table = str.maketrans({key: None for key in string.punctuation})
    return s.translate(table)

def test_trans2(s):
    table = str.maketrans('', '', string.punctuation)
    return(s.translate(table))

def test_repl(s):  # From S.Lott's solution
    for c in string.punctuation:
        s=s.replace(c,"")
    return s

print("sets      :",timeit.Timer('f(s)', 'from __main__ import s,test_set as f').timeit(1000000))
print("sets2      :",timeit.Timer('f(s)', 'from __main__ import s,test_set2 as f').timeit(1000000))
print("regex     :",timeit.Timer('f(s)', 'from __main__ import s,test_re as f').timeit(1000000))
print("translate :",timeit.Timer('f(s)', 'from __main__ import s,test_trans as f').timeit(1000000))
print("translate2 :",timeit.Timer('f(s)', 'from __main__ import s,test_trans2 as f').timeit(1000000))
print("replace   :",timeit.Timer('f(s)', 'from __main__ import s,test_repl as f').timeit(1000000)) 
```

这是我的结果：

```
sets      : 3.1830138750374317
sets2      : 2.189873124472797
regex     : 7.142953420989215
translate : 4.243278483860195
translate2 : 2.427158243022859
replace   : 4.579746678471565 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2015-10-17T23:03:59.523

在不太严格的情况下，单线可能会有所帮助：

```
''.join([c for c in s if c.isalnum() or c.isspace()]) 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2016-08-24T05:43:58.777

```
>>> s = "string. With. Punctuation?"
>>> s = re.sub(r'[^\w\s]','',s)
>>> re.split(r'\s*', s)

['string', 'With', 'Punctuation'] 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2016-11-30T10:29:40.070

这是一个没有正则表达式的解决方案。

```
import string

input_text = "!where??and!!or$$then:)"
punctuation_replacer = string.maketrans(string.punctuation, ' '*len(string.punctuation))    
print ' '.join(input_text.translate(punctuation_replacer).split()).strip()

Output>> where and or then 
```

*   用空格替换标点符号
*   用单个空格替换单词之间的多个空格
*   使用 strip() 删除尾随空格，如果有的话

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2017-01-02T08:56:57.190

```
# FIRST METHOD
# Storing all punctuations in a variable    
punctuation='!?,.:;"\')(_-'
newstring ='' # Creating empty string
word = raw_input("Enter string: ")
for i in word:
     if(i not in punctuation):
                  newstring += i
print ("The string without punctuation is", newstring)

# SECOND METHOD
word = raw_input("Enter string: ")
punctuation = '!?,.:;"\')(_-'
newstring = word.translate(None, punctuation)
print ("The string without punctuation is",newstring)

# Output for both methods
Enter string: hello! welcome -to_python(programming.language)??,
The string without punctuation is: hello welcome topythonprogramminglanguage 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2019-07-29T08:18:31.683

为什么你们都不用这个？

```
 ''.join(filter(str.isalnum, s)) 
```

太慢了？

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2020-08-20T08:05:39.037

这是使用 RegEx 的另一种简单方法

```
import re

punct = re.compile(r'(\w+)')

sentence = 'This ! is : a # sample $ sentence.' # Text with punctuation
tokenized = [m.group() for m in punct.finditer(sentence)]
sentence = ' '.join(tokenized)
print(sentence) 
'This is a sample sentence' 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2017-01-04T11:09:31.643

```
with open('one.txt','r')as myFile:

    str1=myFile.read()

    print(str1)

    punctuation = ['(', ')', '?', ':', ';', ',', '.', '!', '/', '"', "'"] 

for i in punctuation:

        str1 = str1.replace(i," ") 
        myList=[]
        myList.extend(str1.split(" "))
print (str1) 
for i in myList:

    print(i,end='\n')
    print ("____________") 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2020-09-02T07:51:45.407

试试那个:)

```
regex.sub(r'\p{P}','', s) 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2021-03-26T14:09:10.047

我一直在寻找一个非常简单的解决方案。这是我得到的：

```
import re 

s = "string. With. Punctuation?" 
s = re.sub(r'[\W\s]', ' ', s)

print(s)
'string  With  Punctuation ' 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2021-08-13T14:38:15.927

这个问题没有太多的细节，所以我采取的方法是想出一个对问题最简单解释的解决方案：去掉标点符号。

请注意，提出的解决方案不考虑缩略词（例如，`you're`）或连字符（例如，`anal-retentive`）......关于它们是否应该被视为标点符号......也没有考虑到非英文字符集或类似的东西......因为问题中没有提到这些细节。有人认为空格是标点符号，这在[技术上是正确](https://en.wikipedia.org/wiki/Space_(punctuation))的……但对我来说，在手头的问题的背景下它是零意义的。

```
# using lambda
''.join(filter(lambda c: c not in string.punctuation, s))

# using list comprehension
''.join('' if c in string.punctuation else c for c in s) 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2021-10-05T13:28:02.967

显然我无法对所选答案进行编辑，所以这里有一个适用于 Python 3 的更新。`translate`在进行非平凡的转换时，该方法仍然是最有效的选择。

将最初的繁重工作归功于上面的@Brian。感谢@ddejohn 对改进原始测试的出色建议。

```
#!/usr/bin/env python3

"""Determination of most efficient way to remove punctuation in Python 3.

Results in Python 3.8.10 on my system using the default arguments:

set       : 51.897
regex     : 17.901
translate :  2.059
replace   : 13.209
"""

import argparse
import re
import string
import timeit

parser = argparse.ArgumentParser()
parser.add_argument("--filename", "-f", default=argparse.__file__)
parser.add_argument("--iterations", "-i", type=int, default=10000)
opts = parser.parse_args()
with open(opts.filename) as fp:
    s = fp.read()
exclude = set(string.punctuation)
table = str.maketrans("", "", string.punctuation)
regex = re.compile(f"[{re.escape(string.punctuation)}]")

def test_set(s):
    return "".join(ch for ch in s if ch not in exclude)

def test_regex(s):  # From Vinko's solution, with fix.
    return regex.sub("", s)

def test_translate(s):
    return s.translate(table)

def test_replace(s):  # From S.Lott's solution
    for c in string.punctuation:
        s = s.replace(c, "")
    return s

opts = dict(globals=globals(), number=opts.iterations)
solutions = "set", "regex", "translate", "replace"
for solution in solutions:
    elapsed = timeit.timeit(f"test_{solution}(s)", **opts)
    print(f"{solution:<10}: {elapsed:6.3f}") 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-06-04T05:08:05.250

考虑unicode。在 python3 中检查的代码。

```
from unicodedata import category
text = 'hi, how are you?'
text_without_punc = ''.join(ch for ch in text if not category(ch).startswith('P')) 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-04-27T11:48:29.827

你也可以这样做：

```
import string
' '.join(word.strip(string.punctuation) for word in 'text'.split()) 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-12-01T14:37:52.480

当您处理 Unicode 字符串时，我建议使用[PyPi`regex`模块](https://pypi.org/project/regex/)，因为它支持 Unicode 属性类（如`\p{X}`/ `\P{X}`）和 POSIX 字符类（如`[:name:]`）。

只需在终端中键入`pip install regex`（或）并按 ENTER即可安装软件包。`pip3 install regex`

如果您需要删除任何类型的标点符号和符号（即除字母、数字和空格之外的任何内容），您可以使用

```
regex.sub(r'[\p{P}\p{S}]', '', text)  # to remove one by one
regex.sub(r'[\p{P}\p{S}]+', '', text) # to remove all consecutive punctuation/symbols with one go
regex.sub(r'[[:punct:]]+', '', text)  # Same with a POSIX character class 
```

在线查看[Python 演示](https://tio.run/##K6gsycjPM/7/PzO3IL@oRKEoNT21gourJLWiRMFWQf3BkrUPlux7sGTDgyVLFDzzUjITFWzsbOziVPR0dBQVDAyM1LnyUsvjocrBmvWKS5M0itSjYwqqA2qBRHBtTHGstrqOgroCkACp1NTLyS9PLdLQ1CsuKcos0NDk4iooyswr0YAZpfn/PwA)：

```
import regex

text = 'भारत India <><>^$.,,! 002'
new_text = regex.sub(r'[\p{P}\p{S}\s]+', ' ', text).lower().strip()
# OR
# new_text = regex.sub(r'[[:punct:]\s]+', ' ', text).lower().strip()

print(new_text)
# => भारत india 002 
```

在这里，我在字符类中添加了一个空格`\s`模式

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2017-01-05T08:00:04.467

使用 Python 从文本文件中删除停用词

```
print('====THIS IS HOW TO REMOVE STOP WORS====')

with open('one.txt','r')as myFile:

    str1=myFile.read()

    stop_words ="not", "is", "it", "By","between","This","By","A","when","And","up","Then","was","by","It","If","can","an","he","This","or","And","a","i","it","am","at","on","in","of","to","is","so","too","my","the","and","but","are","very","here","even","from","them","then","than","this","that","though","be","But","these"

    myList=[]

    myList.extend(str1.split(" "))

    for i in myList:

        if i not in stop_words:

            print ("____________")

            print(i,end='\n') 
```

* * *

## 回答 #31

> 赞同：-3
> 
> 时间：2013-04-06T17:28:57.147

我喜欢使用这样的函数：

```
def scrub(abc):
    while abc[-1] is in list(string.punctuation):
        abc=abc[:-1]
    while abc[0] is in list(string.punctuation):
        abc=abc[1:]
    return abc 
```

# .net - 如何使用该 COM 对象将 C++/COM 库中实现的 DIB 放入 .NET 客户端

> ID：265967
> 
> 赞同：0
> 
> 时间：2008-11-05T17:32:09.723
> 
> 标签：.net, com, atl, dib

我们有一个用 C++/ATL 实现的 COM 对象，其中包括一个返回 DIB 的方法。我们还在编写一个将使用该 COM 对象的 .NET 应用程序。由于我们同时编写了两者，我们可以自由决定如何最好地从 COM 对象返回此 DIB。澄清一下，最好将本机 Windows 句柄返回到 DIB 或字节数组，还是有其他方法可以轻松地将 Windows DIB 转换为 .NET Image 对象？而且，与那个问题相关：一旦我得到了这个返回的 DIB，我怎么能把它变成一个 .NET Image 对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T20:28:53.720

COM/OLE 有一个用于表示图形图像的标准接口，称为[IPicture](http://msdn.microsoft.com/en-us/library/ms680761(VS.85).aspx)（及其脚本友好版本[IPictureDisp](http://msdn.microsoft.com/en-us/library/ms680762(VS.85).aspx)）。

COM 为您提供了这些接口的实现。您可以通过调用[OleCreatePictureIndirect()](http://msdn.microsoft.com/en-us/library/ms694511(VS.85).aspx)来为您构建一个。您只需将[PICTDESC 结构](http://msdn.microsoft.com/en-us/library/ms693798(VS.85).aspx)与您所拥有的图形一起交给它，它就会为您返回一个界面。您应该能够将该接口交还给调用程序。这也将使您的对象与其他 COM 客户端（如 VB6）兼容。

[回到 .NET 领域，您可以使用Microsoft.VisualBasic.Compatibility.VB6.IPictureToImage()](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.compatibility.vb6.support.ipicturetoimage.aspx)将 IPicture 转换为图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T18:09:24.843

在 CodeProject 上查看文章[DIB to System.Bitmap 。](http://www.codeproject.com/KB/GDI-plus/DIBtoBitmap.aspx)它具有从 DIB 转换为位图的代码。这个想法是使用 IntPtr 表示 DIB。

# html - 容器 div 的 CSS 并下降到下一行

> ID：265970
> 
> 赞同：4
> 
> 时间：2008-11-05T17:33:04.293
> 
> 标签：html, css, css-float, css-tables

我更像是一名程序员而不是设计师，我试图接受`<div>`s 而不是使用表格，但我陷入了困境。

这就是我想要做的。我正在设置一个调查页面。我希望每个问题的文本都位于蓝色 div 的顶部，如果太长则换行。我希望所有的红色 div 都排在容器 div 的右上角。

[布局 http://img528.imageshack.us/img528/4330/divsforsurveyop2.jpg](http://img528.imageshack.us/img528/4330/divsforsurveyop2.jpg)

这是我开始的，只要框架宽度超过 420 像素，它就可以正常工作。然后红色的 div 跳到下一行。我想我可能走错了，也许我应该向右浮动？

```
.greencontainer{
    width:100%;
    spacing : 10 10 10 10 ;
    float: left; 
}

.redcontainer{ 
    float: left; 
    width: 20px;
    padding: 2 0 2 0;
    font-size: 11px;
    font-family: sans-serif; 
    text-align: center; 
}

.bluecontainer{ 
    clear: both;
    float: left; 
    width: 400px; 
    padding: 2 2 2 10;
    font-size: 11px;
    font-family: sans-serif; 
    text-align: left; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T17:38:01.443

除了红色容器外，不要浮动任何东西，并将其浮动到右侧。确保红色容器的 HTML 位于蓝色容器的 HTML 之前。在蓝色容器上保持静态宽度，并在绿色容器上保持清晰：两者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T17:42:39.563

这是我要做的：

```
<div class="greencontainer">
  <div class="redcontainer">
    <input type="checkbox" />
  </div>
  <div class="bluecontainer">
    <label>Text about this checkbox...</label>
  </div>
</div> 
```

用CSS：

```
.greencontainer{
   float:left;
   clear:left;
   width:100%;
 }
 .redcontainer{
   float:right;
   width:20px;
 }
 .bluecontainer{
   margin-right:20px;
 } 
```

PS 填充值应始终具有单位，除非它们为零。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T17:37:28.870

不要在您的 bluecontainer 上使用 clear:both，因为它会清除两侧（左侧和右侧）的任何元素。你应该让 redcontainer 向右浮动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T17:35:03.027

这里的测试很少，但我*认为*你会想要“clear: both;” 在 .greencontainer 上，而不是“float：left”。同时从 .bluecontainer 中删除“clear: both”

查看更多信息：[http ://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T17:40:40.113

蓝色 div 上有“clear: both”。这就是我认为导致问题的原因。

查看[http://www.barelyfitz.com/screencast/html-training/css/positioning/](http://www.barelyfitz.com/screencast/html-training/css/positioning/)有一些方便的演示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T18:02:16.573

我认为您根本不需要浮动绿色容器，因为它是包含 div。另外，只有将多个蓝色/红色 div 放入同一个绿色容器中时才需要“clear:both”语句。

尝试

```
.greencontainer{
    宽度：100%；
间距：10 10 10 10 ；

}

.bluecontainer{
    向左飘浮;
    宽度：400px；
    填充：2 2 2 10；
    字体大小：11px；
字体系列：无衬线；
    文本对齐：左；
}
.redcontainer{
    浮动：对；
    宽度：20px；
    填充：2 0 2 0；
    字体大小：11px；
字体系列：无衬线；
    文本对齐：居中；
}

```

您可能还需要为蓝色容器添加右边距或为红色容器添加左边距，以获得它们之间的一致间距，而不是使用与 div 内部间距相关的填充而不是它周围

# linux - Task run manually works, running from cron I get a sigfault

> ID：265973
> 
> 赞同：2
> 
> 时间：2008-11-05T17:33:39.783
> 
> 标签：linux, cron

I've inherited someone else's monster of a BASH script. The script was written in such a way that it uses a ridiculous amount of memory (around 1GB). I can run it from a shell with out issue, but if I run it from cron I crashes with a sig fault.

Apart from digging into the poorly commented behemoth, is there a way to run it from cron with out running into the sig fault?

Cheers,

Steve

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T17:40:32.860

When you run something using cron you'll encounter issues with the environment variables being different or simply not set as compared to your own variables when you manually execute. Often things like the PATH aren't set properly when cron executes something, so it's important to supply full paths to executables within the script, even for things such as perl or common commands that you thing *should* be found in the default PATH. Without more info it's hard to speculate on what precisely the problem is.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T17:41:36.087

Is it expecting to be connected to a tty or have an open stdin? Try redirecting a file of something random to it as inout when it's running from cron?

What segfaults? Bash, or something it calls?

Any hints from the core file as to what the problem is?

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-05T18:35:51.687

尝试确保 stdout 和 stderr 有地方可去

```
/path/to/bigscript.sh &> /dev/null 
```

[编辑] 您可能想要使用 /dev/null 以外的文件，尤其是在调试模式下运行它时；）

如此庞大，如果在调试中运行会有所帮助，我不会，但您可以尝试。在 bash 中，它是 '-x' 选项，您可以将其放入 shebang 中。

正如在其他答案中所说，它很有可能是一个环境变量。

# javascript - 如何使用 Javascript 重新定义 CSS 类

> ID：265984
> 
> 赞同：6
> 
> 时间：2008-11-05T17:37:01.227
> 
> 标签：javascript, css

假设我们已经定义了一个 CSS 类，它被应用于页面上的各种元素。

```
colourful
{
    color: #DD00DD;
    background-color: #330033;
} 
```

人们抱怨这种颜色，他们不喜欢粉色/紫色。所以你想让他们有能力随心所欲地改变风格，他们可以选择自己喜欢的颜色。您有一个调用 Javascript 函数的颜色选择器小部件：

```
function changeColourful(colorRGB, backgroundColorRGB)
{
    // answer goes here
} 
```

该函数的主体中有什么？

目的是当用户在颜色选择器上选择新颜色时，所有元素`class="colourful"`的样式都会改变。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T18:16:35.390

```
var setStyleRule = function(selector, rule) {
    var stylesheet = document.styleSheets[(document.styleSheets.length - 1)];
    if(stylesheet.addRule) {
        stylesheet.addRule(selector, rule)
    } else if(stylesheet.insertRule) {
        stylesheet.insertRule(selector + ' { ' + rule + ' }', stylesheet.cssRules.length);
    }
}; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-05T17:58:02.027

我实际上会实现这个服务器端；只需将用户喜欢的颜色存储在他们的会话中（通过 cookie 或任何对您来说又好又容易的东西）并动态生成 CSS，即

```
colourful {
  color: ${userPrefs.colourfulColour};
  background-color: ${userPrefs.colourfulBackgroundColour};
} 
```

如果通过 Javascript 确实更适合您，您可以使用 Javascript 操作 CSS。参见，例如：

*   [微软的文档](http://msdn.microsoft.com/en-us/library/ms535871(VS.85).aspx)
*   [https://developer.mozilla.org/en/DOM/style](https://developer.mozilla.org/en/DOM/style)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-05T18:15:52.070

我不知道直接操作类，但你可以有效地做同样的事情。这是 jQuery 中的一个示例。

```
$('.colourful').css('background-color', 'purple').css('color','red'); 
```

在纯 JavaScript 中，您将不得不做更多的工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-05T21:55:50.987

我只是尝试在 <head> 中使用一个空的 <style> 标记，然后动态填充它。至少在ff3中似乎可以工作。

所以 ：

在 <head> 中，插入如下内容：

```
<style id="customstyle" type="text/css"></style> 
```

现在您可以使用 jquery 之类的东西来替换或附加其内容：

更换：

```
$("#customstyle").text(".colourful { color: #345 ; }"); 
```

附加：

```
 $("#customstyle").append(".colourful { color: #345 ; }"); 
```

如果你想把它保存在某个地方，只需抓取内容：

```
 var csscontent =  $("#customstyle").text(); 
```

..然后你可以通过ajax将它发送回服务器。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-05T18:18:26.213

jQuery：

```
function changeColourful(colorRGB, backgroundColorRGB)
{
    $('.colourful').css({color:colorRGB,backgroundColor:backgroundColorRGB});
} 
```

如果您希望更改在页面之间持续存在，则必须将它们存储在 cookie 中并每次重新应用该功能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-05T18:04:02.140

首先检查是否`document.styleSheets`已定义（请参阅@alex 的回复）。

如果没有，这个问题应该会有所帮助：
[Get All Elements in an HTML document with a specific CSS Class](https://stackoverflow.com/questions/210377/get-all-elements-in-an-html-document-with-a-specific-css-class)

请参阅已接受答案中的链接和底部的我的回复。

这只是答案的一部分。您仍然需要使用每个元素的样式属性应用新值。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-05T18:09:39.023

特定 div/颜色的快速示例 - 可以通过函数动态传递

```
document.getElementById('你的 Div 名称').style.background = 'white';

```

或者，更改指定项目的类别

```
document.getElementById('Your Div Name Here').classname = 'newclassname'

```

假设您可以通过这种方式指定 div，如果没有，则结合使用 Kevin 展示的节点循环解决方案应该可以解决问题

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-01-01T21:48:57.617

这是一个将背景图像更改为样式表的完整示例。第一部分找到正确的样式表。在这里，我想要最后一个，其 href 包含“mycss.css”。您还可以使用 title 属性。

第二部分找到正确的规则。在这里，我放置了一个标记“MYCSSRULE”，以便我可以找到正确的规则。

mycss.css 中的 css 规则为：#map td, MYCSSRULE { background-image:url("img1.png"); }

第三部分只是改变了规则。

此过程不适用于 Internet Explorer 6。（IE 8 可以）。适用于 Firefox 3 和 Webkit。

希望它有所帮助。

```
function changeBgImg(newimage) {
  var i,n;
  var ssheets = document.styleSheets;         // all styleSheets. Find the right one
  var ssheet;

  // find the last one whose href contain "myhref"
  n = ssheets.length;
  for (i=n-1; i>=0 ;i--) {
    var thisheet = ssheets[i];
    if ( (null != thisheet.href) && (thisheet.href.indexOf("mycss.css") != -1) ) {
      ssheet = thisheet; break;
    }
  }

  if ( (null == ssheet) || ("undefined" == typeof(ssheet.cssRules))) {
    // stylesheet not found or internet explorer 6
    return;
  }

  // find the right rule
  var rule;
  n = ssheet.cssRules.length;
  for (i=0; i<n; i++) {
    var r = ssheet.cssRules.item(i);
    if (typeof(r.selectorText) == "undefined") { continue; }
    if (r.selectorText.indexOf("MYCSSRULE") != -1) {
      rule = r; break;
    }
  }

  if (null == rule) {
    // not found
    return;
  }

  rule.style.backgroundImage = "url(" + newImage + ")";
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-05T17:50:10.000

就像是

```
function changeColourful(colorRGB, backgroundColorRGB)
 {changeColor (document, colorRGB, backgroundColorRGB)}

function changeColor (node, color, changeToColor)
{
   for(var ii = 0 ; ii < node.childNodes.length; ii++)
   {
     if(node.childNodes[ii].childNodes.length > 0)
     {
        changeColor(node.childNodes[ii], color, changeToColor);
     }

      if(node[ii].style.backgroundColor == color)
      {
        node[ii].style.backgroundColor = changeToColor;
      }

   }

} 
```

# xml - 仅处理选定的节点

> ID：265991
> 
> 赞同：2
> 
> 时间：2008-11-05T17:38:18.480
> 
> 标签：xml, xslt, xslt-1.0

一个 XSLT 新手问题：我需要在 XML 文件中替换一个文本值。所有其他节点必须保持不变。这是我的输入文件（in.xml）：

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
    <level1 attr1="val1">
        <level2>in</level2>
    </level1>
</root> 
```

这是我的 XSLT 转换 (subst.xsl)：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:template match="/">
        <xsl:apply-templates />
    </xsl:template>

    <xsl:template match="//node()">
        <xsl:copy>
            <xsl:apply-templates />
        </xsl:copy>
    </xsl:template>

    <xsl:template match="/root/level1/level2/text()">out</xsl:template>
</xsl:stylesheet> 
```

我使用以下 Ant 脚本 (build.xml) 运行它：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="test" default="test" basedir=".">
    <target name="test">
        <xslt style="subst.xsl" in="in.xml" out="out.xml" />
    </target>
</project> 
```

这就是我得到的（out.xml）：

```
<?xml version="1.0" encoding="UTF-8"?><root>
    <level1>
        <level2>out</level2>
    </level1>
</root> 
```

“level1”的属性“attr1”缺失。

如果有人，我将不胜感激

*   告诉我**subst.xsl 有什么问题**

或者

*   给我一个想法，如何强制 xslt 处理器**将不匹配的节点复制**到输出文件并手动完成（在我的情况下这很容易出错）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-05T17:56:41.780

您的身份转换缺少属性（显然）。改用这个：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

然后，只需添加您的最后一个模板。**********`****