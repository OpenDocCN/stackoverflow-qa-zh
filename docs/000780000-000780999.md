# StackOverflow 问答 000780000-000780999

# iphone - 我在 Cocoa 的 SOAP XML 中对整数使用什么数据类型？

> ID：780016
> 
> 赞同：0
> 
> 时间：2009-04-23T01:52:20.890
> 
> 标签：iphone, xml, cocoa, cocoa-touch, soap

我想这只是一个 int，但我想验证一下。

谢谢科里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T13:40:04.380

我建议使用 NSInteger/NSUInteger 而不是 int。NS(U)Integer 根据您运行的环境映射到适当的大小。对于当前的 iPhone/iPod 来说可能无关紧要，但您最好在未来证明您的代码。更多讨论请参见[CocoaDev](http://www.cocoadev.com/index.pl?NSUInteger)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-23T01:53:44.007

是的，只是一个整数。

# actionscript-3 - 在 Flex 中，如何创建、填充和显示位图？

> ID：780018
> 
> 赞同：3
> 
> 时间：2009-04-23T01:53:35.300
> 
> 标签：actionscript-3, apache-flex, bitmap, flex3

从一个完全空的 MXML 应用程序开始：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
    layout="absolute" >

</mx:Application> 
```

什么是脚本：

*   创建一个位图（这应该是一个`BitmapData`对象吗？）
*   以编程方式用数据填充它（例如画一个圆圈）（有没有比重复调用更有效的方法`BitmapData.SetPixel`？）
*   在应用程序中渲染它（例如在中间居中）（如何将位图显示到屏幕上？在线 Flash 示例显示调用`myBitmap=new Bitmap(myBitmapData)`then `myBitmap.AddChild`，但这会在 Flex 中引发错误）。

??

注意：目标不仅仅是在屏幕上显示一个圆圈，而是使用 SetPixel（或 ???）填充 Bitmap（或 BitmapData？或 ???）对象，然后将其内容显示到屏幕上，就像需要在图像处理或视觉效果应用中做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T03:36:06.427

你有几个选择。首先是检查[Degrafa 框架](http://www.degrafa.org/)，它有一些非常棒的绘图工具，否则你需要添加一个脚本块并在函数中使用 AS3 绘图 api（在这种情况下可能会在 creationComplete 上调用：

```
private function handleCreationComplete():void
{
    var component:UIComponent = new UIComponent(); //needed to add to the flex display list
    var myCircle:Sprite = new Sprite();
    myCircle.graphics.beginFill(0xFFFFFF,1)
    myCircle.graphics.drawCircle(100,100,50);
    component.addChild(myCircle);
    this.addChild(component);
} 
```

这不会使圆圈居中，但您可以弄清楚这一点。

您可以使用此函数从上述 UIComponent 中实际获取位图：

```
private function getBitmapData( target : UIComponent ) : BitmapData
   {
    var bd : BitmapData = new BitmapData( target.width, target.height );
    var m : Matrix = new Matrix();
    bd.draw( target, m );
    return bd;
   } 
```

从[这里](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&postId=1682&productId=2)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T16:05:57.550

这是一个完整的工作示例，我可以根据 Joel Hooks 的建议创建：

**MXML 文件（ards.mxml）：**

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute"
       creationComplete="onCreationComplete()">

<mx:Script source="ards_script.as" />

</mx:Application> 
```

**脚本文件（ards_script.as）：**

```
import mx.core.UIComponent;

private function onCreationComplete():void
{
    // create a UIComponent and add it to the Flex display list
    var component:UIComponent = new UIComponent();
    component.width = this.width;
    component.height = this.height;
    component.x = 0;
    component.y = 0;
    this.addChild(component);

    // create a BitmapData object (basically an array of pixels) the same size as the screen    
    var bd : BitmapData = new BitmapData( component.width, component.height );

    // draw a green circle in the bitmap data
    var xCenter:int = component.width/2;
    var yCenter:int = component.height/2;
    var r:int = Math.min(xCenter,yCenter);
    var rSquare:int = r*r;
    var color:Number = 0x00ff00;
    for( var i:int=0; i<component.width; i++ )
    {
        for( var j:int=0; j<component.width; j++ )
        {
            var dX:int = i - xCenter;
            var dY:int = j - yCenter;
            var q:int = dX*dX + dY*dY;
            if( q < rSquare )
            {
                    bd.setPixel( i, j, color );
            }       
        }
    }

    // create a bitmap based on the data, and add it as a child to the UIComponent to be displayed
    // (if you try to add it directly to the Application, you get a runtime error)
    var bt:Bitmap = new Bitmap(bd);
    component.addChild(bt);    
} 
```

# mysql - 从另一个表更新表中的值

> ID：780021
> 
> 赞同：0
> 
> 时间：2009-04-23T01:54:29.463
> 
> 标签：mysql, sql, mysql-error-1093

我意识到我在查询中使用 varchar 属性作为索引/键，这正在扼杀我的查询性能。我正在尝试查看我的 precienct 表并获取整数 ID，然后使用新的 int FK 更新我在家庭表中的记录，并将其放置在新列中。这是我到目前为止写的sql。但我得到了一个

错误 1093 您无法在 FROM 子句中指定目标表 'voterfile_household' 进行更新，我不知道如何修复它。

```
UPDATE voterfile_household
SET
PrecID = (SELECT voterfile_precienct.ID
        FROM voterfile_precienct INNER JOIN voterfile_household
        WHERE voterfile_precienct.PREC_ID = voterfile_household.Precnum); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T02:01:12.100

尝试：

```
update voterfile_household h, voterfile_precienct p
   set h.PrecID = p.ID
 where p.PREC_ID = h.Precnum 
```

看看[这里](http://dev.mysql.com/doc/refman/5.0/en/update.html)的更新参考。

同样，您也可以使用**内连接**语法。

```
update voterfile_household h inner join voterfile_precienct p on (h.Precnum = p.PREC_id)
   set h.PrecID = p.ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T02:00:14.007

如果子查询返回多个结果怎么办？这就是为什么它不起作用。

在 SQL Server 上，如果子查询执行“SELECT TOP 1 ...”，则可以使这种类型的事情起作用，不确定如果向子查询添加“限制 1”，mysql 是否也会接受它。

我还认为这几乎与今天早些时候的[这个问题（“我可以在 SQL UPDATE 内有一个内部 SELECT 吗？”）重复。](https://stackoverflow.com/questions/778307/can-i-have-an-inner-select-inside-of-an-sql-update)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T02:03:05.527

首先，你在 varchar 上的索引并不总是一件坏事，如果它不是一个键，你可以缩小你索引的字段的多少，只索引前 10 个字符左右。

其次，它不会让你这样做，就好像它是一个返回它可能会破坏的集合。

# c# - 在派生类 C# 中引发基类事件

> ID：780022
> 
> 赞同：9
> 
> 时间：2009-04-23T01:55:28.183
> 
> 标签：c#, events, base-class

我有一个基类 DockedToolWindow : Form，以及许多从 DockedToolWindow 派生的类。我有一个容器类，它保存并将事件分配给 DockedToolWindow 对象，但是我想从子类调用事件。

我实际上有一个关于如何实现这个[MSDN 网站](http://msdn.microsoft.com/en-us/library/hy3sefw3(VS.80).aspx)告诉我要做的事情的问题。下面的这一部分给了我这个问题：

```
 // The event. Note that by using the generic EventHandler<T> event type
    // we do not need to declare a separate delegate type.
    public event EventHandler<ShapeEventArgs> ShapeChanged;

    public abstract void Draw();

    //The event-invoking method that derived classes can override.
    protected virtual void OnShapeChanged(ShapeEventArgs e)
    {
        // Make a temporary copy of the event to avoid possibility of
        // a race condition if the last subscriber unsubscribes
        // immediately after the null check and before the event is raised.
        EventHandler<ShapeEventArgs> handler = ShapeChanged;
        if (handler != null)
        {
            handler(this, e);
        }
    } 
```

当然这个例子可以编译和工作，但是当我用“Move”（我从Form派生的一个事件）替换“ShapeChanged”时，它错误地说我不能在没有+=或-=的情况下在右侧移动。我还删除了 ShapeEventArgs 通用标签。

任何煽动为什么这不起作用？在类中声明的事件和继承的事件有什么区别？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-23T09:36:56.343

您不能直接触发基类事件。这正是您必须制作`OnShapeChanged`方法`protected`而不是`private`.

请改用[base.OnMove()](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.onmove.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T02:39:35.113

从 C# 语言规范，第 10.7 节（强调添加）：

> **在包含事件声明的类或结构的程序文本中，某些事件可以像 fields 一样使用**。要以这种方式使用，事件不能是抽象的或外部的，并且不能显式地包含事件访问器声明。这样的事件可以在允许字段的任何上下文中使用。该字段包含一个委托（第 15 节），它引用已添加到事件的事件处理程序列表。如果未添加任何事件处理程序，则该字段包含 null。

因此，您不能将 Move 事件视为字段的原因是它以不同的类型定义（在本例中为您的超类）。我同意@womp 的推测，即设计师做出这个选择是为了防止无意中对事件进行胡闹。允许不相关的类型（不是从声明事件的类型派生的类型）执行此操作似乎显然很糟糕，但即使对于派生类型，它也可能是不可取的。他们可能必须包含允许进行事件声明`private`或`protected`关于字段样式使用的语法，所以我的猜测是他们选择完全禁止它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T02:15:19.197

区别在于范围。在您的类中，您可以控制事件委托的处理方式，但是，您的类无法控制基类在做什么。它可能正在对事件及其处理程序做一些疯狂的幕后工作。如果您只是“重新分配”了 Move 事件，那么您将清除该事件的多播委托列表。

我猜他们对此施加了编译器限制，因为这是一种非常不安全的做法，并且本质上会使任何后代类都能够破坏其父类的事件模型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T04:06:21.130

您只需要在定义事件本身的类中发布的代码。所有派生类都应该直接调用 OnShapeChanged() 或 OnMove()，无需复制等，因此您根本不应该在类中编写该代码（因为 Move 事件是在基类中定义的）。

如果您确实需要在派生类中进行某种处理（也许您需要摆弄您的集合类？），您可以覆盖虚拟 OnXXX 调用，并在调用 base.OnXXX() 之前进行处理。在 MSDN 文章中，Circle 类对应于您的 DockingToolWindow 类。您的派生类应该可以使用相同的模式。

# asp.net-mvc - ASP.Net MVC 模型绑定返回空值

> ID：780026
> 
> 赞同：2
> 
> 时间：2009-04-23T01:57:37.570
> 
> 标签：asp.net-mvc

给定以下标记：

```
 <form method="post" action="/home/index">
    Username:
    <%= Html.TextBox("UserName")%>
    Password:
    <%= Html.TextBox("Password")%>
    <input id="login" type="button" value="Login" />
    <input id="Submit1" type="submit" value="submit" />
 </form> 
```

你能告诉我为什么调用我的操作时模型绑定不起作用：

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Index(string UserName, string Password)
    {
        //UserName and Password are null!  Why?            
    } 
```

编辑：表单值正在发布。如果我检查 Request.Form 属性，我会看到发布了正确的值。

> ? Request.Form {UserName=sdf&Password=sdf} [System.Web.HttpValueCollection]: {UserName=sdf&Password=sdf} base {System.Collections.Specialized.NameObjectCollectionBase}: {UserName=sdf&Password=sdf} AllKeys: {string[2] }

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-22T06:29:14.217

您是否尝试将绑定属性添加到参数？

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index([Bind]string UserName, [Bind]string Password)
{
    //UserName and Password are null!  Why?            
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-10T20:58:30.543

我有一个类似的问题，结果是由于字段的命名。

```
<form method="post" action="/company/update/3">
   Name:
   <%= Html.TextBox("Company.Name")%>
   FEIN:
   <%= Html.TextBox("FEIN")%>

   <input type="submit" value="submit" />
</form> 
```

当发布到：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index(int id, Company company)
{
    //Company.FEIN is null!
} 
```

如果 Company.Name 是发布的第一个值，这似乎会发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T00:32:36.200

Steve 我遇到了类似的问题，我发现这是因为我的模型上有属性 Key 和 Value，而模型绑定器不喜欢这些属性。

尝试将用户名更改为用户和密码以通过，看看问题是否仍然存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-22T06:22:37.813

您可以尝试在运行时将调试器附加到 MVC 源代码，以查看引擎盖/引擎盖下发生了什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-25T07:11:11.100

请将 name 属性添加到您的控件 (Html.TextBox("UserName"))

# c++ - 为什么很多虚拟机看起来都具有 C++ 特性，却是用 C 编写的？

> ID：780027
> 
> 赞同：4
> 
> 时间：2009-04-23T01:58:12.637
> 
> 标签：c++, c, programming-languages, vm-implementation

我注意到一些不太古老的 VM 语言，例如用 C 编写的 Lua、NekoVM 和 Potion。

看起来他们正在重新实现许多 C++ 特性。

用 C 而不是 C++ 编写它们有什么好处吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-23T02:30:51.157

我对 Lua 有所了解。

*   Lua 是用纯 ANSI 标准 C 编写的，可以在任何 ANSI 平台上编译，没有错误和警告。因此**，Lua 几乎可以在世界上任何平台上运行**，包括[佳能 PowerShot 相机](http://chdk.wikia.com/wiki/LUA)之类的平台。让 C++ 在奇怪的小型嵌入式平台上运行要困难得多。

*   Lua 是一个高性能 VM，由于 C 不能表达方法调用（可能是虚拟的，也可能不是）和运算符重载，因此仅通过查看**代码就更容易预测 C 代码的性能。**C++，尤其是模板库，使得在不知不觉中烧毁资源有点太容易了。（Lua 的完整实现不仅包括 VM，还包括库，适合 145K 的 x86 目标代码。整个语言甚至适合一个很小的 ​​256K 缓存，你可以在 Intel i7 上的 L2 和旧芯片上的 L1 中找到它。除非你真的知道什么你正在做，编写编译成这么小的东西的 C++ 要困难得多。）

这是用 C 编写 VM 的两个很好的理由。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T02:56:55.587

> 看起来他们正在重新实现许多 C++ 特性。

您是否建议在 C++ 中实现多态性比在 C 中更容易？我认为你大错特错了。

如果你用 C++ 编写一个 VM，你就不会根据 C++ 的多态性来实现多态性。您将推出自己的虚拟表，将函数名称映射到指针或类似的东西。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-23T02:01:10.120

人们习惯了 C。我不得不承认，我更有可能为自己的项目编写 C，即使我从 cfront 1.0 开始就一直在编写 C++。

如果您想完全控制事物，C 会更容易一些。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-23T02:43:09.177

一个明显的答案是互操作性。任何时候语言 X 必须调用在语言 Y 中定义的函数，您通常要确保 X 或 Y 是 C（即语言 C）

C++ 没有定义 ABI，因此从另一种语言调用 C++ 代码在可移植性方面有点棘手。但是调用 C 代码几乎是微不足道的。这意味着您的虚拟机的至少一部分可能必须用 C 编写，那么为什么不保持一致并用 C 编写整个东西呢？

C的另一个优点是它很简单。每个人都可以阅读它，并且有很多程序员可以帮助您编写它。无论好坏，C++ 更像是一种专家语言。你可以用 C++ 做很多令人印象深刻的事情，它可以为你节省很多工作，但真正擅长它的程序员也很少。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-23T02:11:27.693

在 C++ 中“精通”要困难得多，在精通 C++ 之前，他们会遇到很多错误和问题。现在，尤其是在与很多人一起处理大型项目时，其中一个不够好的机会要大得多，因此用 C 编写项目通常风险较小。还有可移植性问题 - C 代码比 C++ 更容易跨编译器移植。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-23T13:27:41.047

Lua 还有很多在 Lisp 中很容易实现的特性，那为什么不以此为基础呢？关键在于，C 语言只不过是经过美化的汇编代码，只有一层薄薄的抽象。它就像一块经过打磨的白板，您可以在其上构建更高级别的抽象。C++就是这样一个建筑。Lua 是一个不同的建筑，如果它必须使用 C++ 抽象，它就必须围绕现有的 C++ 结构弯曲它的意图。相反，从白板开始，您可以自由地按照自己的意愿构建它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T02:00:37.127

C++ 是用 C 实现的。我怀疑每个人都在遵循 C++ 方法。

尽管现代 C++ 编译器跳过（或隐藏）显式 C++ 到 C 的转换作为一个离散步骤，但 C++ 语言具有源于底层 C 实现的特性。

两个例子。

*   除了引用之外的指针完全是因为 C。引用就足够了，这就是 Java、Python 和 Ruby 的工作方式。

*   这些类不是运行时存在的一流对象，因为类只是在底层 C 代码中定义属性和方法函数的一种方式。类对象在 Java、Python 和 Ruby 中运行时存在，并且可以被操作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T02:35:48.740

在许多情况下，C 中的代码可能比 C++ 快得多。例如，stdio.c 库中的大多数函数都比 iostream 快。scanf 比 cin 快， printf 比 cout 快等。

并且 VM 需要高性能，因此 C 代码非常有意义，尽管程序很可能需要更长的时间来开发。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-23T22:34:33.293

顺便说一句，您应该查看 CLR（Rotor-incarnation）和 Java 源代码，您会注意到它更像是 C++-as-C，而不是现代或好的 C++。所以它在那里有一个相似之处，它是对玩具进行抽象并使其平均性能对托管语言中的人群感到满意的副作用。

它还有助于避免天真的 C++ 使用的陷阱。例外情况和所有其他类型的事情（大卫在 boost 咨询中开始工作等等，而我们在他还没有工作之前就构建了音序器和音频采样 :) 也是一个问题。

Python 集成是另一回事，例如，在 boost 方面有一段混乱的历史。但是对于原始数据类型和接口/互操作和机器抽象，很明显没有什么比 C 更好。也没有编译器问题，它仍然引导很多东西在你得到任何有影响力的东西之前/曾经/将要。

Stepanov 在完成 STL 时就认识到了这一成就，而 Bjarne 则通过模板实现了这一成就。这三件事总是值得考虑的，因为在流行的托管语言中它们没有像样的化身，而不是那种表现力和力量。所有这一切都在 20 多年后，这是了不起的，并且仍然通过 C/C++ 引导。善良的遗产（但我并不是在为“黑暗时代”C 代码 c1982-2000 辩护，只是这个想法，你可以滥用任何东西）。

# iphone - 将 XML 文件编译成二进制文件

> ID：780037
> 
> 赞同：0
> 
> 时间：2009-04-23T02:02:18.837
> 
> 标签：iphone, objective-c, file, resources

我想在 iPhone 应用程序中解析和 XML 文件，而无需使用磁盘。我可以这样做吗？如何？我在使用 MSVC 的应用程序中包含了 TXT 帮助文件。

我将 XML 文件放在项目中名为 Resources 的文件夹/组中。
我在 proj 目录中有 XML 文件。
我右键单击 Resources 文件夹并选择*add -> Existing File*。
我右键单击 XML 文件并选择*GetInfo*。

在那里我尝试改变路径类型 {Absolute, Relative to Project 等}
我的程序在模拟器上运行良好，当我使用时：

```
NSString * const DG_XmlRecipeFile = @"/Users/appleuser/Cocoa/iHungry6/Recipes.xml"; 
```

在我看来，它也应该适用于：

```
NSString * const DG_XmlRecipeFile = @"Recipes.xml"; 
```

如果我正确设置了路径类型。它不是。

我是第一个计时器。感谢您阅读本文，马克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T04:12:23.067

Xcode 将项目资源复制到应用程序包。您可以按如下方式访问捆绑包中的文件：

```
NSString *DG_XmlRecipeFile = [[NSBundle mainBundle] pathForResource:@"Recipes" ofType:@".xml"]; 
```

捆绑包中的文件是只读的。如果要修改文件，则需要将其复制到可以修改的位置。您的应用程序的 Documents 目录适用于此。

```
NSArray  *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *docsDirectory = [[paths objectAtIndex:0] retain];
NSString *newFilePath = [docsDirectory stringByAppendingPathComponent:@"Recipes.xml"];    
NSError  *error = nil;

[[NSFileManager defaultManager] copyItemAtPath:DG_XmlRecipeFile toPath:newFilePath error:&error]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T04:34:44.727

我不认为您所指的路径类型是生成的应用程序包中资源的路径。这是在 .proj 文件中引用文件的方式。

# jquery - jQuery AJAX 语法

> ID：780038
> 
> 赞同：10
> 
> 时间：2009-04-23T02:02:21.240
> 
> 标签：jquery, ajax, web-services, post

我正在尝试找到正确的语法来将变量传递给我的 JQuery Post。

```
var id = empid;

$.ajax({
    type: "POST",
    url: "../Webservices/EmployeeService.asmx/GetEmployeeOrders",
    data: "{empid: empid}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(result) {
        alert(result.d);
    } 
```

我不认为 data: value 是完全正确的。有人让我直截了当？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-23T02:11:05.323

这个怎么样：

```
var id = empid;

$.ajax({
    type: "POST",
    url: "../Webservices/EmployeeService.asmx/GetEmployeeOrders",
    data: "{empid: " + empid + "}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(result){
        alert(result.d);
        console.log(result);
    }
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-03-25T08:12:18.923

完整的ajax语法

```
var data="abc";
       $.ajax({
            type: "GET",
            url: "XYZ",
            data: {
                "data":data,
            },
            dataType: "json",

            //if received a response from the server
            success: function( datas, textStatus, jqXHR) {

            },

            //If there was no resonse from the server
            error: function(jqXHR, textStatus, errorThrown){

            },

            //capture the request before it was sent to server
            beforeSend: function(jqXHR, settings){

            },

            //this is called after the response or error functions are finished
            //so that we can take some action
            complete: function(jqXHR, textStatus){

            }

        }); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-23T02:09:31.923

[`data`](http://docs.jquery.com/Ajax/jQuery.ajax#options)可以是 URL 编码的字符串或对象：

```
data: {empid: empid}, 
```

或者

```
data: "empid=" + empid, 
```

文档说：

> 要发送到服务器的数据。如果还不是字符串，则将其转换为查询字符串。它附加到 GET 请求的 url。请参阅 processData 选项以防止此自动处理。对象必须是键/值对。如果 value 是一个数组，jQuery 使用相同的键序列化多个值，即 {foo:["bar1", "bar2"]} 变为 '&foo=bar1&foo=bar2'。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-23T02:10:07.960

这应该适合你。

```
$.ajax({
    type: "POST",
    url: "../Webservices/EmployeeService.asmx/GetEmployeeOrders",
    data: {empid: empid},
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(result) {
        alert(result.d);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T02:13:43.053

它不是。你正在传递一个字符串，你应该传递一个对象文字，例如

```
data: {"empid" : empid} 
```

看到不同？假设**empid**是一个具有某种值的变量，那应该可以正常工作。或者你可以这样做

```
data: "empid="+empid 
```

[http://docs.jquery.com/Ajax/jQuery.ajax#options](http://docs.jquery.com/Ajax/jQuery.ajax#options)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-06T17:07:18.210

虽然不是您问题的直接答案，但以下是我们的一个项目中用于 jquery 调用的常用函数方法

[$.proxy() 方法](http://www.w3schools.com/jquery/event_proxy.asp)

> Proxy 方法采用现有函数并返回具有特定上下文的新函数。

**语法**

```
$(selector).proxy(function,context)
$(selector).proxy(context,name) 
```

**代码**

```
dpInvokeAsync: function (serviceRequest, input, requestType, successCallBack) {
        var url = BASE_URL + serviceRequest;
        $.ajax({
            type: requestType,
            url: url,
            async: true,
            data: input,
            dataType: 'json',
            success: $.proxy(successCallBack, this),
            error:  $.proxy(this.handleFailure, this)
        });
    }

   this.dpInvokeAsync('App/ShowParts', searchCriteria, 'Post',
                      function (result) { alert(result);}
                      ); 
```

**参考**

1.  [AJAX 成功中的 $(this) 不起作用](https://stackoverflow.com/questions/6394812/this-inside-of-ajax-success-not-working)
2.  [jQuery 跨域 AJAX 请求方法](http://jquery-howto.blogspot.com/2013/09/jquery-cross-domain-ajax-request.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T02:10:12.157

```
 $(document).ready(function() {
  $.ajax({
    type: "POST",
    url: "Webservices/EmployeeService.asmx/GetEmployeeOrders",
    data: "{'EmployeeId':'empid'}", **<-- see the single quotes**
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
          alert(msg);
         }
  });
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T02:17:36.007

如果你想向服务器发送一个 JSON 字符串

```
data: "{empid: " + empid + "}" 
```

如果你想发送查询字符串参数 (?empid=123)

```
data: {empid : empid} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-10T06:38:44.243

您可以使用以下内容。

```
var id = empid;

$.ajax({
    type: "POST",
    url: "../Webservices/EmployeeService.asmx/GetEmployeeOrders",
    data: "var1=val1&var2=val2&var3=val3&var4=val4&var5=val5",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (result) {
        alert(result.d);
    } 
```

# django - 有什么比 Django 的平面页面更好的吗？

> ID：780039
> 
> 赞同：5
> 
> 时间：2009-04-23T02:02:26.450
> 
> 标签：django, content-management-system, django-flatpages

我想知道是否有比 Django 的 flatpages 应用程序更好的东西，因为 flatpages 甚至不支持状态（草稿、已发布）或发布日期之类的东西。外面有什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T02:31:08.720

[django-cms](http://django-cms.org/)是类固醇的平面页面。开发版本变得过于复杂，但当前版本非常出色。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T19:28:14.320

我会限定hasen j的答案。我很幸运地扩展了 flatpages 应用程序本身。查看这些来源，然后添加您需要的字段并更新视图。不难。

[http://overtag.dk/wordpress/2008/07/tip-extending-django-flatpages/](http://overtag.dk/wordpress/2008/07/tip-extending-django-flatpages/)

[http://mrlauer.wordpress.com/2008/05/31/a-little-django-flatpage-trick/](http://mrlauer.wordpress.com/2008/05/31/a-little-django-flatpage-trick/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T02:33:03.380

只是滚动你自己的。

应该比较简单，真的！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-15T10:22:59.767

使用平面模型创建一对一映射怎么样？我自己从来没有这样做过，但我想它应该工作。

# c++ - 关于 UDP/IP 和 sendto/recvfrom 返回值的混淆

> ID：780041
> 
> 赞同：2
> 
> 时间：2009-04-23T02:03:15.060
> 
> 标签：c++, networking, udp

我第一次在 C++ 中使用 UDP 套接字，但我不确定我是否理解它们是如何工作的。我知道`sendto`/`recvfrom`和`send`/`recv`通常返回实际发送或接收的字节数。我听说这个值可以任意小（但至少为 1），并且取决于套接字缓冲区中有多少数据（读取时）或缓冲区中剩余多少可用空间（写入时）。

如果`sendto`且`recvfrom`仅保证一次发送或接收 1 个字节，并且可以乱序接收数据报，那么任何 UDP 协议如何保持一致？这不是意味着当我收到消息中的字节时可以任意打乱它们吗？有没有办法保证一次发送或接收一条消息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T02:05:42.900

它比那强一点*。*UDP 确实提供了一个完整的包；缓冲区大小可以任意小，但它必须包含数据包中发送的所有数据。但也有大小限制：如果要发送大量数据，则必须将其分成数据包并自己重新组装。它也不能保证交货，因此您必须检查以确保一切顺利。

但是由于您可以使用 UDP 实现所有 TCP，因此它必须是可能的。

通常，您使用 UDP 所做的就是制作离散的小数据包。

打个比方，把 UDP 想象成发送明信片，把 TCP 想象成打电话。当您发送明信片时，您无法保证送达，因此您需要做一些事情，比如回复确认函。通过一个电话，您知道连接存在，并且您会立即听到答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T02:12:44.147

不会。使用 sendto，您可以发送数据包，其中可以包含一个字节。如果您将 10 个字节作为单个 sendto 调用发送，这 10 个字节将被发送到一个数据包中，这将像您期望的那样被连贯地接收。

当然，如果您决定一个接一个地发送这 10 个字节，每个字节都带有一个 sendto 调用，那么实际上您发送和接收 10 个不同的数据包（每个包含 1 个字节），它们可以是任意顺序的。

这类似于通过邮政服务发送一本书。您可以将整本书打包到一个盒子中，或者撕下每一页并将每一页作为单独的信件发送。在第一种情况下，包裹比较大，但您收到的书是一个单独的、有序的实体。在后者中，每个包都很轻，但祝你好运；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T03:55:05.587

实际上你可以发送一个 0 字节长度的 UDP 数据报。发送的只是 IP 和 UDP 标头。另一端的 UDP recvfrom() 将返回长度为 0。与 TCP 不同，这并不意味着对等方关闭了连接，因为使用 UDP 没有“连接”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-21T15:21:56.483

我有一个客户端程序，它在专用于等待 UDP 套接字上的传入数据的线程中使用阻塞选择（NULL 超时参数）。即使它是阻塞的，select 有时也会返回一个指示单个读取描述符已“准备好”的指示。随后的 recvfrom 返回 0。

经过一些实验，我发现至少在 Windows 上，*将*UDP 数据包发送到不期望它的主机上的端口会导致后续的 recvfrom 获得 0 字节。我怀疑某种拒绝通知可能来自另一端。我现在用它来提醒我，我忘记在服务器上启动查找客户端传入流量的进程。

顺便说一句，如果我改为“发送”一个有效但未使用的 IP 地址，则选择不会返回就绪状态并按预期阻止。我还发现阻塞与非阻塞套接字没有区别。

# xcode - XCode 中的多行光标移动

> ID：780048
> 
> 赞同：2
> 
> 时间：2009-04-23T02:09:18.400
> 
> 标签：xcode, key-bindings

我想映射一个键以将 XCode 中的光标向上移动十行。当然，我也想再下一个。理想情况下，键映射类似于“Control-Alt-P”。

有没有办法在 XCode 中实现这一点而不求助于 Automator？

* * *

Ashley 在下面给出了答案，格式有点不同，因为属性列表是 XML 格式。

总之，在 ~/Library/Application Support/Xcode/Key Bindings/ 中 *.pbxkeys 的“文本”部分添加了以下格式的条目：

```
 <key>^~p</key>
    <array>
        <string>moveUp:</string>
        <string>moveUp:</string>
    </array> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T08:04:16.533

您可以使用[此处](https://stackoverflow.com/questions/476953/delete-line-hot-key/477961#477961)给出的示例并使用`DefaultKeyBinding.dict`文件，除了使用`moveUp:`和`moveDown:`作为您的选择器。

您的特定字典条目将如下所示：

```
{
    "^~P" = (
        "moveUp:",
        "moveUp:",
        "moveUp:",
        ... however many times ...
        "moveUp:",
    );
} 
```

从那以后我了解到，如果您已经通过 Xcode 自定义了键绑定，则应该将相同的字典条目添加到字典部分`.pbxkeys`下的文件中。`text`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-15T17:11:58.043

只是提醒那些没有一直阅读到 oldbeamer 问题结尾并且还希望使用 .pbxkeys 而不是 .dict 的不耐烦的人：

如果您想将多动作键绑定添加到您的 pbxkeys 文件，XML 格式如下所示：

```
 <key>...</key>
    <array>
            <string>action1:</string>
            <string>action2:</string>
            <string>etc:</string>
    </array> 
```

您可以使用文本编辑器直接编辑 .pbxkeys 以通过这种方式添加自定义多动作键绑定。

# python - 如何从 range() 函数中获取最后一个数字？

> ID：780057
> 
> 赞同：6
> 
> 时间：2009-04-23T02:13:42.617
> 
> 标签：python, range, fibonacci

有没有办法从`range()`函数中获取最后一个数字？我需要获取斐波那契数列中前 20 个术语的最后一个数字，还是应该使用列表而不是`range()`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-23T02:20:11.760

不太确定你在这里追求什么，但这里有：

```
rangeList = range(0,21)
lastNumber = rangeList[len(rangeList)-1:][0] 
```

或者：

```
lastNumber = rangeList[-1] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T02:21:27.870

在*范围内*，您是指生成器提供的最后一个值吗？如果是这样，您可以执行以下操作：

```
def fibonacci(iterations):
    # generate your fibonacci numbers here...

[x for x in fibonacci(20)][-1] 
```

这将为您提供最后生成的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T02:25:33.587

我认为没有人认为您需要斐波那契数。不，您必须存储每个数字才能递归地构建斐波那契数列，但是有一个公式可以得到斐波那契数列的第 n 项。

[比奈公式](http://mathworld.wolfram.com/BinetsFibonacciNumberFormula.html)

如果您需要列表的最后一个数字，请使用 myList[-1]。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T02:16:05.090

这就是你所追求的吗？

```
somerange = range(0,20)
print len(somerange) # if you want 20
print len(somerange)-1 # if you want 19 
```

现在，如果您想要列表中包含的数字或项目...

```
x = [1,2,3,4]
print x[len(x)-1]
# OR
print x[-1] # go back 1 element from current index 0, takes you to list end 
```

# javascript - 使用 IE8 的“开发者工具”调试早期的 IE 版本

> ID：780059
> 
> 赞同：5
> 
> 时间：2009-04-23T02:14:08.903
> 
> 标签：javascript, internet-explorer-6, internet-explorer-8, internet-explorer-7, firebug

我对带有 IE6 和 7 个特定错误的页面的 HTML/CSS/JS 调试不太满意。

我知道 IE8 安装了一个名为“开发者工具”的 Firebug 克隆。

是否可以安装 IE8（可能在 VM 上，我不介意），将其设置为兼容模式（IE6 有吗？），然后**使用 IE8 开发人员工具**执行 JS 调试和实时 HTML 更改，只需就像我们可以在 Firebug 中一样？

非常感谢 mieze

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T02:24:48.567

我已经说过了，我再说一遍：

[萤火虫精简版](http://getfirebug.com/lite.html)

这将使您可以在当天使用的任何浏览器中使用 Firebug 功能......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T09:11:27.637

原生 IE6/7 和 IE8 兼容模式有区别：http: [//blogs.msdn.com/ie/archive/2009/03/12/site-compatibility-and-ie8.aspx](http://blogs.msdn.com/ie/archive/2009/03/12/site-compatibility-and-ie8.aspx)

我发现在 IE6/7 中调试的最佳选择是安装与 Microsoft Office 捆绑在一起的 Microsoft Script Editor（不是 Debugger）。这是一个可选安装，因此您可能必须在控制面板中打开添加删除程序并再次进行设置。这是安装 Microsoft 脚本编辑器后配置 IE 的指南。 [http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html](http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html)

默认视图没有断点等，因此请查看菜单以添加您喜欢的视图。它不如 Firebug，但比警报调试好得多；）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-24T15:41:38.150

我所拥有的最令人满意的 IE6/7/8 javascript 调试体验是使用 Visual Studio。而且您也不必花大价钱来获得它，因为 Express 版具有与更高 SKU 相同的调试器。

1.  安装 Visual Studio 速成版（[下载](http://www.microsoft.com/express/Downloads/.)）
2.  创建一个新项目
3.  点击调试启动空项目
4.  您现在拥有一个在世界级调试器中运行的 IE 实例！

只需将浏览器指向您的测试 URL 并为您的心内容设置断点！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-08T03:19:59.200

您可能想尝试 MS javascript 调试器[http://www.microsoft.com/downloads/details.aspx?FamilyID=2f465be0-94fd-4569-b3c4-dffdf19ccd99&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=2f465be0-94fd-4569-b3c4-dffdf19ccd99&displaylang=en)
虽然并非没有问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-24T15:49:07.777

IE8 开发工具是[IE Developer Toolbar](http://www.microsoft.com/downloads/details.aspx?familyid=e59c3964-672d-4511-bb3e-2d5e1db91038&displaylang=en)的升级版，可用于 6 和 7。它不进行调试，但可以让您检查 DOM 等。将其与 JS 调试器结合使用（如其他答案）尽你所能，afaik

# sql - 一个关于数据库事务的新手问题

> ID：780066
> 
> 赞同：2
> 
> 时间：2009-04-23T02:16:35.340
> 
> 标签：sql, mysql, sql-server, transactions

我知道数据库事务用于确保事务中的所有语句都将被执行，或者它们都不执行。

但是锁定和线程安全呢，例如，如果我有一个影响多个表的存储过程，并且我在该存储过程中使用了一个事务，该存储过程同时从不同的客户端调用，这些事务是并行工作还是并行工作？排队？换句话说，使用事务是否保证它将“锁定”所有其他客户端并导致它们等待事务完成？

SQL Server 和 MySQL 中的数据库事务之间还有什么区别吗？我的意思是他们的工作方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T02:20:16.143

取决于 DBMS，但存储过程通常不被锁定，数据库表中的行被锁定，这就是防止两个存储过程相互干扰的原因。

这具有更精细的锁定粒度，因此不太可能引起争用。

关于 SQLServer 和 MySQL 之间的差异，我不会在较低级别知道 - 它们很可能会做截然不同的事情。但是它们在 SQL 标准方面是相同的（否则它们将毫无用处）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T03:23:17.287

TStamper 已经提供了 SQL Server 与 MySQL 的链接，但如果您对一般事务行为感兴趣，请查看以下链接：

[http://www.oracle.com/technology/oramag/oracle/05-nov/o65asktom.html](http://www.oracle.com/technology/oramag/oracle/05-nov/o65asktom.html) [http://en.wikipedia.org/wiki/Isolation_(database_systems)](http://en.wikipedia.org/wiki/Isolation_(database_systems))

隔离级别因 DBMS 而异。一些 DBMS 系统允许您配置隔离级别（较高的隔离级别通常意味着由于争用而导致的较低速度/吞吐量）。

# asp.net - 在 SharePoint Web 应用程序级别处理所有 SPItem 的最佳方法是什么？

> ID：780070
> 
> 赞同：3
> 
> 时间：2009-04-23T02:17:56.787
> 
> 标签：asp.net, sharepoint, sharepoint-2007

在 Share Point Web 应用程序级别处理所有新添加到 SharePoint 列表和文档库的文档和项目的最佳方式是什么。

我的情况是，当添加任何新文档或项目时，我想对数据库进行一些插入。

### 笔记：

1- 网站集、网站或子网站和列表**未**预定义。

2- 我需要在现有和新的文档库和列表上应用处理程序。

### 我目前的选择是：

1-分析共享点日志。

2-将事件接收器添加到所有 SPLists。

有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T02:24:01.983

我们在 Sharepoint 系统上广泛使用事件接收器。它们非常可靠且易于编写。[您可以使用站点级别范围内的功能注册事件接收器](http://msdn.microsoft.com/en-us/library/ms475328.aspx)，因此它将针对您指定的列表类型在该站点集中发生的所有 SPListItem 事件（添加、更新、删除等）触发。

# perl - 为什么我的命令行不能从 cron 运行？

> ID：780072
> 
> 赞同：5
> 
> 时间：2009-04-23T02:18:31.730
> 
> 标签：perl, shell, cron, environment-variables

我有一个 perl 脚本（特别是[XMLTV](http://wiki.xmltv.org/index.php/Main_Page)系列“抓取器”的一部分[`tv_grab_oztivo`](http://web.aanet.com.au/auric/?q=node/14)）。

我可以像这样成功运行它：

```
/sw/bin/perl /path/to/tv_grab_oztivo --output /path/to/tv.xml 
```

我使用所有内容的完整路径来消除工作目录的问题。权限应该不是问题。

所以，如果我从终端（Mac OSX）运行它就可以了。

但是当我将它设置为通过 cron 作业运行时，似乎什么都没有发生。没有创建输出等。

据我所知，crontab 没有任何问题，因为如果我用 helloworld.pl 代替实际脚本，它会在正确的时间运行得很好。

那么，我能做些什么来调试呢？从这`%ENV`两种情况下我可以看出环境非常不同，但是我可以采取哪些其他方法进行调试？我怎样才能看到 cron 作业的输出，这可能是来自 shell 的某种 perl “死”消息或“未找到”消息或其他什么？

还是我应该尝试以某种方式为命令的 cron 版本提供与它运行时相同的环境？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T02:24:38.863

这*通常*是因为您在 cron 下运行时没有获得完整的环境。最好的办法是使用以下命令捕获输出：

```
( /sw/bin/perl /path/to/tv_grab_oztivo ... ) >/tmp/qq 2>&1 
```

然后看看`/tmp/qq`。

如果它确实是一个缺失的环境，那么您可能需要放置：

```
. ~/.profile 
```

或类似的东西，进入您的 cron 作业的执行链，例如：

```
( . ~/.profile ; /sw/bin/perl /path/to/tv_grab_oztivo ... ) >/tmp/qq 2>&1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T02:26:14.147

如果您在这两种情况下查看 %ENV，我建议作为 perl 脚本的第一步，将 %ENV 设置为 cron 作业中的内容，然后尝试从命令行运行它. 您可能需要自己执行一次才能完全控制：

```
BEGIN {
  if (exists $ENV{something_in_your_env_not_in_cron}) {
     %ENV = (...);
     exec $^X, $0, @ARGV;
  }
} 
```

现在尝试运行它，看看是否可以做任何事情来调试它（如果需要，包括在 perl -d 下运行）。最有可能的是，您最终会一次又一次地将项目添加回 %ENV，直到它神奇地开始工作（LD_LIBRARY_PATH 是一个很好的选择，但是用于 Oracle 或 DB2 应用程序的 ORACLE_HOME 或 DB2HOME 也可能是不错的选择）。然后，您可以在脚本或 crontab 中设置变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T02:26:21.823

我会通过 cron 命令的绝对路径运行一个简单的 shell 脚本。在该脚本中，我将确保将 stdout 和 stderr 捕获到已知（或可知）文件中。我还要确保设置了足够的环境。在 Unix 上，当您通过 cron 运行命令时，您几乎没有设置任何环境 - 我不确定 MacOS X。问题的标准罪魁祸首是 PATH。我有一个单独`.cronfile`的设置我的工作环境，我通常没有问题 - 这是一个类似的`.profile`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T02:30:02.047

有时，如果你无法弄清楚你的命令行出了什么问题，最简单的修复方法是将整个事情变成一个 shell 脚本。理想情况下，您*不必*这样做，但它可能是解决问题的最快方法。

文件：`/files/cron1.sh`

```
#!/bin/sh
/sw/bin/perl /path/to/tv_grab_oztivo --output /path/to/tv.xml 
```

然后在 cron 中：

```
/files/cron1.sh 
```

这允许您独立于 cron 测试脚本。请记住，您的登录 shell 使用与 cron 不同的环境变量运行。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-23T02:24:22.857

[cron](http://en.wikipedia.org/wiki/Cron)通常捕获 stdout 和 stderr 的输出并将任何输出通过电子邮件发送给 crontab 所有者。

您是否仔细检查了您的 crontab 条目以确保它有效并且将在正确的时间执行？

确保脚本不需要设置任何环境变量。否则将其包装在另一个 (bash) 脚本中，您可以在其中设置其他脚本期望的环境变量。

# delphi - 是否没有为在 Windows Server 2008 (sp1) 上运行的 Delphi 应用程序回收内存？

> ID：780073
> 
> 赞同：3
> 
> 时间：2009-04-23T02:19:04.647
> 
> 标签：delphi, memory, memory-leaks, windows-server-2008, critical-section

我们有一个 D2007 应用程序，它在 Windows Server 2008（x64，sp1）上运行时内存占用量稳定增长。
它在 Windows Server 2003（x32 或 x64）、XP 等上正常运行......它按预期上升和下降。
我们已经尝试使用包含的内存管理器或最新的 FastMM4 4.92，结果相同。

有没有人试图在 Win2008 上监控任何 Delphi 应用程序的内存使用情况并确认？
或者会有什么线索？

精度：
- 没有一般意义上的内存泄漏（是的，我对 FastMM 等人非常熟悉）
- 使用 Process Explorer 监控内存使用情况；虚拟内存（私有字节）和物理内存（WorkingSet Private）在 Win2008 上都在增长
- 即使存在内存压力，内存消耗仍在增长。（这就是我们来调查的原因，因为它导致了失败，但仅限于 Win2008 机器）

**更新**： //** repaced **// 代码比我们的应用程序简单得多，但表现出相同的行为。
创建一个包含 10,000,000 个对象和 10,000,000 个接口的列表，执行 2 次后，在 Windows Server 2008 上执行 100 次后，使用的内存将增加约 60MB 和大约 300MB，但只是返回到它在 XP 上的位置。
如果您启动多个实例，则不会释放内存以允许其他实例运行。相反，页面文件增长并且服务器爬网......

**更新 2**：见[QC 报告 73347](http://qc.embarcadero.com/wc/qcmain.aspx?d=73347)
经过进一步调查，我们已将**其追踪到关键部分**，如下面的代码所示。
将该代码放入带有 Button 的简单 VCL 应用程序中。并使用 Process Explorer 进行监控：
它从 ~2.6 MB 开始，运行 5 次后（单击按钮）保持在 ~118.6MB。
在 5 次执行中丢失了 116MB。

```
//***********************
const
  CS_NUMBER = 10000000;
type
  TCSArray = Array[1..CS_NUMBER] of TRTLCriticalSection;
  PCSArray = ^TCSArray;

procedure TestStatic;
var
  csArray: PCSArray;
  idx: Integer;
begin
  New(csArray);

  for idx := 1 to length(csArray^) do
    InitializeCriticalSection(csArray^[idx]);

  for idx := 1 to length(csArray^) do
      DeleteCriticalSection(csArray^[idx]);

  Dispose(csArray);
end;

procedure TestDynamic(const Number: Integer);
var
  csArray: array of TRTLCriticalSection;
  idx: Integer;
begin
  SetLength(csArray, Number);

  for idx := Low(csArray) to High(csArray) do
    InitializeCriticalSection(csArray[idx]);

  for idx := Low(csArray) to High(csArray) do
      DeleteCriticalSection(csArray[idx]);
end;

procedure TForm4.Button1Click(Sender: TObject);
begin
  ReportMemoryLeaksOnShutdown := True;
  TestStatic;
  TestDynamic(CS_NUMBER);
end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T17:48:00.627

有一个名为[VMMap](http://technet.microsoft.com/en-us/sysinternals/dd535533.aspx)的新 sysinternals 工具可以可视化分配的内存。也许它可以告诉你什么是大内存块。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-08-05T21:32:23.403

实际上，微软对关键部分进行了更改以添加一些调试信息。这个调试内存直到应用程序结束才被释放，而是以某种方式缓存和重用，这就是为什么一段时间后它可以稳定下来的原因。

如果您想创建大量关键部分而不会感受到这种内存损失，解决方案是修补 VCL 代码以**`InitializeCriticalSection`**通过调用替换调用**`InitializeCriticalSectionEx`**并将其传递标志**`CRITICAL_SECTION_NO_DEBUG_INFO`**以避免创建调试结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T08:57:50.150

您是否包含带有完整调试模式的 FastMM？只需将 FastMM4 单元直接包含在您的项目中并设置

```
ReportMemoryLeaksOnShutdown := True 
```

如果没有报告任何内容，则程序退出时通常会释放所有内容（可能是因为引用计数）。您可以使用[AQTime](http://www.automatedqa.com/products/aqtime/index.asp)实时监控内存。使用此应用程序，您可以看到每个类名和其余已用内存的字节“计数”。也许你可以看到谁在使用内存。限时演示版足以胜任这项工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T19:08:14.927

您指的是私有字节、虚拟大小还是工作集？[从 SysInternals](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)运行Process Explorer以监视内存，以便更好地了解正在发生的事情。

我对此没有任何具体经验（尽管我正在运行 2008 x64 SP1，因此可以对其进行测试），但我建议您创建一个分配大量内存然后释放它的测试应用程序。[从 SysInternals](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)运行Process Explorer以监视内存。

如果您测试应用程序重现相同的行为，然后尝试通过在另一个进程中分配内存来产生一些内存压力 - 除非回收第一个进程中先前释放的内存，否则它将失败。

如果仍然失败，请尝试使用不同的内存管理器。也许是 FastMM 在做这件事。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T07:33:57.233

检查您是否有[此问题](http://qc.embarcadero.com/wc/qcmain.aspx?d=67690)（这是另一个问题，与我在对您问题的评论中提到的问题无关）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-04T22:28:04.743

我做了这段代码来纠正我的应用程序中的这个问题。与 FastCode 的情况相同，要使修复运行，您必须将该单元作为项目的第一个单元。就像这种情况下的 uRedirecionamentos 一样： ![在此处输入图像描述](https://i.stack.imgur.com/Q8LIP.png)

```
unit uCriticalSectionFix;
// By Rodrigo F. Rezino - rodrigofrezino@gmail.com

interface

uses
  Windows;

implementation

uses
  SyncObjs, SysUtils;

type
  InitializeCriticalSectionExProc = function(var lpCriticalSection: TRTLCriticalSection; dwSpinCount: DWORD; Flags: DWORD): BOOL; stdcall;

var
  IsNewerThenXP: Boolean;
  InitializeCriticalSectionEx: InitializeCriticalSectionExProc;

type
  PJump = ^TJump;
  TJump = packed record
    OpCode: Byte;
    Distance: Pointer;
  end;

  TCriticalSectionHack = class(TSynchroObject)
  protected
    FSection: TRTLCriticalSection;
  public
    constructor Create;
  end;

function GetMethodAddress(AStub: Pointer): Pointer;
const
  CALL_OPCODE = $E8;
begin
  if PBYTE(AStub)^ = CALL_OPCODE then
  begin
    Inc(Integer(AStub));
    Result := Pointer(Integer(AStub) + SizeOf(Pointer) + PInteger(AStub)^);
  end
  else
    Result := nil;
end;

procedure AddressPatch(const ASource, ADestination: Pointer);
const
  JMP_OPCODE = $E9;
  SIZE = SizeOf(TJump);
var
  NewJump: PJump;
  OldProtect: Cardinal;
begin
  if VirtualProtect(ASource, SIZE, PAGE_EXECUTE_READWRITE, OldProtect) then
  begin
    NewJump := PJump(ASource);
    NewJump.OpCode := JMP_OPCODE;
    NewJump.Distance := Pointer(Integer(ADestination) - Integer(ASource) - 5);

    FlushInstructionCache(GetCurrentProcess, ASource, SizeOf(TJump));
    VirtualProtect(ASource, SIZE, OldProtect, @OldProtect);
  end;
end;

procedure OldCriticalSectionMethod;
asm
  call TCriticalSection.Create;
end;

{ TCriticalSectionHack }

const
  CRITICAL_SECTION_NO_DEBUG_INFO = $01000000;
  NEW_THEN_XP = 6;

constructor TCriticalSectionHack.Create;
begin
  inherited Create;
  if IsNewerThenXP then
    InitializeCriticalSectionEx(FSection, 0, CRITICAL_SECTION_NO_DEBUG_INFO)
  else
    InitializeCriticalSection(FSection);
end;

procedure AdjustMethod;
var
  LKernel32: HModule;
begin
  if IsNewerThenXP then
  begin
    LKernel32 := LoadLibrary('kernel32.dll');
    @InitializeCriticalSectionEx := GetProcAddress(LKernel32, 'InitializeCriticalSectionEx');
  end;
end;

initialization
  AddressPatch(GetMethodAddress(@OldCriticalSectionMethod), @TCriticalSectionHack.Create);
  IsNewerThenXP := CheckWin32Version(NEW_THEN_XP, 0);
  AdjustMethod;

end. 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-25T22:35:51.840

除了 Alexander，通常这被称为“堆碎片”。

请注意，FastMM 总体上应该更具弹性和更快，但如果原始应用程序针对 D7 内存管理器进行了调整，FastMM 实际上可能性能更差。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-24T07:39:29.210

好吧，即使您的应用程序中没有内存泄漏，内存使用量也会增加。在这些情况下，您可能会泄漏其他资源。例如，如果您的代码分配了一个位图，尽管它释放了所有对象，但设法忘记了最终确定一些 HBITMAP。

FastMM 会告诉你你的应用程序没有内存泄漏，因为你已经释放了所有的对象和数据。但是您仍然会泄漏其他类型的资源（在我的示例中 - GDI 对象）。泄露其他类型的资源也会影响你的记忆。

我建议您尝试其他工具，它不仅可以检查内存泄漏，还可以检查其他类型的泄漏。我认为 AQTime 有能力做到这一点，但我不确定。

此行为的另一个可能原因是内存碎片。假设您分配了 2000 个大小为 1 Mb 的对象（让我们暂时忘记 MM 开销和用户空间中其他对象的存在）。现在您拥有完整的 2 Gb 繁忙内存。现在，假设您释放了所有偶数对象，所以现在您已经“剥离”了内存空间，其中混合了 1 Mb 繁忙和空闲块。尽管您现在确实有 1 Gb 的空闲内存，但是您无法为任何 2Mb 对象分配内存，因为空闲块的最大大小仅为 1 Mb（但您确实有 1000 个这样的块；））。如果内存管理器为您的对象使用了大于 1 Mb 的块，那么当您释放偶数对象时，它无法将内存块释放回操作系统：

```
[ [busy] [free] [busy] [free] [busy] [free] ]
[ [busy] [free] [busy] [free] [busy] [free] ]... 
```

那些大的 [...] 块是半忙的，所以 MM 不能把它们交给操作系统。如果您要求另一个大于 1 Mb 的块，那么 MM 将需要从 OS 分配另一个块：

```
[ [busy] [free] [busy] [free] [busy] [free] ]
[ [busy] [free] [busy] [free] [busy] [free] ]...
[ [your-new-object] [free.................] ] 
```

请注意，这些只是增加内存使用量的示例，尽管您没有内存泄漏。我并不是说你有确切的情况：D

# jquery - JQuery AJAX可以序列化哪些返回类型？

> ID：780096
> 
> 赞同：0
> 
> 时间：2009-04-23T02:30:44.043
> 
> 标签：jquery, ajax, web-services

我有一个对返回类型 IList<> 的 Web 服务的调用 (POST)。我怀疑这种类型没有正确序列化，因为我收到以下错误：“在序列化类型对象时检测到循环引用......”

我只能使用数组吗？制作另一个只返回数组的方法？我宁愿不复制我的方法只是为了使用 JQuery。

有人见过这个吗？

谢谢，

缺口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T02:34:11.100

你的 IList 可能有它自己的集合。您可以使用 Json 类将 IList<> 序列化为 JSON 等格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T04:01:20.237

您不能返回接口，因为支持所有可能支持该接口的类型所需的合同是无限的。

仅仅因为对象 Car 和对象 Motorcycle 支持 IVehicle，反序列化时客户端不知道要创建什么类型。

出于同样的原因，与返回派生类相同。

# python - 在 Windows 上的 Python 2.6 中安装 bitarray

> ID：780127
> 
> 赞同：0
> 
> 时间：2009-04-23T02:48:41.580
> 
> 标签：python, c, mingw, bitarray

我想在运行 python 2.6 的 Windows 中安装[bitarray](http://pypi.python.org/pypi/bitarray/)。

我已经安装了 mingw32，并且我已经`C:\Python26\Lib\distutils\distutils.cfg`设置为：

```
[build]
compiler = mingw32 
```

如果我输入，在一个`cmd.exe`窗口中：

```
C:\Documents and Settings\john\My Documents\bitarray-0.3.5>python setup.py install 
```

我得到：

```
[normal python messages skipped]
C:\MinGW\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IC:\Python26\include -IC:\Python26\PC -c bitarray/_bitarray.c -o build\temp.win32-2.6\Release\bitarray\_bitarray.o
bitarray/_bitarray.c:2197: error: initializer element is not constant
bitarray/_bitarray.c:2197: error: (near initialization for `BitarrayIter_Type.tp_getattro')
bitarray/_bitarray.c:2206: error: initializer element is not constant
bitarray/_bitarray.c:2206: error: (near initialization for `BitarrayIter_Type.tp_iter')
bitarray/_bitarray.c:2232: error: initializer element is not constant
bitarray/_bitarray.c:2232: error: (near initialization for `Bitarraytype.tp_getattro')
bitarray/_bitarray.c:2253: error: initializer element is not constant
bitarray/_bitarray.c:2253: error: (near initialization for `Bitarraytype.tp_alloc')
bitarray/_bitarray.c:2255: error: initializer element is not constant
bitarray/_bitarray.c:2255: error: (near initialization for `Bitarraytype.tp_free')
error: command 'gcc' failed with exit status 1 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T07:11:03.963

MingW 无法编译 bitarray 源，我尝试使用 3.4.5 版本并得到相同的错误。但是，它可以与 Microsoft 编译器一起正常编译。

为了您的方便，我为 Python 2.6 构建了 msi 和 exe 安装程序：

[http://starship.python.net/crew/theller/bitarray-0.3.5.win32-py2.6.msi](http://starship.python.net/crew/theller/bitarray-0.3.5.win32-py2.6.msi)

[http://starship.python.net/crew/teller/bitarray-0.3.5.win32-py2.6.exe](http://starship.python.net/crew/theller/bitarray-0.3.5.win32-py2.6.exe)

请将位数组作者指向它们，以便他可以将它们上传到 pypi。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-21T10:55:46.137

我需要为自己构建 bitarray（我需要移位），所以我不能使用你预先构建的二进制文件。问题在于 mingw 无法与 __declspec(dllimport) 一起正常工作。Python 已经通过使用自动导入而不是 declspec 为 cygwin 构建解决了这个问题。但是，对于 mingw 构建没有启用此功能。因此，您要么需要修改 pyport.h 中的 PyAPI_FUNC 宏，要么添加

```
#define __CYGWIN__ 
```

到位阵列源。

# sql-server - SQL Server 2005 Express 其他用户看不到存储过程

> ID：780133
> 
> 赞同：2
> 
> 时间：2009-04-23T02:52:00.200
> 
> 标签：sql-server, sql-server-2005

我在我们公司的 SQL Server 2005 数据库中添加了几个存储过程。数据库使用 Windows 身份验证。其他用户看不到这些过程，尽管他们可以使用 SQL Server Management Express 查看数据库/表/存储过程。我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T02:54:27.043

确保您授予 SP 执行权限：

```
GRANT EXECUTE ON [sp name] TO [user/role] 
```

# sql-server - 如何配置ScrewTurn Wiki 以使用SQL Server？

> ID：780151
> 
> 赞同：1
> 
> 时间：2009-04-23T03:02:36.570
> 
> 标签：sql-server, screwturn

我正在尝试在我的服务器上配置出色的ScrewTurn Wiki 产品，但无法理解[文档](http://www.screwturn.eu/Plugins.ashx#SQL_Server_UsersPages_Storage_Provider_BBCBDG_10)。

我想将其配置为使用 SQL Server 进行存储。我还需要为 web.config 中的 PublicDirectory 键指定一个有效值吗？

到目前为止，这就是我尝试配置连接的方式，但显然我还缺少其他东西：

```
<add name="WikiData"
  connectionString="Data Source=xxx;Initial Catalog=xxx;User ID=xxx;Password=xxx"
  providerName="System.Data.SqlClient"/> 
```

添加此连接字符串后，如果不抱怨 PublicDirectory 键，我什至无法加载页面。在我添加连接字符串之前，该站点在没有 SQL Server 实现的情况下运行良好。我什至没有机会查看数据库连接是否有效并且不知道在此处命名它的名称，如果名称对密钥有任何影响。

我怎样才能让它正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T03:23:15.757

想通了，没有看到连接字符串部分。解决。

# c++ - MFC 中是否存在不涉及用户创建目录以指定尚不存在的目录的标准目录浏览器对话框？

> ID：780152
> 
> 赞同：0
> 
> 时间：2009-04-23T03:02:38.677
> 
> 标签：c++, windows, mfc, directory, common-dialog

我正在开发安装程序的引导应用程序，并且我有一个对话框，用户可以打开该对话框以从给定的默认值中选择不同的目标目录。目前，我正在使用`CFolderDialog`为此，但要让用户选择一个尚不存在的文件夹，他必须先创建该文件夹。一旦用户指定了目录，我希望能够删除它，以便在我启动安装程序时，它可以创建文件夹本身，以便将其标记为卸载。此外，如果用户随时取消我的引导应用程序，我不希望用户在文件夹浏览器中闲逛时出现任何不需要的文件夹。我遇到的问题是，如果我尝试删除用户在浏览新目标文件夹时创建的文件夹，我会收到共享冲突错误。（我将目录的创建时间与启动对话时的系统时间进行比较，以确保我可以删除目录。）

我需要的是一种解决共享冲突的方法或另一个标准对话，该对话不涉及用户必须创建一个新目录才能仅仅因为它还不存在而指定它。

**编辑：**当我最初发布这个时，我忘记了我正在使用的文件夹对话框实际上是[代码项目站点上的 XFolder 对话框](http://www.codeproject.com/KB/dialog/XFolderDialog.aspx)。虽然它确实允许用户浏览目录，但它不像我过去在安装程序中看到的文件夹浏览器对话框那样直观。我真正想要的是用户可以浏览到新文件夹所在的文件夹，然后只需将新文件夹附加到对话框编辑框中的路径，而无需创建新文件夹。

**更新**由于 XFolder 对话框是使用模板的标准打开文件对话框的自定义，因此它不适用于 Vista 或更新的操作系统。因此，我必须放弃将其用于其他用途。我仍然在这里寻找解决方案。如果有人可以告诉我如何在使用 SHBrowseForFolder() 时设置初始目录（而不是根目录），我愿意将其用作我的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T03:20:59.850

*出于您的目的，让用户选择一个基本*目录可能是有意义的，例如“C:\选择的路径并让您的安装程序创建）。在用户选择基础后显示组合路径。这样，用户不会觉得他对您正在创建的目录负有责任，但仍然可以对目标进行合理的控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T15:30:18.897

您可以在不指定 BIF `_`BROWSEINCLUDEFILES 或 BIF `_`NONEWFOLDERBUTTON 的情况下使用 SHBrowseForFolder。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T11:57:02.947

我从未见过这样的对话框窗口，无论是在 MFC 中还是在任何其他技术中。我同意 Shog9 的观点，您应该为用户提供一种将基本目录的选择和目录的创建分开的方法。

# c++ - 跨平台内存分配器 sbrk/virtualalloc

> ID：780156
> 
> 赞同：0
> 
> 时间：2009-04-23T03:04:52.197
> 
> 标签：c++, c, memory, cross-platform

我想知道是否存在比 malloc/free 低一级的跨平台分配器。

例如，我想要在 Linux 中简单地调用 sbrk 和在 Windows 中调用 VirtualAlloc 的东西（可能还有两个类似的系统调用，但这只是一个示例）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T03:46:00.163

我不熟悉有问题的功能，但是：

```
#if defined (__WIN32__)
  #define F(X) VirtualAlloc(X)
#elif defined (__LINUX__) /* or whatever linux's define is */
  #define F(X) sbrk(X)
#endif 
```

不确定语法是否为 100%（我是宏和 c 的新手），但总体思路应该可行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T03:45:14.457

除了 C 提供的内容之外，C 还为您提供`malloc`and `free`，C++ 添加了`new`,和and 放置形式。`new[]``delete``delete[]`

再多的话，你就超出了语言本身的范围。您要么在 OS 领域工作，要么在汇编程序中埋头苦干。毫无疑问，这些东西是跨平台的。

> 我想知道如果存在这样的分配器会有什么好处？
> 
> 您可以实现自己的 malloc/free，而不必担心底层操作系统

你会想要另一个跨平台解决方案来实现这个和另一个......你明白了。这不是一个可行的方案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-01-25T08:47:29.240

我最近发现了这篇文章：

[http://www.genesys-e.org/jwalter//mix4win.htm](http://www.genesys-e.org/jwalter//mix4win.htm)

它基本上使用 VirtualAlloc 在 Windows 下实现 sbrk()。

# jquery - 单击带有单击事件的重叠元素

> ID：780157
> 
> 赞同：2
> 
> 时间：2009-04-23T03:05:12.790
> 
> 标签：jquery, jquery-ui

我有这个 DOM：

```
<li>
    <img class="ui-selectee" src="../img/thumbs/80x80_1280_wallpaper.jpg" style=""/>
    <input type="hidden" value="3"/>
    <a class="btnImgDel" title="Eliminar" href="javascript:void(0)">Eliminar</a>
    <a class="btnImgRen" title="Renombrar" href="javascript:void(0)">Renombrar</a>
    <a class="btnImgZoom" title="Ampliar" href="javascript:void(0)">+</a>
</li> 
```

链接不会覆盖所有图像，而只会覆盖一些像素。

您可能会注意到，img 是可选择的（jQuery UI），它有三个同级链接。单击这些链接应运行一个函数：

```
$('.btnImgDel').live('click',function(){
    $('#dialogDeleteImg').dialog('open');
    console.log('click');
}); 
```

但是，当我单击链接时，什么也没有发生。链接具有更大的 z-index 并且可见。

有什么方法可以使这项工作或任何关于可能发生的事情的线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T04:18:30.290

将 console.log 放在 dialog() 之前，它可能会失败。

此外，不需要使用 javascript 的 href。

```
<a href="#"></a>

<script>
    $(".btnImgDel").click(function (event) {
        event.preventDefault();
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T03:12:27.717

您是否将代码放入 $(document).ready() 中？

您也可以尝试：

```
$(document).ready(function() {
  $('.btnImgDel').click(
    function(){
      $('#dialogDeleteImg').dialog('open');
      console.log('click');
    });
}); 
```

或这个

```
<span class="btnImgDel" title="Eliminar">Eliminar</span> 
```

# asp.net-mvc - 带有 JavaScript 的 MVC - 行程路线

> ID：780159
> 
> 赞同：0
> 
> 时间：2009-04-23T03:05:58.373
> 
> 标签：asp.net-mvc, routing

[查看异常](http://exceptioneer.com/Share/Summary.aspx?81c2baa3-56c5-4250-abe2-35b0c94823e2)

我的母版页中有一个 JS 包含，它似乎每次都会绊倒其中一条路线。

正在跳闸这条路线：

```
routes.MapRoute(
"CatalogType",
"Catalog/{group}/{type}/{index}/{browseSize}",
new { controller = "Catalog"
    , action = "Types"
    , group = ""
    , type = ""
    , index = ""
    , browseSize = "" }
); 
```

我能做些什么来阻止这种行为吗？

PS：我知道有一种方法可以在这些参数上强制执行数据类型，但对于我来说，我找不到参考。我在做梦吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T06:37:12.140

查看异常，您似乎没有在服务器端正确解析 javascript 文件的虚拟路径（即 ~/ 位最终被呈现给客户端，而不是被解析为正确的应用程序绝对路径）。在包含 js 文件的地方，您希望像这样包含它：

```
<script type="text/javascript" src="<%= Url.Content("~/scripts/swfobject.js") %>" ></script> 
```

不像这样：

```
<script type="text/javascript" src="~/scripts/swfobject.js" ></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T06:51:44.773

这是[路线约束的概述](http://beta.blogs.microsoft.co.il/blogs/bursteg/archive/2009/01/11/asp-net-mvc-route-constraints.aspx)。

您还可以使用正则表达式，例如：

```
routes.MapRoute("CatalogType", "Catalog/{group}/{type}/{index}/{browseSize}",
    new { controller = "Catalog", action = "Types", group = "", type = "", index = "", browseSize = "" },
    new { group = "\w+", browseSize = "\d+" }
); 
```

我发现[Phil Haack 的路由调试器](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)对于这样的事情也非常有用。

# flash - flash 的新手，actionscript 编译中的错误

> ID：780165
> 
> 赞同：0
> 
> 时间：2009-04-23T03:11:28.173
> 
> 标签：flash, actionscript, command-line, actionscript-2

我正在向我正在处理的站点添加一个小的 .swf 对象（XSPF Web 音乐播放器）。我需要添加两行代码来进行外部javascript调用，所以，我想我需要重新编译为actionscript（请原谅我，我对flash非常陌生）。我正在使用 MTASC 在命令行进行编译。我在文件开头遇到错误，几乎是第一件事没有评论。.as 文件发布在此处[http://pastebin.com/f3c4a4a03](http://pastebin.com/f3c4a4a03)并在停止时产生错误（字符 0-4：解析错误意外停止）。由于我是 Flash 新手，你们在那里看到什么会使其在 stop() 处中断吗？或任何其他指针？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T11:34:16.387

刚刚浏览了该文件，很明显您的代码中有一些语法错误。您使用 MTASC 有什么原因吗？. 实际上，您可以在 Flash 9 中使用名为 FlashDevelop 的漂亮 IDE（仅限 Windows）来编译它。

你确定你复制的文件正确吗？. 停止（）；函数 on 适用于 flash 中名为 MovieClips 的对象，并且该文件不会扩展该对象，这就是您收到该错误消息的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T12:52:20.377

fla 文件是您需要在 flash 环境 (IDE) 中打开和编译才能成功编译该代码的文件。该代码最初是为 Actionscript 2 编写的，但 Actionscript 3.0 的结构与此不同。解决方案，如果您可以获取 Adob​​e Flash IDE 来编译文件。这将解决问题

# python - 如何为我的弹跳球创建碰撞检测？

> ID：780169
> 
> 赞同：7
> 
> 时间：2009-04-23T03:13:56.387
> 
> 标签：python, collision-detection

我为三个沙滩球在屏幕上弹跳编写了一个动画（在 python 中）。我现在希望它们全部碰撞并能够相互反弹。我真的很感激可以提供的任何帮助。

```
import pygame
import random
import sys
class Ball:

    def __init__(self,X,Y):

        self.velocity = [1,1]
        self.ball_image = pygame.image.load ('Beachball.jpg'). convert()
        self.ball_boundary = self.ball_image.get_rect (center=(X,Y))
        self.sound = pygame.mixer.Sound ('Thump.wav')
        self.rect = self.ball_image.get_rect (center=(X,Y))

if __name__ =='__main__':

    width = 800
    height = 600
    background_colour = 0,0,0
    pygame.init()
    window = pygame.display.set_mode((width, height))
    pygame.display.set_caption("Bouncing Ball animation")
    num_balls = 3
    ball_list = []
    for number in range(num_balls):
        ball_list.append( Ball(random.randint(10, (width - 10)),random.randint(10, (height - 10))) )
    while True:
        for event in pygame.event.get():
                print event 
                if event.type == pygame.QUIT:
                        sys.exit(0)
        window.fill (background_colour)

        for ball in ball_list:
                if ball.ball_boundary.left < 0 or ball.ball_boundary.right > width:
                        ball.sound.play()
                        ball.velocity[0] = -1 * ball.velocity[0]
                if ball.ball_boundary.top < 0 or ball.ball_boundary.bottom > height:
                        ball.sound.play()
                        ball.velocity[1] = -1 * ball.velocity[1]

                ball.ball_boundary = ball.ball_boundary.move (ball.velocity)
                window.blit (ball.ball_image, ball.ball_boundary)
        pygame.display.flip() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-23T03:29:34.587

任意形状的碰撞检测通常非常棘手，因为您必须确定是否有任何像素发生碰撞。

这实际上更容易使用圆圈。如果您有两个半径分别为 r1 和 r2 的圆，如果中心之间的距离小于 r1+r2，则会发生碰撞。

两个中心 (x1,y1) 和 (x2,y2) 之间的距离可以计算和比较为：

```
d = sqrt((y2-y1) * (y2-y1) + (x2-x1) * (x2-x1));
if (d < r1 + r2) { ... bang ... } 
```

或者，正如 jfclavette 指出的那样，平方根很昂贵，因此最好只使用简单的操作来计算：

```
dsqrd = (y2-y1) * (y2-y1) + (x2-x1) * (x2-x1);
if (dsqrd < (r1+r2)*(r1+r2)) { ... bang ... } 
```

棘手的一点在于计算新的运动矢量（给定对象的 (x,y) 随时间变化的速率），因为您需要考虑当前的运动矢量和接触点。

我认为作为第一次切割，您应该只反转运动矢量以测试碰撞检测是否首先起作用。

然后问另一个问题 - 最好保持个别问题具体，以便有针对性地回答。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T03:49:51.933

检测碰撞只是第一步。让我们分解一下。

最快的做法是计算它们的方形边界框，看看它们是否发生碰撞。两个边需要交叉（1 的顶部和底部或 2，1 的左侧和 2 的右侧，反之亦然）以使边界框重叠。没有重叠，没有碰撞。

现在，当它们*重叠*时，您需要计算它们之间的距离。如果该距离大于球半径的总和，则不会发生碰撞。

好的！我们有两个球相撞。*现在*呢？好吧，他们必须互相反弹。他们反弹的方式取决于几个因素。

首先是它们的弹性。两个相互弹跳的橡胶球与两个玻璃球的反弹方式不同。

第二个是它们的初始速度。Inertia 表示，他们将希望继续朝着他们开始时的方向前进。

第三是球的质量。质量较小的球会以更高的速度从更大的质量反弹。

让我们先处理第二个和第三个因素，因为它们是相互交织的。

两个球很少会完全命中。扫视的可能性要大得多。在任何情况下，冲击都会沿着球碰撞的切线法线发生。给定它们的初始速度，您需要计算两者沿此法线的矢量分量。这将导致两个球都会带来一对正常速度的碰撞。将总和相加并将其存储在方便的地方。

现在我们必须弄清楚每个球会从中带走什么。每个球的最终法向速度与给定球的质量成反比。也就是说，取每个球质量的倒数，将两个质量加在一起，然后根据球的质量与两个球质量的倒数之和的比值，将合成的法向速度从碰撞中分离出来。然后将切向速度添加到此，得到球的合成速度。

弹性几乎是相同的，除了它需要一些基本的微积分，因为即使球在压缩时仍然在移动。我会留给你找到相关的数学。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T03:44:19.293

[Pax 的回答](https://stackoverflow.com/questions/780169/how-do-i-create-collision-detections-for-my-bouncing-balls/780201#780201)很好地涵盖了检测碰撞。关于让物体相互反弹，我建议查看以下有关[弹性碰撞](http://en.wikipedia.org/wiki/Elastic_collision)、[非弹性碰撞](http://en.wikipedia.org/wiki/Inelastic_collision)和[恢复系数的](http://en.wikipedia.org/wiki/Coefficient_of_restitution)链接。

**编辑：**我刚刚注意到这在[另一个 SO question](https://stackoverflow.com/questions/345838/ball-to-ball-collision-detection-and-handling)中有所涉及，尽管不是专门针对 Python 的。您还应该在那里查看一些好的链接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T04:30:17.797

我认为考虑到他正在使用 pygame，你们特别想念一些更简单的东西。

调用该`get_rect`函数可以为图像设置大概的边界，`Rect`创建的边界用于计算图像的位置，如果动画中有多个对象，则可以用于检测碰撞。

`colliderect`&`rect`可以使用，问题是我不知道你将如何实现它，特别是对于未知数量的球。

请记住它是python。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-17T00:31:55.250

首先你需要检查碰撞`rect.colliderect(other_rect)`

之后，如果它们发生碰撞，您可以检查像素完美碰撞。所以你不会弄乱对象的半径或形状。

对于像素完美碰撞检查，我使用遮罩：使用 制作两个遮罩对象`mask.from_surface`，然后让它们发挥`Mask.overlap`作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T17:08:29.990

回到过去，当 CPU 周期非常重要时，编码人员使用一个简单的技巧来检测碰撞：他们使用的颜色可以从像素颜色中分辨出它是背景还是物体。至少在一些 C64 游戏中是这样做的。

不知道你是否愿意走这条路，虽然..

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-21T02:02:06.707

我做了一个python碰撞检测if语句，这里是：

```
if beach ball 1 x < beach ball 2 x + beach ball 1 width and beach ball 1 x + beach ball 2 width > beach ball 2 x and beach ball 1 y < beach ball 2 y + beach ball 1 height and beach ball 2 height + beach ball 1 y > beach ball 2 y:
    #put needed code here 
```

在您的情况下，使用 3 个弹跳球，您必须为每个球制作 2 个这种格式的 if 语句，以确保碰撞检测完美无缺。我希望这有帮助。

# php - 从其他计算机连接数据库

> ID：780177
> 
> 赞同：2
> 
> 时间：2009-04-23T03:19:54.330
> 
> 标签：php, mysql, remote-connection

我正在使用 PHP 和 MySQL 数据库。电脑之间有一个网络。我的问题是我想连接到另一台计算机上的 MySQL 数据库。我想从另一台计算机将数据存储在那个 MySQL 数据库上。我怎么可能做到这一点？非常感谢您的任何建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T03:42:17.957

MySQL 服务器必须配置为接受外部连接，并且其防火墙必须配置为允许该端口（TCP 端口 3306）上的传入连接。这可能已设置，也可能尚未设置。

您还必须在 MySQL 权限中考虑这一点，如下所示。

通常，在设置 MySQL 权限时，您只会为 @'localhost' 设置用户访问权限。您需要确保用户帐户及其授予的权限都设置为您将从中连接的适当主机名或 IP*地址*。例如，您可以创建一个新的授权用户：

```
GRANT ALL PRIVILEGES ON somedatabase.* TO someuser@'somehostname' IDENTIFIED BY 'password';
FLUSH PRIVILEGES; 
```

您必须先完成所有这些，然后才能使用 PHP 远程连接到该服务器，使用如下所示：

```
mysql_connect('mysqlservername', 'someuser', 'password'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T03:24:27.657

指向 mysql_connect() 以使用其他计算机的名称/IP地址：

```
$server = '192.168.0.3';
$user = "foo";
$password = "bar";
$conn = mysql_connect($server, $user, $password); 
```

您需要确保另一台 PC 中的数据库有足够的权限从不同的主机（即您的计算机）连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T03:24:05.070

在该计算机上正常设置 MySQL。然后，简单地说：

```
<?php mysql_connect('IP of 2nd computer', 'username', 'password'); ?> 
```

# scripting - 何时使用环境变量或命令行参数？

> ID：780188
> 
> 赞同：1
> 
> 时间：2009-04-23T03:24:21.247
> 
> 标签：scripting, parameters

何时使用环境变量或命令行参数？

我认为有两种方法可以将参数传递给脚本中的另一个进程，环境变量和命令行参数。

因此，在哪种情况下我们选择一个而不是另一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T03:57:04.210

在我编写的大多数脚本中，我都允许使用命令行参数。

这是为了让“懒惰”的用户想要设置“n”忘记参数来这样做。

它还允许在特殊情况下通过命令行覆盖这些参数。

对于那些不想冒险他们的参数可能设置不正确的人，他们可以使用参数。

有时我什至会在层次结构中有更多级别，按优先顺序排列：

*   程序运行时设置的值。
*   命令行参数。
*   环境变量。
*   本地配置文件。
*   全局配置文件。
*   默认。

这样，对于每个变量，您只需按照该列表的顺序*进行*操作，将其设置为相关值（如果存在）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T03:27:17.103

我建议你更喜欢命令行参数而不是环境变量，除非

*   您需要跨命令持续存在的值。
*   您需要系统范围的全局值

福特克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T03:28:07.743

尽可能选择参数。

但是假设您有调用 Script2 的 Script1。这两个脚本都分发给许多用户。Script2 可能需要不同的参数，具体取决于用户，用户不希望或由于某种原因无法更改 Script1。这是环境变量可能有用的情况。

# asp.net-mvc - 无法在 Visual Studio 中添加实体数据模型

> ID：780190
> 
> 赞同：2
> 
> 时间：2009-04-23T03:24:30.480
> 
> 标签：asp.net-mvc, entity-framework, ado.net

我在 WinXP 上运行带有 .NET Framework 3.5 SP1 的 Visual Studio 08 Team Edition。我正在尝试将实体数据模型添加到我的项目中，但是没有出现添加“ADO.NET 实体数据模型”选项的选项。为了给您一个视觉效果，我基本上是按照[此处](http://www.aspfree.com/c/a/ASP.NET/Introduction-to-the-ADONET-Entity-Framework-using-ASPNET/)的说明进行操作，但无法通过第 5 步（右键单击项目并单击添加新项目），因为没有出现添加 EDM 的选项。

有任何想法吗？我确信我具备所有的先决条件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T03:37:08.533

我猜你的 VS 2008 SP1 安装没有成功完成。这里有一些事情需要验证：

1.  查看[http://download.microsoft.com/download/A/2/8/A2807F78-C861-4B66-9B31-9205C3F22252/VS2008SP1Readme.htm](http://download.microsoft.com/download/A/2/8/A2807F78-C861-4B66-9B31-9205C3F22252/VS2008SP1Readme.htm)并验证是否有任何已知问题适用于您的方案

2.  打开 Visual Studio 2008 SP1 命令提示符并键入：devenv.exe /setup [ENTER]

3.  从“添加/删除程序”修复 VS 2008 SP1 或尝试卸载并重新安装 VS 2008 SP1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T17:50:25.893

您能否验证您是否拥有： [Microsoft® Visual Studio Team System 2008 Database Edition GDR R2](http://www.microsoft.com/downloads/details.aspx?FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed&displaylang=en) 需要注意的重要一点是**GDR**。基本上，它就像一个服务包。他们添加了一些功能，例如实体框架。

非R2也可以。您上面链接的文章根本没有列出这个，但它是实体框架所必需的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-12T13:57:22.873

这是有关该问题的[博客文章。](http://www.wiibart.com/visual-studio-2008-missing-adonet-and-other-p)

从本质上讲，安装 VS2008 SP1（即使安装中的 about 框可以声称它已经是 SP1）为我解决了这个问题。

[在此处](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=27673c47-b3b5-4c67-bd99-84e525b5ce61&displaylang=en)下载 SP1 的页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-14T23:10:11.947

我遇到了与这里描述的 VS2012 相同的问题。我现在已经安装了 VS2012 更新 2，这已经解决了这个问题，所以如果有人在 VS2012 中偶然发现了这个问题，请尝试解决这个问题。

# c++ - C++ 初始化静态堆栈

> ID：780191
> 
> 赞同：4
> 
> 时间：2009-04-23T03:25:30.837
> 
> 标签：c++, collections, static, initialization

我对初始化静态集合有一些疑问。这是我编写的一个似乎可行的示例：

```
#include <stack>
#include <iostream>

using namespace std;

class A
{
    private:
        static stack<int> numbers;

        static stack<int> initializeNumbers();

    public:
        A();
};

A::A() { cout << numbers.top() << endl; }

stack<int> A::initializeNumbers()
{
    stack<int> numbers;

    numbers.push(42);

    return numbers;
}

stack<int> A::numbers = initializeNumbers();

int main()
{
    A a;
} 
```

现在，这是完成我想要完成的事情的最佳方式吗？出于某种原因，当我在我的真实代码中尝试这个完全相同的方案时，调用*top()*会打印出乱码。这有什么原因吗？

如果我的例子很好，也许我会求助于发布我的真实代码。

* * *

这是真正的代码：

*光.h*

```
#ifndef LIGHT_H_
#define LIGHT_H_

#include <stack>

#include "Vector4.h"

class Light
{
    private:
        static stack<GLenum> availableLights;

        static stack<GLenum> initializeAvailableLights();

    public:
        GLenum lightID;
        Vector4 ambient, diffuse, specular, position, spotDirection;
        GLfloat constantAttenuation, linearAttenuation, quadraticAttenuation, spotExponent, spotCutoff;

        Light(  const Vector4& ambient = Vector4(0.0, 0.0, 0.0, 1.0),
                const Vector4& diffuse = Vector4(1.0, 1.0, 1.0, 1.0),
                const Vector4& specular = Vector4(1.0, 1.0, 1.0, 1.0),
                const Vector4& position = Vector4(0.0, 0.0, 1.0, 0.0),
                const Vector4& spotDirection = Vector4(0.0, 0.0, -1.0, 0.0),
                GLfloat constantAttenuation = 1.0,
                GLfloat linearAttenuation = 0.0,
                GLfloat quadraticAttenuation = 0.0,
                GLfloat spotExponent = 0.0,
                GLfloat spotCutoff = 180.0);

        ~Light();
};

#endif /*LIGHT_H_*/ 
```

*光.cpp*

```
#include <stdexcept>    // runtime_error
#include <iostream>

using namespace std;

#include "Light.h"

Light::Light(   const Vector4& ambient,
                const Vector4& diffuse,
                const Vector4& specular,
                const Vector4& position,
                const Vector4& spotDirection,
                GLfloat constantAttenuation,
                GLfloat linearAttenuation,
                GLfloat quadraticAttenuation,
                GLfloat spotExponent,
                GLfloat spotCutoff) :

                ambient(ambient),
                diffuse(diffuse),
                specular(specular),
                position(position),
                spotDirection(spotDirection),
                constantAttenuation(constantAttenuation),
                linearAttenuation(linearAttenuation),
                quadraticAttenuation(quadraticAttenuation),
                spotExponent(spotExponent),
                spotCutoff(spotCutoff)
{
    // This prints gibberish.
    cout << availableLights.size() << endl;

    // The error is indeed thrown.
    if(availableLights.empty())
        throw runtime_error("The are no more available light identifiers.");
    else
    {
        lightID = availableLights.top();

        availableLights.pop();
    }
}

Light::~Light() { availableLights.push(this -> lightID); }

stack<GLenum> Light::initializeAvailableLights()
{
    stack<GLenum> availableLights;

    availableLights.push(GL_LIGHT7);
    availableLights.push(GL_LIGHT6);
    availableLights.push(GL_LIGHT5);
    availableLights.push(GL_LIGHT4);
    availableLights.push(GL_LIGHT3);
    availableLights.push(GL_LIGHT2);
    availableLights.push(GL_LIGHT1);
    availableLights.push(GL_LIGHT0);

    return availableLights;
}

stack<GLenum> Light::availableLights = initializeAvailableLights(); 
```

* * *

而且由于我无法让堆栈的代码工作，我现在选择了这个：

*光.h*

```
#ifndef LIGHT_H_
#define LIGHT_H_

#include <stack>

#include "Vector4.h"

class Light
{
    private:
        static const unsigned int LIGHTS = 9;
        static bool availableLights[];
        static GLenum lights[];

        static GLenum getAvailableLight();

    public:
        GLenum lightID;
        Vector4 ambient, diffuse, specular, position, spotDirection;
        GLfloat constantAttenuation, linearAttenuation, quadraticAttenuation, spotExponent, spotCutoff;

        Light(  const Vector4& ambient = Vector4(0.0, 0.0, 0.0, 1.0),
                const Vector4& diffuse = Vector4(1.0, 1.0, 1.0, 1.0),
                const Vector4& specular = Vector4(1.0, 1.0, 1.0, 1.0),
                const Vector4& position = Vector4(0.0, 0.0, 1.0, 0.0),
                const Vector4& spotDirection = Vector4(0.0, 0.0, -1.0, 0.0),
                GLfloat constantAttenuation = 1.0,
                GLfloat linearAttenuation = 0.0,
                GLfloat quadraticAttenuation = 0.0,
                GLfloat spotExponent = 0.0,
                GLfloat spotCutoff = 180.0);

        ~Light();
};

#endif /*LIGHT_H_*/ 
```

*光.cpp*

```
#include <stdexcept>    // runtime_error

#include "Light.h"

Light::Light(   const Vector4& ambient,
                const Vector4& diffuse,
                const Vector4& specular,
                const Vector4& position,
                const Vector4& spotDirection,
                GLfloat constantAttenuation,
                GLfloat linearAttenuation,
                GLfloat quadraticAttenuation,
                GLfloat spotExponent,
                GLfloat spotCutoff) :

                ambient(ambient),
                diffuse(diffuse),
                specular(specular),
                position(position),
                spotDirection(spotDirection),
                constantAttenuation(constantAttenuation),
                linearAttenuation(linearAttenuation),
                quadraticAttenuation(quadraticAttenuation),
                spotExponent(spotExponent),
                spotCutoff(spotCutoff)
{
    lightID = getAvailableLight();
}

Light::~Light()
{
    for(unsigned int i = 0; i < LIGHTS; i++)
        if(lights[i] == lightID)
            availableLights[i] = true;
}

bool Light::availableLights[] = {true, true, true, true, true, true, true, true};
GLenum Light::lights[] = {GL_LIGHT0, GL_LIGHT1, GL_LIGHT2, GL_LIGHT3, GL_LIGHT4, GL_LIGHT5, GL_LIGHT6, GL_LIGHT7};

GLenum Light::getAvailableLight()
{
    for(unsigned int i = 0; i < LIGHTS; i++)
        if(availableLights[i])
        {
            availableLights[i] = false;

            return lights[i];
        }

    throw runtime_error("The are no more available light identifiers.");
} 
```

* * *

任何人都可以发现堆栈代码中的错误，或者改进我仓促编码的解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T03:32:59.180

我认为代码甚至不会编译（一开始就缺失`A::`）`initializeNumbers()`。

我建议你发布你的真实代码。

但是，为什么不只是在第一次构造函数调用时初始化堆栈（当然，如果您在多线程环境中运行，则使用线程保护）。

这似乎是一种更清洁的方式，例如（未经测试）：

```
#include <stack>
#include <iostream>
using namespace std;
class A {
    private:
        static boolean isInited = false;
        static stack<int> numbers;
    public:
        A();
};

A::A() {
    if (!isInited) {
        numbers.push(42);
        isInited = true;
    }
    cout << numbers.top() << endl; }

int main() {
    A a;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-10T14:09:39.700

这是一种方法：

```
#include <stack>

class C {
    static std::stack< C* > c_stack;
    static std::stack< C* > getCStack();
};

std::stack< C* > C::c_stack = C::getCStack();

std::stack< C* > C::getCStack() {
    std::stack< C* >* c_stack = new std::stack< C* >();
    c_stack->push( new C());
    return *c_stack;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T03:35:07.833

这肯定是有原因的。一般来说，这种方法确实存在两个问题。第一个问题是静态初始化程序在 C++ 中的 main 方法启动之前运行。这意味着 initializeNumbers 将在程序中的任何其他内容之前运行。在这个有限的样本中，这不是什么大问题。

第二个问题是 C++ 不提供任何排序​​保证。这意味着如果您有多个静态初始化的变量，编译器可以按照它喜欢的任何顺序自由地初始化它们。因此，如果您在另一个初始化程序中依赖于一个静态变量，您将遇到错误（并且创建一个微妙的依赖关系非常容易）。

在这里对复杂的静态值进行某种形式的延迟初始化可能会好得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T04:32:46.307

想知道这些方面的东西是否会对您有所帮助。我仍然更喜欢 Pax 的建议，它更简单，但这应该可以避免你的“是 init”担忧。

```
class NumStack : public stack<int>
{
public:
   NumStack(){
      push(42);
   }
};

class A
{
    private:
        static NumStack numbers;

    public:
        A();
};

//in cpp file, do as usual for static members
NumStack A::Numbers; 
```

如果继承让你感到疑惑（它应该如此，但它并不漂亮），只需将堆栈聚合到 NumStack 中。不过，这将需要对代码中数字的使用进行一些更改：

```
class NumStack
{
public:
   NumStack(){
      obj.push(42);
   }
   stack<int> obj;
}; 
```

# .net - 请为 .NET 程序员推荐一些很棒的网站

> ID：780198
> 
> 赞同：5
> 
> 时间：2009-04-23T03:29:11.017
> 
> 标签：.net

我是 .NET 编程领域的新手，我想了解有关于 .NET 和 Microsoft 技术的文章、提示和其他有用信息的网站。我目前访问的网站是：

*   MSDN
*   堆栈溢出
*   Windows客户端.NET
*   服务器端.NET

我很想了解一些新的 .NET 网站！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-23T04:20:06.400

*   [PDC 网站](http://www.microsoftpdc.com/)有很多很棒的视频（每年都在变化）。
*   [CodePlex](http://www.codeplex.com/)是 MS 的开源项目主机。
*   您有 MSDN，但[Patterns & Practices](http://msdn.microsoft.com/en-us/practices/default.aspx)是一个很好的查看方式。
*   [事件@MS](http://www.microsoft.com/events/webcasts/ondemand.mspx)用于点播网络广播。
*   MSDN[虚拟实验室](http://msdn.microsoft.com/en-us/aa570323.aspx)很棒。
*   [TechNet](http://technet.microsoft.com/en-us/default.aspx)是所有 MS 的绝佳资源。
*   [Pluralsight](http://www.pluralsight.com/main/)有很多很棒的博客。包括[大师的博客](http://www.pluralsight.com/community/blogs/dbox/)。
*   [第 9 频道](http://channel9.msdn.com/)有很棒的视频、采访等。
*   [Chris Sells 网站](http://www.sellsbrothers.com/)很酷。
*   [来自 Mix09](http://live.visitmix.com/)的大量精彩课程。
*   [WindowsClient.net](http://windowsclient.net/)
*   [IIS.net](http://www.iis.net/)
*   [企业模式](http://martinfowler.com/articles/enterprisePatterns.html)（福勒）
*   [数据和对象工厂](http://www.dofactory.com/Default.aspx)
*   [建筑杂志](http://msdn.microsoft.com/en-us/architecture/bb410935.aspx)
*   [谷歌的微软搜索页面](http://www.google.com/microsoft.html)
*   [算法字典](http://www.itl.nist.gov/div897/sqg/dads/)（不是 .net 特定的，但仍然很棒）

我才发现： [“我该怎么做？” 视频](http://msdn.microsoft.com/en-us/bb629407.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T03:34:01.160

关于 C#/.Net 的好博客：

*   乔恩斯基特： http: [//msmvps.com/blogs/jon_skeet/default.aspx](http://msmvps.com/blogs/jon_skeet/default.aspx)
*   埃里克·利珀特：http: [//blogs.msdn.com/ericlippert/default.aspx](http://blogs.msdn.com/ericlippert/default.aspx)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-23T03:57:27.063

已经列出了很多好的资源。

如果您正在寻找文章，[The Code Project](http://www.codeproject.com/)是一个经常光顾的好网站。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-23T03:47:05.810

[银光网](http://www.silverlight.net)

[编码恐怖](http://www.codinghorror.com)

[斯科特·汉塞尔曼的博客](http://www.hanselman.com)

[电视](http://www.dnrtv.com)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T03:35:05.137

我建议您尽可能多地尝试阅读[ScottGu 的博客](http://weblogs.asp.net/scottgu/)，以使自己在 .Net 世界中保持最新状态

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-23T05:49:40.880

好的播客：
[dotnetrocks.com](http://dotnetrocks.com/)
[dnrtv.com](http://dnrtv.com/)
[www.hanselminutes.com](http://www.hanselminutes.com/)

还有一些博客：
[weblogs.asp.net/scottgu](http://weblogs.asp.net/scottgu)
[www.lhotka.net/weblog](http://www.lhotka.net/weblog)
[haacked.com](http://haacked.com)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T03:49:59.983

以下是一些可以帮助您入门的内容：

*   [C Sharp 课程](http://www.csharpcourse.com/)
*   [C Sharp Essentials](http://www.techotopia.com/index.php/C_Sharp_Essentials)
*   [C Sharp 教科书](http://www.programmersheaven.com/2/csharpbook)

以下不是基于 Web 的资源，但您可能需要考虑以下内容：

*   如果您负担得起，请在 Amazon 上查找有关 .NET 的书籍，查看评论明星以确定哪些是好的。
*   查看[C# 设计模式 - James W Cooper](https://rads.stackoverflow.com/amzn/click/com/0201844532)了解 C# 中的 GOF 模式

不要害怕访问[CodePlex](http://www.codeplex.com/)并搜索您可能感兴趣的应用程序并下载源代码。

在调试模式下运行应用程序以了解它是如何工作的。您还可以在[Google 上搜索](http://www.google.com.au/search?q=open+%2B+source+%2B+c%23)开源 C# 项目，以进一步增加您的学习。

祝你学习顺利

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-23T03:52:11.273

如果您对性能感兴趣，请参阅毛尼的博客了解 GC 的工作原理

[http://blogs.msdn.com/maoni/](http://blogs.msdn.com/maoni/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-23T04:46:03.903

[DotNetKicks](http://www.dotnetkicks.com/)是各种 .NET 相关博客文章和其他新闻的一个很好的集合。它不是专门为新用户设计的，但在许多主题上肯定有很多有用的内容。它也相当及时，因此我发现它是掌握 .NET 世界最新技术和讨论的好资源。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-23T05:53:46.690

有一个免费的 C# 文档，仅用于基础知识：

[伽利略 Openbook - Visual C# 2008](http://openbook.galileocomputing.de/visual_csharp/)

对我来说，主要是从[google.com](http://www.google.com)开始:-)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-10T05:00:03.923

只有高级（或古怪）的 ASP.Net、C# 和 SQL Server 东西 [http://blog.DigitalTools.com](http://blog.DigitalTools.com)

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2009-04-23T03:49:07.537

我会说坏的比好的多。

:(

就个人而言，我通常坚持使用 MSDN 并阅读产品团队的官方博客/帖子。

# security - 动态语言的安全编程

> ID：780214
> 
> 赞同：2
> 
> 时间：2009-04-23T03:38:31.883
> 
> 标签：security

C、C++ 及其同类语言中的内存管理错误是众所周知的。我主要使用动态的弱类型语言进行编程。在这类语言中是否存在特别重要的问题？我可以留意哪些语言特定的问题？

我通常会注意标准的安全问题，并尝试考虑代码可能被滥用的方式，但我确信我可能会犯很多不那么肤浅的错误，并且有兴趣扩展我在这方面的知识。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T05:18:02.580

仅仅因为您没有编写较低级别的代码并不意味着您使用的语言以及您的应用程序不会有这些类型的安全问题。因此，我对您的问题的回答是确保您随时了解您正在使用的任何工具的最新版本。如果您托管应用程序运行的环境，这对您来说更成问题，否则如果您的应用程序用户必须在他们的机器上运行它，这对您来说更成问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T04:39:45.603

如果您使用类似于 eval() 的任何东西，则存在攻击风险，尤其是如果您信任来自应用程序外部的某些东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-24T23:57:47.260

在 JavaScript 的情况下，根据**EC-Council Secure Programmer Vol.1**的主要漏洞如下：

> [跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)(XSS)。在 XSS 攻击中，攻击者通过在易受攻击的动态页面中插入恶意 Javascript、VBScript、ActiveX、HTML 或 Flash 来提交客户端可执行脚本，并在用户机器上执行脚本以收集用户信息。

**避免 XSS**：

约束输入：

*   定义一个代码页来决定哪些字符有问题，
*   限制变量选择明确允许的字符。
*   根据解释器（HTML、浏览器和文件系统）过滤元字符

应用规范化： - 规范化技术在验证输入之前将输入带到适当的位置。

验证输入：

*   验证字段长度、数据类型、范围和白名单的所有外部输入，以确保仅接受已知的无问题字符。

编码输出

*   转换元字符，例如：<、> 和“”，使用 HTML 实体代替。
*   对用户提供的输出进行编码，以防止任何插入的脚本以可执行形式传输给用户。

> [JavaScript 劫持](https://www.info-point-security.com/open_downloads/alt/JavaScript_Hijacking.pdf)：允许未经授权的一方读取机密信息。发生是因为大多数实现安全模型的 Web 浏览器并不预期使用 Javascript 进行通信。JavaScrpt Hijacking 一般是通过跨站请求伪造来进行的。Coss-site request forgery 是一种攻击，使受害者能够将一个或多个 HTTP 请求汇总到易受攻击的网站。这种攻击损害了数据的完整性和机密性，这意味着攻击者可以读取受害者的信息并修改存储在易受攻击站点上的信息。

可以防御Javascript**劫持攻击：**

*   通过拒绝恶意请求。
*   通过阻止 JavaScript 响应的直接执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T03:42:14.417

[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)是一种不依赖于类型管理的常见攻击。通常，缺少输入验证是安全问题的一个非常常见的原因。

# xml - [NSXMLNode stringValue] 的最大长度

> ID：780220
> 
> 赞同：0
> 
> 时间：2009-04-23T03:42:01.233
> 
> 标签：xml, cocoa, nsstring, nsxml

我有一个 XML 文档，其中包含一个长度超过 90,000 个字符的元素^*。

```
NSXMLNode* node = ...;
NSString* val = [node stringValue]; // this is not the full contents of the node! 
```

第二行只给了我80k左右。这显然不是我想要的，所以我很感激一些建议。NSXMLNode 坏了吗？我猜我做错了什么。

提前致谢！

^*我知道一个元素中的 90kbytes 不是很好，这是我无法控制的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T03:48:18.567

`[node objectValue]`给你什么？

# java - 一个接口的多个实现者。OSGi 怎么样？

> ID：780224
> 
> 赞同：3
> 
> 时间：2009-04-23T03:43:03.870
> 
> 标签：java, osgi

我对使用 OSGI 作为管理项目插件的一种方式很感兴趣。也就是说，我的接口可以有很多实现者，每个实现者都出现在自己/单独的 OSGI 包中，并带有导出的实现类......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T04:39:06.277

[声明式服务](https://stackoverflow.com/questions/213349/inter-plugin-communication-in-eclipse/213523#213523)应该是要走的路。

您可以将您的接口声明为[服务](https://stackoverflow.com/questions/323202/designing-extensible-software-plugin-architecture/323205#323205)

```
<service>
    <provide interface="my.Interface"/>
    <property name="foo" value="bar"
</service> 
```

该接口的每个实现都可以定义 Bundle 激活和取消激活方法。
但真正简洁的是它们的本质：如果您使用最新的 SCR（“服务组件运行时”，它是一个“扩展包”，实现了新的和改进的 OSGi R4.2 DS - 声明式服务 - 规范），您的课程将不要从 OSGI 模型中导入任何东西。它们仍然是纯 POJO。

然后定义另一个取决于您的第一个服务的服务：

```
<reference name="myInterfaceServiceName"
    interface="my.Interface"
    bind="myActivationMethod" unbind="myDeactivationMethod"
    cardinality="0..n"/> 
```

该服务将检测并列出您的第一个服务的所有具体实例，并按照您的意图处理它们。

有关更多详细信息，请参阅[Eclipse Extensions and Declarative Services](https://stackoverflow.com/questions/688783/eclipse-extensions-and-declarative-services/689632#689632)问题。

演示文稿： 来自 EclipseCON2009[的 OSGi 中使用声明式服务、Spring 动态模块和 Apache iPOJO 的面向组件开发](http://www.slideshare.net/njbartlett/component-oriented-development-in-osgi-with-declarative-services-spring-dynamic-modules-and-apache-ipojo)，将为您提供一个具体示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T13:14:07.770

这可以通过详细的声明方式（如 VonC）或在运行时通过标准服务注册表动态完成。

任何实现者都可以简单地将他们的实现注册为服务，消费者可以从注册表中获取它们，这是非常基本的 OSGi 东西。服务也可以注册属性，因此消费者在查找服务时可以使用这些属性来区分实现。

# c# - 单击日历控件安排一些事情

> ID：780231
> 
> 赞同：0
> 
> 时间：2009-04-23T03:46:21.693
> 
> 标签：c#

我正在使用表单设计器设计一个 GUI，我需要安排一些事情。我在表格上有日历。我想知道他们是否是一种在某个日期单击并设置一个变量的方法，以便在该日期执行某个函数。

**编辑** 实际上，我可能想做一周中的一天和时间。这会以同样的方式工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T04:07:24.497

选择日期时会发生事件。您可以使用该事件来安排一些事情。

这假设您知道如何使用事件，并且您知道如何安排某些事情。如果您不这样做，那么您应该提出单独的问题，尽管您可能应该搜索该站点以查看该问题是否已被提出和回答。

# sql - 限制非唯一值的返回

> ID：780236
> 
> 赞同：1
> 
> 时间：2009-04-23T03:47:49.753
> 
> 标签：sql, mysql, database

我有两张桌子。帖子和回复。将帖子视为博客条目，而回复是评论。

我想显示 X 个帖子，然后显示每个帖子的最新三个评论。

我的回复有一个外键“post_id”，它与每个帖子的“id”相匹配。

我正在尝试创建一个主页，其中包含以下内容

发帖——回复——回复——回复

发表回复

等等等等第四个。我可以通过在模板中使用 for 循环并丢弃不需要的回复来完成此操作，但我讨厌从我不会使用的数据库中获取数据。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T05:22:23.240

这实际上是一个非常有趣的问题。

**哈哈忽略这个，我很烂**

编辑时：此答案有效，但在 MySQL 上，当父行数少至 100 时，它会变得非常缓慢。**但是，请参阅下面的高性能修复。**

显然，您可以在每个帖子中运行一次此查询：`select * from comments where id = $id limit 3`这会产生大量开销，因为您最终会为每个帖子执行一个数据库查询，即可怕的*N+1 查询*。

如果您想一次获取所有帖子（或某些带有 where 的子集），则以下内容将*令人惊讶地*起作用。它假设评论有一个单调递增的 id（因为不能保证日期时间是唯一的），但允许评论 id 在帖子之间交错。

由于 auto_increment id 列是单调递增的，如果 comment 有一个 id，那么你就准备好了。

首先，创建此视图。在视图中，我调用 post`parent`和 comment `child`：

```
create view parent_top_3_children as
select a.*, 
(select max(id) from child where parent_id = a.id) as maxid, 
(select max(id) from child where id <  maxid 
  and parent_id = a.id) as maxidm1, 
(select max(id) from child where id < maxidm1 
  and parent_id = a.id) as maxidm2 
from parent a; 
```

`maxidm1`只是“最大 id 减 1”；`maxidm2`, "max id minus 2" - 即*特定父 id 中的第二和第三大子 id*。

然后将视图加入评论中您需要的任何内容（我称之为`text`）：

```
select a.*, 
b.text as latest_comment,
c.text as second_latest_comment,
d.text as third_latest_comment
from parent_top_3_children a
left outer join child b on (b.id = a.maxid)
left outer join child c on (c.id = a.maxidm1)
left outer join child d on (c.id = a.maxidm2); 
```

自然，您可以添加任何您想要的 where 子句，以限制帖子：`where a.category = 'foo'`或其他任何内容。

* * *

这是我的表的样子：

```
mysql> select * from parent;
+----+------+------+------+
| id | a    | b    | c    |
+----+------+------+------+
|  1 |    1 |    1 | NULL |
|  2 |    2 |    2 | NULL |
|  3 |    3 |    3 | NULL |
+----+------+------+------+
3 rows in set (0.00 sec) 
```

还有一部分孩子。父母 1 没有孩子：

```
mysql> select * from child;
+----+-----------+------+------+------+------+
| id | parent_id | a    | b    | c    | d    |
+----+-----------+------+------+------+------+

. . . .
| 18 |         3 | NULL | NULL | NULL | NULL |
| 19 |         2 | NULL | NULL | NULL | NULL |
| 20 |         2 | NULL | NULL | NULL | NULL |
| 21 |         3 | NULL | NULL | NULL | NULL |
| 22 |         2 | NULL | NULL | NULL | NULL |
| 23 |         2 | NULL | NULL | NULL | NULL |
| 24 |         3 | NULL | NULL | NULL | NULL |
| 25 |         2 | NULL | NULL | NULL | NULL |
+----+-----------+------+------+------+------+
24 rows in set (0.00 sec) 
```

这个视图给了我们这个：

```
mysql> select * from parent_top_3;
+----+------+------+------+-------+---------+---------+
| id | a    | b    | c    | maxid | maxidm1 | maxidm2 |
+----+------+------+------+-------+---------+---------+
|  1 |    1 |    1 | NULL |  NULL |    NULL |    NULL |
|  2 |    2 |    2 | NULL |    25 |      23 |      22 |
|  3 |    3 |    3 | NULL |    24 |      21 |      18 |
+----+------+------+------+-------+---------+---------+
3 rows in set (0.21 sec) 
```

视图的解释计划只是有点毛茸茸：

```
mysql> explain select * from parent_top_3;
+----+--------------------+------------+------+---------------+------+---------+------+------+-------------+
| id | select_type        | table      | type | possible_keys | key  | key_len | ref  | rows | Extra       |
+----+--------------------+------------+------+---------------+------+---------+------+------+-------------+
|  1 | PRIMARY            | <derived2> | ALL  | NULL          | NULL | NULL    | NULL |    3 |             |
|  2 | DERIVED            | a          | ALL  | NULL          | NULL | NULL    | NULL |    3 |             |
|  5 | DEPENDENT SUBQUERY | child      | ALL  | PRIMARY       | NULL | NULL    | NULL |   24 | Using where |
|  4 | DEPENDENT SUBQUERY | child      | ALL  | PRIMARY       | NULL | NULL    | NULL |   24 | Using where |
|  3 | DEPENDENT SUBQUERY | child      | ALL  | NULL          | NULL | NULL    | NULL |   24 | Using where |
+----+--------------------+------------+------+---------------+------+---------+------+------+-------------+ 
```

但是，如果我们为 parent_fks 添加索引，它会变得更好：

```
mysql> create index pid on child(parent_id);

mysql> explain select * from parent_top_3;
+----+--------------------+------------+------+---------------+------+---------+-----------+------+-------------+
| id | select_type        | table      | type | possible_keys | key  | key_len | ref       | rows | Extra       |
+----+--------------------+------------+------+---------------+------+---------+-----------+------+-------------+
|  1 | PRIMARY            | <derived2> | ALL  | NULL          | NULL | NULL    | NULL      |    3 |             |
|  2 | DERIVED            | a          | ALL  | NULL          | NULL | NULL    | NULL      |    3 |             |
|  5 | DEPENDENT SUBQUERY | child      | ref  | PRIMARY,pid   | pid  | 5       | util.a.id |    2 | Using where |
|  4 | DEPENDENT SUBQUERY | child      | ref  | PRIMARY,pid   | pid  | 5       | util.a.id |    2 | Using where |
|  3 | DEPENDENT SUBQUERY | child      | ref  | pid           | pid  | 5       | util.a.id |    2 | Using where |
+----+--------------------+------------+------+---------------+------+---------+-----------+------+-------------+
5 rows in set (0.04 sec) 
```

* * *

如上所述，当父行数少于 100 时，*即使我们使用其主键索引到父*级，这也开始崩溃：

```
mysql> select * from parent_top_3 where  id < 10;
+----+------+------+------+-------+---------+---------+
| id | a    | b    | c    | maxid | maxidm1 | maxidm2 |
+----+------+------+------+-------+---------+---------+
|  1 |    1 |    1 | NULL |  NULL |    NULL |    NULL |
|  2 |    2 |    2 | NULL |    25 |      23 |      22 |
|  3 |    3 |    3 | NULL |    24 |      21 |      18 |
|  4 | NULL |    1 | NULL |    65 |      64 |      63 |
|  5 | NULL |    2 | NULL |    73 |      72 |      71 |
|  6 | NULL |    3 | NULL |   113 |     112 |     111 |
|  7 | NULL |    1 | NULL |   209 |     208 |     207 |
|  8 | NULL |    2 | NULL |   401 |     400 |     399 |
|  9 | NULL |    3 | NULL |   785 |     784 |     783 |
+----+------+------+------+-------+---------+---------+
9 rows in set (1 min 3.11 sec) 
```

（请注意，我故意在慢速机器上进行测试，数据保存在慢速闪存盘上。）

这是解释，正在寻找一个 id （以及第一个）：

```
mysql> explain select * from parent_top_3 where id = 1;
+----+--------------------+------------+------+---------------+------+---------+-----------+------+-------------+
| id | select_type        | table      | type | possible_keys | key  | key_len | ref       | rows | Extra       |
+----+--------------------+------------+------+---------------+------+---------+-----------+------+-------------+
|  1 | PRIMARY            | <derived2> | ALL  | NULL          | NULL | NULL    | NULL      | 1000 | Using where |
|  2 | DERIVED            | a          | ALL  | NULL          | NULL | NULL    | NULL      | 1000 |             |
|  5 | DEPENDENT SUBQUERY | child      | ref  | PRIMARY,pid   | pid  | 5       | util.a.id |  179 | Using where |
|  4 | DEPENDENT SUBQUERY | child      | ref  | PRIMARY,pid   | pid  | 5       | util.a.id |  179 | Using where |
|  3 | DEPENDENT SUBQUERY | child      | ref  | pid           | pid  | 5       | util.a.id |  179 | Using where |
 +----+--------------------+------------+------+---------------+------+---------+-----------+------+-------------+
 5 rows in set (56.01 sec) 
```

一排超过 56 秒，即使在我的慢机器上，也是两个数量级不可接受的。

那么我们可以保存这个查询吗？*有效*，就是太慢了。

这是修改后的查询的解释计划。它看起来很糟糕或更糟：

```
mysql> explain select * from parent_top_3a where id = 1;
+----+--------------------+------------+------+---------------+------+---------+-----------+------+-------------+
| id | select_type        | table      | type | possible_keys | key  | key_len | ref       | rows | Extra       |
+----+--------------------+------------+------+---------------+------+---------+-----------+------+-------------+
|  1 | PRIMARY            | <derived2> | ALL  | NULL          | NULL | NULL    | NULL      |  100 | Using where |
|  2 | DERIVED            | <derived4> | ALL  | NULL          | NULL | NULL    | NULL      |  100 |             |
|  4 | DERIVED            | <derived6> | ALL  | NULL          | NULL | NULL    | NULL      |  100 |             |
|  6 | DERIVED            | a          | ALL  | NULL          | NULL | NULL    | NULL      |  100 |             |
|  7 | DEPENDENT SUBQUERY | child      | ref  | pid           | pid  | 5       | util.a.id |  179 | Using where |
|  5 | DEPENDENT SUBQUERY | child      | ref  | PRIMARY,pid   | pid  | 5       | a.id      |  179 | Using where |
|  3 | DEPENDENT SUBQUERY | child      | ref  | PRIMARY,pid   | pid  | 5       | a.id      |  179 | Using where |
+----+--------------------+------------+------+---------------+------+---------+-----------+------+-------------+
7 rows in set (0.05 sec) 
```

但它完成速度快了*三个*数量级，在 1/20 秒内！

我们如何到达更快的 parent_top_3a？我们创建*了三个*视图，每个视图都依赖于前一个视图：

```
create view parent_top_1 as  
select a.*, 
(select max(id) from child where parent_id = a.id) 
 as maxid 
from parent a;

create view parent_top_2 as  
select a.*, 
(select max(id) from child where parent_id = a.id and id < a.maxid) 
 as maxidm1 
from parent_top_1 a;

create view parent_top_3a as  
select a.*, 
(select max(id) from child where parent_id = a.id and id < a.maxidm1)
 as maxidm2 
from parent_top_2 a; 
```

这不仅工作得更快，而且在 MySQL 以外的 RDBMS 上也是合法的。

让我们将父行数增加到 12800，子行数增加到 1536（大多数博文没有评论，对吧？;)）

```
mysql> select * from parent_top_3a where id >= 20 and id < 40;
+----+------+------+------+-------+---------+---------+
| id | a    | b    | c    | maxid | maxidm1 | maxidm2 |
+----+------+------+------+-------+---------+---------+
| 39 | NULL |    2 | NULL |  NULL |    NULL |    NULL |
| 38 | NULL |    1 | NULL |  NULL |    NULL |    NULL |
| 37 | NULL |    3 | NULL |  NULL |    NULL |    NULL |
| 36 | NULL |    2 | NULL |  NULL |    NULL |    NULL |
| 35 | NULL |    1 | NULL |  NULL |    NULL |    NULL |
| 34 | NULL |    3 | NULL |  NULL |    NULL |    NULL |
| 33 | NULL |    2 | NULL |  NULL |    NULL |    NULL |
| 32 | NULL |    1 | NULL |  NULL |    NULL |    NULL |
| 31 | NULL |    3 | NULL |  NULL |    NULL |    NULL |
| 30 | NULL |    2 | NULL |  1537 |    1536 |    1535 |
| 29 | NULL |    1 | NULL |  1529 |    1528 |    1527 |
| 28 | NULL |    3 | NULL |  1513 |    1512 |    1511 |
| 27 | NULL |    2 | NULL |  1505 |    1504 |    1503 |
| 26 | NULL |    1 | NULL |  1481 |    1480 |    1479 |
| 25 | NULL |    3 | NULL |  1457 |    1456 |    1455 |
| 24 | NULL |    2 | NULL |  1425 |    1424 |    1423 |
| 23 | NULL |    1 | NULL |  1377 |    1376 |    1375 |
| 22 | NULL |    3 | NULL |  1329 |    1328 |    1327 |
| 21 | NULL |    2 | NULL |  1281 |    1280 |    1279 |
| 20 | NULL |    1 | NULL |  1225 |    1224 |    1223 |
+----+------+------+------+-------+---------+---------+
20 rows in set (1.01 sec) 
```

请注意，这些时间是针对 MyIsam 表的；我会把它留给其他人在 Innodb 上进行计时。

* * *

但是使用 Postgresql，在类似但不相同的数据集上，我们在涉及' 列的`where`谓词上得到类似的时间：`parent`

```
 postgres=# select (select count(*) from parent) as parent_count, (select count(*) 
from child) as child_count;
 parent_count | child_count
--------------+-------------
        12289 |        1536

postgres=# select * from parent_top_3a where id >= 20 and id < 40;
 id | a | b  | c | maxid | maxidm1 | maxidm2
----+---+----+---+-------+---------+---------
 20 |   | 18 |   |  1464 |    1462 |    1461
 21 |   | 88 |   |  1463 |    1460 |    1457
 22 |   | 72 |   |  1488 |    1486 |    1485
 23 |   | 13 |   |  1512 |    1510 |    1509
 24 |   | 49 |   |  1560 |    1558 |    1557
 25 |   | 92 |   |  1559 |    1556 |    1553
 26 |   | 45 |   |  1584 |    1582 |    1581
 27 |   | 37 |   |  1608 |    1606 |    1605
 28 |   | 96 |   |  1607 |    1604 |    1601
 29 |   | 90 |   |  1632 |    1630 |    1629
 30 |   | 53 |   |  1631 |    1628 |    1625
 31 |   | 57 |   |       |         |
 32 |   | 64 |   |       |         |
 33 |   | 79 |   |       |         |
 34 |   | 37 |   |       |         |
 35 |   | 60 |   |       |         |
 36 |   | 75 |   |       |         |
 37 |   | 34 |   |       |         |
 38 |   | 87 |   |       |         |
 39 |   | 43 |   |       |         |
(20 rows)

Time: 91.139 ms 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T05:01:30.763

听起来你只想要`LIMIT`一个语句的子句`SELECT`：

```
SELECT comment_text, other_stuff FROM comments WHERE post_id = POSTID ORDER BY comment_time DESC LIMIT 3; 
```

对于要显示评论的每个帖子，您必须运行一次此查询。如果您愿意在 Quest for Ultimate Performance 中牺牲可维护性和理智，有几种方法可以解决这个问题：

1.  如上所述，每个帖子一个查询以检索评论。简单，但可能不是那么快。

2.  检索`post_ids`您想要显示评论的列表，然后检索这些帖子的所有评论，并在客户端过滤它们（或者如果您有窗口功能，您可以在服务器端进行，我认为，虽然这些不在MySQL)。在服务器端很简单，但客户端过滤会很丑陋，而且您仍在将大量数据从服务器移动到客户端，所以这可能也不会那么快。

3.  与 #1 一样，但要使用与`UNION ALL`要显示的帖子一样多的查询，因此您正在运行一个可恶的查询而不是 N 个小查询。丑陋，但它会比选项 1 或 2 更快。您仍然需要在客户端进行一些过滤，但仔细编写`UNION`会比 #2 所需的过滤更容易，而且不会浪费数据将通过网络发送。不过，这会产生一个*丑陋*的查询。

4.  加入帖子和评论表，部分旋转评论。*如果你只需要一条*评论，这很干净，但如果你想要三条评论，它很快就会变得一团糟。在客户端非常好，但 SQL 比 #3 更糟糕，而且服务器可能更难启动。

归根结底，我会选择选项 1，即上面的简单查询，而不必担心每个帖子执行一次的开销。如果您只需要一条评论，那么加入选项可能是可以接受的，但您需要三条评论并且排除了它。如果将窗口函数添加到 MySQL（它们在 PostgreSQL 的 8.4 版中），选项 2 可能会变得可口甚至更可取。不过，在那一天之前，只需选择简单易懂的查询即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T05:18:28.303

~~尽管可能有一种聪明的方法可以在没有架构更改的情况下在一个查询中获取此信息，但我猜它无论如何都不会高效~~. *编辑：*看起来 tpdi 有聪明的解决方案。它看起来可能很快，但我很想看到特定数据库的基准。

鉴于高性能和最小数据传输的限制，我有两个建议。

### 无需架构更改或维护的解决方案

第一的：

```
SELECT * FROM Posts 
```

收集ID，然后：

```
SELECT id FROM Replies WHERE post_id IN (?) ORDER BY id DESC 
```

最后，遍历这些 id，只为每个 post_id 获取前 3 个，然后执行：

```
SELECT * FROM Replies WHERE post_id IN (?) 
```

### 如果您愿意维护一些缓存列，则更有效的解决方案

第二种解决方案是假设读取远多于写入，您可以通过在每次添加回复时将最后三个评论 id 存储在 Posts 表中来最小化查找。在这种情况下，您只需添加三列`last_reply_id`,或类似的列。然后，您可以使用以下两个查询进行查找：`second_reply_id``third_reply_id`

```
SELECT * FROM Posts 
```

从这些字段中收集 id，然后：

```
SELECT * FROM Replies WHERE post_id IN (?) 
```

如果您有这些字段，您还可以手动构建一个三重连接，这将在一个查询中获取数据，尽管字段列表会非常冗长。就像是

```
SELECT posts.*, r1.title, r2.title ... FROM Posts 
  LEFT JOIN Replies as r1 ON Posts.last_reply_id = Replies.id
  LEFT JOIN Replies as r2 ON Posts.second_reply_id = Replies.id
  ... 
```

您更喜欢哪个可能取决于您的 ORM 或语言。

# vb.net - VB.NET 循环播放音频

> ID：780246
> 
> 赞同：0
> 
> 时间：2009-04-23T03:53:56.323
> 
> 标签：vb.net, audio, loops

我想在 VB.NET 中循环播放音频。

这是我的代码：

```
While blnAlert = True
            My.Computer.Audio.Play("C:\cat_1.wav")   
End While 
```

但它冻结了应用程序。

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T03:57:44.787

您编写的代码将无限循环。循环条件如下

```
While blnAlert = True 
```

如果这是真的，将进入循环。循环内的代码不会更改此值，因此条件将始终为真。这意味着循环不会结束。

您希望如何更新 blnAlert 的值？您能否发布更多代码或为我们提供更多有关问题的背景信息？

**EDIT** OP 表示 blnAlert 将通过按下按钮设置为 False

问题是在编写代码时无法按下取消按钮。一旦 while 循环被命中，它就不会退出。该应用程序将冻结，因为当您的代码正在执行时，表单无法重新绘制或处理任何用户输入。您必须将控制权交还给应用程序才能按下取消按钮。

解决此问题的最简单方法可能是使用计时器。创建一个计时器并在计时器滴答功能期间播放一次声音并离开。使用取消按钮停止计时器，从而停止播放声音。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T11:27:29.133

我知道 JaredPar 给出的答案将起作用并已被接受，但这是一个不同（且更简单）的解决方案，它使用 My.Computer.Audio.Play 也接受可选参数，包括 AudioPlayMode.BackgroundLoop 播放声音而不会停止执行直到My.Computer.Audio.Stop 被调用。

所以，开始播放声音：

```
My.Computer.Audio.Play("mysound.wav", AudioPlayMode.BackgroundLoop) 
```

并在按钮单击事件中：

```
My.Computer.Audio.Stop() 
```

# java - 自定义 Eclipse 应用程序中的对话框

> ID：780250
> 
> 赞同：1
> 
> 时间：2009-04-23T03:54:59.817
> 
> 标签：java, eclipse

我有一个由许多插件组成的 Eclipse 工作台应用程序。我想设置应用程序的关于文本以反映内部版本号。

似乎有几个地方可以做到这一点： - 在应用程序的 .product 文件内（在这里设置文本似乎没有做任何事情？） - 在主插件的 plugin.xml 文件内（这似乎有效） .

我有两个问题：

1.  实现这一目标的最佳方法是什么？通过plugin.xml？
2.  为什么我在产品文件中设置的文本会被忽略？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T06:13:30.590

它（关于对话框的文本和图片）应该在[功能](http://www.eclipse.org/articles/article.php?file=Article-Update/index.html)或产品插件的[about.ini](http://www.ibm.com/developerworks/opensource/library/os-ecfeat/index.html)中。

![品牌，在 www.ibm.com/developerworks/opensource/library/os-ecfeat/branding.jpg 之后](https://i.stack.imgur.com/rfwCQ.jpg)

注意：对于图片，这篇博文“ [How Can I Give My Eclipse Blob An Icon In The Flippin' About Dialog?](http://pookzilla.net/wp/2006/01/how-can-i-give-my-eclipse-blob-icon-in/) ”非常好。

Notebis：在最新的 3.5Mx 版本中，[about 框更加可配置](http://blog.eclipse-tips.com/2009/02/customizing-about-dialog.html)。

# database - 关系数据库管理系统与对象数据库

> ID：780255
> 
> 赞同：3
> 
> 时间：2009-04-23T03:56:44.973
> 
> 标签：database, architecture, orm

我是一所大学的研究助理。我们正在重组我们的软件架构主题，希望“现代化”，并解决我们在过去学期发现的一些教学和协作学习问题。

要求学生使用 Eclipse 快速构建其架构系统的原型。

为了持久性，我们已经引导学生使用 HSqlDb。

上学期我们收到了重要的反馈，即编写数据访问层和映射到 OO 花费了很多时间。这种管道工作可以更好地用于更相关的事情，例如扩展、端到端性能或满足更多场景。

在现实世界的制作中，我会选择一种 ORM 技术，比如 Hibernate，但该主题已经太复杂而无法教授另一种技术（恕我直言，Hibernate 对于学生来说是一个需要学习的大量技术）。

所以，我对 SO 社区的问题：

*   我们是否应该考虑给学生一个面向对象的数据库（如果它们仍然存在的话）？这节省了 ORM 和管道的时间
*   我们应该坚持使用 RDBMS 并告诉学生推出自己的 ORM 吗？
*   我们应该向学生介绍一个轻量级、简单的 ORM 吗？

请记住，这不是现实世界，但我们想尽可能多地教授现实世界的技能。教授 ORM 不如让学生快速制作满足场景的系统原型重要。

我本质上是一名 C# 开发人员，但学生们只有在进入该主题时才熟悉 Java。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T04:15:44.493

我必须完全不同意在教育环境中使用 ORM。您需要在跑步之前能够走路，并且使用 ORM 消除了学习过程中关于在应用程序中使用关系数据库的一个非常重要的步骤。你应该坚持一个非常轻量级的数据访问框架——一个要求学生编写自己的 SQL 并且（最多）不允许这个范围的代码绑定到 UI 或者（至少）不需要它。

诚然，我不熟悉 Java 世界，因为它与实际的企业开发相关，但我意识到（有点不情愿地）它是教育系统中的环境。虽然我认为学生应该接触.NET，但这是另一个论点；）无论如何，我很确定那里有某种框架可以满足这一点。

我愿意打赌那里有一些东西可以提供一些代码生成功能。在我以前的工作中，我们只使用 .NET 数据库库来（相对）低级别地从数据库中读取数据。我们没有使用任何存储库或更改跟踪技术，而是推出了我们自己的。SQL 命令是手工编写的，但该框架仍然提供类型安全和丰富的设计器支持。我的观点是两者都是可能的。我建议在 Java 中找到类似的东西，要求学生手动编写其中的一两个适配器，以了解其中的内容，然后让代码生成器根据他们的 SQL 进行其他“繁重的工作”管道陈述。

不要使用任何 SQL 生成。在让计算机为您完成之前，您必须能够编写 SQL。当你使用 ORM 做一些你不知道如何在 SQL 中做的事情时，你就失去了对数据库模型的控制，他们需要理解这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T04:04:12.210

作为一个热心拥抱 OO 而勉强接受 RDBMS 的人……我会鼓励，甚至恳求计算机科学部门将关系数据库的理论和实践放在首位。如果即使您对 OO 类使用 ORM 也可以做到这一点，那就去吧。但我更希望看到大学毕业的学生理解 OO - 关系映射**很难**，**为什么**很难，这并不意味着关系模型被破坏了。

反正不是*很*破。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T04:05:31.490

如果主要目标是让学生学习，那么我认为在这里使用 RDBMS 会是更好的方法——他们已经必须在应用程序端了解对象模型，因此将关系结构调和到整体架构组合中很重要技能。

关于提供诸如 Hibernate 之类的 ORM，我真的不同意这对学生来说是一件很重要的事情。关于 Hibernate 最好的事情之一是它的难度级别与您深入研究它的深度相关。它具有非常低的进入门槛（不到一天的 IMO）来学习基础知识，而且通常基础知识就是你所需要的——尤其是对于像原型这样的东西，这就是你所说的这个活动的目标。当然，它不需要学习到这样的程度，以至于它会在课程范围之外与学生保持联系。基本的休眠使用可能是一种一次性的技能。

总而言之，我建议坚持使用 RDBMS 并提供像 Hibernate 这样的 ORM。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-20T19:59:30.760

看看[DataObjects.Net](http://wiki.dataobjects.net) - 它共享 OR/M 框架以及对象数据库（如果使用内置存储提供程序）的好处，允许在支持的存储之间透明地迁移。

从架构和扩展的角度来看，它是相当先进的：查看[这篇文章](http://blog.dataobjects.net/2009/07/index-based-query-optimization-part-2_15.html)，了解它的查询优化技术。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T05:19:46.163

我认为这在很大程度上取决于学生对课程的了解。我这么说的原因可能是最好从他们都熟悉的东西开始，然后从那里继续前进。根据我的经验，大多数学生都了解对象是什么以及如何使用它们，因此将 SQL 表表示为对象似乎是一个很好的起点。

如果到目前为止您同意我的观点，那么您可能也同意 ORM 是将年轻程序员从面向对象编程的舒适区过渡到数据库编程的新世界的好方法。

我不太熟悉可用于 Java 实现 ORM 的工具，但我能够在短短几天内用 C#（使用 LINQ to MySQL）拿起它（在尝试学习 PHP 数周后惨遭失败之后） . 如果可以在 C# 中实现项目，那么使用 LINQ 的好处在于它让学生了解查询在 SQL 中的外观，而不会离开他们的 OOP 舒适区（假设他们至少对在。网）。这使您可以教授数据库编程的**概念**，而无需花费太多时间谈论它的**实现**。然后，一旦他们掌握了这些概念，您就可以回滚并向他们展示如何在 OOP 之外执行类似的实现（使用 SQL、PHP、JSP 等）

更不用说，它让他们很好地预览了如何使用最新的 .NET 技术来做一些非常先进的事情而无需太多努力（从长远来看，这可能对他们更有利）。

祝你好运！

# objective-c - 禁用撤消创建/删除 NSManagedObject

> ID：780262
> 
> 赞同：8
> 
> 时间：2009-04-23T04:00:58.567
> 
> 标签：objective-c, cocoa, core-data, undo

在我的核心数据模型中，我有一个关系`listItems`，它链接到几个`listItem`实体，每个实体都有一个`stringValue`属性。我创建了一个控件，它本质上是一个列表`NSTextFields`，每个列表项一个。该控件已正确绑定`listItems`，并且我已对其进行了设置，以便按下回车键在当前编辑的字段下直接创建一个新字段并将焦点更改为新字段。因此，本质上，要添加一个新项目，用户按下 Return 键。

同样，如果用户结束编辑并且当前编辑的字段为空，则该字段被删除（例如，空字段仅在“编辑模式”期间出现，可以这么说）。这工作得很好。基本上，在我的`listItem`NSManagedObject 子类中，我执行以下操作：

```
// Don't allow nil values
if (!value && [[self.recipe ingredients] count] > 1) {
    for (EAIngredientRef *ingredient in [self.recipe ingredients]) {
        if ([[ingredient sortIndex] integerValue] > [[self sortIndex] integerValue]) {
            [ingredient setSortIndex:[NSNumber numberWithInteger:([[ingredient sortIndex] integerValue]-1)]];
        }
    }
    [[self managedObjectContext] deleteObject:self];
    return;
}

// Code to handle if it is a real value 
```

我遇到的问题是每次以这种方式删除一行时，它都会向 undoManager 注册。因此，如果我编辑一行，按 Return（这会创建一个新行），然后单击离开以结束编辑，该行就会消失。但是，如果我随后撤消，则会重新出现空字段。我的目标是让 undoManager 忽略涉及空字段的删除操作。

我该怎么办？我已经尝试在几个地方使用`[[[self managedObjectContext] undoManager] disableUndoRegistration]`和关联`enableUndoRegistration`（例如`-didTurnIntoFault`，但我怀疑撤消注册可能在该方法之前发生）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-23T07:41:54.480

如果你更深入地研究 Core Data 文档，你会发现这个花絮被隐藏起来了：

```
[[self managedObjectContext] processPendingChanges];
[[[self managedObjectContext] undoManager] disableUndoRegistration];
// Do your work
[[self managedObjectContext] processPendingChanges];
[[[self managedObjectContext] undoManager] enableUndoRegistration]; 
```

Changes are not registered with the undo manager normally until the end of the event loop, and so were being registered *after* you'd turned undo registration back on. The above forces it to occur when you want.

# asp.net - 检索最后更新的记录

> ID：780264
> 
> 赞同：0
> 
> 时间：2009-04-23T04:01:48.503
> 
> 标签：asp.net, vb.net

如何检索上次更新的 EmpID 表单 sql 数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T04:06:43.563

您可以在插入或更新语句之后使用 SCOPE_IDENTITY()。

```
UPDATE Foo SET column1 = 'newValue'
SELECT SCOPE_IDENTITY() AS [LastUpdatedID] 
```

[http://msdn.microsoft.com/en-us/library/ms190315.aspx](http://msdn.microsoft.com/en-us/library/ms190315.aspx)

# sql - 从 sql 脚本创建 xml 文件

> ID：780265
> 
> 赞同：1
> 
> 时间：2009-04-23T04:02:28.550
> 
> 标签：sql, sql-server, xml

如何使用 tsql 在 sql server 2005 中生成 xml 文件

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-17T10:58:12.803

```
Select Emp_Id,Emp_Name from tblEmployee Where Emp_Id < 3
For XML AUTO,ELEMENTS
--For XML [MODE],ELEMENTS 
```

### 模式

自动、原始、显式

### 结果 [自动]

```
<tblEmployee>
 <Emp_Id>1</Emp_Id>
 <Emp_Name>AAA</Emp_Name>
</tblEmployee>
<tblEmployee>
 <Emp_Id>2</Emp_Id>
 <Emp_Name>BBB</Emp_Name>
</tblEmployee> 
```

### 结果 [RAW]

在 Xml 之上，而不是`<tblEmployee>`这里.....`<ROW>`并且`</tblEmployee>`是`</ROW>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T05:45:25.707

存储的 proc exec DBName.dbo.Table 是

```
select * from table for xml path 
SET @SQL= 'bcp "exec DBName.dbo.Table" queryout c:\myfile.xml -w -r -t -SServerName -T'
EXEC Master..xp_CmdShell @SQL 
```

# javascript - 使用 Javascript 复制粘贴

> ID：780271
> 
> 赞同：2
> 
> 时间：2009-04-23T04:04:35.470
> 
> 标签：javascript, javascript-events

我有两个文本框，可以说 EmailID 和 UserId。目前，当用户键入他/她的 EmailId 时，用户 ID 文本框中会显示相同的内容，为此我正在使用 OnkeyDown 事件 javascript。

我遇到的问题是，如果用户复制 EmailId 并将其粘贴到 EmailId 文本框中，则不会触发 OnKeyDown 事件，是否有任何其他事件需要捕获，或者是否有任何解决方法可用于此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T04:18:10.743

没有任何事件适用于更改文本框内容的所有方法。一种解决方法是在 EmailId 文本框获得焦点时设置间隔，并在 EmailId 模糊时取消它。间隔可以检查文本是否已更改，或者只是将 EmailId 的值复制到 UserID 中。

您是否必须在用户键入时更新用户 ID？在 EmailId 的 blur 事件中将 EmailId 的值复制到 UserId 会更干净。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T04:18:03.613

请改用 onchange 事件。那应该行得通。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T04:36:59.323

您可以使用户无法在 UserId 框中键入内容，将其设为只读，以便您仍然可以更新它。

然后，在电子邮件地址框上使用 onblur，然后将那里的任何内容复制到 UserId 框。

不应该有任何方法来更新不会触发 onblur 事件的电子邮件地址。

# .net - Int32^ i = gcnew Int32() 是否分配在托管堆上？

> ID：780283
> 
> 赞同：3
> 
> 时间：2009-04-23T04:09:37.987
> 
> 标签：.net, c++, new-operator

基本上我想知道和之间的
`Int32^ i = gcnew Int32();`
区别
`Int32* i2 = new Int32();`

我写了以下代码：

```
#include <stdio.h>
#using <mscorlib.dll>

using namespace System;

int main(void) {

    Int32^ i = gcnew Int32();
    Int32* i2 = new Int32();

    printf("%p %d\n", i2, *i2);
    printf("%p %d\n", i, *i);

    return 0;
} 
```

它提供以下输出：

```
004158B8 0
00E1002C 0 
```

似乎这两个整数分配在两个不同的内存位置。

*gcnew* Int32() 是否分配在托管堆中？还是直接在堆栈上？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T04:14:54.743

在托管 C++中，*新*分配在非托管堆上，*gcnew* - 在托管堆上。托管堆中的对象可以进行垃圾回收，而非托管堆中的对象则不能。*带有^*的指针像 C# 引用一样工作 - 运行时跟踪它们并用于垃圾收集，带有 * 的指针像普通的 C++ 指针一样工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T04:19:17.027

我得到了答案。gcnew 将在托管堆上分配对象，即使类型是值类型。

因此， Int32^ i = gcnew Int32() 将在托管堆上分配新创建的对象。

下面的代码可以证明这一点：

```
#include <stdio.h>
#using <mscorlib.dll>

using namespace System;

int main(void) {
    Object^ o = gcnew Object();
    long j = 0;

    while (GC::GetGeneration(o) == 0) {
        Int32^ i = gcnew Int32();
        j += 4;

        if (j % 100 == 0) {
            printf("%d\n", i);
        }
    }

    printf("Generation 0 collection happens at %ld\n", j);        

    return 0;
} 
```

它与输出一起运行

```
14849324
14849260
14849196
14849132
14849068
14849004
14848940
14848876
14848812
14848748
14848684
14848620
14848556
14848492
14848428
14848364
Generation 0 collection happens at 146880 
```

# syntax - Scala 中符号文字的一些示例用例是什么？

> ID：780287
> 
> 赞同：95
> 
> 时间：2009-04-23T04:11:51.257
> 
> 标签：syntax, scala

从我在 Scala 上读到的内容中，符号文字的使用并不是很清楚。有人愿意分享一些现实世界的用途吗？

符号文字是否涵盖了特定的 Java 习惯用法？哪些语言有类似的结构？我来自 Python 背景，不确定该语言中有什么类似的东西。

是什么促使我使用“HelloWorld”与“HelloWorld”？

谢谢

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-04-23T07:58:06.173

在 Java 术语中，符号是内部字符串。这意味着，例如，引用相等比较（`eq`在 Scala 和Java 中）给出与正常相等比较（在 Scala 和Java 中）`==`相同的结果：将返回 true，而可能不会，这取决于 JVM 的突发奇想（嗯，它应该对于文字，但不适用于一般动态创建的字符串）。`==``equals``'abcd eq 'abcd``"abcd" eq "abcd"`

其他使用符号的语言是 Lisp（使用`'abcd`类似 Scala）、Ruby ( `:abcd`)、Erlang 和 Prolog ( `abcd`；它们被称为原子而不是符号）。

当我不关心字符串的结构并将其纯粹用作某事物的名称时，我会使用符号。例如，如果我有一个表示 CD 的数据库表，其中包含一个名为“price”的列，我不在乎“price”中的第二个字符是“r”，或者关于连接列名；因此 Scala 中的数据库库可以合理地使用表名和列名的符号。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-04-23T06:19:22.260

如果您在代码中有表示方法名称的纯字符串，可能会被传递，那么您并不能正确地传达信息。这有点像数据/代码边界问题，画线并不总是那么容易，但如果我们说在那个例子中这些方法名称是代码而不是数据，那么我们想要一些东西来清楚地识别.

符号文字开始发挥作用，它清楚地区分任何旧的字符串数据和代码中使用的构造。它就在你想指出的地方，这不仅仅是一些字符串数据，实际上是代码的一部分。像你的 IDE 这样的想法会以不同的方式突出它，并且给定工具，你可以重构这些，而不是进行文本搜索/替换。

这个[链接](http://www.artima.com/forums/flat.jsp?forum=282&thread=238176)很好地讨论了它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-09-24T09:41:59.470

注意：`Symbols`将被弃用，然后在 Scala 3 (dotty) 中被删除。

参考：[http ://dotty.epfl.ch/docs/reference/dropped-features/symlits.html](http://dotty.epfl.ch/docs/reference/dropped-features/symlits.html)

因此，我个人建议不要再使用`Symbols`（至少在新的 scala 代码中）。正如 dotty 文档所述：

> 不再支持符号文字

> 建议使用纯字符串文字 [...]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-23T13:45:08.710

Python 维护一个内部全局表，其中包含所有变量、函数、模块等的名称。*有了*这个表，解释器可以进行更快的搜索和优化。`intern`您可以使用函数（`sys.intern`在 python3 中）强制执行此过程。

此外，Java 和 Scala 自动使用*“内部字符串”*来加快搜索速度。使用 scala，您可以使用该`intern`方法强制字符串的实习生，但此过程不适用于所有字符串。符号受益于保证被实习，因此单个引用相等检查足以证明相等或不相等。

# asp.net-mvc - MVC - 实现会员在线功能

> ID：780291
> 
> 赞同：1
> 
> 时间：2009-04-23T04:14:16.133
> 
> 标签：asp.net-mvc

我有一个 ASP.NET MVC 应用程序，我想在每个页面中添加一个在线成员列表。实际上添加到母版页。

成员属于组，所以我想显示组中的所有成员。

那么这样做的最佳方法是什么？

例如，在会话开始时添加到缓存对象中的集合，并在 Global.asax 中的会话结束时将其删除。

这样靠谱吗？？流量不会很大。

马尔科姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T04:33:20.067

是的，您必须使用 Application 对象来存储它，并且可以在 Session Start/Session End 事件中进行。在开始时添加到应用程序，并在结束时删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T16:56:45.893

请参阅[如何确定 ASP.NET 站点 (IIS) 上的用户数？他们的信息呢？](https://stackoverflow.com/questions/155593/how-can-i-determine-the-number-of-users-on-an-asp-net-site-iis-and-their-info)相同的方法可用于 WebForms 以及 ASP.NET MVC。

# flash - 相邻精灵的矩阵变换导致子像素间隙

> ID：780295
> 
> 赞同：4
> 
> 时间：2009-04-23T04:16:43.320
> 
> 标签：flash, actionscript-3, sprite

我有三个精灵，堆叠在一起。

我修改了他们的 transform.matrix 以呈现他们一致增长的外观。

然而，根据比例因子，瓷砖之间有时会出现小裂缝。

[精灵之间的裂缝 http://img21.imageshack.us/img21/7518/cracks.png](http://img21.imageshack.us/img21/7518/cracks.png)

我想知道如何解决这个问题。

我知道[AS3 中的文本对象具有亚像素渲染选项](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextField.html#gridFitType)。也许所有 AS3 都存在类似的设置？其他想法？

不起作用的策略：cacheAsBitmap。

```
package
{

import flash.display.Sprite;
import flash.geom.Matrix;
import flash.geom.Point;

import mx.core.UIComponent;

public class tmpa extends UIComponent
{

    private var _scale:Number;

    private var _s1:Sprite;
    private var _s2:Sprite;
    private var _s3:Sprite;

    private var _s1Pt:Point;
    private var _s2Pt:Point;
    private var _s3Pt:Point;

    private var _tileDim:int;

    public function tmpa( ):void
    {
        _scale = 1;
        _tileDim = 100;

        _s1 = new Sprite();
        _s2 = new Sprite();
        _s3 = new Sprite();

        paintSprite( _s1, _tileDim );
        paintSprite( _s2, _tileDim );
        paintSprite( _s3, _tileDim );

        _s1Pt = new Point( 100, _tileDim );
        _s1.x = _s1Pt.x;
        _s1.y = _s1Pt.y;
        _s2Pt = new Point( 100, _tileDim*2 );
        _s2.x = _s2Pt.x;
        _s2.y = _s2Pt.y;
        _s3Pt = new Point( 100, _tileDim*3 );
        _s3.x = _s3Pt.x;
        _s3.y = _s3Pt.y;

        addChild( _s1 );
        addChild( _s2 );
        addChild( _s3 );

        scale = 1.0394; //cracks
        //scale = 1.0306; // nocracks
    }

    private function paintSprite( s:Sprite, dim:int, color:int=0xFF0000 ):void
    {   s.graphics.beginFill( color, .5 );
        s.graphics.drawRect( 0, 0, dim, dim );
        s.graphics.endFill( );
    }

    public function set scale( s:Number ):void
    {   _scale = s;

        var scaleFromPt:Point = new Point( 20, 20 );
        updateSpriteMatrix( _s1, _s1.globalToLocal(scaleFromPt), _s1Pt );
        updateSpriteMatrix( _s2, _s2.globalToLocal(scaleFromPt), _s2Pt );
        updateSpriteMatrix( _s3, _s3.globalToLocal(scaleFromPt), _s3Pt );
    }

    public function get scale( ):Number
    {   return _scale;
    }

    private function updateSpriteMatrix( t:Sprite, ctrPt:Point, regPt:Point ):void
    {   var mx:Matrix = t.transform.matrix;
        mx.identity();
        mx.scale( _scale, _scale );
        mx.translate( ctrPt.x*(1-_scale), ctrPt.y*(1-_scale));
        mx.translate( regPt.x, regPt.y );
        t.transform.matrix = mx;
    }

}
} 
```

和mxml：

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"
            xmlns:a="*"
            width="100%" height="100%"
            paddingTop="0" paddingBottom="0" paddingLeft="0" paddingRight="0"
            backgroundColor="0x000000"
            backgroundGradientAlphas="undefined">
    <a:tmpa id="t" width="100%" height="100%" x="0" y="0" left="0" top="0"/>
</mx:Application> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T08:13:36.340

有差距的原因是由于舍入误差。Flash 只能将元素定位到像素的二十分之一（一缇）。您将 y 位置设置为

*   3.152000000000008
*   7.092000000000018
*   11.032000000000028

分别。显然，这比发生舍入的二十分之一要精确得多。一旦发生舍入，您很容易出错。

在我看来，您应该将所有项目放入其他容器中，然后缩放容器。您只执行一次转换但获得相同结果的方式。

但是我知道在某些情况下可能需要这种方法。解决方法是首先执行所有比例变换。然后执行相对于前一个精灵的翻译。这样一来，它总是会基于之前的圆形药水。这是一个从您的班级中窃取的快速示例。显然有很多方法可以组织这个，但为了简单起见，我试图按照你的工作方式来玩玩具。

```
package
{

import flash.display.Sprite;
import flash.geom.Matrix;
import flash.geom.Point;

import mx.core.UIComponent;

public class tmpa extends UIComponent
{

        private var _scale:Number;

        private var _s1:Sprite;
        private var _s2:Sprite;
        private var _s3:Sprite;

        private var _s1Pt:Point;
        private var _s2Pt:Point;
        private var _s3Pt:Point;

        private var _tileDim:int;

        public function tmpa( ):void
        {
                _scale = 1;
                _tileDim = 100;

                _s1 = new Sprite();
                _s2 = new Sprite();
                _s3 = new Sprite();

                paintSprite( _s1, _tileDim );
                paintSprite( _s2, _tileDim );
                paintSprite( _s3, _tileDim );

                _s1Pt = new Point( 100, _tileDim );
                _s1.x = _s1Pt.x;
                _s1.y = _s1Pt.y;
                _s2Pt = new Point( 100, _tileDim*2 );
                _s2.x = _s2Pt.x;
                _s2.y = _s2Pt.y;
                _s3Pt = new Point( 100, _tileDim*3 );
                _s3.x = _s3Pt.x;
                _s3.y = _s3Pt.y;

                _s1.transform.matrix = new Matrix();
                _s2.transform.matrix = new Matrix();
                _s3.transform.matrix = new Matrix();

                addChild( _s1 );
                addChild( _s2 );
                addChild( _s3 );

                scale = 1.0394; //cracks
                //scale = 1.0306; // nocracks
        }

        private function paintSprite( s:Sprite, dim:int, color:int=0xFF0000 ):void
        {       s.graphics.beginFill( color, .5 );
                s.graphics.drawRect( 0, 0, dim, dim );
                s.graphics.endFill( );
        }

        public function set scale( s:Number ):void
        {       _scale = s;

                scaleSpriteMatrix( _s1 );
                scaleSpriteMatrix( _s2 );
                scaleSpriteMatrix( _s3 );

                translateSprite(_s2, _s1);
                translateSprite(_s3, _s2);
        }

        public function get scale( ):Number
        {       return _scale;
        }

        private function scaleSpriteMatrix( targetSprite:Sprite):void
        {       var mx:Matrix = targetSprite.transform.matrix;
                mx.scale( _scale, _scale );
                targetSprite.transform.matrix = mx;
        }

        private function translateSprite( targetSprite:Sprite, basedOnSprite:Sprite):void
        {       var mx:Matrix = targetSprite.transform.matrix;
                mx.translate( basedOnSprite.x, basedOnSprite.y + basedOnSprite.height);
                targetSprite.transform.matrix = mx;
        }

}
} 
```

希望有帮助

詹姆士

# c - 使用 fseek 回溯

> ID：780303
> 
> 赞同：5
> 
> 时间：2009-04-23T04:21:26.193
> 
> 标签：c, file-io, fseek

使用`fseek`回溯字符`fscanf`操作可靠吗？

例如，如果我刚刚`fscanf`-ed 10 个字符，但我想回溯 10 个字符，我可以`fseek(infile, -10, SEEK_CUR)`吗？

在大多数情况下，它都有效，但我似乎对角色有问题`^M`。显然`fseek`将其注册为 char 但`fscanf`不注册它，因此在我之前的示例中`^M`，需要一个包含 a 的 10 char 块`fseek(infile, -11, SEEK_CUR)`。`fseek(infile, -10, SEEK_CUR)`会使它缩短 1 个字符。

为什么会这样？

编辑：我`fopen`在文本模式下使用

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T05:33:25.243

您会看到“文本”和“二进制”文件之间的区别。当以文本模式打开文件时（在 fopen 第二个参数中没有“b”），stdio 库可能（实际上，必须）根据操作系统对文本文件的约定来解释文件的内容。例如，在 Windows 中，一行以 \r\n 结尾，而这会被 stdio 转换为单个 \n，因为这是 C 约定。写入文本文件时，单个 \n 将输出为 \r\n。

这使得编写处理文本文件的可移植 C 程序变得更加容易。然而，一些细节变得复杂，fseeking 就是其中之一。正因为如此，C 标准只在少数情况下在文本文件中定义 fseek：到最开始、到最后、到当前位置，以及到使用 ftell 检索到的先前位置。换句话说，您无法计算要查找文本文件的位置。或者你可以，但你必须自己处理所有特定于平台的细节。

或者，您可以使用二进制文件并自己进行行尾转换。同样，便携性受到影响。

在您的情况下，如果您只想回到上次执行 fscancf 的位置，最简单的方法是在 fscanf 之前使用 ftell。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T04:41:54.257

这是因为 fseek 使用字节，而 fscanf 智能地处理回车和换行是两个字节，并将它们作为一个字符吞下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T04:38:14.267

Fseek 不了解文件的内容，只是将文件指针向后移动 10 个字符。

fscanf 取决于操作系统，可能会以不同的方式解释换行符；如果您在 DOS 上并且 ^M 未出现在文件中，甚至可能 fscanf 将插入 ^M。检查 C 编译器附带的手册

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T04:48:31.417

刚刚用 VS2008 试过这个，发现 fscanf 和 fseek 以相同的方式处理 CR 和 LF 字符（作为单个字符）。

所以有两个文件：

0000000: 3132 3334 3554 3738 3930 3132 3334 3536 12345X7890123456

和

0000000: 3132 3334 350d 0a37 3839 3031 3233 3435 12345..789012345

如果我读取了 15 个字符，我会找到第二个“5”，然后再寻找 10 个字符，我读取的下一个字符是第一种情况下的“X”和第二种情况下的 CRLF。

这似乎是一个非常特定于操作系统/编译器的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T05:32:36.693

您是否测试了 的返回值`fscanf`？贴一些代码。

看看[`ungetc`](http://opengroup.org/onlinepubs/007908799/xsh/ungetc.html)。您可能必须在它上面运行一个循环。

# vb.net - VB.NET 获取 .wav 文件的属性

> ID：780304
> 
> 赞同：0
> 
> 时间：2009-04-23T04:22:13.277
> 
> 标签：vb.net

如何使用 VB.NET 获取 .wav 文件的属性。特别是，我正在寻找具有 .wav 持续时间的属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T04:25:02.130

看到这个问题：

[如何确定 C# 中 .wav 文件的长度？](https://stackoverflow.com/questions/82319/how-can-i-determine-the-length-of-a-wav-file-in-c)

# bash - Shell 脚本中的循环

> ID：780305
> 
> 赞同：0
> 
> 时间：2009-04-23T04:22:32.637
> 
> 标签：bash, shell, unix

我需要这个 shell 脚本的帮助。

1.  必须使用某种循环。
2.  必须完全按照所示使用输入数据。
3.  输出重定向应该在脚本中完成，而不是在命令行上。

这是我的输入文件：http: [//pastebin.com/m3f783597](http://pastebin.com/m3f783597)

这是输出需要的内容：http: [//pastebin.com/m2c53b25a](http://pastebin.com/m2c53b25a)

这是我失败的尝试： http: [//pastebin.com/m2c60b41](http://pastebin.com/m2c60b41)

失败的尝试输出： http: [//pastebin.com/m3460e78c](http://pastebin.com/m3460e78c)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T05:42:22.897

这是帮助。在查看下面的解决方案之前，请尽量遵循这些。从长远来看，这将帮助你更多，在短期内，因为可以肯定你的教育者可以尽可能容易地看到这一点。

如果他发现你抄袭了代码，那可能意味着瞬间失败。

你所说的“失败的尝试”就在这里。第一次尝试实际上并不算太糟糕。

```
echo -e "Name\t\t On-Call\t\t Phone"
for daycount in 2 1 4 5 7 6 3
do
    for namecount in 3 2 6 1 7 4 5
    do
        day=`head -n $daycount p2input2|tail -n 1|cut -f 2 -d " "`
        name=`head -n $namecount p2input1|tail -n 1|cut -f 1 -d " "`
        phone=`head -n $namecount p2input1|tail -n 1|cut -f 2 -d " "`
        echo -e "$name\c"
        echo -e "\t\t$day\c"
        echo -e "\t\t$phone"
        continue
    done
done 
```

以下是提示：

*   你有两个循环，一个在另一个循环中，每个循环出现 7 次。这意味着 49 行而不是 7 行输出。您希望每天处理并查找当天的姓名和电话（实际上是当天的姓名和电话的姓名）。
*   这不是真正合适的硬编码行号（尽管我承认它是偷偷摸摸的） - 如果数据顺序发生变化怎么办？最好搜索值。
*   制表符使事情变得混乱，使用空格代替，因为那时输出不依赖于终端设置，您无需担心未对齐的制表符。

而且，为了完整起见，这里是两个输入文件和预期的输出：

```
p2input1                  p2input2
========                  ========
Dave 734.838.9801         Bob Tuesday
Bob 313.123.4567          Carol Monday
Carol 248.344.5576        Ted Sunday
Mary 313.449.1390         Alice Wednesday
Ted 248.496.2204          Dave Thursday
Alice 616.556.4458        Mary Saturday
Frank 634.296.3357        Frank Friday

Expected output
===============
Name            On-Call         Phone

carol           monday          248.344.5576
bob             tuesday         313.123.4567
alice           wednesday       616.556.4458
dave            thursday        734.838.9801
frank           friday          634.296.3357
mary            saturday        313.449.1390
ted             sunday          248.496.2204 
```

说了这么多，假设您已经离开至少两个小时来尝试运行您的版本，这是我的：

```
 1 #!/bin/bash
 2 spc20="                    "
 3 echo "Name            On-Call         Phone"
 4 echo
 5 for day in monday tuesday wednesday thursday friday saturday sunday
 6 do
 7     name=`grep -i " ${day}$" p2input2 | awk '{print $1}'`
 8     name=`echo ${name} | tr '[A-Z]' '[a-z]'`
 9     bigname=`echo "${name}${spc20}" | cut -c1-15`
10
11     bigday=`echo "${day}${spc20}" | cut -c1-15`
12
13     phone=`grep -i "^${name} " p2input1 | awk '{print $2}'`
14
15     echo "${bigname} ${bigday} ${phone}"
16 done 
```

以下描述应该会有所帮助：

*   第 1 行选择正确的 shell，并不总是必要的。
*   第 2 行给了我们足够的空间来使格式化更容易。
*   第 3-4 行给出了标题和空白行。
*   第 5-6 行在一天中循环，一次一个。
*   第 7 行为我们命名了这一天。在 awk 语句为您提供字段 1（名称）时`'grep -i " ${day}$"'`，在行尾搜索给定的日期（无论大小写）。`pinput2`
*   第 8 行只是将名称全部小写。
*   第 9 行通过添加 50 个空格然后在末尾切断除 15 之外的所有空格来创建一个大小合适的输出字符串。
*   第 11 行在当天做同样的事情。
*   第 13 行与第 7 行非常相似，不同之处在于它搜索、*在行*`pinput1`首查找姓名并返回电话号码作为*第二个*字段。
***   第 15 行只输出单个项目。*   第 16 行结束循环。**

 **所以你有它，足够的提示（希望）修复你自己的代码，以及一个关于专业人士如何做的示例:-)。

阅读使用的工具、`grep`、`tr`和`cut`是明智的`awk`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T09:36:50.743

试试这个：

```
sort file1.txt > file1sort.txt
sort file2.txt > file2sort.txt
join file2sort.txt file1sort.txt | column -t > result.txt
rm file1sort.txt file2sort.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T04:31:30.460

这是家庭作业，我猜？

阅读排序和粘贴命令`man sort`：`man paste`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T07:05:07.877

Pax 给出了一个很好的答案，但此代码调用的进程更少（11 与最少 56 = 7 * 8）。它使用一个辅助数据文件来给出星期几和它们的序列号。

```
cat <<! >p2input3
1 Monday
2 Tuesday
3 Wednesday
4 Thursday
5 Friday
6 Saturday
7 Sunday
!

sort +1 p2input3 > p2.days
sort +1 p2input2 > p2.call
join -1 2 -2 2 p2.days p2.call | sort +2 > p2.duty
sort +0 p2input1 > p2.body
join -1 3 -2 1 p2.duty p2.body | sort +2n | tr '[A-Z]' '[a-z]' |
awk 'BEGIN { printf("%-14s %-14s %s\n", "Name", "On-Call", "Phone");
             printf "\n"; }
           { printf("%-14s %-14s %s\n", $1, $2, $4);}'
rm -f p2input3 p2.days p2.call p2.duty p2.body 
```

该`join`命令功能强大，但要求两个文件中的数据在连接键上按排序顺序排列。该`cat`命令给出了天的列表和天数。按日期名称的字母顺序列出的第一个排序位置。第二种也是按日期名称的字母顺序排列值班人员的姓名。然后第一个连接将这两个文件合并为日期名称，然后根据用户名进行排序，产生输出：

```
Wednesday 3 Alice
Tuesday 2 Bob
Monday 1 Carol
Thursday 4 Dave
Friday 5 Frank
Saturday 6 Mary
Sunday 7 Ted 
```

最后一种排序将姓名和电话号码按姓名字母顺序排列。然后第二个连接将姓名 + 电话号码列表与姓名 + 职责列表相结合，产生 4 列输出。这是`tr`为了使数据全部小写，然后用 格式化`awk`，这很好地展示了它的功能和简单性（你可以使用 Perl 或 Python，但坦率地说，这会更麻烦）。

Perl 有一句座右铭：TMTOWTDI “有不止一种方法可以做到”。

这通常也适用于 shell 脚本。

* * *

我想我的代码没有使用循环......哦，亲爱的。将初始`cat`命令替换为：

```
 for day in "1 Monday" "2 Tuesday" "3 Wednesday" "4 Thursday" \
            "5 Friday" "6 Saturday" "7 Sunday"
 do echo $day
 done > p2input3 
```

这现在符合规则的文字。

# url - foo.com/alice 与 foo.com/users/alice

> ID：780311
> 
> 赞同：9
> 
> 时间：2009-04-23T04:25:28.977
> 
> 标签：url, mod-rewrite, url-rewriting, namespaces, friendly-url

为用户在您的网站上的内容提供友好的 URL 固然很好。但如何最好地做到这一点？像 foo.com/users/alice 这样的东西有很多优点，最重要的是你不会弄乱你的根命名空间。但我认为用户的简单性胜过这一切。许多大网站似乎都同意（friendfeed、delicious 和 flickr 浮现在脑海中），这个问题是关于如何在服务器端实现这一点。

假设 alice 的真实 URL 是 foo.com/userpage?user=alice，如果有人试图浏览一个不存在的用户页面（比如说 foo.com/bob），他们应该到达 foo.com/createnew?user=bob .

用户当然不应该看到上面丑陋的“真实” URL，只是 foo.com/alice 或 foo.com/bob。请注意，根命名空间是共享的。例如，foo.com/help 不应该被翻译成 foo.com/userpage?user=help。

大概我要求一些简单的 mod_rewrite 规则，但也许有一些我没有想到的完全不同的方法。无论如何，我认为最好为这个常见问题记录一个明确的或“最佳实践”的解决方案。

PS：请随意评论其他替代方案的优点，例如 alice.foo.com 或 users.foo.com/alice。

PPS：我想我已经在其他问题中看到过这个问题，但搜索起来似乎很棘手。欢迎指点！当然，还有其他关键字可以使其更易于搜索。关键字：用户空间、全局命名空间、URL 命名空间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T04:43:03.240

我会说这取决于您的网站如何以用户为中心。

myspace 之类的网站是[http://www.myspace.com/jim/](http://www.myspace.com/jim/)，因为该网站完全围绕用户展开。

但是，您可以注册但不重要或不强制的博客或新闻网站可以从中受益

[http://www.news.com.au/users/jim/](http://www.news.com.au/users/jim/)

你认为如果你正在做一个有用户的网站，你可以从 MVC 设计模式中受益，或者至少是一个流行的 MVC 框架，它使用路由器来引导 URIs？

如果该 URI 来自路由器，然后被发送到 UsersController，您可以决定要么显示用户的配置文件，要么指示他们创建该用户。除了制定一条规则，将所有对不存在文件的请求定向到 index.php （或服务器端语言的默认值）之外，您不需要搞乱 mod_rewrite

如果您确实想使用 mod_rewrite，请尝试以下规则

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !(home|contact|about) [NC] // this line may be incorrect
RewriteRule ^/users/([^/]+)/?$ userpage?user=$1 [NC,L] 
```

请注意 Gumbo 建议的前导克拉，因此它仅匹配 TLD 的 /users/。

这将匹配 foo.com/users/bob 之类的任何内容，并带有可选的尾部斜杠。它不区分大小写，将是最后应用的规则。

如果请求进来并且您的数据库中不存在 $_GET['user'] ，您可以尝试这样的事情

```
$user = $_GET['user'];

if (!user_exists($user)) {

    header('Location: createnew?user=' . urlencode($user));
    exit();

} 
```

然后在createnew页面上，简单地做这样的事情

```
<input type="text" name="username" value="<?php echo htmlspecialchars(urldecode($_GET['user'])); ?>" /> 
```

这将使用他们尝试访问配置文件的用户名自动填写用户名。

如果您想了解更多关于 PHP 和 MVC 的信息，请尝试 Google 搜索或在 Stack Overflow 上提问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T01:05:52.697

以下规则将 foo.com/bar 形式的 URL 重写为 foo.com/userpage?user=bar，条件是 bar 还不是服务器上的文件或目录。将以下内容放入 .htaccess 中：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/?$ userpage?user=$1 [NC,L]
</IfModule> 
```

正如亚历克斯的回答，如果用户不存在，用户页面脚本应该重定向到 createnew：

```
$user = $_GET['user'];
if (!user_exists($user)) {
  header('Location: createnew?user=' . urlencode($user));
} 
```

（正如 Knuth 所说，请注意上述代码中的错误——我只是证明它是正确的，没有尝试过。当我真正确认它有效时，我会更新这个答案。） PS：确认！

# asp.net-mvc - 我可以将 MVC 操作作为 AutoCompleteExtender 的 ServiceMethod 吗？

> ID：780313
> 
> 赞同：0
> 
> 时间：2009-04-23T04:26:42.047
> 
> 标签：asp.net-mvc, autocompleteextender

假设 Tools 是我的控制器，我在 ServicePath 中指定“/Tools”，在 ServiceMethod 中指定操作名称“GetToolsList”。我可以用这种方式触发 AutoCompleteExtender 吗？我怎样才能在这里将 prefixText 传递给 Action？还是不可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T05:21:02.033

做到了。创建了一个返回 void 的操作，并对输出进行 JSON 序列化并将其写入响应对象，以便在 AutoCompleteExtender 中读取和显示它。

# .net - HttpWebResponse 响应流的最佳缓冲区大小

> ID：780316
> 
> 赞同：10
> 
> 时间：2009-04-23T04:28:50.593
> 
> 标签：.net, buffer, httpwebresponse

与来自 HttpWebResponse.GetResponseStream() 的流一起使用的最佳缓冲区大小是多少？

在线示例从 256b 到 5Kb 不等。是什么赋予了？我猜缓冲区大小可能是根据情况而定的。如果是这样，在什么情况下使用什么类型的缓冲区大小？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T04:44:54.110

真的，这并不重要。

当然，如果您使用非常小的缓冲区，您可能需要通过层进行一些额外的调用以获取字节（尽管流可能至少会进行一些缓冲——我不知道它的默认值是什么）。当然，如果你使用非常大的缓冲区，你会浪费一些内存并引入一些碎片。由于您显然在这里进行 IO，因此您通过调整缓冲区获得的任何时间都将受 IO 时间的支配。

作为一般规则，我在 2048 (2k) 和 8192 (8k) 之间选择 2 的幂。[如果您使用等于或大于 85,000 字节的缓冲区（然后它是一个“大对象”并受不同的 GC 规则约束](http://msdn.microsoft.com/en-us/magazine/cc534993.aspx)） ，请确保您知道自己在做什么。

事实上，比缓冲区大小更重要的是你持有它的时间。对于大对象堆之外的对象，GC 非常擅长处理生命周期很短的对象（Gen 0 收集速度很快），或者生命周期很长的对象（Gen 2）。在被释放之前存活到第 1 代或第 2 代的对象相对来说成本更高，而且通常比缓冲区有多大更值得您花时间担心。

最后一点：如果您认为由于使用的缓冲区大小而存在性能问题，请对其进行**测试**。这不太可能，但谁知道呢，也许你有一个奇怪的操作系统版本、网络硬件和驱动程序版本的融合，在特定大小的缓冲区中有一些奇怪的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T05:06:04.013

我的轶事经验是，它确实取决于你在做什么，但通常在 1024-4096 字节（1-4KB 也就是 2 的幂）范围内的任何东西都会给我相当的性能（4KB 是“最佳”数字我见过）。

基本上，您需要一个足够大的缓冲区，这样您就不会从流中不必要地读取数据，但又不会大到会减少回报。如果您的缓冲区太大（~MBs），那么您将增加您的内存缓存未命中，这实际上可能会开始降低您的性能。当然，这取决于实际的硬件（总线速度、缓存大小等）变化很大，但我似乎有 4MB 缓冲区比 4KB 缓冲区慢的情况（这两种情况都有很长的生命周期，所以 GC 不是一个问题）。

正如 Jonathan 所说，在尝试过早优化之前测试您当前的实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-13T04:18:08.330

实际上，当缓冲区大小太小时我遇到问题。我已经对其进行了测试并验证了缓冲区大小不应设置为较小的值。在我的示例中，我将其设置为 2048，与 firefox 相比，下载变得非常慢（firefox 也没有下载分段，与我的相同）。

在我将它设置为大尺寸 409600 后，下载速度要快得多，我认为额外的调用会产生开销或使下载速度变慢。也许在网络层面，缓冲区超出了你的缓冲区大小，所以 TCP 需要要求重新发送包？（只是一个猜测，因为我不知道 TCP 是如何工作的），但是小缓冲区肯定会减慢我的下载速度。我已经通过使用 firefox 默认下载（没有添加和分段）运行并使用我的类对其进行了测试，两者差别太大了。

现在它更快了，每次循环时，它会读取大约 200000 字节（200Kb），因为这里的连接速度很快，但是在我运行两个线程之后，它会慢很多，可能需要与另一个线程共享。

# c# - 在整个 ASP.net 项目中使用的变量是如何以及在哪里创建/存储的？

> ID：780317
> 
> 赞同：0
> 
> 时间：2009-04-23T04:28:57.113
> 
> 标签：c#, asp.net

我希望能够存储我的 ASP.net 项目中的所有其他文件都可以访问但可以通过编程方式修改的变量。我正在寻找的东西类似于能够从 web.config 文件中提取信息，例如数据库连接字符串（例如 System.Configuration.ConfigurationManager.ConnectionStrings["cnDatabase"].ToString()）

我有具有在所有其他页面之间共享的值的变量，我希望能够在一个位置进行修改，而不必在 4+ aspx.cs 页面中更新相同的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T04:44:51.257

Web.Config 文件中的 AppSettings

或者

公共/内部常量

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T01:17:45.273

如果您想要一些对应用程序来说是全局的，您可以在其中添加自定义变量，请使用 Global.asax。您在此处添加的任何内容都可以通过在所有页面和控件中继承的全局变量获得。如果您只需要一个键/值存储，则可以使用在所有页面和控件中继承的 Application 或 Session 静态变量。Application（它只是 HttpApplicationState 的静态实例）是一个对象，您可以将其用作 Hashtable 来存储自定义值，这些值将在所有用户的所有页面上可用。并且，Session (HttpSessionState) 可以与 Hashtable 相同的方式使用，但您存储的值对于每个用户会话都是唯一的。

注意：如果您需要访问页面或控件之外的任何这些对象（即在页面请求的上下文中使用的自定义类），您可以通过当前 http 上下文 (HttpContext.Current) 获取对它们的引用.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T04:33:47.913

我认为您正在寻找的是项目的设置功能。

这是一个很好的介绍： http: [//msdn.microsoft.com/en-us/library/aa730869 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/aa730869(VS.80).aspx)

注意：这不适用于“网站”类型的项目，仅适用于 ASP.Net Web 应用程序项目。

# c# - 如何在 C# 中创建自定义文件扩展名？

> ID：780319
> 
> 赞同：6
> 
> 时间：2009-04-23T04:29:06.037
> 
> 标签：c#, file-extension

我需要有关如何在我的 C# 应用程序中创建自定义文件扩展名的帮助。我创建了一个基本的笔记管理应用程序。现在我将我的笔记保存为 .rtf (note1.rtf)。我希望能够创建一个只有我的应用程序才能理解的文件扩展名（比如，note.not，也许）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-23T07:29:28.160

作为部署点，您应该注意 ClickOnce 支持文件扩展名（只要它不处于“仅在线”模式）。这使得配置系统以识别新文件扩展名变得轻而易举。

您可以在 VS2008 中的项目属性 -> 发布 -> 选项 -> 文件关联中找到它。如果你没有 VS2008 你也可以[手动做](https://docs.microsoft.com/en-us/visualstudio/deployment/fileassociation-element-clickonce-application)，但是不好玩。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-23T04:32:08.430

文件扩展名是您的格式的任意选择，它仅取决于您的应用程序在安装时将某个文件扩展名注册为 Windows 中某种类型的文件。

提出您自己的文件格式通常意味着您使用只有您的应用程序可以解析的格式保存该格式。它可以是纯文本或二进制，甚至可以使用 XML 或任何格式，关键是您的应用程序应该能够轻松解析它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T06:26:26.987

您的问题有两种可能的解释：

**我的文件的文件格式应该是什么？**

您当前正在以 RTF 格式保存您的笔记。无论您选择将它们保存为什么文件扩展名，只要用户知道它在 RTF 中并将该应用程序指向该文件，任何理解 RTF 格式的应用程序都可以打开您的笔记。

如果您想以自定义文件格式保存文档，以便其他应用程序无法读取它们。您需要编写代码来获取由 Rich Edit 控件生成的 RTF 流（我假设这就是您在应用程序中用作编辑器的内容）并使用您自己的格式将其序列化为二进制流。

我个人认为这不值得付出努力......

**我的文件的文件扩展名是什么**

您当前正在以 RTF 格式保存您的文档，文件扩展名为 .rtf。其他应用程序与该文件扩展名相关联，因此在 Windows 资源管理器中双击此类文件会打开该应用程序而不是您的。

如果您希望能够在 Windows 资源管理器中双击您的文件并打开您的应用程序，您需要更改您正在使用的文件扩展名并为该扩展名创建正确的关联。

文件扩展名关联由注册表中的条目定义。您可以为每台机器（在 HKLM\Software\Classes 中）或每用户（在 HKCU\Software\Classes 中）创建这些，尽管每台机器是最常见的情况。有关实际注册表项和指向 MSDN 文档和示例的链接的更多详细信息，请查看我[对 Vista 文档图标关联的这个 SO 问题的](https://stackoverflow.com/questions/580827/how-does-vista-generate-the-icon-for-documents-associated-to-my-application)回答。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T04:35:35.537

我认为这是创建正确的注册表值的问题，

或查看此[代码项目的文章](http://www.codeproject.com/KB/dotnet/System_File_Association.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T04:36:38.547

您可以使用任何您想要的扩展名保存文件，只需在保存文件时将其放在文件名中。

我感觉到您的问题是“我如何将文件保存在 RTF 以外的文件中？”。您必须发明自己的格式，但实际上您并不想要这样。您仍然可以将 RTF 保存到名为 mynote.not 的文件中。

我建议您继续使用其他程序可以读取的格式。一旦您的用户想要对他们的笔记做一些您的程序不支持的事情，他们会很感激。

# python - 从 HTTP 转义 Python 字符串

> ID：780334
> 
> 赞同：18
> 
> 时间：2009-04-23T04:36:55.800
> 
> 标签：python, http, header, urllib2, mod-wsgi

我从 HTTP 标头中获得了一个字符串，但它已被转义.. 我可以使用什么函数来取消转义它？

```
myemail%40gmail.com -> myemail@gmail.com 
```

urllib.unquote() 会是要走的路吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-23T04:41:14.930

我很确定 urllib[`unquote`](http://docs.python.org/library/urllib.html#urllib.unquote)是这样做的常用方法。

```
>>> import urllib
>>> urllib.unquote("myemail%40gmail.com")
'myemail@gmail.com' 
```

还有[`unquote_plus`](http://docs.python.org/library/urllib.html#urllib.unquote_plus)：

> 与 unquote() 类似，但也将加号替换为空格，这是取消引用 HTML 表单值的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T04:42:59.763

是的，它似乎[`urllib.unquote()`](http://docs.python.org/library/urllib.html#urllib.unquote)完成了这项任务。（我[在 codepad 上针对您的示例对其进行了测试](http://codepad.org/SerdBuAK)。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-10T15:09:14.167

在 Python 3 中，这些函数是[`urllib.parse.unquote`](https://docs.python.org/3.4/library/urllib.parse.html#urllib.parse.unquote)和[`urllib.parse.unquote_plus`](https://docs.python.org/3.4/library/urllib.parse.html#urllib.parse.unquote)。

后者例如用于 HTTP URL 中的查询字符串，其中空格字符 ( `) 传统上编码为加号 ( `+`)，而`+`百分比编码为`%2B`。`

 `除了这些之外，还有[`unquote_to_bytes`](https://docs.python.org/3.4/library/urllib.parse.html#urllib.parse.unquote_to_bytes)将给定的编码字符串转换为`bytes`，当编码未知或编码数据是二进制数据时可以使用它。但是没有`unquote_plus_to_bytes`，如果你需要它，你可以这样做：

```
def unquote_plus_to_bytes(s):
    if isinstance(s, bytes):
        s = s.replace(b'+', b' ')
    else:
        s = s.replace('+', ' ')
    return unquote_to_bytes(s) 
```

* * *

有关是否使用`unquote`或`unquote_plus`在[URL 编码空格字符时可用的更多信息： + 或 %20](https://stackoverflow.com/questions/1634271/url-encoding-the-space-character-or-20)。

# xslt - 在 XSL 中查找最多三个数字

> ID：780336
> 
> 赞同：1
> 
> 时间：2009-04-23T04:37:05.033
> 
> 标签：xslt

如何在 XSL 中找到最多三个数字？更多信息：我有三个数字，例如 1.0、2.0、5.0 ......我没有设置任何节点......我想找到 1.0、2.0 和 5.0 的最大值......

例子 ：

```
AIM : TO know which type of node <MYNODE>, <DOC>, <PIC> 
is having maximum count and whant's the count number ?

    <ROOT>
              <MYNODES>
                   <MYNODE>A</MYNODE>
                   <MYNODE>B</MYNODE>
                   <MYNODE>C</MYNODE>
                   <MYNODE>D</MYNODE>
              </MYNODES> 
              <DOCS>
                   <DOC>1</DOC>
                   <DOC>2</DOC>
                   <DOC>3</DOC>
              </DOC> 
              <PICS>
                   <PIC>a.jpeg</PIC>
                   <PIC>b.jpeg</PIC>
                   <PIC>c.jpeg</PIC>
                   <PIC>d.jpeg</PIC>
                   <PIC>e.jpeg</PIC>
              </PICS> 
    </ROOT> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T10:26:59.233

使用您的输入 XML，您会找到您正在寻找的最大计数，如下所示：

```
<xsl:variable name="vMaxChildren">
  <xsl:for-each select="/ROOT/*">
    <xsl:sort select="count(*)" data-type="number" order="descending" />
    <xsl:if test="position() = 1">
      <xsl:value-of select="concat(name(), ': ', count(*))" />
    </xsl:if>
  </xsl:for-each>
</xsl:variable>

<xsl:value-of select="$vMaxChildren" /> 
```

这会产生：

```
PICS: 5 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:06:08.363

**这个问题的表述不正确，并且提供的“XML 文档”格式不正确！**

请注意，**询问一组数字*的***最大值通常是没有意义的。具有最高值的数字可能不止一个。因此，以下解决方案仅显示具有最大值的第一项。

**这是一种可能的 XSLT 1.0 解决方案**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

    <xsl:template match="/">
      <xsl:variable name="vNameMaxCount">
          <xsl:for-each select="*/*">
            <xsl:sort select="count(*)" data-type="number"
             order="descending"/>

             <xsl:if test="position() = 1">
                <xsl:value-of select="concat(name(),'+', count(*))"/>
             </xsl:if>
          </xsl:for-each>
      </xsl:variable>

      One element with maximum children is: <xsl:text/>
      <xsl:value-of select="substring-before($vNameMaxCount, '+')"/>

      Maximum number of children: <xsl:text/>
      <xsl:value-of select="substring-after($vNameMaxCount, '+')"/>

    </xsl:template>
</xsl:stylesheet> 
```

**当将上述转换应用于以下 XML 文档时**（在花费 10 分钟使其格式良好后从提供的文档生成！）：

```
<ROOT>
    <MYNODES>
        <MYNODE>A</MYNODE>
        <MYNODE>B</MYNODE>
        <MYNODE>C</MYNODE>
        <MYNODE>D</MYNODE>
    </MYNODES>
    <DOCS>
        <DOC>1</DOC>
        <DOC>2</DOC>
        <DOC>3</DOC>
    </DOCS>
    <PICS>
        <PIC>a.jpeg</PIC>
        <PIC>b.jpeg</PIC>
        <PIC>c.jpeg</PIC>
        <PIC>d.jpeg</PIC>
        <PIC>e.jpeg</PIC>
    </PICS>
</ROOT> 
```

**产生了想要的结果**

```
 One element with maximum children is: PICS

  Maximum number of children: 5 
```

**一个 XSLT 2.0 解决方案（实际上只是一个 XPath 2.0 解决方案）：**

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 >
 <xsl:output method="text"/>

 <xsl:template match="/">
   <xsl:sequence select=
    "for $vmaxChildrein in max(/*/*/count(*)),
         $vmaxNode in */*[count(*) = $vmaxChildrein][1]
      return 
         (name($vmaxNode), 
          'has the max no of children:', 
          $vmaxChildrein
          )
    "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当对上述文档应用此转换时，会产生所需的结果：**

```
PICS has the max no of children: 5 
```

**为了找到无法立即表示为 XPath 表达式并用于**的更棘手的属性的最大值**`<xsl:sort>`，**请使用`f:maximum()`FXSL 的功能。****

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T05:11:51.410

5.0 是三个数字中最大的一个。硬编码它并完成它。:-)

不过说真的，你可能希望走另一条路。这样的逻辑在其他语言中是微不足道的，但在 XSLT 中可能会很痛苦。您应该考虑为 XSLT 引擎编写一个简单的扩展，而不是试图让 XSLT 做您想做的事。

# sql - SQL查询检查表中的40列是否为空

> ID：780337
> 
> 赞同：11
> 
> 时间：2009-04-23T04:37:35.203
> 
> 标签：sql

如何在表中选择仅包含所有行的 NULL 值的几列？假设如果 Table 有 100 列，在这 100 列中，有 60 列有空值。如何编写 where 条件来检查 60 列是否为空。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-23T04:41:53.010

也许有一个 COALESCE

```
SELECT * FROM table WHERE coalesce(col1, col2, col3, ..., colN) IS NULL 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-23T04:40:27.023

```
where c1 is null and c2 is null ... and c60 is null 
```

**`string concatenation`**使用（Oracle 语法）的快捷方式：

```
where c1||c2||c3 ... c59||c60 is null 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-18T19:24:04.197

如果您不想写列名，Try 可以这样做。
这将向您显示除您指定的列（IgnoreThisColumn1 和 IgnoreThisColumn2）之外的所有列值为空时的所有行。

```
DECLARE @query NVARCHAR(MAX);

SELECT @query = ISNULL(@query+', ','') + [name] 
                FROM  sys.columns 
                WHERE object_id = OBJECT_ID('yourTableName') 
                AND  [name] != 'IgnoreThisColumn1' 
                AND  [name] !=  'IgnoreThisColumn2';

SET @query = N'SELECT * FROM TmpTable WHERE COALESCE('+ @query +') IS NULL';

EXECUTE(@query) 
```

结果

[![结果一](https://i.stack.imgur.com/GhMRJ.png)](https://i.stack.imgur.com/GhMRJ.png)

如果除了您指定的列之外，所有列都为空时您不想要行，您可以简单地使用`IS NOT NULL`而不是`IS NULL`

```
SET @query = N'SELECT * FROM TmpTable WHERE COALESCE('+ @query +') IS NOT NULL'; 
```

结果

[![结果二[2]](https://i.stack.imgur.com/lg9ld.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T05:20:58.533

您是想找出一组特定的 60 列是否为空，还是只想找出 100 列中的任何 60 列是否为空（不一定每行都有相同的 60？）

如果是后者，在 oracle 中执行此操作的一种方法是使用 nvl2 函数，如下所示：

```
select ... where (nvl2(col1,0,1)+nvl2(col2,0,1)+...+nvl2(col100,0,1) > 59) 
```

快速测试这个想法：

```
select 'dummy' from dual where nvl2('somevalue',0,1) + nvl2(null,0,1) > 1 
```

返回 0 行，同时：

```
select 'dummy' from dual where nvl2(null,0,1) + nvl2(null,0,1) > 1 
```

按预期返回 1 行，因为多个列为空。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T06:22:13.220

首先，如果您有一个包含这么多空值的表并且您使用 SQL Server 2008 - 您可能希望使用稀疏列 ( [http://msdn.microsoft.com/en-us/library/cc280604) 来定义该表。 .aspx](http://msdn.microsoft.com/en-us/library/cc280604.aspx)）。

其次，我不确定 coalesce 是否能解决问题——似乎 Ammu 实际上可能想要找到所有行都为空的列的列表，但我可能误解了。尽管如此 - 这是一个有趣的问题，所以我编写了一个程序来列出任何给定表的空列：

```
IF (OBJECT_ID(N'PrintNullColumns') 不为空)
    DROP PROC dbo.PrintNullColumns;
去
CREATE PROC dbo.PrintNullColumns(@tablename sysname)
作为
开始
    设置无计数；
    声明 @query nvarchar(max);
    声明 @column 系统名；
    DECLARE columns_cursor CURSOR FOR
        选择 c.name
        FROM sys.tables t JOIN sys.columns c ON t.object_id = c.object_id
        WHERE t.name = @tablename AND c.is_nullable = 1;
    打开 columns_cursor;
    FETCH NEXT FROM columns_cursor INTO @column;
    同时（@@FETCH_STATUS = 0）
    开始
        SET @query = N'
        声明@c int
        SELECT @c = COUNT(*) FROM ' + @tablename + ' WHERE ' + @column + N' 不为空
        如果 (@c = 0)
            打印 (''' + @column + N''');'
        执行（@查询）；

        FETCH NEXT FROM columns_cursor INTO @column;
    结尾
    关闭 columns_cursor;
    DEALLOCATE columns_cursor;
    设置无计数；
    返回;
结尾;
去

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T04:55:57.640

了解您正在使用哪个数据库以及使用哪种语言或数据库框架可能会有所帮助。

这应该适用于任何数据库。

像这样的东西可能是一个很好的存储过程，因为它没有输入参数。

```
select count(*) from table where col1 is null or col2 is null ... 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-25T13:08:27.523

这是另一种在我看来也是合乎逻辑的方法（使用 Netezza 或 TSQL）

```
SELECT KeyColumn, MAX(NVL2(TEST_COLUMN,1,0) AS TEST_COLUMN 
  FROM TABLE1
 GROUP BY KeyColumn 
```

因此，每个`TEST_COLUMN`值为`MAX`0 的列都是包含记录集的所有空值的列。该函数`NVL2`说如果列数据不为空，则返回 1，但如果为空，则返回 0。

取该`MAX`列的 将显示是否有任何行不为空。值 1 表示至少有 1 行包含数据。零 (0) 表示每一行都为空。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-15T15:49:29.870

当我必须检查多个列 NULL 时，我使用以下查询。我希望这是有帮助的 。如果 SUM 达到 Zero 以外的值，则该列中有 NULL

```
select SUM (CASE WHEN col1 is null then 1 else 0 end) as null_col1,
SUM (CASE WHEN col2 is null then 1 else 0 end) as null_col2,
SUM (CASE WHEN col3 is null then 1 else 0 end) as null_col3, ....
.
.
.
from tablename 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-03-08T13:27:55.327

您可以使用

```
select NUM_NULLS  , COLUMN_NAME  from all_tab_cols  where table_name = 'ABC' and COLUMN_NAME in ('PQR','XYZ'); 
```

# java - log4j - 应用程序启动时触发日志滚动

> ID：780340
> 
> 赞同：1
> 
> 时间：2009-04-23T04:39:38.507
> 
> 标签：java, logging, log4j

使用 log4j，我想要 DailyRollingFileAppender 的行为，以便在应用程序启动时可以发生基于日期模式的日志滚动。但是一旦应用程序启动，我不希望它在下次应用程序重新启动之前执行任何自动日志轮换。如何配置 log4j 来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T07:38:54.287

您必须通过遍历所有记录器、获取记录器然后要求 ti 不再滚动来以编程方式设置记录器属性。这是我认为的唯一方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T09:28:24.443

您的规范听起来像是您希望应用程序启动，创建特定日期的日志文件，并继续使用它直到它关闭。

如果是这种情况，您可能想要创建自己的 Appender 实现，可能源自[FileAppender](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/FileAppender.html)

# c++ - 静态语言的运行时优化：C++ 的 JIT？

> ID：780349
> 
> 赞同：21
> 
> 时间：2009-04-23T04:42:50.217
> 
> 标签：c++, optimization, jit, performance

是否有人使用 JIT 技巧来提高静态编译语言（如 C++）的运行时性能？似乎基于运行时观察的热点分析和分支预测可以提高任何代码的性能，但也许有一些基本的战略原因使得在运行时进行这种观察和实施更改只能在虚拟机中进行。我清楚地记得在听动态语言爱好者谈论收集统计数据和重新排列代码时无意中听到 C++ 编译器作者喃喃地说“你也可以为用 C++ 编写的程序做这件事”，但我的网络搜索支持这种记忆的证据已经枯竭。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-23T05:07:39.673

配置文件引导优化不同于运行时优化。优化仍然是离线完成的，基于分析信息，但是一旦二进制文件交付，就没有持续的优化，所以如果配置文件引导优化阶段的使用模式不能准确反映实际使用情况，那么结果将是不完善，程序也不会适应不同的使用模式。

您可能会对查找有关[HP Dynamo](http://www.hpl.hp.com/techreports/1999/HPL-1999-78.html)的信息感兴趣，尽管该系统专注于本机二进制 -> 本机二进制翻译，尽管由于 C++ 几乎完全编译为本机代码，我想这正是您正在寻找的。

您可能还想看看[LLVM](http://www.llvm.org)，它是一个编译器框架和支持 JIT 编译和运行时优化的中间表示，尽管我不确定是否实际上有任何基于 LLVM 的运行时可以编译 C++ 并执行 + 运行时优化它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-23T10:28:58.620

在过去的几年里，我做了很多这样的优化。这是我实现的图形渲染 API。由于 API 定义了数千种不同的绘图模式作为通用功能，因此速度很慢。

我最终为特定领域的语言编写了自己的小型 Jit 编译器（非常接近 asm，但包含一些高级控制结构和局部变量）。

我得到的性能提升在 10 到 60 倍之间（取决于编译代码的复杂性），所以额外的工作得到了很大的回报。

在 PC 上，我不会开始编写自己的 jit 编译器，而是使用 LIBJIT 或 LLVM 进行 jit 编译。在我的情况下这是不可能的，因为我正在开发不受 LIBJIT/LLVM 支持的非主流嵌入式处理器，所以我必须自己发明。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-11-21T04:53:06.527

答案更有可能：没有人比 PGO 为 C++ 做的更多，因为好处可能不明显。

让我详细说明一下：从开发人员的角度来看， *JIT*引擎/运行时既有优点也有缺点：它们在运行时有更多信息，但分析时间却很少。一些优化真的很昂贵，而且你不可能看到对开始时间没有巨大影响的那些优化是：循环展开、自动矢量化（在大多数情况下也是基于循环展开）、指令选择（使用 SSE4.1 进行使用 SSE4.1 的 CPU）结合指令调度和重新排序（使用更好的超标量 CPU）。这种优化与类似 C 的代码（可从 C++ 访问）很好地结合在一起。

进行高级编译的单一成熟编译器架构（据我所知）是 Java *Hotspot*编译和使用分层编译具有类似原理的架构（Java *Azul*的系统，当时流行的*JaegerMonkey* JS 引擎）。

但运行时最大的优化之一如下：

**多态内联缓存**（这意味着如果您使用某些类型运行第一个循环，第二次循环的代码将是来自前一个循环的特殊类型，*JIT*将放置一个保护并将内联的分支作为默认分支类型，并基于它，从这种使用*SSA*形式引擎的特殊形式中，将应用常量折叠/传播、内联、死代码消除优化，并取决于*JIT*的“高级”程度，将进行改进或CPU 寄存器分配改进较少。）您可能会注意到，*JIT*（热点）将主要改进分支代码，并且运行时信息将比 C++ 代码更好，但是静态编译器，在它旁边有时间进行分析，指令重新排序，对于简单循环，可能会变得更好一点表现。而且，通常情况下，C++ 代码，需要快速的区域往往不是 OOP，因此*JIT*优化的信息不会带来如此惊人的改进。

*JIT*的另一个优点是*JIT*可以跨程序集工作，因此如果要进行内联，它会获得更多信息。

 *让我详细说明一下：假设您有一个基类 A，而您在另一个包/程序集/gem/etc 中**只有一个**实现，即 B。并且是动态加载的。

*JIT*看到 B 是 A的唯一实现，它可以在其内部表示中的任何地方用 B 代码替换 A 调用，并且方法调用不会进行调度（查看 vtable），而是直接调用。这些直接调用也可能是内联的。例如这个 B 有一个方法：`getLength()`它返回 2，所有对的调用都`getLength()`可以减少到常量 2。最后，C++ 代码将无法跳过另一个 dll 对 B 的虚拟调用。

C++ 的一些实现不支持优化更多的 .cpp 文件（即使在今天，在最新版本的*GCC*中也有 -lto 标志使这成为可能）。但是如果你是 C++ 开发者，关心速度，你可能会将所有敏感类放在同一个静态库甚至同一个文件中，这样编译器就可以很好地内联它，让 JIT 设计的额外信息，由开发者自己提供，所以没有性能损失。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-23T04:46:47.600

Visual Studio 有一个用于执行运行时分析的选项，然后可用于优化代码。

“配置文件引导优化”

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-23T04:49:56.157

Microsoft Visual Studio 将此称为“[配置文件引导优化](http://msdn.microsoft.com/en-us/library/e7k32f4k(VS.80).aspx)”；[您可以在MSDN](http://msdn.microsoft.com/en-us/library/e7k32f4k(VS.80).aspx)上了解有关它的更多信息。基本上，您使用附加的探查器运行程序多次以记录其热点和其他性能特征，然后您可以将探查器的输出提供给编译器以获得适当的优化。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-24T18:44:09.767

我相信[LLVM](http://llvm.org/)试图做到这一点。它试图在程序的整个生命周期（编译时、链接时和运行时）中进行优化。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-24T18:31:00.330

合理的问题-但前提令人怀疑。

正如 Nils 的回答一样，有时“优化”意味着“低级优化”，这本身就是一个很好的主题。

但是，它基于“热点”的概念，与通常给出的相关性相去甚远。

定义：热点是一小块代码区域，进程的程序计数器在其中花费了大部分时间。

如果存在热点，例如占用大量时间的紧密内部循环，则值得尝试在低级别进行优化，如果它在您控制的代码中（即不在第三方库中）。

现在假设内部循环包含对函数的调用，任何函数。现在程序计数器不太可能在那里找到，因为它更有可能在函数中。因此，虽然代码可能很浪费，但它不再是热点。

使软件变慢的常见方法有很多，热点就是其中之一。但是，根据我的经验，这是大多数程序员都知道的唯一一种，也是唯一适用低级优化的一种。

[看到这个。](https://stackoverflow.com/questions/763656/should-we-still-be-optimizing-in-the-small/763754#763754)

# java - 推荐的开源java邮件列表软件

> ID：780357
> 
> 赞同：5
> 
> 时间：2009-04-23T04:48:02.120
> 
> 标签：java, open-source, mailing-list

任何人都可以推荐一个基于开源邮件列表软件吗？

如果可能的话，以下都是需要的：

*   Java 作为底层语言，因为我们有 Java 经验丰富的人
*   打包为战争的东西，可以放入 Tomcat 服务器
*   流畅的界面
*   基础数据应合理透明
*   对团体的良好支持 - 有时我们想向所有人发送邮件，有时只向在某个区域工作的人发送邮件等。

这是针对非营利性纳税人资助的研究机构，因此开源（免费）是一个高度优先事项。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T01:41:31.270

[http://subetha.tigris.org/](http://subetha.tigris.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-25T15:23:06.233

阿帕奇詹姆斯[http://james.apache.org/server/2.3.2/mailing_lists.html](http://james.apache.org/server/2.3.2/mailing_lists.html)

# asp.net - 怎么把byte[]打开成adobe格式？

> ID：780358
> 
> 赞同：0
> 
> 时间：2009-04-23T04:48:02.917
> 
> 标签：asp.net, adobe

我将图像放入字节 []。我需要在 asp.net 中将它打开到 adobe 文件中。我使用以下代码：

```
byte[] bytes = contractimage.Value.Bytes;
                if (bytes == null)
                {
                    Response.Write("Not found.");
                    Response.End();
                }
                else
                {                    
                    Response.AddHeader("content-disposition",
                        "attachment;filename=statement" + contractGuid.ToString() + ".pdf");
                    Response.ContentType = "application/pdf";
                    Response.OutputStream.Write(bytes, 0, bytes.Length);
                    Response.End();
                } 
```

但是此代码显示 adobe 无法显示此文件的错误，它可能已损坏。请建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T05:22:30.650

位图的 byte[] 不是 pdf 文档。

您需要做的是创建一个包含您的位图的 pdf 文档。如果我站在你的立场上，我可能会使用[ITextSharp 之](http://itextsharp.sourceforge.net/)类的东西来做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T05:16:11.493

您必须以 PDF 文件的形式格式化您的输出，您目前只发送原始图像数据，而不是正确格式化的 PDF 文件。

你可以参考：

[http://www.adobe.com/devnet/pdf/pdf_reference.html](http://www.adobe.com/devnet/pdf/pdf_reference.html)

对于 PDF 格式的规范或更简单的解决方案是使用第三方工具来完成您的任务。

尝试在 Google 上搜索“pdf .net creator”之类的内容

# hibernate - JPA/Hibernate 批量插入缓慢

> ID：780362
> 
> 赞同：4
> 
> 时间：2009-04-23T04:50:51.163
> 
> 标签：hibernate, jpa

我正在使用 Hibernate 作为我的提供者使用 JPA 进行批量插入。数据库是甲骨文。它创建了一个序列生成器，每次插入时都会查询序列生成器的 nextval。如果我正在执行 1K 插入，它将击中序列生成器 1K 次。如果我想坚持使用 JPA，有什么方法可以加快速度？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-08-06T01:03:06.123

`allocationSize`在 JPA 中使用`@SequenceGenerator`.

请参阅此示例，其中设置为 150：

```
@Id
@GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "MY_ENTITY_SEQ")
@SequenceGenerator(name = "MY_ENTITY_SEQ", sequenceName = "MY_ENTITY_SEQ", allocationSize = 150)
@Column(name = "MY_ENTITY", nullable = false)
private Long id; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T06:40:47.087

试一试序列预分配功能：

> 序列对象提供了最佳的排序选项，因为它们是最有效的并且具有最好的并发性，但是它们是最不便携的，因为大多数数据库不支持它们。**序列对象通过将数据库序列对象上的 INCREMENT 设置为序列预分配大小来支持序列预分配。**

# api - 是否可以开发一个 Facebook 应用程序来过滤提要中的更新？

> ID：780365
> 
> 赞同：1
> 
> 时间：2009-04-23T04:52:58.397
> 
> 标签：api, facebook

也就是说，Facebook API 是否使这成为可能？我想保持我的新闻提要完整，但删除符合某些我不想看到的事情的标准的帖子（例如，不要向我展示任何听起来像迪克切尼可能说过的东西）。Facebook API 是否允许应用自定义用户的正常新闻提要？我花了几分钟查看 facebook 开发人员页面，但没有看到任何直接回答我的问题，所以我希望一些对 Facebook 的 API 有经验的开发人员可以在这里帮助我。

在任何人提到它之前，我不想只是隐藏这些用户的更新。他们可能会发布我想看到的其他更新，所以我更愿意根据内容过滤掉更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T05:15:28.500

有一个名为“ [Facebook Purity](http://userscripts.org/scripts/show/44459) ”的 Greasemonkey 脚本可以做到这一点。您可能可以查看源代码并将其更改为您的规范。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T04:54:15.103

您可以将新闻提要解析到您网站上的数据库中，然后使用代码来解析是否显示它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T04:57:31.163

是的，这是可能的，但前提是您所有的朋友都决定添加您的应用程序！否则您可能无法访问他们的提要。

自从我使用 Facebook SDK 以来已经有一段时间了，所以这可能已经改变了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T05:12:38.787

API 提供的新闻提要集成非常少，您不能使用该 API 来防止新闻提要项目出现在用户提要中。您所能做的就是发布和获取，并且您每天只能发布 10 条内容，即“重要”互动。Facebook API 并非旨在增强或改变 Facebook 的核心体验，它旨在允许开发人员在非常有限且严格控制的沙箱中创建添加到 Facebook 的第三方应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T05:28:49.683

[Linq to facebook](http://vincenthomedev.wordpress.com/2009/03/09/linq-to-fql-facebook-query-language/)项目看起来很有趣，并且可能允许您做您所要求的（如果使用 .NET 3.5）。我很抱歉链接到这样一个粉红色的网站;-)

# java - socket通信中大数据的读写方法不可靠

> ID：780373
> 
> 赞同：1
> 
> 时间：2009-04-23T04:59:23.700
> 
> 标签：java, sockets

我为服务器客户端通信创建了一个套接字编程。我正在使用`read(byte[])`of读取数据，也在使用of`DataInputStream`写入数据。`write(byte[])``DataOutputStream`

每当我发送少量数据时，我的程序都可以正常工作。但是，如果我发送 20000 个字符的数据并发送 10 次，那么我可以完美接收数据 8 次，但不能接收 2 次。

那么我可以在套接字编程中使用读写可靠地发送和接收数据吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T05:23:10.197

我的猜测是你发出一个单一的调用`read()`并假设它会返回你要求的所有数据。流通常不会那样工作。它会阻塞直到*有一些*数据可用，但它不会等到有足够的数据来填充数组。

通常这意味着循环。例如：

```
byte[] data = new byte[expectedSize];
int totalRead = 0;
while (totalRead < expectedSize)
{
    int read = stream.read(data, totalRead, expectedSize-totalRead);
    if (read == -1)
    {
        throw new IOException("Not enough data in stream");
    }
    totalRead += read;
} 
```

如果您一开始不知道您期望多少字节，您可能仍然希望循环，但这次直到`read()`返回 -1。使用缓冲区（例如 8K）读取和写入`ByteArrayOutputStream`. 阅读完毕后，您可以将数据`ByteArrayOutputStream`作为字节数组取出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T05:24:29.430

绝对——如果正确使用 API，TCP 套接字是一种可靠的网络协议。

您确实需要检查在每次 read() 调用中收到的字节数。

套接字将任意决定您有足够的数据并将其传递回 hte read 调用——数量可能取决于许多因素（缓冲区大小、内存可用性、网络响应时间等），其中大多数是不可预测的。对于较小的缓冲区，您通常会获得所需的字节数，但是对于较大的缓冲区大小，read() 通常会返回比您要求的更少的数据——您需要检查读取的字节数并重复 read 调用剩余字节。

您的网络基础设施（路由器、防火墙等）中的某些东西也可能配置错误并截断大数据包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T07:48:38.957

您的问题是，在服务器线程中，您必须调用 outputstream.flush()，以指定应将缓冲的数据发送到通信的另一端

# php - 用php在符号前剪切字符串

> ID：780374
> 
> 赞同：12
> 
> 时间：2009-04-23T04:59:27.710
> 
> 标签：php

如何在 '(' 符号之前用 php 剪切字符串

例如：$a = "abc dec g (gold)";

我怎样才能把字符串剪成只有“abc dec g”？？

我尝试使用这个 strstr($a, '(', true) 但错误显示。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-23T05:01:35.647

你可以这样做，使用[`explode`](http://www.php.net/explode)：

```
list($what_you_want,) = explode('(', $str, 2); 
```

或者你也可以这样做，使用[`substr`](http://www.php.net/substr)and [`strpos`](http://www.php.net/strpos)：

```
$what_you_want = substr($str, 0, strpos($str, '(')); 
```

您使用错误的[`strstr`](http://www.php.net/strstr)原因是最后一个参数不可用，除非您拥有 PHP 5.3.0 或更高版本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T05:20:15.883

```
$a=substr($a, 0, strpos($a, '(')); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-29T06:10:03.523

[strstr](http://php.net/manual/en/function.strstr.php)怎么样：

`$topic = strstr('Some topic :: part to exclude', '::', TRUE);`

然后

`$topic`= 一些话题

编辑：对...仅 5.3+

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-13T19:22:44.660

使用这段代码确实是一个很好的解决方案：

```
$what_you_want = substr($str, 0, strpos($str, '(')); 
```

不过，我想指出这样一个事实，即它会在第一次出现“（”时切断你的字符串。如果你想在最后一次出现“（”时切断它，你应该使用

```
$what_you_want = substr($str, 0, strrpos($str, '(')); 
```

例如，我发现在废弃 html 内容时经常出现这种情况（因为嵌套标签）。

干杯，琼

# jquery - Jquery：如何设置隐藏元素以在另一个元素处于焦点时显示？

> ID：780375
> 
> 赞同：3
> 
> 时间：2009-04-23T05:00:59.283
> 
> 标签：jquery, css, forms, visibility

我正在尝试在表单字段旁边显示上下文帮助，这仅在这些字段处于焦点或悬停时可见。我尝试过仅使用 CSS，但结果似乎非常脆弱且不一致。

这是我的CSS：

```
form .instruct {
    position: absolute;
    right: -220px;
    top: 10px;
    visibility: hidden;
    width: 200px;
    z-index: 1000;
}
form li:focus .instruct, form li:hover .instruct {
    visibility: visible;
} 
```

在我的标记中，我使用有序列表为我的表单提供了一些结构，将每个字段与其指令分组在一个`li`元素中：

```
<form>
    <ol>
        [...]
        <li>
                <label for="message">Message</label>
                <textarea id="message" name="message"></textarea>
                <div class="instruct">
                    <p>Instructional text and <a href="#">Formating help.</a></p>
                </div>
        </li>
        [...] 
```

将鼠标悬停在字段上时会出现说明，但在字段处于焦点时不会出现 - 如果鼠标移动以选择上下文说明中的链接，它们就会消失。

每个字段都有自己的说明，当相应的字段处于焦点或悬停状态时，我需要每个字段都出现。

我认为这可能是 jquery 可以让生活更轻松的情况。有没有一种快速的方法来实现这一点？如果有一种使用原始 CSS 的*可靠*方法来做到这一点，我也会很高兴。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T05:06:24.213

为您更新了[模糊事件](http://docs.jquery.com/Events/blur)

```
 $(function()
   {
        $('.instruct').hide(); //hide 
        $('#message').focus(function(){  
            $('.instruct').show(); //show
        }).blur(function(){  
            $('.instruct').hide(); //hide again
        });

  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T05:08:53.040

使用[焦点事件](http://docs.jquery.com/Events/focus#fn)。

当元素通过定点设备或选项卡导航获得焦点时，将触发 focus 事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T06:36:47.960

我发现 jQuery toggle() 是我希望使用的解决方案。

[http://docs.jquery.com/Effects/toggle](http://docs.jquery.com/Effects/toggle)

# hibernate - 休眠 DAO 设计

> ID：780378
> 
> 赞同：1
> 
> 时间：2009-04-23T05:02:50.307
> 
> 标签：hibernate, transactions, dao

我是否必须在每个函数中打开和关闭会话和事务（制作对象、删除对象、findbyID）

你能给我一个 findall 的 DAO 实现吗（延迟初始化）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T07:26:56.780

对于每个完整的业务操作，您都应该有一个事务。I 例如：该操作包括选择一些值、更新它和插入其他值。如果每个基本操作都创建自己的事务，您将无法编写多用户应用程序。

您应该在业务操作开始时创建会话，创建事务，然后在该事务中执行所有操作（您的“功能”），并一起提交或回滚它们。

事务在业务层中定义。

# c++ - 指针和递归

> ID：780379
> 
> 赞同：0
> 
> 时间：2009-04-23T05:04:15.360
> 
> 标签：c++, pointers, recursion

我通过修改搜索功能并添加打印功能在列表中使用递归函数（带有 ADT 文件）：

```
template <class TYPE, class KTYPE> 
bool List<TYPE, KTYPE> :: _search (NODE<TYPE> **pPre,
                                   NODE<TYPE> **pLoc, 
                                   KTYPE        key)
{
   if ((*pLoc) == NULL)
        return false;
   else
        if (key == (*pLoc)->data.key)
            return true;

            _search ((*pPre)->link ,(*pLoc)->link, key);

            return false;
}

template <class TYPE, class KTYPE> bool List<TYPE, KTYPE> :: _search (NODE<TYPE> **pPre, NODE<TYPE> **pLoc, KTYPE key) { if ((*pLoc) == NULL) return false; else if (key == (*pLoc)->data.key) return true; _search ((*pPre)->link ,(*pLoc)->link, key); return false; } 
```

但我得到一个错误

```
_search ((*pPre)->link ,(*pLoc)->link, key); 
```

错误：

```
error C2664: 'List<TYPE,KTYPE>::_search' : cannot convert parameter 1 from 'NODE<TYPE> *' to 'NODE<TYPE> **' 
```

我不知道为什么？我尝试添加和删除 * 但我仍然不正确。

我初始化它：

```
NODE <TYPE>  * pPre;
    pPre = NULL;
    NODE <TYPE>  * pLoc ;
    pLoc = NULL;

NODE <TYPE> * pPre; pPre = NULL; NODE <TYPE> * pLoc ; pLoc = NULL; 
```

在调用函数之前

该函数返回 pPre 和 pLoc 在内存中的位置，因此函数签名必须使用 `**`.

我知道我必须改变称呼它的方式，但是怎么做呢？

```
template <class  TYPE> 
    struct NODE 
      {
       TYPE    data;
       NODE   *link;
      }; 

    struct Student 
      {
       string name ;   
       int level;
       int key;
      }; 

template <class  TYPE, class KTYPE> 
    class List  
       {
         private:
           NODE<TYPE> *head;
           NODE<TYPE> *pos;
           NODE<TYPE> *rear;
           int         count;
                     ....
                     .... 
                    ....
                     ....
                     ....

};

template <class TYPE> struct NODE { TYPE data; NODE *link; }; struct Student { string name ; int level; int key; }; template <class TYPE, class KTYPE> class List { private: NODE<TYPE> *head; NODE<TYPE> *pos; NODE<TYPE> *rear; int count; .... .... .... .... .... };

 ostream & operator << (ostream  & out , Student & Data)
{
    out << "The name is : " << Data.name << "\nThe Level is : " << Data.level<< "\nThe ID is :"<<Data.key;
    return out;
}

template<class TYPE, class KTYPE> 
void List <TYPE, KTYPE > :: ReversePrint ( NODE <TYPE> * node )
{
if ( node== NULL)  
        return ;

ReversePrint (node->link);

cout << node-> data;

   return ;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T05:19:43.467

```
_search ((*pPre)->link ,(*pLoc)->link, key); 
```

第一个参数*是*指针类型，`NODE`而它应该是指向指针的指针`NODE`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T05:20:11.950

```
_search ((*pPre)->link ,(*pLoc)->link, key); 
```

将上述更改为：

```
_search (&(*pPre)->link ,(*pLoc)->link, key); <== see & in first parameter 
```

它的第一个参数需要指向 NODE* 的指针

**编辑**：在编辑后检查您的代码后，看起来第一个和第二个传递给 _search 的参数都不正确。该方法需要指向 NODE 的指针。因此，传递参数的正确方法是：

```
_search (&(*pPre)->link , &(*pLoc)->link, key); 
```

# c# - 打印数据表

> ID：780385
> 
> 赞同：0
> 
> 时间：2009-04-23T05:09:35.487
> 
> 标签：c#, wpf

我有一个数据表

```
 DataTable dt = new DataTable( "Table1" );
  dt.Columns.Add( "c1" );
  dt.Columns.Add( "c2" );
  dt.Columns.Add( "c3" );
  DataRow dr = dt.NewRow();
  dr["c1"] = "100";
  dr["c2"] = "100";
  dr["c3"] = "100";
  dt.Rows.Add( dr );
  dt.AcceptChanges();
  printListView.DataContext = dt; 
```

我还有一个用于显示表格的列表视图。

```
列表显示                                    
                  Horizo​​ntalAlignment="拉伸"
                  Horizo​​ntalContentAlignment="拉伸"
                  选择模式=“单”
                  ItemsSource="{绑定}"
                  名称="打印列表视图"
                  边距=“10”
                  列表视图.视图
                        网格视图
                              GridViewColumn Header="c1" DisplayMemberBinding="{Binding c1}"/
                              GridViewColumn Header="c2" DisplayMemberBinding="{Binding c2}"/
                              GridViewColumn Header="c3" DisplayMemberBinding="{Binding c3}"/
                        /网格视图
                  /ListView.View
            /列表显示
```

如何打印此表？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T06:12:50.263

一种方法是[将表格绑定到列表视图](http://www.akadia.com/services/dotnet_listview_sort_dataset.html)，然后[用它制作一个文档并打印它](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/00bda5bf-a366-4dbe-8613-22edb7dfb449/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-10T18:57:07.053

这是一个将数据转储到磁盘上的 XML 文件的单行程序：

```
dt.WriteXml(@"c:\temp\MyDataTable.xml"); 
```

（在此示例中，您可能需要手动创建临时文件夹。）创建文件后，您可以在您喜欢的浏览器或 XML 查看器中打开它并查看或打印它。

# asp.net - 如何更新 IIS 和 ASP.NET 上的共享文件？

> ID：780387
> 
> 赞同：3
> 
> 时间：2009-04-23T05:11:12.177
> 
> 标签：asp.net, iis-6, download

我们正在替换使用基于文件的缓存来提供下载的“旧”Web 应用程序（最初的 CodeCentral 是 10 多年前编写的，现在在[http://cc.embarcadero.com上运行，提供了超过 1270 万次服务）。](http://cc.embarcadero.com)Web 应用程序管理此文件缓存。

使用基于文件的下载唯一复杂的一点是更新可能被另一个版本使用的文件。回到我编写 CodeCentral 的原始 Delphi CGI 版本时，我隐约记得即使有人可能正在下载现有文件，也可以重命名它，用正确的名称编写新文件，并最终清理旧文件。

但是，我可能会产生妄想，因为这不适用于我们当前的 IIS 6 和 ASP.NET 2.x 或 3.x 代码。所以，我们所做的是这个，这很笨拙但最终有效：

```
public static void FileCreate(Stream AStream, string AFileName, int AWaitInterval)
{
  DateTime until = DateTime.Now.AddSeconds(AWaitInterval);
  bool written = false;
  while (!written && (until > DateTime.Now))
  {
    try
    {
      using (FileStream fs = new FileStream(AFileName, FileMode.Create))
      {
        CopyStream(AStream, fs);
        written = true;
      }
    }
    catch (IOException)
    {
      Thread.Sleep(500);
    }
  }
} 
```

我想我们缺少一些简单的东西，必须有更好的方法来替换当前通过 IIS 和 ASP.NET 下载的文件。有没有？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T21:17:25.123

我认为我们将使用以下逻辑解决此问题：

我们存储文件更新的日期/时间。如果我们无法更新数据驱动文件名“[id].zip”，我们将创建“[id]_[modified].zip”，并使用它直到我们能够将其重命名为“[id].zip”通过删除旧版本的文件。

这样，在查找“[id].zip”之前首先查找“[id]_[modified].zip”，我们始终可以确保获得最新文件，并且我们可以轻松地在需求和后台即使有多个修改版本之前我们也可以最终替换“标准”“[id].zip”版本。

当然，这仅在您存储上次修改文件的时间时才有效，但是任何使用这种技术的系统都应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T10:22:56.867

约翰，您能否进一步说明情况？

如果文件足够小，您可以将整个文件加载到内存中，然后将其发送到客户端。

也许这篇[关于下载和删除临时文件的博客文章](http://absolutecobblers.blogspot.com/2008/02/downloading-and-deleting-temporary.html)会有所帮助。

# python - 将数字转换为整数列表

> ID：780390
> 
> 赞同：33
> 
> 时间：2009-04-23T05:14:20.497
> 
> 标签：python, list, integer

`magic`下面的函数怎么写？

```
>>> num = 123
>>> lst = magic(num)
>>>
>>> print lst, type(lst)
[1, 2, 3], <type 'list'> 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-04-23T05:22:12.397

你是这个意思？

```
num = 1234
lst = [int(i) for i in str(num)] 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-23T05:26:02.937

```
a = 123456
b = str(a)
c = []

for digit in b:
    c.append (int(digit))

print c 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-23T05:23:15.283

你可以这样做：

```
>>> num = 123
>>> lst = map(int, str(num))
>>> lst, type(lst)
([1, 2, 3], <type 'list'>) 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-23T06:19:11.950

```
magic = lambda num: map(int, str(num)) 
```

然后就做

```
magic(12345) 
```

或者

```
magic(someInt) #or whatever 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-05-06T15:31:04.237

```
>>> from collections import deque
>>> def magic(num):
        digits = deque()
        while True:
            num,r = divmod(num,10)
            digits.appendleft(r)
            if num == 0:
                break
        return list(digits)

>>> magic(123)
[1, 2, 3] 
```

根据我的时间安排，此解决方案比字符串方法 ( `magic2`) 快得多，即使对于较小的示例也是如此。

```
>>> def magic2(num):
        return [int(i) for i in str(num)] 
```

**时间：**

`magic`

```
>>> timeit.timeit(setup='from __main__ import magic', stmt='magic(123)')
1.3874572762508706
>>> timeit.timeit(setup='from __main__ import magic', stmt='magic(999999999)')
3.2624468999981673 
```

`magic2`

```
>>> timeit.timeit(setup='from __main__ import magic2', stmt='magic2(123)')
3.693756106896217    
>>> timeit.timeit(setup='from __main__ import magic2', stmt='magic2(999999999)')
10.485281719412114 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-23T05:48:21.417

不要使用单词*列表*作为变量名！它是python内置数据类型的名称。

另外，请澄清您的问题。如果您正在寻找一种方法来创建一个成员列表，请执行以下操作：

```
a = 123
my_list = [a] 
```

和“pythonizing” Cannonade 的回答：

```
a = 123
my_list = [int(d) for d in str(a)] 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-01-26T03:24:05.747

```
num = map(int, list(str(num))) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-03-11T12:19:18.713

如果它被命名为魔法，为什么不直接使用魔法：

```
def magic(x):
    if x < 10:
        return [x]
    else:
        return magic(x//10) + [x%10] 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-12-11T05:57:50.727

对于 python 3.x：

```
num = 1234
lst = list(map(int, str(num))) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-21T21:56:35.540

你可以试试这个：

```
def convert_to_list(number):
    return list(map(lambda x: int(x), str(number)))

convert_to_list(1245) 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-05-06T14:16:33.120

只需使用：

```
a= str (num)
lst = list(a) 
```

# c - Ruby 无法加载 DLL

> ID：780391
> 
> 赞同：1
> 
> 时间：2009-04-23T05:14:58.593
> 
> 标签：c, ruby

我在 Windows 上使用 Ruby 1.8.6。我正在用 C 扩展 Ruby，即我想将 DLL 加载到 Ruby 中。但是 Ruby 无法加载我的 Dll。我使用 Visual Studio.net 命令提示符并将我的 DLL（即 prov.dll）集成到 C 程序 pro1.c 中。之后，我通过 Ruby 调用这些 C 函数。

```
D:\ruby_extend\pronmake>irb
irb(main):001:0> require 'pro1'
=> true
irb(main):002:0> include Pro
=> Object
irb(main):003:0> Pro::load
=> false
irb(main):004:0> 
```

我只得到一个错误：

```
DLL fails to load through ruby... 
```

我怎样才能得到堆栈跟踪？任何建议都会帮助我。

下面是我的 pro1.c 代码：

```
#include "windows.h"
#include "ruby.h"
#include "pro.h"
#define _D(string) {OutputDebugString(string);}
VALUE Pro;
HINSTANCE hlibrary;

void _textline(const char *s, int len)
//************************************
{
    _D(s);
}

static VALUE p_load(VALUE self )
//******************************
{
       return pro_load();
}

static VALUE p_init(VALUE self)
//*****************************
{
    _D("-> init");
         pro_set_textline_callback(_textline);
    pro_renderInit();
}

static VALUE p_parse(VALUE self, VALUE string_to_parse)
//*****************************************************
{
    _D(StringValuePtr(string_to_parse));
    return pro_parse(StringValuePtr(string_to_parse));
}

void proeventcallback(proRenderEventType type, proRenderEventData data)
//************************************************************************
{
    switch(type){
        case proRenderEventDone:
            _D("-> cleanup");
            pro_renderCleanUp();
            //if (vWindow)
            //{
            //  SendMessage((HWND)NUM2INT(vWindow), WM_USER+2, 0, 0);
            //}
    }
}

static VALUE pro_render( VALUE self )
//**********************************
{
    _D("-> render");
    pro_set_renderevent_callback(proeventcallback);
    SetThreadPriority(GetCurrentThread(),THREAD_PRIORITY_ABOVE_NORMAL);
    pro_render(PRO_RENDERASYNC);
    return Qtrue;
}

void Init_pro1()
//***************
{
    pro = rb_define_module( "Pro" );
    rb_define_method(Pro, "load", p_load, 0);
    rb_define_method( Pro, "init_engine", p_init, 0 );
    rb_define_method(Pro, "parse", p_parse, 1);
    rb_define_method(Pro, "render", pr_render, 0);   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T11:46:02.647

我会看一下 的定义`pro_load()`，因为这似乎是决定`Pro::load`ruby​​ 代码中返回值的因素。

# ajax - 如何使用 Prototype 创建新的 AJAX 对象

> ID：780393
> 
> 赞同：0
> 
> 时间：2009-04-23T05:15:36.347
> 
> 标签：ajax, prototypejs

如何使用 Prototype 库每次为特定的 ajax 请求创建一个新的 Ajax 对象？在 Prototype 中，“Ajax”似乎是一个全局对象，所有请求都是它的实例。请帮忙..

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T13:18:10.827

实际上，Prototype 会为每个请求创建一个新的“实例”。你这样做：

```
var request = new Ajax.Request('/your/url', {
  onSuccess: function(transport) {
      // yada yada yada
  }
}); 
```

通常您会跳过“var request =”部分，除非您需要访问实例的公共属性。一种可能的原因是访问包含“原始” XMLHttpRequest 对象的“传输”属性。

# iphone - UITableViewCell 右侧有图像？

> ID：780395
> 
> 赞同：54
> 
> 时间：2009-04-23T05:16:22.320
> 
> 标签：iphone, objective-c, uitableview, uiimageview, uiimage

有没有办法将 UITableViewCell.image 设置为显示在单元格的右侧而不是左侧？或者我需要在单元格布局的右侧添加一个单独的 UIImageView 吗？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-04-23T17:12:27.983

不可以。但是您可以轻松地将图像视图作为附件视图添加到表格单元格以获得相同的效果。

```
UIImageView *imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"foo.png"]];
cell.accessoryView = imageView;
[imageView release]; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-07-24T17:44:59.963

对于简单的情况，您可以这样做：

```
cell.contentView.transform = CGAffineTransformMakeScale(-1,1);
cell.imageView.transform = CGAffineTransformMakeScale(-1,1);
cell.textLabel.transform = CGAffineTransformMakeScale(-1,1);
cell.textLabel.textAlignment = NSTextAlignmentRight; // optional 
```

这将翻转（镜像）将任何 imageView 放在右侧的内容视图。请注意，您必须翻转 imageView 和任何文本标签，否则它们本身将被镜像！此解决方案保留右侧的附件视图。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-04-25T23:53:12.160

这是**Swift**中使用 using 方法的示例`accessoryView`：

```
private let reuseIdentifier: String = "your-cell-reuse-id"

// MARK: UITableViewDataSource

func tableView(tableView:UITableView, cellForRowAtIndexPath indexPath: NSIndexPath) -> UITableViewCell {
  var cell : UITableViewCell? = tableView.dequeueReusableCellWithIdentifier(reuseIdentifier) as? UITableViewCell
  if (cell == nil) {
    cell = UITableViewCell(style:UITableViewCellStyle.Subtitle, reuseIdentifier:reuseIdentifier)
  }

  cell!.textLabel!.text = "Hello"
  cell!.detailTextLabel!.text = "World"
  cell!.accessoryView = UIImageView(image:UIImage(named:"YourImageName")!)
  return cell!
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-07-30T05:39:28.847

如果您不想制作自定义单元格并使用标准单元格，则至少有两种方法：

1.  使用附件视图。

```
cell.accessoryView = UIImageView(image: UIImage(named: "imageName"))
cell.accessoryView.frame = CGRectMake(0, 0, 22, 22) 
```

2.  如果你想拥有正确的图像+附件视图，那么你可以将 UIImageView 出口添加到 ContentView（示例名称：rightImage）并将 textLabel 的背景颜色更改为清除。

```
cell.rightImage.image = UIImage(named: "imageName")
cell.textLabel.backgroundColor = UIColor.clearColor() 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-02-13T14:39:18.983

在**swift3**和**swift4**中，我们可以使用这个：

```
cell.accessoryView = UIImageView(image:UIImage(named:"imageNmae")!) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-17T14:01:00.223

子类 UITableViewCell 并覆盖*layoutSubviews*然后只调整 self.textLabel、self.detailTextLabel 和 self.imageView 视图的框架。

这是它在代码中的样子：

`MYTableViewCell.h`：

```
#import <UIKit/UIKit.h>

@interface MYTableViewCell : UITableViewCell
@end 
```

`MYTableViewCell.m`：

```
#import "MYTableViewCell.h"

@implementation MYTableViewCell

- (void)layoutSubviews
{
    [super layoutSubviews];
    if (self.imageView.image) {
        self.imageView.frame = CGRectMake(CGRectGetWidth(self.contentView.bounds) - 32 - 8,
                                          CGRectGetMidY(self.contentView.bounds) - 16.0f,
                                          32,
                                          32);
        CGRect frame = self.textLabel.frame;
        frame.origin.x = 8;
        self.textLabel.frame = frame;
        frame = self.detailTextLabel.frame;
        frame.origin.x = 8;
        self.detailTextLabel.frame = frame;
    }
}

@end 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-01T19:05:43.177

这个 Soln 用于在每个单元格中添加不同的图像....只是一个尝试

```
// Customize the appearance of table view cells.
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
}

if(indexPath.row == 0) {
    cell.image = [UIImage imageNamed:@"image.png"];
}

else if (indexPath.row == 1) {
    cell.image = [UIImage imageNamed:@"image1.png"];
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-12T09:45:21.407

要在单元格中添加图像@右侧，我建议您在右侧创建一个带有 imageview 的自定义单元格，这对您非常有用。并添加一个空视图以将此笔尖与 customcell 类链接。

现在在您的单元格的 nib 文件中删除视图，添加 tableViewcell 并在该单元格中将 imageView 拖放到右侧。

现在去 TableViewCell 的类说 DemoCell ，创建一个插座并使用 tablecell 笔尖中的 imageview 设置它

现在，在 tableview 的 cellforrowatindexpath 方法中引用您的单元格并将其与笔尖名称一起使用，如下所示

```
static NSString *CellIdentifier = @"Cell";
DemoCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[SettingCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    cell = [[[NSBundle mainBundle]loadNibNamed:@"DemoCell" owner:self options:nil] lastObject];
} 
```

并根据您的要求设置图像

细胞.imageVw.img ....

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-22T19:31:55.780

您可以通过调用 imageview 的 setFrame 方法来调整附件视图中的图像大小，如下所示： [imageView setFrame:CGRectMake(0, 0, 35.0, 35.0)];

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-07-14T07:49:38.273

无需创建自己的图像，只需编辑`cell.tintColor`.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-01-18T23:17:34.817

有一种以`position`编程方式设置的方法。这是`Swift`解决方案的版本：

```
image.frame = CGRect.init(
x: self.view.frame.width - image.frame.width*1.1,
y: image.frame.origin.y,
width: image.frame.width,
height: image.frame.height) 
```

这会将您的图像定位在单元格的右侧。该解决方案是根据屏幕尺寸自动调整位置。唯一的缺点是当您旋转设备时需要重新加载数据，但您可以`override`在您的`UITableView`类中使用`didRotate`监听器方法：

```
override func didRotate(from fromInterfaceOrientation: UIInterfaceOrientation) {
    _tableView.reloadData()} 
```

# javascript - 在分配 Array.prototype.indexOf 后，是什么导致 for...in 出现此错误？

> ID：780422
> 
> 赞同：2
> 
> 时间：2009-04-23T05:39:06.837
> 
> 标签：javascript, internet-explorer

当我能够用最少的代码重现错误时，我感到很惊讶。请注意，在这个极简示例中，没有调用 Array.indexOf。另请注意，我尝试了几种不同的 indexOf 实现，包括来自 stackoverflow.com 的几种。

错误是，当 for...in 在 IE 中执行时，会显示三个警报：“indexOf”、“0”和“1”。正如人们所预料的那样，在 FF 中，只出现了两个（“0”、“1”）。

```
<html>
<body onLoad="test();">
<script language="javascript">
   var testArray = ['Foo', 'Bar'];

   if(!Array.prototype.indexOf) {
      Array.prototype.indexOf = function (obj, fromIndex) {
         if (fromIndex == null) {
            fromIndex = 0;
         } else if (fromIndex < 0) {
            fromIndex = Math.max(0, this.length + fromIndex);
         }
         for (var i = fromIndex, j = this.length; i < j; i++) {
            if (this[i] === obj)
               return i;
         }
         return -1;
      };
   }

   function test() {
      var i;

      for(i in testArray) {
         alert(i);
      }
   }
</script>
</body>
</html> 
```

谁能解释一下？我已经将我的代码更改为使用 a`while`所以我不是在枪下，但是这个真的让我很难过。它让我想起了 c 中的内存溢出错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T05:51:49.503

请参阅Yahoo! 上的“ [for in Intrigue ”。](http://yuiblog.com/blog/2006/09/26/for-in-intrigue/)用户界面博客。

您的代码在 Firefox 中按预期工作的原因是您没有`indexOf`在 Firefox 中添加自己的方法。`for in`循环遍历对象原型链中的所有键，包括您添加的方法`indexOf`。Douglas Crockford 提出以下解决方案：

```
for (var p in testArray) {
    if (testArray.hasOwnProperty(p)) {
        alert(testArray[i]);
    }
} 
```

或者，您可以过滤掉函数：

```
for (var p in testArray) {
    if (typeof testArray[p] !== "function") {
        alert(testArray[i]);
    }
} 
```

此外，正如“nickf”指出的那样，最好不要使用`for in`循环来迭代数组。该`for in`循环旨在迭代对象中的键。

史蒂夫

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T05:55:36.000

`for .. in`用于循环对象属性，绝对不是数组。

坚持标准：

```
for (var i = 0, l = myArray.length; i < l; ++i) { .. } 
```

[Mozilla 开发者中心](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Statements/for...in)的更多信息：

> `for...in`循环不会遍历内置属性。其中包括对象的所有内置方法，例如 String 的 indexOf 方法或 Object 的 toString 方法。但是，循环将遍历所有用户定义的属性（包括任何覆盖内置属性的属性）。
> 
> 尽管将其用作迭代数组的方法可能很诱人，但这是一个坏主意。除了数组元素之外，for...in 语句还遍历用户定义的属性，因此如果您修改数组的非整数或非正数属性（例如，向其添加“foo”属性，甚至添加方法或属性到 Array.prototype），for...in 语句将返回除数字索引之外的用户定义属性的名称。

# git - 如何使用 msysgit / gitk 设置 DiffMerge？

> ID：780425
> 
> 赞同：21
> 
> 时间：2009-04-23T05:40:36.130
> 
> 标签：git, windows-xp, msysgit, diffmerge

我刚刚开始使用 Git，可能我错过了一些明显的东西，但这里是：

*   我在 Windows XP 上使用 msysgit 1.6.2.2
*   安装时，我选择了“仅使用 Git Bash”选项 1

我正在尝试组合一个包装脚本，我可以用它来用 DiffMerge 替换内置的 git diff。基于SO上的[这个线程](https://stackoverflow.com/questions/255202/how-do-i-view-git-diff-output-with-visual-diff-program)，我创建了以下批处理文件：

```
@echo off
REM ---- Switch forward slashes to back slashes ----
set oldW=%2
set oldW=%oldW:/=\%
set newW=%5
set newW=%newW:/=\%

REM ---- Launch DiffMerge ----
"C:/Programs/SourceGear/DiffMerge/DiffMerge.exe" /title1="Old Version" %oldW% /title2="New Version" %newW% 
```

我将 bat 文件放在 %GIT_INSTALL%/cmd 下并编辑了我的 .gitconfig 文件，如下所示：

```
[diff]
external = C:/Programs/git/cmd/git-diff-wrapper.bat 
```

如果我启动 Git Bash 并执行 git diff HEAD HEAD~ -- myfile

我收到一条消息`File (\dev\null) not found`- 鉴于我在 Windows 上，这并不奇怪。

按下，我启动了 gitk，在 Edit>Preferences 下，我选择了相同的包装脚本。为特定文件尝试“外部差异”选项会给出神秘的错误消息`Unknown Option "`

显然，我不知道我在做什么了，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-05-27T21:30:05.867

我在整个互联网上寻找答案。我尝试了上面和其他地方的所有解决方案。我可以让合并部分工作，而不是 diff 部分，反之亦然。所以我最终所做的就是从我在互联网上获得的所有对我有用的信息中拼凑出我自己的**简单解决方案。**它不需要任何脚本，只需您编辑`.gitconfig`通常位于以下目录中的脚本`C:\Documents and Settings\[username]`您需要已经安装 DiffMerge 程序。

这是我的`.gitconfig`文件的相关摘录。您只需要编辑您的版本所在的路径`DiffMerge`。**请注意**，我在路径中使用了旧的 DOS 8.3 格式

```
[diff]
    tool = diffm
[difftool "diffm"]
    cmd = "H:/PROGRA~1/SourceGear/DiffMerge/DiffMerge.exe $LOCAL $REMOTE"
    prompt = false

[merge]
    tool = diffmerge
[mergetool "diffmerge"]
    cmd = "H:/PROGRA~1/SourceGear/DiffMerge/DiffMerge.exe --merge --result=$MERGED $LOCAL $BASE $REMOTE" 
    trustExitCode = false
    keepBackup = false 
```

`git config --replace --global [options]`如果您愿意， 也可以使用命令进行设置。

* * *

这个简单的解决方案也非常适合我。对于较新版本的 DiffMerge (3.3.1)，需要更改命令路径：

```
 cmd = "C:/PROGRA~1/SourceGear/Common/DiffMerge/sgdm.exe ...etc..." 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-23T21:49:57.240

[我刚刚使用 msysgit1.6.2.2 将 Notepad++ 设置为我的外部编辑器时](https://stackoverflow.com/questions/10564/how-can-i-set-up-an-editor-to-work-with-git-on-windows/773973#773973)遇到了类似的经历。

关键是要意识到包装器不是 DOS 脚本，而是 /bin/sh 脚本。

所以试着输入你的“.bat”（即使它不完全是一个 bat 脚本，扩展在这里并不重要）：

```
#!/bin/sh

# diff is called by git with 7 parameters:
# path old-file old-hex old-mode new-file new-hex new-mode

"C:/Programs/SourceGear/DiffMerge/DiffMerge.exe" /title1="Old Version" "$2" /title2="New Version" "$5" | cat 
```

不要担心让所有的 ' `\`' go ' `/`'：这是由 Git 脚本调用外部 diff 工具完成的。

我没有使用 DiffMerge 对其进行测试，但使用 WinMerge，无论是从 DOS 会话还是 Git Shell 都可以正常工作。

```
#!/bin/sh
"C:/Program Files/WinMerge/WinMergeU.exe" -e -ub "$2" "$5" | cat 
```

（使用 ' `-e`' 选项，我只需键入 ' `ESC`' 即可关闭并退出 diff 工具：效果很好！）

* * *

![替代文字](https://www.gravatar.com/avatar/ac7ca3dfdfb0fcfb298d11e30fec53db?s=32&d=identicon&r=PG)[average_geek](https://stackoverflow.com/users/94756/averagegeek)在评论中添加：

> 添加了 ' `/bin/sh`' 标头并尝试再次运行 git diff。
> 这次的错误是：
> `Unexpected parameter 'C:/Docume~/avggeek/LOCALS~1/Temp/.diff_b08444`
> 有没有办法查看我调用时传递的参数是什么`git diff`？

1/ 实际上有一种方法可以查看传递的参数是什么！
在文件中添加以下行`C:\Program Files\Git\libexec\git-core\git-sh-setup`：

```
git_editor() {
    : "${GIT_EDITOR:=$(git config core.editor)}"
    : "${GIT_EDITOR:=${VISUAL:-${EDITOR}}}"
    case "$GIT_EDITOR,$TERM" in
    ,dumb)
        echo >&2 "No editor specified in GIT_EDITOR, core.editor, VISUAL,"
        echo >&2 "or EDITOR. Tried to fall back to vi but terminal is dumb."
        echo >&2 "Please set one of these variables to an appropriate"
        echo >&2 "editor or run $0 with options that will not cause an"
        echo >&2 "editor to be invoked (e.g., -m or -F for git-commit)."
        exit 1
        ;;
    esac
#### ADD THIS LINE BELOW
    echo >&2 "editor is ${GIT_EDITOR:=vi} $@."
#### END ADDITION ABOVE
    eval "${GIT_EDITOR:=vi}" '"$@"'
} 
```

您将看到使用什么参数调用了哪个编辑器。

现在，关于“意外参数”部分：当我用“ ”而不是“ ”
调用 WinMergeU.exe 时，我确实遇到了同样的错误，所以第一个问题是： 你确定“ ”位不能用作" " 或 " " 或 " " 或 " " ? 这就是 Is 可以从[DiffMerge 的 pdf 文档的第 9 章“命令行参数”中看到的内容](http://download-us.sourcegear.com/DiffMerge/3.3.0/Linux/Ubuntu/DiffMergeManual.pdf)。 如果不是，我怀疑一些双引号是为了正确分隔不同的参数。就像是：`/e /ub``-e -ub`
`/title1``-title1``-t1``--title1``--t1`

```
"/title1="Old Version"" "$2" "/title2="New Version"" "$5"
or
"/title1=\"Old Version\"" "$2" "/title2=\"New Version\"" "$5" 
```

但我的钱宁愿放在“ `-title1`”或“ `-t1`”表格上：

```
-t1="Old Version" "$2" -t2="New Version" "$5" 
```

应该可以正常工作。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-10-28T19:08:48.263

这对我有用，如下所示：

在`~/.gitconfig`：

```
[merge]
tool = diffmerge
[mergetool "diffmerge"]
cmd = \"C:/Program Files/git/cmd/git-diffmerge-merge.sh\" \"$BASE\" \"$LOCAL\" \"$REMOTE\" \"$MERGED\"
trustExitCode = false 
```

在`C:\Program Files\Git\cmd\git-diffmerge-merge.sh`：

```
#!/bin/sh

localPath="$2"
basePath="$1"
remotePath="$3"
resultPath="$4"

if [ ! -f $basePath ]
then
    basePath="~/diffmerge-empty"
fi

"C:/Program Files/SourceGear/DiffMerge/DiffMerge.exe" --merge --result="$resultPath" "$localPath" "$basePath" "$remotePath" --title1="Mine" --title2="Merged: $4" --title3="Theirs" 
```

部分功劳归于[http://therightstuff.de/2009/01/28/Setting-Up-SourceGear-DiffMerge-With-Git.aspx](http://therightstuff.de/2009/01/28/Setting-Up-SourceGear-DiffMerge-With-Git.aspx) ;)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-24T05:39:57.640

VonC - 切换到 -t1 和 -t2 修复了错误。Diffmerge 现在适用于 git bash :)

在稍微戳了一下添加外部差异支持[的 gitk 补丁](http://kerneltrap.org/mailarchive/git/2008/3/24/1240654)后，我意识到它直接以两个文件作为参数调用了一个外部差异程序。所以我修改了 gitk>Edit>Preferences 并将以下命令直接放入 External Diff Tool 选项中：

```
"C:/Programs/SourceGear/DiffMerge/DiffMerge.exe" -t1="Old Version" -t2="New Version" 
```

现在我也让 DiffMerge 为 gitk 工作:-)

# wpf - wpf中的链接按钮

> ID：780426
> 
> 赞同：92
> 
> 时间：2009-04-23T05:41:31.337
> 
> 标签：wpf, wpf-controls

如何让 Button 看起来像 LinkBut​​ton，而且我不想使用超链接...！！

有什么建议么

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-04-23T08:13:20.007

如果您不想要任何普通的 Button 样式，而只想要看起来像超链接的东西，您可以从这个开始

```
<Button Margin="5" Content="Test" Cursor="Hand">
    <Button.Template>
        <ControlTemplate TargetType="Button">
            <TextBlock TextDecorations="Underline">
                <ContentPresenter />
            </TextBlock>
        </ControlTemplate>
    </Button.Template>
    <Button.Style>
        <Style TargetType="Button">
            <Setter Property="Foreground" Value="Blue" />
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="true">
                    <Setter Property="Foreground" Value="Red" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </Button.Style>
</Button> 
```

这与样式相同：

```
<Style
    x:Key="LinkButton"
    TargetType="Button">
    <Setter
        Property="Template">
        <Setter.Value>
            <ControlTemplate
                TargetType="Button">
                <TextBlock
                    TextDecorations="Underline">
                <ContentPresenter /></TextBlock>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
    <Setter
        Property="Foreground"
        Value="Blue" />
    <Style.Triggers>
        <Trigger
            Property="IsMouseOver"
            Value="true">
            <Setter
                Property="Foreground"
                Value="Red" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

你可以像这样使用它：

```
<Button Style="{StaticResource LinkButton}" Content="Clicky" /> 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2010-08-25T10:02:07.370

```
<Style x:Key="LinkButton" 
       TargetType="Button"
       BasedOn="{StaticResource ResourceKey={x:Type Button}}"
       >

    <Setter Property="Width" Value="Auto"/>

    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <ContentPresenter Content="{TemplateBinding Content}" 
                                  ContentTemplate="{TemplateBinding  ContentTemplate}"
                                  VerticalAlignment="Center"
                                  >
                    <ContentPresenter.Resources>
                        <Style TargetType="{x:Type TextBlock}">
                            <Setter Property="TextDecorations" Value="Underline" />
                        </Style>
                    </ContentPresenter.Resources>
                </ContentPresenter>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
    <Setter Property="Foreground" Value="Blue" />
    <Setter Property="Cursor" Value="Hand" />
    <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="true">
            <Setter Property="Foreground" Value="Red" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

MichaC 和 Anderson 的版本将下划线放置稍有错误，这是一个更新版本，它只会`TextBlock`在`ContentPresenter`.

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2010-05-27T03:45:38.523

这是 MichaC 的建议`Style`，您可以在任何按钮上重复使用：

```
<Style x:Key="LinkButton" TargetType="Button">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <TextBlock TextDecorations="Underline">
                    <ContentPresenter />
                </TextBlock>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
    <Setter Property="Foreground" Value="Blue" />
    <Setter Property="Cursor" Value="Hand" />
    <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="true">
            <Setter Property="Foreground" Value="Red" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-01-05T09:06:28.860

最简单的方法（我在我的应用程序中这样做）：

```
<TextBlock Name="..."
   Text="..."
   Cursor="Hand"
   Foreground="Blue"
   TextDecorations="Underline"
   MouseLeftButtonUp=..."
/> 
```

您可以完全控制 TextDecoration，例如更改笔样式或偏移量。查看此链接以了解更多信息：http: [//msdn.microsoft.com/en-us/library/system.windows.textdecorations.underline.aspx](http://msdn.microsoft.com/en-us/library/system.windows.textdecorations.underline.aspx)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-06-02T15:20:35.950

另一种使用的解决方案`Hyperlink`是放在里面`TextBlock`。

```
<TextBlock>
    <Hyperlink Click="...">
        <TextBlock Text="Link text" />
    </Hyperlink>
</TextBlock> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-23T05:43:36.527

为什么不想使用超链接？

```
<Button>
    <Hyperlink>
</Button> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-21T20:39:58.477

所有提议的解决方案的组合：
完整的样式，与接受的版本一样，但没有硬编码值。

```
<Style
    x:Key="HyperlinkButton"
    TargetType="{x:Type Button}"
    BasedOn="{StaticResource {x:Type Button}}"
    >
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
                <TextBlock>
                    <Hyperlink
                        Command="{TemplateBinding Command}"
                        CommandTarget="{TemplateBinding CommandTarget}"
                        CommandParameter="{TemplateBinding CommandParameter}"
                        >
                        <ContentPresenter />
                    </Hyperlink>
                </TextBlock>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# visual-studio-2008 - 用于 Sharepoint 的 Visual Studio 2008“添加服务参考”：401 和端口号

> ID：780427
> 
> 赞同：-1
> 
> 时间：2009-04-23T05:41:43.927
> 
> 标签：visual-studio-2008, wcf, sharepoint

我正在尝试向 SharePoint Web 服务“添加服务引用”（例如，“ [http://cogent-moss/_vti_bin/Webs.asmx](http://cogent-moss/_vti_bin/Webs.asmx) ”），但遇到了麻烦。我似乎总是得到这个错误：

> 网址为 [http://cogent-moss/_vti_bin/Webs.asmx](http://cogent-moss/_vti_bin/Webs.asmx)的 文档未被识别为已知文档类型。来自每种已知类型的错误消息可能会帮助您解决问题： - 来自“ [http://cogent-moss/_vti_bin/Webs.asmx](http://cogent-moss/_vti_bin/Webs.asmx) ”的报告是“无法识别文档格式（内容类型是'text/html;字符集=utf-8'）。'。- 来自“DISCO 文档”的报告是“缺少根元素。”。- 来自“WSDL 文档”的报告是“无法识别文档格式（内容类型为 'text/html; charset=utf-8'）。”。- 来自“XML Schema”的报告是“无法识别文档格式（内容类型为 'text/html; charset=utf-8'）。”。元数据包含无法解析的引用：'。HTTP 请求未经客户端身份验证方案“匿名”授权。从服务器收到的身份验证标头是“协商，NTLM”。远程服务器返回错误：(401) Unauthorized。如果在当前解决方案中定义了服务，请尝试构建解决方案并再次添加服务引用。

我已经在网上搜索了这个问题的解决方案，其中大多数都是运行时问题的解决方案。我只想让 Visual Studio 2008 为我生成代理类。

对我来说奇怪的是，如果我尝试同样的事情，除了指向“ [http://cogent-moss:8888/_vti_bin/Webs.asmx](http://cogent-moss:8888/_vti_bin/Webs.asmx) ”，一切正常。这两个 IIS 虚拟服务器都是由 SharePoint 配置的 Sharepoint 网站集，并且都针对 Windows 身份验证进行了配置。当我指定端口号时会发生什么，但当我转到端口 80 的默认值时，它不会工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T09:07:39.010

我遇到了完全相同的问题，我认为您应该尝试将 VS 中的服务引用添加为“ [http://cogent-moss:8888/_vti_bin/Webs.asmx?WSDL](http://cogent-moss:8888/_vti_bin/Webs.asmx?WSDL) ”而不是“ [http://cogent-moss:8888 /_vti_bin/Webs.asmx](http://cogent-moss:8888/_vti_bin/Webs.asmx) "

希望有帮助，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T19:06:13.200

如果这不是身份验证类型的问题，正如 Kirk 建议的那样，您的备用访问映射是否为端口 8888 和端口 80 设置？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T12:55:58.330

听起来您在 SharePoint 中有一个扩展的 Web 应用程序，其中端口 80 扩展到端口 8888，端口 80 允许匿名，但端口 8888 需要 Windows 身份验证。您是否检查过 IIS 管理器以查看是否是这种情况？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-08T13:24:10.370

我有同样的问题。我去了sharepoint站点管理，应用程序管理。在应用程序安全区域中，选择身份验证提供程序。在新页面上，选择默认，并在新页面上选择启用匿名。不确定这是否有效，因为我遇到了其他问题，但它似乎确实消除了身份验证问题。我已经在 IIS VD 上设置了匿名，但遇到了同样的错误，所以我查看了 sharepoint 管理页面。

希望这可以帮助尼克

# c++ - 目标文件生成和使用 makefile 进行链接的最佳实践 - C++

> ID：780429
> 
> 赞同：1
> 
> 时间：2009-04-23T05:42:53.050
> 
> 标签：c++, makefile

**背景**

我刚刚开始在 LINUX 上进行 C++ 编程。在我的最后一个问题中，我询问了在大型应用程序中使用 makefile 的最佳实践。“SO”用户建议阅读 Miller 关于递归 makefile 的论文并避免 makefile 递归（我使用的是递归 makefile）。

我关注了miller并创建了一个如下所示的makefile。以下是项目结构

```
root
...makefile
...main.cpp
...foo
......foo.cpp
......foo.h
......module.mk 
```

我的 makefile 如下所示

```
#Main makefile which does the build

CFLAGS =
CC = g++
PROG = fooexe

#each module will append the source files to here
SRC :=

#including the description
include foo/module.mk

OBJ := $(patsubst %.cpp, %.o, $(filter %.cpp,$(SRC))) main.o

#linking the program
fooexe: $(OBJ)
    $(CC) -o $(PROG) $(OBJ)

%.o:
    $(CC) -c $(SRC)

main.o:
    $(CC) -c main.cpp

depend:
    makedepend -- $(CFLAGS) -- $(SRC)

.PHONY:clean
clean:
    rm -f *.o 
```

这是foo*目录*中的*module.mk 。*

 *```
SRC += foo/foo.cpp 
```

当我运行*make -n*时，我得到以下输出。

```
g++ -c  foo/foo.cpp
g++ -c main.cpp
g++ -o fooexe  foo/foo.o main.o 
```

**问题**

*   我应该在哪里创建对象（.o）文件？单个目录中的所有目标文件还是它自己的模块目录中的每个目标文件？我的意思是哪个是生成 foo.o 的最佳位置？它是在 foo 目录还是根目录（我的示例在根目录中生成）？
*   在提供的示例中，*g++ -c foo/foo.cpp*命令在根目录中生成 .o 文件。但是在链接时（*g++ -o fooexe foo/foo.o main.o*）它正在寻找*foo/foo.o*。我该如何纠正？

任何帮助都会很棒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T05:56:24.750

> *   我应该在哪里创建对象（.o）文件？单个目录中的所有目标文件还是它自己的模块目录中的每个目标文件？我的意思是哪个是生成 foo.o 的最佳位置？它是在 foo 目录还是根目录（我的示例在根目录中生成）？

我发现调查失败的构建以在模块级目录下的单独目录中本地化目标文件更容易。

```
foo
    |_ build
    |_ src 
```

根据项目的大小，这些目标文件被分组以形成更高级别的组件，依此类推。所有组件都进入主构建目录，主应用程序可以从该目录运行（具有所有依赖库等）。

> *   在提供的示例中， g++ -c foo/foo.cpp 命令在根目录中生成 .o 文件。但是当链接时（g++ -o fooexe foo/foo.o main.o）它正在寻找 foo/foo.o。我该如何纠正？

利用：

```
 g++ -o fooexe  foo.o main.o 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T15:45:48.987

+1 为 SCons。
我也在使用[SCons](http://www.scons.org/)。它会为您扫描依赖关系，并且仅在源发生更改时重新构建，因为它使用加密哈希和而不是时间戳。

在我的 SCons 构建中，对象位于源的并行目录中（以启用多个构建，例如 32 位和 64 位的组合、发布和调试）：

```
src
.build
  linux
    i686
      debug
      release
    x86_64
      debug
      release 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T01:18:56.690

关于对象和其他生成的临时文件，我将它们放在与源文件完全分开的目录中（即，在备份和修订控制之外的目录下）。在项目或 makefile 中进行设置可能会稍微麻烦一些，但它可以节省打包源代码的时间，并且更容易进行干净的备份和修订控制。

我为与源的子目录结构匹配的目标文件创建了一个子目录结构。通常，我的每个库和程序都有一个单独的子目录。

此外，我还使用多个编译器（和版本）和多个操作系统，因此我将在每个编译器（具有较新版本的标准和供应商库）的目录下重现目标文件目录结构，以防止目标文件不匹配包括头文件版本。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-23T05:52:54.757

你能为自己做的最好的事情就是使用比 Make 更好的东西。SCons 是我在 POSIX 系统上选择的工具。Boost 还有一个非常灵活的构建工具，但我很难理解它。

哦，如果您想使用 make，请继续构建递归 makefile。这真的没什么大不了的。在过去的三年中，我使用了大量的递归 makefile 参与了一个巨大的项目，并且效果很好。

# jquery - 为什么我的 jQuery 在 Internet Explorer 6 中不起作用？

> ID：780432
> 
> 赞同：-1
> 
> 时间：2009-04-23T05:46:53.680
> 
> 标签：jquery, internet-explorer-6

我正在设计一个网页，我正在使用 jQuery。

该网页使用 Ajax。Internet Explorer 6 及更低版本无法正确显示页面。甚至 Ajax 代码似乎也不起作用。

### 代码：

```
jQuery(document).ready(function($) {
    // Hide all sub heading lists
    $("#content1").load("sub/image1.html");
    $("li[@id^='cont']").click(function(){
         var current_id=$(this).attr('id');
         switch(current_id){
             case 'content_1':$("#content1").load("sub/my.html");break;
             default:;
         }
    });
}); 
```

该代码在 Internet Explorer 7、Internet Explorer 8、Chrome 和 Firefox 中完美运行。在 Internet Explorer 6 或更低版本中它不起作用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T06:47:25.983

我真的不确定为什么它不起作用，但您可以尝试将 jQuery 升级到 1.3 版。

如果您已经升级到 1.3，那么您的脚本将会失败，因为`@`之前的属性名称在 jQuery 1.2 中已被弃用。拿出来看看情况如何。

```
$("li[id^='cont']").click(function() { ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T06:42:26.200

只是一些想法：

*   而不是`jQuery(document).ready()`，尝试使用 `$(document).ready()`.

*   该行：`$("li[@id^='cont']")`可能是导致 IE 6 中出现问题的原因。您似乎只是在尝试选择`<li>`id 以 . 开头的所有项目`cont`。相反，您可以尝试给所有`<li>s`一个类，例如`contLi`，然后是代码：

    `$(".contLi")` 会选择`<li>s`和以前一样，它也可以在 IE 6 中工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T09:10:58.777

这可能与`default:;`. 我过去曾发现，Internet Explorer 6 有时不喜欢你在应该有东西的时候留下一些空的东西，即使它在技术上不是不正确的。

所以试试`default: break;`。

# asp.net - ASP MVC 授权除少数之外的所有操作

> ID：780436
> 
> 赞同：30
> 
> 时间：2009-04-23T05:51:02.563
> 
> 标签：asp.net, asp.net-mvc

我有一个控制器，我希望默认情况下对所有操作都要求授权，除了一对。因此，在下面的示例中，除索引外，所有操作都应需要身份验证。我不想用 Authorize 来装饰每个操作，我只想在某些情况下使用自定义过滤器（例如 NotAuthorize）覆盖默认授权。

```
[Authorize]
public class HomeController : BaseController
{
    [NotAuthorize]
    public ActionResult Index()
    {
        // This one wont
        return View();
    }

    public ActionResult About()
    {
        // This action will require authorization
        return View();
    }
} 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-23T06:09:07.137

好的，这就是我所做的。如果有更好的方法让我知道。

```
public class NotAuthorizeAttribute : FilterAttribute
{
    // Does nothing, just used for decoration
}

public class BaseController : Controller
{
    protected override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        // Check if this action has NotAuthorizeAttribute
        object[] attributes = filterContext.ActionDescriptor.GetCustomAttributes(true);
        if (attributes.Any(a => a is NotAuthorizeAttribute)) return;

        // Must login
        if (!filterContext.HttpContext.User.Identity.IsAuthenticated)
        {
            filterContext.Result = new HttpUnauthorizedResult();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-03-12T18:15:44.193

怎么样`[AllowAnonymous]`？？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-02-18T00:10:09.437

MVC4 有一个新属性正是为此而生的`[AllowAnonymous]`（正如 Enrico 所指出的）

```
[AllowAnonymous]
public ActionResult Register() 
```

在这里阅读所有相关信息：

[http://blogs.msdn.com/b/rickandy/archive/2012/03/23/securing-your-asp-net-mvc-4-app-and-the-new-allowanonymous-attribute.aspx](http://blogs.msdn.com/b/rickandy/archive/2012/03/23/securing-your-asp-net-mvc-4-app-and-the-new-allowanonymous-attribute.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-02-06T02:05:14.890

这就是我要做的，类似于克雷格的回答，但有一些变化：

1) 创建一个从 System.Attribute 派生的普通属性（不需要从 FilterAttribute 派生，因为您不会使用 FilterAttribute 提供的任何东西）。

也许创建属性的类层次结构，以便您可以基于层次结构进行测试，例如

```
Attribute
    AuthorizationAttribute
         AuthorizationNotRequiredAttribute
         AuthorizationAdminUserRequiredAttribute
             AuthorizationSuperUserRequiredAttribute 
```

2）在您的 BaseController 中覆盖`OnAuthorization`方法而不是`OnActionExecuting`方法：

```
protected override void OnAuthorization(AuthorizationContext filterContext)
{
    var authorizationAttributes = filterContext.ActionDescriptor.GetCustomAttributes(true).OfType<AuthorizationAttribute>();
    bool accountRequired = !authorizationAttributes.Any(aa => aa is AuthorizationNotRequiredAttribute); 
```

我喜欢默认安全的方法：即使您忘记在 Action 上添加属性，它至少需要用户登录。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-04-01T13:43:35.663

使用[保护您的 ASP.NET MVC 3 应用程序](http://blogs.msdn.com/b/rickandy/archive/2011/05/02/securing-your-asp-net-mvc-3-application.aspx)中所述的自定义过滤器。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-03-02T15:52:36.863

用 [Authorize] 标记控制器

[授权] 公共类 YourController : ApiController

标记您希望公开的操作：

[允许匿名]

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-04-29T19:12:33.930

聚会有点晚了，但我最终创建了一个控制器级别的身份验证属性和一个动作级别的身份验证属性，如果动作有自己的身份验证属性，我就跳过了控制器身份验证。请参阅此处的代码：

[https://gist.github.com/948822](https://gist.github.com/948822)

# wpf - Silverlight 或 WPF 远程桌面用户控制

> ID：780437
> 
> 赞同：0
> 
> 时间：2009-04-23T05:51:20.643
> 
> 标签：wpf, silverlight, user-controls, remote-desktop

是否在 WPF 中创建了允许 RDP 访问的自定义 UserControl。我知道 RDP 5.1 有 ActiveX 控件，但我更喜欢可以嵌入到 Silverlight 应用程序中的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T22:44:34.003

你说WPF和Silverlight？（它们很可能不会兼容）。

WPF 可能没有一个（正如您所说，已经有一个 ActiveX 控件），而且对于 Silverlight 来说，这样做非常困难，因为对套接字的使用有许多安全限制。例如，要使用自定义套接字，目标必须侦听端口 943 并使用 Silverlight 策略文件进行响应。其次，Silverlight 套接字仅限于端口 4502-4534。因此，您需要在目标方面进行一些端口重定向和额外的工作才能建立连接。（远程桌面默认设置为 3389）。然后，在 Silverlight 中实现 RDP 存在实际挑战（RDP 是位图驱动的，Silverlight 是基于矢量的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T05:36:49.037

VNC 是否有机会为您工作？

[http://silvervnc.codeplex.com/](http://silvervnc.codeplex.com/)

# xhtml - 如何在 XHTML 中标记科学名称？

> ID：780444
> 
> 赞同：3
> 
> 时间：2009-04-23T05:54:49.480
> 
> 标签：xhtml

我想知道在 XHTML 中标记科学名称的最佳方法。[这个答案](https://stackoverflow.com/questions/63752/when-is-the-best-time-to-use-b-and-i-in-lieu-of-strong-and-em-if-ever/64005#64005)说我应该使用`<i>`我不太赞成的元素，当然，除非它是正确使用的元素。

我可以使用`<span class="scientific">`，但鉴于 HTML 的第一个用途是标记科学文档，我想这种事情会有更好的语义挂钩。

此外，是否有任何元素可以标记科学名称的通用名称？

注意：它看起来像维基百科，或者至少[这篇文章](http://en.wikipedia.org/wiki/Golden_eagle)用于`<i>`科学名称。

**编辑**：`<dfn>`标签是否合适？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T06:10:30.987

`dfn`是对某事的定义。

```
<p>The prefix cardio- means <dfn>of the heart</dfn>.</p> 
```

据我在[HTML 4 元素列表中](http://www.htmlhelp.com/reference/html40/alist.html)看到的，没有什么特别符合要求的。这给您留下了几个选择：

```
<span class="scientific">cardio</span> 
```

*语义是由类添加的，因此从技术上讲*，这可能是最正确的方式。但是，它确实有一个缺点，即没有您的 CSS，它与周围的文本不会有任何不同。另一个选项可能是：*/me 准备躲避掩护*

```
<i class="scientific">cardio</i> 
```

现在，在我因使用 verboten 元素而头疼之前，请`<i>`考虑它的描述性不亚于 using `<span>`，即使缺少样式表，您仍然会模糊地获得正确的格式。只需确保添加`class`属性即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-14T08:27:41.200

在 (X)HTML5 中，应使用该[`i`元素：](http://www.w3.org/TR/html5/text-level-semantics.html#the-i-element)

> […] 例如**分类名称**、技术术语、惯用短语或来自另一种语言的短篇音译散文、思想或西方文本中的船名。

我猜“分类名称”符合您的情况。

# regex - 用于替换 xml 属性的正则表达式

> ID：780445
> 
> 赞同：4
> 
> 时间：2009-04-23T05:55:12.973
> 
> 标签：regex

我有一个格式为 xml 的文件：

```
<property name="foo" value="this is a long value">stuff</property> 
```

有很多属性，但我想匹配名称为 foo 的属性，然后将其 value 属性替换为其他属性，如下所示：

```
<property name="foo" value="yet another long value">stuff</property> 
```

我正在考虑编写一个正则表达式来匹配“foo”之后的所有内容到标签（“>”）的末尾并替换它，但我似乎无法正确使用语法。

如果有帮助的话，我正在尝试使用 sed 来做到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T06:00:32.307

`/property name=\"foo\" value=\"([^\"]*)\"/`

然后只需将第一个子匹配替换为您希望的新值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T05:59:09.517

您可能不想使用正则表达式来操作 xml 文件。请改为考虑[xslt](http://www.w3.org/TR/xslt)，它知道 xml 规则并且不会导致转换后的文档格式错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-18T12:24:19.020

如果您在浏览器的上下文中执行此操作，您可以创建一个包含 XML 的一次性 DOM 节点，然后通过它来替换属性值。

此函数将在每个子节点上调用回调：

```
const walkDOM = (node, callback) => {
  callback(node);
  [...node.children].forEach(child => {
    walkDOM(child, callback)
  });
} 
```

然后，您可以使用它来更新您想要的任何匹配条件的属性（这里替换任何，假设您有一个名为的 XML 字符串`svgXml`：

```
 const containerEl = document.createElement('div');
  containerEl.innerHTML = svgXml;

  walkDOM(containerEl, el => {
    const attributes = [...el.attributes];
    attributes.forEach(attr => {
      if (attr.name === 'foo' && attr.value === 'this is a long value']) {
        attr.value = 'yet another long value';
      }
    });
  });

  const outputSvgXml = containerEl.innerHTML; 
```

当然，您可以通过使用 querySelectorAll( `property`) 来进一步优化这一点，以仅遍历`<property>`节点等。

我发现这对于在利用浏览器的健壮性的同时更新 SVG 很有用。

# .net - 是否可以使用 LINQ 获取 sql 连接泄漏？

> ID：780447
> 
> 赞同：6
> 
> 时间：2009-04-23T05:56:07.277
> 
> 标签：.net, linq-to-sql, connection-pooling

我相信在使用 LINQ 时不可能出现 sql 连接泄漏，但是 NumberOfReclaimedConnections 的 perfmon 跟踪显示一个高数字，并且在高负载时，我们有时会遇到异常，例如“超时已过期。在从池中获取连接之前超时时间已过。这可能是因为所有池连接都在使用中并且达到了最大池大小”。

我们不对数据上下文使用 Dispose，因为我们使用了延迟加载。几篇文章和博文告诉我，这应该不是问题。

有时我们仍然会遇到这些异常。但是不可能每个 linq 查询都保持连接打开，那么我们会有更多的异常。

已编辑

该应用程序是 WCF 服务。

如果您查看 Linq 的文档和大多数文章，他们声称 Dispose 不是释放连接所必需的。他们声称 DataCONtext 仅在需要的短时间内保持连接打开。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-23T06:16:21.113

当您`DataContext`没有被处理并保持活动状态时，关联的连接也将保持活动状态。数据库连接是非托管资源，所有非托管资源都必须妥善处理。

即使您使用延迟加载并且没有明确定义的范围，您仍然应该在逻辑工作单元结束时清理数据库连接。在 ASP.NET 应用程序中，最晚的可能时刻是请求处理结束时 - 在 Globals.asax 文件的 Application_EndRequest 方法中。在 WCF 服务中，任何活动数据上下文都应该在每个服务方法调用结束时被处理掉。

这方面的文档含糊不清，虽然在大多数情况下，您可以避免不处理 DataContext，但似乎确实存在一些从连接加载的数据使连接本身保持活动状态的情况。确认您的情况发生这种情况的最简单方法是对其进行测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T07:30:57.940

经过更多搜索后，我发现我找到了这个[问题和答案](https://stackoverflow.com/questions/389822/when-should-i-dispose-of-a-data-context)，它说 linq 可以被愚弄以保持连接打开..

我制作了这个重现它的小测试代码。如果我只是用 foreach 替换 Enumerator 它工作正常，但他 Enumerator 保持连接打开。

```
public Organisation RunTestQuery2()
{
    IEnumerable<Organisation> orgs  = base.GetEntities<Organisation>().Take(5);

    var enumerator = orgs.GetEnumerator();
    int i = 0;

    while (enumerator.MoveNext())
    {
        var org = enumerator.Current;
        Debug.WriteLine(org.DescribingName);
        if (i == 3)
        {
           return org;
        }
        i++;
    }

    return null;
} 
```

如果我在上下文中添加调用 dispose ，它们就会消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T06:15:14.533

您的数据库中是否出现死锁？快速查看活动监视器应该会给您一些指示。

您如何管理 DataContext 生命周期 - 您编写了哪种应用程序（网站、Windows 客户端等）？

一旦在查询或操作中使用，DataContext 将保持连接，以便加载的实体可以延迟加载等，因此您必须计划如何在应用程序中使用 DataContexts。

WCF 服务.. 在这种情况下，我非常喜欢“每个请求一个上下文”方法。我鼓励您将数据操作包装在 using() 语句中，以便在完成后处理上下文。

# c++ - 调试嵌入式 Lua

> ID：780448
> 
> 赞同：29
> 
> 时间：2009-04-23T05:56:20.053
> 
> 标签：c++, debugging, lua

你如何调试嵌入在 c++ 应用程序中的 lua 代码？

据我所知，要么我需要购买一个特殊的 IDE 并链接到他们特殊的 lua 运行时（呃）。或者我需要在游戏引擎中构建一个调试控制台，使用[lua 调试 API](http://www.lua.org/manual/5.1/manual.html#3.8)调用。

我倾向于编写自己的调试控制台，但这似乎需要做很多工作。我可以更好地花时间来完善游戏的其他部分。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-24T07:13:59.270

有几个浮动的工具至少可以完成您想要的部分工作。我看到了对 VS 插件的引用，在 Lua for Windows 中有一个 SciTE 调试器扩展，还有 Kepler 项目的[RemDebug](http://www.keplerproject.org/remdebug/index.html)以及他们的[LuaEclipse](http://luaeclipse.luaforge.net/)。

RemDebug 可能会满足您的需求，因为它是为调试用 Lua 编写的 CGI 脚本而构建的。它确实需要访问 LuaSocket 模块以提供目标脚本和控制器以及其他几个模块之间的通信通道。

更大的问题可能是从游戏引擎放置在脚本周围的任何沙箱中加载任意模块的能力。如果您对引擎有一定的控制权，那么这将不是什么大问题。

例如，Adobe Lightroom 插件的开发人员目前无法做到这一点，因为 Lightroom 不会`require`在插件的沙箱内公开。

令我惊讶的是，在使用 Lua 时，我很少感到需要调试器。我已经在其中为各种项目构建了几个小型应用程序，并且惊讶于完整的堆栈回溯和偶尔`print`调用的组合可以很好地定位`require "strict"`最初没有阻止的错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-09T20:58:45.000

[德科达](http://www.unknownworlds.com/decoda)怎么样？？有一个视频解释了如何使用它，它对于嵌入式 lua 源非常有效。（我是一个快乐的客户）。而且很便宜。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-22T22:10:34.393

您不需要编写自己的控制台，因为您可能希望从现有控制台之一开始。已经建议使用 RemDebug；我一直在开发 MobDebug，它是一个基于 RemDebug 的调试器，但具有许多新功能和错误修复。更改的详细列表在[README](https://github.com/pkulchenko/MobDebug/blob/master/README)中。

在您的脚本中启用调试可能就像添加一样简单`require('mobdebug').start()`（如果您在同一台机器上运行您的应用程序和调试器服务器）。这应该尝试连接到在 localhost 上的默认端口上侦听的调试器。您可以使用 MobDebug 中包含的命令行界面，也可以使用[ZeroBrane Studio](http://studio.zerobrane.com/)，这是一个与 MobDebug 集成以提供调试功能的 Lua IDE。IDE 支持对 Love2d、Moai 和其他 Lua 引擎的调试，并且可能也适用于您的设置。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-08-23T18:52:52.657

您可以使用我的调试器：[GRLD](https://github.com/neuoy/GRLD)（图形远程 lua 调试器）。与 RemDebug 一样，它使用套接字连接，但与 RemDebug 不同，它具有漂亮的图形界面。提供了源代码，因此您可以使其在任何平台上运行。它适用于标准 lua 运行时。非商业用途免费。

编辑：对不起，我不得不关闭网站，所以该软件不再可供下载。如果我有时间的话，我可能会在以后将它作为开源软件发布。

编辑 2：链接已更新，现在在 MIT 许可下托管在 github 中（开源）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T11:02:59.257

我看不出调用 DebuggerBreak 应该如何工作，因为那是 .NET 特定的。我会假设它只适用于针对 CLR 的分叉 Lua。

如果您使用标准 Lua，您可以通过调用 lua 函数 debug.debug() 获得一些基本的调试工具。这会将 Lua 扔到您的控制台中，因此如果您从控制台运行 lua，您应该能够以交互方式发出 lua 命令来检查您的当前状态。debug.debug() 不会将您放入当前堆栈帧，因此您必须使用 debug.getlocal() 来读取变量的值。

我自己还没有尝试过，但我实际上并不认为制作自己的可行调试控制台有那么大的工作量。请记住，Lua 不像 C++ 那样复杂，所以这样做比制作真正的 C++ 调试器（比如 gdb）要容易得多。

我认为已经有很多人做过类似的事情，你可以看看谁的代码。[这](http://luaforge.net/projects/clidebugger/)是仅用 lua 编写的 CLI 调试器。只有一个lua文件。不应该硬使用和修改您的需要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T06:34:30.150

如果您使用的是 windows 和 VS - 您可以使用我们使用的技巧吗？

将 lua 代码复制到文件中。然后在 lua 代码中调用 Debugger api（在 C++ 中，`DebuggerBreak()`我认为这是 - 请参见[此处](http://msdn2.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx)）。然后当 lua 代码执行时，调试器将启动，您应该能够指定文件。然后正常调试？

# asp.net-mvc - 如何在 MVC 应用程序中添加报表？

> ID：780451
> 
> 赞同：0
> 
> 时间：2009-04-23T06:00:16.987
> 
> 标签：asp.net-mvc

在添加新项目中有一个添加报告和添加报告向导的选项。但我不知道如何使用它。有没有可以学习的博客或视频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T06:10:00.647

是的，我非常肯定。你检查过 YouTube 吗？

# asp.net - 在 Windows 服务中托管与 Silverlight 兼容的 Web 服务

> ID：780457
> 
> 赞同：0
> 
> 时间：2009-04-23T06:06:17.223
> 
> 标签：asp.net, web-services, windows-services, silverlight-2.0, com-interop

是否可以创建 Windows 服务（可在 services.msc 中访问的后台应用程序）应用程序并在其中托管 ASP.NET WebService 或 Silverlight 兼容的 WebService？

我想创建一个 WebService 来执行 COM 互操作调用，并决定直接与 COM 接口以及托管 WebService 的 Windows 服务将是最灵活的方式。然后我可以创建一个 ASP.NET 网站和 Silverlight 应用程序来与 WebService 交互。

另一种方法是让 ASP.NET 在服务器端执行 COM 互操作调用，但这有多安全，.NET 甚至允许这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T06:09:29.727

您不能在 Windows 服务中托管 ASMX Web 服务。您可以而且应该使用 WCF 来代替 ASMX。

另一方面，没有理由不能在 ASP.NET 应用程序中使用 COM 互操作，就像使用任何其他 .NET 应用程序一样容易。唯一需要注意的是多线程；由于它将从服务中调用，因此您的 COM 对象将在多个线程上被调用，这可能不会发生。

# asp.net - Ispostback 中的 Ajax 和检查操作

> ID：780459
> 
> 赞同：0
> 
> 时间：2009-04-23T06:06:46.020
> 
> 标签：asp.net, ajax.net

Ajax 和 Ispostback 中的检查操作之间是否有任何关系，尽管两者都在不加载页面的情况下进行服务器检查

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T06:15:46.607

我不确定你真的了解 AJAX 是什么，所以也许你应该看看这个[W3school 教程](http://www.w3schools.com/Ajax/ajax_intro.asp)

AJAX 框架的主要思想是消除整页回发。只有页面的相关部分被更新，没有令人不安的刷新。在客户端机器和服务器之间传输的标记显着减少，从而显着提高了用户的性能。

# design-patterns - 您从使用软件设计模式中获得了哪些实践经验？

> ID：780462
> 
> 赞同：9
> 
> 时间：2009-04-23T06:07:36.703
> 
> 标签：design-patterns, architecture

维基百科对各种设计模式有很好的[总结。](http://en.wikipedia.org/wiki/Software_design_pattern)您在实践中最多使用了哪些，您的经验是什么？什么时候应该选择一种模式，什么时候不应该？

编辑：一个很酷的基于 C# 的[链接](http://www.dofactory.com/Patterns/Patterns.aspx)，带有实际的 DP 示例（tnx to [Mladen Mihajlovic）](https://stackoverflow.com/users/11421/mladen-mihajlovic)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-23T06:16:40.583

您绝对应该避免“模式驱动设计”，在这种情况下，您会尝试将尽可能多的模式塞进您的课程中。我发现了解最重要的设计模式很有用，当我遇到一个新的设计问题时，我会问自己一个问题“我知道一种在这里有用的模式吗？”。如果我这样做了，我会尝试使用它；如果不是，那么我不会（我有时也会查找它们，因为我不知道每一种模式）。

设计模式确实可以帮助您改进代码，但如果使用不当，它们也会使事情变得混乱。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T07:10:28.770

回复*那些可能没有所有模式经验的人将能够理解您的代码在做什么*

我认为情况正好相反。模式是沟通设计的好方法，所以如果人们不了解因素、观察者、装饰者，那么他们就有问题了......

[![替代文字](https://i.stack.imgur.com/wDOZs.png)](https://i.stack.imgur.com/wDOZs.png)
[（来源：[headfirstlabs.com](http://headfirstlabs.com/Images/brain2.png)）]
查看“ [Head First: Design Patterns](http://headfirstlabs.com/) ”，他们也有一些[关于这本书的论坛](http://forums.oreilly.com/category/48/Head-First-Design-Patterns/)和一个[设计冥想](http://www.headfirstlabs.com/books/hfdp/dm.html)。

模式的好网站 [http://www.dofactory.com/Patterns/PatternObserver.aspx](http://www.dofactory.com/Patterns/PatternObserver.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T06:50:38.787

我的经验是，大多数谈 DP 的程序员都不了解它周围的力量等等！引用耶格在他伟大的[Singleton 被认为是愚蠢](http://steve.yegge.googlepages.com/singleton-considered-stupid)的：

> 如果他们声称在设计模式方面拥有专业知识，并且他们只能命名单例模式，那么他们将只能在其他公司工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-23T07:03:03.747

我认为最好遵循的规则是 KISS。模式有助于帮助您的软件更易于维护和理解，但最终 KISS 以确保可能没有所有模式经验的人能够理解您的代码在做什么。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-06-15T15:22:47.810

**创建模式**是直截了当的，我们可以很容易地得出何时使用特定模式的结论。根据要求，我在项目中使用了所有 5 种模式。

**当您对某个功能有不同的实现时，应该使用**策略模式，这可以在运行时非常容易地更改 - 就像更改配置以修改现有行为并移动到不同的实现****

 ****装饰器**模式也很简单——您可以在运行时添加行为而无需触及现有类并添加新类

**责任链、状态、适配器**模式在实时方面也非常有用。

**Bridge,Proxy & Facade** - 我在我的项目中看到的场景很少。

在其余模式中： ***Memento、Visitor、Mediator*** - 到目前为止我没有找到任何用例，与其他模式相比，我不喜欢它们

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-23T06:14:22.833

我在大多数项目中使用的一种模式是 MVC。事实证明，它非常适合我的编程类型。考虑到我实际进行的编程量，我还使用了大多数可用模式的组合。不要忘记模式是我们在编程中遇到的“**常见**问题的解决方案”。

[这是一个很酷的链接](http://www.dofactory.com/Patterns/Patterns.aspx)，用于阅读带有实现的模式（在 C# 和 VB.NET 中）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-23T06:54:18.683

正如 Benedikt 已经写过的，根据经验，只使用模式来解决问题，不要改变你的问题以使其适合模式。;-)

我经常使用工厂和建筑商。行为方面的命令、观察者和访问者模式。

它们自然适合我在日常开发生活中遇到的大多数问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-23T06:19:40.683

工厂和装饰器在 Java 和 .Net 框架中都被大量使用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-23T07:13:04.457

我们试图确定可以应用众所周知的模式的地方。通常我们不会为它们编写代码，我们只是从不同的地方获取它。通常我们将现有代码用于 Singleton、Proxy、State 等。

看看 Gamma 的书“设计模式”

“Java Camp 代码”也有常见模式的代码（[http://www.javacamp.org/designPattern/](http://www.javacamp.org/designPattern/)）

维基百科也有模式代码

路易斯

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-23T07:15:15.013

回答标题：“什么实际经验......？”，我想说尝试 DP 让我教会了我 OO 的*真正*工作原理，尤其是接口的力量。

回复其余帖子：

我最喜欢的模式是：

*   MVP（用于测试的被动视图）
*   策略——结合TDD，
*   模板方法——用于将常见行为提取到超类中。

在使用了各种模式之后，我注意到我看到它们越来越多地“自发地”出现，作为一些问题的答案。

我同意其他人的观点，即您不应该为了使用模式而使用模式——您将被困在试图塑造问题以适应解决方案的过程中，这通常是有问题的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-23T07:50:18.173

根据我的经验，一些设计模式比其他设计模式更适合某种类型的编程，例如，在游戏编程中，状态机模式是我经常使用的。MVC 和模板设计模式也非常有用。

# c - winapi：CreateProcess但隐藏进程的窗口？

> ID：780465
> 
> 赞同：41
> 
> 时间：2009-04-23T06:09:08.557
> 
> 标签：c, windows, winapi, process

我正在使用 CreateProcess 创建一个 cmd.exe 进程，该进程传递了一个执行并退出的参数，这使得命令提示符在屏幕上闪烁。

我试图通过将 STARTUPINFO struct wShowWindow 设置为 SW_HIDE 来避免这种情况，但这个参数似乎会影响调用窗口，而不是被执行的进程的窗口。

无论如何，您可以使用 createprocess 启动隐藏在视图中的程序吗？

还有什么是获取环境变量的正确winapi标准方法？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-04-23T07:24:04.820

如果它只是一个控制台应用程序，您还可以将`CREATE_NO_WINDOW`标志用作`CreateProcess`调用本身的一部分，例如

```
CreateProcess(NULL, lpszCommandLine, NULL, NULL, FALSE, 
              CREATE_NO_WINDOW, NULL, NULL, &si, &pi); 
```

此外，有关环境变量的信息，请参阅[此页面。](http://msdn.microsoft.com/en-us/library/ms682653%28VS.85%29.aspx)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-23T06:30:41.860

[此处](http://www.codeproject.com/KB/winsdk/runsilent.aspx)的以下链接描述了如何静默创建窗口：

```
DWORD RunSilent(char* strFunct, char* strstrParams)
{
    STARTUPINFO StartupInfo;
    PROCESS_INFORMATION ProcessInfo;
    char Args[4096];
    char *pEnvCMD = NULL;
    char *pDefaultCMD = "CMD.EXE";
    ULONG rc;

    memset(&StartupInfo, 0, sizeof(StartupInfo));
    StartupInfo.cb = sizeof(STARTUPINFO);
    StartupInfo.dwFlags = STARTF_USESHOWWINDOW;
    StartupInfo.wShowWindow = SW_HIDE;

    Args[0] = 0;

    pEnvCMD = getenv("COMSPEC");

    if(pEnvCMD){

        strcpy(Args, pEnvCMD);
    }
    else{
        strcpy(Args, pDefaultCMD);
    }

    // "/c" option - Do the command then terminate the command window
    strcat(Args, " /c "); 
    //the application you would like to run from the command window
    strcat(Args, strFunct);  
    strcat(Args, " "); 
    //the parameters passed to the application being run from the command window.
    strcat(Args, strstrParams); 

    if (!CreateProcess( NULL, Args, NULL, NULL, FALSE,
        CREATE_NEW_CONSOLE, 
        NULL, 
        NULL,
        &StartupInfo,
        &ProcessInfo))
    {
        return GetLastError();      
    }

    WaitForSingleObject(ProcessInfo.hProcess, INFINITE);
    if(!GetExitCodeProcess(ProcessInfo.hProcess, &rc))
        rc = 0;

    CloseHandle(ProcessInfo.hThread);
    CloseHandle(ProcessInfo.hProcess);

    return rc;

} 
```

我认为 getenv 和 setenv 都可以吗？我不确定您在这方面要问什么。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-23T06:20:55.550

在 dwFlags 中设置 STARTF_USESHOWWINDOW

通过尖牙

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-23T07:00:15.050

这可能对您的需求有点过头了，但是您可以挂钩 ShowWindow API，并且永远不会为该进程显示任何窗口

# iphone - iPhone 地图渲染

> ID：780477
> 
> 赞同：0
> 
> 时间：2009-04-23T06:15:21.913
> 
> 标签：iphone, cocoa-touch, opengl-es

我正在为 iPhone 构建地图应用程序，我想问将地图从网站带到 iPhone 的最佳方法是什么。

我想获取大小为 80x80 的小图像并显示它们。这种活动可以通过使用 UIKit 或 OpenGL ES 来实现。

另外，如果您能给我带来一些关于这件事的成就和指南，我将非常感激。

编辑：

我需要为其他供应商获取自定义地图..

除此之外，我知道如何获取图像的渲染部分和显示部分，这是我的问题人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T06:50:47.613

对于小型静态地图，您可以使用[Google 的静态地图 API](http://code.google.com/apis/maps/documentation/staticmaps)

您可以构造一个 URL 来获取您的图像，如下所示：

```
NSString* urlString = [NSString stringWithFormat:@"http://maps.google.com/staticmap?center=%f,%f&zoom=%d&size=%1.0fx%1.0f&key=%s&sensor=true",
                                 aLocation.coordinate.latitude, aLocation.coordinate.longitude, // aLocation is set to the center of the map
                                   kCardBackGoogleMapsZoomLevelDefault, 
                                   80, 80, // your map size
                                   kAIGoogleMapAPIKey]; // your google maps API key 
```

所有其他地图供应商都支持静态图块 - Microsoft、Yahoo 和 CloudMade。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T06:26:30.653

Take a look at this topic: [http://discussions.apple.com/message.jspa?messageID=8157498](http://discussions.apple.com/message.jspa?messageID=8157498). It's nearly the same as what you're asking for.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-12T12:47:36.910

就显示滚动地图而言，CATiledLayer 将是要走的路。这是一个使用起来稍微复杂的类，但是如果你用谷歌搜索它，你可以找到一些例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-25T17:05:34.377

你也可以使用 Route-Me 项目

[http://code.google.com/p/route-me/](http://code.google.com/p/route-me/)

BSD 许可 - 如果您需要渲染自己的图块，这是完美的选择

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T06:44:29.847

您可以使用 iPhone SDK 3 的 MapKit API，还是需要使用自定义地图？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T07:11:48.203

如果您有一组要加载的自定义图块，您可能需要查看 MapNinja 等公司提供的地图引擎，这些引擎可以让您使用自己的图块集。

否则，自己做一个平铺地图引擎之类的东西需要大量的编码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T21:57:52.443

如果您只想嵌入单个不可滚动的地图，请查看[Google Static Maps API](http://code.google.com/apis/maps/documentation/staticmaps/)，它会根据您的请求参数即时为您生成地图图像。

如果你想实现一个滑的地图，那么要么尝试[route-me](http://code.google.com/p/route-me/)，它与 OS 2.2.1 一起工作，并支持自定义瓦片服务器。或者看看 OS 3.0 中的 MapKit/Google Maps。

# sql - 在 C# 中查询 SQL 日期

> ID：780482
> 
> 赞同：0
> 
> 时间：2009-04-23T06:18:27.163
> 
> 标签：sql, database

假设我有一个带有日期列的表。在我的 C# 应用程序中，我希望能够在 DateTime 列上使用 LIKE 运算符查询行。我的问题是，如何处理区域设置？

例如，如果当前区域设置设置为 de-DE，则 windows 的日期格式为 dd.mm.yyyy。现在用户可能会输入类似 %2009 的内容，从而产生以下查询：

```
select * from MyTable where to_char(MyDateColumn, 'dd.MM.yyyy') like '%2009' 
```

但是不同的区域设置，用户的输入当然会有所不同，所以 to_char 不再起作用了。

我该如何解决这个问题？哦，我正在寻找一个独立于数据库的解决方案。

提前谢谢了！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T06:21:34.377

相信我，您不想在 DATETIME 列上使用 LIKE 运算符。

```
select * from MyTable where year(MyDateColumn) = 2009 
```

或者

```
select * from MyTable where datepart(yy, MyDateColumn) = 2009 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T06:20:42.990

千万不要转成文字！！！

使用 DATEPART 进行检查：http: [//msdn.microsoft.com/en-us/library/aa258265 (SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa258265(SQL.80).aspx)

例如：

```
select * from MyTable where DATEPART(year, MyDateColumn) = 2009 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T06:22:36.777

特别是，一定要使用参数化查询来防止 SQL 注入攻击。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-24T01:01:56.947

`dd/mm/yy`以格式显示日期：

```
SELECT [Sales_id]
      ,[sales_no]
      ,[sequence_id]
      ,[sales_Date], CONVERT(char(12), sales_Date, 3) as sales_Date1
      ,[Net_Total]
      ,[Roundoff]
     FROM [Furniture].[dbo].[SalesMaster]

288 109 1   2010-08-21 00:00:00.000 21/08/10        1040.00

291 110 1   2010-08-21 00:00:00.000 21/08/10        103.00

294 111 1   2010-08-21 00:00:00.000 21/08/10        7128.00 -0.40 
```

请参考 [http://msdn.microsoft.com/en-us/library/aa172602(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa172602(SQL.80).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T06:21:19.307

不要将日期与字符串进行比较。相反，使用类似 DATEPART 函数来与年份进行比较。

# tdd - TDD 友好的类单例类

> ID：780483
> 
> 赞同：2
> 
> 时间：2009-04-23T06:18:52.870
> 
> 标签：tdd, singleton, repository-pattern

我有至少 2 个其他类使用的存储库类。这个存储库类需要初始化——成本很高（查询数据库）。现在，我在需要的地方创建单独的存储库实例。问题是，每次我创建存储库时都必须对其进行初始化。如何将这样的存储库设计为对 TDD 友好？我首先想到的是 Singleton，但这[不是解决方案](http://codebetter.com/blogs/jeremy.miller/pages/129545.aspx)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T07:07:22.880

我希望 TDD 友好您的意思是“可测试”代码。对于单例 ObjectX，我认为最常见的方法是将“控制创建”**的责任**(SRP) 分配给另一个类，以便 ObjectX 完成它应该做的所有事情。

然后你有另一个类 ObjectXFactory 或 Host 或任何你想调用的类，它负责为所有客户端提供单个实例（并在需要时提供线程同步等）

*   对象 X 可以独立进行 TDD。您可以在测试用例和测试功能中创建一个新实例。
*   另一方面，ObjectXFactory 也很容易测试。您只需要查看多个 GetInstance() 调用是否返回相同的对象。或者更好地将此责任委托给像 Spring 这样的 IOC 框架，它允许您以声明方式标记对象定义以获得单例行为（也为您节省编写测试的工作）

您只需要了解并遵守不应调用 ObjectX 构造函数的团队约定 - 始终使用 ObjectXFactory.CreateInstance()。（如果您发现自己有意识/纪律问题，请将 ObjectX 的 ctor 标记为内部，并且通过偷偷摸摸的[InternalsVisibleToAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)仅对测试程序集可见）HTH

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T06:26:14.553

TDD 部分的一个答案是学习模拟。

查看 Stephen Walther 的这篇优秀文章：

[http://stephenwalther.com/blog/archive/2008/03/23/tdd-introduction-to-rhino-mocks.aspx](http://stephenwalther.com/blog/archive/2008/03/23/tdd-introduction-to-rhino-mocks.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T06:25:40.607

您使用任何类型的 IOC 容器吗？[Unity](http://unity.codeplex.com/)是我选择的容器，它包含一个[ContainerControledLifetimeManager](http://msdn.microsoft.com/en-us/library/dd203217.aspx#ks_registersingleton)，它使您的类成为单例，但不由您自己管理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T06:25:41.857

在考虑单例之前，请考虑缓存实例以提高性能。但是对于 TDD 友好的设计，请考虑策略注入，以便可以删除“慢”位进行测试并用存根和模拟替换。如果可以的话，尽量不要在测试中进行 db 调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T07:46:08.137

你不能这样做——至少在真正的 TDD 意义上不能。

依赖像 Unity 这样的 DI/IoC 策略意味着您的测试依赖于外部组件，而不是孤立地进行测试。

然后测试变成集成测试，而不是单元测试。

**==这里忽略下面的答案==**

我猜你想知道如何使存储库可测试。

*为它引入一个接口将允许您模拟或存根它*，这反过来将确保您可以独立于任何具体的 Repository 实现来测试您的对象。

我将使用[Rhino Mocks 3.5 for .NET 3.5](http://ayende.com/projects/rhino-mocks/downloads.aspx)来说明这一点：

让我们从 Repository 中创建一个接口，我们称之为`IRepository`

```
public interface IRepository
{
} 
```

现在，由于您需要对两个不同的对象使用 IRepository，那么让我们只使用泛型，这样您就可以使用它来实例化您的存储库：

```
public interface IRepository<T> 
```

当然这意味着你会有某种 find 方法：

```
{
    public IEnumerable<T> Find(Criteria criteria)
} 
```

where 您的条件对象是一些允许您设置要查找的对象的对象，例如，您的 where 子句。

现在，你有你的对象：

```
public class SomeObject
{
    IRepository<SomeObject> repository;

    public SomeObject(){}

    public IRepository<SomeObject> repository { get; set; }

    IEnumerable<SomeObject> FindAll()
    {
        //let's assume new Criteria() will return all results
        return respository.Find(new Criteria());
    }
} 
```

您想要测试`SomeObject`FindAll() 将返回一组预期的结果——这就是 Rhino Mocks 的用武之地：

```
[TestFixture]
public class SomeObjectTests
{
    [Test]
    public void TestSomeObjectFindAll()
    {
        IRepository<SomeObject> stubRepository = MockRepsitory.GenerateStub<IRepsitory<SomeObject>>();

        stubRepository.Expect(r => r.Find(new Criteria())
            .Return(new List<SomeObject>{ 
                        new SomeObject(), 
                        new SomeObject(), 
                        new SomeObject());

        var testObject = new SomeObject { Repository = stubRepository };
        IList<SomeObject> findAllResult = testObject.FindAll();

        //returned list contains 3 elements, as expected above
        Assert.AreEqual(3, findAllResult.Count)
    }
} 
```

请注意，上面的代码并不是所有方面的 TDD 最佳实践，但它是一个起点。

这里的关键概念是*引入接口以允许对象的松散耦合*，特别是当对象倾向于执行访问数据库、文件系统等操作时。

[Ben Hall 关于 Rhino Mocks 的文章](http://blog.benhall.me.uk/labels/Rhino%20Mocks.html)有一个更全面的例子和更好的例子。

# iphone - 在 iPhone OS 3.0 中访问 BPM ID3 标签

> ID：780487
> 
> 赞同：0
> 
> 时间：2009-04-23T06:19:48.563
> 
> 标签：iphone, iphone-sdk-3.0, mp3, id3

有没有办法使用 iPhone OS 3.0 SDK 访问 iPod 上歌曲的 BPM（每分钟节拍数）ID3 标签？我在看

[https://developer.apple.com/iphone/prerelease/library/documentation/MediaPlayer/Reference/MPMediaItem_ClassReference/Reference/Reference.html](https://developer.apple.com/iphone/prerelease/library/documentation/MediaPlayer/Reference/MPMediaItem_ClassReference/Reference/Reference.html)

我没有看到它：

```
NSString *const MPMediaItemPropertyPersistentID; /*可过滤 */
NSString*常量 MPMediaItemPropertyMediaType; /*可过滤 */
NSString*常量 MPMediaItemPropertyTitle; /*可过滤 */
NSString *const MPMediaItemPropertyAlbumTitle; /*可过滤 */
NSString *const MPMediaItemPropertyPodcastTitle; /*可过滤 */
NSString *const MPMediaItemPropertyArtist; /*可过滤 */
NSString *const MPMediaItemPropertyAlbumArtist; /*可过滤 */
NSString*常量 MPMediaItemPropertyGenre; /*可过滤 */
NSString*常量 MPMediaItemPropertyComposer; /*可过滤 */
NSString *const MPMediaItemPropertyPlaybackDuration;
NSString *const MPMediaItemPropertyAlbumTrackNumber;
NSString *const MPMediaItemPropertyAlbumTrackCount;
NSString *const MPMediaItemPropertyDiscNumber;
NSString *const MPMediaItemPropertyDiscCount;
NSString *const MPMediaItemPropertyArtwork;
NSString *const MPMediaItemPropertyLyrics;
NSString *const MPMediaItemPropertyIsCompilation; /*可过滤 */

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T15:22:22.460

如果您没有看到它，请提交 Radar 以将其包含在内，或者可能要求使用更通用的方式查询标签值的 API。

# single-sign-on - 身份管理/SSO 解决方案？

> ID：780490
> 
> 赞同：5
> 
> 时间：2009-04-23T06:20:55.970
> 
> 标签：single-sign-on, identity, user-management, josso

对于基本的集中式身份管理/SSO 服务，您有什么建议？它必须是开源的，具有可插入的身份管理器（例如：LDAP、DB、openID 等）并提供相当多的 API 访问选项（例如：Web 服务、REST 等）。它还必须是可集群的以实现高可用性。

约索？中国科学院？其他的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-07-11T10:14:59.257

有许多开源 SSO 解决方案，[OpenAM/OpenSSO](http://forgerock.com/openam.html)、[CAS Server](http://www.jasig.org/cas)和[Shibboleth](http://shibboleth.internet2.edu/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-08T17:22:26.387

[WSO2如此](http://wso2.com/products/identity-server/)[处](https://stackoverflow.com/questions/14521397/forgerock-identity-management-solution-vs-wso2-identity-server)所述。它完全免费，基于 Java，并通过各种协议或 API 与大多数服务/应用程序集成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-31T15:46:16.753

如果您正在寻找 SAML 支持，请[不要](http://hybridauth.sourceforge.net/)忘记[simpleSAMLphp](http://simplesamlphp.org/) ，如果您只是在寻找 SSO 库，请不要忘记 HybridAuth。

# xslt - 如何从值创建节点集

> ID：780491
> 
> 赞同：3
> 
> 时间：2009-04-23T06:21:04.223
> 
> 标签：xslt, divide-and-conquer

我们如何从值创建节点集....

我有 n 个数字 1,2,3.......n。

我想创建一个节点集

```
<MYNMUMS>
<MYNUM>1</MYNUM>
<MYNUM>2</MYNUM>
<MYNUM>3</MYNUM>
<MYNUM>4</MYNUM>
....
<MYNUM>N</MYNUM>
</MYNMUMS> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-24T22:37:38.973

*就这么简单*：

**XSLT 1.0 解决方案**：

这种转变：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="/">
     <MyNums>
       <xsl:call-template name="generateNumNodes">
         <xsl:with-param name="pStart" select="1"/>
         <xsl:with-param name="pEnd" select="10"/>
       </xsl:call-template>
     </MyNums>
    </xsl:template>

    <xsl:template name="generateNumNodes">
      <xsl:param name="pStart"/>
      <xsl:param name="pEnd"/>

      <xsl:if test="$pEnd >= $pStart">
        <xsl:variable name="vNumNodes"
           select="$pStart -$pEnd+1"/>

        <xsl:choose>
          <xsl:when test="$vNumNodes = 1">
            <MyNum><xsl:value-of select="$pStart"/></MyNum>
          </xsl:when>
          <xsl:otherwise>
            <xsl:variable name="vHalf" select=
              "floor(($pStart+$pEnd) div 2)"/>
            <xsl:call-template name="generateNumNodes">
              <xsl:with-param name="pStart" select="$pStart"/>
              <xsl:with-param name="pEnd" select="$vHalf"/>
            </xsl:call-template>

            <xsl:call-template name="generateNumNodes">
              <xsl:with-param name="pStart" select="$vHalf+1"/>
              <xsl:with-param name="pEnd" select="$pEnd"/>
            </xsl:call-template>
          </xsl:otherwise>
        </xsl:choose>
      </xsl:if>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于任何 XML 文档（未使用）时，会产生所需的输出**：

```
<MyNums>
   <MyNum>1</MyNum>
   <MyNum>2</MyNum>
   <MyNum>3</MyNum>
   <MyNum>4</MyNum>
   <MyNum>5</MyNum>
   <MyNum>6</MyNum>
   <MyNum>7</MyNum>
   <MyNum>8</MyNum>
   <MyNum>9</MyNum>
   <MyNum>10</MyNum>
</MyNums> 
```

**请注意以下几点**：

1.  **模板以** `generateNumNodes` **递归方式调用自身**。

2.  **这种递归既节省时间又节省`( O(N) )`空间`( O(log2(N)) )`**，实际上确实溢出了堆栈——这里没有！

3.  上述特性是**通过以 DVC** ( `DiVide and Conquer`)**样式**实现递归来实现的。

4.  不像`tail-recursion` **它将在任何兼容的 XSLT 处理器上成功执行**。

5.  **生成 1000000（一百万个数字）所需的最大递归深度仅为 19**。

**XSLT 2.0 解决方案**：

**更基本的，没有递归**，*只使用 XPath 2.0`to`运算符*：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>
     <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="/">
        <MyNums>
          <xsl:for-each select="1 to 10">
            <MyNums>
              <xsl:sequence select="."/>
            </MyNums>
          </xsl:for-each>
        </MyNums>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T08:22:41.327

XSLT 是一种转换语言。它通常在您已经拥有一些 XML 文档形式的数据时使用，您希望将其转换为不同的文档（可能是也可能不是 XML 格式）。

对于从“原始”数据开始并生成 XML 表示的任务，XSLT 并不适合。

我建议你研究不同的语言来解决这个问题。

# c# - C#泛型问题

> ID：780497
> 
> 赞同：3
> 
> 时间：2009-04-23T06:24:48.393
> 
> 标签：c#, generics, collections

我对泛型有点生疏，尝试执行以下操作，但编译器抱怨：

```
protected List<T> PopulateCollection(DataTable dt) where T: BusinessBase
{
    List<T> lst = new List<T>();
    foreach (DataRow dr in dt.Rows)
    {
        T t = new T(dr);
        lst.Add(t);
    }
    return lst;
} 
```

如您所见，我试图将 Table 的内容转储到对象中（通过将 DataRow 传递给构造函数），然后将对象添加到集合中。它抱怨 T 不是它知道的类型或名称空间，并且我不能在非泛型声明上使用 where 。

这不可能吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-23T06:29:55.807

有两个大问题：

*   您不能指定带有参数的构造函数约束
*   您的方法目前不是通用的 - 它应该`PopulateCollection<T>`代替`PopulateCollection`.

您已经有了一个约束`T : BusinessBase`，因此为了解决第一个问题，我建议您在以下位置添加一个抽象（或虚拟）方法`BusinessBase`：

```
public abstract void PopulateFrom(DataRow dr); 
```

还将无参数构造函数约束添加到`T`.

然后你的方法可以变成：

```
protected List<T> PopulateCollection(DataTable dt)
    where T: BusinessBase, new()
{
    List<T> lst = new List<T>();
    foreach (DataRow dr in dt.Rows)
    {
        T t = new T();
        t.PopulateFrom(dr);
        lst.Add(t);
    }
    return lst;
} 
```

如果您使用的是 .NET 3.5，则可以使用以下扩展方法使其稍微简单一些[`DataTableExtensions`](http://msdn.microsoft.com/en-us/library/system.data.datatableextensions.aspx)：

```
protected List<T> PopulateCollection<T>(DataTable dt)
    where T: BusinessBase, new()
{
    return dt.AsEnumerable().Select(dr => 
    { 
        T t = new T();
        t.PopulateFrom(dr);
    }.ToList();
} 
```

或者，您可以将其设为扩展方法本身（再次假设 .NET 3.5）并传入一个函数以返回实例：

```
static List<T> ToList<T>(this DataTable dt, Func<DataRow dr, T> selector)
    where T: BusinessBase
{
    return dt.AsEnumerable().Select(selector).ToList();
} 
```

然后你的来电者会写：

```
table.ToList(row => new Whatever(row)); 
```

这假设您回到让构造函数采用`DataRow`. 这样做的好处是允许您编写不可变的类（以及那些没有无参数构造函数的类），但这确实意味着如果没有“工厂”功能，您将无法进行通用工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T06:30:32.280

您可以指定允许创建新实例的唯一[约束](http://www.atlassian.com/software/crowd/)`new()`是- 基本上是无参数构造函数。为了避免这种情况，请执行以下任一操作：

```
interface ISupportInitializeFromDataRow
{
    void InitializeFromDataRow(DataRow dataRow);
}

protected List<T> PopulateCollection<T>(DataTable dt) 
    where T : BusinessBase, ISupportInitializeFromDataRow, new()
{
    List<T> lst = new List<T>();
    foreach (DataRow dr in dt.Rows)
    {
        T t = new T();
        t.InitializeFromDataRow(dr);

        lst.Add(t);
    }
    return lst;
} 
```

或者

```
protected List<T> PopulateCollection<T>(DataTable dt, Func<DataRow, T> builder) 
    where T : BusinessBase
{
    List<T> lst = new List<T>();
    foreach (DataRow dr in dt.Rows)
    {
        T t = builder(dr);        
        lst.Add(t);
    }
    return lst;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T06:28:27.637

您可能需要`new`在 T 上添加通用约束，如下所示：

```
protected List<T> PopulateCollection<T>(DataTable dt) where T : BusinessBase, new()
... 
```

我无法将 DataRow 传递给构造函数，但您可以通过将其分配给`BusinessBase`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T06:45:30.247

一种可能的方式是：

```
protected List<T> PopulateCollection<T>(DataTable dt) where T: BusinessBase, new()
    {
        List<T> lst = new List<T>();
        foreach (DataRow dr in dt.Rows)
        {
            T t = new T();
            t.DataRow = dr;
            lst.Add(t);
        }
        return lst;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T06:28:33.580

```
where T: BusinessBase 
```

我认为应该有 new() 的限制

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T10:10:54.590

有可能的。我的框架中有完全相同的东西。我遇到了和你完全相同的问题，这就是我解决它的方法。从框架中发布相关片段。如果我没记错的话，最大的问题是要求调用无参数构造函数。

```
 public class Book<APClass> : Book where APClass : APBase
        private DataTable Table ; // data
        public override IEnumerator GetEnumerator()
        {                        
            for (position = 0;  position < Table.Rows.Count;  position++)           
                 yield return APBase.NewFromRow<APClass>(Table.Rows[position], this.IsOffline);
        }
   ...

  public class APBase ...
  {
    ...
    internal static T NewFromRow<T>(DataRow dr, bool offline) where T : APBase
        {

            Type t = typeof(T);
            ConstructorInfo ci;

            if (!ciDict.ContainsKey(t))
            {
                ci = t.GetConstructor(new Type[1] { typeof(DataRow) });
                ciDict.Add(t, ci);
            }
            else ci = ciDict[t];

            T result = (T)ci.Invoke(new Object[] { dr });

            if (offline)
                result.drCache = dr;    

            return result;
        } 
```

在这种情况下，基类具有静态方法来使用接受 tablerow 的构造函数来实例化其派生类的对象。

# sql - SQL 使用acts_as_tsearch 搜索多对多关系

> ID：780505
> 
> 赞同：1
> 
> 时间：2009-04-23T06:28:08.573
> 
> 标签：sql, ruby-on-rails, full-text-search

我正在使用rails 的acts_as_tsearch 插件来使用Postgresql 进行全文搜索。

他们在这里给出了一个多表搜索的例子： [http ://code.google.com/p/acts-as-tsearch/wiki/ActsAsTsearchMethod](http://code.google.com/p/acts-as-tsearch/wiki/ActsAsTsearchMethod)

但这只是一对多的关系。我试图让它也搜索页面上的标签的多对多关系（has_and_belongs_to_many 或 habtm）。但是我的 SQL 不够高级。

这是我到目前为止所得到的：

```
 acts_as_tsearch :vectors => {
    :fields => {
      "a" => {:columns => ["pages.name"], :weight => 1.0},
      "b" => {:columns => ["pages.description"], :weight => 0.2},
      "c" => {:columns => ["tags.name"], :weight => 0.2}
    },
    :tables => {
      :tags => {
        :from => "tags INNER JOIN taggings ON tags.id = taggings.tag_id",
        :where => "((taggings.taggable_type = 'Page') AND (taggings.taggable_id = ???.id) AND ((taggings.context = 'tags')))"
      }
    }
  } 
```

我不确定如何引用页面 ID（我放 ???）。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-29T17:14:37.590

那么，这背后的 SQL 将是：

```
select
    p.name,
    p.description,
    t.name
from
    pages p
    inner join taggings ts on
        p.page_id = ts.taggable_id
        and ts.taggable_type = 'Page'
        and ts.context = 'tags'
    inner join tags t on
        ts.tag_id = t.tag_id 
```

所以，你的 Ruby 看起来像：

```
acts_as_tsearch :vectors => {
  :fields => {
    "a" => {:columns => ["p.name"], :weight => 1.0},
    "b" => {:columns => ["p.description"], :weight => 0.2},
    "c" => {:columns => ["t.name"], :weight => 0.2}
  },
  :tables => {
    :tags => {
      :from => "pages p
        inner join taggings ts on
            p.page_id = ts.taggable_id
            and ts.taggable_type = 'Page'
            and ts.context = 'tags'
        inner join tags t on
            ts.tag_id = t.tag_id"
    }
  }
} 
```

这是通过多对多表的标准方法——从一个表开始，加入映射，然后加入另一个表。瞧！多对多结果！

# .net - URL 路由 - 注册问题

> ID：780513
> 
> 赞同：0
> 
> 时间：2009-04-23T06:30:50.970
> 
> 标签：.net, asp.net-mvc, url-routing

我已经使用 ASP.NET MVC 几个星期了，看截屏视频，阅读教程等等。事实证明，这对我来说是非常有趣的技术，我开始尝试它。我编写了简单的 Web 应用程序，它只是从一个表中获取数据并显示它。

在我的开发环境中一切正常，但是当我尝试将我的简单 Web 应用程序“部署”到我的主机上时，我遇到了一个问题 - URL 路由不起作用。在深入研究了我发现的问题后，由于某种原因，Routes 表是空的。

什么可能导致问题？为什么不会调用 Application_Start 方法？以及如何解决这个问题？

PS 我使用 ASP.NET MVC 1.0 // 模板 ASP.NET MVC 项目创建了我的测试 Web 应用程序。IIS7 在集成模式下运行，我无权访问它的管理（只能通过 web.config 文件）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-26T16:26:57.973

原来是部署问题 - 我没有在其他文件中复制 Global.asax 文件。

# graphics - 3D 和光线追踪的最佳选择

> ID：780515
> 
> 赞同：3
> 
> 时间：2009-04-23T06:31:22.293
> 
> 标签：graphics, 3d, raytracing

我想玩一些图形的东西。简单的动画和东西。我也想玩光线追踪。我需要帮助找到一个可以帮助我做这些事情的图书馆。我有几个要求：

*   必须能够进行光线追踪
*   必须用于高级语言（python、.NET 等）。请不要使用 C/C++
*   必须有良好的文档，最好有例子。

有谁知道我可以用来鬼混的好图书馆？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T07:01:28.510

看看 blender.org - 这是一个具有 python 脚本功能的开源 3d 项目。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T08:01:06.027

我首先想到的是流行的开源 POV Raytracer (www.povray.org)。POV 场景完全由脚本文件定义，有些人编写了 Python 代码来轻松生成它们。

[http://code.activestate.com/recipes/205451/](http://code.activestate.com/recipes/205451/)

[http://jabas-unblog.blogspot.com/2007/04/easy-procedural-graphics-python-and-pov.html](http://jabas-unblog.blogspot.com/2007/04/easy-procedural-graphics-python-and-pov.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T07:14:57.307

我不知道有任何库可以满足您的要求（至少除非我决定为我自己的跟踪器发布代码......）。

无论如何，编写示踪剂实际上并不难。我强烈建议您获取 Glassner 的“An Introduction to Ray Tracing”的副本。它以相对容易理解的术语介绍了实际数学，并且还有一整节关于“如何编写光线追踪器”。

无论如何，“库”本身并没有那么多用处——几乎每个光线追踪器都有自己的内部库，但它们是特定于追踪器的。它们通常包括：

1.  表示 3D 对象的基类
2.  每个几何图元的子类
3.  矢量和矩阵类（3D 和 4D）
4.  纹理函数和/或类
5.  各种类型的光类（点光源、聚光灯等）

对于我自己的跟踪器，我实际上使用了`javax.vecmath`上面 #3 的包，但必须根据 Glassner 书为 #1 和 #2 编写我自己的代码。整个代码不到 2k 行，而大多数单独的类大约有 40 行长。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T07:40:00.007

我相信很少有人使用[XNA Game Studio](http://creators.xna.com/en-GB/downloads)将光线追踪器放在一起。

可以在以下位置看到一个带有代码的示例：

> [定制软件 » 光线追踪 - 材料](http://www.bespokesoftware.org/wordpress/?p=22)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T07:56:02.467

开发良好的开源光线追踪器是

*   [亚弗雷](http://www.yafaray.org/download/yafaray)
*   [波夫雷](http://www.povray.org/download/)

对于实时 3D（当然取决于语言），[JMonkeyEngine](http://www.jmonkeyengine.com/) (Java) 不确定这是否满足您的“高级语言”要求。

您也可以考虑使用 3D 游戏脚本语言，例如[GameCore](http://gamecore3d.com/home/anonymous)或[BlitzBasic](http://www.blitzbasic.com/)

# persistence - WF 性能，每月新增 20,000 个持久工作流实例

> ID：780524
> 
> 赞同：2
> 
> 时间：2009-04-23T06:38:13.027
> 
> 标签：persistence, workflow-foundation

Windows Workflow Foundation 在持续执行 WF 实例时存在一个缓慢的问题。我打算做一个项目，其业务层将基于 WF 公开的 WCF 服务。该项目每月将创建 20,000 个新的工作流实例，每个实例最多可能需要 2 个月才能完成。我被引导相信，考虑到性能原因，考虑到 WF 在进行持久性时会变慢，我给定的问题将是无法实现的。我有以下问题：

1.  这是真的？我的表现会因为负载而变得糟糕吗（鉴于 WF 持久性速度限制）
2.  我该如何解决这个问题？

我们目前有两种可能的解决方案： 1.每个新的业务流程请求（例如给我一个新的驾驶执照）将是一个新的WF实例，并且通过将所有状态请求操作转发到保存的状态值来限制持久化操作的数量一个单独的数据库。2\. 在任何给定时间都只有少量的工作流实例，没有任何持久性（仅在系统崩溃等情况下），通过将每个工作流步骤分解到一个单独的工作流和处理每个业务流程请求的工作流当前步骤的系统中的实例（例如，我正在提交我的驾驶执照申请表，这是第一步......我们有 100 个案例，我的第一步工作流程将同时处理每个案例）。

我对这个问题的解决方案非常感兴趣。如果你想讨论这个问题，请随时给我发邮件 nstjelja@gmail.com

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-18T12:19:39.800

老实说，我还在研究工作流基础的性能特征。

但是，如果有帮助的话，我听说 WF 团队在 WF 4 的新版本中进行了许多性能改进。

这里有几个链接可能会有所帮助（如果您还没有看到它们）

[A Developer's Introduction to Windows Workflow Foundation (WF) in .NET 4（讨论性能改进）](http://msdn.microsoft.com/en-us/library/ee342461.aspx)

[Windows Workflow Foundation 的性能特征（适用于 WF 3.0）](http://msdn.microsoft.com/en-us/library/aa973808.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T06:49:17.430

水合执行 wokflow 的数量将由环境因素内存服务器通过 put 等决定。持久性问题只有在您一直在加载和卸载工作流（即实际（ish）时间）时才会真正发挥作用，在这种情况下工作流可能不是最好的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T06:50:37.147

在我当前的项目中，我们还使用持久性的 WF。我们没有完全相同的数量（可能大约 2000 个实例/月），而且它们通常不需要很长时间才能完成（它们通常在 5 分钟内完成，在某些情况下需要几天）。我们确实决定将主要工作流程分为两部分，即正常等待状态。我不能说我注意到了系统的任何性能差异，但它确实简化了它，因为我们的系统有时会在将传入信号与正确的工作流实例匹配时出现问题（这是我们代码中的一个问题；不在WF)。

我认为，如果我要开始一个基于 WF 的新项目，我宁愿选择按顺序调用的较小工作流，而不是让大工作流处理整个过程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-16T08:04:23.363

WF on 3.5 有性能问题。WF4 没有 - 每月 20000 个 WF 实例不算什么。如果你每分钟都在说话，我会担心的。

# python - 如何在更改时自动重新加载python文件

> ID：780526
> 
> 赞同：8
> 
> 时间：2009-04-23T06:40:03.427
> 
> 标签：python

如果我对属于正在运行的应用程序的文件之一进行一些更改，有没有办法告诉 python 运行时自动重新加载模块/文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T08:16:30.357

看看[CherryPy 的 Autoreload 功能](http://www.cherrypy.org/attachment/wiki/AutoReload/autoreload.py)。我认为它看起来很简单，而且对我来说总是很有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T07:15:02.940

这是我近十年前发布的一个非常古老的模块。我可能不再使用当前的 Python 版本（我没有检查过），但它可能会给出一些想法。

[http://mail.python.org/pipermail/python-list/2000-April/031568.html](http://mail.python.org/pipermail/python-list/2000-April/031568.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T07:42:43.357

看看[Django 的 autoreload 模块](http://code.djangoproject.com/svn/django/trunk/django/utils/autoreload.py)。它工作得很好。

# java - 这个符号叫什么？

> ID：780527
> 
> 赞同：0
> 
> 时间：2009-04-23T06:41:16.063
> 
> 标签：java

类名可以缩写如下：

```
CustomerService => CS
CustomerPaymentService => CPS
UnpaidBillRetriever => UBR
FindAnyRemainingOpenUserTrasactions => FAROUT 
```

这由 control-N (idea) 或 control-shift-T (eclipse) 支持。经过一些初步的重新学习后，我现在大量使用这种命名策略。但它叫什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T06:51:10.767

我将其称为首字母缩略词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T07:01:56.777

它被称为骆驼案。因为你只会取大写字母。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T06:59:10.823

可能是“别名”？

# c# - 如何在 C# 中从 Windows 应用程序发送电子邮件？

> ID：780534
> 
> 赞同：2
> 
> 时间：2009-04-23T06:45:41.137
> 
> 标签：c#, winforms

我正在使用 MS C# 2008。我创建了 Windows 窗体应用程序。我需要从我的应用程序中发送电子邮件。那么如何配置 smtp 设置呢？

**编辑**

我得到了以下异常

SMTP 服务器需要安全连接或客户端未通过身份验证。服务器响应为：5.5.1 需要身份验证。了解更多信息

在 smtp.send（消息）上；

我还没有安装 IIS，所以桌面应用程序需要它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T06:51:07.410

您可以在 App.Config [http://www.mitchelsellers.com/blogs/articletype/articleview/articleid/8/net-20-smtp-settings.aspx中添加 SMTP 设置](http://www.mitchelsellers.com/blogs/articletype/articleview/articleid/8/net-20-smtp-settings.aspx)

然后使用 System.Net.Mail.SmtpClient 和 System.Net.Mail.MailMessage 发送和创建电子邮件。

```
c = new System.Net.Mail.SmtpClient();

msg = new System.Net.Mail.MailMessage();

System.Net.Mail.MailAddress a = new System.Net.Mail.MailAddress( sEmailAddress, sWho );

msg.To.Add( a );

msg.From = new System.Net.Mail.MailAddress("");

msg.ReplyTo = new System.Net.Mail.MailAddress("");

msg.Subject = "Web Inquiry";

msg.Body = msgBody.ToString();

c.Send( msg ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T03:24:43.977

为什么你们中的很多人都使用它作为解决问题的主干提出“IIS”建议？如果这是一个已部署的应用程序怎么办？你要让客户端在他们平庸的系统上安装和运行 IIS 只是使用你的应用程序的邮件功能？？？

这对我来说没有意义。

那些正在寻找通过 win 应用程序发送电子邮件的解决方案的人，请在谷歌上搜索“使用 gmail 在 c# 中发送电子邮件”。

-抢

# nhibernate - 排序的问题 when a value is null

> ID：780535
> 
> 赞同：2
> 
> 时间：2009-04-23T06:46:13.740
> 
> 标签：nhibernate

我正在尝试使用 NHibernate 2.0 持久化 SortedList<DateTime, double?>。当一个项目的值（不是键）为空时，该项目不会持久化到数据库中。

类片段：

```
public class TimeSeries{
    ...
    public TimeSeries(){
        Data = new SortedList<DateTime, double?>();
    }
    public virtual IDictionary<DateTime, double?> Data { get; private set; }
    ...
} 
```

映射片段：

```
...
    <map name="Data" cascade="all" lazy="true" sort="natural" collection-type="sorted-list">
        <key column="ID"/>
        <index type="Date" column="Period"/>
        <element type="double" column="Value" not-null="false"/>
    </map>
... 
```

使用片段：

```
var series = new TimeSeries();
series.Data.Add(new DateTime(2000, 1, 1), 1);
series.Data.Add(new DateTime(2000, 1, 2), null);
series.Data.Add(new DateTime(2000, 1, 3), 3);
repository.Add(series); 
```

第一项和第三项是持久的，但不是第二项。如果我将双精度值从空值更改为非空值，则保存得很好。

知道如何保存空值吗？我正在使用 MySql 并且数据库架构允许空值。

谢谢，马库斯

# cocoa - 为什么文本在拆分视图的文本字段中拉伸？

> ID：780537
> 
> 赞同：0
> 
> 时间：2009-04-23T06:47:01.400
> 
> 标签：cocoa, stretch

当我使用分隔符调整文本字段的大小时，如果未选择文本，它会像[这样](http://kttns.org/mmy5n)拉伸。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T06:53:47.560

一个文本字段通常一次只包含一行文本；你不会让它垂直变大。也许您想要一个[文本视图](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSTextView_Class/Reference/Reference.html)？

# shell - 带有 nawk 的脚本不会将输出打印到屏幕

> ID：780540
> 
> 赞同：2
> 
> 时间：2009-04-23T06:48:00.023
> 
> 标签：shell, nawk

我遇到了一个很好的单行来搜索文本并打印出具有给定数量的尾随行和后续行的结果。我正在尝试从中创建一个脚本。到目前为止，这就是我所拥有的：

```
# *********************************************************
# This uses nawk to list lines coming prior to and after
# the given search string.
# Format: xgrep <string> <file> <before> <after>
# ********************************************************

STR=$1
FILE=$2
BEF=$3
AFT=$4
export STR
export FILE
export BEF
export AFT

nawk 'c-->0;$0~s{if(b)for(c=b+1;c>1;c--)print r[(NR-c+1)%b];print;c=a}b{r[NR%b]=$0}' b=$BEF a=$AFT s=$STR $FILE 
```

问题是 nawk 命令的输出没有出现在屏幕上

```
>xgrep "bin/sh" * 0 3
> 
```

但是如果我输入命令，我会得到正确的输出：

```
>nawk 'c-->0;$0~s{if(b)for(c=b+1;c>1;c--)print r[(NR-c+1)%b];print;c=a}b{r[NR%b]=$0}' b=0 a=3 s="bin/sh" *
#!/bin/sh

export AEGIS_PROJECT=$1
export EDITOR=cat
#!/bin/sh

aegis -cpu $pwd
aegis -dbu $1
#!/bin/sh
cd $HOME/ex_7/src/DTTCom
NRMan alphabuild clean
NRMan alphabuild library ex_7 8.19 app TEST DTTCom debug -j10
#!/bin/sh
cd $HOME/icx/src/DTTCom
NRMan alphabuild clean
NRMan alphabuild library icx_1 1.1 app TEST DTTCom debug -j10
#!/bin/sh
# *********************************************************
# This uses nawk to list lines coming prior to and after
# the given search string. 
```

这是什么原因，我怎样才能让脚本工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T06:56:56.413

尝试使用：

```
xgrep "bin/sh" '*' 0 3 
```

反而。

在将参数传递给脚本之前，通配符项的扩展发生在当前 shell 中，如下面的脚本所示：

```
pax: xgrep include *.c 0 3
#include <stdio.h>
gawk: (FILENAME=binmath.c FNR=1) fatal: division by zero attempted in '%'

pax: xgrep include '*.c' 0 3
#include <stdio.h>

// Prototypes - should go in separate header file.
void compBinNum (char*);
#include <stdio.h>
#include <string.h>
#include <string.h>

#define UTF8ERR_TOOSHORT -1
#define UTF8ERR_BADSTART -2
#include <stdio.h>
#include <errno.h>
#include <errno.h>

int main (void) {
    FILE *file = fopen ("words.txt", "r"); 
```

您可以看到这些参数如何与以下简单脚本和输出一起使用：

```
pax: cat argtest
    #!/bin/bash
    echo Number of arguments: $#
    echo Arguments: "$*"

pax: argtest *
    Number of arguments: 32
    Arguments: Makefile a.exe argtest binmath.c binmath.exe dev
        file.db infile input.txt inputfile limit10 output.txt
        p2.sh p2expected p2input1 p2input2 qq qq.c qq.cpp qq.exe
        qq.exe.stackdump qq.pl qq.py qqin qqq.c qqq.s tmpfile
        words2.txt xgrep xx.c xx.exe xx.pl

pax: argtest '*'
    Number of arguments: 1
    Arguments: * 
```

**更新：**

根据您在评论中的问题：

> 谢谢。当我用单引号包裹文件时它起作用了。有没有一种方法可以在脚本中执行此操作，以便用户不必费心输入单引号？

不，那是因为 shell 在你的脚本看到它之前就已经完成了。但是，如果您将文件规范移动到命令行的末尾：

```
xgrep include 0 3 *.c 
```

您可以修改您的脚本，使其不仅处理第 4 个参数，还处理之后的*每个*参数，一次一个。然后，当它们被外壳扩展时，就没有关系了。

类似的东西（gawk/nawk 在一行上）：

```
STR=$1
BEF=$2
AFT=$3
while [[ ! -z "$4" ]] ; do
    echo ========== "$4"
    gawk 'c-->0;$0~s{if(b)for(c=b+1;c>1;c--)
        print r[(NR-c+1)%b];print;c=a}b{r[NR%b]=$0}'
        b=$BEF a=$AFT s=$STR "$4"
        | sed "s/^/$4: /"
    shift
done
echo ========== 
```

让 shell 处理您的扩展并使用循环还允许您执行一些技巧，例如在输出的每个块（或行）中打印文件名：

```
pax: xgrep include  0 3 *.c
    ========== binmath.c
    binmath.c:     #include <stdio.h>
    binmath.c:
    binmath.c:     // Prototypes - should go in separate header file.
    binmath.c:     void compBinNum (char*);
    ========== qq.c
    qq.c:     #include <stdio.h>
    qq.c:     #include <string.h>
    qq.c:     #include <string.h>
    qq.c:
    qq.c:     #define UTF8ERR_TOOSHORT -1
    qq.c:     #define UTF8ERR_BADSTART -2
    ========== qqq.c
    ========== xx.c
    xx.c: #include <stdio.h>
    xx.c: #include <errno.h>
    xx.c: #include <errno.h>
    xx.c:
    xx.c: int main (void) {
    xx.c:     FILE *file = fopen ("words.txt", "r");
    ========== 
```

# java - 如何在 Java 中对 HashMap 进行排序

> ID：780541
> 
> 赞同：123
> 
> 时间：2009-04-23T06:48:33.563
> 
> 标签：java, sorting, hashmap

我们如何对 a 进行排序`HashMap<key, ArrayList>`？

我想根据`ArrayList`.

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-04-23T06:57:35.197

你必须使用HashMap吗？如果您只需要地图接口，请使用[TreeMap](http://java.sun.com/javase/6/docs/api/index.html?java/util/TreeMap.html)

* * *

如果要通过比较 HashMap 中的值进行排序。您必须编写代码来执行此操作，如果您想在可以对 HashMap 的值进行排序后执行此操作：

```
Map<String, Person> people = new HashMap<>();
Person jim = new Person("Jim", 25);
Person scott = new Person("Scott", 28);
Person anna = new Person("Anna", 23);

people.put(jim.getName(), jim);
people.put(scott.getName(), scott);
people.put(anna.getName(), anna);

// not yet sorted
List<Person> peopleByAge = new ArrayList<>(people.values());

Collections.sort(peopleByAge, Comparator.comparing(Person::getAge));

for (Person p : peopleByAge) {
    System.out.println(p.getName() + "\t" + p.getAge());
} 
```

如果你想经常访问这个排序列表，那么你可以将你的元素插入到 a`HashMap<TreeSet<Person>>`中，尽管集合和列表的语义有点不同。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-02-18T12:59:45.600

按 hasmap 键排序的列表：

```
SortedSet<String> keys = new TreeSet<String>(myHashMap.keySet()); 
```

按哈希图值排序的列表：

```
SortedSet<String> values = new TreeSet<String>(myHashMap.values()); 
```

如果地图值重复：

```
List<String> mapValues = new ArrayList<String>(myHashMap.values());
Collections.sort(mapValues); 
```

祝你好运！

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-23T09:23:52.333

[http://snipplr.com/view/2789/sorting-map-keys-by-comparing-its-values/](http://snipplr.com/view/2789/sorting-map-keys-by-comparing-its-values/)

拿到钥匙

```
List keys = new ArrayList(yourMap.keySet()); 
```

对它们进行排序

```
 Collections.sort(keys) 
```

打印它们。

在任何情况下，您都不能在 HashMap 中对值进行排序（根据 API `This class makes no guarantees as to the order of the map; in particular, it does not guarantee that the order will remain constant over time`]。

尽管您可以将所有这些值推送到`LinkedHashMap`, 以供以后使用。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-23T06:58:25.723

好像你可能想要一个树形图。

[http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html](http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html)

如果适用，您可以将自定义比较器传递给它。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-03-16T23:10:48.667

在 Java 8 中：

```
Comparator<Entry<String, Item>> valueComparator = 
    (e1, e2) -> e1.getValue().getField().compareTo(e2.getValue().getField());

Map<String, Item> sortedMap = 
    unsortedMap.entrySet().stream().
    sorted(valueComparator).
    collect(Collectors.toMap(Entry::getKey, Entry::getValue,
                             (e1, e2) -> e1, LinkedHashMap::new)); 
```

使用[番石榴](http://code.google.com/p/guava-libraries/)：

```
Map<String, Item> map = ...;
Function<Item, Integer> getField = new Function<Item, Integer>() {
    public Integer apply(Item item) {
        return item.getField(); // the field to sort on
    }
};
comparatorFunction = Functions.compose(getField, Functions.forMap(map));
comparator = Ordering.natural().onResultOf(comparatorFunction);
Map<String, Item> sortedMap = ImmutableSortedMap.copyOf(map, comparator); 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-05-25T00:52:37.383

**自定义比较功能**，其中包括**土耳其字母**或**英语以外的其他不同语言**的功能。

```
public <K extends Comparable,V extends Comparable> LinkedHashMap<K,V> sortByKeys(LinkedHashMap<K,V> map){
    List<K> keys = new LinkedList<K>(map.keySet());
    Collections.sort(keys, (Comparator<? super K>) new Comparator<String>() {
        @Override
        public int compare(String first, String second) {
            Collator collator = Collator.getInstance(Locale.getDefault());
            //Collator collator = Collator.getInstance(new Locale("tr", "TR"));
            return collator.compare(first, second);
        }
    });

    LinkedHashMap<K,V> sortedMap = new LinkedHashMap<K,V>();
    for(K key: keys){
        sortedMap.put(key, map.get(key));
    }

    return sortedMap;
} 
```

这是使用示例，如下所示

```
LinkedHashMap<String, Boolean> ligList = new LinkedHashMap<String, Boolean>();
ligList = sortByKeys(ligList); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-23T06:53:05.283

没有更多信息，很难确切地知道你想要什么。但是，在选择要使用的数据结构时，您需要考虑到您需要它的用途。哈希图不是为排序而设计的——它们是为方便检索而设计的。因此，在您的情况下，您可能必须从哈希图中提取每个元素，并将它们放入更有利于排序的数据结构中，例如堆或集合，然后在那里对它们进行排序。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-23T07:19:09.153

如果您想将 Map 与 SortedMap 结合起来进行高效检索，您可以使用[ConcurrentSkipListMap](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentSkipListMap.html)。

当然，您需要将键作为用于排序的值。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-03-04T14:13:29.510

您是否考虑过使用 LinkedHashMap<>()..？

```
 public static void main(String[] args) {
    Map<Object, Object> handler = new LinkedHashMap<Object, Object>();
    handler.put("item", "Value");
    handler.put(2, "Movies");
    handler.put("isAlive", true);

    for (Map.Entry<Object, Object> entrY : handler.entrySet())
        System.out.println(entrY.getKey() + ">>" + entrY.getValue());

    List<Map.Entry<String, Integer>> entries = new ArrayList<Map.Entry<String, Integer>>();
    Collections.sort(entries, new Comparator<Map.Entry<String, Integer>>() {
        public int compare(Map.Entry<String, Integer> a,
                Map.Entry<String, Integer> b) {
            return a.getValue().compareTo(b.getValue());
        }
    });
} 
```

结果变成一个有组织的链接对象。

```
 item>>Value
 2>>Movies
 isAlive>>true 
```

检查从[这里](https://stackoverflow.com/questions/12184378/sorting-linkedhashmap)挑选的分拣部分..

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-02-16T13:15:20.167

我开发了一个类，可用于根据键和值对地图进行排序。基本思想是，如果您使用键对地图进行排序，然后从您的地图创建一个 TreepMap，它将按键对地图进行排序。如果按值排序，则从 entrySet 创建一个列表，并使用比较器接口对列表进行排序。

这是完整的解决方案：

```
public static void main(String[] args) {
    Map<String, Integer> unSortedMap = new LinkedHashMap<String, Integer>();
    unSortedMap.put("A", 2);
    unSortedMap.put("V", 1);
    unSortedMap.put("G", 5);
    System.out.println("Unsorted Map :\n");
    for (Map.Entry<String, Integer> entry : unSortedMap.entrySet()) {
        System.out.println(entry.getKey() + "   " + entry.getValue());
    }
    System.out.println("\n");
    System.out.println("Sorting Map Based on Keys :\n");
    Map<String, Integer> keySortedMap = new TreeMap<String, Integer>(unSortedMap);
    for (Map.Entry<String, Integer> entry : keySortedMap.entrySet()) {
        System.out.println(entry.getKey() + "   " + entry.getValue());
    }
    System.out.println("\n");
    System.out.println("Sorting Map Based on Values :\n");
    List<Entry<String, Integer>> entryList = new ArrayList<Entry<String, Integer>>(unSortedMap.entrySet());
    Collections.sort(entryList, new Comparator<Entry<String, Integer>>() {

        @Override
        public int compare(Entry<String, Integer> obj1, Entry<String, Integer> obj2) {
            return obj1.getValue().compareTo(obj2.getValue());
        }
    });
    unSortedMap.clear();
    for (Entry<String, Integer> entry : entryList) {
        unSortedMap.put(entry.getKey(), entry.getValue());
        System.out.println(entry.getKey() + "   " + entry.getValue());
    }
} 
```

*代码经过适当测试：D*

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-07-31T14:51:16.540

一个正确的答案。

```
HashMap<Integer, Object> map = new HashMap<Integer, Object>();

ArrayList<Integer> sortedKeys = new ArrayList<Integer>(map.keySet());
Collections.sort(sortedKeys, new Comparator<Integer>() {
  @Override
  public int compare(Integer a, Integer b) {
    return a.compareTo(b);
  }
});

for (Integer key: sortedKeys) {
  //map.get(key);
} 
```

请注意，正如其他答案所指出的那样，HashMap 本身无法维护排序。这是一个**哈希**映射，哈希值是未排序的。因此，您可以在需要时对键进行排序，然后按顺序访问值，如上所示，或者您可以找到一个不同的集合来存储您的数据，例如 Pairs/Tuples 的 ArrayList，例如在阿帕奇共享：

[https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/tuple/Pair.html](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/tuple/Pair.html)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-07-21T17:52:34.330

按值对 HashMap 进行排序：

正如其他人指出的那样。HashMaps 便于查找，如果您更改它或尝试在地图本身内部进行排序，您将不再有 O(1) 查找。

您的排序代码如下：

```
class Obj implements Comparable<Obj>{
    String key;
    ArrayList<Integer> val;
    Obj(String key, ArrayList<Integer> val)
    {
    this.key=key;
    this.val=val;
    }
    public int compareTo(Obj o)
    {
     /* Write your sorting logic here. 
     this.val compared to o.val*/
     return 0;
    }
}

public void sortByValue(Map<String, ArrayList<>> mp){

    ArrayList<Obj> arr=new ArrayList<Obj>();
    for(String z:mp.keySet())//Make an object and store your map into the arrayList
    {

        Obj o=new Obj(z,mp.get(z));
        arr.add(o);
    }
    System.out.println(arr);//Unsorted
    Collections.sort(arr);// This sorts based on the conditions you coded in the compareTo function.
    System.out.println(arr);//Sorted
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-08-29T11:11:10.367

按键排序：

```
public static void main(String[] args) {
    Map<String,String> map = new HashMap<>();

    map.put("b", "dd");
    map.put("c", "cc");
    map.put("a", "aa");

    map = new TreeMap<>(map);

    for (String key : map.keySet()) {
        System.out.println(key+"="+map.get(key));
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-04-03T15:38:16.447

我开发了一个经过全面测试的工作解决方案。希望能帮助到你

```
import java.io.BufferedReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.HashMap;
import java.util.List;
import java.util.StringTokenizer;

public class Main {
    public static void main(String[] args) {
    try {
        BufferedReader in = new BufferedReader(new java.io.InputStreamReader           (System.in));
            String str;

        HashMap<Integer, Business> hm = new HashMap<Integer, Business>();
        Main m = new Main();

        while ((str = in.readLine()) != null) {

            StringTokenizer st = new StringTokenizer(str);
            int id = Integer.parseInt(st.nextToken());    // first integer
            int rating = Integer.parseInt(st.nextToken());    // second 

            Business a = m.new Business(id, rating);

            hm.put(id, a);

            List<Business> ranking = new ArrayList<Business>(hm.values());

            Collections.sort(ranking, new Comparator<Business>() {

                public int compare(Business i1, Business i2) {
                    return i2.getRating() - i1.getRating();
                }
            });

            for (int k=0;k<ranking.size();k++) {
                System.out.println((ranking.get(k).getId() + " " + (ranking.get(k)).getRating()));
            }

        }
        in.close();

    } catch (IOException e) {
        e.printStackTrace();
    }

}
public class Business{

    Integer id;
    Integer rating;

    public Business(int id2, int rating2)
    {
        id=id2;
        rating=rating2;

    }

    public Integer getId()
    {
        return id;
    }
    public Integer getRating()
    {
        return rating;
    }

}
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-02-06T15:54:04.013

HashMap 不维护任何顺序，因此如果您想要任何排序，则需要将其存储在其他东西中，这是一个映射并且可以具有某种排序，例如 LinkedHashMap

下面是一个简单的程序，您可以通过它按键、值、升序、降序排序..（如果您修改压缩器，您可以对键和值使用任何类型的排序）

```
package com.edge.collection.map;

import java.util.Collections;
import java.util.Comparator;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;

public class SortMapByKeyValue {
Map<String, Integer> map = new HashMap<String, Integer>();

public static void main(String[] args) {

    SortMapByKeyValue smkv = new SortMapByKeyValue();
    smkv.createMap();

    System.out.println("After sorting by key ascending order......");
    smkv.sortByKey(true);

    System.out.println("After sorting by key descindeng order......");
    smkv.sortByKey(false);

    System.out.println("After sorting by value ascending order......");
    smkv.sortByValue(true);

    System.out.println("After sorting by value  descindeng order......");
    smkv.sortByValue(false);

}

void createMap() {
    map.put("B", 55);
    map.put("A", 80);
    map.put("D", 20);
    map.put("C", 70);
    map.put("AC", 70);
    map.put("BC", 70);
    System.out.println("Before sorting......");
    printMap(map);
}

void sortByValue(boolean order) {

    List<Entry<String, Integer>> list = new LinkedList<Entry<String, Integer>>(map.entrySet());
    Collections.sort(list, new Comparator<Entry<String, Integer>>() {
        public int compare(Entry<String, Integer> o1, Entry<String, Integer> o2) {
            if (order) {
                return o1.getValue().compareTo(o2.getValue());
            } else {
                return o2.getValue().compareTo(o1.getValue());

            }
        }
    });
    Map<String, Integer> sortedMap = new LinkedHashMap<String, Integer>();
    for (Entry<String, Integer> entry : list) {
        sortedMap.put(entry.getKey(), entry.getValue());
    }
    printMap(sortedMap);

}

void sortByKey(boolean order) {

    List<Entry<String, Integer>> list = new LinkedList<Entry<String, Integer>>(map.entrySet());
    Collections.sort(list, new Comparator<Entry<String, Integer>>() {
        public int compare(Entry<String, Integer> o1, Entry<String, Integer> o2) {
            if (order) {
                return o1.getKey().compareTo(o2.getKey());
            } else {
                return o2.getKey().compareTo(o1.getKey());

            }
        }
    });
    Map<String, Integer> sortedMap = new LinkedHashMap<String, Integer>();
    for (Entry<String, Integer> entry : list) {
        sortedMap.put(entry.getKey(), entry.getValue());
    }
    printMap(sortedMap);
}

public void printMap(Map<String, Integer> map) {
    // System.out.println(map);
    for (Entry<String, Integer> entry : map.entrySet()) {
        System.out.println(entry.getKey() + " : " + entry.getValue());
    }
}
} 
```

这是git[链接](https://github.com/koushikpaul1/edge/blob/1-branch/java/corejava/OCAP/src/main/java/com/edge/collection/map/SortMapByKeyValue.java)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-03-12T10:04:08.943

使用 pair 类将 hashmap 转换为 ArrayList

```
Hashmap<Object,Object> items = new HashMap<>(); 
```

至

```
List<Pair<Object,Object>> items = new ArrayList<>(); 
```

因此您可以根据需要对其进行排序，或者通过添加顺序进行排序。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-08-27T12:53:20.373

在 Java 中按值对 HashMap 进行排序：

```
public class HashMapSortByValue {
    public static void main(String[] args) {

        HashMap<Long,String> unsortMap = new HashMap<Long,String>();
            unsortMap.put(5l,"B");
            unsortMap.put(8l,"A");
            unsortMap.put(2l, "D");
            unsortMap.put(7l,"C" );

            System.out.println("Before sorting......");
            System.out.println(unsortMap);

            HashMap<Long,String> sortedMapAsc = sortByComparator(unsortMap);
            System.out.println("After sorting......");
            System.out.println(sortedMapAsc);

    }

    public static HashMap<Long,String> sortByComparator(
            HashMap<Long,String> unsortMap) {

            List<Map.Entry<Long,String>> list = new LinkedList<Map.Entry<Long,String>>(
                unsortMap.entrySet());

            Collections.sort(list, new Comparator<Map.Entry<Long,String>> () {
                public int compare(Map.Entry<Long,String> o1, Map.Entry<Long,String> o2) {
                    return o1.getValue().compareTo(o2.getValue());
                }
            });

            HashMap<Long,String> sortedMap = new LinkedHashMap<Long,String>();
            for (Entry<Long,String> entry : list) {
              sortedMap.put(entry.getKey(), entry.getValue());
            }
            return sortedMap;
          }

} 
```

# java - java.io.IOException：参数无效

> ID：780543
> 
> 赞同：3
> 
> 时间：2009-04-23T06:49:07.557
> 
> 标签：java, cluster-computing, ioexception

我有一个使用负载均衡器以集群模式运行的 Web 应用程序。它包含两个只寻址一个 DB 的 tomcat（T1 和 T2）。T2 是安装到 T1 的 nfs。这是两个节点之间唯一的区别。

我有一个生成一些文件的java方法。如果请求在 T1 上运行，则没有问题，但如果请求在节点 2 上运行，则会出现如下异常：

```
java.io.IOException: Invalid argument
        at java.io.FileOutputStream.close0(Native Method)
        at java.io.FileOutputStream.close(FileOutputStream.java:279) 
```

对应的代码如下：

```
for (int i = 0; i < dataFileList.size(); i++) {
    outputFileName = outputFolder + fileNameList.get(i);
    FileOutputStream fileOut = new FileOutputStream(outputFileName);                        
    fileOut.write(dataFileList.get(i), 0, dataFileList.get(i).length);
    fileOut.flush();
    fileOut.close();
} 
```

异常出现在 fileOut.close()

有什么提示吗？

路易斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-06-07T19:07:11.533

`.profile`在解决问题中设置此行：

```
ulimit –n 2048 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T18:36:36.690

dataFileList 和 fileNameList 有多大？您可能用完了文件描述符。不过，奇怪的是它发生在 close() 上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T10:53:09.617

最后我找到了原因。首先，我注意到这个异常并不总是同时出现。

有时是 java.io.IOException: Invalid argument at java.io.FileOutputStream.close0(Native Method) at java.io.FileOutputStream.close(FileOutputStream.java:279) ^^^^^

有时是

```
java.io.IOException: Invalid argument
    at java.io.FileOutputStream.writeBytes(Native Method)
    at java.io.FileOutputStream.write(FileOutputStream.java:260) 
```

因此问题不是 java 问题。甚至不是 NFS 问题。问题**是**底层文件系统类型，它是一个 DRBD 文件系统。

如果一个人正在编写一个小文件，那么在 shell 上进行跨节点写入的测试是可行的。IE：

在 nfs 挂载节点

```
cd /tmp
date > /shared/path-to-some-not-mounted-dir/today

will work 
```

但

```
cat myBigFile > /shared/path-to-some-not-mounted-dir/today 
```

将提供以下错误

```
cat: write error: Invalid argument 
```

因此解决方案是使用其他类型的文件系统，例如 gfs。

# c# - 如何从 ActiveX 控件引发事件

> ID：780545
> 
> 赞同：0
> 
> 时间：2009-04-23T06:50:10.877
> 
> 标签：c#, events

我是 C# 的新手。我正在研究图像处理。我正在创建一个仅在其上添加一个面板的 UserControl (ActiveX)。

当我在另一个应用程序中使用此用户控件时，我如何获得不同的事件。

假设我希望所有 mouseEvents 都发生在我的 userContol 中，那么我如何在我的应用程序中发生鼠标事件。

用户控件如何引发事件以及我如何进入我的应用程序。因为我也需要从我的应用程序中为该事件添加一些功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T13:33:36.243

If I understand your question correctly, then you can reraise the events and hook them up in your other application.

```
public EventHandler<EventArgs> Button1Clicked;
private void button1_Click(object sender, EventArgs e)
{
    if (this.Button1Clicked != null)
    {
        this.Button1Clicked(sender, e);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-09T13:11:43.923

现在我知道了。我必须在我的用户控件上定义一些委托。而且我必须从调用方或我使用该控件的位置附加事件。谢谢爪子。

# internet-explorer - IE 中的动画 GIF 停止

> ID：780560
> 
> 赞同：110
> 
> 时间：2009-04-23T06:53:23.850
> 
> 标签：internet-explorer, gif, animated-gif

有没有人知道在您单击链接或在 IE 中的页面上提交表单后使动画 GIF 继续动画的解决方法？这在其他浏览器中运行良好。

谢谢。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-12-15T02:58:37.303

接受的解决方案对我不起作用。

经过更多研究后，我遇到了[这个解决方法](http://www.webproworld.com/graphics-design-discussion-forum/63262-gif-show-page-loading.html)，它确实有效。

这是它的要点：

```
function showProgress() {
    var pb = document.getElementById("progressBar");
    pb.innerHTML = '<img src="./progress-bar.gif" width="200" height ="40"/>';
    pb.style.display = '';
} 
```

在你的 html 中：

```
<input type="submit" value="Submit" onclick="showProgress()" />
<div id="progressBar" style="display: none;">
    <img src="./progress-bar.gif" width="200" height ="40"/>
</div> 
```

所以在提交表单时，`<img/>`插入了标签，并且由于某种原因它不受ie动画问题的影响。

在 Firefox、ie6、ie7 和 ie8 中测试。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2011-08-22T17:58:28.303

老问题，但将其发布给谷歌同事：

Spin.js 确实适用于这个用例：[http ://fgnass.github.com/spin.js/](http://fgnass.github.com/spin.js/)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-04-23T07:12:01.293

IE 假定单击链接预示着新的导航，当前页面内容将被替换。作为对此进行处理的过程的一部分，它会停止为 GIF 设置动画的代码。我怀疑您可以对此做些什么（除非您实际上没有导航，在这种情况下，请在 onclick 事件中使用 return false ）。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-01-24T08:53:06.400

这是一个 jsFiddle，在使用 method="post" 提交表单时效果很好。在表单提交事件中添加微调器。

```
$("form").bind("submit", onFormSubmit);

function onFormSubmit() {
    setTimeout(showSpinner, 1);
}

function showSpinner() {
    $("body").append($('<img id="spinner" src="spinner.gif" alt="Spinner" />'));
} 
```

[在此处查看 jsFiddle 代码](http://jsfiddle.net/jgqxQ/24/)

[在你的 IE 浏览器中测试它](http://fiddle.jshell.net/jgqxQ/4/show/)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-12-26T17:32:35.380

我遇到了这篇文章，虽然它已经得到了回答，但我觉得我应该发布一些信息来帮助我解决这个特定于 IE 10 的问题，并且可能会帮助其他遇到类似问题的人到达这篇文章。

我很困惑动画 gif 是如何在 IE 10 中不显示的，然后我发现了这个宝石。

`Tools`→ `Internet Options`→ `Advanced`→ `MultiMedia`→`Play animations in webpages`

希望这可以帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-07T19:28:38.043

我在处理表单提交时尝试显示加载 gif 时遇到了这个问题。它增加了一层乐趣，因为同一个 onsubmit 必须运行验证器以确保表单正确。像其他人一样（在互联网上的每个 IE/gif 表单帖子上），我无法让加载微调器在 IE 中“旋转”（并且，在我的情况下，验证/提交表单）。在浏览[http://www.west-wind.com](http://www.west-wind.com/weblog/posts/2004/Dec/27/Animated-GIF-images-in-hidden-page-elements "west-wind.com 见 ev13wt 的帖子")上的建议时，我发现 ev13wt 的一篇帖子表明问题是“...... IE 不会将图像渲染为动画，因为它在渲染时是不可见的。 " 这是有道理的。他的解决方案：

**将 gif 所在的位置留空，并使用 JavaScript 在 onsubmit 函数中设置源 - document.getElementById('loadingGif').src = "path to gif file"。**

这是我实现它的方式：

```
<script type="text/javascript">
    function validateForm(form) {

        if (isNotEmptyid(form.A)) {
            if (isLen4(form.B)) {        
                if (isNotEmptydt(form.C)) {
                    if (isNumber(form.D)) {        
                        if (isLen6(form.E)){
                            if (isNotEmptynum(form.F)) {
                                if (isLen5(form.G)){
                                    document.getElementById('tabs').style.display = "none";                
                                    document.getElementById('dvloader').style.display = "block";                
                                    document.getElementById('loadingGif').src = "/images/ajax-loader.gif"; 
                                    return true;
                                }
                            }
                        }
                    }
                }
            }
        }
        return false;   
    }               
</script>

<form name="payo" action="process" method="post" onsubmit="return validateForm(this)">
    <!-- FORM INPUTS... -->
    <input type="submit" name="submit" value=" Authorize ">

    <div style="display:none" id="dvloader">  
        <img id="loadingGif" src="" alt="Animated Image that appears during processing of document." />
        Working... this process may take several minutes.
    </div>

</form> 
```

这在所有浏览器中对我都很有效！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-01-28T22:42:44.283

这就是我所做的。您所要做的就是将您的 GIF 分解为 10 张图像（在这种情况下，我以 开头`01.gif`和结尾`10.gif`）并指定保存它们的目录。

**HTML：**

```
<div id="tester"></div> 
```

**JavaScript：**

```
function pad2(number) {   
    return (number < 10 ? '0' : '') + number 
}
var 
    dirURL = 'path/to/your/images/folder',
    ajaxLoader = document.createElement('img');
ajaxLoader.className = 'ajax-image-loader';
jQuery(document).ready(function(){
    jQuery('#tester').append(ajaxLoader);
    set(0);
});
function set(i) {
    if (i > 10) i = 1;    
    img.src = dirURL + pad2(i) + '.gif';
    setTimeout(function() {
        set(++i);
    }, 100);    
} 
```

此方法适用于 IE7、IE8 和 IE9（尽管您可以使用 IE9 [`spin.js`](http://fgnass.github.io/spin.js/)）。 **注意：**我没有在 IE6 中对此进行测试，因为我没有运行 60 年代浏览器的机器，尽管该方法非常简单，甚至在 IE6 及更低版本中也可能有效。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-11-20T16:24:14.057

[在http://timexwebdev.blogspot.com/2009/11/html-postback-freezes-animated-gifs.html](http://timexwebdev.blogspot.com/2009/11/html-postback-freezes-animated-gifs.html)找到了这个解决方案，它可以工作！只需在设置为可见之前重新加载图像。从按钮的 onclick 调用以下 Javascript 函数：

```
function showLoader()
{
   //*** Reload the image for IE ***
   document.getElementById('loader').src='./images/loader.gif';
   //*** Let's make the image visible ***
   document.getElementById('loader').style.visibility = 'visible';
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-10-15T15:23:18.757

Building on @danfolkes' answer, this worked for me in IE 8 and ASP.NET MVC3.

In our _Layout.cshtml

```
<body style="min-width: 800px">
    <div id="progress">
        <div style="min-height: 200px">
        </div>
        <div id="throbber">
            <img src="..\..\Content\ajax-loader.gif" alt="Progress" style="display: block;
                margin-left: auto; margin-right: auto" />
        </div>
    </div>
    <div id="main"> 
```

<<< content here >>> ...

```
<script type="text/javascript" language="javascript">
    function ShowThrobber() {
        $('#main').hide();
        $('#progress').show();
        // Work around IE bug which freezes gifs
        if (navigator.appName == 'Microsoft Internet Explorer') {
            // Work around IE bug which freezes gifs
            $("#throbber").html('<img src="../../Content/ajax-loader.gif" alt="Progress" style="display: block; margin-left: auto; margin-right: auto"/>');
         }
</script>
<script type="text/javascript" language="javascript">
    function HideThrobber() {
        $('#main').show();
        $('#progress').hide();
    }
</script>
<script type="text/javascript" language="javascript">
    $(document).ready(function () {
        HideThrobber();
    });
</script> 
```

And in our navigation links:

```
<input type="submit" value="Finish" class="submit-link" onclick="ShowThrobber()"/> 
```

or

```
@Html.ActionLink("DoSometthing", "MyController", new { Model.SomeProperty }, new { onclick = "ShowThrobber()" }) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-09-28T11:21:18.877

与此相关，我必须找到一个修复方法，将动画 gif 用作背景图像，以确保样式保持在样式表中。一个类似的修复在那里也对我有用......我的脚本是这样的（我使用 jQuery 来更容易获得计算的背景样式 - 如何在没有 jQuery 的情况下做到这一点是另一篇文章的主题）：

```
var spinner = <give me a spinner element>

window.onbeforeunload = function() {
  bg_image = $(spinner).css('background-image');
  spinner.style.backgroundImage = 'none';
  spinner.style.backgroundImage = bg_image;
} 
```

[编辑] 通过更多测试，我刚刚意识到这不适用于 IE8 中的背景图像。我一直在尝试一切我能想到的让 IE8 在加载页面时呈现 gif 动画，但目前看起来不可能。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-01-10T10:46:48.833

刚刚有一个类似的问题。这些对我来说非常有用。

```
$('#myElement').prepend('<img src="/path/to/img.gif" alt="My Gif" title="Loading" />');

$('<img src="/path/to/img.gif" alt="My Gif" title="Loading" />').prependTo('#myElement'); 
```

另一个想法是使用 jQuery 的 .load(); 加载然后添加图像。

适用于 IE 7+

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-02-28T17:30:37.037

我意识到这是一个古老的问题，到目前为止，原始发帖人都找到了适合他们的解决方案，但我遇到了这个问题，发现 VML 标签不会成为这个 IE 错误的受害者。使用 VML 标签放置在 IE 浏览器上时，动画 GIF 在页面卸载期间仍会移动。

请注意，在决定使用 VML 标签之前，我首先检测到了 VML，因此这在 FireFox 和其他使用正常动画 GIF 行为的浏览器中工作。

这是我解决这个问题的方法。

```
<input class="myExitButton" type="button" value="Click me"  />

<div class="loadingNextPage" style="display:none" >
    <span style="left:-24px; POSITION: relative; WIDTH: 48px; DISPLAY: inline-block; HEIGHT: 48px" class="spinnerImageVml"><?xml:namespace prefix="rvml" ns = "urn:schemas-microsoft-com:vml" /><rvml:group style="POSITION: absolute; WIDTH: 48px; HEIGHT: 48px; rotation: 1deg" class="rvml" coordsize = "47,47"><rvml:image style="POSITION: absolute; WIDTH: 48px; HEIGHT: 48px; TOP: 0px; LEFT: 0px" class="rvml" src="/images/loading_gray.gif" coordsize="21600,21600"></rvml:image></rvml:group></span>
    <img class="spinnerImage" src="/images/loading_gray.gif" alt="loading..." />
    <div>Just one moment while we access this information...</div>
</div>

<script language="javascript" type="text/javascript">
    window.LoadProgress = (function (progress, $) {

        var getdialogHeight = function (height) {
            var isIE = navigator.userAgent.toLowerCase().indexOf('msie') > -1;
            if (isIE) {
                return height + 'px';
            }
            return height;
        };

        var isVmlSupported = function () {
            var a = document.body.appendChild(document.createElement('div'));
            a.innerHTML = '<v:shape id="vml_flag1" adj="1" />';
            var b = a.firstChild;
            b.style.behavior = "url(#default#VML)";
            var supported = b ? typeof b.adj == "object" : true;
            a.parentNode.removeChild(a);
            return supported;
        };

        var showAnimationDuringPageUnload = function () {
            if (isVmlSupported()) {
                $(".loadingNextPage > .spinnerImage").hide();
            }
            else {
                $(".loadingNextPage > .spinnerImageVml").hide();
            }
        };

        var openLoadingMessage = function () {
            $(".loadingNextPage").dialog({
                modal: true,
                closeOnEscape: true,
                title: 'Please wait...',
                closeText: 'x',
                height: getdialogHeight(200),
                buttons: {
                    "Close": function () {
                        $(this).dialog("close");
                    }
                }
            });
        };

        $('.myExitButton').click(function () {
            openLoadingMessage();
            showAnimationDuringPageUnload();
            window.location.href = 'http://www.stackoverflow.com';
        });

        return progress;
    })(window.LoadProgress || {}, window.jQuery);
</script> 
```

自然，这依赖于 jQuery、jQueryUI 并且需要某种类型的动画 GIF（“/images/loading_gray.gif”）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-07-02T18:59:37.987

查询：

```
$("#WhereYouWantTheImageToAppear").html('<img src="./Animated.gif" />'); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-12-03T14:48:00.367

非常非常晚回答这个问题，但我刚刚发现使用在 CSS 中编码为 base64 URI 的背景图像，而不是作为单独的图像，继续在 IE8 中设置动画。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-03-28T20:19:23.590

一个非常简单的方法是使用 jQuery 和[SimpleModal 插件](http://www.ericmmartin.com/projects/simplemodal/ "SimpleModal 插件")。然后，当我需要在提交时显示我的“加载”gif 时，我会：

```
$('*').css('cursor','wait');
$.modal("<table style='white-space: nowrap'><tr><td style='white-space: nowrap'><b>Please wait...</b></td><td><img alt='Please wait' src='loader.gif' /></td></tr></table>", {escClose:false} ); 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2015-02-02T09:28:53.910

我遇到了同样的问题，这对于其他浏览器（如 Firefox）也很常见。最后我发现在表单提交时动态创建一个带有动画 gif 的元素没有动画，所以我开发了以下工作方法。

1）在`document.ready()`页面中找到的每个表格，接收`position:relative`属性，然后给每个表格附加一个不可见的`DIV.bg-overlay`。

2）在此之后，假设我的网站的每个提交值都由`btn-primary`css 类标识，再次在`document.ready()`，我寻找这些按钮，遍历每个按钮的 FORM 父级，并在表单提交时，我触发`showOverlayOnFormExecution(this,true);`函数，通过单击按钮和切换可见性的布尔值`DIV.bg-overlay`。

```
$(document).ready(function() {

  //Append LOADING image to all forms
  $('form').css('position','relative').append('<div class="bg-overlay" style="display:none;"><img src="/images/loading.gif"></div>');

  //At form submit, fires a specific function
  $('form .btn-primary').closest('form').submit(function (e) {
    showOverlayOnFormExecution(this,true);
  });
}); 
```

CSS for`DIV.bg-overlay`如下：

```
.bg-overlay
{
  width:100%;
  height:100%;
  position:absolute;
  top:0;
  left:0;
  background:rgba(255,255,255,0.6);
  z-index:100;
}

.bg-overlay img
{
  position:absolute;
  left:50%;
  top:50%;
  margin-left:-40px; //my loading images is 80x80 px. This is done to center it horizontally and vertically.
  margin-top:-40px;
  max-width:auto;
  max-height:80px;
} 
```

3) 在任何表单提交时，都会触发以下函数以在其上显示一个半白色背景覆盖（拒绝再次与表单交互的能力）和其中的动画 gif（视觉显示加载操作）。

```
function showOverlayOnFormExecution(clicked_button, showOrNot) 
{
    if(showOrNot == 1)
    {
        //Add "content" of #bg-overlay_container (copying it) to the confrm that contains clicked button 
        $(clicked_button).closest('form').find('.bg-overlay').show();
    }
    else
        $('form .bg-overlay').hide();
} 
```

**在表单提交时显示动画 gif，而不是在此事件中附加它，解决了各种浏览器的“gif 动画冻结”问题**（如前所述，我在 IE 和 Firefox 中发现了这个问题，而不是在 Chrome 中）

# wpf - MVVM - 视图真的需要有一个默认的构造函数吗？

> ID：780561
> 
> 赞同：7
> 
> 时间：2009-04-23T06:53:36.127
> 
> 标签：wpf, mvvm, dependency-injection

我刚刚开始使用 WPF 中的 MVVM 模式，我决定构建我的代码的最优雅的方法是将视图模型注入到视图的构造函数中。

这一切都很好，但是 ReSharper 在 XAML 中给出了一个警告，即我的视图没有默认构造函数。我假设这是为了在需要时可以在 XAML 中构建我的视图，但这只是一个猜测。

通过要求我的视图在构造函数中采用视图模型，我放弃了什么？

**编辑：**我的视图构造函数如下所示：

```
public ExampleView(ExampleViewModel viewModel)
{
    if (viewModel == null) throw new ArgumentNullException("viewModel");
    DataContext = viewModel;
} 
```

**答：**我选择了以下设置，其中 DesignTime 命名空间包含 ViewModel 的模拟版本，用于测试和设计时支持。

*ExampleView.xaml.cs*

```
public ExampleView()
{
    InitializeComponent();
}

public ExampleView(IExampleViewModel viewModel)
    : this()
{
    DataContext = viewModel;
} 
```

*ExampleView.xaml*

```
<UserControl
    x:Class="Wpf.Examples.ExampleView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:DesignTime="clr-namespace:Wpf.Examples.DesignTime">

    <UserControl.DataContext>
        <DesignTime:ExampleViewModel/>
    </UserControl.DataContext>

</UserControl> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T07:01:57.527

正如您正确认识的那样，需要一个非默认构造函数将拒绝您使用 XAML 中的该控件。这也意味着没有更多的设计支持，你的设计师可能会讨厌你。最后你打破了各种漂亮的数据绑定场景。就像将控件用作`ItemTemplate`.

作为**缺少设计支持**的补救措施，我建议实现一个默认构造函数，该构造函数创建一个不需要任何基础设施的模拟视图模型。这样您就可以非常优雅地支持设计模式，并将视图放在 XAML 文件中（例如用于测试）会做一些明智的事情。

作为**缺少数据绑定支持**`DataContext`的补救措施，您应该考虑通过WPF 控件使用视图模型是否更好。这在 WPF 中很常见，而且——据我所知——将模型传递给 WPF 中的视图的预期方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T06:57:22.717

假设您不需要设计师支持，那么我看不出任何理由。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T06:58:55.303

为了保持设计器支持，您需要一个默认构造函数。当您定义自己的构造函数时，您基本上会丢失自动生成的默认构造函数。只需创建一个显式的默认构造函数，就可以了。

# java - 如何扩展由 JAXB、CXF 或 Hibernate 工具生成的 Java 代码？

> ID：780567
> 
> 赞同：18
> 
> 时间：2009-04-23T06:55:25.810
> 
> 标签：java, hibernate, code-generation, jaxb, cxf

使用生成的 Java 源代码，例如

*   使用 Hibernate 工具生成的代码
*   使用 JAXB 模式绑定 (xjc) 生成的代码
*   使用 WDSL2Java (cxf) 生成的代码

所有生成的类都是“值对象”类型，没有业务逻辑。如果我在生成的源代码中添加方法，如果我重复源代码生成，我将失去这些方法。

这些 Java 代码生成工具是否提供了“扩展”生成代码的方法？

例如，

*   覆盖 ToString 方法（用于记录）
*   实现访问者模式（用于数据分析/验证）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-23T09:20:03.327

对于 JAXB，请参阅[添加行为](https://jaxb.java.net/guide/Adding_behaviors.html)。

基本上，您将 JAXB 配置为返回您通常期望的对象的自定义实例。在下面的示例中，您将创建一个扩展 JAXB 对象 Person 的新对象 PersonEx。这种机制运行良好，因为您是从生成的类派生的，根本不改变 JAXB 类或模式。

```
package org.acme.foo.impl;

class PersonEx extends Person {
  @Override
  public void setName(String name) {
    if(name.length()<3) throw new IllegalArgumentException();
    super.setName(name);
  }
}

@XmlRegistry
class ObjectFactoryEx extends ObjectFactory {
  @Override
  Person createPerson() {
    return new PersonEx();
  }
} 
```

请注意，如果您的 JAXB 对象发生更改，@Override 指令很重要——它将防止您的自定义成为*孤立*的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-23T07:41:02.643

至于 Hibernate，您可以调整代码生成中使用的模板文件来改变它们的行为。如果你想调整你可以编辑的 HIbernate 工具，例如：***dao/daohome.ftl***

您甚至可以在编辑***.hbm.xml***文件的“toString()”输出中添加字段

```
...
<property name="note" type="string">
    <meta attribute="use-in-tostring">true</meta>
    <column name="note" />
</property>
... 
```

对于日志记录和验证，您可以考虑将[AOP 与 AspectJ 一起](http://en.wikipedia.org/wiki/AspectJ)使用（我不建议弄乱生成的代码，因为您可能希望多次从头开始构建它）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-23T07:42:49.377

首先，我要重申，修改生成的代码有很多与之相关的问题，应该尽可能避免。也就是说，有时避免或比仅在重新生成代码时处理更改更努力是不切实际的。

遗憾的是，java 不支持 c# 具有的部分类的概念。这些正是为了解决这类问题。

您应该查看您的代码生成工具是否支持某种形式的有意义的注释，这些注释分隔您在类中添加的区域（如果您正在修改代码而不是添加代码，这不太可能并且无济于事）

如果您真的希望这样做，最好的选择是最初生成文件，但立即将它们检入版本控制存储库。然后进行更改，检查。

下次您重新运行工具并让它们覆盖现有文件时，您可以与源代码控制的文件进行比较并将更改合并回来（大多数琐碎的更改，例如添加新列/表将不费吹灰之力。

如果代码生成器突然生成完全不同的代码（比如新版本），这对您没有太大帮助，但在这种情况下，您添加的任何代码，不仅仅是依赖于已经公开公开的数据/方法的附加便利方法）都会有问题不管它是如何混入课堂的。但是，版本控制系统仍然有帮助，因为它还记录*了原始更改*，因此您可以查看之前添加的内容，以及假设您需要以新样式重新创建的内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-23T07:34:46.760

编辑生成的代码文件不是一个好主意，无论是通过编辑文件本身还是通过子类化。无论您做什么，请务必保持该工具创建的签名完好无损，以便将来可以了解该文件是自动生成的。

我建议您研究工具的命令选项，看看它们是否允许您有一定的灵活性。一些工具可以生成抽象类或接口而不是具体类。如果这不可能，请创建一个域对象，其中包含自动生成的对象作为成员变量。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-23T10:06:09.440

我使用 Hibernate 的方式是生成然后扩展的基类。我将我所有的业务逻辑（如果有的话）添加到这些子类中。我还经常最终更改 Hibernate 使用的 FreeMarker 模板以进一步自定义生成的类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T09:59:06.693

AOP 引用是一个很好的引用。我将添加 Spring，它内置了非常好的 AOP 功能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-25T14:10:50.763

看一下

[http://code.google.com/p/jaxb-method-inserter/](http://code.google.com/p/jaxb-method-inserter/)

它是我为 JAXB 编写的一个小插件，使用起来非常简单。希望有帮助

# c# - 在 C# 中四舍五入十进制值

> ID：780570
> 
> 赞同：8
> 
> 时间：2009-04-23T06:56:34.903
> 
> 标签：c#, decimal, numbers, rounding

我如何四舍五入十进制值？
例子 ：

十进制值 =“ 19500.98”

我需要将此值显示到文本框，并像“19501”一样四舍五入

如果十进制值 =“ 19500.43”

然后

值 = " 19500 "

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-23T06:58:28.547

看看[`Math.Round(decimal)`](http://msdn.microsoft.com/en-us/library/3s2d3xkk.aspx)或接受[参数](http://msdn.microsoft.com/en-us/library/ms131274.aspx)[的重载`MidpointRounding`](http://msdn.microsoft.com/en-us/library/ms131274.aspx)。

当然，您需要解析和格式化该值以从/到文本获取它。如果这是用户输入的输入，您可能应该使用`decimal.TryParse`，使用返回值来确定输入是否有效。

```
string text = "19500.55";
decimal value;
if (decimal.TryParse(text, out value))
{
    value = Math.Round(value);
    text = value.ToString();
    // Do something with the new text value
}
else
{
    // Tell the user their input is invalid
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-23T06:58:09.017

数学圆（值，0）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T08:39:57.133

尝试这个...

```
 var someValue=123123.234324243m;
 var strValue=someValue.ToString("#"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T07:06:05.440

```
d = decimal.Round(d); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-17T21:36:57.083

```
string text = "19500.55";
text =(decimal.TryParse(text, out value))? (Math.Round(decimal.Parse(text))).ToString():"Invalid input"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-19T12:24:10.270

```
Total = Math.Ceiling(value) 
```

Reply if it helps you

# c++ - 为什么这个样本有效？

> ID：780580
> 
> 赞同：0
> 
> 时间：2009-04-23T06:58:37.970
> 
> 标签：c++, stl, functor

```
 typedef pair<double, double> dd; 

  const double epsilon = 1e-6;

  struct sort_by_polar_angle { 
    dd center; 
    // Constuctor of any type 
    // Just find and store the center 
    template<typename T> sort_by_polar_angle(T b, T e) { 
        int count = 0;
        center = dd(0,0); 
        while(b != e) { 
                    center.first += b->first;
                    center.second += b->second;
               b++; 
            count++;
        } 
               double k = count ? (1.0/count) : 0;
        center.first *= k;
               center.second *= k;
   } 
   // Compare two points, return true if the first one is earlier 
   // than the second one looking by polar angle 
   // Remember, that when writing comparator, you should 
   // override not ‘operator <’ but ‘operator ()’ 
   bool operator () (const dd& a, const dd& b) const { 
        double p1 = atan2(a.second-center.second, a.first-center.first); 
        double p2 = atan2(b.second-center.second, b.first-center.first); 
        return p1 + epsilon < p2; 
   } 
  }; 

// ... 

vector < dd >  points; 

sort(all(points), sort_by_polar_angle(all(points))); 
```

当 sort_by_polar_angle() 被调用时，它是否起到了构造函数的作用？重载的operator()如何正确使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T07:07:59.930

当你调用函数`sort_by_polar_angle()`时`sort()`，你正在创建一个临时类型的对象`sort_by_polar_angle`（即调用它的构造函数）。在排序算法中，您传递的函子对象使用了类似的东西`functor()`，它将被翻译成`functor.operator()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T09:16:49.837

它不适用于从中心直线上的点。这些的“角度”是相等的，所以它们的顺序是不确定的。对这些点进行排序将返回未确定的结果。

这是因为任何“排序”操作都应该是“严格”的：如果 a < b，则 b > a。（实际上[定义](http://www.sgi.com/tech/stl/StrictWeakOrdering.html)要复杂一些。）

```
dd a0 = { 0, 1 };
dd b0 = { 0, 2 };

assert( sort_by_polar_angle ()( a0, b0 ) && ! sort_by_polar_angle () ( b0, a0 ) ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T02:13:45.047

尝试[在这里](http://www.newty.de/fpt/functor.html)了解函子是什么的基本介绍，或[在谷歌上搜索 c++ 函子](http://www.google.com/search?q=c%2B%2B+functor)。

# c# - 如何让我的 C# 应用程序检查更新？

> ID：780594
> 
> 赞同：37
> 
> 时间：2009-04-23T07:02:52.470
> 
> 标签：c#

我正在构建一个 C# windows 应用程序。我想要它，所以每当我单击表单中的更新按钮时，应用程序都会开始寻找我的服务器上是否有可用的新版本。

如果有则继续更新软件。

这通常是如何处理的？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-23T07:07:12.847

看看[单击一次](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx)。[该线程](https://stackoverflow.com/questions/149718/pitfalls-gotchas-of-click-once-smart-client-deployment-in-net)也可能会引起有趣的阅读。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-06-08T22:48:16.070

首先让我说我们提供了一个完整的更新解决方案，其中包括：

*   用 C# 编写的开源[更新程序 wyUpdate](http://wyday.com/wyupdate/)
*   免费的[AutomaticUpdater 控件](http://wyday.com/wybuild/help/automatic-updates/)，您可以将其添加到 .NET 应用程序的表单中
*   [wyBuild 用于构建补丁](http://wyday.com/wybuild/)和管理您的版本

wyUpdate 可处理所有 Vista/Windows 7 UAC 问题以及在您尝试更新复杂软件时不可避免地出现的所有文件权限问题。

话虽如此，如果您想构建自己的更新程序，这里有一些提示：

## 构建自己的更新程序

一个好的起点是我上面提到的[wyUpdate C# 源代码。](http://wyday.com/wyupdate/)您可以将其蚕食并将其用于您自己的目的。它包含的一些算法：

*   完整的 Windows Vista / Windows 7 UAC 支持
*   有限用户能够检查然后更新他们是否有凭据
*   支持不稳定的企业内部网。（如果您曾经与一家公司合作过，这是一个真正的问题）。
*   快速提取、修补和安装文件。
*   注册表支持。
*   在用户出错或取消时回滚文件和注册表
*   自我更新（不留下任何文件）

我们这里也有[文件规范](http://wyday.com/wyupdate/file-specifications.php)。

## 自动更新

由于自动化是一项要求，让我告诉您我们如何使用[AutomaticUpdater 控件](http://wyday.com/wybuild/help/automatic-updates/)来做到这一点。

我们使用命名管道在独立更新程序 (wyUpdate) 和位于程序窗体上的自动更新程序控件之间进行通信。wyUpdate 向 Automatic Updater 报告进度，Automatic Updater 可以告诉 wyUpdate 取消进度、开始下载、开始解压等。

这使更新程序与您的应用程序分开。

事实上，我们使用的确切命名管道 C# 代码包含在我不久前写的一篇文章中：**[Multi-process C# app like Google Chrome](http://wyday.com/blog/2010/multi-process-c-sharp-application-like-google-chrome-using-named-pipes/)**。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-06-25T06:23:20.363

如果您希望您的应用程序从网站自动更新并自行处理代码，请执行以下步骤：

1.  例如，创建一个具有唯一名称的 XML 文件，`help.xml`并构建一个结构来指定要在特定目录和版本等中更新的文件列表。然后将它们上传到您的网站。

2.  连接到网站后的应用程序下载此`help.xml`文件并读取内容以确保网站上有任何新文件（更新文件）...

3.  如果存在新版本的文件，请从文件中指定的 URL 开始下载`help.xml`！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-23T09:40:16.083

其他答案看起来很棒。

但是，如果您出于某种原因想要自己动手制作，只需将包含更新过程所需信息的 XML 文件（例如当前可用版本的描述和版本号）放在网络服务器的某个位置并使用`HttpWebRequest`（或`HttpWebClient`?) 下载此文件并像处理任何 XML 一样处理。

[我在peSHIr Tweets](http://peshirtweets.peshir.nl/)中使用了这个简单的方法，效果很好。只需在您将新版本在线下载后更新此文件，您的更新检查就会找到它。这个过程的任何内容都可以按照您喜欢的方式进行更改，就像您自己编写的那样。

除非这是一个供您自己娱乐/使用/学习的私人项目 - 就像我的情况一样 -*看看是否有任何可用的东西适合您的需求！*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-28T19:36:04.583

看一下：[Update Checker](https://www.codeproject.com/Tips/5246721/Update-Checker)，我写它是为了展示在 C# 中实现此功能的简单方法。

此 XML 文件管理更新：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<myCoolApp>
    <currentVersion>
        <major>9</major>
        <minor>1</minor>
        <build>5</build>
    </currentVersion>
    <path>http://TestApp.exe</path>
</myCoolApp> 
```

主要函数 Check4Update() 读取 XML 文件并对其进行解析：

```
XmlDocument oDom = new XmlDocument();
oDom.Load(_sXmlConfig);

string str = oDom.SelectSingleNode("//currentVersion/major").InnerText;
Int32.TryParse(str, out _nMajor);

str = oDom.SelectSingleNode("//currentVersion/minor").InnerText;
Int32.TryParse(str, out _nMinor);

str = oDom.SelectSingleNode("//currentVersion/build").InnerText;
Int32.TryParse(str, out _nBuild); 

_sNewVersionPath = oDom.SelectSingleNode("//path").InnerText; 
```

# apache-flex - Selenium Flex API 问题

> ID：780598
> 
> 赞同：0
> 
> 时间：2009-04-23T07:03:46.147
> 
> 标签：apache-flex, api, selenium

嗨，我正在使用 selenium flex API 集成 selenium RC。在启动 Flex 应用程序后，selenium 无法识别登录页面上模块框内的字段。

错误跟踪：

com.thoughtworks.selenium.SeleniumException：错误：错误：在应用程序中找不到元素“logonId”

你能提供一个解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T01:11:01.753

下载 API 的最新版本 (>= 0.2.5)。

这将解决您的问题，因为以前的版本与不同版本的 Selenium IDE 存在兼容性问题。

# performance - 有没有关于 Web 应用程序性能调优的好书？

> ID：780601
> 
> 赞同：0
> 
> 时间：2009-04-23T07:04:56.893
> 
> 标签：performance, optimization, web-applications, caching

我想了解如何有效地使用缓存、优化我的数据库模式和查询、应用分区和负载平衡。有很多关于优化代码和低级东西的资源，但没有其他资源。

我读过[Cal Henderson 的 Building Scalable Web Sites](https://rads.stackoverflow.com/amzn/click/com/0596102356)，除了一章实际上是关于缩放的，这几乎没有触及表面，里面没有什么有趣的。

是否有任何关于 Web 应用程序性能优化的好书或其他资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T08:57:36.250

查看模式和实践指南 - [http://www.codeplex.com/PerfTestingGuide](http://www.codeplex.com/PerfTestingGuide)

如果您使用的是 Oracle 数据库，本指南也可能会有所帮助。
[http://download.oracle.com/docs/cd/B28359_01/server.111/b28274/toc.htm](http://download.oracle.com/docs/cd/B28359_01/server.111/b28274/toc.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T08:54:57.487

听起来你的瓶颈是数据库？是吗？然后阅读[prevayler](http://www.prevayler.org)以确定 RDBMS 是否提供正确的架构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-27T15:21:25.423

当我们谈论 Web 应用程序的性能改进时，必须阅读的两本书是[高性能网站](http://shop.oreilly.com/product/9780596529307.do)和[更快的网站](http://shop.oreilly.com/product/9780596529307.do)，它们都专注于提高网站的加载时间和其他客户端优化技术。

对于数据库方面的事情，您可以查看[SQL 性能调整](https://rads.stackoverflow.com/amzn/click/com/0201791692)。

# hibernate - Hibernate：延迟加载不适用于集合上的一对多映射

> ID：780603
> 
> 赞同：3
> 
> 时间：2009-04-23T07:05:35.597
> 
> 标签：hibernate, spring, spring-mvc

我正在使用 Spring 和 Hibernate 来开发 Liferay 门户服务器的 Portlet。我现在基本上有两个实体，A 和 B，其中 A 可能包含许多 B。所以这就是两者之间的一对多映射。

```
<set cascade="all" lazy="true" name="comments" order-by="creationDate desc">
   <key column="lfpn_pinboardentries_idPinboardEntry" not-null="true"/>
   <one-to-many class="Comment"/>
</set> 
```

在DAO层实体A对应的DAO中，我继承自spring提供的“HibernateDaoSupport”，所以典型的数据检索如下：

```
...
public A getA(long id) {
  return (A) getHibernateTemplate().get(A.class, id);
}
... 
```

如果我有“lazy=false”，一切正常，但是一旦我切换到“lazy=true”，它就会给我以下错误：

*org.hibernate.LazyInitializationException：未能延迟初始化角色集合：com.lifepin.entities.PinboardEntry.comments，没有会话或会话已关闭*

有没有人建议可能是什么问题或提示如何解决它？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T07:28:00.240

如果您在一个请求中加载了对象，通常会收到此错误，然后在不访问延迟加载属性的情况下，将对象保存在会话中。如果您在另一个请求中尝试访问延迟加载的属性，您将收到此异常。

简单地说：最初加载对象的 Hibernate 会话已经关闭。在不同的 Hibernate 会话中访问此对象的延迟加载属性会导致此异常。

您必须将对象重新加载到当前的 Hibernate 会话中才能延迟加载属性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-09T07:39:28.037

关于休眠延迟加载的一个很好的讨论和一个非常有用的解决方案（称为预加载模式）可以在这里找到： [http ://entwickler-forum.de/showthread.php?t=47067](http://entwickler-forum.de/showthread.php?t=47067)

不幸的是，这是一个德国网站。但至少源代码及其文档是英文的。

上述网站的核心思想是提供一个避免加载整个对象图（通过延迟加载）的机会，并明确指定在给定情况下应该加载对象图的哪些部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T07:26:26.783

有些人在使用带有 Spring 框架的休眠时使用 OpenSessionInViewFilter。

它说您应该必须在 web.xml 文件中声明过滤器：

```
<filter>
    <filter-name>openSessionInViewFilter</filter-name>
    <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>openSessionInViewFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

但这并不能解决我的问题。也许我做错了什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T18:28:53.157

这是因为您的 Hibernate 会话在 getHibernateTemplate 方法的某处被关闭，如果您有lazy="true"，则可以在 seesion.open() 和 session.close() 之间实例化关联。lazy="false" 正在工作，因为 Hibernate 在加载 A 时急切地获取关联的 B 对象。

# hash - 哈希图中的最短路径

> ID：780607
> 
> 赞同：0
> 
> 时间：2009-04-23T07:07:38.667
> 
> 标签：hash, map, graph-theory

以下是我存储在哈希图中的数据集，我必须找到两个值之间的最短路径。

```
9244, 4322, 4886, 5989, 8598, 9979, 1447, 9657
8598, 6752, 7146, 1951, 660, 1447, 7779
568, 1951, 4886, 2570, 9026, 9489, 7779
6752, 3424, 1977, 4746, 9657
77 
```

哈希映射的键值是每行的第一个值，其余的是 9244 的假定“朋友”（在每种情况下都相同）。

我以这种格式保存在哈希表中：`hashmap(key, array)`，其中：

*   密钥是例如 9244
*   然后数组保存 [ 4322, 4886, 5989, 8598, 9979, 1447, 9657 ]

如何找到两个键之间的最短路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T07:21:06.310

如果我正确解释了您的问题，那么您说的是有[向图的](http://en.wikipedia.org/wiki/Directed_graph)[最短路径问题](http://en.wikipedia.org/wiki/Shortest_path)。

*   从整数开始，获取它映射到的整数数组。
*   这些整数中的每一个都是新数组的关键。
*   按照这些路径并找到最短的路径。

如果您进行 google 搜索，并查看 Wikipedia 页面，您将能够找到大量对您有帮助的代码示例和算法。

正如 Peter Smit 所提到的，[A*](http://en.wikipedia.org/wiki/A*_search_algorithm)算法是解决这个问题的常见算法。其他包括[Dijkstra's](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)和[Bellman-Ford](http://en.wikipedia.org/wiki/Bellman-Ford_algorithm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T07:19:37.280

您可以实现[A*](http://en.wikipedia.org/wiki/A*_search_algorithm)算法。您可以先从中构建一个图表，然后按照维基百科页面上的伪代码进行操作。

# .net - DbUnit.NET 替代品

> ID：780614
> 
> 赞同：22
> 
> 时间：2009-04-23T07:11:44.163
> 
> 标签：.net

除了 DbUnit.NET 之外，还有其他“用于数据库访问代码的 .NET (2.0) 单元测试框架”吗？

我一直在尝试 DbUnit.NET，但有些东西不受支持。此外，该项目似乎自 2006 年 5 月 22 日以来处于 alpha 阶段......

我们正在重构我们的体系结构，以便能够使用模拟框架进行测试，但在完成这项工作之前，我希望拥有一个像 DbUnit.NET 这样的框架（但更好）。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-08-26T17:08:35.487

我们将[NDbUnit](https://github.com/NDbUnit/NDbUnit)用于我们的一个项目。这是一个比 DbUnit.NET 看起来要活跃得多的项目。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-08-19T18:04:47.087

几年前我遇到了这个问题。我对 DBUnit.Net 的状态感到恼火。它缺少对我很重要的功能。感谢[IKVM](http://www.ikvm.net/)，使用来自 dotnet 的普通 Java 版本的 DBUnit 并不是很困难。事实上，我现在正在运行使用原始 DBUnit 的 C# 集成测试。以下是我将 DBUnit 的 java 版本转换为 .Net 程序集的方法：

*   下载[IKVM](http://www.ikvm.net/)
*   将以下 jar 放入公共目录： commons-collections-3.2.jar commons-logging-1.1.jar junit-4.1.jar commons-lang-2.2.jar dbunit-2.2.jar sqljdbc.jar

现在，从命令行使用公共 jar 目录的工作目录：

```
ikvmc -target:libary -keyfile:yoursignature.snk -debug -version:2.2.0.0 -out:dbunit.dll *.jar 
```

您可以从以下位置获取必要的库：

*   commons-* [Apache Commons](http://commons.apache.org/)
*   dbunit.jar [DbUnit 主页](http://www.dbunit.org/)
*   sqljdbc.jar [MSDN](http://msdn.microsoft.com/en-us/data/aa937724.aspx)
*   junit.jar [Junit主页](http://www.junit.org/)

如果您没有使用 SQL Server 作为数据库，请将 sqljdbc.jar 替换为适当的 JDBC 驱动程序。要直接从您的 .Net 代码中使用 DBUnit，请包含 dbunit.dll 和适当的 IKVM 程序集。

我在这里给出的 jar 版本是旧的。我关于这个主题的笔记已经有将近三年的历史了。较新的版本可能会起作用，但我还没有尝试过。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-11-19T16:28:21.977

考虑[tdunit](http://tdunit.codeplex.com/)：

> TDUnit 是一个类似于 DBUnit.Net 的单元测试实用程序。TDUnit 通过允许测试数据 XML 文件中的依赖值允许您在测试数据库上启用标识列和外键约束，从而帮助单元测试数据库访问。
> 
> TDUnit 使用本质上类似于 DBUnit 的 XML 文件来指定要加载到数据库中的测试数据，但有一个主要区别。TDUnit 允许创建包含标识列和表之间关系的测试数据。例如，在 TDUnit 中，您可以将客户行加载到 Customer 表中，然后在 Order 表中为客户引用自动生成的 ID（身份列）。尽管它是用 C# 3.0 编写的，但只要安装了 .Net Framework 3.5，它就可以从 .Net 2.0 项目中使用。通过在 XML 文件中指定测试数据，测试所需的数据可以与测试一起保存，TDUnit 插入和删除测试数据。这允许您的测试数据库保持空白，从而可以更快地进行更改并更轻松地分发给团队。

~ 来自他们主页上的**项目描述。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-10T19:00:49.290

10 年后，我仍然无法找到任何替代方案，并决定自己编写。

希望它可以帮助某人。库是[Reseed](https://github.com/v-zubritsky/Reseed)，它仍处于开发阶段，但我已经在我的一些项目中使用它，效果很好。

# java - 基于键将 XML 节点合并为一个

> ID：780619
> 
> 赞同：-2
> 
> 时间：2009-04-23T07:12:50.977
> 
> 标签：java, xml

我有一个 XML 文件，其中包含多个具有子节点的节点。如果节点具有相同的键，则必须将它们的子节点合并为一个节点。

```
<availexport>
  <date>090423121513</date>
  <employee emp_cd="9120004">
    <day date="20050406" start="10" end="20"/>
    <day date="20050406" start="21" end="23"/>
    <day date="20050511" start="12" end="23"/>
  </employee>
  <records>3</records>
</availexport> 
```

这里的两条记录具有相同的日期。我怎样才能将它们合并为一个？我有一个作为键/值对的列表。

```
for (int k = this.employeesList.size(); k > 0; k--) {
    Map empInfo1 = new HashMap();
    Map empInfo = (Map) this.employeesList.remove(0);
    this.empID = (Long) empInfo.get(EMP_ID);
    this.hrID = (String) empInfo.get(HR_EMP_ID);
    this.avail_iDate = (Long) empInfo.get(AVAIL_IDATE);
    this.start_ITime = (Long) empInfo.get(START_ITIME);
    this.end_ITime = (Long) empInfo.get(END_ITIME);
    List availList = new ArrayList();
    Map availList1 = new HashMap();
    if (empAvailRecord.containsKey(empID)) {
        empInfo1 = (Map) empAvailRecord.get(empID);
        availList = (List) empInfo1.get("DAY");
        availList1.put(AVAIL_IDATE, avail_iDate);
        availList1.put(START_ITIME, start_ITime);
        availList1.put(END_ITIME, end_ITime);
        availList.add(availList1);
    } else {

        availList1.put(AVAIL_IDATE, avail_iDate);
        availList1.put(START_ITIME, start_ITime);
        availList1.put(END_ITIME, end_ITime);
        availList.add(availList1);

        empInfo1.put("HR_ID", hrID);
        empInfo1.put("DAY", availList);
        empAvailRecord.put(empID, empInfo1);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T07:24:08.597

在将availList1 添加到availList 之前，您应该检查repititions。您可以编写一个遍历availList、获取avail_idate 并将其与您要添加的函数匹配的函数。列表中一般可以有多少记录。因为如果遍历听起来代价高昂，您将需要考虑性能因素。

# c# - 有条件地防止文本框更改

> ID：780632
> 
> 赞同：1
> 
> 时间：2009-04-23T07:17:28.767
> 
> 标签：c#, wpf, textbox, event-handling

我有一个文本框和一个文本块在边框内。TextBlock 的 Text 属性绑定到 TextBox 的值。当我在 TextBox 中键入时，边框会根据 TextBlock 的新大小改变其宽度。

TextBox.TextChanged 有一个事件处理程序，我在其中测试边框的大小是否超过某个数字。如果是这样，我想阻止 TextBox 进行导致处理程序的更改。

如果总是将一个字符添加到末尾，我将能够对文本进行子串化，但可能会发生所有其他类型的更改，例如将大量文本粘贴到 TextBox 中。

那么，防止处理程序更改的方法是什么？我记得在一些 WindowsForms e.Cancel 属性中，设置时会忽略该操作，但在 WPF 中并没有看到，TextChangedEventArgs 显然没有。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-14T23:10:13.447

您可以监听该`PreviewTextInput`事件并设置`e.Handled`为 true 以防止更改生效。

# php - 通过 PHP Web 服务接收文件

> ID：780634
> 
> 赞同：0
> 
> 时间：2009-04-23T07:18:01.560
> 
> 标签：php

我正忙于编写 PHP 网络服务并希望接收作为字节流数组的文件（您可以使用 C# 执行类似的操作）我如何在 PHP 中执行此操作？将 PHP 5 与 NuSOAP 一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T18:51:12.630

也许您只需要发送一个 URI 并且客户端获取文件......不是吗？

您还可以使用 base64 对文件进行编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T15:17:02.260

php流呢？我以前在 C# 中使用过流，而不是在 php 中，但似乎它应该可以工作:)

查看 [此演示文稿](http://www.slideshare.net/wezfurlong/php-streams-lucky-dip)（从幻灯片 18 开始）

祝你好运 ！

# performance - Oracle 数据库性能相关

> ID：780639
> 
> 赞同：1
> 
> 时间：2009-04-23T07:20:14.610
> 
> 标签：performance, oracle

我目前正在研究 9.2.0.8 Oracle 数据库。我有一些与数据库性能相关的问题，这些问题也与重做日志锁存器和争用有关。来自实际实践的答案将不胜感激。请帮忙。

1.  我的数据目前有 25 个重做日志文件，每个文件中有 2 个成员。每个成员的大小为 100m。那么这是否值得保留 25 个重做日志文件，每个文件有 2 个成员（每个 100MB）。
2.  我的数据库是 24*7，最小用户为 275，最大用户为 650。我的数据库主要有 SELECT，但很少有 INSERT/UPDATE/DELETE。从 1 个月开始，我开始注意到我的数据库正在生成平均 17GB 到 MAX 的 28GB 的​​档案。但是 LOGSWITCH 平均每 5-10 分钟发生一次。有时更频繁。甚至一分钟内3次。但我的 SPFILE 说 log_checkpoint_timeout=1800（30 分钟）。
3.  关于重做日志闩锁和争用，当我发出：- SELECT name, value FROM v$sysstat WHERE name = 'redo log space requests'; 输出：-

    ```
     NAME                                                               VALUE
        -------------------------------------------------------------------- ----------
         redo log space requests                                               20422
    (This value is getting increased day by day) 
    ```

4.  Oracle 建议让重做日志空间请求接近于零。
5.  所以我想知道为什么我的数据库经常进行日志切换。这是因为数据还是因为其他原因。
6.  我的疑问是，如果我增加 REDO LOG 缓冲区，问题可能会解决。我将重做日志缓冲区从 8MB 增加到 11MB。但我没有发现太大的区别。
7.  如果我将 REDO LOG FILE 的大小从 100MB 增加到 200MB，会有帮助吗？它会帮助我减少日志切换时间并使 REDO LOG SPACE REQUEST 的值接近于零。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T11:43:22.170

关于您提供的信息的某些内容并没有加起来 - 如果您真的生成大约 20G/分钟的存档日志，那么您将每分钟至少切换 200 次 100M 日志文件 - 而不是 3 次/分钟的最坏情况你提到的。这也与您对“......主要是SELECT”的描述不一致。

在现实世界中，我不会担心平均每 5-10 分钟切换一次日志。有了这么多的重做，没有任何 init 参数在切换时发挥作用——这是因为在线重做日志填满了。在这种情况下，控制切换率的唯一方法是调整日志大小，例如，将日志大小加倍会将切换频率降低一半。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T16:01:40.680

查看哪些会话正在生成大量重做，以及哪些会话在重做日志空间中等待的时间最长，这可能会有所帮助。

```
SQL> l
  1  select name, sid, value
  2  from v$sesstat s, v$statname n
  3  where name in ('redo size','redo log space requests')
  4   and n.statistic# = s.statistic#
  5  and value > 0
  6* order by 1,2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T08:45:35.140

每分钟 17GB 的日志文件对我来说似乎相当高。也许您数据库中的某个表空间仍处于在线备份模式。

# asp.net-mvc - asp.net mvc Html.ActionLink() 保持路由值我不想要

> ID：780643
> 
> 赞同：46
> 
> 时间：2009-04-23T07:21:26.807
> 
> 标签：asp.net-mvc, actionlink

我认为我有以下 ActionLink

```
<%= Html.ActionLink("LinkText", "Action", "Controller"); %> 
```

它会创建以下 URL [http://mywebsite.com/Controller/Action](http://mywebsite.com/Controller/Action)

假设我在末尾添加了一个 ID，如下所示：http: [//mywebsite.com/Controller/Action/53](http://mywebsite.com/Controller/Action/53)并导航到该页面。在此页面上，我有上面指定的标记。现在，当我查看它创建的 URL 时，它看起来像这样：

[http://mywebsite.com/Controller/Action/53](http://mywebsite.com/Controller/Action/53)（注意添加ID）

但我希望它删除 ID 并看起来像原来一样，就像这个[http://mywebsite.com/Controller/Action](http://mywebsite.com/Controller/Action)（注意这里没有 ID）

有什么想法可以解决这个问题吗？我不想使用硬编码的 URL，因为我的控制器/操作可能会改变。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-04-23T21:17:57.377

解决方法是指定我自己的路由值（下面的第三个参数）

```
<%= Html.ActionLink("LinkText", "Action", "Controller", 
    new { id=string.Empty }, null) %> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-04-28T14:57:33.987

听起来您需要注册第二个“仅操作”路由并使用 Html.RouteLink()。首先在您的应用程序启动中注册这样的路由：

```
routes.MapRoute("ActionOnly", "{controller}/{action}", 
   new { controller = "Home", action = "Index" } ); 
```

然后使用 ActionLink 代替创建这些链接：

```
Html.RouteLink("About","ActionOnly") 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-23T08:38:40.927

问题是内置方法从您当前所在的 URL 以及您提供的内容中获取输入。你可以试试这个：

```
<%= Html.ActionLink("LinkText", "Action", "Controller", new { id = ""}) %> 
```

那应该手动擦除 id 参数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-21T13:03:31.740

不知道为什么，但它对我不起作用（可能是因为 Mvc2 RC）。创建 urlhelper 方法 =>

```
 public static string
            WithoutRouteValues(this UrlHelper helper, ActionResult action,params string[] routeValues)
        {
            var rv = helper.RequestContext.RouteData.Values;
            var ignoredValues = rv.Where(x=>routeValues.Any(z => z == x.Key)).ToList();
            foreach (var ignoredValue in ignoredValues)
                rv.Remove(ignoredValue.Key);
            var res = helper.Action(action);
            foreach (var ignoredValue in ignoredValues)
                rv.Add(ignoredValue.Key, ignoredValue.Value);
            return res;
        } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-08-21T17:21:08.007

如果您不知道需要显式覆盖哪些值，或者您只是想避免额外的参数列表，您可以使用如下所示的扩展方法。

```
<a href="@Url.Isolate(u => u.Action("View", "Person"))">View</a> 
```

实现细节[在这篇博文中](http://blog.greatrexpectations.com/?p=622)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-07-30T14:06:07.467

我明确地将动作名称设置为“动作/”。看起来有点像黑客，但它是一个快速修复。

```
@Html.ActionLink("Link Name", "Action/", "Controller") 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-08-26T13:25:08.857

另一种方法是使用ActionLink(HtmlHelper, String, String, RouteValueDictionary) 重载，那么就不需要在最后一个参数中放入null

```
<%= Html.ActionLink("Details", "Details", "Product", new RouteValueDictionary(new { id=item.ID })) %> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-14T19:03:39.297

Html.ActionLink 的重载在 MVC 的更高版本上有所更改。在 MVC 5 及更高版本上。这是如何做到这一点：

```
@Html.ActionLink("LinkText", "Action", "Controller", new { id = "" }, null) 
```

注意我为 id 参数传递了“”，为 HTMLATTRIBUTES 传递了 null。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-27T22:08:14.080

我需要我的菜单链接是动态的。我没有为每个页面实现大量额外的代码和路由，而是简单地省去了 HTML 帮助程序。

```
<a href="@(item.websiteBaseURL)/@(item.controller)/@(item.ViewName)">@item.MenuItemName</a> 
```

# windows-vista - 是否可以在 VISTA 中静默运行 NSIS 安装程序？

> ID：780645
> 
> 赞同：0
> 
> 时间：2009-04-23T07:21:48.163
> 
> 标签：windows-vista, installation, uac, nsis

我制作了一个更新程序，它在 XP 中静默运行并且运行良好。但是当谈到 Vista 时，当 UAC 提示用户取消或允许用户运行程序时，静默安装的想法就被破坏了。

我们有什么可以做的吗？

谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-18T19:51:56.663

我知道这篇文章已经过时了……确切地说是 4 个月。但实际上，是的，这是非常可能的。我想纠正上面的人。

只需将此行添加到您的 NSIS 脚本中。

请求执行级别用户

这一行告诉 Windows Vista 和 Windows 7 该程序不需要管理员访问权限，这是 Vista/7 所认为的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T07:24:42.713

不幸的是，没有办法解决这个问题。UAC 实际上是专门用于防止这种类型的事情，即程序在用户不知情的情况下安装软件或对机器进行更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T07:36:44.883

这实际上是 UAC 和用户权限的副作用。从安全的角度来看，这确实是有道理的。

如果这是您需要做的事情，您应该寻求实现一个系统，该系统旨在以提升的权限运行补丁和部署。微软自己的系统管理服务器可以解决问题，但显然是一个相当大规模的解决方案！

你可以在[这里](http://www.microsoft.com/SMServer/default.mspx)阅读。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T22:50:35.313

用于非 MSI 安装的 UAC 是一个灰色地带，使用签名的 MSI 软件包让用户变得更容易和更少困惑。

您可能想看看[Clickonce Deployment](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx)，它*可能会*解决您的一些问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T00:36:26.527

实际上，这是可能的，在非常先入为主的情况下。具体来说，“服务”可以在用户会话中以完全权限启动安装程序并绕过 UAC 提示（已经有）。

当然，这要求您的用户已经安装了您的服务，这确实需要管理员批准。

# mysql - 在端口 3306 上的 MAMP 上运行 MySQL 有什么好处？

> ID：780649
> 
> 赞同：1
> 
> 时间：2009-04-23T07:24:22.400
> 
> 标签：mysql, macos, mamp

我在尝试在我的 Mac 上安装 MySQL 时遇到了很多问题，所以我放弃并安装了 MAMP。

MAMP 将其 Apache 和 MySQL 版本设置为使用端口 8888 和 8889。许多 MAMP 教程[（例如这个）](http://seansperte.com/entry/Setting_Up_a_Killer_Local_Web_Development_Environment_on_a_Mac_with_MAMP_an/)提到您应该将 MAMP 的 Apache 和 MySQL 端口设置为默认值 80 和 3306，但它们没有提及原因（除了[http://localhost:8888/](http://localhost:8888/)变成[http://localhost](http://localhost)）。

Apache 和 MySQL 使用 MAMP 的默认值似乎可以正常启动，并且我可以让 Apache 在端口 80 下启动，但是当我尝试将其设置为端口 3306 时 MySQL 不会启动。我认为这与幻像有关我尝试安装并废弃的 MySQL 的安装（但我可能是错的）。

您是否预见到我可能正在运行 MySQL 的虚拟实例这一事实存在问题，或者这是一个单独的问题？将 MySQL 设置为在 3306 下运行是否重要，或者我应该将其保留在 8889 并继续前进？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T07:28:01.800

你可以把它留在8889上。重要的是，在你的连接字符串中你指定了新的mysql端口，所以php会知道它必须连接到哪里

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T09:25:18.633

任何服务器应用程序都可以在任何端口上运行。

警告是：

1.  在小于 1024 的端口上运行需要您具有 root 权限
2.  如果使用的端口是“非标准”的，则需要更新客户端配置。在标准端口上运行通常允许省略端口字段
3.  SOHO 防火墙可能对可以配置的自定义“服务”的数量有限制，但通常有一个不错的已知服务列表

# asp.net - 在 asp.net 中打开 pdf 文档

> ID：780657
> 
> 赞同：0
> 
> 时间：2009-04-23T07:27:15.407
> 
> 标签：asp.net, pdf

我需要一个免费的控件来控制我的asp.net页面，它可以显示pdf文档，这样客户端就可以查看pdf文件而无需安装任何pdf。我尝试在谷歌搜索，但我得到的只是 Windows 应用程序。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T13:10:59.493

我认为您必须将 pdf 转换为没有 acrobat reader 的浏览器可以显示的内容。

试用[适用于 .NET 的动态 PDF 光栅器](http://www.cete.com/Products/DynamicPDFRasterizerforNET/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-20T23:41:59.740

您的意思是允许在未安装 PDF 阅读器插件的客户端上查看 PDF？

我正在研究一个相关主题，并在 SO 上遇到了同样的问题：

[.net 上的 PDF 查看器](https://stackoverflow.com/questions/1593669/pdf-viewer-on-the-net/1597886#1597886)

我为我在 CodeProject 上找到的一个组件提供了答案。如果您仍然感兴趣，请查看它。

# python - Python 基类方法调用：意外行为

> ID：780670
> 
> 赞同：5
> 
> 时间：2009-04-23T07:31:02.073
> 
> 标签：python, inheritance, dictionary

为什么在下面的示例中`str(A())`看似调用`A.__repr__()`而不是调用`dict.__str__()`？

```
class A(dict):
    def __repr__(self):
        return 'repr(A)'
    def __str__(self):
        return dict.__str__(self)

class B(dict):
    def __str__(self):
        return dict.__str__(self)

print 'call: repr(A)  expect: repr(A)  get:', repr(A())   # works
print 'call: str(A)   expect: {}       get:', str(A())    # does not work
print 'call: str(B)   expect: {}       get:', str(B())    # works 
```

输出：

```
call: repr(A)  expect: repr(A)  get: repr(A)
call: str(A)   expect: {}       get: repr(A)
call: str(B)   expect: {}       get: {} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-23T07:58:52.880

`str(A())`确实调用`__str__`，依次调用`dict.__str__()`。

它`dict.__str__()`返回值 repr(A)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T08:14:37.413

我已经修改了代码以清除内容：

```
class A(dict):
   def __repr__(self):
      print "repr of A called",
      return 'repr(A)'
   def __str__(self):
      print "str of A called",
      return dict.__str__(self)

class B(dict):
   def __str__(self):
      print "str of B called",
      return dict.__str__(self) 
```

输出是：

```
>>> print 'call: repr(A)  expect: repr(A)  get:', repr(A())
call: repr(A)  expect: repr(A)  get: repr of A called repr(A)
>>> print 'call: str(A)   expect: {}       get:', str(A())
call: str(A)   expect: {}       get: str of A called repr of A called repr(A)
>>> print 'call: str(B)   expect: {}       get:', str(B())
call: str(B)   expect: {}       get: str of B called {} 
```

这意味着 str 函数会自动调用 repr 函数。并且由于它是用类 A 重新定义的，因此它返回“意外”值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-02T04:58:58.533

我已经发布了一个解决方法。检查出来......你可能会发现它很有用：http: [//blog.teltub.com/2009/10/workaround-solution-to-python-strrepr.html](http://blog.teltub.com/2009/10/workaround-solution-to-python-strrepr.html)

PS阅读我介绍问题的原始帖子......问题是让你措手不及的意外行为......

# sql - 土耳其语 SQL 排序规则的问题（土耳其语“I”）

> ID：780671
> 
> 赞同：5
> 
> 时间：2009-04-23T07:31:05.023
> 
> 标签：sql, sql-server, collation, turkish

我在将我们的 MSSQL 数据库设置为任何土耳其排序规则时遇到问题。由于“土耳其语 I”问题，我们的查询中没有一个包含“i”的查询正常工作。例如，如果我们有一个名为“Unit”的表，其中定义了列“UnitID”，则查询“select unitid from unit”不再有效，因为“id”中的小写“i”与定义的大写字母不同我在“UnitID”中。错误消息将显示“无效的列名 'unitid'”。

我知道这是因为在土耳其语中，字母 i 和 I 被视为不同的字母。但是，我不确定如何解决此问题？遍历数据库中的所有 1900 SP 并更正“i”的大小写不是一种选择。

任何帮助将不胜感激，甚至可以使用其他排序规则来代替土耳其语但会支持其字符集的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T19:08:46.377

事实证明，最好的解决方案实际上是重构所有 SQL 和代码。

在过去的几天里，我编写了一个重构应用程序来修复所有存储过程、函数、视图、表名以保持一致并使用正确的大小写，例如：

```
select unitid from dbo.unit 
```

将更改为

```
select UnitId from dbo.Unit 
```

然后，该应用程序还检查代码并替换存储过程及其参数的任何出现，并更正它们以匹配数据库中定义的案例。应用程序中的所有数据表都设置为不变的区域设置（感谢 FXCop 指出所有数据表..），这可以防止代码中的调用必须区分大小写。

如果有人想要该应用程序或对流程有任何建议，您可以通过 dotnetvixen@gmail.com 与我联系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T10:12:22.950

我在土耳其语支持下开发了这么多系统，正如您所说，这是众所周知的问题。

将数据库设置更改为 UTF-8 的最佳实践，就是这样。它应该解决所有问题。

如果您想在 (ı-I,i-İ) 中支持区分大小写，那么您可能会遇到问题，而这在 SQL Server 中可能难以支持。如果整个入口来自 Web，请确保也是 UTF-8。

如果您将 Web UTF-8 输入和 SQL Server 设置保持为 UTF-8，那么一切都会顺利进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T07:52:34.720

也许我不明白这里的问题，但这不是因为数据库区分大小写而您的查询不是吗？例如，在 Sybase 上，我可以执行以下操作：

```
USE master
GO
EXEC sp_server_info 16
GO 
```

这告诉我我的数据库不区分大小写：

```
attribute_id   attribute_name     attribute_value 
          16   IDENTIFIER_CASE    MIXED 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T08:04:35.627

如果您可以更改正在使用的排序规则，请尝试使用 Invariant 语言环境。但请确保您不会影响其他内容，例如客户姓名和地址。如果客户习惯于搜索自己的姓名时不区分大小写，如果 ı 和 I 不再等价，或者 i 和 İ 不再等价，他们将不会喜欢这种做法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T08:07:56.727

您能否将数据库排序规则更改为默认值：这将使您的所有文本列都使用土耳其语排序规则？

查询将起作用，但数据将正常运行。理论上...

临时表和带有 varchar 列的表变量有一些陷阱：您必须向这些添加 COLLATE 子句

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T10:05:52.047

我意识到您不想通过所有存储过程来解决问题，但也许您可以使用重构工具来解决问题。我说看看[SQL Refactor](http://www.red-gate.com/products/SQL_Refactor/index.htm)。我没有使用它，但看起来很有希望。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-05T11:55:07.437

将机器的区域设置更改为英语（美国）完全可以节省一天的时间！

# qt - 我怎样才能在 QDateEdit 中度过一天？

> ID：780673
> 
> 赞同：3
> 
> 时间：2009-04-23T07:31:39.263
> 
> 标签：qt, pyqt

标准行为是，只要一天达到 31，升压按钮就会停止工作。我希望它重置为 1 并跳转到下个月。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T11:42:44.463

我没有机会对此进行测试，但我知道 QDateEdit 实现了 QAbstractSpinBox，因此您应该可以调用

```
myDateEdit.setWrapping(True) 
```

这应该完成你想要的。

[文档链接](http://doc.trolltech.com/4.4/qabstractspinbox.html#wrapping-prop)

更新：

这种行为的术语显然被称为“翻转”，这是一个人的实现，（同样，我没有测试过）似乎是另一种潜在的解决方案：

[翻转QDate编辑](http://www.qtcentre.org/forum/f-qt-programming-2/t-qdateedit-monthday-rollover-11139-post59196.html#post59196)

他指出，他的实施没有考虑最小或最大日期。

# c - 弹性词法分析器的字符串输入

> ID：780676
> 
> 赞同：59
> 
> 时间：2009-04-23T07:34:04.313
> 
> 标签：c, bison, yacc, lex, flex-lexer

我想使用 flex/bison 解析器创建一个 read-eval-print 循环。麻烦的是，flex 生成的词法分析器需要 FILE* 类型的输入，我希望它是 char*。有没有办法做到这一点？

一个建议是创建一个管道，向它提供字符串并打开文件描述符并发送到词法分析器。这相当简单，但感觉很复杂，而且不是很独立于平台。有没有更好的办法？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-04-23T08:10:37.797

以下例程可用于设置输入缓冲区以扫描内存中的字符串而不是文件（如 yy_create_buffer 所做的那样）：

*   `YY_BUFFER_STATE yy_scan_string(const char *str)`: 扫描一个以 NUL 结尾的字符串`
*   `YY_BUFFER_STATE yy_scan_bytes(const char *bytes, int len)`：从位置字节开始扫描 len 个字节（可能包括 NUL）

请注意，这两个函数都创建并返回相应的 YY_BUFFER_STATE 句柄（完成后必须使用 yy_delete_buffer() 将其删除），因此 yylex() 会扫描字符串或字节的副本。这种行为可能是可取的，因为 yylex() 修改了它正在扫描的缓冲区的内容）。

如果你想避免使用复制（和 yy_delete_buffer）：

*   `YY_BUFFER_STATE yy_scan_buffer(char *base, yy_size_t size)`

样品主要：

```
int main() {
    yy_scan_buffer("a test string");
    yylex();
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-23T07:38:53.880

有关如何扫描内存缓冲区（例如字符串）的信息，请参阅Flex 手册的[这一部分。](http://westes.github.io/flex/manual/Multiple-Input-Buffers.html#Scanning-Strings)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-05-08T15:16:48.873

**flex**`char *`可以使用以下三个函数中的任何一个进行解析： `yy_scan_string()`、 `yy_scan_buffer()`和`yy_scan_bytes()`（请参阅[文档](http://westes.github.io/flex/manual/Multiple-Input-Buffers.html#Scanning-Strings)）。这是第一个示例：

```
typedef struct yy_buffer_state * YY_BUFFER_STATE;
extern int yyparse();
extern YY_BUFFER_STATE yy_scan_string(char * str);
extern void yy_delete_buffer(YY_BUFFER_STATE buffer);

int main(){
    char string[] = "String to be parsed.";
    YY_BUFFER_STATE buffer = yy_scan_string(string);
    yyparse();
    yy_delete_buffer(buffer);
    return 0;
} 
```

的等效语句`yy_scan_buffer()`（需要一个以空字符结尾的双字符串）：

```
char string[] = "String to be parsed.\0";
YY_BUFFER_STATE buffer = yy_scan_buffer(string, sizeof(string)); 
```

我的回答重申了@dfa 和@jlholland 提供的一些信息，但他们的答案代码似乎都不适合我。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-02-15T21:05:15.647

这是我需要做的：

```
extern yy_buffer_state;
typedef yy_buffer_state *YY_BUFFER_STATE;
extern int yyparse();
extern YY_BUFFER_STATE yy_scan_buffer(char *, size_t);

int main(int argc, char** argv) {

  char tstr[] = "line i want to parse\n\0\0";
  // note yy_scan_buffer is is looking for a double null string
  yy_scan_buffer(tstr, sizeof(tstr));
  yy_parse();
  return 0;
} 
```

你不能extern typedef，当你考虑它时这是有道理的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-03-27T23:33:56.803

接受的答案不正确。它会导致内存泄漏。

在内部，yy_scan_string 调用 yy_scan_bytes，后者又调用 yy_scan_buffer。

yy_scan_bytes 为输入缓冲区的副本分配内存。

yy_scan_buffer 直接作用于提供的缓冲区。

对于所有三种形式，您必须调用 yy_delete_buffer 来释放 flex 缓冲区状态信息 (YY_BUFFER_STATE)。

但是，使用 yy_scan_buffer，您可以避免内部缓冲区的内部分配/复制/释放。

yy_scan_buffer 的原型不采用 const char* 并且您不能期望内容保持不变。

如果你分配内存来保存你的字符串，你有责任在调用 yy_delete_buffer 之后释放它。

另外，当你解析这个字符串时，不要忘记让 yywrap 返回 1（非零）。

下面是一个完整的例子。

```
%%

<<EOF>> return 0;

.   return 1;

%%

int yywrap()
{
    return (1);
}

int main(int argc, const char* const argv[])
{
    FILE* fileHandle = fopen(argv[1], "rb");
    if (fileHandle == NULL) {
        perror("fopen");
        return (EXIT_FAILURE);
    }

    fseek(fileHandle, 0, SEEK_END);
    long fileSize = ftell(fileHandle);
    fseek(fileHandle, 0, SEEK_SET);

    // When using yy_scan_bytes, do not add 2 here ...
    char *string = malloc(fileSize + 2);

    fread(string, fileSize, sizeof(char), fileHandle);

    fclose(fileHandle);

    // Add the two NUL terminators, required by flex.
    // Omit this for yy_scan_bytes(), which allocates, copies and
    // apends these for us.   
    string[fileSize] = '\0';
    string[fileSize + 1] = '\0';

    // Our input file may contain NULs ('\0') so we MUST use
    // yy_scan_buffer() or yy_scan_bytes(). For a normal C (NUL-
    // terminated) string, we are better off using yy_scan_string() and
    // letting flex manage making a copy of it so the original may be a
    // const char (i.e., literal) string.
    YY_BUFFER_STATE buffer = yy_scan_buffer(string, fileSize + 2);

    // This is a flex source file, for yacc/bison call yyparse()
    // here instead ...
    int token;
    do {
        token = yylex(); // MAY modify the contents of the 'string'.
    } while (token != 0);

    // After flex is done, tell it to release the memory it allocated.    
    yy_delete_buffer(buffer);

    // And now we can release our (now dirty) buffer.
    free(string);

    return (EXIT_SUCCESS);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-16T05:16:21.883

否则，您可以在 lex 文件中重新定义函数 YY_INPUT，然后将您的字符串设置为 LEX 的输入。如下：

```
#undef YY_INPUT
#define YY_INPUT(buf) (my_yyinput(buf))

char my_buf[20];

void set_lexbuf(char *org_str)
{  strcpy(my_buf, org_str);  }

void my_yyinput (char *buf)
{  strcpy(buf, my_buf);      } 
```

在你的 main.c 中，在扫描之前，你需要先设置 lex 的缓冲区：

```
set_lexbuf(your_string);
scanning... 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-06-24T10:29:04.200

这是一个小例子，用于在你的 cpp 代码中使用 bison / flex 作为解析器来解析字符串并根据它更改字符串值（代码的少数部分已被删除，因此那里可能有不相关的部分。） parser.y ：

```
%{
#include "parser.h"
#include "lex.h"
#include <math.h> 
#include <fstream>
#include <iostream> 
#include <string>
#include <vector>
using namespace std;
 int yyerror(yyscan_t scanner, string result, const char *s){  
    (void)scanner;
    std::cout << "yyerror : " << *s << " - " << s << std::endl;
    return 1;
  }
    %}

%code requires{
#define YY_TYPEDEF_YY_SCANNER_T 
typedef void * yyscan_t;
#define YYERROR_VERBOSE 0
#define YYMAXDEPTH 65536*1024 
#include <math.h> 
#include <fstream>
#include <iostream> 
#include <string>
#include <vector>
}
%output "parser.cpp"
%defines "parser.h"
%define api.pure full
%lex-param{ yyscan_t scanner }
%parse-param{ yyscan_t scanner } {std::string & result}

%union {
  std::string *  sval;
}

%token TOKEN_ID TOKEN_ERROR TOKEN_OB TOKEN_CB TOKEN_AND TOKEN_XOR TOKEN_OR TOKEN_NOT
%type <sval>  TOKEN_ID expression unary_expression binary_expression
%left BINARY_PRIO
%left UNARY_PRIO
%%

top:
expression {result = *$1;}
;
expression:
TOKEN_ID  {$$=$1; }
| TOKEN_OB expression TOKEN_CB  {$$=$2;}
| binary_expression  {$$=$1;}
| unary_expression  {$$=$1;}
;

unary_expression:
 TOKEN_NOT expression %prec UNARY_PRIO {result =  " (NOT " + *$2 + " ) " ; $$ = &result;}
;
binary_expression:
expression expression  %prec BINARY_PRIO {result = " ( " + *$1+ " AND " + *$2 + " ) "; $$ = &result;}
| expression TOKEN_AND expression %prec BINARY_PRIO {result = " ( " + *$1+ " AND " + *$3 + " ) "; $$ = &result;} 
| expression TOKEN_OR expression %prec BINARY_PRIO {result = " ( " + *$1 + " OR " + *$3 + " ) "; $$ = &result;} 
| expression TOKEN_XOR expression %prec BINARY_PRIO {result = " ( " + *$1 + " XOR " + *$3 + " ) "; $$ = &result;} 
;

%%

lexer.l : 

%{
#include <string>
#include "parser.h"

%}
%option outfile="lex.cpp" header-file="lex.h"
%option noyywrap never-interactive
%option reentrant
%option bison-bridge

%top{
/* This code goes at the "top" of the generated file. */
#include <stdint.h>
}

id        ([a-zA-Z][a-zA-Z0-9]*)+
white     [ \t\r]
newline   [\n]

%%
{id}                    {    
    yylval->sval = new std::string(yytext);
    return TOKEN_ID;
}
"(" {return TOKEN_OB;}
")" {return TOKEN_CB;}
"*" {return TOKEN_AND;}
"^" {return TOKEN_XOR;}
"+" {return TOKEN_OR;}
"!" {return TOKEN_NOT;}

{white};  // ignore white spaces
{newline};
. {
return TOKEN_ERROR;
}

%%

usage : 
void parse(std::string& function) {
  string result = "";
  yyscan_t scanner;
  yylex_init_extra(NULL, &scanner);
  YY_BUFFER_STATE state = yy_scan_string(function.c_str() , scanner);
  yyparse(scanner,result);
  yy_delete_buffer(state, scanner);
  yylex_destroy(scanner);
  function = " " + result + " ";  
}

makefile:
parser.h parser.cpp: parser.y
    @ /usr/local/bison/2.7.91/bin/bison -y -d parser.y

lex.h lex.cpp: lexer.l
    @ /usr/local/flex/2.5.39/bin/flex lexer.l

clean:
    - \rm -f *.o parser.h parser.cpp lex.h lex.cpp 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-08T08:17:27.987

libmatheval 中有一段有趣的代码：

```
/* Redefine macro to redirect scanner input from string instead of
 * standard input.  */
#define YY_INPUT( buffer, result, max_size ) \
{ result = input_from_string (buffer, max_size); } 
```

# asp.net - 如何从 pdf 文件中删除或禁用超链接事件？

> ID：780678
> 
> 赞同：2
> 
> 时间：2009-04-23T07:34:08.760
> 
> 标签：asp.net, pdf

`byte[]`我可以在 asp.net 中显示 PDF 文件。

问题是它包含超链接，我想禁用或删除这些超链接事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T19:26:45.320

我参与的库[Docotic.Pdf可用于在 PDF 中查找超链接并删除它们。](https://bitmiracle.com/pdf-library/)

这是执行此操作的示例代码：

```
public static void RemoveHyperlinks(string inputFile, string outputFile)
{
    using (PdfDocument doc = new PdfDocument(inputFile))
    {
        foreach (PdfPage page in doc.Pages)
        {
            for (int i = 0; i < page.Widgets.Count; i++)
            {
                PdfWidget widget = page.Widgets[i];
                PdfActionArea actionArea = widget as PdfActionArea;
                if (actionArea != null)
                {
                    PdfUriAction linkAction = actionArea.Action as PdfUriAction;
                    if (linkAction != null)
                    {
                        page.Widgets.RemoveAt(i);
                        i--;
                    }
                }
            }
        }

        doc.Save(outputFile);
        System.Diagnostics.Process.Start(outputFile);
    }
} 
```

请注意，即使 PDF 本身没有定义链接，一些查看器可以从文本中检测到超链接，并且仍然将它们显示为可点击区域。例如，具有某些设置的 Adob​​e Reader 可以做到这一点。

PS我知道这个问题很老，但也许我的回答会让新访客受益。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T08:30:35.177

您可以像[这样](http://www.pdfsharp.com/PDFsharp/)的库来打开和修改 PDF 文件并将每个超链接对象转换为简单文本。

# asp.net - 事件处理后如何更新页面数据？

> ID：780684
> 
> 赞同：3
> 
> 时间：2009-04-23T07:38:38.123
> 
> 标签：asp.net, event-handling, page-lifecycle

在 Page_Init 上，我基于几个数据库表创建了一个动态创建的控件表。其中一个控件是用于将列表项向上移动的 ImageButton。此事件处理程序所做的是更新数据库中受影响项目的 SortOrder 列。

现在的问题是，由于控件是在 Page_Init 事件中创建的，并且 SortOrder 稍后会在 ImageButton 命令事件被触发时更新。使用正确的 SortOrder 更新表的最佳过程是什么。如果我在事件触发后重新创建表，ImageButton 命令事件将不再起作用。

*   我应该实现一种方法来更新表中的数据而不重新创建它吗？
*   事件触发后我应该在代码中重新加载页面吗？

解决此问题的首选方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T08:09:13.807

页面事件（例如`Init`和）`Load`将始终在引发回发的事件处理程序之前触发。这是[页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)的基础（有关 Peter Bromberg 的可视化表示，[请参见此处](http://www.eggheadcafe.com/articles/20051227.asp)）。大多数刚接触 ASP.NET 的开发人员在理解和适当处理这种“困境”方面存在重大问题。

**理想的方法是：**

一种。您`Page_Init`应该调用一个过程（让我们称之为`BindData()`说明）来处理基于数据库数据的表的创建。此方法类似于绑定到数据库数据并基于该绑定呈现 UI 元素的绑定方法。IOW，您应该从方法中删除表创建代码`Page_Init`并将其放在单独的方法中，以便在需要时可以调用它。

**重要说明：**此`BindData()`方法还处理将动态创建的 ImageButton 控件的事件处理程序附加到控件。我们称之为`ImageButton_Click`. 这对于控制在后续回发时触发的事件至关重要。

湾。当您的`ImageButton_Click`方法执行时，它会调用该`BindData()`方法来重新创建表及其绑定，但使用新的排序规则。

因此，第一次加载时的执行顺序是：

1.  `Page_Init`
2.  `BindData()`

后续加载（回发）的执行顺序是：

1.  `Page_Init`
2.  `BindData()`- 附加了 ImageButton 的事件处理程序。
3.  `ImageButton_Click`
4.  `BindData()`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T08:08:16.663

你需要这样的东西...

*   OnInit (IsPostBack = false)
    *   动态创建 ImageButton
    *   连线 ImageButton 事件处理程序
    *   加载表 - 检查会话/变量中的排序顺序。如果没有；使用默认值

**点击按钮**

*   OnInit (IsPostBack = true / 1st Postback)

    *   动态重新创建 ImageButton
    *   连线 ImageButton 事件处理程序
    *   加载表 - 使用默认排序顺序
*   ImageButton_OnClick（仍然是第一次回发）

    *   重新加载表 - 具有特定的排序顺序
    *   将此排序顺序变量保存在 Viewstate/Session 变量中

**引起其他一些回发**

*   OnInit (IsPostBack = true / 2nd & Subsequent Postbacks)
    *   动态创建 ImageButton
    *   连线 ImageButton 事件处理程序
    *   加载表 - 检查会话/变量中的排序顺序。如果找到，请使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T08:49:09.827

首先，您似乎将数据手动绑定到 UI 控件。在 Asp.Net 中，有很多方法可以使用内置的数据绑定技术来避免这种情况。许多控件（如 GridView）允许从给定数据源自动创建 Html 表。还有许多其他选项，包括中继器。

无论您选择绑定数据，技术都是在页面生命周期中的某个时间点重新绑定。

你需要...

1.  使用默认排序顺序在第一页加载时绑定您的数据
2.  更改排序顺序后，重新绑定图像按钮的事件处理程序中的数据。

代码看起来像这样......

```
private void Page_Load (...)
{
    if (!IsPostBack)
        //On First Load
        BindData(defaultSoortOrder);
    else
        BindData(currentSortOrder);            
}

private void ImageButton_Click (...)
{
    currentSortOrder = newSortOrder;
    BindData(currentSortOrder);
} 
```

如果单击 Image 按钮，您将最终调用 BindData 两次。但这是必要的，因为可以从任何控件启动页面回发，您需要始终确保在页面加载时绑定数据。

# php - 创建应连接到数据库的 shell 时出现致命错误

> ID：780695
> 
> 赞同：1
> 
> 时间：2009-04-23T07:41:18.320
> 
> 标签：php, mysql, database, cakephp

```
Fatal error: Call to undefined function mysql_connect() in
/opt/lampp/htdocs/cake/cake/libs/model/datasources/dbo/dbo_mysql.php on line 370

//shell
<?php

class ReportShell extends Shell
{
    var $uses = array('Customer');
    function main()
    {
            $customers = $this->Customer->find('all');
            var_dump($customers);
            $this->out('lol my first CakePHP shell is baked');
    }
}

?>

//model
<?php

class Customer extends AppModel
{
    var $name = "Customer";
    var $useTable = "customer";
    var $hasMany = array
    ('CustomerPrice',
     'Order' => array('foreignKey' => 'customer_id'));

    // Validation settings
    var $validate = array(
            'customer_id' => array(
                    'rule' => 'numeric',
                    'message' => 'A customer ID should be numeric !'
            ),
            'customer_number' => array(
                    'rule' => 'numeric',
                    'message' => 'A customer number should be numeric !'
            ),
            'customer_name' => array(
                    'rule' => 'notEmpty',
                    'message' => 'A customer number should be numeric !'
            )
    );

    /**
     * Function to retrieve Customer data
     *
     * @param string $response_type - CakePHP find() type
     * @param array $response_setting - CakePHP find() parameter array (set$
     * @param int $customer_id - Find customer by customer ID
     * @param int $customer_number - Find customer by customer number
     * @param string $customer_name - Find customer by customer name
     * @param int $customer_billing_month - Find customer by customer billi$
     * @param int $customer_start_date - Find customer by start date
     * @param int $customer_end_date - Find customer by end date
     * @param string $customer_email - Find customer by customer e-mail
     */
    function FjmCustomerGetCustomer($response_type, $response_setting = arr$

            /* Conditions: Find Customer by customer data */
            if($customer_id)
            {       $response = $this->Customer->findByCustomerId($response$
            if($customer_number)
            {       $response = $this->Customer->findByCustomerNumber($resp$
            if($customer_name)
            {       $response = $this->Customer->findByCustomerName($respon$
            if($customer_billing_month)
            {       $response = $this->Customer->findByCustomerBillingMonth$
            if($customer_start_date)
            {       $response = $this->Customer->findByCustomerStartDate($r$
            if($customer_end_date)
            {       $response = $this->Customer->findByCustomerEndDate($res$
            if($customer_email)
            {       $response = $this->Customer->findByCustomerEmail($respo$

            if(!$customer_id || !$customer_number || !$customer_name || !$c$
            {       $response = $this->Customer->find('all', $response_sett$

            return $response;
    }

    /* FjmCustomerGetCustomerByProduct
     * FjmCustomerGetCustomerByOrder
     * FjmCustomerGetCustomerByBill
     * FjmCustomerGetCustomerByHandle
     */
}

?>

//database config php
    var $default = array(
            'driver' => 'mysql',
            'persistent' => false,
            'host' => 'localhost',
            'login' => 'root',
            'password' => 'pwd',
            'database' => 'fjm_pps',
            'prefix' => 'fjm_',
    ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T07:53:15.140

“致命错误：调用未定义的函数 mysql_connect()”意味着您的 PHP 安装中没有包含 MySQL 库。

检查您的 php.ini 并确保激活了 mysql 扩展。“extension=mysql.so”（或“extension=php_mysql.dll”）需要取消注释。

谷歌四处寻求帮助，将 MySQL 库包含在您的 PHP 安装中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T10:09:46.717

另请注意，在某些安装中（想到 debian），如果不是全部，cli-php 和 apache-php 具有**单独**的 php.ini:s。因此，在一个中启用 mysql 不一定对另一个有帮助。使用 phpinfo() 找出它在哪里寻找 php.ini。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T07:46:42.393

答案是php cli中mysql的扩展没有激活或安装

# cobol - 如何在 COBOL 中合并两个文件并创建具有匹配字段的报告

> ID：780703
> 
> 赞同：0
> 
> 时间：2009-04-23T07:45:19.263
> 
> 标签：cobol

我有两个文件：第一个文件包含作业名和开始时间，如下所示：

```
ZPUDA13V STARTED - TIME=00.13.30
ZPUDM00V STARTED - TIME=03.26.54
ZPUDM01V STARTED - TIME=03.26.54
ZPUDM02V STARTED - TIME=03.26.54
ZPUDM03V STARTED - TIME=03.26.56 
```

第二个文件包含 jobname 和 Endtime，如下所示：

```
ZPUDA13V ENDED - TIME=00.13.37
ZPUDM00V ENDED - TIME=03.27.38
ZPUDM01V ENDED - TIME=03.27.34
ZPUDM02V ENDED - TIME=03.27.29
ZPUDM03V ENDED - TIME=03.27.27 
```

现在我正在尝试将这两个文件组合起来以获取像 JOBNAME START TIME ENDTIME 这样的报告。我使用 ICETOOL 来获取报告如果我得到 JOBNAME START TIME ，ENDTIME 是 SPACES 。如果我得到 Endtime ，JOBNAME START TIME 得到空格。请让我知道如何对 outrec 字段进行编码，因为我已经用几乎所有可能的方式编码以获得所需的字段。但我的输出仍然与我要求的不一样

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T08:21:21.063

我不知道 ICETOOL 是什么（也不知道在 Google 中查找它的倾向 :-) 但这是一个经典的 COBOL 数据处理任务。

根据您的简单数据输入，算法将是：

```
for every record S in startfile:
    for every record E in endfile:
        if S.jobnname = E.jobname:
            ouput S.jobname S.time E.time
            next S
        endif
    endfor
endfor 
```

但是，您可能需要考虑以下事实：

*   白天可能会运行多个同名作业（文件中有多个条目）。
*   多个同名作业可以同时运行。

您可以通过确保 E 记录紧随 S 记录（基于时间）来解决第一个问题。第二个问题很棘手。

如果您在 z/OS 上运行（根据作业名称，您可能是），您是否考虑过使用来自 SMF 记录的信息来进行此收集和分析。我很确定 SMF 30 型记录可以容纳您需要的一切。

假设这*是*一个大型机问题，这是我工作中的一个朋友写的一本书的无耻插件，看看[到底什么是大型机？](https://rads.stackoverflow.com/amzn/click/com/1409225356)大卫斯蒂芬斯 (ISBN-13 = 978-1409225355)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-17T17:33:32.560

我知道，我的决议来得太晚了，但可能对新来的 stackoverflow 有帮助

您可以利用`JOINKEYS` 使用`DFSORT`JCL。

```
JOINKEYS F1 FIELDS=(01,08,CH,A)
JOINKEYS F2 FIELDS=(01,08,CH,A)
REFORMAT FIELDS=(F1:01,33,F2:25,08)
SORT FIELDS=COPY
OUTREC FIELDS=(01,08,25,08,34,08) 
```

outrec 将根据您的需要保存数据！

# wpf - ListBox 的 DataTemplate 中的 WPF 访问控制

> ID：780708
> 
> 赞同：1
> 
> 时间：2009-04-23T07:47:07.340
> 
> 标签：wpf, listbox, datatemplate

我正在构建一个 WPF 订单管理器应用程序，但我遇到了不知道如何处理的情况。

我想重新绑定每个订单的采购订单请求列表，但我只想在应用程序中显示采购订单请求面板时执行此操作（他们双击订单以显示采购订单请求列表）。我遇到的问题是采购订单请求是订单列表框的每个列表项内的列表框，我找不到遍历列表项中的控件的方法（我只能遍历实际对象，例如 OrderInfo）。

我想做的是

```
OrderListBox.FindName("PurchaseOrderListBox") 
```

**crm 示例，其中 2 个订单显示采购订单请求，1 个订单不显示任何** [替代文本 http://www.readyflowers.co.uk/images/crm-datatemplate.png](http://www.readyflowers.co.uk/images/crm-datatemplate.png)

**结果我想实现** [替代文本 http://www.readyflowers.co.uk/images/crm-datatemplate-saved.png](http://www.readyflowers.co.uk/images/crm-datatemplate-saved.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T08:20:10.880

我不确定我是否理解你的问题......

但感觉就像您正试图通过 UI 层次结构来寻找某些东西（ala WinForms）——这就像在 WPF 中逆流而上。它会让你很快疲倦..

查看有关 ViewModel 模式的文章。我读过的其中一本是[Dan Crevier](http://blogs.msdn.com/dancre/archive/2006/10/11/datamodel-view-viewmodel-pattern-series.aspx)的。基本思想是为 UI 提供一个 Model 对象 - UI（数据）绑定到 ViewModel 公开的属性。现在所有与 UI 相关的逻辑都可以进入 ViewModel，它会通过 propertyChanged 通知会话状态的任何变化。因此，如果某个字段发生更改，ViewModel 会收到通知。ViewModel 会更新相关属性，并且 UI 也会相应地刷新。

在这种情况下`ViewModel.OrderInfo.Find_PO_with_X(searchCriteria)`，将帮助您找到正确的对象。如果找到，您说`ViewModel.ShowGreenLight = true`绑定到此属性的 UI 控件将变为绿色。

高温高压

# python - 在 Python 中播放和控制 mp3 文件？

> ID：780711
> 
> 赞同：5
> 
> 时间：2009-04-23T07:49:49.830
> 
> 标签：python, audio, mp3, audio-streaming

首先，我是一名 Python 初学者，具有典型的 C++/Java 面向对象的背景。

我被说服为我目前正在进行的这项工作尝试 Python，到目前为止我很喜欢它。我遇到的一个问题是找到一个好的 mp3 模块。

我试过 TkSnack，它安装并运行良好，没有错误（只要我的音频设备不忙），但它实际上永远无法发出声音，它什么也没做......我上网寻求帮助，但很失望与文件的数量。

所以我决定换。我尝试了 PyMad，因为它也在 Ubuntu 的标准存储库中。这方面的文档更少，但我可以让它播放声音。唯一的问题是它需要一个循环来不断地写入/播放音频缓冲区。这使得处理播放控制（在我看来）特别麻烦，因为我必须在单独的线程或进程中运行它，并以某种方式控制暂停等的查找位置。这对于我使用 Python 的原因来说有点太低了。我喜欢 TkSnack 的简单性，因为它像“mysound.play()”或“mysound.pause()”这样的简单命令而不是控制循环。

我还查看了 pyMedia，它看起来是最新的文档，但我无法将它安装在我的机器上。运行“python setup.py build”命令时，我收到“gcc exited with value 1”错误或类似的错误。

所以我正在寻找关于这些模块之一的任何建议或帮助，或者完全不同的模块，它是高级且易于用于 mp3（最好是其他格式）我正在尝试进行基本的播放控制（暂停、停止，跳过，寻找），我最终也可能会流式传输文件（如果我到达那里的话）。

**编辑**：我喜欢 Gstreamer 的 python 绑定，但这是一个跨平台的解决方案吗？我忘了提到这是一个要求。但我总是将 GStreamer 与 Linux 相关联，这可以在其他操作系统上使用吗？

**编辑**：维基百科说[是](http://en.wikipedia.org/wiki/GStreamer)的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T08:09:34.633

抱歉，我无法在 PyMad 或 pyMedia 方面为您提供帮助，但我还有其他建议。

现有的用 Python 编写的音乐播放器：

*   [出口](http://www.exaile.org/)
*   [FUPlayer](http://fuplayer.org/)
*   [听](http://listengnome.free.fr/)

以上所有使用[GStreamer](http://gstreamer.freedesktop.org/documentation/)多媒体框架的[Python 绑定。](http://gstreamer.freedesktop.org/modules/gst-python.html)绑定的文档很少，但请查看[此处](http://pygstdocs.berlios.de/pygst-tutorial/index.html)、[此处](http://pygstdocs.berlios.de/)、[此处以及](http://www.jonobacon.org/2006/08/28/getting-started-with-gstreamer-with-python/)[此处](http://cgit.freedesktop.org/gstreamer/gst-python/tree/examples)的源代码分发示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:00:03.417

我只需要处理这个问题，根据我的研究，我认为你最好的选择是[pyglet](http://www.pyglet.org)和[pygame](http://www.pygame.org)。它们是具有内置 a/v 支持的接口包。

# asp.net-mvc - ASP.NET MVC 角色授权

> ID：780715
> 
> 赞同：18
> 
> 时间：2009-04-23T07:52:03.490
> 
> 标签：asp.net-mvc, authorization, roles

我想将我的控制器类的角色默认设置为“管理员，内容编辑器”

```
[Authorize(Roles = "Administrators, Content Editor")] 
```

我通过使用上面的属性装饰控制器来做到这一点。但是，我希望所有人都可以使用一项操作（即“查看”）。如何重置角色以便每个人（包括完全未经授权的用户）都可以访问此操作。

注意：我知道我可以使用上面的授权属性来装饰其他动作，但我不想一直这样做。我希望默认情况下所有控制器操作都无法访问，因此如果有人添加操作，他们必须做出深思熟虑的决定以使其对公众可用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-18T00:08:29.437

MVC4 有一个新的属性正是为此而生的`[AllowAnonymous]`

```
[AllowAnonymous]
public ActionResult Register() 
```

[http://blogs.msdn.com/b/rickandy/archive/2012/03/23/securing-your-asp-net-mvc-4-app-and-the-new-allowanonymous-attribute.aspx](http://blogs.msdn.com/b/rickandy/archive/2012/03/23/securing-your-asp-net-mvc-4-app-and-the-new-allowanonymous-attribute.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T08:21:51.343

您可以将 Authorize 属性放在操作方法上。不只是在班级层面。

因此，将属性从控制器类移动到您想要保护的操作方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T08:15:50.733

到目前为止，我能想到的唯一解决方案是创建和注册另一个控制器，以便我有一个用于匿名访问，一个用于授权访问，但这并不像我希望的那样优雅。

# javascript - 如何禁用 IE 和 Firefox 中的后退按钮？

> ID：780718
> 
> 赞同：5
> 
> 时间：2009-04-23T07:53:02.207
> 
> 标签：javascript, html, firefox

### 复制：

> *   [禁用浏览器上的后退按钮](https://stackoverflow.com/questions/87422/disabling-back-button-on-the-browser)
> *   [防止使用后退按钮（在 IE 中）](https://stackoverflow.com/questions/54539/prevent-use-of-the-back-button-in-ie)

* * *

我必须禁用浏览器的后退和前进按钮（IE 和 Firefox 两者）。我努力了：

```
//disable back button
window.onbeforeunload= function() { }   
window.history.forward(1); 
```

但这仅适用于 IE。
有没有万无一失的解决方案？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-23T07:55:00.097

答案是不”。您不能禁用浏览器的后退按钮。

或者至少在一个好的浏览器上。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-23T07:55:37.833

我相信这个问题已经被问到了：

[禁用浏览器上](https://stackoverflow.com/questions/87422/disabling-back-button-on-the-browser) [的后退按钮 防止使用后退按钮（在 IE 中）](https://stackoverflow.com/questions/54539/prevent-use-of-the-back-button-in-ie)

如果您试图防止用户丢失他们的工作，请尝试以下操作：

```
window.onbeforeunload = function() { return "You work will be lost."; }; 
```

史蒂夫

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T07:54:37.400

这个问题没有解决方案。你不能真正“禁用”它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T08:11:28.623

我认为你不应该禁用后退按钮，因为用户已经习惯了使用它，如果发现它的功能被删除，他们会感到沮丧。

用户流将被中断，他们将离开您的网站。

# matrix - 如何构造 DAG 的邻接矩阵？

> ID：780726
> 
> 赞同：4
> 
> 时间：2009-04-23T07:57:01.760
> 
> 标签：matrix, graph-theory

对于[二分图](http://en.wikipedia.org/wiki/Bipartite_graph)，您可以将[邻接矩阵](http://en.wikipedia.org/wiki/Adjacency_matrix)替换为所谓的邻接[矩阵](http://en.wikipedia.org/wiki/Adjacency_matrix#Adjacency_matrix_of_a_bipartite_graph)：

> 二部图的邻接矩阵 A 的部分具有 r 和 s 个顶点，其形式为

```
    A = 产科
         B T O

```

> 其中 B 是一个 r × s 矩阵，O 是一个全零矩阵。显然，矩阵 B 唯一地代表了二分图，通常称为它的二分邻接矩阵。

现在，DAG 是一个二分图，例如，您可以对其进行[拓扑排序](http://en.wikipedia.org/wiki/Topological_ordering)，并让集合 U 和 V 分别作为奇数或偶数拓扑级别的节点。

这意味着，对于具有 n 个节点的 DAG，我只需要一个 (n/2) ²矩阵（平均）而不是²矩阵。问题是，我不知道如何构建它。有什么提示吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-28T06:53:52.420

我相信你不能为 DAG 构造一个双邻接矩阵，因为不是每个 DAG 都是二分图。

这是一个简单的例子：考虑一个有 3 个顶点的有向图，并将它们表示为 A、B 和 C。边连接 A 到 B、B 到 C 和 A 到 C。这个图显然是一个 DAG，因为它是有向的并且没有循环（A->B->C<-A 不是循环）。但是，该图不是二分图：无法将 A、B 和 C 划分为两个不相交的集合，其中同一集合中的顶点之间没有边。

结论是有图是 DAG 但不是二分的，所以不是每个 DAG 都是二分的。

请注意，您可以对 DAG 进行拓扑排序并将顶点划分为两个不相交的集合，这并不意味着同一集合的顶点之间没有边。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-28T06:56:02.213

似乎只有在图是无向的情况下才能构造A矩阵的邻接矩阵B。

根据维基百科的例子：

![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/b/b9/RecursiveEvenBipartite.svg/306px-RecursiveEvenBipartite.svg.png "DAG 二分图")

这个 DAG 的邻接矩阵应该是：

```
Blue -> Red
B = 1 1 0 0
    0 0 1 0
    0 0 0 0
    0 0 0 0
    0 0 0 1

Red -> Blue
C = 0 1 0 0 0
    0 1 0 0 0
    0 0 1 1 1
    0 0 0 0 0 
```

正如您所看到的，C 不是 B 的转置。按照描述创建 A 矩阵似乎是不可能的。但是，您可以像这样创建一个 A 矩阵：

```
A = 0 B
    C 0 
```

这将需要 2 * (n/2)^2 空间，这仍然比 n^2 好。

要构造 B 和 C 矩阵，您只需要遍历 U 和 V 中的每个节点（分别）以确定出站边。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T08:16:28.157

以下代码将创建给定邻接矩阵的双邻接矩阵，如果它是二磷灰石（只有二磷灰石图有二磷灰石图。）如果给定图不是二磷灰石，GetBiadjacencyMatrix() 方法返回 null。

[提供的样本图，包括其邻接矩阵 http://www.freeimagehosting.net/image.php?10e9b6a746.jpg](http://www.freeimagehosting.net/image.php?10e9b6a746.jpg)

看不到图？[点击这里](http://www.freeimagehosting.net/image.php?10e9b6a746.jpg)

```
public class Matrix
{
    private void Usage()
    {
        int[,] AdjacencyMatrix = new int[,] { 
                                        {0, 1, 1, 0, 0, 0, 0, 0, 0},
                                        {1, 0, 0, 1, 0, 0, 0, 0, 0},
                                        {1, 0, 0, 1, 0, 0, 0, 0, 0},
                                        {0, 1, 1, 0, 1, 0, 0, 0, 0},
                                        {0, 0, 0, 1, 0, 1, 1, 1, 0},
                                        {0, 0, 0, 0, 1, 0, 0, 0, 0},
                                        {0, 0, 0, 0, 1, 0, 0, 0, 0},
                                        {0, 0, 0, 0, 1, 0, 0, 0, 1},
                                        {0, 0, 0, 0, 0, 0, 0, 1, 0}
                                       };

        int[,] BiadjacencyMatrix = GetBiadjacencyMatrix(AdjacencyMatrix);
    }

    public static int[,] GetBiadjacencyMatrix(int[,] adjacencyMatrix)
    {
        int NodeCount = adjacencyMatrix.GetLength(0);

        NodeInfo[] Nodes = new NodeInfo[NodeCount];
        for (int c = NodeCount - 1; c >= 0; c--)
            Nodes[c] = new NodeInfo(c);

        if (ColorNode(adjacencyMatrix, Nodes, 0, 1, -1) != NodeCount)
            return null; // Given graph is not bipatite.

        int Part1Count = 0, Part2Count = 0;
        foreach (NodeInfo Node in Nodes)
            Node.IndexInPart = Node.PartID == 1 ? Part1Count++ : Part2Count++;

        int[,] ToReturn = new int[Part1Count, Part2Count];
        foreach (NodeInfo NodeInPart1 in Nodes)
            if (NodeInPart1.PartID == 1)
                foreach (NodeInfo NodeInPart2 in Nodes)
                    if (NodeInPart2.PartID == 2)
                        ToReturn[NodeInPart1.IndexInPart, NodeInPart2.IndexInPart]
                            = adjacencyMatrix[NodeInPart1.IndexInGraph, NodeInPart2.IndexInGraph];

        return ToReturn;
    }

    private static int ColorNode(int[,] adjacencyMatrix, NodeInfo[] nodes, int currentNode, int currentPart, int parentNode)
    {
        if (nodes[currentNode].PartID != -1) 
            return nodes[currentNode].PartID != currentPart ? -1 : 0;
        int ToReturn = 1;
        nodes[currentNode].PartID = currentPart;
        for (int c = nodes.Length - 1; c >= 0; c--)
            if (adjacencyMatrix[currentNode, c] != 0 && c != parentNode)
            {
                int More = ColorNode(adjacencyMatrix, nodes, c, currentPart == 1 ? 2 : 1, currentNode);
                if (More == -1) return -1;
                ToReturn += More;
            }
        return ToReturn;
    }
}

public class NodeInfo
{
    private int _IndexInGraph;
    private int _PartID;
    private int _IndexInPart;
    private bool _IsVisited;

    public NodeInfo(int indexInGraph)
    {
        _IndexInGraph = indexInGraph;
        _PartID = -1;
        _IndexInPart = -1;
        _IsVisited = false;
    }

    public int IndexInGraph
    {
        get { return _IndexInGraph; }
        set { _IndexInGraph = value; }
    }

    public int PartID
    {
        get { return _PartID; }
        set { _PartID = value; }
    }

    public int IndexInPart
    {
        get { return _IndexInPart; }
        set { _IndexInPart = value; }
    }

    public bool IsVisited
    {
        get { return _IsVisited; }
        set { _IsVisited = value; }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T21:11:02.317

您的双邻接矩阵 A 的所述对称性*以及*您打算使用拓扑排序来隔离图中的二分结构 - 都指出您实际上指的是**间接**的非循环图 - 即树。（对称性明确表示，如果你有一条从 x 到 y 的边，那么你必须有一条从 y 到 x 的边——因此，定向性变得毫无意义）。

假设这确实是您的意图：

(1) 对于任何间接图，您可以通过仅存储邻接矩阵的上三角形来*立即*解决大约 0.5*(n^2)（确切地说：n(n-1)/2）。

(2) 假设你必须只存储 B。

您必须首先识别不相交的子集，例如 R & S，每个子集都没有内部边。拓扑排序是一个合理的选择 - 在树中，它相当于选择一个根并通过位于根上方的偶数/奇数级别来标记顶点（与[常见的可视化](http://en.wikipedia.org/wiki/Tree_structure)相比，我更喜欢将一棵树视为实际上生长在其根*之上*..)。我从你的问题中了解到你对此很满意，所以我什至不会给出伪代码。

接下来，您需要重新标记顶点，以便所有 R 的顶点在前，所有 S 的顶点紧随其后：

```
Allocate NewLabels(r + s);
CurRSize = 0;
CurSSize = 0;
for each (TreeLevel)
    if #CurLevel is even  // append to R vertices
       NewLabels(CurRSize : CurRsize + CurLevelSize - 1) = CurLevelVertexNums;
       CurRSize += CurLevelSize;
    else // append to S vertices
       NewLabels(r+s - (CurSSize+CurLevelSize) : r+s - (CurSSize + 1) = CurLevelVertexNums;
       CurSSize += CurLevelSize; 
```

（一些优化立即浮现在脑海，但它们在这里并不重要）。

然后，您可以连续扫描图边，并将它们作为条目存储到 rxs 矩阵 B 中，由*新*的顶点标签索引：

```
Allocate B(r,s);
Zero(B);
for each (edge = x<-->y)
   i = NewLabels(x);
   j = NewLabels(y) - r; // must adjust, to index just B
   B(i,j) = 1; 
```

HTH。

# c - C/C++：头文件中的静态函数，是什么意思？

> ID：780730
> 
> 赞同：55
> 
> 时间：2009-04-23T07:59:01.243
> 
> 标签：c, function, static

我知道在源文件中声明静态函数意味着什么。我正在阅读一些代码，发现头文件中的静态函数可以在其他文件中调用。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-04-23T08:00:53.420

函数是否定义在头文件中？以便在函数中直接给出实际代码，如下所示：

```
static int addTwo(int x)
{
  return x + 2;
} 
```

那么这只是为许多不同的 C 文件提供有用功能的一种方式。每个包含头文件的 C 文件都将获得它自己可以调用的定义。这当然会浪费内存，并且（在我看来）是一件非常丑陋的事情，因为在标头中包含可执行代码通常不是一个好主意。

请记住，`#include`:ing 标头基本上只是将标头的内容（以及它包含的任何其他标头）粘贴到编译器所看到的 C 文件中。编译器永远不知道一个特定的函数定义来自头文件。

**更新**：在许多情况下，执行上述操作实际上是一个好主意，我意识到我的回答听起来很黑白，这有点过于简单化了。例如，建模（或仅使用）[内部函数](http://en.wikipedia.org/wiki/Intrinsic_function)的代码可以像上面那样表达，`inline`甚至可以使用显式关键字：

```
static inline int addTwo(int *x)
{
  __add_two_superquickly(x);
} 
```

在这里，`__add_two_superquickly()`函数是一个虚构的内在函数，由于我们希望整个函数基本上编译成一条指令，我们真的希望它是内联的。不过，上面的内容比使用宏更干净。

与直接使用内在函数相比的优势当然是，将其包装在另一层抽象中，可以在缺乏特定内在函数的编译器上构建代码，方法是提供替代实现并根据正在使用的编译器选择正确的实现.

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-23T08:00:24.123

它将有效地在包含它的每个 cpp 文件中创建一个具有相同名称的单独静态函数。这同样适用于全局变量。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-23T20:36:23.250

正如其他人所说，它与文件本身的`static`函数具有完全相同的含义。这是因为和文件`.c`之间没有语义差异；只有编译单元由实际传递给编译器（通常命名为）的文件组成，其中任何和所有在行中命名的文件（通常命名为）的内容插入到流中，因为它们被预处理器看到。`.c``.h``.c``#include``.h`

C 源代码在命名文件中`.c`和公共声明在命名文件`.h`中的约定只是一个约定。但它通常是一个很好的。根据该约定，文件中应该出现的唯一内容`.h`是声明，这样您通常可以避免在单个程序中多次*定义相同的符号。*

在这种特殊情况下，`static`关键字使符号对模块来说是私有的，因此不会出现多定义冲突等着造成麻烦。因此，从某种意义上说，这样做是安全的。但是，在没有保证函数会被内联的情况下，您冒着在`#include`该头文件发生的每个模块中实例化该函数的风险，这充其量是在代码段中浪费内存。

我不确定哪些用例可以证明在普遍可用的公共标头中这样做是合理的。

如果该`.h`文件是生成代码并且仅包含在单个`.c`文件中，那么我会亲自为该文件命名，而不是`.h`强调它实际上根本不是公共标头。例如，将二进制文件转换为初始化变量定义的实用程序可能会编写一个旨在通过使用的文件，`#include`并且很可能包含`static`变量的声明，甚至可能`static`包含访问器或其他相关实用程序函数的定义。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-04-05T08:21:15.243

如果您在头文件中定义函数（而不是简单地声明它），则会在每个翻译单元中生成该函数的副本（基本上在每个包含此头文件的 cpp 文件中）。

这可能会增加可执行文件的大小，但如果函数很小，这可能可以忽略不计。优点是大多数编译器可以内联函数，这可能会提高代码性能。

但是这样做可能会有**很大**的不同，这在任何答案中都没有提到。如果您的函数使用静态局部变量，例如：

```
static int counter()
{
    static int ctr = 0;
    return ctr++;
} 
```

而不是：

```
//header
int counter();

//source
int counter()
{
    static int ctr = 0;
    return ctr++;
} 
```

然后每个包含这个头文件的源文件都会有自己的计数器。如果函数在头文件中声明，并在源文件中定义，那么计数器将在整个程序中共享。

所以说唯一的区别是性能和代码大小是错误的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-22T07:48:57.333

在源文件或头文件中定义没有语义差异，当使用 static 关键字时，在纯 C 中基本上两者的含义相同，您正在限制范围。

但是，在头文件中写这个有一个问题，这是因为每次你在源文件中包含头文件时，你都会有一个具有相同实现的函数的副本，这与在头文件中定义的普通函数非常相似文件。通过在标题中添加定义，您并没有实现静态函数的用途。

因此，我建议你应该只在源文件中而不是在标题中实现你的实现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-16T14:07:27.360

它在一些具有小型内联函数的“仅标题”库中很有用。在这种情况下，您总是希望复制该函数，因此这不是一个坏模式。但是，这为您提供了一种在单个头文件中插入单独的接口和实现部分的简单方法：

```
// header.h

// interface part (for user?!)
static inline float av(float a, float b);

// implementation part (for developer)
static inline float av(float a, float b)
{
    return (a+b)/2.f;
} 
```

GLK 框架中的Apple 矢量数学库使用这种构造（例如GLKMatrix4.h）。

# delphi - 为什么 TestComplete 这么慢？

> ID：780732
> 
> 赞同：5
> 
> 时间：2009-04-23T08:00:50.067
> 
> 标签：delphi, gui-testing, testcomplete

我们正在使用来自 AQTime 的 TestComplete 来使用我们的客户端/服务器应用程序在客户端测试 GUI。它是用Delphi 2007 编译的。客户端的源代码大约有140 万条源代码。硬件是使用 Windows XP Pro 的 Intel 双核 2.13 Mhz、2 GB RAM。

我使用所有调试选项编译应用程序，并在 TCOpenApp、tcOpenAppClasses、tcPublicInfo、tcDUnitSupport 中链接，如文档中所述，使其成为开放应用程序。生成的 exe 文件大约为 50 MB。

现在运行测试脚本时它可以工作，但运行速度非常非常慢。CPU 以 100% 的速度运行，由于速度慢而更改测试脚本有点令人沮丧。我已经关闭了所有桌面效果，比如圆角窗口。没有桌面背景。

其他有相同经验甚至解决方案的人吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T08:22:43.713

您的问题可能在于您使用调试信息编译并使用 tcXXX 单元，导致创建了大量对象。

来自[AutomatedQA 留言板的成绩单](http://www.automatedqa.com/forums/d.cgi?cmd=xover&group=automatedqa.public.testcomplete&related=16599&utag=)

> 你是在调试模式下编译的吗？我们有一个应用程序在调试模式下编译时与 TC 一起使用时速度很慢。这是因为其中有大量的对象。如果我们编译不带调试但使用 TC 启用程序，一切都很好。

这[可能](http://www.automatedqa.com/forums/d.cgi?cmd=xover&group=automatedqa.public.testcomplete&related=4418&utag=)有助于

> 几个可以提高速度的区域。
> 
> 如果您只是使用录制和播放，那么请考虑将 .Keys("xxx") 调用替换为 .wText = "xxx"。Keys 函数将使用击键之间的毫秒延迟，而 wText 只是在内部强制文本覆盖。
> 
> 第二个建议（您可能已经看过）是工具->默认项目属性->项目->播放，将延迟设置为 100 毫秒、5 毫秒和 5 毫秒以将暂停保持在最低限度。
> 
> 至于对象属性，是的，TC 将它们全部加载。您可以通过在您的应用程序上进行进程刷新来强制执行此操作，以便在调用时强制数据可用而没有加载延迟。这可能有助于减少延迟的出现。

* * *

**编辑：**

*   我们也一直在评估 TestComplete 并且也遇到了这个性能问题。我很想知道您是否以及如何最终解决了这些问题。
*   也就是说，我认为它是一款潜力巨大的产品，可以真正帮助您*组织所有的单元、集成和 GUI 测试。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:44:21.093

> 现在运行测试脚本时它可以工作，但运行速度非常非常慢。CPU 以 100% 的速度运行，由于速度慢而更改测试脚本有点令人沮丧。我已经关闭了所有桌面效果，比如圆角窗口。没有桌面背景。
> 
> 其他有相同经验甚至解决方案的人吗？

我建议您尝试更改 TestComplete 用于远程连接的 TCP 端口。您可以在[网络套件选项对话框](http://support.smartbear.com/viewarticle/33058/)中更改它们。例如，您可以设置 6100-6102 端口。这有帮助吗？[TC 9.20 消耗高 98% cpu](http://smartbear.com/forums/f74/t78994/tc-9-20-consuming-high-98-cpu) SmartBear 论坛帖子中描述了类似的问题。

# java - 弱引用是如何实现的？

> ID：780738
> 
> 赞同：19
> 
> 时间：2009-04-23T08:02:15.273
> 
> 标签：java, .net, weak-references, internals

我想知道弱引用在内部是如何工作的，例如在 .NET 或 Java 中。我的两个总体想法是：

1.  “侵入式” - 将弱引用列表添加到最顶级的类（对象类）。然后，当一个对象被销毁时，所有的弱引用都可以被迭代并设置为空。
2.  “非侵入式”——维护对象指向弱引用列表的哈希表。当弱引用 A 被创建到对象 B 时，哈希表中会修改或创建一个条目，其键是指向 B 的指针。
3.  “脏” - 为每个对象存储一个特殊的哈希值，当对象被销毁时，该值将归零。弱引用将复制该哈希值并将其与对象的值进行比较以检查对象是否处于活动状态。但是，当直接使用时，这会导致访问冲突错误，因此我认为需要有一个具有该哈希值的附加对象。

这些解决方案中的任何一个看起来既干净又高效。有谁知道它实际上是如何完成的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T08:32:52.753

在 .NET 中，当`WeakReference`创建 a 时，会要求 GC 提供代表引用的句柄/不透明标记。然后，当需要时，`WeakReference`使用这个句柄来询问 GC 那个句柄是否仍然有效（即原始对象仍然存在） - 如果是，它可以获得实际的对象引用。

因此，这是针对对象地址构建令牌/句柄列表（并且可能在碎片整理等期间维护该列表）

我不确定我 100% 理解这三个项目符号，所以我犹豫猜测哪个（如果有的话）最接近。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T11:48:54.153

不确定我是否理解您的问题，但您可以查看 Java 中 WeakReference 类及其超类 Reference 的实现。它有很好的注释，您可以看到它有一个由 GC 特殊处理的字段和另一个由 VM 直接使用的字段。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-08-02T23:20:38.677

似乎弱引用的实现在业界是保密的；-)。例如，截至目前，[维基百科文章](http://en.wikipedia.org/wiki/Weak_reference)缺乏任何实现细节。并查看上面的答案（包括已接受的）：“去看看源代码”或“我认为”；-\。

在所有答案中，只有一个引用 Python 的 PEP 205 的答案是有见地的。正如它所说，对于任何单个对象，如果我们将弱引用视为实体本身，则最多可以有一个弱引用。

其余部分描述 Squirrel 语言实现。所以，weakref 本身就是一个对象，当你把一个对象的弱引用放到某个容器中时，你实际上是把引用放到了weakref 对象上。每个可引用可数对象都有存储指向其弱引用的指针的字段，在实际请求该对象的弱引用之前，该指针为 NULL。每个对象都有请求weakref的方法，该方法要么从字段中返回现有的（单个）weakref，要么创建它并缓存在字段中。

当然，weakref 指向的是原始对象。因此，您只需要遍历所有处理对象引用的可用位置，并添加对弱引用的透明处理（即自动取消引用它）。（“透明”替代方案是添加虚拟“访问”方法，这将是大多数对象的身份，以及弱引用的实际取消引用。）

并且由于对象具有指向其弱引用的指针，因此对象可以在自己的析构函数中使弱引用为空。

这个实现非常干净（没有神奇的“调用 GC”之类的东西）并且具有 O(1) 运行时成本。当然，这是非常贪婪的内存 - 需要为每个对象添加 +1 指针字段，即使通常 90+% 的对象为 NULL。当然，VHLL 每个对象已经有很大的内存开销，并且可能有机会压缩不同的“额外”字段。例如，对象类型通常是一个小枚举，因此可以将类型和某种弱引用引用合并到单个机器字中（例如，将弱引用对象保存在单独的区域中，并使用索引）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-23T09:14:53.150

Python 的[PEP 205](http://www.python.org/dev/peps/pep-0205/)对弱引用在 Python 中的行为方式进行了很好的解释，这为如何实现它们提供了一些见解。由于弱引用是不可变的，因此每个对象可以只有一个，您可以根据需要向其传递引用。因此，当对象被销毁时，只需要使一个弱引用失效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T18:09:58.743

我认为，正常的方法是让系统维护某种弱引用列表。当垃圾收集器执行时，在删除死对象之前，系统会遍历弱引用列表并使其目标未被标记为活动的任何引用无效。根据系统的不同，这可能发生在系统临时复活符合立即终结条件的对象之前或之后（在 .net 的情况下，有两种`WeakReference`——其中一种在系统扫描终结器之前被有效处理，这意味着当它的目标有资格完成最终确定时它将变得无效，并且其中一个在之后处理）。

顺便说一句，如果我正在设计一个基于 gc 的框架，我会添加一些其他好处：(1) 一种将引用类型*存储位置*声明为持有其他人主要感兴趣的引用的方法，以及 (2)其中的各种`WeakReference`可能表明对对象的唯一引用是“其他人感兴趣的”存储位置。虽然`WeakReference`是一种有用的类型，但将弱引用转换为强引用的行为可能会阻止系统识别出没有人会介意目标消失的情况。

# .net - 将对象反序列化为现在已签名和版本控制的程序集

> ID：780739
> 
> 赞同：9
> 
> 时间：2009-04-23T08:02:22.747
> 
> 标签：.net, serialization, strongname

我曾经用 BinaryFormatter (c#) 序列化树视图。执行此操作并包含所有可序列化类的程序集现在具有强名称并已签名并且还获得了新版本号（但是，实现没有改变）。

当我尝试反序列化 byte[] 数组时，该行

```
(TreeViewData)binaryFormatter.Deserialize(memoryStream); 
```

产生 ArgumentNullException。（参数名称：类型）

我以为是版本号的问题，所以我实现了一个自己的Binder。我覆盖了 BindToType 方法并确保版本已更正并返回正确的类型。

但是，在程序离开 BindToType 方法的那一刻，我仍然得到上面提到的异常。

我该如何解决？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-11-10T16:08:54.033

您可以使用 a`SerializationBinder`来解决此问题：

```
private class WeakToStrongNameUpgradeBinder : SerializationBinder
{
    public override Type BindToType(string assemblyName, string typeName)
    {
        try 
        {
            //Get the name of the assembly, ignoring versions and public keys.
            string shortAssemblyName = assemblyName.Split(',')[0];
            var assembly = Assembly.Load(shortAssemblyName);
            var type = assembly.GetType(typeName);
            return type;
        }
        catch (Exception)
        {
            //Revert to default binding behaviour.
            return null;
        }
    }
} 
```

然后

```
var formatter = new BinaryFormatter();
formatter.Binder = new WeakToStrongNameUpgradeBinder(); 
```

瞧，您的旧序列化对象可以使用此格式化程序反序列化。如果类型也发生了变化，您可以使用 a`SerializationSurrogate`将旧类型反序列化为新类型。

正如其他人所提到的，进行自己的序列化而不是依赖`IFormatter`是一个好主意，因为您可以更好地控制版本控制和序列化大小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T08:23:58.407

您可以*尝试*使用序列化代理，但是如果没有我们可以重现的东西，就很难给出一个像样的答案。

然而，根本问题是 BinaryFormatter 在涉及程序集之类的东西时非常非常脆弱。[哎呀，即使在组装](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)中它也足够脆弱。

听起来像是`TreeViewData`基于树的，所以我想知道 xml 是否会是一个更好的（即更多的版本容忍）选项。如果效率是一个问题，有自定义二进制格式（如[protobuf-net](http://code.google.com/p/protobuf-net/)）提供高性能、版本容错、可移植二进制序列化。如果您的数据已经序列化...我想知道是否是时候改变轨道了？尝试使用旧程序集反序列化数据，并切换到更健壮的序列化策略。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-10T16:14:16.840

我的建议是永远不要将内置序列化用于持久存储。如果将来某天出于其他原因您需要从另一种语言读取和写入文件格式，请始终编写自己的代码。

# c# - Visual Studio 2005 Express 在哪里？

> ID：780741
> 
> 赞同：38
> 
> 时间：2009-04-23T08:04:06.410
> 
> 标签：c#, visual-studio-2005, download

我正在开发一个需要 Visual Studio 2005 的项目，并且我一直在努力寻找 Visual Studio 2005 Express 的合法下载站点，但似乎微软只希望人们下载 2008 版本。

任何人都知道为什么会这样，以及是否有一些链接可以使用 Visual Studio 2005 Express？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-23T08:45:02.427

这里有更多链接： [http](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressvcs/thread/290fb587-1447-466c-9149-a692fa5de34d) ://social.msdn.microsoft.com/Forums/en-US/Vsexpressvcs/thread/290fb587-1447-466c-9149-a692fa5de34d 他们似乎指向相同的文件。

直接下载链接： http: [//go.microsoft.com/fwlink/ ?LinkId=51411&clcid=0x409](http://go.microsoft.com/fwlink/?LinkId=51411&clcid=0x409)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-10-14T17:13:31.203

对于 Visual Studios 2005 C++ express，vcsteup.exe 可在此处获得：http: [//download.microsoft.com/download/8/3/a/83aad8f9-38ba-4503-b3cd-ba28c360c27b/ENU/vcsetup.exe](http://download.microsoft.com/download/8/3/a/83aad8f9-38ba-4503-b3cd-ba28c360c27b/ENU/vcsetup.exe)

我在这里找到了这个链接：http: [//social.msdn.microsoft.com/Forums/en-US/Vsexpressvc/thread/aa4a3808-b0da-4afb-ac19-ac45582bb58a](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressvc/thread/aa4a3808-b0da-4afb-ac19-ac45582bb58a)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-23T08:09:31.437

我相信 VS 2008（所有版本）仅适用于 .NET 2.0 到 3.5，就像 VS 2005（所有版本）仅适用于 .NET 2.0 一样。这就是 VS 2005 不再可用的原因，因为它的功能与 VS 2008 相同。唯一的区别是解决方案文件，因此您可以为 VS 2008 制作单独的解决方案文件。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-02-18T18:09:39.087

万一其他人出于某种原因需要 VS 2005 Express Editions（例如，我不久前需要这个特定版本来验证/重现错误），此页面：http: [//blogs.msdn.com/astebner/archive/2006/ 03/28/563660.aspx](http://blogs.msdn.com/astebner/archive/2006/03/28/563660.aspx)链接到所有似乎仍在工作的版本（Visual Basic、C++、C#、J#）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-23T08:05:57.513

你为什么不得到VS 2008？他们说您的项目是.NET 2.0 项目？或者您正在编辑 .NET 1.x 项目？

使用 VS 2008（表达与否），您可以将项目定位到您想要的框架！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-23T06:31:18.117

万一有人在寻找**Web Developer** Express 2005 版本，CNET 在这里：

[http://download.cnet.com/Visual-Web-Developer-2005-Express-Edition/3000-10250_4-10421166.html](http://download.cnet.com/Visual-Web-Developer-2005-Express-Edition/3000-10250_4-10421166.html)

相信这仅适用于 windows 2000 和 XP。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-26T13:51:10.063

我在以下位置找到了 ISO Visual Studio VB 2005 Express

[http://apdubey.blogspot.com/2009/04/microsoft-visual-studio-2005-express.html](http://apdubey.blogspot.com/2009/04/microsoft-visual-studio-2005-express.html)

# nhibernate - NHibernate Flush——它是如何工作的？

> ID：780755
> 
> 赞同：21
> 
> 时间：2009-04-23T08:09:20.703
> 
> 标签：nhibernate

我对NHibernate 中的`Flush`( 和) 的工作方式有点困惑。`NHibernate.ISession`

从我的代码看来，当我通过 using 保存对象时`ISession.Save(entity)`，该对象可以直接保存到数据库中。

但是，当我使用`ISession.SaveOrUpdate(entity)`or更新和对象时`ISession.Update(entity)`，数据库中的对象不会更新---我需要调用`ISession.Flush`才能更新它。

我如何更新对象的过程如下：

1.  通过使用从数据库中获取对象`ISession.Get(typeof(T), id)`
2.  更改对象属性，例如，`myCar.Color="Green"`
3.  通过使用将其提交回数据库`ISession.Update(myCar)`

未`myCar`更新到数据库。但是，如果我`ISession.Flush`之后打电话，那么它会被更新。

什么时候用`Flush`，什么时候不用？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-23T09:17:33.440

在许多情况下，您不必关心 NHibernate 何时刷新。

**如果您创建了自己的连接，您只需要调用 flush ，**因为 NHibernate 不知道您何时提交它。

对你来说真正重要的是交易。在事务期间，您与其他事务隔离，这意味着，当您从数据库中读取时，您始终可以看到您的更改，而您看不到其他更改（除非它们已提交）。因此，您不必关心 NHibernate 何时更新数据库中的数据，除非它已提交。无论如何，它对任何人都是不可见的。

NHibernate 刷新如果

*   你打电话给提交
*   在查询之前确保您按内存中的实际状态进行过滤
*   当你调用flush

例子：

```
using (session = factory.CreateSession())
using (session.BeginTransaction())
{
  var entity = session.Get<Entity>(2);
  entity.Name = "new name";

  // there is no update. NHibernate flushes the changes.

  session.Transaction.Commit();
  session.Close();
} 
```

实体在提交时更新。NHibernate 看到您的会话是脏的并将更改刷新到数据库。仅当您在会话之外进行更改时才需要更新和保存。（这意味着使用分离的实体，即会话不知道的实体）。

* * *

**性能注意事项：** Flush 不仅执行更新数据库所需的 SQL 语句。它还搜索内存中的变化。由于 POCO 上没有脏标志，因此它需要将会话中每个对象的每个属性与其一级缓存进行比较。如果过于频繁，这可能会成为性能问题。您可以做几件事来避免性能问题：

*   不要循环冲洗
*   避免序列化对象（需要序列化来检查更改）
*   适当时使用[只读实体](http://nhibernate.info/doc/nhibernate-reference/readonly.html)
*   适当时设置[mutable = false](http://nhibernate.info/doc/nhibernate-reference/mapping.html#mapping-declaration-class)
*   在属性中使用自定义类型时，实现高效的 Equals 方法
*   当您确定自己知道自己在做什么时，请小心禁用自动刷新。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T08:21:34.933

NHibernate 只会在必要时执行 SQL 语句。它将尽可能长时间地推迟 SQL 语句的执行。

例如，当您保存具有分配 id 的实体时，它可能会推迟 INSERT 语句的执行。但是，当您插入一个具有自动递增 id 的实体时，NHibernate 需要直接插入该实体，因为它必须知道将分配给该实体的 id。

当您显式调用 flush 时，NHibernate 将执行该会话中已更改/创建/删除的对象所需的 SQL 语句。

[冲洗](http://nhibernate.info/doc/nhibernate-reference/manipulatingdata.html#manipulatingdata-flushing)

# java - 我将如何在 Swing 中编写动态菜单栏？

> ID：780758
> 
> 赞同：3
> 
> 时间：2009-04-23T08:09:44.540
> 
> 标签：java, swing

基本上我希望能够允许用户保存书签，然后将其放入菜单栏上子菜单的列表中。我将如何为可能添加的任意数量的书签编写通用功能，我基本上希望这些项目在单击时将 URL 放入文本框中。我需要为此创建一个新类，还是有内置函数？

我的程序是一个使用 Swing 用 Ja​​va 编写的简单 RSS 阅读器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T09:30:51.163

您需要将 MenuListener 添加到您想要动态的菜单项。在*void menuSelected(MenuEvent e)*方法中，实现子菜单的构建。在第一个实现中，您可以首先重置菜单的内容，然后从头开始重新构建它而不是更新它：

```
JMenu menu = new JMenu("Bookmarks");
menu.addMenuListener(new MyMenuListener());

private class MyMenuListener implements MenuListener {

    public void menuCanceled(MenuEvent e) { }

    public void menuDeselected(MenuEvent e) { }

    public void menuSelected(MenuEvent e) {
        JMenu menu = (JMenu) e.getSource();
        populateWindowMenu(menu);
    }
}

void populateWindowMenu(JMenu windowMenu) {
    windowMenu.removeAll();
    // Populate the menu here
} 
```

# .net - System.Drawing.Color 上的操作的扩展方法库

> ID：780759
> 
> 赞同：4
> 
> 时间：2009-04-23T08:10:03.977
> 
> 标签：.net, system.drawing.color

有没有人为 System.Drawing.Color 编写了一个很好的扩展方法“库”。

很高兴说：

```
 Color.Red.AdjustBrightness(.5)
 Color.Red.AdjustAlpha(.5)
 Color.Red.ToHSV() 
```

或类似的东西。

Alpha 很容易，但是其他的变得很耗时，因为你必须离开并为 HSV 和 HSB 以及所有有趣的东西细化所有正确的数学方程。

希望其他人已经完成了这项工作 :-) 微软似乎不想为我做这件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T19:03:46.763

CodeProject 有[一些](http://www.codeproject.com/KB/GDI-plus/HSBColorClass.aspx)HSBColor 类的代码。它不包括扩展方法，但是一旦您拥有 HSBColor 类及其相关的转换代码，它们将非常容易编写。

# c# - WPF 中的 SnapsToDevicePixels 通俗地说是什么意思？

> ID：780770
> 
> 赞同：14
> 
> 时间：2009-04-23T08:17:33.723
> 
> 标签：c#, snapstodevicepixels

有人吗？假设我有一个 Window 类，我给 SnapsToDevicePixels = true？发生什么了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-23T08:25:28.247

它将为窗口中的每个元素启用[像素捕捉](http://msdn.microsoft.com/en-us/library/aa970908.aspx)，因为此属性由子 UI 元素继承。但是，它不会对窗口本身的外观产生影响（即窗口框架或类似的），因为无论如何窗口已经驻留在屏幕上的整数坐标上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-10T08:09:14.747

如果是这样，您将在整个 UI 中启用像素捕捉渲染。对于以大于 96 点每英寸 (dpi) 的设备操作，像素捕捉渲染可以最大限度地减少单个单元实线附近的抗锯齿视觉伪影。以及所有孩子然后，该子树的元素将[SnapToDevicePixes](http://msdn.microsoft.com/en-us/library/system.windows.uielement.snapstodevicepixels.aspx)报告为 true，并将具有 SnapToDevicePixes 视觉效果。

# python - SQLAlchemy - 标签字典

> ID：780774
> 
> 赞同：16
> 
> 时间：2009-04-23T08:19:36.200
> 
> 标签：python, sqlalchemy

我对 SQLAlchemy 有疑问。如何将类字典属性添加到我的映射类中，该属性将字符串键映射到字符串值，并将存储在数据库中（与原始映射对象在同一个或另一个表中）。我希望这为我的对象的任意标签添加支持。

我在 SQLAlchemy 文档中找到了以下示例：

```
from sqlalchemy.orm.collections import column_mapped_collection, attribute_mapped_collection, mapped_collection

mapper(Item, items_table, properties={
# key by column
'notes': relation(Note, collection_class=column_mapped_collection(notes_table.c.keyword)),
# or named attribute
'notes2': relation(Note, collection_class=attribute_mapped_collection('keyword')),
# or any callable
'notes3': relation(Note, collection_class=mapped_collection(lambda entity: entity.a + entity.b))
})

item = Item()
item.notes['color'] = Note('color', 'blue') 
```

但我想要以下行为：

```
mapper(Item, items_table, properties={
# key by column
'notes': relation(...),
})

item = Item()
item.notes['color'] = 'blue' 
```

在 SQLAlchemy 中可能吗？

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-24T00:21:28.013

简单的答案是**肯定**的。

只需使用关联代理：

```
from sqlalchemy import Column, Integer, String, Table, create_engine
from sqlalchemy import orm, MetaData, Column, ForeignKey
from sqlalchemy.orm import relation, mapper, sessionmaker
from sqlalchemy.orm.collections import column_mapped_collection
from sqlalchemy.ext.associationproxy import association_proxy 
```

创建测试环境：

```
engine = create_engine('sqlite:///:memory:', echo=True)
meta = MetaData(bind=engine) 
```

定义表：

```
tb_items = Table('items', meta, 
        Column('id', Integer, primary_key=True), 
        Column('name', String(20)),
        Column('description', String(100)),
    )
tb_notes = Table('notes', meta, 
        Column('id_item', Integer, ForeignKey('items.id'), primary_key=True),
        Column('name', String(20), primary_key=True),
        Column('value', String(100)),
    )
meta.create_all() 
```

类（注意`association_proxy`类中的）：

```
class Note(object):
    def __init__(self, name, value):
        self.name = name
        self.value = value
class Item(object):
    def __init__(self, name, description=''):
        self.name = name
        self.description = description
    notes = association_proxy('_notesdict', 'value', creator=Note) 
```

映射：

```
mapper(Note, tb_notes)
mapper(Item, tb_items, properties={
        '_notesdict': relation(Note, 
             collection_class=column_mapped_collection(tb_notes.c.name)),
    }) 
```

然后只需测试它：

```
Session = sessionmaker(bind=engine)
s = Session()

i = Item('ball', 'A round full ball')
i.notes['color'] = 'orange'
i.notes['size'] = 'big'
i.notes['data'] = 'none'

s.add(i)
s.commit()
print i.notes 
```

打印：

```
{u'color': u'orange', u'data': u'none', u'size': u'big'} 
```

但是，那些在笔记表中吗？

```
>>> print list(tb_notes.select().execute())
[(1, u'color', u'orange'), (1, u'data', u'none'), (1, u'size', u'big')] 
```

有用！！:)

* * *

## 回答 #2

> 赞同：-6
> 
> 时间：2009-04-23T10:25:39.830

简单回答是不'。

SQLAlchemy 是 SQL 数据库的包装器。

您引用的关系示例将 SQL 表之间的关系转换为类似于 Python 映射的结构，以使执行 SQL SELECT 语句和在另一个表中定位行变得稍微简单一些。

这

```
item.notes['color'] = Note('color', 'blue') 
```

是必不可少的，因为它`Note`是一个包含两列的单独表。你不能把这`Note`部分放在外面。

您必须定义此其他 SQL 表，并且必须创建映射到该 SQL 表的对象。

# asp.net-mvc - 有条件地显示我的视图的一部分

> ID：780782
> 
> 赞同：3
> 
> 时间：2009-04-23T08:22:27.863
> 
> 标签：asp.net-mvc

假设我有一个 asp.net mvc 网站，其中有一个列出产品的页面。在该页面上，我有一个“删除”按钮，该按钮应该只显示给插入产品的用户。最好的方法是什么？

我想到的一种方法是在控制器中设置一个布尔值，让视图知道是否应该显示按钮。就像是：

```
if(IsProductOwner(UserId))
    ViewData["CanDelete"] = true; 
```

然后在视图中我可以做

```
<% if((boolean)ViewData["CanDelete"] == true) { %>
    // show delete button
<% } %> 
```

但是有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T08:33:55.307

我最初的想法是，你至少应该把它作为 Product 类的一个函数，这样你就可以去：

```
<% if (product.IsOwnedBy(UserId)) { %>
    // show delete button
<% } %> 
```

这消除了一些浮动的 ViewData 并将业务逻辑构建到您的类中，而不是在边缘浮动。

但是，我还没有找到一种体面的方法来在视图中进行这种条件显示，除非视图明显不同，然后我可以根据上下文显示不同的视图。

# asp.net - WebInfo 文件是否应该从 SVN 中排除

> ID：780793
> 
> 赞同：2
> 
> 时间：2009-04-23T08:27:37.443
> 
> 标签：asp.net, svn, file

我最近在签出同事的 ASP.NET 项目时遇到了一些问题，这导致项目进入冲突状态，因为 WEBINFO 文件被签入 SVN。

这个文件需要在存储库中还是我们应该排除它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T11:00:01.073

是的，我认为*.webinfo*应该被排除在外。（关于 webinfo 的一些信息：[如何在不同的本地计算机之间复制和配置 ASP.NET 项目](http://www.codeproject.com/KB/aspnet/VSNETcopyproject.aspx?display=PrintAll&fid=162397&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=26)）

# r - Emacs ESS 模式 - 用于评论区域的选项卡

> ID：780796
> 
> 赞同：54
> 
> 时间：2009-04-23T08:29:19.500
> 
> 标签：r, emacs, ess

我正在为 Emacs 使用 Emacs-Speaks-Statistics (ESS) 模式。编辑 R 代码时，当我在其上方创建新行时，任何注释行（以 # 开头的注释行）都会自动在最右边添加标签。我应该如何更改我的 .emacs.el 文件来解决这个问题？

例如，我有：

```
# Comment 
```

现在，将光标放在行首并按 Enter 后，我得到：

```
 # Comment 
```

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-04-23T10:51:09.503

如果您不想缩进注释，请使用“###”。根据[手册](http://ess.r-project.org/Manual/ess.html#Indenting)，

> 默认情况下，以“###”开头的注释与行首对齐。以“##”开头的注释与包含该注释的块的当前缩进级别对齐。最后，以 '#' 开头的注释与右侧的列对齐（默认情况下为第 40 列，但此值由变量comment-column 控制）或在包含注释的行上的表达式之后（如果它扩展）超出缩进列。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-23T09:20:56.240

任何一个

```
(setq ess-fancy-comments nil) 
```

如果你不想缩进单个`#`评论，或者

```
(add-hook 'ess-mode-hook 
          (lambda () 
            (local-set-key (kbd "RET") 'newline))) 
```

如果您想更改 Enter 的行为，使其不缩进。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-11-24T13:53:06.637

设置`ess-indent-with-fancy-comments`为 nil 将删除奇怪的单`#`缩进，但它必须在一个钩子中本地设置缓冲区（如 Rob 的回答），或者在加载 ESS 之前：

```
(setq ess-indent-with-fancy-comments nil)
(require 'ess) 
```

确保在加载 ESS 之前设置它的其他方法是将其设置在 中`M-x configure`，或将其设置`:init`在`use-package`.

发生的事情是 ESS 在初始化时定义样式`ess-style-alist`，然后在每个缓冲区中应用默认样式。因此，为了确保这些样式尊重`ess-indent-with-fancy-comment`，您必须确保在定义样式之前对其进行设置。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-10-19T05:00:16.437

Jouni 的回答对我不起作用。但我在这里找到了一种方法： [https ://stat.ethz.ch/pipermail/ess-help/2016-May/010970.html](https://stat.ethz.ch/pipermail/ess-help/2016-May/010970.html)

```
 (defun my-ess-settings ()
     (setq ess-indent-with-fancy-comments nil))
   (add-hook 'ess-mode-hook #'my-ess-settings) 
```

# iphone - 有没有办法通过代码在 iPhone 上配置电子邮件帐户？

> ID：780803
> 
> 赞同：0
> 
> 时间：2009-04-23T08:34:33.467
> 
> 标签：iphone

我是 iPhone 开发的新手。我有兴趣通过代码在 iPhone 上配置电子邮件帐户。可能吗？SDK中是否有任何API来实现这一点？

提前感谢您的回答。

问候， M. Wolniewicz

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T12:28:11.487

不幸的是，您无法通过代码在未越狱的 iPhone 上配置电子邮件帐户。

# c++ - 在 C++ 中填充静态成员容器

> ID：780805
> 
> 赞同：13
> 
> 时间：2009-04-23T08:35:13.480
> 
> 标签：c++, stl

我有一个静态类成员，它是一些容器，比如

(Foo.h)

```
class Foo
{
   ...
private:
   static list<string> s_List;
} 
```

我需要用一些特定的值填充列表。实际上它也应该是**const**，但这可能会使问题进一步复杂化。所有的类成员函数都是静态的，所以在构造函数中初始化它没有意义。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-23T08:43:13.833

一个常见的解决方案是做这样的事情：

```
// header
class Foo
{
...
private:
   static list<string> s_List;
}

// cpp
list<string> init()
{
     list<string> tmp;
     ... fill tmp with strings

     return tmp;
 }

 list<string> Foo::s_List(init()); 
```

另一种方法就像 Neil Butterworth 建议的那样。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-23T08:40:24.730

另一种选择是创建一个简单的初始化程序类：

```
list <string> Foo::s_List;

struct Init {
   Init() {
      Foo::s_List.insert("apple");
      Foo::s_List.insert("bannana");
      Foo::s_List.insert("grapes");
   }
};

static Init doInit; 
```

请注意，由于列表是私有的，这可能需要您让 Init 成为 Foo 的朋友。使这些类包含在它们正在初始化的类中通常也很方便。

但是，我只是重新阅读了您的问题，然后又出现了另一个想法-如果列表是 const，您可能不会更改它，在这种情况下，使用按排序顺序初始化的字符串的简单数组可能是更好的解决方案。搜索（使用 std::binary_search）肯定会比列表更快，当然也可以很容易地初始化。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-05-07T18:03:15.983

如果您的编译器支持 C++0x，这实际上是微不足道的。

```
#include <iostream>
#include <list>

class Foo
{
public:
   static std::list<std::string> s_List;
};

std::list<std::string> Foo::s_List = {"hello", "world", "asdf", "qwerty"};

int main()
{
    for(const std::string& str : Foo::s_List)
        std::cout << str << std::endl;

    return 0;
} 
```

这适用于 const 和非常量静态成员。我已经用 clang-4.2、gcc-4.7、gcc-4.6 和 gcc-4.5 测试了这个片段。Gcc-4.5 不支持更新**的 for**语法，因此您必须使用带有迭代器的传统**for**循环。另外，不要忘记将**-std=c++0x**标志传递给编译器。我相当有信心 Visual Studio 也支持这一点，但我不确定也不知道哪些版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T14:50:30.130

这取决于您需要在该列表中放入哪些值。它们是静态的还是需要某种形式的计算？

如果它们是静态的，您可以这样做：

```
namespace {
   const char* const initVals[] = { "A", "B", "C" };
}

list<string> Foo::s_list(initVals, initVals + 3); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T08:36:35.253

**我（问题的​​作者）试图做到这一点的方式是徒劳的。**

* * *

我试着做一些事情（在 Foo.cpp 中）：

```
list<string> Foo::s_List = list<string>();
Foo::s_List.insert("apple");
Foo::s_List.insert("bannana");
Foo::s_List.insert("grapes"); 
```

但这会产生编译器错误。

* * *

然后我想到了创建一个 Initialize() 方法并直接从代码中调用它

```
void Foo::Initialize()
{
    s_List.insert("rats");
    s_List.insert("cats");
}

Foo::Initialize(); 
```

// 错误：编译器认为这是对方法的重新定义，而不是调用。

* * *

剩下的唯一可行的想法（还没有尝试过）是检查列表是否在每个使用它的方法中为空，如果是，则调用 Initialize()。但这很丑！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T08:37:15.690

一种可能的解决方案是使用访问器方法来检查它是否已初始化，如果未初始化则执行此操作。

# svn - msbuild 社区任务和 Svn 提交

> ID：780808
> 
> 赞同：3
> 
> 时间：2009-04-23T08:36:31.527
> 
> 标签：svn, msbuild

我目前正在使用 tigris 开源项目 MSBuild 社区任务，但 SvnCommit 任务遇到了一些问题。我真的不知道如何使用 Targets 属性我的项目中有这一行：

```
<SvnCommit Username="myName" Password="myPsswd" LocalPath="$(myPath)" ToolPath="$(SvnPath)" Targets="myFile.zip"/> 
```

我有一个错误：“c:\blabla”——它是 $(myPath) 的一部分——不是工作副本；svn : 无法打开文件'c:\blabla.svn\Entries"

如果有人有一些想法，欢迎他们！

也许我使用 RepositoryPath 属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T09:43:47.013

好的，我发现了我的问题，这太愚蠢了，我真的为这个网站上的噪音道歉。顺便说一句，如果它可以帮助遇到相同pb的人......

所以问题是我的“目标”属性！我不得不使用 ItemGroup ：所以我在我的项目中添加了以下几行

```
<ItemGroup>
  <ToCommit Include="$(myPath)/myFile.zip" />
</ItemGroup> 
```

并更改了任务：

```
<SvnCommit Username="myName" Password="myPsswd" LocalPath="$(myPath)" ToolPath="$(SvnPath)" Targets="@(ToCommit)"/> 
```

# java - 使用 Java5 验证 XSD 时出现问题

> ID：780811
> 
> 赞同：2
> 
> 时间：2009-04-23T08:38:04.517
> 
> 标签：java, xml, validation, xsd

我正在尝试使用 Java 5（JRE 1.5.0 更新 11）验证 Atom 提要。我的代码在 Java 6 中没有问题，但在 Java 5 中运行时失败

```
org.xml.sax.SAXParseException: src-resolve: Cannot resolve the name 'xml:base' to a(n) 'attribute declaration' component. 
```

我想我记得读过一些关于与 Java 5 捆绑的 Xerces 版本在某些模式方面存在一些问题的信息，但我找不到解决方法。这是一个已知问题吗？我的代码中有错误吗？

```
public static void validate() throws SAXException, IOException {
    List<Source> schemas = new ArrayList<Source>();
    schemas.add(new StreamSource(AtomValidator.class.getResourceAsStream("/atom.xsd")));
    schemas.add(new StreamSource(AtomValidator.class.getResourceAsStream("/dc.xsd")));

    // Lookup a factory for the W3C XML Schema language
    SchemaFactory factory = SchemaFactory.newInstance("http://www.w3.org/2001/XMLSchema");

    // Compile the schemas.
    Schema schema = factory.newSchema(schemas.toArray(new Source[schemas.size()]));
    Validator validator = schema.newValidator();

    // load the file to validate
    Source source = new StreamSource(AtomValidator.class.getResourceAsStream("/sample-feed.xml"));

    // check the document
    validator.validate(source);
} 
```

**更新：**我尝试了下面的方法，但如果我使用 Xerces 2.9.0，我仍然会遇到同样的问题。我还尝试将 xml.xsd 添加到模式列表中（因为 xml:base 在 xml.xsd 中定义）但这次我有

```
Exception in thread "main" org.xml.sax.SAXParseException: schema_reference.4: Failed to read schema document 'null', because 1) could not find the document; 2) the document could not be read; 3) the root element of the document is not <xsd:schema>. 
```

**更新 2：**我尝试使用 VM 参数配置代理，`-Dhttp.proxyHost=<proxy.host.com> -Dhttp.proxyPort=8080`现在它可以工作了。我会尝试在家中发布“真实答案”。

*抱歉，我无法回复评论：由于安全原因，XHR 被禁用工作......*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T10:57:22.390

事实上，人们一直在提到 Java 5 Sun 提供的 SchemaFactory 会带来麻烦。

那么：您自己是否将 Xerces 包含在您的项目中？

包含 Xerces 后，您需要确保它正在被使用。如果您想对其进行硬编码（好吧，作为最低要求，您可能会使用一些应用程序属性文件来启用和填充以下代码）：

```
String schemaFactoryProperty = 
  "javax.xml.validation.SchemaFactory:" + XMLConstants.W3C_XML_SCHEMA_NS_URI;

System.setProperty(schemaFactoryProperty,
   "org.apache.xerces.jaxp.validation.XMLSchemaFactory");

SchemaFactory factory = 
  SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI); 
```

或者，如果您不想硬编码，或者当您的麻烦代码位于某些您无法更改的第三方库中时，请在`java`命令行或环境选项中设置它。例如（当然是一行）：

```
set JAVA_OPTS = 
  "-Djavax.xml.validation.SchemaFactory:http://www.w3.org/2001/XMLSchema
  =org.apache.xerces.jaxp.validation.XMLSchemaFactory" 
```

顺便说一句：除了 Sun 包含的 SchemaFactory 实现会带来麻烦（类似于`com.sun.org.apache.xerces.internal.jaxp.validation.xs.schemaFactoryImpl`），似乎在该版本中“发现”非 JDK 实现也失败了。如果我理解正确，通常只包含 Xerces 实际上会使[SchemaFactory#newInstance](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/validation/SchemaFactory.html#newInstance(java.lang.String))找到包含的库，并使其优先于 Sun 实现。据我所知，这在 Java 5 中也失败了，因此需要进行上述配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T11:28:23.637

> 我尝试使用 VM 参数配置代理，`-Dhttp.proxyHost=<proxy.host.com> -Dhttp.proxyPort=8080`现在它可以工作了。

啊，我没有意识到这`xml.xsd`实际上是引用为[http://www.w3.org/2001/xml.xsd](http://www.w3.org/2001/xml.xsd)或类似的东西。这应该教会我们始终显示一些 XML 和 XSD 片段。;-)

`xml.xsd`那么，我是否正确假设 1.) 要修复 Java 5 问题，您仍然需要包含 Xerces 并设置系统属性，并且 2.) 您在本地没有可用的？

在找到解决方案之前，您是否碰巧尝试使用`getResource`而不是`getResourceAsStream`, 来查看异常是否会向您显示更多详细信息？

如果你确实有`xml.xsd`可用的（所以：如果`getResource`确实产生了一个 URL）那么我想知道 Xerces 试图从互联网上获取什么。或者您在添加自己的架构之前没有将该架构添加到列表中？顺序很重要：必须首先添加依赖项。

对于使用搜索解决问题的人：也许使用自定义[EntityResolver](http://xerces.apache.org/xerces-j/apiDocs/org/xml/sax/EntityResolver.html)也可以指示问题的根源（如果只是在日志中写入一些内容并返回`null`告诉 Xerces 使用默认行为）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T17:05:29.920

嗯，只是阅读你的“评论”——编辑不会提醒人们有新的回复，所以有时间向你的老板索要一些 iPhone 或其他直接连接到网络的小工具 ;-)

好吧，我假设您添加了：

```
schemas.add(
  new StreamSource(AtomValidator.class.getResourceAsStream("/xml.xsd"))); 
```

如果是这样，是`xml.xsd`不是真的要在classpath上找到呢？我想知道在你的情况下是否`getResourceAsStream`没有屈服，那么将如何行动。`null``new StreamSource(null)`

即使`getResourceAsStream`没有 yield `null`，结果`StreamSource`仍然不知道它是从哪里加载的，这在尝试包含引用时可能是个问题。那么，如果您使用构造函数[StreamSource(String systemId)](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/transform/stream/StreamSource.html#StreamSource(java.lang.String))代替：

```
schemas.add(new StreamSource(AtomValidator.class.getResource("/atom.xsd")));
schemas.add(new StreamSource(AtomValidator.class.getResource("/dc.xsd"))); 
```

您也可以使用[StreamSource(InputStream inputStream, String systemId)](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/transform/stream/StreamSource.html#StreamSource(java.io.InputStream,%20java.lang.String))，但我看不出比上述两行有任何优势。但是，文档解释了为什么在两个构造函数中传递 systemId 看起来不错：

> 除了输入流之外，此构造函数还允许设置 systemID，从而允许处理相对 URI。

同样，[setSystemId(String systemId)](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/transform/stream/StreamSource.html#setSystemId(java.lang.String))解释了一点：

> 如果存在字节流或字符流，则系统标识符是可选的，但提供一个仍然有用，因为应用程序可以使用它来解析相对 URI，并且可以将其包含在错误消息和警告中（解析器将尝试只有在没有指定字节流或字符流时才打开到 URI 的连接）。

如果这不起作用，那么也许一些自定义错误处理程序可以为您提供更多详细信息：

```
ErrorHandlerImpl errorHandler = new ErrorHandlerImpl();
validator.setErrorHandler(errorHandler);
:
:
validator.validate(source);

if(errorHandler.hasErrors()){
    LOG.error(errorHandler.getMessages());
    throw new [..];
}
if(errorHandler.hasWarnings()){
    LOG.warn(errorHandler.getMessages());
} 
```

...使用以下 ErrorHandler 捕获验证错误并尽可能继续解析：

```
import org.xml.sax.helpers.DefaultHandler;
private class ErrorHandlerImpl extends DefaultHandler{
    private String messages = "";
    private boolean validationError = false;
    private boolean validationWarning = false;

    public void error(SAXParseException exception) throws SAXException{
        messages += "Error: " + exception.getMessage() + "\n";
        validationError = true;
    }

    public void fatalError(SAXParseException exception) throws SAXException{
        messages += "Fatal: " + exception.getMessage();
        validationError = true;
    }

    public void warning(SAXParseException exception) throws SAXException{
        messages += "Warn: " + exception.getMessage();
        validationWarning = true;
    }

    public boolean hasErrors(){
        return validationError;
    }

    public boolean hasWarnings(){
        return validationWarning;
    }

    public String getMessages(){
        return messages;
    }
} 
```

# c# - 从 C++ 到 C# 的惊喜

> ID：780815
> 
> 赞同：4
> 
> 时间：2009-04-23T08:41:21.297
> 
> 标签：c#, c++, language-comparisons

我是一名进入 C# 的 C++ 程序员。我使用这门语言工作了一个月，理解了很多概念。

从 C++ 迁移到 C# 时，我可能会遇到哪些惊喜？我被警告说析构函数没有按我的意图执行。最近我尝试用泛型做一些事情，将 T 作为基类。那没有用。我还有另一个问题，但我会将其归结为缺乏 C# 经验。我也很惊讶我的应用程序正在占用 RAM，然后我发现我需要`.dispose`在一个功能中使用。（我认为它会像智能指针一样清理）

还有什么可能让我感到惊讶？

请不要语言抨击。我怀疑有人会，但以防万一......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T08:47:16.400

幸运的是，微软在这里提供了一些信息：[C# for C++ Developers](http://msdn.microsoft.com/en-us/library/yyaad03b.aspx)。

结构与类的差异是 C++ 起源的另一个大问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T08:45:53.203

我想你已经涵盖了主要的。您应该阅读垃圾收集，了解为什么没有析构函数，找出[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)模式（哪种替换析构函数）。我会说那是一个大的。

我要说的唯一另一件事是警告您 C# 和 .Net 基类库非常大，要充分利用它，还有很多东西要学习...一旦您了解了垃圾收集的基础知识和您将要查看 LINQ 的类型系统，并且您应该花时间探索您所在领域的相关库/框架（例如 WPF、WCF、ASP.Net 等）。但这一切都很好。我从 C++ 迁移到 C# 并且再也不会回去了，我发现它的效率更高（我不是在抨击 C++，我仍然会尝试:-)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T08:52:57.913

几个月前我做了几乎相同的更改（在此之前我对 Java 进行了更改 - 但我并没有花太多时间编写 Java）。

以下是我遇到的一些最大的陷阱：

**属性 vs. 变量 vs. Setter**

我踏入的最大陷阱之一是知道您是否必须更改属性或设置变量或使用 setter 来设置类的某些方面。

**IList vs. List vs. 其他集合**

了解 IList、List 和所有其他集合之间的区别（IMO 你真的不能用 IList 做很多事情）。

**泛型确实有自己的陷阱**

如果你打算使用很多泛型，也许阅读这篇文章可以帮助你避免我的一些错误： [检查一个类是否派生自一个泛型类](https://stackoverflow.com/questions/457676/c-reflection-check-if-a-class-is-derived-from-a-generic-class/458753#458753)

但总的来说，我会说这种变化非常轻松。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T08:53:12.547

好吧，这两种语言是完全不同的，我相信你已经意识到，如果你曾经使用过 C#。你在 C# 中没有像在 C++ 中那样强大的宏或模板（我意识到 C# 中有泛型）。就记忆而言，请记住您不再处于严格控制的环境中。预计在任务管理器和类似工具中会看到大量内存使用情况，这是正常的。有更好、更细粒度的性能计数器可以查看真实的内存使用情况。此外，您可能不需要像您想象的那样调用 dispose（顺便说一下，如果您还没有的话，请查看“使用”块）。

另一个明确的是默认构造函数，在 C# 中这不会创建新的 Foo 对象：

```
Foo myFoo; 
```

除非您将其视为具有对象类型的引用，否则您不能拥有像“空指针”这样的东西。同样，您需要将 Properties 视为方法的语法糖，而不是公共成员，因为它们在 C++ 语法中看起来。

确保您了解“out”和“ref”参数。

显然这不是一个大列表，只是一些“指针”（没有双关语）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T09:09:24.800

这是一个相当大的话题。一些想法：

**C# 是垃圾收集。**并不意味着您可以停止关注资源分配，但通常您不必担心最常见的资源：内存。

**在 C# 中，一切都是对象。**没有“原始”数据类型，甚至 int 也是一个对象。

**C# 有泛型，而不是模板。**模板比 C# 的类似语法的泛型更丰富、更复杂，但泛型仍然提供了模板的几乎所有实用功能，而且没有很多令人头疼的问题。

**C# 具有接口和单一继承。**您可能会在 C++ 中寻找多重继承，而不是寻找使用接口或不同的设计模式（例如策略）。

**C# 有委托而不是函数指针。**委托基本上只是一个类型化的函数指针。委托和委托关系（lambda 表达式、事件、谓词等）的使用非常强大，值得投入大量精力研究。

**C# 支持收益返回。**这是 C# 做事方式的基础。迭代某个集合的最常见形式是使用 foreach。了解 IEnumerable 和迭代器的工作原理是值得的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T08:46:07.120

对象模型的差异。例如，值和引用类型在定义上是分开的，而不是根据它们的实例化方式。这有一些惊喜，例如

```
myWinForm.Size.Width = 100; 
```

不会改变宽度，您需要创建一个新的 Size 实例并分配它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T11:41:59.757

一些我没见过的东西在 C++ 中不可用并且可能有点令人惊讶的是[属性](http://msdn.microsoft.com/en-us/library/aa288059(VS.71).aspx)和[反射](http://msdn.microsoft.com/en-us/library/ms173183(VS.80).aspx)

这样的属性不会给你完整的[AOP](http://www.postsharp.org/)。但是，它们确实允许您以与在 C++ 中解决它们的方式非常不同的方式来解决一堆问题。

# xml - XML Schema：为什么不能 有 孩子们？以及如何绕过？

> ID：780817
> 
> 赞同：17
> 
> 时间：2009-04-23T08:42:19.907
> 
> 标签：xml, xsd

我正在尝试为一个`<property>`元素创建一个模式，该元素必须具有一个`<key>`子元素，以及一个`<val>`, `<shell>`or`<perl>`和一个可选的`<os>`or `<condition>`，并且子元素的顺序无关紧要。

以下是一些有效`<property>`元素的示例：

```
<property>
  <key>A</key>
  <val>b</val>
</property>

<property>
  <key>A</key>
  <val>b</val>
  <os>Windows</os>
</property>

<property>
  <condition>a == 1</condition>
  <key>A</key>
  <perl>1+1</perl>
  <os>unix</os>
</property> 
```

理想情况下，我想`<xs:all>`为此使用：

```
<xs:element name="property">
  <xs:complexType>
    <xs:all>
      <xs:element name="key" type="xs:string" />
      <xs:choice>
        <xs:element name="val" type="xs:string" />
        <xs:element name="perl" type="xs:string" />
        <xs:element name="shell" type="xs:string" />
      </xs:choice>
      <xs:element name="os" type="xs:string" minOccurs="0" />
      <xs:element name="condition" type="xs:string" minOccurs="0" />
    </xs:all>
  </xs:complexType>
</xs:element> 
```

但我发现`<xs:all>`可以包含 only`<xs:element>`和 not `<xs:choice>`。有人可以解释为什么吗？

更重要的是，有人可以提供一种方法来验证这样的`<property>`元素吗？

我可以将三个元素 -`<val>`和`<perl>`-`<shell>`作为可选元素放在 中`<xs:all>`，但我希望架构验证三个元素中的一个且仅一个存在于元素中。这可以做到吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-23T13:38:00.850

我认为这更好一些，因为“选择”现在是它自己的元素（typeFacet），但不能直接使用，因为它是抽象的。

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="property">
    <xs:complexType>
      <xs:all>
        <xs:element name="key" type="xs:string" />
        <xs:element ref="typeFacet" />
        <xs:element name="os" type="xs:string" minOccurs="0" />
        <xs:element name="condition" type="xs:string" minOccurs="0" />
      </xs:all>
    </xs:complexType>
  </xs:element>

  <xs:element name="typeFacet" abstract="true" />
  <xs:element name="val" type="xs:string"   substitutionGroup="typeFacet" />
  <xs:element name="perl" type="xs:string" substitutionGroup="typeFacet" />
  <xs:element name="shell" type="xs:string" substitutionGroup="typeFacet" />
</xs:schema> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-23T13:16:29.403

基于 newt 关于使用替换组进行选择的评论（使用 xmllint 测试）：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="property">
    <xs:complexType>
      <xs:all>
        <xs:element name="key" type="xs:string" />
        <xs:element ref="val"/>
        <xs:element name="os" type="xs:string" minOccurs="0" />
        <xs:element name="condition" type="xs:string" minOccurs="0" />
      </xs:all>
    </xs:complexType>
  </xs:element>

  <xs:element name="val" type="xs:string"/>
  <xs:element name="perl" type="xs:string" substitutionGroup="val" />
  <xs:element name="shell" type="xs:string"  substitutionGroup="val" />
</xs:schema> 
```

# unit-testing - 如何对 Arduino 代码进行单元测试？

> ID：780819
> 
> 赞同：214
> 
> 时间：2009-04-23T08:43:15.300
> 
> 标签：unit-testing, embedded, arduino, avr, avr-gcc

我希望能够对我的 Arduino 代码进行单元测试。理想情况下，我可以运行任何测试，而无需将代码上传到 Arduino。哪些工具或库可以帮助我解决这个问题？

开发中的[Arduino 仿真器](http://radpartbrainmat.blogspot.com/search/label/arduemu)可能很有用，但似乎还没有准备好使用。

[Atmel 的AVR Studio](http://www.atmel.com/dyn/Products/tools_card.asp?tool_id=2725)包含一个可能有用的芯片模拟器，但我不知道如何将它与 Arduino IDE 结合使用。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2012-07-11T16:46:03.797

# 不要在 Arduino 设备或仿真器上运行单元测试

### 针对微控制器设备/仿真器/基于 Sim 的测试的案例

> 关于*单元测试*的含义有很多讨论，我并不是真的想在这里对此进行争论。这篇文章*并不是* 要您避免对最终目标硬件进行*所有*实际测试。我试图通过从最普通和最频繁的测试中消除您的目标硬件来优化您的开发反馈周期。假设被测单元比整个项目小得多。

单元测试的目的是测试你自己代码的质量。单元测试通常不应该测试您无法控制的因素的功能。

这样想：即使您要测试 Arduino 库、微控制器硬件或仿真器的功能，这些测试结果也*绝对不可能*告诉您有关您自己工作质量的任何信息。因此，编写不在目标设备（或模拟器）上运行的单元测试更有价值和更有效。

对目标硬件进行频繁测试的周期非常缓慢：

1.  调整你的代码
2.  编译并上传到 Arduino 设备
3.  观察行为并猜测**您的**代码是否按照您的预期执行
4.  重复

如果您希望通过串行端口获得诊断消息，但您的项目本身需要使用您的 Arduino 唯一的硬件串行端口，则第 3 步尤其令人讨厌。如果您认为 SoftwareSerial 库可能会有所帮助，您应该知道这样做可能会破坏任何需要准确时序的功能，例如同时生成其他信号。这个问题发生在我身上。

同样，如果您要使用仿真器测试您的草图，并且您的时间关键程序运行完美，直到您上传到实际的 Arduino，那么您要学习的唯一教训是仿真器有缺陷——并且仍然知道这一点*没有*透露*你自己*工作的质量。

## 如果在设备或模拟器上测试很傻，我该怎么*办*？

您可能正在使用计算机来处理您的 Arduino 项目。那台计算机比微控制器快几个数量级。编写测试以在您的计算机上构建和*运行*。

请记住，应**假定 Arduino 库和微控制器的行为正确或至少*始终*不正确**。

当您的测试产生的输出与您的预期相反时，您的测试代码中可能存在缺陷。如果您的测试输出符合您的期望，但是当您将程序上传到 Arduino 时，它的行为不正确，那么您就知道您的测试是基于不正确的假设，并且您可能有一个有缺陷的测试。无论哪种情况，您都将真正了解下一次代码更改应该是什么。您的反馈质量从“*某事*已损坏”提高到**“此*特定代码*已损坏”**。

## 如何在您的 PC 上构建和运行测试

您需要做的第一件事是**确定您的测试目标**。*考虑一下您想要测试您自己代码*的哪些部分，然后确保以您可以**隔离离散部分**进行测试的方式构建您的程序。

如果您要测试的部件调用任何 Arduino 函数，您将需要在测试程序中提供模型替换。这比看起来要少得多。除了为测试提供可预测的输入和输出外，您的模型实际上不需要做任何事情。

您打算测试的任何您自己的代码都需要存在于 .pde 草图以外的源文件中。不用担心，即使使用草图之外的一些源代码，您的草图仍然可以编译。当你真正开始使用它时，应该在草图文件中定义程序的正常入口点。

剩下的就是编写实际测试，然后使用您最喜欢的 C++ 编译器对其进行编译！这可能最好用一个现实世界的例子来说明。

### 一个实际的工作示例

[我在这里](https://github.com/IronSavior/dsm2_tx)找到的一个宠物项目有一些在 PC 上运行的简单测试。对于这个答案提交，我将回顾一下我如何模拟一些 Arduino 库函数以及我为测试这些模型而编写的测试。这与我之前所说的不测试其他人的代码并不矛盾，因为我是编写模型的人。我想非常确定我的模型是正确的。

mock_arduino.cpp 的源代码，其中包含复制 Arduino 库提供的一些支持功能的代码：

```
#include <sys/timeb.h>
#include "mock_arduino.h"

timeb t_start;
unsigned long millis() {
  timeb t_now;
  ftime(&t_now);
  return (t_now.time  - t_start.time) * 1000 + (t_now.millitm - t_start.millitm);
}

void delay( unsigned long ms ) {
  unsigned long start = millis();
  while(millis() - start < ms){}
}

void initialize_mock_arduino() {
  ftime(&t_start);
} 
```

当我的代码将二进制数据写入硬件串行设备时，我使用以下模型生成可读输出。

fake_serial.h

```
#include <iostream>

class FakeSerial {
public:
  void begin(unsigned long);
  void end();
  size_t write(const unsigned char*, size_t);
};

extern FakeSerial Serial; 
```

fake_serial.cpp

```
#include <cstring>
#include <iostream>
#include <iomanip>

#include "fake_serial.h"

void FakeSerial::begin(unsigned long speed) {
  return;
}

void FakeSerial::end() {
  return;
}

size_t FakeSerial::write( const unsigned char buf[], size_t size ) {
  using namespace std;
  ios_base::fmtflags oldFlags = cout.flags();
  streamsize oldPrec = cout.precision();
  char oldFill = cout.fill();

  cout << "Serial::write: ";
  cout << internal << setfill('0');

  for( unsigned int i = 0; i < size; i++ ){
    cout << setw(2) << hex << (unsigned int)buf[i] << " ";
  }
  cout << endl;

  cout.flags(oldFlags);
  cout.precision(oldPrec);
  cout.fill(oldFill);

  return size;
}

FakeSerial Serial; 
```

最后是实际的测试程序：

```
#include "mock_arduino.h"

using namespace std;

void millis_test() {
  unsigned long start = millis();
  cout << "millis() test start: " << start << endl;
  while( millis() - start < 10000 ) {
    cout << millis() << endl;
    sleep(1);
  }
  unsigned long end = millis();
  cout << "End of test - duration: " << end - start << "ms" << endl;
}

void delay_test() {
  unsigned long start = millis();
  cout << "delay() test start: " << start << endl;
  while( millis() - start < 10000 ) {
    cout << millis() << endl;
    delay(250);
  }
  unsigned long end = millis();
  cout << "End of test - duration: " << end - start << "ms" << endl;
}

void run_tests() {
  millis_test();
  delay_test();
}

int main(int argc, char **argv){
  initialize_mock_arduino();
  run_tests();
} 
```

这篇文章已经够长了，所以请参考[我在 GitHub 上的项目](https://github.com/IronSavior/dsm2_tx)，看看更多的实际测试用例。我将正在进行的工作保存在 master 以外的分支中，因此也要检查这些分支以进行额外的测试。

我选择编写自己的轻量级测试例程，但也可以使用更强大的单元测试框架，例如 CppUnit。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2009-04-26T20:12:38.663

在没有任何预先存在的 Arduino 单元测试框架的情况下，我创建了[ArduinoUnit](http://github.com/mmurdoch/arduinounit/)。这是一个简单的 Arduino 草图，展示了它的用途：

```
#include <ArduinoUnit.h>

// Create test suite
TestSuite suite;

void setup() {
    Serial.begin(9600);    
}

// Create a test called 'addition' in the test suite
test(addition) {
    assertEquals(3, 1 + 2);
}

void loop() {
    // Run test suite, printing results to the serial port
    suite.run();
} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-23T13:13:53.247

通过抽象出硬件访问并在我的测试中模拟它，我在单元测试我的 PIC 代码方面取得了相当大的成功。

例如，我将 PORTA 抽象为

```
#define SetPortA(v) {PORTA = v;} 
```

然后可以轻松地模拟 SetPortA，而无需在 PIC 版本中添加开销代码。

一旦对硬件抽象进行了一段时间的测试，我很快就会发现通常代码会从测试台转到 PIC 并且第一次就可以工作。

**更新：**

我对单元代码使用#include seam，在测试装备的 C++ 文件中包含单元代码，为目标代码使用 C 文件。

例如，我想多路复用四个 7 段显示器，一个端口驱动段，第二个端口选择显示器。显示代码通过`SetSegmentData(char)`和与显示接口`SetDisplay(char)`。我可以在我的 C++ 测试台中模拟这些并检查我是否得到了我期望的数据。对于我使用的目标`#define`，这样我就可以直接分配而没有函数调用的开销

```
#define SetSegmentData(x) {PORTA = x;} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-11-20T21:08:23.003

似乎[emulino](http://ghewgill.livejournal.com/129929.html)可以完美地完成这项工作。

> Emulino 是 Greg Hewgill 的 Arduino 平台仿真器。（[来源](https://wiki.ubuntu.com/Emulino)）

[GitHub存储库](https://github.com/ghewgill/emulino)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2010-02-01T17:25:01.440

[simavr](https://gitorious.org/simavr)是一个使用 avr-gcc的 AVR*模拟器。*

它已经支持一些 ATtiny 和 ATMega 微控制器，并且根据作者的说法，很容易添加更多。

示例中有 simduino，一个 Arduino 仿真器。它支持运行 Arduino 引导加载程序，并且可以通过[Socat](https://en.wikipedia.org/wiki/Netcat#Variants)（修改后的[Netcat](https://en.wikipedia.org/wiki/Netcat)）使用 avrdude 进行编程。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-10-24T10:44:46.877

[您可以使用我的项目PySimAVR](https://github.com/ponty/pysimavr)在 Python 中进行单元测试。**Arscons**用于构建，**simavr**用于模拟。

例子：

```
from pysimavr.sim import ArduinoSim    
def test_atmega88():
    mcu = 'atmega88'
    snippet = 'Serial.print("hello");'

    output = ArduinoSim(snippet=snippet, mcu=mcu, timespan=0.01).get_serial()
    assert output == 'hello' 
```

开始测试：

```
$ nosetests pysimavr/examples/test_example.py
pysimavr.examples.test_example.test_atmega88 ... ok 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-23T09:14:27.037

我不知道有任何平台可以测试 Arduino 代码。

但是，有[**Fritzing**](http://fritzing.org/)平台，您可以使用该平台对硬件进行建模，然后导出 PCB 图和其他内容。

值得检查。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-10-04T00:52:28.170

我们在大型科学实验中使用 Arduino 板进行数据采集。随后，我们必须支持几个具有不同实现的 Arduino 板。我编写了 Python 实用程序来在单元测试期间动态加载 Arduino 十六进制图像。下面链接中的代码通过配置文件支持 Windows 和 Mac OS X。要找出 Arduino IDE 放置十六进制图像的位置，请在点击构建（播放）按钮之前点击 shift 键。在点击上传的同时点击 shift 键以找出您的 avrdude（命令行上传实用程序）在您的系统/Arduino 版本上的位置。或者，您可以查看包含的配置文件并使用您的安装位置（当前在 Arduino 0020 上）。

[http://github.com/toddstavish/Python-Arduino-Unit-Testing](http://github.com/toddstavish/Python-Arduino-Unit-Testing)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-01-11T12:59:39.600

该程序允许自动运行多个 Arduino 单元测试。测试过程在 PC 上开始，但测试在实际的 Arduino 硬件上运行。一组单元测试通常用于测试一个 Arduino 库。（这

Arduino 论坛：[http ://arduino.cc/forum/index.php?topic=140027.0](http://arduino.cc/forum/index.php?topic=140027.0)

GitHub项目页面：http: [//jeroendoggen.github.com/Arduino-TestSuite](http://jeroendoggen.github.com/Arduino-TestSuite)

Python 包索引中的页面：http: [//pypi.python.org/pypi/arduino_testsuite](http://pypi.python.org/pypi/arduino_testsuite)

单元测试是用“Arduino 单元测试库”编写的：[http ://code.google.com/p/arduinounit](http://code.google.com/p/arduinounit)

对每组单元测试执行以下步骤：

*   阅读配置文件以找出要运行的测试
*   该脚本编译并上传包含单元测试代码的 Arduino 草图。
*   单元测试在 Arduino 板上运行。
*   测试结果通过串口打印并由 Python 脚本分析。
*   该脚本开始下一个测试，对配置文件中请求的所有测试重复上述步骤。
*   该脚本打印一个摘要，显示完整测试套件中所有失败/通过测试的概述。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2018-03-07T21:59:14.830

[`arduino_ci`](https://github.com/Arduino-CI/arduino_ci)我为此目的而建造。虽然它仅限于测试 Arduino 库（而不是独立的草图），但它使单元测试能够在本地或 CI 系统（如 Travis CI 或 Appveyor）上运行。

考虑 Arduino 库目录中的一个非常简单的库，名为`DoSomething`，其中`do-something.cpp`：

```
#include <Arduino.h>
#include "do-something.h"

int doSomething(void) {
  return 4;
}; 
```

您可以按如下方式对其进行单元测试（使用名为`test/is_four.cpp`或类似的测试文件）：

```
#include <ArduinoUnitTests.h>
#include "../do-something.h"

unittest(library_does_something)
{
  assertEqual(4, doSomething());
}

unittest_main()  // this is a macro for main().  just go with it. 
```

就这样。如果该`assertEqual`语法和测试结构看起来很熟悉，那是因为我采用了Matthew Murdoch 在[他的回答](https://stackoverflow.com/a/791519/2063546) 中提到[的一些 ArduinoUnit 库](https://github.com/mmurdoch/arduinounit)。

有关单元测试 I/O 引脚、时钟、串行端口等的更多信息，请参阅[Reference.md 。](https://github.com/Arduino-CI/arduino_ci/blob/master/REFERENCE.md)

这些单元测试是使用包含在 ruby​​ gem 中的脚本编译和运行的。有关如何设置的示例，请参阅[README.md](https://github.com/Arduino-CI/arduino_ci/blob/master/README.md)或仅从以下示例之一复制：

*   一个实际的例子，[测试一个队列实现](https://github.com/sdesalas/Arduino-Queue.h/pull/1/files)
*   [另一个Queue 项目](https://github.com/SMFSW/Queue/pull/9)的另一组测试
*   一个复杂的示例，模拟通过 SoftwareSerial 连接控制交互式设备的库，作为[Adafruit FONA 库的一部分](https://github.com/adafruit/Adafruit_FONA/pull/91/files)
*   上面显示的[DoSomething 示例库](https://github.com/Arduino-CI/arduino_ci/tree/master/SampleProjects/DoSomething)，用于测试 arduino_ci 本身

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2010-11-30T14:46:28.973

James W. Grenning 写了很多很棒的书，这本书是关于嵌入式 C 代码的单元测试嵌入式 C*[的测试驱动开发](http://pragprog.com/titles/jgade/test-driven-development-for-embedded-c)*。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2011-10-24T12:14:42.297

将特定于硬件的代码与其余部分分开或抽象出来，这样您就可以在任何您拥有良好工具且您最熟悉的平台上测试和调试更大的“其余部分”。

基本上，尝试从尽可能多的已知工作构建块构建尽可能多的最终代码。剩下的特定于硬件的工作将变得更容易和更快。您可以自己使用现有的模拟器和/或模拟设备来完成它。然后，当然，你需要以某种方式测试真实的东西。视情况而定，这可能会或可能不会很好地自动化（即谁或什么将按下按钮并提供其他输入？谁或什么将观察和解释各种指标和输出？）。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2014-01-10T23:40:44.177

我在编写 Arduino 代码时使用[Searduino 。](http://searduino.wordpress.com/)Searduino 是一个 Arduino 模拟器和一个开发环境（Makefiles、C 代码......），它可以让您使用您最喜欢的编辑器轻松破解 C/C++。您可以导入 Arduino 草图并在模拟器中运行它们。

Searduino 0.8 截图：[http ://searduino.files.wordpress.com/2014/01/jearduino-0-8.png](http://searduino.files.wordpress.com/2014/01/jearduino-0-8.png)

Searduino 0.9 将发布，并在最后一次测试完成后立即录制视频....在一两天内。

模拟器上的测试不被视为真正的测试，但它确实帮助我发现了愚蠢/逻辑错误（忘记做`pinMode(xx, OUTPUT)`等）。

顺便说一句：我是开发 Searduino 的人之一。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-08-06T15:21:19.823

有一个名为[ncore](https://github.com/maniacbug/ncore)的项目，它为 Arduino 提供原生内核。并允许您为 Arduino 代码编写测试。

从项目描述

> 本机内核允许您在 PC 上编译和运行 Arduino 草图，通常无需修改。它提供标准 Arduino 函数的本机版本，以及一个命令行解释器，用于为您的草图提供通常来自硬件本身的输入。

同样在[“我需要使用什么”部分](https://github.com/maniacbug/ncore#what-do-i-need-to-use-it)

> 如果你想构建测试，你需要来自 [http://cxxtest.tigris.org](http://cxxtest.tigris.org)的 cxxtest 。NCORE 已经使用 cxxtest 3.10.1 进行了测试。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-08-19T18:10:35.437

如果您想在 MCU（桌面）之外对代码进行单元测试，请查看 libcheck： [https ://libcheck.github.io/check/](https://libcheck.github.io/check/)

我用它来测试我自己的嵌入式代码几次。这是一个非常强大的框架。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-05-23T17:38:45.997

您可以使用[emulare](http://www.emulare.org) — 您可以将微控制器拖放到图表上并在 Eclipse 中运行您的代码。网站上的文档告诉您如何设置它。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-01-03T07:53:26.633

试试*Autodesk 电路模拟器*。它允许使用许多其他硬件组件测试 Arduino 代码和电路。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-04-17T13:49:56.520

使用带有 Arduino 库的 Proteus VSM 来调试您的代码或对其进行测试。

这是获取代码之前的最佳实践，但请确保时间安排，因为模拟在板上运行时不会实时运行。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-11-23T05:20:44.947

基本的 Arduino 是用 C 和 C++ 编写的，甚至 arduino 的库也是用 C 和 C++ 编写的。因此，简单来说，只需将代码处理为 C 和 C++ 并尝试进行单元测试。在这里，“句柄”一词的意思是您将所有基本语法（例如 serial.println 更改为 sysout，pinmode 更改为变量，void 循环更改为 while() 循环，这会在 keystock 或经过一些迭代后中断。

我知道这是一个漫长的过程，而且不是那么直截了当。根据我的个人经验，一旦你开始处理它，这就会变得更可靠。

-Nandha_Frost

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-09-14T07:07:58.167

如果您有兴趣运行 INO 草图并检查串行输出，我在我的[Arduino NMEA 校验和](https://github.com/TomasHubelbauer/arduino-nmea-checksum)项目中有一个有效的实现。

以下脚本获取文件并使用 Arduino CLI 将其编译为 HEX 文件，然后加载到 SimAVR 对其进行评估并打印串行输出。由于所有 Arduino 程序都永远运行而没有真正选择自杀（`exit(0)`不起作用），我让草图运行几秒钟，然后将捕获的输出与预期的输出进行比较。

下载并解压 Arduino CLI（在本例中为版本 0.5.0 - 撰写本文时最新）：

```
curl -L https://github.com/arduino/arduino-cli/releases/download/0.5.0/arduino-cli_0.5.0_Linux_64bit.tar.gz -o arduino-cli.tar.gz
tar -xvzf arduino-cli.tar.gz 
```

现在您可以更新索引并安装适当的核心：

```
./arduino-cli core update-index
./arduino-cli core install arduino:avr 
```

假设您的草图名为`nmea-checksum.ino`，要获取 ELF 和 HEX，请运行：

```
./arduino-cli compile -b arduino:avr:uno nmea-checksum.ino 
```

接下来，SimAVR 运行 HEX（或 ELF）——我从源代码构建，因为最新版本不适合我：

```
sudo apt-get update
sudo apt-get install -y build-essential libelf-dev avr-libc gcc-avr freeglut3-dev libncurses5-dev pkg-config
git clone https://github.com/buserror/simavr.git
cd simavr
make 
```

成功的编译将为您`simavr/run_avr`提供可用于运行草图的工具。就像我说的，`timeout`否则它永远不会终止：

```
cd simavr
timeout 10 ./run_avr -m atmega168 -f 16000000 ../../nmea-checksum.ino.arduino.avr.uno.elf &> nmea-checksum.ino.clog || true 
```

生成的文件将包含包装串行输出的 ANSI 颜色代码控制字符，以摆脱这些：

```
cat nmea-checksum.ino.clog | sed -r "s/\x1B\[([0-9]{1,2}(;[0-9]{1,2})?)?[mGK]//g" > nmea-checksum.ino.log
cat nmea-checksum.ino.log 
```

现在您需要做的就是将此文件与一个已知的好文件进行比较：

```
diff nmea-checksum.ino.log ../../nmea-checksum.ino.test 
```

如果没有差异，`diff`将以代码 0 退出，否则脚本将失败。

# delphi - 组织搜索路径

> ID：780831
> 
> 赞同：2
> 
> 时间：2009-04-23T08:49:27.487
> 
> 标签：delphi, delphi-2009

我们通过“工具|选项|环境变量”创建这样的变量：

```
$(Sources) = D:\Sources\Delphi
$(OurLib) = $(Sources)\OurLib\Src
$(OurApp1) = $(Sources)\Applications\App1\3.x
$(ThirdParty) = $(Sources)\ThirdPartyComponents 
```

我们在项目搜索路径中使用这些变量，如下所示：

```
($OurApp1)\Src\Core;($OurApp1)\Src\GUI;($OurApp1)\Src\Plugins;$(ThirdParty)\JVCL 
```

但自 Delphi 2009 以来，这已被破坏（同时已修复），因为这些变量不再完全评估（参见[QC #73276](http://qc.embarcadero.com/wc/qcmain.aspx?d=73276)）。所以编译器找不到目录中的文件。解决方法：仅使用环境变量中的完整目录。

我们使用这种方法是因为在所有开发人员机器和构建服务器上都可以找到文件，我们只需要将 $(Sources) 指向正确的位置。

我们的全局库路径中没有任何内容（Delphi 默认设置除外），因为它不在版本控制中，也不会反映在其他开发人员或构建机器上。

一个问题是：如果 $(OurLib) 中的一个单元决定在新路径中包含另一个新单元，那么所有项目都会中断，因为他们找不到这个新单元。然后我们必须遍历所有项目并添加搜索路径。（顺便说一句：我真的很讨厌搜索路径编辑器......不是一个简单的备忘录字段比这个替换/添加/删除逻辑更好编辑吗？）

我们做的另一件事是不向我们的项目添加很多单元。尤其是来自 $(OurLib) 的所有内容，但我们经常有像插件这样的单元，它们仅通过包含它们来添加功能。对于我们产品的不同版本，我们希望包含不同的单元。由于 Delphi 总是在 .dpr 的 uses 子句中弄乱 $IFDEFs，我们通过包含名为“IncludePlugins”的单元来帮助我们，然后包含取决于 IFDEF 的单元。但不包括项目中的单元会使导航变得痛苦。单位不出现在项目中，Ctrl+12（显示单位）找不到它们，代码完成等中不显示它们。

有没有人更好的方法来处理这些问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T09:45:21.330

我们仅使用相对路径，任何库始终位于 libs 子目录下，而项目源代码位于 src 子目录中。所以我们的搜索路径总是如下所示：

..\libs\library1;..\libs\library2\common;

等等

所有库都作为 svn:external 添加到每个项目中，因此签出项目也会自动签出库，并且搜索路径将始终指向该项目的库的正确版本。

不完美，但它在大多数情况下都有效。

我必须同意搜索路径编辑器，相对路径更糟糕，因为您不能使用“...”按钮，否则 Delphi 将插入绝对路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T09:00:43.637

我们使用标准驱动器映射。

我们当前的项目始终在 W: 上，无论它是网络驱动器还是替代品。

这很好用。

当您需要处理不同的项目时，交换 W: 即可继续。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T13:33:57.693

您可以将搜索路径复制到编辑器，对其进行修改，然后将其复制回来。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T15:08:49.023

您的搜索路径太大了。它应该*只*包含您希望 Delphi 与您的项目一起重新编译的内容。你不会真的想每天都重新编译 Jedi VCL，是吗？

我创建了一个*所有已*编译单元所在的目录。说，*C:\dcu*。将其指定为*所有*包中的“单元输出目录”。那么，我的“搜索路径”*总是*这样：

> `$(Delphi)\Lib;C:\dcu`

编译器会找到它需要的一切，但它永远不会找到任何源代码。它所看到的唯一源代码是在直接属于我正在编译的任何项目的文件中。项目自己的源目录不需要在搜索路径上，因为所有这些文件都已经是项目的直接成员。编译器确切地知道它们在哪里。

对我来说，一个项目的所有源文件都放在一个目录中。如果您想要不同部分的单独目录，例如*Core*和*GUI*，那么我会将它们放在单独的包中，以便我可以处理它们并单独编译它们。即使最终程序不使用生成的 BPL，包仍然是分割项目和定义依赖项的好方法。

当为一个项目编译单元不会自动为所有其他项目编译单元时，您将被迫更改活动项目。这需要你一点时间，但它也可以作为一种心理提醒，你也在“换帽子”。

尽管您只生产一种*产品*，但这并不意味着您应该在 Delphi中只有一个*项目。*您应该为产品中的每个可执行模块（EXE、DLL、BPL）至少有一个项目。使用*项目组*在单个 IDE 会话中管理多个项目。任何单位不得参与多个项目。

* * *

我不了解您对插件和项目不同版本的看法。当您说“插件”时，我假设您在谈论单独的可执行模块，例如 DLL 或包，客户可以选择包含或不包含这些模块。难道你不能把你不同版本的功能变成插件模块，这些模块根本不包含在较小的版本中吗？那么你就不用担心项目的条件编译了；只是有几个不同的安装程序打包程序来获取不同的插件集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T16:28:02.270

我一直觉得奇怪的是，这个问题从未得到充分解决。我最近向 David I 建议，Delphi 应该允许用户设置某种首选的开发结构，并且第三方库发布者可以意识到这一点，以便他们可以自动调整他们的安装程序以在首选的开发框架中正确安装。如果首选的开发结构存储在 XML 文件或类似文件中，则可以将其从开发团队的一台计算机复制到另一台计算机。

作为替代方案，它可以创建一个有趣的项目来创建一个允许用户以高级方式“重构”他们的库安装的 Delphi 应用程序。您指定系统上的哪些文件夹包含源代码或编译组件或其他任何内容，以及您想要保留源文件或编译单元的位置，点击 Go 并为您重新安排系统，同时更新您的 Delphi 环境，以便在您启动 Delphi 时，它会找到它应该的一切。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-29T02:04:56.440

我最近刚刚发现了一种使用 XE6 在 delphi 构建中具有项目特定环境变量的方法，它不如 C 中的完整#define 好，但至少我现在可以在多个项目中拥有一致的搜索路径并创建一些共享选项集。

我所做的是以与原始海报相同的方式设置环境变量，然后在 dproj 或选项集中覆盖它们。

添加到项目的 BuildPaths.optset 看起来像

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <SVN_Root>..\..\..</SVN_Root>
        <SVN_Riemann>$(SVN_Root)\Riemann</SVN_Riemann>
        <SVN_Library>$(SVN_Root)\Library</SVN_Library>
        <SVN_ThirdParty>$(SVN_Library)\Third Party</SVN_ThirdParty>
    </PropertyGroup>
    <ProjectExtensions>
        <Borland.Personality>Delphi.Personality.12</Borland.Personality>
        <Borland.ProjectType>OptionSet</Borland.ProjectType>
        <BorlandProject>
            <Delphi.Personality/>
        </BorlandProject>
        <ProjectFileVersion>12</ProjectFileVersion>
    </ProjectExtensions>
</Project> 
```

# subsonic - 如何快速检查数据库连接？

> ID：780833
> 
> 赞同：1
> 
> 时间：2009-04-23T08:50:08.857
> 
> 标签：subsonic

在我的 win 应用程序中 - 如果无法访问数据库服务器，我想显示信息（或 db 图标）。但我不想等待 30 秒超时。用户可以在我的选项对话框中配置服务器、用户、密码。那么，有没有办法在亚音速中快速检查数据库连接是否有效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T10:11:26.057

您可以创建一个简单的 ping 存储过程，然后在 SQL 命令上以低超时执行该过程，例如：

```
SubSonic.StoredProcedure sp = SPs.PingStoredProcedure();  
sp.CommandTimeout = 2;  
sp.Execute(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T08:59:29.553

您可以找到有关协议的一些信息，并使用 TCP 套接字简单地模拟这些信息。所以这就像远程登录到 Web 服务器并发出 HTTP 命令。但是，您会执行适合您的数据库类型的命令。这样做可以避免驱动程序中内置的任何超时或其他任何东西。或者，您可以简单地使用 TCP 连接到 IP:Port 并查看是否有人在监听。至于亚音速，没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T09:35:08.220

您能否将连接超时设置为低 -[请参阅此处以获取示例](http://vstoolsforum.com/blogs/stevegray/archive/2008/07/28/subsonic-timeout-expired-error.aspx)，或者可能在后台线程上执行此操作，并让用户知道它正在尝试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T18:11:43.253

在当前版本 (521) 中有一个 IsOnline() 方法，您可以将其与存储库模式一起使用。它目前总是返回 true （见[这里](http://code.google.com/p/subsonicproject/issues/detail?id=70)）......但是一旦修复，您可以使用在连接字符串中传递的重载方法，并且超时时间很短。

[http://code.google.com/p/subsonicproject/source/browse/trunk/SubSonic/Sql%20Tools/SubSonicRepository.cs](http://code.google.com/p/subsonicproject/source/browse/trunk/SubSonic/Sql%20Tools/SubSonicRepository.cs)

# c# - GC 和 IDispose 在 C# 中如何工作？

> ID：780834
> 
> 赞同：1
> 
> 时间：2009-04-23T08:51:01.757
> 
> 标签：c#, .net, idisposable

我记得我是通过将图像从网络直接流式传输到位图中来加载图像的。关闭流，返回位图并将其保存在图像控件中。

当我执行 = loadPicture() 时，我例外，第一个位图会像 C++ 中的智能指针一样被释放。但它没有，我消耗了很多内存，直到我打电话给处置。所以我的问题是。

GC 和 Dispose 对象如何在 C# 中工作？为什么它不像 smart_ptr 那样实现？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T08:55:00.997

引用不是智能指针。让引用变量超出范围，将其替换为另一个值，和/或将其设置为 null 都**无济于事**。

这只是 CLI /GC 设计的一部分......

Gargage Collection (GC) 将*在需要时*运行，并且应该清理使用的托管内存，以​​及（如果提供了终结器）任何非托管资源。但是对于确定性清理：这就是`IDisposable`. `Dispose()`当您完成这些对象时，您的工作就是处理它们 - 要么通过`using`，要么将其交给承担此责任的其他东西（常见的，例如，流/阅读器等）。

```
using (StreamReader reader = new StreamReader(myfile)))
{
   ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T08:53:25.743

当运行时认为有必要时，GC 就会启动。

基本规则是：当您使用 Disposable 类型（IDispose）时，您（作为程序员）应该尽快释放该类型使用的资源，在不再需要使用该类型时调用 Dispose。例如，当您读取文件时，您会在完成读取后立即关闭该文件。（在这种情况下调用 close 也会调用 dispose）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T09:25:53.873

您必须在任何实现 IDisposable 的对象上显式调用 Dispose，否则您的非托管资源**将不会被释放**。如果你不想显式调用它，那么你必须重写 Finalize 方法来调用 Dispose 方法——这就是为什么你会经常看到这个：

```
 class MyClass : IDisposable
 {
    ...

    ~MyClass()
    { 
       this.Dispose(false);
    }

    public void Dispose()
    {
       this.Dispose(true);
       GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (disposing)
        { /* dispose managed stuff also */ }

        /* but dispose unmanaged stuff always */
    }
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T09:02:20.247

smart_ptr 被引用计数。虽然这允许在它们不再被任何代码引用时确定性地释放它们的资源，但它们确实有自己的问题：分配引用总是需要更新计数器，循环引用无法自动释放导致内存泄漏，内存管理器被更频繁地调用。

.NET 中的 GC 是一个全面的收集器。它从感觉应该释放内存的任何时间开始（通常由某些内存使用条件触发，但不是确定性的），并从构建系统中所有活动引用的列表开始（包括 CPU 寄存器中的引用、嵌套引用等） .)。这是有效的，因为我们处于无法进行指针运算等的托管环境中 - 系统可以跟踪所有引用。在构建了实时引用列表之后，它基本上会释放所有不知道不再使用的内存。当然，这只是一个基本的草图，对于非托管资源的效率和管理，还有更多的东西，比如对象生成、终结器等，但这对于基本理解它的工作原理并不重要。

IDisposable 接口用于实现一次性模式，这有助于您处理应以确定方式处置的对象。该模式是当不再需要对象时显式调用 Dispose() ，因此释放非托管资源或关闭句柄等，但不释放其内存。这将在稍后由 GC 完成，但稍后发生这并不重要，因为已经执行了资源的确定性释放。

# evaluation - 在决定选择哪个软件包时，有哪些有用的标准？

> ID：780835
> 
> 赞同：1
> 
> 时间：2009-04-23T08:51:16.357
> 
> 标签：evaluation, banking, vendors

从用户偏好的角度来看，在看过许多软件供应商的许多演示之后，如何选择软件供应商？

我代表一位负责进行此类评估的朋友提出这个问题，之前没有任何经验。我认为 SO 社区的经验可能会产生比谷歌搜索更有用的东西。

领域特异性并不重要，但如果它对当前正在评估的所有系统都有帮助，那就是财务系统和 ERP（电子资源规划）。

提前感谢您提供的任何帮助/想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T09:22:16.423

软件评估的常用工具是[**SWOT 分析**](http://en.wikipedia.org/wiki/SWOT_analysis)：

> SWOT 分析是一种战略规划方法，用于评估项目或商业企业中涉及的优势、劣势、机会和威胁。
> 
> [...]
> 
> *   优势：有助于实现目标的组织属性。
> *   弱点：对实现目标有害的组织属性。
> *   机会：有助于实现目标的外部条件。
> *   威胁：可能对企业业绩造成损害的外部条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T08:54:46.333

您应该了解他们的客户支持是如何工作的。产品可能会出现问题，您需要技术支持。如果您需要它时它不在那里，您可能只是坐在那里等待并浪费时间和金钱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T08:54:46.367

看看您是否可以通过您真正认识的人或通过在线论坛找到这些软件包的现有用户。看看有哪些痛点和优势。此外，您应该向供应商提出有关您的特定使用场景的问题，并要求提供真正的答案，而不仅仅是销售/营销；您正在尝试查看该软件包是否**真的**可以解决**您的**问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T08:54:53.807

我想知道如果系统未能达到预先商定的标准，供应商是否愿意至少退还您的一些钱。

他们会参与或承诺吗？

（他们说早餐是鸡肉，但猪是承诺的）

# nhibernate - 研究休眠条件查询

> ID：780842
> 
> 赞同：0
> 
> 时间：2009-04-23T08:54:39.500
> 
> 标签：nhibernate, criteria

是否有任何其他网站可以研究标准查询，例如[http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/querycriteria.html](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/querycriteria.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T08:59:48.740

[nhibernate.info](http://nhibernate.info)网站有很多文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T09:01:26.023

*   [法比奥·毛洛 (Fabio Maulo) 的 Knol](http://openbook.galileocomputing.de/visual_csharp/)
*   Ayende 的一些博客文章
    *   [运算符重载](http://ayende.com/Blog/archive/2006/08/04/NHibernateCriteriaAPIOperatorOverloading.aspx)
    *   [多查询](http://ayende.com/Blog/archive/2007/05/20/NHibernate-Multi-Criteria.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T09:10:21.180

对我了解更多有关 NHibernate 的 Criteria API 最有帮助的资源之一绝对是“NHibernate 之夏”截屏系列（请参阅[此处](http://www.summerofnhibernate.com/)）。第 2 节将向您展示它的强大功能。

创造这些系列的人非常摇滚。

# php - 棘手的模式匹配

> ID：780852
> 
> 赞同：2
> 
> 时间：2009-04-23T08:56:17.033
> 
> 标签：php, regex

这可能很棘手，容易或不可能......我不确定

我有一个域列表，我正在尝试将它们与“标题”标签中的网站名称尽可能匹配。

例如...

```
域名：www.yahoo.com
标题：雅虎！
结果：雅虎！

域名：www.thegreenpages.com
标题：欢迎来到绿页。
结果：绿页

域名：www.experts-exchange.com：
标题：专家交流 - 用于解决技术问题的网络上排名第一的资源。
结果：专家交流

```

所以你可以在这里看到问题。我需要考虑大小写、空格和任何域特殊字符。我还需要捕获任何特殊字符，例如！在雅虎！但不是像句号这样的句号，它只是一个句子的结尾，或者你能想到的任何其他东西。

说得通？

在 PHP 中。

我真的，真的很讨厌这些类型的模式匹配问题:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T09:11:51.160

我不确定您是否会想出一种模式来解决您遇到此类问题时可能遇到的所有可能性。标题标签可能是完全不匹配的完全随机文本。

例如，这是一个随机网站，我从随机谷歌搜索中挑选出来。站点域名是“plus2net.com”，标题是（显然是为 SEO 设计的）“PHP HTML MySQL 文章教程、免费脚本和编程论坛”。你会如何将这两件事联系起来？从理论上讲，您可以使用类似[levenshtein() 函数](http://www.php.net/manual/en/function.levenshtein.php)来进行统计分析，但我认为想出一个正则表达式来解决这个问题是错误的方法。

我会重新考虑这个问题。你想达到什么目的？如果您只是想将域名列表和标题标签关联起来，您就不能编写一个快速脚本来从您拥有的域列表中抓取标题标签并获取准确的数据吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T16:23:41.703

## 我认为这至少是一个三步过程。

*   从标题和网址中删除标点符号。
*   如有必要，拆分 URL。
*   通过与标题进行比较，使用 url 找到正确的大小写。

```
'www.thegreenpages.com'    'Welcome to The Green Pages.'  'The Green Pages'
    'thegreenpages'                                       # remove punctuation
   'the green pages'    <= 'Welcome to The Green Pages'   # split url (if necessary)
                        =>            'The Green Pages'   # result of search

'www.experts-exchange.com'    'Experts Exchange - The #1 res ...'  'Experts Exchange'
    'experts exchange'        'Experts Exchange   The  1 res    '  # remove punctuation
#   'experts exchange'     <= 'Experts Exchange   The  1 res    '  # split url
                           => 'Experts Exchange'                   # result of search

'www.yahoo.com'    'Yahoo!'  'Yahoo!'
    'yahoo'        'Yahoo'   # remove punctuation
#   'yahoo'     <= 'Yahoo'   # split url (if necessary)
                => 'Yahoo'   # result of search
# whoops left off the exclamation point
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T14:19:31.140

试试这个代码：

```
$sites = array(
    array('domain' => 'www.yahoo.com', 'title' => 'Yahoo!'),
    array('domain' => 'www.thegreenpages.com', 'title' => 'Welcome to The Green Pages.'),
    array('domain' => 'www.experts-exchange.com', 'title' => 'Experts Exchange - The #1 resource on the web for solving technology problems.'),
);

foreach ($sites as $idx => $site) {
    $domain = preg_replace('/^www\./i', '', $site['domain']);
    $domain = preg_replace('/\.(com|net|org|info|us)$/i', '', $domain);

    $expression = '/';
    for ($i = 0; $i < strlen($domain); $i++) {
        $char = $domain[$i];
        $expression .= $char . (ctype_alpha($char) ? '' : '?');
        $expression .= '\s*';
    }
    $expression .= '/i';

    preg_match($expression, $site['title'], $matches);
    $sites[$idx]['name'] = $matches[0];
} 
```

如果你`print_r($sites)`会得到：

```
Array
(
    [0] => Array
        (
            [domain] => www.yahoo.com
            [title] => Yahoo!
            [name] => Yahoo
        )

    [1] => Array
        (
            [domain] => www.thegreenpages.com
            [title] => Welcome to The Green Pages.
            [name] => The Green Pages
        )

    [2] => Array
        (
            [domain] => www.experts-exchange.com
            [title] => Experts Exchange - The #1 resource on the web for solving technology problems.
            [name] => Experts Exchange 
        )
) 
```

无论如何，您都必须调整脚本直到正确为止，但这是一个开始的地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T09:12:14.733

您可以根据域名构建正则表达式，例如：

```
t\s*h\s*e\s*g\s*r\s*e\s*e\s*n\s*p\s*a\s*g\s*e\s*s 
```

这将在不区分大小写模式下匹配*The Green Pages 。*

* * *

**编辑**   这是一个如何构建这样一个正则表达式的示例：

```
$data = array(
    array('yahoo', 'Yahoo!'),
    array('thegreenpages', 'Welcome to The Green Pages.'),
    array('experts-exchange', 'Experts Exchange - The #1 resource on the web for solving technology problems.')
);

foreach ($data as $item) {
    $domain = preg_split('/(.)/', $item[0], -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY);
    foreach ($domain as $key => $chr) {
        if ($chr == '-') {
            unset($domain[$key]);
        }
    }
    $pattern = '/'.implode('[\s-]*', $domain).'!?/i';
    preg_match($pattern, $item[1], $match);
    var_dump($match[0]);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T09:25:49.863

你的域名列表是固定的吗？如果是这样，您可以为每个域构建正则表达式吗？

显然，您可以相当简单地去除域，但正如 Tomalak 所说，除非问题域受到更多限制，否则实际上是一个相当复杂的计算问题！

从域中，您需要删除单词，您需要一个参考字典（或每种语言一个），以及某种单词匹配，也许是对潜在匹配的某种投票。虽然，实际上没有更具体的问题域，这不太可能是准确的。

了解更多关于您想要实现的目标可能会很好？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T09:09:55.597

除非您*认真*限制问题域，否则我会说这是不可能的。

title 属性可以包含任何人类语言的任意字符串（符号、外来字符、“聪明”的东西，你可以命名它）。正则表达式如何足够聪明以捕捉相关部分？您甚至可以用自己的话正式定义相关部分吗？

正则表达式在应用于语言时很糟糕，甚至更复杂的系统在应用于人类语言时也往往很糟糕。

# ubuntu - Apache 2 中的“捕获 SIGWINCH”错误是什么？

> ID：780853
> 
> 赞同：37
> 
> 时间：2009-04-23T08:56:59.747
> 
> 标签：ubuntu, apache2, signals

我的服务器（ubuntu 8.04）运行drupal 6的LAMP，当流量很大时，它会停止提供页面。重新启动 apache2 将不起作用，所以我必须重新启动服务。

我在 apache2 error.log 中发现了这条消息

> [通知] 抓到 SIGWINCH，优雅关闭

我还注意到 apache2 的进程 id 在 apache 停止响应时大约为 12000。

更新

正如您所指出的，捕获的 SIGWINCH 是 apache 服务重新启动的通知。我与最大客户一起玩并保持活力。我将 MaxClients 设置得太低，因此出现“服务器已达到 MaxClients 设置，请考虑提高 MaxClients 设置”错误，但已解决此问题。

关于 PID，我的安装已经安装了[prefork 模块](http://httpd.apache.org/docs/2.0/mod/prefork.html)，所以在达到[MaxRequestPerChild](http://httpd.apache.org/docs/2.0/mod/mpm_common.html#maxrequestsperchild)之后，它会回收子进程。这就是 PID 周期性上升的原因。仍然没有弄清楚为什么一段时间后apache停止响应。

与此同时，将尝试提高 MaxRequestPerChild，这样 PID 就不会那么快地达到 PID max。当前限制为 32768（这是新的 debian 和 ubuntu 安装的标准）。

以下是日志中的更多内容：

> [Fri Apr 24 01:48:56 2009] [notice] 抓到 SIGWINCH，优雅关闭
> 
> [Fri Apr 24 01:50:07 2009] [notice] Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.3 配置了 Suhosin-Patch -- 恢复正常操作
> 
> [2009 年 4 月 24 日星期五 17:13:35] [错误] [客户端 195.70.62.131] 客户端发送了没有主机名的 HTTP/1.1 请求（参见 RFC2616 第 14.23 节）：/w00tw00t.at.ISC.SANS.DFind:)
> 
> [2009 年 4 月 24 日星期五 17:36:00] [错误] [客户端 212.188.33.4] 客户端发送的 HTTP/1.1 请求没有主机名（参见 RFC2616 第 14.23 节）：/w00tw00t.at.ISC.SANS.DFind:)
> 
> [2009 年 4 月 25 日星期六 20:05:07] [错误] [客户端 84.243.222.12] 请求 GET HTTP/1.1 HTTP/1.1 中的 URI 无效
> 
> [2009 年 4 月 25 日星期六 20:05:12] [错误] [客户端 84.243.222.12] 找不到脚本或无法统计：/usr/lib/cgi-bin/twiki
> 
> [2009 年 4 月 25 日星期六 20:05:12] [错误] [客户端 84.243.222.12] 找不到脚本或无法统计：/usr/lib/cgi-bin/wiki
> 
> [2009 年 4 月 25 日星期六 20:05:12] [错误] [客户端 84.243.222.12] 找不到脚本或无法统计：/usr/lib/cgi-bin/wikis
> 
> [2009 年 4 月 25 日星期六 21:46:46] [错误] [客户端 211.68.23.167] 请求 GET HTTP/1.1 HTTP/1.1 中的 URI 无效
> 
> [Sun Apr 26 06:13:47 2009] [error] [client 86.39.154.89] client sent HTTP/1.1 request without hostname (see RFC2616 section 14.23): /w00tw00t.at.ISC.SANS.DFind:)
> 
> [Sun Apr 26 06:53:07 2009] [notice] 请求优雅重启，正在重启

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2015-09-18T08:19:52.440

**信号机**

事实上，@Stefano 是对的：SIGWINCH 表示 SIGNAL WINDOWS CHANGE，当终端检测到其窗口大小发生变化以允许重绘时会自动发送。

**用于 apache2 的 SIGWINCH**

但不幸`apache2`的是，进程错误地滥用了这个信号（以他们转移其第一个含义的方式），但为了他们的防御，他们似乎别无选择，并且由于缺乏信号而不得不求助于这个（参见[错误报告](https://bz.apache.org/bugzilla/show_bug.cgi?id=50669)）。他们的假设之一是`apache2`进程总是在后台。所以@mikl 也完全正确。

**那么，要检查什么？**

*   正常重启 apache2 的任何自动原因（cron 服务，相关服务的 apt-get 安装......）
*   否则，您是否在开放的 tty 中在前台运行 apache2 ？如果是，则不建议这样做（唉），并且在调整控制终端的大小时，您可能会很容易地遇到此 SIGWINCH 优雅关闭。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-23T09:07:21.670

呃？如果我没记错的话，SIGWINCH 是一个在终端窗口大小发生变化时发送到终端应用程序的信号（以便应用程序可以自行调整大小）。通常由 ncurses 应用程序使用。

这很奇怪。此信息是否为您提供了额外的提示？

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-24T20:43:29.777

好吧，在 Ubuntu 上启动和停止 Apache 时，会在某些情况下使用 SIGWINCH。如果我`sudo apache2ctl graceful-stop`在我的 Ubuntu 8.10 服务器上这样做，我会在我的日志中得到这个：

```
[Fri Apr 24 22:41:15 2009] [notice] caught SIGWINCH, shutting down gracefully 
```

我记得，一些需要在轮换日志、夜间作业等时重新启动 Apache 的服务也使用 SIGWINCH。

这并不能解释您当前遇到的问题，但我认为它可能是在您的服务器上运行的其他东西正在重新启动 Apache——或者它可能与您的问题根本无关。

如果可以的话，尝试发布更多的日志文件，这样分析起来会容易得多:)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-24T21:19:39.627

在 Apache 上，SIGWINCH 是[Graceful Stop](http://httpd.apache.org/docs/2.2/stopping.html#gracefulstop)信号。请注意，这与 SIGUSR1 不同，后者是[Graceful Restart](http://httpd.apache.org/docs/2.2/stopping.html#graceful)信号。

不幸的是，我们需要更多信息来告诉您为什么 Apache 会优雅地停止。

# delphi - 存储在 Bucket 列表中的项目数

> ID：780854
> 
> 赞同：0
> 
> 时间：2009-04-23T08:57:25.173
> 
> 标签：delphi, containers, tbucketlist

我想知道如何获取存储在 TBucketList 中的项目数。据我所见，只有存储桶的数量和可用的存储桶数组，所以我能想到的只有

```
Count := 0;
for I := 0 to BucketList.BucketCount - 1 do
  Inc (Count, BucketList.Buckets [I].Count); 
```

这确实有效，但对我来说似乎很奇怪，我必须遍历所有存储桶才能找到存储的项目数量——这可能经常需要。

我错过了另一种可能性吗？或者这个容器类没有像其他容器一样提供 Count 成员是否有原因？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T09:09:33.350

图书馆永远不会完整。但是你可以扩展它们。

如果你经常需要这个值，你可以为此编写一个类助手。

```
TBucketListHelper = class helper for TBucketList
  function GetCount: Integer;
end;

function TBucketListHelper.GetCount: Integer;
var
  i : Integer;
begin
  Result := 0;
  for I := 0 to BucketCount - 1 do
    Inc (Result, Buckets [I].Count);
end; 
```

您现在可以使用：

```
BucketList.GetCount 
```

如果 TBucketListHelper 在范围内。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T09:13:45.180

没有其他解决方案，无需让计数器与内容保持同步。
它基本上是一个集合的集合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T19:01:57.097

由于您使用的是自己的派生类，因此只需在**Add**和**Remove**上增加和减少计数器。您可以包含循环方法作为双重检查以防万一。

# sqlite - PRAGMA journal_mode = OFF 为什么不起作用？

> ID：780857
> 
> 赞同：4
> 
> 时间：2009-04-23T08:57:42.270
> 
> 标签：sqlite

我正在运行 SQLite3 版本 sqlite-3.6.12 并且我已成功将其移植到我的操作系统。我看到的问题是，当我执行命令“PRAGMA journal_mode = OFF”时，它返回“OFF”，但我仍然看到正在创建 *.db-journal 文件。至关重要的是，这些文件不是为了我的项目而创建的。当我逐步执行代码 sqlite3PagerJournalMode 正在返回 PAGER_JOURNALMODE_OFF 所以我想知道设置 journal_mode=OFF 是否仍应生成这些文件，或者是否还有其他我遗漏的东西。请帮助

我也尝试了 PRAGMA main.journal_mode = OFF 和 PRAGMA journal_mode = MEMORY。但是日志文件是这样创建的！！！！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2011-01-27T20:02:06.903

使用 ption 宏编译您的应用程序：

**SQLITE_ENABLE_ATOMIC_WRITE**

如果定义了此 C 预处理器宏并且如果数据库文件的 sqlite3_io_methods 对象的 xDeviceCharacteristics 方法报告（通过 SQLITE_IOCAP_ATOMIC 位之一）文件系统支持原子写入，并且事务涉及仅更改数据库的单个页面文件，然后事务提交只需对数据库的单个页面的单个写入请求，并且不会创建或写入回滚日志。

# iphone - 在windows上模拟iphone？

> ID：780864
> 
> 赞同：3
> 
> 时间：2009-04-23T09:00:23.247
> 
> 标签：iphone, windows, xcode, macos

有什么方法可以在 Windows 上测试我的 Objective-C 代码。

有没有像 xcode 这样的 ide 用于 windows 开发 iphone 应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T09:24:14.487

我喜欢苹果和 iPhone，我在 Mac OS X 上编程，但我不明白为什么不允许 Windows 开发人员为 iPhone 开发。好的，我明白了，Objective-C 是 Apple 的东西，但仍然......它是基于 C 的，它有多难？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T09:12:43.920

不，没有。事实上，你需要最新版本的 Xcode（仅在最新的 Mac OS X 上运行）和 Objective-C 2.0 甚至进行 iPhone 开发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T09:41:03.400

如果你想在 Obj-C 上写一些东西，你可以使用 GCC。无论如何，如果你想要原生 iphone 开发者，你只能尝试使用第三方工具包创建一些东西。环境。使用 hackintosh 或购买 mac :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T09:44:59.037

如果你想测试一些基本的与 iPhone 无关的 Objective-c 代码，你也可以使用[GNUStep](http://www.gnu.org/software/gnustep/)。但在我看来，它并不是很稳定。

# wpf - 在 WPF 中编写自定义仪表控件的最佳方法是什么？

> ID：780866
> 
> 赞同：1
> 
> 时间：2009-04-23T09:01:01.747
> 
> 标签：wpf, wpf-controls

我需要在 WPF 中为工作中的项目编写一个仪表控件。通过仪表控制，我的意思类似于传统的汽车速度计：一个圆形的表面，圆周上有数字和刻度，还有一个指向当前值的指针。虽然我可以让我的雇主购买第三方控件，甚至在某个地方找到免费的，但出于好奇，我仍然想自己编写它。

我的第一个想法是使用模板“剥皮”现有控件，例如 ProgressBar，因为它具有最小值、最大值和值属性。但是，我认为这不会为我提供所需的灵活性。

我想为指向当前值的指针设置动画，这样当仪表的值发生变化时，指针就会从旧值移动到新值。我认为最简单的方法是使用某种形状或几何形状来表示针，然后应用相关度数的 RotateTransform 以使针指向正确的值。动画的 To 属性将通过绑定设置为“value degree”属性。

在我看来，我可以采取三种基本方法：

 **使用一个自定义 FrameworkElement 来表示我可以从 FrameworkElement 派生**的整个仪表，覆盖其 OnRender 方法，然后使用 DrawingContext 来绘制仪表面和针。**这意味着我不能再直接使用 RotateTransform 为针设置动画，而是必须在每次值更改时重新绘制整个仪表。这对我来说似乎效率低下，因为仪表面代表了大部分绘图代码，但很少会改变。但是，就使用的元素数量而言，这种方法是最轻量级的。**

 ****使用两个自定义 FrameworkElements，一个用于面部，一个用于针**
我目前倾向于这种方法。一个元素代表脸，另一个元素代表针。这将允许我使用 RotateTransform 来定位针元素。然后，仪表控件将由三个元素组成：面、针和一个面板容器来容纳它们（即画布、网格等）。所以三个元素而不是一个元素，因此不像第一种方法那么轻量级。

**使用 DrawingVisuals 绘制脸部和针头**
我也读过有关 DrawingVisual 类的信息，但我有点困惑，为什么有人会使用它而不是从 FrameworkElement 派生并覆盖 OnRender，因为 DrawingVisual 必须托管在无论如何自定义FrameworkElement。与第二种方法相比，这种方法似乎没有任何优势，并且需要更多代码，但也许我遗漏了一些东西。

任何关于人们认为哪种方法最好以及为什么最好的想法或建议都会受到欢迎！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T13:47:25.227

我个人建议使用第二种方法制作 CustomControl。除非您要同时显示超过 1000 个仪表，否则您不会注意到视觉树中的额外元素，我认为您会发现它更容易制作和维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T19:08:35.950

您可以设置一个滑块控件的样式并将值输入其中。您应该能够使滑块看起来像您需要的任何类型的仪表。

# linq - LINQ to Objects 问题

> ID：780867
> 
> 赞同：3
> 
> 时间：2009-04-23T09:01:24.180
> 
> 标签：linq, linq-to-objects

我正在编写一个传递 List<AssetMovements> 的方法，其中 AssetMovements 看起来像

```
public class AssetMovements
{
  public string Description { get; set; }
  public List<DateRange> Movements { get; set; }
} 
```

我希望能够将这些对象展平为所有运动的列表，而不管描述如何，并试图找出我需要执行此操作的 LINQ 查询。我以为

```
from l in list select l.Movements 
```

会这样做并返回 IEnumerable<DateRange> 但它返回 IEnumerable<List<DateRange>> 我不确定如何纠正这个问题。有什么建议么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-23T09:02:49.840

这个以前有人问过。您需要 SelectMany() 方法，该方法使列表列表变平。所以：

```
var movements = list.SelectMany(l => l.Movements); 
```

# wpf - 如何在 WPF 组合框中显示初始值

> ID：780879
> 
> 赞同：0
> 
> 时间：2009-04-23T09:04:54.093
> 
> 标签：wpf, combobox

XAML 代码

```
<ComboBox Height="23" Margin="69,105,111,0" Name="comboBox1" VerticalAlignment="Top" ItemsSource="{Binding StoreTypeTable}" DisplayMemberPath="StoreTypeName" SelectedValuePath="StoreTypeName"  IsSynchronizedWithCurrentItem="True" SelectedIndex="0"/> 
```

C#代码：

我的课：

```
class StoreTypes:nuClass
{
   private WSOntsu.ServiceSoapClient _WS;
   private WSOntsu.OSM007StoreType _DS;

   public StoreTypes()
   {
        try
        {
            _WS = new WpfOntsu.WSOntsu.ServiceSoapClient();
            _DS = _WS.lstStoreType();

        }
        catch (Exception e)
        {
            bResult = false;
            sResult = e.Message;
        }
             bResult = _DS.Osm007getStoreType.Rows.Count > 0;
   }

    public DataTable StoreTypeTable
    {
        get { return _DS.Osm007getStoreType; }
    }

} 
```

我的页面加载：

```
StoreTypes _ST = new StoreTypes();
comboBox1.ItemsSource = _ST.StoreTypeTable.Rows; 
```

页面加载时如何显示组合初始值？

请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T09:52:28.147

你的要求很不明确。如果要选择 ComboBox 中的第一个值，可以执行以下操作：

```
StoreTypes _ST = new StoreTypes();
comboBox1.ItemsSource = _ST.StoreTypeTable.Rows;

if (comboBox1.Items.Count > 0)
{
    comboBox1.SelectedIndex = 0;
} 
```

如果这不是您想要的，请编辑您的问题。

# com - COM 库有没有像 Reflector 这样的工具？

> ID：780880
> 
> 赞同：9
> 
> 时间：2009-04-23T09:04:55.297
> 
> 标签：com, reflector

COM 库有没有像 Reflector 这样的工具？我想打开一个 COM 库并像在 Reflector 中一样浏览类和接口。如果可能的话，我宁愿不安装 Visual Basic 6.0 来执行此操作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-23T09:16:10.277

不同的是，有许多工具可以让您检查类型库。例如[OleView](http://www.microsoft.com/downloads/details.aspx?familyid=5233b70d-d9b2-4cb5-aeb6-45664be858b6&displaylang=en)。

您还可以通过简单地将 COM 库添加到 .NET 项目中来很好地了解 COM 库中的类型。然后，您可以使用对象浏览器来浏览生成的互操作程序集，甚至可以在程序集上使用反射器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T09:26:42.263

即使此工具的正常原因是对 COM 对象进行安全评估，您仍然可以尝试 ComRaider - [http://labs.idefense.com/software/fuzzing.php#more_comraider](http://labs.idefense.com/software/fuzzing.php#more_comraider)

它类似于 Oleview。

# asp.net - 将 GridDropdownColumn 添加到 Radgrid 详细信息表

> ID：780892
> 
> 赞同：0
> 
> 时间：2009-04-23T09:10:24.377
> 
> 标签：asp.net, telerik, radgrid

我在 Radgrid 的 DetailTableDataBind 事件中绑定了一个详细信息表。事件处理程序包含将其绑定到 linqdatasource 的代码。这会将一堆 GridBoundColumns 添加到详细信息表中。但是我希望其中一些是 GridDropdownColumns。我该怎么做

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T11:46:53.003

关闭详细表的自动生成列并在需要时设置 GridDropDownColumn。在 Telerik 网站上查看这些示例以了解详细信息：

[演示](http://demos.telerik.com/aspnet-ajax/grid/examples/generalfeatures/columntypes/defaultcs.aspx)

[GridDropDownColumn 配置的帮助主题](http://www.telerik.com/help/aspnet-ajax/grdcustomizeconfiguregriddropdowncolumn.html)

迪克

# jquery - 在后台页面加载中使用 JQuery“Document.ready”？

> ID：780895
> 
> 赞同：0
> 
> 时间：2009-04-23T09:10:49.963
> 
> 标签：jquery

我有一个 PDF 组件，它可以获取一个页面以用作 PDF 的内容。在该页面中，Jquery 根据某些标准对部分进行了一些显示和隐藏。

我知道这可能是不可能的，但我可以让准备好的事件从后台页面加载中触发吗？

编辑：javascript位于作为PDF源访问的页面中，而不是创建PDF的页面。

编辑：没关系，我已经在服务器端完成了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T12:16:20.250

我不认为你能做到这一点，因为你实际上并没有在你的页面中嵌入 pdf，就像你对 swf 文件所做的那样。

事实上，浏览器如何处理这类文件（pdf、mov、mp3 等），取决于用户的设置。例如，我将浏览器设置为在 fox it reader 中下载和打开 pdf 文件，而不是在浏览器中打开；）

无论如何，我认为您可以将 pdf 嵌入到可以在加载时执行 js 功能的 flash 电影中。只是一个想法:)

# objective-c - 如何找到符合 KVC 的 Objective-C 对象的所有属性键？

> ID：780897
> 
> 赞同：26
> 
> 时间：2009-04-23T09:10:59.913
> 
> 标签：objective-c, cocoa, properties, introspection, key-value-observing

是否有一种方法可以返回符合 NSKeyValueCoding 协议的对象的所有键？

类似的东西`[object getPropertyKeys]`会返回一个 NSString 对象的 NSArray。它适用于任何符合 KVC 的对象。这样的方法存在吗？到目前为止，我在搜索 Apple 文档时还没有找到任何东西。

谢谢，G。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-23T09:22:33.333

```
#import "objc/runtime.h"

unsigned int outCount, i;

objc_property_t *properties = class_copyPropertyList([self class], &outCount);
for(i = 0; i < outCount; i++) {
    objc_property_t property = properties[i];
    const char *propName = property_getName(property);
    if(propName) {
            const char *propType = getPropertyType(property);
            NSString *propertyName = [NSString stringWithUTF8String:propName];
            NSString *propertyType = [NSString stringWithUTF8String:propType];
    }
}
free(properties); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T09:23:37.717

使用[class_getPropertyList](http://developer.apple.com/documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html#//apple_ref/c/func/class_copyPropertyList)。这将告诉你所有`@properties`的对象。

它不一定会列出所有符合 KVC 的属性，因为任何不带参数并返回值的方法都是有效的符合 KVC 的 getter。运行时没有 100% 可靠的方法可以知道哪些行为表现为属性（例如，`-[NSString length]`），哪些行为表现为命令（例如，`-[NSFileHandle readDataToEndOfFile]`）。

无论如何，您都应该声明符合 KVC 的属性`@properties`，所以这应该不是太大的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T12:40:32.357

没有这样的方法，因为 KVO 系统不需要对象/类向其注册它们支持 KVO 的属性。**任何**密钥都可能支持 KVO，唯一知道的方法是从作者的文档中。

当然，也不能保证 an`@property`会支持 KVO。很可能编写一个不需要的属性（有时可能是必要的）。因此，在我看来，获取一个类的列表`@property`然后假设它们符合 KVO 标准将是一个危险的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-24T13:13:04.263

您需要一个 getPropertyType 函数。请参阅这篇文章：[在 Objective-C 中获取对象属性列表](https://stackoverflow.com/questions/754824/get-an-object-attributes-list-in-objective-c/4008326#4008326)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-21T13:49:56.787

对于 Swift 围观者，您可以通过使用该功能来获得此`Encodable`功能。我将解释如何：

1.  使您的对象符合`Encodable`协议

    ```
    class ExampleObj: NSObject, Encodable {
        var prop1: String = ""
        var prop2: String = ""
    } 
    ```

2.  创建扩展`Encodable`以提供`toDictionary`功能

    ```
     public func toDictionary() -> [String: AnyObject]? {
        let encoder = JSONEncoder()
        encoder.outputFormatting = .prettyPrinted
        guard let data =  try? encoder.encode(self),
              let json = try? JSONSerialization.jsonObject(with: data, options: .init(rawValue: 0)), let jsonDict = json as? [String: AnyObject] else {
            return nil
        }
        return jsonDict
    } 
    ```

3.  调用`toDictionary`您的对象实例并访问`keys`属性。

    ```
    let exampleObj = ExampleObj()
    exampleObj.toDictionary()?.keys 
    ```

4.  瞧！像这样访问您的属性：

    ```
    for k in exampleObj!.keys {
        print(k)
    }
    // Prints "prop1"
    // Prints "prop2" 
    ```

# asp.net-mvc - ASP.NET MVC 页面编辑与 Web 窗体的对比

> ID：780905
> 
> 赞同：1
> 
> 时间：2009-04-23T09:13:56.383
> 
> 标签：asp.net-mvc

在我们的旧系统中，我们有从 XSLT 呈现的页面。为了将页面更改为“编辑”模式，我们将有一个某种按钮，一旦单击就会有一个 EditYN 标志，该标志将传递给存储过程。存储过程将简单地返回此变量以指示页面处于编辑模式。这意味着不需要查询字符串、视图状态或会话数据来指示页面处于编辑模式。

上周我一直在处理 ASP.NET MVC，以用于工作中的 RND。我想知道拥有一个显示数据的页面然后变成一个可以编辑所有数据的页面的最佳方式是什么？您应该转到单独的页面吗？您是否应该留在同一页面上并在视图中具有渲染逻辑以显示页面的编辑模式？

在同一主题上，我想我还会询问 GridView 及其在 MVC 架构中的位置。之前，我们只需使用数据源并使用 GridView 设置它们。然后 GridView 可以很容易地通过在数据源中设置的 UPDATE 查询自行进入编辑模式。这个过程应该如何使用 MVC 完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T09:21:40.140

为您的编辑模式制作一个提交按钮。控制器动作将响应 POST，在模型中设置“InEdit”标志，然后再次返回相同的视图。然后可以根据标志呈现视图。但我宁愿为视图和编辑模式创建两个不同的视图，然后根据控制器操作中完成的标志分析只返回一个或另一个视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T11:14:10.447

> 在同一主题上，我想我还会询问 GridView 及其在 MVC 架构中的位置。这个过程应该如何使用 MVC 完成？

您可以使用 javascript，[例如 jqGrid](http://www.trirand.com/jqgrid/jqgrid.html)或[Yahoo 的数据表](http://developer.yahoo.com/yui/datatable/)。对于更简单的数据表，您可以使用 jQuery 的 tablesorter。

在后端，您的控制器返回可由客户端修改的 json 对象，即。然后将数据发送回控制器以进行保存的 javascript 网格。

# java - 将数据传递给 swingWorker？

> ID：780906
> 
> 赞同：0
> 
> 时间：2009-04-23T09:14:11.733
> 
> 标签：java, swingworker

在调用“swingWorker.execute”之前，有没有办法将数据（例如对象）传递给 swingWorker？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:46:17.733

您应该向 SwingWorker 扩展类添加访问器

* * *

`SWExtended swe = new SWExtended();
swe.setMethod(newObjectValue);
swe.execute();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-15T11:30:31.943

通常我通过使我的 SwingWorker 的构造函数需要所需的对象来处理这个问题。这样编译器会强迫我记住传递变量。

# sharepoint - 如何根据文件名的一部分修改 Sharepoint 文件类型图标？

> ID：780908
> 
> 赞同：1
> 
> 时间：2009-04-23T09:14:31.873
> 
> 标签：sharepoint, file, icons, document-library, file-type

我们有一个**SharePoint 文档库**，我们在其中存储带有外部文件链接的**html**文件。样品：

我的图片.jpg.html

mywordfile.docx.html

我的pdf文件.pdf.html

等等。现在，默认情况下，所有文件都以 HTML 图标显示，在 DOCICON.XML 文件中引用。正如 .html 扩展名所示，这当然是正确的，它是一个 HTML 文件。但我们希望文件根据其原始文件类型具有不同的图标。

有没有办法自动更改图标

*   在渲染期间或
*   当我们将文件保存到库时（通过 SharePoint API）？

还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T14:49:02.490

为什么不在渲染过程中使用一点 jquery 来更改图标？您库中的每个文档都应包含在

`<td class="ms-vb-icon"><a tabindex=...><img ... src="/_layouts/images/ichtm.gif"></a></td>`

*我认为你可以将它放入一个数组中，分配一个新的 var，它只是去除了路径/文件名*的 href 。和*.html*，并用它来替换*src*标签中的*htm 。*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T22:10:48.140

您不能只编辑 DOCICON.xml 以添加“.jpg.html”和“.docx.html”扩展名吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T12:40:32.097

有关图标文件的完整列表，请参阅 12 hive 下的 TEMPLATE\IMAGES 目录中的所有“ic*.gif”文件。不幸的是，这不会解决您的问题，但如果您愿意，您可以根据扩展名更改它。

请注意，我不久前写的博客有不同的重点，但确实讨论了图标的来源：[http ://wiki.threewill.com/display/is/2007/10/14/External+Link+for+Editing +a+SharePoint+文档](http://wiki.threewill.com/display/is/2007/10/14/External+Link+for+Editing+a+SharePoint+Document)。

# c# - 给定类型，如何将类型转换为泛型版本？

> ID：780909
> 
> 赞同：1
> 
> 时间：2009-04-23T09:14:52.620
> 
> 标签：c#, generics

我在 C# 中遇到了泛型问题。我必须将许多泛型对象存储在一起，但它们的类型参数不同，所以我制作了一个它们实现的非泛型接口。我正在寻找的是一种在给定类型对象的情况下转换回通用版本的方法。我知道我可以通过反射来做到这一点，但我想知道是否有更好/更优雅的解决方案。

下面的代码说明了这个问题：

```
interface ITable
{
   public Type Type { get; }
}

class Table<T> : ITable
{
   public Type Type { get{ return typeof(T); } }
}

class Program
{
   static void Main(string[] args)
   {
      var tables = new Dictionary<string, ITable>();
      ... //insert tables
      DoStuffWithTable(tables["my table"]); //This doesn't work
   }

   public static void DoStuffWithTable<T>(Table<T> table)
   {
      ...//Some work
   }
} 
```

`DoStuffWithTable`有没有一种干净的方法可以根据我可以从其接口方法获得的 Type 对象的实例来调用泛型方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T09:19:40.657

如果您从非泛型类型 ( `ITable`) 开始，那么唯一的方法是通过反射 ( `MakeGenericMethod`)。它不是很漂亮或特别快，但它确实有效......

```
public static void DoStuffWithUntypedTable(ITable table)
{
    typeof(Program).GetMethod("DoStuffWithTable")
        .MakeGenericMethod(table.Type)
        .Invoke(null, new object[] { table });
} 
```

顺便说一句 - 请注意，假设 an`ITable`实际上是 a 存在一些风险`Table<T>`- 您可能应该验证这一点，并且可能还使用接口（`ITable<T>`）。

* * *

编辑：如果它确实必须是 a `Table<T>`，那么您可以强制执行此操作（包括子类支持，例如`FooTable : Table<Foo>`：

```
public static void DoStuffWithUntypedTable(object table)
{
    Type type = table.GetType();
    while (type != typeof(object))
    {
        if (type.IsGenericType && type.GetGenericTypeDefinition()
              == typeof(Table<>))
        {
            typeof(Program).GetMethod("DoStuffWithTable")
                .MakeGenericMethod(type.GetGenericArguments()[0])
                .Invoke(null, new object[] { table });
            return;
        }
        type = type.BaseType;
    }
    throw new ArgumentException("Not a Table<T> or subclass");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T09:21:14.477

问题是您在编译时不知道类型 - 这是为泛型量身定制的。

要调用在执行时只知道类型参数的泛型方法，您基本上需要反射 - 获取泛型方法，调用[`MakeGenericMethod`](http://msdn.microsoft.com/en-us/library/system.reflection.methodinfo.makegenericmethod.aspx)然后调用返回的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T09:20:00.627

你需要转换，你实际上需要知道实际的类型，除非它没有意义。

```
DoStuffWithTable<MyType>((Table<MyType>)tables["my table"]); 
```

如果您想在不知道实际类型的情况下调用它，您应该考虑使该方法不是通用的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T09:54:24.817

这里在泛型和多态之间存在误解。通常，泛型处理在编译时定义类型的单一类型的事物^*，而多态性是关于表现出定义为接口或基类型的通用功能的不同类型的事物。

您似乎正在尝试创建一个多态类型（表现出相同行为的不同类型的事物），其中每个多态实例都由泛型类型定义。

因此，要更新您的代码：

```
interface ITable
{
   void SomeCommonFunction ();
}

class Table<T> : ITable
{
   void SomeCommonFunction () { do something - T is known at compile time! }
}

class Program
{
   static void Main(string[] args)
   {
      var tables = new Dictionary<string, ITable>();
      ... //insert tables
      tables["my table"].SomeCommonFunction ();
   }
} 
```

现在，如果您想在 SomeCommonFunction 中执行依赖于类型 T 的不同事情，那么您希望拥有 Table 类型的特定实例化。C# 不允许像 C++ 使用其模板那样对泛型类型进行特化，因此您必须这样做：

```
class TableOfInt : ITable
{
   void SomeCommonFunction () { do something different! }
} 
```

* 您可以在运行时在 C# 中定义类型，但这进入了疯狂的反射领域。

# .net - .NET IOC 容器，允许删除注册

> ID：780915
> 
> 赞同：1
> 
> 时间：2009-04-23T09:16:47.577
> 
> 标签：.net, inversion-of-control

我只对 AutoFac 非常熟悉，我问它是否可以使用下面详述的功能，它似乎“不完全”。您知道可以使用的容器吗？

```
[TestFixture]
public class SomeCunningTests
{
    class SomeType        {        }

    [Test]
    public void TestRegistrationScope()
    {
        var container = new IocContainerOfSomeKind();
        using (new RegistrationScope(container, new SomeType()))
        {
            Assert.IsTrue(container.IsRegistered(typeof(SomeType)));
        }
        Assert.IsFalse(container.IsRegistered(typeof(SomeType)));
    }

    public class RegistrationScope<T> : IDisposable
    {
        public RegistrationScope(IocContainerOfSomeKind container, T instance)
        {
            //code here for registering instance
        }
        public void Dispose()
        {
            //unregister instance somehow
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T22:18:29.067

[MEF](http://mef.codeplex.com)将适用于这种情况。我相信您需要做的就是为您的目录使用 AggregateCatalog，它提供了在运行时添加到目录和从目录中删除的能力，因为它公开了[ComposablePartCatalogCollection](http://mef.codeplex.com/SourceControl/changeset/view/30766#455548)。

目录基本上是用于组合的类型的注册表。

# database - 如何使用 c# 3.0 最好地设计访问数据库的包装器？

> ID：780919
> 
> 赞同：0
> 
> 时间：2009-04-23T09:18:15.187
> 
> 标签：database, .net-3.5, console, wrapper

我对 .net 1.1 和 2.0 的了解非常有限，所以我对他们在 .net 3.5 中的许多变化感到非常兴奋和困惑。所以我有这个访问数据库，但我们不希望其他程序直接调用这个数据库。所以我正在编写一个包装 exe，其中包含可由其他程序调用以返回数据的函数（ala Web 服务样式）。

所以现在我已经设法创建了一个控制台应用程序，加密了连接字符串并从数据库中提取了一些数据。

1.  我怎么做才能让其他程序可以调用这个exe的函数？
2.  如何将适当的数据返回给调用程序？
3.  我的情况有什么问题或更好的设计吗？

我很想向这里的任何 dot net 人学习 :) 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T09:30:10.993

为什么不使用现有的数据访问层技术来封装对 Access 数据库的调用？

我以前在 Microsoft Access 数据库中使用过强类型数据集。您也可以使用 NHibernate。

# c - 如何用c获取主板的uuid

> ID：780920
> 
> 赞同：1
> 
> 时间：2009-04-23T09:18:16.340
> 
> 标签：c, windows

我需要一个代码片段来读取 c 中的主板 uuid（如果存在差异，则在 Windows XP 和 Windows Vista 中，否则仅适用于 Windows）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T09:29:17.250

[此 MSDN 示例](http://msdn.microsoft.com/en-us/library/aa394072.aspx)展示了如何使用 Windows Management Instrumentation API 来读取有关本地计算机的信息。它不会直接访问“UUID”（我猜这将是主板的序列号），但应该可以通过修改示例来到达那里。

还要注意[Win32_BaseBoard](http://msdn.microsoft.com/en-us/library/aa394072.aspx) WMI 类，它有一个`SerialNumber`成员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T09:30:27.373

您可以从 WMI 获得它。通过 c/c++尝试 WMI 这个[链接](http://msdn.microsoft.com/en-us/library/aa394558(VS.85).aspx)

但我只能在vb中找到这个[例子](http://www.freevbcode.com/ShowCode.asp?ID=2664)

# shared-libraries - 想详细了解共享库相对于静态库的工作方式

> ID：780923
> 
> 赞同：5
> 
> 时间：2009-04-23T09:19:16.837
> 
> 标签：shared-libraries, static-libraries

我正在创建和链接共享库（.so）。在与他们合作时，弹出了许多问题，当我搜索它们时我找不到令人满意的答案，因此将它们放在这里。我有关于共享库的问题是：

1.) 共享库与静态库有何不同？它们的创建方式和执行方式的主要区别是什么？

2.) 如果是共享库，在什么时候将加载和运行共享库中的特定函数的地址？谁提供这些功能是加载/运行地址？

3.) 与与静态库链接的应用程序相比，与共享库链接的应用程序执行速度会慢吗？

4.) 在这两种情况下，应用程序的可执行文件大小会有所不同吗？

5.) 可以通过进入共享库中定义的函数来进行源代码级调试吗？是否需要任何额外的东西才能使这些功能对应用程序可见？

6.) 使用这两种库的优缺点是什么？

谢谢。

-广告

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T09:23:40.447

请参阅此 SO 问题[何时使用动态库与静态库](https://stackoverflow.com/questions/140061/when-to-use-dynamic-vs-static-libraries)和此[HOWTO](http://www.dwheeler.com/program-library/Program-Library-HOWTO/t1.html)。

# java - 如果服务器使用 write 发送数据并使用 readUTF() 接收数据，Java Socket 程序将无法读取数据

> ID：780927
> 
> 赞同：1
> 
> 时间：2009-04-23T09:20:42.060
> 
> 标签：java, sockets

我编写了一个套接字程序，客户端使用`readUTF()`并`writeUTF()`与服务器通信，而服务器使用 read() 和 write() 与客户端通信。

我的服务器可以读取来自服务器的所有数据。我在服务器端使用 write()，在客户端使用 readUTF()。

因此，在这种情况下，如果数据量很大，我的客户端无法获取服务器发送的所有数据，只能接收到部分数据。

应该做些什么来确保所有数据都被传输？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T09:40:28.300

在这种情况下不要使用 readUTF 和 writeUTF。而是读写​​字节数组：

```
read(byte [] b) 
```

然后使用适当的 String 构造函数将字节数组转换为 String：

```
public String(byte[] bytes,
              String charsetName) 
```

您应该尝试捕获 UnsupportedEncodingException 异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T09:35:59.217

请注意，[readUTF](http://java.sun.com/j2se/1.3/docs/api/java/io/DataInput.html#readUTF%28%29)和 writeUTF 使用 UTF 的修改形式。我不知道您在服务器上使用 read() 和 write() 发送什么，但您应该确保客户端期望的内容与服务器期望的内容之间存在兼容性。

我会使用相同的方法使客户端和服务器都发送/接收。我不知道这是否会导致您的问题，但它会为您节省一些无关的悲伤。

# php - 实现在线订单跟踪数据库的最简单方法

> ID：780928
> 
> 赞同：1
> 
> 时间：2009-04-23T09:20:54.710
> 
> 标签：php, mysql, database, google-app-engine

一位客户要求我为我们为他们所做的工作制作一个在线跟踪系统（我们将为该客户排版大量书籍）。基本上，它将是一个数据库，显示我们目前正在编写的书籍，以及我们处于项目的哪个阶段以及预计完成日期的信息。唯一可以访问该系统的人是我们和客户公司的员工。

我以前在 MySQL 和 PHP 工作过；我应该只用我所知道的吗？[This answer](https://stackoverflow.com/questions/326364/easiest-most-maintainable-online-db-solution/326388#326388) to a similar question建议使用 Google Apps。我没有任何Python经验，但很高兴学习......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-23T09:27:59.407

您是唯一使用此功能的人，因此我认为没有理由使用 Google Apps。我通常厌倦有人建议使用 Google Apps、Amazon 的 s3、Microsoft Azure 等。此外，您将使用完全不同的数据存储。除非您想找个借口来学习使用 Google Apps 和 Python，否则我会说使用 MySQL+PHP 并完成它！简而言之，您在这里使用 Google Apps 并没有任何技术原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T09:28:15.693

在处理向客户交付产品时，坚持您所知道的始终是一个很好的解决方案。在您学习新技术时，没有客户愿意成为您的试验品，尽管这通常是这样做的。如果您对 MySQL 和 PHP 感到满意，那么如果它满足您的要求，请坚持使用它，如果看起来不满意，则寻找用 PHP 编写的库、框架和组件，以帮助您实现该目标。如果您仍然有困难（不太可能考虑到给定项目的范围），请在此处提问 :) 并在网上搜索解决方案和模式。

如果一切都失败了，并且您可以使用另一种技术清楚地解决您的问题，那么请考虑搬家，但要确保您的客户知道这将如何影响您的时间框架。

当您实施了这个项目并有一些空闲时间时，如果您想探索一个新的方向，那么就以这个项目为您的基础，并在没有截止日期的情况下开始工作。

那是我的 2 便士价值……祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T10:21:21.603

在开发这样的 CRUD 应用程序时，如果从头开始，您可能需要重新发明轮子。项目的许多部分并不是项目独有的。例如身份验证、数据库访问、表单操作等。

如果完成工作对您很重要，那么启动您的项目并阻止您浪费太多时间可能很重要。

**使用编码框架**

框架通常有很多开箱即用的功能。选项可能包括[Django](http://www.djangoproject.com/)、[Ruby on Rails](http://en.wikipedia.org/wiki/Ruby_on_Rails)、[Joomla](http://www.joomla.org/)、[CakePHP](http://cakephp.org/)、[CodeIgniter](http://codeigniter.com)。

**破解久经考验的应用程序**

开源项目通常很容易根据您的需求进行塑造。Drupal 和 Joomla 是 CMS 产品，可以以多种方式使用。如果您的图书跟踪 drupal 模块不错，也许您可​​以继续将其作为开源插件提供？

**以新的方式使用当前可用的应用程序**

您的应用似乎正在跟踪添加到数据库中的项目的状态。如何使用专为跟踪其他类型项目而设计的软件。例如错误跟踪软件、项目管理待办事项列表软件或客户关系管理软件？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T10:03:35.840

好吧，正如大家已经说过的，如果您已经了解 PHP，那一定非常诱人。

但这听起来很简单，像 Django 这样的东西可能会为您节省大量时间：它的内置管理界面可用于工作的“更新”方面，因此您需要模板化的只是“读取”侧，这很容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-20T18:20:49.767

我建议你也看看[Viravis](http://www.viravis.com "在线数据库应用平台")。

# ruby - 用 ruby 创建漂亮的 pdf

> ID：780932
> 
> 赞同：2
> 
> 时间：2009-04-23T09:21:42.043
> 
> 标签：ruby, image, pdf, text

我想用 ruby​​ 创建 pdf。一个特殊的需求是将图片嵌入到文本（或文本块）中，这意味着我需要能够让文本在图像周围流动。例如，图像应位于右上角，文本应从图像的左侧开始，并使用页面的整个宽度在图像之后继续。我怎样才能在红宝石中做到这一点？感谢您的任何建议！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T04:15:26.563

过去，为了在 Ruby 中获得打印质量的 PDF，我使用[rtex](http://github.com/bruce/rtex)。

它也很快，这是一个真正的好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-23T09:31:41.143

[大虾](http://prawn.majesticseacreature.com/)救命？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T11:03:07.383

我喜欢 html -> pdf 方法。虽然它可能不是最好的选择（虾是），但它使设计 pdf 变得容易。看到这个[网站](http://blog.adsdevshop.com/2007/11/20/easy-pdf-generation-with-ruby-rails-and-htmldoc/)。您也可以采用[jimneath.org](http://jimneath.org/2009/02/16/creating-pdf-documents-in-ruby-on-rails/)中记录的方法。

祝你好运

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-23T11:29:02.297

[iText](http://www.lowagie.com/iText/)是重量级的，它可以让你用 PDF 做任何你想做的事情，你可以用 jRuby 桥接到它。

我使用的另一个选项是驾驶开放式办公室（它有一个 uiless 选项，您可以从 Ruby 自动化）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T01:56:04.637

让 Ruby 生成一些 LaTeX 代码，然后使用 pdflatex 生成 PDF 怎么样？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T13:04:53.113

虽然我自己没有做过，但我见过人们使用无头开放式办公室。您可以从 Ruby 控制它并使用它来生成 PDF 文件。您甚至可以使用 Open Office 模板并在其中填写一些元素。

# algorithm - 线性时间投票算法。我不明白

> ID：780937
> 
> 赞同：42
> 
> 时间：2009-04-23T09:22:52.227
> 
> 标签：algorithm, language-agnostic, puzzle

当我阅读本文时（[在数组中查找最常见的条目](https://stackoverflow.com/questions/278488/puzzle-find-the-most-common-entry-in-an-array)），建议使用[Boyer 和 Moore 的线性时间投票算法](http://www.cs.utexas.edu/users/moore/best-ideas/mjrty/index.html)。

如果您点击该网站的链接，则会逐步解释该算法的工作原理。对于给定的序列，`AAACCBBCCCBCC`它提供了正确的解决方案。

> 当我们将指针向前移动到元素 e 上时：
> 
> *   如果计数器为 0，我们将当前候选设置为 e，并将计数器设置为 1。
> *   如果计数器不为 0，我们根据 e 是否是当前候选者来增加或减少计数器。
> 
> 完成后，如果有多数，则当前候选人是多数元素。

如果我在一张纸上使用这个算法`AAACCBB`作为输入，**建议的候选人将变成 B**，这显然是错误的。

在我看来，有两种可能

1.  作者从未在任何其他方面尝试过他们的算法`AAACCBBCCCBCC`，完全无能，应该当场解雇*（怀疑）*。
2.  **我显然遗漏了一些东西**，必须从 Stackoverflow 被禁止，并且永远不能再接触任何涉及逻辑的东西。

注意：这是来自 Niek Sanders[的算法的 C++ 实现。](http://www.cis.rit.edu/~njs8030/coding/majority.C)我相信他正确地实现了这个想法，因此它有同样的问题（或者不是吗？）。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-04-23T09:28:40.713

该算法仅在集合具有多数时才有效 - 超过一半的元素相同。`AAACCBB`在你的例子中没有这样的多数。最常见的字母出现 3 次，字符串长度为 7。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-07-03T13:16:09.200

对其他解释的小而重要的补充。摩尔的投票算法有 2 个部分 -

1.  运行摩尔投票算法的第一部分**只为您提供多数元素的候选人**。请注意这里的“候选人”一词。

2.  在第二部分中，我们需要再次**遍历数组**以确定该候选是否出现最大次数（即大于 size/2 次）。

第一次迭代是找到候选者，第二次迭代是检查这个元素是否在给定数组中出现大多数次。

所以时间复杂度为：`O(n) + O(n) ≈ O(n)`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-23T09:31:05.123

从第一个链接的 SO 问题开始：

> 具有数组中超过一半的条目等于 N 的属性

来自 Boyer 和 Moore 页面：

> 序列的哪个元素占多数，前提是存在这样的元素

这两种算法都明确假设一个元素**至少出现 N/2 次**。（特别注意“多数”与“最常见”不同。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-29T19:35:55.533

我为这个算法写了一个 C++ 代码

```
char find_more_than_half_shown_number(char* arr, int len){
int i=0;
std::vector<int> vec;
while(i<len){
    if(vec.empty()){     
        vec.push_back(arr[i]);
        vec.push_back(1);
    }else if(vec[0]==arr[i]){ 
        vec[1]++;
    }else if(vec[0]!=arr[i]&&vec[1]!=0){
        vec[1]--;
    }else{                   
        vec[0]=arr[i];
    }
    i++;
}
int tmp_count=0;
for(int i=0;i<len;i++){
    if(arr[i]==vec[0])
        tmp_count++;
}
if(tmp_count>=(len+1)/2)
    return vec[0];
else
    return -1;
} 
```

主要功能如下：

```
int main(int argc, const char * argv[])
{
    char arr[]={'A','A','A','C','C','B','B','C','C','C','B','C','C'};
    int len=sizeof(arr)/sizeof(char);
    char rest_num=find_more_than_half_shown_number(arr,len);
    std::cout << "rest_num="<<rest_num<<std::endl;
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-23T16:33:09.483

当测试用例为“AAACCBB”时，集合没有多数。因为“AAACCBB”的长度是 7，所以没有元素出现超过 3 次。

这是“博耶和摩尔的线性时间投票算法”的代码：

```
int Voting(vector<int> &num) {
        int count = 0;
        int candidate;

        for(int i = 0; i < num.size(); ++i) {
            if(count == 0) {
                candidate = num[i];
                count = 1;
            }
            else
                count = (candidate == num[i]) ? ++count : --count;
        }
        return candidate;
    } 
```

# nhibernate - NHibernate 中的批量更新

> ID：780940
> 
> 赞同：24
> 
> 时间：2009-04-23T09:23:09.450
> 
> 标签：nhibernate

NHibernate 中是否存在批量更新命令？据我所知，它没有。那么处理这种情况的最佳方法是什么？我想做以下事情：

1.  从数据库中获取对象列表（我们称它们为用户列表`List<User>`）
2.  更改这些对象的属性， ( `Users.Foreach(User=>User.Country="Antartica"`)
3.  单独更新每个项目 ( `Users.Foreach(User=>NHibernate.Session.Update(User)`)。
4.  调用`Session.Flush`以更新数据库。

这是一个好方法吗？这会导致我的代码和数据库之间进行大量往返吗？

你怎么看？还是有更优雅的解决方案？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-02-17T14:02:51.920

我知道我迟到了，但我想你可能想知道现在可以在 NHibernate 2.1+ 中使用 HQL

```
session.CreateQuery(@"update Users set Country = 'Antarctica'")
.ExecuteUpdate(); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-04-05T11:46:07.750

启动 NHibernate 3.2 批处理作业有一些改进，可以最大限度地减少数据库往返。更多信息可以在[HunabKu 博客](http://fabiomaulo.blogspot.com/2011/03/nhibernate-32-batching-improvement.html)上找到。这是其中的示例 - 这些批量更新仅执行 6 次往返：

```
using (ISession s = OpenSession())
using (s.BeginTransaction())
{
    for (int i = 0; i < 12; i++)
    {
        var user = new User {UserName = "user-" + i};
        var group = new Group {Name = "group-" + i};
        s.Save(user);
        s.Save(group);
        user.AddMembership(group);
    }
    s.Transaction.Commit();
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-23T09:44:23.673

您可以在 nhibernate 配置文件中设置更新的批量大小。

```
<property name="hibernate.adonet.batch_size">16</property> 
```

而且您不需要在那里调用 Session.Update(User) - 只需刷新或提交事务，NHibernate 就会为您处理事情。

编辑：我打算发布一个指向 nhibernate 文档相关部分的链接，但该网站已关闭 -这是 Ayende关于该主题[的旧帖子：](http://ayende.com/Blog/archive/2006/09/16/BatchingSupportInNHibernate.aspx)

至于在这里使用 NHibernate（或任何 ORM）是否是一种好方法，这取决于上下文。如果您正在使用单个值对大表中的每一行进行一次性更新（例如将所有用户设置为国家“南极洲”（顺便说一下，这是一个大陆，而不是一个国家！），那么您可能应该使用 sql UPDATE 语句。如果您打算在应用程序的一般使用中将多个记录与一个国家/地区作为业务逻辑的一部分同时更新，那么使用 ORM 可能是一种更明智的方法。这取决于数量您每次更新的行数。

如果您不确定，也许这里最明智的选择是调整 NHibernate 中的 batch_size 选项，看看效果如何。如果系统的性能不可接受，那么您可能会考虑在代码中实现直接的 sql UPDATE 语句。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-02-01T16:35:29.400

从 NHibernate 5.0 开始，可以使用 LINQ 进行批量操作。

```
session.Query<Cat>()
.Where(c => c.BodyWeight > 20)
.Update(c => new { BodyWeight = c.BodyWeight / 2 }); 
```

NHibernate 将生成单个“更新”sql 查询。

请参阅[更新实体](http://nhibernate.info/doc/nhibernate-reference/querylinq.html#querylinq-modifying-update)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-23T09:34:44.040

您不需要更新，也不需要刷新：

```
IList<User> users = session.CreateQuery (...).List<User>;
users.Foreach(u=>u.Country="Antartica")
session.Transaction.Commit(); 
```

我认为 NHibernate 为所有更改编写了一个批处理。

问题是，您的用户需要加载到内存中。如果遇到问题，您仍然可以使用 NHibernate 使用本机 SQL。但是，除非您没有证明这是一个性能问题，否则请坚持使用不错的解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T09:53:21.857

不，这不是一个好方法！

对于这种更新，本机 SQL 好很多倍。

```
UPDATE USERS SET COUNTRY = 'Antartica'; 
```

简直再简单不过了，数据库引擎将比一次一行的 Java 代码更高效地处理它一百倍。

# actionscript-3 - Flex3：自定义项渲染器不监听父级调度的事件

> ID：780951
> 
> 赞同：1
> 
> 时间：2009-04-23T09:26:26.353
> 
> 标签：actionscript-3, events, apache-flex, flex3, itemrenderer

我有一个带有自定义 ItemRenderer 的列表。ItemRenderer 包含一个复选框和一个标签。带有列表的组件有一个“全选”复选框。当“全选”复选框被选中时，它会调度一个事件，每个项目都应该监听以选择自己的复选框。EventListener将在每个项目的CreationComplete上添加，并且选择“选择”复选框时正确派出了该事件，但是自定义ItemRenderer中的侦听器不收听。

如何让 ItemRenderer 监听在其父级中调度的事件？

我将添加一些代码示例来澄清：

```
------- container ----------
<mx:VBox>
   <mx:Script>
      <![CDATA[
         public var user1 = new User(1, "Jack");
         public var user2 = new User(2, "John");
         public var user3 = new User(3, "Mary");

         [Bindable]
         public var users:ArrayCollection = new ArrayCollection([user1], [user2], [user3]);

         public static const SELECT_ALL_USERS:String = "selectAllUsers";

         private function selectAllChangeHandler():void
         {
            if (selectAll.selected)
               dispatchEvent(new Event(SELECT_ALL_USERS,true));
         }
      ]]>
   </mx:Script>
   <mx:CheckBox id="selectAll" change="{selectAllChangeHandler()}" />
   <mx:List dataProvider="{users}" itemRenderer="myRenderer" />
</mx:VBox>

------- renderer ----------
<?xml version="1.0" encoding="utf-8"?>
<mx:HBox creationComplete="{init()}">
   <mx:Script>
      <![CDATA[
         private function init():void
         {
            addEventListener (Container.SELECT_ALL, selectAllHandler, false, 0, true);
         }

         private function selectAllHandler():void
         {
            checkbox.selected=true;
         }

         private function selected(id:int):Boolean
         {
             return id==1 || id==3;
         }
      ]]>
   </mx:Script>

   <mx:CheckBox id="checkbox" selected="{selected(data.id)}" />
   <mx:Label text="{data.name}" />
</mx:HBox> 
```

请注意，用户 ArrayCollection 或其包含的用户对象无法更改，因为我稍后需要这些值。因此，当单击“selectAll”时，还应选中列表中的每个复选框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T09:37:57.620

您的自定义 ItemRenderers 不应向其父级注册事件侦听器，而应使用您的“全选”复选框，即

```
theCheckbox.addEventListener(YourEvent.YOUR_EVENT, itemRendererSelectAllHandler); 
```

如果做不到这一点，您可以发布添加事件侦听器并从复选框分派事件的代码吗？

**编辑：**

这是您的错误：在渲染器的 init() 中，您需要添加一个事件侦听器，而不是渲染器，而是调度事件的容器。所以做一个

```
container.addEventListener(Container.SELECT_ALL_USERS, selectAllHandler, false, 0, true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T09:51:02.313

在 flex 中进行全选并不复杂，但我会告诉你我们是如何做到的，而且效果很好。

我们创建了一个名为“ExList”的列表派生控件，它具有一个属性“selectAllCB”，我们将其绑定到现有的复选框，该复选框将适用于选择所有逻辑。请注意，当我们设置 selectAllCB 属性时，我们让 ExList 监听复选框的事件。

选中复选框时，我们手动将 selectedItems 数组设置为 dataProvider 数组，并选择所有项目。

使用 itemRenderer 无法正常工作，因为当您一次又一次地编写列表时，您必须编写大量代码。

```
I am attaching some sample code here below..

    public class ExList extends List 
    {
        public function ExTileList()
        {
            super();
            this.allowMultipleSelection = true;
        }

        private var _selectAllCB:CheckBox = null;
        [Bindable]
        public function get selectAllCB():CheckBox
        {
            return _selectAllCB;
        }
        public function set selectAllCB(v:CheckBox):void
        {
            if(v==null)
                return;
            _selectAllCB = v;
            v.addEventListener(ListEvent.ITEM_CLICK, handleAllChange,false, 0 , true);
            v.addEventListener("change", handleAllChange,false, 0 , true);
        }

        private function handleAllChange(e:Event):void
        {
            if(_selectAllCB.selected)
            {
                this.selectedItems = this.dataProvider.toArray();
            }
            else
            {
                this.selectedItems = new Array();
            }
        }
} 
```

您可以将其用作...

```
<CheckBox id="sAll"/>
<ExList selectAllCB="{sAll}"/>

// Please note its in curly braces 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-08T02:23:19.720

这就是我实现解决方案的方式：

```
 <?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" height="150" verticalGap="0">
    <mx:Script>
 <![CDATA[
         import mx.events.ListEvent;
  import mx.controls.CheckBox;
  import mx.collections.ArrayCollection;

  public var listData:ArrayCollection;

  private function selectAll():void
  {
   listChkBox.selectedItems = listData.toArray();
   for each (var item:Object in listChkBox.selectedItems)
   {
    CheckBox(listChkBox.itemToItemRenderer(item)).selected = true;
          }   
  }

  private function resetAll():void
  {
   listChkBox.selectedItems = listData.toArray();
   for each (var item:Object in listChkBox.selectedItems)
   { 
                         CheckBox(listChkBox.itemToItemRenderer(item)).selected = false;
   } 
  }

  ]]>
 </mx:Script>
 <mx:List width="100%" height="100%" id="listChkBox" labelField="name" allowMultipleSelection="true"
   dataProvider="{listData}"  selectionColor="#FFFFFF" >
  <mx:itemRenderer>
   <mx:Component>
    <mx:CheckBox >
    </mx:CheckBox>
   </mx:Component>
  </mx:itemRenderer>
 </mx:List>
 <mx:HBox width="100%"  backgroundColor="#E2DEDE" paddingBottom="2" paddingLeft="2" paddingTop="2" paddingRight="2" borderStyle="solid">
  <mx:Button label="All"  id="btnAll" click="selectAll()" />
  <mx:Button label="None" click="resetAll()"/>
 </mx:HBox>
</mx:VBox> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-22T16:14:06.233

简单的解决方案是在您呈现的数据列表中使用类型化对象，然后利用数据绑定和绑定实用程序来捕获对项目渲染器上的基础数据属性的更改。当对象中的某些属性被更改以反映“全选/全选”状态时，覆盖项目渲染器中的“设置数据”功能以执行您需要的任何操作。

# java - Java类问题

> ID：780954
> 
> 赞同：4
> 
> 时间：2009-04-23T09:27:59.373
> 
> 标签：java, class

```
class One {
public One foo() { return this; }
}

class Two extends One {
public One foo() { return this; }
}

class Three extends Two {
public Object foo() { return this; }
} 
```

`public Object foo() { return this; }`引发编译错误。这是为什么？有人可以解释为什么“对象”类型是不可能的吗？Object 是 Class 一、二的基类吗？如果是，为什么会引发错误？

请更改问题的标题，因为我找不到合适的标题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-23T09:31:39.787

`Three.foo`正在尝试覆盖`Two.foo()`，但它没有正确执行。假设我要写：

```
One f = new Three();
One other = f.foo(); 
```

忽略*实际上* `Three.foo()` *确实*返回 a的事实， `One`of 的签名`Three.foo()`并不能保证它。因此，对于*必须*返回`One`.

请注意，您*可以*更改返回类型并仍然覆盖，但它必须*更*具体而不是*less*。换句话说，这没问题：

```
class Three extends Two {
    public Three foo() { return this; }
} 
```

因为`Three`比 更具体`One`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T09:30:49.757

您正在以不受支持的方式更改 foo 方法的签名。多态性仅适用于不同的参数列表，不适用于仅因返回类型不同而不同的相同方法。

如果你想一想，这很自然......如果它起作用并且只知道两个超类之一的人会调用 Three.foo() 他会期望它返回一个 One （因为它就是这样在一和二中工作）但在三中你实际上可以返回一个 HashMap 并且仍然表现正确。

Jon（在下面的评论中）是正确的，你可以缩小范围，但你仍然会遵循协议，你将返回一个“One”（如果你从 Three.foo() 返回一个 Three），因为子类都将实现超类接口。但是，返回类型仍然不是多态性的一部分，因此您不能拥有三种仅因返回类型不同而不同的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T09:36:17.967

它将启用：

```
class Four extends Three {
public Object foo() { return "This String is not an instance of One"; }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T09:43:30.850

覆盖一个方法并试图返回一个不太具体的类型违反了[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)，该原则规定子类必须履行其超类的所有契约。您的第三类违反了超类合同“foo（）返回一个实例”。

# firefox - 如何创建隐藏的 Firefox 扩展？

> ID：780960
> 
> 赞同：1
> 
> 时间：2009-04-23T09:28:46.563
> 
> 标签：firefox, google-chrome, xul

是否可以创建不会显示在扩展列表中的 Firewox 扩展？所以不能手动卸载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T17:13:00.273

要在扩展列表中隐藏扩展/插件，`about:addons`只需遵循以下几个简单步骤：

*   (1) 创建一个 zipfile **myextenios.zip**（firefox 扩展实际上是 zip 文件），具有以下结构：

```
我的扩展名.zip
|
|--chrome.manifest
|--安装.rdf
|--[内容]
    |--hideExtensions.css

```

*   (2) **chrome.manifest**应该有这个内容：

```
内容 myextension 内容/
样式 chrome://mozapps/content/extensions/extensions.xul chrome://myextension/content/hideExtensions.css
关于样式：addons chrome://myextension/content/hideExtensions.css

```

*   (3) **install.rdf**应该有这样的内容：

```
<?xml 版本="1.0"?>

<RDF xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:em="http://www.mozilla.org/2004/em-rdf#" >

  <Description about="urn:mozilla:install-manifest">
    <em:id>myextension@yoursite.de</em:id>
    <em:name>我的扩展</em:name>
    <em:description>此插件隐藏 about:addons 中的插件条目</em:description>
    <em:optionsURL></em:optionsURL>
    <em:iconURL></em:iconURL>
    <em:version>1.0</em:version>
    <em:creator>你的名字</em:creator>
    <em:homepageURL>http://www.yourside.de</em:homepageURL>
    <em:type>2</em:type>
    <em:targetApplication>
      <说明>
        <em:id>{ec8030f7-c20a-464f-9b0e-13a3a9e97384}</em:id>
        <em:minVersion>4.0</em:minVersion>
        <em:maxVersion>14.*</em:maxVersion>
      </说明>
    </em:targetApplication>
  </说明>
</RDF>

```

*   (4) 最后文件**hideExtensions.css**必须有以下内容：（
    *注意：当然你可能想调整你想要隐藏的扩展名）*

```
.addon[name="1\. 要隐藏的插件名称"],
.addon[name="2\. 要隐藏的插件名称"],
.addon[name="3\. 要隐藏的插件名称"],
.addon[name="myextension"]
{
显示：无；
}

```

*   (5) 将 myextension.zip 重命名**为**myextension.xpi**以便**将其识别为扩展 + 通过将文件拖入 Firefox 浏览器窗口进行安装。

## 结论：

大多数步骤 baove 与创建任何其他 Firefox 扩展的步骤相同。因此，任何知道创建 Firefox 插件/扩展程序的人也可能导致此扩展程序**不会出现在您输入****about:addons**时看到的插件列表中。因此，如果您只有一个恶意 Firefox 扩展程序（病毒），那么您就无法信任 Firefox，甚至无法在列表中看到此病毒扩展程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T09:48:13.693

请参阅此[mozillazine 条目](http://kb.mozillazine.org/Uninstalling_extensions#Malicious_extensions)和此[论坛条目](http://forums.mozillazine.org/viewtopic.php?f=38&t=948945)。这些扩展以某种方式通过注册表安装并且应该是恶意的 - 所以除非您想加入某些恶意软件黑名单，否则没有任何用处。

对于像 MSalters 在他的评论中建议的私人使用或管理使用，“隐藏”（对于某些用户）扩展可能很有用，但这应该首先由 Mozilla 实现。

# iphone - iPhone 应用程序操作按钮

> ID：780965
> 
> 赞同：2
> 
> 时间：2009-04-23T09:30:39.557
> 
> 标签：iphone, button, uibutton

我需要在我的 iPhone 应用程序中添加一个操作按钮。单击该按钮时，需要弹出带有按钮的 UIActionSheet。谁能告诉我如何添加操作按钮？- 表示 iPhone 应用程序是否有内置操作按钮？还是我们需要创建一个带有图像的新按钮？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T19:11:32.877

假设这是在视图控制器中，您可以执行以下操作：

```
- (void)viewDidLoad
{
    UIBarButtonItem *actionButton = [[UIBarButtonItem alloc]
            initWithBarButtonSystemItem:UIBarButtonSystemItemAction
            target:self
            action:@selector(methodThatShowsSheet)];
    self.navigationItem.rightBarButtonItem = actionButton;
    [actionButton release];
} 
```

（请原谅奇怪的缩进以使其适合合理的宽度（我通常只是让 Xcode 自动包装缩进所有内容））。

有关如何实施的信息，请参阅 Nick Veys 的回答`methodThatShowsSheet`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T17:32:16.827

您需要从您决定将显示此操作表的按钮连接到显示它的代码。

有关执行此操作的帮助，请参阅[UIActionSheet 上的 Apple 文档。](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIActionSheet_Class/Reference/Reference.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T12:12:33.427

我不确定我是否理解您的问题，但 UIKit 包含 UIButton 类，该类会自动向对象（也由您指定）发送消息（由您指定）。您可以在 nInterface 构建器中或以编程方式创建 UIButton。

如果没有更多关于你真正想做的事情或你为什么觉得困难的细节，就很难更精确。

# silverlight - 在 Windows 上进行 DirectX 编程，首选的方式是什么？

> ID：780969
> 
> 赞同：5
> 
> 时间：2009-04-23T09:31:06.747
> 
> 标签：silverlight, directx

我需要以一种引人注目的方式开发业务应用程序的一部分。因此想看看我是否可以使用DirectX。这就是我得到的。

1.  首先，我读到使用 C/C++ 就像在踢自己的脚，我应该改用 DirectX.NET。我不能不同意。这是21世纪。

2.  下载了 DirectX SDK，但在其中找不到 .NET 程序集。现在在网上搜索发现 DirectX .NET（称为 MDX）现已过时（于 2006 年发布）。我应该改用主要为 XBOX 开发的 XNA。

3.  已下载 XNA。但它不会安装，因为我没有 C#.NET Express 2005 SP1。在我的 VS Pro 2005 上安装了 SP1。但它仍然无法安装。它需要 Express 2005 和那个单一的版本，而不是 Pro，显然不是 2008。

4.  沮丧尝试下载免费的 C#.NET Express。但是来自 MS 的链接说 C#.2005 实际上下载了 C#.2008，因为 C#.2005 现在已经过时了。

5.  现在我读到 MS 现在正在将它的力量放在 WPF/silverlight 后面。XNA 不支持 DX10，Vista 也不支持 DX9。

现在我有两个选择：

1.  回到 15 年前，用普通的 C/C++ 编写代码。至少 C 已经证明自己是永恒的。

2.  试试银光。

你有什么建议？还是我错过了什么？

更新：想补充一点，DX10 不向后兼容任何其他 DX 版本。SlimeDX 看起来很有前途。但作为一个非常新的包，我不确定文档和教程会有多大帮助。

Udpate 2：我使用的谷歌搜索XNA下载时出现的第一个下载链接似乎不是最新的。感谢 DouglasH 提供 v.3 的链接。正在下载它。可能它会起作用。

但随后阿吉安。我应该切换到 WPF/Silverlight 吗？还是选择 XNA？哪一个有更好的记录和未来的专业？

更多更新：Vista 确实没有预装 DirectX 9 [通过谷歌搜索检查]。至少去年我的机器上没有。谷歌搜索显示，从 MS 下载 DirectX 9 后，我必须在 Vista 上手动安装 DirectX 9。但是我的 attemet 失败了，因为 DX9/vista 的硬件驱动程序丢失或无法正常工作。我的想法是它没有得到很好的支持。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T09:36:49.760

MS 已停止支持 .net DirectX 库。[有一个名为SlimDX](http://slimdx.mdxinfo.com/)的开源替代方案，它运行良好。文档有一些不足之处，但可以通过使用 DirectX C++ 文档和一些常识来混淆。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T09:43:14.470

WPF 在 3D 方面做得很好，而且 WPF 有很多鱼眼面板和源代码，是的，因为 MS 已经远离他们的技术，在今天，我们不能只关注 MS 的一种技术来制作完整的业务应用。

当然，我们也厌倦了使用多种不同版本的技术，即使是做最小的部分，但我相信他们通过服务数十亿台机器做得很好，这确实不容易，但 WPF 和 .NET 似乎是微软最稳定的技术，而且他们也在花费大量资金来制作完全托管的操作系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-23T09:44:09.117

如果您曾经回到 C 或 C++，您可能需要查看 Simple DirectMedia Layer (SDL)。

恕我直言，它比 DirectX 容易得多。

网址：[http ://www.libsdl.org/](http://www.libsdl.org/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T09:45:22.610

DirectX 完全向后兼容。任何 DX9 应用程序都可以在 Vista 和 DX10 上运行。至于 XNA 和 VS2005 - 这有点奇怪。这将使 XNA 实际上毫无用处。检查你是否错过了什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T10:01:52.710

几点，你下载了哪个版本的XNA。这是将在 Visual Studio 2008 上运行的 XNA Studio 3.0 的链接。 [http://www.microsoft.com/downloads/details.aspx?FamilyId=7D70D6ED-1EDD-4852-9883-9A33C0AD8FEE&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=7D70D6ED-1EDD-4852-9883-9A33C0AD8FEE&displaylang=en)

第二，我当然希望Vista有Direct X 9，因为那是DWM在Vista上运行的direct X版本。我想您会在 Vista 中找到 Direct X 9 及之前版本的 DLL 以及 DirectX 10 的 DLL。或者对于这件事，Windows 7 也将具有 directX 11（编辑 2 请注意，DWM 是基于 DirectX10 构建的，具有用于没有 3d 视频硬件的系统的软件模拟器，用于具有 directx 9 卡的系统的 dx10ondx9 驱动程序和当然完全支持directx 10卡）。

编辑，

此外，如果您下载了 March directx sdk，您下载的是 directx 9.0c、directx 10、10.1 和 directX 11 的测试版。我将不得不检查 DirectX 8.x 是否仍然包括在内，尽管 DirectX 9 向后兼容该平台的大部分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T10:24:36.213

虽然我从未直接使用过 DirectX（很少使用 OpenGL）——但我会选择 WPF。实现起来最轻松（透明度、渐变、画笔、动画等），它提供了我亲眼所见和亲身经历的可靠性能。但是，是的，它不是独立于平台的。

# c# - 如何在 VS 2008 和 .NET 中使用跨越多个解决方案和项目的设置

> ID：780974
> 
> 赞同：3
> 
> 时间：2009-04-23T09:33:46.803
> 
> 标签：c#, .net, settings, projects

我不太确定 .NET 和 C# 3.5 如何处理跨越多个项目以及多个解决方案的应用程序设置。也许有人可以帮我把事情弄清楚。

我有 2 个解决方案，都包含多个项目。其中一些项目在 Properties 文件夹下包含一个*Setttings.settings*文件，其中包含此项目中源文件所需的特定配置变量。

就像是

1.  **JobManager 解决方案**
    *   Manager.Core（带有设置文件）
    *   Manager.UserInterface（带有设置文件）
    *   经理.分机
2.  **进口商解决方案**
    *   导入器（带有设置文件）
    *   服务（带有设置文件）

可以看出，`Manager.Core`包含它自己的配置文件来存储数据库连接信息和其他东西，而`Importer`包含它自己的配置文件存储到导入目录的路径，以知道从哪里获取它需要导入数据库的`Manager.Core`文件所以。（这就是 Manager.Core 的用途，它包含与数据库一起使用的所有查询和插入）

`Service`另一方面，它是一个 Windows 服务，它使用 Importer 并让它每隔一小时左右运行一次，包含它自己的错误日志记录路径的配置设置。

现在，当我编译 Service 时，只有一个名为*Service.exe.config*的配置文件，其中**仅**包含Service 项目中指定的配置参数。我的第一种方法是在*Service.exe.config*中复制 Manager.Core 和 Importer 的每个设置条目。但测试表明，不知何故，进口商的参数是存在和使用的。

*Service.exe.config*中不存在的设置`Manager.Core`和存储在哪里？`Importer`

 *现在的设置是否`Manager.Core`也意味着不需要在服务设置文件中复制这些配置设置的条目？

亲切的问候，迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-23T10:19:31.840

设置默认值通常生成到代码中，然后编译到生成的 dll 中

他们设置了“SettingsSingleFileGenerator”的 CustomTool 属性

对于名为 Foo.settings 的设置文件，其中包含单个值“MyName”，如果您查看了 dll反射器，您会在 Company.Properties 命名空间中找到一个类，如下所示：

```
[GeneratedCode(
"Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator"
,"9.0.0.0")] 
[CompilerGenerated]
internal sealed class Foo : ApplicationSettingsBase
{
    private static Settings defaultInstance = 
        ((Settings) SettingsBase.Synchronized(new Settings()));

    public static Settings Default
    {
        get { return defaultInstance; }
    }

    [ApplicationScopedSetting]
    [DefaultSettingValue("Shuggy")]
    [DebuggerNonUserCode]
    public string MyName
    {
        get
        {
            return (string) this["MyName"];
        }
    }
} 
```

这就是设置结构和默认值在与其相关的 dll 中持久保存的方式。实际值是从各种配置文件中读取的，具体取决于范围（可能还有应用程序决定进行的编程更改）

有关如何使用这些的更高级别的视图，请参阅[这篇文章](http://msdn.microsoft.com/en-us/library/aa730869(VS.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T09:45:01.410

没有使用这些，但您可以用解决方案中单个文件的链接替换它们吗？

# c# - 在 WPF 中处理 Content 属性

> ID：780977
> 
> 赞同：1
> 
> 时间：2009-04-23T09:34:01.387
> 
> 标签：c#, wpf, wpf-controls

我目前面临着巨大的问题，即我正在显示图像和图像中的一些文本问题是当我从代码更改按钮的内容属性时，我的图像消失并且只显示分配的文本，我想保留图像并且只是想更改文本，任何建议如何处理

```
<Button x:Name="btnPrescan" Margin="8" Grid.Column="2" Click="btnPrescan_Click">
    <StackPanel Orientation="Horizontal">
         <Image Source="Icons\Scan_Start_Icon.png" Height="14" Width="23"/>
         <TextBlock x:Name="tbButtonText"  Text="    Prescan"/>
    </StackPanel>
</Button> 
```

和按钮看起来像这样

![替代文字](https://lh6.ggpht.com/_M5W2QFQgto4/SfA09QAs2dI/AAAAAAAADTw/5nAY2qgUwtU/Button.jpg)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T09:48:33.257

将文本绑定到 UserControl 上的支持属性：

```
<Button x:Name="btnPrescan" Margin="8" Grid.Column="2" Click="btnPrescan_Click">
    <StackPanel Orientation="Horizontal">
         <Image Source="Icons\Scan_Start_Icon.png" Height="14" Width="23"/>
         <!-- assumes DataContext is set appropriately -->
         <TextBlock Text="{Binding ButtonText}"/>
    </StackPanel>
</Button> 
```

然后只需更改支持属性：

```
this.ButtonText = "New button text"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T09:39:23.777

你应该这样做，

```
((TextBlock)btnPrescan.GetTemplatedChild("tbButtonText")).Text = "Your Text" 
```

# java - Matlab / Java API回调

> ID：780981
> 
> 赞同：2
> 
> 时间：2009-04-23T09:35:08.420
> 
> 标签：java, matlab, anonymous-class

我正在设计一个 API（在 Java 中）并希望用户从 Matlab 访问 API。问题是我希望 API 提供如下功能：

```
javaApi.waitUntilPredicateIsTrue(Predicate<JavaObj> test); 
```

我的 API（在后台）获取`Java Obj`（通过某种机制，例如*轮询*）的实例。我希望此 API 方法阻塞，直到其中一个实例传递`Predicate`给`true`. 如果我从 Java 调用这个 API，我会这样做：

```
javaApi.waitUntilPredicateIsTrue(new Predicate<JavaObj>() {
    public boolean evaluate(JavaObj jo) {
        return "READY".equals(jo.getState());
    }
}); 
```

你明白了。

**如何从 Matlab 中调用它？**我可以使用 Matlab 中的匿名内部类吗？我可以声明一个`classdef`扩展接口的 Matlab `Predicate`（这可以处理 Java 通用版本）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T14:24:10.257

这听起来是个棘手的问题。我仍在运行 R2006b，所以这可能已经改变，但看起来 MATLAB 不会将函数句柄（包括匿名函数）和结构转换为 Java 对象。我不知道 MATLAB 自定义类，因为语法已经改变。字符串、数组和元胞数组[将正确翻译](http://www.mathworks.com/access/helpdesk/help/techdoc/matlab_external/f6425.html)。他们根本不评论实现接口。(:p :p :p 嘘嘘)

[编辑：刚刚在Matlab Central](http://www.mathworks.com/matlabcentral/newsreader/view_thread/239803)上找到了这个页面，它谈到了一些未记录的接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T11:37:48.003

Matlab 有一个比强迫用户创建一个完整的类来提供一个方法更好的解决方案。看看他们的[匿名函数](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/matlab_prog/f4-70115.html)。

请注意，Matlab 中的匿名函数有奇怪的范围规则。确保您阅读了链接帮助页面的“表达式中使用的变量”部分。如果您想要更传统的词法作用域，请查看[嵌套函数](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/matlab_prog/f4-70115.html)。

**编辑：** 我假设您将从 Matlab 进行轮询，而不是将谓词函数传递给 Java。例子：

```
function waitForPredicate(pred)
  while pred
  end
end

waitForPredicate(@()javaApi.isMyConditionMet()); 
```

# vb.net - 从 sqlclient 连接访问 .UDL 文件

> ID：780982
> 
> 赞同：0
> 
> 时间：2009-04-23T09:35:31.137
> 
> 标签：vb.net, .net-2.0

我有一个 .udl 文件，其中包含以下连接字符串

```
[oledb]
; Everything after this line is an OLE DB initstring
Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;Initial
Catalog=Client_DB050208;Data Source=IAEADB\IAEADBDEV;;Network Library=dbmssocn 
```

现在我试图从语句中访问这个 .udl 文件

```
sConnectStr = "D:\PROBIS\ABC.udl" from one of my .vb class 
```

**注意**：我需要使用`SqlClient.SqlConnection`.

所以我可以`.udl`从`SqlClient.sqlConnection`.

请回到这个问题

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T09:38:27.697

看来您可以在 OLDEBConnection 而不是 SQL Connection 中获得此信息。看[这里](http://www.dotnet247.com/247reference/msgs/7/38045.aspx)

有点道理。否则只需解析文件。

# user-interface - 复选框与两个单选按钮 - 哪个更有用？

> ID：780989
> 
> 赞同：9
> 
> 时间：2009-04-23T09:37:25.513
> 
> 标签：user-interface

我目前正在处理一些设置屏幕，其中大部分包含一个 2 列表单，左侧是偏好问题，右侧是表单元素。

这些问题是这样的：

> 可以添加/编辑其他用户吗？
> 
> 可以删除客户端吗？

显然，这个设置是一个*二进制*设置，大多数 UI“专家”会坚持认为复选框是要使用的适当表单元素。

但是，当我用复选框模拟表单时，它看起来不友好，并且似乎很难将复选框的状态与问题联系起来。

我将表单更改为使用两个单选按钮：

> *   是 o 否

就我个人而言，我觉得这更容易处理，因为这些选项实际上是对左边提出的问题的答案。

就点击而言，它对用户没有任何影响，每次只需单击一下即可更改设置。

您如何看待单选按钮的这种用法？这比复选框好还是坏，为什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-23T09:42:17.453

对于“Can do X”之类的东西，我会使用复选框而不是收音机，因为 Can Do/Can't Do 与复选框的 On-Off 特性密切相关。大多数用户都理解勾号映射为是，无勾号映射为否。

但是，对于某些选项不明确或它们与开/关的关系不明显的二元选项，单选机可能有意义。例如，您可以拥有“二进制文件？” 后面跟着一个复选框，但我认为在这种情况下，“文件格式”后跟“二进制”和“文本”选项会更清楚。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T09:55:10.697

我们对年龄较大的客户群有过经验，他们比复选框更了解“是”/“否”单选按钮。我们被迫删除复选框并在各处放置单选按钮。它更适合非 IT 精通的人。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-03-29T22:56:51.667

我最近一直在研究这个以设计一个 PHP 表单类。正如您所注意到的，标准答案是应该使用复选框，我什至看到有些人主张在使用无线电的地方应该给出默认值。

我不可能再不同意了。考虑当用户遇到文本输入时，比如输入他们的用户名。如果他们提交表单时没有填写此字段，并且需要该字段，我们知道生成的空字符串是错误输入。也许用户错过了该字段或没有意识到这是必要的。我们触发一个错误并要求他们输入丢失的数据。

现在考虑相同的场景，但带有一个复选框。如果用户错过了复选框，那么我们不知道他们的输入是有意的还是无意的。对于具有默认设置的收音机也是如此。

因此，我强烈建议表单根本不应该包含默认值。如果一条信息足够重要，可以从用户那里获取，那么它就足够重要，可以正确获取。无论是通过一个复选框还是一组选中的无线电来提供默认值，都会牺牲大量的准确性来获得少量的可用性。因此，我认为使用是/否无线电远远优于复选框。

在我看来，复选框唯一有效的地方是您有一小部分选项，用户可以选择多个选项。但是，如果集合很大，则应使用 select（没有空白默认选项）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-04-27T02:44:12.360

我的感觉是应该在答案只能是“是”或“否”的情况下使用复选框 - 没有别的，例如你想注册吗？

还有其他选项的单选按钮。例如，您是否想要 oPlain text oHTML 的时事通讯 - 没有默认值

另一个考虑是在您希望用户做出有意识的决定时使用单选按钮。正如其他答案之一所说，如果它足够重要，那么它可能足够重要以得到准确。

我唯一使用复选框的情况是答案是“是”还是“否”，并且如果选中的复选框将启用用户需要填写的其他字段，以及完成该过程的可选/非必要信息，例如您是否要授权其他人访问您的帐户 [ ]。然后，这将启用名称、地址等字段。我要问的一件事是“如果用户将此作为默认选项（通常为否），它是否会产生重大影响，并且之后是否可以轻松更改”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T09:53:17.643

我同意复选框具有更多隐含的“真”/“假”含义，另一点是对于单选按钮，您可以通过不选择任何选项来强制用户做出主动选择。因此，对于重要的字段，使用单选按钮可能是一个更好的主意，这样用户就不会意外错过它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T09:43:57.807

如果答案总是是/否，我认为单选按钮会使 GUI 混乱。单选按钮还可以使使用键盘设置选项更加困难。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T09:46:08.130

这取决于上下文和目标受众：您的目标是尽量减少回答它所需的思维过程。

例如，如果它是一份问卷调查，您可能会想用完整的句子提问。选项屏幕将针对扫描阅读（因此允许/拒绝而不是是/否），而工具栏（经常设置/取消设置）将使用切换。无论如何，我会在一致性方面犯错。

对于权限，通常使用 Permissions 标题，并带有*Edit users*复选框。如果已启用，您甚至可以突出显示该权限。这有助于键盘用户只需要按一次制表符而不是两次。只需确保复选框的单击区域足够大。

在任何一种情况下，都不推荐使用两列形式，因为它使目标与描述相距太远。它还鼓励诸如“允许完全控制或仅部分控制（是/否）”之类的问题。如何使用从绿色变为红色的行并显示勾号/十字？这可以通过网络友好的方式完成。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T09:52:31.500

您是否尝试过仅使用标有“可以添加/编辑其他用户”的复选框而没有左侧的问题？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-23T09:43:06.483

从用户体验的角度来看，我会说复选框代表真/假，即；Quest 是 Do you Want XXX，用常用的说法表示是），但对于选择，我更喜欢收音机（例如 A 或 B）。还有其他隐喻，例如推入/弹出按钮。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-27T14:43:58.080

我发现单选按钮真的很难支持或记录。

你可以告诉人们勾选复选框，这对他们来说有点道理。

但是“单选按钮”没有什么意义，而“blob最适用的选项”只是一句废话。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-08-29T11:15:50.607

就我而言，因为我们需要明确的答案，明确的是或否，我使用复选框来表示是和否：

```
Yes [ ]     No [ ] 
```

好处是表格在纸上也有效（有时需要传真/签名）。我想您也可以将单选按钮设置为复选框！

# php - PHP Gd 旋转图像

> ID：780993
> 
> 赞同：2
> 
> 时间：2009-04-23T09:39:20.860
> 
> 标签：php, gd

你好，

我试图围绕中心旋转一个圆形图像，然后切掉侧面。我看到了 imagerotate 功能，但它似乎没有围绕中心旋转。

有人有什么建议吗？

谢谢你。

更新：由于它是一个圆圈，我想切断边缘并保持我的圆圈尺寸相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-12-05T00:13:56.443

我用下面的代码成功地遇到了这个问题

```
 $width_before = imagesx($img1);
    $height_before = imagesy($img1);
    $img1 = imagerotate($img1, $angle, $mycolor);

    //but imagerotate scales, so we clip to the original size

    $img2 = @imagecreatetruecolor($width_before, $height_before);
    $new_width = imagesx($img1); // whese dimensions are
    $new_height = imagesy($img1);// the scaled ones (by imagerotate)
    imagecopyresampled(
        $img2, $img1,
        0, 0,
        ($new_width-$width_before)/2,
        ($new_height-$height_before)/2,
        $width_before,
        $height_before,
        $width_before,
        $height_before
    );
    $img1 = $img2;
    // now img1 is center rotated and maintains original size 
```

希望能帮助到你。

再见

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T09:46:06.757

[文档](http://uk3.php.net/manual/en/function.imagerotate.php)说它*确实*围绕中心旋转。

不幸的是，它还说它将缩放图像以使其仍然适合。这意味着无论你做什么这个函数都会改变你内部圆形图像的大小。

您可以（相对容易地）计算缩小多少，然后预先适当地放大图像。

如果你有[可用](http://uk3.php.net/manual/en/function.imagick-rotateimage.php)的 PHP“ImageMagick”函数，你可以使用它们——它们显然不会缩放图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T09:43:04.283

根据 PHP 手册[imagerotate()](http://www.php.net/imagerotate())页面：

> 旋转中心是图像的中心，旋转后的图像会按比例缩小，以便整个旋转后的图像适合目标图像 - 边缘不会被剪裁。

也许图像的可见中心不是实际中心？

# javascript - setTimeout 但在给定时间

> ID：780995
> 
> 赞同：15
> 
> 时间：2009-04-23T09:40:15.367
> 
> 标签：javascript, datetime, settimeout

JavaScript中是否有任何现成的东西（即不是通过“插件”）允许我做类似的事情`setTimeout`，但不是说应该在多少毫秒内发生某事，而是给它一个日期对象告诉它什么时候做某事？

```
setToHappen(function () {
    alert('Wake up!');
}, new Date("...")); 
```

是的，我知道我可以通过简单地减去`new Date()`我现有的日期对象（或者可能是相反的方式）来获得毫秒数，但我仍然想知道。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-23T09:46:05.353

您必须计算从现在到您的日期对象之间的毫秒数：

```
function setToHappen(fn, date){
    return setTimeout(fn, date - Date.now());
} 
```

**注意**请注意[@calvin 的回答](https://stackoverflow.com/a/781079/1582182)：如果毫秒数大于`2147483647`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-23T09:44:57.087

不，但您可以轻松编写自己的函数。只需计算现在与给定时刻之间的差异（以毫秒为单位），然后调用 setTimeout 即可。

像这样的东西：

```
 setToHappen = function(fn, date){
  var now = new Date().getTime();
  var diff = date.getTime() - now;
  return setTimeout(fn, diff);
 } 
```

编辑：删除了 1000 的额外乘法，感谢克里斯指出这一点！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-23T10:04:52.890

由于人们正在谈论使用`date`对象计算超时间隔，因此应该注意间隔参数可接受[的最大值`setTimeout()`是 2147483647 (2^31 - 1)](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout#maximum_delay_value)，因为`PRIntervalTime`它是带符号的 32 位整数。结果不到25天。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-09-06T08:55:42.620

您可以简单地`Date.now()`从日期中减去

```
const myDate = new Date('...');
setTimeout(func, myDate - Date.now()); 
```

# iphone - iPhone 上的 MPMoviePlayerController 替代品？

> ID：780999
> 
> 赞同：7
> 
> 时间：2009-04-23T09:41:25.753
> 
> 标签：iphone, mpmovieplayercontroller, movie

我正在寻找 iPhone 上 MPMoviePlayerController 的替代品。作为视频播放器，它的功能非常有限。例如，根据[类参考](http://developer.apple.com/iphone/library/documentation/MediaPlayer/Reference/MPMoviePlayerController_Class/MPMoviePlayerController/MPMoviePlayerController.html)，无法获取当前播放时间或设置新时间。它只是播放和停止。

是否有任何提供更多功能的 iPhone 视频播放中间件解决方案？CRI[有一些东西正在开发中](http://www.cri-mw.co.jp/product/lineup/movie/i-sofdec_e/index.html)，但尚未发布。我无法找到其他任何东西。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-17T23:35:36.717

请记住，即使项目是 GPL，这并不意味着您无法就底层代码的 LGPL 选项联系作者。

如果您需要处理特定的视频类型，您自己的解决方案可能是使用 openGL 作为视频的合成表面，并获得像 ffmpeg 这样的幕后库。

NeHe 有一个将 AVI 渲染到 openGL 的示例：http: [//nehe.gamedev.net/data/lessons/lesson.asp ?lesson=35](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=35)

FFMpeg 最近被移植到 iPhone 上，是一个基于 LGPL 的产品： [http ://geek.thinkunique.org/2008/03/05/ffmpeg-on-the-iphone/](http://geek.thinkunique.org/2008/03/05/ffmpeg-on-the-iphone/)

（注意：关于 LGPL 在 iPhone 上的商业用途存在一些争议，因为许可证在提及库链接时引用了“动态”一词，这是 iPhone 不允许的。我没有看到任何项目团队对正在使用的代码犹豫不决在 iPhone 上是静态的，但你应该直接联系作者以获得澄清。）

另一个（虽然是 GPL）版本的 OpenGL 视频播放器是：[http ://code.google.com/p/glover/](http://code.google.com/p/glover/)

您通过这样的解决方案获得的基本上是绕过 iPhone/Mac/CALayer 特定技术细节，并通过 OpenGL 利用现有的视频知识库，虽然不广泛，但仍然得到广泛支持。

如果您正在处理特定的视频风格，那么您可能想查看是否可以直接从供应商处获得特定视频格式的库，而不是使用诸如 FFMpeg 之类的多功能工具。一旦你有合成工作，视频可以来自大多数任何图书馆。

巴尼

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-17T07:38:37.530

你可以使用`AVPlayer`. 请参阅[文档](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVPlayer_Class/Reference/Reference.html#//apple_ref/occ/cl/AVPlayer)

然后，您可以使用 获取当前播放时间`currentTime`并使用 查找指定时间`seekToTime:`。

`AVPlayer`您必须将实例的视觉输出定向到`AVPlayerLayer`对象（的子类`CALayer`）。请参阅[此处的第一个列表](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVPlayerLayer_Class/Reference/Reference.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T12:05:31.633

VLC 已[移植到 iPhone](http://www.modmyi.com/forums/iphone-news/182421-vlc-iphone.html)但未使用官方 SDK。**********`**