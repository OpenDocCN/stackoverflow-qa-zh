# StackOverflow 问答 10728000-10728999

# php - 如何在 MYSQL 中查询每年的每个月？

> ID：10728000
> 
> 赞同：-1
> 
> 时间：2012-05-23T21:18:27.960
> 
> 标签：php, mysql

我需要进行一个查询，以获取与每年每个月对应的月份的字段

像这样的东西：

```
                      字段 1 字段 2

       count_of_fields_that_corresponds_this_month，same_fields_but_with_value_true
       --------------------------------------------|------ --------------------------
一月 |
       --------------------------------------------|------ --------------------------
二月 |
       --------------------------------------------|------ --------------------------
三月 |
       --------------------------------------------|------ --------------------------
四月 |
       --------------------------------------------|------ --------------------------
等等... |

```

在此示例中，我有 2 个字段需要填写表格，但实际上我还有更多字段，但我不知道如何在一个查询中获取每个月的字段，我试图做同样的事情但是有很多疑问，我认为这是一种不好的做法，所以你能建议我怎么做吗？或者我需要在mysql中使用什么功能？

我想每个月取field1、field2、field3等，如果可能的话每年也可以，非常感谢。

```
$this->db->query("SELECT count(*) AS count FROM `simple` WHERE `ochistka` = 'somevalue' AND MONTH(`date`) = 01");
$this->db->query("SELECT count(*) AS count FROM `simple` WHERE `ochistka` = 'somevalue' AND MONTH(`date`) = 01 AND `prime4anie` = 'somevalue'"); 
```

所以在这个查询中我得到了那些字段，但只有一个月，我怎样才能改进它并让他们一次查询每个月（查询）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:22:10.467

```
SELECT YEAR(datefield), MONTH(datefield), COUNT(field1), COUNT(field2)
FROM table
GROUP BY YEAR(datefield), MONTH(datefield) 
```

把你自己的字段和表名

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:26:34.660

删除查询的月份部分，您将获得一组结果。然后，您可以通过调用添加组以对其进行排序。

```
SELECT count(*) AS count FROM `simple` WHERE `ochistka` = 'somevalue' GROUP BY MONTH 
```

# c# - 如何读取设置文件创建的连接字符串？

> ID：10728003
> 
> 赞同：0
> 
> 时间：2012-05-23T21:18:32.837
> 
> 标签：c#, config, windows-console

当我刚刚有一个 app.config 时，每次我尝试 ConfigurationManager.AppSettings[0] 或 ConfigurationManager.AppSettings["keyName"] 时，我都会得到一个空值。所以我尝试使用一个 *.settings 文件，它为我创建了一个看起来像这样的 app.config

```
<configuration>
  <configSections>
    <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
      <section name="IndexLoader.IndexLoader" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
    </sectionGroup>
  </configSections>
  <applicationSettings>
    <IndexLoader.IndexLoader>
      <setting name="ConnectionString" serializeAs="String">
        <value>INITIAL CATALOG=xxx;DATA SOURCE=xxx;User ID=xxx;Password=xxx;Application Name=xxx;</value>
      </setting>
    </IndexLoader.IndexLoader>
  </applicationSettings>
</configuration> 
```

现在如何使用 C# 读取此连接字符串？

该解决方案有多个项目，其中许多都有配置文件。有没有办法指定我希望使用代码项目中的配置文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T21:36:06.260

`applicationSettings`不是`appSettings`。要阅读您使用的 applicationSettings 中的条目

```
string myCnStr = Properties.Settings.Default.ConnectionString; 
```

在你的情况下，它将是

```
string myCnStr =IndexLoader.IndexLoader.Default.ConnectionString; 
```

但是 ConnectionString 在 app.config 中有一个专用部分，应该存储在那里并从 ConfigurationManager.ConnectionStrings 集合中读取

[请参阅此处](http://msdn.microsoft.com/en-us/library/ms254494.aspx)以获取参考

# ruby-on-rails - 简单的 OmniAuth-Twitter 由于验证而无法创建新用户

> ID：10728005
> 
> 赞同：0
> 
> 时间：2012-05-23T21:18:40.063
> 
> 标签：ruby-on-rails, ruby-on-rails-3, omniauth, twitter-oauth

我大致遵循 Railscasts Simple OmniAuth [http://railscasts.com/episodes/241-simple-omniauth](http://railscasts.com/episodes/241-simple-omniauth)来创建我的 Twitter 登录。当我尝试通过 twitter 登录并创建新用户时，我收到以下消息：

```
Validation failed: Password can't be blank, Name is not valid., Email can't be blank, Email is not valid. 
```

如果我点击刷新按钮，我会收到以下错误：

```
OAuth::Unauthorized 401 Unauthorized 
```

我已经将我的回调 URL 设置为，`http://127.0.0.1:3000/auth/twitter/callback`但我仍然收到该消息。我正在本地主机上进行测试。

我按照 Hartl 的 railstutorial [http://ruby.railstutorial.org/ruby-on-rails-tutorial-book](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)为我的用户建模，我的网站项目要求用户填写这些字段。

与 railscast 不同，我创建了一种新方法来处理omniauth 登录：

session_controller.rb

```
def omniauth_create
  auth = request.env["omniauth.auth"]
  user = User.find_by_provider_and_uid(auth["provider"], auth["uid"]) || 
         User.create_with_omniauth(auth)
  session[:user_id] = user.id
  redirect_to user
end 
```

用户.rb

```
def self.create_with_omniauth(auth)
  create! do |user|
    user.provider = auth["provider"]
    user.uid = auth["uid"]
    user.name = auth["info"]["name"]
  end
end 
```

**问题：如何绕过验证？**

到目前为止，我已经尝试过使用`skip_before_filter :authenticate, :only => [:omniauth_create]`，但没有奏效。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:31:41.147

有两种方法可以跳过验证。您可以通过传递给 create 方法（通常是一个坏主意）来跳过它们`:validate => false`，或者您可以将验证修改为如下所示：

用户.rb

```
validates_confirmation_of :password, :if => :password_required?

def password_required?
  !provider.blank? && super
end 
```

# xcode - 目标数量的实际上限

> ID：10728009
> 
> 赞同：0
> 
> 时间：2012-05-23T21:18:55.430
> 
> 标签：xcode, ios5, ios4

我的应用程序有大约 200 个类，我需要在基本应用程序上制作大量（50 多个）变体，仅相差约 10 个图像和几个标题。因此，我将为每个变体创建 2 个额外的目标（开发/发布）。

有没有人有这么多目标的经验？Xcode 4.3 可以处理这个问题（它每天都会崩溃......）是否有管理这些目标的特定策略，或者是否有更好的方法来管理这么多变体？TIA，迈克

# mysql - mysql - 单字段数组或多行

> ID：10728010
> 
> 赞同：1
> 
> 时间：2012-05-23T21:19:07.223
> 
> 标签：mysql, performance

作为这个问题的序言，我应该说我对数据库效率知之甚少，这很快就会变得显而易见。

这是一个相当简单的问题：

我想在 mysql 数据库中存储对事件的出席。我想到了两种可能的方法（我敢肯定还有更多）：

1.  在表中创建一个附加`attendance`行`events`，其中包含一个逗号分隔的用户 ID 列表
2.  创建一个`attendance`包含两列的表，`event_id`然后`user_id`

我的直觉说方法 2 将是最有效的——尽管必须返回和遍历多行，但这可能比在`user_id`连接字符串中搜索特定的成本更低......

谁能证实这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:22:30.747

创建一个新表！

否则，您没有利用 MySQL 的关系方面，并且您运行的每个查询都必须解析 csv 条目的结果（非常低效）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:27:09.590

第二种选择更好。在逗号分隔的字符串中搜索非常耗时。

但是，在第二个选项中，请确保 the`event_id`和 the `user_id`are `FOREIGN KEYS`。

这将`INDEX`列，您将获得更好的搜索结果。

# blackberry-webworks - BlackBerry Webwork App 关闭设备

> ID：10728012
> 
> 赞同：1
> 
> 时间：2012-05-23T21:19:21.310
> 
> 标签：blackberry-webworks

我开发了一个 Webwork/HTML5 应用程序，并在 Ripley Simultar 以及几个 BB OS5 和 BB OS6 模拟器上对其进行了测试。

现在我想在真正的 BB OS5 设备上测试它，我签署了应用程序并通过 OTAInstall (.jad) 安装。

当我运行该应用程序时，有时它会关闭我的 BB，我必须再次打开它。

任何想法为什么会发生？

我已经在BB论坛上问过，但没有得到任何回应。

# android - 用于 Honeycomb 和 ICS 的 Android ListView 拖放“错误：报告放置结果：false”

> ID：10728013
> 
> 赞同：5
> 
> 时间：2012-05-23T21:19:34.250
> 
> 标签：android, drag-and-drop, android-listview

我一直在尝试创建一个可以使用拖放进行排序的 ListView。

我已尝试遵循此处的 Android 指南[以及](http://code.google.com/p/myandroidwidgets/source/browse/trunk/HCDragDrop/)[此处](http://developer.android.com/guide/topics/ui/drag-drop.html)的 Git 上提供的一些源代码。此外，我不想使用音乐应用程序示例，因为我正在尝试使用 Honeycomb 及更高版本中提供的新工具。

到目前为止，我已经成功创建了列表，并且可以拖动项目。不幸的是，当我将项目放到列表中时，我收到以下错误：

“I/ViewRoot(22739)：报告丢弃结果：假”。

我怀疑我的 drop listener 没有在正确的项目上创建，因此 drop 永远不会被调用。这是一些源代码，非常感谢您的帮助。

列表的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/dropTarget"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
     android:layout_weight="1">
    <ListView
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id="@android:id/list" >
    </ListView>
</LinearLayout> 
```

我的 listView：我还不能进入“ACTION_DROP”事件，因此代码没有经过测试。只是我正在做的事情。我的主要问题是我永远不会进入 ACTION_DROP。

```
public class procedureListView extends ListActivity {
    private ListView mListView = null;
    private ArrayAdapter<String> mArrayAdapter = null;
    private View layoutDropArea = null;

    public void onCreate(Bundle savedInstanceState) {
          super.onCreate(savedInstanceState);
          setContentView(R.layout.list);

          String[] countries = getResources().getStringArray(R.array.arrayOfStuff);
          mArrayAdapter = new ArrayAdapter<String>(this, R.layout.list_item, countries);
          setListAdapter(mArrayAdapter);

          mListView = getListView();
          mListView.setTextFilterEnabled(true);

          layoutDropArea = findViewById(R.id.dropTarget);

          setupDragDrop();
    }
    /**
     * Setup what to do when we drag list items
     */
    public void setupDragDrop(){
        mListView.setOnItemLongClickListener(new OnItemLongClickListener() {
            public boolean onItemLongClick(AdapterView<?> arg0, View v, int position, long arg3){
                String value = (String) ((TextView) v).getText();
                ClipData data = ClipData.newPlainText("procedure", value);
                v.startDrag(data, new mDragShadowBuilder(v), null, 0);          
                return true;
            }
        });
        myDragListener mDragListener = new myDragListener();
        //mListView.setOnDragListener(mDragListener);

        layoutDropArea.setOnDragListener(mDragListener);

    }
    protected class myDragListener implements OnDragListener{

        public boolean onDrag(View v, DragEvent event) {
            final int action = event.getAction();
            switch (action) {
                case DragEvent.ACTION_DRAG_ENTERED:
                    v.setBackgroundColor(Color.GRAY);
                    break;
                case DragEvent.ACTION_DRAG_EXITED:
                    v.setBackgroundColor(Color.TRANSPARENT);
                    break;
                case DragEvent.ACTION_DRAG_STARTED:
                    break;
                case DragEvent.ACTION_DRAG_LOCATION:
                    v.setVisibility(View.VISIBLE);
                // return processDragStarted(event);
                case DragEvent.ACTION_DROP:
                    v.setBackgroundColor(Color.TRANSPARENT);
                    int newPosition = mListView.getPositionForView(v);
                    if (newPosition != ListView.INVALID_POSITION)
                        return processDrop(event, newPosition);
                    else
                        return false;
            }
            return false;
        }

    }

    private boolean processDrop(DragEvent event, int newPosition) {
        ClipData data = event.getClipData();
        if (data != null) {
            if (data.getItemCount() > 0) {
                Item item = data.getItemAt(0);
                String value = item.toString();
                updateViewsAfterDropComplete(value, newPosition);
                return true;
            }
        }
        return false;
    }
    private void updateViewsAfterDropComplete(String listItem, int index) {
        Log.d("InsertItem", "Position: "+ index);
        mArrayAdapter.insert(listItem, index);
        mArrayAdapter.notifyDataSetChanged();
    }
    private boolean processDragStarted(DragEvent event) {
        ClipDescription clipDesc = event.getClipDescription();
        if (clipDesc != null) {
            return clipDesc.hasMimeType(ClipDescription.MIMETYPE_TEXT_PLAIN);
        }
        return false;
    }
} 
```

非常感谢你的帮助！

更新：

我不太明白为什么。但是，当我将 switch case 更改为此时，它似乎起作用了：

```
switch (action) {
                case DragEvent.ACTION_DRAG_ENTERED:
                    //v.setBackgroundColor(Color.GRAY);
                    return false;

                case DragEvent.ACTION_DRAG_EXITED:
                    //v.setBackgroundColor(Color.TRANSPARENT);
                    return true;

                case DragEvent.ACTION_DRAG_STARTED:
                    return true;

                case DragEvent.ACTION_DRAG_LOCATION:
                    //v.setVisibility(View.VISIBLE);
                    return false;
                // return processDragStarted(event);
                case DragEvent.ACTION_DROP:
                    v.setBackgroundColor(Color.TRANSPARENT);
                    int newPosition = mListView.pointToPosition((int)(event.getX()),(int) event.getY());
                    Log.d("Position", Integer.toString(newPosition));
                    if (newPosition != ListView.INVALID_POSITION)
                        return processDrop(event, newPosition);
                    else
                        return false;
                default:
                    return true;

            } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T23:36:30.773

您的更新解决了该问题，因为您必须`true`从`onDrag`获取时返回`DragEvent.ACTION_DRAG_STARTED`才能继续接收到该侦听器的拖动事件。在您的更新中，您`true`针对这种情况返回，因此您继续接收拖动事件并且放置逻辑正常工作。

如果您不返回`true`该`DragEvent.ACTION_DRAG_STARTED`案例，您的侦听器将不会收到任何其他事件，除了`DragEvent.ACTION_DRAG_ENDED`.

# java - 对 ArrayList 进行排序 按字典顺序？

> ID：10728015
> 
> 赞同：3
> 
> 时间：2012-05-23T21:19:48.470
> 
> 标签：java, sorting, collections, arraylist

我想对具有节点类型的 ArrayList 进行排序，如下所示：

```
 [[country1: null], [name2: null], [city3: null], [region4: null], [name6: null]] 
```

要获取节点名称的值，我使用函数 getNodeName() 所以

```
 ArrayNode.get(0).getNodeName()  // return country1 
```

我正在研究 **collection.sort**，但我不知道我会怎么做，提前谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:21:53.560

我想你想要 java.util.Comparator。您可以将其与 Collections.sort 一起使用

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T21:21:54.660

创建一个`Comparator`按节点名称排序的，然后`Collections.sort(list,comparator)`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T21:29:12.270

使用[Comparator](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)对象定义比较逻辑。

像这样的东西：

```
ArrayList<Node> nodes;
        Collections.sort(nodes, new Comparator<Node>() {
            @Override
            public int compare(Node o1, Node o2) {
                return o1.getNodeName().compareTo(o2.getNodeName());
            }
        }); 
```

# android - Android：更新后重新启动应用程序 - ACTION_PACKAGE_REPLACED

> ID：10728016
> 
> 赞同：26
> 
> 时间：2012-05-23T21:19:51.793
> 
> 标签：android, broadcast

我不在 Play 商店中的应用程序在网络上验证是否有新版本并下载并启动它。安装后我想重新启动应用程序，我会使用`BroadcastRecevier`with `ACTION_PACKAGE_REPLACED`。这是代码：

**播送：**

```
public void onReceive(Context context, Intent intent) {
  if(intent.getAction().equals(Intent.ACTION_PACKAGE_REPLACED)){
    ApplicationInfo app = new ApplicationInfo();
    if(app.packageName.equals("it.android.downloadapk")){
      Intent LaunchIntent = context.getPackageManager().getLaunchIntentForPackage(app.packageName);
      context.startActivity(LaunchIntent);                    
    }
  }
} 
```

**显现：**

```
<receiver android:name="it.android.downloadapk.Broadcast">
  <intent-filter>
    <action android:name="android.intent.action.ACTION_PACKAGE_REPLACED"></action>
    <data android:scheme="package" android:path="it.android.downloadapk" /> 
  </intent-filter>
</receiver> 
```

问题是当我安装新的apk时，广播似乎没有开始，为什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-23T22:23:57.023

看到这个：

[如何知道我的 Android 应用程序已升级以重置警报？](https://stackoverflow.com/questions/2133986/how-to-know-my-android-application-has-been-upgraded-in-order-to-reset-an-alarm)

正确的解决方法是您在清单中使用了错误的字符串：http: [//developer.android.com/reference/android/content/Intent.html#ACTION_PACKAGE_REPLACED](http://developer.android.com/reference/android/content/Intent.html#ACTION_PACKAGE_REPLACED)

它应该是“android.intent.action.PACKAGE_REPLACED”。

* * *

好的，我看到我写的内容仍然不足以尝试，所以我将破例并发布整个项目以证明它有效：应用程序代码位于名为“com.broadcast_receiver_test”的包中。不要忘记在测试之前运行它，否则它将无法在某些 android 版本上运行（我认为 API 11+）。

显现：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.broadcast_receiver_test" android:versionCode="1"
  android:versionName="1.0">
  <uses-sdk android:minSdkVersion="3" />

  <application android:icon="@drawable/ic_launcher"
    android:label="@string/app_name">

    <activity android:name=".BroadcastReceiverTestActivity"
      android:label="@string/app_name">
      <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
      </intent-filter>
    </activity>

    <receiver android:name=".MyBroadcastReceiver">
      <intent-filter>
        <action android:name="android.intent.action.PACKAGE_REPLACED"/>
        <data android:scheme="package"  />
      </intent-filter>

      <intent-filter>
        <action android:name="android.intent.action.PACKAGE_REMOVED"/>
        <data android:scheme="package"  />
      </intent-filter>

      <intent-filter>
        <action android:name="android.intent.action.PACKAGE_ADDED"/>
        <data android:scheme="package"  />
      </intent-filter>
    </receiver>

  </application>
</manifest> 
```

MyBroadcastReceiver.java：

```
public class MyBroadcastReceiver extends BroadcastReceiver
  {
  @Override
  public void onReceive(final Context context,final Intent intent)
    {
    final String msg="intent:"+intent+" action:"+intent.getAction();
    Log.d("DEBUG",msg);
    Toast.makeText(context,msg,Toast.LENGTH_SHORT).show();
    }
  } 
```

请运行它，看看它是否完美运行。

* * *

编辑：如果您的应用程序适用于 API12 及更高版本，并且只希望处理更新您的应用程序的情况，您可以单独使用此意图：

[http://developer.android.com/reference/android/content/Intent.html#ACTION_MY_PACKAGE_REPLACED](http://developer.android.com/reference/android/content/Intent.html#ACTION_MY_PACKAGE_REPLACED)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-03-01T00:31:31.267

我将以下接收器放在 AndroidManifest.xml 中

```
<receiver android:name=".StartupReceiver">
    <intent-filter>
        <action android:name="android.intent.action.BOOT_COMPLETED"/>
    </intent-filter>
    <intent-filter>
        <action android:name="android.intent.action.MY_PACKAGE_REPLACED"/>
    </intent-filter>
</receiver> 
```

所以我的应用程序可以在更新和设备重启时启动。当然，正如每个人都提到的，MY_PACKAGE_REPLACED 需要 API 12+。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-03T07:42:09.867

经过数小时搜索如何在更新后重新启动您的应用程序后，我终于找到了为什么它不会重新启动。

该应用不得**由**Android Studio 或其他 IDE 启动。如果我使用其 apk 手动安装应用程序并从当前的 Android 设备启动它，该应用程序可以识别我的应用程序是否有更新并正确重新启动。

我的用户案例是一个自定义启动器，它可以自行更新`PackageInstaller.Session`而无需去 Google Play 商店

这是代码

显现：

```
<receiver android:name="UpdateReceiver" >
     <intent-filter>
         <action android:name="android.intent.action.MY_PACKAGE_REPLACED"/>
     </intent-filter>
</receiver> 
```

UpdateReceiver（Kotlin 代码）：

```
class UpdateReceiver: BroadcastReceiver() {

    companion object {
        private val TAG = UpdateReceiver::class.java.simpleName
    }

    override fun onReceive(context: Context?, intent: Intent?) {
        Log.d(TAG, "onReceive ${intent?.action ?: "unknown action"}")
        if (intent?.action == Intent.ACTION_MY_PACKAGE_REPLACED) {

            //MainActivity = Your first activity
            val yourIntent = Intent(context, MainActivity::class.java)
            yourIntent.flags = Intent.FLAG_ACTIVITY_NEW_TASK
            context?.startActivity(yourIntent)
        }

    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-13T22:40:33.803

经过两天的奋斗和实验，我找到了原因。原来我需要仔细阅读官方文档。

正如这里所说： [https ://developer.android.com/reference/android/content/Intent#ACTION_MY_PACKAGE_REPLACED](https://developer.android.com/reference/android/content/Intent#ACTION_MY_PACKAGE_REPLACED)

原来，关键短语是： **它不包含任何额外的数据**

那些。如果您更改了清单，那么应用程序将不会在更新后重新启动

不客气

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-11T20:58:14.543

对于尝试所有其他答案但没有成功的人，我建议您重新启动应用程序。

我注意到该应用程序已成功更新，但即使我尝试以多种方式启动该活动，它也没有启动。

我在 中使用了[https://github.com/JakeWharton/ProcessPhoenix](https://github.com/JakeWharton/ProcessPhoenix)`BroadcastReceiver`，所以基本上在你下载的更新中，添加`ProcessPhoenix.triggerRebirth(context);`你的`BroadcastReceiver`，或者以某种方式重新启动应用程序。

# xml - 将所有 XML 属性转换为元素

> ID：10728017
> 
> 赞同：0
> 
> 时间：2012-05-23T21:20:09.187
> 
> 标签：xml, xslt, stylesheet

我有一堆格式如下的 xml 元素：

```
<WP featured="yes" player="no" dancers="no" series="logos" archive="no" fanart="no" id="eclipse_logos_">
    <seriesName>LOGOS</seriesName>
    <selection>ECLIPSE</selection>
    <imgurl>http://www.example.com/eclipse_logos_</imgurl>
    <res>1024x1024r(iPad/iPhone)?1280x1024r(Regular)?1440x900r(Widescreen)?1920x1080r(HDTV)?1920x1200r(Widescreen)</res>
</WP> 
```

我想变成

```
<WP>
    <featured>yes</featured>
    <player>no</player>
    <dancers>no</dancers>
    <series>logos</series>
    <archive>no</archive>
    <fanart>no></fanart>
    <id>eclipse_logos_</id>
    <seriesName>LOGOS</seriesName>
    <selection>ECLIPSE</selection>
    <imgurl>http://www.example.com/eclipse_logos_</imgurl>
    <res>1024x1024r(iPad/iPhone)?1280x1024r(Regular)?1440x900r(Widescreen)?1920x1080r(HDTV)?1920x1200r(Widescreen)</res>
</WP> 
```

经过一些研究，似乎使用 xslt 样式表是进行此转换的推荐方法：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="@*">
        <xsl:element name="{name()}"><xsl:value-of select="."/></xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

但是我对 xsl 样式表不是很熟悉。有人可以指导我完成应用转换的过程吗？每当我尝试时，我都会得到一个空白页。我将以下内容放在我的 xml 文档的顶部：

```
<?xml version="1.0" encoding="ISO-8859-1"?> <?xml-stylesheet type="text/xsl" href="wallpaper.xsl"?> 
```

并相应地命名 xsl 文件。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T07:25:05.783

每当您想在计算机上做任何事情时，您都必须找到可以执行此操作的程序。如果您想将样式表应用到 XML 文档，您正在寻找的程序是 XSLT 处理器。

所有现代浏览器都内置了 XSLT 1.0 处理器，如果`<?xml-stylesheet?>`在 XML 文档中看到处理指令，它们会自动调用它。但这对您帮助不大，因为他们对输出所做的只是将其显示在屏幕上，而您可能希望将其发送到文件中。

周围有很多 XSLT 处理器。在几乎所有情况下，它们都会有一个命令行界面。如果您习惯在计算机上使用命令行，那么这是一个不错的选择。xsltproc 和 Saxon 已被提及为可能的选择：两者都很好，但 Saxon 的优势在于它支持 XSLT 2.0，当您想要做一些比这个示例更复杂的事情时，迟早会需要它。

如果您对命令行不满意，可以使用 GUI 应用程序。如果您要进行大量 XML 工作，那么值得投资 XML IDE，其中最流行的是 Altova XML Spy、Stylus Studio 和 oXygen。我使用氧气。如果你想要更轻量级的东西，可以从 SourceForge 下载一个名为“Kernow for Saxon”的 Saxon 图形用户界面前端。

# android - 使用 ListView 和 SimpleCursorAdapter 创建列表

> ID：10728021
> 
> 赞同：0
> 
> 时间：2012-05-23T21:20:22.043
> 
> 标签：android, listview

我还有另外两个使用 a`ListView`和`SimpleCursorAdapter`. 代码几乎完全相同。所以我决定在第三个应用程序上再次使用它。它不起作用，并且找不到解决方案。

问题是列表中没有显示任何内容。我使用一个按钮将信息添加到数据库中。我在游标上记录一个计数，`Log.d("",storyCur.count()+"");`以确保数据库正在更新，并且确实如此。

相关数据库代码：

```
public Cursor fetchAll(){
  return mDb.query(DATABASE_TABLE, new String[] {KEY_ROWID,KEY_DETAILS,KEY_TITLE},
  null, null, null, null, null);
} 
```

其余相关代码：

```
ListView lv;
DbAdapter db;

public void onCreate(Bundle savedInstanceState) {
...
   lv = (ListView) findViewById(R.id.list);
   db = new DbAdapter(this);
....
}

public void onResume(){
    super.onResume();
    db.open();
    fillData();
}

private void fillData(){
    Cursor storyCur = db.fetchAll();
    startManagingCursor(storyCur);

    String[] from = new String[]{DbAdapter.KEY_LOC};
    int[] to = new int[]{R.id.row1};

   SimpleCursorAdapter stories = 
      newSimpleCursorAdapter(this,R.layout.story_row,storyCur,from,to);

   lv.setAdapter(stories);

    storyCur.close();
} 
```

主要 XML：

```
 <Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button"
    android:onClick="onClick" />

  <ListView
    android:id="@+id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >
  </ListView>

</LinearLayout> 
```

故事行 XML：

```
<?xml version="1.0" encoding="utf-8"?>

<TextView xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/row1"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:padding="10dp"
  android:background="#444444" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:32:45.607

您应该删除对光标上 .close() 的调用。SimpleCursorAdapter 需要打开光标才能运行，并会为您调用光标上的 close()。

# ruby - 解析文本文件行

> ID：10728027
> 
> 赞同：1
> 
> 时间：2012-05-23T21:20:54.900
> 
> 标签：ruby, scripting, awk

我有一个日志文件，其中包含以下数据：

```
2012-05-23T20:52:11+00:00 heroku[router]: GET myapp.com/practitioner_activities/10471/edit dyno=web.2 queue=0 wait=0ms service=866ms status=200 bytes=48799
2012-05-23T20:52:46+00:00 heroku[router]: GET myapp.com/users/sign_out dyno=web.1 queue=0 wait=0ms service=20ms status=302 bytes=88
2012-05-23T20:52:46+00:00 heroku[router]: GET myapp.com/ dyno=web.13 queue=0 wait=0ms service=18ms status=200 bytes=4680
2012-05-23T20:53:04+00:00 heroku[router]: POST myapp.com/p/ENaCXExu7qNEqzwYYyPs dyno=web.5 queue=0 wait=0ms service=207ms status=302 bytes=119
2012-05-23T20:53:04+00:00 heroku[router]: GET myapp.com/practitioner_activities/welcome dyno=web.3 queue=0 wait=0ms service=57ms status=200 bytes=5061
2012-05-23T20:53:04+00:00 heroku[router]: GET myapp.com/assets/application-print-715276cc0b76d0d82db3ab5866f22a23.css dyno=web.14 queue=0 wait=0ms service=9ms status=200 bytes=76386 
```

我想解析它们并将它们转储到我可以用excel打开的文件中进行分析。我需要小时、分钟、动词（GET 或 POST）、url 和 'service=' 时间。

例如，对于上面的第一行：

```
2012-05-23T20:52:11+00:00 heroku[router]: GET myapp.com/practitioner_activities/10471/edit dyno=web.2 queue=0 wait=0ms service=866ms status=200 bytes=48799 
```

我希望输出看起来像：

```
"20", "52", "GET", "myapp.com/practitioner_activities/10471/edit", "866" 
```

我将如何`awk`使用简短的 ruby​​ 脚本或使用简短的 ruby​​ 脚本来执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:54:11.813

使用`awk`，您可以尝试以下操作：

```
awk '{ OFS="\", \""; split ($8, array, "="); printf "\"" substr ($1 , length ($1) - 13, 2 ) OFS substr ($1 , length ($1) - 10, 2 ) OFS $3 OFS $4 OFS substr (array[2], 0, length (array[2]) -2) "\"\n" }' file.txt 
```

结果：

```
"20", "52", "GET", "myapp.com/practitioner_activities/10471/edit", "866"
"20", "52", "GET", "myapp.com/users/sign_out", "20"
"20", "52", "GET", "myapp.com/", "18"
"20", "53", "POST", "myapp.com/p/ENaCXExu7qNEqzwYYyPs", "207"
"20", "53", "GET", "myapp.com/practitioner_activities/welcome", "57"
"20", "53", "GET", "myapp.com/assets/application-print-715276cc0b76d0d82db3ab5866f22a23.css", "9" 
```

高温高压

**编辑：**

```
awk '{ OFS="\", \""; ORS="\"\n"; split ($8, array, "="); print "\"" substr ($1 , 12, 2 ), substr ($1 , 15, 2 ), $3, $4, array[2] + 0 }' file.txt 
```

谢谢丹尼斯！代码现在好多了:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T00:49:57.370

红宝石答案

```
ruby -ane '
    hr, min = $F[0][/(?<=T)\d\d:\d\d/].split(/:/)
    svc = $F[7].split(/=/)[-1]; svc[/ms/] = ""
    puts %q{"%d", "%d", "%s", "%s", "%d"} % [hr, min, $F[2], $F[3], svc]
' logfile 
```

# buddypress - 将我的事件链接添加到 buddypress 管理栏？

> ID：10728028
> 
> 赞同：0
> 
> 时间：2012-05-23T21:20:55.677
> 
> 标签：buddypress

在我正在开发的 Buddypress 站点中，我被要求在管理栏中添加指向“我的事件”的直接链接，因为这将是该站点管理员最常使用的功能。获取此页面链接的正确方法是什么？我想我正在寻找这样的东西，但它没有用：

```
 get_permalink( get_page_by_path( 'events/my-events' ) ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:57:42.810

指向谁的我的活动的直接链接？管理员？显示的用户？

这应该为显示的用户添加一个管理员链接 - 或者至少让你开始。把它放在 plugins/bp-custom.php

```
function add_my_events_link() { 
    global $bp;
    if ( !is_super_admin() || bp_is_my_profile() || !$bp->displayed_user->id )
        return false;
?>
    <li><a href="<?php echo wp_nonce_url( $bp->displayed_user->domain . 'events/my-events/', 'my-events' ) ?>" class="confirm"><?php printf( __( "My Events for ", 'buddypress' ), esc_attr( $bp->displayed_user->fullname ) ) ?></a></li>
<?php
}
add_action( 'bp_adminbar_menus', 'add_my_events_link', 20 ); 
```

# apache-camel - Apache Camel POJO Bean 处理器单例还是原型？

> ID：10728029
> 
> 赞同：4
> 
> 时间：2012-05-23T21:20:59.513
> 
> 标签：apache-camel

我正在使用 Camel 的 spring DSL 来构建路由，并且我正在使用我的 POJO bean 作为处理器。

最初，我这样做：

```
<bean ref="myPojoBeanProcessor"/> 
```

其中，“myPojoBeanProcessor”在我的 spring 上下文中被定义为一个 bean。

然后，我切换到：

```
<bean beanType="com.mycompany.transformation.MyPojoBeanProcessor"/> 
```

我认为 Java DSL 等价物是：

```
from("xxx").bean(MyPojoBeanProcessor.class).xxx 
```

我想知道使用后一种方法是否会在每个请求中实例化一个 bean 对象，或者是否会缓存 bean 实例并将其用作单例（如 spring 中的默认值）。

我无法在骆驼文档或谷歌上找到答案。有谁知道这个问题的答案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T03:38:20.817

你为什么不试试看:)

Camel 将使用默认的无参数构造函数一次创建一个实例，并缓存该实例，例如它的单例范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T21:09:35.093

这是 MethodCallExpression#createExpression(CamelContext) 中的相关代码：

```
if (this.beanType != null)
{
  Expression answer;
  if (ObjectHelper.hasDefaultPublicNoArgConstructor(this.beanType)) {
    this.instance = camelContext.getInjector().newInstance(this.beanType);
    answer = new BeanExpression(this.instance, getMethod());
  } else {
    answer = new BeanExpression(this.beanType, getMethod());
  }
} 
```

Camel 正在缓存它在字段中创建的实例。

# asp.net - ASP.NET 表单可能太长，无法被我们的服务器读取

> ID：10728034
> 
> 赞同：1
> 
> 时间：2012-05-23T21:21:42.697
> 
> 标签：asp.net, iis-7

我们有一个巨大的网格，我们有复选框和相同的文本框。

我们遇到了奇怪的行为，一个例子是底部的按钮确实会导致回发，但执行步骤调试表明事件处理程序没有被调用。

所以我们将按钮移到页面顶部，现在正在调用事件处理程序。

我们还注意到，在同一个请求中，如果我们检查顶部的一些项目和底部的一些项目，顶部的项目会更新，而底部的项目不会。

所以我们这样做了

```
 string strReturn = "";
        foreach (string strKey in Request.Form.AllKeys)
        {

            if (strKey.IndexOf(".x", 1) < 1 && strKey.IndexOf(".y", 1) < 1)
                strReturn += "<br> "  + strKey + " : " + Request.Form[strKey];
        }
        Response.Write(strReturn); 
```

这样做是为了打印所有表单变量，结果发现有一个截止点。在查看源代码时，我们可以正确地看到表单元素（文本框、复选框），而在提交它们时，我们的代码不会看到它们。所以在某些时候请求被截断，它会影响表单元素，包括我们上面讨论的按钮。

我们确实禁用了网格的视图状态，但它仍然不起作用。我们的网络配置文件中也有这个来最大化请求大小，我们也用它来上传文件 httpRuntime maxRequestLength="2097151" executionTimeout="300000000000"

我们知道我们的代码循环了足够多的时间，但是我们得到的值是空的，因为它们在请求中不存在。

这适用于一台开发机器，但不适用于生产服务器或另一台开发机器。

任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:31:19.397

我很可能遇到了由[此处](http://technet.microsoft.com/en-us/security/bulletin/ms11-100)描述的更新引起的问题。

> Microsoft 安全更新 MS11-100 将 HTTP 请求中的表单密钥、文件和 JSON 成员的最大数量限制为 1000。

如果您可以通过分页减小网格的大小，则可能会消除/缓解该问题。否则，您可以增加 web.config 中的最大值

```
<configuration>
  <appSettings>
    <add key="aspnet:MaxHttpCollectionKeys" value="1000" />
  </appSettings>
</configuration> 
```

更多信息[在这里](http://support.microsoft.com/kb/2661403)。

# shell - 如何在我的 shell 脚本中嵌入 CRLF 或其他不可打印的字符？

> ID：10728037
> 
> 赞同：0
> 
> 时间：2012-05-23T21:21:49.410
> 
> 标签：shell, whitespace, sh, non-printing-characters

我的老板向我提出了一个问题，即如何以一种合理便携和健壮的方式将 CRLF 序列嵌入到他的 shell 脚本中（用于管道通过某种`netcat`或`telnet`他正在做的事情）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T21:32:42.800

假设 POSIX 是“足够便携”的良好基准，

```
printf "\r\n" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:23:17.460

我给他的建议：

```
#!/bin/sh
crlf="$(echo xy | tr xy '\r\n')" 
```

...但我愿意接受其他评论。现代版本的 GNU`tr`和`bash`.

# python - 将文本文件中的多行拆分为列表列表

> ID：10728042
> 
> 赞同：1
> 
> 时间：2012-05-23T21:22:05.100
> 
> 标签：python

我正在处理一个文本文件，例如：

```
blahblahblahblahblahblahblah
blahblahblahblahblahblahblah
start
important1a important1b
important2a important2b
end
blahblahblahblahblahblahblah 
```

我想要的是得到一个像

```
["'important1a', 'important1b'", "'important2a', 'important2b'"] 
```

每条重要的行都被拆分为单独的元素，但它们在一个列表中按行组合在一起。

我已经接近了这个：

```
import shlex

useful = []
with open('test.txt', 'r') as myfile:
    for line in myfile:
        if "start" in line:
            break
    for line in myfile:
        if "end" in line:
            break       
        useful.append(line)

data = "".join(useful)

split_data = shlex.split(data)
print split_data 
```

这输出：

```
['important1a', 'important1b', 'important2a', 'important2b'] 
```

行之间没有区别。

如何修改它以区分每一行？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:25:04.317

列出理解以进行救援：

```
[", ".join(map(repr, ln.split())) for ln in open("test.txt")
                                  if "important" in ln] 
```

返回

```
["'important1a', 'important1b'", "'important2a', 'important2b'"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:25:33.863

像这样的东西怎么样：

```
useful = []
for line in open('test.txt'):
    parts = line.split()
    if parts[1:]:
        useful.append("'%s'" % "', '".join(parts))

print useful 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:30:43.217

您可以使用列表推导。您的代码如下所示：

```
useful = []
with open('test.txt', 'r') as myfile:
    for line in myfile:
        if "start" in line:
            break
    for line in myfile:
        line = line.strip()
        if "end" in line:
            break       
        useful.append(line)

print(["'%s'" % ','.join(elem.split(' ')) for elem in useful]) 
```

# node.js - 在一个变量上运行的 Node JS 中使用正则表达式的 Mongo 查询

> ID：10728043
> 
> 赞同：16
> 
> 时间：2012-05-23T21:22:06.743
> 
> 标签：node.js, mongodb

我这里有问题。我想在我的 Node JS 文件中使用 LIKE 之类的东西来查询我的 MongoDB，以获取传统的关系数据库。问题是我想要喜欢的东西不是文字......它是一个变量！到目前为止，我还没有找到这样做的好方法。这是我拍摄的“durrr first try”镜头：

```
var result = postData.replace(/\+/g,' ').substring(5);
db.testlogwiki.find({"line_text" : /result/ };
//predictably only matches to the literal "result" as opposed to my variable 
```

testlogwiki 是用 Mongo 制作的......我让它运行，这确实对带有“line_text”的 db 条目确实包含“结果”字面意思。

这似乎是一个非常简单的问题......

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-23T21:24:43.670

试试这个：

```
db.testlogwiki.find({"line_text" : new RegExp(result) }; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-23T19:04:32.780

两者都会起作用

```
db.testlogwiki.find({"line_text" : new RegExp(result, 'i') }; // to make this case insensitive 
```

或者

```
db.testlogwiki.find( { line_text: { $regex: result[, $options: 'i'] } } ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T00:03:26.093

您也可以使用 $regex 选项。

```
db.testlogwiki.find( { line_text: { $regex: result[, $options: 'i'] } } ); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-06-15T14:28:03.880

**根据您的输入变量，所有其他答案可能会失败**

您可以按照其他人的指示使用 RegExp，但您必须转义特殊的正则表达式字符，否则可能会失败。

Lodash 有一个功能可以做到这一点（如果你不使用它，你可能应该使用它，它添加了很多甚至在 ES6+ 规范中都没有的糖）

[https://lodash.com/docs#escapeRegExp](https://lodash.com/docs#escapeRegExp)

`db.COLLECTION.find({FIELD_NAME: new RegExp(_.escapeRegExp(VAR), 'i') };`

# matlab - Matlab - 如何在曲线上绘制切线

> ID：10728044
> 
> 赞同：3
> 
> 时间：2012-05-23T21:22:08.830
> 
> 标签：matlab

我在matlab中绘制了一个图表：

```
plot(x,y) 
```

我的图表有不同的斜率，我如何在每个斜率上绘制切线并计算斜率的系数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:46:48.370

如果您没有绘制点的显式函数，则可以使用[有限差分](http://en.wikipedia.org/wiki/Finite_difference)来估计导数。以下适用于不在数据跨度边界上的点：

```
plot(x,y);
hold all;

% first sort the points, so x is monotonically rising
[x, sortidx] = sort(x);
y = y(sortidx);

% this is the x point for which you want to compute the slope
xslope = (x(1)+x(end))/2;

idx_a = find(x<xslope,1,'last');
idx_b = find(x>xslope,1,'first');
% or even simpler:
idx_b = idx_a+1;
% this assumes min(x)<xslope<max(x)

xa = x(idx_a);
xb = x(idx_b);
slope = (y(idx_b) - y(idx_a))/(xb - xa); 
```

现在画那个斜率，这取决于你想要什么：只是一条短线：

```
yslope = interp1(x,y,xslope);
ya_sloped = yslope + (xa-xslope)*slope;
yb_sloped = yslope + (xb-xslope)*slope;
line([xa;xb],[ya_sloped;yb_sloped]); 
```

或更长的线

```
yslope = interp1(x,y,xslope);
xa = xa + 4*(xa-xslope);
xb = xb + 4*(xb-xslope);
ya_sloped = yslope + (xa-xslope)*slope;
yb_sloped = yslope + (xb-xslope)*slope;
line([xa;xb],[ya_sloped;yb_sloped]); 
```

我很确定这段代码中没有错误，但是当我有 matlab 时我会对其进行测试；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:37:58.960

您必须计算出您有兴趣使用 (y2-y1)/(x2-x1) 的任何点的斜率，然后使用 plot() 绘制一条具有该斜率的直线。要绘制直线，您需要 y 截距，并且由于您知道该直线上至少一个点的坐标（这是您要绘制切线的点），您可以在方程 y=mx 中求解 b +b。

# java - 将 RGB 整数数组转换为位图

> ID：10728047
> 
> 赞同：1
> 
> 时间：2012-05-23T21:22:13.697
> 
> 标签：java, bitmap

我们知道，我们可以使用以下代码获取位图图像的 rgb：

```
BufferedImage img = ImageIO.read(new File(bitmapURL));
int[] pixels = img.getRGB(0, 0, img.getWidth(), img.getHeight(), null, 0, img.getWidth()); 
```

而且，在执行这部分代码之后，我们有一个整数数组，其中包含 4 个字节`Alpha, Red, Green and Blue`的任何像素颜色。所以，我想知道我们如何将整数数组转换`int [] myPixels;`为 Bitmap ？任何人都可以帮我实现这一目标吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:28:38.137

你可以直接使用这个：

```
image.setRGB(0, 0, width, height, pixels, 0, width); 
```

[来源](http://docs.oracle.com/javase/6/docs/api/java/awt/image/BufferedImage.html#setRGB%28int,%20int,%20int,%20int,%20int%5B%5D,%20int,%20int%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:26:06.633

```
 BufferedImage im = new BufferedImage(width, height);

for (int i = 0; i < width; i++) {
  for (int j = 0; j < height; j++) {
    im.setRGB(...);
  }
} 

```

# php - 引号中的 wp_title

> ID：10728049
> 
> 赞同：0
> 
> 时间：2012-05-23T21:22:27.553
> 
> 标签：php, wordpress

我正在寻找解决此问题的方法：

我希望单页上的 wp_title 之前有一个 » 标记，之后有一个 « 标记。有什么建议么？

```
<title><?php
    global $page, $paged;

    if (is_single()) {wp_title( '|', true, 'right' );}  //on this line

    else {wp_title( '|', true, 'right' );}

    bloginfo( 'name' );

    $site_description = get_bloginfo( 'description', 'display' );
    if ( $site_description && (is_front_page() ) )
        echo " | $site_description";

    ?></title> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:43:20.967

您在 wp_title 函数中将 echo 设置为 true。将其设置为 false，然后您可以将您的标题包装成一个简单的 echo 语句，如下所示：

```
echo '&laquo;'.wp_title( '|', false, 'right' ).'&raquo;'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:28:39.730

试试这个：

```
<title>&#187<?php
global $page, $paged;

if (is_single()) {wp_title( '|', true, 'right' );}  //on this line

else {wp_title( '|', true, 'right' );}

bloginfo( 'name' );

$site_description = get_bloginfo( 'description', 'display' );
if ( $site_description && (is_front_page() ) )
    echo " | $site_description";

?>&#171</title> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T21:51:07.420

这成为了解决方案：

```
 <title><?php
    global $page, $paged;

    if (is_single()) {the_title('&raquo;', '&laquo;');echo ' | ';}
    else {wp_title( '|', true, 'right' );}

    bloginfo( 'name' );

    $site_description = get_bloginfo( 'description', 'display' );
    if ( $site_description && (is_front_page() ) )
        echo " | $site_description";

    ?></title> 
```

# jquery - 通过淘汰赛提交给 MVC 操作的表单有额外的双引号

> ID：10728052
> 
> 赞同：1
> 
> 时间：2012-05-23T21:22:45.790
> 
> 标签：jquery, asp.net-mvc-3, knockout.js, knockout-mapping-plugin

我在通过淘汰模型提交给我的控制器操作的数据方面遇到问题。每个字符串字段都有额外的双引号包围它，这是一个问题。

虽然我可以手动反序列化数据，但使用 MVC3 时似乎根本不应该出现这个问题。请记住，我需要提交表单而不是 ajax 帖子。

html:

```
@inherits System.Web.Mvc.WebViewPage<FbWizardCreateTabModel>

@using (Html.BeginForm("InstallApplication", "FbWizard", FormMethod.Post, new { id = "createtab", @data_bind = "submit:onSubmit" }))
{
    <p>Page Id: <span data-bind="text: PageId"></span></p>
    <p>Page Name: <span data-bind="text: PageName"></span></p>
    <p>Tab Name: @Html.TextBoxFor(m => m.TabName, new { data_bind = "value: TabName" })</p>
}

<button class="btn btn-primary next">Submit</button> 
```

脚本代码：

```
 <script type="text/javascript">

        var initialData = @Html.Raw(Model.JsonData);
        var viewModel = ko.mapping.fromJS(initialData);

        viewModel.onSubmit = function() {

            var action = $('#createtab').attr('action');

            ko.utils.postJson(action, this);

            return false;
        };

        ko.applyBindings(viewModel);

    </script> 
```

控制器动作：

```
[HttpPost]
public ActionResult InstallApplication(FbWizardCreateTabModel model)
{
    // The model is mangled at this point, see image below

    return View();
} 
```

模型发布后的内容：

![在此处输入图像描述](../Images/ce53a3d8da0b405f95ea87e4e15450bf.png)

原始帖子数据：

```
POST http://mysite.localhost:7785/Admin/FbWizard/InstallApplication HTTP/1.1
Host: mysite.localhost:7785
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:12.0) Gecko/20100101 Firefox/12.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Referer: http://mysite.localhost:7785/Admin/FbWizard/CreateTab
Cookie: fbsr_....
Content-Type: application/x-www-form-urlencoded
Content-Length: 333

PageId=%22231271443653720%22&PageName=%22Car5%22&TabName=%22Auctions2%22&JsonData=null&__ko_mapping__=%7B%22include%22%3A%5B%22_destroy%22%5D%2C%22ignore%22%3A%5B%5D%2C%22copy%22%3A%5B%5D%2C%22mappedProperties 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:22:50.613

我可能在这里离基地很远......但可能***这***是一个错误......以下是来自淘汰赛的源代码，略有改动

```
 postJsonNoQuotes = function (urlOrForm, data, options) {
        options = options || {};
        var params = options['params'] || {};
        var includeFields = options['includeFields'] || this.fieldsIncludedWithJsonPost;
        var url = urlOrForm;

        // If we were given a form, use its 'action' URL and pick out any requested field values
        if((typeof urlOrForm == 'object') && (ko.utils.tagNameLower(urlOrForm) === "form")) {
            var originalForm = urlOrForm;
            url = originalForm.action;
            for (var i = includeFields.length - 1; i >= 0; i--) {
                var fields = ko.utils.getFormFields(originalForm, includeFields[i]);
                for (var j = fields.length - 1; j >= 0; j--)
                    params[fields[j].name] = fields[j].value;
            }
        }

        data = ko.utils.unwrapObservable(data);
        var form = document.createElement("form");
        form.style.display = "none";
        form.action = url;
        form.method = "post";
        for (var key in data) {
            var input = document.createElement("input");
            input.name = key;
           // I think this is the offending line....
           // input.value = ko.utils.stringifyJson(ko.utils.unwrapObservable(data[key]));
            input.value = ko.utils.unwrapObservable(data[key]);
            form.appendChild(input);
        }
        for (var key in params) {
            var input = document.createElement("input");
            input.name = key;
            input.value = params[key];
            form.appendChild(input);
        }
        document.body.appendChild(form);
        options['submitter'] ? options['submitter'](form) : form.submit();
        setTimeout(function () { form.parentNode.removeChild(form); }, 0);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T05:29:35.923

关键在于函数的名称，`postJson`。它并不是要执行您尝试使用它执行的操作，它会获取您提供给它的对象上的任何属性并将它们的值发布为 JSON。例如，您可以将您的帖子更改为：

```
ko.utils.postJson(action, { json: this }); 
```

您对此采取的行动：

```
[HttpPost]
public ActionResult InstallApplication(string json)
{
    JavascriptSerializer ser = new JavascriptSerializer();
    FbWizardCreateTabModel model = ser.Deserialize<FbWizardCreateTabModel>(json);

    return View();
} 
```

如果您想使用 Keith 建议的函数，我会将 JSON 排除在名称之外，因为您似乎不想实际发布 JSON，也许可以调用它`postAsFormData`

# android - 完全停止或重新启动 Android 应用程序中的所有活动以反映新的语言选择

> ID：10728053
> 
> 赞同：4
> 
> 时间：2012-05-23T21:22:52.447
> 
> 标签：android

我正在开发一个需要双语（英语/西班牙语）的 Android 应用程序。我允许用户从首选项中选择所需的语言，并根据所选语言在应用程序的主要活动（TabActivity 的子类）中执行以下区域设置更改：

```
private void setApplicationLanguage(String languageCode)
{
    // Set the locale to the specified language code.
    Resources res = getResources();
    DisplayMetrics dm = res.getDisplayMetrics();
    android.content.res.Configuration conf = res.getConfiguration();
    conf.locale = new Locale(languageCode.toLowerCase());
    res.updateConfiguration(conf, dm);
} 
```

主要活动包含四个选项卡，每个选项卡都有自己的活动（有时是活动组）。我希望发生的是当语言发生变化时，*所有*打开的活动都会简单地重新启动，这会导致它们的字符串以适当的语言重新加载。同样可以接受（但不太理想）的是完全破坏所有打开的活动，要求用户再次手动启动应用程序，因此所有字符串都将以适当的语言重新加载。

我尝试`finish()`从导致该活动退出的主要活动中调用。但是，当我重新启动应用程序时，由主要活动（每个选项卡一个）“托管”的子活动仍以先前的语言显示。我认为这是因为子活动对我来说没有递归地“完成”。

我还尝试在主要活动以及其他活动上包含/排除 AndroidManifest.xml 中的“语言环境”属性，但我从未看到在本地更改后重新启动活动。话又说回来，“重启”将如何表现出来？它会调用`onCreate()`还是简单地调用`onResume()`，甚至是其他东西？如果这种方法会自动重新启动活动，并在语言环境更改时调用`onCreate()`，那么在我看来，关于如何实现这一点的具体指导听起来将是最佳途径。

该解决方案需要在 Android API 级别 7 上运行，因此`Intent`使用该标志创建一个新`FLAG_ACTIVITY_CLEAR_TASK`选项显然是不可用的选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:55:41.203

您可以使用 a`BroadcastReceiver`作为每个`Activity`用于选项卡内容的内部类。

在 中注册接收器`onResume`并在 中取消注册`onPause`。

当区域设置更改时，让主`Activity`发送一个“粘性”广播，并使用 in 的结果`registerReceiver`来`onResume`检索`Intent`区域设置是否已更改。这也应该适用于任何“可见” `Activity`，以允许它动态更新数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T20:20:58.600

我实施了一个`LocalBroadcastManager`告诉感兴趣的各方关于语言环境的变化。问题是我无法更新我想要的所有内容，例如标签上的标签。事实证明，“主要”（Tab）活动中的以下内容效果最好：

```
 Intent intent = new Intent(mainActivity.getApplicationContext(), MainTabActivity.class);
    intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
    mainActivity.startActivity(intent); 
```

# c# - 我可以在运行时将更改的信息保存在 datagridview 中吗？

> ID：10728059
> 
> 赞同：0
> 
> 时间：2012-05-23T21:23:36.787
> 
> 标签：c#, .net, datagridview, datatable, dataset

我刚开始学习`C#`，有点迷茫`DataSet/DataTable/DataGridView`。现在我有一个简单的表单，其中有`DataGridView`, `listBox`, `Insert & Delete`按钮。当我的表单加载到 listBox 中时，我得到了 excel 工作表的列表。然后我选择一张纸，然后它出现在`DataGridView`（我正在写的所有信息`DataSet`和`DataTable`）上。我想在运行时添加或删除列。这是我的`Delete`按钮代码：

```
 excelConn = new OleDbConnection();
    excelConn.ConnectionString = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source= " + excelFilePath + ";Extended Properties=\"Excel 8.0;HDR=YES;IMEX=1\"";
    DataTable dt = new DataTable();
    OleDbDataAdapter ExcelAdapt = new OleDbDataAdapter("Select * From " + "[" + tableName + "]", excelConn);
    ExcelAdapt.Fill(dt);
    try
    {
      dt.Columns.Remove(colName);
      dt.AcceptChanges();
      var bds = new BindingSource();
      bds.DataSource = dt;
      grid.DataSource = bds;

      MessageBox.Show("Column(s) deleted ");
      excelConn.Close();
      }

      catch (Exception ex)
      {
         MessageBox.Show(ex.Message);
      } 
```

我面临的问题是我无法保存在运行时所做的更改，即使在运行时这些更改也是临时的。如果在运行时我添加新列，然后我从`ListBox`这些更改中选择另一张表消失。

我[找到了本教程](http://www.dreamincode.net/forums/topic/238727-insert-update-and-delete-records-in-table-with-datagridview-using-c#/)，但如果我理解得很好，它会更改数据库；好吧，在我的情况下，它会更改 excel 文件（但我想拥有原始的 excel 文件并仅在`DataSet`and中进行更改`DataTable`）。

我只能在`DataSet/DataTable`. 如果是，那么如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:06:54.207

这是您的问题的确切解决方案，它确实将数据从 DataGridView 更新到 Excel，我刚刚在我的机器上进行了测试，它确实有效：

[http://blogs.msdn.com/b/spike/archive/2008/10/29/how-to-update-an-excel-worksheet-using-dataset-and-the-oledbdataadapter.aspx](http://blogs.msdn.com/b/spike/archive/2008/10/29/how-to-update-an-excel-worksheet-using-dataset-and-the-oledbdataadapter.aspx)

**[编辑]**

例如，以下代码将从 DataGridView1 和 ds 的本地副本中删除第 3 行，但您的 EXCEL 不会受到影响。

```
dataGridView1.Rows.RemoveAt(2);
ds.Tables["[Sheet1$]"].Rows[2].Delete(); 
```

稍后当您想将此数据保存到其他 EXCEL 时，您可以只导出到新的 EXCEL 或相同的 EXCEL 不同的 [SheetX]。

# c# - c#中的Pinvoke c++函数传递2个浮点数

> ID：10728060
> 
> 赞同：2
> 
> 时间：2012-05-23T21:23:55.847
> 
> 标签：c#, c, pinvoke

我正在使用 C# 中的非托管 c++ dll，它通过 USB 控制测量网络设备。首先，我想访问 dll 中的函数，该函数将从设备返回测量值，并在文档中定义如下：

```
BOOL WINAPI LKIF_GetCalcData(OUT LKIF_FLOATVALUE *CalcData1,OUT LKIF_FLOATVALUE *CalcData2);

typedef enum {
    LKIF_FLOATRESULT_VALID, // valid data
    LKIF_FLOATRESULT_RANGEOVER_N, // over range at negative (-) side
    LKIF_FLOATRESULT_WAITING, // comparator result
} LKIF_FLOATRESULT;

typedef struct {
LKIF_FLOATRESULT FloatResult; // valid or invalid data.
    float Value; // measurement value during LKIF_FLOATRESULT_VALID. 
    Any other times will return an invalid value.
} LKIF_FLOATVALUE; 
```

因为这是我第一次使用 dll，所以我花了很长时间搜索如何使用 PInvoke 在 C# 中定义函数，并且我设法让它部分工作。我能够调用该函数，并且在函数执行时它似乎正确返回了 true 或 false 值。例如，如果设备已打开并准备就绪，则返回 true，如果我关闭设备，则返回 false。但是，应该包含测量值的两个浮点值始终返回零值。

我首先创建了一个包含 PInvoke 的类：

```
public class Keyence
{
    [DllImport("c:\\LkIF.dll")]
    public static extern bool LKIF_GetCalcData(
        [Out] float CalcData1, [Out] float CalcData2);
} 
```

然后由 getMeasurement 方法调用：

```
static bool getMeasurement(ref float MeasurementValue1, ref float MeasurementValue2)
{
    float CalcData1 = new float();
    float CalcData2 = new float();

    bool sucess = Keyence.LKIF_GetCalcData(CalcData1,CalcData2);

    if (sucess)
    {
        // all is ok
        MeasurementValue1 = CalcData1;
        MeasurementValue2 = CalcData2;
        return (sucess);
    }
    else
    {
        MessageBox.Show("Unable to get measurment.");
        return (sucess);
    }
} 
```

为了测试该方法，有一个带有按钮和文本框的简单表单，当单击按钮时，文本框的值将使用两个测量值进行更新。

```
private void button1_Click(object sender, EventArgs e)
{
    float MeasurementValue1 = new float();
    float MeasurementValue2 = new float();
    bool success = getMeasurement(ref MeasurementValue1, ref MeasurementValue2);
    if (success)
    {
        textBox1.Text = MeasurementValue1.ToString() + "," + MeasurementValue2.ToString();
    }      
} 
```

单击按钮后，文本框中的值更新为 0,0。

我已经看到很多线程涉及调用传入值的非托管函数，但函数返回值的错误并不多。我有一种感觉，我可能没有正确定义 c# 中的 C++ 函数，但我现在有点茫然。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:31:21.087

该函数返回一个结构而不是一个浮点数。您必须在 C# 代码中声明该结构。

```
public enum LKIF_FLOATRESULT
{
    LKIF_FLOATRESULT_VALID, 
    LKIF_FLOATRESULT_RANGEOVER_N, 
    LKIF_FLOATRESULT_WAITING
}

[StructLayout(LayoutKind.Sequential)]
public struct LKIF_FLOATVALUE
{
    public LKIF_FLOATRESULT FloatResult; 
    public float Value; 
} 
```

然后定义 p/invoke 以将该结构作为输出参数传递给函数。

```
[DllImport(@"c:\LkIF.dll")]
public static extern bool LKIF_GetCalcData(
    out LKIF_FLOATVALUE CalcData1, 
    out LKIF_FLOATVALUE CalcData2
); 
```

最后，您像这样调用函数：

```
LKIF_FLOATVALUE CalcData1;
LKIF_FLOATVALUE CalcData2;
bool success = Keyence.LKIF_GetCalcData(out CalcData1, out CalcData2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:29:47.317

尝试以下

```
public enum LKIF_FLOATRESULT {
    LKIF_FLOATRESULT_VALID,
    LKIF_FLOATRESULT_RANGEOVER_N,
    LKIF_FLOATRESULT_WAITING,
}

public struct LKIF_FLOATVALUE {
    public LKIF_FLOATRESULT FloatResult;
    public float Value;
}

public partial class NativeMethods {

    [DllImport("c:\\LkIF.dll")]
    public static extern  bool LKIF_GetCalcData(
        out LKIF_FLOATVALUE CalcData1, 
        out LKIF_FLOATVALUE CalcData2) ;

} 
```

# entity-framework - 如何更改 EntityFramework 中自动生成的“鉴别器”列？

> ID：10728061
> 
> 赞同：5
> 
> 时间：2012-05-23T21:23:56.453
> 
> 标签：entity-framework, ef-code-first

我正在编写一些通过 EF4.3 使用单表继承的代码。

有一个名为 User 的实体和另一个名为 Admin 的实体。管理员继承自用户。

**用户类**

```
public class User
{
    public int Id {get;set;}
    public string Username {get;set;}
} 
```

**管理类**

```
public class Admin : User { } 
```

EF 生成带有`Discriminator`列的数据库表。当`Admin`添加记录时`Discriminator="Admin"`，用户记录将具有`Discriminator="User"`.

`Discriminator`我的问题是，如果我想`User`进入 and ，如何更新该列`Admin`？

我尝试从一种对象类型转换为另一种对象类型并使用 EF 保存。但这不会改变鉴别器列。我该如何改变它？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T21:37:13.820

对象永远不能改变它们的类型。如果您打算更改用户的“管理员”设置（合理），您应该使用属性/属性而不是类型名称来执行此操作。

例如，您可以在`User`对象和`Administrator`对象之间建立关联，而不是希望将对象*替换*为子类型。`User``Administrator`

[我在一篇旧博客文章中写过这个想法](https://web.archive.org/web/20160304214634/http://blogs.teamb.com/craigstuntz/2008/07/17/37825/)：

> 在设计一个好的对象关系映射时，你必须克服的心理障碍之一是倾向于主要用面向对象的术语或关系术语来思考，这取决于你的个性。然而，一个好的对象关系映射同时包含一个好的对象模型和一个好的关系模型。例如，假设您有一个数据库，其中包含一个人员表，以及员工和客户的相关表。一个人可能在所有三个表中都有记录。现在，从严格关系的角度来看，您可以为员工构建一个数据库 VIEW，为客户构建另一个数据库，这两个数据库都包含来自 People 表的信息。使用一个视图或另一个视图时，您可以暂时将个人视为“只是”一个员工或“只是”一个客户，即使你知道他们都是。因此，来自这种世界观的人可能会尝试进行 OO 映射，其中 Employee 和 Customer 都是 Person 的（直接）子类。但这不适用于我们拥有的数据；由于一个人同时拥有员工和客户记录（并且由于没有任何 Person 实例可以同时属于具体子类型 Employee 和 Customer），Person 和 Employee 之间的 OO 关系需要是组合而不是继承，对于 Person 和 Customer 也是如此。

要直接回答您的问题，无法使用 EF 更改此列。你当然可以直接用 SQL 来做。但是由于上述原因，我鼓励您更改此设计。

# php - Symfony2：调试控制器变量

> ID：10728064
> 
> 赞同：4
> 
> 时间：2012-05-23T21:24:09.280
> 
> 标签：php, model-view-controller, debugging, symfony

如何快速访问和查看控制器中使用的变量？我使用 xdebug，但通常在通过控制器时查看对象内部的内容是多余的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T21:52:57.070

[您可以使用get_defined_vars()](http://php.net/manual/en/function.get-defined-vars.php)方法获取当前范围内定义的变量并使用库记录它，`Monolog`例如

```
 $this->container->get('logger')->info('Local variables', get_defined_vars()); 
```

我建议在 Firefox 中安装[FirePHP](http://www.firephp.org/)扩展，因为在开发模式下`FirePHP`自动启用处理程序，因此您可以在 firebug 控制台中看到信息消息。有关记录结帐的更多信息，请查看[此](http://symfony.com/doc/current/cookbook/logging/monolog.html)食谱条目。

# php - 使用 ODBC 的 SQL 查询

> ID：10728065
> 
> 赞同：0
> 
> 时间：2012-05-23T21:24:10.980
> 
> 标签：php, sql, odbc

这个脚本：

```
 <?php    
    $myfamille=$_POST['myfamille'];

    $conn = odbc_connect('sage','<Administrateur>','');

    if (!$conn) 
    {exit("Connection Failed: " . $conn);} 

    $sql="Select F_ARTSTOCK.AR_Ref,AR_Design,AS_QteSto 
    FROM F_ARTICLE,F_FAMILLE,F_ARTSTOCK
    where F_ARTICLE.FA_CodeFamille=F_FAMILLE.FA_CodeFamille
    AND F_ARTICLE.AR_Ref=F_ARTSTOCK.AR_Ref
    AND F_FAMILLE.FA_CodeFamille='".$myfamille."'
    and F_ARTSTOCK.AS_QteSto <> 0";

    $rs=odbc_exec($conn,$sql);
    if (!$rs) 
    {exit("Error in SQL");} 
    while($e=odbc_fetch_object($rs))
           {$output[]=$e;}
    print(json_encode($output));
    ?> 
```

给我这个错误：

```
Notice: Undefined variable: output in C:\wamp\www\articlecbase.php on line 24 
```

请注意，删除此行会使代码正常工作，我不知道是什么问题

```
AND F_FAMILLE.FA_CodeFamille='".$myfamille."' 
```

我也有一个类似的脚本，但使用 sql server 并且工作正常

```
<?php
 $myservername=$_POST['myservername'];
$servername=".\\".$myservername;
$myusername=$_POST['myusername'];
$mypassword=$_POST['mypassword'];
$db_name="bijou";
$myfamille=$_POST['myfamille'];
  $connectionInfo = array( "Database"=>$db_name, "UID"=>$myusername, "PWD"=>$mypassword);
$conn = sqlsrv_connect( $servername, $connectionInfo);

if (!$conn) 
{exit("Connection Failed: " . $conn);} 

$sql="Select F_ARTSTOCK.AR_Ref,AR_Design,AS_QteSto FROM F_Article,F_Famille,F_ARTSTOCK
where F_ARTICLE.FA_CodeFamille=F_FAMILLE.FA_CodeFamille
AND F_ARTICLE.AR_Ref=F_ARTSTOCK.AR_Ref
AND F_FAMILLE.FA_CodeFamille='".$myfamille."' and F_ARTSTOCK.AS_QteSto != .000000";

$rs=sqlsrv_query($conn,$sql); 
if (!$rs) 
{exit("Error in SQL");} 

while($e=sqlsrv_fetch_object($rs))
       { $output[]=$e;}

print(json_encode($output));
?> 
```

这也适用于 odbc 作品：

```
 <?php    
$myusername=$_POST['myusername'];
$conn = odbc_connect($myusername,'<Administrateur>','');

if (!$conn) 
{exit("Connection Failed: " . $conn);} 

$sql="SELECT   FA_CodeFamille AS FA_CodeFamille,FA_Intitule AS FA_Intitule FROM   F_FAMILLE";
$rs=odbc_exec($conn,$sql);

if (!$rs) 
{exit("Error in SQL");} 
while($e=odbc_fetch_object($rs))
       { $output[]=$e;}
print(json_encode($output));

?> 
```

请帮我。问候

* * *

```
$output = array();
while($e=odbc_fetch_object($rs)) {
    $output[] = $e;
} 
```

在许多脚本上工作正常我有任何帮助请

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:26:47.030

PHP 正在抱怨，因为在您使用它之前没有声明该变量。

```
$output = array();
while($e=odbc_fetch_object($rs)) {
    $output[] = $e;
} 
```

否则，如果从未进入 while 循环，则不会声明变量，因此当 you 时`json_encode($output)`，`output`不存在。

另外，我建议您放弃旧的 ODBC 方法并转向 PDO（或至少是 PDO ODBC 驱动程序）。

此外，您的代码对 SQL 注入开放。您应该使用准备好的语句或正确转义插入到查询中的字符串。即，您应该查看[odbc_prepare](http://php.net/odbc_prepare)

此外，永远不会保证填充 $_POST['key']。你应该总是使用类似的东西：

```
$blah = (isset($_POST['blah'])) ? $_POST['blah'] : null; 
```

或者

```
$blah = (array_key_exists($_POST['blah'])) ? $_POST['blah'] : null; 
```

或者，如果你像我一样特别偏执：

```
$blah = (array_key_exists($_POST['blah']) && is_string($_POST['blah'])) ? $_POST['blah'] : null; 
```

如果用户让 PHP 将其解析为数组，则将数组传递给函数时可能会发生错误。这会使 PHP 不必要地生成通知/错误，所以我想避免这种可能性。

`$_GET['test']`（强制成为数组的一个例子是`page.php?test[]=blah`）

# ios - 为什么使用 UIPanGestureRecognizer 移动对象时会有延迟？

> ID：10728066
> 
> 赞同：17
> 
> 时间：2012-05-23T21:24:15.410
> 
> 标签：ios, iphone, delay, uigesturerecognizer, uipangesturerecognizer

我正在`UIView`使用移动对象`UIPanGestureRecognizer`——我在屏幕上拖动手指多少，我在同一方向上移动视图多少（仅在 X 方向 - 向左或向右，Y 不变）。它工作正常，但有（非常明显的）*延迟*。

这是处理`UIPanGestureRecognizer`事件的方法：

```
-(void)movePages:(UIPanGestureRecognizer *)sender
{
    if (switchingMode == 1) {
        if ([sender state] == UIGestureRecognizerStateBegan) {
            fingerStartPosition = [sender locationInView:self.view].x;
            viewStartPosition = [[viewControllers objectAtIndex:activeViewControllerIndex] view].center;
        }
        [[[[viewControllers objectAtIndex:activeViewControllerIndex] view] layer] setPosition:CGPointMake(viewStartPosition.x - (fingerStartPosition - [sender locationInView:self.view].x) , viewStartPosition.y)];            
    }
} 
```

我尝试使用其图层设置视图的位置，我还尝试设置框架，使用具有不同持续时间的动画，但一切都表现相同。知道为什么会发生这种延迟吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-12-01T19:38:47.337

Use a `UILongPressGestureRecognizer` and set the `minimumPressDuration` to `0.0`. This recognizes instantly and you get all the same updates including the `UIGestureRecognizerStateChanged` with the updated location.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-02-19T06:34:56.867

我发现如果只使用常规的 touchesBegan、Moved 和 Ended，响应速度会更快。我什至对 UIGestureRecognizer 进行了子类化，但它仍然滞后于平移手势。即使 UIGestureRecognizer 中的 touchesBegan 会按时触发，状态更改也需要半秒才能更改其状态......使用普通的旧 TouchesBegan 似乎更快，特别是如果你的 cpu 正在做很多事情。

```
override func touchesBegan(touches: Set<UITouch>, withEvent event: UIEvent?)
{
    if touches.count == 1
    {
        initialTouchLocation = (touches.first?.locationInView(self).x)!
    }
}
override func touchesMoved(touches: Set<UITouch>, withEvent event: UIEvent?)
{
    if touches.count == 1
    {
        let locationInView = touches.first?.locationInView(self)
        if !thresholdHit
        {
            //this is the threshold for x movement in order to trigger the panning...
            if abs(initialTouchLocation - locationInView!.x) > 1
            {
                thresholdHit = true
            }
        }
        else
        {
            if (self.frame.width != CGFloat(screenSize))
            {
                let panDelta = initialTouchLocation - locationInView!.x
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T21:29:39.817

在您将手指移动一些像素之前，GestureRecognizer 无法确定它是否是平移手势。我不知道确切的容差值，但这就是您感到延迟的原因。

*文档：*

> 平移手势是连续的。当允许的最小手指数移动到足以被视为平底锅时，它就开始了。

如果您想要即时移动，您可能需要使用`touchesMoved:`.

另一种方法可能是动画到第一个识别点。但这并不能消除延迟。对于这种方法，您可以查看我在 github 上的[JDDroppableView 。](https://github.com/jaydee3/JDDroppableView)

# c# - 如何继承一种风格并触及深层元素？

> ID：10728068
> 
> 赞同：0
> 
> 时间：2012-05-23T21:24:29.097
> 
> 标签：c#, wpf, xaml, inheritance, styles

我有一个名为“Home”的 MenuItem-Style。新的 MenuItem-Style "Right" 应继承自它。唯一需要覆盖的是样式中 Image 的 ImageSource。最后一个答案中的这个花哨的技巧在这里不可行，因为样式本身没有 ImageSource-Property。

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d">
    <Style x:Key="Home" TargetType="{x:Type MenuItem}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type MenuItem}">
                    <ControlTemplate.Resources>
                        <Storyboard x:Key="OnMouseEnter" />
                    </ControlTemplate.Resources>
                    <Grid x:Name="Grid" d:DesignWidth="150" d:DesignHeight="150">
                        <Image x:Name="Image" HorizontalAlignment="Center" VerticalAlignment="Center"
                   Source="/WpfControlLibrary_Battleship;component/Resources/MenuItemBackgrounds/Home.gif" />
                        <Viewbox x:Name="Viewbox">
                            <Label x:Name="Label" Content="{TemplateBinding Header}" />
                        </Viewbox>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <EventTrigger RoutedEvent="Mouse.MouseEnter" SourceName="Grid">
                            <BeginStoryboard x:Name="OnMouseEnter_BeginStoryboard" Storyboard="{StaticResource OnMouseEnter}" />
                        </EventTrigger>
                        <EventTrigger RoutedEvent="Mouse.MouseLeave" SourceName="Grid">
                            <StopStoryboard BeginStoryboardName="OnMouseEnter_BeginStoryboard" />
                        </EventTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="MinHeight" Value="0" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="Background" Value="{x:Null}" />
        <Setter Property="Foreground" Value="{x:Null}" />
        <Setter Property="MinWidth" Value="0" />
        <Setter Property="Header" Value="" />
    </Style>
    <Style x:Key="Right" TargetType="{x:Type MenuItem}" BasedOn="{StaticResource Home}">

    </Style>
</ResourceDictionary> 
```

最后一个问题及其解决方案：[如何继承样式并覆盖某些内容？](https://stackoverflow.com/questions/10671416/how-to-inherit-from-a-style-and-to-overwrite-something)
（在这种情况下，以下解决方案不可用。）

```
<Style x:Key="Water" TargetType="Button">
    <Setter Property="Background">
        <Setter.Value>
            <ImageBrush ImageSource="/WpfControlLibrary_Battleship;component/Resources/ButtonBackgrounds/Water.jpg"/>
        </Setter.Value>
    </Setter>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Grid">
                <Grid Background="{TemplateBinding Background}" ...
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<Style x:Key="SomeOtherWaterStyle" BasedOn="{StaticResource WaterStyle" TargetType="Grid">
    <Setter Property="Background" Value="Red"/>
</Style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:14:04.757

在您的情况下，为什么不只使用 MenuItem 的 Icon 属性来设置图像？使用它而不是您的图像：

```
 <ContentPresenter HorizontalAlignment="Center" 
                      VerticalAlignment="Center"
                      ContentSource="Icon" /> 
```

并设置 Icon 属性

```
 <Setter Property="Icon">
      <Setter.Value>
        <Image x:Name="Image"  
               Source="/WpfControlLibrary_Battleship;component/Resources/MenuItemBackgrounds/Home.gif" />
      <Setter.Value>
 </Setter> 
```

然后您可以在继承的样式中轻松更改图像：

```
<Style x:Key="Right" TargetType="{x:Type MenuItem}" BasedOn="{StaticResource Home}">
   <Setter Property="Icon">
      <Setter.Value>
        <Image x:Name="Image"  
               Source="/WpfControlLibrary_Battleship;component/Resources/MenuItemBackgrounds/Right.gif" />
      <Setter.Value>
 </Setter>
</Style> 
```

作为一般解决方案，或者如果您无法使用 Icon 属性来解决此问题，我将扩展 MenuItem 控件，添加我想要的属性并绑定到模板中的该属性。

关于flusser

# android - getItemPosition 何时应该考虑项目位置的变化？

> ID：10728076
> 
> 赞同：11
> 
> 时间：2012-05-23T21:25:04.807
> 
> 标签：android, android-viewpager

Android 的 PagerAdapter 类中方法 getItemPosition 的文档说明它是：

> 当宿主视图试图确定项目的位置是否已更改时调用。

应该调用此方法来指示该适配器的项目组中项目的位置是否已更改。

但是，它从不说明覆盖方法何时应考虑更改位置。这是否意味着该位置与上次调用项目 getItemPosition 时的位置不同？这是否意味着该项目的位置与上次调用 notifyDataSetChanged 不同？或者这是否意味着该项目的位置与该项目添加到 viewPager 时的位置不同？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-20T22:03:20.207

您可以在 ViewPager.java 中看到`getItemPosition`仅在`dataSetChanged`. 这意味着如果项目的位置与上次`dataSetChanged`调用时不同，则它的位置会发生变化。

我不会太担心“改变”的含义；有两种情况：

1.  添加的项目的位置永远不会改变，然后`getItemPosition`返回`POSITION_UNCHANGED`；
2.  项目的位置发生变化，或项目被删除。如果物品位置没有变化，则返回`POSITION_UNCHANGED`或实际位置没有区别。因此，为了保持实现简单，您可以返回位置（或`POSITION_NONE`）并忘记`POSITION_UNCHANGED`..

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-11T23:26:20.213

默认情况下，ViewPager 中项目的位置被认为是固定的；这就是为什么`getItemPosition()`默认返回`POSITION_UNCHANGED`. 当你移动一个项目时，ViewPager 必须知道在哪里移除一个项目（项目的旧位置）以及在哪里添加它。这就是`getItemPosition()`用途。它允许您告诉 ViewPager 将哪个项目放在哪里，即使在您的页面已经实例化之后也是如此。

`getItemPosition()`仅在您调用`notifyDataSetChanged()`PagerAdapter 时调用。通过设计，这意味着“更改”意味着“从 ViewPager 上次填充其页面时发生更改”，因为这`notifyDataSetChanged()`会导致 ViewPager 在必要时重新绘制其子项。换句话说：“改变”具有您提到的任何一种含义；以最近发生的为准。

我认为`getItemPosition`没有样本很难理解。[在此处](https://stackoverflow.com/a/14822077/710990)[查看我的使用示例`getItemPosition(...)`](https://stackoverflow.com/a/14822077/710990)；我想它会澄清一些事情。

# php - PHP preg_match 混淆

> ID：10728081
> 
> 赞同：1
> 
> 时间：2012-05-23T21:25:40.777
> 
> 标签：php, regex

我有一个像这样的字符串：

```
$string = '"lorem ipsum","dolor, sit","amet"'; 
```

我正在尝试使用 EXPLODE 和 preg_match 来将“ .. ”中的每个元素单独作为一个字符串，将原始字符串呈现为一个数组。

最终会给我；

```
$array[0] = 'lorem ipsum';
$array[1] = 'dolor, sit';
$array[2] = 'amet'; 
```

一些字符串之间包含逗号，所以我尝试爆炸以将它们分开，然后替换或 preg_matching 以在“..”之间提取失败。

我怎样才能达到预期的目标？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:29:03.240

此代码应迭代地将您的字符串解析为其组件：

```
$array = array();
while (preg_match('/^"([^"]*)"(?:,(.*)|$)/', $string, $match)) {
    $array[] = $match[1];
    $string = @$match[2];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:33:40.663

您应该用专门为此制作的功能替换您的功能组合[`str_getcsv`](http://www.php.net/manual/en/function.str-getcsv.php)：

```
$array = str_getcsv($string, ',', '"'); 
```

（为清楚起见添加了选项）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:33:37.180

您正在寻找的是`preg_split`：

```
$string = preg_split("/,[^\s+]/", '"lorem ipsum","dolor, sit","amet"');
print_r($string); 
```

>

```
Array
(
    [0] => "lorem ipsum"
    [1] => dolor, sit"
    [2] => amet"
) 
```

# ms-access - 转到下一条记录时刷新未绑定的文本框

> ID：10728082
> 
> 赞同：1
> 
> 时间：2012-05-23T21:25:48.770
> 
> 标签：ms-access

我有一个带有几个未绑定文本框的绑定表单。当整个表单转到下一条记录时，如何刷新或设置默认值？谢谢！（VBA 可接受）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:52:09.937

只需为 Form_Current 事件添加处理程序：

```
Private Sub Form_Current()    
Dim default_value As String

default_value = "0"    
Me.YourUnboundTextBox = default_value

End Sub 
```

# php - 从文件大小和总下载次数获取总下载带宽

> ID：10728083
> 
> 赞同：0
> 
> 时间：2012-05-23T21:25:51.180
> 
> 标签：php, mysql, codeigniter

我有一个`files`包含这些属性的表：

```
f_id, s_id, u_id, name, size, downloads, uploaded 
```

我希望我的用户帐户页面显示用户上传的总带宽。为此，我需要获取每个用户上传的大小，然后*它的下载量，然后将所有结果相加。

最初我得到的是用户的总文件大小，然后是他们的总下载量，但显然这不准确。这是我的查询示例：

```
$sql = 'SELECT SUM(downloads)
        AS downloads
        FROM `files`
        WHERE u_id = (SELECT u_id FROM `users` WHERE username = ? LIMIT 1)
        LIMIT 1'; 
```

我怎样才能做到这一点？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:33:29.037

```
SELECT SUM(size*downloads) AS bandwidth
FROM files f
   JOIN users u
      ON f.u_id = u.u_id
WHERE u.username = ?
GROUP BY u.u_id 
```

这将为您提供一个数字，代表用户上传产生的带宽

# vb.net - 如何使用带有旋转和变换路径的 IsVisible 进行鼠标命中测试

> ID：10728084
> 
> 赞同：2
> 
> 时间：2012-05-23T21:25:52.123
> 
> 标签：vb.net, winforms, mouse, gdi+, hittest

我正在使用 GDI+ 绘制可缩放矢量图形，我需要在 mousemove 上进行测试。我见过的所有示例都使用模型空间 = 世界空间，没有变换。这是问题的简化示例：

```
Imports System.Drawing.Drawing2D

Public Class Form1

  Private myrect As New GraphicsPath

  Protected Overrides Sub OnPaint(ByVal e As System.Windows.Forms.PaintEventArgs)

    ' The rectangle's centre is at 30,10\. Move to origin to rotate
    e.Graphics.TranslateTransform(-30, -10, Drawing2D.MatrixOrder.Append)
    e.Graphics.RotateTransform(45, Drawing2D.MatrixOrder.Append)

    ' Move it back, 50x50 away from the origin 
    ' (80,60 because we moved -30,-10 to rotate)
    e.Graphics.TranslateTransform(80, 60, Drawing2D.MatrixOrder.Append)
    e.Graphics.DrawPath(New Pen(Brushes.Black, 2), myrect)

    ' ...loads more painting, many paths, many varying transformations

  End Sub

  Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) _
    Handles Me.Load

    ' Make a rectangle 60x20 with top-left corner at the origin
    myrect.AddLine(0, 0, 60, 0)
    myrect.AddLine(60, 0, 60, 20)
    myrect.AddLine(60, 20, 0, 20)
    myrect.CloseFigure()

    ' ...loads more shapes created here

  End Sub

  Private Sub Form1_MouseMove(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles Me.MouseMove

    ' Pretend that all the drawing stuff above happened some unspecified time ago, 
    ' in different assembly, written by a martian, in some other vile language.
    ' Obviously, his "e.graphics" has long since been garbage-collected.
    If myrect.IsVisible(e.Location) Then
        ' Works when moving over the path at the origin, ignores transforms.
        Debug.WriteLine("Over the rectangle at " & e.Location.ToString)
    End If

  End Sub

End Class 
```

哪个产生（鼠标以红色移动） ![在此处输入图像描述](../Images/375c71ade6d17ac54fbb0dd1c4735729.png)

IsVisible 在原点附近开始，矩形在变换**之前。**

我知道如果我有在 OnPaint 中使用的图形，我可以用它来测试变换，但黄金法则是“永远不要保存图形”。

任何建议都将受到欢迎。

* * *

验尸：为了记录，这是文森特答案的实现，效果很好：

```
Imports System.Drawing.Drawing2D

Public Class Form1

  Private myrect As New GraphicsPath
  Private mytransform As Matrix

  Protected Overrides Sub OnPaint(ByVal e As System.Windows.Forms.PaintEventArgs)

    ' The rectangle's centre is at 30,10\. Move to origin to rotate
    e.Graphics.TranslateTransform(-30, -10, Drawing2D.MatrixOrder.Append)
    e.Graphics.RotateTransform(45, Drawing2D.MatrixOrder.Append)

    ' Move it back, 50x50 away from the origin 
    ' (80,60 because we moved -30,-10 to rotate)
    e.Graphics.TranslateTransform(80, 60, Drawing2D.MatrixOrder.Append)
    e.Graphics.DrawPath(New Pen(Brushes.Black, 2), myrect)
    mytransform = e.Graphics.Transform

    ' ...loads more painting, many paths, many varying transformations

  End Sub

  Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) _
    Handles Me.Load

    ' Make a rectangle 60x20 with top-left corner at the origin
    myrect.AddLine(0, 0, 60, 0)
    myrect.AddLine(60, 0, 60, 20)
    myrect.AddLine(60, 20, 0, 20)
    myrect.CloseFigure()

    ' ...loads more shapes created here

  End Sub

  Private Sub Form1_MouseMove(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles Me.MouseMove

    mytransform.Invert()
    Dim mouseat() As Point = {e.Location}
    mytransform.TransformPoints(mouseat)
    If myrect.IsVisible(mouseat(0)) Then
        ' Works when moving over the path at the origin, ignores transforms.
        Debug.WriteLine("Over the rectangle at " & e.Location.ToString)
    End If

  End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T01:41:52.263

ScaleTransform 和 TranslateTransform 方法更改 Graphics.Matrix 属性。您想保留它，将相同的变换应用于鼠标位置将*非常方便。*由于您将变换应用于单个形状，因此您希望存储每个形状的矩阵。

Matrix.TransformPoints() 然后解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T00:42:26.113

保存图形对象的世界变换矩阵（Graphics.Transform），反转它（所以它从页面坐标到世界坐标 - 我认为在这种情况下页面坐标等于设备坐标，但如果不是，你将不得不做更多的工作考虑缩放），并在进行命中测试之前使用它来转换您的点。

编辑：您还可以将用于构建世界变换的 OnPaint 中的逻辑分解为不需要 Graphics 对象并返回 Matrix 的单独方法，然后您可以将其与 Graphics.MultiplyTransform 一起使用或反转并用于修改您的输入坐标。

# javascript - 使用常规 javascript 检测 Jquery，如果不存在，则动态加载它

> ID：10728089
> 
> 赞同：4
> 
> 时间：2012-05-23T21:26:08.357
> 
> 标签：javascript, jquery, html

我需要代码来使用常规 javascript 来检测是否存在 JQuery，如果不存在，则从谷歌或其他网站加载 JQuery 文件

更新两个工作解决方案（只需在此处复制和粘贴工作代码）：

来自克劳迪奥·雷迪

```
window.jQuery || document.write("<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'>\x3C/script>") 
```

从罗伯达尔文

```
var jQueryScriptOutputted = false;
function initJQuery() {
    if (typeof(jQuery) == 'undefined') {
        if (! jQueryScriptOutputted) {
            jQueryScriptOutputted = true;
            document.write("<scr" + "ipt type=\"text/javascript\" src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js\"></scr" + "ipt>");
        }
        setTimeout("initJQuery()", 50);
    }
}
initJQuery(); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-23T21:35:11.993

有很多方法，我最喜欢这个只是因为它不那么冗长

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>  
<script>window.jQuery || 
    document.write("<script src='js/jquery-1.7.2.min.js'>\x3C/script>")
</script> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-23T22:05:29.327

不使用加载 jQuery的*好*`document.write`方法是：

```
if (window.jQuery === undefined) {
    var s = document.createElement('script');
    s.src = "//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js";
    document.head.appendChild(s);
} 
```

但是，这将导致异步加载 - 因此您可能希望包含一个`.onload`处理程序以允许执行等待加载完成。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T21:28:36.723

像[这样](http://weblogs.asp.net/joelvarty/archive/2009/05/07/load-jquery-dynamically.aspx)的东西应该工作。

编辑：从上面的链接添加的代码。

```
var jQueryScriptOutputted = false;
function initJQuery() {

    //if the jQuery object isn't available
    if (typeof(jQuery) == 'undefined') {

        if (! jQueryScriptOutputted) {
            //only output the script once..
            jQueryScriptOutputted = true;

            //output the script (load it from google api)
            document.write("<scr" + "ipt type=\"text/javascript\" src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></scr" + "ipt>");
        }
        setTimeout("initJQuery()", 50);
    } else {

        $(function() {  
            //do anything that needs to be done on document.ready
        });
    }

}
initJQuery(); 
```

# java - 如何使用正则表达式获取此 URL 参数

> ID：10728093
> 
> 赞同：1
> 
> 时间：2012-05-23T21:26:17.797
> 
> 标签：java, regex

```
String url = "mysite.com/index.php?name=john&id=432" 
```

如何提取 id 参数（432）？

它可以在 url 中的任何位置，并且 id 的长度也不同

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T21:37:49.100

您可以使用HttpClient[包](http://hc.apache.org/httpcomponents-client-ga/)中的 Apache [URLEncodedUtils ：](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/utils/URLEncodedUtils.html)

```
import org.apache.http.NameValuePair;
import org.apache.http.client.utils.URLEncodedUtils;
import java.nio.charset.Charset;
import java.util.List;

public class UrlParsing {
    public static void main(String[] a){
        String url="http://mysite.com/index.php?name=john&id=42";
        List<NameValuePair> args= URLEncodedUtils.parse(url, Charset.defaultCharset());
        for (NameValuePair arg:args)
            if (arg.getName().equals("id"))
                System.out.println(arg.getValue());
    }
} 
```

这将 42 打印到控制台。

如果您将 url 存储在 URI 对象中，您可能会发现 URLEncodedUtils.parse 的重载非常有用，它直接接受 URI 实例。如果您使用此重载版本，则必须将字符集作为字符串提供：

```
URI uri = URI.create("http://mysite.com/index.php?name=john&id=42");
List<NameValuePair> args= URLEncodedUtils.parse(uri, "UTF-8"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T05:02:03.553

我只是给出一个抽象的正则表达式。`id`之后添加您不想要的任何内容`[^&`

```
Pattern pattern = Pattern.compile("id=([^&]*?)$|id=([^&]*?)&");

Matcher matcher = pattern.matcher(url);

if (matcher.matches()) {
    int idg1   = Integer.parseInt(matcher.group(1));
    int idg2   = Integer.parseInt(matcher.group(2));
} 
```

要么 要么`idg1`有价值`idg2`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:28:12.750

您可以使用：

```
String id = url.replaceAll("^.*?(?:\\?|&)id=(\\d+)(?:&|$).*$", "$1"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T23:15:46.040

正则表达式已经给出，但您也可以通过一些简单的拆分来做到这一点：

```
public static String getId(String url) {
        String[] params = url.split("\\?");
        if(params.length==2) {
                String[] keyValuePairs = params[1].split("&");
                for(String kvp : keyValuePairs) {
                        String[] kv = kvp.split("=");
                        if(kv[0].equals("id")) {
                                return kv[1];
                        }
                }
        }
        throw new IllegalStateException("id not found");
} 
```

# ruby - Ruby：更新到 ruby 1.9 后出现“NoMethodError”

> ID：10728095
> 
> 赞同：0
> 
> 时间：2012-05-23T21:26:30.730
> 
> 标签：ruby, ruby-1.8

我知道这个问题可能看起来非常具体，但我正在尝试更新一些脚本以在 ruby​​ 1.9 上运行并且不止一次遇到这个非常相似的错误。我正在尝试在这里运行此代码：http: [//x.gfax.ch/Archives/Scripts/boggle.rb](http://x.gfax.ch/Archives/Scripts/boggle.rb)但陷入：

```
def Dict.to_n(ch)
    ch[0]-'a'[0]
end 
```

在 ruby​​1.8 中，这会生成一个随机的 NxN boggle board，然后查找并输出它可以在其中找到的所有单词。然而，在 ruby​​1.9 中，解释器给了我这样的信息：

```
boggle.rb:182:in `to_n': undefined method `-' for "a":String (NoMethodError) 
```

我的语法有什么问题？（如果您需要一个字典文件来使用脚本，我正在使用本示例页面底部给出的一个：http: [//learnruby.com/boggle/index.shtml](http://learnruby.com/boggle/index.shtml)）提前感谢您的任何指导.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:34:36.480

在 Ruby 1.9 中，该方法[`String#[]`](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-5B-5D)返回一个字符串，而在 Ruby 1.8 中，它返回一个数值。（参见[此处](http://ruby-doc.org/core-1.8.7/String.html#method-i-5B-5D)）您可以考虑`String#chars`改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T01:27:30.727

您可能想尝试这样的事情：

```
 def Dict.to_n(ch)
    if ch.respond_to? :codepoints #1.9+
      ch.codepoints.first - 'a'.codepoints.first
    else
      ch[0]-'a'[0]
    end
  end 
```

# git - 我在哪里可以报告 git 错误

> ID：10728104
> 
> 赞同：40
> 
> 时间：2012-05-23T21:26:52.680
> 
> 标签：git

我正在尝试使用`mailmap.file`git 的配置选项。然而，路径不是 shell 扩展的，这意味着我不能写`$HOME/.mailmap`or `~/.mailmap`。[如果你正在将你的点文件与类似homesick](https://github.com/technicalpickles/homesick)的东西同步，并且在 Windows、OS X 和 Linux 上使用相同的 .gitconfig，这会很烦人。

我找不到任何 git 的 bugtracker，我不想用类似的东西向 git 邮件列表发送垃圾邮件。我应该如何报告这个错误/轻微的烦恼？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-24T07:45:39.513

正如[代码 google`git-core`](http://code.google.com/p/git-core/)中提到的（以及[Charles Bailey](https://stackoverflow.com/users/19563/charles-bailey)在评论中提到的，它指向[git-scm 社区页面](http://git-scm.com/community)）：

> 可以使用电子邮件地址 git@vger.kernel.org 将 Git 社区的问题或评论发送到邮件列表。错误报告应发送至此邮件列表。

（[邮件列表存档在这里](https://lore.kernel.org/git/)）

2020 年第二季度更新，您现在有一个实际的**`git bugreport`**命令（见下文末尾）

2015 年更新：最新的参考仍然是[Git 社区页面](https://git-scm.com/community)，正如[smoothgrips](https://stackoverflow.com/users/2299992/smoothgrips)[在评论](https://stackoverflow.com/questions/10728104/where-can-i-report-a-git-bug/10733251#comment49628226_10733251)中指出的那样，它提到：

> **您无需订阅**：您将在回复中被抄送。
> 回复时请保持抄送列表完整（使用“全部回复”）。
> 灰名单可能会将您的第一篇帖子延迟几个小时。

请注意，邮件服务器将拒绝带有“永久失败”消息的 HTML 消息，因此请使用纯文本。

社区页面还指出“[如何有效地报告错误](http://www.chiark.greenend.org.uk/%7Esgtatham/bugs.html)”...

如果您想**贡献补丁**，请立即前往[**`rtyley/submitgit`**](https://github.com/rtyley/submitgit)，它可以帮助您遵循[补丁提交流程](https://github.com/git/git/blob/1eb0545c/Documentation/SubmittingPatches#L120-L464)：

> 如果您在 上创建拉取请求`github.com/git/git/`，`submitGit`可以将其发送到您的邮件列表，正确格式化补丁。
> 讨论停留在原处——在列表中——但至少第一步要容易一些。

2015 年更新：Git For Windows 现在[位于 GitHub ( `github.com/git-for-windows`)](https://github.com/git-for-windows)上，并生成*最新*版本：2.4.2+。
**[Msysgit 被淘汰](https://stackoverflow.com/a/784743/6309)**，使用[msys2 64-bits](https://stackoverflow.com/a/17810334/6309)，并导致[`git-for-windows.github.io`](http://git-for-windows.github.io)而不是旧的和现在过时的[msysgit.github.io](http://msysgit.github.io)。

GitHub 镜像仓库镜像[git/git](https://github.com/git/git)在那里，但不幸的是，它不能用于问题或拉取请求。

* * *

2019 年更新：`submitGit`有一个替代方案：（**[`GitGitGadget`](https://github.com/gitgitgadget/gitgitgadget)**）[`gitgitgadget.github.io`](https://gitgitgadget.github.io/)，在 Git 2.22（2019 年第二季度）中提到

请参阅[Jeff King ( ) 的](https://github.com/peff)[commit c3a7dd7](https://github.com/git/git/commit/c3a7dd70c4affe376b2d1ecc1a1a38f1aca0c52d)（2019 年 3 月 12 日[）](https://github.com/peff)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 2d33728](https://github.com/git/git/commit/2d3372883f133ef64d3eb678e8e6bfc6ffc6169a))^(中，2019 年 4 月 9 日）)[`peff`](https://github.com/peff)
^([`gitster`](https://github.com/gitster))

> ## 将拉取请求者指向**`GitGitGadget`**

> 在 GitHub 上打开拉取请求的人看到的贡献指南和 PR 模板中，我们提到了该`submitGit`工具，它提供了一种解决邮件列表的替代方法。
> 这些天我们也有类似的**`GitGitGadget`**工具，我们应该明确表示这也是一种选择。
> 
> 我们可以继续提及*这两种*工具，但最好选择其中一种，以免用户选择过多。
> 毕竟，这里的目的之一是减少首次或不经常贡献者的摩擦。
> 
> 有几个理由更喜欢`GGG`：
> 
> 1.  `submitGit`似乎仍然有一些粗糙的边缘。例如，它不会使用时间戳来帮助线程式邮件阅读器处理乱序交付。
> 2.  主观`GGG`上，这些天似乎在列表中更常用，尤其是列表常客。
> 3.  `GGG`似乎处于更积极的发展中（可能与第 2 点有关）。
> 
> 所以让我们实际换掉`submitGit`. 当我们在那里时，让我们在 PR 模板中放置另一个指向该页面的链接，因为这是第一次学习它的用户想要去的地方。阅读更多。**`GGG`**
> `GGG`

* * *

在 Git 2.25（2020 年第一季度）中，有一个关于对象枚举的教程，它提供了一个关于如何贡献/测试/报告错误的好例子。

请参阅[Emily Shaffer ( ) 的](https://github.com/nasamuffin)[提交 e0479fa](https://github.com/git/git/commit/e0479fa07387a7f84dad04a258cd2dc2861c9df9)（2019 年 10 月 11 日[）](https://github.com/nasamuffin)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 15d9f3d](https://github.com/git/git/commit/15d9f3dc6642497b1186e943cdccba3a8f9f0b0e))^(中，2019 年 11 月 10 日）)[`nasamuffin`](https://github.com/nasamuffin)
^([`gitster`](https://github.com/gitster))

> ## [`documentation`](https://github.com/git/git/commit/e0479fa07387a7f84dad04a258cd2dc2861c9df9): 添加物体行走教程
> 
> ^(签字人：Emily Shaffer)
> ^(帮助人：Eric Sunshine)

> 现有的关于**对象遍历**的文档似乎主要是为那些已经熟悉该过程的人提供参考。
> 本教程试图为几个基本的对象遍历提供入门级指南，以便新的 Git 贡献者可以学习这些概念，而不必费力地通过选项解析或特殊的大小写。
> 
> 目标受众是刚开始接触对象行走概念的 Git 贡献者。
> 目标是让这个贡献者准备好能够更容易地理解和修改执行修订游走的现有命令，尽管它也将使贡献者准备好创建执行游走的新命令。
> 
> 本教程涵盖了对象遍历过程中涉及的结构的基本概述、设置基本提交遍历、设置基本全对象遍历以及为两种遍历类型添加一些配置更改。
> 它故意不包括如何创建新命令或从命令行或 gitconfigs 搜索选项。
> 
> 在[https://github.com/nasamuffin/git/tree/revwalk](https://github.com/nasamuffin/git/tree/revwalk)有一个相关的补丁集，其中包含本教程生成的代码的参考实现。

注意：该教程已在 Git 2.27（2020 年第二季度）中进行了修改：

请参阅[Johannes Schindelin ( ) 的](https://github.com/dscho)[提交 e3f53ce](https://github.com/git/git/commit/e3f53ce5bddc9bc58de32ec435a8695000ad9fe6)（2020 年 3 月 28 日[）](https://github.com/dscho)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 7780604](https://github.com/git/git/commit/7780604ac200b763af71efba0eb7c880f39fd152))^(中，2020 年 4 月 22 日）)[`dscho`](https://github.com/dscho)
^([`gitster`](https://github.com/gitster))

> ## [`MyFirstObjectWalk`](https://github.com/git/git/commit/e3f53ce5bddc9bc58de32ec435a8695000ad9fe6): 删除不必要的条件语句
> 
> ^(签字人：Johannes Schindelin)
> ^(审核人：Emily Shaffer)

> 在给定的示例中，`commit`cannot be `NULL`（因为这是循环条件：如果是`NULL`，则根本不会输入循环体）。这个开发人员花了一两分钟才发现这是死代码。
> 
> 让我们删除它，以免让未来的读者感到困惑。

* * *

Git 2.25（2020 年第一季度）记录**了 GitGitGadget**。

请参阅[Emily Shaffer ( ) 的](https://github.com/nasamuffin)[commit 3c8d754](https://github.com/git/git/commit/3c8d754c4b7123e57febdcf95330a073c8eeec7e)、[commit 3ada78d](https://github.com/git/git/commit/3ada78de3f8dbe2b0a2b67cade25d29a86f734c3)、[commit 4ed5562](https://github.com/git/git/commit/4ed5562925539ef76b6e4b2002b98a8e734cf223)（2019 年 10 月 31 日[）](https://github.com/nasamuffin)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 f089ddd](https://github.com/git/git/commit/f089ddd56a437eea6cd1ddc4a77f27e130cc23ea))^(中，2019 年 12 月 1 日）)[`nasamuffin`](https://github.com/nasamuffin)
^([`gitster`](https://github.com/gitster))

> ## [`myfirstcontrib`](https://github.com/git/git/commit/3c8d754c4b7123e57febdcf95330a073c8eeec7e): 提示找到 gitgitgadget 允许器
> 
> ^(签字人：Emily Shaffer)

> **GitGitGadget 是一种方便的工具，用于将针对 Git 的拉取请求转换为 Git-mailing-list-friendly-patch-emails**，作为反垃圾邮件，所有新用户都必须`/allow`由现有用户“编辑”一次，然后才能为新用户执行任何操作用户。
> 
> 虽然本教程解释了该机制，但它并没有提供太多关于如何寻找允许新拉取请求的人的提示。
> 因此，请教我们的新 GitGitGadget 用户在哪里寻找可以将他们的名字添加到列表中的人。
> 
> 此补丁中的建议基于为 GitGitGadget 提出的建议：[`gitgitgadget/gitgitgadget`PR 138](https://github.com/gitgitgadget/gitgitgadget/pull/138)

* * *

在 Git 2.25（2020 年第一季度）中，邮件列表归档和 nntp 服务的文档更新。

请参阅[Jeff King ( ) 的](https://github.com/peff)[提交 3eae30e](https://github.com/git/git/commit/3eae30e4649dd3174fdce7a92115c972763baa5b)和[提交 46c6749](https://github.com/git/git/commit/46c67492aa3ab2779f9322790ca8fffcd5bfaa80)（2019 年 11 月 27 日[）](https://github.com/peff)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 3b3d9ea](https://github.com/git/git/commit/3b3d9ea6a8fbf36a8710b855062c685d9a7d33e3))^(中，2019 年 12 月 6 日）)[`peff`](https://github.com/peff)
^([`gitster`](https://github.com/gitster))

> ## [`doc`](https://github.com/git/git/commit/3eae30e4649dd3174fdce7a92115c972763baa5b): 用 lore.kernel.org 替换公共收件箱链接
> 
> ^(签字人：杰夫·金)

> 由于我们现在正在推荐**`lore.kernel.org`**（并且因为该`public-inbox.org`域最终可能会消失），所以让我们更新我们的内部引用以使用它，也是。
> 这为我们的参考提供了面向未来的证明，并树立了我们希望人们效仿的榜样。

请参阅“[此列表现在也存档于**`lore.kernel.org/git`**](https://lore.kernel.org/git/20191120195556.GA25189@dcvr/)”

> ## [`doc`](https://github.com/git/git/commit/dcee0372287ec8dff534919b0f4824b58cefd5ce): 用 lore.kernel.org 替换 MARC 链接
> 
> ^(签字人：Denton Liu)

> 由于我们现在推荐 lore.kernel.org，请将 marc.info 链接替换为 lore.kernel.org。
> 
> 尽管 MARC 已经存在了很长时间，但没有什么是永恒的（参见 Gmane）。
> 由于 MARC 使用不透明的消息标识符，切换到 lore.kernel.org 应该是一个严格的改进，因为即使 lore.kernel.org 出现故障，Message-ID 也将允许未来的读者在任何其他存档中查找引用的消息。
> 
> 我们在其中留下了一个对 MARC 的引用，`README.md`因为它是供个人阅读的完美邮件存档，而不是用于链接未来的邮件。

和：

> ## [`RelNotes`](https://github.com/git/git/commit/d23f9c8e041d4b5f809f205645e866ff9663809e): 用真实的 Message-ID 替换 Gmane
> 
> ^(签字人：Denton Liu)

> 剩下的对 Gmane 的唯一引用是在 RelNotes 中。
> 尽管这些肯定没有被积极使用，但它们可能对未来的读者具有历史意义，因此让我们确保邮件引用更加健壮。
> 
> 将指向 Gmane 的链接替换为指向`lore.kernel.org`（这是我们新的首选邮件列表存档并在 URL 中具有 Message-ID）的链接，并将 Gmane ID 引用替换为 Message-ID。
> 
> [通过在https://public-inbox.org/git/](https://public-inbox.org/git/)上搜索“ `gmane:<id>`”并获取结果消息，可以找到消息 ID。

关于`lkml.org`：

> ## [`doc`](https://github.com/git/git/commit/14b7664df8465f925eb08f10f0344477e7915641): 用 lore.kernel.org 替换 LKML 链接
> 
> ^(签字人：Denton Liu)

> 由于我们现在推荐 lore.kernel.org，请将 LKML 链接替换为 lore.kernel.org。
> 
> 虽然 LKML 已经存在了很长时间，但没有什么是永恒的（参见 Gmane）。
> 由于 LKML 使用不透明的消息标识符，因此切换到`lore.kernel.org`应该是一个严格的改进，因为即使`lore.kernel.org`出现故障，Message-ID 也将允许未来的读者在任何其他存档中查找引用的消息。

* * *

使用 Git 2.26（2020 年第一季度），为**新贡献者提供**了更多文档。

请参阅[Emily Shaffer ( ) 的提交](https://github.com/nasamuffin)[a2dc434](https://github.com/git/git/commit/a2dc43414c2ab480a923b1f8afdb61e005e97ef6) （ 2020 年 2 月 14 日）和[提交 4bb4fd4](https://github.com/git/git/commit/4bb4fd429089dd97a268ddfab42d36432b53de21)（2020 年 1 月 24 日[）](https://github.com/nasamuffin)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 325eb66](https://github.com/git/git/commit/325eb6683087bff0fb63f75032c356001fbabf3c))^(中，2020 年 2 月 25 日）)[`nasamuffin`](https://github.com/nasamuffin)
^([`gitster`](https://github.com/gitster))

> ## [`MyFirstContribution`](https://github.com/git/git/commit/4bb4fd429089dd97a268ddfab42d36432b53de21): 添加获取帮助的途径
> 
> ^(签字人：Emily Shaffer)

> 通过[https://lore.kernel.org/git/20191114194708.GD60198@google.com/](https://lore.kernel.org/git/20191114194708.GD60198@google.com/)，我们现在有一个指导邮件列表，我们应该将有问题的新贡献者引导到该列表。
> 
> Mention [`#git-devel`](https://webchat.freenode.net/#git-devel)，这是针对 Git 贡献者的；寻求帮助以共同获得第一个贡献是该频道的主题。还要提到一些约定，以防人们不熟悉 IRC。
> 
> 因为导师列表和`#git-devel`都是 Git 贡献者的子集，所以最后列出[主要的 Git 列表](https://public-inbox.org/git/)并提及一些发布约定。

和：

> ## [`MyFirstContribution`](https://github.com/git/git/commit/a2dc43414c2ab480a923b1f8afdb61e005e97ef6): 改写联系方式
> 
> ^(签字人：Emily Shaffer)
> ^(审核人：Jonathan Nieder)

> 尽量不要阻止新用户向 git@vger.kernel.org 发送问题，并解释指导列表与主列表对比的目的。

* * *

对于 Git 2.27（2020 年第二季度），在报告错误之前，请阅读（新）常见问题解答。

请参阅[brian m的](https://github.com/bk2204)[提交 2149b67](https://github.com/git/git/commit/2149b6748f478badf1e19a8f11190837b2dccb6b)（2020 年 3 月 30 日） 。[卡尔森 ( `bk2204`)](https://github.com/bk2204) .
^(（由[Junio C Hamano 合并 -- `gitster`--](https://github.com/gitster)在[06aaafb 提交中](https://github.com/git/git/commit/06aaafbd82aaf845d85c0f8eea78c52f1219187c)，2020 年 4 月 22 日）)

> ## [`docs`](https://github.com/git/git/commit/2149b6748f478badf1e19a8f11190837b2dccb6b): 添加常见问题
> 
> ^(签字人：brian m. 卡尔森)

> Git 是一个非常灵活和强大的软件。
> 
> 但是，对于许多用户来说，它可能会令人生畏，并且有一组用户经常问的常见问题。
> 
> 虽然我们已经有了一些新的用户文档，但值得添加一个常见问题解答来解决用户经常遇到的常见问题。
> 
> 尽管其中一些在文档的其他地方有所提及，但经验表明用户很难找到，因此集中位置很有帮助。
> 
> 添加这样的常见问题解答并填写一些常见问题和答案。虽然现在条目很少，但我们可以在将来扩展它以涵盖更多内容，因为我们会发现用户提出的新问题。
> 
> FAQ 还解决了常见的配置问题，这些问题不仅适用于作为独立软件的 Git，还适用于人们使用的 CI 工具和托管服务提供商的生态系统，因为这些是常见问题的来源。

* * *

使用 Git 2.27（2020 年第二季度），您可以使用“**错误报告**”工具。

请参阅[Emily Shaffer ( ) 的提交](https://github.com/nasamuffin)[8f0e984](https://github.com/git/git/commit/8f0e9843bdf82b04591416367bee3817991e0722) （ 2020 年 4 月 27 日）和[提交 69bcbbc](https://github.com/git/git/commit/69bcbbceb74904e4f0f5001453072a34e3fed740)、[提交 1411914](https://github.com/git/git/commit/1411914a1cbd6f5680e33db9817a1aecb01f8817)、[提交 617d571](https://github.com/git/git/commit/617d57195ae844a43486b2e0ad0b7ac36aaddfdd)、[提交 238b439](https://github.com/git/git/commit/238b439d69890980dafc5154895d425cb4cf4a5e)、[提交 709df95](https://github.com/git/git/commit/709df95b788990472775a63e8b15af3ddd0c822e)（2020 年 4 月 16 日[）](https://github.com/nasamuffin)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([dd094c2 提交中](https://github.com/git/git/commit/dd094c2b75401f6e1e53e7a5bbfca3c66c44f556))^(，2020 年 5 月 1 日）)[`nasamuffin`](https://github.com/nasamuffin)
^([`gitster`](https://github.com/gitster))

> ## [`bugreport`](https://github.com/git/git/commit/238b439d69890980dafc5154895d425cb4cf4a5e)：添加工具以生成调试信息
> 
> ^(签字人：Emily Shaffer)

> 教 Git 如何提示用户提供良好的错误报告：重现步骤、预期行为和实际行为。稍后，Git 可以学习如何从存储库中收集一些诊断信息。
> 
> 如果用户可以向我们发送一份写得很好的错误报告，其中包含我们需要向用户询问的诊断信息，我们可以减少报告者和 Git 贡献者之间的问答往返次数。
> 
> 如果用户将他们的存储库置于他们感到困惑的状态，他们也可能希望将这样的报告发送给他们当地的“Git 专家”。

[`git bugreport`文档](https://github.com/git/git/blob/238b439d69890980dafc5154895d425cb4cf4a5e/Documentation/git-bugreport.txt)包括：

> ```
> git bugreport [(-o | --output-directory) <path>] [(-s | --suffix) <format>] 
> ```

> ### 描述

> 将有关用户机器、Git 客户端和存储库状态的信息以及请求有关用户观察到的行为的信息的表单捕获到单个文本文件中，然后用户可以按顺序共享该文本文件，例如 Git 邮件列表报告观察到的错误。
> 
> 要求用户提供以下信息：
> 
> *   复制步骤
> *   预期行为
> *   实际行为

* * *

在 Git 2.27（2020 年第二季度）中，“ `git bugreport`”学会了报告存储库中启用的钩子。

请参阅[Emily Shaffer ( ) 的](https://github.com/nasamuffin)[提交 788a776](https://github.com/git/git/commit/788a776069bffcbb7d0dd9b70d521826f97285b7)（2020 年 5 月 8 日[）](https://github.com/nasamuffin)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 3583730](https://github.com/git/git/commit/35837307586a92c0d510392c2ee66b82fa66d5b5))^(中，2020 年 5 月 14 日）)[`nasamuffin`](https://github.com/nasamuffin)
^([`gitster`](https://github.com/gitster))

> ## [`bugreport`](https://github.com/git/git/commit/788a776069bffcbb7d0dd9b70d521826f97285b7)：收集已填充的钩子列表
> 
> ^(签字人：Emily Shaffer)

> 有时，用户看到的故障可能与正在运行的特定挂钩有关，而用户可能没有意识到。
> 虽然钩子的内容可能很敏感——包含用户数据或特定于用户组织的进程信息——但只要知道钩子在某个阶段正在运行，就可以帮助我们了解是否出现问题。
> 
> 如果代码中没有明确的钩子名称列表，我们会从文档中编译我们自己的列表。这可能很容易出现比特腐烂，但是对于错误报告工具的这个小改动来说，为可接受的钩子设计一个单一的事实来源是太多的开销。

* * *

在 Git 2.28（2020 年第三季度）中，“ `git bugreport`”学会了报告正在使用的 shell。

请参阅[Emily Shaffer ( ) 的](https://github.com/nasamuffin)[提交 4a4804e](https://github.com/git/git/commit/4a4804edf4d5f96407fc46eda802a3b29d991e33)和[提交 39f4919](https://github.com/git/git/commit/39f4919dc50ff05bcebd0d3c89b718aa2d46bd67)（2020 年 5 月 12 日[）](https://github.com/nasamuffin)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 ce095ec](https://github.com/git/git/commit/ce095ecfe49791508860fc180bf67924d62503ba))^(中，2020 年 6 月 9 日）)[`nasamuffin`](https://github.com/nasamuffin)
^([`gitster`](https://github.com/gitster))

> ## [`help`](https://github.com/git/git/commit/39f4919dc50ff05bcebd0d3c89b718aa2d46bd67): 添加 shell 路径到`--build-options`
> 
> ^(签字人：Emily Shaffer)

> 如果基于 shell 的 Git 命令失败，了解构建 Git 以尝试指向哪个 shell 可能很有用。
> `$SHELL_PATH`在构建期间设置并用于启动联机帮助页查看器以及 by [`git-compat-util.h`](https://github.com/git/git/blob/39f4919dc50ff05bcebd0d3c89b718aa2d46bd67/git-compat-util.h)，并在测试期间使用。
> ' `git version --build-options`' 鼓励在错误报告中使用，因此在此处包含此信息是有意义的。

和：

> ## [`bugreport`](https://github.com/git/git/commit/4a4804edf4d5f96407fc46eda802a3b29d991e33): 包括用户交互外壳
> 
> ^(签字人：Emily Shaffer)

> 用户可能会抱怨 Git 与其交互式 shell 交互的方式，例如自动完成或 shell 提示。在这种情况下，了解他们以交互方式使用哪个 shell 对我们很有用。

* * *

Git 2.30（2021 年第一季度）已经描述了原始贡献者在回复评论评论后使用补丁更新中的解释的期望。

请参阅[Junio C Hamano () 的](https://github.com/gitster)[提交 a6d8d11](https://github.com/git/git/commit/a6d8d1103633f295ce6f738dcd5221389e8d5fd2)（2020 年 11 月 20 日[）](https://github.com/gitster)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 b94b1f9](https://github.com/git/git/commit/b94b1f9af88f4af5edc4e6f34e9ffdeec55ea387))^(中，2020 年 11 月 30 日）)[`gitster`](https://github.com/gitster)
^([`gitster`](https://github.com/gitster))

> ## [`MyFirstContribition`](https://github.com/git/git/commit/a6d8d1103633f295ce6f738dcd5221389e8d5fd2): 回答问题不是故事的结局
> 
> ^(审核人：Emily Shaffer)

> 评论交流可以从评论者开始询问“你在日志消息（或文档中）中的这个短语是什么意思？”，作者回答了它的意思，然后评论者说“啊，这就是你的意思意思是——那么逻辑的流动是有意义的”。
> 
> 但这并不是故事的圆满结局。
> 新的贡献者经常忘记，在上述交流中审查过的材料对于下一个阅读它的人仍然不清楚，直到它得到更新。
> 
> 当我们在附近时，将用于指代审稿人评论的动词“请求”改写为“建议”——这与同一段落后面出现的“原始”和“建议”之间的对比相匹配，更重要的是更清楚地表明，作者并不是要取悦审稿人的意愿，而是审稿人只是在帮助作者完善他们的提交。提出修改建议，感觉原版更好，或者评论

`MyFirstContribution`现在在其[手册页](https://github.com/git/git/blob/a6d8d1103633f295ce6f738dcd5221389e8d5fd2/Documentation/MyFirstContribution.txt#L1150-L1163)中包含：

> 审阅者可能会询问您在补丁集中写了什么，无论是在提议的提交日志消息中还是在更改本身中。您应该在回复消息中回答这些问题，但审阅者询问这些问题以理解您的意图的原因通常是因为您的补丁集需要澄清才能被理解。
> 
> 不要满足于仅仅在你的回复中回答他们的问题，并听到他们说他们现在明白你想说什么了。更新您的补丁以澄清审阅者遇到的问题，并准备您的 v2；您用来解释 v1 以回答审稿人问题的词语可能有用。你的目标是让你的 v2 足够清晰，这样你就没有必要对下一个阅读它的人给出相同的解释。

* * *

`localtime()`在 Git 2.30（2021 年第一季度）中，已删除了不可重入的使用。

请参阅[Taylor Blau ( ) 的](https://github.com/ttaylorr)[提交 4f6460d](https://github.com/git/git/commit/4f6460df55cdccdda9d2a0aad4c6b578c007e01a)（2020 年 11 月 30 日[）](https://github.com/ttaylorr)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 bb48056](https://github.com/git/git/commit/bb48056cb2baafff9f051be872c782ae43c68fe1))^(中，2020 年 12 月 8 日）)[`ttaylorr`](https://github.com/ttaylorr)
^([`gitster`](https://github.com/gitster))

> ## [`builtin/bugreport.c`](https://github.com/git/git/commit/4f6460df55cdccdda9d2a0aad4c6b578c007e01a): 使用线程安全`localtime_r()`
> 
> ^(签字人：Taylor Blau)

> 为了生成它的文件名，' [`git bugreport`](https://github.com/git/git/blob/4f6460df55cdccdda9d2a0aad4c6b578c007e01a/Documentation/git-bugreport.txt)' ^(( [man](https://git-scm.com/docs/git-bugreport) ))内置命令用 ' ' 向系统询问当前时间`localtime()`。
> 由于它使用共享缓冲区，因此它不是线程安全的。
> 
> 即使' [`git bugreport`](https://github.com/git/git/blob/4f6460df55cdccdda9d2a0aad4c6b578c007e01a/Documentation/git-bugreport.txt)' ^(( [man](https://git-scm.com/docs/git-bugreport) ))不是多线程的，使用`localtime()`也会触发一些静态分析工具报错，并且快速
> 
> ```
> $ git grep -oh 'localtime\(_.\)\?' -- **/*.c | sort | uniq -c 
> ```
> 
> 表明线程不安全的“本地时间”的唯一用法是在一个文档中。
> 
> 因此，将此实例转换为使用线程安全版本以保持一致性，并安抚一些分析工具。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-18T11:45:36.313

报告错误的最佳地点通常是邮件列表。您甚至不需要订阅帖子，只需发送电子邮件至：`git@vger.kernel.org`。

[您可以在此处](http://vger.kernel.org/vger-lists.html#git)找到有关邮件列表的更多官方信息。

还要检查：

*   [文档/编码指南](http://git.kernel.org/cgit/git/git.git/plain/Documentation/CodingGuidelines?id=master)
*   [文档/提交补丁](http://git.kernel.org/cgit/git/git.git/plain/Documentation/SubmittingPatches?id=master)
*   [维护者的说明](https://sites.google.com/site/maintnotes/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-11-30T20:53:20.377

用于使用`git bugreport`标准模板撰写电子邮件正文。

Copy-and-paste the generated text file into the email body and send it to git@vger.kernel.org. Be sure to send it as plain text -- HTML will bounce back. (See [https://www.dummies.com/software/other-software/10-useful-gmail-settings/](https://www.dummies.com/software/other-software/10-useful-gmail-settings/) if using GMail).

# objective-c - XCode 监视窗口自定义对象

> ID：10728107
> 
> 赞同：0
> 
> 时间：2012-05-23T21:27:03.147
> 
> 标签：objective-c, xcode, watch

好的 - 我对 XCode 有点陌生，所以如果我的咆哮不合理，请原谅我。

我想要得到的是我们在 Visual Studio 甚至 Eclipse 中拥有的一个简单的监视窗口——人们自然会希望看到对象、它们的属性、输入的表达式等的相关值，但是在 XCode 中我只能看到原始类型。

当你深入一个对象时，你会得到大量的垃圾，比如指针和内存位置——完全没用！

[http://screencast.com/t/ueipLFv8](http://screencast.com/t/ueipLFv8)

我考虑过这是否不提供，因为 Objective C 是一种动态绑定的语言，但这应该不会太难。

有什么方法可以查看对象及其属性值？

# python - 字符串的子序列

> ID：10728108
> 
> 赞同：1
> 
> 时间：2012-05-23T21:27:05.463
> 
> 标签：python

我实现了一个 python 函数，它返回 2 个字符串的最长公共子序列。现在，我想实现一个返回任意数量字符串的最长公共子序列的函数。

我找到了 3 个字符串的帮助：

```
dp[i, j, k] = / 1 + dp[i - 1, j - 1, k - 1] if A[i] = B[j] = C[k]
              \ max(dp[i - 1, j, k], dp[i, j - 1, k], dp[i, j, k - 1]) otherwise 
```

但我真的不明白这个提示。因此，如果有人可以帮助我，我将不胜感激。最好的问候，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:44:01.647

您可以`O(N log(N))`通过执行类似于带有滚动哈希的二进制搜索的操作来及时执行此操作（其中 N 是序列的组合长度）。

请注意，最长可能公共序列的长度是最小序列的长度，`smallestLength`。进行如下操作：

初始化：

*   假设最长公共子序列（我们称之为`a`）的长度为`a`=`smallestLength/2`

算法：

*   `iteration_number += 1`
*   扫描所有列表（如果需要，可以并行！）并执行[滚动哈希](http://en.wikipedia.org/wiki/Rolling_hash)；这将为每个列表生成 len(list)-(a-1) 哈希
*   将所有哈希插入到一个集合数据结构中（每个列表一个集合）以实现 O(1) 查找时间
*   检查是否有任何哈希冲突（取所有集合的交集）：如果有一个或多个冲突，手动确认`a`在这些位置有一个 -length 子序列公共子序列，因为哈希可能是错误的（尽管如果您选择足够精细的哈希，这在实践中永远不会发生）
*   你找到共享序列了吗？
    *   如果找到这样的序列，请重复上述步骤，但增加假定长度，就像在二分搜索中一样（添加`smallestlength/2**iteration_number`）
    *   如果您没有找到这样的序列，请重复上述步骤，但减少假设的长度，就像在二分搜索中一样（减法`smallestlength/2**iteration_number`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:41:38.787

对于无限数量的字符串 n，LCS 问题是 NPComplete。意思是，没有已知的多项式算法能够解决这个问题。也意味着您可以放弃 DP 解决方案：p

这是一个启发式方法的链接，用于近似多个字符串的 LCS。

[http://www.aaai.org/ocs/index.php/AAAI/AAAI10/paper/download/1559/2197](http://www.aaai.org/ocs/index.php/AAAI/AAAI10/paper/download/1559/2197)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-27T20:46:35.607

仅供参考：

```
from difflib import SequenceMatcher

def lcs_of_2(a, b):
    """
    get longest common string
    :param a:
    :param b:
    :return:
    """
    match = SequenceMatcher(None, a, b).find_longest_match(0, len(a), 0, len(b))
    return a[match[0]: match[0] + match[2]]

def lcs_of_list(*args):
    """
    get longest common string of list
    :param args:
    :return:
    """
    if len(args) == 2:
        return lcs_of_2(args[0], args[1])
    first = args[0]
    remains = args[1:]
    return lcs_of_2(first, lcs_of_list(*remains))

if __name__ == '__main__':
    a = 'abcdef'
    b = 'abbbbabcdeffff'
    c = 'bcdefff'
    print(lcs_of_list(a, b, c)) 
```

结果：

```
bcdef 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-18T00:59:15.353

python3中的一个解决方案是：

```
#Uses python3
import sys
def calc_cache_pos(strings, indexes):
    factor = 1
    pos = 0
    for s, i in zip(strings, indexes):
        pos += i * factor
        factor *= len(s)
    return pos

def lcs_back(strings, indexes, cache):
    if -1 in indexes:
        return ""
    match = all(strings[0][indexes[0]] == s[i]
                for s, i in zip(strings, indexes))
    if match:
        new_indexes = [i - 1 for i in indexes]
        result = lcs_back(strings, new_indexes, cache) + strings[0][indexes[0]]
    else:
        substrings = [""] * len(strings)
        for n in range(len(strings)):
            if indexes[n] > 0:
                new_indexes = indexes[:]
                new_indexes[n] -= 1
                cache_pos = calc_cache_pos(strings, new_indexes)
                if cache[cache_pos] is None:
                    substrings[n] = lcs_back(strings, new_indexes, cache)
                else:
                    substrings[n] = cache[cache_pos]
        result = max(substrings, key=len)
    cache[calc_cache_pos(strings, indexes)] = result
    return result

def lcs(strings):
        if len(strings) == 0:
        return ""
    elif len(strings) == 1:
        return strings[0]
    else:
        cache_size = 1
        for s in strings:
            cache_size *= len(s)
        cache = [None] * cache_size
        indexes = [len(s) - 1 for s in strings]
        return (lcs_back(strings, indexes, cache))
if __name__ == '__main__':
    input = sys.stdin.read()
    data = list(map(int, input.split()))
    an = data[0]
    data = data[1:]
    a1 = data[:an]
    data = data[an:]
    bn = data[0]
    data = data[1:]
    b1 = data[:bn]
    data = data[bn:]
    cn = data[0]
    data = data[1:]
    c1 = data[:cn]
    a = ''
    for i in a1:
        a = a + i
    b = ''
    for i in b1:
        b = b + i
    c = ''
    for i in c1:
        c = c + i
    print(lcs([a, b, c])) 
```

这会读取 3+ 个数组的输入，每个字符后跟一个空格。**在每个数组之前输入数组的大小。**输入将是

**输入**：

8

阿巴克达布

6

bdcaba

6

巴卡

**输出**：

咩

# ruby-on-rails-3 - 将 gem 添加到 Gemfile 并使用 Capistrano 部署后作为运行时出现错误

> ID：10728112
> 
> 赞同：2
> 
> 时间：2012-05-23T21:27:24.800
> 
> 标签：ruby-on-rails-3, capistrano, bundler, unicorn

我们有一个 Rails 3.2 应用程序正在开发中，并且正在使用这个 railscast 中的说明部署到 Linux VPS：[http:](http://railscasts.com/episodes/335-deploying-to-a-vps) //railscasts.com/episodes/335-deploying-to-a-vps ，除了我们使用的是 rvm 而不是rbenv。我们正在使用 nginx、unicorn、rvm、rails 3.2 和 postgres。

初始`cap deploy:cold`运行良好，我们已经进行了几次部署，因为没有更改初始部署中的 gem。

我们现在添加了 will_paginate 和相关代码，并像往常一样使用`cap deploy`. 部署运行没有任何错误，我可以看到对`bundle install --path /home/..../shared/bundle --deployment`（使用其他一些选项）的调用。

问题是，当我们访问使用 will_paginate 的应用程序页面时，我们会在日志中看到以下错误：`NoMethodError undefined method paginate`.

所以这对我说，由于某种原因，rails 应用程序无法使用 gem。

我已经 ssh'ed 进入盒子，如果我运行，`bundle list`我可以看到 will_paginate 列出。如果我从上方检查捆绑包位置（/home/..../shared/bundle），will_paginate 就在那里。

我重新启动了独角兽，仍然没有喜悦。我想这是某种路径问题，但我不知道为什么其他宝石可用而新宝石不可用。

有什么想法可以解决这个问题吗？

该项目是开源的，位于 github 上，因此您可以在此处查看各种配置文件：[https ://github.com/andypike/lagtv](https://github.com/andypike/lagtv)

提前致谢

安迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T15:46:22.870

我遇到了同样的问题。我能让独角兽“刷新”（如果这是正确的话）的唯一方法是手动停止独角兽，然后重新启动它。在我的系统上是：

```
 /etc/init.d/unicorn_appname stop
    /etc/init.d/unicorn_appname start 
```

重新启动对部署很有帮助，但是对 Gemfile 的任何调整都需要我启动/停止。

# workflow-foundation-4 - Team Build 2010：使用 WF 写入文本文件

> ID：10728113
> 
> 赞同：1
> 
> 时间：2012-05-23T21:27:25.703
> 
> 标签：workflow-foundation-4, workflow-foundation

我有兴趣在 Team Build 执行期间将一些任意信息附加到文本文件中，但是我对 Windows 工作流没有太多经验。我的选择似乎是：

*   编写我自己的 CodyActivity 并导入到我的流程模板中。
*   也许在 InvokeMethod 活动中调用一些 .NET IO 方法。
*   使用某种我不知道的特定于文件的活动库？

出于维护和可移植性目的，我想让它尽可能接近“纯”WF，但我不知道从哪里开始。似乎应该已经有像文件 IO 这样基本的东西的活动，但我还没有找到它们。这些存在吗？如果没有，是否可以使用 InvokeMethod 进行类似的操作，还是我必须编写自己的活动？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T05:49:58.980

使用[TFS Build Extensions](http://tfsbuildextensions.codeplex.com/documentation)中的 WriteToFile 活动。[这是](http://tfsbuildextensions.codeplex.com/wikipage?title=How%20to%20integrate%20the%20WriteToFile%20build%20activity&referringTitle=Documentation)如何使用它的文档。

# macos - TextMate中OS X Dvorak键盘中的单引号

> ID：10728116
> 
> 赞同：0
> 
> 时间：2012-05-23T21:27:36.670
> 
> 标签：macos, keyboard, textmate, quotes, dvorak

我在 TextMate 的 OS X 中使用 dvorak 布局。当我输入单引号键（qwerty 中的 q 键）时，我会得到像这样的单引号：'</p>

我只想要这样的简单单引号：'

我似乎找不到键入简单引号或任何您称呼它们的键。任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T21:03:39.320

我刚刚安装了 TextMate 并获得了正常的单引号。可能是操作系统版本设置而不是 TextMate 设置。我正在运行 10.6.8，但我看到您最初将问题标记为 OSX-Lion。 [OS X Lion：使用弯引号和破折号](http://support.apple.com/kb/PH4513)

# java - HTMLUnit 提交表单不起作用

> ID：10728117
> 
> 赞同：1
> 
> 时间：2012-05-23T21:27:38.083
> 
> 标签：java, htmlunit

我有一个带有以下代码的jsp文件：

```
<form name="postToChatPicMsg" method="post" action="/api/media/postToChatPicMsg" enctype="multipart/form-data">
                    <br>udid:<input type="text" name="udid" value="54321dsfsdfsdfasdas">
                    <br>token:<input type="text" name="token" value="32cfa8b259c38bdd95f8cede17acb366">
                    <br>mediaFile:<input type="file" name="mediaFile">
                    <br>message:<input type="text" name="message" value="">
                    <br><input type="submit" name="submitButton">
                </form> 
```

这适用于jsp。现在要自动化测试，我正在尝试使用 HTMLUnit 并尝试执行以下操作

```
WebClient c = new WebClient();
    HtmlPage p;
    try {
        p = c.getPage("http://localhost:55080/api.jsp");
        HtmlForm uploadForm = p.getFormByName("postToChatPicMsg");
        HtmlFileInput fileInput = uploadForm.getInputByName("mediaFile");
        fileInput.setValueAttribute("/src/test/resources/logo.jpg");
           ((HtmlSubmitInput)uploadForm).getInputByName("submitButton")).click());

    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

对 api 的调用返回一个 xml。我期待呼叫通过并到达服务器，我可以在日志中看到活动。但似乎什么也没有发生。

这是我第一次尝试使用 HTMLUnit。

# c# - 在功能区控件上绘制窗口按钮

> ID：10728118
> 
> 赞同：2
> 
> 时间：2012-05-23T21:27:42.117
> 
> 标签：c#, wpf, ribbon

我想实现与 MS Office 类似的外观和感觉。我用一些问题实现了功能区控制。

**我的第一个问题：**如图所示，我认为 MS Office 使用无边框表单/窗口并“绘制”功能区控件顶部的最小化/最大化/关闭按钮。（我不确定我只是从过去的记忆中猜到的。）我怎样才能做到这一点或类似的事情来实现 MS Office 的目标。

**我的第二个问题：**我做错了什么，但不知道是什么。我添加了功能区控件，但无法添加[此处](http://msdn.microsoft.com/en-us/library/system.windows.controls.ribbon.ribbon%28v=vs.110%29)看到的图像。当我使用下面的代码时，它不会在设计时引发错误。（如果我更改文件名，它会在设计时抛出一个错误，说没有这样的文件。）

```
<RibbonButton x:Name="QATButton2" SmallImageSource="Resources/b.bmp" /> 
```

但它会在运行时引发此错误。

`'Provide value on 'System.Windows.Baml2006.TypeConverterMarkupExtension' threw an exception.' Line number '28' and line position '35'.`

![在此处输入图像描述](../Images/75a5d22c17e0cda7992805de1966b841.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T22:01:35.770

The answer is using [RibbonWindow](http://msdn.microsoft.com/en-us/library/microsoft.windows.controls.ribbon.ribbonwindow%28v=vs.110%29) instead of Window.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:13:02.843

该异常应该具有一个`InnerException`属性，您可以查看该属性以了解问题的根本原因。我会在 Visual Studio 中深入研究。

# ember.js - EmberJS - 从对象内的嵌套数组创建/访问对象并对其进行操作

> ID：10728119
> 
> 赞同：0
> 
> 时间：2012-05-23T21:27:48.963
> 
> 标签：ember.js

我从服务器返回的 JSON 对象如下所示：

```
[
  { 
    "id" : 1, 
    "name": "Biking", 
    "type": [{ 
      "id" : 1, 
      "name" : "Road"
    }]
  },
  { 
    "id" : 2, 
    "name": "MotorCycling",
    "type": [{ 
      "id" : 1, 
      "name" : "MX", 
      "alias" : { 
        "name": "Dirt", 
        "showaliasonsportid": [1,2,3] 
        } 
    }
  ]}
] 
```

我的 ember js 看起来像这样

```
App.Activity = Em.Object.extend({
});

App.ActivityListView = Em.View.extend({ 
});

App.activitiesController = Em.ArrayProxy.create({ 
    content: [],

    loadActivities: function () {
      var self = this;
      $.getJSON('data/activities.json', function(data) {
        data.forEach(function(item) {
          self.pushObject(App.Activity.create(item));
        });
      });
    }
}); 
```

我的问题是如何对 showaliasonsportid 数组进行操作，甚至可以访问它以显示 alias.name 而不是 type.name 值？我已经读到我可能需要从别名和/或 showaliasonsportid 数组中创建一个对象，但我对如何使用 Ember 执行此操作感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:07:15.840

查看 Ember Data，它很好地解决了这些问题：[https ://github.com/emberjs/data](https://github.com/emberjs/data)

# php - 如何使用 Selenium webdriver 获取浏览器 sessionId

> ID：10728122
> 
> 赞同：5
> 
> 时间：2012-05-23T21:27:58.963
> 
> 标签：php, yii, webdriver, selenium-webdriver

我正在使用 selenium webdriver（php-webdriver-bindings Yii 扩展），我正在尝试获取浏览器 sessionId（测试将使用的那个）。我以为我可以通过 webdriver 得到这个，但似乎并非如此。Webdriver 有一个 sessionId，但这不是测试浏览器使用的那个。

我试图在测试运行之前登录以允许我的测试成为经过身份验证的用户，这将允许他们访问我正在测试的页面。

我已经研究和测试了几天了，我很茫然。任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T12:27:01.033

您可以转换为具体类型，例如[RemoteWebDriver，它们都继承自，并且还实现 getSessionId](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/remote/RemoteWebDriver.html#getSessionId%28%29)：

```
((RemoteWebDriver) driver).getSessionId() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-23T17:20:48.123

我在 Java 中遇到了这个问题，但在仔细检查源代码后，注意到我使用的驱动程序被实例化为一个`WebDriver`对象。将其更改为`RemoteWebDriver`对象后，该`.getSessionId()`方法被公开，并按`driver.getSessionId()`预期返回会话 id。

我不确定这将如何转换为 PHP，但我建议您返回并检查以确保您的驱动程序是一个`RemoteWebDriver`对象，而不是一个`WebDriver`对象。

# jquery - 删除类/样式 onclick

> ID：10728125
> 
> 赞同：0
> 
> 时间：2012-05-23T21:28:12.653
> 
> 标签：jquery, css

我已经写了一些代码，一旦您单击任一输入框，我就需要删除验证错误。但是当我使用标准的 removeClass 时，它们并没有达到预期的效果，因为它阻止了我再次提交。

你可以在这里看到我的意思：http: [//jsfiddle.net/5V7Uv/5/](http://jsfiddle.net/5V7Uv/5/)

HTML：

```
<form method="post" name="form1" action="/whatmask_output/">
    <div id="sectioncol">
        <label for="input-whatmask">whatmask</label>
        <input type="text" name="input-whatmask" id="input-whatmask"
        size="22" />
    </div>
    <div id="sectioncol">
        <label for="input-whois">whois</label>
        <input type="text" name="input-whois" id="input-whois" size="22"
        />
    </div>
    <input type="submit" value="submit" "whatmask_input" id="btn-search" align="right"
    />
</form>​ 
```

JavaScript：

```
var hasError = false;
$("form").submit(function (e) {
    var searchReg = /^[a-zA-Z0-9\s\/\.]+$/;
    if ($("#input-whatmask").val() != '' && $("#input-whois").val() != '') {
        alert('Enter only one field at a time.');
        return false;
    }
    if (hasError) return false;
    if ($("#input-whatmask").val() != '') {
        if (!searchReg.test($("#input-whatmask").val())) {
            $("#input-whatmask").addClass("errorinput").after('<span class="error">Enter a valid value.</span>');
            hasError = true;
            return false;
        }
    } else if ($("#input-whois").val() != '') {
        if (!searchReg.test($("#input-whois").val())) {
            $("#input-whois").addClass("errorinput").after('<span class="error">Enter a valid value.</span>');
            hasError = true;
            return false;
        }
    } else {
        alert('No values entered!');
        return false;
    }
});
$("#input-whatmask, #input-whois").click(function () {
    $("#input-whatmask, #input-whois").removeClass("errorinput");
    $("#input-whatmask, #input-whois").removeClass("error");
    $("#input-whatmask, #input-whois").val('');
    if ($(this).hasClass('errorinput')) {
        $(this).next().remove();
        $(this).removeClass("errorinput");
        hasError = false;
    }
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:41:47.497

```
if (hasError) return false; 
```

这条线看起来像违规者，因为您的`hasError`变量在第一次运行后被设置为 true（当然，如果有错误），并且不会被设置回 false。

尝试`hasError = false`在此行之后添加：

```
$("form").submit(function (e) { 
```

# xml - 使用powershell附加/删除空xml节点

> ID：10728132
> 
> 赞同：1
> 
> 时间：2012-05-23T21:29:04.420
> 
> 标签：xml, powershell, nuget

PowerShell/xml 初学者在这里....我正在尝试使用 PowerShell 作为 Nuget 包的一部分来附加或删除空的 xml 节点。xml文件具有以下格式...

```
<Root>
    <service name="first">
        <item>
        </item>
    </service>
    <service name ="second">
        <item>
        </item>
    </service>
</Root> 
```

首先，我的脚本选择其中一项服务并将其保存为变量，例如用户是否要选择服务 1 .....

```
if ($xml.Root.service.name -eq $serviceName)
{
         $myService = $xml.Root.service
} 
```

问题是稍后，我需要将元素附加到节点/删除节点......我有类似的东西

```
 $newNode = $xml.CreateElement('new'...
    .........

    $empty = $myService.SelectSingleNode('./item')
    $empty.PrependChild($newNode) 
```

但我无法让这种方法起作用。

任何建议，将不胜感激...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T22:24:48.173

这应该可以帮助你。

```
# Get an XML document
$MyXml = [xml]'<?xml version="1.0" encoding="utf-8"?><root><service name="foo"><item></item></service></root>';
# Create a new element from the XmlDocument object
$NewElement = $MyXml.CreateElement('new');
# Select the element that we're going to append to
$ServiceElement = Select-Xml -Xml $MyXml -XPath '/root/service[@name="foo"]/item';
# Append the 'new' element to the 'item' element
$ServiceElement.AppendChild($NewElement);
# Echo the OuterXml property of the $MyXml variable to verify changes
Write-Host -Object $MyXml.OuterXml;
# Save the XML document
$MyXml.Save('c:\test.xml'); 
```

# r - R：是否可以矢量化/加速这个双循环？

> ID：10728137
> 
> 赞同：2
> 
> 时间：2012-05-23T21:29:26.867
> 
> 标签：r, loops, vectorization

这是一个高层次的一般性问题。周围有一些类似的例子，但有不同的、更简洁的例子。或许无法回答。`conn`是一个矩阵。

```
 for (i in 2:dim(conn)[1]) {
        for (j in 2:dim(conn)[1]) {
          if ((conn[i, 1] == conn[1, j]) & conn[i, 1] != 0) {
              conn[i, j] <- 1
              conn[j, i] <- 1
              }
              else {
                conn[i, j] <- 0
                conn[j, i] <- 0
                }
           }
      } 
```

这直接`cluscomp`来自 clusterCons 包。

我的问题很简单：是否可以加快循环或将其矢量化？作为 R 初学者，我看不到它，也不想以挫败感告终，因为这可能是不可能的。我会接受任何可以说是或否的答案，并暗示可能涉及的工作量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:54:07.043

这是我将如何编写它，`outer`用作双循环的替代品。请注意，它仍然进行了比需要更多的计算，但肯定更快。我假设`conn`是一个方阵。

原代码：

```
f1 <- function(conn) {
   for (i in 2:dim(conn)[1]) {
      for (j in 2:dim(conn)[1]) {
         if ((conn[i, 1] == conn[1, j]) & conn[i, 1] != 0) {
            conn[i, j] <- 1
            conn[j, i] <- 1
         } else {
            conn[i, j] <- 0
            conn[j, i] <- 0
         }
      }
   }
   return(conn)
} 
```

我的建议：

```
f2 <- function(conn) {
   matches <- 1*outer(conn[-1,1], conn[1,-1], `==`)
   matches[conn[-1,1] == 0, ] <- 0
   ind <- upper.tri(matches)
   matches[ind] <- t(matches)[ind]
   conn[-1,-1] <- matches
   return(conn)
} 
```

一些样本数据：

```
set.seed(12345678)
conn <- matrix(sample(1:2, 5*5, replace=TRUE), 5, 5)
conn
#      [,1] [,2] [,3] [,4] [,5]
# [1,]    2    2    1    2    1
# [2,]    1    1    2    2    1
# [3,]    2    2    1    2    1
# [4,]    2    2    2    2    1
# [5,]    1    1    2    2    1 
```

结果：

```
f1(conn)
#      [,1] [,2] [,3] [,4] [,5]
# [1,]    2    2    1    2    1
# [2,]    1    0    1    1    0
# [3,]    2    1    0    0    1
# [4,]    2    1    0    1    0
# [5,]    1    0    1    0    1

identical(f1(conn), f2(conn))
# [1] TRUE 
```

一个更大的例子，时间比较：

```
set.seed(12345678)
conn <- matrix(sample(1:2, 1000*1000, replace=TRUE), 1000, 1000)

system.time(a1 <- f1(conn))
# user  system elapsed 
# 59.840   0.000  57.094 

system.time(a2 <- f2(conn))
# user  system elapsed 
# 0.844   0.000   0.950 

identical(a1, a2)
# [1] TRUE 
```

也许不是你能得到的最快的方法（我相信这里的其他人可以使用例如编译器或 Rcpp 找到更快的方法），但我希望对你来说足够短和快。

* * *

编辑：由于已经指出（从该代码的提取位置的上下文中）这`conn`是一个对称矩阵，我的解决方案可以缩短一点：

```
f2 <- function(conn) {
   matches <- outer(conn[-1,1], conn[1,-1],
                    function(i,j)ifelse(i==0, FALSE, i==j)) 
   conn[-1,-1] <- as.numeric(matches)
   return(conn)
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T10:02:13.850

非矩阵解决方案 - 应该非常快，假设 conn 是非负和对称的......

```
connmake = function(conn){
  ordering = order(conn[,1])
  breakpoints = which(diff(conn[ordering,1]) != 0)
  if (conn[ordering[1], 1] != 0){
    breakpoints = c(1, breakpoints + 1, nrow(conn) + 1)
  } else {
    breakpoints = c(breakpoints + 1, nrow(conn) +1)
  }
  output = matrix(0, nrow(conn), nrow(conn))

  for (i in 1:(length(breakpoints) - 1)){
    output[ ordering[breakpoints[i]:(breakpoints[i+1] -1)],
        ordering[breakpoints[i]:(breakpoints[i+1] -1)]] =  1
  }
  output[,1] = conn[,1]
  output[1,] = conn[,1]
  output
} 
```

一些使用早期基准测试的测试代码。（原代码实现为`orig()`，`f2()`是较早的建议。）

```
size = 2000
conn  = matrix(0, size, size)
conn[1,] = sample( 1:20, size, replace = T)
conn[,1] = conn[1,]

system.time(orig(conn) -> out1)
#user  system elapsed 
#20.54    0.00   20.54 
system.time(f2(conn) -> out2)
#user  system elapsed
#0.39    0.02    0.41 
system.time(connmake(conn) -> out3)
#user  system elapsed 
#0.02    0.00    0.01 
identical(out1, out2)
#[1] TRUE
identical(out1, out3)
#[1] TRUE 
```

请注意，对于包含 0 的 conn，f2 实际上会失败，但不是我的问题，是吗？可以通过例如将相关值增加一个安全偏移量来简单地处理带有负值的 conn。非对称连接需要更多的思考，但应该是可行的......

一般的教训是排序比成对比较快。成对比较是 O(N^2)，而 R 中最慢的排序算法是 O(N^4/3)。一旦数据被排序，比较就变得微不足道了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T22:13:26.220

有几件事浮现在脑海。

首先，您可以通过仅遍历对角线下方或对角线上方的条目将时间减少一半。如果矩阵是方形的，任何一个都可以。如果`dim(conn)[1] > dim(conn)[2]`那时你会想使用类似的东西循环通过左下角的三角形

```
for (j in 2:dim(conn)[2]) {
  for (i in j:dim(conn)[1]) {
    ...
  }
} 
```

其次，人们可能会尝试使用`apply`它，因为它们通常会产生显着的时间减少。但是，在这种情况下，每个 [i,j] 单元格同时引用列头`[1,j]`和行头`[i,1]`，这意味着我们不能只将单元格、行或列发送到 *pply。为了代码清晰，我可能会保留`for`循环。任何有效的基于 *pply 的技巧都会非常聪明，以至于一年后我会忘记它是如何工作的。

最后，这似乎是一个经典示例，使用从 R 调用的 C 会快得多。这似乎需要做很多工作，但它比您想象的要容易得多，即使（对于这个特定示例）如果你不知道 C。第一个对我有意义的从 R 调用 C 的简短示例是[here](http://cran.wustl.edu/doc/contrib/Robinson-icebreaker.pdf#page=152)，但它没有利用 Rcpp，所以我不会停在那里。或者，如果您从工作 Rcpp 代码的*任何*简单示例开始，那么您可以在此处对其进行修改以执行您想要的操作。如果你只是想修改别人的代码，从[这个 StackOverflow 线程](https://stackoverflow.com/questions/9154383/converting-loop-from-r-to-c-using-rcpp)开始。

# ios - 获取 uinavigationItem.titleView 的最大宽度？

> ID：10728148
> 
> 赞同：12
> 
> 时间：2012-05-23T21:30:32.637
> 
> 标签：ios, uinavigationbar, frame, uinavigationitem, titlebar

我有一个自定义的titleView，我需要为其设置最大宽度。那将是屏幕宽度 - 左侧项目的宽度（后标题、按钮或 nil） - 右侧项目的宽度（按钮或 nil）。我怎样才能确定这一点？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-03-24T15:28:24.020

```
_segmentedControl.frame = CGRectMake(0, 0, CGFLOAT_MAX, _segmentedControl.frame.size.height);

[self.navigationItem setTitleView:_segmentedControl]; 
```

将 CGFLOAT_MAX 设置为 navigationItem 标题视图的宽度会使用左侧项目和右侧项目之间的最大可用空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T21:33:27.697

导航栏不会自动将宽度设置为最大值吗？我的意思是，我确定你的自定义 titleView 的 sizeThatFits: 方法被调用了。也许这是一个很好的起点。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-02-02T10:54:07.497

将 titleView 宽度设置为大于最大屏幕宽度所需的宽度，并且导航栏调整宽度以适应屏幕。如果有左或右 UIBarButtonItem，则 titleView 相对于它们调整大小。尝试旋转屏幕，看看自己。

```
func setTitleView(){
    guard let navFrame = navigationController?.navigationBar.frame else{
        return
    }
    let myView = UIView(frame: CGRect(x: 0, y: 0, width: navFrame.width*3, height: navFrame.height))
    myView.backgroundColor = UIColor.orange
    self.navigationItem.titleView = myView
} 
```

# android - 在android中关闭对话框后更新

> ID：10728149
> 
> 赞同：0
> 
> 时间：2012-05-23T21:30:33.540
> 
> 标签：android, list, listview, dialog

我有一个在 android 中显示的列表。如果单击任何项​​目，则会出现一个自定义对话框。然后用户在其 EditView 中输入一些值并关闭它。

问题是：虽然我能够读取用户输入的内容，但我也想将用户在对话框中输入的数据更新到单击的项目中。

请问谁能告诉我该怎么做？对话框是在这种情况下使用的正确视图吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:57:05.323

如果您使用[CursorLoader](http://developer.android.com/reference/android/content/CursorLoader.html)加载您的列表，那么您应该没有任何问题，只要您通知您的`provider`. 如果您不使用 a`CursorLoader`您将需要一个[处理](http://developer.android.com/reference/android/os/Handler.html)程序来更新您的`List`（重新加载全部）。这是来自 Android 的一点帮助：[Painless Threading](http://developer.android.com/resources/articles/painless-threading.html)

# c# - 我的图片没有出现在 listcontrol

> ID：10728155
> 
> 赞同：1
> 
> 时间：2012-05-23T21:30:46.410
> 
> 标签：c#, image, windows-phone-7, data-binding, mvvm

我不确定这里出了什么问题，但是我的图像没有显示出来。我的对象的所有其他属性都显示出来，但图像永远不会加载。我已经在浏览器中尝试了 url，图像显示在那里。这是我的代码：

使用 MVVM Light，设置视图模型

```
DataContext="{Binding Main, Source={StaticResource Locator}}"> 
```

我的带有数据绑定的 xaml

```
 <ItemsControl ItemsSource="{Binding AllItems}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Height="200">
                                <!--<StackPanel.Background>
                                    <ImageBrush ImageSource="PodImages\podstate-Clip.png" />
                                </StackPanel.Background>-->
                                <Image Source="{Binding ImageUri}"/>
                                <StackPanel Orientation="Horizontal">
                                    <StackPanel>
                                        <TextBlock Text="{Binding Summ}" FontSize="32" Foreground="Green"/>
                                        <TextBlock Text="{Binding Brand}" FontSize="32" Foreground="Blue"/>
                                        <TextBlock Text="{Binding L1}" Width="350" TextWrapping="Wrap" Foreground="Blue"/>                                        
                                    </StackPanel>
                                    <TextBlock Text="{Binding Val}"/>

                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl> 
```

我的数据模型

```
public class Offer
{

    public long ID { get; set; }
    public int Type { get; set; }
    public string Summ { get; set; }
    public string L1 { get; set; }
    public string Brand { get; set; }
    public string ImageUri { get; set; }
} 
```

我的数据服务回调。这是按预期设置我的收藏。ImageUri 包含一个有效的 uri。

```
private void OffersLoaded(OfferDetailsWithMsg offers)
    {
        AllItems = offers.Items.Where(item => item.Type == 0).ToList();
    } 
```

最后是我的 AllItems 属性。是的，我在打电话`RaisePropertyChanged`（为简洁起见，删除了支持属性）

```
public List<Offers> AllItems
    {
        get
        {
            return _allItems;
        }

        set
        {
            if (_allItems == value)
            {
                return;
            }

            _allItems= value;

            RaisePropertyChanged(AllItemsPropertyName);

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:46:21.800

我相信您需要绑定到 a`Uri`而不是 a `string`。在 Offer 类中，尝试添加以下属性并绑定到该属性。

```
public Uri ImgUri
{
     get
     {   
          return new Uri(ImageUri, UriKind.Absolute); //or relative, if it is relative
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T06:23:33.027

啊，这些是 Gif，似乎不支持 Gif。

# php - 使用 Phonegap 从 Android 上传照片

> ID：10728162
> 
> 赞同：1
> 
> 时间：2012-05-23T21:31:15.763
> 
> 标签：php, android, cordova, upload, webserver

我正在遵循本[指南](http://zacvineyard.com/blog/2011/03/25/upload-a-file-to-a-remote-server-with-phonegap/comment-page-2/#comment-3089)，并且几乎所有工作都可以正常工作，除了当我单击提交照片时，它只是用我的服务器代码向我发出警报。

这是我在 php 中的代码：

```
print_r($_FILES);
$new_image_name = "namethisimage.jpg";
move_uploaded_file($_FILES["file"]["tmp_name"], "/public_html/photos".$new_image_name); 
```

目录是正确的还是应该以其他方式表达？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T09:04:56.853

*   确保您的目标目录是绝对路径（是 /public_html 在系统的根目录中，还是您想定义相对路径？）。

*   你不是在这样的照片之后错过了一个'/'：

    ```
    "/public_html/photos/".$new_image_name 
    ```

*   确保您的目标目录对于您的网络服务器的用户（例如 LAMP 中的“www-data”用户）是可写的。如果您不确定并且想要对此进行测试，请将“/public_html/photos/”文件夹的权限设置为 777。

# python - 为什么不读取这个“if”语句？

> ID：10728166
> 
> 赞同：4
> 
> 时间：2012-05-23T21:31:19.993
> 
> 标签：python

在我的代码中，我希望'Opposite'和'Hypotenuse'这两个答案有两个不同的结果，但是，每当我测试代码并回答'相反'时，它都会忽略其余代码并归结为'斜边的问题。我是否将其格式化/是否有更简单的方法来执行此操作/等等？

```
from math import *

    def  main():

       #Trignometry Problem

        def answer():
            answer = raw_input()

    while True:

        # Phrase Variables
        phrase1 = ("To begin, we will solve a trigonometry problem using sin.")
        phrase2 = ("Which is known - hypotenuse or opposite?")
        phrase3 = ("Good! Now, we will begin to solve the problem!")
        phrase4 = ("Please press any key to restart the program.")

        print phrase1
        origin=input("What is the origin?")
        print phrase2
        answer = raw_input()
        if answer == ("Hypotenuse.") or ("Hypotenuse") or ("hypotenuse") or ("hyotenuse."):
            hypotenuse=input("What is the hypotenuse?")
            print "So, the problem is " + "sin" + str(origin) + " = " + "x" + "/" + str(hypotenuse) + "?"
            answer = raw_input()
            if answer == ("Yes.") or ("yes") or ("yes.") or ("Yes"):
                print phrase2
            answer = raw_input()
            print phrase4
            answer = raw_input()
            if answer == ("No."):
                break 
        if answer == ("Opposite."):
            opposite=input("What is the opposite?")
            print "So, the problem is " + "sin" + str(origin) +  " = " + str(opposite) + "/" + "x" + "?"
            answer = raw_input()
            if answer == ("Yes.") or ("yes") or ("yes.") or ("Yes"):
                print phrase2
        answer = raw_input()
        print phrase4
        answer = raw_input()
        if answer == ("No."):
            break

    main() 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T21:33:30.427

## 简短的回答

您可能想要更改这些：

```
if answer == ("Hypotenuse") or ("Hypotenuse.") ... 
```

这样：

```
if answer in ("Hypotenuse", "Hypotenuse.", ...): 
```

## 解释

表达方式：

```
answer == ("Foo") or ("Bar") 
```

它的评估如下：

```
(answer == ("Foo")) or (("Bar")) 
```

而且`"Bar"`总是`True`。

显然，正如评论中指出的那样，`"HYPOTENUSE" in answer.upper()`是最好的解决方案。

# java - 在 BigDecimal 中使用 setScale

> ID：10728169
> 
> 赞同：2
> 
> 时间：2012-05-23T21:31:33.023
> 
> 标签：java, bigdecimal

谁能帮我解决 BigDecimal，我是新手

```
BigDecimal amount = new BigDecimal("24.33");
System.out.println(amount.setScale(2, RoundingMode.CEILING)); 
```

我期待得到 25.00 但我仍然得到 24.33 任何想法我哪里出错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:36:07.027

试试这个 -

```
BigDecimal amount = new BigDecimal("24.33");  
System.out.println(amount.setScale(0, RoundingMode.CEILING).setScale(2)); 
```

额外`setScale(2)`是根据您的需要获得 25.00，没有额外`setScale`您将获得 25 作为答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:37:47.530

比例适用于小数点后的部分。你想要的是：

```
BigDecimal amount = new BigDecimal("24.33");
System.out.println(amount.setScale(0, RoundingMode.CEILING)); 
```

还要记住`BigDecimal`s 是[Immutable](http://en.wikipedia.org/wiki/Immutable_object)，因此所有操作都会返回一个新的 BigDecimal 来表示操作的结果。如果你不习惯它可以抓住你。

# wicket - 通过中继器添加的样式检票口组件

> ID：10728181
> 
> 赞同：0
> 
> 时间：2012-05-23T21:32:25.053
> 
> 标签：wicket

我正在使用一个应用程序，在该应用程序中，我需要将一组子面板添加到属于页面一部分的其他包含父面板。

一次可以有 1 到 3 个父面板，父面板之间总共可以有 7 个子面板。

我把它放到了所有东西都被正确添加的地方，但是当试图对通过检票口中继器添加的这些面板进行样式设置时，我的正常方法都不起作用。

我已经尝试覆盖 ListView 的 populateItem 方法，如下所示：[https](https://cwiki.apache.org/WICKET/listview-and-other-repeaters.html) ://cwiki.apache.org/WICKET/listview-and-other-repeaters.html和[https://cwiki.apache.org/WICKET/page -with-dynamic-components.html](https://cwiki.apache.org/WICKET/page-with-dynamic-components.html)

```
 add(new ListView<ParentPanel>("parentPanels", panels) {

        @Override
        protected void populateItem(ListItem<ParentPanel> item) {

            ParentPanel temp = (ParentPanel) item.getModelObject();

            temp.add(new AttributeAppender("class", new Model<String>("panelClass"), ""));

            item.add(temp);
        }

    }); 
```

...或在标记中：

```
 <wicket:container wicket:id="listOfPanels">
            <wicket:panel wicket:id="panelClass"/>
        </wicket:container> 
```

...甚至将属性修饰符添加到要添加的面板的构造函数中。

这一切似乎都被忽略了。我错过了一些基本的东西吗？如果我不必计算要添加的面板的数量和类型，这将不是问题，但是使用中继器会删除样式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T16:48:25.653

将您的属性修饰符添加到 Item 并将 Item 附加到呈现为 div 而不是未呈现的 wicket:container 的 html 标记。

您还可以在 Item 子类中添加该类并覆盖转发器的 newItem() 方法以返回您自己的。以 OddEvenListItem 为例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T14:14:01.043

我不认为将面板作为模板提供给 ListView 是一种很好的做法。这可能更方便

```
 add(new ListView<Object>("parentPanels", panels) {

    @Override
    protected void populateItem(ListItem<Object> item) {

        ParentPanel temp = new ParentPanel("panelClass",item.getModelObject());
        //ParentPanel temp = (ParentPanel) item.getModelObject();

        temp.add(new AttributeAppender("class", new Model<String>("myPanel"), ""));

        item.add(temp);
    }

}); 
```

也试试这样的HTML

```
 <div wicket:id="listOfPanels">
        <div wicket:id="panelClass"></div>
    </div> 
```

这将使用名为**myPanel**的 css 类生成。

您还需要将 css 类添加到面板的 html 及其组件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-25T14:43:12.813

```
For simple styles, try something like following

    item.add(new AttributeAppender("style", Model.of("padding-top:23px;padding-left:5px"))); 
```

# facebook-graph-api - 验证是否已经进行了带有 url 的 Open Graph 操作

> ID：10728183
> 
> 赞同：1
> 
> 时间：2012-05-23T21:32:38.907
> 
> 标签：facebook-graph-api

我正在 Facebook 上开发一个应用程序，用于报纸的自动社交阅读，但我不知道如何验证用户是否已经采取了行动，即用户阅读的报纸网站上的每个页面都会自动在 Facebook 上与非内置动作类型。

我试过类似的东西：

```
me/[action type]:[?article=[readed url article] 
```

但我没有任何成功，因为它返回了与操作类型相关的所有帖子。

我如何在图表中搜索这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T11:21:02.073

您可以通过查询 Graph API 来查看用户已经执行了哪些操作，如下所示 `http://graph.facebook.com/me/{action_id}`：这将返回用户为特定操作阅读的所有文章。

使用该列表并将其与文章交叉引用，以确定以前阅读过哪些文章。即与`$activity['data']['article']['url']`文章的匹配（上面的Graph API调用返回的数据`$url`在哪里）。`$activity`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:56:52.213

不，没有办法只使用 API 来做到这一点。您必须保存此信息

*   采取行动时，当您收到行动 ID 作为响应并保存到数据库时，或者，
*   循环调用应用程序语言中的调用，并以编程方式检查对象是否已被用户发现

# domain-driven-design - DDD - 聚合内子对象的修改

> ID：10728187
> 
> 赞同：15
> 
> 时间：2012-05-23T21:32:45.330
> 
> 标签：domain-driven-design, aggregateroot

我在找出处理相当复杂的场景的最佳方法时遇到了一些困难。我见过很多类似的问题，但没有一个让我满意。

使用多个 OrderLine（子实体）创建一个 Order（聚合根）。根据业务规则，每个 OrderLine 必须在 Order 的生命周期内保持相同的身份。OrderLines 有许多 (20+) 属性，并且在 Order 被视为“锁定”之前可以经常发生突变。此外，还有一些必须在根级别强制执行的不变量；例如，每个订单行都有一个数量，订单的总数量不能超过 X。

在考虑对 OrderLines 进行更改时，我不确定如何对这种情况进行建模。我有 4 个我能想到的选择，但似乎没有一个令人满意：

1) 当需要修改 OrderLine 时，请使用根提供的参考。但是我失去了检查根中不变逻辑的能力。

```
var orderLine = order.GetOrderLine(id);
orderLine.Quantity = 6; 
```

2) 在订单上调用一个方法。我可以应用所有不变的逻辑，但是我坚持使用大量的方法来修改 OrderLine 的许多属性：

```
order.UpdateOrderLineQuantity(id, 6);
order.UpdateOrderLineDescription(id, description);
order.UpdateOrderLineProduct(id, product);
... 
```

3) 如果我将 OrderLine 视为值对象，这可能会更容易，但它必须根据业务需求保持相同的身份。

4) 对于不影响不变量的修改，我可以获取对 OrderLines 的引用，并为那些影响不变量的修改执行 Order。但是，如果不变量受大多数 OrderLine 属性的影响怎么办？这个反对是假设的，因为只有少数属性可以影响不变量，但是随着我们发现更多的业务逻辑，这可能会改变。

任何建议表示赞赏......如果我很密集，请随时告诉我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T23:17:03.987

1.  不是最优的，因为它允许打破域不变量。

2.  会导致代码重复和不必要的方法爆炸。

3.  与 1) 相同。使用值对象将无助于维护域不变性。

4.  这个选项是我会选择的。在它们实现之前，我也不担心潜在的和假设的变化。设计将随着您对领域的理解而发展，并且以后总是可以重构。为了将来可能不会发生的一些变化而阻碍您现有的设计确实没有任何价值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-24T02:10:54.170

4 相对于 2 的一个缺点是缺乏一致性。在某些情况下，在更新订单行项目方面保持一定程度的一致性可能是有益的。可能无法立即清楚为什么某些更新是通过订单完成，而其他更新是通过订单行项目完成。此外，如果订单行有 20 多个属性，这可能表明这些属性有可能进行分组，从而导致订单行上的属性更少。总的来说，方法 2 或 4 没问题，只要您确保操作是原子的、一致的并与普遍存在的语言保持一致。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-31T10:22:13.813

有第五种方法可以做到这一点。您可以触发[域事件](http://www.udidahan.com/2009/06/14/domain-events-salvation/)（例如`QuantityUpdatedEvent(order, product, amount)`）。让聚合通过查看订单行列表在内部处理它，选择匹配产品并更新其数量（或将操作委托给`OrderLine`更好的操作）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-14T17:47:48.370

领域事件是最稳健的解决方案。

但是，如果这太过分了，您也可以使用参数对象模式对#2 进行变体 - 在实体根上具有单个 ModfiyOrderItem 函数。提交一个新的、更新的订单项目，然后订单在内部验证这个新对象并进行更新。

所以你的典型工作流程会变成类似

```
var orderItemToModify = order.GetOrderItem(id);
orderItemToModify.Quantity = newQuant;

var result = order.ModifyOrderItem(orderItemToModfiy);
if(result == SUCCESS)
{
  //good
 }
else
{
   var reason = result.Message; etc
} 
```

这里的主要缺点是它允许程序员修改项目，但不能提交它并且没有意识到这一点。然而，它很容易扩展和测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-26T21:41:17.397

如果您的项目很小并且您想避免域事件的复杂性，这是另一种选择。创建一个处理 Order 规则的服务并将其传递给 OrderLine 上的方法：

```
public void UpdateQuantity(int quantity, IOrderValidator orderValidator)
{
    if(orderValidator.CanUpdateQuantity(this, quantity))
        Quantity = quantity;
} 
```

CanUpdateQuantity 将当前 OrderLine 和新数量作为参数。它应该查找订单并确定更新是否导致总订单数量违规。（您必须确定如何处理更新违规。）

如果您的项目很小并且您不需要领域事件的复杂性，这可能是一个很好的解决方案。

这种技术的一个缺点是您将 Order 的验证服务传递到 OrderLine 中，它实际上不属于该处。相比之下，引发域事件会将 Order 逻辑移出 OrderLine。然后，OrderLine 可以对全世界说：“嘿，我正在改变我的数量。” 并且订单验证逻辑可以在处理程序中进行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-08T22:28:36.283

使用 DTO 怎么样？

```
public class OrderLineDto
{
    public int Quantity { get; set; }
    public string Description { get; set; }
    public int ProductId { get; set; }
}

public class Order
{
    public int? Id { get; private set; }
    public IList<OrderLine> OrderLines { get; private set; }

    public void UpdateOrderLine(int id, OrderLineDto values)
    {
        var orderLine = OrderLines
            .Where(x => x.Id == id)
            .FirstOrDefault();

        if (orderLine == null)
        {
            throw new InvalidOperationException("OrderLine not found.");
        }

        // Some domain validation here
        // throw new InvalidOperationException("OrderLine updation is not valid.");

        orderLine.Quantity = values.Quantity;
        orderLine.Description = values.Description;
        orderLine.ProductId = values.ProductId;
    }  
} 
```

*   这里唯一的问题是该`OrderLines`属性具有公共 getter，并且此类的用户可以将项目添加到集合中。我能想到如何防止它的唯一方法是隐藏 getter 并添加新的 getter，如果需要，它将返回 DTO 的集合。
*   方法的 id 参数`UpdateOrderLine`可以是 DTO 的一部分，使用它可能会更好
*   可能您可以`OrderLine`直接接受作为参数而不是`OrderLineDto`（如果您想`OrderLine`在传递给之前使用一些验证`Order`）。

# c# - 随机化对象的位置放置

> ID：10728188
> 
> 赞同：0
> 
> 时间：2012-05-23T21:32:50.833
> 
> 标签：c#, performance, algorithm

只是附加信息：这是针对我正在开发的游戏项目。

我正在尝试制作一种有效的随机化算法，在给定可用空间长度的情况下放置多个对象（彼此排列）。

直截了当地说：给定一个长度 = lengthOfArea 的可用空间，并且要定位的对象数 = numObjects，其中每个对象的长度，lengthObject = (lengthOfArea/2) / numObjects。（这样，对象占用的空间总量是可用空间长度的一半）。

我应该寻找每个对象的中心位置并返回它的数组。

这是我目前的尝试：

```
public int[] FindObjectPositions(int lengthOfArea, int numObjects, Random random)
  {
    int lengthOfObject = (lengthOfArea / 2) / numObjects;
    int[] positionsPicked = new int[numObjects];
    int minPosition = lengthObject / 2;
    int maxPosition = lengthOfArea - (lengthObject / 2);
    for (int i = 0; i < numObjects; i++)
    {
      int newPosition;
      do 
        {
          newPosition = minPosition + random.Next(maxPosition - minPosition);
        } while (!IsPositionValid(positionsPicked, newPosition, lengthObject));
        positionsPicked[i] = newPosition;
    }
    return positionsPicked;
  }

public bool IsPositionValid(int[] positionsPicked, int newPosition, int lengthObject)
  {
    for (int i = 0; i < positionsPicked.Length; i++)
    {
      if (Math.Abs(positionsPicked[i] - newPosition) <= (lengthObject / 2))
        return false;
    }
    return true;
  } 
```

基本上我正在做的是我不断随机地为每个对象找到一个有效的位置。我只是想知道它是否效率低下。另外，我想知道我是否会用这种方法陷入僵局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:05:40.793

如果存在无法容纳更多对象的配置，则可能会发生死锁。例如，如果有 30 个空格并且每个对象有 5 个空格长，则配置

```
_ _ _ _ xxxxx _ _ _ _ xxxxx _ _ _ _ xxxxx _ _ _

```

即使有 15 个空地，也没有地方可以容纳另一个物体！

* * *

假设有`m`开放空间，每个对象都有 width `w`。一种不会死锁的方法是生成一个`m-w+1`数字列表`1, 2, ..., m-w, m-w+1`。然后随机选择一个 - 这将代表对象的最左侧位置。然后删除该`w-1`数字右侧**和左侧**的数字 - 这表示对象是`w`宽的，并且没有其他宽度的对象`w`将适合`w-1`其左侧的空间。

例如，如果`m = 20`和`w = 3`，

> 创建一个从 1 到 18 的列表
> 
> 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18
> 
> 然后随机选择一个。假设我们选择 10。那么 10、11、12 的空间被我们的对象填充，并且空间 8、9 不能是另一个对象的最左边的位置，所以我们删除数字 8 到 12。
> 
> 1 2 3 4 5 6 7 13 14 15 16 17 18
> 
> 假设我们接下来选择 18。然后我们删除 16-18：
> 
> 1 2 3 4 5 6 7 13 14 15
> 
> 以此类推，直到我们没有数字。

* * *

上面的方法不会死锁，但它有另一个问题：它可能*有*一个包含（比如说）6个对象的配置，但上面的方法可能只生成一个包含4或5个对象的配置，并且没有空间对于任何更多。为了解决这个问题，我们可以计算出 6 个对象应该有多少个空白空间，而不是为我们的对象选择随机位置，然后为我们的空白空间选择随机点（使用上述方法）。

这将为您提供您想要的对象数量，随机间隔，没有死锁的可能性。

# javascript - jQuery .html() 用 html/javascript 代码填充 div

> ID：10728189
> 
> 赞同：2
> 
> 时间：2012-05-23T21:32:50.553
> 
> 标签：javascript, jquery, .net, html

我遇到了这个问题，我似乎无法如愿。

我用：

```
$('#DIV').html("<%=DIVContent%>"); 
```

函数 DIVContent（.NET C 清晰代码）基本上动态地返回（a）页面的内容。AJAX 不是一个选项（跨域），因此必须在服务器端获取它。服务器端功能还进行必要的剥离（用 ' 替换“等）。这一切正常，html 正确进入 div。

现在我有一个页面，里面有一些 jQuery 代码。这会导致我的 .html(...) 中断。我已经尝试了很多东西，比如 htmlEncoding 等来完成这项工作，但无济于事。

谁能告诉我需要采取哪些步骤？

编辑：另外，我得到的 javascript 错误是： ulterminated string literal $('#DIV').html("........") 编辑二：Orbiting Eden 做了一些很好的开箱即用的思考，它是现在解决了。我现在使用 <%DIVContent%> 直接插入内容，而不是使用 .html() 用 jQuery 填充 DIV。归功于他的不同想法:-)顺便说一句，如果有人知道为什么 .html() 在插入 JavaScript/jQuery 代码时失败以及如何解决它.. 请回复:) 非常感谢！

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:37:01.657

尝试：

```
<div id="one"><%=DIVContent%></div> 
```

这是最直接的解决方案。经过深思熟虑，我根本看不到您需要在哪里涉及 javascript

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:53:31.933

问题是：
在 $().html("") 引号内，您根本无法粘贴其他双引号。.. “ “ 这些。
这是因为如果现在有多个：P，javascript会感到困惑

，因为我不熟悉ASPX，所以我会给你php代码，只需简单地将所有“字符替换为：\”（正斜杠转义它）

```
$('#DIV').html("<?php echo str_replace('\"','\\\"',$DIVcontent); ?>"); 
```

# r - R基础包网格不产生输出

> ID：10728190
> 
> 赞同：2
> 
> 时间：2012-05-23T21:32:58.260
> 
> 标签：r, amazon-ec2, windows-server-2008

我在 Windows Server 2008 R2 Amazon EC2 实例上运行 64 位 R 2.15.0。`grid`不产生输出。例如，以下代码应在设备窗口中生成一条对角线：

```
grid.newpage()
l <- linesGrob()
grid.draw(l) 
```

然而，我什么也看不见。我应该在 Windows Server 2008 R2 上使用标志或选项来启用网格输出吗？

编辑：另一个适用于我家（Windows 7 x64）和工作 PC（Windows XP）的可重现示例：

```
library(grid)
library(png)

img.path <- system.file("img", "Rlogo.png", package="png")
bg <- readPNG(img.path)
background <- rasterGrob(unclass(bg))

grid.draw(background) 
```

这是预期的输出，如我的工作 PC 上所见（调整大小以适合下方）：

![R-log-png](../Images/78d43c9a0ed944f015056d8a82bdeec8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:23:05.127

`dev.list()`可以调用以返回打开图形设备的命名向量。例如，在 Windows 上：

```
windows()
pdf()
dev.list()
# windows     pdf 
#       2       3 
dev.off(); dev.off()
dev.list()
# NULL 
```

并将`dev.cur()`返回当前活动的设备。如果没有设备打开，您可以打开一个：

```
windows()
grid.newpage()
l <- linesGrob()
grid.draw(l) 
```

对于 pdf，您必须确保关闭设备，否则 pdf 文件将无法呈现：

```
pdf() # plot saved by default to Rplots.pdf
grid.newpage()
l <- linesGrob()
grid.draw(l)
dev.off() 
```

`?device`帮助页面列出了其他图形设备。如果没有打开新设备，通常会调用`grid.newpage()`自动打开新设备，但在您的情况下可能不是。以上示例适用于 Windows 7 x64 和 Ubuntu 11.10 x64。

@attitude_stool：以上任何一项是否有助于确定您的问题？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-26T21:15:35.807

`R`无法通过远程桌面连接在窗口设备中正确生成光栅图像。如果需要光栅图像，则必须将绘图输出到另一个设备。

```
library(ggplot2)
library(grid)
library(maps)
library(mapproj)
library(png)
library(RgoogleMaps)

counties <- map_data("county", region="virginia")
states <- map_data("state")

tmp <- tempfile(fileext=".png")
bg <- GetMap.bbox(range(counties$long), range(counties$lat), destfile=tmp, 
     maptype="satellite", format="png32")
background <- readPNG(tmp)
background <- rasterGrob(unclass(background))

p <- ggplot(counties, aes(long, lat)) +
   coord_map(xlim=c(bg$BBOX$ll[2], bg$BBOX$ur[2]), 
             ylim=c(bg$BBOX$ll[1], bg$BBOX$ur[1])) +
   geom_path(aes(group=group), color="darkgrey") +
   geom_path(data=states, aes(group=group), color="white", size=1) +
   opts(axis.line=theme_blank(),
        axis.text.x=theme_blank(),
        axis.text.y=theme_blank(),
        axis.ticks=theme_blank(),
        axis.title.x=theme_blank(),
        axis.title.y=theme_blank(),
        axis.ticks.length=unit(0, "lines"),
        axis.ticks.margin=unit(0, "lines"),
        panel.border=theme_blank(),
        panel.background=function(...)background,
        panel.grid.major=theme_blank(),
        panel.grid.minor=theme_blank(),
        panel.margin=unit(0, "lines"),
        legend.position="none",
        legend.title=theme_blank(),
        legend.background=theme_blank(),
        plot.margin=unit(0*c(-1.5, -1.5, -1.5, -1.5), "lines"))

pdf("plot.pdf", height=7, width=7)
p
dev.off() 
```

我发现在`pdf()`和之间编写绘图命令`dev.off()`会产生空白文件。将绘图存储在对象中并调用它会起作用。

# c# - 从另一个线程和类更新 C# GUI 中的进度条

> ID：10728192
> 
> 赞同：6
> 
> 时间：2012-05-23T21:33:04.320
> 
> 标签：c#, multithreading, progress-bar

> **可能重复：**
> [从另一个线程更新进度条](https://stackoverflow.com/questions/924108/updating-a-progress-bar-from-another-thread)

在我的程序中，我想将非 GUI 功能分离到另一个类中，并将与 GUI 相关的东西留在主类中。但是，当工作人员类中的一种工作方法正在执行其工作时，我在更新进度条时遇到了问题。我知道我将不得不在这里使用多线程，但我不明白如何。我可能只是遗漏了一些简单的东西，但是当我查找有关它的信息时，似乎大多数教程都在谈论细节，但并没有很好地解释大局。我部分了解什么是调用和委托命令，但我并不真正了解它们如何交互。

下面是我想做的精简版。如何修改它以更新进度条，但保持窗口响应和重新绘制？

主窗体类：

```
public partial class Form1 : Form
{
    time_waster thing = new time_waster();

    public Form1()
    {
        InitializeComponent();
        progressBar1.Minimum = 0;
        progressBar1.Maximum = 100;
    }

    private void button1_Click(object sender, EventArgs e)
    {
        thing.something_that_takes_a_while();
    }
} 
```

单独的工人阶级：class time_waster { public time_waster() { }

```
 public void something_that_takes_a_while()
    {
        int delay = 200;
        for (int i = 0; i < 100; i++)
        {
            Thread.Sleep(delay);
            //appropriate code to update the progress bar for each iteration of the for loop.
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T00:56:06.560

.NET 包含一个名为[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)的类，它提供了用于报告事件中后台线程进度的方法。该事件在创建 BackgroundWorker 的线程（通常是 UI 线程）上自动调用。

订阅该“ProgressChanged”事件，并更新该事件处理程序中的进度条。官方 MSDN 文档提供了一些示例代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-23T21:37:23.927

```
MethodInvoker mi = new MethodInvoker(() => progressBar.Value= newProgressValue);
if (progressBar.InvokeRequired)
{
    progressBar.Invoke(mi);
}
else
{
    mi.Invoke();
} 
```

这段代码属于冗长的任务。看：

1.  [调用必填](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invokerequired.aspx)
2.  [调用](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invoke.aspx)
3.  [代表们](http://msdn.microsoft.com/en-us/library/ms173171(v=vs.80).aspx)

Lambda 只是一个过分花哨的词，用于内联声明的函数（或方法），而不是作为类上的方法或支持它们的语言中的原始函数。如果您不将其分配给命名变量，则它是“匿名的”。要小心，因为它们“捕获”了它们所需的变量，如果你不理解它们，它们的行为可能会有点奇怪。

lambda 的语法非常简单：与将内容放入括号中以向 lambda 添加参数`() => someValue;`几乎相同。`public void SomeMethod() { return someValue; }`如果您只有一个参数，请随意跳过括号。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-23T21:40:31.633

```
 static main()
    {
         Thread th = new Thread(calling_function);
         th.start();  
    }

    calling_function()
    {
        //do your work;
        MethodInvoker m = new MethodInvoker( ()=> progressbar.Progress=value);
        progressbar.Invoke(m);
    } 
```

# go - CGO 从 C ** float 获得 [][]float32

> ID：10728197
> 
> 赞同：1
> 
> 时间：2012-05-23T21:33:15.467
> 
> 标签：go

我正在尝试使用与 C 兼容的标头调用 C++ 库中的函数，该函数希望我传入一个 4x4 矩阵以填充它。

我的 Go 函数定义如下所示：

 ~~~~```
func GetMatrix(matrix [][]float32) 
```~~  ~~```
func GetMatrix(matrix []float32) 
```

而 c 头文件定义它是这样的：

```
void getMatrix(const float **matrix) 
```

~~我尝试使用 C.GoBytes 来获取一个字节数组，但是从那里我有点迷失，因为我必须从一个字节数组转到一个指针数组，然后我再次将其转换为一个字节数组，最终是一组浮点数。~~

至少我认为这是我需要做的。

~~我见过用 C 数组数据替换底层 Go 切片的代码示例，但我相信在这些情况下，Go GC 不会收集它们。理想情况下，矩阵 [][]float32 的行为类似于普通的 Go 切片。~~

**编辑：** 文档不正确，底层 C 类型实际上是一个 16 元素浮点数组。

那么问题就变成了，我可以将 C.GoBytes 与指针一起使用，指向数组的指针吗？如果可以，我如何从 []byte 中获取 []float32？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T17:17:17.110

**编辑**这打印正确的东西

```
package main

/*
#include <stdio.h>
void getMatrix(const float **matrix){
    float *m = (float *)matrix;
    int i;
    for(i = 0; i<9; i++) {
        printf("%f\n",m[i]);
    }
}
*/
import "C"
import "unsafe"

func main() {
    a := []float32{1,2,3,4,5,6,7,8,9}
    C.getMatrix((**C.float)(unsafe.Pointer(&a[0])))
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:45:25.727

这是一种将指向 go 数组的指针传递给 C 函数的方法，因此 C 函数可以填充它：

```
package main
/*
#include <stdio.h>
void getMatrix(float *m) {
    int i;
    for(i = 0; i < 16; i++) {
        m[i] = (float)i;
    }
}
*/
import "C"
import "fmt"
func main() {
    var a [16]float32
    C.getMatrix((*C.float)(&a[0]))
    fmt.Println(a)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:55:59.857

我认为你必须使用的 Go 类型是

```
*[16]*float32 
```

在任何情况下， [][]float32 永远不会与 C 的 **float 兼容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T06:25:55.403

指向 4x4 数组的指针的类型为`*[4]*[4]float32`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-30T04:32:49.173

扩展 Inuart 提供的答案：

```
package main

/*
#include <stdio.h>
void getMatrix(const float **matrix){
    float *m = (float *)*matrix;
    int i;
    for(i = 0; i<16; i++) {
       printf("%f\n",m[i]);
    }
}
*/
import "C"

import "unsafe"

func main() {
    // Create the contiguous 16 element array, but organise it how it is described.
    a := [4][4]float32{
        {1, 2, 3, 4},
        {5, 6, 7, 8},
        {9, 10, 11, 12},
        {13, 14, 15, 16},
    }
    m := &a // Take the pointer.
    C.getMatrix((**C.float)(unsafe.Pointer(&m))) // Take the handle and pass it.
} 
```

这为您提供了您似乎要求的句柄行为，并且具有 Go 中数据的形状似乎是 C API 要求的优势 - 无需回避易用性和安全性去吧，只是因为你正在与 C 交互。~~~~

# asp.net-mvc-3 - 级联下拉列表在发布后丢失选择的项目

> ID：10728206
> 
> 赞同：0
> 
> 时间：2012-05-23T21:33:47.743
> 
> 标签：asp.net-mvc-3, cascadingdropdown, model-validation

我有一个 MVC3 razor 项目，我正在尝试使用多个可重用元素来构建它。我有很多模型类，如下所示

```
public class ProductCreateModel
    {
        [Required]
        [Display(Name = "Org")]
        [UIHint("MyOrgsDropDown")]
        public string orgName { get; set; }

        [Required(ErrorMessage = "Select an account")]
        [Display(Name = "Account")]
        [UIHint("MyAccountsDropDown")]
        [AdditionalMetadata("orgFieldId", "orgName")]
        [AdditionalMetadata("fieldId", "accountName")]
        public string accountName { get; set; }
    } 
```

我在此示例中省略了其他字段

MyAccountsDropDown.cshtml 看起来像这样：

```
@{  
var values = ViewData.ModelMetadata.AdditionalValues;
string orgFieldId = (string)values["orgFieldId"];
string fieldId = (string)values["fieldId"];
}
<script type="text/javascript">
$(document).ready(function () {
    $("#@orgFieldId").change(function () {
        var idProd = $(this).val();
        $.getJSON("/JsonService/GetAccounts", { orgId: idProd },
            function (myData) {
                var select = $("#@fieldId");
                select.empty(); 
                $.each(myData, function (index, itemData) {
                    select.append($('<option/>', {
                        value: itemData.Value,
                        text: itemData.Text
                    }));
                });
            });
    });
});
</script>

@Html.DropDownList("", new SelectList(Enumerable.Empty<SelectListItem>(), "Value", "Text"), "---Select---", new { id = fieldId }) 
```

我的控制器方法如下所示：

```
 [HttpGet]
    public ActionResult AddProduct()
    {
        return PartialView("_AddProduct");
    }

    [HttpPost]
    public ActionResult AddProduct(ProductCreateModel model)
    {
        if (!ModelState.IsValid)
        {
            return PartialView("_AddProduct", model);
        }

        //do some stuff

        return PartialView("_AddProduct");
    } 
```

所以当视图打开时（作为一个 jQuery 对话框），我已经设置好了表单。如果我选择一个 orgName，它会从数据库中提取 accountName（级联）。现在，由于我正在使用模型验证，当我没有填写所有必填字段并按提交时，它会向我显示验证消息。它还显示了我在提交之前已经输入的字段的预填充值。删除的是级联下拉值。因此它会继续显示选定的 orgName，但 accountName 下拉列表会丢失数据库中先前填充的值。

如何在单击提交之前维护已拉取的 SelectItems

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:52:07.643

将 javascript 部分中的代码更改为：

```
 $("#@orgFieldId").change(function () {
      var idProd = $(this).val();
      $.getJSON("/JsonService/GetAccounts", { orgId: idProd },
          function (myData) {
              var select = $("#@fieldId");
              select.empty(); 
              $.each(myData, function (index, itemData) {
                  select.append($('<option/>', {
                      value: itemData.Value,
                      text: itemData.Text
                  }));
              });
          });
  });

  $(document).ready(function () {
    $("#@orgFieldId").change();
  }); 
```

# jquery - 在屏幕上放置一个窗口

> ID：10728207
> 
> 赞同：10
> 
> 时间：2012-05-23T21:33:57.930
> 
> 标签：jquery, resize, window, position

有没有办法将使用 jQuery 打开的窗口定位到屏幕的右上角？

这是我现在拥有的代码：

```
$(document).ready(function() {
    $("#dirs a").click(function() {
        // opens in new window
        window.open(this.href, "customWindow", "width=960, height=1040");
        return false;
    });
}); 
```

而且我希望它在屏幕的右上角打开，类似于在 Vista 或更高版本中使用 Windows Aero snap“捕捉”时的显示方式。有没有办法做到这一点？

顺便说一句，这是一个只有我会使用的简单页面，而且我只会在 1920x1080 显示器上的 Chrome 中使用它，因此它不需要任何花哨的东西来调整不同的浏览器或屏幕尺寸。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-23T21:40:05.573

如果他想要它在右上角，他不需要这个吗？

```
window.open(this.href, "customWindow", "width=960, height=1040, top=0, left=960"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-23T21:47:32.473

JavaScript window.open 接受很多参数。对于您的特定情况，顶部和左侧就足够了。

请参阅工作[小提琴示例！](http://jsfiddle.net/zuul/jB6AY/)

**语法**

```
window.open([URL], [Window Name], [Feature List], [Replace]); 
```

**功能列表**

![在此处输入图像描述](../Images/e5674401880c68e8c4330bed07c26ae2.png)

**满足您需求的工作示例**

```
<script type="text/javascript">
<!--
function popup(url) 
{
 var width  = 960;
 var height = 1040;
 var left   = screen.width - 960;
 var top    = 0;
 var params = 'width='+width+', height='+height;
 params += ', top='+top+', left='+left;
 params += ', directories=no';
 params += ', location=no';
 params += ', menubar=no';
 params += ', resizable=no';
 params += ', scrollbars=no';
 params += ', status=no';
 params += ', toolbar=no';
 newwin=window.open(url,'customWindow', params);
 if (window.focus) {newwin.focus()}
 return false;
}
// -->
</script>

<a href="javascript: void(0)" 
   onclick="popup('popup.html')">Top Right popup window</a> 
```

**注意：** 这将计算屏幕宽度以`left`正确设置。

*考虑到您使用的是高度较大的窗口，通常屏幕大于高度...*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T21:37:19.700

```
$("#dirs a").click(function(e) {
    e.preventDefault();
    var popupWidth = 960;
    var leftPos = screen.width - popupWidth;

    window.open(this.href, "customWindow", "width=" + popupWidth + ", height=1040, top=0, left=" + leftPos);
}); 
```

这是一个[例子](http://jsfiddle.net/MpjMX/1/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T21:38:16.933

```
window.open(this.href, "customWindow", "width=960, height=1040, top=0, left=0"); 
```

其他窗口属性：

```
Property         Default value   Description
width            auto            specifies width of the new window in pixels
height           auto            height of the window in pixels
top              auto            specifies window position
left             auto            specifies window position
directories      no              should the directories bar be shown? (Links bar)
location         no              specifies the presence of the location bar
resizable        no              specifies whether the window can be resized.
menubar          no              specifies the presence of the menu bar
toolbar          no              specifies the presence of the toolbar
scrollbars       no              specifies the presence of the scrollbars
status           no              specifies the presence of the statusbar 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-23T21:42:03.863

这是正确的..您需要先计算屏幕的宽度。

```
var leftPos = screen.width - 960;
window.open(this.href, "customWindow", "width=960, height=1040, top=40, left="+leftPos+"); 
```

# wpf - 如何从WPF中的另一个窗口调用方法

> ID：10728209
> 
> 赞同：2
> 
> 时间：2012-05-23T21:34:04.817
> 
> 标签：wpf

我有两个窗口`win1`用于显示用户列表，另一个`win2`用于添加用户。

我还有一种在删除或更新或添加用户后刷新网格的方法。该方法在`win1`.

`win2`添加用户后如何调用此方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:03:04.843

这是一个非常基本的面向对象设计问题。因此，您希望能够在添加用户后回调`win2`到函数。那么，是否有对该对象的引用？如果是这样，那么这就是你所说的。如果没有，那么你需要给它一个（将它传递给构造函数或其他东西）。`win1``win2``win2``win1`

或者，如果您使用的是 MVVM 框架，则可以使用 Messenger。大多数 MVVM 框架都包含一个，它们非常有用。我建议走那条路，除非这是某种一次性程序，管道不值得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:03:28.060

*   您可以在父
    窗口侦听 的子窗口中使用自定义事件

*   您可以在子窗口中定义一个委托，该委托引用父窗口中的方法

*   您可以使用某种形式的信使：这是一个示例：http:
    [//blog.galasoft.ch/archive/2009/09/27/mvvm-light-toolkit-messenger-v2-beta.aspx](http://blog.galasoft.ch/archive/2009/09/27/mvvm-light-toolkit-messenger-v2-beta.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T00:47:09.490

如果您从 Window 1 打开 Window 2，您可以执行以下操作：

```
// code in Window1
public void AddNewUser()
{
    Window2 window = new Window2();
    if (window.ShowDialog() == true)
    {
        // Update DataGrid
        RefreshDataGrid();
    }
} 
```

# c# - 确保控制留在多语言界面中的区域

> ID：10728211
> 
> 赞同：0
> 
> 时间：2012-05-23T21:34:07.970
> 
> 标签：c#, wpf, localization, controls

我有一个布局，我正在尝试制作多语言，但随着过渡而来的是一些障碍。

英语：

![在此处输入图像描述](../Images/24acd7d00892352acbaf238c5561c392.png)

德语：

![在此处输入图像描述](../Images/bd08d79d101b45283bb21902626993eb.png)

如您所见，复选框在网格中飞来飞去，我怎样才能对其进行排序以不与其他控件发生冲突？

谢谢

使用 XAML 编辑：

```
<Grid x:Name="Block" Margin="23,70,24.002,153">
            <Rectangle Fill="#FFDDDDDD" Stroke="#FFD7D7D7" Height="54" VerticalAlignment="Top" RadiusX="2" RadiusY="2"/>
            <Rectangle Fill="#FFE8E8E8" Margin="0,19,0,0" Stroke="#FFD7D7D7"/>
            <Label Height="22" Content="{Binding Source={StaticResource localisation}, Mode=OneWay, Path=.[Language.settings]}" HorizontalAlignment="Left" VerticalAlignment="Top" FontSize="10" FontFamily="Myriad Pro" Foreground="#FF585858"/>
            <TextBox MaxLength="2" x:Name="textTimeMin" Margin="175.145,34.336,0,0" TextWrapping="NoWrap" VerticalAlignment="Top" FontFamily="Myriad Pro" Style="{DynamicResource style1Text}" Height="25.2" HorizontalAlignment="Left" Width="30"/>
            <TextBox MaxLength="2" x:Name="textTimeHour" Margin="132.868,34.336,0,0" TextWrapping="NoWrap" VerticalAlignment="Top" HorizontalAlignment="Left" Width="30" FontFamily="Myriad Pro" Style="{DynamicResource style1Text}" Height="25.2"/>
            <Label Content=":" HorizontalAlignment="Left" Margin="162.868,35,0,0" FontSize="11" Foreground="#FF585858" FontFamily="Myriad Pro" VerticalAlignment="Top"/>
            <Label Content="{Binding Source={StaticResource localisation}, Mode=OneWay, Path=.[Language.timeOptions1]}" HorizontalAlignment="Left" Margin="6.148,36.332,0,0" VerticalAlignment="Top" FontSize="11" Foreground="#FF585858" FontFamily="Myriad Pro" Height="23.2"/>
            <Label Content="{Binding Source={StaticResource localisation}, Mode=OneWay, Path=.[Language.timeOptions2]}" HorizontalAlignment="Left" Margin="6.148,67.999,0,52.799" FontSize="11" Foreground="#FF585858" FontFamily="Myriad Pro" Height="23.202"/>
            <Custom:DatePicker x:Name="pickerDate" Margin="134,68.149,188,51.851" d:LayoutOverrides=", Height" FontFamily="Myriad Pro" IsTodayHighlighted="False" Foreground="#FF585858"/>
            <Button x:Name="btnAddTask" Content="{Binding Source={StaticResource localisation}, Mode=OneWay, Path=.[Language.addTask]}" HorizontalAlignment="Left" Margin="8,0,0,8" VerticalAlignment="Bottom" Style="{DynamicResource style1Btn}" Click="btnAddTask_Click" Height="24.65"/>
            <CheckBox x:Name="checkIgnoreDate" Content="{Binding Source={StaticResource localisation}, Mode=OneWay, Path=.[Language.ignoreDate]}" HorizontalAlignment="Right" Margin="0,0,105,55.706" VerticalAlignment="Bottom" Foreground="#FF585858" Background="{x:Null}" Checked="checkIgnoreDate_Checked" Unchecked="checkIgnoreDate_Unchecked" Height="15.96"/>
            <Rectangle x:Name="ignoreDateStrike" Fill="#FF444444" Height="1" Margin="6.148,0,199.32,64" VerticalAlignment="Bottom" Visibility="Collapsed"/>
            <Button x:Name="btnNow" Content="{Binding Source={StaticResource localisation}, Mode=OneWay, Path=.[Language.now]}" Margin="206.088,34.27,176.585,0" VerticalAlignment="Top" Style="{DynamicResource style1Btn}" Height="25.2" FontSize="9.333" Click="btnNow_Click"/>
        </Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:54:30.563

鉴于您的屏幕截图和代码，您可以通过几种不同的方式来解决此问题。

我建议使用具有三列和三行的网格，其中列是自动调整的。这将确保无论您的字段有多长，所有内容都可以很好地排列并很好地适合。

![在此处输入图像描述](../Images/cb26059559d646208de5e8f0a5a2bbef.png)

您的网格代码看起来像这样：

```
<Grid x:Name="Block">
<Grid.RowDefinitions>
    <RowDefinition Height="Auto" />
    <RowDefinition Height="Auto" />
    <RowDefinition Height="*" />
</Grid.RowDefinitions>
<Grid.ColumnDefinitions>
    <ColumnDefinition Width="Auto" />
    <ColumnDefinition Width="Auto" />
    <ColumnDefinition Width="*" />
</Grid.ColumnDefinitions>
...   
</Grid> 
```

然后，您只需为网格内的每个项目设置适当的行和列，而不是硬编码它们的边距。

```
 <Button x:Name="btnAddTask" Grid.Row="1" .... /> 
```

# php - 使用下拉列表中显示的信息创建 PHP 数组

> ID：10728215
> 
> 赞同：0
> 
> 时间：2012-05-23T21:34:30.830
> 
> 标签：php, arrays, drop-down-menu

我有一个数组，其信息基本上只是一个整数列表，然后与这些整数一致的是每个整数的特定计算值。该数组的大小将取决于输入的值，但不会超过 10 个条目。

我想创建一个下拉菜单，用户可以选择这些整数之一，然后将向用户显示一致的计算。我还需要默认选择一个特定值（取决于计算），作为一种“最佳”答案。

我需要显示的一件可能的事情：

下拉选项：1 2 3

显示的一致选项 23.536 36.577 40.164

自动选择的值是第二个条目（取决于计算）。数组可以是 1-10 个条目。

感谢所有的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:38:34.623

提问者没有给出初始代码：通过 for 或 while 循环遍历数组 -`li`为每个条目构建列表项 ()。那么如果您希望处理计算客户端，则需要绑定一些 JS 或者构建一种通过对服务器的请求接受值并以实物形式响应的机制。祝你好运玩得开心！

# c++ - C++ 中的 Fif 游戏

> ID：10728217
> 
> 赞同：0
> 
> 时间：2012-05-23T21:34:52.623
> 
> 标签：c++

Fif Game：标有 1-9 的 9 个方格。我轮流对抗计算机，在 9 个方格中的每一个上放置一个 X 或 O。第一个获得总和为 15 且至少有 3 个方格的人获胜。

我正在尝试完成 Fif 游戏的 C++ 程序。我在网上找到了一些井字游戏代码。我借用了其中的一些，稍微修改了一下（但我还没有完成），然后把它做成了“Fif”游戏。它可以工作，除了一些事情。索引偏离 1（这是次要的）。此外，更重要的是，它需要三样东西。1.静态评估来判断电脑的动作。2\. 移动生成器 3\. Alpha-Beta 修剪。我没有完全使用老师给我们这个作业的模板，但他确实有一个完整的 alpha-beta 函数，我认为这是我唯一缺少的，因为该程序基本上可以工作。我将发布 alpha-beta，然后发布我所拥有的。基本上我需要帮助把所有东西放在一起。

```
 float AlphaBeta(State S, Ply N, float Alpha, float Beta)
  //Recusively score state S using evaluation function Eval
  //and an N - Ply state space graph.
  {
    State Next;
    ListIndex I;
    float V, Value, BestScore;
    List L;                   //successors of S at this level

    if ((N == 0) || Terminal(S))
    {
      Value = Eval(S);
      T[S] = Value;    //record values only to confirm cut offs

    if (Value > 100)            //machine win
      return INT_MAX;
    else if (Value < -100)      //machine loss
      return  -INT_MAX;
    else if (Value == 0)        //draw
      return 0;
    else
      return Value;
    }
    else
    {
      if (MachineMove(N))         //program's move
    BestScore = Alpha;
      else
    BestScore = Beta;

      I = 1;
      while (I <= MaxNum)
      {
    Next = Child(S, I);
    V = AlphaBeta(Next, N - 1, Alpha, Beta);

    if (MachineMove(N))       //program's move
    {
      BestScore = Max(V, BestScore);
      Alpha = BestScore;
      if (Alpha >= Beta)
      {
        BestScore = Beta;
        I = MaxNum;           //prune remaining S successors
      }
    }
    else
    {
      BestScore = Min(V, BestScore);
      Beta = BestScore;
      if (Alpha >= Beta)
      {
        BestScore = Alpha;
        I = MaxNum;           //prune remaining S successors
      }
    }
    I = I + 1;
      }
      return BestScore;
    }
  }

//My Fif Program itself

#include<iostream>
#include<string>
#include<vector>
#include<algorithm>
using namespace std;
//global constants
const char X = 'X';
const char O = 'O'; 
const char EMPTY = ' ';
const char TIE = 'T';
const char NO_ONE = 'N';
// function prototypes 

char askYesNo(string question);
int askNumber(string question, int high, int low = 1);
char humanPiece();
char opponent(char piece);
void displayBoard(const vector<char>& board);
char winner(const vector<char>& board);
int humanMove(const vector<char>& board, char human);
bool isLegal(const vector<char>& board, int move);
int humanMove(const vector<char>& board, char human);
int computerMove(vector<char> board, char computer);
void announceWinner(char winner, char computer, char human);
//main function
int main()
{

int move;
const int NUM_SQUARES = 9;
vector<char> board(NUM_SQUARES, EMPTY);
char human = humanPiece();
char computer = opponent(human);
char turn = X;
int ChoiceToPlayAgain;
string question;

cout << "Welcome to the 'Fif' Game!  You are competing aganst the computer."<<endl;  
cout << "Below is the board that you are using.  The object of the game is to" <<endl;
cout << "make your values to where you can get 3 of the values to sum to 15."<<endl;  
cout << "Valid input values are from 1-9" <<endl<<endl;

cout<<"123456789"<<endl;
displayBoard(board);
while (winner(board) == NO_ONE)
{
if (turn == human)
{
move = humanMove(board, human);
board[move] = human;
}
else
{
move = computerMove(board, computer);
board[move] = computer;
}
cout<<"123456789"<<endl;
displayBoard(board);
turn = opponent(turn);
}
announceWinner(winner(board), computer, human);
system("pause");
return 0;
}

char askYesNo(string question)
{
char response;
do
{
cout << question << "(C/Y): ";
cin >> response;
} while (response != 'y' && response != 'n');
return response;
}
int askNumber(string question, int high, int low)
{
int number;
do
{
cout << question << " (1-9): ";
cin >> number;
}while (number > high || number < low);
return number;
}
char humanPiece()

{
char go_first = askYesNo("Should I start or you?");
if (go_first == 'Y')
{
cout << "Make your move:";
return X;
}
else
{
cout << "I will start:";
return O;
}
}
char opponent(char piece)
{
if (piece == X)
return O;
else
return X;
}
void displayBoard(const vector<char>& board)
{
cout << board[0] << board[1] << board[2]<< board[3] << board[4] << board[5]<< board[6] << board[7] << board[8];

cout << "\n\n";
}
char winner(const vector<char>& board)
{
//all possible winning rows
const int WINNING_ROWS[8][3] = { 
{4,9,2},
{3,5,7},
{8,1,6},
{4,3,8},
{9,5,1},
{2,7,6},
{4,5,6},
{2,5,8}
 };
const int TOTAL_ROWS = 8;
//if any winning row has three value that are the same (and not EMPTY),
// then we have a winner
for(int row = 0; row < TOTAL_ROWS; ++row)
{
if ( (board[WINNING_ROWS[row][0]] != EMPTY) &&
(board[WINNING_ROWS[row][0]] == board[WINNING_ROWS[row][1]]) &&
(board[WINNING_ROWS[row][1]] == board[WINNING_ROWS[row][2]]) )
{
return board[WINNING_ROWS[row][0]];
}
}
//since nobody has won, check for a tie (no empty squares left)
if (count(board.begin(), board.end(), EMPTY) == 0)
return TIE;
// since nobody has won it isn't a tie, the game ain't over 
return NO_ONE;
}
bool isLegal(int move, const vector<char>& board)
{
return (board[move] == EMPTY);
}
int humanMove(const vector<char>& board, char human)
{
int move = askNumber("Where will you move?", (board.size()-1));
while (!isLegal(move, board))
{

cout << "\nThis square is already taken, choose a different square. \n";
move = askNumber("Where will you move?", (board.size()-1));
}
return move;
}
int computerMove(vector<char> board, char computer)
{
cout << "I'll take number: ";
//if computer can win on next move, make that move
for(int move = 1; move < board.size(); ++move)
{
if (isLegal(move, board))
{
board[move] = computer;
if (winner(board) == computer)
{
cout << move << endl;
return move;
}
//done checking this move, undo it
board[move] = EMPTY;
}
}
//if human can win on next move, block that move
char human = opponent(computer);
for(int move = 1; move < board.size(); ++move)
{
if (isLegal( move, board))
{
board[move] = human;
if (winner(board) == human)
{ 
cout << move << endl;
return move;

}
// done checking this move, undo it
board[move] = EMPTY;
}
}
// the best moves to make, in order
const int BEST_MOVES[] = {5,4,2,8,6,9,3,7,1};
// since no one can win on next move, pick best open square
for(int i = 1; i <board.size(); ++i)
{
int move = BEST_MOVES[i];
if (isLegal(move, board))
{
cout << move << endl;
return move;
}
}
}
void announceWinner(char winner, char computer, char human)
{

if (winner == computer)
{
cout << winner << "'s won!\n";
cout << "3 of my numbers sums to 15, so you lose! "<<endl;
}
else if (winner == human)
{
cout << winner << "'s won!\n";
cout << "3 of your numbers sums to 15, so you win!" <<endl;

}
else
{
cout << "Nobody reached a sum of 15 after board is filled, so it's a tie." << endl;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:40:18.460

您不能将教授的 alpha beta 修剪应用到您的程序中，因为您的程序缺少静态评估。

您需要一个函数，在给定电路板配置的情况下，该函数会产生一个值，即该配置对计算机的“好”程度。

您的 AI 在您的 computerMove() 函数中，并且您制定了一些明确的规则：

1）如果我可以在下一步中获胜，就拿下
2）如果人类可以在一步中获胜，就阻止它
3）否则，采取下一个可用的“最佳”举动

您必须将这些规则转换为数值。该函数应该为更理想的板（对于计算机）返回更高的值。因此，计算机获胜的棋盘价值最高。一个他可以一举获胜的棋盘会稍微少一些。人类获胜的棋盘的值为 0，以此类推。

一旦你有了这个神奇的功能，你的计算机就需要创建所有可能的电路板配置（可能用于创建树的多圈）并评估它们的“优点”。alpha-beta 修剪将应用于创建的板配置树，用于修剪不再需要评估的分支 b/ca 已经确定了更好的选择。

如果您想应用 minimax-ing 和 alpha-beta 修剪，看起来您还有相当多的工作要做。祝你好运！

# mysql - 合并数据库记录的推荐技术

> ID：10728219
> 
> 赞同：2
> 
> 时间：2012-05-23T21:35:02.487
> 
> 标签：mysql, database, design-patterns, database-design, merge

我正在开发一个基于数据输入流定期创建数据库记录的系统。偶尔会出现一些输入，证明两个独立创建的记录应该合并为一个。我正在寻找有关在数据库中实现合并的方法的建议。

主表（此时只是一个设计）包含由唯一 ID（称为主 ID，由数据库分配，我的系统中的 MySQL）和一些数据字段组成的记录。还有一些其他表使用主 ID 将其记录链接到主表中的记录。

```
MainTable:
int   mainID
blob  data
...

OtherTable:
int   otherID
int   mainID
blob  otherData
... 
```

现在，如果从未将每条记录共享给任何外部进程或系统，则可以直接以某种方式将一条记录中的数据字段混合到另一条记录中并删除该记录的记录。将其他表中的主 ID 字段更新为我们保留的主 ID 值也很简单（如果乏味和/或效率低下）。

当每条记录的 ID 在系统外共享时，事情就会变得复杂。在这种情况下，我认为使用那些已删除的 ID 的查询完全失败应该是不合理的，尽管我可能会被说服。

我正在考虑的一个想法是引入一个包含两个关键字段的合并表：原始主 ID 和当前主 ID。其目的是将一个主 ID 别名为另一个主 ID。在创建每个主表记录时，我们向合并表添加一条记录，将新创建的主表记录的主 ID 映射到自身。如果发生合并，我们只需使用正在合并的主记录的原始主 ID 更新合并表中记录的当前主 ID 字段。然后，对于基于主 ID 的每个查询，我们通过合并表映射该 ID 以找到我们真正应该使用的有效主 ID。

```
MergeTable:
int   mergeID
int   originalMainID
int   currentMainID 
```

这是一个很好的技术吗？映射能否在 SQL 查询中无缝完成？有没有我应该考虑的标准或更好的技术？

在对这个主题进行研究时，我发现很少有这样的例子。[这个问题](https://stackoverflow.com/questions/7985597/is-there-a-design-pattern-for-merging-duplicate-database-records)很接近，但合并场景与我的不同，或者在我看来是这样。我对数据库有所了解，但绝不是专家，所以我可能不知道要搜索的正确术语。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:00:45.690

我喜欢你的设计理念，但考虑一个你只在合并表中存储替换记录的地方，而不是全部。给定以下查询，这会减少存储并提高速度：

```
SELECT *
  FROM MainTable
  WHERE mainID = 1
UNION ALL
SELECT MainTable.*
  FROM MergeTable
  INNER JOIN MainTable
    ON MainTable.mainID = MergeTable.currentMainID
  WHERE MergeTable.originalMainID = 1
LIMIT 1 
```

这个想法是，在大多数情况下，第一个查询将成功并返回一个结果，而 MySQL 将在满足 LIMIT 后中止第二个查询。如果第一个查询没有返回结果，那么它将继续进行第二个查询并在合并表上执行连接以查看它是否已合并。

根据 MySQL，关于 LIMIT：

> 一旦 MySQL 向客户端发送了所需数量的行，它就会中止查询，除非您使用 SQL_CALC_FOUND_ROWS。

如果合并的记录是例外，而不是规则，那么这将节省很多很多的连接。

如果 UNION 查询太吓人，您也可以使用两个查询来执行此操作。您可以简单地检查记录是否存在，如果不存在，则检查合并表。

# c++ - SQLite。C++Builder 6 CodeGuard 中 sqlite3.c 中的大量“访问溢出”“算术溢出”“资源泄漏”

> ID：10728226
> 
> 赞同：3
> 
> 时间：2012-05-23T21:36:04.250
> 
> 标签：c++, c, sqlite, c++builder, c++builder-6

我有一个 Borland C++Builder 6.0 项目。在这个项目中，我使用 SQLite 库。我使用 sqlite3.c 文件（SQLite 合并 3.7.11）。一切正常。但是当我在 C++Builder 中启用 CodeGuard 时，CodeGuard 在 sqlite3.c 中给了我很多错误。像“访问溢出”“算术溢出”“资源泄漏”。

我试图在项目的数据库中插入 100000 条记录。执行此操作大约需要 130 秒，并且该进程使用的内存根本没有增加。所以我认为实际上没有内存泄漏。

我的问题是：我应该认真对待 sqlite 中的 CodeGuard 错误吗？或者我可以忽略它们吗？也许他们是误报？还是 C++Builder 6 编译器不适合 SQlite？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-15T13:20:26.840

我通过使用`SQLITE_WIN32_MALLOC`定义的选项进行编译消除了这些警告，该选项将 SQLite 配置为使用 Win32 本机堆 API 而不是`malloc()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T04:20:42.180

SQLite 是非常可靠的代码。BCB 6 是一个非常古老的编译器。

我建议 SQLite 代码没问题，但编译器在 CodeGuard 中生成错误代码或误报。

# r - 创建按列范围加权的相似性度量

> ID：10728230
> 
> 赞同：0
> 
> 时间：2012-05-23T21:36:23.617
> 
> 标签：r, matrix, similarity

考虑以下矩阵：

```
structure(list(X1 = c(1L, 2L, 3L, 4L, 2L, 5L), X2 = c(2L, 3L, 
4L, 5L, 3L, 6L), X3 = c(3L, 4L, 4L, 5L, 3L, 2L), X4 = c(2L, 4L, 
6L, 5L, 3L, 8L), X5 = c(1L, 3L, 2L, 4L, 6L, 4L)), .Names = c("X1", 
"X2", "X3", "X4", "X5"), class = "data.frame", row.names = c(NA, 
-6L)) 
```

每列对应一个受访者，每行包含受访者分配给特定对象的排名编号。请注意，排名的范围可能因受访者而异。

我正在尝试创建一个相似性度量，根据每列的范围对距离进行加权。**这是我到目前为止所尝试的：**

```
m <- test
d <- dist(m, "manhattan", diag=FALSE, upper=TRUE)/nrow(m) 
maxmin <- max(m, na.rm=TRUE) - min(m,na.rm=TRUE)
WeightedAgreement <- as.matrix((-1 * d + maxmin) / maxmin) 
```

使用此度量，X1 和 X3 之间的距离 = 0.761，因为 ((1.666 * - 1)+7)/7 = 0.761。

我的公式的问题在于它使用了表中所有值的范围——因此“maxmin”始终为 7，这会使相似度的计算产生偏差。在计算相似度时，我需要使用列的范围而不是表格。第 1 列和第 3 列的最大值应为 4 (5-1)，X1 和 X3 之间的相似度应为 0.583。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:26:27.280

如果我理解正确，我认为您要定义`maxmin`如下：

```
maxmin <- outer(names(m), names(m),
                Vectorize(function(i,j) max(m[c(i,j)], na.rm = TRUE) -
                                        min(m[c(i,j)], na.rm = TRUE)))

#      [,1] [,2] [,3] [,4] [,5]
# [1,]    4    5    4    7    5
# [2,]    5    4    4    6    5
# [3,]    4    4    3    6    5
# [4,]    7    6    6    6    7
# [5,]    5    5    5    7    5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T06:21:26.027

好的，还有一个替代解决方案。这是代码：

```
require(proxy)
m <- test
d <- dist(t(m), "manhattan", diag=FALSE, upper=TRUE)/nrow(m)
f <- function(x,y) max(x,y, na.rm=TRUE) - min(x,y, na.rm=TRUE)
maxmin <- dist(t(test), f, upper=TRUE, diag=TRUE)
RawAgreementWeighted <- as.matrix((-1 * d + maxmin) / maxmin)
diag(RawAgreementWeighted) <- 1 
```

基本上我必须使用函数 f 创建一个最大最小值（maxmin）的距离矩阵。这只能使用包“proxy”中的函数“dist”来完成。

# php - 使用 preg_replace 并保留部分搜索

> ID：10728249
> 
> 赞同：0
> 
> 时间：2012-05-23T21:37:42.320
> 
> 标签：php, regex

使用 preg_match，您可以使用`<name>`它并将其添加到输出数组中。

使用 preg_replace，我想匹配一个 url，例如`"http://<url>\s"`然后将该 url 保留在替换字符串中，例如`"beforetheurl<url>aftertheurl"`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:45:03.487

在替换字符串中使用[反向引用。](http://php.net/manual/en/regexp.reference.back-references.php)

```
echo preg_replace('#http://(\w+).*$#', 'sld = $1', 'http://mysite.com');

// output: sld = mysite 
```

更多来自[手册](http://us.php.net/manual/en/function.preg-replace.php)：

> 替换可能包含 \n 或（自 PHP 4.0.4 起）$n 形式的引用，后一种形式是首选。每个这样的引用都将被第 n 个带括号的模式捕获的文本替换。n 可以是 0 到 99，\0 或 $0 指的是整个模式匹配的文本。左括号从左到右（从 1 开始）计数，以获得捕获子模式的数量。要在替换中使用反斜杠，它必须加倍（“\\”PHP 字符串）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T21:45:12.477

这是我评论的一个例子：

```
<?php

$result = preg_replace("/(matched)/", 'before$1after', "matched");

echo $result; 
```

输出：`beforematchedafter`

[http://codepad.org/PANzOm6c](http://codepad.org/PANzOm6c)

# asp.net-mvc - 用于 Web.config 的 T4MVC

> ID：10728250
> 
> 赞同：4
> 
> 时间：2012-05-23T21:37:42.410
> 
> 标签：asp.net-mvc, appsettings, compile-time, t4mvc, magic-string

[T4MVC](http://t4mvc.codeplex.com/)的好处是它允许您摆脱[文字/魔术字符串](http://en.wikipedia.org/wiki/Magic_string_%28programming%29)。

> T4MVC 是用于 ASP.NET MVC 应用程序的 T4 模板，它创建强类型帮助程序，在引用控制器、操作和视图时消除了文字字符串的使用。

我只是想知道在`Web.config`文件中的应用程序设置方面是否可以有类似的东西：

```
<appSettings>
    <add key="SecurityGuardEmailFrom" value="info@email.net" />
    <add key="PasswordExpiresInDays" value="1" />
    <add key="NumberOfPasswordsToKeep" value="5" />
</appSettings> 
```

所以，而不是这个：

```
private static readonly int PasswordExpiresInDays =
int.Parse(ConfigurationManager.AppSettings["PasswordExpiresInDays"]); 
```

我们会有这样的事情：

```
MVC.Webconfig.PasswordExpiresInDays 
```

或者

```
MVC.AppSettings.PasswordExpiresInDays 
```

这将有助于在编译时检查应用程序设置是否仍然存在，从而避免运行时错误。

这甚至可行吗？如果是，您知道是否已经在某处实施了与此类似的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T22:47:38.460

好吧，很有趣，在我发布了这个问题后，我用不同的词在 Google 上搜索并找到了一些东西：一个 T4 模板，它内置了很好的错误处理......这是帖子：

[配置文件中 AppSettings 访问的 T4 模板](http://www.wynia.org/wordpress/2010/04/t4-template-for-appsettings-access-in-config-files)

我不得不更改帖子中提供的 T [4 模板代码](http://dl.dropbox.com/u/2041744/SoftwareProjects/AppSettings.tt)，以使其在我当前的环境中工作（VS 11 Beta + ASP.NET MVC 4 应用程序）。

## 如何使用？

例如，下载[`AppSettings.tt`](http://dl.dropbox.com/u/2041744/SoftwareProjects/AppSettings.tt)T4 模板文件并将其放在 ASP.NET MVC 的根目录中。将文件包含在您的项目中，然后右键单击它并选择`Run Custom Tool`，您就完成了。`AppSettings`您的所有应用程序设置都将提供一个名为的新类。惊人的！:)

这些是我正在使用的导入：

```
<#@ template language="C#" debug="true" hostspecific="true" #>
<#@ output extension=".cs" #>
<#@ Assembly Name="System.Core.dll" #>
<#@ assembly name="EnvDTE" #>
<#@ Assembly name="System.Configuration"#>
<#@ import namespace="System" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="System.Diagnostics" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Collections" #>
<#@ import namespace="System.Collections.Specialized"#>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.Configuration" #> 
```

中的某些应用程序设置`Web.config`的名称中有一个冒号 (:)，例如`webpages:Version`. 这就是我为使其工作所做的工作：

```
public static string  <#=setting.Replace(":", "")#>
{
    get
    {
        return getConfigSetting("<#=setting#>");
    }
} 
```

注意`setting.Replace`以上。

如果您愿意，还可以调试 T4 模板。只需按照此处描述的步骤操作：

[Tiny Happy Features #1 - Visual Studio 2012 中的 T4 模板调试](http://www.hanselman.com/blog/TinyHappyFeatures1T4TemplateDebuggingInVisualStudio2012.aspx?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20ScottHanselman%20%28Scott%20Hanselman%20-%20ComputerZen.com%29&utm_content=Google%20Reader)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T21:54:47.430

创建自定义配置部分，而不是将您的设置放入`<appSettings>`.

[http://msdn.microsoft.com/en-us/library/2tw134k3.aspx](http://msdn.microsoft.com/en-us/library/2tw134k3.aspx)

> 您可以使用自己的 XML 配置元素扩展 ASP.NET 配置设置。为此，您需要创建一个自定义配置节处理程序。处理程序必须是从 System.Configuration.ConfigurationSection 类继承的 .NET Framework 类。节处理程序解释和处理在 Web.config 文件的特定节中的 XML 配置元素中定义的设置。您可以通过处理程序的属性读取和写入这些设置。

# magento - 如何在 Magento 中检索我们可以应用于对象/项目的所有功能？

> ID：10728253
> 
> 赞同：0
> 
> 时间：2012-05-23T21:37:49.137
> 
> 标签：magento, magento-1.6

我实际上是在我的网站上设置一个站点地图，我已经有一个 sitemap.xml 但我想知道如何建立一个这样的页面：http: [//beta.brickhousesecurity.com/ancillary/sitemap.do](http://beta.brickhousesecurity.com/ancillary/sitemap.do)

因此，我进入了 template/catalagog/seo/sitemap.phtml 并试图弄清楚如何检索所有类别的子类别（及其子类别）。

所以我得到了

```
<?php $_items = $this->getCollection(); 
    $token=1;
?>
<?php if($_items->getSize()): ?>
    <ul class="sitemap">
        <?php foreach ($_items as $_item): ?>
            <li><a href="<?php echo $this->getItemUrl($_item) ?>"><?php echo $_item->name ?></a></li>
    </ul> 
```

但我不知道如何像上面给出的链接那样组织它。

因此我想知道我怎么知道可以应用于 $_item 的所有功能？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:03:57.190

试试 print_r(get_class_methods($_item))。你是这个意思吗？

# open-uri - 打开 uri 错误：无法将哈希转换为字符串

> ID：10728255
> 
> 赞同：2
> 
> 时间：2012-05-23T21:37:52.200
> 
> 标签：open-uri, ruby-1.8.7

我想从 url 获取 xml 内容（比如说[http://stackoverflow.com](http://stackoverflow.com)）。为此，我使用开放 uri。当我做

```
begin
  status = Timeout::timeout(5) {
  getresult = open("http://stackoverflow.com", "UserAgent" => "Ruby-OpenURI").read
}
rescue => e#Timeout::Error => e
  puts e.to_s
end 
```

我收到一条错误消息，提示“无法将哈希转换为字符串”。我不需要任何文件。谁能让我知道我在这里做错了什么！我正在使用 Ruby 1.8.7。

# c - 如何安全地使用新的 Linux 功能？

> ID：10728259
> 
> 赞同：6
> 
> 时间：2012-05-23T21:38:02.783
> 
> 标签：c, linux

我正在编写使用 sched_setaffinity 的代码，它需要内核 2.5.8 或更高版本。我一直在试图找出这些事情是否可能：

1.  具有较旧内核的系统可以优雅地编译它，也许只是完全忽略该代码段​​。
2.  如果我向使用较旧内核的人发送已编译的二进制文件，它将跳过此函数或仅打印警告。

我想我的问题是，如何在使用旧系统时安全地使用新内核函数，而不破坏整个应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:43:40.003

使用`dlopen()`with`NULL`作为文件名，以及`dlsym()`您要使用的功能。如果`dlsym()`成功，则通过返回的函数指针调用该函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T22:47:13.457

您是否试图让您的程序链接或运行？您可以直接通过 glibc 函数调用系统调用，`syscall()`而无需最近的 C 库。显然，在没有支持的早期系统上它会失败（快速测试显示内核为未实现的系统调用号返回 -1 == ENOSYS），因此您需要对此进行测试。

# java - 使用某些条件检索最后 N 行的 Eclipselink 表达式

> ID：10728261
> 
> 赞同：0
> 
> 时间：2012-05-23T21:38:11.410
> 
> 标签：java, sql, eclipselink, expressionbuilder

我有一个包含以下列的表：

```
@Column(name="CTDESTATUS")
private String status;
@Column (name= "CTDEMESSAGE")
private String message;
@Temporal(TemporalType.TIMESTAMP)
@Column (name = "CTDTDATE")
private Date date;
@Column (name = "CTCDSERVICEID")
private String serviceId; 
```

我需要构建一个查询，该查询返回`n`添加到数据库的最后一行，按 分组`serviceId`，其中每一行是包含以下内容之一的旧行`status`：

`START`或`RUNNING`或`PAUSED`或`END_ERROR`或`END_SUCCESS`

并按降序对结果进行排序`date`。我不熟悉 Eclipselink API，我想要这样的东西：

```
ExpressionBuilder builder = new ExpressionBuilder();
Expression exStatus1 = builder.get("status").equal("START");
Expression exStatus2 = builder.get("status").equal("RUNNING");
Expression exStatus3 = builder.get("status").equal("PAUSED");
Expression exStatus4 = builder.get("status").equal("END_ERROR");
Expression exStatus5 = builder.get("status").equal("END_SUCCESS");
Expression exStatus = (exStatus1).or(exStatus2).or(exStatus3).or(exStatus4).or(exStatus5);
Expression exGroup = builder.get("serviceId").distinct();
Expression exOrder = builder.get("date").descending();
ReadAllQuery query = new ReadAllQuery();
query.setReferenceClass(Notification.class);
query.setSelectionCriteria(exStatus);
query.addDescendingOrdering("date");
query.setMaxRows(n); 
```

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:07:56.240

它应该是这样的。我还没有在 IDE 上尝试过，所以它可能有一些错误，但应该让你开始。

```
CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
CriteriaQuery<Notification> cq = criteriaBuilder.createQuery(Notification.class);
Metamodel m = entityManager.getMetamodel();
EntityType<Notification> Notification_ = m.entity(Notification.class);

Root<Notification> root = cq.from(Notification_);

Expression<String> exp1 = criteriaBuilder.upper(root.<String>get("status"));

Predicate predicate1 = criteriaBuilder.like(emp1, "START");
Predicate predicate2 = criteriaBuilder.like(emp1, "PAUSED");
Predicate predicate3 = criteriaBuilder.like(emp1, "RUNNING");
Predicate predicate4 = criteriaBuilder.like(emp1, "END_ERROR");
Predicate predicate5 = criteriaBuilder.like(emp1, "END_SUCCESS");

Predicate predicate = criteriaBuilder.or(predicate1, predicate2, predicate3, predicate4, predicate5)
cq.where(predicate);
cq.orderBy(criteriaBuilder.desc(root.get("date")));

Query query = entityManager.createQuery(cq);
query.setMaxResults(n);
return query.getResultList(); 
```

# windows-7 - 重命名文件夹中的文件以测试依赖关系

> ID：10728264
> 
> 赞同：0
> 
> 时间：2012-05-23T21:38:26.970
> 
> 标签：windows-7, batch-file

我连接到一个连接速度非常慢的网络驱动器（好日子​​为 15 kb/s）。我正在删除大多数文件，但不想破坏一些包含包含语句的文件。这些是企业应用程序的文件（主要用 ColdFusion 编写）。我的想法是在所有文件名前加上一个“_”前缀，以测试我想要保留的几个文件是否搞砸了。我已经搜索了我想要保留的包含语句的文件代码，这只是为了在推送之前进行测试。

有没有我可以运行的脚本可以重命名所有文件和文件夹，但排除 2 个文件夹和其中的文件？如果有更好的方法，我愿意接受选择。

所以我通常会删除所有我认为不需要的文件，但由于网络速度很糟糕，这需要很长时间。由于这是测试我是否犯了错误，可能会有很多删除和取消删除，这就是我想重命名的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T07:01:32.470

如果它是网络驱动器，您可能无权执行脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:39:22.510

我建议附加一个扩展名`._`而不是在名称前加上`_`. 这将使撤消重命名更容易。

```
@echo off
setlocal
set root="X:\"
set skip1="X:\folder1\"
set skip2="X:\folder2\"
for /r %root% %%F in (*) do (
  if /i "%%~dpF" neq %skip1% if /i "%%~dpF" neq %skip2% ren "%%F" "%%~nxF._"
) 
```

要恢复为原始名称：

```
@echo off
setlocal
set root="X:\"
for /r %root% %%F in (*._) do ren "%%F" "%%~nF" 
```

**编辑：**
重命名文件的第一个脚本可以通过使用单个 REN 命令重命名目录中的所有文件来更快。

```
@echo off
setlocal
set root="X:\"
set skip1="X:\folder1\"
set skip2="X:\folder2\"
for /r %root% %%F in (.) do (
  if /i "%%~fF" neq %skip1% if /i "%%~fF" neq %skip2% ren "%%~F\*.*" *.*._
) 
```

恢复名称的第二个脚本必须继续单独重命名每个文件。

我还在所有脚本中添加了 SETLOCAL。

# jquery-mobile - jQuery listview 双滚动条（有时）

> ID：10728271
> 
> 赞同：0
> 
> 时间：2012-05-23T21:39:04.380
> 
> 标签：jquery-mobile, scrollbar

我希望任何人都可以帮助我。我有一个 jQuery 移动页面，在调用 changePage 的 ajax 回调之后得到两个滚动条

```
$.mobile.changePage('#page_with_listview'); 
```

**在 page_with_listview 的pageshow**事件中，我执行 $.AJAX 查找，并在成功回调中填充 listview 并触发刷新：

```
$('#my_listview').listview('refresh') 
```

我得到的结果（不是每次）：

[结果的屏幕截图（我还不允许发布图像）](http://imgur.com/P6Ixk.png)

有没有人知道发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T07:31:48.550

我遇到了类似的问题，并确保在我自己的 themeroller 风格解决了它之后包含了 jquery mobile css。就像是

```
<link rel="stylesheet" href="my-style.min.css" />
<link rel="stylesheet" href="jquery.mobile.structure-1.3.0.min.css" /> 
```

代替

```
<link rel="stylesheet" href="jquery.mobile.structure-1.3.0.min.css" />
<link rel="stylesheet" href="my-style.min.css" /> 
```

# python - 有效地搜索文档中的术语列表

> ID：10728272
> 
> 赞同：0
> 
> 时间：2012-05-23T21:39:22.020
> 
> 标签：python, algorithm, search, nlp, string-matching

我有数千个同义词的列表。我还有数以万计的文档要搜索这些术语。使用python（或伪代码）什么是这样做的有效方法？

```
# this would work for single word synonyms, but there are multiple word synonyms too
synonymSet = set([...])
wordsInDocument = set([...])
synonymsInDocument = synonymSet.intersection(wordsInDocument)

# this would work, but sounds slow
matches = []
for document in documents:
    for synonym in synonymSet:
        if synonym in document:
            matches.append(synonym) 
```

这个问题有没有好的解决方案，还是需要一段时间？先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:04:39.140

如何从同义词列表中构建正则表达式：

```
import re

pattern = "|".join(synonymList)
regex = re.compile(pattern)

matches = regex.findall(document) # get a list of the matched synonyms
matchedSynonyms = set(matches)    # eliminate duplicates using a set 
```

# c# - 最后 N 的 linq 平均值

> ID：10728285
> 
> 赞同：0
> 
> 时间：2012-05-23T21:40:08.897
> 
> 标签：c#, linq, c#-4.0, lambda, vb.net-2010

被看似简单的问题难住了。我有

```
var SummaryCollection = (from n in ...long criteria with group by clause) 
into g select new 
{     MonthYear = g.Key, 
      Amount = g.Sum(p=>p.Amount)}).OrderBy(p=>p.MonthYear);
} 
```

我现在得到看起来像这样的数据

```
Jan2009 $100
Feb2009 $134
... and so on 
```

最后我有

```
 decimal avgAmount = (from x in SummaryCollection select x.Amount).Average(); 
```

我现在需要获取用户在文本框中输入 N 的最后 N 个月的平均值。请告知如何使用 Linq 从有序集合中获取最后 N 的平均值。谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:43:21.620

如果您知道集合（或使用`Count()`）中的项目数，则可以跳过第一个`Count - N`项目：

```
 decimal avgAmount = SummaryCollection.Skip(SummaryCollection.Count() - N)
                                      .Select(x => x.Amount)
                                      .Average(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T22:06:49.400

我创建了一个扩展方法，它使用`Queue<T>`不需要调用`.Count`序列或多次迭代的 a 。

```
public static IEnumerable<T> TakeLast<T>(this IEnumerable<T> @this, int n) {
    var queue = new Queue<T>(n + 1);

    foreach (var element in @this) {
        queue.Enqueue(element);

        if(queue.Count > n) queue.Dequeue();
    }

    return queue;
} 
```

要使用它，如果您的列表被调用`sequence`，只需调用`sequence.TakeLast(n)`以获取最后的`n`记录。

# gnuplot - 如何在 gnuplot 的 eps 和 pdf 终端中实现输出的一致性？

> ID：10728286
> 
> 赞同：6
> 
> 时间：2012-05-23T21:40:13.343
> 
> 标签：gnuplot

我试图在 gnuplot 中的 eps 和 pdf 终端之间获得一些一致的输出。问题是他们似乎对尺寸单位的理解不同。以英寸为单位的相同指定大小将导致 pdf 输出的字体大小更大：

```
set terminal postscript eps enhanced colour size 10in,8in font 'Arial-Bold,14'
set output 'my_eps.eps'
set title 'My plot'
plot sin(x) notitle

set terminal pdfcairo size 10in,8in font 'Arial-Bold,14'
set output 'my_pdf.pdf'
replot 
```

.pdf 中的文本要大得多，而且图形很狭窄。但是，如果我将 eps 的大小单位更改为 cm：

```
set terminal postscript eps enhanced colour size 10cm,8cm font 'Arial-Bold,14'
                                                 ########
set output 'my_eps.eps'
set title 'My plot'
plot sin(x) notitle

set terminal pdfcairo size 10in,8in font 'Arial-Bold,14'
set output 'my_pdf.pdf'
replot 
```

使用错误的单位，输出看起来相同（在一些边距误差范围内）。这是巧合吗？这里发生了什么？

这是针对 Gnuplot 4.4（补丁级别 3）Ubuntu 11.10 测试的。

（我知道我可以使用一些实用程序在 eps 和 pdf 之间进行转换，因此它们是相同的，但我想了解 gnuplot 中发生了什么。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T23:27:02.837

使用同一单位系统中的两个图，这种行为是可以预期的——尽管可能没有很好/准确地记录。（来自`help post`）

```
In `eps` mode the whole plot, including the fonts, is reduced to half of 
the default size. 
```

由于您明确指定了大小，因此该部分会保持不变，但即使您明确指定字体，字体的大小仍会在绘图上缩小 2 倍`eps`（我不知道为什么会这样，但一直都是这样- 我一直认为它至少是文档中的一个错误......）。

至于将单位切换为厘米 - 我不在`cairo`启用终端的计算机旁，所以我现在无法检查......但这似乎很奇怪（对我来说）。是不是因为从英寸到厘米的转换大约是 2 倍，这使得它们看起来如此相似？（例如，您的字体是大小的一半，而您的情节是大小的 1/2.54）

为了实现终端独立性，我想你可以把它写在一个函数中（**当前未测试**）：

```
fontsize(x)=((GPVAL_TERM eq 'postscript') && \
             (strstrt(GPVAL_TERMOPTIONS,"eps")!=0)) ? x*2 : x
set term post eps enh size 10in,8in
set termoption font "Arial,".fontsize(7)
set output "Hello.eps"
plot sin(x)

set term pdfcairo enh size 10in,8in
set termoption font "Arial,".fontsize(7)
set output "Hello.pdf"
plot sin(x) 
```

确保只将整数传递给 fontsize——在进行字符串连接时，整数会被提升为字符串。

**编辑**

在进一步挖掘之后，cairo 库似乎采取了一些自由并嵌入了您没有要求的（类似）字体。

running `pdffonts myfile.pdf`- 请注意，您只需通过以下方式获取字体`strings myfile.pdf | grep FontName`名称：

```
name                 type         emb sub uni object ID
-------------------- ------------ --- --- --- ------ --
LiberationSansBold   CID TrueType yes no  yes      5 0 
```

而后记只包含字体名称（未嵌入），它被 ps 查看器翻译为它可以找到的最接近请求字体的东西（它 [可能] 替换了您也没有要求的字体）。因此，要实现真正的终端独立性（在这两个终端之间），您需要找到嵌入在 pdf 中的字体文件，然后`set postscript eps enh color fontfile add "<fontfile>"`在 pdf 和 postscript 中嵌入相同的字体文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-20T13:06:45.210

## 使用 Ghostscript 实现 100% 的一致性

我使用[Ghostscript](http://ghostscript.com/)将创建的 Encapsulated PostScript (EPS) 图转换`gnuplot`为 PDF。效果很好！

```
gs -dSAFER -dBATCH -dNOPAUSE -sDEVICE=pdfwrite -sOutputFile=output.pdf input.eps 
```

# java - JMS 消息传递是否可以被轮询 Web 服务调用所取代？

> ID：10728289
> 
> 赞同：4
> 
> 时间：2012-05-23T21:40:21.663
> 
> 标签：java, web-services, architecture, jms, messaging

现有场景：两个应用程序正在使用队列进行通信。其中一个始终是生产者，另一个始终是消费者。

“生产者”生成数据并将其保存在自己的存储中。然后它使用队列将其发送给消费者。

我对 JMS 消费者（和侦听器）实现（使用 Spring）的了解越多，似乎我们可以轻松地将消息传递替换为轮询 Web 服务调用。

这是因为 JMS 监听器所做的只是保持线程打开，监听队列。因此，如果您的 JMS 侦听器 ConnectionFactory 设置为有 10 个连接，那么您将有 10 个阻塞线程。

因此，与其保持 10 个线程打开，不如使用 1 个线程每 30 秒左右轮询一次。一个 Poll 可以指示 WebService 在响应中向它发送 100 个数据项（或更多）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:59:20.823

答案是**延迟**。使用 JMS，消息在发送的同一秒就可供消费者使用。使用任何轮询解决方案，您总是会在平均轮询周期的一半左右遇到延迟。

这也会消耗更多的 CPU 和网络，因为轮询消费者必须每隔一秒唤醒一次并执行实际调用。

最后，您必须考虑重复和事务。通过正确设置 JMS，您可以保证收到完全正确的消息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T22:01:39.387

这两者都只是抽象。如果您考虑一下，它只是一个套接字，您正在推送数据。真正不同的是每个抽象所做的保证。太疯狂了，您实际上可以拥有通过 JMS 和使用 HTTP 作为传输的 JMS 提供服务的 SOAP Web 服务。

简而言之，JMS 指定了一组与消息传递（确认、重新传递、故障转移等）相关的保证。Web 服务（大多数人对它们的看法）主要由一组描述消息格式（SOAP、JSON）的规范组成，这些规范位于描述传输（HTTP）的规范之上。

关于投票。大多数 JMS 实现都是推送模型。订阅者向代理注册，并在消息到达时将它们推送给订阅者。推模型比拉模型具有更高的吞吐量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:51:23.410

那么这完全取决于您的要求。拥有基于 JMS 的通信有其自身的优势，例如：

*   非阻塞（异步）消息传递
*   高性能和可靠的负载均衡
*   高吞吐量
*   容错（如果另一端的消费者离线怎么办）

当然，这一切都是有代价的，所以这一切都取决于你的需要。如果您的系统吞吐量较低，每分钟只有几条消息，并且可以忍受由于通信错误而丢失一些消息，那么您可以很好地切换到基于轮询的 Web 服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T21:58:05.970

如果您想实现自己的排队服务，请随意。唯一的主要好处就是不必依赖第三个组件（JMS 服务器）。

如果您担心 10 个额外线程和 10 个额外套接字的资源，那么除了使用 JMS 服务器之外，您确实还有其他问题需要担心。这两个广告的增量成本都不重要。

如果您根本不需要排队，那么只需在线调用 Web 服务并完成它。

如果您自己实现它，那么您必须实现队列、持久性和恢复（当您的系统在第 29 秒出现故障并丢失 100 条未发送消息时）、事务恢复、重新连接逻辑等。

如果我必须为单个队列到单个目的地和单个生产者这样做，并且 JMS 服务器每年花费 X 千美元的许可费等，那么是的，我当然会考虑自己重做那一点逻辑。或者，如果我不想承担 JMS 服务器的内存压力。

但是 JMS 服务器是免费的，它们随我的应用程序服务器一起提供，配置了六次鼠标点击，并且它们“足够快”可以满足大多数需求。它们是当今无处不在的基础设施。

只是几率真的很高，恕我直言，重新发明这个轮子根本不值得。

# php - 适用于 Linux 和 PHP 5.4 的 MSSQL Server 的本机 ODBC 驱动程序

> ID：10728290
> 
> 赞同：15
> 
> 时间：2012-05-23T21:40:30.333
> 
> 标签：php, sql-server, linux, odbc

我在 Linux Debian 6 x64 上有 Apache 2.2.16 和 PHP 5.4.3。

要为 Linux 安装 MSSQL Server 的本机 ODBC 驱动程序，我使用以下说明： http: [//www.codesynthesis.com/~boris/blog/2011/12/02/microsoft-sql-server-odbc-driver-linux/](http://www.codesynthesis.com/~boris/blog/2011/12/02/microsoft-sql-server-odbc-driver-linux/)

我以这种方式配置了我的 odbc.ini 文件：

```
[mydsn]
Driver      = SQL Server Native Client 11.0
Database    = datbase
Server      = xxx.xxx.xxx.xxx,port 
```

和我的 odbcinst.ini 这样：

```
[SQL Server Native Client 11.0]
Description=Microsoft SQL Server ODBC Driver V1.0 for Linux
Driver=/opt/microsoft/sqlncli/lib64/libsqlncli-11.0.so.1790.0
Threading=1
UsageCount=1 
```

为了测试，我运行以下命令：

```
$ isql -v mydsn dbusername dbpassword 
```

我得到了成功：

```
+---------------------------------------+
| Connected!                            |
|                                       |
| sql-statement                         |
| help [tablename]                      |
| quit                                  |
|                                       |
+---------------------------------------+
SQL> 
```

然后，使用 phpize 在 PHP 5.4 上安装 unixODBC，使用以下命令：（使用第一个命令 ln -s ...，因为 ./configure 在默认位置找不到 php 的标头）

```
$ sudo ln -s /usr/include/php5 /usr/include/php
$ phpize
$ ./configure --with-pdo-odbc=unixODBC && make && make test
$ sudo make install 
```

在我的 phpinfo() 上，我得到：

```
PDO support - enabled
PDO drivers - odbc

PDO Driver for ODBC (unixODBC) - enabled
ODBC Connection Pooling        - Enabled, strict matching 
```

现在是时候在 PHP 5.4 脚本上测试所有内容了：

```
<?php
    ini_set('display_errors', 1);
    error_reporting(E_ALL);

    $conn = new PDO('odbc:DSN=mydsn;UID='.$usr.';PWD='.$psw);

    $query = 'select * from my_table'; 
    $stmt = $conn->prepare($query);
    $stmt->execute();
    while ($row = $stmt->fetch()) {
        echo "<pre>";
        print_r($row);
        echo "</pre>";
    }
?> 
```

但它不起作用......我收到此错误消息：

```
Fatal error: Uncaught exception 'PDOException' with message 'SQLSTATE[01000] SQLDriverConnect: 0 
[unixODBC][Driver Manager]Can't open lib '/opt/microsoft/sqlncli/lib64/libsqlncli-11.0.so.1790.0' : file not found' 
in /var/www/testemssql.php:17 
Stack trace: 
#0 /var/www/testemssql.php(17): PDO->__construct('odbc:DSN=mydsn...') 
#1 {main} thrown in /var/www/testemssql.php on line 17 
```

所以我的问题是：发生了什么？我缺少什么配置？如何在 Linux 和 PHP 5.4 上正确设置 MSSQL Server 的本机 ODBC 驱动程序？

Ps.：当我尝试使用 odbc_connect() PHP 时说该函数不存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-31T07:53:58.940

我知道这有点晚了，但是由于我在遇到完全相同的问题时遇到了这个问题，所以这里有一些建议给将来遇到它的人:-)

1) 检查 libsqlncli-11.0.so.1790.0 的权限，以确保 Apache 正在运行的任何用户都可以访问它（应该已读取并执行）

2）使用 ldd 检查是否缺少任何依赖项-基于 isql 在上面工作的事实，我会说它们没问题（提示：您正在寻找“未找到”）：

ldd /opt/microsoft/sqlncli/lib64/libsqlncli-11.0.so.1790.0

3) 尝试从命令行而不是通过 Apache 运行您的 php 脚本。如果它像那样工作，请转到停止 4。如果没有，我建议运行 strace 以查看它实际在做什么。

4）这是为我做的！尝试关闭 SELinux（即设置为不强制/许可模式）并再次点击 Apache 中的页面。我不确定它到底在阻止什么（还没有时间或意愿去了解细节），但一旦它关闭，一切都会像魅力一样发挥作用。对于任何有这种倾向的人，您都可以深入研究它并弄清楚如何在不完全禁用的情况下解决此问题:-)

禁用 SELinux 的确切命令可能因您的操作系统而异，但对我（在 CentOS 上）来说，这很有效：

[http://rbgeek.wordpress.com/2012/08/06/how-to-disable-selinux-on-centos-without-rebooting/](http://rbgeek.wordpress.com/2012/08/06/how-to-disable-selinux-on-centos-without-rebooting/)

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T12:35:40.950

MSSQL Server's Native ODBC Driver for Linux 有一个[bug](https://bugs.php.net/bug.php?id=61777)

要正确连接 MS SQL Server，请使用 FreeTDS 查看更多详细信息：[Linux 上的 PHP 5.4：如何连接 MS SQL Server 2008？](https://stackoverflow.com/questions/10834175/php-5-4-on-linux-how-to-connect-with-ms-sql-server-2008)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T09:22:45.960

相同的配置，除了 odbcinst.ini：

```
[SQL Server Native Client 11.0]
Description=Microsoft SQL Server ODBC Driver V1.0 for Linux
Driver=/opt/microsoft/sqlncli/lib64/libsqlncli-11.0.so.1790.0
UsageCount=1 
```

删除此行后重试：

```
Threading=1 
```

你的 php 脚本对我来说很好。

希望这可以帮助你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T17:11:41.060

[如果您使用附加到https://bugs.php.net/bug.php?id=61777](https://bugs.php.net/bug.php?id=61777)的补丁修补并重新编译 php，它将解决该问题。

另请查看此博客文章以获取有关 DSN 和用法的示例：

[http://strangenut.com/blogs/dacrowlah/archive/2012/04/13/installing-and-using-the-microsoft-sql-server-odbc-driver-for-linux.aspx](http://strangenut.com/blogs/dacrowlah/archive/2012/04/13/installing-and-using-the-microsoft-sql-server-odbc-driver-for-linux.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T23:56:44.460

我自己从来没有机会尝试过，但我听说 php5-sybase 工作正常，我知道它在存储库中可用于 Debian 和 Ubuntu。

# ios - iOS 崩溃 #memcpy

> ID：10728293
> 
> 赞同：1
> 
> 时间：2012-05-23T21:40:35.640
> 
> 标签：ios, nsdata, memcpy

我有一些设置 UIImageView 的 UIImage 的代码。

```
self.image = [[UIImageView alloc] init];
image.image = [UIImage imageWithData:data]; 
```

数据使用设置

> data = [NSData dataWithBytesNoCopy:offsetPointer length:offset->size freeWhenDone:NO];

在调试窗口中，我看到数据包含数据`data = (NSConcreteData *) 0x06a65c80 59621 bytes`

当我尝试分配图像时，我得到了一个 lldb 挂起。

![在此处输入图像描述](../Images/2b4055a415258d34094b52dbc52b8f05.png)

这是什么原因造成的？

# java - 通过servlet/jsp从mysql数据库中删除数据

> ID：10728294
> 
> 赞同：1
> 
> 时间：2012-05-23T21:40:39.153
> 
> 标签：java, mysql, jsp, servlets

我有一个调用 MySQL 数据库的 servlet。

该`deletePage`方法如下所示：

```
public void  deletePage(PageData delete) {
    String firstQuery ="Delete FROM pages Where ID= '"+delete.getId()+"';";

    try {
        statement = connection.createStatement();
        statement.executeUpdate(firstQuery);
        System.out.println("Expense is deleting");

    } catch (SQLException e) {
        System.out.println("Expense isn't deleting - SQLException");
        e.printStackTrace();
    }
} 
```

`delete.jsp`如下：

```
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Add pages</title>
    </head>
    <body>
        <form action="adminController">
            <p>
                <input type="hidden" name="operation" value="deletepage" />
                <input type="hidden" name="parentid" value="<%= request.getParameter("id") %>" />
                Enter ID of page you want to delete:<input name="id"><br>

                <input type="submit" />
            </p>
        </form>
    </body>
</html> 
```

`mainadmin.jsp`: _

```
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Insert title here</title>
    </head>
    <body>
        <%= request.getAttribute("menu") %>
    </body>
</html> 
```

如果您运行此代码，您会看到我的删除按钮位于每个页面名称之后。我想要做的是通过按下页面附近的删除按钮来删除这个页面，应该有类似“你确定要删除吗？”，提交按钮“删除”。但我设法做的是这样的（如在我的代码中）：每当按下删除按钮时，您必须输入要删除的页面的 id，所以无论我按下什么删除按钮，它都会请求 id。但我只想立即删除它。谁能帮忙？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:54:38.017

在 adminController.java 你有

```
else if (operation.equals("delete")) {
    RequestDispatcher dispatcher = request.getRequestDispatcher("/delete.jsp");
    dispatcher.forward(request, response);

} else if (operation.equals("deletepage")) {
    PageData pageData = new PageData();
    pageData.setId(request.getParameter("id"));
    dao.deletePage(pageData);
    response.sendRedirect("adminController");
} 
```

将其更改为

```
else if (operation.equals("delete")) {
    PageData pageData = new PageData();
    pageData.setId(request.getParameter("id"));
    dao.deletePage(pageData);
    response.sendRedirect("adminController");
} 
```

你不需要第二个操作'deletepage'，所以你不需要delete.jsp

# java - Java 小程序 Netbeans 可视化设计

> ID：10728295
> 
> 赞同：1
> 
> 时间：2012-05-23T21:40:41.997
> 
> 标签：java, user-interface, netbeans, designer

我正在使用 Netbeans 中的可视化设计编辑器。我有两个带有相应 JLabels 的滑块。我想要的是一个在移动滑块时改变颜色的矩形。我如何将它与设计者生成的代码结合起来？

如何在滑块附近绘制矩形？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:03:25.443

Java 中的颜色是由`RGB`值组成的。

```
Color c = new Color(red, green, blue) 
```

`Red`,`Green`并且`Blue`都具有`integer`0 到 255 之间的值。Netbeans 可视化编辑器允许您为滑块设置两者`maximum`和`minimum`值。

要为颜色添加透明度，请使用

```
Color c = new Color(red, green, blue, alpha) 
```

`Red`, `Green`,`Blue`和`Alpha`都具有介于 0.0 和 1.0 之间的浮点值。

要在移动滑块时更改颜色，请在拖动鼠标时添加一个事件（您可以使用可视化编辑器执行此操作）并用于`slider.getValue()`检索值。

*要在滑块*附近绘制矩形（应该至少有 3 个滑块，每个 rbg 组件一个）检索滑块的位置和尺寸`slider.getBounds()`（边界包含`x`和`y`坐标加`width`和`height`）

示例（在滑块右侧绘制一个 30x30 20 像素的矩形）

```
private void mouseDragged(java.awt.event.MouseEvent evt) {

    color = new Color(sliderRed.getValue(), sliderGreen.getValue(), sliderBlue.getValue());
    this.repaint();
}

public void paint(Graphics g) {

    g.setColor(color)
    g.fillRect(sliderRed.getBounds().x + sliderRed.getBounds().width + 20, sliderRed.getBounds().y, 30, 30);
} 
```

# c# - 检查控件是否是 TabControl 中的文本框

> ID：10728300
> 
> 赞同：6
> 
> 时间：2012-05-23T21:41:22.243
> 
> 标签：c#, winforms, controls, tabcontrol

为了清除我的文本框，我在表单中使用了以下代码：

```
foreach (Control c in this.Controls)
{
    if (c is TextBox || c is RichTextBox)
    {
        c.Text = "";
    }
} 
```

但现在我的文本框位于 TabControl 中。如何对文本框运行相同类型的检查，如果控件是文本框，请将值设置为“”。我已经尝试过使用：

```
foreach(Control c in tabControl1.Controls) 
```

但这没有用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-23T21:45:54.383

用这个

```
foreach (TabPage t in tabControl1.TabPages)
{
    foreach (Control c in t.Controls)
    { 
        if (c is TextBox || c is RichTextBox)
        {
            c.Text = "";
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-23T21:52:59.683

您也可以使用[`Enumerable.OfType`](http://msdn.microsoft.com/en-us/library/bb360913.aspx). `TextBox`并且`RichTextBox`是唯一继承自 的控件`TextBoxBase`，这是您要查找的类型：

```
var allTextControls = tabControl1.TabPages.Cast<TabPage>() 
   .SelectMany(tp => tp.Controls.OfType<TextBoxBase>());
foreach (var c in allTextControls)
    c.Text = ""; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T21:45:11.260

tabControl1.Controls 不起作用，因为选项卡控件包含`TabPage`s。您需要定位正确的页面。

或者，您可以构建一个递归方法来执行此操作：

```
static void RecurseClearAllTextBoxes(Control parent)
{
    foreach (Control control in parent.Controls)
    {
        if (control is TextBox || control is RichTextBox)
            control.Text = String.Empty;
        else
            RecurseClearAllTextBoxes(control);
    }

    if (parent is TabControl)
    {
        foreach (TabPage tabPage in ((TabControl)parent).TabPages)
            RecurseClearAllTextBoxes(tabPage);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-24T21:47:40.207

Limpiar 控制

```
 foreach (Control C in GB.Controls)
        { 
            if(C is TextBox)
            {
                (C as TextBox).Clear();
            }
            if(C is DateTimePicker)
            {
                (C as DateTimePicker).Value = DateTime.Now;
            }
            if (C is ComboBox)
            {
                (C as ComboBox).SelectedIndex = 0;
            }
        } 
```

# ruby-on-rails - 使用 STI model_name 解决方法的弃用警告

> ID：10728301
> 
> 赞同：5
> 
> 时间：2012-05-23T21:41:28.120
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sti

在我的单表继承模型中，我重写了`inherited`基础模型中的方法，以便所有后代模型都可以通过基础模型的名称来识别。以下代码用于为所有继承类添加对 model_name 方法的覆盖。

```
 def self.inherited(child)
    child.instance_eval do
      def model_name
        BaesModelDefinition.model_name
      end
    end
  end 
```

我注意到这会在 Rails 3.2.3 中产生弃用警告：

```
DEPRECATION WARNING: It looks like something (probably a gem/plugin) is overriding 
the ActiveRecord::Base.inherited method. It is important that this hook executes so 
that your models are set up correctly. A workaround has been added to stop this 
causing an error in 3.2, but future versions will simply not work if the hook is
overridden. 
```

我可以使用另一种方法来解决 model_name 问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T13:21:28.237

答案很简单。只需将 a 添加`super`到覆盖方法即可。

```
 def self.inherited(child)
    child.instance_eval do
      def model_name
        BaesModelDefinition.model_name
      end
    end
    super
  end 
```

# c# - 如何使用 Linq 从 Visual Studio 中的 WebMatrix 数据库中进行选择

> ID：10728303
> 
> 赞同：0
> 
> 时间：2012-05-23T21:41:44.053
> 
> 标签：c#, .net, visual-studio-2010, razor, webmatrix

我们如何使用 Linq 从 Visual Studio 中的 SDF (webmatrix) 数据库中选择数据，就像我们使用北风一样，像这样：？

```
// Northwnd inherits from System.Data.Linq.DataContext.
Northwnd nw = new Northwnd(@"northwnd.mdf");
// or, if you are not using SQL Server Express
// Northwnd nw = new Northwnd("Database=Northwind;Server=server_name;Integrated Security=SSPI");

var companyNameQuery =
    from cust in nw.Customers
    where cust.City == "London"
    select cust.CompanyName;

foreach (var customer in companyNameQuery)
{
    Console.WriteLine(customer);
} 
```

参考：http: [//msdn.microsoft.com/en-us/library/bb399398.aspx](http://msdn.microsoft.com/en-us/library/bb399398.aspx)

请感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T21:26:37.470

我不相信 SQL Server CE 4.0 正式支持 Linq To SQL，尽管[看起来你可以让它工作](http://erikej.blogspot.co.uk/2012/04/using-linq-to-sql-with-sql-server.html)。Microsoft 推荐的方法是使用实​​体框架。

我已经写了几篇关于在 WebMatrix 中将 EF 与 SQL Server CE 结合使用的文章。一个涵盖[Code First 方法](http://www.mikesdotnetting.com/Article/182/Entity-Framework-Code-First-Development-With-WebMatrix)，另一个[着眼于数据库优先方法](http://www.mikesdotnetting.com/Article/185/Building-A-Razor-Web-Pages-Site-With-Database-First-And-Entity-Framework)。

# ruby - 使用正则表达式捕获像 #.+# 这样的字符串

> ID：10728307
> 
> 赞同：0
> 
> 时间：2012-05-23T21:42:16.550
> 
> 标签：ruby, regex

我正在构建一个项目，用户应该能够通过放置以下内容轻松生成链接：#this is the link#。我正在尝试使用正则表达式捕获 2 # 个符号之间的字符串。我试过了，

```
#.+# 
```

如果用户字符串中只有 1 个链接，它可以完美运行，但如果有超过 1 个链接，例如，

```
#asdfasdf asdf# asdf asfasdfasdf asd fasd fasdf #asdfasdf asdfasdf asdf asdf# 
```

它抓住了整个字符串。但我需要它们分开，所以我可以用标签代替它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:46:01.053

这被称为“贪婪的正则表达式”。默认情况下，正则表达式匹配可能的最长字符串。您可以通过以下方式使其不贪婪：

```
/#.+?#/ 
```

演示：[http ://rubular.com/r/7WWyaUapFt](http://rubular.com/r/7WWyaUApFt)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T21:46:12.090

使用非贪婪匹配

```
#.+?# 
```

它会抓住个别的。

# python - Eclipse 错误 IOError：[Errno 2] 没有这样的文件或目录：'Tarr32_Lane2_Next34_FinalAnnotations.txt'

> ID：10728309
> 
> 赞同：0
> 
> 时间：2012-05-23T21:42:22.123
> 
> 标签：python, eclipse

在 eclipse 中运行这个 python 脚本（我知道它在 VI 中运行后可以运行并且可以正常工作）时，我不断收到这个错误。

Traceback（最近一次调用最后一次）：文件“/home/kt/Documents/workspace/Molly's Scripts/src/ProcessingPARFuMSData.py”，第 181 行，在 annotations = open(sys.argv[1], 'r') IOError: [Errno 2] 没有这样的文件或目录：'Tarr32_Lane2_Next34_FinalAnnotations.txt'

我仔细检查了运行脚本所需的所有 txt 文件是否都包含在特定目录中，但它仍然给我带来了一些麻烦。我知道它必须与 eclipse 或 PyDev 相关，因为就像我之前提到的那样，它可以在其他编辑器中使用。任何帮助将不胜感激，如果需要，我可以尝试屏幕截图。

谢谢，

韩国电信

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T07:32:30.333

我遇到了同样的问题，但事实证明我的文本文件实际上位于错误的位置，即使它与我的 python 脚本位于同一目录中。我必须将它移动到与脚本相同的*包*中，而不仅仅是同一个目录（我通过简单地将文本文件拖到 Eclipse 侧边栏中的包名称上来做到这一点）。

因此，例如，这就是我的设置：

*   你好世界（项目）
    *   你好世界（包）
        *   __init__.py
        *   hello_world.py
    *   hello_world.txt

它*应该*是这样的（通过将 hello_world.txt 移动到 helloworld 包中）：

*   你好世界（项目）
    *   你好世界（包）
        *   __init__.py
        *   hello_world.py
        *   **hello_world.txt**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T23:32:09.873

似乎您在错误的目录中启动。您可以在运行 > 运行配置中配置启动。

# php - 使用反射从PHP中同一类的其他方法调用私有方法

> ID：10728311
> 
> 赞同：0
> 
> 时间：2012-05-23T21:42:36.890
> 
> 标签：php, oop, reflection

我想使用反射从其他类方法调用私有方法，如下所示：

```
class Foo {
    private function bar() {
        print "!@#";
    }
    public function foobar($methodName) {
        $method = new ReflectionMethod(get_class($this), $methodName);
        $method->invoke($this);
    }
}
$foo = new Foo();
$foo->foobar('bar'); 
```

此代码生成错误：

```
Fatal error: Uncaught exception 'ReflectionException' with message 'Trying to invoke     private method Foo::bar() from scope ReflectionMethod' 
```

这让我很困惑，因为我在同一个类方法的范围内调用调用。有没有什么方法可以在不使用 $this->$methodName(), call_user_func_array(...) 的情况下做我想做的事？此外，使用 $method->setAccessible(true) 也是不可取的，因为它破坏了封装概念。

感谢您的关注。

# domdocument - Msxml2.DOMDocument 和 Msxml2.XMLHTTP 之间的区别

> ID：10728324
> 
> 赞同：2
> 
> 时间：2012-05-23T21:43:43.777
> 
> 标签：domdocument, xmlhttprequest

有什么区别：

```
Msxml2.DOMDocument
Msxml2.XMLHTTP 
```

? 当然，另一个问题是哪一个最适合我的目的，如下所述？

上下文是这样的——我有很多调用来检索网页的代码。我正在为这项任务寻找最有效的对象。例如，像这样：

```
Dim oXmlHttp : Set oXmlHttp = CreateObject("MSXML2.XMLHTTP")

oXmlHttp.Open "GET", sUri, False
oXmlHttp.Send
If Err Then
    getWebPage = "ERROR - could not get the source text of the webpage."
    Exit Function
End If
sResponse = oXmlHttp.responseBody 
```

如果我使用以下方法创建对象，这似乎工作方式相同：

```
Dim oXmlHttp : Set oXmlHttp = CreateObject("MSXML2.XMLHTTP") 
```

任何人都可以解释或指出我的参考，清楚地概述了每个人的差异（和预期用途）吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T19:37:23.487

如果您想了解有关 MSXML 的更多信息，这些链接可能会有所帮助：

*   [http://msdn.microsoft.com/en-us/library/aa468547.aspx](http://msdn.microsoft.com/en-us/library/aa468547.aspx)
*   [http://msdn.microsoft.com/en-us/library/windows/desktop/ms766487(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms766487(v=vs.85).aspx)

简而言之，`XMLHTTP`用于检索信息，而`DOMDocument`用于构造和解析信息。

这个页面解释得更好： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms760218 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms760218(v=vs.85).aspx)

`DOMDocument`“表示 XML DOM 树的顶部节点。” 而`XMLHTTP`“为与 HTTP 服务器的通信提供客户端协议支持。”

# php - phpDocumentor 不工作

> ID：10728325
> 
> 赞同：2
> 
> 时间：2012-05-23T21:43:50.970
> 
> 标签：php, phpdoc

我试图开始使用 phpDocumentor。我的问题是它只生成一个 img、css、js 文件夹和一个 structure.xml 文件。

我目前在 c:/xampp/htdocs 中创建了一个名为 phpTest 的文件夹，其中包含 1 个文件 index.php 和一个类和一些 docBlox 注释

我已经使用 pear 和命令提示符安装了 phpDocumentor

所以我目前正在运行 cmd

键入 cd c:/xampp/htdocs/phptest

phpDocs -dc:/xampp/htdocs/phptest -tc:/xampp/htdocs/phptest/docs

docs 文件夹中的唯一输出是 3 个文件夹和 structure.xml 文件。是否应该有一个 index.hmtl 文件，其中包含所有可供我查看的文档？我如何让它显示出来？谢谢 这是我的测试 index.php 文件，我试图用 phpDocumentor 记录。

```
 <?php
/**
* File level docBlock
*@package Command
*/

/**
*This is the command class it is incharge
*Only has execute method
*@package Command
*@author Michael Booth
*@copyright 2012 bla bla
*/
abstract class Command{
/**
*keeps keys values
*@var array
*/
public var  $arrayvar = array();

/**
*executes method
*@param $int contains contextual data
*@return bool
*/
    abstract function execute($integer);
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T20:16:43.147

这可能是因为 PHP 会在您的文件中报告语法错误。线

```
public var  $arrayvar = array(); 
```

应该是

```
public $arrayvar = array(); 
```

或者

```
var $arrayvar = array(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:47:38.700

确保您的文档块以 slash-asterisk-asterisk 开头，而不是 slash-asterisk 的 PHP 常规注释语法。另外，请确保您在文档块中至少有一些标签（例如@package MyPackage）。phpDoc 不会看到常规的注释块，因此这本身可能就是没有生成任何内容的原因。

# msbuild - 为 msbuild 注册 xml 命名空间

> ID：10728326
> 
> 赞同：1
> 
> 时间：2012-05-23T21:43:57.357
> 
> 标签：msbuild, ilog

我有一个 ILOG “rulep” 项目文件。它是这样开始的：

```
<?xml version="1.0"?>
<Project Guid="1bd9d4b2-1b37-4950-a4f5-f025bda41c07" xmlns="http://www.ilog.com/rules/visual_studio/7.0">
  <Properties AssemblyName="BusinessRules1" RulesetNamespace="" DefaultPackage="BusinessRules1" RulesetName="BusinessRules1" OutputType="ClassLibrary" PreBuildEvent="" PostBuildEvent="" RunPostBuildEvent="OnBuildSuccessful" AssemblyInfoTitle="" AssemblyInfoDescription="" AssemblyInfoConfiguration="" AssemblyInfoCompany="" AssemblyInfoProduct="" AssemblyInfoCopyright="" AssemblyInfoTrademark="" AssemblyInfoCulture="" AssemblyInfoVersion="1.0.*" AssemblyInfoDelaySign="False" AssemblyInfoKeyFile="" AssemblyInfoKeyName="">
    <Build> 
```

特别要注意：xmlns="http://www.ilog.com/rules/visual_studio/7.0"。另请注意：不是 msbuild 2003 格式。

当我使用 msbuild 构建项目文件时，我得到

```
error MSB4041: The default XML namespace of the project must be the
 MSBuild XML namespace. If the project is authored in the MSBuild 2003
 format, please add xmlns="http://schemas.microsoft.com/developer/msbuild/2003"
 to the <Project> element. If the project has been authored in the old 1.0 or
 1.2 format, please convert it to MSBuild 2003 format. 
```

有什么方法可以用 msbuild 注册这个 xmlns 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:28:37.210

不，MSBuild 和 ILog 是两种完全不同的格式。MSBuild 只了解自己的文件格式（并且可以自动转换 .sln 文件）。

如果您可以将 .rulep 文件加载到 Visual Studion 中，那么您很可能可以使用 Visual Studio 命令构建它`devenv /build <project_name>`。

# php - 将数据发布到 PHP 中的另一个页面

> ID：10728327
> 
> 赞同：0
> 
> 时间：2012-05-23T21:43:59.717
> 
> 标签：php, mysql, post

我正在研究允许用户编辑他们提交的表单的东西，我有两个问题。

1.  假设我在页面 viewform.php 上，编辑表单的页面是 editform.php。通过 url 传递表单的 ID 并使用然后使用 GET 是否安全？我将验证试图在 editform.php 上访问它的人是使用与登录时设置的用户名绑定的会话 ID 创建它的人。

2.  如果 1 不是一种安全的方法，我如何将 viewform.php 中的数据（我想使用提交按钮）发布到 editform.php？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:40:50.367

如果我理解您的问题是正确的，那么您正在寻找的是如何使用表单在请求之间保留数据？因为那时您可以在表单的 action 属性中指定提交 URL，并且您可以通过请求对象从该 URL 访问表单的值。为了将您的数据提交到同一页面，您可以使用 $_SERVER['PHP_SELF'] 来引用您所在的页面。因此，要回答您的问题，您的 viewform.php 将具有：

```
<form action="editform.php">
<input type="text" name="inputvariable" />
<input type="submit" value="Go" />
</form> 
```

在editform.php 中，您可以通过访问$_REQUEST['inputvariable'] 来访问inputvariable 的值

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:47:03.293

当然，`$_GET`只要没有传输任何敏感数据，它就是安全的。ID是常用的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:47:21.547

为什么不将提交表单的方法设置为“POST”。使用“GET”可能会导致有人修改页面的 URL 并插入可能对您的网站产生一些不良影响的数据。

如果使用 POST，则在接收数据时，将变量设置为

```
$var1 = $_POST['variable1']; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T23:07:00.250

您可以将 Id 保存在 $_SESSION 数组中，然后将您从 url 获得的 id 与您保存在 $_SESSION 中的 id 匹配。如果它们不匹配，您可以显示错误消息。这将防止您的网站表现出不希望的方式如果有人更改网址。

# python - Pyramid 中是否有像 Django 模板一样在模板中指定路由的功能？

> ID：10728333
> 
> 赞同：3
> 
> 时间：2012-05-23T21:44:32.363
> 
> 标签：python, pyramid

例如，在 Django 中，如果我有一个名为 'home' 的 url，那么我可以将 {% url home %} 放入模板中，它将导航到该 url。我在 Pyramid 文档中找不到任何具体的内容，所以我正在寻找 Stack Overflow。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T02:41:41.333

括号取决于您使用的模板引擎，但`request.route_url('home')`里面是您需要的 Python 代码。

例如，在您想要的模板文件中：

*   jinja2-->`{{ request.route_url('home') }}`
*   mako/变色龙-->`${ request.route_url('home') }`

如果您的路由定义包括模式匹配，例如`config.add_route('sometestpage', '/test/{pagename}')`，那么您会这样做`request.route_url('sometestpage', pagename='myfavoritepage')`

# python - Wikipedia API 查询以返回 xml

> ID：10728340
> 
> 赞同：2
> 
> 时间：2012-05-23T21:45:15.813
> 
> 标签：python, xml, json, parsing, wikipedia-api

我正在尝试为自己编写一个简单的 Python 应用程序来获取 Wikipedia 上某个主题的内容。例如，我试图在 fruit [apple](http://en.wikipedia.org/wiki/Apple)上获取页面的内容。这是我的查询：

```
http://en.wikipedia.org/w/api.php?action=query&prop=revisions&rvprop=content&format=xml&titles=apple 
```

这是输出（格式化）的样子：

[http://pastebin.com/LNdDjXFj](http://pastebin.com/LNdDjXFj)

但这看起来并不像 XML。它看起来更像（我认为）php。我应该尝试用 Python 解析它还是有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:57:56.087

这不是 PHP，它是媒体 wiki 格式。

查看格式化 mw 页面：[http ://www.mediawiki.org/wiki/API:Parsing_wikitext](http://www.mediawiki.org/wiki/API:Parsing_wikitext)

就个人而言，json 格式的版本对我来说看起来更好（一旦解析）。

# google-app-engine - 将数据库从本地数据存储移动到另一个本地数据存储

> ID：10728341
> 
> 赞同：0
> 
> 时间：2012-05-23T21:45:38.417
> 
> 标签：google-app-engine, gwt

我和我的朋友正在做一个 GWT-Google App Engine 项目，使用 Tortoise SVN 和 Google Code 来同步代码。我们还同步了 appengine-generated 文件夹中的 local_db.bin 文件。但我们不能让它工作。同步 db 文件后，我们的本地数据存储并没有像我们预期的那样更新。那是一种痛苦。我担心我们的未来，当我们的数据库变得更大更复杂@A@。任何人请给我一个建议。我应该怎么做才能同步我们的本地数据存储？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:05:09.253

我必须建议：1）使用远程 api：[https](https://developers.google.com/appengine/articles/remote_api) ://developers.google.com/appengine/articles/remote_api在本地共享 GAE 托管数据库。2) 也许你可以使用 Gdrive 来同步文件夹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T01:07:11.967

这是一个非常糟糕的主意。即使从同一个数据存储文件读取两端都没有问题，本地数据存储也是二进制格式，因此你们不能同时在应用程序上工作，或者你会获得您将无法解决的合并冲突。

相反，无论是出于协作目的还是为了测试和部署，您都应该提供一组可以轻松加载到数据存储中的测试数据。将测试数据存储在版本控制中，并使用 bulkloader 或您自己的代码加载。

# c# - 将 ListBox 数据绑定到包含可观察集合的类的列表

> ID：10728344
> 
> 赞同：1
> 
> 时间：2012-05-23T21:45:59.307
> 
> 标签：c#, wpf, silverlight

我有一个自定义类的项目列表。该类包含另一个类的可观察集合，该集合具有两个字符串值。我想基于另一个字符串值将数据绑定到其中一个字符串值。所以作为一个虚构的例子：

```
public class Person
{
    public string Name { get; set; }
    public ObservableCollection<Pet> Pets { get; set; }
}
public class Pet
{
    public string AnimalType { get; set; }
    public string Name { get; set; }
} 
```

然后我将列表框绑定到人员列表：

```
List<Person> people = new List<Person>();
Person p = new Person() { Name = "Joe", Pets = new ObservableCollection<Pet>() { new Pet() { Name = "Spot", AnimalType = "Dog" }, new Pet() { Name = "Whiskers", AnimalType = "Cat" } } };
people.Add(p);
p = new Person() { Name = "Jim", Pets = new ObservableCollection<Pet>() { new Pet() { Name = "Juniper", AnimalType = "Cat" }, new Pet() { Name = "Butch", AnimalType = "Dog" } } };
people.Add(p);
p = new Person() { Name = "Jane", Pets = new ObservableCollection<Pet>() { new Pet() { Name = "Tiny", AnimalType = "Dog" }, new Pet() { Name = "Tulip", AnimalType = "Cat" } } };
people.Add(p);
MyListBox.ItemsSource = people; 
```

如果动物类型是狗，我想绑定人名和宠物名。我知道我可以使用索引器进行绑定，但我特别需要狗条目，即使它是宠物集合中的第二个条目。下面的 XAML 用于显示集合中的第一项，但对于列表中的第二项，它是错误的，因为狗是集合中的第二项：

```
 <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel Height="55.015" Width="302.996">
                    <TextBlock TextWrapping="Wrap" Text="{Binding Name}" Height="25.015" VerticalAlignment="Top" Margin="0,0,8,0"/>
                    <TextBlock Text="{Binding Pets[0].Name}"></TextBlock>
                </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate> 
```

任何人都可以就我如何做到这一点提供一些指导吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:06:29.850

使用值转换器仅显示狗。

XAML：

```
<TextBlock Text="{Binding Pets, Converter={StaticResource FindDogConverter}}" /> 
```

后面的代码：

```
public class FindDogConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        IEnumerable<Pet> pets = value as IEnumerable<Pet>;
        return pets.Single(p => p.AnimalType == "Dog").Name;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

# java - Java captureDeviceManager.getDevice 返回在 ubuntu 上找不到任何捕获设备

> ID：10728346
> 
> 赞同：3
> 
> 时间：2012-05-23T21:46:02.707
> 
> 标签：java, ubuntu, webcam, jmf

我想从笔记本电脑的网络摄像头捕捉图像。

运行 Skype 或任何网络摄像头应用程序时，网络摄像头可以正常工作。

我的工作站是 ubuntu 11.10。

我的网络摄像头定位 /dev/v4l 并且此路径包括 by-id by-path。

```
 Vector deviceList = CaptureDeviceManager.getDeviceList(new YUVFormat()); 
```

网络摄像头 RGB 和 YUV 的 2 种格式。

我运行 v4l-info 并且我知道 YUV 格式。

返回没有找到捕获设备

我手动在参考库中添加了 jmf.jar。

请帮我。

我只想在 ubuntu 11.10 中使用 java 捕获图像。

如果您找不到上述问题的解决方案，您能否推荐我任何其他方法。

谢谢你的帮助

# javascript - Mixpanel 匿名用户转换为已识别用户跟踪

> ID：10728350
> 
> 赞同：26
> 
> 时间：2012-05-23T21:46:12.783
> 
> 标签：javascript, cookies, tracking, metrics, mixpanel

我正在将 Mixpanel 添加到我的 Web 应用程序中，我很好奇当用户从“匿名”（未登录/注册）转换为“已识别”（当他们在网站）。

如果用户进入并且是该站点的新用户，他们将获得一个匿名 UUID（根据[文档](https://mixpanel.com/docs/integration-libraries/javascript-full-api#identify)）。该文档还说，Mixpanel 目前无法在 ID 之间进行转换。

这是否意味着 Mixpanel 无法处理非注册用户到注册用户的转换，并在他们成为注册/识别用户之前跟踪他们的事件？

如果是这样，是否有人有解决此问题的经验？你是怎么做的？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-31T21:47:11.517

截至 2012 年 12 月，您现在可以使用`mixpanel.alias`方法调用来为两个 id 设置别名：

[https://mixpanel.com/docs/integration-libraries/using-mixpanel-alias](https://mixpanel.com/docs/integration-libraries/using-mixpanel-alias)

从上面的文档：

> John 第一次访问您的网站 example.com。Mixpanel 为他分配了一个随机生成的 ID（可能是 123123）。他所做的一切都与该 ID 相关联。
> 
> 点击几页后，他成功注册了。在注册确认页面上，您调用 mixpanel.alias("john@hotmail.com")。这实际上并没有改变他的 ID - 他仍然使用我们最初分配给他的随机 ID 来识别。
> 
> 它所做的是将 ID“john@hotmail.com”添加到我们端的查找表中。每当我们看到“john@hotmail.com”的数据时，我们都知道将其重新映射到 123123，即他的原始 ID。
> 
> 因此，您可以开始在您的所有页面上调用 mixpanel.identify("john@hotmail.com") ，您的事件、漏斗和保留都将继续完美运行。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-24T01:42:43.530

有办法使这项工作。但是您真正需要的是一种称为 distinct id aliasing 的功能，它允许您将一个 distinct_id ID 引用到另一个。不幸的是，我们现在不提供。由于我们为 mixpanel 编写的数据存储的独特性质，这比您预期的要困难得多。

同时，我可以给你一些策略来解决这个限制：

*   当用户第一次访问您的网站时，为他们设置一个您在内部生成的独特 ID。一旦他们注册了一个帐户，请在您的用户详细信息表中引用该 distinct_id，然后继续使用该 id 注册后续事件。用户随后每次进行身份验证时，都将存储的值用作不同的 id。希望当他们返回时，cookie 仍然存在，并且您将顺利捕获所有事件。

*   您还可以让 mixpanel 给他们一个自动发布的 distinct_id 值，然后在注册时使用 mixpanel.get_property() 获取该值，然后将其添加到您的用户表中，并在您将来识别它们时使用它.

*   但是，如果他们从一台机器上进行身份验证，然后从另一台机器、不同的浏览器或移动设备上启动呢？然后在他们访问您的网站和他们进行身份验证之间的时间，您的网站将向他们发出一个新的 distinct_id ......并且没有办法别名！这里的解决方案有点hackier。获取该数据的唯一方法是记录在身份验证之前发送的那些事件（可能是服务器端），然后在用户身份验证后通过 HTTP 规范将它们发送到具有正确 distinct_id 的其余 API。只要您保留正确的时间戳，它就会在 mixpanel 中按时间顺序正确显示。如果用户从不进行身份验证，那么您可以让记录的事件超时并发送它们。

这些中的任何一个都对您有用吗？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-23T23:01:07.787

当用户访问您的网站时，使用唯一 id 识别他们，如果他们还没有，则将其保存在 cookie 中，然后使用[Mixpanel 识别](https://mixpanel.com/docs/integration-libraries/javascript-full-api#identify)API 调用来识别他们。您可以在用户注册后将唯一 ID 保存到用户记录中的数据库中，以便在他们清除 cookie 时重新设置它。

如果用户在注册之前清除了他们的 cookie，那么您将不走运，但这就是这种野兽的本性，并且在任何地方都是一个问题。

# browser - 为什么我不能为不同的浏览器分组特定于浏览器的 CSS 选择器？

> ID：10728360
> 
> 赞同：7
> 
> 时间：2012-05-23T21:46:54.283
> 
> 标签：browser, css, cross-browser, css-selectors

我只是尝试编写以下规则来为支持它的浏览器设置输入占位符的样式：

```
#main input::-webkit-input-placeholder,
#main input:-moz-placeholder
{
    color: #888;
    font-style: italic;
} 
```

问题是没有应用该规则。但是，如果我像这样分解它，它就可以正常工作：

```
#main input::-webkit-input-placeholder
{
    color: #888;
    font-style: italic;
}
#main input:-moz-placeholder
{
    color: #888;
    font-style: italic;
} 
```

为什么我不能对特定于浏览器的选择器进行分组，或者有其他方法吗？对同一个元素重复两次相同的属性感觉不对。

**更新：**

刚刚发现[这个资源](http://blog.ajcw.com/2011/02/styling-the-html5-placeholder/)说它不能完成，但到目前为止还没有关于原因的信息。浏览器仅仅因为不能识别其中一个选择器就不得不放弃整个规则，这似乎很奇怪。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-23T22:01:09.137

如果一组选择器中的一个选择器无效，则浏览器必须将整个规则视为无效。或者至少[W3C 是这么说的](http://www.w3.org/TR/selectors/#grouping)。

我不确定为什么这种行为是强制性的，但在推动时，我猜这是因为无效的选择器可能会破坏一般的 CSS 语法，使浏览器无法可靠地猜测无效选择器的结束位置和有效元素的开始位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:49:38.423

最有可能的是，某些浏览器会丢弃整个定义，因为它们认为选择器无效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T22:12:37.023

如果您愿意使用 JavaScript，请查看 -prefix-free 脚本。它允许您为这些 CSS 属性省略供应商特定的前缀（例如 -webkit- 或 -moz-）。

# qtestlib - QTest::mouseClick 上 QListWidget 的问题

> ID：10728362
> 
> 赞同：8
> 
> 时间：2012-05-23T21:47:16.320
> 
> 标签：qtestlib

我正在尝试使用 QTest 进行一些测试。我有一个 QListWidget，我想点击它来进行选择。但是点击之后，什么都没有被选中。有没有人有任何想法？

这是我的测试课

```
void TestGui::List() {
    TestDialog dlg;
    dlg.show ();

    // Click on the centre of the second object
    QListWidget *list = dlg.ListWidget ();
    QListWidgetItem *item = list->item ( 1 );
    QRect rect = list->visualItemRect ( item );
    QTest::mouseClick ( list, Qt::LeftButton, 0, rect.center() );

    // Check if something was selected
    QCOMPARE ( list->currentRow (), 1 );
    QVERIFY ( list->currentItem () != NULL );
    QCOMPARE ( list->currentItem ()->text (), QString ( "Two" ) );
} 
```

下面是测试类

```
class TestGui: public QObject {
    Q_OBJECT

private slots:
    void List();
}; 
```

这是用于显示问题的TestDialog类

```
class TestDialog : public QDialog {
    Q_OBJECT

public:
    TestDialog ( QWidget *parent = NULL )
    : QDialog ( parent, Qt::CustomizeWindowHint | Qt::WindowCloseButtonHint ) {
        QVBoxLayout *layout = new QVBoxLayout ( this );

        m_list = new QListWidget ( this );
        m_list->addItem ( "One" );
        m_list->addItem ( "Two" );
        m_list->addItem ( "Three" );
        m_list->addItem ( "Four" );
        layout->addWidget ( m_list );

        QPushButton *close_button = new QPushButton( "Close" );
        connect ( close_button, SIGNAL ( clicked () ), this, SLOT ( close () ) );
        layout->addWidget ( close_button );

        setWindowTitle( "Test" );
    }

    QListWidget *ListWidget ( void ) {
        return m_list;
    };

private:
    QListWidget *m_list;

}; // TestDialog 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T10:40:20.727

经过一番思考，事实证明点击需要在视图小部件上而不是列表本身上。所以这条线应该是这样的

QTest::mouseClick ( list->viewport (), Qt::LeftButton, 0, rect.center() );

谢谢

# xslt - 使用 xslt 基于其他节点重构 xml 节点

> ID：10728363
> 
> 赞同：1
> 
> 时间：2012-05-23T21:47:17.620
> 
> 标签：xslt, xslt-2.0

我有以下 xml

```
<xml>
  <object context="3-cumulative" >
  <metadata>
  <ref cite="4.2" relevance="first.2"/>
  </metadata>
<body>
  <para>
    <text> 
      applicable on and after December 14,2007.
    </text>
  </para>
</body>
</object>
<object context="3-cumulative" >
  <metadata>
  <ref cite="4.2" relevance="first.1"/>
  </metadata>
<body>
  <para>
    <text> 
      applicable on and after December 14,2006.
    </text>
  </para>
</body>
</object>

 <object context="3-cumulative" >
 <metadata>
  <related-content-ref cite="5 annuity" relevance="first.1"/>
</metadata>
<body>
  <para>
     <text>
       applicable on and after December 14, 2008
     </text>
   </para>
 </body>
</object>
   <mainbody>
      <num cite="4.2">4.2</num>
      <heading>Stock exchanges</heading>
      <prov-body>
        <text>
           Notwithstanding the provisions of a convention ... as defined in the
           <italic>Income Tax Act</italic>.
        </text>
     <prov>
            <num cite="5 annuity"/>
            <heading>“annuity”&lt;/heading>
            <text>
            <term>“annuity”&lt;/term>does not include any pension payment ...
           </text>
            <text>
            any pension payment ...
           </text>
  </prov>
 </prov-body>
  </mainbody>
 </xml> 
```

我需要查看是否在“mainbody”num/@cite 中找到了任何对象/元数据/ref/@cite，然后对象中的 para/text 应该在第一个 Text 节点的末尾复制，并且应该按 object/metadata/ref 排序/@关联。

输出应该是：

```
<xml>
 <mainbody>
 <num cite="4.2">4.2</num>
 <heading>Stock exchanges</heading>
 <prov-body>
  <text>
    Notwithstanding the provisions of a convention ... as defined in the
    <italic>Income Tax Act</italic>.
    **applicable on and after December 14, 2006**
    **applicable on and after December 14, 2007**
  </text>
 <prov>
        <num cite="5 annuity"/>
        <heading>“annuity”&lt;/heading>
        <text>
        <term>“annuity”&lt;/term>does not include any pension payment ...
         **applicable on and after December 14, 2008**
        </text>
        <text>
        any pension payment ...
       </text>
   </prov>
  </prov-body>
 </mainbody>
</xml> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T04:30:09.470

**此 XSLT 1.0 转换**`version`（如果属性更改为 2.0 并使用 XSLT 2.0 处理器运行转换，则会产生相同的结果）：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kRefByCite"
      match="metadata/*" use="@cite" />

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match=
   "text[(preceding::text[1]|preceding::num[1])
          [last()]
              [key('kRefByCite', @cite)]]">
   <text>
     <xsl:apply-templates/>
     <xsl:for-each select=
       "key('kRefByCite', preceding::num[1]/@cite)">
       <xsl:sort select="@relevance"/>

       <xsl:value-of select="../../body/para/text"/>
     </xsl:for-each>
   </text>
 </xsl:template>
 <xsl:template match=
   "node()
    [parent::* and not(ancestor-or-self::mainbody)]"/>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<xml>
    <object context="3-cumulative" >
        <metadata>
            <ref cite="4.2" relevance="first.2"/>
        </metadata>
        <body>
            <para>
                <text>
          applicable on and after December 14,2007.
                </text>
            </para>
        </body>
    </object>
    <object context="3-cumulative" >
        <metadata>
            <ref cite="4.2" relevance="first.1"/>
        </metadata>
        <body>
            <para>
                <text>
          applicable on and after December 14,2006.
                </text>
            </para>
        </body>
    </object>
    <object context="3-cumulative" >
        <metadata>
            <related-content-ref cite="5 annuity" relevance="first.1"/>
        </metadata>
        <body>
            <para>
                <text>
           applicable on and after December 14, 2008
                </text>
            </para>
        </body>
    </object>
    <mainbody>
        <num cite="4.2">4.2</num>
        <heading>Stock exchanges</heading>
        <prov-body>
            <text>
        Notwithstanding the provisions of a convention ... as defined in the
                <italic>Income Tax Act</italic>.
            </text>
            <prov>
                <num cite="5 annuity"/>
                <heading>“annuity”&lt;/heading>
                <text>
                    <term>“annuity”&lt;/term>does not include any pension payment ...
                </text>
                <text>
           any pension payment ...
                </text>
            </prov>
        </prov-body>
    </mainbody>
</xml> 
```

**产生想要的正确结果：**

```
<xml>
   <mainbody>
      <num cite="4.2">4.2</num>
      <heading>Stock exchanges</heading>
      <prov-body>
         <text>
        Notwithstanding the provisions of a convention ... as defined in the
                <italic>Income Tax Act</italic>.

          applicable on and after December 14,2006.

          applicable on and after December 14,2007.
                </text>
         <prov>
            <num cite="5 annuity"/>
            <heading>“annuity”&lt;/heading>
            <text>
               <term>“annuity”&lt;/term>does not include any pension payment ...

           applicable on and after December 14, 2008
                </text>
            <text>
           any pension payment ...
                </text>
         </prov>
      </prov-body>
   </mainbody>
</xml> 
```

**说明**：

适当覆盖**[身份规则](http://dpawson.co.uk/xsl/sect2/identity.html)**和功能**[`xsl:key`](http://www.w3.org/TR/1999/REC-xslt-19991116#key)**的使用**[`key()`](http://www.w3.org/TR/1999/REC-xslt-19991116#function-key)**。

# user-interface - 将文件留在用户临时文件夹中是否可以接受？

> ID：10728366
> 
> 赞同：0
> 
> 时间：2012-05-23T21:47:36.350
> 
> 标签：user-interface, filesystems, temp

我正在开发一个应用程序，它生成一组位图，然后将它们加载到一个表单中供用户选择。

位图是从用户可以添加到的小型矢量库中生成的。代码现在创建文件，然后在使用后立即删除它们，只需要在用户下次打开 UI 时再次生成它们（使 UI 需要几秒钟才能加载）。

所以我想知道的是，是否可以将我的位图“永远”留在用户临时文件夹中，如果它们不在文件夹中则重新生成它们？由于可能的权限问题，我不能指望能够将图像存储在应用程序目录中，就像我说的那样，我无法预填充文件，因为用户可以添加更多文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:50:41.057

理想情况下，您应该将任何临时数据生成到 RAM 而不是文件系统中。

如果您可以确保您的应用程序为每个用户仅存储有限数量的此类文件，则依赖临时文件是可以接受的。无论您的代码做什么，任何临时文件都可能在意外崩溃/断电时留下。因此，您需要实现一种机制，该机制将删除同一应用程序在前一个会话中创建的任何陈旧文件 - 大概在其下一次启动期间。

假设有这样的安全机制，在应用程序退出时故意留下临时文件听起来像是一个非标准但合理的“缓存”。

警告：您的应用程序的下一个版本可能需要稍微不同的文件格式，并且应该根据一些简单的版本控制方案检测、删除和重新生成格式不匹配的任何文件，以避免交叉构建依赖。

# php - 使用 PHP 导出到 .xls 时出错

> ID：10728367
> 
> 赞同：-1
> 
> 时间：2012-05-23T21:47:47.420
> 
> 标签：php, mysql, xls

我之前问过一个类似的问题，但有人告诉我我的问题只是我很懒，所以让我改一下。

我一直在使用 PHP 类脚本使我能够将我的 SQL 数据导出到 .xls 文件，但生成的 excel 文件不显示任何值，并且网页本身也没有显示错误。

我使用的类文件记录在下面的链接中：

[http://web.burza.hr/blog/php-class-for-exporting-data-in-multiple-worksheets-excel-xml/](http://web.burza.hr/blog/php-class-for-exporting-data-in-multiple-worksheets-excel-xml/)

我已将其合并到我的网站中，如下所示

```
$dbase->loadextraClass('excel.xml');

$excel = new excel_xml();

$header_style = array(
                        'bold'       => 1,
                        'size'       => '14',
                        'color'      => '#000000',
                        'bgcolor'    => '#ffffff'
                    );

$excel->add_style('header',$header_style);

if(isset($_POST['fec_save']))
{
    if($_POST['reporttype']=='films')
    {

        $films = $dbase->runquery("SELECT datetime,title,country_of_origin,language,runningtime,(SELECT name FROM fec_client WHERE filmid = fec_film.filmid) AS client, (SELECT rating_decision FROM fec_rating_report WHERE filmid = fec_film.filmid) AS rating FROM fec_film WHERE datetime >= '".strtotime($_POST['fromdate'])."' AND datetime <= '".strtotime($_POST['todate'])."'",'multiple');

        $filmcount = $dbase->getcount($films);

        //continue with excel buildup
        $columns = array('Date','Title','Origin','Language','Minutes','Client','Rating');
        $excel->add_row($columns,'header');

        for($i=1; $i<=$filmcount; $i++)
        {
            $film = $dbase->fetcharray($films);

            $excel->add_row($film['datetime'],$film['title'],$film['country_of_origin'],$film['language'],$film['runningtime'],$film['client'],$film['rating']);
        }

        $excel->create_worksheet('From_'.str_replace(' ','',$_POST['fromdate']).'_to'.str_replace(' ','',$_POST['todate']));

        $xml = $excel->generate();
        $excel->download('FilmsClassified_from_'.str_replace(' ','',$_POST['fromdate']).'_to'.str_replace(' ','',$_POST['todate']));
    }

} 
```

我想要一些关于我可能做错了什么的帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:00:30.323

太长了，不能作为评论发表：

```
$xml = $excel->generate(); 
```

将所有 xml 文件内容创建为字符串并将其存储在 $xml 中，同时

```
$excel->create_worksheet('From_'.str_replace(' ','',$_POST['fromdate']).'_to'.str_replace(' ','',$_POST['todate'])); 
```

创建 xml 并将其定向到输出，并带有适当的标题以供下载。

所以你没有正确使用这个类，因为这是不必要的重复工作。

# silverlight - 如何在 Silverlight 中订阅子用户控件中的事件？

> ID：10728376
> 
> 赞同：0
> 
> 时间：2012-05-23T21:49:02.723
> 
> 标签：silverlight

我有一个用户控件（MyUC），它以编程方式多次添加到页面（MainPage）中。

在 MyUC 中，我将 DataContext 设置为如下视图模型：

```
 private void UserControl_Loaded(object sender, RoutedEventArgs e)
    {
        DataContext = new MyUCViewModel();
    } 
```

在我的视图模型（MyUCViewModel）中，我有一组数据项：

```
 public MyDataItemCollection MyDataItems { get; private set; } 
```

在构造函数中我有：

```
 public MyUCViewModel()
    {
        this.MyDataItems = new MyDataItemCollection();
        this.MyDataItems.ChosenItems.CollectionChanged += new NotifyCollectionChangedEventHandler(ChosenItemsChanged);

        this.MyDataItems.Add(new DataItem());
    } 
```

从上面的 MyDataItems 中有另一个用于 ChosenItems 的集合，我向它添加了一个 NotifyCollectionChangedEventHandler。

我的代码的其他部分在 ChosenItems 集合中添加和删除，这部分似乎工作正常。

接下来我在视图模型中有事件处理程序方法：

```
 private void ChosenItemsChanged(object sender, EventArgs e)
    {
        MessageBox.Show("Chosen Items Changed");
    } 
```

这也有效，每次用户对影响 ChosenItems 集合的 UI 进行更改时，我都会收到一个消息框。

我现在要弄清楚的部分是如何设置它，以便我的 MainPage 在我的用户控件中触发 ChosenItemsChanged 事件时执行某些操作。我想要做的是让 MainPage 循环通过页面上生成的 MyUC 控件并使每个用户控件调用一个方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T01:48:44.797

您可以像这样在 MainPage 中添加更多事件侦听器：

```
MyUCViewModel viewModel = myUC.DataContext;
viewModel.MyDataItems.ChosenItems.CollectionChanged 
  += new NotifyCollectionChangedEventHandler(MainPage_ChosenItemsChanged); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T09:20:42.587

*这是基于评论，因为这个问题有点误导：*

虽然严格来说不是 MVVM，但您的问题似乎是，您应该像编写第三方控件一样编写用户控件，并在其上简单地公开一个自定义事件。用户控件应始终是具有公共界面的黑盒。对于一个自包含的可重用控件（很多都是）MVVM 是矫枉过正的。

## 例如

在您的用户控制中添加：

`public event EventHandler<MyEventArgs> MyEvent`

创建一个`MyEventArgs`派生自的类`EventArgs`并让它保存有用的参数（如所选项目）。

在您的主页中，`MyEvent`在您动态添加的每个用户控件上添加一个处理程序。

*我实际上认为 MVVM 模型是有缺陷的，所有这些控制逻辑和事件处理程序都属于一个`Controller`类（MVCVM！），但这是另一回事。*:)

# java - 我的无效字符在哪里 (ORA-00911)

> ID：10728377
> 
> 赞同：69
> 
> 时间：2012-05-23T21:49:03.853
> 
> 标签：java, oracle, jdbc, prepared-statement

我正在尝试将`CLOB`s 插入数据库（请参阅[相关问题](https://stackoverflow.com/questions/10727521/)）。我无法完全弄清楚出了什么问题。我有一个要插入到表中的大约 85 个 clob 的列表。即使只插入我得到的第一个 clob `ORA-00911: invalid character`。我不知道如何`PreparedStatement`在执行之前将语句从语句中取出，所以我不能 100% 确定它是正确的，但如果我做对了，那么它应该看起来像这样：

```
insert all
  into domo_queries values ('select 
substr(to_char(max_data),1,4) as year,
substr(to_char(max_data),5,6) as month,
max_data
from dss_fin_user.acq_dashboard_src_load_success
where source = ''CHQ PeopleSoft FS''')
select * from dual; 
```

最终，这个[`insert all`](http://www.techonthenet.com/oracle/questions/insert_rows.php)语句会有很多`into`'，这就是为什么我只是不做一个常规`insert`语句。我没有在其中看到无效字符，是吗？（哦，**当我在我的 sql 开发人员工具中运行上面的代码时，它运行良好**。）如果我删除 中的分号`PreparedStatement`，它会引发`ORA-00933: SQL command not properly ended`错误。

无论如何，这是我执行查询的代码（以及上面示例的变量值）。

```
public ResultSet executeQuery(String connection, String query, QueryParameter... params) throws DataException, SQLException {
  // query at this point = "insert all
                          //into domo_queries values (?)
                          //select * from dual;"
  Connection conn = ConnectionPool.getInstance().get(connection);
  PreparedStatement pstmt = conn.prepareStatement(query);
  for (int i = 1; i <= params.length; i++) {
    QueryParameter param = params[i - 1];
    switch (param.getType()) { //The type in the example is QueryParameter.CLOB
      case QueryParameter.CLOB:
        Clob clob = CLOB.createTemporary(conn, false, oracle.sql.CLOB.DURATION_SESSION);
        clob.setString(i, "'" + param.getValue() + "'");
        //the value of param.getValue() at this point is:
        /*
         * select 
         * substr(to_char(max_data),1,4) as year,
         * substr(to_char(max_data),5,6) as month,
         * max_data
         * from dss_fin_user.acq_dashboard_src_load_success
         * where source = ''CHQ PeopleSoft FS''
         */
        pstmt.setClob(i, clob);
        break;
      case QueryParameter.STRING:
        pstmt.setString(i, "'" + param.getValue() + "'");
        break;
    }
  }
  ResultSet rs = pstmt.executeQuery(); //Obviously, this is where the error is thrown
  conn.commit();
  ConnectionPool.getInstance().release(conn);
  return rs;
} 
```

有什么我只是想念的东西吗？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2012-05-23T21:54:27.053

如果您完全按照向我们展示的那样使用字符串文字，那么问题出`;`在末尾的字符上。您可能不会将其包含在 JDBC 调用的查询字符串中。

由于您只插入一行，`INSERT`因此即使插入多行，常规也应该没问题。无论如何，使用批处理语句可能更有效。不需要`INSERT ALL`。此外，您不需要临时 clob 和所有这些。您可以将您的方法简化为这样的（假设我的参数正确）：

```
String query1 = "select substr(to_char(max_data),1,4) as year, " + 
  "substr(to_char(max_data),5,6) as month, max_data " +
  "from dss_fin_user.acq_dashboard_src_load_success " + 
  "where source = 'CHQ PeopleSoft FS'";

String query2 = ".....";

String sql = "insert into domo_queries (clob_column) values (?)";
PreparedStatement pstmt = con.prepareStatement(sql);
StringReader reader = new StringReader(query1);
pstmt.setCharacterStream(1, reader, query1.length());
pstmt.addBatch();

reader = new StringReader(query2);
pstmt.setCharacterStream(1, reader, query2.length());
pstmt.addBatch();

pstmt.executeBatch();   
con.commit(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-23T22:11:00.980

在我的脑海中，你能尝试对字符串文字使用“q”运算符吗

就像是

```
insert all
  into domo_queries values (q'[select 
substr(to_char(max_data),1,4) as year,
substr(to_char(max_data),5,6) as month,
max_data
from dss_fin_user.acq_dashboard_src_load_success
where source = 'CHQ PeopleSoft FS']')
select * from dual; 
```

请注意，谓词的单引号不会被转义，并且字符串位于 q'[...]' 之间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-21T10:48:17.713

原因之一可能是任何一个表列的名称中都有**下划线（_）**。这被 JDBC 视为无效字符。通过 ALTER 命令重命名列并更改您的代码 SQL，这将修复。

# jquery - 骨干.js + jScrollPane：保持滚动窗格重新渲染？

> ID：10728387
> 
> 赞同：1
> 
> 时间：2012-05-23T21:49:43.173
> 
> 标签：jquery, backbone.js, jscrollpane

[http://tinkerbin.com/pla4NzJ9](http://tinkerbin.com/pla4NzJ9)

我创建了一个小型演示，其中实例化了主干视图并使用`this.$el.jScrollPane()`,`jScrollPane`附加到它。

当我在 5 秒后重新渲染视图时，`jScrollPane`消失了。有谁知道为什么？

在这里，我复制了 js：

```
var ScrollableView = Backbone.View.extend({
  initialize: function() {
    this.render();
  },

  render: function () {
    this.$el.html(_.template($('#scrollable_template').html(), {})); 
    this.$el.jScrollPane();
    return this;
  }
});

$(function () {
  var scrollableView = new ScrollableView({ el: $('#scrollable') });
  setTimeout(function() {
    scrollableView.render();
    console.log("re-rendered");
  }, 5000);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:54:13.883

当您调用时，插件会执行此操作`this.$el.jScrollPane()`：

```
return this.each(
    function()  
    {
        var elem = $(this), jspApi = elem.data('jsp'); 
        if (jspApi) {
            jspApi.reinitialise(settings); 
        } else {
            jspApi = new JScrollPane(elem, settings); 
            elem.data('jsp', jspApi);  
        }
    }   
); 
```

注意`elem.data('jsp')`检查，这意味着`.jScrollPane()`第二次在元素上调用它时会做一些不同的事情。

当你这样做时：

```
this.$el.html(_.template($('#scrollable_template').html(), {})); 
```

您杀死了第一次`.jScrollPane()`调用添加的所有额外元素和事件处理程序。然后你`.jScrollPane()`再次调用，它看到它`.data('jsp')`在那里，所以它可能假设所有东西都已经在那里并且没有正确设置。

jScrollPane API 中有一个[`destroy`](http://jscrollpane.kelvinluck.com/api.html#destroy)方法，但我无法让它工作。手动删除`jsp`数据似乎确实有效：

```
render: function () {
  this.$el.removeData('jsp');
  this.$el.html(_.template($('#scrollable_template').html(), {})); 
  this.$el.jScrollPane();
  return this;
} 
```

但老实说，我不知道这是否会做一些令人讨厌的事情；我会更多地处理它，并在绝望之前尝试开始`destroy`工作`removeDate('jsp')`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T12:04:17.817

您应该实例化主干视图的`jscollpane`on方法和 in方法的使用方法。`initialize()``render()``reinitialze()``jscrollpane`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-05T06:13:25.227

我将它用于在我的布局区域中呈现的 MarionetteJS CollectionView，最初遇到了与原始问题类似的困难。

根据此处的一些注释，我能够为 CollectionView 而不仅仅是单个 ItemView 工作。这是它：

```
// On the first render, apply the scrollers.
PlaylistTracks.on( 'show', function() {
$( '.ap-track-list' ).jScrollPane();    
});

// For when it's updated (this app includes paging, so this is frequent)
PlaylistTracks.on( 'render', function() {
    $( '.ap-track-list' ).jScrollPane();    
});

// .destroy() was also buggy for me, actually destroying the view. Use this
// Use removeData instead and manually remove elements for scroller
PlaylistTracks.on( 'before:render', function() {
    PlaylistTracks.$el.removeData('jsp').removeClass( 'jspScrollable' );
    PlaylistTracks.$('.jspContainer').remove();
}); 
```

现在它的工作没有任何困难。如果有人再次寻找这个，希望这会有所帮助:)

# ruby-on-rails - 在 Rspec 中重用代码的最佳实践？

> ID：10728397
> 
> 赞同：5
> 
> 时间：2012-05-23T21:50:47.773
> 
> 标签：ruby-on-rails, ruby, rspec, capybara

我正在使用 Rspec 和 Capybara 编写集成测试。我注意到，在测试活动记录选项的创建时，我经常必须执行相同的代码位。

例如：

```
it "should create a new instance" do
  # I create an instance here
end

it "should do something based on a new instance" do
  # I create an instance here
  # I click into the record and add a sub record, or something else
end 
```

问题似乎是 ActiveRecord 对象不会在测试中保持不变，但是 Capybara 默认情况下会在规范中维护相同的会话（怪异）。

我可以模拟这些记录，但由于这是一个集成测试，并且其中一些记录非常复杂（它们有图像附件等等），因此使用 Capybara 并填写面向用户的表单要简单得多。

我尝试定义一个创建新记录的函数，但由于某种原因感觉不对。这方面的最佳做法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T22:07:13.447

有几种不同的方式可以去这里。首先，在这两种情况下，您都可以将示例块分组到描述块或上下文块下，如下所示：

```
describe "your instance" do
  it "..." do
    # do stuff here
  end

  it "..." do
    # do other stuff here
  end
end 
```

然后，在 describe 或 context 块中，您可以设置可在所有示例中使用的状态，如下所示：

```
describe "your instance" do
  # run before each example block under the describe block
  before(:each) do
    # I create an instance here
  end

  it "creates a new instance" do
    # do stuff here
  end

  it "do something based on a new instance" do
    # do other stuff here
  end
end 
```

作为 before(:each) 块的替代方法，您还可以使用 let 助手，我发现它更具可读性。[你可以在这里](https://www.relishapp.com/rspec/rspec-core/v/2-10/docs/helper-methods/let-and-let)看到更多关于它的信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-23T22:02:24.337

满足您要求的最佳实践是使用[Factory Girl](https://github.com/thoughtbot/factory_girl_rails)从定义通用属性的蓝图创建记录，并使用[database_cleaner](https://github.com/bmabey/database_cleaner)跨不同测试/规范清理数据库。

并且**永远**不要在不同的规范中保持状态（例如创建的记录），这将导致依赖规范。`--order rand`您可以使用rspec 选项发现这种依赖关系。如果您的规格随机失败，您就会遇到此类问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-27T00:10:31.853

鉴于标题（...在 Rspec 中重用代码），我建议阅读“Ruby on Rails 教程”中的[RSpec 自定义匹配器。](http://ruby.railstutorial.org/book/ruby-on-rails-tutorial#sec%3arspec_custom_matchers)

Michael Hartl 提出了两种解决规范重复的方法：

1.  定义常用操作的辅助方法（例如登录用户）
2.  定义自定义匹配器

使用这些东西有助于将测试与实现分离。

除了这些，我建议（如法比奥所说）使用 FactoryGirl。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T21:49:04.010

您可以查看我的示例 rails 项目。你可以在那里找到：[https ://github.com/lucassus/locomotive](https://github.com/lucassus/locomotive)

*   如何使用 factory_girl
*   自定义匹配器和宏的一些示例（在`spec/support`）
*   如何使用`shared_examples`
*   最后如何使用非常好的 shoulda-macros

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-14T06:52:18.960

我会结合使用 factory_girl 和 Rspec 的 let 方法：

```
describe User do
  let(:user) { create :user } # 'create' is a factory_girl method, that will save a new user in the test database

  it "should be able to run" do
    user.run.should be_true
  end

  it "should not be able to walk" do
    user.walk.should be_false
  end
end

# spec/factories/users.rb
FactoryGirl.define do
  factory :user do
    email { Faker::Internet.email }
    username { Faker::Internet.user_name }
  end
end 
```

这使您可以做如下出色的事情：

```
describe User do
  let(:user) { create :user, attributes }
  let(:attributes) { Hash.new }

  it "should be able to run" do
    user.run.should be_true
  end

  it "should not be able to walk" do
    user.walk.should be_false
  end

  context "when user is admin" do
    let(:attributes) { { admin: true } }
    it "should be able to walk" do
      user.walk.should be_true
    end
  end
end 
```

# spring-mvc - 使用简单的spring memcached使命名空间无效

> ID：10728399
> 
> 赞同：0
> 
> 时间：2012-05-23T21:50:53.697
> 
> 标签：spring-mvc, memcached, simple-spring-memcached, ssm

有没有人尝试过基于时间戳使 memcached 命名空间无效？例如，我需要一个 memcached 命名空间，它是托管我的 API 服务的 tomcat 服务器的时间戳。我需要注释我的方法调用，以便命名空间是一个变量（而不是一个常量），并且它包含服务器启动的时间戳。

```
@ReadThroughAssignCache(namespace = "api_divisions_", assignedKey="allDivisions")
public List<Division> getAllDivisions()
{
    List<Division> all = (List<Division>)getHibernateTemplate().find("from Division");
    return all;
} 
```

那么每次服务器启动时，需要将该方法上的命名空间动态设置为服务器启动时间。

更新 - 我知道有一种使用 javaassist 和动态注释的迂回方法，但我想要一种更好的方法。

-戈茨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T17:52:20.653

命名空间始终是常量，不能使用变量。据我了解，您想使用服务器启动时间创建缓存键。至少有两种方法可以做到。第一：使用`@ReadThroughSingleCache`

```
@ReadThroughSingleCache(namespace = "api_divisions_allDivisions")
public List<Division> getAllDivisions(@ParameterValueKeyProvider long startup)
{
  List<Division> all = (List<Division>)getHibernateTemplate().find("from Division");
  return all;
} 
```

第二：使用自定义[CacheKeyBuilder](https://simple-spring-memcached.googlecode.com/svn/docs/2.0.0/apidocs/com/google/code/ssm/aop/support/CacheKeyBuilder.html)可以为每个缓存键添加时间戳。

您是否需要在服务器启动之前存储旧值？如果不是，那么简单的解决方案是始终使用相同的缓存键并在服务器启动时清理 memcached。

# iphone - 在 iOS 上，改变 UIView 对象的框架和中心可以改变其内部坐标系吗？

> ID：10728408
> 
> 赞同：2
> 
> 时间：2012-05-23T21:51:39.910
> 
> 标签：iphone, ios, uiview, frame, bounds

在 iOS 上，如果我们改变一个视图的`frame`，我们改变它的`bounds`，如果我们改变它的`bounds`，我们改变它的`frame`。

但是我们可以通过以下方式改变视图的内部坐标系：

```
CGRect b = v.bounds;    // v is the UIView object
b.origin.x = 10000;
b.origin.y = 10000;
v.bounds = b; 
```

现在，视图的左上角是 的坐标`(10000, 10000)`。这是否也可以通过仅更改`frame`而`center`不是更改来实现`bounds`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:07:39.920

> 在 iOS 上，如果我们改变视图的框架，我们就会改变它的边界，如果我们改变它的边界，我们就会改变它的框架。

这是对的一半。只有这两个矩形的*大小绑定在一起。*从文档：

> 框架和边界矩形的大小部分耦合在一起，因此更改任一矩形的大小都会更新两者的大小。

这并没有提到起源。因此，您的示例将修改内部坐标系的原点，而不会更改其在超级视图坐标系中的位置。您无法通过`frame`or`center`属性实现该行为；它们只影响视图在其父视图坐标系中的位置。

# c - 无限文件输出

> ID：10728409
> 
> 赞同：0
> 
> 时间：2012-05-23T21:51:41.123
> 
> 标签：c

```
void echoFileA(const char* iPath,const char* oPath)
{
    FILE* iFile;
    FILE* oFile;

    iFile = fopen(iPath,"rb");
    oFile = fopen(oPath,"wb");

    while(iFile)    
        fputc(fgetc(iFile),oFile);

    fclose(iFile);
    fclose(oFile);
} 
```

该过程纯粹是为了好玩而编写的，我知道在每个 OS API 库中都有方便的预制函数用于复制文件。回到正题——为什么循环条件总是为真，即使是很久以前就达到了EOF？我检查了我是否在测试程序中将正确的参数传递给了这个函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:57:44.210

你的循环体......

```
 fputc(fgetc(iFile),oFile); 
```

... 不会改变循环的条件，因此它将永远运行。

而是尝试类似...

```
int c;
while((c = fgetc(iFile)) != EOF) 
   fputc(c, oFile); 
```

一旦您到达输入文件的末尾，循环将结束。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T21:57:58.317

条件没有被忽略。iFile 是一个指针，因为这个指针从不为 NULL（或者更确切地说是 0），所以 while 条件始终为真。

尝试类似：

```
while(!feof(iFile))    
        fputc(fgetc(iFile),oFile); 
```

使 while 循环继续进行，直到到达文件末尾。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T21:57:52.057

`iFile`只是一个指向文件的指针。调用后它不再改变`fopen`。例如，作为循环中的条件，您需要使用 from 的返回值`fgetc`，因为这将告诉您是否已到达文件末尾。

# javascript - 在 Javascript 中，当执行深度复制时，由于属性是“this”，我如何避免循环？

> ID：10728412
> 
> 赞同：15
> 
> 时间：2012-05-23T21:51:54.420
> 
> 标签：javascript, deep-copy, kineticjs

我有一些库代码在我身上无休止地循环。

我不清楚如何最好地在 javascript 中执行循环检测和避免。即没有检查对象是否来自“this”引用的编程方式，有吗？

这是代码。谢谢！

```
setAttrs: function(config) {
    var go = Kinetic.GlobalObject;
    var that = this;

    // set properties from config
    if(config !== undefined) {
        function setAttrs(obj, c) {
            for(var key in c) {
                var val = c[key];

                /*
                 * if property is an object, then add an empty object
                 * to the node and then traverse
                 */
                if(go._isObject(val) && !go._isArray(val) && !go._isElement(val)) {
                    if(obj[key] === undefined) {
                        obj[key] = {};
                    }
                    setAttrs(obj[key], val);  // <--- offending code; 
                                              // one of my "val"s is a "this" reference
                                              // to an enclosing object
                } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T22:03:02.527

我知道处理这种情况的“可靠和干净”的方法是使用“访问过”对象的集合，然后根据当前对象是否已经“访问过”做出反应——终止、插入符号引用等“ 或不。

[Crockford 先生在cycle.js](https://github.com/douglascrockford/JSON-js/blob/master/cycle.js)中使用了这种方法，他使用 Array 来收集。摘抄：

```
// If the value is an object or array, look to see if we have already
// encountered it. If so, return a $ref/path object. This is a hard way,
// linear search that will get slower as the number of unique objects grows.

for (i = 0; i < objects.length; i += 1) {
    if (objects[i] === value) {
        return {$ref: paths[i]};
    }
} 
```

不幸的是，无法在 JavaScript 中为此使用原始的“哈希”方法，因为它缺少 Identity-Map。虽然 Array-collection 的界限`O(n^2)`并不*像听起来那么糟糕*：

这是因为，如果“已访问”集合只是一个守卫，那么 的值`n`就是堆栈的深度：只有循环很重要，而多次复制同一个对象则不重要。也就是说，可以在堆栈展开时修剪“已访问”集合中的对象。

在 cycle.js 代码中，“已访问”集合不能被修剪，因为它必须确保始终使用给定对象的相同符号名称，这允许序列化在恢复时“维护引用”。但是，即使在这种情况下，`n`也*只是*遍历的唯一非原始值的数量。

我能想到的唯一另一种方法是需要将“已访问属性”直接添加到正在遍历的对象中，我认为这是一个通常不受欢迎的功能。（但是，请参阅 Bergi 关于该工件 [相对] 容易清理的评论。）

快乐编码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T23:24:50.827

好的，我对@pst 提到的“已访问”属性的外观很感兴趣，所以我编写了以下代码：

```
Object.copyCircular = function deepCircularCopy(o) {
    const gdcc = "__getDeepCircularCopy__";
    if (o !== Object(o))
        return o; // primitive value
    var set = gdcc in o,
        cache = o[gdcc],
        result;
    if (set && typeof cache == "function")
        return cache();
    // else
    o[gdcc] = function() { return result; }; // overwrite
    if (o instanceof Array) {
        result = [];
        for (var i=0; i<o.length; i++) {
            result[i] = deepCircularCopy(o[i]);
    } else {
        result = {};
        for (var prop in o)
            if (prop != gdcc)
                result[prop] = deepCircularCopy(o[prop]);
            else if (set)
                result[prop] = deepCircularCopy(cache);
    }
    if (set)
        o[gdcc] = cache; // reset
    else
        delete o[gdcc]; // unset again
    return result;
}; 
```

请注意，这只是一个示例。它不支持：

*   非普通物体。带有原型的所有内容（数组除外）都不会被克隆，而是复制到`new Object`! 这包括功能！
*   跨全局范围的对象：它使用`instanceof Array`.
*   属性描述符，如 setter/getter、不可写和不可枚举的属性

好东西：

*   它不使用每次遇到对象时都需要搜索的大数组。

缺点：

*   不适用于具有`__getDeepCircularCopy__`与其声称的方法不同的方法的对象。尽管在这个轻量级版本中无论如何都不支持方法（以函数为值的属性）。

此解决方案将适用于具有循环引用的对象，复制循环结构，*而不会以无限循环结束*。请注意，“循环”在这里意味着一个属性在“树”中引用其“父级”之一：

```
 [Object]_            [Object]_
     /    |\              /    |\
   prop     |           prop    |
     \_____/             |      |
                        \|/     |
                      [Object]  |
                          \     |
                         prop   |
                            \___/ 
```

共享叶子的树的结构不会被复制，它们将成为两个独立的叶子：

```
 [Object]                     [Object]
             /    \                       /    \
            /      \                     /      \
          |/_      _\|                 |/_      _\|  
      [Object]    [Object]   ===>  [Object]    [Object]
           \        /                 |           |
            \      /                  |           |
            _\|  |/_                 \|/         \|/
            [Object]               [Object]    [Object] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T22:03:29.517

除非您想跟踪复制的每个属性，否则不会。

但是，如果您确定每个属性都是`null`字符串、数字、数组或简单对象，则可以捕获`JSON.stringify`异常以查看是否存在反向引用，如下所示：

```
try {
    JSON.stringify(obj);
    // It's ok to make a deep copy of obj
} catch (e) {
    // obj has back references and a deep copy would generate an infinite loop
    // Or finite, i.e. until the stack space is full.
} 
```

这只是一个想法，我对表演一无所知。我担心它在大型物体上可能会很慢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-27T11:53:41.537

这是一个简单的递归克隆方法。像许多其他解决方案一样，大多数非基本属性将与原始对象（例如函数）共享一个引用。

它通过保留引用对象的映射来处理无限循环，以便后续引用可以共享相同的克隆。

```
const georgeCloney = (originalObject, __references__ = new Map()) => {
  if(typeof originalObject !== "object" || originalObject === null) {
    return originalObject;
  }

  // If an object has already been cloned then return a
  // reference to that clone to avoid an infinite loop
  if(__references__.has(originalObject) === true) {
    return __references__.get(originalObject);
  }

  let clonedObject = originalObject instanceof Array ? [] : {};

  __references__.set(originalObject, clonedObject);

  for(let key in originalObject) {
    if(originalObject.hasOwnProperty(key) === false) {
      continue;
    }

    clonedObject[key] = georgeCloney(originalObject[key], __references__);
  }

  return clonedObject;
}; 
```

示例用法...

```
let foo = {};
foo.foo = foo;

let bar = georgeCloney(foo);
bar.bar = "Jello World!";

// foo output
// {
//   foo: {
//     foo: {...}
//   }
// }
// 
// bar output
// { 
//   foo: { 
//     foo: {...},
//     bar: "Jello World!"
//   }, 
//   bar: "Jello World!"
// } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-14T05:58:42.930

我必须这样做才能接受采访，这就是我得到的：

```
Object.defineProperty(Object.prototype, 'deepclone', { enumerable :false, configurable :true, value :function(){
  let map /*for replacement*/ =new Map(), rep ={} ;map.set(this, rep)
  let output = (function medclone(_, map){  let output ={..._}
    for(let k in _){  let v =_[k]
      let v2 ;if(!(v instanceof Object)) v2 =v ;else {
        if(map.has(v)) v2 =map.get(v) ;else {
          let rep ={}
          map.set(v, rep), v2 =medclone(v, map)
          Replace(rep, v2), map.set(v, v2)
        }
      }
      output[k] =v2
    }    return output
  })(this, map)
  Replace(rep, output)
  return output
  /*[*/ function Replace(rep/*resentative*/, proper, branch =proper, seens =new Set()){
    for(let k in branch){  let v =branch[k]
      if(v ===rep) branch[k] =proper
      else if(v instanceof Object &&!seens.has(v)) seens.add(v), Replace(rep, proper, v, seens)
    }
  }/*]*/
} })
                                                                                                                                  // Code is freely available for use for academia/scrutiny. As for development, contact author. 
```

该方法是“hack and slash”而不是“在编码之前有充足的时间计划”，所以结果不可能那么好，但它确实有效。可以对其进行迭代以删除递归入口点中的 WET，例如。

# c# - 在 Mono 中运行 PowerShell 脚本？

> ID：10728416
> 
> 赞同：0
> 
> 时间：2012-05-23T21:52:32.610
> 
> 标签：c#, powershell, mono

> **可能重复：**
> [PowerShell 脚本是否在 Mono 下运行？](https://stackoverflow.com/questions/1083275/do-powershell-scripts-run-under-mono)

好的，我的任务是使用 .NET 的 PowerShell 自动化库让 PowerShell 脚本在 CentOS 5.7 机器上运行。这意味着我必须在 Mono 上运行它，但是我收到了很多关于缺少引用的错误。这是我正在使用的教程：http: [//www.codeproject.com/Articles/18229/How-to-run-PowerShell-scripts-from-C](http://www.codeproject.com/Articles/18229/How-to-run-PowerShell-scripts-from-C)

Mono 项目兼容性页面 ( [http://www.mono-project.com/Compatibility](http://www.mono-project.com/Compatibility) ) 没有说明它是否支持 Powershell。我很难相信像 Mono 这样的项目没有这些重要的库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:02:10.280

不，PowerShell 现在不是 Mono 支持的东西。移植整个框架（合法地）需要大量工作。

坦率地说，我认为 Mono 上对 PowerShell 的需求并不大，因为 *nix 环境通常已经拥有丰富的脚本环境，而这正是 PowerShell 试图为 Windows 带来的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T04:07:40.413

如果您的脚本仅使用 1.0 功能并且使用 mono 不是硬性要求，那么 powershell v1.0 根据 winehq 在 WINE 下运行良好。

[http://appdb.winehq.org/objectManager.php?sClass=application&iId=8049](http://appdb.winehq.org/objectManager.php?sClass=application&iId=8049)

# sql - SQL Server 2008 - 函数错误

> ID：10728417
> 
> 赞同：1
> 
> 时间：2012-05-23T21:52:36.740
> 
> 标签：sql, sql-server-2008

我是 sql 编程新手；尝试开发此功能以从视图中获取具有特定访问次数的客户行：

```
 ALTER FUNCTION [dbo].[fn_NumberOfVisit] 
(
@nv int
)
RETURNS varchar(500)
AS
BEGIN
DECLARE @ret varchar(500)

 select *
from (
    select 
        *,
        rn = row_number() over (partition by ClientId order by VisitId)
    from
        Visit
) activityWithRn
inner join vw_MasterView on  vw_MasterView.VisitId = activityWithRn.VisitId
where activityWithRn.rn =@nv

RETURN @ret

END 
```

我收到以下错误：

```
 Select statements included within a function cannot return data to a client 
```

感谢您的支持。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:57:17.360

你的问题在这里：

```
set @Count = ( select *
from (
    select 
        *, 
```

@Count 期待一个数字 - 你给它一堆行，试试：

```
set @Count = ( select Count(*)
from (
    select 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:59:18.190

该错误告诉您您的子查询返回了太多行。如果要将结果分配给变量，则只需要返回一行。

改变

```
set @Count = ( select *
from (
    select 
        *,
        rn = row_number() over (partition by ClientId order by VisitId)
    from
        Visit 
```

到

```
set @Count = ( select count(*)
from (
    select 
        *,
        rn = row_number() over (partition by ClientId order by VisitId)
    from
        Visit 
```

# json - 使用 CloudFront 防止 Amazon S3 上的热链接

> ID：10728419
> 
> 赞同：4
> 
> 时间：2012-05-23T21:52:47.457
> 
> 标签：json, amazon-s3, amazon-cloudfront, hotlinking

我尝试使用此存储桶策略防止在 Amazon S3 上热链接媒体文件。

```
{
"Version": "2008-10-17",
"Id": "my-id",
"Statement": [
    {
        "Sid": "Allow get requests to specific referrers",
        "Effect": "Allow",
        "Principal": {
            "AWS": "*"
        },
        "Action": "s3:GetObject",
        "Resource": "arn:aws:s3:::bucketname/*",
        "Condition": {
            "StringLike": {
                "aws:Referer": "http://sitename.com/"
            }
        }
    },
    {
        "Sid": "Allow CloudFront get requests",
        "Effect": "Allow",
        "Principal": {
            "AWS": "arn:aws:iam::amazonaccountid:root"
        },
        "Action": "s3:GetObject",
        "Resource": "arn:aws:s3:::bucketname/*"
    }
]
} 
```

ACL 设置为私有。我仍然无法让它接受我试图访问的文件。

我尝试了许多在这里找到的不同策略，但似乎都没有任何效果。我试图阻止热链接的文件是 .swf 文件。

当我使用没有云端的确切 (bucketname.s3.amazonaws.com) 链接时，它可以工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-10T11:41:27.383

这是我用来让它工作的存储桶策略。

```
{
"Version": "2008-10-17",
"Id": "http referer policy",
"Statement": [
    {
        "Sid": "Allow get requests referred by www.mysite.com and mysite.com",
        "Effect": "Allow",
        "Principal": "*",
        "Action": "s3:GetObject",
        "Resource": "arn:aws:s3:::bucketname/*",
        "Condition": {
            "StringLike": {
                "aws:Referer": "http://www.mysite.com/*"
            }
        }
    }
] 
```

}

# git - 在 GitHub 中编辑 git commit 消息

> ID：10728420
> 
> 赞同：203
> 
> 时间：2012-05-23T21:52:48.767
> 
> 标签：git, github, commit, post-commit

提交后，有什么方法可以在线编辑提交消息`GitHub.com`吗？

从命令行，一个可以做

```
git commit --amend -m "New commit message" 
```

正如[另一个问题](https://stackoverflow.com/questions/179123/how-do-i-edit-an-incorrect-commit-message-in-git)中正确建议的那样。

尝试`git pull`然后`git push`工作（同时没有任何其他提交干扰）。

但是可以通过`GitHub`网站完成吗？

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2017-01-06T20:03:56.430

# GitHub 执行此操作的说明：

1.  在命令行上，导航到包含要修改的提交的存储库。
2.  键入`git commit --amend`并按 Enter。
3.  在您的文本编辑器中，编辑提交消息并保存提交。
4.  使用该`git push --force example-branch`命令强制推送旧提交。

来源：[https ://help.github.com/articles/changeing-a-commit-message/](https://help.github.com/articles/changing-a-commit-message/)

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2012-05-23T21:56:02.163

不，这不是直接可能的。每个 Git 提交的哈希值也是根据提交消息计算的。当您更改提交消息时，您会更改提交哈希。如果要推送该提交，则必须强制该推送（git push -f）。但是，如果已经有人取消了您的旧提交并基于该提交开始了一项工作，那么他们将不得不将他们的工作重新定位到您的新提交上。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-05-23T21:55:50.377

您需要`git push -f`假设之前没有人拉过其他提交。当心，你正在改变历史。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-08-13T13:41:46.677

**对于 intellij 用户：** 如果您想以交互方式对过去的提交进行更改，而不是推送，请按照**Intellij**中的以下步骤操作：

*   选择版本控制
*   选择日志
*   右键单击要修改评论的提交
*   点击**改写**
*   完毕

希望能帮助到你

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-15T09:13:54.837

不，因为提交消息与提交 SHA / 哈希有关，如果我们更改它，提交 SHA 也会更改。我使用的方式是对该提交创建评论。我不能想别的办法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-11-22T06:56:40.190

**对于 Android Studio / intellij 用户：**

*   选择版本控制
*   选择日志
*   右键单击要重命名的提交
*   单击**编辑提交消息**
*   写下你的提交信息
*   完毕

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-15T23:36:39.550

我面临着同样的问题。

在您的 github 中查看特定分支，您将知道该分支中第一个提交的提交 ID。做一个变基：

```
git rebase -i <Commit SHA of first commit> 
```

将打开一个编辑器。从 github UI 跟踪您的提交并打开编辑器并更改消息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-08T15:18:56.350

我被要求修改我在 github 上提交的补丁提交消息，（并最终在这里。）这就是我为完成工作所做的。

```
git clone git@github.com:YOURNAME/EXAMPLE.git; cd EXAMPLE; git fetch --all; git pull --all
git checkout -b patch-2 origin/patch-2 # create local patch-2 branch
git commit --amend # update the commit message
git push -f 
```

这适用于分支上的最后一次提交。如果有问题的提交更深，您将需要做一些更复杂的事情。（我不知道是否需要 fetch 和 pull ，但我只是在做其他事情以节省时间时跳过那条线。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-09T13:05:10.143

**对于 Visual Studio 用户：**

您可以通过单击 Unpushed Commit (1) 和 View Outgoing/Incoming 选项 (2) 从提交选项卡修改提交消息。然后，一旦修改了评论 (3)，“修改消息”选项 (4) 就会启用，并且会在提交中自动执行更改。

[![在此处输入图像描述](../Images/22f75d775a4e2417aa8c454fa1c7ace2.png)](https://i.stack.imgur.com/Rfe3M.png)

在 VS 2019 上测试

# actionscript-3 - AS3 更智能的类型定义

> ID：10728421
> 
> 赞同：0
> 
> 时间：2012-05-23T21:52:48.860
> 
> 标签：actionscript-3, game-engine

我正在 AS3 中开发基于组件的引擎，并且我在游戏对象中有一个函数，它根据它的类型返回一个组件：

```
gameObject.Has(Body); //This will return a reference to the gameobjects body component 
```

我遇到的问题是访问组件。为此，我必须执行以下操作：

```
Body(gameObject.Has(Body)).SetVelocity(5); 
```

有没有人有更好的方法来做到这一点？

编辑：

```
public function Has(type:Class):BaseComponent
{
    for each(var component:BaseComponent in m_components)
        if (component is type)
            return component;

    return null;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:40:21.587

您的问题似乎是您试图在实现中过于通用。这引入了两个可能的失败点：在“in”一侧，您可能会为您的 Body 加载一个 BaseObject，它不是 Body；在“out”一侧，您的 gameObject 可能会返回一个不是 Body 的对象一个 Body（当前的实现显然是类型安全的这一事实不是给定的）。

您知道，任何时候您调用本质上是一个*真正*通用的 getter 时，您都需要它返回特定类型的对象（因为您将在其上调用方法），所以为什么不通过让自己的生活更轻松需要显式的 getter 和 setter？

或者您可能会变得**非常**荒谬并将您的 BaseObject 通用化，例如：

```
gameObject.has(Body).callMethod('setVelocity').to(5); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T05:51:47.137

我们在我们的项目中做同样的事情。但我们还有另一种方法。我们的 ObjectUtility 中有一个实用程序类。该方法返回特定根对象下的所有对象。

```
 public function collectObjectsByType(object:Object, type:Class, results:Array):void
    {

    } 
```

我可以只显示方法结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T22:18:45.630

您目前对 Has() 的返回类型有什么看法？

如果您更喜欢绕过类型检查。你可以让你的 Has() 方法返回 Object 类型。

```
public function Has():Object{
  ...
  return anObject;
}

#then you can call any prop/method without throwing type errors.
gameObject.Has(Body).SetVelocity(5) 
```

但是，在不强制转换 var 的情况下，没有一种很好的方法来维护类型检查，您已经在示例代码中这样做了。

# regex - 如何快速添加对 etags 的新语言支持

> ID：10728425
> 
> 赞同：2
> 
> 时间：2012-05-23T21:53:09.823
> 
> 标签：regex, emacs, ctags, etag

我有一个 .ctags 文件，其语言定义类似于[ctags 文档](http://ctags.sourceforge.net/EXTENDING.html)中指定的定义：

```
 --langdef=swine
  --langmap=swine:.swn
  --regex-swine=/^def[ \t]*([a-zA-Z0-9_]+)/\1/d,definition/ 
```

是否可以用 etags 做同样的事情？在构建新的 TAGS 文件时，我注意到（可能是出于显而易见的原因）我的 ~/.ctags 文件没有效果。我什至尝试将 ~/ctags 复制到 ~/.etags。同样，我已经准备好创建 .etags 文件的文档。

这可能吗，我是否缺少步骤，有谁知道我在哪里可以找到类似的 etags 文档（如果不同）？

**编辑：作为记录，我的 .ctags 完全按照我的意愿进行，但我必须在运行 etags 时明确定义“--regex =”以获得相同的效果。**

文档：[http ://www.gnu.org/software/emacs/manual/html_node/emacs/Etags-Regexps.html](http://www.gnu.org/software/emacs/manual/html_node/emacs/Etags-Regexps.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T05:02:33.630

您*可能*正在从 SourceForce运行`ctags`（“Exuberant Ctags”），但`etags`Emacs 提供了吗？

尝试调用`ctags -e`而不是`etags`?

**编辑：**我假设您的 .ctags 配置确实在您运行时生效`ctags`？您没有明确说明是否是这种情况，如果不是，那么您可能实际上并没有使用您认为的 ctags。

做什么`ctags --version`和`etags --version`报告？

# objective-c - UITableViewCell 文本字段在滚动表格视图时消失数据

> ID：10728426
> 
> 赞同：3
> 
> 时间：2012-05-23T21:53:10.533
> 
> 标签：objective-c, ios, cocoa-touch, uitableview

我有一个`UITableView`自定义单元格，这些单元格包含一些文本字段。在这里，当我在 textFields 中输入一些数据并滚动表格视图数据时，它会消失，我认为是因为每次它都在创建新单元格。

我通过使用数组并在其中插入每个单元格来解决这个问题，但是在这里我无法重用单元格，所以我们在浪费内存。

你能告诉我我应该如何处理这种行为吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T21:59:18.373

使用数组存储每个文本字段的值，并在

```
- (UITableViewCell *)tableView:(UITableView *)tTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:50:36.747

听起来好像与您如何在该`tableView:cellForRowAtIndexPath:`方法中创建单元格有关。但是在没有看到您的实施的情况下，我只能提出一般性建议（将您的实施添加到您的问题中，以便人们可以更具体地回答他们的答案）。

如果您担心内存`UITableView's`，请通过以下方式创建单元格来使用内置的单元格重用功能：

```
NSString *identifier = @"reuseIdentifier";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:identifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:identifier] autorelease];
}
cell.textLabel.text = @"text relating to index path"; 
```

以上将检查`tableView`是否有任何可用的单元格可供重用。如果没有，则将返回 nil。在这里，您可以使用将`initWithStyle:reuseIdentifier:`单元格标记为适合在滚动出视图时重复使用的方法来创建单元格。这意味着您最多只能实例化一次可见的单元格总数，这使您的表的内存占用保持良好且低。

请注意，我们将单元格设置`textField.text`在 nil 检查之外 - 这是为了确保如果我们检索到可重用单元格，我们将使用与`indexPath`传递给方法相关的文本内容覆盖其旧文本内容。

# android - 在 GridView 中使用 ImageAdapter

> ID：10728430
> 
> 赞同：0
> 
> 时间：2012-05-23T21:53:40.113
> 
> 标签：android, gridview, baseadapter

我正在尝试创建一个记忆游戏 - 我在屏幕上有 5x5 图像，用户必须匹配图像。我一直在使用 GridView 并使用 ImageAdapter 用图像填充它。游戏的工作原理如下： - 当用户匹配 2 张图像时 - 图像保留在屏幕上 - 当用户无法匹配 2 张图片时 - 图像变回问号。问题是我无法将之前匹配的图片保留在屏幕上——当我使用 notifyDataSetChanged() 方法时——所有的屏幕都再次被问号填满。这是我的代码：

// ImageAdapter 中的 getView 方法

```
public View getView(int position, View convertView, ViewGroup arg2) {
     ImageView imageView;
        if (convertView == null) {  // if it's not recycled, initialize some attributes
            imageView = new ImageView(mContext);
            imageView.setLayoutParams(new GridView.LayoutParams(100, 100));
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            imageView.setPadding(4, 4, 4, 4);
        } else {
            imageView = (ImageView) convertView;
        }

        for(int i=0;i<16;i++)
        {
            if(mThumbIds[i].equals(R.drawable.ic_launcher))
            {
                imageView.setImageResource(R.drawable.ic_launcher);
            }
            else
                imageView.setImageResource(R.drawable.q_mark);
        }
        return imageView;
} 
```

// 当用户选择 1 张图片时的 onClickListener

```
 gridview.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View v, int position,
                long id) {
            i++;
            Toast.makeText(easyGame.this, "" + position, Toast.LENGTH_SHORT).show();
            ImageView imgV=(ImageView)v;

            if(i%2!=0)
            {

                firstClick=position;
                imgV.setImageResource(ImageAdapter.mThumbIds[firstClick]);

            }
            else
            {   
                secondClick=position;
                imgV.setImageResource(ImageAdapter.mThumbIds[secondClick]);
            }

            if(i%2==0)
            {

            if(!(ImageAdapter.mThumbIds[firstClick].equals(ImageAdapter.mThumbIds[secondClick])))
            {
                Toast.makeText(easyGame.this, "Great!", Toast.LENGTH_SHORT).show();
                ImageAdapter.mThumbIds[firstClick]=ImageAdapter.mThumbsIdsDone[0];
                ImageAdapter.mThumbIds[secondClick]=ImageAdapter.mThumbsIdsDone[0];
                im.notifyDataSetChanged();
                gridview.setAdapter(im);
                gridview.invalidate();
            }
            }       
        }
    }); 
```

任何人都可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:28:04.473

```
// declare as class variable to keep track of views which should stay visible
private HashSet<Integer> keepVisibleViews = new HashSet<Integer>(25);

//in you on click listener
if(!(ImageAdapter.mThumbIds[firstClick].equals(ImageAdapter.mThumbIds[secondClick])))
 {
     // ... the rest of your code here
     // keep track of views that should stay visible
     keepVisibleViews.add(firstClick);
     keepVisibleViews.add(secondClick);
 }

// in your getView
// show ? mark if we should, else the picture
if (keepVisibleViews.contains(position)
      setImageResource(ImageAdapter.mThumbIds[secondClick]);
else
      imageView.setImageResource(R.drawable.q_mark); 
```

# ruby-on-rails - OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed

> ID：10728436
> 
> 赞同：18
> 
> 时间：2012-05-23T21:54:38.053
> 
> 标签：ruby-on-rails, ubuntu, ssl, openssl, rvm

我使用 RVM 在 Ubuntu 12.04 上安装 Ruby 1.9.3

```
rvm pkg install openssl
rvm install 1.9.3 --with-openssl-dir=$rvm_path/usr 
```

然后当我尝试按照以下方式运行时：

```
require 'open-uri'
open('https://www.google.com/') 
```

我得到错误：`OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed`

我该如何解决这个问题？我有很多类似的线程，人们在 OSX 中遇到这个问题，但是如何在 Ubuntu 中解决它？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-24T00:27:53.187

如果未使用本机 OpenSSL 库正确设置默认的“OpenSSL 目录”，有时会发生这种情况。open-uri 用于`OpenSSL::X509::Store#set_default_paths`告诉 OpenSSL 在 OpenSSL 目录中查找包含 OpenSSL 默认信任的受信任根证书的文件。

在您的情况下，此查找失败。您可以通过设置一个覆盖默认设置并告诉 OpenSSL 改为查看该目录的环境变量来使其成功：

```
export SSL_CERT_FILE=/etc/pki/tls/cert.pem 
```

这是我的 Fedora 16 64 位上根 CA 包的默认位置，其他常用位置是 /etc/ssl/ca-bundle.crt 等。在您的情况下，RVM 使用的 OpenSSL 库位于 $rvm_path/usr，所以你应该在那里寻找一个合适的默认根 CA 文件的候选者。环境变量设置正确后，调用open-uri就会成功。

要使环境变量永久化，请使用通常的方法，例如在 .bashrc、/etc/profile 或任何最适合您的情况下定义导出。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-05T18:52:17.170

将“认证”gem 添加到您的 Gemfile。

更多信息：[https ://rubygems.org/gems/certified](https://rubygems.org/gems/certified)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-06-14T21:09:39.227

rvm 安装的 openssl 中缺少 cacert.pem 文件。

```
$ cd $rvm_path/usr/ssl
$ sudo curl -O http://curl.haxx.se/ca/cacert.pem
$ sudo mv cacert.pem cert.pem 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-07T15:45:41.023

请参阅[http://jjinux.blogspot.nl/2012/02/ruby-working-around-ssl-errors-on-os-x.html](http://jjinux.blogspot.nl/2012/02/ruby-working-around-ssl-errors-on-os-x.html)作为您问题的替代答案，它应该适用于 Ubuntu 和 Mac OS X用户，它不需要更改环境变量。

来自上述链接的解决方案：

```
# config/initializers/fix_ssl.rb
# 
# Work around errors that look like:
#
#   SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (OpenSSL::SSL::SSLError)

require 'open-uri'
require 'net/https'

module Net
  class HTTP
    alias_method :original_use_ssl=, :use_ssl=

    def use_ssl=(flag)
      # Ubuntu
      if File.exists?('/etc/ssl/certs')
        self.ca_path = '/etc/ssl/certs'

      # MacPorts on OS X
      # You'll need to run: sudo port install curl-ca-bundle
      elsif File.exists?('/opt/local/share/curl/curl-ca-bundle.crt')
        self.ca_file = '/opt/local/share/curl/curl-ca-bundle.crt'
      end

      self.verify_mode = OpenSSL::SSL::VERIFY_PEER
      self.original_use_ssl = flag
    end
  end
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-11T17:53:14.610

这现在对我有用。当我运行“brew doctor”时，事情开始起作用了，这让我找到了诸如“未设置 SSL_CERT_DIR”之类的线索

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-03T16:49:45.500

## 检查你的系统时钟！！

在长时间（1 周）未使用后，在虚拟机上出现此错误。更新我的系统时钟立即解决了这个问题。

如果您正在跑步，`ntpd`那么`ntpdate -b -u pool.ntp.org`将为您做到这一点。

# c# - 自定义 GetHashcode 实现是否会导致 Dictionary 或 Hashtable 的“桶”出现问题

> ID：10728440
> 
> 赞同：1
> 
> 时间：2012-05-23T21:54:47.843
> 
> 标签：c#, dictionary, gethashcode, compareto, sorteddictionary

我正在考虑为给定对象实现我自己的自定义哈希码......并将其`key`用作我的字典。由于 2 个对象可能（很可能）具有相同的哈希码，我应该覆盖哪些额外的运算符，以及该覆盖（从概念上）应该是什么样子？

```
 myDictionary.Add(myObj.GetHashCode(),myObj); 
```

对比

```
 myDictionary.Add(myObj,myObj); 
```

换句话说，字典是否使用以下组合来确定唯一性以及将对象放置在哪个存储桶中？

哪些比其他更重要？

*   哈希码
*   等于
*   ==
*   相比于（）

是否仅在 SortedDictionary 中需要 compareTo？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:59:33.607

GetHashCode 是做什么用的？

它在设计上只对一件事有用：将对象放入哈希表中。由此得名。

GetHashCode 旨在只做一件事：平衡哈希表。请勿将其用于其他任何用途。尤其是：

*   它不提供对象的唯一键；碰撞概率极高。
*   它不具有加密强度，因此请勿将其用作数字签名的一部分或等效密码
*   它不一定具有校验和所需的错误检测属性。

等等。

埃里克·利珀特

[http://ericlippert.com/2011/02/28/guidelines-and-rules-for-gethashcode/](http://ericlippert.com/2011/02/28/guidelines-and-rules-for-gethashcode/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:59:24.257

导致问题的不是存储桶 - 一旦您使用哈希码确定了存储桶，它实际上是在找到正确的对象实例。由于存储桶中的所有对象共享相同的哈希码，因此使用对象相等 ( `Equals`) 来找到正确的对象。规则是，如果两个对象被认为相等，它们应该产生相同的哈希码 - 但产生相同哈希码的两个对象可能不相等。

# ms-word - 如何在 Word 2010 文档中使用 OpenXML SDK 解锁内容控件？

> ID：10728442
> 
> 赞同：6
> 
> 时间：2012-05-23T21:55:11.497
> 
> 标签：ms-word, openxml, openxml-sdk

我正在服务器端操作 Word 2010 文档，并且文档中的某些内容控件检查了以下锁定属性

*   无法删除内容控制
*   内容无法编辑

谁能建议使用 OpenXML SDK 将这些锁定选项设置为 false 或完全删除？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T19:31:22.373

openxml SDK 提供`Lock`类和`LockingValues`枚举以编程方式设置选项：

*   内容控制不能被删除和
*   内容无法编辑

因此，要将这两个选项设置为“false”( `LockingValues.Unlocked`)，请搜索`SdtElement`文档中的所有元素并将`Val`属性设置为 `LockingValues.Unlocked`。

下面的代码显示了一个示例：

```
static void UnlockAllSdtContentElements()
{
  using (WordprocessingDocument wordDoc =
    WordprocessingDocument.Open(@"c:\temp\myword.docx", true))
  {        
    IEnumerable<SdtElement> elements = 
      wordDoc.MainDocumentPart.Document.Descendants<SdtElement>();

    foreach (SdtElement elem in elements)
    {
      if (elem.SdtProperties != null)
      {
        Lock l = elem.SdtProperties.ChildElements.First<Lock>();

        if (l == null)
        {              
          continue;
        }

        if (l.Val == LockingValues.SdtContentLocked)
        {
          Console.Out.WriteLine("Unlock content element...");
          l.Val = LockingValues.Unlocked;
        }
      }
    }
  }
}

static void Main(string[] args)
{
  UnlockAllSdtContentElements();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-30T10:26:44.160

只是对于那些复制这段代码的人，请记住，如果没有与内容控件关联的 Locks，则不会有与之关联的 Lock 属性，因此当代码执行以下指令时，它将返回一个异常，因为没有找到元素：

```
Lock l = elem.SdtProperties.ChildElements.First<Lock>(); 
```

解决这个问题的方法是`FirstOrDefault`代替`First`.

# jquery - 使用 jQuery 将表格转换为 div 并在每个 td 前面附加 th

> ID：10728445
> 
> 赞同：5
> 
> 时间：2012-05-23T21:55:32.327
> 
> 标签：jquery, html-table

我正在尝试将所有表转换为 div，并添加转换为 div 的每个 td 的 th html 或 th 的内容。

所以我的桌子看起来像这样：

```
<table>
    <tr>
      <th>Title 1</th>
      <th>Title 2</th>
      <th>Title 3</th>
      <th>Title 4</th>
      <th>Title 5</th>
    </tr>
    <tr>
      <td>Data 1</td>
      <td>Data 2</td>
      <td>Data 3</td>
      <td>Data 4</td>
      <td>Data 5</td>
    </tr>               
</table> 
```

我想把它转换成这样：

```
<div class="box">
<div class="row-fname"><span class="fname-label">TH Data</span> : <span class="fname-data">Data 1</span></div>
<div class="row-lname"><span class="lname-label">TH Data</span> : <span class="lname-data">Data 2</span></div>
<div class="row-address"><span class="address-label">TH Data</span> : <span class="address-data">Data 3</span></div>
<div class="row-city"><span class="city-label">TH Data</span> : <span class="city-data">Data 4</span></div>
<div class="row-state"><span class="state-label">TH Data</span> : <span class="state-data">Data 5</span></div> 
```

我发现这段代码几乎可以工作，但如果有任何 th，我可以弄清楚如何让它获得 th，并将它们添加到每个 td 的数据跨度之前。

```
$('.content table').replaceWith(function() {
    var html = '';

    $('tr', this).each(function() {         
        html += '<div class="box grey-bg">';
        $('th, td', this).each(function() {
            html += '<span>' + $(this).html() + '</span>';
        });
        html += '</div>';
    });

    return '<div class="">' + html + '</div>';
}); 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T22:08:36.263

这是我的即兴创作:)

为每个添加`data-name`标签以`<th>`区分字段的名称：

```
<table>
    <tr>
        <th data-name="fname">Title 1</th>
        <th data-name="lname">Title 2</th>
        <th data-name="address">Title 3</th>
        <th data-name="city">Title 4</th>
        <th data-name="state">Title 5</th>
    </tr>
    <tr>
        <td>Data 1</td>
        <td>Data 2</td>
        <td>Data 3</td>
        <td>Data 4</td>
        <td>Data 5</td>
    </tr>               
</table>​ 
```

并尝试下面的代码。至少你会得到你需要的结构。

```
$("table").replaceWith(function() {
    var block = $("<div />").addClass("box");
    $("tr:first th", this).each(function() {
        var name = $(this).data("name");
        var spanLabel = $("<span />").addClass(name + "-label").html(this.innerHTML);
        var spanData = $("<span />").addClass(name + "-data");
        $("<div />").addClass("row-" + name).append(spanLabel, " : ", spanData).appendTo(block);
    });
    $("tr:last td", this).each(function(index) {
        block.children("div:eq(" + index + ")").children(":last").html(this.innerHTML);
    });
    return block;
}); 
```

**演示：http:** [//jsfiddle.net/BsUVA/](http://jsfiddle.net/BsUVA/)

* * *

**更新。**如果您无法为标签添加额外的`data`属性`<th>`，则问题不大。对于非硬编码，我们可以将名称移动到数组（如下所示）并使用它。

```
var names = [
    "fname",
    "lname",
    "address",
    "city",
    "state"
]; 
```

**演示：http:** [//jsfiddle.net/BsUVA/1/](http://jsfiddle.net/BsUVA/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T22:40:24.037

这有效：

```
$('.content table').replaceWith(function() {

    var $th = $(this).find('th'); // get headers
    var th = $th.map(function() {
        return $(this).text();
    }).get(); // and their values

    $th.closest('tr').remove(); // then remove them

    var $d = $('<div>', { 'class': 'box' });

    $('tr', this).each(function(i, el) {
        var $div = $('<div>', {'class': 'inner'}).appendTo($d);
        $('td', this).each(function(j, el) {
            var n = j + 1;
            var $row = $('<div>', {
                'class': 'row-' + n
            });
            $row.append(
            $('<span>', {
                'class': 'label-' + n,
                text: th[j]
            }), ' : ', $('<span>', {
                'class': 'data-' + n,
                text: $(this).text()
            })).appendTo($div);
        });
    });

    return $d;
}); 
```

演示在[http://jsfiddle.net/alnitak/UK395/](http://jsfiddle.net/alnitak/UK395/)

# javascript - 通过jquery或javascript从扫描的pdf（图像）中读取二维条码？

> ID：10728452
> 
> 赞同：1
> 
> 时间：2012-05-23T21:56:00.293
> 
> 标签：javascript, jquery, pdf, barcode, code39

任何人都知道通过 jQuery 或 javascript 从扫描的 1 页 .pdf 中读取 CODE39 条形码的任何方法吗？

我的目标是能够将 .pdf 的 url 路径传递给一个函数，该函数返回在扫描的 .pdf 上的条形码中编码的数据字符串。

我不精通 Java，所以 ZXing 有点过头了。

非常感谢任何帮助。

# html - 不要使用缓存清单缓存当前（索引）页面

> ID：10728460
> 
> 赞同：6
> 
> 时间：2012-05-23T21:57:00.390
> 
> 标签：html, caching, manifest

默认情况下，当使用缓存清单时，浏览器也会缓存当前 (HTML) 页面。我怎么***不***这样做？

我的网站看起来像`domain.com/`在地址栏中，但实际上是在提供`domain.com/index.php`. 我试过了：

```
NETWORK
/
* 
```

和

```
NETWORK
/index.php
* 
```

...以及不带前导斜杠的 index.html、index.php 等变体等（清单工作正常，否则它会正确缓存`CACHE:`标题下列出的一些文件，使用正确的 MIME 类型提供服务等。 )

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T14:02:20.320

不要将清单引用放在您的 index.php 中。将它放在您确实想要缓存的页面中，或者您不介意缓存的页面中，然后将该页面加载到`iframe`您的 index.php 页面中。

# ruby-on-rails - simple_form 集合标签

> ID：10728461
> 
> 赞同：15
> 
> 时间：2012-05-23T21:57:02.483
> 
> 标签：ruby-on-rails, ruby-on-rails-3, simple-form

我想为收藏项使用标签（例如，他们的翻译）。

```
= simple_form_for(@client) do |f|
  = f.error_notification
    .form-inputs
      = f.input :name, label: t('client.name')
      = f.input :level, collection: ['a', 'b', 'c'],
        label_method: ????
        label: t('client.level')
    .form-actions
      = f.button :submit, value: t('client.submit') 
```

我想弄清楚，`label_method`上面用什么。我想让 label_method 映射到翻译，如`map {|s| t("client.#{s}")}`.

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-24T02:33:02.863

如果你还没有标签方法，你可以传递一个 lambda 来得到你想要的结果

```
label_method: ->(obj){ t("client.#{obj}") } 
```

# objective-c - 计算两个界限之间值的百分比的方法

> ID：10728464
> 
> 赞同：3
> 
> 时间：2012-05-23T21:57:15.707
> 
> 标签：objective-c, ios, c

我有以下计算：

```
float value = MY_VALUE;

float percentage = (value - MIN)/(MAX - MIN);
if (percentage < 0)
   percentage = 0;
if (percentage > 1)
   percentage = 1 
```

我只是想知道 Objective-C 或 C 中是否存在某种方法来帮助实现这一点，例如将“值”浮点数舍入到 MIN 和 MAX 边界之间的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:00:10.603

标准 C 库中没有这种方法（我不了解 Objective C）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:35:42.207

不。

另一方面，您可能应该更新代码，以防止可能的被零除：

```
float den = (value - MIN);
float num = (MAX - MIN);
float percentage;

if(den) {
  percentage = num / den;
  if (percentage < 0.0f ) {
    percentage = 0.0f;
  } else if (percentage > 1.0f) {
    percentage = 1.0f;
  } else {
    printf("Percentage: %3.2f",percentage);
  }
} else {
  percentage = 0.0f;
  printf("DIVIDE BY ZERO ERROR!");
} 
```

还有，小心。甲骨文正在就一段非常相似的代码起诉谷歌。您可能需要重新考虑公开发布它：

[http://developers.slashdot.org/story/12/05/16/1612228/judge-to-oracle-a-high-schooler-could-write-rangecheck](http://developers.slashdot.org/story/12/05/16/1612228/judge-to-oracle-a-high-schooler-could-write-rangecheck)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T18:16:54.027

如果你想在 Objective-C 语法中计算百分比，那么这是要走的路。

（我认为 Dogbert 在第 6 行弄错了（相反的））。这就是我所做的，它就像想要的那样工作..

```
- (CGFloat)calculateProgressForValue:(CGFloat)value start:(CGFloat)start end:(CGFloat)end
{    
    CGFloat diff = (value - start);
    CGFloat scope = (end - start);
    CGFloat progress;

    if(diff != 0.0) {
        progress = diff / scope;
    } else {
        progress = 0.0f;
    }

    return progress;
} 
```

而且您始终可以将其限制为不超过 0.0 或 1.0，如下所示：

```
- (CGFloat)progressConstrained {

    // example values
    CGFloat start = 80;
    CGFloat end = 160;
    CGFloat a = 100;

    // the constrain
    return MAX(0.0, MIN(1.0, [self calculateProgressForValue:a start:start end:end]))
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T18:20:46.370

如果你只是想确保一个值不高于或低于其他值，你应该使用 MAX(a, b) 和 MIN(a, b)...

```
float maxValue = 1.0;
float minValue = 0.0;
float myValue = 2.8;
float myValueConstrained = MAX(minValue, MIN(maxValue, myValue)); // 1.0 
```

MIN(a,b) 取 a 和 b 中的最小值

MAX(a,b) 取 a 和 b 中的最大值

* * *

我通常只是这样做：

```
float myValueConstrained = MAX(0.0, MIN(1.0, myValue)); 
```

# sql - 如何在 SQL 中计算比率并满足除以零的要求

> ID：10728467
> 
> 赞同：1
> 
> 时间：2012-05-23T21:57:22.777
> 
> 标签：sql, tsql, null

我需要从下面的数据集中生成一份报告。该报告应该每天显示 P、U、D、F 和 M 列的总和，以及一个比率：M / P+U 的聚合形式。

我在比例上有问题。我不确定如何满足除以零的要求。

```
TYP | TIMESTAMP               | P   | U   | D   | F  | M
------------------------------------------------------------
L   | 2012-04-27 15:47:02.000 | 0   | 949 | 0   | 0  | 949
L   | 2012-04-27 15:48:18.000 | 0   | 949 | 0   | 0  | 949
L   | 2012-04-30 17:15:01.000 | 0   | 0   | 4051| 0  | 0
L   | 2012-04-30 17:44:44.000 | 0   | 984 | 5   | 0  | 986
L   | 2012-05-02 11:12:01.000 | 2117| 0   | 0   | 0  | 0
L   | 2012-05-02 11:12:09.000 | 149 | 4   | 210 | 0  | 157
L   | 2012-05-02 11:12:11.000 | 77  | 0   | 30  | 0  | 43 
```

我的查询：

```
SELECT
CONVERT(date,TIMESTAMP,112) As 'DAY',
SUM(P) As PAS,
SUM(U) As UFR,
SUM(D) As DES,
SUM(F) As FIR,
SUM(M) As MOL,
[M%] = ISNULL( (SUM(M) / NULLIF( SUM(P)+SUM(U), 0 ) )*100, 0),
FROM DATASET
GROUP BY CONVERT(date,TIMESTAMP,112) ORDER BY CONVERT(date,TIMESTAMP,112) DESC 
```

更新：这是报告

```
 DAY         |  PAS   | UFR   | DES   | FIR   | MOL   | M%
----------------------------------------------------------------
2012-05-02   | 2343   |  4    |  240  | 0     |  200  | 0
2012-04-30   | 0      |  984  |  4056 | 0     |  986  | 100
2012-04-27   | 0      |  1898 |  0    | 0     |  1898 | 100 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:29:26.360

问题是您没有考虑整数除法。

```
Select Cast([Timestamp] As Date) As 'Day'
  , Sum(P) As Pas
  , Sum(U) As Ufr
  , Sum(D) As Des
  , Sum(F) As Fir
  , Sum(M) As Mol
  , IsNull( (Sum(M) / NullIf( Sum(P) * 1.0000 + Sum(U), 0 ) ) *100, 0) As [M%]
From Dataset
Group By Cast([Timestamp] As Date)
Order By [Day] Desc 
```

[SQL 小提琴](http://www.sqlfiddle.com/#!3/891b0/10)版本

# linux-kernel - 为什么内核向所有其他处理器发送 tlb 无效中断，当修改的页表对于正在运行的进程而言是个人的

> ID：10728468
> 
> 赞同：2
> 
> 时间：2012-05-23T21:57:43.087
> 
> 标签：linux-kernel, kernel, tlb, multiprocessor

当一个进程的页表条目时，内核线程向所有其他处理器发出 tlb 击落中断以使其他处理器上的 tlb 无效？但是，不是这样吗，页表是特定于这个进程的，我们为什么要进行 tlb 击落呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T22:11:16.227

您的进程可能有多个线程，它们都共享同一个页表，并且它们可能在不同的处理器中执行。

# google-app-engine - 从 GWT 调用作为服务发布的 GAS 脚本

> ID：10728479
> 
> 赞同：0
> 
> 时间：2012-05-23T21:58:16.383
> 
> 标签：google-app-engine, gwt, service, google-apps-script

我创建了一个 Google Apps 脚本 doPost 脚本，我已将其作为服务发布，仅供我自己使用（如[https://developers.google.com/apps-script/guide_user_interfaces#RunDecision](https://developers.google.com/apps-script/guide_user_interfaces#RunDecision)中所述，“将脚本发布为服务”）。

我现在有一个 URL，例如 https://sites.google.com/a/macros/[google apps domain]/exec?service=[service key]

我想从 Google App Engine GWT 应用程序调用此服务，但我不知道如何使用身份验证进行管理。

如果选择“允许任何人调用此服务”然后“允许匿名访问”，那么我可以从 AppEngine 调用此服务，但就我而言，我绝对需要身份验证。

你知道如何处理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T04:00:41.660

如果您只需要在服务器之间调用此脚本并且两个端点都归您所有，则可以使用共享密钥来执行此操作，例如

应用脚本：

```
function doPost(e) {
   if(e.parameters.secret != 'mysecret') {
     return ContentService.createTextOutput("Nice try!");
   }
   // your code here
} 
```

并将其与请求一起发送。如果您只与应该提供合理安全性的“任何拥有链接的人”共享您的脚本 - 请确保您永远不会记录该请求，也不会将其包含在错误消息中；）

# c# - System.Drawing.Image.FromStream 的这种使用是否指向相同的内存？

> ID：10728480
> 
> 赞同：0
> 
> 时间：2012-05-23T21:58:26.553
> 
> 标签：c#, .net, image, activereports

我不得不修复一些非常旧的代码中的一个错误，该代码使用内存流将 Base64 字符串转换为图像。基本上，它遍历存储为 base64 字符串的图像列表并将它们转换为图像，然后使用 ActiveReports 绘制它们。

错误是一旦加载一个图像，所有后续图像都将是第一个图像的副本。

我找到了将字符串转换为图像的代码，并立即注意到它没有处理内存流。如果我将内存流包装在 using 块中，则会出现 GDI 异常。我猜这是因为图像还没有真正从内存中读取或其他什么，但我想听听是否有人猜测。提前致谢！

```
 byte[] oGraphic = null;
        try
        {
            oGraphic = Convert.FromBase64String(psGraphic);

            DataDynamics.ActiveReports.Picture oImg = new Picture();
            oImg.Top = this.Legend.Top + this.fTopFirst;
            oImg.Visible = true;
            oImg.Name = sLabelName;
            oImg.PictureAlignment = PictureAlignment.Center;

            oImg.Image = null;

            if (oGraphic != null)
            {
                var oStream = new MemoryStream(oGraphic);
                oImg.Image = System.Drawing.Image.FromStream(oStream);
                oImg.Height = Convert.ToSingle(oImg.Image.Height)/(oImg.Image.VerticalResolution);
                oImg.Width = Convert.ToSingle(oImg.Image.Width)/(oImg.Image.HorizontalResolution);
                oImg.SizeMode = SizeModes.Zoom;
                this.fGraphicHeight = oImg.Height;
                this.fGraphicWidth = oImg.Width;
                if (this.fConstantGraphic > this.fGraphicWidth)
                    oImg.Left = this.Legend.Left + this.fLeftFirst +
                                ((this.fConstantGraphic - this.fGraphicWidth)/2);
                else
                    oImg.Left = this.Legend.Left + this.fLeftFirst;

            }
            else
            {
                this.fGraphicHeight = 0f;
                this.fGraphicWidth = 0f;
            }

            this.GHMap.Controls.Add(oImg);
        }
        catch (Exception oE)
        {
            .....
        } 
```

![在此处输入图像描述](../Images/ebebd867697988a1aa1438bc27f21620.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:20:29.043

我唯一能想象的是，如果您在这里拥有的代码中缺少一行代码：

```
if (oGraphic == null) // missing line
    oGraphic = Convert.FromBase64String(psGraphic); 
```

没有理由在 try { } 块之外声明这个 byte[]。该数组被包装到 MemoryStream 中，然后再被包装到 Image 中。该图像附加到添加到图片集合中的全新图片。

什么是我们看不到的？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:44:00.537

这是另一个猜测（我将把第一个猜测留给后代）：

我不熟悉 Active Reports，但看起来您正在将 Picture 对象的 Top 和 PictureAlignment 属性设置为相同的值并添加多个图片。有没有可能它们都在那里，但一个在彼此之上？所以结果是单张图片？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T23:06:16.173

**猜猜＃3** *（其中一个会打勾，我就知道！）*

在提供的代码中一切看起来都很好，因此问题出在其他地方（尽管我仍然完全有可能错了它是好的）。

您确定每次执行此代码时 psGraphic 都不同吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T05:30:56.373

问题的原因是图片控件是单个部分上的单个控件实例。所以你只是一遍又一遍地覆盖这个单一控件上的图像。

如果您只想在此报告中看到图像，那么最好的做法是使用 ActiveReports 的 Unbound 模式并将每个图像视为另一个“记录”。[有关使用未绑定模式的示例，](http://www.datadynamics.com/Help/ActiveReports6/arWLKGroupOnUnboundFields.html)请参阅此演练（请参阅 DataInitialize 和 FetchData 事件了解内容）。

使用非绑定模式，ActiveReports 将一个接一个地渲染图像，将每个图像视为一个新记录。代码将类似于以下内容（抱歉，我目前手边没有 ActiveReports，所以我无法检查此代码，但这应该非常接近。如果您遇到任何问题，请告诉我，我会清理早上起来）：

**在 ActiveReports 的 ReportStart 事件中：**

```
DataDynamics.ActiveReports.Picture oImg = new Picture();
oImg.Top = 0;
oImg.Visible = true;
oImg.Name = sLabelName;
oImg.PictureAlignment = PictureAlignment.Center;
// setting DataField "binds" the Picture control to get it's data from the MyImageField field which we'll initialize and bind in the events below
oImg.DataField = "MyImageField";
this.Sections["Detail"].Controls.Add(oImg); 
```

**在 ActiveReports 的 DataInitialize 事件中：**

```
this.Fields.Add("MyImageField"); 
```

**在 ActiveReports FetchData 事件中：**

```
var imageBytes = Convert.FromBase64String(_imageStrings.Current); // I'm not sure where the base64 image strings come from, some I'm assuming you can put them in an enumerator field in the report like "_imageStrings" 
var imageStream = new MemoryStream(imageBytes);
var image = Image.FromStream(imageStream);
Fields["MyImageField"].Value = image;

// This tells ActiveReports if there are more records, and if it should raise the FetchData event again (allowing you to add another image).
eArgs.EOF = !_imageStrings.MoveNext(); 
```

如果您需要为每个图像调整图像控件的大小，请使用该部分的 Format 事件。您可以使用以下内容：

**在 Detail_Format 事件中：**

```
var pictureControl = this.Sections["Detail"].Controls["MyImageControl"] as DataDynamics.ActiveReports.Picture;
pictureControl.Width = Convert.ToSingle(pictureControl.Image.Width)/(pictureControl.Image.VerticalResolution);
pictureControl.Width = Convert.ToSingle(pictureControl.Image.Width)/(pictureControl.Image.HorizontalResolution); 
```

最后，ActiveReports 还将自动绑定到 IEnumerable（或 IList，我忘记了）中的一组 POCO 对象。因此，您可以简单地拥有一个具有类似“MyImage”属性的“MyImage”类，ActiveReports 会读取它并与之绑定（您不必在 DataInitialize 和 FetchData 中编写任何代码）。我认为您也可以将 MemoryStream 作为绑定放在那里，ActiveReports 会读取它，但我对此并不积极。

顺便说一句：处理 MemoryStream 时发生 GDI 异常的原因是因为 GDI 试图仅在该单个 MemoryStream 中寻找图像数据，而不是制作它的副本。因此，您需要为每个 System.Drawing.Image 实例提供一个新流（不要担心 MemoryStream 会在所有内容发布后自行清理）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T16:13:36.303

事实证明，我们创建图像的方式存在问题。添加下面的代码解决了这个问题。

```
 oImg.Image = System.Drawing.Image.FromStream(oStream);

   TO THIS

   oImg.Image = ImageFromBase64String(psGraphic);

   private Image ImageFromBase64String(string sBase64String)
        {
            using (var sStream = new MemoryStream(Convert.FromBase64String(sBase64String)))
            using (var iSourceImage = Image.FromStream(sStream))
            {
                return new Bitmap(iSourceImage);
            }
        } 
```

# ruby-on-rails - 设计 2.1 + Backbone.js 0.9.2 + Rails 3.2.0

> ID：10728492
> 
> 赞同：0
> 
> 时间：2012-05-23T21:59:27.750
> 
> 标签：ruby-on-rails, backbone.js, devise, cancan

我正在尝试使用 Backbone.js 0.9.2 + Rails 3.2.0 创建一个 webapp。我无法确定如何将身份验证和授权（角色管理）与应用程序联系起来。我想尽可能多地使用现成的产品。

经过一番研究，我认为 Devise 对用户管理非常好，但我没有看到任何关于 Devise + Backbone.js 的教程。有人有建议吗？

此外，我不断听到有关 CanCan 的消息。如果我要使用 Devise，我需要它吗？还有其他选择吗？

干杯，院长

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:16:16.790

Devise 处理身份验证，CanCan 处理授权。我不确定backbone.js 是如何发挥作用的，因为我以前从未使用过它。

万一您想知道，身份验证与登录和注销有关。授权是查看登录的用户或访客是否有权使用您的应用程序的特定资源。这就是我所读到的内容。当然，我可能会被误认为我不是这些事情的专家。

还有其他选择，但 Devise 和 CanCan 在 Rails 社区中已经很成熟： [https ://www.ruby-toolbox.com/categories/rails_authorization](https://www.ruby-toolbox.com/categories/rails_authorization)

[https://www.ruby-toolbox.com/categories/rails_authentication](https://www.ruby-toolbox.com/categories/rails_authentication)

祝你好运！

# arrays - 如何从 JDBC 结果集中获取行值数组

> ID：10728494
> 
> 赞同：1
> 
> 时间：2012-05-23T21:59:37.797
> 
> 标签：arrays, jdbc

我有一个带回以下行的 sql 语句：

![在此处输入图像描述](../Images/3844d1575bd25d991b3a8c934a8195b1.png)

我想从 JDBC 结果集中获取这些值作为两个对象。一个用于客户编号为 1 的客户，另一个用于客户 2。我希望这两个对象具有另一个数组值，其中包含对象值的相关标题。

结构最终看起来像这样（在 JSON 中）：

{客户编号：1，[“对象 1”，“对象 2”，“对象 3”]}，{客户编号：2，[“对象 4”，“对象 5”]}

我怎样才能用 JDBC 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:20:25.687

您可以使用 Map 最初以您想要的格式收集结果。

```
Map<Integer, Set<String>> customerTitles = new HashMap<Integer, Set<String>>();
while(resultSet.next()) {
    Integer custId = resultSet.getInt(1);
    Set<String> titles = customerTitles.containsKey(custId) ? 
            customerTitles.get(custId) : new HashSet<String>();
    titles.add(resultSet.getString(2));
    customerTitles.put(custId, titles);
} 
```

以这种方式收集它后，您可以遍历 Map 并依次遍历其中的 Set 并将它们转换为 JSON

```
// Convert to Json array here using your JSON library
for(Integer custId :  customerTitles.keySet()) {
    for(String title : customerTitles.get(custId)) {

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:14:15.043

我能想到的两种方法。

1.  通过查询获取`CustomerNo`第一个`SELECT DISTINCT`并将其保存在`COLLECTION`. 然后 for each （使用循环）`CustomerNo`执行`COLLECTION`a并为 each`SELECT Title from table WHERE CustomerNo = <collectionValue>`创建一个新的。`JSON Object``CustomerNo`

2.  用. `RESULTSET`_ `SELECT CustomerNo, Title FROM tablename ORDER BY CustomerNo`在`RESULTSET`将变量分配给`CustomerNo`您从中获取的获取代码（循环内）中`RESULTSET`并检查下一行。如果遇到新的`CustomerNo`则创建一个新的`JSON Object`.

# c# - LINQ：如何将复合 LINQ 结果转换为字典

> ID：10728499
> 
> 赞同：1
> 
> 时间：2012-05-23T22:00:24.367
> 
> 标签：c#, linq

我试图使用 LINQ 对将用于报告的数据进行排序。报告结构如下所示：

* * *

## 开发者名称

日期 | 小时 | 项目名称 | 周结束
日期 | 小时 | 项目名称 | 周结束
日期 | 小时 | 项目名称 | 周末结束

## 开发者名称

日期 | 小时 | 项目名称 | 周结束
日期 | 小时 | 项目名称 | 周末结束

## 开发者名称

日期 | 小时 | 项目名称 | 周结束
日期 | 小时 | 项目名称 | 周结束
日期 | 小时 | 项目名称 | 周末结束

* * *

我从 .dbml 文件中获取所有数据。对于这样的排序，我有这个 linq 查询：

```
DataClasses1DataContext context = new DataClasses1DataContext();
        System.Data.Linq.ISingleResult<s_SummaryReportResult> res = context.s_timesheet_SummaryReport(startDate, endDate);

        var orb = from c in res
                  group c by c.developer
                  into devgroup
                  select new 
                  {   
                      Dev = devgroup.Key,
                      devData = from o in res
                                      select new {
                                        o.Date,
                                        o.Hours,
                                        o.projectname,
                                        o.week_ending
                                      }};

IDictionary dic_orb = orb.ToDictionary(result => result.Dev.ToString(), result => result.devData);

        foreach (KeyValuePair<string, object> item in dic_orb)
        {
          object brr =  item.Value;
        } 
```

可悲的是，在 foreach 步骤中，我得到一个“InvalidCastException”。

关于我如何解决该 foreach 的任何线索，或者在某种意义上，如何更好地对 LINQ 查询进行分组？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:06:44.037

`dic_orb`是查询`Dictionary<string, IEnumerable<'a>>`中`'a`定义的匿名类型。该类型`KeyValuePair<string, IEnumerable<'a>>`不可转换为`KeyValuePair<string, object>`因此无效的强制转换。解决方法是在循环中声明`item`using var ：`foreach`

```
foreach (var item in dic_orb)
{
    object brr =  item.Value;
} 
```

因为`item.Value`是一个，`IEnumerable<'a>`你可以使用它来迭代它

```
var brr = item.Value;
foreach(var b in brr)
{
} 
```

如果您只想迭代所有嵌套集合，您可以使用

```
foreach(var b in dic_orb.SelectMany(kvp => kvp.Vaue))
{
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:02:31.793

你确定 result.devData 是 type`object`吗？

只是改变

```
foreach (KeyValuePair<string, object> item in dic_orb) 
```

到

```
foreach (var item in dic_orb) 
```

你应该自动获得正确的类型。否则检查什么类型`devData`并相应地更改您的 KeyValuePair。

# c# - 绑定必须是可观察的集合，为什么这不起作用？

> ID：10728501
> 
> 赞同：2
> 
> 时间：2012-05-23T22:00:37.937
> 
> 标签：c#, silverlight, windows-phone-7, data-binding

在我看到的大多数教程中，作者使用的 Windows Phone 7 的 Silverlight 应用程序中的数据绑定和可观察集合。看来我的数据在绑定后不会改变，这完全有必要吗？为什么我不能只使用列表？

每种方法的优点和缺点是什么？:)

另外，为什么下面的代码不起作用？对我来说似乎应该如此。

C# 贡献者类

```
 public class Contributor
    {
          public string Name;
          public string RSSUrl;

          public Contributor(string name, string rssURL)
          {
                  Name = name;
                  RSSUrl = rssURL;
          }
    } 
```

C# 项目绑定

```
 List<Contributor> people = new List<Contributor> { new Contributor("Danny", "www.dannybrown.com") };
        contributorsListBox.ItemsSource = people; 
```

XAML

```
<!--Panorama item two-->
        <!--Use 'Orientation="Horizontal"' to enable a panel that lays out horizontally-->
        <controls:PanoramaItem Header="contributors">
            <!--Double line list with image placeholder and text wrapping-->
            <ListBox x:Name="contributorsListBox" Margin="0,0,-12,0" ItemsSource="{Binding}">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,17">
                            <!--Replace rectangle with image-->
                            <Rectangle Height="100" Width="100" Fill="#FFE5001b" Margin="12,0,9,0"/>
                            <StackPanel Width="311">
                                <TextBlock Text="{Binding Name}" TextWrapping="Wrap" Style="{StaticResource PhoneTextExtraLargeStyle}" />
                                <TextBlock Text="{Binding RSSUrl}" TextWrapping="Wrap" Margin="12,-6,12,0" Style="{StaticResource PhoneTextSubtleStyle}"/>
                            </StackPanel>
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </controls:PanoramaItem> 
```

如您所见，每个 Item 都有一个与之关联的红色矩形。我确信绑定是有效的，因为每当我更改列表中的贡献者数量时，就会出现正确数量的红色矩形。

有人有想法么？

谢谢，丹尼。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:02:26.033

您的 Contributor 类需要具有属性，而不仅仅是公共字段。

```
public class Contributor
{
      public string Name { get; set; }
      public string RSSUrl { get; set; }

      public Contributor(string name, string rssURL)
      {
              Name = name;
              RSSUrl = rssURL;
      }
} 
```

编辑：关于您的问题，ObservableCollections 仅在您的数据将要更改的地方（即您正在添加或删除记录）才需要。您确实可以绑定到 Lists 或 IEnumerables。

# objective-c - 我应该释放一个被移除的孩子吗？

> ID：10728504
> 
> 赞同：1
> 
> 时间：2012-05-23T22:00:52.287
> 
> 标签：objective-c, ios, memory, cocos2d-iphone

```
MyClass *var = [[MyClass alloc]initWithSomeNumber:15];
[self addChild:var];
[self removeChild:var cleanup:YES]; 
```

我需要打电话`release`吗`var`？或者该`removeChild`方法是否已经解决了这些问题？有没有一种`var`无需使用即可创建的方法`alloc`？我听说有一个节点的类方法叫做`node`. 但它不接受参数（如您所见，我需要传递整数 15）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:10:52.347

如果你不使用 ARC，是的，你需要释放它。`self`当你添加它时会保留子元素，当你删除它时释放它，这仍然会从你的 alloc/init 调用中留下隐式保留。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T22:22:16.460

是的，它是[内存管理策略中定义的规则之一](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html#//apple_ref/doc/uid/20000994-BAJHFBGH)

> 您拥有您创建的任何对象

您用于`alloc`为 分配空间`var`，这会将`var`引用计数器设置为 1。无论有多少其他对象在此之后（通过发送`retain`）声称拥有所有权，您都必须继续发送`release`以`var`将引用计数器减 1。否则，引用计数器将永远不会达到0 这意味着用于的内存`var`永远不会被释放，即最终导致内存泄漏。

```
MyClass *var = [[MyClass alloc]initWithSomeNumber:15]; // ref count = 1
[self addChild:var]; // ref count ++
[self removeChild:var cleanup:YES]; //ref count--
//ref count is 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T22:04:20.867

使用 ARC 此[链接](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)将对您有所帮助

# php - 使用 PHP 文件查询表单结果，然后使用 Jquery AJAX 返回到单独的 DIV

> ID：10728505
> 
> 赞同：0
> 
> 时间：2012-05-23T22:00:56.753
> 
> 标签：php, jquery, html, ajax, dynamic

我一直试图让我的表单将其结果提交到 PHP 文件，然后查询并输出结果。我的 PHP 文件使用通过标准 PHP $_GET 方法传递的变量的查询，但尝试使用 Jquery AJAX 传递我正在努力的值。任何帮助将不胜感激。这是我目前所处的位置：

HTML 文件

```
<div id="content">
  <div id="options">
    <form id="form1">
      <table>
        <tr>
          <td>Date:</td>
          <td><input name="date" type="text" id="datepicker" /></td>
        </tr>
        <tr>
          <td>Size:</td>
          <td><input name="size" type="text" /></td>
        </tr>
        <tr>
          <td colspan="2"><input name="submit" type="submit" value="Submit"/></td>
        </tr>
      </table>
    </form>
  </div>
  <div id="result"> </div>
</div> 
```

我当前尝试在页面顶部插入我的脚本，我的 PHP 文件名为 details.php。

```
<script>
$('#form1').submit(function() {
  $.ajax({
    data: $(this).serialize(),
    type: $(this).attr('GET'), 
    url: $(this).attr('details.php'),
    success: function(response) {
      $('#result').html(response); 
    }
  });
  return false; // cancel original event to prevent form submitting
});
</script> 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:05:56.487

```
$('#form1').submit(function(e) {
    e.preventDefault(); // stops form from submitting naturally
    $.ajax({
        data: $(this).serialize(),
        //type: 'GET', //'GET' is default, set to 'POST' if you want.
        url: '/details.php',
        success: function(response) {
            $('#result').html(response); 
        }
    });
}); 
```

# sql - 无法将 SQL 导入 PHPMyAdmin

> ID：10728508
> 
> 赞同：0
> 
> 时间：2012-05-23T22:01:16.237
> 
> 标签：sql, phpmyadmin

我正在尝试为某人导入一个预制网站.. 我在将一些 SQL 导入数据库时​​遇到了一些麻烦。

SQL就在这里：[http ://dl.dropbox.com/u/12992586/spca2012.sql](http://dl.dropbox.com/u/12992586/spca2012.sql)

我选择的数据库是：wwwspcabm

我正在尝试导入一个给我的 SQL 文件，我收到了这个 errorError SQL 查询：

```
CREATE TABLE IF NOT EXISTS  `adminUsers` (

 `userId` INT( 11 ) NOT NULL AUTO_INCREMENT ,
 `userFirst` VARCHAR( 50 ) NOT NULL ,
 `userLast` VARCHAR( 50 ) NOT NULL ,
 `userEmail` VARCHAR( 100 ) NOT NULL ,
 `userPassword` TINYTEXT NOT NULL ,
 `userLevel` VARCHAR( 20 ) NOT NULL ,
 `firstLogin` VARCHAR( 1 ) NOT NULL ,
PRIMARY KEY (  `userId` )
) ENGINE = MYISAM DEFAULT CHARSET = latin1 AUTO_INCREMENT =7;

MySQL said: 

#1005 - 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-06T01:25:02.657

使用 DB_College；//你的数据库名
SELECT * FROM TBL_Students; //运行你的查询。

我所做的只是在运行查询之前运行 use 语句。为我工作。

# html - 内联、无序列表项高度 100%

> ID：10728513
> 
> 赞同：1
> 
> 时间：2012-05-23T22:02:00.773
> 
> 标签：html, css, html-lists

我正在我的应用程序中构建一个内联的无序列表。此列表中的第一项应使其文本与列表顶部垂直对齐，然后应在其右侧显示一条垂直线，延伸至父`<ul>`元素的 100% 高度，如下所示，其中 1 是第一个列表项， 2 代表第二个：

```
1 | 2
  | 2
  | 2
  | 2 
```

这是我的代码的一个淡化示例，它不像上面的示例那样显示：http: [//jsfiddle.net/spryno724/hSpvr/1/](http://jsfiddle.net/spryno724/hSpvr/1/)。有人可以调整 CSS 以使线条延伸到 100% 的高度吗？

我想避免使用特定的高度，例如`120px`，因为其他列表项的高度可能会有所不同。

感谢您的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T22:08:56.543

您可以改用该属性`display: table-cell;`。

[http://jsfiddle.net/sg3s/hSpvr/6/](http://jsfiddle.net/sg3s/hSpvr/6/)

不过IE7不支持。（[http://caniuse.com/#search=table-cell](http://caniuse.com/#search=table-cell)）

如果您需要一种不同的方式，我认为没有一种方式（无论如何都不是那么优雅）。

附带说明一下，伪选择器`:first-child`在 IE7+ 中工作，因此您不需要`first`该类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:07:24.267

您需要在第一个项目上使用绝对定位，或者只在第二个项目上使用左边框。除非 ul 具有明确的宽度，否则像 'height: 100%' 这样的规则将不起作用。

# php - PHP mail() 不工作（另一个）

> ID：10728519
> 
> 赞同：1
> 
> 时间：2012-05-23T22:02:38.360
> 
> 标签：php, email, sendmail

我目前正在尝试使用 php mail() 函数，我查了很多，无法使其工作。这是代码：

```
$name=$_POST[name];

if(mail("me@mydomain.com","test"," Name: $name", "FROM: me@otherdomain.com")){
    echo "Your message was succefully sent!";
}
else{
    echo "Your message was NOT succefully sent!";

} 
```

每当我尝试运行在我的个人 Mac 上运行的脚本时，我都会收到“您的邮件已被安全发送！”，但是，检查电子邮件时，它不存在，甚至不在垃圾邮件箱中。搜索我已经在 php.ini.default 中进行了必要的配置：

```
sendmail_from = "sendmail -t -i" 
```

还在 /etc/postfix/main.cf 做了一些更改

```
myhostname = mydomain.com 
```

我在 Snow Leopard 上跑步，现在我不知道这里出了什么问题。我已经有一段时间了。提前致谢

PS：对不起，如果我在这个问题上做错了，stackoverflow 上的新内容

# c++ - 如何查找 CPU 在地址别名中使用的位数？

> ID：10728521
> 
> 赞同：1
> 
> 时间：2012-05-23T22:02:43.567
> 
> 标签：c++, performance, memory-access

我指的是这个问题和投票最多的答案：-

[为什么在单独的循环中元素加法比在组合循环中快得多？](https://stackoverflow.com/questions/8547778/why-is-one-loop-so-much-slower-than-two-loops)

我的问题是，是否有一种简单的方法可以确定特定 cpu 用于加载/存储的地址别名的位数（称为 N）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:16:07.117

在操作系统级别：没有。我不知道有任何标准操作系统 API（包括 Linux 或 Win32 中的任何东西）可以让您对 CPU 缓存有任何用户空间可见性。

但是，英特尔为低级性能分析和优化提供了一些*出色的工具。*例如，

*   英特尔性能计数器： http: [//software.intel.com/en-us/articles/intel-performance-counter-monitor/](http://software.intel.com/en-us/articles/intel-performance-counter-monitor/)

# z-index - IE中的z-index问题与下拉

> ID：10728522
> 
> 赞同：0
> 
> 时间：2012-05-23T22:02:46.673
> 
> 标签：z-index

我知道这应该很容易解决，只需给下拉菜单一个高 z-index。我给它的索引是 300，它仍然出现在 nivo 滑块下方。我给 nivo 容器的索引为 1。我看到它在 IE7 中以这种方式出现，尽管我的客户发誓他也在 IE8 和 IE9 中看到它。

我尝试添加“位置：相对”，但这似乎没有多大帮助。

我的网址：[http](http://bit.ly/LF02cf) ://bit.ly/LF02cf （致编辑：请留下 bit.ly 链接，我不希望将目标链接编入索引，谢谢）

有任何想法吗？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:33:50.890

我真的试图找到问题，但没有运气。我建议您做的是将此元添加到您的网站：

```
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

重要的是，此元数据位于 head 标签之后。即使使用调试工具模式，这也会阻止 IE8 和 IE9 进入 IE7 兼容模式。

# asp.net-mvc-3 - 现有 MVC 项目和添加 Telerik MVC 的困难

> ID：10728523
> 
> 赞同：1
> 
> 时间：2012-05-23T22:02:47.700
> 
> 标签：asp.net-mvc-3, view, model, controller, telerik-mvc

我对 MVC3 相当陌生，正在用它构建一个 SQL 2008 R2、EF4 网站。在过去的 36 小时里，我尝试将 Telerik 的 MVC 扩展添加到项目中，以期使用 DatePicker、Menu 等。我相信我的配置和安装都很好，我还做了一些小测试（面板栏示例） '已经完成似乎证实了这一点，我对 _layout.cshtml 文件的编辑似乎也很好。

我被困的地方是尝试将 Datepicker ( [http://demos.telerik.com/aspnet-mvc/razor/datepicker](http://demos.telerik.com/aspnet-mvc/razor/datepicker) ) 的 Razor 代码示例集成到我现有的项目中。我想在我的应用程序配置文件页面中的“出生日期”(DOB) 字段中添加一个 Datepicker。Profile 在数据库中有一个表、一个模型 (profile.cs)、一个控制器 (ProfileController.cs) 和 Views/Profile 目录中的一些视图（索引、编辑等）所有示例似乎都专注于创建全新的项目、新的模型、新的控制器等，由于我相对缺乏经验，我对如何使用现有项目中概述的演示代码有些困惑。

我假设我可以将这个部分类放入我的 ProfileController 中。

```
public partial class DatePickerController : Controller
{
    public ActionResult FirstLook(FirstLookModelView viewModel)
    {
        viewModel.DatePickerAttributes.SelectedDate = viewModel.DatePickerAttributes.SelectedDate ?? DateTime.Today;
        viewModel.DatePickerAttributes.MinDate = viewModel.DatePickerAttributes.MinDate ?? new DateTime(1900, 1, 1);
        viewModel.DatePickerAttributes.MaxDate = viewModel.DatePickerAttributes.MaxDate ?? new DateTime(2099,
            12, 31);
        viewModel.DatePickerAttributes.ShowButton = viewModel.DatePickerAttributes.ShowButton ?? true;
        viewModel.DatePickerAttributes.OpenOnFocus = viewModel.DatePickerAttributes.OpenOnFocus ?? false;
        return View(viewModel);
    }
} 
```

而且我可以将 View 元素放入我的 Edit.cshtml 我的 @Html.EditorFor(model => model.DOB) 现在所在的位置

```
@(Html.Telerik().DatePicker()
        .Name("DatePicker")
        .HtmlAttributes(new { id = "DatePicker_wrapper" })
        .Min(Model.DatePickerAttributes.MinDate.Value)
        .Max(Model.DatePickerAttributes.MaxDate.Value)
        .ShowButton(Model.DatePickerAttributes.ShowButton.Value)
        .Value(Model.DatePickerAttributes.SelectedDate.Value)
)

@using (Html.Configurator("The date picker should...")
              .PostTo("FirstLook", "DatePicker")
              .Begin())
   { 
    <ul>
        <li>
            @Html.CheckBox("DatePickerAttributes.ShowButton", Model.DatePickerAttributes.ShowButton.Value)
            <label for="DatePickerAttributes_ShowButton">show a popup button</label>
        </li>
   <snip> 
```

但是我对将模型的代码部分放在哪里感到相当困惑......

```
public class FirstLookModelView
{
    public FirstLookModelView()
    {
        DatePickerAttributes = new DatePickerAttributes();
    }
    public DatePickerAttributes DatePickerAttributes { get; set; }
} 
```

这会进入我当前的模型 Profile.cs 吗？任何指导将不胜感激。

PS 我也在 Telerik 论坛上问：[http ://www.telerik.com/community/forums/aspnet-mvc/documentation/difficulty-with-existing-project-and-adding-telerik-mvc-to-它.aspx](http://www.telerik.com/community/forums/aspnet-mvc/documentation/difficulty-with-existing-project-and-adding-telerik-mvc-to-it.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T21:06:06.663

感谢我的一位好朋友帮助我，以及 Telerik 的一些支持，我得到了答案。可能只是我，或者他们的 MVC 支持示例实际上令人困惑。任何第一次尝试使用 Telerik 的 MVC 的人，即 MVC 新手，我希望这对你有所帮助。

我将假设您已经按照教程设置 Telerik MVC 以在您的项目中工作，并且现在是我，第一次努力实现他们的工具之一。

第一步，不要将此处的代码示例 (http://demos.telerik.com/aspnet-mvc/razor/datepicker) 像“view”“controller”和“_layout.cshtml”作为您需要的最终代码实施。单击“编辑模板”（至少对于此 DatePicker 示例），您将在 Razor 示例中看到更多代码：http: [//demos.telerik.com/aspnet-mvc/razor/datepicker/edittemplate](http://demos.telerik.com/aspnet-mvc/razor/datepicker/edittemplate)

您必须将我的示例调整为您的实际代码，但我将坚持使用我在原始问题中发布的示例代码。在您的模型（Profile.cs）文件中，修改 datetime 字段：

```
 [UIHint("MyCustomEditorTemplate")]
    public Nullable<System.DateTime> DOB { get; set; } 
```

提示：在模型文件顶部的 Using 中，添加以下内容：

```
 using System.ComponentModel.DataAnnotations; 
```

我对公共部分类 DatePickerController 的问题的代码片段：控制器和公共类 FireLookModelView 进入 ProfileController （或者更确切地说，你的控制器。）

现在创建一个新的控制器，名为 DatePickerController.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace MySite.Controllers
{
public class DatePickerController : Controller
{

}
public class DatePickerAttributes
{
    public DateTime? SelectedDate
    {
        get;
        set;
    }

    public DateTime? MinDate
    {
        get;
        set;
    }

    public DateTime? MaxDate
    {
        get;
        set;
    }

    public bool? ShowButton
    {
        get;
        set;
    }

    public bool? OpenOnFocus
    {
        get;
        set;
    }
}

public class TimePickerAttributes
{
    public DateTime? SelectedDate
    {
        get;
        set;
    }

    public DateTime? MinTime
    {
        get;
        set;
    }

    public DateTime? MaxTime
    {
        get;
        set;
    }

    public bool? ShowButton
    {
        get;
        set;
    }

    public int? Interval
    {
        get;
        set;
    }

    public bool? OpenOnFocus
    {
        get;
        set;
    }
}

public class DateTimePickerAttributes
{
    public DateTime? SelectedDate
    {
        get;
        set;
    }

    public DateTime? MinDate
    {
        get;
        set;
    }

    public DateTime? MaxDate
    {
        get;
        set;
    }

    public int? Interval
    {
        get;
        set;
    }
}
} 
```

在您的视图下，在 Shared 目录中，创建一个名为 EditorTemplates 的新子目录。在那里创建一个空文件，命名为 DateTime.cshtml：

```
@model DateTime?

@(Html.Telerik().DateTimePicker()
    .Name(ViewData.TemplateInfo.GetFullHtmlFieldName(string.Empty))
    .HtmlAttributes(new { id = ViewData.TemplateInfo.GetFullHtmlFieldName(string.Empty) + "_wrapper" })
    .Value(Model > DateTime.MinValue? Model : DateTime.Today)
) 
```

现在转到您希望日期选择器出现的页面，在我的例子中是：Views/Profile/Edit.cshtml：

将 HTML.EditorFor 替换为：

```
@Html.Telerik().DatePickerFor(model => model.DOB) 
```

..这些实际上是您需要（我相信）使用 Telerik MVC 设置您的第一个实际工作工具的所有部分。希望这对找到这个的人有所帮助！

埃德

# python - python中的前缀匹配

> ID：10728524
> 
> 赞同：7
> 
> 时间：2012-05-23T22:02:55.693
> 
> 标签：python

我有一个像这样的字符串：

```
" This is such an nice artwork" 
```

我有一个 tag_list`["art","paint"]`

基本上，我想编写一个函数，它接受这个字符串和 taglist 作为输入并返回“艺术品”这个词，因为艺术品包含 taglist 中的艺术字。

我如何最有效地做到这一点？

我希望这在速度方面是有效的

```
 def prefix_match(string, taglist):
        # do something here
     return word_in string 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T22:07:55.700

尝试以下操作：

```
def prefix_match(sentence, taglist):
    taglist = tuple(taglist)
    for word in sentence.split():
        if word.startswith(taglist):
            return word 
```

这是可行的，因为[`str.startswith()`](http://docs.python.org/library/stdtypes.html#str.startswith)可以接受前缀元组作为参数。

请注意，我重命名为`string`，`sentence`因此字符串模块没有任何歧义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T22:10:49.303

试试这个：

```
def prefix_match(s, taglist):
    words = s.split()
    return [w for t in taglist for w in words if w.startswith(t)]

s = "This is such an nice artwork"
taglist = ["art", "paint"]
prefix_match(s, taglist) 
```

上面将返回一个列表，其中包含字符串中与标签列表中的前缀匹配的所有单词。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T22:50:58.873

这是一个可能的解决方案。我正在使用`regex`，因为我可以通过这种方式轻松摆脱标点符号。`collections.Counter`另外，如果您的字符串有很多重复的单词，我使用它可能会提高效率。

```
tag_list =  ["art","paint"]

s = "This is such an nice artwork, very nice artwork. This is the best painting I've ever seen"

from collections import Counter
import re

words = re.findall(r'(\w+)', s)

dicto = Counter(words)

def found(s, tag):
    return s.startswith(tag)

words_found = []

for tag in tag_list:
    for k,v in dicto.iteritems():
        if found(k, tag):
            words_found.append((k,v)) 
```

最后一部分可以通过列表理解来完成：

```
words_found = [[(k,v) for k,v in dicto.iteritems() if found(k,tag)] for tag in tag_list] 
```

结果：

```
>>> words_found
[('artwork', 2), ('painting', 1)] 
```

# c# - 使用 OOP 继承，如何在“子”类中保持较低的参数量

> ID：10728526
> 
> 赞同：2
> 
> 时间：2012-05-23T22:03:02.303
> 
> 标签：c#, oop

因此，对于继承，我总是发现自己在处理最具体的类中极长的构造函数。我正在寻找一种可以避免这个问题的范例或方法。我曾想过使用工厂，但如果我这样做了，我仍然必须使用工厂中的构造函数。不管这种想法，我能做些什么来降低构造函数参数的长度吗？

例如：

```
abstract class DrawableComponent : Component, ITransformable, IScalable, IDrawable, IRotatable 
```

是一个带有构造函数的子类

```
DrawableComponent(string Name, int SizeX, int SizeY, int X, int Y, float Rotation) : base(Name) { ... } 
```

现在让我们说我想做一个孩子。事情变得更加复杂和丑陋。

```
class TextBoxComponent : DrawableComponent, IRenderable 
```

构造函数现在变得非常长：

```
public TextBoxComponent(
    IDrawableUnit Background,
    IDrawableUnit Text,
    string Name,
    int X,
    int Y,
    int SX,
    int SY)
: base(Name, SX,SY,X,Y,0.0f)
{
    this.Background = Background;
    this.Foreground = Foreground;
} 
```

* * *

总之，我厌倦了这样的事情：

```
class Blah {Blah(blah)}
class childBlah : Blah {childBlah(blah,blahs,blaha) : base (blah)}
class grandChildBlah : childBlah {grandChildBlah(blah, blahs, blaha, blaht, blauh) : base(blah,blahs,blaha) } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T22:06:58.627

如果你有很长的构造函数参数列表，那么你必须在一个类中有很多字段？这表明您应该考虑将这些类拆分为多个类，或者将相关字段组提取到它们自己的类型中。

例如，x 和 y 坐标字段或宽度和高度值：

```
private double mX;
private double mY;
private double mWidth;
private double mHeight; 
```

实际上应该是一个点或向量或矩形对象：

```
private vector mPosition;
private vector mSize;

// or

private rectangle mRegion; 
```

另一个建议可能是减少您的继承，而是使用组合。代替**is-a**关系，使用**has-a**关系：

然后，您的“废话”示例将变为：

```
class Blah
{
   Blah(int blah) { ... }
}

class ChildBlah
{
   Blah mBlah;
   ...
   ChildBlah(Blah blah, int blahs, int blaha)
   { mBlah = blah; ... }
}

class GrandChildBlah
{
   ChildBlah mChildBlah;
   ...
   GrandChildBlah(ChildBlah blah, int blaht, int blahu)
   { mChildBlah = blah; ... }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T22:06:38.220

是的，您可以使用 Builder 模式。至少，这会将对构造函数的调用限制为一个类。例如：

```
VehicleBuilder builder = new VehicleBuilder();
builder.setColor( Color.Green );
builder.setEngineSize( EngineSize.Size1500 );
builder.setWheelSize( 14 );
Vehicle auto = builder.makeVehicle(); 
```

另一种可能性是将其中一些参数划分为类。即使您正在创建一个不可变对象，如果您制作防御性副本，它也可以提供可变参数。

```
VehicleParameters parameters = new VehicleParameters();
parameters.setColor( Color.Green );
parameters.setEngineSize( EngineSize.Size1500 );
parameters.setWheelSize( 14 );
Vehicle auto = new Vehicle( parameters ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T22:23:01.527

你可以做几件事。构造[函数链接](http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/e15be817-42d2-4600-82e6-46d5081858b7/)或[可选参数](http://msdn.microsoft.com/en-us/library/dd264739.aspx)。

构造函数链接本质上意味着您有一个默认构造函数，然后为每个附加参数或根据需要多一个构造函数。

像这样：

```
class Class1
{
    private string name, jobTitle, address;

    public Class1(string name, string title) 
        : this(name, title, "my default address") {}

    public Class1(string name, string jobTitle, string address)
    {
        this.name = name;
        this.jobTitle = jobTitle;
        this.address = address;
    }
} 
```

另一个选项是可选参数，如下所示：

```
class Class1
{
    private string name, jobTitle, address;

    public Class1(string name = "default", string jobTitle = "defaultJob", string address = "defaultAddress")
    {
        this.name = name;
        this.jobTitle = jobTitle;
        this.address = address;
    }
} 
```

请记住，必需参数必须始终位于可选参数之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T23:07:53.113

您可以通过传入包含您感兴趣的属性的键值对字典来减轻痛苦。为了更好的可读性和语法，该字典可以从匿名类构建，就像 ASP.NET MVC 之类的库一样它用于很多方法调用。

然后，您将在每个级别有两个构造函数：一个接受字典的受保护构造函数和一个接受匿名对象的公共构造函数，它本身总是会调用受保护构造函数，并将匿名对象转换为字典。

```
public class Class1 {
  public Class1(object args): this(new RouteValueDictionary(args)) {}

  protected Class1(RouteValueDictionary args) {
    // retrieve any property you need here from args
  }
}

public class Class2: Class1 {
  public Class2(object args): this(new RouteValueDictionary(args)) {}

  protected Class2(RouteValueDictionary args): base(args) {
    // retrieve any property specific to Class2 from args
  }
}

// etc. 
```

像这样使用：

```
new Class2(new {
    X: 10,
    Y: 20,
    Name: "instance"
  }); 
```

优点是无论传入多少参数，这都会为您提供一个很好的语法，并且您还可以省略参数或创建构造函数的非常动态的“重载”。这种方法的主要问题是编译器无法在编译时告诉您需要将什么传递给构造函数（例如，您失去了一些静态分析的好处）。

Note: the [`RouteValueDictionary`](http://msdn.microsoft.com/en-us/library/system.web.routing.routevaluedictionary.aspx) used here for parsing is not part of the MVC project, but of the System.Web assembly, so that it is readily available everywhere where the full .NET framework has been deployed. It does handle the anonymous type extraction efficiently, usually better than reflecting it manually yourself.

# actionscript-3 - 使用不可选择的分隔符创建组合框

> ID：10728530
> 
> 赞同：2
> 
> 时间：2012-05-23T22:03:15.847
> 
> 标签：actionscript-3, apache-flex, flex4.5, flash-builder

我想自定义组合框。确实，我喜欢创建一个组合框，其中两个数组由一条线隔开。

![在此处输入图像描述](../Images/7c7da4fa624cfe285b121167df3cc579.png)

All 和 40 以上之间的行不能选择。

你知道怎么做吗？

感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:02:35.420

假设我们有一个具有如下模型的 ComboBox：

```
<s:ComboBox>
    <s:ArrayList>
        <fx:String>A</fx:String>
        <fx:Object />
        <fx:String>B</fx:String>
    </s:ArrayList>
</s:ComboBox> 
```

Strings 是我们的常规元素，Object 代表分隔符。我在这里简化了事情，但是您应该能够将其转换为您的具体情况。

现在我们要为每种类型的元素分配一个不同的 ItemRenderer。我们可以通过`itemRendererFunction`属性来做到这一点。

```
<s:ComboBox itemRendererFunction="getItemRenderer">

private function getItemRenderer(item:*):IFactory {
    var renderer:Class = item is String ? DefaultItemRenderer : SeparatorItemRenderer
    return new ClassFactory(renderer);
} 
```

现在让我们创建`SeparatorItemRenderer`只包含一条水平线并将其`enabled`属性设置为`false`. 最后一部分非常重要，因为它会使项目不可选择。

```
<s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" 
                xmlns:s="library://ns.adobe.com/flex/spark" 
                autoDrawBackground="false" enabled="false"
                height="10" disabledAlpha="1">

    <s:Line left="0" right="0" verticalCenter="0">
        <s:stroke>
            <s:SolidColorStroke color="0xdddddd" />
        </s:stroke>
    </s:Line>

</s:ItemRenderer> 
```

那应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:32:16.130

在您的帮助下，我找到了解决方案：

```
<?xml version="1.0" encoding="utf-8"?>

<s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" 
                xmlns:s="library://ns.adobe.com/flex/spark" 
                xmlns:mx="library://ns.adobe.com/flex/mx" 
                autoDrawBackground="{(data.separator==0)?true:false}"
                disabledAlpha="1"
                enabled="{(data.separator==0)?true:false}"
                mouseEnabled="{(data.separator==0)?true:false}"
                >

    <fx:Script>
        <![CDATA[
            import spark.components.supportClasses.ListBase;

        ]]>
    </fx:Script>
    <s:states>
        <s:State name="normal"/>
        <s:State name="down"/>
        <s:State name="hovered"/>
        <s:State name="selected"/>
        <s:State name="dragging"/>
        <s:State name="normalAndShowCaret"/>
        <s:State name="hoveredAndShowCaret"/>
        <s:State name="selectedAndShowCaret"/>
    </s:states>

    <s:Group top="2" left="2" right="2" bottom="2" width="100%" height="100%" >
        <s:Line width="100%" bottom="2" visible="{(data.separator==1)?true:false}" verticalCenter="0" >
            <s:stroke>
                <s:SolidColorStroke weight="2" caps="round"/>
            </s:stroke>
        </s:Line>

        <s:Label id="labelDisplay" verticalCenter="1" horizontalCenter="0" fontWeight="normal" color="#000000"
                 visible="{(data.separator==0)?true:false}" />
    </s:Group>

</s:ItemRenderer> 
```

非常感谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T19:51:00.213

这是一个在没有 Flex 的情况下在 Flash 中工作的解决方案，以防万一有人需要（就像我一样）。首先为 CellRenderer 的自定义扩展创建一个新的类文件：

```
package { 
    import fl.controls.listClasses.CellRenderer; 
    public class MyCustomCellRenderer extends CellRenderer
    {
        // override the data setter to set the enabled flag
        override public function set data(value:Object):void
        {
            super.data = value;    
            this.enabled = !(value['disabled']);
        }
    } 
} 
```

将它保存为 MyCustomCellRenderer.as（或任何你称之为的），然后当你设置你的 ComboBox 时：

```
myComboBox.dropdown.setStyle("cellRenderer", MyCustomCellRenderer); 
myComboBox.dataProvider = new DataProvider();
myComboBox.dataProvider.addItem({label: "Normal Item"});
myComboBox.dataProvider.addItem({label: "Separator", disabled:true}); 
```

# php - PHP在正则表达式中调用'>'未知修饰符？（分隔符问题）

> ID：10728535
> 
> 赞同：1
> 
> 时间：2012-05-23T22:03:29.197
> 
> 标签：php, pcre

```
private function pageScrape( $url )
{
    $page_stream = file_get_contents( $url );
    $pattern = '/<link\s+(?=[^>]*rel="(?:[Ss]hortcut\s)?[Ii]con"\s+)(?:[^>]*href="(.+?)").*/>/';
    preg_match( $pattern, $page_stream, $matches );
    print_r( $matches );
    // echo $page_stream;
} 
```

给出错误：

> **警告：preg_match() [function.preg-match]：第****16** 行**/home/foo/public_html/foo/source/class.ControlBookmark.php**中的未知修饰符 '>'

 **关于 pcre 的 PHP.net 参考

[http://php.net/manual/en/reference.pcre.pattern.syntax.php](http://php.net/manual/en/reference.pcre.pattern.syntax.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:06:19.220

在您的正则表达式模式变量中使用正则表达式边界/分隔符，`$pattern`如下所示：

```
$pattern = '#<link\s+(?=[^>]*rel="(?:[Ss]hortcut\s)?[Ii]con"\s+)(?:[^>]*href="(.+?)").*/>#'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:11:03.770

您的问题是由于表达式末尾未转义的斜杠造成的。试试这个：

```
$pattern = '/<link\s+(?=[^>]*rel="(?:[Ss]hortcut\s)?[Ii]con"\s+)(?:[^>]*href="(.+?)").*\/>/'; 
```**

# mysql - 将相同的外键添加到表的 96 列

> ID：10728537
> 
> 赞同：1
> 
> 时间：2012-05-23T22:03:34.847
> 
> 标签：mysql

我有一个看起来像这样的表：

```
CREATE TABLE `library_mix` (
  `lib_mix_id` VARCHAR(64) NOT NULL ,
  `date` DATE NOT NULL ,
  `index1` VARCHAR(64) NULL ,
  `index2` VARCHAR(64) NULL ,
  `index3` VARCHAR(64) NULL ,
  `index4` VARCHAR(64) NULL ,
  `index5` VARCHAR(64) NULL ,
 ...
  `index96` VARCHAR(64) NULL ,
 ...
) 
```

对于 index1 到 index96 中的每一个，我想添加相同的外键约束。理想情况下，我想在编程循环中创建索引和 fk 约束，但我不清楚如何在 MySQL 中做到这一点，也没有找到任何好的例子。就像是：

```
CREATE TABLE `library_mix` (
  `lib_mix_id` VARCHAR(64) NOT NULL ,
  `date` DATE NOT NULL ,

for i = 1 to 96
  `index`$i VARCHAR(64) NULL,
end
...
for i = 1 to 96
  CONSTRAINT `fk_library_mix_lib_id`$i
  FOREIGN KEY (`lib_id` )
  REFERENCES `library` (`lib_id` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION)
end) 
```

有没有一种简单的方法可以代替输入所有内容 96 次？

**编辑**

我对下面一些评论的回答太长了，所以我在这里添加它。

*   上面的“图书馆”一词是指 DNA 片段的物理集合（在试管中）（我认为图书馆是一个可怕的术语，但我没有编造它并坚持使用它）。
*   每个文库都附有条形码（也由 DNA 制成），并与其他 DNA 文库混合（只要这些文库具有不同的条形码）
*   有 96 种可能的条形码（这里用“index1”到“index96”标识）。

所以在这张表中，我试图对特定的 DNA 文库组合进行建模。外键约束是为了确保库 id 存在于库表中。

可能有用的其他信息：

*   不同的 DNA 文库可以具有相同的条形码（因此不能混合在一起）
*   一个 DNA 文库可以在多个混合物中
*   一个 DNA 样本可以有多个 DNA 文库（具有相同或不同的条形码）

我很高兴听到比使用一列条形码更好的建模方法。

谢谢！

凯文

**编辑 2** @eggyal 在评论中的建议是处理这个问题的正确方法。（我的新手错误。）谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T08:02:09.337

我将回答您的问题，但似乎您在图书馆之间存在多对多关系，并且您没有正确解决它。Eggyal 和 Thomas 的评论非常有效。请研究如何在您的数据库中创建正确的一对多和多对一关系。这将使这个问题变得容易得多。

要轻松创建约束，您将打开与 MySQL 服务器的连接并执行以下命令：

```
SELECT  CONCAT("CONSTRAINT `fk_library_mix_lib_id`",COLUMN_NAME,"
    FOREIGN KEY (`",COLUMN_NAME,"` )
    REFERENCES `library` (`lib_id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION ") AS SQLStatement
FROM INFORMATION_SCHEMA.COLUMNS
WHERE Table_NAME ="library_mix"
AND COLUMN_NAME LIKE "index%" 
```

您可以将结果复制并粘贴到新的查询窗口中并执行。我**没有**测试生成的语法，但是您应该能够以最小的努力修改查询以创建正确的 SQL 命令字符串。我将此作为练习留给您，因为它肯定会增强您对 MySQL 数据字典的了解。基本上去阅读 MySQL 中的 INFORMATION_SCHEMA 视图，它们使这样的事情变得轻而易举。

# ruby-on-rails - 我什么时候应该在 Rails 中为多个用户角色使用多个命名空间？

> ID：10728538
> 
> 赞同：0
> 
> 时间：2012-05-23T22:03:36.817
> 
> 标签：ruby-on-rails, ruby-on-rails-3

所以我想这更像是一个概念性的问题，但我通常只是使用`Devise`&`Decl_Auth`来分别管理用户身份验证和授权并指定不同的用户角色。

这样做的缺点（或根据您的观点的优点）是在任何时候 - 在任何一个浏览器中 - 只能有一个用户会话（因为 User 是所有角色的全局命名空间）。

然而，我最近与另一位 Rails 开发人员做了一个项目，他使用`Authlogic`身份验证 - 但他更喜欢将 Admin 和 User 角色拆分为两个命名空间。在这里，用户和管理员可以在两个不同选项卡中从同一浏览器同时登录到应用程序。

这两种方法的主要优点和缺点是什么？我什么时候想要做另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:48:17.357

对于管理员和用户，你的系统中有不同的逻辑和不同的入口点，所以最好为他们有单独的命名空间，这也有点安全。

这种方法的缺点是它会使你的应用程序逻辑有点棘手，但不是那么多。

# jquery - Jquery自动完成只找到“C”

> ID：10728539
> 
> 赞同：1
> 
> 时间：2012-05-23T22:03:43.447
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

我正在处理 jquery 中的自动完成功能，似乎只能找到字母“C”。并知道为什么会发生这种情况？我使用 json 提要的另一个自动完成工作正常，但这个需要显示一个排序网格，您可以从第一列信息（形状）中进行选择。当我输入“C”时，我会得到下拉菜单，但除此之外的任何组合都不起作用。此外，如果您只是输入“L”或“A”，它应该会弹出其中一个选项，但没有这样的运气

JSON

```
[
    {
        "shape":"CLRE1 LAS",
        "eye":"50",
        "bridge":"18",
        "color":"all"
    },
    {
        "shape":"CLRE2 LAS",
        "eye":"48",
        "bridge":"18",
        "color":"all"
    },
    {
        "shape":"CLRK UOC",
        "eye":"54",
        "bridge":"18",
        "color":"all"
    },
    {
        "shape":"ABCD KCT",
        "eye":"105",
        "bridge":"25",
        "color":"all"
    }
] 
```

jQuery代码

```
$.getJSON("resources/data/frameshape.json", function(projects) 
        {

        $( "#frameShaping" ).autocomplete({
            source: projects,
            select: function( event, ui ) {
                $( "#frameShaping" ).val( ui.item.shape );
                return false;
            }
        })

        .data( "autocomplete" )._renderItem = function( ul, item ) {

            if (ul.children().length == 0){
                    ul.append( '<li class="t2"><p class="testing">Shape</p>
                    <p class="testing">Eye</p><p class="testing">Bridge</p>
                    <p class="testing">Color<p></li>' );
            }//end if

            return $( "<li></li>" )
                .data( "item.autocomplete", item )
                .append( "<a><p class='linkage'>" 
                    + item.shape + "</p><p class='linkage'>" 
                    + item.eye + " </p><p class='linkage'>" 
                    + item.bridge + "</p><p class='linkage'> " + 
                    item.color +"</p></a>" )
                .appendTo( ul );

        };
    }); 
```

HTML

```
<input id="frameShaping" size="25"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:33:24.523

自动完成需要一个包含**`label`**属性、**`value`**属性或两者的对象的数组。为了使其正常工作，您*所*要做的就是将这些属性之一添加到数组中的对象：

```
$.getJSON("resources/data/frameshape.json", function(projects) {
    $.each(projects, function (i, project) {
        project.label = project.shape;
    });

    $("#frameShaping").autocomplete({
        source: projects,
        /* other options */
    });
}); 
```

**示例： http:** [//jsfiddle.net/gUEjn/](http://jsfiddle.net/gUEjn/)（显然没有 AJAX 调用）。

* * *

另一种选择是通过该`source`选项提供您自己的过滤逻辑（如果您不想向源对象添加额外的属性，这将特别有用）。基本上，您可以提供一个接受请求对象和响应回调的函数，并在函数内部进行任何您想要的过滤：

```
$("#frameShaping").autocomplete({
    source: function (request, response) {
        /* this is also how jQueryUI builds a regex to find candidates internally */
        var matcher = new RegExp($.ui.autocomplete.escapeRegex(request.term), "i");

        response($.grep(projects, function (value) {
            return matcher.test(value.shape);
        }));
    },
    /* etc. */
}) 
```

**示例：http:** [//jsfiddle.net/P2WF9/](http://jsfiddle.net/P2WF9/)

我会推荐第二个选项，因为它不需要您在初始化小部件之前对源数组进行额外的迭代。

至于为什么它总是使用“C”的输入，它实际上适用于字符串中的任何字符：“ `[object Object]`”

这是因为[在引擎盖下](https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.autocomplete.js#L551)，jQueryUI 是：

1.  根据您输入的输入构建正则表达式（例如“C”）
2.  使用[`test`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp/test)RegEx 对象的方法（接受字符串）

现在，当您将任何内容传递给该`test`方法时，参数将`toString`根据 ECMAScript 规范使用 转换为字符串`RegExp.test`。

因此，在这种特殊情况下，当您使用其中一个对象并调用`toString`它时，您会得到`[object Object]`匹配的“C”。由于数组中的每个对象都是如此，因此如果您搜索其中任何一个字符，您实际上会返回每个项目。

**这是正在发生的事情的一个简化示例：http:** [//jsfiddle.net/ZnA2w/](http://jsfiddle.net/ZnA2w/)

# ios - 从另一个 viewController 启动 segue

> ID：10728542
> 
> 赞同：1
> 
> 时间：2012-05-23T22:04:08.517
> 
> 标签：ios, xcode, segue, uistoryboardsegue

我正在尝试从另一个 viewController 触发 segue：因此通常通过点击 TVC 上的 Cell 来触发 segue。但是第一次启动应用程序时，我需要用户设置一些配置。

我试图从 App 显示的第一个 viewController（也是一个 TVC）中触发这个 segue。所以我在 SettingsTVC（segue 所在的位置）上创建了一个公共方法。该方法的实现如下：

```
-(void)setStuff{

    [self performSegueWithIdentifier:@"setStuffFromSettings" sender:self];

} 
```

在第一个 viewController 上，单击按钮执行以下操作：

```
[self.tabBarController setSelectedIndex:4];

SettingsTVC *settings=[[SettingsTVC alloc]init];
[settings setStuff]; 
```

根据 NSLogs 方法被正确调用，但应用程序崩溃告诉我：

```
'Receiver (<SettingsTVC: 0x812d730>) has no segue with identifier 'setStuffFromSettings'' 
```

也许是我期望太高？我无法设置另一个 segue，因为它会使事情变得相当复杂，而且我不希望可以从多个地方访问 viewController（我认为 Apple 也不喜欢它）。

有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:49:42.300

您没有连接到您从其调用 performSegue 的 VC 的具有该 ID 的 segue。见下图。您的视图控制器之间的连接必须正确命名。

检查您的连接并确保名称匹配。

![转场图像](../Images/2d847ecdbc8adfbdacbc7df38549a757.png)

# iphone - 将功能分离为类，与世界对象通信（cocos2d/box2d）

> ID：10728546
> 
> 赞同：1
> 
> 时间：2012-05-23T22:04:24.300
> 
> 标签：iphone, ios, cocos2d-iphone, box2d

我的世界使用 Box2d 在我的场景中工作。基本上几个球弹跳起来，一切都很花哨。

但是，我想添加拖放球的功能。我已经可以使用 Cocos2D 中的静态精灵来实现这一点。现在使用 Box2D，而不是将代码保留在图层文件中，我想将其移动到 CCSprite 子类（所有触摸手势等）

这意味着我必须在 CCSprite 子类和我猜的 Layer 世界之间交流位置？如何做到这一点？谢谢

TLDR：您如何将层文件中的对象逻辑与外部文件分开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T08:14:20.153

有很多方法可以做你想做的事。我是这样做的：在我的游戏中，我有 gameController - NSObject 的子类。在它的`init`方法，我正在创建更多控制器：第一个 - 用于显示 Box2d 对象，第二个 - 用于显示控件。如果我的任何对象需要告诉另一个对象任何事件（例如 2 个特定 b2Bodies 之间的碰撞），它会告诉它的所有者控制器（通过指针），在它的父控制器上引发这个事件，在他的父控制器上引发它父母和他所有的孩子控制器，等等。例如：我正在点击一个节点。所有用于点击、拖动等的逻辑都在它的​​控制器类中。然后，控制该节点的控制器触发事件​​，并且所有其他控制器都知道这一点，因此他们可以对什么做 anutig，或者什么也不做。在这种情况下，我的 box2dController 收到此消息并创建/移动 b2Bodies。

# android - 安卓屏幕录像机

> ID：10728550
> 
> 赞同：3
> 
> 时间：2012-05-23T22:05:19.930
> 
> 标签：android

当我在屏幕上绘制内容并生成视频后，我正在尝试记录 android 屏幕截图。我被认为使用“for”循环来做到这一点，但是当我调用 getDrawingCache() 方法时遇到了问题。原则上它可以正常工作，但是如果我在调用“绘图缓存”时更改屏幕上的某些内容，则 android 应用程序将关闭而不会报告错误。下面是我的源代码。

```
public void run() {
        Bitmap screenshot;
        File file;
        FileOutputStream fileOutputStream;

        this.view.setDrawingCacheEnabled(true);

        for (long i = 1; record; i++) {

            screenshot = (Bitmap) Bitmap.createBitmap(view.getDrawingCache());

            file = new File(directory, "frm" + i + ".jpg");

            try {
                fileOutputStream = new FileOutputStream(file);

                screenshot.compress(CompressFormat.JPEG, 10, fileOutputStream);

                fileOutputStream.close();
                ScreenshotRecorder.sleep(50);

            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

        }
        this.view.setDrawingCacheEnabled(false);

    } 
```

我一直在寻找另一种获取安卓屏幕录像机的方法，但我还没有找到开源应用程序。如果有人知道如何获取android屏幕截图，我将不胜感激。谢谢大家。

（我使用的是 Xoom Tablet 和 android 3.0 版本）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:11:05.247

我相信你需要`view.buildDrawingCache(...)`在调用get绘图缓存之前调用，否则将没有任何东西可以获取。您可以在此处阅读相关内容[。](http://developer.android.com/reference/android/view/View.html#buildDrawingCache%28boolean%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:13:22.997

尝试：

```
view.measure(MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED),MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED));
view.layout(0, 0, view.getMeasuredWidth(), view.getMeasuredHeight());
view.buildDrawingCache(true); 
```

从我的回答[这里](https://stackoverflow.com/questions/10674570/how-to-convert-linearlayout-to-image/10675244#10675244)避免**空**图像

# xcode - 如何创建一个从设定位置弹出的 UIImageView，然后在触摸时将其隐藏，然后可以弹出下一个图像

> ID：10728567
> 
> 赞同：0
> 
> 时间：2012-05-23T22:06:40.570
> 
> 标签：xcode, cocos2d-iphone, popup

我已经尝试为此使用 Cocos2d，但我似乎无法弄清楚任何代码完全符合我的要求，因为我希望它做的非常具体。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T08:17:28.570

好吧，我将`CCSprite`用于图像，使用精灵对其进行初始化`scale = 0`和动画缩放。触摸时将其设置回 0。

展示您尝试过的内容……如果您需要更多指点，我很乐意提供帮助。

# arrays - MATLAB：“如果”数组的一部分的任何行包含一个值

> ID：10728571
> 
> 赞同：1
> 
> 时间：2012-05-23T22:07:04.890
> 
> 标签：arrays, matlab

有没有办法缩短下面代码的第 2 行？

```
for i = 1:length(dataStructure)
    if dataStructure(1,i) == 100000000 || dataStructure(2,i) == 100000000 % this line
        dataStructure(:,i) = NaN;
    end
end 
```

我原以为以下就足够了（但这不起作用）：

```
if dataStructure(:,i) == 100000000 
```

换句话说，如何检查数组的给定列中是否存在数字？这里的问题是我无法预测 dataStructure 是否会有一行或两行，因此不能使用嵌套的 for 循环，因为每次 dataStructure 只有一行时都会导致错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:09:27.120

```
if any(dataStructure(:,i) == 100000000) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T22:43:38.857

你不需要循环：

```
dataStructure(:,any(dataStructure==1e8,1) = NaN; 
```

这称为逻辑索引，更多信息：[这里](http://blogs.mathworks.com/steve/2008/01/28/logical-indexing)和[这里](http://www.mathworks.nl/company/newsletters/articles/Matrix-Indexing-in-MATLAB/matrix.html)

# ios - iOS wchar_t 的字节序是什么？

> ID：10728573
> 
> 赞同：1
> 
> 时间：2012-05-23T22:07:23.003
> 
> 标签：ios, string, cocoa, unicode, character-encoding

我是我的 iOS 5.1 应用程序，我使用`wchar_t`用于字符串的 3rd 方库。这在内部工作正常，但我有时需要`NSString`为这样的字符串创建一个。我可以使用以下 API：

```
- (id)initWithBytes:(const void *)bytes length:(NSUInteger)length encoding:(NSStringEncoding)encoding 
```

但是我应该使用什么编码？由于`wchar_t`在 iOS 中是 32 位，候选编码是：

```
NSUTF32StringEncoding
NSUTF32BigEndianStringEncoding
NSUTF32LittleEndianStringEncoding 
```

我应该使用哪个字节顺序？我应该使用与结果相对应的编码字节顺序`long NSHostByteOrder()`吗？

顺便说一句，代表哪个字节顺序`NSUTF32StringEncoding`？它会检查字节并推断字节顺序吗？*从*NSString转换时会产生什么`getBytes:maxLength:usedLength:encoding:options:range:remainingRange:`？

请注意，我不关心这里的平台之间的数据交换（尽管有一天我可能不得不面对这个问题）。

谷歌搜索并没有太大帮助。

我的预感是这是编译器定义的，例如，当我编写时，我的编译器 (CLang) 使用什么编码：

```
wchar_t *s = L"string with non ascii unicode characters such as éèüçß"; 
```

当然，编写一个小示例程序并找出答案很容易，但我想要一个不依赖于我的编译器的具体实现的解决方案。

如果你相信我很困惑，那是因为我有点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T22:51:18.027

这就是`wchar_t`无法推荐的原因，除非您需要直接使用 Windows API。

在 iOS 上，`wchar_t`是带有本机字节顺序的 UTF-32。这在*技术上*与`NSUTF32StringEncoding`表示不同，后者表示带有 BOM 的字节顺序。

这是我上次回答这个问题时的一些复制面食（[链接](https://stackoverflow.com/questions/2610871/how-to-copy-a-wchar-t-into-an-nsstring/2610989#2610989)）：

```
#include <machine/endian.h>
#if BYTE_ORDER == BIG_ENDIAN
#define WCHAR_ENCODING NSUTF32BigEndianStringEncoding
#elif BYTE_ORDER == LITTLE_ENDIAN
#define WCHAR_ENCODING NSUTF32LittleEndianStringEncoding
#endif 
```

**使用**的问题**`NSUTF32StringEncoding`是它只适用于转换`wchar_t`为`NSString`，但不一定反过来。它会将 BOM 贴在前面（不受欢迎），甚至可能以错误的字节序为您提供数据。**

 **`NSUTF32StringEncoding`即使从`wchar_t`到， using 也可能会导致错误`NSString`，但这是极不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:36:25.397

正如已经指出的，假设 wchar_t* 字符串是 UTF-32 编码的并不安全。

如果您对此非常关心并希望它尽可能健壮，请使用 wcstombs_l() 将 wchar_t* 字符串转换为 UTF-8 编码的 char* 字符串。使用 newlocale() 指定“UTF-8”语言环境。这将可靠地将 wchar_t* 字符串转换为 UTF-8 编码的 char* 字符串。您可以使用 mbstowcs_l() 转换回来。

一旦你有了一个 UTF-8 编码的 char*，你就应该使用 NSUTF8StringEncoding 进行 NSString 转换。是的，这是一个额外的箍。跳过它。**

# salesforce - 销售队伍从另一个网站简单登录

> ID：10728577
> 
> 赞同：1
> 
> 时间：2012-05-23T22:07:53.300
> 
> 标签：salesforce

我有一个来自客户的非常简单的请求。他们希望在他们的网站上有一个带有用户名和密码的页面。他们想将他们的销售人员用户名和密码输入这个站点，检查登录，如果成功，实际上将他们重定向到已经登录的销售人员。

我可以为此做一个简单的表单发布，还是需要使用 SOAP 或 REST API？有人可以指出我正确的方向吗？我从 PHP 做这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:53:10.383

在其他地方捕获他们的凭据似乎是个坏主意。我建议使用 oAuth 进行身份验证，这样您就不需要在其他系统中捕获实际的 salesforce 凭据。

基本上他们会登录到自定义站点，如果成功，您可以使用通过 oAuth 获得的完整会话 ID 重定向到 Salesforce - 当然唯一的问题是他们必须在第一次登录时自己登录到 Salesforce，然后在那之后您可以在后台进行 Salesforce 身份验证。

# objective-c - 在类之间传递 NSMutable 数组

> ID：10728578
> 
> 赞同：0
> 
> 时间：2012-05-23T22:07:55.550
> 
> 标签：objective-c, cocos2d-iphone, nsmutablearray, pass-by-reference

我有个问题希望有人能回答。我是 Objective C 的新手，虽然其中大部分都给我带来了一点麻烦，但很明显我不明白在类之间正确传递 NSMutableArrays。以下是相关代码：

这是我想捕捉 NSMutableArray 的类

```
#import "CanBee.h"
#import "Rat.h"
@implementation CanBee
-(id) init
{
    if ((self = [super init])) {
        if([[self parent] respondsToSelector:@selector(getRatsArray)] == YES)
        {
            ratsArray = (NSMutableArray *) [[self parent] performSelector:@selector(getRatsArray)];
        }
        [self scheduleUpdate];
    }
    return self;
}

-(void) update:(ccTime)delta
{
    for (int i = 0; i <= ratsArray.count; i++) {
        NSLog(@"in rats array loop in canBee: %i",i);
        Rat * rat = [ratsArray objectAtIndex:i];
        if (abs(self.position.x - rat.position.x) < 10 && abs(self.position.y - rat.position.y) < 10) {
            [[self parent] removeChild: rat cleanup:TRUE]; //<-- this line is probably not correct, but not relevant to my question anyway, don't worry about it for this post
        }
    }
}

@end 
```

这是来自 gameLayer 类的 init 函数，我的游戏的主控制器类

```
 ratsArray = [NSMutableArray alloc];

    Rat * rat = [Rat spriteWithFile:@"rat.png"];
    [rat setPosition:ccp((4 * 53) - 25,100)];
    [rat setScale:.75];
    [self addChild:rat z:6];

    [ratsArray addObject:rat]; 
```

这是同一个控制器类中的getter函数

```
-(NSMutableArray *) getRatsArray {
    return ratsArray;
} 
```

我应该提一下，ratsArray 是控制器类中的一个全局变量，并且在捕手“CanBee”类中也是如此。

我还应该提到我真的不想传递数组的副本，而是传递指针或引用，以便我的捕获类可以与原始数组及其包含的对象进行交互。

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:28:32.277

我将只添加一个将ratsArray 作为参数的init 的替代实现，并确保为该方法提供一个有意义的名称。这样您就不需要从控制器获取它的代码行。它看起来像这样：

```
#import "CanBee.h"
#import "Rat.h"
@implementation CanBee
-(id) init
{
    if ((self = [super init])) {
    }
    return self;
}

-(id) initWithRatsArray:(NSMutableArray *)ratsArray 
{
    if ((self = [super init])) {
        ratsArray = ratsArray;
        //don't forget about proper memory management here
        [ratsArray retain]
        [self scheduleUpdate];
    }
    return self;
} 
```

然后，当您实例化 CanBee 类时，将ratsArray 作为参数传递，例如：

```
CanBee *aCanBee = [[CanBee alloc] initWithRatsArray:ratsArray]; 
```

# mysql - MULTI DELETE 中的未知表

> ID：10728581
> 
> 赞同：12
> 
> 时间：2012-05-23T22:08:12.457
> 
> 标签：mysql

此查询在 MySQL 5.1.57 中给了我一个错误，但在 5.1.53 中有效：

```
 DELETE f
    FROM table1 AS f
    JOIN table2 AS dsy
    JOIN table3 AS ds
    JOIN table4 AS dp
    JOIN table5 AS dg
    WHERE
    dsy.f1 = f.f1
    AND ds.f2 = f.f2
    AND dp.f3 = f.f3
    AND dg.f4 = f.f4
    AND dsy.school_year = 2011
    AND ds.id = 29620
    AND dp.id = 14120
    AND dg.grade_level = 5; 
```

错误是：MULTI DELETE 中的未知表 'f'

谢谢！

编辑：实际上这个查询有效，问题是我使用模式名称来声明我的表，如 schema.table1 （我将其删除以在此处发布更清晰的查询），它的模式名称中断......

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-24T07:00:07.820

试试这个查询 -

```
DELETE f
FROM table1 AS f
JOIN table2 AS dsy
  ON dsy.f1 = f.f1
JOIN table3 AS ds
  ON ds.f2 = f.f2
JOIN table4 AS dp
  ON dp.f3 = f.f3
JOIN table5 AS dg
  ON dg.f4 = f.f4
WHERE
  dsy.school_year = 2011 AND ds.id = 29620 AND dp.id = 14120 AND dg.grade_level = 5; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T23:48:37.553

您是否尝试过删除所有表别名？[这里](http://bugs.mysql.com/bug.php?id=4630)提出了一个类似的解决方案。所以以下可能有效：

```
DELETE table1
    FROM table1 
    JOIN table2 
    JOIN table3 
    JOIN table4 
    JOIN table5 
    WHERE
    table2.f1 = table1 .f1
    AND table3.f2 = table1.f2
    AND table4.f3 = table1.f3
    AND table5.f4 = table1.f4
    AND table2.school_year = 2011
    AND table3.id = 29620
    AND table4.id = 14120
    AND table5.grade_level = 5; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-29T10:00:12.733

我在删除后使用模式解决了同样的错误：

```
DELETE **`schemaX`.f**
    FROM `schemaX`.table1 AS f
    JOIN table2 AS dsy
    JOIN table3 AS ds
    JOIN table4 AS dp
    JOIN table5 AS dg
    WHERE
    dsy.f1 = f.f1
    AND ds.f2 = f.f2
    AND dp.f3 = f.f3
    AND dg.f4 = f.f4
    AND dsy.school_year = 2011
    AND ds.id = 29620
    AND dp.id = 14120
    AND dg.grade_level = 5; 
```

# objective-c - [CALayer drawInContext] 中的重影

> ID：10728593
> 
> 赞同：3
> 
> 时间：2012-05-23T22:09:31.540
> 
> 标签：objective-c, ios, core-animation, calayer, quartz-graphics

我正在使用`CALayer`带有一堆`CGContextAddCurveToPoint`调用的自定义扩展来绘制可滚动图形`[ MyCustomCALayer drawInContext]`。

我实际上并没有绘制图形的整个长度，而是在每次`UIPanGestureRecognizer`更新以反映新的水平偏移时重新绘制图层的内容。这样，我只绘制图形的可见部分，而图层的边界仅延伸到屏幕的大小。

`[ MyCustomCALayer setNeedsDisplay ]`当图形数据改变或平移偏移量改变时被调用，然后导致`[ MyCustomCALayer drawInContext]`被调用。

但是，每当我在平移过程中重绘图层时，都会出现这种奇怪的重影。一些搜索表明它可能是通过重绘图层内容调用的[隐式动画](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/AnimatingLayers.html#//apple_ref/doc/uid/TP40006085-SW7)，但我找不到明确的答案。

这是图表在静止时的样子： ![在休息](../Images/6b1aeb45e45d24498c0568f51d12dbb4.png)

这是在平移期间，重绘重绘： ![平移期间](../Images/5ba4917d7d273d93bb07a413ab2d031c.png)

当然，当我*绘制*整个图形并调整图层的`position`属性以平移时，它不是重影，但是在内存中拥有一个又大又长的位图似乎是一件坏事。

有没有人见过这种鬼影？如果它（我怀疑）是隐式动画，我该如何禁用所述动画？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-23T22:17:51.687

它可能是一个隐式动画。重绘（内容的变化）与 Core Animation 中的其他所有内容一样具有动画效果。

有很多方法可以防止这种情况发生，如果您将 CALayer 子类化以进行绘图，最好是覆盖 -[CALayer actionForKey:]，返回 nil 以更改内容：

```
- (id<CAAction>)actionForKey:(NSString *)key 
{
    if ([key isEqualToString: @"contents"]) 
    {
        return nil;
    }

    return [super actionForKey: key];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T00:27:42.843

另一种禁用隐式动画的技术是：

```
 [CATransaction setValue:(id)kCFBooleanTrue forKey:kCATransactionDisableActions]; 
```

如果禁用隐式动画不起作用，那么您可以考虑使用滚动视图并将整个内容绘制在一个大视图中，然后是该滚动视图的内容。

编辑：

我忘了提到该方法需要您在 CATransaction 块中进行修改

# objective-c - 不需要时如何摆脱 UIAppearance？

> ID：10728594
> 
> 赞同：9
> 
> 时间：2012-05-23T22:09:41.713
> 
> 标签：objective-c, ios, uinavigationbar, uiappearance

在我的 AppDelegate 中，我使用 UIAppearance 使用以下代码设置我自己的 NavigationBar：

```
[[UINavigationBar appearance] setTintColor:[UIColor blackColor]];
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"nav5.png"] forBarMetrics:UIBarMetricsDefault]; 
```

但是我的应用程序的某些视图不需要它。我怎样才能摆脱它，所以我只能在相关视图中使用 IB？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-23T22:13:16.943

您不需要使用代理。只需获取实际的导航栏，它应该看起来不同并直接在其上设置颜色。

```
[navigationBarInstance setTintColor:[UIColor blackColor]];
[navigationBarInstance setBackgroundImage:[UIImage imageNamed:@"nav5.png"] forBarMetrics:UIBarMetricsDefault]; 
```

您也可以将这两个值都设置为`nil`，您希望再次使用标准样式。（由 测试`Ben Clayton`）。

```
[navigationBarInstance setTintColor:nil];
[navigationBarInstance setBackgroundImage:nil forBarMetrics:UIBarMetricsDefault]; 
```

# macos - Mac Bash 脚本在 Do? 上失败？

> ID：10728595
> 
> 赞同：2
> 
> 时间：2012-05-23T22:09:50.007
> 
> 标签：macos, qt, bash, shell, terminal

此脚本需要在 Mac OSX 上运行。下面的脚本是构建一个 QT QRC（资源文件定义），它只不过是一个扩展名不同的 XML 文件。我已经测试了在 Mac 上的终端中隔离的每一段脚本。一切正常，但我无法让 for 循环正确执行。

该脚本应：

1.  列出当前目录下的所有文件
2.  去掉 find 产生的 ./
3.  创建正确的 XML

结果应该是这样的：

```
<RCC>
    <qresource prefix="/">
        <file>login.html</file>
        <file>start.html</file>
        <file>base/files.html</file>
    </qresource>
</RCC> 
```

这是我当前的脚本：

```
 #!/bin/bash
    #Define the File
        file="Resources.qrc"
    #Clear out the old file, we want a fresh one
        rm $file
    #Format the start of the QRC file
        echo "<RCC>" >> $file
        echo "  <qresource prefix=\"/\">" >> $file
        #Iterate through the directory structure recursively
            for f in $(find . -type f)
                do
                    #Ensure the file isn't one we want to ignore
                        if [[ $f != "*.qrc" && $f != "*.rc" && $f != "*.h" && $f != "*.sh" ]]
                        then
                            #Strip out the ./ for the proper QRC reference
                                echo "<file>$f</file>" | sed "s/.\///" >> $file
                        fi
                done
    #Close the QRC file up
        echo "  </qresource>" >> $file
        echo "</RCC>" >> $file 
```

这就是终端不断告诉我的：

```
'build-qrc.sh: line 11: syntax error near unexpected token `do
'build-qrc.sh: line 11: `           do 
```

任何时候我尝试做一个shell for循环它都会给我同样的错误。我试过半列等无济于事。有任何想法吗？谢谢。

* * *

**感谢 chepner，这是最终的脚本。它为 QT 生成一个完美的 QRC 资源文件，用于将 html 项嵌入到 webkit 驱动的应用程序中。**

```
#!/bin/bash
#Define the Resource File
file="AncestorSyncUIPlugin.qrc"
#Clear out the old file if it exists, we want a fresh one
if [ -f $file ] 
then
    rm $file
fi
# Use the -regex primary of find match files with the following
# extensions: qrc rc sh h. Use -not to negate that, so only files
# that don't match are returned. The -E flag is required for
# the regex to work properly. The list of files is stored in
# an array
target_files=( $(find -E . -type f -regex ".*\.(png|jpg|gif|css|html)$") )

# Use a compound statement to redirect the output from all the `echo`
# statements at once to the target file. No need to remove the old file,
# no need to append repeatedly.
{
    #Format the start of the QRC file
    echo "<RCC>"

    # Use single quotes to avoid the need to escape the " characters
    echo '  <qresource prefix="/">'

    # Iterate over the list of matched files
    for f in "${target_files[@]}"
    do
        # Use parameter expansion to strip "./" from the beginning
        # of each file
        echo "  <file>${f#./}</file>"
    done
    #Close the QRC file up
    echo "  </qresource>"
    echo "</RCC>"
} > $file 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T23:10:43.590

我没有看到任何语法错误，但`$f != "*.qrc"`不应该按照您的预期工作。`f`这会根据文字 string测试 的值`*.qrc`。这是您的脚本，使用各种技巧缩短了：

```
#!/bin/bash
#Define the File
file="Resources.qrc"
# Use the -regex primary of find match files with the following
# extensions: qrc rc sh h. Use -not to negate that, so only files
# that don't match are returned. The -E flag is required for
# the regex to work properly. The list of files is stored in
# an array
target_files=( $(find -E . -type f -not -regex ".*\.(q?rc|s?h)$") )

# Use a compound statement to redirect the output from all the `echo`
# statements at once to the target file. No need to remove the old file,
# no need to append repeatedly.
{
    #Format the start of the QRC file
    echo "<RCC>"

    # Use single quotes to avoid the need to escape the " characters
    echo '  <qresource prefix="/">'

    # Iterate over the list of matched files
    for f in "${target_files[@]}"
    do
        # Use parameter expansion to strip "./" from the beginning
        # of each file
        echo "    <file>${f#./}</file>"
    done
    #Close the QRC file up
    echo "  </qresource>"
    echo "</RCC>"
} > $file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-04T13:21:26.550

> 任何时候我尝试做一个shell for循环它都会给我同样的错误。我试过半列等无济于事。有任何想法吗？

我只是有同样的问题。对我来说，这似乎是由 CRLF (Windows) 行尾引起的。一旦我切换到 LF (Unix)，一切都很好。

# android - 用相机拍照后自动上传Phonegap中的照片

> ID：10728596
> 
> 赞同：3
> 
> 时间：2012-05-23T22:09:55.247
> 
> 标签：android, upload, camera, cordova

使用PhoneGap的相机和文件API我正在尝试制作它，以便当我在某个应用程序中拍照时，它会自动上传到我正在使用的服务器。

我已将这两个 API 复制到我的 index.html 文件中，我唯一更改的是在 onPhotoDataSuccess 块中添加另一个设置为等于 ImageData 的 javascript 变量 imageInfo。当我调用它时，这个 imageInfo 然后被设置为uploadPhoto 的参数。

我唯一改变的另一件事是放行： `navigator.camera.DestinationType(1);`这样输出就是`imageURI`需要`uploadPhoto`的。

我在 HTML 中的唯一代码是：

```
button onclick="capturePhoto(); uploadPhoto(imageData);">Capture Photo</button (in brackets of course) 
```

但由于某种原因，它不起作用。您在我的推理中看到的任何提示或缺陷？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T05:56:11.487

看看[FileTransfer API](http://docs.phonegap.com/en/1.0.0/phonegap_file_file.md.html#FileTransfer)将允许您将图像直接上传到文件服务器。（假设您使用的是最新的 Phonegap）

这正是你想要的。源代码取自 Phonegap 的文档：

```
// Wait for PhoneGap to load
document.addEventListener("deviceready", onDeviceReady, false);
// PhoneGap is ready
function onDeviceReady() {
  // Retrieve image file location from specified source
  navigator.camera.getPicture(uploadPhoto,
  function(message) { alert('get picture failed'); },
    { quality: 50, 
      destinationType: navigator.camera.DestinationType.FILE_URI,
    sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY }
    );
  }
  function uploadPhoto(imageURI) {
    var options = new FileUploadOptions();
    options.fileKey="file";
    options.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
    options.mimeType="image/jpeg";
    var params = new Object();
    params.value1 = "test";
    params.value2 = "param";
    options.params = params;
    var ft = new FileTransfer();
    ft.upload(imageURI, "http://some.server.com/upload.php", win, fail, options);
  }
  function win(r) {
    console.log("Code = " + r.responseCode);
    console.log("Response = " + r.response);
    console.log("Sent = " + r.bytesSent);
  }
  function fail(error) {
    alert("An error has occurred: Code = " = error.code);
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T00:47:28.543

既然Camera是事件驱动的，就不能一味地把事件串起来，寄希望于最好的结果……在`success`拍照代码的回调中，你必须调用**然后**上传图片的代码。

## 编辑

这里我使用的是成功绘制图像时返回的 URI。但这应该很简单。

```
function takePicture() {
  loadPhotoIntake();
  navigator.camera.getPicture(
    setPicture,
    function(e) {
      console.log("Error getting picture: " + e);
      document.getElementById('camera_status').innerHTML = "Error getting picture.";
    },
    { quality: 70, destinationType: navigator.camera.DestinationType.FILE_URI});
};

function setPicture(uri) {
  var c=document.getElementById('camera_image');
  var ctx = c.getContext('2d');
  var img = new Image();
  var canvasCopy = document.createElement("canvas");
  var copyContext = canvasCopy.getContext("2d");
  var maxWidth, maxHeight;
  img.onload = function(){
    // resizing code
      .....
    // draw
    ctx.drawImage(canvasCopy, 0, 0, camera_image.width, camera_image.height);
  };
  img.src = uri;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-23T23:55:26.777

看起来您可以`camera.getPicture(...)`从 PhoneGap API 使用。这将启动默认的相机应用程序，让用户拍照，完成后它将返回 base64 编码字符串的数据，或者它会给你图像文件的 uri。然后，您应该能够使用它上传到服务器。您可以在[此处](http://docs.phonegap.com/en/1.0.0/phonegap_camera_camera.md.html)`camera.getPicture`找到的文档中了解更多信息。从那篇文章来看，这似乎很简单。

我从来没有使用过PhoneGap，我在2分钟内找到了这个。

# templates - Magento - 从模板 phtml 文件访问 php 块类

> ID：10728597
> 
> 赞同：0
> 
> 时间：2012-05-23T22:09:59.930
> 
> 标签：templates, magento, methods, block, php

我遇到了一种在 phtml 文件中访问 BLOCK 类（从模块）的方法。我基本上可以使用 '$var = Mage::blahblah....' 并访问模块中的任何块文件。

我没有保存这个stmt，现在我需要再次使用它，并且找不到我需要的信息。

有谁知道该声明是什么？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:53:52.830

块类实例可以在任何地方实例化，如下所示：

```
Mage::app()->getLayout()->createBlock('core/template')->...;
//or $this->getLayout()->createBlock('core/template')->...;
//or $this->getLayout()->getBlock('block_name_loaded_in_controller_or_layout_or...'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T19:33:40.527

为了进一步 Ben 的回应，我使用了：

```
$cmsBlock = Mage::getModel('cms/block')->load($blockId)->getContent();
if($cmsBlock) {
    ...do stuff...
} 
```

检查是否存在特定的静态块时。然后可以正常回显以显示内容。

这里的主要区别在于：

```
Mage::app()->getLayout()->createBlock('cms/block')->setBlockId($blockId)->toHtml(); 
```

创建一个新块，但如果 $blockId 无效，它可能为空。第一个方法调用该特定的静态块。这里可能还有另一种方式，但这对我有用。

# c# - Visual Studio XML 注释：为 Equals、GetHashCode 等指定什么？

> ID：10728598
> 
> 赞同：1
> 
> 时间：2012-05-23T22:10:01.520
> 
> 标签：c#, .net, visual-studio-2010

我非常喜欢 Visual Studio 的 XML 注释。我想知道是否有一种特殊的方式来注释继承的基本方法，如`Equals()`和`GetHashCode()`，以便接管对象类的描述。

例如 MSDN 只是说

> 确定指定的 Object 是否等于当前的 Object。（继承自对象。）

对于所有出现的`Equals()`. 我可以对 XML 注释做同样的事情吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:29:34.310

如果您安装了自动评论工具，例如[GhostDoc (http://submain.com/products/ghostdoc.aspx)](http://submain.com/products/ghostdoc.aspx)，它们通常会从定义覆盖/实现成员的抽象类或接口中提取现有评论。

例如，在实现时`IDisposable`，GhostDoc 会生成以下注释`Dispose()`：

```
/// <summary>
/// Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources.
/// </summary> 
```

HTH。

# xml - 构建图像的 XML

> ID：10728601
> 
> 赞同：0
> 
> 时间：2012-05-23T22:10:36.513
> 
> 标签：xml, macos, image, publish

我试图找到一些容易制作图像 XML 并可能将它们发布到我的网络服务器的东西。我有 Mac OS X Lion。我通常使用 Podcast Maker 制作播客，但它不支持图像。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T08:53:18.347

为什么是图像的 XML？例如，只需将图像放在您的 ftp 上，并将确切的 url 链接到 xml 中的图像。认为这会更好。

# c# - 将单引号转换为字符串中的转义单引号

> ID：10728602
> 
> 赞同：43
> 
> 时间：2012-05-23T22:10:37.400
> 
> 标签：c#, string, replace, escaping

问这个让我很痛苦，但是，由于某种原因，我无法让它发挥作用（现在已经很晚了，是的，这是我的借口）。

假设我有这个字符串：

```
s = "John's book." 
```

使用`replace`对象字符串中的方法，我想把它变成这样：

```
s = "John\'s book." 
```

我本来希望这段代码能给我想要的东西：

```
s = s.Replace("'", "\\'") 
```

但是，这导致：

```
"John\\'s book." 
```

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-05-23T22:13:09.863

这样做是为了你不必考虑它：

```
s = s.Replace("'", @"\'"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-01-02T22:19:29.223

如果这与 MVC.NET (MVC5+) 相关，只是为了展示另一种可能的解决方案：

```
var data= JSON.parse('@Html.Raw(HttpUtility.JavaScriptStringEncode(JsonConvert.SerializeObject(Model.memberObj)))'); 
```

这使您可以转义并将数据作为 JavaScript 传递给视图。关键部分是：

```
HttpUtility.JavaScriptStringEncode 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-23T22:27:23.063

在 mysql insert 子句中使用之前，我有一个快速而肮脏的函数来转义文本，这可能会有所帮助：

```
 public static string MySqlEscape(Object usString)
    {
        if (usString is DBNull)
        {
            return "";
        }
        else
        {
            string sample = Convert.ToString(usString);
            return Regex.Replace(sample, @"[\r\n\x00\x1a\\'""]", @"\$0");
        }
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-06-30T10:39:07.947

最简单的一个是

```
Server.HtmlEncode(varYourString); 
```

# java - Java：生成多个独立 GUI 的最佳方式是什么？

> ID：10728603
> 
> 赞同：-1
> 
> 时间：2012-05-23T22:10:39.340
> 
> 标签：java, image, swing, awt

我需要显示多个图像，以便用户可以比较它们，我不确定使用什么方法。我有一个允许用户选择图像文件的应用程序，所以我有一个文件对象。我尝试使用“new”生成新的 GUI，但效果不佳。

我应该编写一个独立的应用程序（带有主程序）并使用系统调用来使用新的 JVM 启动它们吗？我是 Java 新手，刚刚接触了 AWT 和 SWING 的表面。

因此调用该类，其中 name 是任意唯一的字符串：

```
ImageWindowStub iw = new ImageWindowStub(name); 
```

这是一个简单的代码，如果连续调用则演示该问题。

```
package fireScience.airborne.image;

import java.awt.Dimension;

import javax.swing.BoxLayout;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingConstants;
import javax.swing.SwingUtilities;
import javax.swing.border.BevelBorder;

public class ImageWindowStub {

private static JFrame frame;
private static JPanel statusPanel;
private static JLabel statPixInfoLbl;

private static String theString;

public ImageWindowStub(String theString) {
    this.theString = theString;
    statusPanel = new JPanel();
    createAndShowGui();

}

private static void createAndShowGui() {
    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            frame = new JFrame(theString);
            JFrame.setDefaultLookAndFeelDecorated(true);
            frame.setResizable(true);
            frame.setSize(300, 200);
            frame.setLocation(50, 50);
            statusPanel = new JPanel();
            statusPanel.setBorder(new BevelBorder(BevelBorder.LOWERED));
            statusPanel.setPreferredSize(new Dimension(frame.getWidth(), 24));
            statusPanel.setLayout(new BoxLayout(statusPanel,
                    BoxLayout.X_AXIS));
            statPixInfoLbl = new JLabel("Status Bar");
            statPixInfoLbl.setHorizontalAlignment(SwingConstants.LEFT);
            statusPanel.add(statPixInfoLbl);
            frame.add(statusPanel);
            frame.pack();
            frame.setVisible(true);
        }

    });
}

} 
```

我的核心问题是“生成 GUI 类的多个独立实例的最佳方法是什么？”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:14:37.173

我想我找到了答案，虽然不是我想要的，但它似乎有效。我添加了一个带有字符串参数的 main：

```
public static void main(String[] args) {
    if (args.length > 0) {
        ImageWindowStub iws = new ImageWindowStub(args[0]);
    } else {
        ImageWindowStub iws = new ImageWindowStub("Testing: No arg passed");
    }
} 
```

然后我导出了一个可执行的 jar 文件并创建了一个实例：

```
 Process p;
            try {
                p = Runtime.getRuntime().exec(command);
            } catch (IOException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            } 
```

其中“command”是一个字符串，其中包含可执行 jar 的完全限定路径名加上参数。

到目前为止，我似乎可以创建多个实例来丢弃先前的 p 值。当调用程序退出时，显示的帧不会退出，但似乎可以实现此行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T16:54:15.120

我猜你想要的是[内部框架](http://docs.oracle.com/javase/tutorial/uiswing/components/internalframe.html)。每个内部框架都有一个 main `JPanel`，其中包含一个`JLabel`持有`ImageIcon`.

您可以平铺或覆盖内部框架，具体取决于您要显示的内容。

# c# - 具有多表连接查询的 C# datagridview

> ID：10728604
> 
> 赞同：0
> 
> 时间：2012-05-23T22:10:42.543
> 
> 标签：c#, mysql

我有一个关于如何在 C# 中使用带有 mySql 数据源的 JOIN 查询时将数据绑定到 datagridview 的问题，我从第一个表返回一个唯一记录，从第二个表返回 0-2 条记录。我的查询如下：

```
SELECT t1.*, t2.org_id, t2.org_name 
FROM test.tbl_user_accounts AS t1 
INNER JOIN test.tbl_organizations AS t2 
ON t1.affiliation_one = t2.org_id OR t1.affiliation_two = t2.org_id; 
```

这是一个学校协会，一个用户最多可以与两所学校相关联。我希望学校显示在单独的单元格中，因此 GROUP_CONCAT 并不是一个好的选择，如果我在 t1.user_id 字段上使用 GROUP BY ，那么我将失去第二个从属关系。如果我不分组，我最终会为同一用户提供两行。

我对连接不是很熟悉，所以不同类型的连接可能会解决这个问题？

我正在使用带有 mySql 数据源的 Visual C# 2010。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T18:01:41.903

这是我用来解决这个问题的查询（我想我实际上是在另一个堆栈帖子中找到的）。

```
SELECT test.tbl_user_accounts.*, t2.org_name as affil_one, t3.org_name as affil_two,t4.rank_name as rank_name
FROM test.tbl_user_accounts 
LEFT JOIN (test.tbl_organizations as t2) ON (t2.org_id = test.tbl_user_accounts.affiliation_one)
LEFT JOIN (test.tbl_organizations as t3) ON (t3.org_id = test.tbl_user_accounts.affiliation_two)
LEFT JOIN (test.tbl_ranks as t4) ON (t4.id_rank = test.tbl_user_accounts.user_rank); 
```

# python - 为什么不将 __init__ 分配给超类的 __init__？

> ID：10728605
> 
> 赞同：4
> 
> 时间：2012-05-23T22:10:45.543
> 
> 标签：python

为什么我在 Python 代码中看不到以下内容？

```
class A:
    def __init__(self, ...):
        # something important

class B(A):
    __init__ = A.__init__ 
```

它似乎适用于我使用 Python 2.5、2.6、2.7 和 PyPy 1.8 的机器。

相反，我看到以下内容：

```
class B(A):
    def __init__(self, *args, **kwargs):
        A.__init__(self, *args, **kwargs) 
```

或使用`super`.

我更喜欢我的第一个示例（显式优于隐式！）但我担心由于某种原因它不符合犹太教规。它有什么问题或坏处吗？

编辑：是的，我的意思是`A.__init__`，不是`self.__init__`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T22:19:40.563

当然，它会起作用（假设你做对了，这不是你的例子），但没有理由这样做。如果您想`B`调用`A`'s `__init__()`，请不要定义`__init__()`on `B`，这将自动发生。毕竟，这就是继承的全部意义。

您想要编写`__init__()`for的唯一原因是*，除了初始化实例之外，*`B`您还想在初始化`B`实例时做一些事情。在这种情况下，除了调用之外，您还需要编写额外的代码，因此简单的赋值也不适合那里。*`A``A.__init__()`*

 *我想如果你想保护`B`'`__init__()`不被猴子补丁更改为`A`. 但这似乎是一个边缘案例。更糟糕的是，这是出乎意料的行为，是对 Python 动态特性的公然否认。*

# visual-studio - 如何在 Visual Studio 2010 中创建静态库？

> ID：10728608
> 
> 赞同：0
> 
> 时间：2012-05-23T22:10:49.757
> 
> 标签：visual-studio, static-libraries

我最近正在研究一个静态库。这是我第一次创建一个库。有些东西我不明白。从“新建项目”->“w32 控制台应用程序”-> 检查 DLL 并清空项目。然后我添加了一些c文件。然后点击最后的构建。该库已成功编译。但是当我尝试检查库中的函数时，我什么也没得到。我试过了：

```
dumpbin Libxc_2.lib /EXPORT 
```

我有

```
Dump of file Libxc_2.lib
File Type: LIBRARY 
```

我认为 dumpbin 命令可用于显示带有 /EXPORT 的库中的函数列表。

我对 kernel32.lib 做了同样的事情，然后我有很多函数名，如下所示：

```
File Type: LIBRARY

 Exports

   ordinal    name

              @InterlockedPushListSList@16
              _AcquireSRWLockExclusive@4
              _AcquireSRWLockShared@4
              _ActivateActCtx@8 
```

所以我不明白：1.为什么我编译的库中没有函数名？2.我在源代码中添加了一些.c文件可以吗？

# android - Android 屏幕上的 TextView 对象和截断（针对多个屏幕设计）

> ID：10728612
> 
> 赞同：2
> 
> 时间：2012-05-23T22:10:55.923
> 
> 标签：android, android-layout, android-widget

这是一个关于如何最好地处理文本截断的简短问题。你知道当它被 TextView 截断时向用户显示完整字符串的好方法吗？

任何大小的屏幕都可能会截断 TextView 中设置的长字符串的文本。当应用程序支持多种尺寸，特别是普通和大尺寸屏幕时，这个问题变得更加明显。

一个好的建议是使文本视图可滚动。我对这个建议的问题是我计划在所有四个方向上滑动导航交互，这使文本视图滚动变得复杂。我今天在 Android 办公时间提出了这个问题。欢迎提出任何建议，尤其是基于现有解决方案的建议。提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:40:12.880

有一个完美的指导方针，建议将文本大小调整为相应的屏幕大小。[在这里](http://developer.android.com/design/style/typography.html)你可以找到它。

还有一些属性可以用于文本视图；

*   小的

> ```
> <TextView
> android:id="@+id/textView1"
> android:layout_width="wrap_content"
> android:layout_height="wrap_content"
> android:text="Small Text"
> android:textAppearance="?android:attr/textAppearanceSmall" /> 
> ```

*   中等的

> ```
> <TextView
> android:id="@+id/textView1"
> android:layout_width="wrap_content"
> android:layout_height="wrap_content"
> android:text="Medium Text"
> android:textAppearance="?android:attr/textAppearanceMedium" /> 
> ```

*   大的

> ```
> <TextView
> android:id="@+id/textView2"
> android:layout_width="wrap_content"
> android:layout_height="wrap_content"
> android:text="Large Text"
> android:textAppearance="?android:attr/textAppearanceLarge" /> 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:08:23.017

您可以使用它来截断您的文本：

```
<TextView
android:id="@+id/textView1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text="This is your text"
android:ellipsize="marquee" android:lines="1 /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T19:32:54.150

解决问题的一种方法是向 textview 添加一个属性，使其无需添加代码即可滚动：

```
android:lines="3"
android:textIsSelectable="true" 
android:fadeScrollbars="false" 
```

这是 Android Dev Relations 团队的一名成员在办公时间提出的建议。但是，在测试时，滚动无法在 Android 版本 2.2.2 上运行。我的新解决方案是声明 textview 可点击并使用 onClick 回调打开一个对话框。

所以现在我省略了文本（不再有滚动标签），让用户清楚地表明文本被截断了。这是xml：

```
android:lines="3"
android:clickable="true"
android:onClick="showDef"
android:ellipsize="start"
android:isScrollContainer="false" 
```

这是 showDef 方法：

```
public void showDef(View v) {
    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setMessage("same text as was set in the text view")
        .setCancelable(false)
        .setNegativeButton("Clear", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int id) {
                dialog.cancel();
           }
        });

AlertDialog alert = builder.create();
alert.show() 
```

在包含 textview 的视图组具有固定大小的情况下，我更喜欢这个解决方案而不是简单的滚动。我希望它也对你有用。

# c# - Facebook Graph Api Feed 未返回所有帖子

> ID：10728613
> 
> 赞同：0
> 
> 时间：2012-05-23T22:10:58.677
> 
> 标签：c#, .net, facebook

例如，当我通过我的一个朋友个人资料的 Graph Api 读取“/feed”信息时，我遇到了问题。我可以获得一些帖子，但特别是共享链接和应用程序帖子图片，如 Instagram ，不是由图形 api 返回的。

相反，我可以在我测试的这个朋友的时间轴中看到所有这些。不是公共许可，因为我在时间线（Facebook 页面内）中显示。

我也试过“/post”和“/home”，同样的。

我知道 facebook 会阻止公共内容，但在这种情况下，是我的朋友个人资料，我可以在时间轴中看到所有内容，怎么在 Facebook Graph Api“/feed”返回中看不到？

PS：所有权限，linke read_stream 是由应用程序提供的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T11:15:34.043

可能是您朋友的隐私设置阻止您看到此类活动。您可以通过转到`Privacy Settings`>`Apps, games and websites`并编辑该`How people bring your info to apps they use`部分来查看您自己通过 Graph API 共享的信息。

您的朋友可能未选中该`My app activity`选项，这就是您无法在 API 中看到其他应用程序活动的原因。

# python - Google App Engine：如何在给定数量的字符后截断字符串

> ID：10728619
> 
> 赞同：1
> 
> 时间：2012-05-23T22:11:23.130
> 
> 标签：python, django, string, google-app-engine, django-templates

我在使用 Django 模板的 Google App Eninge 上。

我想在给定数量的字符后截断字符串，例如，如果一个字符串（帖子的标题）太长，“这是一个长长的长长的标题”，我想显示前几个单词，比如this：“这是长长的……”

我在这里找到了一些 Django 片段：http: [//djangosnippets.org/snippets/1259/](http://djangosnippets.org/snippets/1259/) [http://djangosnippets.org/snippets/763/](http://djangosnippets.org/snippets/763/)

我想知道：

1.  如果 Google App Engine python 中有更简单的解决方案？

2.  如何 在 App Engine 中使用此代码段[http://djangosnippets.org/snippets/1259/ ？](http://djangosnippets.org/snippets/1259/)我相信弄乱源代码不是一个好主意。

我需要在 Django 模板中截断字符串，而不是在 python 源代码中。像这样的东西：`{{ string|truncatesmart:50 }}`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:59:14.030

你找到的django片段中的函数truncatesmart是纯python，你可以在app引擎中使用它而无需更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:37:20.277

截断字符串的 Python 代码是：`string = string[:chars]`其中 string 是要修改的字符串， chars 是字符数的整数值。

您链接到的代码片段很棒，如果您正在寻找比截断 X 字符更智能的东西，则可以直接在 python 中使用@voscausa 提到的片段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T05:16:23.853

从您对问题的描述来看，这似乎是纯 CSS 已经专门解决的情况。看一下该[`text-overflow:ellipsis`](http://www.quirksmode.org/css/textoverflow.html)属性，它会截断一段文本以适合所需的宽度，并像您提到的那样放置一个尾随省略号 (...)。我希望这将是一个更简单的解决方案，您不必“重新发明轮子”。

# events - 用于清理资源的应用程序终止事件

> ID：10728620
> 
> 赞同：1
> 
> 时间：2012-05-23T22:11:23.420
> 
> 标签：events, titanium, appcelerator, exit, termination

这是交易：

我正在使用 Appcelerator Titanium 构建一个移动应用程序。它将部署到 iOS 和 Android 设备。

我使用 Titanium.Database 模块来缓存应用程序显示的传入数据。当用户按下主页按钮/关闭应用程序时，我想关闭（）数据库（并可能执行一些其他操作）。在后台，一个应用程序可以在没有警告的情况下被终止（手动或系统），所以我想做一些清理以期待这个事件。

我看到 API 文档中提到的“暂停”、“恢复”和“恢复”事件，但它们仅适用于 iOS。

**所以.... 我如何在 Android 上处理业务？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T14:06:48.473

您可以向 Android 中的当前活动添加事件侦听器：

```
Ti.Android.currentActivity.addEventListener('pause', callback); 
```

或者

```
Ti.Android.currentActivity.addEventListener('resume', callback); 
```

也许你在问如何在 iOS 上做到这一点？我会尝试使用窗口侦听器来“聚焦”和“模糊”。

# php - 如何制作不同的 WHERE 子句

> ID：10728621
> 
> 赞同：0
> 
> 时间：2012-05-23T22:11:24.363
> 
> 标签：php, mysql

```
$data['do'] = $this->db->query("SELECT MONTH(`date`) as month, COUNT(*) as count
FROM `simple` WHERE `ochistka` = 'somevalue' GROUP BY MONTH(`date`)"); 
```

在这里，我正在选择每个月都有一些值的字段，但是我如何才能选择一个具有其他条件的字段，而不是像 count( *) 作为计数，而是另一个 count(* ) 作为 count2，具有其他 WHERE 子句是可能的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T22:16:13.847

如果我正确理解您要实现的目标，您可以使用 SUM(IF) 技巧，如下所示：

```
SELECT MONTH(`date`) as month,
       SUM(IF(`ochistka` = 'somevalue', 1, 0)) as count1,
       SUM(IF(`ochistka` = 'othervalue', 1, 0)) as count2
FROM `simple`
GROUP BY MONTH(`date`) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:21:30.360

目前无法测试代码，但基本思路是使用子查询：

```
SELECT t1.month as month, t1.count as count1, t2.count as count2 
FROM
    (SELECT MONTH(`date`) as month, COUNT(*) as count
     FROM `simple` 
     WHERE `ochistka` = 'somevalue' 
     GROUP BY MONTH(`date`)) AS t1
INNER JOIN
    (SELECT MONTH(`date`) as month, COUNT(*) as count 
     FROM `simple` 
     WHERE `ochistka` = 'someothervalue' 
     GROUP BY MONTH(`date`)) AS t2 ON t1.month = t2.month 
```

# jquery - 引导模式：为提供的 ID 加载数据

> ID：10728625
> 
> 赞同：2
> 
> 时间：2012-05-23T22:11:45.087
> 
> 标签：jquery, asp.net-mvc, twitter-bootstrap, modal-dialog

我有一个[Bootstrap modal](http://twitter.github.com/bootstrap/javascript.html#modals)，可以从不同的超链接启动，每个超链接提供另一个 ID。

但我想要的是每次启动模态时，都会填充传递给模态的 ID 的数据。这是（简化的）代码（请参阅代码中的注释以获取解释）：

```
@model ViewModels.BookcaseItem.EditBookcaseItemViewModel

<div class="modal hide modal-large" id="editBookDialog">
    @using (Html.BeginForm("Edit", "Bookcase", FormMethod.Post, new { @class = "form-horizontal" }))
    {
        <!-- this is where the ID will be passed to -->
        @Html.HiddenFor(x => x.Id)

        <div class="modal-body">
            <!-- there's actually a couple of editors and labels here, but that doesn't really matter -->
            @Html.EditorFor(x => x.Bla)
        </div>
        <div class="modal-footer">
            <a href="#" class="btn" data-dismiss="modal">Close</a>
            <input type="submit" value="Save" class="btn btn-primary" />
        </div>
    }
</div> 
```

这是用于启动模式并将 ID 传递给它的超链接之一：

```
<a href="#editBookDialog" data-toggle="modal" data-id="@bookcaseItem.Id" title="Edit this item" class="open-EditBookDialog"></a> 
```

最后但并非最不重要的是实际传递 ID 的 JQuery 部分：

```
$(document).on("click", ".open-EditBookDialog", function () {
    var myBookcaseItemId = $(this).data('id');
    $(".modal #Id").val(myBookcaseItemId);
    $('#editBookDialog').modal('show');
}); 
```

让我们假设有一个带有签名 ActionResult Edit(string id) 的方法将数据返回到放置模式的 PartialView。

模式已经嵌入到所有超链接的页面中，默认情况下它是不可见的。

我只是不知道如何根据传递的 ID 用不同的数据填充它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T06:14:22.553

您可以使用 AJAX 通过控制器操作从服务器加载新数据：

```
$(function() {
    $(document).on('click', '.open-EditBookDialog', function () {
        var myBookcaseItemId = $(this).data('id');
        // send an AJAX request to fetch the data
        $.get(this.href, { id: myBookcaseItemId }, function(data) {
            $('#editBookDialog').html(data).modal('show');
        });
        return false;
    });
}); 
```

现在显然您应该修改应该打开对话框的锚点，以便它的 href 指向 Edit 控制器操作：

```
@Html.ActionLink(
    "Some text", 
    "Edit", 
    null, 
    new {
        data_toggle = "modal",
        data_id = bookcaseItem.Id,
        title = "Edit this item",
        @class = "open-EditBookDialog"
    }
) 
```

# java - 发送了 PHP 意外的 JSON

> ID：10728640
> 
> 赞同：-1
> 
> 时间：2012-05-23T22:13:28.940
> 
> 标签：java, php, mysql, json, jsonexception

我正在使用以下代码使用 PHP 访问我的数据库

```
<?php
$host = "localhost";
$user = "**MASKED**";
$password = "**MASKED**";
$database = "parkfinder_zxq_coordinates";

$connection = mysql_connect($host, $user, $password) or die("couldn't connect to server");
$db = mysql_select_db($database, $connection) or die("couldn't select database.");
//$request_parked = $_REQUEST['parked'];
$request_long = $_REQUEST['longtitude'];
$request_lat = $_REQUEST['latitude'];
$q = mysql_query("SELECT * FROM Coordinates");
while ($e = mysql_fetch_assoc($q))
    $output[] = $e;

print (json_encode($output));

mysql_close();
?> 
```

当我在 Java 中使用此代码阅读响应时：

```
 HttpClient httpclient = new DefaultHttpClient();
                    HttpPost httppost = new HttpPost("http://parkfinder.zxq.net/default.php");
                    httppost.setEntity(new UrlEncodedFormEntity(coordinatesToSend));
                    HttpResponse response = httpclient.execute(httppost);
                    HttpEntity entity = response.getEntity();

                    String result = EntityUtils.toString(entity);
                    Log.d("RESULT", result);
                    JSONObject json_data = new JSONObject(result); 
```

我得到的结果是：

```
2[{"longtitude":"32.32","latitude":"33.12"}] 
```

这会导致 JSONObject 抛出异常，因为这不是有效的 JSON 数据，它以 2 开头。有人知道如何修复它吗？两个代码都取自网上教程，貌似没有这种问题。问题发生在两个不同的 MySQL 服务器上。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:22:43.513

检查您的 PHP 代码，并确保您没有在`print(json_encode($output))`. 这是唯一可能出错的事情。

顺便说一句，您应该确保在循环`$output=array()`之前声明。`while`否则，如果您没有结果行，您将得到意外的输出。

# jquery - Rails 自动完成 - 自定义行为以在进入之前列出所有项目

> ID：10728641
> 
> 赞同：1
> 
> 时间：2012-05-23T22:13:45.153
> 
> 标签：jquery, ruby-on-rails-3, jquery-ui, jquery-autocomplete

我正在尝试为 Rails 3.2 中的字段实现具有特殊行为的自动完成功能。我正在使用 rails 自动完成 gem，我想要做的是：

表单中有一个字段，我希望自动完成在其中包含配方成分的数量和数量类型。输入的三个不同示例：

```
100 gramms
2 pices
3.2 kilos 
```

我希望当用户使用列表中的所有可用选项按空格键时，该行为具有下拉菜单。当用户输入另一个键时，列表当然会过滤该输入。

是否可以为上述行为自定义 rails 自动完成功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:36:11.463

更新。我原来的回答误解了这个问题。

第一个选项。

您修改控制器操作。

```
# units_controller
def autocomplete
   term = params[:term]
   quantity, unit = term.split(/\s/)
   items = unit ? Unit.where('units.name LIKE ?',"#{unit}%") : []
   json = items.collect do |item| 
     { "id" => item.id.to_s, 
       "label" => item.name, 
       "value" => "#{quantity} #{item.name} "  
     }
   end
   render json: json
end 
```

虽然自动完成行为已经是正确的，但此解决方案不是最理想的，因为即使在我输入数量时它也会访问服务器（并且没有给出任何结果）。

一个完整的解决方案涉及修补 rails autocompleter 驱动程序。保留 abave 自定义控制器操作，只需放置自定义 minLength 函数 [https://github.com/crowdint/rails3-jquery-autocomplete/blob/master/lib/assets/javascripts/autocomplete-rails-uncompressed.js#L63](https://github.com/crowdint/rails3-jquery-autocomplete/blob/master/lib/assets/javascripts/autocomplete-rails-uncompressed.js#L63)

您将此部分修改为：

```
 search: function() {
     // custom minLength
     var term = extractLast( this.value );
     var filter = jQuery(this).attr('data-input-filter');
     if (filter != null) { 
        var re = new RegExp(filter,"");
        term = term.replace(re, "$1"); //ignore parts of it
     }
     if ( term.length < 1 ) { //modify to 1
       return false;
     }
   }, 
```

现在如果你把这个 minlength 过滤器放到你的字段标签中

```
'data-input-filter' => j("^.*\s+([^\s]+)$") 
```

它将正确忽略用户输入的第一位（直到最后一个空格之后），并且仅在您到达该单元的第一个字符时才访问服务器。（这里有点不确定逃脱）

这种方法的一个优点是您可以将成分自动完成添加到您的控制器，并使用逗号并通过将此选项添加到自动完成文本字段帮助程序来获取多个成分输入：

```
"data-delimiter" => ',' 
```

然后您可以正确地自动完成输入，例如：

```
1 kilo flour, 2 spoons sugar, 100 gramms yeast. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T15:56:29.203

还有一个纯js的解决方案，所以你可以在你的控制器中保持简单

```
# units controller
autocomplete :unit, :name 
```

并且您需要修改 rails3-jquery-autocomplete js 驱动程序。

一条关键线是这一点。 [https://github.com/crowdint/rails3-jquery-autocomplete/blob/master/lib/assets/javascripts/autocomplete-rails-uncompressed.js#L45](https://github.com/crowdint/rails3-jquery-autocomplete/blob/master/lib/assets/javascripts/autocomplete-rails-uncompressed.js#L45) 您可以在此处自定义用户输入与发送到服务器的实际术语的关系完成。

问题是您还必须确保在选择中插入的值包含数量。由于该值取自服务器 json 响应，因此如果您不将数量发送到服务器，则必须在 extract 的 js 属性中记住它

```
function extractLast( term ) {
  var last = split( term ).pop().replace(/^\s+/,"");
  var arr = last.split(/\s+/);
  if (arr.length > 1) {  
     var res = arr.pop();
     jQuery(this).attr('data-quantity').val(arr.join(' '));
  }
  return res;
} 
```

并将其插入在线 [https://github.com/crowdint/rails3-jquery-autocomplete/blob/master/lib/assets/javascripts/autocomplete-rails-uncompressed.js#L77](https://github.com/crowdint/rails3-jquery-autocomplete/blob/master/lib/assets/javascripts/autocomplete-rails-uncompressed.js#L77)

```
terms.push( (jQuery(this).attr('data-quantity')) + ' ' + ui.item.value ); 
```

当然，更好的代码会使这取决于我接受的答案中的输入字段数据属性。

该解决方案也不允许基于数量解析成分或过滤单元，因为只有单元部分是随请求发送的。

# javascript - 根据一天中的时间更改正文和链接的类别

> ID：10728643
> 
> 赞同：1
> 
> 时间：2012-05-23T22:13:51.377
> 
> 标签：javascript, jquery, addclass

我正在尝试根据一天中的时间更改代码中的一些类。我可以让背景改变得很好，但我也需要改变菜单颜色。我似乎无法在页面中的链接中添加一个类来让它们也发生变化！不知道我哪里出错了，任何帮助将不胜感激，谢谢！

PS我也尝试过jQuery css（），也没有运气......

```
function getDayTime(hours) {
if (hours > 20 || hours < 5)
    return "night";

if (hours > 17)
    return "dusk";

if (hours > 8)
    return "day";

return "dawn";
}

$(function() {
    document.body.className = getDayTime(new Date().getHours());
}); 
```

太棒了，非常感谢大家的帮助，我已经更改了 javascript，它也很好用。但是，我现在也在尝试将黎明颜色更改为白色 - 即使我将其编码为与更改为白色相同的代码，它仍然保持红色！很明显，我的系统里没有足够的咖啡……

```
body.dawn #menu a {
    color:#fff !important
}

body.day #menu a {
    color:#8a0000 !important
}

body.dusk #menu a {
    color:#fff !important
}

body.night #menu a {
    color:#fff !important
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:18:57.453

在 jQuery 中你没有`className`. 看看[addClass](http://api.jquery.com/addClass/)和类似的。

但是，我会建议您在 CSS 中使用类似的内容：

```
body.night a {
    /* your style for the 'nightlink' with !important to be sure */
} 
```

所以你不需要要求 JS 来检索和迭代页面中的所有 A 节点。此外，如果您将动态添加链接，使用 CSS 方法，样式也会自动应用于它们。

**编辑**：与原始问题无关，但我认为您可以使用以下内容简化 js 代码中的条件：

```
function getDayTime(hours) {
    if (hours > 20 || hours < 5)
        return "night";

    if (hours > 17)
        return "dusk";

    if (hours > 8)
        return "day";

    return "dawn";
}

$(function() {
    document.body.className = getDayTime(new Date().getHours());
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:19:02.997

我不知道你的 CSS 是什么样的，但你可以这样做：

假设您的 CSS 如下所示：

```
<style type="text/css">
  body { /* some stuff here */ }
  body.day { /* some day stuff here */ }
  body.night { /* some night stuff here */ }
  #menu { /* some stuff here */ }
  #menu a { /* some menu link styling here */ }

  /* To change #menu when body has class="day" */
  body.day #menu { // change menu when it's day }
  body.day #menu a { // change menu links */ }

  /* To change #menu when body has class"night" */
  body.night #menu { /* change menu when it's night */ }
  body.night #menu a { // change menu links */ }
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T22:19:22.450

```
$("a").addClass("nightlink") 
```

应该管用

# c# - 为 PInvoke 正确声明 SP_DEVICE_INTERFACE_DETAIL_DATA

> ID：10728644
> 
> 赞同：9
> 
> 时间：2012-05-23T22:13:56.527
> 
> 标签：c#, winapi, pinvoke, memory-alignment

[`SP_DEVICE_INTERFACE_DETAIL_DATA`](http://msdn.microsoft.com/en-us/library/windows/hardware/ff552343.aspx)结构：

```
typedef struct _SP_DEVICE_INTERFACE_DETAIL_DATA {
  DWORD cbSize;
  TCHAR DevicePath[ANYSIZE_ARRAY];
} SP_DEVICE_INTERFACE_DETAIL_DATA, *PSP_DEVICE_INTERFACE_DETAIL_DATA; 
```

**如何在 C# 中声明它才能`Marshal.SizeOf`正常工作？**

我没有分配动态缓冲区的问题。**我只想以`cbSize`适当的、非硬编码的方式计算。**

[PInvoke.net](http://pinvoke.net/default.aspx/Structures/SP_DEVICE_INTERFACE_DETAIL_DATA.html)上的定义是错误的。
PInvoke.net 上的解释也是错误的：

> ```
> SP_DEVICE_INTERFACE_DETAIL_DATA didd = new SP_DEVICE_INTERFACE_DETAIL_DATA();
> didd.cbSize = 4 + Marshal.SystemDefaultCharSize; // trust me :) 
> ```

不要相信他。
`4 + Marshal.SystemDefaultCharSize`仅在 x86 上有效。对`sizeof(int) + Marshal.SystemDefaultCharSize`. 在 x64 上，它惨遭失败。

这是非托管 C++ 提供的：

> **x86**
> 结构体 大小 A：`5`
> 设备路径偏移量 A：结构体`4`
> 大小 W：`6`
> 设备路径偏移量 W：`4`
> 
> **x64**
> 结构体 大小 A：`8`
> 设备路径偏移量 A：结构体`4`
> 大小 W：`8`
> 设备路径偏移量 W：`4`

我尝试了所有可能的`StructLayout`和`MarshalAs`参数组合，但我无法让它返回上述值。

什么是正确的声明？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T00:02:25.757

结构的关键是*你不知道它应该有多大*。您必须调用 SetupDiGetDeviceInterfaceDetail() 两次，在第一次调用时您故意为 DeviceInterfaceDetailSize 参数传递 0。这当然会失败，但RequiredSize 参数会告诉您结构需要多大。然后你分配一个正确大小的结构并再次调用它。

pinvoke marshaller 或 C# 语言不直接支持动态调整结构大小。所以声明结构根本没有帮助，不要尝试。你应该使用 Marshal.AllocHGlobal()。这将为您提供一个指针，您可以将其作为 DeviceInterfaceDetailData 参数传递。使用 Marshal.WriteInt32 设置 cbSize。现在打电话。并使用 Marshal.PtrToStringUni() 检索返回的字符串。Marshal.FreeHGlobal 进行清理。从方法名称中搜索执行此操作的代码应该没有任何问题。

* * *

cbSize 成员有问题，SetupApi.h SDK 头文件包含以下内容：

```
#ifdef _WIN64
#include <pshpack8.h>   // Assume 8-byte (64-bit) packing throughout
#else
#include <pshpack1.h>   // Assume byte packing throughout (32-bit processor)
#endif 
```

太丑了，C 编译器会认为数组后面有 2 个字节的填充，即使没有。在 C# 代码中，32 位代码与 64 位代码的 StructLayoutAttribute.Pack 值需要不同。如果不声明*两个*结构，就无法干净地做到这一点。并根据 IntPtr.Size 的值在它们之间进行选择。或者只是硬编码它，因为结构声明无论如何都没有用，它在 32 位模式下是 6，在 64 位模式下是 8。在这两种情况下，字符串都从偏移量 4 开始。当然，假设 Unicode 字符串，使用 ansi 字符串没有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-08T21:57:37.997

已经有一段时间了，但这是我正在使用的代码（在阅读了所有这些答案和其他在线答案之后），从当前版本的 Windows 10 开始，它似乎在 x86 和 x64 上运行良好：

```
 [DllImport(@"setupapi.dll", CharSet = CharSet.Auto, SetLastError = true)]
    internal static extern Boolean SetupDiGetDeviceInterfaceDetail(
       IntPtr hDevInfo,
       ref SP_DEVICE_INTERFACE_DATA deviceInterfaceData,
       IntPtr deviceInterfaceDetailData,
       int deviceInterfaceDetailDataSize,
       ref UInt32 requiredSize,
       ref SP_DEVINFO_DATA deviceInfoData
    );

    public static String GetDeviceInterfacePath(IntPtr DeviceInfoSet, ref SP_DEVINFO_DATA devInfo, ref SP_DEVINFO_DATA deviceInterfaceData)
    {
        String devicePath = null;
        IntPtr detailData = IntPtr.Zero;
        UInt32 detailSize = 0;

        SetupDiGetDeviceInterfaceDetail(DeviceInfoSet, ref deviceInterfaceData, detailData, 0, ref detailSize, ref devInfo);
        if (detailSize > 0)
        {
            int structSize = Marshal.SystemDefaultCharSize;
            if (IntPtr.Size == 8)
                structSize += 6;  // 64-bit systems, with 8-byte packing
            else
                structSize += 4; // 32-bit systems, with byte packing

            detailData = Marshal.AllocHGlobal((int)detailSize + structSize);
            Marshal.WriteInt32(detailData, (int)structSize);
            Boolean Success = SetupDiGetDeviceInterfaceDetail(DeviceInfoSet, ref deviceInterfaceData, detailData, (int)detailSize, ref detailSize, ref devInfo);
            if (Success)
            {
                devicePath = Marshal.PtrToStringUni(new IntPtr(detailData.ToInt64() + 4));
            }
            Marshal.FreeHGlobal(detailData);
        }

        return devicePath;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T23:21:57.660

Mike Danes 在 JamieSee 给出的链接中确实有正确的编组：http: [//social.msdn.microsoft.com/Forums/en/clr/thread/1b7be634-2c8f-4fc6-892e-ece97bcf3f0e](http://social.msdn.microsoft.com/Forums/en/clr/thread/1b7be634-2c8f-4fc6-892e-ece97bcf3f0e)

然而，他确实做错了指针运算：

正确的

```
detail = (IntPtr)(detail.ToInt64() + 4); //skip the cbSize field 
```

不正确*（可能无法在 x64 上产生正确的值）*

```
detail = (IntPtr)(detail.ToInt32() + 4); //skip the cbSize field 
```

你看到你得到的大小值的原因是因为填充。填充与被调用的函数无关。重要的是第一次调用时 cbSize >= 4（以获得所需的实际大小）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T07:26:18.633

你必须在运行时做一些事情。

代码：

```
didd.cbSize = Marshal.SizeOf(typeof(Native.SP_DEVICE_INTERFACE_DETAIL_DATA));
if (IntPtr.Size == 4)
{
    didd.cbSize = 4 + Marshal.SystemDefaultCharSize;
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-20T20:15:25.583

我只在 XP 上检查过：

```
DWORD get_ascii_detail_size(void)
{
   DWORD detail[2], n;

   for(n=5;n<=8;n+=3)
   {
      detail[0]=n;
      SetupDiGetDeviceInterfaceDetailA(NULL, NULL, detail, n, NULL, NULL);
      if (GetLastError()!=ERROR_INVALID_USER_BUFFER) return(n);
   }
   return(0);
} 
```

我查看了 SetupApi.dll 中的代码，ASCII 版本所做的第一件事是检查细节是否为 NULL，然后根据硬编码值检查正确的 cbSize。这是因为 ASCII 版本输入 Widechar 版本。

在前两个参数无效的情况下，您无法使用 Widechar API 执行此操作。如果您使用的是 Widechar API，只需 WORD 对齐此函数的大小。

如果有人可以在其他系统上检查这一点，我将不胜感激。

# maven - 在 maven-antrun-plugin 中调用 foreach

> ID：10728645
> 
> 赞同：5
> 
> 时间：2012-05-23T22:13:58.137
> 
> 标签：maven, ant, ant-contrib, maven-antrun-plugin

我正在尝试设置 maven 以在我的 Web 项目中的目录上执行 LESS CSS 预处理器。基本流程是：

1.  Maven 调用 maven-antrun-plugin。
2.  Ant-contrib`<foreach/>`遍历一个目录并找到所有的 .less 文件并调用一个目标。
3.  目标执行 Rhino，后者执行转换文件的 LESS。

为此，我有以下 XML：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.7</version>
            <executions>
                <execution>
                    <phase>compile</phase>
                    <configuration>
                        <target name="processLessFile">
                            <!-- ... -->
                        </target>
                        <target name="main">
                            <taskdef resource="net/sf/antcontrib/antcontrib.properties" classpathref="maven.plugin.classpath"/>
                            <property name="css.dir" location="src/main/webapp/css"/>
                            <foreach param="file" target="processLessFile">
                                <fileset dir="${css.dir}">
                                    <filename name="**/*.less" />
                                </fileset>
                            </foreach>
                        </target>
                    </configuration>
                    <goals>
                        <goal>run</goal>
                    </goals>
                </execution>
            </executions>
            <dependencies>
                <dependency>
                    <groupId>ant</groupId>
                    <artifactId>ant-contrib</artifactId>
                    <version>1.0b2</version>
                </dependency>
            </dependencies>
        </plugin> 
```

我遇到的问题是“主要”目标开始执行但随后失败`<foreach>`：

```
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-antrun-plugin:1.7:run (default) on project model-web-project: An Ant BuildException has occured: The following error occurred while executing this line:
[ERROR] /Users/.../pom.xml:4: Unexpected element "{http://maven.apache.org/POM/4.0.0}project" {antlib:org.apache.tools.ant}project
[ERROR] around Ant part ...<foreach param="file" target="processLessFile">... @ 6:50 in /Users/.../target/antrun/build-main.xml
[ERROR] -> [Help 1] 
```

似乎 Ant 中的某些东西导致它尝试读取 POM 文件，可能是在寻找目标。我看到两个目标都生成到文件 target/antrun/build-main.xml 和 target/antrun/build-processLessFile.xml 中，所以这是它应该查找的目录。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T19:27:32.910

ant 插件似乎不支持声明多个目标部分。您可以检查生成的 ANT 脚本以了解我在说什么：

```
target/antrun/build-main.xml 
```

深入挖掘[插件文档](http://maven.apache.org/plugins/maven-antrun-plugin/index.html)指出以下内容：

> 这个插件的目的不是提供污染 POM 的方法，因此鼓励将所有 Ant 任务移动到 build.xml 文件中，然后使用 Ant 的任务从 POM 中调用它。

措辞严厉，但建议是合理的。我建议将您的 ANT 逻辑移动到专用文件中并按如下方式调用它：

```
 <plugin>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.7</version>
            <executions>
                <execution>
                    <phase>compile</phase>
                    <configuration>
                        <target>
                            <ant antfile="${basedir}/src/main/ant/build.xml"/>
                        </target>
                    </configuration>
                    <goals>
                        <goal>run</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T06:36:14.867

您知道我认为应该可以解决您的问题的[lesscss-maven-plugin 。](http://mojo.codehaus.org/lesscss-maven-plugin/)

# html - iOS5 (Safari) 的错误，“位置：固定” div 和高表单

> ID：10728647
> 
> 赞同：6
> 
> 时间：2012-05-23T22:14:07.447
> 
> 标签：html, css, ios5, css-position

全部，

我正在开发一个包含非常“高”表单的 Web 应用程序。（高，这意味着它比典型的屏幕高百分之几）。

该设计要求将“页脚”锚定在始终可见的屏幕底部，无论用户在表单中的位置如何。

换句话说，无论用户是靠近窗体的顶部、中间还是底部，页脚都应该是可见的，并且窗体应该在它的“下方”滚动。

为了实现这一点，我将页脚创建为一个带有`position:fixed`, 和的 div `bottom:0`。

这适用于我测试过的所有浏览器，包括 iOS5 上的 Safari。

除了有**一个**错误...

如果用户靠近表单顶部，并将焦点放在其中一个文本字段上 - 正如预期的那样，iOS 会显示键盘。

每次用户单击**“下一步”**按钮时，iOS 都会将她“标记”到下一个字段。

当她通过反复单击**Next**向下滚动表单时，iOS 会自动“向上滚动”表单，因此她在表单上的位置仍然可见。

然而，iOS 似乎并没有更新`position:fixed`页脚 div 的位置——它与表单的其余部分一起错误地向上滚动。

如果用户关闭键盘，则 div 将恢复到它的“正确”位置，因此这不是不可恢复的错误。但是，页脚完全移动的事实是一个明显的问题。

这是 iOS 实现的错误还是缺点`position:fixed`？或者，我做错了什么？

提前谢谢了！

**[更新]**

Remy Sharp（恰如其名）刚刚写了一篇`position:fixed`关于 iOS/Safari 上的各种错误和问题的优秀而详细的帖子：[http ://remysharp.com/2012/05/24/issues-with-position-fixed-scrolling -on-ios/](http://remysharp.com/2012/05/24/issues-with-position-fixed-scrolling-on-ios/)。`position:fixed`如果您正在考虑在面向 iOS 用户的网站上使用，那么这是必读的……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:32:02.173

我知道`position:fixed`iOS 的早期版本最初不支持它，我知道 iOS5 确实支持它，但我过去曾遇到过问题。如果您的页脚是某种控制栏，那么我建议使用 CSS 粘性页脚，然后所有页面/内容都可以加载到`div`上面的一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T22:33:43.937

你在使用 jQuery 吗？如果是这样，我怀疑这样的工作有效：

```
$(":input").focus( function() {
  $(window).scrollTop( $(window).scrollTop() + 1 );
}); 
```

通过在聚焦新表单元素后滚动页面 1 像素，它*应该*重置固定元​​素的底部属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T00:09:33.663

这是解决方法，无需让页脚在您身上跳来跳去。

1.  首先，您将标题和正文/部分包装在一个 div 中。使该 div 可滚动。
2.  比您定位页脚的绝对位置和其他所有位置的相对位置。
3.  添加固定高度。

看到它在这里工作， http: [//yinnetteolivo.com/footerbottom.html](http://yinnetteolivo.com/footerbottom.html)

别客气 ：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T16:52:22.587

我为这个错误找到的其他答案都没有对我有用。我可以通过将页面向上滚动 34px 来修复它，移动 safari 的数量会将其向下滚动。用jQuery：

```
$('.search-form').on('focusin', function(){
    $(window).scrollTop($(window).scrollTop() + 34);
}); 
```

这显然会在所有浏览器中生效，但它可以防止它在 iOS 中中断。

# objective-c - iOS 通知

> ID：10728652
> 
> 赞同：1
> 
> 时间：2012-05-23T22:14:45.383
> 
> 标签：objective-c, ios, cocoa-touch, apple-push-notifications

我希望我的应用程序为每个用户保存一个用户名和密码并使用它登录，除非它被更改为另一个用户。
我在问自己如何将推送通知发送到相关设备？

每次更改或新输入用户名/密码时，我需要在用户名和密码旁边发送哪些类型的数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T22:19:16.353

在您的 AppDelegate 中实现此方法，“str”的值表示设备的唯一字符串。除了用户名和密码之外，还可以使用它来唯一标识特定设备上的用户。

```
- (void)application:(UIApplication *)app didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken { 

    NSString *str = [NSString 
        stringWithFormat:@"Device Token=%@",deviceToken];
    NSLog(str);

} 
```

这样做的先决条件是在应用程序的某处调用这行代码，通常来自 applicationDidFinishLaunching

```
[[UIApplication sharedApplication] 
    registerForRemoteNotificationTypes:
    (UIRemoteNotificationTypeAlert | 
     UIRemoteNotificationTypeBadge | 
     UIRemoteNotificationTypeSound)]; 
```

这是关于编程 iOS 推送通知的一个非常好的端到端参考（向下滚动配置信息以查找编程技术）： http: [//mobiforge.com/developing/story/programming-apple-push-notification-services](http://mobiforge.com/developing/story/programming-apple-push-notification-services)

# performance - 标准类型/数据结构（列表、字典、元组等）的 Python3 计算/内存复杂性

> ID：10728655
> 
> 赞同：1
> 
> 时间：2012-05-23T22:14:51.110
> 
> 标签：performance, python-3.x, complexity-theory

Python3 默认数据结构（列表、字典、元组...等）的计算复杂度是多少？

（内存复杂性问题也很有趣。）

我发现了什么：[http](http://wiki.python.org/moin/TimeComplexity) ://wiki.python.org/moin/TimeComplexity - 恐怕是关于 python 2，不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T23:00:01.750

wiki 条目适用于 Python 2 和 3 的 CPython。这些类没有更改。其他实现可能会有所不同，但如果他们希望人们将代码从 CPython 移植到 xpython，则它们必须相似。例如，使用链表作为列表类型的 Python 需要相当不同的编程风格和代码重新排列才能正常工作；-)。

在 3.3 中，dict 类发生了变化，使得一个类的多个实例的_dict_s 共有的一些信息是共享的，而不是重复的*。*这主要影响具有 100 或 1000 个某个类实例的人，并将节省大约 1/3 的 dict 空间（我认为），这是一个不会改变空间复杂度类的常数因素。

更重要的是，(unicode) str 类已被完全重写，只使用所需的字节/字符。结果通常会减少空间和时间，但主要影响应该是 O(xxx) 符号忽略的乘数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T07:48:00.417

计算复杂度与*求解方式有关*。独立地，如果 Python 3 更快与否，复杂性将是相同的——除非问题没有使用原则上不同的算法来解决。

有时，具有相同名称的抽象数据结构可能会有所不同（例如 Python 2 字符串与 Python 3 字符串，或 int，Python 2 中的 long 与 Python 3 中的广义 int）。

我没有检查它，但我的猜测是 Python 2 和 Python 3 在这个意义上没有区别。

# powershell - 如何在 Powershell 中处理大型 CSV 文件

> ID：10728657
> 
> 赞同：1
> 
> 时间：2012-05-23T22:15:14.697
> 
> 标签：powershell, csv

我正在尝试查找 csv 文件中高于某个值的行数。我的代码类似于

```
$T6=Import-Csv $file | Where-Object {$_."Value" -ge 0.6 } | Measure-Object 
```

这适用于较小的文件，但对于大型 csv 文件（1 GB 或更多），它将永远运行。有没有更好的方法在powershell中解析这样的csv文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T06:52:12.723

Import-Csv 是用于此目的的官方 cmdlet。不过有一条评论，导入的所有内容都是一个字符串，因此您最好将 Value 属性转换为正确的类型。例如：

```
$T6 = Import-Csv $file | Where-Object { [float]$_.Value -ge 0.6 } | Measure-Object 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T06:56:29.320

为了提高处理大文件时的速度，请考虑使用流式阅读器，Roman's answer [here](https://stackoverflow.com/a/6387587/847990)演示了用法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T07:10:08.080

You can try to get rid of `Import-Csv`:

```
$values = ([System.IO.File]::ReadAllText('c:\pst\New Microsoft Office Excel Worksheet.csv')).Split(";") | where {$_ -ne ""}

$items = New-Object "System.Collections.Generic.List[decimal]" 

foreach($value in $values)
{
    [decimal]$out = New-Object decimal
    if ([System.Decimal]::TryParse($value, [ref] $out))
      {
         if ($out -ge 10){$items.Add($out)}
      } 
   }
$items | Measure-Object 
```

# java - 如何在java中创建一个哈希表

> ID：10728659
> 
> 赞同：0
> 
> 时间：2012-05-23T22:15:36.880
> 
> 标签：java, hashtable

我有一个 2 列的 csv 文件。我正在尝试为每个维度创建一个哈希表 - 如果我以前没有见过它，只添加一个值。我想为每一列创建 2 个单独的哈希表。列包含字符串和数值。从类定义中我发现 containsKey(Object key) 方法测试指定的对象是否是此哈希表中的键。我可以解释一些细节，比如我的 csv 文件可能如下所示

```
New York, 50
Sydney, jessi
california, 10
New York, 10 
```

所以对于第 1 列 New york 在哈希表中出现 2，我想将键 New York 和值 2

谁能帮助我如何使用 java hashtable 类创建像这样的哈希表，或者维护一个单独的数组

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:30:59.567

在 SourceForge 上尝试[这个](http://sourceforge.net/projects/opencsv/)名为 OpenCSV 的开源项目。

然后你可以编写这样的代码来将 CSV 读入你的地图。

```
try {
    CSVReader reader = new CSVReader(new InputStreamReader(new FileInputStream(new File("/path/to/your/file.csv"))));
    Map<String, String> result = new HashMap<String, String>();
    for(String[] row : reader.readAll()) {
        result.put(row[0], row[1]);
    }
} catch (FileNotFoundException e1) {
    e1.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} 
```

[您可以在此处](http://opencsv.sourceforge.net/)阅读有关 OpenCSV 文档的更多信息。

# html - 如何解决 HTML 中的字体问题？

> ID：10728662
> 
> 赞同：0
> 
> 时间：2012-05-23T22:15:39.540
> 
> 标签：html

> 我有如下的 Html (hello.html)

```
<html xmlns="http://www.w3.org/1999/xhtml" >
    <head>
        <title>Test</title>
    </head>
    <body>
        <div>
            ¿Hola cómo está?
        </div>
    </body>
</html> 
```

> 它显示为“¿Hola cómo está?” 在浏览器中运行时
> 
> 是否有任何解决方案可以在不更改 hello.html 文件的情况下正确输出？

我希望它是西班牙语，但我正在寻找任何其他解决方案，例如更改浏览器或编辑器中的编码类型或字体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:19:38.397

编辑：刚刚注意到要求。但是一些西班牙字符需要 Unicode，你必须在你的 html 文件中声明它。

把这个放在你的脑海里。

```
<meta http-equiv="content-type" content="text/html;charset=utf-8" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:20:48.217

我看不出有什么问题，如果您指的是 html 中的字体类型并且网页不同是因为您的编辑器，如果您真的想更改字体，则需要在文本周围设置字体标签或更好地在 CSS 中定义它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T22:20:33.703

不。

如果不更改 html 文件，您将无法执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T22:31:15.267

根据评论部分对您的问题的澄清......

如果您使用的是 Google Chrome，并且您的计算机设置为英语语言环境，请加载页面，然后右键单击正文，然后选择“翻译成英语”。

听起来像是一个面试技巧问题，而不是编程问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-15T20:17:30.957

将此`<meta>`标签放在您的头部
`<meta charset="UTF-8">`

# clojure - 莱宁根 2 交互模式

> ID：10728663
> 
> 赞同：2
> 
> 时间：2012-05-23T22:15:39.750
> 
> 标签：clojure, leiningen

leiningen 2 不再提供“交互式”任务了吗？有没有类似功能的替代品或插件？我正在使用 leiningen 2.0.0-preview4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:54:39.630

我会注意到最后一段可能解释了发生了什么：

[https://groups.google.com/d/msg/leiningen/whV-VUdKSWM/O9H7cUQbGF8J](https://groups.google.com/d/msg/leiningen/whV-VUdKSWM/O9H7cUQbGF8J)

> 我应该注意，我正在考虑在 2.0 中放弃交互式任务以支持 Jark。您可能想尝试一下：http: [//icylisper.in/jark/start.html](http://icylisper.in/jark/start.html)虽然即将推出的 Jark 版本打算支持运行 lein 任务，但不幸的是它目前似乎无法正常工作。

## 编辑

提供的链接给出了 404，但在 GitHub 周围挖掘，我发现了它：

[http://icylisper.github.com/jark/](http://icylisper.github.com/jark/)

# jquery - 将事件绑定到所有“选择”下拉列表元素

> ID：10728675
> 
> 赞同：0
> 
> 时间：2012-05-23T22:17:31.017
> 
> 标签：jquery

我有一个带有可变数量的“选择”下拉列表和文本框的表单。我只想将`.change()`事件绑定到“选择”元素。我已经尝试过`$(":input").change()`，但将事件绑定`.change()`到所有输入。是否有类似`$(":text")`或方法来指定`$(":input")`仅针对“选择”元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:22:34.527

```
$("select").change(function() { ... }) 
```

传递给`$()`函数的选择器可以是任何 CSS 选择器，仅包括一个 html 标记名，例如“select”。

进一步阅读：

*   [jQuery 教程](http://docs.jquery.com/Tutorials)
*   [CSS 选择器教程](http://css.maxdesign.com.au/selectutorial/)
*   [你必须记住的 30 个 CSS 选择器](http://net.tutsplus.com/tutorials/html-css-techniques/the-30-css-selectors-you-must-memorize/)

# python - 具有全局变量的未绑定本地错误

> ID：10728678
> 
> 赞同：11
> 
> 时间：2012-05-23T22:17:55.410
> 
> 标签：python, debugging, pygame

我试图弄清楚为什么在我的 pygame 应用程序 Table Wars 中出现 UnboundLocalError。以下是所发生情况的摘要：

变量 ,`REDGOLD`和,`REDCOMMAND`被初始化为全局变量：`BLUEGOLD``BLUECOMMAND`

```
#Red Stat Section
REDGOLD = 50
REDCOMMAND = 100
#Blue Stat Section
BLUEGOLD = 50
BLUECOMMAND = 100

def main():    

    [...]

    global REDGOLD
    global REDCOMMAND
    global BLUEGOLD
    global BLUECOMMAND 
```

这在主循环中生成单位时有效，从生成单位中减去资金。

现在，我正在尝试建立一个系统，以便当一个单位死亡时，杀手退还受害者`COMMAND`并`GOLD`根据他杀死的东西获得收入：

```
class Red_Infantry(pygame.sprite.Sprite):
def __init__(self, screen):
    [...]
    self.reward = 15
    self.cmdback = 5

[...]

def attack(self):
    if self.target is None: return
    if self.target.health <= 0:
        REDGOLD += self.target.reward          #These are the problem lines
        BLUECOMMAND += self.target.cmdback     #They will cause the UnboundLocalError
                                               #when performed
        self.target = None
    if not self.cooldown_ready(): return
    self.target.health -= self.attack_damage
    print "Target's health: %d" % self.target.health 
```

这一直有效，直到单位死亡。然后会发生这种情况：

```
Traceback (most recent call last):
File "C:\Users\Oventoaster\Desktop\Games\Table Wars\Table Wars.py", line 606, in <module>
main()
File "C:\Users\Oventoaster\Desktop\Games\Table Wars\Table Wars.py", line 123, in main
RedTeam.update()
File "C:\Python27\lib\site-packages\pygame\sprite.py", line 399, in update
for s in self.sprites(): s.update(*args)
File "C:\Users\Oventoaster\Desktop\Games\Table Wars\Table Wars.py", line 304, in update
self.attack()
File "C:\Users\Oventoaster\Desktop\Games\Table Wars\Table Wars.py", line 320, in attack
REDGOLD += self.target.reward
UnboundLocalError: local variable 'REDGOLD' referenced before assignment 
```

如何让上面提到的全局变量随`attack`块而变化？如果有帮助，我正在使用 Pygame 2.7.x，所以`nonlocal`不会工作：/

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-23T22:25:06.817

`global`使全局变量在当前代码块中可见。您只将`global`语句放入`main`，而不放入`attack`。

**附录**

这是需要多次使用 global 的说明。尝试这个：

```
RED=1

def main():
    global RED
    RED += 1
    print RED
    f()

def f():
    #global RED
    RED += 1
    print RED

main() 
```

你会得到错误`UnboundLocalError: local variable 'RED' referenced before assignment`。

现在取消注释 f 中的全局语句，它将起作用。

声明在`global`LEXICAL 而非 DYNAMIC 范围内处于活动状态。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T22:25:09.997

您需要在要修改它们的每个范围内将变量声明为全局变量

最好找到一种不使用全局变量的方法。例如，将那些作为类属性有意义吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-15T13:08:58.313

发现`**main**`变量在函数中的行为类似于全局“只读”变量。如果我们尝试重新分配该值，则会产生错误。

尝试：

```
#!/usr/bin/env python
RED=1
A=[1,2,3,4,5,6]

def f():
    print A[RED]

f() 
```

没关系。

但：

```
#!/usr/bin/env python
RED=1
A=[1,2,3,4,5,6]

def f():
    print A[RED]
    A = [1,1,1,1,1]

f() 
```

产生

```
 File "./test.py", line 6, in f
    print A[RED]
UnboundLocalError: local variable **'A'** referenced before assignment 
```

和：

```
#!/usr/bin/env python
RED=1
A=[1,2,3,4,5,6]

def f():
    print A[RED]
    RED = 2

f() 
```

产生

```
 File "./test.py", line 6, in f
    print A[RED]
UnboundLocalError: local variable **'RED'** referenced before assignment 
```

# winforms - 从窗体外的公共方法更新窗体中的 TextBox

> ID：10728686
> 
> 赞同：0
> 
> 时间：2012-05-23T22:18:44.773
> 
> 标签：winforms, textbox, c++-cli

我有一个带有 a和 a的 windows 窗体 ( `Form1.h`) 。初始化表单时为空。单击按钮时，将调用表单外部的方法，它应该更新. 我将如何从非表单类更新？下面是我的示例代码：`Button``TextBox``TextBox``TextBox``TextBox`

```
// Form1.h
private: System::Void findResultButton_Click(System::Object^  sender, System::EventArgs^  e) {
    FirstResults* firstResults = new FirstResults();
    firstResults->findResult();
}

// FirstResults.cpp
void FirstResults::findResult() { 
    // do some calculations here and find result.
    // write the result value to a .txt file.
    // Update TextBox in Form1.h with result value.
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T19:22:12.150

首先，您需要创建表单的静态实例。然后在您想要访问的任何 .cpp 文件中的 TextBox1 或 TextArea 中，您只需

```
public ref class Form1 : public System::Windows::Forms::Form
{
public:
    static Form1^ myForm1;

    Form1(void)
    {
        InitializeComponent();
        myForm1 = this;
        //
        //TODO: Add the constructor code here
        //
    }
} 
```

然后在 .cpp`#include "form1.h"` 和

```
Form1^ myform1 = gcnew Form1();
Form1::myForm1->textBox1->Text = L" FROM the main.cpp "; 
```

或者如果你需要

```
System::Windows::Forms::myform1->textBox1->Text = L" FROM the main.cpp "; 
```

# visual-studio - 如何设置升压？

> ID：10728688
> 
> 赞同：0
> 
> 时间：2012-05-23T22:18:51.483
> 
> 标签：visual-studio, visual-studio-2008, boost

如何在visual studio中设置boost？

不明白如何使这个库工作。

编译程序时每次超时错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:11:37.520

Boost 由相当多的库组成——其中一些需要预先构建，而另一些则不需要。此外，您必须在 VisualStudio 中设置“路径”，让它知道 Boost 标头所在的位置。查看[“入门”部分](http://www.boost.org/doc/libs/1_49_0/more/getting_started/windows.html#build-a-simple-program-using-boost)。

# hibernate - 从我的 Grails 应用程序访问本地存储的文件？

> ID：10728697
> 
> 赞同：2
> 
> 时间：2012-05-23T22:19:41.157
> 
> 标签：hibernate, grails, groovy

我需要让我的 grails 应用程序访问本地存储的 pdf 文件以供参考。我有一个到本地服务器上某个位置的绝对路径，并且该应用程序将在同一网络上运行。

我不确定是否最好让用户将文件名输入文本字段（受用户错误影响）然后将其存储在数据库中，然后我可以创建一个链接以将其附加到路径中，如下所示：

```
<a href="${resource(dir:'/serverName/locationName/pdfs',file:'FILENAME_with_Ext.pdf')}" target="_new">pdfFile</a> 
```

但这似乎不起作用，因为它找不到文件并且我收到 404 错误

我在想的另一件事是让用户上传文件可能更容易，如果有的话，因为可能并不总是有文件。我认为这可能是更好的方法，但我不知道将文件存储在哪里。我会在 Web 应用程序目录中创建一个文件夹并将所有文件存储在那里吗？

感谢您给我的任何意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:13:55.480

资源指令是相对于网络应用程序根的，所以我认为它不能访问除此之外的任何东西。

我不确定您所说的可能并不总是有服务器是什么意思 - 总是有一个服务器可以运行应用程序。如果您的意思是数据库服务器，我想这在技术上是正确的，尽管您至少可以始终使用 H2 或其他一些内存数据库。

该[文档](http://grails.org/doc/latest/guide/theWebLayer.html#uploadingFiles)有一个关于文件上传的非常好的部分。您可以按照它并将文件保存到您有权访问的任何目录 - 映射或网络或本地。可能最好在 Web 应用程序之外执行此操作，这样您在重新部署时就不会覆盖。保存文件名和您需要向用户显示的任何描述。

然后要访问，您可能需要在您的 Web 服务器（tomcat 等）中设置某种别名。因此，假设您存储了文档，`/var/myWebApp/uploads`然后您使用 Web 服务器设置创建了一个别名，以便`/uploads/`指向`/var/myWebApp/uploads`并将它们作为`http://www.myserver.com/uploads/uploaded.pdf`

我不知道您对该站点有什么安全问题，但如果您担心人们会浏览上传目录，并且不允许该目录显示为索引并列出它包含的文件。

***编辑***

非常基本的例子

```
//class
class MyClass {
    String fileDescription
    byte[] fileDocument
}

//form
<g:uploadForm action="save">
    Description <g:textField name="fileDescription" />
    <input type="file" name="fileDocument" />
    <input type="submit" 
</g:uploadForm>

//controller
def save = {
    def myClass = new MyClass(params)
    myClass.save()
} 
```

# c# - 如何通过哈希值识别类型？

> ID：10728699
> 
> 赞同：0
> 
> 时间：2012-05-23T22:20:09.773
> 
> 标签：c#, serialization, hash, udp, client-server

所以我有基本的 UDP 服务器，我已经实现了一些东西，比如恢复字节数组完全是客户端发送的方式（如果它被无序检索）。基本上，我有客户端、服务器和具有类型的共享类库，其对象可以从客户端发送到服务器，反之亦然。所以现在我想到了序列化一些对象并发送到服务器/客户端的想法。但我需要知道收到了什么类型的对象才能正确反序列化它。为了解决这个问题，我想到了两个想法：

*   做一个“握手”。发送有关将要发送的对象、其长度、类名等的数据。在它检索实际数据并对其进行反序列化之后。我知道这样做，但是由于它是 UDP，因此这种“握手”可能会丢失，我需要重新询问它，因此逻辑和网络过度使用非常复杂，但我知道如何实现这一点。
*   第二个是通过一些哈希值来识别类型。所以客户端发送的数据包含类型和数据的哈希值（我只会发送我自己的类型的对象，所以不需要为 C# 和框架类型实现这个），我需要通过这个哈希值来确定类型，服务器可以适当地解开它。

那么有什么想法，如何实现呢？如果我设法避免反射，那将是完美的，因为它很慢（如果它工作得更快，我不在乎巨大的 switch 语句）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:57:45.090

只需将对象类型作为对象数据的一部分，并使用完全相同的逻辑发送它们即可。不要尝试在网络级别单独处理它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T05:03:12.333

我今天刚刚为我正在研究的原型做了这个。我这样定义了我的消息流：

前 4 个字节：作为 Int32 的程序集限定类型名称的长度。

接下来的 n 个字节（其中 n 由前 4 个字节给出）：类型的程序集限定名称。

消息的其余部分：序列化对象

它就像一个魅力。

# c# - 如何在 Binding 中使用 x:class 属性？

> ID：10728705
> 
> 赞同：1
> 
> 时间：2012-05-23T22:20:46.413
> 
> 标签：c#, wpf, xaml

我需要将视图的类名作为 CommandParameter 传递。这该怎么做？

```
<UserControl x:Name="window"
             x:Class="Test.Views.MyView"
             ...>

    <Grid x:Name="LayoutRoot" Margin="2">
        <Grid.Resources>
            <DataTemplate x:Key="tabItemTemplate">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" >
                    <Button Command="{Binding DataContext.CloseCommand, ElementName=window}"
                            CommandParameter="{Binding x:Class, ElementName=window}">
                    </Button>
                </StackPanel>
            </DataTemplate>
        </Grid.Resources>
    </Grid>
</UserControl> 
```

结果应该是字符串“Test.Views.MyView”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:42:39.227

[x:Class](http://msdn.microsoft.com/en-us/library/ms752309.aspx)只是一个指令而不是属性，因此您将无法绑定到它。

[*来自 MSDN*](http://msdn.microsoft.com/en-us/library/ms752309.aspx)

> 配置 XAML 标记编译以加入标记和代码隐藏之间的部分类。代码部分类在公共语言规范 (CLS) 语言的单独代码文件中定义，而标记部分类通常由 XAML 编译期间的代码生成创建。

但是您可以从 Type 的 FullName 属性中得到相同的结果。使用转换器

```
CommandParameter="{Binding ElementName=window,
                           Path=.,
                           Converter={StaticResource GetTypeFullNameConverter}}" 
```

*GetTypeFullNameConverter*

```
public class GetTypeFullNameConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value == null)
        {
            return null;
        }
        return value.GetType().FullName;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotSupportedException();
    }
} 
```

# php - 使用 .htaccess 隐藏文件 url

> ID：10728716
> 
> 赞同：0
> 
> 时间：2012-05-23T22:22:13.690
> 
> 标签：php, .htaccess

我需要一些帮助来弄清楚如何写这个`.htaccess`。

我的文件在`mywebsite/part5/thanksfordownload.html`. 如何使用`.htaccess`拥有 url `mywebsite/thankyoufordownload.html`？

我试着用这个来做骰子，`.htaccess`但没有骰子。我尝试将它上传到根目录和文件夹本身。

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ /part5/$1 [L] 
```

不知道这部分出了什么问题，提前感谢您的意见和评论！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:27:18.970

好的，基本上，如果您**只**想要该规则-您会想做这样的事情-

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^thankyoufordownload.html$ /part5/thankyoufordownload.html [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:27:41.860

简单地：

```
RewriteRule ^thankyoufordownload.html$ part5/thanksfordownload.html 
```

这仅适用于所询问的示例。

# c# - 如何在不使用 foreach 的情况下从集合中查询实体

> ID：10728720
> 
> 赞同：0
> 
> 时间：2012-05-23T22:22:45.823
> 
> 标签：c#, linq, entity-framework

我一直在努力并试图让我的思想围绕这些概念。任何帮助将不胜感激。给定一个表中的 Orders 集合，迭代它并对其他表执行查询的最佳方法是什么。

这个循环做我想要的，但我被告知并展示了这如何导致性能问题。在其他帖子上，我读过最好在循环之外查询 dbase。

```
foreach (var item in myOrders)
{
var lookUpValues=(from f in ORDERS
where f.ORDERS ==item.ORDER_ID 
&& f.ORDERS_SUFFIX==item.LINE
select f.Something);
} 
```

我没有在迭代之前拉下整个 Order 表，而是尝试了类似的方法，但正如您所见，它不会返回准确的行。

```
var orderIds=myOrders.Select (x =>x.ORDER_ID).Distinct().ToList();
var lineIds=myOrders.Select (x =>x.LINE).Distinct().ToList();

var query=(from f in ORDERS
where orderIds.Contains(f.ORDERS)
&& lineIds.Contains(f.ORDERS_SUFFIX)
select f).ToList(); 
```

下面会做我认为需要的。它将返回迭代所需的正确订单。但是，它会引发错误，我认为这是因为您无法同时查询内存对象和实体。

```
var ordersAndLine=(from f in myOrders select new{sId=f.ORDER_ID,line=f.LINE}).ToList();

var query=(from f in ORDERS
from s in ordersAndLine
where s.sId==f.ORDERS
&& s.line==f.ORDERS_SUFFIX
select f).ToList(); 
```

NotSupportedException：无法创建“匿名类型”类型的常量值。此上下文仅支持原始类型（“例如 Int32、String 和 Guid”）。

我真的希望我的问题是有道理的。如果我没有正确解释我的情况，我提前道歉。我一直在做的是将大部分表拉到内存中进行迭代，但我担心这会导致性能问题，并想看看是否有更好的方法来过滤结果查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:52:59.707

如果您将第一次尝试和最后一次尝试结合起来，您将拥有它。如果您不创建匿名类型，最后一次尝试会很好。

```
var ordersAndLine=(from f in myOrders select f).ToList();

var query=(from f in ORDERS
from s in ordersAndLine
where s.ORDER_ID==f.ORDERS
&& s.LINE==f.ORDERS_SUFFIX
select f).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:36:11.273

看看这些：

[http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/095745fe-dcf0-4142-b684-b7e4a1ab59f0/](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/095745fe-dcf0-4142-b684-b7e4a1ab59f0/)

[Linq to Entities - SQL“IN”子句](https://stackoverflow.com/questions/857973/linq-to-entities-sql-in-clause)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T01:55:49.680

试试这个：

```
var orders = myOrders.SelectMany(item => (from f in ORDERS
                                          where f.ORDERS ==item.ORDER_ID 
                                          && f.ORDERS_SUFFIX==item.LINE
                                          select f.Something)); 
```

# ruby - 在 Ruby 中继承类级别的实例变量？

> ID：10728735
> 
> 赞同：20
> 
> 时间：2012-05-23T22:24:47.793
> 
> 标签：ruby, oop, inheritance, scope, instance-variables

我希望一个子类从其父类继承一个类级实例变量，但我似乎无法弄清楚。基本上我正在寻找这样的功能：

```
class Alpha
  class_instance_inheritable_accessor :foo #
  @foo = [1, 2, 3]
end

class Beta < Alpha
  @foo << 4
  def self.bar
    @foo
  end
end

class Delta < Alpha
  @foo << 5
  def self.bar
    @foo
  end
end

class Gamma < Beta
  @foo << 'a'
  def self.bar
    @foo
  end
end 
```

然后我希望它像这样输出：

```
> Alpha.bar
# [1, 2, 3]

> Beta.bar
# [1, 2, 3, 4]

> Delta.bar
# [1, 2, 3, 5]

> Gamma.bar
# [1, 2, 3, 4, 'a'] 
```

显然，这段代码不起作用。基本上我想为父类中的类级实例变量定义一个默认值，它的子类继承。子类的更改将成为子类的默认值。我希望这一切都发生，而不会改变一个类的值来影响其父级或兄弟级。Class_inheritable_accessor 给出了我想要的行为......但是对于一个类变量。

我觉得我可能要求太多了。有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-24T00:18:18.573

[Rails 将其作为一个名为class_attribute](http://api.rubyonrails.org/classes/Class.html#method-i-class_attribute)的方法内置到框架中。您可以随时查看[该方法的源代码](https://github.com/rails/rails/blob/45d6cd94b3ef2ec77166def41f29188445b35608/activesupport/lib/active_support/core_ext/class/attribute.rb)并制作自己的版本或逐字复制。唯一需要注意的是，您[不要更改原地的可变项](https://stackoverflow.com/a/6618620/167614)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-12T23:28:18.140

我在我的项目中使用 resque 所做的是定义一个基础

```
class ResqueBase
  def self.inherited base
    base.instance_variable_set(:@queue, :queuename)
  end
end 
```

在其他子作业中，将默认设置队列实例。希望它可以提供帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-24T00:50:48.717

使用混合：

```
module ClassLevelInheritableAttributes
  def self.included(base)
    base.extend(ClassMethods)    
  end

  module ClassMethods
    def inheritable_attributes(*args)
      @inheritable_attributes ||= [:inheritable_attributes]
      @inheritable_attributes += args
      args.each do |arg|
        class_eval %(
          class << self; attr_accessor :#{arg} end
        )
      end
      @inheritable_attributes
    end

    def inherited(subclass)
      @inheritable_attributes.each do |inheritable_attribute|
        instance_var = "@#{inheritable_attribute}"
        subclass.instance_variable_set(instance_var, instance_variable_get(instance_var))
      end
    end
  end
end 
```

在一个类中包含这个模块，给它两个类方法：inheritable_attributes 和inherited。
继承的类方法与所示模块中的 self.included 方法的工作方式相同。每当包含此模块的类被子类化时，它都会为每个声明的类级别可继承实例变量（@inheritable_attributes）设置一个类级别实例变量。

# jquery-ui - 防止 flexcroll on 事件

> ID：10728737
> 
> 赞同：1
> 
> 时间：2012-05-23T22:24:53.217
> 
> 标签：jquery-ui

我目前拥有的是一个非常简单的 div，它有一个 flexcroll 滚动条。这个简单的 div 在其中包含一些可拖动的项目。我的目标是能够拖动其中一个项目并在不移动 flexcroll 滚动条的情况下移动它。

就目前而言，如果我要拖动可视区域下方的项目之一，简单的 div 将向下滚动。我想防止这种情况。

我将 jQuery UI 用于可拖动项目。我已经尝试过使用“scroll:false”选项，但这不适用于 flexcroll。

对不起，我没有任何示例代码，我目前不在我的工作电脑旁。

flexcroll：[http ://www.hesido.com/web.php?page=customscrollbar](http://www.hesido.com/web.php?page=customscrollbar)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T13:06:24.220

我不知道你是否已经解决了这个问题。今天早上，我有同样的问题，我找到了你的帖子。在那之后，我在谷歌上搜索了很多以找到解决方案，但没有任何运气。所以最后，我决定自己做一些事情，希望我的想法对你有帮助。

看了[Programming Guid](http://www.hesido.com/flexcroll/flexcroll-programming.htm)后发现，在这个版本（2.0）的flexcroll中，我们可以为onfleXcroll注册一个函数，可以通过搜索关键字“Pseudo-event: onfleXcroll”找到其描述。也就是说，该方法将在滚动完成后执行。所以在这里，我在拖动元素之前使用值恢复“顶部”样式。

这是代码

```
var $assetswrapper; // This variable indicates the contentwrapper of you div.
var $assetsscrollbar; // This variable indicates the vscroller of you div.
window.onfleXcrollRun = function () { // This method will be executed as soon as the div has been rendered with the help of flexcroll
// You could find these two divs by using firebug, because the top value of these two divs will be changed when we scroll the div which use the class .flexcroll.
$assetswrapper = $('#contentwrapper');
$assetsscrollbar = $('#vscrollerbar');
}

var wrapperTopPosition = 0; // This is used to stock the top value of the wrapperContent before dragging.
var scrollbarTopPosition = 0; // This is used to stock the top value of the scrollbar before dragging.
var dragged; // This is a boolean variable which is used for indicating whether the draggable element has been dragged.
var dropped = false; // This is a boolean variable which used to say whether the draggable element has been dropped.
$('.draggable').draggable({ // you could change .draggable with any element.
start: function (event, ui) {
    // Your code here.

    wrapperTopPosition = $assetswrapper.position().top;
    scrollbarTopPosition = $assetsscrollbar.position().top
    dragged = true;
},
stop: function (event, ui) {
    // Your code here.

    dragged = false;
    dropped = true;
}
});

$('your drag div')[0].onfleXcroll = function () { // This method will be called each time when a scroll has been done.
if (dragged) {
    $assetswrapper.css('top', wrapperTopPosition);
    $assetsscrollbar.css('top', scrollbarTopPosition);
} else {
    // Code here is used for keeping the top position as before even though you have dragged an element out of this div for a long time.
    // You could test the scrollbar without this piece of code, if you drag an element out of the div for a long time, the scrollbar will keep its position, 
    // but after you dropped this element and try to scroll the div, then the scrollbar will reach the end of the div. To solve this problem,
    // I have introduced the method setScrollPos with the old top position plus 72\. 72 here is to set the scroll increment for this scroll, I know 
    // this value is not fit for any size of windows, but I don't know how to get the scroll-increment automatically.
    if (dropped) {
        dropped = false;

        $('your drag div')[0].fleXcroll.setScrollPos(false, Math.abs(wrapperTopPosition) + 72);
        $('your drag div')[0].fleXcroll.setScrollPos(false, Math.abs(wrapperTopPosition) + 72);
    }
}
}; 
```

如果您还没有找到任何解决方案，我希望这可以为您提供帮助。

# c# - C# 向 SQL 表中插入数据

> ID：10728742
> 
> 赞同：0
> 
> 时间：2012-05-23T22:25:25.537
> 
> 标签：c#, .net, sql-server

我得到 sqlException 未处理。'nvarchar' 附近的语法不正确和 'Name' 附近的语法不正确。我使用 SMO 创建了一个这样的表

```
Table TechOpsProjectTracker = new Table(db, "TechOpsProjectTracker");

//Add column ID
DataType dt = new DataType(SqlDataType.Int);
Column idColumn = new Column(TechOpsProjectTracker, "ID", dt);
TechOpsProjectTracker.Columns.Add(idColumn);

//Add Column Alignment
DataType dt1 = new DataType(SqlDataType.NVarChar, 50);
Column Column1 = new Column(TechOpsProjectTracker, "Alignment", dt1);
TechOpsProjectTracker.Columns.Add(Column1);

//Add Column Project Name
DataType dt2 = new DataType(SqlDataType.NVarChar, 50);
Column Column2 = new Column(TechOpsProjectTracker, "Project Name", dt2);
TechOpsProjectTracker.Columns.Add(Column2);

//Add Column Project Description
DataType dt3 = new DataType(SqlDataType.NVarChar, 255);
Column Column3 = new Column(TechOpsProjectTracker, "Project Description", dt3);
TechOpsProjectTracker.Columns.Add(Column3);

//Add Column Currently Assigned To
DataType dt4 = new DataType(SqlDataType.NVarChar, 50);
Column Column4 = new Column(TechOpsProjectTracker, "Currently Assigned To", dt4);
TechOpsProjectTracker.Columns.Add(Column4);
TechOpsProjectTracker.Create();

string connectionString = "Server=GSOPS4;Database=MyDatabaseName;Trusted_Connection=True;";

System.Data.SqlClient.SqlConnection sqlConnection1 = 
  new System.Data.SqlClient.SqlConnection(connectionString);

System.Data.SqlClient.SqlCommand cmd = 
  new System.Data.SqlClient.SqlCommand();
cmd.CommandType = System.Data.CommandType.Text;
cmd.CommandText = "INSERT TechOpsProjectTracker (ID, Alignment, Project Name, Project Description, Currently Assigned To ) VALUES (@ID, @Alignment, @Project Name, @Project Description, @Currently Assigned To)";

SqlParameter ID = new SqlParameter("@ID", SqlDbType.Int);
ID.Value = 5;
cmd.Parameters.Add(ID);

SqlParameter Alignment = new SqlParameter("@Alignment", SqlDbType.NVarChar, 50);
Alignment.Value = "Right";
cmd.Parameters.Add(Alignment);

SqlParameter ProjectName = new SqlParameter("@Project Name", SqlDbType.NVarChar, 50);
ProjectName.Value = "Right Project Name";
cmd.Parameters.Add(ProjectName);

SqlParameter ProjectDesc = new SqlParameter("@Project Description", SqlDbType.NVarChar, 255);
ProjectDesc.Value = "Right Project Description";
cmd.Parameters.Add(ProjectDesc);

SqlParameter Assignment = new SqlParameter("@Alignment", SqlDbType.NVarChar, 50);
Assignment.Value = "corp\\shress2";
cmd.Parameters.Add(Assignment); 

cmd.Connection = sqlConnection1;
sqlConnection1.Open();
cmd.ExecuteNonQuery();
sqlConnection1.Close(); 
```

我得到这些异常的`cmd.ExecuteNonQuery();` 任何原因可能是什么原因造成的？TIA

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T22:33:08.857

有几个问题。

您的`INSERT`语句在列名中有空格，因此您必须将它们括在括号中。
此外，参数名称中不能有空格，因此您需要将单词粘在一起。

```
cmd.CommandText = "INSERT TechOpsProjectTracker (ID, Alignment, [Project Name], [Project Description], [Currently Assigned To] ) VALUES (@ID, @Alignment, @ProjectName, @ProjectDescription, @CurrentlyAssignedTo)"; 
```

然后，当你添加参数时，同样的事情，把这些词粘在一起：

```
SqlParameter ProjectName = new SqlParameter("@ProjectName", SqlDbType.NVarChar, 50);
ProjectName.Value = "Right Project Name";
cmd.Parameters.Add(ProjectName);

SqlParameter ProjectDesc = new SqlParameter("@ProjectDescription", SqlDbType.NVarChar, 255);
ProjectDesc.Value = "Right Project Description";
cmd.Parameters.Add(ProjectDesc); 
```

# javascript - 如何从另一个函数启动一个javascript函数

> ID：10728744
> 
> 赞同：0
> 
> 时间：2012-05-23T22:25:38.337
> 
> 标签：javascript, function

我不知道这有多简单，但我试图弄清楚如何从函数中调用函数。

我有一个 JavaScript 来在页面上显示一个 DIV，我有另一个 JavaScript 使用 appendchild 来调用图像。我的问题是在执行第一个 JavaScript 之前我无法加载该图像。这不仅仅是显示或不显示之前的图像，我需要仅在加载第一个 JavaScript 后调用图像。

该图像是动态生成的，用于跟踪显示 DIV 的动作。如果我让浏览器在操作之前加载图像，它将破坏跟踪目的。

加载 DIV 后我要加载的代码：

```
function MonitorDIVExpand() {
    var img = document.createElement('img');
    img.src = "http://dynamically generated image";
    ClickExpandArea.appendChild(img);
} 
```

这是显示 de DIV 的那个：

```
function ShowDIV() {
    document.getElementById('div').style.clip='rect(0px, ' + width_xp + 'px, ' + height_xp + 'px, 0px)';
    document.getElementById('div').style.width=width_xp + 'px';
    document.getElementById('div').style.display='block';
    document.getElementById('div').style.overflow='visible';
} 
```

然后我有这个 div 来调用图像：

```
<div id="ClickExpandArea"></div> 
```

这是一种方法吗？？？提前谢谢你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:26:44.473

只需`MonitorDIVExpand()`在末尾添加`ShowDIV()`（就在结束之前`}`）

# javascript - 在 Facebook 提要对话框（js 版本）中使用来自外部 js 脚本的 javascript var

> ID：10728745
> 
> 赞同：0
> 
> 时间：2012-05-23T22:25:42.213
> 
> 标签：javascript, jquery, facebook, facebook-javascript-sdk

我希望这是可能的。我有一个 HTML 文件，它使用以下方法加载一个 js 文件：`<script src="js.js"></script>` 在这个脚本中有一个 var：`var score = 0;`当人们获得积分时，这个 var 会发生变化。

现在在同一个 HTML 文件中，我添加了以下对话框脚本（另请参阅[https://developers.facebook.com/docs/reference/dialogs/feed/](https://developers.facebook.com/docs/reference/dialogs/feed/)了解更多信息）：

```
FB.init({appId: "xxxxxxxxxxxxx", status: true, cookie: true});

function postToFeed() {
    // calling the API ...
var obj = {
        method: 'feed',
    link: 'https://developers.facebook.com/docs/reference/dialogs/',
    picture: '',
    name: 'I just got a new high score of [xx] points!',
    caption: 'Think you can do better?',
    description: 'Join me.'
};

function callback(response) {
    document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];
}

FB.ui(obj, callback);
} 
```

该脚本有效，并出现对话框。现在，`[xx] points`我想展示人们获得的积分。

我尝试了以下方法：

`<input type="text" id="score" name="score" value="0" readonly />`使用js.js 文件将 var 结果推送到输入字段`$('#score').val(document.getElementById('sc').innerHTML);`，结果分数显示在输入字段中。

然后尝试了`[xx]`part: `' + document.getElementById('score').innerHTML + '`，但这没有用。也许这种方法是错误的，有更好的方法，但我怎样才能在对话框中显示分数？

亲切的问候，

莫里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:20:21.903

据我所知，您的描述`score`是一个全局变量。您可以执行以下操作：

```
var obj = {
    method: 'feed',
    link: 'https://developers.facebook.com/docs/reference/dialogs/',
    picture: '',
    name: 'I just got a new high score of ['+ score +'] points!',
    caption: 'Think you can do better?',
    description: 'Join me.'
}; 
```

# python-3.x - Python3 split() 与生成器

> ID：10728747
> 
> 赞同：5
> 
> 时间：2012-05-23T22:25:55.793
> 
> 标签：python-3.x

在 Python3 中，许多方法都返回迭代器或生成器对象（而不是 Python2 中的列表或其他重对象）。

但是，我发现拆分字符串仍然返回`list`而不是`generator`or `iteator`：

```
~$ python3
Python 3.2.2
(...)
>>> type('a b c d'.split())
<class 'list'> 
```

是否有使用`generator`or分割字符串的内置函数`iterator`？

（我知道我们可以自己拆分它并编写好的生成器函数。我很好奇标准库或语言中是否有东西可以做到这一点）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T23:01:08.630

查看`re.finditer`re 模块 => [Python Docs](http://docs.python.org/py3k/library/re.html#re.finditer)

简单来说：

""" 返回一个迭代器，在字符串中的 RE 模式的所有非重叠匹配上产生匹配对象。从左到右扫描字符串，并按找到的顺序返回匹配。空匹配包含在结果中，除非它们触摸另一场比赛的开始。"""

我认为它会做你需要的。例如：

```
import re
text = "This is some nice text"
iter_matches = re.finditer(r'\w+', text)
for match in iter_matches:
    print(match.group(0)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-16T10:54:18.790

基于正则表达式的答案很小，但对于那些还是新手并想写一个的人来说，这是一种方法：

```
import string

def gsplit(s,sep=string.whitespace):
    word = []

    for c in s:
        if c in sep:
            if word:
                yield "".join(word)
                word = []
        else:
            word.append(c)

    if word:
        yield "".join(word)

text = "This is some nice text"

print(type(gsplit(text)))

for i in (gsplit(text)):
    print(i) 
```

```
<class 'generator'>
This
is
some
nice
text

[Program finished] 
```

# java - 如何在 GUI 上放置基于 system.out.print 的文本界面？- JAVA -

> ID：10728748
> 
> 赞同：0
> 
> 时间：2012-05-23T22:25:59.693
> 
> 标签：java, user-interface, text, graphic, windowbuilder

我为大学做了一个项目（这是 Zork the Game 的个人实现）。按照要求，我使用 system.out.print 使用文本界面进行操作。有没有办法“将文本界面放在 GUI 中”？我的意思是一个简单的窗口，它有 2 个字段，一个显示文本输出，一个用于通过键盘输入的文本。

我为 Eclipse 下载了 windowsBuilder 但是.. 我不知道该怎么做！:(

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:18:18.397

当然有，只需更改 System 类的输出流。创建一个 PrintStream，它将您的数据写入您的摆动组件，然后在 System 类中替换它以使用它。

```
System.setOut(printStream); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T20:49:28.943

如果您正在为文本游戏执行此操作，我建议您使用[Glk](http://www.eblong.com/zarf/glk/)库。Glk 是为文本游戏设计的跨平台窗口 I/O 系统。您可能必须编写 JNI 接口，因为这些库往往是用 C 编写的：一个名为[GlkJNI](http://code.google.com/p/glkjni/)的现有项目旨在以相反的方式工作，因此 C 程序可以使用 Java UI，但无论如何它可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T03:55:15.193

有关如何创建执行您所要求的 GUI 的示例，请查看本文： http: [//www.comweb.nl/java/Console/Console.html](http://www.comweb.nl/java/Console/Console.html)

这不*使用*构建 GUI 的最佳实践，但为了快速和肮脏，它将帮助您入门。但是，如果这将是您认真对待的事情，那么您确实应该阅读有关如何正确编写 Swing 应用程序的内容。

# c++ - 访问冲突读取位置。堆损坏。提升线程

> ID：10728749
> 
> 赞同：0
> 
> 时间：2012-05-23T22:26:09.053
> 
> 标签：c++, multithreading, boost, heap-memory, heap-corruption

我正在尝试使用 boost、raknet 和 irrlicht 创建一个多线程图形网络应用程序。我使用一个接收消息的线程和另一个线程来处理消息和所有图形工作。

这是我得到的错误屏幕

> NetSystemForVideogamesServerTester.exe 中 0x77183c8d 处的第一次机会异常：0xC0000005：访问冲突读取位置 0x0d99d472

这是输出窗口信息

> HEAP[NetSystemForVideogamesServerTester.exe]：HEAP：释放堆块 da58d10 在 da58fe0 被释放后修改 Windows 已触发 NetSystemForVideogamesServerTester.exe 中的断点。
> 
> 这可能是由于堆损坏，这表明 NetSystemForVideogamesServerTester.exe 或其已加载的任何 DLL 中存在错误。
> 
> 这也可能是由于用户在 NetSystemForVideogamesServerTester.exe 具有焦点时按 F12。
> 
> 输出窗口可能有更多诊断信息。

这是我启动线程的时候

```
void receive()
    {       
        boost::thread(&IConnectionInstance::receiveInThread, this);
    } 
```

互斥声明

```
boost::mutex mMessagesReceived; 
```

这是来自接收线程的代码

```
void RakNetConnectionInstance::receiveInThread()
{
    Packet* packet;
    IMessage* message = NULL;   
    long time = 0;

    while (true)
    {
        message = NULL;
        packet = aPeer->Receive();  

        while (packet)
        {           
            RakNet::BitStream* dataStream = new RakNet::BitStream(packet->data, packet->length, false);
            dataStream->IgnoreBits(sizeof(unsigned char)*8);    

            switch (packet->data[0])
            {               

            case ID_TIMESTAMP:
                {
                    dataStream->Read(time);
                    int countMessagesAggregated = 0;
                    dataStream->Read(countMessagesAggregated);
                    unsigned char messageType = char();

                    IBitStream* bitStream = new RakNetBitStream(dataStream);

                    while(countMessagesAggregated > 0)
                    {                       
                        dataStream->Read(messageType);

                        switch ((EMESSAGE_TYPE)messageType)
                        {
                        case EACTOR_CONTENT_MESSAGE:                            
                            message = new CActorContentMessage(aUserDataFactory);                           
                            break;
                        case EWORLD_CONTENT_MESSAGE:                            
                            message = new CWorldClientContentMessage(aUserDataFactory);                         
                            break;                                                  
                        case EUSER_COMMAND_MESSAGE: 
                            message = new CUserCommandMessage(aEventFactory);                           
                            break;
                        case EPREDICTION_MESSAGE:
                            message = new CPredictionMessage(aUserDataFactory);                         
                            break;
                        case EPREDICTION_RESPONSE_MESSAGE:
                            message = new CPredictionResponseMessage(aUserDataFactory);                     
                            break;
                        }

                        countMessagesAggregated --; 

                        if (messageType >= EUSER_MESSAGE && aCustomReceiver)
                        {
                            aCustomReceiver->receiveCustomMessages();
                        }

                        if (message)
                        {
                            message->readFromBitStream(bitStream);
                            message->setTimeMS(time);   
                            message->setIPAddress(packet->systemAddress.ToString(false));
                            message->setPort(packet->systemAddress.port);

                            mMessagesReceived.lock();
                            aMessagesReceivedQueue.push(message);
                            printf("adicionando mensaje a cola en lock\n");
                            mMessagesReceived.unlock();
                            message = NULL;
                        }
                    }                                       
                }
                break;
            }

            if (message)
            {
                message->setTimeMS(time);   
                message->setIPAddress(packet->systemAddress.ToString(false));
                message->setPort(packet->systemAddress.port);

                mMessagesReceived.lock();
                aMessagesReceivedQueue.push(message);
                mMessagesReceived.unlock();
            }

            aPeer->DeallocatePacket(packet);
            packet = aPeer->Receive();              
        }
        if (RakNet::GetTimeMS() - aBeginTimeSearchServersActives > aWaitTimeServersActives && !aTimeOut)
        {
            boost::mutex::scoped_lock lock(mTimeOut);
            aTimeOut = true;
        }
    }
} 
```

在这里，我在处理线程中处理来自队列的消息

```
void CMessageManager::attendMessages()
{   
    std::queue<IMessage*> messages = aConnectionInstance->getMessagesReceivedFromQueue();

    while(!messages.empty())
    {
        notifyMessage(messages.back());
        aConnectionInstance->popMessageReceivedFromQueue();     
        messages.pop();             
    }       
} 
```

在这里我访问消息队列

```
std::queue<IMessage*> RakNetConnectionInstance::getMessagesReceivedFromQueue()
{       
    boost::mutex::scoped_lock lock(mMessagesReceived);
    std::queue<IMessage*> messages; 
    messages = aMessagesReceivedQueue;
    return messages;
} 
```

最后在这里我从队列中删除消息

```
void RakNetConnectionInstance::popMessageReceivedFromQueue()
{   
    boost::mutex::scoped_lock lock(mMessagesReceived);
    if (!aMessagesReceivedQueue.empty())
    {       
        aMessagesReceivedQueue.pop();               
    }
} 
```

我是 C++ 和多线程的新手，请帮助我，我做错了什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:53:38.273

您不会从原始队列中删除消息，只需将指针复制到新队列即可。所以会发生以下情况：

1.  您收到一条消息。指向它的指针进入队列。

2.  您复制队列、处理消息并将其删除。

3.  您收到另一条消息。

4.  你复制队列。它仍然包含指向第一条消息的指针。

5.  您访问指向您删除的第一条消息的指针。

此代码已损坏，因为它复制了未修改原始队列的队列：

```
std::queue<IMessage*> RakNetConnectionInstance::getMessagesReceivedFromQueue()
{       
    boost::mutex::scoped_lock lock(mMessagesReceived);
    std::queue<IMessage*> messages; 
    messages = aMessagesReceivedQueue;
    return messages;
} 
```

# ruby - 如何在 Ironruby 中使用 Ruby 库

> ID：10728750
> 
> 赞同：2
> 
> 时间：2012-05-23T22:26:15.787
> 
> 标签：ruby, ironruby

我想在 Ironruby 中使用传统的 Ruby 库（1.8.6）。我有问题。例如，“require 'thread'”似乎不适用于 Ironruby 脚本。我需要将 ruby​​ 库放在 Ironruby lib 文件夹中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T19:06:09.733

IronRuby 使用 igem，您可以使用 igem ENV 检查 gems 的位置，并使用 igem install 安装缺少的宝石。

```
 C:\devkit\home\demo>igem ENV
RubyGems Environment:
  - RUBYGEMS VERSION: 1.3.7
  - RUBY VERSION: 1.9.2 (2010-08-18 patchlevel 0) [i386-mswin32]
  - INSTALLATION DIRECTORY: C:/Program Files (x86)/IronRuby 1.1/Lib/ruby/gems/1.
9.1
  - RUBY EXECUTABLE: "C:/Program Files (x86)/IronRuby 1.1/bin/ir.exe"
  - EXECUTABLE DIRECTORY: C:/Program Files (x86)/IronRuby 1.1/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - universal-dotnet-4.0
  - GEM PATHS:
     - C:/Program Files (x86)/IronRuby 1.1/Lib/ruby/gems/1.9.1
     - C:/Users/Ronda/.gem/ironruby/1.9.1
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://rubygems.org/

C:\devkit\home\demo>ir
IronRuby 1.1.3.0 on .NET 4.0.30319.239
Copyright (c) Microsoft Corporation. All rights reserved.

>>> require 'thread'
=> true 
```

# php - 在接受它作为上传之前获取远程图像尺寸？getimagesize() 太慢了

> ID：10728752
> 
> 赞同：0
> 
> 时间：2012-05-23T22:26:31.330
> 
> 标签：php

我一直在使用 getimagesize() 来获取用户正在上传的图像的尺寸，然后检查是否有足够的内存来处理这个图像。问题是 getimagesize() 在读取尺寸之前将文件下载到服务器。所以它的第 22 个问题。这一定是一个非常普遍的问题，但我还没有遇到一个通用的解决方案。有没有一种可靠的方法可以在不下载的情况下获得远程图像尺寸？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:29:11.230

发送`HEAD`图像的 HTTP 请求。这将为您提供响应标头，但不会发送实际的正文（图像）。

然后，阅读这些标题并查找`Content-Length`. 这是一个以字节为单位显示图像大小的数字。使用它，您可以确定是否有足够的内存来处理图像，在这种情况下，您可以重复请求`GET`（`getimagesize()`基本上就是这样做的）

# ios - 如何使用 AVFoundation 从 mp4 视频中提取（或“解复用”）字幕？

> ID：10728755
> 
> 赞同：23
> 
> 时间：2012-05-23T22:26:49.553
> 
> 标签：ios, avfoundation, subtitle

我正在尝试创建一个小程序，它将获取 mp4 视频并使用 AVFoundation 框架从视频中提取字幕信息。这样做时，它将创建并返回格式为 startTimeOfSubtitle、endTimeofSubtitle 和 subtitleString 的 NSDictionary 元素的 NSArray。

这是我从 AVFoundation 的发行说明中收集到的。任何代码示例将不胜感激。

提前致谢。

> ## 根据语言和其他标准选择音频和字幕媒体
> 
> AVFoundation 现在提供的功能可用于发现视听媒体资源可能提供的选项，以适应不同的语言偏好、可访问性要求、自定义应用程序配置和其他需求，并选择这些选项进行播放。例如，一个资源可能包含多个可听选项，每个选项都有以不同语言说出的对话，以被选择用于播放而排除其他选项。也可以为诸如字幕之类的易读媒体提供多种语言的类似选项。基于文件的内容和 HTTP Live Streaming 内容都可以提供媒体选项。要获取有关 AVAsset 实例提供的选项组的信息： • 使用 AVAsynchronousKeyValueLoading 加载 AVAsset 键 availableMediaCharacteristicsWithMediaSelectionOptions 的值。
> 
> • 可以通过-[AVAsset mediaSelectionGroupForMediaCharacteristic:] 获得具有感兴趣的媒体特征的每组互斥选项。要获取可听选项，请通过 AVMediaCharacteristicAudible 等。每个组由 AVMediaSelectionGroup 的实例表示。组中的每个选项都由 AVMediaSelectionOption 的实例表示。这两个类都在 AVMediaSelectionGroup.h 中定义。
> 
> 要检查组中的可用选项并过滤它们以进行播放选择： • AVMediaSelectionGroup 提供了 AVMediaSelectionOptionFiltering 类别中的方法，根据选项是否可播放、匹配所需的区域设置或是否具有对 AVMediaSelectionOptions 数组执行常见过滤操作或者没有特殊的媒体特征，例如它们是否提供特定的可访问性功能。指示存在可用于过滤媒体选择选项的可访问性功能的媒体特征已在 AVMediaFormat.h 中定义。
> 
> • AVMediaSelectionOption 提供有关可用于在用户界面中显示的选项的信息，允许用户在可用选项中进行选择或在客户端定义的过滤操作的实施中进行选择。作为使用自定义媒体资源的应用程序中客户端定义的过滤选项的示例，只有当其关联的元数据包含特定值时，才可以将选项视为有资格选择。
> 
> • 要选择组内的特定选项进行播放，请使用-[AVPlayerItem selectMediaOption:inMediaSelectionGroup:]。要发现当前选择播放的选项，请使用 -[AVPlayerItem selectedMediaOptionInMediaSelectionGroup:]。
> 
> ## 关于字幕的建议
> 
> 在向用户显示可供回放的可读选项中的选项以及根据用户偏好在可用的可读选项中进行选择时，应特别小心。一些清晰的内容包含“强制”字幕，这意味着根据内容作者的意图，当用户既没有表示对显示字幕的偏好也没有明确选择字幕选项时，应该显示字幕。强制字幕通常用于以内容提供者假定不会被普遍理解的语言传达口语对话或可见文本的含义，然而对话或文本的理解被认为是必不可少的。请确保您的应用程序允许它们按照以下建议正确显示。
> 
> 特征 AVMediaCharacteristicLegible 的 AVMediaSelectionGroup 可以提供两种类型的易读选项：1) 用于显示被认为是可选的易读内容以及被认为是必不可少的内容，以及 2) 仅显示基本易读内容。包含基本内容的清晰 AVMediaSelectionOptions 仅具有媒体特征 AVMediaCharacteristicContainsOnlyForcedSubtitles（在 AVMediaFormat.h 中定义）。当在选择界面中向最终用户提供清晰的显示选项时，或者在考虑根据用户对语言的偏好自动选择字幕选项时，应排除具有特征 AVMediaCharacteristicContainsOnlyForcedSubtitles 的清晰选项。+[AVMediaSelectionOption mediaSelectionOptionsFromArray:
> 
> 如果用户表示不喜欢或不选择清晰的内容，则应用程序应选择具有特征 AVMediaCharacteristicContainsOnlyForcedSubtitles 的播放的清晰选项之一（如果存在）。对于大多数包含强制字幕的清晰选项的资源，可以根据当前的声音选择在其中进行适当的选择。使用 -[AVMediaSelectionOption associatedMediaSelectionOptionInMediaSelectionGroup:] 获取与可听选项关联的清晰选项。如果没有其他方式可供选择，则媒体选择组中第一个带有强制字幕的清晰选项是适当的默认值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-31T07:38:15.163

好吧，我不确定您是否能够获得字幕的开始时间和结束时间...我正在使用以下方法获取有关 HLS 流中的字幕选项的信息。

```
[tmpCurrentAsset loadValuesAsynchronouslyForKeys:[NSArray arrayWithObject:@"tracks"] completionHandler:^{
    dispatch_async(queueForMultipleAudioHandling, ^(void) {
        AVKeyValueStatus postLoadingStatus = [tmpCurrentAsset statusOfValueForKey:@"tracks" error:NULL];
        if (postLoadingStatus == AVKeyValueStatusLoaded)
        {
            AVMediaSelectionGroup * subtitleGroup = [self.mPlayer.currentItem.asset mediaSelectionGroupForMediaCharacteristic:AVMediaCharacteristicLegible];
            if (subtitleGroup) {

                _subtitles = subtitleGroup;

                dispatch_async(dispatch_get_main_queue(), ^{
                    [this createSubtitlePopOver];
                });

            }

        } 
```

首先，您需要重新加载曲目并获取有关 AVMediaCharacteristicLegible 的信息。如果你有这个，你可以像这样提取关于字幕的信息： _subtitles.options 这会给你一个 AVMediaSelectionOption 数组，你可以从中选择。如果你想用 AVMediaSelectionOption 玩更多，你可以在这里继续阅读：[AVMediaSelectionOption 文档](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVMediaSelectionOption_Class/Reference/Reference.html)

希望这有点帮助；）

# vbscript - VBScript 中的复杂条件

> ID：10728756
> 
> 赞同：-1
> 
> 时间：2012-05-23T22:27:08.110
> 
> 标签：vbscript

我有以下代码，如果这是在 C# 或 VB.Net 中，它将按预期应用，但我不确定它是否可以在 VBScript 中工作？

```
 if (sal = "23"  or sal = "6") and error_flag = 0 then 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:47:37.747

是的，它应该可以正常工作。当涉及到诸如此类的基本语法时，VB 就像 VBScript 一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:56:24.310

如果变量“sal”是字符串，则反之亦然，如果不是，则需要从整数值中删除双引号

# python - numpy 函数来聚合时间信号？

> ID：10728757
> 
> 赞同：0
> 
> 时间：2012-05-23T22:27:09.817
> 
> 标签：python, numpy, signals, pandas

我想计算一段时间内某个信号的聚合平均值。我不知道这在科学上是怎么称呼的。

示例：我以 15 分钟的值计算一整年的用电量。我想知道我一天中每小时的平均消耗量（24 个值）。但它更复杂：在 15 分钟的步骤之间有更多的测量值，我无法预测它们在哪里。但是，应该考虑到它们，并使用正确的“重量”。

我写了一个有效的函数，但它非常慢。这是一个测试设置：

```
import numpy as np

signal = np.arange(6)
time = np.array([0, 2, 3.5, 4, 6, 8])
period = 4
interval = 2

def aggregate(signal, time, period, interval):
    pass

aggregated = aggregate(signal, time, period, interval)
# This should be the result: aggregated = array([ 2\.   ,  3.125]) 
```

`aggregated`应该有`period/interval`价值观。这是手动计算：

```
aggregated[0] = (np.trapz(y=np.array([0, 1]), x=np.array([0, 2]))/interval + \
               np.trapz(y=np.array([3, 4]), x=np.array([4, 6]))/interval) / (period/interval)
aggregated[1] = (np.trapz(y=np.array([1, 2, 3]), x=np.array([2, 3.5, 4]))/interval + \
                np.trapz(y=np.array([4, 5]), x=np.array([6, 8]))/interval) / (period/interval) 
```

最后一个细节：它必须高效，这就是为什么我自己的解决方案没有用。也许我忽略了一个 numpy 或 scipy 方法？或者这是熊猫可以做的事情吗？非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T02:30:59.743

我强烈推荐使用 Pandas。这里我使用的是 0.8 版（即将发布）。我认为这接近你想要的。

```
import pandas as p
import numpy as np
import matplotlib as plt

# Make up some data:
time = p.date_range(start='2011-05-23', end='2012-05-23', freq='min')
watts = np.linspace(0, 3.14 * 365, time.size)
watts = 38 * (1.5 + np.sin(watts)) + 8 * np.sin(5 * watts)

# Create a time series
ts = p.Series(watts, index=time, name='watts')

# Resample down to 15 minute pieces, using mean values
ts15 = ts.resample('15min', how='mean')
ts15.plot() 
```

Pandas 可以使用您的数据轻松地做许多其他事情（例如确定您的平均每周能量状况）。检查`p.read_csv()`以读取您的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T01:55:06.593

我认为这非常接近您的需要。我不确定我是否正确解释了区间和周期，但我认为我是在某个常数因子内写的。

```
import numpy as np

def aggregate(signal, time, period, interval):
    assert (period % interval) == 0
    ipp = period / interval

    midpoint = np.r_[time[0], (time[1:] + time[:-1])/2., time[-1]]
    cumsig = np.r_[0, (np.diff(midpoint) * signal).cumsum()]
    grid = np.linspace(0, time[-1], np.floor(time[-1]/period)*ipp + 1)
    cumsig = np.interp(grid, midpoint, cumsig)
    return np.diff(cumsig).reshape(-1, ipp).sum(0) / period 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T13:42:29.923

我根据之前的答案和 pandas 制定了一个完全符合我要求的函数。

```
def aggregate_by_time(signal, time, period=86400, interval=900, label='left'):
"""
Function to calculate the aggregated average of a timeseries by 
period (typical a day) in bins of interval seconds (default = 900s).

label = 'left' or 'right'.  'Left' means that the label i contains data from 
i till i+1, 'right' means that label i contains data from i-1 till i.    

Returns an array with period/interval values, one for each interval
of the period. 

Note: the period has to be a multiple of the interval

"""

def make_datetimeindex(array_in_seconds, year):
    """
    Create a pandas DateIndex from a time vector in seconds and the year.
    """

    start = pandas.datetime(year, 1, 1)
    datetimes = [start + pandas.datetools.timedelta(t/86400.) for t in array_in_seconds]

    return pandas.DatetimeIndex(datetimes)

interval_string = str(interval) + 'S'    
dr = make_datetimeindex(time, 2012)
df = pandas.DataFrame(data=signal, index=dr, columns=['signal'])
df15min = df.resample(interval_string, closed=label, label=label)

# now create bins for the groupby() method
time_s = df15min.index.asi8/1e9
time_s -= time_s[0]
df15min['bins'] = np.mod(time_s, period)

df_aggr = df15min.groupby(['bins']).mean()

# if you only need the numpy array: take df_aggr.values
return df_aggr 
```

# asp.net - 在每次页面刷新时单击 ASP.net 按钮

> ID：10728762
> 
> 赞同：1
> 
> 时间：2012-05-23T22:27:24.420
> 
> 标签：asp.net

我的页面中有一个 asp.net 按钮，单击该按钮后，每当我刷新同一页面时都会一次又一次地单击它。

我试过;

```
if (!IsPostBack)
   {
   .....         
   } 
```

对于按钮的点击功能，但在这种情况下按钮不起作用。

```
 <asp:Button ID="btnCommentSubmit" runat="server" Text="Submit" CssClass="leaveAComment" onclick="btnCommentSubmit_Click" /> 
```

上面是按钮。

```
protected void btnCommentSubmit_Click(object sender, EventArgs e)
    {

        string cityID = BusinessClass.Default.findCityIDByCountryAndCityName(Request.QueryString["city"].ToString(), "url").ToString();
        BusinessClass.Default.makeComment(txtComment.Text, Session["userID"].ToString(), cityID);
        txtComment.Text = null;

    } 
```

这就是功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:30:39.893

如果没有误会，您的问题是在单击按钮后按 F5 时。尝试重新提交表单是正常行为，与 asp.net 无关，但与一般浏览器有关。

F5 导致重新执行对服务器的最后一个请求，在您的情况下是 POST 请求。

避免此问题的一种方法是实现 Web 模式[Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T22:56:07.627

使用一点 JavaScript 即可轻松修复。

```
document.onkeydown = function() {
      if(event.keyCode==116) {
      event.keyCode=0;
      event.returnValue = false;
      }
 } 
```

当您按 F5 时，这将停止重复重新发送。

# javascript - HTML 表格过滤和重排

> ID：10728764
> 
> 赞同：0
> 
> 时间：2012-05-23T22:27:46.307
> 
> 标签：javascript, html, css, ajax, reflow

我有一个非常大的 900 多行的 html 表。我通过循环遍历行并根据过滤器的值隐藏/显示行来启用过滤。

这就是问题所在。当我隐藏/显示 500 多行时，当浏览器忙于回流时，页面变得完全没有响应。我曾尝试在过滤、克隆表格然后替换表格等之前隐藏表格。但无响应仍然是一个问题，因为它阻止了我在浏览器重绘时获得“动画”加载图像。

分页不是一种选择，懒惰滚动也不是。

这是循环：

```
var rows = null;
$("#mavis-filters").find("input:checkbox").on("click", function() {
   var id, i;      
   if (!rows) {
      rows = document.getElementById("taskOverview").querySelectorAll("tr");
   }
   id = this.id; 
   i  = rows.length;

   while (i--) {
      var row = rows[i];
      if (row.dataset.project === id) {
         row.classList.toggle("row-hidden");
      }
   }

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T18:40:26.573

使用渐进式渲染来解决此问题。以下是如何在每个浏览器中应用它：

*   使用[table-layout:fixed](http://www.codinghorror.com/blog/2005/11/the-lost-art-of-progressive-html-rendering.html)启用渐进式渲染
*   在 Firefox/Camino 中，设置`html5.parser.enable=false`about [:config](http://support.mozilla.org/en-US/questions/806893)
*   [优化](http://www.webreference.com/authoring/languages/html/optimize/5.html)表格标记
*   使用[DOM 方法](https://developer.mozilla.org/en-US/docs/Traversing_an_HTML_table_with_JavaScript_and_DOM_Interfaces)而不是 jQuery

# android - 如何在视图中包含 ExpandableListActivity

> ID：10728765
> 
> 赞同：0
> 
> 时间：2012-05-23T22:27:59.683
> 
> 标签：android, android-intent, expandablelistview

我有一个带有 TextViews、ImageViews 的视图......但我想使用 ExpandableList 包含一些数据。我不知道如何将此 ExpandableList 与其他数据一起包含在我的视图中。

我的目标：

![我的观点](../Images/ccfcc58430cbef166c9b1c012337712f.png)

除了我在其他活动中的 ExpandableList 之外，我在一个视图中拥有所有组件：

> **OfferDetailsActivity**（这是显示视图的活动，我想从这里调用 ExpandableList）

```
public class OfferDetailsActivity extends Activity{

final public static String OFERTA = "oferta";
private Oferta oferta = null;

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);     
    setContentView(R.layout.offer_details);             

    oferta = (Oferta)getIntent().getExtras().getParcelable(OFERTA);

    View view = new View(this.getBaseContext());

    LayoutInflater linflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    view = linflater.inflate(R.layout.offer_details, null);

    // poblamos la lista de elementos           
    TextView precio = (TextView)view.findViewById(R.id.precio_offer_details);
    precio.setText(oferta.getPrecio());

    ImageView imagen = (ImageView) view.findViewById(R.id.imagen_offer_details);
    imagen.setImageBitmap(new GetImages().downloadFile(oferta.getImagen()));

    TextView cabecera = (TextView)view.findViewById(R.id.cabecera_offer_details);
    cabecera.setText(oferta.getCabecera());

    TextView descripcion = (TextView)view.findViewById(R.id.descripcion_offer_details);
    descripcion.setText(oferta.getDescripcion());                                                   

    setContentView(view);

} 
```

}

> **展开式列表**

```
public class ExpandableList extends ExpandableListActivity {

@SuppressWarnings("unchecked")
public void onCreate(Bundle savedInstanceState) {
    try{
         super.onCreate(savedInstanceState);
         setContentView(R.layout.offer_details);

    SimpleExpandableListAdapter expListAdapter =
        new SimpleExpandableListAdapter(
                this,
                createGroupList(),              // Creating group List.
                R.layout.group_row,             // Group item layout XML.           
                new String[] { "Group Item" },  // the key of group item.
                new int[] { R.id.row_name },    // ID of each group item.-Data under the key goes into this TextView.                   
                createChildList(),              // childData describes second-level entries.
                R.layout.child_row,             // Layout for sub-level entries(second level).
                new String[] {"Sub Item"},      // Keys in childData maps to display.
                new int[] { R.id.grp_child}     // Data under the keys above go into these TextViews.
            );
        setListAdapter( expListAdapter );       // setting the adapter in the list.

    }catch(Exception e){
        System.out.println("Errrr +++ " + e.getMessage());
    }
}

/* Creating the Hashmap for the row */
@SuppressWarnings("unchecked")
private List createGroupList() {
      ArrayList result = new ArrayList();
      for( int i = 0 ; i < 15 ; ++i ) { // 15 groups........
        HashMap m = new HashMap();
        m.put( "Group Item","Group Item " + i ); // the key and it's value.
        result.add( m );
      }
      return (List)result;
}

/* creatin the HashMap for the children */
@SuppressWarnings("unchecked")
private List createChildList() {

    ArrayList result = new ArrayList();
    for( int i = 0 ; i < 15 ; ++i ) { // this -15 is the number of groups(Here it's fifteen)
      /* each group need each HashMap-Here for each group we have 3 subgroups */
      ArrayList secList = new ArrayList(); 
      for( int n = 0 ; n < 3 ; n++ ) {
        HashMap child = new HashMap();
        child.put( "Sub Item", "Sub Item " + n );           
        secList.add( child );
      }
     result.add( secList );
    }        
    return result;
}
public void  onContentChanged  () {
    System.out.println("onContentChanged");
    super.onContentChanged();         
}
/* This function is called on each child click */
public boolean onChildClick( ExpandableListView parent, View v, int groupPosition,int childPosition,long id) {
    System.out.println("Inside onChildClick at groupPosition = " + groupPosition +" Child clicked at position " + childPosition);
    return true;
}

/* This function is called on expansion of the group */
public void  onGroupExpand  (int groupPosition) {
    try{
         System.out.println("Group exapanding Listener => groupPosition = " + groupPosition);
    }catch(Exception e){
        System.out.println(" groupPosition Errrr +++ " + e.getMessage());
    }
} 
```

}

> **offer_details.xml**

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<TableRow>   
    <TextView android:id="@+id/precio_offer_details"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textStyle="bold"
        android:textSize="12px" />

    <TextView android:id="@+id/cabecera_offer_details"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textStyle="bold"
        android:textSize="12px" />                      
</TableRow>

<TableRow>        
    <ImageView android:id="@+id/imagen_offer_details"        
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" /> 

    <TextView android:id="@+id/descripcion_offer_details"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textStyle="normal"
        android:textSize="10px" />                                          
</TableRow>                               

<TextView android:id="@+id/texto3"      
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:textStyle="normal"
    android:textSize="10px" 
    android:text="texto3"/>

<TextView android:id="@+id/texto4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:textStyle="normal"
    android:textSize="10px" 
    android:text="texto4"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:40:45.987

将代码从可扩展列表活动移动到其他 qctivity 并将必要的位放入其他活动 XML 文件中，您应该没问题...您遇到的一些问题阻止您这样做吗？

# java - java方法错误

> ID：10728767
> 
> 赞同：-3
> 
> 时间：2012-05-23T22:28:05.387
> 
> 标签：java, arrays, methods, return

我有一个任务要做，那就是制作电影档案。以下是我的任务：

> 除了主程序之外，创建一个自定义类来存储有关电影的信息。然后在主程序中使用这个类。应为每部电影存储以下信息

```
title
length
grade 
format
year 
```

然后

> 在主程序中，您应该能够存储 1,000 部电影。用户应该能够在程序中执行以下操作（进行选择菜单）：
> 
> • 输入有关电影的信息。制作一个从用户加载电影的方法。
> 
> • 打印所有胶片的信息。制作一种打印胶片的方法并使用它。
> 
> • 将所有电影保存到文件中。请为此做你自己的方法。
> 
> • 从文件下载电影。请为此做你自己的方法。

问题是我的`skrivUtInfo(PrintOut information)`方法有误

我创建了一个包含 1000 部电影的数组列表。但是我怎样才能打印 1000 部电影呢？

这是我的代码：

```
public class Film {
    String  title ;
    int     length;
    int     grade ;
    String  format ;
    int     year ;
}

import java.util.*;
import java.io.*;

public class Filmarkiv {

    static Scanner sc = new Scanner(System.in);

    public static void main(String[] arg) {

        BufferedReader inFromUser = new BufferedReader(new InputStreamReader(System.in));
        Scanner s = new Scanner(inFromUser);

        Film[] film = new Film[1000];

        int antal = 1;

        film[0] = new Film();
        film[0].title = "matrix";
        film[0].length = 220;
        film[0].grade = 5;
        film[0].format = "DVD";
        film[0].year = 1999;

        while(true)
        {
            int n = 0;
            System.out.println("valj 1 for inmata. 2 for utskrift");

            String val = s.next();

            if(val.equals("1")){
                System.out.println("vad heter filmen?");
                film[n].title = s.next();

                System.out.println("hur lang ar filmen?");
                film[n].length = s.nextInt();

                System.out.println("vad har den for betyg?");
                film[n].grade = s.nextInt();

                System.out.println("vad har den for format?");
                film[n].format = s.next() ;

                System.out.println("i vilket år har filmen inspelat? ");
                film[n].year = s.nextInt() ;
            }
            else if (val.equals("2"))
            {
                skrivUtInfo(film, antal);

                /*System.out.println("title = "+film[n].title) ;
                System.out.println("length = "+film[n].length) ;
                System.out.println("grade = "+film[n].grade) ;
                System.out.println("format = "+film[n].format) ;
                System.out.println("year = "+film[n].year);*/
            }
        }
    }

    public  skrivUtInfo (Film[]  qwert, int a) {
        for (int n=0; n<a; n++) {
            System.out.println("title = "+film[n].title) ;
            System.out.println("length = "+film[n].length) ;
            System.out.println("grade = "+film[n].grade) ;
            System.out.println("format = "+film[n].format) ;
            System.out.println("year = "+film[n].year) ;

            return Film[];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:32:55.087

如果你已经了解了`java.util.List`，你可以这样做：

```
List<Film> films = new ArrayList<Film>();
films.add(new Film("Amadeus", 120, 5, "DVD", 1984);  );  // Add as many as you like
System.out.println(films);  // Make sure your Film class overrides toString() 
```

如果还没有，请循环执行：

```
Film [] films = new Film[1000];
films[0] = new Film("Amadeus", 120, 5, "DVD", 1984);  
for (Film film : films) {
    System.out.println(film);  // Make sure you File class overrides toString()

} 
```

你可能有问题，因为你的电影课有缺陷。这样做：

```
public class Film {

    private final String  title ;
    private final int     length;
    private final int     grade ;
    private final String  format ;
    private final int     year ;

    public Film(String title, int length, int grade, String format, int year) {
        this.title = title;
        this.length = length;
        this.grade = grade;
        this.format = format;
        this.year = year;
    }

    public String getTitle() {
        return title;
    }

    public int getLength() {
        return length;
    }

    public int getGrade() {
        return grade;
    }

    public String getFormat() {
        return format;
    }

    public int getYear() {
        return year;
    }

    @Override
    public String toString() {
        final StringBuilder sb = new StringBuilder();
        sb.append("Film");
        sb.append("{title='").append(title).append('\'');
        sb.append(", length=").append(length);
        sb.append(", grade=").append(grade);
        sb.append(", format='").append(format).append('\'');
        sb.append(", year=").append(year);
        sb.append('}');
        return sb.toString();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:44:43.967

您必须将方法更改为

```
public static void skrivUtInfo (Film[] qwert) {
    for (int n=0; n<qwert.length; n++) {
        System.out.println("title = "+qwert[n].title) ;
        System.out.println("length = "+qwert[n].length) ;
        System.out.println("grade = "+qwert[n].grade) ;
        System.out.println("format = "+qwert[n].format) ;
        System.out.println("year = "+qwert[n].year) ;
    }
} 
```

也在这里放一个括号

```
else if (val.equals("2"))
{
    skrivUtInfo(film);
    // the comments
}
} //<- you must add this bracket. is from while (i think) 
```

还有一个提示，在 Film 类中，您可以覆盖 Object 类中的 toString 方法

```
public class Film{
    String  title ;
    int     length;
    int     grade ;
    String  format ;
    int     year ;

    public String toString() {
     return "title = " + title +
            "length = " + length +
            "grade = " + grade +
            "format = " + format +
            "year = " + year;

    }
} 
```

所以 skrivUtInfo 变成

```
public static void skrivUtInfo (Film[] qwert) {
    for (int n=0; n<qwert.length; n++) {
        System.out.println(qwert[n]);
    }
} 
```

或者

```
public static void skrivUtInfo (Film[] qwert) {
    for (Film f : qwert) {
        System.out.println(f);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T22:33:59.917

该方法`public skrivUtInfo (Film[] qwert, int a)`没有指定返回类型。在java中，它应该有一个`void`或一个有效的类型作为返回，但我看到你返回`Film[]`。你不能那样做。你必须声明像

```
 public Film[] skrivUtInfo (Film[]  qwert, int a){
   ....
   return qwert;
 } 
```

最终，因为您只是在这里打印东西，所以您不需要返回任何东西。在这种情况下，你应该有

```
 public  void skrivUtInfo (Film[]  qwert, int a){
   .....
   return;
 } 
```

您可以在具有`void`返回类型的方法中指定空返回或不返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T20:20:19.397

我已经测试了这段代码并且工作正常。我改变了一些部分，因为我认为它应该播放

```
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.Scanner;

public class Filmarkiv {
    static Scanner sc = new Scanner(System.in);

    public static void main(String[] arg) {
        BufferedReader inFromUser = new BufferedReader(new InputStreamReader(System.in));
        Scanner s = new Scanner(inFromUser);

        Film[] film = new Film[1000];
        int n = 0;

        do {
            System.out.println("valj 1 for inmata. 2 for utskrift");
            String val = s.next();

            if (val.equals("1")) {
                film[n] = new Film();

                System.out.println("vad heter filmen?");
                film[n].title = s.next();

                System.out.println("hur lang ar filmen?");
                film[n].length = s.nextInt();

                System.out.println("vad har den for betyg?");
                film[n].grade = s.nextInt();

                System.out.println("vad har den for format?");
                film[n].format = s.next();

                System.out.println("i vilket år har filmen inspelat? ");
                film[n].year = s.nextInt();

                n++;
            } else if (val.equals("2")) {
                skrivUtInfo(film);
            }
        } while(n < film.length);

    }

    public static void skrivUtInfo (Film[] qwert) {
        for (Film f : qwert) {
            if (f != null)
                System.out.println(f);
        }
    }
}

class Film {
    String title;
    int length;
    int grade;
    String format;
    int year;

    public String toString() {
        return "title = " + title + ", length = " + length + ", grade = " + grade
                + ", format = " + format + ", year = " + year;

    }
} 
```

# mysql - 将联合主键添加到 wordpress 帖子表

> ID：10728768
> 
> 赞同：0
> 
> 时间：2012-05-23T22:28:05.433
> 
> 标签：mysql, wordpress

我正在研究如何同步 wordpress 安装，两者都可以同时更新，并且都可以离线工作，然后在线同步。

我认为在站点之间同步帖子的最简单方法是将站点 ID 包含在帖子的主键中。因此，任何帖子都由增量 id 和创建它的服务器位置的 id 标识。

这可以通过插件实现吗？如果我走这条路，前面会有什么危险？有没有更好的替代方法来实现我想要实现的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:21:14.803

可以通过以下几种方式： - 在第一个 Wordpress 安装的 php 文件中编写一个存储过程，当向另一个数据库写入内容时，它会将内容插入到另一个数据库中。这个可能无法离线工作。- 编写一个函数，使用简单的 sql 查询在计划时间比较两个数据库并创建差异日志。然后将差异复制到另一个数据库。

这取决于您为什么需要这样做，但如果可行，我会推荐这个解决方案： - 保留一个 wordpress 安装。维护一个数据库，并从另一个网站连接到它以加载内容。您可以创建自己的 SQL 连接并加载您需要的任何内容。- 保留一个 wordpress 安装，并使用它的 RSS 提要来阅读内容并将其显示在您需要的第二个网站上。

我无法想象一个插件会有多大帮助，尤其是让数据库也保持离线同步。根据我的经验，编写自定义 php 脚本通常比使用插件更好，这样您就可以更直接地控制功能。

希望这可以帮助。

# c# - 如何创建以 json 格式返回关系数据库结构的 dbcontext 查询

> ID：10728774
> 
> 赞同：1
> 
> 时间：2012-05-23T22:29:15.240
> 
> 标签：c#, json, asp.net-mvc-3, asp.net-mvc-4, dbcontext

我的问题是我需要从 dbcontext 查询中呈现以下结构，因为库可以很好地呈现这种格式。这里是json中的数据。

```
{"Customer":{"Id":"BOLID","CompanyName":"Bólido Comidas preparadas","ContactName":"Martín Sommer","ContactTitle":"Owner","Address":"C/ Araquil, 67","城市":"马德里","邮政编码":"28023","国家":"西班牙","电话":"(91) 555 22 82","传真":"(91) 555 91 99"},"CustomerOrders":[{"Order":{"Id":10326,"CustomerId":"BOLID","EmployeeId":4,"OrderDate":"\/Date(844898400000+0000)\/ ","RequiredDate":"\/Date(847321200000+0000)\/","ShippedDate":"\/Date(845244000000+0000)\/","ShipVia":2,"Freight":77.92,"ShipName “："Bólido Comidas preparadas","ShipAddress":"C/ Araquil, 67","ShipCity":"Madrid","ShipPostalCode":"28023","ShipCountry":"Spain"},"OrderDetails":[{" OrderId":10326,"ProductId":4,"UnitPrice":17.6,"Quantity":24,"Discount":0},{"OrderId":10326,"ProductId":57,"UnitPrice":15.6," Quantity":16,"Discount":0},{"OrderId":10326,"ProductId":75,"UnitPrice":6.2,"Quantity":50,"Discount":0}]},{"Order" :{"Id":10801,"CustomerId":"BOLID","EmployeeId":4,"OrderDate":"\/Date(883350000000+0000)\/","RequiredDate":"\/Date(885769200000+ 0000)\/","ShippedDate":"\/Date(883522800000+0000)\/","ShipVia":2,"Freight":97.09,"ShipName":"Bólido Comidas preparadas","ShipAddress":"C/ Araquil, 67" ,"ShipCity":"Madrid","ShipPostalCode":"28023","ShipCountry":"Spain"},"OrderDetails":[{"OrderId":10801,"ProductId":17,"UnitPrice":39, "Quantity":40,"Discount":0.25},{"OrderId":10801,"ProductId":29,"UnitPrice":123.79,"Quantity":20,"Discount":0.25}]},{"Order ":{"Id":10970,"CustomerId":"BOLID","EmployeeId":9,"OrderDate":"\/Date(890694000000+0000)\/","RequiredDate":"\/Date(891900000000+0000)\/","ShippedDate":"\/Date(893368800000+0000)\/","ShipVia":1,"Freight":16.16,"ShipName":"Bólido Comidas preparadas" ,"ShipAddress":"C/ Araquil, 67","ShipCity":"Madrid","ShipPostalCode":"28023","ShipCountry":"Spain"},"OrderDetails":[{"OrderId":10970, "ProductId":52,"UnitPrice":7,"Quantity":40,"Discount":0.2}]}]}"ShipCountry":"Spain"},"OrderDetails":[{"OrderId":10970,"ProductId":52,"UnitPrice":7,"Quantity":40,"Discount":0.2}]}]}"ShipCountry":"Spain"},"OrderDetails":[{"OrderId":10970,"ProductId":52,"UnitPrice":7,"Quantity":40,"Discount":0.2}]}]}

```

哪一个

```
http://ajaxstack.com/jsonreport/
```

渲染得非常好。现在我尝试了这个：

# 控制器的东西

```
MedicalVarianceEntities DbCtx = new MedicalVarianceEntities();

    var data = 
        (
        from Mvrs in DbCtx.Mvrs
        join MvrMeds in DbCtx.MvrMeds
        on Mvrs.PKMvrId equals MvrMeds.FKMvrId
        join MvrMedsProcurementErrors in DbCtx.MvrMedsProcurementErrors
        on MvrMeds.PKMvrMedsId equals MvrMedsProcurementErrors.FKMvrMedsId
            select new
            {
                MvrId,
                MvrMeds.MvrMedsMedicineName//,
              //  MvrMedsProcurementErrors.MvrMedsProcurementErrorsId
            }
       ); 
```

# 现在的 JQUERY

```
$(function () {
  $.getJSON("/MedicineManagement/MvrSummary/1", null, function (data) {
                  var test = JSON.stringify(data);
                 alert(test);
}); 
```

![在此处输入图像描述](../Images/d10a7fc52c6cdac13dd3483169914837.png)

请注意，我想要的是这样的 Mvrs":[{"MvrMeds":{"MvrMedsMedicineName":ACETAMINOPHEN}}]

我认为这个 JSON 意味着 Mvrs 是 MvrMeds 的父级，而 MvrMedsMedicineName 是 MvrMeds 的属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:11:04.550

到目前为止，我只能以这种丑陋的方式做到这一点。

```
 public JsonResult MvrSummary(int MvrId)
        {
       MedicalVarianceEntities DbCtx = new MedicalVarianceEntities();
            var data = from entity in DbCtx.Mvrs
                          select new
                          {
                              Prop1 = entity.PKMvrId,

                              ChildProp = entity.MvrEmployees.Select(x=>x.ODSEmpNumber),
                              GrandChildProp = entity.MvrEmployees.Select(x=>x.MvrEmployeesStorageErrors.Select(y=>y.MvrEmployeesStorageErrorsId))
                          };
 return Json(data, JsonRequestBehavior.AllowGet);
} 
```

# mysql - UPDATE SQL 查询中的 LIMIT 偏移量或偏移量

> ID：10728775
> 
> 赞同：8
> 
> 时间：2012-05-23T22:29:19.003
> 
> 标签：mysql, sql, limit, offset

我有一个类似的表：

```
| 0 | X  |
| 1 | X  |
| 2 | X  |
| 3 | Y  |
| 4 | Y  |
| 5 | X  |
| 6 | X  |
| 7 | Y  |
| 8 | Y  |
| 9 | X  | 
```

我想替换前 2 次出现的`X`with `X1`，然后替换 4 次出现的 with ，`X2`以便生成的表如下所示：

```
| 0 | X1 |
| 1 | X1 |
| 2 | X2 |
| 3 | Y  |
| 4 | Y  |
| 5 | X2 |
| 6 | X2 |
| 7 | Y  |
| 8 | Y  |
| 9 | X2 | 
```

有问题的表格当然要大得多，因此出现的次数也会更高，因此手动编辑不是解决方案。

我想做这样的事情：

`UPDATE table SET column = 'X' WHERE column = 'X2' LIMIT 90, 88`

但不幸的是 MySQL 似乎不支持 UPDATE 查询中的 OFFSET ......有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-07-03T08:38:39.180

我不知道您是否在表中提供了 id 文件，但是您可以使用**WHERE id BETWEEN 88 AND 90**，MySQL 不支持 Offset 在更新查询中，但是您可以通过限制使用**BETWEEN**命令来做到这一点

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-23T22:33:20.033

试试这个：

`UPDATE table SET column = 'X1' WHERE id IN(SELECT id FROM (SELECT id FROM table WHERE column = 'X' LIMIT 2) as u);`

进而

`UPDATE table SET column = 'X2' WHERE id IN(SELECT id FROM (SELECT id FROM table WHERE column = 'X' LIMIT 4) as u);`

# ios - AVAssetExportSession 错误 -11820 无法完成导出

> ID：10728781
> 
> 赞同：1
> 
> 时间：2012-05-23T22:30:32.353
> 
> 标签：ios, avassetexportsession

我正在使用 AVComposition 将两个 .m4a 音频文件合并在一起。一个必须在特定时间插入另一个。然后我使用 AVAssetExportSession 来保存合并音频。

我在导出会话完成处理程序期间收到此错误：

```
Error Domain=AVFoundationErrorDomain Code=-11820 "Cannot Complete Export" UserInfo=0x1c3760 {NSLocalizedRecoverySuggestion=Try exporting again., NSLocalizedDescription=Cannot Complete Export} 
```

代码 - 合并两个资产：

```
 AVAsset *originalAsset = [AVAsset assetWithURL:url];
NSURL *recordingAssetUrl = [[NSURL fileURLWithPath: NSTemporaryDirectory()] URLByAppendingPathComponent:kRecordTemp];
AVAsset *recordingAsset = [AVAsset assetWithURL:recordingAssetUrl];

AVMutableComposition *composition = [AVMutableComposition new];

AVMutableCompositionTrack *audioTrack = [composition addMutableTrackWithMediaType:AVMediaTypeAudio 
                                                                 preferredTrackID:kCMPersistentTrackID_Invalid];

//Add the original audio asset to the composition
AVAssetTrack *sourceAudioTrack = [[originalAsset tracksWithMediaType:AVMediaTypeAudio] objectAtIndex:0];
NSError *error = nil;
CMTimeRange sourceRange = CMTimeRangeMake(CMTimeMakeWithSeconds(0, 1), originalAsset.duration);
[audioTrack insertTimeRange:sourceRange ofTrack:sourceAudioTrack atTime:CMTimeMakeWithSeconds(0, 1) error:&error];
if (error) [self showError:error];

//Remove the portion of the original audio asset that will be replaced by the recording
CMTimeRange overwrittenRange = CMTimeRangeMake(self.currentTime, recordingAsset.duration);
[audioTrack removeTimeRange:overwrittenRange];

//Add the recording asset to the composition
AVAssetTrack *recordAudioTrack = [[recordingAsset tracksWithMediaType:AVMediaTypeAudio] objectAtIndex:0];
error = nil;
CMTimeRange recordRange = CMTimeRangeMake(CMTimeMakeWithSeconds(0, 1), recordingAsset.duration);
[audioTrack insertTimeRange:recordRange ofTrack:recordAudioTrack atTime:self.currentTime error:&error];
if (error) [self showError:error];

//Delete the original asset
if([[NSFileManager defaultManager] fileExistsAtPath:url.path]){
    error = nil;
    [[NSFileManager defaultManager] removeItemAtURL:url error:&error];
    if(error) [self showError:error];
}

//Write the composition
AVAssetExportSession * exportSession = [AVAssetExportSession exportSessionWithAsset:composition 
                                                                         presetName:AVAssetExportPresetAppleM4A]; 
exportSession.outputURL = url;
exportSession.outputFileType = AVFileTypeAppleM4A;

[exportSession exportAsynchronouslyWithCompletionHandler:^{
    if(exportSession.status != AVAssetExportSessionStatusCompleted){
        [self showError:exportSession.error];
    }
}];

//Delete the temporary asset
if([[NSFileManager defaultManager] fileExistsAtPath:recordingAssetUrl.path]){
    error = nil;
    [[NSFileManager defaultManager] removeItemAtURL:recordingAssetUrl error:&error];
    if(error) [self showError:error]; //BOOM it blows up here
} 
```

我不确定我应该粘贴什么其他代码，因为它是一个通用错误。

我正在使用 AVAssetWriter 编写示例缓冲区以创建从捕获会话接收到的录制资产。捕获会话成功地记录并保存到文件到上面列表中使用的 url 中。

# wicket - 在 Wicket 中检查用户代理

> ID：10728787
> 
> 赞同：4
> 
> 时间：2012-05-23T22:31:27.343
> 
> 标签：wicket, user-agent

我正在使用 wicket 1.5，但我无法在该`getClientInfo()`方法 中看到

```
(WebRequest)RequestCycle.get().getRequest() 
```

我在其他地方看到了这段代码

```
WebClientInfo clientInfo = (WebClientInfo)WebRequestCycle.get().getClientInfo(); 
```

但我在 Wicket 1.5 中看不到任何 WebRequestCycle。

任何想法如何检查 Wicket 1.5 中的用户代理？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T06:48:59.370

最简单的方法是使用

```
WebSession.get().getClientInfo().getUserAgent(); 
```

在较新的 Wicket 版本（6 或更高版本）上，您应该使用：

```
WebClientInfo clientInfo = new WebClientInfo(getRequestCycle());

System.out.println("Client: " + clientInfo.getUserAgent());
System.out.println("Navigator: " + clientInfo.getProperties().getNavigatorAppName() + ", version " + clientInfo.getProperties().getNavigatorAppVersion()  + ", codName: " + clientInfo.getProperties().getNavigatorAppCodeName() + ", plataform: " + clientInfo.getProperties().getNavigatorPlatform() + ", AppCodName: " + clientInfo.getProperties().getNavigatorAppCodeName());
System.out.println("NavigatorUserAgent: " + clientInfo.getProperties().getNavigatorUserAgent());
System.out.println("Tamanho da tela (Width x Height): " + clientInfo.getProperties().getScreenWidth() + " x "  + clientInfo.getProperties().getScreenHeight() ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-20T12:57:40.540

你也可以这样做：

```
((WebRequest) getRequest()).getHeader("User-Agent") 
```

# .htaccess - url 重写 40 4 - 未找到

> ID：10728791
> 
> 赞同：0
> 
> 时间：2012-05-23T22:32:06.663
> 
> 标签：.htaccess, rewrite

我试着用这个来重写 url，并且工作得很好

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule download-id-(.*)\.htm$ download.php?id=$1 
```

但是当我尝试通过以下方式将 download.php?id=xx 重写为 download.php/id/xx 时：

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule download/id/(.*)/ download.php?id=$1
RewriteRule download/id/(.*) download.php?id=$1 
```

我有一个 404 - 未找到！错误

* * *

有什么问题我用这个好工具来生成语法 [http://www.webconfs.com/url-rewriting-tool.php](http://www.webconfs.com/url-rewriting-tool.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:35:48.173

你需要做到：

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule ^download/id/([0-9]+)\/?$ download.php?id=$1 
```

这 /？表示它可以有或没有斜杠，并且 ^ 和 $ 开始和结束搜索字符串。

# c++ - 动态添加 QGraphicsEllipseItems

> ID：10728794
> 
> 赞同：1
> 
> 时间：2012-05-23T22:32:56.063
> 
> 标签：c++, qt, qgraphicsitem

基本上，每次我单击图形视图时，我都希望出现一个新的 QGraphicsEllipseItem。数量由用户决定。另外，我想最后用 pos() 查询所有这些以获取它们的所有位置。椭圆的数量事先不知道，它们的位置可以通过 ItemIsMovable 标志移动。任何人都知道我该怎么做？

我可以制作一个指向 graphicsitem 类的指针数组，但这可能会浪费内存并限制我可以制作的椭圆数。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:38:21.653

您可以在场景中添加任意数量的项目（当然，只要有可用的内存空间）：

```
myGraphicsScene->addEllipse(rect, pen, brush); 
```

为了为每次点击添加项目，重新`mousePressEvent`实现`QGraphicsView`：

```
void MyGraphicsView::mousePressEvent(QMouseEvent *e)
{
    int rx = 10; // radius of the ellipse
    int ry = 20;
    QRect rect(e->x() - rx, e->y() - ry, 2*rx, 2*ry);
    scene()->addEllipse(rect, pen, brush);

    // call the mousePressEvent of the super class:
    QGraphicsView::mousePressEvent(e);
} 
```

您不必自己存储指针。当你想查询场景中所有物品的某条信息时，只需遍历场景提供的物品列表即可：

```
foreach(QGraphicsItem *item, myGraphicsScene->items())
    qDebug() << "Item geometry =" << item->boundingRect(); 
```

（或仅适用于该职位`item->pos()`：）

如果要查询 的子类的一条信息`QGraphicsItem`，可以使用 Qt 的 QGraphicsItem 转换机制将该项目转换为您的类型，如果该项目不是请求的类型，则该机制返回一个空指针。检查指针不为空后，您可以访问自己的成员：

```
foreach(QGraphicsItem *item, myGraphicsScene->items())
{
    MyDerivedItem *derivedItem = qgraphicsitem_cast<MyDerivedItem*>(item);
    if(derivedItem) // check success of QGraphicsItem cast
        qDebug() << derivedItem->yourCustomMethod();
} 
```

# php - 有没有办法检查一个键是否存在于 PHP 的嵌套数组中？

> ID：10728795
> 
> 赞同：0
> 
> 时间：2012-05-23T22:32:59.430
> 
> 标签：php, arrays

我的结果集来自组/计数查询：

```
SELECT m.type, COUNT(m.type)
FROM sent_message m
WHERE m.user_id = :user_id
      AND (m.sent_at >= :start_date OR m.sent_at <= :end_date)
GROUP BY m.type 
```

它是嵌套在另一个数组中的数组形式：

```
array (size=2)
  0 => 
    array (size=2)
      'type' => string 'sms' (length=3)
      'count' => string '1' (length=1)
  1 => 
    array (size=2)
      'type' => string 'email' (length=5)
      'count' => string '9' (length=1) 
```

有没有办法在`type`不循环的情况下轻松检查给定索引是否存在？为了避免这种情况：

```
$resultSet = $repository->getAllCount(); // Returns the nested array
$viewBag   = array('sent_sms_count' => 0, 'sent_email_count' => 0); // Init

foreach($resultSet as $result) :

    if('sms' == strtolower($result['type'])
        $viewBag['sent_sms_count'] = $result['count'];

    if('email' == strtolower($result['type'])
        $viewBag['sent_email_count'] = $result['count'];

endforeach; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:51:04.737

如果没有循环，我就没有办法知道。但是您可以将 SQL 结果重新索引为您喜欢的格式：

```
foreach ($resultSet as $result) {
    $viewBag['sent_' . strtolower($result['type']) . '_count'] = $result['count'];
} 
```

# node.js - node-orm 同步到 Alter Tables（类似于 DataMapper.auto_upgrade）

> ID：10728798
> 
> 赞同：1
> 
> 时间：2012-05-23T22:33:12.700
> 
> 标签：node.js, orm, coffeescript

我正在使用 node-orm 来尝试设置我的数据库。这是模型代码。

```
db = orm.connect("mysql", client, (success, db) ->
  Strain = db.define("strain",
    name:
      type: "string"
      validations: [ orm.validators.unique() ]
    old_body:
      type: "string"
    body:
      type: "string"
    created_at:
      type: "date"
    update_at:
      type: "date"
  )
  Strain.sync()
) 
```

我将 /orm/lib/databases/mysql.js 文件更改为 console.log 返回的同步信息。

```
this._client.query(_query, function (err, info) {
  console.log(err);
  console.log(info);
  console.log("collection synced");
}); 
```

第一次 Strain.sync() 运行时，这是输出。

```
null

{ affectedRows: 0,
  insertId: 0,
  serverStatus: 2,
  warningCount: 0,
  message: '',
  setMaxListeners: [Function],
  emit: [Function],
  addListener: [Function],
  on: [Function],
  once: [Function],
  removeListener: [Function],
  removeAllListeners: [Function],
  listeners: [Function] }

collection synced 
```

现在该表已按应有的方式创建。当我重新启动服务器并再次运行 Strain.sync() 时，输出如下：

```
null

{ affectedRows: 0,
  insertId: 0,
  serverStatus: 2,
  warningCount: 1,
  message: '',
  setMaxListeners: [Function],
  emit: [Function],
  addListener: [Function],
  on: [Function],
  once: [Function],
  removeListener: [Function],
  removeAllListeners: [Function],
  listeners: [Function] }

collection synced 
```

警告计数跳到“1”，但 err 为空，消息为空。

我需要弄清楚如何更改模型并添加新属性，例如“deleted_at”，并在不丢失数据的情况下更新表。我知道我可以做 Strain.sync(force: true)，但这会删除表然后重新创建它。我只是想更新表，类似于 DataMapper 的 auto_upgrade 函数。

有没有办法用 node-orm 或任何适用于 nodejs 的 ORM 来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T00:27:50.330

很确定当前版本的 sync() 只创建表，不更新。

> 注意：sync() 目前只创建表；表修改将在即将发布的版本中添加。

[https://github.com/dresende/node-orm#creating-the-model-on-the-database](https://github.com/dresende/node-orm#creating-the-model-on-the-database)

# jquery - 使用主题标签制作 Wordpress 导航链接

> ID：10728800
> 
> 赞同：0
> 
> 时间：2012-05-23T22:33:20.713
> 
> 标签：jquery, wordpress, plugins, navigation

我对 Wordpress 世界还很陌生，而且我已经对某些事情感到怀疑。

我制作了一个带有一些主题标签菜单操作的 HTML 模板（我正在使用这个插件：[http](http://www.asual.com/jquery/address/) ://www.asual.com/jquery/address/ ）。这意味着当用户浏览页面时页面**不会重新加载。**Wordpress 的本质不是那样工作的。如果我在 Wordpress 中创建一个页面，我会得到一个这样的链接：[http](http://website.com/sample-page/) ://website.com/sample-page/但我想要这样的链接：http: [//website.com/wordpress/#/sample-page /](http://website.com/wordpress/#/sample-page/)。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:43:20.210

您可以使用“菜单”设置自定义菜单，放入静态 URL，然后在 URL 中任何您想要的位置添加 #。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:04:16.070

Mikkel，您也可以尝试将其添加到您的 .htaccess 文件中：

```
RewriteRule ^/(.*) /wordpress/#/1$ [R=301,L,NE] 
```

这应该抓住 .com/ 之后的路径并在其前面抛出“/wordpress/#/”。

# visual-studio-2010 - 在 Visual Studio 2010 中使用 Gloox

> ID：10728801
> 
> 赞同：2
> 
> 时间：2012-05-23T22:33:25.133
> 
> 标签：visual-studio-2010, gloox

我正在尝试使用[gloox](http://camaya.net/gloox/)库 (C++) 创建 Windows XMPP 应用程序。看起来很简单，只是我不知道如何将 gloox 导入 Visual Studio 2010，所以我可以将它包含在我的应用程序项目中。

我查看了自述文件中提供的说明（如下所示），但是当我尝试编译库时，出现此错误：

> 无法打开源文件：'src\tlsgnutlsserver.cpp'：没有这样的文件或目录

自述文件中提供的说明：

> ## 在 MSVC++ 上构建 gloox
> 
> *   使用包含的项目文件或创建自己的
> *   如有必要，调整包含 + 库路径
> *   要接收任何调试输出，您应该使用 LogSink 工具（这不是特定于 win32 的）
> *   建造

有人有使用 Gloox 和 VS10 的经验吗？如果是的话，你能帮帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T00:16:58.423

我假设您使用的是官方的 1.0 tarball？我遇到了同样的问题（缺少源文件），不得不从 SVN 获取源代码。我使用了 1.0 分支。

我遇到了其他一些构建问题，即

*   发布构建配置设置为构建**应用程序（.exe）**而不是**动态库（.dll）**（项目->属性->常规->配置类型）
*   我需要将**DLL_EXPORT**添加到预处理器定义（项目->属性->配置属性->C/C++->属性->预处理器）
*   **src\atomicrefcount.cpp**需要添加到项目的源文件中。（项目->添加现有项目）

这在 VC++ 2010 和 VC++ 2008 的速成版中对我有用。

希望它也能帮助你。

# boost - 如何摆脱接受：在 boost::asio 服务器中已经打开异常

> ID：10728802
> 
> 赞同：0
> 
> 时间：2012-05-23T22:33:28.330
> 
> 标签：boost, boost-asio

该服务器运行在一个单独的线程中，除了经常抛出的异常“accept:Already open exception”外，似乎运行良好。在检查套接字是否已经打开时，在 acceptor.accept(...) 调用时会引发此异常。如果我调用 accepter.accept(...) iff 套接字未打开（注释行），行为变得不可预测。run 方法从同步的 mQueue 中获取数据，该 mQueue 正在以每秒大约 30 次的速度在另一个线程上填充。

我究竟做错了什么？

```
class Server{
    public:

Server(unsigned short port, ConcurrentQueue<uint8_t*>*queueToServer, unsigned int width, unsigned int height):mSocket(mIOService),mAcceptor(mIOService,ip::tcp::endpoint(ip::tcp::v4(), port)),mQueue(queueToServer), dSize(width*height*3){}
void run(){

    unsigned char* data;
    boost::system::error_code ignored_error;
    while(true){
        if (mQueue->try_pop(data)){
            const mutable_buffer image_buffer(data, dSize);
            //if (!mSocket.is_open())
            mAcceptor.accept(mSocket);
            boost::asio::write(mSocket, buffer(image_buffer), transfer_all(), ignored_error);
        }
    }
}
private:
    io_service mIOService;
    ip::tcp::socket mSocket;
    ip::tcp::acceptor mAcceptor;
    ConcurrentQueue<uint8_t*>* mQueue;
    std::size_t dSize;
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:05:29.990

在 asio 术语中，如果套接字具有有效的套接字句柄（描述符），则该套接字是“打开的”。当你接受一个传入的连接时，你应该向接受者传递一个“新鲜的”、未打开的套接字。所以，问题出在你的代码逻辑上：你应该首先从你的客户端接受一个新的连接，然后你可以使用接受的套接字来发送/接收你想要的任何数据。

# html - 响应式图像上的 Div 叠加

> ID：10728806
> 
> 赞同：1
> 
> 时间：2012-05-23T22:33:50.983
> 
> 标签：html, css

[http://jsfiddle.net/LFtHg/](http://jsfiddle.net/LFtHg/)

我正在尝试创建我的第一个响应式网站。为此，我包含了一张图片。此图像有一个标题，应该以透明覆盖显示。但是，由于不透明度设置被传递给子元素，我已经从容器中删除了文本。

我根本无法显示叠加层（因为它里面没有内容）。我不能真正添加​​一个固定的高度，因为我想要图像以响应浏览器大小的变化。如何确保显示此内容？

谢谢你，J

编辑，还有什么是在浏览器调整大小时缩放叠加层的最佳方式。我不确定这种方法是否可行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T00:07:11.210

首先，您可以使用 RGBA 背景 ( `background: rgba(0,0,0,.5);`) 而不是不透明度。

其次，您需要为您的显式设置宽度`span.figcaption`（您也可以通过指定左右偏移属性来做到这一点）

也许这个演示[http://dabblet.com/gist/2778608](http://dabblet.com/gist/2778608)也可能对您有所帮助（图像可以是任何大小 - 调整浏览器窗口的大小以查看所有内容如何调整大小）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:56:33.080

将以下规则添加到现有示例中可以有效地拉伸`.figcaption`元素以完全覆盖`.figure`, [fiddle](http://jsfiddle.net/LFtHg/1/)：

```
.figure {position:relative;}
/*these could be different so that the overlay appears larger than the caption*/
span.figcaption {position:absolute;top:0;right:0;bottom:0;left:0;}
p.figcaption {position:absolute;top:0;right:0;bottom:0;left:0;} 
```

您可以将值任意调整为 % 设置，以使标题居中显示等。

顺便说一句，你知道你的实施还不是流动的，对吧？

# linux - intel VT-d for OS保护测试

> ID：10728807
> 
> 赞同：-1
> 
> 时间：2012-05-23T22:33:54.790
> 
> 标签：linux, testing, linux-kernel, intel

现在，我想做一个测试，以确保 VT-d 保护的是内核还是内存？所以，我需要一些工具和建议。有人有想法吗？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:41:45.643

VT-d 是一个 IOMMU。它允许总线互连重新映射 I/O 设备的“地址空间”。最大的用例是将硬件设备映射到虚拟客户机的 I/O 空间（即使用 VT-x 实现的机器），这样硬件访问就无法“看到”主机操作系统拥有的任何内存。从这个意义上说，它保护了“内核和内存”。除此之外，您还需要问一个更具体的问题。

# javascript - 替换 JavaScript 中的双反斜杠——文本区域中的换行符

> ID：10728808
> 
> 赞同：2
> 
> 时间：2012-05-23T22:33:57.807
> 
> 标签：javascript, html, regex

我无法让我的换行符显示在文本区域中。我收到的数据在换行符处包含双反斜杠（即 \\n ）。在设置 textarea 的值之前，我尝试使用正则表达式删除其中一个反斜杠 - 不起作用。

这是问题的重新创建：http: [//jsfiddle.net/xkM23/3/](http://jsfiddle.net/xkM23/3/)

有谁知道如何让换行符正确显示在该文本区域中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:44:48.607

您必须`\`为 JavaScript 转义（并使它们成为 double `\\`）。然后它按预期工作：http: [//jsfiddle.net/xkM23/6/](http://jsfiddle.net/xkM23/6/)

```
.replace(/(\\r)|(\\n)/g,"\n") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:47:56.040

```
$('#test_textb').val(
  oTest.data.PRIVATE_CONTACT1.split("\\r\\n").join("\n")
); 
```

# c# - 效率：功能 , Vs T 的实例

> ID：10728810
> 
> 赞同：4
> 
> 时间：2012-05-23T22:34:10.837
> 
> 标签：c#, .net, generics, functional-programming

最近我一直在尝试使用这个`Func<T>`类，到目前为止我很喜欢它。然而，我注意到我越来越多地开始使用它而不是实际使用 的实例`T`，所以我想问一下；**使用vs****的开销是多少？`Func<T>``T`**我知道这是一个有点笼统的问题，`T`任何事情都可以，所以我想这个问题应该集中在**传递函数而不是简单对象的实例的开销上？**

为了论证，让我们假设以下内容。

## 我们的模拟对象，`T`

```
public class Person
{
    private string _name = string.Empty;
    private int _age = 0;
    private bool _isMale = true;

    public Person(string name, int age, bool isMale)
    {
        this.Name = name;
        this.Age = age;
        this.IsMale = isMale;
    }

    public string Name
    {
        get { return this._name; }
        set { this._name = value; }
    }

    public int Age
    {
        get { return this._age; }
        set { this._age = value; }
    }

    public bool IsMale
    {
        get { return this._isMale; }
        set { this._isMale = value; }
    }
} 
```

现在，假设我们有一个漂亮的扩展方法 on `IDictionary`，它通过键选择值*或*默认值。伪代码可以描述如下：
KeyValuePair 集合中是否找到键 是，返回值 否，返回默认值

## 选项1.我们的扩展方法使用一个实例`T`

```
public static TValue GetValueOrDefault<TKey, TValue>(this IDictionary source, TKey key, TValue @default)
{
    if (source.ContainsKey(key))
    {
        return source[key];
    }
    return @default;
}

// usage
var myValue = myDictionary.GetValueOrDefault("Richard", new Person()); 
```

## 选项 2\. 我们的扩展方法使用`Func<T>`... 嗯，漂亮！

```
public static TValue GetValueOrDefault<TKey, TValue>(this IDictionary source, TKey key, Func<TValue> defaultSelector)
{
    if (source.ContainsKey(key))
    {
        return source[key];
    }
    return defaultSelector();
}

// usage
var myValue = myDictionary.GetValueOrDefault("Richard", () => new Person("Richard", 25, true)); 
```

## 比较

比较上述选项，很明显两者都有潜在的好处。选项 1 更容易阅读，但是我目前*喜欢*使用`Func<T>`，因此对我来说选项 2 似乎很理想。我想我认为它是一个惰性实例化的参数，它只在需要时执行，因此可以节省效率，但我说的对吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T22:57:37.347

这是我用于基准测试的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Linq.Expressions;

namespace ConsoleApplication3
{
    using System.Collections;
    using System.Diagnostics;
    using System.Globalization;
    using System.Numerics;
    using System.Xml.Linq;

    public class Program
    {

        public class Person
        {
            private string _name = string.Empty;

            private int _age = 0;

            private bool _isMale = true;

            public Person(string name, int age, bool isMale)
            {
                this.Name = name;
                this.Age = age;
                this.IsMale = isMale;
            }

            public string Name
            {
                get
                {
                    return this._name;
                }
                set
                {
                    this._name = value;
                }
            }

            public int Age
            {
                get
                {
                    return this._age;
                }
                set
                {
                    this._age = value;
                }
            }

            public bool IsMale
            {
                get
                {
                    return this._isMale;
                }
                set
                {
                    this._isMale = value;
                }
            }
        }

        private static void Main(string[] args)
        {
            var myDictionary = new Dictionary<string, Person>();
            myDictionary.Add("notRichard", new Program.Person("Richard1", 26, true));
            myDictionary.Add("notRichard1", new Program.Person("Richard2", 27, true));
            myDictionary.Add("notRichard2", new Program.Person("Richard3", 28, true));
            myDictionary.Add("notRichard3", new Program.Person("Richard4", 29, true));
            // usage
            Stopwatch sw = new Stopwatch();
            sw.Start();
            for(int i = 0; i < 100000000; i++)
            {
                var myValue = myDictionary.GetValueOrDefault("Richard", new Program.Person("Richard", 25, true));
            }
            sw.Stop();
            Console.WriteLine(sw.ElapsedMilliseconds);
            sw = new Stopwatch();
            sw.Start();
            for (int i = 0; i < 100000000; i++)
            {
                var myValue = myDictionary.GetValueOrDefault("Richard", ()=> new Program.Person("Richard", 25, true));
            }
            sw.Stop();
            Console.WriteLine(sw.ElapsedMilliseconds);
            Console.ReadKey();
        }
    }
    public static class Ex
    {
        public static TValue GetValueOrDefault<TKey, TValue>(this Dictionary<TKey, TValue> source, TKey key, TValue @default)
        {
            if (source.ContainsKey(key))
            {
                return source[key];
            }
            return @default;
        }
        public static TValue GetValueOrDefault<TKey, TValue>(this Dictionary<TKey, TValue> source, TKey key, Func<TValue> defaultSelector)
        {
            if (source.ContainsKey(key))
            {
                return source[key];
            }
            return defaultSelector();
        }

    }
} 
```

调用每个扩展方法**100000000**次（没有找到条目，因此导致 Func 每次都被执行）给出以下结果：

`T`- 10352 毫秒

`Func<T>`- 12268 毫秒

调用每个扩展方法**100000000**次（并找到一个条目，因此根本不调用 Func）给出以下结果：

`T`- 15578 毫秒

`Func<T>`- 11072 毫秒

因此，哪个执行得更快取决于您节省了多少实例化以及每个实例化的成本。

通过重用默认的 person 实例来稍微优化代码，为 6809 毫秒`T`和 7452毫秒`Func<T>`：

```
 Stopwatch sw = new Stopwatch();
            var defaultPerson = new Program.Person("Richard", 25, true);
            sw.Start();
            for(int i = 0; i < 100000000; i++)
            {
                var myValue = myDictionary.GetValueOrDefault("Richard", defaultPerson);
            }
            sw.Stop();
            Console.WriteLine(sw.ElapsedMilliseconds);
            sw = new Stopwatch();
            sw.Start();
            for (int i = 0; i < 100000000; i++)
            {
                var myValue = myDictionary.GetValueOrDefault("Richard", () => defaultPerson);
            } 
```

因此，理论上（如果您将实例化排除在等式之外），在调用堆栈中保存一个跃点会给您一些性能提升，但在实践中，这种提升可以忽略不计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:00:34.290

传递对函数的引用和传递对对象的引用我希望非常相似。如果您正在执行一百万次这样的调用，那么两者都可能会通过保存引用并每次重用相同的值而受益。但请注意，在第一种情况下，每次都可以使默认对象相同：

```
Person defaultPerson = new Person();
var myValue = myDictionary.GetValueOrDefault("Richard", defaultPerson); 
```

`Person`但在第二种情况下，每次返回默认值时，您都会实例化一个全新的：

```
Func<Person> defaultPersonFunc = () => new Person("Richard", 25, true);
var myValue = myDictionary.GetValueOrDefault("Richard", defaultPersonFunc); 
```

您可以通过更改为：

```
Person defaultPerson = new Person("Richard", 25, true);
Func<Person> defaultPersonFunc = () => defaultPerson;
var myValue = myDictionary.GetValueOrDefault("Richard", defaultPersonFunc); 
```

但是我看不出你会通过使用`Func<Person>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T15:38:43.307

第二种方法效率低，因为它要求编译器在每次调用函数时生成一个闭包（委托和对象实例的组合），而不管是否实际需要闭包。除非`Person`创建成本很高，否则无条件生成闭包将比无条件生成`Person`.

另一种方法是让 lambda 成为一个静态方法，它接受其参数作为 ref 结构。我希望 C# 能为这种方法提供一些语言支持，因为它可以更有效地完成许多闭包可以做的事情。代码看起来像：

```
公共委托 TResult TFuncByRef<TParam,TResult>(ref TParam);
公共静态 TValue GetValueOrDefault<TKey, TValue, TParam>
  （此 IDictionary 源，TKey 键，
   FuncByRef<TParam, TValue> defaultSelector,
   参考 TParam 参数）
{
    参考 TValue 结果 = 默认（TValue）；
    if (!source.TryGetValue(key, ref Result))
        结果 = 默认选择器（参考参数）；
    返回结果；
}

struct CreatePersonParams {公共字符串名称；公共int年龄；公共布尔 IsMale};
静态人 CreatePersonByName（参考 CreatePersonParams 参数）
{
  return new Person(param.Name, param.Age, param.IsMale);
}
...然后使用它...
{
  ...
  CreatePersonParams newPersonParams;
  newPersonParams.Name = "艾米丽";
  newPersonParams.Age = 23;
  newPersonParams.IsMale = False；
  ...
  不管 = myDict.GetValueOrDefault(keyValue, CreatePersonByName, ref newPersonParams);
  ...
}

```

请注意，将结构实例创建为局部变量比创建新的类实例便宜（本质上与为每个结构字段创建局部变量相同）。另请注意，由于 CreatePersonByName 是一个静态方法，因此系统只需要在程序的生命周期内创建一个委托。进一步注意，无论结构有多大，通过 ref 传递结构都很便宜，并且访问通过 ref 传递的结构的字段与访问类的字段一样有效。

使用这种方法，相同的`GetValueOrDefault`方法可以处理需要任何参数组合的例程，而无需创建任何闭包。不幸的是，由于 C# 不提供任何语言支持这种类型的代码转换（这实际上可能比将 lambda 转换为闭包更简单），因此有必要显式定义可能想要使用的所有结构类型。可以定义一系列`TupleStruct<T1,T2,T3>`等结构并使用它们，但这样的东西仍然有点难看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T12:27:47.217

代表很棒，但我不确定这是您从使用它们中受益的情况。

选项 1 效率低下，因为您无条件地创建了一个新的对象实例：

```
var myValue = myDictionary.GetValueOrDefault("Richard", new Person()); 
```

总是会创建一个新的 Person 。

选项 2 效率低，因为您创建了一个新`Func`实例。你的语法是这个的简写：

```
var myValue = myDictionary.GetValueOrDefault("Richard", new Func<Person>(()=> {
    Person("Richard", 25, true));
}); 
```

编译器可能会比另一个优化更多，但最终，这是使用错误工具解决问题的情况。解决方案是使用内置`TryGetValue`方法，仅在需要时才*实际*运行默认代码：

```
Person myValue;
if (!myDictionary.TryGetValue("Richard", out myValue)) {
    myValue = new Person("Richard",25,true);
} 
```

当目标不在字典中时，从我得到的另一个答案运行测试：

*   7309 毫秒（选择 1）
*   8705 毫秒（选项 2）
*   5972 毫秒（TryGetValue）

当目标在字典中时（例如，它永远不需要使用默认值）：

*   10026 毫秒（选项 2）
*   7712 毫秒（选项 2）
*   3491 毫秒（TryGetValue）

无论如何，它显然要快得多。这是有道理的——因为*每次*对选项 1 或 2 进行测试时，无论结果如何，您都必须创建一个对象。在这种`Func`情况下，您必须在需要默认值时创建*两个*对象，在不需要时创建一个对象，因此，当总是需要默认值时，它的表现最差。

另一方面，仅使用`TryGetValue`并且仅有条件地执行默认代码，您只需要在需要默认代码时创建一个对象（并且只是您真正需要的对象）。

有时老式的方式是最好的:)

FWIW - 我认为像这样的方法`GetValueOrDefault`肯定很有用，但当你必须明确定义默认值时可能不是。也就是说，就代码风格而言，我没有看到使用委托的巨大好处，当然也没有性能上的好处。但是，如果您不需要实际定义默认人员的内容，那么为什么不直接创建一个这样的扩展方法：

```
public static TValue GetValueOrDefault<TKey, TValue>(this IDictionary source, 
    TKey key) where TValue: new()
{
    TValue value;
    if (!source.TryGetValue(key, out value)) {
        value = new TValue();
    }
    return value;
} 
```

# php - PDO - 检查行是否已更新？

> ID：10728811
> 
> 赞同：3
> 
> 时间：2012-05-23T22:34:17.450
> 
> 标签：php, mysql, pdo

其他人也问过这个问题，但我的更具体一点。

我有这个查询：

```
$sql = "UPDATE table SET option=? WHERE number=?";
$q = $conn->prepare($sql);
$q->execute(array($option, $number));
$q->setFetchMode(PDO::FETCH_BOTH);

echo $q->rowCount(); 
```

如果 WHERE`number`已经存在且 SET`option`相同，则`$q->rowCount()`等于`0`

如果 WHERE`number`不存在且行不更新，则`$q->rowCount()`等于`0`

如何区分这些非更新？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-23T22:44:56.917

在最近的 PHP 版本中，它由`PDO::MYSQL_ATTR_FOUND_ROWS`属性控制。当设置为 时`true`，根据[文档](http://php.net/manual/en/ref.pdo-mysql.php)，效果是：

> ```
> Return the number of found (matched) rows, not the number of changed rows. 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T14:41:02.273

如果存在，会更好地检查吗？我在我的 miniclass 中使用一个通用函数来管理 PDO，但我不知道是否是最好的解决方案，因为多做一个查询......

```
function checkExistsInDatabase($id, $table, $where = null){

    // Connect
    $Database = Database::connect();

    // Query
    $sql = "SELECT id 
            FROM $table
            WHERE id = :id $where
            LIMIT 1";
    $params = array(
                ':id' => array(
                    'value' => $id,
                    'type' => 'int'
                )
              );
    $q = $Database->query($sql, $params);

    // Ha encontrado algo?
    $resultados = $Database->fetchArray($q);
    if(count($resultados) === 1){
        return true;
    }else{
        return false;
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T22:43:34.130

您可以尝试使用[REPLACE](http://dev.mysql.com/doc/refman/5.0/es/replace.html)，它的工作方式类似于插入，但如果该行已经存在，则它首先被删除然后插入。这从mysql方面过度工作

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-09-17T06:58:29.577

**添加这个：**

```
$db = new PDO($dsn, $username, $password, array(PDO::MYSQL_ATTR_FOUND_ROWS => true)); 
```

**到您的 databasefunctions.php 文件的第一个“try {”部分**

# java - Java拆分字符串

> ID：10728812
> 
> 赞同：2
> 
> 时间：2012-05-23T22:34:20.187
> 
> 标签：java, regex

我有这个字符串

```
G234101,Non-Essential,ATPases,Respiration chain complexes,"Auxotrophies, carbon and",PS00017,2,IONIC HOMEOSTASIS,mitochondria. 
```

我一直试图在java中拆分。该文件以逗号分隔，但其中一些字符串中有逗号，我不希望它们被拆分。目前在上面的例子中

```
"Auxotrophies, carbon and" 
```

被分成两个字符串。

关于如何最好地用逗号分隔的任何建议。并非所有字符串都有“”，例如以下字符串：

```
G234103,Essential,Protein Kinases,?,Cell cycle defects,PS00479,2,CELLULAR COMMUNICATION/SIGNAL TRANSDUCTION,cytoplasm. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:41:57.203

[http://opencsv.sourceforge.net/](http://opencsv.sourceforge.net/)

但是如果你真的需要重新发明轮子（家庭作业），你需要使用比“what,ever”.split(",") 更复杂的正则表达式。[但这并不简单。](http://www.kimgentes.com/worshiptech-web-tools-page/2008/10/14/regex-pattern-for-parsing-csv-files-with-embedded-commas-dou.html)你可能会更好地创建自己的自定义 Lexer。[http://en.wikipedia.org/wiki/Lexical_analysis](http://en.wikipedia.org/wiki/Lexical_analysis)

在您的情况下，这并不太难。当您逐个字符处理文本时，您只需要跟踪开始和结束引号，以决定何时忽略逗号以及何时对它们采取行动。

另请参阅[StreamTokenizer](http://docs.oracle.com/javase/6/docs/api/java/io/StreamTokenizer.html)以了解内置的可配置 Lexer - 您应该能够使用它来满足您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:42:36.137

我认为这将是一个多步骤的过程。首先，从原始字符串中找到引号中的所有逗号，将其替换为 {comma} 之类的内容。你可以用一些正则表达式来做到这一点。然后在新字符串上，用逗号 (,) 分割新字符串。然后浏览您的列表，并将 {comma} 替换为逗号符号 {,}。

# windows-phone-7 - 将当前视图保存到位图 WP7

> ID：10728813
> 
> 赞同：0
> 
> 时间：2012-05-23T22:34:25.663
> 
> 标签：windows-phone-7, bitmapimage

我刚开始使用 WP7 Dev，我想在解决这个问题上得到一些帮助：我有一个`Canvas`in ，我有 2 `StackPanels`，我画的是 10 `Rectangle`。所以我的问题是，如何将画布保存到`Bitmap`?

这就是我想要实现的目标，即：

![在此处输入图像描述](../Images/039c0a351498933d3c909346c328f081.png)

我明白了：

![在此处输入图像描述](../Images/7ae94cc543706d688434710192fbaefc.png)

任何为我指明正确方向的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:47:38.390

您要做的是创建一个[WriteableBitmap](http://msdn.microsoft.com/en-us/library/aa347331%28v=vs.95%29)，然后使用您要呈现给它的 UIElement调用它的[Render方法。](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.writeablebitmap.render%28v=vs.95%29.aspx)

# php - 从 while 循环填充数组以返回 PHP

> ID：10728816
> 
> 赞同：2
> 
> 时间：2012-05-23T22:34:43.517
> 
> 标签：php, arrays, return

嗨，我正在尝试使用诸如“user1”和“score1”之类的索引填充数组以返回函数。

我的代码：它出现了无法识别的变量错误

```
$query = 'select * from users order by score desc';
$result = mysql_query($query) or die (mysql_error());
$highscore = array();
$count = '0';

while($row = mysql_fetch_array($result))
{
    $count++;         
    $highscore = array('user' . $count => $row['username'], 'score' . $count => $row['score']);
}

return $highscore; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:37:20.947

当你想使用数值时，你应该使用它们。你使用了零（`'0'`）的字符串表示

```
$count = 0;
$highscore = array();
while($row = mysql_fetch_array($result))
{       
    $count++; 
    $highscore['user' . $count] = $row['username'];
    $highscore['score' . $count] = $row['score'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:42:20.230

如果您想要“高分”，您可能想要使用 max 并只返回 1 行。

# greasemonkey - 使用greasemonkey 输入一个输入值

> ID：10728818
> 
> 赞同：4
> 
> 时间：2012-05-23T22:34:57.410
> 
> 标签：greasemonkey

我有一些输入值包含在一堆 div 和一个表单中。我对js的了解有限，想在页面加载时使用greasemonkey来设置值。

下面显示了获取值的 div 和表单的顺序。

```
<div data-role="page" id="finalTest">                    
  <div data-role="content">
    <form class="cmxform" id="ftForm">
      <div id="finalTestForOtherDiv" >
        <div data-role="fieldcontain" class="special-spacing">
                <div class="input-div">
                    <label id="finalTestBeforeAcTgrLabel" for="finalTestBeforeAcTg" data-insight="true" 
                        class="mandatory" data-default="mandatory"><img class="label-image" alt="" src="../Images/icon-alert.png" />AC V (T/G):</label>
                    <input type="text" id="finalTestBeforeAcTg" name="finalTestBeforeAcTg" value="" style="width:100px; display:inline-block;" 
                        data-bind="binder.BeforeAcTg"  data-bind-action-when-hidden="Ignore" />
                    <span class="ui-content" style="padding-left:7px;">V</span>
                    <div class="error-message"><ul></ul></div>

                </div> 
```

这是我尝试使用但什么也没做的脚本。

```
// ==UserScript==
// @name    Final Test
// @description Final test results
// @include https://techaccess.ad.qintra.com/WorkJobs/WorkJobs.aspx#finalTest
// ==/UserScript==

document.getElementById("finalTestBeforeAcTg").value = "0.00"; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T22:39:47.637

```
document.getElementById("finalTestBeforeAcTg").value = "your value"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T01:39:45.893

如果您的脚本尝试不起作用，可能是因为以下一项或多项：

1.  `@include`限制性太强了。
2.  该节点尚不存在。AJAX 在页面上是否处于活动状态？
3.  必须触发先决条件 javascript 事件，页面才能确认或接受新值。

对于问题 1，将脚本更改为：

```
// ==UserScript==
// @name        Final Test
// @description Final test results
// @include     http://techaccess.ad.qintra.com/WorkJobs/*
// @include     https://techaccess.ad.qintra.com/WorkJobs/*
// ==/UserScript==

alert ("Script start.");

var finTestInput    = document.getElementById ("finalTestBeforeAcTg");
if (finTestInput) {
    finTestInput.value  = "0.00";
}
else {
    alert ("The target input does not exist yet!")
} 
```

请注意，如果您使用*Firebug*（您应该），请将 s 更改`alert()`为`unsafeWindow.console.log()`s。

* * *

对于问题 2，使用该`waitForKeyElements`实用程序。例如，请参阅[此答案](https://stackoverflow.com/a/10664942/331508)。

* * *

对于问题 3，如果不访问页面以找出正确的事件顺序，我们几乎无能为力。
让我们访问页面，或者使用 Firebug（和事件面板）来解决这个问题，或者页面的 HTML 和页面的 JS 文件的快照，在[Pastebin.com](http://pastebin.com/)就足够了（也许）。

# android - Zxing意图集成使用

> ID：10728820
> 
> 赞同：0
> 
> 时间：2012-05-23T22:35:29.590
> 
> 标签：android, zxing

我正在尝试实现自定义条形码扫描仪。如果我安装了 Zxing，应用程序可以正常工作，但如果我没有安装，应用程序将出错，您必须强制关闭。我已将 IntentIntegrator.java 和 IntentResult.java 添加到我的项目的 SRC 文件夹中，并将包名更改为指向我的包，尽管我不确定这是否是我应该做的。它仍然行不通。我设置正确吗？我发现很多页面告诉我使用这些文件，但没有告诉我如何将它们设置为工作。

如果客户端手机上没有安装zxing应用程序，我希望它能够顺利引导用户从市场下载zxing应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T07:15:57.677

这是因为您没有处理`ActivityNotFoundException`，或者先检查是否安装了该应用程序。那取决于你。但是，如果您使用提供的集成代码，它会为您完成这一切。请参阅[http://code.google.com/p/zxing/wiki/ScanningViaIntent](http://code.google.com/p/zxing/wiki/ScanningViaIntent)

但它不会启动*您的*应用程序，不。

# c# - Facebook C# SDK Azure 文档

> ID：10728821
> 
> 赞同：0
> 
> 时间：2012-05-23T22:35:37.853
> 
> 标签：c#, azure, facebook-c#-sdk

我即将开始一个将使用 Azure 和 Facebook C# SDK 的项目。我只是想知道 C# SDK 网站上的文档何时可用？我不知道从哪里开始，并且会喜欢一些文档/教程。

谢谢，

朗达

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:40:30.010

> 该文档自 2012 年 2 月 11 日起正在制作中。我们将在接下来的几周内进行重大改进。

来源：[http ://csharpsdk.org/docs/azure/](http://csharpsdk.org/docs/azure/)

所以，是的，这就是你的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T01:23:13.440

由于您需要一些关于从哪里开始的指示，我当然可以给您一些指示，但要为冒险时间做好准备，因为您肯定会遇到一些困难。您真正需要的是分两步开发您的项目：

1.  使用 FaceBook C# SDK 创建一个 ASP.NET (MVC?) Web 应用程序
2.  将此 ASP.NET 应用程序转换为 Web 角色以部署到 Windows Azure

要开始您的开发 1) 我建议您遵循此文档：

1.  [http://csharpsdk.org/docs/web/](http://csharpsdk.org/docs/web/)
2.  [http://csharpsdk.org/docs/web/ajax-requests](http://csharpsdk.org/docs/web/ajax-requests)

我还建议您在开发过程中遇到错误时寻求更多帮助，因为讨论了很多解决方案。

最后当你来到 2) 你可以按照[如何在 windows azure 上部署 asp.net 应用程序..？](https://stackoverflow.com/questions/10714018/how-deploy-asp-net-application-on-windows-azure/10724923#10724923)

# drupal - 如何通过 AWS 上的 Drush Make 从 Aegir 访问私有 github 存储库

> ID：10728824
> 
> 赞同：3
> 
> 时间：2012-05-23T22:35:54.473
> 
> 标签：drupal, ssh, github, amazon-web-services, drush

我有一个在 AWS 上运行的 ec2 实例。 `Aegir`已安装并且`drush make`非常适合安装新平台，除非我需要从私有 github 存储库下载主题。

***`drush make`无权访问 github 私有存储库***并且平台安装失败。

**我该如何克服呢？** 是否有一些奇特的方法可以为 git 存储库提供 drush make 或 aegir 用户 ssh 密钥？

我对 ssh-agent 了解不多，但我想也许可以让它一直在我的服务器上运行，这样 aegir 就可以访问我的 github。

**如何`drush make`访问私有 github 存储库？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T08:05:35.170

在 EC2 实例上生成 SSH 密钥，然后将公钥（通常为 id_rsa.pub）添加到私有存储库作为解除部署密钥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-04T13:06:33.343

stevenh512 是对的，一步一步的解释如下：

免责声明：我在 Centos 上使用 GitLab + 自定义 VPS，但相同的工作流程可以应用于任何主机（使用 ssh）和 GitHub（ps 我喜欢 GitLab 用于私人存储库）

1.  以 aegir 身份登录到 VPS，可能您不能（如果您将服务器配置得非常安全），所以以 root 身份登录 su aegir

2.  转到主目录（cd /var/aegir）并检查您是否有 SSH 密钥。如果你有一个跳跃1步。

    ```
    cat ~/.ssh/id_rsa.pub 
    ```

3.  如果您没有创建一个并且不使用密码短语（有关更多信息[http://community.aegirproject.org/node/30#SSH_keys](http://community.aegirproject.org/node/30#SSH_keys)但如果您想要密码短语有解决方案）。创建后，您将拥有密钥的随机图像。（研究 SSH 对安全性来说太重要了！）

    ```
    ssh-keygen -t rsa 
    ```

4.  复制密钥，然后转到您的 GitHub/Lab->account/profile settings->SSH 密钥->添加 SSK 密钥。对于标题，请提供您想要的任何内容（例如：Aegir Key），对于密钥，请从您的服务器粘贴密钥。

    ```
    cat ~/.ssh/id_rsa.pub 
    ```

5.  现在回到服务器，您必须将 Git 添加为已知主机，我们采用简单的方法：只需使用 ssh 登录并在它要求连接时键入 yes。准备好！！

    ```
    ssh git@github.com
    - or -
    ssh git@gitlab.com 
    ```

6.  测试：制作一个 .make 文件并将其保存在公共位置（如 Dropbox，右键单击复制公共 url），例如：

    ```
    core = 7.x
    api = 2
    projects[drupal][version] = 7.26
    projects [my_module_name][type] = "module"
    projects [my_module_name][download][type] = "git"
    projects [my_module_name][download][url] = "git@gitlab.com:my_repo.git"
    projects [my_module_name][download][branch] = "master" 
    ```

7.  转到aegir gui并创建一个新平台并等待验证（否则您可以ssh作为aegir到服务器并使用drush make url.make文件夹进行测试）

**警告！**这个工作流程不是最安全的！只需尝试一下并正确配置您的服务器！

**信息：**此工作流程也适用于您的本地开发机器（linux、mac、cygwin），以使用 GitHub 和 GitLab 上的私有存储库

# c# - c# 列表方法：ElementAt(index) vs Find(content)

> ID：10728828
> 
> 赞同：1
> 
> 时间：2012-05-23T22:36:17.387
> 
> 标签：c#, linq, list

我目前正在构建一个非常依赖效率的数据结构。

谁能向我提供有关 Find(item => item.X = myObject.Property) 方法实际工作原理的资源？它是否在所有元素中线性迭代，直到找到元素？

如果我知道 myObject 的索引并使用 ElementAt(index) 怎么办？

请问这两个哪个效率最高？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T22:40:25.173

来自[`MSDN documentation on List<T>.Find`](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)

> 该方法执行线性搜索；因此，此方法是 O(n) 操作，其中 n 是 Count。

我*想*这`ElementAt`是优化的`IList`并将做一个直接索引。但是既然你显然是在使用`List`具体类型的这个对象，为什么不直接做一个索引呢？像这样：

```
var result = list[index]; 
```

如果您已经知道索引，则无需搜索。直接去吧。

# asp.net - 通过安全通道传递会话而不会丢失它

> ID：10728829
> 
> 赞同：2
> 
> 时间：2012-05-23T22:36:38.123
> 
> 标签：asp.net, asp.net-mvc-3, nopcommerce

我已经在 abc.domainName.com 上安装了 nopcommerce v 2.5，并且我有一个通配符 SSL 证书到不同的域名，但在同一服务器前 abc.domainNameSSL.com 上。所以当我使用它时，当我从非安全页面转移到安全页面时，我正在失去我的会话。

那么谁能告诉我在这种情况下通过会话的最佳方法是什么。？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:42:22.160

如果您在一个域上通过身份验证，然后转移到另一个域，您将丢失会话 cookie，因为它不能跨域。

例如，如果您登录到 abc.name.com，然后转移到另一个域（即 abc.nameSSL.com），即使它是完全相同的网站，您也会失去会话。服务器正在寻找存储在 abc.name.com 下的会话 cookie。现在您在 abc.namessl.com 上找不到它。因此，您没有登录。

一种解决方法是不更改根域 (name.com)，而是执行 abcssl.name.com 之类的操作。您必须为会话 cookie 设置域通配符，但它会起作用。

# iphone - 带有孩子的 UIView 上的 TouchUpInside

> ID：10728830
> 
> 赞同：22
> 
> 时间：2012-05-23T22:36:51.247
> 
> 标签：iphone, uiview-hierarchy, touch-up-inside

我可能在这里遗漏了一些东西，但是...

我有`UIView`几个孩子（几个`UILabel`' 和`UIImageView`）。当用户单击（点击）父级内的任何位置时，我需要捕捉一个事件-或其任何子级的`UIView`可见部分）。`UIView`

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-05-24T07:36:39.390

您可以在 Identity Inspector 中更改 UIView 的类......`UIControl`然后您可以`UITouchUpInside`为您的视图添加一个事件 - 以捕捉它的点击。

祝你好运！

编辑：这是一步一步的截图：

风景... ![原始视图 - UIView 类型](../Images/283ceed76721c70df7ab8a9bced6ce43.png)

...当然，没有事件。 ![UIView 没有可以使用的事件](../Images/8099cd04bb1560500699f29397c99c79.png)

返回并使用 UIControl 更改 UIView 和... ![将 UIView 更改为 UIControl](../Images/1c08b683cd4b4cc3b4d1841a2a1c8fec.png)

达达！活动！ ![UIControl 允许您使用事件](../Images/71fe24bc516eebef445824d20593b397.png)

将方法挂钩到 UITouchUpInside 事件 ![为 UITouchUpInside 添加事件](../Images/27ce670fe139b332e7e5e283aa2876f2.png)

这就是它在接口文件中的样子 ![方法接口](../Images/3fcc706f8609522e8f24d5818cc628c1.png)

这就是它在实现文件中的样子（当然，你可以用你想要的任何东西替换日志） ![方法的实现](../Images/dd5fd8c0fa65d6ece56bd6a38fe4a7b8.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-23T23:24:33.710

您可以通过为您的父视图设置一个手势识别器并确保您的孩子没有自己的手势识别器来假装这种行为。为此，请向您的父母添加一个手势识别器以`UIView`监听轻按。`parentView`您的子视图 ( `UILabels`/ `UIImageView`)的包含视图在哪里，并且`handleTap`是由 实现的方法`parentView`，请执行以下操作：

```
UIGestureRecognizer *tapParent = [[UITapGestureRecognizer alloc]initWithTarget:parentView action:@selector(handleTap)];
[parentView addGestureRecognizer:tapParent];
[tapParent release]; 
```

由于您的子视图没有自己的手势识别器，它们不会“吃掉”手势，因此只要您在其范围内点击，父视图就会响应。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T23:24:18.697

您必须提供更多详细信息，因为有多种选择。

如果您想要正常的点击，您可以捕获标准触摸事件之一并查看哪个子视图得到了该事件。像这样的东西：

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [touches anyObject];
    if(touch.view != self.mySubViewOfInterest)
    {
        // perform my actions
    }
} 
```

如果您需要复杂的手势识别，那么您可以使用 UIGestureRecognizer 之一并将其分配给子视图或主视图。

无论如何，您必须注意所有子视图（您希望它们捕获事件的子视图）必须启用用户交互，否则您的主视图也会捕获子视图的事件，您最终会在不了解什么的情况下进行调试和调试正在发生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-02-16T00:46:09.103

**斯威夫特 4：**

```
let clickGesture = UITapGestureRecognizer(target: self, action:  #selector(self.onUiViewClick))
uiView.addGestureRecognizer(clickGesture)

 @objc func onUiViewClick(sender : UITapGestureRecognizer) {

    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-13T14:19:01.447

这对我有用

**斯威夫特 3**

```
 let gesture = UITapGestureRecognizer(target: self, action: selector(self.customViewClick))
withSender: self)
 customView.addGestureRecognizer(gesture)

 func customViewClick()  {
     print("custom view clicked!")
    } 
```

# c# - 在加载所有相关数据之前如何不显示 JQuery 对话框？

> ID：10728831
> 
> 赞同：1
> 
> 时间：2012-05-23T22:37:17.317
> 
> 标签：c#, javascript, jquery, ajax, model-view-controller

在填充所有数据（文本框、下拉菜单等）之前显示的 JQuery dialog() 存在问题。

我只是调用：

```
$("#myDiv").dialog("open") is called 
```

然后在对话框属性下：

```
 $("#myDiv").dialog({
        title: "Edit User",
        autoOpen: false,
        height: 500,
        width: 500,
        modal: true,
        open: function(event,ui){
        url = "/controller/action" + param;
        $(this).load(url);

        ...various $.ajax and $.GetJson calls to populate form drop down menus and other fields...},
        buttons: {
            Cancel: function () {
                $(this).dialog("close");
            }
        },
        close: function () {
            allFields.val("").removeClass("ui-state-error");
        }
    }); 
```

因此会打开一个对话框，大约几秒钟后会闪烁并填充数据。有时它会滞后，并且数据根本不会进入字段。在最终填充对话框之前，我可能必须多次关闭/重新打开对话框。非常令人沮丧。

让这个工作最简单的方法是什么？我希望每次弹出对话框都正确填充数据，并且在准备好之前不显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:41:00.243

这是问题所在：

```
 open: function(){
    ...various $.ajax and $.GetJson calls to populate form drop down menus and other fields...}, 
```

不要在打开时填充，在创建时填充

```
create: function(){
    ...various $.ajax and $.GetJson calls to populate form drop down menus and other fields...}, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:07:01.250

您可以尝试[BlockUI](http://jquery.malsup.com/block/)插件并在您的 Ajax/Json 调用之前阻止并在它们之后取消阻止。这也将允许您在对话框上显示加载 div。

```
$.blockUI()
// ajax/json calls
$.unblockUI(); 
```

# ruby-on-rails - rails 3.2.3 rake assets：预编译任务需要超过 30 分钟

> ID：10728835
> 
> 赞同：1
> 
> 时间：2012-05-23T22:37:42.333
> 
> 标签：ruby-on-rails, ruby, rake, asset-pipeline

这个应用程序的问题是 WIP，所以我们没有使用任何东西将它部署到我们的生产服务器，我们只是从 github 克隆它，每次我们完成一些事情时我们都会执行 git pull，rake assets:precompile 任务需要超过30分钟完成！，WTF？。

我们正在这样做：

```
$ bundle exec rake assets:clean
$ bundle exec rake assets:precompile 
```

我们的生产服务器：

*   红宝石 1.9.3p194 (rbenv)
*   导轨 3.2.3
*   独角兽
*   nginx

我们的 rails + unicorn + rbenv + init.d 守护进程配置在这里：[https ://gist.github.com/2776085](https://gist.github.com/2776085)

现在，这是我们的资产清单、Gemfile 和我们的 production.rb 文件：[http ://pastie.org/3958070](http://pastie.org/3958070)

那么，有人知道为什么这需要这么长时间吗？还是有一种方法可以加快生产中的资产编译速度？

谢谢你。

**更新：**本地资产编译时间：http: [//pastie.org/3961734](http://pastie.org/3961734)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T21:23:22.550

Rails 的资产管道看起来比 app/assets/{javascripts,stylesheets} 更进一步。如[指南](http://guides.rubyonrails.org/asset_pipeline.html#asset-organization)中所述，您还可以在其他位置放置应用程序的资产：

*   应用程序/资产
*   库/资产
*   供应商/资产

我建议您阅读[Rails 资产管道](http://guides.rubyonrails.org/asset_pipeline.html)的完整指南以获取有关所有这些的更多信息以及生产环境的一些提示，例如用于缓存的 nginx 规则、加速资产预编译等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T20:23:56.107

是我们的错，我们在 app/assets 中有一个额外的文件夹，比如 app/assets/blah 里面有很多文件夹，所以资产管道正在查看那里，但我们不知道为什么资产管道没有只是查看 app/assets/javascripts 和 app/assets/stylesheets。

# php - gzdecode 和 PHP？

> ID：10728841
> 
> 赞同：-1
> 
> 时间：2012-05-23T22:38:27.187
> 
> 标签：php, gzip

> **可能重复：**
> [通过 PHP 解压缩 .gz 文件](https://stackoverflow.com/questions/4548824/decompressing-a-gz-file-via-php)

我不能将 gzdecode 与 php 一起使用，因为它没有安装并且我无法安装它，

到目前为止我一直在使用这个...

```
// GZIP DECODE
function gzDecode($d) {
$f = ord(substr($d, 3, 1));
$h = 10;
$e = 0;
if($f&4) {
    $e = unpack('v', substr($d, 10, 2));
    $e = $e[1];
    $h += 2 + $e;
}
if($f&8) {
    // ERROR HERE
    $h = @strpos($d, chr(0), $h) + 1;
}
if($f&16) {
    $h = strpos($d, chr(0), $h) + 1;
}
if($f&2) {
    $h += 2;
}
// ERROR HERE
$u = @gzinflate(substr($d, $h));
if($u == false) {
    $u = $d;
}
return $u;
} 
```

它可以工作，但 PHP 5.3 有更好的解决方案吗？如果没有，有什么办法可以摆脱存在的错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T23:05:03.520

您是否看过[http://php.net/gzdecode](http://php.net/gzdecode)的评论中显示的一些材料？评论包括[一个简单的使用方法`gzinflate()`](http://php.net/gzdecode#106397)和[一个纯 PHP 实现](http://php.net/gzdecode#82930)的`gzdecode()`函数，你可以完全提升。

作为一般经验法则，不要在不必要的地方重新发明轮子！

# c++ - C++递归模板类型推导

> ID：10728842
> 
> 赞同：6
> 
> 时间：2012-05-23T22:38:40.883
> 
> 标签：c++, templates, recursion, template-meta-programming

我有兴趣学习一些关于模板元编程的知识。在下面的代码中，我试图找到一个足够大的无符号整数类型来容纳 N 位，在编译时指定，使用一些模板递归。

```
template <typename T>
struct NextIntegralType
{
};

template <>
struct NextIntegralType<void>
{
    typedef unsigned char type;
};

template <>
struct NextIntegralType<unsigned char>
{
    typedef unsigned short type;
};

...More type 'iteration' here...

template<size_t BITS, typename T>
struct FindIntegralType2
{
    typedef std::conditional<BITS <= sizeof(typename T::type)*8, T, FindIntegralType2<BITS, NextIntegralType<typename T::type>>> _type;
    typedef typename _type::type type;
};

template<size_t BITS>
struct FindIntegralType
{
    typedef typename FindIntegralType2<BITS, NextIntegralType<void>>::type type;
}; 
```

当我声明一个变量并为其分配一个整数值时......

```
FindIntegralType<15>::type test(4000); 
```

我得到以下信息：

```
error: no matching function for call to ‘FindIntegralType2<15u, NextIntegralType<unsigned char> >::FindIntegralType2(int)’
note: candidates are:
note: constexpr FindIntegralType2<15u, NextIntegralType<unsigned char> >::FindIntegralType2()
note:   candidate expects 0 arguments, 1 provided
note: constexpr FindIntegralType2<15u, NextIntegralType<unsigned char> >::FindIntegralType2(const FindIntegralType2<15u, NextIntegralType<unsigned char> >&)
note:   no known conversion for argument 1 from ‘int’ to ‘const FindIntegralType2<15u, NextIntegralType<unsigned char> >&’ 
```

似乎我的递归不是“展开”。谁能指出我正确的方向？

注意：我使用的是**GCC 4.6**。

**编辑：**
我发现了一个我之前错过的帖子：
[自动选择一个足够大的变量类型来容纳指定的数字](https://stackoverflow.com/questions/7038797/automatically-pick-a-variable-type-big-enough-to-hold-a-specified-number)

这指向了 boost 中的答案（它们总是在哪里）：
[boost_integer](http://www.boost.org/doc/libs/1_47_0/libs/integer/doc/html/boost_integer/integer.html)

这应该可以解决我的实际需求和求知欲。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:59:56.667

您的问题是`_type::type`评估为`std::conditional<...>::type`，而不是`FindIntegralType2<...>::type`。将其更改为`typedef typename _type::type::type type;`（太多`type`x_X）。这应该可以解决您的问题。

# c++ - C ++中类之间的变量超出范围

> ID：10728847
> 
> 赞同：0
> 
> 时间：2012-05-23T22:39:23.913
> 
> 标签：c++, class, scope

我刚刚重新开始编程，如果这很愚蠢，请原谅我。

我有 2 节课（目前）。一个是 Windows 窗体类，我在其中使用 Button_Click 事件来触发通信端口打开。我想将用户在表单上输入的数据传递给 Communication 类以进行进一步处理（发送）。这是初始化和调用通信类的部分：

```
wchar_t * data = new wchar_t[nLength];
    *data = *wch;

    SerialCommunication comm1;
    bool comm1ok = comm1.SerialWrite(data); 
```

变量“数据”是一个指针，所以我想将它的地址传递给另一个类来使用。这是我的第二堂课：

```
bool SerialCommunication::SerialWrite(wchar_t * datar){... 
```

但数据永远不会在那里。一旦 SerialWrite() 函数启动，它就会超出范围。我是否需要以其他方式声明此指针以确保它在我在类之间移动时不会消失？

据我所知，这两个类都是公开的（好吧，我写了 SerialCommunication 一个，所以我知道它是公开的）。

我究竟做错了什么？我应该改变什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T22:42:47.807

这：

```
*data = *wch; 
```

不做你认为的（或我假设你认为的）。它只是将 的第一个元素复制`wch`到 的第一个元素中`data`。

# jquery - 页面加载时更改jQuery中元素的背景图像？

> ID：10728848
> 
> 赞同：1
> 
> 时间：2012-05-23T22:39:41.177
> 
> 标签：jquery, css, image

我现在有点卡住了，我基本上在 DOM 中有我的标题元素，并且我有一个在 CSS 中为索引页面硬编码的背景图像。

我想做的是让这张图片在不同的页面上发生变化。我认为这将是一件非常简单的事情。

```
$('header').css("background-image","url(assets/img/consulting.png)") 
```

我意识到没有事件触发器，但我的印象是我实际上不需要这样做。

此外，我的 CSS 文件和我要添加 jQuery 的页面的文件与 img 文件夹一样位于不同的文件夹中......我不确定我应该如何在 jQuery 代码中调用 url。是否应该像从 CSS 文件或 HTML 文件导航一样？

谢谢大家，对不起，如果我在这里错过了一些非常明显的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:52:42.680

这是我将采取的方法，只是从 jQuery 中删除大部分 css，尽管您可能只是想要一个单击事件。

我会为每一页做这个。

```
<body class="home">
<body class="about">
<body class="contact"> 
```

然后在你的 CSS 中做

```
.home header { background-image: url(../assets/img/consulting.png"; }
.about header { background-image: url(../assets/img/consulting2.png"; }
.contact header { background-image: url(../assets/img/consulting3.png"; } 
```

如果您的网站是加载其他页面内容而不刷新它们的单个索引，您可以这样做。

```
$(function(){
    $('#aboutlink').click(function(e){
        $('body').removeClass().addClass('about');

        //your other snippets here

        e.preventDefault();
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:46:55.470

要更改页面的初始状态，您必须等到页面加载完毕后再运行 javascript。

有几种方法可以做到这一点。jQuery 中最常见的有：

1）使用document.ready（）：

```
$(document).ready(function() {
    $('header').css("background-image","url(assets/img/consulting.png)")
}); 
```

2）将您的代码放在`<script>`标签内，但在正文的末尾（就在`</body>`标签之前），以便在 HTML 已被解析后运行。

当然，您必须确保您的图像 URL 也是正确的，并且具有可供浏览器找到的适当路径规范。

如果您控制页面的 HTML/CSS，最好将初始状态放入页面的 CSS 样式中，因为页面将从一开始就以正确的方式呈现，而不是以一种方式呈现，然后使用JS 将其更改为另一种方式。

# jquery - 使用 jQuery 淡化表格单元格

> ID：10728850
> 
> 赞同：0
> 
> 时间：2012-05-23T12:31:59.587
> 
> 标签：jquery

我找到了这段代码，它应该找到可见行中的第一个单元格，当我单击它时，单元格应该淡出或淡入。

我想调整代码，以便输入按钮可以做到这一点，我该怎么做？

```
$('tr:visible').find('td:first').click(function () {
            $(this).parent().next().fadeToggle() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T12:46:44.630

我想您的意思是当您单击特定按钮时应该执行该功能。

```
button.click(function () {
    $('tr:visible').find('td:first').parent().next().fadeToggle()
} 
```

其中 'button' 是一个变量，它引用了您希望执行淡入淡出的按钮。

# applescript - 通过 Applescript 关闭 QuickTime

> ID：10728854
> 
> 赞同：0
> 
> 时间：2012-05-23T22:40:17.560
> 
> 标签：applescript, quicktime

我正在尝试一次全屏播放电影，然后以可编程方式关闭播放器。我尝试过使用 QTMovieView、命令行和 AppleScript，发现 Applescript 是最简单的方法。

但是，因为我真的不知道 Applescript，所以我不能在电影播放后让 QuickTime 自动关闭。

一切正常，但重复行中无法识别“完成”。这是出现此错误的脚本：

错误“QuickTime Player 出现错误：无法将文档 1 转换为类型说明符。” 从文档 1 的完成到说明符的数字 -1700

```
tell application "QuickTime Player"
  activate
  open "/Users/...real path of the movie.mov"
  present document 1
  play document 1

  repeat until (get done of document 1)
  end repeat

  delay 2
  close document 1
end tell 
```

最后我改成这样了，这样可以吗？

```
tell application "QuickTime Player"
    quit
end tell
tell application "QuickTime Player"
    activate
    open "/Users/.../...mov"
    tell document 1
        present
        play
        repeat until playing is false
        end repeat
        delay 2
        close
    end tell
    quit
end tell 
```

新问题：视频结束前应用挂起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:51:46.743

这对我有用，但它似乎不是很健壮。鉴于它们都是实数，是否可以*保证*`current time`will 始终等于 the ？`duration`您可能希望在`repeat`条件中加入一些“在 epsilon 内”的逻辑。

```
tell application "QuickTime Player"
    play document 1
    repeat until (current time of document 1 = duration of document 1)

    end repeat
    delay 2
    close document 1
end tell 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T01:33:05.043

尝试：

```
tell application "QuickTime Player"
    tell document 1
        present
        play
        repeat until playing is false
            delay 1
        end repeat
    end tell
quit
end tell 
```

# emacs - 如何使用 elisp 在缓冲区中插入更长的列表？

> ID：10728859
> 
> 赞同：3
> 
> 时间：2012-05-23T22:40:36.360
> 
> 标签：emacs, elisp

如果我执行 Cu M-: （将 lisp 语句的结果插入缓冲区），然后执行以下操作：

```
(progn (setq x 0 l '()) (while(< x 30) (push (random 99) l) (incf x 1)) (nreverse l)) 
```

我得到：

```
(89 29 27 23 56 88 37 11 33 20 98 95 ...) 
```

带有尾随省略号。有什么办法解决这个问题？结果列表中的缓冲区插入之类的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T22:53:08.627

尝试

```
(setq eval-expression-print-length nil) 
```

在 .emacs 中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T06:46:08.317

`M-:``(insert (pp (loop repeat 30 collect (random 99))))`

可能需要`(require 'cl)`先。

# javascript - django 视图 - 502 错误网关

> ID：10728862
> 
> 赞同：2
> 
> 时间：2012-05-23T22:41:09.697
> 
> 标签：javascript, jquery, python, django

我正在生产服务器中测试我的项目，我的 Web 应用程序中的各种功能出现了几个错误，这些错误在我的计算机上运行良好。

请访问[http://qlimp.com](http://qlimp.com)并使用此**用户名/密码登录：nirmal/karurkarur**然后访问[http://qlimp.com/cover](http://qlimp.com/cover)您会找到一个调色板，您可以在其中上传图像并执行类似**风味的操作.我**。我在这里遇到了几个问题（图像、文本、其他信息没有存储在数据库中）。

我认为设置没有问题。问题是它甚至没有正确进入 Django 视图，但在我的计算机上没有任何问题。有没有人遇到过同样的问题？我想知道为什么它不起作用。

[您也可以在http://qlimp.com/signup/](http://qlimp.com/signup/)中查看，您可以找到未存储数据的问题。

所以有很多问题我不能在一个问题中问（不是stackoverflow文化），所以我问这个。

当我上传我在**chrome 检查器“网络选项卡”**中检查的图像时，它显示**502 bad gateway**

[这是我](https://gist.github.com/2778242)的Django **views.py：https://gist.github.com/2778242**

****ajax 图片上传的****jQuery**代码：**

 **```
$('#id_tmpbg').live('change', function()
    {
    $("#ajax-loader").show();
    $("#uploadform").ajaxForm({success: showResponse}).submit();
    });

    function showResponse(responseText, statusText, xhr, $form)  { 
    $.backstretch(responseText)
    $("#ajax-loader").hide();
    } 
```

而且我还检查了它实际上是在进入`request.is_ajax()`但不是`form.is_valid()`在我的观点中。为什么会这样？我正在上传正确的格式。

谁能指出我犯的错误？我还需要一个关于为什么代码不能在实际在开发服务器上工作的生产服务器上运行的答案（这将有助于我解决其余的问题）。

开发服务器：Ubuntu 11.10/Python 2.7/Django 1.3.1

生产服务器：Ubuntu 12.04/Python 2.7/Django 1.3.1

**更新**

每个人都使用相同的用户/密码登录存在一些问题。所以请在那里注册，它显示**[Errno 111] Connection denied**，没关系，你可以登录。

**更新-2**

实际上问题出在 form.is_valid() 所以我删除它并检查但现在我收到了这个错误：

```
Exception Type: ValueError
Exception Value:    The BackgroundModel could not be created because the data didn't validate.
Exception Location: /home/nirmal/project/local/lib/python2.7/site-packages/django/forms/models.py in save_instance, line 73 
```

我一直在上传正确的图像格式，但我不知道为什么它没有验证。

**更新-3**

[对于http://qlimp.com/cover](http://qlimp.com/cover)中的所有静态文件，我都收到**304 Not Modified**这会是不工作的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T12:22:05.697

当 gunicorn 不可用时，Nginx 会给出 502 错误。

`gunicorn_django -bind=127.0.0.1:8001`只启动一个同步工作进程，它可能正忙于响应其他请求。

您可能想要产生更多的工人 ( `-w2`)。如果您需要处理大数据传输，请考虑使用异步工作者风格（例如`-k gevent`，您需要安装 gevent）。

[Gunicorn FAQ](http://gunicorn.org/faq.html)中有关选择工人阶级和工人数量的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:21:49.063

我发现了过去 3 天一直困扰我的问题。这是因为我忘记`sudo apt-get install libjpeg62 libjpeg62-dev zlib1g-dev`在 PIL 安装之前执行此操作，这就是图像未得到验证的原因。

下一个问题是我在我的 settings.py 文件中给出了 MEDIA_ROOT 的相对路径，`404 NOT FOUND`我将其更改为绝对路径。

所以这些都是简单的错误，会导致一些神秘的错误。也感谢大家的帮助。**

# go - 如何在并发 goroutine 期间锁定/同步对 Go 中变量的访问？

> ID：10728863
> 
> 赞同：16
> 
> 时间：2012-05-23T22:41:13.897
> 
> 标签：go, goroutine

在他对这个问题的回答中： [Golang for Windows 不稳定的行为？](https://stackoverflow.com/questions/3918941/golang-for-windows-erratic-behavior) 用户@distributed 建议在并发 goroutine 上锁定/同步对共享变量的访问。

我怎样才能做到这一点？

更多关于这个问题：

`views`我同时在多个 goroutine上运行此代码（返回的带有闭包的函数）：

```
func makeHomeHandler() func(c *http.Conn, r *http.Request) {
    views := 1
    return func(c *http.Conn, r *http.Request) {
        fmt.Fprintf(c, "Counting %s, %d so far.", r.URL.Path[1:], views)
        views++
    }
} 
```

看起来 IO 函数需要时间，结果我得到了这种输出：

```
Counting monkeys, 5 so far.
Counting monkeys, 5 so far.
Counting monkeys, 5 so far.
Counting monkeys, 8 so far.
Counting monkeys, 8 so far.
Counting monkeys, 8 so far.
Counting monkeys, 11 so far. 
```

它递增得很好，但是当它被打印出来时，我可以看到打印+递增操作根本不是原子的。

如果我将其更改为：

```
func makeHomeHandler() func(c *http.Conn, r *http.Request) {
    views := 0
    return func(c *http.Conn, r *http.Request) {
        views++
        // I can only hope that other goroutine does not increment the counter 
        // at this point, i.e., right after the previous line and before the 
        // next one are executed!
        views_now := views
        fmt.Fprintf(c, "Counting %s, %d so far.", r.URL.Path[1:], views_now)
    }
} 
```

它似乎工作正常，但我不完全确定它是否最终不会失败......

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-24T10:34:12.113

如果您想要一个同步的计数器，那么使用`sync.Mutex`是规范的解决方案。sync/atomic 包应该只用于低级别的东西，或者当您测量到严重的性能问题时。

```
type Counter struct {
    mu  sync.Mutex
    x   int64
}

func (c *Counter) Add(x int64) {
    c.mu.Lock()
    c.x += x
    c.mu.Unlock()
}

func (c *Counter) Value() (x int64) {
    c.mu.Lock()
    x = c.x
    c.mu.Unlock()
    return
}

func makeHomeHandler() func(c http.ResponseWriter, r *http.Request) {
    var views Counter
    return func(w http.ResponseWriter, r *http.Request) {
        fmt.Fprintf(w, "Counting %s, %d so far.", r.URL.Path[1:], views.Value())
        views.Add(1)
    }
} 
```

对于您的特定问题，我建议定义一个满足 http.Handler 接口的新类型，而不是返回一个闭包。这看起来也更简单：

```
type homeHandler struct {
    mu  sync.Mutex
    views   int64
}

func (h *homeHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {
    h.mu.Lock()
    defer h.mu.Unlock()
    fmt.Fprintf(w, "Counting %s, %d so far.", r.URL.Path[1:], h.views)
    h.views++
}

func init() {
    http.Handle("/", new(homeHandler))
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-23T23:07:54.830

[同步](http://golang.org/pkg/sync/)包有一些同步原语。根据问题，您可以使用 RWMutex 或普通的 Mutex。

如果您想要更具体的答案，请提供有关其用途的更多信息。

编辑：阅读链接问题后，您可能正在寻找[sync/atomic](http://golang.org/pkg/sync/atomic)，尽管 Mutex 也可以。

Edit2：我看到你用一个例子更新了你的帖子。这是使用同步/原子的代码。

```
func makeHomeHandler() func(w http.ResponseWriter, r *http.Request) {
    var views *uint64 = new(uint64)
    atomic.StoreUint64(views, 0) // I don't think this is strictly necessary
    return func(w http.ResponseWriter, r *http.Request) {
        // Atomically add one to views and get the new value
        // Perhaps you want to subtract one here
        views_now := atomic.AddUint64(views, 1) 
        fmt.Fprintf(w, "Counting %s, %d so far.", r.URL.Path[1:], views_now)
    }
} 
```

~~（注意：我没有测试过上面的，所以可能有错别字/brainfarts）~~我现在测试了。

# javascript - 在 nodejs express 应用程序的链接中发送 DELETE 请求

> ID：10728864
> 
> 赞同：0
> 
> 时间：2012-05-23T22:41:30.060
> 
> 标签：javascript, http, node.js, rest, express

我有一条接受 DELETE 请求的路线，我知道使用 Express 你可以添加

```
 <input type="hidden" name="_method" value="delete" /> 
```

到向 url 发送 POST 请求的表单。

但是，您将如何使用链接而不是表单来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T05:40:36.827

GET 请求不支持此操作：

[`methodOverride()`](https://github.com/senchalabs/connect/blob/master/lib/middleware/methodOverride.js)仅检查`req.body`（POST 参数）和请求标头 - 都不能为常规链接设置（但是，即使它们使用 GET，您*也可以在 AJAX 请求中设置自定义标头）。*

这是有道理的，否则即使使用 CSRF 令牌也可能是一个主要问题。您永远无法知道浏览器何时会决定预取链接 - 因此 GET 请求不应*执行*诸如删除内容之类的操作。

如果你真的需要它并且不关心它的缺点，可以考虑编写一个自定义函数：

```
function methodOverrideGET(key) {
    key = key || "_method";
    return function methodOverrideGET(req, res, next) {
        if (req.originalMethod != req.method) {
            // already overridden => do not override again
            next();
            return;
        }

        req.originalMethod = req.method;
        if (req.query && key in req.query) {
            req.method = req.query[key].toUpperCase();
            delete req.query[key];
        }
        next();
    };
}; 
```

现在您可以`.use(methodOverrideGET)` *在* `.use(methodOverride)`之后简单地添加`_method=DELETE`到查询字符串中。

# c# - 错误：C# 文件夹浏览器对话框，试图读取或写入受保护的内存

> ID：10728870
> 
> 赞同：0
> 
> 时间：2012-05-23T22:42:10.957
> 
> 标签：c#, visual-studio-2008, dialog

我正在 Visual Studio 2008 中开发一个使用文件夹浏览器对话框和打印对话框的 C# 应用程序。`ShowDialog()`最近，每当调用这两个对话框的 Method时，程序都会遇到错误。

错误说：

> 尝试读取或写入受保护的内存。这通常表明其他内存已损坏。

奇怪的是，这个错误只针对这个项目。当我在新的 C# 项目中使用文件夹浏览器对话框时，它工作得非常好。此外，这个错误最近开始在提到的项目中发生。早些时候，它曾经工作得很好。此外，当我在调试模式下从 IDE 运行程序时，不会发生此错误。

在 Stack Overflow 上的其他一些问题中，有一个建议是取消选中调试选项中的“在模块加载时抑制 JIT 优化”。我也试过了，但这并没有解决我的问题。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:01:39.190

没有看到任何代码很难说什么。我已经看到在创建线程之外的线程上访问 UI 时遇到了这个问题。为避免这种情况，如果您在某个线程中弄乱了 UI 控件，您可以创建如下所示的函数

```
public static void ExecuteAction(Control myControl, Action myAction) 
{
    if (myControl.InvokeRequired) { myControl.Invoke(myAction); }
    else { myAction(); }
} 
```

然后，您只需使用控件和您想要执行的操作（例如，更改其颜色或什么）从您想要的任何线程调用它。

我没有特别看到 Dialogs 的问题，因为我很长时间没有对它们做任何事情，但由于这是一个 UI 问题，而且它与我之前看到的错误消息相同，我会试一试.
您还可以检查 Control.CheckForIllegalCrossThreadCalls 的值。[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.checkforillegalcrossthreadcalls.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.checkforillegalcrossthreadcalls.aspx)

# c# - 为什么我可以使用 FileSystemObjects 来读取和写入客户端二进制文件，但不能用于读取和发送它们到服务器？

> ID：10728873
> 
> 赞同：0
> 
> 时间：2012-05-23T22:42:31.400
> 
> 标签：c#, javascript, vbscript, binary-data, filesystemobject

我以以下方式创建了一个二进制文件（以确保所有可能的字节值都在二进制文件中）：

```
using (var fs = File.Create(fileName))
{
    for (byte b = 0; b < Byte.MaxValue; b++)
    {
        fs.WriteByte(b);
    }
} 
```

我以这种方式阅读它（用于测试它是否有效）：

```
using (var fs = File.Open(fileName, FileMode.Open))
{
    long oldPos = -1;
    long pos = 0;
    while (oldPos != pos)
    {
        oldPos = pos;
        Console.WriteLine(Convert.ToString(fs.ReadByte(), 2).PadLeft(8, '0'));
        pos = fs.Position;
    } 
} 
```

在 IE 中的 javascript 中，复制文件（读取它，然后将其写回）在使用时工作得很好`FileSystemObject`：

```
var fso = new ActiveXObject("Scripting.FileSystemObject");
var from = fso.OpenTextFile(fileToRead, 1, 0); // read, ASCII (-1 for unicode)
var to = fso.CreateTextFile(fileToWriteTo, true, false); 
while (!from.AtEndOfStream) {
    to.Write(from.Read(1));
}
from.Close();
to.Close(); 
```

当我读取输出的二进制文件时，我得到 00000000,00000001,00000010... 等等。

但尝试将其读入 javascript 似乎会导致无法读取：

```
var fso = new ActiveXObject("Scripting.FileSystemObject");
var from = fso.OpenTextFile(fileToRead, 1, 0); 
var test = [];
while (!from.AtEndOfStream) {
    test.push(0xff & from.Read(1));  // make it a byte.
}
from.Close(); 
```

这导致 test 在它的数组中有一堆 0，以及一些其他非零项，但大多数只是 0。

有人可以解释为什么它适用于一个而不是另一个吗？我需要做什么才能将值输入 javascript？

顺便说一句，[这里是从客户端机器上读取文件的相关阅读](http://www.javascripter.net/faq/reading2.htm)：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T15:52:08.737

首先，您知道最终数组的长度是否与文件的长度相同？

在单独的操作中尝试读取和“推送”，例如：

```
...  
Test2 = from.Read(1));  
// Possibly display value of Test2 as string  
test.push(Test2);  
... 
```

此外，您可以尝试使用文本数据来查看是否是导致问题的文件/数据的二进制性质。

# javascript - Jquery .each 使用相对路径时？

> ID：10728880
> 
> 赞同：0
> 
> 时间：2012-05-23T22:42:54.630
> 
> 标签：javascript, jquery, path, each

当使用相对路径（而不仅仅是类名）时，我无法弄清楚如何让 .each 工作。这可以正确检查单选按钮是否被选中，但是它会继续为它们两个显示 .radio_select 。所以很明显只是检查第一个值，然后将结果应用于两者，当我希望它单独检查两个值时。谁能弄清楚我做错了什么？有没有更好的方法可以做到这一点？任何帮助表示赞赏，谢谢。

```
<div id='pid'></div>

<div class='comment_reply_holder'>

<div class="radio_holder">
<div class='radio_select'>
<input class='hidden_radio' type='radio' checked='true'>
</div>
</div>

<div class="radio_holder">
<div class='radio_select'>
<input class='hidden_radio' type='radio'>
</div>
</div>

</div>

<script>
radio = $('#'+pid).next('.comment_reply_holder').children().find('.radio_holder');
radio.each(function() {
if (radio.children().find('.hidden_radio').prop("checked") == true) {
radio.children().find('.radio_select').show();
}
});
</script> 
```

注意：“pid” div 是在站点上动态创建的，如果您想知道我为什么要以这种方式创建路径，这就是为什么我以这种方式获取信息的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:45:23.160

只需`this`在回调函数中使用（即当前迭代的元素），而不是您的外部变量`radio`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:45:49.667

```
radio.each(function(i,elem) {
  if (elem.children().find('.hidden_radio').prop("checked") == true) {
    elem.children().find('.radio_select').show();
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T22:47:51.073

你为什么用收音机？你需要物品吗？

```
radio.each(function(i, item) {
   if (item.children().find('.hidden_radio').prop("checked") == true) {
   item.children().find('.radio_select').show();
} 
```

# windows-7 - 在 windows 中支持两个 shell

> ID：10728881
> 
> 赞同：1
> 
> 时间：2012-05-23T22:43:04.553
> 
> 标签：windows-7

我想编写我自己的（非常简单的）`explorer.exe`替代方案，我可以在无需重新启动计算机的情况下主动切换。

1.  是否可以同时运行两个 shell（或编写一个临时禁用当前 shell 的程序）？
2.  如果没有，是否可以在不重新启动自己的情况下停止资源管理器，并让我的 shell 自行启动？

**编辑**

更多信息：我想为自己编写一个简单的生产力工具。我想设置一个非常简单的任务管理器，阻止我启动/打开/使用除我提前列出的白名单应用程序集之外的任何东西。在我设定的任何时间段内将我锁定在该组应用程序中。如果有另一种（更好的）方法可以防止人们关闭我的应用程序，从我的应用程序切换（使用 alt-tab 等），我会全力以赴。

注意：我可以通过重新启动计算机来逃避 app/shell/whatever。我只是想让切换到分心变得非常不方便，并且我想了解更多关于 Windows API 的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:11:23.593

有关编写 shell 的详细信息，请参阅[此问题](https://stackoverflow.com/questions/2270527/how-to-code-a-new-windows-shell)。

1.  不，只能有一个**真正的**shell 进程（SetShellWindowEx 仅在没有其他 shell 进程时才有效）[WH_SHELL](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644991%28v=vs.85%29.aspx)可以被其他进程使用，它可能足以满足您的需求（可能与[IShellExecuteHook](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775101%28v=vs.85%29.aspx)结合使用）

2.  当 explorer.exe 启动并检测到不同的 shell 时，它不会显示任务栏，只是一个文件浏览器窗口。Explorer 还会查看注册表 IIRC 中的[shell](http://msdn.microsoft.com/en-us/library/ms838576%28v=winembedded.5%29.aspx)值。您可能还想查看[退出技巧的转变](https://stackoverflow.com/questions/5689904/gracefully-exit-explorer-programmatically)。

# c# - 抽象函数和数据类型——有什么优雅的方法可以做到这一点吗？

> ID：10728883
> 
> 赞同：3
> 
> 时间：2012-05-23T22:43:33.427
> 
> 标签：c#, generics

我有一大群对象都来自单亲。对象都知道如何判断它们是否已被修改，但我还需要能够查看与内存中已有的对象相比是否已修改对象的新实例（测试以查看其他人是否更新了数据库在编辑对象时。）

结果是每个子类都必须包含相同的方法：

```
public new bool Changed()
{
    return Changed(this);
} 
```

这确实困扰着我，但我认为没有办法解决它，因为真正的工作需要由一个函数完成，该函数接受与其所在类相同类型的参数——因此它不能是虚拟的。（当然，我可以将它定义为每次都接受父对象并强制转换它，但这使得比较函数接受树中的任何对象，而不仅仅是正确的对象，并且它在每个实例中都需要保护代码，这又是一件难看的事情。）

当然这可行，但我不喜欢丑陋的代码。

更新：至于`Changed`函数，每个对象在加载时都会保留其状态的副本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:56:00.957

只要您的基类是`abstract`，您就可以执行以下操作：

```
abstract class Base
{
    public abstract bool Changed<T>(T obj) where T : Base;

    public bool Changed()
    {
        return Changed(this);
    }
}

class Subclass : Base
{
    public override bool Changed<Subclass>(Subclass obj)
    {
        // Do stuff here
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T22:56:36.983

基本结构：

```
public abstract class Base<T> where T : Base<T>
{
    public T Original { get; private set; }

    public abstract bool Changed(T o);

    public bool Changed()
    {
        return this.Changed(Original);
    }
}

public class DerivedA : Base<DerivedA>
{
    public override bool Changed(DerivedA o)
    {
        throw new NotImplementedException();
    }
}

public class DerivedB : Base<DerivedB>
{
    public override bool Changed(DerivedB o)
    {
        throw new NotImplementedException();
    }
} 
```

虽然它有其缺点（可读性），但在这种情况下它可能是正确的选择，因为您的问题不是经典动物/狗/猫意义上的类型保护，而是代码共享。

为了防止这种情况：

```
public class DerivedC : DerivedB
{
}
new DerivedB().Changed(new DerivedC()); // compiles 
```

你可以密封`DerivedB`。

或者你可以继续疯狂（我不推荐这个。绝对不会超过这个水平）：

```
public abstract class DerivedE<T> : Base<DerivedE<T>> where T : DerivedE<T>
{
}

public class DerivedF : DerivedE<DerivedF>
{
}

public class DerivedG : DerivedE<DerivedG>
{
}

new DerivedF().Changed(new DerivedG()); // does not compile
new DerivedF().Changed(new DerivedF()); // does compile 
```

请参阅此[http://blogs.msdn.com/b/ericlippert/archive/2011/02/03/curiouser-and-curiouser.aspx](http://blogs.msdn.com/b/ericlippert/archive/2011/02/03/curiouser-and-curiouser.aspx)。我从那篇文章中得到了灵感。他讨论了利弊。

编辑：清理，根据评论调整

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T23:43:49.300

与 minitech 的答案相同，因此他应该得到信任，但在此示例中，SubclassA 的 Changed 可以通过强制转换为完全命名的类来查看其属性。

```
namespace ConsoleApplication1
{

    abstract class Base 
    {     
        protected abstract bool Changed<T>(T obj) where T : Base;      
        public bool Changed()     
        {         
            return Changed(this);     
        }

        public String PropBase { get; set; }
    }  

    class SubclassA : Base 
    {
        public String PropA { get; set; }

        protected override bool Changed<SubclassA>(SubclassA obj)     
        {
            ConsoleApplication1.SubclassA myInstance = obj as ConsoleApplication1.SubclassA;
            // Now can see PropA
            myInstance.PropA = "A";
            return true;
        }

    }

    class SubclassB : Base
    {
        protected override bool Changed<SubclassB>(SubclassB obj)
        {
            // can't see prop B here 
            // obj.PropB = "B";
            return true;
        }

        public String PropB { get; set; }
    } 

    class Program
    {
        static void Main(string[] args)
        {

            SubclassB x = new SubclassB();

            x.Changed();

            Base y = new SubclassA();

            y.Changed();
        }
    }
} 
```

# php - 结果集为空时显示消息

> ID：10728886
> 
> 赞同：0
> 
> 时间：2012-05-23T22:43:42.413
> 
> 标签：php, sql-server, database

在下面的代码中，如果结果集为空，则代码继续处理结果。我想要的只是显示“查询失败”。当没有结果时。

```
$connInfo = array('UID'=>$user, 'PWD'=>$passwd, 'Database'=>$database);
$dbconn = sqlsrv_connect($server, $connInfo);

if($dbconn === false){
    die("<br />Error connecting to the database.<br />");
}
//SQL Query
$query = "SELECT ... FROM somehwere";

//Run Query
$qresult = sqlsrv_query($dbconn, $query);
if($qresult === false) {
    die('Query failed.');
}

?>
...more code... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T22:47:16.603

如果没有找到任何行，$qresult 将包含一个空结果集，但它仍然不会评估为 false。

试试这个功能：

[http://www.php.net/manual/en/function.sqlsrv-num-rows.php](http://www.php.net/manual/en/function.sqlsrv-num-rows.php)

所以：

```
if(!sqlsrv_num_rows($qresult)) {
    die('Query failed.');
} 
```

代替：

```
if($qresult === false) {
    die('Query failed.');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T16:43:34.497

谢谢。我使用 sqlsrv_has_rows() 函数让它工作。

```
if($qresult !== NULL) {
    $rows = sqlsrv_has_rows($qresult);
    if($rows === true) {
        //display success
    } else {
        //display error
    }
} 
```

出于某种原因，我无法让 sqlsrv_num_rows() 为我正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T22:52:36.647

它不显示“查询失败”，因为查询没有失败。它只返回 0 行。因此，解决方案将是使用：

```
$row_count = sqlsrv_num_rows( $qresult);
if ($row_count > 0){
// display stuff
}
else{
// throw exception
} 
```

# java - 图形未在paintComponent（图形）中绘制？

> ID：10728889
> 
> 赞同：0
> 
> 时间：2012-05-23T22:44:05.267
> 
> 标签：java, graphics

我正在为我的应用程序开发一个自定义 Swing 组件，并开始使用`public void paintComponent(Graphics g)`. 除了我无法绘制任何矩形之外，一切都很好。我认为问题出在`getX()`and`getY()`部分，但我不确定。这是我的代码：

```
@Override
public void paintComponent(Graphics g) {
    super.paintComponent(g);

    if (mouseEntered) {
        g.setColor(HIGHLIGHTED_COLOR);
    } else {
        g.setColor(BACKGROUND_COLOR);
    }

    g.fillRect(getX(), getY(), getWidth(), getHeight());

    //Draw rest of stuff (works fine) 
```

API 说它应该像这样使用：`g.fillRect(x, y, width, height)`，这就是我正在做的。

其余的绘图工作完美，但我不明白为什么这不是绘图。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:55:35.100

我不确定您的*Component是如何定义的，但**Component*方法的默认值是*Component*左上角的 X 坐标（相对于根 Component ）`getX()`。

 *当您在 Swing 中使用*Component*的方法进行绘制时，您要绘制到的*Graphics*`paintComponent(Graphics)`上下文的原点通常位于***Component***本身的左上角，而不是根*Component*。

 ***所以通过这个调用：

```
g.fillRect(getX(), getY(), getWidth(), getHeight()); 
```

*您可能正在Component*的剪辑边界之外绘制矩形！

（例如，如果组件位于 100、100 并且它的宽度为 20，高度为 20，那么您正在绘制的矩形，在**绝对**坐标中，位于`(200, 200)`to `(220, 220)`）

如果你想绘制一个包含整个组件的矩形，你可能想尝试更多这样的东西：

```
g.fillRect(0, 0, getWidth(), getHeight()); 
```

这将从原点（同样，可能是组件的左上角）向下绘制到组件的宽度和高度。

（使用前面的示例：组件位于 100、100 和 20 的宽度/高度，这将绘制的矩形位于`(100, 100)`to `(120, 120)`）

希望这会有所帮助=)****

# svg - SVG、XML 和字体系列

> ID：10728892
> 
> 赞同：2
> 
> 时间：2012-05-23T22:44:42.360
> 
> 标签：svg, font-family

我希望获得更多关于在 SVG 中格式化文本的最佳方式的信息 w3 提供了这个 [http://www.w3.org/Graphics/SVG/IG/resources/svgprimer.html#text_methods](http://www.w3.org/Graphics/SVG/IG/resources/svgprimer.html#text_methods)

但没有指定如何构建字体堆栈，我尝试将以下 xml 代码视为 css（如一些建议），但我没有运气。

```
font-family:Times New Roman;
-inkscape-font-specification:Times New Roman 
```

**问题。如何根据 css 为 svg 构建字体堆栈？**

（我对 font-face 或 svg 字体不太感兴趣，因为我相信从我所读到的内容中，它们目前并没有得到广泛的支持。）

我试图在 xml 中以这些模式格式化文本，但没有运气；

```
 font-family:Verdana,Times New Roman;
 font-family:'Verdana,"Times New Roman"';
 font-family:Verdana,"Times New Roman";
 font-family:'Verdana,Times New Roman'; 
```

编辑我还从 w3 [http://www.w3.org/TR/SVG/text.html#FontPropertiesUsedBySVG](http://www.w3.org/TR/SVG/text.html#FontPropertiesUsedBySVG)找到了这个， 它告诉我按照[http://www.w3.org/TR/2008遵循 css /REC-CSS2-20080411/fonts.html#font-specification](http://www.w3.org/TR/2008/REC-CSS2-20080411/fonts.html#font-specification) 但像 css (font-family:"Times New Roman",Times,serif;) 一样放入它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T08:16:33.767

font-family 属性与 CSS 定义的相同，因此您可以根据需要指定字体堆栈。

使用属性的示例：

```
<svg xmlns="http://www.w3.org/2000/svg">
  <text x="10" y="100" 
   font-family="'Times New Roman', Times, serif" font-size="48">
    Some text
  </text>
</svg> 
```

或者更好的是，使用类：

```
<svg xmlns="http://www.w3.org/2000/svg">
  <style>
    .seriftext {
      font-family: 'Times New Roman', Times, serif;
      font-size: 48px;
    }
  </style>
  <text x="10" y="100" class="seriftext">
    Some text
  </text>
</svg> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T09:17:48.453

检查 Inkscape 生成的 xml 输出。Inkscape 生成错误的字体系列值“font-family:Sans”。我猜这应该是“Sans-Serif”，但在破折号处被截断了。此值附加到样式字符串的末尾，因此当您在文本编辑器中查看 xml 时可能看不到它。如果您编辑样式字符串以放置您自己的字体系列定义，但不删除不正确的定义（因为您还没有看到它），什么都不会改变。

```
 <!--this wont work. Two font-family specs (scroll to the end).-->       
    style="font-family:arial,sans-serif;font-size:40px;font-style:normal;font-family:Sans"

    <!--this wont work either. Well you'll get the default Serif font-->
    style="font-family:Sans;font-size:40px;font-style:normal;font-weight:normal;"

    <!--this will work-->
    style="font-family:arial,sans-serif;font-size:40px;font-style:normal;font-weight:normal;"

    <!--so will this-->
    style="font-family:Arial,Sans-Serif;font-size:40px;font-style:normal;font-weight:normal;"

    <!--and this-->
    style="font-family:tahoma,arial,Sans-Serif;font-size:40px;font-style:normal;font-weight:normal;"

 <!--this too-->
style="font-family:Times New Roman, Serif;font-size:40px;font-style:normal;font-weight:normal;" 
```

例子：

```
<text
   style="font-family:Times New Roman, Serif;font-size:40px;font-style:normal;font-weight:normal;">
    <tspan
     x="60"
     y="60">
    The rain in spain
    </tspan>
</text> 
```

# haskell - 模式匹配后多态性丢失

> ID：10728897
> 
> 赞同：7
> 
> 时间：2012-05-23T22:45:08.823
> 
> 标签：haskell, polymorphism, pattern-matching

以下代码旨在生成 Double 或 Integer。`s`假定为`negate`或`id`; `n`整个部分；和`f`小数部分或`Nothing`整数。

```
computeValue :: Num a => (a->a) -> Integer -> (Maybe Double) -> Either Double Integer
computeValue s n Nothing = Right $ s n
computeValue s n (Just a) = Left $ s (fromIntegral n + a) 
```

当我编译这个时，我得到：

```
test1.hs:2:28:
    Couldn't match type `Integer' with `Double'
    Expected type: Either Double Integer
      Actual type: Either Double a
    In the expression: Right $ s n
    In an equation for `computeValue':
        computeValue s n Nothing = Right $ s n

test1.hs:2:38:
    Couldn't match type `Integer' with `Double'
    In the first argument of `s', namely `n'
    In the second argument of `($)', namely `s n'
    In the expression: Right $ s n 
```

似乎编译器不知何故忘记了`s`多态的事实。这里发生了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T23:12:36.400

`s`从你的函数内部不是多态的：你可以使用任何在*某个* `Num`实例上工作的函数作为这个参数，它可能是一个只在`Complex`! 您需要的是一个普遍量化的函数`s`，即实际上可以用*任何* `Num`实例调用的函数。

```
{-# LANGUAGE Rank2Types #-}

computeValue :: (forall a . Num a => a->a) -> Integer -> Maybe Double -> Either Double Integer
computeValue s n Nothing = Right $ s n
computeValue s n (Just a) = Left $ s (fromIntegral n + a) 
```

然后就可以了：

```
Prelude Data.Either> computeValue id 3 Nothing
Right 3
Prelude Data.Either> computeValue negate 57 (Just pi)
Left (-60.1415926535898) 
```

# ruby - 使用 Thor，我怎样才能删除几个任务的选项？

> ID：10728898
> 
> 赞同：3
> 
> 时间：2012-05-23T22:45:21.070
> 
> 标签：ruby, command-line-interface, thor

我有一个使用 Thor 构建的 CLI。我的所有任务都需要一个全局选项，除了少数。我通过定义一个 class_option 添加了全局选项，但我无法弄清楚如何从选定的几个任务中删除该选项。如果我在其中一项任务中使用 remove_class_option() ，则全局选项将被永久删除，并且不再可用。

任何帮助，非常感谢！

# mysql - 关于在 Mac 上设置 mySQL 的一些问题

> ID：10728900
> 
> 赞同：0
> 
> 时间：2012-05-23T22:45:42.737
> 
> 标签：mysql, command-line

我一直在命令行中使用 mySQL，并且遇到了一些我无法找到满意答案的问题。

1.  如何正确设置 mysql，这样我就不必键入：

    别名 mysql=/usr/local/mysql/bin/mysql 别名 mysqladmin=/usr/local/mysql/bin/mysqladmin

    每次从命令行启动mysql？我不确定我的 PATH 语法是否正确。

2.  要在本地并最终在 Web 框架中测试 mysql，是否建议将 mysql 用户设置为 root，将主机设置为 localhost？似乎有一些建议反对使用 mysql 作为 root 用户。

3.  我将如何删除当前在我的 mysql.user 中的所有用户并开始清理？好像我有多个“root”实例，谁的主机是 localhost，127.0.0.1，（::1，localhost，username.local）？这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:59:46.737

在您的主目录中编辑或创建一个 .profile 并添加：

```
export PATH=/usr/local/mysql/bin:$PATH 
```

打开一个新的终端窗口以使更改生效。

一般来说，你不应该使用root。您可以在 MySQL 5.02 或更高版本中更改用户名：

```
mysql> RENAME USER root TO new_user; 
```

要删除用户：

```
mysql> DROP USER user; 
```

# database - sqlite - 如何在插入语句中转义字符串中的分号

> ID：10728903
> 
> 赞同：2
> 
> 时间：2012-05-23T22:46:02.177
> 
> 标签：database, sqlite, escaping

编辑：问题已解决...与问题的措辞无关...抱歉浪费时间：-\

我意识到，当 iOS 和 Android 等平台（如果您正在编写手机应用程序）有用于此的工具时，通常您希望使用某种抽象层而不是为 SQLite 编写自己的插入语句。

不幸的是，由于我可以使用的工具以及所涉及的不同平台/系统的数量，我处于这种情况下，这并不是一个真正的选择。

我遇到的问题真的很简单，但我似乎无法通过谷歌、stackoverflow 等找到答案......我只是想使用 Webkit 的“executeSql”命令执行以下查询：

```
INSERT INTO someTable VALUES (''some string'', ''some string with a semicolon; in it''); 
```

问题是 - 除非我删除分号，否则这会失败。（注意：双引号是因为发送到webkit的executeSql命令的语句需要转义..也许这是问题的一部分？）

如果我从第二个字段中的字符串中取出分号 - 语句运行良好......

如果我用反斜杠转义分号 - 运气不好！

sqlite 的文档充其量似乎是平庸的，我一直无法弄清楚我应该如何逃避那个分号......任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:57:18.617

这工作正常：

```
CREATE Table DummyTable(FirstCol VARCHAR(25), SecondCol VARCHAR(25));
INSERT INTO DummyTable VALUES ('This is a test', 'This is test two; OK?');
SELECT * FROM DummyTable;

-- output
FirstCol                  SecondCol
========================= ========================= 
This is a test            This is test two; OK? 
```

问题似乎是您的 SQL 语句中的引号加倍。

# jquery - jQuery 如果 android 加载 css

> ID：10728908
> 
> 赞同：0
> 
> 时间：2012-05-23T22:46:35.777
> 
> 标签：jquery, android, media-queries

如果检测到 android，如何加载和应用 css：

```
if( navigator.userAgent.match(/Android/i) {
load css ..
}
else {
dont load css ..
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:51:06.393

```
$("head").append("<style ..."); 
```

你的手机是横向的吗？仅当您处于横向时才会执行此媒体查询。

# java - 使用 DocumentBuilder“解析”解析 XHTML 时出现无限循环

> ID：10728909
> 
> 赞同：0
> 
> 时间：2012-05-23T22:46:36.557
> 
> 标签：java, xml, xhtml, xml-parsing, infinite-loop

我有这个方法，它从`java.io.InputStream`返回的`org.w3c.dom.Document`.

```
private Document loadDocFrom(InputStream is) throws SAXException,
        IOException, ParserConfigurationException {
    DocumentBuilderFactory domFactory = DocumentBuilderFactory
            .newInstance();
    domFactory.setNamespaceAware(true); // never forget this
    DocumentBuilder builder = domFactory.newDocumentBuilder();

    Document doc = builder.parse(is);
    is.close();
    return doc;
} 
```

这种方法有效，我已经用一些 XHTML 文档（例如`http://pastebin.com/L2kHwggU`）和 XHTML 网站对其进行了测试。

但是，对于一些文件，比如这个[http://pastebin.com/v675yWSJ](http://pastebin.com/v675yWSJ)甚至是类似的网站`www.w3.org`，它在`Document doc = builder.parse(is);`.

**编辑：**

@Michael Kay 发现了问题，但我正在等待他的解决方案。

其他可能的解决方案之一是忽略 DTD：

```
domFactory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false) 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T07:14:50.850

我认为您对它是无限循环的诊断是不正确的；只是需要很长时间，这不是一回事。

造成这种情况的通常原因是该文档包含对 W3C 网站上 XHTML DTD 的引用，并且解析器将访问 Web 以获取此内容，而不是使用本地副本。大约一年前，W3C 开始“限制”对这些常见 DTD 的请求，因为它们不再能够处理流量。

通常的解决方案是使用解析器将请求重定向到本地副本。

# iphone - 非 ARC 应用程序中的 NSMutableDictionary 初始化

> ID：10728919
> 
> 赞同：1
> 
> 时间：2012-05-23T22:47:42.860
> 
> 标签：iphone, nsmutabledictionary

我不知道我今天是不是完全脑残了，还是什么。但基本上我正在尝试初始化一个要使用的 NSMutableDictionary 。我将其作为财产：

```
@property (nonatomic, retain) NSMutableDictionary *baseViewDictionary; 
```

在 .m 文件中：

```
@synthesize baseViewDictionary;

// in the init method:
    NSMutableDictionary *tempDict = [[NSMutableDictionary alloc] initWithCapacity:0];
    self.baseViewDictionary = tempDict;
    [self.baseViewDictionary setObject:@"test" forKey:[NSNumber numberWithInteger:0]];
    [tempDict release]; 
```

我认为这是一种用于初始化 NSMutableDictionary 的模式。不幸的是，我的 self.baseViewDictionary 永远不会被设置。我的 tempDict 有 1 个我在调试器中看到的键/值对，但我的 self.baseViewDictionary 有 0x0000000。所以就像

```
self.baseViewDictionary = tempDict; 
```

永远不会运行。当我进入那行代码时，它会跳转到@synthesize baseViewDictoinary，然后返回到该`self.baseViewDictionary=tempDict`行。

这是`setObject@"test"`运行后调试器的图片。

![在此处输入图像描述](../Images/a08200fa438187ded15d8114b7e22311.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:56:15.520

你的模式是正确的。
初始化正确完成，没有内存泄漏，因为您在分配给保留它的属性后释放字典。

你确定你的`init`方法是正确的吗？
我的意思是，打电话`self = [ super init ]`（不是`==`），在这之后做你的事情，然后返回`self`？

这似乎很明显，但由于您的实例变量似乎是`nil`，`self`也可能是`nil`......

```
- ( id )init
{
    if( ( self = [ super init ] ) )
    {
        NSMutableDictionary * tempDict = [ [ NSMutableDictionary alloc ] initWithCapacity: 0 ];
        self.baseViewDictionary        = tempDict;

        [ self.baseViewDictionary setObject: @"test" forKey: [ NSNumber numberWithInteger: 0 ] ];
        [ tempDict release ];

        NSLog( @"%@", self.baseViewDictionary );
    }

    return self;
} 
```

# c# - Bouncy Castle 没有在 C# 中从 Java 中解密 DoFinal

> ID：10728920
> 
> 赞同：2
> 
> 时间：2012-05-23T22:47:43.347
> 
> 标签：c#, java, bouncycastle

我正在尝试解密使用 Java 中的 Bouncy Castle 库和 C# 加密的数据。使用 Java 加密的数据（同样使用 Bouncy Castle 库）可以使用 Java 解密。我使用相同的键和参数，但是当我到达 DoFinal 时，我收到错误“垫块损坏”。

这是Java：

```
KeyParameter keyParam = new KeyParameter(key);
CipherParameters param = new ParametersWithIV(keyParam, initVector);

BlockCipherPadding padding = new PKCS7Padding();
BufferedBlockCipher cipher = new PaddedBufferedBlockCipher(new CBCBlockCipher(new AESEngine()), padding);
cipher.reset();
cipher.init(true, param);

byte[] fileBytes = Base64.decodeBase64(decryptedStringData);
byte[] encrypted = new byte[cipher.getOutputSize(fileBytes.length)];
int l = cipher.processBytes(fileBytes, 0, fileBytes.length, encrypted, 0);
l += cipher.doFinal(encrypted, l);

return (Base64.encodeBase64String(encrypted)); 
```

这是C#：

```
KeyParameter keyParam = new KeyParameter(key);
ICipherParameters param = new ParametersWithIV(keyParam, initVector);

IBlockCipherPadding padding = new Pkcs7Padding();
BufferedBlockCipher cipher = new PaddedBufferedBlockCipher(new CbcBlockCipher(new AesEngine()), padding);
cipher.Reset();
cipher.Init(false, param);

byte[] fileBytes = Convert.FromBase64String(encryptedDataString);
byte[] decrypted = new byte[cipher.GetOutputSize(fileBytes.Length)];
int l = cipher.ProcessBytes(fileBytes, 0, fileBytes.Length, decrypted, 0);
l += cipher.DoFinal(decrypted, l);

return(Convert.ToBase64String(decrypted)); 
```

我正在根据已缓冲的哈希为密钥生成一个 32 字节的 PBK……但是，我们检查了在 Java 和 C# 之间生成的密钥，它们是相同的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T20:34:45.650

事实证明，为加密和解密提供的数据以不同的格式编码。我正在拉入 UTF-8 编码的字符串进行解密，并且需要先将它们制成 Base64 字符串。感谢您提供的所有帮助。

# methods - PHP-无法从另一个类中的mysqli类引用方法

> ID：10728929
> 
> 赞同：1
> 
> 时间：2012-05-23T22:48:46.650
> 
> 标签：methods, mysqli, extends, mysql-real-escape-string, inheritance

我正在尝试将所有方法和属性从超全局 mysqli 类继承到我的 db 类中。

这是数据库类：

```
class DB extends mysqli
{
    protected $mysqli;

    public function __construct () {
        // connect to MySQL
        $mysqli = new mysqli('host', 'username', 'password', 'dbname');

        // output error if unable to connect
        if ($mysqli->connect_errno) {
            echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " .     $mysqli->connect_error;
            exit;
        }
    }
} 
```

这是主要的会议类：

```
class Meetings
{

    function __construct () {
        require_once('../include/classes/db.class.php');
        $db = new DB();

        $field = $db->real_escape_string($_POST['about']);

    }

} 
```

在 Meetings 类中，我希望能够通过超全局 mysqli 类继承的实例化 DB 类调用 real_escape_string 方法。

我收到此错误：警告：mysqli::real_escape_string() [mysqli.real-escape-string]：无法获取数据库

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:04:41.437

哎呀！您创建了 DB 对象，而 db 对象创建了 mysqli 类的另一个实例。你不应该调用 new mysqli，但你应该调用

```
parent::__construct('host', 'username', 'password', 'dbname') 
```

或者

```
 parent::mysqli('host', 'username', 'password', 'dbname') 
```

我不知道哪种格式适合 mysqli 构造函数。

在此之后，您不需要 DB 类中的 mysql 属性，因为在这种情况下，您的 mysqli 属性与 DB 类的 $this 相等。所以，不是 $mysqli->connect_errno，而是 $this->connect_errno 是对的。

# javascript - 找到 img id 和 src 并添加到数组中

> ID：10728930
> 
> 赞同：0
> 
> 时间：2012-05-23T22:48:51.593
> 
> 标签：javascript

这是我的html代码：

```
<div id="cmdt_1_29d" class="dt_state2" onclick="sel_test(this.id)">
    <img id="cmdt_1_29i" onclick="dropit('cmdt_1_29');"
         src="http://hitechpackaging.zes.zeald.com/interchange-5/en_US/ico_minus.png">
    <span class="dt_link">
        <a href="javascript://">CARTON &amp; BOARD</a>
    </span> 
</div> 
<div id="cmdt_2_31d" class="dt_istate1" onclick="sel_test(this.id)">
    <img src="/site/hitechpackaging/images/items/test.jpb ">
    <a href="https://secure.zeald.com/hitechpackaging/shop/CARTON%20%20%20%20BOARD/CORRUGATED%20%20CORNER%20BOARD?mv_pc=21497">CORRUGATED &amp; CORNER BOARD</a>
</div> 
```

dropit 函数修改了我不想修改的 img src，不幸的是我无法修改，我可以在修改数据之前以某种方式将数据读入数组，并且可以将数据添加回图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:17:21.157

要删除点击处理程序：

```
var i = document.getElementById('cmd1_1_29i');
i.onclick = null; 
```

或者，如果您仍想调用原始点击处理程序：

```
var i = document.getElementById('cmd1_1_29i');
_onclick = i.onclick;

i.onclick = function(e) {
    // do what you want here
    _onclick && _onclick.apply(this, [e]);
}
​ 
```

# android - 应用程序意外停止：致命异常：MAIN

> ID：10728932
> 
> 赞同：1
> 
> 时间：2012-05-23T22:48:59.480
> 
> 标签：android, textview, spannable

我想用`Spannanle`. 以下是我的活动文件：

```
package com.Myapp;

import android.app.Activity;
import android.graphics.Color;
import android.graphics.Typeface;
import android.os.Bundle;
import android.text.Spannable;
import android.text.SpannableString;
import android.text.style.ForegroundColorSpan;
import android.text.style.StyleSpan;
import android.widget.EditText;
import android.widget.TextView;

public class MyappActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        TextView vw = (TextView)findViewById(R.id.request);
        Spannable str = (Spannable)vw.getText();
        str.setSpan(new ForegroundColorSpan(Color.BLUE), 10, 15, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);

    }
} 
```

我的 main.xml 文件如下：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/background"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="73dp"
        android:layout_height="40dp"
        android:src="@drawable/logo" />

    <TextView
        android:id="@+id/title"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:text="My APP"
        android:textColor="@color/black"
        android:textSize="19sp"
        android:typeface="serif" />

    <TextView
        android:id="@+id/request"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="30dip"
        android:text="I want to collect from" />
</Linearlayout> 
```

我得到的错误是：

```
05-23 22:40:54.279: E/AndroidRuntime(451): FATAL EXCEPTION: main
05-23 22:40:54.279: E/AndroidRuntime(451): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.Myapp/com.Myapp.MyappActivity}: java.lang.ClassCastException: java.lang.String
05-23 22:40:54.279: E/AndroidRuntime(451):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
05-23 22:40:54.279: E/AndroidRuntime(451):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
05-23 22:40:54.279: E/AndroidRuntime(451):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
05-23 22:40:54.279: E/AndroidRuntime(451):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
05-23 22:40:54.279: E/AndroidRuntime(451):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-23 22:40:54.279: E/AndroidRuntime(451):  at android.os.Looper.loop(Looper.java:130)
05-23 22:40:54.279: E/AndroidRuntime(451):  at android.app.ActivityThread.main(ActivityThread.java:3683)
05-23 22:40:54.279: E/AndroidRuntime(451):  at java.lang.reflect.Method.invokeNative(Native Method)
05-23 22:40:54.279: E/AndroidRuntime(451):  at java.lang.reflect.Method.invoke(Method.java:507)
05-23 22:40:54.279: E/AndroidRuntime(451):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-23 22:40:54.279: E/AndroidRuntime(451):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-23 22:40:54.279: E/AndroidRuntime(451):  at dalvik.system.NativeStart.main(Native Method)
05-23 22:40:54.279: E/AndroidRuntime(451): Caused by: java.lang.ClassCastException: java.lang.String
05-23 22:40:54.279: E/AndroidRuntime(451):  at com.Myapp.MyappActivity.onCreate(MyappActivity.java:21)
05-23 22:40:54.279: E/AndroidRuntime(451):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-23 22:40:54.279: E/AndroidRuntime(451):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611) 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:54:17.077

使用以下代码：

```
Spannable str = new SpannableString(vw.getText().toString()); 
```

或者，

```
SpannableString str = new SpannableString(vw.getText().toString()); 
```

或者，您可以使用工厂：

```
Spannable str = Spannable.Factory.getInstance().newSpannable(vw.getText()); 
```

* * *

您还需要在代码末尾添加以下行以获得效果：

```
 vw.setText(str); 
```

* * *

顺便说一句，**vw.getText()**或**vw.getText().toString()**都可以正常工作:)

# javascript - 如何在javascript中舍入为数字的倍数？

> ID：10728934
> 
> 赞同：3
> 
> 时间：2012-05-23T22:49:04.547
> 
> 标签：javascript, jquery

虽然我了解 JavaScript 中的 Math.round/ceil/floor 函数，但我一直无法为这个问题想出一个有效的函数。

我想要做的是将任何整数四舍五入为 3 的倍数，或者实际上是我选择的任何倍数。

给定'3'的倍数时，返回数字的要求如下：

```
0 returns 0
6 returns 6
7 returns 6
8 returns 9
22 returns 21
23 returns 24 
```

等等……等等……所以基本上，返回的值总是给定参数的倍数，在这种情况下是'3'。

谢谢大家。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T22:51:04.407

您可以使用这样的简单函数：

```
function roundMultiple3(num) {
  return(Math.round(num / 3) * 3);
} 
```

这除以 3，四舍五入到最接近的整数，然后再次乘以 3 以恢复完整值。

或允许您指定倍数的通用版本：

```
function roundMultiple(num, multiple) {
  return(Math.round(num / multiple) * multiple);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T22:51:17.200

这应该可以正常工作：

```
function roundToNearest(number, multiple) {
    return Math.round(number * multiple) / multiple;
} 
```

要四舍五入到小于该数字的最接近倍数，请替换`Math.round()`为`Math.floor()`。同样，`Math.ceil()`将四舍五入到最接近的倍数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T22:54:55.537

这对我有用：

```
function roundTo(n, x) {
    return Math.round(x/n) * n;
}

roundTo(3, 2); // 3
rountTo(4, 7); // 8 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T22:53:31.057

```
Number.prototype.roundup=function(factor){
  var n=Math.ceil(this);
  while(n%factor)++n;
  return n;
} 
```

# xcode4 - 使用 Storyboard，如何在 UITableViewController 中将 UIView 放在 UITableView 的顶部

> ID：10728935
> 
> 赞同：2
> 
> 时间：2012-05-23T22:49:23.800
> 
> 标签：xcode4, uitableview, uistoryboard

使用 XCode 4 和 Storyboards，我想在 UITableViewController 的上半部分有一个 UIView（带有标签和文本字段），在 UITableViewController 的下半部分有一个自定义单元格。

当我在 UITableViewController 上放置一个 UIView 时，它会按预期进入场景顶部；当我添加 UITableViewCell 时，它也会转到场景的顶部，覆盖 UIView。似乎无法调整任一视图的大小。

我查看了“tableHeaderView”，但找不到任何如何实现它的示例，假设它会做我想要的。

如何在 UITableViewController 的下半部分实现顶部的 UIView 和自定义 UITableViewCells？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T13:12:10.947

在这个 SO 问题上找到了答案： [StoryBoards 中的表头视图](https://stackoverflow.com/questions/7841167/table-header-views-in-storyboards)

我试过了，它确实做了我想做的事。谢谢罗杰斯先生！

# python - 这个 Python 列表理解表达式可以简化吗？

> ID：10728936
> 
> 赞同：3
> 
> 时间：2012-05-23T22:49:42.113
> 
> 标签：python, list-comprehension

```
input = "foo ,,bar ,baz,"
tags = [x.strip() for x in input.split(',') if len(x.strip()) > 0] 
```

所需的输出显然是一个没有空字符串的列表。

问题是本着微优化的精神；有没有办法不让`strip()`候选人`x`两次，即一次用于测试，一次用于附加？

换句话说，您能否在表达式中生成一个值，该值可以附加到列表中而无需执行两次工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T23:00:15.643

创建一个新字符串总是比扫描它更昂贵。`x.isspace()`遇到第一个非空格字符后将返回

```
tags = [x.strip() for x in input.split(',') if x and not x.isspace()] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T22:52:52.540

```
text = 'foo ,,bar ,baz,' 
```

（我使用`text`而不是`input`as`input`是内置的名称。避免遮蔽内置。）

首先，`len(x.strip()) > 0`可以简单（并且更有效地）写为`x.strip()`.

```
tags = [x.strip() for x in text.split(',') if x.strip()] 
```

如果你真的想，你可以只做一次脱衣舞，但我不确定它是否会更快：

```
tags = [x for x in (x.strip() for x in text.split(',')) if x] 
```

如果你真的想，你甚至可以在功能上做到这一点......

```
tags = filter(bool, map(lambda x: x.strip(), text.split(','))) 
```

性能数据：

```
>>> from timeit import timeit
>>> timeit(lambda: [x.strip() for x in text.split(',') if x.strip()])
1.9443869590759277
>>> timeit(lambda: [x for x in (x.strip() for x in text.split(',')) if x])
2.1135239601135254
>>> timeit(lambda: filter(bool, map(lambda x: x.strip(), text.split(','))))
2.52907395362854 
```

如您所见，第一个是最快的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T23:21:45.437

这也有效...

```
 text = "foo ,,bar ,baz,"
 text.replace(',',' ').split() 
```

# .htaccess - Safari 对待 .htaccess 的方式与其他浏览器不同

> ID：10728940
> 
> 赞同：0
> 
> 时间：2012-05-23T22:50:43.607
> 
> 标签：.htaccess

我有这样的链接：

```
www.domain.com/page.php?id=1#info 
```

我只想隐藏 .php 来得到这个：

```
www.domain.com/page?id=1#info 
```

出于这个原因，我发现了这个 .htaccess 脚本：

重写引擎开启

```
# to make `/path/index.php` to /path/
RewriteCond %{THE_REQUEST} ^GET\s(.*/)index\.php [NC]
RewriteRule . %1 [NE,R=301,L]

RewriteCond %{THE_REQUEST} ^GET\s.+\.php [NC]
RewriteRule ^(.+)\.php$ /$1 [NE,R=301,L,NC]

RewriteCond %{REQUEST_URI} !\.php$ [NC]
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule . %{REQUEST_URI}.php [L] 
```

这完全可以完成工作，并且可以在除 safari 之外的所有浏览器中使用，它将输出：

```
www.domain.com/page?id=1 
```

#info 不见了。

浏览器如何解释 .htaccess 不同？有人可以帮我编写正确的 .htaccess 文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:57:23.080

Safari 的行为方式与每个浏览器都应该：

> 片段取决于文档 MIME 类型并由客户端（Web 浏览器）**评估。**客户端在检索文档时**不应该向服务器发送**URI 片段，并且如果没有本地应用程序（见下文）的帮助，片段不会参与 HTTP 重定向。
> 
> [维基百科：片段标识符](http://en.wikipedia.org/wiki/Fragment_identifier#Basics)

简而言之：`#`浏览器不应该将 URL 之后的部分发送到服务器。浏览器应该在本地处理这个。这意味着您在应用重定向（重写规则）时可能会丢失片段。

# ruby - 如何让指南针同时观看多个文件夹？

> ID：10728949
> 
> 赞同：11
> 
> 时间：2012-05-23T22:51:19.043
> 
> 标签：ruby, windows, sass, compass-sass

我正在使用 Compass + Sass 来管理/合并我的`.css`文件。所以我有以下文件夹结构：

```
Root
--Module
----css
----sass
--Module
----css
----sass
--Module
----css
----sass 
```

这里是我想要实现的目标：在开发阶段，我想将 compass 指向我的根文件夹，它应该监视位于`sass`目录（在 each 中`Module`）的文件中的任何更改。一旦其中一个 .sass 文件发生更改 -`.css`应生成适当的文件（对于更改`.sass`所属的模块）并放入`css`同一 .sass 下的文件夹中`Module`。

可能吗？

我猜我应该`config.rb`用于此目的，但我不确定如何正确执行此操作。有人可以指出我的解决方案还是仅仅描述如何做到这一点的一般想法？

**编辑**：我在 Windows 环境中，所以不能使用 Linux 命令（我可以安装 Cygwin，但我宁愿避免它）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-13T01:48:04.313

我的文件夹结构设置不同：

*   资产
    *   粗鲁的
        *   模块
            *   _module1.scss
            *   _module2.scss
            *   _module3.scss
        *   屏幕.scss
    *   样式表
        *   屏幕.css
    *   配置文件

屏幕.scss：

```
@import "modules/module1";
@import "modules/module2";
@import "modules/module3"; 
```

配置.rb：

```
...
css_dir = "stylesheets"
sass_dir = "sass"
... 
```

模块名称开头的下划线表示它们不会被编译成单独的 css 文件。导入语句将它们组合在一起，以便所有 css 最终组合在 screen.css 中。请注意，在导入语句中，您不需要下划线或 .scss。

如果您想维护单个 css 文件（这是您建议您想要做的），您可以稍微修改此结构。删除下划线，指南针将创建单个文件。

*   资产
    *   粗鲁的
        *   模块
            *   模块1.scss
            *   模块2.scss
            *   模块3.scss
        *   屏幕.scss
    *   样式表
        *   模块
            *   模块1.css
            *   模块2.css
            *   模块3.css
        *   屏幕.css
    *   配置文件

在这种情况下，您不需要 screen.scss 中的任何导入语句，因为每个单独的文件都需要单独包含在 html 文档中。

在这两种情况下，您都将在 assets 文件夹中运行一次“compass watch”。请注意，您不需要在样式表目录中创建任何内容。指南针会这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T21:01:40.830

我发现的唯一解决方法是运行多个 Compass 实例 - 每个模块一个。我敢打赌，通过调整 Compass 源代码可能会有更优雅的解决方案，但不幸的是，我还不熟悉 Ruby……。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-18T14:39:10.687

在*config.rb*文件中使用`additional_import_paths`或更简单的。`add_import_path`

 *`additional_import_paths` *字符串数组*系统上用于导入 sass 文件的其他路径。

`add_import_path`调用此函数为您的 compass 项目添加一个路径到 sass 导入路径列表。例如：`add_import_path "/Users/chris/work/shared_sass"`

请参阅[此答案](https://stackoverflow.com/a/27450261/883303)以及有关如何使用的示例`add_import_path`

来源： [http ://compass-style.org/help/documentation/configuration-reference/](http://compass-style.org/help/documentation/configuration-reference/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-22T08:48:17.370

编译并观看几个独立的 Sass Compass 项目：[https ://stackoverflow.com/a/39635064/6440953](https://stackoverflow.com/a/39635064/6440953)*

# jquery - 我的 jQuery src 更改代码有什么问题？

> ID：10728950
> 
> 赞同：0
> 
> 时间：2012-05-23T22:51:37.600
> 
> 标签：jquery, hover, mouseover, src, attr

当您将鼠标悬停在图像上时，我正在尝试更改图像的 src。这是我的尝试，但它不起作用：

HTML：

```
<img src="images/work.png" id="work"/> 
```

jQuery：

```
$(document).ready(function() {
    $("#work").mouseover(function() {
        $(this).attr("src", "images/workH.png");
    });
    $("#work").mouseout(function() {
        $(this).attr("src", "images/work.png");
    });
}); 
```

编辑 1：@Erik：我再次尝试了此代码，但使用的是 200x200px img。代码运行良好。是不是我的标志图片太小了？

Edit2：我发现了问题！麻烦各位大佬抱歉。但是感谢您对此的帮助。

我在工作图像上方写了一个徽标图像。它处于浮动状态，允许工作图像停留在其下方。大多数标志图像是透明的，使工作图像可见。但是，当我将鼠标悬停在我的图像上时，它们并没有改变，因为徽标挡住了。

*掌心时刻*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T22:54:40.723

**没什么**。它应该可以正常工作。你的两张图不一样吗？包含 jQuery 库吗？

* * *

您可以将代码简化为：

```
$(document).ready(function() {
    $("#work").hover(function() {
        $(this).attr("src", "images/workH.png");
    }, function() {
        $(this).attr("src", "images/work.png");
    });
}); 
```

# jquery - Jquery - 将文本放在带有类的父 div 中

> ID：10728955
> 
> 赞同：0
> 
> 时间：2012-05-23T22:52:03.830
> 
> 标签：jquery, append

我在用

```
function example_append() {
  $('#containment').append($('#example-textarea').val());
} 
```

这是将我在表单字段中输入的文本扔到 div #containment 中。我想将表单字段的值放入包含 div 中，但也将其包装在具有类名的 div 中，以便我可以设置它的样式。这可能吗？

此外，用户通过表单字段插入文本并将其放入该 div 中，如果用户想重新开始，我该如何删除该文本字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:56:22.050

你可以这样做 ：

```
var div = $('#example-textarea').val();
$('#containment').append(div.wrap('<div class="new" />')); 
```

将值包装在具有“new”类的 div 中并删除 textarea 值，只需执行以下操作：

```
$('#example-textarea').val('') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:56:30.823

这两个功能应该可以满足您的需求。`reset_text`只需在单击时绑定到按钮或文本。

**编辑** 为清除文本添加了事件绑定。

```
function example_append() {
   $('#containment').append(
      $('<div />').addClass('className').text($('#example-textarea').val())
   );
}

$(document).ready( function() {
   $('#example_button').on('click', reset_text );
});

function reset_text() {
   $('#example-textarea').val('');
   $('.className').remove():
} 
```

# git - 我应该在流星 .gitignore 文件中放入什么？

> ID：10728956
> 
> 赞同：155
> 
> 时间：2012-05-23T22:52:22.067
> 
> 标签：git, meteor, gitignore

我有一个新的流星项目。我猜`.meteor`目录有配置文件（需要）和临时文件（不需要）的组合。

那么你的里面有什么`.gitignore`？

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2012-05-23T23:02:42.883

您希望从版本控制中排除的唯一目录是`.meteor/local`.

Meteor 会自动创建正确的`.meteor`，`.meteor/.gitignore`但是 - 您不需要做任何事情。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-24T15:03:57.777

如果您要推送到公共存储库，您可能希望将任何配置设置文件放在那里。

我将任何安全敏感数据配置设置（例如加密密钥和各种密码）存储在 config.js 中，然后将其放入 .gitignore 或 info/exclude 文件中。我不希望在公共回购中的东西。

只是为您的 .gitignore 考虑的额外建议

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-06-01T12:13:17.233

您的 gitignore 还应包含：

公共/node_modules

[并且您使用适当制作的 package.json](https://github.com/matb33/heroku-meteor-npm)来补充这一点，该package.json管理节点模块依赖项安装。

当安装在新的地方时，这将需要 npm install 。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-04-22T13:51:30.793

根据[这篇文章](http://joshowens.me/environment-settings-and-security-with-meteor-js/)，你应该忽略你的`settings.json`，特别是如果你有环境特定的信息来包含 API 密钥。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-04-20T02:00:57.097

对于流星 1.3，您还想忽略`node_modules`. 没有理由将所有库添加到 git，因为您可以通过 npm 安装它们。`node_modules`文件夹很可能比您的应用程序大（不包括文件`.meteor/local`夹）

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-11-16T15:48:27.910

Meteor默认`.gitignore`在目录中创建一个。`.meteor`

但是，您的项目`.gitignore`应该排除任何敏感数据配置文件和`node_modules`.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-01-25T05:44:32.363

我们使用这个 gitignore，它包含许多 IDE 和 Meteor，以及系统文件和其他文件。

```
### WebStorm ###
.idea/

### OSX ###
.DS_Store
.AppleDouble
.LSOverride
# Icon must end with two \r
Icon
# Thumbnails
._*
# Files that might appear on external disk
.Spotlight-V100
.Trashes
# Directories potentially created on remote AFP share
.AppleDB
.AppleDesktop
Network Trash Folder
Temporary Items
.apdisk

### Windows ###
# Windows image file caches
Thumbs.db
ehthumbs.db
# Folder config file
Desktop.ini
# Recycle Bin used on file shares
$RECYCLE.BIN/
# Windows shortcuts
*.lnk

### Linux ###
*~
# KDE directory preferences
.directory

### SublimeText ###
# cache files for sublime text
*.tmlanguage.cache
*.tmPreferences.cache
*.stTheme.cache
# workspace files are user-specific
*.sublime-workspace
# project files should be checked into the repository, unless a significant
# proportion of contributors will probably not be using SublimeText
# *.sublime-project
# sftp configuration file
sftp-config.json

### Node/NPM ###
node_modules
npm-debug.log

### Development ###
dump
mochawesome-reports
ngrok 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-03-30T05:11:13.153

如果你使用

*   [Intellij IDE](http://www.jetbrains.com/idea/)忽略`.idea`文件夹
*   [崇高文本](https://www.sublimetext.com/)忽略`sublime-project` `sublime-workspace`

如果你是mac用户可以忽略`DS_Store`

如果你使用 npm ignore `npm`cause 如果 windows 和 mac 用户都在同一个项目上工作，因为相同的 npm 版本对于 mac 和 windows 是不同的，它会显示错误。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-09-12T10:14:19.107

下面是我在使用 Mupx 部署的 Webstorm 和 Meteor 1.4 中使用的内容。

```
# Meteor files to ignore now handled by .ignore file within .Meteor folder automatically

# settings file to ignore to protect API keys
settings.json

# MUP / MUPX file to ignore to protect server passwords and sensitive info.
mup.json

# npm package files to ignore
node?modules/
npm-debug.log

# Webstorm IDE files to ignore
.idea/*

# Typing type definition files to ignore. Webstorm uses type definitions for autocomplete even without typescript
typings/* 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-05-17T17:31:37.950

```
### MeteorJS ###
# default meteor build and local packages
.meteor/local

# meteor settings file
settings.json

# meteor build output files
*.tar.gz

# general swp files from vim
*.swp

# End of https://www.gitignore.io/api/meteorjs 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-01-27T07:19:01.167

您需要将安装的包目录命名为 node_modules，该目录位于根目录中。当您提交项目时，它将被忽略。产品经理也可以使用 package.json 在他们的服务器中轻松安装包。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-12-12T10:48:43.303

这是我在 Intellij 中使用的 .gitignore 文件：

```
 node_modules/
  .meteor/local/*
  .idea/
  npm-debug.log
  packages/*/.npm/ 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-03-15T11:03:39.010

您可以使用此站点[https://www.gitignore.io/](https://www.gitignore.io/)为任何项目生成 .gitignore 文件，只需插入您使用的技术和 IDE

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-06-28T00:21:53.740

.meteor/local 是您唯一希望从版本控制中丢失的东西。

Meteor 会自动生成一个适合您需要的 .gitignore 文件。

如果它是一个公共存储库，您可能希望包含“settings-development.json”或任何其他包含您不想向公众披露的信息的 JSON 文件，例如 AWS API 密钥。

然而，Bitbucket 和其他一些人提供了免费的私人存储库，应该可以满足您的需求。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-04-30T14:55:56.027

1.  gitignore 用于忽略 git 服务器和您一直获取的所有不必要的负担。
2.  所以放在 gitignore 中的最好的东西是可打包的实体。现在，这包括了流星可下载的包，所以，你应该在 gitignore 中添加“.meteor/local”。
3.  当您将它添加到 gitignore 配置时，它会将项目的大小减少到与包相比小 n 倍。
4.  如果您现在将整个项目剪切粘贴到不同的位置，或者在没有 .meteor/local 文件夹的情况下获取存储库并使用流星命令启动项目，流星首先下载所需的包，然后启动服务器。

# .net - 在 VB.NET 中编辑一些文件

> ID：10728957
> 
> 赞同：2
> 
> 时间：2012-05-23T22:52:24.537
> 
> 标签：.net, vb.net, vb.net-2010

我有两个文本文件，`C:\Test1.txt`和`C:\Test2.txt`.

`C:\Test1.txt`数据由以空格 (" ") 分隔的列组成：

```
Data Data
Data Data
Data Data 
```

`C:\Test2.txt`数据包括：

```
Data
Data
Data 
```

Test2 第 1 列中的字段是第 1 列 Test1 中的字段。我正在尝试从 Test1 添加匹配字段。例如：

C:\Test1.txt

```
Mercedez Silver
Bentley Black
Audi Blue
BMW White
Honda Gold 
```

C:\Test2.txt

```
BMW
Mercedez
Bentley
Audi
Honda 
```

在我运行代码后：

C:\Test2.txt

```
BMW White
Mercedez Silver
Bentley Black
Audi Blue
Honda Gold 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T23:08:58.197

因此，您只想在 txt2 中找到也在 txt1 中的所有汽车，并从 txt1 覆盖 txt2 中的行。那么这应该工作：

```
Dim l1Infos = From l1 In IO.File.ReadAllLines("C:\Test1.txt")
              Select New With {.Line = l1, .Tokens = l1.Split(" "c)}
Dim result = From l1 In l1Infos
             Join l2 In IO.File.ReadAllLines("C:\Test2.txt")
             On l1.Tokens(0) Equals l2
             Select l1.Line
IO.File.WriteAllLines("C:\Test2.txt", result) 
```

请注意，对于异常数据，它尚不安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-22T00:40:14.620

因此，您在技术方面的任务是这样的（根据原始问题和评论）：

*   假设第一个文件是汽车制造颜色的字典。
*   假设第二个文件是一个品牌列表。
*   您需要使用第一个文件为这些品牌找到匹配项。
*   忽略两个输入文件中的空行。
*   如果没有找到 make ，则放置一个空字符串作为颜色。

一个老派的解决方案可以分为三个部分：

```
'read the first file into a dictionary of make to color
Dim dict As New Dictionary(Of String, String)
For Each line As String In IO.File.ReadAllLines("C:\Test1.txt")
  Dim a() As String = line.Split({" "}, StringSplitOptions.RemoveEmptyEntries)
  If a.Length = 0 Then Continue For 'ignore blank lines
  Dim key As String = a(0)
  Dim value As String = a(1)
  dict.Add(key, value)
Next

'find matches for makes listed in the second file and prepare output
Dim outputLines As New List(Of String)
For Each key As String In IO.File.ReadAllLines("C:\Test2.txt")
  If key = String.Empty Then Continue For 'ignore blank lines
  Dim value As String = Nothing
  dict.TryGetValue(key, value) 'leave Color blank if not found
  outputLines.Add(String.Format("{0} {1}", key, value))
Next

'write output
IO.File.WriteAllLines("C:\Test3.txt", outputLines) 
```

为可扩展性而构建，可以根据您的需要轻松地进一步调整上述内容。请注意，我正在输出到另一个文件（#3）。这是为了测试目的而保留输入。您想保留输入以防出现问题，并且需要快速修复并重新运行程序。在确定它按预期工作后，您可以更改代码以替换文件 #2。

# wix - 创建简单的自定义操作 Wix 安装程序

> ID：10728958
> 
> 赞同：0
> 
> 时间：2012-05-23T22:52:28.883
> 
> 标签：wix, windows-installer, wix3.6

是否可以创建一个简单的 WIX 安装程序，它只执行自定义操作，不执行其他任何操作？我知道我可以通过使用以下 WIX 标记让它工作，但是这仍然会在 Program Files 中创建一个文件夹，如果我删除 CreateFolder 行，它就不起作用。

```
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" 
 xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" 
 xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">
<Product Id="*" Name="RegisterDotNetISS" Language="1033" Version="1.0.0.0" Manufacturer="MyCompanyhere" UpgradeCode="67825899-d511-4cd3-a8c1-b2dd448a74bd">
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate />

<PropertyRef Id="NETFRAMEWORK40FULLINSTALLROOTDIR"/>
<PropertyRef Id="NETFRAMEWORK40FULLINSTALLROOTDIR64"/>

<CustomAction Id='aspnetregiisi'  ExeCommand='"[NETFRAMEWORK40FULLINSTALLROOTDIR]\aspnet_regiis.exe" -i -enable' Directory='TARGETDIR' />
<CustomAction Id='aspnetregiisix64'  ExeCommand='"[NETFRAMEWORK40FULLINSTALLROOTDIR64]\aspnet_regiis.exe" -i -enable' Directory='TARGETDIR' />

<InstallExecuteSequence>
  <Custom Action="aspnetregiisi" After="CostFinalize">NOT VersionNT64</Custom>
  <Custom Action="aspnetregiisix64" After="CostFinalize">VersionNT64</Custom>
</InstallExecuteSequence>
<Directory Id="TARGETDIR" Name="SourceDir">
  <Directory Id="ProgramFilesFolder">
    <Directory Id="INSTALLFOLDER" Name="RegisterDotNetISS" >

      <Component Id="Component1"
                 Guid="{78E22868-B750-47EB-9E4C-C19CCA939394}">
        <CreateFolder />
      </Component>
    </Directory>
  </Directory>
</Directory>

<Feature Id="ProductFeature" Title="RegisterDotNetISS" Level="1">
  <ComponentRef Id="Component1" />
    </Feature>
</Product>

</Wix> 
```

--EDIT-- 我正在考虑创建 WIX 安装程序而不是控制台应用程序，因为 .net 3.5 框架似乎在读取 64 位注册表时存在问题。在 4.0 中添加了执行此操作的简单功能，并且在 IIS 中注册 asp.net 的空安装程序似乎可以始终如一地工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T20:54:41.277

它被称为“特洛伊木马 MSI”，因为它看起来像 MSI，但行为却不像一个 MSI。有些[人](http://blogs.msdn.com/b/robmen/archive/2006/02/01/521809.aspx)@Microsoft 批评了这一点，但有些人（又是微软）发表了它们。（阅读评论..）

如果这是你需要的，他们可以很安静。看看微软推出的“Mr FixIt's”。由 MSI 驱动的漂亮向导 UI，对您的系统进行了一些更改，但实际上并没有安装任何东西。

那么该怎么做呢？基本上，您必须在执行序列中抑制一堆标准操作，以便不会创建目录，并且不会将功能/组件/产品等发布到跟踪 MSI 所做操作的 MSI 元数据库。

您可以通过创作 InstallExecuteSequence 元素以及 PublishProduct、PublishFeatures、PublishComponents、InstallFiles、CreateFolders 等子元素来完成此操作，并使用 Suppres 属性禁用它。

# php - 正则表达式，在几个大括号内查找文本

> ID：10728961
> 
> 赞同：0
> 
> 时间：2012-05-23T22:52:39.740
> 
> 标签：php, regex, arrays, brackets, curly-braces

我在这里很新，我希望我能解释我的问题。

我有一个这样的字符串：“{sometext {'id':123,'email':'email1','pass':'pass1'},someothertext:{'id':456,'email':'email2 ','通过':'pass2'}}"

我想创建一个这样的数组： Array ( [0] => 'id':123,'email':'email1','pass':'pass1' [1] => 'id':456 ,'email':'email2','pass':'pass2')

我找不到执行此操作的正则表达式... :(

好吧，如果我可以使用 $arr[0][0] 访问第一个 id，使用 $arr[0][1] 访问第一封电子邮件...等等，那就更好了。

谁能帮帮我？？多谢

* * *

抱歉耽搁了……谢谢大家！！最后我成功了 :) 我删除了外部大括号，用双引号替换了单引号，然后使用了 json_decoded （非常完美！）再次感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:00:14.727

您描述的输入字符串似乎是 JSON 格式。有很多库可以读取各种语言的 JSON 数据，请查看： http: [//www.json.org/](http://www.json.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:08:24.483

这个正则表达式可以帮助

```
{(?:'([^']*)':([^,]*),?)*} 
```

第一组将包含“id”，第二组将包含“123”

请注意，如果您使用 1 个正则表达式执行此操作，则需要一个支持同一组中的多个捕获的正则表达式引擎。.NET 正则表达式引擎可以做到这一点。

如果不是，您需要使用正则表达式进行 2 次传递。让我知道您对这个答案的了解程度。

# javascript - 通过拖动拉伸和收缩 div

> ID：10728965
> 
> 赞同：1
> 
> 时间：2012-05-23T22:52:56.990
> 
> 标签：javascript

在没有 jQuery 的情况下使用 javascript，我想让用户绘制一个可以标记照片的矩形。通过在照片上拖动鼠标来选择矩形。当用户拖出该区域时，矩形会拉伸和收缩。用户可以向任何方向拖动，包括向上和向左拖动，就像大多数计算机桌面上的可拖动矩形一样。我应该设置的 div 对象的样式属性是什么？

* * *

**编辑**：我只是在寻找正确的属性来设置拖动 div 边缘。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T01:56:50.307

我想到了。我需要使用 `offsetLeft`, `offsetRight`, `offsetTop`, `offsetBottom`, `offsetWidth`, 和`offsetHeight` 来获取测量值，以及 `style.left`, `style.right`, `style.top`, `style.bottom`,`style.width`并`style.height` 设置它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T22:55:07.010

看看[jQuery Resizable](http://jqueryui.com/demos/resizable/)。

如果它符合您的需求，请使用它，否则请查看它是如何实现的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T23:11:15.113

有一个“可调整大小”的 css 属性，但我认为这只适用于右下角......我建议只监听 mousedown 事件，然后获取鼠标坐标，然后开始监听 mousemove 事件并作为每个事件fires 根据新坐标设置 div 的大小/位置，然后在 mouseup 事件上删除 mousemove 事件侦听器。我以前做过，我敢肯定 - 我会查找代码并将其放入 jsfiddle 中为您服务。

# postgresql - 打破一个人的工作清单和这个人一天可以做的工作的数量

> ID：10728971
> 
> 赞同：0
> 
> 时间：2012-05-23T22:53:40.033
> 
> 标签：postgresql

我有一份要做的事情清单，想把它分解成人们每天可以做的事情。此数据在 2 个表中

所以我有 2 个表 第一个是要做的事情的列表
**表 1**

```
task 
-----------
job a 
job b
job c
...
job z 
```

**表 2**是人员列表以及他们每天可以做的事情

```
person | date     | amount 
------- -------- ---------- 
Mike    05/23/12 3
Paul    05/23/12 2
Mike    05/24/12 1
Paul    05/24/12 3
...
Mike    06/01/12 6
Paul    06/01/12 9 
```

所以我想要的是得到类似的东西

```
Order_id| Person  |date     |task
-------- --------- --------- -----------
1        Mike      05/23/12  job a
2        Mike      05/23/12  job b
3        Mike      05/23/12  job c
4        Paul      05/23/12  job d
5        Paul      05/23/12  Job e
6        Mike      05/24/12  job f
7        Paul      05/24/12  job g
...
26       Mike      06/01/12  job z 
```

我不知道我会怎么做。我在 Postgres 8.4 中工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:30:09.670

使用另一个表：table3 具有整数序列 1 到（最大数量），您可以查询它。

表3样本

```
seq
-----
1
2
3
4
...
9
10
11
... 
```

查询样本

```
select
  sub1.Order_id,
  sub2.Person,
  sub2.date,
  sub1.task
from
(
select
  row_number() over(order by task) as Order_id,
  task
from table1
order by task
) as sub1
inner join
(
select 
  row_number() over(order by table2.date, table2.person) as Order_id,
  table2.person,
  table2.date,
  table2.amount,
  table3.seq
from table2
inner join table3
 on table2.amount >= table3.seq
) as sub2
on sub1.Order_id = sub2.Order_id 
```

`row_number()`请注意，从 PostgreSQL 版本 8.4 开始可以使用诸如窗口函数。

# java - 如何使用 Java 从 Windchill 中检索部件/BOM？

> ID：10728973
> 
> 赞同：3
> 
> 时间：2012-05-23T22:54:10.710
> 
> 标签：java, ptc-windchill

我的组织已经安装了 Windchill 和 PDMLink，我们有兴趣将这些系统中的部件和 BOM 数据与企业中的第三方系统集成。我们的目的是编写一个从 Windchill/PDMLink 提取数据并将其放入其他系统的 Java 应用程序。我们没有大型 ERP 系统，因此我们对开发重型自动化连接器不感兴趣——我们只想要一种简单的方法，使用它的 SOAP Web 服务从 Windchill 检索数据。

不幸的是，我找不到任何文档让我开始。我找到了一些 Web 服务文档 (http:// *my-windchill-server* /Windchill/infoengine/jsp/tools/doc/index.jsp)，但我不知道如何调用该 Web 服务。有人可以帮我指出正确的方向吗？

*   如何执行简单的 SOAP 调用以从 Windchill 检索信息？
*   如果我获得 Windchill 安装文件，是否有 API 或可以包含在我的 Java 项目中的东西？
*   在某个地方我可以找到这种情况的示例代码吗？

任何帮助将不胜感激，如有必要，我很乐意澄清或提供更多信息。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T15:49:46.327

我不确定您使用的是哪个 Windchill 版本，以及您的 Windchill 基于什么操作系统。

1.  回答 Q1。请 google windchill info-engine 获取 SOAP
2.  回答 Q2。如果您已经安装了windchill，请在系统变量**WT_HOME** /codebase 下构建一个codebase.jar 并将所有java 文件和jar 一起收集，并将codebase.jar 导入IDE 工具，检查API。
3.  回答 Q3。如果您在 Windows 系统下安装 Windchill，有一种方法可以获取**WT_HOME**下的所有文档，请在 *.pdf 下搜索。目录下有很多参考文档（对于我来说，在windchill 9.1 和windows 操作系统上可以找到它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-11T14:41:47.997

您可以使用 Web 服务的 WSDL 文件通过 wsimport 工具生成 Java 类。大多数课程都是自我解释的。您不需要任何 Windchill 库。

# c# - MVC3站点丢失存储在会话中的值

> ID：10728977
> 
> 赞同：2
> 
> 时间：2012-05-23T22:54:38.710
> 
> 标签：c#, asp.net, asp.net-mvc-3, session

所以，今天早上，我们托管 MVC3 网站的服务器断电。由于它重新上线，我们随机丢失了我们的会话值。这只发生在此服务器上，而不是本地或临时服务器上。这与超时无关，因为会话在短短 5 分钟后清除。会话设置为 12 小时后到期。当值丢失时，会话的 SessionID 不会更改。

我正在使用 Log4Net 并添加了很多日志记录来尝试查明这个问题。我已将 Session_Start 和 Session_End 事件添加到 Global.asax 中，并在整个控制器中检查会话值。

我有一个显示项目列表的索引视图。列表中的每个项目都有一个链接，可将您带到详细信息视图。我检查每个 Action 调用的会话值。从详细信息视图回调到索引视图时，会话值似乎总是丢失。我注意到的是，每次我的会话值丢失时，都会触发一个 Session_Start 事件。

没有 Session_End 事件，只有一个 Start。什么会导致这个开始发生？

如果我可以提供更多信息，请发表评论，我会添加我可以添加的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:57:31.707

如果您使用`InProc`SessionState，那么您的应用程序池可能会在您的某些会话中回收。要补救使用***SQLServer*** SessionStateMode、***StateServer*** SessionStateMode 或***减轻***应用程序池回收。

[http://msdn.microsoft.com/en-us/library/ms178586.aspx](http://msdn.microsoft.com/en-us/library/ms178586.aspx)

* * *

> SQLServer 模式将会话状态存储在 SQL Server 数据库中。这可确保在重新启动 Web 应用程序时保留会话状态，并使会话状态可用于 Web 场中的多个 Web 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T19:19:23.953

这最终成为一个硬件问题。此 Web 服务器是一个虚拟机。似乎停电影响了我们所有的虚拟服务器，导致了很多 i/o 问题以及内存问题。我确实缩小了应用程序中丢失状态的区域，但它根本不一致。

由于他们重新启动了虚拟服务器主机，我们不再遇到问题。

# windows - 我如何在 vb.net 中使用外部温度计

> ID：10728987
> 
> 赞同：0
> 
> 时间：2012-05-23T22:56:13.837
> 
> 标签：windows, interface

我是一名程序员，我主要使用 asp.net 编写网络应用程序。我需要使用一些外部温度传感器和控制器来运行太阳能热水器。我需要能够监控多个温度传感器并根据特定逻辑启动/停止水泵。我可以对此进行编码，但我的问题是我在哪里可以找到这样的设备，即我可以搜索什么等，以及我怎样才能将它连接到接口以便我可以在编程中使用它。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:58:04.633

看看netduino和微框架。这篇文章似乎涵盖了你想要的[http://blogs.msdn.com/b/vbteam/archive/2011/08/02/temperature-monitoring-using-vb-net-and-the-micro-framework-and-一个-netduino.aspx](http://blogs.msdn.com/b/vbteam/archive/2011/08/02/temperature-monitoring-using-vb-net-and-the-micro-framework-and-a-netduino.aspx)

# haskell - 函数式编程语言中的 Church-Rosser 定理示例

> ID：10728997
> 
> 赞同：14
> 
> 时间：2012-05-23T22:56:57.667
> 
> 标签：haskell, functional-programming, ml, lambda-calculus

在学习函数式编程时，我看到过多次引用[Church Rosser 定理](http://en.wikipedia.org/wiki/Church-Rosser)，尤其是菱形属性图，但我没有遇到过很好的代码示例。

如果像 Haskell 这样的语言可以被视为一种 lambda 演算，那么一定可以使用该语言本身来举出一些例子。

如果该示例很容易显示步骤或减少如何导致易于并行化的执行，我会给予奖励积分。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-23T23:35:33.150

所有这些定理都表明，一个可以通过多条路径归约的表达式必然会进一步归约为一个共同的产品。

例如，以这段 Haskell 代码为例：

```
vecLenSq :: Float -> Float -> Float
vecLenSq x y =
  xsq + ysq
  where
    xsq = x * x
    ysq = y * y 
```

在 Lambda 演算中，此函数大致相当于（为清楚起见添加了括号，运算符假定为原始）：

```
λ x . (λ y . (λ xsq . (λ ysq . (xsq + ysq)) (y * y)) (x * x)) 
```

表达式可以通过首先对 应用 β 归约`xsq`或通过对 应用 β 归约来归约`ysq`，即“求值顺序”是任意的。可以按以下顺序简化表达式：

```
λ x . (λ y . (λ xsq . (xsq + (y * y))) (x * x))
λ x . (λ y . ((x * x) + (y * y))) 
```

...或按以下顺序：

```
λ x . (λ y . (λ ysq . ((x * x) + ysq)) (y * y))
λ x . (λ y . ((x * x) + (y * y))) 
```

结果显然是一样的。

这意味着术语`xsq`和`ysq`是独立可约化的，并且它们的约化可以并行化。事实上，人们可以像在 Haskell 中那样并行化减少：

```
vecLenSq :: Float -> Float -> Float
vecLenSq x y =
  (xsq `par` ysq) `pseq` xsq + ysq
  where
    xsq = x * x
    ysq = y * y 
```

这种并行化实际上不会在这种特殊情况下提供优势，因为由于调度开销，按顺序执行的两个简单浮点乘法比两个并行乘法更有效，但对于更复杂的操作可能是值得的。

# image - 第三方图像的 SEO 影响

> ID：10728998
> 
> 赞同：0
> 
> 时间：2012-05-23T22:56:57.790
> 
> 标签：image, seo, web, search-engine

以清晰和可访问的方式（例如使用属性）呈现的高质量、相关图像`alt`可以为网站提供 SEO 提升，尤其是通过图像搜索引擎。

我想知道托管 3rd 方图像对 SEO 的影响是什么。

我正在考虑使用[Thumbshots](http://www.thumbshots.com/Community/Articles/tabid/93/EntryID/26/Default.aspx)提供的网站缩略图来帮助补充一个[项目](https://stackoverflow.com/questions/10486321/linking-together-100k-pages-without-getting-seo-penalized)，以对网络上数百万个网站的隐私和安全进行分类。虽然我知道这些缩略图会提高我网站的质量，但我想知道它们对 SEO 的影响是什么。

Thumbshots 的工作方式是从服务器提供图像。我的一个想法是通过代理通过我自己的服务器上的 URL 提供他们的图像，如果这对我的网站的 SEO 会更好的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:22:00.723

我不认为从哪里提供图像对 SEO 的影响并不像您想象的那么大。自己提供图片会导致您的网站加载速度稍慢，这可能会对 SEO 产生负面影响。

但是，良好的 SEO 会考虑用户体验和易用性，听起来您已经在积极考虑这一点。

过去我曾在图片较多的网站上使用过 CDN，因此加载时间有所增加。我主要关心的是合法性问题。

# java - 在 Windows 任务栏中创建多个图标

> ID：10728999
> 
> 赞同：2
> 
> 时间：2012-05-23T22:57:04.850
> 
> 标签：java, swing, user-interface

我将 JFrame 作为我的 GUI 中的父级。在其中，我提出了启动 JDialog 的选项，该 JDialog 从客户端获取信息。JDialog 出现在不同的窗口中，我希望在 Windows 7 任务栏中看到两个不同的窗口图标，一个用于 JFrame，另一个用于 JDialog。目前，我在任务栏中只得到一个图标，单击它，它会将客户端返回到主屏幕。（JFrame。）

可以在 Java 中覆盖此行为吗？当我打开多个窗口时，我希望行为类似于 Chrome 或任何其他程序的行为，即能够将鼠标悬停在窗口图标上，并能够选择将哪个窗口带到前面展示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T10:05:53.603

只需创建一个新的 JFrame，在那里设置图标。然后将这个新创建的 JFrame 作为所有者转发给 Dialog。它仅取决于所有者框架。如果这是无效的，则将应用程序一作为默认设置。