# StackOverflow 问答 000745000-000745999

# postgresql - Postgres：缺少或错误的 pg_hba.conf 文件

> ID：745019
> 
> 赞同：7
> 
> 时间：2009-04-13T19:09:46.427
> 
> 标签：postgresql, configuration

我有两台机器坐在我的桌子上并连接到同一个 IP 网络。我正在尝试将应用程序从一台机器连接到另一台机器上的 postgres 数据库。起初，带有应用程序的主机给了我 PSQLException：

```
FATAL: no pg_hba.conf entry for host "192.168.1.18", user "user1", database "test", SSL off 
```

所以我编辑了我的 pg_hba.conf 文件以接受 IP 地址：192.168.1.18，在文件末尾添加以下行：

```
host    pnp         all         192.168.1.18      trust 
```

然后我收到另一种类型的错误消息：

```
FATAL: missing or erroneous pg_hba.conf file 
```

我在这里有什么遗漏吗？

谢谢，兰斯洛特

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-13T19:15:37.647

您还必须指定主机的网络掩码。所以用“ `192.168.1.18/32`”或“ `192.168.1.18 255.255.255.255`”代替裸IP地址。

有关详细信息，请参阅在线手册中[的 pg_hba.conf 文件](http://www.postgresql.org/docs/8.3/interactive/auth-pg-hba-conf.html)章节。

# linq-to-sql - 将 sql 转换为 linq

> ID：745020
> 
> 赞同：-1
> 
> 时间：2009-04-13T19:10:40.183
> 
> 标签：linq-to-sql, join

```
select m.messageID,m.[addeddate],m.message,count(*) as Comments 
from intranet.dbo.Blog_Messages AS m inner join 
intranet.dbo.Blog_Comments AS c on c.messageid = m.messageid
group by m.messageID,m.[addeddate],m.message 
```

需要帮助将其转换为 linq to sql

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T19:16:37.470

```
from m in context.Blog_Messages
select new
{
   MessageId = m.MessageID,
   AddedDate = m.AddedDate,
   Message = m.Message,
   Comments = m.Blog_Comments.Count()
} 
```

这不是直接转换，但我认为这就是你所追求的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T19:40:06.243

```
来自 db.Blog_Messages 中的 m
在 m.MessageID 上的 db.Blog_Comments 中加入 c 等于 c.MessageID
按新 { 分组 m
  m.MessageID,
  m.添加日期，
  m.消息
} 到 g
选择新的{
  MessageID = g.Key.MessageID,
  添加日期 = g.Key.AddedDate,
  g.Key.Message，
  评论 = g.Count()
}

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T19:32:23.283

```
 Dim Msg = From m In db2.Blog_Messages _
        Group Join c In db2.Blog_Comments On m.MessageID Equals c.MessageID Into Comments = Group _
        Join u In db2.users On m.userID Equals u.userid _
        Select New With {
           m.Title, m.Message, m.MessageID, 
          .CommentCount = Comments.Count(), 
          .date1 = m.AddedDate.ToShortDateString, 
          .Time = m.AddedDate.ToShortTimeString(), 
          .fullName = u.fname & " " & u.lname
        } 
```

这就是我想出的..

谢谢，克里斯

# java - 在 Java 中抑制运行时控制台警告的最佳方法是什么？

> ID：745022
> 
> 赞同：17
> 
> 时间：2009-04-13T19:13:22.533
> 
> 标签：java, console, runtime, warnings, suppress-warnings

我正在使用 org.apache.commons.httpclient.methods.PostMethod 类的 getResponseBody() 方法。但是，我总是在运行时收到一条写入控制台的消息：

*警告：要缓冲大或未知大小的响应主体。建议改用 getResponseBodyAsStream。*

在代码中，无论如何我都必须将响应写入字节数组，所以我应该使用 getResponseBody() 方法。但是有没有一种简单的方法可以抑制警告消息，这样我就不必在每次运行时都查看它？

如果是编译器错误，我会使用*@SuppressWarnings*注释，但这不是编译时问题；它发生在运行时。此外，我可以使用 getResponseBodyAsStream 写入 ByteArrayOutputStream，但这似乎是一种绕过警告的 hacky 方法（额外的代码行来完成 getResponseBody() 已经为我做的事情）。

我的猜测是答案涉及 System.out 或 System.err 操作，但有没有好的方法呢？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-13T19:23:56.940

如果您想彻底停止此日志条目，则有一个可调整的最大值来触发警告。我在[看代码时](http://google.com/codesearch/p?hl=en#uZxE5gtdHtc/java/src/org/apache/commons/httpclient/HttpMethodBase.java&q=getResponseBodyAsStream%20instead%20is%20recommended)看到了这个。

```
 int limit = getParams().getIntParameter(HttpMethodParams.BUFFER_WARN_TRIGGER_LIMIT, 1024*1024);
        if ((contentLength == -1) || (contentLength > limit)) {
            LOG.warn("Going to buffer response body of large or unknown size. "
                    +"Using getResponseBodyAsStream instead is recommended.");
        } 
```

HttpMethodBase.setParams() 看起来像是将 HttpMethodParams.BUFFER_WARN_TRIGGER_LIMIT 设置为所需值的地方。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-07-22T05:30:28.167

当 httpClient 不知道返回数据的长度时会发生该警告，您应该在服务器端设置 content-length 属性

```
response.addHeader("Content-Type", "text/html; charset=utf-8");
response.addHeader("Content-Length", String.valueOf(output.getBytes("utf8").length)); 
```

之后，该警告应该消失

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-13T19:31:41.537

我建议您按照警告的建议进行操作，并使用流而不是字节数组。如果您尝试推送的响应特别大（假设它是一个大文件），您会将其全部加载到内存中，那将是一件非常糟糕的事情。

使用流真的会更好。

也就是说，您可以通过临时替换 System.err 或 System.out 来绕过它。它们只是`PrintStream`对象，可以使用 setOut 和 setErr 方法设置。

```
PrintStream oldErr = System.err;
PrintStream newErr = new PrintStream(new ByteArrayOutputStream());
System.setErr(newErr);

// do your work

System.setErr(oldErr); 
```

**编辑：**

> *我同意最好使用流，但就像现在一样，我需要放置响应的目标 API 是一个字节数组。如有必要，我们可以对 API 进行重构，使其能够获取流；那会更好。警告肯定是有原因的。*

如果您可以修改 API，请执行此操作。在这种情况下，流处理是最好的方法。如果由于内部压力或其他原因您不能，请转到[@John M](https://stackoverflow.com/questions/745022/whats-the-best-way-to-suppress-a-runtime-console-warning-in-java/745054#745054)的路线并提高`BUFFER_WARN_TRIGGER_LIMIT`-- 但请确保您有已知的 contentLength，否则即使该路线也会失败。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-13T19:21:25.057

库是通过 log4j 输出的吗？如果是这样，编辑 log4j.properties 以将此类的输出设置为“错误”将起作用，例如

```
log4j.logger.org.apache.commons.httpclient.methods.PostMethod=ERROR 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-13T22:51:22.167

[这个问题已经在 ASF JIRA 上进行了辩论](http://issues.apache.org/jira/browse/HTTPCLIENT-479)。有两种方法可以解决这个问题：

*   [为BUFFER_WARN_TRIGGER_LIMIT](http://hc.apache.org/httpclient-3.x/apidocs/org/apache/commons/httpclient/params/HttpMethodParams.html#BUFFER_WARN_TRIGGER_LIMIT)设置更高的值。足够高的值更有可能抑制警告；但是，这违背了警告本身的目的。如果您要缓冲大量数据以最终一次性解析，那么最好在处理数组之前将数据从流中读取到数组中。
*   如果您对 ERROR 或 FATAL 感到满意，请将 HttpClient 的日志记录级别设置为更高的值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-13T19:16:00.313

假设将警告写入 stderr，您始终可以通过将 stderr 管道传输到`/dev/null`或系统上的任何等效项来抑制警告。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-03T20:09:36.757

简单地“保存”stderr 消息，然后在完成主要任务后打印它们

```
PrintStream origErr = System.err;
ByteArrayOutputStream baos = new ByteArrayOutputStream();
PrintStream newErr = new PrintStream(baos);
System.setErr(newErr);

====== do stuff ======

System.setErr(origErr);
System.err.print(baos); 
```

# c - Windows 指针位图未正确更新

> ID：745024
> 
> 赞同：1
> 
> 时间：2009-04-13T19:13:30.880
> 
> 标签：c, windows, user-interface, winapi, mdi

所以，我正在使用 MDI 编写一个文本编辑器。

我有一个框架窗口、子窗口，每个子窗口都有一个文本区域窗口。

现在，我的问题是指针。它没有将自己设置为正确的位图。因此，例如，如果我将指针移动到边框，它会正确地变成左右拖动图标。这一切都很好——但是当我将它移到文本窗口区域时，*它并没有变回普通的指针*。这真是太棒了。

为什么指针位图没有被更新的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T20:26:47.553

原来我错误地调用了 LoadCursor()。

如果您使用的是预定义的游标，则第一个参数（即实例）必须为 NULL。

我的论点不是 NULL（而且我没有检查返回值，*咳！*）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T19:27:00.910

我的第一个猜测是你正在拦截 MDI 用来交换指针位图的事件，而不是将它传递到链上。

# java - 我应该选择哪个框架——Seam、Wicket、JSF 或 GWT？

> ID：745029
> 
> 赞同：20
> 
> 时间：2009-04-13T19:14:53.403
> 
> 标签：java, jsf, seam, wicket, web-frameworks

我正在争论是否使用 Seam、Wicket、JSF 或 GWT 作为我在 Java 项目中表示层的基础。

根据就业市场的考虑、技术的新颖性和其他 SO 用户的建议，我将 Java Web 框架的选择范围缩小到这个子集。

在这些因素中我应该考虑哪些因素？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2010-08-31T16:02:57.600

我从 1.4 版开始使用 GWT，从 2.0 规范出来后使用 JSF。

GWT 是一个客户端框架，它从 Java 生成 JavaScript。您的架构将是一个纯粹的客户端-服务器，这意味着：

*   最好使用粗粒度服务
*   所有到达客户端的对象都应该是完全可序列化的（这意味着没有延迟加载或 OpenSessionInView 模式）
*   从 GWT 2.0 开始，您可以使用 xhtml 设计您的 gui，这在样式和构建 HTML 方面要容易得多
*   GWT 倾向于支持好的架构，如果你把它搞砸了，重构就会很*糟糕*
*   *完美*的历史记录（浏览器后退按钮、可收藏的 url）支持**很难**，你可能必须自己动手，虽然很容易在前面破解一些东西

JSF 是一个基于组件的框架，具有视图优先的设计（如果您愿意，可以使用代码隐藏）：

*   做一些类型的网络应用程序更容易（有状态的，比如购物车）
*   JSF+Seam 支持对话（想想在多个页面之间维护状态的类似向导的页面）
*   您*可以*实现 OpenSessionInView，具体取决于您的堆栈。如果您将 EJB 用于服务/业务层，则可能不推荐
*   JSF2 对 AJAX 有**极好的**支持，并且使用 RichFaces 之类的组件套件，您可以构建漂亮的 web 应用程序
    *   但是如果你想要精致的 javascript 行为，你必须编写一些 javascript
*   JSF 在客户端或服务器端跟踪当前 UI 状态。这是网络流量或服务器内存之间的权衡。

恢复：

*   **GWT**更适合需要最佳客户端性能的 Web**应用程序（想想 gmail）。**编写自定义组件（您编写 Java）很容易，并且由于您的服务器端只是一个服务层，您可以在服务器端完全无状态。
*   **JSF**更适合大多数 CRUD 应用程序，这些应用程序更适合面向组件的东西：想想酒店/航班预订系统、带有购物车的在线商店等

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-13T20:50:45.297

我用过的唯一一个是 JSF，所以我不能给你关于其他的反馈，但这是我对 JSF 的看法。根据我的经验，当我们从 JSP 中的 JSF 转换为 facelets 中的 JSF 时，生活变得轻松多了，所以我将专注于 facelets。此外，Seam 和 JSF 看起来并不相互排斥。

优点：

*   创建 facelets xhtml 组件很简单，这促进了重用。
*   使用 ui:insert、ui:include 和 ui:decorate 等内置标签的良好模板能力
*   通过 faces-config 简单访问 Spring bean
*   基于 XHTML，因此不熟悉 java 的 web 开发人员仍然可以有效
*   战斧/特立尼达提供了良好的小部件库

缺点：

*   仅发布请求。这会使书签变得困难。
*   不像 GWT 那样内置 ajax-y，但如果与 Seam 一起使用，这可能会得到修复

我绝不是 JSF/Facelets 方面的专家，所以我敢肯定还有其他一些我错过了。希望其他人也能详细说明。

**JSF 2.0 的更新：**

*   具有更好的复合组件重用能力
*   2.0 的小部件库包括 primefaces 和 mojarra scales
*   允许获取请求和书签
*   已内置 Ajax 支持
*   有关JSF 2 的更多信息，请参阅[http://andyschwartz.wordpress.com/2009/07/31/whats-new-in-jsf-2/](http://andyschwartz.wordpress.com/2009/07/31/whats-new-in-jsf-2/)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-08-10T05:13:02.930

感谢检票员保持清醒并继续讨论。我是检票口用户，我喜欢它。我的主要原因是：

1.  它是一个组件框架。我喜欢使用组件而不是整页。
2.  我可以让设计人员在处理 java 部件时处理模板和页面

3.  没有什么新东西要学。它的“只是 java 和 HTML”

4.  我喜欢它的 ajax Fallback 机制。如果浏览器不支持 JavaScript，尤其是在移动设备上，它会退回到纯 html 并且一切正常。
5.  它缺少 xml 配置是一个优点
6.  它支持我在 Web 应用程序中想要的一切。例如验证、国际化、后退按钮支持和 restful URL 等

我之前的经验是 GWT 和 JSF 1.0

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-13T20:59:00.033

Seam 是一个应用程序框架，而不是真正的表示层。它最初是为了让 JSF 不那么痛苦而开发的，但已经演变成一个更通用的依赖注入框架。

我相信您可以将 Seam 与 JSF、Wicket 和 GWT 一起使用。JSF 支持是主要且优秀的；我不确定其他两个的支持情况如何。

由于您的标准的重点似乎是您的技能的适销性，我建议通过 Facelets 尝试 Seam 和 JSF。JSF 是一个广为接受的标准，如果您使用 Facelets，它实际上是一种令人愉快的使用。您可以通过 Richfaces 和 Ajax4jsf 获得流畅的 AJAX 功能。Seam 正在通过 JCP 或多或少地标准化。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-02-10T22:37:10.210

我的经验是，按时间顺序：

原始 servlet - （是的，很多艰苦的工作，但那是早期的，我们是热切的海狸！）

JSP - 我以为它出来的时候是个笨蛋（如果我们只知道；））

Echo - 很棒的框架，但不适用于需要搜索引擎友好的页面（与 GWT 相同的问题）

Wicket - 很棒的框架 - 开发人员完全理解 OO 的概念（与 JSP 和许多其他人不同），并将所有常见的 OO 细节应用于该框架。如果您喜欢“可重用性”，如果您喜欢封装，如果您喜欢关注点分离，如果您喜欢将模型绑定到 UI 代码而不必担心对象编组和其他此类丑陋，那么这就是您的框架！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-17T01:13:08.773

从长远来看，我建议使用受 Sun 规范支持的技术。到目前为止，这已被证明可以提供多种实现，从而导致选择（通常也是开源实现），而且行为往往被很好地定义。

这将在维护场景中为您提供帮助，希望您的代码也能及时结束。写得好的代码永远存在 :)

在这种特殊情况下，我建议使用 JSF。我只尝试了 1.1 的 Apache 实现，但是在 JSP 之上是很痛苦的。我们将很快对其进行修改——我希望研究在 facelets 上使用 JSF。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-28T16:42:06.843

我已经大量使用了 Wicket 和 GWT。从来没有真正学会爱威克特。

我的自我写了关于它的博客[http://salk31.blogspot.com/2009/07/wicket-ajax.html](http://salk31.blogspot.com/2009/07/wicket-ajax.html)

今天查看 GWT 2.0 uiBinder 让我想起了在 Wicket 中必须将 XML 组件树与用 Java 创建的组件树进行匹配是多么烦人。对我来说，GWT 的旋转看起来要好得多。

我已经有一年多没有使用 Wicket 了，所以也许他们已经修复了很多问题，但鉴于现代浏览器和 JS 支持，我看不出在服务器上做所有这些事情的意义（我知道，我知道数据局部性）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-05-21T13:14:08.590

如果你只考虑就业市场，你应该选择JSF。但是，我相信 RIA 的未来属于 GWT 和 gwt 之类的客户端技术。

我认为 GWT 最明显的优点是，它比 JSF、wicket 等服务器端表示层技术具有更好的可扩展性。因为，服务器不需要存储客户端状态，也使用了客户端 cpu 电源。这是一个巨大的好处，你不需要在服务器计算机之间序列化客户端状态来实现容错系统。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-09-13T14:40:05.590

我知道这有点晚了，但是在 Framewrok 上已经有很多比较，尤其是这个，发生在 Devox 2010 conf 期间：

[http://www.devoxx.com/display/Devoxx2K10/Comparing+JVM+Web+Frameworks](http://www.devoxx.com/display/Devoxx2K10/Comparing+JVM+Web+Frameworks)

这应该可以帮助您选择:)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-09-13T17:47:13.300

我从 JSF（1.1 和 1.2）开始，非常痛苦，我决定在下一个项目中进行更改。我进行了一些研究，然后决定尝试 Wicket，这真是一种享受。我也尝试过 JSF 2，但还是一样。

它们都是组件框架，但是使用 Wicket 很容易，而使用 JSF 则完全是一团糟。

JSF 上的检票口：

*   在 Wicket HTML 中是 HTML。JSF 有自己的标记。h:dataTable （用于表）是无稽之谈。相信我，Sun 工程师在设计它时不得不喝醉。
*   在 Wicket 中，诸如安全性之类的事情，
*   使用 JSF，导航栏会显示上一个 URL。真的很奇怪。
*   JSF 在我看来很重，而且像 Rich 或 Prime 这样的库更是如此。
*   有时，似乎不可能知道发生了什么。你总是对着你的电脑大喊大叫，因为你不知道 JSF 为什么要这么做。

检票口上的 JSF：

*   In Wicket you're going to write more Java (the binding with HTML). At least, your IDE will provide refactoring and validation support.
*   Resources management in Wicket is a bit tricky.
*   There are much more documentation and support for JSF

One common flaw is that session size is are problem (because graphical components are stored in there).

All in all, if you have to decide only between Wicket and JSF there not doubt for me, **Wicket**.

* * *

## 回答 #11

> 赞同：-10
> 
> 时间：2010-05-04T20:54:06.637

**JSF 已被弃用**（当 2010 年传教士比较或谈论 Web 框架时，JSF 甚至没有被列为可比较的框架）。

现在使用 GWT、YUI、JQuery 等创建成熟的大型应用程序。

通过google及以上阅读一些文章将是显而易见的。

（JSF 上的所有工作都是为了支持遗留应用程序）。

# javascript - 使用偏移量和 jQuery 滑块

> ID：745037
> 
> 赞同：4
> 
> 时间：2009-04-13T19:16:53.477
> 
> 标签：javascript, jquery, jquery-ui

我正在将 offset() 与 jquery 滑块一起使用，我非常接近实现我的目标，但它有点偏离。我有它使用动画到顶部 CSS 坐标设置动画，但如果你查看：[http](http://www.ryancoughlin.com/demos/interactive-slider/index.html) ://www.ryancoughlin.com/demos/interactive-slider/index.html - 你会看到它在做什么。我的目标是让它 fadeIn() 并在句柄右侧显示值。我知道我可以使用简单的边距从句柄偏移文本：0 0 0 20px。

该部分将#current_value 对齐到句柄的右侧。想法？var slide_int = null;

```
$(function(){

    $("h4.code").click(function () {
        $("div#info").toggle("slow");
    });

    $('#slider').slider({
        animate: true,
        step: 1,
        min: 1,
        orientation: 'vertical',
        max: 10,
        start: function(event, ui){
            $('#current_value').empty();
            slide_int = setInterval(update_slider, 10); 
        },
        slide: function(event, ui){
            setTimeout(update_slider, 10);  
        },
        stop: function(event, ui){
            clearInterval(slide_int);
            slide_int = null;
        }
    }); 
});
function update_slider(){
    var offset = $('.ui-slider-handle').offset();
    var value = $('#slider').slider('option', 'value');

    $('#current_value').text('Value is '+value).css({top:offset.top });
    $('#current_value').fadeIn();

} 
```

我知道我可以使用边距来抵消它以匹配，但有更好的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T20:49:23.177

有两个问题。第一个，就像 Prestaul 说的那样，滑块事件在移动的“开始”而不是结束时触发，所以偏移量是错误的。您可以通过设置超时来解决此问题：

```
$(function(){
    slide: function(event, ui){
        setTimeout(update_slider, 10);
    },
    ...
});
function update_slider()
{
    var offset = $('.ui-slider-handle').offset();
    var value = $('#slider').slider('option', 'value');
    $('#current_value').text('Value is '+value).animate({top:offset.top }, 1000 )
    $('#current_value').fadeIn();
} 
```

第二个问题是移动是瞬时的，而动画不是，这意味着标签会滞后于滑块。我想出的最好的是：

```
var slide_int = null;

$(function(){
    ...
    start: function(event, ui){
        $('#current_value').empty();
        // update the slider every 10ms
        slide_int = setInterval(update_slider, 10);
    },
    stop: function(event, ui){
        // remove the interval
        clearInterval(slide_int);
        slide_int = null;
    },
    ...
});

function update_slider()
{
    var offset = $('.ui-slider-handle').offset();
    var value = $('#slider').slider('option', 'value');

    $('#current_value').text('Value is '+value).css({top:offset.top });
    $('#current_value').fadeIn();
} 
```

通过使用`css`而不是`animate`，您可以将其始终保持在滑块旁边，以换取平滑过渡。希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T09:01:58.027

我遇到了同样的问题：Jquery Ui 滑块中的可见值落后于内部值。通过将滑块事件从“滑动”更改为“更改”来解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T20:28:51.370

您只需要使用不同的事件。“滑动”在句柄移动之前触发，因此您的值最终位于前一个句柄位置。尝试“更改”事件，看看是否能让你到达那里。

# asp.net-mvc - 如何生成链接以在 asp.net MVC 中下载文件？

> ID：745042
> 
> 赞同：4
> 
> 时间：2009-04-13T19:20:02.767
> 
> 标签：asp.net-mvc, download

我正在测试[Doddle Report](http://www.codeplex.com/doddlereport)以从 IEnumerable 对象中生成一些报告。我需要生成这样的链接

```
PDF - http://myserver.com/reports/ProductsReport.pdf 
```

问题是我该怎么做？

En 停止使用 Doddle 报告，并生成 XML 格式的 del Excel。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-13T19:35:04.463

查看本[教程](http://www.asp.net/mvc/tutorials/controllers-and-routing/aspnet-mvc-controllers-overview-cs)以返回不同的操作结果。

ASP.NET MVC 框架支持多种类型的操作结果，包括：

*   ViewResult – 表示 HTML 和标记。
*   EmptyResult – 表示没有结果。
*   RedirectResult – 表示重定向到新 URL。
*   JsonResult – 表示可以在 AJAX 应用程序中使用的 JavaScript 对象表示法结果。
*   JavaScriptResult – 表示 JavaScript 脚本。
*   ContentResult – 表示文本结果。
*   FileContentResult – 表示可下载文件（带有二进制内容）。
*   FilePathResult –**表示可下载文件**（带有**路径**）。
*   FileStreamResult – 表示可下载文件（带有文件流）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-09-01T19:50:40.800

我在 MVC 5 上做了类似的事情，我使用了 JW 所说的 FilePathResult。

cshtml:

```
@Html.ActionLink("Download Here", "DownloadExampleFiles", "Product", new { fileName = "variation-example" }, new { @target = "_blank" }) 
```

产品控制器：

```
public FilePathResult DownloadExampleFiles(string fileName)
{
    return new FilePathResult(string.Format(@"~\Files\{0}", fileName + ".txt"), "text/plain");
} 
```

下载文件似乎很傻/很容易，但是，对于那些刚接触 MVC 的人来说，事实并非如此。这种方法在使用 MVC 时听起来是最好的。

PS：我强制使用 .txt 作为示例。您应该做一些有趣的事情来获取特定文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T19:31:03.880

AFAIK，在 MVC 中这样做并没有什么特别之处。使用生成 PDF 文件的处理程序在表单上创建一个 LinkBut​​ton，然后重定向到创建的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T19:48:00.187

可能是这样的：

```
<h2>List Of Reports</h2>
<ul>
    <% foreach (var report in Model){ %>
        <li><a href="<%= Html.BuildUrlFromExpression<ReportController>(r => r.Reports(report.Filename)) %>"><%=report.Filename %></a></li>
    <% } %>
</ul> 
```

可能有更短的方法，但这有效。

# c++ - 是否有任何工具可以在 Pro*C++ 源代码上进行圈计算？

> ID：745043
> 
> 赞同：0
> 
> 时间：2009-04-13T19:21:02.810
> 
> 标签：c++, cyclomatic-complexity, oracle-pro-c

是否有任何工具能够对 Pro*C++ 源代码进行代码度量？

我无法通过谷歌找到任何具体的东西。

有人对这个有经验么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T19:34:00.550

[Pro*C 可以生成有效的 C++ 文件](http://infolab.stanford.edu/~ullman/fcdb/oracle/or-proc.html#c++%20user)，因为标准 c++ 上的代码度量工具[Google 是您的朋友](http://www.google.com/search?hl=en&safe=off&q=cyclomatic+complexity+c%2B%2B&btnG=Search)。

# java - 寻找用于创建图形（边 + 节点）的简单 Java API

> ID：745048
> 
> 赞同：18
> 
> 时间：2009-04-13T19:23:01.230
> 
> 标签：java, api, graph-theory

我正在尝试找到一个简单的 Java API 来创建图形关系。它应该有一些功能，如`addEdge()`, `addNode()`, `isConnected(node1, node2)`,`findPaths(node1, node2)`等。我不需要 UI，只需要逻辑。

我找到了一堆学术项目，但似乎没有一个是“ *The Definitive Graph API* ”。

有人知道这样的API吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-13T19:27:24.683

[JGraphT](http://jgrapht.org)听起来像您所追求的。

> JGraphT 是一个免费的 Java 图形库，提供数学图形理论对象和算法。JGraphT 支持各种类型的图。

他们的 API 可以从各种输入创建图形，还支持使用`addVertex`,来创建图形`addEdge`。他们支持使用各种众所周知的算法（例如 Bellman-Ford 和 Dijkstra）查找最短路径。他们还提供完整的[在线 javadoc](http://www.jgrapht.org/javadoc/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T19:33:27.617

[JDLS](http://www.jdsl.org/)是一个很好的图和数据结构库。您还可以使用[Grappa](http://www.research.att.com/~john/Grappa/)库。它的优点是可以使用[graphViz](http://www.graphviz.org/)库进行图形布局。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-01T12:19:20.997

Definitly You should try the [http://neo4j.org/](http://neo4j.org/) This is great Graph database written in Java but It can work as a embedded database to very small application too.

This database have everything You need even if you plan to store billions of nodes. Good luck.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T19:27:54.823

一个非常不错的可以在这里找到：[http://javaddlib.sourceforge.net/jdd/](http://javaddlib.sourceforge.net/jdd/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T19:29:27.033

*Jdigraph*是[另一个](http://java.net/projects/jdigraph)图形库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-22T15:15:47.237

[JUNG](http://jung.sourceforge.net/) — the Java Universal Network/Graph Framework - is one of the fastest available (implementing the CERN math library COLT), especially if you want to do graph analysis, centrality measurements (betweennes, pagerank, etc.). Furthermore it allows for network visualization.

# c# - 如何在 C# 中启动 UI 线程

> ID：745057
> 
> 赞同：8
> 
> 时间：2009-04-13T19:24:37.500
> 
> 标签：c#, .net, multithreading, user-interface

我知道我可以从 .NET 开始一个新的工作线程。但是如何启动一个新的 UI 线程（如在 MFC 中）？

我不介意解决方案是否仅限于 Windows 框；我还希望解决方案是纯粹的 .NET - 没有对 CreateThread 的 p/invokes 等。

任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-13T19:26:50.550

使用[`Application.Run`](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.run.aspx)- 它在当前线程中启动一个消息循环。有重载可以从一个表单开始，或者一个应用程序上下文，或者两者都没有。（如果要为*新*线程执行此操作，则需要创建线程并以正常方式启动它，并使其调用`Application.Run`。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-13T19:38:14.017

如果您对使用 WPF 感兴趣，请查看 MSDN 的文章[WPF 的线程模型](http://msdn.microsoft.com/en-us/library/ms741870.aspx)，特别是“多窗口，多线程”部分。它详细说明了创建新 Dispatcher 并在新线程上显示窗口所需执行的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T19:31:58.497

如果您希望创建一个能够创建和处理窗口句柄的新线程，那么您可以使用`SetApartmentState`Thread 对象上的函数并将其设置为`STA`. 您可能还需要`Application.Run`在该线程的方法内部调用以创建您的消息循环。但是，请记住，您会受到与任何其他线程中相同的跨线程禁忌（即，您只能与创建它的线程上的控件的句柄进行交互），所以如果不切换上下文，您将无法在其他 UI 线程上执行任何操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T19:40:21.330

你也可以这样做：

```
 delegate void MyProcHandler(object param1, object param2);

    MyForm.Invoke
    (
            new MyProcHandler(delegate(object param1, object param2) 
            {
            // some code
            }), 
            null, 
            null
    ); 
```

# sharepoint - 在“现在”或“今天”上过滤 Sharepoint 列表

> ID：745059
> 
> 赞同：21
> 
> 时间：2009-04-13T19:24:47.233
> 
> 标签：sharepoint

我正在尝试找到一种有效的方法来根据项目的年龄过滤 Sharepoint 列表。换句话说，如果我想查找 7 天前的列表项，我应该能够对数据构建过滤视图。

有[一个技巧可以构建一个“今日”字段，该字段有效](http://blogs.msdn.com/cjohnson/archive/2006/03/16/552314.aspx)，但不能正确过滤。

有没有人有什么好主意？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2010-09-10T22:13:00.467

如果您只想过滤不到 7 天的项目，那么您只需使用

筛选

*   已创建

*   大于或等于

*   [今天]-7

**注意**- 屏幕截图不正确。

![新项目 - 在过去 7 天内创建](https://i.stack.imgur.com/R6pxv.gif)

[[Today] 在 2007 年及以后的视图过滤器中得到完全支持](http://blog.pentalogic.net/2008/11/the-truth-about-using-today-in-filters/)（只需保留空格！），您只需要在 2003 年处理计算列。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-13T20:59:35.210

您是否尝试过：创建一个名为“Expiry”的计算列，其公式为“[Created] + 7 days”。然后在您的视图过滤器中使用计算列。让我们知道这是否有效或这会带来什么问题！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-22T09:14:48.370

在视图中，修改当前视图或创建新视图并更改过滤器，选择单选按钮“仅在以下情况下显示项目”，在下面的列中键入“已创建”，然后在下一个下拉列表中选择“是小于”并填写下一栏 [今天]-7。

关键字 [Today] 表示计算的当天，此视图将根据您的要求显示

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-18T18:11:52.677

关于使用 TODAY（或列中的任何计算）的警告。

如果您设置了一个过滤器并且只是 [今天] 它应该没问题。

但是，当您执行 [Today]-1 之类的操作时……尝试选择它以获取警报时，该视图将不再显示。

另一个微软奇迹。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-06-26T11:23:20.710

将 Today 作为 $viewQuery 属性中提到的值传递：

```
$web = Get-SPWeb "http://sitename"
$list = $web.Lists.TryGetList($listtitle)
write-host "Exporting '$($list.Title)' data from '$($web.Title)' site.."
$viewTitle = "Program Events" #Title property
#Add the column names from the ViewField property to a string collection
$viewFields = New-Object System.Collections.Specialized.StringCollection
$viewFields.Add("Event Date") > $null
$viewFields.Add("Title") > $null
#Query property
$viewQuery = "<Where><Geq><FieldRef Name='EventDate' /><Value IncludeTimeValue='TRUE' Type='DateTime'><Today/></Value></Geq></Where><OrderBy><FieldRef Name='EventDate' Ascending='True' /></OrderBy>"
#RowLimit property
$viewRowLimit = 30
#Paged property
$viewPaged = $true
#DefaultView property
$viewDefaultView = $false
#Create the view in the destination list
$newview = $list.Views.Add($viewTitle, $viewFields, $viewQuery, $viewRowLimit, $viewPaged, $viewDefaultView)
Write-Host ("View '" + $newview.Title + "' created in list '" + $list.Title + "' on site " + $web.Url)
$web.Dispose() 
```

# svn - 用SVN寻找网站测试架构

> ID：745063
> 
> 赞同：1
> 
> 时间：2009-04-13T19:27:09.163
> 
> 标签：svn, repository, testing, live

我们希望做两件事：

1.  建立离线网络测试平台，以及
2.  使用 SVN 实现版本控制。

我看到的帖子建议 SVN 存储库应该作为独立于测试和实时平台的数据存储存在，可能在不同的服务器上。

任何人都可以向我指出有关如何在存储库、测试和实时环境之间正确暂存代码的文章/帖子吗？

一个主要问题是保持测试和生产代码同步，因此测试只显示在测试环境中复制的实时代码的更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T19:39:05.593

SVN 存储库的实际托管实际上独立于您拥有的任何其他基础设施。通常存储库托管在内部“生产级”机器上，因为源代码是您的生命线。

使用 SVN 处理测试登台的最简单方法是**标记**您推送到测试服务器的版本。如果您对测试结果感到满意，您可以将标签推送到实时服务器而不受惩罚。而且，如果您必须对当前的实时版本进行小错误修复，您可以从标签创建一个分支并在那里提交修复，再次首先部署到测试，然后部署到实时系统。

对于更复杂的场景，您可能想要创建“测试”和“实时”分支，它们合并和/或从主干中挑选更改。这仅适用于 subversion 1.5 或更高版本，并且需要有人负责“live”从“test”和“trunk”中获得所有正确的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T19:32:31.350

在我们的办公室中，我们使用本地开发服务器，该服务器具有 Trac、SVN 和个人子域划分的开发区域。每个开发人员对每个项目都有自己的子域，每个项目都有自己的 SVN 存储库。

我们有一个“同步日”，每个人都“提交”他们的更改，每个人“更新”他们自己的目录，这意味着每个人都会获得最新版本，然后我们开始测试。

在确定一切正常后，我们将最新版本“标记”为“稳定”，并使用 lftp 将此版本与一个小 bash 脚本同步。

希望这可以帮助。

# c# - 在无需构建的情况下动态设置 Web 服务代理需要帮助吗？

> ID：745068
> 
> 赞同：2
> 
> 时间：2009-04-13T19:29:06.787
> 
> 标签：c#, visual-studio, web-services

我在生产中部署了一个 Web 应用程序，它引用了一个外部 Web 服务。查看 Visual Studio 中的源代码，我看到 Web 引用是静态链接的。在代理 reference.cs 中，它是对 url 的硬编码。this.Url = " [http://server/WebService/Service.asmx](http://server/WebService/Service.asmx) ";

我可以更改网址。但是，我希望代理从 web.config 文件中获取 url。如何在不使用 Visual Studio 将 url 行为设置为动态的情况下增强代理代码？很想在 C# 中获得一些代码示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T19:33:16.980

将行为更改为动态时，可以使用 Visual Studio 生成的相同代码：

```
public Service1() {
    string urlSetting = System.Configuration.ConfigurationSettings.AppSettings["WebApplication1.localhost.Service1"];
    if ((urlSetting != null)) {
        this.Url = string.Concat(urlSetting, "");
    }
    else {
        this.Url = "http://localhost/WebService1/Service1.asmx";
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T19:34:14.807

在项目的属性文件夹中，`Settings.settings`将 Web 服务 URL 设置添加到属性之一。

然后修改`this.Url = Properties.Settings.YourWebServiceUrlName`.

这将在您的 web.config 中创建一个配置，您可以根据每个服务器进行更改。我通常将属性设置设置为我的生产服务器设置，然后为我的本地开发环境修改 web.config。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T20:06:15.637

我认为 Web References 的在线文档总结得很好：

> 如果您将 URL 行为设置为默认值静态，则代理类会在您创建类的实例时使用硬编码的 URL 设置 URL 属性。
> 
> 如果将 Web 引用的 URL 行为设置为动态，则应用程序会在运行时从应用程序配置文件的 appSettings 元素中获取 URL。

来源：MSDN，[Visual Studio 中的 Web 参考](http://msdn.microsoft.com/en-us/library/tydxdyw9.aspx)

换句话说，是的，如果要从配置文件中设置它，则必须在 Visual Studio（或其他编辑器）中将其更改为动态。

# visual-studio - 在 virtualbox 上安装 VS2008 时出错

> ID：745071
> 
> 赞同：0
> 
> 时间：2009-04-13T19:29:42.620
> 
> 标签：visual-studio, installation, virtualization, virtualbox

这已经是第五次了，尝试了不同的机器，不同的驱动器大小，甚至尝试了Vista和XP，似乎没有任何效果。

我安装了一个virtualbox VM。设置操作系统，然后尝试设置 VS2008。

然后VS2008安装崩溃并出现以下错误日志

```
[04/13/09,14:27:31] setup.exe: [2] ISetupComponent::Pre/Post/Install() failed in ISetupManager::InternalInstallManager() with HRESULT -2147023293.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft .NET Framework 3.5 is not installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Document Explorer 2008 was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Visual Studio Web Authoring Component was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Visual Studio 2008 Professional Edition - ENU was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft .NET Compact Framework 2.0 SP2 was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft .NET Compact Framework 3.5 was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime) was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Visual Studio 2005 Tools for the 2007 Microsoft Office System Runtime was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft SQL Server Compact 3.5 was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft SQL Server Compact 3.5 Design Tools was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft SQL Server Compact 3.5 For Devices was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Windows Mobile 5.0 SDK R2 for Pocket PC was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Windows Mobile 5.0 SDK R2 for Smartphone was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Device Emulator version 3.0 was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft SQL Server 2005 Express Edition (x86) was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Crystal Reports Basic for Visual Studio 2008 was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Windows SDK for Visual Studio 2008 Tools (x86) was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Windows SDK for Visual Studio 2008 Headers and Libraries (x86) was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Windows SDK for Visual Studio 2008 Win32 Tools (x86) was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Windows SDK for Visual Studio 2008 .NET Framework Tools (x86) was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft Windows SDK for Visual Studio 2008 SDK Reference Assemblies and IntelliSense (x86) was not attempted to be installed.
[04/13/09,14:27:31] VS70pgui: [2] DepCheck indicates Microsoft SQL Publishing Wizard was not attempted to be installed 
```

我的虚拟机通常（我试过很多次）有一个 20 GB 的磁盘和 700 MB 的内存分配。其他一切都是默认的。

任何人都有任何类似的问题，或者至少可以帮助我解决发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T19:42:34.147

听起来像是 virtualbox 的问题，您可以尝试在 VPC 上安装所有内容，然后[将 vhd 转换为 vdi。](http://forums.virtualbox.org/viewtopic.php?t=1966)

# javascript - fogbugz 选择下拉菜单

> ID：745077
> 
> 赞同：2
> 
> 时间：2009-04-13T19:31:45.140
> 
> 标签：javascript

有谁知道代码fogbugz 用于样式化他们的选择？我有兴趣获得一些 Firefox 功能（当为选择设置固定选择宽度时，选项宽度显示为适合长选项值）。

看起来fogbugz仍在使用选择，但他们已经添加了一个显示当前值并保持固定宽度的输入。但是，我找不到执行所有这些操作的代码。这正是我需要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T19:38:33.800

他们正在使用一些 AJAX，它实际上不是一个选择列表，它更类似于 Google 在其首页上使用的自动完成下拉菜单。如果您正在寻找工具集，YUI、jQuery UI、ExtJS 等都有类似的功能。

# .net - 在 .NET 中为客户端应用程序创建证书

> ID：745083
> 
> 赞同：2
> 
> 时间：2009-04-13T19:32:34.047
> 
> 标签：.net, security, certificate, x509certificate2

我正在寻找一个服务器应用程序，以使用自签名根为客户端应用程序定期生成证书。.NET 中是否有任何简化的流程以编程方式生成这些证书？

当然，我可以继续生成 makecert 或 openssl，但是当您在输出时获得 X509Certificate 时，我一直在寻找更多程序化的内存方法。

如果有人有代码片段，你能分享一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T17:23:18.800

Bouncycastle.org 有一个 C# 绑定。它可以创建 X509 证书。该提供程序被 java webapps 广泛使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-10T21:31:43.127

对于在他们的产品中使用“充气城堡”有点害怕的人，请查看[CLR 安全团队在 CodePlex 的网站](http://clrsecurity.codeplex.com/)。他们在那里得到了很多好处，包括一个用于制作 x509 证书的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T19:43:54.550

早在 2004 年，我就在这方面做了一些工作，那时还没有这样的 .NET 解决方案。我们编写了一个简单地封装到 openssl 的包装器类。和你描述的差不多。

我们认为最好坚持使用众所周知的（和使用过的）解决方案，而不是尝试重新发明那个轮子！

好吧，自从我上次看这个已经有一段时间了，但我很想在这个上说“如果它没有坏就不要修复它”。

# excel - Excel 注释 - 2003 年的最大长度

> ID：745085
> 
> 赞同：4
> 
> 时间：2009-04-13T19:32:57.743
> 
> 标签：excel

有人知道 Excel 单元格 (2003) 上的评论有什么限制吗？我正在以编程方式填写此内容，并希望确保我不超过限制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T20:10:40.367

查找了 NOTES 的 BIFF 规范（实际上是单元格注释）并且本身没有限制，每个 NOTES 记录只有 2048 个，但是您可以拥有任意数量的这些，它们被标记为第一个之后的延续记录一。考虑到这一点，它似乎是无限的。

但是，为了安全起见，我将我的削减为 15,000（因为我们所做的事情永远不需要超过 1000）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T19:37:58.730

[此页面](http://office.microsoft.com/en-us/excel/HP051992911033.aspx)列出了所有 Excel 规范和限制。

不确定评论，但似乎单元格数据仅限于 32767 个字符。也不确定字符编码或是否重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T07:24:54.270

我只是尝试通过以编程方式放置大量评论来尝试一下。

我以结果结束：22877 个字符。但是我不确定字符编码是否重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T19:44:02.507

根据[“Excel 规范和限制”](http://office.microsoft.com/en-us/excel/HP051992911033.aspx)，最大字符数为 32767（单元格中仅显示 1024）。

我怀疑这是假设没有字符占用超过 2 个字节的字符...

# .net - 基于 xml 架构创建页面并从 xml 记录中添加数据

> ID：745086
> 
> 赞同：0
> 
> 时间：2009-04-13T19:32:58.353
> 
> 标签：.net, asp.net, xml

假设我有一个系统，可以在 xml 中存储一些复杂对象的数据。这些对象具有弱继承关系：可能是所有对象共有的 4 个字段，然后还有另外 20 个字段对每种类型的对象都是唯一的，比如 6 到 8 个不同类型的对象。

每个对象独有的数据本身可能很复杂：诸如枚举、其他复杂类型以及仅在条件下使用的项目。每种类型的对象都有一个 xml 模式来描述它。

该系统通过一系列步骤为每个对象建立一个记录，因此只有部分记录是很常见的。每个步骤的内容没有定义：用户可以填写他们知道的尽可能多的内容，然后将其传递给更有知识的人来完成。

我想做的是创建一个 ASP.Net 页面来显示这些记录。给定一个记录号（和类型），将该类型的模式加载到表单中，然后从记录本身填充表单。我认为记录本身不足以创建页面，因为记录可能尚未列出我想在表单中包含的每个字段，并且不会隐式包含枚举等类型的数据。

什么是完成此任务的优雅方式？我确定我错过了一些关于执行此操作的简单方法的明显内容，但 Xslt 可能不会削减它。

[这是对这个问题](https://stackoverflow.com/questions/744417/database-design-help-with-varying-schemas)的跟进，目前纯粹是假设性的。根据这里的回复，我可能会走完全不同的路。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T21:22:54.267

当您说“Xslt 可能不会削减它”时，我想知道您想到的是哪种 Xslt 方法。

一种方法是以某种方式转换表单的实例数据。（我不确定这在实践中是如何工作的，也许这就是你说 Xslt 不起作用的原因。）

另一种方法是使用 Xslt 生成针对表单数据的当前状态定制的定制的一次性模式。然后，您将使用此架构来构建表单。例如，转换后的模式将排除尚未准备好显示的字段的定义。这对我来说听起来很可行（不是我自愿:-)

**更新**（回应评论）：说实话，我对 asp.net 的了解还不够，无法说出它的缓存是否适合您的需求。我原以为您**不**想要缓存，原因我会讲到。

试图澄清我的意思：我在您的描述中听到的是，记录的当前状态可能会影响表格的结构。例如，字段 A 的合法值可能受字段 X、Y 和 Z 的值的约束，其中一些在给定时间实际上可能是未知的和不可知的；这种模棱两可可能会使使用单一、统一的结构呈现形式变得困难。

我的想法是，也许您不必将自己限制在不可变的模式中。如果数据的当前状态可以通过修改后的模式更好地表示（例如，反映字段 A 允许的枚举值，或者字段 B 当前允许的联合选择），那么我建议也许转换模式在创建表单之前可能会成功。对于您对缓存的评论，我担心由于数据和架构的更改，缓存可能会导致在需要更新的表单定义时提供陈旧的表单定义。也许您可以通过根据自定义模式的当前状态置换命名空间 URL 来避免这种情况。

我希望这有帮助。

# prolog - 河内之塔谜题（序言）

> ID：745095
> 
> 赞同：4
> 
> 时间：2009-04-13T19:36:46.020
> 
> 标签：prolog, towers-of-hanoi

每个人都知道著名的河内序言

你可以在[这里找到](http://www.csupomona.edu/~jrfisher/www/prolog_tutorial/2_3.html)

它很棒但是当我写这个查询时移动（3，左，右，中心）。

它没有显示这些结果

```
Move top disk from left to right
Move top disk from left to center
Move top disk from right to center 
Move top disk from left to right 
Move top disk from center to left 
Move top disk from center to right 
Move top disk from left to right 
```

我得到的是

```
Trace: >> RETURN: nl()
Trace: >> RETURN: hanoi(1,left,right,center)
Trace: >> RETURN: hanoi(2,center,right,left)
Trace: >> RETURN: hanoi(3,left,right,center)
True
1 Solution 
```

那么我怎样才能让它以更好的方式打印结果，并且是否可以命名磁盘，以便程序将它们命名给我，以显示结果如下“从左到右移动磁盘 A”

对不起，如果我问了很多，但上帝我喜欢 PROLOG。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T20:11:03.470

首先，您使用什么 Prolog 来获得这些结果？看起来您启用了调试器或其他东西。我强烈推荐[SWI-Prolog](http://www.swi-prolog.org/)，它给出了正确的结果。

至于命名光盘，是的，你可以做到。考虑这样的事情：

```
move([Disc],X,Y,_) :-  
    write('Move disk '),
    write(Disc),
    write(' from '), 
    write(X), 
    write(' to '), 
    write(Y), 
    nl. 
move([Bottom|Rest],Start,Swap,Goal) :- 
    move(Rest,Start,Swap,Goal), 
    move([Bottom],Start,Goal,_), 
    move(Rest,Swap,Goal,Start). 
```

当你运行时，`move([biggest,middle,smallest], left, center, right).`你会得到这样的结果：

```
Move disk smallest from left to center
Move disk middle from left to right
Move disk smallest from center to right
Move disk biggest from left to right
Move disk smallest from center to right
Move disk middle from center to left
Move disk smallest from right to left 
```

这里的诀窍是这是一个自下而上的算法。从本质上讲，它归结为：

1.  将底部磁盘顶部的所有内容移动到交换（这是递归步骤）
2.  将底部圆盘移动到目标
3.  将其他所有内容从交换移至目标

因为它是自下而上的，所以您必须给出从最底部的光盘开始的列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-04T17:23:08.383

我想编辑要经过同行评审需要很长时间，所以我会在这里发布更正。Pesto 发布的代码有一个错误。正确的版本（带有更漂亮的输出格式）如下所示：

```
move([Disc],X,_,Y) :-  
    format("Move disk ~w from ~w to ~w\n", [Disc, X, Y]).
move([Bottom|Rest],Start,Swap,Goal) :- 
    move(Rest,Start,Goal,Swap), 
    move([Bottom],Start,_,Goal),
    move(Rest,Swap,Start,Goal). 
```

在 GNU Prolog 下检查。

# iphone - 图层有什么用？添加图层可以做什么，为什么要考虑图层？

> ID：745096
> 
> 赞同：4
> 
> 时间：2009-04-13T19:37:10.073
> 
> 标签：iphone, core-animation

我想知道是什么让图层与视图不同，当每个视图都带有它自己的图层时。也许我错了。但是：这些层有什么用？

就像我理解的那样，我会使用 UIView 在我的 GUI 中对元素进行分组。我还可以使用该 UIView 将事物置于其他事物之上。那么，Layers 是从哪里来的呢？

我应该将它们视为像 HTML / CSS 中的 z-index 吗？它们只是对 Core Animation 感兴趣吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T22:15:53.530

Compared to UIVIews, CALayers are

*   lightweight
*   filled with timing information for animation
*   Some things are harder to draw, like text (esp. unicode).

If you have less than 20 or so of them, it probably doesn't matter. If you have complicated animation needs, or just a ton of layers to draw, you may benefit from using CALayers instead.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T17:04:11.000

在 iPhone 上，根据我的经验，使用 UIViews 和 CALayers 之间没有显着的性能差异。Mac 是另一回事，NSViews 的重量级要大得多。

对于复杂的动画，尤其是关键帧动画或沿路径的移动，有时需要处理 CALayers（或至少是视图的图层支持）。

此外，CALayers 可用于创建独立于平台（Mac 和 iPhone）的自定义用户界面。UIViews 与 NSViews 非常不同，但 CALayers 在 iPhone 和 Mac OS X Leopard 之间是相同的（除了 iPhone 上缺少的一些属性）。我使用 CALayers 在 iPhone 应用程序和它的 Mac 应用程序之间共享 UI 代码。

# c# - C#中简单的远程进程对象交互

> ID：745101
> 
> 赞同：0
> 
> 时间：2009-04-13T19:38:26.577
> 
> 标签：c#, .net, networking

我确信必须有一种简单的方法来做到这一点，也许我为自己做的工作比我需要的要多。我正在尝试以一种可以在对象之间进行双向通信的方式设置跨系统通信，我想它会是这样的。

```
public interface ISharedResource

public class SharedResourceHost : ISharedResource  //<- slave process

SharedResourceHost resource = new SharedResourceHost("http://192.168.1.102/HostedResources/Process1");

resource.Invoke("SomeMethod"); 
```

有这样的吗？我不想费力地设置网络服务等，但如果必须的话，我会的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T19:44:17.263

您应该检查 WCF。在这里解释太大了，但这篇文章应该给你一些指导。

[http://msdn.microsoft.com/pt-br/library/bb907581.aspx](http://msdn.microsoft.com/pt-br/library/bb907581.aspx)

WCF 允许您设置接口，其中两个对象可以使用您选择的协议进行通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T19:41:56.660

你肯定在这里重新发明轮子。查看[`System.Runtime.Remoting`](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.aspx)命名空间。我会在教程中链接，但我只需要检查[谷歌](http://www.google.com/search?q=c%23+remoting)，你就可以评估什么对你来说比我更有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T19:54:08.550

看起来您想要[Remoting](http://msdn.microsoft.com/en-us/library/kwdt6w2k(VS.80).aspx)或[WCF](http://msdn.microsoft.com/en-us/library/ms735119.aspx)。但是，在这两种情况下，您都需要确保打开了正确的端口。我不明白设置[Web 服务](http://msdn.microsoft.com/en-us/library/ms972326.aspx)有多么困难，但我只能离开你的帖子。

# silverlight - 在 Silverlight 中获取 AVI 第一帧的位图

> ID：745107
> 
> 赞同：0
> 
> 时间：2009-04-13T19:40:12.767
> 
> 标签：silverlight, video-capture

我想知道是否有办法以编程方式检索 AVI 的第一帧并获取位图图像以向用户显示预览。Silverlight 中的 MediaControl 显示 Silverlight 支持的视频文件的预览，但不显示 AVI。因为我在 Silverlight 环境中，所以不能使用非托管代码或库来执行此操作。我只能访问文件流。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T19:45:18.620

[Silverlight 论坛](http://silverlight.net/forums/t/14104.aspx)上发布了类似的问题。论坛主题包括代码示例。

您可能希望在视频中进一步选择一帧，因为前几帧可能会淡入，或者不能很好地代表视频。

根据编码，MediaPlayer 类可能无法读取您的 AVI 文件。（有关兼容的编码，请参见[此处](http://msdn.microsoft.com/en-us/library/cc189080(VS.95).aspx)）。您可能需要对视频进行转码才能使用托管代码执行此操作。除非您找到/编写自己的解码器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T23:10:18.237

Silverlight 运行时本身不支持 AVI 文件，因此您将无法将这些文件与 MediaElement 一起使用。

您需要做的实际上是手动解析 AVI 文件并从该文件中提取帧。一旦你到了解析帧的地步，它可能会变得有点棘手。

如果您计划在 Silverlight 2 上进行这项工作，您的 AVI 文件将需要包含 WMV 帧或 Silverlight 支持的图像格式（JPG 或 PNG）之一的帧。如果您使用 WMV，我将设置一个 MediaStreamSource 并将所需的视频帧传递给 MediaStreamSource 作为我的第一个示例。如果您正在使用其中一种图像格式，则应使用 Image 并将其源设置为流。您可以看到 Joe Stegman 使用它来帮助 Silverlight 2 支持非本地[图像格式](http://blogs.msdn.com/jstegman/archive/2008/10/30/updated-source-for-image-samples.aspx)的示例。

如果您在 Silverlight 3（现在处于 Beta 版）中执行此操作，则技术通常是相同的，但媒体格式支持会有所增加（除了 WMV）：H264、Raw YV12 或 Raw ARGB 帧。同样在成像方面，您现在拥有可用于绘制框架的 WriteableBitmap。

如果您的视频是 Theora、Divx、Xvid、VP6 等。您需要找到一种方法来解码该帧，以便在 Silverlight 中显示它。

# jquery - JQuery使用Json调用Controller/Action

> ID：745108
> 
> 赞同：2
> 
> 时间：2009-04-13T19:40:16.773
> 
> 标签：jquery, asp.net-mvc

我有一个搜索页面，页面顶部是带有搜索按钮的搜索条件。屏幕底部是按下搜索按钮时的结果。在这种情况下，我有 6 个用户可以输入的不同搜索条件。我想将所有标准捆绑到一个类中，以便我的 Controller 操作可以将 Json 对象作为一个类读取。使用 FireBug 我可以看到我的 Json 是正确构建的。使用调试器，我知道我的 Controller/Action 被触发了。但是，当我在 Controller/Action 中使用调试器查看类对象时，所有属性都是 null 或零。

> **控制器**

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult GetStudentByCritera(StudentSearchCriteraCV critera)
{
    // Get the Data 
    ViewData["MainData"] = studentBLLHdl.StudentFind(critera);
    return View();
} 
```

> **JavaScript/JQuery**

```
<script>
    $.ajax({
        url: "GetStudentByCritera",
        type: 'POST',
        data: dataToSend,
        dataType: 'json',
        contentType: "application/json; charset=utf-8",
        beforeSend: ClientSideValidate,
        success: function (result) {
            alert(result.Result);
            $('#SearchResult').html(result.Result).show();
            // UnBlock UI
        },
        error: function (XMLHttpRequest, textStatus, errorThrown) {
            // UnBlock UI

            // not sure how to handel error
            alert("error happen when posting to 'GetStudentByCritera'")

            // typically only one of textStatus or errorThrown
            // will have info
            this; // the options for this ajax request
        }

    });

    function BuildJson() {
        // building Json

        var dataForClass = {
            "StudentSearchCriteraCV": [{
                "StudLname": $("input[name='StudentSearchCriteraCV.StudLname']").val(),
                "StudFname": $("input[name='StudentSearchCriteraCV.StudFname']").val(),
                "Ssn": $("input[name='StudentSearchCriteraCV.Ssn']").val(),
                "StudId": $("input[name='StudentSearchCriteraCV.StudId']").val(),
                "Sex": $("input[name='StudentSearchCriteraCV.Sex']").val(),
                "Race": $("input[name='StudentSearchCriteraCV.Race']").val()
            }]
        };

        return $.toJSON(dataForClass);
    }

    function ClientSideValidate() {
        // Block the UI
        alert("In the ClientSideValidate");

        // if error UNBlock UI
        // return true if client side data is good.

        return true;
    }
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T22:14:24.050

Your ajax call is just an asynchronous HTTP post, therefore the data paramter can only be key value pairs, not a JSON object. If you flatten dataForClass it will work.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T19:58:46.370

您需要创建一个从 ActionFilterAttribute 继承的操作过滤器。看看这里[http://forums.asp.net/t/1237429.aspx](http://forums.asp.net/t/1237429.aspx)或这里[http://www.c-sharpcorner.com/Blogs/BlogDetail.aspx?BlogId=863](http://www.c-sharpcorner.com/Blogs/BlogDetail.aspx?BlogId=863)有关如何构建这个的更多详细信息.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T20:25:40.770

我相信你的 JSON 值需要用引号引起来，除非它是一个数字。

```
"StudFname": '"' + $("input[name='StudentSearchCriteraCV.StudFname']").val() + '"', 
```

我没有使用 .toJSON()，但我相信它会将您的 JSON 对象转换为字符串。既然您创建对象只是为了立即将其转换为字符串，那么为什么不首先将其创建为字符串呢？这就是我遇到这个问题时所做的（调试器显示值为零。）

```
var dataForClass = '{ "StudentSearchCriteraCV" : [{ ' +
        '"StudLname": "' + $("input[name='StudentSearchCriteraCV.StudLname']").val() + '", ' +
        '"StudFname": "' + $("input[name='StudentSearchCriteraCV.StudFname']").val() + '", ' +
        '"Ssn": "' + $("input[name='StudentSearchCriteraCV.Ssn']").val() + '", ' +
        '"StudId": ' + $("input[name='StudentSearchCriteraCV.StudId']").val() + ', ' + //assuming StudID is a number
        '"Sex": "' + $("input[name='StudentSearchCriteraCV.Sex']").val() + '", ' +
        '"Race": "' + $("input[name='StudentSearchCriteraCV.Race']").val() +'" ' +
        '}]}'; 
```

# javascript - 使用带有 HTML 图像映射的 JQuery 悬停

> ID：745110
> 
> 赞同：65
> 
> 时间：2009-04-13T19:40:43.077
> 
> 标签：javascript, jquery, hover, imagemap

我有一个复杂的背景图像，其中包含许多需要翻转插图突出显示的小区域，以及每个区域的附加文本显示和相关链接。最终插图使用 z-index 堆叠了几个具有透明度的静态图像，并且高光翻转插图需要显示在中间的“三明治”层之一中才能达到预期的效果。

在对块进行了一些不成功的操作后，我决定可以使用老式的图像映射来完成。我制作了一个带有四个几何形状轮廓的示意性测试地图，并使用 png 翻转“填充”它们。这个想法是将图像映射与底部背景层相关联，使用 css {visibility: hidden} 初始化所有翻转，并使用 Jquery 的悬停方法使它们可见，并在单独的 div 中显示关联的文本。单独的文本函数是我不尝试使用 :hover 伪类而不是 jQuery 悬停的原因。因为我使用的是图像贴图，所以我将所有翻转 png（具有透明背景）的大小调整为完整容器的大小，以便精确放置，以便所有内容都精确排列。

我得到的作品......不是真的！正确映射图像映射以仅激活几何区域。但是每个翻转区域的 href 只能间歇性地工作，并且使用带有 css 可见性的 Jquery 悬停是一团糟。期望的行为是滚入该区域只会使形状变得坚固。实际发生的是形状内部的任何运动都会在可见和隐藏之间快速切换；当光标停在形状内时，它可能可见，也可能不可见。任何想法表示赞赏！

悬停设置示例（我最终将使用数组来实现真正的悬停、关联的链接和文本）：

```
$('#triangle').hover(
    function() {
        $('#ID_triangle').css({'visibility' : 'visible'});
    },
    function() {
        $('#ID_triangle').css({'visibility' : 'hidden'});
    }
) 
```

图片地图：

```
<div id="container">
    <img src="images/testMap_w.png" width="800" height="220" alt="TestMap W" usemap="#testMap">
    <map name="testMap">
        <area shape="polygon" coords="20,20,106,20,106,106,20,106" href="http://www.stackoverflow.com" id="box" />
        <area shape="polygon" coords="216,50,339,50,277,156" href="http://www.google.com" id="triangle" />
        <area shape="polygon" coords="460,0,574,0,460,220" href="http://www.cnn.com" id="bordertriangle" />
        <area shape="polygon" coords="704,65,769,115,744,196,665,196,640,115" href="http://slashdot.org" id="pentagon" />
    </map>
    <img src="images/testMap_box.png" width="800" height="220" alt="TestMap Box" id="ID_box">
    <img src="images/testMap_triangle.png" width="800" height="220" alt="TestMap Triangle" id="ID_triangle">
    <img src="images/testMap_border_triangle.png" width="800" height="220" alt="TestMap Border Triangle" id="ID_bordertriangle">
    <img src="images/testMap_pentagon.png" width="800" height="220" alt="TestMap Pentagon" id="ID_pentagon">
</div> 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-04-13T20:07:26.053

你应该看看这个插件：

[https://github.com/kemayo/maphilight](https://github.com/kemayo/maphilight)

和演示：

[http://davidlynch.org/js/maphilight/docs/demo_usa.html](http://davidlynch.org/js/maphilight/docs/demo_usa.html)

如果有的话，您也许可以从中借用一些代码来修复您的代码。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2011-07-14T15:24:52.273

这个问题很老，但我想为当时不存在的已接受答案添加一个替代方案。

[Image Mapster](http://www.outsharked.com/imagemapster/)是一个 jQuery 插件，我编写它是为了解决 Map Hilight 的一些缺点（它最初是该插件的扩展，尽管后来几乎被完全重写）。最初，这只是维持区域选择状态、修复浏览器兼容性问题的能力。不过，自几个月前首次发布以来，我添加了许多功能，包括使用备用图像作为高光来源的能力。

它还能够将区域识别为“蒙版”，这意味着您可以创建带有“孔”的区域，另外还可以创建复杂的区域分组。例如，区域 A 可能会导致另一个区域 B 被突出显示，但区域 B 本身不会响应鼠标事件。

网站上有几个例子展示了大部分功能。[github 存储库](https://github.com/jamietre/ImageMapster)也有更多示例和完整文档。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-29T15:18:08.537

我发现了我过去使用过的这个很棒的映射脚本 ( [mapper.js )。](http://www.netzgesta.de/mapper/)它的不同之处在于您可以将鼠标悬停在地图或页面上的链接上以突出显示地图区域。遗憾的是，它是用 javascript 编写的，需要在 HTML 中进行大量内联编码 - 我希望看到这个脚本移植到 jQuery 中：P

另外，请查看所有演示！我认为[这个例子](http://www.netzgesta.de/mapper/example.html)几乎可以做成一个简单的在线游戏（不使用闪光灯）——确保你点击不同的摄像机角度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-15T22:46:06.123

尽管 jQuery Maphilight 插件可以完成这项工作，但它依赖于 html 中过时的详细图像映射。我更愿意将地图坐标保持在外部。这可能是带有 jquery imagemap 插件的 JS，但它缺少悬停状态。一个不错的解决方案是在 Flash 和 JS 中使用谷歌地理地图可视化。但是，这种矢量数据的开源未来是 svg，考虑到所有现代浏览器都支持 svg，以及谷歌 svgweb 用于 IE 的 Flash 转换，为什么不使用 jquery 插件将链接和悬停状态添加到 svg 地图，如 JS 演示[在这里](http://www.carto.net/svg/samples/mouse_over_effects.shtml)？这样，您还可以避免将矢量地图转换为图像地图坐标的复杂步骤。

# html - 我可以在 SSRS 2005 中从 SQL 数据库呈现 HTML 吗？

> ID：745113
> 
> 赞同：7
> 
> 时间：2009-04-13T19:42:29.517
> 
> 标签：html, reporting-services, rendering, reportingservices-2005

我在 MS SQL DB 中有 html。我想在 SSRS 页面上呈现 html，这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T19:55:10.030

由于“安全原因”，这种功能在 SQL 2005 Reporting Services 中被故意禁用。我相信当时的建议是将任何 html 记录为图像并将图像嵌入到报告中。我决定一起放弃报告服务。对不起！

如果您使用的是[SQL 2008](http://msdn.microsoft.com/en-us/library/cc645967.aspx)，您可以在报告中使用一些 HTML。但是，可以使用的标记有一些限制：

> 以下是定义为占位符文本时将呈现为 HTML 的标记的完整列表：
> 
> ```
> * Hyperlinks: <A href>
> * Fonts: <FONT>
> * Header, style and block elements: <H{n}>, <DIV>, <SPAN>,<P>,
>           <DIV>, <LI>, <HN>
> * Text format: <B>, <I>, <U>, <S>
> * List handling: <OL>, <UL>, <LI> 
> ```
> 
> 报告处理期间将忽略任何其他 HTML 标记

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T19:45:14.390

我不相信。从 SSRS 报告创建的输出不是 HTML 文档，我从未能够让 html 输出在报告中正确呈现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T19:45:31.597

我不知道有什么简单的方法可以做到这一点，您可能必须编写自己的自定义控件才能做到这一点。

# php - 反向代理 PHP

> ID：745115
> 
> 赞同：0
> 
> 时间：2009-04-13T19:43:33.350
> 
> 标签：php, proxy, reverse

我想开发允许人们登录并支付账单的软件。该软件必须连接到托管在客户端（可能是许多客户端）的服务器并检索一些信息。问题是我想让它在任何情况下都能正常工作。类似于 goto my pc 之类的家用远程控制软件。我不能保证客户端的设置只有他们有一个基于 Windows 的服务器和互联网连接。我想安装一个软件并让它连接到服务器并等待信息。我真的很想使用最简单的软件，例如 PHP。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T22:29:33.390

> I want to develop software that will allow people to log in and pay a bill.

That is a requirement. That is fine.

> The software will have to connect to a server hosted at a client (could be many clients) and retrieve some information.

That is a specific technical solution to the above requirement. And not a very good one I might add.

So. Do you want to know how best to solve your requirement, or do you want a technical explanation about how you could implement your (totally misguided) proposed solution?

# java - Struts 上传速度慢

> ID：745122
> 
> 赞同：2
> 
> 时间：2009-04-13T19:45:31.020
> 
> 标签：java, struts

我有一个 Struts 1 Web 应用程序，它需要将相当大的文件（>50 MB）从客户端上传到服务器。我目前正在使用其内置的 org.apache.struts.upload.DiskMultipartRequestHandler 来处理 HTTP POST multipart/form-data 请求。它工作正常，但速度也非常慢，上传速度约为每秒 100 KB。

将相同的大文件从服务器下载到客户端的速度要快 10 倍以上。我不认为这只是我的 ISP 的上传和下载速度之间的差异，因为使用简单的 FTP 客户端将文件传输到同一台服务器所需的时间不到 1/3。

我已经研究过用更新的 org.apache.commons.fileupload 包替换内置的 DiskMultipartRequestHandler，但我不确定如何修改它来创建 Struts 1 需要的 MultipartRequestHandler。

Barend 在下面评论说，可以在 web.xml 中设置一个“bufferSize”参数。我将缓冲区的大小增加到 100 KB，但并没有提高性能。查看 DiskMultipartRequestHandler 的实现，我怀疑它的性能*可能*会受到限制，因为它一次读取一个字节的流以查找多部分边界字符。

有其他人使用 Struts 上传大文件吗？

是否有人定制了 Struts 1 提供的默认 DiskMultipartRequestHandler？

上传大文件时我是否需要更加耐心？:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T22:00:34.817

[Apache wiki 上的StrutsFileUpload](http://wiki.apache.org/struts/StrutsFileUpload)页面包含一系列您可以使用的配置设置。对我来说最突出的是 4096 字节的默认缓冲区大小。如果您还没有，请尝试将其设置为更大的值（但不要太大，因为每次上传都会分配缓冲区）。2MB 的值似乎是合理的。我怀疑这会大大提高上传速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T09:48:43.160

使用 Apache Commons，这为上传文件提供了更大的灵活性。我们可以配置上传文件大小（最大文件大小）和用于交换文件的临时文件位置（这可以提高性能）。请访问此链接 [http://commons.apache.org/fileupload/using.html](http://commons.apache.org/fileupload/using.html)

# php - 发送匿名电子邮件（如 craigslist）的最佳方式

> ID：745124
> 
> 赞同：11
> 
> 时间：2009-04-13T19:45:53.750
> 
> 标签：php, email, anonymous

Craigslist 有一个很好的功能，当您回复海报时，您会回复电子邮件，例如 *job-fepsd-1120347193@craigslist.org*。然后，电子邮件又被定向到真正的电子邮件。

我正在寻找一些关于如何使用 PHP 执行此操作的指示。

谢谢，
列维

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T19:49:02.230

这通常通过将电子邮件地址（通常是包罗万象的地址）传送到 PHP 来完成。[这是一个关于这样做的教程，它](http://evolt.org/incoming_mail_and_php)应该让你朝着正确的方向开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T19:50:29.947

最可能的解决方案是执行他们所谓的**电子邮件管道**。

他们插入带有如下标识符的广告：

```
*job-fepsd-1120347193* 
```

与真正的电子邮件一起。

然后他们通过管道将电子邮件发送到 PHP 脚本来接收电子邮件。您可以查看 Google for PHP and Piping，在那里您可以找到有关该主题的良好资源。

然后，该脚本会搜索此唯一标识符并将其与真实电子邮件相关联。
然后它将收到的电子邮件转发给真人。

还有另一种可能的解决方案（但不太可能），他们可能正在使用 POP3。
然后他们会每隔**X**分钟检查一个全面的地址，然后将消息转发给正确的人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-09T17:37:48.757

Elastic Email 有一个简单的 API，用于创建双向匿名电子邮件路由，就像 craigslist 或 airbnb 一样。它使用入站电子邮件 api 调用服务器上的 web-hook 以解析正确的电子邮件地址，然后相应地中继电子邮件。它只需要几行代码。他们在这里有详细的教程：

[https://elasticemail.com/blog/marketing_tips/how-to-build-an-anonymized-email-relaying-feature-using-elastic-email/](https://elasticemail.com/blog/marketing_tips/how-to-build-an-anonymized-email-relaying-feature-using-elastic-email/)

# sql-server-2005 - 在 SQL Server 2005 中确定最佳日志大小

> ID：745125
> 
> 赞同：1
> 
> 时间：2009-04-13T19:45:56.293
> 
> 标签：sql-server-2005, logging

我的数据库上有一个日志文件，其大小为 303 MB，%used 为 3.19。

我很确定交易量仅限于几张桌子。每晚备份数据库和日志。

如何评估我的日志以确定：

*   我是否可以缩小分配的空间，从而缩小日志
*   我的日志每天/每周增长多少？

在运行事务日志和完整数据库备份之前是否检查日志空间？

有没有办法在这些作业运行之前/之后每晚在表格中记录日志大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T23:49:19.907

赶紧跑

> dbcc sqlperf（日志空间）

在备份之前，但不要过小日志，允许增长，以及异常繁忙的日子或活动。如果您有足够的空间，为日志文件配置自动增长不会有什么坏处，但您不希望它每天都增长，否则您将遭受磁盘文件碎片的影响。日志大小没有经验法则，它完全取决于事务量。

如果要捕获输出，请构建一个表来保存结果：

> 创建表日志空间（名称 varchar(64)、大小浮点数、使用的浮点数、状态 int）

..然后运行这个：

> 插入#d exec('dbcc sqlperf(logspace)')

如果您想随时间跟踪它，您可以通过几种不同的方式向文件添加时间戳。我会在备份之前运行它。

# ruby - Ruby Noobie：如何在 FFI 结构中设置字符串值

> ID：745127
> 
> 赞同：2
> 
> 时间：2009-04-13T19:46:16.900
> 
> 标签：ruby, ffi

我在 Ruby 中设置 FFI 结构时遇到了一些初学者问题。我想要做的是通过在 FFI::Struct 对象中设置字符串属性来传递指向 C 字符串的指针：

```
class SpSessionConfig < FFI::Struct
  layout :api_version,          :int,
           :cache_location,       :string,
           :settings_location,    :string,
           :application_key,      :pointer,
           :application_key_size, :int,
           :user_agent,           :string,
           :sp_session_callbacks, :pointer,
           :user_data,            :pointer 
  end
end

sessionConf = SpotifyLibrary::SpSessionConfig.new() 
puts sessionConf # => '#<SpotifyLibrary::SpSessionConfig:0x9acc00c>'

sessionConf[:api_version] = 1
puts "Api Version: #{sessionConf[:api_version]}"

myTempDir = "tmp"
sessionConf[:cache_location] = myTempDir # !Error! 
```

但是当我运行代码时，我得到了这个错误：

```
jukebox.rb:44:in `[]=': Cannot set :string fields (ArgumentError)
from jukebox.rb:44:in `<main>' 
```

所以我真的不知道从这里去哪里。

此外，如果您知道有关此主题的任何好的文档或教程，请留下回复！到目前为止，我发现关于[Project Kenai](http://kenai.com/projects/ruby-ffi/pages/Home)的 wiki 文档 非常有用，但越多越好！

谢谢！

我试图将字符串数据成员声明为 [:char, 5] 但这给出了另一个错误：

```
jukebox.rb:44:in `put': put not supported for FFI::StructLayoutBuilder::ArrayField_Signed8_3 (ArgumentError)
    from jukebox.rb:44:in `[]='
    from jukebox.rb:44:in `<main> 
```

有一个很好的建议来尝试内存指针类型，我会在今天下班后尝试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T16:13:39.523

因此，感谢 Pesto 的回答（已接受），我找到了解决方案。如果缓冲区中有零字节（遵循 c-string 语义），write_string 会提前返回。这是将来可能偶然发现此问题的任何人的代码。

```
# Open my application key file and store it in a byte array
appkeyfile = File.read("spotify_appkey.key")

# get the number of bytes in the key
bytecount = appkeyfile.unpack("C*").size

# create a pointer to memory and write the file to it
appkeypointer = FFI::MemoryPointer.new(:char, bytecount)
appkeypointer.put_bytes(0, appkeyfile, 0, bytecount) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T21:03:55.747

FFI 自动拒绝设置字符串。尝试将其从 :string 更改为 :char_array，如[本页](http://kenai.com/projects/ruby-ffi/pages/Types)所述：

> :char_array - 仅用于结构布局中，其中结构具有 C 样式字符串 (char []) 作为成员

如果这不起作用，您将不得不使用 :pointer 并将其转换回字符串。它没有很好的文档记录，但是 MemoryPointer 有[一堆可用的函数](http://kenai.com/projects/ruby-ffi/sources/mercurial/content/lib/ffi/pointer.rb?rev=480)，比如`write_string`，应该会有所帮助。

# flash - Flash - 动态加载影片剪辑的滚动区域

> ID：745133
> 
> 赞同：1
> 
> 时间：2009-04-13T19:48:52.463
> 
> 标签：flash, actionscript-3, scrollbars

我正在构建一个 Flash 项目，该项目创建一个菜单系统，其中包含为菜单项本身动态加载的影片剪辑。

一旦菜单有足够的项目大于菜单区域，我希望出现一个滚动条。

我在想我可以在菜单区域上放置一个遮罩，然后让加载的控件在遮罩内上下滚动的影片剪辑，但动态加载的影片剪辑似乎没有出现在遮罩中。

我已经在互联网上搜索了这个，但我能找到的所有滚动条教程都处理文本区域，而不是动态加载的影片剪辑区域。

有没有人知道一个很好的教程或者有一个关于这样做的优雅方式的建议，所以我不必做一堆数学黑客来让它工作？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T22:18:43.167

Not sure exactly what you are after.

I just did a quick test with Flash CS3/AS3 and got loaded items to move around inside a mask (the base of a scroll box).

First I created a Mask layer then a new layer as a child of the mask. I added a new empty MovieClip to the Mask layer child. I named this MovieClip 'mcItems'.

I then attached the following frame script (of course using a Class would be preferable).

```
 for (var i:Number=0; i < 3; ++i)
    {
        var loader:Loader = new Loader();
        loader.load(new URLRequest('Content.swf'));
        mcItems.addChild(loader);
        loader.x = i * 120;
    };
    function update (event:Event)
    {
        mcItems.x = 120*Math.sin(getTimer()/500) - 60;
    };
    addEventListener(Event.ENTER_FRAME, update); 
```

Now, Content.swf is just a 120x120 pixel gray box. My mask is 240x120\. Upon execution the 3 Content.swf boxes are loaded and slide around inside the masked area as expected.

As for the scrollbar code, I am not sure what you mean by 'math hacks' but the basic principal is you are converting from one set of units to another. You are converting your "mask width / total items loaded with" units to your "scroll handle width / scroll bar width" units.

I recommend reviewing the appropriate manual pages for clarification of the code used above.

Regards, Jotham.

# design-by-contract - 契约式设计的最佳实践是什么？

> ID：745136
> 
> 赞同：9
> 
> 时间：2009-04-13T19:49:25.693
> 
> 标签：design-by-contract

契约式设计编程的最佳实践是什么。

在大学时，我通过合同范式学习设计（在 OO 环境中）我们已经学习了三种解决问题的方法：

1）总编程：涵盖所有可能的例外情况（参见数学）

2）名义规划：只有在满足前提条件时才“承诺”正确的效果。（否则效果未定义）

3）防御性编程：使用异常来表示方法的非法调用

现在，我们已经专注于不同的 OO 场景在每种情况下的正确使用，但我们还没有学会何时使用 WHICH……（主要是练习强制执行的策略……）

现在我觉得我没有问过我的老师很奇怪（但话说回来，在上课时，没有人问过）

就个人而言，我现在从不使用名义，并且倾向于用异常替换前置条件（所以我宁愿使用 : throws IllegalDivisionByZero，而不是说明'前置条件：除法器应该不同于零）并且只编程有意义的总和（所以我不会返回除以零的常规值），但这种方法只是基于个人的发现和喜欢。

所以我问你们：

有没有最好的做法？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-19T22:35:19.840

我不知道这个部门，它并不能真正反映我的经验。

**完全编程**几乎是不可能的。您不能保证涵盖所有例外情况。所以基本上你应该限制你的范围并拒绝超出范围的情况（这是*Pre-conditions*的作用）

**不需要**名义编程。**应禁止未定义的效果。**

 ****防御性编程**是必须的。您应该始终表示非法调用方法。

我赞成实施完整的按合同设计元素，在我看来，这是*全面编程的实用且实惠的版本*

**表示方法非法调用的**前提条件**（一种*防御性编程）。*尽量限制您的范围，以便您可以简化代码。如果可能，通过缩小范围来避免复杂的实现。**

 ****如果未获得所需效果，则引发错误的**后置条件。**即使是你的错，你也应该通知来电者你错过了目标。**

 ****检查对象一致性是否保留的**不变量。****

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T20:11:35.357

这一切都归结为您希望分配给客户和合同实施者的责任。

在防御性编程中，您强制实施者检查错误情况，这在某些情况下可能代价高昂甚至是不可能的。想象一下由 binarySearch 指定的合约，例如您的输入数组必须进行排序。您在运行算法时无法检测到这一点。您必须对其进行手动检查，这实际上会将执行时间提高一个数量级。支持我的观点是[javadocs](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#binarySearch(byte[],%20byte))中方法的签名。

另一点是人们和框架现在倾向于实现异常翻译机制，主要用于将检查的异常（防御风格）翻译为运行时异常，如果发生错误，就会弹出。这样，合同的客户和实施者在彼此打交道时就不必担心了。

同样，这是我的个人观点，仅以我有限的经验为依据，我很想听到更多关于这个主题的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T20:22:34.613

> ...但我们还没有学会何时使用 WHICH...

我认为最好的做法是“尽可能防御”。如果可以，请进行运行时检查。正如@MahdeTo 有时提到的那样，出于性能原因这是不可能的；在这种情况下，依赖于未定义或不令人满意的行为。

也就是说，在您的文档中明确说明哪些有运行时检查，哪些没有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T12:53:40.510

像许多计算一样，“它取决于”可能是最好的答案。

通过明确记录功能的条件，合同设计/合同编程可以极大地帮助开发。仅文档就可以提供帮助，甚至无需将其制成（编译）代码。

在可行的情况下，我建议采取防御措施——检查每一个条件。但仅用于开发和调试版本。通过这种方式，当条件被破坏时，大多数无效假设都会被捕获。一个好的构建系统将允许您在模块或文件级别以及全局上打开和关闭不同的条件类型。

然后，在软件的发布版本中采取的行动取决于系统以及触发条件的方式（通常区分外部接口和内部接口）。发布版本可能是“完全编程”——所有条件都会给出定义的结果（可能包括错误或 NaN）

对我来说，“名义编程”在现实世界中是一条死胡同。你假设如果你传递了正确的值（当然你做了），那么你收到的值是好的。如果你的假设是错误的——你就会崩溃。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-18T19:23:53.010

我认为测试驱动编程就是答案。在实际实现模块之前，您首先创建一个单元测试（称之为合同）。然后逐步实现该功能并确保合同在您进行时仍然有效。通常我从简单的存根和模型开始，然后逐渐填充其余部分，用真实的东西代替刺。不断改进，让测试更强大。最后，您最终获得了所述模块的强大实现，并且您拥有了一个出色的测试平台——合约的编码实现。后来，如果有人修改了模块，首先你看看它是否仍然适合测试台。如果没有，则合同已失效 - 拒绝更改。或者，合同已过时， - 修复单元测试。等等..无聊的软件开发周期:)

# visual-studio-2008 - 如何更改 Visual Studio 2008 中菜单的大小？

> ID：745137
> 
> 赞同：1
> 
> 时间：2009-04-13T19:49:35.707
> 
> 标签：visual-studio-2008, windows-xp

这是最奇怪的事情：由于某种原因，当我在 XP 中运行 VS 2008 时，我使用“高级外观设置”控制面板来更改所有应用程序中菜单项的大小，Visual Studio 2008 不受更改的影响. （即控制面板-> 显示-> 外观选项卡-> 高级-> 从项目下拉菜单中选择“菜单”，然后更改字体大小）其他人注意到了吗？有人知道修复吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T15:18:46.150

我不确定为什么*高级外观设置*中的设置不会影响 VS2008，但是您可以从 VS2008 中更改菜单项设置（以及更多）。

在 VS2008 中，转到*Tools -> Options -> Environment -> Fonts and Colors*。

在*Show settings for:*下拉列表中，选择*Environment Font*。在此处进行您认为合适的更改。

在此处了解有关自定义 Visual Studio 开发环境的更多信息... [http://msdn.microsoft.com/en-us/library/hthab0h8.aspx](http://msdn.microsoft.com/en-us/library/hthab0h8.aspx)

# perl - 如何使用 CAM::PDF 在 PDF 页面中获取文本字符串的文本方向？

> ID：745138
> 
> 赞同：4
> 
> 时间：2009-04-13T19:50:07.843
> 
> 标签：perl, pdf

我正在使用 CAM::PDF，我想了解如何获取文本字符串的方向。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T05:38:05.683

一些相关的问题：[如何获取 PDF 页面的页面方向？](https://stackoverflow.com/questions/662602/how-can-i-get-the-page-orientation-of-a-pdf-page)以及[如何从 pdf 文档中获取字符偏移信息？](https://stackoverflow.com/questions/196788/how-do-i-get-character-offset-information-from-a-pdf-document)

从后一个问题的解决方案开始，我想出了这个食谱：

```
use CAM::PDF;
my $pdf = CAM::PDF->new('my.pdf') or die $CAM::PDF::errstr;
for my $pagenum (1 .. $pdf->numPages) {
   my $pagetree = $pdf->getPageContentTree($pagenum) or next;
   my @text = $pagetree->traverse('MyRenderer')->getTextBlocks;
   for my $textblock (@text) {
      print "text '$textblock->{str}' at ",
      "($textblock->{left},$textblock->{bottom}), angle $textblock->{angle}\n";
   }
}

package MyRenderer;
use base 'CAM::PDF::GS';

sub new {
   my ($pkg, @args) = @_;
   my $self = $pkg->SUPER::new(@args);
   $self->{refs}->{text} = [];
   return $self;
}
sub getTextBlocks {
   my ($self) = @_;
   return @{$self->{refs}->{text}};
}
sub renderText {
   my ($self, $string, $width) = @_;
   my ($x, $y) = $self->textToDevice(0,0);
   my ($x1, $y1) = $self->textToDevice(1,0);
   push @{$self->{refs}->{text}}, {
      str => $string,
      left => $x,
      bottom => $y,
      angle => atan2($y1-$y, $x1-$x),
   };
   return;
} 
```

这为 PDFReference15_v5.pdf 的第 565 页产生了这个结果：

```
text 'ab' at (371.324,583.7249), angle -1.5707963267949
text 'c' at (371.324,576.63365), angle -1.5707963267949 
```

请注意，角度以弧度为单位。除以 Pi 并乘以 180 以将其转换为度数。所以，-1.5707963267949 是 270 度，与第 565 页一致。

请注意，打印的角度是相对于页面内容的角度。如果页面本身被进一步旋转（根据上面的页面方向问题），那么您可能需要复合旋转计算。

# c# - 寻求允许自定义排序方法的类

> ID：745144
> 
> 赞同：1
> 
> 时间：2009-04-13T19:52:25.590
> 
> 标签：c#, .net, sorting, .net-2.0

我写了一个小应用程序，它允许我比较两个数据库模式以检查结构上的差异。它一直到列详细信息，这很好。当我比较非常小的数据库时，我没有遇到任何问题，但是当我开始将数据库与数百个表进行比较时，向上和向下滚动以查找错误所在是很烦人的。最初，我使用 KeyedCollection 来保存表的列表，但由于它不允许任何类型的排序，因此我已更改为 SortedList。SortedList 确实对索引进行了排序，这给了我按字母顺序排列的表格，但这比我需要的要少。我需要的是一个类，它允许我根据对象属性进行排序，而不仅仅是索引值。为了易于使用，我想将有错误的表推到列表的开头。

EDIT1： List 类没有索引，这对我的类来说很重要。我尝试使用 Dictionary，它确实有一个索引，但没有排序方法。实现 IComparer 不起作用，因为构造函数只接受索引类型的 IComparer。而且由于 IComparer 是另一个无法访问我的列表类的内部值列表的类，因此我无法根据对象属性进行比较。

EDIT2：我需要一个按对象属性而不是按索引值对索引进行排序的类，但我开始相信这样的类不存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T19:58:50.973

然后您需要创建一个类来**实现**：*System.Collections.Generic.IComparer*，然后您可以将所有对象放入支持基于 IComparer 排序的集合中，例如：

System.Collections.Generic.List 将允许您根据自己的实现进行排序。

这是一个很好的示例的[链接](http://www.java2s.com/Tutorial/CSharp/0380__Generic/UsegenericIComparerT.htm)，可以帮助您理解这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T19:57:16.797

[使用此](http://msdn.microsoft.com/en-us/library/e7a8xew6.aspx)重载的构造函数和您实现的自定义[IComparer](http://msdn.microsoft.com/en-us/library/system.collections.icomparer.aspx)类来构造SortedList ，以按您希望的方式进行排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T00:01:00.643

如果您要做的只是创建自己的排序，那么这可能是最简单的：

```
List<Foo> myFoos = new List<Foo>();
//--Write code to fill the list

//sort by ID
myFoos.Sort(delegate(Foo foo1, Foo foo2)
{
    return foo1.ID.CompareTo(foo2.ID);
});

//Sort by Last Name
myFoos.Sort(delegate(Foo foo1, Foo foo2)
{
    return foo1.LastName.CompareTo(foo2.LastName);
}); 
```

如果您不想使用匿名方法并希望在多个地方进行相同类型的排序，您也可以这样做：

```
public class FooIDCompare : IComparer<Foo>
    {
        #region IComparer<foo> Members

        public int Compare(Foo x, Foo y)
        {
            return x.ID.CompareTo(y.ID);
        }

        #endregion
    }

FooIDCompare idCompare = new FooIDCompare();
myFoos.Sort(idCompare); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T23:50:10.360

没有简单的方法可以做到这一点。也许甚至不是一个艰难的方式。因为它是用来做输出的，所以我决定做多个部分输出的循环来达到我想要的结果。

# sql - sql插入和更新问题..一个语句中的多个查询

> ID：745145
> 
> 赞同：2
> 
> 时间：2009-04-13T19:52:32.830
> 
> 标签：sql, mysql

我有一个名为拍卖的表，其中包含各种列，例如用户名、拍卖 ID（主键）、名字、姓氏、位置等，以及一个类别列。默认情况下，类别列是空白的，除非它是由用户为特定记录填写的。

我创建了一个新的用户表，其中包含用户名和类别列，以及将由用户输入完成的附加字段。

我想知道在更新拍卖表中的记录以具有类别时是否有可能将该记录中的用户名和类别插入用户表中，只要用户名尚未出现在表中。

例如，如果我有以下表格：

```
auctions

auctionid   username    firstname   lastname    category
------------------------------------------------------------------------
1       zerocool    john        henry       
2       fredflint   fred        smith       
3       azazal      mike        cutter 
```

然后，在更新第二条记录以具有如下类别时：

```
2       fredflintsoner  fred        smith       shoes 
```

生成的用户表应该是：

```
users

username    shoes   pants   belts   misc1   misc2
--------------------------------------------------
fredflint   true 
```

以前没有记录。

如果拍卖表中存在具有相同用户名的其他拍卖，例如：

```
7       fredflint   fred        smith   belts 
```

然后，即使将此拍卖添加到类别中，也不应为 users 表插入新记录，因为用户名已经是 ，但应根据需要对其进行更新，从而导致：

```
username    shoes   pants   belts   misc1   misc2
--------------------------------------------------
fredflint   true        true 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T19:56:26.080

您要查找的内容称为[`TRIGGER`](http://dev.mysql.com/doc/refman/5.0/en/trigger-syntax.html). 您可以在拍卖表中的每次插入/更新后指定要运行的内容，然后确定对用户表执行的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T20:14:16.710

我想到了几个问题。首先是，您的用户表看起来是非规范化的。添加新类别时会发生什么？考虑以下形式的用户表：

```
id username category 
```

如果用户有多个类别，则您有多个行：

```
1 fredflint shoes
2 fredflint pants
.... 
```

我的第二个问题是，你为什么需要一个用户表？看起来用户表中的所有信息都已经存储在拍卖表中了！您可以简单地通过以下方式检索用户表：

```
select distinct username, category
from auctions 
```

如果您需要单独的表格，可以选择在创建新拍卖时手动更新表格。我会这样做（我对触发器的了解足以避免它们）：

1 - 确保该用户有一行

```
 if not exists (select * from users where username = 'fredflint')
       insert into users (username) values ('fredflint') 
```

2 - 确保他的鞋子类别

```
 if not exists (select * from users where username = 'fredflint' and shoes = 1)
       update users set shoes = 1 where username = 'fredflint' 
```

# c - memcpy/memset 等可以处理的最大缓冲区大小是多少？

> ID：745152
> 
> 赞同：7
> 
> 时间：2009-04-13T19:56:50.150
> 
> 标签：c

[memcpy 和其他函数](http://en.wikipedia.org/wiki/Memcpy#Functions)可以处理的最大缓冲区大小是多少？这个实现是否依赖？这是否受到作为参数传入的 size(size_t) 的限制？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-13T19:58:25.437

这完全取决于实现。

这不仅取决于硬件，还取决于编译器的年龄。对于任何拥有相当现代的编译器的人（意味着任何基于 90 年代早期或之后的标准的东西），大小参数是`size_t`. 这可以合理地是最大的 16 位无符号、最大的 32 位无符号或最大的 64 位无符号，具体取决于编译器编译到的内存模型。在这种情况下，您只需要找出`size_t`在您的实现中 a 的大小。然而，对于**非常**古老的编译器（即在 ANSI-C 之前，[也许对于 ANSI C 的一些早期版本](http://www.csse.uwa.edu.au/programming/ansic-library.html#string)），所有的赌注都没有了。

在标准方面，例如 cygwin 和 Solaris 7，size 参数是`size_t`. 查看我可用的嵌入式系统，大小参数是一个`unsigned`（意思是 16 位无符号）。（这个嵌入式系统的编译器是在 80 年代编写的。）我找到了一些 ANSI C 的 Web 引用，[其中大小参数是`int`](http://www.csse.uwa.edu.au/programming/ansic-library.html#string).

您可能希望看到[这篇文章](http://www.embedded.com/columns/programmingpointers/200900195)`size_t`以及关于一些早期 GCC 版本错误签名的[后续文章。](http://www.embedded.com/columns/programmingpointers/201803576)`size_t`

综上所述，对于*几乎所有人*来说，`size_t`都会是正确的参考使用。但是，对于那些使用嵌入式系统或带有非常旧编译器的遗留系统的少数人，您需要检查您的手册页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T20:21:37.673

函数通常使用 a`size_t`将大小作为参数传递。我说通常是因为`fgets()`使用了一个`int`参数，在我看来这是 C 标准中的一个缺陷。

`size_t`被定义为可以包含您可以访问的任何对象的大小（以字节为单位）的类型。通常它是`unsigned int`or的 typedef `unsigned long`。
这就是`sizeof`运算符返回的值具有`size_t`类型的原因。

所以 2 ** ( `sizeof(size_t)`* `CHAR_BIT`) 为您提供了程序可以处理的最大内存量，但它肯定不是最精确的内存量。
(在 a`CHAR_BIT`中定义`limits.h`并产生包含在 a 中的位数`char`)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T20:00:49.317

他们采用 size_t 参数；所以它依赖于平台。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T20:02:24.850

依赖于实现，但您可以在使用 memcpy 之前查看需要包含的头文件 (.h)。声明会告诉你（寻找 size_t 或其他）。

然后你问 size_t 是什么，嗯，那是依赖于实现的部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T20:49:54.283

对，您不能复制大于 2^(sizeof(size_t)*8) 字节的区域。但这没什么好担心的，因为您也不能分配更多空间，因为`malloc`还将大小作为 size_t 参数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T10:12:35.587

还有一个问题与什么`size_t`可以代表您的平台将允许流程实际解决的内容有关。

即使在 64 位平台上使用虚拟内存，`memcpy()`本周您也不太可能以超过几 TB 左右的大小进行调用，即便如此，那也是一台非常热门的机器......很难想象一台可以安装完全覆盖的 64 位地址空间的机器会是什么样子。

不要介意只有几 KB 总可写内存的嵌入式系统，`memcpy()`无论`size_t`. 如果您这样做了，请考虑一下保存该调用的返回地址的堆栈刚刚发生了什么？

或者进程看到的虚拟地址空间小于安装的物理内存的系统。例如，在 Win64 平台上运行的 Win32 进程实际上就是这种情况。（我第一次遇到这个是在 PDP-11 上运行的分时操作系统 TSX-11 下，它有 4MB 物理内存，每个进程有 64KB 虚拟地址。当时 4MB 的 RAM 是很多内存，而 IBM PC 没有还存在。）

# ios - 如何在可变高度 UITableView 内根据内容确定 UIWebView 高度？

> ID：745160
> 
> 赞同：71
> 
> 时间：2009-04-13T19:58:32.330
> 
> 标签：ios, iphone, cocoa-touch, uitableview, uiwebview

我正在尝试创建一个`UITableView`高度可变的行，如[该问题的答案中所述](https://stackoverflow.com/questions/272584/is-there-a-better-way-to-determine-the-right-size-for-a-uitableviewcell)

我的问题是每个单元格都包含`UIWebView`不同（静态加载）的内容，我无法弄清楚如何根据内容计算正确的高度。有没有办法做到这一点？我试过这样的事情：

```
 (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
       WebViewCell *cell = (WebViewCell*)[self tableView:tableView cellForRowAtIndexPath:indexPath];
       [cell setNeedsLayout];
       [cell layoutIfNeeded];
       return cell.bounds.size.height;
    } 
```

单元格本身是从一个 nib 加载的，它只是一个`UITableViewCell`包含一个`UIWebView`. （如果单元格只是将自己调整为最大的 html 内容也可以，尽管可变高度会更好）。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-04-15T11:41:26.737

这段代码对于表格视图的使用来说可能太慢了，但可以解决问题。看起来没有其他选择，因为 UIWebView 不提供对 DOM 的直接访问。

在视图控制器中，`viewDidLoad`我在 webview 中加载了一些 HTML，加载完成后运行一些 javascript 以返回元素高度。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    webview.delegate = self;
    [webview loadHTMLString:@"<div id='foo' style='background: red'>The quick brown fox jumped over the lazy dog.</div>" baseURL:nil];
}

- (void)webViewDidFinishLoad:(UIWebView *)webView
{
    NSString *output = [webview stringByEvaluatingJavaScriptFromString:@"document.getElementById(\"foo\").offsetHeight;"];
    NSLog(@"height: %@", output);
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-06-06T13:09:51.403

我很高兴找到你的答案，javascript 技巧对我很有效。

但是，我想说还有“sizeThatFits：”方法：

```
CGSize goodSize = [webView sizeThatFits:CGSizeMake(anyWidth,anyHeigth)]; 
```

我们必须设置一个不同于零的首选大小，但除此之外，它通常总是有效的！

通常，因为使用 UIWebViews，它似乎只适用于第二次加载（我使用“loadHTMLString：”方法，是的，我从委托“didFinishLoad：”方法中调用“sizeThatFits：”）。

所以，这就是为什么我很高兴找到在任何情况下都有效的解决方案。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-08-06T23:26:30.090

这似乎有效。目前。

```
- (void)webViewDidFinishLoad:(UIWebView *)webView
{
    CGFloat webViewHeight = 0.0f;
    if (self.subviews.count > 0) {
        UIView *scrollerView = [self.subviews objectAtIndex:0];
        if (scrollerView.subviews.count > 0) {
            UIView *webDocView = scrollerView.subviews.lastObject;
            if ([webDocView isKindOfClass:[NSClassFromString(@"UIWebDocumentView") class]])
                webViewHeight = webDocView.frame.size.height;
        }
    }
} 
```

如果失败，它应该安全地返回 0。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-10-14T21:13:23.230

问题`-sizeThatFits:`在于它不能开箱即用，至少在 iOS 4.1 上不能。它只返回 webView 的当前大小（无论是使用 CGSizeZero 还是任意非零大小调用它）。

我发现如果在调用`-sizeThatFits:`.

请参阅我的解决方案：[如何确定 UIWebView 的内容大小？](https://stackoverflow.com/questions/3936041/how-to-determine-the-content-size-of-a-uiwebview)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-08-29T23:43:18.037

更好的方法是使用`scrollView.contentSize.height`属性，如下所示。

```
- (void)webViewDidFinishLoad:(UIWebView *)webView
{
     NSLog(@"%f",webView.scrollView.contentSize.height);   
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-11-24T11:01:02.737

测量 webview 有效，但仅在它已加载其内容时

*   使 webview 变小（如 5px）
*   加载它并等待完成
*   然后调用 sizeToFit
*   获得尺寸 THEN
*   重新加载表格视图（返回单元格的正确高度）

广告：：D 在 github 上查看我的 M42WebviewTableViewCell 类

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-08-09T12:31:24.080

如果您第一次使用 sizeThatFits 但之后没有设置错误值，则可能是我遇到的一个原因：外部 CSS 的错误。在检索外部 CSS 和完全构建 Web 文档之前，似乎很快就会调用 webViewDidFinisLoad。我认为如果由于缓存而重新加载，该错误​​就会消失。

一个技巧：很快在你的应用程序中用一个虚拟的 UIWebView 预加载你的 CSS。

开发工具包：IOS4

# asp.net - 在 2K3 构建服务器而不是 XP/Vista 开发机器上的单元测试中，“此处不允许应用程序相对虚拟路径 '~/'”

> ID：745161
> 
> 赞同：8
> 
> 时间：2009-04-13T19:58:45.403
> 
> 标签：asp.net, asp.net-mvc

我正在模拟 HttpRequestBase，因此我可以在测试代码中创建一个 HtmlHelper 并围绕 HtmlHelper 扩展方法编写测试。我将此作为设置代码的一部分：

```
httpRequestBase.Stub(h => h.ApplicationPath).Return("~/");
httpRequestBase.Stub(h => h.AppRelativeCurrentExecutionFilePath).Return(appPath);
httpRequestBase.Stub(h => h.PathInfo).Return(""); 
```

在两台开发机器（一台运行 XP，一台 Vista 64 位）上运行良好。但是，在 Windows Server 2003 构建机器上，当我在 HtmlHelper 上调用 RouteLink() 时，测试失败，如下所示：

System.ArgumentException：此处不允许应用程序相对虚拟路径“~/”。在 System.Web.VirtualPath.Create（字符串 virtualPath，VirtualPathOptions 选项）

在这两种情况下，我都使用 NUnit 2.4.8 和 NUnit GUI 作为测试运行器。据我所知，除了操作系统之外，其他一切都是相同的：相同版本的 RhinoMocks (3.5)，相同版本的 ASP.NET MVC (RTM)。我尝试从开发机器复制二进制文件，而不是使用构建机器上的二进制文件，这没有什么区别。

当我将设置代码中的第一行更改为：

```
httpRequestBase.Stub(h => h.ApplicationPath).Return("/"); 
```

测试在所有机器上通过。

知道为什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-16T17:41:42.447

“~/”不是 ApplicationPath 的有效值。“~/”语法的全部意义在于允许您指定相对于 ApplicationPath 的 URL。

对于有根站点，该值应为“/”。对于虚拟目录中的站点，它应该是一个类似于“/mysite”的值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-12T19:35:01.980

该`HttpRuntime.AppDomainAppVirtualPath`物业在这两种情况下都有效。它为网站返回“~/”，但在单元测试中返回 null，因此它不会破坏它们。

来源：[http ://ediblecode.com/blog/dev/testing-the-application-relative-virtual-path-is-not-allowed-here](http://ediblecode.com/blog/dev/testing-the-application-relative-virtual-path-is-not-allowed-here)

# c# - 使用 XBAP 直接导航浏览器

> ID：745164
> 
> 赞同：3
> 
> 时间：2009-04-13T19:59:39.723
> 
> 标签：c#, .net, wpf, xbap

我正在*全力以赴*WPF 浏览器应用程序 (XBAP) 并遇到了障碍。客户端上的应用程序被连接以处理具有特定前缀/协议的导航请求。（例如，'foo://...'）此外，应用程序会根据创建请求的浏览器不同地处理这些问题。我尝试过 Page 的 'NavigationService.Navigate()' 方法，但出于某种奇怪的原因涉及 WebRequest 对象，它引发 NotSupportedException 说“无法识别 URI 前缀。”我可以创建一个 WebBrowser 控件并使用此前缀成功导航 IT，但应用程序将其识别为不同的浏览器并做出不同的反应。如果我使用的是 Silverlight ，我会直接设置浏览器的“window.location”，效果很好。但当然，

*所以最重要的是，我需要做的是触发托管 XBAP 的浏览器导航到具有此特殊前缀的 URI。*

唷。这就是我想的。谢谢。

**更新**：.Net Framework 4.0 将允许直接访问浏览器的 DOM，这将解决这个问题，但我仍在寻找在 .Net 3.x 中完成此任务的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-18T14:48:06.297

您可以尝试使用 BrowserInteropHelper.ClientSite 来访问 DOM。查看此帖子以获取示例：

[http://blogs.msdn.com/changov/archive/2009/03/01/scripting-out-of-an-xbap.aspx](http://blogs.msdn.com/changov/archive/2009/03/01/scripting-out-of-an-xbap.aspx)

请注意，这仅适用于 Internet Explorer。

# c# - 如何将多个此类类似的方法重构为一个方法？

> ID：745167
> 
> 赞同：0
> 
> 时间：2009-04-13T20:00:53.247
> 
> 标签：c#, refactoring, properties

假设我有许多相关的类都有这样的方法：

```
protected override OnExecute()
{
    this.constructorParm.BoolProperty = !this.constructorParm.BoolProperty;
} 
```

的类型`constructorParm`可能会改变（也可能是 a `static` `Setting`），具体的属性肯定会改变，但属性的类型永远是`bool`。

进一步假设我已经决定让 8 个不同的类在实现级别上做完全相同的事情是愚蠢的——切换一个布尔值。尤其是当它们在语义级别上也都相关时（它们都派生自同一个`Command`抽象基类，这是`OnExecute()`从哪里来的）。

如何在不参数化实际切换操作本身的情况下参数化要切换的属性？例如，我知道我可以做这样的事情（未编译）：

```
internal class CommandX
{
    Action doExecute = null;
    public CommandX(Action executeAction) { this.doExecute = executeAction; }
    protected override OnExecute() { this.doExecute(); }
}

// elsewhere
var b = new CommandX(() => {target.BoolProperty = !target.BoolProperty;}); 
```

但是我怎样才能捕获类中的切换行为，同时仍然接受可写属性作为参数？（如果我将切换作为参数传递，那么我只是在制作一个过于复杂的委托。）

（我不能只传递 b/c 中的属性`bool`是值类型，所以我只是切换一个副本。我不能通过 ref 传递它，当然，b/c 属性不能传递通过参考。我觉得一定有一些愚蠢而明显的东西，我只是在这里真的很想念。:)）

## **语境**

我之所以以间接的方式做这么简单的事情，实际上是由于在winforms中使用了GoF命令模式。核心功能`Command`s 更复杂，但`Command`s 的这个小子集本质上只是切换一个属性，该属性将在其他地方引发 PropertyChanged 事件。我不想将所有这些命令放在单独的类中，而是想将它们合并为一个，因为它们非常简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T20:17:34.580

您可以使用反射来通过使用[PropertyInfo](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.aspx)类来选择要切换的属性：

```
string propertyName = "BoolProperty";
Foo myFoo = new Foo();
Type myFooType = myFoo.GetType();
PropertyInfo prop = myFooType.GetProperty(propertyName);
prop.SetValue(myFoo, !((bool)prop.GetValue(myFoo, null)), null); 
```

您只需保留要切换的属性的名称。

但是，这只有在“切换属性”成为您设计的明确部分时才有意义。否则，当“简单”的解决方案是正常切换属性时，对于这种基本的东西肯定是矫枉过正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T20:22:17.063

您可能可以使用反射来指定要更改的属性，但是如果选项数量有限（您提到有 8 个类），我建议您使用 switch 语句，并在类构造函数中进行枚举.

```
internal enum PropertyOption { Prop1, Prop2 }

internal class Bar {
  PropertyOptiion prop;
  public Bar(PropertyOption prop) {
    this.prop = prop;
  }
  public override OnFoo() {
    switch (prop) {
      case PropertyOption.Prop1:
        this.prop1 = !this.prop1;
        break;
      case PropertyOption.Prop2:
        this.prop2 = !this.prop2;
        break;
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T20:42:48.433

这里有一些很好的答案

恐怕我不是这些方面的专家。但我认为情况是相似的。

[你能从这两种方法中重构出一个共同的功能吗？](https://stackoverflow.com/questions/735473/can-you-refactor-out-a-common-functionality-from-these-two-methods)

# c# - 将对象转换为 int 的更好方法

> ID：745172
> 
> 赞同：206
> 
> 时间：2009-04-13T20:02:50.417
> 
> 标签：c#, interop

这可能是微不足道的，但我想不出更好的方法来做到这一点。我有一个 COM 对象，它返回一个变体，它成为 C# 中的一个对象。我可以把它变成 int 的唯一方法是

```
int test = int.Parse(string.Format("{0}", myobject)) 
```

有没有更清洁的方法来做到这一点？谢谢

* * *

## 回答 #1

> 赞同：421
> 
> 时间：2009-04-13T20:12:26.307

你有几个选择：

*   `(int)`— 演员表操作员。如果对象在继承层次结构中的某个级别*已经是*整数，或者定义了隐式转换，则可以使用。

*   `int.Parse()/int.TryParse()`— 用于从未知格式的字符串转换。

*   `int.ParseExact()/int.TryParseExact()`— 用于从特定格式的字符串转换

*   `Convert.ToInt32()` — 用于转换未知类型的对象。它将使用显式和隐式转换或 IConvertible 实现（如果已定义）。

*   `as int?`— 注意“？”。该`as`运算符仅用于引用类型，因此我使用了“？” 表示一个`Nullable<int>`。" `as`" 操作符的工作方式类似`Convert.To____()`，但认为`TryParse()`而不是`Parse()`：如果转换失败，它会返回`null`而不是抛出异常。

其中，`(int)`如果对象真的只是一个装箱的整数，我会更喜欢。否则[`Convert.ToInt32()`](http://msdn.microsoft.com/en-us/library/system.convert.toint32.aspx)在这种情况下使用。

请注意，这是一个非常*笼统*的答案：我想对达伦·克拉克的回应给予一些关注，因为我认为它在解决这里的*细节*方面做得很好，但是来晚了，还没有投票。无论如何，他得到了我对“接受的答案”的投票，因为他还推荐了 (int)，指出如果它失败`(int)(short)`可能会起作用，并建议您检查调试器以找出实际的运行时类型。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-04-13T20:13:21.703

演员`(int) myobject` *应该*只是工作。

如果这给您一个无效的强制转换异常，那么可能是因为变体类型不是 VT_I4。我敢打赌，带有 VT_I4 的变体将转换为盒装 int，将 VT_I2 转换为盒装短裤等。

在对装箱值类型进行强制转换时，只有将其强制转换为装箱类型才有效。例如，如果返回的变体实际上是 VT_I2，那么`(int) (short) myObject`应该可以工作。

最简单的找出方法是检查返回的对象并在调试器中查看它的类型。还要确保在互操作程序集中您的返回值标记为`MarshalAs(UnmanagedType.Struct)`

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-04-13T20:09:09.403

```
Convert.ToInt32(myobject); 
```

这将处理 myobject 为 null 并返回 0 的情况，而不是抛出异常。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-13T20:08:32.853

`Int32.TryParse`如下使用。

```
 int test;
  bool result = Int32.TryParse(value, out test);
  if (result)
  {
     Console.WriteLine("Sucess");         
  }
  else
  {
     if (value == null) value = ""; 
     Console.WriteLine("Failure");
  } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-07-06T18:14:18.990

我列出了每种铸造方式的差异。什么特定类型的铸造处理而它没有？

```
 // object to int
    // does not handle null
    // does not handle NAN ("102art54")
    // convert value to integar
    int intObj = (int)obj;

    // handles only null or number
    int? nullableIntObj = (int?)obj; // null
    Nullable<int> nullableIntObj1 = (Nullable<int>)obj; // null

   // best way for casting from object to nullable int
   // handles null 
   // handles other datatypes gives null("sadfsdf") // result null
    int? nullableIntObj2 = obj as int?; 

    // string to int 
    // does not handle null( throws exception)
    // does not string NAN ("102art54") (throws exception)
    // converts string to int ("26236")
    // accepts string value
    int iVal3 = int.Parse("10120"); // throws exception value cannot be null;

    // handles null converts null to 0
    // does not handle NAN ("102art54") (throws exception)
    // converts obj to int ("26236")
    int val4 = Convert.ToInt32("10120"); 

    // handle null converts null to 0
    // handle NAN ("101art54") converts null to 0
    // convert string to int ("26236")
    int number;

    bool result = int.TryParse(value, out number);

    if (result)
    {
        // converted value
    }
    else
    {
        // number o/p = 0
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-13T20:06:05.933

也许[Convert.ToInt32](http://msdn.microsoft.com/en-us/library/system.convert.toint32.aspx)。

在这两种情况下都要注意异常。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-08-19T19:10:12.653

```
var intTried = Convert.ChangeType(myObject, typeof(int)) as int?; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-13T20:10:37.577

还有[TryParse](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx)。

来自 MSDN：

```
private static void TryToParse(string value)
   {
      int number;
      bool result = Int32.TryParse(value, out number);
      if (result)
      {
         Console.WriteLine("Converted '{0}' to {1}.", value, number);         
      }
      else
      {
         if (value == null) value = ""; 
         Console.WriteLine("Attempted conversion of '{0}' failed.", value);
      }
   } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-11-28T17:17:18.693

奇怪，但接受的答案似乎是关于 cast 和 Convert 的错误，这意味着从我的测试和阅读文档来看，它也不应该考虑隐式或显式运算符。

因此，如果我有一个对象类型的变量，并且“装箱”类定义了一些隐式运算符，它们将不起作用。

取而代之的是另一种简单的方法，但真正的性能成本是动态转换。

（int）（动态）我的对象。

你可以在 VS 的 Interactive 窗口中试一试。

```
public class Test
{
  public static implicit operator int(Test v)
  {
    return 12;
  }
}

(int)(object)new Test() //this will fail
Convert.ToInt32((object)new Test()) //this will fail
(int)(dynamic)(object)new Test() //this will pass 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-03-30T16:58:06.923

```
int i = myObject.myField.CastTo<int>(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-27T14:55:49.430

您可以先将对象转换为字符串，然后再将字符串转换为 int；例如：

```
string str_myobject = myobject.ToString();
int int_myobject = int.Parse(str_myobject); 
```

这对我有用。

# c# - 为什么我不能获取排他锁？

> ID：745173
> 
> 赞同：5
> 
> 时间：2009-04-13T20:04:37.870
> 
> 标签：c#, multithreading, locking

以下程序打印：

```
Entered 3
Entered 4
Wait for Exited messages
Exited 3
Exited 4 
```

这意味着它无法获得资源的排他锁。为什么？

```
public class Worker
    {
        public void DoIt(object resource)
        {
            Monitor.Enter(resource);
            Console.WriteLine("Entered " + Thread.CurrentThread.ManagedThreadId);
            Thread.Sleep(3000);
            Monitor.Exit(resource);
            Console.WriteLine("Exited " + Thread.CurrentThread.ManagedThreadId);
        }
    }

    class Program
    {
        struct Resource
        {
            public int A;
            public int B;
        }

        static void Main(string[] args)
        {
            Resource resource;
            resource.A = 0;
            resource.B = 1;

            var a = new Worker();
            var b = new Worker();

            var t1 = new Thread(() => a.DoIt(resource));
            var t2 = new Thread(() => b.DoIt(resource));

            t1.Start();
            t2.Start();

            Console.WriteLine("Wait for Exited messages");
            Console.ReadLine();
        }
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-13T20:07:30.500

你`Resource`是一个结构。它在传递给 时被装箱`DoIt`，因此每次调用都会`DoIt`锁定一个不同的对象。换个`Resource`班。

# objective-c - 覆盖 setter 方法并获取信息

> ID：745174
> 
> 赞同：7
> 
> 时间：2009-04-13T20:04:53.550
> 
> 标签：objective-c, initialization, setter

我有一个 setter 方法（setMinimumNumberOfSides），我想在使用合成后覆盖它。在其中，我对实例变量施加了约束，以确保 int 在一定范围内。

稍后在自定义初始化方法中，我设置了另一个实例变量 (numberOfSides)，但我需要确保 minimumNumberOfSides 和 maximumNumberOfSides 在界限内正确设置。我尝试将 setter 上的返回值更改为 BOOL，所以如果它成功/失败，我可以传回 YES 或 NO，但这会产生冲突的方法，我猜是因为我正在使用 synthesize 并覆盖 setter。

如何轻松获取信息以检查 setter 是否被调用并成功返回？

```
-(void)setNumberOfSides:(int)sides
{
    if ((sides < maximumNumberOfSides) && (sides > minimumNumberOfSides))
    {
        numberOfSides = sides;  
    }
    else
        NSLog (@"Invalid number of sides: %d is outside the constraints allowed", sides);

}

-(void)setMinimumNumberOfSides:(int)minimum 
{
    if (minimum > 2)
        minimumNumberOfSides = minimum;

}

-(void)setMaximumNumberOfSides:(int)maximum 
{
    if (maximum <= 12)
        maximumNumberOfSides = maximum;

}

-(id)initWithNumberOfSides:(int)sides minimumNumberOfSides:(int)min maximumNumberOfSides:(int)max 
{
    if (self = [super init])
    {
        self.minimumNumberOfSides = min;
        self.maximumNumberOfSides = max;

        self.numberOfSides = sides;
    }
    return self;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T20:18:47.400

You don't have to synthesize numberOfSides if you're planning on implementing the getter and setter. Without `@synthesize numberOfSides` you can return a BOOL if you choose. You'll need to declare the getter/setter in your interface accordingly.

BTW, another approach would be to use the synthesized getter/setter and add a separate method `-(BOOL)isNumberOfSidesValid` which performs this check.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T20:31:54.903

In a situation like this, you may be better off using a simple call to `assert()`, or throwing an exception.

The choice will depend on how you see this class being used. If it will be part of a library, and you expect other developers to frequently supply incorrect values for `minimumNumberOfSides` or `maximumNumberOfSides`, you should probably throw a proper exception.

A word of warning, though. If you expect the *users of your application* to frequently supply incorrect values, then an exception is a bad idea. Exception handling in Objective-C is an expensive operation. If these checks are in place for the sake of the user, you should perform input validation, and report errors to the user in a much more friendly manner.

**edit:** Here is some quick sample code:

```
-(void)setMinimumNumberOfSides:(int)minimum
{
    if (minimum <= 2)
    {
        [NSException raise:@"invalid minimumNumberOfSides value"
                    format:@"value of %d is too low (must be > 2)", minimum];
    }

    minimumNumberOfSides = minimum;
} 
```

**edit:** Here is [another SO question](https://stackoverflow.com/questions/324284/how-to-throw-an-exception-in-objective-c-cocoa) that goes into detail about exception handling in Objective-C.

# ruby-on-rails - 如何将红宝石中的美元和美分的小数转换为字符串值？

> ID：745176
> 
> 赞同：6
> 
> 时间：2009-04-13T20:05:30.130
> 
> 标签：ruby-on-rails, ruby, formatting, decimal

我在我的应用程序中存储了一个成本。成本未在数据库中格式化。例如：00.00 保存为 0，1.00 保存为 1，40.50 保存为 40.5

我需要从数据库中读取这些值并将它们转换为美元和美分的字符串。例如：0 --> cost_dollars = "00" & cost_cents = "00", 1 --> cost_dollars = "01" & cost_cents = "00", 40.5 --> cost_dollars = "40" & cost_cents = "50" .

有没有一种简单的方法可以在 ruby​​ on rails 中做到这一点？或者有人有这样做的代码吗？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-13T20:11:20.303

你可以用这段 Ruby 代码来完成它：

```
fmt = "%05.2f" % cost
cost_dollars, cost_cents = fmt.split '.' 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-13T20:31:36.870

如果您尝试在视图中格式化美元值，您应该查看`number_to_currency`ActionView::Helpers::NumberHelper。

```
>> bd = BigDecimal.new "5.75"   
>> include ActionView::Helpers
>> number_to_currency(bd)
=> "$5.75" 
```

至于将价值分成单独的美元和美分，我的第一个问题是，“为什么？” 如果您有充分的理由，并且您正在处理数据库中的小数，那么您可以执行以下操作。

```
>> bd = BigDecimal.new "5.75"
>> "dollars:#{bd.truncate} cents:#{bd.modulo(1) * BigDecimal.new('100')}"
=> "dollars:5.0 cents:75.0" 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-14T04:03:59.187

`number_to_currency`很好，但它可能会变得昂贵；如果你需要经常调用它，你可能想自己动手。

您应该知道，如果您根据这些值进行大量计算，使用浮点数存储货币[可能会出现问题](http://c2.com/cgi/wiki?FloatingPointCurrency)（[请参阅）。](http://www.ruby-forum.com/topic/48754)一种解决方案是使用整数表示货币并计算美分。这似乎是[money 插件](http://agilewebdevelopment.com/plugins/rails_money)使用的方法。另一种解决方案是在您的迁移中使用一种`decimal`类型，它应该适用于现代版本的 Rails (> 1.2)：

```
add_column :items, :price, :decimal, :precision => 10, :scale => 2 
```

（`:scale`是小数点后的位数，`:precision`是总位数。）这将为您提供 Rails 中的[BigDecimal](http://www.ruby-doc.org/stdlib/libdoc/bigdecimal/rdoc/index.html)对象，这些对象有点难以使用，但还不错。

整数和小数方法都比浮点慢一点。我在某些地方使用浮点数作为货币，因为我知道我不需要对 Rails 中的值进行计算，只需存储和显示它们。但如果您需要准确的货币计算，请不要使用浮点数。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-13T20:08:56.130

与其存储为小数，不如存储为整数美分。所以 1 美元存储`100`在数据库中。

或者，如果您不介意一点性能开销，请检查“。” 在数据库的值中。如果存在，则在“.”上拆分，并将片段解析为整数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-13T20:19:46.273

sprintf 是你的朋友：

```
cost_dollars = sprintf('%02.f', cost)
cost_cents = sprintf('%.2f', cost) 
```

# ruby - 无法升级 RubyGems 1.2

> ID：745184
> 
> 赞同：2
> 
> 时间：2009-04-13T20:08:09.237
> 
> 标签：ruby, rubygems

为什么会发生以下情况，我该如何排序？

在 OS X Leopard (v10.5.6) 上：

```
$ ./script/server 
Rails requires RubyGems >= 1.3.1 (you have 1.2.0). Please `gem update --system` and try again.
$ sudo gem update --system
Updating RubyGems
Nothing to update 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T20:14:17.410

我自己没有遇到这个问题，但我认为这是一个可能的解决方案：

```
$ sudo gem install rubygems-update
Successfully installed rubygems-update-1.3.0
1 gem installed
$ sudo update_rubygems 
```

这应该允许您通过特定的更新程序 gem 安装更新。

此处引用：[更新 ruby​​gems](https://wincent.com/wiki/Updating_to_RubyGems_1.3.0_on_Mac_OS_X_Leopard_10.5.4)

# error-handling - 在 php4 中实现 try catch 的最佳方法

> ID：745189
> 
> 赞同：3
> 
> 时间：2009-04-13T20:09:16.940
> 
> 标签：error-handling, try-catch, php4

php4 中最接近 try-catch 块的是什么？

我在 xmlrpc 请求期间处于回调的中间，无论如何都需要返回一个特定的结构化数组。

我必须对所有对外部资源的访问进行错误检查，从而导致嵌套的 if-else 块的堆栈很深，很难看。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-19T17:03:54.260

迟到的答案，我意识到，对不起。我希望这仍然与您相关：

首先，我正在回应您在回复您的帖子时得到的评论。PHP5是要走的路。

然而：

> 我在 xmlrpc 请求期间处于回调的中间，无论如何都需要返回一个特定的结构化数组。

如果你可以保证程序不能在没有返回结构化数组的情况下继续运行，并且你必须使用 PHP4，那么带有详细错误信息的**exit()**或**die()**会给你带来与致命相同的效果例外会。

当然，这与优雅相去甚远。如果你想要一些可捕获的东西，那么返回值和如果检查结果是你最好的选择，不幸的是。有一些标准的方法可以传回特定的错误对象，但还是一样的——返回错误对象，if-检查结果是否是错误对象，做出反应。

不过，请看一下[PEAR 的错误对象](http://pear.activeventure.com/core/core.pear.pear.intro.html)。

# sql-server - 什么是处理大量写入的良好 SQL Server 2008 解决方案，以便它们不会减慢数据库用户的读取速度？

> ID：745190
> 
> 赞同：1
> 
> 时间：2009-04-13T20:09:57.187
> 
> 标签：sql-server, database, performance

我们有大型 SQL Server 2008 数据库。很多时候，我们必须将大量数据导入数据库，这需要几个小时。在那段时间里，其他人的读取和小写入速度都会减慢一吨。

我正在寻找一种解决方案，我们可能会设置一个用于批量写入的数据库服务器，然后设置另外两个用于读取的数据库服务器，并且可能会对它们进行少量写入。目标是在批量更改运行时保持快速的小型读取和写入。

有没有人知道使用 SQL Server 2008 完成此任务的好方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T12:34:28.957

保罗。你的问题有两个部分。

**首先，为什么写入慢？**

当您说您拥有大型数据库时，您可能想用一些数字来澄清这一点。Microsoft 团队在不到一个小时的时间内演示了数 TB 的负载，但当然他们使用的是高端设备和专门的数据仓库技术。我曾参与过数据仓库团队，他们经常在一夜之间加载如此多的数据，以至于事务日志驱动器必须超过 1 TB 才能处理快速突发，而不是每小时 1 TB。

要找出写入速度慢的原因，您需要将加载方法与数据仓库技术进行比较。例如，您是否尝试过使用临时表？表分区？不同阵列上的数据和日志文件？如果您不确定从哪里开始，请查看我的 Perfmon 教程来测量您的系统寻找瓶颈：

[http://www.brentozar.com/archive/2006/12/dba-101-using-perfmon-for-sql-performance-tuning/](http://www.brentozar.com/archive/2006/12/dba-101-using-perfmon-for-sql-performance-tuning/)

**第二，如何扩展？**

您询问了如何设置多个数据库服务器，以便一个处理批量负载，而另一个处理读取和一些写入。我会非常谨慎地注意不要采用多服务器写入方法，因为它很快就会变得复杂得多，但是使用多服务器进行读取并不少见。

最简单的方法是使用日志传送：每 X 分钟，主服务器进行一次事务日志备份，然后将该日志备份应用到只读报告服务器。这有一些问题 - 数据有点落后，恢复过程必须将所有连接踢出数据库才能应用恢复。对于像数据仓库这样的事物，最终用户希望在新一天的数据加载时继续运行他们自己的报告，这可能是一个完全可以接受的解决方案。您可以在数据仓库加载时根本不进行事务日志恢复，并且用户可以始终保持连接。

为了帮助找出适合您的解决方案，请考虑在您的问题中添加以下内容：

*   数据库的大小（GB/TB 大小，正在写入的最大表中的数百万行数）
*   服务器和存储的大小（带有 10 个驱动器的盒子与连接到 SAN 的盒子有不同的解决方案）
*   加载数据的方法（是否是单记录插入，是否使用批量加载，是否使用表分区等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T21:14:53.630

当您说其他人的读写速度变慢时，我不确定您的意思。当他们读取和写入当前正在导入数据的同一数据库或同一服务器上的不同数据库时，它会减慢速度吗？

如果它是同一个数据库，即使表被锁定以进行写入/插入，您也可以始终使用“with (nolock)”提示进行读取。但是，请注意读取可能是脏读。我不确定当表被锁定时如何进行更快的快速写入，因为写入已经在进行中。您可以保持事务较小，以加快写入速度并释放锁。另一种选择是有一个单独的数据库用于批量插入和另一个数据库用于读取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T21:19:29.593

最简单的方法是减慢写入发生的速度，并一次将它们输入一条记录。它们会更慢，但它会让用户的事情变得更快。如果批次需要“几个小时”，您也许可以将它们分散更多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T21:19:37.427

为什么不使用[MemCached](http://www.danga.com/memcached/)来消除读取，我在工作时遇到了同样的情况，我们一直在 Windows 上使用 memcached，效果很好。我很惊讶让我的代码也运行起来是多么微不足道。几乎所有主流语言都有开源包装库，使用它可能会导致 99% 的读取，甚至不会触及数据库（因为您在数据库的写入操作中设置了 memcache 值）。

Memcached，实际上只是一个巨大的哈希表存储（甚至可以集群或运行在您喜欢的任何机器上，因为它使用套接字来读取和存储哈希）。

读取 memcached 值时，只需检查其是否为空（如果不是则返回）或执行您通常的数据库读取并返回。它可以存储几乎所有内容，只要每个 memcached 键/值对小于 1MB。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T12:36:44.990

这只是一个想法。在“活动”表上创建一个视图。然后将 BCP 中的数据放入“暂存”表中。完成后，更新视图以包含“暂存”表。只是一个想法。

# reporting-services - Reporting Services 2005 筛选器

> ID：745191
> 
> 赞同：1
> 
> 时间：2009-04-13T20:10:05.673
> 
> 标签：reporting-services

有没有办法在 SSRS 2005 中执行“和”“或”过滤器？

我有一个指向数据集（存储过程）的表，如下所示：

```
 name                       type                 amount 
License Plate Credit           fees                ($150.00) 
Lieu Tax                       fees                $1,012.12 
Finance Tax City               taxes               $1,839.90 
Finance Tax County             taxes               $306.65 
Finance Tax State              taxes               $3,434.48 
```

用户希望查看所有行：

1.  类型 = '税' 或
2.  type = 'fees' 和 name = 'Lieu Tax'

我需要在报表中而不是在存储过程中执行此操作的原因是，我们将创建多个指向同一个存储过程的报表，具体取决于每个客户希望如何布置显示和业务规则。

**要求澄清** 我希望有一种方法可以在报告中而不是在过程中做到这一点。该计划是让许多自定义报告指向具有不同要求的相同过程。这个想法是让报表构建者（他们不知道 SQL）来创建报表，而不是我们程序员总是必须参与其中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T21:07:29.840

您应该修改您的存储过程以接受类型和名称等参数，然后从您的报告中您应该根据用户要求使用正确的值调用此存储过程。Reporting Services 报告确实具有称为报告参数的功能。因此，您应该将您的报告转换为接受来自用户的类型和名称参数并将其传递给存储过程。要为多个用户创建多个报告，您只需从这个具有不同参数值的模板报告创建多个链接报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-15T16:01:49.037

每个可能的条件组合要么是通过，要么是失败。您使用 SWITCH 来评估每个可能的条件，并返回 1 或 0。然后在过滤条件中使用“=”和“=1”。

=SWITCH (TYPE = "TAXES", 1, TYPE = "FEES" AND NAME = "Lieu Tax"), 1, 1=1, 0)

您可以通过这种方式在单个表达式中处理整个过滤。奇迹般有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T09:53:10.677

就在这里。打开包含数据的表或矩阵的表属性。那里有一个“过滤器”选项卡，允许您在执行查询后过滤数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T13:06:12.830

将 proc 更改为

```
SELECT 

xxx

FROM

xxx

WHERE (a.id = @aID OR @aID IS NULL)
AND   (b.id = @bID OR @bID IS NULL)
AND   (c.id = @..... 
```

只需从报告中传入一个值或 NULL

# smoke-testing - 什么是烟雾测试，它对我有什么作用？

> ID：745192
> 
> 赞同：48
> 
> 时间：2009-04-13T20:10:17.310
> 
> 标签：smoke-testing

我以为我了解烟雾服务器用于持续集成以测量项目的性能和测试覆盖率。这基本正确吗？对程序进行冒烟测试是什么意思？这是否仅仅意味着不断地应用在烟雾服务器上定义的测试，以便能够确定特定时间范围内的性能下降？

[这个另一个问题](https://stackoverflow.com/questions/28605496/what-is-the-difference-between-smoke-testing-and-sanity-testing)确实描述了健全性测试和冒烟测试之间的区别，但没有要求定义冒烟测试。这个问题比参考问题早很多年。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-04-13T20:16:49.760

冒烟测试是一组基本的廉价运行测试，先于实际测试。它旨在验证构建是否成功部署以及所有测试环境。方面正在运行并为实际测试过程做好准备。它可以帮助您将测试愤怒的全部范围归结为错误的构建，并让您意识到您一直在在一个糟糕的环境中进行测试。或错误地部署构建可能为时已晚。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-04-02T14:22:34.837

打开它，看看有没有冒烟。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-04-13T20:31:32.690

该术语起源于[硬件维修](http://www.websters-online-dictionary.org/sm/smoke_test.html)，并已应用于软件。它旨在快速测试应用程序在首次运行时是否“着火”。如上所述，这只是为了确保您不会浪费一大群人的时间，因为他们把他们放在明显坏掉的东西上。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-13T20:20:06.820

冒烟测试不是性能测试或回归预防测试。

冒烟测试是一组最高优先级的全自动测试。即使您的常规构建成功，您的产品也有可能以非常根本的方式被破坏，使其 100% 无法使用。冒烟测试旨在测试该级别的核心功能。没有通过冒烟测试的构建很可能会导致大部分自动化测试失败。

如果冒烟测试失败，这通常意味着您正在失去生产力，因为构建不可用、无法测试等。冒烟测试失败往往需要立即修复，大约数小时而不是数天。

烟雾测试的重要方面是它们可以快速运行。您应该始终进行某种冒烟测试。许多团队有足够的资源在他们的日常或持续集成构建上运行更大的测试套件（这很好），但冒烟测试应该被认为是最低限度的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-09-07T07:21:52.213

关于烟雾测试的[维基百科页面](http://en.wikipedia.org/wiki/Smoke_testing)实际上非常好。它包括一个指向 Steve McConnel 的（“代码完成”）论文的指针，该论文位于 1996 年 IEEE 软件 13(4) 的最佳实践部分，标题为[“Daily Build and Smoke Test”](http://www.stevemcconnell.com/ieeesoftware/bp04.htm)。

我想说冒烟测试是单元测试和其他形式测试的先决条件：如果冒烟测试失败，甚至启动单元测试也没有意义。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-13T20:21:54.287

我们使用术语冒烟测试来指代对应用程序或产品进行快速基本测试以使其有资格进行进一步测试（如集成测试或功能测试）的测试。如果应用程序未能完成这些高级测试所需的一些基本操作，那么进行集成测试或其他高级测试就没有多大用处。例如，我们有一个基于 Web 的应用程序，我们进行冒烟测试以确保我们可以加载所有网页，让用户登录/注销等。这些是应该与应用程序一起工作以使其可测试的基本内容。如果页面甚至没有加载或者用户甚至无法登录，我们就无法对功能或集成测试做太多事情。我们对每个构建进行冒烟测试，然后进行功能和集成测试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-13T20:20:50.017

冒烟测试是集成测试的第一步。作为开发人员，您已将所有部分放在一起，并确保您的应用程序能够运行，然后再将其提供给您的 QA 团队进行“真正的”测试。

我想写更多，但 MahdeTo 打败了我，得到了正确的答案...... :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-26T03:16:29.130

*在进行测试之前检查应用程序的基本和关键功能称为冒烟测试。*在冒烟测试中，我们检查基本和关键功能的正流，以检查构建是否可测试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-01-13T19:14:58.797

我同意前面的一些答案。对我来说，冒烟测试只是检查我所有的 X 数千个子页面和重定向是否仍然有效。

工作中表示每个子页面的状态码为“200 OK”。

我尽可能晚地运行冒烟测试。在我将代码部署到服务器之后，在我激活该服务器之前。

今天甚至有一个在线服务（SaaS）为我做这项工作。[https://www.smest.it](https://www.smest.it)帮助我进行烟雾测试。我刚刚在他们的主页上输入了一次我的私人域，自从我每天检查我的网站以来。一点压力都没有。

# debugging - 如何在 GDB 中打印类型属性？

> ID：745195
> 
> 赞同：3
> 
> 时间：2009-04-13T20:10:40.353
> 
> 标签：debugging, gdb, ada

有没有办法从 GDB 中打印类型属性？
例如整数大小。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-14T01:14:36.440

是的：

(gdb) p*事物属性*

一些属性被识别，而另一些则不被识别。（在下面列出的内容中，Found 是一个布尔变量。）

```
gdb) p integer'size
Attempt to use a type name as an expression
(gdb) p found'size
$2 = 8
(gdb) p integer'first
$3 = -2147483648
(gdb) p integer'last
$4 = 2147483647 
```

以下是使用 gdb 进行调试的[Ada 部分的列表：](https://sourceware.org/gdb/current/onlinedocs/gdb/Omissions-from-Ada.html#Omissions-from-Ada)

```
Only a subset of the attributes are supported:

     * 'First, 'Last, and 'Length on array objects (not on types and subtypes).
     * 'Min and 'Max.
     * 'Pos and 'Val.
     * 'Tag.
     * 'Range on array objects (not subtypes), but only as the right operand of the membership (in) operator.
     * 'Access, 'Unchecked_Access, and 'Unrestricted_Access (a GNAT extension).
     * 'Address. 
```

（嗯，那个列表可能已经过时了，因为我可以做 Integer'Last，尽管第一个项目符号说它对类型无效。）

# java - EnumSet 用于 1.5 之前的假枚举？

> ID：745202
> 
> 赞同：4
> 
> 时间：2009-04-13T20:11:55.777
> 
> 标签：java, reflection

最近我做了很多这些

```
enum Thing {

    /* etc etc */

    static final Set<Thing> allThings = EnumSet.allOf(Thing.class);

} 
```

我想要在 pre 1.5 Java 中类似的东西，即我想要类似的东西：

```
final class Thing {

    private Thing(); // control instances within class

    static final Thing instance0 = new Thing();
    static final Thing instance1 = new Thing();

    static final Set allThings = // ?????
} 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T07:46:24.360

那个怎么样：

```
final class Thing {

  static final Set allThings = new HashSet();

  private Thing() {
      allThings.add(this);
  } // control instances within class

  static final Thing instance0 = new Thing();
  static final Thing instance1 = new Thing();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T20:16:06.313

在 1.5 之前的 Java 中没有直接的等价物。

在 Java 1.5 之前，如果您想立即初始化，有两个（语法上古怪的）选项：

```
static final Set allThings = new HashSet(Arrays.asList(new Object[] {
    instance0, instance1, // etc.
})); 
```

或者

```
static final Set allThings = new HashSet() {{
    add(instance0);
    add(instance1);
    // etc.
}}; 
```

但是，这两者都有其缺点。更简单的方法是简单地制作一个静态方法

```
private static Set all() {
    Set ret = new HashSet();
    ret.add(instance0);
    ret.add(instance1);
    // etc.
} 
```

您仍然必须记住向该方法添加任何新成员，但它更易于阅读（对于大多数人而言）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T08:04:48.217

关于如何在 Jav 5 之前的环境中定义类型安全枚举，有一个非常明确的模式。

它基本上是一个具有`public final static`值字段和私有构造函数（或更多）的类。

唯一“困难”的事情是正确获取序列化等细节（基本上是通过实现`readResolve()`）。

[这个 Javaworld Tip](http://www.javaworld.com/javaworld/javatips/jw-javatip122.html)对这个问题进行了相当深入的讨论，而[这个](http://www.javaworld.com/javaworld/javatips/jw-javatip133.html)关于这个主题还有更多要说的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T10:51:49.547

在下面的解决方案中，每个枚举类都扩展了一个抽象基类 AbstractEnum，并拥有自己的一组所有值，这些值自动生成并存储在基类的静态映射中。

```
 public abstract class AbstractEnum
  {
    private final static Map/*<Class,Collection<AbstractEnum>>*/ allEnums 
      = new HashMap();

    protected AbstractEnum()
    {
      Collection/*<AbstractEnum>*/ allValues 
        = (Collection) allEnums.get(getClass());
      if (allValues == null)
      {
        allValues = new HashSet();
        allEnums.put(getClass(), allValues);
      }
      allValues.add(this);
    }

    protected static Collection/*<AbstractEnum>*/ getAllValues(Class clazz)
    {
      return Collections
        .unmodifiableCollection((Collection) allEnums.get(clazz));
    }
  }

  final class Thing extends AbstractEnum
  {
    final static Thing thing0 = new Thing();

    final static Thing thing1 = new Thing();

    private Thing()
    {}

    static Collection/*<Thing>*/ getAllValues()
    {
      return getAllValues(Thing.class);
    }
  } 
```

请注意，它仍然需要一些额外的重要功能，例如线程安全和序列化（如 saua 的帖子中所述）。

# sql-server - 如何在 SSIS 中调用存储过程？

> ID：745207
> 
> 赞同：23
> 
> 时间：2009-04-13T20:13:46.197
> 
> 标签：sql-server, sql-server-2005, stored-procedures, ssis, parameters

我正在尝试创建一个 SSIS 包，该包从表中查询数据，并在另一个数据库中对每一行调用一个存储过程。

在我的旧 DTS 包中，我正在这样做：

```
EXEC myStoredProcedure ?, ?, ? 
```

...然后我映射了参数。但是，在 SSIS 中，我无法弄清楚如何进行这项工作。

我有一个数据流任务，它首先运行数据查询。它将数据传递到 OLE DB 目标。我将数据访问模式设置为“SQL 命令”，但是当我尝试放入上面的 SQL 时，在解析 SQL 时出现“无效参数计数”。我无法进入映射屏幕。有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-14T08:30:13.587

在数据流中，`OLE DB Command`可用于为数据流中的每一行执行 SQL 语句 - （[MSDN 文档](http://technet.microsoft.com/en-us/library/ms141773(SQL.90).aspx)）

或者，您可以将源结果集存储在数据类型对象的变量中，并`Foreach Loop`在控制流中使用容器（[此处](http://www.codeproject.com/KB/database/foreachadossis.aspx)的示例）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-13T20:17:57.807

您将需要使用执行 SQL 任务。在 SQLStatement 部分中，您可以添加代码以执行存储过程。

为了传入参数，使用 ? 语法并在“参数映射”部分指定参数。

一个很好的例子可以在[这里](http://www.sqlis.com/post/The-Execute-SQL-Task.aspx)找到。

# c# - 通过 Enterprise Library 记录任何错误时发送电子邮件

> ID：745208
> 
> 赞同：1
> 
> 时间：2009-04-13T20:13:59.673
> 
> 标签：c#, asp.net, email, logging, enterprise-library

我有一个 ASP.NET 网站，它利用了企业库 (3.1) 的许多方面，包括日志记录应用程序块。我正在使用自定义 TraceListener 来处理所有日志记录请求。

我想添加一个电子邮件侦听器，只要网站发生错误，它就会触发一封电子邮件。需要明确的是（并且因为我犯了同样的错误），这不能通过将以下内容添加到您的配置文件来实现：

```
 <errors switchValue="All" name="Logging Errors &amp; Warnings">
    <listeners>
      <add name="Email Listener" />
    </listeners> 
```

*这将在logging*发生错误时发送电子邮件，而不是在调用 Trace.TraceError() 时发送电子邮件。我找到了一些编写自定义代码来执行此操作的示例，但这不是我想要做的。

我确信在开发 Enterprise Library 时就考虑到了这一点，我希望遇到一个聪明的人，回答有关 Stack Overflow 的问题，他遇到了这个问题。提前致谢！

**更新**

解决了。最终使用了一个类别并为此发送了一封电子邮件。

```
<categorySources>
  <add switchValue="Error" name="Errors">
    <listeners>
      <add name="Email Listener" />
    </listeners>
  </add>
</categorySources> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T20:32:14.013

你不能做类似的事情（伪代码）

```
<allEvents switchValue="Error" name="blahblah">
  <listeners><add name="Email Listener"/></listeners> 
```

?

# c# - WCF 中的“端点”是什么？

> ID：745212
> 
> 赞同：52
> 
> 时间：2009-04-13T20:15:38.780
> 
> 标签：c#, wcf, endpoints

我的印象是在配置文件中将端点定义为可能的客户端列表，但这没有任何意义（从某种意义上说，我认为它说什么计算机可以连接到服务）现在我收集它更多一个定义，那么有人可以解释一下终点对我来说是什么吗？我理解定义合同接口然后实施合同的概念，但我在这之间的某个地方迷路了，实际上有一些可用的东西。

在这种情况下，地址是什么？主机地址？

绑定是使用正确的通信方法/协议吗？

合同本质上是“共享对象”（是的，我知道这在技术上非常不正确，但在这里与我合作）

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-04-13T20:24:01.443

端点是服务公开的内容，在 WCF 术语中，它由三部分组成：

*   地址
*   捆绑
*   合同

地址是可以到达端点的 URL。

绑定规定了所应用的转换以及发送到地址处合同实施的消息的形状（在某种程度上）。

合同规定了在该地址公开了哪些操作。这正是它所说的，它是一个合同，表明允许哪些调用。

大多数时候，人们记得它是 AB C。

需要注意的一些事项：

绑定通常是通道与应用行为的组合；通道是通道堆栈上的元素，它们在到达服务实现之前修改消息并执行操作。

虽然在 .NET 中通常由接口表示，但并不要求以这种方式表示合同。一些设计优先的倡导者将首先定义要为请求和响应发送的消息的架构，这就是 WCF 将 .NET Contract 接口转换成的内容。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-13T20:39:47.473

我将在这里引用 Juval Lowy 的*Programming WCF Services*：

> 每个服务都与一个定义服务所在位置的地址、一个定义如何与服务通信的绑定以及一个定义服务做什么的合同相关联。这个管理服务的三巨头很容易记住作为服务的 ABC。
> 
> WCF 以端点的形式形式化了这种关系。端点是地址、合约和绑定的融合。
> 
> 每个端点都必须具有所有三个元素，并且主机公开端点。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-04-12T09:51:59.747

**WCF 中的端点**
WCF 服务是一个公开端点集合的程序。每个端点都是与世界交流的门户。端点由三个部分组成。
1)**地址**：
   定义服务的位置
   ex - [http://www.test.com:8001/MyService](http://www.test.com:8001/MyService)
2)**绑定**：
   指定客户端如何与端点通信的绑定。
   ex - BasicHttpBinding、WSHttpBinding、WSDualHttpBinding 等
3)**合同**：
   标识可用操作的合同

端点将在所创建服务的 web.config 文件中提及。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-05-11T10:20:09.730

服务端点具有地址、绑定和合同。端点的地址是端点所在的网络地址。EndpointAddress 类表示 WCF 端点地址。端点的绑定指定端点如何与世界通信，包括传输协议（例如，TCP、HTTP）、编码（例如，文本、二进制）和安全要求（例如，SSL、SOAP 消息安全）。Binding 类表示 WCF 绑定。Endpoint 的 Contract 指定 Endpoint 通信的内容，本质上是一组消息，这些消息组织在具有基本消息交换模式 (MEP) 的操作中，例如单向、双工和请求/回复。ContractDescription 类表示 WCF 合同。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-13T20:22:41.430

请参阅[此处：](http://msdn.microsoft.com/en-us/magazine/cc163412.aspx) 服务端点指定用于通信的地址、绑定和合同。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-01T06:50:28.120

服务端点具有地址、绑定和合同。端点的地址是端点所在的网络地址。EndpointAddress 类表示 WCF 端点地址。端点的绑定指定端点如何与世界通信，包括传输协议（例如，TCP、HTTP）、编码（例如，文本、二进制）和安全要求（例如，SSL、SOAP 消息安全）。Binding 类表示 WCF 绑定。Endpoint 的 Contract 指定 Endpoint 通信的内容，本质上是一组消息，这些消息组织在具有基本消息交换模式 (MEP) 的操作中，例如单向、双工和请求/回复。ContractDescription 类表示 WCF 合同。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-19T13:51:55.070

Endpoint 用于配置客户端应用程序和 WCF 服务之间的通信通道

终点样本

```
<endpoint address="http://localhost:3901/Service1.svc"
           binding="basicHttpBinding"  
          contract="ServiceReference.IService1" bindingConfiguration="BasicHttpBinding_IService1"  
              name="BasicHttpBinding_IService1" /> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-28T06:12:00.063

Web 服务端点可以隐藏其中的部分或全部。并且基于 request 可以在内部决定 Request 的处理。

SRJTester 工具（可在 Github 上获得）非常适合在发出服务请求时指定端点、操作、协议等。

# c - 如何摆脱 C 代码中的 gcc 汇编器警告“为 .init 设置不正确的部分属性”？

> ID：745213
> 
> 赞同：1
> 
> 时间：2009-04-13T20:15:59.107
> 
> 标签：c, gcc, assembly

我有以下 C 代码：

```
struct myStruct_t
{
    const char     m_name[60];
    const uint32_t m_data;
};

const struct myStruct_t myStruct
    __attribute__(( __aligned__( 64 ), section(".init") )) =
    {
        "myName",
        (uint32_t)&someOtherStruct
    }; 
```

当我在 gcc 4.1.1（用于 PS3）中编译时，我收到警告：

```
1>c:/t/ccy6.s: Assembler messages:
1>c:/t/ccy6.s(106): Warning: setting incorrect section attributes for .init 
```

警告指向的汇编代码是下面的“.section”子句：

```
 .section              .init,"aw",@progbits
            .align 6
            .type                 myStruct , @object
            .size                 myStruct , 64
myStruct :
            .ascii                "myName"
            .long                 someOtherStruct 
```

它不喜欢标志的“w”（可写）部分，因为 .init 中的内容是只读的，并且所有可能位置的“const”不会迫使编译器不吐出“w”。我怎么能告诉编译器“不，真的，它是 const，我不是在开玩笑”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-08-10T22:43:39.970

这是 GCC 为 .section 指令自动指定参数的问题。幸运的是，节名称参数直接复制到程序集输出中，允许您解决此问题。

该指令：

```
__attribute__ ((section(".init"))) 
```

生成此程序集：

```
.section .init,"aw",@progbits 
```

要删除警告，您可以像这样指定属性：

```
__attribute__ ((section(".init,\"ar\",@progbits ;"))) 
```

这将产生：

```
.section .init,"ar",@progbits ;"aw",@progbits 
```

分号将该行的其余部分标记为注释，因此汇编器忽略它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T22:23:20.923

Wild guess, but perhaps the attribute it's setting that's wrong is the "aw", which suggests "writable" to me. Does it still do this if everything in your struct is const?

Edit: Random googling seems to suggest that "w" could also stand for "weak"?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T11:49:42.047

在带有 GCC 4.3.3 的 GNU/Linux PC 上，.init 不可写。我没有在文档中找到如何手动设置部分属性。

也许它不会有太大帮助，但这里有一些建议：

*   如果您想要之前执行一些代码`main()`，您可以使用 C++ 对象。其构造函数将在之前调用`main()`，其析构函数将在之后调用。
*   您可以编写一个小工具来手动修补目标文件。我很确定这已经存在。也许在这里：[http](http://www.eresi-project.org/) ://www.eresi-project.org/ 。
*   您可以联系 GCC 开发人员。也许这是一个错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-18T02:56:59.433

看在上帝的份上，伙计，不要试图`gcc`用作汇编程序！我看不出有什么理由为什么这个东西应该在这个`.init`部分（它不是代码），但是如果你必须把它放在那里，写你想要的汇编代码（你有一个好的开始；只需编辑），把它在每个平台的适当位置进行源代码控制，并完成它！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T16:59:33.293

如果您想将 myStruct 放在特殊的位置，请使用链接器文件。

[http://sourceware.org/binutils/docs-2.19/ld/Scripts.html#Scripts](http://sourceware.org/binutils/docs-2.19/ld/Scripts.html#Scripts)

# http - http get/post 请求和谷歌地理定位 api

> ID：745217
> 
> 赞同：1
> 
> 时间：2009-04-13T20:16:51.600
> 
> 标签：http, geolocation, google-gears

我在[http://m.rummble.com使用 Web 应用程序](http://m.rummble.com)网站，当我点击使用齿轮找到我的位置时。该应用程序返回我当前的位置（近似城市位置）以及给定英里半径内的各种机构。为了进一步了解它是如何工作的，我打开了wireshark，我注意到一个POST请求被发送到www.google.com/loc/json。然后谷歌服务器响应 200 OK 和 JSON 格式的位置数据。我理解这部分。下一步是我不明白的。显然，在 rumble 应用程序接收到位置数据（纬度、经度、地址等）之后，它使用 GET 请求将此信息发送到另一台服务器上的某个 API，该服务器获取给定英里半径内的各种设施。我所做的只是单击，使用齿轮找到我的位置。我有理由期望应用程序只返回我的位置，但它' 无需单击应用程序中的任何其他按钮即可返回更多内容。有人可以解释这是怎么发生的吗？有没有一个脚本可以做到这一点？我希望我能更好地解释我的情况。
[替代文字 http://img211.imageshack.us/img211/1236/examplel.jpg](http://img211.imageshack.us/img211/1236/examplel.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T09:29:30.480

好吧，确定匿名用户位置的第一步是通过他的 IP。如果这是你想要的，你需要做两件事之一：

1.  查找 IP 和位置数据库。一个快速的谷歌搜索出现了[http://ip-to-country.webhosting.info/downloads/ip-to-country.csv.zip](http://ip-to-country.webhosting.info/downloads/ip-to-country.csv.zip)
2.  使用 DNS 跟踪路由和反向查找 IP 到主机名，并尝试读取主机名以获取地理信息，例如国家和城市。

无论哪种方式，一旦您有了国家和/或城市，您就可以进行地理查询以查找纬度和经度，并根据这些坐标显示地图。

据推测，Google Gears 使用了类似的东西，或者可能基于 Google 使用其各种数据收集技术大量收集的数据。这样，一旦 Google Gears 确定了用户的位置，它就会知道他在哪个城市/国家，并请求匹配的纬度和经度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-23T22:38:23.727

无论出于何种原因，rummble.com 都没有`navigator.getlocation`在我的机器上进行查询，所以我无法自己确认您的报告。

但是，当您单击以允许 rummble.com 从 Gears 获取您的位置时，您将该位置信息交给了 rummble.com 网站。然后，该网站可以随心所欲地使用它——信息被返回到在浏览器上运行的一段 Javascript，在这种情况下，听起来那段 Javascript 正在使用您的位置信息来加载附近的列表餐馆。

您可能非常担心这一点。如果 rumble 将您的姓名和位置信息发送给广告商或政府怎么办？他们将您的精确位置信息存储多长时间？在允许与网站共享您的位置*之前*，您应该考虑这些影响。

# silverlight - Silverlight：Webservice 方法返回 ObservableCollection 而不是 Generic List

> ID：745218
> 
> 赞同：1
> 
> 时间：2009-04-13T20:17:09.853
> 
> 标签：silverlight, web-services

我有一个 web 服务，它调用一个返回类的通用列表的方法，`BodyPartUrls`如下所示：

```
public List<BodyPartUrls> getCharacterClassBody(int characterClassID)
{
    var bpulst = new List<BodyPartUrls>();
    var iqcb = ydc.ClassBodies.Where(cb =>  cb.characterClassID == characterClassID);

    foreach (var icb in iqcb)
    {
        var bpu = new BodyPartUrls();
        bpu.bodyPartName = icb.BodyPart.bodyPartName;
        bpu.bodyName = icb.Body.bodyName;
        bpu.puppetID = characterClassID;
        bpulst.Add(bpu);
    }
    return bpulst;
} 
```

BodyPartUrls 仅包含字符串和整数属性，请注意 ydc 指的是数据上下文。这是网络服务中的代码：

```
 [WebMethod]
    public List<BodyPartUrls> getCharacterClassBody(int characterClassID)
    {
       return b.getCharacterClassBody(characterClassID);
    } 
```

现在要在 silverlight 中调用该方法，我使用了以下代码：

```
public void initialiseBodiesSoapClientClient()
{
    string webServiceUrl = pu.GetUrlForResource("Bodies.asmx");
    System.ServiceModel.BasicHttpBinding binding = new System.ServiceModel.BasicHttpBinding();
    EndpointAddress endpoint = new EndpointAddress(webServiceUrl);
    bsc = new BodiesRef.BodiesSoapClient(binding, endpoint);
    bsc.getCharacterClassBodyCompleted += new EventHandler<Yambushi.BodiesRef.getCharacterClassBodyCompletedEventArgs>(bsc_getCharacterClassBodyCompleted);
} 
```

方法`pu.GetUrlForResource`get 是托管 web 服务的 url，以下是方法`bsc_getCharacterClassBodyCompleted`：

```
void bsc_getCharacterClassBodyCompleted(object sender, Yambushi.BodiesRef.getCharacterClassBodyCompletedEventArgs e)
{
   bpulist = e.Result;
} 
```

`bpulist`是 BodyPartUrls 的通用列表，由于某种原因`e.Result`返回 ObservableCollection 而不是通用列表。我有类似的代码来检索其他工作正常的通用列表，所以我真的不明白为什么这会有所不同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-13T21:18:45.710

单击配置服务引用。在“数据类型”部分下，您可以选择希望集合或字典返回的类型。

# php - 如何使用 PHP 在 GD 中设置部分透明度？

> ID：745223
> 
> 赞同：0
> 
> 时间：2009-04-13T20:17:56.030
> 
> 标签：php, gd

我正在尝试使用 PHP 制作动态图像，但我不知道如何设置部分透明度。使事物变得坚实或完全透明非常容易，但我一直无法做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T20:39:27.803

假设您正在使用 imagecreatetruecolor 函数创建图像，并且您正在将图像输出为 PNG 文件......

您需要调用以下方法来指定在调用 imagepng 之前必须将图像生成为 24 位 PNG：

```
imagesavealpha($im, true); 
```

请注意，如果不使用应用于 img 标记的 CSS 过滤器，Internet Explorer 6 不支持 24 位 PNG 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T20:56:26.640

查看[imagecolorallicatealpha()](http://is.php.net/manual/en/function.imagecolorallocatealpha.php)的文档，他们在那里创建了一个透明的色环。

# wpf - WPF 绑定转换器

> ID：745233
> 
> 赞同：3
> 
> 时间：2009-04-13T20:21:30.763
> 
> 标签：wpf, data-binding, treeview, wpf-controls

我目前陷入了以下情况的死胡同：

我有一个`List<Category>`集合，每个集合都`Category`包含一个`Id`,`Name`和一个`List<string[]>`名为的属性`Subcategory`（其中数组包含该子类别的`Name`and `Id`- 我不想创建另一个类）。

我有一个正确绑定到类别和子类别的方法`TreeView`。`HierarchicalDataTemplate`我在树节点旁边还有复选框，我绑定`IsChecked`到`MultiBinding`子/类别的 Id 和应检查的子/类别的整体列表。

```
<CheckBox.IsChecked>
    <MultiBinding Converter="{StaticResource IsCategoryChecked}">
        <Binding Path="Id"/>
         <Binding Path="myDataSet.Tables[Categories]/cat_subcat"/>
    </MultiBinding>
</CheckBox.IsChecked> 
```

我使用的转换器只是检查我提供的子/类别的名称是否是列表的一部分（两者都是我绑定的值）。这很好用，总的来说我对结果很满意。

问题在于将检查/取消检查转换回来。当用户更改`IsChecked`值时，我必须将子/类别的 ID 添加到所有已选中类别的列表中，或者从中删除该 ID。不幸的是，当我尝试为 实现`ConvertBack()`方法时`IMultiValueConverter`，我只能访问已更改的 ACTUAL 值（IsChecked 的真或假值），并且无法访问特定复选框绑定到的子/类别的 Id .

我尝试过但失败的解决方案：

1.  在进行初始转换时保存子/类别名称不是一个选项，因为我对所有子/类别使用相同的转换器，因此我只会保存我尝试转换的最后一个子/类别。

2.  使用`MouseUp`/`KeyUp`事件是没有用的，因为（无论出于何种原因）它们无法被触发（一个错误？）。

我正在考虑忽略`ConvertBack()`并使用`Checked`/`Unchecked`事件，但觉得这是一个相当“肮脏”的解决方案，因为我不妨完全忽略绑定！这是唯一的出路吗？我已经没有选择了，但仍然希望有一个“好的”解决方案，如果它在那里的话！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T20:43:39.977

你有几个选择，我在生产中都使用过：

1.  正如您所说，已选中/未选中重载，这使您可以最大程度地控制情况
2.  在代码中将 IsCategoryChecked 属性添加到您的强类型表中，该表在后台处理所需的更改，并且您绑定到 IsCategoryChecked 属性而不是使用转换器

由于强类型数据集的部分分类，第二个工作得相当好。但是，它仍然不是“无缝”的。

# reflection - 数据映射代码还是反射代码？

> ID：745235
> 
> 赞同：3
> 
> 时间：2009-04-13T20:21:41.823
> 
> 标签：reflection, data-access-layer, data-access

将数据从数据库表中获取到代码中的对象似乎总是很普通的代码。我发现有两种方法可以做到这一点：

1.  有一个代码生成器，它读取数据库表并创建类和控制器以将数据字段映射到类字段或
2.  使用反射获取数据库字段并在类中找到它。

上述2种方法注意到的问题如下

*   方法 1 在我看来好像我遗漏了一些东西，因为我必须为每个表创建一个控制器。
*   一旦您进入繁重的数据访问代码，方法 2 似乎太费力了。

我应该尝试将数据从数据库获取到我的对象上吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T20:25:21.893

在这种情况下，您通常使用 OR（对象-关系）映射器。提供 OR 功能的一个很好的框架是[Hibernate](http://www.hibernate.org/)。这回答了你的问题了吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T23:26:30.070

我认为这个问题的答案取决于您将要使用的语言的可用技术。

我在使用 ORM（NHibernate）方面非常成功，所以我自然会推荐选项一。

您可能希望采取其他选择：

*   如果您使用的是 .NET，您可以选择使用类属性的属性作为类中的映射，或者作为可以反映的数据
*   如果您使用的是 .NET，Fluent NHibernate 将使在您的代码中进行类型安全的映射变得非常容易。
*   您可以使用泛型，这样您就不需要为每个表创建一个控制器，尽管我承认您很可能无论如何都会做后者。然而，泛型可以包含所有表通用的大多数通用 CRUD 方法，您只需要编写特定的怪癖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T20:24:54.030

我使用反射来来回映射数据，即使在大量数据访问下也能正常工作。“第三条路线”是手工做所有事情，这可能跑得更快，但写起来真的很慢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T23:25:54.050

我同意 lewap，一个 ORM（对象关系映射器）在这些情况下真的很有帮助。您可能还想考虑 Active Record 模式（在 Fowler 的企业架构模式一书中进行了讨论）。它可以真正加快简单应用程序中 DAL 的创建速度。

# c# - 使用鼠标中键关闭 winforms 选项卡控件上的选项卡

> ID：745237
> 
> 赞同：8
> 
> 时间：2009-04-13T20:21:46.877
> 
> 标签：c#, winforms

有没有简单的（5行代码）方法来做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-13T20:52:34.307

删除单击鼠标中键的选项卡的最短代码是使用 LINQ。

确保事件已连接

```
this.tabControl1.MouseClick += tabControl1_MouseClick; 
```

对于处理程序本身

```
private void tabControl1_MouseClick(object sender, MouseEventArgs e)
{
  var tabControl = sender as TabControl;
  var tabs = tabControl.TabPages;

  if (e.Button == MouseButtons.Middle)
  {
    tabs.Remove(tabs.Cast<TabPage>()
            .Where((t, i) => tabControl.GetTabRect(i).Contains(e.Location))
            .First());
  }
} 
```

如果你正在争取最少的行数，这里是一行

```
tabControl1.MouseClick += delegate(object sender, MouseEventArgs e) { var tabControl = sender as TabControl; var tabs = tabControl.TabPages; if (e.Button == MouseButtons.Middle) { tabs.Remove(tabs.Cast<TabPage>().Where((t, i) => tabControl.GetTabRect(i).Contains(e.Location)).First()); } }; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-14T19:45:03.937

没有 LINQ 的解决方案没有那么紧凑和美观，但也很实际：

```
private void TabControlMainMouseDown(object sender, MouseEventArgs e)
{
    var tabControl = sender as TabControl;
    TabPage tabPageCurrent = null;
    if (e.Button == MouseButtons.Middle)
    {
        for (var i = 0; i < tabControl.TabCount; i++)
        {
            if (!tabControl.GetTabRect(i).Contains(e.Location))
                continue;
            tabPageCurrent = tabControl.TabPages[i];
            break;
        }
        if (tabPageCurrent != null)
            tabControl.TabPages.Remove(tabPageCurrent);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-30T02:56:50.690

没有足够的积分来对提供的解决方案发表评论，但它们都存在相同的缺陷：已删除选项卡中的控件未释放。

问候

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-13T20:47:58.907

你可以这样做：

```
private void tabControl1_MouseClick(object sender, MouseEventArgs e)
{
     if (e.Button == MouseButtons.Middle)
     {
          // choose tabpage to delete like below
          tabControl1.TabPages.Remove(tabControl1.TabPages[0]);
     }
} 
```

基本上，您只是在选项卡控件上单击鼠标，并且仅在单击中间按钮时才删除页面。

# sql - 在关系数据库中存储（和访问）历史 1:M 关系的最佳方式是什么？

> ID：745242
> 
> 赞同：4
> 
> 时间：2009-04-13T20:22:27.563
> 
> 标签：sql, mysql, database-design

假设示例：

我有汽车和业主。每辆汽车在给定时间属于一个（并且只有一个）所有者，但所有权可能会转移。车主可以随时拥有零辆或多辆汽车。我想要的是将历史关系存储在 MySQL 数据库中，这样，给定任意时间，我可以查找 Cars 对 Owners 的当前分配。

即在时间 X（X 可以是现在或过去的任何时间）：

*   谁拥有汽车 Y？
*   车主 Z 拥有哪些汽车（如果有）？

在 SQL 中创建一个 M:N 表（带有时间戳）很简单，但我想避免相关的子查询，因为这个表会变大（因此，性能会受到影响）。有任何想法吗？我觉得有一种方法可以通过自己加入这样的表来做到这一点，但我对数据库的经验并不丰富。

更新：我想避免每行同时使用“start_date”和“end_date”字段，因为每次插入新行时都需要进行（可能）昂贵的查找。（另外，它是多余的）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-13T20:41:00.483

创建第三个名为 CarOwners 的表，其中包含 carid、ownerid 以及 start_date 和 end_date 字段。购买汽车时，请填写前三个并检查表格以确保没有其他人被列为所有者。如果有，则使用该数据作为 end_date 更新记录。

要查找当前所有者：

```
select carid, ownerid from CarOwner where end_date is null 
```

在某个时间点查找所有者：

```
select carid, ownerid from CarOwner where start_date < getdate()
and end_date > getdate() 
```

getdate() 是特定于 MS SQL Server 的，但每个数据库都有一些返回当前日期的函数 - 只是替换。

当然，如果您还想从其他表中获取更多信息，您也可以加入它们。

```
select co.carid, co.ownerid, o.owner_name, c.make, c.Model, c.year  
from  CarOwner co
JOIN Car c on co.carid = c.carid
JOIN Owner o on o.ownerid = co.ownerid
where co.end_date is null 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T04:13:39.693

我发现处理这类需求的最佳方法是只维护 VehicleEvents 的日志，其中之一就是 ChangeOwner。在实践中，您可以得出这里提出的所有问题的答案 - 至少与您收集事件一样准确。

每条记录都有一个时间戳，指示事件发生的时间。

这样做的一个好处是可以在每个事件中添加最少量的数据，但有关车辆的信息可以积累和发展。

此外，使用时间戳，可以在事后添加事件（只要时间戳准确反映事件发生的时间。

试图以我尝试过的任何其他方式来维持这样的历史状态会导致疯狂。（也许我还在恢复中。：D）

顺便说一句，这里的显着特征可能是它是时间序列或事件日志，而不是 1:m。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T04:06:17.197

如果您真的不想有开始和结束日期，您可以只使用一个日期并执行如下查询。

```
SELECT * FROM  CarOwner co 
WHERE   co.CarId = @CarId 
      AND co.TransferDate <= @AsOfDate 
      AND NOT EXISTS (SELECT * FROM CarOwner co2 
                WHERE  co2.CarId = @CarId 
                  AND co2.TransferDate <= @AsOfDate 
                  AND co2.TransferDate > co.Transferdate) 
```

或轻微的变化

```
SELECT * FROM  Car ca 
    JOIN CarOwner co ON ca.Id = co.CarId 
  AND co.TransferDate = (SELECT MAX(TransferDate) 
                  FROM CarOwner WHERE CarId = @CarId 
                                             AND TransferDate < @AsOfDate)
WHERE co.CarId = @CarId 
```

这些解决方案在功能上等同于 Javier 的建议，但根据您使用的数据库，一种解决方案可能比另一种更快。

但是，根据您的读写比率，如果您在关联实体中冗余更新结束日期，您可能会发现性能更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T21:35:05.267

考虑到每辆车至少属于一个车主的业务规则（即车主在被分配给一辆汽车之前就存在）以及表可能会变大的操作约束，我将设计架构如下：

（通用 sql 92 语法：）

```
CREATE TABLE Cars
(
CarID integer not null default autoincrement,
OwnerID integer not null, 
CarDescription varchar(100) not null,
CreatedOn timestamp not null default current timestamp,
Primary key (CarID),
FOREIGN KEY (OwnerID ) REFERENCES Owners(OwnerID )

)

CREATE TABLE Owners
(
OwnerID integer not null default autoincrement,
OwnerName varchar(100) not null,
Primary key(OwnerID )
)

CREATE TABLE HistoricalCarOwners
(
CarID integer not null,
OwnerID integer not null,
OwnedFrom timestamp null,
Owneduntil timestamp null,
primary key (cardid, ownerid),
FOREIGN KEY (OwnerID ) REFERENCES Owners(OwnerID ),
FOREIGN KEY (CarID ) REFERENCES Cars(CarID )
) 
```

我个人不会从我的客户端应用程序中触及第三个表，而只是让数据库完成工作 - 并保持数据完整性 - 在 Cars 表上使用`ON UPDATE`AND`ON DELETE`触发器以在汽车更改所有者时填充`HistoricalCarOwners`表（即，每当提交 UPDATE OwnerId 列上）或汽车被删除。

使用上述模式，选择当前车主很简单，选择历史车主很简单

```
select ownerid, ownername from owners o inner join historicalcarowners hco 
                                        on hco.ownerid = o.ownerid
                                        where hco.carid = :arg_id and
                                              :arg_timestamp between ownedfrom and owneduntil
order by ... 
```

HTH，文斯

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T05:42:53.957

为什么没有事务表？其中将包含汽车 ID、FROM 车主、TO 车主和交易发生的日期。

然后，您所做的就是在所需日期之前找到汽车的第一笔交易。

要查找 3 月 1 日所有者 253 拥有的汽车：

选择 * 从`transactions`WHERE `ownerToId`= 253 AND `date`> '2009-03-01'

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-13T20:26:47.317

汽车表可以有一个名为 ownerID 的 id，然后你可以简单地

1.select car from cars internal join owner on car.ownerid=owner.ownerid where ownerid=y

2.从owner=z的汽车中选择汽车

不是确切的语法，而是简单的伪代码。

# ms-access - 为什么 Microsoft Access 表单会为一个查询而不是另一个查询创建记录？

> ID：745245
> 
> 赞同：4
> 
> 时间：2009-04-13T20:23:03.630
> 
> 标签：ms-access

我有一个 Access 数据库。让我们假设这是一家宠物店。

有一张动物桌。

```
Animals (animal_id, birth_date, price) 
```

然后是我们销售的不同类型动物的具体表格。

```
Dogs (animal_id, bark_volume)
Cats (animal_id, collar_size, shedding_rate)
Fish (animal_id) 
```

鱼并不有趣，因此它们没有任何特殊领域。Fish 表只是存在，因此您知道 Animals 表中的哪些记录是鱼。

现在，我有一个用于将动物添加到宠物店的通用表格。在获得表格之前，您首先必须说出您要添加的动物种类。基于此，表单显示/隐藏字段，更改其记录源，并将字段绑定到适当的数据列。该表单从查询 DogInfo、CatInfo 和 FishInfo 中提取其数据。

现在，当你进入一只狗或一只猫时，一切都很好。一条记录被添加到 Animals 和 Dogs 或 Cats 中。

但是，当您输入鱼时，您得到的只是动物，没有鱼。

这可能是什么原因造成的？是否是由于 Fish 表上缺少其他列而导致的？

（让我们抛开使用选择查询更新表根本没有意义的事实。我没想到 Access 一开始就让我这样做，但 Access 的座右铭似乎是“让错误的事情变得容易做和做正确的事很尴尬。”但是，该数据库相对简单且不经常使用，并且比我开始研究它之前至少好 100 倍，所以我并不太担心这个问题，因为只要我能让它工作。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T04:18:23.317

“是不是因为 Fish 表中缺少其他列导致的？”

是 - 当您在子记录（狗和猫）上输入数据时，Access 将自动填写父 ID (animal_id)

由于没有鱼记录的数据条目，因此不会创建它。你必须在代码中做到这一点。不确定您的表单和数据源是如何设置的，但您会在其中一个表单事件上执行类似的操作：

```
Fish![animal_id] = Animal![animal_id] 
```

编辑

在您的 FishInfo 查询中，您必须提供`Fish.[animal_id]`一个别名 - 您不能有两个具有相同名称的字段 - 调用它`Fish_animal_id`

然后在 Form_BeforeUpdate 事件中输入：

```
Me.Fish_animal_id = Me.animal_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T22:52:49.217

您是否考虑过在不同的表上配置关系？鉴于上述设计，我将首先向特定动物表添加一个标识列，并将其设置为主键。例如：

```
Dogs(DOG_ID, animal_id, bark_volume)
Cats(CAT_ID, animal_id, collar_size, shedding_rate) 
```

`Animals.ANIMAL_ID`等等。在关系视图中，您将定义一个从to的一对多（一对一？）关系`Dogs.animal_id`。然后，您可以将 Animals 表连接到表单上的组合/列表框控件，以从该表中选择一条记录。我认为如果您正确配置控件，您甚至可以从该控件创建新记录（或者您可以使用子表单）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T18:01:24.390

撇开糟糕的设计不谈，您是否在各个表之间建立了关系？您是否设置了表以强制执行参照完整性？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T23:28:07.490

Dogs/Cats/Fish 表没有单独的 ID 吗？假设唯一的区别是列数，我会很好奇这是否突然修复它。

# c# - 在执行期间修改 C# Class 方法

> ID：745246
> 
> 赞同：2
> 
> 时间：2009-04-13T20:23:08.357
> 
> 标签：c#, oop, tdd

我想在不继承基类的情况下覆盖类方法，因为这会花费大量时间和修改，因此需要进行越来越多的测试。就像这样：

```
class TestClass{
    public void initialMethod(){
        ...
    }
} 
```

在代码的某个地方，我想做这样的事情：

```
public testMethod()
{
    return;
}
test(){
    changeMethod(TestClass.initialMethod, testMethod);
} 
```

而这个 changeMethod 函数将覆盖 TestClass 的 initialMethod 以便它调用 testMethod 。

使用常规做法继承和覆盖该方法不是一种选择，因为此类 A 是一个图形组件，并且继承它（并更改它）会破坏大量代码。

编辑：我们没有 TestClass 的基本代码，因此不能修改将 initialMethod 定义为委托的代码。

编辑2：由于这是一个图形组件，设计者自动添加了很多代码。如果我要继承此代码，我将不得不替换设计师添加的所有代码。这就是为什么我不想更换这个组件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T20:27:03.667

您需要[策略](http://www.dofactory.com/Patterns/PatternStrategy.aspx)模式。

主要步骤：

*   用ie创建一个界面。*做（）*签名
*   您的*initialMethod()*应该调用一个*strategy.Do()*，其中 strategy 是您的接口的类型
*   创建一个实现此接口的类。*Do()*现在是你的测试方法。
*   将此类的实例注入您的主类

如果工作不是那么大（假设只是颜色替换或其他东西），那么我同意 Jhonny D. Cano 使用 C# *(anonymous)delegate* s 的解决方案。

**编辑**（在编辑 2 之后）

可能 - 就像概念验证一样 - 您应该继承该类并将基类中的所有引用替换为这个新的。做到这一点，别无其他。如果可行，您可以考虑下一步（新方法或委托等）

您只需要从您的版本控制系统中重新签出，如果它可能失败，您可以放弃它。值得一试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T20:28:51.057

也许你可以作为代表来做。

```
class TestClass {
    public Action myAction;
    public void initialMethod(){
        ...
    }

    initialMethod

    public TestClass() {
        myAction = initialMethod;
    }
} 
```

然后在 TestMethod

```
public testMethod()
{
    return;
}
test() {
    testClassInstance.myAction = testMethod;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T21:32:08.753

我认为你最好的选择可能是使用像 LinFu 这样的 AOP 框架。有一篇 codeproject 文章解释了它：

[介绍 LinFu，第 VI 部分：LinFu.AOP - 任何 .NET 语言中密封类型的普遍方法拦截和替换](http://www.codeproject.com/KB/cs/LinFuPart6.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T20:28:34.473

如果您定义了“TestClass”，则可以将“initialMethod”定义替换为属性和委托，然后可以将其设置为具有给定签名的任何方法。（即使是匿名的。）

```
class TestClass {
  Action _myMethod;
  Action MyMethod {
    get { return _myMethod; }
    set { _myMethod = value; }
}

var tc = new TestClass()
tc.MyMethod = () -> Console.WriteLine("Hello World!");
tc.MyMethod() 
```

上面的代码未经测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T21:24:38.193

简短而简单的答案是：如果您无法调整基本的 TestClass 代码，不，您无法修改该类以将一个方法替换为另一个方法。一旦我们开始做这样的事情，我们就会使用一种完全不同的语言，比如 JavaScript。

更长的答案是：这取决于谁调用了被替换的方法。

如果是其他类，看看你是否不能在它们和不可修改的具体类之间实现[代理](http://en.wikipedia.org/wiki/Proxy_pattern)。这是否可行取决于该类是实现接口还是它自己的接口。

如果是类本身，那么您唯一的选择是在设计时使用[Reflector](http://www.red-gate.com/products/reflector/)（或等效工具）或在运行时使用 Reflection.Emit 反编译和修改类。但是，要走这条路，您必须受到非常严重的伤害，因为它肯定会很痛苦而且很脆弱。

不幸的是，您仍然没有解释您正在尝试做什么以及为什么。在移动中替换方法在直接允许它的语言中是强大的东西......可能有模拟库可以被扭曲到足够远来做反射的东西，但是你会如履薄冰。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-13T20:40:11.403

如果您没有代码，请使用扩展方法。

```
public void doSmth(this objectYOUWANT arg)
{
   //Do Something
} 
```

在这里，您使用 Closed for Modification Open for Extension 的原则。

这将为您没有源代码的库添加功能。这样做非常干净。

版：

在 FrameWork 3.5 中有一些新的东西叫做扩展方法。这些方法向封闭的程序集添加功能，让您在功能中扩展封闭的 dll/程序集。

例如，要使用它，您有一个导入的 dll，称为`Graphics.dll`（您的项目中有参考）

首先，您应该创建一个新的静态类，例如`Extension`：

```
public static class Extensions
{
} 
```

其次，您想为包含在`Graphics.dll`named中的类添加额外的功能`ChartGraph`。你会这样做：

```
public static class Extensions
{
    public static void draw(this ChartGraph g)
    {
       // DO SOMETHING
    }
} 
```

第三，当您从 实例化一个新对象时，`graphics.dll`您现在将拥有您创建的新方法：

```
ChartGraph myG = new ChartGraph();
myG.draw(); 
```

如您所见，您无需重新编译 dll 即可轻松添加新功能，如果您没有源代码，这很好。

# xmlhttprequest - 跨站点 XMLHttpRequest - 什么时候？

> ID：745249
> 
> 赞同：1
> 
> 时间：2009-04-13T20:24:23.207
> 
> 标签：xmlhttprequest, xss

任何人都可以更密切地遵循规范并且对这些事情通常如何工作有经验的人可以估计[跨站点 XMLHttpRequest](http://www.w3.org/TR/2009/WD-cors-20090317/)何时会成为推荐并开始得到浏览器的支持？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T20:30:13.957

我没有遵循规范。

鉴于 IE6 在 IE7 出现 5 年后仍然普遍使用，因此需要很长时间（10 年？）才能可靠地指望它存在于浏览器中。

同时，考虑将[jsonp](http://en.wikipedia.org/wiki/JSON#JSONP)用于非敏感数据。当然，您不应该在不加密的情况下传输敏感信息......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-20T13:14:18.603

> 当 Cross-Site XMLHttpRequest 将成为推荐时

什么时候：

*   准备好了
*   有两个独立、兼容的实现
*   官僚主义的车轮已经转动得够多了

> 开始获得浏览器的支持

很久以前。[例如， Firefox 3.5 支持它](https://developer.mozilla.org/En/HTTP_Access_Control)。

# unit-testing - 在 Shell 脚本中测试任何协议

> ID：745266
> 
> 赞同：5
> 
> 时间：2009-04-13T20:29:24.927
> 
> 标签：unit-testing, shell, tap

有没有人在 shell 中看到、尝试实现或以其他方式玩过[TAP ？](http://en.wikipedia.org/wiki/Test_Anything_Protocol)我们正在寻找跨多种语言创建单元测试（不要让我开始解释为什么到目前为止还不存在），并且由于我们有这么多 Perl 代码，我们将研究 TAP（除其他外，我想象）。我找到了一个用于 C 的 TAP 库，Perl 当然是内置的，我什至还找到了一个用于 Java 的 API。但是缺少的一个领域是 shell 脚本测试。

并不是说我在单元测试 shell 脚本上发现了很多，但是因为我们确实有数千行 shell 代码，所以能够以某种方式对其进行测试会很好。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-14T09:30:56.480

有关库列表，请参阅[TAP 生产者](http://testanything.org/producers.html)列表。在该列表中，您将找到shell 代码[的 Tap-functions](http://testanything.org/wiki/index.php/Tap-functions)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-23T08:44:03.933

*   [Bats](https://github.com/sstephenson/bats)是一个简单的 Bash 唯一测试框架，可以用非常清晰的语法编写测试。
*   [shUnit](http://shunit.sourceforge.net/)是最古老的 shell 测试框架，文档很少。
*   [shUnit2](https://github.com/kward/shunit2)是受 shUnit 启发的最新项目，但完全不同。测试可以用更 xUnit 的方式编写。最重要的是，它与 POSIX 兼容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-13T21:10:03.393

我通常为我的 shell 脚本编写自己的小型测试框架。执行此操作时要记住一些事项：

*   处理文件时，使所有路径都相对于您可以在测试中修改的某个变量。
*   `diff(1)`非常适合验证测试结果（并向用户显示有用的错误消息）
*   广泛使用局部变量
*   一切都必须在一个函数中

也就是说，我的“测试框架”主要是一组 shell 函数（名为`test*`）和一个`runTests`逐个调用它们的函数。没有什么花哨的，真的。测试为测试创建一个工作目录，将所有必要的文件复制到其中，运行一个函数，根据一组已知的文件验证结果。

# wix - 在 Visual Studio 2008 和 WiX(v3) 中使用 heat.exe 收集 .csproj

> ID：745267
> 
> 赞同：7
> 
> 时间：2009-04-13T20:29:52.710
> 
> 标签：wix, fragment, wix3, csproj, heat

我发现 Wix v3 使用工具 (heat.exe) 将信息“收集”到 WiX 片段中。要么我在寻找错误的位置，要么这是很少记录的。

为包含媒体文件的复杂文件夹结构自动生成 WiX 片段（可能使用 heat.exe）的最佳方法是什么：

*   各种类型（ico/png/xaml/等）
*   这可能会定期更改（名称/位置/添加/删除）
*   被归类为“内容”并包含在 .csproj 中

这样它们可以通过 WiX 内置到安装程序中，并且可以承受升级和补丁吗？

## 背景资料

1.  我找到了 heat.exe，它似乎解决了自动生成 WiX 片段的要求
2.  在让“dir”收割机工作时，我注意到“project”收割机（命令行帮助）
3.  媒体已经在 C# 项目文件中，因此注意到“-pog:Content”可能会做得很好
4.  粗略搜索发现未提及“项目”收割机的过时文档
5.  意识到整个项目安装程序可能可以使用“项目”收割机完成，但不确定它的支持程度以及陷阱是什么。
6.  看到“PUT-GUID-HERE”的生成，并意识到 guid 的自动生成可能会影响升级/补丁。
7.  意识到必须有人将这些工具用于类似目的，并且可能会为我指明正确的方向。

（公平地）指出 v3 尚未“完成”（因此缺乏文档和教程）。我现在得到的感觉是，在我的构建脚本中自动执行此操作并非易事，而且工具正在不断增长以简化此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T11:10:12.687

以我的经验，John Robbins 的[Paraffin](http://www.wintellect.com/CS/blogs/jrobbins/archive/2007/10/21/wix-a-better-tallow-paraffin.aspx)解决了tallow.exe（v3 中的heat.exe）的很多问题。我不确定 Paraffin 是否与 v3 配合得很好，但可能值得一试。

仅供参考，我在构建过程中使用了石蜡，它允许我删除之前涉及 powershell 脚本的 2-3 步清理过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T10:51:03.230

有关自动生成的设置的升级影响，[请阅读此](http://www.joyofsetup.com/2008/12/30/paying-for-upgrades/)。带回家的消息：

> Windows Installer 不允许您在次要升级中删除组件

如果您自动生成设置，则很难保证组件继续存在。因此，您必须在自动生成组件和进行小升级之间做出选择。

如果您有一些自动生成的组件，那么只需进行重大升级。您可以使用[Rob 的这个示例](https://stackoverflow.com/questions/114165/how-to-implement-wix-installer-upgrade/724098#724098)作为示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T23:00:14.657

感谢您的背景，我不知道他们正在开发新版本的 Wix。根据项目页面，它还不是 RTM，所以这可以解释你遇到的问题。我希望在其中一个回复中听到 WIX 开发人员的意见。

我无法帮助您使用开发中的 heat.exe 功能。但是，我遇到过你的情况，我的解决方案是创建一个工具，将目录和文件信息作为输入并生成有效的 wix 项目文件作为输出。.vsproj 文件只是一个 XML 文件，您可以使用 XSL、C# 的 LINQ、PowerShell 或许多其他工具来完成这项工作。为此，我个人已经使用（LINQ 之前的）C#/XMLDOM 来解析 VS 项目文件。

祝你好运，

戴夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T00:44:11.007

有关文档，请查看随 WiX 安装的帮助文件 - **WiX.chm**提供最新信息（以及命令行`-help`选项）。

# c# - c# sizeof 十进制？

> ID：745270
> 
> 赞同：16
> 
> 时间：2009-04-13T20:30:23.330
> 
> 标签：c#

不清楚十进制类型的 sizeof。字节大小是否像 sql server 一样因精度而异？c# 类型的精度变量是“十进制”吗？

我不想打开不安全的代码来只在十进制类型上调用 sizeof。你会如何处理这个问题？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-13T20:35:42.257

> 十进制关键字表示 128 位数据类型。

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/364x0z75(loband).aspx)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-13T21:31:18.193

正如其他人所说，`decimal`始终是 16 字节（128 位）。的精度`decimal`始终为 28/29 位。它是浮点类型，与 SQL 的`DECIMAL`类型不同。有关详细信息，请参阅[我的文章。](https://csharpindepth.com/Articles/Decimal)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-13T20:35:49.887

.NET Framework 中 System.Decimal 的大小固定为 16 字节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-01T09:24:29.797

具有 28-29 位有效数字的 128 位精确十进制值，128 位 = 16 字节

# installation - 我可以编写 Cygwin 安装脚本以包含某些软件包吗？

> ID：745275
> 
> 赞同：32
> 
> 时间：2009-04-13T20:30:34.830
> 
> 标签：installation, cygwin

我经常安装 cygwin，以使该过程自动化会很方便。具体来说，我希望能够提前指定要安装的软件包，这样我就不必在安装时记住它们。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2011-09-09T18:56:26.723

是的你可以。假设你还没有安装 Cygwin，bash 不可用，所以你必须使用 CMD 脚本。这是一个例子：

```
setup-x86.exe ^
--quiet-mode ^
--packages ^
aria2,^
atool,^
autoconf,^
...
xmlstarlet,^
zip 
```

并将其他包添加到列表中。`^`每行末尾的脱字符 ( ) 字符是 CMD 脚本中的行继续字符。包名称列表以逗号分隔，这是该`--packages`选项所期望的，尽管没有记录。

您可以运行`setup-x86.exe --help`，或查看[Cygwin 常见问题解答](http://www.cygwin.com/faq/faq.html#faq.setup.cli)，以了解可用的设置命令行选项。

如果您将此脚本命名为 setup.bat 或 setup.cmd，并将其放在与 setup-x86.exe 相同的目录中，那么您可以运行它以一键安装 Cygwin 以及您的所有软件包想。

另请注意，您必须为全新安装指定`--site`和`--root`选项，否则它将退出“安静模式”并提示用户。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-14T14:55:22.550

[apt-cyg](http://stephenjungels.com/jungels.net/projects/apt-cyg/)与我正在寻找的类似，尽管它需要预先存在的 cygwin 安装和一些非默认包。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T21:24:14.823

我不知道你是否可以编写脚本，但我找到了关于制作自定义包目录和安装程序的“操作方法”。这样，您可以拥有所需的所有软件包并预先选择安装程序。[你可以在这里](http://buildchimp.com/wordpress/?p=4)找到那篇文章。

# visual-studio-2008 - 在 Visual Studio 2008 的解决方案中，如何使智能感知适用于引用的项目？

> ID：745277
> 
> 赞同：1
> 
> 时间：2009-04-13T20:30:47.370
> 
> 标签：visual-studio-2008, ide

我有一个由 12 个项目组成的 C# 解决方案。一个项目（称为 myControls）是我创建自定义 Silverlight 控件的地方。我在另一个名为 (Viewer) 的项目中使用 myControls 下的一些控件。我已经验证我的命名空间和类名在两个项目下都是正确的。

但是后来我尝试从 myControls 中引用 Viewer 中的两个全新控件，Intellisense 似乎无法识别我的全新控件，尽管它可以看到其他控件。我已经验证我的命名空间在 Viewer 中是正确的，我已经验证了我对 myControls 的引用位于 References 文件夹中。还有什么我需要注意的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T20:57:23.407

如果它是一个全新的项目或新控件，它并不总是构建引用 - 至少对我而言 - 直到项目第一次构建并编译。此外，如果它们有一个支持类，请确保您的控件的链接类之间的命名空间是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T20:35:19.840

检查控件类的访问修饰符：public、private、internal 等。选择您认为更适合的一个，例如使用 public。

此致！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T20:35:59.887

这是什么类型的项目？WinForms 还是 WebForms？
但是您也应该在工具箱中看到您的控件。

还有，为什么这么多项目？这种方法的一个副作用是您的构建会慢得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T20:36:02.147

尝试用控件右键单击项目并选择重建。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T20:44:55.480

您的对象可能是私有的，或者它们没有公共的默认构造函数。

# perl - 是否应该忽略印记与其变量名之间的空格？

> ID：745278
> 
> 赞同：11
> 
> 时间：2009-04-13T20:31:07.683
> 
> 标签：perl

我刚刚发现 perl 忽略了 sigil 和它的变量名之间的空格，并且想知道是否有人可以告诉我这是否是预期的行为。我以前从未遇到过这种情况，它可能会导致字符串内部出现奇怪的行为。

例如，在下面的代码中，$bar 将以值 'foo' 结束：

```
my $foo = 'foo';
my $bar = "$                     foo"; 
```

这也适用于变量声明：

```
my $

bar = "foo\n";
print $bar; 
```

第二种情况对我来说并不重要，但在字符串插值的情况下，这可能会导致非常混乱的行为。有人知道这是什么一回事吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-13T20:38:49.223

是的，它是语言的一部分。不，您不应该将它用于严肃的代码。至于在插值中混淆，所有美元符号（不是变量的一部分）都应该被转义，而不仅仅是字母旁边的那些，所以它不应该是一个问题。

我不知道这是否是在印记和变量名之间允许空格的真正原因，但它允许你做类似的事情

```
my $            count = 0;
my $file_handle_foo   = IO::File->new; 
```

有些人可能认为这很方便（因为它将符号和变量名的唯一部分放在一起）。它对[Obfu](http://www.perlmonks.org/?node_id=45213)也很有用（参见第 9 行的结尾和第 10 行的开头）：

```
#!/usr/bin/perl -w                                      # camel code
use strict;

                                           $_='ev
                                       al("seek\040D
           ATA,0,                  0;");foreach(1..3)
       {<DATA>;}my               @camel1hump;my$camel;
  my$Camel  ;while(             <DATA>){$_=sprintf("%-6
9s",$_);my@dromedary           1=split(//);if(defined($
_=<DATA>)){@camel1hum        p=split(//);}while(@dromeda
 ry1){my$camel1hump=0      ;my$CAMEL=3;if(defined($_=shif
        t(@dromedary1    ))&&/\S/){$camel1hump+=1<<$CAMEL;}
       $CAMEL--;if(d   efined($_=shift(@dromedary1))&&/\S/){
      $camel1hump+=1  <<$CAMEL;}$CAMEL--;if(defined($_=shift(
     @camel1hump))&&/\S/){$camel1hump+=1<<$CAMEL;}$CAMEL--;if(
     defined($_=shift(@camel1hump))&&/\S/){$camel1hump+=1<<$CAME
     L;;}$camel.=(split(//,"\040..m`{/J\047\134}L^7FX"))[$camel1h
      ump];}$camel.="\n";}@camel1hump=split(/\n/,$camel);foreach(@
      camel1hump){chomp;$Camel=$_;y/LJF7\173\175`\047/\061\062\063\
      064\065\066\067\070/;y/12345678/JL7F\175\173\047`/;$_=reverse;
       print"$_\040$Camel\n";}foreach(@camel1hump){chomp;$Camel=$_;y
        /LJF7\173\175`\047/12345678/;y/12345678/JL7F\175\173\0 47`/;
         $_=reverse;print"\040$_$Camel\n";}';;s/\s*//g;;eval;   eval
           ("seek\040DATA,0,0;");undef$/;$_=<DATA>;s/\s*//g;(   );;s
             ;^.*_;;;map{eval"print\"$_\"";}/.{4}/g; __DATA__   \124
               \1   50\145\040\165\163\145\040\157\1 46\040\1  41\0
                    40\143\141  \155\145\1 54\040\1   51\155\  141
                    \147\145\0  40\151\156 \040\141    \163\16 3\
                     157\143\   151\141\16  4\151\1     57\156
                     \040\167  \151\164\1   50\040\      120\1
                     45\162\   154\040\15    1\163\      040\14
                     1\040\1   64\162\1      41\144       \145\
                     155\14    1\162\       153\04        0\157
                      \146\     040\11     7\047\         122\1
                      45\15      1\154\1  54\171          \040
                      \046\         012\101\16            3\16
                      3\15           7\143\15             1\14
                      1\16            4\145\163           \054
                     \040            \111\156\14         3\056
                    \040\         125\163\145\14         4\040\
                    167\1        51\164\1  50\0         40\160\
                  145\162                              \155\151
                \163\163                                \151\1
              57\156\056 
```

# php - 如何在 PHP 中编写正则表达式来删除特殊字符？

> ID：745282
> 
> 赞同：13
> 
> 时间：2009-04-13T20:32:00.147
> 
> 标签：php, regex

我对 PHP 很陌生，我注意到处理正则表达式有很多不同的方法。

这是我目前正在使用的：

```
$replace = array(" ",".",",","'","@");
$newString = str_replace($replace,"_",$join);

$join = "the original string i'm parsing through"; 
```

我想删除不是 az、AZ 或 0-9 的所有内容。我正在寻找上述的反向功能。编写它的伪代码方式是

> 如果 $join 中的字符不等于 az,AZ,0-9 则将字符更改`$join`为`"_"`

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-13T20:35:22.960

```
$newString = preg_replace('/[^a-z0-9]/i', '_', $join); 
```

这应该可以解决问题。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-13T20:35:15.473

不是 az, AZ, 0-9 的任何东西的正则表达式是：

```
preg_replace('/[^a-zA-Z0-9]/', "_", $join); 
```

这被称为[否定字符类](http://www.regular-expressions.info/charclass.html#negated)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-13T20:53:28.457

最简单的方法是这样的：

```
preg_replace('/\W/', '_', $join); 
```

\W 是非单词字符组。单词字符是 az、AZ、0-9 和 _。\W 匹配之前未提及的所有内容*。

编辑：preg 使用 Perl 的正则表达式，记录在[perlman perlre](http://perldoc.perl.org/perlre.html)文档中。

*编辑 2：这假定 C 或英语语言环境之一。其他语言环境可能在单词字符类中有重音字母。Unicode 语言环境只会将低于代码点 128 的字符视为字符。

# iphone - 在 UIImagePickerController 上显示 UIView 以捕获用户触摸

> ID：745284
> 
> 赞同：0
> 
> 时间：2009-04-13T20:32:20.177
> 
> 标签：iphone, cocoa-touch

我有一个问题，我需要将 UIImagePickerController 显示为相机视图并在用户屏幕上捕获滑动。目前我在我的自定义视图控制器中显示 imagePicker，然后为相机调用它的 presentModalViewController。显示相机后，我在顶部插入一个视图以捕捉用户的滑动手势。唯一的问题是这不起作用。没有滑动通过。

当我以模态方式显示控制器时，我会失去捕捉触摸的选项吗？我不想使用任何未记录的 API 来完成这项工作。有人遇到过或遇到过类似的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T14:11:28.467

另一种选择可能是有一个 UIApplication 子类 override `sendEvent:`。我没有尝试过使用图像选择器，但是点击键盘会通过那个特定的漏斗。

也就是说，这两种解决方案（我的和你的）虽然在技术上没有使用未记录的 API，但它们对屏幕上的事物布局或视图层次结构或事件顺序做出了假设。不是我依赖看到跨操作系统版本工作的东西。

# vb.net - 在 VB.NET 中将布尔值转换为整数

> ID：745292
> 
> 赞同：35
> 
> 时间：2009-04-13T20:35:12.977
> 
> 标签：vb.net

采取以下代码：

```
Sub Main()

    Dim i As Integer
    Dim b As Boolean

    i = 1
    b = i
    i = b
    Console.WriteLine(i)

    i = Convert.ToInt32(b)
    Console.WriteLine(i)

End Sub 
```

这将打印以下内容：

```
-1
1 
```

为什么是这样？

（开个玩笑：）你也可以得到 0...

```
Int32.TryParse("True", i)
Console.WriteLine(i) 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-04-13T20:53:01.577

您所看到的是一些遗留代码。

问题的核心是 VT_BOOL 类型。Visual Basic 6.0 使用 VT_BOOL 类型 (AKA VARIANT_BOOL) 作为其布尔值。VARIANT_BOOL 的 True 用具有整数值 -1 的值 VARIANT_TRUE 表示。在转换为[.NET](http://en.wikipedia.org/wiki/.NET_Framework)期间，决定在使用 Visual Basic 转换例程将布尔值转换为整数值时，返回值将保持 Visual Basic 6.0 语义；这将是-1。

第一次隐式转换发生在 b = i 行。在引擎盖下，它执行了从整数到布尔值的隐式转换。任何非零值都被认为是真的，因此结果值是真的。

但是，以下代码行正在执行到整数类型的隐式转换。

```
i = b 
```

在后台，它使用 Visual Basic 转换例程之一（[CType](http://msdn.microsoft.com/en-us/library/4x2877xb%28v=vs.71%29.aspx)或[CInt](http://msdn.microsoft.com/en-us/library/fctcwhw9%28v=vs.84%29.aspx)）将值转换为整数。因此，Visual Basic 语义正在发挥作用，返回的值为 -1。

下一个有趣的线是`Convert.ToInt32()`线。这是使用不使用 Visual Basic 语义的 .NET 转换例程。相反，它返回一个真正的布尔值 1的底层[BCL表示。](http://en.wikipedia.org/wiki/Base_Class_Library)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-04-13T20:41:01.060

有些语言认为布尔真值是-1而不是1。我必须做研究才能知道为什么，因为我不记得了。

在 VB6 中，常量`True`的值为`-1`。

但是，[记录](http://msdn.microsoft.com/en-us/library/2cew9dz7.aspx)为返回“如果值为 true，则返回数字 1；否则返回 0。`Convert.ToInt32(Boolean)`” 这样，无论您使用哪种框架语言，它都是一样的。

编辑：查看问题[boolean true -- 正 1 或负 1](https://stackoverflow.com/questions/727196/boolean-true-positive-1-or-negative-1)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-13T23:34:17.553

至于为什么用-1表示True，我相信是因为它是字面意思（不是0）。

从零开始，翻转所有位，然后将其作为二进制补码读取——结果为负一。

因此，由于任何不是 False 的都是 True，而 False 是 0，所以 (NOT False) 由 -1 表示。

不过，这可能只是巧合......

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-13T20:51:24.373

从 MSDN Visual Basic 文档：

[类型转换](http://msdn.microsoft.com/en-us/library/wts33hb3.aspx)

> 当 Visual Basic 将数值数据类型值转换为布尔值时，0 变为 False，所有其他值变为 True。当 Visual Basic 将布尔值转换为数值类型时，False 变为 0，True 变为 -1。

对于[Convert.ToInt32(value)](http://msdn.microsoft.com/en-us/library/aa325172(VS.71).aspx)：

> 如果值为真，则返回数字 1；否则为 0。

所以对于你的代码：

```
i = 1
b = i // b becomes true
i = b // true = -1
Console.WriteLine(i)  // i is -1

i = Convert.ToInt32(b)  // Convert.ToInt32(true) = 1
Console.WriteLine(i)    // i is 1 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-13T20:41:06.910

这是因为在[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)中，布尔值默认为 -1 表示真，0 表示假。我不知道为什么它第二次打印为 1，虽然......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-07-05T11:38:57.957

“真”是数字数据类型的 0 值的否定！

Not(0) 对于无符号类型返回 1。

Not(0) 对于有符号类型返回 -1。

我不知道你的代码，也许你的代码第二次执行内部数据转换。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-11-20T12:31:08.767

这是一个狡猾的答案，但是：

```
 Dim b As Boolean
    b = False
    Dim i As Integer
    i = IIf(b, 1, 0) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-05T11:24:01.537

所有数字数据类型都可以用作布尔值！结果取决于使用的数据类型。

例子：

```
Dim i As Byte    ' Byte is non-signed!
Dim b As Boolean = True

i = b            ' Set first (lowest) bit of i (non-signed byte)
' i is now binary 0000 0001 = 1!

Dim i As SByte   ' SByte is signed!
Dim b As Boolean = True

i = b            ' Set all bits of i (signed byte)
' i is now FF (binary 1111 1111 = -1 ! 
```

整数是有符号的，True 为 Integer -> -1。

UInteger 是无符号的，对 UInt -> 1 为真。

等等...

假值清除有符号数字中的最高位，以及无符号数字中的最低位。

因此 False 在所有数值数据类型中都是 0。

# asp.net - IIS 7：将所有请求重定向到 Default.aspx

> ID：745306
> 
> 赞同：5
> 
> 时间：2009-04-13T20:36:35.500
> 
> 标签：asp.net, iis, iis-7

我们希望将 ASP.NET 站点中的所有请求重定向到 ~/Default.aspx 以关闭该站点。我们正在使用 IIS7。该站点具有这样的返回页面的路径：

[http://test.com/operating](http://test.com/operating)

我们正在使用 url 重写。我们希望将类似的请求重定向到 ~/Default.aspx

[http://test.com/](http://test.com/) */ [http://test.com/](http://test.com/)* .aspx [http://test.com/](http://test.com/) */* .aspx

我们通常会在 web.config 中使用类似这样的东西：

```
 <customErrors mode="On" defaultRedirect="Default.aspx">
        <error statusCode="404" redirect="Default.aspx" />
    </customErrors> 
```

问题在于它不会像这样重定向文件夹 url

[http://test.com/](http://test.com/) */

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-06-15T16:33:54.400

`App_Offline.htm`您可以在任何 ASP.NET 应用程序的根目录中放置一个名为的文件。这导致接受任何 .NET 页面请求并输出 htm 文件的内容而不是请求的页面。它实际上不是重定向，但它是一种非常简单的方法来关闭整个站点。如果需要，您还可以使用标准元刷新将任何请求发送到新位置（请记住不要对同一站点中的 ASPX 文件这样做）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T20:49:14.330

你试过[HttpRedirect](http://www.iis.net/ConfigReference/system.webServer/httpRedirect)吗？不过，您必须先安装该功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-10T23:29:30.700

如果不再存在文件，您可以执行此操作。

```
 <system.webServer>
    <httpErrors errorMode="Custom">
        <remove statusCode="404" subStatusCode="-1" />
        <error statusCode="404" prefixLanguageFilePath="" path="/Default.aspx" responseMode="ExecuteURL" />
    </httpErrors> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-15T16:45:25.737

我会在 Global.asax 中写这样的东西（请注意，这只是一个示例，不是生产就绪代码）：

```
Application_BeginRequest(object sender, EventArgs e) {
    if(!Request.Url.ToString().ToLowerInvariant().Contains("default.aspx")) {
        Response.Redirect("Default.aspx");
    }
} 
```

还要考虑当应用程序在集成模式下运行时，此代码将中断非 ASP.NET 请求（在其他情况下，它甚至会重定向对图像等的请求）。

# javascript - 原型选择所有复选框代码适用于 IE，但不适用于 Firefox

> ID：745307
> 
> 赞同：1
> 
> 时间：2009-04-13T20:36:39.353
> 
> 标签：javascript, internet-explorer, firefox, prototypejs

我正在使用原型 1.6.0.1。单击按钮时，我试图选择所有复选框。此代码适用于 IE 6，但不适用于 Firefox 3。我做错了什么？

```
<input class="submit" type="button" value="check all" onclick="$(this.form).getInputs('checkbox').each(function (elem) {elem.checked = true;});" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T01:21:46.267

我创建了一个非常基本的页面来测试您的问题：

```
<html>
<head>
    <script type="text/javascript" src="prototype-1.6.0.3.js" ></script>
</head>
<body>
    <form>
        <input type="checkbox" id="test1" /> Test 1<br/>
        <input type="checkbox" id="test2" /> Test 2<br/>
        <input type="checkbox" id="test3" /> Test 3<br/>
        <input type="checkbox" id="test4" /> Test 4<br/>
        <input class="submit" type="button" value="check all" onclick="$(this.form).getInputs('checkbox').each(function (elem) {elem.checked = true;});" />
    </form>
</body>
</html> 
```

＆它在 Firefox 3.0.8（以及 IE）中对我来说很好用......

我不同意其他答案... this.form 应该没问题（从提交按钮获取表单对象，然后应该让您通过 getInputs 从中获取复选框）。

实际问题是什么？什么都没有发生？如果是这样，我唯一能想到的是，复选框是否与按钮的形式相同？

**编辑：**如果您的代码实际上与上面的代码相同并且它不起作用，我可以建议的最好的方法是将您的 onclick 变成一个propper函数调用，然后使用[firebug](http://getfirebug.com/)来确定哪个特定位不起作用。即让你的代码看起来像这样：

```
<html>
<head>
    <script type="text/javascript" src="prototype-1.6.0.3.js" ></script>
    <script type="text/javascript" >
        function checkAll(button) {
            var form = $(button.form);
            var inputs = form.getInputs('checkbox');
            inputs.each(function (elem) {
                elem.checked = true;
            });
        }
    </script>
</head>
<body>
    <form>
        <input type="checkbox" /> Test 1<br/>
        <input type="checkbox" /> Test 2<br/>
        <input type="checkbox" /> Test 3<br/>
        <input type="checkbox" /> Test 4<br/>
        <input class="submit" type="button" value="check all" onclick="checkAll(this)" />
    </form>
</body>
</html> 
```

然后您可以在函数中放置断点并确保“按钮”、“表单”和“输入”是您期望的，并且每个循环中的“元素”也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T21:00:14.493

表单是输入的父级，所以 this.form 应该没有意义。使用 ID 选择器或父级。

第二件事 - 声明这个 js 来分配文档加载操作，这种方式有点混乱，将 js 与 html 分开以获得干净灵活的代码库。

在 jQuery 中，它会是这样的：

```
$(document).ready(function(){
  $.('#submitId').click(function(){ 
    // check the checkboxes
    });
} 
```

在原型中应该是相似的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T20:27:52.607

您可以在此链接中看到解决方案： [http ://www.ryboe.com/2008/07/10/select-all-checkboxes-with-prototype-js.html](http://www.ryboe.com/2008/07/10/select-all-checkboxes-with-prototype-js.html)

如果你不想点击，试试这个：

```
var form = $('options');
checkboxes = form.getInputs('checkbox');
checkboxes.each(function(e){ e.checked = 0 }); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-13T20:40:15.197

你换什么

```
$(this.form) 
```

和

```
$('MYFORMNAME') 
```

?

# asp.net-mvc - 我必须预编译 asp.net mvc 应用程序吗？

> ID：745312
> 
> 赞同：1
> 
> 时间：2009-04-13T20:37:55.827
> 
> 标签：asp.net-mvc

在 WebForms 中，我们可以将编译保留到 IIS 中的第一个请求。然后编译它并提供请求。

在 ASP.NET MVC 中我可以做同样的事情，还是我必须预编译应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T20:39:50.063

如果你不想，你不需要预编译。ASP.NET MVC 只是现有 ASP.NET 结构的包装器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T20:42:34.177

是否要使用[预编译工具](http://msdn.microsoft.com/en-us/library/ms229863(VS.80).aspx)来加快第一个请求的速度取决于您。应用程序是 Webforms 还是 MVC 都没有关系。

# asp.net - 更改为在动态数据中生成网格视图而生成的 Select 语句？

> ID：745319
> 
> 赞同：1
> 
> 时间：2009-04-13T20:39:49.470
> 
> 标签：asp.net, linq-to-sql, dynamic-data

我正在使用 ASP.net 动态数据脚手架。我意识到对于像这样的桌子

表 1：EducationLevel (id,levelname,modby,modon)

table2: Course(id,coursename,modby,modon,belongsToEduLevel)

其中belongsToEduLevel 是FK。在这种情况下，动态数据永远不会在网格中显示 levelname，而是显示

运营 | 摩登 | 教育项目

我该如何改变这个？我可以修改生成的选择语句吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T12:32:36.083

如果我对您的理解正确，您希望显示的列不显示，您希望显示 FK 列而不是文本值？

如果是这样，您只需将 DisplayColumn 应用于 FK 引用的表，然后选择 PK 作为您要显示的列。

即[DisplayColumn("Id")]

Id 是要在 FK 关系和过滤器中显示的列的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T21:25:52.100

如果您尚未为课程创建自定义类，请创建以下内容：

```
[ScaffoldTable(true)]
[MetadataType(typeof(CourseMetaData))]
public partial class Course
{

}
[DisplayName("Courses")]
public class CourseMetaData
{
    [DisplayName("Course ID")]
    public object CourseID { get; set; }

    [DisplayName("Course Name")]
    public object CourseName { get; set; }

    [DisplayName("Modified By")]
    public object ModifiedBy { get; set; }

    [DisplayName("Modified By")]
    public object ModifiedBy { get; set; }

    [DisplayName("Modified On")]
    [DisplayFormat(DataFormatString = "{0:MM-dd-yyyy}")]
    public object ModifiedOn { get; set; }

    [DisplayName("Level Name")]
    public object EducationLevelName { get; set; }

} 
```

如果你没有一个教育水平，抓住这个：

```
[ScaffoldTable(true)]
[DisplayColumn("EducationLevelName")]
[MetadataType(typeof(EducationLevelMetadata))]
public partial class EducationLevel : INotifyPropertyChanging, INotifyPropertyChanged
{

}

[DisplayName("Education Levels")]
public class EducationLevelMetadata
{
    [DisplayName("Education Level ID")]
    public object EducationLevelID { get; set; }

    [DisplayName("Education Level Name")]
    public object EducationLevelName { get; set; }

    [DisplayName("Education Level Modified By")]
    public object EducationLevelModBy { get; set; }

    [DisplayName("Education Level Modified On")]
    [DisplayFormat(DataFormatString = "{0:MM-dd-yyyy}")]
    public object EducationLevelModOn { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T07:28:51.027

如果这不是你想要的，你可以覆盖 ToString() 方法，它可以让你显示一个计算值：

```
[MetadataType(typeof(Message_MD))]
public partial class Message
{
    public override String ToString()
    {
        return MessageID.ToString() + ", " + Subject;
    }
    public partial class Message_MD
    {
        public object MessageID { get; set; }
        public object Subject { get; set; }
        public object Body { get; set; }
        public object SMSBody { get; set; }
    }
} 
```

在这里，我显示了 PK Id 和一些文本

即12，测试消息

希望这会有所帮助：D

# flash - 动作脚本中的矩阵文本样式

> ID：745320
> 
> 赞同：0
> 
> 时间：2009-04-13T20:39:49.657
> 
> 标签：flash, actionscript-3, text, motion

我在 AS3 中工作，我想知道是否有人知道如何在动作脚本中创建矩阵效果（电影中移动的绿色文本行）。我在网上找到了一些例子，但似乎没有一个有效。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T20:42:08.793

源代码有很大的效果：

[http://www.bherholz.com/experiments/matrix/](http://www.bherholz.com/experiments/matrix/)

# java - 如何分析简单的英语句子

> ID：745334
> 
> 赞同：11
> 
> 时间：2009-04-13T20:44:28.663
> 
> 标签：java, nlp

有没有可用于分析（nlp）简单英文文本的库。例如，如果能做到这一点就完美了；输入：“I am going” 输出：I, go，现在进行时

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T20:50:47.743

[自然语言工具包](http://www.nltk.org/)怎么样？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T20:50:00.023

[在这里](http://nlp.stanford.edu/software/index.shtml)试试斯坦福的 NLP 资料。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T20:52:47.397

词性在文本到语音引擎中通常很有用。确定发音的部分过程需要知道词性：

> 铅管把侦探引向了剧中的主角。

我知道有几个解析器可以作为[Festival Project](http://www.cstr.ed.ac.uk/projects/festival/)的一部分。本文可能[会对](http://www.vinartus.net/spa/95a.pdf)所使用的技术提供一些见解。与其他一些语言相比，英语非常温和，所以要做好挣扎的准备。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T20:52:39.317

我发现[链接语法](http://www.link.cs.cmu.edu/link/)非常有趣。看看这个！

# xslt - 如何使用 xsl 更改元素中的文本

> ID：745337
> 
> 赞同：4
> 
> 时间：2009-04-13T20:44:55.090
> 
> 标签：xslt

如何在不丢失子元素的情况下对元素中的文本应用更改。

例如：

我有这个 xml，我想对“p”元素内的文本进行更改....

```
<section>
    <p >Awesome LO</p>
    <p >
        Begin with an interesting fact, thought-provoking
        <keyword>question</keyword>
        <context>
            <p type="Key Words Head">Banana</p>
            <p type="Key Words">A tasty treat to eat any time, and good with ice cream – a banana split.</p>
        </context>, or a one sentence scenario to illustrate why the learning object (content) is important.
    </p>
    <p >
        Begin with a definition, if required. Then, provide an example by example view.
    </p>
</section> 
```

所以我的xsl看起来像这样......

```
<xsl:template match="p">
    <xsl:copy>
        <xsl:call-template name="widont-title">
            <xsl:with-param name="text" select="text()" />
        </xsl:call-template>
    </xsl:copy>
</xsl:template> 
```

问题是当我这样做时，我丢失了“p”内的“关键字”、“上下文”和其他元素。谁能指出我的任何线索？谢谢！

```
<!-- this method puts a non breaking space in the last word of a 'p' if its less than 5 characters-->
<xsl:template name="widont-title">
    <xsl:param name="temp"/>
    <xsl:param name="text"/>
    <xsl:param name="minWidowLength" select="5"/>

    <xsl:choose>
        <xsl:when test="contains($text, ' ')">
            <xsl:variable name="prev" select="substring-before($text,' ')"/>
            <xsl:variable name="before" select="concat($temp,' ',$prev)"/>
            <xsl:variable name="after" select="substring-after($text, ' ')"/>

            <xsl:choose>
                <xsl:when test="contains($after, ' ')">
                    <xsl:call-template name="widont-title">
                        <xsl:with-param name="temp" select="$before"/>
                        <xsl:with-param name="text" select="$after"/>
                    </xsl:call-template>
                </xsl:when>
                <xsl:when test="not(contains($after, ' ')) and string-length(translate($after,'`~!@#$%^\*()-_=+\\|]}[{;:,./?&lt;&gt;','')) &lt; $minWidowLength">

                    <xsl:value-of select="concat($before, '&#160;', $after)" />
                </xsl:when>
                <xsl:otherwise>
                    <xsl:value-of select="concat($before, ' ', $after)" />
                </xsl:otherwise>
            </xsl:choose>
        </xsl:when>
        <xsl:otherwise>
            <xsl:value-of select="$text"/>
        </xsl:otherwise>
    </xsl:choose>
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T23:03:03.107

目前尚不清楚**`widont-title`**模板做了什么以及是否正确实现（看起来有点太复杂），**但问题是这个模板应用得太早了，没有留下任何`p`待处理的子元素的可能性。**

**解决方案（使用*[标识模板](http://www.w3.org/TR/xslt#copying)*并为节点覆盖它`p/text()`）非常简单**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes"/>
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>
    <xsl:template match="p/text()">
        <xsl:call-template name="widont-title">
            <xsl:with-param name="text" select="." />
        </xsl:call-template>
    </xsl:template>

         <!-- "widont-title" template omitted for brevity -->

</xsl:stylesheet> 
```

**当对提供的 XML 文档应用上述转换时，任何`p`元素的子元素都会正确地出现在输出中**。

# windows - 可执行文件的名称中是否应该包含版本号？

> ID：745339
> 
> 赞同：3
> 
> 时间：2009-04-13T20:45:30.673
> 
> 标签：windows, naming-conventions, versioning

我开发了某个服务器。到目前为止，无法同时安装两个版本。我们现在正在改变它，问题出现了：版本号是否应该附加到服务器组件？服务器包含 3 个 exe 和 5 个 dll（一些 COM，一些本机 VC++）。是否应该有任何或全部的名称包含版本（*Serv71.exe*，*module71.dll*）？

在专业方面，它应该使管理服务器更容易一些。如果某个实例行为不端，它将在任务管理器中被识别。此外，糟糕的安装不可能以混合组件版本而告终，而不会被注意到。

不利的一面是，它会使开发变得更加困难。服务器不是一个独立的产品，而是我们应用程序基础设施的一部分。这意味着它获取主应用程序的版本。鉴于此，即使某个组件在版本之间根本没有更改，它也必须获得不同的名称。

总而言之，这不是一个关键问题。我们可能可以同时兼顾这两种方式。话虽如此，我可能错过了支持其中一种策略的赢家论点。常见的选择是什么？你做什么工作？

**编辑：**我熟悉 COM 和文件元数据版本控制，并且同意文件名版本控制是多余的。我试图弄清楚什么更重要 - 持续的冗余开销，或维护方面的罕见收益。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T20:59:23.933

通常版本信息是 DLL 的元数据（文件扩展信息）的一部分，而不是文件名的一部分。

维护过程更容易。当您升级/替换现有的二进制文件时，安装程​​序知道如何使用该信息。如果您需要发布新版本的 DLL，则无需重新编译/重新链接您的 exe。

作为一般准则——不要试图发明新的机制。使用现有的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T21:05:07.117

对于 COM API，您的库中确实拥有所需的所有版本信息。我发现用版本号命名这些 DLL 充其量是多余的，最坏的情况是令人困惑（至少在版本号不同步的情况下）。每当我想要一个清晰的升级路径并防止任何更改时，我都倾向于将版本标识符附加到接口和 coclass 名称中。

对于普通的二进制 DLL API，附加版本号是一种想法，但我从未见过执行得很好（并且在那些旧的 16 位 VB 运行时 DLL 中执行得非常糟糕！）。他们是否有明确和分隔的 API，或者他们是否公开了几十个函数？如果接口很大，您将难以区分次要更改和重大更改。一旦您开始以这种方式标记版本，您就必须保持一致。每次版本更改都意味着必须重新编译静态链接的客户端（因此重新标记自己的版本）。这里的潜在问题是你会得到很多**“版本噪音”**，隐藏了重要的变化。

Windows 二进制文件包含版本元数据（[VERSIONINFO](http://msdn.microsoft.com/en-us/library/aa381058.aspx)结构）。正如 LeJeune 所说，这是一条众所周知的路线，尽管当您将错误的东西链接在一起时，它不会自动导致错误。但是，您可以相对轻松地利用它来支持您需要的任何配置管理模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T20:51:23.250

我会说如果 DLL 在不同版本中提供不同的 API，版本号应该附加到文件名中。对于可执行文件没关系。如果可执行文件使用指定的接口进行交互，并且发生了变化，我还会在可执行文件的文件名中使用版本号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T20:53:33.963

**“不利的一面是，这会使开发变得更加困难。”**

不完全正确。它暴露了您已经遇到的一个问题——保持所有组件的所有版本一致。

您必须确保应用程序基础架构作为一个整体具有所有组件的所有正确版本。

通过适当地标记每个部分并提供配置报告来说明哪些版本是最新的以及哪些版本必须一起使用，从而使这*变得更容易。*

# .net - SQL Server 视图可以有主键和外键吗？

> ID：745341
> 
> 赞同：9
> 
> 时间：2009-04-13T20:46:22.403
> 
> 标签：.net, sql-server, entity-framework, database-design, ado.net-entity-data-model

是否可以在 Microsoft SQL Server Management Studio 中为数据库视图定义主键和外键？如何？

我正在尝试创建一个 ADO.NET 实体数据模型来读取四个我无法修改的旧的、格式不正确的数据库表。我只创建了我需要的数据的视图。

这四个视图应映射到具有多对多关系的简单三实体 EDMX。

创建数据模型时出现此错误：

> 表/视图“...”没有定义主键，并且无法推断出有效的主键。此表/视图已被排除。要使用实体，您需要查看架构，添加正确的键并取消注释。

它正确地推断出两个视图的主键。但其他两个都没有这样做。

我的问题视图之一使用聚合函数：

```
SELECT MAX(...) ... GROUP BY ... 
```

另一个应该有两个外键的复合主键。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T20:53:01.640

您需要定义您的视图，以便它：

*   包括所有`PRIMARY KEY`列
*   不使用`JOIN`任何
*   不使用任何聚合函数`UNION`或

您视图中的任何行都应映射到表中的一行。

> 我的问题视图之一使用聚合函数

它不能更新。对于只读实体，[**这里**](http://social.msdn.microsoft.com/Forums/ru-RU/adodotnetentityframework/thread/39fcc904-23b7-45c9-a2c8-7fe7a4a403c4)的解决方案：

> 如果无法推断出任何键，则会将包含相应 EntityType 元素（没有 Key 元素）的代码注释添加到 .edmx 文件的 SSDL 部分。
> 
> 在您的情况下，由于您似乎想要一个只读实体，您可以：
> 
> 1.  取消注释 SSDL 实体
>     *   将一个/一些属性标记为 Nullable="False"
>     *   添加适当的 Key 元素
>     *   添加相应的定义查询。

对于第二个问题：

> 另一个应该有两个外键的复合主键

从[**文档**](http://msdn.microsoft.com/en-us/library/bb399596.aspx)：

> 表示数据库中两个表之间的多对多关系的表在概念模式中可能没有等效实体。当`EDM`工具遇到这样的表除了两个外键之外没有其他列时，映射表在概念模式中表示为多对多关联而不是实体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-11T15:13:36.800

`NOT NULL`您可以通过在视图中创建索引列来更改视图，如下所示：

```
ALTER VIEW [dbo].[ViewName]
AS
    SELECT  ISNULL(CAST(CASE ROW_NUMBER() OVER ( ORDER BY columnNames )
                          WHEN ROW_NUMBER() OVER ( ORDER BY columnNames )
                          THEN ROW_NUMBER() OVER ( ORDER BY columnNames )
                          ELSE 0
                        END AS INT), 0) AS ID 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-12-10T14:52:53.167

实际上，您可以创建一个使用 JOIN 的视图并从中生成模型中的实体。

# web-applications - 如何存储每个用户的参数 - 征求意见

> ID：745342
> 
> 赞同：0
> 
> 时间：2009-04-13T20:46:30.250
> 
> 标签：web-applications, parameters

抱歉，这是一个非常开放的问题！

我希望让我网站上的用户能够修改他们用于个人资料的模板的 html/css 参数 - 有点像 myspace（真的，真的很抱歉以它为例......）。

• 有一个可供用户选择的“主题”库• 有些主题可以定制有些不能定制• 主题不一定具有相同的可定制参数

我想为每个用户存储他们选择自定义的每个主题的自定义变量。最好的格式是什么？

数据库可能有

```
--------------------------------------
user id | theme id | custom parameters
-------------------------------------- 
```

我怎么能存储像 bg color = #34ed55 bg image = bg.jpg font = comic sans color = 554323 css = h1{ font-size:1em; 颜色：蓝色；} .customCss{ 填充：10px; }

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T20:54:20.480

如果参数都是相同的类型（例如字符串值），您可以有一个单独的参数表来映射代表用户主题属性的键/值对。

```
user_theme
    user_id
    theme_id

user_theme_parameters
    user_id
    key
    value 
```

该表可能喜欢：

```
user_id  key      value
1        bgcolor  #000000
1        bgimage  bg.jpg
2        font     Arial 
```

如果主题共享公共键，您可以将参数键分解到另一个表中，并在此处通过 ID 引用它们，而不是复制键字符串（例如“bgcolor”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T21:15:13.147

您可以使用下表：

```
custom_param: 
    param_id
    theme_id
    param_name
user_params: 
    user_id
    param_id
    value
user_settings:
    user_id
    ...        -- whatever other user settings you store
    theme_id   -- for current theme 
```

使用此方法可以从级联删除中获得一些良好的行为。如果一个参数不再存在，那么您只需从 custom_param 中删除它，viola 它将从用户的设置中删除。如果要删除整个主题，它将级联到 custom_param 并删除所有相关参数，然后删除所有相关 user_params。

只需确保设置您的 user_settings 表，以便在删除主题时将 theme_id 设置为某个默认主题并且不会删除该行！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T21:44:57.927

您可以创建一个包含自定义参数的类，并将该类的序列化版本存储在表的 CustomParameters 字段中。在我的例子中，我扩展了现有的 Users 类以在我的 UserCustomParameters 类中获取和设置值。

这样做的好处是，一旦它到位，我就不必修改我的数据库。

当然，您必须决定某些内容是否重要以在表中需要其自己的字段。对我来说，简单的用户设置，比如那些控制外观和感觉的设置，不需要自己的字段。

正确序列化和反序列化类是最耗时的部分。

# .net - DDD、NHibernate 和项目结构/命名

> ID：745343
> 
> 赞同：7
> 
> 时间：2009-04-13T20:47:15.273
> 
> 标签：.net, nhibernate, naming-conventions, domain-driven-design, projects-and-solutions

对于使用 NHibernate 并尝试引入一些 DDD 概念的 WebForms 解决方案，您推荐什么作为正确的项目结构？

假设根命名空间和解决方案名称是 Sample

*   Sample.Domain - 包含我的域对象和我的映射文件
*   Sample.Repositories - 包含我的存储库和 nhibernate 连接配置文件
*   Sample.Business - 包含我的业务逻辑
*   Sample.Web - 实际的 WebForms 项目 - 所有 Presentation

我忘记了什么？有没有更标准的方式来命名这些？
关于这个主题的任何伟大的博客文章？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T22:24:55.863

缺少的一些部分似乎是整个解决方案和测试项目所需服务的中心位置。我通常有这样的事情：

*   Sample.Core - 需要跨应用程序使用的服务和代码
*   Sample.Data - 领域类和存储库接口
*   Sample.Data.NHibernate - 映射文件、流利的配置等和存储库实现，基本上是任何特定于数据映射层的东西
*   Sample.Services - 服务实现和接口
*   Sample.Web - 网络应用程序

我有一个匹配的测试项目树：

*   测试\Sample.Core.Tests
*   测试\Sample.Data.NHibernate.Tests
*   ETC...

当然，根据项目的不同，树会变得更加复杂。至于讨论，请查看[Onion Architecture](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)。您还可以查看[领域驱动设计](http://www.domaindrivendesign.org/)上的示例项目，看看您可以从中获得什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T22:24:05.197

我发现每个人对命名都有自己的喜好，我更喜欢：

*   Sample.Domain - 域对象，映射文件
*   Sample.Services - 业务逻辑和服务（以及存储库，虽然我可以看到将它们分开）
*   Sample.Web - 网络资料。
*   Sample.Migrations - 数据迁移。

Ben Scheirman 最近还发布了关于此的文章：[Exporting Visual Studio Solutions with Solution Factory](http://benscheirman.com/2009/04/exporting-visual-studio-solutions-with-solutionfactory)。

他使用了不同的结构，但也包含了一种标准化模板的好方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T02:47:42.427

我保持简单，倾向于按命名空间而不是按项目进行隔离，尤其是在开始时。我通常从解决方案中的三个项目开始：

*   Sample - 包含命名空间 Sample.Model、Sample.Model.Mappings 和 Sample.Services。
*   Sample.Tests - 包含单元测试，其结构与 Sample 相同。
*   Sample.Web - 用户界面

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-30T08:25:45.170

[您可以在s#arp architecture](https://github.com/sharparchitecture/Sharp-Architecture)中看到它是如何完成的。它是一个非常坚实的架构框架

# jquery - 不在实例之间共享其配置的 jquery 插件

> ID：745354
> 
> 赞同：0
> 
> 时间：2009-04-13T20:51:20.490
> 
> 标签：jquery, oop, jquery-plugins

我正在使用一个看起来像这样的 jquery 插件：

```
(function($){
    var options;
    $.fn.main(opts){
        options = opts;
        //rest of code
    }
    $.fn.otherFunc(){
        //does something with options
    }
}(jQuery)); 
```

这里的问题是，如果我在页面上使用此插件 5 次，选项变量将被覆盖，因此所有 5 个实例共享这些选项。这很糟糕，我希望每个插件实例都有自己的配置。

有没有一种非 hackish 的 jQuery 方法来实现这一点？

**编辑：**

我应该补充一点，我会考虑在 $.fn.main 中为 $(this) 添加选项，作为一个有点骇人听闻的扩展，因为 $.fn.otherFunc 可能不会在主函数的 $(this) 上调用，所以我不会可以访问我的东西！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T20:59:00.737

如果您将相同的插件应用于这样的几个元素

```
$("#div1, #div2, #div3, #div4, #div5").main(opts); 
```

您应该使用不同的选项将其拆分为 5 个不同的调用 - 即：

```
var opts1 = {...};
$("#div1").main(opts1);

var opts2 = {...};
$("#div2").main(opts2);

// etc. 
```

此外，添加一个参数`$.fn.otherFunc`来接收它应该处理的选项对象。

**编辑：**如果你不是`otherFunc`从内部打电话`main()`，你应该考虑为什么你在他们之间共享选项。在这种情况下，如果您发布您的原始问题（即您试图解决的现实问题），我们可能会提供比拥有两个不同的插件共享选项而不是将它们合并为一个更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T21:06:02.233

您的示例中给出的代码有语法错误，我猜这会更好：

```
(function($){
    var options;
    $.fn.main = function(opts){
        options = opts;
        //rest of code
        alert(options.text);
    }
    $.fn.otherFunc = function(){
        //does something with options
    }
})(jQuery);

$('a:first').main({text:'txt'});
$('a:last').main({text:'some other text'}); 
```

在您的代码中，我建议将选项数据添加到 DOM 元素本身以跟踪选项，毕竟这是“行为”所针对的地方，因此将其保留在那里是很自然的，而不是在单独的对象中.

*   [http://addictedtonew.com/archives/414/creating-a-jquery-plugin-from-scratch/](http://addictedtonew.com/archives/414/creating-a-jquery-plugin-from-scratch/)
*   [http://net.tutsplus.com/videos/screencasts/you-still-cant-create-a-jquery-plugin/](http://net.tutsplus.com/videos/screencasts/you-still-cant-create-a-jquery-plugin/)

# php - 以 mvc 模式传递变量

> ID：745357
> 
> 赞同：5
> 
> 时间：2009-04-13T20:51:28.197
> 
> 标签：php, model-view-controller, design-patterns, zend-framework, variables

我在 PHP 中构建了一个符合 mvc 模式的系统。控制器和操作是我的应用程序中 url 的一部分。所以我有：

www.example.com/controller/action/

所以现在我正在寻找一种传递变量的方法。对于表单，我只使用 post 方法，但有时我只想链接到不同的页面，然后传递一些变量。

我想就如何做到这一点提出一些建议。我知道 Zend 框架在控制器中使用“/”字符作为分隔符的操作之后将变量作为键/值对，如下所示：

www.example.com/controller/action/var1/value1/var2/value2

这是最好的方法吗？这实际上是我知道它完成的唯一方法。我正在寻找一种简单但又很好的方法来实现它。

欢迎任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-13T21:36:47.417

像 CodeIgniter 这样的框架可以让你将变量传递给控制器​​，而不需要透露变量名——

```
/controller/action/foo/bar/ 
```

将被处理为：

```
function action( $id, $value){
  echo $id; // outputs 'foo'
  echo $value; // outputs 'bar'
} 
```

[http://codeigniter.com/user_guide/general/controllers.html](http://codeigniter.com/user_guide/general/controllers.html)

我喜欢这个，因为它可以让你控制你的控制器将接受多少参数，如果某些变量从不使用很重要，你可以适当地进行逻辑或重定向。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T21:36:41.020

`var1/value1/var2/value2`确实不是最好的方法，它滥用了 MVC`controller/action/id`结构。您需要重新考虑您的设计，使用 POST 或查询参数。您很可能可以重做设计，例如，如果您有

```
/search/type/movie/format/divx/year/2000 
```

你可以重做

```
/movie/divx?year=2000 
```

因此，您的`movie`控制器将搜索`divx`格式电影，然后可能使用帮助程序或过滤器或客户端脚本仅显示匹配年份 == 2000 的电影。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T21:05:45.197

您可以选择通过 GET 或 POST 传递变量。

GET 将以漂亮的格式将变量附加到 URL

```
 /controller/action/var1/value1/var2/value2 
```

或传统方式

```
 /controller/action/?var1=value1&var2=value2 
```

在前一种情况下，您仍然需要编写 Apache 重写规则以从 URL 中提取变量并使用正确的变量集作为 $_REQUEST 的一部分路由到控制器/操作。

如果您使用 POST，则可以向每个表单添加隐藏值，作为传递变量的一种方式。

对于您不希望公开的变量，您可以使用[Sessions](http://us.php.net/session)将它们存储在服务器端。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T21:08:17.890

您还可以像这样执行 GET 查询：

www.site.com/controller/action?var1=value1&var2=value2

这些将显示在 $_GET 超全局中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T22:24:46.177

Depending on your project, you might also try setting and reading values using PHP sessions. These values don't have to be passed from script to script as GET or POST values. One down-side (or up side) is that the variables cannot simply be passed as part of the URL (or bookmarked).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-13T22:44:00.467

I'd avoid the key/value Zend style approach you mentioned before. The problem is it becomes trivial to create two different URLs

```
http://www.example.com/controller/action/var1/value1/var2/value2 
http://www.example.com/controller/action/var2/value2/var1/value1 
```

that point to the same resource. While this works, part of the success of MVC style frameworks for web applications is they make it easier to provide a clean URL structure, and to associate a single URL on your site with every resource. The var1/value1/var2/value2 approach offers little advantage over key/value query strings.

The approach I'd take here is to eschew keys, and just just use values

```
http://www.example.com/example/list/value1/value2/value3 
```

which will be passed into the action method as an array

```
class example extends Controller{ 
    public function list($args){
        //$args[0] = 'value1';
        //$args[1] = 'value2';      
        //$args[2] = 'value3';              
    }
} 
```

By doing it this way, you're leaving it up to the end users of your system to decide how they want to handle $GET style variables, while encouraging a design that leads to cleaner, more stable, single resource URLs.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-14T00:33:01.377

我喜欢在我的 CakePHP 项目中使用的是“命名参数”。基本上，我的 URL 如下所示：

```
http://example.com/controller/action/param1:value1/param2:value2 
```

[您可以在Cake 的手册](http://book.cakephp.org/view/541/Named-parameters)中看到更多示例。我不知道你的框架是否支持这个（或 Zend），但如果面包师做到了，它是*可以*做到的。:-)

# ruby-on-rails - 学习从头开始创建 Rails 应用程序？

> ID：745358
> 
> 赞同：-2
> 
> 时间：2009-04-13T20:51:35.137
> 
> 标签：ruby-on-rails, ruby, project-management

我已经使用 Ruby on Rails 完成了一些工作，但仍然不习惯从头开始编写 Rails 应用程序。我的问题是，在尝试从头开始编写应用程序时，我无法理解如何获得正确的模型。我认为查看完整现有应用程序的代码可能会有所帮助，但不确定。我应该怎么走？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-13T20:56:53.033

获取《[使用 Rails 进行敏捷 Web 开发](http://www.pragprog.com/titles/rails3/agile-web-development-with-rails-third-edition)》一书。它通过一个完整的例子。在学习 RoR 时，这对我很有帮助。提供 PDF 和硬拷贝。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T11:19:17.843

除了获得书籍、观看屏幕录像、阅读[Rails 指南](http://guides.rubyonrails.org/)之外，您还需要真正地制作自己的东西。

接受这一点：你会犯错误。没关系，其他人也会犯错。你会创建错误的模型，创建错误的方法，错误的表和错误的列，这也没关系。你会尽力而为，你会变得更好。随着您的理解——或者 Rails 和你的应用程序——的改进，你会看到你在哪里犯了错误并且你会修复它们。（否则你会放弃！）

如果您不知道首先要构建什么模型，请尝试以下操作：按照您目前的理解编写一个简短的应用程序描述。最多三四句话。然后查看您的描述并选择似乎最重要的“事物”。尝试制作你的第一个模型。

所以对于一个博客（叹息）应用程序，你可能会写这样的东西（它不一定是完美的，只需要写*一些东西*）：

“这个应用程序让我可以写博客文章并发布它们。读者可以发表评论。我可以删除我不喜欢的评论”。

最重要的“对象”可能是“帖子”。所以从

```
ruby script/generate model Post 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T21:24:43.670

我支持这本书的选择，我还建议您查看以下资源：

[PeepCode Screencasts](http://www.peepcode.com) Peepcode 不是免费的，但 Geoffrey 有一些非常棒的 Rails 截屏视频，包括一系列旨在开始使用 Rails 的视频，非常值得投资。

[Railscasts](http://www.railscasts.com)这些是关于各种特定于 Rails 主题的免费截屏视频，当您想了解如何在应用程序中执行特定操作时，它们将是一个很好的资源。

我还要说，当你学习 Rails 时，你只会在你需要专注于学习 ruby​​ 之前做到这一点。如果您来自另一种非动态语言，Rails 会利用一些您可能不熟悉的 ruby​​ 功能。因此，值得查看一些 ruby​​ 学习资源，这本书非常适合同时学习 rails 和 ruby​​：[David Black 的 Ruby for Rails](https://rads.stackoverflow.com/amzn/click/com/1932394699)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-13T11:53:41.310

学习一件事最好的方法就是实践它。想一个好的项目（不一定是有用的，只是一些有趣的），然后就去做。不要为细节操心。

It doesn't matter if it doesn't work; Just throw it away and start again. With each new iteration/project you will learn and remember more.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T14:45:16.100

从小做起，做一些简单的事

待办事项列表 一个简单的博客 twitter 克隆 (lol)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T14:49:51.567

我会说使用 Rails 进行敏捷 Web 开发是最好的选择。版本3最近发布了

然后尝试创建一个简单的应用程序，如果你找到更好的方法来设计你的应用程序，不要害怕从头开始几次

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T16:35:31.577

有一个很好的关于 Restful Rails 应用程序的免费在线教程@http [://www.b-simple.de/documents](http://www.b-simple.de/documents) 此外，它的英文、德文和西班牙文，价格相同！

它清晰有效。它有一些错误，但没有阻止......

# c# - System.Configuration 的线程安全使用

> ID：745384
> 
> 赞同：9
> 
> 时间：2009-04-13T21:00:02.323
> 
> 标签：c#, .net, multithreading, system.configuration

是否有一种简单的方法可以通过线程安全的接口访问基于 System.Configuration 的自定义配置数据，而不需要每个执行上下文加载/重新加载配置信息，这将是计算上的负担？

System.Configuration 类与 Microsoft .Net 库文档中的大多数（全部？）其他类一样，都使用以下线程安全信息进行注释：

> 此类型的任何公共静态（在 Visual Basic 中为 Shared）成员都是线程安全的。不保证任何实例成员都是线程安全的。

根据我的阅读，从和其他类似方法（例如）`ConfigurationSection`返回的对象不能被假定为线程安全的，因此不应被多个执行上下文使用。这禁止将 a 存储在原本是线程安全的单例中，因为虽然对部分对象的访问可能是安全的，但对象本身的成员并不安全。`ConfigurationManager.GetSection(string)``OpenExeConfiguration(string exePath).GetSection(string)``ConfigurationSection`

然而，多次调用`GetSection`可能需要重新解析配置文件并分配`ConfigurationSection`具有高开销的新实例，考虑到配置在初始化后不太可能发生变化。此外，将配置数据复制到另一个已成为线程安全的对象似乎首先破坏了使用内置配置包的主要好处之一（无需太多样板即可轻松访问类型转换和验证的配置信息代码）。

那么，有没有一种方法可以`System.Configuration`以线程安全的方式使用，而不需要过度解析和分配配置部分？`ConfigurationSection`即使您通过接口访问它，实现您自己的功能是否使您免于 Microsoft 提供的缺乏保证（如果是这样，当需要访问 base的索引器`System.Configuration`时，您将如何实现它是线程安全的？`ConfigurationSection`访问配置的数据）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T03:19:57.013

从 GetSection 返回的实例不是线程安全的。这意味着您需要添加锁定代码才能在单例中使用它。

除非文件已更改，否则多次调用不会重新解析文件。数据缓存在内存中。

使用锁定很容易解决您的线程安全问题（我不确定您是否需要，除非您在运行时更改配置），并且没有性能问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T03:12:35.953

ConfigurationManager.GetSection(string) 是一个公共静态成员，并且由于 msdn 声明“这种类型的任何公共静态（在 Visual Basic 中共享）成员都是线程安全的”，您可以假设它可以安全使用。

至于性能，我愿意假设 MS 已经使其非常高效，并且只需按原样使用它们的功能。记住：过早的优化是万恶之源。

# apache-flex - Flex 应用程序版本控制的最佳实践

> ID：745388
> 
> 赞同：1
> 
> 时间：2009-04-13T21:01:29.560
> 
> 标签：apache-flex, versioning

谁能推荐一种在 Flex 应用程序中进行版本控制的方法？

我应该在 swf 中的某处嵌入版本字符串吗？

版本应该是 URL 的一部分吗？

它应该在代码中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T21:07:45.973

是的。本[教程](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=2&postId=9503)应该有助于入门。

# java - 设置Java程序的最大内存会影响GC吗？

> ID：745390
> 
> 赞同：3
> 
> 时间：2009-04-13T21:02:35.313
> 
> 标签：java, garbage-collection

在运行 Java 程序时添加 -Xmx 参数是否会导致垃圾收集器的行为不同或发生频率降低？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-13T21:08:04.303

是的，大多数 Java 垃圾收集器仅在需要时运行，而不是按计划运行（无论是否需要）。所以，一般来说，更多的内存会导致更不频繁、更长的垃圾收集。

分代垃圾收集器具有[控制年轻代和年老代之间内存分配的设置。](http://java.sun.com/docs/hotspot/gc5.0/gc_tuning_5.html#1.1.Sizing%20the%20Generations%7Coutline)通过将这些设置为年轻代使用总内存的较小比例，年轻代的绝对大小可以保持与总堆大小的增加相同。然后，您不会看到垃圾收集频率或持续时间有太大变化，但您将有更多空间用于缓存等应用程序的长寿命对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-13T21:04:57.397

一般的答案是垃圾的收集频率会降低，但 GC 暂停时间会更长。

这是假设您已经拥有比您的工作集大小更多的可用内存；否则你可能会在垃圾收集上花费大量时间。

GC 特性因您使用的收集器和 Java 的版本以及您是否在更高的 -Xmx 之外还指定了更高的 -Xms 而有很大差异。旧版本的 Java（5 之前）在 VM 初始化后不会调整年轻代空间的大小。所以即使你指定了一个非常大的 -Xmx 值，年轻代的大小仍然非常小，所以你会看到频繁的年轻代收集。

当发生年轻代收集时，无论如何都会有一些“年轻”对象被提升到永久空间，即使它们是短暂的对象。这意味着tenured generation会慢慢填满死亡的年轻对象，需要周期性的full GC。最终进入老年代的此类对象的数量与年轻 GC 的数量成正比（假设您的程序中持续活动）。所以较大的年轻代的好处是年轻代的GC会更少，因此年轻代收集的对象会更少被提升到老年代。

除了 -Xmx（google for java gc）之外，还有许多调整参数，您必须对它们进行试验，因为每个应用程序的最佳设置会有所不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T21:09:41.130

是的，但这取决于您使用的垃圾收集器。[GC 调优页面](http://java.sun.com/javase/technologies/hotspot/gc/gc_tuning_6.html)是解决此类问题的好资源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T21:11:49.003

确实如此，因为当您拥有更多内存时，当涉及到收集和压缩时，它就有更多需要扫描。这意味着当一个（完整的）GC 启动时，这意味着它必须扫描更多的内存，并可能压缩更多的内存。也许有了更多的上下文，我们可以提供进一步的帮助。显然，要扫描三个不同的部分，因此它不一定以 1-1 的方式直接相关。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T21:41:52.427

只是间接的，并且在运行了一段时间之后。-Xmx 设置允许堆增长到的最大大小，并且不影响初始大小。所以它不会影响程序运行早期的 gc 时间或频率。如果 gc 后堆仍然（太接近）满，堆大小将增加，这就是 -Xmx 将影响的。-Xmx 的较高设置将允许堆（最终）变大，从而减少触发收集的频率（并且这些收集将花费更长的时间，正如其他人所描述的那样）。

但是，如果您的应用程序不使用太多内存（因此在 gc 之后堆大部分是空的），堆将永远不会增长，并且 -Mx 设置将无关紧要。

您可以使用 -Xms 设置初始 GC 堆大小。这将对垃圾回收产生直接影响。

# latex - 如何将文档从 Latex 转换为 Microsoft Word 2003？

> ID：745393
> 
> 赞同：31
> 
> 时间：2009-04-13T21:03:31.270
> 
> 标签：latex, openoffice.org

我需要找到一种方法将乳胶文档快速转换为 Microsoft Word 2003 文档。

我目前正在使用 Kile 在 Ubuntu 上编辑乳胶文档。

我可以通过以下方式做到这一点：

```
latex filename.tex
tex4ht filename.tex
mk4ht oolatex filename.tex 
```

然后我必须在 OpenOffice 中打开生成的 filename.odt 文档并保存为 Word 文档。

无论如何，我一步就能做到这一点吗？

我可以编写一个程序来运行最初的三行，我对不使用 openoffice 的从 odt 到 doc 的转换更感兴趣。

如果我能找到一种直接从 filename.tex 转换为 filename.doc 的方法，那就更好了

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-14T07:41:33.187

所有据称将文档从 LaTeX 转换为某种文字处理格式的程序都会丢失原始文件中的一些信息，但显然您愿意接受这些信息。

这是一个可能适合也可能不适合您的目的的技巧：如果[latex2rtf](https://sourceforge.net/projects/latex2rtf/)进行了足够好的转换（我不知道它与您正在使用的转换器相比如何），只需将其输出重命名`whatever.rtf`为`whatever.doc`，Word 就会打开它美好的。现在，如果文档的接收者想要编辑它，她可能会注意到它实际上不是通常的 Word 格式，但是，嘿，无论如何，Word 总是表现得很奇怪。

另一个技巧是将 TeX 的输出转换为页面的图像，并将它们逐个嵌入到 Word 文档中 - 这保留了 TeX 的确切布局，并且显然对于打印以外的任何内容都无用（并且打印质量可能会更差比你只打印原件得到的），但从技术上讲，它*是*一个 Word 文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T21:13:59.450

我没有使用它，所以我无法评论它，但这看起来有点像你正在寻找的东西：[tex2word](http://www.tex2word.com/products/tex2word/features/)和[LaTeX-to-Word](http://www.grindeq.com/index.php?p=latex2word)（后者看起来更好）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-13T21:20:38.093

您在 OpenOffice（使用[OOoLaTex](http://ooolatex.sourceforge.net/)）中打开它并保存为 .doc 是什么？

正如 Tormod 所说，只需一步就可以了：可以从命令行中使用 OOo，如下[所示](http://www.oooforum.org/forum/viewtopic.phtml?t=4163)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-06T15:40:16.857

我正在使用[tex4ht](http://www.tug.org/tex4ht/)生成一个**HTML**文件。`.html`我在 Word 中打开结果。之后，我将其另存为`.docx`. 给出了很好的结果。

基于此，有[latex2docx](https://sourceforge.net/projects/latex2docx/)项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-19T10:30:33.667

我尝试了许多免费的解决方案，但我的 LaTeX 文档太复杂了。最后，市售的[GrindEQ](http://www.grindeq.com/)做得最好。如果您只需要这样做一次，您可以使用演示版。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-09T03:44:44.710

Lyx 捆绑了一些命令行内容，以便您可以直接导出到 ODT 文件（假设您在路径上安装了 tex4ht），这样可能会为您节省一些击键。如果 Kile 没有类似的输出助手，我会感到惊讶。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-23T20:45:09.903

我刚刚安装了 GrindEQ。它并没有转换我的任何数字。我怀疑它忽略了 \graphicspath 。latex2rtf 不喜欢 \autoref 。

oolatex (tex4ht) 无法为我转换 jpg 图像，尽管它们在 MikTeX 2.9 下与乳胶和 pdflatex 都可以正常工作。其他图像未按 \centering 的要求居中。

oolatex 和 GrindEQ 将 \marginpar 嵌入到正文中，字体略有不同。latex2rtf 只是忽略了 \marginpar。

我想对于有些复杂的文档没有完美的工具:(

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-07T18:03:29.210

如果您想在一个独特的调用行中使用此命令，可以为此编写一个 bash 脚本：

*   创建一个名为 tex2odt.sh 的新文件
*   把这行写在：

    ```
    #!/bin/bash
    latex $1.tex
    tex4ht $1.tex
    mk4ht oolatex $1.tex 
    ```

*   使文件可执行：`chmod +x tex2odt.sh`

*   使用不带扩展名的 tex 文件名称调用脚本：`tex2odt.sh FiletoConvert`

希望这仍然有帮助

纳马斯特

# django - 在 django.core.management 中找不到 Python 模块 execute_manager

> ID：745398
> 
> 赞同：1
> 
> 时间：2009-04-13T21:04:48.990
> 
> 标签：django

**问题：**在类 django.core.management 中找到 Python 模块**execute_manager 。**

这个问题与我的[另一个问题](https://stackoverflow.com/questions/744993/unable-to-start-a-django-server-in-my-computer/745014#745014)有关。

我正在尝试通过以下方式启动我的服务器

```
python manage.py runserver 
```

该命令依赖于**manage.py**。该文件从 django.core.management 类中导入模块**execute_manager**，如下所示

```
from django.core.management import execute_manager 
```

我试图通过以下方式在 django 安装文件夹中找到模块的源代码

```
$find . | grep exe
./django/core/management/commands/sqlindexes.py 
```

同样，我通过 ack 得到以下结果。

```
django/conf/project_template/manage.py
2:from django.core.management import execute_manager
11:    execute_manager(settings)

django/core/management/__init__.py
333:def execute_manager(settings_mod, argv=None):

examples/manage.py
2:from django.core.management import execute_manager
11:    execute_manager(settings) 
```

**如何**在类 django.core.management 中找到模块 execute_manager 的源代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T21:06:48.783

`execute_manager`是一个函数，而不是一个模块，在包中的`__init__.py`文件中定义。`django.core.management`这就是你的 grep 找不到它的原因。

您的 ack 使用您粘贴的以下结果找到了它：

```
django/core/management/__init__.py
333:def execute_manager(settings_mod, argv=None): 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T21:08:01.057

它在文件中`$PYTHON_SITE_PACKAGES/django/core/management/__init__.py`。`execute_manager`是一个函数，而不是一个模块，模块的代码可以在`django.core.management`中找到`django/core/management/__init__.py`，因为`django.core.management`它也是一个包。

# c# - Windows 服务问题

> ID：745402
> 
> 赞同：3
> 
> 时间：2009-04-13T21:05:29.177
> 
> 标签：c#, windows-services, installation

我有 3 个 Windows 服务问题

1.  WS可以在后台工作吗？是否有可能每 2 分钟做一些工作？（如果是，我能得到一些帮助吗？）

2.  如何以简单的方式安装 WS？（不适用于 Installutil.exe .......）

3.  如何从 Windows 服务运行 .exe 文件？

我试过这样：

```
System.Diagnostics.Process G = new Process();
    G.StartInfo.FileName = @"d:\demo.exe";
    G.Start(); 
```

但它没有用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T21:07:01.077

*   是的，使用[Timer](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)类（[示例](http://www.csharphelp.com/archives/archive90.html)）

*   *installutil.exe*有什么问题？如果您不喜欢它，请使用 VS.NET 生成安装程序，但据我所知*installutil.exe它始终在后台。*（[完成示例1](http://www.codeproject.com/KB/vb/Windows_Services_Part_2.aspx)，[完成示例2](http://www.developerfusion.com/article/3441/creating-a-windows-service-in-vbnet/3/)）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-13T21:12:43.713

默认情况下，Windows 服务应该在后台运行。预计它们会在启动后立即将控制权交还给服务管理器，因此通常您会触发一个线程来处理您的服务任务。

话虽如此， System.Threading.Timer 类应该可以很好地启动定期运行的计时器。

至于安装，您应该使用 Installutil.exe - 这是安装 Windows 服务的标准方式。

我建议您看看[这篇 codeproject 文章。](http://www.codeproject.com/KB/system/WindowsService.aspx) 它有一个很好的、干净的模板，你可以使用它。此外，还有一个批处理文件示例来简化 Installutil 的使用，这可能会让您觉得它“更好”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T21:12:58.970

如果您使用 VS2008 进行开发，那么您有一个可用于创建 Windows 服务的模板。

基本上，您将创建一个计时器 (System.Windows.Timers.Timer)，在 OnStart 方法上进行初始化，在 OnStop 方法上进行清理和完成，然后初始化计时器（在 OnStart 上或使用 OnCommand）

您可以在此查看[基本示例](http://www.c-sharpcorner.com/UploadFile/mahesh/window_service11262005045007AM/window_service.aspx)，或在此处查看带有[计时器的示例](http://www.aspfree.com/c/a/C-Sharp/Timer-Objects-in-Windows-Services-with-C-sharp-dot-NET/)

对于安装，除了其他答案中的选项外，您还可以创建一个安装程序项目，再次检查模板项目

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-13T21:19:15.007

1.  是的，Windows 服务可以并且确实在后台工作。要每 2 分钟执行一次相同的工作，请使用 system.Timer 类并将您的代码放入 onElapsed 事件中。我最近创建了这种类型的服务，发现可以使用两种类型的 Timer，请确保使用正确的一种，否则将找不到 onElapsed 事件。

2.  我没有尝试在没有 InstallUtil.exe 的情况下进行安装，但我确实有一个我使用的 .bat 文件，它作为我的主应用程序安装的一部分运行。

您关于从 Windows 服务运行 .exe 以从我使用的 Windows 服务运行 .exe 的后续问题：

```
Process p = new Process();
p.StartInfo.WorkingDirectory = @"C:\";
p.StartInfo.FileName = @"C:\demo.exe";
p.StartInfo.CreateNoWindow = true;
p.Start();
p.WaitForExit(); 
```

请记住，可执行文件将在与服务相同的级别运行，这意味着它无法在桌面上显示任何内容。如果您希望看到任何打开的窗口或 .exe 需要任何用户输入，那么您会感到失望，并且 .exe 可能会无限期地等待。（我发现这个链接[启动外部程序有帮助，SO -](http://www.thescarms.com/dotnet/Process.aspx) [Launching an Application (.EXE) from C#](https://stackoverflow.com/questions/240171/launching-a-application-exe-from-c)也有这个问题）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T21:46:30.840

您也可以使用 sc.exe 将您的应用程序安装为服务，但它与 InstallUtil.exe 的安装并没有太大区别。它确实从命令行提供了对服务的更多控制。

[这是一篇较早的文章，描述了 sc.exe 的使用。](http://msdn.microsoft.com/en-us/library/ms810435.aspx) 同样，只需从命令提示符运行 sc 将显示它可能的命令。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-13T22:06:55.517

作为另一种想法，如果创建服务太难，您可以安排每两分钟运行一次任务。

# windows - 使用分层窗口创建平滑的窗口边框

> ID：745404
> 
> 赞同：9
> 
> 时间：2009-04-13T21:05:59.783
> 
> 标签：windows, winapi, alpha, layered

我们正在开发一个皮肤应用程序，在它的大部分窗口上都有各种圆边。我正在使用窗口区域来定义非矩形形状，但几乎每个人都反对由此导致的锯齿状混叠，因为像素只能是完全不透明或完全透明的。

我想出了一个使用分层窗口的解决方案，但我们希望确保它可以在各种系统上运行（并希望运行良好），我想看看是否有人有更好的想法或方法优化我正在做的事情。我知道分层窗口需要win2000或更高版本，这很好，因为这已经是其他原因的要求。从一些基本测试来看，它在 Vista 上看起来没问题，但这还不能保证。

这就是我所做的：我有一个窗口，称之为 A，带有控件和文本以及包含该窗口的任何内容。我将窗口 B 作为窗口 A 的子窗口，但它具有 WS_POPUP 样式而不是 WS_CHILD，因此它可以将自身定位在 A 的区域之外并绘制在 A 的控件之上。窗口 B 也有 WS_EX_LAYERED 样式，在初始化时，我调用带有 ULW_ALPHA 标志的[UpdateLayeredWindow](http://msdn.microsoft.com/en-us/library/ms633556(VS.85).aspx)和带有 32 位位图和 alpha 通道的源 DC，以使其使用每个像素的 alpha 进行绘制。

用于窗口 B 的源 DC 中的位图几乎只是窗口边框周围的像素，我希望将其从窗口的背景平滑地混合为完全透明的像素。我会跳过整个两个窗口的方法，只使用一个分层窗口，除了当你使用 UpdateLayeredWindow 时，它是从保存在内存中的缓冲区中绘制的，而不是典型的 WM_PAINT 消息和所有这些，并试图得到交互式子控件（和子窗口）可以很好地工作，这听起来很麻烦（甚至可能不适用于所有事情）。

所以，它基本上是带有所有子控件的窗口 A 和其他任何东西，窗口 B 直接浮动在它上面，绘制了一个漂亮的平滑边框。我通过移动窗口 B 来响应 WM_MOVE 消息等，并且我禁用了窗口 B，因此它永远无法获得焦点或输入（点击已经通过，因为它的部分不透明度为零，例如大多数它的内部零件，已经被排除在采摘之外）。

对于踢球，这就是这些碎片的样子，以更好地展示我的意思。

*   [窗口 A 的背景](http://kavendek.com/img/tmp/windowA.jpg)，青色用于遮盖完全透明的像素。
*   [窗口 B 的位图](http://kavendek.com/img/tmp/windowB.jpg)，带有一个 alpha 通道（当然没有图片，它是一个 jpg），它将非黑色像素混合成透明度。
*   [综合结果](http://kavendek.com/img/tmp/composite.jpg)

所以，它有效，但我不能确定它真的是最好的方法。我有两个问题：

*   这听起来可以接受吗，还是有什么可怕的地方？
*   由于它目前的工作原理，它似乎正在使用一个窗口大小的屏幕外缓冲区（最高可达 1024x768），即使它的极少数像素具有任何非零不透明度数据 - 是否值得开销以及将其切割成单独的边界块并将它们组合在一起的额外复杂性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T18:45:40.367

我发现了一件事：拥有单独的框架片段比拥有一个巨大的框架窗口渲染速度要快得多，中间有一大片空像素。我没有任何实际数字，但只是从尝试两者的快速测试来看，当几个具有全框架窗口的窗口相互重叠时，会有明显的延迟，但是当它们的框架被切割成更小的组件时，它会更快. 拥有具有自己的设备上下文的多个分层窗口的任何开销都不会产生太大的影响，并且拥有大范围的像素（无论是否为空白！）仍然会产生更多的负载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T17:52:06.083

我的产品使用分层窗口来绘制我附加到每个窗口的小标签。我使用分层窗口来获得平滑的舍入而没有锯齿。到目前为止，我遇到的唯一令人讨厌的问题是，一些 OpenGL 窗口在没有 DWM 的 Windows XP 和 Vista 上的分层窗口之上乱涂乱画。这是一个低级问题，微软并没有提供太大帮助。您可以通过打开 Google 地球并将您的应用程序拖到主渲染窗口上来重现它，您的分层窗口将消失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T15:05:53.887

1.  不要忘记在 RDP 和 VM (Hyper-V & VMWare) 下进行测试
2.  在上网本和笔记本电脑上尝试几张 gfx 卡（如果适用）。

# java - 正则表达式从部分或驼峰字符串匹配？

> ID：745415
> 
> 赞同：3
> 
> 时间：2009-04-13T21:08:18.263
> 
> 标签：java, regex

我想要一个正则表达式来匹配给定的部分或驼峰式字符串。例如，如果搜索集包含字符串“MyPossibleResultString”，我希望能够将其与以下内容匹配：

*   我的可能结果字符串
*   MPRS
*   MPR字符串
*   MyPosResStr
*   米

我还想包括通配符匹配，例如：

*   我的P*RString
*   *PosResString
*   我的*字符串

如果不清楚我的意思，我能想到的唯一示例是 Eclipse 的“打开类型”对话框，这几乎是我正在寻找的确切行为。我不太喜欢使用正则表达式，所以我不确定是否要在 Java 中寻找解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T21:41:18.480

好的，如果您已经支持第一个示例中描述的匹配，我真的不明白为什么需要通配符功能。这是我放在一起的。给定一个查询字符串查询，您可以使用一个正则表达式来创建一个正则表达式：

```
String re = "\\b(" + query.replaceAll("([A-Z][^A-Z]*)", "$1[^A-Z]*") + ".*?)\\b"; 
```

例如查询`MyPosResStr`将成为正则表达式：

```
\\b(My[^A-Z]*Pos[^A-Z]*Res[^A-Z]*Str[^A-Z]*.*?)\\b 
```

然后，您可以使用此正则表达式进行匹配，并使用以下`Matcher.find`方法获得如下内容：

```
public static String matchCamelCase(String query, String str) {
    query = query.replaceAll("\\*", ".*?");
    String re = "\\b(" + query.replaceAll("([A-Z][^A-Z]*)", "$1[^A-Z]*") + ".*?)\\b";

    System.out.println(re);
    Pattern regex = Pattern.compile(re);

    Matcher m = regex.matcher(str);

    if  (m.find()) {
        return m.group();
    } else return null;
} 
```

这将返回字符串 str 中与您的驼峰式查询的第一个匹配项。

编辑：我已经添加了一条处理通配符的行，因为在我疲倦的昏迷中我不明白对它们的需要

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T21:39:00.717

正如 danbruc 所说，您必须为每个新查询生成一个新的正则表达式。这段代码应该做你想做的事。

```
public Pattern queryToPattern(String query) {
    StringBuilder sb = new StringBuilder();
    char[] chars = query.toCharArray();
    boolean incamel = false;
    for (int i=0; i < chars.length; i++) {
        if (chars[i] == '*') {
                            if (!incamel)
                    sb.append(".*");
        } else if (Character.isUpperCase(chars[i])) {
            if (incamel) {
                sb.append(".*");
            }
            sb.append(chars[i]);
            incamel = true;
        } else {
            sb.append(chars[i]);
        }

    }
    sb.append(".*");
    return Pattern.compile(sb.toString());
} 
```

查询：MyP*RString

创建一个模式：My.* P.* R.* String.*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T21:26:50.793

使用单个正则表达式是不可能做到这一点的。您必须根据输入构建正则表达式并使用它进行搜索。很容易看出您不能使用单个正则表达式 - 用户可以搜索任何（cammel cased）字符串，因此您的正则表达式需要匹配任何（cammel cased）字符串，但它不再是搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T10:36:56.260

您可以尝试以下方法：

```
class RegexTransformer {
    public String fromQuery(String query) {
        StringBuilder sb = new StringBuilder();
        sb.append("^");
        sb.append(query.replaceAll("(\\p{Upper}(?!\\p{Lower}))",
                "$1\\\\p{Alpha}*?"));
        sb.append("$");
        return sb.toString();
    }
} 
```

有关否定前瞻断言、POSIX 字符类和不情愿量词的描述，请参阅[Pattern API](http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html)。`(?!pat)``\p{class}``*?`

示例测试用例：

```
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

import org.junit.Test;

public class RegexTransformerTest {

    private RegexTransformer rt = new RegexTransformer();

    @Test
    public void testQueries() {
        String in = "MyPossibleResultString";
        String q1 = "MyPossibleResultString";
        String q2 = "MPRS";
        String q3 = "MPRString";
        String q4 = "MyPosResStr"; // this wont work
        String q5 = "M";

        test(in, q1, "^MyPossibleResultString$");
        test(in, q2, "^M\\p{Alpha}*?P\\p{Alpha}*?R\\p{Alpha}*?S\\p{Alpha}*?$");
        test(in, q3, "^M\\p{Alpha}*?P\\p{Alpha}*?R\\p{Alpha}*?String$");
        test(in, q5, "^M\\p{Alpha}*?$");
    }

    private void test(String in, String query, String expected) {
        assertEquals("transform", expected, rt.fromQuery(query));
        assertTrue("match", in.matches(rt.fromQuery(query)));
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-10T18:11:59.787

Il-Bhima 的回答很棒，但我发现这段代码对我来说效果更好（请原谅我的 C#，但它是一样的）：

```
pattern = Regex.Escape(pattern);
pattern = pattern.Replace(@"\*", ".*?");
pattern = Regex.Replace(pattern, "([A-Z][^A-Z]*)", "$1[^A-Z]*?") + ".*"; 
```

请注意末尾的“.*”允许不完整的“startof”短语（也允许不指定所有大写字母）此外，“[^AZ]*”匹配器后面的星号修复了工具包答案中的 q4 等问题字母在大写字母之后提供（它们应该直接出现*在*大写字母之后，而不是在下一个之前）。

# apache-flex - 如何在 Flex 中获取有关用户浏览器的信息？

> ID：745423
> 
> 赞同：5
> 
> 时间：2009-04-13T21:10:32.113
> 
> 标签：apache-flex, actionscript-3

我想知道用户使用什么浏览器来查看我的 Flex 应用程序。如何获取用户代理字符串和其他信息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T11:56:58.277

您可以像这样在 AS3 代码中“嵌入”您的 javascript：

```
var v : String = ExternalInterface.call("function(){return navigator.appVersion+'-'+navigator.appName;}");
var t : TextField = new TextField();
t.autoSize = TextFieldAutoSize.LEFT;            
addChild(t);
t.text = v; 
```

textField 将显示有关导航器的信息，如下所示（chrome）：

*5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.19 (KHTML, like Gecko) Chrome/1.0.154.53 Safari/525.19-Netscape*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-13T21:14:02.713

Javascript 可以帮助您检测浏览器并找出 UserAgent。使用 ExternalInterface 使 Javascript 与您的 flex 应用程序对话。这是一个 ExternalInterface[教程](http://livedocs.adobe.com/flex/3/html/help.html?content=passingarguments_4.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T01:35:36.280

你的JavaScript：

```
function determineBrowser()
{
    // do whatever browser checks you prefer here, then return
    // a value (a string would probably work best) that will indicate
    // to your flash what browser it is

    // I'm just gonna copy and paste an extremely
    // simple one for example purposes

    if(navigator.appName == "Netscape")
    {
        return "Netscape";
    }
    if(navigator.appName == "Microsoft Internet Explorer")
    {
        return "Internet Explorer";
    }

    return "Not IE or Netscape";
}
```

你的动作脚本：

```
import flash.external.ExternalInterface;

var browser: String = ExternalInterface.call("determineBrowser"); 
```

使用我所做的，无论您的 javascript 函数返回什么，actionscript 中的浏览器变量都是什么，因此只要您让 javascript 确定它，您就可以获得所需的任何浏览器数据。

我建议让它比我做的更健壮一点，但我只是想用足够短的术语给你基本的想法，以便于消化！

# c# - SharePoint 品牌化按主题更改 SiteLogoUrl，不存在应用主题的事件

> ID：745424
> 
> 赞同：3
> 
> 时间：2009-04-13T21:10:32.940
> 
> 标签：c#, visual-studio-2008, sharepoint, events, branding

到目前为止，我们还不需要为我们的 SharePoint 站点定义创建新的母版页。我们有一个主题，我们的一些客户将根据他们的公司 SharePoint 品牌使用该主题。

目前，我使用以下代码在“FeatureActivated”事件的“FeatureReceiver”中更改“SiteLogoUrl”。

```
 public override void FeatureActivated(SPFeatureReceiverProperties properties) {
        AddThemeToSpThemes(THEME_ID, THEME_NAME, THEME_DESC, THEME_IMAGE, THEME_IMAGE);
        SPWeb site = properties.Feature.Parent as SPWeb;
        if (site != null) {
            site.AllowUnsafeUpdates = true;
            site.SiteLogoUrl = site.Url + "images/thLogo.gif";
            site.Update();
        }
    } 
```

FeatureActivated 不是触发的最佳事件，我更喜欢主题应用事件，但我似乎找不到。也许我没有正确地解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T13:20:49.457

应用主题没有事件。

您可能正在向后执行此操作（尽管是显而易见的方式）。让您的功能接收器以编程方式[激活主题](http://www.novolocus.com/2008/10/17/programmatically-apply-a-default-theme-in-sharepoint/)以及设置您的徽标怎么样？

请注意，您可以将当前应用的主题存储在 SPWeb 的属性包中 - 请参阅[此示例](http://www.novolocus.com/2008/06/24/setting-the-master-page-of-a-team-site-with-a-feature/)，但在更改它们之前存储当前母版页。

也值得考虑使用[备用 CSS 而不是主题](http://www.novolocus.com/2008/11/10/where-to-put-css-when-branding/)。这也可以在您的 SPWeb 对象 (AlternateCssURL) 上设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T06:38:23.527

您的代码应该可以正常工作。FeatureActivated/FeatureDeactivating 方法是您可以添加自定义代码的地方。

出于好奇，您为什么认为您没有使用正确的事件？sharepoint 的事件不多，主题功能也很有限。CSS 文件很广泛，但 .net 方面很小。

我的猜测是你想强制使用 SiteLogoUrl，即使主题发生变化（这样你的客户可以为他们的网站选择一个时髦的主题，同时保留徽标）。

此外，母版页不是主题，所以我不确定您为什么说“到目前为止，我们还不需要为我们的 SharePoint 站点定义创建新的母版页”。

干杯，

马特。

# c# - 在 C# 中，如何将 DWORD 声明为 uint32？

> ID：745425
> 
> 赞同：1
> 
> 时间：2009-04-13T21:10:55.823
> 
> 标签：c#

我想问题实际上是关于如何将类型定义为现有的原始数据类型。下面显然不起作用，但我想你会明白的。

```
Type DWORD = typeof(UInt32);

private DWORD func1(int x)
{
    return 123;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-13T21:11:54.557

C#中没有`typedef`。您也不能使用`#define`宏来替换字符串（它们只是有条件的）。唯一粗略的等价物是`using DWORD = System.UInt32;`在您的源文件之上。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-13T21:12:47.333

关于什么

```
using DWORD = System.UInt32; 
```

这样做的缺点是您必须在需要它的每个文件中执行此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T21:13:48.517

我认为您在谈论类型别名，在 C# 中执行此操作的方法是使用`using`关键字。

例如

```
using DWORD = System.Uint32 
```

# file - 如何以编程方式执行包含“文件”类型上传输入字段的 CGI 脚本表单？

> ID：745436
> 
> 赞同：0
> 
> 时间：2009-04-13T21:13:38.190
> 
> 标签：file, url, upload, cgi

我刚刚（在 Perl 中）编写了一个简单的 Web 服务，它显示了一个包含单个“文件”类型的上传字段和一个提交按钮的 Web 表单。我制作了这个简单的网页，目的是让人类可以使用它，并且不同机器上的脚本也可以以编程方式执行它。我已经完成并测试了人的部分，现在我才意识到我不知道如何在第二台机器上构建一个 URL，该 URL 在第一台机器上成功执行这个 cgi 脚本（并从第二台机器上传一个文件到第一台机器）。

我确实有一些构建包含表单字段的 URL 的经验，但以前从未使用过“文件”类型的上传输入字段，所以我有点挣扎。也许我用错了。

如果我的简单 Web 服务是一个名为“myscript.pl”的 cgi-bin 脚本，并且文件上传字段名为“uploadthis”，并且我要以编程方式上传的第二台机器上的文件位于“C:\myfile”中.txt”，那么我不应该只在第二台机器上的脚本中构造一个 URL，格式为“ [http://machine1/cgi-bin/myscript.pl?uploadthis=C](http://machine1/cgi-bin/myscript.pl?uploadthis=C) :\myfile.txt”并且该文件以编程方式上传，就像人类手动单击 Web 表单上的浏览按钮并选择该文件并单击“提交”按钮一样？

当我在第一台机器上调出 cgi 脚本表单并浏览到文件并单击提交时，它手动工作正常。该文件似乎可以通过网络浏览器上传。但是，当我在浏览器中输入上述 URL 以在将 URL 编程到另一台机器上的脚本之前手动测试文件上传 URL 时，上传的文件是零长度文件。它创建一个文件，但它完全是空的。如果我使用已知的错误文件名，如“ [http://machine1/cgi-bin/myscript.pl?uploadthis=C](http://machine1/cgi-bin/myscript.pl?uploadthis=C) :\myfilethatdoesntexist.txt”，结果相同。我究竟做错了什么？

我试图在几台装有 Apache 2.2 和 ActivePerl 5.10.0 的 Windows XP PC 上完成这项任务，表单方法是“post”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T22:41:05.607

首先，post 参数不会出现在 URL 的末尾。此外，不可能从浏览器发送完全自动化的文件上传（即使是 JavaScript 也不行），只是为了防止用户偷偷上传。

如果您想从浏览器上传，您将始终必须选择文件或在框中输入文件名，或手动单击提交按钮。如果所有这些都是自动化的，则不会上传文件。

要以编程方式测试文件上传，您可以使用 curl：

```
curl -F "uploadthis=@C:\myfile.txt" http://machine1/cgi-bin/myscript.pl 
```

当然，您也可以编写一个将文件作为多部分/表单数据发布的程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-26T23:27:50.940

您应该使用[LWP 和 HTTP::Request::Common](http://search.cpan.org/dist/libwww-perl/)或[WWW::Mechanize](http://search.cpan.org/dist/WWW-Mechanize/)等模块。两者都有文件上传的例子。WWW::Mechanize 更简单，但您应该只从 ppm 安装它。LWP 包含在 ActiveState 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T19:03:42.690

短语“multipart/form-data”是我完全错过的东西。当我用谷歌搜索那个短语时，我找到了答案。

类似于下面这个例子的东西是我如何从 perl 脚本中解决我的问题的：

```
use HTTP::Request::Common;
use LWP::UserAgent;

$ua = LWP::UserAgent->new;

my $response = $ua->request(
    POST 'http://machine1/cgi-bin/myscript.pl',
    Content_Type => 'form-data',
    Content      => [ 
                        uploadthis => ["C:\myfile.txt"],
                    ]
    );

if ($response->is_success) {
    print "Success.";
}
else {
    print "Failure.";
} 
```

# asp.net - 返回搜索结果实施

> ID：745437
> 
> 赞同：1
> 
> 时间：2009-04-13T21:13:45.990
> 
> 标签：asp.net, search, back

在 ASP.NET 应用程序中实现“返回搜索结果”的最佳方式是什么？我一直让用户在浏览器中执行 BACK 按钮，但他们总是会收到重新提交表单的提示。

有没有一种有效的方法来解决这个重新提交？

我应该在会话中缓存搜索条件/网址并在他们按下“返回”时重定向它们吗？

这里的最佳做法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T21:24:43.513

当浏览器历史记录中的页面是 http POST 的直接结果时，您会收到此警告。如果您的搜索表单使用方法 GET 而不是方法 POST，则可以避免这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T21:25:56.427

我会在查询字符串中传递搜索条件，并将反向链接`<a href='/Search.aspx?q=keywords'>Back</a>`改为类似的东西。

# java - 如何确定Java中给定日期前一天的日期？

> ID：745443
> 
> 赞同：15
> 
> 时间：2009-04-13T21:14:38.497
> 
> 标签：java, date, leap-year

我假设 Java 有一些内置的方法可以做到这一点。

**给定一个日期，我如何确定该日期前一天的日期？**

例如，假设给我 2009 年 3 月 1 日。上一个日期是 2009 年 2 月 28 日。如果给我的是 2008 年 3 月 1 日，那么之前的日期应该是 2008 年 2 月 29 日。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-04-13T21:18:05.900

使用日历界面。

```
Calendar cal = Calendar.getInstance();
cal.setTime(myDate);
cal.add(Calendar.DAY_OF_YEAR,-1);
Date oneDayBefore= cal.getTime(); 
```

以这种方式进行“添加”可确保您获得有效日期。这也适用于一年中的第一天，例如，如果`myDate`是 2012 年 1 月 1 日，`oneDayBefore`则将是 2011 年 12 月 31 日。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-13T21:30:21.503

您还可以使用[Joda-Time](http://joda-time.sourceforge.net)，这是一个非常好的 Java 库来操作日期：

```
DateTime result = dt.minusDays(1); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-13T21:21:29.777

java.util.Calendar 类允许我们从日期中添加或减去任意数量的天/周/月/任意数量。只需使用 add() 方法：

[http://java.sun.com/j2se/1.5.0/docs/api/java/util/Calendar.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Calendar.html)

例子：

```
Calendar date = new GregorianCalendar(2009, 3, 1);
date.add(Calendar.DATE, -1); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-04-27T09:33:07.810

使用 java.time.Instant

```
Date.from(Instant.now().minus(Duration.ofDays(1))) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T21:21:52.413

```
import java.util.Calendar;
import java.util.GregorianCalendar;
import static java.util.Calendar.*;

public class TestDayBefore {

    public static void main(String... args) {
        Calendar calendar = GregorianCalendar.getInstance();
        calendar.set(YEAR, 2009);
        calendar.set(MONTH, MARCH);
        calendar.set(DAY_OF_MONTH, 1);
        System.out.println(calendar.getTime()); //prints Sun Mar 01 23:20:20 EET 2009
        calendar.add(DAY_OF_MONTH, -1);
        System.out.println(calendar.getTime()); //prints Sat Feb 28 23:21:01 EET 2009

    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-13T02:04:24.937

使用[date4j](http://www.date4j.net)库：

```
DateTime yesterday = today.minusDays(1); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-03-21T02:20:06.783

这会有所帮助。

```
getPreviousDateForGivenDate("2015-01-19", 10);
getPreviousDateForGivenDate("2015-01-19", -10);

public static String getPreviousDateForGivenDate(String givenDate, int datesPriorOrAfter) {
    String saleDate = getPreviousDate(datesPriorOrAfter);

    try {
        DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
        String[] arr = givenDate.split("-", 3);
        Calendar cal = new GregorianCalendar(Integer.parseInt(arr[0]), Integer.parseInt(arr[1])-1, Integer.parseInt(arr[2]));
        cal.add(Calendar.DAY_OF_YEAR, datesPriorOrAfter);    
        saleDate = dateFormat.format(cal.getTime());

    } catch (Exception e) {
        System.out.println("Error at getPreviousDateForGivenDate():"+e.getMessage());
    }

    return saleDate;
} 
```

# vb.net - 重新启动单实例应用程序

> ID：745447
> 
> 赞同：1
> 
> 时间：2009-04-13T21:16:32.487
> 
> 标签：vb.net, visual-studio, clickonce

有没有办法重新启动通过clickonce部署的单实例应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T21:22:47.607

尝试

```
Application.Restart() 
```

这将重新启动 WinForms ClickOnce 应用程序。

# iphone - 向 UITextField 添加标签

> ID：745453
> 
> 赞同：6
> 
> 时间：2009-04-13T21:18:38.503
> 
> 标签：iphone

在问题[663830](https://stackoverflow.com/questions/663830)中，Isaac 询问有关向文本字段添加按钮的问题。有人可以显示代码以向 .rightView 属性添加标签吗？

或者，有没有更好的方法在文本字段中包含“永久”文本？

这适用于在字段中包含单位（mg、kg 等）的计算器，而无需在文本字段之外维护标签。有点像永久占位符文本？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-13T23:25:50.803

快速而肮脏的代码：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    UITextField *textField = [[UITextField alloc] initWithFrame:CGRectMake(100, 100, 100, 40)];
    textField.borderStyle = UITextBorderStyleLine;
    UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 40, 40)];
    label.text = @"mg";
    label.backgroundColor = [UIColor colorWithWhite:0.0 alpha:0.0];
    textField.rightViewMode = UITextFieldViewModeAlways;
    textField.rightView = label;
    [self.view addSubview:textField];
    [label release];
    [textField release];
} 
```

请注意，我是从 ViewController 添加子视图，您也可以从视图中添加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-12T19:18:08.930

UITextField 上的 leftView（或 rightView）属性是这个属性。在文本字段中制作“永久”文本非常容易。

```
- (void)loadView
{
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 40, 40)];
label.text = @"To:";
label.backgroundColor = [UIColor colorWithWhite:0.0 alpha:0.0];
self.UITextField.leftViewMode = UITextFieldViewModeAlways;
self.UITextField.leftView = label;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-15T03:40:01.130

我知道我参加聚会可能会迟到一点，但我相信这可以帮助未来面临同样情况的程序员。

您可能想创建一个类别以使其更易于在多个应用程序中使用，如下所示：

**UITextField+PaddingLabel.h**

```
#import <UIKit/UIKit.h>

@interface UITextField (PaddingLabel)

-(void) setLeftPaddingText:(NSString*) paddingValue width:(CGFloat) width;

-(void) setRightPaddingText:(NSString*) paddingValue width:(CGFloat) width;

@end 
```

**UITextField+PaddingLabel.m**

```
#import "UITextField+PaddingLabel.h"

@implementation UITextField (PaddingLabel)

-(void) setLeftPaddingText:(NSString*) paddingValue width:(CGFloat) width
{
    UILabel *paddingLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, width, self.frame.size.height)];
    paddingLabel.text = paddingValue;
    self.leftView = paddingLabel;
    self.leftViewMode = UITextFieldViewModeAlways;
}

-(void) setRightPaddingText:(NSString*) paddingValue width:(CGFloat) width
{
    UILabel *paddingLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, width, self.frame.size.height)];
    paddingLabel.text = paddingValue;
    self.rightView = paddingLabel;
    self.rightViewMode = UITextFieldViewModeAlways;
}

@end 
```

**使用示例：**

```
[self.dateTextField setLeftPaddingText:@"DATE:" width:defaultWidth]; 
```

# html - 为什么我的 GET 请求中有额外的参数 x 和 y？

> ID：745462
> 
> 赞同：7
> 
> 时间：2009-04-13T21:19:51.263
> 
> 标签：html, forms

当我点击提交图像时，我在 GET 请求中获得了一些额外的参数：

```
main.php?selected=user_manager_main&mode=set_active&set_this_id=13&x=4&y=7 
```

请注意最后的`x`和`y`。我当然没有在最后定义`x`and `y`。这些值似乎是随机的。这是表单代码：

```
echo '<form action ="main.php" method="get">';
echo '  <input type="hidden" name="selected" value="user_manager_main" />';
echo '  <input type="hidden" name="mode" value="set_inactive" />';
echo '  <input type="hidden" name="set_this_id" value="'.$row['USER_ID'].'" />';
echo '<input type="image" src="images/delete.gif" alt="Submit" />';
echo '</form>'; 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-13T21:23:54.763

没关系。看着：

[http://www.w3.org/TR/html401/interact/forms.html#h-17.4.1](http://www.w3.org/TR/html401/interact/forms.html#h-17.4.1)

> 当使用定点设备单击图像时，会提交表单并将单击坐标传递给服务器。x 值以图像左侧的像素为单位，y 值以图像顶部的像素为单位。提交的数据包括name.x=x-value和name.y=y-value，其中“name”是name属性的值，x-value和y-value分别是x和y坐标值。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-13T21:21:43.833

这是用户点击您的图像输入的 x 和 y 坐标

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-13T21:22:33.127

这不是随机的。在 IE 中，当您提交输入图像时，您会获得在图像上单击的坐标。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-13T21:38:42.917

它是用户单击的图像内的坐标。使用值 x=4 和 y=7 时，用户单击图像左边缘的四个像素和上边缘的七个像素。

通过将“.x”和“.y”添加到图像按钮的名称来形成坐标值的键名。由于您根本没有指定任何名称，因此键名只是变成了“x”和“y”。

# java - 为什么我的文字不显示？

> ID：745463
> 
> 赞同：1
> 
> 时间：2009-04-13T21:20:22.807
> 
> 标签：java, string, opengl, bitmap, jogl

出于某种我一生都无法弄清楚的原因，我在 JOGL hello world 程序中的文本根本不会出现。我将包括显示方法，以便你们都知道我在说什么。

```
public void display(GLAutoDrawable gLDrawable)
    {
        final GL gl = gLDrawable.getGL();
        final GLU glu = new GLU();
        GLUT glut = new GLUT();
        gl.glClear(GL.GL_COLOR_BUFFER_BIT | GL.GL_DEPTH_BUFFER_BIT);
        gl.glLoadIdentity();
        glu.gluLookAt(0f,0f,0f,0f,0f,-800f,0,1,0);
        gl.glTranslatef(0.0f,0.0f,5.0f);
        gl.glColor3f(1f, 1f, 1f);

        gl.glRasterPos2f(250f,250f);

        glut.glutBitmapString(GLUT.BITMAP_HELVETICA_18, "Hello World!");

        gl.glFlush();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T15:34:44.487

我对此进行了一些修改，但我也无法显示任何内容。

gluLookAt 调用肯定很糟糕：您将相机放置在 (0,0,0) 并朝向 z=-800，但您将文本放置在 z=0。显然什么都不会出现。

我还注意到您没有调用通常应该调用的 glViewport() 来将场景映射到组件中。

您在这里遇到的几乎肯定是 GL 问题，而不是 JOGL 问题。查看 OpenGL 编程指南中的故障排除提示。如果您没有副本，并且打算进行任何重要的 GL 编程，我建议您获得一份。我还将用在同一位置绘制的多边形替换您的文本。当我这样做时，什么都没有出现，所以几乎可以肯定这是一个矩阵问题，与您的文本无关。当您显示多边形时，您可以将其替换为文本。一次解决一个问题。您也可以尝试在这个问题中添加 opengl 标记，因为这会吸引一些专业的 OpenGL 程序员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T21:27:59.323

我没有使用过 JOGL，但是在使用 C++ 的 OpenGL 中，您需要在刷新后交换 GLUT 的缓冲区：

```
glutSwapBuffers(); 
```

JOGL 中的等价物可能是：

```
glut.glutSwapBuffers(); 
```

在 gl.glFlush() 之后；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T21:34:06.533

我不喜欢 -800f

```
glu.gluLookAt(0f,0f,0f,0f,0f,-800f,0,1,0); 
```

尝试调整这个数字。也许甚至删除整个 LookAt 方法调用，你不应该需要它。

**编辑** 它也可能是一个照明问题。您似乎没有指定任何光源，也没有以任何方式启用照明。也许您的文字已显示，但与背景一样暗......

# c# - 使用 WCF 作为主从命令模型

> ID：745472
> 
> 赞同：1
> 
> 时间：2009-04-13T21:23:08.603
> 
> 标签：c#, .net, wcf, master-slave

我正在开发一个主从命令模型，通过该模型，某些应用程序“主”将命令发送到称为“从”的同质进程以执行某些任务，然后以状态完成或进程失败响应。他们还应该根据请求向可用的主服务器公开一些数据。

这个模型在 WCF 中会是什么样子？

Master和Slave的每个实例会托管他们自己的服务吗？难道只有法师主持？只有奴隶？我应该使用回调合同吗？数据合同？或只是服务合同。

作为旁注，这是一个用于产品测试的低带宽、低强度、仅限内部的分发项目，不应被视为“大型高需求”项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T05:09:00.060

您肯定会有某种形式或形式的服务合同——这是必须的。这只是定义了您的服务及其上的操作（方法）（OperationContract）。

如果它是一个内部“防火墙后”系统，您可以查看双工绑定，例如让主设备调用从设备，从设备完成后在双工通道上报告。开箱即用，只有 WsDualHttpBinding 支持双工，但由于您是内部的，在防火墙后面，您可能希望查看创建自己的基于 TCP 的双工绑定（这并不像听起来那么难第一的！）。

在这种情况下，所涉及的两个应用程序实际上同时是服务器和客户端。

您将以某种方式、形状或形式拥有 DataContracts 来定义在 Master 和 Slave 之间移动的 DATA - 所以再次，是的，您将必须拥有 Data Contracts。

编辑：当然，另一种方法可能是使用两个 MSMQ 消息队列；Master 将他的“工作”请求放入队列中，Slave 监听并获取工作请求。当 Slave 完成后，它会依次将响应放入 Master 作为侦听器的响应队列中，并收到有关正在以这种方式完成的工作的通知。

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T14:07:46.410

我同意 Jeremy 的观点。你所描述的不需要回调合同的复杂性。工作节点可以简单地公开 WCF 服务（或者甚至是 WSDL 或 REST Web 服务……），然后控制器只需要知道每个子节点的 URL 并将消息发送到工作节点。

如果您希望控制器能够广播一条消息并让所有工作人员（我真的不喜欢主/从类比......我很久以前改称它为控制器/工作人员）节点做一些响应并发布他们的回到小组，那么您可能想要使用 WCF 中经常被低估的 P2P 渠道。这允许一组用 WCF 编写的服务作为对等方同时相互交谈，使用的 URL 几乎就像主题/对话分隔符一样。

因此，例如，您可以在**net.p2p://labs/commands**频道上发出命令。只有控制器在该通道上发送命令，但所有工作节点都在监听。当他们异步完成他们的工作时，他们可以在**net.p2p://labs/status**频道上报告进度。这种方法的另一个好处是（如果您需要此功能），单个工人将获得了解所有其他工人在做什么的能力。

但是请记住，如果您使用 P2P，那么您将不得不处理争用 - 您最终可能会有 2 个节点接受相同的命令。如果这没问题，那么 P2P 就是您的工具。如果您需要发出命令，并且仅在单个节点空闲时才串行接收（在告诉远程节点运行单个测试脚本等时更有可能发生这种情况），那么您可以使用 MSMQ 绑定而不是 P2P。然后所有的工作人员都成为从队列接收消息的客户端，您可以更轻松地抵消多个工作人员接受同一请求的情况。

更多参考： [我不久前在 Peer Channel 上写的一篇博文](http://dotnetaddict.dotnetdevelopersjournal.com/peerseries_wcfpeerchannel.htm)。

[MSDN 上的 Peer Channel Scenarios](http://msdn.microsoft.com/en-us/library/ms734699.aspx) - 这很好，因为您可以从这里转到 Peer Channel 概念到参考指南。

[同行渠道团队博客](http://blogs.msdn.com/peerchan/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T21:45:30.797

如果从属处理需要很长时间，那么回调合约可能是有序的。否则，您可以阻止主服务器等待从服务器完成（您可能必须调整 WCF 客户端配置，使其不会超时）。

根据您的描述，我认为您实际上只需要在从节点上托管 WCF 服务，而主节点可能只是一个使用从节点公开的 WCF 服务的客户端。

# vb.net - For 循环在 VB.NET 中如何工作？

> ID：745490
> 
> 赞同：1
> 
> 时间：2009-04-13T21:32:08.283
> 
> 标签：vb.net, compiler-construction

我虽然我知道这个...我不知道。

这个简单的 For 循环：

```
Dim i As Integer
Dim n As Integer = 10
Dim s As Integer = 1

For i = 0 To n Step s
    Console.WriteLine(i)
Next 
```

编译成这个（我把它放在Refelctor，所以它更容易阅读）。我什至无法理解它对所有这些位移的作用：

```
Dim n As Integer = 10
Dim VB$t_i4$L1 As Integer = 1
Dim VB$t_i4$L0 As Integer = n
Dim i As Integer = 0
Do While (((VB$t_i4$L1 >> &H1F) Xor i) <= ((VB$t_i4$L1 >> &H1F) Xor VB$t_i4$L0))
    Console.WriteLine(i)
    i = (i + VB$t_i4$L1)
Loop 
```

为什么 For 循环会像这样被肢解？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-13T21:42:09.477

可能是因为它是涵盖所有情况的“通用方式”。请记住，for/step/next 可以在增量上带有任何符号的任何方向进行。

您在增量和结束边界上都使用了参数。编译器无法知道您是要向上计数还是向下计数，以及结束界限是高于还是低于起始界限。

我的猜测是，这是一种获取代码的方法，无论您在 n 和 s 中输入什么内容都可以工作（只是猜测，我太累了，无法尝试看看是否是这种情况）。

它还复制参数以防止外部干扰（例如在枚举期间更改 s 或 n）。

=== 更新 ===

我怀疑是否有人还在关注这个问题，但我只是为了完整起见而回到这个掘金，因为我有一些时间。VB 所做的有点偷偷摸摸。S 的位移基本上是根据 S 的符号创建一个整数（它复制 s 的 MSB，以 &hFFFFFFFF 结尾是 S 是负数，如果 S 是正数则 &h00000000）。

整数值与 -1 的异或等效于 (-value-1)。与 0 的 XOR 显然是 NOP。因此，如果 s 为负数，它将反转两个值（-1 相互抵消）以比较它们，有效地反转比较顺序而无需或条件，因此程序流程中没有跳转。如果 s 是正数，它只是比较它们。

所以，对于 s<0 你最终得到

```
while (-i-1)<=(-n-1) 
==> while -i <= -n
==> while i>=n 
```

对于 s>0 你最终得到

```
while i <= n 
```

带我回到我的 68k ASM 日子，那里的日常事物（例如 XOR.l D0,D0 因为与自身异或寄存器比在其中加载零更快......）：p

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T21:43:19.490

我想显而易见的答案是 For Next 循环可以写为 Do While 循环，将一个循环转换为另一个意味着您只需在编译器中实现一种类型的循环。我可以看到这是如何工作的，但为什么会这样，我不知道。

# sql - Firebird 的“无法完成网络请求”或“连接被拒绝”，仅在一台机器上

> ID：745494
> 
> 赞同：5
> 
> 时间：2009-04-13T21:33:50.543
> 
> 标签：sql, odbc, firebird, c++builder

我在公司的一台计算机上遇到了一个看似独特的问题（必须是我老板的）。我有一个来自 Borland C++ 的程序，它使用`TSQLConnection`. 它连接到作为应用程序运行的本地 Firebird 服务器 2.1.1.17910。其他电脑工作正常。

它*绝对不会*在这台笔记本电脑（本地服务器）上连接*任何东西*。我记得他在安装 InterBase 时也总是遇到问题。我认为他可能安装到 7.5。它现在已经消失了，我检查并清除了所有旧的*GDS32.dll*文件并用 FireBird 更新了它们，并且无论如何连接都在使用*fbclient.dll* ......

我尝试卸载并重新安装 FB 并将其作为服务运行。没用。

我进入 etc/services 并在这一行中添加：

```
gds_db           3050/tcp                           #Firebird 
```

没有骰子。

在数据库位置前面粘贴“localhost：”会出现此错误

> 无法完成对主机“localhost”的网络请求。无法建立连接。

我检查了 netstat，它正在监听 127.0.0.1 端口 3050...

尝试在数据库位置之前粘贴“127.0.0.1：”，我得到：

> 远程接口拒绝连接

尝试完全取出 127.0.0.1 或 localhost 并仅使用数据库位置，这是正确的位置，我得到了

> 不可用的数据库。

*完全相同的 CD*在其他机器上也能正常工作。我尝试粘贴“localhost”、“127.0.0.1”，并且在数据库位置前面什么都没有，并且在其他机器上都可以正常连接。

我已经让他关闭了防火墙，仍然没有骰子......这个问题已经持续了很长时间，我已经走到了尽头。我已经尝试了我能想到的一切。它在我的电脑上运行良好，空白测试电脑，对于 beta 测试人员......除了我老板之外的所有人。任何帮助将*不胜*感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-13T22:05:12.870

早在 1998 年，当我在 Borland 工作时，我就撰写了“InterBase Operations Guide”。我试图解决与连接相关的常见错误的故障排除。

*   **拒绝连接**是指客户端应用程序根本无法完成与 IB/FB 服务器的网络连接。如果防火墙阻止了连接，这就是您会得到的错误。

*   **Connection Rejected**是指网络连接到达数据库服务器，但数据库服务器决定终止连接请求。原因包括：

    *   您输入了错误的数据库路径。
    *   您指定了错误的用户名或密码（即它们与 中的条目不匹配`isc4.gdb`）。
    *   数据库目录位于网络文件系统上。它必须位于笔记本电脑的物理本地文件系统上。
    *   数据库服务器进程没有文件系统级别的权限来读取和写入数据库文件（包括`isc4.gdb`）。是否有防病毒软件或其他文件系统安全阻止未经授权的进程的 I/O？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-11-05T22:44:19.910

2011 年 5 月 11 日，我现在遇到了“完全相同”的问题，并且非常有条不紊地解决了这个问题。在互联网上搜索提示和技巧。我尝试卸载我的 Firebird 2。我重新安装了它。当我尝试通过 Delphi 使用数据库时，同样的错误仍然存​​在。我在 system32 文件夹中重命名了 GDS32.DLL，并从另一台一切正常的计算机上复制了它。还是一样的问题。由于某种原因总是拒绝连接到数据库。

我检查了 Firebird 的日志文件，然后……是的。它总是拒绝，但是当我使用 IB-Console 时，我可以创建一个新数据库或使用现有数据库。

我决定做最后一次尝试并再次卸载 Firebird。然后我删除了 programfiles\firebird 中的其余安装。我使用 AML Free 注册表清洁器进行了完整的注册表检查。（我认为大多数好人都会这样做）

它发现了大约 1500 个无效条目，我决定“全部修复”

完成后，我重新安装了 firebird 2。将其安装为服务器。

瞧。

我现在可以在我的软件开发中再次使用 IBqueries 和 SQL 数据库和 Firebird。我最好的猜测是 Windows 注册表出了点问题，尽管我无法确定这一点。

祝你好运和最好的问候。Morten，挪威，一个非常晚的星期六晚上。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-09-22T19:50:28.773

对于那些有微笑问题的人。64 位操作系统上的一个常见问题：GDS32.DLL 和 FBCLIENT.DLL 的错误副本在`C:\Windows\SysWOW64`目录中。卸载 FireBird，从两者中删除所有提到的库副本，`C:\Windows\System32`然后`C:\Windows\SysWOW64`重新安装 FireBird。它将为 64 位和 32 位应用程序创建这些库的新的和有效的副本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T00:54:57.407

正如比尔指出的“被远程接口拒绝”消息意味着 TCP 连接已正确建立，但 Firebird 服务器本身拒绝了该连接。
检查*firebird*服务器 \bin 文件夹中的 firebird.log 文件。
它可能包含有关服务器拒绝连接的原因的有用信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-07T05:14:13.970

我刚刚通过连接到远程 linux 服务器上的 Firebird 1.5.x 的旧 D7 Interbase 客户端应用程序解决了类似的问题。为了让事情顺利进行，我将 XP Interbase 客户端目录结构迁移到 Win7 x64 工作站，并编写了类似于以下内容的注册表项：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Borland\InterBase\CurrentVersion]
"RootDirectory"="c:\\utils\\INTRBASE" 
```

在我的情况下，这是定位*ib_licen.dat*文件所必需的。迁移的 IB 工具也可以工作，但需要正确的*GDS32.DLL*文件，该文件位于已退役 XP 工作站的 system32 目录中。

在活动的 Win7 工作站上，我没有费心去寻找和删除*gds32.dll*文件，尤其是因为我在 SysWow64 中安装了更新但不兼容的*gds32.dll 。*因此，为了让 D7 和应用程序满意，我将较旧的*GDS32.DLL*文件复制到包含 D7 ( *delphi32.exe* ) 和已编译应用程序的相同目录中；不完全实用但可行。*为了方便使用bdeadmin.exe*维护相应的 Interbase 别名，该 DLL 也被复制到 BDE 目录中。

顺便说一句，我通过*bdeadmin.exe收到***的远程接口**消息拒绝的连接是不兼容/缺少*GDS32.DLL*的症状。安装正确的*GDS32.DLL*后，将显示以下有关许可的消息：**​​产品 REMOTE INTERFACE 未获得许可**，已通过上述注册表项解决。此外，Firebird 和网络也不是导致连接问题的因素。

 *****另一点：正在使用的*ib_licen.dat*支持 R 选项。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-02T09:36:35.423

我解决**了删除与.exe 位于同一目录中的*gds32.dll***文件的问题。我想通过这种方式程序使用安装在系统其他地方的DLL，这可能更兼容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-31T06:11:58.170

在我个人的情况下，我通过备份/恢复目标数据库解决了这个问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-07-17T14:45:13.307

我在虚拟 XP 机器上遇到了这个问题。我只是关闭了 Firebird，然后关闭并开始备份 Virtual XP 机器。重新启动 Firebird，问题就消失了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-03-01T10:27:52.740

其他人可能在我之前就发现了这一点，但是当我遇到消息“无法完成对主机“localhost”的网络请求时。无法建立连接' 我得出结论，这很有可能是由于恶意软件或 PUP 的干扰。因此，我运行了 Malwarebytes，它清理了近 400 个这些东西的实例，主要是 PUP，清理后错误消失了。不幸的是，我不能说哪个恶意软件或 PUP 实例是有罪的一方，但它肯定是其中之一。因此，我想建议运行 Malwarebytes 将是一个很好的第一步，然后再采取更激烈的措施，例如重新安装产品。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-10-30T07:07:48.400

这是此问题的解决方案：

转到服务并启动 Firebird 服务。应该有两个服务。

应用程序确实启动了，但是当尝试使用 FB 定位数据库时，由于未启动 FB 服务而失败。

# javascript - 以编程方式获取本地变量的值以在 javascript 中运行？

> ID：745495
> 
> 赞同：5
> 
> 时间：2009-04-13T21:33:57.033
> 
> 标签：javascript, metaprogramming

鉴于：

```
function foo(){
  var bar = "quux";
  console.log(/*mystery code here*/);
} 
```

我正在寻找插入注释时会产生 bar 值的代码。举例来说，这样的事情在全球范围内有效：

```
var foo = "bar";
var bar = "quux";
console.log(window[foo]); 
```

但是，当然，全局定义的变量会附加到窗口对象。函数的局部变量不是。是否有一些类似的方法可以以编程方式获取局部函数变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T21:58:11.343

不，怕不是。

### 请参阅：[javascript locals()？](https://stackoverflow.com/questions/39960/javascript-locals)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T21:44:47.270

首先，你为什么需要这样做？做这样的事情还不够吗？

```
console.log(bar); 
```

局部变量在 JS 的范围之外不可用，但如果您尝试仅在函数内部访问它们，则无需其他方法来访问它们。

也许如果您告诉我们这背后的真正问题（不仅仅是这个例子），我们可以为您提供比寻找类似`window[foo]`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T10:49:22.303

很长的死线程，但不会 eval 完成这项工作。

```
(function() {
  var foo = "bar";
  var bar = "quux";
  altert(eval(foo));
})() 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-13T21:47:27.997

据我所知，这是不可能的，我看不出它有什么帮助。但是，您可以使用 for... in 结构找到任何对象的字段名称，如下所示：

```
for(field in obj){
   console.debug("Obj has a field named:"+field+" with value:"+obj[field]);
} 
```

# c# - 自定义列表中的 SharePoint 自定义上下文菜单出现在文件夹上，而不仅仅是文件上

> ID：745499
> 
> 赞同：3
> 
> 时间：2009-04-13T21:35:32.847
> 
> 标签：c#, visual-studio-2008, sharepoint, custom-action, sharepointdocumentlibrary

我创建了一个自定义列表，这里是列表模板：

```
<ListTemplate Name="CustomDocumentLibrary"
            DisplayName="Document Library"
            Description=""
            BaseType="1"
            Type="10101"
            OnQuickLaunch="TRUE"
            SecurityBits="11"
            Sequence="110"
            Image="/_layouts/images/itdl.gif"
            DocumentTemplate="101" /> 
```

我添加了一个自定义操作：

```
 <CustomAction
Id="1611D96C-ABBD-4021-9183-60D8440BEB95"
Location="EditControlBlock"
Title="Send to Document Management"
ImageUrl="/_layouts/images/cmCopy.gif"
RegistrationType="List"
RegistrationId="10101">
<UrlAction Url="~site/Lists/DocumentLibrary/Forms/SendToDM.aspx?ListId={ListId}&amp;ListItemID={ItemId}&amp;Action=Copy"/> 
```

这个上下文菜单出现在文件和文件夹上，我的上下文菜单是否可以只出现在文件上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T21:46:55.473

您可以改为在内容类型上注册操作。但这可能不适合您的情况？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-20T16:25:04.483

我从来没有想过如何在代码或 XML 中做到这一点，但我让它在 JavaScript 中工作。
我将以下代码添加到 AllItems.aspx：

```
<script type="text/javascript">
    function Custom_AddDocLibMenuItems(m, ctx) {
        var otype = currentItemFSObjType = GetAttributeFromItemTable(itemTable, "OType", "FSObjType");
        if (otype != 1) { // 1=folder
            var itemId = GetAttributeFromItemTable(itemTable, "ItemId", "Id");
            var listId = ctx.listName;
            var action = 'Go_To_Page("' + ctx.HttpRoot + '/_layouts/MyPage.aspx?ListId=' + listId + '&ListItemID=' + itemId + '");';
            var option = CAMOpt(m, 'Do Something', action, '/_layouts/IMAGES/10.gif', '', 1110);
            option.id = "ID_Do_Something";
        }
        return false;
    }

    function Go_To_Page(page) {
        window.location = page;
    }
</script> 
```

一个不幸的副作用是该项目始终位于上下文菜单中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-16T08:10:43.947

```
<CustomAction
Id="ContextMenu"
Location="EditControlBlock"
Title=Permissions"
**RegistrationType="ContentType"**
ShowInLists="FALSE"
ImageUrl ="~Site/_layouts/nks.PNG"
**RegistrationId="0x0101"**>
    <UrlAction Url="your URL"/>
</CustomAction> 
```

# c# - 返回图像的 ASPX - 可以输出缓存吗？

> ID：745500
> 
> 赞同：6
> 
> 时间：2009-04-13T21:35:52.923
> 
> 标签：c#, asp.net, caching, outputcache

问候！

我创建了一个 APSX Web 表单，它根据一些提供的参数返回一个远程图像。它可以这样使用：

```
<img src="/ImageGetter.aspx?param1=abc&param2=123" /> 
```

ImageGetter.aspx 的标记和代码如下所示：

```
<%@ OutputCache Duration="100000" VaryByParam="*" Location="ServerAndClient" %>
<%@ Page Language="C#" AutoEventWireup="false" EnableSessionState="False" CodeBehind="ImageGetter.aspx.cs" Inherits="ACME.Helpers.ImageGetter" %> 
```

此代码在 ImageGetter.aspx 的 Page_Load 方法中调用：

```
byte[] data = null;
Dictionary<string, string> file_locations = GetImageLocations(param1, param2);
try
{
    data = new WebClient().DownloadData(file_locations["main"]);
}
catch (WebException wex)
{
    try
    {
        data = new WebClient().DownloadData(file_locations["backup"]);
    }
    catch (Exception e)
    {
        throw;
    }
}
Response.ContentType = "image/jpeg";
Response.OutputStream.Write(data, 0, data.Length);
Response.End(); 
```

根据我的测试，它似乎没有缓存。这可能与输出缓存有关，还是我应该根据查询字符串参数编写自己的缓存来存储字节数组？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-13T21:51:01.517

尝试删除 Response.End() ，因为这将过早终止线程并防止发生输出缓存。

请参阅：[http ://bytes.com/groups/net-asp/323363-cache-varybyparam-doesnt-work](http://bytes.com/groups/net-asp/323363-cache-varybyparam-doesnt-work)

您*可能*希望考虑使用 ASHX 处理程序并使用您自己的缓存方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T23:56:42.243

正如 Codebrain 所说，使用 ASHX 通用处理程序并使用 HttpRuntimeCache（缓存对象）来完成这项工作。它会更快，更灵活。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-08T11:32:57.127

您的问题可能是[IE 中的错误](http://blogs.msdn.com/b/ieinternals/archive/2009/06/17/vary-header-prevents-caching-in-ie.aspx)- 如果使用 HTTP 响应标头，它无法缓存`Vary:*`，但 IIS 默认返回它，因为它在 HTTP 1.1 规范中。

尝试将以下内容添加到您的 web.config 中：

```
<system.web> 
    <caching>
        <outputCache omitVaryStar="true" />
    </caching>
</system.web> 
```

# html - 省略号在 HTML 中不可见

> ID：745501
> 
> 赞同：4
> 
> 时间：2009-04-13T21:36:30.443
> 
> 标签：html, database, unicode

当从 MySQL 数据库中提取数据到网页时，数据中的所有省略号 (...) 在 Firefox 中显示为 �，在 IE7 中显示为方框。

有没有人遇到过这个问题？

谢谢。

更新 1：我刚刚将原始省略号 '...' 更改为 '...' （三个点），现在它可以工作了吗？知道这可能是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T21:39:32.697

您可能正在将 UTF-8 数据从数据库中提取到具有 ISO（或其他）编码的网站。

您的数据库中的编码是什么，您的 html 的标头编码是什么？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T21:40:09.687

这确实是一个编码问题，但我建议您使用更正确的方法将省略号编码为“…”，而不是试图解决这个问题。HTML 实体。

或者，您可以通过在 Firefox 或 IE 中选择 View > Character Encoding > 来测试它。您很可能最终不得不添加：

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
```

或者

```
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T22:58:46.003

> 我只是用“...”（三个点）更改了原来的省略号“...”，现在它可以工作了吗？

无论如何，这可能是您想要做的。字符[U+2026 HORIZONTAL ELLIPSIS](http://www.fileformat.info/info/unicode/char/2026/index.htm)是一个“兼容性”字符，用于帮助 Unicode 和旧字符集（例如 Windows cp1252（西欧代码页））之间的往返，其中省略号作为一个字符本身存在。

（想法是，在现代系统上，您只需使用三个点；如果字体想要使省略号中的间距不同——大多数人不这样做——它们可以在键入三个点时提供自动连字。）

> 所有省略号的

省略号:-)

> 数据中的数据在 Firefox 中显示为 �，在 IE7 中显示为方框。

可能所有其他非 ASCII 字符都会受到类似影响；使用“智能引号”或 díäçritical 标记时，您可能会看到类似的结果。

您的数据库很可能将字符存储为 Windows cp1252 字节，但您将它们吐出的最终网页是 UTF-8（默认情况下或由于它故意设置为这种方式）。

您可以通过转到浏览器的 View->Encoding 菜单并选择“Western European”（1252）而不是“UTF-8”来检查这一点。虽然您*可以*通过将生成的网页的编码更改为 cp1252 来解决此问题，但最好更改数据库的内容，以便一切都是 UTF-8；那么所有 Unicode 字符都可以在您的应用程序中使用。

你如何做到这一点取决于你使用的语言/平台。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T21:41:33.927

这取决于你的数据库的字符集

你总是可以用 …

# ruby-on-rails - Gem 加载错误，从 Github 安装

> ID：745520
> 
> 赞同：1
> 
> 时间：2009-04-13T21:44:20.563
> 
> 标签：ruby-on-rails, ruby, rubygems

**更新**：这个 gem 使用 sudo rake gems:install 安装。问题在于加载。例如，当我运行脚本/控制台时，它会抛出：

```
no such file to load -- outoftime-noaa ... 
```

即使 sudo rake gems:install 刚刚安装它。我不确定这是否重要，可能确实如此，但它会两次引发此错误。

-=-=-

我希望在我的 Rails 应用程序中为用户提供最新的天气信息。

我正在寻找类似于 outoftime 的 NOAA gem ( [http://github.com/outoftime/noaa/tree/master](http://github.com/outoftime/noaa/tree/master) ) 的东西。

我问的原因是我很难让宝石工作。如果这里有人知道发生了什么，我将不胜感激。

我已将此添加到我的环境配置中：

```
config.gem "outoftime-noaa", :source => "http://gems.github.com" 
```

我跑了

```
sudo rake gems:install 
```

我收到这个错误

```
no such file to load -- outoftime-noaa 
```

我的系统上已经安装了另外两个必需的 gem。我在我的应用程序中使用其中之一（geokit）。

我正在使用 Rails 2.3.2、Ruby 1.8.6 和 Rubygems 1.3.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T23:15:08.647

尝试

```
config.gem "outoftime-noaa", :lib => "noaa", :source => "http://gems.github.com" 
```

大多数 github gem 需要指定的 lib。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T21:48:56.763

'outoftime-noa' 看起来不像是 Rubygems 的一部分。`gem search -r outoftime-noa`没有结果。你做过：`sudo gem sources --add http://gems.github.com`？

如果是这样，您可以手动安装 gem 吗？

编辑：我从未使用过 config.gem （Rails 有太多新功能无法跟踪... ;)），但看起来您需要指定非标准来源，所以：

```
 config.gem "outofime-noa", :source => "http://gems.github.com" 
```

那样有用吗？

# silverlight - Silverlight：获取图像大小

> ID：745525
> 
> 赞同：2
> 
> 时间：2009-04-13T21:46:40.247
> 
> 标签：silverlight, image

有没有办法根据加载在图像控件中的 png 图像的宽度和高度来获取原始图像大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T18:20:39.297

怎么样 - 在您的代码隐藏文件 (.xaml.cs) 中将图像重新加载到新的图像控件中并从中获取宽度和高度？

像这样的东西：

```
System.Windows.Controls.Image img = new System.Windows.Controls.Image();
string UriValue = HtmlPage.Document.DocumentUri.AbsoluteUri + imagefilename;
img.SetValue(System.Windows.Controls.Image.SourceProperty, 
        new System.Windows.Media.Imaging.BitmapImage(new Uri(UriValue)));
double imagewidth = img.Width; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T09:02:53.020

我已经下载了 silverlight 3 beta，它提供了 ImageOpened 事件，它具有可以显示实际图像尺寸的参数

# c++ - 用于 C/C++ 的小型开源 Unicode 库

> ID：745536
> 
> 赞同：16
> 
> 时间：2009-04-13T21:53:15.940
> 
> 标签：c++, c, unicode

有谁知道用于 C 或 C++ 的一个很棒的**小型**开源 Unicode 处理库？我看过[ICU](http://site.icu-project.org/)，但它似乎太大了。

我需要图书馆来支持：

*   所有正常的编码
*   正常化
*   查找字符类型 - 查找是否应在标识符和注释中允许字符
*   验证 - 识别废话

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-13T22:07:34.050

好吧，[iconv](http://www.gnu.org/software/libiconv/)至少是一个很好的起点。

此外，谷歌搜索返回另一个 stackoverflow 问题！惊恐的事件！ [SO：Light C unicode 库](https://stackoverflow.com/questions/313555/light-c-unicode-library)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-13T22:28:05.450

[UTF8-CPP](http://utfcpp.sourceforge.net/)在类似问题的公认答案中被推荐：[Portable and simple unicode string library for C/C++?](https://stackoverflow.com/questions/433301/portable-and-simple-unicode-string-library-for-c-c)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-13T23:38:04.923

我查看了 UT8-CPP 和 libiconv，似乎都没有我需要的所有功能。所以，我想我只会使用ICU，即使它真的很大。我认为有一些方法可以去除不需要的功能和数据，所以我会尝试一下。[此页面](https://unicode-org.github.io/icu/userguide/icu_data/#customizing-icus-data-library)（在“自定义 ICU 的数据库”下）描述了如何删除一些数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T22:19:26.113

您真正需要多少功能？在许多情况下，我发现在内部转换为一种类型（例如 UTF8）并仅在加载或保存时处理各种编码绰绰有余。如果您愿意花一点时间编写一个类来处理它，我相信您会一次又一次地重用它。

我有一个躺在某个地方，但 iirc UTF32LE/BE 未经测试：[http ://aaq.cc/d](http://aaq.cc/d)

如果您的项目确实需要处理各种编码而不是加载/保存文件，那么您可能最好使用库...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-28T09:39:41.680

还可以考虑 Reichwein Unicode 库：[https ://www.reichwein.it/unicode/](https://www.reichwein.it/unicode/)

它是一个快速、独立于语言环境且仅标头的转换和验证库。

# python - 通过 MySQLdb 创建函数

> ID：745538
> 
> 赞同：15
> 
> 时间：2009-04-13T21:54:10.103
> 
> 标签：python, mysql

如何在 python 中使用 MySQLdb 库定义多语句函数或过程？

例子：

```
import MySQLdb

db = MySQLdb.connect(db='service')

c = db.cursor()

c.execute("""DELIMITER //
CREATE FUNCTION trivial_func (radius float) 
    RETURNS FLOAT

    BEGIN
    IF radius > 1 THEN
        RETURN 0.0;
    ELSE
        RETURN 1.0;
    END IF;
END //

DELIMITER ;""") 
```

这将创建以下回溯：

```
Traceback (most recent call last):
  File "proof.py", line 21, in <module>
    DELIMITER ;""")
  File "build/bdist.macosx-10.5-i386/egg/MySQLdb/cursors.py", line 173, in execute
  File "build/bdist.macosx-10.5-i386/egg/MySQLdb/connections.py", line 35, in defaulterrorhandler
_mysql_exceptions.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DELIMITER //\nCREATE FUNCTION trivial_func (radius float) \n    RETURNS FLOAT\n\n   ' at line 1") 
```

如果我将相同的 SQL 直接复制到 mysql shell 客户端中，它会按预期工作

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-13T22:10:30.720

该`DELIMITER`命令是内置的 MySQL shell 客户端，它只能被该程序（和 MySQL 查询浏览器）识别。`DELIMITER`如果直接通过 API 执行 SQL 语句，则无需使用。

的目的`DELIMITER`是帮助您避免`CREATE FUNCTION`在语句本身可以包含分号字符时对语句的终止产生歧义。这在 shell 客户端中很重要，默认情况下，分号终止 SQL 语句。您需要将语句终止符设置为其他字符才能提交函数（或触发器或过程）的主体。

```
CREATE FUNCTION trivial_func (radius float) 
    RETURNS FLOAT

    BEGIN
    IF radius > 1 THEN
        RETURN 0.0; <-- does this semicolon terminate RETURN or CREATE FUNCTION?
    ELSE
        RETURN 1.0;
    END IF;
END 
```

由于 API 通常允许您一次提交一条 SQL 语句，因此没有歧义——接口知道函数定义主体中的任何分号都不会终止整个`CREATE FUNCTION`语句。所以没有必要用`DELIMITER`.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-06-05T22:27:33.923

为了补充 Bill Karwin 的答案，可以使用以下 python 代码示例正确执行使用 DELIMITER 的字符串，例如数据库创建脚本。

```
import MySQLdb

db = MySQLdb.connect(db='service')
cursor = db.cursor()

dbString = """DELIMITER //
CREATE FUNCTION trivial_func (radius float) 
RETURNS FLOAT

BEGIN
IF radius > 1 THEN
    RETURN 0.0;
ELSE
    RETURN 1.0;
END IF;
END //

DELIMITER ;"""

# Find special delimiters
delimiters = re.compile('DELIMITER *(\S*)',re.I)
result = delimiters.split(dbString)

# Insert default delimiter and separate delimiters and sql
result.insert(0,';') 
delimiter = result[0::2]
section   = result[1::2]

# Split queries on delimiters and execute
for i in range(len(delimiter)):
    queries = section[i].split(delimiter[i])
    for query in queries:
        if not query.strip():
            continue
        cursor.execute(query) 
```

这将一次执行一个分隔语句，并在需要时更改分隔符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-06T14:39:21.450

基于@AaronS 的评论。该脚本将读入一个 SQL 文件，将其拆分为离散的 SQL 命令并处理它找到的任何分隔符。

```
 queries = []
    delimiter = ';'
    query = ''
    with open('import.sql', 'r') as f:
        for line in f.readlines():
            line = line.strip()
            if line.startswith('DELIMITER'):
                delimiter = line[10:]
            else:
                query += line+'\n'
                if line.endswith(delimiter):
                    # Get rid of the delimiter, remove any blank lines and add this query to our list
                    queries.append(query.strip().strip(delimiter))
                    query = ''

    for query in queries:
        if not query.strip():
            continue
        cursor.execute(query)
    cursor.close() 
```

# silverlight - Silverlight 图像剪辑如何工作？

> ID：745541
> 
> 赞同：2
> 
> 时间：2009-04-13T21:57:58.097
> 
> 标签：silverlight, geometry, silverlight-2.0

我有一个非常大的图像，我想将其用于精灵技术（à la [css image sprites](http://css-tricks.com/css-sprites/)）。

我有下面的代码：

```
<Image x:Name="testImage" Width="24" Height="12" Source="../Resources/Images/sprites.png">
     <Image.Clip>
         <RectangleGeometry Rect="258,10632,24,12" />
     </Image.Clip>
</Image> 
```

这会将源图像在源图像中 258、10632 的相对位置处剪辑为 24x12。

问题是我希望裁剪后的图像在 testImage 的 0,0 处显示，而在 258、10632 处显示。它使用几何图形作为*切割指南，也用作布局指南*。

任何人都知道这应该怎么做？*如果有的话*。

**结论：** 目前似乎没有什么好的方法可以做到这一点，Graeme 的解决方案似乎与 Silverlight 2.0 最接近。

*也就是说，如果有人知道这样做的更好方法，请回复。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T20:15:32.330

事实证明这是可以做到的。

```
<Rectangle x:Name="myRect" Width="28" Height="12" />

ImageBrush imageBrush = new ImageBrush();
imageBrush.ImageSource = //Load in image source
imageBrush.Stretch = Stretch.None;
imageBrush.AlignmentX = AlignmentX.Left;
imageBrush.AlignmentY = AlignmentY.Top;

TranslateTransform offsetTransform = new TranslateTransform();
offsetTransform.X = -258;
offsetTransform.Y = -10632;

imageBrush.Transform = offsetTransform; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T16:16:54.093

假设你在画布上

```
<Image x:Name="testImage" Width="24" Height="12" Canvas.Left="-258" Canvas.Top="-10632" Source="../Resources/Images/sprites.png">
 <Image.Clip>
     <RectangleGeometry Rect="258,10632,24,12" />
 </Image.Clip> 
```

使用 WPF，您将使用 CroppedBitmap，但不幸的是，Silverlight 中不存在这种情况。

**< 编辑 >**

通过进一步实验，不使用画布的解决方案：

```
<Image x:Name="testImage" Width="24" Height="12" Source="../Resources/Images/sprites.png">
    <Image.Clip>
        <RectangleGeometry Rect="258,10632,24,12" />
    </Image.Clip>
    <Image.RenderTransform>
        <TranslateTransform X="-258" Y="10632"/>
    </Image.RenderTransform>
</Image> 
```

它的作用与画布相同，只是稍微整洁一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T11:25:20.287

Silverlight 3.0 的位图 API 将允许您从精灵图像中抓取剪辑。

请参阅这篇关于[如何在 Silverlight 中裁剪而不是剪辑的帖子](http://blog.blueboxes.co.uk/2009/08/22/how-to-crop-instead-of-clip-in-silverlight/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T19:30:49.820

为什么要这样做，css 图像精灵的全部意义在于通过发出一个请求而不是多个请求来缩短下载时间。但是您可以通过将所有图像放入 xap（或 THE xap）并在一个请求中下载它们来实现相同的目的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-01T09:31:14.663

这是完全可行的——解决方案是使用负边距而不是转换。只需设置负边距顶部和左侧即可吃掉剪辑顶部/左侧的偏移量（在您的示例中为 258,10632）。右边和底部也需要负边距来吃掉源图像的其余部分；右边距的公式是：

-1 * (width_of_source - x_coord_of_clip - width_of_clip_region)

# c - 如何标记带有副作用的代码？

> ID：745544
> 
> 赞同：4
> 
> 时间：2009-04-13T21:59:27.097
> 
> 标签：c, embedded, c-preprocessor, 8051, side-effects

我正在开发一个 8051 上的项目，其中每个字节都很重要。因此，我使用了一些我通常不会使用的全局变量。将指针传递给函数的常规方法在这里增加了太多开销。

除了正常的返回值之外，我有许多函数使用单比特变量（编译器特定的**C扩展）来表示函数的结果。**

```
bit global_error_flag = 0;
bit global_data_ready_flag = 0;

unsigned char A_Function (void) {
    // Do some stuff

    if ( badness ) {
        global_error_flag = 0;
        global_data_ready_flag = 1;

        return 0;
    }

    if ( data_is_ready_use ) {
        global_data_ready_flag = 1;
    }

    return a_value;    
}

void Other_Function (void) {
    unsigned char c;

    c = A_Function();

    if( global_error_flag) {
        // Do error stuff here.
    }
    else
    if( global_data_ready_flag ) {
        // Do data processing here.
    }
    global_error_flag = 0;
    global_data_ready_flag = 0;

} 
```

鉴于该技术是邪恶的，有什么方法可以使代码更清晰吗？

我应该如何最好地指示哪些函数调用会产生设置这些标志的副作用？评论够吗？我应该命名函数以指示它们的 API（准匈牙利风格）吗？我是否应该使用宏来标记此类调用：

```
#define FUNCTION_SETS_FLAGS(code) (code)

FUNCTION_SETS_FLAGS( c = A_Function() ); 
```

还有其他想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T22:13:30.977

使用约定，无论您是否想称其为“匈牙利语”，都是我能想到的最好的临时标记方式。从风格上讲，某种命名前缀比空的#define 更可取，至少对我而言。

我认为这实际上很常见。例如，我知道 S60 编程环境在函数上使用了很多常规标记来指示它们抛出异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T22:13:57.513

为了清楚起见，您的全局变量被标记，这是一个好的开始。

理想情况下，如果你弄错了，你想要一些不会编译的东西。这意味着宏和注释将不起作用。

我会坚持函数的命名约定 - 不一定是匈牙利语，而是类似的东西`A_Function_Returns_Flags`，或者如果你能想到的话，那么冗长。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-13T23:11:22.663

我读了博士学位。在Java中的类似问题上。我可以告诉你一件你不应该做的事情：不要依赖文档，因为那样你就依赖于实际阅读它的人。您需要在方法名称中添加一些提示，以指示用户应该阅读文档以了解副作用。如果您选择某件事并与之保持一致，那么您可能最有机会。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-14T01:22:10.493

如果您只想提及一个函数会影响全局变量，那么一个简单的（匈牙利语）前缀可能会有所帮助。

但是，如果您想提及它影响的每个标志，那么使用函数头可能是要走的路。例如，

```
 /*************************************************************************
     * FUNCTION    : <function_name>
     * DESCRIPTION : <function description> 
     * PARAMETERS  : 
     *  Param1  - <Parameter-1 explanation>
     *  Param2  - <Parameter-2 explanation>
     *  Param3  - <Parameter-3 explanation>
     * RETURN      : <Return value and type>
     * GLOBAL VARIABLES USED: 
     *  Global1 - <Global-1 explanation>
     *  Global2 - <Global-2 explanation>
     *  Global3 - <Global-3 explanation> 
  *************************************************************************/ 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-13T22:22:58.803

这并不能真正帮助您，但是 GCC 有一种与您想要的*相反的方法：标记**没有*副作用的函数。见[`const`](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#index-g_t_0040code_007bconst_007d-function-attribute-2203)和[`pure`](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#index-g_t_0040code_007bpure_007d-function-attribute-2252)属性。这是为了优化而不是文档，认为：如果编译器知道给定函数不检查除参数以外的任何数据，它可以执行更智能的优化，例如[循环不变的代码运动](http://en.wikipedia.org/wiki/Loop-invariant_code_motion)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-14T08:50:10.790

您可以使用宏来模拟具有更多参数的函数：

```
 unsigned char _a_function(void);

#define A_Function(ret_val) (*(ret_val) = _a_function(), !global_error_flag)

...
unsigned char var;
/* call the function */
if (!A_Function(&var))
{
    /* error! */
}
else
{
    /* use var */
    var++;
} 
```

我没有尝试编译它，所以不能说这会起作用，但我认为它应该。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-13T23:04:01.573

首先，我会尝试以一种方式对其进行编码，即每个标志只有一个生产者和一个消费者。然后我只会在需要时清除/设置一个标志。至于表明副作用，函数顶部的标准标题，doxygen 风格，应该足够了：

```
 // Function func
    // Does something
    // Consumes ready_flag and  sets error_flag on error.

    int func()
    {
        if (ready_flag)
        {
            //do something then clear the flag
            if (some_error)
                error_flag = x;
            ready_flag = 0;
        }
        //don't mess with the flags outside of their 'scope'
        return 0;
    } 
```

另一方面，如果错误和就绪标志是互斥的，您可以使用一个字节（或字节/寄存器中的位）来指示就绪或错误状态。

0 表示错误，1 表示未准备好/没有错误，2 表示准备好/没有错误（或 -1、0、1 等）

IIRC，标准的 8051 指令集不能对单个位进行操作，因此将整个字节用于（各种）标志不应给您带来巨大的性能损失。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T18:27:39.953

如果您还没有这样做，您可能还想查看[sourceforge 上的 sdcc 项目](http://sdcc.sourceforge.net)，它是一个专门用于嵌入式开发的 C 编译器，它也针对 8051，此外编译器还支持许多自定义，针对各种用例的特定目标和非标准编译器内在函数，我个人也发现开发团队对新增强和其他相关功能请求的想法非常开放和响应。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-04-16T06:58:07.127

如果你真的必须坚持使用这些全局变量，你可以通过期望将它们作为函数参数的引用来明确一个函数可以修改它们：

```
unsigned char A_Function (bit *p_error_flag, bit *p_data_ready_flag)
{
  ...
} 
```

# iphone - 导入错误

> ID：745548
> 
> 赞同：8
> 
> 时间：2009-04-13T22:01:13.143
> 
> 标签：iphone, objective-c

我第一次将另一个项目中的类文件添加到我的新 iPhone 窗口中。该类是一个简单的类，它定义了一个多边形，并且是 NSObject 的子类。作为 Objective C 类的标准模板的一部分，这个类定义导入了 Cocoa.h

```
#import <Cocoa/Cocoa.h> 
```

但是，仅通过添加此类，我就会收到一个错误

```
Cocoa/Cocoa.h:No such file or directory. 
```

我不明白这一点，因为完全相同的行出现在同一个项目的另一个类定义（控制器）中。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-13T22:07:40.227

NSObject 的子类（至少在 iPhone 上）不导入 Cocoa.h 标头。相反，他们导入 Foundation.h：

```
#import <Foundation/Foundation.h> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-14T00:46:47.270

在 iPhone 上，您通常使用 UIKit 而不是用于 Mac OS X 的 Cocoa。

```
#import <UIKit/UIKit.h> 
```

您可能只在不引用任何用户界面内容的模型类中导入 Foundation 框架。

```
#import <Foundation/Foundation.h> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-10T20:47:41.793

当您从数据模型（在 iPhone 项目中）生成 NSManagedObject 子类时，可能会发生这种情况，我假设在更高版本的 XCode 中这将得到修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T16:16:46.253

Project Target->“Build Settings”->“Base SDK”，然后选择“Latest OS X(OS X 10.x)”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-16T23:46:43.560

当我不小心覆盖了 testApp-Prefix.pch 代码时，我遇到了这个问题。

然后删除了添加#import的代码（如上所述）

一旦我注意到并撤消错误就消失了

# hash - 对哈希感到困惑

> ID：745549
> 
> 赞同：4
> 
> 时间：2009-04-13T22:02:01.647
> 
> 标签：hash

说我有一个 5000 个字符的文本。我通过一个散列程序运行它并生成一个 40 字符长的散列。现在我运行另一个文本块，10000 个字符。它仍然会生成一个 40 个字符长的哈希值。对于任何长度的文本都是如此。

我的问题是，如果哈希都是唯一的，我不能将任何东西压缩成 40 个字符的字符串吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-13T22:05:38.453

散列不是唯一的。

散列是一种尝试为提供给它的每个值生成唯一散列的技术，但不能保证它是唯一的。

好的散列算法比差的散列算法具有重复散列值的频率要低得多。此外，散列是一种方向性的——这意味着你不能从散列 -> 原始的，所以它不意味着压缩。

并且：哈希不需要是唯一的。相同的输入需要通过算法转换成相同的哈希。您不使用哈希作为标识符！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-13T22:06:47.233

并非所有哈希都保证是唯一的。关于该主题的维基百科条目非常好：[http ://en.wikipedia.org/wiki/Hash_function](http://en.wikipedia.org/wiki/Hash_function)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-13T23:34:56.307

考虑哈希的一种方式就像人类指纹（哈希有时也称为指纹）。

您可以将任何人“压缩”为（几乎）唯一的指纹。但是，您无法仅凭指纹知道某人是谁。这就像哈希一样，您可以轻松计算出`hash("abcdef") -> a1b2c3`，但仅给出`a1b2c3`，你不能随便告诉源数据。

要反转指纹，您需要将指纹与已知的数据库进行比较`people->finger-prints`（如果未知指纹与 Person1 匹配，则未知指纹属于他们）

使用散列，你必须再次做同样的事情——你有一个包含所有字符串->散列映射的数据库（称为[彩虹表](http://en.wikipedia.org/wiki/Rainbow_table)）。然后你用散列“a1b2c3”查找行，它显示“abcdef”是为了得到这个而散列的。另一种更常见的方法是简单地尝试每个字符组合，将它们散列并比较（[蛮力攻击](http://en.wikipedia.org/wiki/Brute_force_attack)）

最后，虽然人类指纹是“唯一的”，但可能有两个相同的指纹，但可能性极小——哈希算法也是如此……一些哈希算法比其他算法更容易发生[冲突](http://en.wikipedia.org/wiki/Hash_collision)。

> 我的问题是，如果哈希都是唯一的，我不能将任何东西压缩成 40 个字符的字符串吗？

从理论上讲，散列是一种很好的压缩方法，但解压缩超出（比如说）10 个 ASCII 字符的数据是非常不切实际的。你是对的，你可以将任何内容压缩为 40 个字符的字符串，但实际上你不能解压缩它（即使理论上是有点牵强。。）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-13T22:05:38.000

RSA 哈希不是唯一的。当散列两个不同的明文位时，您会产生误报的可能性非常小（大约为 1:36^40）。对于大多数应用程序，这种可能性被认为足够小，您可以忽略它，因为平均需要数百万年才能看到意外碰撞。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-13T22:22:09.240

散列是为了**尽可能地传播**，而不是为了唯一！

当然，达到唯一性是达到 100% 的传播，但这通常是不可能的，无论你的散列算法有多好。

引人注目的例子：

例如，C# 为每个对象提供一个 Int32 代码作为 HashCode ... Int64 也是如此：

```
 Int64 a = Int64.MaxValue;
       Int32 myHash =  a.GetHashCode(); 
```

结论：Int64 有 2^64 个不同的可能实例，但它们只有 2^32 个哈希码！

所以：Int64 的每个哈希值由（平均）共享

> 4 294 967 295

其他 Int64 的！

这么多的独特性嘿:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-13T22:46:48.900

[考虑从鸽巢原理](http://en.wikipedia.org/wiki/Pigeonhole_principle)的角度来看这个问题。如果您将 n 个项目填充到较少数量的桶 k 中，则必然会有一些包含多个项目的桶。因此，要回答您的问题，没有散列不是唯一的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-13T23:40:43.797

散列不保证是唯一的，但如果您正在寻找唯一的散列，请查看[gperf](http://www.gnu.org/software/gperf/)。它可以为一组预先确定的输入生成一个唯一的散列函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-13T22:09:23.453

您可以将任何文本的签名压缩为哈希，但您不能反向计算文本是什么给您该哈希。简单地说，找出给你散列的文本是什么的唯一方法是通过散列暴力破解文本以尝试找到匹配项。

见[维基百科](http://en.wikipedia.org/wiki/Hash_function)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-13T22:24:50.763

不要对 .Net GetHashCode() 感到困惑。这不是很好，因为它只有 32 位，而原始问题中的 640 位（如果每个字符都是 8 位）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-13T22:29:21.237

如果您正确使用定义明确的散列函数，您实际上可以假设散列结果是唯一的。

问题，您的问题是哈希是单向函数。没有反函数可以取值并返回到原始 blob。除非您保留所有可能的原始值的巨大表（所谓的[彩虹表](http://en.wikipedia.org/wiki/Rainbow_table)）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-14T00:45:04.967

它们不是唯一的，但是在找到两个具有相同哈希值的高质量算法（例如 SHA-1）的不同文档之前，您更有可能死于心脏病发作

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-03-06T03:51:16.963

我认为这是一个很好的解释： [http ://www.cprogramming.com/tutorial/computersciencetheory/hash-table.html](http://www.cprogramming.com/tutorial/computersciencetheory/hash-table.html)

# c# - C# .NET - 如何将文件加载到数据集中？

> ID：745553
> 
> 赞同：3
> 
> 时间：2009-04-13T22:03:36.463
> 
> 标签：c#, file, dataset

我需要将文件（通常是 ASCII）加载到`DataSet`. 我怎样才能做到这一点？我的列应该使用哪些数据类型？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T22:05:01.340

您可以使用 byte[] 作为类型，

也许像这样的 DataTable 对您有用

```
DataTable dt = new DataTable("files");
dt.Columns.Add("name", typeof(string));
dt.Columns.Add("size", typeof(int));
dt.Columns.Add("content", typeof(byte[])); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T22:07:24.410

不确定这是否是您要查找的内容，但您可以在此处找到示例：

[从分隔的文本文件中填充数据集](http://www.codeproject.com/KB/database/DataSetFrmDelimTxt.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T23:11:49.933

DataSet 是一个巨大的无类型漏洞，它应该是你最不担心的。添加一些反射以增加脆弱性，您应该会在几秒钟内到达那里。它最终也会有大量的演员表。

再次糟糕的设计，列可以是任何东西，因此您可以以您或他们想要的任何方式添加或检索任何类型，并且您的语法将被损坏。你没有编译时安全，很简单。

更好地键入您的数据，然后通过扩展方法将无类型的灰尘传递给 DataSet。XML 孩子对 XML 文件做同样的事情（这就像疯了一样）。

# windows-vista - 在 Windows（Vista 和 XP）上安装 Exuberant Ctags

> ID：745560
> 
> 赞同：28
> 
> 时间：2009-04-13T22:05:52.713
> 
> 标签：windows-vista, ctags

我想在工作时在 Vista（可能还有 XP 笔记本电脑）上使用 Exuberant Ctags；操作系统别无选择。我使用 GVim 而不是我的同事推荐的 Flex Builder，因为 FB 有问题，并且无论如何都没有做 GVim 所做的事情。我在[这里](http://prdownloads.sourceforge.net/ctags/ec57w32.zip)得到了 zip 文件。Ctags 安装文件说，除其他外：

```
    mk_bc3.mak 用于 MSDOS，使用 Borland C/C++ 3.x
    mk_bc5.mak 用于使用 Borland C++ 5.5 的 Win32
    mk_djg.mak 用于使用 DJGPP Gnu GCC 的 MSDOS（最好遵循 Unix 安装）
    mk_ming.mak 对于 Win32 使用 Mingw32
    mk_mvc.mak 使用 Microsoft Visual C++ 的 Win32

```

我真的不明白这意味着什么（我对每个想法都有一些了解，但不是像这样放在一起），但我选择了最后一个选项，因为听起来最有可能成功。我以管理员身份打开命令提示符，cd 到解压缩的 ec57w32 文件夹，然后输入 mk_mvc.mak。

Visual Studio 欢迎我使用转换向导，并提出在我同意之前进行备份，但转换失败。转换日志显示，由于项目文件损坏，无法加载项目。当我再次下载，再次解压缩并且没有备份文件时，同样的事情发生了；以及当我尝试其他每个 mk 命令时。一路上没有其他选择。

我还能尝试什么？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-04-13T16:45:27.563

丰富的 ctags 二进制文件是预先构建的，可从[http://ctags.sourceforge.net/下载](http://ctags.sourceforge.net/)

1.  将文件内容解压缩到 C:\Program Files\ctags 之类的地方
2.  然后将 ctags.exe 路径添加到您的 PATH 环境变量中。
    1.  在 XP 中，右键单击我的电脑并选择属性。
    2.  移动到高级选项卡，然后单击环境变量按钮。
    3.  单击系统变量选择框，找到并突出显示路径变量。
    4.  单击编辑按钮。
    5.  附加到变量值“;C:\Program Files\ctags”（不带引号）。

现在在命令外壳中，您应该能够使用命令 ctags 来生成标签。创建标签文件：

```
ctags -R "C:\Documents and Settings\My User\My Documents\My Code" 
```

由于您使用的是 vim，因此您可能需要 taglist 插件（如果我有足够的声誉，我会链接到该插件）。您无需创建标签文件即可使用此插件。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-13T22:10:35.027

windows zip 文件已经包含一个已编译的 ctags.exe，因此您不需要自己进行构建。打开 CMD 并从那里查看 ctags。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-13T22:10:48.987

如果您可以选择，我认为阻力最小的途径是使用 Cygwin。如果你从 cygwin 安装 cygwin 和 ctags 包，你只需要打开 cygwin shell 并从你的源代码目录运行`ctags`（或者`ctags -R`如果你希望它是递归的，你可能会这样做）。无需以这种方式构建任何东西。

# .net - .Net 中的 SAX 等效项

> ID：745561
> 
> 赞同：0
> 
> 时间：2009-04-13T22:06:02.290
> 
> 标签：.net, xml, push, sax

.Net 中的 SAX (Java) 是否有任何等价物？我知道 XmlReader，但我正在寻找一个推送解析器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T22:09:34.263

如果您熟悉 SAX，那么您可能会喜欢[SAXDotNet](http://saxdotnet.sourceforge.net/)。文档中解释了差异和扩展（对 Java）。[在这里](http://sourceforge.net/projects/saxdotnet/)下载。

SAXDotNet 有一个问题：最后一次更改是从 2006 年开始的。

# c# - 什么会导致我的请求计时器报告如此长的请求执行时间？

> ID：745562
> 
> 赞同：0
> 
> 时间：2009-04-13T22:06:32.600
> 
> 标签：c#, asp.net, http

我在[这里](http://haacked.com/archive/2008/07/02/httpmodule-for-timing-requests.aspx)使用代码的修改版本。不同之处在于我将它记录到数据库中，并且仅当它长于 5000 毫秒时。结果让我很担心。几个页面偶尔会记录几分钟的执行时间。他们永远不会一直表现不佳，但根据日志表，这种情况经常发生，我需要深入了解它。

所以我把它扔在这里，看看社区有什么样的想法。也许是由于应用程序重新启动？重新编译？也许 httpmodule 中有一些细微的缺陷会导致它误报时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T22:37:27.253

Run your application through a profiler to see which methods are taking up the most processing time.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T23:10:06.677

尝试密切注意数据库上的锁定，这可能是数据库锁定问题，因为这发生在我身上并导致非常相似的症状。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T23:13:25.343

检查系统事件日志以查看是否有任何相关事件。寻找服务重启或服务崩溃等。

您将需要记录更多信息，直到您可以查明问题。希望它只发生在特定页面上，因此您可以通过这种方式将其隔离...在您真正理解之前不要陷入尝试解决问题的陷阱。

# iphone - 如何从 iPhone 的后台线程正确调用 SQLite 函数？

> ID：745565
> 
> 赞同：7
> 
> 时间：2009-04-13T22:07:14.567
> 
> 标签：iphone, objective-c, multithreading, sqlite

我在我的 iPhone 应用程序中使用 SQLite 数据库。在启动时，我想在单独的线程中执行一些数据库操作。（我这样做主要是为了减少启动时间。）

偶尔/随机，当这些数据库调用是从后台线程进行时，应用程序将崩溃并出现以下错误：

```
2009-04-13 17:36:09.932 Action Lists[1537:20b] *** Assertion failure in -[InboxRootViewController getInboxTasks], /Users/cperry/Dropbox/Projects/iPhone GTD/GTD/Classes/InboxRootViewController.m:74
2009-04-13 17:36:09.932 Action Lists[1537:3d0b] *** Assertion failure in +[Task deleteCompletedTasksInDatabase:completedMonthsAgo:], /Users/cperry/Dropbox/Projects/iPhone GTD/GTD/Classes/Data Classes/Task.m:957
2009-04-13 17:36:09.933 Action Lists[1537:20b] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Error: failed to prepare statement with message 'library routine called out of sequence'.'
2009-04-13 17:36:09.933 Action Lists[1537:3d0b] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Error: failed to prepare statement with message 'library routine called out of sequence'.' 
```

尽管我无法可靠地重现该错误，但我确信这是因为 SQLite 函数在两个活动线程中都被调用。我*应该*如何从单独的线程调用 SQLite 函数？有没有我错过的技巧？我对 iPhone、SQLite 和 Objective-C 还很陌生，所以对你来说可能很明显，但对我来说并不那么明显。

以下是一些代码示例。

MainApplication.m:

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {

    // Take care of jobs that have to run at startup
    [NSThread detachNewThreadSelector:@selector(startUpJobs) toTarget:self withObject:nil];
}

// Jobs that run in the background at startup
- (void)startUpJobs {

    // Anticipating that this method will be called in its NSThread, set up an autorelease pool.
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    // Get user preferences
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

    // This Class Method calls SQLite functions and sometimes causes errors.
    [Task revertFutureTasksStatus:database];

    [pool release];
} 
```

任务.m：

```
static sqlite3_stmt *revert_future_statement = nil;

+ (void) revertFutureTasksStatus:(sqlite3 *)db {

    if (revert_future_statement == nil) {
        // Find all tasks that meet criteria
        static char *sql = "SELECT task_id FROM tasks where ((deleted IS NULL) OR (deleted=0)) AND (start_date > ?) AND (status=0) AND (revert_status IS NOT NULL)";
        if (sqlite3_prepare_v2(db, sql, -1, &revert_future_statement, NULL) != SQLITE_OK) {
            NSAssert1(0, @"Error: failed to prepare update statement with message '%s'.", sqlite3_errmsg(db));
        }
    }

    // Bind NOW to sql statement
    NSDate *now = [[NSDate alloc] init];
    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    [formatter setDateFormat:@"yyyy-MM-dd"];
    NSString *nowString = [formatter stringFromDate:now];
    sqlite3_bind_text(revert_future_statement, 1, [nowString UTF8String], -1, SQLITE_TRANSIENT);
    [now release];
    [formatter release];

    // We "step" through the results - once for each row.
    while (sqlite3_step(revert_future_statement) == SQLITE_ROW) {

        // Do things to each returned row

    }

    // Reset the statement for future reuse.
    sqlite3_reset(revert_future_statement);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-08-22T08:11:55.687

我已经尝试了这两种解决方案，并且效果很好。您可以使用临界区或 NSOperationQueue，我更喜欢第一个，这是它们的代码：

定义一些类“DatabaseController”并将此代码添加到其实现中：

```
static NSString * DatabaseLock = nil;
+ (void)initialize {
    [super initialize];
    DatabaseLock = [[NSString alloc] initWithString:@"Database-Lock"];
}
+ (NSString *)databaseLock {
    return DatabaseLock;
}

- (void)writeToDatabase1 {
    @synchronized ([DatabaseController databaseLock]) {
        // Code that writes to an sqlite3 database goes here...
    }
}
- (void)writeToDatabase2 {
    @synchronized ([DatabaseController databaseLock]) {
        // Code that writes to an sqlite3 database goes here...
    }
} 
```

或者使用 NSOperationQueue 你可以使用：

```
static NSOperationQueue * DatabaseQueue = nil;
+ (void)initialize {
    [super initialize];

    DatabaseQueue = [[NSOperationQueue alloc] init];
    [DatabaseQueue setMaxConcurrentOperationCount:1];
}
+ (NSOperationQueue *)databaseQueue {
    return DatabaseQueue;
}

- (void)writeToDatabase {
    NSInvocationOperation * operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(FUNCTION_THAT_WRITES_TO_DATABASE) object:nil];
    [operation setQueuePriority:NSOperationQueuePriorityHigh];
    [[DatabaseController databaseQueue] addOperations:[NSArray arrayWithObject:operation] waitUntilFinished:YES];
    [operation release];
} 
```

这两个解决方案会阻塞当前线程，直到完成对数据库的写入，在大多数情况下您可能会考虑这样做。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-13T23:54:44.387

该错误消息映射到 SQLITE_MISUSE（源代码可在[http://www.sqlite.org](http://www.sqlite.org)获得）。

有关从多个线程使用 sqlite3 * 数据库句柄的限制，请参阅[http://www.sqlite.org/faq.html#q6 。](http://www.sqlite.org/faq.html#q6)实际上，您可以跨线程重用数据库句柄和语句，但一个线程必须在另一个线程启动之前完全访问数据库（即重叠访问是不安全的）。这听起来像是发生在你身上的事情，并且与 SQLITE_MISUSE 错误代码一致。

如果您需要从多个线程访问同一个数据库，我建议改为从每个线程单独打开数据库并使用 sqlite3_busy_timeout() 设置超时。然后，Sqlite 将为您处理争用，如果另一个线程正在写入数据同时仍允许同时读取，则在一个线程中阻塞一小段时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-02T19:03:03.373

如果您想在多个线程上不受限制地使用 SQLite，请在打开连接之前执行以下操作：

sqlite3_shutdown();
sqlite3_config（SQLITE_CONFIG_SERIALIZED）；
sqlite3_initialize();

[http://www.sqlite.org/threadsafe.html](http://www.sqlite.org/threadsafe.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T23:44:06.313

SQLite 句柄（`sqlite3_stmt *`当然，`sqlite3 *`我认为）是特定于线程的。从多个线程调用它们的正确方法是为每个线程维护一组单独的句柄。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T00:02:29.670

我会使用 NSOperation 并在启动期间在那里做所有事情。NSOperation 摇滚。我有说多少 NSOperation 摇滚？确实如此。摇滚，就是这样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-10T23:02:50.590

如果您仍然没有上述任何运气，您可以尝试使用 EnormEGO [https://github.com/jdp-global/egodatabase的这个包装器](https://github.com/jdp-global/egodatabase)

他们使用异步回调，这可能会用一块石头杀死两只鸟。

查看我的 **EGODatabaseRequest 自述文件部分 - 对 db 的异步请求**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-20T12:06:57.260

您最好的选择是使用 GCD（Grand Central Dispatch）队列来防止同时访问 sqlite 数据库。

使用任何形式的锁定（包括将被多个数据库实例使用的文件锁定）都可能导致忙碌的等待，这是一种浪费。

请参阅[我](https://stackoverflow.com/a/20088593/2403761)对类似问题的回答。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-02-24T09:20:50.610

我的解决方案是删除我设备上的应用程序（我想删除我创建的数据库）。这为我解决了这个问题。

# c# - 编号列表框

> ID：745568
> 
> 赞同：24
> 
> 时间：2009-04-13T22:07:35.937
> 
> 标签：c#, wpf, listbox

我有一个排序的列表框，需要显示每个项目的行号。在这个演示中，我有一个带有 Name 字符串属性的 Person 类。列表框显示按姓名排序的人员列表。如何将行号添加到列表框的数据模板中？？？

XAML：

```
<Window x:Class="NumberedListBox.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300">
    <ListBox 
        ItemsSource="{Binding Path=PersonsListCollectionView}" 
        HorizontalContentAlignment="Stretch">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Path=Name}" />
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>
</Window> 
```

后面的代码：

```
using System;
using System.Collections.ObjectModel;
using System.Windows.Data;
using System.Windows;
using System.ComponentModel;

namespace NumberedListBox
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            Persons = new ObservableCollection<Person>();
            Persons.Add(new Person() { Name = "Sally"});
            Persons.Add(new Person() { Name = "Bob" });
            Persons.Add(new Person() { Name = "Joe" });
            Persons.Add(new Person() { Name = "Mary" });

            PersonsListCollectionView = new ListCollectionView(Persons);
            PersonsListCollectionView.SortDescriptions.Add(new SortDescription("Name", ListSortDirection.Ascending));

            DataContext = this;
        }

        public ObservableCollection<Person> Persons { get; private set; }
        public ListCollectionView PersonsListCollectionView { get; private set; }
    }

    public class Person
    {
        public string Name { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2010-09-16T17:11:24.510

最后！如果找到一种更优雅并且可能具有更好性能的方式。（另请参阅[在添加时访问 ItemsControl 项](https://stackoverflow.com/questions/2007177/accessing-an-itemscontrol-item-as-it-is-added/2007747#2007747)）

我们为此“滥用”了该属性`ItemsControl.AlternateIndex`。最初它旨在以不同的方式处理每隔一行`ListBox`。（参见[http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.alternationcount.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.alternationcount.aspx)）

**1\. 将 AlternatingCount 设置为 ListBox 中包含的项目数量**

```
<ListBox ItemsSource="{Binding Path=MyListItems}"
         AlternationCount="{Binding Path=MyListItems.Count}"
         ItemTemplate="{StaticResource MyItemTemplate}"
...
/> 
```

**2.绑定到 AlternatingIndex 你的 DataTemplate**

```
<DataTemplate x:Key="MyItemTemplate" ... >
    <StackPanel>
        <Label Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplatedParent.(ItemsControl.AlternationIndex)}" />
        ...
    </StackPanel>
</DataTemplate> 
```

因此，这无需转换器即可工作，额外`CollectionViewSource`且最重要的是无需暴力搜索源集合。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-13T22:42:42.063

This should get you started:

[http://weblogs.asp.net/hpreishuber/archive/2008/11/18/rownumber-in-silverlight-datagrid-or-listbox.aspx](http://weblogs.asp.net/hpreishuber/archive/2008/11/18/rownumber-in-silverlight-datagrid-or-listbox.aspx)

It says it's for Silverlight, but I don't see why it wouldn't work for WPF. Basically, you bind a TextBlock to your data and use a custom value converter to output the current item's number.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T16:31:43.850

David Brown 链接中的想法是使用有效的值转换器。下面是一个完整的工作示例。列表框有行号，可以按姓名和年龄排序。

XAML：

```
<Window x:Class="NumberedListBox.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:NumberedListBox"
    Height="300" Width="300">

    <Window.Resources>

        <local:RowNumberConverter x:Key="RowNumberConverter" />

        <CollectionViewSource x:Key="sortedPersonList" Source="{Binding Path=Persons}" />

    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>
        <ListBox 
            Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
            ItemsSource="{Binding Source={StaticResource sortedPersonList}}" 
            HorizontalContentAlignment="Stretch">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock 
                            Text="{Binding Converter={StaticResource RowNumberConverter}, ConverterParameter={StaticResource sortedPersonList}}" 
                            Margin="5" />
                        <TextBlock Text="{Binding Path=Name}" Margin="5" />
                        <TextBlock Text="{Binding Path=Age}" Margin="5" />
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
        <Button Grid.Row="1" Grid.Column="0" Content="Name" Tag="Name" Click="SortButton_Click" />
        <Button Grid.Row="1" Grid.Column="1" Content="Age" Tag="Age" Click="SortButton_Click" />
    </Grid>
</Window> 
```

后面的代码：

```
using System;
using System.Collections.ObjectModel;
using System.Windows.Data;
using System.Windows;
using System.ComponentModel;
using System.Windows.Controls;

namespace NumberedListBox
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            Persons = new ObservableCollection<Person>();
            Persons.Add(new Person() { Name = "Sally", Age = 34 });
            Persons.Add(new Person() { Name = "Bob", Age = 18 });
            Persons.Add(new Person() { Name = "Joe", Age = 72 });
            Persons.Add(new Person() { Name = "Mary", Age = 12 });

            CollectionViewSource view = FindResource("sortedPersonList") as CollectionViewSource;
            view.SortDescriptions.Add(new SortDescription("Name", ListSortDirection.Ascending));

            DataContext = this;
        }

        public ObservableCollection<Person> Persons { get; private set; }

        private void SortButton_Click(object sender, RoutedEventArgs e)
        {
            Button button = sender as Button;
            string sortProperty = button.Tag as string;
            CollectionViewSource view = FindResource("sortedPersonList") as CollectionViewSource;
            view.SortDescriptions.Clear();
            view.SortDescriptions.Add(new SortDescription(sortProperty, ListSortDirection.Ascending));

            view.View.Refresh();
        }
    }

    public class Person
    {
        public string Name { get; set; }
        public int Age { get; set; }
    }
} 
```

值转换器：

```
using System;
using System.Windows.Data;

namespace NumberedListBox
{
    public class RowNumberConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            CollectionViewSource collectionViewSource = parameter as CollectionViewSource;

            int counter = 1;
            foreach (object item in collectionViewSource.View)
            {
                if (item == value)
                {
                    return counter.ToString();
                }
                counter++;
            }
            return string.Empty;
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-03-16T04:44:02.897

又一个答案。我尝试了上述方法，它适用于 WPF（`AlternationCount`解决方案），但我需要 Silverlight 的代码，所以我做了以下操作。这比其他蛮力方法更优雅。

```
<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
  xmlns:local="clr-namespace:RowNumber" x:Name="userControl"
  x:Class="RowNumber.MainPage" Width="640" Height="480">
<Grid x:Name="LayoutRoot" Background="White">
  <ListBox ItemsSource="{Binding Test, ElementName=userControl}">
     <ListBox.Resources>
        <local:ListItemIndexConverter x:Key="IndexConverter" />
     </ListBox.Resources>
     <ListBox.ItemTemplate>
        <DataTemplate>
           <StackPanel Orientation="Horizontal">
              <TextBlock Width="30"
                    Text="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Converter={StaticResource IndexConverter}}" />
              <TextBlock Text="{Binding}" />
           </StackPanel>
        </DataTemplate>
     </ListBox.ItemTemplate>
  </ListBox>
</Grid>
</UserControl> 
```

而在后面

```
 using System;
  using System.Collections.Generic;
  using System.Globalization;
  using System.Linq;
  using System.Windows.Controls;
  using System.Windows.Controls.Primitives;
  using System.Windows.Data;

  namespace RowNumber
  {
     public class ListItemIndexConverter : IValueConverter
     {
        // Value should be ListBoxItem that contains the current record. RelativeSource={RelativeSource AncestorType=ListBoxItem}
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
           var lbi = (ListBoxItem)value;
           var listBox = lbi.GetVisualAncestors().OfType<ListBox>().First();
           var index = listBox.ItemContainerGenerator.IndexFromContainer(lbi);
           // One based. Remove +1 for Zero based array.
           return index + 1;
        }
        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) { throw new NotImplementedException(); }
     }
     public partial class MainPage : UserControl
     {
        public MainPage()
        {
           // Required to initialize variables
           InitializeComponent();
        }
        public List<string> Test { get { return new[] { "Foo", "Bar", "Baz" }.ToList(); } }
     }
  } 
```

这是 Silverlight 5 中引入`RelativeSource`绑定的新功能。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2016-07-01T13:38:12.950

为什么不只是绑定到列表框的计数属性。

```
 <ListView x:Name="LstFocusImageDisplayData"

                          >
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <GroupBox Header="Item Count">
                                <DockPanel>
                                    <TextBlock Text="{Binding ElementName=LstFocusImageDisplayData, Path=Items.Count, Mode=OneTime}" />
                                </DockPanel>
                            </GroupBox>

                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView> 
```

# c# - 使用 OrderBy() 后返回正确的类型

> ID：745571
> 
> 赞同：8
> 
> 时间：2009-04-13T22:08:42.270
> 
> 标签：c#, linq, generics, casting

我有一个继承自`List<>`. 我已经设置了一个函数来按某个属性对列表进行排序，如下所示：

```
public PlaylistCollection SortByName(IEnumerable<Playlist> playlists)
{
    return (PlaylistCollection)playlists.OrderBy(p => p.Name);
} 
```

当我尝试在我的代码中使用排序结果时：

```
artistSource.Playlists = (PlaylistCollection)new List<Playlist>(artistSource.Playlists.SortByName(artistSource.Playlists)); 
```

我得到错误：

```
Unable to cast object of type 'System.Linq.OrderedEnumerable`2[...Playlist,System.String]'
 to type '...PlaylistCollection'." 
```

考虑到 VS 告诉我存在显式转换，这有点令人沮丧，所以我添加了上述演员表。

我如何正确地从`IEnumerable<>`我的收藏中转换？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-13T22:10:31.873

如果不进一步了解 PlayListCollection 类型，很难知道正确答案是什么。但是假设它是一个标准样式集合类，它的构造函数采用 IEnumerable<T>，那么下面的代码应该可以解决问题。

扩展方法

```
public IEnumerable<Playlist> SortByName(IEnumerable<Playlist> playlists)
{
    return playlists.OrderBy(p => p.Name);
} 
```

方法的使用

```
var temp = artistSource.Playlists.SortByName(artistSource.Playlists);
artistSource.PlayList = new PlaystListCollection(temp); 
```

如果没有，请发布有关 PlayListCollection 的更多信息，特别是构造函数和实现的接口，我们应该能够帮助您解决问题。

**编辑**

如果上述代码不起作用，您可以使用以下扩展方法创建 PlaylistCollection 类的实例。

```
public static PlaylistCollection ToPlaylistCollection(this IEnumerable<Playlist> enumerable) {
  var list = new PlaylistCollection();
  foreach ( var item in enumerable ) {
    list.Add(item);
  }
  return list;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T15:46:28.633

似乎您在寻找如何转换结果的方式更少，而更多地寻找如何将其填充到`List<>`. 我一直在寻找一种简单的方法来做同样的事情，并找到了以下解决方案：

```
artistSource.PlayList = playlists.OrderBy(p => p.Name).ToList<PlayList>(); 
```

`ToList`扩展方法在 .NET 3.5 中可用。以下链接包含其他信息：

[Enumerable.ToList 方法 (MSDN)](http://msdn.microsoft.com/en-us/library/bb342261%28v=vs.90%29)

[按创建日期 C# 对 List<FileInfo> 进行排序](https://stackoverflow.com/questions/9001544/sorting-a-listfileinfo-by-creation-date-c-sharp)

# java - Java 的依赖项查找器 Jini ClassDep 的类路径问题

> ID：745574
> 
> 赞同：0
> 
> 时间：2009-04-13T22:09:44.043
> 
> 标签：java, classpath, jini

我开始使用 Sun 的[ClassDep](http://java.sun.com/products/jini/2.0/doc/api/com/sun/jini/tool/ClassDep.htm)作为[解决方案，以防止在生成的 WAR 应用程序中包含不必要的 JAR](https://stackoverflow.com/questions/707194/tool-to-remove-unnecessary-dependencies-in-a-java-project)。它似乎在摇摆。但是，这头野兽很难驯服！

即使它们明确包含在我传递给它的类路径中，我也会遇到几个找不到类的错误。例子：

```
找不到：org.apache.log4j.Logger：没有文件：Logger
找不到：org.hibernate.Session：没有文件：会话
找不到：org.joda.time.LocalDate：没有文件：LocalDate
```

但是...查看我给它的一段类路径：

```
...;"C:\Documents and Settings\Andre\Desktop\workspace\icaro\WebContent\WEB-INF\lib\hibernate3.jar";...;"C:\Documents and Settings\Andre\Desktop\workspace\icaro\WebContent\WEB-INF\lib\joda-time-1.5.2.jar";"C:\Documents and Settings\Andre\Desktop\workspace\icaro\WebContent\WEB-INF\lib\log4j-1.2.11.jar";... 
```

我浏览了这些文件，发现“缺失”的类实际上在这些文件中。

任何人都知道什么给了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-18T15:01:15.950

I see you are running on windows. Could you be running into the infamous "Input line it too long" exception?

It's possible your Classpath is too long if you're including a large number of jar files.

This [post by Hung Huynh (Terracotta)](http://unserializableone.blogspot.com/2007/10/solution-to-classpath-too-long-aka.html) has a better explanation of the issue and a couple of options for how you can handle it if this is the problem you're having.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T10:18:02.580

难道你的罐子有问题吗？通常，如果是类路径问题，您会收到 NoClassDefFoundError。

对此进行调查的一些方法是

1.  显示程序中的类路径 (System.out.println(System.getProperty("java.class.path");

2.  如果您正在使用类加载器的层次结构，请让类加载器在应用程序的各个点显示加载类的 URL (System.out.println(Thread.currentThread().getContextClassLoader().getResource("org/apache /log4j/Logger.class");

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T11:16:26.493

这些条目可能位于您引用的一个或多个 JARS 的清单文件中。清单文件条目被 Classdep 忽略，因此会给您错误。

请参阅`ClassDep`文档：

*如果您使用 JAR 文件，则这些 JAR 文件中的任何 Class-Path 清单条目都将被忽略，因此您必须在路径中明确包含这些清单条目的值，否则可能会导致错误。例如，如果您包含 jini-ext.jar，那么您也应该显式包含 jini-core.jar，因为 jini-core.jar 位于 jini-ext.jar 的 Class-Path manifest 条目中。*

# iphone - 如何转义 iPhone 的文件系统路径？

> ID：745580
> 
> 赞同：2
> 
> 时间：2009-04-13T22:11:24.977
> 
> 标签：iphone, file, path, system, escaping

是否有用于转义 iPhone 开发的文件系统路径的系统库？我必须读取和写入文件名基于 3rd 方值的文件，所以我想确保我实际写入的路径是好的和安全的。

我原以为有一个 NS 库可以为我做这件事，因为这是每个开发人员可能不应该重写的“简单”类型的函数，但如果有的话我找不到它。

谢谢！

编辑：感谢您的回复， stringByStandardizingPath: 看起来很适合获取字符串的真实文件路径，但我正在寻找的内容类似于以下内容：

```
in:  @"~/Foo/Bar"
out: @"__Foo_Bar" or @"FooBar" etc. 
```

基本上它会从文件路径组件中删除任何不安全的字符。

经过继续研究，文件路径中几乎允许除“/”之外的任何 unicode 字符。但是，文件路径通常很脆弱，可以通过转义序列等进行操作，所以我希望 Apple 的聪明人有一个 API 可以去除不安全值的文件路径组件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T23:07:52.907

你可以试试 NSString 的`- (NSString *)stringByStandardizingPath`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T21:26:46.757

I would say go with a whitelist, maybe `[a-zA-Z0-9_. ]`, or maybe something a little more complex, and simply encode any others into hex, similar to how url's encode spaces into '%20'

# c# - .Net 中的 Decimal.One、Decimal.Zero、Decimal.MinusOne 的用途是什么

> ID：745591
> 
> 赞同：74
> 
> 时间：2009-04-13T22:16:13.967
> 
> 标签：c#, .net, vb.net, decimal, constants

简单的问题 - 为什么 Decimal 类型定义这些常量？何苦？

我正在寻找为什么这是由语言定义的原因，而不是对编译器的可能用途或影响。为什么一开始就把这个放在那里？编译器可以像 Decimal.Zero 一样轻松地内联 0m，所以我不购买它作为编译器快捷方式。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-13T22:30:29.643

小澄清。它们实际上是静态只读值而不是常量。这在 .Net 中有明显的区别，因为常量值由各种编译器*内联*，因此无法在编译的程序集中跟踪它们的使用。然而，静态只读值不会被复制，而是被引用。这对您的问题有利，因为这意味着可以分析它们的使用。

如果您使用反射器并深入研究 BCL，您会注意到 MinusOne 和 Zero 仅在 VB 运行时中使用。它主要用于服务十进制和布尔值之间的转换。为什么使用 MinusOne 恰好在今天出现在一个单独的线程上（[链接](https://stackoverflow.com/questions/745292/convert-boolean-to-integer-in-vb-net/745366#745366)）

奇怪的是，如果您查看 Decimal.One 值，您会发现它在任何地方都没有使用。

至于为什么明确定义它们......我怀疑有一个硬性和快速的原因。**似乎**没有具体的表现，只有一点点方便的措施可以归因于它们的存在。我的*猜测*是，它们是在 BCL 开发过程中为了方便而被某人添加的，并且从未被删除。

**编辑**

`const`在@Paleta 发表评论后，深入研究了这个问题。的 C# 定义`Decimal.One`使用`const`修饰符，但是它`static readonly`在 IL 级别作为 a 发出。C# 编译器使用了一些技巧来使这个值与 a 几乎无法区分`const`（例如内联文字）。这将出现在一种能够识别这个技巧的语言中（VB.Net 能识别这一点，但 F# 不能）。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-13T22:26:03.303

一些 .NET 语言不支持十进制文字，在这些情况下，编写 Decimal.ONE 而不是 new Decimal(1) 更方便（也更快）。

出于同样的原因，Java 的 BigInteger 类也有零和一。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-13T22:23:43.183

我对此的***看法***是，它们的存在是为了帮助避免幻数。

幻数基本上在您的代码中的任何地方，您有一个任意数字浮动。例如：

```
int i = 32; 
```

这是有问题的，因为没有人知道*为什么*i 被设置为 32，或者 32 表示什么，或者它是否应该是 32。它神奇而神秘。

同样，我会经常看到执行此操作的代码

```
int i = 0;
int z = -1; 
```

为什么将它们设置为 0 和 -1？这只是巧合吗？他们有什么意思吗？谁知道？

虽然`Decimal.One`,`Decimal.Zero`等不会告诉您值在应用程序上下文中的含义（可能零表示“丢失”等），但它*确实*告诉您该值是故意设置的，并且可能具有某些含义。

虽然并不完美，但这总比什么都不告诉你要好得多:-)

**注意***不是* 为了优化。观察这个 C# 代码：

```
public static Decimal d = 0M;
public static Decimal dZero = Decimal.Zero; 
```

使用 ildasm 查看生成的字节码时，两个选项都会产生*相同*的MSIL。`System.Decimal`是一种值类型，因此`Decimal.Zero`并不比仅使用文字值更“最佳”。

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2010-08-02T23:38:39.633

那三个值啊啊啊！！！

我认为它们可能与我所说**的尾随 1有关**

说你有这个公式：

> (x)1.116666 + (y) = (z)2.00000

但是**x** , **z**被四舍五入为**0.11**和**2.00**，你被要求计算 (y)。

所以你可能会想`y = 2.00 - 1.11`。实际上**y**等于**0.88**但你会得到**0.89**。（有**0.01**的差异）。

取决于 x 和 y 的实际值，结果将在**-0.01**到**+0.01**之间变化，在某些情况下，在处理一堆尾随 1 时，为了方便起见，您可以检查尾随值是否等于`Decimal.MinusOne / 100`，`Decimal.One / 100`或`Decimal.Zero / 100`修复它们。

这就是我使用它们的方式。

# php - performance implications of php output buffering with Apache and MySQL

> ID：745595
> 
> 赞同：4
> 
> 时间：2009-04-13T22:16:57.553
> 
> 标签：php, mysql, performance, apache

I am a bit confused about how php buffering works.

Let's say you have a php page `foo.php` and `output_buffering = 4096` in `php.ini`, and Apache receives a get request for `foo.php`. `foo.php` starts executing, and as soon as 4096 bytes are ready, they are sent to Apache. Apache starts sending those 4096 bytes to the client.

Here's what I don't understand: what happens when there's a some nasty tracker callout, a javascript or an image that was sent to the browser. The browser gets hung up and is not talking back to Apache for a while, holding it up. Apache is not releasing MySQL thread, which is showing up as a "sleeper". Is this correct or am I completely off base here?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T23:07:55.417

你完全不在基地:)

> 当有一些讨厌的跟踪器标注、javascript 或发送到浏览器的图像时会发生什么

这不会对服务器端产生任何影响。

通过 PHP 运行的每个请求都会

1.  编译所需的 PHP 文件以选择代码（除非缓存是其中之一）
2.  执行 PHP opt-code
3.  将 PHP opt-code 的字符串结果返回给浏览器

您正在谈论的缓冲发生在第 2 步和第 3 步之间。所以，让我们来看看您的场景。

1.  请求 PHP URL
2.  opt-code 已编译
3.  PHP Execution 开始并开始返回 html 字符串
4.  创建了一个加载缓慢的 img 标签的字符串
5.  *   PHP 继续向 apache 提供输出
    *   为图像（或 javascript 代码或其他任何内容等）发出单独的 http 请求

单独的请求在这里无能为力。PHP 和 Apache 所做的只是将 HTML 返回到浏览器。此 HTML 可能会生成一个 img 或 javasript 标记，该标记将回调到同一 Web 服务器，但这些请求将与为现有页面生成 HTML 的请求分开处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T22:41:20.863

The browser doesn't get ‘hung up’ from downloading HTML data from the server. It continues to download the entire page, even if it is waiting on a JavaScript file to come down before it will actually show any of it.

Of course if the browser/server connection breaks for some reason you can get Apache hanging around waiting for ACKs until the connection times out, but this is not the usual case.

# python - semantic markup for Python's difflib.HtmlDiff

> ID：745600
> 
> 赞同：1
> 
> 时间：2009-04-13T22:17:39.017
> 
> 标签：python, diff, semantics

It appears Python's `difflib.HtmlDiff`, rather than using `INS` and `DEL`, uses `SPAN` elements with custom classes:

```
python -c 'import difflib; txt1 = "lorem ipsum\ndolor sit amet".splitlines(); txt2 = "lorem foo isum\ndolor amet".splitlines(); d = difflib.HtmlDiff(); print d.make_table(txt1, txt2)' 
```

Before I go about fixing this myself, has anyone looked into this already? Is there perhaps a valid reason for not using POSH? (Google wasn't a big help here... )

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-29T20:34:10.447

[Aaron Swartz 的这个脚本](http://www.aaronsw.com/2002/diff/)使用 difflib 来输出`ins`/ `del`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-06T19:56:07.933

python 错误跟踪器在这里：[http ://bugs.python.org/](http://bugs.python.org/)

在这个问题上没有公开的错误，我猜这是因为大多数人不会关心它是什么类型的 html，只要它有效。如果它对您很重要，请提交错误并提交补丁。

# c# - C# 中的 ICMP，SocketException - 被访问权限禁止

> ID：745602
> 
> 赞同：1
> 
> 时间：2009-04-13T22:18:21.277
> 
> 标签：c#, icmp

我正在尝试让[此处找到的 ICMP 代码](http://www.digigrupp.com/ping/icmpsocket.cs.aspx)正常工作。但是在这一行：

```
Socket = new System.Net.Sockets.Socket(System.Net.Sockets.AddressFamily.InterNetwork,
                                       System.Net.Sockets.SocketType.Raw,
                                       System.Net.Sockets.ProtocolType.Icmp); 
```

我得到 SocketException：“试图以访问权限禁止的方式访问套接字”（本机错误代码：10013）

以管理员模式运行是一种（不好的）解决方案，但由于我希望我的程序在用户级别上运行，你会建议什么？也欢迎其他 ICMP 方法。

我一直在尝试使用“ClickOnce”安全设置，但没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T22:31:43.103

自 Windows 2000 以来，ICMP 和原始套接字仅限于管理员用户。您尚未说明您要做什么，但您可以尝试使用 NetworkInformation 命名空间来实现您的目标：[NetworkInformation](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.aspx)

它包括一个[Ping](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx)类来发送 ICMP 回显请求。

# jquery - Would hooking an AJAX function into a link work?

> ID：745608
> 
> 赞同：0
> 
> 时间：2009-04-13T22:20:37.047
> 
> 标签：jquery, html, ajax, hyperlink

I have a site where I have a lot of outgoing links and I would like to count the clicks to those outgoing links.

I need to keep the links need to be visible. (as in, no Digg like links or redirects).

So I was thinking of hooking some jQuery function to all outgoing links. This function then calls a PHP script via AJAX that updates the counter.

I have done similar things with form submitting. Where the form's onsubmit does a return of a JavaScript function. But does it work with onclick and links? Wondering about scenarios like when a person middle clicks in Firefox to get a new tab.

BTW I do not care about people with JavaScript off. They will just go to the link and not be counted, it's fine.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-13T22:33:40.133

I know this isn't directly answering your question, but you might want to rethink redirects (if done the Google way). Taken from [someone else's answer](https://stackoverflow.com/questions/714966/capture-who-clicked-a-link-from-website-a-to-website-b/714988#714988):

> Google has found a sneaky way around this problem by actually using Javascript to change the link instead of the status bar. When the page is loaded, the links in the results list go to their actual destinations, but every link has an onmousedown javascript event that changes the link when you click on it. You can see this in action by right-clicking on a link. After you've done that, hovering over the link will now show the true destination (Google's click-tracking script) in the status bar instead of the result's real URL.

That way you could maintain visible links but also be able to monitor traffic via redirects. (As I understand it, your only opposition to redirects are the accessibility of links - if there's more, then ignore this answer.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T22:36:16.523

You might need client-side javascript which can make an XMLHTTPRequest to a webservice or a page with parameters (e.g. unique client id)

```
<a href="http://www.google.com" onclick="registerClick(this.document.getElementById('uniqueId')); return true;">google</a> 
```

Here register click could be a function that can make a request to a server-side page, which can become the click register.

# c# - How to disable subsampling with .NET / GDI+?

> ID：745610
> 
> 赞同：4
> 
> 时间：2009-04-13T22:21:32.957
> 
> 标签：c#, gdi+, jpeg, system.drawing

I am trying to save a JPEG image using the Bitmap class. I noticed that sharp edges were always blury regardless of the quality level that I specify. I figured out that it is due to subsampling of one or more of the channels. How do I disable subsampling when saving the image?

I am currently using this code:

```
EncoderParameters parameters = new EncoderParameters(1);
parameters.Param[0] = new EncoderParameter(Encoder.Quality, 85L);

ImageCodecInfo codec = GetEncoderInfo("image/jpeg");
image.Save(path, codec, parameters); 
```

### NOTE

I know that JPEG is lossy, but that's not the issue here. If I use ImageMagick and save the image with the default options, I get similar results. However, if I specify 1:1:1 subsampling, the blurring disappears.

I do not want to use PNG because I need better compression. If I save the image as BMP and then convert it manually to JPEG, I get excellent results, without blurring. Therefore, the format is not the issue here.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T22:28:26.247

JPEG is an image format which uses [lossy compression](http://en.wikipedia.org/wiki/Lossy_compression). It will cause degredation of your image, no matter what quality setting you choose.

Try using a better format for this, such as .PNG. Since .PNG files use a lossless compression algorithm, you will not get the artifacts you are seeing.

* * *

The problem (after reading your edits) is probably due to the fact that GDI+ uses 4:1:1 subsampling for JPG files in it's default Encoder.

I believe you could either install another encoder (not sure how to do this). Otherwise, I'd recommend using something like MagickNet to handle saving your JPG files. (It's a .net wrapper for ImageMagick - there are a couple of them out there.)

* * *

Edit 2: After further looking into this, it looks like you may be able to have some effect on this by tweaking the Encoder [Luminance Table](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.encoder.luminancetable.aspx) and [Chrominance Table](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.encoder.chrominancetable.aspx).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-12T18:12:56.510

两天来我一直试图弄清楚如何做到这一点，这让我大吃一惊，M$ 不会在 GDI+ 中包含如此简单的功能。作为替代方案，我通过在 libjpeg 周围编写一个小的包装函数来实现我自己的 Bitmap -> Jpeg 压缩器。关键步骤是像这样关闭子采样：

 `````
struct jpeg_compress_struct cinfo;
...
jpeg_set_defaults(&cinfo);
cinfo.comp_info[0].h_samp_factor = 1;
cinfo.comp_info[0].v_samp_factor = 1;
cinfo.comp_info[1].h_samp_factor = 1;
cinfo.comp_info[1].v_samp_factor = 1;
cinfo.comp_info[2].h_samp_factor = 1; 
````  `但是，这给我带来了另一个问题：libjpeg 不支持编写 exif 标签，我也需要它。当然 GDI+ 不会在不重新编码 jpg 的情况下添加标签，这完全违背了目的。我查看了 libexif，但无法在 Visual Studio 下编译。如果有人确实想出了一种方法来禁用 GDI+ 中的二次采样，我仍然很想听听……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T18:21:41.313

您是否更改了 Graphics 对象的 SmoothingMode 属性？在我的实验中，我发现将 SmoothingMode 值指定为默认值以外的任何值都会模糊锐利的边缘。试试看是否有帮助。

# javascript - Ruby on Rails，Javascript 检测

> ID：745613
> 
> 赞同：10
> 
> 时间：2009-04-13T22:22:57.897
> 
> 标签：javascript, ruby-on-rails

我正在创建一个 Web 应用程序，它使用 Rails 内置帮助函数向站点添加 ajax 功能。我不希望用户能够在没有 JS 的情况下使用该应用程序，因为它无法正常运行。

我需要能够防止这种情况发生。我怎样才能阻止用户在没有 JS 的情况下加载我的任何页面？

我试图在我的布局中使用标签。这会检测到 JS 的缺失，但仍会呈现视图。将脚本标签放在 yield 周围可以防止呈现任何视图。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-13T22:47:16.093

您可以`noscript`在元素中有一个块，其中`head`包含一个元刷新标签。例子：

```
<head>
    <!-- title, scripts, css etc go here -->
    <noscript>
        <meta http-equiv="refresh" content="2;url=http://yoursite.com/nojswarning.html">
    </noscript>
</head> 
```

[您可以在此处](http://webdesign.about.com/od/metataglibraries/a/aa080300a.htm)阅读有关元刷新的更多信息

希望这可以帮助

**编辑：**为了澄清，`noscript`标签仅在为用户关闭 JavaScript 时运行。所以在这种情况下，如果 JS 被关闭，用户将被重定向到`http://yoursite.com/nojswarning.html`. 当然，您可以将其更改为您想要的任何站点上的任何页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T22:47:33.080

简单的答案是通过 JS 加载整个应用程序。这样，该应用程序将永远不会显示给启用了 JS 的人。

另一种方法是使用 iframe 开始您的页面，该 iframe 会加载到 JS 检查页面。该页面所做的只是通过 JS 将用户重定向到应用程序的真实 URL。因此，如果用户没有 JS，他们将不会被重定向（您可以通知他们他们需要带有 <noscript> 标记的 JS）。（我说要使用 iframe，这样您就不会为非 JS 用户提供一个简单的 URL 来访问应用程序。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T02:44:26.163

`<noscript></noscript>`似乎可行。我会将默认设置为带有覆盖的小型加载器，如果客户端不支持 javascript，则 javascript 永远不会隐藏加载器。并且`<noscript>`标签中的内容将与覆盖一起显示。

# apache-flex - 用于 Java 或 BlazeDS 的 WebORB？

> ID：745623
> 
> 赞同：3
> 
> 时间：2009-04-13T22:25:03.773
> 
> 标签：apache-flex, jakarta-ee, glassfish, blazeds, weborb

我正处于使用 flex 前端和 java/glassfish 后端的项目的开始阶段。我很好奇哪种技术更好地连接两者，WebORB 或 BlazeDS。乍一看，WebORB 似乎更容易处理，但 BlazeDS 拥有更大的支持社区。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T02:13:24.520

关于 WebORB 我不能说太多，因为我从未使用过它，但我已经广泛使用了 BlazeDS，它是一款可靠的产品。它相对容易安装，并且有[据可查](http://livedocs.adobe.com/blazeds/1/blazeds_devguide/)。

作为一个额外的好处，它是一个官方的 Adob​​e 开源产品，有工程师和测试人员负责解决社区问题:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T04:10:35.893

一个重要的问题是您打算使用哪些功能：通过 HTTP/AMF 直接进行 RPC 调用、消费者/生产者风格的消息传递、您是否需要 RTMP 等？

一文不值的重要事情是 WebOrb 社区版不支持集群，您需要购买企业版才能获得它。如果我没记错的话，Blaze DS 确实支持通过 JGroups 进行集群。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T20:02:56.460

我也开始使用 Flex + Java，所以我比较了这两者。在第一次尝试 BlazeDS 时，我发现了一个可怕的限制：BlazeDS 不能很好地处理 Hibernate 的延迟初始化；而且我看到的所有解决方案似乎都不是很好。

有人知道用 BlazeDS 处理 Lazy 的好方法吗？

* * *

请参阅 /blazeds-vs-graniteds-vs-weborb-vs-lifecycleds-for-business-applications-on-flex-and-java/

在 artemgolubev(dot)com

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-02T18:42:51.093

虽然 WebORB 社区版不支持集群，但它确实支持 100 多个并发用户，BlazeDS converts 告诉我这是 BlazeDS 的限制。

此外，我和我的同事刚刚完成了集成选择指南，该指南已发表在 Flash&Flex 开发者杂志 9 月刊（2010 年）（可在 ffdmag(dot)com 在线获取。我们已尝试捕捉您正在寻找的重要功能并要求其他集成服务器供应商在本指南的下一次更新中做出贡献。

最后，我只想正式宣布 WebORB for Java v.4.0 已经发布。有两个免费版本（开发模式和社区版）。

# symlink - 如何在 Ubuntu 中为文件夹/文件创建递归符号链接？

> ID：745630
> 
> 赞同：0
> 
> 时间：2009-04-13T22:28:10.617
> 
> 标签：symlink

**我的文件夹结构**

```
/UNIX
    /Find
    /Grep
    /Find-Grep 
```

我创建了一个指向 UNIX 文件夹的符号链接，但没有成功

```
ln -s /I/Unix path/Dropbox/myFriend 
```

我在 /Dropbox/myFriend/Unix/Find/.todo 中删除了一个 .todo 文件。我注意到我在 /I/Unix/Find 的 .todo 文件也被删除了。

**您如何创建符号链接**，以便我的朋友可以看到我的文件，但他不能在我的计算机中删除我的文件？

[编辑]

第一个问题解决了：我们可以创建一个递归符号链接。

但是，当我们在 Dropbox 中使用符号链接时，我们还没有找到不允许我的朋友删除我计算机中的文件的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T22:40:58.557

我打算建议重新安装目录绑定，ro

```
mount -o bind,ro /I/Unix /Dropbox/myFriend 
```

但似乎该功能还没有在内核中。可能在你的，但不在我的 ubuntu 盒子里。因此，或者（而不是更改所有文件的权限）您可以将目录以只读方式导出到 nfs。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T22:33:51.413

更改文件的权限，使他没有组或其他写入权限。

你可以这样做：

```
chmod g-w,o-w -R /I/UNIX/ 
```

```
crb@server ~ $ ls -l 测试/目录
共 0
-rwxrwxrwx 1 crb crb 0 2009-04-14 10:35 示例文件
crb@server ~ $ chmod gw,ow -R 测试/目录
crb@server ~ $ ls -l 测试/目录
共 0
-rwxr-xr-x 1 crb crb 0 2009-04-14 10:35 示例文件

```

# javascript - 事件捕获与使用 contentEditable div 冒泡

> ID：745644
> 
> 赞同：0
> 
> 时间：2009-04-13T22:35:03.173
> 
> 标签：javascript, event-handling

我正在处理一个内容可编辑的 div，我需要处理在将字符添加到 div 之前和之后捕获击键。

我对捕获与冒泡的理解是，事件首先在 dom 树的最高级别捕获，然后将其向下传递，而对于冒泡，它从最低级别开始并向上冒泡。

基于这种理解，我认为如果我在捕获阶段添加一个事件监听器，可编辑 div 的内容将反映击键发送*之前的文本。*如果我在冒泡阶段添加事件侦听器，则 d​​iv 的文本内容将包含我刚刚键入的字符。

但情况似乎并非如此：无论是在捕获阶段还是在冒泡阶段添加事件侦听器，div 的内容都不会包含最近键入的字符。

这是一个简单的测试用例来尝试一下：

```
<div id="captureTest" contentEditable='true' style='height: 30px; width: 400px; border-style:solid; border-width:1px'></div>

<script type="text/javascript">
    var div = document.getElementById('captureTest');
    div.addEventListener("keydown", function() {alert('capture: ' + this.innerHTML)}, true);
    div.addEventListener("keydown", function() {alert('bubble: ' + this.innerHTML)}, false);
</script> 
```

我希望第二个函数的输出在输入字符后包含 div 的新文本，但情况似乎并非如此。

我的问题是：有没有办法从内容可编辑的 div 中捕获击键事件并在键入键*后获取内容？*我需要这个来实现提前输入功能。

我知道我可以停止该事件，然后使用 executeCommand('insertHTML')，但是在处理删除、退格、粘贴和其他类型的插入时会出现问题，因此这不是解决方案。

我正在 Firefox 3 中对此进行测试。我知道 IE 没有 addEventListener 方法。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T22:51:23.867

您需要 2 个不同的回调，一个用于**keydown**，另一个用于**keyup**或**keypress**（仅当元素同时注册 keydown + keyup 时才会触发）。

# c# - 在显式 LINQ-to-SQL (C#) 中，顺序是否重要？

> ID：745650
> 
> 赞同：2
> 
> 时间：2009-04-13T22:37:58.250
> 
> 标签：c#, linq, linq-to-sql, lambda

我知道 Linq-to-SQL 已经死了，但无论如何，我认为这真的很基本，我只是对 Linq-to-SQL 对它生成的 SQL 有什么神奇作用和没有什么作用感到困惑。

如果我建立了一个表达式树作为“myPredicate”，并且有这样的东西：

```
(from request in DataContext.RequestsTable
select request).Where(myPredicate)
               .OrderByDescending(item => item.changeDate)
               .Take(10) 
```

它会像下面的 SQL 一样工作吗：

```
SELECT TOP 10 * FROM RequestsTable
WHERE (<<myPredicate equivalent>>) 
ORDER BY ChangeDate DESC 
```

这对我来说似乎很奇怪，因为在我的示例代码中，“.Where()”出现在“select”之后。“select”和“where()”和“orderby()”的相对定位会影响事情吗？

或者，我可以用 sql-esque 语法来做这一切吗？例如，有没有办法在替代语法中使用我的 WHERE 谓词，像这样？

```
(from request in DataContext.RequestsTable
 where [somehow inject myPredicate]
 order by changeDate descending
 select request).Take(10) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T22:46:39.027

您在那里有相同的查询，LINQ to SQL 不会评估和生成 T-SQL，直到您完成执行查询的操作（例如 .ToList() 例如。排序无关紧要.

事实上，您甚至可以在初始查询的赋值之后添加 OrderBy 和 Where 子句。

例如

```
var query = (from x in context.RequestsTable
             select x);

query = query.AsQueryable().Where(<>);

return query.ToList(); //executes 
```

是相同的：

```
return (from x in context.RequestsTable
            where <>
            select x).ToList(); //executes 
```

是相同的：

```
return (from x in context.RequestsTable
        selext x).Where(<>).ToList(); 
```

我不确定 LINQ to SQL 是否“已死”，但我听说它可能会被纳入 ADO 实体框架。LINQ to SQL 生成的 T-SQL 远远优于实体框架！

# sql - SQL Server 在将值转换为字符串/从字符串转换时是否考虑文化/区域设置？

> ID：745652
> 
> 赞同：1
> 
> 时间：2009-04-13T22:39:50.570
> 
> 标签：sql, sql-server, culture

我正在尝试更新大型代码库以正确指定`CultureInfo`和/或`IFormatProvider`格式化/解析值时。例如，在解析我从用户那里获得的值时，我`CultureInfo.CurrentCulture`在调用时传递`TryParse`，当将浮点数转换为字符串以保持持久性时，我`CultureInfo.InvariantCulture`在调用时传递`ToString`。

我的问题是：在生成 SQL 查询时，我应该使用不变的文化或 SQL 服务器的文化来格式化数字等吗？也就是说，如果我的电脑设置为 German（德国），这些查询中哪个是对的？

```
select foo from bar where baz = 123.45 
```

或者

```
select foo from bar where baz = 123,45 
```

同样，如果我使用 SQL`CAST`将浮点值转换为字符串，那么 SQL 将使用什么语言环境进行转换？

我确实搜索了 SQL 文档，但到目前为止我找不到任何好的答案。我确实找到了一些有关日期格式的信息（SET DATEFORMAT 等），但仅此而已。

**注意**：我意识到将输入传递给 SQL 查询的首选方法是通过参数，因此我们假设为了参数，我有充分的理由将它们格式化为查询字符串。此外，处理查询输入只是更广泛问题的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T07:01:20.320

它会抛出一个错误。SQL Server 的语言只影响日期/时间值。

```
SET LANGUAGE Deutsch
SELECT 'true' WHERE 1 <> 123,45

--gives
Msg 102, Level 15, State 1, Line 2
Falsche Syntax in der Nähe von ','.
There is far too much ambiguity in number formats

SET LANGUAGE Deutsch
SELECT 'true' WHERE 1 <> 123.45
--gives true 
```

我在瑞士，必须处理所有这三个问题......

*   1.234,56 (德)
*   1'234,56 (CH)
*   1,234.56 (EN-GB)

# internet-explorer - 使用多个 IE 的 IE6 不允许我编辑文本框

> ID：745666
> 
> 赞同：5
> 
> 时间：2009-04-13T22:44:33.057
> 
> 标签：internet-explorer, browser, internet-explorer-6

不确定这是否算作编程相关，这是我使用的工具。

我已经安装了[多个 IE](http://tredosoft.com/Multiple_IE)，所以我可以为那些需要它的人测试我在 IE6 上创建的网站，但最近 IE6 不允许我进入任何文本框，它们的行为就好像它们都被禁用了一样。

有没有其他人遇到过这个问题和/或知道解决方案。我已经尝试卸载并重新安装多个ie。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T23:48:17.693

在 tredosoft 网站上的评论中发现，安装[IE8 会破坏](http://tredosoft.com/Multiple_IE?page=6)多 IE 浏览器中的文本框和文本区域。我卸载了 IE8 并解决了这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T22:52:55.407

我使用 Multipe IE 进行测试，但最近我正在尝试[SuperPreview](http://www.webdesignerdepot.com/2009/03/microsoft-announces-superpreview-for-ie-browser-testing/)。

SuperPreview 是来自 Microsoft 的新免费独立应用程序（仍处于测试阶段），它使您能够查看您的网站在不同版本的 Internet Explorer 中的外观，从而比以前更容易从 IE6 迁移到 7 和 8，而无需启动虚拟机器运行IE6，或者有一台单独的计算机专门运行IE6。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T00:16:54.273

使用 Microsoft 免费提供的应用兼容 VHD。Virtual PC 也是免费的。

[http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)

您不能随机获取系统 dll 的子集并将它们并排托管并期望一切正常。这就像期待 1982 年克尔维特的发动机在 2005 年奥迪 S4 上工作一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T23:43:09.640

是的，这只是影响多 IE 设置的奇怪的小行为/脚本怪异之一。

遗憾的是，虚拟机方法是测试跨不同版本 IE 的 Web 浏览器交互（而不仅仅是呈现）的唯一可靠方法。（感谢您将其集成到 Microsoft 操作系统中。是的。）

不过，这是一个很好的借口来告诉你的老板证明一个更强大的工作站是合理的，嗯......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-22T16:00:25.177

我刚刚安装了[IE Collection](http://finalbuilds.edskes.net/iecollection.htm)，到目前为止它对我来说比 Multiple IE 好得多。我仍然必须卸载 IE8 才能让表单输入工作，但它带有一个独立版本，所以我仍然可以使用 8 进行测试。

它也有很多版本（比 Multiple IE 多得多）。如果您正在寻找一些老式的乐趣，请启动 1.5 并访问几乎任何网站。

# sql - 基于触发器的历史

> ID：745672
> 
> 赞同：1
> 
> 时间：2009-04-13T22:47:26.263
> 
> 标签：sql, triggers, history, tracking, sql-update

我要做的是找出哪些字段已更新并将更改记录到另一个表中。

```
DECLARE 
    @BillNo int,
    @column_name varchar(500)  

SELECT @BillNo = BillNo FROM INSERTED
DECLARE HistoryMonitorLoop CURSOR FOR
    SELECT    
        column_name 
    FROM 
        information_schema.columns
    WHERE 
        table_name = 'Shipment';
OPEN HistoryMonitorLoop
FETCH next FROM HistoryMonitorLoop INTO @column_name
WHILE @@Fetch_status = 0
BEGIN
    DECLARE
        @OldValue varchar(500),
        @NewValue varchar(500)
    SET @OldValue = (SELECT @column_name FROM Deleted);
    SET @NewValue = (SELECT @column_name FROM Inserted);
    IF(@OldValue != @NewValue)
    BEGIN
        DECLARE @Comment varchar(5000)
        SELECT @Comment = @column_name + ' Changed from ' + @OldValue + ' to ' + @NewValue
        EXEC ShipmentNote_Insert @BillNo=@BillNo,@CoordinatorID=1,@Comment=@Comment
    END
    FETCH next FROM HistoryMonitorLoop INTO @column_name
END
CLOSE HistoryMonitorLoop
DEALLOCATE HistoryMonitorLoop 
```

正在发生的事情是

```
SET @OldValue = (SELECT @column_name FROM Deleted);   
SET @NewValue = (SELECT @column_name FROM Inserted); 
```

正在将`@OldValue`and `@NewValue`= 设置为列名而不是列的值 - sql 将其处理为`SET @OldValue = (SELECT 'column_name' FROM Deleted);`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T02:24:32.590

> 我想做的是找出更新了哪些字段

在 SQL Server 中，有两个函数可以完全满足您的需求。

*   [Columns_Updated()](http://msdn.microsoft.com/en-us/library/ms186329.aspx) - 检查是否在触发器中插入/删除了一个或多个列
*   [Update()](http://msdn.microsoft.com/en-us/library/ms187326.aspx) - 检查触发器内是否更新了单个列

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T02:48:09.163

See this [Pop on the Audit Trail](http://www.simple-talk.com/sql/database-administration/pop-rivetts-sql-server-faq-no.5-pop-on-the-audit-trail/) 它使用循环中的查询而不是游标来执行您想要执行的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T23:23:40.887

这行不通：

```
SET @OldValue = (SELECT @column_name FROM Deleted);
SET @NewValue = (SELECT @column_name FROM Inserted); 
```

您在这里尝试动态 sql，但这是行不通的。您必须对 SQL 进行硬编码，变量`@column_name`不会被其值动态替换，因为触发器的 SQL 在触发器运行之前被解析一次。有了这个，你（取决于你的设置）可能会得到列名的字面值。

可以获得动态 SQL（通过在另一个进程*中*连接到服务器，或在 MySQl 中通过创建准备好的语句），但不可能这样做*并*引用触发器中可用的“魔术”`INSERTED`和`DELETED`伪表。

所以你巧妙地使用 information_schema.columns 是行不通的。您可以做的是利用这种聪明才智编写存储过程来生成触发器（这实际上是我在编写审计触发器时所做的）。然后，每当您更改`Shipment`表时，您都必须运行 sp 以生成“create trigger....”statmentnt，然后运行*该*生成的语句以重新创建触发器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T14:15:42.087

我会重新考虑你的整个过程。如果编写不当，触发器可能会成为巨大的性能杀手。每当您认为需要使用游标或循环时，请三思。您需要以基于集合的方式执行此操作。

我们使用两表触发方法。一个记录有关何时和谁更改表的详细信息以及包含已更改信息的相关表。这有助于我们查看一次更改的所有记录。我们为每个字段使用更新的语句来填充第二个表，例如：

```
if (update([test]))
  begin
    insert [myAudit].dbo.[mytableAuditLogDetail](AuditLogID, ID, ColumnName,   
                                                 OldValue, NewValue)
    select
      @AuditLogID,
      i.[mytableid]),
      'test',
      convert(varchar(8000), d.[test], 0),
      convert(varchar(8000), i.[test], 0)
    from  inserted i
    inner join deleted d on i.[mytableid]=d.[mytableid]
      and (
      (i.[test] <> d.[test]) or 
      (i.[test] is null and d.[test] Is Not Null) or
      (i.[test] is not null and d.[test] Is Null)
          )         
   end 
```

每次模式更改时，我们都会动态重建触发器代码，但触发器本身不是动态的。即使我们进行大量导入，我们的触发过程也运行得非常快。

# design-principles - What features any good application should care about 'By-Design'

> ID：745675
> 
> 赞同：10
> 
> 时间：2009-04-13T22:48:20.910
> 
> 标签：design-principles

I know that the default answer is "it depends", but I want to know the feature list you are working from in developing a good application.

I'm particularly interested in features that need to be cared about at design time because adding them late will cost us a lot.

**Please list one feature per answer so we can vote for the most important features.**

Any extra info, like your own war stories, will be appreciated.

I ask this question to enhance my application from day zero, and I think I'm not the only one with this target, so please write whatever feature YOU think should be exist in a good application.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-13T22:49:21.390

**Logging and error handling**

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-13T23:27:37.213

**安全**。很有趣，如果不足为奇的话，这是第十四个答案。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-13T23:54:44.480

**用户界面/体验设计**许多技术创新依赖于 UI 设计来将其技术复杂性提升为可用产品。仅靠技术 [通常] 并不能赢得用户的认可和随后的适销性。

来自[IBM](http://www.ibm.com/developerworks/library/us-myth.html)：

> 在软件开发中，设计被广泛误解和低估。通常没有明确的用户界面设计与代码分开进行。然后迭代设计变成了重新编码。这是一种短视的策略，因为从长远来看，它会导致编写更多的代码。因为设计是不可避免的，真正的问题是它是隐含在正在开发的软件中，还是显式地单独捕获。有用的辩论是关于如何做好设计工作，以及如何以最佳形式捕捉它以便与实施它的人交流。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-13T23:16:26.583

**国际化**。
事后添加它可能会很昂贵

潜在的陷阱：

*   非英语操作系统（例如，不要假设“Program Files”目录名称）
*   参考数据（翻译显示文本）
*   图片（图片中的文字需要翻译）
*   UI 布局（翻译后填充较长的文本）
*   多语言安装程序、EULA 等
*   硬编码字符串！
*   未指定特定于文化的格式化程序
*   货币，时间本地化（例如使用逗号与货币句点）
*   设计方法：嵌入式资源与附属程序集（即“语言包”）
*   数据库设计：如何存储/查找特定于语言的值

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-13T22:53:58.977

就我个人而言，我没有给出它应该采取的意图的好特性是
**可扩展性**

它帮助我的应用程序社区成长——这对营销和技术方面都有好处，它帮助我专注于我的核心业务，并将很酷的功能留给用户构建

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-13T22:54:39.990

**搜索**。搜索文本框应该很容易找到，并且结果应该尽可能好。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-13T23:11:41.010

**从用户故事设计**，故意推迟数据库设计决策，直到至少创建顶层故事的第一个剪辑。很多时候，各种用户过程的组件被关系完整性和表维护过程的要求所扭曲。我们多久看到一次新的销售订单被输入，用户需要浏览多个表格来填写客户详细信息（有时需要电话和/或未知的虚假数据），实际上不是的必填字段，信用真正来自另一个部门的信息，由于信息不完整而取消的条目发现了几页深，等等。

很少有人维护和审查可用性指标，例如导航页面、输入的按键、中断的任务；尽管客户的使命和用户的生产力应该是软件质量的主要决定因素。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-14T02:10:53.123

**可测试性**。当你拥有它时，模块化、关注点分离、重用、正确的错误处理和许多其他好东西就免费了。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-04-13T23:17:10.247

**可用性**——无论我们的应用程序多么可扩展和无错误，它的成功通常取决于最终用户对它的喜爱程度。它可以在下面像垃圾一样编码，但如果它易于使用且非常直观易学，它仍然是赢家。

永远不要忘记，对于最终用户来说，UI*就是*程序。使高度可用性成为您所有应用程序的一项功能。

评论中有人问如何将可用性作为一项功能实现——不幸的是，这不是您可以提出功能请求的东西（例如，“使该网站可用”），但它更像是您在设计 UI 时应遵循的一组指导方针，*就像您在编码过程中遵循的使您的程序可扩展的准则一样*。

这篇文章几乎没有足够的空间。我强烈推荐[Steve Krug 的 Don't Make Me Think](https://rads.stackoverflow.com/amzn/click/com/0789723107)作为任何关注可用性的人的起点。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-13T22:55:32.890

**快捷键**（ctrl-f 等...）

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-13T23:14:17.243

**界面复杂度分层**，最常见和最理想的动作执行起来非常简单和明显，而不太常见和不太理想的动作通过更大的复杂性来实现。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-04-13T23:45:03.003

**无鼠标操作**：在可行的范围内，应用程序应便于用户在不使用鼠标的情况下与其进行交互。（可用性、可访问性下的文件。）

这并不一定意味着要竭尽全力支持无鼠标使用。更多只是避免在不需要的地方强制使用鼠标。例如，在 Web 表单中按 enter 时不要破坏默认的表单提交行为，除非您打算用它做一些更有用的事情。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-04-14T00:58:06.293

*** 最近的动作/热门动作 ***

我喜欢这个功能，无论我在哪里看到它：

*   维基百科 - 刚刚改变了什么？
*   堆栈溢出 - 真正活跃的问题在哪里（行动在哪里！）
*   博客/收件箱 - 几乎每个博客都以这种方式排序是有原因的

即使我在 Reddit 这样的网站上，我们中的许多人也会搜索评论最多的东西，因为那是有趣的东西。

例如，我希望它是答案的默认值，因为这个答案将被忽略！:)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-04-14T00:18:10.537

**撤消**

每个应用程序（除了那些，像编译器，没有交互式用户界面的应用程序）都应该跟踪每个用户事件（导航、修改文档和首选项等），以便用户可以从他的当前状态回溯。

即使没有可变数据的应用程序通常仍然允许用户导航。浏览器“后退按钮”是撤消功能的一个很好的例子。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-04-13T23:44:56.093

**简单性**- 尽可能少的点击做用户想要和期望的事情。

Stackoverflow 就是一个很好的例子。界面没有加载chrome。网站上最大的图形大约是 3k。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-04-14T01:08:06.673

**自动化**- 如果应用程序不需要 UI 来操作，则启用使用命令行或脚本执行的能力。发现了许多优秀的 FTP 工具（也包括存档工具），它们基本上不需要 UI 来完成预期的工作，但不能编写脚本或没有命令行功能。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-04-13T23:03:33.213

**性能**（如果您愿意，可以将其读作延迟）。

尽管无数人都在大喊过早的优化，但这只是一个简单的功能需求。与众不同并以更好的质量（或性能设计，而不是过早的优化选择器）来挑战。

世界上没有其他项目比 Java 和 CLR 中的类似 VM 的解决方案更需要性能改造。这是他们每个产品、技术、版本和当然膨胀的一个明显的工件，称为：.NET 3.5 和 Oracle 200MB 客户端（大声笑）。

虚拟机只是吸收每一个新功能的性能，版本和构建应用程序，你真的需要一个 Cray。

可扩展性是完全不同的故事，但是伙计，人们只是不会使用高延迟应用程序和大多数 CLR 应用程序（除了简单且 60% 的时间不适用的 Web 内容，比如这个站点/应用程序）只是那。加载一些严重的东西，你将运行到非托管办公室、非托管 IDE、非托管数据库、非托管游戏、非托管浏览器等等。

有人应该用蝙蝠敲打 GC 爱好者并告诉他们醒来。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-04-13T23:21:48.770

**内省：**系统以编程方式对其自身结构和行为做出预测性决定的能力。（类似于语言级别的反射，是可扩展性的关键要素。）

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-04-14T00:34:00.720

**收件箱**
虽然看起来很小，但它确实对应用程序的可用性和性能影响
很大'他可以选择'当最新报告准备好后给我发送'

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-04-13T23:40:45.073

**输入焦点默认**：在任何期望用户进行任何输入的界面演示中，输入焦点应默认为他们最有可能开始输入的位置。（这是可用性区域中的一个特定功能。）

在 Web 表单的情况下，不幸的是，需要注意的是，如果在选中焦点默认值时他们已经开始输入，则焦点默认值也不应该干扰用户。

（无耻的插件：我维护[了一些通用的 Javascript 来解决 Web 表单的问题](http://lostsouls.org/grimoire_form_autofocus)。）

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-04-13T22:58:13.320

**模块化 - 生产力 - 可扩展性**

[这就是Smart Client Software Factory](http://msdn.microsoft.com/en-us/library/cc540690.aspx)的总体设计目标。它有效。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-04-13T22:58:40.667

**崩溃报告**，因为它会崩溃，并且开发团队需要知道它何时会崩溃，这样您就可以随时掌握问题......

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-04-13T23:17:43.633

**回归测试：**能够轻松、定期地验证关键功能元素在系统修改后继续按预期执行。（这是“可扩展性”的一个更具体的元素。）

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-04-14T00:01:13.323

**报告**
，因为运行一个从数据库中几乎每个表中读取数据的报告总是很痛苦
我曾经看过一个关于数据仓库的数据库设计模式的演示文稿（我再也找不到它了），其中亚马逊展示
了解决方案是制作一个特殊的非规范化数据库，每隔一段时间向它发布报告

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-04-14T00:08:12.327

**标记**

不仅在以社区为中心的应用程序中，而且在业务线应用程序中通过允许标记，员工可以创建带有**“观看此”的**新标签，他可以将其附加到学生记录、收到收据等...

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-04-13T23:48:58.160

**注释。** 实施内部标准评论系统（首先，记录它！） - 自动评论文档系统可能是正确的，或者只是一组标准程序标题评论和评论约定。让程序员提前知道您希望如何对代码进行注释。进行跨程序员代码审查，检查可读性/可理解性并着眼于未来的修改：如果您是下一个处理此代码的人，这对您有意义吗？

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-04-15T15:46:48.410

**Unicode 支持**，因为您的表示层编码为 ISO-8859-1 而您的持久层编码为 UTF-8 没有好处。

# php - How can I attach two Radio Buttons in Zend Framework to one ID?

> ID：745682
> 
> 赞同：0
> 
> 时间：2009-04-13T22:51:52.290
> 
> 标签：php, zend-framework

I am trying to create radio buttons with Zend Framework. This is the way I want to do it:

```
( )Yes ( )No John Smith
( )Yes ( )No Peter Fallon 
```

I want to attach two radio buttons to one ID:

Thanks

Ok now I am getting how this works, thanks for your patience.

Well this is what I have.

```
class ListForm extends Zend_Form 
```

{
public function __construct() { parent::__construct(); }

```
public function createForm(array $model,$checkedArr)
{
    // set the method for the display form to POST
    $this->setMethod('post');
$this->setAction('/List/inputform');

    // add an check box element        
$check = new Zend_Form_Element_MultiCheckbox('check');

foreach ($model as $option) {           
   $check->addMultiOption($option['id'],.$option['name'].' '.$option['lname']); 
}

// Add a checkmark to the check box.
$check->setValue($checkedArr); 

    // add the submit button
    $submit = new Zend_Form_Element_Submit('submit'); 
    $submit->setLabel('Submit'); 
    $submit->setValue('submit');

    return  $this->addElements(array($check,$submit));
}} 
```

Then I insert this form into the view

```
$this->view->form = $form->createForm($model,$array); 
```

By doing this a list of people gets created with a checkbox

```
[ ] John Smith

[ ] Peter Fallon 
```

What I want to do is to change from a checkbox to a two radio buttons, like this

```
( )Yes ( )No John Smith

( )Yes ( )No Peter Fallon 
```

So when the form gets delivered to the Action function on the Controller I can loop trough all the list and determine which one has a Yes selected and which one has a No selected.

I hope that this is more clear.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T23:26:18.307

好吧，请提供您到目前为止编写的代码！那时帮助会容易得多！

一般来说，[Zend_Form](http://framework.zend.com/manual/en/zend.form.html)手册中解释了一切。我假设您一般都知道如何将表单元素添加到 Zend 表单。在这里，您可以看到[Radio Button](http://framework.zend.com/manual/en/zend.form.standardElements.html#zend.form.standardElements.radio)有哪些选项。

这是它的外观示例：

```
$gender = new Zend_Form_Element_Radio('gender');
$gender->setLabel('Gender:')
    ->addMultiOptions(array(
     'male' => 'Male',
     'female' => 'Female'
    ))
    ->setSeparator('|'); 
```

# php - PHP 邮件可能无法正常工作的原因

> ID：745690
> 
> 赞同：1
> 
> 时间：2009-04-13T22:56:08.893
> 
> 标签：php, email

我正在使用 PHP`mail()`函数从联系表单发送电子邮件。函数返回`true`所以应该没问题。但我没有收到电子邮件。

我看过一些帖子说您应该始终在 PHP 邮件中使用*From*和*Reply-To*标头来确保它已送达。我尝试了各种配置，但还没有任何效果。

还有其他方法可以调试该`mail()`功能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T23:08:20.377

如果您使用的是 Windows，则需要安装 SMTP 服务器。

如果您使用的是 linux，则需要启用 sendmail 并确保安装 PHP 的用户帐户可以访问 sendmail 二进制文件。

询问您的主机您的帐户是否有足够的权限来访问二进制文件。

在此处发布您的代码也可能会有所帮助，以防您忽略了其中的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T01:55:04.503

大多数情况下，此问题是由标头引起的，邮件可能会被发送，但 SMTP 服务器可能永远不会发送它，因为标头错误

我建议您使用 PHP 的邮件类，例如[phpMailer](http://phpmailer.codeworxtech.com/)，它可以处理您的所有标题问题，并且有一个非常好的界面可供使用

干杯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T23:02:07.977

您是从自己的计算机发送邮件吗？您可能没有设置可以访问本地域以外的 SMTP 服务器。您也可能被垃圾邮件过滤器阻止，具体取决于您的邮件服务。

如果您在自己的计算机上执行此操作，请通过向您的本地邮件帐户之一发送本地消息来测试它（如果您使用的是 Linux）。如果您认为这是问题所在，请安装 postfix。

如果您是通过托管服务进行的，请检查您的垃圾邮件文件夹。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T23:39:08.790

我知道它不是专门回答你的问题，但我的建议是使用类似[swiftmailer](http://swiftmailer.org/)的东西而不是 mail()。它更加可靠，无论是在上班还是通过邮件方面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T23:04:33.820

在 Unix 系统上，[`mail()`](http://www.php.net/mail)使用`sendmail`，并且有很多原因（权限、配置错误）可能会失败。我不确定 PHP 是否会检测并报告所有这些。检查来自 sendmail 的任何日志。

例如，您还应该查看从 [PEAR](http://pear.php.net/package/Mail)或[Zend](http://framework.zend.com/manual/en/zend.mail.html)发送邮件的助手。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-13T23:10:49.857

在某些服务器上，您需要明确设置 FROM 标头，否则将不会发送。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-13T23:11:33.677

山羊，如果您尝试使用该功能的服务器位于动态外部 IP 上，那么您就是 SOL。大多数邮件服务器现在阻止来自动态 IP 范围的端口 25 上的传入连接。:(

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T00:08:48.330

是共享主机吗？我知道有些公司会覆盖邮件功能以避免垃圾邮件，并且需要额外的参数或一些预定义的值（例如 from 字段必须是来自您的域名的有效地址）。您可能需要咨询您的网络托管公司。您是否有可以尝试相同代码的私人设置？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-25T12:43:36.827

您的提供商的邮件服务器可能被禁止。检查 dns 黑名单或联系您的托管服务提供商。

# c++ - C++ 指针转换问题

> ID：745692
> 
> 赞同：0
> 
> 时间：2009-04-13T22:56:55.147
> 
> 标签：c++, pointers

我需要通过只有双精度和字符串类型的脚本语言传递一个指针，为此我只需要担心 32 位指针。

鉴于指针是 32 位的，我认为双精度数具有足够的精度来安全地存储指针，这是可行的，但是问题出现在一些指向流的指针上，可能是由于多重继承......我真的不确定如何解决它。

基本上我一直将指针指向`unsigned`，然后指向`double`. 然后为了让它们回来，我将其`double`转换`unsigned`为指针，然后再转换为指针的任何类型。

例如：

```
double example()
{
    int *i = new int[100];
    return (double)(unsigned)i;
}
double example2(double i)
{
    doSomething((int*)(unsigned)i);
} 
```

但是对于流类型，它似乎不起作用......

```
std::ofstream *fs = new std::ofstream("example.txt");
std::cout << fs << std::endl;//029D1DF8 for example
double d = (double)(unsigned)fs;
std::ios *p = (std::ios*)(unsigned)d;
std::cout << p << std::endl;//029D1DF8 same thing seems fine
std::cout << ((std::ios*)fs) << std::endl;//029D1E54, opps, apparently a cast to std::ios changes the pointer to some offset! 
```

有没有办法解决这个问题？我有一个使用地图和身份证号码的想法，但我宁愿避免拥有可能包含 1000 个条目的此类地图的成本。我宁愿让演员为此工作......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T23:04:03.120

我会使用 reinterpret_cast，并始终转换为与您转换的指针类型相同的指针类型，以避免任何转移。

```
std::ofstream *fs = new std::ofstream("example.txt");
double d = reinterpret_cast<unsigned>(fs);
fs = reinterpret_cast<std::ofstream *>(static_cast<unsigned>(d)); 
```

或者先转换为 std::ios ：

```
std::ofstream *fs = new std::ofstream("example.txt");
double d = reinterpret_cast<unsigned>(static_cast<std::ios*>(fs));
std::ios *p = reinterpret_cast<std::ios*>(static_cast<unsigned>(d)); 
```

当您处理任何类型的继承时，在转换为不透明句柄时始终使用相同的类并从中进行转换至关重要。

另一种可能但速度较慢的方法是将指针值编码为字符串。为什么不将“029D1DF8”存储在字符串中？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T23:24:36.190

当然，将指针转换为 double 和 back 本质上是可疑且不可移植的，但在涉及多重继承的继承树中，如果没有额外的组合，它将无法工作。

考虑一下：

```
#include <iostream>
#include <fstream>

int main(int, char **) {
  std::ofstream *ofs = new std::ofstream("example.txt");
  std::ios *fs = ofs; // aim fs at the ios portion of the fstream
  std::cout << ofs << std::endl << fs << std::endl;
  delete ofs;
  return 0;
} 
```

输出：

```
0x800000
0x80020c 
```

请注意，即使您已将 ofstream 指针分配给 ios 指针，它们的值也会有所不同。您需要向下转换，正确的向下转换方法是使用 dynamic_cast：

```
#include <iostream>
#include <fstream>

int main(int, char **) {
  std::ofstream *ofs = new std::ofstream("example.txt");

  // aim fs at the ios portion of the fstream
  std::ios *fs = ofs;  

  // print 'em
  std::cout << ofs << std::endl << fs << std::endl;

  // aim ofs2 at the fstream portion of ofstream object 
  // you know lurks behind the ios pointer
  std::ofstream *ofs2 = dynamic_cast<std::ofstream *>(fs) ; 

  // print it
  std::cout << ofs2 << std::endl ;

  delete ofs;
  return 0;
} 
```

输出：

```
0x800000
0x80020c
0x800000 
```

将它们放在一起，您可以使用：

```
std::ofstream *ofs = new std::ofstream("example.txt");
double d = static_cast<double>(reinterpret_cast<unsigned long>(ofs));
// ... do something with d ...

// ... find the ios part of the ofstream ...
std::ios *fs = reinterpret_cast<std::ofstream *>(static_cast<unsigned long>(d));

// ... get the ofstream back ...
std::ofstream *ofs2 = dynamic_cast<std::ofstream *>(fs); 
```

从为什么你需要一个 ios 和一个 ofstream 的问题中不清楚。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T02:38:16.863

您正在从 ofstream 向前投射，然后再回到 ios。

您需要转换为同一类型。我会使用ostream。

哦，最好使用 size_t 而不是 unsigned （在 64 位机器上 double 是否有足够的精度？怀疑它。）。

```
std::ofstream *fs = new std::ofstream("example.txt");
double d = (double)(size_t)static_cast<std::ostream*>(fs);
std::ostream *p = reinterpret_cast<std::ostream*>((unsigned)d); 
```

如果你想回到 ofstream，你需要使用 dynamic_cast 并准备好处理 NULL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T23:04:55.863

尝试 reinterpret_cast：

```
double example()
{
    int *i = new int[100];
    return static_cast<double>(reinterpret_cast<unsigned int>(i));
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T23:08:16.713

你在这里真的是在玩火。从整数到双精度的转换，反之亦然，涉及浮点的表示，您可能会失去对指针很重要的准确性。

我不太清楚您为什么要在系统的接口点和脚本语言之外进行转换。将其隔离，然后，如果您只想表示地址，请使用 void* 或您所代表的真实类型。

无论如何，我真的想不出将指针传递给脚本语言的用例。你能解释更多你想要做什么吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-13T23:38:19.980

假设您的应用程序控制这些指针的发送和接收是否安全 - 即，指针不会被您不控制的代码拾取？

如果是这种情况，那么我建议您根本不要传递指针。将指针保存在与脚本引擎关联的哈希表、数组或链表中，并将整数索引（或键）传递到该数据结构中。

这可能感觉像是一个高开销的解决方案。但是，开销可能远低于在应用程序中使用脚本的开销，因此它可能无法衡量。

编辑：好的，我看到你包含了使用地图的想法。（我错过了第一次，因为它隐藏在代码块之后。）但即使有 1000 多个条目，这也不太可能成为您的性能瓶颈。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T14:48:21.970

好的，我想出的解决方案是简化演员表。

我定义了一个结构，就像下面的结构，存储的指针已经转换为我想要的类型。

```
struct Streams
{
    std::istream *is;
    std::ostream *os;
    std::stringstream *ss;
    std::fstream *fs;
}; 
```

然后我填充了结构（将“真实”对象不支持的结构设置为null），在堆上分配了它，然后只转换了一个double返回到我的脚本，然后可以安全地转换回Streams *。

这还有一个额外的好处，即允许安全检查传递给方法的流是否支持该操作，只需检查用于该方法的类型（例如，ss 用于字符串流的 str() 方法）是否不为空。

# emacs - 如何让编译日志在 Emacs 中创建一个新窗口？

> ID：745694
> 
> 赞同：4
> 
> 时间：2009-04-13T22:58:05.537
> 
> 标签：emacs, window, compilation

如果我在 emacs 中只显示一个窗口并使用 Mx 编译，则窗口一分为二，我可以轻松查看编译缓冲区。但是，如果我有更多的窗口显示，编译日志会接管其他一个，我觉得这很烦人。我怎样才能让emacs总是拆分一个新窗口来显示编译日志？

编辑：从我一直在做的阅读中获得更多信息。看起来 compile.el 调用了 display-buffer，如果它是当前全宽，它只会拆分一个窗口。有没有办法避免这种行为？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T08:48:11.593

您可以修改[Trey Jackson](https://stackoverflow.com/questions/745694/how-can-i-make-the-compilation-log-create-a-new-window-in-emacs/746071#746071)提供的解决方案以满足您的需求。

以下代码段将缓冲区标记`*compilation*`为特殊，并将自定义函数设置为其显示函数以拆分当前窗口，即使已经在拆分窗口中也是如此。

```
(setq special-display-buffer-names
      '("*compilation*"))

(setq special-display-function
      (lambda (buffer &optional args)
        (split-window)
        (switch-to-buffer buffer)
        (get-buffer-window buffer 0))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T02:05:27.050

如果您想要的是一个专用的顶级窗口（Emacs 将这些*框架*称为），那么这将为您解决问题。此代码段包含放置指令，但自定义`'special-display-buffer-names`变量将为您提供所需的内容。

```
(setq special-display-buffer-names
      `(("*compilation*" . ((name . "*compilation*")
                            ,@default-frame-alist
                            (left . (- 1))
                            (top . 0))))) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-01T22:44:32.617

结合来自[如何防止 emacs 打开新窗口进行编译输出的代码？](https://stackoverflow.com/questions/8309769/how-can-i-prevent-emacs-from-opening-new-window-for-compilation-output/28268808#28268808)和来自[http://www.emacswiki.org/emacs/CompilationMode](http://www.emacswiki.org/emacs/CompilationMode)的代码，这是我的所有代码`compile`，它为您提供 4 个功能：

1）。用于`compile-again`自动运行与上次相同的编译，无提示。如果没有最后一次，或者有前缀参数，它就像 Mx 编译。

2）。`compile`将分割当前窗口，不会影响该框架中的其他窗口。

3）。如果没有错误它将自动关闭`*compilation*`缓冲区（窗口），如果存在错误则保留它。

4）。它将突出显示缓冲区中源代码的错误行和行号`*compilation*`，`M-n/p`用于导航`*compilation*`缓冲区中的每个错误，`Enter`在错误行中跳转到代码代码中的行。

```
(require 'compile)
(setq compilation-last-buffer nil)
(defun compile-again (ARG)
  "Run the same compile as the last time.

If there is no last time, or there is a prefix argument, this acts like M-x compile."
  (interactive "p")
  (if (and (eq ARG 1)
           compilation-last-buffer)
      (progn
        (set-buffer compilation-last-buffer)
        (revert-buffer t t))
    (progn
      (call-interactively 'compile)
      (setq cur (selected-window))
      (setq w (get-buffer-window "*compilation*"))
      (select-window w)
      (setq h (window-height w))
      (shrink-window (- h 10))
      (select-window cur))))
(global-set-key (kbd "C-x C-m") 'compile-again)
(defun my-compilation-hook ()
  "Make sure that the compile window is splitting vertically."
  (progn
    (if (not (get-buffer-window "*compilation*"))
        (progn
          (split-window-vertically)))))
(add-hook 'compilation-mode-hook 'my-compilation-hook)
(defun compilation-exit-autoclose (STATUS code msg)
  "Close the compilation window if there was no error at all."
  ;; If M-x compile exists with a 0
  (when (and (eq STATUS 'exit) (zerop code))
    ;; then bury the *compilation* buffer, so that C-x b doesn't go there
    (bury-buffer)
    ;; and delete the *compilation* window
    (delete-window (get-buffer-window (get-buffer "*compilation*"))))
  ;; Always return the anticipated result of compilation-exit-message-function
  (cons msg code))
(setq compilation-exit-message-function 'compilation-exit-autoclose)
(defvar all-overlays ())
(defun delete-this-overlay(overlay is-after begin end &optional len)
  (delete-overlay overlay)
  )
(defun highlight-current-line ()
"Highlight current line."
  (interactive)
  (setq current-point (point))
  (beginning-of-line)
  (setq beg (point))
  (forward-line 1)
  (setq end (point))
  ;; Create and place the overlay
  (setq error-line-overlay (make-overlay 1 1))

  ;; Append to list of all overlays
  (setq all-overlays (cons error-line-overlay all-overlays))

  (overlay-put error-line-overlay
               'face '(background-color . "red"))
  (overlay-put error-line-overlay
               'modification-hooks (list 'delete-this-overlay))
  (move-overlay error-line-overlay beg end)
  (goto-char current-point))
(defun delete-all-overlays ()
  "Delete all overlays"
  (while all-overlays
    (delete-overlay (car all-overlays))
    (setq all-overlays (cdr all-overlays))))
(defun highlight-error-lines(compilation-buffer process-result)
  (interactive)
  (delete-all-overlays)
  (condition-case nil
      (while t
        (next-error)
        (highlight-current-line))
    (error nil)))
(setq compilation-finish-functions 'highlight-error-lines) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-24T14:53:51.033

`smart-compile`在 Emacs 中安装包。

将此添加到您的`init.el`或`.emacs`

```
(require 'compile)
(setq compilation-last-buffer nil)
;; save all modified buffers without asking before compilation
(setq compilation-ask-about-save nil)
(defun compile-again (ARG)
  "Run the same compile as the last time.

With a prefix argument or no last time, this acts like M-x compile,
and you can reconfigure the compile args."
  (interactive "p")
  ;; the following two lines create bug: split a new window every time
  ;; (if (not (get-buffer-window "*compilation*"))
  ;;      (split-window-below))
  (if (and (eq ARG 1) compilation-last-buffer)
      (recompile)
    (call-interactively 'smart-compile)))
(bind-key* "C-x C-m" 'compile-again)
;; create a new small frame to show the compilation info
;; will be auto closed if no error
(setq special-display-buffer-names
      `(("*compilation*" . ((name . "*compilation*")
                            ,@default-frame-alist
                            (left . (- 1))
                            (top . 0)))))
(setq compilation-finish-functions
      (lambda (buf str)
        (if (null (string-match ".*exited abnormally.*" str))
            ;;no errors, make the compilation window go away in a few seconds
            (progn
              (run-at-time
               "1 sec" nil 'delete-windows-on
               (get-buffer-create "*compilation*"))
              (message "No Compilation Errors!"))))) 
```

用于`C-x C-m`编译你的源代码，如果你是第一次执行`C-x C-m`，它会要求你更改默认命令（通常就足够了），否则它会直接执行你刚刚用来编译的命令，你必须`C-u C-x C-m`使用如果需要，请更改命令。如果您`Makefile`在当前目录中有一个，它会注意到并提示询问您是否要使用它。

也许这个答案对您的问题来说太过分了，但请尝试一下。

# javascript - 选择大量复选框并取消/选择它们的最快方法是什么？

> ID：745720
> 
> 赞同：5
> 
> 时间：2009-04-13T23:09:38.097
> 
> 标签：javascript, jquery, performance

因为我使用 jQuery 1.3+，所以除了一个定时测试之外都在使用它。另一个是我在 2000 年发现的纯 JavaScript。我停止了这条路线，因为运行测试大约需要 150 秒。我已经阅读了很多与选择单个元素相关的 jQuery 优化网页。'#id' 是使用它的最佳情况，但现在我遇到了**检查一个包含多个复选框列的相当大的表中的一列中的所有复选框**的问题。

我所做的是设置一个页面，该页面创建 20,000 个带有两个复选框列的表行。目标是检查第二列，看看花了多长时间，然后取消选中它们，看看花了多长时间。显然我们想要最短的时间。我只使用 IE6 和 7，就我而言，我所有的用户都会这样做。

你说20,000行？我也是这么说的，但这将要投入生产（不在我的手中），现在改变已经太晚了。我只是想在时钟还剩 1 秒时向玛丽致敬。此外，我了解到 input.chkbox 不是最快的选择器（对于 IE7）！:)

问题是，有没有更好的方法来做这个 jQuery 或其他方式？我希望它能在不到半秒的时间内在我的机器上运行。

因此，您不必重新输入我已经完成的所有废话，这是我想出的测试内容：

**更新了 4 月 14 日上午，以包括进一步的计时赛：**

```
<form id="form1" runat="server">
    <div>
        <a href="#" id="one">input[id^='chkbox'][type='checkbox']</a><br />
        <a href="#" id="two">#myTable tr[id^='row'] input[id^='chkbox'][type='checkbox']</a><br />
        <a href="#" id="three">#myTable tr.myRow input[id^='chkbox'][type='checkbox']</a><br />
        <a href="#" id="four">tr.myRow input[id^='chkbox'][type='checkbox']</a><br />
        <a href="#" id="five">input[id^='chkbox']</a><br />
        <a href="#" id="six">.chkbox</a><br />
        <a href="#" id="seven">input.chkbox</a><br />
        <a href="#" id="eight">#myTable input.chkbox</a><br />

        <a href="#" id="nine">"input.chkbox", "tr"</a><br />
        <a href="#" id="nine1">"input.chkbox", "tr.myRow"</a><br />
        <a href="#" id="nine2">"input.chkbox", "#form1"</a><br />
        <a href="#" id="nine3">"input.chkbox", "#myTable"</a><br />

        <a href="#" id="ten">input[name=chkbox]</a><br />
        <a href="#" id="ten1">"input[name=chkbox]", "tr.myRow"</a><br />
        <a href="#" id="ten2">"input[name=chkbox]", "#form1"</a><br />
        <a href="#" id="ten3">"input[name=chkbox]", "#myTable"</a><br />

        <a href="#" id="ten4">"input[name=chkbox]", $("#form1")</a><br />
        <a href="#" id="ten5">"input[name=chkbox]", $("#myTable")</a><br />

        <a href="#" id="eleven">input[name='chkbox']:checkbox</a><br />
        <a href="#" id="twelve">:checkbox</a><br />
        <a href="#" id="twelve1">input:checkbox</a><br />
        <a href="#" id="thirteen">input[type=checkbox]</a><br />

        <div>
            <input type="text" id="goBox" /> <button id="go">Go!</button>
            <div id="goBoxTook"></div>
        </div>

        <table id="myTable">
            <tr id="headerRow"><th>Row #</th><th>Checkboxes o' fun!</th><th>Don't check these!</th></tr>
            <% for(int i = 0; i < 20000;i++) { %>
            <tr id="row<%= i %>" class="myRow">
                <td><%= i %> Row</td>
                <td>
                    <input type="checkbox" id="chkbox<%= i %>" name="chkbox" class="chkbox" />
                </td>
                <td>
                    <input type="checkbox" id="otherBox<%= i %>" name="otherBox" class="otherBox" />
                </td>
            </tr>
            <% } %>
        </table>
    </div>

    <script type="text/javascript" src="<%= ResolveUrl(" ~/") %>Javascript/jquery.1.3.1.min.js"></script>
    <script type="text/javascript">

        $(function () {
            function run(selectorText, el) {
                var start = new Date();
                $(selectorText).attr("checked", true);
                var end = new Date();
                var timeElapsed = end - start;
                $(el).after("<br />Checking Took " + timeElapsed + "ms");

                start = new Date();
                $(selectorText).attr("checked", false);
                end = new Date();
                timeElapsed = end - start;
                $(el).after("<br />Unchecking Took " + timeElapsed + "ms");
            }

            function runWithContext(selectorText, context, el) {
                var start = new Date();
                $(selectorText, context).attr("checked", true);
                var end = new Date();
                var timeElapsed = end - start;
                $(el).after("<br />Checking Took " + timeElapsed + "ms");

                start = new Date();
                $(selectorText, context).attr("checked", false);
                end = new Date();
                timeElapsed = end - start;
                $(el).after("<br />Unchecking Took " + timeElapsed + "ms");
            }

            $("#one").click(function () {
                run("input[id^='chkbox'][type='checkbox']", this);
            });

            $("#two").click(function () {
                run("#myTable tr[id^='row'] input[id^='chkbox'][type='checkbox']", this);
            });

            $("#three").click(function () {
                run("#myTable tr.myRow input[id^='chkbox'][type='checkbox']", this);
            });

            $("#four").click(function () {
                run("tr.myRow input[id^='chkbox'][type='checkbox']", this);
            });

            $("#five").click(function () {
                run("input[id^='chkbox']", this);
            });

            $("#six").click(function () {
                run(".chkbox", this);
            });

            $("#seven").click(function () {
                run("input.chkbox", this);
            });

            $("#eight").click(function () {
                run("#myTable input.chkbox", this);
            });

            $("#nine").click(function () {
                runWithContext("input.chkbox", "tr", this);
            });

            $("#nine1").click(function () {
                runWithContext("input.chkbox", "tr.myRow", this);
            });
            $("#nine2").click(function () {
                runWithContext("input.chkbox", "#form1", this);
            });
            $("#nine3").click(function () {
                runWithContext("input.chkbox", "#myTable", this);
            });

            $("#ten").click(function () {
                run("input[name=chkbox]", this);
            });

            $("#ten1").click(function () {
                runWithContext("input[name=chkbox]", "tr.myRow", this);
            });

            $("#ten2").click(function () {
                runWithContext("input[name=chkbox]", "#form1", this);
            });

            $("#ten3").click(function () {
                runWithContext("input[name=chkbox]", "#myTable", this);
            });

            $("#ten4").click(function () {
                runWithContext("input[name=chkbox]", $("#form1"), this);
            });

            $("#ten5").click(function () {
                runWithContext("input[name=chkbox]", $("#myTable"), this);
            });

            $("#eleven").click(function () {
                run("input[name='chkbox']:checkbox", this);
            });

            $("#twelve").click(function () {
                run(":checkbox", this);
            });

            $("#twelve1").click(function () {
                run("input:checkbox", this);
            });

            $("#thirteen").click(function () {
                run("input[type=checkbox]", this);
            });

            $('#go').click(function () {
                run($('#goBox').val(), this);
            });
        });
    </script>
</form> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-13T23:15:15.260

**input[name=chkbox]**是我机器上 IE7 下最快的 jQuery 选择器。

```
Unchecking Took 2453ms
Checking Took 2438ms
Unchecking Took 2438ms
Checking Took 2437ms
Unchecking Took 2453ms
Checking Took 2438ms 
```

**输入.chkbox**和...

```
Unchecking Took 2813ms
Checking Took 2797ms
Unchecking Took 2797ms
Checking Took 2797ms
Unchecking Took 2813ms
Checking Took 2797ms 
```

**输入：checkbox.chkbox**似乎绑定

```
Unchecking Took 2797ms
Checking Took 2797ms
Unchecking Took 2813ms
Checking Took 2781ms 
```

**.chkbox**几乎是 input.chkbox 的两倍

```
Unchecking Took 4031ms
Checking Took 4062ms
Unchecking Took 4031ms
Checking Took 4062ms 
```

javascript for 循环是迄今为止最糟糕的：

```
Checking Took 149797ms 
```

150秒！它也锁定了浏览器。这让我对 jQuery 印象深刻。老实说，我没想到它会这么慢。可能是因为我正在遍历每个单独的元素，然后它必须找到......

这对我来说也很有趣：

**输入[id^='chkbox']**

```
Unchecking Took 3031ms
Checking Took 3016ms 
```

花费的时间**少于**：

**输入[id^='chkbox'][type='checkbox']**

```
Unchecking Took 3375ms
Checking Took 3344ms 
```

我想既然我发布了更多过滤器，它会更快。没有！

为复选框指定更多路径会使其速度变慢：

**#myTable tr[id^='row'] 输入[id^='chkbox'][type='checkbox']**

```
Checking Took 10422ms 
```

它甚至没有运行第二次取消检查，因为它询问我是否想继续在我的计算机上运行脚本。疯狂的！:P

**更新早上 4/14：**

有人提出设置上下文：我实际上做了一些这样的事情，令我惊讶的是，与网上很多人**在 IE7 上所说的相反，这些速度更慢**！以下是我指定的几个不同上下文与上面更快的选择器配对的时间：

**“输入.chkbox”，“tr”**

```
Checking Took 8546ms 
```

**“input.chkbox”，“tr.myRow”**

```
Checking Took 8875ms 
```

**“输入.chkbox”，“#form1”**

```
Unchecking Took 3032ms
Checking Took 3000ms 
```

**“输入.chkbox”，“#myTable”**

```
Unchecking Took 2906ms
Checking Took 2875ms 
```

当前获胜者（仍然）：**input[name=chkbox]**

```
Unchecking Took 2469ms
Checking Took 2453ms 
```

**“输入[名称=chkbox]”，“tr.myRow”**

```
Checking Took 9547ms 
```

**“输入[名称=chkbox]”，“#form1”**

```
Unchecking Took 3140ms
Checking Took 3141ms 
```

**“输入[名称=chkbox]”，“#myTable”**

```
Unchecking Took 2985ms
Checking Took 2969ms 
```

**更新 2 上午 4/14**

[在我注意到与http://beardscratchers.com/journal/jquery-its-all-about-context](http://beardscratchers.com/journal/jquery-its-all-about-context)的语法不同之后，我想我可能会有更好的选择。似乎这些与**它们给出的时间稍微好一点不同，但仍然没有击败非上下文选择器**- 该死。

**“输入[名称=chkbox]”，$（“#form1”）**

```
Unchecking Took 3078ms
Checking Took 3000ms
Unchecking Took 3078ms
Checking Took 3016ms 
```

**“输入[名称=chkbox]”，$（“#myTable”）**

```
Unchecking Took 2938ms
Checking Took 2906ms
Unchecking Took 2938ms
Checking Took 2921ms 
```

**更新 3 早上 4/14**

Russ 想让我试试这些，他们取消/选择了所有的框，但这又很有趣：

**:复选框**

```
Unchecking Took 8328ms
Checking Took 6250ms 
```

**输入：复选框**

```
Unchecking Took 5016ms
Checking Took 5000ms 
```

-> 最快？！？！**输入[类型=复选框]**

```
Unchecking Took 4969ms
Checking Took 4938ms 
```

第三个速度最快的事实非常有趣，因为这与我的想法相反。为什么（至少对于 IE7） :checkbox 不使用 type=checkbox 来获得更快的时间？这些分数非常接近，但检查时间减少了 62 毫秒。另外，为什么前两个完全不同？除了可以带复选框的输入之外，是否还有其他元素？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-13T23:13:10.663

我还没有对此进行测试，但是您可以尝试在页面加载时构建一个复选框引用的数组 []，然后在每次您想要进行更改时简单地对其进行迭代？

您会为页面加载付出性能成本，但它*可能*比每次遍历 DOM 更快。嘿，至少您会在用户“停机时间”中执行繁重的工作（人们需要多长时间才能找到并单击取消选择/选择选项）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T23:21:28.537

我唯一的建议可能也行不通。切换浏览器。但我只有一家公司真正同意这一点。我们让公司改用 FireFox，特定用户改用 Google Chrome。IE 对 JavaScript 来说太慢了。

此外，您可以尝试预先缓存 jquery 查询列表。

如果一切都失败了，用心理学解决它。这意味着让用户知道某些事情需要很长时间。在函数执行时放置一个“请稍候”的 div。这样，用户就知道浏览器不仅被锁定，而且他们知道什么时候可以恢复工作。通过这样做，我已经“解决”了许多缓慢的页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T12:08:58.240

您是否尝试过带有 a 的 jQuery 选择器[`context`](http://jquery.bassistance.de/api-browser/#StringElementjQuery)来查看是否可以提高性能？大概这些控件将位于 ASP.NET 表单中，并且可能是另一个唯一可识别的元素？

例如，您在哪里

```
$("input[id^='chkbox']") 
```

尝试

```
$("input[id^='chkbox']", "#myFormID") 
```

这是一篇关于上下文[的 BeardScratchers 文章](http://beardscratchers.com/journal/jquery-its-all-about-context)

**编辑：**

在您更新之后，考虑到您的情况，似乎 2.45-6 秒可能是您可以达到的最快速度。

为了完整起见，您是否尝试过以下选择器？

```
$(':checkbox')
$('input[type=checkbox]') 
```

# connection - 是否有任何用于拨号连接的库/组件？

> ID：745721
> 
> 赞同：-1
> 
> 时间：2009-04-13T23:09:47.660
> 
> 标签：connection, components, modem, dial-up

我想通过 VoIP 拨号。是的，我知道这几乎是不可能的。我听说softmodems 使用DSP 软件，但我猜它的硬件特定的代码。如果我只能隔离产生调制解调器信号的代码，我就可以在我的项目中使用它。有人听说过可以满足我需求的图书馆吗？

PS：iaxmodem 只调制传真信号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T17:28:59.407

我不确定这是否会对您有所帮助，但请查看 Dialogic [SDK](http://www.dialogic.com/products/tdm_boards/development_tools/Diva_Server_Software_Development_Kit.htm)及其[API 手册](http://www.dialogic.com/support/helpweb/dssdk/)。

我一直在 Dialogic 语音/传真板上做一些工作，在我使用的其中一台机器上，我设置了 SDK，但没有安装板（它们非常昂贵）。

我注意到在这台机器上，由于我没有安装板，它为我提供了一个由他们的软件管理的 softIP 虚拟硬件板。

我自己没有玩过 VoIP 的东西，但它可能会提供一些你需要的东西。

这是一个[截图](https://imgur.com/2GHfw.jpg)。

下载和安装 SDK 是免费的，但是当您输入您的详细信息时，他们可能会打电话给您并尝试向您推销开发板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T23:27:38.897

大多数电话音频编解码器使用[感知编码](https://en.wikipedia.org/wiki/Psychoacoustics)压缩数据。这种编码**不能**再现目标源的所有频率，因为它忽略了*不相关*的频率。因此，您**不能**使用 GSM 或 VoIP 将二进制数据编码为音频频率（如调制解调器）的数据编码。

除此之外：拥有 VoIP 意味着拥有[IP 连接](https://en.wikipedia.org/wiki/Internet_Protocol)，那么为什么不通过 IP 传输数据（如果它需要通过[VPN](https://en.wikipedia.org/wiki/Virtual_private_network)来保证安全，而不是尝试通过 VoIP 使用调制解调器？

# c++ - 如何使用 C++ 发送电子邮件

> ID：745726
> 
> 赞同：1
> 
> 时间：2009-04-13T23:10:55.973
> 
> 标签：c++, email

我正在制作一个在网络浏览器中支持电子邮件功能的程序。我希望它能够向人们发送电子邮件，并且我正在尝试找出如何使用 C++ 完成此任务。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T23:13:25.547

您将需要安装 SMTP 服务器（假设您在 Windows 上），或者如果在 linux 上使用 sendmail。如果您不想安装 SMTP 服务器，您可以使用一些[示例](http://www.codeproject.com/KB/tips/CSMTPConnection2.aspx)中指定的外部服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T04:07:18.617

如果一切都失败了，您总是可以将邮件写入文件并尝试使用[system(3)](http://linux.die.net/man/3/system)调用[mail(1)](http://www.manpagez.com/man/1/mail/)。

> $ 邮件 -s '天哪！' mybff@example.com <我的邮件文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T23:22:23.073

插座是你最好的选择。您最好的 C 和 C++ 套接字资源是： [http ://beej.us/guide/bgnet/](http://beej.us/guide/bgnet/)

对于实现尝试在这里：[http ://www.codeguru.com/forum/showthread.php?t=300530](http://www.codeguru.com/forum/showthread.php?t=300530)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T23:22:47.583

您所要做的就是使用允许您使用 SMTP 服务器（简单邮件传输协议）的库。你为什么平台开发这个？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-29T17:17:02.823

如果您使用的是 Windows，我使用了[Dundas Ultimate TCP/IP](http://www.codeproject.com/KB/MFC/UltimateTCPIP.aspx)，效果很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-15T12:55:29.923

我尝试[使用 CURL](http://curl.haxx.se/libcurl/c/simplesmtp.html)和[libesmtp](http://www.stafford.uklinux.net/libesmtp/api.html)发送电子邮件。
两者都很好，虽然我更喜欢 CURL，因为它可以异步工作。
另外，我有[一个仅标题的 curl wrapper](http://code.google.com/p/libglim/source/browse/trunk/curl.hpp)。用它发送电子邮件很简单：

```
long rc = Curl().send ("Subject: subject\r\n\r\n" "text\r\n") .smtp ("from", "to") .go().status();
if (rc != 250) std::cerr << "Error sending email: " << rc << std::endl; 
```

# php - 来自数据库的内容作为 html 表单中文本区域的默认值

> ID：745727
> 
> 赞同：0
> 
> 时间：2009-04-13T23:10:57.767
> 
> 标签：php, javascript, html, ajax

我想知道从数据库字段中提取文本并将其设置为文本区域的默认文本的最简单方法。

我目前计划将该字段分配给一个变量，然后使用 javascript 将其设置为默认文本，但我不确定如何执行最后一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T23:24:50.197

在您的 PHP 代码中，可能在您的 HTML 上方：

```
// Database connection calls here...
$row = mysql_fetch_array();
$databaseField = $row["databaseField"]; 
```

在您的 HTML 中：

```
<textarea name="databaseField" rows="5">
   <?php= $databaseField ?>
</textarea> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T23:16:53.807

如果您使用的是服务器端语言，则不需要额外的 javascript 步骤。您可以简单地填充“值”属性的值。这是一个使用 PHP 的示例：

```
<input type="text" 
  name="phoneNumber" 
  value="<?php print($phone_number_from_database); ?>" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T07:36:48.907

不要忘记转义您的数据库内容！

```
<textarea id="foo">
  <?php echo htmlspecialchars($databasefield); ?>
</textarea> 
```

否则，您会遇到包含 html 标签之类的内容的问题`'foo </textarea>bar baz'`。会`bar baz`逃脱你的文本区域！这可能会导致[跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)安全问题（如果您允许用户输入）或至少破坏 html。如果同学们忘记清理他们边做边学的留言簿应用程序中的条目，我曾经用 javascript 打开无数新窗口来惩罚他们。带有图像的窗户，*没有任何理智的人愿意看到*。美好的时光 ：）

htmlspecialchars 变成`<, >, ", &, ...` 实体 ( `&lt;, &gt;, &quot;, &amp;, ...`)，防止内容脱离。

# python - Python 是否被解释（如 Javascript 或 PHP）？

> ID：745743
> 
> 赞同：38
> 
> 时间：2009-04-13T23:15:37.427
> 
> 标签：python

Python 是在运行时严格解释的，还是可以用于开发作为后台应用程序运行的程序（如 Java 应用程序或 C 程序）？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-04-14T20:23:11.640

正如不同的回答会告诉你的那样，解释和编译之间的界限不再像创造这些术语时那样清晰。事实上，将*语言*视为解释或编译也是一种错误，因为不同的语言*实现*可能会做不同的事情。如今，您可以找到[C 解释器](http://root.cern.ch/drupal/content/cint)和[Javascript 编译器](https://developer.mozilla.org/en/Rhino_JavaScript_Compiler)。

即使在查看实现时，事情仍然不明确。有层层解读。以下是解释和编译之间的一些渐变：

1.  纯解释。和锡纸上写的差不多。阅读源代码并立即按照它所说的去做。这实际上不是由许多生产语言完成的——几乎只是像 shell 脚本这样的东西。

2.  [标记化](http://en.wikipedia.org/wiki/Tokenisation)+解释。对上述内容进行了简单的优化。它不是从头开始解释每一行，而是首先进行标记化（也就是说，不是看到像“print 52 + x”这样的字符串，而是将其翻译成标记流（例如`[PRINT_STATEMENT, INTEGER(52), PLUS_SIGN, IDENTIFIER('x')]`）以避免重复执行这种解释状态。许多版本基本的工作方式是这样的。

3.  [字节码](http://en.wikipedia.org/wiki/Bytecode)编译。这是 Java 和 C# 等语言所采用的方法（尽管见下文）。代码被转换为“虚拟机”的指令。然后解释这些指令。这也是 python 采用的方法（或者至少是 cpython，最常见的实现）[。Jython](http://www.jython.org/Project/)和[Ironpython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)实现也采用这种方法，但分别编译为 Java 和 C# 虚拟机的字节码。

4.  字节码 +[即时编译](http://en.wikipedia.org/wiki/Just-in-time_compilation)。如上所述，但不是解释字节码，而是在执行点从字节码编译将要执行的代码，然后运行。在某些情况下，这实际上可以胜过原生编译，因为它可以自由地对代码执行运行时分析，并且可以使用当前处理器的特定功能（而静态编译可能需要针对最低公分母 CPU 进行编译）。更高版本的 Java 和 C# 使用这种方法。 [Psyco](http://psyco.sourceforge.net/)为 python 执行此操作。

5.  Native machine-code compilation. The code is compiled to the machine code of the target system. You may think we've now completely eliminated interpretation, but even here there are subtleties. Some machine code instructions are not actually directly implemented in hardware, but are in fact implemented via [microcode](http://en.wikipedia.org/wiki/Microcode) - even machine code is sometimes interpreted!

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-04-13T23:17:31.510

这里有多个问题：

1.  不，Python 不被解释。标准实现编译成字节码，然后在虚拟机中执行。许多现代 JavaScript 引擎也这样做。
2.  无论实现（解释器、VM、机器代码）如何，您想要的任何东西都可以在后台运行。如果需要，您可以在后台运行 shell 脚本。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-04-13T23:30:23.447

从技术上讲，Python 被编译为字节码，然后在[虚拟机](http://en.wikipedia.org/wiki/Virtual_machine)中进行解释。如果 Python 编译器能够将字节码写入 .pyc 文件，它（通常）会这样做。

另一方面，Python 中没有像 Java 或 C 那样的显式编译步骤。从开发人员的角度来看，Python 似乎只是直接解释 .py 文件。此外，Python 提供了一个交互式提示，您可以在其中键入 Python 语句并立即执行它们。因此，Python 中的工作流程更类似于解释语言的工作流程，而不是编译语言的工作流程。对我（以及许多其他开发人员，我想）来说，工作流的区别比是否存在中间字节码步骤更重要。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-13T23:19:12.660

Python 是一种解释型语言，但它是在运行时解释的字节码。还有许多工具可以帮助您使您的程序作为 Windows 服务/UNIX 守护程序运行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-13T23:16:19.110

是的，Python 是解释型的，但您也可以将它们作为长时间运行的应用程序运行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-13T23:20:23.907

是的，它被解释了，它的主要实现首先编译字节码，然后运行它（如果你获取了一个 java 源代码并且 JVM 在运行它之前编译了它）。不过，您可以在后台运行您的应用程序。实际上，您几乎可以在后台运行任何东西。

# java - 带有类和接口的 Java 泛型 - 齐心协力

> ID：745756
> 
> 赞同：420
> 
> 时间：2009-04-13T23:21:54.200
> 
> 标签：java, class, generics, bounded-wildcard

我想要一个 Class 对象，但我想强制它代表的任何类扩展类 A 并实现接口 B。

我可以：

```
Class<? extends ClassA> 
```

或者：

```
Class<? extends InterfaceB> 
```

但我不能两者都做。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：669
> 
> 时间：2009-04-13T23:25:43.533

其实，你*可以*为所欲为。如果你想提供多个接口或一个类加接口，你必须让你的通配符看起来像这样：

```
<T extends ClassA & InterfaceB> 
```

请参阅 sun.com 上的[泛型教程](https://web.archive.org/web/20081217034134/https://java.sun.com/docs/books/tutorial/java/generics/index.html)，特别是页面底部的[有界类型参数部分。](https://web.archive.org/web/20081217141004/http://java.sun.com/docs/books/tutorial/java/generics/bounded.html)如果您愿意，您实际上可以列出多个接口，`& InterfaceName`用于您需要的每个接口。

这可能会变得任意复杂。为了进行演示，请参阅 的 JavaDoc 声明[`Collections#max`](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#max(java.util.Collection))，其中（包装成两行）是：

```
public static <T extends Object & Comparable<? super T>> T
                                           max(Collection<? extends T> coll) 
```

为什么这么复杂？正如 Java 泛型常见问题解答中所说：[保持二进制兼容性](http://www.angelikalanger.com/GenericsFAQ/FAQSections/ProgrammingIdioms.html#FAQ104)。

看起来这不适用于变量声明，但在将泛型边界放在类上时它确实有效。因此，要做你想做的事，你可能需要跳过几个圈。但你可以做到。你可以做这样的事情，在你的类上设置一个通用的边界，然后：

```
class classB { }
interface interfaceC { }

public class MyClass<T extends classB & interfaceC> {
    Class<T> variable;
} 
```

得到`variable`它有你想要的限制。有关更多信息和示例，请查看[Java 5.0 中的泛型的](http://www.javabeat.net/articles/33-generics-in-java-50-4.html)第 3 页。注意，在 中`<T extends B & C>`，类名必须在前，接口在后。当然，您只能列出一个类。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-11-13T10:38:04.330

您不能使用“匿名”类型参数（即使用 的通配符`?`）来执行此操作，但您可以使用“命名”类型参数来执行此操作。只需在方法或类级别声明类型参数。

```
import java.util.List;
interface A{}
interface B{}
public class Test<E extends B & A, T extends List<E>> {
    T t;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-07-24T00:43:09.640

这是你在 Kotlin 中的做法

```
fun <T> myMethod(item: T) where T : ClassA, T : InterfaceB {
    //your code here
} 
```

# c++ - C++语法问题

> ID：745757
> 
> 赞同：0
> 
> 时间：2009-04-13T23:22:06.553
> 
> 标签：c++, typedef, static-cast

以下语法是什么意思？

```
typedef void* hMyClass; //typedef as a handle or reference
hMyClass f = &something;
const MyClass& foo = static_cast<MyClass&>(*f);
foo.bar(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T23:25:05.893

static_cast 意味着系统实际上并没有尝试确保当您从一种引用类型转换为另一种时，您要转换的东西实际上是目标类型的一个实例（与动态转换不同）。

因此，您告诉编译器您足够聪明，知道 hMyClass 中包含的地址实际上包含 MyClass 的一个实例，并且您对如果您将发生的不可预测的事情承担全部责任错了。

你的“东西”是什么类型的？那里也可能有错误。你可能想要一个 &something。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T23:25:26.500

这实际上是无效的。您正在为类型分配一个值，而不是第 2 行的变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T23:26:00.663

void* 通常用于泛型指针。

在 C# 中，它类似于：

```
object o = new XmlDocument(); 
```

~~对象 o = 新列表（）；~~

然而，在 C++ 中，几乎没有强制执行类型安全。IIRC，static_cast 与 (cast) 相同，因为不进行运行时类型检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T23:28:07.990

本质上，有人将 MyClass 指针存储在 void 指针中，可能会将其传递给回调。该代码可能已被回调，正在将其转换为 MyClass。

此外，它也有语法错误，如 eagerwishes 所述。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T23:44:07.327

如果没有更多的上下文，很难准确地说出这个“意味着”什么。我假设您正在处理其他人的代码，并且您显示的行似乎分散在许多函数中。

我对代码意图的最佳猜测是，这是一种处理第三方代码/库的机制。在 C++ 中，使用（非模板化）具有您自己类型的第三方库是很常见的。如果这些库需要临时保存您创建和拥有的数据，您需要一种方法让库访问您的数据，即使库不知道您的类型。一个例子是回调/事件功能。如果一个库会在事件发生时异步通知您，您需要给它一个函数指针以及用户定义的数据，以便在调用该函数时，您知道如何处理它。库通常为此用户提供的数据使用 void* 指针。在 C++ 中，通常只为用户提供的数据传入一个对象实例，然后委托给该对象来处理回调。这里'

```
// 3rd-party library API
typedef void (*PingNotifyPtr)(void*);
void NotifyOnPing(PingNotifyPtr, void* userData);
// User Code
void MyNotify(void* myData)
{
   MyClass* ptr = (MyClass*)myData;
   // do something with ptr
}
void Main()
{
   MyClass *pClass = new MyClass();
   NotifyOnPing(&MyNotify, pClass);
   // the callback is now armed with all the data it needs.
} 
```

许多库通过声明“void*”参数来实现这一点。这是指向某个内存位置的原始指针。任何东西都可能在那个位置，一个整数、一个类实例、一个字符串等。第 3 方库保存该指针并在某个时候将其返回给您的代码。

示例代码的第 3 行采用 void* 指针并将其转换为对类实例的引用。C++ 引用类似于指针，但它们不能为 NULL 并且它们使用值语法（例如，使用“.”运算符而不是“->”运算符。）示例代码的第 4 行然后使用重新定义的方法构成类实例。

无论如何，如果您正在处理的代码库中所有 4 行代码都是连续的，那么该代码意味着有人对 C++ 一无所知。这是在一行中执行相同代码的更紧凑的方法：

```
((const MyClass*)something)->Foo(); 
```

或者，如果您更喜欢值语法：

```
(*((const MyClass*)something)).Foo(); 
```

祝你好运！

# actionscript-3 - Scaleform 现在支持 AS3 吗？

> ID：745760
> 
> 赞同：1
> 
> 时间：2009-04-13T23:22:54.883
> 
> 标签：actionscript-3, scaleform

Scaleform 现在支持 AS3 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T16:58:39.993

据说他们现在正在开发 AS3，并将在年底前推出。他们还声称正在优化渲染引擎以完全支持硬件中的 Flash 9/10 效果，这将是非常酷的。

他们新的 CLIK Flash UI 组件是由制作 Adob​​e Flash 9 组件的同一个人 Grant Skinner 制作的。基本上，它通过为游戏开发人员提供基于拖放动作脚本的 UI 小部件集来减少大量时间/风险......它非常简洁，可能非常有用，尤其是因为它是免费的套件。 [https://www.scaleform.com/products/clik](https://www.scaleform.com/products/clik)

我开始深入研究他们新的 AMP 内存/性能报告工具和 Flash 视频支持。看起来不再需要许可 Bink，我对此感到非常高兴，因为这从来没有给人留下深刻的印象。利用集成 Flash Video 非常适合全屏视频和 UI 中的特殊效果。

无论如何，当我听到更多关于 AS3 的信息时，我会告诉你的。到目前为止，我们对 Scaleform 的播放器、尤其是性能和对他们新 3.0 的记忆非常满意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-01T23:33:06.640

看起来 Scaleform 现在支持 AS3

[http://www.gamasutra.com/view/news/30745/New_Scaleform_GFx_40_Supports_ActionScript_3_Flash_10.php](http://www.gamasutra.com/view/news/30745/New_Scaleform_GFx_40_Supports_ActionScript_3_Flash_10.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-24T21:34:06.863

是的。Scaleform 在 4.0 版中增加了对 AS3 的支持。

以下是 Scaleform 支持的官方支持的 AS3 方法：http: [//gameware.autodesk.com/documents/gfx_4.0_as3_extensions.pdf](http://gameware.autodesk.com/documents/gfx_4.0_as3_extensions.pdf)

# asp.net - 当 UnitOfWork 是整个请求时，如何最好地通知用户 NHibernate 异常？

> ID：745761
> 
> 赞同：1
> 
> 时间：2009-04-13T23:23:00.997
> 
> 标签：asp.net, nhibernate, error-handling

我目前在 ASP.NET WebForms 应用程序中使用 Open Session in View 模式（改编自 Billy McCafferty 的[http://www.codeproject.com/KB/architecture/NHibernateBestPractices.aspx](http://www.codeproject.com/KB/architecture/NHibernateBestPractices.aspx)）。过于简单地说明这里发生了什么：

1.  在请求开始时打开 NHibernate 事务
2.  在请求结束时提交（回滚任何错误）

我通常通过在 Application_Error（我在其中记录、重定向到一般错误页面等）中捕获它们来处理任何异常的数据库错误，如下所示：

```
 ...
          if (Context != null && Context.IsCustomErrorEnabled)
        {
            Server.Transfer(ErrorPageLocation, false);
        }
        else
        {
            log.Error("Unhandled Exception trapped in Global.asax", exception);
        } 
```

但是对于 NHibernate，当我遇到任何 NHibernate/Database 错误时，请求执行我通常的 Server.Transfer 为时已晚（显然在请求的后期不会发生传输）错误重定向（尽管仍然会发生日志记录）。作为一个非常快速的解决方法，我在自定义 HttpModule 的 HttpApplication Context EndRequest 中完成了以下操作：

```
 try
        {
            // Commits any open transaction and throws after rolling back any HibernateException and closing session.
            NHibernateSessionManager.Instance.CommitTransaction();
        }
        catch (HibernateException)
        {
            HttpContext.Current.Response.Redirect(ERROR_PAGE_LOCATION);
        }
        finally
        {

            NHibernateSessionManager.Instance.CloseSession();
        } 
```

...但这闻起来不仅因为我现在在我的 Web 中引用 NHibernate，而且主要是因为我确信一定有更好的方法。在发生数据库/NHibernate 错误时将用户重定向到通用错误页面的更好方法是什么使用 Global.asax.cs Application_Error 中的 Server.Transfer？更进一步，对于 Web 服务，它变得更加棘手，因为上述 hack 显然没有任何效果（并且在接收端没有抛出异常来处理 - 在我的情况下，最常见的是在客户端 ajax 调用中）。

请告诉我我遗漏了一些明显的东西（通常在我点击提交这些问题后，明显的东西就会击中我）！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T23:49:24.103

据我了解，视图模式中的打开会话不一定意味着一个工作单元对整个请求都是开放的。我通过在我的控制器方法中明确定义一个工作单元来处理这个问题（在 ASP.NET MVC 中，不是 webforms，但原理是一样的）。在控制器方法返回之前，任何数据库事务都已提交，因此我可以在那时正确处理任何数据更新错误。即使在事务提交之后，会话仍然保持打开状态。出于我的目的，视图中的打开会话主要用于允许在视图阶段延迟加载相关对象。我选择这样做有两个主要原因：

1.  在将视图呈现给响应时，我不想让任何数据库事务保持打开状态——这不是必需的，并且对于数据库事务，越短越好。
2.  使用“使用”模式，拥有一个明确的工作单元并不需要太多额外的努力

在视图阶段发生的任何 NHibernate 错误对我来说都不那么重要——事务和任何更新都已经完成，所以我可以使用通用的包罗万象的重定向错误处理程序来处理这些错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T01:20:25.520

我们在错误页面非常基本的情况下所做的一件事是简单地干预 Page.OnError（通过基本页面）并通过响应发出 html。有点蹩脚，但可以在一个集中的位置为您提供所需的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T02:38:45.817

或许您可以在 global.asax 中声明一个 bool 来指示上一个请求中发生了错误。您将其设置为 true in `Application_Error`，然后检查其值`Application_BeginRequest`并重定向是否为 true？

# php - 生成带有数字签名的 PDF

> ID：745779
> 
> 赞同：12
> 
> 时间：2009-04-13T23:27:23.703
> 
> 标签：php, pdf-generation, digital-signature

是否可以在 PHP 中生成带有数字签名的 PDF 文件？首选开源解决方案。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-09-06T18:38:54.293

TCPDF 从版本 5.5.001（2010-06-23 发布）开始可以签署生成的 PDF 文档。

它还可以在任何位图/文本上放置透明的签名矩形字段，因此单击签名字段会显示签名面板 - 很酷的功能。seta-PDF 签名者也是如此，但是您必须付费:-)

如果 TCPDF 使用 FPDI 桥接器进行扩展，它还可以解析现有的 PDF 版本高达 1.7 的文档，并使用 X.509 证书对其进行签名。它可以 100% 解析自己生成的 PDF 文档或任何其他 PHP PDF 工具（例如 FPDF、DOM PDF、mPDF 等）创建的 PDF 文档，计算 PDF 签名并写回相同的签名 PDF 文档。

但是，如果您想解析由其他（例如二进制）PDF 生成器（iText、..）创建的 PDF 文档，它可能无法解析该文档。您可以尝试另一个 PDF 解析器（我只知道 Zend Framework PDF Parser 值得尝试），但是它可能无法读取和反编译 PDF 文档的整个结构，因为 PHP 对 PDF 定义的实现有限（PHP 是主要的文本脚本语言，无法处理二进制文件东西很容易，所以这是限制的根源）。

因此，如果您正在考虑在您的网站上生成 PDF，请使用相同的工具来创建 PDF 文档和签名 - 我可以在这里推荐的最佳工具是 TCPDF。如果您还没有听说过，请通过 google 查找 (:-o)

目前，我不认为 DOM PDF 可以签署 PDF 文档。

VersyPDF 是 .dll/.so PHP 扩展名，支持非常差，价格昂贵，而且文档记录很差。您可能会遇到没有错误消息的无声崩溃...它也不支持现在标准的 256 位 AES 证书。如果您作为开发人员在 32 位机器上运行，而在生产中运行 64 位机器，则必须获得不同的重新编译版本。我们用 TCPDF 替换了 VersyPDF。性能损失几乎不显着，我们能够动态生成 300 - 600 kB PDF 签名文档。很遗憾，否则 VersyPDF 有一些不错的 API，如果你使用它和良好的性能。根据我的经验，这是一场单人表演...

干杯卢博斯

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-14T00:52:01.423

[VersyPDF PHP 库](http://www.sybrex.com/products/development/versypdf/index.php)（商业）也将签署文件

也可以使用开源[iText](http://www.lowagie.com/iText/) java 库和[PHP-Java 桥](http://php-java-bridge.sourceforge.net/pjb/)来进行通信。请参阅有关此的iText[常见问题解答](http://itext.ugent.be/library/question.php?id=34)

iText 可以通过自签名、veriSign 插件或 windows Certificate Security 对文档进行签名。当我过去在 Java 项目中使用它时，签署文档只是应对[示例](http://itextpdf.sourceforge.net/howtosign.html)，通常需要不到一百行。最难的是获得正确的证书来签署它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T23:30:19.513

[有一种叫做 SetaPDF-Signer 的东西。](http://www.setasign.de/products/pdf-php-solutions/setapdf-signer/sign-pdf.php)虽然它不是免费的：S

> SetaPDF-Signer API 允许 PHP 开发人员在纯 PHP 中对 PDF 文档进行数字签名。

# objective-c - 使用 Cocos2D-iphone 自定义缓动动作

> ID：745781
> 
> 赞同：5
> 
> 时间：2009-04-13T23:27:48.943
> 
> 标签：objective-c, iphone, cocos2d-iphone

如何在 Cocos2D 中创建一个自定义操作，该操作能够随着时间的推移执行“回调”，使每次调用回调的时间逐渐长于最后一次调用（使用类似于 Cocos2D 已经提供的 EaseExponentialOut 操作的东西。

与此类似的东西：（不起作用）

```
id sequence = [Sequence actions: [CallFunc actionWithTarget: self selector: @selector(spinTick)], [DelayTime actionWithDuration: 0.034f], nil];
id repeat = [Repeat actionWithAction: [sequence copy]  times: 18];
id ease = [EaseExponentialOut actionWithAction: [repeat copy]];
[ease setDuration:4];

id play = [CallFunc actionWithTarget:self selector:@selector(play)];
[self runAction: [Sequence actions: [ease copy], [play copy], nil]]; 
```

上面的代码执行了整个“序列”18 次，然后在最后一个序列结束时执行“播放”回调。

但是，EaseExponentialOut 似乎对创建的“重复”动作没有任何影响——我曾预计它会调整“序列”动作内的“延迟时间”动作的持续时间，但它没有出现去做这个。

我还尝试基于 IntervalAction 创建自己的自定义操作，但惨遭失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T13:32:47.887

显然，上面的代码是有效的，它只是我在持续时间内使用的时间。也没有必要使用“复制”，因为这些操作可以按原样使用。

如果我将时间从 0.034 增加到更接近 0.25 的值，那么结果更接近于我希望看到的结果。现在我只需要使用持续时间的值来让它“恰到好处”。

# asp.net - ; 在 cookie 值中修剪 asp.net 中的 cookie

> ID：745785
> 
> 赞同：1
> 
> 时间：2009-04-13T23:28:21.657
> 
> 标签：asp.net

我正在使用数据库中的值保存 cookie，然后在另一个页面上访问该 cookie。我注意到如果 cookie 有一个 ; 在它的价值中，它被切断了;。除了更改数据使其不包括;之外，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T23:32:00.290

这是http的限制。您将不得不像这样对 cookie 值进行编码

```
string cookieValue = Server.UrlEncode(someValue); 
```

和解码是

```
string someValue = Server.UrlDecode(cookieValue); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T23:34:11.003

分号是 cookie 的特殊字符。您必须以某种方式在 cookie 中对其值进行编码。

由于您使用的是 ASP.NET，它应该像调用一样简单：

```
cookieString = HttpUtility.UrlEncode(cookieString); 
```

# mysql - 将 php4/mysql4 迁移到 php5/mysql5：切换到 InnoDB？

> ID：745787
> 
> 赞同：2
> 
> 时间：2009-04-13T23:30:06.800
> 
> 标签：mysql, innodb, myisam

我有一个旧的 Web 应用程序 php4/mysql4（MyISAM，db 包含一些 cms、一些用户数据、一些日历应用程序）。现在我要迁移到一个带有 php5/mysql5 的新服务器。

迁移 mysql 数据库时是否应该更改为 InnoDB？- 预期的优势/劣势/风险？- MyISAM 是被弃用还是有一天会被弃用？或者我可以安全地保留它吗？- 我听说MyISAM 容易损坏，InnoDB 呢，它抗崩溃吗？- InnoDB 是否更容易或更安全地备份和恢复？

当我改变（破坏 SQL 查询）或破坏逻辑（因为改变了锁定机制）时，它会破坏我的代码吗？如果是这样，典型的场景是什么？

（对于 php 问题，我创建了一个不同的问题：[Migrating php4/mysql4 to php5/mysql5: expected php issues?](https://stackoverflow.com/questions/745806/migrating-php4-mysql4-to-php5-mysql5-expected-php-issues)）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T23:34:35.587

您应该研究的关键是您的数据库是如何使用的。如果它的读多于写，那么你应该坚持使用 MyISAM，如果它的写多于读，你应该研究 InnoDB。

如果您想知道 InnoDB 和 MyISAM 之间的区别，那么[Wikipedia 上有一个很好](http://en.wikipedia.org/wiki/Myisam)的区别列表。

> MyISAM 对任何现有行的写入使用表级锁定，而 InnoDB 使用行级锁定。
> 
> 对于经常更新许多行的大型数据库应用程序，行级锁定至关重要，因为单个表级锁定会显着降低数据库中的并发性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T01:01:38.593

值得将 MySQL v4/v5 升级与表升级分开。这减少了潜在的问题范围。

也就是说，如果重新启动数据库很少发生，那么在 v4/v5 升级之前花一些时间查看 InnoDB 服务器选项，因为其中许多都需要重新启动数据库。推荐的两个是 innodb_file_per_table=1 和 innodb_flush_log_at_tx_commit=1（查找它们），您还应该查看 innodb_buffer_pool_size，因为如果没有人更改它几乎肯定会太低。

MyISAM 将会存在很长时间。它是一种非常健壮的磁盘格式，在许多情况下具有一些有用的特性。特别是，它的速度非常快`SELECT`，这对于没有更新或更新很少的小型表很有用。也就是说，一个非常热的表（很多很多`SELECT`）将受益于迁移到 InnoDB，因为 MyISAM 不支持并发读取。

MyISAM 几乎总是能在数据库崩溃中幸存下来，只不过是`REPAIR TABLE`需要而已。InnoDB 并不总是那么幸运。MyISAM 也可以从数据库中备份出来；即使您没有事先锁定表格，您也很可能会得到一个可以正常工作的文件。InnoDB 文件不是那么好；这就是 innodb_hot_copy 存在的原因。

我们最近进行了 MySQL v4/v5 升级，我们只有一个 SQL 问题：混合模式`JOIN`。`LEFT JOIN`在将隐式表连接与显式子句混合时，版本 4 的解析器相当宽容。版本 5 不是那么宽容。所以我们趁机搜遍了app，把所有的`JOIN`s都升级为explicit `JOIN`s。除了错过一两个景点外，这是非常成功的。

我建议您使用 PHP 4 与 MySQL v5 对话来设置测试环境。这将让您测试所有这些。

# wxwidgets - Rainlendar 如何使用 wxWidgets 实现透明度

> ID：745797
> 
> 赞同：2
> 
> 时间：2009-04-13T23:35:17.973
> 
> 标签：wxwidgets

[Rainlendar](http://www.rainlendar.net/cms/index.php)是一个用 wxWidgets 编写的出色的跨平台日历程序。它是如何实现透明效果的？有没有人有任何演示透明效果的示例代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T06:51:37.567

我的猜测是他们可以使用 a`wxScreenDC`直接绘制到屏幕上（同时保留背景内容）。与接收绘制事件或擦除事件不同，您可以`wxScreenDC`根据自己的选择在堆栈上创建一个，这意味着您需要刷新自己（很可能通过某种计时器）。如果你不这样做，后台应用程序最终会在你的`wxScreenDC`内容上重新绘制它们自己。

[这是 API 清单](http://docs.wxwidgets.org/trunk/classwx_screen_d_c.html)

**编辑：**澄清一下，用法（除了需要调用 StartDrawingOnTop 和 EndDrawingOnTop）与任何其他`wxDC`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T12:07:56.667

[wxTopLevelWindow::SetTransparent()](http://docs.wxwidgets.org/trunk/classwx_top_level_window.html#8e37aff45a001a83ff49745298a6978e)方法可能是您需要的。

# jquery - 有 jQuery 文本框列表吗？

> ID：745798
> 
> 赞同：3
> 
> 时间：2009-04-13T23:36:42.587
> 
> 标签：jquery, facebook, mootools, textboxlist

Facebook 有一个很棒的 TextboxList 组件。 [替代文字 http://img10.imageshack.us/img10/1803/textboxlistfacebook.png](http://img10.imageshack.us/img10/1803/textboxlistfacebook.png)

这[刚刚（从头开始）移植到 MooTools](http://devthought.com/blog/projects-news/2009/04/the-new-textboxlist-is-here/)中。

有谁知道这是否存在于 jQuery 中？

编辑：啊！*自动完成*是我缺少的关键字。干杯！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-13T23:39:08.917

[快速谷歌搜索](http://www.google.com/search?q=jquery+facebook+autocomplete)显示以下内容：

*   [jquery facebook 自动完成](http://wharsojo.wordpress.com/2008/02/18/jquery-facebook-autocomplete/)
*   [FCBKcomplete v 2.01](http://www.emposha.com/javascript/fcbkcomplete.html)
*   [整容](http://journal.suteki.nu/2008/11/11/facelist-improved-facebook-autocompletion-jquery-plugin/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T00:14:07.780

devthought 也将其移植到 JQuery

*   [文本框列表](http://devthought.com/projects/jquery/textboxlist/)

# build-process - 构建/部署脚本是否应该包含配置？

> ID：745805
> 
> 赞同：0
> 
> 时间：2009-04-13T23:40:31.800
> 
> 标签：build-process

我会保持简单：

那么，如果我有“经典”三个环境（开发/测试/生产），构建脚本应该包含部署分发中的配置，还是应该单独部署的东西？

我听过的两种思想流派：

> 您的工件在不同环境之间应该完全相同，并且保持配置分开可以消除部署之间的差异。

对比

> 将配置构建为部署分发的一部分是测试分发本身的一种方法，因此是正确的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T23:55:45.723

我同意上面的观点，但那样会在源代码中包含配置文件，例如

```
web.xml.DEV
web.xml.STAGING
web.XML.PRODUCTION 
```

然后让构建过程将适当的文件复制到正确的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T23:45:56.823

我投票赞成将它们放在一起，并根据环境参数化部署设置。我自己经历过，并开始尝试处理选项 1。在部署到生产中时不断出现意外错误，因为该代码没有经过测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T19:38:10.267

使用上勾拳。然后你在源代码控制中保留一个模板文件，每个环境的一些设置文件，UppercuT 会自动为你构建它们。然后，您可以使用您的部署框架来选择合适的框架。

UppercuT 使用 NAnt 来构建，它是非常容易使用的构建框架。

[http://code.google.com/p/uppercut/](http://code.google.com/p/uppercut/)

这里有一些很好的解释（包括对 ConfigBuilder 的解释）：[UppercuT](http://ferventcoder.com/category/uppercut.aspx)

# php - 将 php4/mysql4 迁移到 php5/mysql5：预期的 php 问题？

> ID：745806
> 
> 赞同：2
> 
> 时间：2009-04-13T23:40:32.487
> 
> 标签：php, migration, php4

我有一个旧的 Web 应用程序 php4/mysql4（MyISAM，db 包含一些 cms、一些用户数据、一些日历应用程序）。现在我要迁移到一个带有 php5/mysql5 的新服务器。

在这样的迁移场景（php、sql 查询等）中，典型的 php 问题是什么？

我听说函数参数传递发生了变化，按引用调用/按值调用。你能举个例子或解释一下吗？

还有什么我应该注意的吗？

（mysql 问题包含在另一个问题中：[Migrating php4/mysql4 to php5/mysql5: switch to InnoDB?](https://stackoverflow.com/questions/745787/migrating-php4-mysql4-to-php5-mysql5-switch-to-innodb)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T23:44:17.920

我认为最好的迁移帮助[来自 PHP 人员自己。](http://docs.php.net/manual/en/migration5.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T01:09:19.870

大多数 PHP 4/5 兼容性问题是两件事：

*   新的保留字
*   新的类/对象后端

大多数 v4 代码在 v5 中运行良好。您可能遇到问题的地方是依赖于 v4 类模型限制或利用 v4 参考怪癖的代码。但是大多数人不会针对这些限制进行编码（我有 - 这就是为什么我知道他们在那里）。

如果您受困于类/对象限制，您可以在“v1”模式下运行 Zend 引擎，这会使类和对象的行为类似于 v4 中的行为。[这是记录在案的。](http://www.php.net/manual/en/ini.core.php#ini.zend.ze1-compatibility-mode)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T23:59:53.827

我正在迁移，我发现了很多[混叠](http://en.wikipedia.org/wiki/Aliasing_(computing))问题。

如果您想要一个干净的代码，那么您需要为您的特定代码段找到合适的解决方案。如果清洁度不是那么重要，您可能会发现此功能非常有用：

```
function php4_clone($object) {
    if (version_compare(phpversion(), '5.0') < 0) {
        return $object;
    } else {
        return @clone($object);
    }
} 
```

# image - 用于捕获签名的 Firefox 插件（通过手写笔/平板电脑）

> ID：745810
> 
> 赞同：0
> 
> 时间：2009-04-13T23:42:15.493
> 
> 标签：image, firefox, handwriting, electronic-signature

我想知道是否有人有任何使用平板电脑/手写笔在互联网上捕获签名的经验。
您将如何编写一个使用 ActiveX 控件并可以在 Web 上安全地发布签名的插件？

或者也许你有更好的想法如何处理这个......

提前致谢。

[编辑] 更具体地说，我需要一些可以连接到签名板的东西，就像你在百思买用来做合法签名一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T23:44:54.393

我会以某种方式使用会绘制位图的闪存，然后将它们编码为图像，然后将它们上传到您的服务器。

经过几分钟的谷歌搜索，我找到了这个。

[http://www.kirupa.com/developer/actionscript/drawingboard.htm](http://www.kirupa.com/developer/actionscript/drawingboard.htm)

**编辑** [http://www.topazsystems.com/](http://www.topazsystems.com/)有一个 activex 控件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-08T23:35:24.413

您可以嵌入 DocuSign 并将其呈现在任何设备（平板电脑、手机等）上。DocuSign 检测它是否在移动设备上并允许人们绘制签名。通过使用像 DocuSign 这样的系统，您可以获得法律和金融机构的附加有效性和接受。

# casting - 无法将类型“int”隐式转换为“System.Data.SqlClient.SqlDataReader”

> ID：745818
> 
> 赞同：0
> 
> 时间：2009-04-13T23:45:07.967
> 
> 标签：casting

我正在尝试使用 SqlDataReader 来计算我使用的类别数量。

这是我的业务逻辑代码：

```
// Return count of main categories for homepage
    [DataObjectMethodAttribute(DataObjectMethodType.Select, false)]
    public int GetMainCatCount(int intCategoryID)
    {
        intCategoryID = SQLInject(intCategoryID);

        SqlConnection con = new SqlConnection(conString);
        SqlCommand cmd = new SqlCommand();
        cmd.Connection = con;
        cmd.CommandText = "SELECT COUNT(intCategoryID) "
                        + "FROM  tblCategory "
                        + "WHERE intCategoryID=" + intCategoryID;
        con.Open();
        return (Int32)cmd.ExecuteScalar();
    } 
```

这是我在代码后台页面中的代码进行调用：

```
public string CountCategory(int intCategoryID)
    {
        SqlDataReader myReader;
        myReader = CategoryBLL.GetMainCatCount(intCategoryID);

        myReader.Close();
        myReader.Dispose();
        return Convert.ToInt32(myReader);
    } 
```

我想使用 SqlDataReader 的结果来填充标签标记。当我尝试运行此代码时，我收到此错误消息：

**无法将类型“int”隐式转换为“System.Data.SqlClient.SqlDataReader”**

谁能告诉我哪里出错了。谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T23:51:16.780

> 谁能告诉我哪里出错了。谢谢...

当然：尝试将 int 转换为`SqlDataReader`. 稍后，您还尝试将 an 转换`SqlDataReader`为 int。

老实说，您示例中的类型非常糟糕，以至于我什至无法弄清楚代码应该做什么。要开始，[请阅读此](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.aspx)。

* * *

仔细考虑一下，这是一个潜在的固定版本：

```
public string CountCategory(int intCategoryID)
{
    int count = CategoryBLL.GetMainCatCount(intCategoryID);
    return count.ToString();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T23:51:36.170

您的“GetMainCatCount”方法返回一个 int，但您将其返回值分配给 SqlDataReader 类型的变量：

```
SqlDataReader myReader;
myReader = CategoryBLL.GetMainCatCount(intCategoryID); 
```

此外，您的 CountCategory 方法被定义为返回一个字符串，但您从它返回一个 Int32（最后一行的 Convert.ToInt32 调用的结果）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T23:51:53.987

```
 myReader = CategoryBLL.GetMainCatCount(intCategoryID); 
```

在该行中，您尝试将 Int32 转换为 SqlDataReader 类型的对象。

你想尝试`myReader.GetMainCatCount(intCatagorID);`

# c++ - 如何在 C++ 中实现元类？

> ID：745819
> 
> 赞同：2
> 
> 时间：2009-04-13T23:45:14.080
> 
> 标签：c++, metaclass

我一直在阅读一些关于什么是元类的文章，但我想知道它们是否可以在 C++ 中实现。

我知道 Qt 库正在使用 MetaObjects，但它使用 C++ 的扩展来实现它。我想知道是否可以直接在 C++ 中使用。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T00:02:39.983

C++ 没有对元类的内置支持（不是以 Python/Objective-C 方式），但是您可以手动模仿元类的行为。基础非常简单，您创建一个生命周期更长的额外类（单例、静态对象或[Construct On First Use Idiom](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Construct_On_First_Use)），它能够创建和操作它的相应类。（在 Objective-C 中，元类通常包含“静态”成员变量、内存分配/释放例程等）。

Qt 所做的是，他们采用了元类的概念并对其进行了修改，以便它们可以支持某种形式的反射（以及不支持它的系统上的 RTTI）。实现这一点将需要大量的宏魔术或自定义编译器（例如他们选择使用的）。

不过一般来说，常规元类提供的大部分特性已经由 C++ 语言提供。只是以不同的形式。实际上，您需要元对象的唯一原因是出于反射目的，如[本文档](http://www.garret.ru/cppreflection/docs/reflect.html)中所述，在 C++ 中实现反射有不同的方法。

除此之外，如果您真的设置在 Objective-C 风格的元类系统上，我不知道有任何库可以做到这一点，但很可能有。另一方面，自己滚动也不应该那么困难。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T23:56:47.580

Gamma 等人的“设计模式”一书中的一些模式与元类概念具有相似的特征。例如，“策略”模式允许您在创建时自定义对象行为。信封成语是另一个紧密的匹配。但是，也不允许您自定义类的接口。

在 COM 中，IDispatch 接口允许在运行时向对象动态添加方法/属性。不过，这意味着放弃标准的 c++ 方法调用。每个调用都通过相同的方法，该方法将索引或字符串键放入用户维护的方法/属性表中，并且所有参数必须作为对象数组传递。

使用这两种技术，您可以获得元类的灵活性，但由于没有语法优势或运行时/编译器帮助，这是一个更难的过程。

戴夫

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-13T23:58:09.370

如果元类的工作定义是“实例化本身就是类的语言实体”，那么*泛型*就是 C++ 中的元类：

```
#include <iostream>
using namespace std;

template <typename T>
class Meta {
public:
    Meta(const T&init) : mData(init) {}
// ...
private:
    T mData;

};

int main(int, char **) {
  cout << "The size of Meta<double> is " << sizeof(Meta<double>) << endl ;
  return 0;
} 
```

在倒数第二行中使用 Meta<double> 会强制编译器实例化 Meta<double> 类；sizeof 运算符对 Meta 进行操作，从而证明这不仅仅是语义糖，而且该类已被实例化。即使没有实例化 Meta 类型的对象，该程序也是完整的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-13T23:56:58.000

不怕……至少不是本地人。

拥有一个元类通常需要一个代表类的运行时对象，就像 Java 中的情况一样。

在 C++ 中，类没有运行时表示。它们的表现形式出现在虚拟桌子之类的东西中。但在许多方面，它们像 C 函数一样运行，所有 OOP 几乎就像胶水代码一样运行。

话虽如此，您可能希望使用其他语言的元类来实现许多事情的 OOP 模式。您还可以“模拟”您自己的对象系统。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-14T00:56:51.443

可以创建元类，但是 C++ 不是这样，它是关于基于静态编译时的实现，而不是运行时的灵活性。

无论如何，这取决于您是否想要带有方法的元类或仅带有数据的元类，可以使用诸如 boost::any 之类的 Boost 构造来实现数据类，如果您想要带有方法的类，则可以使用 boost::bind 来将方法绑定到对象，或者您可以使用单入口点接口（如 COM 对象）自行实现它们。

然而，“真正的”C++ 方法是使用泛型，因此它可以在编译时确定，以获得最佳性能。

老实说，我见过很少的系统，尽管我见过一些真正需要运行时灵活性的系统，在大多数情况下，对象在同一个类中诞生和消亡，或者至少足以将其 95% 的生命周期作为一个单一的他们从工厂出来后上课。

因此，在许多情况下，人们会发现自己为运行时元类付出了太多。当然，有一种观点认为这可以提供更好的开发人员性能，但在许多情况下，每行代码在硬件上运行的时间是编写它所花费的时间的几亿倍。因此，您可以将编译时和运行时类视为预付费用或永久租用。我个人喜欢先付钱。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-14T14:05:29.810

您可能想看看这篇博文。

[https://herbsutter.com/2017/07/26/metaclasses-thoughts-on-generation-c/](https://herbsutter.com/2017/07/26/metaclasses-thoughts-on-generative-c/)

元类可能会进入 C++，但还需要一段时间。

# shell - 在 Shell 编程中遍历文件中的命令列表

> ID：745820
> 
> 赞同：4
> 
> 时间：2009-04-13T23:45:31.663
> 
> 标签：shell

我有一个包含 unix 命令列表的文件，例如“ls -la /etc/passwd”。我想遍历这个命令列表，并采取适当的行动。

目前，我的代码是这样的：

```
#!/bin/bash
clear
for cmds in `cat /tmp/cmd`
do
        if [  $cmds ] ; then
                echo $cmds;
        fi
done 
```

但是，我得到的是一个输出，其中命令被分成不同的行，比如

```
ls 
-la 
/etc/passwd
ls 
-la
/etc/shadow 
```

并不是

```
ls -la /etc/passwd
ls -la /etc/shadow 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T23:54:00.487

在你的 for 循环之前添加这个：

```
IFS='
' 
```

或者在 Bash 中：

```
IFS=$'\n' 
```

[`IFS`](http://www.gnu.org/software/bash/manual/bashref.html#Bourne-Shell-Variables)包含用于将输入拆分为字段的字符列表；它默认包含空格、制表符和换行符，这就是你得到不正确行为的原因。将其设置为换行符只会在换行符上拆分，这是您想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T23:57:40.963

我相信你也可以这样做（用双引号括起来你的反引号）：

```
"`cat /tmp/cmds`" 
```

也许尝试这样的事情（不确定您的“if”应该检查什么 - 我对其进行了修改以确保 $cmds var 不是空字符串）：

```
#!/bin/bash

clear

for cmds in "`cat cmds.txt`"
do
    if [ "$cmds" != '' ]; then
        echo "$cmds"
    fi
done 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T02:07:28.060

如果文件中的每一行都是一个完整的命令 - 多行没有延续 - 那么您可以使用`read`：

```
while read cmd
do
    if [ -z "$cmd" ]
    then : Empty
    elif $cmd
    then : OK
    else : Oops
    fi
done < cmds.txt 
```

或者，如果您更喜欢线性构造并且不需要 while 循环在下面表示的子外壳中的任何内容，您可以使用：

```
cat cmds.txt |
while read cmd
do
    if [ -z "$cmd" ]
    then : Empty
    elif $cmd
    then : OK
    else : Oops
    fi
done 
```

请注意在测试字符串周围小心使用引号。我还是更喜欢使用显式的 ' `-z`' 运算符；有些人认为这不是 100% 必要的。我仍然使用单方括号而不是双方括号——主要是出于 20 多年的习惯。那些使用`bash`或`ksh`经常更喜欢使用双方括号运算符来学习 shell 的人。

当然，要小心 I/O 重定向。

此外，如果您在各种 then 和 else 子句中没有任何事情可做，您应该简单地将 cmds.txt 提供给 shell：

```
sh cmds.txt 
```

这是迄今为止处理多行命令最可靠的方法。

# open-source - 是否有使用敏捷/Scrum 方法的开源项目的成功案例？

> ID：745823
> 
> 赞同：2
> 
> 时间：2009-04-13T23:47:01.190
> 
> 标签：open-source, agile, scrum

大多数成功的大型开源项目似乎都遵循仁慈的独裁者风格的组织。但我想知道开源中是否有任何敏捷开发的成功案例。当提到开源时，我指的是大型网络社区驱动的开发，而不是在同一屋檐下进行开源的成熟团队。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T00:03:02.697

我认为这是基于一种误解。如果你看一下[敏捷宣言](http://agilemanifesto.org/principles.html)，大多数开源项目*都是*“敏捷的”。

很少有开源项目遵循 XP 或 SCRUM（等）的确切做法，但环境不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T00:01:09.270

我没有真正看过代码，但我知道“Fitnesse”项目使用了非常严格的敏捷开发实践。在这种情况下，Bob Martin 可能是一个仁慈的独裁者，负责监督代码，但他们使用了很多敏捷实践，如 TDD 等。

我不确定他们是否专门使用 SCRUM。

[http://fitnesse.org/](http://fitnesse.org/)

# wcf - 每个经过身份验证的 WCF 客户端连接是否都需要 CAL？

> ID：745830
> 
> 赞同：3
> 
> 时间：2009-04-13T23:49:43.960
> 
> 标签：wcf, wcf-security, wcf-client

就像标题所说的那样。您开发的与 WCF 服务器的每个经过身份验证的 WCF 客户端连接是否都需要 Windows CAL？

[http://www.microsoft.com/windowsserver2008/en/us/client-licensing.aspx](http://www.microsoft.com/windowsserver2008/en/us/client-licensing.aspx)

微软在该页面上的许可确实让它听起来很像，但我找不到任何可以证实甚至否认这一点的东西。

有人知道吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-25T02:14:44.927

**是**的，答案是，您需要 CAL 或外部连接器。如果您的客户端系统或应用程序以经过身份验证的方式访问 Windows 服务器，则需要通过特定于用户的 CAL、特定于设备的 CAL 或外部连接器对客户端进行授权。

CAL 适用于企业内部连接。EC 用于从您的企业外部（包括合作伙伴公司或整个互联网）建立的连接。

使用 WCF、DCOM、FTP、Telnet 或其他任何方式连接到 Windows Server 都没有关系。出于许可的目的，CAL 或 EC 要求不区分用于通信的技术。当您拥有对服务器的*身份验证*访问权限时，无论何种类型，CAL 或 EC 要求都会出现。

同样根据许可证，身份验证是否由 Active Directory 执行并不重要。如果您使用 AD 对用户进行身份验证，则需要 CAL 或 EC，但如果您使用其他机制进行身份验证，例如，如果您有一个包含用户列表和密码哈希的 XML 文件，并且您的简单 ASP.NET 网站进行身份验证用户访问该商店，则您具有经过身份验证的访问权限，并且您需要为每个经过身份验证的用户提供 EC 或 CAL。

EC 不能与 CAL 互换。如果您发现您有 500 个内部用户需要进行身份验证，则您无法购买单个 EC 并根据许可证将其全部覆盖。外部连接器用于*外部*连接。任何说 EC 比购买 CAL 是“更好的解决方案”的许可顾问都是错误的。没有决定要做。Windows Server 许可条款非常明确（尽管可能没有被广泛理解）：

*   如果您有内部用户，则必须为他们每个人（或他们使用的每台设备）购买 CAL。
*   如果您有外部用户，在这种情况下您必须购买 EC。无论您有 3 个还是 3,000,000 个外部用户，因为他们是外部用户，所以您需要一个 EC。

根据 Windows Server 的许可，您无法选择是否购买 CAL 或 EC。该要求由用户的隶属关系设定。事实上，在某些情况下，如果内部和外部用户都将向同一个 Windows Server 进行身份验证，那么您将需要 CAL 和 EC。

外部连接器的“估计零售价”为 1999 美元，但通过软件分销商，您将能够以更便宜的价格获得它，即使是个位数的单位。比如1300美元左右。同样，CAL 有一个“ERP”，但您从软件经销商处支付的费用低于 ERP。

# javascript - 设置 document.domain 是否适用于所有（大多数）浏览器？

> ID：745831
> 
> 赞同：17
> 
> 时间：2009-04-13T23:50:06.753
> 
> 标签：javascript, browser, cross-browser

[同源策略文档](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)是这样说的：

> 同源规则有一个例外。脚本可以将 document.domain 的值设置为当前域的后缀。如果这样做，则较短的域将用于后续的来源检查。例如，假设 [http://store.company.com/dir/other.html](http://store.company.com/dir/other.html)文档中的脚本 执行以下语句：
> 
> document.domain = "company.com";
> 
> 该语句执行后，页面将通过 [http://company.com/dir/page.html](http://company.com/dir/page.html)的来源检查。但是，同理，company.com 无法将 document.domain 设置为 othercompany.com。

所有流行的浏览器都支持这个吗？如果没有，哪些没有？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-13T23:59:20.880

Firefox 2,3, IE6,7,8, Chrome, 以及 Safari 2 和 3, Opera 9 都支持 document.domain；

其他“较新”的浏览器也可能会，但那些是我实际测试过我的代码的浏览器（它使用了 document.domain）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-03-20T11:21:43.723

文档域应该是小写的，规则是这样的

```
// Actual domain is "www.foo.com" 
document.domain = "foo.com"; // this is valid 

// Actual domain is "bar.foo.com" 
document.domain = "www.foo.com"; // this is invalid, "bar.foo.com" is not a subdomain of "www.foo.com" 

// Actual domain is "blah.bar.foo.com" 
document.domain = "bar.foo.com" // Ok 
document.domain = "foo.com" // Still ok 
document.domain = "bar.foo.com" // Invalid, you can't change it back to a more specific domain. 
```

# c# - 字符串到方法

> ID：745842
> 
> 赞同：1
> 
> 时间：2009-04-13T23:56:25.957
> 
> 标签：c#

能够即时创建 javascript 代码非常酷。那是通过使用

```
HtmlPage.Window.Eval("alert('Hello World')"); 
```

但是有没有办法用 C# 方法做同样的事情？让我们说类似

```
void MethodEval("MessageBox.Show('Hello World')"); 
```

甚至有可能，而无需重新编译您的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T00:12:40.503

可以使用其他人发布的技巧。 **但是，这通常是一个非常糟糕的主意。**

.Net 代码通常在比 javascript 浏览器沙箱更受信任的上下文中运行，并且可以访问更丰富的 API，因此可能具有破坏性。

相反，您使用 System.Addin 命名空间来为扩展、插件等提供非常严格的接口。如果您只是想使用更“流畅”或函数式编程环境，您可以使用 lamdba 表达式和闭包等有趣的功能在内部传递功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T00:00:18.193

使用 Microsoft 的 .NET 框架，这是可能的，但有点棘手。

C# 编译器是基本运行时的一部分，因此您可以编译内存中的程序集，并在其中即时执行代码。

这是一篇[很好的 MSDN 博客文章](http://blogs.msdn.com/digitalnetbizz/archive/2004/01/31/create-assembly-in-memory-and-run-it.aspx)，描述了基本过程。

我以前用它来为 C# 项目制作脚本引擎。通过一些工作来包装它，您可以使它非常易于使用。我从事的一个开源项目有一个专门用于此的项目： [Pluto.Scripting](http://trac.assembla.com/plugintoolkit/browser/trunk/Pluto.Scripting)

我们在那个项目中有示例和测试，展示了 C#、VB.NET 和 Boo 的动态编译和执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T01:00:15.117

你现在就可以做到。[ag DLR（Silverlight 动态语言运行时）](http://www.codeplex.com/sdlsdk)可以托管 javascript。

虽然 Javascript 不能在浏览器之外的 DLR 中托管，但 Ruby 和 Python 可以。这是一个使用[DLR](http://dlr.codeplex.com/Wiki/View.aspx?title=Docs%20and%20specs&referringTitle=Home)并托管一段 Python 代码进行演示的 C# 片段示例。

```
using IronPython.Hosting;

PythonEngine pythonEngine = new PythonEngine();
string script = @"import clr 
 clr.AddReference(""System.Windows.Forms"") 
 import System.Windows.Forms as WinForms 
 WinForms.MessageBox.Show(""Hello"", ""Hello World"")";
pythonEngine.Execute(script); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T00:16:01.200

如果你不介意[Boo](http://boo.codehaus.org/)，你可以使用它的[解释器](http://boo.codehaus.org/Scripting+with+the+Boo.Lang.Interpreter+API)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T01:48:36.373

实际上，我不断收到错误“意外缩进”，因此将代码更改为

```
PythonEngine pythonEngine = new PythonEngine();
            string script  = @"import clr; clr.AddReference(""System.Windows"");"; 
                   script += @"import System.Windows as Wins;";
                   script += @"Wins.MessageBox.Show(""Hello World"");";
            pythonEngine.Execute(script); 
```

工作！有趣...谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T02:19:30.263

为什么需要这个功能？您的代码不应该知道它的路径并包含该逻辑吗？如果你不能预见这样的用例——那么也许它就不需要了。唯一真正的好处是它打开了被滥用和攻击的机会。这听起来像是你直接创造了一个利用的潜力——这是一种耻辱，因为像 Java/CLR 这样的托管运行时不允许代码注入，但是你把所有的好处都带回来了......

# c++ - C++ 'new' 运算符的问题？

> ID：745850
> 
> 赞同：1
> 
> 时间：2009-04-13T23:59:39.787
> 
> 标签：c++, language-features, new-operator, allocation

我最近遇到了[这种咆哮](http://www.scs.stanford.edu/~dm/home/papers/c++-new.html)。

文章中提到的几点我不是很明白：

*   作者提到了`delete`vs的小烦恼`delete[]`，但似乎认为它实际上是必要的（对于编译器），但从未提供过解决方案。我错过了什么？
*   在“专用分配器”部分的功能`f()`中，似乎可以通过将分配替换为以下内容来解决问题：（省略对齐）

    ```
    // if you're going to the trouble to implement an entire Arena for memory,
    // making an arena_ptr won't be much work. basically the same as an auto_ptr,
    // except that it knows which arena to deallocate from when destructed.
    arena_ptr<char> string(a); string.allocate(80);
    // or: arena_ptr<char> string; string.allocate(a, 80);
    arena_ptr<int> intp(a); intp.allocate();
    // or: arena_ptr<int> intp; intp.allocate(a);
    arena_ptr<foo> fp(a); fp.allocate();
    // or: arena_ptr<foo>; fp.allocate(a);
    // use templates in 'arena.allocate(...)' to determine that foo has
    // a constructor which needs to be called. do something similar
    // for destructors in '~arena_ptr()'. 
    ```

*   在“重载 ::operator new[] 的危险”中，作者试图做一个`new(p) obj[10]`. 为什么不这样做（远不那么模棱两可）：

    ```
    obj *p = (obj *)special_malloc(sizeof(obj[10]));
    for(int i = 0; i < 10; ++i, ++p)
        new(p) obj; 
    ```

*   '调试 C++ 中的内存分配'。不能在这里争论。

整篇文章似乎都围绕在*自定义内存管理方案中具有**重要* *构造函数*和*析构函数*的类展开。虽然这可能很有用，而且我无法反驳，但它的共性非常有限。

 *基本上，我们有放置新的和按类分配器——这些方法不能解决哪些问题？

另外，如果我只是笨拙和疯狂，在**你**理想的 C++ 中，什么会代替`operator new`？必要时发明语法——什么是**理想**的，只是为了帮助我更好地理解这些问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T00:05:26.933

好吧，*理想*的情况可能是不需要任何形式的删除。有一个垃圾收集的环境，让程序员避开整个问题。

咆哮中的抱怨似乎归结为

1.  “我喜欢 malloc 的方式”
2.  “我不喜欢被迫显式创建已知类型的对象”

`new`他对您必须同时实现and的恼人事实是正确的`new[]`，但是由于 Stroustrups 维护 C 语义核心的愿望，您被迫这样做。由于您无法从数组中分辨出指针，因此您必须自己告诉编译器。你可以解决这个问题，但这样做意味着从根本上改变语言 C 部分的语义；你不能再使用身份

```
*(a+i) == a[i] 
```

这将破坏所有 C 代码的一个非常大的子集。

所以，你可以有一种语言

*   实现了一个更复杂的数组概念，并消除了指针算术的奇迹，用涂料向量或类似的东西实现数组。

*   被垃圾收集，所以你不需要自己的`delete`纪律。

也就是说，你可以下载Java。然后，您可以通过更改语言来扩展它

*   不是强类型的，因此`void *`消除了向上转换的类型检查，

...但这意味着您可以编写将 Foo 转换为 Bar 的代码，而编译器不会看到它。如果需要，这也将启用鸭式打字。

问题是，一旦你完成了这些事情，你就拥有了具有 C-ish 语法的 Python 或 Ruby。

自从 Stroustrup 发出 cfront 1.0 磁带以来，我一直在编写 C++；C++ 所涉及的许多历史都源于对拥有一种适合 C 世界的 OO 语言的渴望。大约在同一时间出现了许多其他更令人满意的语言，例如 Eiffel。C++ 似乎赢了。我怀疑它赢了*是因为*它可以融入 C 世界。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T11:02:52.197

恕我直言，咆哮非常具有误导性，在我看来，作者确实了解更详细的细节，只是他似乎想误导。恕我直言，显示论点缺陷的关键点如下：

```
void* operator new(std::size_t size, void* ptr) throw(); 
```

该标准定义上述函数具有以下属性：

> **返回**：ptr。
> 
> **注意**： 有意不执行其他操作。

重申一下 - 此函数**有意不执行其他操作**。这非常重要，因为它是放置 new 的关键：它用于调用对象的构造函数，仅此而已。请明确注意，甚至没有提到*size*参数。

对于那些没有时间的人，总结一下我的观点：'malloc' 在 C 中所做的一切都可以在 C++ 中使用 "::operator new" 完成。唯一的区别是，如果您有非聚合类型，即。需要调用其析构函数和构造函数的类型，那么您需要调用这些构造函数和析构函数。此类类型在 C 中不明确存在，因此使用“malloc 做得更好”的论点是无效的。如果你在“C”中有一个结构，它有一个特殊的“initializeMe”函数，必须用相应的“destroyMe”调用，那么作者提出的所有观点同样适用于该结构，就像它们适用于非聚合 C++ 结构一样。

明确提出他的一些观点：

> 要实现多重继承，编译器必须在某些强制转换期间实际更改指针的值。当转换为 void * 时，它无法知道您最终想要哪个值......因此，没有一个普通函数可以在 C++ 中扮演 malloc 的角色——没有合适的返回类型。

这是不正确的，再次*::operator new*执行*malloc*的角色：

```
class A1 { };
class A2 { };
class B : public A1, public A2 { };

void foo () {
    void * v = ::operator new (sizeof (B));
    B * b = new (v) B();  // Placement new calls the constructor for B.
    delete v;

    v = ::operator new (sizeof(int));
    int * i = reinterpret_cast <int*> (v);
    delete v'
} 
```

正如我上面提到的，我们需要placement new 来调用B 的构造函数。在'i' 的情况下，我们可以毫无问题地从*void**转换为*int* ，尽管再次使用placement new 会改进类型检查。*

他提出的另一点是关于对齐要求：

> new char[...] 返回的内存不一定满足结构 intlist 的对齐要求。

3.7.3.1/2 下的标准说：

> 返回的指针应适当对齐，以便它可以转换为任何完整对象类型的指针，然后用于访问已分配存储中的对象或数组（直到通过调用相应的释放函数显式释放存储） .

这对我来说似乎很清楚。

在专门的分配器下，作者描述了您可能遇到的潜在问题，例如。您需要将分配器用作任何自行分配内存的类型的参数，并且构造的对象将需要显式调用其析构函数。同样，这与将分配器对象传递给 C 结构的“initializeMe”调用有何不同？

关于调用析构函数，在 C++ 中，您可以轻松创建一种特殊类型的智能指针，我们称之为“placement_pointer”，我们可以定义它以在析构函数超出范围时显式调用它。结果，我们可以：

```
template <typename T>
class placement_pointer {
  // ...
  ~placement_pointer() {
    if (*count == 0) {
      m_b->~T();
    }
  }
  // ...
  T * m_b;
};

void
f ()
{
  arena a;

  // ...
  foo *fp = new (a) foo;           // must be destroyed
  // ...
  fp->~foo ();

  placement_pointer<foo> pfp = new (a) foo; // automatically !!destructed!!
  // ...
} 
```

我要评论的最后一点是：

> g++ 带有一个“放置”操作符 new[]，定义如下：

```
inline void *
operator new[](size_t, void *place)
{
  return place;
} 
```

如上所述，不仅以这种方式实现 - 而且标准要求如此。

> 设 obj 是一个带有析构函数的类。假设您在某处有 sizeof (obj[10]) 字节的内存，并希望在该位置构造 10 个 obj 类型的对象。（C++ 将 sizeof (obj[10]) 定义为 10 * sizeof (obj)。）你能用这个放置操作符 new[] 做到这一点吗？例如，以下代码似乎会这样做：

```
obj *
f ()
{
  void *p = special_malloc (sizeof (obj[10]));
  return new (p) obj[10];       // Serious trouble...
} 
```

> 不幸的是，这段代码不正确。通常，不能保证传递给 operator new[] 的 size_t 参数确实对应于正在分配的数组的大小。

但正如他通过提供定义强调的那样，分配函数中没有使用 size 参数。分配函数**什么都不**做——所以上述放置表达式的唯一影响是调用 10 个数组元素的构造函数，正如您所期望的那样。

此代码还有其他问题，但不是作者列出的问题。

# refactoring - 你觉得圈复杂度是一个有用的衡量标准吗？

> ID：745857
> 
> 赞同：56
> 
> 时间：2009-04-14T00:02:02.247
> 
> 标签：refactoring, metrics, code-metrics, cyclomatic-complexity

我一直在尝试测量大型代码库的圈复杂度。

圈复杂度是通过程序源代码的线性独立路径的数量，并且有许多免费工具可供您选择的语言。

结果很有趣，但并不令人惊讶。也就是说，我知道最毛茸茸的部分实际上是最复杂的（评分> 50）。但是我发现有用的是每个方法都分配了一个具体的“坏”数字，作为我在决定从哪里开始重构时可以指出的东西。

你使用圈复杂度吗？你发现的最复杂的代码是什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-14T00:13:56.617

我们毫不留情地重构，并使用圈复杂度作为衡量我们“命中列表”代码的指标之一。1-6 我们不会标记复杂性（尽管它可能会因其他原因受到质疑），7-9 是有问题的，除非另有证明，否则任何超过 10 的方法都被认为是不好的。

我们见过的最糟糕的是 87 来自我们不得不接管的一些遗留代码中的一个巨大的 if-else-if 链。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-28T07:00:44.233

实际上，圈复杂度可以在方法级别阈值之外使用。对于初学者来说，一个复杂度高的大方法可能会分解成几个复杂度较低的小方法。但它真的改进了代码库吗？当然，通过所有这些方法名称，您可能会获得更好的可读性。但总的条件逻辑并没有改变。并且通常可以通过[用多态替换条件](http://docs.google.com/Present?docid=d449gch_62ckrb4zgj)来减少总的条件逻辑。

我们需要一个不会仅仅通过方法分解而变绿的指标。我称之为[CC100](http://blog.sriramnarayan.com/2006/05/using-cyclomatic-complexity.html)。

CC100 = 100 *（代码库的总圈复杂度）/（代码总行数）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-14T01:00:08.533

它对我的用处与 big-O 的用处相同：我知道它是什么，并且可以使用它来直觉地判断一种方法是好是坏，但我不需要为每个方法都计算它我写的函数。

我认为在大多数情况下，更简单的指标，如 LOC，至少同样好。如果一个功能不能在一个屏幕上显示，那么它的简单程度几乎无关紧要。如果一个函数接受 20 个参数并产生 40 个局部变量，那么它的圈复杂度是否为 1 无关紧要。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-14T00:42:26.173

直到有一个工具可以很好地与 C++ 模板和元编程技术一起工作，它对我的​​情况没有多大帮助。无论如何只要记住这一点

> “不是所有可以测量的东西都可以测量，也不是所有可以测量的东西都可以测量”爱因斯坦

因此，请记住也要通过人工过滤传递任何此类信息。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-14T00:06:29.787

我们最近开始使用它。我们使用 NDepend 做一些静态代码分析，它测量圈复杂度。我同意，这是一种识别重构方法的好方法。

可悲的是，我们已经看到我们的开发人员在海外创建的一些方法的 # 超过 200。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-14T01:05:32.047

当你看到它时，你就会知道复杂性。这种工具的主要用途是标记代码中没有引起您注意的部分。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-14T01:02:32.787

我经常测量我的代码的圈复杂度。我发现它可以帮助我发现做得太多的代码区域。使用工具指出我的代码中的热点比阅读数千行代码试图找出哪些方法不遵循 SRP 所花费的时间要少得多。

然而，我发现当我对其他人的代码进行圈复杂度分析时，当我发现圈复杂度在 100 的代码时，通常会导致沮丧、焦虑和普遍愤怒的感觉。是什么迫使人们编写包含数千行代码的方法？！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-14T01:12:22.063

这对于帮助确定重构的候选者很有帮助，但保持你的判断力很重要。我支持 kenj0418 的修剪指南范围。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-14T00:52:49.877

[有一个称为CRAP4J](http://www.crap4j.org)的 Java 度量标准，它根据经验结合了圈复杂度和 JUnit 测试覆盖率来提出一个单一的度量标准。他一直在做研究，试图改进他的经验公式。我不确定它有多普遍。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-09-09T10:51:50.277

是的，我们使用它，我发现它也很有用。我们有一个庞大的遗留代码库要驯服，我们发现了惊人的高圈复杂度。（一种方法中有 387 个！）。CC 将您直接指向值得重构的领域。我们在 C++ 代码上使用 CCCC。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-08-28T08:56:44.763

圈复杂度只是所谓的制造复杂度的一种组合。前段时间，我写了一篇文章总结了代码复杂度的几个维度： [Fighting Fabricated Complexity](http://codebetter.com/blogs/patricksmacchia/archive/2009/06/28/fighting-fabricated-complexity.aspx)

需要工具来有效地处理代码复杂性。用于 .NET 代码的工具[NDepend](http://www.NDepend.com)将让您分析代码复杂性的许多方面，包括代码指标，例如：圈复杂性、嵌套深度、方法缺乏凝聚力、测试覆盖率......

包括依赖分析和包括一种语言（[代码查询语言](http://www.ndepend.com/Features.aspx#CQL)）专门用来问，我的代码中有什么复杂的，以及编写规则？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-14T00:07:11.827

我有一段时间没有使用它了，但是在之前的项目中，它确实有助于识别其他人代码中的潜在问题（当然不是我的！）

在找到要检查的区域后，我很快发现了许多逻辑问题（你相信还有很多 GOTOS！）和一些非常奇怪的 WTF 代码。

圈复杂度非常适合显示可能正在做很多事情并因此打破单一责任主体的领域。理想情况下，这些应该分解为多个功能

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-14T00:15:10.000

恐怕对于我最想要像这样的指标的项目语言[LPC](http://en.wikipedia.org/wiki/LPC_(programming_language))，实际上并没有很多免费的工具可以用来生成它。所以不，对我没那么有用。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-26T18:19:34.450

+1 为 kenj0418 的命中列表值。

我见过的最差的是 275。还有几个超过 200 的 CC，我们可以重构为更小的 CC；他们仍然很高，但这让他们更进一步。我们对 275 野兽的运气并不好——它（可能仍然是）一个过于复杂的 if 和 switch 语句网络。当他们决定重建系统时，唯一真正的价值是作为一个步骤。

我对高 CC 感到满意的例外是工厂。IMO，它们应该具有较高的 CC，但前提是它们仅进行简单的对象创建和返回。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-06-09T09:39:38.557

在[了解](https://stackoverflow.com/questions/911637/)了它的含义之后，我现在已经开始在“试用”的基础上使用它。[到目前为止，我发现它很有用，因为通常高 CC 与Arrow Anti-Pattern](http://www.codinghorror.com/blog/archives/000486.html)齐头并进，这使得代码更难阅读和理解。我还没有一个固定的数字，但是 NDepend 会提醒所有高于 5 的东西，这看起来是研究方法的一个好的开始。

# objective-c - 如何从可可 iPhone sax xml 解析例程中提取数据

> ID：745863
> 
> 赞同：1
> 
> 时间：2009-04-14T00:05:52.283
> 
> 标签：objective-c, xml, cocoa-touch, parsing, sax

我正在尝试在 iPhone 应用程序中读取和解析 xml 文档。我开始解析，然后使用覆盖方法：

```
 static void startElementSAX(void *ctx, const xmlChar *localname, const xmlChar *prefix, const xmlChar *URI, 
                        int nb_namespaces, const xmlChar **namespaces, int nb_attributes, int nb_defaulted, const xmlChar **attributes) 
```

然后我尝试将属性转换为字符串：

```
 NSString *str1 = [[NSString alloc] initWithCString:attributes encoding:NSUTF8StringEncoding]; 
```

为什么attributes参数前面有两个**。以及为什么在尝试使用上述代码提取数据并将其转换为字符串时会收到警告：

从不兼容的指针类型传递 'initWithCString:encoding:' 的参数 1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T01:51:08.317

libxml 的[起始元素回调](http://www.xmlsoft.org/html/libxml-SAX2.html#xmlSAX2StartElementNs)的文档指出，该指针指向一个数组，该数组为每个属性保存 5 个值（属性的数量在 nb_attributes 中返回）。这意味着数组中的每 5 个值都是一个新的属性项。

每个属性的五个项目是：

1.  localname（属性的名称）
2.  前缀（属性的命名空间）
3.  URI
4.  [start of] value（指向值的 xmlChar 字符串开头的指针）
5.  end [of value]（指向值的 xmlChar 字符串结尾的指针）

所以你需要遍历数组，从第一个属性的项中取出每个值，然后使用起始值指针来获取长度 = 结束 - 开始的 xmlChar 字符串。然后从下一个属性重新开始，直到你读到 nb_attributes 值。

如果这让您头疼，那么我强烈建议您切换到 Apple 的[NSXMLParser](http://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)（链接可能需要登录，或使用此链接[NSXMLParser](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)）。在这种情况下，您将获得属性作为 NSDictionary。要从中获取所有属性，您可以执行以下操作：

```
for (NSString *attributeName in [attributeDict allKeys]) {
    NSString *attributeValue = [attributeDict objectForKey:attributeName];
    // do something here with attributeName and attributeValue
} 
```

如果您有权访问 iPhone 开发人员站点，请查看示例[SeismicXML](https://developer.apple.com/iphone/library/samplecode/SeismicXML/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T18:21:07.997

接受的答案解释是正确的，但查看一些示例代码也很有帮助。这只是从属性中提取值的一种方法，至少在我测试它时它是有效的。不过，我离成为 C 大师还差得很远。

```
for (int i = 0; i < nb_attributes; i += 5) {
    const char *attr = (const char *)attributes[i];
    const char *begin = (const char *)attributes[i + 3];
    const char *end = (const char *)attributes[i + 4];
    int vlen = strlen(begin) - strlen(end);
    char val[vlen + 1];
    strncpy(val, begin, vlen);
    val[vlen] = '\0';
    NSLog(@"attribute %s: %d = %s", attr, i, val);
} 
```

NSXMLParser 很好，但据我所知，它会在处理之前下载整个 XML。使用 libxml 它可以一次读取块。它允许更大的灵活性，但更高的学习曲线。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-08T06:43:46.500

该示例很棒，除了两件事：

*   您需要在每个循环之后将“i”增加 5，因为每个属性有 5 个项目。
*   在开始和结束时都执行 strlen() 很昂贵；简单地从结尾减去开始更容易

```
 for (int i = 0; i < nb_attributes*5; i += 5) 
{
    const char *attr = (const char *)attributes[i];
    const char *begin = (const char *)attributes[i + 3];
    const char *end = (const char *)attributes[i + 4];
    int vlen = end - begin;
    char val[vlen + 1];
    strncpy(val, begin, vlen);
    val[vlen] = '\0';
    NSLog(@"attribute %s = '%s'", attr, val);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T00:30:33.363

该`'**'`符号的意思是“指向指针的指针”。在 C/C++ 中，“字符串”由字符数组表示。数组实际上只是一个指针，因此 C/C++ 中的字符串实际上可以声明为“char[]”或“char*”。[] 符号编译为指向数组的指针。

一个常见的例子是 C/C++ 中典型的“main”函数：

```
int main(int argc, char **argv) 
```

这相当于：

```
int main(int argc, char *argv[]) 
```

argv 是一个 char*“字符串”数组（程序的命令行参数）。

我目前无法提供示例，但看起来您需要遍历属性才能访问各个字符串。例如，attributes[0] 将是第一个属性字符串（一个 xmlChar*）。您应该能够将每个单独的属性转换为 NSString。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T02:04:06.400

`const xmlChar **namespaces`是一个 CStrings 数组（`int nb_namespaces`告诉你有多少）。如果您希望每个命名空间都作为 NSString，您可以执行以下操作：

```
NSMutableArray *namespaces = [[NSMutableArray alloc] init];

int i;
for (i = 0; i < nb_namespaces; i++) {
    NSString *namespace = [[NSString alloc] initWithCString:attributes[i] encoding:NSUTF8StringEncoding];
    [namespaces addObject:namespace];
} 
```

该`initWithCString`方法是 expecting `xmlChar *`，它是一个**指向 xmlChar**（CString 中的第一个字符）的指针。

`xmlChar **`表示**指向**xmlChar 的指针（第一个CString中的**第一个字符）的指针。**

# c - C99 'restrict' 关键字的实际用法？

> ID：745870
> 
> 赞同：212
> 
> 时间：2009-04-14T00:09:53.303
> 
> 标签：c, gcc, c99, restrict-qualifier

我正在浏览一些文档和问题/答案，并看到它被提及。我阅读了一个简短的描述，指出这基本上是程序员的一个承诺，即指针不会用于指向其他地方。

任何人都可以提供一些实际使用它的实际案例吗？

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2009-04-14T00:16:26.267

`restrict`表示指针是唯一访问底层对象的东西。它消除了指针别名的可能性，使编译器能够更好地优化。

例如，假设我有一台带有专门指令的机器，可以将内存中的数字向量相乘，并且我有以下代码：

```
void MultiplyArrays(int* dest, int* src1, int* src2, int n)
{
    for(int i = 0; i < n; i++)
    {
        dest[i] = src1[i]*src2[i];
    }
} 
```

编译器需要正确处理 if `dest`、`src1`和`src2`重叠，这意味着它必须从头到尾一次执行一次乘法。通过具有`restrict`，编译器可以使用向量指令自由优化此代码。

维基百科有一个条目`restrict`，还有另一个例子，[这里](http://en.wikipedia.org/wiki/Restrict)。

* * *

## 回答 #2

> 赞同：183
> 
> 时间：2015-06-14T08:24:43.613

维基[百科的例子](https://en.wikipedia.org/wiki/Restrict)很有启发*性。*

它清楚地显示了**它如何允许保存一条汇编指令**。

无限制：

```
void f(int *a, int *b, int *x) {
  *a += *x;
  *b += *x;
} 
```

伪组装：

```
load R1 ← *x    ; Load the value of x pointer
load R2 ← *a    ; Load the value of a pointer
add R2 += R1    ; Perform Addition
set R2 → *a     ; Update the value of a pointer
; Similarly for b, note that x is loaded twice,
; because x may point to a (a aliased by x) thus 
; the value of x will change when the value of a
; changes.
load R1 ← *x
load R2 ← *b
add R2 += R1
set R2 → *b 
```

有限制：

```
void fr(int *restrict a, int *restrict b, int *restrict x); 
```

伪组装：

```
load R1 ← *x
load R2 ← *a
add R2 += R1
set R2 → *a
; Note that x is not reloaded,
; because the compiler knows it is unchanged
; "load R1 ← *x" is no longer needed.
load R2 ← *b
add R2 += R1
set R2 → *b 
```

**海湾合作委员会真的做到了吗？**

GCC 4.8 Linux x86-64：

```
gcc -g -std=c99 -O0 -c main.c
objdump -S main.o 
```

与`-O0`，它们是相同的。

与`-O3`：

```
void f(int *a, int *b, int *x) {
    *a += *x;
   0:   8b 02                   mov    (%rdx),%eax
   2:   01 07                   add    %eax,(%rdi)
    *b += *x;
   4:   8b 02                   mov    (%rdx),%eax
   6:   01 06                   add    %eax,(%rsi)  

void fr(int *restrict a, int *restrict b, int *restrict x) {
    *a += *x;
  10:   8b 02                   mov    (%rdx),%eax
  12:   01 07                   add    %eax,(%rdi)
    *b += *x;
  14:   01 06                   add    %eax,(%rsi) 
```

对于初学者，[调用约定](https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI)是：

*   `rdi`= 第一个参数
*   `rsi`= 第二个参数
*   `rdx`= 第三个参数

GCC 输出比 wiki 文章更清晰：4 条指令与 3 条指令。

**数组**

到目前为止，我们节省了单条指令，但是如果指针表示要循环的数组，这是一个常见的用例，那么可以节省一堆指令，如[supercat](https://stackoverflow.com/questions/745870/realistic-usage-of-the-c99-restrict-keyword/30827311?noredirect=1#comment59424338_30827311)所述。

考虑例如：

```
void f(char *restrict p1, char *restrict p2) {
    for (int i = 0; i < 50; i++) {
        p1[i] = 4;
        p2[i] = 9;
    }
} 
```

因为`restrict`，智能编译器（或人类）可以将其优化为：

```
memset(p1, 4, 50);
memset(p2, 9, 50); 
```

这可能效率更高，因为它可能在体面的 libc 实现（如 glibc）上进行了汇编优化：[就性能而言，使用 std::memcpy() 还是 std::copy() 更好？](https://stackoverflow.com/questions/4707012/c-memcpy-vs-stdcopy)

**海湾合作委员会真的做到了吗？**

GCC 5.2.1.Linux x86-64 Ubuntu 15.10：

```
gcc -g -std=c99 -O0 -c main.c
objdump -dr main.o 
```

，`-O0`两者是一样的。

与`-O3`：

*   有限制：

    ```
    3f0:   48 85 d2                test   %rdx,%rdx
    3f3:   74 33                   je     428 <fr+0x38>
    3f5:   55                      push   %rbp
    3f6:   53                      push   %rbx
    3f7:   48 89 f5                mov    %rsi,%rbp
    3fa:   be 04 00 00 00          mov    $0x4,%esi
    3ff:   48 89 d3                mov    %rdx,%rbx
    402:   48 83 ec 08             sub    $0x8,%rsp
    406:   e8 00 00 00 00          callq  40b <fr+0x1b>
                            407: R_X86_64_PC32      memset-0x4
    40b:   48 83 c4 08             add    $0x8,%rsp
    40f:   48 89 da                mov    %rbx,%rdx
    412:   48 89 ef                mov    %rbp,%rdi
    415:   5b                      pop    %rbx
    416:   5d                      pop    %rbp
    417:   be 09 00 00 00          mov    $0x9,%esi
    41c:   e9 00 00 00 00          jmpq   421 <fr+0x31>
                            41d: R_X86_64_PC32      memset-0x4
    421:   0f 1f 80 00 00 00 00    nopl   0x0(%rax)
    428:   f3 c3                   repz retq 
    ```

    两个`memset`电话符合预期。

*   没有限制：没有 stdlib 调用，只有 16 次迭代宽[循环展开](https://en.wikipedia.org/wiki/Loop_unrolling)，我不打算在这里重现 :-)

我没有耐心对它们进行基准测试，但我相信限制版本会更快。

**C99**

为了完整起见，让我们看一下标准。

`restrict`表示两个指针不能指向重叠的内存区域。最常见的用法是用于函数参数。

这限制了函数的调用方式，但允许更多的编译时优化。

如果调用者不遵守`restrict`合同，未定义的行为。

[C99 N1256 草案](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)6.7.3 /7“类型限定符”说：

> 限制限定符（如寄存器存储类）的预期用途是促进优化，并且从构成符合程序的所有预处理翻译单元中删除限定符的所有实例不会改变其含义（即，可观察的行为）。

和 6.7.3.1 “限制的正式定义”给出了血淋淋的细节。

**严格的别名规则**

该`restrict`关键字仅影响兼容类型的指针（例如 two `int*`），因为严格的别名规则表明别名不兼容类型默认情况下是未定义的行为，因此编译器可以假设它不会发生并优化掉。

请参阅：[什么是严格的别名规则？](https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule)

**也可以看看**

*   C++14 还没有类似 for `restrict`，但 GCC 有`__restrict__`一个扩展：[C++ 中的 restrict 关键字是什么意思？](https://stackoverflow.com/questions/776283/what-does-the-restrict-keyword-mean-in-c)
*   很多问题问：根据血淋淋的细节，这个代码是UB吗？
    *   [通过示例了解限制限定符](https://stackoverflow.com/questions/12255686/understanding-restrict-qualifier-by-examples?rq=1)
    *   [受限指针问题](https://stackoverflow.com/questions/3800940/restricted-pointer-questions?rq=1)
    *   [将受限指针分配给另一个指针，并使用第二个指针修改值是否合法？](https://stackoverflow.com/questions/26567078/usage-of-restrict-keyword?rq=1)
*   一个“何时使用”的问题：[何时使用限制，何时不使用](https://stackoverflow.com/questions/832964/when-to-use-restrict-and-when-not-to?rq=1)
*   相关的 GCC `__attribute__((malloc))`，它表示函数的返回值没有任何别名：[GCC: __attribute__((malloc))](https://stackoverflow.com/questions/18485447/gcc-attribute-malloc)

# javascript - jQuery儿童选择器问题

> ID：745874
> 
> 赞同：4
> 
> 时间：2009-04-14T00:14:05.180
> 
> 标签：javascript, jquery

我有以下代码：

```
$("#Table1 tbody").children().each(function(e){
$(this).bind('click', 
            function(){
                // Do something here
            }, 
            false) 
}); 
```

Table1 html 表有 2 列；一个用于名称，一个用于`<button>`元素。

当我单击表格行时，它工作正常。当我点击按钮时，按钮代码会触发；但是，行代码也是如此。

如何过滤选择器以使按钮不会触发父元素的单击事件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-14T00:49:11.853

这就是你想要的。

是[stopPropogation](http://docs.jquery.com/Events/jQuery.Event#event.stopPropagation.28.29)将阻止父母。

```
<table>
  <tr>
    <td>The TD: <input type="button" id="anotherThing" value="dothis"></td>
  </tr>
</table>

<div id="results">
  Results:
</div>

<script>

  $(function() {
    $('#anotherThing').click(function(event) {
       $('#results').append('button clicked<br>');
       event.stopPropagation();       
    });
    $('td').click(function() {
       $('#results').append('td clicked<br>');

    });
  });

</script> 
```

这是一个链接到它的工作示例：

[http://jsbin.com/uyuwi](http://jsbin.com/uyuwi)

你可以修改它：http: [//jsbin.com/uyuwi/edit](http://jsbin.com/uyuwi/edit)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T01:21:37.907

你也可以这样做：

```
$('#Table1 tr').bind('click', function(ev) {
  return rowClick($(this), ev);
}); //Bind the tr click
$('#Table1 input').bind('click', function(ev) {
  return buttonClick($(this), ev);
}) //Bind the button clicks

function rowClick(item, ev) {
  alert(item.attr('id'));
  return true;
}

function buttonClick(item, ev) {
  alert(item.attr('id'));
  ev.stopPropagation();

  return true;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<table id="Table1">
  <tbody>
    <tr id="tr1">
      <td>
        The TD: <input type="button" id="button1" value="dothis" />
      </td>
    </tr>
    <tr id="tr2">
      <td>
        The TD: <input type="button" id="Button2" value="dothis" />
      </td>
    </tr>
  </tbody>
</table>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T00:17:45.173

是否可以删除按钮代码并只运行行代码，因此有点使用事件冒泡。

其他几个选项：

*   你能在 TD 里面和选择器中添加一个类吗？`'[class!="className"]'`
*   也许试试`event.preventDefault()`。你可以看到它在[这里被使用](http://docs.jquery.com/Tutorials:How_jQuery_Works#Launching_Code_on_Document_Ready)。这样，您可以防止单击按钮时触发的默认操作，尽管我不确定它是否会完全防止冒泡。

# c++ - 引用和指针的区别

> ID：745878
> 
> 赞同：9
> 
> 时间：2009-04-14T00:16:28.530
> 
> 标签：c++, pointers, reference

> **可能重复：**
> [C++ 中的指针变量和引用变量有什么区别？](https://stackoverflow.com/questions/57483/what-are-the-differences-between-pointer-variable-and-reference-variable-in-c)

C++ 中的 Class& 是什么意思，它与 Class* 有何不同？

```
Class& foo;
Class* foo; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-14T00:19:37.507

& 版本表示引用，而 * 版本表示指针。对于典型的 SO 帖子而言，差异太大了。我建议你从 C++ FAQ lite 开始

[http://www.parashift.com/c++-faq-lite/references.html](http://www.parashift.com/c++-faq-lite/references.html)

我通常不喜欢用“你应该使用谷歌”的答案来回答帖子。但是，这是我强烈建议您使用谷歌的一个主题。特别是谷歌“c++ 指针与引用”。关于这个主题有大量的可用信息，这些页面上的讨论将胜过我们在这里写的任何内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T00:27:32.700

* 是指针，& 是引用。两者之间的区别在于指针是必须取消引用的内存区域，例如。通过 -> 运算符，以便作为类实例被“看到”。引用是一个“别名”，只是同一类实例的替代名称。您不需要将 -> 运算符与引用一起使用。您使用点运算符。

就个人而言，我很少使用引用，主要是当我有一个在堆栈上分配的值对象时。new 运算符始终返回一个指针，然后您必须取消引用该指针。此外，引用的最大问题之一是您不能将它们设置为 NULL。在某些情况下，拥有一个接受对象指针或 NULL 的函数会很方便。如果您的函数接受引用，则不能传递 NULL（但是，您可以使用 Null 对象模式）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-14T00:24:19.290

Class * 可以指向*任何*类对象，或者没有。

一个 Class & 总是指向*一个*类对象，并且永远不能指向不同的对象。

此外，我相信 Bjarne 是声称“C 中的数组已损坏无法修复”的那群人中的一员，一个 Class * 可以指向整个 ding-dang类对象*数组*，在内存中一个接一个地排列，并且在 C 中绝对没有办法判断 Class * 是指向一个还是多个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T09:27:22.830

引用 (&) 与指针 (*) 相同，只是 C++ 编译器确保它不为 NULL。但是，它仍然可以是一个悬空指针（一个没有引用的指针变量，因此它是垃圾并且对任何使用都无效）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T09:37:19.843

如前所述，您应该使用谷歌搜索，但为了避免误解：

*   引用不是变量
*   引用与指针不同（但您可以以类似的方式使用它们）

将参考视为分配给它的术语的快捷方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T00:17:22.957

我要提供的另一个提示如下：

尽可能使用参考，必要时使用指针。如果保证对象存在，您可能应该使用引用。如果不是，那么您可能必须使用指针。

另一个优点是引用消除了所有权的歧义。一旦维护程序员看到一个指针，他们就会开始怀疑是否应该删除它。

看看这个例子：

```
// 使用引用的包装类，因为被包装的对象始终存在
类包装器
{
上市：
  // 如果保证被包装在创建时就存在，这样做
  Wrapper(Wrapped& Wrapped):_wrapped(wrapped) { /* 空 */ }

  // 在这里放置额外的方法。
  int getWrappedValue() const { return _wrapped.getValue(); }

私人的：
  包裹& _包裹; // 这个对象一直存在并且有效
};

// 为支持可能不存在的包装对象而编写的包装类。
类包装器
{
上市：
  Wrapper(Wrapped* Wrapped = 0):_wrapped(wrapped) { /* 空 */

  无效 setWrappee(WRappee* 包裹) { _wrapped = 包裹; }

  int getWrappedValue() 常量；// 不做内联——更复杂

私人的：
  包裹* _包裹；// 使用前总是检查指针
};

int Wrapper::getWrappedValue() 常量
{
  如果（_wrapped）
  {
    返回 _wrapped->getValue();
  }
  别的
  {
    返回-1；// 注意，这是一个人为的例子——没有进入异常
  }
}

```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T00:55:30.550

另一个区别是必须初始化引用变量。您不能像示例代码中显示的那样创建引用变量。那会产生编译器错误。

# apache-flex - 在 Actionscript/Flex 中动态加载 CSS

> ID：745882
> 
> 赞同：0
> 
> 时间：2009-04-14T00:17:53.457
> 
> 标签：apache-flex, actionscript-3, mxml

**问题定义：**能够在运行时动态加载 CSS 以对 Flex 应用程序进行皮肤。

**更多信息：**我发现加载和应用 CSS 就像使用“mx:style source=".​​./assets/default.css"”一样简单。但我想做的是更像（伪代码）：

```
If (condition == 1)<br />
  mx:style source="../assets/style1.css"<br />
ElseIf (condition == 2)<br />
  mx:style source="../assets/style2.css"<br />
Else<br />
  mx:style source="../assets/default.css"<br /> 
```

我已经开始研究 StyleManager 类，但想知道是否有更简单的实现。

**要求：**我希望有一些简单的东西，比如将 .css 文件放到 /assets 文件夹中，而不需要 CSS->SWF 编译或类似的复杂东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T01:32:33.620

使用样式标记，您基本上只是内联样式表。据我所知，没有办法完全完成你希望做的事情。同时，您最好按照预期的方式执行此操作，使用 CSS 到 SWF 编译。这实际上并没有增加太多复杂性。您只需在将 .css 放入 /assets 并将其添加到条件中之间添加一个步骤。

有关更多信息，请参阅本文：http: [//onflash.org/ted/2007/01/flex-201-understand-runtime-css.php](http://onflash.org/ted/2007/01/flex-201-understand-runtime-css.php)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-24T19:45:49.053

这是一个链接，展示了如何在运行时将 css 加载到 actionscript 中。我将它用于 Flex 项目： [http ://www.developphp.com/view.php?tid=129](http://www.developphp.com/view.php?tid=129)

# iphone - 如何在 Xcode 中杀死循环？

> ID：745886
> 
> 赞同：1
> 
> 时间：2009-04-14T00:20:09.583
> 
> 标签：iphone, loops

我一直在 Xcode 中编写/调试，并且时不时地我不小心创建了一个我无法停止的循环。Unpasuing 调试和重建（和 Go-ing）没有帮助，我在普通 CLI 上使用的任何普通 Ctrl-C 东西也没有帮助。唯一能解决问题的就是退出 Xcode。

奇怪的问题，我知道，但是有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T00:40:10.937

如果你在模拟器中运行，你可以退出模拟器。

XCode 不会执行您的 iPhone 代码，它会将其安装在运行它的模拟器中。或者它将它安装在运行它的设备上。

我认为模拟器运行时有一个红色的大按钮会杀死它。您根本不必因为这样的事情而退出 XCode。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T00:34:43.087

使用“活动监视器”杀死正在运行的应用程序。奇迹般有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T08:15:17.210

如果您正在打电话，请按住主页键。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-14T00:34:41.810

您可以尝试`kill -9 <pid>`从命令行执行“”。您只需要使用“ `ps -ef`”找出进程 ID。

# rest - 得墨忒耳法则与 REST

> ID：745887
> 
> 赞同：6
> 
> 时间：2009-04-14T00:21:15.680
> 
> 标签：rest, law-of-demeter

得墨忒耳法则（真的应该是得墨忒耳的建议）说你不应该“穿过”一个物体去接触他们的子物体。如果您作为客户需要执行一些重要的操作，那么大多数时候您正在使用的域模型应该支持该操作。

REST 原则上是一个愚蠢的对象层次结构。它就像一个资源/对象的文件系统，其中每个对象都可以有子对象。您几乎总是可以使用 REST。您可以选择使用 REST 技术构建按约定的复合对象类型，只要提供者和客户端就更高级别的操作达成一致，您就可以避免通过。

那么，你如何平衡 REST 和 Demeter？在我看来，它们并不冲突，因为 REST 完全是关于超松散耦合，以至于提供者试图预测客户的所有需求是毫无意义的，而 Demeter 假设逻辑可以迁移到它的通过重构最自然的地方。

但是，您可能会争辩说，在您更好地了解您的客户之前，REST 只是一个权宜之计。REST 只是一个技巧吗？Demeter 在任何服务器/客户端场景中都不现实吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T00:26:30.317

*   Demeter 在任何服务器/客户端场景中都不现实吗？

我想你在这里回答了你自己的问题。这种方式`REST`与`SOAP`或`XML-RPC`在这方面有何不同？

重点`REST`不是提供超松耦合，而是提供以下内容：

*   提供准确描述所请求资源的标识符。
*   提供符合预期的服务`GET`请求是幂等的，`PUT`更新记录，`POST`创建，`DELETE`删除
*   最小化存储在服务器上的状态
*   消除不必要的复杂性

有些情况`REST`不是最好的答案，但`REST`总的来说效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T00:27:15.463

我不介意该法律/建议。它破坏了聚合和组合的一半好处，我不会拥有它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T03:32:59.773

由 RESTful 接口公开的表示提供的链接可以是完全不透明的，而不会违反 REST 的任何约束。因此，我建议 REST 完全符合得墨忒耳法则。不要求链接在其 URL 中公开 URL 空间的结构。

例如，在面向对象的场景中，您可以将调用 abc 替换为 a.bc

在 RESTful 表示中，您可以创建以下内容：

```
<a>
  <link href="bc"/>
</a> 
```

而不是做

```
GET a

    <a>
      <link href="b"/>
    </a>

GET b

    <b>
      <link href="c"/>
    </b>

GET c 
```

我不得不不同意 altCognito 并说 REST 的主要目标之一是松散耦合。统一的接口、标准的媒体类型和 HATEOAS 都结合在一起产生了一个极其松散耦合的接口。

回应大卫的评论：

> REST is all about super-loose coupling to the point where it is pointless for the provider to try to anticipate all the needs of the clients

Actually, REST is about limiting the clients options by providing only valid links in the representations. Within those constraints the client can attempt to satisfy its own needs. It is by removing the knowledge from the client of when certain requests can be made that you achieve loose coupling. Loose coupling is not achieved by listing a set of resources and saying "ok, you can GET, PUT, POST, DELETE all you want."

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T00:28:55.317

我认为它们真的是正交的。REST 描述了一组由 URI 寻址的资源集合，其中包含一组规范方法：GET、POST 等。如果 REST 例程返回一个 URI，那不是“通过”，而是标识具有相同方法名称的不同对象。

# c++ - 读取输入文件的部分内容

> ID：745897
> 
> 赞同：2
> 
> 时间：2009-04-14T00:28:32.790
> 
> 标签：c++, parsing, file-io

我想读取 C++ 中的输入文件，其结构（或缺少）类似于一系列带有*text = number*的行，例如

```
input1 = 10
input2 = 4
set1 = 1.2
set2 = 1.e3 
```

我想把这个号码排除在外，把剩下的扔掉。数字可以是整数或双精度数，但我知道它们何时是一个或另一个。

我也想阅读它，例如

```
input1 =    10
input2=4
set1   =1.2
set2= 1.e3 
```

以便对用户更加健壮。我认为这意味着它不应该以格式化的方式显示为红色。

无论如何，有没有聪明的方法来做到这一点？

我已经尝试了以下方法，但对我一直在做的事情知之甚少，所以结果如预期......没有成功。

```
 #include <stdio.h>
    #include <stdlib.h>
    #include <float.h>
    #include <math.h>
    #include <iostream>
    #include <fstream>
    #include <iomanip>
    #include <cstdlib>
    #include <boost/lexical_cast.hpp>
    #include <string>

    using namespace std;
    using namespace boost;

    int main(){

            string tmp;
            char temp[100];

            int i,j,k;

            ifstream InFile("input.dat");

            //strtol
            InFile.getline(temp,100);
            k=strtol(temp,0,10);
            cout << k << endl;

            //lexical_cast
            InFile.getline(temp,100);
            j = lexical_cast<int>(temp);
            cout << j << endl;

            //Direct read
            InFile >> tmp >> i;
            cout << i << endl;

            return 0;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T03:44:19.280

一次只读一行。
然后在'='符号上分割每一行。使用流功能完成其余的工作。

```
#include <sstream>
#include <fstream>
#include <iostream>
#include <string>

int main()
{
    std::ifstream    data("input.dat");
    std::string      line;

    while(std::getline(data,line))
    {
        std::stringstream    str(line);
        std::string          text;

        std::getline(str,text,'=');

        double   value;
        str >> value;
    }
} 
```

带错误检查：

```
#include <sstream>
#include <fstream>
#include <iostream>
#include <string>

int main()
{
    std::ifstream    data("input.dat");
    std::string      line;

    while(std::getline(data,line))
    {
        std::stringstream    str(line);
        std::string          text;
        double               value;

        if ((std::getline(str,text,'=')) &&  (str >> value))
        {
            // Happy Days..
            // Do processing.
            continue; // To start next iteration of loop.
        }
        // If we get here. An error occurred.
        // By doing nothing the line will be ignored.
        // Maybe just log an error.
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-23T13:30:57.777

这里已经有一些很好的解决方案。然而，只是把它扔在那里，一些评论暗示 Boost Spirit 是解决这个问题的不合适的解决方案。我不确定我完全不同意。但是，以下解决方案非常简洁、易读（*如果*您知道 EBNF）和容错。我会考虑使用它。

```
#include <fstream>
#include <string>
#include <boost/spirit.hpp>

using namespace std;
using namespace boost::spirit;

int main()
{
    ifstream       data("input.dat");
    string         line;
    vector<double> numbers;

    while(getline(data,line))
    {
        parse(line.c_str(), 
            *(+~ch_p('=') >> ch_p('=') >> real_p[push_back_a(numbers)]), 
            space_p);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T00:38:41.660

C FTW（修改为处理双打）

```
#include <stdio.h>

int
main ()
{
    double num;

    while (!feof (stdin))
         if (1 == fscanf (stdin, "%*[^=] = %lf", &num))
            printf ("%g\n", num);

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T00:47:49.407

我做对了吗：你拿线，从中提取数字并打印出来（或在其他地方使用它，无论如何）？如果是这样，您可以使用字符串函数和 istringstream：

```
//these are your codes, removing some though
#include <stdio.h>
#include <stdlib.h>
#include <float.h>
#include <math.h>
#include <iostream>
#include <fstream>
#include <string>
//adding
#include <sstream>

using namespace std;

int main()
{
string line="", extract="";
int placeofop=0, input;
ifstream InFile("input.dat");

while(!InFile.eof())
{
     getline(InFile, line);
     placeofop = line.find("=");
     extract = line.substr(placeofop, (line.length()-placeofop));
     istringstream trythis(extract);
     trythis >> input;
     cout << input << endl;
}

return 0;
} 
```

我不是 100% 确定我是否记得正确的功能，但如果我把它们都做对了，这应该可以工作。

编辑：我意识到我可以编辑我的帖子 :) 我在评论中颠倒了 <<'s 和 >>'s；我一直在做的事情......现在没有编译错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-14T00:48:45.660

在我的头顶上：

```
vector<double> vals(istream &in) {
    vector<double> r;
    string line;

    while (getline(f, line)) {
        const size_t eq = line.find('=');
        if (eq != string::npos) {
            istringstream ss(line.substr(eq + 1));
            double d = 0;
            ss >> d;
            if (ss) r.push_back(d);
            else throw "Line contains no value";
        }
        else {
            throw "Line contains no =";
        }
    }

    return r;
}

int main(int argc, char *argv[]) {
    vector<double> vs = vals(ifstream(argv[1]));
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T05:52:06.070

现在您已经在使用带有 lexical_cast 的 boost，只需使用[boost::split()](http://www.boost.org/doc/libs/1_38_0/doc/html/string_algo/reference.html#header.boost.algorithm.string.split_hpp)和[boost::is_any_of()](http://www.boost.org/doc/libs/1_38_0/doc/html/boost/algorithm/is_any_of.html)将每一行解析为 1 个 2 元素向量，并打开 token_compress。

以下代码说明了解析，但跳过了数字转换，这可以通过 boost lexical_cast 轻松解决。

```
#include <fstream>
#include <sstream>
#include <string>
#include <iostream>
#include <vector>
#include <boost/algorithm/string/split.hpp>
#include <boost/algorithm/string/classification.hpp>
#include <boost/foreach.hpp>  

using std::string;
using std::cout;
using std::ifstream;
using std::stringstream;  
using std::vector; 

std::string file_to_string()
{
    ifstream    data("data.txt");
    stringstream s;
    s << data.rdbuf();
    return s.str();
}

void print_parameter(vector<string>& v)
{
    cout << v_para[0];
    cout << "=";
    cout << v_para[1];
    cout << std::endl;   
}

vector<string> string_to_lines(const string& s)
{
    return  v_lines;
}

int main()
{

    vector<string> v_lines;
    boost::split(v_lines, file_to_string(), boost::is_any_of("\n"), boost::token_compress_on);

    vector<string> v_para;
    BOOST_FOREACH(string& line, v_lines)
    {
        if(line.empty()) continue;

        boost::split(v_para, line, boost::is_any_of(" ="), boost::token_compress_on);

        // test it
        print_parameter(v_para);
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-18T03:25:00.583

如果您正在设计这种格式，我建议采用[INI 文件](http://en.wikipedia.org/wiki/Initialization_file)格式。轻量级语法 INI 格式包括部分（允许您在格式中有更多结构），在您的情况下可能需要也可能不需要：

IE

```
[section_1] 
variable_1=value1
variable_2=999 
[sectionA]
variable_A=value A 
variable_B=111 
```

此维基百科页面上的外部链接列出了许多可用于处理这些类型的文件的库，这些文件扩展/替换了 Windows API 的基本 GetPrivateProfileString 函数并支持其他平台。其中大多数将处理空格填充 = 符号（或至少在 = 之前，因为 = 之后的空格可能是有意/重要的。如果您不希望，其中一些库还可以选择省略 [sections] （我自己的用于处理类似格式文件的 INI 的 C++ 类具有此选项）。

这些库和/或使用 Windows API GetPrivateProfileXXX 函数的优点是您的程序可以访问特定变量（即从 sectionA 获取或设置 variable_A 的值），而无需您的程序编写/扫描/重写整个文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T01:06:56.910

这是我最快的 STL 解决方案：

```
#include <fstream>
#include <list>
#include <locale>
void foo()
{
std::fstream f("c:\\temp\\foo.txt", std::ios_base::in);
std::list<double> numbers;
while (!f.eof())
{   
    int c = f.get();
    if (std::isdigit(c, std::locale::classic()) ||
        c == '+' ||
        c == '-' ||
        c == '.')
    {
        f.putback(c);
        double val;
        f >> val;
        if (f.fail()) {
            f.clear(f.eof() ? std::ios_base::eofbit : std::ios_base::goodbit);
            continue;
        }
        else
        {
            numbers.push_back(val);
        }           
    }
}
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T01:42:13.627

刚刚对此进行了测试……它可以工作，并且不需要 C++ 标准库之外的任何东西。

```
#include <iostream>
#include <map>
#include <string>
#include <algorithm>
#include <iterator>
#include <cctype>
#include <sstream>

using namespace std; // just because this is an example...

static void print(const pair<string, double> &p)
{
    cout << p.first << " = " << p.second << "\n";
}

static double to_double(const string &s)
{
    double value = 0;
    istringstream is(s);
    is >> value;
    return value;
}

static string trim(const string &s)
{
    size_t b = 0;
    size_t e = s.size();
    while (b < e && isspace(s[b])) ++b;
    while (e > b && isspace(s[e-1])) --e;
    return s.substr(b, e - b);
}

static void readINI(istream &is, map<string, double> &values)
{
    string key;
    string value;

    while (getline(is, key, '='))
    {
        getline(is, value, '\n');
        values.insert(make_pair(trim(key), to_double(value)));
    }
}

int main()
{
    map<string, double> values;
    readINI(cin, values);
    for_each(values.begin(), values.end(), print);
    return 0;
} 
```

编辑：我刚刚阅读了原始问题并注意到我没有给出确切的答案。如果您不关心键名，请丢弃它们。另外，为什么需要区分整数值和浮点值？是`1000`整数还是浮点数？`1e3`或呢`1000.0`？检查给定的浮点值是否是整数很容易，但是有一类数字既是有效的整数又是有效的浮点值，如果要处理，则需要进入自己的解析例程那是正确的。

# cron - 如何每 72 分钟执行一次 cron 作业

> ID：745901
> 
> 赞同：17
> 
> 时间：2009-04-14T00:31:39.150
> 
> 标签：cron, scheduled-tasks, hour

我如何让 cron 作业每 72 分钟运行一次？或者一些不那么漂亮的数字？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-14T00:44:38.133

由于`cron`运行作业是基于时间的，而不是基于间隔的，因此没有简单的方法可以做到这一点。然而，虽然这有点小技巧，但您可以在其中设置多行，`crontab`直到找到共同点。由于您希望作业每 72 分钟运行一次，因此它必须在以下时间执行：

*   00:00
*   01:12
*   02:24
*   03:36
*   04:48
*   06:00
*   07:12
*   ...

如您所见，该模式每 6 小时重复一次，有 5 个作业。因此，您将在 5 行`crontab`：

```
0 0,6,12,18 * * * 命令
12 1,7,13,19 * * * 命令
24 2,8,14,20 * * * 命令
36 3,9,15,21 * * * 命令
48 4,10,16,22 * * * 命令

```

当然，另一种选择是创建一个包装守护程序或 shell 脚本，它会执行并休眠所需的时间，直到停止。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-04-14T00:36:54.860

使用在（人在）。让您的应用程序或启动脚本计算未来 72 分钟的启动时间，并安排自己在开始工作之前再次运行。

在 windows xp 和 vista 上也可用。

这是 gnu/linux 的示例： at -f command.sh now + 72 minutes

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T00:45:45.277

您总是可以采取每分钟触发 cron 的方法，如果脚本在 72 分钟前运行，则立即退出。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-23T23:49:59.680

不要使用 cron...

```
#!/bin/sh
while [ true ] 
do
     sleep 4320
     echo "Put your program here" &
done 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-14T00:35:26.347

您不能直接从 cron/crontab 执行此操作。

Cron 作业按特定计划运行，而不是按特定时间间隔运行。

一种替代方法是制定一个近似于“每 72 分钟”的时间表，方法是在午夜、1:12、2:24、3:36 ...... 您的 crontab 文件可以将所有这些时间指定为执行时间。

另一种选择是让一个单独的应用程序处理调度，并启动您的应用程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-14T00:42:10.620

您需要为此设置正好 20 个任务 - 即在 00:00 设置一个，在 01:12 设置下一个，在 02:24 设置下一个，等等。

20 次迭代使一整天。

不幸的是，这是唯一的方法，因为 cron 任务是预先设置在一个固定的时间表中，而不是运行，比如“在 X 分钟后执行最后一个任务”。

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2009-08-04T15:35:19.650

嗯，我知道这早就应该了，但我正在查看一些日程安排问题并看到了这个问题。

只需在您的 crontab 中执行此操作

*/72 * * * * /home/script.sh

# sml - 如何在 SML 中强制类型（如强制转换）

> ID：745905
> 
> 赞同：3
> 
> 时间：2009-04-14T00:33:32.700
> 
> 标签：sml, smlnj

我正在创建 Rationals (int * int) 的结构，我的功能之一是：

```
 fun diff ((n, d), (n', d')) = let val (top, bot) = sum ((n, d), (~n', d'))
                                  in 
                                    (top / gcd(top, bot), bot / gcd(top, bot))
                                  end 
```

gcd 给了我最大的公分母，所以我最终不是 2/8，而是应该是 1/4。gcd 使用 mod 来查找 gcd，因此它返回一个 int。但是我无法将除法表达式输入为 int。当我尝试添加`: int * int`到 diff 声明的末尾时，它给了我一个类型错误，即表达式 real * real 和 int * int 不匹配。

如何强制整数除法，或将表达式转换为整数？如果两者都可以，那么哪个更好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T05:36:08.137

是的，您使用了错误的运算符。`/`是浮点除法运算符。`div`（如 D.Shawley 所述）是整数除法运算符。`div`在这种情况下使用是正确的，因为您正在划分两个整数并想要获得一个整数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T03:09:15.027

SML有没有`div`运营商？自从我玩 ML 以来已经有好几年了，但这似乎是一种强制整数除法的非常标准的方法。

# java - 平滑的网格移动

> ID：745908
> 
> 赞同：0
> 
> 时间：2009-04-14T00:34:39.157
> 
> 标签：java, 2d

我正在使用网格系统开发 Java Bomberman 克隆，但我现在对这个动作并不满意。当玩家按下移动键时，角色开始移动（速度为 0.25）。玩家失去控制，角色继续移动，直到它移动了一个完整的瓷砖。玩家只有在角色到达下一个图块的中心时才能重新获得控制权。

这使得它太“滞后”了。*如果我现在*想改变方向，我做不到。

也许我可以让角色的底部小于精灵的大小，这意味着我必须在角落之前检查它是否是有效的移动。有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T21:00:46.670

不要禁用用户输入。曾经。不断地轮询它。

具有执行以下操作的 Tick() 或 OnFrameEnter() 函数：

轮询键盘/操纵杆/任何东西，并缓存用户输入的最后一个方向。

检查角色的位置。

如果角色在方格的中心处于空闲状态，请将其速度设置为正确的方向并将移动提高一步，除非途中有墙壁/碰撞物体。还将最后一次按键清除为一些无效值。

否则，如果角色已经在移动，则更新角色的位置，检查与墙壁的碰撞，或靠近方向改变节点（交叉点）。如果它与墙壁发生碰撞，请停止角色。如果靠近变向节点并且可以沿缓存的方向行进，则改变方向并清除缓存的方向。否则，如果输入方向与当前方向相反（在走廊中并且玩家想要反转），则反转方向然后清除按键。这一切都假设角色应该继续移动，一直到它撞到墙并停止。如果你想让角色在任何地方停下来，一个反向键应该简单地把它停在原地。

缓存按键允许玩家在角色接近十字路口时抢先改变方向。这样，角色在继续前进之前不必等待停止，并且玩家不会觉得游戏反应迟钝。轮询不断地让玩家可以随时反转方向，并让十字路口的方向变化看起来更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T18:16:09.963

几分钟前我刚玩过[炸弹人 :) 你可以很流畅地移动，没有网格计算。](http://www.virtualnes.com/play/?id=NES-BM&s=0)我没有那么多使用Java。我经常使用 Flash。是用于检查碰撞的网格吗？它到底是为了什么？

有类似的东西有意义吗（我会试着画一下）：

```
float vx,vy = 0;//velocity on x and y 
Character bomberman

void keyDownHandler(KeyboardEventSomething event){
 if(key is Left && ! Right ) vx -= .5;
else if(key is Right && !Left ) vx += .5;
//idem for Y axis
}

void keyUpHandler(KeyboardEventSomething event){
vx = vy = 0;
}

void updateLoop(){
  bomberman.x += vx;
  bomberman.y += vy;
} 
```

我可能有点不对劲，因为我不确定你想克隆多少炸弹人。您所描述的网格运动似乎更接近[hopmon](http://www.pcgaming.ws/viewgame.php?game=hopmon)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-09T11:17:38.450

听起来您通过更改其包含的网格单元格来更新玩家位置（动画的开始）。

为了能够达到预期的效果，精灵的渲染位置应该独立于该精灵表示的实体在网格上的位置。并允许用户在单元格中心范围内的网格内移动，而无需更改单元格。如果此范围选择不正确，您可能会遇到“doh！im in this（visually）cell but it says im in the future cell”问题，或者“我的头像与墙重叠”。

不要更改玩家单元格，直到他在包含他的单元格的限制/边界范围内（假设是精灵边界球的 1/3）。您还必须修改动画过程以使其可中断。

这与您赋予玩家的自由度无关（例如，它只能向上、向下、向左、向右和对角线移动，而不是 360 度）

您应该注意的另一件事是，如果精灵大于单元格大小。例如，一个胖怪物，或一个跨越 X 个单元但不一定是矩形的蛇老板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T00:39:01.923

您应该能够摆脱当前精灵并在需要时准确加载新精灵 - 即，如果角色移动到下一个图块的一半并且玩家按下键返回，取消精灵并加载新精灵开始在 0.5。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T06:15:34.360

我想这取决于你希望它如何表现。

假设您正在向上移动，然后单击右键..您希望它停止向上移动并向右移动吗？当您进行移动时，我会存储以前的网格位置。这样，如果您单击以移动到其他位置，则可以向后跳并更改移动方向..

或者，如果您正在向上移动并单击向下...您可以将移动速度设置为与实际速度相反...

在不知道您希望它的行为方式的情况下很难回答。

# ajax - JSON WebMethod 在 Sitefinity 中不起作用

> ID：745913
> 
> 赞同：2
> 
> 时间：2009-04-14T00:35:45.987
> 
> 标签：ajax, web-services, json, asmx, sitefinity

我正在尝试通过 ajax 调用托管在传统 ASP.Net WebForm 代码隐藏页面中的 WebMethod。下面是 WebMethod 的代码：

```
[WebMethod]
public static object States()
{
    StateProvince[] states = new StateProvince[] { };
    ApplicationServiceClient proxy = null;

    try
    {
        proxy = new ApplicationServiceClient();
        states = proxy.GetStateProvinces();
    }
    finally
    {
        CloseServiceProxy(proxy);
    }
    return states;
} 
```

WebMethod 在我的独立开发环境中工作得很好，或者如果正常部署到 IIS，但是当我将 aspx 页面部署到 Sitefinity 时，调用它时会出现以下异常：

**“/”应用程序中的服务器错误。**
*未知的网络方法 States.aspx。*
参数名称：methodName

我不确定 Sitefinity 是否在劫持 URL 并在后挂起“.aspx”或这里发生了什么。

这是调用 web 方法的 jquery 调用：

```
$.ajax({
        type: "POST",
        contentType: "application/json; charset=utf-8",
        url: "Regions.aspx/States",
        data: "{}",
        success: function(data) {
            // implementation omitted
        },
        error: function(xhr, msg) {
            alert(xhr.responseText);
        }
    }); 
```

我可以通过使用 Fiddler 手动发布请求来复制问题。

同样，这在任何地方都可以正常工作，除非部署到 Sitefinity。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-16T09:03:32.887

使用**数据类型：“json”，**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-03T02:02:49.270

Sitefinity 运行的是哪个版本的 .NET？页面方法是最近添加的。

# coldfusion - Coldfusion 开发者版和企业版有什么区别？

> ID：745921
> 
> 赞同：4
> 
> 时间：2009-04-14T00:40:30.330
> 
> 标签：coldfusion, webserver, dreamweaver

我正在尝试出于学习目的测试 Coldfusion，但我真的不知道非免费企业版添加到免费开发者版的附加功能是什么。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-14T02:18:27.427

从法律上讲，Enterprise 是供公众使用的，而 Dev 不是。

实际上，这意味着 Dev 版本（与 30? 天后的 Eval 版本相同）仅限于 localhost + 1 个 IP 地址。也就是说，它可以向 localhost 和 1 个外部 IP 提供文件。只能通过重新启动服务来重置此 IP。

否则，您的开发安装将完全模仿 ent 安装。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-14T17:50:29.883

Adobe ColdFusion Server 的开发者版受 IP 地址限制 - 只有 localhost 和 1 个其他 IP 地址可以访问服务器。再多的话，它会抛出许可证异常。

此外，使用 cfdocument 和 cfpresentation 创建的文档等可打印项目在每页上都带有巨大的对角横幅水印。

否则，开发版和企业版都启用了所有功能，包括高级调试和服务器监控、PDF 和 FlashPaper 生成、高级网关、64 位 CPU 支持和包括 Oracle 在内的完整数据库驱动程序 - 工作。

ColdFusion 的试用版与企业版相同，有效期为 30 天，但在 30 天后降为开发者版 - 一旦许可证过期。如果您将其投入生产，请确保记住输入您的序列号:)

有关参考，请参阅[Adob​​e ColdFusion 版本](http://www.adobe.com/products/coldfusion/editions/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T00:46:16.057

关键是一行：“用于在一台或多台服务器上交付多个网站和应用程序”

企业版允许出于商业目的进行部署。

Development Edition 允许您在本地开发，但不能部署。部署需要企业版或标准版，或购买为您处理许可的托管解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T00:57:24.720

[干得好。](http://www.adobe.com/products/coldfusion/editions/)

编辑：滚动到 Dev v. Ent 的底部。讨论。

# visual-studio-2008 - VC2008中的自动指针构造函数

> ID：745925
> 
> 赞同：3
> 
> 时间：2009-04-14T00:44:10.007
> 
> 标签：visual-studio-2008, visual-c++, visual-studio-2005, copy-constructor, auto-ptr

我有一个自动指针实现：

```
template <typename T, bool Arr = false>
class GAutoPtr
{
    T *Ptr;

public:
    typedef GAutoPtr<T, Arr> &AutoPtrRef;

    GAutoPtr(T *ptr = 0)
    {
        Ptr = ptr;
    }

    GAutoPtr(AutoPtrRef p)
    {
        Ptr = p.Release();
    }

    ~GAutoPtr() { Empty(); }
    operator T*() { return Ptr; }
    T *Get() { return Ptr; }
    T *operator->() const { LgiAssert(Ptr); return Ptr; }

    inline void Empty()
    {
        if (Arr)
            delete [] Ptr;
        else
            delete Ptr;
        Ptr = 0;
    }

    AutoPtrRef operator =(GAutoPtr<T> p)
    {
        Empty();
        Ptr = p.Ptr;
        p.Ptr = 0;
        return *this;
    }

    void Reset(T *p)
    {
        if (p != Ptr)
        {
            Empty();
            Ptr = p;
        }
    }

    T *Release()
    {
        T *p = Ptr;
        Ptr = 0;
        return p;
    }
};

typedef GAutoPtr<char, true> GAutoString;
typedef GAutoPtr<char16, true> GAutoWString; 
```

这在 Visual C++ 6 中运行良好。但是在 Visual C++ 2005 或 2008 中，我无法从函数返回自动指针，而不会出现严重错误。

例如

```
GAutoString Func()
{
    char *s = new char[4];
    strcpy(s, "asd");
    return s;
}

int main()
{
    GAutoString a = Func();
    /// a.Ptr is now garbage
} 
```

发生的情况是编译器创建一个临时 GAutoString 来保存函数的返回值，然后在将它传递给堆栈上的变量“a”时调用临时变量的运算符 T*()，然后调用 GAutoPtr( T *ptr = 0) 构造函数，而不是仅仅使用复制构造函数：GAutoPtr(AutoPtrRef p)

这会导致 temp auto ptr 删除内存，并且 'a' 持有指向已释放内存的指针。

但是在 VC6 中，它确实调用了正确的构造函数。现在说这一切，我也在 Linux 和 Mac 上使用 gcc，所以我写的任何代码也需要在那里工作。VC2008 阻止您在复制构造函数中使用非常量值变量。另外我也不想要“const”，因为复制构造函数获取内存块的所有权，这会从被复制的对象中删除所有权......从而修改它。

如何在 VC 2005/2008 中完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T01:20:28.110

您可以使用“显式”关键字标记采用 T* 参数的构造函数。我已经验证这可以工作并且也可以防止创建虚假临时对象，从而提高性能。不过，任何使用该构造函数的人都不能再依赖编译器类型转换规则。例如，您的功能将更改为：

```
GAutoString Func()
{
    char *s = new char[4];
    strcpy(s, "asd");
    return GAutoString(s);
} 
```

这很烦人，但我认为在这种情况下这不一定是一件坏事，因为自动类型转换可能会令人困惑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T02:52:26.597

这甚至是在最近的 g++ 下编译的吗？我在我的 MacBook Pro 上试了一下：

```
xxx.cpp: In function ‘AutoString func()’:
xxx.cpp:52: error: no matching function for call to ‘AutoPtr<char, true>::AutoPtr(AutoString)’
xxx.cpp:12: note: candidates are: AutoPtr<T, isArray>::AutoPtr(AutoPtr<T, isArray>&) [with T = char, bool isArray = true]
xxx.cpp:9: note:                 AutoPtr<T, isArray>::AutoPtr(T*) [with T = char, bool isArray = true]
xxx.cpp:52: error:   initializing temporary from result of ‘AutoPtr<T, isArray>::AutoPtr(T*) [with T = char, bool isArray = true]’ 
```

我可以编译它的唯一方法是让复制构造函数获取`const`我所怀疑的引用。看起来Herb Sutter在他最近的 GotW 中[发布了与此非常相似的内容。](http://herbsutter.wordpress.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/)`std::auto_ptr`如果没有很好的理由，我不会尝试复制所有权转移语义。您可能想看看[Boost.SmartPtr](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/smart_ptr.htm)中的各种好东西。如果可能，请改用它们。

如果您出于某种原因无法 Boost，请阅读您最喜欢的`std::auto_ptr`实现并特别注意该`std::auto_ptr_ref`课程。一旦你理解了它为什么存在以及它是如何做的，然后回去编写一个 auto-ptr 类。此类的存在是为了解决您所看到的问题。IIRC，这在[Josuttis': The Standard C++ Library](http://www.josuttis.com/libbook/auto_ptr.html)中有详细讨论。我想这是我第一次真正理解它的地方。

# xml - SGML 和 XML 有什么区别？

> ID：745933
> 
> 赞同：11
> 
> 时间：2009-04-14T00:46:29.580
> 
> 标签：xml, metadata, markup, sgml

所有的谷歌结果都很糟糕。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-04T01:00:06.733

SGML 比 XML 更难解析，因为它具有自动关闭的隐式关闭标签（无需指定关闭标签）。

我怀疑 SGML 具有这样的特性，因为在 80 年代引入 SGML 时人类直接手动创建 SGML 比今天的 XML 更常见，因此这些特性节省了大量的输入。例如，OED 在 80 年代在 SGML 中被标记（手动？）。

![在此处输入图像描述](https://i.stack.imgur.com/xdvwN.jpg)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-14T00:55:05.957

XML 是[SGML](http://en.wikipedia.org/wiki/SGML)的一个子集，这意味着它具有 SGML 必须提供的优点。[XML](http://en.wikipedia.org/wiki/XML)旨在使解析更容易。XML，而不是 SGML，也被广泛用于导出文档规范。

更多讨论在这里：

> [SGML 和 XML 有什么区别？](http://www.irt.org/script/5206.htm)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-12-16T05:23:59.303

主要区别在于 SGML 指定了如何指定文档标记语言或标签的标准，而 XML 指定了用户定义标签的标准（即用户可以定义自己的标签）

为了清楚我的回答，请参阅以下链接：

[http://sdn.vlsm.org/share/LDP/authors/html/xmldifferences.html](http://sdn.vlsm.org/share/LDP/authors/html/xmldifferences.html)

谢谢你。

# objective-c - Objective-c xmlchar 数据类型如何工作

> ID：745935
> 
> 赞同：0
> 
> 时间：2009-04-14T00:46:48.753
> 
> 标签：objective-c, xml, types

在目标 c 中，xmlchar 数据类型如何工作？我似乎找不到任何 API 文档。具体来说，我的声明如下所示：

```
 const xmlChar **attributes 
```

我是通过说它是一个客观的c数据类型来正确分类它还是它特定于可可或只是C？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-01-27T11:28:00.207

`xmlChar`您可以在`xmlString.h`libxml2 库中看到声明为：

> ```
> typedef unsigned char xmlChar; 
> ```

现在进行`xmlChar to NSString`转换

```
xmlChar *str = (unsigned char *)"I am to be converted";
NSString *convertedString = [NSString stringWithUTF8String:(const char *)str]; 
```

来自`NSString to xmlChar`转换；

```
NSString *str = @"I am to be converted";
xmlChar *convertedString = (xmlChar *)[str UTF8String]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T01:24:45.137

我不认为 Objective-C 有任何类型的 xmlChar 数据类型。在 Cocoa 中，您通常会使用[`NSXMLParser`](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/XMLParsing/XMLParsing.html)，它只使用[`NSString`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html). 你可能在想[libxml2](http://xmlsoft.org/html/libxml-xmlstring.html)吗？在这种情况下，它被简单地定义为一个`unsigned char`表示 UTF-8 八位字节的表示（以帮助编译器在您尝试将其强制转换为 a 时发出警告`char`）。只要记住它是 UTF-8 编码而不是 ASCII 编码，您通常可以将其视为`xmlChar *`常规（因此，截断它可能会产生无效字符，除非您实现语言环境，否则比较值以对其进行排序将不起作用 -`char *`意识比较等）。

# search - 访问图中重复访问最少的所有节点

> ID：745942
> 
> 赞同：2
> 
> 时间：2009-04-14T00:50:02.427
> 
> 标签：search, graph-theory, path-finding

我有一个基于瓷砖的地图，其中几个瓷砖是墙壁，其他瓷砖是可步行的。可步行的瓷砖构成了我想在路径规划中使用的图表。我的问题是他们是否有任何好的算法来找到访问图中每个节点的路径，最大限度地减少重复访问？

例如：

[地图示例 http://img220.imageshack.us/img220/3488/mapq.png](http://img220.imageshack.us/img220/3488/mapq.png)

如果底部的黄色瓷砖是起点，则访问所有重复次数最少的瓷砖的最佳路径是：

[路径示例 http://img222.imageshack.us/img222/7773/mapd.png](http://img222.imageshack.us/img222/7773/mapd.png)

这条路径有两次重复访问。更糟糕的路径是在第一个路口左转，然后在三个已经访问过的瓷砖上回溯。

我不关心结束节点，但开始节点很重要。

谢谢。

编辑：

我在我的问题中添加了图片，但在查看时看不到它们。他们来了：

[http://img220.imageshack.us/img220/3488/mapq.png](http://img220.imageshack.us/img220/3488/mapq.png)

[http://img222.imageshack.us/img222/7773/mapd.png](http://img222.imageshack.us/img222/7773/mapd.png)

此外，在图表中我需要这个，因为永远不会出现 min repeats = 0 的情况。也就是说，要踩到地图中的每个图块，玩家必须至少穿过自己的路径一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T01:06:15.867

您的措辞不好-它可以简化为NP完全问题。如果您可以最大限度地减少重复访问，那么您可以将它们推到 0，然后您就会有一个[哈密顿循环](http://mathworld.wolfram.com/HamiltonianCycle.html)。这是[可以解决](http://www.springerlink.com/content/6wkbcnbfvrnq86ev/)的，但很难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T01:06:58.317

这听起来像是可以映射到旅行商问题......因此很可能最终是 NP 完全的，并且没有已知的有效确定性算法。

找到一条路径相当简单——找到一个（或最小的）生成子树，然后进行深度/广度优先遍历。找到最佳路线是非常困难的一点。

您可以使用其中一种动态优化技术来尝试并收敛到一个相当好的解决方案。

除非最小生成子树的某些属性可用于生成最佳路径......但我不记得足够的图论。

# powershell - 如何在 PowerShell 中处理 System.Xml.XmlWriter

> ID：745956
> 
> 赞同：10
> 
> 时间：2009-04-14T00:57:55.357
> 
> 标签：powershell, dispose, idisposable

我正在尝试处理 XmlWriter 对象：

```
try
{
    [System.Xml.XmlWriter] $writer = [System.Xml.XmlWriter]::Create('c:\some.xml')
}
finally
{
    $writer.Dispose()
} 
```

错误：

> 方法调用失败，因为 [System.Xml.XmlWellFormedWriter] 不包含名为“Dispose”的方法。

另一方面：

```
 $writer -is [IDisposable]
 # True 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-14T01:02:37.547

Dispose 在上[受到保护](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.dispose(loband).aspx)`System.Xml.XmlWriter`。你应该`Close`改用。

```
$writer.Close 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-20T10:14:35.340

这是另一种方法：

```
(get-interface $obj ([IDisposable])).Dispose() 
```

Get-Interface 脚本可在此处找到[http://www.nivot.org/2009/03/28/PowerShell20CTP3ModulesInPracticeClosures.aspx](http://www.nivot.org/2009/03/28/PowerShell20CTP3ModulesInPracticeClosures.aspx)，并在此[响应](https://stackoverflow.com/questions/746014/how-can-i-call-explicitly-implemented-interface-method-from-powershell/761338#761338)中提出。

使用 'using' 关键字，我们得到：

```
$MY_DIR = Split-Path -Path $MyInvocation.MyCommand.Definition -Parent

# http://www.nivot.org/2009/03/28/PowerShell20CTP3ModulesInPracticeClosures.aspx
. ($MY_DIR + '\get-interface.ps1')

# A bit modified code from http://blogs.msdn.com/powershell/archive/2009/03/12/reserving-keywords.aspx
function using
{
    param($obj, [scriptblock]$sb)

    try {
        & $sb
    } finally {
        if ($obj -is [IDisposable]) {
            (get-interface $obj ([IDisposable])).Dispose()
        }
    }
}

# Demo
using($writer = [System.Xml.XmlWriter]::Create('c:\some.xml')) {

} 
```

# jquery - DOM 事件日志记录有没有好的解决方案？

> ID：745959
> 
> 赞同：0
> 
> 时间：2009-04-14T00:59:13.467
> 
> 标签：jquery, dom, logging

我需要为客户创建分析解决方案。他们通过 JQuery/Ajax 进行了大量的 DOM 操作。除了为每个 DOM 操作调用一个函数之外，还有其他有效的方法来记录 DOM 事件吗？

我需要记录每个 DOM 操作，以便我们可以对这些数据进行分析。在很多情况下，网站会向用户显示不同的数据，但不会发送到服务器，而是通过操作 DOM 来提供服务。

记录每个 DOM 操作似乎是一个昂贵的（就服务器处理器而言）解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T01:43:24.187

jQuery 没有内置任何日志记录。但是您可以使用这个：

[http://ajaxian.com/archives/jquery-logging](http://ajaxian.com/archives/jquery-logging)

并修改您的 jquery.js 文件以在特定的 jQuery 方法发生时记录它们。这不是一个完美的解决方案，但应该可以帮助您找出主要问题或至少为您指明正确的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T01:13:52.683

我对“记录 DOM 事件”和“为每个 DOM 操作进行函数调用”的混合感到困惑。看起来它们是两个不同的东西。

*   我通过 AJAX 函数调用检索一些 HTML 来操作 DOM....
*   我可以在某处记录操作？为什么我们要记录操纵？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-11T15:30:42.683

您可以使用它来调试链日志。尽管仍在添加函数调用，但它仍在进行中，主要的调用已经存在。

[http://www.jquerylog.com](http://www.jquerylog.com)

# sql-server - 静态数据库数据是否应该在其自己的文件组中？

> ID：745966
> 
> 赞同：1
> 
> 时间：2009-04-14T01:03:35.327
> 
> 标签：sql-server, database-design, sql-server-2008, filegroup, physical-design

我正在创建一个新数据库并拥有一堆不会改变的静态数据。如果是这样，这将是一个手动过程，而且很少发生。

该数据是 varchars 和 Geographies 的混合。

我猜它总共可能在 100K 左右，超过 4 张左右的桌子。

### 问题

1.  我应该把这些放在只读文件组上吗
2.  我可以在设计器中创建表并在创建期间定义文件组吗？还是只能通过脚本实现？
3.  一旦数据在表中（在只读文件组上），我以后可以更改它吗？真的很难做到吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T04:36:24.677

出于各种原因，VLDB（非常大的数据库）是值得的。对于 100,000 行或 100 KB，我不会打扰。

这篇[SQL Server 支持工程团队](http://blogs.msdn.com/psssql/archive/2007/02/21/sql-server-urban-legends-discussed.aspx)文章讨论了相关的“都市传说”之一。

在您应该考虑多个文件/文件组之前，还有另一个（找不到）需要 300 GB - 1B 的数据。

但是，要具体回答

1.  个人选择（没有硬性规定）
2.  是（编辑：）在 SSMS 2005 设计模式中，转到索引/键，“数据空间规范”。数据位于聚集索引所在的位置。没有聚集索引，那么你只能通过`CREATE TABLE (..) ON filegroup`
3.  是的，但是您必须`ALTER DATABASE myDB MODIFY FILEGROUP foo READ_WRITE`在单用户独占模式下使用数据库

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T01:42:17.153

将数据放入只读空间不太可能造成伤害，但我不确定您是否会获得显着收益。只读文件组（或 Oracle 中的表空间）可以为您带来 2 个优势；每次进行完整备份时备份更少，数据安全性更高（例如，无法通过错误更改，通过其他工具访问数据库等）。对于备份窗口很紧的大型数据库，备份优势最为明显，因此在排除文件组方面投入少量精力是很有价值的。安全性取决于站点、数据等的性质（如果您确实从常规备份中排除只读空间，请确保您在任何保留的备份磁带上获得副本。我倾向于备份只读空间一次一个月。）

我对设计师不熟悉。

在只读模式之间切换并不繁琐。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T06:53:22.833

我认为你在这里读到的任何东西都可能是猜测，除非你有任何证据表明它已经过实际尝试和推荐——对我来说，这看起来像是一个新奇但不太可能的想法。你有什么理由怀疑传统的做法会不能令人满意吗？尝试一下并找出答案应该相当容易。如果有机会，请发布您的结果。

# asp.net-mvc - asp mvc Ajax.BeginForm 返回视图或值，对返回类型感到困惑

> ID：745969
> 
> 赞同：1
> 
> 时间：2009-04-14T01:06:19.970
> 
> 标签：asp.net-mvc, asp.net-ajax

如果用户没有使用 javascript，我将在 IsAjaxRequest 检查后使用 RedirectToAction 刷新视图。当我在页面中有用户控制并返回部分视图时，此方法有效。

但是当我只想返回一个值，比如 int，并且在不是 ajax 请求时还想使用 RedirectToAction 时，如何在控制器中设置方法？

公开行动结果...

```
(if ajax request) Return View (new{value=5})? 
(if not) redirecttoAction ("view"); 
```

不工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T01:37:03.297

您需要使用 JsonResult。

```
if (IsAjaxRequest()) {
    return Json(new { value = 5 });
} else {
    return RedirectToAction("parentAction");
} 
```

它将匿名对象序列化为 JSON 结果。或者，如果您真的只想返回一个“int”，这不是真正常见的 AJAX，您应该使用`ContentResult`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T01:14:11.450

您需要重定向到使用适当的路由数据（并且可能使用 TempData）呈现父视图的操作，以将更新的信息获取到局部视图。

```
 if (IsAjaxRequest())
     {
         return Content( "5" );
     }
     else
     {
         return RedirectToAction( "parentAction", new { id = ??, value = 5 } );
     } 
```

# c# - 如何绑定到列表 使用数据上下文？

> ID：745970
> 
> 赞同：2
> 
> 时间：2009-04-14T01:06:27.350
> 
> 标签：c#, .net, wpf, xaml

我正在自学 C#、OOP 和 WPF，因此出现问题的可能性是惊人的。

因此，鉴于此，有人可以解释为什么在我的小测试示例中单击按钮后 Name 属性出现在 TextBox 中但 ListBox 什么也没显示？

## **XAML：**

```
<Window x:Class="BindingTest.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="BindingTest" Height="250" Width="300">
<Grid Name="mainGrid">
    <Grid.RowDefinitions>
        <RowDefinition Height="50" />
        <RowDefinition Height="50" />
        <RowDefinition Height="100" />
    </Grid.RowDefinitions>
    <Button 
            Grid.Row="0"
            Name="MakeIntListButton"
            Click="MakeIntListButton_Click">Make and Display Integer List</Button>
    <TextBox Grid.Row="1" Text ="{Binding Path=Name}"
             />
    <ListBox
        Grid.Row="2"
        ItemsSource="{Binding Path=MyIntegers}"
        />
</Grid> 
```

## **C＃：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace BindingTest
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }

        private void MakeIntListButton_Click(object sender, RoutedEventArgs e)
        {
            AClass InstanceOfAClass = new AClass();
            InstanceOfAClass.MyIntegers.Add(6);
            InstanceOfAClass.MyIntegers.Add(7);
            InstanceOfAClass.MyIntegers.Add(42);

            InstanceOfAClass.Name = "Fred";

            mainGrid.DataContext =InstanceOfAClass ;
        }
    }

    public class AClass
    {
        public string Name {get;set;}
        public List<int> MyIntegers = new List<int>();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T01:21:37.203

我的一部分想知道这是否与“MyIntegers”是一个公共字段而不是一个属性这一事实有关。你能把你的类重构成这样并尝试一下吗？

```
public class AClass
{
    private List<int> _ints = new List<int>();

    public string Name { get; set; }
    public List<int> MyIntegers
    {
        get { return _ints; }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T01:31:17.180

我运行了您的示例，当我单击按钮时，TextBox 按预期填充了名称。

我遇到的唯一问题是 ListView 没有填充整数列表。~~这与 XAML 对泛型不太适应的事实有关，如果您修改它以绑定到数组而不是它可以工作。~~WPF 很好地支持 XAML 的使用，它在 XAML 中使用不受支持的泛型。正如马特汉密尔顿在他的回答中指出的那样，MyIntegers 只需要通过添加一个获取访问器来成为一个属性。

添加 C# 属性：

```
public int[] MyInts { get { return MyIntegers.ToArray(); } } 
```

XAML：

```
<ListBox Grid.Row="2" ItemsSource="{Binding Path=MyInts}" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T10:32:15.217

研究使用 System.Collections.ObjectModel.ObservableCollection 进行列表绑定而不是普通列表。

# c# - 从组合框中删除边框

> ID：745974
> 
> 赞同：5
> 
> 时间：2009-04-14T01:08:36.347
> 
> 标签：c#, controls

我正在使用 C# 编写一个用于显示信息的表单，但我仍然需要允许对信息进行一些操作。我真正想做的是从组合框中删除边框，这将允许我显示信息，同时还允许用户选择集合中的其他项目而不必全部显示。

更具体地说，我有一个包含 4 或 5 个电子邮件地址的列表，但我只想一次显示一个，同时允许用户轻松选择不同的项目。我已经搜索了所有内容，但找不到修改组合框边框的简单方法，而无边框组合框将很好地满足我的需求。

我刚开始使用 C#，所以我还在学习，也许我错过了一些东西。看起来这应该比原来容易得多，希望有人可以帮助我。

编辑：
表单使用标签来显示信息，所以中间有一个组合框使它看起来很糟糕。基本上我正在寻找的是一个链接，单击该链接会打开默认电子邮件程序并填写地址，但我想要下拉按钮，以便可以选择备用地址。如果不需要，我不想显示大量地址列表，我只想一次显示一个。就像一个组合框，但没有边框。

我可能只添加一个显示备用地址列表的按钮，但如果我可以从组合框中删除边框并得到我正在寻找的东西，为什么还要重新发明轮子呢？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T01:38:02.187

也许您根本不需要 ComboBox。假设您使用的是 Windows 窗体，您可以使用标准文本框并将您的电子邮件地址列表添加到其 AutoCompleteCustomSource（并将 AutoCompleteSource 设置为“CustomSource”）。

然后，如果您将 TextBox 的 AutoCompleteMode 设置为“附加”，则用户将永远不会看到完整的电子邮件地址列表 - 他们只会在输入时在 TextBox 中填充关闭匹配。通过一些代码隐藏，您甚至可以引入使用向上和向下箭头键循环浏览可用项目的能力。

**编辑**

现在您已经更新了您的问题，我将建议一种完全不同的方法。

添加“默认”电子邮件地址作为标准标签。哎呀 - 将其添加为 LinkLabel 并使其可点击，因此它的行为类似于网页上的 mailto: 链接。在该标签旁边，添加一个普通按钮。将其 FlatStyle 属性设置为“System”，将字体名称设置为“Marlett”，将标题设置为“u”，这样它就有一个漂亮的“下拉按钮”外观。

现在将 ContextMenuStrip 添加到您的表单并为每个电子邮件地址添加一个菜单项。你可以很容易地在代码中做到这一点。

现在为您的按钮添加此 Click 事件处理程序：

```
private void button1_Click(object sender, EventArgs e)
{
    contextMenuStrip1.Show(button1, new Point(0, button1.Height));
} 
```

因此，当单击该按钮时，会弹出显示“备用”电子邮件地址的菜单。您需要做的就是捕捉菜单项的 Click 事件以“使用”选定的电子邮件地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T01:19:59.500

为什么需要`ComboBox`无边界？对我来说没有多大意义。

让你能做的就是做一个只读的`ComboBox`. 您可以填充条目，用户将被允许选择它们，但不能输入任何文本。

刚设置`DropDownStyle`为`ComboBoxStyle.DropDownList`。

```
this.comboBox1.DropDownStyle = ComboBoxStyle.DropDownList; 
```

* * *

### 更新：

`DrawMode`您可以尝试通过设置为“隐藏”边框`DrawMode.OwnerDrawFixed`。

```
this.comboBox1.DrawMode = DrawMode.OwnerDrawFixed; 
```

这不会隐藏它，但会使其不那么明显。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-08T16:28:13.977

我知道已经很晚了，但是我曾经不得不从组合框中删除边框，以便通过简单地为其分配一个新区域将其放入自定义用户控件中。假设组合框的 FlatStyle 属性在 Standard 中具有 3px 边框，我们在新区域中删除该数量。例如：

```
comboBox.Region = new Region(new Rectangle(3, 3, comboBox.Width - 3, comboBox.Height - 7)); 
```

如果 FlatStyle 属性是 Flat，如果它有 1px 的边框，你可以玩弄数字。

# c# - 缓存查找性能

> ID：745985
> 
> 赞同：4
> 
> 时间：2009-04-14T01:18:02.750
> 
> 标签：c#, performance, caching, lookup

我们有一个大型的 winforms C# 应用程序，它基本上是一些数据库（CRUD 的东西）的前端，我正在尝试为业务对象实现一些内存缓存。

就像是：

```
List<Customer> customerCache; // Loaded during app. startup 
```

我已经创建了一些代码来使缓存与数据库保持同步。该代码一直在单独的线程上运行，并且运行良好。我的问题是，根据缓存的大小，在数据库中执行“从 id = x 的客户中选择 *”比使用 foreach（customerCache 中的 foreach Customer cmr）循环遍历缓存以找到该特定对象更快...

有没有办法在我的缓存中快速搜索特定对象？我打算尝试一些算法或更改我的收藏类型，但我希望能听取您的建议。

请注意，我们有几个“List xxxCache”，而且一切都很快（对于小 N，当然）。但是当缓存的数量增加（通常> 3000）时，从数据库中读取的速度会更快。

遍历我的缓存项目以找到特定项目的最佳方法是什么？所有业务项目都继承自一个共同的祖先并具有“ID”属性（整数、唯一）。

对不起我的英语不好，这不是我的主要语言。最好的问候，来自巴西的问候。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-14T01:20:50.467

改为使用`Dictionary<int, Customer>`。它支持基于键的 O(1) 查找。在这种情况下，键是 Customer.Id。

您可能还想研究其他用于 .Net 的预构建数据库缓存解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T01:21:54.800

~~不使用 List`<T>`对象，为什么不使用：~~

~~键值对~~

Dictionary 是要使用的正确对象（KeyValuePair 是字典包含的集合`**facepalm**`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T02:16:27.820

使用与您需要的索引数量一样多的字典。

```
dictionary<int,Customer> CustomerIds //(Ids)  
dictionary<string,Customer> CustomerNames //(Names)  
//or  
dictionary<string,List<Customer>> //(if name is not unique) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T20:00:51.403

对于 Web 表单应用程序，我们有一个类似的案例。我们使用 MS Enterprise Lib Cache 块。它易于实施和使用。唯一需要关注的就是 Cache Key (string type) cache.add(key, object) cache.getdata(key)

# .net - 设置 UpdateBatchSize 时要查找的内容

> ID：745993
> 
> 赞同：2
> 
> 时间：2009-04-14T01:21:30.557
> 
> 标签：.net, dataadapter, sql-server-profiler, updatebatchsize

我有一个 .NET 应用程序，它将两个数据表与很多行（10,000+）合并。使用 DataAdapter.Update 命令时，很有可能对 SQL 表执行大量更新/插入操作。

现在，我将 Adapter UpdateBatchSize 属性设置为 200。VS 警告不要将此值设置得太高，因为它可能会降低性能。好的，明白了。

性能方面，设置此属性时我应该寻找什么？无论如何，更新大量行将花费大量时间。在我的机器（或数据库服务器）上运行它似乎不会花费太多时间，但我确信当系统加载其他项目时，这可能是一个问题。

有什么我可以在 Profiler 中寻找的东西吗？进行标准分析时，持续时间通常为 0。有时是命中 1 或 2（可能总共 20 次），在大约 20,000 次更新中，3-4 命中 20。CPU 为 0，除了命中 1-2 的一对. 有 2 条记录最多可达 10 条左右。读取始终为 2，写入始终为 0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T01:26:25.053

第一件事是我会让这个设置可配置，这样你就可以在不编译的情况下测试各种值。接下来是观察整个批次的持续时间。如果您对性能感到满意，请不要更改它。如果您对性能不满意，请尝试增加或减少设置以查看其行为方式。*``*************