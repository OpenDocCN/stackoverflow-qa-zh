# StackOverflow 问答 10557000-10557999

# actionscript-3 - AS3 - 索引超出范围（错误 #1125）

> ID：10557009
> 
> 赞同：0
> 
> 时间：2012-05-11T18:49:43.143
> 
> 标签：actionscript-3

我[下载](http://www.gotoandlearn.com/files/tabletswipe.zip)了这个[教程](http://www.gotoandlearn.com/play.php?id=143)文件并通过测试我得到了这个错误：

> RangeError：错误 #1125 索引超出范围

```
 // MAIN BLIT CANVAS
var canvas:BitmapData = new BitmapData(1024, 768, false);
addChild(new Bitmap(canvas));
addChild(sl);

// PROPERTIES
var ind:int;
var offset:int;
var rect:Rectangle;
var zp:Point = new Point();
var destX:int = 0;
var currentX:int = 0;

// LOAD PHOTOS FROM LIBRARY
var photos:Vector.<BitmapData> = new Vector.<BitmapData>();
for(var i:int=1; i<5; i++)
{
    var ref:Class = getDefinitionByName("p"+i) as Class;
    photos.push(new ref());
}

// LOAD BITMAPDATA INTO MEMORY
for(i=0; i<4;i++)
    canvas.copyPixels(photos[i], new Rectangle(0,0,1,1), zp);

// FIGURE OUT POSITION OF SLIDER AND CALL RENDER
stage.addEventListener(Event.ENTER_FRAME, function(e:Event):void {
                     destX = Math.ceil((sl.thumb.x/908) * 13312);
                     currentX += (destX - currentX) * 0.15;
                     render();
                       });

// RENDER PIXELS TO CANVAS
function render():void
{
    ind = currentX / 1024;
    offset = currentX % 1024;
    rect = new Rectangle(offset, 0, 1024-offset, 768);
    canvas.copyPixels(photos[ind], rect, zp);
    if(currentX < 13312)
        canvas.copyPixels(photos[ind+1], canvas.rect, new Point(1024-offset, 0));
}

//START DRAGGING SLIDER
sl.thumb.addEventListener(MouseEvent.MOUSE_DOWN, function(e:MouseEvent):void {
      sl.thumb.startDrag(false, new Rectangle(0, 0, 909, 0));
      });

//START DRAGGING SLIDER
stage.addEventListener(MouseEvent.MOUSE_UP, function(e:MouseEvent):void {
      sl.thumb.stopDrag();
      }); 
```

是什么导致错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T18:57:09.310

```
canvas.copyPixels(photos[ind], rect, zp); 
```

或者

```
canvas.copyPixels(photos[ind+1], canvas.rect, new Point(1024-offset, 0)); 
```

检查 ind 和 ind+1 以确保它们小于 photos.length

# c++ - 增加 BST 的迭代器

> ID：10557010
> 
> 赞同：1
> 
> 时间：2012-05-11T18:49:43.440
> 
> 标签：c++, iterator, binary-search-tree

我对如何正确地做到这一点感到有些困惑，但我需要能够在我正在实现的使用模板的二叉搜索树类中增加一个迭代器。

迭代器的结构有一个当前节点，以及一个定义其当前位置的整数。我遇到的唯一问题是，当它进行`++Iter`操作时，我应该如何确定它应该向右还是向左？

这是整个类的头文件：

```
template < typename TComparable, typename TValue > 
    class SearchTree
    {
    public:
        class Iterator;
    private:
        struct Node;
        typedef typename Node TNode;
    public:
        SearchTree( void );
        ~SearchTree( void );
    public:
        TValue find( const TComparable& k );
        TValue find( int32_t index );
        TValue find( const Iterator& pIter );

        Iterator begin( void ) const;
        Iterator end( void ) const;

        void insert( const TComparable& k, const TValue& v );
        void insert( const Iterator& pIter );

        friend class Iterator;
        friend class TNode;
    private:
        int32_t mNodeCount;
        TNode* mRoot;
    public:
        class Iterator 
        {
        public:
            Iterator( void );
            Iterator( int32_t position );
            ~Iterator( void );
            inline TNode* operator->( void ) const 
            { return mCurrentNode; }
            void operator++( void );
            bool operator==( const Iterator& pIter );
            bool operator!=( const Iterator& pIter );
        private:
            int32_t getNumStepsLeftToLeaf( void );
            int32_t getNumStepsRightToLeaf( void );
            bool isLeafNode( const Node*& n );
            bool isInternalNode( const Node*& n );
        private:
            TNode* mCurrentNode;
            int32_t mIterPosition;
            friend class TNode;
        };
    private:
        struct Node
        {
        public:
            Node( void ) : mParent( NULL ), mLeftChild( NULL ), mRightChild( NULL )
            {}
            ~Node( void )
            {
                if ( mParent ) delete mParent;
                if ( mLeftChild ) delete mLeftChild;
                if ( mRightChild ) delete mRightChild;
            }
            int32_t index;
            TComparable Key;
            TValue Value;
            TNode* mParent;
            TNode* mLeftChild;
            TNode* mRightChild;
        };
    }; 
```

请注意，我不能为此使用异常，因为我计划将很多代码移植到 Android NDK，我相信它不能使用 STLport 的异常（这就是我将使用的 - GnuSTL 是 GPL 的，这意味着什么我正在做（这是为了盈利）我不能使用它 - 如果有人对此有任何反驳，请告诉我）

另外，在任何人提到 boost 之前，我已经尝试将其移植到 NDK，但没有成功。我想使用它，因为这会让生活变得更轻松，但现在我愿意编写自己的数据结构和算法。

至于迭代器，我猜我在这里的设计中遗漏了一些东西，如果有人知道这可能是什么，请告诉我。如果有人需要，我也很乐意为此发布整个班级的资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-12T10:10:20.860

首先，前缀增量运算符具有以下签名：

```
Iterator& operator++(); 
```

并且应该以这种方式根据前缀声明和定义后缀：

```
const Iterator& operator++(int){Iterator old = *this; ++(*this); return old;} 
```

您可能希望前缀向其节点询问下一个（最左边的）节点，

```
Iterator& Iterator::operator++(){
    myParent = mCurrentNode; 
    return  myParent.getRightOf(mCurrentNode); 
} 
```

你看我假设你有一种方法可以从一个你可能至少应该有一个私有节点的节点构造一个迭代器。

我想您想遍历叶节点（无论如何内部节点的实现并没有什么不同）。您或多或少需要一个 getRightOf 方法来执行以下操作，让我为它写一些伪代码：

```
Node* Node::getRightOf(Node* aNode){ 
    if aNode == mLeftChild{
        if mRightNode
            return mRightNode(this); 
        return mParent(this)
    }
    if aNode == mRightChild{
        return mParent(this)
    }
    if aNode == mParent{
        if mLeftNode
            return mLeftNode(this); 
        if mRightNode
            return mRightNode(this); 
        return this; 
    }
} 
```

您需要注意管理容器末端的迭代等案例。

**警告**

在 Node 的析构函数中，我读到：

```
if ( mParent ) delete mParent; 
```

这看起来很危险：谁删除了 ParentNode？左孩子还是右孩子？

# php - php 表单大约 30% 的时间没有通过电子邮件发送信息

> ID：10557014
> 
> 赞同：1
> 
> 时间：2012-05-11T18:49:53.670
> 
> 标签：php, forms, email

大约 30% 的访问者填写表单并且无法隔离问题时，我会收到“此消息没有内容”错误。下面是用于发送电子邮件的 php，地址是匿名的。有任何想法吗？

到目前为止，我试图在论坛中找到答案，但无济于事。谢谢你的帮助！

```
<?php

    $fromAddress = 'x@www.com';
    $subject = 'Resources - White Paper Download - '.$_POST['WhitePaper'];

    $message .= "\r\n";

    foreach($_POST as $name => $value) {
    $message .= $name . ': ' . $value . "\r\n";
    }

    $to       = 'y@www.com';
    $headers  = 'MIME-Version: 1.0' . "\r\n";
    $headers .= 'Content-type: text/plain; charset=UTF-8' . "\r\n";
    $headers .= 'From: ' . $fromAddress . "\r\n" .
        'Reply-To: ' . $fromAddress . "\r\n" .
        'X-Mailer: PHP/' . phpversion(). "\r\n";
    $headers .= 'Cc: z@www.com, <t@www.com>' . "\r\n";
    mail($to, $subject, $message, $headers);
    echo "mail sent";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T18:58:47.130

如果没有什么是一致的，你可以发现（即某些链接总是失败，或者它们有时会工作吗？）那么我只能建议你尽可能多地在代码中添加日志记录，看看是否有图案。

创建一个日志文件，每次调用您的邮件代码时，将电子邮件的详细信息以及服务器的响应写入其中；然后检查并查看是否可以在看到错误出现时复制问题。

我能看到的唯一可能导致它的是 $_POST 是否为空 - 我假设您总是以相同的方式调用脚本，并且您永远不会使用 _GET 参数集链接到它？

# c# - 连接远程服务器的应用程序

> ID：10557015
> 
> 赞同：-3
> 
> 时间：2012-05-11T18:50:01.107
> 
> 标签：c#, java, asp.net, vb.net

**场景：**我想开发一个应用程序。该应用程序应该能够连接到我的远程服务器并将数据下载到本地磁盘，同时下载它应该检查新文件并且只下载新文件同时创建所需的（新）文件夹.

**我在做什么？：**该应用程序首先检查互联网连接，如果可用 ping 服务器以检查服务器是否处于活动状态。然后它必须下载新文件。

**问题：**我不知道如何将服务器中的文件与本地磁盘中的文件进行比较。如何**仅**将服务器中的新文件下载到本地磁盘？

**在想什么？：**如果我可以在本地磁盘中创建与服务器中完全相同的文件夹结构（层次结构）......那么我可以通过在服务器和本地磁盘中维护一些索引文件来将新文件相应地下载到文件夹.

请帮帮我..抽出一些时间..紧急...谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T18:52:53.447

为什么要重新发明`rsync`？

如果您想坚持自己滚动，检查文件之间的不同文件戳或比较内容的 md5 哈希可能是一个好的开始。

# java - 来自 EJB 的最基本的 Php SOAP 请求

> ID：10557020
> 
> 赞同：-1
> 
> 时间：2012-05-11T18:50:34.987
> 
> 标签：java, php, soap, wsdl, ejb

基本的PHP函数：

```
//SOAP CALL
function sayHello(){
    $client = new SoapClient('http://Server:8080/MyClassService/MyClass?WSDL');
    $response = $client->glassfishHello();
    return $response;   
} 
```

（后来我将 sayHello() 作为字符串调用，这就是错误所在）

基本 EJB 提供的 JAX-WS：

```
@WebService
@Stateless
public class MyClass{
  @WebMethod(operationName="glassfishHello")
  public String glassfishHello(){
    return "Hello from GlassFish";
  }
} 
```

我一定遗漏了一些非常简单的东西，但是在用尽了 google 和其他选项之后，我找不到像我需要理解的那样简单的例子。

我的 Php 出现错误：可恢复的致命错误：stdClass 类的对象无法转换为字符串等。

所以我必须在 PHP 中做一些事情来解析来自 WSDL 的响应。

谢谢！（我可以发布 WSDL 或任何其他资源）是的，我确实启用了 SOAP 并且可以正常工作。

* * *

是的，我的问题是返回的是什么类型的对象。我希望我的 sayHello() 函数返回一个字符串。如果我投 $response = (string).. 那么我有错误。

* * *

**回答：** 我知道这很简单，只是一个愚蠢的 PHP 错误，我上次使用 PHP 已经太久了：

```
//SOAP CALL
function sayHello(){
    $client = new SoapClient('http://Server:8080/MyClassService/MyClass?WSDL');
    $response = (array) $client->glassfishHello();      
    return $response['return'];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:26:37.120

我知道这很简单，只是一个愚蠢的 PHP 错误，距离我上次使用 PHP 已经太久了：

```
//SOAP CALL
function sayHello(){
    $client = new SoapClient('http://Server:8080/MyClassService/MyClass?WSDL');
    $response = (array) $client->glassfishHello();      
    return $response['return'];
} 
```

# javascript - jquery按钮触发服务器端onclick事件

> ID：10557021
> 
> 赞同：2
> 
> 时间：2012-05-11T18:50:40.440
> 
> 标签：javascript, jquery, asp.net

我正在使用 jquery 对话框，当用户单击确定时，应触发服务器端 onclick 事件，如果单击取消，则什么也没有发生。

我必须通过 preventDefault() 函数在一开始就阻止点击函数。

```
 $(document).ready(function () {
         $("#<%=submit.ClientID %>").click(function (event) {
             event.preventDefault();
                $("#confirm").dialog({
                    buttons: {
                        "OK": function () {  $(this).dialog("close"); 
                              Here should be the code to trigger the server side click event

                     },
                        "Cancel": function () { $(this).dialog("close");},
                    } 
                });
         });
     }); 
```

我不知道如何触发服务器端 onclick 事件。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T12:53:02.030

[https://stackoverflow.com/a/10583339/1202242](https://stackoverflow.com/a/10583339/1202242)

我用了两个按钮，一个是隐藏的。完美解决了我的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T18:56:14.557

将它`event.preventDefault()`放在取消部分或某种条件中，这样它就不会在每次点击时运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T18:57:51.067

我认为您在服务器端和客户端之间感到困惑。如果你想在服务器端触发事件，你需要通知他（可以通过 ajax 调用来完成）。click 事件是客户端事件，不会在服务器端执行任何操作。[尝试在“OK”函数下放置一些代码，以通过ajax](http://api.jquery.com/jQuery.ajax/)调用通知服务器您想要的任何内容。

无论如何，您应该将`event.preventDefault()`呼叫移至“取消”功能。

编辑：处理它的另一种方法是防止提交发生，如果你不想要它。在您的表单标签添加`onsubmit="foo()"` 并定义：

```
function foo(){
   //call your dialog and return true to continue the submit and false to cancel.
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T18:58:35.883

它看起来有点依赖于实现细节（即使它们被广泛使用以至于它们不会被改变）但代码是这样的：

```
__doPostBack('submit','OnClick'); 
```

`OnClick`这将为名为 的控件执行事件处理程序`submit`。作为参考，请查看这个关于[回发如何在 ASP.NET](http://www.xefteri.com/articles/show.cfm?id=18)中工作的小教程。

# mysql - 大拇指向上/向下 Mysql 查询

> ID：10557022
> 
> 赞同：0
> 
> 时间：2012-05-11T18:50:45.460
> 
> 标签：mysql, select

我有两张桌子。

```
my_comment_thumbs [thumb_member_id, Cmt_id, thumb]
my_Comment [id, page, member_id, comment, ip] 
```

对于竖起大拇指，`thumb='1'`，对于竖起大拇指，`thumb='0'`。

[不知道这是否很清楚。]

我一直在努力为每条评论点赞和点赞。

到目前为止我所拥有的[没有完全了解我所拥有的......]

```
SELECT 
SUM(IF(thumb='1', 1, 0)) AS t_up, 
SUM(IF(thumb='0', 1, 0)) AS t_down, 
id, member_id, comment, ip 
FROM my_Comment LEFT OUTER JOIN my_comment_thumbs ON member_id=thumb_member_id 
WHERE page='333' 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:02:41.717

对于 thumb=1 或 thumb =0 ；

```
"SELECT COUNT(*) FROM my_comment_thumbs,my_Comment 
   WHERE   
       my_Comment.id=my_comment_thumbs.Cmt_id 
          AND 
       my_comment_thumbs.thumb=1 
          AND 
       member_id=thumb_member_id;" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:11:35.327

由于我没有可以对其进行测试的数据设置，因此我认为这将起作用-但未经测试：

```
SELECT 
    (SELECT count(thumb) FROM my_comment_thumbs WHERE thumb=1) as t_up, 
    (SELECT count(thumb) FROM my_comment_thumbs WHERE thumb=0) as t_down, 
    id, member_id, comment, ip 
FROM my_Comment 
LEFT OUTER JOIN my_comment_thumbs ON member_id=thumb_member_id 
WHERE page='333' 
```

希望有帮助。

# django - django测试失败时如何调用ipdb？

> ID：10557024
> 
> 赞同：10
> 
> 时间：2012-05-11T18:50:49.827
> 
> 标签：django, django-testing

我想在每次测试失败时启动 ipdb。我试过了

```
$ ipython manage.py test myapp --pdb 
```

但不起作用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-07-10T18:10:17.757

如果您`pip install ipdbplugin`and `pip install django-nose`，然后添加`django_nose`到您的`INSTALLED_APPS`and set `TEST_RUNNER = 'django_nose.NoseTestSuiteRunner'`，您可以调用：

```
./manage.py test --ipdb 
```

或者

```
./manage.py test --ipdb-failures 
```

有关详细信息，请参阅[https://github.com/flavioamieiro/nose-ipdb](https://github.com/flavioamieiro/nose-ipdb)和[https://github.com/django-nose/django-nose](https://github.com/django-nose/django-nose)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:00:59.973

您可以使用[django-pdb](http://pypi.python.org/pypi/django-pdb)应用程序。仅安装在您的设置项目中

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T20:26:36.640

您需要安装[`nose`](http://readthedocs.org/docs/nose/en/latest/) 和[`django-nose`](http://pypi.python.org/pypi/django-nose)软件包。为项目配置后`django-nose`，默认的测试运行器和`test`管理命令将通过`nose`测试运行器支持得到加强。

这是命令输出的[要点，](https://gist.github.com/2597247)`python manage.py help test`它显示了设置后运行测试所获得的令人印象深刻的选项列表。

# php - 使用 PHP 获取远程主机状态信息和详细信息

> ID：10557027
> 
> 赞同：0
> 
> 时间：2012-05-11T18:51:04.887
> 
> 标签：php, status

我正在寻找使用 PHP 从远程服务器获取服务器详细信息。我知道我可以通过获取标题来获取一些详细信息，但我也想获得服务器的正常运行时间、带宽使用情况等。如果你能告诉我如何做到这一点或指出我正确的方向，我将不胜感激.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:03:29.233

你试过这个吗？

[http://phpsysinfo.sourceforge.net/](http://phpsysinfo.sourceforge.net/) 或 [http://www.zabbix.com/](http://www.zabbix.com/)

Zabbix 是专业的开源网络监控系统，运行良好，可以为您提供所需的所有信息。它的前端完全用 PHP 编写，因此您可以按照自己的方式入侵它。

**编辑：**

基本上，如果不在服务器上安装一些可以为您监控这些参数并返回给您的程序或工具，您将无法获得您正在寻找的所有信息。可能你可以`uptime`通过使用 exe() 或类似的东西执行命令来获得“”，`uptime`但对于带宽使用，我认为除非你通过在 php 脚本中在后台触发一些命令来获得它，否则我认为很难获得它。一些可能会帮助您做到这一点的实用程序将是`ifstat`或者`iftop`默认情况下它们不会安装在基于 ubuntu/debian 的系统上，因此如果您想使用它们，您需要安装它们，因此无法访问机器。

# oracle - 在 Oracle 中创建视图时更改列精度

> ID：10557030
> 
> 赞同：3
> 
> 时间：2012-05-11T18:51:06.587
> 
> 标签：oracle, view, precision, varchar

```
 CREATE OR REPLACE VIEW USER_AUD_VIEW ("AUDIT_ID", "USER_ID", "TABLE_NAME_TXT",      "COLUMN_NAME_TXT", "OLD_VALUE_TXT", "NEW_VALUE_TXT", "AUDIT_LAST_UPDATED_DT", "AUDIT_UPDATED_USER_ID", "EVALUATOR_ID", "PRODUCT_ID")
 AS
   SELECT acm.audit_id,
GET_TOKEN(GET_TOKEN(acm.PRIMARY_KEY_VALUES,1,','),2,':') AS user_id,
acm.table_name_txt,
acm.column_name_txt,
CASE
  WHEN UPPER(acm.column_name_txt) = 'PASSWORD_TXT'
  THEN '******'
  ELSE acm.old_value_txt
END AS old_value_txt,
CASE
  WHEN UPPER(acm.column_name_txt) = 'PASSWORD_TXT'
  THEN '******'
  ELSE acm.new_value_txt
END AS new_value_txt,
acm.audit_last_updated_dt,
CASE
  WHEN UPPER(acm.audit_updated_user_id) = 'UNKNOWN'
  THEN acm.audit_updated_user_id
  ELSE (users.user_id
    || ' ('
    || DECODE(users.last_name_txt, NULL,' ' , users.last_name_txt)
    || ', '
    || DECODE(users.first_name_txt, NULL,'' , users.first_name_txt)
    || ')' )
END    
AS audit_uupdated_user_id,
acm.evaluator_id,
TO_NUMBER(GET_TOKEN(GET_TOKEN(acm.PRIMARY_KEY_VALUES,2,','),2,':')) AS product_id

   FROM audit_config_maintenance acm,
users
   WHERE acm.table_name_txt             in ('USERS','XREF_USER_PRODUCT')
   AND UPPER(acm.audit_updated_user_id) = UPPER(users.user_id)
   AND acm.primary_key_values is not null 
```

如上所述创建视图时，get_token() 函数将列类型设为 varchar2(4000)。如何更改命令以使该字段成为 varchar2(64) ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T19:15:50.340

您可以使用该`CAST`功能，即`CAST( GET_TOKEN(GET_TOKEN(acm.PRIMARY_KEY_VALUES,1,','),2,':') AS VARCHAR2(64)`

如果你创建一个函数

```
SQL> create or replace function my_function
  2    return varchar2
  3  is
  4  begin
  5    return 'foo';
  6  end;
  7  /

Function created. 
```

然后选择此函数的简单视图将具有`VARCHAR2(4000)`数据类型。

```
SQL> create or replace view v1 as select my_function col1 from dual;

View created.

SQL> desc v1;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 COL1                                               VARCHAR2(4000) 
```

但是，如果您将调用包装在 a`CAST`中，则长度会更改

```
SQL> ed
Wrote file afiedt.buf

  1  create or replace view v2
  2  as
  3  select cast( my_function as varchar2(10) ) col1
  4*   from dual
SQL> /

View created.

SQL> desc v2;
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 COL1                                               VARCHAR2(10) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T19:16:41.970

使用强制转换功能。在这种情况下，用 cast 包裹 get_toklen

```
 CAST(GET_TOKEN(GET_TOKEN(acm.PRIMARY_KEY_VALUES,1,','),2,':') as varchar2(64)) AS user_id 
```

# c# - 任何人都知道一个好的 C# 代码 Profiler / Analizer 来帮助优化 Web 服务

> ID：10557032
> 
> 赞同：0
> 
> 时间：2012-05-11T18:51:24.667
> 
> 标签：c#, web-services, optimization

我有一个非常需要优化的网络服务。它位于驻留在虚拟服务器机器上的企业应用程序上，并且正面临巨大的瓶颈。我对自己的技能充满信心，并且能够提高效率，但我想知道是否有人在使用分析器或优化工具方面有很好的经验，可以帮助我指出问题点。

webservices 的主要功能是生成使用 Sql Reports 和第三方 PDF Writer 实用程序创建的 PDF。基本上，它获取一个 ID 并根据与该 ID 关联的表单数量创建 X 个 PDF。所以它有一个循环，平均可以运行8次/ID，每天有数千个ID发送。毋庸置疑，总有一个待创建的 PDF 积压日志，客户不希望看到这些日志。

我还考虑过运行多线程来异步生成 PDF 页面，但我很犹豫，因为他们说他们在“虚拟服务器”上存在多线程问题。因此，如果有人可以向我指出一个好的教程或关于虚拟服务器上的多线程的建议，我也会很感激。

谢谢你提供的所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T18:56:35.570

我以前用过这个，它很棒：

JetBrains dotTrace

[http://www.jetbrains.com/profiler/whatsnew/](http://www.jetbrains.com/profiler/whatsnew/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:07:43.783

I would suggest taking a look at ANTS Memory & Performance Profiler from Red Gate:

*   [ANTS Memory Profiler](http://www.red-gate.com/products/dotnet-development/ants-memory-profiler/)
*   [ANTS Performance Profiler](http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/)

The ANTS profilers do a fantastic job of identifying bottlenecks and memory leaks. They're not free, but they're very affordable and offer fully functional trials so you can evaluate the products.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T19:09:24.180

There are other profilers: ANTS: [http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/](http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/)

Which can also profile SQL calls. They also have an EAP open at the moment which gives you more functionality for database calls, that is here: [http://help.red-gate.com/help/ANTSPerformanceProfiler/download_eap.html](http://help.red-gate.com/help/ANTSPerformanceProfiler/download_eap.html)

There is YourKit: [http://www.yourkit.com/](http://www.yourkit.com/)

Visual Studio has a profiler too but not as good.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T19:03:31.243

试试[Telerik 的 JustTrace](http://www.telerik.com/products/memory-performance-profiler.aspx)，它有很多简洁的东西。它有 60 天的免费试用支持，因此您可以先试用。

**快速分析**

*JustTrace 旨在重新定义快速内存和性能分析。它为分析的应用程序增加了最小的开销，允许近乎无缝的执行，并支持就地分析，从而消除了将应用程序从其环境中移动的需要。用户可以通过在整个生命周期内快速拍摄多个快照来检查应用程序行为的不同阶段。*

**量身定制的配置文件**

*JustTrace 提供三种不同的分析器——采样、内存和跟踪——甚至可以满足最苛刻的分析要求。*

**分析已经运行的进程**

*JustTrace 允许不显眼地附加到实时进程。如果应用程序开始遇到更高的内存或 CPU 消耗，对其状态的分析可以处理难以重现的场景。*

**简单而直观的用户界面**

*根据定义，内存和性能分析工具应该使您能够加快应用程序的性能，而不会减慢您的速度或陷入困境。JustTrace 采用简约但高度直观的用户界面，可以轻松导航性能和内存结果。从选择要分析的应用程序到深入分析 JustTrace 的分析见解，只需几个简单的步骤即可。内存和性能分析从未如此简单。*

**实时分析**

*JustTrace 可以实时监控应用程序的执行。对应用程序行为的近距离观察将潜在的性能瓶颈暴露出来，并提供值得研究的应用程序阶段的可靠提示。*

**独立工具和无缝 Visual Studio 集成**

*JustTrace 提供与 Visual Studio 的无缝集成，也可用作独立工具。将 JustTrace 集成到 Visual Studio 的 UI 中，通过减少在开发环境和工具之间跳转所需的时间来测试由此产生的内存和 CPU 利用率改进，从而消除了繁重的步骤。只需修改代码，然后通过 Visual Studio UI 运行它，即可在单个工具窗口中获得 JustTrace 的核心功能。*

**分析多种应用程序类型**

*JustTrace 支持对本地应用程序、正在运行的应用程序、Silverlight 应用程序和本地 ASP .NET 网站进行分析。*

# android - 获取 ClassNotFound

> ID：10557033
> 
> 赞同：0
> 
> 时间：2012-05-11T18:51:28.260
> 
> 标签：android, noclassdeffounderror, runtimeexception

我收到了来自`LogCat`

```
 dalvikvm(526): Could not find class 'com.temp.pt.database.DBHelper',
 referenced from method com.temp.pt.database.DBUtils.getDBHelper 
```

之后我有了这个

```
05-11 21:46:25.305: E/AndroidRuntime(526): FATAL EXCEPTION: main
05-11 21:46:25.305: E/AndroidRuntime(526): java.lang.NoClassDefFoundError: com.temp.pt.database.DBHelper
05-11 21:46:25.305: E/AndroidRuntime(526):  at com.temp.pt.database.DBUtils.getDBHelper(DBUtils.java:20)
05-11 21:46:25.305: E/AndroidRuntime(526):  at com.temp.pt.CategoriesFragment$CategoryAsyncLoader.<init>(CategoriesFragment.java:169)
05-11 21:46:25.305: E/AndroidRuntime(526):  at com.temp.pt.CategoriesFragment.onCreateLoader(CategoriesFragment.java:76)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.support.v4.app.LoaderManagerImpl.createLoader(LoaderManager.java:486)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.support.v4.app.LoaderManagerImpl.createAndInstallLoader(LoaderManager.java:495)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.support.v4.app.LoaderManagerImpl.initLoader(LoaderManager.java:549)
05-11 21:46:25.305: E/AndroidRuntime(526):  at com.temp.pt.CategoriesFragment.onActivityCreated(CategoriesFragment.java:45)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:891)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1080)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1062)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.support.v4.app.FragmentManagerImpl.dispatchActivityCreated(FragmentManager.java:1810)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.support.v4.app.FragmentActivity.onStart(FragmentActivity.java:501)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1133)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.app.Activity.performStart(Activity.java:4475)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1929)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.os.Looper.loop(Looper.java:137)
05-11 21:46:25.305: E/AndroidRuntime(526):  at android.app.ActivityThread.main(ActivityThread.java:4424)
05-11 21:46:25.305: E/AndroidRuntime(526):  at java.lang.reflect.Method.invokeNative(Native Method)
05-11 21:46:25.305: E/AndroidRuntime(526):  at java.lang.reflect.Method.invoke(Method.java:511)
05-11 21:46:25.305: E/AndroidRuntime(526):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-11 21:46:25.305: E/AndroidRuntime(526):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-11 21:46:25.305: E/AndroidRuntime(526):  at dalvik.system.NativeStart.main(Native Method) 
```

注意我已经定义了类并且应用程序编译没有错误但在运行时崩溃。有什么建议，这个问题的解决方案？

# objective-c - 使用正则表达式在 NSString 中查找日期和时间

> ID：10557035
> 
> 赞同：0
> 
> 时间：2012-05-11T18:51:29.480
> 
> 标签：objective-c, ios, nsstring, regexkitlite

我想做类似于这个问题的事情：[regular expression in ruby​​ for strings with multiple patterns](https://stackoverflow.com/questions/5933498/regular-expression-in-ruby-for-strings-with-multiple-patterns)

但我想做`Objective-C`。基本上我想从一个带有日期和时间的字符串中提取日期和时间`@`。

例如我有一个字符串: `Feed the Rabbits @12`，我想在 之后提取日期和时间，问题是字符串可以变化，`@`例如它可以`@12:00`是 、`@04/02/12`、或只是。这是我当前从字符串中提取数字的代码（它不检测“/”或“:”，所以如果字符串是它只会提取，因为它在“/”处停止）。`@04/02/12 12:00``@04/02/12 12:00``@04/02/12``@04/02/12``@04`

我也可以`@12:00`使用这个 RegEx 模式提取部分`@([0-9]+:[0-9][0-9])`。

```
NSString *regEx = @"@(\\d+)";

NSString *dateString;
r = [inputString rangeOfString:regEx options:NSRegularExpressionSearch];
if (r.location != NSNotFound) 
{
    dateString = [NSString stringWithFormat:@"%@",[inputString substringWithRange:r]];
    return dateString;
} 
else 
{
    return @"";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T05:24:59.863

正则表达式 "@(\d+)" 找到一个 "@" 后跟一个或多个数字（并且只捕获数字）。如果您希望它查找数字和斜线、破折号、冒号等，则需要将它们包含在正则表达式中。如果要查找特定的数字和标点符号模式，则需要多个用“或”（即`|`字符）连接的子表达式。

预测所有可能的方式来表达日期和/或时间是一项艰巨的工作，特别是如果您想支持多个语言环境。您可能会发现让您的正则表达式捕获“@”之后的任何内容更可行（如果您不确定如何执行此操作，[NSRegularExpression](https://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)文档应该会有所帮助）。然后您可以将字符串传递给[NSDateFormatter](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html)以解析为日期。

# java - 尝试从线程启动动画时出现 CalledFromWrongThreadException

> ID：10557036
> 
> 赞同：0
> 
> 时间：2012-05-11T18:51:30.820
> 
> 标签：java, android, multithreading

我想从列表中删除一个对象，同时我想为用户制作一个淡出动画......

删除函数创建一个`Thread`，在线程中我尝试启动动画，但我得到了那个异常：

```
android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that      created a view hierarchy can touch its views. 
```

关于活动：

```
private Animation animation;
private AnimationListener al;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.test);
    animation = AnimationUtils.loadAnimation(this, R.anim.fade_out);                
    al = new AnimationListener() {

        public void onAnimationStart(Animation animation) {
        // do nothing       
        }

        public void onAnimationRepeat(Animation animation) {
        // do nothing       
        }

        public void onAnimationEnd(Animation animation) {
            TableRow tr = (TableRow) findViewById(R.id.test);                   
            tr.setVisibility(View.GONE);
        }

    };

    animation.setAnimationListener(al);                             
    animation.reset();            
} 
```

当用户按下删除图标时，他将到达这里：

```
public void remove(View v) {         
    RemoveF rf = new RemoveF();
    rf.start();
} 
```

我的胎面从这里开始：

```
class RemoveF extends Thread {
    private boolean running;

    public void run() {
        running = true;
        try {
            do {
                //business logic goes here
                TableRow tr = (TableRow) findViewById(R.id.test);
                tr.setAnimation(animation);
                tr.startAnimation(animation);
                stopRunning();
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException ie) {
                    // do nothing
                }
            } while (running);
        } catch (Exception e) {
            Log.e("RemoveF", "Exception", e);
        }
    }

    public void stopRunning() {
        running = false;
    } 
} 
```

知道我该怎么做吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T18:58:54.843

这里`TableRow tr = (TableRow) findViewById(R.id.test);`

您正在尝试从另一个线程访问 UI 元素。

使用`runOnUiThread`or`Handler`用于从线程更新 UI

# iphone - 呈现两个嵌套的模态视图控制器，但只显示最后一个转换

> ID：10557040
> 
> 赞同：0
> 
> 时间：2012-05-11T18:52:04.150
> 
> 标签：iphone, modalviewcontroller

我有一个应该是模态的第一个 VC（视图控制器），它有一个子模态 VC，有时应该在第一个 VC 出现时立即呈现，但有时不会。因此，我想从根 VC 呈现第一个 VC，并在第一个 VC 上呈现子模态 VC。但是用户应该只看到子 VC 模态转换（不是第一个 VC）。

AFAIK 第一个 VC 只能在 viewDidAppear: 之后呈现一个模态 VC，所以我不知道如何做到这一点，因为当 viewDidAppear: 被调用时，第一个 VC 已经对用户可见。

不希望用户一个接一个地看到 2 个模态转换，而只是看到最后一个模态转换，即孩子的一个。

有什么提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-13T01:24:35.500

如果您还没有找到合适的解决方案，我想出了最简单的解决方案。您可以使用 UINavigationController 来保存您尝试以模态方式显示的 2 个嵌套视图控制器。

在用于显示模态视图的函数中，您可以执行以下操作：

```
- (IBAction)showView3
{

    ViewController2 *new2 = [[ViewController2 alloc] init];   
    ViewController3 *new3 = [[ViewController3 alloc] init];

    UINavigationController *nav = [[UINavigationController alloc] initWithRootViewController:new2];
    nav.navigationBarHidden = YES;
    [nav pushViewController:new3 animated:NO];
    [self presentModalViewController:nav animated:YES];
} 
```

然后在 ViewController3 中运行以将其关闭：

```
[self.navigationController popViewControllerAnimated:YES]; 
```

而 ViewController2 中的一个将具有：

```
[self dismissModalViewControllerAnimated:YES]; 
```

我能看到的唯一问题是美学，因为默认情况下，从 view3 到 view2 的过渡是水平动画，但从 view2 到 view1 的过渡是垂直的。您当然也可以更改它以使它们全部水平，或全部垂直，或者您想要的任何方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T18:59:41.090

您可以有 1 个带有 2 个视图的模态视图控制器。然后只需选择要在视图控制器加载时显示的视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T19:00:32.173

您应该能够将 presentModalViewController 放在任何您想要的位置，包括 viewWillAppear。

```
[self presentModalViewController:myModalViewController animated:NO]; 
```

编辑：对于阅读本文的任何人，请参阅我的另一个（正确）答案，因为这个答案不是。

# excel - JasperReports：如何在 Excel 中定义标题

> ID：10557045
> 
> 赞同：1
> 
> 时间：2012-05-11T18:52:30.820
> 
> 标签：excel, jasper-reports

我正在清理一个使用 Jasper Reports 3.1.2 的遗留应用程序，并试图弄清楚如何定义一个在生成的 Excel 电子表格中显示为页眉的页眉（在页面设置、页眉/页脚下）。现有代码已经使用以下方法为页脚执行此操作：

```
exportParameters.put(JRXlsAbstractExporterParameter.LEFT_FOOTER, "My footer text"); 
```

我在 JRXlsAbstractExporterParameter 类中找不到标头的等效参数。有没有办法在 JRXML 模板中或通过 API 做到这一点？

从生成的 Excel 报告中添加一个屏幕截图，显示 Excel 检测到在 JRXlsAbstractExporterParameter 类（上面的代码）中定义的页脚。我正在尝试对标题做同样的事情。

![在此处输入图像描述](../Images/0d21778feb765b2c71d3ba557b9e5378.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T00:29:46.853

查看**[JasperForge 配置参考](http://jasperforge.org/uploads/publish/jasperreportswebsite/trunk/config.reference.html#net.sf.jasperreports.export.xls.sheet.header.center)**，直到 3.7.5 才支持 JRXML 页眉和页脚属性。在我看来，升级到至少版本 3.7.5 来完成您正在尝试的操作、更新您的 jrxml 文件以及使用您现有的报告进行回归测试会更容易。如果无法升级并且您熟悉 POI 或 JExcelAPI，我建议您扩展**[JRXlsExporter](http://grepcode.com/file/repo1.maven.org/maven2/jasperreports/jasperreports/3.1.2/net/sf/jasperreports/engine/export/JRXlsExporter.java?av=f)**或**JRExcelApiExporter**（仅限于两个链接...抱歉）并在您的 API 中使用自定义导出器参数。

您使用的 Jasper Reports 版本确实限制了您在 excel 中可以执行的操作。如果您进行升级，您可能需要研究 4.0 以上版本中可用的 XLS 属性。如果您要对现有报告进行更多特定于 Excel 的格式设置，升级到高于 4.0 的版本会更有利。

# ios - 从 iPad Magazine App 入手，如何做阅读器

> ID：10557054
> 
> 赞同：1
> 
> 时间：2012-05-11T18:53:36.817
> 
> 标签：ios, ipad

我需要开始开发一个应用程序来为 iPad 发布交互式杂志。但是，我不知道如何使读者。我一直在使用网络视图来显示普通的 pdf，但是现在我需要使用使用 Adob​​e Indesign 创建的杂志。一直在寻找，除了已经提供自己的发布应用程序的企业之外，没有发现任何东西。

如果有人能指出我可以开始的地方，我已经看过一个非常好的教程来设置商店和可能的图书馆：

[http://ios-blog.co.uk/articles/tutorials/how-to-make-a-magazine-app-in-ios-part-i/](http://ios-blog.co.uk/articles/tutorials/how-to-make-a-magazine-app-in-ios-part-i/)

但我不认为 QuickLook 是我需要的读者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:46:21.177

看看这个 PDF 渲染库： http: [//pspdfkit.com/](http://pspdfkit.com/)

我们在一个类似的应用程序中使用它，并且非常高兴。Peter Steinberger（作者）也给予了很大的支持，非常有帮助。在购买此库之前，我编写了自己的 PDF 渲染器，我可以向您保证，购买 Pete 的库要便宜得多。否则，您将花费数月时间对其进行优化，使其能够在 iPad 1 上运行。

# haskell - 如何提高这个 Haskell 代码的性能？

> ID：10557055
> 
> 赞同：0
> 
> 时间：2012-05-11T18:53:51.683
> 
> 标签：haskell, garbage-collection, set, parallel-processing, lazy-evaluation

我面临以下问题：

从初始集合`[1,2,3,4]`计算所有可能的子集，即`[[1],[2],[3],[4],[1,2],[1,3],[1,4],[2,3],[2,4],[3,4],[1,2,3],[1,2,4],[1,3,4],[2,3,4],[1,2,3,4]]`

我编写了以下`generate.hs`正确的 Haskell 程序。

```
generateSets :: Eq a => [a] -> [[a]] -> [[a]] -> [[a]]
generateSets []  _  _  = []
generateSets src [] _  = let isets = growthup [] src in generateSets src iset iset
generateSets src sets rsets = if null sets' then rsets else generateSets src sets' (rsets++sets')
  where sets' = concatMap (flip growthup src) sets

growthup :: (Eq a) => [a] -> [a] -> [[a]]
growthup ps ss = map (\suf -> ps++[suf]) ss'
  where ss' = nextoccurence ps ss

nextoccurence :: (Eq a) => [a] -> [a] -> [a]
nextoccurence [] ys = ys
nextoccurence xs ys = tail ys'
  where ys' = dropWhile (/= last xs) ys 
```

在 GHC 解释器*ghci*中执行它时...

```
ghci> generate [1,2,3,4] [] []
ghci> [[1],[2],[3],[4],[1,2],[1,3],[1,4],[2,3],[2,4],[3,4],[1,2,3],[1,2,4],[1,3,4],[2,3,4],[1,2,3,4]] 
```

一切都很好，但是对于例如 30 号的小套程序来说，程序花费的时间太长了。

我的问题是：有可能改进我的代码以便从haskell 懒惰或垃圾收集器或其他东西中获得更多？

我的代码是并行性的良好候选者吗？

感谢您的回复！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-12T02:16:06.733

集合有*很多*子集。事实上，一组*n 个*元素有*2 ^n*个子集，所以一组 30 个元素有超过十亿个子集。无论您使用哪种方法来生成它们，即使对结果进行迭代也需要很长时间。对于更大的集合，你几乎可以忘记在宇宙热寂之前经历它们。

因此，您只能在性能方面做很多事情，因为即使将算法速度提高一倍也只会让您同时处理一个更多元素的列表。**对于大多数应用程序，真正的解决方案是避免首先枚举所有子集。**

也就是说，有一种简单的归纳方式来思考子集，这使得定义适当的子集函数变得容易，而无需进行任何相等比较，从而解决了您的实现中的一些问题。

对于基本情况，空集有一个子集：空集。

```
subsets [] = [[]] 
```

对于至少包含一个元素`(x:xs)`的集合，我们有包含该元素的子集和不包含该元素的子集。`x`我们可以通过递归调用来获得不包含的子集，`subsets xs`我们可以通过预先添加这些来获得其余的`x`。

```
subsets (x:xs) = subsets xs ++ map (x:) (subsets xs) 
```

[`subsequences`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/src/Data-List.html#subsequences)in的定义`Data.List`基于相同的原理，但以稍微优化的方式，它也以不同的顺序返回子集并更好地利用共享。然而，正如我所说，枚举长度为 30 的列表的子集无论如何都会很慢，最好的办法是尽量避免一开始就这样做。

# node.js - 如何为hubot设置node_path

> ID：10557056
> 
> 赞同：3
> 
> 时间：2012-05-11T18:54:11.887
> 
> 标签：node.js, coffeescript, hubot

我正在使用 hubot（特别是 hubot-hipchat）并想使用[https://github.com/scriby/asyncblock](https://github.com/scriby/asyncblock)节点模块。在hubot中导入/需要节点模块的正确方法是什么？

我 cd 到我安装 hubot (~/hubot) 的地方并做了

编辑 hubot/packages.json 将 hubot-hipchat,asyncblock 添加到依赖项部分。

```
 "dependencies": {
    "hubot-hipchat": ">= 1.0.4",
    "hubot": "2.1.4",
    "hubot-scripts": ">=2.0.4",
    "optparse": "1.0.3",
    "asyncblock": "2.0.8"
  } 
```

然后我在我的 scripts/test.coffee 脚本中执行以下操作：

```
asyncblock = require('asyncblock') 
```

当我启动hubot时，我收到错误：错误错误：找不到模块'asyncblock'

~/hubot/node_modules/asyncblock 存在。那么我尝试做：

```
require.paths.push('/home/ubuntu/hubot/node_modules') 
```

现在我没有得到找不到错误，但我得到了一个新错误：

```
ERROR Error: require.paths is removed. Use node_modules folders, or the NODE_PATH environment variable instead. 
```

我究竟做错了什么？

我只是想在运行 hubot 的 ubuntu 服务器上执行系统命令：

```
 asyncblock((flow) ->
    exec('node -v', flow.add())
    result = flow.wait()
    msg.send result
  ) 
```

编辑：因此，如果我将 NODE_PATH 环境变量设置为以下内容，则它可以工作：

```
env NODE_PATH="/usr/lib/nodejs:/usr/share/javascript:/home/ubuntu/hubot/node_modules" 
```

为什么不按惯例查看 hubot/node_modules ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T15:03:30.553

你的脚本在哪里`require('asyncblock')`？它在 的子目录中`~/hubot`吗？如果没有，它的`require`功能将不会在`~/hubot/node_modules`.

检查该脚本的值`module.paths`以查看该脚本查看的所有非全局路径`require`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-19T01:02:41.557

这里的问题是您引用了一个未添加到项目中的 npm 模块。从 hubot 文件夹的根目录运行以下代码：

```
npm install --save asyncblock 
```

这会将 asyncblock 保存为 package.json 文件中的依赖项。因此，如果您部署到 heroku 或 open shift 或任何其他云服务，该服务将知道自动下载该模块，以便您的机器人可以使用它。

完成上述任务后

```
asyncblock= require 'asyncblock' 
```

使用咖啡脚本是正确的

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-12T01:23:33.663

这样做要简单得多。我也在使用hubot和hipchat。您需要做的就是：

```
cd hubot-dir;
npm install asyncblock 
```

以下是您应该注意的事项：

```
$ npm install asyncblock
npm http GET https://registry.npmjs.org/asyncblock
npm http 200 https://registry.npmjs.org/asyncblock
npm http GET https://registry.npmjs.org/asyncblock/-/asyncblock-2.0.9.tgz
npm http 200 https://registry.npmjs.org/asyncblock/-/asyncblock-2.0.9.tgz
npm http GET https://registry.npmjs.org/fibers/0.6.7
npm http GET https://github.com/scriby/UglifyJS/tarball/1.2.5-6
npm http 200 https://registry.npmjs.org/fibers/0.6.7
npm http GET https://registry.npmjs.org/fibers/-/fibers-0.6.7.tgz
npm http 200 https://registry.npmjs.org/fibers/-/fibers-0.6.7.tgz
npm http 200 https://github.com/scriby/UglifyJS/tarball/1.2.5-6
npm http GET https://registry.npmjs.org/node-gyp
npm http 200 https://registry.npmjs.org/node-gyp
npm http GET https://registry.npmjs.org/node-gyp/-/node-gyp-0.4.5.tgz
npm http 200 https://registry.npmjs.org/node-gyp/-/node-gyp-0.4.5.tgz
npm http GET https://registry.npmjs.org/ansi
npm http GET https://registry.npmjs.org/glob
npm http GET https://registry.npmjs.org/graceful-fs
npm http GET https://registry.npmjs.org/fstream
npm http GET https://registry.npmjs.org/minimatch
npm http GET https://registry.npmjs.org/rimraf
npm http GET https://registry.npmjs.org/mkdirp
npm http GET https://registry.npmjs.org/nopt
npm http GET https://registry.npmjs.org/semver
npm http GET https://registry.npmjs.org/tar
npm http GET https://registry.npmjs.org/which
npm http GET https://registry.npmjs.org/request
npm http 200 https://registry.npmjs.org/ansi
npm http GET https://registry.npmjs.org/ansi/-/ansi-0.0.4.tgz
npm http 200 https://registry.npmjs.org/graceful-fs
npm http GET https://registry.npmjs.org/graceful-fs/-/graceful-fs-1.1.8.tgz
npm http 304 https://registry.npmjs.org/mkdirp
npm http 200 https://registry.npmjs.org/fstream
npm http GET https://registry.npmjs.org/fstream/-/fstream-0.1.18.tgz
npm http 200 https://registry.npmjs.org/rimraf
npm http GET https://registry.npmjs.org/rimraf/-/rimraf-2.0.2.tgz
npm http 304 https://registry.npmjs.org/nopt
npm http 200 https://registry.npmjs.org/glob
npm http GET https://registry.npmjs.org/glob/-/glob-3.1.9.tgz
npm http 200 https://registry.npmjs.org/semver
npm http GET https://registry.npmjs.org/semver/-/semver-1.0.14.tgz
npm http 304 https://registry.npmjs.org/request
npm http 200 https://registry.npmjs.org/minimatch
npm http GET https://registry.npmjs.org/minimatch/-/minimatch-0.2.5.tgz
npm http 200 https://registry.npmjs.org/which
npm http 200 https://registry.npmjs.org/tar
npm http GET https://registry.npmjs.org/which/-/which-1.0.5.tgz
npm http GET https://registry.npmjs.org/tar/-/tar-0.1.13.tgz
npm http 200 https://registry.npmjs.org/graceful-fs/-/graceful-fs-1.1.8.tgz
npm http 200 https://registry.npmjs.org/ansi/-/ansi-0.0.4.tgz
npm http 200 https://registry.npmjs.org/fstream/-/fstream-0.1.18.tgz
npm http 200 https://registry.npmjs.org/rimraf/-/rimraf-2.0.2.tgz
npm http 200 https://registry.npmjs.org/glob/-/glob-3.1.9.tgz
npm http 200 https://registry.npmjs.org/minimatch/-/minimatch-0.2.5.tgz
npm http 200 https://registry.npmjs.org/semver/-/semver-1.0.14.tgz
npm http 200 https://registry.npmjs.org/which/-/which-1.0.5.tgz
npm http 200 https://registry.npmjs.org/tar/-/tar-0.1.13.tgz
npm http GET https://registry.npmjs.org/abbrev
npm http GET https://registry.npmjs.org/lru-cache
npm http GET https://registry.npmjs.org/inherits
npm http GET https://registry.npmjs.org/inherits
npm http GET https://registry.npmjs.org/inherits
npm http GET https://registry.npmjs.org/block-stream
npm http 304 https://registry.npmjs.org/abbrev
npm http 200 https://registry.npmjs.org/inherits
npm http GET https://registry.npmjs.org/inherits/-/inherits-1.0.0.tgz
npm http 200 https://registry.npmjs.org/inherits
npm http 200 https://registry.npmjs.org/inherits
npm http 200 https://registry.npmjs.org/lru-cache
npm http GET https://registry.npmjs.org/lru-cache/-/lru-cache-1.1.0.tgz
npm http 200 https://registry.npmjs.org/block-stream
npm http GET https://registry.npmjs.org/block-stream/-/block-stream-0.0.5.tgz
npm http 200 https://registry.npmjs.org/inherits/-/inherits-1.0.0.tgz
npm http 200 https://registry.npmjs.org/lru-cache/-/lru-cache-1.1.0.tgz
npm http 200 https://registry.npmjs.org/block-stream/-/block-stream-0.0.5.tgz

fibers@0.6.7 install /tmp/hubot/node_modules/asyncblock/node_modules/fibers
node ./build.js

`linux-ia32` exists; skipping build
asyncblock@2.0.9 ./node_modules/asyncblock
├── uglify-js_scriby@1.2.5-6
└── fibers@0.6.7 (node-gyp@0.4.5) 
```

# android - 降级 Google Play 中的应用程序？（安卓市场）

> ID：10557057
> 
> 赞同：1
> 
> 时间：2012-05-11T18:54:18.103
> 
> 标签：android, apk, google-play

我为市场上传了一个应用程序，然后上传了一个 2.0 版本……但后来我们决定第一个更好，但我无法重新激活 1.0，因为它显示**“错误：APK 版本 1 支持所有与其他设备相同的设备更高版本的 APK。不会提供。请停用 APK。"** 任何如何激活已经上传的1.0？或者如何在eclipse中打开apk（1.0），保存并上传为3.0？（我只有 apk 1.0，因为我在同一个项目中做了 2.0）谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:03:49.560

停用 2.0 版，激活 1.0 版。

我不知道这是否会*降级*已经升级到 2.0 的任何人，但它会阻止任何尚未升级到 2.0 的人。

如果您想确保每个人都从 1.0 版本返回代码，您可能需要将 1.0 重新分发为 3.0，这将保证 2.0 上的人们可以“升级”到旧代码库。

**编辑**：我读得很差。我没有意识到您不再拥有 1.0 版的源代码。在这种情况下，您不能真正将 1.0 重新分发为 3.0

此外，您需要在 google play 中进入“高级”模式才能查看所有以前上传的 APK，这将让您激活/停用您想要的任何一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:13:32.923

不能，你2.0的APK版本高于1.0的APK版本，新的APK应该有更高的APK版本。

[您可以通过反编译](https://stackoverflow.com/questions/3122635/is-it-possible-to-decompile-an-android-apk-file)访问 1.0 的源代码。

# javascript - jQuery 验证和忽略字段

> ID：10557059
> 
> 赞同：8
> 
> 时间：2012-05-11T18:54:23.747
> 
> 标签：javascript, jquery, jquery-ui, datetimepicker

我有一个带有 id 的表单和两个带类的`myform`字段（日期） 。`date`对于这两个字段，我想避免 jquery.validation（ASP .NET MVC3 上的非干扰性 jquery 验证）。我试过了 ：

```
 $('#myform').validate({
        ignore: ".date"
    }); 
```

但是它不起作用，我总是有一个错误（`Please enter a valid date.`）。

我需要帮助！

谢谢，

埃德

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-02-20T13:44:31.150

它对我来说很好，如文档[http://jqueryvalidation.org/validate中所述](http://jqueryvalidation.org/validate)

```
$("#myform").validate({
   ignore: ".ignore"
}); 
```

并且，对于多场使用：

```
$("#myform").validate({
   ignore: ".ignore, .another_class"
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-05-16T10:55:39.107

对于正在尝试此操作的任何人`jquery.validate.unobtrusive`，您可能会发现它忽略了传入的所有选项`$("#myform").validate()`，而您必须将它们设置在对象上：

```
$('#myform').validate().settings.ignore = ".date";
$('#myform').valid(); 
```

Unobtrusive 插件`validate()`在文档加载时调用，它将选项设置为默认值。然后将创建并缓存一个验证器，任何进一步的调用都`validate()`将忽略新选项并返回缓存的验证器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T18:57:19.117

`ignoreTitle`根据[This Doc](http://docs.jquery.com/Plugins/Validation/validate) ，您需要。

# wcf - WCF 4.0 无法从 Java Web 服务反序列化 SOAP

> ID：10557061
> 
> 赞同：1
> 
> 时间：2012-05-11T18:54:42.457
> 
> 标签：wcf

我正在使用 WCF .Net 4.0 来调用用 Java 编写的 Web 服务。WSDL 的一部分引用了 SPML 2.0，我附上了一些代码来描述发生了什么。

对一些 XSD 的 WSDL 引用，我正在使用的部分是

```
<?xml version="1.0" encoding="utf-8"?>
<xsd:schema xmlns:spml="urn:oasis:names:tc:SPML:2:0" xmlns:sec="urn:corp:iam:spml2:security" xmlns="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" targetNamespace="urn:corp:iam:spml2:security" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <xsd:import schemaLocation="../oasis-spml-xsds/pstc_spmlv2_core.xsd" namespace="urn:oasis:names:tc:SPML:2:0" />
  <xsd:complexType name="SuggestUserIDResponseType">
    <xsd:complexContent mixed="false">
      <xsd:extension base="spml:ResponseType">
        <xsd:sequence>
          <xsd:element minOccurs="1" maxOccurs="5" name="uid" type="xsd:string" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
</xsd:schema> 
```

和

```
<?xml version="1.0" encoding="utf-8"?>
<xsd:schema xmlns:spml="urn:oasis:names:tc:SPML:2:0" xmlns="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" targetNamespace="urn:oasis:names:tc:SPML:2:0" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <xsd:complexType name="ExtensibleType">
    <xsd:sequence>
      <xsd:any minOccurs="0" maxOccurs="unbounded" namespace="##other" processContents="lax" />
    </xsd:sequence>
    <xsd:anyAttribute namespace="##other" processContents="lax" />
  </xsd:complexType>
  <xsd:complexType name="ResponseType">
    <xsd:complexContent mixed="false">
      <xsd:extension base="spml:ExtensibleType">
        <xsd:sequence>
          <xsd:element minOccurs="0" maxOccurs="unbounded" name="errorMessage" type="xsd:string" />
        </xsd:sequence>
        <xsd:attribute name="status" type="spml:StatusCodeType" use="required" />
        <xsd:attribute name="requestID" type="xsd:ID" use="optional" />
        <xsd:attribute name="error" type="spml:ErrorCode" use="optional" />
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
</xsd:schema> 
```

所以 WCF 服务引用生成的代理类是

```
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SchemaType1))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ObjectClassDefinitionType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ObjectClassDefinitionReferencesType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ObjectClassDefinitionReferenceType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(AttributeDefinitionReferencesType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(AttributeDefinitionReferenceType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(AttributeDefinitionType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(CapabilityType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(CapabilitiesListType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SchemaEntityRefType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SchemaType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(TargetType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(PSOType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ActiveResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SearchResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ValidatePasswordResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ResetPasswordResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(BatchResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ListTargetsResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(LookupResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ModifyResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(AddResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(AuthenticateUserResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SuggestUserIDResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ResultsIteratorType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SearchQueryType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(NamespacePrefixMappingType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(QueryClauseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(IsActiveType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(LogicalOperatorType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SelectionType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ModificationType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(IdentifierType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(PSOIdentifierType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(RequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ActiveRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ResumeRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SuspendRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(CloseIteratorRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(IterateRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SearchRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ValidatePasswordRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ResetPasswordRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ExpirePasswordRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SetPasswordRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(BatchRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ListTargetsRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(LookupRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(DeleteRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ModifyRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(AddRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(AuthenticateUserRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SuggestUserIDRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(VerifySecurityAnswerRequestType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(CapabilityDataType))]
[System.CodeDom.Compiler.GeneratedCodeAttribute("System.Xml", "4.0.30319.225")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(Namespace="urn:oasis:names:tc:SPML:2:0")]
public partial class ExtensibleType : object, System.ComponentModel.INotifyPropertyChanged {

    private System.Xml.XmlElement[] anyField;

    private System.Xml.XmlAttribute[] anyAttrField;

    /// <remarks/>
    [System.Xml.Serialization.XmlAnyElementAttribute(Order=0)]
    public System.Xml.XmlElement[] Any {
        get {
            return this.anyField;
        }
        set {
            this.anyField = value;
            this.RaisePropertyChanged("Any");
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlAnyAttributeAttribute()]
    public System.Xml.XmlAttribute[] AnyAttr {
        get {
            return this.anyAttrField;
        }
        set {
            this.anyAttrField = value;
            this.RaisePropertyChanged("AnyAttr");
        }
    }

    public event System.ComponentModel.PropertyChangedEventHandler PropertyChanged;

    protected void RaisePropertyChanged(string propertyName) {
        System.ComponentModel.PropertyChangedEventHandler propertyChanged = this.PropertyChanged;
        if ((propertyChanged != null)) {
            propertyChanged(this, new System.ComponentModel.PropertyChangedEventArgs(propertyName));
        }
    }
}

[System.Xml.Serialization.XmlIncludeAttribute(typeof(ActiveResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SearchResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ValidatePasswordResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ResetPasswordResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(BatchResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ListTargetsResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(LookupResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(ModifyResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(AddResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(AuthenticateUserResponseType))]
[System.Xml.Serialization.XmlIncludeAttribute(typeof(SuggestUserIDResponseType))]
[System.CodeDom.Compiler.GeneratedCodeAttribute("System.Xml", "4.0.30319.225")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(Namespace="urn:oasis:names:tc:SPML:2:0")]
public partial class ResponseType : ExtensibleType {

    private string[] errorMessageField;

    private StatusCodeType statusField;

    private string requestIDField;

    private ErrorCode errorField;

    private bool errorFieldSpecified;

    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute("errorMessage", Order=0)]
    public string[] errorMessage {
        get {
            return this.errorMessageField;
        }
        set {
            this.errorMessageField = value;
            this.RaisePropertyChanged("errorMessage");
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlAttributeAttribute()]
    public StatusCodeType status {
        get {
            return this.statusField;
        }
        set {
            this.statusField = value;
            this.RaisePropertyChanged("status");
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlAttributeAttribute(DataType="ID")]
    public string requestID {
        get {
            return this.requestIDField;
        }
        set {
            this.requestIDField = value;
            this.RaisePropertyChanged("requestID");
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlAttributeAttribute()]
    public ErrorCode error {
        get {
            return this.errorField;
        }
        set {
            this.errorField = value;
            this.RaisePropertyChanged("error");
        }
    }

    /// <remarks/>
    [System.Xml.Serialization.XmlIgnoreAttribute()]
    public bool errorSpecified {
        get {
            return this.errorFieldSpecified;
        }
        set {
            this.errorFieldSpecified = value;
            this.RaisePropertyChanged("errorSpecified");
        }
    }
}

[System.CodeDom.Compiler.GeneratedCodeAttribute("System.Xml", "4.0.30319.225")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(Namespace="urn:corp:iam:spml2:security")]
public partial class SuggestUserIDResponseType : ResponseType {

    private string[] uidField;

    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute("uid", Order=0)]
    public string[] uid {
        get {
            return this.uidField;
        }
        set {
            this.uidField = value;
            this.RaisePropertyChanged("uid");
        }
    }
} 
```

在其中一个服务调用中，返回的 SOAP 消息是

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <ns3:suggestUserIDResponse status="success" requestID="MyApp" xmlns="urn:oasis:names:tc:SPML:2:0" xmlns:ns2="urn:oasis:names:tc:SPML:2:0:password" xmlns:ns3="urn:corp:iam:spml2:security" xmlns:ns4="urn:oasis:names:tc:SPML:2:0:suspend" xmlns:ns5="urn:oasis:names:tc:SPML:2:0:search" xmlns:ns6="urn:oasis:names:tc:SPML:2:0:DSML" xmlns:ns7="urn:oasis:names:tc:DSML:2:0:core" xmlns:ns8="urn:oasis:names:tc:SPML:2:0:batch">
         <ns3:uid>text1</ns3:uid>
         <ns3:uid>text2</ns3:uid>
         <ns3:uid>text3</ns3:uid>
      </ns3:suggestUserIDResponse>
   </soap:Body>
</soap:Envelope> 
```

那时 SOAP 没有`SuggestUserIDResponseType`正确反序列化为类，`SuggestUserIDResponseType.uid`始终为空，但重复的 uid 仅`SuggestUserIDResponseType.Any`作为`XmlElement`数据类型出现。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-30T21:00:12.390

我刚刚遇到了同样的问题。看起来问题与用`public System.Xml.XmlElement[] Any`属性修饰的`XmlAnyElementAttribute`属性与`Order`限定符集的组合有关。也可能仅在从具有`XmlElement[] Any`数组的基类继承时才会发生。

***在我的情况下，解决方案是在所有继承的类***`XmlElementAttribute`中删除attibutes、`XmlAnyElementAttribute`attributes 和`MessageBodyMemberAttribute`attributes中的 Order 限定符。

 *注意：粗斜体字很重要，否则你会得到类似的错误：

> “ABC_Type”中声明的类型成员“XYZ”缺少必需的“订单”属性。如果类层次结构中的一个类使用显式排序特性（Order），那么它的基类和所有派生类都必须这样做

我还没有进行研究以检查可能产生的副作用 - 一件重要的事情大概是让你的属性在你的类中以正确的顺序排列，以便序列化以正确的顺序发生。

希望这可以帮助某人。*

# c# - 如何使用 C# for Flickr API 获取用户 ID？

> ID：10557062
> 
> 赞同：0
> 
> 时间：2012-05-11T18:54:43.020
> 
> 标签：c#, asp.net, flickr

我正在使用 Flickr API 为我的学校项目检索用户图像。

我已经使用搜索框使用用户输入的关键字来获取图像，以添加我想默认显示用户图像的额外功能，因为我需要获取用户 ID，但我没有得到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T22:28:01.147

有一个您可能感兴趣的 Flickr C# 库。它被称为[FlickrNet](http://flickrnet.codeplex.com/)，并附带一些[示例应用程序](http://flickrnet.codeplex.com/wikipage?title=Examples&referringTitle=Home)的源代码。

另外，看看[这个](http://hectorcorrea.com/Blog/Flickr-Library-in-C-Sharp)Flickr API wrapper for C#。它是一个轻量级的类，可帮助您执行一些基本功能，例如检索用户集和有关集中用户照片的信息。

# java - SVN：如何判断您的工作副本从哪个目录签出

> ID：10557063
> 
> 赞同：1
> 
> 时间：2012-05-11T18:54:43.283
> 
> 标签：java, svn, ant

我继承了一个 Web 应用程序，其中原始开发人员刚刚升级并退出，我正在尝试启动一个包含零（无）文档的版本。

系统刚刚授予我对服务器（CentOS 机器）的访问权限，我位于目录中，该目录是 SVN 存储库中项目的工作副本。我在终端并试图弄清楚如何使用`svninfo`来告诉我当前目录在 repo 中的哪个位置是工作副本。

这可能吗？如果不是，我的其他选择是什么？仅供参考，我可以通过终端访问工作副本、`svn update`作为工作副本然后从中构建应用程序的 build.xml Ant 脚本，以及对 SVN 服务器本身的 Eclipse SVN 存储库访问。我只是从 CVS 领域快速过渡，不知道如何判断项目从哪个目录签出。

提前致谢。

# qt - 在 QML 中动态地重新设置对象在初始加载时失败

> ID：10557065
> 
> 赞同：4
> 
> 时间：2012-05-11T18:54:59.123
> 
> 标签：qt, qml

我正在尝试根据从模型继承的数据动态地重新定义中继器中生成的 QML 对象。

这就像一个魅力 - 一次捕获。第一次生成对象时，在状态的 ParentChange 对象进行更改*后，它会自动重新设置为 Repeater 的父级。*在 QML 查看器中运行以下 QML 文件，注意控制台消息的顺序以查看我所描述的内容。

单击每个对象后，它们的行为与预期相同。

```
import QtQuick 1.1

Rectangle {
    id: container
    height: 300
    width: 300

    signal completed

    ListModel {
        id: fooModel
        ListElement { data: "red" }
        ListElement { data: "red" }
        ListElement { data: "blue" }
    }

    Component.onCompleted: {
        console.log("Rect Completed!")
        container.completed()
    }

    // The object I want to dynamically move
    Component {
        id: delg
        Rectangle {
            id: moveable
            height: 40; width: 100
            border.width: 1; border.color: "black"
            state: model.data
            color: state

            // The following code makes it work, but feels very hackish
            /*Connections {
                target: container
                onCompleted: {
                    moveable.parent = moveable.state == "red" ? red_col : blue_col
                }
            }*/

            onStateChanged: { console.log("New state: " + state) }
            onParentChanged: { console.log("New parent: " + parent) }
            Component.onCompleted: { console.log("Delegate Completed!") }

            MouseArea {
                anchors.fill: parent
                onClicked: {
                    // I know this is bad to do, but in my REAL application,
                    // the change is triggered through the model, not the qml
                    // object
                    moveable.state = (moveable.state == "red" ? "blue" : "red")
                }
            }

            states: [
                State {
                    name: 'red'
                    ParentChange { target: moveable; parent: red_col; x: 0 }
                },
                State {
                    name: 'blue'
                    ParentChange { target: moveable; parent: blue_col; x: 0 }
                }
            ]

            transitions: [ Transition {
                    ParentAnimation {
                        NumberAnimation { properties: 'x,y,height,width' }
                    }
            }]
        }
    }

    // Generates the Objects
    Repeater {
        id: repeat
        model: fooModel
        delegate: delg
    }

    // Display
    Row {
        spacing: 100
        Column {
            id: red_col
            spacing: 10
            width: 100; height: 300
            move: Transition { NumberAnimation { properties: "y" } }
            add: Transition { NumberAnimation { properties: "y" } }
        }
        Column {
            id: blue_col
            spacing: 10
            width: 100; height: 300
            move: Transition { NumberAnimation { properties: "y" } }
            add: Transition { NumberAnimation { properties: "y" } }
        }
    }

} 
```

我想出了一种解决这种行为的方法，但它并不漂亮。（有关该修复，请参阅上面注释掉的“连接”代码）。

有没有一种更干净/更简洁的方法来完成我在这里尝试的同样事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:03:48.503

`Item`简单的方法是在您的代表下放置额外的东西。这将导致`Repeater`reparent`Item`并且您自己的代码将设置其子元素的新父元素，即您的`Rectangle`元素。像这样：

```
import QtQuick 1.1
Rectangle {
    id: container
    height: 300
    width: 300

    signal completed

    ListModel {
        id: fooModel
        ListElement { data: "red" }
        ListElement { data: "red" }
        ListElement { data: "blue" }
    }

    Component.onCompleted: {
        console.log("Rect Completed!")
        container.completed()
    }

    // The object I want to dynamically move
    Component {
        id: delg
        Item { 
            Rectangle {
                id: moveable
                height: 40; width: 100
                border.width: 1; border.color: "black"
                state: model.data
                color: state

                // The following code makes it work, but feels very hackish
                /*Connections {
                    target: container
                    onCompleted: {
                        moveable.parent = moveable.state == "red" ? red_col : blue_col
                    }
                }*/

                onStateChanged: { console.log("New state: " + state) }
                onParentChanged: { console.log("New parent: " + parent) }
                Component.onCompleted: { console.log("Delegate Completed!") }

                MouseArea {
                    anchors.fill: parent
                    onClicked: {
                        // I know this is bad to do, but in my REAL application,
                        // the change is triggered through the model, not the qml
                        // object
                        moveable.state = (moveable.state == "red" ? "blue" : "red")
                    }
                }

                states: [
                    State {
                        name: 'red'
                        ParentChange { target: moveable; parent: red_col; x: 0 }
                    },
                    State {
                        name: 'blue'
                        ParentChange { target: moveable; parent: blue_col; x: 0 }
                    }
                ]

                transitions: [ Transition {
                        ParentAnimation {
                            NumberAnimation { properties: 'x,y,height,width' }
                        }
                }]
            }
        }
    }

    // Generates the Objects
    Repeater {
        id: repeat
        model: fooModel
        delegate: delg
    }

    // Display
    Row {
        spacing: 100
        Column {
            id: red_col
            spacing: 10
            width: 100; height: 300
            move: Transition { NumberAnimation { properties: "y" } }
            add: Transition { NumberAnimation { properties: "y" } }
        }
        Column {
            id: blue_col
            spacing: 10
            width: 100; height: 300
            move: Transition { NumberAnimation { properties: "y" } }
            add: Transition { NumberAnimation { properties: "y" } }
        }
    }
} 
```

# ruby-on-rails - 如何保持一个数组代表它的类？

> ID：10557069
> 
> 赞同：0
> 
> 时间：2012-05-11T18:55:12.873
> 
> 标签：ruby-on-rails

如果我采取`Object`这样的数字：

```
@objects = Object.all[1..5] 
```

我不再可以`where`对`@object`.

反正有吗，我还能演。。

```
@objects.where(:attribute => identity) 
```

只要我知道所有对象都属于同一类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:03:04.170

一旦你触发`all`了一个 Array 实例就会返回，所以你的问题的答案是**no**。但是有一些陷阱：

1.  保留范围变量。即，如果您需要在多个地方使用作用域对象，请执行以下操作：

    ```
    objects = Object.scoped

    all_objects     = objects.all
    special_objects = objects.where(attribute: something_special).all 
    ```

2.  继续玩作用域：

    ```
    objects = Object.skip(1).take(5)

    all_objects     = objects.all
    special_objects = objects.where(attribute: something_special).all 
    ```

3.  哈克和低效的方式：

    ```
    all_objects     = Object.all[1..5]
    special_objects = object.select { |object| object.attribute == something_special } 
    ```

# php - 记录uniqie文章浏览次数的最有效方法是什么

> ID：10557070
> 
> 赞同：1
> 
> 时间：2012-05-11T18:55:29.547
> 
> 标签：php, mysql, codeigniter

我正在尝试使用 codeigniter 创建一个基于文章的网站。当请求从数据库中获取任何文章进行查看时，我使用以下代码将每篇文章的唯一视图数标记在一个名为“hits”的单独表中。

```
mysql_query("INSERT INTO hits(ip,article_slug,hitcount) 
             VALUES('$ip_address','$id',1)
           ON DUPLICATE KEY UPDATE hitcount=hitcount+0"); 
```

我获取用户的 IP 地址并从 $this->uri->segment(3) 中获取 article_slug 的值；然后运行上面的mysql查询。

我在这里使用 IP 地址来获取唯一视图的数量，但我突然想到有几个人可能使用相同的 IP 地址。所以在那种情况下，我上面的查询似乎无效。

所以我想知道什么是最有效的方法。我的一位朋友正在谈论使用 cookie 而不是 IP 地址来做这件事。您认为这是一个好主意还是有更好的方法？

你能给我一个关于如何做到这一点的想法吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:07:16.483

The reason behind using cookie is that if some group of user is behind proxy you will get same ip-address for all the user who read your article which is wrong.

So you can use combo of both and that way you could get better results. You can either use cookie or session. But if you use cookie and give it an expiry period of about a year or more and if you specify some unique hash to the cookie (which could be md5 of the log table's primary key) and then you can track users pretty well.

let me know if you do not understand what I mean.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:05:32.163

我建议使用 Google Analytics 并设置仅跟踪文章浏览量的自定义报告。这将为您提供您所寻求的见解以及更多信息，并且可以避免计算机器人（如谷歌、必应或垃圾邮件）。

但是，如果您想自己跟踪用户，我建议您在一个字段中跟踪 IP 地址，在另一个字段中跟踪会话 ID。

```
session_start();

$user['ip']  = $_SERVER['REMOTE_ADDR'];
$user['sid'] = session_id(); 
```

# android - 具有 1 个活动的不同视图的选项卡

> ID：10557072
> 
> 赞同：0
> 
> 时间：2012-05-11T18:55:32.200
> 
> 标签：android, tabs

我想要 1 个活动显示在 2 个选项卡上。

在我的主要我有以下几点：

```
 TabHost tabHost = getTabHost();  // The activity TabHost

    tabHost.addTab(tabHost.newTabSpec("tab0").setIndicator(tabNames[0]).setContent(R.id.tab0));
    tabHost.addTab(tabHost.newTabSpec("tab1").setIndicator(tabNames[1]).setContent(R.id.tab1));

    Intent intent = new Intent().setClass(this, DMXControllerActivity.class);
    startActivity(intent); 
```

在我的 main.xml 中，我在 FrameLayout 中有这个：

```
 <LinearLayout
       android:id="@+id/tab0"
       android:orientation="vertical"
       android:layout_width="fill_parent"
       android:layout_height="fill_parent"
       android:padding="5dp">
    </LinearLayout>

   <LinearLayout
       android:id="@+id/tab1"
       android:orientation="vertical"
       android:layout_width="fill_parent"
       android:layout_height="fill_parent"
       android:padding="5dp">
    </LinearLayout> 
```

在我的活动中，我有这个：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    layoutTab0();
    layoutTab1(); 
```

}

私人无效布局Tab0（）{

```
 LinearLayout ll_main = new LinearLayout(this);
   ll_main.setOrientation(LinearLayout.VERTICAL);

    LinearLayout myll = (LinearLayout) findViewById(R.id.tab0);

    myll.addView(ll_main);

    LinearLayout ll_sliders = new LinearLayout(this);
    ll_sliders.setOrientation(LinearLayout.VERTICAL);
    ll_main.addView(ll_sliders); 
```

……………………

}

当我启动应用程序时，我看到我的 tab0 和 tab1 的内容彼此重叠。当我在模拟器中点击后退键时，我会按预期看到 2 个选项卡，但它们是空的。

如何让我的标签内容显示在标签上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:05:43.293

您必须在设置 ContentView 后执行此代码：

```
TabHost tabHost = getTabHost();  // The activity TabHost
tabHost.addTab(tabHost.newTabSpec("tab0").setIndicator(tabNames[0]).setContent(R.id.tab0));
tabHost.addTab(tabHost.newTabSpec("tab1").setIndicator(tabNames[1]).setContent(R.id.tab1)); 
```

将您的 onCreate() 更改为：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    TabHost tabHost = getTabHost();  // The activity TabHost
    tabHost.addTab(tabHost.newTabSpec("tab0").setIndicator(tabNames[0]).setContent(R.id.tab0));
    tabHost.addTab(tabHost.newTabSpec("tab1").setIndicator(tabNames[1]).setContent(R.id.tab1));

    layoutTab0();
    layoutTab1();
} 
```

在您的代码中，您正在创建选项卡，然后打开一个新活动。如果您不打开活动，选项卡将显示，但它们将为空，因为您没有向它们添加内容。您不必调用新活动，只需将内容添加到选项卡布局中即可。

# java - 在 javafx 中选择不同选项卡时更改阶段 titleProperty

> ID：10557074
> 
> 赞同：2
> 
> 时间：2012-05-11T18:56:02.183
> 
> 标签：java, events, javafx

我想应该有一些事件，但没有找到。我现在的代码是

```
stage.titleProperty().bind(tabPane.getSelectionModel().getSelectedItem().textProperty()); 
```

但它不会动态更改标题，正确的解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:48:24.683

普斯的解释是正确的。这是一个更改侦听器示例。

```
stage.setTitle(tabPane.getSelectionModel().getSelectedItem().getText());
tabPane.getSelectionModel().selectedItemProperty().addListener(new ChangeListener<Tab>() {
  @Override public void changed(ObservableValue<? extends Tab> tab, Tab oldTab, Tab newTab) {
    stage.setTitle(newTab.getText());
  }
}); 
```

使用上面的代码而不是您问题中的示例代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:30:16.653

我现在无法为您提供解决方案，但我想我发现了问题：您已将 titleProperty 绑定到在绑定时选择的选项卡的 textProperty。您可能需要侦听选择更改并更改侦听器中的阶段标题。

# php - 使用php添加两个类似格式的时间值

> ID：10557076
> 
> 赞同：14
> 
> 时间：2012-05-11T18:56:08.017
> 
> 标签：php, datetime

我有两个时间值，如下所示

```
$time  = 06:58:00;
$time2 = 00:40:00; 
```

我这样做是为了计算特定用户的约会和可用时间，所以我尝试了这种方式

```
$max_date=abs(strtotime($time) + strtotime($time2)); 
```

但它返回 $max_date =2673452280 任何建议请

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-11T19:05:23.590

此代码示例将花费一小时`$time`并将小时添加`$time2`到其中

例如：时间=06:58:00，时间2=00:40:00，结果=07:38:00

```
$time = "06:58:00";
$time2 = "00:40:00";

$secs = strtotime($time2)-strtotime("00:00:00");
$result = date("H:i:s",strtotime($time)+$secs); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-07-17T08:09:38.677

使用这个功能...

```
 function sum_the_time($time1, $time2) {
      $times = array($time1, $time2);
      $seconds = 0;
      foreach ($times as $time)
      {
        list($hour,$minute,$second) = explode(':', $time);
        $seconds += $hour*3600;
        $seconds += $minute*60;
        $seconds += $second;
      }
      $hours = floor($seconds/3600);
      $seconds -= $hours*3600;
      $minutes  = floor($seconds/60);
      $seconds -= $minutes*60;
      if($seconds < 9)
      {
      $seconds = "0".$seconds;
      }
      if($minutes < 9)
      {
      $minutes = "0".$minutes;
      }
        if($hours < 9)
      {
      $hours = "0".$hours;
      }
      return "{$hours}:{$minutes}:{$seconds}";
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T19:00:21.373

strtotime 函数以完整日期为参数，有效格式如下： [http ://www.php.net/manual/en/datetime.formats.php](http://www.php.net/manual/en/datetime.formats.php)

[您可以在http://php.net/manual/en/function.strtotime.php](http://php.net/manual/en/function.strtotime.php)的函数的在线 PHP 手册中看到这一点

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T19:05:03.803

如果您之前从数据库构建这些时间字符串，您可能希望将它们重建为如下所示：

```
$time = "00:06:58";
$time2 = "40 minutes";

$timestamp = strtotime($time." +".$time2);
$endTime = date("d.m.Y H:i:s", $timestamp); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-18T05:08:00.933

使用 php 添加两次的最简单方法是：

1) 将时间从 H:i:s (例如 08:15:40) 格式转换为秒。
2) 对第二次时间值 ref:step 1 执行相同操作
3) 添加转换后的值并将其存储为 php 变量
4) 现在将总计（以秒为单位）转换为 H:i:s
并且它适用于我。

**PHP 脚本：**

```
$str_time ="08:04:40";

$str_time = preg_replace("/^([\d]{1,2})\:([\d]{2})$/", "00:$1:$2", $str_time);

sscanf($str_time, "%d:%d:%d", $hours, $minutes, $seconds);

$hrs_old_seconds = $hours * 3600 + $minutes * 60 + $seconds;

$str_time ="02:10:22";

$str_time = preg_replace("/^([\d]{1,2})\:([\d]{2})$/", "00:$1:$2", $str_time);

sscanf($str_time, "%d:%d:%d", $hours, $minutes, $seconds);

$hrs_toadd_seconds = $hours * 3600 + $minutes * 60 + $seconds;

$hrs_old_int1 = $hrs_old_seconds + $hrs_toadd_seconds;

echo $Total=gmdate("H:i:s", $hrs_old_int1); 
```

**结果=：10:15:02**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-03-06T00:58:21.327

[Anudeep 的解决方案](https://stackoverflow.com/a/17694466/4080818)非常适合我的用例，但我还需要能够添加负时间。这是他的代码的略微编辑版本，用于获取和返回负时间字符串（例如“-01:01:01”）：

```
public static function sum_the_times($time1, $time2)
{
    $times = array($time1, $time2);
    $seconds = 0;
    $negative = false;
    foreach ($times as $time) {
        list($hour,$minute,$second) = explode(':', $time);
        if(substr($hour,0,1) == '-'){
            $seconds -= substr($hour,1)*3600;
            $seconds -= $minute*60;
            $seconds -= $second;
        } else {
            $seconds += $hour*3600;
            $seconds += $minute*60;
            $seconds += $second;
        }
    }
    if (substr($seconds, 0, 1) == '-') {
        $negative = true;
        $seconds = ($seconds * -1);
    }
    $hours = floor($seconds/3600);
    $seconds -= $hours*3600;
    $minutes  = floor($seconds/60);
    $seconds -= $minutes*60;
    if ($seconds < 9) {
        $seconds = "0".$seconds;
    }
    if ($minutes < 9) {
        $minutes = "0".$minutes;
    }
    if ($hours < 9) {
        $hours = "0".$hours;
    }
    return ($negative ? "-" : "")."{$hours}:{$minutes}:{$seconds}";
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-06-07T04:27:59.257

你可以试试这个

```
$time = "04:00:00";
$time2 = "03:30:00";

$result = date("H:i:s",strtotime($time)+strtotime($time2));
echo $result; 
```

它提供输出 07:30:00 但有时在不同版本的操作系统中不起作用。如果您想获得时间总和，则可以使用此代码

```
<?php
   function CalculateTime($time1, $time2) {
      $time1 = date('H:i:s',strtotime($time1));
      $time2 = date('H:i:s',strtotime($time2));
      $times = array($time1, $time2);
      $seconds = 0;
      foreach ($times as $time)
      {
        list($hour,$minute,$second) = explode(':', $time);
        $seconds += $hour*3600;
        $seconds += $minute*60;
        $seconds += $second;
      }
      $hours = floor($seconds/3600);
      $seconds -= $hours*3600;
      $minutes  = floor($seconds/60);
      $seconds -= $minutes*60;
      if($seconds < 9)
      {
      $seconds = "0".$seconds;
      }
      if($minutes < 9)
      {
      $minutes = "0".$minutes;
      }
        if($hours < 9)
      {
      $hours = "0".$hours;
      }
      return "{$hours}:{$minutes}:{$seconds}";
    }

    $time1= '23:32:05';
    $time2 = '01:29';
    echo CalculateTime($time1,$time2);

?> 
```

在第二个代码中，您可以以小时：分钟或小时：分钟：秒发送时间。此代码接受这两种格式，因为它会自动转换时间

# java - Java String.contains：如何检查一个确切的字符串

> ID：10557079
> 
> 赞同：-3
> 
> 时间：2012-05-11T18:56:25.723
> 
> 标签：java, string, contains

我正在使用 string.contains("string") 来查找 proc 文件中的分区。行示例将是：

```
 8       0 sda 64154 32861 2927936 1462960 222942 512949 5776720 4355320 0 1029440 5818130
   8       1 sda1 29613 26082 1943594 1077290 23561 82884 851560 423330 0 235650 1500640 
```

我有一个字符串数组。每行都是数组的一个元素。由于某些元素没有用，我检查了该行中的分区名称。如果一行具有一个现有分区的名称，它将被解析。

这就是为什么我不能简单地使用 string.equals; 我可以检查该行是否包含，然后使用 indexOf 进行一些字符串操作，使用 then equals。

谢谢，抱歉之前没有更清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T18:58:08.520

这是否像您尝试检查两个字符串是否相等而不是包含检查一样简单？如果是这样，您只需要：

```
if (text1.equals(text2)) 
```

代替

```
if (text1.contains(text2)) 
```

如果那*不是*您所追求的，那么您的问题需要更清楚。

编辑（问题更新后）：仍然不清楚您要做什么*。*听起来您*可能*可以逃脱：

```
if (line.contains(" sda ")) 
```

因为这将*不*匹配`sda1`。基本上，利用分区名称前后有一个空格，但分区名称不能有空格这一*事实*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:52:02.670

我希望下面的代码片段可以解决您的问题。基本上，您仍然可以使用 equals 函数，但也可以使用 substring 函数。在这种情况下，我从第二个字符开始。

```
String str1 = "1234567890";
String str2 = "0234567890";

if ( str1.substring(1).equals( str2.substring(1) )) {
    System.out.format("String %s matches", str1);
} 
```

最后，我的信息是使用所有可用的功能来完成这项工作，而无需编写自己的代码。

玩得开心...

# asp.net - 如何使用 Twitterizer 搜索过去一周的推文？

> ID：10557081
> 
> 赞同：0
> 
> 时间：2012-05-11T18:56:29.087
> 
> 标签：asp.net, twitter, twitterizer

我想使用标签搜索过去一周的推文。

例如，如果我在文本框中输入“Google”，则代码应返回每条包含“Google”一词且在过去 7 天内发布的推文，无论是谁发的推文。

我能够获取过去一小时的数据，但我想读取过去一周的数据。这是我的代码

公共静态无效GetTweet（字符串查询）

```
 {

         DateTime Pre = DateTime.Now.AddDays(-7);

         SearchOptions options = new SearchOptions(){      
                        SinceDate = Pre,
                PageNumber=pageNumber,

           NumberPerPage =100
        };
        TwitterResponse<TwitterSearchResultCollection> searchResult = TwitterSearch.Search(query,options);
        while (searchResult.Result == RequestResult.Success && pageNumber < 10)
        {
            foreach (var tweet in searchResult.ResponseObject)
            {
                Console.WriteLine(tweet.Text, tweet.CreatedDate);

                pageNumber++;
                searchResult = TwitterSearch.Search(query, options);

            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:41:07.727

Twitter API 并非旨在为您提供此类数据，尤其是在查询此类大型数据集时。每个端点都有自己的限制。通常，在过去 2 周内有 2000 条推文。

搜索 API 允许您获取多达 1500 条推文（15 页 @ 每页 100 条）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T19:35:28.523

你可以做这样的事情

```
Dim s As New UserTimelineOptions
s.Count = 3000
s.UseSSL = True
s.APIBaseAddress = "http://api.twitter.com/1/"
s.IncludeRetweets = False
s.UserId = 24769625 'Just a sample account
Dim T As TwitterResponse(Of TwitterStatusCollection) = TwitterTimeline.UserTimeline(tokens, s)
For Each Tweet As TwitterStatus In T.ResponseObject
    Console.WriteLine(Tweet.User.ScreenName & ": " & Tweet.Text)
    'In here just check the created date on the tweet.createddate and look for the time frame
Next 
```

# git - 如何在不同的分支上有不同的文件，而不是让它们在合并时相互破坏？

> ID：10557089
> 
> 赞同：1
> 
> 时间：2012-05-11T18:56:59.983
> 
> 标签：git, version-control, heroku, github

我正在处理的项目有两个分支，一个公共分支被推送到 GitHub，一个部署分支被推送到 Heroku。deploy 分支包含一个包含密钥的文件，public 分支包含 LICENSE、README.md 和密钥生成器等文件。

当我对项目进行更改时，我想在部署分支上这样做，然后当我准备好推送时，将其合并到公共分支中，然后将不同的分支推送到各自的远程。但是，当尝试将 deploy 合并到 public 时，它会添加 Heroku 特定文件并删除 GitHub 特定文件。

我尝试了两种方法来防止这种情况：使存储库同步并进行完全合并，但具有不同的 .gitignore 文件，以及在合并时使用 .gitattributes 文件忽略上述文件。两者似乎都失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T04:23:36.330

Do a merge --no-commit. Script the checkout of the files you want/delete files you don't want. Now git commit.

```
git merge --no-commit origin/my-branch
git checkout --theirs License.txt
rm super-secret-key.txt
git commit 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T06:25:08.130

也许您应该重新考虑您的工作流程。如果您确实需要在 git 存储库中保密，那么在公共分支上工作可能会更好，并将其合并到部署分支。

我不明白“删除 GitHub 特定文件”是什么意思。部分意味着，是什么导致这些文件的删除？

# java - Runtime.exec 被 System.exit 杀死？

> ID：10557093
> 
> 赞同：3
> 
> 时间：2012-05-11T18:57:22.200
> 
> 标签：java, runtime.exec, system.exit

我有一个应该运行 bat 文件的 java 程序，然后以成功代码 0 退出。

代码基本上看起来像这样

```
Runtime.exec(....);

System.exit(0); 
```

99.8% 的时间，这工作得很好。但非常偶尔地，bat 文件不会运行。

我的理论是，在某些系统上，Runtime.exec 无法在 System.exit 运行之前完成它的生成。这可能/可能吗？

我查看了 Runtime.exec 的源代码，但它会放入本机代码中来做有趣的事情。

**编辑**

根据到目前为止的答案，我应该声明 .bat 文件使用 javaw 执行另一个 java 进程。我可以确认第一个 java 进程结束不会杀死 bat 文件中的第二个运行。

当问题发生时，bat 文件是否有可能在 System.exit 发生之前没有产生第二个 java 进程？也许它毕竟不是 Runtime.exec 问题？

**编辑2**

我不能等待第二个进程结束，它可以无限期地运行，我的第一个进程必须退出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:00:34.473

尝试更改为[ProcessBuilder](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/ProcessBuilder.html)。也许效果更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:07:02.190

您正在创建一个将以其父进程终止的子进程。您必须`Process.waitFor`在 Java 中使用以确保 Java 进程等待 bat 进程完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T19:03:40.153

System.exit(0) 杀死 jvm 实例。所有进程都将终止。如果要真正执行 System.exit(0)，请确保在调用 System.exit 之前执行完 exec 进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T19:39:30.620

使用**Process.waitFor()**，此方法的返回类型是 int ，它根据您当前使用运行时的解决方案为您提供返回代码。
如有必要，waitFor() 使当前线程等待，直到此 Process 对象表示的进程终止。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T20:07:14.513

将其更改为

```
Runtime.getRuntime().exec(....).waitFor();

System.exit(0); 
```

但这将等待批处理文件完成执行，并在您的情况下完成 javaw 实例。

# javascript - 何时将集合传递给骨干模型构造函数的第二个参数是合适的？

> ID：10557097
> 
> 赞同：0
> 
> 时间：2012-05-11T18:57:34.820
> 
> 标签：javascript, backbone.js

什么时候适合将集合传递给主干模型构造函数？如在

```
var someColl = new SomeCollection();
var m = new SomeModel({}, {collection: someColl}); 
```

模型构造函数查询第二个参数以获取集合属性，如果存在，则将其分配给模型集合属性。否则，这些项目会附加我相信的构造函数。有什么例子说明你什么时候以及为什么要做这些事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T04:07:31.610

```
var someColl = new SomeCollection()
var m = someColl.create({ foo: bar })

# m.collection == someColl 
```

如果您调用[`create`](http://documentcloud.github.com/backbone/#Collection-create)集合，您将收到新创建的模型（也已添加到集合中）。从那时起，您可以在需要时参考该集合`m.collection`

我认为在这种情况下引用模型上的集合是最有意义的。您正在向集合中添加一个新模型，并且由于它本质上属于其中，因此使用 . 引用它是有意义的`.collection`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:42:03.007

我有时发现传递模型实例化的父视图很有用。尽管这种情况非常罕见，但您可以轻松地执行类似`new TabModel(null, {tabGroupView: this});`. 我不会说这是我会经常使用的模式，但传递选项绝对很方便。这就是我喜欢 Backbone 的地方，你可以更自由地做任何你想做的事情。

# perl - 使用 Test::WWW::Selenium 或其他方式检测操作系统对话框

> ID：10557101
> 
> 赞同：1
> 
> 时间：2012-05-11T18:57:58.283
> 
> 标签：perl, testing, browser, selenium, dialog

我知道 Selenium 无法检测操作系统对话框，所以我想知道如何在 Perl 中完成此操作。我可以使用 Perl 驱动 Selenium RC，直到单击页面上的按钮以打开打印对话框，然后使用非 Selenium Perl 检测该对话框何时以某种方式出现？

如果您好奇，这里的最后一步是记录对话框加载所需的时间。

```
my $t0 = [gettimeofday];
$sel->click_ok("id=ctl00_ctl00_printButton");
## something like 'dialog_loads_ok("print_dialog");'
my $t1 = [gettimeofday]
my $t0_t1 = tv_interval $t0, $t1;
print "Elapsed time to load print dialog: $t0_t1 minutes\n"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T00:13:37.680

对于 Windows 和 X11，您应该能够分别使用[Win32::GuiTest](http://search.cpan.org/perldoc/Win32%3a%3aGuiTest)和[X11::GUITest](http://search.cpan.org/perldoc/X11%3a%3aGUITest)。

# java - “类型 ArrayList 不是通用的”是什么意思？

> ID：10557102
> 
> 赞同：6
> 
> 时间：2012-05-11T18:58:02.007
> 
> 标签：java

我是 Java 新手，正在尝试学习程序员可以使用的各种集合。我将“java.util”导入 Eclipse 中的剪贴簿并检查以下代码。

```
ArrayList<String> list = new ArrayList<String>();
list.add("test1");
list.add("test2"); 
```

我收到这个输出。

```
The type ArrayList is not generic; it cannot be parameterized with arguments <String>
Syntax error, parameterized types are only available if source level is 5.0
The type ArrayList is not generic; it cannot be parameterized with arguments <String>
Syntax error, parameterized types are only available if source level is 5.0 
```

这个错误是什么意思？我没有制作通用数组列表；我制作了一个字符串数组列表。此外，什么是“源级别”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-11T19:00:37.050

您在 Eclipse 中的 Java 版本设置为 1.4，Java 中的泛型仅在 Java 5 中引入。

在 Eclipse 中将 JDK 更改为 1.5 或更高版本将解决此问题。

您可以通过以下方式检查您的 JDK`Project - > Java Build Path - > Libraries`

如果您在此处看到它是 Java 1.5 或更高版本，请检查编译器合规性是否设置为 5 及更高版本。

你可以检查一下`Project - > Java Compiler`

编辑：

将新 jdk 添加到 Eclipse

右键单击**项目 -> Java 构建路径 -> 库 -> 添加库 -> JRE 系统库 -> 已安装库 -> 添加 -> 标准 VM -> 提供您的安装位置，然后按确定**

*请注意在已安装 JRE 的列表中，确保检查您的 Java 7。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T19:00:13.360

我想到了什么：

*   检查 JDK 是否完全符合泛型（以便`ArrayList`JSE 中的类实际上是泛型类）
*   检查您是否没有另一个`ArrayList`具有范围优先级并覆盖标准库定义

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-29T18:57:57.283

是的，1.5 及更高版本的问题消失了。感觉这个问题没有完全解决，我加了 2 美分，以防有人遇到这个问题。主要是关于这部分问题：

> 我没有制作通用数组列表；我制作了一个字符串数组列表。

提到的错误消息：

> > ArrayList 类型不是*通用*的；它不能用*参数*<String>参数化
> 
> > 语法错误，*参数化类型*仅在源级别为 5.0 时可用

它的实际意思是，从 Java 1.5 开始，我们也可以使用类型参数（其中一个习惯于使用值参数）。JDK 1.5 引入了*泛型*，它允许我们对类型（或**参数化类型**）进行抽象。

类设计器可以对定义中的类型*通用*。arrayList 实现如下：

```
public class ArrayList<E> implements List<E> .... {
    // Constructor
    public ArrayList() {...}

    // Public methods
    public boolean add(E e) {...}
    public void add(int index, E element) {...}
    public boolean addAll(int index, Collection<? extends E> c) {...}
    public abstract E get(int index) {...}
    public E remove(int index) {...}
    ...
} 
```

其中**E**可以是*任何*类型，如 String 或 Integer 等。因此名称为**泛型**arrayList。

在此示例中完成的对象实例化或方法调用期间，用户可以特定于类型，如下所示：

```
ArrayList<String> list = new ArrayList<String>(); 
```

（如果我没记错的话，上述情况的混淆是什么:-)）

泛型使用示例（如果需要）：

```
// Declaring a DAO layer
public interface IMasterAbstractDao<E, I> {
    public E findById(I id) {...}
    public void delete(E e) {...}
    public List<E> findByCriteria(Criterion criterion) {...}
} 
```

其中**E**是返回的实体类型。这可用于系统中定义的所有模型[bean](https://stackoverflow.com/questions/3295496/what-is-a-javabean-exactly)，使其具有通用性。

希望这可以帮助。

[参考：Java 编程教程 - 泛型](https://www3.ntu.edu.sg/home/ehchua/programming/java/JavaGeneric.html)

# python - Django中的多输入

> ID：10557105
> 
> 赞同：0
> 
> 时间：2012-05-11T18:58:14.680
> 
> 标签：python, django, input, upload

如何将多个对象 ID 传递到 Django 表单中？有没有办法将包含多个对象 ID 的 JavaScript 数组传递到表单字段并在服务器端迭代它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:17:57.690

您可以使用[CommaSeparatedIntegerField](https://docs.djangoproject.com/en/dev/ref/models/fields/#commaseparatedintegerfield)来存储 ID，如果您在 JavaScript 中动态填充数据，甚至可以使用[HiddenInput小部件。](https://docs.djangoproject.com/en/dev/ref/forms/widgets/#hiddeninput)

`cleaned_data`在服务器端验证表单后，您将能够遍历表单中的整数列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:26:02.880

您可能想要创建一个新字段并覆盖“to_python”方法。

以下基本示例创建一个新的 char 字段，该字段接受包含用逗号分隔的 id 的字符串并返回查询集。

```
class MyField(forms.CharField):
    def to_python(self, value):
        ids = value.split(',')

        return MyModel.objects.filter(id__in=ids)

class MyForm(forms.Form):
    ids = MyField() 
```

看看 [Django 中的验证是如何工作的](https://docs.djangoproject.com/en/dev/ref/forms/validation/)。

# wpf - wpf 上下文菜单样式

> ID：10557107
> 
> 赞同：0
> 
> 时间：2012-05-11T18:58:22.070
> 
> 标签：wpf, contextmenu, styling

当我右键单击数据网格时，我有上下文菜单。它完全符合我的要求，但问题是，这种菜单样式会覆盖现有的菜单样式。我只想将 ControlTemplate 应用于此菜单。请帮忙。

这是 XAML

```
<ContextMenu  x:Key="cellContextMenu">
    <MenuItem Header="Insert symbol" Margin="0,0,0,0" HorizontalContentAlignment="Right">
        <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
            <wpfc:SymbolController x:Name="dgSymbolControl" Width="400" Height="400" value="{Binding Path=SelectedSymbolItem, Mode=TwoWay, diagnostics:PresentationTraceSources.TraceLevel=High}"></wpfc:SymbolController>
            <TextBlock FontFamily="DYMObvba" Text="{Binding ElementName=dgSymbolControl, Path=value}" />
        </StackPanel>
    </MenuItem>
</ContextMenu>
<ControlTemplate x:Key="{x:Static MenuItem.SubmenuItemTemplateKey}" TargetType="{x:Type MenuItem}">
    <Grid>
        <Border Name="Check" Visibility="Collapsed" Margin="0,0,0,0"></Border>
        <ContentPresenter Grid.Column="1" ContentSource="Header" RecognizesAccessKey="True"/>
    </Grid>
</ControlTemplate> 
```

这是应用菜单的代码：

```
eCell.ContextMenu = (ContextMenu)FindResource("cellContextMenu"); 
```

谢谢迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T08:25:33.703

我会尝试在 ContextMenu 中定义 ControlTemplate：

```
<ContextMenu  x:Key="cellContextMenu">
<ContextMenu.Resources>
...
<ControlTemplate x:Key="{x:Static MenuItem.SubmenuItemTemplateKey}" TargetType="{x:Type MenuItem}">
    <Grid>
        <Border Name="Check" Visibility="Collapsed" Margin="0,0,0,0"></Border>
        <ContentPresenter Grid.Column="1" ContentSource="Header" RecognizesAccessKey="True"/>
    </Grid>
</ControlTemplate>
</ContextMenu.Resources>
    <MenuItem Header="Insert symbol" Margin="0,0,0,0" HorizontalContentAlignment="Right">
        <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
            <wpfc:SymbolController x:Name="dgSymbolControl" Width="400" Height="400" value="{Binding Path=SelectedSymbolItem, Mode=TwoWay, diagnostics:PresentationTraceSources.TraceLevel=High}"></wpfc:SymbolController>
            <TextBlock FontFamily="DYMObvba" Text="{Binding ElementName=dgSymbolControl, Path=value}" />
        </StackPanel>
    </MenuItem>
</ContextMenu> 
```

...或在 XAML 中设置 MenuItem 的样式：

```
<ContextMenu x:Key="cellContextMenu">
    <MenuItem Style="MyMenuStyle" Header="Insert symbol" Margin="0,0,0,0" HorizontalContentAlignment="Right">
        <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
            <wpfc:SymbolController x:Name="dgSymbolControl" Width="400" Height="400" value="{Binding Path=SelectedSymbolItem, Mode=TwoWay, diagnostics:PresentationTraceSources.TraceLevel=High}"></wpfc:SymbolController>
            <TextBlock FontFamily="DYMObvba" Text="{Binding ElementName=dgSymbolControl, Path=value}" />
        </StackPanel>
    </MenuItem>
</ContextMenu>

<Style x:Key="MyMenuStyle" TargetType="{x:Type MenuItem}">
    <ControlTemplate x:Key="{x:Static MenuItem.SubmenuItemTemplateKey}" TargetType="{x:Type MenuItem}">
        <Grid>
            <Border Name="Check" Visibility="Collapsed" Margin="0,0,0,0"></Border>
            <ContentPresenter Grid.Column="1" ContentSource="Header" RecognizesAccessKey="True"/>
        </Grid>
    </ControlTemplate>
</Style> 
```

# vb.net - 在 Visual Basic 中为 Get REST API 设置 RequestHeaders

> ID：10557109
> 
> 赞同：0
> 
> 时间：2012-05-11T18:58:28.580
> 
> 标签：vb.net

我在 Visual Basic 中找到了一些示例源代码来调用 REST API。但是，我需要通过添加两个请求标头来修改代码。

```
 ' Create the web request  
        request = DirectCast(WebRequest.Create(sURI), HttpWebRequest)

        'Update request headers with request pairs Header1/"header1 value" and header2/"header2 value"
         ??? HttpWebRequest.headers.Add ????

        ' Get response  
        response = DirectCast(request.GetResponse(), HttpWebResponse)

        ' Get the response stream into a reader  
        reader = New StreamReader(response.GetResponseStream()) 
```

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:59:53.717

许多正常的标头是“内置的”，如下所示：

```
HttpWebRequest.ContentType = "application/x-www-form-urlencoded" 
```

或者，您应该能够设置您喜欢的任何标题：

```
HttpWebRequest.Headers("Header1") = "Header1 value" 
```

还有另一种符合您原始代码的方法：

```
HttpWebRequest.Headers.Add("Header1", "Header1 value") 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-11T19:12:54.720

您可以考虑使用 System.Net.WebClient。

这是C#中的一些代码

```
 using (System.Net.WebClient client = new System.Net.WebClient())
  {
    string userInfo = Convert.ToBase64String(System.Text.Encoding.Default.GetBytes("user:password"));
    client.Headers[System.Net.HttpRequestHeader.Authorization] = "Basic " + userInfo;
    client.DownloadString(url)
  } 
```

# git - 更改运行 Jenkins 进程的用户

> ID：10557112
> 
> 赞同：4
> 
> 时间：2012-05-11T18:58:36.570
> 
> 标签：git, ubuntu, ssh, jenkins, ssh-keys

我想知道如何更改在我的 ubuntu 上启动 jenkins 服务器的用户。

在`http://[server]:8080/systemInfo`页面中我可以找到一个环境变量：USER jenkins

我的动机是设置用户 'git' 以扭转詹金斯无法克隆同一台计算机上的用户 'git' 托管的 git 项目：

```
hudson.plugins.git.GitException: 
Command "git clone --progress -o origin ssh://git@[server]:22/~/[repo].git /var/lib/jenkins/workspace/[project]" returned status code 128:
stdout: Cloning into /var/lib/jenkins/workspace/[project]...
stderr: Permission denied, please try again.
Permission denied, please try again.
Permission denied (publickey,password) 
```

...在为 jenkins 用户生成 ssh 密钥并验证 Jenkins 的 SSH 设置中的准确设置之后。

感谢帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:57:14.610

我不认为改变运行 Jenkins 的用户是解决方案。

你应该以 Jenkins 用户（或它）的身份登录到你的 Ubuntu 盒子`sudo su - jenkins`，然后验证它`ssh git@[your-git-server]`是否正常工作。很可能是缺少 SSH 密钥或与 SSH 密钥相关的文件或目录之一存在权限问题。

该工具或`git`命令行工具都无法识别从 Jenkins 中配置的 SSH 密钥。我**知道**当我有一个`jenkins`用户`~jenkins/.ssh/id_rsa`在`~jenkins/.ssh/known_hosts`.

# objective-c - 解析 JSON 文本

> ID：10557116
> 
> 赞同：0
> 
> 时间：2012-05-11T18:59:06.663
> 
> 标签：objective-c, xcode

通过以下方式...

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, 
                                                     NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString* path = [documentsDirectory stringByAppendingPathComponent: 
                  [NSString stringWithFormat:@"/lkj/"]];

NSString *fileName = [NSString stringWithFormat:@"/sandbox/2012_05_11.json"];

[[self restClient] loadFile:fileName intoPath:path];

NSString *fileContent = [[NSString alloc] initWithContentsOfFile:path];  

SBJsonParser *parser = [[SBJsonParser alloc] init];

NSDictionary *data = (NSDictionary *) [parser objectWithString:fileContent error:nil];  

// getting the data from inside of "menu"  

NSString *message = (NSString *) [data objectForKey:@"message"];
 NSString *name = (NSString *) [data objectForKey:@"name"];

namegroup.text = [NSString stringWithFormat:@"%@  %@",name, message]; 
```

...我正在尝试解析我以前用其他代码制作的文档...

```
{"message":["Untitled1a","Untitled2a","Untitled3a"],"name":["Untitled1b","Untitled2b","Untitled3b"]} 
```

但是，使用上面的代码，在名称 group.text 中，这会出现......

```
(untitled, untitled, untitled) (untitled, untitled, untitled) 
```

...但我想做的是分配许多 UITextFields，每个成对，（2、2、2..），一个显示名称的字段和另一个显示消息的字段，所以将 1a 与 1b 配对, 2a 和 2b... 显然这些字段不会是 Untitled1a，而是“你好吗”...

但我似乎无法解决这个问题！请帮忙！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:14:53.797

你可以尝试这样的事情：

```
 NSArray *message = [data objectForKey:@"message"];
 NSArray *name    = [data objectForKey:@"name"];

 NSDictionary* Dictionary = [NSDictionary dictionaryWithObjects:message forKeys:name];

 for (NSString* Key in [Dictionary allKeys]){
    NSLog(@"%@ %@",Key,[Dictionary objectForKey:Key]);

 } 
```

# android - 菜单图标不出现，ics 4.0.3

> ID：10557117
> 
> 赞同：3
> 
> 时间：2012-05-11T18:59:08.777
> 
> 标签：android, xml

我试图通过添加这一行来在 xml 中的菜单项中添加一个图标

```
android:icon="@android:drawable/ic_menu_preferences" 
```

进去了`<item>`，但没有用。

我也尝试将我的图像放在可绘制文件夹中，尝试通过以下方式显示它：

```
android:icon="@drawable/my_image" 
```

也没有用，图标没有出现在菜单中。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:03:20.393

如果“菜单”是指操作栏的操作溢出区域，它不显示图标，因此您没有做错任何事情。图标仅用于操作栏中的工具栏按钮。

# struts2 - 可能的 struts-portlet 2.3.3 错误？动作类不在值栈的顶部

> ID：10557124
> 
> 赞同：2
> 
> 时间：2012-05-11T18:59:42.073
> 
> 标签：struts2, portlet, ognl

我正在将一个 struts 2.2.3.1 portlet 应用程序 (jsr168) 迁移到新版本 2.3.3。在大多数情况下，一切仍然正常，但有一个明显的问题。

我正在使用 package.properties 资源包来处理我的 jsp 中的标题和标签等内容。当我第一次点击操作时，会从资源包中检索消息并按预期显示。但是，当我对某个操作发出第二个请求时，会显示消息键，这通常意味着找不到资源。

（第一次执行操作和任何后续请求之间的主要区别似乎是，在第一个请求中，仅处理事件 portlet 阶段，而不是呈现 portlet 阶段。任何后续请求都使用这两个阶段。）

我花了很长时间才弄清楚发生了什么，但大致是这样的：

我开始逐步浏览**org.apache.struts2.components.Text**。当在 jsp 中遇到 struts 文本标记时使用此类。

*end()*方法使用来自**TextProviderHelper**的静态*getText()*方法。这就是我找到问题根源的地方：

 **```
 for (Object o : stack.getRoot()) {
        if (o instanceof TextProvider) {
            tp = (TextProvider) o;
            msg = tp.getText(key, null, args, stack);

            break;
        }
    } 
```

上面的代码遍历值堆栈，直到找到**TextProvider**。因为**ActionSupport**实现**了 TextProvider**，并且因为 struts 试图将动作放在堆栈顶部或附近，所以动作通常是提供者。

这是两个版本在不同时间的值堆栈中的对象：

# 版本 2.2.3.1

## 第一个请求值栈

*   --> *TestPortletAction*
*   默认文本提供者

## 第二次请求值栈

*   --> *TestPortletAction*
*   默认文本提供者
*   DirectRenderFromEventAction
*   默认文本提供者

# 版本 2.3.3

## 第一个请求值栈

*   --> *TestPortletAction*
*   默认文本提供者

## 第二次请求值栈

*   DirectRenderFromEventAction
*   默认文本提供者
*   --> *TestPortletAction*
*   默认文本提供者

因此，由于某种原因，在新版本中，在处理完渲染阶段后，动作类不在堆栈顶部。这意味着**TextProviderHelper**使用**DefaultTextProvider**，它确实尝试定位资源包......但这样做永远不会成功。

我对**DefaultTextProvider**如何被推入堆栈进行了一些调查：

**Jsr168调度程序**。*serviceAction* () 调用**ActionProxyFactory**来创建动作代理。就在返回代理之前，调用*prepare* ()，然后调用**DefaultActionInvocation**的*init*方法。init 调用*createContextMap* () 来创建堆栈

```
stack = valueStackFactory.createValueStack(); 
```

使用的构造函数：

```
protected OgnlValueStack(XWorkConverter xworkConverter, CompoundRootAccessor accessor, TextProvider prov, boolean allowStaticAccess) {
    setRoot(xworkConverter, accessor, new CompoundRoot(), allowStaticAccess);
    push(prov);
} 
```

啊啊啊，这就是我到目前为止所遇到的问题。剩下的问题是：

1.  **第二个DefaultTextProvider**如何以及在何处被推入堆栈？（真的有理由拥有其中两个吗？）
2.  **DirectRenderFromEventAction**如何以及在何处被推入堆栈？
3.  新版本的什么变化导致了这种情况？
4.  这是错误还是预期行为？

一个可能的解决方案（确实可以解决它）是使用 ognl 显式调用操作的*getText*方法，但我认为这并不理想，它确实意味着更改一堆 jsp 文件。

```
<s:property value = "%{getText('some.key')}"/> 
```

可以在此处找到演示该问题的示例项目（这是一个 Maven 项目）：

[http://new-value-stack-order.googlecode.com/svn](http://new-value-stack-order.googlecode.com/svn)

我使用**tomcat 6.0.25**和**pluto 1.1.7**作为我的开发环境。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:17:53.277

弄清楚了。答案在于**PortletStateInterceptor**

**2.2.3.1**

```
@SuppressWarnings("unchecked")
private void restoreStack(ActionInvocation invocation) {
    RenderRequest request = (RenderRequest) invocation.getInvocationContext().get(REQUEST);
    if (StringUtils.isNotEmpty(request.getParameter(EVENT_ACTION))) {
        if(!isProperPrg(invocation)) {
            if (LOG.isDebugEnabled()) LOG.debug("Restoring value stack from event phase");
            ValueStack oldStack = (ValueStack) invocation.getInvocationContext().getSession().get(
            STACK_FROM_EVENT_PHASE);
            if (oldStack != null) {
                CompoundRoot oldRoot = oldStack.getRoot();
                ValueStack currentStack = invocation.getStack();
                CompoundRoot root = currentStack.getRoot();
                root.addAll(0, oldRoot);
                if (LOG.isDebugEnabled()) LOG.debug("Restored stack");
            }
        }
        else {
            if (LOG.isDebugEnabled()) LOG.debug("Won't restore stack from event phase since it's a proper PRG request");
        }
    }
} 
```

**2.3.3**

```
@SuppressWarnings("unchecked")
private void restoreStack(ActionInvocation invocation) {
    RenderRequest request = (RenderRequest) invocation.getInvocationContext().get(REQUEST);
    if (StringUtils.isNotEmpty(request.getParameter(EVENT_ACTION))) {
        if(!isProperPrg(invocation)) {
            if (LOG.isDebugEnabled()) LOG.debug("Restoring value stack from event phase");
            ValueStack oldStack = (ValueStack) invocation.getInvocationContext().getSession().get(
            STACK_FROM_EVENT_PHASE);
            if (oldStack != null) {
                CompoundRoot oldRoot = oldStack.getRoot();
                ValueStack currentStack = invocation.getStack();
                CompoundRoot root = currentStack.getRoot();
                root.addAll(oldRoot);
                if (LOG.isDebugEnabled()) LOG.debug("Restored stack");
            }
        }
        else {
            if (LOG.isDebugEnabled()) LOG.debug("Won't restore stack from event phase since it's a proper PRG request");
        }
    }
} 
```

注意 root.addAll()。在旧版本中，它将旧堆栈添加到当前堆栈的开头。在新版本中，它将其添加到末尾。

这实际上是 2.1.3 中修复的旧错误。在 Jira 中创建一个新问题。**

# ruby-on-rails - 如果其他验证失败，Rails ActiveRecord 存在验证有用吗？

> ID：10557126
> 
> 赞同：0
> 
> 时间：2012-05-11T18:59:51.163
> 
> 标签：ruby-on-rails, validation, activerecord

如果我的验证需要某个字段中的某些值，例如在空白或 nil 上失败的 a`format: { with: some_regex }`或 an `inclusion: { in: some_array }`，那么设置验证是否`presence: true`有用？在同样的情况下，`length: { }`如果其他验证失败，验证是否有用？

同样，{1..n} 的长度验证是否可以排除存在验证的需要？

我正在尝试了解是否有更多事情发生，或者检查是否只是多余的。例如，Rails 教程`presence: true`对电子邮件地址进行了验证，但格式验证不应允许空白或零地址。似乎是多余的，还是风格/惯例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:07:06.553

If you're using something like `format: regex` and you can guarantee (easy enough through a unit test) that a blank or nil attribute will cause the whole record to be invalid, then yes you don't need to validate the presence. Same with the `inclusion` situation, and the `length` situation.

In general, adding *more* validations isn't necessarily a bad thing. But, if you've thoroughly tested your model for situations with blank or nil attributes and your current validations achieve the desired result, then you're fine.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:10:32.823

如果比提到的任何内容**弱**，则验证存在。我宁愿不放

```
validates presence: true 
```

有，例如，

```
validates format: { with: some_regex }, allow_blank: false 
```

因为后者已经涵盖了具有`nil`价值的领域的情况。

# mysql - 如何仅显示某个名称出现在 X 行以上的 mySQL 记录？

> ID：10557131
> 
> 赞同：1
> 
> 时间：2012-05-11T19:00:12.083
> 
> 标签：mysql

我有一个包含客户信息的数据库。在表中，我有：

“全名”“电子邮件”等

有些客户和我下了超过 1 个订单，所以每个订单都有一行，而且每个订单显然也有重复的名称。

例如，我怎样才能获得超过 5 个订单的客户的 mySQL 记录？

这样它只会显示 mySQL 记录，例如“Michael Dell”的“全名”显示在 >5 行中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:03:17.833

像这样的东西应该可以解决问题吗？

```
SELECT `fullname`, COUNT(*) AS `count` FROM tablename WHERE `count` > 5 GROUP BY `fullname` 
```

或者

```
SELECT `fullname`, COUNT(*) AS `count` FROM tablename GROUP BY `fullname` HAVING count(*) > 1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T19:05:00.147

没有你的模式的细节很难，但这是基本的想法。

```
select fullname from order group by fullname having count(*) > 5 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T19:08:44.657

试试这个

```
SELECT `fullname`, COUNT(fullname) AS `count` FROM tablename WHERE `count` > 5 GROUP BY  GROUP BY `fullname` 
```

# svg - 用户上传的 .svg 是否存在 XSS 风险？如何“消毒”SVG？

> ID：10557137
> 
> 赞同：2
> 
> 时间：2012-05-11T19:00:24.720
> 
> 标签：svg, xss, raphael

我们有一个允许用户设计图形的网站，我们支持的东西之一是 SVG。我们希望允许用户上传 SVG，但担心滥用的可能性（包括 .SVG 文件中的代码）。

有没有办法对 .svg 文件进行消毒？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T21:08:00.587

允许 svg 上传类似于允许 html 上传，因此您需要类似级别的文件检查。参见例如[html5lib sanitizer](http://code.google.com/p/html5lib/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T21:12:33.363

如果您将上传的 svg 数据显示为图像，即`<img src="uploadedFile.svg">`在 html 中，则 UA 将不会运行任何脚本。

# windows - 在 Windows 7 中将批处理脚本或 EXE 设置为默认浏览器

> ID：10557138
> 
> 赞同：2
> 
> 时间：2012-05-11T19:00:27.740
> 
> 标签：windows, batch-file, registry, default

在我的公司，我们必须在 IE 中测试我们的应用程序，但我更喜欢使用 Chrome 作为我的默认浏览器。我制作了以下简单的批处理脚本，试图在 IE 中启动与我的公司相关的链接，或者在 Chrome 中启动它。该脚本如下所示，并且似乎在命令行中运行良好。

```
set url=%1
echo %url%|findstr /i companyname >nul:
if %errorlevel%==1  goto :co_not_found
:co_found
    "C:\Program Files\Internet Explorer\iexplore.exe" %url%
    goto :gensuite_end
:co_not_found
    "C:\Program Files\Google\Chrome\Application\chrome.exe" %url%
:co_end 
```

现在，我几天来一直在尝试将这个小玩意设置为我计算机的默认浏览器。这是我编辑的一些注册表项的列表。出于某种原因，Windows 仍然使用 IE 作为默认浏览器。

```
HKEY_CURRENT_USER\Software\Clients\StartmenuInternet  (Default) = DEFAULTBROWSER
HKEY_CURRENT_USER\Software\Classes\http  (Default) = C:\browserFix.exe
HKEY_CURRENT_USER\Software\Classes\http\shell\open\command  (Default) = C:\browserFix.exe
HKEY_CURRENT_USER\Software\Classes\https  (Default) = C:\browserFix.exe
HKEY_CURRENT_USER\Software\Classes\https\shell\open\command  (Default) = C:\browserFix.exe
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\http\shell\open\command  (Default) = C:\browserFix.exe
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\https\shell\open\command  (Default) = C:\browserFix.exe
HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet (Default) = DEFAULTBROWSER
HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet\DEFAULTBROWSER  (Default) = Default Browser, LocalizedString = C:\browserFix.exe
HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet\DEFAULTBROWSER\shell\open\command  (Default) = C:\browserFix.exe 
```

如果我转到控制面板 > 程序 > 默认程序 > 关联文件类型或协议，然后双击 HTTP 或 HTTPS，我只会看到 Google Chrome 和 IE 的选项。没有浏览选项。最后，我希望能够以编程方式执行此操作。但是为了看看我是否可以让它显示出来，我将这些条目基于 Google Chrome 的条目。

```
HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet\DEFAULTBROWSER\Capabilities\StartMenu  StartMenuInternet = Default Browser Fixer
HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet\DEFAULTBROWSER\Capabilities\URLAssociations  http and https = C:\browserFix.exe 
```

看起来 Windows 甚至还没有将程序视为浏览器，更不用说默认浏览器了。谁能指出我正确的方向？请记住，我希望将来能够使用安装程序批处理脚本来执行此操作。

提前致谢！
杰克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:47:44.293

程序必须有注册表项，表明它可以处理特定类型的文件。有关一般所需注册表项的详细信息，请参阅[http://msdn.microsoft.com/en-us/library/windows/desktop/ee872121(v=vs.85).aspx及其链接，以及](http://msdn.microsoft.com/en-us/library/windows/desktop/ee872121(v=vs.85).aspx)[http://msdn .microsoft.com/en-us/library/aa767914(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/aa767914(v=vs.85).aspx)了解如何注册 URI 协议处理程序。

# c# - freedb.org - 如何在没有光盘 ID 的情况下按艺术家/专辑查询

> ID：10557145
> 
> 赞同：2
> 
> 时间：2012-05-11T19:00:52.543
> 
> 标签：c#, web-services, screen-scraping, web-scraping

我正在开发一个 C# 程序，它将（希望）标准化我的 mp3 文件中的流派。为此，我将尝试使用 last.fm、discogs、freedb 以及我能找到的任何其他在线音乐数据库来返回每张专辑的流派。我计划在这些数据库之间获取结果，以自动计算我的 mp3 的流派/流派列表。

似乎 freedb 旨在根据翻录 CD 中的光盘 ID 返回数据。我想做的是以类似的方式查询 freedb，last.fm 允许您按艺术家/专辑进行查询，然后从匹配的条目中返回结果。

我的问题是最好的方法是什么？看起来 freedb 不允许 REST 调用。我需要做一些网络抓取来实现这一点吗？是否有任何开源应用程序可以抓取我可以查看的 freedb 数据？

谢谢！杰森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:16:12.470

freedb 数据库可以根据您的喜好免费下载和使用。您可以随时下载它，将其导入本地数据库，然后根据需要查询它。

[数据库](http://www.freedb.org/en/download__database.10.html)

[freedb 数据库的解析器](https://github.com/ayende/XmcdParser)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-11T23:44:11.517

lastfm 和其他一些音乐服务有一个开放的数据表，我会尝试用[yql查询它们](http://developer.yahoo.com/yql/console/)

# java - 如何告诉 Proguard 避免混淆 JNA 库类？

> ID：10557146
> 
> 赞同：9
> 
> 时间：2012-05-11T19:00:53.573
> 
> 标签：java, proguard, jna

换句话说：我`-keep`应该使用什么命令来告诉 Proguard 避免混淆代表本机库的类？（因为 JNA 要求名称与等效的本机函数、结构等匹配）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T17:58:03.493

这是我现在使用的规则：

```
-keepclassmembers class * extends com.sun.jna.** {
    <fields>;
    <methods>;
} 
```

我仍然认为可能有更好的方法来做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-10-27T11:03:24.637

对我来说也有效

```
-keep class com.sun.jna.** { *; }
-keep class * implements com.sun.jna.** { *; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-10T05:08:33.730

我想我用这些规则解决了这个问题，因为他们似乎需要对包的所有内容进行去混淆处理：

```
-keep class com.sun.jna.** { *; }
-keep class * implements com.sun.jna.** { *; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T20:02:01.240

JNA 默认使用库接口方法名称来查找本机函数名称。除此之外的任何东西都应该能够承受混淆。

如果您的测试包括所有 JNA 调用的覆盖范围，那么您应该能够几乎与在此处提出问题一样快地进行测试。

**编辑**

考虑这是一条评论，因为我不准备提供“-keep”命令:)

您当然必须避免消除或重新排序任何结构字段。

# django - 从 django 发送电子邮件

> ID：10557147
> 
> 赞同：1
> 
> 时间：2012-05-11T19:00:59.327
> 
> 标签：django

我有一个包含订阅者和他们的数据的数据库我还有一个安静的 api 设置来接收和发送来自/发送到数据库的数据。

我想在 Django 中创建一个前端，以使用 django 模板发送和创建电子邮件，以自定义我发送的电子邮件。

所以我想向 django 提供一个查询，它将它发送到 db API 返回电子邮件列表和必要的信息。然后，Django 将使用数据库作为模板上下文返回的 JSON 数据构建个性化电子邮件，然后将电子邮件和电子邮件地址传递给使用 Sendgrid 的 API 将电子邮件发送给我的订阅者的函数。

这听起来像这样做的好方法吗？也有人可以给我任何关于如何最好地制作这样的东西的提示或指示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:59:37.053

SendGrid 的 API 可以从您通过 Django 的 Python API 提供的关联数组中替换值。

您可以将收件人分组为密件抄送并发送 1 封电子邮件，而不是发送 n * 个单独的电子邮件，然后 SendGrid 的 API 将用替换值替换指定的文本片段。这很简单。另请查看[https://github.com/sendgrid/sendgrid-python](https://github.com/sendgrid/sendgrid-python)，让您的生活更轻松。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T22:25:42.640

我过去用自定义管理命令做过这种事情。它本质上是一个 Python 脚本，可以轻松访问您的 Django 数据，并让您基本上可以做任何 Python 能够做的事情。然后，您可以轻松地使用 cron 安排作业，将数据汇总为 JSON 并将其传递，或者您希望将其作为独立脚本进行任何其他操作。

[https://docs.djangoproject.com/en/1.3/howto/custom-management-commands/](https://docs.djangoproject.com/en/1.3/howto/custom-management-commands/)

Django 有一个内置的电子邮件系统，它也可以很好地工作，但听起来你已经为 SMTP 或任何使用 SendGrid 的东西设置好了。

[https://docs.djangoproject.com/en/1.3/topics/email/](https://docs.djangoproject.com/en/1.3/topics/email/)

# c# - 将 MSMQ 消息发送到远程事务队列

> ID：10557148
> 
> 赞同：4
> 
> 时间：2012-05-11T19:01:01.557
> 
> 标签：c#, msmq, msdtc, transactional-queue

我是 MSMQ 的新手，正在尝试将 XML 消息发送到远程事务队列。两台机器都是2003服务器。我可以让它与非事务性远程队列一起工作。我似乎无法将消息放到事务队列中。C# 代码如下。我没有收到它从未出现过的错误。

```
Message rqMessage = new Message();
System.Xml.Serialization.XmlSerializer ser = new System.Xml.Serialization.XmlSerializer( typeof([message type]));

XmlTextWriter writer = new XmlTextWriter(rqMessage.BodyStream, Encoding.UTF8);
ser.Serialize(writer, rqDoc);
rqMessage.Label = "message label";
rqMessage.TimeToBeReceived = Message.InfiniteTimeout;
rqMessage.TimeToReachQueue = Message.InfiniteTimeout;
rqMessage.ResponseQueue = new MessageQueue("Path");
rqMessage.Formatter = new ActiveXMessageFormatter();
MessageQueue rqQueue = new MessageQueue(nodeRequestQueue.SelectSingleNode("Path").InnerText);

bool transactional = false;
try
{
    transactional = rqQueue.Transactional;
}
catch(MessageQueueException)
{
    transactional = false;
}
if ( transactional )
    rqQueue.Send(rqMessage, MessageQueueTransactionType.Single);
else
    rqQueue.Send(rqMessage); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:37:56.707

您可以显式创建事务。

```
using (var transaction = new MessageQueueTransaction())
{
    transaction.Begin();
    rqQueue.Send(rqMessage, transaction);
    transaction.Commit();
} 
```

对于您正在使用的重载，您可能没有“直接格式名称”并且该选项不受支持。 [MSDN](http://msdn.microsoft.com/en-us/library/3hyd9xby)

# linux - 无法写入具有权限的文件夹

> ID：10557149
> 
> 赞同：1
> 
> 时间：2012-05-11T19:01:08.563
> 
> 标签：linux, permissions, usergroups

我正在尝试将我的本地服务器 htdocs 文件夹配置为在没有 root 权限的情况下写入其中，但没有 chmod 777 的丑陋方式。我创建了一个新组，将其设置为文件夹，将权限更改为 775 并添加我的用户到这个新组。这是结果：

```
$ ls -ld .
drwxrwxr-x 4 nobody htdocs 4096 ago 27  2009 .
$ id asbel
uid=1000(asbel) gid=1000(asbel) grups=1000(asbel),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),109(lpadmin),124(sambashare),1002(htdocs)
$ touch test
touch: no s’han pogut canviar les dates de «test»: S’ha denegat el permís 
```

最后一个命令的答案说我没有权限在这里写。

这里有什么问题？另外，我希望在创建新文件夹时它们具有相同的组权限，因为我希望该组的其他用户可以修改它们。这是正确的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T11:53:31.540

> 要使新组生效，您必须注销并重新登录（打开一个新的 shell 是不够的）

@nm （最初[是](https://stackoverflow.com/users/775806/n-m)对这个问题[的评论）](https://stackoverflow.com/questions/10557149/cant-write-in-a-folder-with-permissions#comment13665227_10557149)

# math - 数学：具有唯一和的五个数字

> ID：10557152
> 
> 赞同：8
> 
> 时间：2012-05-11T19:01:34.443
> 
> 标签：math, numbers, sum, unique

所以我需要一种方法来弄清楚如何获得 5 个数字，当你添加其中任何 2 个时，它会产生一个总和，你只能通过添加这两个特定的数字来获得。

这是我正在谈论的一个示例，但有 3 个数字：

1
3
5

1 + 3 = 4
1 + 5 = 6
3 + 5 = 8

将这些数字中的任何两个相加最终都会得到一个唯一的总和，而该总和是通过添加任何其他数字对都无法找到的。我需要这样做，但有 5 个不同的数字。而且，如果您有一种方法可以弄清楚如何使用任意数量的数字来做到这一点，那么也将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-11T19:09:47.943

`1, 10, 100, 10000, 100000`给你五个你想要的数字。

通常，您需要的数字数量在`1, 10, 100, 1000, ..., 10^k`哪里。`k`

更一般地说，你可以说`b^0, b^1, ..., b^k`，在哪里`b >= 2`。请注意，您具有的特殊属性不仅是所有成对和都是唯一的，而且所有子集和都是唯一的（只需查看 base 中的表示`b`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T19:34:04.237

该套装`{1, 2, 5, 11, 21}`也有效。

您可以从适合该属性的两个或三个元素的集合开始（对集合中两个元素的任何加法运算`{1,2,5}`都会给您一个唯一的总和），并且如果当前元素的加法和这个新元素也给出，则仅包括考虑的下一个数字你独特的总和。

一个示例贯穿：

假设我们的起始集`S`是`S={1,2,5}`。让`U`是 中两个元素之间的所有和的集合`S`。中的元素`S`给了我们唯一的和`1+2=3`，,,,所以。`1+5=6``2+5=7``U={3,6,7}`

考虑添加`11`到这个集合中。我们需要检查`1+11`, `2+11`, 并且`5+11`它们都给了我们没有看到的`U`和在它们之间都是唯一的。

`1+11=12`, `2+11=13`, `5+11=17`.

由于`12`、`13`和`17`都是它们之间唯一的和，并且不在 中`U`，我们可以更新`S`和`U`为： `S1 = {1,2,5,11}` `U1 = {3,6,7,12,13,17}`。

您可以对 执行相同的程序`21`，并且您应该（希望）得到： `S2 = {1,2,5,11,21}` `U2 = {3,6,7,12,13,17,22,23,26,32}`。

如果您只需要一个快速设置，那么 Jason 发布的解决方案的生成速度要快得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T19:13:00.380

```
1
2
4
8
16

1
3
9
27
81 
```

建议 x ^ n 其中 n 是自然数子集的成员

# asp.net - asp.net 图像如何为 IMG src 赋值

> ID：10557155
> 
> 赞同：0
> 
> 时间：2012-05-11T19:02:23.920
> 
> 标签：asp.net

我有以下硬编码的代码

```
 <img src="data:image/png;base64,iVBORw0KGgoAAAANSUh .... " > 
```

通过 asp.net，我如何分配 src 的值，因为我需要从数据库中提取值并为其分配一个值，而不是我目前使用的硬编码方式。我正在使用获胜表格。

请注意， src 的值为字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:07:08.433

如果您想将图像数据嵌入为示例中的[数据 URI](http://en.wikipedia.org/wiki/Data_URI_scheme)，则需要从数据库中获取原始图像数据（如果尚未进行 base64 编码）并使用 .base64 对其进行编码[`Convert.ToBase64String`](http://msdn.microsoft.com/en-us/library/dhx0d524.aspx)。

您可以将这样的值直接分配给 image ，如果还没有，则`src`附加。`data:image/png;base64,`

但是，如果您不想使用数据 URI，大多数人这样做的方法是创建一个 HTTP 处理程序，该处理程序将从数据库中获取图像并返回字节数组并将`src`属性指向它。该网站上有多个与此相关的问题 - 请参阅[这些搜索结果](https://stackoverflow.com/search?q=load%20image%20from%20database%20%5Bc#%5D%20%5Basp.net%5D)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:07:22.973

您可以使用`<asp:Image Runat="server".../>`控制，或者您可以提供一个 ID 并使 Img 成为服务器大小。

前任： `<img src="..." runat="server" ID="MyImageUniqueID" />`

然后，您可以在服务器端访问此控件的属性并从 DB 中填充它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T19:09:29.023

您始终可以将 HTTP 响应更改为 PNG 内容类型，将图像的二进制数据输入响应正文，并从 ASP 提供该响应。

您只需为要显示为请求参数的图像传递一个唯一标识符。

然后，该`src`属性可以使用代表您要加载的图片的请求参数指向此 ASP 页面的 URL。

# ios - 在核心图形中绘制圆角矩形

> ID：10557157
> 
> 赞同：4
> 
> 时间：2012-05-11T19:02:28.310
> 
> 标签：ios, ipad, ios5, core-graphics, rounded-corners

我想复制默认 iPad 日历的事件标记，如下所示：

![在此处输入图像描述](../Images/0a45c614da8451be97fe5ea8530e7e79.png) 我正在尝试为此使用 coregraphics，绘制圆角矩形的路径。这是我能想到的结果：

![在此处输入图像描述](../Images/f618089243e4f824dc12efc2005f3fae.png)

如您所见，iPad 的版本在圆角上看起来更加平滑。我尝试使用更大的线宽，如下所示： ![在此处输入图像描述](../Images/c2a5c789cb36d38878298627d5262434.png)

我的代码如下所示（从这个网站获得）：

```
UIColor* fillColor= [self.color colorByMultiplyingByRed:1 green:1 blue:1 alpha:0.2];

CGContextSetLineWidth(ctx, 1.0);
CGContextSetStrokeColorWithColor(ctx, self.color.CGColor);
CGContextSetFillColorWithColor(ctx, fillColor.CGColor);

CGRect rrect = self.bounds;

CGFloat radius = 30.0;
CGFloat width = CGRectGetWidth(rrect);
CGFloat height = CGRectGetHeight(rrect);

if (radius > width/2.0)
   radius = width/2.0;

if (radius > height/2.0)
   radius = height/2.0;    

CGFloat minx = CGRectGetMinX(rrect);
CGFloat midx = CGRectGetMidX(rrect);
CGFloat maxx = CGRectGetMaxX(rrect);
CGFloat miny = CGRectGetMinY(rrect);
CGFloat midy = CGRectGetMidY(rrect);
CGFloat maxy = CGRectGetMaxY(rrect);
CGContextMoveToPoint(ctx, minx, midy);
CGContextAddArcToPoint(ctx, minx, miny, midx, miny, radius);
CGContextAddArcToPoint(ctx, maxx, miny, maxx, midy, radius);

CGContextAddArcToPoint(ctx, maxx, maxy, midx, maxy, radius);
CGContextAddArcToPoint(ctx, minx, maxy, minx, midy, radius);
CGContextClosePath(ctx);
CGContextDrawPath(ctx, kCGPathFillStroke);

// draw circle on left side

CGRect target= CGRectMake(rect.origin.x + 4.0, 
                          rect.origin.y + 3.0, 
                          7.0, 7.0);

CGContextSetFillColorWithColor(ctx, self.color.CGColor);
CGContextSetAlpha(ctx, 0.4);
CGContextFillEllipseInRect(ctx, target);

CGContextSetAlpha(ctx, 0.9);
CGContextSetStrokeColorWithColor(ctx, self.color.CGColor);
CGContextStrokeEllipseInRect(ctx, target); 
```

任何人都可以帮助我使结果更接近原始结果吗？我应该使用不同的技术来绘制圆角矩形，还是可以更改任何参数以使其看起来更平滑？我已经尝试过使用 a `UIBezierPath`，但它看起来基本相同。有小费吗？

[编辑]`CGRectInset`基于 - 的解决方案如下所示：

![在此处输入图像描述](../Images/12f4019a801a3978fdd7daee4c704418.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T19:10:21.193

您的问题是描边应用在路径的中心，其中一半被裁剪/遮蔽到视图的边界，因为它在视图之外绘制。如果您在每个方向上插入一个点，您将获得您正在寻找的结果。如果您增加笔画的宽度，您将需要进一步插入绘图（笔画宽度的一半（即 4 点宽的笔画应插入 2 点）。

这可以通过更改轻松解决

```
CGRect rrect = self.bounds; 
```

进入

```
// Inset x and y by half the stroke width (1 point for 2 point stroke) 
CGRect rrect = CGRectInset(self.bounds, 1, 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:12:53.347

这是因为笔划以路径为中心，这意味着它的一半在矩形内部，另一半在外部。

要解决此问题，请将您的笔画宽度加倍并在笔画之前[剪辑到路径](http://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextClip)。结果是一个内部笔划，它将完全在矩形内。

请注意，在 Quartz 中剪切到当前路径将重置当前路径，因此您应该[将路径创建为 CGPath](http://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CGPath/)，以便您可以[添加](http://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextAddPath)、剪切、再次添加和描边。

# php - 如何使用 jquery 和 ajax 查询 mysql 数据库？

> ID：10557165
> 
> 赞同：1
> 
> 时间：2012-05-11T19:02:58.717
> 
> 标签：php, mysql, ajax, jquery

我有一个带有“选择”框的表格。选中该框后，我希望数据库中的相应记录显示在同一页面上。

涉及两个文件：一个包含表单的 HTML 页面：

```
<form id="theForm">
<select id="theDropdown">
<option value="biology">Biology</option>
<option value="chemistry">Chemistry</option>
<option value="english">English</option>
</select>
</form>
<div id="resultsGoHere"></div> 
```

并且还包含 jQuery 代码：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

    $('#theDropdown').on('change', function() {
       var qString = '{sub: ' + $('#theDropdown option:selected').text() + '}';
       $.post('sub_db_handler.php', qString, processResponse);
       // $('#resultsGoHere').html(qString);
    });

    function processResponse(data) {
        $('#resultsGoHere').html(data);
    }

});
</script> 
```

jQuery 代码似乎成功地获取了选择菜单的选定值并格式化了一个 JSON 查询字符串，如果上面的注释行未注释，则会打印出该字符串。

这是`post`上面命令中引用的 PHP 脚本。

```
<?php

$con = mysql_connect("localhost","rongilmo_ron","******");
if(!$con) { die('Could not connect: ' . mysql_error()); }
mysql_select_db("rongilmo_databases", $con);
$sub = $_POST['theDropdown'];

$q = "SELECT dbs.db_name, dbs.db_url FROM dbs, subjects, subjects_databases
WHERE subjects.subject_id=subjects_databases.subject_id
AND subjects_databases.database_id=dbs.db_id
AND subjects.subject_name='$sub'";

$r = mysql_query($q);
$array = mysql_fetch_row($r);
echo json_encode($array);

?> 
```

我根本没有得到任何结果。我已经在非 ajax 模式下测试了查询，所以这不是问题。

对 ajax 还是很陌生。尽管阅读了很多教程并进行了很多谷歌搜索，但我已经为此工作了两天，但似乎无法使其工作。

您能提供的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:07:47.843

Give your select a name attribute.

```
<form id="theForm">
    <select id="theDropdown" name="theDropdown">
        <option value="biology">Biology</option>
        <option value="chemistry">Chemistry</option>
        <option value="english">English</option>
    </select>
</form>
<div id="resultsGoHere"></div> 
```

**Update.** PHP is expecting a query string in the standard URL-encoded notation not JSON. By sending it the following way the $_POST array should contain 'sub' with the value of the selected option.

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

    $('#theDropdown').change(function() {   
        var qString = 'sub=' +$(this).val();
        $.post('sub_db_handler.php', qString, processResponse);
    });

    function processResponse(data) {
        $('#resultsGoHere').html(data);
    }

});
</script>

<?php

    $con = mysql_connect("localhost","rongilmo_ron","******");
    if(!$con) { die('Could not connect: ' . mysql_error()); }
    mysql_select_db("rongilmo_databases", $con);
    $sub = $_POST['sub'];

    $q = "SELECT dbs.db_name, dbs.db_url FROM dbs, subjects, subjects_databases
    WHERE subjects.subject_id=subjects_databases.subject_id
    AND subjects_databases.database_id=dbs.db_id
    AND subjects.subject_name='$sub'";

    $r = mysql_query($q);
    $array = mysql_fetch_row($r);
    echo json_encode($array);

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:23:51.453

您应该使用 ajax $.getJson() 返回一个 json 字符串。它将要求您在 json 字符串上使用 $each。请参阅网站[http://api.jquery.com/jQuery.getJSON/上的 jquery 文档](http://api.jquery.com/jQuery.getJSON/)

# iphone - 变量在块内设置后为空

> ID：10557167
> 
> 赞同：3
> 
> 时间：2012-05-11T19:03:11.760
> 
> 标签：iphone

我认为我不明白在这种情况下块是如何工作的。我正在尝试从 CLGeocoder 获取位置并在块完成后保存 MKPlacemark。所以在这个方法中：

```
- (MKPlacemark *)placeMarkFromString:(NSString *)address {
    CLGeocoder *geocoder = [[CLGeocoder alloc] init];
    __block MKPlacemark *place;
    [geocoder geocodeAddressString:address completionHandler:^(NSArray *placemarks, NSError *error) {
        [placemarks enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
            NSLog(@"%@", [obj description]);
        }];

        // Check for returned placemarks
        if (placemarks && [placemarks count] > 0) {
            CLPlacemark *topResult = [placemarks objectAtIndex:0];

            // Create an MKPlacemark and add it to the mapView
            place = [[MKPlacemark alloc] initWithPlacemark:topResult];
            [self.mapView addAnnotation:place];
        }

        if (error) {
            NSLog(@"Error: %@", [error localizedDescription]);
        }
    }];
    NSLog(@"%@", [place description]);
    return place;
} 
```

当我运行我的代码时，MKPlacemark 位置确实会添加到地图中。但是，如果我记录该值，则它为 NULL。我认为这可能是因为该块没有立即执行，对吧？所以我的 NSLog 可能会先执行，然后完成处理程序运行。但是，我将如何从该方法返回 MKPlacemark，以便可以在代码的其他地方使用该值？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:06:45.033

如果您想保留“位置”，请为它在 self（无论 self 是什么）上创建一个 ivar/property。将其声明为 __block 变量。然后做：

self.place = [[MKPlacemark alloc] initWithPlacemark:topResult];

或者，如果您想跟踪多个位置，则可以创建一个 NSArray ivar，然后在每次块执行时将对象添加到数组中。

是的，你的 NSLog(@"%@", [place description]); 将在块执行之前运行。

编辑：如果您想从此方法“返回”位置，您需要使您的方法成为块方法，如下所示：

```
typedef void (^SuccessBlock)(id);
typedef void (^FailureBlock)(NSError *);

- (void)placeMarkFromString:(NSString *)address withSuccess:(SuccessBlock)success andFailure:(FailureBlock)failure {

    ... //inside the enumerateObjectsUsingBlock block
    success(place);

    ...
    failure(error);

} 
```

# javascript - 不包括零的最小数量

> ID：10557176
> 
> 赞同：11
> 
> 时间：2012-05-11T19:03:47.037
> 
> 标签：javascript

我需要从数字列表中找到最小数字，不包括零。

是否有一些内部功能可以做到这一点？或者我必须在`Math.min`使用之前从列表中删除零？

*例子：*

输入：`213`, `0`, `32`, `92`, `0`, `2992`,`39`

结果：`32`

* * *

**[更新]**如果可能，请提供将输入作为参数的函数代码，例如`nonZeroMin(213, 0, 32, 92, 0, 2992, 39)`

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2017-02-28T09:04:13.010

*代码/解决方案：*

```
var arr = [3, 0, 7, 12, 0, 5, 22];
var minValue = Math.min.apply(null, arr.filter(Boolean)); 
```

*这个怎么运作：*

`arr.filter`创建一个新数组，其中包含通过所提供函数实现的测试的所有元素。因此，在上面的代码中，数组的每个值都将由`Boolean(value)`

```
Boolean(3) // true 
Boolean(0) // false
Boolean(7) // true
// ... 
```

因此，我们将获得新的过滤数组，其中包含除零之外的所有元素。

然后`Math.min.apply(null, ...)`在这样的数组中找到最小值。

`null`在这种情况下是一个上下文。它可以是`null`, `this`, `Math`- 结果是一样的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-11T19:07:38.917

```
var arr = [213, 0, 32, 92, 0, 2992, 39];

var min = arr.filter(function (x) { return x !== 0; })
    .reduce(function (a, b) { return Math.min(a, b); }, Infinity); 

alert(min);  // => 32 
```

`filter`并且`reduce`是 EcmaScript 5 的补充`Array`，但为它们`MDN`提供了[代码](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/reduce)，以防您需要在较旧的浏览器上运行它。

* * *

编辑：这是在 var-args 样式函数中工作的更短的方法。

```
 function minNonZero(var_args) {
   return Array.prototype.reduce.call(arguments, function (prev, current) {
     return prev && current ? Math.min(prev, current) : prev || current;
   });
 }

 alert(minNonZero(213, 0, 32, 92, 0, 2992, 39)); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-11T19:10:10.510

您可以过滤除零以外的正数并对数组进行排序：

```
list.filter(function(x){ 
    return x> 0;
}).sort(function(a,b){
   return a>b;
})[0]; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-07-14T17:24:33.680

这个怎么样？

```
var arry = [213, 0, 32, 92, 0, 2992, 39];
Math.min.apply(Math, arry.filter(Number)); // => 32 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-11T19:06:18.740

您必须删除零，然后使用`Math.min`，如下所示：

```
function nonZeroMin() { // input can be as many parameters as you want
    var args = Array.prototype.slice.call(arguments);
    for(var i = args.length-1; i>=0; i--) {
        if(args[i] == 0) args.splice(i, 1);
    }

    return Math.min.apply(null,args);
} 
```

编辑以允许根据更新的问题输入参数。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-11T19:22:38.480

如果要创建一个带有未知数量参数的函数，可以[`arguments`](https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope/arguments)在该函数内部使用。

要找到最小的非零数字，您可以对数组进行排序，并将零（和非数字）排序到最后。

```
function nonZeroMin(){
    var args = Array.prototype.slice.call(arguments);
    args.sort(function(a, b){
        if(a === null || isNaN(a) || a === 0) return 1;
        if(b === null || isNaN(b) || b === 0) return -1
        return a-b;
    });
    return args[0];
} 
```

然后你可以这样做：`nonZeroMin(213, 0, 32, 92, 0, 2992, 39)`。

# magento - Magento 致命错误：在第 149 行的 Js.php 中的非对象上调用成员函数 getAttribute()

> ID：10557181
> 
> 赞同：0
> 
> 时间：2012-05-11T19:04:10.283
> 
> 标签：magento

我正在为自己的生活而奋斗，以便真正进入我域中的 Magento 后端。我已经重新安装了几次，但我无法在没有弹出一些错误的情况下进入。这是最新的：

致命错误：在第 149 行的 /app/code/core/Mage/Core/Helper/Js.php 中的非对象上调用成员函数 getAttribute()

当我登录管理区域时会弹出上述错误，这是我看到的唯一内容。我刷新，清除缓存，使用不同的浏览器（我尝试过最新版本的 Firefox 和 Chrome）和同样的错误。

有人会帮我吗？我已经为此工作了几天，试图自己解决这个问题。但我完全没有想法。谢谢！

Js.php 文件如下

```
<?php 
```

class Mage_Core_Helper_Js extends Mage_Core_Helper_Abstract { /** * 缓存键 */ const JAVASCRIPT_TRANSLATE_CONFIG_KEY = 'javascript_translate_config';

```
/**
 * Translate file name
 */
const JAVASCRIPT_TRANSLATE_CONFIG_FILENAME = 'jstranslator.xml';

/**
 * Array of senteces of JS translations
 *
 * @var array
 */
protected $_translateData = null;

/**
 * Translate config
 *
 * @var Varien_Simplexml_Config
 */
protected $_config = null;

/**
 * Retrieve JSON of JS sentences translation
 *
 * @return string
 */
public function getTranslateJson()
{
    return Mage::helper('core')->jsonEncode($this->_getTranslateData());
}

/**
 * Retrieve JS translator initialization javascript
 *
 * @return string
 */
public function getTranslatorScript()
{
    $script = 'var Translator = new Translate('.$this->getTranslateJson().');';
    return $this->getScript($script);
}

/**
 * Retrieve framed javascript
 *
 * @param   string $script
 * @return  script
 */
public function getScript($script)
{
    return '<script type="text/javascript">//<![CDATA[
    '.$script.'
    //]]></script>';
}

/**
 * Retrieve javascript include code
 *
 * @param   string $file
 * @return  string
 */
public function includeScript($file)
{
    return '<script type="text/javascript" src="'.$this->getJsUrl($file).'"></script>'."\n";
}

/**
 * Retrieve
 *
 * @param   string $file
 * @return  string
 */
public function includeSkinScript($file)
{
    return '<script type="text/javascript" src="'.$this->getJsSkinUrl($file).'"></script>';
}

/**
 * Retrieve JS file url
 *
 * @param   string $file
 * @return  string
 */
public function getJsUrl($file)
{
    return Mage::getBaseUrl('js').$file;
}

/**
 * Retrieve skin JS file url
 *
 * @param   string $file
 * @return  string
 */
public function getJsSkinUrl($file)
{
    return Mage::getDesign()->getSkinUrl($file, array());
}

/**
 * Retrieve JS translation array
 *
 * @return array
 */
protected function _getTranslateData()
{
    if ($this->_translateData === null) {
        $this->_translateData = array();
        $messages = $this->_getXmlConfig()->getXpath('*/message');
        if (!empty($messages)) {
            foreach ($messages as $message) {
                $messageText = (string)$message;
                $module = $message->getParent()->getAttribute("module");
                $this->_translateData[$messageText] = Mage::helper(empty($module) ? 'core' : $module
                )->__($messageText);
            }
        }

        foreach ($this->_translateData as $key => $value) {
            if ($key == $value) {
                unset($this->_translateData[$key]);
            }
        }
    }
    return $this->_translateData;
}

/**
 * Load config from files and try to cache it
 *
 * @return Varien_Simplexml_Config
 */
protected function _getXmlConfig()
{
    if (is_null($this->_config)) {
        $canUsaCache = Mage::app()->useCache('config');
        $cachedXml = Mage::app()->loadCache(self::JAVASCRIPT_TRANSLATE_CONFIG_KEY);
        if ($canUsaCache && $cachedXml) {
            $xmlConfig = new Varien_Simplexml_Config($cachedXml);
        } else {
            $xmlConfig = new Varien_Simplexml_Config();
            $xmlConfig->loadString('<?xml version="1.0"?><jstranslator></jstranslator>');
            Mage::getConfig()->loadModulesConfiguration(self::JAVASCRIPT_TRANSLATE_CONFIG_FILENAME, $xmlConfig);

            if ($canUsaCache) {
                Mage::app()->saveCache($xmlConfig->getXmlString(), self::JAVASCRIPT_TRANSLATE_CONFIG_KEY,
                    array(Mage_Core_Model_Config::CACHE_TAG));
            }
        }
        $this->_config = $xmlConfig;
    }
    return $this->_config;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T00:52:01.883

你清除缓存？如何？你也清除会话吗？我们现在有一个功能，这意味着我们必须不时手动清除这些，然后才能自己进入管理。这是 SSH shell 的输出...

```
var# ls
./  ../  cache/  export/  locks/  log/  package/  pear/  report/  session/
var# rm -rf cache/*
var# rm -rf session/* 
```

所以我写了一个网页/php-script 来做这件事，这样我们的员工就可以在没有 SSH 的情况下做到这一点：

```
<pre><?php
$output;
$retval;
$errors="";
$command="pwd";
exec ( $command ,  &$output, &$retval  );
$path=$output[0];
unset($output);
echo "rm -rf $path/var/cache/*\n";
if( 0 ) {   // change to 1 after seeing the above looks ok!
    $command="rm -rf $path/var/cache/*";
    exec ( $command ,  &$output, &$retval  );
    echo "<b>$command</b> returned $retval\n";
    if($retval > 0)
        $errors .= "There was a problem deleting cache files.\n";
    // ------------------------------------------------
    $command="ls -alh $path/var/cache";
    exec ( $command ,  &$output, &$retval  );
    echo "<b>$command</b> returned $retval; the directory listing should only have . and ..\n\$output:";
    print_r($output);
    unset($output);
    // ------------------------------------------------
    $command="rm -rf $path/var/session/*";
    exec ( $command ,  &$output, &$retval  );
    echo "<b>$command</b> returned $retval\n";
    if($retval > 0)
        $errors .= "There was a problem deleting session files.\n";
    // ------------------------------------------------
    $command="ls -alh $path/var/session";
    exec ( $command ,  &$output, &$retval  );
    echo "<b>$command</b> returned $retval; the directory listing should only have . and ..\n\$output:";
    print_r($output);
    unset($output);
}
if( strlen($errors) == 0 )
    echo "<h2>Yaay! you can get into admin again...</h2>";
else
    echo "<h2 style=\"color:red\">Boo! something went wrong...</h2>$errors\n";
?></pre> 
```

将 if(0) 更改为 1 后，如果您访问此文件（我称之为`__cache_clear.php`），输出应如下所示：

```
rm -rf /home/username/public_html/var/cache/*
rm -rf /home/username/public_html/var/cache/* returned 0
ls -alh /home/username/public_html/var/cache returned 0; the directory listing should only have . and ..
$output:Array
(
    [0] => total 16K
    [1] => drwxrwxrwx  2 username username 4.0K May 13 19:42 .
    [2] => drwxr-xr-x 10 username username 4.0K May 10 15:17 ..
)
rm -rf /home/username/public_html/var/session/* returned 0
ls -alh /home/username/public_html/var/session returned 0; the directory listing should only have . and ..
$output:Array
(
    [0] => total 248K
    [1] => drwxrwxrwx  2 username username 232K May 13 19:42 .
    [2] => drwxr-xr-x 10 username username 4.0K May 10 15:17 ..
)
Yaay! you can get into admin again... 
```

请注意，“用户名”是您在网络托管公司分配的用户名，并且会有所不同。我使脚本动态化，一旦放置在 Magento 文件夹中，它就会正常运行。

# css - CSS文本缩进结合空白

> ID：10557182
> 
> 赞同：3
> 
> 时间：2012-05-11T19:04:34.257
> 
> 标签：css, text-indent

我已经有以下风格：`white-space: pre-wrap;`

这允许将换行符视为元素的换行符（并且空格不会折叠）。

现在我想申请`text-indent: -40px; padding-left: 40px;`尝试产生这样的东西：

```
This is a long line of text (or at least, just pretend it is) so it  
        will indent when it wraps.
Further lines of text appear as normal, but again if they exceed the
        maximum width then they wrap and indent. 
```

不幸的是，它并没有达到我的预期：

```
This is a long line of text (or at least, just pretend it is) so it
        will indent when it wraps.
        Further lines of text appear as normal, but again if they
        exceed the maximum width then they wrap and indent. 
```

CSS中有没有办法缩进换行，但将换行算作新的第一行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:28:20.397

不，因为`text-indent`与元素的第一行有关，并且换行生成的换行符不会创建元素。因此，您需要使用一些内容标记，而不仅仅是 HTML 源代码中的换行符。

# logging - 登录“经典”风格的 Sinatra 应用程序

> ID：10557183
> 
> 赞同：1
> 
> 时间：2012-05-11T19:04:38.353
> 
> 标签：logging, sinatra

我正在尝试在我的简单经典风格的 sinatra 应用程序中设置日志记录。(v1.3.2) 我在 environment.rb 文件中定义了所有设置，如下所示：

```
require 'sinatra'
require 'couchrest'
require 'couchrest_model'
require 'json'
require "net/http"
require "uri"
require 'shotgun'  # to auto-restart server on page reload

enable :run, :logging

# CouchDB setup
configure do
  SiteConfig = OpenStruct.new(
                              :url_base => 'http://localhost:4567/',
                              :url_base_db => 'http://localhost:5984/',
                              :db_name => 'adrequest'
                              )
end

# Logging setup
logger = Logger.new('vehicle.log')
use Rack::CommonLogger, logger 
```

我的应用程序文件如下所示：

```
require './environment'

class Vehicle < CouchRest::Model::Base
  use_database CouchRest.database!((SiteConfig.url_base_db || '') + SiteConfig.db_name)

  property :url, String
  timestamps!

  validates_presence_of :url
end

get '/*' do

  requesturl = params[:splat].first

  @vehicle = Vehicle.new
  @vehicle.url = requesturl
  @vehicle.save
  puts "logger: #{env['rack.logger']}"
  puts "env: #{ENV['RACK_ENV']}"
  logger.info "written to DB"
end

not_found do
  halt 404, 'page not found'
end 
```

结果是：

```
logger: #<Rack::NullLogger:0x007fb4f4ccc238>
env: development 
```

该应用程序创建了一个“vehicle.log”文件，但它是空的。如何让 logger.info 写入我的“vehicle.log”文件？

我在这里阅读了 Sinatra README：[http](http://www.sinatrarb.com/intro#Logging) ://www.sinatrarb.com/intro#Logging 。这似乎暗示我所需要的只是：

```
enable :logging 
```

然后 sinatra 将从 Rack::CommonLogger 获取其余配置，但它没有说明如何准确地做到这一点......

提前感谢您的任何想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T19:50:16.383

“记录器”永远不会在应用程序文件中启用的原因是因为它在 environment.rb 文件中具有本地范围。通常，在文件中定义的 Ruby 变量在该文件中是本地范围的。

我对此的解决方案是使“记录器”变量成为全局变量：

```
$logger = Logger.new('vehicle.log') 
```

虽然全局变量的使用通常不受欢迎，但这个应用程序足够简单，可能没问题。尽管如此，如果应用程序变得更大，那么查看更多基于模块的应用程序并以不同的方式处理配置可能会有意义。（也许使用模块或 configu.ru 文件？）

我不确定这是否是“理想”的解决方案，所以如果有人有更好的想法，请发表评论。

顺便说一句，在 environment.rb 文件中定义的 SiteConfig 变量原来是一个常量（您可以通过 do 看到这一点`puts "SiteConfig: #{defined? SiteConfig}"`），这就是为什么它的值可以在单独的应用程序文件中“看到”的原因。

# javascript - 在日历应用程序中切换月份的箭头

> ID：10557185
> 
> 赞同：0
> 
> 时间：2012-05-11T19:04:38.950
> 
> 标签：javascript, html, button

我想使用 javascript 开发一个日历，但我不知道如何处理这种情况，我的意思是我想使用 2 个箭头（一个向左，一个向右）来切换月份和年份显示天数。当按下右箭头切换到下个月等时，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:38:32.307

不久前，我修改了[jQuery datepicker](http://jqueryui.com/demos/datepicker/)以支持这种事情。我没有 git 或任何东西的来源，所以这里是：http: [//jsfiddle.net/ZUrJY/2/](http://jsfiddle.net/ZUrJY/2/)

![在此处输入图像描述](../Images/0fd2cf963ff8435c4bd1e493d33f70d2.png)

更改的相关部分在`_generateHTML`方法中。

```
var prev = (this._canAdjustMonth(inst, -1, drawYear, drawMonth) ?
'<a style="left: 22px;" class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_' + dpuuid +
'.datepicker._adjustDate(\'#' + inst.id + '\', -' + stepMonths + ', \'M\');"' +
' title="' + prevText + '"><span class="ui-icon ui-icon-circle-triangle-' + (isRTL ? 'e' : 'w') + '">' + prevText + '</span></a>' :
(hideIfNoPrevNext ? '' : '<a style="left: 22px;" class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="' + prevText + '"><span class="ui-icon ui-icon-circle-triangle-' + (isRTL ? 'e' : 'w') + '">' + prevText + '</span></a>'));

prev += (this._canAdjustMonth(inst, -12, drawYear, drawMonth) ?
'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_' + dpuuid +
'.datepicker._adjustDate(\'#' + inst.id + '\', -' + 12 + ', \'M\');"' +
' title="Prev Year"><span class="ui-icon ui-icon-circle-arrow-' + (isRTL ? 'e' : 'w') + '">Prev Year</span></a>' :
(hideIfNoPrevNext ? '' : '<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="Prev Year"><span class="ui-icon ui-icon-circle-arrow-' + (isRTL ? 'e' : 'w') + '">' + prevText + '</span></a>'));

var nextText = this._get(inst, 'nextText');
nextText = (!navigationAsDateFormat ? nextText : this.formatDate(nextText,
this._daylightSavingAdjust(new Date(drawYear, drawMonth + stepMonths, 1)),
this._getFormatConfig(inst)));
var next = (this._canAdjustMonth(inst, +1, drawYear, drawMonth) ?
'<a style="right: 22px;" class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_' + dpuuid +
'.datepicker._adjustDate(\'#' + inst.id + '\', +' + stepMonths + ', \'M\');"' +
' title="' + nextText + '"><span class="ui-icon ui-icon-circle-triangle-' + (isRTL ? 'w' : 'e') + '">' + nextText + '</span></a>' :
(hideIfNoPrevNext ? '' : '<a style="right: 22px;" class="ui-datepicker-next ui-corner-all ui-state-disabled" title="' + nextText + '"><span class="ui-icon ui-icon-circle-triangle-' + (isRTL ? 'w' : 'e') + '">' + nextText + '</span></a>'));

next += (this._canAdjustMonth(inst, +1, drawYear, drawMonth) ?
'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_' + dpuuid +
'.datepicker._adjustDate(\'#' + inst.id + '\', +' + 12 + ', \'M\');"' +
' title="Next Year"><span class="ui-icon ui-icon-circle-arrow-' + (isRTL ? 'w' : 'e') + '">Next Year</span></a>' :
(hideIfNoPrevNext ? '' : '<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="Next Year"><span class="ui-icon ui-icon-circle-arrow-' + (isRTL ? 'w' : 'e') + '">' + nextText + '</span></a>')); 
```

# javascript - window.location 去另一个页面很慢

> ID：10557186
> 
> 赞同：1
> 
> 时间：2012-05-11T19:04:41.130
> 
> 标签：javascript

为什么 window.location 需要 3 -5 秒才能转到另一页？我想在确认后立即更改页面。

```
<script>
       var a = confirm('Do you want to insert the device specifications now ؟');
       if(a)
       {
       var name = '<?= $items_name ?>';
       window.location = 'mobiles.php?name='+name;
       }else
       {
       return false;
       }
</script> 
```

在我看来 location.assign 更快

```
<script> 
var a = confirm('Do you want to insert the device specifications now?');
if(a) {  
  var name = '<?= $items_name ?>'; 
  window.location.assign('mobiles.php?name='+name); 
}
else { 
    return false; 
} 
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:09:44.437

Your code will trigger the page change immediately. If you're experiencing a delay, is is most likely the time your browser is taking to load the new page. You can try optimizing the load time for your new page. You can find various resources on the web for page load time optimizations if you simply use Google.

# c++ - 试图实现一个函数来删除链表中的结构，同时将它之前的结构分配给它之后的结构

> ID：10557193
> 
> 赞同：0
> 
> 时间：2012-05-11T19:05:11.337
> 
> 标签：c++, struct, linked-list

我知道有更好的方法来做我正在尝试的事情，但这是我用来学习 C++ 的书中的一个问题，它将帮助我在继续之前掌握一些基础知识。无论如何，这是我的代码：

```
#include <iostream>

using namespace std;

struct EnemySpaceShip
{
    int weapon_power;
    int xcoord;
    int ycoord;
    EnemySpaceShip *nextEnemy;
};

EnemySpaceShip* getNewEnemy(EnemySpaceShip* p_enemies) // Creates a new EnemySpaceShip in linked list p_enemies
{
    EnemySpaceShip *p_ship = new EnemySpaceShip;
    p_ship->xcoord = 0;
    p_ship->ycoord = 0;
    p_ship->weapon_power = 10;
    p_ship->nextEnemy = p_enemies;
    p_enemies = p_ship;
    return p_ship;
}

EnemySpaceShip* findPreRemove(EnemySpaceShip* p_enemies, int x_attack, int y_attack) // finds the element that is before the ship to be removed or returns NULL
{
    EnemySpaceShip *p_current = p_enemies;
    EnemySpaceShip *initialShip = p_enemies;
    int i= 0;
    while (p_current != NULL)
    {
        i++;
        if (p_current->xcoord == x_attack && p_current->ycoord == y_attack)
        {
            if (i == 1)
            {
                delete initialShip;
                delete p_current;
                return NULL;
            }
            else
            {
                for (int j = 1; j < i - 1; j++)
                {
                    initialShip = initialShip->nextEnemy;
                }
                delete p_current;
                return initialShip;
            }
        }
        p_current = p_current->nextEnemy;
    }
    return NULL;
}

EnemySpaceShip* findRemove(EnemySpaceShip* p_enemies, int x_attack, int y_attack)
{
    EnemySpaceShip *p_current = p_enemies;
    while (p_current != NULL)
    {
        if (p_current->xcoord == x_attack && p_current->ycoord == y_attack)
        {
            return p_current;
        }
        p_current = p_current->nextEnemy;
    }
}

EnemySpaceShip* removeEnemyShip(EnemySpaceShip *p_ship) // deletes the ship parameter and returns the ship after it in the list
{
    EnemySpaceShip *enemyAfterRemove = new EnemySpaceShip;
    enemyAfterRemove = p_ship->nextEnemy;
    delete p_ship;
    return enemyAfterRemove;
}

int main()
{
    EnemySpaceShip *p_enemies = NULL;
    EnemySpaceShip *Ship1 = getNewEnemy(p_enemies);
    EnemySpaceShip *Ship2 = getNewEnemy(p_enemies);
    EnemySpaceShip *Ship3 = getNewEnemy(p_enemies);

    Ship3->xcoord = 5; //arbitrary numbers to test the code
    Ship3->ycoord = 5;

    EnemySpaceShip *ShipBeforeRemove = findPreRemove(p_enemies, 5, 5);
    EnemySpaceShip *ShipToRemove = findRemove(p_enemies, 5, 5);
    ShipBeforeRemove->nextEnemy = removeEnemyShip(ShipToRemove);
} 
```

我正在使用任意值来测试程序，我不需要将其完全实现为显然正在使用的游戏的功能。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:27:05.100

我希望以下是你想要的..从单链表中删除一个元素..

```
EnemySpaceShip* removeFromList(EnemySpaceShip* p_enemies, int x_attack, int y_attack)
{
    if(p_enemies == NULL)
        return NULL;

    EnemySpaceShip *p1 = p_enemies;
    EnemySpaceShip *p2 = p1->next;

    if(p2 == NULL)
    {
        // Trivial case..

        if(p1->xcoord == x_attack && p1->ycoord == y_attack)
        {
            delete p_enemies;
            p_enemies = NULL;
        }

        return NULL;
    }

    while(p2 != NULL)
    {
         if(p2->xcoord == x_attack && p2->ycoord == y_attack)
         {
             // Element found, remove it and assign its previous pointer
             // as the next pointer of the deleted one..
             p1->next = p2->next;
             delete p2;
             return p1;
         }
         else
         {
             p1 = p2;
             p2 = p2->next;
         }
    }

    return NULL; 
```

}

# hadoop - 如何通过 Cloudera Manager 启用 webhdfs？

> ID：10557195
> 
> 赞同：2
> 
> 时间：2012-05-11T19:05:24.557
> 
> 标签：hadoop, hdfs, cloudera

Cloudera 将 webhdfs 滚动到最新的 cd3u4 中，但我无法找到可以启用此功能的位置。我意识到有一个条目 dfs.webhdfs.enabled 您可以在 hdfs-site.xml 中手动编辑。在 cdh3 发行版中，是否有一个安全的地方可以放置 dfs.webhdfs.enabled 配置？有人可以帮我指出正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T07:55:38.673

如果要使用 WebHDFS，必须先启用它。

如何？在 conf/hdfs-site.xml 中设置以下属性：

```
<property>
  <name>dfs.webhdfs.enabled</name>
  <value>true</value>
</property> 
```

注意：如果要在安全集群中使用 WebHDFS，则必须设置其他属性来配置安全 WebHDFS。如果您使用的是 SPNEGO 安全性，请参阅在 CDH3 中配置 Hadoop 安全性 (SPNEGO) 中的配置安全 WebHDFS。如果您使用 KSSL 安全性，请参阅在 CDH3 (KSSL) 中配置 Hadoop 安全性中的配置安全 WebHDFS。

我在这里找到它：[https ://ccp.cloudera.com/display/CDHDOC/CDH3+Deployment+on+a+Cluster#CDH3DeploymentonaCluster-EnablingWebHDFS](https://ccp.cloudera.com/display/CDHDOC/CDH3+Deployment+on+a+Cluster#CDH3DeploymentonaCluster-EnablingWebHDFS)

# c# - 在 C# 中使用 Selenium Webdriver，如何选择要写入的文本框，然后在其中写入？

> ID：10557196
> 
> 赞同：7
> 
> 时间：2012-05-11T19:05:24.457
> 
> 标签：c#, visual-studio, selenium, webdriver

有一个脚本可以访问该网站。现在我想登录并进入下一个屏幕。找不到有关如何转到“用户名：”文本框和“密码：”文本框的代码。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-11T22:23:34.280

您将需要给我们一些页面的 HTML，但给定一个密码文本框，如下所示：

```
<input type="password" id="passwordTextBox"> 
```

我会像这样使用 Selenium 的 WebDriver 找到它：

```
IWebDriver firefoxDriver = new FirefoxDriver();
IWebElement passwordTextBox = firefoxDriver.FindElement(By.Id("passwordTextBox")); 
```

然后我会像这样“写入”它：

```
passwordTextBox.Clear();
passwordTextBox.SendKeys("password"); 
```

我会看一下 Selenium Web Driver 文档，并在您通读所有内容后提出任何问题：

[http://seleniumhq.org/docs/03_webdriver.html](http://seleniumhq.org/docs/03_webdriver.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-14T14:03:15.537

```
//Textbox  id is "username"
IWebDriver driver = new ChromeDriver();    
string url = "https://www.google.com";
IWebElement textBox;
driver.Navigate().GoToUrl(url);
textBox = driver.FindElement(By.Name("username"));
textBox.SendKeys("Test text"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-19T18:11:52.573

```
driver.FindElement(selectBy(controlToFind, search)).Click(); 
```

只需要使用此代码。

*   `driver`= 你的 selenium 网络驱动程序
*   `SelectBy(controlToFind)`= 这是您的控件、xpath 代码、CSS 选择器或类。
*   `.Click()`= 表示要执行的动作，可以使用`.click()`, `.SendKeys()`, `wait()`...

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2015-04-30T10:00:18.087

在用户名和密码文本框中键入值。试试下面

```
driver.FindElement(By.Id("\\UserName Text Box ID\\").SendKeys("UserName Text");

driver.FindElement(By.Id("\\Password Text box ID\\").SendKeys("Password Text"); 
```

# wpf - 在 WPF 的表单编辑器中锁定画布上的控件

> ID：10557201
> 
> 赞同：0
> 
> 时间：2012-05-11T19:05:50.697
> 
> 标签：wpf, locking, controls

我正在 WPF 中构建一个表单编辑器。我们需要的其中一项功能是让用户“锁定”画布上的一个或多个控件。锁定是指用户将无法移动、调整大小或修改控件的其他属性。

我已经尝试过，`ContentControl`但没有得到我想要的结果。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-11T19:37:46.517

我认为你应该使用该`IsEnabled`物业。具有交互的基本控件具有此功能，您也可以在自定义控件上公开它并向下传递属性。

如果设置了某些内容，`IsEnabled = false`它将显示为灰色，并且不受用户输入的影响。

# c++ - 是否有任何本机 gtkmm 类可以从小部件的信号处理函数中排队命令/数据？

> ID：10557205
> 
> 赞同：0
> 
> 时间：2012-05-11T19:06:12.983
> 
> 标签：c++, gtk, cairo, gtkmm, pango

我已经构建了一个带有各种小部件的 Gtkmm GUI。在调用信号时，每个小部件都旨在使用通过网络发送的用户输入数据构造一个“字符串”。因此我认为，命令必须通过单个排队机制（队列、环形缓冲区等）以避免争用。gtkmm 中是否有执行此功能的本机队列或环形缓冲区类？我在这些方面想得更多

`http://www.gtk.org/api/2.6/glib/glib-Asynchronous-Queues.html`

PS：

我在这里找不到等效的包装器 `http://developer.gnome.org/gtkmm-tutorial/2.22/gtkmm-tutorial.html`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:52:31.977

Glib 被单独包装为 glibmm。如果功能被包装，你应该在那里找到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:37:10.197

[http://developer.gnome.org/glibmm/unstable/thread_2thread_8cc-example.html](http://developer.gnome.org/glibmm/unstable/thread_2thread_8cc-example.html)

# sql - SQL Server：将子选择查询转换为加入

> ID：10557206
> 
> 赞同：2
> 
> 时间：2012-05-11T19:06:13.750
> 
> 标签：sql, sql-server, sql-server-2005

我有 2 张两张桌子`questionpool`，`question`其中`question`一张是多张桌子`question pool`。我使用子选择查询创建了一个查询，该查询返回正确的随机结果，但我需要从表中返回多个列`question`。

查询的目的是从“问题”表中为“问题池”表中的每个“测验ID”返回一个随机测试。

```
SELECT QuestionPool.QuestionPoolID,
(
SELECT TOP (1) Question.QuestionPoolID
FROM Question
WHERE Question.GroupID = QuestionPool.QuestionPoolID
ORDER BY NEWID()
)
FROM QuestionPool
WHERE QuestionPool.QuizID = '5' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T01:21:51.610

OUTER APPLY 适用于此：

```
Select *
FROM QuestionPool
OUTER APPLY
(
    SELECT TOP 1 * 
    FROM Question
    WHERE Question.GroupID = QuestionPool.QuestionPoolID
    ORDER BY NEWID()
) x
WHERE QuestionPool.QuizID = '5' 
```

OUTER APPLY 的另一个示例使用[http://www.ienablemuch.com/2012/04/outer-apply-walkthrough.html](http://www.ienablemuch.com/2012/04/outer-apply-walkthrough.html)

* * *

现场测试：[http ://www.sqlfiddle.com/#!3/d8afc/1](http://www.sqlfiddle.com/#!3/d8afc/1)

```
create table m(i int, o varchar(10));
insert into m values
(1,'alpha'),(2,'beta'),(3,'delta');

create table x(i int, j varchar, k varchar(10));

insert into x values
(1,'a','hello'),
(1,'b','howdy'),
(2,'x','great'),
(2,'y','super'),
(3,'i','uber'),
(3,'j','neat'),
(3,'a','nice');

select m.*, '' as sep, r.*
from m
outer apply
(
  select top 1 *
  from x
  where i = m.i
  order by newid()
) r 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:13:08.070

不熟悉 SQL 服务器，但我希望这样做：

```
Select QuestionPool.QuestionPoolID, v.QuestionPoolID, v.xxx -- etc
FROM   QuestionPool
JOIN
       (
        SELECT   TOP (1) *
        FROM     Question
        WHERE    Question.GroupID = QuestionPool.QuestionPoolID
        ORDER BY NEWID()
       ) AS v ON v.QuestionPoolID = QuestionPool.QuestionPoolID
WHERE  QuestionPool.QuizID = '5' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T19:22:59.450

您的查询似乎为每个 QuestionPool.QuestionPoolId 带回了一个任意 Question.QuestionPoolId 受 QuizId 过滤器的影响。

我认为以下查询可以做到这一点：

```
select qp.QuestionPoolId, max(q.QuestionPoolId) as any_QuestionPoolId
from Question q join
     qp.QuestionPoolId qp
     on q.GroupId = qp.QuestionPoolId
 WHERE QuestionPool.QuizID = '5' 
group by qp.QuestionPoolId 
```

这会返回一个特定的问题。

以下查询将允许您获取更多字段：

```
select qp.QuestionPoolId, q.*
from (select q.*, row_number() over (partition by GroupId order by (select NULL)) as randrownum
      from Question q
     ) join
     (select qp.QuestionPoolId, max(QuetionPool qp
     on q.GroupId = qp.QuestionPoolId
 WHERE QuestionPool.QuizID = '5' and
       randrownum = 1 
```

这使用 row_number() 来任意枚举行。“Select NULL”提供随机排序（或者，您可以使用“order by GroupId”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T19:39:47.950

公用表表达式 (CTE) 对于这类事情非常方便......

[http://msdn.microsoft.com/en-us/library/ms175972(v=sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms175972(v=sql.90).aspx)

# flash - FDT：从 Haxe 项目调试时，Flash Player 调试器未连接

> ID：10557211
> 
> 赞同：3
> 
> 时间：2012-05-11T19:06:32.177
> 
> 标签：flash, haxe, fdt

我设置了一个 Haxe 项目，并且设置了一个调试配置来启动外部 Swf 查看器。

所有这些都很好，但调试器没有连接回 FDT。我每隔几秒钟就会在控制台中收到一条消息，说它正在尝试连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:16:16.700

您很有可能需要将“添加 Flash 调试信息”信息的选项添加到 .HXML 文件中的 Flash 目标。看看这些截图：

![在此处输入图像描述](../Images/1cbd4df334a19d147aa53b6575b3b203.png)

![在此处输入图像描述](../Images/b97f7b01bee3a8cc956af67e320864e4.png)

![在此处输入图像描述](../Images/f75246c8ca0eed8ef7b2ee33ef86cf0e.png)

# javascript - JavaScript 函数和新函数的区别

> ID：10557213
> 
> 赞同：28
> 
> 时间：2012-05-11T19:06:38.567
> 
> 标签：javascript, new-operator

下面的 JavaScript 代码让我很困惑。谁能帮我理解。为什么 PersonY 没有原型属性。

```
PersonX = function(){};
PersonY = new function(){};
alert(PersonX.prototype);
alert(PersonY.prototype);    
​ 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-11T19:09:01.287

```
PersonX = function(){}; 
```

将对匿名函数的引用放入`PersonX`. `PersonX`指向一个函数。

```
PersonY = new function(){}; 
```

将对匿名构造函数的新构造实例的引用放入`PersonY`. `PersonY`指向一个对象。

* * *

对于原型，`PersonY`有一个。但是，由于在实例化[之前](http://jsfiddle.net/tcrKW/1/)和[之后](http://jsfiddle.net/tcrKW/)都没有附加到构造函数的属性和方法，因此它有一个*空白原型**。

您实际上可以`PersonY`通过执行检查原型`console.log(PersonY)`。你会看到它有一个`__proto__`“空白”的原型属性（我在 Chrome 中看到它）。但是它有两个隐藏的属性，`constructor`一个是构造对象的构造函数，另一个`__proto__`是引导你到下一个“链环”的`Object`对象。

[*不是真正的空白，因为原型是一个链条。这个原型级别可能是空白的，但下一个更高的原型可能有，或者在这种情况下，确实有属性和方法。]

```
Object prototype -> Constructor prototype -> Your Instance will have:
- toString()        - blank                  - toString()
- hasOwnProperty()                           - hasOwnProperty()
- and more...                                - and more...
                                             - ...but nothing from Constructor 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:10:44.627

那是因为它实际上是作为函数副本在内存中实例化的对象；原型实际上仅在创建实例的上下文中才有意义，因此一旦创建它，​​就没有逻辑结构来解释其含义。

# java - How do I force autowiring in a JUnit test?

> ID：10557215
> 
> 赞同：1
> 
> 时间：2012-05-11T19:06:50.477
> 
> 标签：java, spring, junit, autowired

I'm using Spring 3.1.0.RELEASE and JUnit 4.8.1\. I'm having trouble figuring out why a class' member field isn't getting autowired in a JUnit test. My test looks like ...

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({ "file:src/test/resources/testApplicationContext.xml" })
@TransactionConfiguration(defaultRollback=true)
@Transactional
public abstract class NowYouKnowEventsParserTest {

    private EventFeed eventFeed;

    @Before
    public void setUp() { 
        eventFeed = getEventFeed(16);
    }   // setUp

    @Test
    public void testParser() { 
        Assert.assertNotSame(0, eventFeed.getEvents().size());
    }   // testParser

    ...
    @Autowired
    private EventFeedsDao eventFeedsDao;

    protected EventFeed getEventFeed(final Integer id) { 
        return eventFeedsDao.findById(id);
    }   // getEventFeed
} 
```

The class "EventFeed" invokes an instance of the below class ...

```
package com.myco.myproject.parsers;
...
public abstract class AbstractEventParser {

    @Autowired
    protected NetUtilsService netUtilsService;
    ...
} 
```

but when it comes time, the AbstractEventParser's "netUtilsService" member field is null. This is strange because in my "testApplicationContext.xml" file, I have this, which I thought would take care of the autowiring ...

```
<mvc:annotation-driven />
<context:component-scan base-package="com.myco.myproject" /> 
```

How do I force autowiring in my JUnit test? I would prefer not to add and invoke a setter method for the member field but if that is the only way, so be it.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:14:51.877

是`EventFeed`由 Spring 管理的类，我的意思是 EventFeed 类用`@Service`or注释`@Component`。你也需要在你的测试中做对`@Autowired`。`EventFeed`我在你的身上没有看到`AbstractParsetTest`

# android - Setting Application Specific Max Heap Size for the Android Dalvik VM

> ID：10557219
> 
> 赞同：0
> 
> 时间：2012-05-11T19:07:02.740
> 
> 标签：android, heap-memory, dalvik

Is it possible to set an application-specific max heap size (the dalvik.vm.heapsize property) instead of using the same maximum heapsize for all VM's running on an Android device? I know I can set a new dalvik heapsize by modifying the device's AndroidRuntime.cpp as root, but based on what I have read, because Android only initializes the VM once and then forks subsequent VM instances all VM's running on the device have the same dalvik.vm.heapsize property. Am I understanding this correctly, and is there any way around it?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T21:12:55.453

更改应用程序堆大小的唯一内置方法是`android:largeHeap="true"`在 Manifest.xml 中进行设置。这通常会将堆大小从 48 增加到 128。

请记住，这种方法仅适用于 3.0+ 设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:04:10.920

使用这个应用程序你可以增加所需应用程序的堆内存

[http://www.freeware4android.net/lg-c660-optimus-pro-device-2140/hacks-tweaks-tag/vm-heap-tool-download-27936.html](http://www.freeware4android.net/lg-c660-optimus-pro-device-2140/hacks-tweaks-tag/vm-heap-tool-download-27936.html)

请记住，要使用此应用程序，您需要**根**您的设备，使用**SuperOneClick**应用程序来根您的设备.. 单击下面的链接以获取参考

[http://www.makeuseof.com/tag/root-android-phone-superoneclick-2/](http://www.makeuseof.com/tag/root-android-phone-superoneclick-2/)

# sql - Conditionally append a character in select statement

> ID：10557226
> 
> 赞同：0
> 
> 时间：2012-05-11T19:07:24.247
> 
> 标签：sql, stored-procedures, db2

Functionality I'm trying to add to my DB2 stored procedure:

```
 Select a MIN() date from a joined table column.
    IF there was more than one row in this joined table, append a " * " to the date. 
```

Thanks, any help or guidance is much appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-25T03:14:44.063

尚不清楚需要哪种 DB2 风格，也不清楚任何建议是否有效。这适用于 DB2 for i：

```
SELECT
 T1.joinCol1,
 max( T2.somedateColumn ),
 count( t2.somedateColumn ),
 char(max( T2.somedateColumn )) concat case when count( T2.somedateColumn )>1 then '*' else '' end 
 FROM joinFile1 t1 join joinFile2 t2
           on joinCol1 = joinCol2
 GROUP BY T1.joinCol1
 ORDER BY T1.joinCol1 
```

SQL 相当通用，因此它应该转换为许多环境和版本。

根据需要替换表名和列名。这里的 COUNT() 实际上是从 JOIN 计算行数，而不是具体日期出现的次数。如果需要重复日期的计数，则还需要对此示例进行一些更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T06:32:37.760

Hope this helps

Say I have result coming as

```
 1   Jeff    1
2   Jeff    333
3   Jeff    77
4   Jeff    1
5   Jeff    14
6   Bob     22
7   Bob     4
8   Bob     5
9   Bob     6 
```

Here the value 1 is repeated twice(in 3 column)

So, this query gets the count as 2 along with the * concatenated along with it

```
 SELECT A.USER_VAL,
        DECODE(A.CNT, '1', A.CNT, '0', A.CNT, CONCAT(A.CNT, '*')) AS CNT
   FROM (SELECT DISTINCT BT.USER_VAL, CAST(COUNT(*) AS VARCHAR2(2)) AS CNT
           FROM SO_BUFFER_TABLE_8 BT
          GROUP BY BT.USER_VAL) A 
```

# sql - 多个 id 的更新语句

> ID：10557227
> 
> 赞同：4
> 
> 时间：2012-05-11T19:07:24.190
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2005

我有 3 个表，我需要通过计算其他两个表的数据来更新第三个表的列。

```
update table3 set column3=
(
select t2.column3+t1.column3
from table2 t2 with (nolock) join table1 t1
on table2.id=t1.id
where table2.id= 100
)
where id= 100; 
```

此查询工作正常，它会更新第三个表列，但是如果我提供这样的 IN 运算符：

```
 update table3 set column3=
    (
    select t2.column3+t1.column3
    from table2 t2 with (nolock) join table1 t1
    on table2.id=t1.id
    where table2.id IN (100,101)
    )
    where id IN (100,101); 
```

这失败了，我收到了这条消息

子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的。该语句已终止。

& 我知道这是因为子查询返回超过 1 行，我该如何处理这种情况？任何提示/想法都会有所帮助。

我如何更新多个ID？IE。ID 100 返回的选择查询值应针对第三个表中的 ID 100 进行更新，对于 ID 101 也是如此。

另外，我需要做这样的总和 sum(t2.column3)- (t1.column3 + t1.column2)

```
 update table3 set column3=
        (
        select  sum(t2.column3)- (t1.column3 + t1.column2)
        from table2 t2 with (nolock) join table1 t1
        on table2.id=t1.id
        where table2.id IN (100,101)
        )
        where id IN (100,101); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T19:12:08.027

这是因为您试图设置`column3`为返回的结果，而 SQL 期望它只是一个值（标量）。当您向 SQL 引擎传递多个返回值时，SQL 引擎会感到困惑（它应该使用哪个返回值？...它不假定迭代结果）。所以，如果你想更新整个结果集，那么你需要从你的查询中创建一个子表并加入它。您的查询应该看起来更像这样

```
UPDATE Table3
SET Column3 = subtable.value
FROM Table3 
    JOIN (
        select t2.column3+t1.column3 as value, t1.id
        from table2 t2 with (nolock) join table1 t1
        on table2.id=t1.id
        where table2.id IN (100,101)
    ) AS subtable
    ON subtable.id = Table3.id
WHERE table3.id IN (100, 101) 
```

在 table3.id 与其他 id 匹配的假设下，您也确实不需要内部`where table2.id IN ...`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:13:05.170

您还应该加入`table3`您的`UPDATE`. 试试这个：

```
UPDATE t3
SET column3 = t2.column3+t1.column3
FROM table3 t3
INNER JOIN table2 t2 WITH(NOLOCK) 
ON t3.id = t2.id
INNER JOIN table1 t1
ON t3.id=t1.id
WHERE t3.id IN (100,101) 
```

# jquery - jQuery - Dynamically Turn List Items into jQuery Toggles

> ID：10557230
> 
> 赞同：-2
> 
> 时间：2012-05-11T19:07:36.823
> 
> 标签：jquery, if-statement

I would like to automatically turn list items into jQuery toggles for elements in a page.

For example, here is some sample page code:

```
<div id="page">
    <div id="menu">
        <ul>
            <li class="books">Books</li>
            <li class="cars">Cars</li>
            <li class="sausages">Sausages</li>
        </ul>
    </div>

    <div id="elements">
        <div class="books">This layer displays a range of books</div>
        <div class="cars">This layer displays a range of cars</div>
        <div class="sausages">This layer displays a range of sausages</div>
    </div>
</div> 
```

As you can see, each menu list item and each element DIV, share the same class name.

What I would like to accomplish, with jQuery, is turning each menu list item automatically into a toggle, which can then toggles its corrosponding DIV in the elements section.

So it basically needs to read the menu items, then see if that menu item has a corrosponding element layer, and if so, turn it into a toggle which can toggle the layer.

It needs to be dynamic, because menu items and element layers might be added and removed regularly and it could eventually incorporate dozens of layers.

If this is possible, please demonstrate with a jsFiddle.

Thanks!

EDIT: I know how to use jQuery to hide and show specific elements on a page, where you hard code the element name into the code, however, I have no idea how to make it dynamic. I tried googling for at least 2 hours prior to posting here.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:18:09.727

*上面的评论是正确的，你应该在你的帖子中付出更多的努力。除了 SO 不是“[为我做作业](https://meta.stackexchange.com/questions/128548/what-stack-overflow-is-not/128572#128572)”网站这一事实之外，您的描述对我来说很难理解。一些代码——甚至是伪代码——会有所帮助。*

然而，我确实理解，有时我们甚至不知道我们不知道什么，这使得我们的问题很难沟通。因此，虽然我很难理解您想要什么，但如果我正确阅读它，这样的事情应该可以工作：

**HMTL**

```
<div id="page">
    <div id="menu">
        <ul>
            <li class="books">Books</li>
            <li class="cars">Cars</li>
            <li class="sausages">Sausages</li>
        </ul>
    </div>
    <hr />
    <div id="elements">
        <div class="books">This layer displays a range of books</div>
        <div class="cars">This layer displays a range of cars</div>
        <div class="sausages">This layer displays a range of sausages</div>
    </div>
</div>​ 
```

**Javascript**

```
$('#menu ul li').on('click', function () {
    var $matchingDIV = $('#elements div.' + $(this).attr('class'));

    $matchingDIV.toggle(!$matchingDIV.is(':visible'));
});​ 
```

这是[小提琴](http://jsfiddle.net/JAAulde/dkxqG/)

如果你在你的 LI 元素中添加了多个类名，它就会失败。另外，我不知道您是否希望元素开始显示，或者是否一次只显示一个，等等。希望您可以接受并运行它，但如果您对此有疑问，请提出。

# javascript - window opener manipulation; Add a text to a element in parent window

> ID：10557234
> 
> 赞同：1
> 
> 时间：2012-05-11T19:07:49.947
> 
> 标签：javascript, jquery, html

I have a pop up window which user can select files and then it will alert the selected image's URL. But I need to do more than that.

I am looking for a way to insert the URL to the parent window's input element.

```
window.opener.document.write(url); 
```

This will overwrite the parent window's content. But I need to add the URL to special input element in parent window.

I was just thinking what if this literally works !

```
window.opener.document.getElementById("image").write(url); 
```

Thanks in advance.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T19:09:30.993

```
window.opener.document.getElementById("image").value = url; 
```

# android - Android：如何在显示对话框时使片段变暗？

> ID：10557242
> 
> 赞同：2
> 
> 时间：2012-05-11T19:09:03.007
> 
> 标签：android, android-fragments

我在一个活动中有两个片段，一个片段占 70%，另一个片段占 30%。我想显示一个弹出窗口/对话框以在 70% 片段中居中对齐，并且在显示弹出窗口时片段应该变暗。关于如何进行的任何指示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:13:25.760

在 70% 片段的顶部（在其布局描述内）放置一个半透明的、隐藏的、可绘制的。当您需要调光时，只需将该可绘制对象的状态更改为可见，当对话框消失时，将其设置回隐藏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-26T17:02:13.580

`setTargetFragment()`在Host Fragment中的DialogFragment上设置

`getTargetFragment();`在 DialogFragment 中调用Host Fragment

并通过以下方式使主机的视图变暗

```
private void dimTheHostView() {
  view = hostFragment.getView();
  if (view != null) {
    view.setAlpha(0.4f);
  }
} 
```

# visual-studio-2010 - incorrect argc in win32 (in addition, the arguments are ignored)

> ID：10557249
> 
> 赞同：-1
> 
> 时间：2012-05-11T19:09:40.163
> 
> 标签：visual-studio-2010, winapi, command-line-arguments, commandargument

I was coding in win32, and my program actually works in debug mode in vs, however not in release mode and not outside vs.

```
int _tmain(int argc, _TCHAR* argv[])
{
    //assert that there are 3 parameters.
    assert(argc==4);
    LPCTSTR inputPath = argv[1];
    LPCTSTR sharedName = argv[2];
    LPCTSTR logPath = argv[3]; 
```

sometimes argc is not correct (over 300000, while it should be 4), and sometimes the

```
LPCTSTR sharedName = argv[2]; 
```

line is just ignored! when debugging this program in release mode, it jumps over it, and when hoovering above the variable name nothing happens. When right-clicking a variable and choosing Add Watch, I get the error logPath CXX0017: Error: symbol "logPath" not found
of course, I have set the command arguments in vs to be "a b c" (without the quotes)

What could it be? running the simplified program: // test.cpp : Defines the entry point for the console application. //

```
#include "stdafx.h"
#include "stdafx.h"
#include <windows.h>
#include <assert.h>
#include "conio.h"

int _tmain(int argc, _TCHAR* argv[])
{
    assert(argc==4);
    LPCTSTR inputPath = argv[1];
    LPCTSTR sharedName = argv[2];
    LPCTSTR logPath = argv[3];
    _getch();
} 
```

yields the same result. the debugger just jumps to the getch line, and if I try to add watch, I get logPath CXX0017: Error: symbol "logPath" not found
inputPath CXX0017: Error: symbol "inputPath" not found
sharedName CXX0017: Error: symbol "sharedName" not found

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:20:53.887

> 在发布模式下调试这个程序时，它会跳过它，当悬停在变量名上方时，什么也没有发生。右键单击变量并选择 Add Watch 时，出现错误 logPath CXX0017: Error: symbol "logPath" not found

这些症状是有道理的。“发布”模式告诉编译器打开优化，并且由于您从不*使用*您声明的变量，编译器有助于将它们完全优化出来。如果您永远不会再使用它，那么创建和分配某些东西的动作是没有意义的。

这就是为什么它告诉您找不到该符号的原因，因为它的定义已被优化。

另一方面，“调试”模式会禁用优化。因此，它经历了创建这些变量并为它们分配值的动作，即使您可能永远不会使用它们。这就是调试模式的全部意义——因此您可以在不受编译器优化行为干扰的情况下调试您的应用程序，即使它还没有完全编写好。

如果您迫切希望通过启用优化（即在“发布”模式下）使其像您期望的那样工作，那么您可以简单地*使用*您分配的变量的值。这将阻止编译器优化它们。例如，您可以简单地将字符串输出到调试器：

```
#include "stdafx.h"
#include <windows.h>
#include <assert.h>
#include <conio.h>

int _tmain(int argc, _TCHAR* argv[])
{
   assert(argc==4);
   LPCTSTR inputPath  = argv[1];
   LPCTSTR sharedName = argv[2];
   LPCTSTR logPath    = argv[3];

   OutputDebugString(inputPath);
   OutputDebugString(sharedName);
   OutputDebugString(logPath);

   _getch();
} 
```

# c++ - 如何翻转 QCheckBox 显示

> ID：10557252
> 
> 赞同：1
> 
> 时间：2012-05-11T19:09:50.550
> 
> 标签：c++, qt, qt4

QCheckBox 小部件左侧有复选框，右侧有说明（如下所示）：

![在此处输入图像描述](../Images/33563bf3bdb78f693035f7851aa7fe6a.png)

有谁知道左边有描述，右边有框的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:16:09.460

您可以使用`QWidget::setLayoutDirection(Qt::RightToLeft);`.

```
QCheckBox *checkBox = new QCheckBox("Hey!", parent);
checkBox->setLayoutDirection(Qt::RightToLeft); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T10:29:52.263

*QWidget::setLayoutDirection(Qt::RightToLeft);* 不会工作，QT 4.7 起。

使用 QApplication::setLayoutDirection(Qt::RightToLeft);

# c# - How to create XSD file programmatically in C#?

> ID：10557253
> 
> 赞同：7
> 
> 时间：2012-05-11T19:09:51.263
> 
> 标签：c#, xml, xsd

I have a xml file (that i created in c# using XmlDocument) and now i have to create xsd file the corresponds to it also programmatically in C# ... how can I do this ?? can I use the same classes for creating xml files ? or are there any other (xsd related) classes I should use ??

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T03:43:03.113

虽然 XML Schema 文件是一个 XML 文件，但它有些东西可能会使“手工”操作起来很麻烦；有人可能会说，为什么要使用 DOM API 而不是使用 XSD.exe 或 XSD2Code.exe 生成的 C# 类来编写 XML？或者稍微推一下……有点类似于有人说 C# 语句最终会变成 IL 程序集；为什么不写 IL 呢？

Schema Object Model API 提供了另一种选择；在 .NET 中，它是[System.Xml.Schema](http://msdn.microsoft.com/en-us/library/system.xml.schema.aspx)命名空间。

[查看MSDN](http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschemaelement.aspx)上的代码示例。它将为您提供另一种方法的想法。它提供了一个对程序员友好的 API 来生成 XSD，而不是处理实际的 XML。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T20:13:40.747

如果您只想从 XML 文件生成 XSD 文件，那么您可以使用 Microsoft 的[XSD.EXE](http://msdn.microsoft.com/en-us/library/x6c1kb0s.aspx)，它包含在 Visual Studio 中。

要使用它，请打开 Visual Studio 命令提示符。然后输入`xsd file.xml`以生成该 XML 文件的模式。

您还可以使用该工具为您的 XML 输入生成类，只需传入`/classes`参数即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T19:10:23.470

XSD is just another XML-type file. whatever you are using to create your XML file will also be useful to create the XSD file; you just need to know what tags/attributes you want to put in the file...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-16T14:45:54.173

解决方案：我最初发布了回复，但 Stack Overflow 我编辑了我的回复，所以这里是编辑。我建议的原始工具是另一种方式。然后我做了一些研究，有人推荐了一个名为 MyGenerations 或类似的工具。这需要安装、下载模板和大量工作，太复杂了。然后我做了一些更多的研究，并在 CodePage 上找到了一个相当不错的解决方案，但是该解决方案有效，因为我对其进行了测试，因此需要进行一些修改。该代码名为 XmlToXsd，其 URL 为：

[http://www.codeproject.com/Articles/133570/XmlToXsd-A-Better-Schema-Generator](http://www.codeproject.com/Articles/133570/XmlToXsd-A-Better-Schema-Generator)。

程序部分有两个错误。首先，它将 XSD 保存到可执行文件的根目录。不用担心，exe 只是调用位于一个 CS 文件中的方法。只需在项目中包含该 CS 文件并使用给定的行调用，只需将路径更改为与 XML 相同的文件夹即可。此外，作者使用垃圾 URL 的目标命名空间。DevExpress 对不存在的 URL 提出投诉。通过一些努力，我将目标 URL 替换为 null。在随附的 CS 文件中，我必须进行一些更改。其他人的理解比我能修改到他/她的内心程度。我只是通过告诉他们我做了什么来帮助别人，所以没有静态的回复。

变化1：在“target = XNamespace.Get(targetNamespace);”之前 为目标命名空间添加一个 if 语句，仅在不为 null 时才加载。

更改 2：我为返回添加了另一个 if 语句。空返回，原返回的副本修改如下：

2.1：核对目标命名空间属性项。2.2：在replace调用之后，再添加一个“.Replace("xmlns=\"null\"", null))”的replace调用。2.3：返回前，需要加大括号，设置target="null"。

生成的文件现在看起来完全有效并以编程方式创建。

是的，可以手动使用 XSD.exe，但我需要一种程序化的对话方式。

原帖：我有同样的问题，不一定是程序化的。XSD 实用程序确实可以完成这项工作。问题是 Microsoft 没有随 Visual Studio 2012 Professional 分发 xsd.exe。我搜索了我的硬盘驱动器并找到了带有 Microsoft SDK 的实用程序，我的磁盘上的路径为“C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\x64\xsd.exe”。

我必须转到 XML 文件所在的文件夹并从命令框（不是在 Visual Studio 中）执行 XSD 实用程序，最后得到 XSD 文件。

以编程方式执行此任务的一种方法是从代码中调用 XSD，但这意味着分发 XSD。

我找到了这个组件，但从未使用它来完成这项工作。查看：http: [//xsd2code.codeplex.com/](http://xsd2code.codeplex.com/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-05-22T10:44:38.823

尝试这个：

```
string xmlFilePath = @"myxmlfile.xml";
string xsdOutputPath = @"myxmlfile.xsd";

DataSet ds = new DataSet();

System.IO.FileStream fsReadXml = new System.IO.FileStream(xmlFilePath, System.IO.FileMode.Open);
ds.ReadXml(fsReadXml);

ds.WriteXmlSchema(xsdOutputPath); 
```

如果来自 xDocument：

```
DataSet ds = new DataSet();
ds.ReadXml(YourXDocument.CreateReader());
ds.WriteXmlSchema(xsdOutputPath); 
```

# cuda - About warp voting function

> ID：10557254
> 
> 赞同：10
> 
> 时间：2012-05-11T19:10:03.567
> 
> 标签：cuda, gpu, gpgpu

The CUDA programming guide introduced the concept of warp vote function, "_*all", "*_any" and "__ballot".

My question is: what applications will use these 3 functions?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-24T21:06:35.617

的原型`__ballot`如下

```
unsigned int __ballot(int predicate); 
```

如果`predicate`为非零，则`__ballot`返回一个设置了`N`第 th 位的值，其中`N`是线程索引。

`atomicOr`与和结合使用`__popc`，可用于累积每个经纱中具有真谓词的线程数。

的确，原型`atomicOr`是

```
int atomicOr(int* address, int val); 
```

并`atomicOr`读取 指向的值`address`，对 执行按位`OR`运算`val`，然后将值写回`address`并返回其旧值作为返回参数。

另一方面，`__popc`返回使用`32`-bit 参数设置的位数。

因此，指令

```
volatile __shared__ u32 warp_shared_ballot[MAX_WARPS_PER_BLOCK];

const u32 warp_sum = threadIdx.x >> 5;

atomicOr(&warp_shared_ballot[warp_num],__ballot(data[tid]>threshold));

atomicAdd(&block_shared_accumulate,__popc(warp_shared_ballot[warp_num])); 
```

可用于计算谓词为真的线程数。

有关更多详细信息，请参阅 Shane Cook、CUDA 编程、Morgan Kaufmann

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T20:07:11.180

`__ballot`在[CUDA 直方图](https://github.com/trantalaiho/Cuda-Histogram/blob/master/cuda_histogram.h)和 CUDA NPP 库中用于快速生成位掩码，并将其与`__popc`内在函数相结合以非常有效地实现布尔缩减。

`__all`并`__any`在引入 之前用于归约`__ballot`，尽管我想不出它们的任何其他用途。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-13T10:24:28.273

作为使用 __ballot API 的算法示例，我会提到 DM Hughes 等人的 In-Kernel Stream Compaction。它用于流压缩的前缀和部分，以计算（每个扭曲）通过谓词的元素数量。

[这里是纸。In-k 流压缩](http://www.vmg.cs.bangor.ac.uk/Publications/InK-Compact.pdf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-08T23:27:00.307

CUDA 提供了 NVIDIA 架构有效支持的几个 warp-wide 广播和缩减操作。例如， __ballot(predicate) 指令为 warp 的所有活动线程计算 predicate 并返回一个整数，当且仅当 predicate 对warp 的第 N 个线程和第 N*个**线程**计算*为非零时处于活动状态 [参考：GPU 架构的灵活软件分析]。

# sql - 在 SQL 中调用动态函数名

> ID：10557258
> 
> 赞同：4
> 
> 时间：2012-05-11T19:10:21.773
> 
> 标签：sql, sql-server, tsql, sql-function

是否可以在 SQL 中调用具有动态名称的函数？

例如：

```
SELECT functionid, (SELECT results FROM dbo.Function_*functionid*) AS results
FROM List_of_Functions 
```

这将为表 List_of_Functions 中的每一行调用不同的函数。

还是我对这一切都错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:48:11.597

您将需要构建（键入它，或者根据您的表动态构建它）一个 SQL 语句，例如：

```
SELECT
    functionid
        ,CASE  functionid
            WHEN 1 THEN dbo.Function_1()
            WHEN 2 THEN dbo.Function_2()
            WHEN 3 THEN dbo.Function_3()
         END AS results
    FROM List_of_Functions 
```

与其构建所有这些函数，不如构建一个函数并传入一个函数可以用来区分处理的值不是更好吗？像：

```
SELECT
    functionid
        ,dbo.Function(functionid) AS results
    FROM List_of_Functions_Parameters 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:13:31.270

> 是否可以在 SQL 中调用具有动态名称的函数？

不在纯 SQL 中。

您可以使用动态 SQL 来实现这一点，但并非没有风险，尤其是[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。

我建议阅读Erland Sommarskog 的[The Curse and Blessings of Dynamic SQL以全面了解该主题。](http://www.sommarskog.se/dynamic_sql.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-09T11:25:26.957

只是想扩展和反对[Oded 的回答](https://stackoverflow.com/a/10557302/5070879)：

> > **是否可以在 SQL 中调用具有动态名称的函数？**
> 
> *不在纯 SQL 中。*
> 
> *您可以使用动态 SQL 来实现这一点，但并非没有风险，尤其是 SQL 注入。*

是的，可以不使用动态 SQL。

准备：

```
CREATE TABLE List_of_Functions(functionid INT);
INSERT INTO List_of_functions(functionid) VALUES(1),(2),(3),(4);

CREATE FUNCTION Function_1()
RETURNS VARCHAR(100)
AS
BEGIN
   RETURN 'Return from Function_1';
END;

CREATE FUNCTION Function_2()
RETURNS VARCHAR(100)
AS
BEGIN
   RETURN 'Return from Function_2';
END;

CREATE FUNCTION Function_3()
RETURNS VARCHAR(100)
AS
BEGIN
   RETURN 'Return from Function_3';
END; 
```

核心功能：

```
CREATE FUNCTION Function_dispatcher(@name SYSNAME)
RETURNS VARCHAR(100)
AS
BEGIN
  DECLARE @r VARCHAR(100);
  IF OBJECT_ID(@name, N'FN') IS NULL  --handling non-existing function
    RETURN NULL;
  EXEC @r = @name; 
  RETURN @r;
END; 
```

最后的电话：

```
SELECT *, dbo.Function_dispatcher(s.n) AS result
FROM List_of_Functions lf
OUTER APPLY(SELECT CONCAT('dbo.Function_', lf.functionid)) s(n); 
```

**[DBFiddle 演示](https://dbfiddle.uk/?rdbms=sqlserver_2017&fiddle=67e865227860df7a8abcee3c2c1f6e14)**

输出：

```
┌────────────┬────────────────┬────────────────────────┐
│ functionid │       n        │         result         │
├────────────┼────────────────┼────────────────────────┤
│          1 │ dbo.Function_1 │ Return from Function_1 │
│          2 │ dbo.Function_2 │ Return from Function_2 │
│          3 │ dbo.Function_3 │ Return from Function_3 │
│          4 │ dbo.Function_4 │ null                   │
└────────────┴────────────────┴────────────────────────┘ 
```

使用这种方法，您可以避免每次出现新功能时都更改主功能（CASE WHEN ...），就像在[KM.'s answer](https://stackoverflow.com/a/10557679/5070879)

# php - PHP 通讯邮件

> ID：10557260
> 
> 赞同：1
> 
> 时间：2012-05-11T19:10:29.223
> 
> 标签：php, pear, newsletter

我想为几百人制作一个 PHP 通讯发送器，比如每月一次。通过循环

发送所有电子邮件对我有用吗？`for()`即它会使用过多的资源吗？另外，我应该`sleep()`在我发送的每封电子邮件之间有一段时间吗？

注意：要发送电子邮件，我使用 PEAR`Mail::factory('smtp' ...);`功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:30:09.323

如果你要发送给几百人，应该不会有太多问题。

要记住的是，您是要发送单个电子邮件，还是要使用密件抄送向多个人发送同一封电子邮件 - 前者意味着您发送的电子邮件更少，但您无法在全部。

您绝对可以使用 for 循环遍历数据库；如果您要发送单独的电子邮件，那么我也建议偶尔使用 sleep()，这样您就不会太用力地打击邮件服务器。可能值得先与他们交谈，让他们知道 - 他们可能会很高兴知道您将这样做，特别是如果您的时事通讯订阅者增长到数千。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:21:46.820

您可以使用`for`循环发送 100 封电子邮件，但我不知道`sleep()`. `for`我在循环中使用 PHP 邮件程序一次发送了 200 封邮件。

# flash-builder - 为什么粘贴类后无法在 Flex Builder 项目中构建 swc？

> ID：10557264
> 
> 赞同：1
> 
> 时间：2012-05-11T19:10:50.983
> 
> 标签：flash-builder, swc

这可能是 Adob​​e 的错误报告，但我想我会在这里询问解决方法......

当我创建一个新的 Flex 库项目时，会在 /bin 文件夹中自动创建一个 .swc。当我添加一个新类时，.swc 会更新（我可以通过查看 .swc 的“最后修改”时间戳来判断）。当我编辑该类时， .swc 也会更新。这一切都符合预期，因为选中了 Project > Build Automatically。

但是，一旦我粘贴到其他类中，我就无法再更新 .swc。无论我执行什么编辑，日期戳都不会改变。取消选中并重新选中 Project>Build Automatically 什么都不做。更糟糕的是，Project>Clean 会删除 .swc 文件，我无法重新创建它！

有什么方法可以强制 Flex Builder 构建 .swc？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:59:46.437

我想到了。我粘贴到库项目中的类依赖于项目中不存在的其他类。这导致了构建错误。这些构建错误导致 .swc 编译以静默方式失败。

我没有注意到“问题”窗格中的构建错误，Flash Builder 也没有通知我编译失败，所以我在错误的地方四处寻找答案。

更多信息：http: [//words.transmote.com/wp/20120511/flex-library-project-build-errors/](http://words.transmote.com/wp/20120511/flex-library-project-build-errors/)

# jquery - jquery按钮更改图标与onclick

> ID：10557271
> 
> 赞同：3
> 
> 时间：2012-05-11T19:11:33.187
> 
> 标签：jquery, jquery-ui

我有一个看起来像这样的表格：

```
<form name="armdisarmform" action="/cameras" method="POST">
    <input type='hidden' name='armdisarmvalue' value="ENABLED"/>
    <button class="armdisarm" name="armdisarmbutton" onClick='changeicon(this, "Disarm")'>Disarm</button>
</form> 
```

这些值是从服务器填充的：

```
<form name="armdisarmform" action="<?php echo htmlspecialchars($_SERVER['REQUEST_URI']); ?>" method="POST">
    <input type='hidden' name='armdisarmvalue' value="<?php echo $userstatus; ?>"/>
    <button class="armdisarm" name="armdisarmbutton" onClick='changeicon(this, "<?php echo $armdisarm; ?>")'><?php echo $armdisarm; ?></button>
</form> 
```

本质上，我有一个按钮，可以根据服务器记录或当有人单击它时将其名称更改为“Arm”或“Disarm”。我想从 jquery 按钮添加解锁/锁定图标。所以这有效：

```
$(function() {
    $( ".armdisarm" ).button({
        icons: {
            primary: "ui-icon-locked"
        }
    });

}); 
```

但是，当我通过一个希望更改图标的函数时，它不起作用：

```
var changeicon = function(t, armdisarm)
{
    if (armdisarm == "Disarm")
    {
        $( ".armdisarm" ).button({
            icons: {
                primary: "ui-icon-unlocked"
            }
        });
    }
    else
    {
        $( ".armdisarm" ).button({
            icons: {
                primary: "ui-icon-locked"
            }
        });
    }

} 
```

这不可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T19:28:00.107

这样做怎么样：**[jsFiddle example](http://jsfiddle.net/j08691/VB9SQ/)**。

jQuery：

```
$(".armdisarm").button({
    icons: {
        primary: "ui-icon-locked"
    }
});
$('button').click(function() {
    $(this).data('state', ($(this).data('state') == 'disarm') ? 'arm' : 'disarm');
    $(".armdisarm").button({
        icons: {
            primary: ($(this).data('state') == "disarm") ? "ui-icon-unlocked" : "ui-icon-locked"
        }
    });
});​ 
```

通过使用 jQuery 的[.data()](http://api.jquery.com/data/)函数来维护状态（解除/武装），您可以轻松地切换图标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:52:13.983

问题似乎是由于通过内联处理程序调用您的函数：

```
<button class="armdisarm" name="armdisarmbutton" onClick='changeicon(this, "Disarm")'>Disarm</button> 
```

您可能已经`changeicon`在全局范围之外定义了，例如在一个`$document.ready()`块中。无论如何，使用内联处理程序是不好的做法。你最好在你的 javacsript 代码块中附加你的处理程序。如果您的对象是动态填充的，请使用`.on()`将您的处理程序委托给父对象（例如`body`）。

使用一些额外的 CSS，您还可以通过几个`toggleClass`调用来更改您的图标/文本：

HTML：

```
<button class="armdisarm" name="armdisarmbutton">
    <span class="disarm">Disarm</span>
    <span class="arm">Arm</span>
</button> 
```

CSS：

```
.arm {
   display: none;  
}
.disarmed .arm {
   display: inline;   
}
.disarmed .disarm {
   display: none;   
} 
```

JavaScript：

```
$("body").on('click', ".armdisarm", function() {
    $(this).toggleClass('disarmed')
        .find('.ui-button-icon-primary')
        .toggleClass("ui-icon-locked ui-icon-unlocked");
    return false;
}); 
```

演示：http: [//jsfiddle.net/jtbowden/GPKrP/](http://jsfiddle.net/jtbowden/GPKrP/)

如果你想“破解”更多，你可以用一个来做到这一点`toggleClass`：

CSS：

```
.arm {
   display: none;   
}
.disarmed .arm {
   display: inline;   
}
.disarmed .disarm {
   display: none;   
}
.disarmed .ui-button-icon-primary {
    background-position: -208px -96px;
} 
```

JavaScript：

```
$("body").on('click', ".armdisarm", function() {
    $(this).toggleClass('disarmed');
    return false;
}); 
```

在您的 PHP 中，`disarmed`如果按钮被解除，只需将类添加到您的按钮。

演示：http: [//jsfiddle.net/jtbowden/GPKrP/1/](http://jsfiddle.net/jtbowden/GPKrP/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-12T14:02:06.933

如果你真的在使用 jquery-ui 按钮类，你可以使用 option 方法：

```
$(".armdisarm").button({icon: "ui-icon-locked" })
.on("click", function() {
    var state = ($(this).data('state') == 'disarm') ? 'arm' : 'disarm';
    $(this).data('state', state);
    $(this).button("options", "icon", (state == "disarm") ? "ui-icon-unlocked" : "ui-icon-locked");
    });
});​ 
```

（此处使用 jQuery UI 1.12 更改`{icons: {primary: "ui-icon-locked" }}`为`{icon: "ui-icon-locked" }`）

# android - android中的痛苦线程

> ID：10557275
> 
> 赞同：3
> 
> 时间：2012-05-11T19:11:42.357
> 
> 标签：android

我的预期结果是在第一次启动时会显示一个进度对话框来等待后台线程加载内容。工作线程完成工作后，对话框消失。我进行了搜索并得到了这个解决方案[如何在 Android 中开始活动之前显示进度对话框？](https://stackoverflow.com/questions/5202158/how-to-display-progress-dialog-before-starting-an-activity-in-android)

这是我的完整代码：

```
 private ManagerApplication app;
    private ImageAdapter adapter;
    private GridView gridview;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        setupView();      
    }

    private void setupView() {
        gridview = (GridView) findViewById(R.id.gridview);
        app = (ManagerApplication) getApplication();
        ProgressDialog progress = new ProgressDialog(this);
        progress.setMessage("Loading...");
        new LoadImageTask(progress, this).execute();       
    }

    private class LoadImageTask extends AsyncTask<Void, Void, Void> {
        private ProgressDialog progress;
        private Context context;

        public LoadImageTask(ProgressDialog progress, Context context) {
            this.progress = progress;
            this.context = context;
        }

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            progress.show();
        }

        @Override
        protected Void doInBackground(Void... params) {
            adapter = new ImageAdapter(app.getShoes(), context);
            gridview.setAdapter(adapter); 
            return null;
        }

        @Override
        protected void onPostExecute(Void result) {
            super.onPostExecute(result);
            progress.dismiss();
        }

    } 
```

但是，我的应用程序崩溃的原因是“只有创建视图层次结构的原始线程才能触摸它的视图”。我想有一些东西阻塞了主 UI 线程，但它仍然很不清楚。那么有人可以指出我的问题吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:15:46.887

有趣的是，您应该阅读一篇题为[Painless Threading的文章。](http://developer.android.com/resources/articles/painless-threading.html)您不应该尝试在`doInBackground`. 在你的情况下，你可以打电话`app.getShoes()`但不要在那里进行适配器设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:18:01.973

> doinBackground 是非 UI 线程，因此永远不要在此方法中更新任何 UI(View)...

并使用`OnPostExecute or OnProgressUpdate for update UI`

```
 @Override
        protected Void doInBackground(Void... params) {
           //here just background task ,
     //its non UI Thread so dont set ant view here set it in OnPostExecute,...
            return null;
        } 
```

从 setupview 调用 asynctask

```
private void setupView() {
        gridview = (GridView) findViewById(R.id.gridview);
        app = (ManagerApplication) getApplication();

        new LoadImageTask(progress, this).execute();       
  } 
```

并在其中创建 ProgressDilog`OnPreExecute method`

```
ProgressDialog progress;

@Override
    protected void onPreExecute() {
        super.onPreExecute();

     progress = new ProgressDialog(this);
     progress.setMessage("Loading...");
     progress.show();
    } 
```

并且在`onPostExecute dismiss it`

# java - java.lang.NoSuchMethodException: java.lang.String.substring(java.lang.Long, java.lang.Long)

> ID：10557276
> 
> 赞同：4
> 
> 时间：2012-05-11T19:11:43.373
> 
> 标签：java, eclipse, spring, jsp, tomcat

我有一个jsp代码在其中一台机器上运行良好。但是当我复制到另一台机器时，我得到了这个没有发现异常的方法。我是春天的新手。有人可以解释我错过了什么。

以下是导致异常的代码行：

```
<c:set var="rawDate" value="${result.getDate()}"/>
<c:set var="rawTime" value="${result.getTime()}"/>
<td id="formattedDate" class="center"><c:out value="${rawDate.substring(4,6)}"/>/<c:out value="${rawDate.substring(6,8)}"/></td>
<td id="formattedTime" class="center"><c:out value="${result.getTime().substring(0,2)}"/>:<c:out value="${result.getTime().substring(2,4)}"/></td> 
```

这是堆栈跟踪

```
May 9, 2012 9:35:56 AM org.apache.catalina.core.ApplicationDispatcher invoke
SEVERE: Servlet.service() for servlet jsp threw exception
 (, )
   at java.lang.Class.getMethod(Class.java:1605)
   at javax.el.BeanELResolver.invoke(BeanELResolver.java:405)
   at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:147)
   at org.apache.el.parser.AstValue.getValue(AstValue.java:159)
   at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)
   at org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:989)
   at org.apache.jsp.WEB_002dINF.jsp.tables.WatchAllTable_jsp._jspx_meth_c_005fout_005f8(WatchAllTable_jsp.java:1132)
   at org.apache.jsp.WEB_002dINF.jsp.tables.WatchAllTable_jsp._jspx_meth_c_005fforEach_005f0(WatchAllTable_jsp.java:412)
   at org.apache.jsp.WEB_002dINF.jsp.tables.WatchAllTable_jsp._jspService(WatchAllTable_jsp.java:127)
   at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
   at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
   at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:417)
   at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:391)
   at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
   at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:306)
   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
   at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:672)
   at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:463)
   at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)
   at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)
   at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
   at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
   at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1180)
   at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:950)
   at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
   at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
   at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
   at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
   at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:306)
   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
   at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)
   at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)
   at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)
   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
   at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:550)
   at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
   at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:380)
   at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:243)
   at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:188)
   at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:166)
   at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:288)
   at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
   at java.lang.Thread.run(Thread.java:662)
org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet [spring] in context with path [/watch] threw     exception [An exception occurred processing JSP page /WEB-INF/jsp/tables/WatchAllTable.jsp at     line 77

74:                        <c:set var="rawDate" value="${result.getDate()}"/>
75:                        <c:set var="rawTime" value="${result.getTime()}"/>
76:                        
77:                        <td id="formattedDate" class="center"><c:out value="${rawDate.substring(4,6)}"/>/<c:out value="${rawDate.substring(6,8)}"/></td>
78:                        <td id="formattedTime" class="center"><c:out value="${result.getTime().substring(0,2)}"/>:<c:out value="${result.getTime().substring(2,4)}"/></td>
79:                        <td id="documentGroup" class="hidden"><c:out value="${curDocGroup}"/>    </td> 
```

这是看起来像解决此问题的链接，但我不明白他们在说什么。

[http://forum.springsource.org/showthread.php?108175-SpEL-does-not-recognize-functions&s=e077b42fd45ae3a3177a01c90339893c](http://forum.springsource.org/showthread.php?108175-SpEL-does-not-recognize-functions&s=e077b42fd45ae3a3177a01c90339893c)

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T19:16:28.570

[EL](https://stackoverflow.com/tags/el/info)（表达式语言，那些东西）将`${}`数字视为[真实方法](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#substring%28int,%20int%29)只需要数字。这就解释了这个例外。`long``int`

你需要[JSTL](https://stackoverflow.com/tags/jstl/info) [`fn:substring()`](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/fn/substring.fn.html)，

```
<%@taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
...
<c:set var="rawDate" value="${result.date}"/>
<c:set var="rawTime" value="${result.time}"/>
<c:out value="${fn:substring(rawDate,4,6)}"/>/<c:out value="${fn:substring(rawDate,6,8)}"/>
<c:out value="${fn:substring(rawtime,0,2)}"/>:<c:out value="${fn:substring(rawtime,2,4)}"/> 
```

或者更好的是，直接使用*正确的工具*，将其存储[`java.util.Date`](https://stackoverflow.com/tags/el/info)在模型中并使用[JSTL](https://stackoverflow.com/tags/jstl/info) [`<fmt:formatDate>`](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/fmt/formatDate.html)。

```
<%@taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
...
<fmt:formatDate value="${result.realJavaUtilDate}" pattern="MM/dd HH:mm" /> 
```

为它保存的数据使用正确的数据类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:17:57.910

您也可以执行以下操作。

```
 <c:set var="rawDate" value="${result.getDate()}"/>
    <c:set var="rawTime" value="${result.getTime()}"/>
    <td id="formattedDate" class="center"><c:out value="${rawDate.substring(Integer.parseInt(\"4\"), Integer.parseInt(\"6\")}"/>/<c:out value="${rawDate.substring(Integer.parseInt(\"6\"), Integer.parseInt(\"8\")}"/></td>
    <td id="formattedTime" class="center"><c:out value="${result.getTime().substring(Integer.parseInt(\"0\"), Integer.parseInt(\"2\")}"/>:<c:out value="${result.getTime().substring(Integer.parseInt(\"2\"), Integer.parseInt(\"4\")}"/></td 
```

# command - 如何将命令提示符同时写入文件和屏幕

> ID：10557279
> 
> 赞同：0
> 
> 时间：2012-05-11T19:12:01.460
> 
> 标签：command, dos, prompt

我正在尝试将 powershell 命令的输出写入文件。我已经完成了这个：

powershell psake "Dev08, Deploy-things" >> C:\Deployments\DeploymentLog.txt 2>&1

这是将所有屏幕输出转储到文件中......太棒了！

现在，我也希望它也转储到控制台屏幕。我使用了参数 >CON 但它会将所有内容转储到屏幕上，而不是文件。

powershell psake "Dev08, Deploy-things" >> C:\Deployments\DeploymentLog.txt 2>&1 >CON

也许 >CON 不是要走的路。这是我正在使用的测试：

目录 > c:\test\directory.txt 2>&1

任何人都知道如何做到这一点？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:56:01.673

不要让 CMD 输出文件，而是让您的 Powershell 命令使用`Tee-Object`cmdlt 来完成。

因此，对于您的情况，例如：

`powershell ^& "'C:\Program Files\7-Zip\7z.exe'" ^| tee B:\test.log`

请注意，`^`之前是必需的，`|`以便将其传递给 Powershell 并且不会按字面意思解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T15:22:48.323

好吧，事实证明，我找不到任何可以在命令提示符中写入 2 个不同输出的内容。将输出重定向到文件后，就可以重定向它。而已。我也找不到任何使用命令写入屏幕的方法。所以，我使用的解决方案是下载“TailXP”。将其安装在盒子上并将其配置为指向我正在编写的文件。这将在生成文件时读取文件并将其写入它自己的控制台屏幕。它达到了我们的目的，我将它们全部打包在一个 .cmd 文件中。

# svn - 将 trac 作为单一环境运行，如何摆脱“可用项目”页面？

> ID：10557289
> 
> 赞同：1
> 
> 时间：2012-05-11T19:12:42.043
> 
> 标签：svn, trac

我需要 trac 是 1 个环境，所以 trac 的项目选择页面对我的需求没有用。

trac.ini 中是否有任何设置或使用 trac-admin 禁用可用项目选择页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:05:44.397

使用[Tracd](http://trac.edgewall.org/wiki/TracStandalone#Reference)时，可以使用选项 --single-env;

```
-s, --single-env      only serve a single project without the project list 
```

您也可以在 /etc/conf.d/tracd 中将其设置为 TRACD_OPTS；例如

```
TRACD_OPTS="--single-env --auth=*,/var/lib/trac/myproject/users.htdigest,example.com /var/lib/trac/myproject" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-12T13:53:47.263

不，没有这样的 Trac 选项。并且不需要实现您所要求的。

Trac 的组织单位是环境。'-s' 切换到*tracd*是一个廉价的重定向规则，将请求转发到 web 服务器根目录到另一个目录，即单个 Trac env。你可以安排同样的

*   `Redirect /trac/ http://www.example.com/trac/single-env`在[.htaccess 文件](https://stackoverflow.com/questions/525978)或 httpd.conf 中
*   Apache 的[mod_rewrite](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)和经过适当编辑的 .htaccess 文件，其中包含类似`RewriteRule ^trac$ /trac/single-env`

您不应该使用可用的客户端重定向，因为它们不可靠。

# ruby-on-rails - 无需每次输入密码和确认即可更新用户配置文件

> ID：10557309
> 
> 赞同：4
> 
> 时间：2012-05-11T19:14:11.223
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试为我的用户模型创建一个名为 edit_profile 的新页面，以便用户可以编辑他的个人资料（字符串）。我正在关注[http://railscasts.com/episodes/41-conditional-validations](http://railscasts.com/episodes/41-conditional-validations)

这是表格（edit_profile.html.erb）：

```
 <%= form_for @user, :html => { :multipart => true } do |f| %>

  <div class="field">
    <%= f.label :profile %><br/>
    <%= f.text_area :profile, :class => "round" %><br />
  </div>

  <div class="actions">
    <%= submit_tag "update", :id => "updateSubmit" %>
  </div>
<% end %> 
```

我遇到的问题是我验证了密码和密码确认的存在。当我加载我的 edit_profile 视图时，`Password is too short (minimum is 6 characters)`即使在我尝试提交新的配置文件之前，我也会不断收到此消息。

这是我的 users_controller.rb：

```
def edit_profile
  @user = current_user
  @user.updating_password = false
  @user.save
  @title = "Edit profile"
end

def update
  @user = User.find(params[:id])
  if @user.update_attributes(params[:user])
    flash[:success] = "Account updated."
    redirect_to @user
  else
    @title = "Edit user"
    render 'edit'
  end
end 
```

**当我只想在用户模型中编辑我的个人资料属性时，如何绕过我的密码验证？**

谢谢！

其他相关信息：

用户.rb

```
class User < ActiveRecord::Base
    attr_accessor :password, :updating_password
    attr_accessible :name, :email, :password, :password_confirmation, :photo, 
                    :profile
    before_save :downcase_fields
    before_save :encrypt_password
    validates_presence_of :password, :if => :should_validate_password?
    validates_confirmation_of :password, :if => :should_validate_password?      
    def should_validate_password?
      updating_password || new_record?
    end

    validates :name, :presence => true,
              :name_format => true,  
              :uniqueness => { :case_sensitive => false }          
    validates :email, :presence => true, 
              :email_format => true,
              :uniqueness => { :case_sensitive => false }
    validates :password, 
               #:presence => true,
              #:confirmation => true,
              :length => { :within => 6..40 }
    validates :profile,  :length => { :maximum => 160 }
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:37:25.003

(1) 通常，当@user 是新记录时，form_for 会去创建，当@user 不是新记录时，它会去更新。如果这没有发生，那么，您需要设置 :url，也许是 :method。

```
<%= form_for @user, :url => (@user.new_record? ? users_path : user_path(@user),
            :html => (@user.new_record? ? { :multipart => true, :method => :post } : { :multipart => true, :method => :put } do |f| %> 
```

(2) 你要求的是

```
class User
  validate :validate_password_length

  def validate_password_length
    !new_record? || password.length >= 8
  end
end 
```

但是，这允许新用户创建一个帐户，将密码更改为更短的密码。因此，最好执行以下操作：

```
class User
  validate :validate_password_length

  def validate_password_length
    !password_changed? || password.length >= 8
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:00:35.750

鉴于您正在谈论配置文件编辑，即您已经有一个有密码的注册用户，您可能希望有条件地跳过密码更新。

只需删除`password`，`password_confirmation`如果`password_confirmation`为空白。IE：

```
class UsersController < ApplicationController
  before_filter :skip_password_attribute, only: :update

  ...

  def update
    ...
  end

  private

  def skip_password_attribute
    if params[:password].blank? && params[:password_validation].blank?
      params.except!(:password, :password_validation)
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:07:39.660

我建议为用户身份验证和东西设计。这取自设计源（https://github.com/plataformatec/devise/blob/master/lib/devise/models/validatable.rb）：

```
validates_presence_of     :password, :if => :password_required?
validates_confirmation_of :password, :if => :password_required?
validates_length_of       :password, :within => 6..128, :allow_blank => true

protected
  def password_required?
    !persisted? || !password.nil? || !password_confirmation.nil?
  end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-31T19:46:09.897

以下是我最终解决此问题的方法，尽管我很确定这并不理想 - 如果您有额外的密码强度规则，验证方法将需要更复杂。

基本上，您实际上根本不需要更改控制器 - 您可以修复您的模型来处理这种情况。

首先，您可以`:on => :create`在您的密码和密码确认字段上设置属性。但是，这样做的副作用是用户必须在注册时提供合规密码，但以后可以将其更改为不合规密码。为了解决这个问题，我`before_update`在更新时添加了一个回调来验证密码字段。我的`User`班级现在看起来像这样：

```
class User < ActiveRecord::Base
  ...
  before_update :check_password
  ...
  validates :password, presence: true,
                       length: { minimum: 6 },
                       on: :create

  validates :password_confirmation, presence: true,
                                    on: :create
  ...
  private
    ...
    def check_password
      is_ok = self.password.nil? || self.password.empty? || self.password.length >= 6

      self.errors[:password] << "Password is too short (minimum is 6 characters)" unless is_ok

      is_ok # The callback returns a Boolean value indicating success; if it fails, the save is blocked
    end
end 
```

如上面的评论所述，此方法的结果决定是否尝试保存。为了防止用户在没有错误消息的情况下被转储到编辑表单中，我注入了一个。 `[:password]`告诉它要将错误附加到哪个字段。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-26T23:58:07.960

您只需要添加`:on => :create`到`validate`.

# r - 如何使用多个排除对数据集进行子集化？

> ID：10557310
> 
> 赞同：4
> 
> 时间：2012-05-11T19:14:15.573
> 
> 标签：r

如何将所有状态名称组合在一个向量中，而不是单独列出所有逻辑排除？我在 CRAN 网站上找到了函数 %notin% ，但 R 不认为这是一个合法函数。

```
indata <- indata[which(indata$STATE != "GU" & indata$STATE != "WY" &
                       indata$STATE != "KS" & indata$STATE != "ME" &
                       indata$STATE != "MT" & indata$STATE != "ND" &), ] 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:17:16.573

```
indata[!indata$STATE %in% c("GU", "WY", "KS", "ME", "MT", "ND"), ] 
```

编辑：@CarlWitthoft，信不信由你，我实际上已经有一段时间在私人包裹中拥有以下内容

```
`%notin%` <- function (x, table) x[!x %in% table] 
```

然而，我从来没有想过要使用它，直到我已经把它打了很长一段路。另外，使用它会降低我的代码的可分发性。我不知道

```
operators:::`%!in%` 
```

这只是后半部分`%notin%`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T23:38:44.440

再试一次：

```
library(operators) 

x%!in%y  

#works fine 
```

# html - 以纯 HTML 读取时覆盖基本标记

> ID：10557311
> 
> 赞同：1
> 
> 时间：2012-05-11T19:14:21.643
> 
> 标签：html, ruby-on-rails, jquery-mobile, relative-path, base-tag

我目前正在一个带有 Rails 后端的 jQM 站点上工作。我们使用的几个页面正在读取用户从 AWS S3 上传的 HTML，并使用 rails 方法“html_safe”来呈现 html。这很好用，但是如果 html 对具有相对路径名的文件有任何引用，它们当然不会显示出来，因为它们需要从 S3 中获取。

所以我要做的是更改基本标记，以便这些相对路径名可以获取它们的资产。我已阅读 Navmodel 上的 jQM 文档，但我不熟悉 javascript，并且不确定是否可以使用 *BaseURL 方法来实现我的目标。

有人有可能的解决方案吗？任何建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:45:02.653

该`<base>`标签可以工作，但根据适用于整个页面的规范，这会破坏您页面上的任何其他相对 URL。

如果您不想确保所有其他 URL 都是绝对的，那么下一个最好的方法可能是使用 Nokogiri 来转换这些 URL。例如

```
require 'uri'
require 'nokogiri'

base_uri = URI 'http://example.com/'

html = %{ <!DOCTYPE html>
          <html><body>
          <ul>
            <li><a href="/some_relative_url.html">Relative</a></li>
            <li><a href="http://stackoverflow.com/">Absolute</a></li>
            <li><img src="/a_relative_image.png" /></li>
          </ul>
          </body></html>
        }

doc = Nokogiri::HTML html

attrs = %w( @href @src )

doc.search( *attrs ).each do |attr|
  path = URI attr

  attr.value = ( base_uri + path ).to_s unless path.absolute?
end

puts doc
# => <!DOCTYPE html>
#    <html><body>
#    <ul>
#      <li><a href="http://example.com/some_relative_url.html">Relative</a></li>
#      <li><a href="http://stackoverflow.com/">Absolute</a></li>
#      <li><img src="http://example.com/a_relative_image.png" /></li>
#    </ul>
#    </body></html> 
```

# sql-server - SQL Server - 涉及复制时并不总是触发插入或更新触发器

> ID：10557313
> 
> 赞同：0
> 
> 时间：2012-05-11T19:14:23.503
> 
> 标签：sql-server, triggers, replication

我们的 Microsoft SQL Server 数据库中有一个通知系统。发生的情况是一个名为 NotifyOnPropertyChangedTrigger 的 SQL 触发器创建了一个文件。我们的客户端软件使用 .NET FileSystemWatcher 类来等待新文件出现，它会读取并获取新的属性设置。这很好用，除非涉及 SQL 复制。

问题是这样的：

因此，我们将更改插入到我们的主数据库（复制到其他 3 个 SQL Server DB）中，SQL 触发器检测到更改，并且在硬盘上正确创建了文件。我们的数据库复制正确地更新了其他 3 个 DQL 数据库以反映最新的更改。然而，触发器只是偶尔工作，这意味着文件并不总是在其他 3 个硬盘上创建。（应该是。总共 4 个文件：1 个在主数据库上创建，3 个在复制数据库上创建）

我们正在使用合并复制。

任何想法为什么会发生这种情况？

提前致谢。

这是触发器：

```
ALTER TRIGGER [dbo].[NotifyOnPropertyChangeTrigger] 
   ON [dbo].[PropertyValues] 
   AFTER INSERT,DELETE,UPDATE
AS 
BEGIN
    SET NOCOUNT ON

    DECLARE @propertyValueID int

    DECLARE PropertyValueCursor CURSOR FOR
    SELECT DISTINCT [PropertyValueID]
    FROM (SELECT [PropertyValueID] FROM inserted
          UNION ALL
          SELECT [PropertyValueID] FROM deleted) AS Combined

    OPEN PropertyValueCursor
    FETCH NEXT FROM PropertyValueCursor INTO @propertyValueID

    WHILE @@FETCH_STATUS = 0
    BEGIN
        DECLARE @propertyID int
        DECLARE @profileID int
        DECLARE @contractName nvarchar(255)

        IF ((SELECT COUNT(*) FROM inserted WHERE [PropertyValueID] = @propertyValueID) > 0)
        BEGIN
            SELECT @propertyID = [PropertyID], @profileID = [ProfileID], @contractName = [ContractName]
            FROM inserted
        END
        ELSE
        BEGIN
            SELECT @propertyID = [PropertyID], @profileID = [ProfileID], @contractName = [ContractName]
            FROM deleted
        END

        DECLARE @propertyName nvarchar(255)
        DECLARE @needToSendNotification bit
        SELECT @propertyName = [PropertyName], @needToSendNotification = [NotifyOnUpdate]
        FROM [Properties]
        WHERE [PropertyID] = @propertyID

        IF (@needToSendNotification = 1)
        BEGIN
            DECLARE @profileName nvarchar(50)
            SELECT @profileName = [ProfileName]
            FROM [Profiles]
            WHERE [ProfileID] = @profileID

            DECLARE @fileName nvarchar(600) -- Must be at least 50 + 1 + 255 + 1 + 255 + 19 + 4
            SET @fileName =   dbo.CleanStringForFileName(@profileName)
                            + '-'
                            + dbo.CleanStringForFileName(@contractName)
                            + '-'
                            + dbo.CleanStringForFileName(@propertyName)
                            + '-'
                            + dbo.GetUTCDateTimeStampWithSeparator('-')
                            + '.txt'

            DECLARE @commandString nvarchar(650) -- Must be at least 5 + 10 + 27 + 585
            SET @commandString = 'echo ' + CAST(@propertyValueID AS nvarchar(10)) + ' >> C:\ClientNotifications\' + @fileName

            EXEC master.dbo.xp_cmdshell @commandString, NO_OUTPUT
        END

        FETCH NEXT FROM PropertyValueCursor INTO @propertyValueID
    END

    CLOSE PropertyValueCursor
    DEALLOCATE PropertyValueCursor
END 
```

# python - 如何为重复的项目比较列表列表（包含 N 个项目），但仅在不同列表中

> ID：10557314
> 
> 赞同：1
> 
> 时间：2012-05-11T19:14:29.600
> 
> 标签：python

我在休息多年后重新开始编程，并且无法解决这个问题。用户正在定义分类集数量，但 RasterValue 列表的长度为 N

示例：ClassificationSet = (1, 2, 3, 4, 5, 6) #由用户定义
RasterVal = () #length = N

我使用 ClassificationSet 作为索引将项目存储到 RasterVal： RasterVal(ClassificationSet).add(Imported Value)

```
RasterVal(1) = 22,23,24,25,23,23,22
RasterVal(2) = 22,30,31,32,30,30
RasterVal(3) = 31 
```

即：RasterVal([],[22,23,24,25,23,23,22], [22,30,31,32,30,30], [31])

我想列出重复的值，但前提是它们在不同的集合中重复，而不是在同一个集合中重复。

输出应该是：RepeatSet = 22, 31

非常感谢您的帮助。我已经能够比较这些集合，但它列出了重复的值，即使它们出现在同一个集合列表中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:28:55.570

@lukecampbell 是对的：

```
>>> lsts = [[22,23,24,25,23,23,22],[22,30,31,32,30,30],[31]]
>>> from collections import Counter
>>> c = Counter(x for lst in lsts for x in set(lst))
>>> [x for x,y in c.items() if y > 1]
[22, 31] 
```

该算法的运行时间是线性的，而不是集合数量的二次方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:30:39.400

```
RasterVal = [[22,23,24,25,23,23,22],[22,30,31,32,30,30],[31]]

from itertools import combinations
out = set()
for a,b in combinations(RasterVal,2):
    out = out|(set(a)&set(b))

print out
#output:
set([22, 31]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T19:22:53.060

```
#-- Your initial data...
rasterVals = [
    (22,23,24,25,23,23,22),
    (22,30,31,32,30,30),
    (31,)
]

#-- This will be a set, which holds only distinct values.
repeated = set( )

#-- We set up a classic inner-outer loop to iterate over all 
#-- pairs of lists in your given data.  (Note, there are better ways
#-- of doing this in Python, but this is the easiest to read and understand)
for a in rasterVals:
    #-- First, we'll make a set from the first element.
    #-- Since sets only hold distinct values, any repeated numbers
    #-- in the sequence will be ignored.
    s = set(a)

    for b in rasterVals:
        #-- Test that we are not comparing a sequence to itself.
        if (a is not b):
            #-- Make a set for the inner loop. (again, only distinct numbers...)
            t = set(b)

            #-- Get the intersection of s and t, answering with only those elements
            #-- that are in both s and t.
            intersecting = (s & t)

            #-- We update our set of (inter-sequence) repeated elements.
            repeated.update(intersecting)

#-- Show the results.
print repeated 
```

# delphi - Windows 8 Consumer Preview 主版本错误？

> ID：10557315
> 
> 赞同：5
> 
> 时间：2012-05-11T19:14:35.837
> 
> 标签：delphi, delphi-7, windows-8

我正在使用此代码来检测 PC 上的 WindowsVersion。

```
function GetOS: string;
var
 osVerInfo: TOSVersionInfo;
 majorVer, minorVer: Integer; 
begin
Result := 'Unknown';
osVerInfo.dwOSVersionInfoSize := SizeOf(TOSVersionInfo);
if GetVersionEx(osVerInfo) then
 begin
  majorVer := osVerInfo.dwMajorVersion;
  minorVer := osVerInfo.dwMinorVersion;
  case osVerInfo.dwPlatformId of
  VER_PLATFORM_WIN32_NT: {Mirosoft Windows NT/2000 }
    begin
      if majorVer <= 4 then
        Result := 'Win NT'
      else if (majorVer = 5) and (minorVer = 0) then
        Result := 'Win 2k'
      else if (majorVer = 5) and (minorVer = 1) then
        Result := 'Win XP'
      else if (majorVer = 6) and (minorVer = 0) then
        Result := 'Win Vista'
      else if (majorVer = 6) and (minorVer = 1) then
        Result := 'Win 7'
      else if (majorVer = 6) and (minorVer = 2) then
        Result := 'Win 8'
    end;
  VER_PLATFORM_WIN32_WINDOWS:  { Windows 9x/ME }
    begin
      if (majorVer = 4) and (minorVer = 0) then
        Result := 'Win 95'
      else if (majorVer = 4) and (minorVer = 10) then
      begin
        if osVerInfo.szCSDVersion[1] = 'A' then
          Result := 'Win 98SE'
        else
          Result := 'Win 98';
      end
      else if (majorVer = 4) and (minorVer = 90) then
        Result := 'Win ME'
    end;
  end;
end;
end; 
```

出于某种原因，它说 Windows8 Consumer Preview Build 8250（32 位）是 Windows XP - 主要版本 5。我检查了它应该是版本 6.2（根据 windows8 上的 notepad.exe）这是一个错误还是有什么问题？顺便提一句。我的 Windows 8 已更新。

有任何想法吗？

编辑：截图 ![GETOS](../Images/973ae19cb3e1c5ef21f985df8afa407b.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-11T19:40:37.293

此行为的原因是 XP 兼容模式，Delphi 7 IDE 是在兼容模式下运行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-22T15:20:31.087

对于 Windows 8.0，版本 6.2 是正确的 - 也是内部版本号。使用 Windows 8.1，您也可以获得 6.2 版。但是现在版本号是 6.3 Build 9600。你可以在系统信息中看到它。GetVersionEx 只允许 Win32MinorVersion 使用 0,1,2。如果您需要此信息，您可以从 HKCU\Software\Microsoft\Internet Explorer\Main\WindowsSearch 中的注册表项“版本”中读取它。最好的问候，问

# c# - 返回列表的最佳方式是什么 通过方法？

> ID：10557316
> 
> 赞同：1
> 
> 时间：2012-05-11T19:14:51.130
> 
> 标签：c#, .net, c#-4.0, collections

假设我有一个返回字符串名称列表的方法。

```
public List<String> buildNamesList(){
   List<String> namesList = new List<String>();
   //add several names to the list
   return namesList;
} 
```

现在，如果我有一个需要该 namesList 的方法会像这样返回它是最好的方法吗？

```
public void someMethod(){
  List<String> namesList = new List<String>();
  namesList = buildNamesList();
  //traverse namesList
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:17:16.310

如果您在 buildNamesList 方法中创建一个新列表，我只想说：

```
var namesList = buildNamesList(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T19:16:40.880

如何返回列表实际上取决于您在做什么。

如果您只需要内存中的整个列表，那么您的方法很好，尽管我会这样称呼它：

```
public void someMethod(){
  List<String> namesList = buildNamesList();
} 
```

无需将变量初始化为将立即替换的空列表。

如果列表非常大或者您只需要遍历它，您可以使用[`yield`](http://msdn.microsoft.com/en-us/library/9k7k7cf0.aspx)关键字并将函数的返回类型更改为`IEnumerable<string>`，尽管您当前的设计不适合这种模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T19:16:41.123

不要将它分配给你的变量，`new List<T>()`只是为了立即用你的返回值替换它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T19:16:55.757

您不需要将其初始化两次，只需执行以下操作：

```
public void someMethod(){
    List<String> namesList = buildNamesList();
} 
```

尽管如果您是 FxCop 爱好者，严格来说，让方法返回具体类型（`List`在本例中）并不是一个好习惯，但您应该返回接口（`IEnumerable`）

编辑：作为参考，它是 FxCop 规则[CA1059](http://msdn.microsoft.com/en-us/library/ms182160.aspx) :)

# c# - 使用 C# 从 FTP 写入和读取 .txt 文件

> ID：10557321
> 
> 赞同：1
> 
> 时间：2012-05-11T19:15:23.843
> 
> 标签：c#, .net, ftp, ftpwebrequest, ftpwebresponse

是否可以在ftp上写入txt文件（不上传文件到ftp！）直接在ftp服务器上写入txt文件）并从ftp上读取文件（不是从ftp下载文件！）直接从txt读取FTP服务器上的文件？我搜索了但我发现上传一个文件并下载一个带有 FtpWebRequest 类的文件。注意：FTP 服务器使用凭据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:21:53.777

不，这是不可能的。

[RFC 959](https://www.rfc-editor.org/rfc/rfc959)中描述的[FTP 协议](http://en.wikipedia.org/wiki/File_Transfer_Protocol)没有任何方法可以实现您想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:22:48.537

不，据我所知，您唯一的选择是下载或上传文件。我想你可以通过只下载文件直到你到达你需要的部分来缩短它，然后中止。但是 FTP 的全部目的是上传/下载文件，而不是内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T06:10:18.680

可以借助应安装在系统中的第三方虚拟文件系统驱动程序来实现。存在第三方应用程序，可让您将远程 FTP 位置视为计算机上的虚拟磁盘。以这种方式挂载远程 FTP 位置后，您可以使用常规文件 I/O 方法来读取和写入这些文件。您也可以创建这样的应用程序（不是使用正确工具的火箭科学）。

# c++ - 试图计算一个字符串

> ID：10557322
> 
> 赞同：1
> 
> 时间：2012-05-11T19:15:31.020
> 
> 标签：c++, visual-c++, c++-cli

我一直在尝试计算使用 22+3*9/8 的输入分配的变量“计算”。我尝试了很多，但我所有的努力都是徒劳的，请让我知道如何解决这个问题以获取输出结果

```
char calculate[10]; 
calculate = "22+3*9/8"; 
cout<< calculate; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:24:01.857

您需要将中缀语句转换为后缀，然后使用堆栈评估表达式要容易得多。参见[例如](http://scriptasylum.com/tutorials/infix_postfix/algorithms/infix-postfix/index.htm)（有很多方法可以做到这一点）

将表达式转换为后缀后

22+3*9/8 -> 22 3 9 * 8 / +

您可以使用堆栈来评估表达式

如果是数字，则压入堆栈，如果是运算符，则将堆栈上的两个最上面的操作数进行计算，然后将结果压入堆栈：

```
expr  stack (top ... bottom)
22    22
3     3 22
9     9 3 22
*     27 22
8     8 27 22
/     3 22        // here u could start using floating numbers instead 3.375 instead of 3
+     25 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:45:39.307

您可以在 C# 中使用新的[Roslyn](http://blogs.msdn.com/b/visualstudio/archive/2011/10/19/introducing-the-microsoft-roslyn-ctp.aspx) API，然后从 C++ API 调用它。

然后您可以使用以下示例：

```
 using Roslyn.Compilers;
 using Roslyn.Scripting;
 using Roslyn.Scripting.CSharp;

 public int Eval(string expr) {
       var engine = new ScriptEngine();
       return (int)engine.Execute(expr);
 } 
```

但是警告，您可能应该检查表达式不包含非法字符或其他类型的东西，因为这可能是一个安全错误。

# sqlite - 用于复制或简单传输数据的数据库

> ID：10557323
> 
> 赞同：1
> 
> 时间：2012-05-11T19:15:42.113
> 
> 标签：sqlite, database-design, nosql, relational-database, replication

我将尝试描述我选择好的技术的问题。

我有很多机器将数据本地存储在数据库中。并且有一台具有自己的数据库的客户端计算机。我需要的是从所有机器中提取数据并放入客户的数据库中。现在我已经开始实现一些 RPC，但我不知道它是否是个好主意。因为我需要手动照顾每张桌子。数据库是 SQLite。

什么是更好的。进行一些 RPC 调用或找到一些具有复制功能的轻型数据库？也许像 MonoDB 这样的 NoSQL 数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T10:38:08.080

我有一个类似的设置，我有几个服务器收集各种统计数据并存储在 sqlite3 数据库中。将它们结合起来真的很容易。我有一个连接到每个服务器的 python 脚本，将每个数据库文件下载到一个临时文件夹中。然后我打开第一个，对每个文件使用 ATTACH，然后为每个表插入 * 以将所有其他数据库合并到一个组合数据库中：

```
conn = connect('/tmp/database1.sl3');
curs = conn.cursor();

mergeDatabases(curs, 8);

def mergeDatabases(curs, j):
    for i in range(2, j):
            print "merge in database%d" %i
            print "ATTACH '/tmp/database%d.sl3' AS foo%d;" %(i,i)
            curs.execute("ATTACH '/tmp/database%d.sl3' AS foo%d;" %(i,i))      
            curs.execute("insert into db select * from foo%d.db;" %i)
            curs.execute("insert into vars select * from foo%d.vars;" %i)

            curs.execute("detach foo%d;" %i) 
```

# c# - 准备在另一个线程中使用的操作

> ID：10557328
> 
> 赞同：2
> 
> 时间：2012-05-11T19:16:04.437
> 
> 标签：c#, multithreading, properties, action

我想定义一个设置属性值的操作（由工作线程计算）。应该在另一个线程上下文（UI 线程）中调用该操作。

为了简化问题 - 它归结为一个问题：为什么这段代码不起作用以及我必须做些什么才能使其按预期工作：

```
 public struct Person
    {
        public string Name;
    }

    Person person;
    Action<Person> action;

    public void Update()
    {
        person = new Person();

        new Thread(() =>
        {
            action = new Action<Person>(c => c.Name = "Me");
        }).Start();

        Thread.Sleep(1000);
        action(person);

        Debug.WriteLine(person.Name ?? "null");
    } 
```

为什么这给了我“null”而不是“Sami”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:27:12.987

类型`Person`是结构。这意味着当您`person`作为参数传递时，会生成一个副本。所以这个动作更新了一个副本，而不是`person`它本身。如果您更改`Person`为班级，您将看到您的示例有效。

有关结构和类之间区别的更多信息，请参阅[.Net 中结构和类之间的区别是什么？](https://stackoverflow.com/questions/13049/whats-the-difference-between-struct-and-class-in-net)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:34:19.997

为了证明@ElianEbbing 的回答：

```
 class Program {
      Person person;
      Action<Person> action;
      static void Main(string[] args) {
         Program p = new Program();
         p.Update();

         Console.ReadLine();
      }
      public void Update() {
         person = new Person();

         new Thread(() => {
            action = new Action<Person>(c => c.Name = "Sami");
         }).Start();

         Thread.Sleep(1000);
         action(person);

         Console.WriteLine(person.Name ?? "null");
      }
   }

   public class Person {
      public string Name;
   } 
```

因为您将 Person 声明为结构，所以它是一种值类型 - 意味着制作了 Person 的副本。Name 设置为“Sami”的 Person 对象与您用来编写名称的 Person 对象不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T19:35:25.120

您使用错误的线程和操作。通过创建一个线程（设置一个动作来设置人的名字），你实际上并没有做任何特别的事情。

```
 new Thread(() =>
    {
        action = new Action<Person>(c => c.Name = "Me");
    }).Start();
    Thread.Sleep(1000); 
```

是相同的

```
action = new Action<Person>(c => c.Name = "Me");
action(person); 
```

你想要的是这样的：

```
action = new Action<Person>(c => c.Name = "Me");
new Thread(action).Start();
Thread.Sleep(1000); 
```

# php - 我可以在不登录的情况下在 Facebook iFrame 中运行应用程序吗？

> ID：10557331
> 
> 赞同：0
> 
> 时间：2012-05-11T19:16:12.207
> 
> 标签：php, facebook

我正在讨论，我想知道我们是否可以让用户在不登录 Facebook 的情况下在 Facebook 页面选项卡应用程序上进行操作？我不想要任何用户信息，我不需要知道他们是否喜欢它。我只是希望他们能够使用我的 iFrame 应用程序而无需登录 Facebook。

例如：退出 Facebook 并转到此页面：[https](https://www.facebook.com/nissancanada/app_331500170235929) ://www.facebook.com/nissancanada/app_331500170235929 。您仍然可以使用它而无需登录 Facebook。那么，我可以在不让用户登录 Facebook 的情况下为表单和提交选项提供类似的页面吗？

PS：不要问拥有这个等有什么意义。这是一个长期的想法。只是想在这方面找到一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:23:37.310

是的，您可以（就像在您传递的链接中一样）...您不需要做任何特别的事情...只是不要要求登录，它会起作用。

尽管对于某些页面，页面的属性可能会阻止在没有主动登录的情况下访问页面，因此它不依赖于应用程序

# python - Django：使用 ._get_deleted_forms 和自定义表单集保存

> ID：10557341
> 
> 赞同：1
> 
> 时间：2012-05-11T19:16:41.670
> 
> 标签：python, django, django-forms

我正在尝试提供一些自定义表单集处理。用户可以选择删除表单和添加表单。在同一个函数中，我试图删除关联的对象并添加新对象。这是我正在处理的代码示例：

```
def addCategories(movie, category_formset):
    if category_formset.deleted_forms:
        for form in category_formset._get_deleted_forms:
            obj_to_remove = form.save(commit=False)
            movie.categories.remove(obj_to_remove)
    for form in category_formset:
        if form.cleaned_data.get('name') is not None:
            obj = Category.objects.get_or_create_category(form.cleaned_data.get('name'))
            movie.categories.add(obj)
    movie.save() 
```

问题是我认为我没有正确使用 ._get_deleted_forms 。它声称 category_formset._get_deleted_forms 是不可迭代的。而且我不确定这是否会起作用——因为它可能只是在第二个 for 循环中将已删除的对象添加回模型。有任何想法吗？

一种似乎不是很有效的解决方法：

```
def addCategories(recipe, category_formset):

    if category_formset.deleted_forms:
        for form in category_formset:
            if form in category_formset.deleted_forms:
                obj_to_remove = form.save(commit=False)
                recipe.categories.remove(obj_to_remove)
            else:
                if form.cleaned_data.get('name') is not None:
                    obj = Category.objects.get_or_create_category(form.cleaned_data.get('name'))
                    recipe.categories.add(obj)
    else:
        for form in category_formset:
            if form.cleaned_data.get('name') is not None:
                obj = Category.objects.get_or_create_category(form.cleaned_data.get('name'))
                recipe.categories.add(obj) 
    recipe.save() 
```

# ruby-on-rails - ruby 代表的 to 是什么

> ID：10557359
> 
> 赞同：1
> 
> 时间：2012-05-11T19:18:11.810
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, cancan

我正在管理的应用程序在用户模型中有此代码

```
delegate :can?, :cannot?, :to => :ability 
```

我知道委托可以是关联的捷径，但我不明白`:to => :ability`

我假设它是 cancan 的能力.rb 的快捷方式，但不是 100% 确定

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:19:33.553

该语法归结为以下内容：

```
delegate(:can?, :cannot?, {:to => :ability}) 
```

在[`delegate`docs](http://api.rubyonrails.org/classes/Module.html#method-i-delegate)中，该`:to`选项定义了要委托给的目标对象。（CanCan 可能定义了一个`ability`实例方法，无论你在哪里调用它）

# linux - 在 Linux 中使用命令行将 xlsx 转换为 csv

> ID：10557360
> 
> 赞同：338
> 
> 时间：2012-05-11T19:18:12.767
> 
> 标签：linux, excel, csv, converter, xlsx

我正在寻找一种在 Linux 上将 xlsx 文件转换为 csv 文件的方法。

我不想使用 PHP/Perl 或类似的东西，因为我正在处理数百万行，所以我需要一些快速的东西。我在 Ubuntu 存储库上找到了一个名为 xls2csv 的程序，但它只会转换 xls (Office 2003) 文件（我目前正在使用），但我需要对较新的 Excel 文件的支持。

有任何想法吗？

* * *

## 回答 #1

> 赞同：291
> 
> 时间：2012-05-14T09:34:41.440

[Gnumeric](http://projects.gnome.org/gnumeric/)电子表格应用程序带有一个名为[ssconvert](https://help.gnome.org/users/gnumeric/stable/sect-files-ssconvert.html)的命令行实用程序，可以在多种电子表格格式之间进行转换：

```
$ ssconvert Book1.xlsx newfile.csv
Using exporter Gnumeric_stf:stf_csv

$ cat newfile.csv 
Foo,Bar,Baz
1,2,3
123.6,7.89,
2012/05/14,,
The,last,Line 
```

*在 Ubuntu 上安装：*

```
apt-get install gnumeric 
```

*在 Mac 上安装：*

```
brew install gnumeric 
```

* * *

## 回答 #2

> 赞同：167
> 
> 时间：2013-02-13T14:54:56.460

您可以使用 LibreOffice 执行此操作：

```
libreoffice --headless --convert-to csv $filename --outdir $outdir 
```

由于我不清楚的原因，您可能需要使用 sudo 运行它。您可以通过将此行添加到您的 sudoers 文件来使 LibreOffice 与 sudo 一起工作而无需密码：

```
users ALL=(ALL) NOPASSWD: libreoffice 
```

* * *

## 回答 #3

> 赞同：161
> 
> 时间：2014-02-14T18:34:32.243

如果您已经拥有桌面环境，那么我确信 Gnumeric / LibreOffice 会运行良好，但在无头服务器（例如 Amazon Web Services）上，它们需要您还需要安装的数十个依赖项。

我找到了这个 Python 替代品：

[https://github.com/dilshod/xlsx2csv](https://github.com/dilshod/xlsx2csv)

```
$ easy_install xlsx2csv
$ xlsx2csv file.xlsx > newfile.csv 
```

安装只需 2 秒，效果非常棒。

如果您有多张工作表，您可以一次全部导出，或者一次导出一张：

```
$ xlsx2csv file.xlsx --all > all.csv
$ xlsx2csv file.xlsx --all -p '' > all-no-delimiter.csv
$ xlsx2csv file.xlsx -s 1 > sheet1.csv 
```

他还链接到使用 Bash、Python、Ruby 和 Java 构建的几个替代方案。

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2014-02-08T20:54:22.347

在 bash 中，我使用这个 libreoffice 命令来转换当前目录中的所有 xlsx 文件：

```
for i  in *.xlsx; do  libreoffice --headless --convert-to csv "$i" ; done 
```

在执行之前关闭所有 Libre Office 打开的实例，否则它将静默失败。

该命令处理文件名中的空格。

几年后又试了一次，还是不行。[该线程](https://stackoverflow.com/questions/12101855/libreoffice-headless-refuses-to-convert-unless-root-wont-work-from-php-scrip)提供了一些提示，但最快的解决方案是以 root 身份运行（或运行 a `sudo libreoffice`）。不优雅，但很快。

在 Windows 中使用命令 scalc.exe

* * *

## 回答 #5

> 赞同：45
> 
> 时间：2014-11-06T09:10:29.557

使用[csvkit](https://github.com/onyxfish/csvkit)

```
in2csv data.xlsx > data.csv 
```

有关详细信息，请查看他们的优秀[文档](https://csvkit.readthedocs.org/en/0.9.0/tutorial/1_getting_started.html#in2csv-the-excel-killer)

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2014-09-02T15:03:26.317

为方便起见，另一种选择是通过小型 bash 包装器使用 R：

```
xlsx2txt(){
echo '
require(xlsx)
write.table(read.xlsx2(commandArgs(TRUE)[1], 1), stdout(), quote=F, row.names=FALSE, col.names=T, sep="\t")
' | Rscript --vanilla - $1 2>/dev/null
}

xlsx2txt file.xlsx > file.txt 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-11-12T21:43:58.410

如果`.xlsx`文件有很多工作表，`-s`可以使用标志来获取您想要的工作表。例如：

```
xlsx2csv "my_file.xlsx" -s 2 second_sheet.csv 
```

`second_sheet.csv`将包含第二张纸的数据`my_file.xlsx`。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-06-11T15:45:08.703

使用名为 ssconvert 的命令行实用程序附带的[Gnumeric](http://www.gnumeric.org)电子表格应用程序确实非常简单：

```
find . -name '*.xlsx' -exec ssconvert -T Gnumeric_stf:stf_csv {} \; 
```

你就完成了！

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-05-11T19:42:22.103

如果您可以运行 Java 命令行，那么您可以使用 Apache POI HSSF 的[Excel Extractor](http://poi.apache.org/apidocs/org/apache/poi/hssf/extractor/ExcelExtractor.html)来完成。它有[一个`main`方法说是命令行提取器](http://poi.apache.org/apidocs/org/apache/poi/hssf/extractor/ExcelExtractor.html#main%28java.lang.String%5B%5D%29)。这似乎只是把所有东西都倾倒了。他们指出[这个转换为 CSV 的例子](http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/hssf/eventusermodel/examples/XLS2CSVmra.java)。您必须先编译它，然后才能运行它，但它也有一个`main`方法，因此您本身不必进行太多编码即可使其工作。

另一个可能可行但需要在另一端进行一些工作的选项是让您的 Excel 文件以 Excel XML 数据或[XML 电子表格](http://msdn.microsoft.com/en-us/library/aa140066%28v=office.10%29.aspx)的形式提供给您，这些数据是 MS 所称的任何格式。它将为您打开一个全新的机会世界，以您想要的方式对其进行切片和切块。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-12-16T10:22:57.670

正如其他人所说，`libreoffice`可以将 xls 文件转换为 csv。对我来说，问题是纸张选择。

这个[libreoffice Python 脚本](https://github.com/colonelqubit/libreconverter)在将单个工作表转换为 CSV 方面做得很好。

用法是：

```
./libreconverter.py File.xls:"Sheet Name" output.csv 
```

唯一的缺点（就我而言）是这`--headless`似乎不起作用。我有一个显示一秒钟然后退出的 LO 窗口。
这对我来说没问题，它是唯一能够快速完成工作的工具。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-12-30T04:17:30.583

您可以使用**libreoffice**将您的 .xlsx 文件转换为 csv

```
$ libreoffice --headless --convert-to csv ABC.xlsx 
```

参数**--headless**表示我们不需要**GUI**。

# ruby - 将 DDMON（例如 23JAN）日期格式转换为在 Ruby 中应用正确年份的完整日期

> ID：10557362
> 
> 赞同：0
> 
> 时间：2012-05-11T19:18:21.940
> 
> 标签：ruby, date

我正在寻找一种紧凑的解决方案来转换来自没有年份的航空公司预订系统（GDS，如 Sabre/Galileo/Amadeus）的日期 - 例如。23JUN 是一个标准日期，但需要快速确定年份以在 Ruby 中添加。（仅供参考 - 在这些系统上，日期最多只能是从今天起 355 天。因此，假设今天是 2012 年 5 月 12 日，将 12MAY 解释为 2013-05-12 而不是 2012-05-12 并没有歧义）。如果今天是 2012 年 12 月 25 日，并且日期输入为 01JAN，那么这将是未来的 01JAN2013，如果今天是 2012 年 7 月 21 日，那么输入的日期 01JAN 也将变为 01JAN 2013，因为它是当年的过去日期。

所以我可以做类似的事情：

```
t = DateTime.now
crsdate = DateTime.strptime("23JAN","%d%b")

if crsdate >= t
  # Year is current year
else
  # Year is next year
end 
```

有没有更优雅的方式来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:50:17.943

这个怎么样？

```
t = DateTime.now
crsdate = DateTime.strptime("23JAN","%d%b")
crsdate >= t ? crsdate >>= 12 : crsdate 
```

如果您不需要修改`crsdate`，因为您只想返回它，请使用`>>`而不是`>>=`.

# iphone - iphone本地化应用的json表示

> ID：10557364
> 
> 赞同：0
> 
> 时间：2012-05-11T19:18:24.250
> 
> 标签：iphone, objective-c, json

我写了一个简单的 json 来表示相同位置的位置，例如：

```
{
        lat = "41.653048";
        long = "-0.880677";
        name = LIMPIA;
    }, 
```

在 iphone 编程中，我的应用程序能够在地图上显示位置。我的问题是如何在多个位置复制相同的。例如使用像这样的json：

```
 {
    lat = "41.653048";
    long = "-0.890677";
    name = name1 ;
},

    {
    lat = "41.653048";
    long = "-0.890677";
    name = name2;
}, 
```

我怎么能知道项目的数量？我必须更改 json 在表示中添加任何其他内容？或者我必须完成更改它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:26:27.950

您需要使用 JSON 数组：

```
[
  {
    lat = "41.653048";
    long = "-0.890677";
    name = name1 ;
  },
  {
    lat = "41.653048";
    long = "-0.890677";
    name = name2;
  },
] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:27:27.043

我不确定我是否理解您的问题，但您似乎想知道如何最好地在一个 JSON 对象中包含多个点？

```
{ 
  "locations": 
   [ 
      {
        lat = "41.653048";
        long = "-0.890677";
        name = name1 ;

      }, 
      {
        lat = "41.653048";
        long = "-0.890677";
        name = name2;

      }
   ] 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T19:27:27.770

不确定您是否要从/向对象解析或写入 JSON。我概述了两者。

```
@interface MyPointModel : NSObject

@property (nonatomic, strong) NSNumber *latitude;
@property (nonatomic, strong) NSNumber *longitude;
@property (nonatomic, strong) NSString *name;

@end

@implementation MyPointModel

@synthesize latitude, longitude, name;

@end 
```

**解析**

（以及您在哪里进行解析）

```
@implementation ParsingController

...
- (NSArray *)buildArrayOfMyPointModelWithString:(NSString *)json {

    NSArray *array = [jsonParser.objectWithString:json error:NULL];
    NSMutableArray *arrayOfMyPointModel = [[NSMutableArray alloc] init];

    for (id jsonElement in array) {
        MyPointModel *m = [[MyPointModel alloc] init];

        m.latitude = [jsonElement valueForKey:@"lat"];
        m.longitude = [jsonElement valueForKey:@"long"];
        m.name = [jsonElement valueForKey:@"name"];

        [arrayOfMyPointModel addObject:m];
    }

    return (NSArray *)arrayOfMyPointModel;
} 
```

**写作**

（我的观点的样本数组）

```
NSMutableArray *a = [[NSMutableArray alloc] init];
MyPointModel *m1 = [[MyPointModel alloc] init];
MyPointModel *m2 = [[MyPointModel alloc] init];
m1.latitude = [NSNumber numberWithDouble:0.1];
m1.longitude = [NSNumber numberWithDouble:0.01];
m1.name = @"M1";
m2.latitude = [NSNumber numberWithDouble:0.2];
m2.longitude = [NSNumber numberWithDouble:0.02];
m2.name = @"M2";
[a addObject:m1];
[a addObject:m2];

- (NSString *)buildJsonStringWithMyPointModelArray:(NSArray *)array {

    SBJsonWriter *writer = [[SBJsonWriter alloc] init];

    return [writer stringWithObject:array];
} 
```

# ajax - 如何将 onSelectChange() 与查询结合使用 - ColdFusion 9 - Ajax

> ID：10557368
> 
> 赞同：0
> 
> 时间：2012-05-11T19:18:31.530
> 
> 标签：ajax, jquery, coldfusion, coldfusion-9

我有一个下拉列表，列出了用户的不同选项。我需要该列表根据用户选择来填充文本区域。我的数据库中已经有数据，我希望能够根据用户从下拉列表中的选择运行查询。

这就是我的选择标签现在的样子：

```
<select name="procedure" onChange="">
            <option value="">Select Procedure</option>
            <cfloop query="procedures">
                <option value="#procedureId#">#procedureName#</option> 
            </cfloop>
        </select> 
```

这是我的文本区域：

```
 <textarea name="procedureDescription" cols="80" rows="6">#the query output will go here#</textarea><br /> 
```

有没有办法使用`onSelectChange`函数来控制 Ajax 的服务器端查询？

我希望我的想法很清楚，如果您需要更多信息，请询问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:37:56.707

是的，除非我误解，否则您应该可以使用 Ajax 请求来执行此操作。**onchange**方法应如下所示：

```
function handleProcedureChange()
{
    var selectedVal = $(this).val();
    var url;  // TODO set procedure URL here, using selectedVal as needed

    $.get(url, function(procedureResult) {
        $("#procedureDescription").text(procedureResult);
    });
} 
```

然后，您需要设置服务器端方法来运行该过程并将结果作为纯文本返回。

# .net - .net 堆内存的架构

> ID：10557369
> 
> 赞同：3
> 
> 时间：2012-05-11T19:18:48.143
> 
> 标签：.net, memory-management

当我们谈论 Windows 内存架构时 => 我们谈论的是虚拟内存管理器，它将内存块“提供”给分配应用程序要求的内存大小的应用程序管理器堆。

( [http://msdn.microsoft.com/en-us/library/ms810466.aspx](http://msdn.microsoft.com/en-us/library/ms810466.aspx) )

但是在 .net => 中，.net 托管堆是从虚拟内存管理器“询问”内存（我几乎可以肯定是这种情况）还是 .net 托管堆和虚拟内存管理器之间存在一些层？

（这个问题与GC无关）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T21:30:26.033

.NET 运行时基本上充当托管堆的内存管理器。所以每次你新建一个对象时，它要么推进 gen0 GC 堆上的指针（这可能会触发一个收集），要么在大对象堆上分配一个卡盘。后者类似于常规 CRT 堆，因为它使用空闲列表。

GC 堆本身存储在根据需要分配/释放给操作系统的段中。这意味着托管内存使用通常不会立即反映在进程级别上。

您可以通过 SOS 调试器扩展检查托管堆是如何从不同的段构建的，该扩展可以在 WinDbg 中加载（它也可以在 VS 中加载，但如果你问我，体验有点粗糙）。

我想到了两本书：[CLR via C#](https://rads.stackoverflow.com/amzn/click/com/0735627045)和[Shared Source CLI](https://rads.stackoverflow.com/amzn/click/com/059600351X)。他们都在某种程度上涵盖了这一点。

# java - Java-如何根据jsp中数据库中存储的值在下拉列表中设置特定值

> ID：10557373
> 
> 赞同：0
> 
> 时间：2012-05-11T19:19:15.933
> 
> 标签：java, jsp, drop-down-menu, default

我有一个带有静态值的下拉框，我现在创建了一个 EDIT.jsp 页面，该页面将显示我存储在数据库中的值，我希望它们作为默认值显示在下拉列表中，考虑到有 4 个元素

```
 <select name="language">
  <option value="1">c++</option>
  <option value="2">php</option>
  <option value="3">.net</option>
  <option value="4">java</option> 
```

我想如果数据库表中的值为 3，那么当页面加载时，默认值应如下拉列表中所示

```
 <select name="language">
  <option value="3">.net</option>
  <option value="1">c++</option>
  <option value="2">php</option>
  <option value="4">java</option> 
```

我不能在这个中使用jquery...我想要一个最好在java中的解决方案我尝试使用值属性和javascript但它不起作用...我是java新手所以我不知道如何传递java scriplets如果可能的话，在javascript中......我正在为我的第二年工程项目制作一个在线考试系统

请帮忙！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:22:48.387

对于您希望默认选择的任何选项，将其更改为

```
<option value="3" SELECTED >.net</option> 
```

注意：标签的 SELECTED 属性将默认选择该选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:28:41.333

您必须使用选项标签的选定属性。

获取存储在数据库中的值，并将它们放入选择框中

```
<c:if test={1 is selected}>
    <option value = "1" selected="selected">c++</option>
</c:if>

<c:if test={2 is selected}>
    <option value = "2" selected="selected">java</option>
</c:if>

<c:if test={3 is selected}>
    <option value = "3" selected="selected">php</option>
</c:if>

<c:if test={4 is selected}>
    <option value = "4" selected="selected">.net</option>
</c:if> 
```

# php - TimThumb 在路径是相对时有效，但在绝对路径时无效

> ID：10557376
> 
> 赞同：1
> 
> 时间：2012-05-11T19:19:40.860
> 
> 标签：php, wordpress, path, relative-path, absolute-path

请问你能帮忙吗？

基本上我从 ThemeForest 购买了 Centita 主题并将其安装在我的服务器上

我面临的主要问题是 TimThumb 使用**绝对路径**读取我的缩略图/图像：

[http://ohmu.co.za/wp-content/themes/centita/timthumb.php?src=http://ohmu.co.za/wp-content/themes/centita/images/img-main1.jpg&h= 90&w=66&zc=1](http://ohmu.co.za/wp-content/themes/centita/timthumb.php?src=http://ohmu.co.za/wp-content/themes/centita/images/img-main1.jpg&h=90&w=66&zc=1)

这给出了 500 错误。

经过调查，最后，我发现**相对路径**有效：

[http://ohmu.co.za/wp-content/themes/centita/timthumb.php?src=/wp-content/themes/centita/images/img-main1.jpg&h=90&w=66&zc=1](http://ohmu.co.za/wp-content/themes/centita/timthumb.php?src=/wp-content/themes/centita/images/img-main1.jpg&h=90&w=66&zc=1)

**所以我的问题如下：**

我是否编辑主题以引用相对路径？我该怎么做呢？

或者我将如何获得工作的绝对路径？

* * *

我使用 WordPress 的时间不长，但我通常擅长故障排除，直到我脸色发青，不过这个问题对我来说有点多。我非常感谢您的帮助。

* * *

**只是为了让您知道我尝试过的操作，以免您不建议这样做：**

我已将 .htaccess 更改为显示（这使我的网站无法显示，所以我将其删除）

```
SecFilterEngine Off
SecFilterScanPost Off 
```

支持并启用 GD 库

TimThumb 是新的和更新的版本

chmods 全部更改为 777

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:57:30.697

问题应该是主机造成的，因为有些主机不允许`http://www`在 URL 中使用。

如果您要显示的图像在您的站点中，则无需使用绝对路径，因此您可以毫无问题地传递相对路径...

要使 url 相对，最简单的方法是从 PHP 代码中替换包含 URL 的字符串中的域名，您可以使用[str_replace](http://php.net/manual/en/function.str-replace.php)函数：

```
$url = str_replace(get_bloginfo('url'), '', $url); 
```

请注意，wordpress 中的函数`get_bloginfo`应该获取站点的基本 url，否则您甚至可以使用硬编码版本（在您的情况下：http: [//ohmu.co.za](http://ohmu.co.za)）

还可以看看[这篇](http://kav.in/wordpress-absolute-relative-paths/)有用的文章，它很好地解释了如何在 Wordpress 中处理路径。

*请记住，StackExchange 上有一个更专业的论坛，您可以在其中询问有关 Wordpress 的问题，即：[Wordpress Answer](https://wordpress.stackexchange.com/)。*

# linux - 在linux中的所有文件中搜索和替换代码块

> ID：10557379
> 
> 赞同：4
> 
> 时间：2012-05-11T19:20:31.640
> 
> 标签：linux, search, replace

这个问题在哲学上类似于这里一次又一次出现的问题：

*   [在linux目录的所有文件中搜索和替换文本](https://stackoverflow.com/questions/4090194/search-and-replace-text-in-all-files-of-a-linux-directory)
*   [如何在 Ubuntu Linux 中搜索替换文件中的内容？](https://stackoverflow.com/questions/5745893/how-to-search-replace-content-within-files-in-ubuntu-linux)
*   [Linux 搜索和替换复杂的字符串](https://stackoverflow.com/questions/9612795/linux-search-and-replace-a-complex-string)

但是它们（除了最后一个）都处理简单的替换。我有一大块代码出现在*许多*文件中（我希望复制/粘贴源代码会受到法律惩罚），我需要替换它。

有什么可以帮助我的吗？我想避免将块“sed”化（如上面第三个类似问题中所做的那样），因为这将花费一天的大部分时间。如果我必须临时安装一些特定的文本编辑器，那就这样吧。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:45:11.953

关于您的问题的好处是您正在处理固定字符串而不是正则表达式......这使得问题相对简单。您可以[编写一些东西](https://gist.github.com/2661995)来为您完成这项工作，而不会出现太多问题。

我链接到的解决方案不是最佳的，但它确实有效，并且它不依赖于仅匹配开头/结尾行（也就是说，它只替换逐字匹配）。基本思想是：

*   读入定义我们正在寻找的文件，
*   读入定义我们替换的文件，
*   遍历所有其他参数，查找搜索字符串并将其替换为替换文本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:39:50.767

如果开始行和结束行是唯一的，您可以删除该块并将其替换为您的代码，使用 sed 使用：

```
placeholder=somereallyuniquestringthatwillneverbematched
for i in *.php; do
    # Remove original block using first and last line matching and add placeholder
    sed -i -e "/The text of the closing line/a\
$placeholder
/The Text of the opening Line/,/The Text Of The Closing Line/d" "$i"
     # Replace placeholder with desired code
     sed -i -e "s/$placeholder/#include ('include/menu.php');/" "$i"
 done 
```

这只会发现每个文件出现一次块。与往常一样，首先进行备份。

# html - 如何停止嵌入视频与固定位置标题重叠

> ID：10557380
> 
> 赞同：3
> 
> 时间：2012-05-11T19:20:35.767
> 
> 标签：html, css-position

我在带有固定标题的页面上嵌入了几个 youtube 视频，并且它们在滚动时重叠。我对任何其他内容都没有这个问题。

我已经尝试过 zindex 并且它不适用于 position:fixed 元素。我也试过在嵌入标签中输入 wmode:transparent 但这也没有奏效

任何帮助将非常感激

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T20:26:04.607

尝试附加`&wmode=transparent`到您的 youtube 网址的末尾。看看是否有帮助。

** 编辑：

使用`?wmode=transparent`或`&wmode=transparent`（如果现有 url 已经有名称/值参数并且已经包含“？”）。如果这不能阻止问题，那么试试这个 jQuery 代码：

```
<script>
$(document).ready(function(){
   $('iframe').each(function(){
      var url = $(this).attr("src");
      if(url.indexOf("?")>0){
         $(this).attr("src",url+"&wmode=transparent")
      }else{
         $(this).attr("src",url+"?wmode=transparent")
      }
   });
});
</script> 
```

注意：jQuery 脚本是对本网站建议的脚本稍作修改的版本：[http ://www.scorchsoft.com/news/youtube-z-index-embed-iframe-fix](http://www.scorchsoft.com/news/youtube-z-index-embed-iframe-fix)

# excel - Excel 逻辑 - 查找缺失的部分

> ID：10557381
> 
> 赞同：0
> 
> 时间：2012-05-11T19:20:39.137
> 
> 标签：excel, logic, excel-formula

我需要使用 excel 来查找缺失的部分。如您所见，“零件”列是公共链接。逻辑是如果在同一个“零件”系列中创建了任何“兼容”项目，通过比较项目列来检查是否有任何缺少的兼容项目。如您所见，兼容项目以“OCP”字符串结尾，而 OEM 项目则没有。否则它们是同一回事。有任何想法吗？我需要检查 13,000 行。

[![Excel列表](../Images/9ee0393cda3089ebf4a933b18ae417a0.png)](https://i.stack.imgur.com/sXm61.png)

在上面的示例中，我们可以看到缺少许多 OEM 版本的项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T18:55:21.803

1.  in a new column, add a formula like this:

    ```
    =IF(ISNUMBER(MATCH(SUBSTITUTE($A2;"OCP";"");$A:$A;0));"ok";"missing") 
    ```

2.  autofilter this column for missing values
3.  copy filtered rows
4.  paste them after the last item
5.  while having these new rows selected, replace (Ctrl+H) Compatible with OEM
6.  sort if you need to

optionally, record these steps as a macro..

# perl - 调用对属性的编写器方法的引用时出现 Perl Moose 异常

> ID：10557384
> 
> 赞同：2
> 
> 时间：2012-05-11T19:21:13.967
> 
> 标签：perl, reference, moose, writer

我正在尝试将对属性的编写器方法的引用传递给另一个类方法。自执行 print 语句以来，显然调用了 setter 方法。但是，会导致以下错误：

```
Attribute (dir) is required, so cannot be set to undef at Test.pm line 51
Test::_validateDir('Test=HASH(0x2270be0)', 'CODE(0x22a90f8)') called at test.pm line 37
Test::BUILD('test_moose=HASH(0x2270be0)', 'HASH(0x1879728)') called at generated method (unknown origin) line 50
Test:new('Test', dir=>'my_bin') called at ./test_moose.pl line 26 
```

是否有原因无法引用生成的 writer 方法，或者在 Moose 中有不同或更好的方法来执行此操作吗？

这是代码：

```
package Test;
use Moose;
use File::Spec;

has 'dir' => (is => 'ro', isa => 'Str', required => 1, writer '_set_dir',);

sub BUILD {
    my ($self, $hr) = @_;
    $self->_validateDir(\&_set_dir);
}

sub _validate_dir {
    my ($self, $setter) = @_;
    my $dir = File::Spec->rel2abs($self->dir, '/home/me');
    if (! -e $dir) {
       print "creating directory\n";
       #create directory
    }
    &$setter($dir);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:43:37.327

将 setter 称为常规 sub 是否正确？你不应该`$self`作为第一个参数传递吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T22:36:02.033

在 Perl 中，对方法的引用*不*包括关联的对象。调用引用时，必须提供对象（或类，如果它是类方法）作为第一个参数。

```
&$setter($self, $dir); 
```

或者，（等效于何时`$setter`是代码引用但更惯用）：

```
$self->$setter($dir); 
```

你得到“属性（dir）是必需的，所以不能设置为undef”的原因是Perl认为这`$dir`是对象并且缺少值（因此`undef`），并且它显然在它注意到`$dir`不是之前进行了检查一个东西。

# jquery - 带有 FancyBox 格式的 FancyBox 的 Jquery cookie 插件

> ID：10557388
> 
> 赞同：3
> 
> 时间：2012-05-11T19:21:45.027
> 
> 标签：jquery, cookies, fancybox, format

又是我。

我可以使用 Stack Overflow 上另一个问题中的这段代码为我的 FancyBox 设置 cookie：

```
$(document).ready(function(){

var check_cookie = $.cookie('the_cookie');

if(check_cookie == null){

    $.fancybox('<h2>Some content</h2>', {
        'onComplete' : function() {
                $.cookie('the_cookie', 'the_value');
        }
    });
}
}); 
```

这可能是一个愚蠢的问题，但现在我的问题是我丢失了 FancyBox 的格式。有人可以告诉我应该把这段代码放在哪里，以便我可以有我的 cookie 和格式吗？

```
{
   'autoDimensions'    : false,
   'width'             : 450,
   'height'            : 190,
   'transitionIn'      : 'none',
   'transitionOut'     : 'none'
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:24:51.000

```
$(document).ready(function(){

var check_cookie = $.cookie('the_cookie');

if(check_cookie == null){

    $.fancybox('<h2>Some content</h2>', {
        'autoDimensions'    : false,
        'width'             : 450,
        'height'            : 190,
        'transitionIn'      : 'none',
        'transitionOut'     : 'none',
        'onComplete' : function() {
                $.cookie('the_cookie', 'the_value');
        }
    });
}
}); 
```

# java - 在递归骑士之旅中正确声明变量（Java 作业）

> ID：10557394
> 
> 赞同：5
> 
> 时间：2012-05-11T19:22:09.790
> 
> 标签：java, recursion, knights-tour

我在学年的最后一个项目（我作为 CS 学生的第一年）的代码中找不到错误。我在执行骑士巡回问题时陷入了递归。这是有问题的文件：[https ://github.com/sheagunther/tsp161knightstour/blob/master/KnightsTourRecursiveSearch.java](https://github.com/sheagunther/tsp161knightstour/blob/master/KnightsTourRecursiveSearch.java)

具体来说，我的问题在于这部分代码（从第 265 行开始）：

```
 else{
   for(int i = 0; i < numberOfPossibleNextMoves; i++){
      Cell nextCellToMoveTo = candidateNextMoves.get(i);

      int currentRowStorage = currentRow;
      int currentColumnStorage = currentColumn;
      currentRow = nextCellToMoveTo.row;
      currentColumn = nextCellToMoveTo.column;

      listOfMoves.add(nextCellToMoveTo);
      chessBoard[currentRow][currentColumn] = 1;
      currentMoveNumber++;

      boolean tourFound = findTour();

      if(tourFound){
         return true;
            }
            else{ // Undo the last move just made
               backtrackCount++;
               chessBoard[currentRow][currentColumn] = -1;
               currentRow = currentRowStorage;
               currentColumn = currentColumnStorage;                           
               listOfMoves.remove(nextCellToMoveTo);
               currentMoveNumber--;         
            }
         }
         return false; 
```

这是 findTour() 的结束。这是程序的一部分，它测试从当前方格（也称为单元格）的所有可能的移动，如果可以从新移动到的方格完成游览，则返回 true。如果不能从广场完成游览，它会进入 else{ 并撤消移动。这就是我认为的问题所在。

现在，按照上面的代码设置，程序陷入了无限递归循环。

请注意声明的这一部分`else{`：

```
chessBoard[currentRow][currentColumn] = -1;
currentRow = currentRowStorage;
currentColumn = currentColumnStorage; 
```

这部分代码将 chessBoard 中的方块更改为 -1，这意味着它未被访问（1 = 已访问）。如上所示，新移动的 currentRow 和 currentColumn 用于将方格设置回未访问状态。然后使用 currentRowStorage 和 currentColumnStorage 将这些值重置为先前的跳转值。

如果我将代码更改为

```
currentRow = currentRowStorage;
currentColumn = currentColumnStorage;
chessBoard[currentRow][currentColumn] = -1; 
```

它成功地找到了一个错误的路线，其中最后 1/3 左右的移动只是在几个方格之间来回跳跃。这是意料之中的，因为它没有正确处理重置过程。

我怀疑我的问题是由于我声明变量的位置。这是我的第一个复杂的递归问题，我不确定我是否正确处理了 currentRow/Column 和 currentRow/ColumnStorage 之间的切换。我应该在本地或多或少地声明它们吗？

这是描述该项目的页面： http: [//cs.usm.maine.edu/~briggs/webPage/c161/projects/KnightsTour.html](http://cs.usm.maine.edu/~briggs/webPage/c161/projects/KnightsTour.html)

以下是要求的相关部分：

> 如果游览未完成，则 findTour 确定可以从骑士的当前单元格到达的空单元格列表（可能为空），并将此列表存储在本地声明的列表变量中，candidateNextMoves。将此列表变量声明为方法的本地变量是至关重要的。如果此列表为空，则无法扩展当前部分游览，因此 findTour 应返回 false。如果列表不为空，则 findTour 尝试通过列表上的每个移动来扩展游览，如下所示。它遍历列表，并且对于列表中的每个单元格，它会下一次移动到该单元格，更新所有 L（巡回赛中的移动列表），B（棋盘状态的二维数组（已访问，未访问))、currRow 和 currCol 以反映这一举动。然后它递归地调用自己，将调用结果分配给本地声明的布尔变量，您可以将其命名为“成功”。如果 success 为 true，findTour 返回 true。如果成功为假，findTour 撤消它刚刚进行的移动，或“回溯”，并尝试 CandidateNextMoves 的下一步移动。您将维护一个静态 int 变量 backtrackCount，该变量初始化为 0，并随着移动的每次撤消而递增。

一个注释-我将我的布尔值称为“tourFound”而不是“成功”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T20:06:08.070

与无限递归的情况一样，首先要检查的是您计划如何摆脱它的条件。在这种情况下，您只能在以下情况下逃脱

```
if(currentMoveNumber == numberOfMovesOnBoard){
     return true;
  } 
```

检查您的算法和初始化是否会阻止 currentMoveNumber 达到 numberOfMovesOnBoard。

提示：在你输入递归方法之前，你的起始条件是什么？

# objective-c - 0 < 0 评估为真？

> ID：10557396
> 
> 赞同：3
> 
> 时间：2012-05-11T19:22:22.247
> 
> 标签：objective-c, ios, c

这太疯狂了。我在什么疯狂的维度？！

请帮助我理解这一点： ![疯狂！](../Images/19f17d47a7d2c3d629dcfe46c83c9864.png)

在我原来的问题中，两者都是浮点数，但这仍然通过！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T12:54:00.127

在此执行中是否启用了编译器代码优化？如果是这样，编译器可能会扁平化循环或采取一些技巧来加速代码，这可能会导致编辑器中的源代码不再对应于正在执行的实际二进制文件。在这些情况下，您可能会看到在函数中“倒退”和其他奇怪的事情。尝试`NSLog`在那个分支上放一个，如果它被击中，我会感到非常惊讶。

另一种选择是其他人已经提到的，即源和二进制文件不同步，通常可以通过大规模的干净重建来解决。

# javascript - JSON多维数组不显示（'数组未定义'）

> ID：10557404
> 
> 赞同：0
> 
> 时间：2012-05-11T19:22:56.107
> 
> 标签：javascript, ajax, json

我对返回的 JSON 数组进行了一些编辑，现在它破坏了代码。本质上，我所做的只是把它变成一个多维数组（2？）

JS

```
$(function() { ...
     ...$.ajax({
            type: "POST",
            url: 'updatefilters',
            dataType: 'json', 
            data: { filters: filters, page: page },
            success: function(data){
                html = "<table class='board'>";
                html += "<table class='board'>";
                html += "   <tr>";
                html += "           <th width='7.5%'>Author</th>";
                html += "           <th width='5%'><img src='../img/board/icons/category_icon.png' alt='category_icon'/></th>";
                html += "           <th width='5%'>Tag</th>";
                html += "           <th width='50%'>Subject</th>";
                html += "           <th width='7.5%'>Replies/Views</th>";
                html += "           <th width='15%'>Last Post</th>";
                html += "  </tr>";
                for (i=0 ; i < data[threads].length ; i++)
                {
                    html += "<tr><td>" + data[threads][i].username + "";
                }
                html += "</table></div>";
                $('#board').html(html); 
            } ... 
```

返回的 JSON 数据：

```
{"0":"blurb","filter":["blurb"],"threads":[{"thread_id":"234","owner_id":"3","subject":"Blurb(?) is in Heavy Development!","body":"Please be aware that this site is still in heavy development. What you are viewing here is a prototype, not meant to be seen as a final product. if you have comments or suggestions, please send it to rickymm3@gmail.com\n\nThank You!","timestamp":"2012-05-11 08:02:28","replystamp":"2012-05-11 08:02:28","last_post_id":"3","slug":"234-blurb-is-in-heavy-development","replies_num":"0","views":"1","username":"guest"}]} 
```

在 JS 代码的 FOR 循环中，data[threads] 是未定义的？是否有原因 data[threads][i] 不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:24:58.667

您没有任何名为`threads`.

你的意思是`data.threads`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T19:27:27.497

`data.threads`是一个只有一个单元格的数组（其中包含一个对象）

不要使用`data[threads]`：您可以使用引号`data.threads`或`data["threads"]`引号

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T19:25:26.950

采用

```
data.threads 
```

或者

```
data["threads"] 
```

# php - 使用 AJAX 和 PHP（在 Apache 上）实现 Comet 会断开连接

> ID：10557408
> 
> 赞同：1
> 
> 时间：2012-05-11T19:23:01.607
> 
> 标签：php, javascript, ajax, apache, comet

我正在使用长轮询 AJAX 和 Apache/PHP 实现 Comet。问题是，如果在（我不知道的）一段时间内没有交互，即没有发送/接收数据，然后过了一段时间，我发送了一个事件，客户端长轮询请求保持挂起，没有接收新数据。有时客户端收到超时并重新连接，但有时它什么也没收到，正如我已经说过的，请求一直处于未决状态。我正在按照[此处的指示实施它](http://www.zeitoun.net/articles/comet_and_php/start)与彗星实现本身无关的一些更改（即：使用数据库而不是文件）。它在服务器端使用循环等待新事件，并且似乎服务器超时关闭连接但客户端没有收到连接关闭以重新连接。我怎样才能避免这个问题？该解决方案是否会使用客户端计时器进行重新连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:35:33.527

您永远不需要等待超过 50 秒来发送响应，否则浏览器可能会超时。基本上，如果 50 秒后没有新的报告，无论如何都要发送响应。这个空响应将触发客户端向服务器发送新请求并重新开始。

# visual-studio-2008 - Visual Studio 2008 SP1 可再发行包是否在任何 Windows 更新/服务包中可用？

> ID：10557414
> 
> 赞同：0
> 
> 时间：2012-05-11T19:23:33.900
> 
> 标签：visual-studio-2008, redistributable, windows-update

如果我在 Visual Studio 2008 SP1 中开发我的软件，我相信我的客户需要 Visual Studio 2008 SP1 可再发行组件来运行它。我的问题是，他们是否有一种自然的方式可以通过 Windows 更新或 Windows SP1/2/3 获取可再发行组件，而无需自行安装可再发行组件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:29:53.190

您的客户实际上不需要任何可再发行组件 - 只需安装 CLR (.NET Framework)

# matlab - 如何在没有第一行的情况下绘图

> ID：10557421
> 
> 赞同：-1
> 
> 时间：2012-05-11T19:24:07.420
> 
> 标签：matlab

我想绘制没有第一行的第三列？

```
0   0   0    0
2   1   4    6
3   1   2    5 
4   1   88  55 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:30:50.403

尝试这个：

```
a = [0 0 0 0; 2 1 4 6; 3 1 2 5; 4 1 88 55];

a(2:end, 3) 
```

# java - Jetty 提供静态内容所需的最少文件集？

> ID：10557427
> 
> 赞同：2
> 
> 时间：2012-05-11T19:24:53.723
> 
> 标签：java, windows, ant, jetty, embedded-jetty

# 背景

**免责声明：**我对Java 的经验很少*。*

我们之前在 Ant 构建期间使用 Jetty 6 的打包版本来按需静态内容（JS、CSS、图像、HTML），因此我们可以使用 PhantomJS 针对 HTTP 托管环境运行单元测试。

但是，Jetty 现在是 8.1.3 版本，我们不再需要这种包装（它解决了一个现在没有实际意义的不同问题），所以我想更新为直接使用 Jetty 8.1.3。

首先，我下载了整个 Jetty 发行版，它的大小约为 40 MB。这适用于 Ant，使用“start.jar”......但我真的不想到处推送那些不必要的 JAR。

因此，我从 Maven 存储库下载了聚合的“jetty-server-8.1.3.v20120416.jar”（最新），但我似乎无法像使用“start.jar”那样使用 Ant 的那个 JAR，例如“java -jar jetty-server-8.1.3.v20120416.jar 选项=服务器”

Jetty 文档既糟糕又缺失（404）。啊!

# 实际问题

因此，如果我回到使用带有“start.jar”而不是聚合“jetty-server”**的 Jetty 的完整发行版，那么我需要的完整 Jetty 发行版中的最小文件集（JAR 和配置）是多少通过 HTTP 的服务器基本静态内容？**

...

**相关问题：** [如何从 Ant 启动聚合的 jetty-server JAR？](https://stackoverflow.com/questions/10555868/how-to-start-an-aggregate-jetty-server-jar-from-ant)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:28:09.567

[http://wiki.eclipse.org/Jetty/Howto/Use_Jetty_with_Ant](http://wiki.eclipse.org/Jetty/Howto/Use_Jetty_with_Ant)

如果您不需要 jetty-jmx 或 jetty-jndi 之类的东西，那么只需修剪它们

# intellisense - FDT：5.5 中的 Haxe 项目是否具有对 AS3 和其他目标的完整代码完整智能感知支持？

> ID：10557430
> 
> 赞同：2
> 
> 时间：2012-05-11T19:25:17.750
> 
> 标签：intellisense, haxe, fdt

我可以说这个版本的 haxe 好多了，但是我注意到在尝试在 AS3 类上获取代码提示或智能感知时，我没有显示任何公共方法或变量？

这还不支持还是我必须做些什么来配置它？

这是我尝试使用绘图 api 却没有得到任何有用的示例![在此处输入图像描述](../Images/90725fbae8b2aec41067f77e650d86e8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:30:58.800

FDT 的 Haxe 自动补全完全依赖于 Haxe 编译器（如果您正在使用它，则为自动补全服务器）。如果编译器没有“看到”您的文件，则不会有自动完成功能。

有很多事情正在发生；但是，这里有一些：

## 可能缺少基本类型。

您需要清理或让编译器进行完整构建以再次创建这些文件。

![在此处输入图像描述](../Images/754d8b436b95c7b8488966e4f83c996e.png)

## 您正在编辑的类没有被编译。

因为自动补全是基于编译器的，如果文件没有连接到编译器，你什么也得不到。为此，您需要确保您的项目是从您的 .HXML 文件构建的，并且您正在编辑的文件以某种方式连接（例如，在您的应用程序中的某个点导入或实例化）到您的“主要”班级。

马特，第二个问题可能是发生在你身上的事情。确保它是从您的 HXML 文件正确构建的，并且已连接到您的“主”类。否则，将文件从旧项目转移到在 FDT 中创建的文件，是修复它的可靠方法。

# android - Android从非活动类获取图像大小

> ID：10557433
> 
> 赞同：0
> 
> 时间：2012-05-11T19:25:39.727
> 
> 标签：android, screen

我需要获取屏幕尺寸才能使我的应用程序正常工作。为此，我在主要活动中创建了 2 个函数，并通过非活动类中的对象调用它们。

由于某种原因，它一直在崩溃。为什么我不能调用这些函数？我如何解决它？

主要活动代码：

```
 public int getWidth(){
    Display display = ((WindowManager) getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay(); 
    int width = display.getWidth(); 
    return width;
}

public int getHeight(){
    Display display = ((WindowManager) getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay(); 
    int height = display.getHeight(); 
    return height;
} 
```

非活动代码（调用部分）：

```
 main Main = new main();
private int height = Main.getHeight();
private int width = Main.getWidth(); 
```

请注意，我知道这些方法已被弃用，但我不能使用 getSize(point); 方法，因为我正在为最低 API 级别 7 开发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T23:35:06.100

您可以创建一个`Constants`包含您在 like 中初始化的静态字段`onCreate`的`Activity`类：

```
public class Constants
{
    public static int DEVICE_WIDTH;
    public static int DEVICE_HEIGHT;
} 
```

活动

```
onCreate(...)
{
    ...
    Constants.DEVICE_WIDTH  = this.getWidth();
    Constants.DEVICE_HEIGHT = this.getHeight();
} 
```

当您需要这些值时，请使用以下命令调用它：

```
int deviceWidth = Constants.DEVICE_WIDTH; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:53:31.047

你不能只`Activity`用它的构造函数创建一个并期望它被正确初始化。这不是它的工作原理。如果您只是使用构造函数调用，它将没有获取系统服务所需的上下文。您需要从活动的真实实例中获取此信息，然后将其传递给需要此数据的对象。如果没有更多信息/代码，提供更多细节是不切实际的。

# php - 在 Symfony2 中从 Twig 模板接收参数

> ID：10557436
> 
> 赞同：0
> 
> 时间：2012-05-11T19:26:02.560
> 
> 标签：php, templates, symfony, arguments, twig

我正在开发一个使用 Symfony2 和 Twig 模板的应用程序。我想知道的是如何从控制器中呈现的 Twig 模板接收控制器中的参数。该参数将具有 HTML 标记属性的值。此值将分配给 HTML 标记上的 onClick 事件中提到的参数。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:55:20.410

你可以这样做：

```
{% render 'YourBundle:YourController:yourAction' with { 'yourVariableName': variableValue } %} 
```

其中 yourVariableName 与 yourAction 期望的变量相同。

# c - c位操作在单个与多个位上

> ID：10557438
> 
> 赞同：1
> 
> 时间：2012-05-11T19:26:08.620
> 
> 标签：c, macros, bit-manipulation

我试图在一个字符中表示一堆值：前 6 位中有 6 个开/关标志，并使用最后 2 位来保存 4 个不同的值。这似乎很基本，以至于像这样的宏必须存在于某个地方，但我找不到它们。

```
 #define HOT 0x00
 #define BIG 0x01
 #define FAT 0x02
 #define HIT 0x03
 #define BAT 0x04
 #define ZAX 0x05    
 #define HOW 0x06

 #define TWO_BITS     nnn    // ???
 #define CONDITION_0  nnn   // bit combo: 00
 #define CONDITION_1  nnn   // bit combo: 01
 #define CONDITION_2  nnn   // bit combo: 10
 #define CONDITION_3  nnn   // bit combo: 11

void bitter(void)
{
    unsigned char myBits = 0;
    bool nonsense;

    if (myBits & BIG)  nonsense = true;    // BIG flag on   
    if (!(myBits & BAT)) nonsense = false; // BAT flag off

    myBits = myBits | BIG;     // turn on BIG bit
    myBits = myBits & ~BIG;    // turn off BIG bit

    if (TWO_BITS == CONDITION_0)
        doThis();
    else if (TWO_BITS == CONDITION_1_)
        doThat();
    // ... etc

} 
```

那么，用最后 2 位编码我想做什么的最佳方法是什么？我无法进行任何性能测试，因为我还没有弄清楚如何编写代码，但我假设这是进行此类操作的最快方法。

[顺便说一句，这可能闻起来像家庭作业，但我只是一只 54 岁的狗，正在努力学习一些新技巧。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:37:45.647

我不确定我理解你想要什么，但听起来你想检查是否设置了两个位。在这种情况下，例如，如果你想检查最后两位是否都设置了，你会这样做：

```
((myBits & 3) == 3) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:42:34.103

您只需对最后 2 位 (0x03) 应用位掩码并打开结果：

```
switch (myBits & 0x03) {
    case 0: // CONDITION_0
        doThis();
        break;
    case 1: // CONDITION_1
        doThat();
        break;
    case 2: // CONDITION_2
    case 3: // CONDITION_3
} 
```

此外，如果您希望它们作为宏来重用它们：

```
#define CONDITION_0(X) (((X) & 0x03) == 0)
#define CONDITION_1(X) (((X) & 0x03) == 1)
#define CONDITION_2(X) (((X) & 0x03) == 2)
#define CONDITION_3(X) (((X) & 0x03) == 3) 
```

然后你只需要写一些类似的东西：

```
if (CONDITION_0(myBits)) {
    doThis();
} else if (CONDITION_1(myBits)) {
    doThat();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T19:49:36.370

这有点取决于您是否需要自己处理这 2 位，作为 0 到 3 之间的（十进制）值，或者是否始终将它们视为字节的高 2 位。

这是一种方法，我们只是屏蔽掉所有其他位，并将条件定义为这 2 位将作为一个字节中的高 2 位的值。

```
 #define TWO_BITS(x) ((x) & 0xC0)

 #define CONDITION_0  0
 #define CONDITION_1  0x40   // bit combo: 01
 #define CONDITION_2  0x80   // bit combo: 10
 #define CONDITION_3  0xC0   // bit combo: 11 
```

也就是说，一个字节的高 2 位是二进制的 1 1 0 0 0 0 0 0 ，即十六进制的 0xC0 。高 2 位为 0 1 ，即一个字节中的所有位为 0 1 0 0 0 0 0 0 ，即十六进制的 0x40 。

你的测试必须是

```
if (TWO_BITS(myBits) == CONDITION_0) 
```

另一种方法是将那些高 2 位提取为 2 位整数（即 0 到 3 之间的值）。这很简单，只需将位向右移动 6 位。

```
 #define TWO_BITS(x) ((x) >> 6)

 #define CONDITION_0  0x0
 #define CONDITION_1  0x01   // bit combo: 01
 #define CONDITION_2  0x02   // bit combo: 10
 #define CONDITION_3  0x03   // bit combo: 11 
```

测试条件之一时，用法相同。

```
 if (TWO_BITS(myBits) == CONDITION_0) 
```

最后一点，您的低 6 位标志似乎有点错误，请考虑例如

```
#define HOW 0x06 
```

0x06 是二进制值 0 0 0 0 0 1 1 0 ，因此实际上是打开或测试 2 位。您可能希望将 1 位与 1 个标志相关联，这将是这个序列

```
 #define BIG 0x01
 #define FAT 0x02
 #define HIT 0x04
 #define BAT 0x08
 #define ZAX 0x10
 #define HOW 0x20 
```

这通常写为位移位，因此很容易读取它是哪个位：

```
 #define BIG (1 << 0)  //bit zero
 #define FAT (1 << 1)  //bit 1
 #define HIT (1 << 2)  //bit 2
 #define BAT (1 << 3)  //bit 3 , etc.
 #define ZAX (1 << 4)
 #define HOW (1 << 5) 
```

# java - 如何将 JField 设置为双精度值，而不是默认的字符串类型

> ID：10557439
> 
> 赞同：0
> 
> 时间：2012-05-11T19:26:14.320
> 
> 标签：java, eclipse, user-interface

我正在尝试将 Jtextfield 的类型更改为双精度值，如下所示：

```
rangespaceField3.setText(bmi.getBMI()); 
```

getBMI 方法返回一个双精度值，但出现以下错误：

> JTextComponent 不适用于参数（双精度）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:27:50.650

试试这个：

```
rangespaceField3.setText(String.valueOf(bmi.getBMI())); 
```

[`String.valueOf`](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html)将返回原始数据类型的字符串表示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:27:55.537

尝试`rangespaceField3.setText(Double.toString(bmi.getBMI()));`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T19:36:12.267

我已经实现了基于 JFormattedTextField 的数字字段。

JRealNumberField 和 JLocalizedRealNumberField 是 BigDecimal 的文本字段。

它们还支持最小值和最大值。

也许您发现它们很有用（该库是开源的）：

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JRealNumberField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JRealNumberField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JDoubleField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JDoubleField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JFloatField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JFloatField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedRealNumberField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedRealNumberField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedDoubleField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedDoubleField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedFloatField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLocalizedFloatField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JWholeNumberField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JWholeNumberField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JByteField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JByteField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JIntegerField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JIntegerField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLongField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JLongField.html)

[http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JShortField.html](http://softsmithy.sourceforge.net/lib/docs/api/org/softsmithy/lib/swing/JShortField.html)

教程：

[http://softsmithy.sourceforge.net/lib/docs/tutorial/swing/number/index.html](http://softsmithy.sourceforge.net/lib/docs/tutorial/swing/number/index.html)

主页：

[http://www.softsmithy.org](http://www.softsmithy.org)

下载：

[http://sourceforge.net/projects/softsmithy/files/softsmithy/](http://sourceforge.net/projects/softsmithy/files/softsmithy/)

马文：

```
<dependency>  
    <groupid>org.softsmithy.lib</groupid>  
    <artifactid>lib-core</artifactid>  
    <version>0.1</version>  
</dependency> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T19:30:12.677

如果您只想将双精度的字符串表示形式放入文本字​​段，那么您可以使用 String 类中的 valueOf() 方法。

```
rangespaceField3.setText(String.valueOf(bmi.getBMI())); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T19:44:21.387

试试这个....

// 将双精度值与空字符串连接，这会将双精度转换为字符串

rangespaceField3.setText(bmi.getBMI()+"");

```
 OR 
```

//在方法返回的double值上调用toString()，它也将被转换为String

rangespaceField3.setText(bmi.getBMI().toString());

# php - 这是一种安全的方法吗，哎呀

> ID：10557440
> 
> 赞同：3
> 
> 时间：2012-05-11T19:26:22.200
> 
> 标签：php

```
 $salt = $this->get_salt($username);

    if (is_null($salt)) {
        return FALSE;
    }

    $password = sha1(SITE_KEY . $password . $salt);
    $sth = $this->db->prepare("SELECT id, username, active FROM user WHERE username = ? AND password = ?");
    $sth->setFetchMode(PDO::FETCH_OBJ);
    $sth->execute(array($username, $password));

    if (($result = $sth->fetch()) !== FALSE) {
        return $result;
    }

    return FALSE; 
```

这就是让我担心的原因：

> 我没有误解登录方法。我只是不认为它应该返回那个对象。我可能错了，你所做的一切都很好，但我对此表示怀疑。您正在将数据库中的完整用户对象、密码和所有内容返回到可能不安全的脚本。有人可能会创建一个新文件，然后执行类似 var_dump($userObject); 之类的操作。并拥有所有这些信息
> 
> 此外，我只是发现从某物返回“神奇”属性是不直观的。这只是在使用前未经验证的另一件事。如果您要将其移至 auth 类中的单独方法并让它返回“active”的值，您可以运行您需要的任何验证，而无需使 login.php 脚本更明智。
> 
> : 再看一遍，如果你以这种方式滥用该对象，你已经需要知道登录信息。在我看来，最好还是把它分开，以防出现某种泄漏。不是说我知道有人能做到这一点。只需将其视为一个潜在的漏洞。
> 
> 我不会假装理解恶意用户会如何做某事。我只知道让他们更容易这样做似乎并不明智。也许它没有任何问题，我不是安全专家。我只是在戳一些东西，如果我要写它，我会改变，因为它们对我来说似乎很危险。如果您真的想知道它是否危险，我建议将该示例提交给常规的 stackoverflow 社区，看看他们怎么说。

他说的有道理吗？该方法将在我拥有的页面控制器中使用：

```
$user = $auth->login('username, password)

if ($user) {
//do some additional checks... set session variables
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T19:57:10.403

不，您提供的代码不安全。

首先，您使用的是非迭代的简单哈希。有关原因的信息，请参阅[此答案](https://stackoverflow.com/questions/4948322/fundamental-difference-between-hashing-and-encryption-algorithms/4948393#4948393)和[此博客文章](http://blog.ircmaxell.com/2011/08/rainbow-table-is-dead.html)。

其次，为什么要分开存放盐？盐**必须**对每条记录都是唯一的，才能正常工作。所以把它放在密码旁边是合乎逻辑的。在这种情况下，您将进行两个查询而不是一个（假设盐不是从用户名派生的，并且确实是随机的）。如果它不是随机的，它应该是。有关更多信息，请参阅[此帖子](http://blog.ircmaxell.com/2012/04/properly-salting-passwords-case-against.html)...

第三，由于数据库没有使用时间免疫比较，您将面临针对密码哈希的定时攻击。有关更多信息，请参阅[本文](http://rdist.root.org/2010/07/19/exploiting-remote-timing-attacks/)和[本文](http://rdist.root.org/2010/01/07/timing-independent-array-comparison/)。

不要自己做这件事。*确实*很难安全地做到这一点。使用图书馆。你可以使用[PHPASS](http://www.openwall.com/phpass/)或[PHP-PasswordLib](http://blog.ircmaxell.com/2012/04/introducing-passwordlib.html) ...

## 编辑：致您朋友的评论：

> 我没有误解登录方法。我只是不认为它应该返回那个对象。我可能错了，你所做的一切都很好，但我对此表示怀疑。您正在将数据库中的完整用户对象、密码和所有内容返回到可能不安全的脚本。有人可能会创建一个新文件，然后执行类似 var_dump($userObject); 之类的操作。并拥有所有这些信息

这是一个有效的观点。但是到那时，如果用户可以注入`var_dump($userObject)`，他就可以运行`$this->db->prepare("SELECT * FROM user");`并获取您的**所有**用户数据，而不仅仅是他的。因此，尽管需要指出一些事情，但尝试确保安全是不值得的。除非您真的很肛门并将其全部放入数据库中的存储过程中并限制从表中的读取访问（因此您根本无法从用户表中进行选择）。但到那时，您需要从头开始重新设计整个应用程序，因为除了通过 SP 之外，您永远无法获得任何用户信息。这将很难做好（复杂性是安全的敌人）。

最后，我认为首先防御脚本注入会更好**。**尤其是如果您没有专业的管理员可以将您的服务器保护到防止这种攻击所需的可笑数量（PHP 进程上的 chroot 监狱等）。

> 此外，我只是发现从某物返回“神奇”属性是不直观的。这只是在使用前未经验证的另一件事。如果您要将其移至 auth 类中的单独方法并让它返回“active”的值，您可以运行您需要的任何验证，而无需使 login.php 脚本更明智。

有什么神奇的属性？您是否直接使用这些项目？或者您是否使用它们来填充用户对象（然后知道如何处理数据）......？仅凭该片段，我就看不到您朋友指出的问题...

> : 再看一遍，如果你以这种方式滥用该对象，你已经需要知道登录信息。在我看来，最好还是把它分开，以防出现某种泄漏。不是说我知道有人能做到这一点。只需将其视为一个潜在的漏洞。

实际上，由于上​​面确定的定时攻击，您只需要知道一个有效的用户名......

> 我不会假装理解恶意用户会如何做某事。我只知道让他们更容易这样做似乎并不明智。也许它没有任何问题，我不是安全专家。我只是在戳一些东西，如果我要写它，我会改变，因为它们对我来说似乎很危险。如果您真的想知道它是否危险，我建议将该示例提交给常规的 stackoverflow 社区，看看他们怎么说。

总的来说，这是一个很好的建议。请记住，复杂性是安全的敌人。因此，如果增加难度会增加很多复杂性，那么添加新漏洞的机会就会显着增加（例如引入的定时攻击）。我犯了简单的错误。我有经过良好测试的库来处理复杂部分（如密码散列），但我编写的代码很简单。

考虑最强的加密算法：[One Time Pad](http://en.wikipedia.org/wiki/One-time_pad)。该算法非常简单：

```
encrypted = plaintext XOR key 
```

但是没有密钥是不可能解密的。所以算法的安全性实际上在于秘密，而不在于算法。这就是你想要的。算法应该是公开的，安全性不应该依赖于它的保密性。否则，它会因默默无闻而变得安全。在你崩溃之前，这会给你一种温暖的模糊感......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:35:59.743

有关如何使用**bcrypt**散列密码的信息，请参阅**[此答案。](https://stackoverflow.com/a/6337021/871050)**它比您的更安全，因为它允许故意减慢哈希算法（因此，如果有人试图暴力破解，他们将被限制为每秒 1M 次左右的迭代，而不是 1B，这是几小时和几年之间的差异）。

 **此外，（与安全无关），您应该使用 PDO 的命名占位符，而不是未命名的占位符（`:placeholder`而不是 not `?`）。

此外，您可能想要构建一个完整的`User`对象并将其返回，它会更容易使用（假设您有一个，您应该这样做！）。**

# regex - 正则表达式允许至少一个特殊字符，一个大写，一个小写（以任何顺序）

> ID：10557441
> 
> 赞同：16
> 
> 时间：2012-05-11T19:26:26.530
> 
> 标签：regex

任何人都可以帮助我使用正则表达式以允许至少一个特殊字符、一个大写字母、一个小写字母。

这是我到目前为止所拥有的：

```
 ^.*(?=.{8,})(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=]).*$ 
```

但它似乎只按照“特殊字符”、“大写”、“小写”的顺序匹配字符。

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-11T19:36:50.623

你的正则表达式

```
^.*(?=.{8,})(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=]).*$ 
```

实际上应该可以正常工作，但是您可以通过删除第一个使其变得更好`.*`：

```
^(?=.{8,})(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=]).*$ 
```

将匹配任何至少包含 8 个字符的字符串，该字符串包含至少一个小写字母和一个大写 ASCII 字符以及至少一个字符集中的字符`@#$%^&+=`（以任何顺序）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-06-03T18:10:53.453

这是您可以使用的功能。

```
function checkRegex(string) {
    var checkSpecial = /[*@!#%&()^~{}]+/.test(string),
        checkUpper = /[A-Z]+/.test(string),
        checkLower = /[a-z]+/.test(string),
        r = false;

        if (checkUpper && checkLower && checkSpecial) {
            r = true;
        }

        return r;

        } 
```

然后检查它是真还是假。

```
var thisVal = document.getElementById('password').value;
var regex = checkRegex(thisVal); 
```

如果`var regex`是`true`则条件满足。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-11T19:36:31.497

可以通过3个正则表达式快速完成。

```
function check($string){
   return    preg_match("/[`!%$&^*()]+/", $string) 
          && preg_match("/[a-z]+/", $string) 
          && preg_match("/[A-Z]+/", $string) ;
} 
```

不要忘记调整特殊字符列表。因为我不知道你觉得什么角色特别。

我相信在您不是专家的情况下在单行正则表达式上浪费大量时间不会提高您的生产力。这 3 个正则表达式解决方案就可以了。它可以节省时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-04-04T17:47:26.827

如果您想要如下图所示的输出：

[![密码验证器](../Images/5b519652ffa683fe607754a37082556d.png)](https://i.stack.imgur.com/WxMnP.png)

您可以使用下面的动态自定义组件：

```
import { Component, Input, OnInit, EventEmitter, Output, OnChanges } from '@angular/core';
import { RegExpValidator } from '../../classes/reg-exp-validator';

@Component({
  selector: 'app-reg-exp-validator',
  template: `
       <div *ngFor="let regExp of regExps" style='text-align: left'>
          <div>
            <i *ngIf="!regExp.isOptional" [ngStyle]="{'color': isValidExp(regExp) ? 'green' : 'red'}"
               [className]="isValidExp(regExp)? 'pi pi-check-circle' : 'pi pi-times-circle'">
              </i>
            <i *ngIf="regExp.isOptional" [ngStyle]="{'color': isValidExp(regExp) ? 'green' : 'orange'}"
               [className]="isValidExp(regExp)? 'pi pi-check-circle' : 'pi pi-times-circle'">
              </i>
            {{regExp.message}}
          </div>
       </div> `
})
export class RegExpValidatorComponent implements OnInit, OnChanges {

  @Input() value: string;
  @Input() regExps: Array<RegExpValidator>;

  @Output() onChange: EventEmitter<boolean> = new EventEmitter();

  constructor() { }

  ngOnChanges(): void {
    this.validateExpressions();
  }

  ngOnInit() {   
  }

  isValidExp(regExp) {
    if (regExp.isValid)
      return regExp.isValid;
  }

  initiValue() {
    this.value = this.value == undefined ? "" : this.value;
  }

  validateExpressions() {
    this.initiValue();
    let isInVlaidExpression = false;
    this.regExps.forEach((regExp) => {
      regExp.isValid = this.testRegExpression(regExp.regExpression);
      if (!regExp.isValid && !regExp.isOptional) {
        isInVlaidExpression = true;
      }
    });

    this.onChange.emit(isInVlaidExpression);
  }

  testRegExpression(regExpression: RegExp) {
    return regExpression.test(this.value);
  }
} 
```

在哪里

> 正则表达式

输入数组类是

```
export class RegExpValidator {
 regExpression: RegExp;
 message: string;
 ordinal: number;
 isValid: boolean = false;
 isOptional: boolean; } 
```

*   定义后，您可以按照以下两个步骤在目标组件中使用它：

    1-定义第一个输入参数，它是正则表达式本身的数组，验证消息以及它是否是可选的，如下所示：

    ```
    DefineRegExpressions(){
    let minPasswordLengthSixCharacters = new RegExpValidator();
    minPasswordLengthSixCharacters.message = " The password should be at least 6 charcters";
    minPasswordLengthSixCharacters.regExpression = /^.{6,}$/;
    minPasswordLengthSixCharacters.isOptional = false;

    let containsDigit = new RegExpValidator();
    containsDigit.message = "The password should contains at least 1 digit";
    containsDigit.regExpression = /\d/;
    containsDigit.isOptional = false;

    let containsLowerCharacter = new RegExpValidator();
    containsLowerCharacter.message = "The password should contains at least 1 lower charcter";
    containsLowerCharacter.regExpression = /.*[a-z].*/;
    containsLowerCharacter.isOptional = false;

    let containsUpperCharacter = new RegExpValidator();
    containsUpperCharacter.message = "The password should contains at least 1 upper charcter";
    containsUpperCharacter.regExpression = /.*[A-Z].*/;
    containsUpperCharacter.isOptional = false;

    let containsSymbol  = new RegExpValidator();
    containsSymbol.message = "The password contains at least 1 symbol @!#%&()^~{}";
    containsSymbol.regExpression = /[*@!#%&()^~{}]+/;
    containsSymbol.isOptional = true; } 
    ```

然后定义第一个输入并将上面所有定义的表达式声明添加到它：

```
 regExps = Array<RegExpValidator>();
    this.regExps.push(minPasswordLengthSixCharacters);
    this.regExps.push(containsDigit);
    this.regExps.push(containsLowerCharacter);
    this.regExps.push(containsUpperCharacter);
    this.regExps.push(optional); 
```

2- 最后将以下代码添加到您的目标组件 HTML 中：

```
 <app-reg-exp-validator [value]="password"
                                   [regExps]="regExps"
                                   (onChange)="onChangeRegExpValidator($event)">
            </app-reg-exp-validator> 
```

在我们的例子中，值输入是指要验证的目标输入，它是密码，onChange 是自定义组件的输出，您可以使用它来了解所有验证是否有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-04T14:46:06.607

更通用的密码/文本验证，您可以在其中选择每个类别中允许的字符数。

```
var regularExpression = new RegExp("^^(?=.*[A-Z]{"+minUpperCase+",})" +
    "(?=.*[a-z]{"+minLowerCase+",})(?=.*[0-9]{"+minNumerics+",})" +
    "(?=.*[!@#$\-_?.:{]{"+minSpecialChars+",})" +
    "[a-zA-Z0-9!@#$\-_?.:{]{"+minLength+","+maxLength+"}$");
if (pswd.match(regularExpression)) {
    //Success
} 
```

# wpf - 如何从 Windows 服务管理 WPF 应用程序的生命周期

> ID：10557450
> 
> 赞同：0
> 
> 时间：2012-05-11T19:27:21.700
> 
> 标签：wpf, windows-services

我正在编写软件创意的原型，此时我需要确保 WPF 应用程序在崩溃后重新启动（以防它崩溃）。

我想有一个 Windows 服务来检查所有正在运行的进程，如果它找不到 WPF 应用程序（意味着它已经崩溃），它将启动它。Windows 服务还将托管 WCF 服务，该服务将由 WPF 使用。

那么是否有可能找出机器上当前正在运行的进程并从 Windows 服务启动 WPF 应用程序？

让前端一直保持活跃是有**充分理由的。**

# java - 映射遗留模型 - 只有具有唯一约束的表才能用作域类？

> ID：10557451
> 
> 赞同：0
> 
> 时间：2012-05-11T19:27:26.107
> 
> 标签：java, oracle, grails, grails-orm

我正在尝试映射一个只有唯一键的表（Oracle Forms 时代的旧版），因为某些值可以为空。用户可以选择其他应用程序中的数据是否以 char 或 number 形式存在，并且表具有两个字段（一个 varchar2 和其他数字）。

可以为此使用域类吗？

例子

```
Mytable
---------------------------------------------------------------
office_schedule_id        NUMBER(5) NOT NULL
office_company_char       VARCHAR2(6)
office_schedule_char      VARCHAR2(10)
office_company_num        NUMBER(6)
office_schedule_num       NUMBER(5)
default                   VARCHAR2(1) 
```

唯一约束由除“default”之外的所有字段组成。

我试过这个：

```
class OfficeSchedule {
   int officeScheduleId
   String officeScheduleName

   static mapping = {
     version false
     table 'office_schedules'
     id column: 'office_schedule_id', name: 'officeScheduleId'
   }

   static hasMany = [ schedules : IntegrationSchedules ]
}
//this represents MyTable
class IntegrationSchedules {
    String officeCompanyChar
    String officeScheduleChar
    Integer officeCompanyNum
    Integer officeScheduleNum
    String default

    static belongsTo = [ officeSchedule : OfficeSchedule ]

    int hashCode() {
      def builder = new HashCodeBuilder()
      //added all fields of the unique key
      builder.toHashCode()
    }

    static mapping = {
      version false
      table 'mytable'
      id composite: ['officeSchedule','officeCompanyChar','officeScheduleChar','officeCompanyNum','officeScheduleNum']
      officeSchedule(column:'office_schedule_id')
    }

} 
```

当我尝试查询时，56 条记录中只有 5 条返回

```
println IntegrationSchedules.findAll().size() //prints 5 but table have 56 
```

我尝试删除与 OfficeSchedule 的关系，但仍然只返回五行。

然后我注意到返回的行是因为它们通知了所有字段，这是有道理的，因为我将键定义为好像它是一个 PK。

我无法更改表格，因为是使用它的旧应用程序。

我认为的一种解决方法是将其转换为 groovy bean 并使用服务来创建对象，但是我不能使用标准和 GORM findBy 方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T20:08:03.913

您最好的选择是查看hibernate docs（并进行谷歌搜索）以寻找一种将其映射到普通hibernate的机制。一旦你在 hibernate 中找到了解决方案（并且 hibernate 非常努力地变得灵活，以便可以在遗留数据库上使用它），然后回到 gorm 并尝试确定 gorm 是否公开了相同的功能。至少，它可能允许您构建一个邮件列表查询，该查询将生成此查询不会生成的响应。有很多 gorm 没有很好的文档记录，因此了解 gorm DSL 如何映射到休眠配置对于做出有根据的猜测是如何在 gorm 中完成的至关重要

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T12:38:30.577

正如@ideasculptor 所提到的，我的解决方案是创建一个休眠映射：

src/java/域

```
@Entity
@Table(name = "mytable")
class IntegrationSchedules {
    @Id()
    @Type(type="string")
    @Column(name="rowid")
    private String rowid;
    private String officeCompanyChar
    private String officeScheduleChar
    private Integer officeCompanyNum
    private Integer officeScheduleNum
    private String default

    //getters & setters ommited
} 
```

我必须创建一个休眠配置（conf/hibernate 中的 hibernate.cfg.xml）

```
<!DOCTYPE hibernate-configuration SYSTEM
  "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
    <session-factory>
        <mapping package="domain" />
        <mapping class="domain.IntegrationSchedules" />
    </session-factory>
</hibernate-configuration> 
```

有趣的是 GORM 的动态方法有效，例如：

```
IntegrationSchedules.findAll() 
```

# c# - c#中的线程状态

> ID：10557455
> 
> 赞同：1
> 
> 时间：2012-05-11T19:27:36.193
> 
> 标签：c#

当我创建一个线程来执行某些功能时，它的状态首先是“正在运行”，但之后它将变为“waitsleepjoin”或“停止”状态，所以：

1.  线程如何达到 waitsleepjoin 状态？
2.  线程如何才能达到停止状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:28:32.953

1.  通过调用`Sleep()`or `Join()`，或者在等待锁时。

2.  在它完成所有代码之后（在原始方法返回之后）

# heroku - Heroku 的 Redis 数据同步

> ID：10557469
> 
> 赞同：0
> 
> 时间：2012-05-11T19:28:40.073
> 
> 标签：heroku, redis, dbmigrate

有没有办法可以将我的本地 redis 存储同步到 Heroku 的远程存储？可能的是将本地数据迁移到 heroku 服务器并通过 heroku 控制台自己运行“SET”命令。有没有更聪明的方法，比如为 MongoDB 完成的[https://github.com/pedro/heroku-mongo-sync ？](https://github.com/pedro/heroku-mongo-sync)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:18:06.090

如果您的本地服务器可用于网络，您可以将其设置为 Heroku 的从属服务器：

[http://redis.io/topics/replication](http://redis.io/topics/replication)

# java - 扩展属性失败

> ID：10557472
> 
> 赞同：0
> 
> 时间：2012-05-11T19:29:24.557
> 
> 标签：java, properties, decorator, strategy-pattern

```
Properties properties = AppConfigurationManager.getInstance().getProperties(ObjectContainer.class); 
```

我有这个填充属性的代码。

我想装饰它以验证一个字段。

```
public class PropertiesDecorator extends Properties{

    public void ValidateFooservHost(){
        for(Entry<Object, Object> element : this.entrySet()){
            if(element.getKey().toString().equals("ffxserv_host")){
                String newHostValue = ffxServHostCheck(element.getValue().toString());
                put(element.getKey(), newHostValue);
            } 
        }
    }

    @Override
    public Object setProperty(String name, String value) {

        if(name.equals("foo")){
            value = fooHostCheck(value);

        }
        return put(name, value);
    }

    public String fooHostCheck(String valueFromConfig){
        String firstTwoChars = valueFromConfig.substring(0, 2);

        if(firstTwoChars.equals("1:")){
            return valueFromConfig.substring(2, valueFromConfig.length());
        }

        return valueFromConfig;
    }
} 
```

然而，

```
PropertiesDecorator properties = (PropertiesDecorator) AppConfigurationManager.getInstance().getProperties(ObjectContainer.class); 
```

这失败了。我没有内容丰富的描述，但它只是说它失败了。没有把握。什么。

我在这里做错了什么？还？

我怎样才能解决这个问题？

或者你会推荐一些不同的东西吗？

我应该使用策略模式吗？将属性传递给 PropertiesDecorator，并在那里进行验证？

**编辑：我已经看到我得到了类转换异常。**

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:38:15.130

您收到 ClassCastException 是因为第三方代码返回的是 Properties 实例，而不是 PropertiesDecorator 实例。一个简单的解决方案是让您的 PropertiesDecorator 接受一个 Properties 对象，并将其所有属性合并到您的中。也就是说，如果您希望 PropertiesDecorator 与 Properties 具有“是”关系。

否则，您可以只拥有一个使用[Adapter 模式](http://en.wikipedia.org/wiki/Adapter_pattern)的 PropertiesAdapter，该模式委托给基础 Properties 实例并进行验证。为了完整起见，下面是一个非常基本的属性适配器类。在必要时添加验证代码和其他委托方法。

```
public class PropertiesAdapter{
    private Properties props;

    public PropertiesAdapter(){
        this.props = new Properties();
    }

    public PropertiesAdapter(Properties props){
        this.props = props;
    }

    public Object set(String name, String value){
        return this.props.setProperty(name, value);
    }

    public String get(String name){
        return this.props.getProperty(name);
    }
} 
```

# c# - 绘制光标时出现通用 GDI+ 异常 ~3322 次

> ID：10557474
> 
> 赞同：3
> 
> 时间：2012-05-11T19:29:26.463
> 
> 标签：c#, .net, bitmap, cursor, gdi+

**问题：**在循环中使用此代码 3322 次（使用底部方法 1246 次）后，在 GetHIcon() 处引发通用 GDI+ 异常。

**示例项目：** [http ://dl.dropbox.com/u/18919663/TestGDICursorDrawing.zip](http://dl.dropbox.com/u/18919663/TestGDICursorDrawing.zip)

**我正在尝试做的事情：**从循环中的位图中绘制一个新光标来做一个简单的聚焦动画。

**我已经检查过的内容：**我确保正在处理所有位图和图形并监控内存泄漏以确保。还要确保没有其他进程有可见的泄漏。尝试了其他方法和方法来确保正确使用位图。

**谷歌告诉我的：** GDI+ 中似乎有一个错误，没有人提供解决方案。一个人尝试创建自己的位图到图标转换器，但它不够灵活，无法处理非通用图像尺寸。

```
public static Cursor CreateCursor(Bitmap bmp, int xHotSpot, int yHotSpot)
{
    //Shows me exactly when the error occurs.
    counter++;
    Console.WriteLine(counter + " GetHicon() calls");

    //GetHicon() is the trouble maker. 
    var newCur = new Cursor(bmp.GetHicon());
    bmp.Dispose();
    bmp = null;

    return newCur;
} 
```

**我试过的其他方法：**

```
public static Cursor CreateCursor(Bitmap bmp, int xHotSpot, int yHotSpot)
{
    //Tried this method too, but this method results in an error with even fewer loops.
    Bitmap newBitmap = new Bitmap(bmp);
    // was told to try to make a new bitmap and dispose of the last to ensure that it wasn't locked or being used somewhere. 
    bmp.Dispose();
    bmp = null;
    //error occurs here. 
    IntPtr ptr = newBitmap.GetHicon();
    ICONINFO tmp = new ICONINFO();
    GetIconInfo(ptr, ref tmp);
    tmp.xHotspot = xHotSpot;
    tmp.yHotspot = yHotSpot;
    tmp.fIcon = false;
    ptr = CreateIconIndirect(ref tmp);

    newBitmap.Dispose();
    newBitmap = null;

    return new Cursor(ptr);
}

[DllImport("user32.dll", EntryPoint = "GetIconInfo")]
public static extern bool GetIconInfo(IntPtr hIcon, ref ICONINFO piconinfo);

[DllImport("user32.dll")]
public static extern IntPtr CreateIconIndirect(ref ICONINFO icon);

[StructLayout(LayoutKind.Sequential)]
public struct ICONINFO
{
    public bool fIcon;         // Specifies whether this structure defines an icon or a cursor. A value of TRUE specifies 
    public Int32 xHotspot;     // Specifies the x-coordinate of a cursor's hot spot. If this structure defines an icon, the hot 
    public Int32 yHotspot;     // Specifies the y-coordinate of the cursor's hot spot. If this structure defines an icon, the hot 
    public IntPtr hbmMask;     // (HBITMAP) Specifies the icon bitmask bitmap. If this structure defines a black and white icon, 
    public IntPtr hbmColor;    // (HBITMAP) Handle to the icon color bitmap. This member can be optional if this 
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T19:56:59.033

考虑到它的症状，这个问题在我看来*肯定是内存泄漏。*它运行了一段时间，然后爆炸。

事实证明，您尝试的第二种方法是严重泄漏 GDI 对象。当您调用`GetIconInfo`填充`ICONINFO`结构时，它实际上会创建两个对应于图标/光标的位图，`hbmMask`以及`hbmColor`. 使用完后必须调用删除它们，否则会泄漏它们*。*`DeleteObject`根据[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648070.aspx)的备注部分：

> `GetIconInfo``hbmMask`为 的和的`hbmColor`成员创建位图`ICONINFO`。调用应用程序必须管理这些位图并在不再需要时将其删除。

这也不是您在这里遇到的唯一泄漏。无论使用*哪种*方法，我都会看到至少两个额外的泄漏：

*   该`Bitmap.GetHicon`方法要求您`DestroyIcon`在使用完图标后调用。您也没有这样做，因此您每次都在泄漏该图标。

*   直到最后，您都没有在紧循环中处理您在紧密循环中创建的`Bitmap`、`Graphics`、`GraphicsPath`和`Cursor`对象，这意味着为每次迭代创建的所有临时对象都被泄露。（我建议将 GDI+ 对象的创建包装在一个语句中，而不是试图记住调用它们的方法。）`while``DrawRingAroundCursor``using``Dispose`

当你修复所有这些漏洞时，执行量增加了一倍以上，以至于我什至看不到同心圆出现了。但是我仍然无法让它无限期地运行而不会崩溃，所以肯定会有更多的漏洞我还没有发现。

像这样的东西`Thread.Sleep`也会引发危险信号，并让我脑海中响起响亮的警钟。

也许现在是说我强烈建议您尝试不同设计的好时机？创建所有这些对象，即使您正确地管理它们的生命周期，也将相对昂贵并且似乎相当不必要。此外，只要用户将光标移出应用程序窗口并移到其他对象上，Windows 就会向`WM_SETCURSOR`新悬停的窗口发送一条新消息，并将光标完全更改为其他内容。用最小的努力使这种效果“消失”太容易了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-21T10:47:04.440

请在 GetHicon 之后使用**DestroyIcon**，以防止内存泄漏

```
[DllImport("user32.dll", CharSet = CharSet.Auto)]
extern static bool DestroyIcon(IntPtr handle); 
```

MSDN：[https ://msdn.microsoft.com/en-us/library/system.drawing.bitmap.gethicon%28v=vs.110%29.aspx](https://msdn.microsoft.com/en-us/library/system.drawing.bitmap.gethicon%28v=vs.110%29.aspx)

我的代码示例：

```
 [DllImport("user32.dll", CharSet = CharSet.Auto)]
 extern static bool DestroyIcon(IntPtr handle);
 public static Icon ConvertoToIcon(Bitmap bmp)
 {
     System.IntPtr icH = bmp.GetHicon();
     var toReturn = (Icon)Icon.FromHandle(icH).Clone();
     DestroyIcon(icH);
     return toReturn;
 } 
```

# python - 发送 post 请求 python

> ID：10557475
> 
> 赞同：2
> 
> 时间：2012-05-11T19:29:27.407
> 
> 标签：python, http, networking, post

我有一个网站，我想检查它是否自上次检查后更新（使用哈希）。问题是我需要输入用户名和密码才能访问该站点。

有没有办法使用python输入用户名和密码？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-11T19:34:20.607

查看[`requests`](http://docs.python-requests.org/en/latest/index.html)库，您可以通过在提示符或终端中`pip`键入来获取该库，具体取决于您的操作系统。`pip install requests``cmd`

```
import requests

payload = {'user' : 'username',
          'pass' : 'PaSSwoRd'}

r = requests.get(r'http://www.URL.com/home', data=payload)

print r.text 
```

你应该没事的。如果您告诉我们有问题的网站，我们可能会提供更好的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:25:43.023

可以从 Python 发送 POST 请求。看看[httplib](http://docs.python.org/library/httplib.html)，它是 http 请求的标准库。还有其他库可以帮助您更像浏览器。我最喜欢的是[机械化](http://wwwsearch.sourceforge.net/mechanize/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T19:36:04.443

是的，可以发送与浏览器相同的信息。根据浏览器与服务器的通信方式，它可以像添加用户名和密码作为 HTTP POST 参数一样简单。其他常见的方法是让浏览器发送密码的哈希值，或者通过多个步骤登录。

# c++ - SetClassLongPtr(GCL_CBCLSEXTRA) 是做什么用的？

> ID：10557477
> 
> 赞同：0
> 
> 时间：2012-05-11T19:29:35.253
> 
> 标签：c++, windows, winapi, visual-c++, setclasslong

在 的文档中[`SetClassLongPtr`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633589.aspx)，它说设置`GCL_CBCLSEXTRA`“不会更改已分配的额外字节数”。

那么，是`SetClassLongPtr(..., GCL_CBCLSEXTRA, ...)`用来做什么的呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-07-10T12:43:45.677

正如 Cody Gray 在他/她的评论中所说，作为对 OP 问题和评论的回应，`GCL_CBCLSEXTRA`应仅用于`GetClassLongPtr`功能调用。

根本没有理由，而且`GCL_CBCLSEXTRA`在任何`SetClassLongPtr`函数调用中使用它也可能是错误的。

假设有一个`struct`其第一个字段/成员`p`将缓冲区的地址存储为类型指针，`void*`第二个字段/成员存储`size`为整数类型`size_t`，该整数类型是指向的缓冲区大小（`p`以字节为单位）。

调用`SetClassLongPtr`with 与`GCL_CBCLSEXTRA`修改`size`字段 / 成员`struct`而不修改字段 / 成员`p`以及`struct`不重新分配函数一样错误`realloc`，例如，函数的字段 / 成员指向的`p`缓冲区`struct`。

在 C 中，您访问`size`字段/成员的`struct`唯一目的是获取它的值，除非或直到`p`字段/成员指向的缓冲区`struct`已被重新分配，`realloc`例如通过调用函数，然后才修改`size`字段/成员的`struct`更新。

由于调用`SetClassLongPtr`with`GCL_CBCLSEXTRA`是错误的，如果设置为，函数`SetClassLongPtr`可能总是失败，以防止函数while成功并进行修改时可能发生的应用程序崩溃。`nIndex``GCL_CBCLSEXTRA``SetClassLongPtr``nIndex=GCL_CBCLSEXTRA`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-12T16:21:52.507

自 Windows 2000 Pro 以来， GCL_CBCLSEXTRA 是GetClassLongPtr**的有效标志**。

它检索有关用于存储额外信息的 Windows 类内存大小的信息。换句话说：它是在用于注册窗口类的窗口类结构之后分配的以字节为单位的内存大小。

# android - Android 应用程序中的 Google 帐户授权

> ID：10557478
> 
> 赞同：7
> 
> 时间：2012-05-11T19:29:39.733
> 
> 标签：android, authorization

我正在编写一个与远程服务器通信的 Android 应用程序，我希望允许应用程序用户使用手机上的谷歌凭据登录服务器，即不需要用户在我的任何地方输入他们的谷歌密码应用程序。例如，如果用户的 (Android) 手机已配置“someguy@gmail.com”，然后他们安装并运行我的应用程序，我的应用程序将向他们显示一个对话框，内容为“您希望以 someguy@ 身份登录gmail.com？”，然后在点击确定按钮后，他们会在我的服务器上建立一个 ID，该 ID 知道他们的电子邮件地址是 someguy@gmail.com，由谷歌本身认证。

我已经找到了关于如何解决这个问题的广泛而多样的部分食谱，包括谷歌自己的 oauth2 文档，但还没有预知如何实现这一切。

我确实有 Android 代码，它使用 AccountManager 来确定给定手机上有哪些谷歌账户。我提示用户他们想使用哪个 google 帐户登录，然后我会取回授权令牌。

过了那个点，我几乎在旋转我的轮子。我看过的食谱似乎要求我做一个这种形式的 http get：

```
http://<myWebServer>.com/_ah/login?continue=<someUrlIChoose>&auth=<authToken> 
```

...其中（a）不满意，因为它似乎特定于appengine，我希望自由地在我选择的任何后端运行它，并且（b）甚至尝试使用appengine，我设置的appengine实例up 似乎根本没有发出信号，即日志现在显示对它的查询（我希望 someUrlIChoose url 会被调用）......因此没有机会被告知令牌的有效性。

具体问题包括：

*   我该如何处理身份验证令牌......我是否将其发送到我的服务器，并以某种方式让我的服务器联系谷歌以验证令牌对指定帐户的有效性？或者是否有一些应该已经（在流程的这个阶段）来自谷歌服务器的反向通道通信来通知我的服务器这个令牌是有效的（如果是这样，我该如何设置它）？或者是其他东西？
*   我是否正确地假设这个过程应该在任何后端（不仅仅是 appengine）的上下文中是可行的？
*   oauth2 是我应该使用的（而不是 oauth1 或其他东西）？我读到的一切似乎都暗示谷歌对 oauth2 的支持是“实验性的”……但我还没有确定这些断言是当前的还是旧的；即使目前，谷歌也有将各种产品保持为永久性非最终形式（例如永恒的测试版）的历史，所以我不知道对此有何结论。
*   还有什么相关的...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T12:26:10.653

您必须在之后导入 google-play-services_lib 才能使用此代码：

```
import com.google.android.gms.auth.GoogleAuthUtil;
import com.google.android.gms.auth.UserRecoverableAuthException;

private void gmail_login() {

    dialog = ProgressDialog.show(LoginActivity.this, "", getString(R.string.login_loading), true);

    AsyncTask task = new AsyncTask() {
        @Override
        protected Object doInBackground(Object... params) {
              getAndUseAuthTokenBlocking();
            return null;
        }
     };
     task.execute((Void)null);
}

void getAndUseAuthTokenBlocking() {
   try
   {
      String AUTH_TOKEN_TYPE = "oauth2:https://www.googleapis.com/auth/plus.me https://www.googleapis.com/auth/userinfo.email";
      AccountManager accountManager = AccountManager.get(this);
      Account[] accounts = accountManager.getAccountsByType("com.google");

      String token = GoogleAuthUtil.getToken(this, accounts[0].name, AUTH_TOKEN_TYPE);
      //token here
   } 
   catch (UserRecoverableAuthException userAuthEx) {
       startActivityForResult(userAuthEx.getIntent(), MY_ACTIVITYS_AUTH_REQUEST_CODE);
   }catch (Exception e){
       DropErrorMsg.drop(this, handler, R.string.connection_error, R.string.error, dialog, false);
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-02T21:59:39.700

这就是你要找的吗？

> 大多数 Android 应用程序都有某种服务器端后端，用于保存和共享数据。即使是最基本的游戏也需要记住玩家的高分。当您构建后端时，您必须解决的一个问题是后端代码如何知道它正在与哪个应用程序对话以及使用它的人是谁。
> 
> 您可能有用于与客户端应用程序通信的 HTTP 端点，但是服务器端代码如何确定谁在向它发送消息？毕竟，任何人都可以从任何地方发送 HTTP POST 请求；如果他们能猜出他们的身份，他们能冒充你的用户吗？
> 
> 要求人们在移动设备上输入用户名和密码确实对用户不友好。特别是，如果有人安装了你的应用程序并允许它使用互联网并知道你的身份，他们不应该再被纠缠。
> 
> 事实证明，现在在所有运行 Android 2.2 或更高版本的兼容设备上都可以使用 Google Play 服务，它基于使用 Google 帐户为这个问题提供了一个很好的解决方案。

[http://android-developers.blogspot.se/2013/01/verifying-back-end-calls-from-android.html](http://android-developers.blogspot.se/2013/01/verifying-back-end-calls-from-android.html)

# crystal-reports - Crystal Reports - 具有常见成分的产品的返回列表

> ID：10557479
> 
> 赞同：2
> 
> 时间：2012-05-11T19:29:43.730
> 
> 标签：crystal-reports, formula

在 Crystal Reports 11 中，我需要创建一个报表，该报表返回一个表中的所有产品，这些产品具有一组共同的用户参数中列出的成分。此外，用户需要能够从一个请求到下一个请求输入不同数量的成分。例如：

我们有 Product_1，它由成分_1、成分_2 和成分_3 组成。
我们有 Product_2，它由成分_1、成分_5、成分_6 组成。我们有 Product_3，它由成分_1、成分_2 和成分_7 组成。

最终用户需要能够放入多达 3 种成分，并查看共享这些成分的所有配方。

在查询 1 中，他将输入成分_1，所有三种产品都应返回完整的成分列表，而不仅仅是成分_1。

在查询 2 中，他将输入应返回产品 1 和 2 的成分 1 和成分 2，再次带有完整的成分列表。

如果产品使用了用户输入的所有成分，我需要知道如何返回产品中的所有成分，而不排除该产品中的其他成分。我还需要确保返回数据库中使用这些特定成分的每个产品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T19:51:44.280

这听起来更像是一个查询/存储过程问题，而不是 Crystal Reports 中的问题。

您的选择语句可以是这样的：

```
DECLARE @ingredient1 VARCHAR(50),
  @ingredient2 VARCHAR(50),
  @ingredient3 VARCHAR(50)

SELECT *
FROM products 
WHERE fld_ProductID IN (SELECT DISTINCT p.fld_ProductID
                        FROM products p
                        WHERE p.fld_formulaID IN (SELECT DISTINCT fld_formulaID 
                                                    FROM formulas 
                                                    WHERE fld_ingredient = @ingredient1
                                                        OR fld_ingredient = @ingredient2
                                                        OR fld_ingredient = @ingredient3)
                        ) 
```

这将选择具有其中一种成分的所有配方 ID。然后它将获取具有这些公式ID 之一的所有产品的列表，最后它将选择所有产品。这样，如果同一产品有多个 formulaID，它将全部选中。

希望这可以帮助。

# c++ - 将一个字符串流附加到另一个。什么最安全？

> ID：10557480
> 
> 赞同：0
> 
> 时间：2012-05-11T19:29:46.620
> 
> 标签：c++, stringstream

以下有什么区别

```
stringstream a;
stringstream b;
a << "hi";
b << "there"; 
```

`a << " " << b.rdbuf();`或`a << " " << b.str();`或`a << " " << b.str().c_str();`

我一直在使用 rdbuf()。我确实注意到 C++ 参考中提到了[stringstream::rdbuf](http://www.cplusplus.com/reference/iostream/stringstream/rdbuf/)：

> 请注意，对于任何成功构造的 istringstream 对象，该指针永远不会为 NULL，即使缓冲区字符串为空。

我认为这意味着 rdbuf() 不会返回 NULL？我不能通过NULL。我有过这样的毛病`char *array = NULL; a << array;`。如果 stringstream b 为空，那么在执行时定义的行为是什么`a << b.rdbuf() << "some text"`？在那种情况下，rdbuf 返回的第一个字符不会具有 eof 特征，因此不会附加 b 中的任何内容吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:35:10.063

> 有什么区别 ？

它们在效果上都是相同的，但它们的性能或效率可能不同。

> 我认为这意味着 rdbuf() 不会返回 NULL？

你拿对了。

> 如果 stringstream b 为空，那么行为是否已定义？

是的。

> 在那种情况下，rdbuf 返回的第一个字符不会具有 eof 特征吗？

不，第一次调用`.sgetc()`(or `.snextc()`) 不会返回具有 eof 特征的字符，它会返回 EOF （这*不是字符*）。因此，您的示例将等效于`a << "" << "some text"`.

# iphone - 使用 Xcode4.2 为 ios5 编译 opencore-amr：没有包含路径来搜索limits.h

> ID：10557485
> 
> 赞同：1
> 
> 时间：2012-05-11T19:30:18.940
> 
> 标签：iphone, ios, ios5, amr, opencore

我正在尝试为[opencore-amr](http://sourceforge.net/projects/opencore-amr/)项目编译一个静态库以在 ios 中使用。我的设置是 Xcode4.2 / iOS5 sdk（因为我还在运行 Snow Leopard）。我已调整[此处](http://sourceforge.net/mailarchive/message.php?msg_id=28298963)附加的构建脚本以使用 -isysroot 而不是 --sysroot，并将 SDK var 更新为 /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.0.sdk

此时在配置检查中失败：

```
checking how to run the C preprocessor... /lib/cpp
configure: error: in `/Users/ldwong/Documents/xcode/opencore-amr-0.1.3':
configure: error: C preprocessor "/lib/cpp" fails sanity check 
```

根据我的 config.log，此检查过程中的第一个失败是查找 limits.h：

```
configure:7965: checking how to run the C preprocessor
configure:7996: gcc -arch armv6 -isysroot=/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.0.sdk -E  conftest.c
In file included from conftest.c:12:
/Developer/Platforms/iPhoneOS.platform/Developer/usr/llvm-gcc-4.2/bin/../lib/gcc/arm-apple-darwin10/4.2.1/include/limits.h:15:25: error: no include path in which to search for limits.h
configure:7996: $? = 1
configure: failed program was:
... 
```

再往下，它也无法使用以下命令找到 assert.h：

```
configure:7996: gcc -arch armv6 -isysroot=/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.0.sdk -E -traditional-cpp  conftest.c
conftest.c:14: error: assert.h: No such file or directory 
```

谁能指出我错过了什么或做错了什么？谢谢！

# javascript - 在对象数组中，查找属性与搜索匹配的对象的索引的最快方法

> ID：10557486
> 
> 赞同：156
> 
> 时间：2012-05-11T19:30:19.017
> 
> 标签：javascript, arrays, indexof

我一直在四处寻找一种有效的方法来做到这一点，但一无所获。我有一个看起来像这样的对象数组：

```
array[i].id = some number;
array[i].name = some name; 
```

我想要做的是找到 id 等于的对象的索引，例如，0、1、2、3 或 4 之一。我想我可以这样做：

```
var indexes = [];
for(i=0; i<array.length; i++) {
  (array[i].id === 0) ? { indexes[0] = i }
  (array[i].id === 1) ? { indexes[1] = i }
  (array[i].id === 2) ? { indexes[2] = i }
  (array[i].id === 3) ? { indexes[3] = i }
  (array[i].id === 4) ? { indexes[4] = i }
} 
```

虽然这可行，但它看起来非常昂贵且缓慢（更不用说丑陋了），尤其是在 array.length 可能很大的情况下。关于如何稍微修饰一下的任何想法？我想以某种方式使用 array.indexOf ，但我不知道如何强制使用语法。这个

```
array.indexOf(this.id === 0); 
```

例如，返回未定义的，因为它可能应该。

* * *

## 回答 #1

> 赞同：419
> 
> 时间：2013-04-19T08:28:51.800

也许您想使用诸如“地图”之类的高阶函数。假设您要按“字段”属性搜索：

```
var elementPos = array.map(function(x) {return x.id; }).indexOf(idYourAreLookingFor);
var objectFound = array[elementPos]; 
```

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2016-12-21T10:21:58.717

在数组中查找元素索引的最简单和最简单的方法。

**ES5 语法：** `[{id:1},{id:2},{id:3},{id:4}].findIndex(function(obj){return obj.id == 3})`

**ES6 语法：** `[{id:1},{id:2},{id:3},{id:4}].findIndex(obj => obj.id == 3)`

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-05-11T19:37:18.183

新的 Array 方法[.filter()](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/filter)可以很好地解决这个问题：

```
var filteredArray = array.filter(function (element) { 
    return element.id === 0;
}); 
```

jQuery 也可以用[.grep()做到这一点](http://api.jquery.com/jQuery.grep/)

编辑：值得一提的是，这两个函数都只是在底层迭代，它们与滚动你自己的过滤器函数之间不会有明显的性能差异，但为什么要重新发明轮子。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2019-03-16T16:31:51.760

如果您关心性能，请不要使用**find**或**filter**或**map**或任何上述方法

这是一个演示最快方法的示例。[这里](http://jsben.ch/zikym)是实际测试的链接

**设置块**

```
var items = []

for(var i = 0; i < 1000; i++) {
    items.push({id: i + 1})
}

var find = 523 
```

**最快的方法**

```
var index = -1
for(var i = 0; i < items.length; i++) {
    if(items[i].id === find) {
        index = i;
        break;
    }
} 
```

**较慢的方法**

```
items.findIndex(item => item.id === find) 
```

**最慢的方法**

```
items.map(item => item.id).indexOf(find); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-04-08T17:05:06.323

```
array.forEach(function (elem, i) {  // iterate over all elements of array
    indexes[elem.id] = i;           // take the found id as index for the
});                                 // indexes array and assign i 
```

结果是 id 的查找列表。使用给定的 id 我们得到记录的索引。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-06-08T20:44:35.820

由于使用常规数组没有答案`find`：

```
var one = {id: 1, name: 'one'};
var two = {id: 2, name:'two'}
var arr = [one, two] 

var found = arr.find((a) => a.id === 2)

found === two // true

arr.indexOf(found) // 1 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-05-11T19:34:00.660

```
var indices = [];
var IDs = [0, 1, 2, 3, 4];

for(var i = 0, len = array.length; i < len; i++) {
    for(var j = 0; j < IDs.length; j++) {
        if(array[i].id == ID) indices.push(i);
    }
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-07-19T06:58:57.757

`const index = array.findIndex(item => item.id === 'your-id');`

这应该为您提供 id === your-id 的数组中项目的索引

```
array = [ {id:1}, {id:2} ];

const index = array.findIndex(item => item.id === 2);

console.log(index);
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-01-24T22:40:09.880

一种使用 ES6 的新方式

```
let picked_element = array.filter(element => element.id === 0); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-06-08T20:22:39.627

使用 ES6`map`函数：

```
let idToFind = 3;
let index = someArray.map(obj => obj.id).indexOf(idToFind); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-05-11T19:35:06.160

听起来你可以创建一个带有回调的简单迭代器进行测试。像这样：

```
function findElements(array, predicate)
{
    var matchingIndices = [];

    for(var j = 0; j < array.length; j++)
    {
        if(predicate(array[j]))
           matchingIndices.push(j);
    }

    return matchingIndices;
} 
```

然后你可以像这样调用：

```
var someArray = [
     { id: 1, text: "Hello" },
     { id: 2, text: "World" },
     { id: 3, text: "Sup" },
     { id: 4, text: "Dawg" }
  ];

var matchingIndices = findElements(someArray, function(item)
   {
        return item.id % 2 == 0;
   });

// Should have an array of [1, 3] as the indexes that matched 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-07-19T18:23:56.087

改编 Tejs 对 mongoDB 和 Robomongo 的回答我改变了

```
matchingIndices.push(j); 
```

至

```
matchingIndices.push(NumberInt(j+1)); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-08-15T09:27:34.907

总结以上所有出色的答案以及我关于查找所有索引的其他答案来自某些评论。

1.  返回第一次出现的索引。

```
const array = [{ id: 1 }, { id: 2 }, { id: 3 }, { id: 4 }, { id: 2 }];
const idYourAreLookingFor = 2;

//ES5 
//Output: 1
array.map(function (x) { return x.id; }).indexOf(idYourAreLookingFor);

//ES6 
//Output: 1
array.findIndex(obj => obj.id === idYourAreLookingFor);
```

2.  使用reduce返回所有出现的索引数组。

```
const array = [{ id: 1 }, { id: 2 }, { id: 3 }, { id: 4 }, { id: 2 }]
const idYourAreLookingFor = 2;

//ES5
//Output: [1, 4]
array.reduce(function (acc, obj, i) {
  if (obj.id === idYourAreLookingFor)
    acc.push(i);
  return acc;
}, []);

//ES6
//Output: [1, 4]
array.reduce((acc, obj, i) => (obj.id === idYourAreLookingFor) ? acc.concat(i) : acc, [])
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-08-04T04:35:55.437

正如@PirateBay 所指出的，有时旧方法是最好的。

使用 ES 6/7，“.find”也非常快，并且在匹配时停止（与 .map 或 .filter 不同）

```
items.find(e => e.id === find)?.id 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-09-24T17:46:08.953

我创建了一个名为[super-array](https://www.npmjs.com/package/super-array)的小型实用程序，您可以在其中通过具有 O(1) 复杂度的唯一标识符访问数组中的项目。例子：

```
const SuperArray = require('super-array');

const myArray = new SuperArray([
  {id: 'ab1', name: 'John'},
  {id: 'ab2', name: 'Peter'},
]);

console.log(myArray.get('ab1')); // {id: 'ab1', name: 'John'}
console.log(myArray.get('ab2')); // {id: 'ab2', name: 'Peter'} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-04-13T20:14:54.193

一种基于特定匹配在数组中查找对象索引的简单方法。

```
//list of bookings
const bookings = [
    { status: "accepted", _id: "6055cadd062eb5153c089121", title: "This is test title", user: "id", team: "id" },
    { status: "pending", _id: "6055cb33062eb5153c089122", title: "title1", description: "test description", user: "id", team: "id" },
    { status: "accepted", _id: "6055cb3d062eb5153c089123", title: "title2", description: "test description", user: "id", team: "id" }
]

//return index of the element if find else return -1 
const findIndex = (booking) => bookings.findIndex((b, index) => {
    if (b._id === booking._id) return true
})

//test 1
let booking = { status: "pending", _id: "6055cb33062eb5153c089122", title: "title2", description: "test description", user: "id", team: "id" }
console.log("index >>> ", findIndex(booking))
//output : 1

//test 2
booking = { status: "rejected", _id: "6055cb33062eb5153c089198", title: "title3", description: "test description", user: "id", team: "id" }
console.log("index >>> ", findIndex(booking))
//output : -1

//test 3
const id = '6055cb3d062eb5153c089123'
console.log("index >>> ", findIndex({ _id: id }))
//output : 2 
```

[查找-searchElementInArrayObObjects](https://github.com/Khattak01/js-code-snippets/blob/main/find-searchIndexOfObjectInArray.js)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-11-01T10:03:08.057

```
var test = [
  {id:1, test: 1},
  {id:2, test: 2},
  {id:2, test: 2}
];

var result = test.findIndex(findIndex, '2');

console.log(result);

function findIndex(object) {
  return object.id == this;
} 
```

将返回索引 1（仅在 ES 2016 中有效）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-02-02T13:46:06.837

由于我还不能发表评论，我想根据 Umair Ahmed 发布的方法展示我使用的解决方案，但是当您想要搜索键而不是值时：

```
[{"a":true}, {"f":true}, {"g":false}]
.findIndex(function(element){return Object.keys(element)[0] == "g"}); 
```

我知道它没有回答扩展的问题，但标题并没有说明每个对象想要什么，所以我想谦虚地分享这个，以便将来让其他人头疼，而我取消它可能不是最快的解决方案。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-04-05T14:07:13.180

我喜欢这种方法，因为它很容易与对象中的任何值进行比较，无论它嵌套多深。

```
 while(i<myArray.length && myArray[i].data.value!==value){
  i++; 
}
// i now hows the index value for the match. 
 console.log("Index ->",i ); 
```

# css - div中的CSS布局div

> ID：10557489
> 
> 赞同：0
> 
> 时间：2012-05-11T19:30:57.567
> 
> 标签：css

我正在尝试在另一个 div 中布局 12 个 div。似乎左边距对他们不起作用。它们出现在垂直列中，而不是彼此相邻。![在此处输入图像描述](../Images/42196469536fee81fc14613bc626ef56.png)

```
div id="wrapper">
<div id="mydiv">
<div></div>
<div></div>
<div></div>
<div></div>
<div></div>
<div></div>
<div></div>
<div></div>
<div></div>
<div></div>
<div></div>
<div></div>
</div>
</div> 
```

CSS

```
wrapper{
width:952px;
height:602px;
margin: 0px auto;
position:relative;
}
#mydiv{
position:absolute;
left:150px;
width:600px;
height:375px;
border: 1px solid black;
padding:10px;
color:#FF0080;
background-color:#FF0000;

}
#mydiv div{
width:180px;
height:100px;
background-color:#000000;
margin-left:20px;
margin-top:10px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:35:36.080

您需要：

```
#mydiv div {float: left;} 
```

或者

```
#mydiv div {display: inline-block;} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:32:37.203

如果您希望它们并排显示，则需要浮动 div：

> **修复**：指定类而不是内联样式的样式。

```
<div style="float:left;margin-left:10px;">
    Hello
</div>
<div style="float:left;margin-left:10px;">
    World!
</div> 
```

这是一个[jsFiddle](http://jsfiddle.net/JTtcn/)来演示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T19:34:06.257

有 #mydiv 包含所有其他 div。然后是#divleft 和#divright。浮动的定义如下：

```
#divleft {
    position: relative;
    float: left;
}

#divright {
    float: right;
    position: relative;
} 
```

# jquery - Jquery Random Math 不重复先前的 var

> ID：10557490
> 
> 赞同：2
> 
> 时间：2012-05-11T19:31:09.330
> 
> 标签：jquery, math, random

我有以下代码

```
var link = [];
link[0] = "css/pink/pink.css";
link[1] = "css/blue/blue.css";
link[3] = "";   
function changeStyle() {
var ran = Math.floor(Math.random() * link.length );
    var style = link[ran];
    jQuery('link[id=style-switch]').attr({href : style});
} 
```

它有效，尽管我不确定如何使它不重复先前的选择，直到它们都被循环通过。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:33:57.100

您可以使用数组的洗牌（基本上是数组元素的随机排列） - 这需要保留一个单独的洗牌数组和一个索引。[这是Javascript 中的 Fisher-Yates shuffle](http://sedition.com/perl/javascript-fy.html)的示例。

# javascript - 跟踪网站上所有访问者的光标移动

> ID：10557491
> 
> 赞同：3
> 
> 时间：2012-05-11T19:31:27.763
> 
> 标签：javascript, php, user-interface, jquery-ui, dom-events

我知道有许多分析工具可用于跟踪网站上所有访问者的光标移动 - 这些工具基本上通过提供需要粘贴在网站上的 Javascript 代码来跟踪移动。它们都相当昂贵

我正在尝试为我自己的网站开发它 - 在我的网站上安装的跟踪代码以及在其他页面/网站上查看的光标移动。

我在谷歌文档中看到过，如果有很多人打开文档。不同的光标以不同的颜色显示，每种颜色对应于特定的访问者。我想为网站开发类似的功能。

我试过谷歌，但我找不到可以开始开发它的起点。

请指导我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:02:24.853

您应该寻找的是将**mousemove**事件侦听器附加到网页的根元素（正文？），并确保通过在对[addEventListener](https://developer.mozilla.org/en/DOM/element.addEventListener)的调用中将参数设置为来指定**捕获**阶段。查看[DOM 事件模型](http://www.w3.org/TR/DOM-Level-3-Events/#dom-event-architecture)以获取更多详细信息，图表非常不言自明。`useCapture``true`

一个快速而肮脏的例子应该是这样的：

```
var coords=[];
var callback = function(e) {
    // save your mouse coordinates somewhere
    coords.push({x:e.clientX,y:e.clientY});
}
document.body.addEventListener('mousemove',callback,true); 
```

当然，您需要弄清楚如何在某个点将这些坐标推送到您的服务器（也许只是保存坐标的样本）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:02:12.277

试试[http://www.clicktale.com/](http://www.clicktale.com/) 他们有免费的博客和小型网站选项。

破译你的分析将是困难的部分。

如果您想使用 jquery 执行此操作，请使用 $(document).mousemove(...)。只要另一个标签没有阻止传播，您就可以映射整个页面。

**警告：**

我没有测试过$(document).mousemove(...)，可能是$("body").mousemove(...) 或者$("html").mousemove(...)

# mysql - 从数据库中的多行中删除一个数量

> ID：10557492
> 
> 赞同：1
> 
> 时间：2012-05-11T19:31:40.387
> 
> 标签：mysql

这是我的表结构：
`table`. `id`（自动递增；主键）
`table`。`qty`（可能的值：0 - 1000）

行：

```
+----+-----+
| 编号 | 数量 |
+----+-----+
| 1 | 0 |
| 2 | 5 |
| 3 | 5 |
| 4 | 10 |
+----+-----+

```

我想将可用数量减少 12。意思是，新结果应该是：
**编辑：我可能应该指定所有这些数字都是任意的。他们可以是任何东西。**

```
+----+-----+
| 编号 | 数量 |
+----+-----+
| 1 | 0 |
| 2 | 0 |
| 3 | 0 |
| 4 | 8 |
+----+-----+

```

现在，我执行以下操作：

1.  `SELECT id, qty FROM table WHERE qty > 0 LIMIT 12`

2.  过滤所有数据以找出要从每行中删除的数量

3.  使用 PDO 准备语句批量更新受影响的行：

    ```
    UPDATE `table` SET qty = ? WHERE id = ?` 
    ```

我的问题：有没有办法在 MySQL 中做到这一切？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:33:21.690

```
SET @q = 12;

UPDATE `table`
SET qty = CONCAT(GREATEST(qty - @q, 0), LEFT(@q := @q - LEAST(qty, @q), 0))
ORDER BY id; 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/07928/6)上查看。

# powershell - powershell：在删除临时文件之前检查已登录的用户

> ID：10557494
> 
> 赞同：1
> 
> 时间：2012-05-11T19:31:48.710
> 
> 标签：powershell

我对脚本比较陌生，下面是我用来清理一天前的临时文件的脚本，但我想构建一个不会删除活动（登录）用户的临时文件并通知哪些对象的检查被跳过。

```
#>
$oldTime = [int]1 # 1 day 
# Create array containing all user profile folders
$colProfiles = Get-ChildItem "C:\Documents and Settings\" -Name
# Remove the "All Users" profile from the array
$colProfiles = $colProfiles -ne "All Users"

# Removes temporary files from each user profile folder
ForEach ( $objProfile in $colProfiles ) {
    # Remove all files and folders in user's Temp folder
    Get-ChildItem "C:\Documents and Settings\$objProfile\Local Settings\Temp\*" -recurse | WHERE {($_.CreationTime -le $(Get-Date).AddDays(-$oldTime))} | remove-item -force -recurse
    # Remove all files and folders in user's Temporary Internet Files. The -force switch on Get-ChildItem gets hidden directories as well.
    Get-ChildItem "C:\Documents and Settings\$objProfile\Local Settings\Temporary Internet Files\*" -recurse -force | WHERE {($_.CreationTime -le $(Get-Date).AddDays(-$oldTime))} | remove-item -force -recurse 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:38:41.120

您可以在删除文件之前测试用户名：

```
if ($objProfile -neq ( gwmi Win32_ComputerSystem ).username.split('\')[1]))
{ .. can delete ..} 
```

或者

```
if ($objProfile -neq [environment]::UserName)
    { .. can delete ..} 
```

# iphone - 开启多重采样时 glReadPixels 不起作用

> ID：10557495
> 
> 赞同：1
> 
> 时间：2012-05-11T19:32:06.527
> 
> 标签：iphone, opengl-es, cocos2d-iphone, glreadpixels, multisampling

glReadPixel 在未启用多重采样时运行良好。但是当启用多重采样时，它会给出 0x502 opengl 错误并且屏幕未被捕获。经过一番研究，它似乎与解析多样本缓冲区有关 - 'glResolveMultisampleFramebufferAPPLE'。但我无法让它在“takeAsCGImage”方法中工作，如下所示

有人可以帮忙吗？

* * *

```
+(CGImageRef) takeAsCGImage
{
    CCDirector *director = [CCDirector sharedDirector];
CGSize displaySize  = [director displaySizeInPixels];
CGSize winSize  = [director winSizeInPixels];

// Create buffer for pixels
GLuint bufferLength = displaySize.width * displaySize.height * 4;
GLubyte* buffer = (GLubyte*)malloc(bufferLength);

// Read Pixels from OpenGL
glReadPixels(0, 0, displaySize.width, displaySize.height, GL_RGBA, GL_UNSIGNED_BYTE, buffer);

NSLog(@"opengl error 0x%x", glGetError()); 
```

* * *

谢谢，简单

# javascript - Jquery Forms：使用备忘录模式构建脏表单通知系统 - 现有模式？

> ID：10557502
> 
> 赞同：1
> 
> 时间：2012-05-11T19:33:06.657
> 
> 标签：javascript, jquery, dirty-data, memento, jquery-dirtyforms

我目前正在构建一个脚本，它将在用户离开页面之前通知用户表单已更改（顺便说一句，这是一个 ASP.NET MVC 应用程序）。

我首先开始构建一个简单的脚本，该脚本检测用户是否更改了任何输入，然后稍微翻转以将表单指定为“脏”。

这最终太简单了，并且缺乏对扩展表单输入的支持，所以我接下来尝试了一个插件。

我能找到的最好的是：http: [//mal.co.nz/code/jquery-dirty-forms/](http://mal.co.nz/code/jquery-dirty-forms/)

这个 jquery 脏表单插件工作得很好，但仍然缺少我需要的一个重要功能；将以前的值与用户输入的值进行比较的能力。

例如，如果一个文本字段最初的值为“Foo Bar”，而用户将该值更改为“Foo”，则该表单现在是脏的。

当用户将该文本框的值更改回“Foo Bar”时，然后使用此插件，表单仍然是“脏”的，这根据我的要求是不正确的。

没有插件可以满足我的需要，所以我必须自己构建，这引出了我的问题：构建这种功能的最佳实践是什么？

我的想法是这样的：

*   由于这个应用程序是 MVC，我可以使用以下技术：
    *   jQuery
    *   json
    *   数据注释

我最初的想法是：

*   页面可以有多种形式；每个表单都有一个属性“isDirty”，最初设置为 false。
*   我需要存储每个字段的原始值以进行比较（纪念品）
*   每个字段都可以有一个类/标志/属性“isDirty”，它将调用该字段“突出显示等”
*   我可以将这些字段值存储在 JSON NVP 数据结构中
*   在提交时，JavaScript 将遍历该 JSON 字符串并查看原始值，与当前值进行比较，如果它无效，那么它将在违反脏规则的文本字段中添加“脏”标志（附加类名） .

性能和可重用性是明确的考虑因素。我应该能够将此模式应用于任何形式，并且只需很少的工作就可以让它使用原始值并执行验证。

有没有人看到与我的需求相似的现有模式？我的想法听起来可行吗？有人对我可以采取的更好路线提出意见吗？让我开始使用我可以扩展的代码示例会很棒，伪代码也很好。

[更新]

有人刚刚告诉我我正在尝试做的事情通常被称为“表单存储”，尽管谷歌对这个搜索词没有多大帮助。

我一直在使用的这个脚本与我想做的类似：（从此页面：[http ://www.mydogboris.com/2009/10/using-jquery-data-feature-to-detect-form-变化/](http://www.mydogboris.com/2009/10/using-jquery-data-feature-to-detect-form-changes/) )

```
 var formChanged = false;

$(document).ready(function() {
 $('#my_form input[type=text].editable, #my_form textarea.editable').each(function (i)     {
      $(this).data('initial_value', $(this).val());
 });

 $('#my_form input[type=text].editable, #my_form textarea.editable').keyup(function() {
      if ($(this).val() != $(this).data('initial_value')) {
           handleFormChanged();
      }
 });

 $('#my_form .editable').bind('change paste', function() {
      handleFormChanged();
 });

 $('.navigation_link').bind("click", function () {
      return confirmNavigation();
 });
});

function handleFormChanged() {
 $('#save_or_update').attr("disabled", false);
 formChanged = true;
}

 function confirmNavigation() {
    if (formChanged) {
         return confirm('Are you sure? Your changes will be lost!');
    } else {
      return true;
    }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T14:56:34.613

我找到了一个我更喜欢这个插件的“表单存储”的实现：[https ://github.com/bcswartz/dirtyFields-jQuery-Plugin](https://github.com/bcswartz/dirtyFields-jQuery-Plugin)

文档可在作者的网站上找到：[http ://www.thoughtdelimited.org/dirtyFields/index.cfm](http://www.thoughtdelimited.org/dirtyFields/index.cfm)

不同之处在于dirtyFields 插件仅处理脏字段和表单。dirtyForms 插件还尝试连接 onbeforeunload 事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-28T13:01:55.273

[Dirty Forms 2.0.0 版](https://github.com/snikch/jquery.dirtyforms/releases/tag/2.0.0)`$('#theform').dirtyForms()`现在在首次调用时跟踪字段的状态。如果字段与原始状态不匹配，则认为它们是脏的，如果它们匹配，则认为它们是干净的。

在您调用 之前都是如此`$('#theform').dirtyForms('setClean')`，之后会为当前状态拍摄新快照，并且与此新状态的任何偏差都将被视为脏。

# mysql - OSX上的rails + MySQL：未加载库：libmysqlclient.18.dylib

> ID：10557507
> 
> 赞同：122
> 
> 时间：2012-05-11T19:33:47.213
> 
> 标签：mysql, ruby-on-rails, ruby, macos

我刚开始使用 Ruby（和 rails）。我根据[http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec:ruby](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec:ruby) gems 进行了设置，使用`rvm`. 我的一切都与 sqlite 配合得很好。

现在我想尝试将东西转换为 MySQL，因为这是我大部分开发工作所用的。在我的 Gemfile 中，我用 mysql2 替换了 sqlite：

```
group :development, :test do
#  gem 'sqlite3', '1.3.5'
  gem 'mysql2'
  gem 'rspec-rails', '2.9.0'
end 
```

但是当我尝试在 MySQL 中为 rails 创建数据库时，我得到：

```
$ rake db:create --trace
rake aborted!
dlopen(/Users/username/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle, 9): Library not loaded: libmysqlclient.18.dylib
  Referenced from: /Users/username/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle
  Reason: image not found - /Users/username/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle 
```

我已经看到其他帖子建议通过自制软件重新安装 MySQL（我的是通过可下载的 DMG 安装的），但我不想这样做，因为我已经有其他几个数据库用于其他非 ruby​​ 项目。

我确实有 Rails 正在寻找的文件；它安装在`/usr/local/mysql/lib/libmysqlclient.18.dylib`. 告诉 Rails 如何找到它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：317
> 
> 时间：2012-06-01T09:19:52.903

解决方案很简单；在 ~/.bash_profile 或 ~/.profile 文件中添加库路径：

```
MYSQL=/usr/local/mysql/bin
export PATH=$PATH:$MYSQL
export DYLD_LIBRARY_PATH=/usr/local/mysql/lib:$DYLD_LIBRARY_PATH 
```

如果它仍然不起作用（这对我有用）：

```
sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

有很多博客`install_name_tool`，因为我在 OSX Lion 上，所以对我不起作用：

```
sudo install_name_tool -change libmysqlclient.18.dylib /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/local/bin/indexer
sudo install_name_tool -change libmysqlclient.18.dylib /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/local/bin/search 
```

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2015-09-30T21:00:59.803

在 El Capitan 我得到了`ln: /usr/lib/libmysqlclient.18.dylib: Operation not permitted`

在 El Capitan`/usr/lib/`现在有一个受限标志，如果不禁用安全性就无法写入，所以我只是将链接放入`/usr/local/lib`。

```
sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/local/lib/libmysqlclient.18.dylib 
```

Rails 服务器再次运行良好。

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2016-01-12T06:39:45.963

虽然这个问题的标题准确地描述了我遇到的问题，但情况与之前的答案中描述的情况不同，解决方案也是如此。

就我而言（El Capitan，通过自制软件安装`brew update && brew upgrade`的 mysql），a 导致 mysql 包升级到 5.7.10（从 5.6.x）。

升级导致`libmysqlclient.18.dylib`替换为`libmysqlclient.20.dylib`，但`mysql2`gem 仍然依赖于前者。

为了解决我所做的问题：`gem uninstall mysql2 && gem install mysql2`

请注意，不同的自制管理库可能会出现类似的问题（[例如，请参阅我自己的答案](https://stackoverflow.com/questions/16756287/cannot-execute-rails-console-due-to-an-error-with-readline/39888979#39888979)）

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2012-10-17T07:00:16.653

```
sudo ln -s /usr/local/mysql-5.5.25-osx10.6-x86_64/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

这对我有用。我从 dmg 文件安装了 MySQL。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2013-07-03T13:02:11.373

```
sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

为我工作。所有类似的都没有。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2016-02-24T20:52:24.043

在完全删除然后全新安装 MySQL 后，我遇到了这个问题。具体来说：

```
Library not loaded: /usr/local/opt/mysql/lib/libmysqlclient.20.dylib 
```

我什至没有碰过我的 Rails 应用程序。

重新安装`mysql2`gem 解决了这个问题。

```
$ gem uninstall mysql2
$ gem install mysql2 -v 0.3.18 # (specifying the version found in my Gemfile.lock) 
```

[MySQL 5.7.10、Rails 4.0.0、Ruby 2.0.0、Mac OS X Yosemite 10.10]

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-10-10T09:50:53.487

如果您使用的是从 El Capitan 的 HomeBrew 安装的 MySQL，那么您应该按如下方式链接它：

```
sudo ln -sf /usr/local/Cellar/mysql/5.6.27/lib/libmysqlclient.18.dylib /usr/local/lib/libmysqlclient.18.dylib 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-11-13T20:13:58.267

对于从 DMG 在 Mavericks 上安装的 MySql 5.6

```
sudo ln -s /usr/local/mysql-5.6.14-osx10.7-x86_64/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-07-09T15:22:49.520

我确认来自 Abhishek 的补丁*确实*有效。

它也适用于优胜美地。

注意：不要链接到特定版本的 mysql，而是使用 mysql 已经构建的符号链接这一事实：

```
sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

此解决方案适用于 Xcode 和 C API。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-05-31T13:44:51.077

确定需要什么符号链接（取决于 mysql 版本和 os 版本）：

```
$ locate libmysqlclient.18.dylib
/usr/local/mysql-5.6.24-osx10.8-x86_64/lib/libmysqlclient.18.dylib 
```

所以 ：

```
ln -s /usr/local/mysql-5.6.24-osx10.8-x86_64/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-10-14T15:27:30.040

对于那些正在使用 brew 的人。只需使用“--force”选项链接你的mysql版本。

```
brew link mysql56 --force 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-05-12T20:53:55.137

这对我有用：

```
ln -s /usr/local/Cellar/mysql/5.6.22/lib/libmysqlclient.18.dylib /usr/local/lib/libmysqlclient.18.dylib 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-12-04T06:47:59.720

仅作记录：`$ gem pristine mysql2`为我解决了这个问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-12-09T15:03:50.983

我正在将 Rails REE (2.3.4) 用于我们拥有的旧系统。升级到 El Capitan 后，运行脚本/控制台产生错误，我的应用程序将不再启动（使用 pow）：

```
$ script/console
Loading development environment (Rails 2.3.4)
/blah-blah/gems/activerecord-2.3.4/lib/active_record/connection_adapters/abstract/connection_specification.rb:76:in establish_connection:RuntimeError: Please install the mysql2 adapter: gem install activerecord-mysql2-adapter (dlopen(/blah-blah/gems/mysql2-0.2.19b4/lib/mysql2/mysql2.bundle, 9): Library not loaded: libmysqlclient.18.dylib
  Referenced from: /blah-blah/gems/mysql2-0.2.19b4/lib/mysql2/mysql2.bundle
  Reason: image not found - /blah-blah/gems/mysql2-0.2.19b4/lib/mysql2/mysql2.bundle) 
```

从上面的这个线程中，我确定我需要在终端中发出这个命令：
`sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib`
这个命令产生了一个错误：“ln: /usr/lib/libmysqlclient.18.dylib: Operation not allowed”。我以前从未见过这个错误。

经过相当多的挖掘，我找到了这篇文章： http: [//www.macworld.com/article/2986118/security/how-to-modify-system-integrity-protection-in-el-capitan.html](http://www.macworld.com/article/2986118/security/how-to-modify-system-integrity-protection-in-el-capitan.html)并遵循关闭 SIP（​​El Capitan 的新系统完整性保护）的说明。关闭 SIP 并重新启动后，ln 命令工作正常。然后我关闭了 SIP。现在一切都很好。我的应用程序使用 pow 再次运行，运行脚本/控制台没有错误。我希望这可以帮助你。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-12-22T02:36:50.147

我正在使用 Mac OS，即使在卸载/删除所有 mysql 和 MAMP 之后，我也遇到了这个错误。早些时候，我安装`brew install mysql`并使用了`MAMP`. 添加软链接对我不起作用。

只能通过删除所有现有的mysql来解决。然后[从这里通过 MySQL 安装 mysql](https://dev.mysql.com/downloads/mysql/)。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-02-27T11:17:22.233

在 Mac Sierra 上，如果使用 Homebrew，请执行以下操作：

```
sudo ln -s /usr/local/Cellar/mysql@5.6/5.6.34/lib/libmysqlclient.18.dylib /usr/local/lib/libmysqlclient.18.dylib 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-04-29T21:29:31.353

```
gem uninstall -aIx 
```

和

```
bundle install 
```

为我工作。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-10-31T10:00:39.197

这对我有用。我所要做的就是卸载 mysql2 gem 并使用以下命令再次安装它

```
gem uninstall mysql2
gem install mysql2 -v '0.3.18' -- --with-mysql-config=/usr/local/Cellar/mysql@5.7/5.7.28/bin/mysql_config 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-06-10T02:59:39.253

这个问题已经有很多答案了，尤其是这个[https://stackoverflow.com/a/10847618/5515861](https://stackoverflow.com/a/10847618/5515861)。我只想添加几个注释。如果你们使用 Mac，我不知道你是如何安装 MySQL 的，但首先要调查的是你的 MySQL 安装在哪里。对我来说，MySQL 是使用`brew`for version安装的`5.7`，位置是`/usr/local/opt/mysql@5.7/`，所以将以下内容添加到我的`~/.zshrc`.

```
MYSQL=/usr/local/opt/mysql@5.7/bin/
MYSQL_LIB=/usr/local/opt/mysql@5.7/lib/
export PATH=$PATH:$MYSQL
export DYLD_LIBRARY_PATH=$MYSQL_LIB:$DYLD_LIBRARY_PATH 
```

希望你解决你的问题

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-01-18T09:16:43.167

从你的命令行使用它：

```
sudo install_name_tool -id /usr/local/mysql-connector-c-6.1.3-osx10.7-x86_64/lib/libmysqlclient.18.dylib /usr/local/mysql-connector-c-6.1.3-osx10.7-x86_64/lib/libmysqlclient.18.dylib 
```

在一些特立独行的电脑上试过总是有效

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-08-07T09:35:56.157

如果您使用 Bitnami RubyStack 并遇到类似的问题。试试这个

```
sudo ln -s /Applications/rubystack-2.0.0-17/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-12-01T16:56:17.933

[当从MySQL For python3](https://github.com/davispuh/MySQL-for-Python-3/wiki/Install-on-Linux)导入 MySQLdb 时，我遇到了这个问题“库未加载：libmysqlclient.18.dylib” ：

```
 Traceback (most recent call last):
  File "test.py", line 3, in <module>
    import MySQLdb
  File "/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/MySQL_python-1.2.4-py3.5-macosx-10.11-x86_64.egg/MySQLdb/__init__.py", line 19, in <module>
    import _mysql
ImportError: dlopen(/opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/MySQL_python-1.2.4-py3.5-macosx-10.11-x86_64.egg/_mysql.cpython-35m-darwin.so, 2): Library not loaded: libmysqlclient.18.dylib
  Referenced from: /opt/local/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/MySQL_python-1.2.4-py3.5-macosx-10.11-x86_64.egg/_mysql.cpython-35m-darwin.so
  Reason: image not found 
```

解决方案对我有用：Mac OS X 10.11.1 Python3.5

```
Edit ~/.bash_profile:
export PATH="/opt/local/Library/Frameworks/Python.framework/Versions/3.5/bin:$PATH"
export PATH="/opt/local/bin:/opt/local/sbin:$PATH"
export PATH="/usr/local/mysql/bin:$PATH"
export PATH="/usr/local/mysql/lib:$PATH"
sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-08-30T20:24:31.533

我正在使用**rails g model**命令，但出现此错误：

```
Library not loaded: libmysqlclient.18.dylib 
```

我已经尝试过了，它对我有用。我使用的是 Mavericks 10.9.5

```
sudo ln -s /usr/local/mysql-5.6.19-osx10.7-x86_64/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

谢谢！

现在我使用的是 Yosemite 10.10.5 并且遇到了同样的错误，所以我只是在终端上运行了这个命令，它已成功修复。

```
$ sudo ln -s /usr/local/mysql-5.6.26-osx10.8-x86_64/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

你也可以试试：

```
sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

他们两个对我来说都很好。希望它可能有用！

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-08-28T15:04:13.240

经过大量的谷歌搜索和以上所有尝试......唯一解决我的问题的是这个命令：

```
$install_name_tool -id /usr/local/lib/libmysqlclient.18.dylib /usr/local/lib/libmysqlclient.18.dylib 
```

我正在使用 macbook pro，OSX 10 El Capitan。Darwin xxxx-MacBook-Pro.local 15.6.0 达尔文内核版本 15.6.0：2016 年 6 月 23 日星期四 18:25:34 PDT；XXX:xnu-3248.60.10~1/RELEASE_X86_64 x86_64 Perl:v5.18.2 Mysql:5.6.19

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2015-08-18T16:10:06.270

我加载该捆绑文件的问题是错误的符号链接。因此，请检查链接，并在需要时将其替换为新链接。一切都在那个时候到位。不知道那是怎么发生的，但确实发生了。第一次发生这样的语法错误。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-12-30T16:16:31.263

谢谢。Homebrew 升级使我的 Rails 应用程序在我的 Mac 上出现问题。我从源代码重新安装了 MySQL (5.7)，然后我不得不这样做

```
sudo ln -s /usr/local/mysql-5.7.28-macos10.14-x86_64/lib/libmysqlclient.20.dylib /usr/lib/libmysqlclient.20bdylib 
```

根据我上面读到的，在我的 Gemfile

```
gem 'mysql2', '0.5.3' 
```

并在 database.yml

```
adapter: mysql2 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2016-02-27T17:10:13.957

唯一对我有用的是：

```
sudo install_name_tool -change libmysqlclient.18.dylib \
/usr/local/mysql-5.6.23-osx10.8-x86_64/lib/libmysqlclient.18.dylib \
/Library/Ruby/Gems/2.0.0/gems/mysql2-0.4.3/lib/mysql2/mysql2.bundle 
```

替换 mysql 和 gems 的路径以适合您的系统。

# qt - 在 glOrtho() 视图中绘制立方体？

> ID：10557509
> 
> 赞同：1
> 
> 时间：2012-05-11T19:33:57.010
> 
> 标签：qt, opengl, cube, orthographic, orthogonal

我正在用 OpenGL 开发一个 4 拆分查看器。一个视图是透视图，其他视图用于正交投影（前、左、上）。

我写了一个从 (-1,-1,-1) 到 (1,1,1) 绘制立方体的方法，它在透视图中效果很好，但我无法让它在我使用的视图中工作glOrtho(...).

现在我这样设置：

```
 glOrtho(0, width, height, 0, 0, 1); 
```

有趣的是，视图根本没有显示立方体。我在 OpenGL 中为视图实现了一个边框，但它可以正确显示。

我正在使用 Qt 并编写了 QGLWidget 的派生类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T11:40:56.123

`glOrtho``model transform`在和之后的视图空间中定义 6 个剪裁平面`view transform`。所以你应该在 中指定 glOrtho 的参数`Eye Space`，而不是`Screen Space`. 在你的情况下，它应该是`glOrtho(-width/(float)height, width/height, -1.0f, 1.0f, -1.0f, 1.0f)`假设`eye position`is in`(0.0, 0.0, 0.0)`和 your `viewport`is `width`by `height`。如果近平面在观察者后面（眼睛位置） ，则`NearVal`参数`glOrtho`应该为负。您可能想要 man [glOrtho](http://www.opengl.org/sdk/docs/man/xhtml/glOrtho.xml)。的[第 4 章](http://developer.nvidia.com/node/89)可以`Cg tuturial`详细介绍不同坐标空间的变换，即`Object Space`、`World Space`、`Eye Space`、和。`Clip space``Normalized Device Space``Window Space`

# java - 我需要学习 Java 中的 Web 服务。它有哪些不同的类型？

> ID：10557514
> 
> 赞同：91
> 
> 时间：2012-05-11T19:34:04.363
> 
> 标签：java, web-services

最近，我决定开始学习java web services，当我开始在google上搜索java web-services的教程时，我发现webservices有很多种类型，基于XML，基于SOAP，还有RESTful webservices。

此外，我发现有一个用于基于 xml 的 Web 服务的 JAX-WS 规范，以及用于创建 RESTful Web 服务的 JAX-RS 规范。

Q1）我很困惑，如果有人能帮助我理解这些不同类型的 web 服务之间的区别，那就太好了，这样我就可以决定先学习哪一个。

Q2) 另外，我想深入学习如何在 Java 中创建不同类型的 Web 服务。是否有任何教程或资源可以深入了解每种 Web 服务以及它们之间的比较。

Q3) 基于什么场景和条件，我应该决定创建基于 XML 的 Web 服务而不是 SOAP 服务，或者我应该使用 RESTful 服务。

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2012-05-11T20:15:24.463

1.  [SOAP Web 服务](http://en.wikipedia.org/wiki/SOAP)是基于标准的，并且几乎受到所有软件平台的支持：它们严重依赖 XML，并且支持事务、安全、异步消息和许多其他问题。这是一个相当大而复杂的标准，但几乎涵盖了所有消息传递情况。另一方面，[RESTful 服务](http://en.wikipedia.org/wiki/Representational_state_transfer)依赖 HTTP 协议和动词（GET、POST、PUT、DELETE）来交换任何格式的消息，最好是 JSON 和 XML。这是一种非常简单而优雅的架构方法。
2.  与 Java 世界中的每个主题一样，有几个库可以构建/使用 Web 服务。在 SOAP 方面，您有[JAX-WS 标准](http://docs.oracle.com/javaee/5/tutorial/doc/bnayl.html)和[Apache Axis](http://axis.apache.org/axis/)，在 REST 中，您可以使用[Restlets](http://www.restlet.org/)或[Spring REST 设施](http://static.springsource.org/spring/docs/3.0.0.M3/spring-framework-reference/html/ch18s02.html)以及其他库。

对于问题 3，[本文](http://www.infoq.com/articles/rest-soap-when-to-use-each)指出 RESTful 服务适用于以下场景：

*   如果您的带宽有限
*   如果您的操作是无状态的：从一次调用到下一次调用不会保留任何信息，并且每个请求都被独立处理。
*   如果您的客户需要缓存。

虽然 SOAP 在以下情况下是要走的路：

*   如果您需要异步处理
*   如果您需要正式的合同/接口
*   在您的服务中，操作是有状态的：例如，您在请求中存储信息/数据并在下一个请求中使用存储的数据。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-11T19:53:47.737

**Q1）**这里有几件事要阅读或谷歌更多：

[java http://www.ajaxonomy.com/2008/xml/web-services-part-1-soap-vs-rest](http://www.ajaxonomy.com/2008/xml/web-services-part-1-soap-vs-rest)[中 SOAP 和 RESTful Web 服务的主要区别](https://stackoverflow.com/questions/2131965/main-difference-between-soap-and-restful-web-services-in-java)

你想先学什么取决于你。我建议您看一下[CXF](https://stackoverflow.com/questions/tagged/cxf)框架。您可以同时构建 rest/soap 服务。

**Q2）**这里有几个很好的肥皂教程（我把它们加了书签）：

[http://united-coders.com/phillip-steffensen/developing-a-simple-soap-webservice-using-spring-301-and-apache-cxf-226](http://united-coders.com/phillip-steffensen/developing-a-simple-soap-webservice-using-spring-301-and-apache-cxf-226)

[http://www.benmccann.com/blog/web-services-tutorial-with-apache-cxf/](http://www.benmccann.com/blog/web-services-tutorial-with-apache-cxf/)

[http://www.mastertheboss.com/web-interfaces/337-apache-cxf-interceptors.html](http://www.mastertheboss.com/web-interfaces/337-apache-cxf-interceptors.html)

最好的学习方式不仅仅是阅读教程。但是你首先要通过教程来获得一个基本的想法，这样你就可以看到你能够（或不能）产生一些东西，这会让你有动力。

SO 是学习特定技术（或更多）的好方法，人们会问很多奇怪的问题，而且会有更奇怪的答案。但总的来说，您将了解以其他方式解决问题的方法。或许你不知道，或许你自己也想不到。

订阅几个您感兴趣的标签并坚持不懈，提出好的问题并尝试给出好的答案，我向您保证，随着时间的推移，您会学到这一点（如果您坚持不懈的话）。

**Q3)**你必须自己回答这个问题。首先决定你要构建什么，毕竟你需要考虑一些迷你项目或其他东西，然后从那里拿走它。

如果您决定使用 CXF 作为构建 REST/SOAP 服务的框架，我建议您查阅这本书`Apache CXF Web Service Development`。这太棒了，不难阅读，也不太大（双赢）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-18T05:52:59.177

SOAP WS 支持远程过程调用（即 RPC）和面向消息的中间件 (MOM) 集成样式。Restful Web Service 仅支持 RPC 集成样式。

SOAP WS 是传输协议中立的。支持多种协议，如 HTTP(S)、消息传递、TCP、UDP SMTP 等。REST 是特定于传输协议的。仅支持 HTTP 或 HTTPS 协议。

SOAP WS 只允许 XML 数据格式。您定义操作，这些操作通过 POST 建立隧道。重点是访问命名操作并将应用程序逻辑公开为服务。REST 允许多种数据格式，如 XML、JSON 数据、文本、HTML 等。可以使用任何浏览器，因为 REST 方法使用标准的 GET、PUT、POST 和 DELETE Web 操作。重点是访问命名资源并将数据公开为服务。REST 支持 AJAX。它可以使用 XMLHttpRequest 对象。适用于无状态 CRUD（创建、读取、更新和删除）操作。获取 - 代表（） 发布 - 接受代表（） 放置 - 商店代表（） 删除 - 删除代表（）

无法缓存基于 SOAP 的读取。可以缓存基于 REST 的读取。更好地执行和扩展。SOAP WS 支持 SSL 安全性和 WS-security，它添加了一些企业安全功能，例如在需要的地方维护安全性，通过中介维护身份，而不仅仅是点对点 SSL，使用不同的安全算法等。REST 仅支持点对点 SSL 安全性。SSL 对整个消息进行加密，无论所有消息是否敏感。SOAP 全面支持针对短期事务的基于 ACID 的事务管理和针对长期运行事务的基于补偿的事务管理。它还支持跨分布式资源的两阶段提交。REST 支持事务，

SOAP 具有内置的成功或重试逻辑，即使通过 SOAP 中介也能提供端到端的可靠性。REST 没有标准的消息传递系统，并且期望调用服务的客户端通过重试来处理通信失败。

**来源** [http://java-success.blogspot.in/2012/02/java-web-services-interview-questions.html](http://java-success.blogspot.in/2012/02/java-web-services-interview-questions.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T17:49:13.410

如果您的应用程序经常使用 http 协议，那么 REST 是最好的，因为它重量轻，并且知道您的应用程序仅使用 http 协议选择 SOAP 并不是那么好，因为它很重，最好根据我们使用的协议来决定 Web 服务选择在我们的应用程序中。

# excel - 使用 VBA 在 Excel 中跳舞？

> ID：10557518
> 
> 赞同：0
> 
> 时间：2012-05-11T19:34:14.857
> 
> 标签：excel, vba

我有两张纸，第一张从第二张中提取数据以便稍后打印出来。

我在第一张纸上有三个脚本。打印，编辑更新。

打印完美无瑕。

编辑工作完美。

更新是我的问题所在。

当我更新表单时，四个单元格会跳舞，它们的数据会发生变化，而我无需在表单上进行任何更改。

前两个是 B17 和 B20。

第二个是Q23和R25。

问题是数据的跳转是在所有四个单元格之间进行的。Sales Order 可能会跳转到 Part Revision，Part ID 会跳转到 Sales order，有时 Sales Order 会跳转到 NCMR Qty。

我无法弄清楚为什么会这样。VBA 代码看起来很可靠，是否有人不仅可以验证他们的计算机中正在发生这种情况，还可以验证为什么会发生这种情况？

这是单子：

[http://dl.dropbox.com/u/3327208/Excel/Edit%26Update.xlsm](http://dl.dropbox.com/u/3327208/Excel/Edit%26Update.xlsm)

这是导致问题的代码。

```
Option Explicit

    Sub PENCMR()
        Dim i As Integer

        'Internal NCMR
        Dim wsPE As Worksheet
        Dim wsNDA As Worksheet
        Dim c As Variant 'Copy Ranges
        Dim P As Range 'Paste Ranges

        Application.ScreenUpdating = False

        'Setting Sheet
        Set wsPE = Sheets("NCMR Output")
        Set P = wsPE.Range("A63:V63")

        Set wsNDA = Sheets("NCMR Data")

        c = Array("AG6", "B11", "B14", "B17", "B20", , "Q23", "B23", "Q11", "Q14", "Q17", "Q20", "Q26", "V23" _
            , "V25", "V27", "B32", "B40", "B46", "B52", "D58", "L58", "V58")

        For i = LBound(c) To UBound(c)
            P(i + 1).Value = wsPE.Range(c(i)).Value
        Next

        With wsNDA
            Dim NR As Long, LR As Long, LC As Long
            Dim f As Range

            LR = .Range("C" & Rows.Count).End(xlUp).Row
            LC = .Cells(2, Columns.Count).End(xlToLeft).Column
            NR = LR + 1

            Set f = .Range("A3:A" & LR).Find(what:=P.Cells(1).Text, LookIn:=xlValues, lookat:=xlWhole)
            If Not f Is Nothing Then
                f.Resize(1, P.Cells.Count).Value = P.Value
            Else
                MsgBox "The data can't be shown, please review the data in question, if no problem can be found please contact the developer"
            End If
        End With
        Range("A63:V63").ClearContents

        With wsPE
            .Range("B11").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,2,FALSE),"""")"
            .Range("B14").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,3,FALSE),"""")"
            .Range("B17").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,4,FALSE),"""")"
            .Range("B20").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,5,FALSE),"""")"
            .Range("B23").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,7,FALSE),"""")"
            .Range("Q11").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,8,FALSE),"""")"
            .Range("Q14").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,9,FALSE),"""")"
            .Range("Q17").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,10,FALSE),"""")"
            .Range("Q20").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,11,FALSE),"""")"
            .Range("Q23").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,6,FALSE),"""")"
            .Range("R26").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,12,FALSE),"""")"
            .Range("V23").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,13,FALSE),"""")"
            .Range("V25").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,14,FALSE),"""")"
            .Range("V27").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,15,FALSE),"""")"
            .Range("B32").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,16,FALSE),"""")"
            .Range("B40").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,17,FALSE),"""")"
            .Range("B46").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,18,FALSE),"""")"
            .Range("B52").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,19,FALSE),"""")"
            .Range("D58").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,20,FALSE),"""")"
            .Range("L58").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,21,FALSE),"""")"
            .Range("V58").Formula = "=IFERROR(VLOOKUP($AG$6,'NCMR Data'!$A$2:$Y$999999,22,FALSE),"""")"
        End With

        Application.ScreenUpdating = True

    End Sub 
```

我现在在这里遇到错误。

```
P(i + 1).Value = wsPE.Range(c(i)).Value 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:42:25.547

发生错误是因为您在数组 C 的第 5 个元素处有一个空格。

```
"AG6", "B11", "B14", "B17", "B20", , "Q23", 
```

摆脱它，它会起作用。我只是做了并且完美地运行了它。

# javascript - 在加载时定位子元素的更有效方法

> ID：10557519
> 
> 赞同：3
> 
> 时间：2012-05-11T19:34:18.727
> 
> 标签：javascript, jquery, html, jquery-ui-datepicker

在许多情况下，我在表单中使用 jQuery 的[出色日期选择器。](http://jqueryui.com/demos/datepicker/)我想要一种通用的方式来应用它，而不知道输入的 id 或类是什么。我想出了这个：

```
<span id="datePickerChild">
 <input type="text"/>
</span>
<script type="text/javascript">
 $(document.getElementById("datePickerChild").firstChild).datepicker();
</script> 
```

使用 mvc3 框架，这些输入会在运行时基于帮助程序使用自己的 id 等输入，所以我想要这种动态方法。有没有更有效的方法来做到这一点？

编辑：

使用 jQuery 1.4.4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:42:03.647

这似乎是一个合理的方法。您可能可以使用 jQuery 更“惯用地”执行此操作，如下所示：

```
$('#datePickerChild').children().first().datepicker(); 
```

甚至：

```
$('#datePickerChild > input:first').datepicker(); 
```

然而，令人困惑的一点是，您说您想这样做而不必知道元素的 id 是什么，尽管您仍然在选择器中使用 id。如果您尝试“一般”使用该 id（因为它在页面上多次出现），您可能希望使用一个类。一旦你对你需要的元素有了一个类，你只需将你的选择器更改为：

```
$('.date-picker-container').children().first().datepicker(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:41:18.543

好的，所以根据您的评论说您不知道*确切的*ID 并且您不想使用类，您不能只进行部分 ID 匹配以匹配所有这些吗？就像是：

```
$("[id*=datePicker]").datepicker(); 
```

# javascript - 如何从 HTML5 使用本机代码（Windows）

> ID：10557523
> 
> 赞同：1
> 
> 时间：2012-05-11T19:34:26.703
> 
> 标签：javascript, windows, html, dll

我是 HTML5 的新手，我正在寻找有关从 HTML5 应用程序访问本机代码的文档和示例。基本上，我有一个需要通过 HTML5 代码访问的编译**dll 。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T19:35:56.943

那是完全不可能的。

对不起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:47:48.493

没有办法直接从 HTML5 执行此操作。HTML5 是一种标记语言，用于以语义正确的方式表示结构和内容。要以编程方式从中访问任何内容，您需要使用其他语言。JavaScript 用于客户端，其中需要使用服务器端语言来访问诸如 dll 文件之类的东西。

tl;dr -- 仅使用 HTML5 是不可能的。

# android - 如何动态创建按钮？

> ID：10557530
> 
> 赞同：4
> 
> 时间：2012-05-11T19:35:30.387
> 
> 标签：android, android-layout, android-button

我知道很多人都问过这个问题，但我的问题有所不同：

我已经在 xml 中有一个布局（使用选项卡），但我需要根据字符串的读取来创建按钮。

例如：查询返回四个单词。我需要创建四个按钮，单击时会出现带有单词的吐司。

注意：我不知道会找到多少字。

代码看起来像：

> ```
>  while (Content.indexOf("<glossary>") != -1) {
>         Content = Content.substring(Content.indexOf("<glossary>") + 9);
>         //create button with name "Content"
>     } 
> ```

编辑：

看看我创建一个按钮的新代码：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.showphyto);
    intent = getIntent();
    Title = intent.getStringExtra("Title");
    Content = intent.getStringExtra("Content");
    setTitle(Title);
    //if(getIntent().getData().getQueryParameter("author") != null)
    TabSpec descritor;

    /************************** Tab General **************************/
    descritor = getTabHost().newTabSpec("tag1");
    descritor.setContent(R.id.General);

    Button myButton = new Button(ShowAllegationActivity.this);
    myButton.setText("test");
    LinearLayout myContainer = (LinearLayout) findViewById(R.id.General);
    myContainer.addView(myButton);

    descritor.setIndicator("General", getResources().getDrawable(R.drawable.icon));
    getTabHost().addTab(descritor);

    /************************** Tab 2 **************************/
    descritor = getTabHost().newTabSpec("tag2");
    descritor.setContent(R.id.Recipe);
    Teste = (TextView) findViewById(R.id.teste2);
    Teste.setText("Teste2");
    descritor.setIndicator("Tab2", getResources().getDrawable(R.drawable.icon));
    getTabHost().addTab(descritor);

    /************************** Tab3 3 **************************/
    descritor = getTabHost().newTabSpec("tag3");
    descritor.setContent(R.id.Related);
    Teste = (TextView) findViewById(R.id.teste3);
    Teste.setText("Teste3");
    descritor.setIndicator("Tab3", getResources().getDrawable(R.drawable.icon));
    getTabHost().addTab(descritor);

    getTabHost().setCurrentTab(0);

} 
```

}

xml文件：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>
<TabHost android:id="@android:id/tabhost" 
android:layout_width="fill_parent" 
android:layout_height="fill_parent">
    <LinearLayout android:id="@+id/linearLayout1" 
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent" 
    android:orientation="vertical">
        <TabWidget android:layout_width="fill_parent" 
        android:layout_height="wrap_content" 
        android:id="@android:id/tabs"></TabWidget>
        <FrameLayout android:layout_width="fill_parent" 
        android:layout_height="fill_parent" 
        android:id="@android:id/tabcontent">
            <LinearLayout android:layout_width="fill_parent" 
            android:layout_height="fill_parent" 
            android:id="@+id/General">
                    <TextView android:layout_width="fill_parent"
                    android:layout_height="wrap_content" 
                    android:id="@+id/teste" />
                    <LinearLayout android:layout_width="fill_parent" 
                    android:layout_height="fill_parent" 
                    android:id="@+id/General2">
                    </LinearLayout>
            </LinearLayout>
            <LinearLayout android:layout_width="fill_parent" 
            android:layout_height="fill_parent" 
            android:id="@+id/Recipe">
                    <TextView android:layout_width="fill_parent"
                    android:layout_height="wrap_content" 
                    android:id="@+id/teste2" />
            </LinearLayout>
            <LinearLayout android:layout_width="fill_parent" 
            android:layout_height="fill_parent" 
            android:id="@+id/Related">
                    <TextView android:layout_width="fill_parent"
                    android:layout_height="wrap_content" 
                    android:id="@+id/teste3" />
            </LinearLayout>
        </FrameLayout>
    </LinearLayout>
</TabHost> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:58:13.877

您可以使用以下代码在代码中创建一个按钮：

```
Button myButton = new Button();
myButton.setLayoutParams(myLayoutParams);
myButton.setText(myText); 
```

要让它显示 Toast，请添加一个 onClickListener：

```
myButton.setOnClickListener(new View.OnClickListener()
                {
                    @Override
                    public void onClick(View view)
                    {
                        //The parameter view is the button that was clicked 
                        Toast.makeText(context, ((Button) view).getText(), Toast.LENGTH_LONG).show()
                        //TypeCasting to Button is important, because a normal View doesn't have a getText method
                    }
                }); 
```

然后，要将它们添加到您的屏幕，您需要在 xml 中定义一个容器来保存它们，例如 LinearLayout。使用以下方法获取 LinearLayout：

```
LinearLayout myContainer = findViewById(R.id.myButtonId); //Make sure you set the android:id attribute in xml 
```

您可能希望此代码位于循环之外，可能就在它之前，因此您不会在每次迭代时都获得 Layout。

然后，在循环中，设置按钮后：

```
myContainer.addView(myButton); 
```

最后，关于`myLayoutParams`变量的注释。当您为视图设置参数时，它们需要与您的小部件的父视图相对应。因此，如果您将 Button 放在 LinearLayout 中，它看起来像

```
//This will make LayoutParameters with layout_width="wrap_content" and layout_height="fill_parent"
LinearLayout.LayoutParams myLayoutParams = new LinearLayout.LayoutParams(
    LinearLayout.LayoutParams.WRAP_CONTENT, 
    LinearLayout.LayoutParams.FILL_PARENT); 
```

你也可以把它放在你的循环之外，并为每个按钮重用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:49:51.260

你可以做的是这样的：

```
 Button button = new Button(this);
    ViewGroup viewGroup = (ViewGroup) findViewById(R.id.container);

    viewGroup.addView(button); 
```

我不知道你的布局，所以我不能更具体。

ViewGroup 将是您的布局，它应该具有由 findByViewId 找到的 id。

此外，您必须按照自己的意愿放置按钮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T12:49:58.580

我改变了创建选项卡的方式，它奏效了！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T19:48:44.497

您需要在 XML 中包含一个布局来保存您添加的按钮（您可以动态地执行此操作，但似乎没有必要）。当你想添加一个按钮时，找到那个布局。然后，您可以使用[ViewGroup.addView(View child)](http://developer.android.com/reference/android/view/ViewGroup.html#addView%28android.view.View%29)将按钮添加到视图层次结构中。

您还需要告诉系统布局已更改，您可以使用 View.invalidate() 方法来完成。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-11T19:42:21.087

```
 while (Content.indexOf("<glossary>") != -1) {
    Content = Content.substring(Content.indexOf("<glossary>") + 9);
    //create button with name "Content"
    Button b = new Button(this);
    b.setText(Content);
    // add this new view to your parent layout
    parent.addView(b);

} 
```

# login - Umbraco 5 在管理员面板上一直显示登录已过期

> ID：10557532
> 
> 赞同：0
> 
> 时间：2012-05-11T19:35:35.787
> 
> 标签：login, umbraco, umbraco5

在管理面板上，Jupiter 会定期显示“登录已过期”框，要求再次登录。

*   我正在使用 IIS7 托管服务
*   我正在使用 SQL Server 2008 R2
*   我在 web.config 上检查了完全信任功能，添加了*trust level="full"*（这是 mi 主机上需要的）
*   我手动将 ASP.NET WebPages 程序集添加到*/bin* 目录（*System.Web.WebPages.Administration.dll*除外，因为它与 Umbraco 中的 Nuget 程序集冲突）

我通过在其他托管服务提供商上发布检查了 IIS 7.5 上的同一个站点，这已经解决了，但我仍然需要解决这个问题。

管理面板正在运行，但它不断需要重新登录。日志似乎显示一切正常。

有人有同样的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T00:26:32.453

检查您的服务器上的日期，而不是您的工作站。他们需要匹配，这是一个常见的问题，吸引了很多人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T10:27:13.140

我认为这也可能是在您的应用程序池回收时引起的。我注意到该弹出窗口似乎出现在应用程序池在服务器上被回收或重新启动之后。

# java - JFrame 未调整大小以适合 JPanel

> ID：10557546
> 
> 赞同：2
> 
> 时间：2012-05-11T19:37:00.823
> 
> 标签：java, swing, layout-manager, gridbaglayout

我已经为一个项目模拟了一个快速的 GUI，我可以看到标签和文本字段，但由于某种原因，窗口没有根据它包含的内容重新调整大小。

这是基本的破败：

创建 JFrame 并添加 JPanel：

```
 JFrame frame1 = new JFrame("Hotel Reservation App");
   frame1.getContentPane().add(rViewPan, BorderLayout.CENTER);
   frame1.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

   frame1.pack();
   frame1.setVisible(true); 
```

这是 rViewPan 的 JPanel 代码：

```
 private void initComponents() {

    setLayout(new BorderLayout());

    arrivalDateTF = new JTextField();

    departureDateTF = new JTextField();
    roomCategoryTF = new JTextField();
    roomQtyTF = new JTextField();

    JTextField[] textFields = { arrivalDateTF, departureDateTF, roomCategoryTF, roomQtyTF };
    JLabel[] textLabels = { new JLabel("1 : "), new JLabel("2 : "),
            new JLabel("3 : "), new JLabel("4 : ")
    };

    JPanel displayPan = new JPanel();
    GridBagLayout gridBagLay = new GridBagLayout();
    GridBagConstraints gridBagC = new GridBagConstraints();

    displayPan.setLayout(gridBagLay);
    SwingUtilities.addTextElementsAsRows(textLabels, textFields, gridBagLay, displayPan);

    gridBagC.gridwidth = GridBagConstraints.REMAINDER;
    gridBagC.anchor = GridBagConstraints.EAST;
    gridBagC.weightx = 1.0;

    displayPan.add(new JLabel(" "), gridBagC);

    submitB = new JButton("Soumettre");
    displayPan.add(submitB, gridBagC);

    SwingUtilities.addStdBorder(displayPan, "Reservation");
    add(displayPan, BorderLayout.CENTER);

} 
```

我基本上得到了一个大小合适的窗口，但是这些字段是水平隐藏的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:38:46.910

> ..窗口没有重新调整到它所包含的大小。

这个变种是。

![测试仪](../Images/59c058907014043d89659c8c8db7fb0d.png)

如果您不知道如何使您的 GUI 运行，我建议您制作并发布一个 SSCCE。

```
import java.awt.*;
import javax.swing.*;

// TODO don't extend JPanel, just create an instance
class TestGui extends JPanel {

    JTextField arrivalDateTF;
    JTextField departureDateTF;
    JTextField roomCategoryTF;
    JTextField roomQtyTF;
    JButton submitB;

    TestGui() {
        initComponents();
    }

    private void initComponents() {
        setLayout(new BorderLayout());

        arrivalDateTF = new JTextField(6);
        departureDateTF = new JTextField(6);
        roomCategoryTF = new JTextField(8);
        roomQtyTF = new JTextField(2);

        JTextField[] textFields = { arrivalDateTF, departureDateTF, roomCategoryTF, roomQtyTF };
        JLabel[] textLabels = { new JLabel("1 : "), new JLabel("2 : "),
            new JLabel("3 : "), new JLabel("4 : ")
        };

        JPanel displayPan = new JPanel();
        GridBagLayout gridBagLay = new GridBagLayout();
        GridBagConstraints gridBagC = new GridBagConstraints();

        displayPan.setLayout(gridBagLay);
//      SwingUtilities.addTextElementsAsRows(textLabels, textFields, gridBagLay, displayPan);
        for (int ii=0; ii<textFields.length; ii++) {
            displayPan.add( textLabels[ii] );
            displayPan.add( textFields[ii] );
        }

        gridBagC.gridwidth = GridBagConstraints.REMAINDER;
        gridBagC.anchor = GridBagConstraints.EAST;
        gridBagC.weightx = 1.0;

        displayPan.add(new JLabel(" "), gridBagC);

        submitB = new JButton("Soumettre");
        displayPan.add(submitB, gridBagC);

//      SwingUtilities.addStdBorder(displayPan, "Reservation");
        add(displayPan, BorderLayout.CENTER);
    }

    public static void main(String[] args){
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                JFrame frame1 = new JFrame("Hotel Reservation App");
                frame1.getContentPane().add(new TestGui(), BorderLayout.CENTER);
                frame1.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

                frame1.pack();
                frame1.setVisible(true);
            }
        });
    }
} 
```

# encryption - 使用外部工具加密上传的文件而不是脚本内部是否可行？

> ID：10557556
> 
> 赞同：2
> 
> 时间：2012-05-11T19:37:58.100
> 
> 标签：encryption, cryptography, security

我想加密由 Web 应用程序的用户上传的文件。

这些文件需要单独加密和解密。

使用外部工具加密文件比在应用程序内部加密文件有优势吗？

例如，在文件上传后立即调用 gpg、crypt 或 7zip（或任何其他工具）。

在请求检索时，再次调用他们进行解密，然后提供文件。

我认为这可能具有性能优势以及加密可以外包给一个可能比编程语言中可用的库更强大和更受信任的应用程序这一事实。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:58:47.357

每次启动工具都会创建一个新流程，这会影响可扩展性。有一些库和工具一样受人尊敬，其中一些来自同一个代码库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T23:04:26.670

首先，你不应该实现自己的加密。也就是说，替代方案对我来说并没有那么不同。当然，您可以在进程内（通过 API 调用）或进程外（在命令行上传递参数）使用 GPG。然后考虑归结为性能、鲁棒性等通常的工程设计，实际上与密码学无关。

# ruby-on-rails - 如何创建一个rails复选框表单？

> ID：10557563
> 
> 赞同：0
> 
> 时间：2012-05-11T19:38:32.950
> 
> 标签：ruby-on-rails, activerecord, associations

我试图创建一个包含大约 20 个“兴趣”的复选框表，让用户可以随意选择。我有一个具有 HABTM 关系的兴趣和用户模型（通过“interests_users”连接表）。

所以：

1.  我如何用 20 个左右的预设兴趣的名称播种兴趣表（只有一个名称：字符串属性）？
2.  我如何在 ERB 表单中显示这些，允许用户选择任意数量的？

注意..我使用 Wicked gem 创建一个多步骤表单（<-工作得很好）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:23:14.347

1.  如果您使用的是 Rails >= 3.0，请查看 db/seeds.rb 文件。您可以将任意 Ruby 代码放入通过 Rake 任务运行的文件中`rake db:seed`。你可以放很多行，比如`Interest.create :name => 'World Domination'`.

2.  这将取决于您如何设置表单。离开你提供的信息，我会做这样的事情：

    ```
    <%= form_for @user do |f| -%>
      <% Interest.all.each do |i| -%>
        <div><%= i.name -%> <%= check_box_tag 'user[interests][]', i.id, @user.interests.detect{|ui| ui.name == i.name} -%></div>
      <% end -%>
    <% end -%> 
    ```

在您的控制器中，您将能够更新您的用户模型的属性。请务必确保您能够批量分配您的参数，并记住 HTML 规范对未选中复选框的限制（阅读标题为“ [Gotcha](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-check_box) ”的部分）。

编辑：修复了一些与语法相关的拼写错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:09:25.533

```
<% for interest in Interest.find(:all) %>
  <%= check_box_tag "user[interest_ids][]", interest.id, @user.interests.include?(interest) %>
  <%= interest.name %>
<% end %> 
```

# jquery - 从模式对话框更新基本窗口的标签

> ID：10557564
> 
> 赞同：0
> 
> 时间：2012-05-11T19:38:34.737
> 
> 标签：jquery, modal-dialog, colorbox

是否可以从模式窗口更新基本页面的 html 属性？

我的意思是，我有一个页面“a.php”，当用户单击“a.php”中的链接时，会打开一个颜色框模式对话框。我在那个模态对话框上做了一些 ajax 工作。在该 ajax 工作结束时，我想更新“a.php”的“按钮”标签。是真的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T05:38:06.353

嗯.. 你并没有真正为我们提供太多，但基本上是的，ColorBox 窗口只是基本页面的一个 javascript 子窗口 - 在你的情况下是 a.php。使用标准的 js 语法，您可以访问任何父级的属性，例如，

```
parent.element.attribute = some_value 
```

例如，

```
parent.form.myInput.value = "test" 
```

此外，您可以使用 JQuery（您已经在使用 ColorBox）来选择您想要的“按钮标签”。如果您发布一些代码，指导可能会更具体。

# html - 优先考虑 CSS 类？

> ID：10557566
> 
> 赞同：1
> 
> 时间：2012-05-11T19:38:42.863
> 
> 标签：html, css

我正在使用 Twitter 的 Bootstrap 库，版本 2.0.3 来制作网站原型。我目前正在使用提供的模态控件（尽管是内联的）来显示将成为表单的内容：

```
<div class="modal in-layout span6 offset3">
    <div class="modal-header">
        <h3>Header</h3>
    </div>
    <div class="modal-body">
        <p>Hello</p>
    </div>
    <div class="modal-footer">

    </div>
</div> 
```

我编写了自己的选择器来使用我的自定义类`.in-layout`：

```
div.modal.in-layout {
    position: static;
    top: auto;
    left: auto;
    margin-top: 10px;
    margin-bottom: 10px;
} 
```

问题是 CSS 规则的匹配顺序非常不方便：

![在此处输入图像描述](../Images/a6cb53c95f96ee0c622ffaf7da97788e.png)

本质上，我需要`.span6`和`.offset3`类以更高的优先级应用`.modal`，以便给我`<div>`260px 的边距和 460px 的宽度。

有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T19:52:01.093

有 3 种方法可以使规则覆盖另一个规则（从最强到最弱列出）：

1.  重要性，例如作者样式表中的规则将覆盖用户代理样式表中指定的规则，使用`!important`规则将覆盖任何其他规则。
2.  特异性，规则将覆盖任何其他具有较少特定选择器的规则。**[这是一篇关于这个主题的文章。](http://css-tricks.com/specifics-on-css-specificity/)**基本上，`element.class`比 更具体`.class`，但比 更具体`#id`。
3.  秩序，一条规则将覆盖它之前的任何其他规则。

除此之外，我还发现了您的代码的其他一些问题。设计网站时，最好使用*语义*定义（“这意味着什么”），而不是*形成相关*术语（“这应该是什么样子”）。

要具体引用您的代码，请命名您的类名`span6`,`in-layout`和`offest3`，您可能应该在其中使用`warning-modal`,`information-header`或之类的东西`error-footer`来传达元素的含义（毕竟 HTML 的唯一目的是为您的文本提供**上下文）。**

一旦您按照这些术语进行思考，为您的元素设计样式就会容易得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:51:37.757

只需将它们放在`.modal`规则之后`.span6`或`.offset3`在`div.modal.in-layout`.

# asp.net-mvc-3 - 显示模型中外键属性的显示值

> ID：10557569
> 
> 赞同：4
> 
> 时间：2012-05-11T19:38:57.453
> 
> 标签：asp.net-mvc-3, entity-framework

我有一个看起来像这样的模型：

```
public class Notes
{
public int NoteID {get; set;}
public string Note {get; set;}
public int CustomerID {get; set;}
{ 
```

在 Notes Details 视图中，我希望能够显示 Customer Name 而不是 CustomerID。显然，如果这是一个创建或编辑视图，我会使用一个下拉列表。但是我不确定如何在只读详细信息视图中显示值而不是 ID。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T20:31:57.847

Code First 主要是......代码，而不是数据库逻辑。

因此，与其在模型中使用外键（如 CustomerID）（这也是可能的，有时是需要的，但并非总是如此），拥有参考属性会更舒服

```
public virtual Customer Customer {get;set;} 
```

因此，在您将 Notes 作为模型的视图中，您可以简单地使用

```
@Html.DisplayFor(m => m.Customer.Name); 
```

当您检索您的 Notes 实体时，不要忘记包含您的 View / ViewModel 所需的相关实体/属性（我让您阅读有关延迟加载的内容）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-27T15:16:32.220

你可以试试这个：

```
var applicationDbContext = _context.Notes.Include(n => n.Custumer);
return View(await applicationDbContext.ToListAsync()); 
```

此代码必须在您的控制器、Index 方法或您命名的任何内容中。这是在考虑范围内。

```
@Html.DisplayFor(modelItem => item.Customer.Name) 
```

# ruby-on-rails - Rails 3.2 中的 Cookie 检测

> ID：10557570
> 
> 赞同：1
> 
> 时间：2012-05-11T19:38:57.963
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在 rails 3.2 中实现 cookie 检测的最佳方法是什么？

如果 cookie 被禁用，我想将用户重定向到特殊操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:03:15.880

您可以检查 rails 自动存储的 session_id

```
redirect_to root_path unless cookies["_session_id"] 
```

# java - 如何从 JAVA 与 SAP 应用程序通信

> ID：10557572
> 
> 赞同：4
> 
> 时间：2012-05-11T19:39:24.900
> 
> 标签：java, jakarta-ee, sap

我们计划将我们的销售和分销模块集成到 SAP 应用程序中。我们需要将销售信息存储在 SAP 应用程序中。

我们正在使用`Exchange Infrastructure/ BDC`SAP 迁移现有数据以加载销售模块现有数据。

现在我们面临的挑战是如何从 JAVA 持续与 SAP 交互以存储和检索销售模块中的数据？

是否有任何工具可用于从 java 与 SAP 进行通信。

谢谢，
阿尼尔库马尔 C

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-12T12:07:30.633

你有多种选择：

*   使用[SAP Business Connector](http://help.sap.com/saphelp_dm40/helpdata/en/6f/1bd5c2a85b11d6b28500508b5d5211/content.htm)
*   使用[SAP JCO](http://help.sap.com/saphelp_nw04/helpdata/en/6f/1bd5c6a85b11d6b28500508b5d5211/content.htm)从 java 调用 SAP RFC Functions
*   在 SAP 中创建 SOAP Web 服务并从 java 中使用它们

我真的推荐网络服务方式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-15T06:47:16.010

我建议您使用 JCO 库在 SAP 中调用 RFC 函数，从程序员的角度来看，这是在 SAP 中获取和存储数据的最简单方法。

从 ECC5 版本开始启用 Web 服务，每个功能模块都可以转换为 Web 服务接口。但是，很难将 SAP 中的结构或内部表映射和解析为 wsdl 文件。当你从 sap 调用 Webservices 时遇到错误，你会花费大量时间来寻找根本原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-09T15:45:00.633

我知道这个问题真的很老，但也许这可能会帮助那里的人，所以我发布了这个。

我强烈推荐看看***Hibersap*** ( [http://hibersap.org/](http://hibersap.org/) )。它是一个开源库，让您可以使用普通的 Java 类和注释来声明您想要调用的 SAP 函数，并提供一个干净的 API 来实际调用这些函数。它也有很好的记录。

# c# - 不太具体的 using 语句与更具体的语句冲突

> ID：10557574
> 
> 赞同：0
> 
> 时间：2012-05-11T19:39:33.053
> 
> 标签：c#, ninject, using-statement

谁能解释这种行为以及解决方案是什么？

我通过 nuget 安装了 Ninject.MVC3，这会在 App_Start 文件夹中创建一个名为 NinjectWebCommon.cs 的文件，其命名空间如下：

```
namespace MvcApplication1.App_Start {
    ...
    using Ninject;
    using Ninject.Web.Common;
    ...
} 
```

现在，我想创建一个 NinjectModule，但在识别 Ninject 命名空间时遇到了一些问题。

```
namespace MvcApplication1.Ninject.Modules {
    using Ninject.Modules
    ...
} 
```

一旦我在模块中添加 using 语句，NinjectWebCommon.cs 就无法再编译。如果我将 using 放在命名空间之外，它仍然无法编译。

但是，如果我将模块的命名空间更改为 MvcApplication1.Foo，那么无论哪种方式都可以正常工作。

为什么命名这个 MvcApplication1.Ninject.Modules（甚至只是 MvcApplication1.Ninject）会导致 NinjectWebCommon.cs 不再找到它的引用？我认为命名空间的目的是防止这种事情发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T22:57:48.640

在查看全局命名空间之前，在当前命名空间及其所有祖先的子命名空间中搜索命名空间中的 using 语句。例如，如果你有一个命名空间 MvcApplication1.A 你可以写

```
using A 
```

代替

```
using MvcApplication1.A 
```

因此，您的示例被编译器解释为

```
namespace MvcApplication1.Ninject.Modules {
    using MvcApplication1.Ninject.Modules
    ...
} 
```

您可以强制编译器仅在全局命名空间中查找，如下所示：

```
namespace MvcApplication1.Ninject.Modules {
    using global::Ninject.Modules
    ...
} 
```

# c# - 创建可以传递到不同层的对象的正确方法是什么

> ID：10557579
> 
> 赞同：0
> 
> 时间：2012-05-11T19:39:58.187
> 
> 标签：c#, oop

我是编程新手，很抱歉我不清楚

我创建了一个类让说

```
public class Users 
{
   public int ID { get; set; }
} 
```

我的第一个问题是根据 3 层设计我应该把这门课放在哪里

如果我把它放在`Business layer`，当我需要更新数据访问层时，我想将用户对象传递给`Data access layer`这样的

```
sendDataToDB(List<Users); 
```

在数据访问层，VS 会为我生成这个方法

```
public static void sendDataToDB(List<global::BLL.Users> newUsers)
{

} 
```

但是会有错误说：

> 在全局命名空间中找不到类型或命名空间名称“BLL”（您是否缺少程序集引用？）

现在我只是创建另一个包含用户对象的库，并让所有三层都访问该库。

我真的不认为这是做事的正确方法。所以任何建议都会很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:47:02.847

如果您的用户对象只包含数据而没有行为，那么它似乎是一个捆绑与用户相关的数据的数据对象。在这种情况下，它是一个数据对象，可以跨层传递。您可能可以为此创建一个单独的命名空间甚至程序集。

请参阅：[http ://en.wikipedia.org/wiki/Data_Transfer_Object](http://en.wikipedia.org/wiki/Data_Transfer_Object)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:36:15.023

分层的规则是低层不能知道高层。要让所有三层都看到一个特定的类，它必须位于最低层。这通常意味着数据访问层——“用户”可能更多的是业务关注点。

层的另一个问题是您通常不会将较低层具有的依赖关系传递给它的上层（至少对其他层的依赖关系）。例如，依赖于数据层的业务层一般将数据层与业务层相关的层屏蔽掉……

这实际上意味着需要在所有层之间共享的类应该在三层之外。

我建议有一个业务类和一个数据类。业务层知道如何获取数据类并将其转换为更高层的业务类。例如，您可能有 Data.Users 用于查询/更新数据库中的数据。业务层使用它来查询/更新数据库并将其转换为 Business.Users，然后将其提供给更高层......

一些有用的分层交互规则：http: [//msdn.microsoft.com/en-us/library/ee658109.aspx#Step5](http://bit.ly/IOznDa)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T21:32:38.283

这是一个非常好的问题，也是我仍然认为“现在是 2012 年，为什么这仍然如此困难？”的问题之一。

因此，您有一个 3 层解决方案：用户界面、域/业务逻辑、数据/持久性。在理想情况下，您希望能够在 UI 中显示您的用户类，在 BL 中定义用户类及其逻辑，并能够将其传递到数据存储库以保存到数据库中。不幸的是，由于循环依赖关系，您不能使用 3 层来执行此操作。

一个常见的解决方案是使用[AutoMapper](http://automapper.org/)之类的东西，因此每个层都有自己的（例如）用户类版本，您只需在层中的类似对象之间进行映射。AutoMapper 之类的工具允许将您的复杂域模型映射到更简单的 UI 显示类型类。然后可以将域对象（即使它由其他对象组成）映射到其特定存储库所需的对象类型 - 再次使用 AutoMapper（顺便说一下，您不必使用 AutoMapper，它只会使映射减少乏味的）。

另一种选择可能是突破三层，并为每个“垂直”层“水平”提供第四个“DTO”层。我倾向于映射它们。

新版本的 EF 将 EF 创建的类一直放入 UI 视图中，但这对我来说是错误的，不是我所知道的，但可能对你有用？

我相信其他人也会有其他建议。我会饶有兴趣地看这个。

# javascript - 使用 JQuery 对 Javascript 进行 JSLint 验证

> ID：10557583
> 
> 赞同：3
> 
> 时间：2012-05-11T19:40:23.973
> 
> 标签：javascript, jquery, jslint

我在 JQuery 中使用 JavaScript 模式。我希望 JSLint 以最高的代码质量验证我的代码。下面是启用 JSLint 选项的屏幕截图。有人告诉我在用 JQuery 编码 JavaScript 时应该检查什么选项。

请

![JSLint 选项](../Images/a6f4b629195f69f585ea40b36b648301.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:47:16.823

选中`assume a browser`复选框并在该`Predefined`部分上键入`jQuery`和`$`。

# javascript - 与 jquery .click 冲突的按钮

> ID：10557588
> 
> 赞同：0
> 
> 时间：2012-05-11T19:40:52.430
> 
> 标签：javascript, jquery, popup

HTML

```
<form id="create-template" class="form" action="" method="post">
    <p class="_50">
        <label for="t-name">Template name</label>
        <input type="text" name="t-name" class="required"/>
    </p>
    <p class="_100">
        <label for="t-html">Template HTML</label>
        <textarea id="t-html" name="t-html" class="required" rows="10" cols="40"></textarea>
    </p>
    <div class="block-actions">
        <ul class="actions-left">
            <li><a class="button red" id="reset-template" href="javascript:void(0);">Clear</a></li>
        </ul>
        <ul class="actions-right">
            <li><div id="preview"><input type="submit" class="button" value="Preview template"></div></li>
            <li><input type="submit" class="button" value="Create template"></li>
        </ul>
    </div>
</form> 
```

JavaScript：

```
$("#preview").click(function() {
        $('#create-template').submit(function() {
            window.open('', 'formpopup', 'width=400,height=400,resizeable,scrollbars');
            this.target = 'formpopup';
        });
    }); 
```

按下`Preview template`它会打开一个弹出窗口并显示模板的预览。这是对的。

预览模板后，当按下`Create template`页面提交时弹出。这是不正确的。

此问题仅在预览模板时发生。`Create template`除非您预览模板，否则会在同一页面上提交表单。

我怎样才能`preview template`避免与 冲突`create template`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:43:54.550

这一行告诉表单提交到弹出窗口：

```
this.target = 'formpopup'; 
```

将其更改为：

```
this.target = window.opener; 
```

您可能希望在提交后关闭弹出窗口。为此，请添加以下行：

```
formpopup.close(); 
```

# objective-c - NSTextField 模拟返回按下按钮

> ID：10557589
> 
> 赞同：0
> 
> 时间：2012-05-11T19:40:56.640
> 
> 标签：objective-c, cocoa

我有一个`NSTextField`绑定到`Shared User Default Controller` NSUserDefault 值的 with 值，仅当用户按下“Enter”ok 键盘时才会更改。

当用户在 UI 上按下按钮时，我想产生相同的效果（模拟特定字段的返回命中）。

可能吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:49:46.967

在您的绑定中，您可以选中“持续更新值”框以在您键入时更新用户默认值，因此如果您的按钮方法只是检查该值，它将始终是最新的。更新文本字段值的更一般的解决方案是让窗口将文本字段以外的内容作为第一响应者（这是当您从文本字段中跳出到下一个响应者时发生的情况）。你可以这样做：

[窗口makeFirstResponder：窗口]；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T14:34:01.770

在您的按钮操作中，执行以下操作：

```
[[NSUserDefaultsController sharedUserDefaultsController] commitEditing] 
```

# django - 一个 Django 项目的多域托管

> ID：10557590
> 
> 赞同：2
> 
> 时间：2012-05-11T19:41:09.713
> 
> 标签：django, multi-tenant

我是 Django 和 python 的新手，所以请多多包涵。我想创建一个非常简单的 SaaS 应用程序来开始使用 Django 和 python。我的设计规定所有域都将在相同的代码库上运行。每个网站之间唯一不同的是数据库连接详细信息。（IE 每个域都有自己的数据库。所有数据库都包含相同的架构）

我将如何使用 Django 来解决这个问题？我已经看过 Sites 框架，但我不确定这就是我想要的。本质上，我想要么

A) 让 Django 在页面加载时从 MASTER 数据库中查找数据库连接详细信息，然后在连接到站点数据库时使用这些详细信息

B）每个站点都有一个settings.py，并让django在运行时包含正确的文件（IE settings_domain.py）

C）让索引 WSGI 包含基于访问域的适当设置文件（这似乎可以工作，但我确信我错过了这个实现的潜在缺陷）

D）我没有想到的其他一些实现......

我是否使这比需要的更复杂？我怎样才能轻松地将这个功能实现到一个新的 django 项目中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:40:03.373

嗯，有一个有趣的项目：[https](https://bitbucket.org/uysrc/django-dynamicsites) ://bitbucket.org/uysrc/django-dynamicsites 。它试图让您拥有完全独特的站点，所有站点都运行在同一个项目中。但是，目前，我认为它不会对您有太大帮助，因为您需要对设置进行比它提供的更多的自定义。

实际上我只是自己做的，最初尝试使用 django-dynamicsites，但发现它有点过于敏感，不太适合我的项目。结果，我最终采取了一些不同的方法。

我的项目有一个“站点”模块，其中每个唯一站点都有一个模块。每个模块都有自己的 settings.py 和 urls.py 和模板目录。例如：

```
sites
    - __init__.py
    - site1
        - __init__.py
        - settings.py
        - urls.py
        - templates
            - base.html
    - site 2
        - __init__.py
        - settings.py
        - urls.py
        - templates
            - base.html 
```

每个 settings.py 大致如下：

```
from myproject.settings import *

SITE_ID = 1
URL_CONF = 'sites.site1.urls'

SITE_ROOT = os.path.dirname(__file__)
TEMPLATE_DIRS = (
    os.path.join(SITE_ROOT, 'templates')
)

CACHE_MIDDLEWARE_KEY_PREFIX = 'site1' 
```

因此，它的作用是导入您的项目设置文件，然后覆盖站点独有的设置。然后，您所要做的就是确保您使用的任何服务器都加载特定站点的 settings.py 而不是主项目的 settings.py。我正在使用 nginx+Gunicorn 的组合，所以这里的配置大致是这样的：

**site1.conf (nginx)**

```
upstream site1 {
    server 127.0.0.1:8001 fail_timeout=0;
}

server {
    listen 80;
    server_name site1.domain.com;

    root /path/to/project/root;

    location / {
        try_files $uri @proxy;
    }

    location @proxy {
        proxy_pass_header Server;
        proxy_set_header Host $http_host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Scheme $scheme;
        proxy_connect_timeout 10;
        proxy_read_timeout 30;
        proxy_pass http://site1;
        proxy_redirect off;
    }

} 
```

我使用主管来管理 Gunicorn 服务器，所以这是我的配置：

**site1.conf（主管）**

```
[program:site1]
command=/path/to/virtualenv/bin/python manage.py run_gunicorn --settings=sites.site1.settings
directory=/path/to/project/root
user=www-data
autostart=true
autorestart=true
redirect_stderr=True 
```

重要的部分是没有花哨的 Django 中间件或此类检查特定主机并相应地以这种方式或那种方式进行。您在 uwsgi、Gunicorn 等上为每个指向正确的 settings.py 文件启动一个 Django 实例，并且您的网络服务器将每个子域的请求代理到匹配的上游连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:39:07.127

最好的方法是在您的网络服务器上进行重写/代理，无论是 apache 还是 nginx。在 apache 中，您可以使用类似这样的内容设置主机文件以捕获所有域。django 将获得一个 URL，然后它可以确定它是哪个域。

```
<VirtualHost *:80>
     ServerName domain.com
     ServerAlias *
     DocumentRoot /var/www/domain.com/DjangoProj/public

     Alias /media/ /var/www/domain.com/DjangoProj/misc/media/
     Alias /static/ /var/www/domain.com/DjangoProj/misc/static/

     <Directory /var/www/domain.com/DjangoProj/public>
         Order deny,allow
         Allow from all
     </Directory>

     WSGIScriptAlias / /var/www/domain.com/DjangoProj/app/wsgi.py

     <Directory /var/www/domain.com/DjangoProj/app>
     <Files wsgi.py>
     Order deny,allow
     Allow from all
     </Files>
     </Directory>

     <IfModule mod_rewrite.c>
          RewriteEngine on
          RewriteCond %{HTTP_HOST} ^(.*) [NC] # Catch domain
          RewriteCond %{REQUEST_URI} !userdomain [NC] # Don't rewrite if we already have it
          RewriteRule ^(.*)$ /userdomain/%1$1 [PT,L] # Pass in PT to give the URL back to mod_python!
     </IfModule>

     ErrorLog /var/www/domain.com/logs/error.log
     CustomLog /var/www/domain.com/logs/access.log combined
</VirtualHost> 
```

# dreamweaver - 在dreamweaver中删除一行的快捷方式？

> ID：10557595
> 
> 赞同：3
> 
> 时间：2012-05-11T19:42:01.993
> 
> 标签：dreamweaver

删除光标所在的当前行的快捷方式是什么。例如：eclipse 有 crtl+d

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:24:10.317

据我所知，没有直接的快捷方式，但这里是dreamweaver 的命令列表。

[http://cpaoffers.com/design/dw-shortcuts.php](http://cpaoffers.com/design/dw-shortcuts.php)

我这样做的典型方法是点击 home > shift+end > del。

或者您可以尝试 shift+up 或 shift+down 选择上方或下方的行，然后点击删除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-05-03T14:19:23.987

删除行

麦克：`Command`+ `Shift`+`D`

窗户：`Ctrl`+ `Shift`+`D`

[https://helpx.adobe.com/dreamweaver/using/keyboard-shortcuts.html](https://helpx.adobe.com/dreamweaver/using/keyboard-shortcuts.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-18T03:24:04.780

**Danilo Celic 的回答帮助我使用 CS6，只需使用第二个。虽然是日文，但安装使用即可。**
如果您想了解更多：然后，在您自己的
*C:\Users\[您的用户名]\AppData\Roaming\Adobe\Dreamweaver CS6\[您的 CS6 语言]\Configuration\Commands*
中找到已安装的文件 即可打开刚刚安装的文件并检查它们。评论是日文的。代码采用 Javascript 编写，易于阅读。
该文件中有 5 个命令。仅使用“删除行”功能： 在 CS6 中，打开历史记录面板，进入设计模式，执行任何操作，例如按键，右键单击历史记录面板中的该操作并记录该操作。然后你可以在上面提到的Commands文件夹中找到录制动作，然后你可以将下载的javascript复制到你自己录制的动作文件中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-12T13:59:58.383

我见过两个添加删除行功能的扩展：

[http://xtnd.us/dreamweaver/codeextras](http://xtnd.us/dreamweaver/codeextras)

[http://yoropan.com/en/archives/544](http://yoropan.com/en/archives/544)

我一个都没用过。我被告知第一个可能无法在 Dreamweaver CS6 中运行，不知道另一个。安装后，您应该能够为您正在寻找的功能添加键盘快捷键（编辑 -> 首选项，Dreamweaver -> Mac 上的首选项）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-18T23:57:10.770

您可以添加自定义键盘快捷键以在 Dreamweaver 中删除行。

Dreamweaver 使用[括号](http://brackets.io/)作为其文本编辑器，这是处理删除行命令的工具，而不是用于重新绑定大多数其他 Dreamweaver 命令的传统菜单系统。

1.  创建一个括号键盘快捷键配置文件。
    *   视窗：`%APPDATA%\Adobe\Dreamweaver CC 2019\en_US\Configuration\Brackets\keymap.json`
    *   Mac OS：（`~/Library/Application Support/Adobe Dreamweaver CC 2019/en_US/Configuration/Brackets/keymap.json`未经测试）
2.  根据 Brackets [User Key Bindings JSON Data Format](https://github.com/adobe/brackets/wiki/User-Key-Bindings)在此文件中创建覆盖。确保在键名之间使用`-`分隔符，而不是`+`.

    ```
    {
        "overrides": {
            "Ctrl-E": "edit.deletelines"
        }
    } 
    ```

3.  在 Dreamweaver 中重新绑定任何冲突的键盘快捷键。在我上面的`Ctrl`+`E`示例中，它与快速编辑相冲突。
    1.  在 Dreamweaver 中，转至编辑 → 键盘快捷键。
    2.  如果您使用默认的 Dreamweaver 标准集，请创建一个新集。
    3.  找到要更改的命令。快速编辑位于代码编辑部分。
    4.  突出显示要修改的快捷方式。
    5.  如果要取消绑定该快捷方式，请单击该`-`按钮。
    6.  否则，通过在“按键”字段中键入新的快捷方式，然后单击“更改”来重新绑定该快捷方式。
    7.  单击确定以保存您的更改。
    8.  如果您的更改没有保留，您通常可以通过编辑以下文件来解决此问题。
        *   `%APPDATA%\Adobe\Dreamweaver CC 2019\en_US\Configuration\Menus\Custom Sets\*.xml`
        *   `%APPDATA%\Adobe\Dreamweaver CC 2019\en_US\Configuration\Menus\menus.xml`
4.  重新启动 Dreamweaver 以读取新的 Brackets 键盘快捷键。

要绑定除 Delete Line 之外的其他命令，请参阅完整的[Brackets Shortcuts](https://github.com/adobe/brackets/wiki/Brackets-Shortcuts)命令 ID 列。

我在 Windows 上对 Adob​​e Dreamweaver 2019 (19.2) 使用了这些步骤。

# android - Android Listview 修改所有项

> ID：10557597
> 
> 赞同：2
> 
> 时间：2012-05-11T19:42:07.427
> 
> 标签：android, listview

修改列表视图的所有子元素（不仅是可见元素）的正确方法是什么。我有一个默认设置为可见性消失的图像。我希望在用户单击按钮后使其可见（对于所有项目）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:14:54.913

> 修改列表视图的所有子元素（不仅是可见元素）的正确方法是什么。

关于 a 要了解的一件事`ListView`是，并非所有列表项都是在任何给定时间生成（膨胀/填充）的。

例如，假设您的列表中`Adapter`有 1000 个项目，但`ListView`一次只能显示 10 个。创建所有 1000 个列表项将非常浪费资源（例如，内存）。

相反，只创建了 10 个可见项目，并且每次您从屏幕顶部或底部滚动一个项目时，已消失的项目会通过传递`convertView`到`Adapter's` `getView`方法中来重新循环。

```
getView (int position, View convertView, ViewGroup parent) 
```

要执行您的要求，您应该扩展`Adapter`您希望使用的任何类型并覆盖该`getView`方法。在该方法中检查是否`convertView`存在`null`。如果是，请扩充您自己的列表项布局实例。如果它不为 null，则重新使用 UI 元素（`TextView`等`ImageView`）。

要使所有`ImageView`元素可见，请使用全局变量，`Boolean`例如`showImageView`将通过按下按钮进行切换。然后使用它`getView`来决定是否设置`ImageView`.

请参阅[Adapter.getView(...)](http://developer.android.com/reference/android/widget/Adapter.html#getView%28int,%20android.view.View,%20android.view.ViewGroup%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:51:47.570

可能您应该根据某些字段值在`ListAdapter`'s中设置图像可见性。`getView()`单击按钮后，您更改此字段值，然后调用`ListAdapter.notifyDataSetChanged`列表视图以更新 -`getView`然后调用并更改图像，因为您的字段值已更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:26:02.767

在适配器内部`getView()`，您抓取 ImageView 并将其可见性设置为消失：

```
ImageView iv = (ImageView)convertView.findViewById(R.id.image_view);
iv.setVisibility(buttonClicked ? View.GONE : View.VISIBLE); 
```

然后当用户单击按钮时，设置`buttonClicked = true`并调用`notifyDataSetChanged()`以刷新 ListView。

# windows-8 - 在 Windows 8 Metro (C#) 中添加下拉设置魅力

> ID：10557601
> 
> 赞同：2
> 
> 时间：2012-05-11T19:42:14.417
> 
> 标签：windows-8, windows-runtime

我发现如何将命令（看起来像链接）添加到设置魅力：

```
SettingsPane.GetForCurrentView().CommandsRequested += MainPage_CommandsRequested;

        void MainPage_CommandsRequested(SettingsPane sender, SettingsPaneCommandsRequestedEventArgs args)
        {
            var cmd = new SettingsCommand("feedback", "Send feedback", new Windows.UI.Popups.UICommandInvokedHandler(x =>
            {
                App.ShowSendFeedback();
            }));

            args.Request.ApplicationCommands.Clear();
            args.Request.ApplicationCommands.Add(cmd);
        } 
```

现在我需要将语言选择的下拉列表添加到设置魅力中。我怎样才能实现它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T13:50:27.777

See also [this blog post](http://blogs.msdn.com/b/going_metro/archive/2012/04/22/integrating-with-windows-8-settings-charm.aspx), which explains how you can display a custom user control whenever one of your settings are selected.

Basically, he moves an off-screen user control on-screen and then hides it again when user interaction is done. To me this feels kind of hack-ish... But I guess that's where WinRT is right now.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-12T02:25:35.920

您不能将其直接添加到 Win8 UI。这个想法是将“命令”链接发布到 Win8 UI 中，然后，当它们被单击时，您的应用程序会收到通知。此时，您可以在其中显示您自己的 UI，其中包含您想要的任何小部件。有关示例，请参阅 SDK 中的任何设置示例。

# c# - 我可以避免在这里创建一个类吗？

> ID：10557604
> 
> 赞同：1
> 
> 时间：2012-05-11T19:42:17.890
> 
> 标签：c#, .net

我正在使用 .NET 框架 2.0，并且我有一个类似的类的情况：

```
class MyThing 
{
  private int val;
  private DateTime date;
  private Guid id;

  public MyThing(..) { ... }
} 
```

这个类存在的唯一原因是因为在我的代码中的某个时刻，我需要跟踪一个`List<MyThing>`. 但是，`MyThing`除了作为将我的数据以一种方法保存在一起的地方之外没有任何实际目的，因此为此创建一个类感觉很难看。我宁愿不创建一个`List<List<object>>`，因为这也很丑陋。

还有其他方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:45:10.397

使用 a `class`（或者也许 a [`struct`](http://msdn.microsoft.com/en-us/library/ah19swz4%28v=vs.100%29.aspx)）绝对是正确的方法。不知道为什么你觉得它难看。这就是目的。它定义了“某物”，在这种情况下，某物是您想要保留列表的这三个值所代表的任何东西

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T19:58:25.377

正如其他人所建议的那样，上课是正确的方式。

此外，如果您不想仅仅为了将这些属性组合在一起而创建一个类，您可能需要查看`Tuple`类*^([[MSDN]](http://msdn.microsoft.com/en-us/library/system.tuple.aspx))*。它是在 .NET 4.0 中引入的，但在 .NET 2.0 中重新创建并不难。

基本上，它是一个具有大量重载的泛型类，可让您以类型安全的方式将不同的对象组合在一起。像这样的东西：

```
public class Tuple<T1, T2, T3>
{
    public T1 Item1 { get; set; }
    public T2 Item2 { get; set; }
    public T3 Item3 { get; set; }
} 
```

然后，您将像这样使用它：

```
Tuple<int, DateTime, Guid> myThing = new Tuple<int, DateTime, Guid>();
myThing.Item1 = 42;
myThing.Item2 = DateTime.Now;
myThing.Item3 = Guid.NewGuid(); 
```

这可能无法满足您不丑的要求，但至少它是可重用的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T19:44:06.270

为什么丑？这是完全正常的。

但我同意，通过拥有正确的类架构，您应该能够避免仅将类作为方法之间的参数传递。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T20:56:25.123

如果您使用带有“Microsoft 所有规则”的 FxCop 测试您的代码，那么使用类是唯一正确的方法。

因为

1.  List<List<oject>> 会产生警告
2.  元组也不是一个好习惯。您不知道 Tuple 中的 Item1、Item2 表示什么。此外，您不会获得其类型的 IntelliSense。
3.  无论哪种方式，您都在创建引用类型，因此性能没有变化
4.  MainClass 和内部类具有“has-a”关系，如果您使用列表列表的元组，则无法理解。
5.  创建不同的类是提高可读性和保持代码简洁的最佳实践。

谢谢

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T20:03:04.007

如果您使用的是 Visual Studio 2008 或更高版本（无论您的目标是否为 .NET 2.0），您可以使用匿名类型并执行类似的操作，而无需声明类：

```
static List<T> CreateList<T>(IEnumerable<T> stuff)
{
    return new List<T>(stuff);
}

static IEnumerable<T> SubSet<T>(IEnumerable<T> sequence, Predicate<T> predicate)
{
    foreach (var item in sequence)
        if (predicate(item)) yield return item;
}

static void Main(string[] args)
{
    var list = CreateList(new[]
                            {
                            new {val = 1,
                                date = DateTime.Now,
                                id = Guid.NewGuid()},
                            new {val = 2, 
                                date = DateTime.Now.AddDays(1),
                                id = Guid.NewGuid()}
                            });

    var subset = SubSet(list, item=>item.val == 1);
} 
```

# c# - 在 C# 中运行线程时在 GUI 中显示消息

> ID：10557610
> 
> 赞同：3
> 
> 时间：2012-05-11T19:42:44.953
> 
> 标签：c#, .net, multithreading, .net-4.0

我有一个应用程序，它在第一次启动时每 7 天执行一次更新，从网上下载一些文件。

此更新最多可能需要 5 分钟，具体取决于需要下载的文件数量。

我想做的是在一个单独的线程中运行更新，以便在更新处理时 GUI 的其余部分可用。

对于我的应用程序来说，这似乎是一个非常可行的选择，但我还想在主 GUI 中显示一条消息，可能在状态栏中，告诉用户更新正在处理，并在完成后消失。

我已经四处寻找方法来做到这一点，但似乎没有任何作为我正在寻找的解决方案弹出。有谁知道这是否可能以及如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T19:45:01.653

您需要做的就是使用[`Dispatcher.Invoke`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.invoke.aspx)来自后台线程的调用来包装您的 UI 访问代码。要使用的`Dispatcher`实例可以通过[`Dispatcher`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherobject.dispatcher.aspx)您的`UIElement`.

假设下面的方法是在你的 UI 元素的类定义中定义的：

```
private void ProcessItems(IList<Item> items)
{
    Task.Factory.StartNew(() =>
    {
        for (int i = 0; i < items.Count; ++i)
        {
            // Code here runs on background thread.
            this.ProcessItem(items[i]);

            this.Dispatcher.Invoke(DispatcherPriority.Normal, () =>
            {
                // Code here runs on UI thread.
                this.UpdateStatus("Completed " + (i + 1) + " of " + items.Count);
            });
        }
    },
        TaskCreationOptions.LongRunning);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:27:30.500

有了这个小家伙：

```
internal static class ControlExtensions
{
    internal static void Invoke(this Control control, Action action)
    {
        control.Invoke(action);
    }
 } 
```

你可以调用你的代码（在win form world中，wpf有自己的解决方案）：

```
... form.Invoke(()=>form.SomeControl.SomeProperty=someValue); 
```

# python - Python 正则表达式匹配鞋码

> ID：10557611
> 
> 赞同：1
> 
> 时间：2012-05-11T19:42:51.240
> 
> 标签：python, regex

我正在编写一个小脚本，该脚本将匹配来自鞋标识符 (SKU) 的鞋码。

我希望能够处理一些情况。给定以下列表：

```
sizes = ['315122-603 10  A', '315122-608_12.0', '317982-019', '364781-019_5.5Y', 'V24088-001_10', '609048-035  8.5', '7-20Spm8231B5 10', 'G17295-001_9.5'] 
```

我希望能够获得每个喜欢的大小（10、12、5.5 等）。

我对正则表达式的了解非常有限，我一直在到处寻找一些片段并想出了以下内容

```
r = '\d{1,2}.\d+'
for size in sizes:
    re.findall(r, size)

['315122', '603']
['315122', '608', '12.0']
['317982', '019']
['364781', '019', '5.5']
['24088', '001']
['609048', '035', '8.5']
['7-20', '8231', '5 10']
['17295', '001', '9.5'] 
```

但如您所见，它不起作用。我希望能够只匹配小数点前和小数点后的数字，但只能匹配数字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:45:33.493

几个问题：

*   在`.`正则表达式中具有特殊含义。如果你真的想匹配一个点，你需要转义它。
*   您可能希望点是可选的。
*   `\D`使用,`\b`或等技术检查匹配之前或之后是否没有更多数字`(?!\d)`。
*   您通常应该使用原始字符串来编写正则表达式模式，这样反斜杠序列就不会被解释为控制字符。
*   `re.findall`找到多个匹配项。如果您知道只有一场比赛，请使用`re.search`.

尝试这个：

```
pattern = r'\D(\d{1,2}(?:\.\d+)?)(?!\d)' 
```

请注意，您的某些字符串包含下划线或没有小数分隔符。您还没有真正描述在这些情况下应该发生什么，并且此模式无法处理您示例中的所有情况，但它有望为您提供一个良好的开端。

您可能还需要考虑为每种输入类型编写不同的正则表达式，而不是尝试编写单个正则表达式来处理所有可能的输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:01:46.383

您正在寻找的似乎是一个数字（数字、小数点和更多数字）的第一次出现，后面跟着一个空格或下划线。

所以

```
r'[ _](\d+(?:\.\d+)?)' 
```

# php - PHP datetime 加一秒

> ID：10557613
> 
> 赞同：8
> 
> 时间：2012-05-11T19:43:05.147
> 
> 标签：php, datetime

> **可能重复：**
> [PHP 日期时间](https://stackoverflow.com/questions/842974/php-date-time)

尝试将一秒添加到用户输入的日期时间 $values['start_date_'.$j.'-'.$i] 是有效的日期时间字符串，但是以下代码会引发错误

```
$priceStart = date('Y-m-d H:i:s',strtotime($values['start_date_'.$j.'-'.$i]));
date_modify($priceStart, '+1 second');
$priceStart =date_format($priceStart, 'Y-m-d H:i:s'); 
```

错误是“date_modify() 期望参数 1 是 DateTime，字符串在...中给出...在线...” date_format() 也出现同样的错误

什么是正确的语法？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-11T19:48:54.870

改为使用`DateTime`对象。对于这个来说，它更强大、更容易。

```
$priceStart = new DateTime("@" . strtotime($values['start_date_'.$j.'-'.$i]));
$priceStart->modify("+1 second"); //You're pretty much done here!
echo $priceStart->format("Y-m-d H:i:s"); //Just to see the result. 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-11T19:45:20.477

`date()`给你一个字符串。`date_modify`需要一个 DateTime 对象。

做你想做的最简单的方法是简单地将返回的值加一`strtotime()`：

```
$priceStart = date('Y-m-d H:i:s',strtotime($values['start_date_'.$j.'-'.$i]) + 1); 
```

或者，您可以创建一个 DateTime 对象：

```
$priceStart = new DateTime('@' . strtotime($values['start_date_'.$j.'-'.$i])); 
```

并且您的其余代码应该开始工作。

# python - Matplotlib：figlegend 只打印第一个字母

> ID：10557614
> 
> 赞同：14
> 
> 时间：2012-05-11T19:43:21.663
> 
> 标签：python, matplotlib

我尝试只用一行打印一个 figlegend，但我只得到第一个字母。我有以下用于制作情节的脚本：

```
from pylab import *
k = plot((0, 1),(1, 1))
figlegend((k),('Limit'),loc='lower center')
savefig('test.pdf') 
```

输出是：![输出](../Images/df6e81c85ef9a3a0bc7bcd15edc26c3e.png)

我究竟做错了什么？（或者它是一个错误？）

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-11T19:52:26.757

我还没有弄清楚它是 matplotlib 中的错误还是故意（出于某种原因），但为了获得完整的图例标签，您需要在标签列表中留下一个尾随逗号：

```
figlegend((k),('Limit',),loc='lower center') 
```

更改该行和您的代码：

```
from pylab import *
k = plot((0, 1),(1, 1))
figlegend((k),('Limit',),loc='lower center')
savefig('test.pdf') 
```

产生图形：

![完整的图例标签](../Images/9bbacc5719ce71d1c45d4c26cac0b878.png)

或者，可以使用`[]`来实现相同的结果：

```
figlegend((k),(['Limit']),loc='lower center') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-02-25T16:39:34.077

您的问题的答案如下。

对于图例的名称，您必须将其括在方括号中，如下所示：

```
figlegend((k),[('Limit')],loc='lower center') 
```

如您所见，图例名称“limit”括在方括号中，然后将显示全名。

```
Here would be the full code:
from pylab import *
k = plot((0, 1),(1, 1))
figlegend((k),[('Limit')],loc='lower center')
savefig('test.pdf') 
```

# testing - 使用来自给定目录的输入运行某个程序的脚本

> ID：10557615
> 
> 赞同：0
> 
> 时间：2012-05-11T19:43:23.020
> 
> 标签：testing, maven, for-loop, sh

所以我需要运行一堆（maven）测试，并将 testfiles 作为参数提供给 maven 任务。

像这样的东西：

`mvn clean test -Dtest=<filename>`

并且测试文件通常被组织到不同的目录中。因此，我正在尝试编写一个脚本，该脚本将执行上述“命令”并自动将给定目录中所有文件的名称提供给`-Dtest`.

所以我从一个名为'run_test'的shellscript开始：

```
#!/bin/sh
if test $# -lt 2; then
    echo "$0: insufficient arguments on the command line." >&1
    echo "usage: $0 run_test dirctory" >&1
    exit 1
fi
for file in allFiles <<<<<<< what should I put here? Can I somehow iterate thru the list of all files' name in the given directory put the file name here?
     do mvn clean test -Dtest= $file  

exit $? 
```

我卡住的部分是如何获取文件名列表。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:50:44.263

```
#! /bin/sh
# Set IFS to newline to minimise problems with whitespace in file/directory 
# names. If we also need to deal with newlines, we will need to use
# find -print0 | xargs -0 instead of a for loop.
IFS="
"
if ! [[ -d "${1}" ]]; then
  echo "Please supply a directory name" > &2
  exit 1
else
  # We use find rather than glob expansion in case there are nested directories.
  # We sort the filenames so that we execute the tests in a predictable order.
  for pathname in $(find "${1}" -type f | LC_ALL=C sort) do
    mvn clean test -Dtest="${pathname}" || break
  done
fi
# exit $? would be superfluous (it is the default) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:52:38.723

假设`$1`包含目录名称（用户输入的验证是一个单独的问题），那么

```
for file in $1/*
do
    [[ -f $file ]] && mvn clean test -Dtest=$file
done 
```

将对所有文件运行命令。如果要递归到子目录，则需要使用`find`命令

```
for file in $(find $1 -type f)
do
    etc...
done 
```

# xcode - 使用 segues 从 UITableViewController 显示 UIView

> ID：10557618
> 
> 赞同：1
> 
> 时间：2012-05-11T19:43:41.037
> 
> 标签：xcode, storyboard, uitableview, segue

我正在尝试使用情节提要将 UITableViewController 连接到 UIView。我有一个 TabBarController 连接到显示 UITableViewController 的导航控制器，显示一个小数组。我想单击一行并触发一个带有标签的简单 UIView，该标签​​仍显示在 UINavigationController 中，因此我可以导航回 UITableViewController

我可以让 UITableViewController 用数组显示 OK，但是当我选择它时我无法让行触发。

这是我的 UITableViewController (AtoZController.m) 文件：

```
#import "AtoZController.h"
#import "StoreDetailsView.h"

@interface AtoZController ()

@end

@implementation AtoZController

- (void)viewDidLoad
{
    [super viewDidLoad];
    self.title = NSLocalizedString(@"A to Z", @"An A to Z List of Stores");

    AtoZArray = [[NSMutableArray alloc] init];

    [AtoZArray addObject:@"Apple"];
    [AtoZArray addObject:@"Boots"];
    [AtoZArray addObject:@"Topman"];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
    } else {
        return YES;
    }
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    return [AtoZArray count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Configure the cell...

    NSInteger row = [indexPath row];
    cell.textLabel.text = [AtoZArray objectAtIndex:row];
    return cell;
} 
```

我从 UITableViewController 到 UIView 连接了一个名为 storeDetailsS​​egue 的 segue。我正在尝试使用 prepareForSeque 方法来触发下一个视图，但对以下代码没有运气。

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    NSIndexPath *path = [self.tableView indexPathForSelectedRow];
    StoreDetailsView *detail = [self detailForIndexPath:path];
    [segue.destinationViewController setDetail:detail];
} 
```

正如它一直说的那样，有一个错误，因为“AtoZController 声明选择器'detailForIndexPath'”没有可见的@interface。我可能做错了什么，因为我以前从未使用过故事板。我想要的是一个简单的 UIView 显示一个标签，该标签动态更改以显示已选择的行号。

我不知道 UITableViewController 实际上是否应该是 UITableView 但由于我从未使用过 segue 或故事板，我不知道是什么导致了问题。

任何建议都将不胜感激。

更新：

所以我设法让 UIViewController 显示，但在显示视图之前仍然无法更新标签。

# javascript - 带有类的 div 的 jquery 选择器

> ID：10557620
> 
> 赞同：24
> 
> 时间：2012-05-11T19:43:46.177
> 
> 标签：javascript, jquery

我在下面试过这个。我认为**$("div.tab_select")[0]**的返回对象不是 jQuery 对象，但我什至不能使用纯 JavaScript 方法。

有没有办法让它成为 jQuery 对象？例如**$($("div.tab_select")[0])** ..我知道这很愚蠢；

感谢您的阅读。

```
var tmp = $("div.tab_select")[0]; 
alert(tmp); //This gives me HTMLDivElement collectly. But I can't use any of javascript..

alert(tmp.nodeName); //But this give me error "Uncaught TypeError: Cannot read property 'nodeName' of undefined"

tmp.hide(); //Neither, I can't use this. 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-11T19:44:56.410

```
// all divs with tab_select class
$('div.tab_select')

// first div with tab_select class
$('div.tab_select:first')

// or CSS pseudo selector which is slightly faster than the first jQuery 
// shortcut 
$('div.tab_select:first-of-type')

// or
$('div.tab_select').first()

// or
$('div.tab_select:eq(0)')

// or
$('div.tab_select').eq(0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:45:29.937

如果您想要一个 jQuery 对象，请`var tmp = $("div.tab_select:first")`改用。

`var tmp = $("div.tab_select")[0]`将返回 DOM 元素（如果存在）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T19:45:54.303

做吧`$(tmp)`。[0] 为您提供 HTML 元素而不是 JQuery 实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T22:11:31.083

我在某处读到 css 选择器更快。

```
$('div.tab_select:nth-child(n)').<method> 
```

这是[例如](http://jsfiddle.net/z7CEU/)

# objective-c - 允许用户保存生成的数组字符串以供以后查看

> ID：10557621
> 
> 赞同：0
> 
> 时间：2012-05-11T19:43:46.380
> 
> 标签：objective-c, ios, xcode, xcode-storyboard

我正在创建一个从 2 个单独的 NSArrays 生成婴儿名字的小应用程序。我有 1 个名字设置和 1 个中间名设置。当按下按钮时，它会随机连接 2 个 NSString，如下代码所示：

```
int a = arc4random() % 2;
int b = arc4random() % 2;

// populate the array for the names
NSArray *firstNameArray = [NSArray arrayWithObjects: @"Anna", 
@"Amy", 
@"Amber",  nil];
NSArray *middleNameArray = [NSArray arrayWithObjects: @"Brenda", @"Beatrix", nil];

// concatenate strings at index of array
NSString *fullName = [NSString stringWithFormat:@"%@ %@", [firstNameArray objectAtIndex:a], [middleNameArray objectAtIndex:b]];

// display the newly created first & middle names

babyname.text = fullName; 
```

对于如何允许用户“收藏”特定名称并将其保存到新视图（可能是表格视图），我有点不知所措。谁能在这里指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:07:49.683

您可能想要做的是存储选定的名称，以便您以后可以参考它们。您可能希望创建一个 Person 类或类似的东西，并在其中有一个名为 favorite 的属性，它是一个 BOOL 值。然后，您只需将用户想要收藏的属性设置为 YES 即可。

存储自定义类并使其持久化的一个很好的机制是 Core Data，但它实际上取决于您将/可能拥有多少 Person 实例。一旦你掌握了核心数据，它就很容易实现，网上有很多关于如何使用它的教程。我会使用 UIDocument 和 UIManagedDocument 在 CoreData 上查看斯坦福大学的 iTunesU 视频。我发现它们很有帮助。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:02:03.983

您已经给出了一段代码，从中您的程序中的逻辑的确切流程是不可理解的，假设您有一个供用户输入的文本字段和一个将其标记为收藏的按钮，那么在按钮的操作中您可以获得来自文本字段的文本并将其存储在某个数组中。此外，您不会将数据存储在 tableview 中，而是将其显示在那里。然后，您可以使用收藏夹数组在 tableview 中显示名称。

您可以使用 NSUserDefaults、plist、sqlite、coredata 进行持久存储。NSUserDefaults 和 plist 只能有效地处理少量数据。

请在 [持久存储上查看我的链接](https://stackoverflow.com/a/10534479/936588)

[TableView 教程](http://www.icodeblog.com/2008/08/08/iphone-programming-tutorial-populating-uitableview-with-an-nsarray/)

# iphone - 轻松播放声音

> ID：10557630
> 
> 赞同：0
> 
> 时间：2012-05-11T19:44:52.537
> 
> 标签：iphone, objective-c, ios, xcode

我有一个很长的代码，主要是这个问题，大声笑。我有一个很长的代码，我在其中比较单词，当图像设置到 UIImageview 时我会播放声音。问题是其中 1 个我有 5556 个可以播放的选项，所以我必须输入我得到 5556 次的播放声音代码，这真的会让我的代码变长（如果你问的话，它已经是我）

这是代码

```
//this is no problem here are only 36 of them. 
if (aChar1 == aChar7){
    [imageview7 setImage:imageview1HG.image];
    [imageviewhidden6 setImage:imageview1H.image];
    {
//soundcode
        CFBundleRef mainBundle = CFBundleGetMainBundle();
        CFURLRef soundFileURLRef;
        soundFileURLRef =CFBundleCopyResourceURL(mainBundle, 
                                                 (CFStringRef) @"beep-7", CFSTR ("wav"), NULL);

        UInt32 soundID;
        AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
        AudioServicesPlaySystemSound(soundID);
    }

}
else if 
    (aChar1 == aChar7 && aChar2 == aChar8 && aChar3 != aChar9 && aChar4 != aChar10 && aChar5 != aChar11 &&  aChar6 != aChar12){
        //for these there are 5556 of these lines and I don't want to put that sound file in all of them any other way to do so? 
        if (aChar1 == aChar9){
            [imageview7 setImage:imageview1HO.image];
        }
        else if (aChar1 == aChar10){
            [imageview7 setImage:imageview1HO.image];
        }
        else if (aChar1 == aChar11){
            [imageview7 setImage:imageview1HO.image];                
        }
        else if (aChar1 == aChar12){
            [imageview7 setImage:imageview1HO.image];
        }
        else {
            [imageview7 setImage:imageview1H.image];}
    } 
```

对于第一个使用 imageview1HG 设置图像视图的地方，这没问题，有 36 个这样的，所以没问题，但是对于具有不同 1HO.image 的设置图像，有 5556 个，所以有一些 1 行代码像上面那样播放声音？

我在代码中添加了注释。

# javascript - 使用jquery刷新表而不通信数据库

> ID：10557632
> 
> 赞同：1
> 
> 时间：2012-05-11T19:44:57.720
> 
> 标签：javascript, jquery, ajax, servlets

我正在为 gridview 使用[DataTable](http://datatables.net/api) jquery api。我的样本如下：

![在此处输入图像描述](../Images/95bf4af6bddeba8d65b3485e9a6a34b1.png)

它在底部显示以下表格中的条目总数

```
Showing 1 to 10 of 10 entries 
```

我使用 jquery 对此 gridview 的删除代码/脚本如下：

```
$(document).ready(function()
{
    $('table#example td a.delete').click(function()
    {
        if (confirm("Are you sure you want to delete this row?"))
        {
            $getCode = $(this).parent().parent().attr('id');
            var parent = $(this).parent().parent();
            $.post("DeleteDepartment", {
                depID:$getCode                   
            }, function(data) {
                if(data.result >0){
                    parent.fadeOut('slow', function() {$(this).remove();});
                }else{
                    alert("Operation Fail");
                }
            });
        }
        else{
            $('div#feedback').html('<div class="cancel"><b>Operation Cancel</b></div>');

        }
    });
}); 
```

上面的代码成功地从网格视图中删除了记录。但它没有显示实际总数。条目，删除后。

例如，表中当前有 10 条记录，它以如下格式显示在底部：

```
Showing 1 to 10 of 10 entries 
```

当我删除一个条目时，它必须显示新的条目总数

```
Showing 1 to 9 of 9 entries (total entry decrease by one, on every deletion ) 
```

**我如何刷新表，而不用通信**重置条目总数的数据库，在每次删除时显示底部左侧

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T19:52:09.630

使用 DataTable API 删除行。

[http://datatables.net/api](http://datatables.net/api)

```
$(document).ready(function() {
  var oTable = $('#example').dataTable();

  // Immediately remove the first row
  oTable.fnDeleteRow( 0 );
} ); 
```

或者在你的情况下，

```
oTable.fnDeleteRow( $(this).index() ); 
```

假设您对 dataTable 数据对象使用相同的名称。

**编辑**
更好：

```
oTable.fnDeleteRow( this ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T13:53:23.297

代码，当点击最后一个“td”时 -

[http://www.datatables.net/forums/discussion/comment/32737#Comment_32737](http://www.datatables.net/forums/discussion/comment/32737#Comment_32737)

* * *

```
$("#ffetch tbody tr td:last-child").live('click', function(s) {
     var row = $(this).closest('tr');
     var nRow = row[0];
     $('#ffetch').dataTable().fnDeleteRow( nRow );
}); 
```

# java - 开始使用 DropboxAPI，找不到类

> ID：10557633
> 
> 赞同：3
> 
> 时间：2012-05-11T19:44:58.777
> 
> 标签：java, android, dropbox

我第一次尝试使用 Dropbox API，但在启动我的应用程序时出现此错误。

```
Caused by: java.lang.NoClassDefFoundError: com.dropbox.client2.session.Session$AccessType 
```

我在 Dropbox 论坛上看到一个有同样问题的人，解决方案是将类路径重命名为 libs/ 而不是 lib/。我做到了，但没有工作。

我在这里得到错误：

```
final static private AccessType ACCESS_TYPE = AccessType.APP_FOLDER; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-12T12:50:35.420

当我通过以下方式导入dropbox jar时出现此问题：eclipse项目菜单->构建路径->配置构建路径->库->添加外部JAR；

之后，我恢复更改，在项目资源管理器中创建文件夹“libs”，在“libs”文件夹菜单中选择“导入...”-> 文件系统。选择路径并将所有 jar 导入到“libs”项目文件夹中。问题消失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T19:09:50.160

我的错误，问题是classPath。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T15:36:21.853

在它工作之前，我必须在 lib 和 libs 文件夹中添加所有参考库，所以显然有问题，并且由于某种原因它需要 lib 文件夹中的 apache-mime4j-0.6，但是来自 Dropbox 的示例项目如何实现不是吗？Dropbox 团队的人可以考虑一下吗？注意：该应用程序使用了以前不推荐使用的 api，当我尝试用最新的更新它时，我得到了这个错误。

> java.lang.NoClassDefFoundError: com.dropbox.client2.session.Session$AccessType

在

```
private AccessType ACCESS_TYPE = AccessType.APP_FOLDER; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T10:19:46.173

为 dropbox 设置 jar 文件的步骤。

```
u must add dropbox-android-Sdk.jar file as library.

Add to build path and then go to properties.

go in java build path and click order and export and click that dropbox-android-sdk.jar file.

u can also add jar and locate your dropbox-android-sdk.jar file and then ok. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-08T07:23:08.443

在 Eclipse (Luna) 中工作，我可以通过 Project->Properties->Java Build Path->Order And Export 解决该错误，然后在两个 Dropbox jar 文件上打勾（在我的情况下为 Dropbox 1.6.3）。其次是通常的干净项目并运行。
这可以通过从“订购和导出”对话框中的框中删除复选标记来重现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-01T08:20:06.257

请检查项目库的名称，正确的名称是 libs。[![在此处输入图像描述](../Images/f336741d9ca9d43c87d09925b27ecd45.png)](https://i.stack.imgur.com/WE1SH.png)

# asp.net-mvc - ASP.NET MVC。阅读和写作饼干

> ID：10557636
> 
> 赞同：3
> 
> 时间：2012-05-11T19:45:09.820
> 
> 标签：asp.net-mvc, cookies

HttpRequestBase 和 HttpRequest 中的 Cookies 集合有什么区别吗？

HttpResponseBase 和 HttpResponse 中的 Cookies 集合有什么区别吗？

如果将cookie添加到HttpResponseBase，可以使用HttpRequst或HttpResponse检索吗？

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:46:00.007

**HttpRequestBase 和 HttpRequest 中的 Cookies 集合有什么区别吗？**

不

**HttpResponseBase 和 HttpResponse 中的 Cookies 集合有什么区别吗？**

不

**如果将cookie添加到HttpResponseBase，可以使用HttpRequst或HttpResponse检索吗？**

是（如果您将其添加到响应中，它将**在下一个**请求中可用）

ASP 和 MVC cookie 是相同的。

# facebook - iPhone iOS Safari 浏览器中的 Facebook 评论社交插件的字体和宽度都很小

> ID：10557638
> 
> 赞同：1
> 
> 时间：2012-05-11T19:45:11.283
> 
> 标签：facebook, facebook-comments

我在 iPhone iOS Safari 浏览器中使用标准的 Facebook 评论社交插件，但它的字体和宽度非常小。

```
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="fb-comments" data-href="http://example.com" data-num-posts="5" mobile="true"></div> 
```

直接设置移动属性也没有帮助。

有人知道解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T15:24:01.630

我在我的 HTML 网页中遗漏了这个声明：

```
<head>
<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
</head> 
```

添加语句后，Facebook 评论小部件自动调整为 iOS Safari 浏览器。

# ios - 底部的 iOS 中心文本

> ID：10557640
> 
> 赞同：0
> 
> 时间：2012-05-11T19:45:12.690
> 
> 标签：ios, text, label, vertical-alignment

我有一个使用以下方式创建的标签：

```
UILabel *label = [[UILabel alloc] initWithFrame:cell.contentView.bounds];
label.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
label.textAlignment = UITextAlignmentCenter; 
```

我想将标签底部居中并水平居中。我在 typedef 枚举中没有找到任何 UITextAlignmentBottom。

有人可以提出解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T04:09:25.847

要将文本“对齐”到底部，您需要将 UILabel 设置为它需要显示的文本的高度 - Google `UILabel sizeToFit`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T04:14:23.807

我不完全确定“在标签底部居中”是什么意思，但我想你可能会问如何在它所在的视图控制器底部居中标签。要做到这一点，您将需要添加一些`NSLayoutConstraint`s 来指定您希望标签在窗口中的位置。

要以编程方式执行此操作，您将使用`constraintWithItem:attribute:relatedBy:toItem:attribute:multiplier:constant:`. “attribute”参数指的是`NSLayoutAttribute`，可以设置为`NSLayoutAttributeCenterX`尝试使标签居中，并`NSLayoutAttributeBottom`指定标签和视图控制器底部之间的空间量。

# ruby-on-rails - 3 个连接在轨道上的模型找到超过 3 个

> ID：10557641
> 
> 赞同：0
> 
> 时间：2012-05-11T19:45:13.657
> 
> 标签：ruby-on-rails, dataset, rails-activerecord

我们有 3 个模型模型 1、模型 2、模型 3。这 3 个与

```
class Model1 < ActiveRecord::Base
  has_many :model2s
end
class Model2 < ActiveRecord::Base
  belongs_to :model1s
  has_many :model3s
end
class Model3 < ActiveRecord::Base
  belongs_to :model2s
end 
```

在 Model1 的表中存在 id。

Model2的表中存在id和model1_id。

Model3的表中存在id和model2_id。

现在我想从 Model3Controller 的 table1 和 table2 中获取数据。这工作正常。

```
class Model3Controller < ApplicationController
  def create
    @model2controller = Model2.find(params[:model3controller][:model2_id])
    @model1controller = ?
  end
end 
```

我们如何从 model1controller 的 table1 中获取相关数据集的数据？我们是否必须将 model1_id 添加到 table3 中，或者我们可以以其他方式调用它。像这个伪代码

```
@model1controller = Model1.find(
params[:model3controller][:model2_id]params[:model2controller][:model1_id]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:52:28.640

我可能遗漏了一些东西，但看起来您应该只执行以下操作：

```
model1 = Model3.find_by_id(params[:model3_id]).model2.model1 
```

**编辑**. 上面的代码就像下面几行一样工作：

```
model3 = Model3.find_by_id(params[:model3_id]) # instantiate a model3

model2 = model3.model2 # from mode3 grab a model2
                       # this is possible due to the fact that model3 is associated with model2 via the belongs_to relation

model1 = model2.model1 # model2 "belongs_to" model1, i.e. we can grab model1 by asking model2: "whom do belong to?" just like in the previous example 
```

**请注意**，实例上的访问方法是以小写形式调用的，即

```
object.method # => something is returned 
```

在您的示例中，您犯了错误，调用`Model3.find_by_id(params[:id]).Model2`（注意 中的大写字母`Model2`，这是错误的）

另外，检查 params[:id] 是否真的被传递给控制器​​动作。否则，如果它不存在，`Model3.find_by_id(params[:id])`将返回`nil`，因此将引发提到的错误。

# c# - 如何改进此排序代码？

> ID：10557648
> 
> 赞同：6
> 
> 时间：2012-05-11T19:45:56.443
> 
> 标签：c#, .net, linq

我正在检查排序参数并构建一堆`if`语句：

```
if (sortDirection == "ASC")
{
    if (sortBy == "Id")
        return customerList.OrderBy(x => x.Id).Skip(startIndex).Take(pageSize).ToList();
    if (sortBy == "FirstName")
        return customerList.OrderBy(x => x.FirstName).Skip(startIndex).Take(pageSize).ToList();
    if (sortBy == "City")
        return customerList.OrderBy(x => x.City).Skip(startIndex).Take(pageSize).ToList();
}
else
{
    if (sortBy == "Id")
        return customerList.OrderByDescending(x => x.Id).Skip(startIndex).Take(pageSize).ToList();
    if (sortBy == "FirstName")
        return customerList.OrderByDescending(x => x.FirstName).Skip(startIndex).Take(pageSize).ToList();
    if (sortBy == "City")
        return customerList.OrderByDescending(x => x.City).Skip(startIndex).Take(pageSize).ToList();
} 
```

我怎样才能使它变得更好？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T19:50:04.950

将您的排序和查询的其余部分分开 - 对于您不必在代码库中复制的每个查询的相同部分（保持[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)）：

```
var query = customerList;

if (sortDirection == "ASC")
{
    if (sortBy == "Id")
       query = query.OrderBy(x => x.Id);
    ///and so on
}

query = query.Skip(startIndex).Take(pageSize).ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:50:35.323

使用反射:)

```
customerList = (sortDirection == "ASC")
   ? customerList
        .OrderBy(x => x.GetType().GetProperty(sortBy).GetValue(x, null))
        .Skip(startIndex)
        .Take(pageSize)
        .ToList()
   : customerList
        .OrderByDescending(x => x.GetType().GetProperty(sortBy).GetValue(x, null))
        .Skip(startIndex)
        .Take(pageSize)
        .ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T19:52:34.920

看起来您只是想按属性名称作为字符串进行排序。在这种情况下，这实际上已经通过使用“Dynamic LINQ”解决了：

[IEnumerable<T> 上的动态 LINQ OrderBy](https://stackoverflow.com/questions/41244/dynamic-linq-orderby)

看看这个问题的答案，它应该为您提供示例代码来解决您的问题。

# php - 如何让 PHP 在命令行中再次工作？

> ID：10557650
> 
> 赞同：15
> 
> 时间：2012-05-11T19:46:03.463
> 
> 标签：php, command-line, osx-lion

我在这里完全不知所措，即将擦干净我的硬盘驱动器并从全新的操作系统安装开始。试了两天在终端新建一个yii应用，终于发现终端或者命令行一下子连PHP都执行不了了。我过去从命令行创建执行 php 没有问题，但现在它不起作用。当我输入**which php**我什么也得不到。当我输入**php -v**我得到：

```
 -bash: php: command not found. 
```

当我尝试创建一个新的 yii 应用程序时，我得到：

```
env: php: No such file or directory 
```

我正在使用 mac osx-lion，目前我的路径如下所示：

```
/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/usr/local/git/bin 
```

我试过浏览 php 手册，但我无处可去。如何重新配置​​命令行以执行 php？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-12T15:32:39.837

希望这可以为人们省去很多麻烦。如果由于某种原因，您无法在命令行中找到 php，并且无法从命令行执行 php，以下是让 PHP 重新启动并运行的步骤列表。

1.  仔细检查以确保通过打开终端并键入 `find /usr -name php`并按 Enter 键找不到 PHP。您要在这里寻找的主要内容是`/bin/php`最后的路径。就我而言，现在我已经安装了它，它是`/usr/local/php5-20120508-102213/bin/php`. 如果您没有看到类似的内容，请转到下一步。如果您看到类似的内容，请记下该路径`/bin/php`的末尾，然后转到第 4 步。

2.  转到终端并输入`curl -s http://php-osx.liip.ch/install.sh | bash -s 5.4`，按回车键。它会询问您的密码。您正在安装一个 php 包。输入密码后，只需按照任何其他下载的步骤操作即可。有关该下载的更多信息，您可以访问[二进制包网站。](http://php-osx.liip.ch/)

3.  安装 php 后，打开终端并输入`find /usr -name php`并回车。您应该看到几行路径。记下`/bin/php`路径尽头的那个。下一步您将需要该路径。

4.  接下来，打开一个文本编辑器，我为此使用了 TextWrangler，在菜单栏上打开文件，然后选择按名称打开文件。然后输入`~/.bash_profile`. 选择打开并在 .bash_profile 文件的末尾键入

    ```
    PATH=$PATH:/usr/local/php5-20120508-102213/bin/
    export PATH 
    ```

    这`/usr/local/php5-20120508-102213/bin/`部分是我提到要记下的路径，减去最后的 php。如果您的路径不同，请替换它。只记得最后离开php。保存并退出。

5.  最后一步，打开终端并输入`php -v`. 点击进入。您应该会看到如下内容：

    ```
    PHP 5.4.2 (cli) (built: May  8 2012 09:48:57) 
    Copyright (c) 1997-2012 The PHP Group
    Zend Engine v2.4.0, Copyright (c) 1998-2012 Zend Technologies
    with Xdebug v2.2.0rc2, Copyright (c) 2002-2012, by Derick Rethans 
    ```

    如果您看到，那么一切正常。

> **注意：**这里是使用[命令行 PHP](http://www.sitepoint.com/getting-started-with-pear/)的一个很好的资源- 位于页面下方约 1/3 处。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-11T19:52:57.320

这里发生了两件事之一，要么您没有安装 PHP，要么安装了 PHP，但当前不在任何系统感知路径中。首先，我会尝试找到 PHP 并确保它存在：

```
$ find / -name php -type f 
```

您应该会看到如下内容：

```
/path/to/your/php/bin/php 
```

如果 PHP 二进制文件确实存在，请检查您的路径：

```
$ echo $PATH 
```

如果不存在，重新编译php。

如果您的系统上存在 PHP，请确保包含 /bin/php 文件的路径。您可以`~/.bash_profile`像这样编辑并添加自定义路径：

```
PATH=$PATH:/path/to/your/php/bin/
....  
export PATH 
```

然后保存并重新加载文件以确保您当前的会话可以访问新的路径更改：

```
$ source ~/.bash_profile 
```

运气好的话，您现在可以执行 a`php -v`并查看版本响应。

**- 更新 -**

设置实际路径：

```
$ vi ~/.bash_profile

...
# Add your custom php path
PATH=$PATH:/bitnami/mampstack-osx-x86/output/php/bin/
....  
export PATH 
```

保存并关闭，然后获取它：

```
$ source ~/.bash_profile 
```

现在您应该能够从 cli 运行 PHP：

```
$ php -v 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-09-10T03:43:18.360

**（在 macOS Mojave 10.14.6 上）**

上面提到的“源”命令的快捷方式就是句号。因此，您可以执行以下操作：

```
vi ~/.bash_profile 
```

在行中添加

```
export PATH="/usr/local/opt/php@7.3/bin:$PATH"
export PATH="/usr/local/opt/php@7.3/sbin:$PATH" 
```

按冒号 W`:w`编写和冒号 Q`:q`退出 VIM 编辑器*（奖励学习）*

现在你通过进入终端“应用”它：`. ~/.bash_profile`

`php -v`您现在可以使用或仔细检查新的 PHP 版本`which php`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-20T23:43:47.613

作为对@MikeTheCoder 的回应，发布的导出路径语法对我不起作用，但稍作修改的以下语法可以：

```
export PATH=/usr/local/php5-5.6.27-20161101-100213/bin/:$PATH 
```

我正在使用默认为早期 PHP 版本的 El Capitan 10.11.6。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-06T18:45:55.947

关闭您的 ssh 隧道并再次重新启动 PHP 正在返回并检查`$ php --version`

然后键入命令行 sudo apt-get install php-fpm 或使用“sudo apt-cache search php”搜索最新版本的 php，然后找到 php-fpm 或 php-{version}-fpm 并使用以下命令 sudo service php-fpm 重启

# c - valgrind/memcheck 无法释放“大”内存块

> ID：10557654
> 
> 赞同：1
> 
> 时间：2012-05-11T19:46:40.957
> 
> 标签：c, valgrind

考虑这个小程序：

```
#include <stdio.h>
#include <stdlib.h>

// Change 60000 to 70000 and valgrind (memcheck) eats my memory
#define L (60000)
#define M (100*(1<<20))

int main(void) {
  int i;
  for (i = 0; i < M; ++i) {
    unsigned char *a = malloc(L);
    a[i % L] = i % 128; // Touch something; a[0] is not enough
    free(a);
    if (i % (1<<16) == 0)
      fprintf(stderr, "i = %d\n", i);
  }
  return 0;
} 
```

编译`gcc -o vg`和运行`valgrind --leak-check=full ./vg`工作正常，memcheck 使用了大约 1.5% 的内存。但是，将 L 更改为 70000（我想魔法限制是 1<<16），memcheck 使用的内存量不断增加，直到内核最终杀死它。

有什么可以做的吗？显然没有泄漏，但 valgrind 本身似乎存在泄漏（！？），因此很难用于检查具有大量大型和短期分配的程序。

一些背景，不确定哪个是相关的：

```
$ valgrind --version
valgrind-3.7.0
$ gcc --version
gcc (GCC) 4.4.6 20110731 (Red Hat 4.4.6-3)
$ /lib/libc.so.6
GNU C Library stable release version 2.12, by Roland McGrath et al.
$ uname -rms
Linux 2.6.32-220.2.1.el6.x86_64 x86_64 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T15:48:28.320

这很可能是由 valgrind 3.8.0（尚未发布）中绕过的 gcc 4.4 错误引起的

从 Valgrind 3.8.0 NEWS 文件中提取：

ni-bz 绕过 gcc4.4/4.5 错误代码生成导致内存不足或断言

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:02:58.630

使用将进程的资源限制设置为无限制，`setrlimit`这样内核就不会在超出限制时终止您的进程。因此内核认为你可以扩展到虚拟地址空间。

希望这可以帮助。

# c# - 替换数组中的值

> ID：10557657
> 
> 赞同：2
> 
> 时间：2012-05-11T19:46:49.303
> 
> 标签：c#, mongodb

我正在使用 Mongodb C# 官方驱动程序。我想用其他值更改数组中的特定值。该数组包含值列表。例如。

```
{ 
   _id: id1,
   values: [23, 78, 20]
} 
```

我想用 25 替换 23。如果它是正确的，我知道一个答案。首先我拉那个元素，然后推另一个。但问题是如果元素不存在，那么 push 也会插入元素。其次，它会改变位置并在最后插入元素。请告诉我该怎么做。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T20:18:30.227

你应该使用这个：

```
db.collection.update({_id: id1, values: 23}, {$set: {'values.$': 25}}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T20:24:35.860

这应该对你有用

```
db.collection.update({ "_id" : id1 }, {$set: {"values.0": 23}}); 
```

也检查这篇文章 [使用 c-driver 按索引更新 mongo 数组元素](https://stackoverflow.com/questions/9542635/update-mongo-array-elements-by-index-with-c-driver)

# jquery - jQuery 如果 url 匹配

> ID：10557658
> 
> 赞同：2
> 
> 时间：2012-05-11T19:46:50.210
> 
> 标签：jquery

我想达到这样的目标：

```
if(window.location.href.indexOf("http://stackoverflow.com/questions/")){
 ... then to this
} 
```

但是当 url 看起来像这样时它仍然运行`http://stackoverflow.com/questions/ask/`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-11T19:48:22.513

```
if(window.location.href === "http://stackoverflow.com/questions/"){
    ... then to this
} 
```

# mfc - 如何隐藏选项卡式文档上的图标

> ID：10557659
> 
> 赞同：0
> 
> 时间：2012-05-11T19:46:54.303
> 
> 标签：mfc, tabs, icons

我有一个选项卡式文档，它是 CMultiDocTemplate 类的扩展类。显示时，选项卡本身的文本旁边会出现一个图标。

我找到了显示的实际图标，当我注释掉引用它的行时，会显示一个默认图标。

如何抑制此图标的显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T16:05:02.860

> 我有一个选项卡式文档，它是 CMultiDocTemplate 类的扩展类

什么是“CMultiDocTemplate 的扩展类”？**它是从**CMultiDocTemplate派生的类吗？

如果您使用自定义代码来控制任何人如何在不知道代码的情况下回答有关它的问题。

您能否提供更详细的信息，可能是代码片段和最理想的示例应用程序，以证明您的问题。

# matrix - 处理存储要求超过 RAM 的阵列的技术

> ID：10557660
> 
> 赞同：1
> 
> 时间：2012-05-11T19:46:55.750
> 
> 标签：matrix, fortran, libraries

我是一个在网格基础上执行计算的科学应用程序的作者（想想有限差分网格计算）。每个网格单元由一个数据对象表示，该数据对象保存状态变量和单元特定常量的值。到目前为止，所有网格单元对象在模拟期间一直存在于 RAM 中。

我遇到的情况是，使用我的代码的人希望使用比可用 RAM 更多的网格单元来运行它。我正在考虑修改我的代码，以便在任何给定时间仅将单元子集的信息保存在 RAM 中。不幸的是，网格（或矩阵，如果您愿意）*不是*稀疏的，这消除了一整类可能的解决方案。

**问题：**我假设在野外有一些库旨在促进这种类型的数据访问（即检索常量和变量，更新变量，存储以供将来参考，擦除内存，继续......）经过几个小时的谷歌搜索和 Stack Overflow，我发现这类库相对较少。

我知道一些选项，例如 HSL 数学库中的这个选项：[http](http://www.hsl.rl.ac.uk/specs/hsl_of01.pdf) ://www.hsl.rl.ac.uk/specs/hsl_of01.pdf 。我更喜欢使用开源并用 Fortran 或 C 编写的东西。（我的代码主要是 Fortran 95/2003，加入了一点 C 和 Python 来很好地衡量！）

我将不胜感激有关可用库的任何建议或有关如何重新表述我的问题的建议。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:16:53.767

咬紧牙关，自己动手？

我一直在处理过大的数据，例如跨越数十年的 30,000 多个数据系列的半小时数据。由于数据的规律性（虽然夏令时转换是一个问题），事实证明设计一个涉及随机访问磁盘文件和过程 ReadDay 和 WriteDay 的方案非常简单，它们使用序列号和天数，并提供更多详细信息，因为系列开始和停止在不同的日期。因此，数组中的一天数据可能是 Array(Run,DayNum) 但现在是 ReturnCode = ReadDay(Run,DayNum,Array) 等等，这些代码表示当天数据的存在/不存在等。关键是一天的数据是一个方便的大小，并且是常规（几乎）大小，虽然我的 prog. 为每个系列分配一条记录的缓冲区，它在约 100MB 的内存而不是 GB 中运行。

因为您的数组是非稀疏的，所以它是规则的。假设网格单元格的数据是固定大小的，您可以设计一个随机访问磁盘文件，其中每个记录包含一个单元格，或者可能是一行的单元格（或列的单元格）或一些有价值的 blob 大小。我选择 4,096 字节/记录，因为这是磁盘文件分配大小。让计算机的操作系统和磁盘存储控制器做任何他们觉得可以缓冲到真实内存的事情。然而，典型的执行受限于数据传输的速度，除非本地数据的计算量很大。因此，在缓冲区开始满足数据请求之前，我会使用几个百分比的 cpu。

因为 fortran 对函数使用与数组相同的语法（不像 Pascal），而不是声明 DIMENSION ARRAY(Big,Big)，您将删除它并设计 FUNCTION ARRAY(i,j)，并且源文件中的所有读取引用都保留像他们那样。唉，在没有“回文”函数声明的情况下，必须使用不同的语法将值分配给数组，并且您需要设计一个子程序或类似的程序。可能可以整理一个暂存器数组，使用方便的语法对其进行处理，然后在更改时写回。

# c++ - delete[] 如何跟踪元素的数量？

> ID：10557664
> 
> 赞同：0
> 
> 时间：2012-05-11T19:47:15.930
> 
> 标签：c++, memory-management

> **可能重复：**
> [delete[] 如何“知道”操作数数组的大小？](https://stackoverflow.com/questions/197675/how-does-delete-know-the-size-of-the-operand-array)
> [C++中的delete怎么知道要删除多少内存位置](https://stackoverflow.com/questions/2327848/how-does-the-delete-in-c-know-how-many-memory-locations-to-delete)

我知道这是一个相当简单的问题，但我不确定这行之间的区别（如果有的话）：

```
double * a = new double[100];
delete[] a;
delete a;
free ((void*)a); 
```

首先，所有这些调用（在没有其他调用的情况下使用每个调用）是否以相同的方式工作并释放 sizeof(double)*100 字节？这让我想到了第二个问题，程序如何跟踪分配内存的大小？例如，如果我将`a`指针发送到一个函数，那么`delete[]`我的函数中的这个指针，我是否也会释放相同数量的内存？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:51:52.200

过于简单化的区别在于：

```
delete[] a; 
```

是正确的。所有其他都是不正确的，并且会表现出未定义的行为。

现在，实际上，在我每天使用的所有编译器上，`delete a;`每次都会做正确的事情。但你仍然不应该这样做。未定义的行为*永远不会*正确。

该`free`调用也可能在现实世界中做正确的事情，但这只是因为您要释放的东西没有非默认析构函数。例如，如果您尝试`free`使用带有析构函数的类，它肯定不会工作——析构函数永远不会被调用。

`new`这是/`delete`和`malloc`/之间最大的区别之一（不是唯一的区别）`free`——前者调用构造函数和析构函数，而后者只是分配和释放空间。

合并@Rob 在他现已删除的帖子中所说的内容：

> 简单的规则是：每个 new[] 都需要一个 delete[]。每一个新的都需要一个删除。malloc 需要免费的。不允许混搭。

至于如何`delete[]`知道要删除多少个元素的问题，请参阅[对](https://stackoverflow.com/a/197699/241536)上一个重复问题的回复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:03:25.877

关于双精度数组，所有形式的结果都是一样的——所有分配的内存都返回给系统。call `free`vs. `delete`vs.的区别`delete[]`在于：

*   `free`仅释放内存（分配的内存大小`a`由内存管理器在调用时存储`new`）
*   `delete`在释放内存之前调用已分配对象的析构函数
*   `delete[]`在释放内存之前调用数组中每个元素的析构函数

如果分配对象的析构函数包含释放其他内存或系统资源（例如在对象生命周期内分配的文件或套接字描述符）的清理代码，则差异很重要。

无论析构函数的内容如何，​​始终`delete`在单个实例和对象/基元数组上使用是 C++ 的一个好习惯。`delete[]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T19:56:49.330

有人纠正我，如果我错了，但据我了解，您在`delete`之前使用. 并且在您使用. `new``delete[]``new Type[]``free``malloc`

[请参阅关于delete](http://www.cplusplus.com/search.do?q=delete)和[free](http://www.cplusplus.com/reference/clibrary/cstdlib/free/)的 c++ 参考。

# css - 左/右浮动的 div 与居中的 img 一起表现得很有趣

> ID：10557666
> 
> 赞同：-1
> 
> 时间：2012-05-11T19:47:20.327
> 
> 标签：css, html

这是[jsFiddle](http://jsfiddle.net/PtVVD/)中的代码。

不知道是什么导致右箭头按钮跳下。如果我删除图像，它就在它应该在的地方。错误在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:49:48.800

将右侧浮动元素放在左侧和中心项之前。先向右浮动，再向左浮动。

[**更新的小提琴**](http://jsfiddle.net/PtVVD/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:52:17.373

只需像这个小提琴一样替换图像的顺序和右箭头：http: [//jsfiddle.net/PtVVD/5/](http://jsfiddle.net/PtVVD/5/)

# c# - 服务契约中的构造器逻辑

> ID：10557667
> 
> 赞同：2
> 
> 时间：2012-05-11T19:47:26.870
> 
> 标签：c#, wcf, servicecontract

我有一份服务合同：

```
[DataContract]
public class Something
{
    [DataMember]
    public MyEnum SomeEnumMember {get;set;}
} 
```

我们的一些开发人员正在做这样的事情：

```
public Something()
{
    SomeEnumMember = MyEnum.SecondEnumValue;
} 
```

我认为构造函数逻辑不属于我们的服务合同，因为如果您使用“添加服务引用...”并且正在使用由 Visual Studio 生成的代理类，该代码将不起作用。

在内部，我们使用 Castle DynamicProxy，如下[所示](http://brandonzeider.me/2011/microsoft-net/building-a-reusable-service-client/)。但是，我希望我们的开发人员避免在服务合同类中使用构造函数逻辑，以防我们由于某种原因无法使用 DynamicProxy。

那么：构造函数逻辑是否在这些类中占有一席之地，或者作为最佳实践，我们应该将它们视为更多的 DTO 并在没有行为的情况下实现它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:06:28.767

只有在首先创建对象以通过您的服务进行传输时，它才会有所不同。如果您希望`SomeEnumMember`在实例化时使您的默认值不同以方便传输，则可能有意义：

```
var mySomething = new Something();
mySomething.SomeEnumMember = MyEnum.SecondEnumValue; //this line may be omitted if it's set automatically by the constructor
SendData(mySomething); 
```

在接收方，这不会有任何区别，因为值（我认为，并且来自您的测试）无论如何都是由发件人明确设置的。此外，接收器实例化/反序列化对象将是额外/浪费的工作，但很可能这是可以忽略不计的开销。

通常，您的数据传输对象无论如何都不应该包含逻辑。也许取决于您的应用程序架构，如果您在很多地方使用这个对象而不只是传输信息，这可能是有意义的。尽管我会质疑该架构：我喜欢将与客户端-服务器通信相关的对象从我的应用程序架构的其余部分中抽象出来。这样我就可以自由地对其进行更改（专门的序列化、架构更改等），而不会严重影响我的其余应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T19:55:32.713

我同意你的看法，我认为构造函数逻辑不属于那里，而且我从未真正使用过其中包含构造函数逻辑的 wcf。

# asp.net-mvc - 在 WebForms 中集成 MVC

> ID：10557669
> 
> 赞同：3
> 
> 时间：2012-05-11T19:47:30.320
> 
> 标签：asp.net-mvc, visual-studio-2010

根据[http://www.codeproject.com/Articles/38778/ASP-NET-WebForms-and-ASP-NET-MVC-in-Harmony](http://www.codeproject.com/Articles/38778/ASP-NET-WebForms-and-ASP-NET-MVC-in-Harmony)

我对我的 WebForms 项目进行了以下更改：

1.  添加了 System.Web.Mvc.dll
2.  添加了 System.Web.Abstractions.dll
3.  创建控制器和视图文件夹
4.  在我的调试部分添加了这些程序集
5.  将 MVC、MVC.Ajax、MVC.HTML 添加到我的页面->命名空间
6.  添加 Web.Routing.UrlRoutingModule 作为 HttpModule
7.  已注册的测试路线

但是在“让 Visual Studio 提供 MVC 项目”部分我没有卸载项目选项，也没有 csproj 文件。我只有 .sln 和 .sln.DotSettings.user

我可以添加视图但不能添加控制器，为什么，有什么建议吗？ [http://prntscr.com/94imo](http://prntscr.com/94imo)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T16:09:54.640

既然您写道您没有 csproj 文件，我猜您拥有的是 WebForms 网站而不是 WebApplication 项目。

我快速浏览了您发布链接的教程，似乎没有提到该步骤，但是当我上次将 WebForms 网站转换为 MVC WebApplication 时（诚然，这是不久前）我不得不转换它首先到一个 WebForms WebApplication 项目。

# sql - SQL查询 - 如何获取表中的计数

> ID：10557670
> 
> 赞同：0
> 
> 时间：2012-05-11T19:47:30.600
> 
> 标签：sql

我有一个表 X，其中有一个名为 version 的列，其中有 4-5 个值，例如 1,2,3,4,5

如果列值是 1 或 3，那么我很好，否则就是错误

## 问题

什么是查询，所以我想要这样的输出

值的总数 | 总好即价值是 (1,3) | 总失败即值不在 (1,3)

有人可以帮我查询吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T19:52:30.823

你可以试试这个：

```
select count(*) as TotalValues
  , (select count(*) from test where id in(1, 3)) as TotalGood
  , (select count(*) from test where id not in (1, 3)) as TotalFailed
from test 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!3/ff90b/6)

根据您的评论，如果您需要百分比，您将使用此：

```
SELECT TotalValues
  , TotalGood
  , TotalFailed
  , Cast(TotalGood as decimal(10, 2))/Cast(TotalValues as decimal(10, 2)) as PercentGood
FROM 
(
  select count(*) as TotalValues
    , (select count(*) from test where id in(1, 3)) as TotalGood
    , (select count(*) from test where id not in (1, 3)) as TotalFailed
  from test
) x 
```

# c# - 初始化表适配器行

> ID：10557675
> 
> 赞同：1
> 
> 时间：2012-05-11T19:47:49.193
> 
> 标签：c#, asp.net

是否可以初始化表适配器行？我创建了以下代码；从控件名称的重复重构为使用 FindControl 递归查找控件：

```
private int _category;
private int _max;
private string _queryString;
private int _pageStart;
private const int PageSize = 4;
private void PopulatePage(string s)

{
    using (var projectTableAdapter = new ProjectTableAdapter())
    {
        _max = s == "category" ? projectTableAdapter.GetDataByCategory(_category).Count : PageSize;
        double totalPages = Math.Ceiling((float) _max/PageSize);

        int start = (_pageStart - 1) * PageSize;
        var end = _pageStart * PageSize;

        if (end > _max) end = _max;

        for (int i = start; i < end; i++)
        {
            int tmp = i - start;
            int c = tmp + 1;

            var image = FindControl(string.Format("ctl00$Body$ControlImage{0}", c)) as Image;
            var title = FindControl(string.Format("ctl00$Body$ControlTitle{0}", c)) as Literal;
            var summary = FindControl(string.Format("ctl00$Body$ControlSummary{0}", c)) as Literal;
            var link = FindControl(string.Format("ctl00$Body$ControlLink{0}", c)) as HyperLink;
            var listitem = FindControl(string.Format("ctl00$Body$ControlListItem{0}", c)) as HtmlGenericControl;

            switch (s)
            {
                case "category":
                    DataConnection.ProjectRow projectRowCategory =
                        projectTableAdapter.GetDataByCategory_Active_RankOrder(_category)[i];

                    if (image != null) image.ImageUrl = projectRowCategory.Image;
                    if (title != null) title.Text = projectRowCategory.Name;
                    if (summary != null) summary.Text = projectRowCategory.Summary;

                    if (projectRowCategory.Description.Length > 0)
                    {
                        if (link != null)
                        {
                            link.NavigateUrl = string.Format("/experience/details/?id={0}",
                                                             projectRowCategory.ProjectID);
                            link.Visible = true;
                        }
                    }
                    break;
                case "random":
                        DataConnection.ProjectRow projectRowRandom = projectTableAdapter.GetDataByRandom()[i];

                        if (image != null) image.ImageUrl = projectRowRandom.Image;
                        if (title != null) title.Text = projectRowRandom.Name;
                        if (summary != null) summary.Text = projectRowRandom.Summary;

                        if (projectRowRandom.Description.Length > 0)
                        {
                            if (link != null)
                            {
                                link.NavigateUrl = string.Format("/experience/details/?id={0}",
                                                                 projectRowRandom.ProjectID);
                                link.Visible = true;
                            }
                        }
                    break;
            }

            if (listitem != null) listitem.Visible = true;
        }

        if ((Request.QueryString["p"] == null) || (Request.QueryString["p"] == "1"))
        {
            if (_max < PageSize)
            {
                ControlPage.Text = "";
            }
            else
            {
                ControlPage.Text = "<< prev | <a href = \"?s=" + _queryString + "&p=2\">next >></a>";
            }
        }
        else
        {
            int next = _pageStart + 1;
            int prev = _pageStart - 1;
            if (next > totalPages)
            {
                ControlPage.Text = string.Format(@"<a href = ""?s={0}&p={1}""><< prev</a> | next >></a>",
                                                 _queryString, prev);
            }
            else
            {
                ControlPage.Text =
                    string.Format(
                        @"<a href = ""?s={0}&p={1}""><< prev</a> | <a href = ""?s={0}&p={2}"">next >></a>",
                        _queryString, prev, next);
            }
        }
    }
} 
```

我现在想重构并删除 SWITCH 语句中的代码重复。所以我可以做类似的事情：

```
var projectRow = new DataConnection.ProjectRow();

            switch (s)
            {
                case "category":
                        projectRow = projectTableAdapter.GetDataByCategory_Active_RankOrder(_category)[i];
                    break;
                case "random":
                        projectRow = projectTableAdapter.GetDataByRandom()[i];
                    break;
            }

            if (image != null) image.ImageUrl = projectRow.Image;
            if (title != null) title.Text = projectRow.Name;
            if (summary != null) summary.Text = projectRow.Summary;

            if (projectRow.Description.Length > 0)
            {
                if (link != null)
                {
                    link.NavigateUrl = string.Format("/experience/details/?id={0}",
                                                     projectRow.ProjectID);
                    link.Visible = true;
                }
            }

            if (listitem != null) listitem.Visible = true; 
```

由于 ProjectRow 是 DataConnection 的内部构造函数，因此该代码是不可行的。我认为这应该是可行的……我的大脑似乎在 Cinco de Mayo 之后才去度假。

更新：

使用以下方法使其工作。忘记将行初始值设定项设置为“null”而不使用“new”。也感谢您提供的信息，亨克。

```
DataConnection.ProjectRow projectRow = null;

            switch (s)
            {
                case "category":
                    projectRow = projectTableAdapter.GetDataByCategory_Active_RankOrder(_category)[i];
                    break;
                case "random":
                    projectRow = projectTableAdapter.GetDataByRandom()[i];
                    break;
            }

            if (image != null) if (projectRow != null) image.ImageUrl = projectRow.Image;
            if (title != null) if (projectRow != null) title.Text = projectRow.Name;
            if (summary != null) if (projectRow != null) summary.Text = projectRow.Summary;

            if (projectRow != null && projectRow.Description.Length > 0)
            {
                if (link != null)
                {
                    link.NavigateUrl = string.Format("/experience/details/?id={0}",
                                                     projectRow.ProjectID);
                    link.Visible = true;
                }
            }

            if (listitem != null) listitem.Visible = true; 
```

# android - 查找 sd 卡上的所有文件

> ID：10557685
> 
> 赞同：4
> 
> 时间：2012-05-11T19:48:41.363
> 
> 标签：android, sd-card

我想找到存储在 sdCard 上的所有文件。我使用了这段代码：

```
List<File> dir = new ArrayList<File>();
List<File> files = new ArrayList<File>();

   File root = new File (Environment.getExternalStorageDirectory().getAbsolutePath());

    scan(root); // find root directories

    for (File f : dir) { // find in root...
       scan(f);
    }

    Log.i("files", "" + files.size());
    Log.i("dir", "" + dir.size());

}

 public void scan (File path) {

    for (File f : path.listFiles()) {
        if (f.isFile()) {
            files.add(f);
        }
        else {
            dir.add(f);
        }
    }
} 
```

但我有这个异常的问题：“java.util.ConcurrentModificationException”我更改列表（dir）并循环它。ListIterator 没有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:54:24.087

迭代列表时不能添加到列表中。试试这个：

```
List<File> dir = new ArrayList<File>();
List<File> files = new ArrayList<File>();

   File root = new File (Environment.getExternalStorageDirectory().getAbsolutePath());

    List<File> rootDirs = //... code to find root directories

    for (File f : rootDirs) { // find in root...
       scan(f);
    }

    Log.i("files", "" + files.size());
    Log.i("dir", "" + dir.size());

}

 public void scan (File path) {

    for (File f : path.listFiles()) {
        if (f.isFile()) {
            files.add(f);
        }
        else {
            dir.add(f);
            scan(f);
        }
    }
} 
```

# vim - 我如何映射 毫不拖延

> ID：10557688
> 
> 赞同：1
> 
> 时间：2012-05-11T19:48:48.180
> 
> 标签：vim, vi, macvim

我不在乎什么`<c-j>`（我认为是新行还是什么？）

我一直在使用`kj`非常快速的方式进入正常模式，而不是`<esc>`但每次我输入 ak 或 j 时我都会发现这很烦人，它会使它们混乱起来。它永远不会影响代码，因为一旦我输入过去，它们就会立即修复，但我仍然厌倦了看到它。

更不用说我认为 control+j 会更快。

问题是它在进入正常模式之前会导致轻微延迟，因为该组合在其他地方使用。我怎样才能显式覆盖任何其他映射？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T21:50:47.277

列出竞争映射：

```
:imap <C-j> 
```

删除你不想要的：

```
:iunmap <NL>a
:iunmap <NL>b
:iunmap <NL>c 
```

（请注意，这`<NL>`确实是 的有效同义词`<C-j>`）

# c++ - 确定 C++ 模板函子的参数数量

> ID：10557692
> 
> 赞同：1
> 
> 时间：2012-05-11T19:48:54.233
> 
> 标签：c++, visual-studio-2010, templates, visual-c++, c++11

假设我们有：

```
template<typename F, typename T1, typename T2>
void my_magic_method(F func, T1 t1, T2 t2)
{
    if (???)
        func(t1);
    else
        func(t1,t2);
} 
```

什么可以帮助我确定：

1.  参数数量

2.  也许每个参数的类型

3.  返回值类型

由于 MSVS 2010，我不能使用可变参数模板...

**更新**

我的第一个解决方案：

```
template<typename F>
auto my_magic_func(F f) -> decltype(f(1))
{
    return f(1);
}

template<typename F>
auto my_magic_func(F f, void * fake = NULL) -> decltype(f(2,3))
{
    return f(2,3);
}

int main()
{
    auto x1 = my_magic_func([](int a){ return a+100; });
    auto x2 = my_magic_func([](int a, int b){ return a*b; });
    // x1 == 1+100
    // x2 == 2*3
} 
```

这就是我的函数类型重载方式。它有效，但也许是更好的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:06:04.047

不完全符合您的要求，但如果我正确理解您的意图，在 VC++ 2010 中，通过基于 arity 的简单重载是可能的（但丑陋的）：

```
#include <utility>
#include <string>
#include <iostream>

template<typename F, typename T1>
auto my_magic_method(F&& func, T1&& t1) ->
    decltype(std::forward<F>(func)(std::forward<T1>(t1)))
{
    return std::forward<F>(func)(std::forward<T1>(t1));
}

template<typename F, typename T1, typename T2>
auto my_magic_method(F&& func, T1&& t1, T2&& t2) ->
    decltype(std::forward<F>(func)(std::forward<T1>(t1), std::forward<T2>(t2)))
{
    return std::forward<F>(func)(std::forward<T1>(t1), std::forward<T2>(t2));
}

struct string_to_float_functor
{
    float operator ()(std::string const& s) const
    {
        return std::stof(s);
    }
};

int main()
{
    auto a = my_magic_method([](std::string const& x) { return x + x; }, "foo");
    auto b = my_magic_method([](double x, int y) { return x * y; }, 21.5, 3);
    auto c = my_magic_method(string_to_float_functor(), "3.14159265");
    std::cout << a << '\n' << b << '\n' << c << '\n';
} 
```

这支持一元和二元函子——继续该模式并根据需要为其他元数添加重载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T10:38:50.450

这里有一些方法；都假设 C++11。使用 -std=c++11 在 clang++ 3.2 上测试。

```
//Taking a function pointer argument (template types inferred)

template <typename ret, typename ... Args>
constexpr int arg_count(ret (*f)(Args...)) {
    return sizeof...(Args);
}

//Taking a function type (or related) directly

template <typename T>
struct ArgCount {
    static const int value = 0;
};

template <typename Ret, typename ... Args>
struct ArgCount<Ret(Args...)> {
    static const int value = sizeof...(Args);
};

template <typename Ret, typename ... Args>
struct ArgCount<Ret(*)(Args...)> {
    static const int value = sizeof...(Args);
};

template <typename Ret, typename ... Args>
struct ArgCount<Ret(&)(Args...)> {
    static const int value = sizeof...(Args);
};

//Using the latter for dispatch

template <int N>
struct helper {
    template<typename F, typename T1, typename T2>
    static void call(F func, T1 t1, T2 t2);
};

template <>
struct helper<1> {
    template<typename F, typename T1, typename T2>
    static void call(F func, T1 t1, T2 t2) {
        func(t1);
    }
};

template <>
struct helper<2> {
    template<typename F, typename T1, typename T2>
    static void call(F func, T1 t1, T2 t2) {
        func(t1, t2);
    }
};

template<typename F, typename T1, typename T2>
void my_magic_method(F func, T1 t1, T2 t2)
{
    helper<ArgCount<F>::value>::call(func, t1, t2);
}

//Testing

#include <cstdio>

void a(int a, int b) { printf("%i\n", a + b); }
void b(int x) { printf("%i\n", x); }

int main() {
    printf("%i %i\n", arg_count(a), arg_count(b));
    printf("%i %i\n", ArgCount<decltype(a)>::value, ArgCount<decltype(b)>::value);
    my_magic_method(a, 1, 2);
    my_magic_method(b, 1, 2);
} 
```

# sql - 将毫秒转换为日期/时间

> ID：10557695
> 
> 赞同：0
> 
> 时间：2012-05-11T19:49:07.213
> 
> 标签：sql

我正在尝试在 PostgreSQL 中生成报告。它正在工作——除了存储在数据库中的一列表示日期/时间值，但它存储为一个整数，表示自 1970 年以来的毫秒数。

不用说，毫秒值对于阅读报告的人来说并没有多大意义。SQL中有没有办法将毫秒转换为某种可读的日期/时间值？我不容易用其他程序或语言生成报告。我希望报告作为 SQL 脚本运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:58:53.633

这个食谱[来自文档](http://www.postgresql.org/docs/current/interactive/functions-datetime.html)：

```
SELECT TIMESTAMP WITH TIME ZONE 'epoch' + (millisecond_column/1000) * INTERVAL '1 second'
  FROM mytable; 
```

PostgreSQL 的最新版本提供了`to_timestamp`实现相同功能的功能。

# java - ArrayList vs Vector - 这是否说明了同步的差异？

> ID：10557696
> 
> 赞同：3
> 
> 时间：2012-05-11T19:49:13.510
> 
> 标签：java, thread-safety

我试图了解 ArrayList 和 Vector 的行为差异。以下片段是否以任何方式说明了同步的差异？ArrayList (f1) 的输出是不可预测的，而 Vector (f2) 的输出是可预测的。我认为 f2 具有可预测的输出可能只是运气，因为稍微修改 f2 以使线程休眠即使是 ms (f3) 也会导致空向量！是什么原因造成的？

```
public class D implements Runnable {
   ArrayList<Integer> al;
   Vector<Integer> vl;

   public D(ArrayList al_, Vector vl_) {
      al = al_;
      vl = vl_;
   }

   public void run() {
      if (al.size() < 20)
         f1();
      else
         f2();
   } // 1

   public void f1() {
      if (al.size() == 0)
         al.add(0);
      else
         al.add(al.get(al.size() - 1) + 1);
   }

   public void f2() {
      if (vl.size() == 0)
         vl.add(0);
      else
         vl.add(vl.get(vl.size() - 1) + 1);
   }

   public void f3() {
      if (vl.size() == 0) {
         try {
            Thread.sleep(1);
            vl.add(0);
         } catch (InterruptedException e) {
            System.out.println(e.getMessage());
         }
      } else {
         vl.add(vl.get(vl.size() - 1) + 1);
      }
   }

   public static void main(String... args) {
      Vector<Integer> vl = new Vector<Integer>(20);
      ArrayList<Integer> al = new ArrayList<Integer>(20);
      for (int i = 1; i < 40; i++) {
         new Thread(new D(al, vl), Integer.toString(i)).start();
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T19:58:42.383

回答这个问题：是的，向量是同步的，这意味着对数据结构本身的并发操作不会导致意外行为（例如 NullPointerExceptions 或其他东西）。因此，在并发情况下，like 调用`size()`对于 a 是完全安全的`Vector`，但对于 an 则不是`ArrayList`（注意，如果只有读取访问，ArrayLists 也是安全的，只要至少一个线程写入数据结构，我们就会遇到问题，例如添加/删除）

问题是，这种低级同步基本上完全没用，您的代码已经证明了这一点。

```
if (al.size() == 0)
   al.add(0);
else
   al.add(al.get(al.size() - 1) + 1); 
```

您在这里想要的是根据当前大小向您的数据结构添加一个数字（即，如果 N 个线程执行此操作，最后我们希望列表包含数字`[0..N)`）。可悲的是，这不起作用：

假设 2 个线程在一个空列表/向量上同时执行此代码示例。以下时间表是很有可能的：

```
T1: size() # go to true branch of if
T2: size() # alas we again take the true branch.
T1: add(0)
T2: add(0) # ouch 
```

两者都执行`size()`并取回值 0。然后它们进入真正的分支并都添加`0`到数据结构中。那*不是*你想要的。

因此，无论如何，您都必须在业务逻辑中进行同步，以确保`size()`并`add()`以原子方式执行。因此，向量的同步几乎在任何情况下都毫无用处（与现代 JVM 上的一些说法相反，非竞争锁的性能影响完全可以忽略不计，但 Collections API 更好，所以为什么不使用它）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:52:21.327

在 The Beginning (Java 1.0) 中有“同步向量”。

这可能会对性能造成*巨大*影响。

因此在 Java 1.2 以后添加了“ArrayList”和朋友。

您的代码首先说明了使向量同步的基本原理。但在大多数情况下，这根本是不必要的，在其余的大部分时间里，最好以其他方式完成。

恕我直言...

PS：一个有趣的链接：

[http://www.coderanch.com/t/523384/java/java/ArrayList-Vector-size-incrementation](http://www.coderanch.com/t/523384/java/java/ArrayList-Vector-size-incrementation)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T19:56:45.437

向量是线程安全的。ArrayLists 不是。这就是 ArrayList 比向量快的原因。下面的链接有很好的信息。

[http://www.javaworld.com/javaworld/javaqa/2001-06/03-qa-0622-vector.html](http://www.javaworld.com/javaworld/javaqa/2001-06/03-qa-0622-vector.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T19:57:39.590

> 我试图了解 ArrayList 和 Vector 的行为差异

`Vector`是`synchronized`而`ArrayList`不是。`ArrayList`不是线程安全的。

> 以下片段是否以任何方式说明了同步的差异？

没有区别，因为`Vector`只有`sunchronized`

# lua - 如何使用 Lua Dissector 在 Wireshark 中将数据从数据包转换为整数？

> ID：10557702
> 
> 赞同：0
> 
> 时间：2012-05-11T19:49:54.010
> 
> 标签：lua, wireshark, wireshark-dissector

我正在尝试将数据包内的数据转换为 int，但它不起作用。我能够正确地将字段添加到子树中，但希望能够以整数形式访问数据以执行其他一些工作。

我希望能够将下面的变量 len 用作 int，但是当我尝试使用“tonumber”方法时，会返回“Nil”。我可以使用“tostring”将其转换为字符串，但使用 to number 方法无济于事。

我看到了一些使用以下代码转换为整数的示例：

```
 local len = buf(0,4):uint32() 
```

但是当我在我的机器上运行它时会产生以下错误：

```
 Lua error: attempt to call method "uint32" (a nil value) 
```

这是我拥有的代码，除了注释之外，它可以正确执行所有操作：

```
{rest of code}
-- myproto dissector function function 
function (my_proto.dissector (buf, pkt, root) 

    -- create subtree for myproto 
    subtree = root:add(my_proto, buf(0)) 
    -- add protocol fields to subtree 
    subtree:add(f_messageLength, buf(0,4))

    -- This line does not work as it returns a nil value
    local len = tonumber(buf(0,4))

    -- This line produces a "bad argument #1 to 'set' (string expected, got nil) error"
    -- add message len to info column
    pkt.cols.info:set((tostring(len))))
    end
end
{rest of code} 
```

所以我的问题是如何将 userdata 类型转换为可以使用的整数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T02:13:36.140

`buf`这是一个[`TvbRange`](http://wiki.wireshark.org/LuaAPI/Tvb#TvbRange)对象，没有`TvbRange.uint32()`. 你正在寻找[`TvbRange.uint()`](http://wiki.wireshark.org/LuaAPI/Tvb#tvbrange%3auint.28.29). 试试这个更新：

```
function (my_proto.dissector (buf, pkt, root) 
    subtree = root:add(my_proto, buf(0)) 
    subtree:add(f_messageLength, buf(0,4))

    local len = buf(0,4):uint()
    pkt.cols.info:set(len)
end 
```

# php - PHP中数组的URL

> ID：10557715
> 
> 赞同：1
> 
> 时间：2012-05-11T19:51:00.160
> 
> 标签：php, arrays, parsing, url

我不知道如何使它工作。我想从 URL 制作数组：

```
index.php?address=someaddress&telephone=12345&customer=Customer Name&p_name[0]=ProductOne&p_name[1]=ProductTwo&p_price[0]=1&p_price[1]=10&p_name[2]... 
```

有一个 api，它的工作原理是这样的：

```
$api‐&gt;addItem(array(
        'name' => 'ProductOne',
        'price' => '123',
    ));

$api­‐&gt;addItem(array(
        'name' => 'ProductTwo',
        'price' => '32',
    )); 
```

有没有办法`$api->addItem(array`从 URL 制作这样的数组（=api request）？`$api­‐&gt;addItem(array`可以多次使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T19:53:20.707

**编辑：**感谢 dqhendricks 和 Rocket 指出您可以`[parse_str()](http://ca.php.net/manual/en/function.parse-str.php)`用来做同样的事情。

```
$q = parse_str(parse_url($url, PHP_URL_QUERY)); 
```

或者你可以使用这个（很长的路）：

```
function parse_query($var) {
   $var = parse_url($var, PHP_URL_QUERY);
   $var = html_entity_decode($var);
   $var = explode('&', $var);
   $arr = array();

   foreach($var as $val) {
     $x = explode('=', $val);
     $arr[$x[0]] = $x[1];
   }
   unset($val, $x, $var);
   return $arr;
} 
```

像这样使用：

```
$url = "http://someurl.com/click?z=26&a=761";
print_r(parse_query($url)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T19:59:25.383

您可以控制 URL 吗？如果是这样，我会改变你发送价值观的方式。

代替：

```
name1=ProductOne&price1=123&name2=ProductTwo&price2=32 
```

我会使用：

```
name[]=ProductOne&price[]=123&name[]=ProductTwo&price[]=32 
```

把`[]`它们变成数组，意思`$_GET['name']`是现在是一个数组。然后你可以`foreach`克服它。

```
foreach($_GET['name'] as $k=>$v){
    $api->addItem(array(
        'name' => $v,
        'price' => $_GET['price'][$k]
    ));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T20:01:08.293

```
// extract the query from the url string
$url = parse_url('sample.php?name1=ProductOne&price1=123&name2=ProductTwo&price2=32', PHP_URL_QUERY);
// process into array so that first element is a key, and second element is a value
parse_str($url, $output_array);
// now $output_array contains the query's variables. 
```

更大的问题是，当这些变量已经包含在 中时，为什么要这样做`$_GET`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T19:52:31.253

```
sample.php?name[]=Product1&name[]=Product2 
```

然后在你的 PHP 中，你可以看到：

```
print_r($_GET['name']); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T19:55:31.210

我不确定我是否理解正确，但如果您正在寻找的是将查询字符串转换为数组，您可以使用该`pares_str`函数。为了仅从 url 获取查询字符串，您可以使用该`parse_url`函数

```
$url = "sample.php?some_var=someval&s=4&bla=bla";
$url_parts = parse_url($url);
$qs = $url_parts["query"];
$params = array();
parse_str($qs,$params);
var_dump($params); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-18T08:59:34.740

就像 dqhendricks 建议的那样，仅使用原始获取然后将它们附加到数组中是否不值得。我假设您将始终知道 URL 中的内容

$array_of_gets = array("address" => $_GET['address'],"telephone" => $_GET['telephone']);

等等...

# javascript - 将标签添加到 D3 和弦图

> ID：10557720
> 
> 赞同：14
> 
> 时间：2012-05-11T19:51:26.210
> 
> 标签：javascript, d3.js, label, data-visualization, chord-diagram

我是一个新手程序员，所以这个对你们大多数人来说可能很容易。这个和弦图的标签和/或鼠标悬停文本需要哪些代码行？

[http://mbostock.github.com/d3/ex/chord.html](http://mbostock.github.com/d3/ex/chord.html)

![在此处输入图像描述](../Images/a3fcac1fd7123ee61eeabd7e2577ec24.png)

我需要它在外条中显示类别的名称。当您将鼠标悬停时，我想显示确切的数字和两个类别。像这样：'A：来自 B 的 5 个东西'。

编辑：

我仍然无法弄清楚如何在我的代码中实现它。有人可以填写我的示例代码并解释发生了什么吗？

```
 <!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>Selecties EK 2010</title>
    <script type="text/javascript" src="d3.v2.js"></script>
    <link type="text/css" rel="stylesheet" href="ek2010.css"/>
  </head>
  <body>
    <div id="chart"></div>
    <script type="text/javascript" src="ek2010.js"></script>
  </body>
</html> 
```

和

```
// From http://mkweb.bcgsc.ca/circos/guide/tables/
var chord = d3.layout.chord()
    .padding(.05)
    .sortSubgroups(d3.descending)
    .matrix([
      [0, 0, 7, 5],
      [0, 0, 8, 3],
      [7, 8, 0, 0],
      [5, 3, 0, 0]
    ]);

var width = 1000,
    height = 1000,
    innerRadius = Math.min(width, height) * .3,
    outerRadius = innerRadius * 1.1;

var fill = d3.scale.ordinal()
    .domain(d3.range(4))
    .range(["#000000", "#FFDD89", "#957244", "#F26223"]);

var svg = d3.select("#chart")
  .append("svg")
    .attr("width", width)
    .attr("height", height)
  .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

svg.append("g")
  .selectAll("path")
    .data(chord.groups)
  .enter().append("path")
    .style("fill", function(d) { return fill(d.index); })
    .style("stroke", function(d) { return fill(d.index); })
    .attr("d", d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius))
    .on("mouseover", fade(.1))
    .on("mouseout", fade(1));

var ticks = svg.append("g")
  .selectAll("g")
    .data(chord.groups)
  .enter().append("g")
  .selectAll("g")
    .data(groupTicks)
  .enter().append("g")
    .attr("transform", function(d) {
      return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")"
          + "translate(" + outerRadius + ",0)";
    });

ticks.append("line")
    .attr("x1", 1)
    .attr("y1", 0)
    .attr("x2", 5)
    .attr("y2", 0)
    .style("stroke", "#000");

ticks.append("text")
    .attr("x", 8)
    .attr("dy", ".35em")
    .attr("text-anchor", function(d) {
      return d.angle > Math.PI ? "end" : null;
    })
    .attr("transform", function(d) {
      return d.angle > Math.PI ? "rotate(180)translate(-16)" : null;
    })
    .text(function(d) { return d.label; });

svg.append("g")
    .attr("class", "chord")
  .selectAll("path")
    .data(chord.chords)
  .enter().append("path")
    .style("fill", function(d) { return fill(d.target.index); })
    .attr("d", d3.svg.chord().radius(innerRadius))
    .style("opacity", 1);

/** Returns an array of tick angles and labels, given a group. */
function groupTicks(d) {
  var k = (d.endAngle - d.startAngle) / d.value;
  return d3.range(0, d.value, 1).map(function(v, i) {
    return {
      angle: v * k + d.startAngle,
      label: i % 5 ? null : v / 1 + " internat."
    };
  });
}

/** Returns an event handler for fading a given chord group. */
function fade(opacity) {
  return function(g, i) {
    svg.selectAll("g.chord path")
        .filter(function(d) {
          return d.source.index != i && d.target.index != i;
        })
      .transition()
        .style("opacity", opacity);
  };
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-11T23:02:30.993

添加[文本元素](http://www.w3.org/TR/SVG/text.html#TextElement)以显示标签。或者，如果要沿路径显示文本，请使用[textPath 元素。](http://www.w3.org/TR/SVG/text.html#TextPathElement)标记和弦图的两个示例：

*   [http://mbostock.github.com/d3/talk/20111018/chord.html](http://mbostock.github.com/d3/talk/20111018/chord.html)
*   [http://bl.ocks.org/1308257](http://bl.ocks.org/1308257)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T23:04:43.703

您需要查看Github 上 d3.js wiki 中的**( [selection.on()](https://github.com/mbostock/d3/wiki/Selections#wiki-on) )事件处理程序。**这向您展示了如何向包括 mouseover 和 mouseout 在内的元素添加事件。如果您查看链接到的示例，您已经可以看到它的一个实例：

```
svg.append("g")
  .selectAll("path")
    .data(chord.groups)
.enter().append("path")
  .style("fill", function(d) { return fill(d.index); })
  .style("stroke", function(d) { return fill(d.index); })
  .attr("d", d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius))
  .on("mouseover", fade(.1))
  .on("mouseout", fade(1)); 
```

如果您将鼠标悬停在外环的和弦组上，您将看到所有其他和弦组淡出。

如果要弹出包含字符串（文本）的标签，则需要使用另一个 JS 库来定义它们。我知道一个有效的方法是[Tipsy ，](https://github.com/jaz303/tipsy)[这里](http://bl.ocks.org/1629644)有一个将它与 d3 一起使用的示例。然后，您应该能够简单地使用选择器来选择要说明此行为的 SVG 元素。

希望有帮助。

# jquery - jQuery 使用 this 关键字选择一个类

> ID：10557721
> 
> 赞同：2
> 
> 时间：2012-05-11T19:51:37.177
> 
> 标签：jquery, html

我有一种情况，每当用户单击#postComment 链接时，我都必须提交评论。

现在使用此代码第一次成功提交评论但不是第二次。我认为这是因为 jquery 不正确并且在这里 $('.comment a') 变得混乱。

现在我想知道如何使用“this”关键字或任何其他可能的解决方案来访问这些类型的变量。

每次提交评论时，都会将 newCommentBox 变量附加到 commentWrapper 以生成新的评论框。

查询：

```
 $('.comment a').click(function(){

comment="<pre>"+$('textarea').val()+"</pre>";
newcommentBox="<div class='CommentBox'>"
        +"<div class='dp'><img src='../Images/defaultPic.jpg' width='50' height='50' /></div>"
        +"<div class='name'>Muazzam Ali</div>"
        +"<div class='comment'>"
        +"<textarea cols='70' rows='10'></textarea><br />"
            +"<a href='javascript:void(0)' id='postComment'><img src='../Images/commentbutton.png' height='30' width='90' /></a>"
        +"</div>"
    +"</div>";

$(this).prev().html("");
$(this).hide();

$(this).parent().html(comment);
$('#CommentWrapper').append(newcommentBox);

}); 
```

HTML：

```
 <div id="CommentWrapper">
          <div id="CommentHeading">Comments:</div>
    <div class="CommentBox">
        <div class="dp"><img src="../Images/defaultPic.jpg" width="50" height="50" /></div>
                <div class="name">Muazzam Ali</div>
                <div class="comment">Comment</div>
                </div>

    <div class="CommentBox">
        <div class="dp"><img src="../Images/defaultPic.jpg" width="50" height="50" /></div>
        <div class="name">Muazzam Ali</div>
        <div class="comment">
        <textarea cols="70" rows="10"></textarea><br />
            <a href="javascript:void(0)" id="postComment"><img src="../Images/commentbutton.png" height="30" width="90" /></a>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:53:33.873

它不是第二次添加评论，因为您还没有将`click`偶数处理程序添加到`a`表示提交评论按钮的新元素中。实际上，您必须再次将事件处理程序添加到这个新创建的元素。或者，使用 jQuery 的委托功能，使用该`on`方法，将事件处理程序始终添加到您的`a`元素中。

不过，就个人而言，这是我会做的。这是更新的 JavaScript：

```
$('.comment a').click(function _this (){

    comment = "<pre>"+$('textarea').val()+"</pre>";
    newcommentBox = "<div class='CommentBox'>"
        +"<div class='dp'><img src='../Images/defaultPic.jpg' width='50' height='50' /></div>"
            +"<div class='name'>Muazzam Ali</div>"
            +"<div class='comment'>"
                +"<textarea cols='70' rows='10'></textarea><br />"
                +"<a href='javascript:void(0)' id='postComment'><img src='../Images/commentbutton.png' height='30' width='90' /></a>"
            +"</div>"
        +"</div>";

    $(this).prev().html("");
    $(this).hide();

    $(this).parent().html(comment);
    $('#CommentWrapper').append(newcommentBox);
    $('#CommentWrapper').find(".comment a").click(_this);

}); 
```

我在这里做的是`$(".comment a").click()`用 name命名你传递给的函数表达式`_this`。我给函数起的这个名字**只**在函数本身内部可用。每当发表评论时，它都会将自己附加为*下一个* `a`元素的单击事件处理程序。*它还可以让您避免使用可能*会导致性能损失的事件委托。（如果你关心那种事情。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T19:57:45.600

尝试使用委托（假设 jQuery 1.7）

```
$(document.body).on("click", ".comment a", function(e) {
 // handle event
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:04:09.630

我相信问题可能是您在将回调附加到单击事件后附加了新按钮。

尝试将`$(".comment a").click(function()...)`with 替换为以下内容：

`$(".comment a").live("click", function()...);`它也将附加到新的

# javascript - 使用 javascript 构建查询字符串

> ID：10557729
> 
> 赞同：0
> 
> 时间：2012-05-11T19:52:00.860
> 
> 标签：javascript, string, url

我想知道是否可以构建一个查询字符串，例如：

```
fq=model:book+model:cds+model:journal+model:new_member+model:member 
```

我想在浏览器的地址栏中使用以下内容：

```
//localhost:8080/search/q=son&fq=model:book+model:cds+model:journal+model:new_member+model:member 
```

我不想使用`=` ( `model=book`) 和 `&`( `model=book&model=cds`) 符号，但我需要键值对 ( `model:book`) 和`+`符号 ( `model:book+model:cds`)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:56:52.050

[`http_build_query`来自 PHPJS 的](http://phpjs.org/functions/http_build_query:428)你可能会感兴趣。它与 PHP 的功能相同[`http_build_query`](http://php.net/http-build-query)，但它已被移植到 JavaScript，因此您可以在 JS 中做同样的事情。

出于您的目的，您需要编辑第 37 和 44 行以使用所需的分隔符。

# jquery - QuickBase jQuery/Ajax 调用谜题

> ID：10557731
> 
> 赞同：0
> 
> 时间：2012-05-11T19:52:08.757
> 
> 标签：jquery, xml, ajax, quickbase

在两天的大部分时间里，我一直对这个 QuickBase jQuery/Ajax 问题感到困惑。考虑在 $(function()... 中运行的这个 jquery 代码：

```
 <script type="text/javascript">
        $(function() { 
            $.ajax({
                type: "GET",
                url: "https://www.quickbase.com/db/<mydbid>", // <- returns error
                //url: "http://pfs.fedcap.com/testdata.xml",  // <- returns xml
                data: {
                    act:"API_DoQuery",
                    query:"{7.EX.235445}",
                    apptoken:"<myapptoken>"
                },
                dataType: "xml",
                error: function(xhr,status) {
                    alert("error");
                },
                success: function(xml) { 
                    alert("OK");
                }
            });
        });
    </script> 
```

如前所述，指向 QuickBase 的 url 返回错误，但指向 xml 文件的 url 按预期返回 xml。但这里是关键：xml 文件 (testdata.xml) 是通过将我的浏览器直接指向指定的 url 创建的：[https](https://www.quickbase.com/db/<mydbid) : //www.quickbase.com/db/<mydbid >?a=API_DoQuery&query={7.EX。 235445}&apptoken=<myapptoken> 并将结果保存到 testdata.xml。在我看来，jquery ajax 调用应该产生与 testdata.xml 文件相同的结果。但事实并非如此。

Firebug xml 窗格显示，对 QuickBase 站点执行的调用返回“XML Parsing Error: syntax error Location: moz-nullprincipal:{3e0d38f1-0e36-4adb-965e-d0e7d68ab0cb} Line Number 1, Column 1:Reload the page to获取来源：[https](https://www.quickbase.com/db) ://www.quickbase.com/db ..."

我在看什么？有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T18:34:14.733

虽然可以编写自己的 API 的 jQuery 实现，但最好使用他们自己的 javascript SDK。[https://github.com/QuickbaseAdmirer/Quickbase-JavaScript-SDK](https://github.com/QuickbaseAdmirer/Quickbase-JavaScript-SDK)

您缺少的重要部分是获取“票证”的身份验证调用。提供应用程序令牌不足以进行 DoQuery 调用。您必须进行身份验证，然后使用发回的票证进行更多 API 调用。对于 url 请求，可以很容易地附加票证`&ticket=randomcharacters`。对于 XML 请求，只需添加`<ticket>randomcharacters</ticket>`到您的 XML 请求中。

[https://github.com/QuickbaseAdmirer/Quickbase-JavaScript-SDK](https://github.com/QuickbaseAdmirer/Quickbase-JavaScript-SDK)有更多关于如何使用 Authenticate 调用的信息。

# java - 使用文件通道读取文本文件返回非法字符

> ID：10557740
> 
> 赞同：0
> 
> 时间：2012-05-11T19:52:23.497
> 
> 标签：java, file

我正在尝试使用文件通道来读取一个大的 xml 文件，这里是我在[这里](http://www.java2s.com/Tutorial/Java/0180__File/UsingFileChanneltoreadtextfile.htm)找到的示例代码。当我尝试它时，它打印出无法识别的字符： import java.io.File; 导入java.io.File；导入 java.io.FileInputStream；导入 java.nio.ByteBuffer；导入 java.nio.channels.FileChannel；

```
public class MainClass {
  public static void main(String[] args) throws Exception {
    File aFile = new File("charData.xml");
    FileInputStream inFile = null;

    inFile = new FileInputStream(aFile);

    FileChannel inChannel = inFile.getChannel();
    ByteBuffer buf = ByteBuffer.allocate(48);

    while (inChannel.read(buf) != -1) {
      System.out.println("String read: " + ((ByteBuffer) (buf.flip())).asCharBuffer().get(0));
      buf.clear();
    }
    inFile.close();
  }
} 
```

输出：

```
String read: â¸®
String read: â¸®
String read: â¸®
String read: â¸®
String read: â¸®
String read: â¸®
String read: â¸®
String read: â¸®
String read: â¸® 
```

你错过了什么吗？谢谢，

大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:03:14.163

你应该试试这个

```
import java.util.*;
import java.io.*;
import java.nio.*;
import java.nio.channels.*;
import java.nio.charset.*;

public class Buffer
{
    public static void main(String args[]) throws Exception
    {
        String inputFile = "charData.xml";
        FileInputStream in = new FileInputStream(inputFile);
        FileChannel ch = in.getChannel();
        ByteBuffer buf = ByteBuffer.allocateDirect(BUFSIZE);  // BUFSIZE = 256

        Charset cs = Charset.forName("ASCII"); // Or whatever encoding you want

        /* read the file into a buffer, 256 bytes at a time */
        int rd;
        while ( (rd = ch.read( buf )) != -1 ) {
            buf.rewind();
            System.out.println("String read: ");
            CharBuffer chbuf = cs.decode(buf);
            for ( int i = 0; i < chbuf.length(); i++ ) {
                /* print each character */
                System.out.print(chbuf.get());
            }
            buf.clear();
        }
    }
} 
```

# resolution - 自动调整网页大小以适应显示器/分辨率

> ID：10557751
> 
> 赞同：0
> 
> 时间：2012-05-11T19:52:52.437
> 
> 标签：resolution

我正在设计一个网页，但是在分辨率为 1680x1050 的 22" 显示器上进行。在我们的工作环境中，我们混合使用 17" 和 22" 显示器，当然它们都具有不同的分辨率. 我需要如何编码我的页面才能自动调整到显示器的大小？我希望它可以在不移动对象的情况下完成，只需缩小所有内容以适应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:04:33.687

一些提示是，

1.  在定义 div 大小而不是像素时使用 % 2.在 font-size 中使用 em 而不是 12px,14px ...

即使是小屏幕也适合屏幕-值得深入阅读。[http://en.wikipedia.org/wiki/Responsive_Web_Design](http://en.wikipedia.org/wiki/Responsive_Web_Design)

# c# - C#通过引用混淆传递参数

> ID：10557752
> 
> 赞同：0
> 
> 时间：2012-05-11T19:52:52.687
> 
> 标签：c#, oop

看了一些文章还是一头雾水。为什么更改 StringBuilder 的值会更改而 DateTime 的值不会更改？据我了解，两者都是参考类型：

```
class Program
{
    static void Main(string[] args)
    {
        DateTime myDt = DateTime.MinValue;
        Change(myDt);
        Console.WriteLine(myDt);

        StringBuilder y = new StringBuilder();
        y.Append("hello");
        Foo(y);
        Console.WriteLine(y);

        String test = "hello";
        Foo(test);

    }

    public static void Change(DateTime dt)
    {
       dt.AddDays(24); 
       //or dt=dt.AddDays(24);
    }

    static void Foo(StringBuilder x)
    {
        x.Append(" world");
    }

    static void Foo(String x)
    {
        x = x + " world";
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-11T19:54:01.843

[DateTime](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)不是引用类型，它是一个结构，这意味着一个值类型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T19:54:41.920

[`DateTime`](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)是无法修改的值类型（结构）。它不是引用类型。

当您调用一个看似更改结构的方法时，它通常实际上返回一个全新的结构，而无需修改原始结构，因为无法修改原始结构（它是不可变的）。虽然这同样适用于字符串，但字符串不是值类型。它们是被设计为不可变的引用类型，因此需要诸如`StringBuilder`.

此外，将引用类型作为参数传递与使用[`ref`](http://msdn.microsoft.com/en-us/library/14akc2c7.aspx)或通过引用传递参数不同[`out`](http://msdn.microsoft.com/en-us/library/ee332485.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T19:55:35.303

[DateTime](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)是一个结构，所以它是一个**值**类型。

*因此，与任何其他值类型一样，它按值*过去（在实践中复制）并且仅在注入函数堆栈之后。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T19:56:51.777

[DateTime](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)是一个结构 - 因此是一个值类型。字符串是不可变的引用类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T19:58:05.603

正如其他人提到的那样，区别在于 Class （ StringBuilder 是）和 Struct （ DateTime 是）。这里有一些文章可以进一步帮助：

[http://msdn.microsoft.com/en-us/library/ms173109.aspx](http://msdn.microsoft.com/en-us/library/ms173109.aspx)

和

[http://msdn.microsoft.com/en-us/library/aa288471(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa288471(v=vs.71).aspx)

很好地理解结构和类在 OOP 中很重要，尤其是 c#

# objective-c - Objective-C 动态转换？

> ID：10557756
> 
> 赞同：14
> 
> 时间：2012-05-11T19:53:14.217
> 
> 标签：objective-c

是否有与 C++ 的 dynamic_cast 等效的 Objective-C？

可以使用以下方法伪造：

```
MyClass *safeObject = [object isKindOfClass: [MyClass class]]
                      ? (MyClass *)originalObject : nil; 
```

但这需要输入很多代码，即使我不需要经常输入。

我有点生疏，所以这可能不太正确，但我相信 C++ 中的等价物是：

```
MyClass safeObject = dynamic_cast<MyClass>(orginalObject); 
```

这里的上下文是一个块，其中参数被定义为更通用类的类型，但在这个块中，我“知道”它是一个特定的子类。尽管如此，我不想只是盲目地使用它`(MyClass *)originalObject`并忽略理论上可能的错误。

需要明确的是，虽然我很喜欢 a `dynamic_cast`，但我也很乐意使用另一种方法来安全地处理这种情况。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-29T05:03:22.010

如果你愿意使用 Objective-C++，你可以很容易地写这个：

```
template<typename T> inline T* objc_cast(id from) {
    if ([from isKindOfClass:[T class]]) {
        return static_cast<T*>(from);
    }
    return nil;
} 
```

`dynamic_cast<>`除了 obj-c 对象外，它的行为应该完全一样。

* * *

如果您想坚持使用 vanilla Obj-C，您可以使用以下类方法获得类似的行为`NSObject`：

```
@interface NSObject (Cast)
+ (instancetype)cast:(id)from;
@end

@implementation NSObject (Cast)
+ (instancetype)cast:(id)from {
    if ([from isKindOfClass:self]) {
        return from;
    }
    return nil;
}
@end 
```

这个版本不是很好用，因为你必须说类似的话

```
UIButton *button = [UIButton cast:someView]; 
```

在这两个版本中，结果值是`nil`如果转换失败。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-11T20:00:05.440

试试这个宏：

```
#define objc_dynamic_cast(obj, cls) \
    ([obj isKindOfClass:(Class)objc_getClass(#cls)] ? (cls *)obj : NULL) 
```

并且不要忘记

```
#include <objc/runtime.h> 
```

像这样使用它：

```
MyClass *safeObject = objc_dynamic_cast(originalObject, MyClass); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T19:57:51.657

1.  我不认为有。
2.  我认为这里的错误空间很小。
3.  但如果你坚持，宏就行了？

# service - 用于 Windows 服务故障转移的 3rd 方应用程序

> ID：10557760
> 
> 赞同：0
> 
> 时间：2012-05-11T19:53:26.427
> 
> 标签：service, failover

我们有一个传统的客户端服务器应用程序。服务器端是一个普通的“旧”Windows 服务。为了以相当快速的方式实现更高的可用性，可以从安装在两个不同服务器上的服务开始。然而，这些服务不应同时处于活动状态，因此如果第一台服务器上的服务因某种原因失败，或者第一台服务器出现故障，则第二台服务器应该接管。这可以通过 Windows 集群来完成，但这是相当昂贵的解决方案，因为它具有硬件和操作系统（例如 win 企业）要求。是否有任何好的第三方软件可以处理“监控”服务和切换服务的任务？

提前谢谢，

亲切的问候，维姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T10:27:48.603

## 静态扑克游戏：“去中心化故障转移”

### 概述

*   在进入房间时，您随机选择一张卡片。

*   如果您找到持有相同卡的人，您将离开并回来。

*   如果您离开并回来，您需要选择一张新卡。

*   在任何给定时间，房间里牌最高的人说话。

### 基本实现

*   你有 x 个服务在 x 个服务器上运行

*   当服务启动时，它会在说 int.Min 和 int.Max 之间选择一个随机数

*   在服务配置中，您指定运行服务的每个主机，例如“ [http://internal.server1.com:8282](http://internal.server1.com:8282)、[http://internal.server2.com:8282](http://internal.server2.com:8282)、[http://internal.server3.com:8282](http://internal.server3.com:8282) ”

*   每个服务启动一个嵌入式 http 服务器（例如使用[http://nancyfx.org](http://nancyfx.org)）监听应用程序配置中指定的主机，并在 /

*   当服务运行时，它们会无休止地轮询这些主机以获得最大值

*   如果当前服务编号是最大找到值中的最大值，则切换到主动服务，否则切换到被动服务

# jquery - jQuery 在 IE-7 中显示错误

> ID：10557762
> 
> 赞同：0
> 
> 时间：2012-05-11T19:53:31.580
> 
> 标签：jquery, asp.net-mvc-3

```
Microsoft JScript runtime error: Invalid origin: 
http://static.ak.facebook.com 
```

当我在 IE-7 上运行我的 MVC3 应用程序时，它会在`ticker_37?build=135[dynamic]`文件中显示此错误。谁能告诉我这个问题的解决方案？

# r - 函数结果（数据框）不是我所期望的

> ID：10557767
> 
> 赞同：0
> 
> 时间：2012-05-11T19:53:37.937
> 
> 标签：r, function, dataframe, plyr

我正在尝试为“粘性”定义一个函数 - 一个衡量用户参与度的业务分析指标 - 我的函数正在返回一个填充有意外数据的数据框。

```
stickiness <- function(tdata) {
    require(plyr)
    mau_unique <- dlply(.data = tdata,
                        .variables = "dt",
                        .fun = function(x){unique(x$username)})
    dates_char <- names(mau_unique)
    dates_vector <- as.Date(dates_char[28:(length(dates_char))],
                            format = "%Y-%m-%d")
    output_df <- data.frame(dates_vector,
                            matrix(data = 0,
                                   nrow = length(dates_char) - 27,
                                   ncol = 3))
    colnames(output_df) <- c("Date", "DAU", "MAU", "Stickiness")
    for (i in 1:length(dates_vector)) {
        dt <- dates_vector[i]
        output_df[i, "DAU"] <- length(unlist(mau_unique[[as.character(dt)]][2]))
        set28 <- unique(unlist(lapply(X = mau_unique[i:(i + 27)], FUN = "[[", 2)))  
        output_df[i, "MAU"] <- length(set28)
        output_df[i, "Stickiness"] <- output_df[i, "DAU"] / output_df[i, "MAU"]
    }
    return(output_df) 
} 
```

返回以下内容：

```
 Date DAU MAU Stickiness
1  2012-04-28   1  28 0.03571429
2  2012-04-29   1  28 0.03571429
3  2012-04-30   1  28 0.03571429
4  2012-05-01   1  28 0.03571429
5  2012-05-02   1  28 0.03571429
6  2012-05-03   1  28 0.03571429
7  2012-05-04   1  28 0.03571429
8  2012-05-05   1  28 0.03571429
9  2012-05-06   1  28 0.03571429
10 2012-05-07   1  28 0.03571429 
```

我预计会出现以下情况：

```
 Date   DAU    MAU Stickiness
1  2012-04-28 25000 250000 0.10000000
...  ...      ...   ...    ...
10 2012-05-07 27371 284114 0.09633809 
```

我怀疑这个问题与我正在评估的环境有关。

更新的样本数据：

```
> tdata
                 dt  username
    4236 2012-04-06 241343664
    3091 2012-04-06 306001012
    2936 2012-04-06 388682041
    5790 2012-04-05 235612064
    6763 2012-04-05  69650072
    3392 2012-04-06    617142
    7684 2012-04-05 189752749
    3904 2012-04-06 255852653
    7915 2012-04-05 182713266
    6107 2012-04-05 187675644 
```

UPDATE 工作功能（使用 Brian Diggs 的回答）：

```
stickiness <- function(tdata) {
    require(plyr)
    mau_unique <- dlply(.data = tdata,
                        .variables = "dt",
                        .fun = function(x){unique(x$username)})
    dates_char <- names(mau_unique)
    dates_vector <- as.Date(dates_char[28:(length(dates_char))],
                            format = "%Y-%m-%d")
    output_df <- data.frame(dates_vector,
                            matrix(data = 0,
                                   nrow = length(dates_char) - 27,
                                   ncol = 3))
    colnames(output_df) <- c("Date", "DAU", "MAU", "Stickiness")
    for (i in 1:length(dates_vector)) {
        dt <- dates_vector[i]
        output_df[i, "DAU"] <- length((mau_unique[[as.character(dt)]])
        set28 <- unique(do.call(c, mau_unique[i:(i + 27)]))  
        output_df[i, "MAU"] <- length(set28)
        output_df[i, "Stickiness"] <- output_df[i, "DAU"] / output_df[i, "MAU"]
    }
    return(output_df) 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:19:51.627

感谢您添加一些示例数据，但由于该函数假定数据至少跨越 28 天（或者更确切地说，至少 28 个唯一日期），因此它仍然不能真正重现。

据我所知，问题出在你的 for 循环中。使用您的示例数据，

```
> mau_unique
$`2012-04-05`
[1] 235612064  69650072 189752749 182713266 187675644

$`2012-04-06`
[1] 241343664 306001012 388682041    617142 255852653

attr(,"split_type")
[1] "data.frame"
attr(,"split_labels")
          dt
1 2012-04-05
2 2012-04-06 
```

所以在计算中`DAU`，你从`mau_unique`. 通过计算 的`DAU`虚拟值向外工作`dt`：

```
> dt <- as.Date("2012-04-05")
> dt
[1] "2012-04-05"
> as.character(dt)
[1] "2012-04-05"
> mau_unique[[as.character(dt)]]
[1] 235612064  69650072 189752749 182713266 187675644
> mau_unique[[as.character(dt)]][2]
[1] 69650072
> unlist(mau_unique[[as.character(dt)]][2])
[1] 69650072
> length(unlist(mau_unique[[as.character(dt)]][2]))
[1] 1 
```

我不知道`DAU`应该如何计算，但你总是从相应的向量中取第二个用户名`mau_unique`并取它的长度，这就是为什么你总是得到 1。你正在做类似的事情`set28`；我不知道你为什么一直试图拉出第二个元素。

* * *

编辑：

合成生成的数据很好。这是在小空间中创建大量数据的好方法，并且通过设置随机种子将允许每个人使用相同的数据。

```
set.seed(1234)
tdata <- data.frame(dt = sample(seq(as.Date("2012-04-01"),
                                    as.Date("2012-04-30"),
                                    by = "day"),
                                size = 10000,
                                replace = TRUE),
                    username = sample(10000:10200,
                                      10000,
                                      replace = TRUE)) 
```

鉴于您对`DAU`and的描述`MAU`，我认为您的 for 循环应为：（函数的其余部分未更改）

```
for (i in 1:length(dates_vector)) {
    dt <- dates_vector[i]
    output_df[i, "DAU"] <- length(mau_unique[[as.character(dt)]])
    output_df[i, "MAU"] <- length(unique(unlist(mau_unique[i:(i+27)])))
    output_df[i, "Stickiness"] <- output_df[i, "DAU"] / output_df[i, "MAU"]
} 
```

鉴于此，您的粘性是：

```
> stickiness(tdata)
        Date DAU MAU Stickiness
1 2012-04-28 156 201  0.7761194
2 2012-04-29 168 201  0.8358209
3 2012-04-30 152 201  0.7562189 
```

# apache2 - 如何修复错误：站点 domain.com 不存在，同时将子域添加到 apache2？

> ID：10557770
> 
> 赞同：19
> 
> 时间：2012-05-11T19:53:57.170
> 
> 标签：apache2, subdomain

我正在尝试将子域添加到我的家庭服务器。

svn.domain.com trac.domain.com

由于动态 IP，我使用 dyndns 服务，除此之外，我将 domain.com 托管在其他地方。我为远程主机上的子域创建了 CNAME 以指向我的 user.dyndns.org 域。

所以现在当我访问任何一个子域时：trac 或 svn，我看到“它有效！” 信息。

完成后，我在 /etc/apache2/sites-enabled 下创建了两个虚拟主机文件

文件 1：svn.domain.com 和文件 2：trac.domain.com

内容：

```
<VirtualHost *:80>

  ServerName trac.domain.com

   DocumentRoot = /var/www/trac/repos

   <Directory /var/www/trac/repos>
    Order allow,deny
    allow from all
   </Directory>

</VirtualHost> 
```

和

```
<VirtualHost *:80>

  ServerName svn.domain.com

   DocumentRoot = /var/svn/repos

   <Directory /var/svn/repos>
    Order allow,deny
    allow from all
   </Directory>

</VirtualHost> 
```

但我收到错误：错误：站点 trac.domain.com 不存在！

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2013-07-15T23:17:12.463

从 Apache 2.2 升级到 Apache 2.4 时我遇到了这个问题。（荒谬的）解决方案是确保所有文件都以`.conf`或.`a2ensite``ERROR: Site example does not exist!`

此外，当在 中手动链接时`sites-enabled`，它们甚至不会在没有`.conf`扩展名的情况下加载。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-08-03T02:19:06.067

当我从 Apache 2.2 升级到 2.4 时，我也遇到了同样的问题；我所有的虚拟主机都突然坏了，在试图寻找为什么会这样时，我偶然发现了这个问题。

原来是因为我的旧`apache2.conf`的和新的不一样`apache2.conf`。我的旧 Apache 2.2 conf 文件有一行

```
Include sites-enabled/ 
```

而我的新 Apache 2.4 conf 文件有一行

```
IncludeOptional sites-enabled/*.conf 
```

瞧，当我将线路更改为

```
IncludeOptional sites-enabled/ 
```

一切恢复正常。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-11T20:01:51.967

尝试将文件移动到 /sites-available。然后运行`a2ensite svn.domain.com`并`a2ensite trac.domain.com`重新加载 Apache。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-31T06:49:27.323

如果你输入 a2ensite。它会提示。您要启用哪些站点（即，在您将 .conf 文件放入可用站点并从启用站点链接它之后。

a2ensite 期望具有 .conf 扩展名的 conf 文件的全名

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-10-21T15:19:24.180

a2ensite 仅接受 .conf 文件，因此复制可用站点中的所有站点，以便具有 .conf 扩展名（重命名不起作用，它以某种方式混淆了链接），从可用站点和启用站点中删除原始文件。在新文件上使用 a2ensite（您不需要添加 .conf）并且一切正常，我们在 /etc/apache2/apach2.conf 中没有 *.conf

即使重命名原始文件也必须有一些“记忆” - 符号链接也重命名，但是擦除和启用“新” .con 文件有效，然后您可以像以前一样使用 a2dissite 和 a2ensite

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-11T20:27:36.207

1）删除站点启用中的所有默认站点

```
a2dissite <site-configuration-file-name> 
```

2）仔细查看您的配置文件：从最低限度的属性开始，例如：

```
<VirtualHost [Domain]:80>
ServerAdmin webmaster@localhost
ServerName [Domain]
DocumentRoot [webAppPath]

<Directory [webAppPath]>
    AllowOverride All
     Order allow,deny
     Allow from all
     Require all granted
</Directory>

ErrorLog ${APACHE_LOG_DIR}/my_domain_name_error.log

CustomLog ${APACHE_LOG_DIR}/my_domain_name_access.log combined
</VirtualHost> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-24T15:05:16.853

我的本地服务器名称解决方案正在替换：

```
sudo a2ensite serverName 
```

和

```
sudo a2ensite serverName.conf 
```

# java - 在java中通过https验证/打开文件

> ID：10557776
> 
> 赞同：1
> 
> 时间：2012-05-11T19:54:15.897
> 
> 标签：java, https, httpclient

假设我想连接到[https://www.code.com/secure/test.xml](https://www.code.com/secure/test.xml)并提取所有数据。在允许我提取所述数据之前，它会提示我输入我的凭据。

如何使用 java 处理这个问题？我用谷歌搜索并登陆了 Appache httpClient，但在 https 上找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:16:23.057

快速搜索显示：

[http://docs.oracle.com/javase/7/docs/technotes/guides/net/http-auth.html](http://docs.oracle.com/javase/7/docs/technotes/guides/net/http-auth.html)

所以你可能必须设置默认的Authenticator：

[http://docs.oracle.com/javase/7/docs/api/java/net/Authenticator.html#setDefault%28java.net.Authenticator%29](http://docs.oracle.com/javase/7/docs/api/java/net/Authenticator.html#setDefault%28java.net.Authenticator%29)

# git - 如何在生成文件中强制使用干净的 git 工作存储库？

> ID：10557778
> 
> 赞同：5
> 
> 时间：2012-05-11T19:54:36.430
> 
> 标签：git, makefile, working-directory

我试图`deploy`在我的 Makefile 中创建一个命令，它只是覆盖到分支`deployment`，然后将此分支推送到`origin`.

但是，当工作树不为空时，该命令必须停止/失败并显示错误消息。

类似于以下内容：

```
deploy:

    status=$(git status --porcelain)
    test "x$(status)" = "x"
    git branch -f deployment
    git push origin deployment 
```

不幸的是，这个测试和状态变量似乎没有按预期运行。

一个人将如何实现这一目标？我真的应该使用`test`吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-11T20:01:46.977

用于`git diff-index`检查 repo 是否脏：

```
deploy:
        git diff-index --quiet HEAD 
        git branch -f deployment
        git push origin deployment 
```

如果要检查 makefile 中的 shell 变量，则需要确保在与设置变量的 shell 相同的 shell 中检查变量的值。Make 将在单独的 shell 中调用每个命令，因此您需要执行以下操作：

```
deploy:
        @status=$$(git status --porcelain); \
        if test "x$${status}" = x; then \
            git branch -f deployment; \
            git push origin deployment; \
        else \
            echo Working directory is dirty >&2; \
        fi 
```

请注意双 '$'、分号和续行符。

# php - 与 XPath 等效的 Mysql like 子句

> ID：10557780
> 
> 赞同：1
> 
> 时间：2012-05-11T19:54:52.173
> 
> 标签：php, mysql, xml, xslt, xpath

我需要等效于以下 sql 查询：

选择标题以“V”开头的所有电影，后跟 3 个字符，然后是一个空格，后跟一个字符串（例如 Van Helsing）

```
SELECT * FROM films WHERE title LIKE ="V__ %"; 
```

我如何在电影/电影/标题、xpath 1.0 等树中执行 xpath 1.0 表达式，因为我将使用 php 和 xslt。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:47:34.300

Is it ok, if string after space can not be presented? Then you can use:

```
//title[starts-with(text(), 'V') and string-length(substring-before(text(), ' '))=3] 
```

If presence of string after space is important, then you can use:

```
//title[starts-with(text(), 'V') and string-length(substring-before(text(), ' '))=3 and string-length(substring-after(text(), ' '))>0] 
```

From [http://www.w3.org/TR/xpath/](http://www.w3.org/TR/xpath/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T02:23:45.373

请注意，当前接受的答案错误地选择了不匹配的选择标准元素 - 请参阅此答案的结尾。

**这是一个正确的解决方案**。

**使用**：

```
/films/film/title
    [starts-with(., 'V')
   and
     not(translate(substring(.,1,3), $vAlpha, ''))      
   and
     substring(.,4,1) = ' '     
   and
     not(substring(.,5,1) = ' ')
   and
     not(translate(., concat($vAlpha, ' '), ' '))       
    ] 
```

其中`$vAlpha`是完全由所有字母组成的字符串。

**`/films/film/title`这将选择其字符串值为 的所有元素**：

1.  以字符开头`V`。

2.  它的开头三个字符都是字母。

3.  它的第四个字符是一个空格。

4.  它的第 5 个字符不是空格。

5.  它的所有字符都是字母或空格。

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>
 <xsl:variable name="vAlpha" select=
  "concat('ABCDEFGHIJKLMNOPQRSTUVWXYZ',
          'abcdefghijklmnopqrstuvwxyz')"/>

 <xsl:template match="/">
     <xsl:copy-of select=
      "/films/film/title
            [starts-with(., 'V')
       and
             not(translate(substring(.,1,3), $vAlpha, ''))      
       and
             substring(.,4,1) = ' '     
           and
            not(substring(.,5,1) = ' ')
           and
            not(translate(., concat($vAlpha, ' '), ' '))        
            ]
      "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<films>
 <film>
  <title>Van Helsing</title>
 </film>
 <film>
  <title>Van  Helsing</title>
 </film>
 <film>
  <title>Ban Helsing</title>
 </film>
 <film>
  <title>van Helsing</title>
 </film>
 <film>
  <title>Vann Helsing</title>
 </film>
 <film>
  <title>Van Helsing2</title>
 </film>
</films> 
```

**对上面的 XPath 表达式求值，并将选定的元素（在这种情况下只有一个）复制到输出**：

```
<title>Van Helsing</title> 
```

**请注意，当前接受的答案错误地选择了以下两个不匹配的元素：**

```
<title>Van  Helsing</title>
<title>Van Helsing2</title> 
```

# android - AES 中的初始化向量长度

> ID：10557784
> 
> 赞同：2
> 
> 时间：2012-05-11T19:55:11.050
> 
> 标签：android, aes, initialization-vector

我在 AES/CBC/PKCS5Padding 中使用了 AES，并在 Android 中使用了以下加密和解密代码部分：

```
cipher.init(Cipher.ENCRYPT_MODE, keySpec, new IvParameterSpec(IV1));
cipher.init(Cipher.DECRYPT_MODE, keySpec, new IvParameterSpec(IV2)); 
```

其中 IV1 和 IV2 是随机生成的 16 字节初始化向量。我这样做是为了检查原始文本和解密文本是否会在加密和解密方中使用不同的 IV 不同。这导致解密文本的字节在前 16 个字节之后与原始文本的字节相同。例如，如果原始文本是：

```
Enter your message here... 
```

解密后的文字是：

```
*****************ge here... 
```

其中 * 表示错误解密的字节，因为它应该是 IV1 和 IV2 不同。

我的问题是：如何使用带有初始化向量的 AES 加密和解密长度大于 16 字节的文本？

# apache-flex - 在flex中下载多个文件

> ID：10557791
> 
> 赞同：3
> 
> 时间：2012-05-11T19:55:37.550
> 
> 标签：apache-flex

我正在用 flex 编写一个文件浏览应用程序。它显示可用文件的列表，可以是任何文件类型，并允许用户选择要下载的文件。我希望用户能够一次选择多个文件并且只点击一次下载按钮。

但是，我遇到了这个问题。FileReference 只允许您一次下载一个文件。所以我想我可以只听完整的事件，然后在上一次下载完成时启动下一次下载。但是，这在 flash 10+ 中不起作用，因为 FileReference 下载方法需要由用户启动 - 这意味着它不能来自事件调用堆栈。

有没有其他我看不到的技术可以让我做到这一点？

# facebook - 我的 Facebook 应用程序不起作用，当用户尝试使用 http 而不是 https 时，为什么？

> ID：10557792
> 
> 赞同：1
> 
> 时间：2012-05-11T19:55:51.257
> 
> 标签：facebook, https, facebook-apps

如果用户没有启用“尽可能使用 https 连接”（在[https://www.facebook.com/settings?tab=security](https://www.facebook.com/settings?tab=security)中），我的应用程序不会加载。如何解决？

带有设置的打印屏幕：

![在此处输入图像描述](../Images/b221aa665cd42a658e9025e19cc42815.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:04:45.420

您需要将 Page Tab URL 和 Canvas URL 设置为 HTTP URL，将 Secure Page Tab URL 和 Secure Canvas URL 设置为 HTTPS URL。

您不能同时使用 HTTP 或 HTTPS，如果您忽略其中任何一个，使用该协议的用户将无法访问您的应用

# ruby - rbenv：在垫片中嵌入“bundle exec”调用是否安全？

> ID：10557795
> 
> 赞同：1
> 
> 时间：2012-05-11T19:56:43.290
> 
> 标签：ruby, bundler, rbenv

如果您从 gem 运行可执行文件，rbenv 要求您手动运行“bundle exec”，以避免加载与 Gemfile 相比不同版本的 gem。

当当前目录中存在 Gemfile 时，让 rbenv 垫片运行“bundle exec”有什么缺点吗？这是一种有点幼稚的方法，因为它不处理位于目录树上方的 Gemfile，但我不需要这种行为。该更改还将确保当前 shim 未命名为“bundle”，否则可能存在无限递归。

修补：

```
diff --git a/libexec/rbenv-rehash b/libexec/rbenv-rehash
index eebc4d3..00f4ec0 100755
--- a/libexec/rbenv-rehash
+++ b/libexec/rbenv-rehash
@@ -38,7 +38,14 @@ create_prototype_shim() {
 #!/usr/bin/env bash
 set -e
 export RBENV_ROOT="$RBENV_ROOT"
-exec rbenv exec "\${0##*/}" "\$@"
+# This only handles Gemfile in current dir
+if [[ \$RBENV_AUTO_BUNDLE = '1' && -e Gemfile && \`basename \$0\` != 'bundle' ]]; then
+  exec 3>/dev/tty
+  echo "rbenv: Using Gemfile" >&3
+  exec rbenv exec bundle exec "\${0##*/}" "\$@"
+else
+  exec rbenv exec "\${0##*/}" "\$@"
+fi
 SH
   chmod +x "$PROTOTYPE_SHIM_PATH"
 } 
```

您必须设置环境变量 RBENV_AUTO_BUNDLE=1 以启用自动“捆绑执行”行为。

如果有足够的需求，我可能会提交一个补丁。

要应用补丁，只需将补丁文件放在您的 .rbenv 目录中，然后运行

```
git apply PATCHFILE 
```

要测试补丁，您必须删除 shim 并运行“rbenv rehash”。

撤销：

```
git apply -R PATCHFILE 
```

或者

```
git checkout -- libexec/rbenv-rehash 
```

然后重新创建垫片。

当您加载 ruby​​ 文件时，vim 似乎会运行一些 ruby​​，并且 bundle exec 也将与它一起使用。您可以通过禁用自动行为`let $RBENV_AUTO_BUNDLE=0`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:59:15.607

> 如果您从 gem 运行可执行文件，rbenv 要求您手动运行“bundle exec”，以避免加载与 Gemfile 相比不同版本的 gem。

除非您使用[rbenv-bundler](https://github.com/carsomyr/rbenv-bundler)插件，恕我直言，这是一种比尝试自己重新实现该行为更明智的方法。如果该插件缺少任何内容，请在此处提供。

# php - PHP OOP 和数组

> ID：10557804
> 
> 赞同：1
> 
> 时间：2012-05-11T19:57:34.787
> 
> 标签：php, arrays, oop

我是 PHP OOP 的新手，我在获取数组时遇到问题。

```
class example
{
    public $array;

    public function __construct()
    {
        $this->array = array();

    }

    public function do_work()
    {
        $this->array[] = 'test';
    }
}
$test = new example();
$test->do_work();
$test->array; 
```

我不断得到一个空数组而不是“测试”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T19:59:02.607

这是因为您从未真正调用过该函数`$test->do_work();` 构造函数只是创建了一个空数组，然后您尝试访问该属性。它*应该*是空的。

**更新**

我看到你更新了你的问题。如果你简单`echo $test->array`，它应该只是打印`Array`。但是，当我复制您更新的代码并执行 a`var_dump($test->array)`时，这是我得到的输出：

```
array(1) { [0]=> string(4) "test" } 
```

我相信这是你所期待的。但是，您在问题中的代码不应输出任何内容。你什么都不做`$test->array`，变量正在被评估然后被丢弃。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T20:08:47.263

你的最后一句话，`$test->array;`实际上并没有做任何事情。我的猜测是您正在使用类似`echo`. 如果您使用例如`var_dump`，您的代码应该输出数组，[请参阅键盘上的示例](http://codepad.org/sqUwUyWJ)

# java - CXF 忽略 Spring bean 配置

> ID：10557808
> 
> 赞同：3
> 
> 时间：2012-05-11T19:57:47.663
> 
> 标签：java, web-services, spring, cxf, jax-rs

我有一个 web 应用程序，它通过 cxf jax-rs 公开了一个 rest web 服务。在我的应用程序上下文文件中，我有这样的东西：

```
 ...
<bean id="service" class="SomeClass">
    <constructor-arg index="0">
        <ref bean="bean1" />
    </constructor-arg>
    <constructor-arg index="1"
        value="some value" />

</bean>

<jaxrs:server id="restContainer" address="/">
    <jaxrs:serviceBeans>
        <ref bean="service" />
    </jaxrs:serviceBeans>
    <jaxrs:providers>
        <bean class="org.codehaus.jackson.jaxrs.JacksonJsonProvider" />
    </jaxrs:providers>
</jaxrs:server>
    ... 
```

我的服务类中还有一个构造函数，它接受这两个参数并初始化服务。

当我部署我的应用程序时，spring 上下文加载器正在正确地创建服务 bean，并且正在调用正确的构造函数。问题是第一个 Rest 请求何时提供服务。Cxf Jax-rs 正在通过“默认构造函数”创建自己的实例，我将失去这两个属性。

如果我使用属性设置器而不是构造函数参数，也会发生同样的事情。当我研究 cxf jax-rs 时，没有一个示例具有具有某些属性的服务！这是有原因的还是cxf的一些实施限制？

有任何想法吗？

# javascript - 在前一个事件完成之前使用新数据处理事件

> ID：10557809
> 
> 赞同：2
> 
> 时间：2012-05-11T19:57:49.360
> 
> 标签：javascript, jquery

这段代码有两个输入：div、div（实际上是一个文本框）和目标（一个数字）。然后它会尝试以伪动画的方式增加/减少数字。问题是我使用 jQuery 滑块作为一种输入形式，这可能导致在第一次调用完成之前进行多次调用。这不是问题，除非滑块快速增加，然后在增加 rollUp 完成之前减少，从而导致 div 永远递减。我不知道是什么原因造成的。想法？

```
function rollNum(div, target) {
var contentString = $(div).val();
content = parseInt(contentString.substring(1));
if(content === target)
    return;
else if(div !== "#costMinusMSP" && div !== "#savingsWithMSP") {
    var total = rollNumTotalCost(div, target);
    rollNum("#costMinusMSP", total);
    rollNum("#savingsWithMSP", total /*- somehow find the cost here*/)
}
if(isNaN(content))
    content = 0;
var remainingChange = target - content;
if(remainingChange > 0)
    loopUp();
else
    loopDown();
function loopUp() {
    var length = remainingChange.toString().length;
    var incrementBy = 1;
    //Find how far away we are from target
    for(var i=0;i<length-1;i++)
        incrementBy *= 10;
    content += incrementBy;
    remainingChange -= incrementBy;
    $(div).val("$" + (content))
    if(content === target)
        return;
    else if(content > target) {
        $(div).val("$" + (target));
        return;
    }
    setTimeout(loopUp, 60);
}
function loopDown() {
    remainingChange = Math.abs(remainingChange);
    var length = remainingChange.toString().length;
    var decrementBy = 1;
    //Find how far away we are from target
    for(var i=0;i<length-1;i++)
        decrementBy *= 10;
    content -= decrementBy;
    remainingChange -= decrementBy;
    if(content < target) {
        $(div).val("$" + (target));
        return;
    }
    //This ensures we won't promise our clients negative values.
    if(content <= 0) {
        $(div).val("$0");
        return;
    }
    $(div).val("$" + (content))
    if(content === target)
        return;
    setTimeout(loopDown, 60);
}
} 
```

奇怪的是，调整另一个滑块（修改不相关的 div）修复了永久递减。

我尝试过的事情： - 创建一个布尔“运行”，该函数设置为 true，然后在返回之前为 false。如果 running 为 true，则该函数将等到它为 false 时继续执行。这会杀死浏览器或达到最大堆栈。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2014-05-23T21:39:28.937

几年前的一些小猫：自从你问这个问题以来，你学到了很多东西，特别是关于管理状态和多个事件（更不用说如何正确地提出 StackOverflow 问题）。一个简单的答案是这样的：

```
var rolling = false;

function rollNum(div, target) {
  if (rolling) { return; }
  rolling = true;

  // Set rolling to false when done
} 
```

这一切都很好，但它忽略了我们滚动时触发的任何事件。上述内容不会适应第一次调整后滑块上所做的更改，但在数字完成滚动之前。现在，我（我们？）会使用 Angular（`$scope.$watch`在这里会派上用场）但是当你在做这个的时候它并不存在。我们为什么不检查滑块上的*实时值，而不是传递一个目标数字？*（注意使用香草JS，它*要*快得多）。

```
var rollNum = function(textarea) {
  var content = parseInt(textarea.value.substring(1), 10)
    , target = parseInt(document.getElementById('sliderId').value, 10);

  if (content === target) {
    return;
  }

  // Roll up/down logic

  setTimeout(function() { rollNum(textarea); }, 60);
}; 
```

其他一些其他变化：

*   `if`在语句后使用括号。Waaaay 更容易调试
*   不要忘记 radix 参数`parseInt`

不幸的是，您没有考虑包含 JSFiddle，因此我无法提供现场演示。

# ios - 如何将电子邮件添加到现有的 iOS 应用程序

> ID：10557811
> 
> 赞同：0
> 
> 时间：2012-05-11T19:57:52.310
> 
> 标签：ios, email, tabbar

我基于 Apple 的“Tabster”示例代码创建了一个应用程序。该应用程序运行良好，但我想向它添加电子邮件。我创建了一个电子邮件应用程序。并尝试了我能想到的所有方法，从教程中学习或阅读，但它不断崩溃。我在 Apple Dev 上提出了这个问题。论坛和几个回应是简单地“将文件复制到现有的应用程序。你应该很好。” 显然不是这么简单。我已经添加了 MessageUI 框架并尝试以多种不同的方式复制文件，但我仍然卡住了。今天是星期五，这个问题从星期一开始就一直困扰着我。我猜第一部分是有 2 个 main.m 文件，我尝试将它们组合起来，我尝试将邮件的 main.m 文件重命名为 emailmain.m。我不知道还能尝试什么。

令我惊讶的是，所有关于在 iOS 应用程序中创建电子邮件的文档和教程都从创建新应用程序开始。我错过了什么？如何将电子邮件添加到功能齐全的应用程序中。我将不胜感激有关该主题的任何指导、文献链接或教程。

我能得到的任何帮助将不胜感激。我还想添加其他几种类型的东西，但我什至无法在其中实现电子邮件！

感谢您提供的帮助。约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T20:03:38.543

这是我一直使用的方法。它应该能够简单而干净地添加到任何 UIViewController 中。

导入您的框架：

```
#import <MessageUI/MessageUI.h> 
```

确保在界面中包含您的委托：

```
@interface MyViewController : UIViewController <MFMailComposeViewControllerDelegate> 
```

然后在您的实现中添加此方法或变体，如果您需要它是 IBAction 或类似的东西：

```
- (void)sendEmail
{    
    if ([MFMailComposeViewController canSendMail]) {
        MFMailComposeViewController *email = [[MFMailComposeViewController alloc] init];
        email.mailComposeDelegate = self;

        [email setSubject:@"My Email Subject"];

        [email setMessageBody:@"My message body." isHTML:NO];

        [self presentModalViewController:email animated:YES];

    } else {
        UIAlertView *emailAlert = [[UIAlertView alloc] initWithTitle:@"Email Failure" message:@"Your device is not configured to send email" delegate:self cancelButtonTitle:@"OK" otherButtonTitles: nil];
        [emailAlert show];
    }
} 
```

你可以在按钮点击或任何你想要的时候调用这个方法。它将打开一个电子邮件编辑器视图，您的用户可以在其中点击发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:18:29.267

这是创建带有图像作为附件的电子邮件的示例代码。您可以根据需要对其进行修改。

```
-(void)createEmail 
    {
    NSMutableString *emailBody = [[[NSMutableString alloc] initWithString:@"<html><body>"] retain];
       [emailBody appendString:@"<p>Some email body text can go here</p>"];
       UIImage *emailImage = [UIImage imageNamed:@"myImageName.png"];
       NSData *imageData = [NSData dataWithData:UIImagePNGRepresentation(emailImage)];

       NSString *base64String = [imageData base64EncodedString];
      [emailBody appendString:[NSString stringWithFormat:@"<p><b><img src='data:image/png;base64,%@'></b></p>",base64String]];
      [emailBody appendString:@"</body></html>"];
        NSLog(@"%@",emailBody);

     //mail composer window
        MFMailComposeViewController *emailDialog = [[MFMailComposeViewController alloc] init];
        emailDialog.mailComposeDelegate = self;
        [emailDialog setSubject:@"My Inline Image Document"];
        [emailDialog setMessageBody:emailBody isHTML:YES];

        [self presentModalViewController:emailDialog animated:YES];
        [emailDialog release];
        [emailBody release];
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:07:10.567

您需要导入 MessageUI 框架。无论您想在哪里使用它，都将其导入相应的 .h 文件并设置 MFMailComposeViewControllerDelegate。

```
#import <MessageUI/MessageUI.h>
@interface ViewController : UIViewController <MFMailComposeViewControllerDelegate> 
```

然后，当您要发送消息时，请在 .m 文件中使用以下代码：

```
MFMailComposeViewController *mailViewController = [[MFMailComposeViewController alloc] init];
mailViewController.mailComposeDelegate = self;

// Optional Configuration Parameters to make life easier for the user
[mailViewController setSubject:subjectString];
[mailViewController setMessageBody:messageString isHTML:YES];
[mailViewController setToRecipients:recipientsArray];

// Present the VIew Controller and clean up after ourselves
[self presentModalViewController:mailViewController animated:YES];
[mailViewController release]; 
```

添加适当的委托方法，您可以在发送电子邮件后使用它来关闭控制器：

```
-(void)mailComposeController:(MFMailComposeViewController*)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error {
    [self dismissModalViewControllerAnimated:YES];
} 
```

# c - Yacc 如何扩展这条规则？

> ID：10557812
> 
> 赞同：0
> 
> 时间：2012-05-11T19:57:54.380
> 
> 标签：c, linked-list, lex

我有以下规则`Yacc`，我想从中创建一个链表，但是当我尝试打印它时，我一直在获取列表中的最后一个节点：

```
node_list
:                                                   {$$=NULL;}
| node_list node                                    {if ($1 != NULL) $1->next=$2; $$=$2;    }
; 
```

我的理解是，例如，如果这是列表

```
node1
node2
node3 
```

`Yacc`将其扩展为

```
node_list node3
node_list node2 node3
ndoe_list node1 node2 node3
NULL node1 node2 node3 
```

但由于我得到了上面代码的最后一个节点，所以我的猜测是列表以崇高的顺序展开

```
node_list node1
node_list node2 node1
ndoe_list node3 node2 node1
NULL node3 node2 node1 
```

那么我尝试使用以下代码：

```
node_list
:                                                   {$$=NULL;}
| node_list node                                    {$2->next=$1; $$=$2 ;   }
; 
```

我知道在每种情况下我都会返回列表中的最后一个节点，这就是为什么我只得到一个节点。所以我尝试了这段代码：

```
node_list
:                                                   {$$=NULL;}
| node_list node                                    {$$=linkXmlNode($1,$2);}
; 
```

`linkXmlNode`在哪里

```
XmlNode * linkXmlNode(XmlNode * first, XmlNode * second)
{
XmlNode * temp = second;
while (second->next != NULL) 
    second=second->next;

second->next=first; 
return temp;
} 
```

现在我让最后一个节点每次重复 3 次。我也尝试了另一个方向，但现在我得到了第一个节点：

```
XmlNode * linkXmlNode(XmlNode * first, XmlNode * second)
{
if (first == NULL) return second;
XmlNode * temp = first;
while (first->next != NULL)
    first= first->next;
first->next = second;
return temp
} 
```

如果有人知道如何`Yacc`扩展列表，那就太好了。

* * *

**编辑：回答** 我的打印功能有误，上述功能有效。错误是我没有打印迭代器，而是打印参数，因此多次获得同一个节点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:15:38.057

```
if ($1 != NULL) $1->next=$2; $$=$2; 
```

返回`$2`，但`$2`不指向`$1`; 你指`$1`的是`$2`相反，但你没有回来`$1`，所以什么都不会知道。（什么东西，只给定`$2`，应该知道如何得到，`$1`因为它只`$1`知道这种关系？）

```
$2->next=$1; $$=$2 
```

应该给你你的清单，但顺序相反。要以其他顺序获取它，您需要同时传递一个头指针和尾指针，或者在列表上插入一个附加规则以在传递它之前反转列表。

您的第三次尝试在链接方面最接近正确；如果您获得相同的数据，它留下了如何复制列表元素的问题。请注意，`yacc`它本身对您的列表一无所知；*它*根本不会“扩展”列表，这就是*您的*代码应该做的。

（我不清楚你的最新评论是否表明你已经解决了你的问题。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:18:20.633

你得到以下产品：

```
 => nodeList
nodeList node1 => nodeList
nodeList node2 => nodeList
nodeList node3 => nodeList 
```

因此，在您的第一种情况下，您的列表从 null 开始，然后将 node1 附加到它，然后将 node2 附加到它，然后将 node3 附加到它。我要说的是，您将节点链接到列表末尾的代码应该会导致最终列表按升序排列，但我刚刚看到您的编辑表明它一直都是正确的。

# c# - 如何使用 TFS API 获取特定构建

> ID：10557814
> 
> 赞同：6
> 
> 时间：2012-05-11T19:58:06.697
> 
> 标签：c#, asp.net-mvc-3, tfs

我正在尝试从 TFS 获得特定的构建，但这非常困难。我有一个 MVC 应用程序可以触发这样的构建：

```
 IBuildServer buildServer = (IBuildServer)Server.GetService(typeof(IBuildServer));
 IBuildDefinition def = buildServer.GetBuildDefinition(TeamProject, BuildDefinition);

 var queuedBuild = buildServer.QueueBuild(def); 
```

QueueBuild 返回 IQueuedBuild，我希望做这样的事情：

```
return queuedBuild.Build.BuildNumber 
```

这样我就有了一些独特的价值，我可以用它来查询构建服务器以获取正确的构建。不幸的是，当执行退出此方法时，Build 可能为空，也可能不为空，所以这是不行的。

构建排队后，我然后轮询此方法

```
 public string GetBuildStatus(string TeamProject, string BuildDefinition, string BuildNumber)
 {
        string status = string.Empty;
        IBuildDetailSpec buildDetailSpec = buildServer.CreateBuildDetailSpec(TeamProject, BuildDefinition);
        buildDetailSpec.MaxBuildsPerDefinition = 1;
        buildDetailSpec.Status = BuildStatus.InProgress | BuildStatus.None;
        buildDetailSpec.QueryOrder = BuildQueryOrder.FinishTimeDescending;

        IBuildQueryResult queryResult = buildServer.QueryBuilds(buildDetailSpec);

        if (queryResult.Builds.Length > 0)
        {
            status = queryResult.Builds[0].Status.ToString();
        }

        return status;
 } 
```

这在某种程度上可行，但如果队列中有多个构建，我无法在此轮询方法中知道我正在使用的构建是否是我在第一种方法中排队的构建。有谁知道我可以做些什么来取回在第一种方法中排队的特定构建？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-14T13:09:40.537

此方案的关键是使用排队构建的 ID。所以我所做的是：

```
 public int QueuBuild(string TeamProject, string BuildDefinition)
    {
        IBuildServer buildServer = (IBuildServer)Server.GetService(typeof(IBuildServer));
        IBuildDefinition def = buildServer.GetBuildDefinition(TeamProject, BuildDefinition);

        var queuedBuild = buildServer.QueueBuild(def);
        return queuedBuild.Id;
    } 
```

然后在轮询方法中

```
 public string GetBuildStatus(string TeamProject, string BuildDefinition, int BuildID)
    {
        IBuildServer buildServer = (IBuildServer)Server.GetService(typeof(IBuildServer));

        string status = string.Empty;
        IQueuedBuildSpec qbSpec = buildServer.CreateBuildQueueSpec(TeamProject, BuildDefinition);

        IQueuedBuildQueryResult qbResults = buildServer.QueryQueuedBuilds(qbSpec);
        if(qbResults.QueuedBuilds.Length > 0)
        {
            IQueuedBuild build = qbResults.QueuedBuilds.Where(x => x.Id == BuildID).FirstOrDefault();
            status = build.Status.ToString();
        }

        return status;
    } 
```

希望这对未来的人有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T20:08:55.650

如果构建排队等待代理，您可以调用[`queueBuild.WaitForStart();`](http://msdn.microsoft.com/en-us/library/cc340493)

然后返回`queryResult.Build.Uri;`属性并使用它进行轮询，内部版本号不会立即分配。

然后，您可以使用该方法`IBuildDetail buildDetail = server.GetBuild(buildUri);`获取构建的状态。

# php - 使用 Google Visualization 有没有办法交换 x 和 y 轴？

> ID：10557815
> 
> 赞同：2
> 
> 时间：2012-05-11T19:58:08.270
> 
> 标签：php, javascript, google-visualization

我已经格式化了一个 php 数据数组，其中包含列的教师和行的测试。我对 ColumnChart 和 Table 使用相同的数组。为 ColumnChart 正确设置了数据，但是当我在表格上使用它时，数据与我想要的相反（教师需要在左侧，测试需要在顶部）。

有没有一种简单的方法可以使用 Google Visualization 切换 x 和 y 轴，而无需在 PHP 端对其进行格式化？

这是一些虚拟 GV 的东西。

```
var data = new google.visualization.DataTable(studentdata, 0.5);

var table = new google.visualization.Table(document.getElementById(container)); 
var chart = new google.visualization.ColumnChart(document.getElementById(container2)); 

table.draw(data, options); 
chart.draw(data, options); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:40:23.447

在将 x 和 y 数据传递给 GV 之前，您应该能够使用 javascript 切换数据。

```
var x = studentdata.y,
    y = studentdata.x;

studentdata.x = y;
studentdata.y = x; 
```

但是您知道...将 x 和 y 切换为您的学生数据实际具有的变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-27T19:11:13.283

此图表的水平版本在 Google 的世界中称为 BarChart，因此您可以使用：

`var chart = new google.visualization.BarChart(document.getElementById(container2));`

# gpu - 使用 Sun Grid Engine (SGE) 调度 GPU 资源

> ID：10557816
> 
> 赞同：4
> 
> 时间：2012-05-11T19:58:08.860
> 
> 标签：gpu, gpgpu, sungridengine, multiple-gpu

我们有一个机器集群，每台机器有 4 个 GPU。每个工作应该能够要求 1-4 个 GPU。这里有一个问题：我希望 SGE 告诉每个工作它应该使用*哪个GPU。*与 CPU 不同，如果一次只有一个进程访问 GPU，GPU 的工作效果最好。所以我想：

```
Job #1  GPU: 0, 1, 3
Job #2  GPU: 2
Job #4  wait until 1-4 GPUs are avaliable 
```

我遇到的问题是，SGE 将让我在每个节点上创建一个具有 4 个单元的 GPU 资源，但它不会明确告诉作业使用哪个 GPU（只有它获得 1 或 3，或任何）。

`gpu0, gpu1, gpu2, gpu3`我`-l`想创建 4 个资源（有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T07:15:48.253

当您有多个 GPU 并且您希望您的作业请求 GPU 但 Grid Engine 调度程序应处理并选择*空闲*GPU 时，您可以配置 RSMAP（资源映射）复合体（而不是 INT）。这允许您在主机配置中指定特定主机上的 GPU 数量和名称。您还可以将其设置为主机消耗品，以便独立于您请求的插槽，使用 -l cuda=2 请求的 GPU 设备数量适用于每个主机 2（即使并行作业在不同主机上获得了 8 个插槽） ）。

```
qconf -mc
    #name               shortcut   type        relop   requestable consumable default  urgency     
    #----------------------------------------------------------------------------------------------
    gpu                 gpu        RSMAP         <=      YES         HOST        0        0 
```

在执行主机配置中，您可以使用 ids/names（这里只是 GPU1 和 GPU2）初始化您的资源。

```
qconf -me yourhost
hostname              yourhost
load_scaling          NONE
complex_values        gpu=2(GPU1 GPU2) 
```

然后，当请求 -l gpu=1 时，如果 GPU1 已被其他作业使用，Univa Grid Engine 调度程序将选择 GPU2。您可以在 qstat -j 输出中看到实际选择。该作业通过读取 $SGE_HGR_gpu 环境变量来获取选定的 GPU，在这种情况下，该变量包含选择的 ID/名称“GPU2”。这可用于访问正确的 GPU 而不会发生冲突。

如果您有一个多插槽主机，您甚至可以将 GPU 直接连接到 GPU 附近（靠近 PCIe 总线）的一些 CPU 内核，以加快 GPU 和 CPU 之间的通信。这可以通过在执行主机配置中附加拓扑掩码来实现。

```
qconf -me yourhost
hostname              yourhost
load_scaling          NONE
complex_values        gpu=2(GPU1:SCCCCScccc GPU2:SccccSCCCC) 
```

现在，当 UGE 调度程序选择 GPU2 时，它会自动将作业绑定到第二个插槽 (S) 的所有 4 个核心 (C)，因此不允许作业在第一个插槽上运行。这甚至不需要 -binding qsub 参数。

您可以在[www.gridengine.eu](http://www.gridengine.eu)上找到更多配置示例。

请注意，所有这些功能仅在 Univa Grid Engine（8.1.0/8.1.3 及更高版本）中可用，而在 SGE 6.2u5 和其他 Grid Engine 版本（如 OGE、Sun of Grid Engine 等）中不可用。您可以通过从 univa.com 下载 48 核有限免费版本来试用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-16T15:00:03.737

如果您使用的是其他 Grid Engine 变体之一，您可以尝试调整我们在集群上使用的脚本： [https ://github.com/UCL/Grid-Engine-Prolog-Scripts](https://github.com/UCL/Grid-Engine-Prolog-Scripts)

# delphi - Delphi TMemo 阻塞 模式？

> ID：10557820
> 
> 赞同：1
> 
> 时间：2012-05-11T19:58:13.507
> 
> 标签：delphi, delphi-7

我有一个巨大的字符串要添加到 Delphi7 的备忘录中。字符串大约 1MB 大并且有很多 (Unicode) 字符。我的显卡不是最好的（英特尔 GMA 500）。我添加文本：

```
Memo1.Lines.Append(MyString); 
```

但是，看起来程序比我的备忘录中的绘图要快。有没有办法在“阻塞模式”中编码 - 这意味着当所有字符都被绘制时程序结束？

谢谢您的帮助。

编辑：我也用过：

```
Memo1.Lines.BeginUpdate;
Memo1.Lines.Append(MyString);
Memo1.Lines.EndUpdate; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:46:57.053

After adding your text, call `Memo1.Update`. That won't return until the memo has updated its display — it forces the memo to paint itself.

# backup - 用于备份目的的第二个 NIC 上的 SSTP

> ID：10557823
> 
> 赞同：0
> 
> 时间：2012-05-11T19:58:27.023
> 
> 标签：backup, windows-server-2008, vpn, nic

我们正在运行几个服务器，它们都运行 Windows Server 2008，第一个是远程 Web 服务器，它通过第一个 NIC 提供 HTTP。它安装了第二个 NIC，我想通过 VPN 使用我们的内部本地服务器将它用于专用备份。

我已经在远程服务器上设置了 VPN，但这就是我对 Server 2008 缺乏经验的地方。我无法理解如何让备份服务器连接到第二个 NIC。这将是唯一连接到第二个 NIC 的机器。

此外，我的老板已经购买并希望我在备份机器上使用 ViceVersaPRO 来使用他们的 VVEngine 从远程机器获取文件夹以使其自动化。

除了让该死的机器连接外，我似乎一切正常。即使是指向教程的链接（我做了很多搜索）也会有所帮助。

我在这里实现这一目标的最佳选择是什么？我应该使用 SSTP 吗？我确信我可以让我的老板使用最有效的方法。

# ruby - Ruby：从阿拉伯字符中解析日期？

> ID：10557825
> 
> 赞同：1
> 
> 时间：2012-05-11T19:58:51.967
> 
> 标签：ruby, ruby-on-rails-3.2

所以我有一个从 ios 应用程序接收日期的 rails 应用程序。一位用户发布的日期如下所示：“٢٠١٢-٠٥-٠١ ٠٩:٤٠:٣٨ +0000”。当 ruby​​ 尝试获取该字符串并从中解析日期时，它会崩溃。关于如何在我的 rails 应用程序或 ios 应用程序（我无法触摸，但朋友维护）中处理这些类型的字符串的任何线索？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:08:42.847

```
#encoding: utf-8

puts "٢٠١٢-٠٥-٠١ ٠٩:٤٠:٣٨ +0000".tr('٠١٢٣٤٥٦٧٨٩', '0123456789')
#=>2012-05-01 09:40:38 +0000 
```

# node.js - Node.js、Socket.io、Redis pub/sub 大容量、低延迟困难

> ID：10557826
> 
> 赞同：68
> 
> 时间：2012-05-11T19:58:52.980
> 
> 标签：node.js, redis, socket.io, publish-subscribe, low-latency

当结合 socket.io/node.js 和 redis pub/sub 试图创建一个由服务器事件驱动的可以处理多个传输的实时网络广播系统时，似乎有三种方法：

1.  'createClient' 一个 redis 连接并订阅频道。在 socket.io 客户端连接上，将客户端加入到 socket.io 房间。在 redis.on("message", ...) 事件中，调用 io.sockets.in(room).emit("event", data) 分发给相关房间的所有客户端。比如[如何在socket.io中重用redis连接？](https://stackoverflow.com/questions/5739357/how-to-reuse-redis-connection-in-socket-io)

2.  'createClient' 一个 redis 连接。在 socket.io 客户端连接上，将客户端加入到 socket.io 房间并订阅相关的 redis 频道。在客户端连接关闭中包含 redis.on("message", ...) 并在收到消息调用 client.emit("event", data) 以在特定客户端上引发事件。就像[在 socket.io 中使用 RedisStore 的示例中的答案一样](https://stackoverflow.com/questions/9267292/examples-in-using-redisstore-in-socket-io)

3.  根据 socketio-spec 协议，使用 RedisStore 烘焙到 socket.io 中并从 Redis 中的单个“调度”通道“广播”。

数字 1 允许为所有客户端处理一次 Redis 子和关联事件。2 号提供了一个更直接的挂钩到 Redis 发布/订阅。数字 3 更简单，但对消息传递事件几乎没有控制。

但是，在我的测试中，所有连接的客户端都表现出出乎意料的低性能。有问题的服务器事件是尽快发布到 redis 通道的 1,000 条消息，以便尽快分发。性能是通过连接客户端的时间来衡量的（socket.io-client 基于将时间戳记录到 Redis 列表中进行分析）。

我推测在选项 1 中，服务器接收到消息，然后将其依次写入所有连接的客户端。在选项 2 中，服务器多次接收每条消息（每个客户端订阅一次）并将其写入相关客户端。在任何一种情况下，服务器都不会到达第二个消息事件，直到它与所有连接的客户端通信。随着并发性的增加，情况明显恶化。

这似乎与堆栈功能的感知智慧不一致。我想相信，但我很挣扎。

这种情况（大量消息的低延迟分布）是不是这些工具的选项（还没有？），还是我错过了一个技巧？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-13T21:31:51.190

我认为这是一个合理的问题，并在不久前对其进行了简短的研究。我花了一些时间搜索示例，您可以从中获得一些有用的提示。

## 例子

我喜欢从简单的例子开始：

*   [轻即时示例代码](https://gist.github.com/374881)
*   [Node.js + Redis Pub/Sub + socket.io 演示](https://github.com/steffenwt/nodejs-pub-sub-chat-demo)

轻量级示例是单页（请注意，您需要将 redis-node-client 替换为 Matt Ranney 的[node_redis 之类的东西：](https://github.com/mranney/node_redis)

```
/*
 * Mclarens Bar: Redis based Instant Messaging
 * Nikhil Marathe - 22/04/2010

 * A simple example of an IM client implemented using
 * Redis PUB/SUB commands so that all the communication
 * is offloaded to Redis, and the node.js code only
 * handles command interpretation,presentation and subscribing.
 * 
 * Requires redis-node-client and a recent version of Redis
 *    http://code.google.com/p/redis
 *    http://github.com/fictorial/redis-node-client
 *
 * Start the server then telnet to port 8000
 * Register with NICK <nick>, use WHO to see others
 * Use TALKTO <nick> to initiate a chat. Send a message
 * using MSG <nick> <msg>. Note its important to do a
 * TALKTO so that both sides are listening. Use STOP <nick>
 * to stop talking to someone, and QUIT to exit.
 *
 * This code is in the public domain.
 */
var redis = require('./redis-node-client/lib/redis-client');

var sys = require('sys');
var net = require('net');

var server = net.createServer(function(stream) {
    var sub; // redis connection
    var pub;
    var registered = false;
    var nick = "";

    function channel(a,b) {
    return [a,b].sort().join(':');
    }

    function shareTable(other) {
    sys.debug(nick + ": Subscribing to "+channel(nick,other));
    sub.subscribeTo(channel(nick,other), function(channel, message) {
        var str = message.toString();
        var sender = str.slice(0, str.indexOf(':'));
        if( sender != nick )
        stream.write("[" + sender + "] " + str.substr(str.indexOf(':')+1) + "\n");
    });
    }

    function leaveTable(other) {
    sub.unsubscribeFrom(channel(nick,other), function(err) {
        stream.write("Stopped talking to " + other+ "\n");
    });
    }

    stream.addListener("connect", function() {
    sub = redis.createClient();
    pub = redis.createClient();
    });

    stream.addListener("data", function(data) {
    if( !registered ) {
        var msg = data.toString().match(/^NICK (\w*)/);
        if(msg) {
        stream.write("SERVER: Hi " + msg[1] + "\n");
        pub.sadd('mclarens:inside', msg[1], function(err) {
            if(err) {
            stream.end();
            }
            registered = true;
            nick = msg[1];
// server messages
            sub.subscribeTo( nick + ":info", function(nick, message) {
            var m = message.toString().split(' ');
            var cmd = m[0];
            var who = m[1];
            if( cmd == "start" ) {
                stream.write( who + " is now talking to you\n");
                shareTable(who);
            }
            else if( cmd == "stop" ) {
                stream.write( who + " stopped talking to you\n");
                leaveTable(who);
            }
            });
        });
        }
        else {
        stream.write("Please register with NICK <nickname>\n");
        }
        return;
    }

    var fragments = data.toString().replace('\r\n', '').split(' ');
    switch(fragments[0]) {
    case 'TALKTO':
        pub.publish(fragments[1]+":info", "start " + nick, function(a,b) {
        });
        shareTable(fragments[1]);
        break;
    case 'MSG':
        pub.publish(channel(nick, fragments[1]),
            nick + ':' +fragments.slice(2).join(' '),
              function(err, reply) {
              if(err) {
                  stream.write("ERROR!");
              }
              });
        break;
    case 'WHO':
        pub.smembers('mclarens:inside', function(err, users) {
        stream.write("Online:\n" + users.join('\n') + "\n");
        });
        break;
    case 'STOP':
        leaveTable(fragments[1]);
        pub.publish(fragments[1]+":info", "stop " + nick, function() {});
        break;
    case 'QUIT':
        stream.end();
        break;
    }
    });

    stream.addListener("end", function() {
    pub.publish(nick, nick + " is offline");
    pub.srem('mclarens:inside', nick, function(err) {
        if(err) {
        sys.debug("Could not remove client");
        }
    });
    });
});

server.listen(8000, "localhost"); 
```

## 文件

那里有大量文档，并且 api 在这种类型的堆栈上迅速变化，因此您必须权衡每个文档的时间相关性。

*   [节点活动流](http://blog.cloudfoundry.com/2012/05/17/node-activity-streams-app-1/)
*   [云代工示例](http://blog.cloudfoundry.com/tag/nodejs/)
*   [如何节点 redis pubsub](http://howtonode.org/redis-pubsub)
*   [redis 延迟](http://redis.io/topics/latency)
*   [redis cookbook 使用 Pub/Sub 进行异步通信](http://rediscookbook.org/pubsub_for_asynchronous_communication.html)
*   [LinkedIn 的通用提示](http://engineering.linkedin.com/nodejs/blazing-fast-nodejs-10-performance-tips-linkedin-mobile)
*   [节点 redis 绑定](https://github.com/mranney/node_redis)
*   [谷歌组nodejs问题](https://groups.google.com/forum/#!topic/nodejs/Ifw-wlR1LZI)

## 相关问题

只是几个相关的问题，这是堆栈上的热门话题：

*   [用于 node.js 中聊天服务器的 Redis pub/sub](https://stackoverflow.com/questions/7463714/redis-pub-sub-for-chat-server-in-node-js?rq=1)
*   [如何为即时消息系统设计 redis pub/sub？](https://stackoverflow.com/questions/10142246/how-to-design-redis-pub-sub-for-an-instant-messaging-system?rq=1)

## 值得注意的提示（ymmv）

关闭或优化套接字池，使用有效的绑定，监控延迟，并确保您没有重复工作（即无需向所有侦听器发布两次）。

# sublimetext2 - SublimeCodeIntel 没有显示我的 CSS 样式

> ID：10557829
> 
> 赞同：2
> 
> 时间：2012-05-11T19:59:01.073
> 
> 标签：sublimetext2

我安装了 SublimeCodeIntel，但是当我尝试使用自动完成功能时，我没有看到我的 css 文件中的类。例如。

我有一个名为 style.css 的 css 文件

```
.example{
color:black;
font-size:18px;
} 
```

但是在我的 HTML 中，我尝试做`<div class="">`当我在引号内时，我会弹出一个带有一些 css 数据的弹出窗口，但数据只是来自我所在的页面。我没看到`test`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:13:25.330

您是否按照 git hub 页面上的故障排除步骤进行操作？ [https://github.com/Kronuz/SublimeCodeIntel](https://github.com/Kronuz/SublimeCodeIntel)

它提到了 build.sh 和“可以使用“codeintel_live_disabled_languages”在每种语言的基础上禁用实时自动完成。例如“codeintel_live_disabled_languages”：['css']”

# html - 为什么 Vaadin gwt 输入字段没有 id 和没有名称？

> ID：10557834
> 
> 赞同：1
> 
> 时间：2012-05-11T19:59:26.560
> 
> 标签：html, gwt, vaadin

我想知道为什么 Vaadin GWT 组件没有 id 或名称？我在问，因为我想使用外部 Java 脚本来引用它们，例如使用 document.getElementById('foo')。

有谁知道为什么要添加这些属性？

谢谢，斯蒂芬妮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T14:17:17.490

您可以使用 setDebugId 为 Vaadin 组件设置 id：

```
button.setDebugId("myDebugId"); 
```

从 vaadin 7 开始，不推荐使用 setDebugId 并且：

```
button.setId("myDebugId"); 
```

应该使用

# web-services - 将 ws-security 添加到使用 Eclipse 构建的 SOAP 轴 1.4 Web 服务？

> ID：10557839
> 
> 赞同：1
> 
> 时间：2012-05-11T20:00:13.903
> 
> 标签：web-services, soap, axis, ws-security

我使用 Eclipse 和轴 1.4 构建了一个简单的 SOAP Web 服务。一切运作良好。我想将其增强为：

1) 要求对请求进行数字签名 2) 验证这些签名 3) 允许我检查用于签署请求的证书

任何指导将不胜感激。我不介意 RTFM，但我什至不知道从什么手册开始。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:22:30.380

看来我可以将 Axis 与 WSS4J 集成以完成我所追求的目标：

[http://ws.apache.org/wss4j/axis.html](http://ws.apache.org/wss4j/axis.html)

将尽快更新集成...

# cakephp - 将 query() 转换为 find() cakephp

> ID：10557840
> 
> 赞同：0
> 
> 时间：2012-05-11T20:00:14.593
> 
> 标签：cakephp, find, case

```
 $v = array(1,11.38,15.8);
    $sortByPrice = $this->Product->query
    (
    "SELECT *,
    CASE `currency` 
        WHEN '1' THEN $v[0]
        WHEN '2' THEN $v[1]
        WHEN '3' THEN $v[2]
    END AS 'ratio'
    FROM products
    ORDER BY price*ratio DESC
    "
    ); 
```

我想将上面的内容转换为我尝试过的查找功能（但它不起作用）..

```
 $v = array(1,11.38,15.8);
    $bla = $this->Product->find('all', array(
    'conditions' => array(
    'Product.currency',
    '((
        CASE WHEN 
            Product.currency=1 THEN $v[0]
            Product.currency=2 THEN $v[1]
            Product.currency=3 THEN $v[2]
        END
    )) AS ratio'),
    'order' => 'ratio',
     'limit' => 10
     )); 
```

有人可以将查询转换为查找吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:58:57.527

你正在把`conditions`钥匙放进去。将其移入`fields`钥匙或使其成为`virtualField`-*可能*有效。

编辑：也`$v[0]`用单引号实际上不会用变量替换它 - 它只会显示为该文本。

# xml - XSLT element sort via join

> ID：10557841
> 
> 赞同：0
> 
> 时间：2012-05-11T20:00:14.697
> 
> 标签：xml, xslt

Would like to sort the following XML by joining the `fsxml/formula/ingrrow` where `itemcode = fsxml/item` (attribute `objkey`) and having the elements named `erpplantnr_11` through `erpplantnr_30` from item moved after the last `attribute10` element for each `ingrrow`.

Thanks in advance for any help that can be provided!

(Simplifying and providing first XSLT attempt) (Simplified example - want to move erpplantnr_11 element after attribute1 element where the attribute objkey matches the itemcode element)

Looking for help on how to create the "join". Thanks again.

(XSLT):

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
xmlns:ms="urn:schemas-microsoft-com:xslt" 

xmlns:fsxml="http://www.FormationSystems.com" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="formula">
  <xsl:copy>
    <xsl:apply-templates select="@*"/>
    <xsl:apply-templates select="ingrrow"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="ingrrow | item">
  <xsl:copy>
    <xsl:apply-templates select="@*"/>
    <xsl:apply-templates select="itemcode"/>
    <xsl:apply-templates select="attribute1"/>
    <xsl:apply-templates select="erpplantnr_11"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="fsxml/fsxml">
  <xsl:apply-templates select="item"/>
</xsl:template>

</xsl:stylesheet> 
```

Resultant XML - Need to match the two item objectkey attributes with their ingrrow itemcodes and have the output xml list the erpplantnr_11 element after the attribute1 element:

```
<fsxml>
  <formula maxcol="51" keycount="2" fmt="A" dtlcodes="HEADER\INGR" objectkey="NOR000133\0002" filteredfields="" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <ingrrow detail="1" fmt="X">
      <itemcode>NOR60506</itemcode> 
      <attribute1>000000000050051116</attribute1> 
    </ingrrow>
    <ingrrow detail="1" fmt="X">
      <itemcode>7K015</itemcode> 
      <attribute1>000000000000800479</attribute1> 
    </ingrrow>
  </formula>
  <item maxcol="35" keycount="1" fmt="A" dtlcodes="HEADER" objectkey="NOR60506" filteredfields="" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <erpplantnr_11>121212;343434</erpplantnr_11> 
  </item>
  <item maxcol="35" keycount="1" fmt="A" dtlcodes="HEADER" objectkey="7K015" filteredfields="" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <erpplantnr_11>123456</erpplantnr_11> 
  </item>
</fsxml> 
```

Original XML:

```
<fsxml>
  <formula maxcol="51" keycount="2" fmt="A" dtlcodes="HEADER\INGR" objectkey="NOR000133\0002" filteredfields="" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <keycode>NOR000133</keycode> 
      <keycode2>0002</keycode2> 
      <description>48782 ALABASTER WHITE MB9960 NA</description> 
      <formulaalias /> 
      <alternateformula /> 
      <timedate xsi:nil="true" /> 
      <productcode /> 
      <productdescr /> 
      <reportcode /> 
      <reportregion /> 
      <alias_code1 /> 
      <alias_code2 /> 
      <alias_code3 /> 
      <alias_code4 /> 
      <alias_code5 /> 
      <alias_code6 /> 
      <alias_code7 /> 
      <alias_code8 /> 
      <hseapacdoc /> 
      <hseemeadoc /> 
      <hsenasadoc /> 
      <wau_local_designee /> 
      <apac1_local_designee /> 
      <apac2_local_designee /> 
      <apc_local_designee /> 
      <emea_local_designee /> 
      <na_local_designee>PREST</na_local_designee> 
      <sa_local_designee /> 
      <ras_sent>Yes</ras_sent> 
      <erp_waunr /> 
      <erp_apac1nr /> 
      <erp_apac2nr /> 
      <erp_apcnr /> 
      <erp_emeanr /> 
      <erp_nornr /> 
      <erp_sanr /> 
      <crfc_code>NOR000133</crfc_code> 
      <orig_desc /> 
      <erpglobal_1 /> 
      <erpglobal_2 /> 
      <erpglobal_3 /> 
      <uomcode>KG</uomcode> 
      <itemcode>NOR000133</itemcode> 
      <yield>74.8956541853986</yield> 
      <yieldpct>100</yieldpct> 
      <phantomind>0</phantomind> 
      <primaryformulaind>1</primaryformulaind> 
      <processyield>100</processyield> 
      <projectcode /> 
      <labbookcode /> 
      <labbookpage /> 
      <ownercode>ARFTL</ownercode> 
      <groupcode>GROUP_1</groupcode> 
      <statusind>291</statusind> 
      <approvalcode /> 
      <holdcode /> 
      <workcode /> 
      <workcode2 /> 
      <formulatorcode>ARFTL</formulatorcode> 
      <yieldcalcind>1</yieldcalcind> 
      <customer>RO_NOR</customer> 
      <comment /> 
      <datemodified>2012-05-11T14:55:37</datemodified> 
      <class>PRODUCT</class> 
      <typeind>0</typeind> 
      <parentfid>42871</parentfid> 
      <mfgitemmaster>NOR000133\0002</mfgitemmaster> 
      <calcmode>0</calcmode> 
      <formulaid>728067</formulaid> 
      <adjustparam /> 
      <materialchange>1</materialchange> 
      <judgement /> 
    - <ingrrow detail="1" fmt="X">
        <lineid>1</lineid> 
        <itemcode>NOR60506</itemcode> 
        <quantity>66.6877872652848</quantity> 
        <uomcode>KG</uomcode> 
        <description>KV1348 KV1348 White Dispersion</description> 
        <materialpct>89.0409303324918</materialpct> 
        <linebreakcode /> 
        <scaleind>0</scaleind> 
        <subformulaind>0</subformulaind> 
        <formulaid>0</formulaid> 
        <componentind>1</componentind> 
        <instruction /> 
        <substituteind>0</substituteind> 
        <formulacode>NOR60506\0006</formulacode> 
        <status>401</status> 
        <class /> 
        <decdigit>0</decdigit> 
        <cas /> 
        <commcode /> 
        <aliascode1 /> 
        <aliascode2 /> 
        <aliascode3 /> 
        <aliascode4 /> 
        <activequantity>0</activequantity> 
        <relqtypct>0</relqtypct> 
        <attribute1>000000000050051116</attribute1> 
        <attribute2 /> 
        <attribute3 /> 
        <attribute4 /> 
        <attribute5 /> 
        <instrucflag>1</instrucflag> 
        <paramcode /> 
        <pvalue xsi:nil="true" /> 
        <lotcode /> 
        <aliascode5 /> 
        <aliascode6 /> 
        <aliascode7>APC 56% 5T070/3Z145 (KV1348) / P:393367</aliascode7> 
        <aliascode8 /> 
        <sectionname /> 
        <sectiontype>0</sectiontype> 
        <adjustind>0</adjustind> 
        <attribute6 /> 
        <attribute7 /> 
        <attribute8 /> 
        <attribute9 /> 
        <attribute10 /> 
      </ingrrow>
    - <ingrrow detail="1" fmt="X">
        <lineid>2</lineid> 
        <itemcode>7K015</itemcode> 
        <quantity>8.20786692011385</quantity> 
        <uomcode>KG</uomcode> 
        <description>METHYLAMYLKETONE</description> 
        <materialpct>10.9590696675082</materialpct> 
        <linebreakcode /> 
        <scaleind>0</scaleind> 
        <subformulaind>0</subformulaind> 
        <formulaid>0</formulaid> 
        <componentind>8</componentind> 
        <instruction /> 
        <substituteind>0</substituteind> 
        <status>401</status> 
        <class /> 
        <decdigit>0</decdigit> 
        <cas>110-43-0</cas> 
        <commcode /> 
        <aliascode1>S194</aliascode1> 
        <aliascode2>METHYL AMYL KETONE</aliascode2> 
        <aliascode3 /> 
        <aliascode4>METHYLAMYLKETONE</aliascode4> 
        <activequantity>0</activequantity> 
        <relqtypct>0</relqtypct> 
        <attribute1>000000000000800479</attribute1> 
        <attribute2 /> 
        <attribute3 /> 
        <attribute4 /> 
        <attribute5 /> 
        <instrucflag>1</instrucflag> 
        <paramcode /> 
        <pvalue xsi:nil="true" /> 
        <lotcode /> 
        <aliascode5>METHYLAMYLKETONE</aliascode5> 
        <aliascode6>Methylamylketon 165,5 KG</aliascode6> 
        <aliascode7>METHYL N-AMYL KETONE (Bulk)</aliascode7> 
        <aliascode8 /> 
        <sectionname /> 
        <sectiontype>0</sectiontype> 
        <adjustind>0</adjustind> 
        <attribute6 /> 
        <attribute7 /> 
        <attribute8 /> 
        <attribute9 /> 
        <attribute10 /> 
      </ingrrow>
    </formula>
  - <fsxml>
    - <item maxcol="35" keycount="1" fmt="A" dtlcodes="HEADER" objectkey="NOR60506" filteredfields="" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <keycode>NOR60506</keycode> 
        <description>KV1348 White Dispersion</description> 
        <rmremark /> 
        <ras_sent /> 
        <erp_waunr /> 
        <erp_apac1nr /> 
        <erp_apac2nr /> 
        <erp_apcnr /> 
        <erp_emeanr /> 
        <erp_nornr>000000000050051116</erp_nornr> 
        <erp_sanr /> 
        <erpglobal_1 /> 
        <erpglobal_2 /> 
        <erpglobal_3 /> 
        <erpplantnr_11>121212;343434</erpplantnr_11> 
        <erpplantnr_12 /> 
        <erpplantnr_13 /> 
        <erpplantnr_14 /> 
        <erpplantnr_15 /> 
        <erpplantnr_16 /> 
        <erpplantnr_17 /> 
        <erpplantnr_18 /> 
        <erpplantnr_19 /> 
        <erpplantnr_20 /> 
        <erpplantnr_21 /> 
        <erpplantnr_22 /> 
        <erpplantnr_23 /> 
        <erpplantnr_24 /> 
        <erpplantnr_25 /> 
        <erpplantnr_26 /> 
        <erpplantnr_27 /> 
        <erpplantnr_28 /> 
        <erpplantnr_29 /> 
        <erpplantnr_30 /> 
        <uomcode>KG</uomcode> 
        <calcind>0</calcind> 
        <scaleind>0</scaleind> 
        <statusind>401</statusind> 
        <approvalcode /> 
        <class /> 
        <componentind>1</componentind> 
        <linebreakcode /> 
        <holdcode /> 
        <formulacode>NOR60506</formulacode> 
        <version>0006</version> 
        <cas /> 
        <commcode /> 
        <aliascode1 /> 
        <aliascode2 /> 
        <aliascode3 /> 
        <aliascode4 /> 
        <aliascode5 /> 
        <aliascode6 /> 
        <aliascode7>APC 56% 5T070/3Z145 (KV1348) / P:393367</aliascode7> 
        <aliascode8 /> 
        <threshold>0</threshold> 
        <datemodified>2012-04-28T19:50:12</datemodified> 
        <ftypeind>0</ftypeind> 
        <judgement /> 
      </item>
      - <item maxcol="35" keycount="1" fmt="A" dtlcodes="HEADER" objectkey="7K015" filteredfields="" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <keycode>7K015</keycode> 
        <description>METHYLAMYLKETONE</description> 
        <rmremark /> 
        <ras_sent /> 
        <erp_waunr>S194</erp_waunr> 
        <erp_apac1nr>00000000000007K015</erp_apac1nr> 
        <erp_apac2nr /> 
        <erp_apcnr>7K015</erp_apcnr> 
        <erp_emeanr>000000000000800479</erp_emeanr> 
        <erp_nornr>000000000000800479</erp_nornr> 
        <erp_sanr /> 
        <erpglobal_1 /> 
        <erpglobal_2 /> 
        <erpglobal_3 /> 
        <erpplantnr_11>123456</erpplantnr_11> 
        <erpplantnr_12>234567</erpplantnr_12> 
        <erpplantnr_13>345678</erpplantnr_13> 
        <erpplantnr_14>456789</erpplantnr_14> 
        <erpplantnr_15>567890</erpplantnr_15> 
        <erpplantnr_16>678901</erpplantnr_16> 
        <erpplantnr_17>789012</erpplantnr_17> 
        <erpplantnr_18>890123</erpplantnr_18> 
        <erpplantnr_19>901234</erpplantnr_19> 
        <erpplantnr_20>012345</erpplantnr_20> 
        <erpplantnr_21>654321</erpplantnr_21> 
        <erpplantnr_22>765432</erpplantnr_22> 
        <erpplantnr_23>876543</erpplantnr_23> 
        <erpplantnr_24>987654</erpplantnr_24> 
        <erpplantnr_25>098765</erpplantnr_25> 
        <erpplantnr_26>109876</erpplantnr_26> 
        <erpplantnr_27>210987</erpplantnr_27> 
        <erpplantnr_28>321098</erpplantnr_28> 
        <erpplantnr_29>432109</erpplantnr_29> 
        <erpplantnr_30>543210</erpplantnr_30> 
        <uomcode>KG</uomcode> 
        <calcind>0</calcind> 
        <scaleind>0</scaleind> 
        <statusind>401</statusind> 
        <approvalcode /> 
        <class /> 
        <componentind>8</componentind> 
        <linebreakcode /> 
        <holdcode /> 
        <formulacode /> 
        <version /> 
        <cas>110-43-0</cas> 
        <commcode /> 
        <aliascode1>S194</aliascode1> 
        <aliascode2>METHYL AMYL KETONE</aliascode2> 
        <aliascode3 /> 
        <aliascode4>METHYLAMYLKETONE</aliascode4> 
        <aliascode5>METHYLAMYLKETONE</aliascode5> 
        <aliascode6>Methylamylketon 165,5 KG</aliascode6> 
        <aliascode7>METHYL N-AMYL KETONE (Bulk)</aliascode7> 
        <aliascode8 /> 
        <threshold>0</threshold> 
        <datemodified>2012-04-24T22:52:56</datemodified> 
        <ftypeind>0</ftypeind> 
        <judgement /> 
      </item>
    </fsxml>
  </fsxml> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T13:40:02.167

It's still kind of hard for me to understand what exactly you need but I hope this will help you get going.

I assumed you want to copy the input XML but instead of copying over the `item`s alongside the `ingrrow`s, you rather want to take out those `erpplantnr_` elements from the corresponding `item` and put them right after the last `attribute` child node of the `ingrrow`.

While we can do an inline lookup in our XPath predicates it's a good idea to look at the [`xsl:key` and `fn:key()`](http://www.w3.org/TR/xslt#key) as a better way to express a lookup:

```
<xsl:key name="items" match="/fsxml/fsxml/item" use="@objectkey"/> 
```

This one will "index" all `item`s by the `@objectkey`. Next, let's put the identity transform in there, just like you had it:

```
<xsl:template match="@* | node()">
    <xsl:copy>
        <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
</xsl:template> 
```

Next, let's silent the `item` since we said we only need to pull out something of a matching `item` to be displayed elsewhere:

```
<xsl:template match="item"/> 
```

Finally, let's intercept that last `attribute` node and inject the matching `erpplantnr_` nodes right after it:

```
<xsl:template match="ingrrow/*[contains(local-name(), 'attribute')][last()]">
    <xsl:copy-of select="."/>
    <xsl:apply-templates select="key('items', current()/parent::*/itemcode)/*[contains(local-name(), 'erpplantnr_')]"/>
</xsl:template> 
```

Here we copy that last `attribute` node and then use the key to lookup a matching `item` node from which we enumerate all `erpplantnr_` in the order of their occurrence in the document.

I am not sure how generic or specific you wanted those selectors to be so I picked a place in the middle.

When I run this transform on your input document I get a copy of it in return without the `item` nodes but with the corresponding `erpplantnr_` copied right after that `attribute10` node in each `ingrrow`.

Hope it helps.

p.s. full transform listing just in case:

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:ms="urn:schemas-microsoft-com:xslt" 
    xmlns:fsxml="http://www.FormationSystems.com" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:key name="items" match="/fsxml/fsxml/item" use="@objectkey"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="item"/>

    <xsl:template match="ingrrow/*[contains(local-name(), 'attribute')][last()]">
        <xsl:copy-of select="."/>
        <xsl:apply-templates select="key('items', current()/parent::*/itemcode)/*[contains(local-name(), 'erpplantnr_')]"/>
    </xsl:template>

</xsl:stylesheet> 
```

# grails - 内置语言更改在 Grails2 中不起作用

> ID：10557842
> 
> 赞同：0
> 
> 时间：2012-05-11T20:00:17.537
> 
> 标签：grails, internationalization

我有 Grails 2 应用程序，我已经在其中添加了 i18n/messages_ru.properties。因此，根据文档，我使用 request ?lang=ru (fe userOperations/index?lang=es) 但没有任何改变。语言仍然是默认设置，没有创建语言 cookie。怎么了？我该如何解决？

PS。我在 Ubuntu 上使用 Oracle Java7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:29:25.187

问题是您配置了 url（或者它是默认的“/”（view：“index”））映射以直接呈现视图而无需控制器。创建一个控制器并在其中渲染一个视图。没有控制器就不行！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:23:41.457

你期望改变什么？如果您查看默认索引页面（列出控制器等的页面），它不会使用消息 - 它都是硬编码的。

我刚刚测试过，它在 2.0.3 中对我有用。这是我所做的：

1.  创建新应用程序
2.  使用单个字段（字符串名称）创建域类
3.  为该类运行“全部生成”
4.  创建的 gsp 将具有以下内容：

    ```
     <g:message code="yourDomainClass.name.label" default="Name" /> 
    ```

现在，如果我什么都不做并查看页面，即使使用 lang=ru 或 lang=es，它仍然会显示名称。但后来我进去并在 messages_es.properties 文件中添加了以下内容：

```
 yourDomainClass.name.label=Nombre 
```

当我刷新页面时，它显示“Nombre”而不是“Name”。

对于某些消息，例如“default.home.label”，消息文件中有默认值，当我使用 lang=es 时，它们确实会更改为西班牙语，就像他们应该做的那样，而无需我做任何事情。

# maven - 使用带有故障安全插件的 Maven 运行分类测试

> ID：10557847
> 
> 赞同：2
> 
> 时间：2012-05-11T20:00:40.703
> 
> 标签：maven, integration-testing

我希望在 Maven 中运行一些集成测试，并使用以下方式按类别对它们进行分组：

界面：

```
package com.path.for.testing;

public interface SlowTests {

} 
```

测试类：

```
import com.path.for.testing.SlowTests

@Category(SlowTests.class)
public class SlowTest {
    ...
} 
```

Pom 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  ...
  <profiles>
    ...
    <profile>
      <id>functional-test-slow-tests</id>
      <activation>
        <activeByDefault>true</activeByDefault>
      </activation>
      <build>
      <plugins>
        <plugin>
          <artifactId>maven-failsafe-plugin</artifactId>
          <executions>
            <execution>
              <goals>
                <goal>integration-test</goal>
                <goal>verify</goal>
              </goals>
              <configuration>
                <groups>com.path.for.testing.SlowTests</groups>
              </configuration>
            </execution>
          </executions>
        </plugin>
      </plugins>
      </build>
    </profile>
  </profiles>
</project> 
```

我运行它： mvn clean install -P functional-test-slow-tests

我的问题是，当它运行时，它似乎循环通过所有测试，而不仅仅是指定的测试。分类不适用于集成测试吗？还是我做错了什么？我会根据要求更新更多信息。非常感谢有关此问题的任何帮助或指导，我对此很陌生，很可能我遗漏了一些明显的东西。谢谢。

* * *

编辑以响应 User944849：

当使用 -X 参数运行时，我认为故障安全插件会被多次执行。我还添加了您建议的新执行 ID。这是我在构建项目时得到的：

```
[DEBUG] -----------------------------------------------------------------------
[DEBUG] Goal:          org.apache.maven.plugins:maven-failsafe-plugin:2.12:integration-test (default-integration-tests)
[DEBUG] Style:         Regular
[DEBUG] Configuration: <?xml version="1.0" encoding="UTF-8"?>

...

[DEBUG] -----------------------------------------------------------------------
[DEBUG] Goal:          org.apache.maven.plugins:maven-failsafe-plugin:2.12:verify (default-integration-tests)
[DEBUG] Style:         Regular
[DEBUG] Configuration: <?xml version="1.0" encoding="UTF-8"?> 
```

测试使用您建议的新 ID，但我仍然得到相同的结果，即不需要的测试仍在运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:52:13.713

如果您使用 运行`-X`，您是否看到故障安全插件的多次执行？显示的配置不包括，`<id>`因此 Maven 可能会将您配置的执行添加到其默认值。默认运行与模式匹配的任何测试`**/IT*.java`, `**/*IT.java`, `**/*ITCase.java`。

如果这是正在发生的事情，`<id>`请像这样在执行中添加一个：

```
<execution>
    <id>default-integration-tests</id>
    .... 
```

将为集成测试阶段重新定义 Maven 的默认插件执行以执行您想要的操作。

* * *

更新

@Brad，感谢您测试我的理论，感谢 @khmarbaise 给我另一个想法。

2个目标执行是您应该拥有的。我没有发现您的配置有任何问题，因此我检查了打开的 JIRA 是否有故障安全插件，我发现了一个可能导致使用错误 JUnit 提供程序的[相关问题。](http://jira.codehaus.org/browse/SUREFIRE-849)[如果这是您遇到的问题，您可能必须在此处](http://maven.apache.org/plugins/maven-failsafe-plugin/examples/junit.html)定义的插件配置中手动指定 JUnit47 提供程序。

# c++ - std::string -> execvp 等

> ID：10557848
> 
> 赞同：0
> 
> 时间：2012-05-11T20:00:47.827
> 
> 标签：c++, exec

我刚刚在程序中发现了一个难以捉摸的错误，结果证明是因为启用了优化，在类似以下的情况下，有时 std::string 在 processDocument() 从中获取文本之前被破坏：

```
#include <stdio.h>
#include <spawn.h>
#include <string>
static void processDocument(const char* text) {
        const char* const argv[] = {
                "echo",
                text,
                NULL,
        };
        pid_t p;
        posix_spawnp(&p, "echo", NULL, NULL, (char**) argv, environ);
}
static int mark = 'A';
static void createDocument() {
        const char* vc;
        std::string v = "ABCKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK42";
        ++mark;
        v[0] = mark;
        vc = v.c_str();
        processDocument(vc);
}
int main() {
        createDocument();
        createDocument();
        return(0);
} 
```

如何安全地将 std::string 转换为 char* 以用于 execvp、posix_spawnp 等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T12:22:11.237

我发现了它的真正原因（这里是实际的最小测试用例）：

```
std::string resultString;
const char* nodeText;
const char* altText;
resultString = "......whatever1.";
nodeText = resultString.c_str();
resultString = ".....whatever2..";
altText = resultString.c_str();
printf("%s\n", nodeText); // garbage 
```

馊主意。

# ios - 使用 UIBezierPaths 在自定义 UIView 上反转 CGAffineTransform 旋转

> ID：10557849
> 
> 赞同：1
> 
> 时间：2012-05-11T20:00:59.163
> 
> 标签：ios, uiviewanimation, cgaffinetransform, uibezierpath

我有一个自定义 UIView。它初始化了两个矩形 UIBezierPaths，并且在 drawRect 中它只是填充了这两个路径。

这个视图被放置在一个按钮上。单击按钮时，会在 animateWithDuration 块内对其应用旋转：

```
icon.transform = CGAffineTransformMakeRotation(M_PI*-0.25); 
```

这很好用。

再次单击该按钮时，我试图使视图旋转回其原始方向（反转旋转）。我努力了：

```
icon.transform = CGAffineTransformInvert(icon.transform);
icon.transform = CGAffineTransformMakeRotation(M_PI*0.25);
icon.transform = CGAffineTransformIdentity; 
```

...以及许多其他变体，但它们似乎都不起作用。取而代之的是，视图被扭曲，直到它不再可见——有点拉伸到什么都没有。有时，重新应用第一个转换会将其恢复，但其他反转则不会。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:37:03.330

在ios中，变换总是相对的，所以一旦变换完成，下一个变换应该是相对于前一个变换的。您可以简单地更改视图的框架并在第二次单击按钮时将其恢复为正常状态。即使单击，您也必须恢复框架。实现以下代码。如果您对它感到满意，您可以使用块级代码，因为它是新规范。

```
int noOfClicks = 0;

-(IBAction)yourBtnAction:(id)sender
{
    noOfClicks++;

    if(noOfClicks %2 != 0)
    {
        [UIView beginAnimations:@"Rotate" context:nil];
        [UIView setAnimationDuration:1.0];
        [UIView setAnimationDelegate:self];
        CGRect frame=yourView.frame;
        frame.origin.y+=20;
        yourview.frame=frame;
        [UIView commitAnimations];
    }
    else
    {
        [UIView beginAnimations:@"Rotate" context:nil];
        [UIView setAnimationDuration:1.0];
        [UIView setAnimationDelegate:self];
        CGRect frame=yourView.frame;
        frame.origin.y-=20;
        yourview.frame=frame;
        [UIView commitAnimations];
    }
} 
```

如果您不想进行太多更改，则可以使用以下方法恢复但使用相同的逻辑：

```
[UIView beginAnimations:@"Rotate back" context:nil];
[UIView setAnimationDuration:1.0];

yourView.transform = CGAffineTransformIdentity;

[UIView commitAnimations]; 
```

# security - VPS 上的 mod_php 和世界可写文件

> ID：10557854
> 
> 赞同：0
> 
> 时间：2012-05-11T20:01:15.540
> 
> 标签：security, centos, mod-php

我有一个 centos 5.8 VPS，它运行 mod_php 而不是我在共享主机上习惯的 fastcgi，我遇到了一个问题，即打算写入文件的各种 php 位需要这些文件是世界可写的。编写的文件就像网站的数据库和 rss xml。这不安全，是吗？我应该怎么做才能确保它的安全？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T13:37:12.563

这个“数据库”文件是纯文本还是标签？如果它们是纯文本，任何人都可以通过指向它们来阅读它们。这至少是信息暴露。

我不知道应用程序的代码和设计，但在同样的情况下可能会导致其他问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T18:27:30.797

谁有权使用这台机器？换句话说，这个场景中的“世界”是谁？如果只有你一个人，那你也没什么好担心的吧？

但是，如果这个系统是与其他人共享的，你信任所有的管理员吗？如果您不这样做，那么您几乎无法保护您的文件。

如果您担心的是系统上的其他非管理员用户，那么您不希望使您的数据库可全局写入。如果您无法写入这些文件，那么写入它们的进程（mysql、apache 等）正在以错误的用户身份运行。最好，您希望您的文件由运行这些进程的同一用户拥有 - 但前提是您可以信任该用户！如果你不能，那么你很可能直接不走运。

# cassandra - Cassandra rangequery，知道开始键的开始

> ID：10557855
> 
> 赞同：0
> 
> 时间：2012-05-11T20:01:15.837
> 
> 标签：cassandra

让我澄清一下

我有一个列族，带有像这样的 UTF8 键：apple#NewYork，banana#LosAngeles，banana#NewYork，cherry#NewYork，... 等等

我需要它，因为它们已排序，然后我想获得所有“香蕉”起始键？

有可能还是有解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T09:39:01.217

复合类型呢？

将当前行映射到列，例如

row_key => { 香蕉：a => “你想要的价值”，香蕉：b => “你想要的价值”，... }

复合类型的优点是

1.  它们在排序时保留类型属性
2.  如果您的复合键是`a:b:c`您可以查询 a、a:b 范围内的所有列，还可以查询 a:b:c 等点查询

现在您可以[使用 phpcassa](http://thobbs.github.com/phpcassa/api/class-phpcassa.ColumnSlice.html) Ex 执行列切片：

```
row_key => { 1:a => 1, 1:b => 1, 10:bb => 1, 1:c => 2}
ColumnSlice(array(1), array(1)) => All Columns with first component equal to 1
ColumnSlice(array(1), array(10)) => All Columns with first component between 1 and 10
ColumnSlice("", array(1, 'c')) => All Columns from the beginning of row whose first component less than 1 and second component less than 'c' 
```

您可以反向执行上述操作，也可以使用包容性和排他性限制。

还有一点要记住，您不能直接要求第二个组件 < x 范围内的所有列跳过第一个

甚至行键也支持复合类型，但如果您使用随机分区器，那么它没有任何意义。

# numpy - 在 OS X 10.7.4 上为 Python 3.2.3 安装 NumPy

> ID：10557857
> 
> 赞同：6
> 
> 时间：2012-05-11T20:01:20.153
> 
> 标签：numpy, python-3.x, matplotlib, osx-lion, installation

几个月来，我一直在尝试为 Python 3 安装 numpy，但尽管进行了大量的谷歌搜索，甚至发布到 numpy 邮件列表，但我仍然没有接近解决方案。

我已经设法通过 MacPorts 安装了它，但不幸的是似乎没有适用于 Python 3 的 MatPlotLib 端口，这是我尝试安装 numpy 的主要原因……所以我有点卡住了……

尝试从 setup.py 文件构建时，我不断收到相同的错误。我在下面包含了终端输出。

谢谢你的尽心帮助，

亚当。

这是终端输出：

```
lipo: can't figure out the architecture type of: /var/folders/zj/7xymy_2n3s71ws30v3v_qnlw0000gn/T//ccbRr0Hj.out
failure.
removing: _configtest.c _configtest.o
Running from numpy source directory.Traceback (most recent call last):
  File "setup.py", line 214, in <module>
    setup_package()
  File "setup.py", line 207, in setup_package
    configuration=configuration )
  File "/Users/adammcnicol/Downloads/numpy-1.6.2rc1/build/py3k/numpy/distutils/core.py", line 186, in setup
    return old_setup(**new_attr)
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/distutils/core.py", line 148, in setup
    dist.run_commands()
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/distutils/dist.py", line 917, in run_commands
    self.run_command(cmd)
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/distutils/dist.py", line 936, in run_command
    cmd_obj.run()
  File "/Users/adammcnicol/Downloads/numpy-1.6.2rc1/build/py3k/numpy/distutils/command/build.py", line 37, in run
    old_build.run(self)
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/distutils/command/build.py", line 126, in run
    self.run_command(cmd_name)
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/distutils/cmd.py", line 313, in run_command
    self.distribution.run_command(command)
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/distutils/dist.py", line 936, in run_command
    cmd_obj.run()
  File "/Users/adammcnicol/Downloads/numpy-1.6.2rc1/build/py3k/numpy/distutils/command/build_src.py", line 152, in run
    self.build_sources()
  File "/Users/adammcnicol/Downloads/numpy-1.6.2rc1/build/py3k/numpy/distutils/command/build_src.py", line 169, in build_sources
    self.build_extension_sources(ext)
  File "/Users/adammcnicol/Downloads/numpy-1.6.2rc1/build/py3k/numpy/distutils/command/build_src.py", line 328, in build_extension_sources
    sources = self.generate_sources(sources, ext)
  File "/Users/adammcnicol/Downloads/numpy-1.6.2rc1/build/py3k/numpy/distutils/command/build_src.py", line 385, in generate_sources
    source = func(extension, build_dir)
  File "numpy/core/setup.py", line 410, in generate_config_h
    moredefs, ignored = cocache.check_types(config_cmd, ext, build_dir)
  File "numpy/core/setup.py", line 41, in check_types
    out = check_types(*a, **kw)
  File "numpy/core/setup.py", line 271, in check_types
    "Cannot compile 'Python.h'. Perhaps you need to "\
SystemError: Cannot compile 'Python.h'. Perhaps you need to install python-dev|python-devel. 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-12T18:34:24.357

好吧，我终于设法安装了**NumPy**。不确定这是最好的方法，但它似乎有效！

首先我需要安装**分发**：

1.  `curl http://python-distribute.org/distribute_setup.py | python3`

然后我安装了**pip**：

1.  `curl https://raw.github.com/pypa/pip/master/contrib/get-pip.py | python3`

在那之后，我不得不进入**我**的系统路径（同样可能有更好的方法）：

1.  打开**终端**
2.  键入以下内容（单行）：
    *   `sudo ln -s /Library/Frameworks/Python.framework/Versions/3.2/bin/pip /usr/local/bin`

安装了**分发**和**pip**后，我安装了**Nose**，NumPy 需要它来进行测试或其他东西：

1.  同样，在**终端**中键入以下内容：
    *   `pip install nose`

现在我需要确保我拥有最新版本的**Xcode**：

1.  从**AppStore**安装最新版本的**Xcode**
2.  如果您仍然有一个`/Developer`文件夹，请重命名它`Developer-old`（不确定这是否会在以后给我带来问题）
3.  打开**终端**并创建一个指向 Xcode 的 AppStore 版本的符号链接（单行）：
    *   `sudo ln -s /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer /Developer`

有了所有这些时间来安装**NumPy**：

1.  从以下位置下载**NumPy**源：http: [//sourceforge.net/projects/numpy/files/NumPy/1.6.2rc1/](http://sourceforge.net/projects/numpy/files/NumPy/1.6.2rc1/)
2.  解压文件
3.  再次打开**终端**：
    *   `cd`进入通过取消归档文件创建的目录，例如
        *   `cd /Users/username/Downloads/numpy-1.6.2rc1`
4.  **在终端**中键入以下内容以更改用于构建**NumPy**的编译器：
    *   `export CC=clang`
    *   `export CXX=clang`
    *   `export FFLAGS=-ff2c`
    *   `export LDSHARED='clang -bundle -undefined dynamic_lookup -arch i386 -arch x86_64 -isysroot /Developer/SDKs/MacOSX10.6.sdk -g'`（这是单行）
    *   `python3 setup.py build`（可能还要等一下）
    *   `python3 setup.py install`

好的，假设应该安装**NumPy**没有错误。是时候测试一下了：

1.  打开**空闲**
2.  在**Python Shell**类型中：
    *   `import numpy`
    *   `numpy.test('full')`
3.  这将测试**NumPy ，我使用****Python 3.2.3**收到的最终结果是：
    *   `<nose.result.TextTestResult run=3192 errors=0 failures=1>`

所以**NumPy**安装通过了除了一项测试之外的所有测试，这看起来很不错。我还没有机会查看是否可以正常工作，因为我仍在努力安装**matplotlib** ......

希望这些说明对某人有用！

亚当。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-12T05:12:13.277

我正在使用 Python 3.3 和 OS X 10.7，并且我使用比上面更简单的方法安装了 numpy。我在这里发帖以防它可以帮助某人。

跟着这些步骤：

*   从github 上的[numpy](https://github.com/numpy/numpy)下载 zip 文件，然后将其解压缩到您想要的任何位置。
*   打开终端并 cd 到目录
*   输入命令`python3 setup.py build --fcompiler=gnu95`（需要gfortran。回车`gfortran -v`看看有没有，我有4.6.2版本）
*   进入`python3 setup.py install`

这就是我所需要的。但是，运行 numpy.test('full') 会给我一些错误：http: [//pastebin.com/5XF0qAe5](http://pastebin.com/5XF0qAe5)

我不知道我会遇到什么样的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T17:45:32.507

上面的答案对我很有用，除了你提到这是针对 OS X 10.7（这里相同）所以我的构建命令确实抱怨了这一行：

*   export LDSHARED='clang -bundle -undefined dynamic_lookup -arch i386 -arch x86_64 -isysroot /Developer/SDKs/MacOSX10.6.sdk -g' （这是单行）

所以，我只是将其更改为 10.7，它运行良好。显然，对于 OS X 10.7，/Developer/SDKs/ 目录包含 MacOSX10.7.sdk 和 MacOSX10.8.sdk。感谢您的精彩回答！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-10T04:51:03.000

我已经多次回到这个答案，如果您使用的是 10.8，则需要做一些事情才能使其正常工作（但我认为您不需要 LDSHARED 部分）。

1.  安装 Apple 提供的 XCode 以及命令行工具（这将为您提供所需的编译器）。
2.  将环境变量设置为指向`clang`并使用`easy_install`（不分发）安装，此行将起作用：

    CC=clang CXX=clang FFLAGS=-ff2c easy_install numpy

3.  不要*尝试*同时安装其他软件包。numpy 安装可能会退出并声称出现错误，但通常它会设法自行安装（例如，如果您尝试在 virtualenv 中安装，这可能会发生）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-27T03:08:41.277

对我来说，我从他们的网站安装了 python3，然后安装了 numpy，

`pip3 install numpy`

有用！

# c - 如何按字典顺序对结构中的字符串进行排序？

> ID：10557862
> 
> 赞同：2
> 
> 时间：2012-05-11T20:01:49.703
> 
> 标签：c, arrays, string, sorting, structure

我正在尝试根据它们的名称按字典顺序对字符串进行排序。

所以我有一系列结构

```
typedef struct buff{
    char *name;
} structure; 
```

我正在复制带有相关扩展名的文件名。所以该结构的内容看起来像这样的`s[0].name = "picture1.jpg"` `s[1].name = "DCP003.JPG"`东西。

我正在尝试对此进行排序，但我无法做到这一点..到目前为止我所拥有的就是这个。

```
void sort(structure *s, int counter){

    for (int i = 0; i < counter - 1; i++){
        for (int j = 0; j < counter - 1 - i; j++){

                if (strcmp(s[j].name, s[j+1].name) > 0){

                    structure tmp;

                    tmp = s[j];
                    s[j] = s[j+1];
                    s[j+1] = tmp;

            }
        }
    }

    for (int i = 0; i < counter; i++){
        printf("%d - %s\n", i+1, s[i].name);
    }
} 
```

它不能按我的意愿工作..尝试了几个版本仍然不好..我在哪里犯错了？任何意见是极大的赞赏..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:49:13.577

按字典顺序对结构中的字符串进行排序的最佳方法是使用 QSort (Stdlib.h)(O(nlog(n)))。

这是示例代码::

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct names
{
    char strvalues[20];
} buff[100];

int main ()
{
    int i;
    strcpy(buff[0].strvalues,"some");
    strcpy(buff[1].strvalues,"example");
    strcpy(buff[2].strvalues,"strings");
    strcpy(buff[3].strvalues,"here");

    qsort (buff, 4, 20, (int(*)(const void*,const void*)) strcmp);

    for(i=0;i<4;++i)
    {
        printf("%s\n",buff[i].strvalues);    
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T20:10:34.343

尝试这样的事情：

```
typedef struct buff{
    char *name;
} structure;

structure s[5];

void sort(){
    int sz = sizeof s / sizeof s[0];
    printf("sz=%d\n",sz);
    int done = 0;

    for (int i = 0; i < sz; i++){
          for (int j = i+1; j < sz; j++){

                  if (strcmp(s[i].name, s[j].name) > 0){

                      structure tmp;

                      tmp = s[i];
                      s[i] = s[j];
                      s[j] = tmp;
              }
          }
    }
    for (int i = 0; i < sz; i++){
        printf("%d - %s\n", i+1, s[i].name);
    }
}

int main() {
  s[0].name = "dog";
  s[1].name = "ant";
  s[2].name = "cat";
  s[3].name = "man";
  s[4].name = "bear";
  sort();
  return 0;
} 
```

输出：

```
---------- Capture Output ----------
> "c:\windows\system32\cmd.exe" /c c:\temp\temp.exe
sz=5
1 - ant
2 - bear
3 - cat
4 - dog
5 - man

> Terminated with exit code 0. 
```

# facebook - 您如何将状态发布到特定的朋友列表？

> ID：10557864
> 
> 赞同：0
> 
> 时间：2012-05-11T20:01:52.420
> 
> 标签：facebook, facebook-graph-api

我想将状态发布到特定的朋友列表（例如“家人”或“最好的朋友”）。我可以使用 FB API 获取好友列表的 ID，但在发布状态时我看不到使用此 ID 的方法。

有了一个组，我可以发布到组 ID (https://graph.facebook.com/groupID/feed)。但这似乎不适用于朋友列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T18:09:47.960

这似乎可以解决问题：

```
curl -F 'access_token=your_access_token' -F 'message=your_message' -F \
  "privacy={'value':'CUSTOM','friends':'SOME_FRIENDS','allow':'your_list'}" \
  https://graph.facebook.com/your_id/feed 
```

# html - 炼油厂的 URL 中的奇怪字符串是否正常？

> ID：10557865
> 
> 赞同：1
> 
> 时间：2012-05-11T20:02:00.517
> 
> 标签：html, ruby-on-rails-3, url, imagemagick, refinerycms

所以我有这个站点，由于服务器的年龄，我要从内部服务器移动。在移动网站的过程中，我注意到图片的 URL 中有奇怪的字符串，例如

```
<img src="/system/images/BAhbBlsHOgZmIiwyMDExLzExLzIyLzEyXzIyXzI3XzkwOV9OZXdzX2Jhbm5lci5qcGc/News-banner.jpg" title="News Banner" alt="News Banner" rel="225x255" width="909" height="303">

<img class="image-align-left" src="/system/images/BAhbB1sHOgZmIjUyMDExLzEyLzIxLzA5XzMzXzQ1XzUzM19XaWxsb3VnaGJ5U3VwcGx5TG9nby5wbmdbCDoGcDoKdGh1bWIiDTExMHgxMTA+/WilloughbySupplyLogo.png" width="83" height="89"> 
```

我检查了旧服务器和新服务器上的文件结构，这些路径没有出现在任何地方。

这会导致我将站点移动到的位置出现问题，这表明图像根本不显示。起初，我认为[安装 ImageMagick 会修复它](https://stackoverflow.com/questions/6987976/move-refinerycms-from-local-to-production)，并且对于三个站点之一，它确实如此，但其他两个站点仍然有非常损坏的图像。

有人可以解释为什么这些图像在 URL 中有如此奇怪的字符串，以及我该如何解决它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T06:36:48.617

这些 URL 来自 Dragonfly，它是 Refinery 使用的图像处理库。

此 URL 的作用是对如何处理您请求的图像的作业说明进行编码。这些指令可以是许多东西，例如调整大小、裁剪、水印、以某种方式扭曲。这意味着您可以使用不同的指令请求相同的图像，并且每次都会出现不同的图像。

欲了解更多信息，[蜻蜓 URL 文档是一个很好的阅读](http://markevans.github.com/dragonfly/file.URLs.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:07:01.777

我的炼油厂也有同样的情况。似乎 Refinery（或 imagemagick，或它所依赖的其他 gem 之一）为资产/资源生成临时 URL。这通常是一件好事，因为它有助于防止盗窃和盗链等：)

# list - SharePoint - 文件夹列表

> ID：10557871
> 
> 赞同：0
> 
> 时间：2012-05-11T20:02:21.153
> 
> 标签：list, sharepoint-2010

我正在尝试实现一个列表，其中唯一的项目类型是文件夹。如果有人单击“新建”，他们将进入一个允许他们输入文件夹名称、描述并从下拉菜单中选择“活动”或“非活动”的表单。在文件夹内，我想要一个只有 2 列的简单列表。

我尝试使用我需要的列创建自定义文件夹内容类型，并将其设置为默认内容类型。这似乎可以制作文件夹列表。一旦我进入文件夹并尝试更改内部视图/列表设置（我不想使用文件夹内的自定义文件夹内容类型......我只需要 2 个简单的列）它会更改列表的设置文件夹也是如此。内部列表有什么方法可以设置与其父级不同的设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T07:13:23.630

我不知道这个问题是否仍然相关，但也许其他人会发现我的答案很有用。

我曾经实现一个仅包含根目录中的文件夹的列表，它可以包含一些基于项目的内容类型。FeatureActivated 和 ItemAdded 事件有两个事件接收器，它们分别更改列表根文件夹和正在创建的文件夹的 UniqueContentTypeOrder 属性（可供用户创建的内容类型列表）。像这样：

```
List<SPContentType> ctl = new List<SPContentType>();
foreach (SPContentType ct in lst.ContentTypes) if (ct.Id.IsChildOf(SPBuiltInContentTypeId.Folder)) ctl.Add(ct);
lst.RootFolder.UniqueContentTypeOrder = ctl;
lst.RootFolder.Update(); 
```

此外，我通过为视图定义指定 ContentTypeID 属性，为根文件夹及其包含的文件夹指定了不同的可用列表视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:09:10.083

抱歉不行。由于 SharePoint 列表不是关系数据，因此您唯一的选择是允许多种内容类型。如果某个内容类型可用于列表，则它可用于整个列表（根文件夹和子文件夹）。

对您尝试完成的工作进行建模的一种可能性依赖于 SharePoint 2010 Enterprise。Infopath 允许您自定义列表的新项目表单。可能可以编辑表单，使其仅允许顶级文件夹和文件夹内的列表项目，但我不确定 - 自从我使用 Infopath 自定义列表表单以来已经有一段时间了。

# jquery - 处理 jquery 命名空间冲突的好/最好的方法是什么？

> ID：10557873
> 
> 赞同：3
> 
> 时间：2012-05-11T20:02:34.717
> 
> 标签：jquery

我正在使用两个 jquery 插件。两者都使用原型函数扩展 jquery `removeTag`。这会导致第二个加载的插件正常工作，而第一个则不能。

作为一个快速补丁，我将第二个插件上的 removeTag - 以及对它的所有调用 - 重命名为其他内容。

显然，这不是一个好的解决方案。升级需要手动编辑，并且可能存在我尚未意识到的其他命名空间冲突。

谁能推荐一些有效的策略来解决这个问题？

我使用的两个插件是：

*   jQuery TagIt - [http://aehlke.github.com/tag-it/](http://aehlke.github.com/tag-it/)
*   jQuery 标签输入 - [https://github.com/xoxco/jQuery-Tags-Input](https://github.com/xoxco/jQuery-Tags-Input)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:16:14.533

您可以使用以下代码添加 js 文件：

```
if (jQuery) {
    jQuery.namespace = function(namespace) {
            var names = namespace.split(".");
            var parent = window;
            for (var index = 0; index < names.length; index++) {
                    if (!parent[names[index]]) {
                            parent[names[index]] = function() {
                                    throw "Namespace, Cannot instantiate";
                            }
                    }
                    parent = parent[names[index]];
            }
    } 
```

}

在您的脚本上，您可以像下面这样使用它：

```
$.namespace("Somejs.MyCustomjs"); 
```

稍后在代码中引用完整的命名空间，例如：

```
SomeJs.MyCustomjs.myFunc(); 
```

希望能帮助到你

编辑：我忘了提到在你的 js 类的声明中你使用完整的命名空间

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:19:56.903

一种可能性是使用`jQuery.sub()`.

[http://api.jquery.com/jQuery.sub/](http://api.jquery.com/jQuery.sub/)

这将允许您创建`jQuery`对象的副本并让一个插件使用该副本。

```
// load jQuery
// load plugin1

var $origJQ = jQuery;
jQuery = jQuery.sub();

// load plugin2

jQuery.plugin2Stuff();
$origJQ.plugin1Stuff(); 
```

但最大的缺点是，在处理任一插件时，您需要确保为 jQuery 使用适当的别名。如果至少其中一个插件只是您在页面加载时调用一次的东西，尽管这可能不是问题。

***编辑：显然这在 1.7 中已被弃用，并将在 1.8 中移至插件***

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:54:50.463

加载第一个插件后，使用不同的名称定义函数，`$.fn.removeTagsPlugin=$.fn.removeTags`然后当您加载第二个插件时，它可以愉快地覆盖 $.fn.removeTags。这有局限性。如果第一个插件在内部使用 removeTags 并且如果它使用新插件版本的 removeTags 它将不起作用，那么这个解决方案将不起作用。

# javascript - Rangy 在 contenteditable div 的退格键上失去插入符号位置

> ID：10557874
> 
> 赞同：1
> 
> 时间：2012-05-11T20:02:36.957
> 
> 标签：javascript, dom, contenteditable, rangy

我已经研究了所有 Rangy Q&A 好几天，但无法适应这种情况。

我有以下内容可编辑

```
<div id="area" style="width:100%;height:2em;" 
contentEditable="true";
onkeyup="formatText();"
></div> 
```

调用一个函数，每次用户键入内容时，它都会解析内容并格式化特定的标记。

```
 function formatText() {

    var el = document.getElementById('area');
    var savedSel = saveSelection(el); // calls Rangy function

    var tokenColor;

        // removes html tags before passing the expression to the parser
    var userInput = document.getElementById('area').innerHTML.replace(/(<([^>]+)>)/g,"").replace(/&amp;/g, "").replace(/&gt;/g, ">").replace(/&lt;/g, "<").replace(/<span[^>]*>+<\/span>/, "");

    var i, newHTML=[];

    tokenType=[]; // [NUMBER,+,(,NUMBER,..]
    tokenArray=[]; // [3,+,(5,...]

    var resultOutput =  parse(userInput); // parser also fills tokenType and tokenArray

    for (i=0; i<tokenArray.length-1; i++){

        newHTML += "<span style='color: " + tokenColor + " '>" +  tokenArray[i] + "</span>";

         } // newHTML looks like <span style='color: red'>3</span><span style='color: black'>+</span> etc.

    el.innerHTML = newHTML; // replaces content of <div> with formatted text    

    restoreSelection(el, savedSel);  // calls Rangy function to restore cursor position
} 
```

我使用了作者在本论坛其他帖子中提出的以下基于 Rangy 的函数：

```
 function saveSelection(containerEl) {
    var charIndex = 0, start = 0, end = 0, foundStart = false, stop = {};
    var sel = rangy.getSelection(), range;

    function traverseTextNodes(node, range) {
        if (node.nodeType == 3) {
            if (!foundStart && node == range.startContainer) {
                start = charIndex + range.startOffset;
                foundStart = true;
            }

            if (foundStart && node == range.endContainer) {
                end = charIndex + range.endOffset;
                throw stop;
            }
            charIndex += node.length;

        }  else {
            for (var i = 0, len = node.childNodes.length; i < len; ++i) {
                traverseTextNodes(node.childNodes[i], range);
            }   
        }
    }

    if (sel.rangeCount) {
        try {
            traverseTextNodes(containerEl, sel.getRangeAt(0));
        } catch (ex) {
            if (ex != stop) {
                throw ex;
            }
        }
    }

    return {
        start: start,
        end: end
    };
}

function restoreSelection(containerEl, savedSel) {
    var charIndex = 0, range = rangy.createRange(), foundStart = false, stop = {};
    range.collapseToPoint(containerEl, 0);

    function traverseTextNodes(node) {
        if (node.nodeType == 3) {
            var nextCharIndex = charIndex + node.length;
            if (!foundStart && savedSel.start >= charIndex && savedSel.start <= nextCharIndex) {
                range.setStart(node, savedSel.start - charIndex);
                foundStart = true;
            }
            if (foundStart && savedSel.end >= charIndex && savedSel.end <= nextCharIndex) {
                range.setEnd(node, savedSel.end - charIndex);
                throw stop;
            }
            charIndex = nextCharIndex;
        }   

        else {
            for (var i = 0, len = node.childNodes.length; i < len; ++i) {
                traverseTextNodes(node.childNodes[i]);
            }
        }
    }

    try {
        traverseTextNodes(containerEl);
    } catch (ex) {
        if (ex == stop) {
            rangy.getSelection().setSingleRange(range);   
        } else {
            throw ex;
        }
    }
} 
```

一切正常，直到我尝试删除一个角色。此时，光标会跳到 div 的开头。

知道为什么会发生这种情况吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T11:33:19.417

我在 Tim Down 的帮助下解决了这个问题（感谢 Tim！）。

他最近在 Rangy 中添加了新的 TextRange 模块，它运行良好。该模块具有基于页面上可见文本中的字符索引的选择保存/恢复，因此不受 innerHTML 更改的影响。你可以在这里找到演示：

[http://rangy.googlecode.com/svn/trunk/demos/textrange.html](http://rangy.googlecode.com/svn/trunk/demos/textrange.html)

文档（初步）：[http ://code.google.com/p/rangy/wiki/TextRangeModule](http://code.google.com/p/rangy/wiki/TextRangeModule)

所以基本上代码应该是：

```
 document.getElementById("area").onkeyup = function() {
    var sel = rangy.getSelection();
    var savedSel = sel.saveCharacterRanges(this);    

    var userInput = this.textContent || this.innerText;

    var userInputLength = userInput.length;  
    var newHTML = [];

    for (var i=0; i<userInputLength; i++) {
        newHTML[i] = "<span style='color: red'>" + userInput.charAt(i)  + "</span>";  
    }

    this.innerHTML =  newHTML.join("");

    sel.restoreCharacterRanges(this, savedSel);
};
​ 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T00:25:43.267

在我看来，它好像可以工作。解决方案可能就像在恢复选择之前调用`focus()`contenteditable 的方法一样简单。`<div>`

# asp.net - Default.aspx 重定向

> ID：10557875
> 
> 赞同：-1
> 
> 时间：2012-05-11T20:02:40.883
> 
> 标签：asp.net, vb.net

我有一个这样的 default.aspx 页面，目的是根据主机标头进行不同的重定向。

```
<%
if(System.Web.HttpContext.Current.Request.Url.Host == "xxx.xxx.com")
{
response.redirect ("place/subplace/xxx.aspx")
}
else
{
response.redirect ("place/xxx.aspx")
}
%> 
```

但它给了我错误“编译器错误消息：BC30201：预期表达式。”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:04:47.343

在 C# 中，表达式以分号结尾`;`

```
if (System.Web.HttpContext.Current.Request.Url.Host == "xxx.xxx.com")
{
    Response.Redirect("place/subplace/xxx.aspx"); <-- here
} 
else
{
    Response.Redirect("place/xxx.aspx"); <-- and here
} 
```

C# 区分大小写。两者都`Response`以`Redirect`大写字母开头。

**编辑：**因为您现在将其标记为 VB.Net

您的代码不是有效的 VB.net 代码。如果是，它应该如下所示：

```
If System.Web.HttpContext.Current.Request.Url.Host = "xxx.xxx.com" Then
    Response.Redirect("place/subplace/xxx.aspx")
Else
    Response.Redirect("place/xxx.aspx")
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:05:32.563

当编译器给出错误 "expression expected" 时，它通常是一个语法错误。在 response.redirect 之后添加一个半列（;）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:10:19.490

以下对我有用：

```
protected void Page_Load(object sender, EventArgs e)
    {
        if(System.Web.HttpContext.Current.Request.Url.Host == "xxx.xxx.com")
        {
            Response.Redirect("place/subplace/xxx.aspx");
        }
        else
        {
            Response.Redirect("place/xxx.aspx");
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-05T15:58:28.867

这对我有用。[http://www.w3schools.com/asp/met_redirect.asp](http://www.w3schools.com/asp/met_redirect.asp)

使用上面的链接，我写了以下几行，它执行没有任何问题。注意末尾没有分号。我的 default.aspx 页面只包含以下三行。

```
<%
    Response.Redirect("~/portal")
%> 
```

可能的原因是；通常在 .aspx 页面的顶部或 web.config 文件中会提到语言。如果没有提到语言，IIS 使用 VB.NET 来编译页面，我们知道 VB.NET 不使用分号来终止语句。

# perl - 具有多个值的命令行参数

> ID：10557876
> 
> 赞同：4
> 
> 时间：2012-05-11T20:02:48.883
> 
> 标签：perl, command-line, arguments

我正在做一个 perl 脚本，我需要从命令行获取多个值。例子：

```
perl script.pl --arg1 op1 op2 op3 
```

我正在使用 Getopt::Long 我可以让它工作：

```
perl script.pl --arg1 op1 --arg1 op2 --arg1 op3 
```

但我真的需要（想要）第一个选项。

我检查了他们的文档，这应该可以满足我的要求：

```
GetOptions('arg1=s{3}' => \@myArray); 
```

[http://search.cpan.org/~jv/Getopt-Long-2.38/lib/Getopt/Long.pm#Options_with_multiple_values](http://search.cpan.org/~jv/Getopt-Long-2.38/lib/Getopt/Long.pm#Options_with_multiple_values)

但我收到了这个错误：

> 选项规范中的错误：“arg1=f{3}”

有什么想法/解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:18:36.920

我认为你的问题可能是`f{3}`。`f`用于*浮点*参数（实数）。`s`如果您有字符串作为参数，则应该使用说明符。关于参数的数量，文档说：

> 还可以指定选项采用的最小和最大参数数量。foo=s{2,4} 表示一个选项，它至少需要两个，最多 4 个参数。foo=s{,} 表示一个或多个值；foo:s{,} 表示零个或多个选项值。

考虑文档中的他的注释并根据您的需要进行调整。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T20:18:12.650

您的代码对我有用，但看起来该功能最近才添加到 Getopt::Long（版本 2.35），因此您可能拥有旧版本的 Getopt::Long。跑

```
perl -MGetopt::Long -le'print $Getopt::Long::VERSION;' 
```

看看你有什么版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-03T04:40:34.833

我不确定为什么人们不提供这个解决方案，但是这篇文章太老了，现在可能已经太晚了，无法提供帮助。

我发现没有一种自动的方法可以做到这一点。

您需要做的是引用多个参数并在代码中解析它们：

```
perl myscript.pl -m 'a b c' 
```

然后在代码中拆分 -m 参数值并从那里做任何必要的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-12T19:41:39.883

[与getoptions function perl multi value not working](https://stackoverflow.com/questions/16410671/getoptions-function-perl-multi-value-not-working)类似的问题，我猜......无论如何，似乎只是使用`"optlist=s" => \@list,`对我有用，将重复/重复选项存储在数组中；这是我的版本：

```
$ perl --version | grep This && perl -MGetopt::Long -le'print $Getopt::Long::VERSION;'
This is perl, v5.10.1 (*) built for i686-linux-gnu-thread-multi
2.38 
```

一个例子（`test.pl`）：

```
#!/usr/bin/perl
use strict;
use warnings;
use Getopt::Long;
my $numone = 0;
my $numtwo = 1;
my @list=();
my $result;
$result = GetOptions (
  "numone=i" => \$numone,
  "numtwo=i"   => \$numtwo,
  "optlist=s" => \@list,
);

printf("result: %d;\n", $result);
printf("numone: %d, numtwo %d, optlist:\n", $numone, $numtwo);

foreach my $tmplist (@list) {
  printf(" entry: '%s'\n", $tmplist);
} 
```

测试输出：

```
$ perl test.pl --numone 10 --numtwo 20 --optlist testing --optlist more --optlist options
result: 1;
numone: 10, numtwo 20, optlist:
 entry: 'testing'
 entry: 'more'
 entry: 'options' 
```

# python - 为什么从 Twitter-api 返回数据时有时会出现 python "KeyError:" 错误，而其他时候则不会出现？

> ID：10557883
> 
> 赞同：1
> 
> 时间：2012-05-11T20:03:11.830
> 
> 标签：python, error-handling, twitter

问候热心的小伙伴们：

我正在调试一个与 twitter-api 集成的程序，其目的是搜索给定半径内的特定推文并将它们返回到 csv 文件中。

它可以工作......但有时它会遇到“KeyError：'location'”错误，但当我检查它时没有关键错误，所以任何人都可以解释它为什么返回这个错误？

如果您取消注释 pprint 语句以查看来自 twitter-api 的原始返回数据，则很明显“位置”是正确的键，有时有效，但有时无效，并返回上述错误。

下面是使用注释中给出的测试输入运行它的代码：

```
import urllib2, json, pprint, codecs, unicodedata, csv
## test coordinate input: 29.762778,-95.383056
## test radius 10
## test query: tebow
##Initial user input
city = raw_input("Please enter to 6 decimal places the city\ncoordinates to be searched ex. lat,long: ")
radius = raw_input("Please enter the numeric value of the\nradius in miles you'd like to search ex. 10: ")
term= raw_input("Please enter the search term you wish to query ex. tebow: ")

u = urllib2.urlopen('http://search.twitter.com/search.json?q='+term+'&geocode='+city+','+radius+'mi&page=1&rpp=20')
datares = json.load(u)
##pprint.pprint(datares)

with codecs.open('Gtweets.csv',mode='w', encoding='ascii',errors='ignore') as cache:
    writer = csv.writer(cache)
    for tweet in datares['results']:
        writer.writerow([tweet['text'].encode('ascii', 'ignore'), tweet['location'].encode('ascii', 'ignore'), tweet['created_at'].encode('ascii', 'ignore'), tweet['from_user'].encode('ascii', 'ignore')]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:31:54.183

由于您无法控制 Twitter 是否包含该位置，因此不要依赖该字段是否存在。不要使用方括号进行查找，而是使用*dict.get*：

```
tweet.get('location', '<unknown location>').encode('ascii', 'ignore') 
```

# css - 如何在 Google Visualization API 中指定自定义 CSS 字体/字体系列？

> ID：10557886
> 
> 赞同：2
> 
> 时间：2012-05-11T20:03:22.550
> 
> 标签：css, api, fonts, visualization, google-visualization

我正在尝试为我的图表指定自定义 CSS 字体，该字体是通过 Google 可视化 API 生成的。我尝试在我的 CSS 样式表中指定字体，以及使用 Google fonts.googleapis.com

在我的 Google Visualization API chartOptions 中：

```
var options = {
    fontName : 'FranchiseRegular',
    tooltip: { textStyle: { fontName: 'Verdana', fontSize: 12 } }
}; 
```

在我的 style.css 中：

```
@font-face {
font-family: 'FranchiseRegular';
src: url('/_fonts/franchise-bold-webfont.eot');
src: url('/_fonts/franchise-bold-webfont.eot?#iefix') format('embedded-opentype'),
     url('/_fonts/franchise-bold-webfont.woff') format('woff'),
     url('/_fonts/franchise-bold-webfont.ttf') format('truetype'),
     url('/_fonts/franchise-bold-webfont.svg#FranchiseRegular') format('svg');
font-weight: normal;
font-style: normal;
} 
```

在我的 HEAD 标签中：

```
<link href='http://fonts.googleapis.com/css?family=Magra:400,700' 
      rel='stylesheet' type='text/css'> 
```

因此，Verdana 调用效果很好，所有工具提示都正确显示为 Verdana。但是标题、坐标轴标签和图表标签都出现在 TimesNewRoman 上。我希望它们显示为 CSS 中指定的 FranchiseRegular 或 HEAD 标签中指定的 Magra。

我已经彻底探索了这里的选项： [https ://developers.google.com/chart/interactive/docs/gallery/bubblechart](https://developers.google.com/chart/interactive/docs/gallery/bubblechart)

问题的核心是，什么是正确的语法

```
fontName: <global-font-name> 
```

如果您可以在 chartOptions 中为我的 fontName 提供正确的语法来完成其中任何一项，我将不胜感激。提前致谢！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T22:31:23.787

这里有一个相关的答案：

[使用 Google Charts 选择字体系列？](https://stackoverflow.com/questions/2455020/font-family-selection-with-google-charts)

原因是 Google 图表是在 iframe 内绘制的，因此您在文档上设置的任何样式都不会应用于图表。在 Google 将此添加到他们的 API 之前，没有简单的解决方法。

编辑：

我发现了一个有趣的解决方法...它不适用于旧版 IE，但 Google 可视化 API 中有一个 [未记录？] 选项，可让您将图表直接呈现到页面中，而无需中间 iframe。这样做时，您的图表可以使用您在文档中定义的任何字体系列。

选项是“forceIFrame”，您想在“选项”散列中将其设置为 false（即与 fontName 选项相同的散列）。

# php - Facebook 应用程序在授予权限后重新加载自己

> ID：10557889
> 
> 赞同：0
> 
> 时间：2012-05-11T20:03:36.927
> 
> 标签：php, facebook, facebook-graph-api, facebook-apps

我有一个小的 Facebook 应用程序，它发布了一些预加载的图像。我改变了代码结构，所以我把所有的变量都移到了config.php中，这样会更舒服。但在那之后应用程序不起作用，我真的不知道为什么......在权限对话框之后它一遍又一遍地重新加载自己......有人可以找到这个错误吗？

这是 index.php：

```
<?php

require 'facebook.php';
require 'config.php';

$facebook = new Facebook(array(
'appId' => $appId,
'secret' => $appSecret,
'baseUrl' => $baseUrl,
'appBaseUrl' => $appBaseUrl,
'fileUpload' => 'true',
'cookie' => 'true'
));

if (!empty($_SERVER['HTTPS']) && $_SERVER['HTTPS'] !== 'off' || $_SERVER['SERVER_PORT'] == 443) {
    $baseUrl = str_replace('http','https',$baseUrl);
    $fbPageURL = str_replace('http','https',$fbPageURL);
    $fbPageAppURL = str_replace('http','https',$fbPageAppURL);
}else{
    // not https
}

    $signed_request = $facebook->getSignedRequest();
    $page_id = $signed_request["page"]["id"];
    $like_status = $signed_request["page"]["liked"];

        if(!$like_status){
            header("Location: notfan.php");
            exit;
        }

$user = $facebook->getUser();

$params = array(
  scope => 'publish_stream,user_photos',
  redirect_uri => $fbPageAppURL
    );

$loginUrl = $facebook->getLoginUrl($params);
$app_data = $signed_request["app_data"];

?>
                    <!doctype html>
                    <html xmlns:fb="http://www.facebook.com/2008/fbml">
                    <head>
                    <title><?php echo $appName; ?></title>
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                    <style>
                        a:link    {color:#f1effc;}
                        a:visited {color:#f1effc;}
                        a:hover   {color:#19378d;}
                        a:active  {color:#19378d;}
                        a:link    {text-decoration: none}
                    </style>
                    </head>
                    <body>
                    <script type="text/javascript">
                        function NotInFacebookFrame() {
                            return top === self;
                         }
                        function ReferrerIsFacebookApp() {
                            if(document.referrer) {
                                return document.referrer.indexOf("apps.facebook.com") != -1;
                        }
                         return false;
                         }
                        if (NotInFacebookFrame() || ReferrerIsFacebookApp()) {
                            top.location.replace("<?= $fbPageAppURL ?>");
                        }
                    </script>

<?php if($user){

        try {
                $user_profile = $facebook->api('/me'); 

                $scope = 'publish_stream,user_photos'; 
                $scope_params = explode(',',$scope);

                $permissions = $facebook->api("/me/permissions"); 

                    if( array_key_exists('publish_stream', $permissions['data'][0]) &&  array_key_exists('user_photos', $permissions['data'][0])) {

                    // the main app logic here

                    } else {
                        $user = null;
                    }

    } catch (FacebookApiException $e) {
            error_log($e);
            $user = null;
        }
    }

    if ($user) {
    // logged in user
    } else {
        // not logged in or not authenticated
        echo '<script type="text/javascript">top.location.href = "'.$loginUrl .'";</script>';
    }

?>  
</body>
</html> 
```

和config.php：

```
<?php
$appName = 'the name';
$appId = '123456789';
$appSecret = '1324v3434v34v';
$baseUrl = 'http://www.domain.com/app-name/';
$appBaseUrl = 'http://apps.facebook.com/zzzzzzz/';
$fbPageURL = 'http://www.facebook.com/xxxxxxx';
$fbPageAppURL = $fbPageURL.'?sk=app_'.$appId;
?> 
```

非常感谢你！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T09:12:30.470

事实证明，这是服务器配置失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T23:16:15.540

包装 $user = $facebook->getUser(); 在 try/catch 中并回显被捕获的异常。这将告诉您为什么用户没有登录。

* * *

更多细节 - 在下面的评论之后。

您在 Javascript 中检查文档引荐来源网址 - 但我的测试中的实际引荐来源网址是“http://static.ak.facebook.com/platform/page_proxy.php?v=4”，所以这会导致该条件失败。这将导致循环。

要检查您是否在画布中，只需使用 PHP SDK 获取 signed_request

```
$facebook->signed_request(); 
```

如果这是空的，那么您不在画布（或页面选项卡）中，因此重定向到画布。在 PHP 中而不是在 Javascript 中执行此操作。

# ruby-on-rails - 循环后附加Rails回形针图像数据

> ID：10557892
> 
> 赞同：0
> 
> 时间：2012-05-11T20:03:47.707
> 
> 标签：ruby-on-rails, ruby, paperclip

我正在尝试制作一个显示回形针上传的所有图片的视图。我设置了回形针，到目前为止，图像已经很好地上传了。但是在创建视图时，由于某种原因，图片的对象数据会附加到所有图像之后。我的模型设置为图片包含图像，即上传的图像文件本身。

在我的控制器中：

```
class HomeController < ApplicationController
   def index
      @pictures = Picture.all
   end
end 
```

在我看来：

```
<h2>Pictures</h2>

<%= @pictures.each do |picture| %>
    <div>
        <%= image_tag picture.image.url(:thumb) %>
    </div>
<% end %> 
```

这就是我在所有图片之后在页面上看到的内容。

```
[#<Picture id: 6, created_at: "2012-05-11 18:57:21", updated_at: "2012-05-11 18:57:21", image_file_name: "puppy1.jpg", image_content_type: "image/jpeg", image_file_size: 150222, image_updated_at: "2012-05-11 18:57:21", title: "Doggy", caption: "">, #<Picture id: 7, created_at: "2012-05-11 19:28:56", updated_at: "2012-05-11 19:28:56", image_file_name: "puppy1.jpg", image_content_type: "image/jpeg", image_file_size: 150222, image_updated_at: "2012-05-11 19:28:56", title: "Doggy number 2", caption: "">] 
```

有趣的是，即使我删除了循环中的所有代码，对象数据仍然会出现，但如果我单独加载每张图片，它就可以正常工作。

```
@picture = Picture.find(6)

<%= image_tag @picture.image.url(:thumb) %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:14:30.717

代替

```
<%= @pictures.each do |picture| %> 
```

和

```
<% @pictures.each do |picture| %> 
```

'=' 也返回 @pictures 数组

# mysql - sql。获取最大值（平均（列））

> ID：10557897
> 
> 赞同：1
> 
> 时间：2012-05-11T20:04:26.420
> 
> 标签：mysql, sql

我已经简化了我的问题并创建了这个例子来更好地说明。

我的桌子：

```
CREATE TABLE `table_company` (
  `source_id` INT(10) UNSIGNED NOT NULL,
  `company_id` INT(10) UNSIGNED NOT NULL,
  `clicks` INT(10) UNSIGNED NOT NULL,
  PRIMARY KEY (`source_id`,`company_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8; 
```

我的数据：

```
INSERT INTO table_company VALUES
(1,100,8),(2,100,7),(3,200,9),(4,300,3),(5,100,4),(6,400,5),(7,100,10),(8,500,4),(9,500,9),(10,400,9);

SELECT source_id,company_id,AVG(clicks) AS avg_click FROM table_company
GROUP BY source_id,company_id
ORDER BY avg_click DESC; 
```

给我：

```
source_id  company_id  avg_click  
---------  ----------  -----------
        7         100      10.0000
        3         200       9.0000
        9         500       9.0000
       10         400       9.0000
        1         100       8.0000
        2         100       7.0000
        6         400       5.0000
        5         100       4.0000
        8         500       4.0000
        4         300       3.0000 
```

我想写一个查询给我：

```
source_id  company_id  avg_click  
---------  ----------  -----------
        7         100      10.0000
        3         200       9.0000
        9         500       9.0000
       10         400       9.0000
        4         300       3.0000 
```

IE。仅保留具有 MAX(avg_click) 的 company_id

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:13:41.403

```
SELECT source_id, company_id, MAX(avg_click) as max_click FROM 
(SELECT source_id,company_id,AVG(clicks) AS avg_click FROM table_company
GROUP BY source_id,company_id
ORDER BY avg_click DESC) tmp
GROUP BY company_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:28:54.340

```
 SELECT MAx(source_id), company_id, MAX(avg_click)
 from (SELECT source_id,company_id,AVG(clicks) AS avg_click FROM #table_company 
    GROUP BY source_id,company_id 
    )as tbl
 GROUP by company_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-22T18:24:16.027

您可以使用相关性：

```
SELECT source_id, company_id, avg_click
FROM table_company TC
WHERE avg_click=(SELECT max(avg_click)
             FROM table_company TC2
             WHERE TC.company_id=TC2.company_id
             GROUP BY TC2.company_id); 
```

您还可以使用 WITH 子句：

```
WITH pom AS(SELECT company_id, max(avg_click) MaxAvgCl
            from table_company
            group by company_id)
SELECT pom.company_id, T.avg_click, T.source_id
FROM pom JOIN table_company T on T.company_id=pom.company_id 
                              and T.avg_click=pom.MaxAvgCl; 
```

# c# - 如何动态地将值写入函数调用？

> ID：10557903
> 
> 赞同：0
> 
> 时间：2012-05-11T20:04:43.930
> 
> 标签：c#, asp.net

```
<asp:LinkButton class="uibutton normal submit" ID="LinkButtonMAR" 
OnClick="MarkClientNoteRead(<%# Eval("NoteID") %>)" runat="server">
Mark as Read</asp:LinkButton> 
```

这一切都在一个转发器中，它将返回一个笔记列表。我想获取 NoteID 并将其放入`OnClick="MarkClientNoteRead()"`方法调用中。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:07:43.477

你可以使用[`CommandArgument`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.commandargument)：

```
<asp:LinkButton class="uibutton normal submit" 
     ID="LinkButtonMAR" 
     CommandName="MarkRead"
     CommandArgument='<%# Eval("NoteID") %>'
     Text="Mark as Read"
     OnCommand="MarkClientNoteRead" runat="server" />

protected void MarkClientNoteRead(Object sender, CommandEventArgs e) 
{
     int NoteID = int.Parse(e.CommandArgument.ToString());
} 
```

请注意，您需要处理[`Command`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.command.aspx)事件而不是`Click`事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:19:22.813

另一种更复杂的方式是：

```
<asp:LinkButton class="uibutton normal submit" ID="LinkButtonMAR" 
    OnClick="LinkButtonMAR_Click" runat="server">Mark as Read
</asp:LinkButton>
<asp:HiddenField ID="NoteID" runat="server" Value='<%# Eval("NoteID")%>' /> 
```

代码背后：

```
protected void LinkButtonMAR_Click(object sender, EventArgs e)
{
    LinkButton thisLinkBUtton = (LinkButton)sender;
    // substitute appropriate object for the GridViewRow below
    GridViewRow thisGridViewRow = (GridViewRow)thisLinkBUtton.Parent.Parent;
    HiddenField hdnNoteID = (HiddenField)thisGridViewRow.FindControl("NoteID"); 
    // run your update code...
} 
```

我用过这个，但它让我不得不使用 Parent.Parent。另外，我需要来自同一行的其他数据。

# asp.net-mvc-3 - asp.net mvc 3 抛出异常

> ID：10557904
> 
> 赞同：5
> 
> 时间：2012-05-11T20:04:45.670
> 
> 标签：asp.net-mvc-3, error-handling

我在 webconfig 中打开了自定义错误并重定向到“/Error/Trouble”。这是按设计工作的。Elmah 正在记录错误。错误视图也正在显示。

问题是我想检查错误控制器的故障操作中抛出的错误。抛出错误时，在 MVC 将您重定向到自定义错误处理程序后，您如何访问它？

如果 CurrentUser 为空，我将抛出异常：

```
 if (CurrentUser == null)
        {
            var message = String.Format("{0} is not known.  Please contact your administrator.", context.HttpContext.User.Identity.Name);
            throw new Exception(message, new Exception("Inner Exception"));
        } 
```

我希望能够在我的自定义错误处理程序（“错误/故障”）中访问它。你如何访问异常？

这是我的麻烦行动：

```
 public ActionResult Trouble()
    {
        return View("Error");
    } 
```

这是我的看法：

```
@model System.Web.Mvc.HandleErrorInfo

<h2>
    Sorry, an error occurred while processing your request.
</h2>
@if (Model != null)
{
    <p>@Model.Exception.Message</p>
    <p>@Model.Exception.GetType().Name<br />
    thrown in @Model.ControllerName @Model.ActionName</p>
    <p>Error Details:</p>
    <p>@Model.Exception.Message</p>
} 
```

System.Web.Mvc.HandleErrorInfo 是我的故障视图的模型，它是空的。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:28:04.183

我找到了解决方法：

在 Global.asax 我这样做：

```
 protected void Application_Error()
    {
        var exception = Server.GetLastError();

        HttpContext.Current.Application.Lock();
        HttpContext.Current.Application["TheException"] = exception;
        HttpContext.Current.Application.UnLock();
    } 
```

在错误/故障中，我这样做：

```
 var caughtException = (Exception)HttpContext.Application["TheException"];
        var message = (caughtException!= null) ? caughtException.Message : "Ooops, something unexpected happened.  Please contact your system administrator";
        var ex = new Exception(message);
        var errorInfo = new HandleErrorInfo(ex, "Application", "Trouble");
        return View("Error", errorInfo); 
```

这是有效的。但这似乎是一种奇怪的方式。有没有人有更好的解决方案？谢谢你的帮助。

# sqlite - 多个数据库的sqlite数据库升级

> ID：10557908
> 
> 赞同：0
> 
> 时间：2012-05-11T20:04:59.137
> 
> 标签：sqlite, upgrade

我正在开发一系列“说”应用程序。可以选择更改语言。
所以我为 3 种不同的语言使用 3 个 sqlite 数据库，用户可以标记他们的收藏夹。

现在假设我已将版本 1 上传到市场。如果我在所有 3 个数据库中添加更多数据（不添加新列，仅添加新数据）并在市场上上传版本 2。用户安装新版本。

如何保留旧版本数据库中的用户收藏数据并添加版本 2 的新数据？请记住，我没有更改数据库结构或架构，我只是添加了一些新行。

# javascript - stackoverflow技术推送消息？

> ID：10557918
> 
> 赞同：3
> 
> 时间：2012-05-11T20:05:58.870
> 
> 标签：javascript, php, ajax, websocket, push-notification

当我在顶部菜单中有通知时会出现一个小图标，现在我正试图弄清楚 SOF 是如何做到的。我认为它可能使用 AJAX 每秒检查服务器，这是有道理的，但是如果有 1000 多个用户，它会使我认为的服务器超载，有人可以告诉我我是否正确，并让我知道如何使用技术像 SOF 一样在不破坏服务器的情况下进行实时推送

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:07:32.790

您应该考虑使用[WebSocket](http://en.wikipedia.org/wiki/WebSocket)技术。它适用于最新的浏览器（Chrome、Firefox 和 Safari），并允许服务器将更改推送到浏览器。但是，Internet Explorer 不支持它，因此对于该浏览器，Ajax 轮询几乎是唯一的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T21:03:28.790

我建议使用事件源，与 AJAX Comet 不同，没有长期保持的开放连接，因此您更有能力处理更多客户端。

```
/* Event Source Code */
// Initial Startup
if (!!window.EventSource) {
    var source = new EventSource('EventSource.php');
    // Native EventSource Events
    source.addEventListener('open', function(e) {
        // Connection was opened.
    }, false);
    source.addEventListener('error', function(e) {
        if (e.readyState == EventSource.CLOSED) {
            // Connection was closed.
        }
    }, false);
    source.addEventListener('message', function(e) {
        // You'll have to make your own banner function here.
        // e.data, this is what you'll need.
    }, false);
} 
```

# javascript - AngularJS - 带有 Rails 3.2.3 的 $http POST

> ID：10557921
> 
> 赞同：6
> 
> 时间：2012-05-11T20:06:08.720
> 
> 标签：javascript, jquery, ruby-on-rails-3, angularjs

我正在使用 AngularJS 1.0.0rc8 使用 Crud 构建一个简单的联系人管理应用程序。

获取当前存在的联系人列表没有问题，但是在尝试将新联系人保存到服务器时，会创建一个新行 - 包含正确的 id、created_at 和 updated_at 值 - 但其余模型数据将被忽略.

这是显示我的意思的屏幕截图：

![在此处输入图像描述](../Images/796b52e038fcd5bcff75b70df0a06af7.png)

如您所见，数字 4 和 5 被赋予了 ID，但 first_name、last_name 和 phone_num 没有保存到数据库中。

我在处理对象的控制器中使用**$scope.addContact函数。**

这是联系人列表控制器的完整代码：

```
'use strict';

function ContactListCtrl($scope, $http) {
  $http.get('/contacts').success(function(data) {
    $scope.contacts = data;
  });    

  $scope.addContact = function(data) {      

    $http.post('/contacts/', data).success(function(data) {
        console.log(data);
        data.first_name = $("#new_contact_first_name").val();
        data.last_name = $("#new_contact_last_name").val();
    });

    this.newFirstName = '';
    this.newLastName = '';
  };

}; 
```

在 new-contact.html 部分上单击**“保存”**后，如果我检查它的内容，对象会记录到控制台，然后肯定会收集到值 - 请注意 Jimi Hendrix 在那里：

![在此处输入图像描述](../Images/9c446f15c21449efbee5c06dbfeb6ef0.png)

这是出现在 new-contact.html 模板中的表单：

```
<form id="contact_form" ng-submit="addContact()">
            <input type="text" id="new_contact_first_name" name="newContactFirstName" ng-model="newFirstName" placeholder="First Name"></br>
            <input type="text" id="new_contact_last_name" name="newContactLastName" ng-model="newLastName" placeholder="Last Name"></br>
            <input type="button" id="contact_submit_btn" value="Add Contact" class="btn btn-primary">               
        </form> 
```

**addContact()**函数在使用 JQuery 提交表单后触发：

```
$(document).ready(function(){       

        $("#contact_submit_btn").click(function(){          
            $("#contact_form").submit();
        });
    }); 
```

* * *

*（有些东西告诉我，我可能没有正确使用 ng-model 属性。）*

**关于我在哪里出错的任何想法？或者关于如何更好地实施这个设计的想法？**

谢谢。

* * *

## 更新如下：

**这是我整个更新的控制器代码 - 在 Sathish 的帮助下：**

```
 // contacts controllers

'use strict';

function ContactListCtrl($scope, $http, Contacts) {   

  $scope.contacts = Contacts.index();  

  $scope.addContact = function() {
        var newContact = {
            first_name: $scope.newContactFirstName,
            last_name: $scope.newContactLastName
        };

        var nc = new Contacts({ contact: newContact });

        nc.$create(function() {
            $scope.contacts.push(nc);
            // now that the contact is saved, clear the form data
            $scope.newContactFirstName = "";
            $scope.newContactLastName = "";
            })
        }

};

ContactListCtrl.$inject = ['$scope', '$http', 'Contacts'];

function ContactDetailCtrl($scope, $routeParams, Contacts) {  
    $scope.contact = Contacts.get( {contact_id: $routeParams.contact_id} ); 
}

ContactDetailCtrl.$inject = ['$scope', '$routeParams', 'Contacts']; 
```

~~我现在收到错误消息：未知的联系人提供者。这是错误的屏幕截图~~

好的，我设法通过向主 App 文件提供**ngResource来修复该错误。**这是它的样子：

```
// main app javascript file

'use strict';

angular.module('contactapp', ['ngResource']).
  config(['$routeProvider', function($routeProvider) {
  $routeProvider.
      when('/contacts', {template: 'assets/app/partials/contact-list.html',   controller: ContactListCtrl}).
      when('/contacts/new', {template: 'assets/app/partials/new-contact.html',   controller: ContactListCtrl}).
      when('/contacts/:contact_id', {template: 'assets/app/partials/contact-detail.html', controller: ContactDetailCtrl}).
      otherwise({redirectTo: '/contacts'});
}]); 
```

~~我收到一个新错误： **警告：无法验证 CSRF 令牌的真实性**~~

好的，通过向 API 控制器添加回调也设法解决了这个问题： [Rails 显示来自 RestKit POST 的“警告：无法验证 CSRF 令牌真实性”](https://stackoverflow.com/questions/10167956/rails-shows-warning-cant-verify-csrf-token-authenticity-from-a-restkit-post)

~~**现在我回到原来的问题。调用 create 方法时，会在数据库中保存一个新行，但不会保存模型数据。**~~

**太棒了...终于让这件事起作用了。**

问题是**$scope.addContact**函数。它使用输入的“名称”而不是位于模板中的名为“newFirstName”和“newLastName”的**ng-model绑定。**

更新后的函数如下所示：

```
$scope.addContact = function() {
        var newContact = {
            first_name: $scope.newFirstName,
            last_name: $scope.newLastName
        };

        var nc = new Contacts({ contact: newContact });

        nc.$create(function() {
            $scope.contacts.push(nc);
            // now that the contact is saved, clear the form data
            $scope.newFirstName = "";
            $scope.newLastName = "";
            })
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T11:39:26.500

使用联系人服务可以更好地实现这一点。请在 app/assets/javascripts/services.js.erb 中定义一个联系人服务，如下所示：

```
var servicesModule = angular.module('<your app name>',
  [<list of modules needed by this app>]);

servicesModule.factory('Contacts', function($resource) {
  var ContactsService = $resource('/contacts/:contact_id', {}, {
    'create': { method: 'POST' },
    'index': { method: 'GET', isArray: true },
    'update': { method: 'PUT' },
    'destroy': { method: 'DELETE' }
  });
  return ContactsService;
}); 
```

更改控制器中的 addContact 方法，如下所示：

```
 function ContactListCtrl($scope, $http, Contacts) {
    ...
    ...
    ...
    $scope.addContact = function () {
      var newContact = {
        first_name: $scope.newContactFirstName,
        last_name: $scope.newContactLastName
      };

      var nc = new Contacts({ contact: newContact });
      nc.$create(function() {
        $scope.contacts.push(nc);
        // now that the contact is saved, clear the form data.
        $scope.newContactFirstName = "";
        $scope.newContactLastName = "";
      });
    };
    ...
    ...
    ...
  }
  ContactListCtrl.$inject = ['$scope', '$http', 'Contacts']; 
```

除此之外，您还可以简化`$http.get(...)`零件。您可以使用`Contacts.index();`

**笔记：**

*   如果您给了`ng-app="MyAppName"`，请替换`<your app name>`为`MyAppName`.
*   `<list of modules needed by this app>`需要用逗号分隔的字符串列表替换，该列表表示您的应用程序所需的任何模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T21:28:25.823

检查`attr_accessible`你的模型。使用新的 3.2.3 导轨，所有模型属性默认都受到保护，不会被批量分配。

# json - 服务器响应在中途被切断

> ID：10557927
> 
> 赞同：39
> 
> 时间：2012-05-11T20:06:55.853
> 
> 标签：json, rest, response

我有一个返回 json 响应的 REST API。有时（而且似乎是完全随机的），json 响应在中途被切断。所以返回的 json 字符串看起来像：

```
...route_short_name":"135","route_long_name":"Secte // end of response 
```

我很确定这不是编码问题，因为截止点不断改变位置，具体取决于返回的 json 字符串。我还没有找到会发生截断的特定响应大小（我看到 65kb 没有被截断，而 40kbs 会）。

当切断确实发生时查看响应标头：

```
{
    "Cache-Control" = "must-revalidate, private, max-age=0";
    Connection = "keep-alive";
    "Content-Type" = "application/json; charset=utf-8";
    Date = "Fri, 11 May 2012 19:58:36 GMT";
    Etag = "\"f36e55529c131f9c043b01e965e5f291\"";
    Server = "nginx/1.0.14";
    "Transfer-Encoding" = Identity;
    "X-Rack-Cache" = miss;
    "X-Runtime" = "0.739158";
    "X-UA-Compatible" = "IE=Edge,chrome=1";
} 
```

也不按铃。任何人？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-15T00:43:56.500

我有同样的问题：

Nginx 切断了 FastCGI 后端的一些响应。例如，我无法从 PhpMyAdmin 生成正确的 SQL 备份。我检查了日志，发现了这个：

> 2012/10/15 02:28:14 [crit] 16443#0: *14534527 open() "/usr/local/nginx/fastcgi_temp/4/81/0000004814" 在读取上游时失败（13：权限被拒绝），客户端：***，服务器：****，请求：“POST /***HTTP/1.1”，上游：“fastcgi://127.0.0.1:9000”，主机：“**", 引用者: "http://******/server_export.php?token=**** "******

 ******我所要做的就是为`/usr/local/nginx/fastcgi_temp`文件夹提供适当的权限，以及`client_body_temp`.

**固定的！**

非常感谢***samvermette***，您的问答让我走上了正轨。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-05-11T21:09:59.943

查看我的 nginx`error.log`文件，发现以下内容：

```
13870 open() "/var/lib/nginx/tmp/proxy/9/00/0000000009" failed (13: Permission denied) while reading upstream... 
```

看起来 nginx 的代理正在尝试将响应内容（由瘦传递）保存到文件中。仅当响应大小超过`proxy_buffers`（64 位平台上默认为 64kb）时才会这样做。所以最后这个错误*与*我的请求响应大小有关。

我通过在我的 nginx 配置文件中设置`proxy_buffering`为来解决我的问题，而不是升级或修复文件权限问题。`off``proxy_buffers`

仍然不确定 nginx 缓冲区的用途。如果有人能补充一下，我将不胜感激。完全禁用缓冲是一个坏主意吗？

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-01-09T17:34:16.593

我在切断服务器响应时遇到了类似的问题。

仅当我在返回响应之前添加 json 标头时才会发生这种情况`header('Content-type: application/json');`

在我的情况下`gzip`导致了这个问题。

`gzip_types`我通过在打开之前指定`nginx.conf`并添加到列表来解决它：`application/json``gzip`

```
gzip_types text/plain text/html text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript application/json;
gzip on; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-05T09:37:46.427

可能你的 inode 用完了，这会阻止 NginX 正确使用 fastcgi_temp 目录。

试试看`df -i`，如果你有 0% 的 inode 空闲，那就是个问题。

尝试`find /tmp -mtime 10`（超过 10 天）查看可能会填满磁盘的内容。

或者它可能是另一个包含太多文件的目录。例如，转到 /home/www-data/example.com 并计算文件：

`find . -print | wc -l`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-27T13:53:26.247

感谢您的问题和出色的答案，它为我节省了很多时间。最后，克莱门特和山姆的回答帮助我解决了我的问题，所以功劳归他们所有。

只是想指出，在阅读了有关该主题的一些内容后，似乎不建议禁用`proxy_buffering`它，因为如果客户端（您系统的用户）的互联网连接不佳，它可能会使您的服务器停止运行。

我发现[这个讨论](https://forum.nginx.org/read.php?2,223845,223845#msg-223845)对于了解更多信息非常有用。Francis Daly 的例子让我非常清楚：

> 也许将整个过程视为一个过程链更容易。
> 
> Web 浏览器通过 1 MB/s 链接与​​ nginx 对话。nginx 通过 100 MB/s 的链接与上游服务器对话。上游服务器向 nginx 返回 100 MB 的内容。nginx 将 100 MB 的内容返回到 Web 浏览器。
> 
> 开启 proxy_buffering 后，nginx 可以保持整个 100 MB，因此 nginx-upstream 连接可以在 1 s 后关闭，然后 nginx 可以花 100 s 将内容发送到 Web 浏览器。
> 
> 关闭 proxy_buffering 后，nginx 只能以 nginx 将内容发送到 Web 浏览器的相同速率从上游获取内容。
> 
> Web 浏览器并不关心差异——它仍然需要 100 秒才能获得全部内容。
> 
> nginx 不太关心差异——它仍然需要 100 秒才能将内容提供给浏览器，但它确实必须将与上游的连接保持打开额外的 99 秒。
> 
> 上游确实关心差异——本来可以花 1 s 的东西实际上需要 100 s；对于额外的 99 秒，该上游服务器不服务任何其他请求。
> 
> 通常：nginx-upstream 链接比 browser-nginx 链接快；而upstream比nginx更“重量级”；所以谨慎的做法是让上游尽快完成处理。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-10-07T15:09:24.367

我们遇到了类似的问题。这是由我们的 REST 服务器（DropWizard）启用了 SO_LINGER 引起的。在负载下，DropWizard 在有机会刷新其缓冲区之前就断开了 NGINX。JSON 大于 8kb，前端会收到截断的数据。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-23T07:43:22.533

我也遇到过这个问题——`JSON`解析客户端有问题，响应被切断或更糟，响应是陈旧的，并且是从一些随机内存缓冲区中读取的。

在阅读了一些指南之后——[通过 POST 从 Nginx](http://invalidlogic.com/2011/04/12/serving-static-content-via-post-from-nginx/)和Nginx 提供静态内容：在尝试配置 nginx 以提供简单文件[时使用 POST 服务静态时修复为“405 Not Allowed” 。](http://leandroardissone.com/post/19690882654/nginx-405-not-allowed)`JSON`

就我而言，我不得不使用：

```
max_ranges 0; 
```

这样当 nginx`Accept-Ranges: bytes`在响应头中添加时浏览器不会得到任何有趣的想法）**以及**

```
sendfile off; 
```

在我`server`为静态文件提供服务的代理块中。将它添加到`location`最终会为找到的`JSON`文件提供服务的块中没有帮助。

另一个提供 static`JSON`的提示也不会忘记响应类型：

```
charset_types application/json;
default_type application/json;
charset utf-8; 
```

其他搜索产生了文件夹权限问题[——nginx 正在切断动态页面的末尾并缓存它](https://serverfault.com/questions/514044/nginx-is-cutting-the-end-of-dynamic-pages-and-cache-it)或代理缓冲问题——[通过 nginx 获取分块请求](https://serverfault.com/questions/624897/getting-a-chunked-request-through-nginx)，但这不是我的情况。******

# python - mod_wsgi 错误 - 在受限模式下无法访问 class.__dict__

> ID：10557930
> 
> 赞同：8
> 
> 时间：2012-05-11T20:07:03.203
> 
> 标签：python, apache, mod-wsgi, wsgi, pyramid

这开始在我们的生产服务器上咬我们的屁股。我们偶尔会看到这种情况（每周 1 个请求）。那时我们发现这是因为 mod_wsgi 在一些配置中做了一些时髦的东西。由于我们无法追踪错误的原因，我们决定不需要立即关注它。

然而今天，在我们的一台生产服务器上，这确实发生在所有服务器请求的 10% 上；也就是所有服务器请求的 10% 都因同样的错误而失败：

```
mod_wsgi (pid=1718): Target WSGI script '/installation/dir/our-program/prod-dispatch.wsgi' cannot be loaded as Python module.
mod_wsgi (pid=1718): Exception occurred processing WSGI script '/installation/dir/our-program/prod-dispatch.wsgi'.
Traceback (most recent call last):
  File "/installation/dir/our-program/prod-dispatch.wsgi", line 7, in <module>
    from pyramid.paster import get_app
  File "/installation/dir/venv/local/lib/python2.7/site-packages/pyramid-1.3a6-py2.7.egg/pyramid/paster.py", line 12, in <module>
    from pyramid.scripting import prepare
  File "/installation/dir/venv/local/lib/python2.7/site-packages/pyramid-1.3a6-py2.7.egg/pyramid/scripting.py", line 1, in <module>
    from pyramid.config import global_registries
  File "/installation/dir/venv/local/lib/python2.7/site-packages/pyramid-1.3a6-py2.7.egg/pyramid/config/__init__.py", line 61, in <module>
    from pyramid.config.assets import AssetsConfiguratorMixin
  File "/installation/dir/venv/local/lib/python2.7/site-packages/pyramid-1.3a6-py2.7.egg/pyramid/config/assets.py", line 83, in <module>
    @implementer(IPackageOverrides)
  File "/installation/dir/venv/local/lib/python2.7/site-packages/zope.interface-3.8.0-py2.7-linux-x86_64.egg/zope/interface/declarations.py", line 480, in __
    classImplements(ob, *self.interfaces)
  File "/installation/dir/venv/local/lib/python2.7/site-packages/zope.interface-3.8.0-py2.7-linux-x86_64.egg/zope/interface/declarations.py", line 445, in cl
    spec = implementedBy(cls)
  File "/installation/dir/venv/local/lib/python2.7/site-packages/zope.interface-3.8.0-py2.7-linux-x86_64.egg/zope/interface/declarations.py", line 285, in im
    spec = cls.__dict__.get('__implemented__')
RuntimeError: class.__dict__ not accessible in restricted mode 
```

Ubuntu Precise，64 位，最新的 Apache，mod_wsgi，Python 2.7，在*守护进程*模式下使用 mpm_worker + mod_wsgi。这是服务器上唯一运行的程序，并且配置中只有一个 wsgi 解释器。这是因为 mpm_worker 产生了新线程还是什么？更重要的是 - 我们如何解决它。

我们有以下基于 cookie 将请求细分到 4 个守护进程。

```
WSGIPythonOptimize 1

WSGIDaemonProcess sticky01 processes=1 threads=16 display-name=%{GROUP}
WSGIDaemonProcess sticky02 processes=1 threads=16 display-name=%{GROUP}
WSGIDaemonProcess sticky03 processes=1 threads=16 display-name=%{GROUP}
WSGIDaemonProcess sticky04 processes=1 threads=16 display-name=%{GROUP}

<VirtualHost *:81>
    ...
    WSGIRestrictProcess sticky01 sticky02 sticky03 sticky04
    WSGIProcessGroup %{ENV:PROCESS}
    ...

    WSGIScriptAlias / /installation/dir/our-program/prod-dispatch.wsgi        
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-11T20:42:02.557

It has been known for ages that multiple subinterpreters don't play well along C extensions. However, what I did not realize is that the default settings are very unfortunate. [ModWSGI wiki](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIApplicationGroup) clearly states that the default value for WSGIApplicationGroup directive is %{RESOURCE} the effect of which shall be that

> The application group name will be set to the server hostname and port as for the %{SERVER} variable, to which the value of WSGI environment variable SCRIPT_NAME is appended separated by the file separator character.

This means that for each Host: header ever encountered while accessing the server the mod_wsgi kindly spawns a new subinterpreter, for which the C extensions are then loaded.

I had unknowingly triggered the error by accessing localhost.invalid:81 with *links* browser on this local server causing 1 of our 4 WSGIDaemonProcesses to fail for all future incoming requests.

Summa summarum: **always when using mod_wsgi with pyramid or any other framework that uses C extensions, make sure that WSGIApplicationGroup is always set to %{GLOBAL}**. In other words, the result of using the default settings will cause you to shoot yourself in the foot, after which you might want to shoot yourself in the head too.

# scala - 在 Scala 中实现 NPlusK 模式

> ID：10557943
> 
> 赞同：1
> 
> 时间：2012-05-11T20:07:39.880
> 
> 标签：scala, pattern-matching

我以为我可以通过 unapply 将 n+k 模式实现为 scala 中的活动模式，但它似乎失败了`unspecified value parameter: k`

```
object NPlusK {
    def apply(n : Int, k : Int) = {
        n + k
    }    

    def unapply(n : Int, k : Int) = {
        if (n > 0 && n > k) Some(n - k) else None
    }
}

object Main {
    def main(args: Array[String]): Unit = {

    }

    def fac(n: Int) : BigInt = {
        n match {
            case 0 => 1
            case NPlusK(n, 1) => n * fac(n - 1)
        }
    }
} 
```

是否可以在 Scala 中实现 n+k 模式，在这种情况下如何实现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:46:14.500

您应该查看[这个问题](https://stackoverflow.com/questions/6738577/matching-with-custom-combinations-operators/6738708)以进行更长时间的讨论，但这里是针对您的具体情况的简短改编。

一个`unapply`方法只能接受一个参数，并且必须根据该参数决定如何将其分成两部分。由于有多种方法可以将某个整数*x*分成*n*和*k*使得*x = n + k*，因此您不能使用 an `unapply`。

*您可以通过为每个k*创建单独的提取器来解决它。因此，而不是`NplusK`你有`Nplus1`,`Nplus2`等，因为只有一种方法可以从*x中获取**n* ，使得*x = n + 1*。

 **```
case class NplusK(k: Int) {
  def unapply(n: Int) = if (n > 0 && n > k) Some(n - k) else None
}

val Nplus1 = NplusK(1)

val Nplus1(n) = 5  // n = 4 
```

所以你的比赛变成：

```
 n match {
        case 0 => 1
        case Nplus1(n) => n * fac(n - 1)
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T20:35:27.363

解构器 unapply 根本不能以这种方式工作。它只接受一个参数，即匹配值，并返回元组上的一个选项，其中包含与您的模式 (NPlusK) 的参数一样多的元素。也就是说，当你有

```
(n: Int) match {
   ...
   case NPlusK(n, 1) 
```

它将寻找`unapply`带有`Int`（或超类型）参数的方法。如果有这样的方法，并且返回类型是 a `Tuple2`（因为 NPlusK 在模式中出现了两个参数），那么它将尝试匹配。无论 NPlusK 内部有什么子模式（这里是变量 n 和常量 1），无论如何都不会被传递给 unapply（如果你写的话，你期望什么`case NPlusK(NPlusK(1, x), NPlusK(1, y))`？）。相反，如果 unapply 返回一些元组，那么元组的每个元素都将匹配到相应的子模式，这里`n`总是匹配，如果值等于 1，则匹配 1。

你可以写

```
def unapply(n: Int) = if (n > 0) Some((n-1, 1)) else None. 
```

当你的`NPlusK(n, 1)`. 但这不会匹配`NPlusK(n, 2)`, 也不会`NPlusK(1, n)`（除非`n`是 2）。这没有多大意义。一个模式应该可能只有一个可能的匹配项。`NPlusK(x, y)`可以通过许多不同的方式进行匹配`n`。

什么会起作用的是 Peano 整数之类的`Succ(n)`匹配`n+1`.**

# javascript - 群阵划分

> ID：10557946
> 
> 赞同：0
> 
> 时间：2012-05-11T20:07:44.577
> 
> 标签：javascript, jquery, arrays

此代码 [http://jsfiddle.net/minagabriel/5MQ77/](http://jsfiddle.net/minagabriel/5MQ77/)

```
 var flowShadeBigArray =[] ;
          var x = [7, 411, 780]
          var y = [286, 712, 1058]

        for( var i = 0 ; i< x.length;i++){

            for(var index = x[i]; index <= y[i] ; index++ ){

                 var temp = [] ; 

                temp.push(index) ; 
                flowShadeBigArray.push(temp); 

            }

        }
        console.log(JSON.stringify(flowShadeBigArray)); 
```

生成以下数组

```
 [[7],[8],[9],[10],[11],[12],[13],[14]................[1056],[1057],[1058]] 
```

我想在 flowShadeBigArray 中创建一个三个数组并将它们`[x[i] ... y[i] ]` 组合在一起：

例子

```
[  [  [7]....[286] ] , [ [411]...[712] ] ,[ [780]...[1058] ] ] 
```

注意我仍然需要将这些数字中的每一个都保存为一个数组，这样我就可以将它用作其他东西的索引

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:23:57.883

只需将`temp`初始化移动到第一个循环，第二个之前，第二`.push()`个之后（或之前，没关系）的第一个循环。

```
var flowShadeBigArray = [];
var x = [7, 411, 780]
var y = [286, 712, 1058]

for (var i = 0; i < x.length; i++) {
    var temp = [];

    for (var index = x[i]; index <= y[i]; index++) {
        temp.push(index);
    }
    flowShadeBigArray.push(temp);
} 
```

[http://jsfiddle.net/5MQ77/1/](http://jsfiddle.net/5MQ77/1/)

如果每个单独的数字都属于它自己的数组，那么改变这个：

```
flowShadeBigArray.push(temp); 
```

对此：

```
flowShadeBigArray.push([temp]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:25:31.347

-编辑

```
function range(from, to) {
    var arr = [];
    while (from <= to) {
         arr.push([i++]);
    }
    return arr;
}
var result = [];
for (var i=0; i<x.length; i++) {
    result.push(range(x[i], y[i]));
} 
```

# android - 为什么 cordova.exec() 在“deviceready”之前在我的 Android PhoneGap (1.7) 应用程序中运行？

> ID：10557947
> 
> 赞同：5
> 
> 时间：2012-05-11T20:07:45.353
> 
> 标签：android, jquery-mobile, cordova

我正在尝试“PhoneGap”（1.7.0）一个 jQuery Mobile 应用程序（1.1.0）我必须创建一个 Android 应用程序。但是，我不断收到以下警报消息。

```
ERROR: Attempting to call cordova.exec() before 'deviceready'. Ignoring. 
```

似乎这可能*在*$.ajax 调用期间发生，但很难确定。

我没有在我的应用程序中调用 Cordova 函数 - 它是纯 JQM。

任何想法是什么问题。或者，如果做不到这一点，有人知道为什么在 $.ajax 请求期间可能会调用 cordova.exec() 吗？

我在虚拟设备/模拟器中运行 Android 4.0.3 下的应用程序。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-13T06:38:34.467

花了几个小时后我遇到了类似的问题，我意识到 cordova-1.7.0.js（或你的情况下的 phonegap-1.7.0.js）是 iOS 的，因为我最初为 iOS 创建了项目我用这个文件替换了相关的android JS文件并开始工作。

cordova-1.7.0.js 对于不同的移动平台是不同的，针对特定平台使用正确的 JS 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T13:31:36.050

就我而言，这是因为

```
$(document).ready()... 
```

函数没有正确触发，所以我只是将其更改为 javascript 版本

```
<body onload="init();"> 
```

在html中定义了一个函数

```
function init(){ 
     document.addEventListener("deviceready", onDeviceReady, true);
} 
```

在我的javascript文件中，它解决了问题

# c++ - MFC 功能区应用程序不显示功能区 - 将 .exe 复制粘贴到另一台计算机时

> ID：10557948
> 
> 赞同：0
> 
> 时间：2012-05-11T20:07:49.020
> 
> 标签：c++, visual-studio-2008, mfc, ribbon

好吧，我面临一个奇怪的问题。我在我的机器上开发了一个示例 MFC 功能区应用程序 - Windows 7 和 Visual Studio 2008。当我将 .exe 复制粘贴到我的笔记本电脑并运行应用程序时，我看不到功能区菜单（实际上应用程序没有现在菜单）。

我尝试使用进程监视器查找在每种情况下（在我的工作机器和笔记本电脑上）加载的 .dll，但我无法找到我可能丢失的内容。任何帮助将不胜感激。

编辑 1 -

好的，谢谢您的回复。在这个问题上取得了一些进展

1.  我将 IDE 更改为 VS 2010。功能区是手动编码的，我想知道是否可以将其添加为资源，也许问题会得到解决。VS 2008 没有添加功能区作为资源的选项。

2.  我安装了 VS 2010 Service Pack Redistributable X86/X64，具体取决于机器是 32 位还是 64 位。

3.  我从 VS 2010 构建了一个新的“ribbontest.exe”应用程序，并将其部署在我将测试我的实际应用程序的其他机器上。“ribbontest.exe”的功能区加载没有任何问题。

**当我部署并运行我的应用程序时，首先旧菜单栏会加载一两秒钟，然后功能区会闪烁并消失。**

我所指的应用程序的一点历史 - 最初我的应用程序有菜单栏视图。我按照这篇文章[http://www.codeguru.com/cpp/cpp/cpp_mfc/tutorials/article.php/c14929/MFC-Feature-Pack-An-Introduction.htm](http://www.codeguru.com/cpp/cpp/cpp_mfc/tutorials/article.php/c14929/MFC-Feature-Pack-An-Introduction.htm) 来容纳一个功能区。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T08:39:18.737

设置“路径”中很可能存在冲突。在您的`InitInstance()`处理程序中，您有这样的声明：

```
// Standard initialization
// If you are not using these features and wish to reduce the size
// of your final executable, you should remove from the following
// the specific initialization routines you do not need
// Change the registry key under which our settings are stored
SetRegistryKey(_T("yourappname")); 
```

如果您尚未更改该名称，请执行此操作。如果您这样做了，`regedit.exe`请在目标计算机上打开并删除下面的整个密钥`HKCU\Software\yourappname`，然后重试。

MFC 将 Ribbons/Menus/... 的用户自定义项存储在该键下。但是，如果您更改了您的应用程序，这些设置不一定会再匹配，您最终可能会出现无法正确显示或根本不显示的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:17:22.240

确保在目标计算机上下载并安装 Visual C++ Redistributable Runtime：http: [//www.microsoft.com/en-us/download/details.aspx?id=29](http://www.microsoft.com/en-us/download/details.aspx?id=29)

或者，类似的东西。确保您的架构 (x86/x64) 正确，并确保它与您编译的服务包版本匹配。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-12T12:02:18.450

**Joe 是对的：**你需要可再分发的。

**乔是对的：**你不能在 32 位机器上运行 64 位程序。

以上所有情况都会由系统指示（缺少 DLL、配置不正确或 64/32 位差异）

**Joe 是对的：**您的应用程序必须针对特定的最低 Windows 版本和服务包构建。

除了 Joe 的帖子之外，您还必须运行 release build 而不是 debug build。如果满足所有这些要求并且您仍然遇到此问题，请尝试静态链接 MFC 并查看问题是否仍然存在。

# php - 从 # 之后的 URL 解析 Facebook 令牌

> ID：10557951
> 
> 赞同：2
> 
> 时间：2012-05-11T20:07:58.233
> 
> 标签：php, facebook

我注册了 PHP 脚本和 Facebook 应用程序，但应用程序会将用户重定向到 mypage.com/fblogin.php#access_token=FacebookToken

如何获得访问令牌？我已经尝试过 $_GET["access_token"] 和 POST，但它没有用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T20:13:40.483

您无法在服务器端访问 URL 锚点。您必须使用 javascript 来形成以查询字符串或帖子形式发送的请求。

# php - php url 缩短

> ID：10557955
> 
> 赞同：0
> 
> 时间：2012-05-11T20:08:13.420
> 
> 标签：php, url-rewriting

好吧，我想这是一个普遍的问题，而不是一个问题。

我正在构建一个用户可以在其他网站上共享他们的个人资料的系统，所以我想知道是否可以缩短实际的 url，该网址将提供指向他们的个人资料的链接，就像这样，`www.somedomain.com/users/profile.php?user=myusername`简单地删除用户文件夹和个人资料页面等等这样的：`www.somedomain.com/myusername`

我见过很多 url 缩短脚本，但他们似乎没有这样做，任何建议或建议将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:12:51.610

您正在寻找的内容称为 URL 重写，可以使用[Apache 的 mod_rewrite](http://www.workingwith.me.uk/articles/scripting/mod_rewrite)来完成。您将在您的根 Web 目录中放置一个名为 .htaccess 的文件，该文件将包含如下代码段：

```
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule  /(.*) /users/profile.php?user=$1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:12:04.940

这称为“url 重写” - 有不同的方法可以做到这一点，例如使用[apaches mod_rewrite](http://www.cyberdesignz.com/blog/website-design/url-rewriting-top-5-ways-of-php-url-rewriting/)。另一种方法是手动解析`$_SERVER['REQUEST_URI']`- 即使`mod_rewrite`未启用，这也会使您的网站正常工作，但还有更多工作要做。

# django - 从模型创建表单标签，从另一个模型以 django 形式创建问题

> ID：10557960
> 
> 赞同：0
> 
> 时间：2012-05-11T20:08:50.860
> 
> 标签：django, django-forms

我有两个模型：

```
class Questions(models.Model):
  question = models.TextField(verbose_name='Question')
  def get_answers(self):
      query = self.answers.select_related()
      for q in query:
          return q

  def __unicode__(self):
      return u'%s'%(self.question)

class Answers(models.Model):
   answers = models.CharField(verbose_name='answer')
   question = models.ForeignKey(Questions, related_name="answers")

   def __unicode__(self):
       return u'%s'%(self.answers) 
```

我想创建一个表单，该表单形成从问题创建的标签和来自答案的答案。我创建了一个这样的表单：

```
class QuestionForm(forms.Form):

    def __init__(self,questions, *args, **kwargs):
        self.questions = questions
        for question in questions:
            field_name = "question_%d" % question.pk
            choices = []
            for answer in question.answers.all():
                choices.append((answer.pk,answer.answers))

            field = forms.ChoiceField(label=question.question, required=True,
                                  choices=choices, widget=forms.RadioSelect)
        return super(QuestionForm, self).__init__(*args, **kwargs) 
```

编辑：

```
def my_view(request):
    questions = Questions.objects.filter(......)
    form = QuestionForm(questions)
    return render_to_response('my_view.html',
                          {
                            'form':form
                          },
                          context_instance=RequestContext(request)) 
```

但是在上面的视图中，模板中没有任何形式。我的`QuestionForm`from 有什么问题？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:58:46.463

如果您为此更改课程，您的表格将有效

```
 class QuestionForm(forms.Form):

    def __init__(self,questions, *args, **kwargs):
        super(QuestionForm, self).__init__(*args, **kwargs)
        self.questions = questions
        for question in questions:
            field_name = "question_%d" % question.pk
            choices = []
            for answer in question.answers.all():
                choices.append((answer.pk,answer.answers))

            self.fields[fields_name] = forms.ChoiceField(label=question.question, required=True,
                              choices=choices, widget=forms.RadioSelect) 
```

# orchardcms - Orchard CMS 和基于 aspx 的主题视图而不是剃刀？

> ID：10557965
> 
> 赞同：0
> 
> 时间：2012-05-11T20:09:10.850
> 
> 标签：orchardcms

我是 razor (cshtml) 视图上的 aspx 视图的铁杆粉丝。是否可以在 Orchard 主题中使用 aspx 视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:55:22.957

目前是的，但有人谈论默认情况下削减该支持。我很想知道你觉得 aspx 有什么吸引人的地方。

# c#-4.0 - COM Interop 中动态代码的内存泄漏

> ID：10557968
> 
> 赞同：4
> 
> 时间：2012-05-11T20:09:24.567
> 
> 标签：c#-4.0, dynamic, asp-classic, memory-leaks, com-interop

出于旧版 ASP 代码和新 ASP.NET 代码之间的兼容性原因，我们有一堆 .NET COM 对象，它们将我们的一些 .NET 实用程序暴露给 ASP。在某些情况下，我们需要在 .NET COM 包装器中使用另一个 COM 对象。为了实现高灵活性并避免 PIA 依赖性，我们决定使用动态代码来处理这些 COM 对象。

简化的 C# COM 对象：

```
using System;
using System.Text;
using System.Runtime.InteropServices;

namespace TestCom
{
    [ComVisible(true)]
    [Guid("6DC92920-8C3C-4C81-A615-BD0E3A332024")]
    [InterfaceType(ComInterfaceType.InterfaceIsDual)]
    public interface ITestComObject
    {
        [DispId(1)]
        string MyMethod(dynamic dictionary);
    }

    [ComVisible(true)]
    [Guid("F52A463E-F03B-4703-860C-E86CDD6D04E3")]
    [ClassInterface(ClassInterfaceType.None)]
    [ProgId("TestCom.TestComObject")]
    public class TestComObject : ITestComObject
    {
        string ITestComObject.MyMethod(dynamic dictionary)
        {
            StringBuilder sb = new StringBuilder();

            if (dictionary != null)
            {
                foreach (object key in dictionary)
                {
                    object p = dictionary[key];
                    if (p != null)
                    {
                        sb.AppendFormat("{0}={1}{2}", key, p, Environment.NewLine);
                    }
                }
            }

            return sb.ToString();
        }
    }
} 
```

测试 ASP 页面：

```
<%@ Language=VBScript %>
<%
    Dim testObj, params
    Set testObj = Server.CreateObject("TestCom.TestComObject")

    Set params = Server.CreateObject("Scripting.Dictionary")
    params("lang") = "en-US"
    params("num") = 42

    Response.Write testObj.MyMethod(params)

    Set testObj = Nothing
    Set params = Nothing
%> 
```

在正常情况下，动态代码将只编译一次，随后的调用将重用它。然而，在我们的例子中，动态代码似乎是在每次调用时编译的。当我将内存分析器附加到 IIS 进程时，我可以清楚地看到来自 Microsoft.CSharp.RuntimeBinder.Semantics 命名空间的其他对象出现在 gen2 中。这有效地导致了我们的 IIS 进程中的内存泄漏。

任何想法如何解决这个动态代码编译问题？请注意，在我们的案例中，重写所有代码以使用 PIA 和 COM 接口并不总是一种选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T08:23:21.367

我建议您将任何易受内存泄漏影响的代码作为单独的进程 - 例如，父进程通过套接字与此类泄漏进程通信。然后要么在每次通话时重新启动这些泄漏过程，要么在晚上的某个时间重新启动它们！

# jquery - 当 mouseleave() 的当前选择器时中断 mouseenter 动画

> ID：10557973
> 
> 赞同：3
> 
> 时间：2012-05-11T20:10:10.453
> 
> 标签：jquery

[http://jsfiddle.net/ZtpEU/41/](http://jsfiddle.net/ZtpEU/41/) 继承人在 jquery 中的一个简单的动画。我正在尝试使其仅在 mouseenter 发生时才执行动画。此外，你会注意到，如果你疯狂地用鼠标进入和离开，元素动画会被记住，这基本上会让它们疯狂地动画。

我正在寻找这个动画，只要鼠标悬停在该特定元素上，它就会执行。如果移动，则动画将重置并为下一个悬停元素设置动画。

对不起，这真的很难说。我会非常注意答案。最后，我正在寻找更多[这种 css 过渡效果](http://designshack.net/articles/css/mastering-mouse-enter-and-exit-events-with-css-transitions/)（这只发生在谷歌浏览器中，或者我会这样做）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T20:15:11.477

你可以使用`stop()`方法：

```
$("li").on('mouseenter',function(){
  $(this).animate({"padding-left": "50px"}, "normal");
});
$("li").on('mouseleave',function(){
  $(this).stop(true).animate({"padding-left": "0px"}, "slow");
}); 
```

[http://jsfiddle.net/ZtpEU/43/](http://jsfiddle.net/ZtpEU/43/)

# jquery - JQuery 分页——点击页码并删除 href attr

> ID：10557974
> 
> 赞同：0
> 
> 时间：2012-05-11T20:10:18.020
> 
> 标签：jquery, pagination, hyperlink

```
page = 1;

$('.links').click(function() {
    $(this).removeAttr('href');
    page = $(this).html();
});

<a href="#" class="links"> 1 </a>
<a href="#" class="links"> 2 </a>
<a href="#" class="links"> 3 </a> 
```

当我单击页码时，我想删除 href 属性。问题是，如果我连续点击页面，之前点击的页码不会重新获得它们的 href 属性。我怎么能这样做？

jsfiddle：http: [//jsfiddle.net/JGpF9/](http://jsfiddle.net/JGpF9/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:14:31.757

不是*最好*的解决方案，但仍然可以。这会在删除当前链接之前将“#”的 href 添加回链接。如果 href 不同，那么您必须以不同的方式解决此问题。

[http://jsfiddle.net/JGpF9/1/](http://jsfiddle.net/JGpF9/1/)

```
$('.links').click(function() {
    $('.links').attr('href', '#');
    $(this).removeAttr('href');
    page = $(this).html();
});​ 
```

注意：我还会在锚标签之外添加空格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T22:26:21.733

这是解决方案：

```
$('.links').click(function() {  
    $('.links').slice(page - 1, page).attr('href', '#');
    page = $(this).html();
    $('.links').slice(page - 1, page).removeAttr('href');
}); 
```

# c# - 是否可以在它们之间对组合框和文本框进行数据绑定？

> ID：10557975
> 
> 赞同：1
> 
> 时间：2012-05-11T20:10:19.393
> 
> 标签：c#, winforms, data-binding

假设您有一个组合框和一个文本框。

组合框包含项目列表，我想将文本框“文本”属性绑定到当前组合框选择。

在 WPF 中可以做到这一点，但我在 WinForms 中没有找到方法。

有没有办法或者 WinForms 太有限了？

笔记：

*   我知道我可以改用 WPF，但该项目已经在 WinForms 中并且重写它是不可能的。
*   我问的是组合框和文本框，但这可能是任何其他组合。
*   我正在寻找一种从设计时开始就可以做到的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:13:22.543

您可以在组合框上添加一个 onSelectedIndexChange 事件处理程序并在那里修改文本框表单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T20:33:08.763

是的，您可以将文本框绑定到`Text`在组合框中选择的项目 ( )：

```
 public partial class Form1 : Form {
      Binding binding;

      public Form1() {
         InitializeComponent();

         binding = new Binding("Text", comboBox1, "Text");
         textBox1.DataBindings.Add(binding);
      }
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:15:11.507

在这里你去：这些行创建一个委托，其开始调用是否已更改项目下的选定索引。然后它将文本框，文本属性设置为组合框中的选定项目文本:)

```
 TextBox txtbox = new TextBox();
            ComboBox cob = new ComboBox();
            cob.SelectedIndexChanged += new EventHandler(delegate(object sender, EventArgs e) { if (cob.SelectedIndex > -1) txtbox.Text = cob.Items[cob.SelectedIndex].ToString(); }); 
```

# python - python 在交互模式下运行时有何不同？

> ID：10557977
> 
> 赞同：4
> 
> 时间：2012-05-11T20:10:24.643
> 
> 标签：python, interactive, interactive-mode

如果我使用 Python 的交互模式一次键入一个命令，我有[一些 Python 代码可以按预期工作。](https://stackoverflow.com/questions/10525304/program-works-in-idle-but-fails-at-the-command-line)如果另存为`myscript.py`并运行为`'C:\Python27\python.exe myscript.py'`.

**如果相同的代码在交互模式下运行，以何种方式将 Python 代码作为脚本运行会导致它崩溃？**

[这个问题](https://stackoverflow.com/questions/2356399/tell-if-python-is-in-interactive-mode)询问如何判断 python 是否处于交互模式。然而，提问者只想要一个单一的、可靠的交互模式指纹。我想要一个交互模式不同的方式列表，特别注意这可能导致的问题。

例如：

*   `sys.path`可能不同
*   `os.getcwd()`可能不同
*   `os.environ`可能不同
*   [这个问题](https://stackoverflow.com/questions/2356399/tell-if-python-is-in-interactive-mode)的所有答案
*   多处理模块文档开头的[此警告](http://docs.python.org/library/multiprocessing.html)

**Python 的交互模式和脚本模式还有什么不同？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:20:30.367

`Thread`s 和`Greenlet`s 在交互环境中具有不同的行为。在某些情况下，主事件循环必须被破解。

`Greenlet`来自`gevent`模块，它是python中的并发任务。它有一个独立于 Python（pthread）的内部上下文切换，并且并发性非常好（根据我的经验）。Greenlets 的一些问题是，如果没有猴子补丁（模块中的模块`gevent`），它们会阻塞阻塞 C 系统调用和套接字交互。

需要修补主事件循环才能使greenlet正常工作...如果您在交互式环境中生成greenlet，它将不会切换上下文并执行，我忘记了如何修补主事件循环（稍后会添加）。

失败示例：

```
In [1]: from gevent.greenlet import Greenlet

In [2]: def print_hi():
   ...:     print 'hi'
   ...:     

In [3]: print_hi()
hi

In [4]: g = Greenlet(print_hi)

In [5]: g.start() 
```

编辑：

在查看了这个项目的一些代码之后，这里是我们如何破解 ipython 输入钩子以使用 gevent

```
import sys
import select
import gevent

def stdin_ready():
    infds, outfds, erfds = select.select([sys.stdin], [], [], 0)
    if infds:
        return True
    else:
        return False

def inputhook_gevent():
    try:
        while not stdin_ready():
            gevent.sleep(0.001)
    except KeyboardInterrupt:
        pass

    return 0

# install the gevent inputhook
from IPython.lib.inputhook import inputhook_manager
inputhook_manager.set_inputhook(inputhook_gevent)
inputhook_manager._current_gui = 'gevent'

# First import the embeddable shell class
from IPython.frontend.terminal.embed import InteractiveShellEmbed 
```

修补示例：

```
In [6]: def say_hi():
   ...:     print "hi"
   ...:     

In [7]: g = gevent.greenlet.Greenlet(say_hi)

In [8]: g.start()

In [9]: hi  <-- Cursor is here so it printed hi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:15:22.317

看起来您正在与硬件进行交互，这带来了 REPL 和脚本之间最明显的区别：

**脚本中的命令会尽快运行，而 REPL 则等待人工输入。**

也就是说，您可能遇到了时间问题，即硬件在执行上一条命令后还没有为下一条命令做好准备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T20:40:47.067

看看这条线

```
PCO_api = ctypes.oledll.LoadLibrary("SC2_Cam") 
```

如果您可以使用 LoadLibrary 的 COMPLETE 路径

# sql - 局部变量数学显示奇怪的行为

> ID：10557980
> 
> 赞同：0
> 
> 时间：2012-05-11T20:10:32.820
> 
> 标签：sql

我正在尝试查询以告诉我数据集中男性和女性的百分比（我之前提出的问题的扩展）。查询仅来自一张表。

```
declare @totalPop int;
declare @totalmales int;
declare @totalFemales int;
declare @percentMales float;
declare @percentFemales float;
set @totalpop =(select count(*) from myTable)
set @totalmales =(select count(*) from myTable where (sex='m'))
set @totalfemales =(select count(*) from myTable where (sex='f'))
set @percentMales=@totalMales/totalPop
set @percenFemales =@totalFemales/totalPop

select sex, count(sex), @totalPop, @totalMales, @totalFemales 
```

我知道目前这行不通，但我不知道如何在一行上除以 totalMales，在下一行除以 totalFemales

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:25:08.773

```
SELECT 
   DISTINCT Sex,
   @totalpop as 'TotalPopulation',
   CASE Sex
        WHEN 'm' THEN @TotalMales
        WHEN 'f' then @TotalFemales
        ELSE 'WTF?' END
   as 'SexCount'
   ...
FROM 
   MYTable 
```

您可以使用 a`CASE`根据`sex`值选择显示的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T20:59:07.113

```
CREATE TABLE myTable(id NUMBER, sex CHAR(1));

INSERT INTO myTable VALUES(1, 'm');
INSERT INTO myTable VALUES(2, 'm');
INSERT INTO myTable VALUES(3, 'f');
INSERT INTO myTable VALUES(4, 'f');
INSERT INTO myTable VALUES(5, 'f');

SELECT COUNT(DISTINCT sex) AS count_distinct_sex
      ,COUNT(*) AS totalPop
      ,SUM(CASE WHEN sex = 'm' THEN  1 ELSE 0 END) AS totalMales
      ,SUM(CASE WHEN sex = 'f' THEN  1 ELSE 0 END) AS totalFemales
  FROM myTable;

COUNT_DISTINCT_SEX TOTALPOP TOTALMALES TOTALFEMALES
------------------ -------- ---------- ------------
                 2        5          2            3 
```

# html - 删除表格单元自动调整大小

> ID：10557982
> 
> 赞同：0
> 
> 时间：2012-05-11T20:10:36.143
> 
> 标签：html, css, html-table

如何删除表格单元格的自动调整大小？当我输入超过表格单元格宽度的文本时，它会自动增加其宽度。有没有办法禁用它的自动调整大小？

我直接在表格单元格中添加文本，没有任何其他元素`<td>`，

```
<td>Text is Here...</td> 
```

当文本超过 's 的宽度时是否存在元素，`<td>`它将自动结束下一个单词。那可能吗？我试过`<p>`了，它对我不起作用。

这是一个示例：

[http://jsfiddle.net/88RtG/2/](http://jsfiddle.net/88RtG/2/)

我希望第一个单元格的宽度与其他所有单元格相同，无论其内容如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T08:24:30.157

`table-layout: fixed`如果单元格包含不能被浏览器应用的规则破坏的字符串，浏览器显然无论如何都会扩展单元格（甚至没有帮助）。

如果像“asdasdasdasdasdasddasdasdadasd”这样的字符串没有允许的断点，那么似乎唯一的方法是将单元格内容包装在一个元素中，比如说`<td><div class=cell>...</div></td>`并在该内部元素上设置一个宽度。然后，您将不得不处理溢出问题（如果多余的内容流入下一个单元格，或者被隐藏，还是什么？）。

如果它有允许的断点，请标记它们，使用`<wbr>`或`&#x200b;`（更多信息：[http](http://www.cs.tut.fi/~jkorpela/html/nobr.html#suggest) ://www.cs.tut.fi/~jkorpela/html/nobr.html#suggest ）以获得简单的换行机会，`&shy;`用于连字符点.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:16:21.600

指定表格、行或单元格的宽度。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-11T20:14:09.160

尝试：

```
<td width="80px">Text is Here...</td> 
```

更改您想要的所有单元格的宽度 - 只需要在第一行进行。您也可以使用百分比。

# java - 使用 MySql Springdata 和 Hibernate 的大小写问题

> ID：10557984
> 
> 赞同：1
> 
> 时间：2012-05-11T20:10:59.243
> 
> 标签：java, mysql, hibernate, jpa, spring-data

我有一个包含分配表的数据库。该表如下所示：

```
ID | CHARACTER_ASS | TYPE_ASS 
```

字符列内存储字母和数字。IE。“A”、“A”、“A”。“AA”、1 等...现在，当我在查询控制台中执行以下查询时：

```
select * from assignment a where a.CHARACTER_ASS = 'A' 
```

它将返回我数据库中的小写条目和大写条目。现在我一直在寻找这个问题的答案，有人告诉我这可能是因为我在 Windows 操作系统上运行。我已经查过了，只能发现在命名表名时使用/不使用小写字母 (?) 可能存在问题。

另一个问题是我正在使用弹簧数据。在 spring 数据中，我无法直接控制查询，所以我想知道 spring 数据是否有特定的修复。

我想听听你对这个问题的回答:)

提前致谢

**编辑**

我的 SHOW CREATE TABLE 作业：

```
CREATE TABLE `assignment` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `CHARACTER_ASS` varchar(45) NOT NULL,
  `TYPE_ASS` int(11) NOT NULL,
  PRIMARY KEY (`ID`)
) ENGINE=InnoDB AUTO_INCREMENT=17 DEFAULT CHARSET=utf8 
```

**编辑2**

我将分配表排序规则更改为：latin1_general_cs，并尝试在 MySql 查询编辑器中手动查询，但我仍然得到 A 和返回结果。然后我尝试将表格的排序规则调整为与表格相同的值。我做错了什么还是应该调整工作？

**编辑3**

好的，我刚刚修复了它。我没有使用 latin1_general_cs，而是使用了 utf8_bin。似乎 utf8 没有区分大小写的排序规则 :) 感谢 JB Nizet 为我指明了正确的方向！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T20:45:16.383

创建表时指定区分大小写的排序规则：

```
CREATE TABLE assignment (
    ID int(11) NOT NULL AUTO_INCREMENT,
    CHARACTER_ASS varchar(45) NOT NULL,
    TYPE_ASS int(11) NOT NULL,
    PRIMARY KEY (ID)
) ENGINE=InnoDB AUTO_INCREMENT=17 DEFAULT CHARSET=utf8, COLLATE=latin1_general_cs 
```

请注意，默认排序规则也可以在数据库级别全局设置：http: [//dev.mysql.com/doc/refman/5.0/en/charset-database.html](http://dev.mysql.com/doc/refman/5.0/en/charset-database.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:30:08.767

该字段的字符集和排序规则是什么？

你能执行 SHOW CREATE TABLE 表名吗？

# ios - CoreData + iCloud + Cascade Delete - 如何处理？

> ID：10557986
> 
> 赞同：78
> 
> 时间：2012-05-11T20:11:29.303
> 
> 标签：ios, core-data, icloud, cascading-deletes

`CoreData`实体“A”与条目“B”的集合具有一对多关系`CoreData`，使用级联删除规则。

在一个`iCloud`环境中，当设备 1 显示“B”条目之一的详细视图时，设备 2 删除“A”条目。

当`NSPersistentStoreDidImportUbiquitousContentChangesNotification`设备 1 收到通知时，它的 App Delegate 调用`mergeChangesFromContextDidSaveNotification`然后广播一个内部通知，该通知由视图控制器捕获，显示条目“B”的详细信息（代码使用`performBlock`它应该使用的位置）。

然而，虽然在详细视图控制器收到内部通知时条目“A”确实无效，但条目“B”仍然作为有效`CoreData`对象存在。级联规则似乎还没有完成它的操作。因此设备 1 中的视图控制器不知道删除，这可能会导致意外结果。

`mergeChangesFromContextDidSaveNotification`当基础数据已合并但级联规则尚未完成时，似乎过早返回。

我尝试在通知到达时刷新条目“B”，同时`stalenessInterval`将托管对象上下文的临时设置为零，因此不会使用缓存的对象，但我仍然从商店获得有效的条目“B”。

此时检查`null`条目“A”不是一种选择，因为情况比我在此处描述的要复杂一些，并且在某些情况下空条目“A”可能是有效的。

我试图在合并更改之后和将内部通知发送到视图控制器之前引入延迟。我发现 2 秒延迟无济于事，但 10 秒延迟有效。

但我不想依赖这种延迟。这是一个没有太多数据的测试环境，不知道生产环境会发生什么。依赖实验性延迟似乎不是正确的做法。

有正确的事情吗？还是我一开始做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-23T06:06:21.960

根据经验，收听通知以外的通知`NSManagedObjectContextDidSaveNotification`是一件大事，并且可能导致依赖尚未更新的属性。详细视图控制器应该监听`NSManagedObjectContextDidSaveNotification`应用级联后抛出的通知。然后，您可以通过多种方式检查当前对象是否有效（您可以检查当前对象的托管对象上下文是否有效，`nil`或者您可以执行获取并查看该对象是否存在于存储中）。

# c - 我如何过滤字符串，以便只允许字母数字字符通过

> ID：10557987
> 
> 赞同：0
> 
> 时间：2012-05-11T20:11:50.693
> 
> 标签：c

我目前正在为服务器编写日志解析脚本，为了防止用户输入恶意命令，我需要从输入的字符串中过滤掉除字母数字字符（同时允许下划线）之外的所有字符，但不幸的是我不知道如何要做到这一点，所以我只是想知道是否有人可以告诉/告诉我要做什么才能实现这一目标，谢谢！还举个例子，假设有人输入以下内容：stack#@_over%flow，然后程序将过滤掉非字母数字字符（下划线除外），以便仅生成 stack_overflow，这在 bash 中相当于

```
tr -dc [:alnum:]'_' 
```

还忘了提到我已经尝试了以下方法，但仍然遇到一些问题（例如，如果字符串中包含“！”，我会得到“-bash：！”：未找到事件“

```
#include <stdio.h>
#include <string.h>
#include <ctype.h>
int main(int argc, char ** argv) {
    int i;
    char *p;
    if (argc > 1) {
        for (p = argv[1]; *p != '\0'; p++) {
           if (islower(*p) || isdigit(*p) || *p == '_') {
               putchar (*p);
           }
        }
        putchar ('\n');
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:14:42.700

查找您正在处理的字符串的长度，分配该长度的新字符串，遍历输入字符串的每个字符，如果它是字母数字（使用 ctype.h 中的 isalnum()）将字符放入结果字符串中，否则就跳过它。Null 终止并将结果字符串复制到输入字符串，释放分配的字符串并返回结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:16:14.010

正则表达式（regex）是一个很好的方法来做到这一点。这是[一个例子](http://www.lemoda.net/c/unix-regex/index.html)来说明这一点。

# c# - 使用 MVP 动态添加不同的视图

> ID：10557988
> 
> 赞同：0
> 
> 时间：2012-05-11T20:11:59.060
> 
> 标签：c#, model-view-controller, mvp, presenter

首先让我说这是我第一次尝试尝试 MVP。我将采用被动视图方法，因为我想将视图与模型完全分离。

我通过阅读以下文章了解了 MVP

德里克·格里尔
[http://aspiringcraftsman.com/2007/08/25/interactive-application-architecture/](http://aspiringcraftsman.com/2007/08/25/interactive-application-architecture/)

托德·斯奈德
[http://blogs.infragistics.com/blogs/todd_snyder/archive/2007/10/17/mvc-or-mvp-pattern-whats-the-difference.aspx](http://blogs.infragistics.com/blogs/todd_snyder/archive/2007/10/17/mvc-or-mvp-pattern-whats-the-difference.aspx)

我的应用程序将有 4 个视图，它们是自定义控件，每个视图都实现不同的界面来与 Presenter 交互。现在这对于 3 个视图来说不是问题，因为控件是静态的并且永远不会改变。

我的问题出现在第 4 个视图中，我需要更改基于从视图 1 触发的事件显示的控件/视图。

例如，假设 View 1 是一个可以来自员工或客户的人员列表。现在，根据所选人员的不同，您可以根据所选人员的类型修改不同的参数。问题是 View 4 需要根据所选内容动态更改编辑控件。请记住，不仅属性会有所不同，而且它们的编辑方式也会有所不同。此外，每个编辑控件都会为属性更改触发不同的事件。

那么我的 Presenter 是如何知道如何管理与模型的交互的，当取决于选择的是员工还是客户时，会有一个不同的编辑器实现不同的 View 界面？

我希望这很清楚。任何帮助是极大的赞赏。我进行了全面搜索，所有示例都显示了 View 和 Presenter 之间的具体关系，而我的示例需要非常灵活。

我的目标是保持第 4 个视图上的编辑控件非常灵活，例如，我可以为外星人或狗添加编辑控件/视图，或者我可以添加到 View1 中的任何其他内容以供选择。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T20:43:19.033

I personally don't like having a 'Master Presenter' per se. I do build composite presenters: e.g. View can contain one of several views, so I build a Presenter for the master view, which sends commands (messages, events, whatever) to a specific child presenter (I don't expose any View outside it's owning Presenter).

Don't over-complicate things ...use a different View for each responsibility. Views are cheap.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T20:30:46.783

您可以创建一个顶级演示者来侦听选择事件并通过根据所选内容实例化不同的 MVP 三元组来更改编辑控件。通常在 MVP 中，您的演示者管理所有的构造/依赖项。

# php - 下拉列表中的搜索结果

> ID：10557992
> 
> 赞同：0
> 
> 时间：2012-05-11T20:12:15.030
> 
> 标签：php, javascript, jquery

我正在处理带有搜索表单的向下滑动列表，但我不确定如何搜索数据库并在不重新加载页面且不关闭向下滑动 div 的情况下回显结果，我需要搜索结果滑动列表，类似于在 facebook 上搜索。我不知道从哪里开始以及如何开始。这就是我到目前为止所做的。有什么建议吗？

```
 <script>
        $(document).ready(function () {
          $('#nav li').hover(
              function () {
                  $('ul', this).stop(true, true).slideDown(200);
              },
              function () {
                  $('ul', this).stop(true, true).slideUp(200);
              });
      });
  </script>

        <div style='
        background-color:#D6DEE6;
        border-bottom:1px solid #6382A1;
        height:10px;
        width:100%;
        margin-top:-1px;
        -webkit-box-shadow: 5px 5px 15px #dddddd;
        box-shadow: 5px 5px 15px #dddddd;'>
        </div>

        <ul id='nav'>

        <li style='
        background-color:#D6DEE6;
        border-bottom:1px solid #6382A1;
        margin-top:-0.5px;
        width:268px;
        margin-left:0%;
        border-right:1px solid #6382A1;
        border-left:1px solid #6382A1;
        height:25px;
        -moz-border-radius:0px 0px 5px 0px;
        border-radius:0px 0px 5px 0px;
        -webkit-box-shadow: 5px 5px 15px #dddddd;
        box-shadow: 5px 5px 15px #dddddd;'>
        <div class='linko_slide'>
    <a href=''><font face='candara' size='4'>Search menu</font>

<img src='slike_izgled/slide_down.png' width='25' height='10'
style='margin-left:15px;'></a>
</div>
<ul style='background-color:#D6DEE6; border:1px solid #6382A1;
    padding:5px; width:350px; margin-top:0px; height:350;
    -webkit-box-shadow: 5px 5px 15px #dddddd;
    box-shadow: 5px 5px 15px #dddddd;
    -moz-border-radius:8px 8px 0px 0px;
    border-radius:0px 8px 8px 0px; 
    padding-bottom:0px; padding-right:10px;'>

<!--search in list start!-->
    <form>
    <input type='text' name='search_dosje'>
    <input type='submit' name='search_q' value='Pretraži'
    style='border:1px solid #8099B3;    background:url(slike_izgled/naslovi_table.png);                
height:24px;
-moz-border-radius:0px 5px 5px 0px; font-family:candara; font-size:15;
border-radius:0px 5px 5px 0px; padding-bottom:3; padding-left:3; padding-right:3;'>
                             </form>

    </div>
    <!--end of listing!-->
                                  </ul>
                              </li>
                             </ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:20:23.967

您需要将事件绑定到表单字段并执行 ajax 请求

```
$('form').submit(function() {
    $.post($(this).attr('action'), $(this).serialize(), function(data) {
        // replace the content section with your new data
    });
    return false;
}); 
```

# xml - 在 xpath 中需要帮助

> ID：10557994
> 
> 赞同：2
> 
> 时间：2012-05-11T20:12:18.830
> 
> 标签：xml, xpath

我有这个xml：

```
 <mappings>      
        <mapping>       
           <name iskey="true">234</name>     
           <aid iskey="true">bmz</aid>    
           <bid iskey="true">sim</bid>    
           <data>GSSS</data>     
        </mapping>     
        <mapping>     
          <aid iskey="true">bmz</aid>     
          <bid iskey="true">sim</bid>    
          <data>TS</data>    
        </mapping>    
        <mapping>    
          <aid iskey="true">bmz</aid>
          <account>TS</account>     
        </mapping> 
     </mappings> 
```

> 我需要 xpath 来选择具有节点`<aid iskey='true'>bmz</aid>`且没有其他节点包含 iskey 属性的节点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T20:22:33.677

在评论中反复几次之后，您似乎正在寻找具有具有特定属性和值的子节点但没有具有该属性的其他子节点的`mapping`节点（或任何其他节点）。你这样做：`aid``@iskey`

```
//*[aid/@iskey='true' and aid/text()='bmz'][not(*[@iskey][local-name() != 'aid'])] 
```

谓词确切地说：具有`aid`具有这些值的子节点并且没有具有其他名称的子节点，而不是`aid`碰巧具有`@iskey`属性。

当我运行这个简单的测试样式表时：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="/">
        <xsl:copy-of select="//*[aid/@iskey='true' and aid/text()='bmz'][not(*[@iskey][local-name() != 'aid'])]"/>
    </xsl:template> 
</xsl:stylesheet> 
```

在您的输入文档中，我得到以下回报：

```
<mapping>
    <aid iskey="true">bmz</aid>   <!-- I need this node -->
    <account>TS</account>
</mapping> 
```

**更新**如果您希望获得只有一个子节点的节点`@iskey`，您可以逃脱：

```
//*[count(*[@iskey]) = 1] 
```

我将它插入到我的测试样式表中，它产生了相同的预期结果：

```
<mapping>
    <aid iskey="true">bmz</aid>   <!-- I need this node -->
    <account>TS</account>
</mapping> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-12T03:55:40.057

**使用这个更短更简单的 XPath 表达式**：

```
 /*/*
     [aid[@iskey='true' and .='bmz']
    and
      not(*[not(self::aid)][@iskey])
      ] 
```

**说明**：

这是“**[双重否定原则](http://en.wikipedia.org/wiki/Double_negation)**”的一个简单而具体的案例：）

**基于 XSLT 的验证：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/">
  <xsl:copy-of select=
  "/*/*
     [aid[@iskey='true' and .='bmz']
    and
      not(*[not(self::aid)][@iskey])
      ]"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<mappings>
    <mapping>
        <name iskey="true">234</name>
        <aid iskey="true">bmz</aid>
        <bid iskey="true">sim</bid>
        <data>GSSS</data>
    </mapping>
    <mapping>
        <aid iskey="true">bmz</aid>
        <bid iskey="true">sim</bid>
        <data>TS</data>
    </mapping>
    <mapping>
        <aid iskey="true">bmz</aid>
        <account>TS</account>
    </mapping>
</mappings> 
```

**对 XPath 表达式求值，并将所选元素（本例中只有一个）复制到输出**：

```
<mapping>
   <aid iskey="true">bmz</aid>
   <account>TS</account>
</mapping> 
```