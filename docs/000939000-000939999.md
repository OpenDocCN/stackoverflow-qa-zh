# StackOverflow 问答 000939000-000939999

# asp.net-mvc - 在浏览器插件中打开pdf

> ID：939005
> 
> 赞同：5
> 
> 时间：2009-06-02T11:29:00.913
> 
> 标签：asp.net-mvc

我如何（在我的控制器中）发送在浏览器中打开的 pdf。我已经尝试过了，但它只下载文件（即和firefox）而不询问。

```
public ActionResult GetIt()
{
    var filename = @"C:\path\to\pdf\test.pdf";
    // Edit start
    ControllerContext.HttpContext.Response.AddHeader("Content-Disposition", String.Format("inline;filename=\"{0}\"", "test.pdf"));
    // Edit stop
    return File(filename, "application/pdf", Server.HtmlEncode(filename));
} 
```

添加上面的编辑后，它应该可以正常工作，谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T11:37:31.847

您需要将 Content disposition HTTP 标头设置为内联，以向浏览器指示它应该尝试使用 PDF 插件（如果可用）。

类似于：**Content-Disposition: inline; 文件名=test.pdf**

请注意，您不能强制使用插件，这是由浏览器做出的决定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T11:36:49.040

这（除了其他标头之外）在普通的 .net Web 应用程序中为我解决了问题：

Response.AddHeader("Content-Disposition", String.Format("inline;filename=""{0}""", FileName))

我不熟悉 MVC，但希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T11:31:24.090

我认为这取决于客户端如何处理 PDF 文件。如果它已设置为让 Adob​​e Reader 在浏览器插件中打开文件，它会这样做，但也许您已将其设置为下载文件而不是打开它。在任何情况下，都无法控制如何在用户机器上打开 PDF 文件。

# .net - 使用“System.Identity.Model.Claims”进行授权和认证

> ID：939008
> 
> 赞同：1
> 
> 时间：2009-06-02T11:29:55.357
> 
> 标签：.net, wcf, .net-3.5, claims-based-identity

我想向我的应用程序添加身份验证和授权。我不想为此使用 Active Directory。我应该`System.IdentityModel.Claims`用来做这个吗？使用`System.IdentityModel.Claims`会更容易实现身份验证和授权吗？为什么/为什么不呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T18:00:06.567

You might consider looking at the Microsoft Geneva framework for Claims-Based Authentication and authorization. [http://www.microsoft.com/geneva](http://www.microsoft.com/geneva)

Implementing Claims based security will definitely make things easier on you.

Claims-based security has the following advantages over role-based and access control lists (ACLs):

*   Single programming model, no matter the authentication scheme used
*   Claims flow across services in a SOA environment easier and in a more standards-compliant way
*   More flexible (you may see that a role is really just another type of claim)
*   No need to reauthenticate when crossing process boundaries

Hope this helps.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-12T05:13:25.637

那么你想用什么？数据库？您认为基于声明的身份验证会给您带来什么？

如果您想通过多个系统（例如中间层）将身份传递到兼容的后端，而不必弄乱模拟和委托，那么基于声明的身份验证会让生活变得更轻松。它也部分用于联合 - 允许其他人的系统执行身份验证和然后，您可以根据这些系统发送的身份信息授权对您的应用程序的访问。

但是，如果您只想避免使用 AD 而是使用来自数据库的用户名和密码，那么成员资格提供程序是一个更简单的选择，它可以为 WCF 和 ASP.NET 启用基于角色和用户的授权检查。

# c++builder - 带有新多核处理器的 Borland C++ 6？

> ID：939014
> 
> 赞同：0
> 
> 时间：2009-06-02T11:31:02.143
> 
> 标签：c++builder

我必须对用 Borland C++ 6 编写的应用程序进行一些改进。

我必须为这项任务购买新电脑。我已经知道 BCB 6 与旧的 Athlon 64 处理器有一些问题（编译时冻结）。

Howe BCB 6 适用于新的多核处理器？（英特尔酷睿 2 Quad Q6600 与华硕 P5QL PRO ）

这里有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T12:12:23.027

我在双核 Pentium 4 上使用 C++Builder 6 没有任何问题。

我在将 C++Builder 6 项目升级到 C++Builder 2007 时也遇到了一些小问题，所以这也可能是您的一个选择。（C++Builder 2009 要求更新任何 VCL 应用程序以使用 Unicode。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T00:59:36.493

我在双核奔腾上使用 BCB 6。我遇到的唯一问题是有时编译器会在一段时间内将 CPU 使用率固定为 100%（每个内核 50%）。

# javascript - jQuery将更多参数传递给回调

> ID：939032
> 
> 赞同：262
> 
> 时间：2009-06-02T11:35:26.050
> 
> 标签：javascript, jquery, function, callback, arguments

有没有办法将更多数据传递给jQuery中的回调函数？

我有两个函数，我希望回调`$.post`，例如，传递 AJAX 调用的结果数据以及一些自定义参数

```
function clicked() {
    var myDiv = $("#my-div");
    // ERROR: Says data not defined
    $.post("someurl.php",someData,doSomething(data, myDiv),"json"); 
    // ERROR: Would pass in myDiv as curData (wrong)
    $.post("someurl.php",someData,doSomething(data, myDiv),"json"); 
}

function doSomething(curData, curDiv) {

} 
```

我希望能够将我自己的参数以及从 AJAX 调用返回的结果传递给回调。

* * *

## 回答 #1

> 赞同：347
> 
> 时间：2009-06-02T12:18:18.210

解决方案是通过闭包来绑定变量。

* * *

作为一个更基本的示例，这里是一个接收和调用回调函数的示例函数，以及一个示例回调函数：

```
function callbackReceiver(callback) {
    callback("Hello World");
}

function callback(value1, value2) {
    console.log(value1, value2);
} 
```

这将调用回调并提供单个参数。现在你想提供一个额外的参数，所以你将回调包装在闭包中。

```
callbackReceiver(callback);     // "Hello World", undefined
callbackReceiver(function(value) {
    callback(value, "Foo Bar"); // "Hello World", "Foo Bar"
}); 
```

或者，更简单地使用[ES6 箭头函数](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/Arrow_functions)：

```
callbackReceiver(value => callback(value, "Foo Bar")); // "Hello World", "Foo Bar" 
```

* * *

至于您的具体示例，我没有`.post`在 jQuery 中使用该函数，但快速浏览文档表明回调应该是具有以下签名的*函数指针：*

```
function callBack(data, textStatus, jqXHR) {}; 
```

因此我认为解决方案如下：

```
var doSomething = function(extraStuff) {
    return function(data, textStatus, jqXHR) {
        // do something with extraStuff
    };
};

var clicked = function() {
    var extraStuff = {
        myParam1: 'foo',
        myParam2: 'bar'
    }; // an object / whatever extra params you wish to pass.

    $.post("someurl.php", someData, doSomething(extraStuff), "json");
}; 
```

怎么了？

在最后一行，`doSomething(extraStuff)`被*调用*，调用的结果是一个*函数指针*。

因为`extraStuff`作为参数传递给`doSomething`它是在函数的范围内`doSomething`。

当`extraStuff`在返回的匿名内部函数中被引用时，`doSomething`它被闭包绑定到外部函数的`extraStuff`参数。即使在`doSomething`返回之后也是如此。

我没有测试过上述内容，但我在过去 24 小时内编写了非常相似的代码，并且它的工作原理与我所描述的一样。

您当然可以根据您的个人偏好/编码标准传递多个变量而不是单个“extraStuff”对象。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-06-02T12:05:16.003

使用时`doSomething(data, myDiv)`，您实际上调用了该函数并且不对其进行引用。

您可以直接传递该`doStomething`函数，但必须确保它具有正确的签名。

如果你想保持 doSomething 的原样，你可以将它的调用包装在一个匿名函数中。

```
function clicked() {
    var myDiv = $("#my-div");
    $.post("someurl.php",someData, function(data){ 
      doSomething(data, myDiv)
    },"json"); 
}

function doSomething(curData, curDiv) {
    ...
} 
```

在匿名函数代码中，您可以使用封闭范围内定义的变量。这就是 Javascript 作用域的工作方式。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2012-03-08T20:36:53.527

它实际上比每个人都更容易听起来......特别是如果您使用`$.ajax({})`基本语法与辅助函数之一。

`key: value`当您设置 ajax 请求时，只需像在任何对象上一样传递这对... *（因为`$(this)`尚未更改上下文，它仍然是上面绑定调用的触发器）*

```
<script type="text/javascript">
$(".qty input").bind("keypress change", function() {
    $.ajax({
        url: "/order_items/change/"+$(this).attr("data-order-item-id")+"/qty:"+$(this).val()+"/returnas.json",
        type: "POST",
        dataType: "json",
        qty_input: $(this),
        anything_else_i_want_to_pass_in: "foo",
        success: function(json_data, textStatus, jqXHR) {
            /* here is the input, which triggered this AJAX request */
            console.log(this.qty_input);
            /* here is any other parameter you set when initializing the ajax method */
            console.log(this.anything_else_i_want_to_pass_in);
        }
    });
});
</script> 
```

这比设置 var 更好的原因之一是 var 是全局的，因此是可覆盖的......如果你有 2 个可以触发 ajax 调用的东西，理论上你可以比 ajax 调用响应更快地触发它们，并且您会将第二个调用的值传递给第一个调用。使用上面的这种方法，这不会发生（而且使用起来也很简单）。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2011-09-08T15:48:43.970

在当今世界，还有一个更简洁的答案，取自另一个 Stack Overflow 答案：

```
function clicked()
{
    var myDiv = $( "#my-div" );

    $.post( "someurl.php", {"someData": someData}, $.proxy(doSomething, myDiv), "json" );
}

function doSomething( data )
{
    // this will be equal to myDiv now. Thanks to jQuery.proxy().
    var $myDiv = this;

    // doing stuff.
    ...
} 
```

这是最初的问题和答案： [jQuery HOW TO?? 将附加参数传递给 $.ajax 调用的成功回调？](https://stackoverflow.com/questions/2602981/jquery-how-to-pass-additional-parameters-to-success-callback-for-ajax-call)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-06-02T12:04:04.837

您还可以尝试以下方法：

```
function clicked() {

    var myDiv = $("#my-div");

    $.post("someurl.php",someData,function(data){
        doSomething(data, myDiv);
    },"json"); 
}

function doSomething(curData, curDiv) {

} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-02T12:13:15.020

您可以使用 JavaScript 的闭包：

```
function wrapper( var1, var2,....) // put here your variables
{
  return function( data, status)
  {
     //Handle here results of call
  }
}; 
```

什么时候可以：

```
$.post("someurl.php",data,wrapper(var1, var2, etc...),"html"); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-09-03T15:25:59.927

我在上一个帖子中犯了一个错误。这是如何在回调函数中传递附加参数的工作示例：

```
function custom_func(p1,p2) {
    $.post(AJAX_FILE_PATH,{op:'dosomething',p1:p1},
        function(data){
            return function(){
                alert(data);
                alert(p2);
            }(data,p2)
        }
    );
    return false;
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-04-09T11:31:37.233

让我们变得简单！:)

```
$.ajax({
    url: myUrl,
    context: $this, // $this == Current $element
    success: function(data) {
        $.proxy(publicMethods.update, this)(data); // this == Current $element
    }
}); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-09-02T10:26:48.910

使用[`.ajax()`](http://api.jquery.com/jQuery.ajax/)jQuery API 和闭包发送异步请求以将附加参数传递给回调函数的更通用解决方案：

```
function sendRequest(method, url, content, callback) {
    // additional data for the callback
    var request = {
        method: method,
        url: url
    };

    $.ajax({
        type: method,
        url: url,
        data: content
     }).done(function(data, status, xhr) {
        if (callback) callback(xhr.status, data, request);
     }).fail(function(xhr, status) {
        if (callback) callback(xhr.status, xhr.response, request);
     });
}; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-05-22T04:14:22.983

对于我和其他刚刚接触 Javascript 的新手来说，
我认为这`Closeure Solution`有点太令人困惑了。

虽然我发现，您可以使用 jquery 轻松地将任意数量的参数传递给每个 ajax 回调。

这里有**两个更简单的解决方案**。

第一个，**@zeroasterisk**上面提到的，例如：

```
var $items = $('.some_class');
$.each($items, function(key, item){
    var url = 'http://request_with_params' + $(item).html();
    $.ajax({
        selfDom     : $(item),
        selfData    : 'here is my self defined data',

        url         : url,
        dataType    : 'json',
        success     : function(data, code, jqXHR){
            // in $.ajax callbacks, 
            // [this] keyword references to the options you gived to $.ajax
            // if you had not specified the context of $.ajax callbacks.
            // see http://api.jquery.com/jquery.ajax/#jQuery-ajax-settings context
            var $item = this.selfDom;
            var selfdata = this.selfData;
            $item.html( selfdata );
            ...
        } 
    });
}); 
```

第二个，通过将自定义数据添加到`XHR object` 整个 ajax-request-response 生命周期中存在的数据中来传递自定义数据。

```
var $items = $('.some_class');
$.each($items, function(key, item){
    var url = 'http://request_with_params' + $(item).html();
    $.ajax({
        url         : url,
        dataType    : 'json',
        beforeSend  : function(XHR) {
            // 为了便于回调，把当前的 jquery对象集存入本次 XHR
            XHR.selfDom = $(item);
            XHR.selfData = 'here is my self defined data';
        },
        success     : function(data, code, jqXHR){
            // jqXHR is a superset of the browser's native XHR object
            var $item = jqXHR.selfDom;
            var selfdata = jqXHR.selfData;
            $item.html( selfdata );
            ...
        } 
    });
}); 
```

正如您所看到的，这两种解决方案都有一个缺点：您每次都需要编写更多代码，而不仅仅是编写：

```
$.get/post (url, data, successHandler); 
```

阅读有关 $.ajax 的更多信息：http: [//api.jquery.com/jquery.ajax/](http://api.jquery.com/jquery.ajax/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-04-29T06:39:13.680

```
$(document).on('click','[action=register]',function(){
    registerSocket(registerJSON(),registerDone,second($(this)));
});

function registerSocket(dataFn,doneFn,second){
                 $.ajax({
                       type:'POST',
                       url: "http://localhost:8080/store/public/register",
                       contentType: "application/json; charset=utf-8",
                       dataType: "json",
                       data:dataFn
                 }).done ([doneFn,second])
                   .fail(function(err){
                            console.log("AJAX failed: " + JSON.stringify(err, null, 2));
                        });
}

function registerDone(data){
    console.log(JSON.stringify(data));
}
function second(element){
    console.log(element);
} 
```

次要方式：

```
function socketWithParam(url,dataFn,doneFn,param){
  $.ajax({
    type:'POST',
    url:url,
    contentType: "application/json; charset=utf-8",
    headers: { 'Authorization': 'Bearer '+localStorage.getItem('jwt')},
    data:dataFn
    }).done(function(data){
      doneFn(data,param);
    })
    .fail(function(err,status,xhr){
    console.log("AJAX failed: " + JSON.stringify(err, null, 2));
    });
}

$(document).on('click','[order-btn]',function(){
  socketWithParam(url,fakeDataFn(),orderDetailDone,secondParam);
});

function orderDetailDone(data,param){
  -- to do something --
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-10-15T08:46:20.400

如果有人仍然来这里，这是我的看法：

```
$('.selector').click(myCallbackFunction.bind({var1: 'hello', var2: 'world'}));

function myCallbackFunction(event) {
    var passedArg1 = this.var1,
        passedArg2 = this.var2
} 
```

这里发生了什么，在绑定到回调函数后，它将在函数中作为`this`.

这个想法来自 React 如何使用该`bind`功能。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-02T11:53:15.950

实际上，您的代码不起作用，因为当您编写时：

```
$.post("someurl.php",someData,doSomething(data, myDiv),"json"); 
```

您将*函数调用*作为第三个参数而不是*函数引用*。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-10-08T18:06:35.550

作为[b01 答案](https://stackoverflow.com/questions/939032/jquery-pass-more-parameters-into-callback/7350886#7350886)的附录，第二个参数 of`$.proxy`通常用于保留`this`引用。传递给的附加参数`$.proxy`部分地应用于函数，用数据预先填充它。请注意，`$.post`传递给回调的任何参数都将在最后应用，因此`doSomething`应该在其参数列表的末尾应用：

```
function clicked() {
    var myDiv = $("#my-div");
    var callback = $.proxy(doSomething, this, myDiv);
    $.post("someurl.php",someData,callback,"json"); 
}

function doSomething(curDiv, curData) {
    //"this" still refers to the same "this" as clicked()
    var serverResponse = curData;
} 
```

这种方法还允许将多个参数绑定到回调：

```
function clicked() {
    var myDiv = $("#my-div");
    var mySpan = $("#my-span");
    var isActive = true;
    var callback = $.proxy(doSomething, this, myDiv, mySpan, isActive);
    $.post("someurl.php",someData,callback,"json"); 
}

function doSomething(curDiv, curSpan, curIsActive, curData) {
    //"this" still refers to the same "this" as clicked()
    var serverResponse = curData;
} 
```

# windows - 如何将 EC2 Windows 机器的实例 ID 获取到批处理变量中

> ID：939033
> 
> 赞同：0
> 
> 时间：2009-06-02T11:35:41.743
> 
> 标签：windows, batch-file, amazon-ec2

我有一个希望在 EC2 Windows AMI 启动时运行的批处理文件。我想从该批处理文件运行的程序将 EC2 机器的实例 ID 作为参数。将实例 ID 作为参数传递给该程序的最简单方法是什么？

从[亚马逊关于该主题的文档中](http://docs.amazonwebservices.com/AWSEC2/2008-08-08/DeveloperGuide/index.html?AESDG-chapter-instancedata.html)，我看到您应该向指定的 URL 发出 WGET 并解析响应。因此，表达这个问题的另一种方式可能是“如何将 HTTP 请求的内容作为 Windows 批处理文件中的参数传递给程序”

在伪代码中，这是我想做的：

```
set ID = GET http://169.254.169.254/2008-08-08/meta-data/instance-id
myprogram.exe /instanceID=%ID% 
```

关于我如何进行的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T18:28:59.470

您不能直接在批处理文件中打开 URL。您当然可以使用 wget 或类似方法来检索该 URL 的内容。然后你要么得到一个文件（它的内容你可以分配给一个环境变量[参见例如[Set=log.txt in batch](https://stackoverflow.com/questions/932552/set-log-txt-in-batch) ]）或者你会从程序中得到输出，在这种情况下你可以把它包装成

```
for /f "usebackq delims=" %%x in (`print_contents_of_url http://169.254.169.254/2008-08-08/meta-data/instance-id`) do set ID=%%x 
```

这将设置`%ID%`为该 URL 处的服务器响应 [假设程序执行我命名的操作]）。

不过，在这两种情况下，您都需要一个单独的程序来使用 HTTP。

# django - django - 切片后重新排序查询集

> ID：939035
> 
> 赞同：7
> 
> 时间：2009-06-02T11:35:49.183
> 
> 标签：django, django-queryset, django-orm

我从按日期时间字段排序的 Foo 模型中获取最新的 5 行。

```
qs = Foo.objects.all()[:5] 
```

在接下来的步骤中，我想按其他一些条件（实际上，按相反方向的相同日期时间字段）对查询集重新排序。但是不允许在切片后重新排序。reverse() 撤消第一个排序，给我一个不同的查询集。有没有办法在不从查询集中创建列表并使用它进行排序的情况下完成我想要的事情？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-02T12:00:20.053

order_by 为您提供 SQL 数据库内排序。您已经在使用它，然后对其进行切片。此时，结果将被检索到内存中。如果要更改它们的顺序，则需要使用 Python 内存中排序来执行此操作，而不是 ORM 数据库中排序。

在你的情况下，丹尼尔已经给出了最好的解决方案：因为你只是想按相同的字段排序，但是以其他顺序，只需反转你拥有的列表：

```
qs = Foo.objects.all()[:5]
objs = reversed(qs) 
```

如果您想按其他字段排序，那么您可以使用 sorted() 函数和自定义键函数：

```
qs = Foo.objects.all()[:5]
objs = sorted(qs, key=lambda o: o.some_other_field) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-02T11:48:09.283

不，没有办法做到这一点。`order_by`是对数据库的操作，但是当您对查询集进行切片时，它会被评估并且之后不会返回到数据库。

不过，听起来您已经知道解决方案：`reversed()`在评估的 qs 上运行。

```
qs = reversed(Foo.objects.all()[:5]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T22:02:04.557

迟到的答案，但这对我有用：

```
import random
sorted(queryset[:10], key=lambda x: random.random()) 
```

# jquery - 在谷歌地图中使用 jquery 选择器不起作用

> ID：939036
> 
> 赞同：0
> 
> 时间：2009-06-02T11:36:05.423
> 
> 标签：jquery, google-maps

我正在使用 jquery 和 googlemaps (gmap2)。我发现在地图上将 jquery 选择器用于类 div 的问题。当我尝试选择 div（ID 和类）时，我得到一个空返回。我猜这与 JS 谷歌地图存在某种冲突。为了验证我的 jquery 是否正确，我尝试选择有效的标签和不同的 id/类。

任何人都可以建议是什么原因或解决方法？

我正在使用 jq 1.3.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T11:40:04.090

我已经将 jquery 与谷歌地图混合使用，没有任何问题。你能发布一些代码吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-18T11:37:06.467

Google 地图不喜欢 jquery 选择器引擎返回的对象数组。同样 jquery 似乎不喜欢 document.getElementById 的原始输出，所以你需要做..

```
var el = document.getElementById("your-element");
var jQel = $(el); 
```

..然后您可以将 el 传递给 google maps API 并将 jQel 传递给 jQuery。虽然很明显，如果你可以完全避免使用 jQuery，你的代码会更有效率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-07T14:45:11.627

原来有人将 $ 重新定义为另一个函数并使用了 noconflict

# c# - C# AES 算法何时会符合 FIPS？

> ID：939040
> 
> 赞同：20
> 
> 时间：2009-06-02T11:37:06.263
> 
> 标签：c#, security, rijndaelmanaged, rijndael, fips

现在，我可以让[RijndaelManaged](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged.aspx)算法在打开 FIPS 的本地安全设置的计算机上运行的唯一方法是[禁用它](http://blog.aggregatedintelligence.com/2007/10/fips-validated-cryptographic-algorithms.html)。这是一台政府计算机，所以我不确定它会如何运行。我在[msdn 博客网站](http://blogs.msdn.com/shawnfa/archive/2006/10/09/The-Differences-Between-Rijndael-and-AES.aspx)上看到帖子说他们正在开发符合 AES FIPS 的版本，但我似乎无法找到更多信息。有谁知道这什么时候会发生？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-02T11:53:46.167

在这个问题之前我从未意识到这一点，但你是对的。构造函数有这个：

```
public RijndaelManaged()
{
    if (Utils.FipsAlgorithmPolicy == 1)
    {
        throw new InvalidOperationException(Environment.GetResourceString("Cryptography_NonCompliantFIPSAlgorithm"));
    }
} 
```

[System.Security.Cryptography.AesManaged](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aesmanaged.aspx)有类似的东西：

```
public AesManaged()
{
    if (CoreCryptoConfig.EnforceFipsAlgorithms)
    {
        throw new InvalidOperationException(SR.GetString("Cryptography_NonCompliantFIPSAlgorithm"));
    }
    this.m_rijndael = new RijndaelManaged();
    this.m_rijndael.BlockSize = this.BlockSize;
    this.m_rijndael.KeySize = this.KeySize;
} 
```

您是否尝试过[System.Security.Cryptography.AesCryptoServiceProvider](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aescryptoserviceprovider.aspx)？它应该可以工作，因为它使用Windows 内置的基于[CAPI的 FIPS AES 实现。](http://en.wikipedia.org/wiki/Cryptographic_API)

Microsoft 的 .NET 基类库论坛上的[这个问题讨论了哪些算法符合 FIPS 并具有良好的链接。](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/e0b4493f-6e20-4b75-a118-6b6e5d26a2a6)

微软似乎[一直在努力遵守](http://support.microsoft.com/kb/811833)pre-Vista 机器上的 HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa\FIPSAlgorithmPolicy 的设置，并为 post-Vista 使用[BCryptGetFipsAlgorithmMode](http://msdn.microsoft.com/en-us/library/aa375460(VS.85).aspx) API。

我认为在将实现认证为符合 FIPS 时需要付出不小的努力，这就是为什么 Microsoft 可能不想重复该过程而只为绝对需要此要求的客户提供 AesCryptoServiceProvider。

[这篇 MSDN 博客文章](http://blogs.msdn.com/shawnfa/archive/2005/05/16/417975.aspx)有一条评论，使其更加清晰：

> 确定算法是否兼容的简单方法是查看后缀。*托管类型均未通过 FIPS 认证。但是，*CryptoServiceProvider 和 *Cng 类型很可能已通过 FIPS 认证。如果他们实现了 FIPS 允许的算法，并且使用默认的 Microsoft 提供程序，那么他们将是。
> 
> 例如，SHA256Managed 不是（因为它是 *​​Managed）。SHA256CryptoServiceProvider 和 SHA256Cng 是。
> MD5CryptoServiceProvider 不是（因为 MD5 不是 FIPS 算法）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-04-12T01:18:55.337

这个问题比大多数响应者理解的要复杂得多。这是大多数人的答案不起作用的真正原因（我刚刚花了近 48 小时的马拉松式会议试图理解和解决这个问题）：

1.  Windows 下的 C# 基本上有 3 个“支持”AES 的加密提供程序：RijndaelManaged、AesManaged、AesCryptoServiceProvider。
2.  RijndaelManaged 实现了完整的 Rijnadael 算法（所有选项），因此它是 AES 功能的超集；但是，它没有经过 FIPS 认证（因为它能够做 FIPS 批准的 AES 规范中没有的事情，例如块大小不是 128 位）
3.  AesManaged 只不过是 RijndaelManaged 上的装饰器/包装器，将其限制为 128 位的块大小，但是，由于 RijndaelManaged 未经 FIPS 批准，AesManaged 也不是
4.  AesCryptoServiceProvider 是 Windows 上 C 库的 C# 包装器，用于 AES，已获得 FIPS 批准；但是，在 CFB 模式下，它仅支持 8|16|24|32|40|48|56|64 位的 FeedbackSize（我找不到任何说明 FIPS 受到限制的文档，因此，AesCryptoServiceProvider 如何通过FIPS 认证 - 可能有人与其他人一起打了午夜高尔夫球以使其通过认证）
5.  如果在 Windows 上打开了 FIPS 模式，则当您尝试实例化它们时，RijndaelManaged（以及 AesManaged）将抛出异常并指出它们不符合 FIPS。
6.  有些事情需要 AES-128 和 128 位反馈大小的 CFB（例如，根据 RFC 的 SNMPv3 AES）。

因此，如果您处于满足以下条件的环境中：

1.  您需要 AES-128 和 CFB-128（例如 SNMPv3）
2.  您需要在不使用非 Microsoft Libs 的情况下从 C# 进行加密
3.  您需要在操作系统上打开 FIPS 模式（例如政府要求）

然后，您唯一的选择（或者至少是我在大量搜索和大量哭泣和咬牙切齿之后能找到的唯一选择）是使用 RijndaelManaged 并使用`<configuration> <runtime> <enforceFIPSPolicy enabled="false"/> <runtime> </configuration>`Application.exe.config 中的“”来关闭 FIPS 强制合规性特定的应用。

什么样的恶梦！我希望这个答案能帮助下一个不幸的灵魂遇到这个问题。

关键字： Cisco IOS SNMPv3 FIPS AES 128 CFB 128 AesCryptoServiceProvider Rijndael

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T12:05:01.747

如果操作系统本身在调用操作系统时经过认证，则非托管 AesCryptoServiceProvider 也经过认证。而且它也将成为一个更快的站点，但代价是跨平台兼容性。

# asp.net - 带有javascript页面刷新的asp.net

> ID：939041
> 
> 赞同：0
> 
> 时间：2009-06-02T11:37:06.763
> 
> 标签：asp.net, ajax

我有一个由三个页面组成的 ASP.Net 应用程序；page1、page2 和 page3 从第一页开始执行。Page1 调用 Page2，但 page1 必须仍然可见，因此用户仍然可以在该页面上工作。当 Page2 关闭时，一个 java 脚本函数调用 Page3，所以所有的清理工作都在第 3 页上完成。当第 3 页完成任务时，窗口消失，只显示 Page1 从第 2 页调用 page3 我使用这样的东西；

```
xHRObject.open("GET", "Default3.aspx?SiEditor=E&idSec=N&F="+idenValue, false); 
```

问题如下：第 2 页更新的信息必须在第 1 页更新，但事实并非如此。如果我在 page3 上放置类似的 java 脚本来调用 page1，它会实例化一个新页面，而不是刷新当前页面。如何访问 page1？如果我们对 page2 使用模态形式，控件会毫无问题地返回到 page1，但在这种情况下我不能使用模态

知道如何在处理 page2 和 3 时刷新 page1 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T19:24:58.283

创建新窗口时，您可以通过[opener](http://w3schools.com/htmldom/prop_win_opener.asp)属性访问打开它们的窗口。然后，您可以使用位置对象重新加载页面。

所以这可能是您第 2 页上的正文标记：

```
<body onunload="window.opener.location.reload([true])"> 
```

# java - 球衣与弹簧的融合

> ID：939042
> 
> 赞同：3
> 
> 时间：2009-06-02T11:37:25.077
> 
> 标签：java, spring, jersey

我想将 Jersey 1.1 与 spring 2.5 一起使用。我需要做的确切的事情是编写一个接口，该接口将作为服务和实现在扩展接口的类中公开。

我无法在 applicationContext.xml 中执行此操作，可能是因为 XSD 已更改。

有人可以提供一个示例代码/片段/文件，他们已经能够成功地实现这一点。

提前致谢， 阿迪尔·艾玛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T12:15:20.243

终于明白了.. 新模式确实支持基本 bean 定义，因此可以使用旧技术指定接口和实现类

```
<bean id="myService" class="org.springframework.aop.framework.ProxyFactoryBean">
<property name="proxyInterfaces">
    <value>com.poc.service.MyServiceInterface</value>
</property>
<property name="target" ref="myServiceimpl" /> 
```

# jquery - jQuery 可以在经典的 ASP 应用程序中使用吗？

> ID：939046
> 
> 赞同：3
> 
> 时间：2009-06-02T11:37:42.720
> 
> 标签：jquery, asp-classic

我们有一个大型的经典 ASP 应用程序，我们正在将其重写为 ASP.NET。我们要到明年年底才能完成重写、测试等工作。与此同时，我们面临着美化经典 ASP 应用程序界面的巨大压力。

可以将 jQuery 与经典 ASP 一起使用吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T11:40:40.017

jQuery 是一个 javascript 框架，绝不应该干扰您的经典 ASP。

jQuery 可以在客户端使用，但只能使用它可用/可以请求的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T16:32:10.757

我在服务器端和客户端都使用 Mootools，JScript ASP 非常棒！:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T11:41:25.477

是的。ASP 只是对 HTML 进行预处理并输出，可以通过 javascript 进行操作。（或 jQuery）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T11:41:49.467

我不明白为什么不，jQuery 是一个建立在 JavaScript 之上的客户端库，你打算用 jQuery 做什么？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T11:41:50.623

jQuery 可以在任何 Web 应用程序中使用。同样在您的静态 HTML 页面中。

它基本上是一个客户端 javascript 框架，可帮助您操作 DOM 和许多其他功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-10T19:24:10.917

我不敢相信有人问了这个问题:) ...恕我直言。

请记住，PHP、ASP、ASP.NET、ASP.NET MVC、CGI.... 最后，它们将 HTML 代码呈现回客户端，即浏览器。这必须“阅读”这段代码并神奇地将其显示在屏幕上。

Javascript 是一种“浏览器端”又名客户端语言，用于操作“浏览器端”对象 (DOM)。Javascript 一直是大多数 Web 开发人员的噩梦，因为浏览器不会以相同的方式“读取”它。感谢上帝，Netscape 几乎永远消失了，因为它是最糟糕的处理方式之一。

jQuery ...您可能已经阅读过，它只不过是一组很好地组合在一起的 javascript 类（库）...

尽管 jquery 有自己的语法，恕我直言，您应该学习 javascript，或者至少是基础知识，以便了解 jquery 如何为游戏带来这种魔力。

jquery.com 的教程。

祝你好运

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T11:45:12.427

经典的 ASP 和 ASP.Net 都是服务器端技术，它们将 HTML 等输出到客户端浏览器。

JavaScript 是一种客户端技术，而 JQuery 是用 JavaScript 编写的框架，因此可以在任何网页上运行（只要浏览器支持它）。

因此答案肯定是肯定的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T11:46:50.487

我在一个经典的 ASP 网站中使用 JQuery。

它工作得很好。在需要的地方，我可以将一些 ASP 内容放入 javascript 块中以使用数据库中的内容：

```
function myjavascripfunction(){
  $("#pageTitle").html(<%= rs("Title")%>);
} 
```

如果您不熟悉经典 ASP 并且不想在上面浪费太多时间，那么将 JQuery 与 ASP 结合使用会非常棒。

PS：有一个 ASP-to-JSON 库允许您将 DB 查询转换为 JSON 对象。非常适合制作在 .asp 页面上执行 ajax 调用的 .html 页面，他们唯一的工作就是从数据库中检索一些东西。

这样，您就有了一个可重复使用的 .html 页面，当您切换到另一种服务器端语言时，您只需复制粘贴即可。您需要做的就是制作一些也返回 JSON 的 .php 或 .aspx 页面并调用它们而不是 .asp 页面。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-02T11:48:56.677

jQuery 不依赖于服务器（ASP.NET），它是客户端的。您可以在您喜欢的服务器上使用任何技术，并且仍然使用 jQuery。

# jquery - jQuery同步动画？

> ID：939049
> 
> 赞同：2
> 
> 时间：2009-06-02T11:38:38.023
> 
> 标签：jquery, jquery-ui, animation

我有一个 jquery 动画 .. 实际上它的 2 .. 淡入淡出然后移动动画..

问题是它首先完全淡入然后动画（移动位置）......

我想做的是开始淡入淡出，不要等待它完成（目前似乎正在发生）..并开始动画..

因此两者同时发生..目前..第一个似乎正在运行并等待......然后动画（更改位置）运行..

任何想法如何同时运行两者......

```
$('#Test').fadeIn("6000");
$('#Test').animate({ 'top': "-=100px" },"6000"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T11:46:32.767

这个怎么样？

```
$('#Test').animate({'top' : '-=100px', 'opacity' : '100'}, '6000'); 
```

在这种情况下，您必须确保元素可见，因为 fadeIn() 还设置了“显示”属性。

# sql - SQL 查询帮助

> ID：939055
> 
> 赞同：-1
> 
> 时间：2009-06-02T11:40:10.080
> 
> 标签：sql, sql-server-2000

我正在使用 SQL SERVER - 2000

表结构

```
CARDEVENTDATE       CARDEVENTTIME   CARDNO
20090224            92007           485
20090224            92345           321
20090225            163932          168
20090225            164630          471
20090225            165027          488
20090225            165137          247
20090225            165147          519
20090225            165715          518
20090225            165749          331
20090303            162059          240
20090303            162723          518
20090303            155029          386
20090303            155707          441
20090303    162824  331 
```

`Cardeventdate`和`Cardeventtime`- nvarchar 数据类型日期和时间是单独的列

我想在

昨天 03:00:01 AM 到今天 03:00:00 AM 前天 03:00:01 AM 到昨天 03:00:00 AM 等等……..

我尝试了下面提到的查询

```
Select Cardno, cardeventdate, min(cardeventtime), max(cardeventtime) 
from table 
where cardeventtime between 030001 to 030000

Select Cardno, Cardeventdate, Min(cardeventtime), max(cardeventtime) 
from table 
where Cardeventtime >030001 and  Cardeventtime < 030000 
```

结果中没有显示任何内容，因为今天从 03.00 am 到 03.01am 需要时间

```
Select Cardno, Cardeventdate, min (cardeventtime), max (cardeventtime) 
from table 
where cardeventtime < 030000 and cardeventtime > previous day time – query help 
```

正是我需要昨天 03.00.01 am 到今天 03.00.00 am 的数据，前天 03.00.01 am 到昨天 03.00.00 am 的数据……………………。很快

我需要上述条件的 sql 查询。谁能帮我？

（编辑：我需要从昨天早上到今天早上的日期，直到凌晨 3 点）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:23:10.707

下面是 SQL Server 2005 Express 上的 testet。如果 SQL Server 2000 没有公用表表达式 (CTE)，则可以使用视图来生成与“cteTbl”相同的视图。我确实希望 SQL Server 2000 支持 CASE-WHEN-END。

我在此使用的想法是将一天的工作时间从 24 小时延长到 27 小时（+3），但只有在 [CardEventTime] 小于或等于 03:00:00（24 小时）的情况下，我才添加 24 小时和 [ CardEventDate] 减去 1d。

```
CREATE TABLE tbl (
  CardEventDate INTEGER
  ,CardEventTime INTEGER
  ,CardNo INTEGER
)

INSERT INTO tbl VALUES (20090224,92007,485)
INSERT INTO tbl VALUES (20090224,92345,321)
INSERT INTO tbl VALUES (20090225,163932,168)
INSERT INTO tbl VALUES (20090225,164630,471)
INSERT INTO tbl VALUES (20090225,165027,488)
INSERT INTO tbl VALUES (20090225,165137,247)
INSERT INTO tbl VALUES (20090225,165147,519)
INSERT INTO tbl VALUES (20090225,165715,518)
INSERT INTO tbl VALUES (20090225,165749,331)
INSERT INTO tbl VALUES (20090303,162059,240)
INSERT INTO tbl VALUES (20090303,162723,518)
INSERT INTO tbl VALUES (20090303,155029,386)
INSERT INTO tbl VALUES (20090303,155707,441)
INSERT INTO tbl VALUES (20090303,162824,331)

-- Some boundary test values, for only one cardno.
INSERT INTO tbl VALUES (20090330,235959,331)
INSERT INTO tbl VALUES (20090331,000000,331)
INSERT INTO tbl VALUES (20090331,025959,331)
INSERT INTO tbl VALUES (20090331,030000,331)
INSERT INTO tbl VALUES (20090331,030001,331)
INSERT INTO tbl VALUES (20090331,235959,331)
INSERT INTO tbl VALUES (20090401,000000,331)
INSERT INTO tbl VALUES (20090401,025959,331)
INSERT INTO tbl VALUES (20090401,030000,331)
INSERT INTO tbl VALUES (20090401,030001,331)
go

WITH 
cteTbl AS (
  SELECT
    CardEventDate,
    CardEventTime,
    CardNo,
    CASE 
      WHEN CardEventTime <= 30000 THEN dateadd(dd, -1, cast(CardEventDate AS VARCHAR))
      WHEN CardEventTime > 30000 THEN cast(cast(CardEventDate AS VARCHAR) AS DATETIME)
    END AS ShiftedCardEventDate,
    CASE 
      WHEN CardEventTime <= 30000 THEN CardEventTime+240000
      WHEN CardEventTime > 30000 THEN CardEventTime
    END AS ShiftedCardEventTime
  FROM tbl
)
SELECT
  CardNo, 
  ShiftedCardEventDate,
  --min(shiftedCardEventTime) as [MinCardEventTime], 
  --max(shiftedCardEventTime) as [MaxCardEventTime],
  right('000000'+cast((min(shiftedCardEventTime) % 240000) AS VARCHAR), 6) AS [NormalizedMinTime],  
  right('000000'+cast((max(shiftedCardEventTime) % 240000) AS VARCHAR), 6) AS [NormalizedMaxTime]
FROM cteTbl
GROUP BY 
  CardNo, 
  ShiftedCardEventDate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T15:02:11.633

仅使用查询的解决方案：

```
SELECT  CardEventDate, CardEventTime, CardNo
        ,(1000000*CAST(CardEventDate AS BIGINT) + CAST(CardEventTime AS BIGINT)) AS CardEventDateTimeINT
        ,((1000000*CAST(CardEventDate AS BIGINT) + CAST(CardEventTime AS BIGINT))-150000)/1000000 AS StartDate
FROM    "table"
WHERE   ((1000000*CAST(CardEventDate AS BIGINT) + CAST(CardEventTime AS BIGINT))-150000)/1000000 = '20090223' 
```

参数是：

*   '20090223' - 您的 24 小时期间的开始日期（您的过滤器）
*   WHERE 子句中的 150000 表示开始时间为 15:00:00。更改它将为您提供不同的 24 小时范围。如果确切时间应该转到另一个日期，您可能希望它是 150001。
    *   删除过滤器（WHERE 子句）将为您提供所有结果，如果您取消注释列“StartDate”，您可以稍后进一步过滤

它的实现方式是根据您的日期和时间组合 DATETIME，但不使用 DATETIME 数据类型，而只是使用 BIGINT，因此 20090224092007 的值将是 20090224 的日期和 092007 的时间。最重要的是它仍然是可排序的，并且只需使用 INTEGER 部门就可以轻松切断/转移购买。这就是我买的减去 150000（时间 15:00:00）。

结果（使用上面查询中的过滤器）是：

```
CardEventDate CardEventTime CardNo CardEventDateTimeINT StartDate
------------- ------------- ------ -------------------- --------------------
20090224      92007         485    20090224092007       20090223
20090224      92345         321    20090224092345       20090223 
```

没有任何过滤器的结果如下，以便您稍后可以按 StartDate 过滤：

```
CardEventDate CardEventTime CardNo CardEventDateTimeINT StartDate
------------- ------------- ------ -------------------- --------------------
20090224      92007         485    20090224092007       20090223
20090224      92345         321    20090224092345       20090223
20090225      163932        168    20090225163932       20090225
20090225      164630        471    20090225164630       20090225
20090225      165027        488    20090225165027       20090225
20090225      165137        247    20090225165137       20090225
20090225      165147        519    20090225165147       20090225
20090225      165715        518    20090225165715       20090225
20090225      165749        331    20090225165749       20090225
20090303      162059        240    20090303162059       20090303
20090303      162723        518    20090303162723       20090303
20090303      155029        386    20090303155029       20090303
20090303      155707        441    20090303155707       20090303
20090303      162824        331    20090303162824       20090303 
```

这是带有 GROUP BY、MIN(..) 和 MAX(..) 的版本：

```
SELECT  CardNo, 
        ((1000000*CAST(CardEventDate AS BIGINT) + CAST(CardEventTime AS BIGINT))-30000)/1000000 AS CardEvenDateAdjusted, 
        MIN(CardEventTime) AS MinTime, 
        MAX(CardEventTime) AS MaxTime
        --,COUNT(*) AS NUM
FROM    "table"
GROUP BY CardNo, ((1000000*CAST(CardEventDate AS BIGINT) + CAST(CardEventTime AS BIGINT))-30000)/1000000 
```

注意几点：

*   对于第二天 00:00:00 到 03:00:00 之间的时间，CardEvenDateAdjusted 将不完全正确
*   小于 030000 的 MinTime 意味着它实际上是第二天的，所以实际上它不是真正的 MIN ......
*   如果您的 CardEventTime 是 sting（不是整数），那么您必须确保它有前导零（020000，而不是 20000），否则 MIN、MAX 将无法正确排序，因此 20000 高于 150000。

**再说一遍：除非你重新问一个好问题，否则你不会得到你正在寻找的答案。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:24:43.690

**步骤1**

首先将带有日期和时间的两列放在一个`carddate`类型的列（即）中`datetime`。

**第 2 步**
如果您想根据一天中的某些分段时间进行分组，请执行以下操作（例如凌晨 3 点中的分段时间）：

```
select min(carddate) as Minimum, max(carddate) as Maximum
from sampleTable
group by
    year(dateadd(hour, -3, carddate)),
    month(dateadd(hour, -3, carddate)),
    day(dateadd(hour, -3, carddate)) 
```

但是您将无法像这样简单地获得组内的卡号。您必须使用用户功能来实现这种功能

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T11:42:35.753

查询中的日期格式似乎是特定于实现的。

对 SQLServer2000，您想让您的查询使用日期作为日期 - 而不是作为数字。您确实应该有一个“日期时间”类型的字段，而不是两个单独的字段。但是，如果您无法控制这一点，那么您将需要添加一些日期时间。我举个例子。

尝试这样的事情：

```
SELECT * FROM table
WHERE
  (DATEDIFF(dd, GetDate(), CARDEVENTDATE) = 1  AND  CARDEVENTTIME > 030001 )  OR
  (DATEDIFF(dd, GetDate(), CARDEVENTDATE) = 0  AND  CARDEVENTTIME < 030000 ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:16:59.603

该脚本是 SQLServer2005，但使用#Temp 表，您应该能够将其转换为可用的 SQLServer2000 脚本。

如果我理解正确，以下脚本按*dd 03:00:00* - *dd+1 03:00:00对记录进行分组*

```
DECLARE @Table TABLE (
  CARDEVENTDATE INTEGER
  , CARDEVENTTIME INTEGER
  , CARDNO INTEGER)

DECLARE @TableDateTime TABLE (
  CARDEVENTDATETIME DATETIME
)

INSERT INTO @Table VALUES (20090224,92007,485)
INSERT INTO @Table VALUES (20090224,92345,321)
INSERT INTO @Table VALUES (20090225,163932,168)
INSERT INTO @Table VALUES (20090225,164630,471)
INSERT INTO @Table VALUES (20090225,165027,488)
INSERT INTO @Table VALUES (20090225,165137,247)
INSERT INTO @Table VALUES (20090225,165147,519)
INSERT INTO @Table VALUES (20090225,165715,518)
INSERT INTO @Table VALUES (20090225,165749,331)
INSERT INTO @Table VALUES (20090303,162059,240)
INSERT INTO @Table VALUES (20090303,162723,518)
INSERT INTO @Table VALUES (20090303,155029,386)
INSERT INTO @Table VALUES (20090303,155707,441)
INSERT INTO @Table VALUES (20090303,162824,331)

INSERT INTO @TableDateTime
SELECT 
  [DATETIME-3] = 
    DATEADD(MONTH, ((CARDEVENTDATE/10000-1900)*12)+(CARDEVENTDATE/100)%100-1, CARDEVENTDATE%100-1) 
    + DATEADD(SS, (((CARDEVENTTIME/10000)-3)*3600)+(((CARDEVENTTIME/100)%100)*60)+CARDEVENTTIME%100, 0)
FROM @Table

SELECT CAST(CAST(tdt1.CARDEVENTDATETIME-1 AS INTEGER) AS DATETIME), COUNT(*)
FROM @TableDateTime tdt1
GROUP BY CAST(tdt1.CARDEVENTDATETIME-1 AS INTEGER)

/*
  What do all the casts, div's and mods mean
*/
SELECT
  /* Split */
  [YEAR] = CARDEVENTDATE / 10000
  , [MONTH] = (CARDEVENTDATE / 100) % 100
  , [DAY] = CARDEVENTDATE % 100
  , [HOUR] = CARDEVENTTIME / 10000  
  , [MINUTE] = (CARDEVENTTIME / 100) % 100
  , [SECOND] = CARDEVENTTIME % 100  
  /* Date & Time */
  , [DATE] = DATEADD(MONTH, ((CARDEVENTDATE/10000-1900)*12)+(CARDEVENTDATE/100)%100-1, CARDEVENTDATE%100-1)
  , [TIME] = DATEADD(SS, (CARDEVENTTIME/10000*3600)+(((CARDEVENTTIME/100)%100)*60)+CARDEVENTTIME%100, 0)
  /* DateTime */
  , [DATETIME] = 
      DATEADD(MONTH, ((CARDEVENTDATE/10000-1900)*12)+(CARDEVENTDATE/100)%100-1, CARDEVENTDATE%100-1)
      + DATEADD(SS, (CARDEVENTTIME/10000*3600)+(((CARDEVENTTIME/100)%100)*60)+CARDEVENTTIME%100, 0)
  , [DATETIME-3] = 
      DATEADD(MONTH, ((CARDEVENTDATE/10000-1900)*12)+(CARDEVENTDATE/100)%100-1, CARDEVENTDATE%100-1) 
      + DATEADD(SS, (((CARDEVENTTIME/10000)-3)*3600)+(((CARDEVENTTIME/100)%100)*60)+CARDEVENTTIME%100, 0)
FROM @Table
ORDER BY [DATETIME] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T11:48:48.940

这是不正确的，因为条件总是错误的：（您将日期存储为整数而不是日期时间，并且整数无法知道它应该在午夜回绕）

```
Select Cardno, Cardeventdate, Min(cardeventtime), 
  max(cardeventtime) from table where Cardeventtime >030001 
      and Cardeventtime < 030000 
```

查询应该这样写：

```
Select Cardno, Cardeventdate, Min(cardeventtime), 
  max(cardeventtime) from table where (Cardeventtime between 030001 and 120000)
      OR (cardeventtime between 000000 and 030000) 
```

一旦将此因素考虑到您的其他查询中，您应该能够提出解决方案。

编辑：抱歉，查询中的意思是 OR 而不是 AND。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T11:48:51.683

你不能打电话给：

```
select *
from someTable
where cardeventtime not between 30000 and 30001
order by cardeventdate, cardeventtime 
```

# linux - 如何检查 Qt GUI 应用程序是否已经在运行（在 Linux 中）？

> ID：939072
> 
> 赞同：2
> 
> 时间：2009-06-02T11:43:03.397
> 
> 标签：linux, qt

我需要检查我的 Qt GUI 应用程序是否已经**在当前 X 会话中**运行。也就是说，我想禁止运行它的多个实例。但是应该允许不同用户或同一用户在另一个（即远程）X 服务器上运行多个实例。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T11:49:49.827

Qt 已经为每个用户提供了一个单一实例的解决方案：[QtSingleApplication](https://github.com/qtproject/qt-solutions/tree/master/qtsingleapplication)。检查这是否适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T11:50:06.783

启动程序时创建一个点文件（比如~/.yourapp-xsessionID），退出时删除它；如果文件已经存在（即它已经在运行）打印出错误消息并退出。

有关此方法的问题，请参阅 Firefox。

# c# - C# 配置文件

> ID：939074
> 
> 赞同：5
> 
> 时间：2009-06-02T11:44:34.877
> 
> 标签：c#, .net, file, config

好的，所以提前我发布了如何读取其他程序的其他配置文件（这是链接[Previous Post](https://stackoverflow.com/questions/938585/open-other-programs-configuration-files)。我设法做到了。但现在还有另一个问题。场景是这样的，我有两个程序。程序**A**从一个配置文件中读取自己的配置，程序**B**只用来修改**A**读取的配置文件的内容，配置文件名为*email.config*，与程序**A** & **B**所在目录相同.

问题是我使用打开文件对话框获取附件的文件路径。如果路径指向同一目录中的文件，则程序完美运行！但是，如果它指向目录之外的文件，则会引发*System.NullReferenceException*类型的异常。

这是代码

```
private void saveBtn_Click(object sender, EventArgs e)
{
    try
    {
        // save everything and close
        string attachment = attachTxtBox.Text;

        var configMap = new ExeConfigurationFileMap { ExeConfigFilename = configFileName };
        // it throws exception here when
        // the path points to a file outside the exes directory
        Configuration externalConfig = ConfigurationManager.OpenMappedExeConfiguration(configMap, ConfigurationUserLevel.None);

        externalConfig.AppSettings.Settings["ServerAddress"].Value = serverAddr;
        externalConfig.AppSettings.Settings["Port"].Value = port;
        externalConfig.AppSettings.Settings["SSL"].Value = ssl.ToString();
        externalConfig.AppSettings.Settings["Sender"].Value = senderAddr;
        externalConfig.AppSettings.Settings["SenderPassword"].Value = password;
        externalConfig.AppSettings.Settings["Subject"].Value = subject;
        externalConfig.AppSettings.Settings["AttachmentPath"].Value = attachment;
        externalConfig.AppSettings.Settings["Body"].Value = messageBody;

        // Save values in config
        externalConfig.Save(ConfigurationSaveMode.Full);
        Application.Exit();
    }
    catch (System.Exception ex)
    {
        MessageBox.Show("Error: " + ex.Message);
        Application.Exit();
    }
} 
```

*email.config*的内容是：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <appSettings file="">
    <clear />
    <add key="ServerAddress" value="" />
    <add key="Port" value="" />
    <add key="Sender" value="" />
    <add key="SenderPassword" value="" />
    <add key="Subject" value="" />
    <add key="AttachmentPath" value="" />
    <add key="Body" value="" />
  </appSettings>
</configuration> 
```

我在这里做错了什么？

**编辑：***configFileName*的值为“ *email.config”*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T15:05:10.883

好吧，我自己调试了将近 5 个小时后自己弄清楚了，该死！

问题是当我使用 OpenFileDialog 获取文件路径时，它将当前目录更改为在对话框中选择的目录，因此程序找不到配置文件。我所做的只是将 OpenFileDialog 的 RestoreDirectory 属性设置为 true 并且*它*工作正常

谢谢大家，ChrisF、Eoin Campbell 和 pablito。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T11:49:02.247

您是通过完整路径还是仅通过文件名访问文件？

如果是后者，那么当文件与可执行文件位于同一文件夹中时，这将起作用，但不是。

**更新**

看起来事情比我最初想象的要复杂，这似乎不是这里的问题 - 请参阅评论。引发异常的行是：

```
externalConfig.AppSettings.Settings["ServerAddress"].Value = serverAddr; 
```

所以这意味着在链的某处有一个空引用。如果你能确定它是什么，那么这应该会给你一个指向问题的指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T11:54:41.253

您使用什么代码从 OpenFileDialog 获取文件名和路径。

它是文件的完全限定路径吗？

例如

```
openFileDialog1.FileName; //Contains "C:\\Path\\To\\The\\File.txt" 
```

听上去，保存的只是一个文件名，所以您的应用程序只在当前路径中查找。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T14:27:01.273

我遇到了同样的问题，我不知道这是否可以帮助您，但是当我将配置文件的名称（在您的情况下位于另一个文件夹中）更改为 .config 并且它不再崩溃时，在我的如果我可以更改名称，因此我没有继续调查如何使其与其他名称一起使用，但我当然想知道。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-29T13:24:13.817

```
externalConfig.AppSettings.Settings["SSL"].Value = ssl.ToString(); 
```

配置文件不包含“SSL”

对于那些正在尝试此代码的人来说，这只是我的 2c。

# grails - 为什么 grails 使用“静态”变量而不是注释

> ID：939080
> 
> 赞同：2
> 
> 时间：2009-06-02T11:45:35.733
> 
> 标签：grails

例如：类

```
Book {
static mapping = {
    batchSize 10
}
} 
```

可能：

```
@Configration(batchSize=10)
class Book {
    ...
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T11:51:14.707

主要原因是 Grails 是为不支持注解的 Groovy 1.1 开发的。我猜下一个版本将支持注释，但正如 alamar 所说，注释不能在运行时更改。因此，当前的方法更加灵活。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T11:46:33.750

也许是因为他们可以这样改变？并且注释是一成不变的。

# javascript - 页面上的模态、非模态 div

> ID：939082
> 
> 赞同：0
> 
> 时间：2009-06-02T11:46:15.183
> 
> 标签：javascript, xhtml, html

我在我的 HTML 页面上使用了模态的、无模式`div`的 s（我的意思是固定的、样式化的 s）。`div`此页面也包含`iframe`带有 modal`div`的 s。

当我在页面上打开一个新`div`页面时，我需要在父页面（打开器页面）上禁用键盘事件。我还需要能够处理父页面上的制表键按下。我已经谷歌了，但我还没有找到解决这个问题的任何解决方案。

你有什么建议或想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T11:53:48.633

也许带有[这个插件的](http://jshotkeys.googlepages.com/test-static-01.html)[jQuery](http://jquery.com/)可以帮助你？键绑定变得简单，要禁用键（例如 CTRL+F），您只需编写：

```
$(document).bind('keydown', 'Ctrl-f', function(evt) {return false;}); 
```

# ruby-on-rails - Rails 中类似 Wiki 的格式

> ID：939086
> 
> 赞同：0
> 
> 时间：2009-06-02T11:46:45.213
> 
> 标签：ruby-on-rails, text-formatting

我忘记了这个图书馆的名字。但这有点像 Wiki，您如何在文本前面键入某些字符，然后它将使文本变为粗体/斜体/下划线。

我不是在询问 Wiki 的格式化方式，但我知道 Rails 中内置了类似的东西。它在我的舌尖。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-07T22:13:29.537

您在寻找`textilize`视图助手吗？在你看来，只要说：

```
<%= textilize( post.body_text ) %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T12:01:15.153

RedCloth 做到了这一点。它为您提供纺织标记（这是丹尼尔答案中列出的标记语言之一）。

[http://redcloth.org/](http://redcloth.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T11:48:58.220

其中许多是在 Ruby 中实现的：

[轻量级标记语言比较](http://en.wikipedia.org/wiki/Lightweight_markup_language#Comparison_of_lightweight_markup_language_syntax)

我喜欢 Markdown，通过[RDiscount](http://github.com/rtomayko/rdiscount/tree/master)。

# ruby-on-rails - 如何在 Rails 2.0/ruby 1.8.6 中的字符串数组中找到非 ascii 字符串？

> ID：939090
> 
> 赞同：4
> 
> 时间：2009-06-02T11:47:33.107
> 
> 标签：ruby-on-rails, ruby, string, encoding

我有一个从数据库加载的用户登录数组。仅保留包含非 ascii 字符的登录名的最简单有效的方法是什么？

```
logins = Users.find(:all).map{|user|user.login}
logins_with_non_ascii_characters = logins.select{ |login| ...??? } 
```

谢谢

*编辑*：如果你有一个 SQL 解决方案（我使用 MySQL，但通用解决方案会更好）直接在第一行过滤掉登录，使用 :conditions 子句，我也可以。事实上，它会更有效：

```
logins = Users.find(:all, :conditions => "...???").map{|user|user.login} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T13:49:58.040

您可以为此滥用 Ruby 内置的正则表达式字符类

[:print:] 包含所有 ASCII 可打印字符。它不包含诸如哔哔声之类的 ASCII 字符，或者更重要的是，不包含多字节字符。

假设您的用户不太可能在密码中使用 ASCII BEEP 作为字符，

```
#reject if has non-ascii character
valid_users = users.reject! {|user| user.login =~ /[^[:print:]]/} 
```

应该为你做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T12:20:18.673

到目前为止，我发现的是：

```
def is_ascii(str)
    str.each_byte {|c| return false if c>=128}
    true
end

logins = Users.find(:all).map{|user|user.login}
logins_with_non_ascii_characters = logins.select{ |login| not is_ascii(login) } 
```

这有点令人失望，而且肯定效率不高。有人有更好的主意吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-12T19:19:34.907

您只能从用户中选择登录列：

```
non_ascii = /[\u0080-\uffff]/
logins = Users.select(:login).find_all {|login| login =~ non_ascii } 
```

或者您可以`/\p{ASCII}/`在 Ruby 2.0中使用

# distributed - MapReduce 如何成为分析 http 服务器日志的好方法？

> ID：939100
> 
> 赞同：7
> 
> 时间：2009-06-02T11:50:15.100
> 
> 标签：distributed, mapreduce, logfile-analysis

关注 MapReduce 有一段时间了，它似乎是一个很好的实现容错分布式计算的方法。我阅读了很多关于该主题的论文和文章，在一系列虚拟机上安装了 Hadoop，并进行了一些非常有趣的测试。我真的认为我了解 Map 和 Reduce 步骤。

但这是我的问题：**我不知道它如何帮助进行 http 服务器日志分析。**

我的理解是，大公司（例如 Facebook）使用 MapReduce 来计算他们的 http 日志，以加快从中提取受众统计数据的过程。我工作的公司虽然比 Facebook 小，但每天都有大量的网络日志需要计算（100Go 每月增长 5% 到 10%）。现在我们在单个服务器上处理这些日志，它工作得很好。但是，分配计算作业会立即成为一种很快就会有用的优化。

以下是我现在无法回答的问题，任何帮助将不胜感激：

*   MapReduce 概念真的可以应用于博客分析吗？

*   MapReduce 是最聪明的方法吗？

*   您将如何在各种计算实例之间拆分 Web 日志文件？

谢谢你。
尼古拉斯

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T12:26:32.497

**MapReduce 概念真的可以应用于博客分析吗？**

是的。

您可以将您的 hudge 日志文件拆分为 10,000 或 1,000,000 行的块（对于您的日志文件类型来说是一个好的块 - 对于 apache 日志文件，我会选择更大的数量），将它们提供给一些可以提取特定内容的映射器（例如 Browser,IP Address, ..., Username, ... )，然后通过计算每个日志行出现的次数来减少（简化）：

```
 192.168.1.1,FireFox x.x,username1
  192.168.1.1,FireFox x.x,username1
  192.168.1.2,FireFox y.y,username1
  192.168.1.7,IE 7.0,username1 
```

您可以提取浏览器，忽略版本，使用地图操作来获取此列表：

```
FireFox
FireFox
FireFox
IE 
```

然后减少得到这个：FireFox,3 IE,1

**MapReduce 是最聪明的方法吗？**

这很聪明，但你需要非常大才能获得任何好处......拆分 PETABYTES 的日志。

为了做这种事情，我更喜欢使用消息队列和一致的存储引擎（如数据库），处理从队列中提取工作、执行工作并将结果推送到另一个队列的客户端，而不是工作在某个时间范围内执行，以供其他人处理。这些客户端将是执行特定操作的小程序。

您可以从 1 个客户端开始，然后扩展到 1000 个……您甚至可以在 LAN 上的所有 PC 上运行一个作为屏幕保护程序的客户端，并在您的 8 核服务器上运行 8 个客户端，在双核 PC 上运行 2 个客户端...

使用 Pull：您可以有 100 或 10 个客户端在工作，多核机器可以有多个客户端在运行，并且无论客户端完成什么都可以用于下一步。而且您不需要为要完成的工作进行任何散列或分配。它是 100% 动态的。

[http://img355.imageshack.us/img355/7355/mqlogs.png](http://img355.imageshack.us/img355/7355/mqlogs.png)

**您将如何在各种计算实例之间拆分 Web 日志文件？**

如果它是基于文本的日志文件，则按元素或行数。

为了测试 MapReduce，我建议您使用 Hadoop。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:12:42.167

*   MapReduce 概念真的可以应用于博客分析吗？

当然。你存储的是什么类型的数据？

*   MapReduce 是最聪明的方法吗？

它将允许您一次查询许多商品机器，所以是的，它可能很有用。或者，您可以尝试[Sharding](http://en.wikipedia.org/wiki/Shard_(database_architecture))。

*   您将如何在各种计算实例之间拆分 Web 日志文件？

通常，您会使用[一致的散列算法](http://en.wikipedia.org/wiki/Consistent_hashing)分发数据，这样您以后可以轻松地添加更多实例。您应该使用普通数据库中的主键来散列。它可以是用户 ID、IP 地址、引用者、页面、广告；无论您的日志记录的主题是什么。

# c# - 如何重用相同的变量，但用于不同的类型？

> ID：939102
> 
> 赞同：1
> 
> 时间：2009-06-02T11:51:22.990
> 
> 标签：c#, inheritance, types

我有一个小问题，了解“T 型”的幕后发生了什么，才能做到这一点，我希望你们中的一些人可以在隧道尽头向我展示一盏灯 :)

我有一个[COM 对象](http://www.bcltechnologies.com)，我几乎分配了一些东西（属性），但我需要对所有对象使用它，并且我想这样做一次，并且只有它适用于所有类型。

打印机类型：

```
switch (type)
{
    case convert2pdf.ConvertFileType.Word: 
        WordPrintJob oPrintJob = null; break;
    case convert2pdf.ConvertFileType.Excel: 
        ExcelPrintJob oPrintJob = null; break;
    case convert2pdf.ConvertFileType.PowerPoint: 
        PowerPointPrintJob oPrintJob = null; break;
    case convert2pdf.ConvertFileType.IE: 
        IEPrintJob oPrintJob = null; break;
    case convert2pdf.ConvertFileType.Publisher: 
        PublisherPrintJob oPrintJob = null; break;
    case convert2pdf.ConvertFileType.Visio: 
        VisioPrintJob oPrintJob = null; break;

    default: 
        GenericPrintJob oPrintJob = null; break;
} 
```

然后，无论我创建了什么对象类型，我每次都会实现：

```
PDFSetting oPDFSetting = null;

oPrintJob = oPrinter.GenericPrintJob;
oPDFSetting = oPrintJob.PDFSetting;

/*put water mark on the first page, set the water mark text to "BCL EasyPDF */
oPDFSetting.set_Watermark(0, true);
oPDFSetting.set_WatermarkColor(0, (uint)System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Blue));
oPDFSetting.set_WatermarkFirstPageOnly(0, true);
oPDFSetting.set_WatermarkText(0, "EasyPDF");

/*set the meta data for the pdf file*/
oPDFSetting.MetaData = true;
oPDFSetting.MetaDataAuthor = "Your Name";
oPDFSetting.MetaDataCreator = "BCL";
oPDFSetting.MetaDataKeywords = "PDF";
oPDFSetting.MetaDataSubject = "Converter";
oPDFSetting.MetaDataTitle = "easyPDF SDK"; 
```

我如何使用“T型”的东西（男人......经过3年的C＃我仍然无法理解，无论我阅读什么，我阅读维基百科，ASP.NET 3.5专业书籍，教程，...... ) :(

换句话说，我怎样才能重用这些属性。

我考虑过创建一个 ExtensionMethod，但我将不得不编写所有这些并且不重用任何代码......我考虑过创建一个通用控件并创建一个继承该基础控件的新控件，以便我可以使用

```
GlocalObject oPrintJob = null; 
```

...

```
WordPrintJob oPrintJob = (WordPrintJob)GlocalObject; 
```

我说得有道理吗？

* * *

**从答案更新**

好的，所以，没有“类型 T”，但基类/接口......然后我正在尝试创建该接口，以便我可以从它继承，我得到下面的图像：

[替代文字 http://www.balexandre.com/temp/2009-06-02_1521_soQuestion_Interface.png](http://www.balexandre.com/temp/2009-06-02_1521_soQuestion_Interface.png)

如果在界面中我说 PrintJob 类型，如何返回 WordPrintJob 类型？:-(我不明白...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T11:57:09.937

您需要定义一个基类`PrintJob`并将其`PDFSetting`作为其属性。

然后将`WordPrintJob`等定义`ExcelPrintJob`为 的子类`PrintJob`。

我已经很久没有这样做了，所以我不记得您是否能够`PDFSettings`从子类访问，或者您是否必须首先将变量转换为基类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T12:05:49.280

Chris 基本上是正确的，因此您的 switch 语句如下所示：

```
PrintJob oPrintJob = null;
switch (type)
{
    case convert2pdf.ConvertFileType.Word: 
        oPrintJob = new WordPrintJob(); 
        break;
    case convert2pdf.ConvertFileType.Excel: 
        oPrintJob = new ExcelPrintJob(); 
        break;
    case convert2pdf.ConvertFileType.PowerPoint: 
        oPrintJob = new PowerPointPrintJob(); 
        break;
    case convert2pdf.ConvertFileType.IE: 
        oPrintJob = new IEPrintJob(); 
        break;
    case convert2pdf.ConvertFileType.Publisher: 
        oPrintJob = new PublisherPrintJob(); 
        break;
    case convert2pdf.ConvertFileType.Visio: 
        oPrintJob = new VisioPrintJob(); 
        break;
    default: 
        oPrintJob = new GenericPrintJob();
        break;
} 
```

PDFSettings 属性将在您的基类 PrintJob 中定义，并且每个特定的打印作业类都将从该基类继承。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T12:10:50.550

随着[Lazurus 的回答](https://stackoverflow.com/questions/939102/how-to-reuse-the-same-variable-but-for-diferent-types/939150#939150)，您可能还想创建一个接口，并针对它进行大部分编码，而不是基类。

# java - 增加显示 HTML 文本的 JTextPane 的字体大小

> ID：939109
> 
> 赞同：3
> 
> 时间：2009-06-02T11:54:24.170
> 
> 标签：java, swing, jtextpane

假设我有一个显示 HTML 文档的 JTextPane。

我希望在按下按钮时增加文档的字体大小。

不幸的是，这并不像看起来那么容易……[我找到了一种更改整个文档字体大小的方法，但这意味着所有文本都设置为我指定的字体大小](http://javatechniques.com/blog/setting-jtextpane-font-and-color/)。我想要的是字体大小与文档中已有的大小成比例增加。

我是否必须遍历文档上的每个元素，获取字体大小，计算新大小并将其重新设置？我怎么能做这样的操作？什么是最好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T13:38:25.490

在您链接到的示例中，您会发现一些您正在尝试做的事情的线索。

线

```
StyleConstants.setFontSize(attrs, font.getSize()); 
```

更改 JTextPane 的字体大小并将其设置为您作为参数传递给此方法的字体大小。您要根据当前大小将其设置为新大小。

```
//first get the current size of the font
int size = StyleConstants.getFontSize(attrs);

//now increase by 2 (or whatever factor you like)
StyleConstants.setFontSize(attrs, size * 2); 
```

这将导致 JTextPane 的字体大小加倍。你当然可以以较慢的速度增加。

现在你需要一个按钮来调用你的方法。

```
JButton b1 = new JButton("Increase");
    b1.addActionListener(new ActionListener(){
        public void actionPerformed(ActionEvent e){
            increaseJTextPaneFont(text);
        }
    }); 
```

因此，您可以编写类似于示例中的方法，如下所示：

```
public static void increaseJTextPaneFont(JTextPane jtp) {
    MutableAttributeSet attrs = jtp.getInputAttributes();
    //first get the current size of the font
    int size = StyleConstants.getFontSize(attrs);

    //now increase by 2 (or whatever factor you like)
    StyleConstants.setFontSize(attrs, size * 2);

    StyledDocument doc = jtp.getStyledDocument();
    doc.setCharacterAttributes(0, doc.getLength() + 1, attrs, false);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:27:34.307

您可能可以使用 css 并仅修改样式字体。

由于它按原样呈现 HTML，因此更改 css 类可能就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-07T03:18:52.500

经过长时间的探索，我找到了一种方法来缩放显示 HTML 进出的 JTextPane 中的字体。

这是使 JTextPane 能够缩放字体的成员函数。它不处理 JTextPane 内的图像。

```
private void scaleFonts(double realScale) {
    DefaultStyledDocument doc = (DefaultStyledDocument) getDocument();
    Enumeration e1 = doc.getStyleNames();

    while (e1.hasMoreElements()) {
        String styleName = (String) e1.nextElement();
        Style style = doc.getStyle(styleName);
        StyleContext.NamedStyle s = (StyleContext.NamedStyle) style.getResolveParent();
        if (s != null) {
            Integer fs = styles.get(styleName);
            if (fs != null) {
                if (realScale >= 1) {
                    StyleConstants.setFontSize(s, (int) Math.ceil(fs * realScale));
                } else {
                    StyleConstants.setFontSize(s, (int) Math.floor(fs * realScale));
                }
                style.setResolveParent(s);
            }
        }
    }
} 
```

# javascript - GLatLngBounds - 错误的中心和缩放级别

> ID：939110
> 
> 赞同：3
> 
> 时间：2009-06-02T11:54:33.343
> 
> 标签：javascript, google-maps

我正在尝试使用 GLatLngBounds 使地图上的所有标记可见。下面是我正在做的一个小例子。

```
INV.createMap = function(containerId) {
    var map = null;
    var geocoder = null;
    var bounds = new GLatLngBounds();

    if (GBrowserIsCompatible()) {
        map = new GMap2(document.getElementById(containerId), {
            size: new GSize(600, 300)
        });
        map.setCenter(new GLatLng(54.729378425601766, 25.279541015625), 15);
        map.addControl(new GSmallZoomControl());
        geocoder = new GClientGeocoder();
    }

    return {
        markAdress: function(address, infoContentHtml) {
            if (map !== null && geocoder !== null) {
                geocoder.getLatLng(address, function(point) {
                    if (point) {
                        var marker = new GMarker(point);
                        GEvent.addListener(marker, 'mouseover', function() {
                            if (!map.getInfoWindow().getPoint().equals(this.getLatLng())) {
                                this.openInfoWindowHtml(infoContentHtml);
                            }
                        });
                        map.addOverlay(marker);
                        bounds.extend(point);
                    }
                });
            }
        },

        finalize: function() {
            map.setCenter(bounds.getCenter(), map.getBoundsZoomLevel(bounds));
        }
    };
}; 
```

用法：

```
var m = INV.createMap('whatever');
var addresses = ...
for (var i = 0, l = addresses.length; i < l; i++) {
    m.markAdress('address...', 'htmlInfo...');
}
m.finalize(); 
```

问题是缩放级别完全错误（太缩小了）并且标记出于某种原因出现在地图的左上角（但它们都是可见的）。

我究竟做错了什么？

编辑：忽略这个问题。我犯了一个愚蠢的错误——我忽略了 GClientGeocoder 发出异步请求的事实，因此 finalize() 方法被调用得太早了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T12:07:54.937

下面函数调用的最后一个参数指定缩放级别：

```
map.setCenter(new GLatLng(54.729378425601766, 25.279541015625), 15); 
```

[本文](http://www.codeproject.com/KB/scrapbook/googlemap.aspx)讨论了一些关于缩放的内容。所以缩放级别有点太高了。

此外[，本教程](http://econym.org.uk/gmap/basic14.htm)将告诉您如何调整地图缩放以正确显示一组标记。

希望这可以帮助

# java - 更改默认 RMI 端口 (Java)

> ID：939111
> 
> 赞同：7
> 
> 时间：2009-06-02T11:54:35.683
> 
> 标签：java, rmi

如何更改默认 RMI 端口 (1099)。它可以作为 JVM 参数或通过编码，没关系。谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T12:08:49.477

您可以在命令行中指定它。来自[RMI 教程](http://java.sun.com/docs/books/tutorial/rmi/running.html)：

> 默认情况下，注册表在端口 1099 上运行。要在不同的端口上启动注册表，请在命令行中指定端口号。不要忘记取消设置 CLASSPATH 环境变量。

```
Microsoft Windows:

start rmiregistry 2001

Solaris OS or Linux:

rmiregistry 2001 & 
```

在您的代码中，您使用[LocateRegistry.getRegistry(String host, int port)](http://java.sun.com/j2se/1.4.2/docs/api/java/rmi/registry/LocateRegistry.html#getRegistry(java.lang.String,%20int))覆盖按主机名和端口定位注册表，如本教程的[创建客户端程序](http://java.sun.com/docs/books/tutorial/rmi/client.html)部分所述。（这同样适用于实现您的服务器。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-07-10T04:54:44.747

您可以通过 super(port, ...) 或 exportObject(remote, port, ...) 在导出远程对象时指定自己的端口，具体取决于您是否扩展 UnicastRemoteObject。如果您扩展 Activatable ，则会有类似的带有端口号的 super() 重载。如果您使用它，您可以在命令行上指定注册表的端口，否则通过 LocateRegistry.createRegistry() 如果您使用它。

# flash - 如何删除孩子（Movieclip）并添加到新的父母（Movieclip）

> ID：939115
> 
> 赞同：0
> 
> 时间：2009-06-02T11:57:04.023
> 
> 标签：flash, actionscript-3

我需要在拖动时从父级（movieClip）中删除子级（movieClip），并在拖放时将相同的子级（movieClip）添加到另一个movieclip。

此方法用于拖动

```
function pickUp(event:MouseEvent):void 
{
    event.target.startDrag();
} 
```

当我放下它

```
function dropIt(event:MouseEvent):void
{
    event.target.parent.removeChild(event.target); //for removing from previous parent clip

    event.target.dropTarget.parent.addChild(event.target); // add to new Moviclip
} 
```

但是剪辑在放下时不可见或不可用...

帮助我克服这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T22:57:47.197

我玩得很快，这是我想出的：

我的示例在舞台上有一个名为“ball”的 MovieClip，还有一些其他的 MovieClip 散布在周围，用作 dropTargets。

```
ball.addEventListener(MouseEvent.MOUSE_DOWN, pickUp);
stage.addEventListener(MouseEvent.MOUSE_UP, dropIt);

function pickUp(event:MouseEvent):void 
{
    var ballPoint:Point = ball.parent.localToGlobal( new Point(ball.x, ball.y) );

    ball.parent.removeChild(ball);
    addChild(ball);
    ball.x = ballPoint.x;
    ball.y = ballPoint.y;
    ball.startDrag();
}

function dropIt(event:MouseEvent):void 
{
    ball.stopDrag();
    if(!event.target.dropTarget) { return };

    var dropT:MovieClip = event.target.dropTarget.parent;
    var ballPoint:Point = dropT.globalToLocal( new Point(ball.x, ball.y) );

    ball.parent.removeChild(ball);
    dropT.addChild(ball);
    ball.x = ballPoint.x;
    ball.y = ballPoint.y;
} 
```

基本上，PickUp 处理程序从其父级移除“球”MovieClip，并将其添加到根 DisplayObject。这确保球在顶部，因此 dropTarget 将起作用（dropTarget 仅适用于堆栈顺序较低的对象）。计算球的 x/y 位置（使用 localToGlobal）为其新父级，并应用。然后调用开始拖动。

dropIt 处理程序首先调用 stopDrag，然后在找不到 dropTarget 时返回。**这次使用globalToLocal**计算球的新 x/y 位置，以获取其在 droptarget 中的新位置。然后将球移除并添加到其新父级（dropTarget）。应用新位置。

在我的情况下似乎工作得很好。

另外......我发现测试它是否工作的一个好方法是暂时将不同的模糊或dropShadow过滤器应用于舞台上的dropTargets。这样当你把球扔到他们身上时，它会继承过滤器，你可以看到一些视觉反馈。

# c# - 使用 NameValueCollection 的 WCF 序列化问题

> ID：939118
> 
> 赞同：5
> 
> 时间：2009-06-02T11:57:11.713
> 
> 标签：c#, wcf, serialization

我正在尝试通过 WCF 序列化 NameValueCollection。我不断收到异常告诉我要添加一个又一个类型。添加它们后，我终于得到了

> 类型 'System.Object[]' 不能添加到已知类型列表，因为另一个类型 'System.Collections.ArrayList' 具有相同的数据合同名称' [http://schemas.microsoft.com/2003/10/Serialization/Arrays :ArrayOfanyType](http://schemas.microsoft.com/2003/10/Serialization/Arrays:ArrayOfanyType) ' 已经存在。

合同现在看起来像这样：

```
[KnownType(typeof(NameValueCollection))]
[KnownType(typeof(CaseInsensitiveHashCodeProvider))]
[KnownType(typeof(CaseInsensitiveComparer))]
[KnownType(typeof(string[]))]
[KnownType(typeof(Object[]))]
[KnownType(typeof(ArrayList))]
[DataContract]
public class MyClassDataBase
{
    [DataMember]
    public NameValueCollection DataCollection = new NameValueCollection();
} 
```

我真的不知道该怎么做才能序列化我的 NameValueColletion。

另一个奇怪的事情是编译器警告 CaseInsensitiveHashCodeProvider 已被弃用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T13:19:58.427

最好的办法是停止使用弱类型，比如`NameValueCollection`and `ArrayList`。使用`Dictionary<string,string>`and`List<T>`代替。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T13:05:54.900

`NameValueCollection`似乎并不完全是为这个用例设计的。[此博客](http://weblogs.asp.net/avnerk/)上有[一系列](http://weblogs.asp.net/avnerk/archive/2006/08/02/WCF-Serialization-Part-2_3A00_-NameValueCollection-Denied_2100_.aspx) [博客](http://weblogs.asp.net/avnerk/archive/2006/08/02/WCF-Serialization-Part-2b_3A00_-WCF-Collection-Serialization.aspx) [文章](http://weblogs.asp.net/avnerk/archive/2006/08/02/WCF-Serialization-Part-2c_3A00_-Hacking-the-NameValueCollection-_2800_unsuccesfully_2900_.aspx)处理此问题并提出[了可能的解决方案](http://weblogs.asp.net/avnerk/archive/2006/08/03/WCF-Serialization-Part-2d_3A00_-A-Solution_2C00_-a-Conclusion-and-a-Contribution.aspx)（即：*使用 IDictionary*）。不过我还没有测试过。

 ** * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T13:52:00.110

另一种方法是使用包装类来适应`NameValueCollection`WCF 序列化。这是一个简单的示例，它将每个名称-值对序列化为单个逗号分隔的字符串。然后它将该值读回`NameValueCollection`反序列化时：

```
[CollectionDataContract]
public class NameValueCollectionWrapper : IEnumerable 
{
    public NameValueCollectionWrapper() : this(new NameValueCollection()) { }

    public NameValueCollectionWrapper(NameValueCollection nvc) 
    {
        InnerCollection = nvc;
    }

    public NameValueCollection InnerCollection { get; private set; }

    public void Add(object value) 
    {
        var nvString = value as string;
        if (nvString != null) 
        {
            var nv = nvString.Split(',');
            InnerCollection.Add(nv[0], nv[1]);
        }
    }

    public IEnumerator GetEnumerator() 
    {
        foreach (string key in InnerCollection) 
        {
            yield return string.Format("{0},{1}", key, InnerCollection[key]);
        }
    }
} 
```

这将允许您将类型用作s`[DataMember]`上的标准属性，`DataContract`并且您还可以使用标准 WCF 序列化技术。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T13:13:31.560

NameValueCollection 不直接实现 ICollection 接口。相反，NameValueCollection 扩展了 NameObjectCollectionBase。这里实现了ICollection接口，重载的Add(system.string)方法在NameValueCollection类中没有实现。当您使用 XMLSerializer 时，XmlSerializer 会尝试将 NameValueCollection 序列化或反序列化为通用 ICollection。因此，它会查找默认的 Add(System.String)。在没有 Add(system.String) 方法的情况下，将引发异常。

使用 SoapFormatter 类进行序列化，而不是使用 XML 序列化。要使用 SoapFormatter 类，您必须添加对 System.Runtime.Serialization.Formatters.Soap.dll 的引用。

```
// Serializing NameValueCollection object by using SoapFormatter
SoapFormatter sf = new SoapFormatter();
Stream strm1 = File.Open(@"C:\datasoap.xml", FileMode.OpenOrCreate,FileAccess.ReadWrite);
sf.Serialize(strm1,namValColl);
strm1.Close();

// Deserializing the XML file into NameValueCollection object
// by using SoapFormatter
SoapFormatter sf1 = new SoapFormatter();
Stream strm2 = File.Open(@"C:\datasoap.xml", FileMode.Open,FileAccess.Read);
NameValueCollection namValColl1 = (NameValueCollection)sf1.Deserialize(strm2);
strm2.Close(); 
```

# svn - 如何通过 WebSVN 限制存储库访问？

> ID：939119
> 
> 赞同：1
> 
> 时间：2009-06-02T11:57:30.810
> 
> 标签：svn, apache, access-control, websvn

[注意：我最初在serverfault.com](https://serverfault.com/questions/13853/how-do-i-restrict-repository-access-via-websvn)上问过这个问题，但到目前为止只得到了一个回复，我越想越觉得在 stackoverflow 上可能会更好。

我有多个通过 Apache 2.2 和 WebDAV 提供的颠覆存储库。它们都位于一个中心位置，我以这篇[debian-administration.org](http://www.debian-administration.org/articles/208)文章为基础（不过，我放弃了对简单 htpasswd 文件使用数据库身份验证）。

从那时起，我也开始使用[WebSVN](http://websvn.tigris.org/)。我的问题是，并非系统上的所有用户都应该能够访问不同的存储库，并且 WebSVN 的默认设置是允许任何可以进行身份​​验证的人。

根据 WebSVN 文档，最好的解决方法是使用 subversion 的路径访问系统，所以我希望使用 AuthzSVNAccessFile 指令来创建它。

但是，当我这样做时，我不断收到“403 Forbidden”消息。

我的文件如下所示：

我在文件中有默认策略设置：

```
<Location /svn/>
  DAV svn
  SVNParentPath  /var/lib/svn/repository

  Order deny,allow
  Deny from all
</Location> 
```

每个存储库都会获得一个策略文件，如下所示：

```
<Location /svn/sysadmin/>
    Include  /var/lib/svn/conf/default_auth.conf
    AuthName "Repository for sysadmin"
    require user joebloggs jimsmith mickmurphy
</Location> 
```

default_auth.conf 文件包含以下内容：

```
SVNParentPath      /var/lib/svn/repository
AuthType           basic
AuthUserFile       /var/lib/svn/conf/.dav_svn.passwd
AuthzSVNAccessFile /var/lib/svn/conf/svnaccess.conf 
```

我不完全确定为什么我需要 default_auth.conf 中的第二个 SVNParentPath，但我今天刚刚添加了这一点，因为添加 AuthzSVNAccessFile 指令导致我收到错误消息。

具有完全许可的访问文件

```
[/]
joebloggs = rw 
```

系统运行良好（并且基本上没有改变），但是当我开始尝试添加任何类型的限制时，例如

```
[sysadmin:/]
joebloggs = rw 
```

相反，我再次收到“权限被拒绝”错误。日志文件条目是：

```
[Thu May 28 10:40:17 2009] [error] [client 89.100.219.180] Access denied: 'joebloggs' GET websvn:/
[Thu May 28 10:40:20 2009] [error] [client 89.100.219.180] Access denied: 'joebloggs' GET svn:/sysadmin 
```

我需要做什么才能使其正常工作？apache配置错了，还是我对svnaccess.conf文件的理解不对？

如果我以错误的方式解决这个问题，我对我的整体方法没有特别的依恋，所以也可以随意提供替代方案。

**更新（20090528-1600）：**

我试图实现[这个答案](https://serverfault.com/questions/13853/how-do-i-restrict-repository-access-via-websvn/13912#13912)，但我仍然无法让它正常工作。

我知道大部分配置都是正确的，因为我已经添加了

```
[/]
joebloggs = rw 
```

一开始，“joebloggs”就拥有所有正确的访问权限。

当我尝试去特定于存储库时，做类似的事情

```
[/]
joebloggs = rw

[sysadmin:/]
mickmurphy = rw 
```

然后我得到了 mickmurphy 的权限被拒绝错误（joebloggs 仍然有效），错误类似于我之前已经遇到的错误

```
[Thu May 28 10:40:20 2009] [error] [client 89.100.219.180] Access denied: 'mickmurphy' GET svn:/sysadmin 
```

另外，我之前忘了解释我所有的存储库都在下面

```
/var/lib/svn/repository 
```

**更新（20090529-1245）：**

让它工作仍然没有运气，但所有迹象似乎都指向问题在于颠覆中的路径访问控制无法正常工作。我的假设是我没有配置 apache 或 svn 来正确识别我的存储库结构。

这是因为“[/]”条目似乎运行良好。

我还想到这个问题可能更适合 StackOverflow？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:14:20.460

您可以使用 apache 的 htpasswd 实用程序（位于 bin 目录中）生成 md5 密码文件。

然后，在您的 httpd.conf 中：

```
<Location /svn>
     DAV svn
     SVNParentPath "repo path"
     AuthType Basic
     AuthName "Repository"
     AuthUserFile "password file path"
     Require valid-user
     SVNListParentPath on #if you want a repository listing for the whole svn directory
</Location> 
```

这将需要用户身份验证，并且仅接受位于密码文件（来自 htpasswd）中的用户名/密码组合进行访问。

此外，您还可以通过以下方式（在 location 标记内）指定每个人的只读访问权限，但使用密码文件进行提交等：

```
<LimitExcept GET PROPFIND OPTIONS REPORT>
     Require valid-user
</LimitExcept> 
```

如果我了解您的需求，这应该可以解决用户级访问问题。

编辑：

我忘了提一下，如果您确实使用了密码文件，请确保它不能通过网络访问（即，在存储它的 apache 中没有分配别名或目录）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-11T09:00:39.837

您必须授予每个人对根目录的读取权限。然后根据需要从特定存储库中删除读取权限。与用户组合作可能有助于保持较小的配置。

你可以像这样试一试：

```
[/]
* = r

[sysadmin:/]
mickmurphy =
joebloggs = rw 
```

# jquery - 如何将无序列表移动到 JQuery 页面上的新部分？

> ID：939121
> 
> 赞同：1
> 
> 时间：2009-06-02T11:57:36.770
> 
> 标签：jquery, list, move

这是故事。我的页面上的 div 中有一个无序列表。

编码：

```
<div id="move-me">
   <ul>
      <li><a href="#">Link</a></li>
      <li><a href="#">Link</a></li>
   </ul>
</div> 
```

上面的代码位于页面的左侧，现在我要做的是，销毁 div 和 ul 元素，只留下链接。然后最后将这些链接附加到侧边栏列表。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T11:59:14.987

简单的！

```
$("#move-me").remove().find('a').appendTo("#somewhere-else"); 
```

[一个例子。](http://jsbin.com/okobi)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:04:55.257

您想从 LI 标签中删除链接，然后添加到侧边栏，然后删除无序列表。像这样的东西应该工作：

$('#move-me > a').appendTo('#sidebar'); $('#move-me').remove();

# c# - IDisposable 如何在 .Net 1.1 中的 FileStream 上实现

> ID：939124
> 
> 赞同：5
> 
> 时间：2009-06-02T11:58:45.987
> 
> 标签：c#, dispose, filestream, .net-1.1, using

这似乎是一个点头的问题，但我正在看这个，因为我听到有人声称你必须在 FileStream 上调用 Close()，即使它在 using 块中（并且他们有调用 Close() 的代码就在街区的尽头）。

我知道 Close() 是为了调用 Dispose()，但我想我会看得更深，因为这是 .Net 1.1 代码，而且我的大部分经验都是在 2.0 上进行的。

让我印象深刻的一件事是，FileStream 的 MSDN 文档具有适用于 .Net 2.0 的 Dispose() 和 Dispose(bool)，但只有适用于 .Net 1.1 的 Dispose(bool)。

我认为这可能是一个疏忽，所以我使用 Reflector 来查看一个程序集——在那里，我也看到了 Dispose(bool)，但没有看到 Dispose()。

它是否正确？如果是这样，这里的故事是什么？FileStream 在 using 块中工作——我认为这意味着它必须实现 IDisposable，据我所知，它只声明了 Dispose()。

是否发生了一些编译器魔术，或者我在某处缺少 Dispose() 的隐藏实现（大概调用 Dispose(true) 或 Dispose(false) ？）

最后（没有双关语），您能否确认在 using 块中确定 FileStream 的范围将在 .Net 1.1 的范围退出时关闭流？

[编辑]

澄清一下，这是 C# 代码。我知道 VB.Net 直到 .Net 2.0 才得到 using 语句，但我的理解是 C# 在 1.1 中有它（我的 1.1 代码有它并编译）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T14:21:04.000

它的实现有点滑稽，但它就在那里：FileStream 的基类：System.IO.Stream 实现了 IDisposable（FileStream 只是继承了它）。

基流类显式地实现了 Dispose()，因此只有将流转换为 IDisposeable 时才会看到 Dispose()（这是 using{} 所做的）。

Stream.Dispose() 调用 Stream.Close()。

（通过反射器得到所有这些）

# ajax - Jquery：ajaxSend 和 ajaxStop 事件不起作用？

> ID：939127
> 
> 赞同：0
> 
> 时间：2009-06-02T11:59:19.840
> 
> 标签：ajax, events, jquery

似乎无法让 ajaxSend 和 Stop 工作......这些是全局变量，不是吗？..但我应该可以这样使用...但我从来没有收到警报？？

我想使用这些事件来显示 ajax 动画.. 虽然在我的代码中我希望根据我正在做什么来定位 ajax 动画它是什么元素。

```
$.ajax({
    type: "POST",
    url: "MyService.aspx/TestMe",
    data: JSON.stringify(data),
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    ajaxSend: function (r, s) {
        alert('i am starting');
    }
    ,
    ajaxStop: function (r, s) {
        alert('i am stopping');
    }
    ,
    success: function (msg) {
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T12:04:37.970

所以你没有正确使用这个功能。ajaxStop、ajaxComplete 等不是 $.ajax 函数的参数。假设您有一个 ajax 图标，您想在请求完成时将其删除。

```
 $("#ajax_icon").ajaxStop(function(){
   $(this).hide();
 }); 
```

你有一个很好的参考[here](http://api.jquery.com)

PS。与其他功能相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T12:06:09.560

这些是全局变量，我通常看到它们分配的方式是：

```
$('element').ajaxStart(function() {
 ... do something ...
} 
```

将它们分配给特定的 ajax 请求，我不确定这是否会满足您的要求。

# c# - 如何将数字格式化为不带百分号的百分比？

> ID：939132
> 
> 赞同：22
> 
> 时间：2009-06-02T12:00:26.810
> 
> 标签：c#, string-formatting

如何在 .NET 中将数字格式化为百分比而不显示百分号？

如果我有数字`0.13`并使用格式字符串`{0:P0}`，则输出为`13 %`.

但是，我想得到`13`，*而不*必将数字乘以 100 并使用格式 string `{0:N0}`。

（背景：在 ASP.NET 中，我有一个带有 BoundField 的 GridView，我想将数字显示为百分比但没有百分号 (%)。我该怎么做？）

* * *

感谢您的回答。在编辑时，六分之四的建议我想避免，如上所述。我正在寻找一种仅使用格式字符串的方法，并避免乘以 100 并使用`{0:N0}`，但答案表明这是不可能的......

* * *

[通过使用Richard](https://stackoverflow.com/users/67392/richard)接受的解决方案来解决：

```
 public class MyCulture : CultureInfo
{
    public MyCulture()
        : base(Thread.CurrentThread.CurrentCulture.Name)
    {
        this.NumberFormat.PercentSymbol = "";
    }
}

Thread.CurrentThread.CurrentCulture = new MyCulture(); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T12:49:23.637

定义一个自定义文化，并为其属性[`NumberFormatInfo`](http://msdn.microsoft.com/library/system.globalization.numberformatinfo)返回。`String.Empty`[`PercentSymbol`](http://msdn.microsoft.com/library/system.globalization.numberformatinfo.percentsymbol)

然后将这种自定义文化用于受影响的页面（或整个应用程序）。这可以通过从默认克隆来完成，以便保留其他区域设置。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-02T12:03:47.257

为什么不将数字乘以 100 并使用`"{0:N0}"`格式字符串？在我看来，这似乎是最简单的解决方案。

除非你能想出一个可行的理由，否则这是我的建议。这不是火箭科学 ：-）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T12:08:53.360

但是乘以 100 正是您想要的！

```
protected void myGrdiView_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        myObjectType ot = (myObjectType)e.Row.DataItem;

        ot.myNumber = ot.myNumber * 100; // multiply by 100
    }
} 
```

并在 HTML

```
<asp:BoundField DataType="myNumber" HeaderText="%" StringFormat="{0:N0}" /> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T12:07:33.783

MSDN* 在“自定义数字格式字符串”下有这个：

> 格式字符串中存在“%”字符会导致数字在格式化之前乘以 100。适当的符号被插入到数字本身的格式字符串中出现“%”的位置。使用的百分比字符取决于当前的 NumberFormatInfo 类。

但是该示例显示它还输出 % 符号 - 不是您想要的，但也许可以通过 NumberFormatInfo 类设置为空？

但是，我同意 Pax，不明白为什么不使用 * 100 和 {0:N0}

**从 Visual Studio 中访问，因此没有链接*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T12:08:28.477

这个怎么样...

```
String.Format("{0:P0}",0.13).Replace("%","") 
```

**编辑：**这应该跨文化工作：

```
var percentSymbol = CultureInfo.CurrentCulture.NumberFormat.PercentSymbol;
String.Format("{0:P0}",0.13).Replace(percentSymbol,"") 
```

还有[这个解决方案](https://stackoverflow.com/questions/2932818/how-to-turn-off-percentage-sign-in-net-wpf)可能更优雅但代码略多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T12:10:58.940

修剪一下怎么样？

```
double d = .102;
string percent = d.ToString("P0").Trim(' ', '%'); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T12:13:00.467

首先要考虑的一点，没有百分比显示的百分比是一个数字，所以让我们忽略百分比方面。您想知道如何将小于或等于 1 的数字显示为小于或等于 100。我很欣赏它已绑定，因此您无法在显示时对其进行修改，那么为什么不在查询时对其进行修改，即 SELECT (value*100) AS Percentage, ...？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T12:31:50.007

你也可以尝试类似的东西

```
string newString = "0.13".Replace("0.", string.Empty) + "%"; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-06-28T11:24:45.743

这是@Richard 建议的使用 NumberFormatInfo 的示例：

```
string.Format(new NumberFormatInfo { PercentSymbol = string.Empty }, "{0:0%}", 0.123); // => 12 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-26T04:33:15.977

这是另一种更短更简洁的方法。

```
$"{rate * 100:F2}" 
```

# css - TwinHelix IE PNG 修复不适用于无序列表或列表项

> ID：939136
> 
> 赞同：1
> 
> 时间：2009-06-02T12:01:43.843
> 
> 标签：css, internet-explorer-6, png, iepngfix

我正在使用 TwinHelix IE PNG Fix [http://www.twinhelix.com/css/iepngfix/](http://www.twinhelix.com/css/iepngfix/)以便在 IE 中支持 PNG 透明度，但无论出于何种原因，它似乎不适用于 IE 6 中的无序列表和列出项目。其他一切都很棒。以前有没有人遇到过这个问题，你找到解决方法了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:00:26.653

事实证明，通过此修复，您需要将标签列表添加到选择器行为中，说明哪些标签可以接受 PNG 背景。这些在进入标题的脚本标签内。

# c++ - c ++ fopen正在返回一个文件* 的

> ID：939152
> 
> 赞同：0
> 
> 时间：2009-06-02T12:06:36.097
> 
> 标签：c++, libjpeg

我从 libjpeg 示例中复制了这段代码，并将其传递给标准文件；

```
FILE *soureFile;
if ((soureFile = fopen(sourceFilename, "rb")) == NULL)
{
    fprintf(stderr, "can't open %s\n", sourceFilename);
    exit(1);
}

jpeg_stdio_src(&jpegDecompress, soureFile);
jpeg_read_header(&jpegDecompress, true); 
```

它导致文件指针不包含任何信息，因此在最后一行中断访问冲突。有任何想法吗？

**编辑：**根据 Tobias 的建议，fopen 确实可以打开文件，但 jpeg_read_header 又因访问冲突而失败。

**编辑：**在使用 ijg 进一步挖掘
[JPEG 支持后 - 获取访问冲突](https://stackoverflow.com/questions/391917/jpeg-support-with-ijg-getting-access-violation)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T12:18:36.163

使用 strerror 或 perror 获取确切原因：

```
FILE *soureFile;
if ((soureFile = fopen(sourceFilename, "rb")) == NULL)
{
    perror("fopen failed");
    exit(1);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T13:00:42.680

“[`select`没有坏](http://www.pragprog.com/the-pragmatic-programmer/extracts/tips)”。

如果`fopen`返回一个有效的文件指针，并且`jpeg_read_header`不能使用它，那么这两个语句之间的某个人对它做了坏事。

唯一介于两者之间的是`jpg_stdio_src`调用，如果满足所有先决条件，它就不会失败。

底线：看看为什么`jpg_stdio_src`会失败。[`jpeg_create_decompress`](http://refspecs.freestandards.org/LSB_3.1.0/LSB-Desktop-generic/LSB-Desktop-generic/libjpeg-ddefs.html)我的猜测：它需要使用宏来构造。

# layout - 水晶报表布局

> ID：939154
> 
> 赞同：2
> 
> 时间：2009-06-02T12:06:51.650
> 
> 标签：layout, crystal-reports, report

我正在使用 Visual Studio 2008 中集成的水晶报表来创建我的报表。我的报告设计是它有 3 个部分的部分标题，其中部分详细信息部分页脚但是当没有记录时，我在详细信息部分显示垂直线时遇到问题。部分页脚始终显示在页面底部，这意味着我可以在打印时检查属性将垂直线延伸到页面底部。我该如何解决这个问题，在此先感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-11T15:47:08.000

您可能需要确保垂直线本身延伸到节页脚。如果该线仅在详细信息部分中并且未延伸到其上方或下方的部分，则如果该部分未显示，则该线将不显示。

# django - 如何存储登录用户的名称？

> ID：939157
> 
> 赞同：0
> 
> 时间：2009-06-02T12:07:42.973
> 
> 标签：django, django-admin, django-forms

我想以自定义形式存储当前登录到 Django 的用户的名称。在管理员中，我们可以通过编写 modified_by=request.user.username 来做到这一点，但我如何以自己的形式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T21:18:52.217

您可以定义表单的 __init__ 方法以接受“请求”参数，然后从您的视图中传递它，或者您可以使用[线程本地化](http://code.djangoproject.com/wiki/CookBookThreadlocalsAndUser)技巧。

# .net - .NET 库来清理输入？

> ID：939159
> 
> 赞同：14
> 
> 时间：2009-06-02T12:08:01.413
> 
> 标签：.net, security, sanitization

是否有任何经过彻底测试的 .NET 库来清理来自脚本/sql 注入之类的输入？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T12:12:34.850

我喜欢使用[Microsoft AntiXSS 库](http://msdn.microsoft.com/en-us/library/aa973813.aspx)。它是免费的，而且很容易使用。

对于 SQL 注入，我总是使用参数。同样，它们易于使用，我不喜欢尝试转义特殊字符。如果你问我，这是灾难的秘诀。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-02T13:41:30.507

SQL 注入和跨站点脚本（又名 XSS 或脚本注入）是不同的问题。

1) SQL 注入非常简单，始终使用参数化查询 (SQLParameter)，并且非常努力地永远不要在 T-SQL 存储过程中执行 sp_exec @query。.Net 参数化查询不会防止这种二阶注入。

2) XSS 更难以普遍缓解，因为有很多地方可以将 JavaScript 插入 HTML 文档。使用 AntiXSS 对用户数据进行编码的建议是正确的。在将用户数据插入输出文档之前使用此库。不幸的是，如果您使用 ASP.Net 服务器控件对所有数据进行编码，可能会导致双重编码和显示伪影。发生这种情况是因为某些控件属性对数据进行编码，而另一些则没有。请参阅[此表](http://blogs.msdn.com/sfaust/archive/2008/09/02/which-asp-net-controls-automatically-encodes.aspx "这张表")以找出默认编码的属性。在分配给任何不编码的属性之前使用 Anti-XSS。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T12:11:01.813

使用[参数化命令](http://msdn.microsoft.com/en-us/library/ms998271.aspx)，而不是尝试清理字符串，以防止 SQL 注入。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T12:14:02.943

[AntiXSS](http://antixss.codeplex.com/)可用于防止 XSS 攻击。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-30T10:55:24.907

如果您使用的是 ASP.NET 4.5，您现在可以使用[框架中附带的 AntiXSS 功能](http://www.asp.net/vnext/overview/whitepapers/whats-new#_Toc318097382)。

这些是已合并到 ASP.NET 4.5 中的外部 AntiXSS 库的部分：

*   `HtmlEncode`, `HtmlFormUrlEncode`, 和`HtmlAttributeEncode`
*   `XmlAttributeEncode`和`XmlEncode`
*   `UrlEncode`和`UrlPathEncode`（新）
*   `CssEncode`

# c# - SQL Server 中的数据集接受更改

> ID：939160
> 
> 赞同：1
> 
> 时间：2009-06-02T12:08:07.027
> 
> 标签：c#, sql-server, ado.net

我正在通过命令对象中的选择查询来加载我的 ADO.net 数据集。如果我使用 Acceptchanges 清除数据集数据，它将删除 sql server 中的数据。

如果没有请告诉我怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T12:14:01.510

不，它不会。

您必须确保 DataTable 中的每个 DataRow 都标记为“已删除”。也就是说，必须将每行的行状态设置为已删除。您可以通过遍历所有行来做到这一点，并为每一行调用 Delete 方法。

然后，您必须在调用 AcceptChanges 之前调用 DataAdapter 的 Update 方法。在数据库中完成更改后，您必须调用“AcceptChanges”，以表明数据集/数据表不再包含必须在数据库中持久化的更改。（调用 AcceptChanges 将删除 RowState 为“已删除”的 DataRows，并将所有其他 DataRows 的 RowState 更改为“UnChanged”。

# php - 在 php DEFINE 中使用变量的 Twitter API 错误

> ID：939163
> 
> 赞同：0
> 
> 时间：2009-06-02T12:08:42.957
> 
> 标签：php, twitter

我正在尝试将用户名和密码变量传递给 twitter 凭据，但它不断返回我未通过身份验证。但是，当我使用实际的用户名和密码而不是变量时，它成功授权。

```
$username = $_POST["username"];
$password = $_POST["password"];

$url = "http://search.twitter.com/search.atom?q=golf&show_user=true&rpp=100";
$search = file_get_contents($url);

$regex_name = '/\<name\>(.+?) \(/';
preg_match_all($regex_name,$search,$user);
for($i=0;$user[1][$i];$i++)
{
$follow = $user[1][$i];
    define('TWITTER_CREDENTIALS', '$username:$password');
    $url = "http://twitter.com/friendships/create/".$follow.".xml";
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,$url);
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_USERPWD, TWITTER_CREDENTIALS);
    $result= curl_exec ($ch);
    curl_close ($ch); 
```

我认为它与用户名和密码之间的冒号有关，或者可能试图在定义函数中使用变量。

有什么线索吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T12:17:15.090

```
$username = $_POST["username"];
$password = $_POST["password"];
// INCORRECT. Will literary assign TWITTER_CREDENTIALS as $username:$password
// define('TWITTER_CREDENTIALS', '$username:$password');

// CORRECT, will parse the variables and assign the result to TWITTER_CREDENTIALS
define('TWITTER_CREDENTIALS', "$username:$password"); 
```

记住带双引号 (") 的字符串会解析字符串中的变量，而带单引号 (') 的字符串则不会。

阅读有关 PHP 中字符串的更多信息：

*   [PHP 字符串](http://se.php.net/manual/en/language.types.string.php)
*   [PHP字符串中的变量解析](http://se.php.net/manual/en/language.types.string.php#language.types.string.parsing)
*   [PHP 字符串函数](http://se.php.net/manual/en/ref.strings.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:13:44.193

它与使用单引号而不是双引号有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:09:36.217

你在一个循环中使用define，那是行不通的，因为你只能定义e常量一次。

# c# - C# - 循环引用，看不到命名空间

> ID：939167
> 
> 赞同：1
> 
> 时间：2009-06-02T12:08:55.483
> 
> 标签：c#, namespaces

我有 2 个项目的解决方案。

一个是 Raven，它是一个简单的基础，它为第二个项目 PPather 提供数据来做一些事情。第二个项目依赖于第一个编译所以要构建它，我添加了对 Raven 的引用。到目前为止一切正常。

现在我想让 Raven 启动 PPather。但它看不到 PPather naemspace，所以我看不到。解决此问题的所有努力都会导致循环引用错误。

任何人都知道如何让 Raven 查看依赖它的 PPather 项目的名称空间？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T12:11:20.390

您不能 - 无法像您想要的那样以循环方式引用程序集。如果您需要创建循环引用，很可能您没有正确设计这些程序集。

您的第一个程序集是一个依赖项，因此其中不应该有任何代码知道*它的*依赖项以外的任何内容。一旦您的程序集变得“智能”并开始了解它们自身依赖项之外的任何内容，您将开始遇到严重的维护和可伸缩性问题。我会考虑以您不需要创建循环引用的方式重新组织您的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T12:22:31.727

正如安德鲁所说，你不能，而且你想要这样做也没有多大意义。

基本上，执行以下操作之一：

*   合并程序集；如果他们真的相互依存紧密，那么他们真的不应该首先分开。

*   重新设计组件，使它们不会在两个方向上直接相互依赖；例如，使程序集 A 依赖于程序集 C 中定义的接口，并让程序集 B 实现该接口（两者都依赖于 C）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T12:22:12.070

如果您不愿意将它们组合成一个组件，那么您可以做很多事情来实现这一点。所有基本上都力求要么反转依赖关系之一，要么创建两者都依赖的第三个组件。

似乎 Raven 是起点，因此一种可能的解决方案是在 PPather 组件中创建一个基类或接口，以反映 PPather 在 Raven 中寻求的功能集。Raven 然后可以实现这个基类，然后在实例化/调用 PPather 时包含一个“this”指针。PPather 将期望在他自己的程序集中有一个指向基类（或接口）的指针，因此除非通过他自己的抽象，否则永远不会“知道”Raven。因此，循环依赖将被打破（通过依赖注入）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:36:51.887

幸运的是，您不能添加循环引用——因为它们会导致维护噩梦。

你想让 Raven 推出 PPather 吗？PPather 是控制台/Windows 应用程序吗？使用 Process.Start 执行此操作（并将 PPather 的位置存储在注册表中的某处）。

或者，为您需要的 PPather 类创建接口 - 并使 PPather 中的类实现这些接口。

```
interface IPPatherInterface // Inside of Raven.
{
    void Foo();
}

class PPatherClass : IPPatherInterface // Inside of PPather
{
    // ...
}

class SomeRavenClass // Static maybe? Inside of Raven
{
    void SupplyPPatherClass(IPPatherInterface item) { ... }
} 
```

您现在可以让 PPather 将该接口的实现提供给 Raven。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:47:41.943

将 Panther 需要使用的 raven 类从 raven 分支到不同的程序集，并让 panther 和 Raven 引用它们。

虽然说实话，如果 Raven 需要运行 panther，那么我认为你的设计有点偏离。你应该把你的代码分解成更易于管理的东西。

# winapi - 如何在win32 C程序中读取摄像机

> ID：939168
> 
> 赞同：1
> 
> 时间：2009-06-02T12:09:03.890
> 
> 标签：winapi, video

我有这个花园品种的 USB 摄像机，它带有两个迷你应用程序，一个只是让你看到相机看到的内容，一个可以记录到 .avi 文件。

但是，如果我想在自己的 C 程序中从相机中抓取图像，那么 API 是什么？我假设（1）可能和（2）需要进行一些调用并填充像素信息的 2D 数组。

我真正*想做*的是修补图像处理算法，为此我真的很想让我的代码围绕一些实时数据。

编辑 -

在对 Linux 进行了健康的接触后，我可以掌握（理想情况下/理论上）您可以如何 open() 设备、使用 ioctl() 对其进行配置以及 read() 数据。而且我几乎可以肯定 Windows 不会以这种方式呈现 API。不知道 Windows 可能为视频设备 API 使用什么函数名称，或者即使它有一个，也很难查找，至少使用我可以使用的 win32 api 搜索功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T12:19:21.653

您可能需要 DirectShow API，前提是相机是这样操作的。如果制造商创建了自己的代码路径，您将需要他们的 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T16:27:04.860

正如 ChrisBD 所指出的，您的第一步是检查 Windows 是否支持您的设备。

如果是这种情况，您可以使用三个可能的 Windows API 进行捕获：

*   [直接秀](http://msdn.microsoft.com/en-us/library/dd375454(VS.85).aspx)
*   [沃尔沃汽车](http://en.wikipedia.org/wiki/Video_for_Windows)。或多或少已被 DirectShow 取代
*   [媒体基金会](http://msdn.microsoft.com/en-us/library/ms694197.aspx)。是旨在取代 DirectShow 的最新 API。AFAIK 尚未完全实现，仅在 Vista 中可用。

从这三个 DirectShow 是最好的选择。但是，学习和使用 DirectShow 并非易事。一个很好的例子可以在[这里](http://www.codeproject.com/KB/audio-video/VideoImageGrabber.aspx)找到。

另一种可能性是使用[OpenCV](http://docs.opencv.org/)。OpenCV 是一个图像处理库，您也可以使用它来处理图像。OpenCV 有一个图像捕获 API，它提供了更简单的抽象，并且比 Windows API 更易于使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T12:43:48.547

API是要走的路。

判断相机是否需要定制相机的一个很好的方法是查看它是否可以在未安装制造商应用程序的情况下被 PC 识别。如果 windows 有内置的驱动程序，您应该能够使用 windows API 来捕获图像。

或者，如果您知道 AVI 文件使用了什么压缩编解码器，您可以将其解压缩。

理想情况下，如果您可以以原生（YUV、RGB15 或类似）格式捕获视频，那将是一件好事，因为这样您就可以进行压缩和操作。

# asp.net - 加密 web.config 的部分。我是不是该？

> ID：939169
> 
> 赞同：1
> 
> 时间：2009-06-02T12:09:14.780
> 
> 标签：asp.net

我负责在本地 Intranet 服务器上运行的几个 ASP.NET Web 应用程序。公司以外的用户不应该有权访问服务器，但我不喜欢在没有必要的情况下留下任何机会。只有管​​理员才能访问文件系统。

我应该加密 web.config 的应用程序设置和连接字符串部分吗？我没有经常看到这一点，我想知道这是否是矫枉过正还是不是最佳实践。我的连接字符串中包含密码，以及用于在应用设置中查询 AD 的服务帐户的帐户信息。

顺便说一句：我会使用加密

```
 Configuration webConfig = WebConfigurationManager.OpenWebConfiguration(System.Web.HttpContext.Current.Request.ApplicationPath);
ConfigurationSection section = webConfig.Sections["connectionStrings"];

if (section != null && !section.SectionInformation.IsProtected)
{
    section.SectionInformation.ProtectSection("DataProtectionConfigurationProvider");
    webConfig.Save();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T12:19:08.660

> 我应该加密 web.config 的应用程序设置和连接字符串部分吗？

如果连接字符串包含密码：那么是的，没有其他合理的选择。

如果使用集成安全连接到数据库，那么信息暴露将是数据库和服务器名称，这不是问题。但是拥有始终加密的部署规则可能更容易，因为更简单的规则更容易遵循和审计。

您还可以使用`aspnet_regiis.exe`来加密部分，而不是编写自己的代码。进入`aspnet_regiis.exe -?`PowerShell（或 cmd）提示以查看选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:18:37.507

我为加密我的 web.config 文件做了类似的事情，我不后悔。维护它并不复杂，它增加了另一层防御。由于安全性是内置在层中的，因此这样做没有错。

# java - Resources.openRawResource() 问题 Android

> ID：939170
> 
> 赞同：14
> 
> 时间：2009-06-02T12:09:32.593
> 
> 标签：java, android

我在`res/raw/`文件夹中有一个数据库文件。我`Resources.openRawResource()` 使用文件名作为调用`R.raw.FileName`并得到一个输入流，但我在设备中有另一个数据库文件，因此将该数据库的内容复制到我使用的设备数据库：

```
 BufferedInputStream bi = new BufferedInputStream(is); 
```

和 FileOutputStream，但我得到一个异常，即数据库文件已损坏。我该如何进行？我尝试使用`File`and`FileInputStream`和路径读取文件`/res/raw/fileName`，但这也不起作用。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-06-03T17:03:54.903

是的，您应该能够使用`openRawResource`将二进制文件从原始资源文件夹复制到设备。

根据 API 演示 (content/ReadAsset) 中的示例代码，您应该能够使用以下代码片段的变体来读取 db 文件数据。

```
InputStream ins = getResources().openRawResource(R.raw.my_db_file);
ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
int size = 0;
// Read the entire resource into a local byte buffer.
byte[] buffer = new byte[1024];
while((size=ins.read(buffer,0,1024))>=0){
  outputStream.write(buffer,0,size);
}
ins.close();
buffer=outputStream.toByteArray(); 
```

您的文件的副本现在应该存在于 中`buffer`，因此您可以使用 a`FileOutputStream`将缓冲区保存到新文件中。

```
FileOutputStream fos = new FileOutputStream("mycopy.db");
fos.write(buffer);
fos.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-03T17:02:00.110

InputStream.available 有严格的限制，不应该用于确定可用于流式传输的内容的长度。

[http://developer.android.com/reference/java/io/FileInputStream.html#available](http://developer.android.com/reference/java/io/FileInputStream.html#available) (): “[...]返回估计的字节数，在没有阻塞的情况下可以读取或跳过更多输入。[。 ..]请注意，这种方法提供的保证很弱，在实践中并不是很有用。”

您有 3 个解决方案：

1.  遍历内容两次，第一次只是计算内容长度，第二次是实际读取数据
2.  由于 Android 资源是由您（开发人员）准备的，因此对其预期长度进行硬编码
3.  将文件放在 /asset 目录中并通过 AssetManager 读取它，这使您可以访问 AssetFileDescriptor 及其内容长度方法。然而，这可能会为您提供 UNKNOWN 长度值，这不是很有用。

# flash - 在线 Flash 视频播放器中的 mpeg1 流

> ID：939171
> 
> 赞同：0
> 
> 时间：2009-06-02T12:10:14.323
> 
> 标签：flash, mp4, mpeg

我正在寻找可以播放 mpeg1 流的 Flash 视频播放器（或者 MP4 也可以）。有吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T16:08:16.373

You cannot play mpeg1 or mp4 directly in flash - you need to convert it to flv format.

# javascript - 将 Flash 图表保存为 png

> ID：939177
> 
> 赞同：0
> 
> 时间：2009-06-02T12:12:00.093
> 
> 标签：javascript, flash, png

在 Fusion 图表 3.0 中，他们可以选择将图表另存为 PNG。但它仅适用于许可用户。但是他们没有免费用户的选项。我的要求是以某种方式将其保存为图像。是否可以在免费版本中。为了实现这一点，我应该做什么。是否有任何机制（第 3 方工具）将 flash 转换为 PNG。

谢谢`沙菲

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:11:43.763

使用您的操作系统的内置屏幕捕获工具。

*   Windows：Alt+PrintScreen - 捕捉到剪贴板
*   Mac OS X：Command+Ctrl+Shift+3 - 捕捉到剪贴板
*   Mac OS X 10.4+：Command+Shift+4 - 捕捉到桌面上的 PNG 文件
*   不知道其他平台

捕获到剪贴板后，您几乎可以使用任何图形应用程序将其保存为 PNG。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T12:35:58.407

您可以使用任何屏幕截图工具：IrfanView (Options -> Capture) 或 SnagIt！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T16:09:17.483

请参阅：[DisplayObject to JPEG or PNG with IImageEncoder](http://blog.tsclausing.com/post/21)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T06:46:49.137

由于 FusionCharts Free 是在 Flash 6 中编码的，您不能直接将其导出为图像。在 FusionCharts v3 中，我们也使用 Flash 10 代码（外部），因为它为我们提供了将显示位图编码为 PNG 所需的字节数组。如果没有这个，在 Flash 8 之前我们唯一的选择就是将它发送到服务器，然后服务器对其进行解码。但是，在 FusionCharts Free 中我们甚至无法做到这一点，因为甚至无法访问位图。因此，您唯一的选择是使用可以保存图像的客户端工具。

或者，如果您使用.NET，您可以在服务器上生成图表，保存为图像，然后使用它。但是，如果您必须同时生成数千个图表（因为 Flash 对象需要在服务器上实例化），那么这对处理器来说有点密集。

干杯，帕拉夫 FusionCharts 团队

# sql-server - 在sql server中将xml列值编码为xml

> ID：939180
> 
> 赞同：2
> 
> 时间：2009-06-02T12:12:34.257
> 
> 标签：sql-server, xml

我有一种方法直接从数据库中获取 vales，构建一个 xml 字符串，然后将 xml 写入文件。

这很好，直到我得到特殊字符，例如“'”、“<”、“&”等。

有谁知道 Sql Server 中允许我在选择值时对值进行编码的东西；例如;

```
select encode(service_status) from myTable 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T12:17:52.017

使用`FOR XML`子句。

`XML`它可以自动从多个值构建：

```
WITH  q AS (
        SELECT  'Barnes & Noble' AS shop
        UNION ALL
        SELECT  'Marks & Spencer'
        )
SELECT  *
FROM    q
FOR XML AUTO, TYPE

---
<q shop="Barnes &amp; Noble" /><q shop="Marx &amp; Spencer" /> 
```

如果您只想对现有值进行编码，请使用：

```
SELECT  'Barnes & Noble'
FOR XML PATH('')

---
Barnes &amp; Noble 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-01T20:30:15.257

你也不需要CLR，只需在sql中做......

```
create function [dbo].[fn_XMLEscape]( @s varchar(max)) returns varchar(max)
as 
begin
  declare @rs varchar(max) 
  set @rs = @s
  set @rs = replace(@rs, '&', '&amp;')
  set @rs = replace(@rs, '''', '&apos;')
  set @rs = replace(@rs, '"', '&quot;')
  set @rs = replace(@rs, '>', '&gt;')
  set @rs = replace(@rs, '<', '&lt;')
  Return( @rs)
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T13:14:18.643

如果您有 >= sql 2005，我认为将您的值填充到 xml 元素中然后将其拉回可能是最简单的。这将实体化任何需要编码的东西。

```
declare @x xml, @str varchar(8000), @encStr varchar(8000)
set @x = '<a/>'
set @str = '><&'

set @x.modify(
    'insert text{sql:variable("@str")}
    as first into (/a)[1]')

set @encStr = CAST(@x.query('/a/text()') as varchar(8000))
select @encStr
--returns: &gt;&lt;&amp; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T13:11:39.333

如果调用应用程序正在构建您返回到 XML 中的内容，则由调用应用程序对数据进行编码。如果您想从 SQL Server 返回 XML，那么这取决于您，Quassnoi 的“FOR XML”答案是正确的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T12:51:58.220

`ENCODE`如果您使用的是 SQL Server 版本 2005/2008，那么您很幸运，因为您可以使用[CLR Functions](http://msdn.microsoft.com/en-us/library/ms189876.aspx)创建自己的函数。

[可以在这里找到一篇非常好的文章](http://www.setfocus.com/technicalarticles/clrfunctionforsqlserver.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-05T10:35:53.470

我的变种：

```
创建函数 dbo.fn_XmlEncode (@STR varchar(200))
返回 varchar(200)
作为
开始
    如果 CHARINDEX('&', @STR) > 0
    开始
       声明 @POS1 整数，@POS2 整数
       SET @POS1 = CHARINDEX('&', @STR)
       当@POS1 > 0 开始时
           IF SUBSTRING(@STR, @POS1, 5) <> '&'
              SET @STR = LEFT(@STR, @POS1 - 1) + '&'
                  + 当@POS1 < LEN(@STR) THEN SUBSTRING(@STR, @POS1 + 1, LEN(@STR) - @POS1) ELSE '' END
           SET @POS2 = CHARINDEX('&', SUBSTRING(@STR, @POS1 + 5, LEN(@STR)))
           如果@POS2 = 0 中断
           设置@POS1 = @POS1 + 4 + @POS2
       结尾
    结尾
    WHILE CHARINDEX('<', @STR) > 0
       设置@STR = 替换（@STR，'<'，'<'）
    WHILE CHARINDEX('>', @STR) > 0
       SET @STR = REPLACE(@STR, '>', '>')
    返回@STR
结尾
去
-- 测试
选择 dbo.fn_XmlEncode('&&'), dbo.fn_XmlEncode('&<&>"&&')
```

# apache-flex - 从 swf 中获取 MXML 和 ActionScript 类

> ID：939193
> 
> 赞同：1
> 
> 时间：2009-06-02T12:14:17.360
> 
> 标签：apache-flex, flash, actionscript, mxml

您好，我想知道 Flex 的安全性。是否有可能从 swf 文件中生成源代码？我的意思是，例如，如果我有我的 Actionscript 和 MXML 文件并将它们编译为 swf，我可以从 swf 文件中获取源代码吗？

亲切的问候

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T13:15:43.773

是的，可以使用 swf 反编译器。它们并不完美，也不会总是产生漂亮的代码，但这是可能的。

这意味着您不应该在您的 swf 中存储秘密，例如用户名/密码。你也不应该相信 swf 来计算重要的值。例如，如果您正在制作银行应用程序，请在服务器而不是客户端计算利息。或者，如果您正在玩游戏，请不要让客户对游戏的结果做出任何重要决定。

如果你在美国，你最好的防御就是版权法。如果您发现有人抄袭您的作品，发送 DMCA 删除通知是一件相当容易的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:18:45.473

但是，您不会得到原始的 flex 代码，而是会在 actionscript 代码中获得所有内容，有时使用不同的变量名（内部使用的变量名）。

# java - 在已编译的 java 类中保留参数/参数名称

> ID：939194
> 
> 赞同：17
> 
> 时间：2009-06-02T12:14:29.387
> 
> 标签：java, eclipse, compilation, javac

当我编译这样的东西时：

```
public class MyClass
{
    void myMethod(String name, String options, String query, String comment)
    {
        ...
    }
} 
```

并将其编译为类文件，似乎参数名称丢失了。也就是说，当一些其他 Java 代码引用`MyClass`并想要调用或覆盖`myMethod`时，我的 IDE（当前为 Eclipse）似乎从类文件中获取此方法签名：

```
void myMethod(String arg0, String arg1, String arg2, String arg3); 
```

我知道 Eclipse（也可能还有其他 IDE）允许我提供指向源代码或 javadoc *（正如 Bishboosh 指出的那样）*的链接，`MyClass`并且可以利用这一点。但是我很好奇是否有某种方法可以告诉`javac`将名称包含到类文件中，以便该类的用户即使只有类文件也可以看到参数名称。

## 班级解决方案

当我用 编译一个类时`java -g:vars`，参数的名称包含在类文件中。`-g:vars`似乎相当于 Eclipse -> 项目属性 -> Java 编译器 -> 将变量属性添加到生成的类文件中。

这个解决方案是由几位作者提出的，但尼克的回答最终让我相信了。

在我的机器上，Eclipse 有时使用此信息，有时没有，这可能是我的错或 Eclipse 中的错误，但不是类文件或编译的问题。无论如何，现在我知道信息肯定存在。

## 但是没有接口的解决方案

虽然这适用于类（有点）好，但它不适用于接口。

对我来说，合乎逻辑的原因似乎是， -g:vars 只提供局部变量的名称，这也是 javac 的文档所指出的。在方法体中，它的参数与局部变量非常相似，因此它们被 -g:vars 覆盖。接口方法没有主体，所以它们不能有局部变量。

我最初的问题只要求上课，因为我不知道可能会有任何区别。

## 类文件格式

正如*gid*所指出的，类文件格式不支持存储参数名称。我[在类文件规范](http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#43817)中找到了一个部分，它描述了一个数据结构，它应该包含方法的参数名称，但这在编译接口时绝对不会使用。

在编译一个类时，我无法判断是否使用了提到的数据结构，或者 Eclipse 是否从方法体内参数的使用情况推断出参数名称。专家可以澄清这一点，但我认为这并不重要。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T13:17:04.067

要在类文件中保留名称以进行调试，请尝试项目属性、Java 编译器，然后“将变量属性添加到生成的类文件”（参见[Eclipse 帮助](http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/ref-preferences-compiler.htm)）。

编译以下源码：

```
public class StackOverflowTest {
    public void test(String foo, String bar) {
        // blah
    }
} 
```

被反编译成：

```
// Compiled from StackOverflowTest.java (version 1.5 : 49.0, super bit)
public class StackOverflowTest {

    // Method descriptor #6 ()V
    // Stack: 1, Locals: 1
    public StackOverflowTest();
        0  aload_0 [this]
        1  invokespecial java.lang.Object() [8]
        4  return
        Line numbers:
            [pc: 0, line: 1]
        Local variable table:
            [pc: 0, pc: 5] local: this index: 0 type: StackOverflowTest

    // Method descriptor #15 (Ljava/lang/String;Ljava/lang/String;)V
    // Stack: 0, Locals: 3
    public void test(java.lang.String foo, java.lang.String bar);
        0  return
        Line numbers:
            [pc: 0, line: 4]
        Local variable table:
            [pc: 0, pc: 1] local: this index: 0 type: StackOverflowTest
            [pc: 0, pc: 1] local: foo index: 1 type: java.lang.String
            [pc: 0, pc: 1] local: bar index: 2 type: java.lang.String
} 
```

请参阅参数名称保留在类文件中。

我建议您查看您的源代码是如何编译的，它是为哪个版本编译的等等。

**编辑：**

啊，我看到这对于接口来说是不同的——它们似乎没有可用于调试器的这些信息，我认为这是有道理的。我认为没有办法解决这个问题，如果您只想在编辑源代码时查看参数名称，则需要按照 Nagrom_17 的建议走 javadoc 路线（附加源代码）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T12:17:34.607

您不需要特别需要源来使 arg 名称出现在 Eclipse 中...如果您指定 Javadoc，Eclipse 将显示 args。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T12:26:10.080

使用调试支持进行编译可能会有所帮助，它将所有名称存储在 .class 文件中。

虽然我不知道 Eclipse 是否考虑到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T12:45:33.553

无论您使用什么 javac 选项，类文件数据结构都不支持将参数名称存储到任何方法。

为了在 IDE 中查看原始名称，您必须为它们提供 javadoc 或源代码。

如果您特别需要在运行时获取它们，则可以为参数添加注释，但您必须创建自己的注释，因为没有可使用的标准集。

抱歉不能再有帮助了

**编辑**：我完全纠正了......类文件格式确实有命名参数的空间（[JLS 4.7](http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#43817)）

我看不到的是你怎么能用它们来对付他们`java.lang.reflect.*`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T12:32:14.607

如果您在类文件中包含调试信息，Eclipse 将获取参数名称：`javac -g:vars`应该足够了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T12:32:52.237

您不需要单独的 Javadoc 文件，您可以在多行注释的第一个斜杠后使用带有两个星号 (*) 的特殊注释在 Eclipse 中创建“内联”javadocs。

示例代码：

```
 public class MyClass
{
 /**
  * documentation of your method
  * 
  * @param name    a String describing the name
  * @param options used to describe current option
  * @param query
  * @param comment
  * @return void
  */
    void myMethod(String name, String options, String query, String comment)
    {
        ...
    }
} 
```

# apache-flex - 如何从 HTTP 请求中获取错误响应？

> ID：939204
> 
> 赞同：1
> 
> 时间：2009-06-02T12:17:53.640
> 
> 标签：apache-flex, http, actionscript, networking

我尝试同时使用`HTTPService`和`URLRequest`/ `URLLoader`。但我不知道如何在服务器错误（如 500）的情况下获取响应输出或响应标头。一些帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T13:04:42.687

收听 HTTPStatusEvent 应该会为您提供正确的状态代码，但您将无法访问响应正文。

您需要通过套接字执行此操作。

[该项目](http://github.com/gabriel/as3httpclient/tree/master)通过套接字封装请求，使您可以访问状态代码、正文响应和其他细节（例如，发出 PUT 和 DELETE 请求）。

请注意，从 Flash Player 10 开始，使用套接字将需要有关跨域的额外步骤。

干杯

# ajax - 何时将 Ajax 与 Json 用于 Javascript 事件？

> ID：939211
> 
> 赞同：25
> 
> 时间：2009-06-02T12:19:10.937
> 
> 标签：ajax, json

我对 Ajax 不是很熟悉，但我一直听到有人提到 Json 作为某种竞争选项。是否有关于何时使用一种与另一种的规则？

我想在我的应用程序中处理 Javascript 事件并从应用程序动态更新前端，但我不确定是否需要为此使用 Ajax 或 Json。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-02T12:22:29.620

[Ajax](http://en.wikipedia.org/wiki/Ajax_(programming))和[JSON](http://json.org/)是非常不同的东西。

来自[Ajax（编程）](http://en.wikipedia.org/wiki/Ajax_(programming))：

> Ajax，有时写为 AJAX（异步 JavaScript 和 XML 的简写），是一组相互关联的 Web 开发技术，用于在客户端创建交互式 Web 应用程序或富 Internet 应用程序。使用 Ajax，Web 应用程序可以在后台异步地从服务器检索数据，而不会干扰现有页面的显示和行为。由于异步模式，Ajax 的使用增加了网页上的交互式动画和更好的 Web 服务质量。使用 XMLHttpRequest 对象检索数据。尽管名称如此，但实际上并不需要使用 JavaScript 和 XML，请求也不需要是异步的。

从[介绍 JSON](http://json.org/)：

> JSON（JavaScript Object Notation）是一种轻量级的数据交换格式。人类很容易阅读和写作。机器很容易解析和生成。它基于 JavaScript 编程语言标准 ECMA-262 第 3 版 - 1999 年 12 月的一个子集。JSON 是一种完全独立于语言的文本格式，但使用 C 系列语言的程序员熟悉的约定，包括 C 、C++、C#、Java、JavaScript、Perl、Python 等等。这些属性使 JSON 成为一种理想的数据交换语言。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-06-02T13:32:01.260

这是一些 JSON：

```
{ "taco" : "awesome", "burrito": "less awesome", "fishTaco": "1000" } 
```

在这种情况下，看起来很像一个数组。

您可以使用 AJAX 来获取 JSON。我经常用它来返回表数据。您可能已经在 javascript 中使用了类似 JSON 的数据，但没有意识到这一点。

我更喜欢请求 JSON 数据而不是 XML 或 HTML。我发现它比 XML 更容易处理，并且比 HTML 更灵活。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-06-02T12:21:58.077

JSON 不是 AJAX 的竞争技术，它只是一种数据格式。

您可能会听到 XML 和 JSON 之间的竞争，JSON 具有通常更轻且已经在本机 javascript 中的优势，XML 具有可移植性和工具集的优势。

* * *

[介绍 JSON](http://www.json.org/)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-06-02T12:38:14.673

正如一些人所说，这是完全不同的两件事。[AJAX](http://en.wikipedia.org/wiki/Ajax%5F%28programming%29)是一种使用 JavaScript 发起 HTTP 请求以获取数据的方法。这些数据可以是任何格式，但最常见的是 XML、HTML，当然还有 JSON。

因此，如前所述，[JSON](http://en.wikipedia.org/wiki/Json)是一种类似于 XML 或 CSV 的数据格式，只是具有一组不同的格式化规则。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-02T12:21:44.520

Json 只不过是一种通过 Ajax 方式与服务器通信的数据格式。

有些以xml的形式传输数据，有些只是纯文本，有些使用Json。

有关 Wikipedia 上 JSON 的更多信息：[http ://en.wikipedia.org/wiki/Json](http://en.wikipedia.org/wiki/Json)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-02T12:23:47.607

Ajax 和 JSON 不是一回事。Ajax 是一种结合轻量级异步请求和典型的 DOM 操作的技术，以便在 Web 应用程序中创建更丰富的用户界面。

Ajax 中的“X”通常表示“XML”，许多使用 Ajax 的站点使用 XML 作为服务器响应此类请求返回的数据格式。

JSON ( [http://json.org](http://json.org/) ) 是一种基于 Javascript 的对象表示法的轻量级数据交换格式。因此，在 Javascript 中很容易解析。与 XML 相比，它也少了很多冗长和重复。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-04-08T15:01:25.793

我想你可能在谈论 AJAX 与 JSONP

[http://en.wikipedia.org/wiki/Json#JSONP](http://en.wikipedia.org/wiki/Json#JSONP)

如果是这种情况，使用 JSONP 的一个好处是您可以绕过跨站点沙箱（尽管可能会引入新的安全风险）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-12-08T07:30:14.860

AJAX is used for get data from server, whereas JSON is just a data format which can used to send data to the server.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-10-24T17:35:15.290

我想我会从我的课堂讲座中提供这个比较

```
AJAX (Asynchronous JavaScript + XML) incorporates several technologies: 
```

*   使用 XHTML 和 CSS 的基于标准的表示；
*   使用文档对象模型（DOM）的动态显示和交互；
*   使用 XML 和 XSLT 进行数据交换和操作；
*   使用 XMLHttpRequest 进行异步数据检索；
*   JavaScript 将所有东西绑定在一起。

> JSON 是 JavaScript Object Notation 的缩写，是一种轻量级的数据交换格式。它的主要应用是在 AJAX Web 应用程序编程中，它可以替代使用 XML 格式在客户端和服务器之间进行数据交换。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-07-07T10:25:52.297

上面的答案是正确的，但是如果您是使用 Web 技术的新手，那么您只需要知道 Ajax 是 JavaScript 的一个子集。它是一种技术，是一种在用户与页面的其他部分交互时仅将部分网页数据发送回服务器以进行处理并获取响应的方法。这样，从用户的角度来看，与页面的交互是一致且无缝的。现在，另一方面，JSON 是您可以格式化发送回服务器并返回的数据（类似于 XML）的方式。它主要用于 Ajax。它的开发和使用主要是因为它是轻量级和人类可读的，这使得它更加高效和用户友好。希望有点帮助。

# c++ - “班级未注册”是哪个班级？

> ID：939215
> 
> 赞同：3
> 
> 时间：2009-06-02T12:20:29.267
> 
> 标签：c++, com, atl

考虑这段代码：

```
try {
    ISomeObject pObj(__uuidof(SomeClass));
    ISomeObject pObj2(__uuidof(SomeOtherClass));
} catch ( _com_error& e ) {
    // Log what failed
} 
```

即我有一段代码可以实例化我的对象。有时（安装错误）它会失败，因为某些类没有正确注册。（我没有特别的问题，在这里进行一般性的讨论。）

有没有办法，从捕获的异常或其他方面，意识到哪个类失败了？A 曾考虑制作一个我自己的包装器，它存储像*gLastCreateAttemptUuid*这样的变量，但感觉很麻烦。

此外，假设 SomeClass 反过来尝试实例化其他未注册的东西。然后可以找出根本问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T12:55:02.643

两者都不[`CComPtr::CreateInstance`](http://msdn.microsoft.com/en-us/library/fz0akhxa(VS.71).aspx) ```nor [`_com_ptr_t::CreateInstance`](http://msdn.microsoft.com/en-us/library/k2cy7zfz(VS.80).aspx) should throw an exception from what I can tell from the documentation. Both return an HRESULT value.```

 ``But if you check the `HRESULT` return value from each call, you should be able to determine which of the two classes are not registered (if that is the problem).` 

```
try {
    ISomeObject pObj, pObj2;
    HRESULT hr1 = pObj.CreateInstance(__uuidof(SomeClass));
    HRESULT hr2 = pObj2.CreateInstance(__uuidof(SomeOtherClass));
} catch ( _com_error& e ) {
    // Log what failed
} 
```` 

`Check out the documentation for [CoCreateInstance](http://msdn.microsoft.com/en-us/library/ms686615(VS.85).aspx)`用于返回值。

**更新：**如果您发现异常，请向我们展示它拥有的任何信息。如果是这种情况，那么我的猜测是您尝试实例化的类之一正在引发错误。如果异常没有任何信息，则通过这些行进行调试或将代码分成两个 try/catch 块将帮助您缩小哪一个块的范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:38:52.800

CoCreateInstance() 调用者有责任提供关于它试图实例化的内容的足够信息——ATL 和本机 COM 支持都没有内置功能。

您可以调用其 CreateInstance() 方法，而不是调用使用类 id 参数化的智能指针构造函数 - 它具有完全相同的参数集但不会引发异常。然后您可以检查 HRESULT 并处理错误并将您刚刚使用的类 ID 提供给错误处理程序。

但是，如果问题发生在您无法控制的代码中，它将无济于事。在极端情况下，您可以使用[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)来监控注册表查询并检测导致问题的类 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T20:05:28.943

我经常使用自己的 CoCreateInstance() 函数包装器，因此如果调用失败，我可以尝试使用 CLSID 从注册表中查找 ProgID。这样我至少可以将 CLSID 放入异常字符串中，但希望做得更好。我也为接口执行此操作，因为注册表中接口 IID 的默认字符串通常是人类可读的名称。查看 ::StringFromGUID2() 以格式化 GUID。

当然，这并不能帮助您以任何方式处理 3rd 方依赖项。为此，我会接受sharptooth 对ProcessMonitor 的建议（或者它的表亲RegMon）。

# c# - 在 Web 上预览 TIF 文档 (.Net C#)

> ID：939221
> 
> 赞同：2
> 
> 时间：2009-06-02T12:22:21.227
> 
> 标签：c#, asp.net

我正在寻找一种在网页上显示 TIF 文档的方法。它基本上需要在网页上以某种形式的容器呈现多页 TIF。

我需要一个控件还是有一种简单的方法来构建这样的东西？有没有我们可以简单实现的免费东西？

我查看了[Telerik 报告](http://www.telerik.com/products/reporting.aspx)产品，它显然包含一个 Tif 查看器。不过，我还没有研究过许可。（如果我只需要 TIF 查看器，是否需要购买整个报告解决方案？

我们目前最大的问题（像往常一样）是我们的截止日期非常紧迫，可用资源非常少。该产品将安装在客户端上，因此请求用户安装权限的 ActiveX 控件不太理想。

欢迎任何建议和/或意见。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T14:10:38.060

如果您想尝试自己制作（这将是很多工作），您可以使用 System.Drawing 命名空间将 TIF 图像转换为浏览器支持的格式，如 PNG 或 JPG，或第三方库，如[AbcPdf](http://www.websupergoo.com/abcpdf-1.htm)按照 Lazarus 的建议转到 PDF。这里的问题是，您必须创建一个用于放大、裁剪和多页支持的工具集，以及您想要的任何其他工具集并对其进行编码，这可能需要大量编码（除非您使用 PDF 和依赖于 Adob​​e Reader）。此外，如果您要处理大型 TIF 文件或不支持的格式，服务器端转换的速度可能会令人望而却步。

就供应商解决方案而言，我不知道有什么好的免费查看插件。R Ubben 是对的；Snowbound 的查看器很好，但如果我记得，AJAX 版本需要它自己的网站，您将图像传递给它，然后将其呈现给客户端，这可能会带来一些安全问题（无论如何都会在我的嘴里留下不好的味道） . [Atalasoft](http://www.atalasoft.com/products/dotimage/documentimaging/default.aspx)有一个出色的 AJAX 图像查看器和一个非常强大的图像 SDK，但它确实有点贵。我现在的公司已经选择了 Pegasus Imaging（最近与 Accusoft 合并）的一个名为[Prizm Viewer的 ActiveX 插件](http://www.accusoft.com/prizmviewer.htm). 查看器本身非常强大，可以处理多种图像格式，并且可以编写脚本。它确实有缺点（除了作为 ActiveX 控件之外）。我们的桌面部署遇到了一些问题，因为默认安装只会推送当前用户而不是本地计算机，但我们已经通过安装后注册表黑客修复了这个问题。

我想说的是，如果您有钱并且想要一个强大的成像解决方案，请选择 Atalasoft。否则，Pegasus 相当便宜并且工作得很好，除非您对 ActiveX 有严重的反感。还有很多其他选择，这只是你有多少钱和你想做多少编码的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:45:43.053

使用库服务器端将 TIF 转换为 PDF（假设它是大多数人都拥有的常用插件），这样就无需安装另一个，将 TIF 的每一页转换为 GIF 或 JPG 并呈现这些，再次得到浏览器的完全支持，无需额外的插件。

您可能可以即时进行此转换，然后缓存输出以减少后续加载时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T18:04:09.600

有一个很好的免费查看器，它有一个适用于 IE 的 ActiveX 版本和一个适用于 Firefox 的 Mozilla 插件。 [替代品](http://www.alternatiff.com/)。它是免费的，但需要相当轻松的注册。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-31T12:27:21.163

@R乌本

感谢您提及我们的 AJAX 应用程序！有一个 ajax 文档查看应用程序 VirtualViewer 的实时版本，可从[http://ajaxdocumentviewers.com](http://ajaxdocumentviewers.com/)获得，并且可以免费试用下载。VirtualViewer 可能过于简单地在 Web 上查看 TIFF 图像 - 取决于您组织的规模 - 因此我们还提供 RasterMaster SDK，以便您可以构建自己的文件转换和查看应用程序。

道格

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:53:43.413

Snowbound Software 有一个相当不错的图像查看器。它不使用 ActiveX。显示 tiff 并不难，但有时您需要一些快速的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-19T17:57:28.727

我使用 Adeptol 的 AJAX 文档查看器来做同样的事情。效果很好且易于实施。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-18T19:17:26.193

我只是在寻找相同的..

发现这个：

[http://www.neodynamic.com/demo-faq/imagedraw-aspnet/imagedraw-aspnet-multipage-tiff-viewer-sample.aspx](http://www.neodynamic.com/demo-faq/imagedraw-aspnet/imagedraw-aspnet-multipage-tiff-viewer-sample.aspx)

希望它可以帮助，否则如果你发现更好的东西，请通过收件箱告诉我:)

# .net - 显示被鼠标光标拖动的图标？

> ID：939225
> 
> 赞同：0
> 
> 时间：2009-06-02T12:22:55.267
> 
> 标签：.net, mouse, gdi

我想让我的用户拖动几个界面项。目前，似乎只能使用 Cursor.Draw 方法直接绘制到图形对象。我希望能够显示在屏幕上拖动的项目，以拖动 Windows 图标（如文件夹）的方式，可以从一个窗口拖动到另一个窗口以及在任务栏上拖动，等等。dotnet 框架是否提供了执行此操作的能力，还是需要大量挂钩到可怕的 Windows API 函数？

编辑：我希望在拖动东西时能够看到我拖动的东西的图像显示在鼠标光标旁边。我希望能够将项目拖到窗口外，并继续在鼠标光标旁边显示它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T12:42:17.443

我想知道这是否有用： [Drag and Drop in Windows Forms - A Primer](http://www.developerfusion.com/article/2692/drag-and-drop-in-windows-forms-a-primer/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T12:30:24.067

我们在 SO 中有一个类似的问题。[用鼠标移动图片框](https://stackoverflow.com/questions/570582/move-a-picturebox-with-mouse)。您可以使用相同的东西 (?) 。将您的图标保留在图片框中，并让用户移动它。

# vba - 如何在 VBA（Excel）中以毫秒为单位获取 DateDiff-Value？

> ID：939230
> 
> 赞同：21
> 
> 时间：2009-06-02T12:24:44.217
> 
> 标签：vba, excel, datediff

我需要以毫秒为单位计算两个时间戳之间的差异。不幸的是，VBA 的 DateDiff 函数不提供这种精度。有什么解决方法吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-06-02T12:35:20.530

您可以使用[此处](http://www.tek-tips.com/faqs.cfm?fid=2292 "这里")描述的方法如下：-

创建一个新的类模块，`StopWatch` 将以下代码放入`StopWatch`类模块中：

```
Private mlngStart As Long
Private Declare Function GetTickCount Lib "kernel32" () As Long

Public Sub StartTimer()
    mlngStart = GetTickCount
End Sub

Public Function EndTimer() As Long
    EndTimer = (GetTickCount - mlngStart)
End Function 
```

您使用以下代码：

```
Dim sw as StopWatch
Set sw = New StopWatch
sw.StartTimer

' Do whatever you want to time here

Debug.Print "That took: " & sw.EndTimer & "milliseconds" 
```

其他方法描述了 VBA 计时器功能的使用，但这仅精确到百分之一秒（厘秒）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-02T18:58:19.273

如果您只需要以 Centiseconds 为单位的时间，那么您不需要 TickCount API。您可以只使用所有 Office 产品中存在的 VBA.Timer 方法。

```
Public Sub TestHarness()
    Dim fTimeStart As Single
    Dim fTimeEnd As Single
    fTimeStart = Timer
    SomeProcedure
    fTimeEnd = Timer
    Debug.Print Format$((fTimeEnd - fTimeStart) * 100!, "0.00 "" Centiseconds Elapsed""")
End Sub

Public Sub SomeProcedure()
    Dim i As Long, r As Double
    For i = 0& To 10000000
        r = Rnd
    Next
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T01:56:15.787

GetTickCount 和 Performance Counter 是必需的，如果你想去微秒。对于毫秒，你可以使用这样的东西。

```
'at the bigining of the module
Private Type SYSTEMTIME  
        wYear As Integer  
        wMonth As Integer  
        wDayOfWeek As Integer  
        wDay As Integer  
        wHour As Integer  
        wMinute As Integer  
        wSecond As Integer  
        wMilliseconds As Integer  
End Type  

Private Declare Sub GetLocalTime Lib "kernel32" (lpSystemTime As SYSTEMTIME)  

'In the Function where you need find diff
Dim sSysTime As SYSTEMTIME
Dim iStartSec As Long, iCurrentSec As Long    

GetLocalTime sSysTime
iStartSec = CLng(sSysTime.wSecond) * 1000 + sSysTime.wMilliseconds
'do your stuff spending few milliseconds
GetLocalTime sSysTime ' get the new time
iCurrentSec=CLng(sSysTime.wSecond) * 1000 + sSysTime.wMilliseconds
'Different between iStartSec and iCurrentSec will give you diff in MilliSecs 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-15T19:53:45.297

如果`Timer()`精度足够，那么您可以通过将日期和时间与毫秒相结合来创建时间戳：

```
Function Now2() As Date

    Now2 = Date + CDate(Timer / 86400)

End Function 
```

要以毫秒为单位计算两个时间戳之间的差异，您可以减去它们：

```
Sub test()

    Dim start As Date
    Dim finish As Date
    Dim i As Long

    start = Now2
    For i = 0 To 100000000
    Next
    finish = Now2
    Debug.Print (finish - start) & " days"
    Debug.Print (finish - start) * 86400 & " sec"
    Debug.Print (finish - start) * 86400 * 1000 & " msec"

End Sub 
```

对我来说，该方法的实际精度约为 8 毫秒（顺便说一句`GetTickCount`，甚至更糟 - 16 毫秒）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-04T14:42:36.887

您还可以使用`=NOW()`在单元格中计算的公式：

```
Dim ws As Worksheet
Set ws = Sheet1

 ws.Range("a1").formula = "=now()"
 ws.Range("a1").numberFormat = "dd/mm/yyyy h:mm:ss.000"
 Application.Wait Now() + TimeSerial(0, 0, 1)
 ws.Range("a2").formula = "=now()"
 ws.Range("a2").numberFormat = "dd/mm/yyyy h:mm:ss.000"
 ws.Range("a3").formula = "=a2-a1"
 ws.Range("a3").numberFormat = "h:mm:ss.000"
 var diff as double
 diff = ws.Range("a3") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-01T08:37:38.430

很抱歉唤醒这篇旧帖子，但我得到了一个答案：
为毫秒编写一个函数，如下所示：

```
Public Function TimeInMS() As String
TimeInMS = Strings.Format(Now, "HH:nn:ss") & "." & Strings.Right(Strings.Format(Timer, "#0.00"), 2) 
End Function 
```

在您的子程序中使用此功能：

```
Sub DisplayMS()
On Error Resume Next
Cancel = True
Cells(Rows.Count, 2).End(xlUp).Offset(1) = TimeInMS()
End Sub 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-02T12:49:52.233

除了 AdamRalph ( `GetTickCount()`) 描述的方法之外，您还可以这样做：

*   使用`QueryPerformanceCounter()`和`QueryPerformanceFrequency()`API 函数
    [如何测试 VBA 代码的运行时间？](https://stackoverflow.com/questions/198409/how-do-you-test-running-time-of-vba-code)
*   或者，对于无法访问 Win32 API（如 VBScript）的环境，请访问：
    [http](http://ccrp.mvps.org/) ://ccrp.mvps.org/ （查看“高性能计时器”可安装 COM 对象的下载部分。它们是免费的。）

# java - 如何映射嵌套集合 Map >，使用休眠 JPA 注释？

> ID：939235
> 
> 赞同：15
> 
> 时间：2009-06-02T12:26:18.193
> 
> 标签：java, hibernate, collections, jpa, annotations

我有一堂课，我不知道如何正确注释。

我对 Holder::data 的目标：

*   列表不应该通过比较器而是通过数组中元素的自然顺序来保持顺序。（如果有帮助，它可以是一个 ndx 列。）
*   Holder 将拥有对数据的唯一引用，因此 Cascade all 可能也适用。

我也对移除地图的不同设计持开放态度，如果这样可以使设计更简洁。

```
@Entity
public class Holder extends DomainObject {
  private Map<Enum,List<Element>> data;
}

@Entity
public class Element extends DomainObject {
  private long valueId;
  private int otherData;
}

@Mappedsuperclass
public class DomainObject {
 // provides id
 // optimistic locking
 // create and update date
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T18:14:47.310

I don't think it is possible with hibernate(-core) to map any collection of collections:

> Collections may contain almost any other Hibernate type, including all basic types, custom types, components, and of course, references to other entities.

(from [the official doc](http://docs.jboss.org/hibernate/stable/core/reference/en/html/collections-mapping.html#collections-elements))

Notice the **almost** and the omission of the collection type.

A workaround: You need to introduce a new type 'in between' the collection holder and the element. This type you can map as an entity or a component and it refers the original content of the map, in this case a list.

Something like:

```
@Entity
public class Holder extends DomainObject {
  @OneToMany
  private Map<Enum,InBetween> inBetweens;
}

@Entity
public class InBetween extends DomainObject {
  @OneToMany
  private List<Element> elements;
}

@Entity
public class Element extends DomainObject {
  private long valueId;
  private int otherData;
}

@Mappedsuperclass
public class DomainObject {
 // provides id
 // optimistic locking
 // create and update date
} 
```

The rest of the mapping depends on your particular situation, but is rather straightforward.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T04:21:51.127

这是一个关于hibernate集合集合的博客[http://blog.xebia.com/2007/10/05/mapping-multimaps-with-hibernate/](http://blog.xebia.com/2007/10/05/mapping-multimaps-with-hibernate/)

希望它会有所帮助。它帮助了我。

问候，安东

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-04-16T20:24:14.190

请注意，Hibernate 文档的引用链接似乎已过时，我发现以下工作：[http ://docs.jboss.org/hibernate/core/3.5/reference/en/html/collections.html](http://docs.jboss.org/hibernate/core/3.5/reference/en/html/collections.html)

# command-line - 在 tcsh 中使用 $EDITOR 编辑命令行

> ID：939241
> 
> 赞同：4
> 
> 时间：2009-06-02T12:28:46.893
> 
> 标签：command-line, editing, tcsh

今天的[每日 Vim](http://dailyvim.blogspot.com/2009/06/easier-command-line-editing.html "Daily Vim：更简单的命令行编辑")是这样说的：

> 假设您使用的是 bash shell，在编写长命令行时，以下内容可能会有所帮助。
> 
> 开始在命令行上键入，然后键入 Ctrl-x Ctrl-e，它应该会将您放入系统的默认编辑器（希望是 Vim）并允许您从那里编辑命令行。完成后，保存命令行，bash 将运行该命令。

有没有办法在**tcsh**中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-29T18:21:52.147

给外行的一点解释。

```
bindkey -v 
```

让你进入 vi 模式（哦，是的！）

从那里击球`v`会带你到`$EDITOR`——从那里开始，世界一切都好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T13:00:51.820

嗯... IIRC，tcsh 使用一个名为`bindkey`. `bindkey -v`在命令行尝试。然后命中逃跑紧随其后`v`。自从我使用 tcsh 以来已经有一段时间了，所以细节有点模糊。如有疑问，[请谷歌](http://www.google.com/search?q=tcsh+manual+page+bindkey)。

# python - 列表的打印表示

> ID：939243
> 
> 赞同：0
> 
> 时间：2009-06-02T12:28:59.343
> 
> 标签：python

我想以这种方式将列表格式化为字符串： `[1,2,3] => '1 2 3'`. 这该怎么做？Python 中是否有任何可自定义的格式化程序作为 Common Lisp 格式？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T12:31:11.957

```
' '.join(str(i) for i in your_list) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-02T13:01:16.873

```
' '.join(str(i) for i in your_list) 
```

首先，将任何元素转换为字符串，然后将它们连接成唯一的字符串。

# java - WebSphere 中跨 JVM 的会话复制

> ID：939253
> 
> 赞同：5
> 
> 时间：2009-06-02T12:31:57.137
> 
> 标签：java, session, replication, websphere

我们设置了一个基础设施，其中网络服务器是集群的，而应用程序服务器不是。Web 服务器根据循环策略将请求路由到应用程序服务器。

在这种情况下，一个应用程序服务器中可用的会话数据在另一个应用程序服务器中不可用。无论如何，是否可以在第二个应用程序中提供来自第一个应用程序服务器的会话数据？这两个应用程序服务器是不同单元中物理上独立的盒子。

一种方法可能是使用数据库 - 是否有任何其他方法可以完成此会话复制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T09:19:30.013

在 WebSphere 中，基本上有两种复制会话数据的方法：

1.  持久化到数据库
2.  内存到内存传输

哪一个适合你的需求很大程度上取决于你的应用场景：

当所有应用程序服务器都出现故障时，会话数据的持久性有多重要？您同时拥有多少个会话对象？

在数据库中，您可以毫无问题地存储许多会话，另一个选项始终是可用内存量的问题。

如果您已经设置了一个所有应用程序服务器无论如何都使用的数据库，我会使用数据库。

这是指向[WebSphere 信息中心](http://publib.boulder.ibm.com/infocenter/wasinfo/v6r1/index.jsp?topic=/com.ibm.websphere.base.doc/info/aes/ae/tprs_sep1.html)的链接，其中包含必要的详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-07T04:21:36.363

一种明显的解决方案是启用应用程序服务器的集群。我假设从你提出问题的方式来看，你已经拒绝了这个选项。另一种选择是更改 Web 服务器使用的路由以使用会话亲和性（同一会话的请求转到同一应用服务器）。

除此之外，我会支持dertoni的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T12:50:57.817

也许你可以看看“兵马俑”。它是一个缓存框架，可以缓存会话并在单独的服务器上运行

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-13T13:19:28.710

WebSphere 中有两个集群选项，会话复制或数据库。如果您有大型会话对象，则最好使用数据库，因为它允许您将陈旧的会话卸载到磁盘。如果它们随后被表示，那么它们可以从数据库中提取，如果您使用会话复制，那么这些会话不仅需要保留在目标服务器的内存中，还需要保留在复制组中的其他服务器上。对于大型会话，这可能会导致内存不足的情况。

通过数据库会话处理，它也非常可定制，并且在我使用它的环境中性能并不明显。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T22:32:29.430

don't forget oracle coherence.

# php - 如何使用 PHP、HTML 等从多个页面中选择项目？

> ID：939259
> 
> 赞同：1
> 
> 时间：2009-06-02T12:33:40.517
> 
> 标签：php, html, checkbox

在我正在处理的网站上，我正在显示来自数据库查询的结果。每个页面显示 15 个结果，因此如果查询返回 45 个结果，它们将显示在 3 个单独的页面上，每个页面包含 15 个结果。

我希望用户能够从第一页中选择任意数量的项目，然后切换到其他页面并从这些页面中选择项目，同时仍然记住在第一页上选择的项目。（最终，当用户选择了所有项目时，他将单击提交按钮。）因此，如果用户导航回第一页，他检查的项目应该显示为被选中。在我在 Web 上看到的页面上，当用户导航回第一页时，所有复选框都会再次被清除（这不是我想要的）。

关于实现这一目标的最佳方法的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T12:38:45.767

记住页面之间的选择意味着您有一些需要存储在某处的状态。有多种方法可以做到这一点，但归结为其中一种......

1.  将其保存在客户端（例如 cookie）
2.  将其保存在服务器上（例如在数据库中）
3.  继续向前和向后发送（例如隐藏的表单字段，如在 ASP.NET 视图状态中）

PHP 和 ASP.NET 等平台提供的一个常见抽象是“会话”的概念。会话状态的实际实现可能是上述 3 种可能性的某种组合，它可能提供了最简单的途径。我建议您查看 PHP 中的会话状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T12:35:56.443

使用隐藏输入来继承前一组的结果

```
<!-- hidden fields -->
<input type='hidden' name='whatever[]' value='whatever'/>

<!-- checkboxes -->
<input type='checkbox' name='whatever[]' value='whatever'/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T12:35:54.163

你可以做很多事情。

*   另存为 JavaScript cookie
*   每次单击时使用 AJAX 保存为会话
*   将每个页面隐藏为“选项卡”，以便它们实际上存在但未显示。

# sharepoint - Sharepoint Lists.asmx：请求失败，响应为空

> ID：939266
> 
> 赞同：4
> 
> 时间：2009-06-02T12:36:08.453
> 
> 标签：sharepoint, list

我正在编写一个非常小的应用程序来创建和测试共享点的 caml 查询。在执行 GetListItems 方法时，我收到以下异常；

```
System.Net.WebException: "The request failed with an empty response." 
```

该服务位于 https 地址 (ssl)。我将服务设置如下；

```
result = new ListService.Lists();
result.Url = siteUrl;
result.Credentials = new NetworkCredential(txtUserName.Text, txtPassword.Text, txtDomain.Text); 
```

我调用 GetListItems() 方法如下；

```
xmlResult = spList.GetListItems(listName, string.Empty, camlQuery, null, string.Empty, null, string.Empty); 
```

我试图找出为什么我收到空结果消息。我也尝试过其他方法（即 GetListCollection），但无济于事。

起初我认为问题可能是 URL（http 而不是 https），但事实并非如此。我什至用wireshark检查了它，以确保使用了正确的URL。

有人遇到过这个问题吗？你是怎么解决的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T10:52:50.777

我的天啊...！毕竟我已经解决了。发布此问题后，我尝试获取 wsdl 检查服务本身。当我通过 Internet Explorer 检查时，一切正常。当我尝试将其添加为 VS 中的参考时，它出错了。所以有些事情不太好。然后我突然想到我们公司网络有一个新的登录屏幕。

打了几通电话后，我知道了问题所在；IT Services 安装了一台 ISA 2006 服务器，然后“忘记”告诉我了。ISA 服务器正在阻止未知程序和/或客户端的 HTTPS 端口 (443) 上的所有流量。这就是为什么 Internet Explorer 向我展示了一个新的、闪亮的登录对话框。

# asp.net - 跨域 cookie 访问（或会话）

> ID：939268
> 
> 赞同：11
> 
> 时间：2009-06-02T12:36:58.390
> 
> 标签：asp.net, cookies, cross-domain, subdomain

虽然我意识到这通常与跨站点脚本攻击有关，但我想知道的是会话如何在属于单个域的多个子域中保持有效（例如：用户只登录一次，并且能够访问两者subdomain1.domain.com 和 subdomain2.domain.com 具有相同的会话）。我想我首先需要了解它是如何工作的，但到目前为止我还没有找到任何相关的东西。

但话又说回来，也许我没有问正确的问题。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-02T12:44:20.980

Inproc 会话不能保持有效，但是您可以编写 Web 应用程序以允许跨多个子域的 cookie。您需要将域设置为：

```
Response.Cookies("CookieName").Domain = ".mydomain.com" 
```

[记住时期。](http://www.15seconds.com/issue/971108.htm)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T12:57:19.940

有很多方法可以跨域共享会话数据或 cookie 数据。最简单的是通过共享数据存储在服务器端共享它。但如果这很容易，你就不会问这个问题了。

另一种方法同样简单。该域`one.com`包含一些会话数据`name=aleem`，`id=123`并希望将其传递给`two.com`. 它将遵循以下步骤：

1.  拨打电话`two.com/api/?name=aleem&id=123`
2.  当`two.com`通过查询参数获取数据时，它会使用数据创建一个 cookie。此 cookie 将存储在`two.com`域下。
3.  `two.com`然后将重定向回`REFERER`在这种情况下恰好是`one.com`

这是一个简化的场景。域`two.com`需要能够信任`one.com`，不仅如此，它还需要知道请求是真实的，而不仅仅是由用户制作的，因此您需要使用公钥/私钥来缓解这种情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T12:45:56.420

默认情况下，一个站点的所有 cookie 都存储在客户端上，并且所有 cookie 都与对该站点的任何请求一起发送到服务器。换句话说，站点中的每个页面都会获取该站点的所有 cookie。但是，您可以通过两种方式设置 cookie 的范围：

1.  将 cookie 的范围限制在服务器上的文件夹中，这允许您将 cookie 限制在站点上的应用程序中。
2.  **将范围设置为域，它允许您指定域中的哪些子域可以访问 cookie。**

[你可以在这里](http://msdn.microsoft.com/en-us/library/ms178194.aspx)了解更多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T12:52:05.770

关于为域设置 cookie 以允许子域接收该 cookie 的注释为您提供了这一方面，但缺少的是会话的一致性。

我认为这非常类似于在场中的服务器之间维护状态的问题，解决方案可能是确保您的会话存储在两个站点之间保持一致（如果它们不是来自 IIS 中同一个“网站”的服务器）。您可以将会话存储移动到 SQL Server（[如何：配置 SQL Server 以存储 ASP.NET 会话状态](http://support.microsoft.com/kb/317604)），这可能会达到目的，因为每个站点在查找与他们的 cookie 相关的会话数据时都会查询相同的存储。已提交。

我希望这能让你走上正轨。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T13:41:41.753

如果您有能力设置一个公共子域，您可以这样做：

在您的子域 html 文件中，在顶部包含一个 javascript 文件，如下所示：

```
<script src="http: //common.domain.com/check.asp"></script> 
```

在 check.asp 中，查找您的 logged_in cookie，如果不存在，则显示一个页面，例如[http://common.domain.com/login.asp](http://common.domain.com/login.asp)使用类似

```
<%
if (cookie_not_found){
%>
location.href = "http: //common.domain.com/login.asp";
<%
}
%> 
```

用户提交用户名密码后，将其提交回相同的 login.asp 并设置会话 cookie（将在 common.domain.com 域中设置），然后重定向到`http://subdomain1.domain.com`.

现在会发生的是，将对嵌入的“common.domain.com/check.asp”进行调用，common.domain.com 的 cookie 将与请求一起由浏览器发送。因此，即使您在 subdomain1.domain.com 中，您也会知道您的会话是否有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-18T12:30:55.540

这是一个有效的解决方案：

[http://anantgarg.com/2010/02/18/cross-domain-cookies-in-safari/](http://anantgarg.com/2010/02/18/cross-domain-cookies-in-safari/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T12:41:04.670

您可以为特定域设置 cookie。

在 php 中，[setCookie()](http://be.php.net/setcookie)方法包含一个参数，可以在其中指定顶级域，因此 cookie 对所有子域都有效。根据您的标签，我看到您正在使用 asp.net。可能这也存在于asp......

经过一番搜索asp：

尝试这个：

```
Response.Cookies("CookieName").Domain = ".mydomain.com" 
```

或阅读[此](http://www.15seconds.com/issue/971108.htm)

# jquery - jquery标题属性文字弹出隐藏

> ID：939270
> 
> 赞同：3
> 
> 时间：2009-06-02T12:37:08.217
> 
> 标签：jquery, attributes

我目前正在使用我的“a”标签的标题属性来显示和隐藏与此标签对应的图像。

但是，当您将鼠标悬停在“a”上时，会弹出烦人的标题文本。

我可以在不完全禁用标题属性的情况下禁用此弹出文本吗？任何帮助都很棒！

干杯，

丹克

- - -编辑 - - -

这是作为 xhtml strict 传递的工作代码！！！！

$(文档).ready(函数(){

```
$(\"ul.projects li a\").hover(
    function(){

    var largeAlt = $(this).attr(\"class\");

    $(\"ul.image_display li#image_hover img\").attr({ src: largeAlt }); 
    $(\"ul.image_display li#image_hover img\").fadeIn();

},
    function(){

    $(\"ul.image_display li#image_hover img\").attr({ src: \"\" }); 
    $(\"ul.image_display li#image_hover img\").fadeIn();

}); 
```

});

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T12:45:38.700

您可以尝试使用自己的自定义属性，而不是使用“title”属性。

```
<a customtagattribute="some value" id="link1" href="#">Linkety!</a> 
```

编辑：[JSON](http://en.wikipedia.org/wiki/JSON "JSON")键值对也可以这样使用-

```
var links = { "link1": "attribute value 1", "link2": "attribute value 2", ... }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T12:41:15.807

不是真的，这是浏览器应该表现的方式。如果要映射此数据，您可能需要建立一个单独定义映射的 Javascript 数据结构。我不确定是否有一种好的语义方式来建立这种关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T12:48:59.973

那么使用锚的 id 属性呢？如果包含图像的路径（即 ID 中不允许出现字符），您可以使用带有 ID 的 AJAX 请求来获取实际 URL（或实际图像）。

# clojure - 如何从 Clojure 中的序列中删除项目？

> ID：939278
> 
> 赞同：36
> 
> 时间：2009-06-02T12:39:02.503
> 
> 标签：clojure, sequences

首先，我假设每个特定于结构的序列都有不同的删除项目的方法：*向量*可以按索引，*List*可以首先或最后删除，*Set*应该传递要删除的实际项目，等等。

其次，我假设有一些与结构无关的移除方法；他们在*seq*接口上工作。

由于序列在 Clojure 中是不可变的，我怀疑您实际上在做的是制作原始的廉价副本，只是没有原始项目。这意味着列表理解可以用于删除，但我怀疑它会不必要地冗长。

请给出一些从 Clojure 序列中删除项目的不同方法的惯用示例。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-06-02T18:19:52.917

没有一个接口可以从 Clojure 的所有数据结构类型中删除内容，这可能是因为不同的性能特征。

```
(disj #{:foo :bar} :foo)       ; => #{:bar}
(dissoc {:foo 1 :bar 2} :foo)  ; => {:bar 2}
(pop [:bar :foo])              ; => [:bar]
(pop (list :foo :bar))         ; => (:bar) 
```

这些也有效（返回 a `seq`）：

```
(remove #{:foo} #{:foo :bar})      ; => (:bar)
(remove #{:foo} [:foo :bar])       ; => (:bar)
(remove #{:foo} (list :foo :bar))  ; => (:bar) 
```

这不适用于哈希映射，因为当您遍历映射时，您会得到键/值对。但这有效：

```
(remove (fn [[k v]] (#{:foo} k)) {:foo 1 :bar 2})  ; => ([:bar 2]) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-02T13:24:49.883

查看[Clojure 参考中的序列](http://clojure.org/sequences?responseToken=b8dc7d9da8cd2d78b7584e8633cacfc4)。 `filter`并且`remove`是你所寻求的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-12T18:05:48.330

作为布赖恩·卡珀回答的延伸。这取决于您将如何处理结果。如果您将结果传递给想要处理整个数据集（即打印它）的东西，那么习惯使用 seq 并使用 filter 或 remove 懒惰地解决问题。另一方面，如果您正在修改数据结构以保存以供以后使用，那么在其上创建 seq 将失去其有利的更新特性，因此在这种情况下，最好使用特定于该数据结构的更新函数。

# nunit - 运行 WatiN 测试时出现 InteropServices.COMException

> ID：939287
> 
> 赞同：4
> 
> 时间：2009-06-02T12:42:39.097
> 
> 标签：nunit, watin

当我在我们的构建服务器上运行 WatiN 测试时，它们都会抛出这个 InteropServices.COMException：

MyTestClassName.MyTestMethodName：System.Runtime.InteropServices.COMException：从 IClassFactory 创建 CLSID 为 {0002DF01-0000-0000-C000-000000000046} 的 COM 组件实例失败，原因是以下错误：80004005。

无论是通过 TeamCity 运行它们，还是使用 NUnit GUI (2.5) 以管理员身份在服务器上手动运行它们，我都会得到相同的结果。

这是一些示例代码：

```
[TestFixture]
public class MyTestClassName
{
    private string pageUrl;

    [TestFixtureSetUp]
    public void TestFixtureSetUp()
    {
        pageUrl = ConfigurationManager.AppSettings["SiteURL"] + "/Pages/MyPage.aspx";

        Settings.MakeNewIeInstanceVisible = false;
    }

    [Test]
    public void MyTestMethodName()
    {
        using (var ie = new IE(pageUrl))
        {
            ie.SelectList(new Regex(@"^*DropDownList1*$")).Option("TheOption").Select();

            ie.SelectList(new Regex(@"^*DropDownList2*$")).Option("AnOption").Select();

            ie.SelectList(new Regex(@"^*DropDownList3*$")).Option("OtherOption").Select();

        }
    }
} 
```

有什么想法吗？

/乔金

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-11-09T16:34:32.413

尝试以管理员身份运行 Visual Studio。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-17T07:52:04.027

我也遇到了同样的问题，但对我来说更奇怪。

我有一个服务器仅用于“UI 测试”并且对于许多应用程序 de WatiN 测试运行没有任何问题。

此错误仅发生在一个应用程序中，并且仅在 CruiseControl（使用 nant）中发生，但在使用 NUnitGUI 运行测试时不会发生...

今天早上我终于找到了一个解决方案：我替换了我`new IE();`对`new IE(true)` [WatiN 发行说明](http://watin.sourceforge.net/releasenotes-1-2-0-4000.html)的所有调用，并且不再收到错误消息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-07T15:44:30.637

另一个解决方法是“在 IE 中启用保护模式”，如此[处所述](http://www.jitbit.com/alexblog/234-watin-tests-fail-with-comexceptions-and-other-errors-fix/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-09T22:39:45.910

[另一条评论](https://stackoverflow.com/questions/939287/interopservices-comexception-when-running-watin-tests/1702169#1702169 "另一个评论")说：

> 尝试以管理员身份运行 Visual Studio

它实际上是 NUnit 需要以管理员身份运行（至少在 Windows 7 中），但想法是正确的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-11-04T18:07:51.950

每次 WatiN 调用 IE.Quit 时，IE 都会停止响应，然后尝试恢复。以管理员身份运行为我解决了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-09T03:39:07.020

我认为选择列表尚未完全加载并准备好，这是此问题中描述的同一问题的另一个症状：

[访问被拒绝错误（Visual Studio 和 WatiN）](https://stackoverflow.com/questions/959150/access-is-denied-error/)

# .net - 共享 XElement 作为 SiteMap

> ID：939295
> 
> 赞同：1
> 
> 时间：2009-06-02T12:44:57.920
> 
> 标签：.net, thread-safety, xelement

我有一个自定义 CMS，我在其中使用静态 XElement 作为站点地图。当地图发生更新时，我正在同步编写器线程，但对阅读器不做任何事情，只是让他们在需要时获取 XElement。

在测试中，我认为如果我从读取器线程枚举 XElement，而我在另一个写入线程上更新它，我会得到一个异常。事实并非如此。只是想知道是否有人可以向我解释他们是否发现这种方法有任何重大问题。它似乎不应该是安全的，但到目前为止我的所有测试都表明它是安全的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T12:52:53.537

使用 System.Threading.ReaderWriterLock 来控制对 XElement 的访问。这样，您就可以同步所有读取器和任何写入器，而不会阻塞并发读取活动。

# .net - 页面刷新时输入的点击方法按钮！

> ID：939305
> 
> 赞同：0
> 
> 时间：2009-06-02T12:47:19.447
> 
> 标签：.net, asp.net, web-applications, .net-2.0, page-lifecycle

我有一个 .net 2.0 应用程序，但我无法弄清楚为什么按钮的 onclick 方法在页面刷新时运行。

发生这种情况的确切情况是在单击按钮的每个项目上勾选一个复选框，并且 onclick 方法处理该项目，然后清除该复选框。现在，当页面由于某种原因被刷新时，按钮的 onclick 方法被输入到！

非常感谢任何帮助。

非常感谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T12:51:21.230

选中复选框的默认**Checked**属性。您可能在加载时将其设置为“已检查”。如果您发布代码，将能够为您提供更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T10:19:54.370

谢谢肖邦，

问题是表单中的复选框被选中，当页面刷新时，这会导致回发。

我通过将以下代码行放在按钮单击方法的末尾解决了这个问题： Response.Redirect(Request.Url.PathAndQuery);

# c# - C#通过反射从具体类获取委托（Func）实现？

> ID：939309
> 
> 赞同：1
> 
> 时间：2009-06-02T12:49:10.550
> 
> 标签：c#, attributes, delegates

抱歉对问题的解释不佳

完全重写问题

我有以下方法：

```
public TReturn FindCached<TSearch, TReturn>(Func<TSearch, TReturn> searchMethod) 
            where TSearch : ISearchSpecification
            where TReturn : class
        {
            SearchSpecification spec = new GetConcreteSearchSpecification<TSearch>();

            //insert magic here to get an attribute from the method on 
            //the spec class that searchMethod invokes on the line below

            return searchMethod(spec);
        } 
```

所以我有一个委托 ( `searchMethod`) 和一个对象 ( `spec`)，我想在其上调用委托。我想检查对象 ( `spec`) 以查找searchMethod 在调用时将调用**的方法的自定义属性。**

希望这更清楚。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:07:57.203

假设您打算`searchMethod`成为类型的变量`Func<TSearch, TReturn>`并且`mySearchSpec`作为 的某种实现`ISearchSpecification<TSearch>`，那么您基本上是在询问如何获取类的属性。

为此，请使用以下内容：

```
object[] attrs = typeof(mySearchSpec).GetCustomAttributes(false); 
```

假设`mySearchSpec`类型是公共的，否则您可能需要不同的重载`GetCustomAttributes`

**附录**：
根据您修改后的问题，获取实际使用类型上的方法的属性`spec`：

```
Type t = spec.GetType();
MethodInfo m = t.GetMethod("nameOfMethodToBeCalledHere");
object[] attrs = m.GetCustomAttributes(false); 
```

同样，请注意，您可能需要重载，`GetMethod`或者`GetCustomAttributes`取决于实际类的实现。

**注意：**
看起来您可能会要求 in 调用的方法`return searchMethod(spec);`，但那`searchMethod`根本不是某种方法`spec`。

如果您想要属性`searchMethod`（与 无关`spec`）：

```
MethodInfo m = searchMethod.Method;
object[] attrs = m.GetCustomAttributes(false); 
```

我认为现在涵盖了所有含义的排列...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-04T15:53:54.713

我遇到了类似的情况，jerryjvl 的回答正是我想要的。

我想创建一个通用的分析方法，在那里我可以计算某个方法运行的时间，并使用反射检索方法的名称以进行日志记录。

MethodInfo 是关键。

我有这样的方法：

```
public static bool TimeMethod(Func<bool> someMethod) 
```

然后稍后我想动态地获取它的名称或一些属性。

```
MethodInfo m = someMethod.Method;
object[] attrs = m.GetCustomAttributes(typeof(MonitoringDescriptionAttribute), true);
string name = m.Name; 
```

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-08T07:41:17.147

这是一个相当令人困惑的问题，让我们看看我是否正确：

*   您有一个名为`searchMethod`.
*   您有一个工厂模式生成的对象，名为`spec`

所以你有一个像这样的方法：

```
[MyCustomAttribute]
public RetClass MyMethod( SearchSpecification input ) {
    return input.GetRetClass();
} 
```

你调用这个方法：

```
var result = FindCached( MyMethod ); 
```

在`FindCached`你想找到`MyCustomAttribute`的情况下 - 在这种情况下@jerryjvl 的答案是正确的。

你的问题是你也可以这样做：

```
var result = FindCached( x => x.GetRetClass() ); 
```

根据您的描述，我不确定它是否`x.GetRetClass()`是您真正想要的属性。在这种情况下，您需要使用表达式将 lambda 分解，但我不建议这样做 - 更复杂的 lambda 声明将导致匿名委托，当您尝试在运行时解析它时，它是一个黑盒。

相反，无论如何您都在使用反射，因此传递所需方法的名称而不是委托引用可能更容易：

```
var result = FindCached( "GetRetClass" ); 
```

# javascript - Google Analytics 在动态创建的模式窗口中执行

> ID：939315
> 
> 赞同：0
> 
> 时间：2009-06-02T12:51:20.687
> 
> 标签：javascript, dom, google-analytics, modal-dialog

当用户单击链接或提交表单时，我正在使用 JavaScript 创建一个模式窗口。如果用户单击链接，模态窗口会保存一个表单，或者当用户提交注册表单时会保存一个感谢页面。模态窗口使用 填充`innerHTML`。

我遇到的问题是这些模式窗口的源代码中有 Google Analytic 标签。由于某些奇怪的原因，Google Analytics 没有执行。我试图将实际的 ga.js 源代码放入页面中，但没有成功。我已将 Analytics 代码放在两个单独的文件中，但这也不起作用。

有人遇到过这个问题吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T12:54:47.853

不要`script`使用添加标签`.innerHTML`。直接从 javascript 中触发`pageTracker._trackPageview()`，如[Google Analytics API中所述](http://code.google.com/apis/analytics/docs/gaJS/gaJSApi.html#_gat.GA_Tracker_._trackPageview)

# emacs - 如何知道一个缓冲区位置对应的行号？

> ID：939317
> 
> 赞同：10
> 
> 时间：2009-06-02T12:51:43.757
> 
> 标签：emacs, buffer

当 Emacs 报告错误时，它总是显示带有缓冲区位置的代码，用它来找出确切的单词所在的位置非常不方便。

有什么方法可以知道缓冲区位置的确切行号吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-02T12:58:36.100

*   `C-x =`绑定到`what-cursor-position`; 显示当前位置。

*   `C-x l`绑定到`count-lines-page`; 显示页面上的点前后有多少行，以及页面上的总行数（其中“页面”跨越两个分页符号之间的行`^L`）。

*   `M-x`绑定到`what-line`; 显示当前行的行号（和缩小的点的行号，如果适用）。

但我认为你想要的是

`M-x` `goto-char` `RET` `<pos>`

这使您可以转到`<pos>`当前缓冲区中的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:00:30.010

看来您需要转到行：Mg g

缓冲区位置的确切行号显示在 Emacs 缓冲区的状态行中。

# sql - 使用 Word 文档作为 SSRS 报告的模板？

> ID：939321
> 
> 赞同：1
> 
> 时间：2009-06-02T12:52:52.070
> 
> 标签：sql, sql-server, pdf, reporting-services, ms-word

问候。

我有一些 Word 文档需要在发生某些事情时作为通知发送。我必须从我们的 SQL Server 数据库中填写 10 个左右的参数。请注意，我不需要将它们作为 word 文档发送，PDF 就可以了 - 我只是以 .docx 形式获得它们。

现在，我立即认为 SSRS 是通往这里的路。现在我已经花了一些时间使用文本框控件并且它缺少格式（SQL2005），我不太确定。

有人有更好的方法来解决这个问题吗？现在我正在使用大量的文本框，因为我必须将某些内容加下划线，将某些内容加粗，以及所有需要填充的参数。

一定有更好的解决方案。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T03:18:39.043

Reporting Services 是否适合这项工作？[您可以使用Visual Studio Tools for Office](http://www.microsoft.com/downloads/details.aspx?FamilyID=F5539A90-DC41-4792-8EF8-F4DE62FF1E81&displaylang=en)轻松自动化 Word 2007 ，与您的数据进行合并并邮寄出实际文档或它们的 PDF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:29:29.437

我自己没有尝试过，但这[可能](http://blogs.digineer.com/blogs/jasons/archive/2006/10/03/520.aspx)值得一看。

# asp.net - 如何阻止页面在网络表单中变得过于臃肿

> ID：939323
> 
> 赞同：2
> 
> 时间：2009-06-02T12:53:11.213
> 
> 标签：asp.net, design-patterns, webforms

我有一个连接到 Web 服务的 ASP.net webforms 应用程序，所有功能都在一个具有许多不同状态的页面上，我使用多视图根据当前状态显示正确的 html。

问题是页面很大而且很笨拙。后面的代码还不错，但是 aspx 页面只是失控了。

我想为每种可能的状态设置一个单独的页面，但找不到在页面之间移动和传递数据的好方法。我可以实施任何可以帮助解决此问题的模式或实践吗？如果每个州都有一个页面不是可行的方法，我还能做什么？

我必须坚持使用 webforms 平台 :( 所以我不能迁移到 MVC。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T12:56:16.307

您需要查看[Cross Page Posting](http://msdn.microsoft.com/en-us/library/ms178139.aspx)。这将允许您回发到不同的 url，并且仍然可以访问上一页的控件。这将使您的不同视图的分离更容易管理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T12:56:01.767

您可以为每个状态创建一个自定义控件，然后以编程方式实例化适当的控件并在运行时填充属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T13:06:58.657

使用[用户控件](http://msdn.microsoft.com/en-us/library/y6wb1a0e.aspx)或[自定义控件](http://www.15seconds.com/Issue/040421.htm)来减少页面重量并提高 Web 表单的可维护性。

# c# - 以编程方式创建 SharePoint 列表

> ID：939324
> 
> 赞同：2
> 
> 时间：2009-06-02T12:53:12.477
> 
> 标签：c#, visual-studio-2010, sharepoint, sharepoint-2010

我为 Office 产品下载了一个插件，它会提示您输入 SharePoint 网站 url 以及用户名和密码，然后它将在您的 SharePoint 网站上为您创建适当的列表和视图。有人可以告诉我是否可以在我的 Windows XP 机器上制作一个程序，该程序将接收站点 URL、用户名和密码并能够以编程方式创建列表和视图？

我在谷歌上做了一些搜索，似乎这需要在 SharePoint 服务器上完成。我无权访问服务器，需要从我的 XP 机器上进行开发。看到插件完全符合我的要求，这给了我一些希望。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T13:23:28.327

您将希望了解通过其[Web 服务](http://msdn.microsoft.com/en-us/library/ms479390.aspx)访问 SharePoint 。特别是[Lists Web Service](http://msdn.microsoft.com/en-us/library/lists.aspx)和[Views Web Service](http://msdn.microsoft.com/en-us/library/views.aspx)。这是列表服务中的[Lists.AddList](http://msdn.microsoft.com/en-us/library/lists.lists.addlist.aspx)方法 - 应该让您走上正确的道路。

# javascript - 执行存储为字符串的 JavaScript 代码

> ID：939326
> 
> 赞同：214
> 
> 时间：2009-06-02T12:54:36.543
> 
> 标签：javascript

如何执行一些作为字符串的 JavaScript？

```
function ExecuteJavascriptString()
{
    var s = "alert('hello')";
    // how do I get a browser to alert('hello')?
} 
```

* * *

## 回答 #1

> 赞同：281
> 
> 时间：2009-06-02T12:57:26.383

使用该[`eval`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval)功能，例如：

```
eval("my script here"); 
```

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2012-03-14T12:56:30.047

您可以使用函数执行它。例子：

```
var theInstructions = "alert('Hello World'); var x = 100";

var F=new Function (theInstructions);

return(F()); 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2009-06-02T12:56:07.337

该[`eval`函数](http://www.w3schools.com/jsref/jsref_eval.asp)将评估传递给它的字符串。

但是使用[`eval`可能很危险](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/eval#Don%27t_use_eval_needlessly!)，所以请谨慎使用。

**编辑：** annakata 有一个好处——不仅`eval` ***危险***，而且很 ***慢***。这是因为要评估的代码必须在现场解析，这样会占用一些计算资源。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-06-02T12:56:14.233

使用 eval()。

[W3 学校 eval 之旅](http://www.w3schools.com/jsref/jsref%5Feval.asp)。网站有一些可用的 eval 示例。[Mozilla 文档对此进行了详细介绍。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval)

您可能会[收到很多](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval#Don%27t_use_eval_needlessly!)关于安全使用它的警告。**不允许用户向 eval() 注入任何东西**，因为这是一个巨大的安全问题。

**您还想知道 eval() 具有不同的[范围](http://piecesofrakesh.blogspot.com/2008/10/understanding-eval-scope-spoiler-its.html)。**

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2019-03-08T02:47:51.800

对于使用 node 并且关心`eval()`nodejs 提供的上下文含义的用户`vm`。它创建了一个 V8 虚拟机，可以在单独的上下文中对代码的执行进行沙箱化处理。

更进一步的是`vm2`，它`vm`允许 vm 运行不受信任的代码。

*   [https://nodejs.org/api/vm.html](https://nodejs.org/api/vm.html) - 官方 nodejs/vm

*   [https://github.com/patriksimek/vm2](https://github.com/patriksimek/vm2) - 扩展 vm2

```
const vm = require('vm');

const x = 1;

const sandbox = { x: 2 };
vm.createContext(sandbox); // Contextify the sandbox.

const code = 'x += 40; var y = 17;';
// `x` and `y` are global variables in the sandboxed environment.
// Initially, x has the value 2 because that is the value of sandbox.x.
vm.runInContext(code, sandbox);

console.log(sandbox.x); // 42
console.log(sandbox.y); // 17

console.log(x); // 1; y is not defined. 
```

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2010-01-29T09:14:40.153

试试这个：

```
 var script = "<script type='text/javascript'> content </script>";
  //using jquery next
  $('body').append(script);//incorporates and executes inmediatelly 
```

就个人而言，我没有测试它，但似乎工作。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2018-12-18T02:55:37.673

```
new Function('alert("Hello")')(); 
```

我认为这是最好的方法。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2016-07-27T16:56:59.397

有点像*@Hossein Hajizadeh* alerady 所说的，虽然更详细：

有一个替代方案`eval()`。

该函数`setTimeout()`旨在在毫秒间隔后执行某些操作，而要执行的代码恰好被格式化为字符串。

它会像这样工作：

```
ExecuteJavascriptString(); //Just for running it

function ExecuteJavascriptString()
{
    var s = "alert('hello')";
    setTimeout(s, 1);
}
```

`1`意味着它将在执行字符串之前等待 1 毫秒。

这可能不是最正确的方法，但它确实有效。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2015-11-09T09:40:44.890

在许多复杂和混淆的脚本上检查了这一点：

```
var js = "alert('Hello, World!');" // put your JS code here
var oScript = document.createElement("script");
var oScriptText = document.createTextNode(js);
oScript.appendChild(oScriptText);
document.body.appendChild(oScript); 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-06-02T12:58:34.213

使用[eval](http://www.w3schools.com/jsref/jsref%5Feval.asp)如下。eval 应该谨慎使用，关于“ [eval is evil](http://www.google.com/search?q=eval%20is%20evil) ”的简单搜索应该会抛出一些指针。

```
function ExecuteJavascriptString()
{
    var s = "alert('hello')";
    eval(s);
} 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2014-08-09T07:57:24.767

如果您想在特定时间后执行特定命令（即字符串） - cmd=您的代码 - InterVal=delay to run

```
 function ExecStr(cmd, InterVal) {
    try {
        setTimeout(function () {
            var F = new Function(cmd);
            return (F());
        }, InterVal);
    } catch (e) { }
}
//sample
ExecStr("alert(20)",500); 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2016-12-06T08:28:54.200

New Function 和[apply()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply)也可以一起使用

```
var a=new Function('alert(1);')
a.apply(null) 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-06-02T12:56:48.397

```
eval(s); 
```

但是，如果您从用户那里获取数据，这可能会很危险，尽管我认为如果他们自己的浏览器崩溃，那就是他们的问题。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2018-02-05T13:46:17.643

我正在回答类似的问题，并得到另一个想法如何在不使用的情况下实现这一目标`eval()`：

```
const source = "alert('test')";
const el = document.createElement("script");
el.src = URL.createObjectURL(new Blob([source], { type: 'text/javascript' }));
document.head.appendChild(el); 
```

在上面的代码中，您基本上创建了包含脚本的 Blob，以便创建对象 URL（在浏览器内存中表示文件或 Blob 对象）。由于您`src`在标签上有属性`<script>`，因此脚本的执行方式与从任何其他 URL 加载的方式相同。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2018-02-12T14:22:05.177

```
function executeScript(source) {
    var script = document.createElement("script");
    script.onload = script.onerror = function(){ this.remove(); };
    script.src = "data:text/plain;base64," + btoa(source);
    document.body.appendChild(script);
}

executeScript("alert('Hello, World!');"); 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2015-01-30T04:56:28.640

不确定这是否作弊：

```
window.say = function(a) { alert(a); };

var a = "say('hello')";

var p = /^([^(]*)\('([^']*)'\).*$/;                 // ["say('hello')","say","hello"]

var fn = window[p.exec(a)[1]];                      // get function reference by name

if( typeof(fn) === "function") 
    fn.apply(null, [p.exec(a)[2]]);                 // call it with params 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2021-03-04T22:59:29.433

[斯特凡回答](https://stackoverflow.com/a/9702401/7880517)的延伸：

```
//Executes immediately
function stringToFunctionAndExecute(str) {
    let func = new Function(str);
    return (func()); // <--- note the parenteces
}

//Executes when called
function stringToFunctionOnly(str) {
    let func = new Function(str);
    return func;
}

// -^-^-^- Functions -^-^-^- (feel free to copy)
// -v-v-v- Explanations -v-v-v- (run code to read easier)

console.log('STEP 1, this executes directly when run:')
let func_A = stringToFunctionAndExecute("console.log('>>> executes immediately <<<')");

console.log("STEP 2, and you can't save it in a variable, calling a() will throw an error, watch:")
try {
  func_A();    
} catch (error) {
  console.log('STEP ERROR, see, it failed', error)    
}

console.log('STEP 3, but this will NOT execute directly AND you can save it for later...')
let func_B = stringToFunctionOnly("console.log('>>> executes when called <<<')");

console.log("STEP 4, ...as you see, it only run when it's called for, as is done now:")
func_B();

console.log('STEP 5, TADAAAAA!!')
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-06-02T12:56:31.673

[eval](http://www.w3schools.com/jsref/jsref_eval.asp)应该这样做。

```
eval(s); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-06-02T12:57:09.130

```
eval(s); 
```

但请记住，eval 非常强大且非常不安全。您最好确信您正在执行的脚本是安全的，并且用户不可变。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-05-11T07:31:13.173

一个可以使用[mathjs](https://mathjs.org/docs/expressions/parsing.html#evaluate)

来自以上链接的片段：

```
// evaluate expressions
math.evaluate('sqrt(3^2 + 4^2)')        // 5
math.evaluate('sqrt(-4)')               // 2i
math.evaluate('2 inch to cm')           // 5.08 cm
math.evaluate('cos(45 deg)')            // 0.7071067811865476

// provide a scope
let scope = {
    a: 3,
    b: 4
}
math.evaluate('a * b', scope)           // 12
math.evaluate('c = 2.3 + 4.5', scope)   // 6.8
scope.c 
```

`scope`是任何对象。因此，如果您将全局范围传递给评估函数，您可能能够动态执行 alert()。

此外， mathjs 比 eval() 更好，因为它在沙箱中运行。

> 用户可以尝试通过表达式解析器注入恶意 JavaScript 代码。mathjs 的表达式解析器提供了一个沙盒环境来执行表达式，这应该是不可能的。尽管有可能存在未知的安全漏洞，因此请务必小心，尤其是在允许服务器端执行任意表达式时。

较新版本的 mathjs 不使用 eval() 或 Function()。

> 解析器主动阻止对 JavaScript 内部 eval 和 new Function 的访问，这是安全攻击的主要原因。Mathjs 版本 4 和更新版本在底层不使用 JavaScript 的 eval。版本 3 和更早版本确实使用 eval 进行编译步骤。这不是直接的安全问题，但会导致更大的可能攻击面。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-06-05T12:11:48.533

同时使用 eval 和创建一个新的 Function 来执行 javascript[会带来很多安全风险。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval#Never_use_eval!)

```
const script = document.createElement("script");
const stringJquery = '$("#button").on("click", function() {console.log("hit")})';
script.text = stringJquery;
document.body.appendChild(script); 
```

我更喜欢这种方法来执行我作为字符串收到的 Javascript。

# asp.net - 将 Postback URL 修改为 ht 页面锚点

> ID：939335
> 
> 赞同：1
> 
> 时间：2009-06-02T12:56:24.387
> 
> 标签：asp.net, postback

我有一个包含多个网格视图的页面。为了可用性，我将这些网格视图放入了一系列 jquery 选项卡中。选项卡通过创建指向具有特定 ID 的容器的锚链接来工作，因此在单击给定选项卡后，URL 可能会从

host.com/page.aspx

到

host.com/page.aspx#tab2

问题是，如果选项卡内的任何元素导致回发，例如尝试对网格进行排序或分页，则在加载时，选定的选项卡会丢失，并恢复到列表中的第一个选项卡。所以在那种情况下，我会排序正确的网格，但我必须再次单击正确的选项卡才能看到它。

为了解决这个问题，我想在回发发生时跟踪我所在的锚点，以便我可以更改我正在加载的 url 以包含它。我能想到的唯一方法是重定向，我真的不想承担费用。

有没有更好的方法来指定在回发时加载哪个锚？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T12:59:38.453

在表单 onsubmit 事件中，修改 action 属性以包含相关的锚点（您需要自己跟踪）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:05:04.853

如果页面回发给自己，那么`foo.aspx`您需要将其回发到`foo.aspx#anchor`.

如果必须，您也可以通过 cookie 执行此操作，但锚点要好得多。Cookie 对于自定义雅虎页面以在每次访问时关注特定选项卡等事情更有用。

# javascript - 更改图像映射上的边框

> ID：939336
> 
> 赞同：1
> 
> 时间：2009-06-02T12:56:29.833
> 
> 标签：javascript, html, border, mouseover

如何更改已放置在图像一部分上的图像映射的边框（鼠标悬停）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T12:59:45.643

您可以使用 jQuery：

```
$('#imagemapid').mouseover(function() {
    $(this).css("border","solid 1px red");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T13:03:40.847

如果您确实使用 jQuery，这将是明智的，请使用悬停，以便您也可以删除边框。

```
$('#imagemapid').hover(
  function() {
    $(this).css("border","solid 1px red");
  },
  function() {
    $(this).css("border","none");
  }
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T13:17:13.487

既然您用**javascript**询问，那么我将首先展示您想要的解决方案

```
 function imageon(here) 
{

   var elem= document.getElementById(here);
   elem.style.border = "solid 2px grey";
} 
```

在**jquery** 你可以这样做

```
$(function(){
 $('#d1').mouseover(function() { 
 $(this).css("border","solid 2px grey");
 });
}); 
```

像这样的html

```
<img name="d1" id="d1" href="LINK #1" onmouseover="imageon('d1');" > 
```

# c# - byte[] 到字符串的转换似乎不像我想要的那样工作

> ID：939344
> 
> 赞同：1
> 
> 时间：2009-06-02T12:57:36.587
> 
> 标签：c#, text

我正在尝试在文本文件中显示字节数组的内容。

这是我的代码：

```
 var writer = new System.IO.StreamWriter(Application.StartupPath + @"\B323.txt");
        writer.Write(data.ToString());
        writer.Close();
        writer.Dispose(); 
```

data 是一个 byte[] 数组。

输出是“System.Byte[]”，为什么？

我正在尝试显示这个数组的内容，问题出在哪里？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T12:59:09.373

当您调用时`byte[].ToString()`，它会返回`System.Byte[]`。你打算如何转换字节数组？有多种方法可以将字节转换为字符串。

如果您希望它作为“十六进制转储”，您可以`BitConverter.ToString(byte[])`生成输出，例如

```
5B-3E-5D 
```

这就是你所追求的吗？如果您*实际上*只想将字节写入文件，因为它们*已经*表示编码文本，那么您应该使用 a`FileStream`代替并直接写入它们。

（其他要点：您应该使用`using`语句来处理作者；您不需要调用 close，因为您已经在处理；`File.WriteAllText`这是一种更简单的开始方法。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T12:59:46.177

调用`ToString`on`data`会将其转换为文本表示（与调试时在 Watch 或 Locals 窗口中看到的相同）。

您可以只写入`data`流，也可以使用其中的一个函数`System.Text.Encoding`将 byte[] 转换为字符串。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T12:59:56.237

默认的 ToString() 实现只是回显类名。您可能需要其中一种 Encoding.GetString() 方法，例如[ASCIIEncoding.GetString](http://msdn.microsoft.com/en-us/library/bb358574.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T13:02:25.077

你想做什么？将数据写为字节还是文本表示？

二进制：

```
FileStream fS = new FileStream(Application.StartupPath + @"\B323.txt");
BinaryWriter bW = new BinaryWriter(fS);
bW.Write(data);
fS.Close(); 
```

或者

文字表示：

```
var writer = new System.IO.StreamWriter(Application.StartupPath + @"\B323.txt");
writer.Write(System.Text.ASCIIEncoding.ASCII.GetString(data));
writer.Close(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T13:07:10.107

根据您希望数组在文本文件中的表示方式，可能类似于以下内容：

```
// 12-34-AB
writer.Write(BitConverter.ToString(data));

// 1234AB
writer.Write(BitConverter.ToString(data).Replace("-", string.Empty));

// 0x1234AB
writer.Write("0x" + BitConverter.ToString(data).Replace("-", string.Empty));

// [ 12, 34, AB ]
writer.Write("[ " + BitConverter.ToString(data).Replace("-", ", ") + " ]");

// [ 0x12, 0x34, 0xAB ]
writer.Write("[ 0x" + BitConverter.ToString(data).Replace("-", ", 0x") + " ]"); 
```

# svn - 将存储库文件移动到不同的文件夹下

> ID：939348
> 
> 赞同：2
> 
> 时间：2009-06-02T12:58:36.897
> 
> 标签：svn, tortoisesvn

我前段时间创建了一个存储库，其中包含许多文件，但没有任何结构，如文件夹“根”和文件夹“标签”等。现在我想创建文件夹'root'并将我当前的工作放在那里，然后在文件夹'tags'中创建一个名为tagv23的分支。我已经在 TortoiseSVN 的 repo-browser 文件夹根目录和标签中创建了。如何将我的所有其他文件夹和文件移动到它可以工作的文件夹“根”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T13:02:15.920

浏览存储库时，只需使用拖放操作移动文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:02:35.187

您实际上是要对现有文件和文件夹进行分支。它始终是复制操作，因此将现有文件和文件夹复制到“根”文件夹，然后删除原件。现在您可以从“root”分支到“tagv23”。

# php - PHP MySQL 从多个表中获取数据

> ID：939364
> 
> 赞同：0
> 
> 时间：2009-06-02T13:01:50.930
> 
> 标签：php, mysql

昨天我问了一个类似的问题，可能措辞不佳，无论哪种方式我都不明白，这是我真正需要破解的问题：）我以前从未做过，对我的许多项目都非常有用。

这是一个目录网站。我有三个表：**entry**、**location**和**entry-locations**。**entry**包含有关建筑物的信息，例如名称，地址，图像等。**location**只是每个建筑物可能的可能位置的列表。位置表与此示例几乎无关，它仅包含有关我可以在站点的其他区域显示的位置的信息。

**entry-locations**是将条目链接到位置的表。它只有两个字段，*entry-id*和*location* ... 如果您想知道为什么我需要一个单独的表，因为同一建筑物*可能*有多个位置（不要问）。

基本上，我需要做的是显示来自它自己页面的每个位置的列表。例如，我需要列出法国的所有建筑物，所以查询需要通过**entry-locations**表返回每条位置为'France'的记录，然后它需要从条目对应的条目表中*提取*所有**数据***-id 已*返回。

我确信有一种方法可以通过一个查询来做到这一点，如果我可以展示如何在这么多项目中复制它，那将是非常棒的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T13:11:30.910

这个怎么样？

```
-- // Selects all the columns from both entry-locations and entry
SELECT * 
FROM entry-locations
JOIN entry e ON e.id = el.entry-id
WHERE el.location = 'France';

-- // To just get the entry data for matching records: (Remove DISTINCT if you
-- // don't mind, or want, each entry with multiple locations in the result set
-- // multiple times)
SELECT DISTINCT e.* 
FROM entry-locations el
JOIN entry e ON e.id = el.entry-id
WHERE el.location = 'France' 
```

***编辑：****好的，所以我尝试删除位置表，而是使用 entry-location.location 作为位置的名称。这是正确的吗？*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T13:15:43.477

想象一下，您有以下数据：

**条目**：

```
|id|name|
| 1|Foo |
| 2|Bar | 
```

**入口位置**：

```
|entry-id|location|
|1       |France  |
|2       |Greece  |
|2       |France  | 
```

这就是我从您的描述中理解表格的方式。更常见的方法是拥有

```
Entry(id,name)
Location(id,name)
Entry_Location(entry_id, location_id) 
```

我认为这也是其他帖子中一些混乱的根源。

现在，让 MySql 从 id 匹配的两个表中获取数据。

```
SELECT entry.* 
FROM `entry`, `entry-location` as el
WHERE entry.id = el.`entry-id`
AND el.location = 'France'; 
```

MySql 现在将您的数据视为一张表，如下所示：

```
|entry.id|entry.name|el.location|
|       1|       Foo|     France|
|       1|       Foo|     Greece|
|       2|       Bar|     France| 
```

并从该表中选择条目 where `el.location = 'France'`，并返回指定的字段。

此查询从`entry`表中获取与您设置的要求相匹配的所有字段。首先，它使 MySql 将这两个表视为一个表，通过`SELECT`从这两个表中获取。

看看 MySql 的[SELECT 参考](http://dev.mysql.com/doc/refman/5.0/en/select.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:05:04.667

select * from entry where id in (select entry-id from entry-locations)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:13:11.983

如果我明白你的想法，你需要： select e.* frmm entry join entry-locations as as l ON l.entry-id=e.id WHERE l.location='France'

# actionscript-3 - 是否可以使用 ActionScript 3 代码或 MXML 创建影片剪辑？

> ID：939368
> 
> 赞同：0
> 
> 时间：2009-06-02T13:02:22.177
> 
> 标签：actionscript-3, flex3, mxml

我正在使用 Flex 3 SDK 和免费的[FlashDevelop](http://www.flashdevelop.org/wikidocs/index.php?title=Main_Page) IDE。

由于我没有 FlexBuilder 或 Flash CS4 Professional，我无法以图形方式制作 MovieClip。

因此，我想使用代码或 MXML 创建一个简单的 MovieClip。例如，假设我想创建一个包含 3 帧的 MovieClip，并将位图加载到每个帧中以创建一个简单的动画。

这可能吗？我有一个很好的谷歌，我能找到的唯一例子是加载现有的电影剪辑并将它们添加到舞台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:05:26.557

您可以使用以下简单代码创建影片剪辑：

```
var mc:MovieClip = new MovieClip();
stage.addChild(mc); 
```

那是因为只是和空的影片剪辑，您可以使用图形属性在其上绘制（[请参见此处](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/Sprite.html#graphics)）。

据我所知，没有办法用动作脚本创建框架。虽然可能有一些未记录的方法。有些函数没有出现在文档中（如[addFrameScript](http://www.flashguru.co.uk/undocumented-actionscript-3)方法）。

我想说最好的方法（如果你绝对不能使用 Flash CS4），就是拥有一系列[Loader](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/Loader.html)对象，然后依次隐藏和显示它们。只需将它们放在一个数组中并监听[enterFrame](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/DisplayObject.html#event:enterFrame)事件。您可以在 Loader 对象中加载位图。

如果您使用链接并查看文档中的示例，我认为您应该能够弄清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T16:58:13.473

据我所见，在 Flex 中创建 MovieClip 并不容易，它的行为方式可能与 Flash 的实现 MovieClip 相当。但我不认为你真的想要一个 MovieClip 开始。Flex 不能很好地处理非 flex 对象。是的，可以向 UIComponent 添加一些东西，但是使用 Flex 框架比使用变通方法要好得多。

我会使用 mx:Image 标签来加载您的图像。这通常是将图像加载到 Flex 中最简洁的方式。它可以让您在编译时将对象嵌入到 SWF 中，这意味着您不必指向外部文件。我会警告有太多的嵌入式图形——这会浪费你的下载时间，甚至可能影响你的性能。

如果您只对动画移动或调整大小感兴趣，那么我会使用本机 Flex Tweens 的 Move 和 Resize 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T00:55:51.977

您最好的选择可能是扩展 UIComponent 类，添加一个 MovieClip 作为子组件，并通过代理应用来自 MXML 的设置。例如，

```
public function set movieFrames(value:Array):void {
   for each(var b:Bitmap in value) {
      //add bitmap to _movieclip object.
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-08T11:22:49.103

你想要一个 Sprite 而不是一个 MovieClip。并使用时间而不是帧。有一个 Timer 类和一个 getTimer() 函数。使用它们。

1.  创建一个扩展/实现 Sprite 的类。
2.  添加一个加载器类。
3.  谷歌它究竟是如何完成的。（flashtuts.com 或类似的东西）。

# mysql - 选择最多不同参与者的论坛主题

> ID：939370
> 
> 赞同：1
> 
> 时间：2009-06-02T13:02:26.997
> 
> 标签：mysql, select, distinct

所以，我正在为我的论坛建立一个会员奖励系统，并被困在这个查询中，以选择“与大多数不同参与者的论坛主题”。

我已经有这个查询，它计算过去 24 小时内每个论坛主题有多少帖子（回复）。

```
SELECT poster . * , count( odgovori.id_odgovor ) AS broj, members.username
FROM poster
INNER JOIN odgovori ON ( odgovori.na = poster.id_poster )
INNER JOIN members ON ( poster.od = members.id_member )
WHERE poster.datum = '01.06.09'
GROUP BY odgovori.na, odgovori.od
ORDER BY broj DESC
LIMIT 1 
```

```
表海报 - 论坛主题表
表 odgovori - 回复表
表成员 - 成员表，在此查询中仅用于获取主题作者的用户名

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T13:06:07.520

```
SELECT  poster.*, COUNT(DISTINCT odgovori.author) AS different
FROM    poster
JOIN    odgovori
ON      odgovori.na = poster.id_poster
GROUP BY
        poster.id
ORDER BY
        different DESC
LIMIT 1 
```

# programming-languages - 公司标准：C#.NET vs VB.NET vs.whatever.NET

> ID：939381
> 
> 赞同：4
> 
> 时间：2009-06-02T13:04:26.587
> 
> 标签：programming-languages, standards

当我们考虑用更多的身体充实我们的开发人员时，只是在我的旧工作中不时出现的一个问题。如果您是 .NET 开发公司，您的开发人员是否所有代码都使用一种语言而不是另一种语言，这真的很重要吗？

我可能像其他 400 万其他人一样开始使用 Visual Basic，然后迁移到 VB.NET。我们当时的另一位开发人员来自 C 背景并迁移到 C#.NET。基本上，他能够用他的母语快速编写代码，而我也能用我的语言编写代码，而且由于我们的项目并没有真正重叠，所以没有问题，直到我们的老板基本上说我们需要切换到 C#...原因比标准化。

所以我想问题的“主观”部分是，为了一致性而牺牲生产力是否更好？现在我应该量化这一点，说我们是一家小商店，不到 5 个开发人员，考虑到我们的大部分项目计划是如何在鸡尾酒餐巾纸上完成的，这不像我们很快就会采用 6-Sigma，所以它不像“标准”是一个硬性规定。

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-02T13:07:45.003

C# 肯定会成为 Microsoft 的首选途径，选择一种所有开发人员都使用的语言是有意义的，因为如果开发人员在任务之间移动，则使用统一语言（更不用说编码约定）将项目让所有相关人员更轻松地维护这些项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T13:10:22.067

我认为选择一个并让每个人都参与其中是有意义的。生产力的牺牲将是短暂的，有能力的开发人员将迅速迁移。

一些优点：

*   您的最后一个 VB 开发人员和团队正在缩小规模......呃哦。
*   其中一位开发人员退出了，您必须接管他们的代码
*   等等

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T14:26:33.893

如果有帮助的话，我最近在我的博客上写了一篇文章，回顾了我决定通过 C# 在 VB.NET 上标准化我们的开发商店，以及我的各种假设如何站得住脚，事后诸葛亮。

这是一个链接：“[经理回顾 C# 与 VB.NET 的决定](http://improvingsoftware.com/2009/04/19/a-managers-retrospective-on-the-c-versus-vbnet-decision/)”

至于您是否应该将整个商店标准化为一种语言。我会说有一定的好处。最明显的一点是，当你在不同的项目上工作时来回切换会产生一些精神开销，以便每次重新适应自己。当然，如果你必须经常这样做，它会更少，但为了证明额外的复杂性是合理的，必须有一些抵消的好处。

最后，我的建议是根据以下标准对其中一个进行标准化：
(1) 如果您有一个大型 VB 代码库，那么在 VB.NET 上进行标准化是一个很好的论据。
(2) 如果其他一切都相同，由于上述文章中提到的一些原因，我会倾向于 C#。
(3) 仔细考虑您当前团队的偏好以及您将尝试招募的市场开发人员的普遍共识。语言选择对于士气和招聘来说是一件大事。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T13:08:11.307

我会说去任何有效的。VB.NET 和 C# 使用所有相同的底层框架，因此您应该能够阅读彼此的代码，并且通过谷歌搜索您也应该能够修改它。

我想说的是提高生产力.. 最终客户会关心它是用 VB.NET 还是 C# 编写的？但是说你必须考虑可维护性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T13:13:55.740

> 所以我想问题的“主观”部分是，为了一致性而牺牲生产力是否更好？

当然不是。一致性本身有什么好处？最终，一致性的目标**是**生产力。考虑到这一点，我建议，从长远来看，让每个人都用一种语言编写代码将是最好的方法……总的来说，从长远来看，修改和维护代码所花费的时间比编写代码要多得多，而且我认为让人们花一次加速时间比一直来回切换要好。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-02T13:19:11.627

> 我们的老板基本上说我们需要切换到 C#...除了标准化之外没有其他原因。（...）所以我想问题的“主观”部分是，为了一致性而牺牲生产力是否更好？

当然不是。唯一的问题是这种“一致性”对于未来的生产力有什么价值，因为生产力才是最重要的。“一致性”本身并不是商业价值。它可能只会帮助您在未来实现更高的生产力。

必须平衡几个因素：

*   **(+)** *明天*人们将只需要维护一种语言，最流行的 .Net 语言：C#。（见注1）
*   **(-)** *今天*你必须学习 C#，这对你的公司来说是一笔开销，除非你在周末免费学习。当然，就*成本*而言，这是一个（-） 。学习 C# 本身就很好，只是要付出代价。
*   **(-)** *今天*学习了 C# 之后，您或其他人必须将一个项目从 Visual Basic .Net 切换到 C#。这需要付出一定的代价，具体取决于项目的 LOC 数量。此外，可能会引入错误，因此您需要重新运行单元测试，检查所有故障并解决它们。此外，您需要重复一些集成测试，以确保一切正常。

您无法通过此信息判断余额的结果。但无论如何，您不必说出来，因为您的老板可能掌握了更好的信息并且已经做出了决定。您需要做的就是实际去做。

**注 1：**但是，这种推理危险地接近于“如果没有 VB.NET，世界将会变得更美好”，这可能是一种过于强烈的说法。在某些情况下，VB.NET 或两种语言的混合可能是一个不错的选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T13:08:59.933

我们仍然是我工作的混合语言小组；然而，夹杂着一个目的。几乎所有与硬件相关的项目都是用 C++ 完成的（不是汇编，我知道 :() 并且几乎所有的 Windows 应用程序都是用 C# 完成的。

考虑到 C# 的受欢迎程度和易用性，我想说当他们获得新的、更环保的员工时转向它符合公司的利益。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-02T13:29:28.190

您如何看待自己作为商店？

VB.NET 在直接依赖 Office 的市场中表现强劲，也许客户端应用程序也是如此，而 C# 在服务器端和更大的应用程序中特别强大。

也许这不是要遵循您或他的选择，而是要根据商店的性质做出选择。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-02T13:28:01.173

如果可能的话，坚持单一的语言选择很重要。显然，如果您正在编写非托管 C++，或者有一些其他类似的场景，就会有明显的例外。一旦你提高了速度，很多人都对同质语言选择的效率产生了影响。我认识的大多数开发人员在切换语言时都会遇到效率问题，即使他们对这件事了如指掌。在用 C# 编写代码几个月后，如果我必须回到 VB.NET 来维护某些东西，那么有一天我必须有意识地思考通常是自动的事情。它们是简单的事情，比如使用 vs. Imports、类型转换等。并不是你忘记了它是如何工作的，而是你的大脑想要按照你长时间以来的方式去做某事。很像旧客厅的把戏，把你的胳膊靠在门框上一分钟，然后把它们放在你身边。他们想回去，因为这是你的大脑习惯发送的信号。

另一个非常重要的收获是，这个效率因素在代码审查中也很重要。如果您在 VB.NET 中工作并且必须复习 C#，那么您将遇到同样的绊脚石。当然，您了解代码，但您分析代码的速度或准确度与您当前使用的语言不同。

还有一些额外的小点。一些工具是针对一种语言而不是另一种语言的。例如，Resharper 适用于 VB.NET 和 C#，但如果您使用 C#，它会提供更大的重构集。此外，如果您组织中的某个人维护公司编码标准，那么如果只需要解决一种语言，它会使这些标准的更改复杂度减半。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-02T13:30:21.027

我认为这对编码风格标准也很重要。开发团队选择 3 个空格而不是 4 个制表符真的有原因吗？除了统一性和让每个人的代码看起来都一样，这个决定并没有真正的技术或商业优势，所以当我在文件之间切换时，我的大脑不必适应新的格式。

同样的事情也适用于 C# 和 VB.net 的一致性。接管另一个没有技术或业务优势（注意：我敢肯定，如果你足够努力，你会发现一些真正晦涩难懂的东西）。但是，在从一个项目迁移到另一个项目时，让每个人的代码统一会有所帮助，这样人们就不必从用 C# 思考转向用 VB.net 思考。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-02T14:15:23.900

使用 .Net 平台进行开发的优势之一是您有能力使用最能表达您对手头问题的解决方案的语言进行开发。

任意规则 IMO 不应阻止您使用 F# 或 DLR 语言，因为这些语言比 C# 或 VB.Net 等命令式语言更自然。

使用 VB.Net 与 C# 做出更难的决定，因为语言非常相似，但如果您需要对 XML 做大量工作，那么 VB.Net 的 XML 文字可能有助于使代码更清晰，相反，C#s 简洁的语法并且对匿名方法的支持可能会让您的意图更加清晰。

# javascript - 立即函数调用语法

> ID：939386
> 
> 赞同：113
> 
> 时间：2009-06-02T13:05:24.667
> 
> 标签：javascript, syntax, jslint, iife

有一个[JSLint](http://www.jslint.com)选项，实际上是 The Good Parts 之一，它“[需要] parens around immediate invocations”，这意味着构造

```
(function () {

  // ...

})(); 
```

而是需要写成

```
(function () {

  // ...

}()); 
```

我的问题是——谁能解释为什么第二种形式可能被认为更好？是不是更有韧性？更不容易出错？它比第一种形式有什么优势？

* * *

自从提出这个问题后，我开始理解在函数值和函数值之间进行清晰视觉区分的重要性。考虑立即调用的结果是赋值表达式右侧的情况：

```
var someVar = (function () {

  // ...

}()); 
```

虽然最外面的括号在语法上是不必要的，但左括号给出了一个预先指示，即被分配的值*不是*函数本身，而是被调用函数的结果。

这类似于 Crockford 关于构造函数大写的建议——它旨在为任何查看源代码的人提供视觉提示。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-06-02T13:11:06.463

来自 Douglass Crockford 的[风格约定指南](http://javascript.crockford.com/code.html)：（搜索“立即调用”）

***当要立即调用函数时，应将整个调用表达式包裹在括号中，以便清楚地生成的值是函数的结果，而不是函数本身。***

所以，基本上，他觉得它更清楚地区分了函数值和函数值。所以，这是一个风格问题，而不是代码本身的实质性差异。

*更新参考，旧PPT不存在了*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-02-23T21:06:57.513

立即调用的匿名函数将其包裹在括号中，因为：

1.  它们是函数表达式，省略括号会导致它被解释为函数声明，这是一个语法错误。

2.  函数表达式不能以单词 function 开头。

3.  将函数表达式赋值给变量时，不返回函数本身，返回函数的返回值~~，因此括号评估它们内部的内容并产生一个值。~~当函数执行时，后面的括号`..}()`会导致函数立即执行。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2014-03-27T18:30:40.293

或者，使用：

```
void function () {
...
} () 
```

# c# - 将命令绑定到事件？

> ID：939388
> 
> 赞同：13
> 
> 时间：2009-06-02T13:05:53.650
> 
> 标签：c#, wpf, xaml, mvvm

将命令绑定到事件的好方法是什么？在我的 WPF 应用程序中，我想通过 ViewModel 捕获和处理一些事件，但我不确定如何。失去焦点、鼠标悬停、鼠标移动等事情。由于我试图坚持 MVVM 模式，我想知道是否有一个纯 XAML 解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-05-14T07:27:49.217

使用**System.Windows.Interactivity**

```
…xmlns:i=http://schemas.microsoft.com/expression/2010/interactivity…

<Slider    
    <i:Interaction.Triggers>    
        <i:EventTrigger EventName="ValueChanged">
            <i:InvokeCommandAction    
                Command="{Binding MyCommand}"    
                CommandParameter="{Binding Text, ElementName=textBox}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</Slider> 
```

确保您的项目引用程序集 System.Windows.Interactivity。

*来源：[MSDN 博客从您选择的事件中执行命令](http://blogs.msdn.com/b/luc/archive/2010/11/18/executing-a-command-from-an-event-of-your-choice.aspx)*

**[更新]** 查看[**Microsoft.Xaml.Behaviors.Wpf**](https://www.nuget.org/packages/Microsoft.Xaml.Behaviors.Wpf)（自 03.12.2018 起可用）Microsoft 官方包。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-06T15:09:52.177

看看 Marlon Grech 的[Attached Command Behavior](http://marlongrech.wordpress.com/2008/12/13/attachedcommandbehavior-v2-aka-acb/)，它可能正是您想要的

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T13:23:19.560

为了处理事件，您必须有一些代码将自身附加到事件并执行您的命令作为响应。最终目标是在 XAML 中：

```
 MouseMoveCommand="{Binding MyCommand}" 
```

为了实现这一点，您需要为要处理的每个事件定义一个附加属性。[有关执行此](http://blog.functionalfun.net/2008/09/hooking-up-commands-to-events-in-wpf.html)操作的示例和框架，请参见this。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-07T13:08:34.317

我使用附加属性和反射来实现它。我不能说这是最好的实现，但我可能会改进它，这对你来说可能是一个好的开始。

```
public class EventBinding : DependencyObject
{
    public static string GetEventName(DependencyObject obj)
    {
        return (string)obj.GetValue(EventNameProperty);
    }

    public static void SetEventName(DependencyObject obj, string value)
    {
        obj.SetValue(EventNameProperty, value);
        var eventInfo = obj.GetType().GetEvent(value);
        var eventHandlerType = eventInfo.EventHandlerType;
        var eventHandlerMethod = typeof(EventBinding).
            GetMethod("EventHandlerMethod", BindingFlags.Static | BindingFlags.NonPublic);
        var eventHandlerParameters = eventHandlerType.GetMethod("Invoke").GetParameters();
        var eventArgsParameterType = eventHandlerParameters.
            Where(p => typeof(EventArgs).IsAssignableFrom(p.ParameterType)).
            Single().ParameterType;
        eventHandlerMethod = eventHandlerMethod.MakeGenericMethod(eventArgsParameterType);
        eventInfo.AddEventHandler(obj, Delegate.CreateDelegate(eventHandlerType, eventHandlerMethod));
    }

    private static void EventHandlerMethod<TEventArgs>(object sender, TEventArgs e)
        where TEventArgs : EventArgs
    {
        var command = GetCommand(sender as DependencyObject);
        command.Execute(new EventInfo<TEventArgs>(sender, e));
    }

    public static readonly DependencyProperty EventNameProperty = 
        DependencyProperty.RegisterAttached("EventName", typeof(string), typeof(EventHandler));

    public static ICommand GetCommand(DependencyObject obj)
    {
        return (ICommand)obj.GetValue(CommandProperty);
    }

    public static void SetCommand(DependencyObject obj, ICommand value)
    {
        obj.SetValue(CommandProperty, value);
    }

    public static readonly DependencyProperty CommandProperty =
        DependencyProperty.RegisterAttached("Command", typeof(ICommand), typeof(EventBinding));

}

public class EventInfo<TEventArgs>
{
    public object Sender { get; set; }
    public TEventArgs EventArgs { get; set; }

    public EventInfo(object sender, TEventArgs e)
    {
        Sender = sender;
        EventArgs = e;
    }
}

public class EventInfo : EventInfo<EventArgs>
{
    public EventInfo(object sender, EventArgs e)
        : base(sender, e) { }
}

public class EventBindingCommand<TEventArgs> : RelayCommand<EventInfo<TEventArgs>>
    where TEventArgs : EventArgs
{
    public EventBindingCommand(EventHandler<TEventArgs> handler)
        : base(info => handler(info.Sender, info.EventArgs)) { }
} 
```

# 使用示例：

### 看法

```
<DataGrid local:EventBinding.EventName="CellEditEnding"
          local:EventBinding.Command="{Binding CellEditEndingCommand}" /> 
```

### 模型

```
private EventBindingCommand<DataGridCellEditEndingEventArgs> _cellEditEndingCommand;

public EventBindingCommand<DataGridCellEditEndingEventArgs> CellEditEndingCommand
{
    get 
    { 
        return _cellEditEndingCommand ?? (
            _cellEditEndingCommand = new EventBindingCommand<DataGridCellEditEndingEventArgs>(CellEditEndingHandler)); 
    }
}

public void CellEditEndingHandler(object sender, DataGridCellEditEndingEventArgs e)
{
    MessageBox.Show("Test");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:10:17.590

我认为您不能在纯 XAML 中使用它，但请看一下[Delegate Command](http://msdn.microsoft.com/en-us/library/cc707894.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T15:33:13.043

[执行命令、导航框架和委托命令](http://gallery.expression.microsoft.com/en-us/Agility)行为是一个非常好的模式。它也可以在 Expression Blend 中使用。

在“最佳实践”方面，您应该在将事件转换为命令之前三思而后行。通常，命令是用户有意执行的操作，事件通常只是交互轨迹，不应离开视图边界。

# java - Java Swing 中的 AccessibleContext 有什么用？

> ID：939397
> 
> 赞同：8
> 
> 时间：2009-06-02T13:08:09.327
> 
> 标签：java, swing, user-interface, accessibility

我见过很多使用
**getAccessibleContext().setAccessibleDescription(...)**
来设置一些“神奇”描述的例子。

这个描述有什么用？在哪里可以看到它，它应该如何支持可访问性？

为什么不使用**setDescription(...) ？**

此外，您对 Java 可访问性有什么看法/经验？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T13:13:53.993

我实际上并没有在我的应用程序中使用 Swing 的可访问性工具（我可能应该），但我认为它将有助于使用屏幕阅读器和其他技术来提高应用程序的可访问性。

来自[可访问性和秋千集](http://java.sun.com/products/jfc/tsc/articles/accessibility/index.html)文章：

> 如果应用程序完全支持 Java Accessibility API，则它可以兼容并友好地使用屏幕阅读器、屏幕放大镜和其他类型的辅助技术。

链接的文章深入探讨了 Swing 和[Accessibily API](http://java.sun.com/javase/6/docs/api/javax/accessibility/package-summary.html)的辅助功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-21T09:18:34.083

正如所指出的，可访问信息用于向辅助技术（例如屏幕阅读器）公开信息（简而言之，作为盲人计算机用户，我使用屏幕阅读器来收集有关哪些控件具有焦点以及应用程序中发生的其他有用事情的有用信息，然后屏幕阅读器的例子有 NVDA www.nvda-project.org for windows, Orca [http://live.gnome.org/Orca](http://live.gnome.org/Orca)适用于 unix 平台上的 gnome 桌面和 MacOSX 中默认包含的画外音）。对于许多包含文本的标准控件，您可能无需明确设置可访问信息就可以逃脱（例如，如果您有一个带有文本单词“OK”的按钮，那么屏幕阅读器可能会很好地读出这一点。当您没有显示文本时（例如，带有图形标签的按钮）或当您正在开发自定义控件（从内存而不通过某些 Java swing 文档返回时，设置可访问信息的重要性就出现了，我认为可访问的名称是标识控件，可访问描述是提供额外信息，如果它是自定义控件，可能是如何使用它的线索）。

现在，如果您想看看它是如何工作的，NVDA 和 Orca 是开源项目，并且 MacOSX 10.4（我认为）和更高版本中包含画外音，因此您可以免费尝试其中之一（不像某些商业产品可以非常贵）。

# c# - 使用月份确定日期的简单公式？

> ID：939400
> 
> 赞同：6
> 
> 时间：2009-06-02T13:09:21.040
> 
> 标签：c#, datetime, calendar, formula

给定一条标准的日程安排信息，例如“2009 年 6 月的第二个星期二”或“2009 年 7 月的最后一个星期五”，将其转换为日期的最简单和最有效的公式是什么？

**输入：**

*   `w`= 每月的第几周，枚举（第 1、第 2、第 3、第 4 或最后）
*   `d`= 星期几，枚举 Sun 到 Sat
*   `m`= 月，整数
*   `y`= 年，整数

**编辑（再次）** ——一周从哪一天开始并不重要；我想在给定月份获取*d的第**w*个实例。因此，2009 年 6 月的第二个星期日是 6 月 14 日，尽管从技术上讲，它是在 6 月的第三周；同样，6 月的第一个星期日是 6 月 7 日，不是空值/异常。

 ** * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T13:17:20.960

就像是：

```
static DateTime GetDate(int year, int month, DayOfWeek dayOfWeek,
        int weekOfMonth) {
    // TODO: some range checking (>0, for example)
    DateTime day = new DateTime(year, month, 1);
    while (day.DayOfWeek != dayOfWeek) day = day.AddDays(1);
    if (weekOfMonth > 0) {
        return day.AddDays(7 * (weekOfMonth - 1));
    } else { // treat as last
        DateTime last = day;
        while ((day = day.AddDays(7)).Month == last.Month) {
            last = day;
        }
        return last;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T13:38:04.397

编辑以修复错误，当要求的工作日与第一个月的星期几相同。

马克的第二次编辑以修复问题光盘

```
static DateTime GetDate(int year, int month, 
                DayOfWeek weekDay, int week)
{  
    DateTime first = new DateTime(year, month, 1);
    int iDow = (int)weekday, iFirst = (int)first.DayOfWeek;
    int adjust = (7+iDow-iFirst)%7 - 7;
    return first.AddDays(7*week + adjust);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-05T16:04:16.550

```
using System;

namespace date_using_week_of_month
{

    public class Example
    {
        public static DateTime WthDayDOfMonthM( int w, DayOfWeek d, DateTime month )
        {
            return first( d, month ).AddDays( 7 * (w - 1) );
        }

        private static DateTime first( DayOfWeek d, DateTime month )
        {
            DateTime first = new DateTime(
                month.Year, month.Month, 1 );
            while ( first.DayOfWeek != d )
            {
                first = first.AddDays( 1 );
            }
            return first;
        }
    }
} 
```

# linq-to-sql - 使用linq to sql，数据库连接信息存放在哪里？

> ID：939402
> 
> 赞同：1
> 
> 时间：2009-06-02T13:09:28.683
> 
> 标签：linq-to-sql

使用linq to sql，数据库连接信息存放在哪里？

如何在每个查询的基础上将数据库覆盖到另一个数据库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T13:11:53.467

您不能按查询执行此操作；但你可以按数据上下文。只需将不同的连接或连接字符串传递给构造函数：

```
string connectionStringA = ..., connectionStringB = ...
using(var ctxA = new FooContext(connectionStringA)) {...}
...
using(var ctxB = new FooContext(connectionStringB)) {...}

using(SqlConnection conn = ...)
using(var ctxC = new FooContext(conn)) {...} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:10:36.327

[linq](http://www.west-wind.com/weblog/posts/203567.aspx)的数据库连接位于 web.config 或 application.config 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:12:06.463

你将它传递给[`DataContext`](http://msdn.microsoft.com/library/system.data.linq.datacontext.datacontext)实例。

使用生成的 DataContext 子类，默认构造函数将使用 project `.Settings`，因此来自`.config`文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:13:16.193

正如 aleemb 所说，数据库信息存储在配置文件中。检查您创建 dbml 映射的项目中的那个。

也就是说 - DatabaseContext 有一个将连接字符串作为参数的构造函数。但是，我不确定是否有一种好方法可以在不创建新的 DatabaseContext 对象的情况下基于每个查询覆盖它。如果您从两个不同的 DatabaseContext 对象创建实体，这确实可能会在将来给您带来问题。

# .net - 找不到 PInvoke DLL 'sqlceme30.dll'

> ID：939404
> 
> 赞同：0
> 
> 时间：2009-06-02T13:09:52.987
> 
> 标签：.net, windows-mobile

我是移动部署的新手。我正在使用标准移动设备。当我在真实设备上部署我的应用程序时出现此错误。

```
"   Can't find PInvoke DLL 'sqlceme30.dll'  ". 
```

任何人都可以帮助我吗？？？提前谢谢.. 问候 Pankaj Pareek

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:43:34.250

文件 sqlceme30.dll 是 SQL Server Compact Edition 的一部分，我假设您正在移动应用程序中使用它。

您是否在 cab 中包含了正确的 SQL Server CE dll？根据您创建安装程序的方式，您可能需要手动添加这些。您需要捆绑的不仅仅是 System.Data.SqlServerCe.dll 文件。以下链接将引导您完成使用 SQL Server CE 3.5 部署应用程序的步骤：[MSDN: How to: Deploy a SQL Server Compact 3.5 Database with an Application](http://msdn.microsoft.com/en-us/library/aa983326.aspx)

如果可以的话，我还建议升级到 SQL Server Compact Edition 3.5 SP1。您当前使用的是 3.0。性能稍微好一点，运行时间稍微小一点。

如果这没有帮助，请提供有关如何使用 SQL Server CE 以及如何部署移动应用程序的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T14:48:23.773

您似乎尚未在设备上安装 SQL Server CE。默认情况下，在 Visual Studio 中调试时，它会在您开始调试应用程序时自动复制并安装正确的 DLL。但在真实设备上，您必须自己进行此操作（或在应用程序的 CAB 中包含正确的 DLL）。查看 Joe Doyle 发布的链接，了解如何执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T00:23:23.743

看看这篇博[文 http://blogs.msdn.com/sqlservercompact/archive/2007/10/26/can-t-find-p-invoke-dll-sqlcemenn-dll.aspx](http://blogs.msdn.com/sqlservercompact/archive/2007/10/26/can-t-find-p-invoke-dll-sqlcemenn-dll.aspx)。尝试在您的设备上手动复制和安装这些文件：

```
sqlce30.dev.ENU.phone.wce5.armv4i.CAB 
sqlce30.phone.wce5.armv4i.CAB 
sqlce30.repl.phone.wce5.armv4i.CAB 
```

# asp.net-mvc - MVC 的理由？

> ID：939407
> 
> 赞同：3
> 
> 时间：2009-06-02T13:10:20.960
> 
> 标签：asp.net-mvc

我想知道是否有人可以为我提供一些答案。很长一段时间以来，我一直在要求将我们的内部应用程序交换为 MVC 架构。Rails 作为一个玩具绝对被击落，Struts 对我们做的应用程序来说太大了，Django 的名字让这些老人（石油和天然气行业）感到紧张，但最后，微软终于推出了 MVC 1.0。

由于权力是死心塌地使用微软技术，我想我可以说服他们将我们的应用程序迁移到 MVC 模式。不幸的是，我想不出一个充分的理由将我们基于表单的结构换成 MVC 风格。

谁能想到足以满足我老板的理由？:-)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-02T13:13:41.560

你有充分的理由转换吗？听起来你没有，所以我想知道你是否为了 MVC 本身而切换，我不鼓励你这样做。

当您希望更好地控制应用程序的输出和生命周期时，ASP.NET MVC 很有帮助。请记住，在许多情况下，这意味着您作为开发人员需要做更多的工作。MVC 框架适用于数据输入不密集的网站 - 换句话说，如果您处理大量表单 POST 并处理这些表单中的数据，那么 ASP.NET MVC 实际上会为您创建*更多*工作。

我的意思不是听起来很苛刻，但我觉得你想切换到 ASP.NET MVC 但不知道为什么很奇怪。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T13:12:53.403

有许多问题以不同的方式解决了这个问题：

> *   [我应该追求 ASP.NET WebForms 还是 ASP.NET MVC](https://stackoverflow.com/questions/191556/should-i-pursue-asp-net-webforms-or-asp-net-mvc)
> *   [做 ASP.NET 时如何决定哪个是正确的，WebForms 还是 MVC](https://stackoverflow.com/questions/328465/how-to-decide-which-is-right-webforms-or-mvc-when-doing-asp-net)
> *   [传统 ASP .NET 与 MVC](https://stackoverflow.com/questions/41712/traditional-asp-net-vs-mvc)
> *   [使用 ASP.Net MVC 与 Web 表单的最大优势](https://stackoverflow.com/questions/102558/biggest-advantage-to-using-aspnet-mvc-vs-web-forms)
> *   [MVC 与 Web 表单](https://stackoverflow.com/questions/837831/mvc-versus-webforms)
> *   [ASP.NET 与 ASP.NET MVC](https://stackoverflow.com/questions/875835/asp-net-vs-asp-net-mvc)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T13:19:11.957

我认为这不是“销售”MVC 的问题，而是了解它的优势。此外，您应该认真评估将现有系统迁移到 MVC 是否具有成本效益。然而，MVC 有很多优点——以下是我的一些想法：

*   分离控制、数据和表示使您的应用程序更易于维护
    *   更容易做出改变
    *   经过相对较短的学习曲线后，其他程序员更容易理解
*   更好的设计意味着更容易引入新功能。当一切都混在一起时，尝试添加缓存、表单验证等...
*   MVC 系统可能更易于测试（因此更可靠） - 测试控制器比测试数据、控制和演示代码的意大利面条要容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:25:26.687

“对于我们所做的应用程序来说，Struts 实在是太大了”

以什么方式？一旦我们了解了 Struts 的工作原理（非常快），我们公司甚至可以轻而易举地开发 Struts 简单的内部应用程序。一些 JSP、一些 Action、通过一些简单的 DAO 在 JDBC 中完成的后端数据库访问，将它们全部捆绑在与 ant/maven 的战争中并部署。完毕。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:17:46.497

我认为在这种情况下，OP 正在寻找一个实用（有利可图）的理由来切换到 MVC，因为大多数公司都是这样认为的。

最大的优点是为 ASP.NET MVC 应用程序创建单元测试要容易得多。一套好的单元测试可以作为持续集成过程的基础。

权力的底线是您可以在一个步骤中创建构建，简化部署，创建安装程序，补丁等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T13:18:04.547

Rails 和 Django 都遵循模型视图控制器 (MVC) 模式，因此听起来您只是在为自己创建大量工作。为什么要切换到 ASP.NET MVC **？**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T14:15:48.987

另外，请记住 Joel 的建议（[你不应该做的事情，第一部分](http://www.joelonsoftware.com/articles/fog0000000069.html)）：避免从头开始重写代码。

# wpf - WPF 中的 9 切片图像

> ID：939411
> 
> 赞同：2
> 
> 时间：2009-06-02T13:11:02.127
> 
> 标签：wpf, vb.net, apache-flex, image

我想知道是否有人知道如何在 WPF 和 VB.Net 中复制 Flex/Flash 的 9 片功能。我在 Flex 中多次使用 9 切片缩放，这将是 WPF 中的一项重要资产。我希望能够将图像作为 Canvas 的背景，并让它在不破坏圆角的情况下拉伸。请问，有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T16:35:16.340

我不知道有任何内置功能可以做到这一点，但您可以编写一个自定义控件来做到这一点。

这种控件的突出部分是一个 9 部分网格，其中 4 个部分具有固定大小（角），两个部分具有固定高度和可变宽度（中心顶部和中心底部），两个部分具有固定宽度和可变高度（左中和右中），最后部分具有可变的高度和宽度（中间）。仅在一个方向上拉伸（例如，制作一个仅水平增长的按钮）就像限制中间部分的高度一样简单。

在 XAML 中，这将是：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="20"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="20"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="20"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="20"/>
    </Grid.RowDefinitions>
</Grid> 
```

然后，您将添加对象以将图像绘制到（我将使用矩形），以及将内容放入（ContentPresenter）的对象：

```
<Rectangle Grid.Row="0" Grid.Column="0" x:Name="TopLeft"/>
<Rectangle Grid.Row="0" Grid.Column="1" x:Name="TopCenter"/>
<Rectangle Grid.Row="0" Grid.Column="2" x:Name="TopRight"/>

<Rectangle Grid.Row="1" Grid.Column="0" x:Name="CenterLeft"/>
<Rectangle Grid.Row="1" Grid.Column="2" x:Name="CenterRight"/>

<Rectangle Grid.Row="2" Grid.Column="0" x:Name="BottomLeft"/>
<Rectangle Grid.Row="2" Grid.Column="1" x:Name="BottomCenter"/>
<Rectangle Grid.Row="2" Grid.Column="2" x:Name="BottomRight"/>

<Grid Grid.Row="2" Grid.Column="1" x:Name="Middle">
  <Rectangle/>
  <ContentPresenter x:Name="MiddleContent"/>
</Grid> 
```

每个矩形都可以使用 ImageBrush 绘制，以便它们显示源图像的正确部分：

```
<Rectangle>
    <Rectangle.Fill>
        <ImageBrush ImageSource="Image.png" TileMode="None" 
                    <!-- Add the settings necessary to show the correct part of the image --> />
    </Rectangle.Fill>
</Rectangle> 
```

将所有这些包装到一个自定义控件中，您可以生成一个非常实用的 9 切片图像控件：

```
<local:NineSliceImage Image="Source.png" Slice="20,20">
    <TextBox Text="Nine Slice Image TextBox!"/>
</local:NineSliceImage> 
```

其中 Slice 是 System.Windows.Size 类型的属性，因此您可以像 Margin/Padding/etc 一样使用它。用于设置切片位置的属性。

您还需要在所有矩形上将 SnapToDisplayPixels 设置为 True；否则，当 WPF 尝试插入中间像素时，您会在某些分辨率下看到图像片段之间的小间隙。

如果您打算使用大量这些控件，另一种稍快的方法是覆盖 OnRender 并在那里执行；我过去曾为 3 切片图像控件做过此操作，但它有点棘手。

这应该让你大部分时间都在那里 - 如果我有什么遗漏，请发表评论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T15:00:07.833

这是我经过一番辛劳后最终得到的：

这是 SlicedImage.xaml 文件：

```
 <Rectangle Grid.Row="1" Grid.Column="0" SnapsToDevicePixels="True">
        <Rectangle.Fill>
            <ImageBrush x:Name="CenterLeft" Stretch="Fill" ViewboxUnits="Absolute" AlignmentX="Left"  AlignmentY="Center" />
        </Rectangle.Fill>
    </Rectangle>
    <Rectangle Grid.Row="1" Grid.Column="1" SnapsToDevicePixels="True">
        <Rectangle.Fill>
            <ImageBrush x:Name="CenterCenter" Stretch="Fill" ViewboxUnits="Absolute" AlignmentX="Center"  AlignmentY="Center" />
        </Rectangle.Fill>
    </Rectangle>
    <Rectangle Grid.Row="1" Grid.Column="2" SnapsToDevicePixels="True">
        <Rectangle.Fill>
            <ImageBrush x:Name="CenterRight" Stretch="Fill" ViewboxUnits="Absolute" AlignmentX="Right"  AlignmentY="Center" />
        </Rectangle.Fill>
    </Rectangle>

    <Rectangle Grid.Row="2" Grid.Column="0" SnapsToDevicePixels="True">
        <Rectangle.Fill>
            <ImageBrush x:Name="BottomLeft" Stretch="Fill" ViewboxUnits="Absolute" AlignmentX="Left"  AlignmentY="Bottom" />
        </Rectangle.Fill>
    </Rectangle>
    <Rectangle Grid.Row="2" Grid.Column="1" SnapsToDevicePixels="True">
        <Rectangle.Fill>
            <ImageBrush x:Name="BottomCenter" Stretch="Fill" ViewboxUnits="Absolute" AlignmentX="Center"  AlignmentY="Bottom" />
        </Rectangle.Fill>
    </Rectangle>
    <Rectangle Grid.Row="2" Grid.Column="2" SnapsToDevicePixels="True">
        <Rectangle.Fill>
            <ImageBrush x:Name="BottomRight" Stretch="Fill" ViewboxUnits="Absolute" AlignmentX="Right"  AlignmentY="Bottom" />
        </Rectangle.Fill>
    </Rectangle>

</Grid>

</UserControl> 
```

SlicedImage.xaml.vb 适合那些想要在 VB.Net 中使用的人：

```
Partial Public Class SlicedImage
Public imageSource As ImageSource
Public sliceTop As Double
Public sliceRight As Double
Public sliceLeft As Double
Public sliceBottom As Double

Public Sub New()

    InitializeComponent()

End Sub

Public Sub SetViewboxes()
    Dim RealHeight As Double = TopLeft.ImageSource.Height
    Dim RealWidth As Double = TopLeft.ImageSource.Width

    ColumnLeft.Width = New GridLength(sliceLeft)
    ColumnRight.Width = New GridLength(RealWidth - sliceRight)
    RowTop.Height = New GridLength(sliceTop)
    RowBottom.Height = New GridLength(RealHeight - sliceBottom)

    TopLeft.Viewbox = New Rect(0, 0, sliceLeft, sliceTop)
    TopCenter.Viewbox = New Rect(sliceLeft, 0, sliceRight - sliceLeft, sliceTop)
    TopRight.Viewbox = New Rect(sliceRight, 0, RealWidth - sliceRight, sliceTop)

    CenterLeft.Viewbox = New Rect(0, sliceTop, sliceLeft, sliceBottom - sliceTop)
    CenterCenter.Viewbox = New Rect(sliceLeft, sliceTop, sliceRight - sliceLeft, sliceBottom - sliceTop)
    CenterRight.Viewbox = New Rect(sliceRight, sliceTop, RealWidth - sliceRight, sliceBottom - sliceTop)

    BottomLeft.Viewbox = New Rect(0, sliceBottom, sliceLeft, RealHeight - sliceBottom)
    BottomCenter.Viewbox = New Rect(sliceLeft, sliceBottom, sliceRight - sliceLeft, RealHeight - sliceBottom)
    BottomRight.Viewbox = New Rect(sliceRight, sliceBottom, RealWidth - sliceRight, RealHeight - sliceBottom)

End Sub
Public Property ImageLocation() As ImageSource
    Get
        Return Nothing
    End Get
    Set(ByVal value As ImageSource)
        TopLeft.ImageSource = value
        TopCenter.ImageSource = value
        TopRight.ImageSource = value
        CenterLeft.ImageSource = value
        CenterCenter.ImageSource = value
        CenterRight.ImageSource = value
        BottomLeft.ImageSource = value
        BottomCenter.ImageSource = value
        BottomRight.ImageSource = value
    End Set
End Property

Public Property Slices() As String
    Get
        Return Nothing
    End Get
    Set(ByVal value As String)
        Dim sliceArray As Array = value.Split(" ")
        sliceTop = sliceArray(0)
        sliceRight = sliceArray(1)
        sliceBottom = sliceArray(2)
        sliceLeft = sliceArray(3)
        SetViewboxes()
    End Set
End Property

End Class 
```

用户控件将像这样使用：

```
<my:SlicedImage ImageLocation="Images/left_bubble.png" Slices="18 25 19 24" /> 
```

其中 ImageLocation 是图像位置，而 Slices 是“右上左下”，表示应如何对图像进行切片。所有尺寸都应从左上角开始。

# c# - 如何在 .NET 3.5 中使用 DataGridView？

> ID：939413
> 
> 赞同：0
> 
> 时间：2009-06-02T13:11:17.760
> 
> 标签：c#, winforms, .net-3.5, datagridview

我正在尝试构建一个如下所示的员工数据输入表单：

```
员工表格
-----------------------------------------------------------
--------------------------------------- |
| | 姓名 | | |
| 图片 | 部门 | | |
| | 职位 | | |
| | 出生日期 | | |
--------------------------------------- |
... 重复每位员工 |
... |
--------------------------------------- |
| | 姓名 | | |
| 图片 | 部门 | | |
| | 职位 | | |
| | 出生日期 | | |
--------------------------------------- |
-----------------------------------------------------------

```

使用 Microsoft Access 构建它非常容易，但是如何使用 Winforms + C# + .NET 3.5 构建它？
我尝试使用`DataGridView`，但我无法让它看起来像我上面的示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:54:46.937

好的。我终于带着笔记本电脑回家了。因此，我所做的与您想做的事情相同的是，我使用了一个 ListView，它是从数据表中动态填写的。这是代码（我正在做的事情的总结是在代码之后的底部）：

```
 For i = 0 To frmSelection.MechDataTable2.Rows.Count - 1
            Dim tmpGroup As ListViewGroup = New ListViewGroup(frmSelection.MechDataTable2.Rows(i).Item("MechName"))
            ltvMechs.Groups.Add(tmpGroup)
            Dim tmpListItem1 As ListViewItem = New ListViewItem(tmpGroup)
            Dim tmpListItem2 As ListViewItem = New ListViewItem(tmpGroup)
            Dim tmpListItem3 As ListViewItem = New ListViewItem(tmpGroup)
            Dim tmpListItem4 As ListViewItem = New ListViewItem(tmpGroup)
            Dim tmpListItem5 As ListViewItem = New ListViewItem(tmpGroup)

            'row1
            tmpListItem1.SubItems.Add("co1")
            tmpListItem1.SubItems.Add("co2")
            tmpListItem1.SubItems.Add("co3")
            tmpListItem1.SubItems.Add("co4")
            tmpListItem1.SubItems.Add("co5")
            tmpListItem1.SubItems.Add("co6")
            tmpListItem1.SubItems.Add("co7")

            tmpListItem1.SubItems(0).Text = "Select"
            tmpListItem1.SubItems(1).Text = frmSelection.MechDataTable2.Rows(i).Item("Price")
            tmpListItem1.SubItems(2).Text = frmSelection.MechDataTable2.Rows(i).Item("MechID")
            tmpListItem1.SubItems(3).Text = "Faction Orientation"
            tmpListItem1.SubItems(4).Text = frmSelection.MechDataTable2.Rows(i).Item("FactionOrientation")
            tmpListItem1.SubItems(5).Text = "Engine HDP"
            tmpListItem1.SubItems(6).Text = frmSelection.MechDataTable2.Rows(i).Item("EngineHardPoint")

            'row2
            tmpListItem2.SubItems.Add("co1")
            tmpListItem2.SubItems.Add("co2")
            tmpListItem2.SubItems.Add("co3")
            tmpListItem2.SubItems.Add("co4")
            tmpListItem2.SubItems.Add("co5")
            tmpListItem2.SubItems.Add("co6")
            tmpListItem2.SubItems.Add("co7")

            tmpListItem2.SubItems(0).Text = ""
            tmpListItem2.SubItems(1).Text = ""
            tmpListItem2.SubItems(2).Text = ""
            tmpListItem2.SubItems(3).Text = "Required Rep"
            tmpListItem2.SubItems(4).Text = frmSelection.MechDataTable2.Rows(i).Item("RequiredRep")
            tmpListItem2.SubItems(5).Text = "Generator HDP"
            tmpListItem2.SubItems(6).Text = frmSelection.MechDataTable2.Rows(i).Item("GeneratorHardPoint")

            'row3
            tmpListItem3.SubItems.Add("co1")
            tmpListItem3.SubItems.Add("co2")
            tmpListItem3.SubItems.Add("co3")
            tmpListItem3.SubItems.Add("co4")
            tmpListItem3.SubItems.Add("co5")
            tmpListItem3.SubItems.Add("co6")
            tmpListItem3.SubItems.Add("co7")

            tmpListItem3.SubItems(0).Text = ""
            tmpListItem3.SubItems(1).Text = ""
            tmpListItem3.SubItems(2).Text = ""
            tmpListItem3.SubItems(3).Text = "Resilience"
            tmpListItem3.SubItems(4).Text = frmSelection.MechDataTable2.Rows(i).Item("Resilience")
            tmpListItem3.SubItems(5).Text = "Heavy HDP"
            tmpListItem3.SubItems(6).Text = frmSelection.MechDataTable2.Rows(i).Item("HeavyHardPoint")

            'row4
            tmpListItem4.SubItems.Add("co1")
            tmpListItem4.SubItems.Add("co2")
            tmpListItem4.SubItems.Add("co3")
            tmpListItem4.SubItems.Add("co4")
            tmpListItem4.SubItems.Add("co5")
            tmpListItem4.SubItems.Add("co6")
            tmpListItem4.SubItems.Add("co7")

            tmpListItem4.SubItems(0).Text = ""
            tmpListItem4.SubItems(1).Text = ""
            tmpListItem4.SubItems(2).Text = ""
            tmpListItem4.SubItems(3).Text = "Weight"
            tmpListItem4.SubItems(4).Text = frmSelection.MechDataTable2.Rows(i).Item("Weight")
            tmpListItem4.SubItems(5).Text = "Medium HDP"
            tmpListItem4.SubItems(6).Text = frmSelection.MechDataTable2.Rows(i).Item("MediumHardPoint")

            'row5
            tmpListItem5.SubItems.Add("co1")
            tmpListItem5.SubItems.Add("co2")
            tmpListItem5.SubItems.Add("co3")
            tmpListItem5.SubItems.Add("co4")
            tmpListItem5.SubItems.Add("co5")
            tmpListItem5.SubItems.Add("co6")
            tmpListItem5.SubItems.Add("co7")

            tmpListItem5.SubItems(0).Text = ""
            tmpListItem5.SubItems(1).Text = ""
            tmpListItem5.SubItems(2).Text = ""
            tmpListItem5.SubItems(3).Text = "Structure"
            tmpListItem5.SubItems(4).Text = frmSelection.MechDataTable2.Rows(i).Item("Class")
            tmpListItem5.SubItems(5).Text = "Light HDP"
            tmpListItem5.SubItems(6).Text = frmSelection.MechDataTable2.Rows(i).Item("LightHardPoint")

            ltvMechs.Items.Add(tmpListItem1)
            ltvMechs.Items.Add(tmpListItem2)
            ltvMechs.Items.Add(tmpListItem3)
            ltvMechs.Items.Add(tmpListItem4)
            ltvMechs.Items.Add(tmpListItem5)
        Next 
```

基本上，每个列表项是组中的一行，每个子项是行中的一个单元格（类似于您在 excel 中看到的，访问等） subitem(0) 在 col1 中，subitem(1) 在 col2 等. 对于您的第一列，您将 listItem1 的 subitem(0) 作为图片，而您希望将所有其他 subitem(0) 设为空白。正如我在上面的评论中所说的，我在 vb.net 中对此进行了编码，但据我所知，它与 C# 并没有太大不同。这里还有一张这段代码产生的部分图片。对质量感到抱歉，但这是我能做的最好的事情。[替代文字 http://img268.imageshack.us/img268/7977/listviewexample.png](http://img268.imageshack.us/img268/7977/listviewexample.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:26:38.757

尝试构建一个自定义控件，其中包含单个员工的所有数据，然后将该控件的多个实例添加到 FlowLayoutPanel 或类似的东西。您的自定义控件可能很简单，只需一个包含图片框和一些文本框的拆分面板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T14:01:24.257

首先，获取[BindingListView](http://blw.sourceforge.net/)。然后，您可以将 List<T>s 绑定到 DataGridViews，而不是使用 DataTables/Sets。然后，您可以将第二列的 DataPropertyName 设置为“详细信息”属性，如下所示：

```
public string Details 
{ 
    get 
    { 
        return string.Format("{0}\n{1}\n{2}\n{3}", Name, Department, Position, DOB); 
    } 
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-06-02T13:19:20.910

为什么不尝试将数据绑定到这样的中继器？

```
<asp:Repeater ID="Repeater1" runat="server">
    <HeaderTemplate>
        <table>
    </HeaderTemplate>
    <ItemTemplate>
        <tr>
            <td rowspan="4">
                <%# Eval("Picture") %>
            </td>
            <td>
                <%# Eval("Name") %>
            </td>
        </tr>
        <tr>
            <td>
                <%# Eval("Department") %>
            </td>
        </tr>
        <tr>
            <td>
                <%# Eval("Position") %>
            </td>
        </tr>
        <tr>
            <td>
                <%# Eval("DOB") %>
            </td>
        </tr>
    </tr>
</ItemTemplate>
<FooterTemplate>
    </table></FooterTemplate>
</asp:Repeater> 
```

# nhibernate - 在 nHibernate 中，如何动态更改数据库连接（不同的数据库）？

> ID：939421
> 
> 赞同：0
> 
> 时间：2009-06-02T13:12:42.437
> 
> 标签：nhibernate

如果我想对我的数据库进行垂直分区，如何根据每个查询动态更改数据库连接？

即userID > 100000 使用db1，否则使用db0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T13:17:25.080

看到[这个](https://stackoverflow.com/questions/491139/how-do-you-change-nhibernates-connection-string-per-http-request)。

# git - 使用“拉”或“合并”来合并本地分支？

> ID：939422
> 
> 赞同：9
> 
> 时间：2009-06-02T13:12:48.067
> 
> 标签：git, merge, branch, pull

我见过两种不同的合并本地分支机构的方法。

```
git checkout master
git merge new_feature

git checkout master
git pull . new_feature 
```

有什么区别，优点/缺点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T14:02:03.740

从本地来说，merge 和 pull 没有区别。在处理远程时，“拉”首先获取远程的对象，然后与本地分支合并。但是在处理本地分支时，没有什么要获取的（所有对象都已经在本地存储库中），因此拉取的“获取”部分实际上是无操作的。那么，在本地情况下，“拉”与“合并”基本相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:20:10.800

在这种情况下，没有区别。

# python - Python中@符号的用途？

> ID：939426
> 
> 赞同：15
> 
> 时间：2009-06-02T13:13:22.763
> 
> 标签：python

我注意到在几个例子中我看到了这样的事情：

```
# Comments explaining code i think
@innerclass 
```

或者：

```
def foo():
"""
 Basic Doc String
"""
@classmethod 
```

谷歌搜索并没有让我走得太远，只是对这是什么的一般定义。我也无法在 python 文档中找到任何真正的东西。

这些有什么作用？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-02T13:17:30.960

它们被称为装饰器。它们是应用于其他功能的功能。这是我对类似问题的回答的副本。

Python 装饰器为另一个函数添加了额外的功能。斜体装饰器可能就像

```
def makeitalic(fn):
    def newFunc():
        return "<i>" + fn() + "</i>"
    return newFunc 
```

请注意，函数是在函数内部定义的。它基本上所做的就是用新定义的函数替换一个函数。例如，我有这堂课

```
class foo:
    def bar(self):
        print "hi"
    def foobar(self):
        print "hi again" 
```

现在说，我希望这两个函数在完成之后和之前都打印“---”。我可以在每个打印语句之前和之后添加一个打印“---”。但是因为我不喜欢重复自己，所以我会做一个装饰器

```
def addDashes(fn): # notice it takes a function as an argument
    def newFunction(self): # define a new function
        print "---"
        fn(self) # call the original function
        print "---"
    return newFunction
    # Return the newly defined function - it will "replace" the original 
```

所以现在我可以把我的班级改成

```
class foo:
    @addDashes
    def bar(self):
        print "hi"

    @addDashes
    def foobar(self):
        print "hi again" 
```

有关装饰器的更多信息，请查看[http://www.ibm.com/developerworks/linux/library/l-cpdecor.html](http://www.ibm.com/developerworks/linux/library/l-cpdecor.html)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-02T13:16:22.303

他们是装饰师。

`<shameless plug>` 我有一篇关于这个主题的[博客文章](http://jasonmbaker.wordpress.com/2009/04/25/the-magic-of-python-decorators/)。 `</shameless plug>`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-02T13:17:15.033

和

```
@function
def f():
    pass 
```

你只需`function`环绕`f()`。`function`被称为装饰器。

它只是以下的语法糖：

```
def f():
    pass
f=function(f) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T13:15:51.837

它是一种[`decorator`](http://docs.python.org/glossary.html#term-decorator)语法。

# windows-mobile - 是否有适用于 Mobile Messenger 的 API？

> ID：939428
> 
> 赞同：0
> 
> 时间：2009-06-02T13:13:37.303
> 
> 标签：windows-mobile, mobile, msn-messenger

你知道是否有 API 可以连接到移动信使吗？我有一个移动应用程序需要在移动信使上的联系人在线时接收回调。

我知道我可以查询 live messenger JSON 接口，但这需要我提取这些信息（并耗尽电池），但如果移动 Messenger 正在运行，它已经保持与 Messenger 服务的连接。

我可以在台式机的 messenger API 上看到大量文档，但这是针对移动设备的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T07:23:14.570

AFAIK 没有用于移动消息的 API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-27T01:26:05.590

如果您仍在努力将您的应用程序与移动信使集成，您还可以查看 Kik API。它适用于 Android 和 iPhone 平台，让您的用户可以在 Kik Messenger 和其他移动应用程序之间传输任意内容和文件。只需 5 行代码即可将其与您的应用程序挂钩。您可以在这里获得更多信息：[http ://www.kik.com/dev](http://www.kik.com/dev)

PS 一旦 Mango 推出，它也将适用于 Windows Phone 7。

免责声明：我是 Kik API 背后的开发人员之一 :)

# c# - 在 C# 中部署控制台应用程序的方法

> ID：939438
> 
> 赞同：43
> 
> 时间：2009-06-02T13:15:38.360
> 
> 标签：c#, visual-studio, console

我有一个相对复杂的控制台应用程序，它依赖于几个 dll。我想以最好的形式“运送”这个。我首选的方式是一个 exe 文件，其中嵌入了所有依赖项（不是那么大，大约 800K）。另一件事是只压缩“调试”文件夹的内容并使其可用，但我不确定是否一切都可以这样使用（是否所有依赖关系都可以通过压缩调试文件夹来解决？）

使用 VisualStudio 2008 部署用 C# 编写的控制台应用程序有哪些可靠的做法？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-06-02T13:17:35.267

如果你只是复制 Foo.exe、dll 和 Foo.exe.config 文件，它可能没问题。不过，请查看调试文件夹中的其他内容 - 您（可能）不想发送 .pdb 文件或 Foo.vshost.exe。还有别的事吗？如果您有任何标记为内容的项目被复制到输出文件夹，那么您也需要这些项目。

您*可以*使用[ilmerge](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)将所有依赖项放入一个 exe 文件中，但我对这种方法有些怀疑——我会坚持使用 exe + 依赖 dll。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-02T13:17:50.007

您应该查看Visual Studio 中的[设置项目](http://support.microsoft.com/kb/307353)。它们允许您设置依赖项并包含您需要的 DLL。最终结果是一个 setup.exe 和一个 MSI 安装程序。

这是一个应该有所帮助的[演练。](http://msdn.microsoft.com/en-us/library/k3bb4tfd(VS.71).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T13:20:58.097

或者您可以使用自解压 ZIP 文件。将所有普通文件（.exe、.dll、.config 和其他任何文件）打包成一个 zip 文件。解压到一个临时目录并将运行时提取程序设置为实际的控制台 exe。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:20:32.203

在 VS08 中创建一个安装项目并将控制台应用程序项目的主要输出添加到其中，这将解决依赖关系并将它们打包在 .msi 中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-24T07:30:25.670

您可以使用 wix 安装程序来捆绑它。对于控制台应用程序，exe +dependicies DLLs + nuget DLLs，压缩它们就足够了。

# android - Which Android development blog has the most walkthroughs and tutorials?

> ID：939444
> 
> 赞同：19
> 
> 时间：2009-06-02T13:15:53.380
> 
> 标签：android, blogs

I need to work on my Android development skills. Which blog has the freshest and most walkthroughs, code samples, and tutorials?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T13:30:11.543

> the freshest and most walkthroughs, code samples, and tutorials?

Unfortunately I don't think this is the best approch. Many of these tutorials are a year+ old (when Android was still in its alpha release); a lot has changed in terms of the API and UI conventions.

**Included API Samples**
I recommend being familiar with 1)simply creating a project and then 2)reviewing all the API samples included in your Android dev install. These samples should be in the `\samples\ApiDemos\src\com\example\android\apis` folder of your Android install path.

**Android Tutorials**
About 6 months ago I presented an Android overview at NYU's ITP with a simple hello world tutorial. It details how to get Eclipse and your first app up and running. It can be found here:

*   [http://perkmobile.com/tutorial_helloworld/Perk%20Mobile%20Android%20Tutorial.html](http://perkmobile.com/tutorial_helloworld/Perk%20Mobile%20Android%20Tutorial.html)

Also, we provided an mapping tutorial that demonstrates how to use web services in conjunction with Androids mapping control. Most importantly it shows how to safely makes use of background threads for managing HTTP requests.

*   [http://perkmobile.com/itp.html](http://perkmobile.com/itp.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-04T13:40:25.777

You might want to look at the list of blogs at [planetandroid.org](http://planetandroid.org) the list is on the right side.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-04T16:56:38.837

Well at least the "official" Android development blog contains pretty recent entries at [http://android-developers.blogspot.com/](http://android-developers.blogspot.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-28T16:09:26.733

Tutorial series for 2D and 3D on [droidnova.com - Android Development](http://www.droidnova.com)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-11T21:49:29.923

If you are looking for a comprehensive introductory tutorial for Android development, please check out my own (Game of Life) tutorial: [http://www.quesucede.com/page/show/id/conway_game_of_life_android](http://www.quesucede.com/page/show/id/conway_game_of_life_android).

Areas covered include (but not limited to): implementing a custom (orthogonal grid) component, a so-called 'game loop,' and the implementation of and the subsequent interaction with a preferences activity.

# asp.net - 对 MS AJAX Toolkit HTML 编辑器进行单元测试

> ID：939448
> 
> 赞同：0
> 
> 时间：2009-06-02T13:16:48.217
> 
> 标签：asp.net, unit-testing, selenium, ajaxcontroltoolkit, watin

是否可以对 MS AJAX 控制工具包的[HTML 编辑器](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/HTMLEditor/HTMLEditor.aspx)进行单元测试？我试过[Watin](http://watin.sourceforge.net/)， WebAii 和 Selenium 没有任何成功......

## 瓦廷

我可以找到与控件相关的文本框，但尝试访问它时出现异常：

```
using (Browser ie = new IE()) {
    ie.GoTo(testUri);
    Assert.IsTrue(ie.ContainsText("Expected text"));

    var textBox = ie.TextField(Find.ById(id => id.Contains("Editor")));
    textBox.TypeText("testing 123");
} 
```

> System.Runtime.InteropServices.COMException：无法将焦点移至控件，因为它不可见、未启用或属于不接受焦点的类型。

## 硒

我也尝试了 Selenium IDE，但没有任何成功。当我加载[ASP.net 的示例页面](http://asp.net/AJAX/AjaxControlToolkit/Samples/HTMLEditor/HTMLEditor.aspx)时，在编辑器中输入一些文本并单击“提交”按钮，这是它创建的测试用例：

```
[Test]
public void TheUntitledTest() {
    selenium.Open("/AJAX/AjaxControlToolkit/Samples/HTMLEditor/HTMLEditor.aspx");
    // Text was typed at this point
    selenium.Click("ctl00_SampleContent_submit");
} 
```

以下是在 Selenium IDE 中重新运行记录的操作的日志消息：

> [信息] 执行： |打开 | /AJAX/AjaxControlToolkit/Samples/HTMLEditor/HTMLEditor.aspx | |
> 
> [信息] 执行：|点击| ctl00_SampleContent_submit | |

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T03:34:35.410

查看控件它是一个 IFrame，其中编辑器实际上是一个可编辑的主体

```
<body contentEditable="true"> 
```

您应该能够使用 javascript 更新内部文本

```
IE.Frame(Find.BySrc(frameSrc)).Eval( ... javascript goes here ... ); 
```

watiN 中的命令，然后单击按钮。

另一种方法是移动鼠标，然后单击，然后发送键。

# definition - 遗留数据库一词是什么意思？

> ID：939465
> 
> 赞同：29
> 
> 时间：2009-06-02T13:18:25.077
> 
> 标签：definition, legacy-database

我读了很多这个词。什么是遗留数据库？我问是因为我认为这意味着像 dbase 或 rdb 这样的旧数据库，但我认为我是对的。

在查看 RoR 或 Django 和“遗留数据库”集成时，遗留数据库的真正含义是什么？它与通用术语“遗留数据库”不同吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-02T13:20:38.253

在一般情况下，它可以指代任何较旧的数据库技术。

在更具体的上下文中，它可以指代一个团队从以前的项目所有者那里继承的数据库系统。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-06-02T13:45:48.923

**遗产**：过去一直困扰着你的任何事情。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-02T13:28:07.100

遗留数据库通常是您必须继承并基于您的一些设计决策的东西。大多数推出工作的公司可能已经有一些其他（通常是可怕的）解决方案，你需要给他们一个更大更好的产品......

**但**

它必须与他们所有的旧遗留数据一起工作。该公司不想管理两个不同的应用程序，以便他们可以保留所有旧记录。您将需要开发您的解决方案，以便能够将数据从遗留系统迁移到您的系统中。这会对新数据库的整体设计产生巨大影响，因为它不能在不引入大量数据完整性方面的问题的情况下与以前的数据库相差太远。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-02T13:24:48.090

根据我的经验，这通常是贬义的：

*   任何人都不想碰的东西，以防它坏了
*   无法维护的数据库（比如说 SQL 6.5 的盒子）
*   别人设计和实现的数据库很糟糕
*   有人试图替换的东西
*   由 93 岁的 wierdo 支持

如果它正在使用中但仍有维护或开发活动，则它不能是遗留的......

编辑：鉴于 SQL 语言和 RDBMS 的时代，与列出的软件相比，一切都是遗留的（包括我明年到期的新系统）。从数据库的角度来看，Ruby 在什么时候变成了遗留系统......？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-02T13:26:22.410

我们主要使用术语“遗留数据库”作为数据库模式，如果不破坏使用此模式的其他软件/系统，我们无法“轻松”修改。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-02T13:34:37.323

[这](http://www.nightflight.com/foldoc-bin/foldoc.cgi?legacy+system)总结得很好。

[编辑] 断开的链接。以下是 FOLDOC 的引述：
Legacy System -- 一种计算机系统或应用程序，由于更换或重新设计它的成本，而且通常尽管其竞争力和与现代同类产品的兼容性较差，但仍继续使用。这意味着该系统庞大、单一且难以修改。

如果遗留软件仅在过时的硬件上运行，那么维护成本最终可能会超过更换软件和硬件的成本，除非某种形式的仿真或向后兼容性允许软件在新硬件上运行。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-02T13:21:45.397

我敢打赌，他们指的是数据库的架构，而不是数据库系统本身。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-11-10T03:51:23.927

平面文件、层次结构和网络数据库通常称为遗留数据库。它们代表了大约 30 年前史前时代人们用来组织信息的方式。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-07-11T06:56:37.167

Legacy 用于表示旧事物。遗留数据库是继续使用的东西，因为它需要更换和重新设计它的成本。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-02T13:23:16.470

在一般上下文中是指继承的旧**代码。**典型的 cobol 代码。它用于出于历史原因仍在使用的代码。它也适用于数据库模式

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-02-19T11:54:32.043

由于信息技术发展的悠久历史（包括不同硬件和操作系统的应用），许多企业获得了遗留数据库。

> ***遗留数据库***是一组异构数据库，它们结合了不同类型的数据系统，例如关系或面向对象的数据库、分层数据库、网络数据库、电子表格、多媒体数据库或文件系统。

遗留数据库中的异构数据库可以通过计算机内部或计算机间网络连接。
跨此类数据库的信息交换很困难，因为考虑到不同的语义，它需要从一种表示到另一种表示的精确转换规则

# .net - 用于新项目的 Linq2SQL

> ID：939473
> 
> 赞同：3
> 
> 时间：2009-06-02T13:19:47.553
> 
> 标签：.net, linq-to-sql, entity-framework, project-planning

**编辑**

感谢所有投入的家伙。非常欢迎提出意见，我认为此时我们将采用 L2S 实现，并以这样一种方式汇总/封装我们的 DAL，以便将来如果我们需要更改为 EF，它不会太轻松一个手术。

由于它非常主观，因此得分最多的海报。

**原创**

我一直在努力跟上整个 Entity Framework Vs 的速度。Linq2SQL 主题，并且已经有一些关于 SO 的问题，例如

[实体框架与。链接到 Sql](https://stackoverflow.com/questions/8676/entity-framework-vs-linq-to-sql)

我想知道的是（欢迎发表意见）如果你开始一个新的重大项目，你会使用 Linq2SQL 作为你的数据访问层吗？

为了提供一些背景信息，我们是一个 .NET C# House，DB 是 SQL Server 2000，但我们可能会在今年晚些时候将其移植到 SQL 2005。在我们的小型开发团队中，我是唯一拥有 C# 3.0 / .NET 3.5 经验的人。在过去的 3 年中，团队中的其他所有人都使用手工切割的 ADO.NET 和 SqlHelper 代码用于数据访问层，一直停留在 1.1/2.0 领域。

我想，我主要担心的是我们会用更先进/可用/更快开发的东西（即 L2S）开始这个新项目，但最终，它已经过时了。

如果我们受到打击，推迟项目并使用 VS2008 中的实体框架进行调查。

为任何输入的家伙干杯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T13:33:24.423

虽然 Microsoft 继续支持 Linq，但我怀疑它很有可能会被 Entity Framework 胜过，但他们还不想引起恐慌，并希望 Entity Framework 能够通过示例证明更有价值。

与 EF 3.5 SP1 相比，EF 4.0 中的新功能至少可以说非常引人注目，而且大多数争论都是围绕 L2S 与 EF 进行的。EF 4.0 具有 POCO、持久性无知、延迟加载、T4 模板、N 层支持等等。

就我个人而言，我会支持 EF 4.0，但它仍处于 Beta 阶段，直到今年年底才会进行 RTM，所以这真的取决于你的日程安排。也就是说，从 Linq 迁移到 SQL 比从 nHiberante 或其他技术迁移更容易，因此如果您明天需要上线，要么尝试使用 EF 4.0 的 Beta 1，要么使用 Linq 到 SQL。

到目前为止，Beta 1 获得了很好的评价，并且使用了 EFPocoAdapter（Beta 1 的前身），我很乐意推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T13:24:20.197

我相信，从中期来看，Linq 会继续存在。它的学习曲线比 EF 短（或者至少对我来说是这样），所以我就这样走了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:37:36.787

我会直接使用 LINQ to Entities 进入实体框架 (EF)。MS 已经宣布 EF 是未来数据库工作的前进方向，它是他们所有新产品的现有技术。因为您的大多数开发人员都没有使用过 LINQ，所以会有一个学习曲线，但是一旦您过去了，代码就会自然而然地出现。

EF 更加面向对象，因此与 LINQ to SQL 有不同的感觉。例如，在 EF 中，您表达与对象的关系，而 LINQ to SQL 允许您指定外键索引。即将推出的版本将更易于使用。[您可能会发现关注ADO.NET 团队博客](http://blogs.msdn.com/adonet/default.aspx)很有用。

乔

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:38:04.147

我会在 .Net 4.0 中选择 EF。不仅听说 L2S 处于维护模式，而且 EF 在新版本中也得到了很大的改进。对我来说最重要的是[这个](http://blogs.msdn.com/adonet/archive/2009/05/18/sneak-preview-entity-framework-4-0-testability-improvements.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:42:37.320

LINQ2SQL 是由 C# 团队创建的，用于将 SQL 结构 ORM 到类并在 C# 中查询它们。EF 由 ADO.NET DB 团队开发，因此它更适合于数据库方面，而不是程序员方面。由于 ADO.NET 是 Microsoft 的 DB 平台，他们当然会比 LINQ2SQL 更支持它，但这并不是说它们不会并行开发。

这是一个[链接到一个](http://blogs.microsoft.co.il/blogs/gilf/archive/2008/04/20/linq-to-sql-vs-entity-framework.aspx)并排比较 LINQ2SQL 和 EF 的页面。这不是所有要点，但至少有许多重要的要点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T14:08:47.283

EF 需要进一步发展。仍然缺少一些东西，例如隐式延迟加载、专注于数据库而不是专注于域模型等。阅读更多关于不信任投票的信息：http: [//blogs.msdn.com/timmall/archive/2008/06/24 /不信任投票.aspx](http://blogs.msdn.com/timmall/archive/2008/06/24/vote-of-no-confidence.aspx)

# .net - 显示特定于打印机的配置对话框

> ID：939481
> 
> 赞同：1
> 
> 时间：2009-06-02T13:21:19.190
> 
> 标签：.net, wpf, printing

有`PrintTicket`如何显示特定于打印机的配置对话框？

注意：我的意思不是`PrintDialog`来自`System.Windows.Controls`命名空间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-03-25T12:41:06.027

由于我不够值得信赖，无法编辑已接受的答案，因此我将发布第二个答案...

接受的答案适用于显示本机打印机对话框并从该对话框中获取更改。但是，它没有事先正确设置对话框上的属性。

为了将设置推送到本机对话框中，您必须更改 DocumentProperties 的签名，如下所示。新签名不使用 ref 参数作为输入。

[这是向](http://www.pinvoke.net/default.aspx/winspool/DocumentProperties.html)我指出这个微小但显着差异的页面。

```
[DllImport("winspool.Drv", EntryPoint = "DocumentPropertiesW", SetLastError = true, ExactSpelling = true,
  CallingConvention = CallingConvention.StdCall)]
static extern int DocumentProperties(
  IntPtr hwnd,
  IntPtr hPrinter,
  [MarshalAs(UnmanagedType.LPWStr)] string pDeviceName,
  IntPtr pDevModeOutput,
  IntPtr pDevModeInput,    //removed ref
  int fMode); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-01T16:46:34.143

要显示 PrinterSettings 对话框，请使用

```
[DllImport("winspool.Drv", EntryPoint = "DocumentPropertiesW", SetLastError = true, ExactSpelling = true,
  CallingConvention = CallingConvention.StdCall)]
static extern int DocumentProperties(
  IntPtr hwnd,
  IntPtr hPrinter,
  [MarshalAs(UnmanagedType.LPWStr)] string pDeviceName,
  IntPtr pDevModeOutput,
  ref IntPtr pDevModeInput,
  int fMode);

[DllImport("kernel32.dll")]
static extern IntPtr GlobalLock(IntPtr hMem);

[DllImport("kernel32.dll")]
static extern bool GlobalUnlock(IntPtr hMem);

[DllImport("kernel32.dll")]
static extern bool GlobalFree(IntPtr hMem);

private void OpenPrinterPropertiesDialog(PrinterSettings printerSettings) {
  var handle = (new System.Windows.Interop.WindowInteropHelper(this)).Handle;
  var hDevMode = printerSettings.GetHdevmode(printerSettings.DefaultPageSettings);
  var pDevMode = GlobalLock(hDevMode);
  var sizeNeeded = DocumentProperties(handle, IntPtr.Zero, printerSettings.PrinterName, pDevMode, ref pDevMode, 0);
  var devModeData = Marshal.AllocHGlobal(sizeNeeded);
  DocumentProperties(handle, IntPtr.Zero, printerSettings.PrinterName, devModeData, ref pDevMode, 14);
  GlobalUnlock(hDevMode);
  printerSettings.SetHdevmode(devModeData);
  printerSettings.DefaultPageSettings.SetHdevmode(devModeData);
  GlobalFree(hDevMode);
  Marshal.FreeHGlobal(devModeData);
}

// Show this dialog.
var printQueue = LocalPrintServer.GetDefaultPrintQueue();
var settings = new PrinterSettings { PrinterName = printQueue.FullName };
OpenPrinterPropertiesDialog(settings); 
```

# css - 带有 JQUERY 或其他东西的简单圆角边框

> ID：939482
> 
> 赞同：0
> 
> 时间：2009-06-02T13:21:26.803
> 
> 标签：css, rounded-corners

**复制：**

*   [创建圆角的最佳方法是什么](https://stackoverflow.com/questions/7089/what-is-the-best-way-to-create-rounded-corners-using-css)
*   [如何使跨浏览器、W3C 有效、语义、非 JavaScript 圆角？](https://stackoverflow.com/questions/746627/)
*   [jQuery圆角](https://stackoverflow.com/questions/270380/jquery-round-corners)

你知道为 div 元素制作圆角边框的方法吗？我使用了 ruzee，但在使用 CalenderExtender(asp.net ajax) 和 GMDatePicker 组件时遇到了问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T13:26:11.317

在 CSS 3 中将有一个标准。今天，您可以通过以下方式做到这一点（仅适用于基于 Mozilla 和 Webkit 的浏览器）：

```
.roundBorder {
    -moz-border-radius: 1em;
    -webkit-border-radius: 1em;
} 
```

否则，您可以将多个 div 与背景图像一起使用，但 JQuery 将提供一种更简单的方法（我不知道 :()

多个 div 方式可能如下所示：

html:

```
<div class="topLeft">
    <div class="topRight">
        <div class="bottomLeft">
            <div class="bottomRight">
                 <div class="content">
                 </div>
            </div>
        </div>
    </div>
</div> 
```

CSS：

```
.topLeft {
    background-image: url('topLeft.png');
    background-position: top left;
    background-repeat: no-repeat;
}

.topRight {
    background-image: url('topRight.png');
    background-position: top right;
    background-repeat: no-repeat;
}

.bottomLeft {
    background-image: url('bottomLeft.png');
    background-position: bottom left;
    background-repeat: no-repeat;
}

.bottomRight {
    background-image: url('bottomRight.png');
    background-position: bottom right;
    background-repeat: no-repeat;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T13:27:13.233

您可以使用 CSS3 边框半径属性，但 IE 尚不支持此功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T13:27:15.167

对于 JQuery，您可以使用“角落”。看[这里](http://malsup.com/jquery/corner/)

# jquery - jquery animate 不会触发

> ID：939485
> 
> 赞同：1
> 
> 时间：2009-06-02T13:21:47.957
> 
> 标签：jquery, jquery-animate, opacity

```
<html>
    <head>
        <style type="text/css">
            div#bg1 {
                height:             159px;
                width:              800px;
                margin-left:        auto;
                margin-right:       auto;
                background-image:   url('images/bg1.jpg');
                background-repeat:  no-repeat;
                background-position:center center;
                position:           relative;
                z-index:            3;
            }
            div#bg2 {
                height:             159px;
                width:              800px;
                margin-left:        auto;
                margin-right:       auto;
                background-image:   url('images/bg2.jpg');
                background-repeat:  no-repeat;
                background-position:center center;
                position:           relative;
                z-index:            2;
                margin-top:         -159px;
            }
        </style>
        <script type="text/javascript" src="http://jqueryjs.googlecode.com/files/jquery-1.3.2.min.js"></script>
        <script type="text/javascript">
            function Animate_2() 
            {
                $("div#bg1").animate({opacity: 100}, 2000);
                $("div#bg2").animate({opacity: 0  }, 2000);
                setTimeout(Animate_1, 5000);
            }

            function Animate_1() 
            {
                $("div#bg1").animate({opacity: 0  }, 2000);
                $("div#bg2").animate({opacity: 100}, 2000);
                setTimeout(Animate_2, 5000);
            }

            $(function()
            {
                /* Start cycle */
                setTimeout(Animate_1, 5000);
            });
        </script>
    </head>
    <body>
        <div id="bg1"></div>
        <div id="bg2"></div>
    </body>
</html> 
```

Animate_1() 工作正常，但 Animate_2() 只会显示 bg2.jpg 而不会为不透明度设置动画。这在 IE 和 Firefox 中是一样的。

为什么会这样>？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:29:28.610

您真正的问题是不透明度是 0 到 1 的比例，而不是 0 到 100。但这里有一些轻微的改进：

您也可以大大简化代码，因为您刚刚将一个图像放在另一个图像之上。

```
 <script type="text/javascript">
        var shown = true;

        function toggleFront() {
            shown = !shown;
            $("div#bg1").animate({opacity: shown*1}, 200);
            window.setTimeout(toggleFront, 1000);
        }

        $(function() {
            /* Start cycle */
            window.setTimeout(toggleFront, 500);
        });
    </script> 
```

我弄乱了你的时间值以更快地显示它。

或者修复它。你需要`window.`在 setTimeout 之前。简单的修复。

```
 <script type="text/javascript">
        function Animate_2() 
        {
            $("div#bg1").animate({opacity: 1}, 2000);
            $("div#bg2").animate({opacity: 0  }, 2000);
            window.setTimeout(Animate_1, 5000);
        }

        function Animate_1() 
        {
            $("div#bg1").animate({opacity: 0  }, 2000);
            $("div#bg2").animate({opacity: 1}, 2000);
            window.setTimeout(Animate_2, 5000);
        }

        $(function()
        {
            /* Start cycle */
            window.setTimeout(Animate_1, 5000);
        });
    </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T14:42:09.883

我无法获得您在 Firefox 3.0.10 Ubuntu 上描述的相同结果，`Animate_2`似乎工作正常。起初我认为这可能是因为您可能使用本地文件而不是通过 localhost 服务器（如 apache）运行您的页面，但这并没有改变我的结果，但我记得在 Windows 平台上工作的问题在过去。我还使用以下预加载脚本进行了尝试，这似乎确实消除了我机器上的初始动画卡顿：

```
jQuery.preloadImages = 函数（）
                {
                  for(var i = 0; i").attr("src", arguments[i]);
                    }
                }
$.preloadImages("imgages/bg1.jpg", "imgages/bg2.jpg");

```

# asp.net-mvc - 如何为 ASP.NET MVC 站点的 OpenId 用户分配角色？

> ID：939488
> 
> 赞同：6
> 
> 时间：2009-06-02T13:22:40.480
> 
> 标签：asp.net-mvc, authorization, roles, dotnetopenauth

我在我的 ASP.NET MVC 应用程序中使用 OpenId。效果很好:) 一旦我有了用户的 OpenId 标识符（一旦他们经过身份验证并返回到我的站点），我就会加载用户数据（以获取显示名称等）。

从这里，我也知道了他们的角色。

我不确定如何将角色分配给当前的 Forms.Identity。

这是我的代码...

```
// Load User...
var user = GetUsers().ByOpenIdIdentifier("blahblahblahbl....");

// Here means we have a user AND all the roles, for that user.

// Forms Authenticate and Redirect.
FormsAuthentication.SetAuthCookie(user.DisplayName, true);
return RedirectToAction("Index", "Home"); 
```

我如何更改此代码，以便经过身份验证的用户也分配了他们的角色？

### 更新

我偶然发现了这篇关于制作自定义 Authorize 属性的[网络帖子。](http://schotime.net/blog/index.php/2009/02/17/custom-authorization-with-aspnet-mvc/)请注意他们如何检查会话中存在的登录用户角色？此外，角色是一个枚举 :) 这很时髦，如果你问我 :) 很好很简单。

想法（与完整的 RoleProvider 类相比？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T13:32:14.423

您需要[编写](http://msdn.microsoft.com/en-us/library/8fw7xh74.aspx)自己的[RoleProvider](http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.aspx)并将其连接到 web.config 文件中。您的 RoleProvider 将获取用户的姓名并确定他们的角色。 [IPrincipal.IsInRole](http://msdn.microsoft.com/en-us/library/system.security.principal.iprincipal_members.aspx)使用配置的 RoleProvider 来确定角色成员资格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-19T05:26:15.257

看看[这篇文章](http://www.eggheadcafe.com/tutorials/aspnet/4b3c7c9b-fe80-4e6e-a34e-0e9efed5c575/integrate-openid-authentication-with-aspnet-membership-roles-and-profile.aspx)

它展示了一种将 openid 与成员角色和配置文件集成的简单方法。希望能有所帮助。

# asp.net - 如何使用 jQuery 模拟表单的提交？

> ID：939489
> 
> 赞同：5
> 
> 时间：2009-06-02T13:23:10.310
> 
> 标签：asp.net, jquery, submit

我的 ASP.NET 网页上有一个表单。还有提交按钮。我有一些验证逻辑附加到按钮的客户端单击事件。我想从我的 jQuery 验证逻辑提交这个表单，如何实现这个？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-02T13:30:50.090

假设您的表单的 id 为“myform”，则以下 jquery 将导致它被提交。

```
$("#myform").submit(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T13:25:14.500

使用纯 JS，您可以：

```
this.form.submit(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:30:35.790

我假设您想使用 jQuery 将表单提交回 ASP.NET。

有一个 $.post(url, { param1: param1value, param2: param2value}, function(response){ // 处理响应 }); jQuery 中的语法，它允许您将表单异步提交到代码隐藏文件。

主要的概念变化是您的页面不会刷新，而且您的响应应该只包含您想要的内容。

要通过示例应用程序详细了解，请随时通过以下链接：

[http://sites.google.com/site/spyderhoodcommunity/tech-stuff/howtosubmitaformusingjqueryviaajaxtoanaspnetandreceivetheresponse](http://sites.google.com/site/spyderhoodcommunity/tech-stuff/howtosubmitaformusingjqueryviaajaxtoanaspnetandreceivetheresponse)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:29:13.153

如果您想使用代码来执行此操作，fmsf 的答案很好，但是如果用户单击附加了验证代码的提交按钮，只要您不抑制事件或返回 false，它就会提交。

因此，您可以简单地使用提交按钮而不是常规按钮并获得相同的结果

# svn - 如何将项目“切换”到子文件夹？

> ID：939494
> 
> 赞同：1
> 
> 时间：2009-06-02T13:23:31.540
> 
> 标签：svn, tortoisesvn

我在我的仓库中创建了一个“根”文件夹，并将我的所有项目文件和文件夹移到那里。现在我想“切换”我的本地副本，以便它与这个文件夹而不是整个存储库通信。这该怎么做？

现在，当我进行更新时，我不仅得到了我的旧文件，而且它在我的本地副本上创建了文件夹“根”并将我的项目的整个副本移动到那里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:29:08.613

右键单击包含您的工作副本的文件夹并选择 TortoiseSVN->Switch。现在只需输入新的 URL 并更新。

# emacs - 终端无法识别 C-Tab？

> ID：939497
> 
> 赞同：2
> 
> 时间：2009-06-02T13:23:57.780
> 
> 标签：emacs, key-bindings

我想将 company-mode-map 绑定到 C-tab，但它似乎不起作用。我输入了 Ch k C-tab，它只是说我输入了 TAB 而不是 C-Tab。它在 Xwindows 中工作，有什么办法可以解决终端模式下的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T14:07:38.130

我找到了[这些](http://www.staldal.nu/tech/2009/01/10/how-to-use-ctrl-tab-in-gnu-screen/)针对使用 GNU 屏幕的指导，但它们在常规终端模式下对我有用。添加后：

```
*vt100.translations: #override \n\
    Ctrl ~Shift <Key>Tab: string(0x1b) string("[27;5;9~") \n \
    Ctrl Shift <Key>Tab: string(0x1b) string("[27;6;9~") \n 
```

到我的 .Xresources 文件，`C-tab`在我的终端中被识别，并且 Emacs 找到了绑定。

# php - PHP 语法错误

> ID：939506
> 
> 赞同：0
> 
> 时间：2009-06-02T13:24:56.593
> 
> 标签：php

我想弄清楚为什么我会收到这个错误

`"Parse error: syntax error, unexpected T_STRING, expecting ',' or ';' in /home/idgcca/public_html/web-design-samples-testing.php on line 64"`

* * *

```
echo ' 
<div style="float:left; width: 180px; margin: 20px 0px 10px 0px;"><a rel="lightbox[web]" title="'. $post->title .'" onmousedown="this.title='<a target=\'_blank/\' href=\'http:www.google.ca/\'>Google</a>';" onmouseout="this.title='';" href="'. $post->url . '">

<img src="' . $post->thumb . '" border="0"/></a> <div class="design-sample-txt">'. $post->author.'</div></div>

'; 
```

* * *

我是一个 PHP 新手，只是想自己理解它，但我的头在转动。非常感谢您的帮助...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T13:29:20.093

这是你的问题：

```
this.title='< 
```

你应该逃避这句话。以及结束`a`标签上的那个。像这样：

```
echo '<div style="float:left; width: 180px; margin: 20px 0px 10px 0px;">
    <a rel="lightbox[web]" title="'. $post->title .'"
       onmousedown="this.title=\'<a target=\'_blank/\' href=\'http:www.google.ca/\'>Google</a>\';"
       onmouseout="this.title=\'\';" href="'. $post->url . '">    
    <img src="' . $post->thumb . '" border="0"/></a>
    <div class="design-sample-txt">'. $post->author.'</div>
</div>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T13:30:30.623

您在那条线上有一个未终止的字符串。你应该用这样的斜杠转义你的引号 \"

echo "<div style=**\"**float:left;.....";

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T13:33:10.227

您需要在单引号字符串中转义单引号。

```
echo '<div style="float:left; width: 180px; margin: 20px 0px 10px 0px;"><a rel="lightbox[web]" title="'. $post->title .'" onmousedown="this.title=\'<a target=\'_blank/\' href=\'http:www.google.ca/\'>Google</a>\';" onmouseout="this.title=\'\';" href="'. $post->url . '">'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:33:55.170

我建议您将代码分成多行以提高可读性。

这将有助于调试这种线。

看一下[echo 运算符](http://fr2.php.net/echo)示例

为了回答您的问题，您的代码中有一些引号被滥用。你需要逃离他们。

```
 echo '<div style="float:left; width: 180px; margin: 20px 0px 10px 0px;">
<a rel="lightbox[web]" title="'. $post->title .'" onmousedown="this.title=\'<a 
target=\'_blank/\' href=\'http:www.google.ca/\'>Google</a>\';" 
onmouseout="this.title=\'\';" href="'. $post->url . '"><img src="' . $post->thumb . '" 
border="0"/></a> <div class="design-sample-txt">'. $post->author.'</div></div>'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:34:28.977

假设您准确地粘贴了代码，第*一个*错误就在开头，当您结束第一个引号时。它期望阅读：

```
echo ' title .'; 
```

相邻的两个引号没有任何意义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T13:34:29.723

你从 SilentGhost 得到了答案。

我会用[HEREDOC 来做](http://us.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)这些事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T13:47:33.567

您应该[`htmlspecialchars`](http://docs.php.net/htmlspecialchars)在这些属性值上使用：

```
function html($str, $charset=null) {
    if (!is_null($charset)) {
        return htmlspecialchars($str, ENT_QUOTES, $charset);
    } else {
        return htmlspecialchars($str, ENT_QUOTES);
    }
}

echo '
    <div style="float:left; width: 180px; margin: 20px 0px 10px 0px;">
        <a rel="lightbox[web]"
           title="' . html($post->title) . '"
           onmousedown="' . html('this.title=\'<a target="_blank" href="http://www.google.ca/">Google</a>\'') . '"
           onmouseout="' . html('this.title=""') . '"
           href="' . html($post->url) . '">
            <img src="' . html($post->thumb) . '" border="0"/></a>
        <div class="design-sample-txt">' . html($post->author) . '</div>
    </div>
'; 
```

# com - 什么是 VBScript 错误代码 0x800A01FB

> ID：939508
> 
> 赞同：1
> 
> 时间：2009-06-02T13:25:01.350
> 
> 标签：com, asp-classic, vbscript

我有一个基于 ASP、VB6、COM 和 SQL Server 的解决方案。Web 服务器是 IIS 6。

不定期地，我在 ASP 页面上收到以下错误消息：

```
Microsoft VBScript runtime (0x800A01FB)
An exception occurred: 'objPSM.GetValue' 
```

（其中“objPSM”是我自己的会话处理 COM 类）。

如果我重新加载页面，它可以工作。

我尝试用谷歌搜索错误代码，它出现了这篇文章（[http://support.microsoft.com/kb/262681](http://support.microsoft.com/kb/262681)），但这不应该适用于我的问题，因为我不使用 Session 对象——我有我自己的使用 cookie 和数据库存储状态的会话处理代码。

这是轰炸出来的VB代码：

```
Public Function GetValue(ByVal pSessionID As String, _
                         ByVal pName As String) As String

   Dim ErrSource As String
   Dim ErrNumber As Long
   Dim ErrDescription As String

   On Error GoTo Err_Handler

   Dim lConn As ADODB.Connection
   Dim cmd As ADODB.Command

   Dim lReturnValue As String

   Set lConn = GetDBConn
   Set cmd = CreateObject("ADODB.Command")
   cmd.ActiveConnection = lConn
   cmd.CommandText = "pss_getvalue"

   cmd.Parameters.Append cmd.CreateParameter("p_pss_id", adVarChar, adParamInput, 36, pSessionID)
   cmd.Parameters.Append cmd.CreateParameter("p_pss_name", adVarChar, adParamInput, 35, pName)
   cmd.Parameters.Append cmd.CreateParameter("p_pss_value", adVarChar, adParamOutput, 255)

   cmd.Execute , , adCmdStoredProc

   lReturnValue = Nvl(cmd.Parameters("p_pss_value").Value, "")

   lConn.Close
   Set cmd = Nothing
   Set lConn = Nothing

   GetValue = lReturnValue

Exit_Procedure:
   Exit Function

Err_Handler:
   ErrSource = Err.Source
   ErrNumber = Err.Number
   ErrDescription = Err.Description
   On Error Resume Next
   Call LogEvent(ErrSource & ".GetValue: ", ErrNumber & ": " & ErrDescription)
   GetValue = ""
   GoTo Exit_Procedure
End Function 
```

请注意，即使这里有一个错误处理程序，代码也永远不会到达这里，因为 VB 运行时停止并引发异常，从而导致 ASP 页面损坏，而不是静默记录并返回空白字符串。

有人知道错误代码（0x800A01FB）是什么意思吗？

**更新：**与托管服务提供商交谈，他们回收了 IIS 应用程序池。错误消失了。如果问题再次出现，将返回此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:44:42.843

此错误最可能的来源是 ADODB。请参阅[为什么-do-i-get-800a01fb-errors](http://tutorials.aspfaq.com/8000xxxxx-errors/why-do-i-get-800a01fb-errors.html)。

由于 COM 类是您自己的，您是否考虑过将调试器附加到运行 ASP 的进程并查看您的 COM 代码中发生错误的位置？未能在您的 COM 代码中添加一些错误处理以在错误离开您的组件之前生成有关错误的更多详细信息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-02T16:22:02.000

与托管服务提供商交谈，他们回收了 IIS 应用程序池。错误消失了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T14:57:36.047

看起来 - objPSM - 可能正在使用带有 adUseClient 的 RecordSet 作为 RecordSet 或 Connection Object 上的参数之一，因为这是在 GIT 中使用的。

> “COM 提供了一个称为全局接口表 (GIT) 的组件。GIT 允许应用程序在表中存储对对象接口的引用，以便可以随时检索接口指针。当将接口指针存储到 GIT 中时, 为 IMarshal 查询对象，如果 IMarshal 被对象公开，则将对象的封送数据放入流中，在以后检索接口指针时可以在其中检索它。 IMarshal 由客户端游标公开它实际上是传递记录集数据的。**如果将使用 adUseClient 的打开的 ADO Recordset 对象放入 GIT 中，然后从表中撤消，则会出现问题。将发生访问冲突。**为避免此问题，请在对 Recordset 调用 Open 之前将 Recordset 的接口指针放入 GIT。这将在调用客户端游标引擎之前将接口指针放入 GIT，这将实质上导致发生标准封送处理，而不是记录从游标引擎通过 IMarshal 流式传输的数据。在这种情况下，只会存储指向 ADO 记录集接口的指针，这是程序员的真正意图。” [http://support.microsoft.com/kb/249175/EN-US/](http://support.microsoft.com/kb/249175/EN-US/)

了解编组[http://support.microsoft.com/kb/248287/EN-US/](http://support.microsoft.com/kb/248287/EN-US/)

看起来这在 MDAC 2.6 中已修复

如何检查您的 MDAC 服务器版本[http://support.microsoft.com/kb/301202](http://support.microsoft.com/kb/301202)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:00:30.567

所有此类错误代码都定义在 winerror.h 中（Google 了一下，得到了这个链接：[winerror.h 先](http://msdn.microsoft.com/en-us/library/ms819772.aspx) 了解一下 32 位错误代码格式，了解每个位的含义，以便以后了解类似的错误代码。

01FB 是错误代码：（`CO_E_OBJNOTREG`对象未注册）

00A 指的是发生错误的“设施”：

`#define FACILITY_CONTROL 10`

# javascript - 动态创建图像标签以在未安装 silverlight 时显示

> ID：939523
> 
> 赞同：1
> 
> 时间：2009-06-02T13:27:43.950
> 
> 标签：javascript

我正在使用 Silverlight.CreateObject 动态创建一个 silverlight 对象。未安装 silverilght 时，它会显示来自微软的自己的专利图像。我想用我的替换这个图像......我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:41:11.707

[确定是否安装了 Silverlight](http://blogs.msdn.com/piotrp/archive/2008/05/07/determining-if-silverlight-is-installed-using-javascript.aspx)，然后根据结果做任何你想做的事情......

（您可以在上面的链接网站上找到 isSilverLightInstalled() 的内容）

```
function isSilverLightIntstalled() {
  // see website
}

if (!isSilverLightInstalled()) {
  var myImage = new Image;
  myImage.src = “image URL goes here”;
  document.appendChild(myImage);
} 
```

# mysql - 如何解决此异常：数据源拒绝建立连接，来自服务器的消息：“连接太多”

> ID：939527
> 
> 赞同：1
> 
> 时间：2009-06-02T13:28:17.973
> 
> 标签：mysql, hibernate

我正在使用 Hibernate 3 +Mysql 5.1，在插入 98 之后我得到了这个异常：

com.mysql.jdbc.exceptions.MySQLNonTransientConnectionException：数据源拒绝建立连接，来自服务器的消息：“连接太多”

我的 hibernate.cfg.xml 文件是：

com.mysql.jdbc.Driver jdbc:mysql://localhost/xml root root 10 false org.hibernate.dialect.MySQLDialect update true

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T13:31:48.437

您是否在 finally 块中关闭连接？

像这样的东西？

```
Session sess = factory.openSession();
Transaction tx;
try {
   tx = sess.beginTransaction();
   //do some work
   ...
   tx.commit();
}
catch (Exception e) {
   if (tx!=null) tx.rollback();
   throw e;
}
finally {
   sess.close();
} 
```

如果你不这样做，你将用完连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T13:30:21.573

我猜您的应用程序正在泄漏连接（在没有正确关闭它们的情况下打开它们）。

# javascript - 当页面完全呈现时，如何执行 Javascript 函数？

> ID：939538
> 
> 赞同：7
> 
> 时间：2009-06-02T13:29:43.667
> 
> 标签：javascript, javascript-events

当页面完全呈现（显示）时，您将如何执行 Javascript 函数我知道 onLoad 事件在页面加载时执行，但在它呈现之前执行。

我以前通过使用间隔为 0 的超时解决了这个问题，这似乎通常可以工作，但似乎对我敏感的感觉有点不雅。

有没有合适的方法来做到这一点？

UI 使用原型作为我的 java 脚本框架，因此涉及的答案很有帮助，但是我认为这将内置到 Javascript 中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T13:35:50.783

当页面完全呈现（包括图像等依赖项）时，会触发 onload 事件。

也许您将它与 Prototype 的[dom:loaded 事件](http://www.prototypejs.org/api/document/observe)（在加载 DOM 时触发但在包含所有依赖项之前触发）混淆了？

（老实说，这听起来像是[一个 XY 问题](http://www.perlmonks.org/index.pl?node_id=542341)。）

# matlab - 带有结构和空单元格数组的 MATLAB“错误”（或非常奇怪的行为）

> ID：939544
> 
> 赞同：7
> 
> 时间：2009-06-02T13:30:21.450
> 
> 标签：matlab, cell-array, matlab-struct

我不知道这里发生了什么。我正在使用 R2006b。在我提交错误报告之前，是否有可能使用较新版本的人进行测试以查看他们是否获得相同的行为？

代码： ( `bug1.m`)

```
function bug1
S = struct('nothing',{},'something',{});
add_something(S, 'boing');          % does what I expect
add_something(S.something,'test');  % weird behavior
end

function add_something(X,str)
    disp('X=');
    disp(X);
    disp('str=');
    disp(str);
end 
```

输出：

```
>> bug1
X=
str=
boing
X=
test
str=
??? Input argument "str" is undefined.

Error in ==> bug1>add_something at 11
    disp(str);

Error in ==> bug1 at 4
add_something(S.something,'test'); 
```

看起来空虚/虚无`S.something`允许它转移函数调用的参数。这似乎是非常糟糕的行为。在短期内，我想绕过它（我正在尝试创建一个函数，将项目添加到最初为空的单元格数组中，该单元格数组是结构的成员）。

**编辑：**

推论问题：所以没有办法构造一个`struct`包含任何空单元格数组的文字？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-02T13:44:16.163

正如您自己已经发现的那样，这不是错误，而是“功能”。换句话说，这是[STRUCT](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/struct.html)函数的正常行为。如果将空元胞数组作为字段值传递给 STRUCT，则假定您需要一个具有给定字段名称的空结构数组。

```
>> s=struct('a',{},'b',{})

s = 

0x0 struct array with fields:
    a
    b 
```

要将空元胞数组作为实际字段值传递，您可以执行以下操作：

```
>> s = struct('a',{{}},'b',{{}})

s = 

    a: {}
    b: {} 
```

顺便说一句，*任何*时候您想使用 STRUCT 将字段值设置为元胞数组都需要将其包含在另一个元胞数组中。例如，这将创建一个结构元素，其字段包含一个元胞数组和一个向量：

```
>> s = struct('strings',{{'hello','yes'}},'lengths',[5 3])

s = 

    strings: {'hello'  'yes'}
    lengths: [5 3] 
```

但这会创建一个包含两个结构元素的数组，分布单元数组但*复制*向量：

```
>> s = struct('strings',{'hello','yes'},'lengths',[5 3])

s = 

1x2 struct array with fields:
    strings
    lengths

>> s(1)

ans = 

    strings: 'hello'
    lengths: [5 3]

>> s(2)

ans = 

    strings: 'yes'
    lengths: [5 3] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T13:39:35.860

啊……我想我找到了答案。[`struct()`](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/struct.html)具有多种行为，包括：

> 注意 如果任何值字段是空元胞数组 {}，MATLAB 软件会创建一个空结构体数组，其中所有字段也为空。

显然，如果您将 0x0 结构的成员作为参数传递，它就像某种空幻像，并没有真正出现在参数列表中。（这仍然可能是一个错误）

错误2.m：

```
function bug2(arg1, arg2)
disp(sprintf('number of arguments = %d\narg1 = ', nargin));
disp(arg1); 
```

测试用例：

```
>> nothing = struct('something',{})

nothing = 

0x0 struct array with fields:
    something

>> bug2(nothing,'there')
number of arguments = 2
arg1 = 
>> bug2(nothing.something,'there')
number of arguments = 1
arg1 = 
there 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T13:42:11.223

这种行为在 2008b 中仍然存在，实际上并不是真正的错误（尽管我不会说设计者打算这样做）：当您进入 add_something(S,'boing') 并观看第一个参数时（比如选择它并按下 F9)，你会得到*一些*与空结构 S 相关的输出。进入 add_something(S.something,'test') 并观察第一个参数，你会发现它实际上被解释为 'test' ！

语法 struct.fieldname 旨在返回“逗号分隔列表”类型的对象。matlab 中的函数旨在接收这种确切类型的对象：参数名称按照传递的顺序赋予列表中的值。在您的情况下，由于第一个参数是一个**空列表**，因此函数接收的逗号分隔列表实际上从您传递的第二个值开始 - 即“测试”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T13:35:26.633

R2008b 中的输出相同：

```
>> bug1
X=
str=
boing
X=
test
str=
??? Input argument "str" is undefined.

Error in ==> bug1>add_something at 11
    disp(str);

Error in ==> bug1 at 4
add_something(S.something,'test');  % weird behavior 
```

# objective-c - 如何从 iPhone 上的 NSMutableArray 中检索整数值？

> ID：939549
> 
> 赞同：6
> 
> 时间：2009-06-02T13:30:53.680
> 
> 标签：objective-c, iphone, cocoa-touch, xcode

如何从 NSMutableArray 中获取整数值？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-02T13:34:14.360

您需要使用[NSNumber](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/nsnumber_Class/Reference/Reference.html)：

```
myArray = [NSMutableArray array];
[myArray addObject:[NSNumber numberWithInteger:1234]];

//..

int theNumber = [[myArray objectAtIndex:0] integerValue]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-05T09:24:45.097

如果你愿意，你有这个扩展

创建文件**extends.h**在您的项目中添加此代码和**#import "extends.h" ：**

```
/*______________________________ Extends NSMutableArray ______________________________*/
/**
 * Extend NSMutableArray
 * By DaRkD0G
 */
@interface NSMutableArray (NSArrayAdd)
/**
 *  Get element at index
 *
 *  @param index
 */
- (NSObject *) getAt:(int) index;
@end
/**
 * Extend NSMutableArray Method
 * By DaRkD0G
 */
@implementation NSMutableArray (NSArrayAdd)
/**
 *  Get element at index
 *
 *  @param index
 */
- (NSObject *) getAt:(int) index {
    NSInteger anIndex = index;
    NSObject *object = [self objectAtIndex:anIndex];
    if (object == [NSNull null]) {
        return nil;
    } else {
        NSLog(@"OK found ");
        return object;
    }

}
@end
/*______________________________ Extends NSArray ______________________________*/
/**
 * Extend NSArray
 * By DaRkD0G
 */
@interface NSArray (NSArrayAdd)
/**
 *  Get element at index
 *
 *  @param index
 */
- (NSObject *) getAt:(int) index;
@end
/**
 * Extend NSArray Method
 * By DaRkD0G
 */
@implementation NSArray (NSArrayAdd)
/**
 *  Get element at index
 *
 *  @param index
 */
- (NSObject *) getAt:(int) index {
    NSInteger anIndex = index;
    NSObject *object = [self objectAtIndex:anIndex];
    if (object == [NSNull null]) {
        return nil;
    } else {
        NSLog(@"OK found ");
        return object;
    }

}
@end 
```

**采用 ：**

```
NSObject object = [self.arrayItem getAt:0];
NSObject object2 = [self.arrayItem getAt:50]; 
```

# windows - WinInet API 的代理服务器有什么特殊设置吗？

> ID：939550
> 
> 赞同：1
> 
> 时间：2009-06-02T13:31:09.670
> 
> 标签：windows, winapi, proxy, wininet

我正在使用 WinInet API 通过 HTTP 访问 Internet 文件。除非用户通过代理服务器，否则一切正常。

我正在使用带有 INTERNET_OPEN_TYPE_PRECONFIG 的 InternetOpen，它应该从注册表中获取和使用代理信息（根据文档）。我是否需要使用 INTERNET_OPEN_TYPE_PRECONFIG 并专门指定代理？

在 InternetOpen 之后，我调用 InternetOpenUrl，然后调用 InternetReadFile。一切都很好，除非用户使用代理服务器。

我需要改变什么才能让它工作？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T14:31:41.853

这是正确的。我只是使用 InternetOpen(0, INTERNET_OPEN_TYPE_PRECONFIG, 0, 0, 0) 并且它可以工作。可能不是代理？

# design-patterns - 如何在我的场景中设计可扩展且安全的数据结构？

> ID：939553
> 
> 赞同：0
> 
> 时间：2009-06-02T13:31:49.310
> 
> 标签：design-patterns, data-structures, extensible

我正在开发一个网站，我需要构建一个数据结构来存储用户配置文件信息。就像我们填写的关于我们的性别/年龄/教育/等的内容一样。Facebook等的信息。我遇到的当前问题是如何设计一个可扩展且安全的数据结构，更详细地说，

1.  目前我可能不会考虑当前设计/开发阶段所需的所有用户配置文件信息，如何设计一个可扩展的框架以便将来我可以轻松扩展用户配置文件？是否有任何成熟的（开源）用户配置文件框架可供参考？目前我将每个属性存储到一个数据库列中，每次我需要一个来自需求的新属性时，我都需要添加列——不太方便。

2.  如何确保为不同的应用程序共享用户配置文件信息是安全的？例如，app1 只需要用户配置文件的一部分，出于安全原因，我只需将用户配置文件的一部分暴露给 app1。但是我们需要让它足够灵活，以便当 app1 需要额外的用户配置项时，我们可以轻松地公开更多。

C# 或中性编程语言的解决方案值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:06:10.273

正如我在[其他答案](https://stackoverflow.com/questions/937882/user-profile-definition-issue/937889)中指出的那样，您的问题的解决方案是：应用软件工程。这就是我们所做的——对于这样一个广泛的问题，[没有简单的解决方案](http://en.wikipedia.org/wiki/No_Silver_Bullet)（例如使用框架 x 或库 y）。

# active-directory - 使用 Active Directory 同步我的文档文件夹？

> ID：939555
> 
> 赞同：0
> 
> 时间：2009-06-02T13:32:06.063
> 
> 标签：active-directory, synchronization, documents

我正在尝试为 Active Directory 域中的用户设置备份功能。

希望客户端“我的文档”文件夹同步到文件服务器上的文件夹。

仅使用 Active Directory 是否可行，还是需要任何第三方应用程序？

如果可行，在服务器和客户端上进行设置需要哪些步骤？

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:37:26.677

您正在寻找的功能称为“文件夹重定向”。它通过组策略进行管理。在 Microsoft TechNet 或 Google 上搜索“文件夹重定向”，您会发现大量有关如何执行此操作的信息。

您不需要任何第三方应用程序，并且至少需要安装一个 Windows Server 和一个 Windows Client（XP、Vista、7）。

# c# - C# 从 get 中返回一个只读变量；放;

> ID：939563
> 
> 赞同：36
> 
> 时间：2009-06-02T13:33:38.010
> 
> 标签：c#, properties, readonly

我发誓我见过这样的例子，但已经用谷歌搜索了一段时间，找不到它。

我有一个类引用了一个对象并且需要一个 GET；方法。我的问题是我不希望任何人能够摆弄它，即我希望他们获得它的只读版本，（注意我需要能够在我的班级中更改它）。

谢谢

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-06-02T13:37:09.190

不，没有办法做到这一点。例如，如果您返回 a `List<string>`（并且它不是不可变的），那么调用者*将*能够添加条目。

解决这个问题的正常方法是返回一个不可变的包装器，例如[`ReadOnlyCollection<T>`](http://msdn.microsoft.com/en-us/library/ms132474.aspx).

对于其他可变类型，您可能需要在返回值之前对其进行克隆。

请注意，仅返回一个不可变的接口视图（例如，返回`IEnumerable<T>`而不是`List<T>`）不会阻止调用者转换回可变类型并进行变异。

编辑：请注意，除此之外，这种担忧是不可变类型更容易推理代码的原因之一:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T13:35:10.660

返回对精简接口的引用：

```
 interface IFoo
   string Bar { get; }

 class ClassWithGet
   public IFoo GetFoo(...); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T14:03:28.247

如果对象不是太复杂/广泛，那么在它周围写一个包装器。

例如：

```
class A {
    public string strField = 'string';
    public int intField = 10;
}

class AWrapper {
    private A _aObj;

    public AWrapper(A aobj) {
      _aObj = A;
    }

    public string strField {
         get {
            return _aObj.strField;
         }
    }

    public int intField {
         get {
            return _aObj.intField;
         }
    }
} 
```

所以现在你要做的就是给你的客户代码一个 AWrapper 类的实例，这样他们就可以只使用你允许他们看到的东西。

如果您的基类不是一成不变的，这可能会变得有点复杂并且可能无法很好地扩展，但对于大多数简单的情况它可能只是解决问题。我认为这被称为外观模式（但不要引用我的话=））

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T13:43:33.280

这是不可能的。获取和设置引用类型的访问器获取和设置对对象的引用。您可以通过使用私有（或内部）setter 来阻止对引用的更改，但如果对象被 getter 公开，则无法阻止对对象本身的更改。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-06T23:46:30.067

您的问题看起来像您正在寻找：

```
public PropertyName { get; private set; } 
```

但是，鉴于到目前为止的答案，我不确定我是否正确解释了您的问题。此外，我有什么资格去质问 Jon Skeet？:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T13:58:33.590

我同意 ReadOnlyCollection

看我的简单代码：

```
 private List<Device> _devices;
public readonly System.Collections.ObjectModel.ReadOnlyCollection<Device> Devices 
{
 get
 { 
return (_devices.AsReadOnly());
 } 
```

}

ReadOnlyCollection 没有 Add 方法，因此用户无法向其添加属性。但不能保证用户是否可以通过调用对象的方法来修改对象......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-21T14:18:29.837

我以某种方式面对过这个问题。我有一个 CategoryViewModel 类，它有一个我想要私有只读的属性 Category ：

```
public CategoryViewModel
{
    private Category { get; }

} 
```

事实上，我希望它以只读方式导出到其他类。但是我不能做这样的事情。就我而言（也许它会帮助其他一些人），我想将它添加到存储库中。我发现的唯一方法是使用存储库作为参数 1 的函数，以及作为参数 2 的操作：

```
public void ApplyAction(ICategoryRepository repo, Action<ICategoryRepository, Category> action)
{
    action(repo, Category);
} 
```

像那样，从其他地方，我可以做这样的事情：

```
 categoryViewModel.ApplyAction(_repository, (r, c) => r.MarkForInsertOrUpdate(c)); 
```

这可以帮助其他人仅在某些情况下公开那里的财产并可以管理它们。

# firefox - SelfSSL 和 Firefox 3 的问题

> ID：939566
> 
> 赞同：1
> 
> 时间：2009-06-02T13:34:00.677
> 
> 标签：firefox, selenium

我有一个使用 SelfSSL（IIS 资源工具包的一部分）设置安全证书的 IIS 网站。当我在 ISS 中查看该证书时，它显示为有效，它适用于 IE、Safari 和 Google Chrome。但是，在 Firefox 3 中，它不认为证书有效，因此当您查看网站上的安全页面时会显示证书警告。

这只是一个问题，因为我使用 Selenium 来自动测试站点。我已经尝试使用自定义 Firefox 配置文件来解决这个问题，这适用于一个 IIS 站点。但是，当每个开发人员都有自己的站点时，您必须不断向此自定义配置文件添加例外。

我可以将其他浏览器用于 Selenium 脚本，但我更愿意使用 Firefox（IE 上的表单输入似乎比 Firefox 运行得慢得多）。

我认为解决这个问题的最简单方法是首先拥有有效的证书，因此我开始使用 SelfSSL。任何想法为什么 Firefox 似乎没有注意到？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T07:51:54.497

SelfSSL 不会生成有效证书 - 它会生成自签名证书。要获得有效证书，您必须从证书颁发机构购买。

如果您的 IE、Chrome 或 Safari 在访问您的安全页面时未显示警告，则表示您已将此新证书添加到您帐户的受信任证书数据库中。您也可以在 Firefox 中执行此操作 - 它只有一个单独的数据库。但是您的每个用户都必须为自己执行此操作。

# c++ - C++/C 对象->isOnStack()

> ID：939567
> 
> 赞同：5
> 
> 时间：2009-06-02T13:34:04.030
> 
> 标签：c++

由于多种原因，我希望能够在运行时确定指针是否在堆栈上。就像我将它传递给函数调用一样，我可以确定是否需要克隆它。或者我是否需要删除它。

在 Microsft C (VC 6,7,8) 中，有没有办法对指针进行边界检查以查看它是否在堆栈中？我只关心在拥有放置对象的堆栈的线程上确定这一点。

就像是

static const int __stack_size 和 __stack_top

？？？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T13:54:52.007

知道一个对象是在堆栈上还是在堆上并不能告诉你它是否应该被调用的函数克隆或删除。毕竟，您可以克隆任何一种类型，虽然您不应该尝试删除堆栈分配的函数，但也不应该尝试删除所有堆指针。

有一个函数会做一些神秘的检查，看看它是否应该删除一个传递的指针，这会导致混乱。您不希望出现这样一种情况，即您可能会或可能无法引用您传递的对象中的字段，具体取决于上下文。您也不想冒险尝试释放堆栈对象的错误。

没有任何标准的方法可以告诉指针指向什么，任何非标准的方法都可能会中断。您不能指望堆栈连续性，尤其是在多线程应用程序中（并且有人可以轻松地将线程添加到应用程序而没有意识到后果）。

唯一安全的方法是有一个调用约定，被调用的函数将或不会删除传递的对象，或者传递某种智能指针。其他任何事情都是自找麻烦。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T13:45:14.040

有趣的问题。

这是关于如何确定它的想法，但不是函数调用。在堆栈上的应用程序的最开始创建一个虚拟变量。在函数 isOnStack( void *ptr ) 中在堆栈上创建一个变量 检查“ptr”是否位于虚拟变量和局部变量之间。

请记住，堆栈对于给定线程是连续的。我不确定当您开始从一个线程检查到另一个线程以获取此信息时会发生什么。

如果它不在堆栈中，那么它必须在堆中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-02T13:51:39.347

我不知道有什么方法可以确定对象的分配位置。

我认为应该避免这种行为。这些事情应该通过用户和图书馆开发者之间的合同来解决。在文档中说明这些内容！如果不确定复制对象（这需要一个复制构造函数并避免您尝试复制不可复制的对象）。

您还可以使用Boost 中的[智能指针](http://www.boost.org/doc/libs/1_39_0/libs/smart_ptr/smart_ptr.htm)。如果不确定何时不再需要某个对象，请将其作为共享指针传递。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T13:44:43.043

这样做取决于函数的调用约定。一些调用约定将参数放在寄存器中，而另一些则将它们放在堆栈头部之后的内存中。每一个都是调用者/被调用者之间的不同协议。因此，在堆栈中的任何函数边界都可以使用不同的约定。这迫使您跟踪每个级别使用的调用约定。

例如，在 fastcall 中，可以通过寄存器传递一个或多个参数。 [有关更多信息，请参阅 MSDN。](http://msdn.microsoft.com/en-us/library/6xa169sk(VS.71).aspx)这会弄乱任何方案来确定地址是否存在于某个范围内。在 MS 的 thiscall 中，this 指针是通过寄存器传递的。&this 不会解析为介于堆栈开始和结束之间的值范围之间的某个位置。

底线，研究调用约定，它指定堆栈内存的布局方式。这是一个[很好的教程](http://unixwiz.net/techtips/win32-callconv-asm.html)

**请注意**，这是非常特定于平台的！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T04:07:18.900

在某些平台上，堆栈可以由运行时系统拆分。也就是说，系统不会出现（不是双关语）堆栈溢出，而是自动获取更多堆栈空间。当然，新堆栈空间通常与旧堆栈空间不连续。

因此，依赖堆栈中是否有东西确实是不安全的。

使用 auto_ptr 通常不需要这种东西，而且更酷。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T03:22:08.990

好吧，我同意可能有更好的方法来做你想做的事情。但无论如何，这是一个有趣的问题。所以为了讨论...

首先，没有办法做到这一点是可移植的 C 或 C++。您必须至少使用一个`asm{ }`块进行组装。

其次，我不会在生产代码中使用它。但是对于 VC++/x86，您可以通过检查变量的地址是否在**ESP**和**EBP**寄存器的值之间来确定变量是否**在堆栈中。**

 ****您的 ESP（扩展堆栈指针，低值）保持堆栈的顶部，而 EBP（扩展基指针）通常位于底部。这是x86 上[调用堆栈的结构。](http://en.wikipedia.org/wiki/Call_stack#Structure)

调用约定主要会影响函数参数，以及如何处理返回地址等。所以它与你的堆栈关系不大。反正不适合你的情况。

让事情失望的是编译器优化。您的编译器可能会遗漏帧指针 ( EBP )。这是 VC++ 中的[-Oy 标志](http://msdn.microsoft.com/en-us/library/2kxx5t2c.aspx)。因此，如果有的话，您可以使用函数参数的地址，而不是使用 EBP 作为基指针。因为那些在堆栈上有点高。

但是如果你正在测试的那个变量在你的调用者的堆栈上呢？还是比你高几代**的调用者堆栈？**好吧，您可以遍历整个调用堆栈，但是您可以看到这会变得非常丑陋（好像还没有:-)）

由于您的生活很危险，您可能感兴趣的另一个编译器标志是[- Gh flag](http://msdn.microsoft.com/en-us/library/c63a9b7h.aspx)。使用该标志和合适的**_penter**钩子函数，您可以轻松地为函数或文件或模块等设置这些计算。但请不要这样做，除非你只是想看看事情是如何运作的。

弄清楚堆上有什么更糟糕....

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-09T21:36:40.900

MSVC Windows 编译器特定答案。这当然是特定于对象所在的线程。将任何自动堆栈项传递到除它所在的堆栈之外的任何线程是一个非常糟糕的主意，所以我不担心:)

bool __isOnStack(const void *ptr)
{

*   // FS:[0x04] 4 Win9x 和 NT 栈顶
    // FS:[0x08] 4 Win9x 和 NT 当前栈底
    const char *sTop;
    常量字符 *sBot;
    __asm {
    mov EAX, FS:[04h]
    mov [sTop], EAX
    mov EAX, FS:[08h]
    mov [sBot], EAX

    }
    return( sTop > ((const char *)ptr) && ((const char *)ptr) > sBot);

}

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T14:01:35.317

这是非常特定于平台的，IMO 仅适用于调试构建诊断。您需要做的（在 WIntel 上）是这样的：

创建线程时，创建一个堆栈变量，并将其地址存储在全局（threadid，堆栈基地址）映射中。

IsOnStack 需要创建自己的局部变量，并检查传递的指针是否在堆栈基址和当前堆栈帧中的地址之间。

这不会告诉您其他线程中的任何 abotu 变量。堆栈地址减少，因此基地址高于当前地址。

* * *

作为一个可移植的解决方案，我会传递一个 boost::shared_ptr，它可以与一个删除器相关联。（在 boost 中，这不是模板参数，因此它不会“感染”使用指针的函数）。

您可以像这样创建一个“非托管”指针：

```
inline void boost_null_deleter(void *) {}

template <typename T> inline
boost::shared_ptr<T> unmanaged_ptr(T * x)
{
   return boost::shared_ptr<T>(x, ::boost_null_deleter);
} 
```

并像这样调用你的函数

```
Foo local = { ... };
FooPtr heapy(new Foo);

FunnyFunc(unmanaged_ptr(&local));
FunnyFunc(heapy); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T02:15:17.067

我一直想要 C++ 中的这样一个特性，但实际上并没有什么好东西存在。您可以期望的最好的结果是记录您希望传递一个位于堆上的对象，然后在代码中建立一个习惯用法，以便在代码库上工作的每个人都知道将堆分配的对象传递给您的代码. 对于这种需求，使用类似 auto_ptr 或 boost::shared_ptr 是一个很好的习惯用法。

# c# - 如何在客户端刷新集合？

> ID：939569
> 
> 赞同：0
> 
> 时间：2009-06-02T13:34:24.453
> 
> 标签：c#, .net, entity-framework, wcf-ria-services

我从服务器加载客户端数据：

```
var context = new WordsDomainContext();
context.LoadWords(); 
```

我根据需要使用我的集合*上下文*。客户端上的单词。它运作良好。但我想刷新我的*上下文*。出于某些原因的话。当我再次调用`context.LoadWords()`新记录时，只需附加到当前集合。

我尝试使用`MergeOption context.LoadWords(null, MergeOption.OverwriteCurrentValues, null)`但没有效果。

如何清理我的*Words*集合并从服务器加载新数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-02T13:56:28.293

您可能需要在使用之前调用它`LoadWords()`：

```
context.Refresh(System.Data.Objects.RefreshMode.StoreWins, context.LoadWords); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-16T14:25:56.720

您可以使用以下命令从数据库中简单地刷新客户端上的集合：

```
collection.Load(MergeOption.OverwriteChanges); 
```

顺便说一句 - 集合是一种`EntityCollection`类型。

# c# - 检测是否显示工具提示？

> ID：939579
> 
> 赞同：7
> 
> 时间：2009-06-02T13:35:17.990
> 
> 标签：c#, winforms, tooltip, visibility

我正在使用 show 方法在控件上手动显示 System.Windows.Forms.Tooltip，但是如何检测当前是否显示了工具提示？

如果我需要更改显示它的方法以找出答案，那很好。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-06T15:05:39.160

您可以尝试 ToolTip.GetToolTip(control)，并检查返回的值是否不是空字符串，如下所示：

```
if (!string.IsNullOrEmpty(myToolTip.GetToolTip(myControl)))
{
    // 胜利！
}
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-06T15:50:05.797

我在内置工具提示上遇到了很多麻烦，我用计时器和跟踪 MouseMoved 构建了自己的工具提示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-06T15:39:10.210

如果这是唯一可能显示的工具提示，请使用 Tommy 的解决方案。

如果有您无法控制的工具提示，您可以枚举所有工具提示窗口并检查其中一个是否是

a) 所示

b) 在您的表单/应用程序范围内

有点像这样：

```
Native.EnumWindows ew = new Native.EnumWindows();
ew.GetWindows();

foreach (EnumWindowsItem item in ew.Items)
{
    //find all windows forms tooltips currently visible
    if (item.ClassName.StartsWith("WindowsForms10.tooltips_class32") && item.Visible)
    {
        //check if tooltip is on within form bounds
        if (item.Location.X >= this.Location.X && item.Location.Y >= this.Location.Y && 
            item.Location.X <= this.Location.X + this.Width &&
            item.Location.Y <= this.Location.Y + this.Height)
        {
            //Tooltip currently shown within form bounds
        }
    }

} 
```

将此[代码](http://www.koders.com/csharp/fid4CB5C44EF42AFC04F4AA921220968210292B4D9B.aspx)用于[EnumWindows](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fms633497.aspx&ei=U40qSvfrDNKksAbL3b2eDA&usg=AFQjCNHKHFPlxEMCcPu-tQhVLiuHlavrmg)互操作包装器。这有点小技巧，如果 Tommy 的解决方案对您有用，那就**更好了**。

# functional-programming - SICP DrScheme 中的哪种语言？

> ID：939582
> 
> 赞同：13
> 
> 时间：2009-06-02T13:35:44.463
> 
> 标签：functional-programming, scheme, racket, sicp

我一直在 DrScheme 4.2 中使用 SICP 模块，但在 DrScheme 中哪种语言对 SICP 的支持最好？

这里有人试过吗[？](http://planet.plt-scheme.org/display.ss?package=sicp.plt&owner=neil)

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-03T05:01:24.730

我认为除了DrScheme 中提供的[R5RS](http://www.schemers.org/Documents/Standards/R5RS/)`Language > Choose Language...`之外，您不需要任何东西。

您可能希望允许重新定义绑定。选择 R5RS 后，单击“ `Show Details`”并取消选中“ `Disallow redefinition of initial bindings`”。

[文中有些](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-14.html#%_sec_2.1.3) [地方](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-16.html#%_sec_2.3.2) [用到](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-12.html#%_sec_1.3.3)了`error`R5RS中没有的函数。在这些情况下，您可以使用[srfi-23](http://srfi.schemers.org/srfi-23/srfi-23.html)。

另一种选择是简单地使用“方案”模块语言。选择“模块”作为您选择的语言，并使用`#lang scheme`或开始您的源文件`#lang scheme/base`。

对于“[示例：一种图片语言](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-15.html#%_sec_2.2.4)”一章，你可以试试[这个包](http://planet.plt-scheme.org/display.ss?package=sicp.plt&owner=soegaard)（我自己没有试过，所以我不知道它的效果如何）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-03T05:21:55.453

> **对 DrRacket 的 SICP 支持**
> 
> 该软件包在 PLT 的 DrRacket 中实现了对 Abelson 和 Sussman 的计算机程序结构和解释 (SICP) 第 2 版教科书的支持，适用于希望使用 DrRacket 工具进行 SICP 编程作业的学生。

[http://www.neilvandyke.org/racket-sicp/](http://www.neilvandyke.org/racket-sicp/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T15:25:13.417

我在 SICP 的同一个地方，并且正在使用 - “编程语言精要”作为语言。它还没有引起任何问题。

# google-maps - 谷歌地图：想要添加/删除 GEvent 监听器到地图

> ID：939586
> 
> 赞同：1
> 
> 时间：2009-06-02T13:36:08.363
> 
> 标签：google-maps

我想为 Google 地图添加和删除相同的事件。

因为我已经在地图上附加了一个监听器到“moveend”事件，所以事件会打开一个大的 infoWindow，然后也会发生“moveend”事件，我不想为这件事运行。知道如何打开和关闭“moveend”事件监听器吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T13:54:42.553

您可以删除事件侦听器，但您必须传递添加事件时返回的确切侦听器。

例如

```
//add moveend listener
var moveendListener = GEvent.addListener(source, "moveend", yourfunction);

//remove moveend listener
GEvent.removeListener(moveendListener); 
```

或者

```
//remove all listeners associated with an event
GEvent.clearListeners(source, "moveend") ; 
```

编辑：另一种选择是让监听器调用的函数在不同条件下表现不同。

例如

```
function moveendHandler() {
    if (isWhateverActive()) return;

    //code to run if whatever is not active
} 
```

# ruby - 窗户上的 rbuic

> ID：939588
> 
> 赞同：1
> 
> 时间：2009-06-02T13:36:30.033
> 
> 标签：ruby, user-interface, qt

我没有运气让 rbuic UI 编译器（来自 qt4-qtruby-1.4.10 版本）在 Windows 上产生任何输出。即使运行 rbuic -h 也不起作用。我猜输出是在标准输出以外的地方......有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T08:44:26.170

我根据this安装了我的qt环境并根据[this](http://www.arachnoid.com/ruby/RubyGUIProject/)[使用](http://tom.paschenda.org/blog/?p=38)rbuic 。我必须输入 rbuic4 例如：

```
rbuic4 -h 
```

输出帮助。rbuic 输出默认为标准输出，因此如果要将输出重定向到文件：

```
rbuic4 sampledialog.ui -o sampledialog_ui.rb 
```

做这项工作。希望这可以帮助。

# c# - http:// 到 https:// 重定向期间的重定向循环

> ID：939592
> 
> 赞同：0
> 
> 时间：2009-06-02T13:37:20.437
> 
> 标签：c#, ssl, redirect, https, redirect-loop

我试图强制页面在 SSL 下运行，所以我在 page_load 上实现了以下内容：

```
if (!Request.IsLocal && !Request.IsSecureConnection)
        {
            Response.Redirect(Helper.GetInstance().SSLBaseURL() + ScriptName());
        } 
```

由于某种原因，这最终陷入了循环。今天早些时候，我检查了 Request.Uri.Scheme，它解析为“http”，尽管我显然连接到[https://www.domain.com/pagename.aspx](https://www.domain.com/pagename.aspx)。

您能想到为什么此页面未正确检测到我们在 https 下运行的任何原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:41:23.643

我会在网络服务器端处理这个问题。如果您正在运行 IIS，则没有那么简单，但您可以启用强制 SSL 选项并为您的 403;4 （我认为这是 SSL 所需的错误）实现一个自定义错误页面，该页面重定向到 https。

# recovery - 从 Web 应用程序中的页面刷新中恢复？

> ID：939595
> 
> 赞同：1
> 
> 时间：2009-06-02T13:37:41.763
> 
> 标签：recovery

在 Ajax Web 应用程序中，是否有标准的或公认的从页面刷新中恢复的方法？

我现在的兴趣主要在于具有 Java（JSP/Servlet）后端的 Web 应用程序。我的页面最初是从 JSP 呈现的，然后用户使用 javascript 事件通过界面进行。

是否有涵盖此的设计模式，我假设刷新按钮是 Web 开发人员需要经常担心的问题，因此应该有一种方法可以从中恢复，同时保持状态。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T13:49:17.527

有很多方法可以处理这个问题。

*   **锚点**- 这是 Gmail 在添加时所做的事情，`#inbox/123`这意味着它应该显示`123`带有标签收件箱的电子邮件 ID。这不是很有表现力，对简单的状态很有用。但是，它确实为用户提供了为页面添加书签和使用浏览器历史记录导航的能力。
*   **Cookies** - 这样做的好处是可以完全在客户端进行管理。您可以通过 Javascript 设置 cookie 并通过 Javascript 恢复它们。它很便宜，不需要回邮。状态信息通常不需要保存在服务器上，因为通常状态是临时的。
*   **会话**- 这需要您在客户端更新页面时通过 AJAX 将状态信息发回服务器。如果客户端刷新页面，新页面会将更改后的状态合并到新呈现的页面中。这在性能方面是相当昂贵的，而且设计也很复杂，但可能对某些应用有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T13:42:00.240

我的建议是为服务器端的每个用户保留一个状态机，通过 AJAX 调用更改状态。这样在刷新时，您就已经知道用户处于哪个状态位置，从而可以从中恢复。

如果您在编码时不小心，这可能会给您带来可伸缩性问题。

另一种解决方案可能是将状态变量存储在 cookie 中（假设用户有活动的 cookie）。在页面加载时，状态变量将提交给您的 Web 应用程序，让您恢复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T13:43:57.990

这是我们在项目中使用的一种解决方案：

1.  您在用户访问页面时为页面分配一个序列号/随机 guid。您可以将其放入 url 的 get 部分（例如 yourpage.jsp?pid=1337 其中 1337 是页面查看序列号）

2.  当您处理 AJAX 请求时，您在会话中的服务器端维护页面状态的“镜像”，或者您可以在 JSP 中使用的任何机制来存储状态。

3.  当用户请求页面时，您检查给定的序列号是否已经存在，如果存在，则表示这是一次刷新，因此您使用会话中的镜像数据呈现页面。

# ajax - 使用 AJAX 请求获取图像和关联的元数据

> ID：939596
> 
> 赞同：0
> 
> 时间：2009-06-02T13:37:50.513
> 
> 标签：ajax

我有一个有点昂贵的服务器端操作，它产生一个图像和一些关于该图像的相关文本元数据。我的网页将同时显示两者。

图像及其数据通过 AJAX 调用获取。在服务器端，可以同时生成图像和元数据。如何通过一次 AJAX 调用同时传输（和显示）图像和数据？

（进行两次调用的问题在于，昂贵的服务器端操作最终会在不必要的情况下发生两次。）

编辑：为了澄清，图像是在 servlet 中动态绘制的。如果它有一个与元数据不同的 URL，则需要两个请求，并且代价高昂的操作会发生两次。我不想在 servlet 中编写自己的缓存，因为使用缓存代理和 max-age 否则效果很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T13:45:09.033

### 更新 2：

如果两个进程共享相同的资源 URL，您可以将元数据作为自定义 HTTP 标头发送。不过，我并不完全确定以下技术。

1.  您向图像 URL 发送 Ajax 请求。这将允许您读取 HTTP 响应标头。
2.  当 Ajax 调用完成时，将一个与 Ajax 调用中的 URL 相同的图像插入到 DOM 中。
3.  现在，这是未经测试的部分。如果浏览器对由 XMLHttpRequest 对象或 IMG 对象发起的请求没有区别，则插入图像时不会有额外的请求。那将是浏览器内的解决方案。缓存代理将确保请求相同资源的其他客户端将获得 URL 的缓存版本。

无论如何，即使浏览器机制不起作用，缓存代理至少有机会缓存​​单个响应，而不是两个响应。

**此外**，尽管您说您不想使用 base64 编码的图像，但有一些[技术可以确定浏览器是否支持它们](http://weston.ruter.net/2009/05/07/detecting-support-for-data-uris/)。然后，您可以将它们用于足够智能的浏览器，并为其他浏览器牺牲双重请求。至少没有那么糟糕。

### 更新 1（不再适用）：

如果您已经依赖缓存代理和 max-age 标头，那么这就是我要做的：

1.  启动 Ajax 请求以提取元数据。元数据将包含图像的 URL。
2.  在 DOM 中插入具有上述 URL 的新图像。
3.  让浏览器决定是否获取该图像资源（它可能会从浏览器缓存中提取它）。当您从服务器输出 IMG 标签时，这种机制*应该与正常情况下一样。*
4.  如果您只想在图像加载后显示元数据，请使用 Image 对象的 onload 事件。还有一个 onerror 事件。

### 旧答案（不再适用）：

我不太明白您所说的“生成图像”是什么意思，但我假设您只想将图像 URL 发送回网页。在这种情况下，您可以使用 JSON 来发送图像 URL 和元数据。像这样：

```
{
    "url" : "http://example.com/image.png",
    "meta" : {
        "type"   : "png",
        "width"  : "200px",
        "height" : "200px"
    }
} 
```

完成两个服务器端操作后，您立即发送此响应。您使用单个 Ajax 请求启动这两个请求，并同时获得图像 URL 和元数据的响应。然后，在客户端你很容易阅读它们：

```
var response  = eval(xhr.responseText);
var url       = response.url;
var imageType = response.meta.type; 
```

以上将发生在 onreadystatechange 处理程序中。如果您使用的是图书馆，事情会容易一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:40:02.273

最好的方法是创建一个新的封装对象，将这两个对象作为属性返回。所以 ImageContainer.Image 和 ImageContainer.Metadata 会给你你想要的。

[我在这里](https://stackoverflow.com/questions/932144/strategy-for-restfully-posting-many-entities/932702#932702)回答了一个类似的问题。

# .net - ASP.NET 配置文件模板

> ID：939599
> 
> 赞同：0
> 
> 时间：2009-06-02T13:38:14.053
> 
> 标签：.net, asp.net, profile, asp.net-profiles, system-configuration

是否可以有多个配置文件模板？

我正在为一家公司开发一个内部应用程序，该应用程序将分发到多个位置并具有不同的设置。我正在考虑为用户首选项创建一个配置文件，然后使用配置文件系统来存储系统配置信息（我不想使用配置信息加载 web.config 文件），但是我需要两个单独的配置文件模板。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T13:52:34.243

web.config 是存储应用程序设置的理想位置。如果您部署到一个场并想要一个中心位置，那么数据库可能是另一种可能性。

如果需要，您可以使用[此处](http://www.codeproject.com/KB/dotnet/appsettings_fileattribute.aspx)描述的[appsetting 的文件属性](http://msdn.microsoft.com/en-us/library/ms228154.aspx)从 web.config 外部化实际配置。

您还可以使用[configsource](http://msdn.microsoft.com/en-us/library/system.configuration.sectioninformation.configsource.aspx)属性将配置部分存储在外部文件中。

# database - 将 BLOB 存储在数据库中是个好主意吗？

> ID：939601
> 
> 赞同：4
> 
> 时间：2009-06-02T13:38:30.340
> 
> 标签：database, excel, sql-server-2008, blob

一段时间以来，我一直致力于将数据从臃肿的 Excel 工作簿插入 SQL 数据库。我的团队建议保留 .xls 的备份，他们想知道将 Excel 工作簿实际放入数据库中是否是个好主意，以便我们项目中的所有相关数据放在一起。

我知道一些数据库支持插入二进制文件，但显然这不是数据库系统的最初预期用途，所以我认为这是一个坏主意。我的投票是将工作簿的 URL 放入数据库中，并将工作簿保存在我们内部网上的安全位置。

将 BLOB 放入数据库的优点（如果有的话，除了将生产数据和备份保存在同一个地方）和缺点是什么？

编辑：只是为了进一步澄清，虽然我给出了一个具体的场景，但我打算这个问题主要是关于一般的 BLOB。但是，我可以从您的回答中收集到任何有助于我解决具体情况的信息，当然，我们将不胜感激。:)

谢谢，
-罗伯特

PS 对于那些不知道的人，BLOB 是“二进制大对象”的后缀

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T13:49:15.077

一般来说，如果有其他成本更低的存储选项，我会避免将 blob 放入数据库。当然，将 blob 存储在数据库中是有正当理由的，但我倾向于谨慎行事，将 FS 用于文件存储，将数据库用于数据结构。

由于您使用的是 SQL 2008，因此您可能还对[FileStream](http://msdn.microsoft.com/en-us/library/bb933993.aspx)数据类型感兴趣。它可以让你的事情变得更容易。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T13:47:13.193

无论如何，许多 CMS 包（例如 Sharepoint）将其全部存储为 BLOB。

快速总结。我没有个人意见，因为我从来不需要在数据库中设计或开发非常大的 BLOB（例如电子表格）。我已经存储了图像和其他较小的东西。

## 在数据库中：

优点：假设其他数据以及 BLOB：

*   这一切都在一个地方。
*   备份/恢复是连贯的

缺点：

*   数据库膨胀
*   表现

## 数据库外

优点：

*   没有数据库膨胀
*   本地存储

缺点：

*   备份/恢复更复杂
*   链接断开的风险

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T20:48:45.353

在我看来，如果需要打开 Excel 电子表格，如果它是一个 blob 会变得更加困难。另一方面，您不希望在不更改数据的情况下更改备份电子表格，因此在您的情况下，这可能是一个优势。您还可以考虑要存储多少个电子表格修订版。我们经常被要求回顾来自客户的原始输入数据，这些数据可以追溯到一年或更长时间（当您获得每日文件时真的很有趣）以找到问题的根源（或至少证明是他们而不是我们！）。如果您需要查看不同版本的数据，您的 blob 需要位于相关表中。在您的情况下，这可能也是一个优势，在我看来，您几乎不需要实际访问这些数据。

# dll - 图像结构

> ID：939602
> 
> 赞同：0
> 
> 时间：2009-06-02T13:39:14.207
> 
> 标签：dll, jna

使用 java 和 jna 我调用了一个函数：trace(potrace_bitmap_s)

```
struct potrace_bitmap_s { 
int w, h; 
int dy; /* scanline offset in words */
potrace_word *map; /* pixel data, dy*h words */
};
typedef struct potrace_bitmap_s potrace_bitmap_t; 
```

w, h: 位图的宽度和高度

在图书馆的文档中发现了这个

> 这里，potrace_word 是在 potracelib.h 中定义的无符号整数类型。它通常等于本机机器字（即，32 位架构上的 32 位）。在下面的解释中，我们假设 potrace_word 类型包含 N 位。
> 
> 尺寸为 w*h 的位图从下到上被划分为 h 个水平扫描线。每条扫描线从左到右划分为 N 个像素块。每个这样的 N 像素块存储为单个 potrace_word，块的最左边的像素对应于该字的最高有效位，而该块的最右边的像素对应于该字的最低有效位。“开”（或“黑”或“前景”）的像素由位值 1 表示。“关”（“白”或“背景”）的像素由位值 0 表示。如果扫描线中的位不能被 N 整除，则扫描线最右边的字在右边用零填充。扫描线 0（最底部的扫描线）的数据从 map[0] 开始。扫描线 1 的数据从 map[dy] 开始。扫描线 2 的数据从 map[2*dy] 开始，依此类推。请注意，dy 可以是正数或负数，具体取决于应用程序希望如何在内存中布置图像数据。

但我不明白如何在 java map 中表示。

```
public class Potrace_bitmap_t extends Structure{
    int w, h; /* width and height, in pixels */
    int dy; /* scanline offset in words */
    map ??; /* pixel data, dy*h words */
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:36:23.687

这是存储 2 色图像的一种非常标准的方法，就像您从传真编码的 tiff 中获得的一样。“地图”应该是一个无符号 32 位整数数组。我认为 Java 不允许您声明 uint32，但在这种情况下并不重要，因为您关心的只是位。

将“Map”声明为整数数组。要将其制作成图像，您可以一次检查一个数组中的位。如果数组中第一个 int 的位 0（我假设是 Intel 机器）为“1”，则图像左下角的像素应设置为黑色。如果它是“0”，则将该像素设置为白色。每个 int 将为您提供 32 个像素。如果图像的宽度不能被 32 整除，则需要向前跳过。这就是“map[2*dy]”告诉你的。

因此，例如，如果图像宽度为 55，则使用 map[0] 设置 32 个像素，然后使用 map[1] 设置 23 个像素，然后从图像的下一行（靠近底部的行）开始地图[2]的第一位。（对于 55 像素宽的图像，dy 为 2，假设为 32 位整数）

循环执行此操作，图像底部到高度值。

# java - 覆盖与分配/释放 - 效率

> ID：939605
> 
> 赞同：5
> 
> 时间：2009-06-02T13:39:45.487
> 
> 标签：java, .net, c++, memory-management

我正在编写一个 C++ 应用程序，它需要一块内存（大约 1000 字节）作为一些文本处理的临时缓冲区。该操作每秒可重复多达 10,000 次。

任何人都可以确认每次我需要缓冲区时分配内存（即使用智能指针新建，超出范围时释放内存），而不是拥有一个固定缓冲区并清除它（写入每个字节它为零）每次处理完成时？

这听起来像是 C++ 的常识，但我只是在互联网上找不到任何可以证实这一点的东西。

具有自动垃圾收集功能的计算机语言（例如 Java、.net）的情况是否有所不同？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T13:41:46.013

每次需要时分配和释放内存可能会更昂贵，但更大的问题是：这重要吗？以最简单的方式编写它，您知道它如何正常工作并且不会泄漏/损坏内存。只有这样，如果您的性能不够好，请分析代码以查看可以改进的地方。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T13:46:25.753

虽然我不能给你一个学术上的“确认”，但考虑一下：

每当 CPU 执行一条指令时，都会耗费时间。如果您拆除缓冲区，然后重新分配它，CPU 将不得不执行解除分配/重新分配指令。如果您重用缓冲区，它将不必执行这些操作。

可以肯定地说重用速度更快（我们甚至还没有讨论过内存局部性，相同的内存可以保留在 CPU 缓存中）。

话虽如此，除非您正在编写必须非常非常紧凑的东西（例如实时应用程序），或者除非您已将此缓冲区工作确定为应用程序中的瓶颈（在您进行性能测量时），否则我会说以最有意义且最容易维护的方式编写它。在现代机器上，您的维护成本可能比管理 1,000 字节的性能成本在软件总成本中所占的比例更大。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T14:10:37.360

分配内存（通过 new 或 malloc）不会清除它。如果在使用之前必须将内存设置为 0，那么无论哪种方式都需要清除它。在这种情况下，使用静态缓冲区是一个很大的胜利。此外，如果您只使用缓冲区的一部分，您可以跟踪使用了多少，只需清除已使用的部分。

calloc 确实将整个缓冲区设置为 0，但我无法想象它比 malloc+memset 快得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T14:18:31.227

关于Java：

一个很大的区别是 Java 保证新分配的内存为 0，并且可能比手动执行此操作更快。此外，Java 的垃圾收集器在分配和释放短期对象时非常有效，而另一方面，不必要的长期对象可能会导致额外的工作。因此，每次重新分配数组很有可能在 Java 中比在 C++ 中执行得更好。

但是垃圾收集性能很难预测，所以我只是双向进行，看看哪个更快。这可能比在这里提出问题并阅读所有答案所花费的时间更少。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T13:49:17.387

与往常一样，回答这个问题的最佳方法是两种方式都实施，然后对两种解决方案进行时间/基准测试，以进行实际比较，而不是将您的意见建立在推测或其他人的经验中有用的东西（可能是在您没有意识到的方式上与您的不同）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T15:09:22.530

我将跳过标准的“不要担心优化”，因为其他人都已经涵盖了这一点。将缓冲区声明为函数的本地，并使用 memset 将其设置为 0 将是最快的。对于本地缓冲区，编译器只需将堆栈指针移动正确的字节数即可“分配”空间。分配不会比这更快。使用 Visual Studio，您可以添加`#pragma intrinsic( memset`)。我知道 gcc 也支持内在函数，但我不记得如何告诉它使用它们。我认为最新版本将尽可能使用它们而无需被告知。内部 memset 扩展为一些内联指令，这些指令告诉处理器将内存范围设为 0。你不会比这更快。也就是说，如果不需要，请不要将内存归零。

此外，只需使用本地声明的缓冲区，您的代码就会更加清晰。根据您所说，您的缓冲区不需要在将要使用它的例程范围之外持续存在。在现代术语中，1000 字节很小。使用动态而不是自动内存将添加一堆必须测试和维护的代码。不要这样做。自动记忆是显而易见的选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T15:12:11.663

如果您对算法效率（大符号等）进行过任何类型的研究，您就会知道（或能够解决）大多数免费商店实现不能保证下限（甚至上限）将执行的算法迭代以在空闲存储中查找可用块以满足 new/malloc() 请求。

重复使用一个固定缓冲区将提供更高数量级的性能：- 尤其是垃圾收集环境，其中未使用的内存块可以在空闲存储中逗留，直到运行垃圾收集周期。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-26T03:34:06.197

I would have to say that when it comes down to big memory allocation it would be better to do it once rather than doing each time you need to allocate something. The reason for that is that the memory can become fragmented and slow (it cost a lot of resources to create and delete a ton of stuff in the memory). If you have a data structure that reserves a sufficient amount of memory for your operations it can be better. The downsize of doing so is that a large part of your memory will be taken.

Here is how a new and delete looks under the hood in C++:

```
#include <cstdlib>
using std::malloc;
using std::free;
#include <new>
using std::bad_alloc;

void * operator new(size_t n)
{
    void * p = malloc(n);
    if(!p) throw bad_alloc();
    return p;
}

void operator delete (void *p)
{
    if (p) free(p);
} 
```

Doing a new and delete all the time can be costly! This is why languages such as C# and Java are slower than C++. The only advantage of a garbage collector is that it brings every thing in memory together (it defrags the memory) for your program. This can be costly if you have a heck of a ton of things in memory for your program.

Also, have a look at algorithm in the STL. It might help you by optimizing certain of operations.

# testing - selenium：使用 xpath 定位器的自定义定位器

> ID：939612
> 
> 赞同：0
> 
> 时间：2009-06-02T13:40:42.457
> 
> 标签：testing, web-applications, xpath, selenium

我想用 selenium 定义一个自定义定位器，并且我希望它使用现有的 xpath 定位器。

下面的代码不起作用。我该怎么做？

```
PageBot.prototype.locateElementByNg= function(text, inDocument) {
    var xpath = doSomeManipulation(text);
    return PageBot.prototype.locateElementByXpath(xpath, inDocument);
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-11T09:43:14.027

看看 chrome://selenium-ide/content/locatorBuilders.js

快速解决方案如何基于 xpath:attributes 构建自己的一个：

LocatorBuilders.add('xpath:attributes', function(e) {

只需将名称更改为'xpath：by_ng'

并将其用作首选属性中唯一的一个 const PREFERRED_ATTRIBUTES = ['by_ng'];

然后用在

LocatorBuilders.order = ['xpath:by_ng','xpath:link'];

我将为：

```
<a id="some" name="other" by_ng="this will be catched">test</a> 
```

如果您需要它使用以下结构：

```
<a id="some" name="other" by_ng="this will be catched">
  <img />
  <span>Text</span>
  <p>Some text <b>bold</b></p>
</a> 
```

那么将需要进行一些额外的更改。

# c++ - STL 中的否定适配器

> ID：939614
> 
> 赞同：1
> 
> 时间：2009-06-02T13:40:52.100
> 
> 标签：c++, boost

考虑以下示例：

```
#include <iostream>
#include <functional>
#include <algorithm>
#include <vector>

#include <boost/bind.hpp>

const int num = 3;

class foo {
private:
    int x;
public:
    foo(): x(0) {}
    foo(int xx): x(xx) {}
    ~foo() {}
    bool is_equal(int xx) const {
        return (x == xx);
    }
    void print() {
        std::cout << "x = " << x << std::endl;
    }
};

typedef std::vector<foo> foo_vect;

int
main() {
    foo_vect fvect;
    for (int i = -num; i < num; i++) {
        fvect.push_back(foo(i));
    }
    foo_vect::iterator found;
    found = std::find_if(fvect.begin(), fvect.end(),
        boost::bind(&foo::is_equal, _1, 0));
    if (found != fvect.end()) {
        found->print();
    }
    return 0;
} 
```

有没有办法使用某种否定适配器`foo::is_equal()`来查找第一个非零元素。我不想写`foo::is_not_equal(int)`方法，我相信有更好的方法。我试图玩`std::not2`，但没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T13:58:44.417

由于您使用的是 Boost.Bind：

```
std::find_if(fvect.begin(), fvect.end(),
    !boost::bind(&foo::is_equal, _1, 0)
); 
```

（注意“！”）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T13:50:47.727

的参数`std::not2`需要看起来像一个“正常”的二元谓词，所以你需要适应`foo::is_equal`类似`std::mem_fun_ref`. 您应该能够执行以下操作：

```
std::not2(std::mem_fun_ref(&foo::is_equal)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T14:50:20.227

如果您使用一元函子（在 STL 意义上），您可以使用 std::not1：

```
struct odd : public std::unary_function<int,bool>
{
   bool operator()( int data ) const {
      return data % 2;
   }
};
void f( std::vector<int> const & v )
{
   std::vector<int>::const_iterator first_odd
        = std::find_if( v.begin(), v.end(), odd() );
   std::vector<int>::const_iterator first_even 
        = std::find_if( v.begin(), v.end(), std::not1( odd() ) );
} 
```

但这不适用于从 boost::bind 返回的*unspecified_type*。为此，您可以使用 Éric 已经发布的 ! 返回的*unspecified_type*上的运算符。

# asp.net - 如果我学习 Ruby，会发生什么变化？（我知道 ASP.NET）

> ID：939619
> 
> 赞同：3
> 
> 时间：2009-06-02T13:41:14.127
> 
> 标签：asp.net, ruby

我想知道，

1.  Ruby 编程语言...（容易/困难）学习。
2.  我可以比 asp.net 更快地开发 web 应用程序 %x。
3.  有很多学习 Ruby 的截图。（[http://xxxRubLearn.xxx](http://xxxRubLearn.xxx)等）
4.  Ruby 的原理只是......
5.  您可以增加工作处理器（如 IIS 上的 W3P）并使您的 Web 应用程序更快。
6.  Ruby 的未来看起来将是最……编程语言。
7.  Ruby 和 ASP.NET 的比较向我们展示了......

或者

不要离开你的方式，因为这是最简单的方式。当你在学习新技术时，它们很快就会消亡……？

你说什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T14:10:12.943

*   **易于学习** Ruby 编程语言非常容易学习。您将在几天内开始构建应用程序。如果你喜欢编程，我想你会喜欢用 Ruby 编程。

*   **网络应用程序？** 我没有将 Rails 用于严肃的网络应用程序。尽管我在我的 Web 项目中坚持使用 ASP.NET，但 Rails 非常漂亮，我强烈推荐它。

*   **比较**我不认为 ASP.NET 是一种“编程语言”。我无法将它与 Ruby 相提并论。但是人们告诉我，在某些情况下，Ruby on Rails 是 ASP.NET 的一个很好的替代品（这里有人可以通过引用一个真实的场景来帮助我）

*   **哲学**Ruby 是一种坚信编程不是用勺子喂编译器的语言。 [请参阅对创作者 Matz 的采访。](http://www.artima.com/intv/ruby.html)

*   **资源**有很多很好的资源来学习 Ruby。

    1.  [Ruby 视频基础知识](http://www.rubyinside.com/17-videos-covering-basic-ruby-techiques-1685.html)
    2.  [Envy Casts 的高级 Ruby 主题和 Ruby 1.9 覆盖范围](http://envycasts.com/)
    3.  [大量关于 Ruby 的免费书籍](http://pspxworld.com/book/programming/ruby.php)

我强烈建议你学习 Ruby。总的来说，我在编程中学到了很多新概念，并且在其中进行了大量有趣的编码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T13:48:05.343

**你会知道更多——我猜。**

而且我认为您正在将 Ruby 与 Rails（用 Ruby 编写的网络应用程序框架）混合在一起。Ruby 是一种编程（倾向于脚本）语言。但是 Ruby 和 Rails 都各有各的美——Ruby 的结构和表达问题解决方案的简便性，Rails 强调了框架应该如何工作。

就像学习任何与你选择的武器完全不同的语言一样，它会扩展你在未来解决问题的方式——你会比以前看得更远。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T13:56:21.520

我将解决前几个问题。

*1) Ruby 易学/难学：*

就像生活中的许多事情一样，这取决于您的经验和资源。如果你现在只有 C#，那么 Ruby 可能会很难学习，因为它是你的第二语言。根据我的经验，第二语言通常是最难的。第二语言也是教你最多的语言。如果你知道 3 或 4 种其他语言，我怀疑你会发现学习它并不比你以前学过的那些更难。如果您在 Windows 环境中，安装所需工具可能比 ASP.net 难一些，但无论如何您可能不应该学习任何东西。

*2) 更快地编写 web:programs：*

让我们说那些是战斗的话。有些人认为它更快，另一些人认为 ASP.net 更快。我会说如果你想做网络应用程序，那么你还需要学习 Rails 框架。你可以在不学习 Rails 的情况下学习 Ruby，但围绕 Ruby 的讨论都是关于 Rails 的。

*3) 学习地点：*

我喜欢从书本中学习，所以这就是我以前学习 ruby​​ 的方法。网上有很多例子。如果您想以这种方式学习，我希望 Google 会向您展示这种方式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T14:28:46.777

对我来说，最重要的是用 Ruby 编写代码很有趣。我花了一段时间才“掌握”它，但一旦我做到了，它就像一个巨大的灯泡亮了起来，它改变了我编码的方式。

具体来说，理解块的概念是关键。作为一个简单的例子，这是我用 Delphi（或 C#，类似地）写的东西：

```
for j := 0 to SomeListObject.Count - 1 do
  DoSomething(SomeListObject[j]); 
```

在 Ruby 中，它更像是这样的：

```
some_list_object.each do |item|
  do_something(item)
end 
```

或者，更紧凑，像这样：

```
some_list_object.each { |item| do_something(item) } 
```

这是一个微妙的变化，但一旦你掌握了窍门，事情就会变得更容易，没有迭代器变量或任何杂乱的东西。

开始之前，我强烈建议您从[Programming Ruby 1.9](http://www.pragprog.com/titles/ruby3/programming-ruby-1-9)开始，并[使用 Rails 进行敏捷 Web 开发以](http://www.pragprog.com/titles/rails3/agile-web-development-with-rails-third-edition)开始使用 Rails。您*无需*非常了解 Ruby 即可开始使用 Rails，但如果您这样做了，它会更快更有意义。

# c++ - QPropertyEditor 中的运行时动态属性

> ID：939620
> 
> 赞同：1
> 
> 时间：2009-06-02T13:41:20.333
> 
> 标签：c++, qt, propertygrid, propertyeditor

我正在使用来自 Qt-Apps.org 的 QPropertyEditor。

是否可以创建一个具有公开属性的类，其中属性的数量是运行时动态的？因此，例如，您有一个类，它表示具有任意长度的浮点向量，该长度在编译时是未知的。所以你有一个

```
vector<float> myFloats; 
```

作为班级成员。如何使用 Q_PROPERTY 宏将其公开为属性。所以最后我喜欢在属性编辑器小部件中有以下视图：

*   我的课
    *   myFloats[0] 的值
    *   myFloats[1] 的值
    *   myFloats[2] 的值 ... ...

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T10:43:28.830

通过使用[动态属性](http://doc.trolltech.com/4.5/qobject.html#setProperty) ...

在您的班级中，您可以在运行时设置该班级的动态属性

```
DynamicPropertiesClassForQPropertyEditor()
{
    QVector<int> properties;
    ///.... fill in thevalues
    for (int i=0 ; i!=properties.size() ; ++i )
    {
        const QString propertyName = QString( "value of properties[%1]").arg(i);
        setProperty( qPrintable(propertyName) ,properties.at(i) );
    }
} 
```

# c++ - 为 x64 平台编译时出现 c2593 错误（操作符标识符不明确）

> ID：939622
> 
> 赞同：1
> 
> 时间：2009-06-02T13:41:30.413
> 
> 标签：c++, 64-bit, compiler-errors, msdev

我正在尝试使用 Microsoft VisualStudio 2008 编译一个 C++ 项目。如果您使用 Win32 作为目标平台，这个特定的项目编译得很好。如果我尝试为 x64 平台编译相同的项目，我会在这一行中得到[C2593 'operator identifier' is ambiguous](http://msdn.microsoft.com/en-us/library/b9efs282(VS.80).aspx)错误：

```
case 't':  os_ << (size_t)path->rnode->char_type;     break; 
```

任何人都知道为什么同一行在 32 位上编译得很好但在 64 位上编译失败并出现如此高级别的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T13:53:47.703

好的，我知道了。问题是 size_t 数据类型对于两个不同的平台具有不同的大小。运算符 << 是为各种数据类型列表定义的：

```
StringBuffer& operator<<(unsigned short int n) { _UITOA(n); }
StringBuffer& operator<<(unsigned int n)       { _UITOA(n); } 
```

在 32 位平台上，“unsigned int”是 size_t 的完美匹配。在 64 位平台上 size_t 是 64 位，并且与任何运算符声明都不完全匹配。

解决方案是通过使用正确的数据类型来选择准确的运算符：

```
case 't':  os_ << (unsigned int)path->rnode->char_type;     break; 
```

或使用 size_t 重载运算符：

```
StringBuffer& operator<<(size_t)       { _UITOA(n); } 
```

# asp.net-mvc - MVC - 从 2 个表中填充 DropDownList

> ID：939625
> 
> 赞同：0
> 
> 时间：2009-06-02T13:41:39.257
> 
> 标签：asp.net-mvc

我想知道如何从 2 个表中填充 DropDownList。我有表格：类别子类别

我应该看起来像这样： -- 车辆 -- //来自类别汽车 //来自子类别自行车 -- 房屋 -- Vila Aparatment

这些表通过外键相互连接。我使用 Linq to SQL。

任何好的解决方案如何从 2 个表格中填充下拉列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T15:11:26.940

出于显示目的，我建议使用很少使用的选项组标签。

例如：

```
<select>
  <optgroup label="Swedish Cars">
    <option value="volvo">Volvo</option>
    <option value="saab">Saab</option>
  </optgroup>
  <optgroup label="German Cars">
    <option value="mercedes">Mercedes</option>
    <option value="audi">Audi</option>
  </optgroup>
</select> 
```

这会将您的子类别组合在一起，以便在下拉列表中更轻松地显示。

# javascript - Javascript 协助

> ID：939628
> 
> 赞同：0
> 
> 时间：2009-06-02T13:41:58.477
> 
> 标签：javascript, module-pattern

我遇到的问题是针对不同元素多次调用该函数时。我相信我需要本地化所有变量，以便可以将这个函数用于多个元素。万一这很重要，我还会调用 jquery 1.3。

如果我只调用 pageSlide 一次，一切都很好，但是一旦我多次调用它就会很痛苦。没有错误，只是不稳定的行为。

**代码已更新**

```
var slideMenu=function(){
  var speed, startWidth, time, menuId, liID, menuLen, menuWidth, globalWidth, openWidth;
  return{

    speed : 0, startWidth : 0, time  : 0, menuId  : 0, liID : 0, menuLen  : 0,        menuWidth  : 0, globalWidth : 0, openWidth : 0,

    build:function(ulID,passStartWidth,passTime,s,passSlideLen,passHeight){
      speed=s;
      startWidth=passStartWidth;
      time=passTime;
      menuId=document.getElementById(ulID);
      liID=menuId.getElementsByTagName('li');
      menuLen=liID.length;
      menuWidth=menuId.offsetWidth;
      globalWidth=menuWidth/menuLen;
      openWidth=Math.floor((menuWidth-startWidth)/(menuLen-1));
      var i=0;
      for(i;i<menuLen;i++){
        s=liID[i];
        s.style.width=globalWidth+'px';
        this.timer(s)
      }
      if(passSlideLen!=null){
        menuId.timer=setInterval(function(){
          slideMenu.slide(liID[passSlideLen-1])
        },time)
      }
    },
    timer:function(s){
      s.onmouseover=function(){
        clearInterval(menuId.htimer);
        clearInterval(menuId.timer);
        menuId.timer=setInterval(function(){
          slideMenu.slide(s)
        },
        time)
      }
      s.onmouseout=function(){
        clearInterval(menuId.timer);
        clearInterval(menuId.htimer);
        menuId.htimer=setInterval(function(){
          slideMenu.slide(s,true)
        },
        time)
      }
    },
    slide:function(s,passChange){
      var changeWidth=parseInt(s.style.width);
      if((changeWidth<startWidth && !passChange) || (changeWidth>globalWidth && passChange)){
        var overallWidth=0;
        var i=0;
        for(i;i<menuLen;i++){
          if(liID[i]!=s){
            var slideObj,openWidth; var opening=0; slideObj=liID[i]; openWidth=parseInt(slideObj.style.width);
            if(openWidth<globalWidth && passChange){
              opening=Math.floor((globalWidth-openWidth)/speed);
              opening=(opening>0)?opening:1;
              slideObj.style.width=(openWidth+opening)+'px';
            }else if(openWidth>openWidth && !passChange){
              opening=Math.floor((openWidth-openWidth)/speed);
              opening=(opening>0)?opening:1;
              slideObj.style.width=(openWidth-opening)+'px'
            }
            if(passChange){
              overallWidth=overallWidth+(openWidth+opening)}else{overallWidth=overallWidth+(openWidth-opening)
            }
          }
        }
        s.style.width=(menuWidth-overallWidth)+'px';
      }else{
        clearInterval(menuId.timer);
        clearInterval(menuId.htimer)
      }
    }
  };
}(); 
```

上面的代码没有错误但无法工作。当我使用 this 关键字时，它并没有变得更好。

我的问题是哪些变量应该是“this.”。我尝试了各种我认为可行的组合，但我错过了一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T04:57:55.793

我认为您误解了模块模式的整体概念，当您需要在所有实例之间共享一个全局静态变量时，您可以在 return 语句之前使用关键字“var”声明或初始化您的变量。

**假设每当您更改这些变量时，您的所有实例都会受到更改的影响**。

```
var slideMenu=function(){
    // Declare or initialize your private static variables here    
    var speed, startWidth, time;

    return {
        // Public part of your object
        slide:function(s,passChange){
            //To access your variable        
            speed = 20;
        ... 
```

另一方面，如果您想在全局范围内保护变量安全，则必须将变量放入函数返回的对象中，这是提供**每个实例唯一属性**的可靠方法。

```
var slideMenu=function(){
    // Declare or initialize your private static variables here    
    var speed, startWidth, time;

    return {
        // Public part of your object
        // Declare internal or public properties here
        menuId  : 0, 
        liID    : 0, 
        menuLen : 0,
        ...
        slide:function(s,passChange){
            //To access your private static variable inside functions        
            speed = 20;
            // To access your public/internal properties
            this.menuId = s; // for example ;) 
        } 
```

**总结**

有时为了帮助区分内部/公共属性，有些人会在其内部属性上写一个前导下划线（请注意，属性仍然可以从外部访问）。

希望对你有帮助，祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T14:29:11.940

您之所以会出现这种行为，是因为您使用的是允许在对象中保存私有静态变量的模块模式。问题是这些变量在所有实例之间共享。

```
 var sp=0;
  var st=0;
  var t=0;
  var m='';
  var sa='';
  var l=0;
  var w=0;
  var gw=0;
  var ot=0; 
```

您必须将这些变量移动到您的公共实例中，也就是在脚本的返回部分或构造函数中（但在这种情况下，您必须为每个变量提供一个 getter）。

```
return{

   // Place your variables here
   sp : 0,
   st : 0,

   ...

   build:function(sm,sw,mt,s,sl,h){
      // And then use the this keyword to access the variable
      this.sp=s;
      this.st=sw;
      t=mt;
      m=document.getElementById(sm);
      sa=m.getElementsByTagName('li');
      l=sa.length;     
      w=m.offsetWidth;     
      gw=w/l;
      ... 
```

# c# - 使用带有 C# 的 SHDocVw.InternetExplorer 遍历框架中的项目

> ID：939631
> 
> 赞同：0
> 
> 时间：2009-06-02T13:42:34.343
> 
> 标签：c#

如何使用 SHDocVw.InternetExplorer 遍历框架内的项目并获取每个字段的属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-14T04:25:27.903

尝试这个：-

```
Dim frmDOC As DispHTMLDocument = CType(CType(HTMLDoc.getElementsByTagName("iframe")(1), SHDocVw.IWebBrowser2).Document, DispHTMLDocument)

dim iHTMLCol as IHTMLElementCollection = frmDOC.getElementsByTagName("a") 
```

在此之后，您可以使用 For 循环进行`IHTMLElementCollection`收集。

# java - Java 是否有现成的时钟同步解决方案？

> ID：939633
> 
> 赞同：8
> 
> 时间：2009-06-02T13:42:41.067
> 
> 标签：java, real-time, distributed, clock-synchronization, vector-clock

我们有一个大型的高性能软件系统，它由多个交互的 Java 进程（不是 EJB）组成。每个进程可以在同一台机器上，也可以在不同的机器上。

某些事件在一个进程中生成，然后以不同的方式传播到其他进程以进行进一步处理等等。

出于基准测试的目的，我们需要创建每个事件何时通过“检查点”的日志，最终将这些日志组合起来以获得每个事件如何通过系统传播以及延迟多少的时间线（当然，进程切换和 IPC 添加延迟，没关系）。

当然，问题在于时钟同步。所以这是我的问题：

1）如果所有进程都在同一台机器上，是否保证 currentTimeMilis 在调用时是准确的？ITP的错误有一定的界限吗？

2）如果某些进程可能在不同的机器上，是否有用于时钟同步的现成解决方案（也是免费或开源的）？我最好寻找一种可以绕过操作系统（Windows 或 Linux）并直接从 Java 工作的解决方案。我还理想地寻找可以以微秒精度运行的东西。我考虑过 NTP，但我不确定它是否可以通过 Java 而不是通过操作系统获得，而且我不确定它的复杂性。

3）有没有办法确定在特定配置（或我最终使用的任何解决方案）中使用 NTP 的误差范围，以便我可以在计算延迟时给出误差范围？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T13:48:06.623

对于分布式编程，时钟同步通常是不够的。您可能想要构建一个逻辑时间框架（例如 Lamport 或矢量时钟或 Singhal-Kshemkalyani 方法......并且还有更多负载可以使机器之间的因果关系保持同步）。您选择哪种通常取决于应用程序和事件之间所需的因果关系。

时钟是同步的，以确保并发事件保持正确的顺序。除了保持系统时钟同步之外，还有其他方法可以做到这一点……除非它们共享一个共同的物理时钟……这非常棘手。

在NTP误差范围方面，有解决方案：

我的建议：

阅读： **分布式计算：原理、算法和系统**

特别是：第3章，逻辑时间

**编辑**

在 Cheeso 的帖子之后，我发现

[http://www.uniforum.org/publications/ufm/apr96/opengroup.html](http://www.uniforum.org/publications/ufm/apr96/opengroup.html)

[http://sourceforge.net/projects/freedce](http://sourceforge.net/projects/freedce)

那里可能有 DCE Java 绑定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T14:53:54.073

我真的只是使用NTP。即使在互联网上也非常准确，在局域网上应该会更好。根据维基百科[ [1](http://en.wikipedia.org/wiki/Network_Time_Protocol) ]，

> NTPv4 在公共互联网上的时间通常可以保持在 10 毫秒（1/100 秒）以内，在理想条件下，在局域网中可以达到 200 微秒（1/5000 秒）或更好的精度。

因此，如果您的条件足够“理想”，它可能足以满足您的需求。NTP 已经存在了足够长的时间，几乎所有东西都可以使用它。我认为没有任何理由通过 Java 而不是操作系统来做到这一点。如果操作系统已同步，Java 也会同步。

[1][维基百科：网络时间协议](http://en.wikipedia.org/wiki/Network_Time_Protocol)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-14T21:25:12.847

我自己尝试了一些东西后遇到了这个线程（应该先搜索！） [http://snippets.dzone.com/posts/show/11345](http://snippets.dzone.com/posts/show/11345) - 可能是一个好方法，可能是坏方法，但它是分布式的（无服务器）很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:48:57.777

旧的[DCE（“分布式计算环境”）](http://en.wikipedia.org/wiki/Distributed_Computing_Environment)曾经有一个分布式时间同步解决方案，具有所有这些功能。它被称为 DTS。管理员可以将一组机器配置为同步，计算延迟或不确定性并使其可用。如果任何机器不同步，它的时钟会慢慢调整，直到它再次同步。保证任何机器上的时间都不会向后调整（违反基本物理学）。网络需要至少一个 NTP 输入才能与“现实世界”保持同步。

我不知道那个时间同步的东西，或者一般的 DCE 代码发生了什么。

在我看来，您不需要“Java”解决方案。您需要同步一组分布式机器的时钟。Java 应用程序只是在机器上运行的东西。

# asp.net - 编译 debug="false" 和 Release 模式有什么区别？

> ID：939634
> 
> 赞同：11
> 
> 时间：2009-06-02T13:42:47.243
> 
> 标签：asp.net, build, debugging, release

在 ASP.NET 中，在 Web.config 中构建项目和在配置管理器中使用发布模式有什么区别？

你什么时候用一个而不用另一个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-05-25T13:57:27.343

这是我发现的最好的解释：

[http://odetocode.com/blogs/scott/archive/2005/11/15/debug-and-release-builds-in-asp-net-2-0.aspx](http://odetocode.com/blogs/scott/archive/2005/11/15/debug-and-release-builds-in-asp-net-2-0.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T13:58:23.780

ScottGu在他的博客上很好地解决了[这里的差异。](https://weblogs.asp.net/scottgu/442448)

当我需要在 Visual Studio 中进行调试或者我试图追踪一个特别讨厌的错误时，我通常会使用这种模式。所以我通常以调试模式运行以设置为 false。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T13:57:35.153

根据您设置 Web 应用程序的方式（网站模型与 Web 应用程序模型），您可能会将未编译的源代码直接部署到 Web 服务器。在这种情况下，ASP.Net 运行时需要知道您希望在请求开始时如何编译代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-28T08:43:43.363

在“发布”模式下编译时，将使用 web.release.config 文件，在调试模式下编译时，将使用 web.debug.config 文件（两者都扩展了 web.config）。有关这些文件的更多信息，请参见[此处](https://stackoverflow.com/questions/2791236/what-are-the-web-debug-config-and-web-release-config-files-for)。

这些文件可能包含这样的部分：

```
<system.web>
    <compilation debug="true" />
    <!-- Lines removed for clarity. -->
</system.web> 
```

在 ASP.NET 中，此设置控制是否进行捆绑或缩小以优化页面加载时间。

*   捆绑意味着：将多个文件合并或捆绑成一个文件（以减少页面请求的数量）。
*   缩小意味着：删除不必要的空格和注释，并将变量名称缩短为一个字符。

有关捆绑和缩小的更多信息，请参见[此处](http://www.asp.net/mvc/overview/performance/bundling-and-minification)。

“调试”的默认值为 false，因此默认情况下启用优化。

# c# - 如何让 BackgroundWorker 返回一个对象

> ID：939635
> 
> 赞同：60
> 
> 时间：2009-06-02T13:42:58.193
> 
> 标签：c#, concurrency, asynchronous, backgroundworker, worker-process

我需要`RunWorkerAsync()`返回一个`List<FileInfo>`.

能够从后台工作人员返回对象的过程是什么？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-06-02T13:56:58.930

在您的`DoWork`事件处理程序中`BackgroundWorker`（这是后台工作发生的地方）有一个参数`DoWorkEventArgs`. 此对象具有公共属性对象 Result。当您的工作人员生成其结果（在您的情况下为 a `List<FileInfo>`）时，设置`e.Result`为该结果并返回。

现在您的 BackgroundWorker 已经完成了它的任务，它会触发`RunWorkerCompleted`事件，该事件有一个`RunWorkerCompletedEventArgs`对象作为参数。`RunWorkerCompletedEventArgs.Result`将包含您的结果`BackgroundWorker`。

例子：

```
private void bgw_DoWork(object sender, DoWorkEventArgs e)
{
    int result = 2+2;
    e.Result = result;
}

private void bgw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    int result = (int)e.Result;
    MessageBox.Show("Result received: " + result.ToString());
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-06-02T13:56:09.183

我假设你不想阻塞并等待 RunWorkerAsync() 的结果（如果你这样做了，就没有理由运行异步！

如果您想在后台进程完成时收到通知，请挂钩 RunWorkerCompleted 事件。如果要返回某些状态，请在 DoWork 事件参数的 Result 成员中返回。

例子：

```
 private void BackgroundWorker_DoWork(object sender, DoWorkEventArgs e)
    {
      // do your thing
      ....
      // return results
      e.Result = theResultObject;
    }

    // now get your results
    private void BackgroundWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
      MyResultObject result = (MyResultObject)e.Result;
      // process your result...
    } 

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T13:47:36.233

`RunWorkerAsync()`异步启动进程，并在进程实际完成之前返回并继续执行您的代码。如果您想获得 的结果`BackgroundWorker`，您需要创建一个实例变量来保存该值并在`BackgroundWorker`完成后检查它。

如果您想等到工作完成，那么您不需要`BackgroundWorker`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-01-18T15:30:04.280

为了补充大卫的答案，人们可​​能希望通过一个元组为方法提供多个参数。

为此，让我更新他的答案，其中一个值（*称为EngagementId*）通过每个调用传递，并且元组保存该原始项目以供使用以及结果。

```
private void bgw_DoWork(object sender, DoWorkEventArgs e)
{
    var engagementId = (int)e.Argument;
    int result = 2 + 2;
    e.Result = (engagementId, result);
}

private void bgw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    (int engagementId, int result) tupleResult = ((int, int)) e.Result; // Both (( are needed for tuple/casting.

    MessageBox.Show($"Result received {tupleResult.result} for engagement {tupleResult.engagementId}");
} 
```

* * *

[有关更多信息，请参阅如何转换为元组](https://stackoverflow.com/a/64541518/285795)的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:46:56.750

根据您的模型，您要么希望工作线程在完成工作时回调其创建者（或其他进程），要么您必须经常轮询工作线程以查看它是否已完成，如果所以，得到结果。

等待工作线程返回其结果的想法破坏了多线程的好处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T13:50:41.143

你可以让你的线程以对象作为参数引发一个事件：

```
ThreadFinishedEvent(this, new ThreadEventArgs(object)); 
```

在哪里：

```
public class ThreadEventArgs : EventArgs
{
    public ThreadEventArgs(object object)
    {
        Object = object
    }

    public object Object
    {
        get; private set;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T14:01:52.570

一般来说，当运行异步进程时，工作线程应该调用委托或触发事件（如 ChrisF）。

您可以查看新的 PFX，它具有一些可以返回值的并发函数。

例如，有一个名为 Parallel.ForEach() 的函数，它有一个可以返回值的重载。

看看这个了解更多信息

[http://msdn.microsoft.com/en-us/magazine/cc817396.aspx](http://msdn.microsoft.com/en-us/magazine/cc817396.aspx)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-04-21T03:34:33.587

与其在“DoWork”方法中进行后台工作，不如创建一个返回您想要返回的类型的方法，并将其应用于 e.Result，就像这里推荐的其他答案一样。作为一个最小的例子，它回答了 OP 的问题，而不会使事情过于复杂......

```
 private List<FileInfo> FileInfoWorker(object sender, DoWorkEventArgs e)
    {
        return new List<FileInfo>(new DirectoryInfo("C:\\SOTest").GetFiles().ToList());
    }

    private void bgwTest_DoWork(object sender, DoWorkEventArgs e)
    {
        BackgroundWorker worker = sender as BackgroundWorker;

        e.Result = FileInfoWorker(worker, e);
    }

    private void bgwTest_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        if (e.Error != null)
        {
            MessageBox.Show(e.Error.Message);
        }
        else if (e.Cancelled)
        {
            tbStatus.Text = "Background operation cancelled.";
        }
        else
        {
            tbStatus.Text = "Background operation complete.";
        }
    } 
```

该示例还显示了如何从 BackgroundWorker API 更新 TextBox。未显示对通过 ProgressBar 和 TextBoxes 报告进度的支持以及对取消的支持，API 也支持这两者。代码通过按钮运行...

```
 private void btnSOTest_Click(object sender, EventArgs e)
    {
        bgwTest.RunWorkerAsync();
    } 
```

# http - RSS轮询政策

> ID：939642
> 
> 赞同：32
> 
> 时间：2009-06-02T13:44:34.867
> 
> 标签：http, rss, atom-feed

我有一个应用程序可以轮询网络上的几个 rss 源。

轮询他人的 Web 服务器时的礼仪是什么。多久轮询一次等？

最佳实践是什么？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-06-02T13:55:24.347

1.  使用 HTTP 缓存。发送`Etag`和`LastModified`标题。识别`304 Not modified`响应。这样可以节省大量带宽。此外，一些脚本识别`LastModified`标题并仅返回部分内容（即仅返回两个或三个最新项目，而不是全部 30 个左右）。

2.  不要从支持[RPC Ping](http://en.wikipedia.org/wiki/Ping_(blogging))的服务（或其他 PUSH 服务，例如[PubSubHubbub](http://en.wikipedia.org/wiki/PubSubHubbub)）轮询 RSS。即，如果您从服务接收 PUSH 通知，则不必在标准间隔内轮询数据 — 每天执行一次以检查机制是否仍然有效（ping 可以禁用、重新配置、损坏、 ETC）。这样您就可以仅在收到通知时获取 RSS，而不是每隔一小时左右。

3.  检查 TTL（在 RSS 中）或缓存控制标头（`Expires`在 ATOM 中），并且在资源过期之前不要获取。

4.  尝试适应每个 RSS 提要中新项目的频率。如果在过去一周内只有两次特定提要的更新，请不要每天获取超过一次。AFAIR 谷歌阅读器就是这样做的。

5.  在夜间或您网站上的流量较低的其他时间降低费率。

6.  最后，每小时做一次。;)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T13:46:53.023

Google 的 FeedFetcher 声称它每小时对 rss 提要进行轮询的次数略少于一次。

来自：[http ://code.google.com/apis/ajaxfeeds/documentation/](http://code.google.com/apis/ajaxfeeds/documentation/)

> # 饲料爬行频率
> 
> 由于 Google AJAX Feed API 使用 Feedfetcher，因此来自 AJAX Feed API 的 Feed 数据可能并不总是最新的。Google 供稿抓取工具（“Feedfetcher”）每小时从大多数网站检索供稿的次数少于一次。一些经常更新的网站可能会更频繁地刷新。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T13:52:43.213

好吧，我会去那里，忽略那些说“谷歌说，我们做”的帖子，并说：只要你实际需要。

RSS 可让您随时了解最新信息。如果某个 Feed 每小时发布 10 个项目，但只显示 5 个，那么您将错过其中的 5 个项目，并且该 Feed 无法发挥其作用。你可能根本不打它。

当然，您不能用请求敲击服务器，但如果它们发布的内容足以让您每分钟请求一次，我看不出匹配该速率是多么不合理。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T13:48:00.227

[每小时一次](http://www.therssweblog.com/?guid=20070408105324)，如果您只想按照经验法则（但链接解释了一些更好的选择）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T13:46:44.647

每小时一次是我听到的频率。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-02T13:52:00.827

Rss 中有一个 ttl 设置，所以实际上你应该只在 TTL 过期时进行轮询。

但我想如果他们不把一个问题放在他们的问题上，你应该每小时投票一次

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-07T14:49:22.623

这不是一个完整的答案，但请寻找推送警报。

[RSS 博客](http://www.therssweblog.com/?guid=20070408105324)表明最佳做法是向[weblogs.com](http://weblogs.com/faq.html)询问已更改的博客。

还有一些，呃，喧嚣，关于[pubsub](http://code.google.com/p/pubsubhubbub/)，一种订阅推送警报的方式，具有一定的动力。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-22T13:00:02.887

我注意到 twitter 使用（自定义）`X-RateLimit-Remaining`和`X-RateLimit-Limit`标头（在 HTTP 响应中）来指示 Atom 提要的最大授权轮询数量。有点遗憾的是他们没有使用标准`Expires`字段（这是在过去 30 年设置的：P）我猜他们的广告`Cache-Control: no-cache`也排除了 RFC 2616（第 13.2.* 节）中定义的通用启发式过期时间。更遗憾的是，Atom 似乎没有提供任何标准化的方法来说明建议多久轮询一次提要。

# c# - Castle Windsor Fluent API：如何将组件参数值设置为配置的属性

> ID：939659
> 
> 赞同：2
> 
> 时间：2009-06-02T13:47:38.997
> 
> 标签：c#, castle-windsor, fluent-interface

我刚刚开始使用 Castle Windsor 的 Fluent 注册，并且无法弄清楚如何在注册时引用我在 XML 配置文件的属性部分中定义的属性。所以我有这个代码来注册一个组件。

```
RegisterComponent(componentId, Component.For<ConnectionConfig>()
            .ImplementedBy(typeof(ConnectionConfig))
            .Named(componentId)
            .LifeStyle.Singleton
            .Parameters(
                Parameter.ForKey("ConnectionId").Eq(connectionId),
                Parameter.ForKey("CommandTimeoutSeconds").Eq("#{ConnectionInfo.DefaultTimeout}"))); 
```

#{ConnectionInfo.DefaultTimeout} 是我在 XML 配置中定义的属性，该属性在 Fluent 注册之前加载到容器中，但这不起作用，在此代码中，传递给 Eq() 的参数被视为文字（尽管这适用于其他组件，即 ${My.Component} 会起作用）

在通过新的 Fluent API 注册组件时如何从配置文件中引用属性有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:47:15.527

更新版本的 Windsor (3.x) 对此具有内置支持：

```
Component.For<Foo>().DependsOn(Dependency.OnAppConfigValue("someValue")) 
```

# hibernate - 在 Hibernate 中如何注释 blob 列？

> ID：939673
> 
> 赞同：35
> 
> 时间：2009-06-02T13:49:46.993
> 
> 标签：hibernate, annotations, blob

在 Hibernate 中如何注释 blob 列？到目前为止，我有一堂课：

```
@Column( name = "FILEIMAGE" )
private byte[ ] fileimage ;
//
public byte[ ] getFileimage ( ) { return this.fileimage ; }
public void setFilename ( String filename ) { this.filename = filename ; } 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-06-02T13:57:13.593

@Lob 应该为 blob 和 clob 解决问题（使用 String 作为类型）

```
@Column( name = "FILEIMAGE" )
@Lob(type = LobType.BLOB)
private byte[] fileimage; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-22T20:33:39.640

我在 JBoss 7 和 Java 7 中使用了 hibernate 4，发现`BLOB`我的表中的列不像 hibernate 2 那样工作。幸运的是，我通过阅读其他人的解决方案解决了这个问题。我的解决方案：

1.  db 中的表，列仍然定义在 BLOB 中；将休眠映射从更改`type="blob"`为`type="binary"`
2.  在 Java getter/setter 中，使用`byte[]`代替`BLOB`( `javax.sql`)
3.  更改正确获取和设置此列的 Java 代码。如果涉及 InputStram，则用于`byte[]`读取/写入`BLOB`列；如果通过 using 从 DB 读取`java.sql.ResultSet`，请确保使用 getBytes() 而不是`getBlob()`方法。

# c# - 签署程序集 - 基础知识

> ID：939677
> 
> 赞同：27
> 
> 时间：2009-06-02T13:50:51.703
> 
> 标签：c#, .net, assemblies

签署大会是什么意思？为什么要完成？

什么是最简单的签名方式？.snk 文件有什么用？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-06-02T17:19:40.590

其他两个答案很好，但还有一点。“证书”签名和“强名称”签名之间很容易混淆。

正如 Stefan Steinegger 所说，强名称签名的目的是：让您的客户确定他们认为他们正在加载的代码确实正是他们正在加载的代码。那就是所有强大的名称。具体来说，强名称不会在您的客户和您之间*建立*任何类型的信任关系。如果客户决定他们信任来自您的代码，则由他们来确定您的代码的正确强名称是什么。“密钥管理”问题无论如何都没有解决；客户有责任弄清楚如何知道信任什么密钥。

证书签名，即使用您从 Verisign 或其他认证机构获得的证书进行签名，其目的要复杂得多。证书签名的目的是建立从认证机构到签署代码的组织的经过验证的信任和身份链。您的客户可能不信任您，您的客户可能甚至没有*听说过*您，但您的客户可以说“如果 Verisign 担保此代码作者的身份，那么我将信任他们”。客户的密钥管理问题减少了，因为认证机构已经为他们承担了这个负担。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-10-07T00:42:51.167

## 签署大会是什么意思？

对程序集进行签名就是给程序集一个强名称。

## 为什么要完成？

首先，让我们做一个重要的区分。在 .NET 中对程序集进行分类的一种方法如下：

*   **[Private Assembly](http://msdn.microsoft.com/en-us/library/ff951638%28VS.85%29.aspx)**，被隔离以供单个应用程序使用（默认）。它通常与应用程序位于同一目录中。
*   **[Shared Assembly](http://msdn.microsoft.com/en-us/library/ff951639%28v=VS.85%29.aspx)**，您机器中的所有应用程序都可以全局访问。它通常在[GAC](http://msdn.microsoft.com/en-us/library/yf1d93sz.aspx)中找到，并且必须经过签名，即，它必须有一个强名称（由名称、版本、公钥和程序集的文化组成）。

为什么？具有强名称可确保您的程序集是唯一的，并且没有人可以窃取 GUID（如在 COM 中）以创建具有相同名称的不同对象。换句话说，您确保在加载签名程序集时，您加载的正是您认为正在加载的内容。[Eric Lippert在这里](https://stackoverflow.com/questions/1334631/signing-of-net-assemblies)为这个特殊问题提供了一个很好的答案。

这与说可以信任已签名的程序集不同。为此，程序集可以包括[Authenticode](http://msdn.microsoft.com/en-us/library/ms537359%28v=VS.85%29.aspx)，这是一种数字签名，用于提供有关程序集开发人员/公司的信息。

## 什么是最简单的签名方式？

以下是[MSDN 的简短版分步](http://support.microsoft.com/kb/815808)说明：

1.  使用 SN.EXE 创建强密钥

    > sn -k C:\mykey.snk

2.  在 Visual Studio 中，在您的项目“属性”页面上，转到“签名”选项卡，然后选中“签署程序集”以选择刚刚创建的文件 ![在 Visual Studio 中检查标志程序集](https://i.stack.imgur.com/Lbf0V.png)

3.  重建你的项目，瞧。您的程序集现在已签名。您可以在项目的 CSPROJ 文件中看到这一点：

> ```
> <PropertyGroup>
>    <SignAssembly>true</SignAssembly>
> </PropertyGroup>
> <PropertyGroup>
>    <AssemblyOriginatorKeyFile>mykey.snk</AssemblyOriginatorKeyFile>
> </PropertyGroup> 
> ```

4.  **gacutil**工具允许您在 GAC 中管理共享程序集 ：
    *   安装：gacutil /i myassembly.dll
    *   在 GAC 中查看程序集：gacutil /l myassembly.dll
    *   卸载：gacutil /u myassembly.dll

## .SNK 文件有什么用途？

[SNK](http://www.fileinfo.com/extension/snk)是“强名称密钥”文件。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-02T13:58:12.237

这意味着赋予程序集一个独特的身份。这样做是为了保证程序集来自特定来源。请参阅 MSDN 文章*[Strong-Named Assemblies](http://msdn.microsoft.com/en-us/library/wd40t7ad(VS.71).aspx)*。强名称程序集支持[并行执行](http://msdn.microsoft.com/en-us/library/fdhkd3a5.aspx)、[GAC 中的程序集放置](http://msdn.microsoft.com/en-us/library/2h3sywsc.aspx)、[版本控制](http://msdn.microsoft.com/en-us/library/51ket42z.aspx)和其他一些功能。

最简单的签名方法是使用 Visual Studio 中的项目属性，即签名选项卡。这实际上在`.csproj`文件中添加了一个 XML 条目，告诉构建引擎使用所述密钥文件对程序集进行签名。关键文件是我们所说的这个“.snk”文件。它是使用[sn.exe .NET 工具](http://msdn.microsoft.com/en-us/library/k5b5tt23(VS.71).aspx)生成的。它包含签署[程序集](http://en.wikipedia.org/wiki/Assembly_%28CLI%29)所需的所有信息。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-02T14:09:56.673

签名是为了证明该程序集是由已知的个人或公司创建的，并且没有被其他任何人更改。

在对程序集进行签名时，会创建一个哈希并使用私钥进行签名。如果程序集被更改，例如被恶意软件更改，通过使用公钥（包含在程序集中）检查哈希和签名很容易找到。

因此，对程序集进行签名是为了保护目标系统免受黑客攻击。您可以在 .NET 配置中关闭签名检查。检查签名符合最终用户的利益。加载程序集时会检查签名。

snk 文件包含用于签署程序集的私钥和用于检查程序集的公钥。它需要受到保护。如果有人获得了您的私钥，他可以对程序集进行签名，就好像它们由您签名一样。

最简单的签名方法是在项目设置中选择 snk 文件。

# sql-server - 在 Sql Server 2005 中插入/更新一行时如何检索日期时间？

> ID：939678
> 
> 赞同：2
> 
> 时间：2009-06-02T13:51:06.853
> 
> 标签：sql-server, sql-server-2005, logging

有没有办法找到这些信息？也许在 Sql Server 的某种内部日志中？我需要根据历史数据生成报告，但我没有在我的应用程序中实现该功能，因为过去不是必需的。现在我被困住了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T13:52:55.133

您必须向表中添加一列（使其可为空），然后使用 getdate() 为所有行播种。这当然不准确，但这是您唯一的选择。一旦所有行都有数据，将 NOT NULL 约束添加到列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:52:43.633

对不起查理。如果它是一个网络应用程序，您可能能够根据该日志生成报告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:55:37.780

保留事务日志并且您正在发送日志的可能性很小。请咨询您的 DBA。

这些日志可以为您提供您正在寻找的日期/时间戳。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:56:32.223

SQL Server 没有对所有数据更改进行自动和完整的审核。

你必须构建它。无论它是否在最初的需求中，跟踪事情发生的时间是常识。

最好的办法是添加它，并接受新功能之前的数据没有跟踪。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T14:05:35.387

您可能很幸运能够从一些日志中获取数据，但您需要为未来做好准备。不管规范怎么说，添加一些额外的信息和日志记录是个好主意。

在非常重要的表中，我有一个包含行的每个版本的历史表，包括 LastChgID 和 LastChgDate。

在重要表中，我有 CreateID、CreateDate、LastChgID、LastChgDate

在所有其他表（代码表除外）中，我有 LastChgID、LastChgDate

当你设计系统时，你就会知道什么是重要的。

其中许多都显示在屏幕上，但即使不是，有些心烦意乱的人会打电话/发电子邮件给谁做这件事？你可以说“你做了一个 2009-06-02 10:06:22.213！”

# java - 如何使用 Java 将 JSON 数据发布到服务器

> ID：939682
> 
> 赞同：3
> 
> 时间：2009-06-02T13:51:47.863
> 
> 标签：java, json

我正在尝试构建一个 POST 请求以使用 REST api 将 JSON 数据发送到服务器。

由于 JSON 代码将作为请求参数值嵌入到请求正文中，我是否需要对该值进行编码以转义您通常在 JSON 语法中找到的特殊字符，例如“{}[]”。

是否有任何实用程序库可以做到这一点？

N。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T13:56:29.680

请求的正文不必是 URL 编码。看看[HttpClient](http://hc.apache.org/httpclient-3.x/index.html)。它是用于发出 POST 请求的事实上的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T13:57:13.097

[SOJO](http://sojo.sourceforge.net/guide/user/object-interchange.html)很好地处理了 Java 结构的序列化。但是你不需要在体内做任何逃避。正如其他人所建议的，对于执行实际的 HTTP 请求，[Apache HTTP Client](http://hc.apache.org/httpclient-3.x/index.html)项目是一个可靠的选择。

# ssl - 对称加密密钥与非对称密钥 - ssl

> ID：939687
> 
> 赞同：2
> 
> 时间：2009-06-02T13:52:12.670
> 
> 标签：ssl, openssl, encryption-symmetric, encryption-asymmetric

我正在开发一个使用 ssl (openssl) 在客户端和服务器之间建立安全通信通道的客户端服务器应用程序。我相信我现在有两种选择可以在客户端和服务器之间进行安全数据传输。一种选择是继续在客户端和服务器之间建立的安全 ssl 通道上进行数据传输，即使由于使用非对称密钥，加密/解密过程会很慢。另一种选择是在 ssl 通道上传输对称密钥，并在对称密钥交付给客户端后关闭 ssl 通道。此后的通信将使用对称密钥在常规 TCP 通道上进行，我相信这将比使用非对称密钥快得多。这种方法有什么缺点吗？对称密钥方法显而易见的一件事是密钥管理过程，我正在考虑通过根本不将密钥存储在客户端上来处理它。对称密钥将在启动时通过 SSL 通道传递给客户端。密钥根本不会存储在客户端中。有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T13:55:42.333

你把事情搞混了。Ssl 使用非对称密钥（在证书中定义）在客户端和服务器之间传递自动生成的对称密钥。然后在整个安全会话（通道）中使用此对称密钥。

所以基本上，您在使用 ssl 时已经有了快速的对称加密。唯一的非对称加密发生在通信的最开始。

不要尝试自己管理对称密钥。不起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T13:56:55.810

继续使用 SSL 连接，因为 SSL 在初始阶段之后使用对称密码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-07T23:08:30.963

> 一种选择是继续在客户端和服务器之间建立的安全 ssl 通道上进行数据传输，即使由于使用非对称密钥，加密/解密过程会很慢。

不，不会的。SSL 使用对称加密。

> 另一种选择是在 ssl 通道上传输对称密钥，并在对称密钥交付给客户端后关闭 ssl 通道。

一旦会话建立，客户端和服务器就已经有一个对称加密密钥。这只是多余的。

这里没有问题需要解决。

# java - 使用休眠禁用属性/集合加载

> ID：939689
> 
> 赞同：0
> 
> 时间：2009-06-02T13:52:30.843
> 
> 标签：java, hibernate

有谁知道如何防止休眠加载集合或多对一关联？

我有一个需要加载对象的用例，但调用程序可以确定是否加载了某些属性。集合的一部分也是如此：必须获取某些行，而其他行则不需要。

领域类：

```
public class SomeClass {
    private SomeClass parent;
    private Set<OtherClass> collection;
}

public class OtherClass {
    private Date startDate;
    private Date endDate;
}

public class Dao {
    public SomeClass loadClass(long id, boolean parents, boolean historicalData) {
         // load SomeClass
         // if parents == true, load parent, otherwise leave <null>
         // if historicalData == false, load OtherClass where endDate == <null>
    }
} 
```

我已经想到了 2 种解决方案，但如果可能的话，我现在可以使用标准或查询。

解决方案1是不要在休眠配置中建立从SomeClass到OtherClass的关联以及父/子关系，并在代码中加载关联。
解决方案 2 是定义具有不同实体名称的不同映射，以服务于特殊情况。

在这种情况下，调用者可以在其他 JVM 或事务中，因此会话被关闭，因此延迟加载不是一个真正的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T14:09:19.263

为此，您应该利用 Hibernate 的延迟加载功能。您可以注释一个集合，如：

```
@OneToMany(fetch=FetchType.LAZY) 
```

在这种情况下，Hibernate 仅在您实际在代码中访问它时才加载集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T18:32:09.107

编写 Criteria 查询并使用 setFetchMode 方法更改父项的获取行为，并使用 createCriteria 方法额外查询集合。

```
Criteria c = session.createCriteria(SomeClass.class).add(Restrictions.idEq(id));

if (parents) {
  c.setFetchMode("parents", FetchMode.EAGER);
}
if (historicalData) {
  c.createCriteria("collection", Criteria.LEFT_JOIN)
   .add(Restriction.lt("date", date))
   .setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);
}
return c.uniqueResult(); 
```

...这是假设默认设置为 LAZY（根据 Hibernate 默认设置）。

在 Hibernate 中，将具有值的属性保留为**空**是没有选择的（在这种情况下是多对一关联。该字段将包含可用于延迟加载引用的对象的代理。如果代码从未触及对象，它不会被加载。

集合也是如此：如果没有被获取，它将持有一个集合代理（一个实现集合接口的休眠类），它只会在调用时加载内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T14:11:13.410

像上面的海报所说的那样使用`@OneToMany(fetch=FetchType.LAZY)`，但请注意，集合和关联的延迟获取是 Hibernate 3.x 中的默认获取类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T14:40:38.733

我认为＃2是最好的解决方案。虽然我自己没有使用过这个解决方案，但我知道其他成功的开发人员。

# sql - 学习编写复杂报告查询的最佳在线 SQL 教程是什么？

> ID：939693
> 
> 赞同：6
> 
> 时间：2009-06-02T13:52:51.763
> 
> 标签：sql, oracle, reporting

我的 SQL 技能相当有限，因为最近我发现自己经常使用数据库（Oracle），所以我想超越基本的选择语句。

我想编写查询来执行诸如从多个表中获取数据、汇总数量、比较日期、分组、过滤等操作。

您可以推荐哪些网站来获得更高级的 SQL 报告技能？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-02T16:44:56.220

拿起 Joe Celcko[为 Smarties 编写的 SQL](https://rads.stackoverflow.com/amzn/click/com/1558605762)。这是一本权威的将你的 sql 带到下一级的书籍。否则，请继续编写查询。

确保您了解联接。从一开始，我的 SQL 方法就一直是行数驱动的——换句话说，当我编写一个复杂的查询时，我总是 #1 确保它返回正确的行数。如果您的行数是正确的，那么您的总和/组/聚合都将是正确的。他们很容易搞砸。

确保您了解数据。确保您了解键和唯一性，以便您可以强制执行连接。

您还可以阅读[asktom.oracle.com](http://asktom.oracle.com)，了解许多非常酷的 SQL 技巧。 [Laurent Schneider](http://laurentschneider.com/)在 sql 方面也非常先进。如果我在过去的 5-6 年里没有将 asktom 设置为我的主页，我就不会成为今天的 DBA/开发人员的一半。

最后，确保您了解基于集合的操作。将结果集视为一个整体，而不仅仅是行的集合。它会在您执行此操作时单击。这与行数驱动的方法有关。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T14:29:48.223

我知道这不在网上，但它适合您的账单：

我建议您阅读 Anthony Mollinaro 的[SQL Cookbook](http://oreilly.com/catalog/9780596009762/)。它描述了如何做许多超出基本 SELECT FROM WHERE 的复杂事情。在上一个。生活，当对上一个进行大量查询时。工作，那本书是我的救命稻草，人们经常借那本书。它有很多非常清晰的示例，范围从简单的（如何检索表中的行子集）到复杂的（使用窗口函数生成直方图）。

它不是免费的，但是这本书很快就会收回成本，我想它会回答你的大部分问题。注意：我与 O'Reilly 或 Mollinaro 先生没有任何关系，我只是认为这本书很棒而且非常有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T14:37:02.673

阅读 Oracle 数据仓库指南的第 20、21 和 22 章：http: [//download.oracle.com/docs/cd/B28359_01/server.111/b28313/toc.htm](http://download.oracle.com/docs/cd/B28359_01/server.111/b28313/toc.htm)。它是关于分组、分析和示范条款。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T14:38:48.457

[W3 Schools SQL 教程](http://www.w3schools.com/sql/default.asp)是一个很好的起点。它给出了不同类型连接的一些示例，并详细介绍了许多函数（即 sum、count、avg）。在理解复杂的查询之前，我真的必须先打好 SQL 的基础。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-16T17:49:46.167

我刚刚发现了一个名为*SQL Tutorial*的网站，我认为它非常好，并希望与社区分享。它位于[http://www.sql-tutorial.com/](http://www.sql-tutorial.com/)

# design-patterns - 包/程序集/命名空间级别的OO设计模式？

> ID：939700
> 
> 赞同：0
> 
> 时间：2009-06-02T13:53:27.550
> 
> 标签：design-patterns, assemblies, namespaces, packages

我正在看[这个问题](https://stackoverflow.com/questions/939167/c-circular-reference-and-cannot-see-namespace)，我想知道在将项目分解为包/程序集时是否可以使用任何设计模式/经验法则。

我通常似乎对此没有任何问题，因为我倾向于将东西分解成包/程序集，这样每个程序都尽可能少地与程序集相关，但我有时确实发现我处于关于一个类是否应该在一个命名空间或另一个命名空间中的损失。

我见过的大多数设计模式都可以帮助您决定如何构建类，但我认为我没有看到任何可以帮助您构建命名空间的设计模式？

有其他人看过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T13:55:29.247

设计模式是关于您编写​​的代码的行为和状态的最佳实践，而不是关于该代码的组织。想想你的类型以及它们是什么以及它们做什么，常见的类型将属于常见的命名空间。

# sql - CAST 错误地将 float 转换为 varchar

> ID：939703
> 
> 赞同：6
> 
> 时间：2009-06-02T13:54:09.873
> 
> 标签：sql, casting

组，我确信这是用户错误，但我试图将一列数字从浮点数转换为 varchar。它适用于 7 位以下的任何数字，但如果数字是 7 位数字，它会将其转换为科学记数法或他们所说的任何东西。例如：

440000 显示 440000 1299125 显示 1.29913e+006

看起来它正在四舍五入 7 位数字......我不知道为什么。

我正在尝试转换它，因为我需要将它连接到其他都是 VARCHAR 的字段

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T14:08:59.407

将您的浮点数包装在 str() 函数中，当仅给定一个参数时，该函数确实具有将所有内容都丢弃到小数点右侧的副作用。

问题：

```
select cast(cast(1234567890.01 as float) as varchar)

1.23457e+009 
```

答案不带小数：

```
select str(cast(1234567890.01 as float))

1234567890 
```

用小数回答：

```
select str(cast(1234567890.01 as float),13,2)

1234567890.01 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-23T10:48:41.070

`select cast(cast(@float as decimal(13,2)) as varchar)`

# c# - Silverlight Assembly.CodeBase 问题

> ID：939704
> 
> 赞同：0
> 
> 时间：2009-06-02T13:54:23.397
> 
> 标签：c#, .net, assemblies, silverlight-2.0

“此成员具有 SecurityCriticalAttribute 属性，该属性将其限制为供 Silverlight 类库的 .NET Framework 内部使用。”

有没有办法访问这些信息？（Silverlight 组件的原始位置）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-26T07:45:29.713

不，您永远无法访问任何具有 SecurityCriticalAttribute 的信息，这些信息只能通过 Silverlight 本身在内部进行访问。但是为什么要访问 Assembly.CodeBase？大多数你需要运行的东西，silverlight 让你可以通过浏览器界面访问。将 silverlight 视为 JavaScript 的唯一替代方案，您实际上无法访问客户端的机器信息或任何其他系统信息。您所能做的就是与您来自的服务器交谈。

# algorithm - 如何从点列表中找到模式（线、圆、...）？

> ID：939708
> 
> 赞同：10
> 
> 时间：2009-06-02T13:55:12.927
> 
> 标签：algorithm, artificial-intelligence, methodology, pattern-recognition

我有一个点列表。每个点都是一个`x`和`y`坐标（两者都是整数）。现在我试图找到已知的图案，例如线条、圆弧或圆，因为我知道这些点在图案上并不完美。

最好的方法是什么？我没有太多开始的线索。

编辑：点是有序的。用户正在绘制一些东西，程序应该检测到最佳模式。例如，如果绘制了一个三角形，它应该检测三条线。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T14:05:09.943

看看[霍夫变换](http://homepages.inf.ed.ac.uk/rbf/HIPR2/hough.htm)。你所做的是：你将你的图像转换为“圆形”空间，然后你只需要找到光像素。

在图像中找到亮像素非常容易，只需应用截止。

光像素区域的数量是圆圈的数量。您可以通过应用反函数重建它们在图像上的原始位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T14:04:23.440

经典的识别器是神经网络。神经网络工作“没问题”，并且需要以某种方式进行培训。

神经网络的数学技术和原理可以转移（经过适当的修改）到我读过的大多数其他识别器；例如，马尔可夫链、贝叶斯模型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:59:45.560

只要您将其限制为基本形状，您就可以计算当前笔画的平均“方向”，并从中创建一系列“笔画”。

根据该信息识别形状可能更容易：

*   一个圆有一个相当恒定的二阶导数
*   “七”在右边有一个笔划，然后是左下角的一个笔划
*   ...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T17:32:34.053

我你看看从某个点`P`到其他每个点的距离，而不是`P`一个圆的中心，你会得到一些非常明显的统计效果。

您也许可以扭转这一点并找到具有这些属性的点。作为第一遍，距离的标准偏差之类的东西可能会起作用，并且要找到位置，您可以取其相对于位置的导数并尝试将其最小化。找到最小值后，尝试找到一组与其等距的 >3 个点。

我预计您将需要标准偏差以外的其他东西，即对异常值不那么感兴趣而对聚集更感兴趣的东西。

此外，这对线路没有多大好处。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T17:41:35.723

由于您正在获取像素，并且它们是按顺序排列的，因此您可以首先检查每绘制 10 个像素之间的斜率，然后查看斜率如何变化。不连续性为您提供了一些信息。

# f# - 专家 F# 网络爬虫示例

> ID：939714
> 
> 赞同：5
> 
> 时间：2009-06-02T13:55:50.477
> 
> 标签：f#, ctp

我正在尝试通过基于**v1.9.2的***Expert F#*中的示例，但之后的 CTP 版本已经发生了足够的变化，以至于其中一些甚至不再编译。

 **我在清单 13-13 中遇到了一些麻烦。这是`urlCollector`对象定义的片段：

```
let urlCollector =
    MailboxProcessor.Start(fun self ->
        let rec waitForUrl (visited : Set<string>) =
            async { if visited.Count < limit then
                        let! url = self.Receive()
                        if not (visited.Contains(url)) then
                            do! Async.Start
                                (async { let! links = collectLinks url
                                         for link in links do
                                         do self <-- link })

                        return! waitForUrl(visited.Add(url)) }

            waitForUrl(Set.Empty)) 
```

我正在使用 Version **1.9.6.16**进行编译，编译器因此抱怨：

1.  表达式中此点处或之前的不完整结构化构造[在最后一个括号之后]
2.  此“让”的返回表达式中的错误。可能不正确的缩进 [指 let 定义`waitForUrl`]

谁能发现这里出了什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T14:07:42.543

看起来最后一行需要不缩进 4 个空格。

编辑：实际上，看起来这里还有更多事情要做。[假设这与此处](http://cs.hubfs.net/forums/thread/4932.aspx)的示例相同，那么这是我刚刚修改为与 1.9.6.16 版本同步的版本：

```
open System.Collections.Generic
open System.Net
open System.IO
open System.Threading
open System.Text.RegularExpressions

let limit = 10    

let linkPat = "href=\s*\"[^\"h]*(http://[^&\"]*)\""
let getLinks (txt:string) =
    [ for m in Regex.Matches(txt,linkPat)  -> m.Groups.Item(1).Value ]

let (<--) (mp: MailboxProcessor<_>) x = mp.Post(x)

// A type that helps limit the number of active web requests
type RequestGate(n:int) =
    let semaphore = new Semaphore(initialCount=n,maximumCount=n)
    member x.AcquireAsync(?timeout) =
        async { let! ok = semaphore.AsyncWaitOne(?millisecondsTimeout=timeout)
                if ok then
                   return
                     { new System.IDisposable with
                         member x.Dispose() =
                             semaphore.Release() |> ignore }
                else
                   return! failwith "couldn't acquire a semaphore" }

// Gate the number of active web requests
let webRequestGate = RequestGate(5)

// Fetch the URL, and post the results to the urlCollector.
let collectLinks (url:string) =
    async { // An Async web request with a global gate
            let! html =
                async { // Acquire an entry in the webRequestGate. Release
                        // it when 'holder' goes out of scope
                        use! holder = webRequestGate.AcquireAsync()

                        // Wait for the WebResponse
                        let req = WebRequest.Create(url,Timeout=5)

                        use! response = req.AsyncGetResponse()

                        // Get the response stream
                        use reader = new StreamReader(
                            response.GetResponseStream())

                        // Read the response stream
                        return! reader.AsyncReadToEnd()  }

            // Compute the links, synchronously
            let links = getLinks html

            // Report, synchronously
            do printfn "finished reading %s, got %d links" 
                    url (List.length links)

            // We're done
            return links }

let urlCollector =
    MailboxProcessor.Start(fun self ->
        let rec waitForUrl (visited : Set<string>) =
            async { if visited.Count < limit then
                        let! url = self.Receive()
                        if not (visited.Contains(url)) then
                            Async.Start 
                                (async { let! links = collectLinks url
                                         for link in links do
                                             do self <-- link })
                        return! waitForUrl(visited.Add(url)) }

        waitForUrl(Set.Empty))

urlCollector <-- "http://news.google.com"
// wait for keypress to end program
System.Console.ReadKey() |> ignore 
```

# algorithm - 表示地区->州->国家关系的有效数据结构

> ID：939715
> 
> 赞同：0
> 
> 时间：2009-06-02T13:56:00.227
> 
> 标签：algorithm, data-structures, hierarchy

我正在寻找一种有效的方式来表示和检索地理关系，例如。地区->州->美国。这应该适应任何层次的层次结构，例如。地区->地区->州->大地区（东/西/南/北）->美国。

我的要求是

1.  我主要在最低级别操作 - 所以让他们快速完成应该是第一要务。优选恒定时间。
2.  然后，我想轻松地在州级别执行聚合，例如合并地区数据（因此获取节点的所有子节点） - 这是第二个标准。
3.  一个级别的订单无关紧要 - 例如。对于北卡罗来纳州，我不介意我先得到罗利还是费耶特维尔。

正如您几乎已经猜到的那样 - **Tree**数据结构在逻辑上适用于该问题。但是我找不到有效地获取所有叶子的方法。我可以检查一个节点是否在 O(log n) 时间内是叶子，但我已经检查了每个节点。

我看过 B、B+ 树，但我不明白的是它们使用升序或降序等顺序来维持它们的顺序。

我的直觉是应该有有效的解决方案，因为 Windows 或任何文件系统都会这样做。文件->文件夹->大文件夹->C->我的电脑。这种计算也必须在数据挖掘中完成，比如说集群（我记得读过这类的东西）

在这个方向上的任何线索将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:10:16.750

您正在谈论检索`n`与给定标准匹配的唯一项目（在这种情况下，在给定节点下的层次结构中特定级别的所有内容）。`n`除非您预先计算了所有可能的标准，否则您无法在恒定时间内从数据结构中获取唯一项。至少您必须遍历这些`n`项目。

您可以使用许多数据结构和数据结构的组合来提高不同类型的使用效率。你是对的，B 和 B+ 树在这种情况下工作得很好，这就是为什么我建议你为这个应用程序使用关系数据库，因为它们是你能做到的最好和最健壮的 B 树实现找到。匹配叶节点和计算聚合几乎就是它们的用途。除非您有特殊原因不使用 RDBMS 子系统，否则这可能是您最好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-15T16:20:11.877

创建一个节点树，其中每个节点包含：

*   指向父节点的指针（或根节点为空）
*   子节点的集合（例如 Java 中的 HashMap 或 ArrayList）
*   与节点关联的任何数据负载（例如地理坐标，以便您进行距离搜索）

如果您愿意，您可以使用基于 HashMap 的 String -> Node 索引来扩充它，以便对节点进行 O(1) 访问。但是对于这个问题，我不会担心树搜索成本，因为您最多可能拥有超过 5-10 个级别。

# iis-7 - IIS 6.0 与 IIS 7.0 之间的区别

> ID：939733
> 
> 赞同：15
> 
> 时间：2009-06-02T13:59:31.703
> 
> 标签：iis-7, iis-6

我们正在使用带有 IIS 6.0 的 Windows 2003 服务器，并考虑迁移到带有 IIS 7.0 的 Window Server 2008 来托管我们的 .Net 应用程序

有人知道它有什么好处或坏处吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T14:02:42.210

一个明确的好处是应用程序池上的新“集成模式”。这允许 asp.net 比 iis6 更早地挂接到管道中。我们的一些应用程序使用它来对文件进行 url 重写，这在不向 asp.net dll 添加通配符扩展映射之前是不可能的。

我发现另一个有用的功能是远程管理。我相信远程管理在 iis 6 中可能已经可用，但如果是这样，它已针对 iis 7 进行了清理和改进。基本思想是您可以允许授权的远程用户连接到 iis 并管理 iis 的几乎所有功能。

在 iis 7 中也清理了 SSL 主机标头。您现在可以将 ssl 证书添加到服务器而不是站点。证书通过绑定对话框绑定到站点和 https 主机标头，就像 http 绑定一样。这具有额外的优势，可以非常简单地为多个站点快速部署一个证书。

**一个（希望是最后一个）编辑：**

Microsoft 发布了一个用于 Web 部署的工具，它提供了从 iis6 到 iis7 的迁移工具。如果您决定继续使用它，我强烈建议您下载它（[此处）并阅读](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1603 "这里")[此处](http://learn.iis.net/page.aspx/427/migrate-from-iis-60-to-iis-70/)的迁移说明。

大约一年前，我们经历了同样的过程，我对结果非常满意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T14:05:24.157

我发现一些有用的东西：

*   IIS 7 使您能够通过 Web.Config <rewrite><rules> 重写 URL
*   如果需要，您现在可以只重新启动一个网站，而不是重新启动 IIS。
*   更好的用户界面
*   更好的 PHP 集成 - [http://php.iis.net/](http://php.iis.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:05:35.573

最大的好处是集成管道。

[如何利用 IIS 7.0 集成管道](http://learn.iis.net/page.aspx/244/how-to-take-advantage-of-the-iis7-integrated-pipeline/)

> IIS 6.0 和以前的版本允许通过 ASP.NET 平台开发 .NET 应用程序组件。ASP.NET 通过 ISAPI 扩展与 IIS 集成，并公开了自己的应用程序和请求处理模型。这有效地暴露了两个独立的服务器管道，一个用于本地 ISAPI 过滤器和扩展组件，另一个用于托管应用程序组件。ASP.NET 组件将完全在 ASP.NET ISAPI 扩展气泡内执行，并且仅适用于在 IIS 脚本映射配置中映射到 ASP.NET 的请求。
> 
> IIS 7.0 将 ASP.NET 运行时与核心 Web 服务器集成在一起，提供了一个统一的请求处理管道，该管道同时暴露给称为模块的本机和托管组件。
> 
> **集成的许多好处包括**：
> 
> 允许本机和托管模块提供的服务适用于所有请求，无论处理程序如何。例如，托管表单身份验证可用于所有内容，包括 ASP 页面、CGI 和静态文件。
> 
> 使 ASP.NET 组件能够提供以前由于放置在服务器管道中而无法提供的功能。例如，提供请求重写功能的受管模块可以在任何服务器处理（包括身份验证）之前重写请求。
> 
> 一个实现、配置、监控和支持服务器功能的地方，例如单个模块和处理程序映射配置、单个自定义错误配置、单个 url 授权配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T14:09:12.697

我们在迁移过程中发现的一件大事是编辑 applicationhost.config 文件比使用 IIS 管理器本身更成功。

我们的应用程序必须进行很多更改。我会尽早开始测试。

# java - 在生产中使用 commons-pool 的提示

> ID：939734
> 
> 赞同：9
> 
> 时间：2009-06-02T14:00:24.993
> 
> 标签：java, sockets, pool

根据我在[这里](https://stackoverflow.com/questions/938784/good-client-socket-pool)得到的答案，我开始认真看待[commons-pool 。](http://commons.apache.org/pool/)我最后一次使用它是在 2003 年左右，可能是 1.1 或 1.2 版本。它的主要用户[DBCP](http://commons.apache.org/dbcp/)被许多人认为是有缺陷的，应该避免使用。

有没有人在生产中使用公共池来编写自己的池？最好使用的泳池类型是什么？我计划在其中存储**客户端**TCP 套接字。

是否有另一个通用池可以替代它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-01-06T14:11:49.653

> 有没有人在生产中使用公共池来编写自己的池？

是的，我这样做了，并且池保持 TCP 连接，就像你想要的那样。它是通过 Spring 连接起来的，所以假设您了解 Spring 配置：

```
<bean class="com.company.ConnectionSupplier">
<constructor-arg>
  <!-- The ConnectionSupplier wraps an object pool -->
  <bean class="org.apache.commons.pool.impl.GenericObjectPool">
    <constructor-arg>
       <!-- The ObjectPool uses a ConnectionFactory to build new connections -->
       <bean class="com.company.ConnectionFactory">
         <constructor-arg value="server" />
         <constructor-arg value="3000" />  
       </bean>  
    </constructor-arg>
    <property name="maxActive" value="20" />
    <property name="testOnBorrow" value="true" />
  </bean>
</constructor-arg>
</bean> 
```

ConnectionFactory 扩展了 BasePoolableObjectFactory 并且是 SocketFactory 的一个小包装器。

@First 评论： ConnectionFactory 构造函数需要一个服务器和一个端口。在覆盖的 makeObject() 中，它创建连接到该服务器和端口的套接字。它返回“连接”对象，这些对象使用一些方便的方法来包装创建的套接字，以便通过套接字进行通信。

使用通过套接字进行通信的协议提供的一种“ping”或“echo”来测试连接。如果不可用，则实际上不可能对连接进行验证/测试，除非询问套接字是否已关闭。在这种情况下，如果池中的 Connection 抛出异常，它就会失效，并且每个使用 Connections 的方法都应该为这种失败做好准备，并尝试对另一个连接进行相同的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-01T21:29:19.050

您应该检查实例化成本是否更高或从池中获取。因为使用池的唯一有效情况是第一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-02T18:30:48.357

你看过[Netty](http://jboss.org/netty)或[Apache MINA](http://mina.apache.org/)吗？它们都将跟踪您的 TCP 连接，并且应该使实现这些 TCP 套接字将使用的任何通信协议变得更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:39:46.393

查看[MultiThreadedHttpConnectionManager](http://hc.apache.org/httpclient-3.x/apidocs/org/apache/commons/httpclient/MultiThreadedHttpConnectionManager.html) - 它是一个 Apache Commons HttpClient 连接池管理器，可能会立即满足您的需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-29T12:10:06.687

首先不要使用 commons-pool 1.3，它在多线程应用程序中存在一些重大问题。

其次，Java 5 并发包具有不错的池实现（请参见[此处](http://www.ioncannon.net/java/30/thread-pooling-with-java-concurrency-utilities-new-java-15-and-old-utilconcurrent/)的示例）

# java - 将 VisualVM 与 JDK1.4 应用程序一起使用？

> ID：939736
> 
> 赞同：1
> 
> 时间：2009-06-02T14:00:55.583
> 
> 标签：java, visualvm, jdk1.4

我有兴趣使用 VisualVM（在 JDK 1.6 环境中运行）来监视和解决在 JDK 1.4（和 Tomcat 5.0）上部署和运行的应用程序的一些问题。

基本上，该应用程序会定期挂起，我很想看看我是否可以监视它以帮助找出位置。

VisualVM 的主页提到它可以与 JDK1.4 应用程序一起使用，但我无法弄清楚如何启用 1.4 应用程序/服务器来侦听 JMX 端口以接受我的连接。

之前有没有人将 VisualVM 连接到可以为我指明正确方向的 1.4 环境？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-14T12:33:17.330

您需要修改您的应用程序以提供 JMX bean - 默认情况下它们不包含在 JVM 中。有关如何实现这一点的更多信息，请参见[http://java.sun.com/developer/technicalArticles/J2SE/jmx.html 。](http://java.sun.com/developer/technicalArticles/J2SE/jmx.html)

# configuration - machine.config 中的 system.webserver 部分

> ID：939737
> 
> 赞同：7
> 
> 时间：2009-06-02T14:01:03.010
> 
> 标签：configuration, iis-7

我已经安装了 Windows 2008 Web Server 并启用了 IIS。但是，我的 machine.config 文件显示：section name = "system.webServer" type = "System.Configuration.IgnoreSection...

这是否意味着 system.webServer 部分被忽略？为什么？

我试图编辑一些网站的属性（例如目录浏览），它工作正常。machine.config 定义是否在其他地方更改？

乌鲁

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T14:30:50.297

system.webserver 配置现在维护在 system32\inetsrv\config\applicationhost.config。这是 IIS7 的全新[配置设置](http://learn.iis.net/page.aspx/127/deep-dive-into-iis-7-configuration/)。

一般来说，applicationhost.config 和 machine.config 是给系统管理员的，而 web.config 是给开发者的。

# python - 我如何使用 python 从键盘发送命令。我正在尝试自动化 mac 应用程序（GUI）

> ID：939746
> 
> 赞同：1
> 
> 时间：2009-06-02T14:02:16.283
> 
> 标签：python

我正在尝试使用 python 自动化应用程序。我需要帮助才能通过 python 发送键盘命令。我正在使用 powerBook G4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T11:10:02.273

您可以使用 osascript 工具从您的 python 脚本中调用 AppleScript：

```
import os
cmd = """
osascript -e 'tell application "System Events" to keystroke "m" using {command down}' 
"""
# minimize active window
os.system(cmd) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:00:12.577

据我所知，python 不包含模拟击键的能力。但是，您可以使用 python 调用具有 OS X 所需功能的程序。您也可以最有可能使用 Objective C 编写所述程序。

或者您可以省去痛苦并使用 Automator。也许如果您发布有关您正在自动化的内容的更多详细信息，我可以进一步添加一些内容。

# c++ - pthread_mutex_lock 上的分段错误

> ID：939747
> 
> 赞同：7
> 
> 时间：2009-06-02T14:02:27.623
> 
> 标签：c++, pthreads, segmentation-fault, mutex

我尝试做时遇到分段错误

```
pthread_mutex_lock(&_mutex). 
```

这真的很奇怪，我不确定是什么原因造成的。我已经在构造函数中初始化了 _mutex

```
pthread_mutex_init(&_mutex,NULL). 
```

我能做什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T20:42:23.913

解决了它，我对此感到非常恼火。我想将 Producer* 作为参数发送给 Pthread 运行的函数，因此我使用了 &(*iter)，其中 iter 是在生产者向量上运行的迭代器。

我几乎没有注意到它（正确地）是一个向量< Producer* >，这意味着我一直在发送产生未定义结果的 Producer* *。呸呸呸。显然，我没有注意到这一点，因为 Pthreads 是纯 C 语言，因此使用 void* 作为接受任何类型参数的唯一方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T14:05:29.227

附加**调试器**并找出导致段错误的**确切**原因。某些指针可能只是指向随机性或未初始化区域。

还运行**valgrind**的 memcheck 并查看内容。

**编辑**

针对下面的评论，pthread API 的使用在某处听起来不正确。我推荐了 O'Reilly 的“PThread Programming”作为参考。这就是让我前进的原因:) 我猜到了这一点，因为 API 的使用正在将 pthread_mutex_t 结构内部的指针移动到危险的地方。正确使用 API 不会发生这种情况。

# visual-c++ - Visual C++ 中的嵌套注释？

> ID：939753
> 
> 赞同：4
> 
> 时间：2009-06-02T14:02:56.407
> 
> 标签：visual-c++, comments

是否可以在 Visual C++ 中启用嵌套注释 (/* /* */ */)？

我似乎找不到开关，如果有的话。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T14:05:00.193

C++ 标准中不允许嵌套注释。Visual C++ 支持此标准。

抱歉，没有嵌套评论。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T14:04:35.653

我认为使用这种引用风格是不可能的。第一个“*/”将始终“关闭”引用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T14:05:44.467

我不相信这是可能的，但如果你想“注释掉”一段本身包含注释的代码，你总是可以使用预处理器，

```
#ifdef NOT_REQUIRED

/**
 * foo
 */
 void foo()
 { 

 }

#endif 
```

# python - Python中的线程

> ID：939754
> 
> 赞同：6
> 
> 时间：2009-06-02T14:03:16.127
> 
> 标签：python, multithreading

我是线程新手，想知道为各种任务（在服务器环境中）生成大量线程是否不好。与更线性的编程相比，线程是否占用更多的内存/cpu？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-02T14:15:42.573

如果要使用多个线程，则必须考虑多件事：

1.  您只能同时运行 #processors 线程。（明显的）
2.  在 Python 中，每个线程都是一个“内核线程”，通常占用大量资源（Linux 上默认为 8 mb 堆栈）
3.  Python 有一个全局解释器锁，这意味着一次只能处理一条 Python 指令，而与处理器的数量无关。但是，如果您的线程之一在 IO 上等待，则会释放此锁。

我从中得出的结论：

1.  如果您正在执行 IO（Turbogears、Twisted）或使用正确编码的扩展模块（numpy），请使用线程。
2.  如果您想同时执行 python 代码，请使用进程（最简单的多进程模块）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T18:51:34.590

由于您是线程新手，因此还有其他一些事情值得牢记——我更愿意将其视为值的并行范围。

对于任何给定对象的传统线性/顺序编程，您只有一个线程访问和更改一段数据。由于具有词法范围，这通常是安全的。具体来说，一个函数可以对变量的值进行操作而不影响全局值。如果你没有词法作用域，或者词法作用域很差，那么在一个函数中更改名为“foo”的变量的值会影响另一个名为“foo”的变量。这些天来，这个问题不太常见，但仍然很常见，可以提及。

使用线程，您会以更微妙的方式遇到同样的问题。虽然您仍然有词法作用域帮助您 - 因为一个函数中的局部值“X”独立于另一个函数中称为“X”的另一个局部值，但数据结构是可变的这一事实是线程中错误的主要来源。

具体来说，如果一个函数传递了一个可变值，那么在线程环境中，除非您小心，否则该函数不能保证该值不会被其他任何东西更改。

这种共享状态可能是线程系统中 90-99% 的错误的来源，并且很难调试。因此，如果你要编写一个线程系统，你应该记住你的共享值将传播的距离——即并行访问的范围。

为了限制错误，您有一些已知有效的选项：

1.  不使用共享状态 - 使用线程安全队列传递共享数据
2.  在所有共享数据周围加锁，并确保在整个代码中忠实地使用它。有时这比人们想象的要困难得多。当你“忘记”锁定一个对象时，问题就出现了——这对人们来说非常容易做到。
3.  有一个对象 - 一个所有者 - 负责共享状态。允许客户端线程向它询问处于共享状态的值的副本，这些副本伴随着一个令牌。当他们想要更新共享状态时，他们会将消息连同他们拥有的令牌一起传回给单个对象。然后所有者可以确定是否发生了更新冲突。

1 最相当于 unix 管道。3 在逻辑上等同于版本控制，通常被称为软件事务内存。

1 和 3 是 Kamaelia 支持的并发模式，旨在消除类 2 引起的错误。（披露，我运行 Kamaelia 项目）不支持 2，因为它依赖于“总是把一切都做好”。

不管你使用哪种方法来解决你的问题，牢记这个问题，以及处理它的方法，并预先计划你打算如何处理它，这将让你日后头疼不已。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-02T14:11:54.423

这取决于平台。

Windows 线程在创建时必须提交大约 1MB 的内存。拥有某种线程池比像疯子一样产生线程要好，以确保您分配的线程永远不会超过固定数量。此外，当您使用 Python 工作时，您会受到全局解释器锁的影响，这会阻碍依赖于大量并发线程的代码。

在 Unix 上，您可以考虑使用不同的进程而不是线程，或者查看其他异步处理方式（Twisted 服务器框架有处理异步网络任务的有趣方式，如果您真的喜欢冒险，可以看看 stackless Python ，一个完全不使用内核线程的延续框架）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T14:20:53.860

如果您需要并发性，您可以考虑使用微线程。[这里](http://www.ibm.com/developerworks/library/l-pythrd.html)有一篇关于这个主题的好文章。优点是您不会创建消耗资源并导致上下文切换的“真实”线程。当然，缺点是您没有利用多核技术。

这是[Kamaelia](http://www.kamaelia.org/Home)和[stackless](http://www.stackless.com/)采用的方法。

如果你在做 I/O，你也可以考虑使用异步 I/O。这对编程来说可能是一个真正的痛苦，但它可以防止线程争夺 CPU 时间。不幸的是，我不知道在 Python 中有任何独立于平台的方式来执行此操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T16:05:38.653

Excellent answers all around! I just wanted to add that, if you decide to go with a thread pool (generally advisable if you decide that threads are suitable for your app), you would be well advised to reuse (and possibly adapt) an existing general-purpose implementation, such as [Christopher Arndt's](http://chrisarndt.de/projects/threadpool/), rather than roll your own from scratch (which is always an instructive undertaking, to be sure, but less productive in terms of time it takes to get you properly working and debugged code;-).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T14:18:48.760

线程确实有一些 CPU 和内存开销，但除非您产生数百或数千个线程，否则它通常并不那么重要。更重要的问题是，如果您在并发线程之间共享任何可写的数据结构，线程会使正确的编程变得更加困难。请参阅论文[The Problem with Threads](http://www.eecs.berkeley.edu/Pubs/TechRpts/2006/EECS-2006-1.pdf)以了解为什么它们不是并发编程的良好抽象。

# java - Ant 类路径顺序

> ID：939757
> 
> 赞同：7
> 
> 时间：2009-06-02T14:04:05.547
> 
> 标签：java, ant, classpath

如何在 ant 中设置类路径顺序？

具体来说，当我尝试运行我的 ant 构建时，我需要它在 jar (jaxws-api.jar) 中选择一个类，而不是在 jre 中选择同一个类。我目前正在将类路径设置为明确包含这些 jar，但它似乎仍然首先选择 jre。我正在寻找的是某种与“构建配置”菜单下的 Eclipse 中的 Order/Export 等效的类型。

编辑：我会更明确。我有一些使用 CXF 2.1.3 生成的类。他们调用 javax.xml.ws.Service#getPort(QName, Class, WebServiceFeature...)。我正在使用 Java 版本 1.6.02。该版本的该类中不存在此方法。但是，它确实存在于 jaxws 版本的类（以及更高版本的 JRE 类）中。当我尝试进行 ant 构建时，总是在 jaxws 版本之前首先选择 JRE 类。这使我的编译失败。如何修改我的类路径以将 JRE 放在最后？

我无法更改 JRE 版本，因此请不要建议将其作为修复，除非它是唯一可能的修复。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T14:44:15.497

看起来您需要使用[Javac](http://ant.apache.org/manual/Tasks/javac.html)或[Java](http://ant.apache.org/manual/Tasks/java.html) Ant 任务`bootclasspath`中的设置。

您可以随时`ant -v`获取 Ant 构建的详细输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T14:08:47.160

ant 类路径中的罐子按照您声明它们的顺序放置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-07T23:12:54.733

我在使用 Google web toolkit 和 servlet 3.0 API 文件时遇到了同样的问题。我需要确保我的 servlet API jar 在 GWT 库 jar 之前。这是有效的方法：

```
<path id="classpath">
        <filelist>
            <file name="${build.input}/__lib__/servlet-api.jar"/>
        </filelist>
        <fileset dir="${build.input}/__lib__">
            <include name="*.jar" />
        </fileset>
        <fileset dir="${build.input}/WEB-INF/lib">
            <include name="*.jar" />
        </fileset>
    </path> 
```

请注意，需要首先列出的 jar 在文件列表中首先列出，然后我可以从其他目录添加 jar。我在接受的答案中尝试了引导类路径，但它不起作用。

# sql-server-2005 - ASP .NET 表分页的最快 SQL 2005 选择查询？

> ID：939761
> 
> 赞同：4
> 
> 时间：2009-06-02T14:04:40.350
> 
> 标签：sql-server-2005

使用 SQL 2005 选择一系列行（例如从 4.200.000 到 4.200.050）的最快方法是什么？假设我有 1000 万行。

在我自己的项目中，我使用以下方法，但我不确定这是否是最佳实践

```
select * from
(
    select 
        Column1, Column2, Column3
        RowNumber = row_number() over (order by ID asc) 
    from 
        tblLogs
    where
        Column4 = @Column4 and Column5 = @Column5
    ) as tempTable
where tempTable.RowNumber >= @StartIndex and tempTable.RowNumber <= @EndIndex 
```

使用上面的代码，我很想说**tempTable**将是一个大表，其中一列包含我所有的 ID。

有什么更快的吗？

不要想用 ID 列做一些变通办法，这行不通，我从该表中删除行，所以我的 ID 不是连续的数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:47:00.797

我注意到您有很多行，如果尚未添加，在 Column4 和 Column5 上添加**索引会显着提高性能。**

我发现以下文章很有趣：[Ranking Functions and Performance in SQL Server 2005](http://www.sql-server-performance.com/articles/per/ranking_functions_performance_p1.aspx)

如果可能的话，我会让你弄清楚如何根据文章改进它。我自己测试了他们的解决方案并且它有效。

如果您期待 ASP.NET 中的分页，我还发现 Scott Mitchell 的以下文章非常有趣：[使用 SQL Server 2005 在 ASP.NET 2.0 中自定义分页](http://www.4guysfromrolla.com/articles/031506-1.aspx)

它在我的代码中使用了他们的方法，效果很好。以下是 TSQL 代码示例：

```
 SELECT ROWNUM, COLUMN1, COLUMN2, COLUMN3
    FROM (
    SELECT COLUMN1, COLUMN2, COLUMN3,
    ROW_NUMBER() OVER(ORDER BY ID) AS ROWNUM
            FROM TABLE1
    WHERE COLUMN4 = @X AND COLUMN5 = @Y
    ) AS TABLE2
WHERE ROWNUM BETWEEN @startRowIndex AND (@startRowIndex + @maximumRows) - 1 
```

我建议阅读 4guysfromrolla 的文章以获取更多信息。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T14:09:57.093

如果您正在分页，您可以传入当前页面的第一个和最后一个键，并使用它们限制派生的“tempTable”，使其返回更少的行，从而更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T19:40:31.323

行。这是我对这个问题的最终想法。

对于包含 1000 万行或更多行的表的大型项目，我将使用这种方法：

```
 select * from
  (
        select 
        myTable.*, 
        RowNumber = row_number() over (order by myTable.ID asc) 
    from 
        myTable
        where
                myCondition
  ) as tempTable
  where tempTable.RowNumber >= @StartIndex and tempTable.RowNumber <= @EndIndex 
```

*   对于 ASP .NET 分页，我将使用下面的 SELECT，它对前 100.000 行、10.000 页（每页 10 行）的运行速度非常快，但从第 10.000 页到 Infinity，查询的运行速度会越来越慢，甚至非常慢。没有人会想浏览 10.001 页面！！

*   为了从上面的 SELECT 中计算满足 myCondition 的页数和行数，我将制作一个只有一行和一列的特殊 TABLE，在此列上我将存储行数。*每次我从 myTable 添加、修改或删除一行时，我都会根据 myCondition 更新这个冒号，方法是用值 1 添加或减少它。这样做的目的是快速选择满足 myCondition 的行数并显示给我的用户我有多少页。*

# xml - 嵌套 DTD 可能吗？

> ID：939762
> 
> 赞同：1
> 
> 时间：2009-06-02T14:04:41.020
> 
> 标签：xml, dtd

1.  一个 XML 文件可以引用两个 DTD 吗？
2.  一个 DTD 可以从另一个外部 DTD 引用元素吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T14:15:20.937

第一个问题：是的（有关示例和说明，请参阅[此帖子）](http://mailman.ic.ac.uk/pipermail/xml-dev/1999-November/015894.html)

第二个问题：我没有尝试过，但是使用该帖子中解释的技术应该是可能的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T14:19:32.053

1.  据我所知 - 不，他们不能。作为对 PhilS 帖子的评论 - 他链接的示例只是嵌入式 DTD 的示例，其中引用了其他 DTD。这是问题2的一个例子。
2.  DTD 可以拆分为独立的部分。`<!ENTITY % name SYSTEM "name.dtd">%name;`您可以通过（粗略地从 XML in a Nutshell 翻译）来定义它。一个示例 DTD 是 DocBook-DTD。它由 28 个部分组成。

（我未能将代码放在引用的部分中，因此没有显示 - 抱歉）。

# javascript - 对不同的 HTML 文档元素使用具有相同规则名称的不同 CSS 表

> ID：939763
> 
> 赞同：2
> 
> 时间：2009-06-02T14:04:53.173
> 
> 标签：javascript, css, html, styles

我需要一种方法来加载具有相同规则名称的多个样式表，然后将它们应用于页面上的不同元素。这可能吗？

这是我想做的事情的一个例子。取下面的两个样式表：

样式1.css：

```
.size{
    color: #FF6600;
    font-size: 18px;
} 
```

样式2.css：

```
.size{
    color: #FF0000;
    font-size: 14px;
} 
```

我希望能够将它们都导入一个页面（可能带有某种 id），然后将一个特定 div 中的文本设置为使用 style1.css 中的规则，另一个 div 应该使用 style2 中的规则.css。

我需要这样做，因为它允许我的应用程序的用户为页面上的不同小部件上传自定义样式表。如果工作表使用相同的规则命名方案，该方案应该可以工作。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-02T14:06:47.617

答案是否定的，你不能这样做。最后加载的规则将优先。

**您应该区分具有*不同类或 ID 的**不同*小部件，然后您将不会有相同的规则。**

 *```
#widgetB .size{
        color: #FF0000;
        font-size: 14px;
}

#widgetA .size{
        color: purple;
        font-size: 10px;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T14:09:36.283

也许您可以将每个小部件放在 iframe 中。在该 iframe 中，您将调用该小部件的自定义样式表。这样，您将赢得更多的模块化，并允许您直接做您想做的事，而不必担心作弊来解决问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T14:09:48.467

直接回答你的问题，“不”。CSS 代码本身必须有某种上下文。

至于“它将允许我的应用程序的用户为页面上的不同小部件上传自定义样式表” - 我的阅读方式是，我建议将每个小部件包装在唯一的 ID 或类似物中。

然后，用户可以上传带有一些上下文的样式表，但基本名称仍然相同，例如：

```
#widget-one .size { ... }

#widget-two .size { ... } 
```

但是某种上下文/前缀是必要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T14:06:16.430

如果你这样做，最后加载的样式表中声明的规则将适用于它匹配的所有元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T14:09:29.763

也许您可以使用 jQuery 之类的东西来删除默认页面 CSS 并将其替换为用户样式表，基本上是在客户端交换样式表。

# php - 将未知文件编码批量转换为 UTF-8

> ID：939774
> 
> 赞同：2
> 
> 时间：2009-06-02T14:06:04.140
> 
> 标签：php, linux, character-encoding

我需要将一些文件转换为 UTF-8，因为它们是在其他 UTF-8 站点中输出的，并且内容有时看起来有点丑陋。

我可以现在执行此操作，也可以在读取它们时执行此操作（通过 PHP，仅使用 fopen，没什么特别的）。欢迎任何建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-09T06:11:29.117

我对 PHP 没有明确的解决方案，但对于 Python，我个人使用了[Universal Encoding Detector 库](http://pypi.python.org/pypi/chardet)，它在猜测文件的编码方式方面做得很好。

只是为了让你开始，这是我用来进行转换的 Python 脚本（最初的目的是我想从 UTF-16 和 Shift-JIS 的混合体转换一个日语代码库，我做了一个默认猜测如果 chardet 对检测到编码没有信心）：

```
import sys
import codecs
import chardet
from chardet.universaldetector import UniversalDetector

""" Detects encoding

Returns chardet result"""
def DetectEncoding(fileHdl):
detector = UniversalDetector()
for line in fileHdl:
    detector.feed(line)
    if detector.done: break
detector.close()
return detector.result

""" Reencode file to UTF-8
"""
def ReencodeFileToUtf8(fileName, encoding):
    #TODO: This is dangerous ^^||, would need a backup option :)
    #NOTE: Use 'replace' option which tolerates errorneous characters
    data = codecs.open(fileName, 'rb', encoding, 'replace').read()
    open(fileName, 'wb').write(data.encode('utf-8', 'replace'))

""" Main function
"""
if __name__=='__main__':
    # Check for arguments first
    if len(sys.argv) <> 2:
    sys.exit("Invalid arguments supplied")

    fileName = sys.argv[1]
    try:
        # Open file and detect encoding
        fileHdl = open(fileName, 'rb')
        encResult = DetectEncoding(fileHdl)
        fileHdl.close()

        # Was it an empty file?
        if encResult['confidence'] == 0 and encResult['encoding'] == None:
            sys.exit("Possible empty file")

        # Only attempt to reencode file if we are confident about the
        # encoding and if it's not UTF-8
        encoding = encResult['encoding'].lower()
        if encResult['confidence'] >= 0.7:
            if encoding != 'utf-8':
                ReencodeFileToUtf8(fileName, encoding)
        else:
            # TODO: Probably you could make a default guess and try to encode, or
            #       just simply make it fail

        except IOError:
            sys.exit('An IOError occured') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T14:08:02.340

只执行一次可以提高性能并减少未来出错的可能性，但如果您不知道编码，则根本无法进行正确的转换。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-02T14:11:09.947

我对此的第一次尝试是：

1.  如果它在语法上是有效的 UTF-8，则假定它是 UTF-8。
2.  如果只有字节对应于 ISO 8859-1 (Latin-1) 中的有效字符，则假设。
3.  否则，失败。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T15:19:37.577

一个文件可以包含来自不同代码页的数据吗？

如果是，那么您根本无法进行批量转换。您必须知道文件中每个子字符串的每个代码页。

如果不是，则可以一次批量转换文件，但假设您知道该文件具有什么代码页。所以我们或多或少地回到了与上面相同的情况，我们只是将抽象从子字符串范围移动到文件范围。

所以，你需要问自己的问题是。你有关于某些数据属于哪个代码页的信息吗？如果没有，它仍然看起来很丑陋。

您总是可以对您的数据进行一些分析并猜测代码页，尽管这可能会使它变得不那么笨拙，但您仍然在猜测，因此它仍然会变得笨拙:)

# c++ - Linux API 列出正在运行的进程？

> ID：939778
> 
> 赞同：57
> 
> 时间：2009-06-02T14:06:38.943
> 
> 标签：c++, c, linux, api, process

我需要一个 C/C++ API，它允许我列出 Linux 系统上正在运行的进程，并列出每个进程打开的文件。

我*不想*最终直接读取 /proc/ 文件系统。

谁能想到一种方法来做到这一点？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-06-02T14:22:53.887

[http://procps.sourceforge.net/](http://procps.sourceforge.net/)

[http://procps.cvs.sourceforge.net/viewvc/procps/procps/proc/readproc.c?view=markup](http://procps.cvs.sourceforge.net/viewvc/procps/procps/proc/readproc.c?view=markup)

是ps等进程工具的源码。他们确实使用 proc （表明它可能是传统和最好的方式）。他们的源代码可读性很强。文件

```
/procps-3.2.8/proc/readproc.c 
```

可能有用。**ephemient 发布的另一个**有用的建议是链接到**libproc**提供的 API，该 API应该在您的存储库中可用（或者我会说已经安装），但您需要标题的“-dev”变体和其他东西。

**祝你好运**

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-06-02T16:25:43.160

If you do not want to read from '/proc. Then you can consider writing a Kernel module which will implement your own system call. And your system call should be written so that it can obtain the list of current processes, such as:

```
/* ProcessList.c 
    Robert Love Chapter 3
    */
    #include < linux/kernel.h >
    #include < linux/sched.h >
    #include < linux/module.h >

    int init_module(void) {
        struct task_struct *task;
        for_each_process(task) {
              printk("%s [%d]\n",task->comm , task->pid);
        }
        return 0;
    }

    void cleanup_module(void) {
        printk(KERN_INFO "Cleaning Up.\n");
    } 
```

The code above is taken from my article here at [http://linuxgazette.net/133/saha.html](http://linuxgazette.net/133/saha.html).Once you have your own system call, you can call it from your user space program.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-09-26T11:42:34.177

给你（C/C++）：

你可以在这里找到它： [http ://ubuntuforums.org/showthread.php?t=657097](http://ubuntuforums.org/showthread.php?t=657097)

本质上，它的作用是遍历 中的所有数字文件夹`/proc/<pid>`，然后在 上执行读取链接`/proc/<pid>/exe`，或者如果您想要命令行参数`cat /proc/<pid>/cmdline`

进程打开的文件描述符位于 中`/proc/<pid>/fd/<descriptor>`，您可以通过对每个符号链接执行读取链接来获取文件名，例如`readlink /proc/<pid>/fd/<descriptor>`. fd 可以是设备，例如 /dev/null、套接字或文件，甚至更多。

> #include <unistd.h>
> 
> ssize_t readlink(const char *path, char *buf, size_t bufsiz);
> 成功时，readlink() 返回放在 buf 中的字节数。
> 出错时，返回 -1 并设置 errno 以指示错误。

顺便说一句，这与`readproc.c`（或至少是）相同。
当然，希望他们在没有缓冲区溢出可能性的情况下做到了。

```
#ifndef __cplusplus
    #define _GNU_SOURCE
#endif

#include <unistd.h>
#include <dirent.h>
#include <sys/types.h> // for opendir(), readdir(), closedir()
#include <sys/stat.h> // for stat()

#ifdef __cplusplus
    #include <iostream>
    #include <cstdlib>
    #include <cstring>
    #include <cstdarg>
#else
    #include <stdio.h>
    #include <stdlib.h>
    #include <string.h>
    #include <stdarg.h>
#endif

#define PROC_DIRECTORY "/proc/"
#define CASE_SENSITIVE    1
#define CASE_INSENSITIVE  0
#define EXACT_MATCH       1
#define INEXACT_MATCH     0

int IsNumeric(const char* ccharptr_CharacterList)
{
    for ( ; *ccharptr_CharacterList; ccharptr_CharacterList++)
        if (*ccharptr_CharacterList < '0' || *ccharptr_CharacterList > '9')
            return 0; // false
    return 1; // true
}

int strcmp_Wrapper(const char *s1, const char *s2, int intCaseSensitive)
{
    if (intCaseSensitive)
        return !strcmp(s1, s2);
    else
        return !strcasecmp(s1, s2);
}

int strstr_Wrapper(const char* haystack, const char* needle, int intCaseSensitive)
{
    if (intCaseSensitive)
        return (int) strstr(haystack, needle);
    else
        return (int) strcasestr(haystack, needle);
}

#ifdef __cplusplus
pid_t GetPIDbyName(const char* cchrptr_ProcessName, int intCaseSensitiveness, int intExactMatch)
#else
pid_t GetPIDbyName_implements(const char* cchrptr_ProcessName, int intCaseSensitiveness, int intExactMatch)
#endif
{
    char chrarry_CommandLinePath[100]  ;
    char chrarry_NameOfProcess[300]  ;
    char* chrptr_StringToCompare = NULL ;
    pid_t pid_ProcessIdentifier = (pid_t) -1 ;
    struct dirent* de_DirEntity = NULL ;
    DIR* dir_proc = NULL ;

    int (*CompareFunction) (const char*, const char*, int) ;

    if (intExactMatch)
        CompareFunction = &strcmp_Wrapper;
    else
        CompareFunction = &strstr_Wrapper;

    dir_proc = opendir(PROC_DIRECTORY) ;
    if (dir_proc == NULL)
    {
        perror("Couldn't open the " PROC_DIRECTORY " directory") ;
        return (pid_t) -2 ;
    }

    // Loop while not NULL
    while ( (de_DirEntity = readdir(dir_proc)) )
    {
        if (de_DirEntity->d_type == DT_DIR)
        {
            if (IsNumeric(de_DirEntity->d_name))
            {
                strcpy(chrarry_CommandLinePath, PROC_DIRECTORY) ;
                strcat(chrarry_CommandLinePath, de_DirEntity->d_name) ;
                strcat(chrarry_CommandLinePath, "/cmdline") ;
                FILE* fd_CmdLineFile = fopen (chrarry_CommandLinePath, "rt") ;  // open the file for reading text
                if (fd_CmdLineFile)
                {
                    fscanf(fd_CmdLineFile, "%s", chrarry_NameOfProcess) ; // read from /proc/<NR>/cmdline
                    fclose(fd_CmdLineFile);  // close the file prior to exiting the routine

                    if (strrchr(chrarry_NameOfProcess, '/'))
                        chrptr_StringToCompare = strrchr(chrarry_NameOfProcess, '/') +1 ;
                    else
                        chrptr_StringToCompare = chrarry_NameOfProcess ;

                    //printf("Process name: %s\n", chrarry_NameOfProcess);
                    //printf("Pure Process name: %s\n", chrptr_StringToCompare );

                    if ( CompareFunction(chrptr_StringToCompare, cchrptr_ProcessName, intCaseSensitiveness) )
                    {
                        pid_ProcessIdentifier = (pid_t) atoi(de_DirEntity->d_name) ;
                        closedir(dir_proc) ;
                        return pid_ProcessIdentifier ;
                    }
                }
            }
        }
    }
    closedir(dir_proc) ;
    return pid_ProcessIdentifier ;
}

#ifdef __cplusplus
    pid_t GetPIDbyName(const char* cchrptr_ProcessName)
    {
        return GetPIDbyName(cchrptr_ProcessName, CASE_INSENSITIVE, EXACT_MATCH) ;
    }
#else
    // C cannot overload functions - fixed
    pid_t GetPIDbyName_Wrapper(const char* cchrptr_ProcessName, ... )
    {
        int intTempArgument ;
        int intInputArguments[2] ;
        // intInputArguments[0] = 0 ;
        // intInputArguments[1] = 0 ;
        memset(intInputArguments, 0, sizeof(intInputArguments) ) ;
        int intInputIndex ;
        va_list argptr;

        va_start( argptr, cchrptr_ProcessName );
            for (intInputIndex = 0;  (intTempArgument = va_arg( argptr, int )) != 15; ++intInputIndex)
            {
                intInputArguments[intInputIndex] = intTempArgument ;
            }
        va_end( argptr );
        return GetPIDbyName_implements(cchrptr_ProcessName, intInputArguments[0], intInputArguments[1]);
    }

    #define GetPIDbyName(ProcessName,...) GetPIDbyName_Wrapper(ProcessName, ##__VA_ARGS__, (int) 15)

#endif

int main()
{
    pid_t pid = GetPIDbyName("bash") ; // If -1 = not found, if -2 = proc fs access error
    printf("PID %d\n", pid);
    return EXIT_SUCCESS ;
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-02T14:35:46.823

如果您不这样做，那么我猜您将使用的任何 API 最终都会读取 /proc 文件系统。以下是一些执行此操作的程序示例：

*   [qps](http://www.student.nada.kth.se/~f91-men/qps/)
*   [htop](http://htop.sourceforge.net/)
*   [程序](http://procps.sourceforge.net/)

但不幸的是，这并不构成 API。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-02T19:00:54.947

PS 和所有其他工具（内核模块除外）从`/proc`. `/proc`是一个由内核动态创建的特殊文件系统，以便用户模式进程可以读取仅对内核可用的数据。

因此，推荐的方法是从`/proc`.

您可以快速直观地查看`/proc`文件系统以了解其结构。对于每个进程，都有一个`/proc/pid`pid 是进程 ID 号。在这个文件夹中有几个文件，其中包含有关当前进程的不同数据。如果你跑

```
strace ps -aux 
```

您将看到程序如何`ps`从`/proc`.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-02T14:50:22.833

在不读取 /proc 的情况下执行此操作的唯一方法是调用“ps aux”，遍历每一行，读取第二列（PID）并使用它调用 lsof -p [PID]。

...我建议阅读 /proc ;)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-08-26T05:01:44.753

`libprocps`该[`procps-ng`项目](http://gitorious.org/procps)有一个库。在 Ubuntu 13.04 上，如果你这样做`strace ps`，那么你可以看到`ps`使用`libprocps`.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-18T17:58:14.110

读proc还不错。我无法用 C++ 向您展示，但以下 D 代码应该为您指明正确的方向：

```
导入std.stdio；
导入标准字符串；
导入标准文件；
导入标准正则表达式；
导入std.c.linux.linux；

别名 std.string.split 爆炸；

字符串 srex = "^/proc/[0-9]+$";
字符串trex =“状态：[\t][SR]”；
正则表达式 rex；
正则表达式 rext；

   string[] scanPidDirs(字符串目标)
   {
      字符串[] 结果；

      布尔回调（DirEntry* de）
      {
         如果（de.isdir）
         {
            如果 (rex.find(de.name) >= 0)
            {
                string[] a = explode(de.name, "/");
                字符串 pid = a[a.length-1];
                字符串 x = cast(string) std.file.read(de.name ~ "/status");
                int n = rext.find(x);
                如果 (n >= 0)
                {
                    x = cast(string) std.file.read(de.name ~ "/cmdline");
                    // 这是空终止的
                    如果 (x.length) x.length = x.length-1;
                    a = 爆炸（x，“/”）；
                    如果（a.长度）
                       x = a[a.length-1];
                    别的
                       x = "";
                     如果（x == 目标）
                    {
                        结果 ~= pid ~ "/" ~x;
                    }
                }
             }
          }
          返回真；
      }

      listdir("/proc", &callback);
      返回结果.dup;
   }

无效的主要（字符串 [] 参数）
{
    rex=新正则表达式（srex）；
    rext=新正则表达式（trex）；
    字符串[] a = scanPidDirs(args[1]);
    如果 (!a.length)
    {
        writefln("未找到");
        返回;
    }
    writefln("%d 个匹配进程", a.length);
    foreach (s; a)
    {
       string[] p = explode(s, "/");
       int pid = atoi(p[0]);
       writef("停止 %s (%d)?", s, pid);
       字符串 r = readln();
       if (r == "Y\n" || r == "y\n")
          杀死（PID，SIGUSR1）；
    }
}

```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-07T06:31:10.110

按名称查找任何进程的 pid 的简单方法

```
pid_t GetPIDbyName(char* ps_name)
{

    FILE *fp;
    char *cmd=(char*)calloc(1,200);
    sprintf(cmd,"pidof %s",ps_name);
    fp=popen(cmd,"r");
    fread(cmd,1,200,fp);
    fclose(fp);
    return atoi(cmd);
} 
```

# php - 您是否使用任何 GoogleMaps Api PHP 包装类/库/脚本来绘制地图？

> ID：939782
> 
> 赞同：0
> 
> 时间：2009-06-02T14:06:55.167
> 
> 标签：php, google-maps

我想显示谷歌地图（多个标记等），只是发现有一个用于 PHP 的付费解决方案“GMap 2.3”。我正在寻找一个开源解决方案。你们是使用 Google Maps API 函数编码还是使用任何包装脚本？有什么好的链接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T14:13:38.240

我只是使用谷歌地图 api。几个月前，我编写了一个组合谷歌地图/天气地下 ajax 数据源，用于创建用户特定的天气报告。curl 在 php 端用于充当天气数据的代理。谷歌地图方面真的根本不需要任何 php。它真的只是依赖于javascript。

尝试在没有付费库的情况下进行操作，您可能会发现它比您预期的要容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T14:20:46.277

这是我使用的 api 包装器

[http://www.phpinsider.com/php/code/GoogleMapAPI/](http://www.phpinsider.com/php/code/GoogleMapAPI/)

它工作得很好而且它是开源的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-08T19:17:22.347

我们正在更新 PHP Google Map API 类（前面提到过）以使用 Google Maps JS API 的新 V3 - 您可以在[http://code.google.com/p/php-google-获取更新的项目文件地图API](http://code.google.com/p/php-google-map-api)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-02T15:21:44.330

我使用[Drupal](http://drupal.org/)和[Gmap](http://drupal.org/project/gmap) / [Location](http://drupal.org/project/location)模块。它们非常强大，可以处理不同的标记引擎，包括聚类。

# asp.net - 如何配置 ELMAH 以使用 Windows Azure？我在 Elmah.axd 上得到 404

> ID：939783
> 
> 赞同：37
> 
> 时间：2009-06-02T14:07:06.587
> 
> 标签：asp.net, asp.net-mvc, azure, elmah

我有一个在 Windows Azure 上运行的 ASP.NET MVC Web 角色，并在 web.config 中正确设置了 ELMAH。我也有我的 global.asax 忽略 *.axd 路线。在本地，我可以加载 /elmah.axd，但是当我部署到 Azure 时，我在该页面上得到 404。有没有人让 ELMAH 在 Azure 上工作？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-10T20:25:58.600

Azure 基于 Windows Server 2008 和 IIS7。这意味着您需要填充 web.config 文件的 system.webServer 部分。

elmah 源代码中包含的示例文件包含您需要输入的详细信息。

```
<system.webServer>
  <validation validateIntegratedModeConfiguration="false"/>
  <modules>
    <remove name="ScriptModule" />
    <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah"/>
  </modules>
  <handlers>
    <remove name="WebServiceHandlerFactory-Integrated"/>
    <remove name="ScriptHandlerFactory" />
    <remove name="ScriptHandlerFactoryAppServices" />
    <remove name="ScriptResource" />
    <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode"
         type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode"
         type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add name="elmah" verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
  </handlers>
</system.webServer> 
```

在上面的 xml 块中有 2 行需要包含在内，并且该部分通常应该包含大部分（如果不是全部）这些元素。

编辑：不再需要，因为现在默认情况下启用：

~~为了使 Elmah 工作，您还需要修改 ServiceDefinition.csdef 文件中的以下行：~~

 ~~```
<WebRole name="WebRole" enableNativeCodeExecution="true"> 
```~~  ~~* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-07-06T20:25:49.080

还要保护文件，以便只有允许的用户才能查看错误日志！

```
<location path="admin/elmah.axd">
    <system.web>
        <authorization>
            <allow roles="Administrator" />
            <deny users="*" />
        </authorization>
    </system.web>
</location> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-15T07:14:21.750

我认为另外（根据[@mat1t here](https://stackoverflow.com/questions/939783/how-to-configure-elmah-to-work-with-windows-azure-i-get-a-404-on-elmah-axd/977956#977956)的建议）您可能需要将远程访问设置为 1：

```
<elmah>
<security allowRemoteAccess="0" />
..............
..............
</elmah> 
```

# c# - C# 将图像对象读入 Web 请求

> ID：939790
> 
> 赞同：0
> 
> 时间：2009-06-02T14:08:05.740
> 
> 标签：c#, image, httpwebrequest

嘿，我目前正在尝试使用 Web 请求、内存流和图像对象将图像文件发送到 Web 服务器。

这是我当前发送请求的方法：

```
 public void Send(Image image)
    {
        //Assign the request here too, just in case
        Request = (HttpWebRequest)WebRequest.Create(FormURL);

        Request.Method = "POST";
        Request.ContentType = "multipart/form-data; boundary=" + CONTENT_BOUNDARY;
        Request.Headers.Add("Cache-Control", "no-cache");
        Request.KeepAlive = true;
        Request.ContentLength = GetFormElements().Length +
        GetFileHeader(FileName).Length +
        FILE_TRAIL.Length +
        ConvertImageToByteArray(image).Length;

        //Must be done in this order for stream to write properly:
        //----
        //Form elements
        //File header
        //Image
        //File trailer
        //----
        WriteStringToStream(FileStream, GetFormElements());
        WriteStringToStream(FileStream, GetFileHeader(FileName));
        WriteImageToStream(FileStream, image);
        WriteStringToStream(FileStream, FILE_TRAIL);

        string PostData = ASCIIEncoding.ASCII.GetString(ConvertImageToByteArray(image));

        StreamWriter SW = new StreamWriter(Request.GetRequestStream(), Encoding.ASCII);
        SW.Write(PostData);

        GetRequestResponse();
        Console.WriteLine(Request.HaveResponse);
        FileStream.Close();
        Request = null;

    } 
```

我遇到的问题是我根本没有从服务器得到任何响应，尽管流看起来是正确的长度（我从上面的代码中删除了一些调试输出）

如有必要，我可以发布我班级的其他部分，但现在这里是写作功能：

写字符串到流：

```
 private void WriteStringToStream(System.IO.MemoryStream stream, string String)
    {
        byte[] PostData = System.Text.Encoding.ASCII.GetBytes(String);
        stream.Write(PostData, 0, PostData.Length);
    } 
```

WriteImageToSteam：

```
private void WriteImageToStream(System.IO.MemoryStream Stream, Image img)
{
    Stream.Write(ConvertImageToByteArray(img), 0, ConvertImageToByteArray(img).Length);
} 
```

转换图像到字节数组：

```
 private Byte[] ConvertImageToByteArray(Image img)
    {
        //Method taken from http://www.csharp-station.com/Articles/Thumbnails.aspx and adapted
        MemoryStream memStream = new MemoryStream();
        img.Save(memStream, System.Drawing.Imaging.ImageFormat.Jpeg);

        byte[] byteArray = new Byte[memStream.Length];

        memStream.Position = 0;
        memStream.Read(byteArray, 0, (int)memStream.Length);
        return byteArray;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T14:34:54.737

您应该在发送请求之前关闭 SW。

此外，您应该将字节数组直接写入请求流，而不是将字节数组转换为 ASCII 然后将其写入 StreamWriter。（然后在发送请求之前关闭请求流）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T14:32:33.930

“FileStream”的目的是什么？声明未显示，您将数据写入，然后将其关闭。您是不是想将其写入请求流并忘记了？似乎您将其计入 Request.ContentLength，但从不将其写入请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T14:59:57.430

```
 private void GetRequestResponse()
    {
        if (null == FileStream)
        {
            System.IO.Stream stream;
            WebResponse webResponse;
            try
            {
                webResponse = Request.GetResponse();
            }
            catch (WebException web)
            {
                webResponse = web.Response;
            }

            if (null != webResponse)
            {
                stream = webResponse.GetResponseStream();
                StreamReader sr = new StreamReader(stream);
                string str;
                Response = "";

                while ((str = sr.ReadLine()) != null)
                {
                    Response += str;
                }
                webResponse.Close();
            }
            else
            {
                throw new Exception("Error retrieving server response");
            }
        }
    } 
```

响应SLaks，上面就是GetRequestResponse的内容。在这个类中，Response 只是一个字符串。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-02T15:28:51.663

问题解决了:)我现在有一个回应——即使这不是我所期待的......

# .net - 如何使用 .NET 进行全双工编程？

> ID：939796
> 
> 赞同：2
> 
> 时间：2009-06-02T14:09:05.117
> 
> 标签：.net, real-time, google-wave

在看过 Google Wave 演示之后，我想将“实时”功能整合到我的 Web 应用程序中，一个用户将能够看到另一个用户正在输入的文本......

除了基于框架如何处理线程的.NET中内置的软实时功能......

还有什么我需要的吗？是否有任何实时 Web 应用程序的模式或架构参考？我应该读什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-20T16:39:01.970

Check out [WebSync](http://www.frozenmountain.com/websync). It's a .NET comet server that should do exactly what you need.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T14:36:31.627

您可以尝试在 Silverlight 中使用全双工通道。类似于 Java 小程序的想法，但在 .Net 中除外。

[WCF + Silverlight](http://weblogs.asp.net/dwahlin/archive/2008/06/16/pushing-data-to-a-silverlight-client-with-wcf-duplex-service-part-i.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:11:55.173

如果不使用 Java 小程序或类似程序，您的 HTML/JavaScript 前端将需要**轮询服务器**以获取相关事件和更改。

在后端，有多种方法可以实现分布式事件队列或类似的方法，以便在服务请求的各个进程之间共享。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T14:39:11.200

Ajax、[SUP](http://en.wikipedia.org/wiki/Simple_Update_Protocol)和[XMPP](http://en.wikipedia.org/wiki/Xmpp)将在这方面为您提供帮助。还要研究 Twitter 搜索和 Friendfeed 的工作原理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T15:50:37.343

彗星，虽然并不总是合适的，但在某种意义上它是“轮询”，尽管它只在一项可能长期工作的开始时轮询一次；然后服务器保持 HTTP 连接打开，直到它准备好响应。

正如 Wikipedia 所定义的：“在 Web 开发中，Comet 是一种新词，用于描述一种 Web 应用程序模型，在这种模型中，长期持有的 HTTP 请求允许 Web 服务器将数据推送到浏览器，而无需浏览器显式请求它。”

发现这对于可能需要服务器五分钟才能完成的作业很有用，而不是每 x 秒轮询一次，客户端发出请求，服务器基本上说“挂起......”并完成工作并返回完成时的数据。

有几个库支持这种类型的 Ajax 实现，包括 Dojo (dojo.com) 和 ExtJS 3.0 (extjs.com)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-30T12:34:09.470

我们开发了一个操作转换引擎，这是支持 Google Wave 的技术后端，并使用 Silverlight 上的 DuplexChannel 进行了同步绘图和文本编辑演示。您可以从[http://www.corvalius.com/blog/index.php/technology/announcing-the-availability-of-the-beweevee-sdk-september-ctp/](http://www.corvalius.com/blog/index.php/technology/announcing-the-availability-of-the-beweevee-sdk-september-ctp/)下载它。

我们计划为非商业/学术目的完全免费发布 SDK（目前处于预览阶段）；因此，您可能会感兴趣。至少您将能够找到一个非常简单的示例，说明如何在源代码中为协作应用程序执行全双工（包括小型 WCF 服务器）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-13T11:11:03.300

由于它是一个网络应用程序，我建议您尝试[etherpad](https://etherpad.mozilla.org/)！

有一个[关于 HTTP API 的 .NET Client 示例](https://github.com/narasimhandl/EtherpadLiteDotNet/)和[一个关于其他示例的页面](https://github.com/ether/etherpad-lite/wiki/HTTP-API-client-libraries/)

# asp.net - 使用 ASP.NET 验证器进行日期验证

> ID：939802
> 
> 赞同：66
> 
> 时间：2009-06-02T14:09:51.383
> 
> 标签：asp.net, validation

我正在尝试使用 ASP.NET`RangeValidator`来验证文本框上的日期。在文本框中输入的日期格式为`dd MMMM yyyy`.

如何使用范围验证器来验证有效日期？如果我输入**1000 年 1 月 1 日**作为最小值或最大值，我会收到一条错误消息，指出无法将值转换为类型日期，但如果我使用其他格式，它会将我输入的文本视为无效。

下面是我的代码：

```
<asp:TextBox 
    runat="server" 
    ID="txtDatecompleted" 
/>
<cc2:CalendarExtender
    ID="datecompletedExtender" 
    runat="server"
    TargetControlID="txtDatecompleted"
    Format="dd MMMM yyyy"
/>  
<asp:RangeValidator 
    runat="server" 
    ID="RangeValidator1" 
    Type="Date" 
    ControlToValidate="txtDatecompleted" 
    MaximumValue="9999/12/28" 
    MinimumValue="1000/12/28" 
    ErrorMessage="enter valid date" 
    Display="None"
/>
<cc2:ValidatorCalloutExtender 
    ID="RangeValidator1_ValidatorCalloutExtender" 
    runat="server"
    Enabled="True"
    TargetControlID="RangeValidator1">
</cc2:ValidatorCalloutExtender> 
```

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-06-02T14:21:22.127

最好的选择是

将比较验证器添加到 Web 表单。设置它的 controlToValidate。将其 Type 属性设置为 Date。将其 operator 属性设置为 DataTypeCheck 例如：

```
<asp:CompareValidator
    id="dateValidator" runat="server" 
    Type="Date"
    Operator="DataTypeCheck"
    ControlToValidate="txtDatecompleted" 
    ErrorMessage="Please enter a valid date.">
</asp:CompareValidator> 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-06-02T14:43:04.080

CustomValidator 也可以在这里工作：

```
<asp:CustomValidator runat="server"
    ID="valDateRange" 
    ControlToValidate="txtDatecompleted"
    onservervalidate="valDateRange_ServerValidate" 
    ErrorMessage="enter valid date" /> 
```

代码隐藏：

```
protected void valDateRange_ServerValidate(object source, ServerValidateEventArgs args)
{
    DateTime minDate = DateTime.Parse("1000/12/28");
    DateTime maxDate = DateTime.Parse("9999/12/28");
    DateTime dt;

    args.IsValid = (DateTime.TryParse(args.Value, out dt) 
                    && dt <= maxDate 
                    && dt >= minDate);
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-01-31T18:23:07.113

我认为以下是最简单的方法。

```
<asp:TextBox ID="DateControl" runat="server" Visible="False"></asp:TextBox>
<asp:RangeValidator ID ="rvDate" runat ="server" ControlToValidate="DateControl" ErrorMessage="Invalid Date" Type="Date" MinimumValue="01/01/1900" MaximumValue="01/01/2100" Display="Dynamic"></asp:RangeValidator> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T14:27:49.367

我认为必须在应用程序的当前文化中指定日期。您可能想尝试将[CultureInvariantValues](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basecomparevalidator.cultureinvariantvalues.aspx)设置为 true 并查看是否可以解决您的问题。否则，您可能需要更改当前文化（或[文化](http://msdn.microsoft.com/en-us/library/bz9tc508.aspx)本身）的[DateTimeFormat以获得所需的内容。](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.datetimeformat.aspx)

# sharepoint - 在 sharepoint 中以其他用户身份登录

> ID：939814
> 
> 赞同：1
> 
> 时间：2009-06-02T14:11:19.057
> 
> 标签：sharepoint, active-directory, login

我是 SharePoint (3.0) 中的网站集管理员/（物理服务器管理员），我正在调试其他用户访问我们自己的某些功能的权限。是否可以在不知道密码的情况下以其他用户身份（以其权限）登录？我可以创建自己的“虚拟”用户，分配给相同的组，但是如果用户在 100 多个组中，我今晚不想做。谢谢。

--是的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:22:55.913

我不知道你是否只能从 UI 模拟，但你可以务实地做到这一点。

我不是 100% 确定，但我认为您可以创建 ASP.NET 页面来处理模拟，从而让您以您想要的用户身份登录。如果您正在寻找特定的东西，您当然可以运行代码来确定您可以访问的内容。

这是一篇关于如何运行模拟代码的帖子：

[http://blackninjasoftware.com/2009/04/09/how-to-programmatically-impersonate-users-in-sharepoint/](http://blackninjasoftware.com/2009/04/09/how-to-programmatically-impersonate-users-in-sharepoint/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T18:04:43.130

我想出了另一种方式（[我的 serverfault 帖子](https://serverfault.com/questions/17782/logging-in-as-another-user-in-sharepoint/17979#17979)）：

所以。解决方案如下：（不干净，但工作）

1）编写自己的IHttpModule，包含：

```
class LoginModule {
 public void Init(HttpApplication context)
 {
    context.PreRequestHandlerExecute += new EventHandler(UglyHack);
 }

 void UglyHack(object sender, EventArgs e)
 {
     HttpCookie wannabe = (HttpContext.Current.Request.Cookies["_sp_admin_wanna_be_user"]);
     if (wannabe != null && SPContext.Current.Web.CurrentUser.IsSiteAdmin)
     {
         SPWeb cw = SPContext.Current.Web;
         typeof(SPWeb).GetField("m_CurrentUser", BindingFlags.NonPublic | BindingFlags.Instance).SetValue(
                        SPContext.Current.Web,
                        cw.AllUsers[wannabe.Value]);
     }
 }
} 
```

2) 签名

3) 广汽它

4) 到 web.config()。

瞧！你就是那个男人。:) （当然，我添加了将 cookie 设置添加到菜单、安全性等的逻辑。）

# powershell - PowerShell 元编程 - 生成高级函数

> ID：939817
> 
> 赞同：5
> 
> 时间：2009-06-02T14:12:20.040
> 
> 标签：powershell, metaprogramming, powershell-2.0

我正在研究动态构建一堆高级功能。为此，我一直在使用[New-PSScript](http://blogs.msdn.com/powershell/archive/2009/01/02/a-module-to-create-modules-and-advanced-functions.aspx)，但它并不能提供我正在寻找的所有灵活性。

我正在阅读有关函数高级参数的手册页，并在帮助文章的末尾看到了有关动态参数的内容，该文章提供了以下示例代码

```
function Sample {
      Param ([String]$Name, [String]$Path)

      DynamicParam
      {
        if ($path -match "*HKLM*:")
        {
          $dynParam1 = new-object 
            System.Management.Automation.RuntimeDefinedParameter("dp1",
            [Int32], $attributeCollection)

          $attributes = new-object System.Management.Automation.ParameterAttribute
          $attributes.ParameterSetName = 'pset1'
          $attributes.Mandatory = $false

          $attributeCollection = new-object 
            -Type System.Collections.ObjectModel.Collection``1[System.Attribute]
          $attributeCollection.Add($attributes)

          $paramDictionary = new-object 
            System.Management.Automation.RuntimeDefinedParameterDictionary
          $paramDictionary.Add("dp1", $dynParam1)

          return $paramDictionary
        } End if
      }
    } 
```

我想知道是否可以使用 RuntimeDefinedParameter 和属性集合来生成新函数。

一些半伪代码可能看起来像这样。我（认为）我正在尝试构建的两个关键功能是 New-Parameter 和 Add-Parameter。

```
$attributes1 = @{Mandatory=$true;Position=0;ValueFromPipeline=$true}
$param1 = New-Paramater -name foo -attributes $attributes1

$attributes2 = @{Mandatory=$true;Position=1}
$param2 = New-Paramater -name bar -attributes $attributes2

cd function:
$function = new-item -name Get-FooBar -value {"there is a $foo in the $bar"}
Add-Parameter -function $function -paramater $param1,$param2 
```

我是在完全吠叫错误的树吗？如果有其他方法可以做到这一点，我对可能性持开放态度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-21T19:53:07.673

为了动态创建函数，我创建了定义函数的字符串并调用 Invoke-Expression 对其进行编译并将其添加到函数提供程序中。在我看来，这比在对象模型上工作更强大。

$f1 = @" function New-Motor() { "这是我的新电机" } "@

调用表达式 $f1

# java - Eclipse中的Java_swt

> ID：939820
> 
> 赞同：1
> 
> 时间：2009-06-02T14:13:18.303
> 
> 标签：java, eclipse, swt

有人能告诉我在哪里可以找到可执行的“java_swt”吗？

我看到多个站点说它嵌入在 eclipse 中，而其他站点则说它附带 Mac swt drop。我有一个名为“swt-3.5M6-carbon-macosx.zip”的 mac 的 zip 文件，并且我在我的测试 mac 机器和 windows 机器上安装了 eclipse IDE。但是我找不到这个可执行文件，我需要在 mac os x 上顺利运行 swt 应用程序。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T17:05:14.853

我没有寻找这个 java_swt，而是将应用程序包启动的 bash 可执行文件更改为直接引用我的 Jar 文件。swt jar 与我的应用程序 jar 以及 dll 文件夹下的 jni 库捆绑在一起。文件夹结构为：

```
|目录
    信息列表
    包信息
    |MacOS
        bashExec
    |资源
        myApp.icns
        |爪哇
            |dll
                libswt-carbon-xxxx.jnilib
                libswt-pi-carbon-xxxx.jnilib
            我的应用程序.jar
            swt.jar

```

bash shell 非常基础，通过“-XstartOnFirstThread”调用解决了 swt 和 mac 之间的线程问题。这是 bash shell（井号不显示在第一行的“！”之前）：

```
#!/bin/sh

BASEDIR='dirname "$0"'

exec java \
-XstartOnFirstThread \
-Dorg.eclipse.swt.internal.carbon.smallFonts \
-Dorg.eclipse.swt.internal.carbon.noFocusRing \
-jar "$BASEDIR/../Resources/Java/myApp.jar" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T16:13:41.003

SWT 作为工具包存在。我是否可以建议您获得 Eclipse 的 RCP 版本 - 可能会让您的生活更轻松一些

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T15:23:12.313

我不知道这个“java_swt”是什么，我认为 Eclipse 目前还没有发布这样的东西。[SWT 常见问题解答](http://www.eclipse.org/swt/faq.php)可能会有所帮助。

如果你只是运行普通的 java + swt，你可能仍然可以使用 eclipse 可执行文件。您将需要一个包含指定**Main-Class**标头的清单的 jar。同样，除了普通的静态 main 方法之外，您还需要一个非静态的 run 方法（这是可执行文件实际调用的方法）：

```
int run(String [] args); 
```

由于您没有正常的 Eclipse 布局，您将需要 Eclipse 启动器共享库（通常在 plugins/org.eclipse.equinox.launcher.<ws>.<os>.<arch>/eclipse_1206.so 中）。

此外，由于您的 jar 不包含用于处理启动屏幕的 Equinox 类，您可能应该明确将其关闭。

命令行将类似于：

```
eclipse -nosplash --launcher.library eclipse_1206.so -startup my_program.jar 
```

您可以将这些命令行参数放入可执行文件旁边的 eclipse.ini 中，每个参数位于单独的行中。如果重命名可执行文件，请重命名 .ini 以匹配。

# wpf - WPF ListBox，只有 ItemTemplate 的按钮

> ID：939821
> 
> 赞同：1
> 
> 时间：2009-06-02T14:13:21.143
> 
> 标签：wpf, xaml, button, listbox

我正在将项目列表绑定到 ListBox，我需要一些有关 XAML 的帮助才能为每个项目显示一个按钮。我可以很好地显示一个按钮，但是该按钮会占用内容文本的长度。我希望我的按钮消耗 100% 的 ListBox 宽度。我还需要停止 ListBox 的行突出显示，因为按钮应该自己执行此操作。

我使用的是按钮而不是绘制矩形，因为我想使用命令在按钮上进行单击事件。

```
<ListBox x:Name="MenuListBox" 
         ItemsSource="{Binding Path=MenuItemList}" 
         ScrollViewer.VerticalScrollBarVisibility="Visible">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid VerticalAlignment="Top" HorizontalAlignment="Stretch" Margin="1">
                <Button Content="{Binding Path=Name}" 
                        Height="30" 
                        FontSize="12" 
                        FontWeight="Bold"
                        HorizontalAlignment="Stretch"
                        Command="{Binding Path=DataContext.GetChildrenCommand, Source={StaticResource spy}}" 
                        CommandParameter="{Binding}"/>
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T14:17:47.110

从网格中删除 VerticalAlignment 和 Horizo​​ntalAlignment 属性，也许 ListBox 不是您需要的控件。尝试使用 ItemsControl，这样您就不会拥有 Listbox 的选择内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T14:17:06.813

刚刚解决， ListBox 定义要求：

```
**HorizontalContentAlignment="Stretch"** 
```

# php - Jquery -> php -> mysql 和动态表单字段

> ID：939828
> 
> 赞同：1
> 
> 时间：2009-06-02T14:15:48.143
> 
> 标签：php, jquery, mysql, forms, dynamic

我有一个多页表单，它使用 mysql 中的多个表来输入值。其中一个页面有一个表单，如果用户想要包含额外信息，该表单需要允许用户单击 + 以添加额外的行。可以添加任意数量的行。

当用户单击 + 时，jquery 和 php 将当前用户 ID 插入到数据库表中的一行中，然后在输入更多信息时更新。

我遇到的问题是如何为该特定 id 插入任意数量的行 - 当输入数据时，模糊事件将数据发送到 php 代码以更新数据库。但是，我遇到的问题是它将更新具有该特定用户 ID 的所有行，而不是当前行。

获取在新行中输入的数据并更新数据库的最佳方法是什么 - 我假设我将不得不使用 ID 值而不是 userid 值，因为这将是唯一的，或者还有其他方法吗？

感谢您提供的任何建议，这个问题目前让我感到困惑......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:27:25.577

当您声明您应该使用您正在更新的表的主键，而不是在您的表上多次出现的外键（在您的情况下为 UserId）时，您是正确的。这保证您将更新您期望的行。

另一种方法是缩小您更新的行的范围——例如，仅更新最近的/具有最高 ID 的行，或者使用使记录唯一的字段组合。但是，使用主键是解决问题的最佳方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T14:28:04.577

是的，您需要插入的行的 ID 值，而不仅仅是用户 ID。我想您想要做的是`LAST_INSERT_ID()`从您的 Ajax 脚本中传回 mysql，该脚本在您单击时执行插入`+`，并将该 ID 推送到您稍后用于更新行的信息中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:29:33.123

好吧，我认为您需要使用一对标识符，即您的用户 ID 和字段 ID。仅编辑字段id 就足够了，但是当您需要列出所有用户字段时，将需要另一个参考。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T14:30:44.697

是的，你最好的办法是让 mysql 为创建的每一行返回一个唯一的 id，然后确保每当你在表单上编辑一行时，将 id 连同它一起发送。现在您可以一次编辑一行。

# sql - SQL Server 进程队列竞争条件

> ID：939831
> 
> 赞同：44
> 
> 时间：2009-06-02T14:16:21.433
> 
> 标签：sql, sql-server, tsql, queue, race-condition

我有一个订单队列，多个订单处理器通过存储过程访问该队列。每个处理器传入一个唯一 ID，用于锁定接下来的 20 个订单以供自己使用。然后存储过程将这些记录返回给订单处理器以进行操作。

在某些情况下，**多个处理器能够检索相同的“OrderTable”记录**，此时它们会尝试同时对其进行操作。这最终会导致在流程后期抛出错误。

我的下一步行动是让每个处理器获取所有可用订单并循环处理处理器，但我希望简单地使这部分代码线程安全并允许处理器随时获取记录。

如此明确-知道为什么我会遇到这种竞争状况以及如何解决问题。

```
BEGIN TRAN
    UPDATE  OrderTable WITH ( ROWLOCK )
    SET     ProcessorID = @PROCID
    WHERE   OrderID IN ( SELECT TOP ( 20 )
                                        OrderID
                                FROM    OrderTable WITH ( ROWLOCK )
                                WHERE   ProcessorID = 0)
COMMIT TRAN

SELECT  OrderID, ProcessorID, etc...
FROM    OrderTable
WHERE   ProcessorID = @PROCID 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-06-02T14:51:22.517

编辑：

我用谷歌搜索了我的答案：[“使用 READPAST 和 UPDLOCK 处理 SQL Server 中的数据队列”](http://www.mssqltips.com/tip.asp?tip=1257)。自从我阅读并使用此解决方案以来已经有好几年了。

原来的：

如果您使用 READPAST 提示，则会跳过锁定的行。您已经使用了 ROWLOCK，因此您应该避免锁升级。正如我发现的那样，您还需要 UPDLOCK。

所以进程 1 锁定 20 行，进程 2 将占用接下来的 20 行，进程 3 将占用第 41 到 60 行，依此类推

更新也可以这样写：

```
UPDATE TOP (20)
    foo
SET
    ProcessorID = @PROCID
FROM
    OrderTable foo WITH (ROWLOCK, READPAST, UPDLOCK)
WHERE
    ProcessorID = 0 
```

刷新，2011 年 10 月

如果您需要一次执行 SELECT 和 UPDATE，则可以使用 OUTPUT 子句更优雅地完成此操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-02T15:21:45.280

您可以使用服务代理。您还可以使用 sp_getapplock 序列化对行的访问 - 这将消除竞争条件：

“通过创建自己的锁（SQL 中的互斥锁）来辅助并发” [http://sqlblogcasts.com/blogs/tonyrogerson/archive/2006/06/30/855.aspx](http://sqlblogcasts.com/blogs/tonyrogerson/archive/2006/06/30/855.aspx)

# ruby-on-rails - Rails 的 Ajax 支持是否使 JSON 或 XML 成为一种更易于使用的格式？

> ID：939834
> 
> 赞同：1
> 
> 时间：2009-06-02T14:17:26.783
> 
> 标签：ruby-on-rails, xml, ajax, json

作为 Ajax 的新手，我想了解在 Rails 中使用 Ajax 时哪种数据交换格式（JSON 或 XML）更容易使用。

各种 Rails 助手是否使一种或另一种格式更容易处理，还是取决于上下文或根本不重要？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T14:34:10.087

在撰写本文时，Rails 使用[Prototype](http://www.prototypejs.org/)作为其默认的 JavaScript 框架。Prototype 与 JSON 或 XML 无关，因为它的[Ajax.Request](http://www.prototypejs.org/api/ajax/request)对象会自动评估任一响应格式。

此外，Rails 中的控制器使用该[`respond_to`](http://api.rubyonrails.org/classes/ActionController/MimeResponds/InstanceMethods.html#M000368)方法同样可以处理 JSON 或 XML，并且 ActiveRecord 模型自动包含`to_json`和`to_xml`方法。

所以这真的归结为个人喜好，我会说。它们都同样易于使用。

# web-services - 使用令牌的基于服务的身份验证

> ID：939836
> 
> 赞同：13
> 
> 时间：2009-06-02T14:18:20.323
> 
> 标签：web-services, authentication, rest

我很难找到清晰简洁的示例来说明如何使用令牌实现基于服务的身份验证方案。据我所知，基本步骤如下：

1.  客户端向用户请求用户名/密码
2.  客户端将用户名/密码传递给身份提供者
3.  提供商检查用户名/密码并在用户有效时发回令牌
4.  客户对令牌做些什么？

第三和第四步是我卡住的地方。我假设在这种情况下，“令牌”必须是客户端可以解密的加密字符串或存储在某处（即数据库）的随机字符串，然后客户端可以验证，但我不太确定那么客户端应该用令牌做什么，或者为什么你甚至需要一个令牌——一个简单的用户 ID 还不够吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-02T15:14:00.320

> 我假设在这种情况下，“令牌”必须是客户端可以解密的加密字符串或存储在某处（即数据库）的随机字符串，然后客户端可以验证，但我不太确定那么客户端应该用令牌做什么，或者为什么你甚至需要一个令牌——一个简单的用户 ID 还不够吗？

不 - 令牌是“乘车票”。就像地铁代币一样。客户端在请求服务时将其呈现给网守。在这种情况下，提供者自己进行身份验证，因此客户端将令牌返回给提供者。在某些情况下，提供者可能会委托身份验证——例如在[STS 模型](http://msdn.microsoft.com/en-us/library/aa480563.aspx)中，在这种情况下，提供者可能会将令牌交给第三方进行身份验证甚至授权。

从服务的角度来看，这个令牌必须：

*   有一个“保质期”。否则，令牌将可以无限重复使用。因此，在服务器端，您可以将令牌存储在基于会话的存储中，在那里您将免费获得超时。或者您可以构建一个简单的带有过期的哈希表。
*   仅与持有人相关联。在许多情况下，提供者在此处使用近似值并断言只能从原始请求 IP 地址使用令牌。

所以在第 3 步中，提供者需要检查用户名和密码。如果验证通过，则创建一个标记（哈希），它引用字典或哈希表中的条目。Hashtable 中的对象是包含用户名、IP 地址、可能是原始发布时间、可能与用户名关联的角色以及您要存储的任何其他内容的结构。服务提供者将此令牌（哈希，而不是结构）发送回客户端，通常作为 Set-Cookie。当客户端在后续请求中发回令牌（作为 Cookie）时，提供者会检查字典以查看令牌是否可用、是否超时、是否匹配请求的 IP 地址、是否已获得请求资源的授权等。如果一切正常，尊重请求。

* * *

编辑 2013 年 6 月

现在已经好几年了，这个答案仍在获得投票。我建议人们研究 OAuth 2.0 框架和 Bearer 令牌。

基本上他们只做这里描述的事情。

如果您想要一个好的示例实现，可以查看[Apigee 的 Usergrid。](http://apigee.com/usergrid)它是这样工作的：

1.  用户认证

    `POST https://api.usergrid.com/token -d '{"username":"Joe","password":"Sec4et!","grant_type" : "password"}'`

2.  用户收到一个 access_token 作为响应

3.  `Authorization: Bearer XXXXXXXXXX`用户使用不记名令牌替换 XXXXX 的标头进行后续调用。此令牌具有由 usergrid 服务器设置的生存时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T14:24:37.330

典型的令牌是存储在服务器端的随机散列。客户端将其与请求一起传回。这样做的好处是您不必一直传递密码，这显然是一件好事，并且令牌可以随时失效而无需更改密码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:35:20.850

当我研究同样的问题时，我发现这个 Amazon S3 的文档很有用。

[验证 REST 请求](http://docs.amazonwebservices.com/AmazonS3/latest/)

一般原则是您不想为每个连续的服务调用传递您的用户名和密码，因为这不会那么安全。

您提到只是将用户名传递回服务，但这又不是很安全。

您可能正在考虑使用会话状态来存储用户已通过身份验证的事实，但这违反了 REST 的一般原则之一，即一切都应该是无状态的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T14:21:59.707

这看起来很像[Kerberos](http://en.wikipedia.org/wiki/Kerberos_(protocol))的工作方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-18T09:27:58.977

带有会话的 Web 服务......嗯，这不是它应该的样子。Web 服务并不意味着保持状态。
我在网上四处查看，大多数示例和文章都在谈论 SSL/TLS + 用户名/密码。用“API密钥”基础设施替换用户名/密码会很好，但我不知道如何“设计”这样的东西......

# comparison - PhysX 通过 GPU 获得巨大性能？

> ID：939838
> 
> 赞同：2
> 
> 时间：2009-06-02T14:18:47.717
> 
> 标签：comparison, physics, nvidia, physx

我最近比较了一些用于模拟和游戏开发的物理引擎。有些是免费的，有些是开源的，有些是商业的（1 甚至是非常商业的 $$$$）。Havok、Ode、Newton（又名 oxNewton）、Bullet、PhysX 和一些 3D 引擎中的“原始”内置物理。

在某个阶段，我得出了结论或问题：如果我可以利用 GPU 处理带来的惊人性能（如果我需要），我为什么要使用除 NVidia PhysX 之外的任何东西？使用未来的 NVidia 卡，我可以期待独立于常规 CPU 生成步骤的进一步改进。SDK 是免费的，它也可用于 Linux。当然，这有点锁定供应商，而且它不是开源的。

你的观点或经验是什么？如果您现在就开始开发，您是否同意上述观点？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-11T23:00:00.987

免责声明：我从未使用过 PhysX，我的专业经验仅限于 Bullet、Newton 和 ODE。在这三个中，ODE 是我的最爱。它在数值上是最稳定的，另外两个有成熟度问题（有用的关节没有实现，合法的关节/运动组合以未定义的方式表现，&c）。

您在问题中提到了供应商锁定问题，但值得重复一遍：如果您使用 PhysX 作为唯一的物理解决方案，使用 AMD 卡的人将无法运行您的游戏（是的，我知道它[可以工作](http://www.tgdaily.com/content/view/38137/135/)，但它不是官方的，也不是 NVIDIA 支持的）。解决此问题的一种方法是定义故障转移引擎，在带有 AMD 卡的系统上使用 ODE 或其他东西。这行得通，但它会使您的工作量增加一倍。认为您将能够将两个引擎之间的差异隐藏在一个通用界面后面并编写大量游戏物理代码是很诱人的，但是您在游戏物理方面的大部分困难将在于处理您特定的特质物理引擎，决定接触摩擦和恢复等事物的值。这些值在物理引擎中没有一致的含义，并且（大部分）不能正式推导出来，所以你只能通过实验来寻找好看的、可玩的值。使用 PhysX 加上故障转移，您将完成所有这些简单的工作两次。

在更高的层次上，我认为任何流处理 API 都还没有完全成熟，我不愿意承诺一个，至少，我们知道客户的反应英特尔的 Larrabee 是如何塑造人们的设计。

到目前为止，我没有将 PhysX 视为高端游戏开发的明显选择，我认为应该避免使用它，除非您认为拥有 AMD 卡的人在您的玩家群中占很大比例（极不可能）或者您有足够的编码和 QA 人力来测试两个物理引擎（更合理，但如果你的公司那么富有，我听说过关于 Havok 的好消息）。或者，我想，如果你设计的物理游戏对性能的要求如此之高，以至于只有流式物理才能满足你——但在这种情况下，我建议你组建一个乐队，让摩尔定律在一年内完成它或两个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-11T00:18:47.330

2013 年初的更新答案：我为我认为的三大操作系统开发：Linux、OS X、MS。我还使用三大物理库进行开发：PhysX、Havok、Bullet。

关于 PhysX，我最近做了一些测试，在撰写本文时最新版本是 3.2.2。在我看来，nVidia 确实降低了库的有效性。最大的问题是刚体缺乏加速度。lib 只加速粒子和布料。即使是那些不与一般刚体接口。我对 nVidia 这样做完全感到困惑，因为他们有巨大的营销推动力来推动 GPU 加速应用程序，专注于科学计算，其中很大的推动力是物理模拟。

因此，虽然我对物理模拟之王的期望是 PhysX、Havok 和 Bullet，但实际上却相反。Bullet 发布了带有 OpenCL 支持样本的 lib 2.8.1。Bullet 是一个相对较小的库，具有大量许可。他们的目标是让第 3 版完全集成 OpenCL 刚体加速。

部分评论讨论了多个代码路径。我的意见是这没什么大不了的。我已经支持三个操作系统，只支持最少的硬代码（大部分是线程，不使用操作系统特定的代码；使用 C++ 和标准库模板）。物理库也是如此。我使用共享库并抽象出一个通用接口。这很好，因为物理变化不大；）您仍然需要设置模拟环境，管理对象，在环境中渲染迭代，完成后进行清理。其余的都是flash，在闲暇时实施。

随着主流库中 OpenCL 的出现（nVidia Cuda 非常接近 - 请参阅 Bullet OpenCL 演示），物理插件的工作将缩小。

那么，从头开始，只关心物理建模？Bullet 不会出错。小而灵活的许可证（免费），非常接近生产就绪的 OpenCL，它将跨平台跨越三大操作系统和 GPU 解决方案。

祝你好运 ！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-14T22:26:18.430

你可能会觉得这很有趣：

[http://www.xbitlabs.com/news/video/display/20091001171332_AMD_Nvidia_PhysX_Will_Be_Irrelevant.html](http://www.xbitlabs.com/news/video/display/20091001171332_AMD_Nvidia_PhysX_Will_Be_Irrelevant.html)

这是有偏见的……它基本上是对 AMD 的采访……但它提出了一些我认为在你的情况下值得考虑的观点。

由于 David Seiler 指出的问题，在未来某个时间切换物理引擎可能是一个巨大/无法克服的问题……特别是如果游戏玩法与物理紧密相关。

因此，如果您现在真的想在引擎中使用硬件加速物理，请选择 Physx，但请注意，当 AMD 在本文中假设的解决方案可用时（它们绝对*会*，但它们还没有出现），您将面临不愉快的选择：

1）重写你的引擎以使用（插入新的跨平台硬件加速物理引擎的名称），可能会以一种不好的方式改变你的游戏动态

2) 继续只使用 Physx，完全忽略 AMD 用户

3) 尝试让 Physx 在 AMD GPU 上工作 (blech...)

除了大卫使用 CPU 物理引擎作为后备的想法（做两倍的工作并产生 2 个行为不同的引擎）之外，您唯一的其他选择是使用纯 CPU 物理。

然而，随着 OpenCL 之类的东西成为主流，我们可能会看到 ODE/Bullet/kin 开始整合它…… IOW 如果您现在使用 ODE/Bullet/kin 对其进行编码，您可能（可能最终会）“免费”获得 GPU 加速稍后（不更改您的代码）。GPU 版本的行为仍然会略有不同（由于蝴蝶效应和浮点实现的差异，这是一个不可避免的问题），但至少你会让 ODE/Bullet/kin 社区与你合作以缩小差距.

这是我的建议：使用目前只使用 CPU 的开源物理库，并等待它通过 OpenCL、CUDA、ATI 的流语言等使用 GPU。当这种情况发生时，性能会非常快，你会免得自己头疼。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-27T12:32:47.490

我使用过*ODE*，现在使用*PhysX*。*PhysX使构建场景更容易并且（我个人认为）看起来更真实，但是，* *PhysX*没有足够的文档；实际上几乎没有任何文档。另一方面，*ODE*是开源的，有很多文档、教程等。 PS：使用 GPU 加速对我和我的同事有很大帮助；我们正在使用*APEX*破坏和*PhysX*粒子。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T15:04:45.753

未来 gfx 卡的假设性好处非常好，但未来也会从额外的 CPU 内核中获益。您能确定未来的 gfx 卡将始终为您的物理提供备用容量吗？

但可能最好的原因是，尽管在这种情况下有点模糊，但性能并不是一切。与任何 3rd 方库一样，您可能需要在未来几年内支持和升级该代码，并且您需要确保接口合理、文档良好，并且它具有您所需要的功能要求。

可能还有更多的数学问题，例如一些提供更稳定方程求解的 API 等，但我将对此发表评论给专家。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-21T16:46:25.667

PhysX 适用于非 nVidia 卡，只是无法加速。将其留在与其他引擎相同的位置。问题是如果你有一个物理模拟，它只适用于硬件物理加速。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-02T15:04:45.067

如果您的所有代码都可以大量并行化，那就去吧！

对于其他一切，GPU 都严重不足。

# windows - 在不使用 readfile() 的情况下检测 Windows 句柄上的空缓冲区

> ID：939840
> 
> 赞同：0
> 
> 时间：2009-06-02T14:18:55.890
> 
> 标签：windows, buffer, handle, detect

我想知道是否有任何类似于 IsBufferEmpty() 的函数可以在同步句柄上使用，而不是使用 ReadFile() 并等待它返回 false。我需要一些东西来消除 ReadFile() 尝试读取数据的延迟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:48:51.417

这是用于串口通信吗？

如果是这样，您可以使用以下[`ClearCommError()`](http://msdn.microsoft.com/en-us/library/aa363180(VS.85).aspx)功能：

```
DWORD com_errors = 0;
COMSTAT com_stat;

ClearCommError(serial_port_handle, &com_errors, &com_stat);
/* com_stat.cbInQue now holds the number of characters in the receive buffer */ 
```

# windows - Visual Studio shell（独立 shell）有什么用？

> ID：939841
> 
> 赞同：63
> 
> 时间：2009-06-02T14:19:04.643
> 
> 标签：windows, visual-studio, eclipse, shell

它是某种预先构建的 GUI 脚手架吗？
为什么我想要它而不是快速设置的 WinForms UI？
它给了我什么让我不得不花时间写作？
我是否像在 Visual Studio 2008 中那样获得浮动窗口和停靠？使用它有金钱成本吗？
部署是什么样的 - 我的应用程序是独立的 EXE，还是作为某种在 shell 中运行的一次性包或存档提供？
Eclipse RCP 是否具有很好的可比性，如果是，它们如何比较？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2014-09-05T21:58:05.523

我想提一下，SQL Server Management Studio 2012 在添加/删除程序中需要这两个条目：

1.  Microsoft Visual Studio 2010 Shell（隔离）-ENU
2.  Visual Studio 2010 先决条件 - 英语

我知道这一点是因为我卸载了它们，破坏了 SSMS，并且不得不从安装媒体进行修复，这两个项目重新出现。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-06-02T14:57:21.383

Visual Studio Shell 使开发人员能够通过在简化的 Visual Studio IDE 上构建来快速创建和分发他们自己的自定义工具。

Visual Studio 隔离的基于 shell 的应用程序可以完全访问 Visual Studio 服务并支持[自定义](http://msdn.microsoft.com/en-us/library/bb685692.aspx)和品牌。您可以通过多种方式自定义基于 shell 的应用程序，如下所示：

*   您可以使用加载项和 VSPackages 来扩展隔离的基于 shell 的应用程序，就像使用它们来扩展 Visual Studio 本身一样。
*   若要使 Visual Studio 功能和菜单命令组可用或不可用，请更新应用程序用户界面 (UI) 项目中的 .vsct 文件。
*   要从应用程序中删除选项页面或其他 Visual Studio shell 组件，请更新应用程序的 .pkgundef 文件。
*   要修改 shell 外观或行为的其他方面，请更新应用程序的 .pkgdef 文件。
*   启动应用程序时，还可以指定 shell 的某些方面。为此，请将调用中的参数更新为 appenvstub.dll 的 Start 入口点。

Visual Studio Shell 作为[Visual Studio SDK](http://www.microsoft.com/downloads/details.aspx?FamilyId=59EC6EC3-4273-48A3-BA25-DC925A45584D&displaylang=en)的一部分免费提供。Visual Studio Shell 对于构建和部署应用程序是免版税的。

您的独立 shell 应用程序可以安装在任何具有[Visual Studio 2008 Shell (isolated mode) Redistributable Package](http://www.microsoft.com/downloads/details.aspx?FamilyId=021B3BEE-B2AD-42A8-854A-C5EAEF69E927&displaylang=en)的计算机上。

要部署的每个隔离的基于 Shell 的应用程序都必须具有有效的 Shell 加载密钥 (SLK)。SLK 与应用程序唯一相关，不能用于加载任何其他应用程序。[您可以在Visual Studio 可扩展性开发人员中心](http://go.microsoft.com/fwlink/?LinkId=121964)网站上获取 SLK 。

获得外壳加载密钥 (SLK) 后，您必须将其添加到外壳项目中。按照[此过程](http://msdn.microsoft.com/en-us/library/cc138539.aspx)将 SLK 添加到使用 Visual Studio Shell 隔离模板创建的项目中。

注意：到目前为止所说的所有内容都是从各种 Microsoft 文档页面复制和粘贴的。一个很好的起点可能是[演练：一个基本的独立外壳应用程序](http://msdn.microsoft.com/en-us/library/bb685514.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-10T16:02:33.743

我在家中使用集成 shell 试用 IronPython，而无需安装完整的 VisualStudio 试用版。如果您习惯了它，这是一个不错的 IDE。

似乎集成外壳和隔离外壳之间存在很大差异。

集成外壳是一个没有安装任何编程语言的 IDE。如果您没有 VisualStudio，但想使用免费插件（例如 Python Tools for Visual Studio），则可以使用集成 shell。

Powerlord的回答中很好地描述了隔离外壳，它似乎是为编程软件开发人员制作的，因为它允许品牌和用户界面的修改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T14:25:13.787

似乎如果您使用独立的外壳，您可以以一种可以插入到 Visual Studio 的方式构建您的产品。然后，您可以将您的产品作为独立的 VS shell 分发），或作为 Visual Studio 的插件分发。（只是猜测）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-06T02:42:18.077

我意识到我迟到了，但在 Sybase 发布 PowerBuilder 12 和 12.5 版的那一天，它们包含了每个产品的 .NET 版本。它是在 Visual Studio 隔离外壳中运行的 PowerBuilder。老实说，如果你问我，他们在这方面做得非常出色。唯一的缺点是它最初专注于生成 WPF 目标、程序集等。但是您不能进行 WinForm 开发（在 PowerBuilder .NET 中）。您必须通过 PowerBuilder Classic 界面进行部署。

最近我开始接触一些 Python，我记得其中一个小组还使用隔离 shell 开发了 Python 部署。但我似乎找不到任何额外的东西。

诚然，我意识到 Python 现在可以在 Visual Studio 中编写，但只是试图挖掘历史。昨晚我在挖掘时注意到，隔离壳在 2015 年一直可用。

有人知道它是否已经停产了吗？

# datetime - Crystal Reports 的 DateTime.MinValue 是什么？

> ID：939847
> 
> 赞同：0
> 
> 时间：2009-06-02T14:20:43.953
> 
> 标签：datetime, crystal-reports, report

我想知道 Crystal Reports 日期时间数据类型的最小值。

我知道 .NET 和 SQLServer 的最低要求，但我在 Internet 上的任何地方都找不到 Crystal Reports 的最低要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T14:30:17.600

比其他人都大...类似于 1-01-01 到 9999-12-31

您将收到错误消息“日期必须介于 1 年和 9999 年之间”

你需要它做什么？如果我需要日期算术的基准日期，我通常只使用#1900-01-01#。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:29:14.313

它不依赖于底层数据源吗？

# events - PostSharp - 自动化事件订阅和集合添加

> ID：939850
> 
> 赞同：1
> 
> 时间：2009-06-02T14:21:02.097
> 
> 标签：events, postsharp

我想使用 PostSharp 解决的一个重复的例行任务是事件订阅和集合添加。我想为每个子对象的事件订阅父对象过程（子对象包含在列表中）。我还想将父级的所有列表添加到父级的主列表中。我应该使用什么方面或者我应该考虑哪个方向？

下面列出了上述问题的示例...

我有以下界面：

```
public interface ITraceable
{
    IList Children {get;set;}
    ChangeStatus Status {get;set;}
    bool IsTraceEnabled {get;set;}
    event EventHandler ChangeHandler
} 
```

具有以下状态类型：

```
public enum ChangeStatus
{
    New,
    Modified,
    Added,
    Deleted
} 
```

上面的结构和实现是：

```
public class Entity : ITraceable
{
    public event EventHandler {get;set;}
    public IList Children {get;set;}
    public ChangeStatus Status {get;set;}
    public bool IsTraceEnabled {get;set;}

    public string Name {get;set;}
    public string Address {get;set;}
    public string Title {get;set;}
    public List<ChildEntity1> ChildEntities {get;set;}
    public List<ChildEntity2> ChildEntities {get;set;}

    public void SubscribeableSub(object sender, EventArgs e)
    {
        Console.WriteLine("Test");
    }
}

public class ChildEntity1 : ITraceable
{
    public event EventHandler {get;set;}
    public IList Children {get;set;}
    public ChangeStatus Status {get;set;}
    public bool IsTraceEnabled {get;set;}

    public string Name1 {get;set;}
    public string Address1 {get;set;}
    public string Title1 {get;set;}
}

public class ChildEntity2 : ITraceable
{
    public event EventHandler {get;set;}
    public IList Children {get;set;}
    public ChangeStatus Status {get;set;}
    public bool IsTraceEnabled {get;set;}

    public string Name2 {get;set;}
    public string Address2 {get;set;}
    public string Title2 {get;set;}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T15:51:08.047

我会使用以下模式：

1.  使用自定义集合（例如从 Collection 继承）。覆盖 InsertItem 并从那里订阅子事件。集合的构造函数将父对象作为参数。所以这里不需要 PostSharp。

2.  您可以使用 PostSharp 自动实现一些事件，例如 PropertyChanged (INotifyPropertyChanged)。有关详细信息，请参阅示例 PostSharp.Samples.Binding。

# xml - 如何将子节点添加到特定位置的节点？

> ID：939853
> 
> 赞同：16
> 
> 时间：2009-06-02T14:21:30.020
> 
> 标签：xml, ruby, dom, nokogiri

我有一个节点，它有两个子节点：一个 HTML 文本和一个 HTML 元素。

```
<h1 id="Installation-blahblah">Installation on server<a href="#Installation-blah" class="wiki-anchor">&para;</a>
</h1> 
```

在这种情况下，HTML 文本是：

```
Installation on server 
```

和 HTML 元素：

```
 <a href="#Installation-blah" class="wiki-anchor">anchor;</a> 
```

然后我创建一个这样的节点：

```
span_node = Nokogiri::HTML::Node.new('span',doc)
span_node['class'] = 'edit-section'

link_node = Nokogiri::HTML::Node.new('a',doc)
link_node['href'] = "/wiki/#{page_id}/#{@page.title}/edit?section=#{section_index}"
link_node['class'] = 'icon icon-edit'
link_node.content = 'mylink'

span_node.add_child(link_node) 
```

现在，要将上述节点添加到主节点，我使用以下命令：

```
node.add_child(span_node) 
```

这会在末尾附加 span 节点。我怎样才能把它放在`span_node`所有孩子的面前？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-03T08:00:24.370

感谢 Pesto 提供几乎正确的解决方案。

工作解决方案是：

```
node.children.first.add_previous_sibling(span_node) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-02T15:18:33.073

你可以[`NodeSet#before`](http://nokogiri.rubyforge.org/nokogiri/Nokogiri/XML/NodeSet.html#M000248)这样使用：

```
node.children.before(span_node) 
```

`NodeSet#before`是一种将项目作为第一个元素插入的快捷方法。更通用的解决方案是使用[`Node#before`](http://nokogiri.rubyforge.org/nokogiri/Nokogiri/XML/Node.html#M000290)和[`Node#after`](http://nokogiri.rubyforge.org/nokogiri/Nokogiri/XML/Node.html#M000291)。例如，`some_node.before foo`将节点`foo`作为兄弟节点添加到`some_node`. `Node#after`类似。请注意：

```
node.children.first.before(span_node) 
```

因此等价于上面的解决方案。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-08-06T12:16:42.233

`node.prepend_child span_node`

[Nokogiri::XML::Node#prepend_child 文档](http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri%2FXML%2FNode%3Aprepend_child)

# c++ - 将变量声明为指令

> ID：939857
> 
> 赞同：4
> 
> 时间：2009-06-02T14:23:24.900
> 
> 标签：c++

用 c++ 等高级语言声明/分配变量是显式指令吗？

例如 x = 5;

它将由加载程序处理，并被视为状态信息，对吗？

它不是一条指令，而是一个状态对象，而不是像 for 循环之类的东西，它是一条指令，它可以通往 cpu ？

编辑：好的，澄清一点。我不是在谈论优化。假设没有。我说的是可执行文件格式的编译程序的最终结果。在编译器决定不使用 MOV 指令的情况下，数据 5 会存在于可执行文件的数据段中，还是其他地方？

5 是否有可能作为数据存在而不是指令，然后将该数据加载到内存中？或者，一般来说，x = 5 会在程序执行时产生一条 mov 指令。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T14:31:39.360

您是否在询问变量声明是否会以与添加或删除相同的方式转换为汇编指令？如果是这样，那么一般的答案是没有**直接**翻译成汇编。

可能存在便于声明变量的指令，例如更新堆栈指针以为变量腾出空间。但是没有 x86 汇编指令说在堆栈上声明这种类型的变量。

我的大部分经验是使用 x86 和 amd64 芯片，因此其他处理器上可能有指令，但我不知道它们（但如果它们确实存在，我会很想了解它们）。

变量赋值有点不同。x=5的**一般**情况将转换为某种类型的汇编指令（例如将值写入寄存器）。但是，对于 C++，很难具体说明，因为有许多优化和芯片特定设置可能导致特定行在机器代码中没有翻译。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-02T14:28:28.163

这取决于它是如何使用的。

通常，编译器会尝试使每一行的影响尽可能低。

如果只在一个地方使用它，你可以打赌它是硬编码在机器代码中的，而不是在堆栈上浪费空间。

如果它用于数学或算法运算，并且它的值可能会改变，则可能会在堆栈上分配变量空间。再说一次，如果它使用得足够频繁，编译器可能会将它留在寄存器中。

答案是：*视情况而定*。编译它并使用调试器的机器代码窗口查看结果。

一种可能的实际翻译：

```
MOV AX, 5 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:33:54.533

在汇编语言中，**通常**使用 mov 指令将 5 加载到代表 x 的寄存器、堆栈变量或堆变量中。

但是优化器可以决定只使用它作为一个常量值（如#define），或者如果它不使用它可以决定完全删除它并决定将它放在哪里（寄存器、堆栈变量、堆）

所以，我希望它能回答你的问题，但正如你所看到的，在 C++ 中分配一个变量抽象了很多东西，这非常好！

仅供参考：我研究了大量的编译器汇编输出。在这篇文章中，赋值操作优化为汇编 OR 操作，非常好： [哪个更具可读性（C++ = ）](https://stackoverflow.com/questions/931301/which-is-more-readable-c)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T14:39:26.550

这取决于编译器及其执行的优化。如果它执行死存储消除，那么它很可能会省略将汇编代码写入变量。考虑

```
for(.....) i+= n;
i = 1;
return i; 
```

可以很容易地优化到这个，因为`i`无论如何后面的作业都会覆盖到的着作

```
i = 1;
return 1; 
```

如果没有将 1 分配给 i 并且循环将运行`m`时间，编译器可以将其优化为

```
i += n * m;
return i; 
```

包括`i`完全优化增量（在前面的例子中也是）如果`i`是本地的并且不会改变任何全局状态。如果`i`具有 volatile 限定类型，则编译器需要忽略这些优化。它必须按照语言规范的描述执行每一步。但即便如此，不同的编译器可能会根据目标处理器的能力生成不同的汇编器/指令。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T14:42:31.507

通常，您无法知道编译器将如何将您的 C++ 指令转换为汇编指令。从 C++ 的角度来看，声明一个包含赋值的变量（如“int x = 5;”）是一条指令。如果您在调试器中单步执行您的程序，它将在该行停止。但是谁知道编译器会用它做什么。（就你所知，整个变量可能会被优化掉。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-02T14:43:45.717

在编译时、链接时、加载时和执行时到底做了多少，取决于各种各样的事情。甚至不能保证一个实现在内存中有任何可识别为 x 的东西。C++ 标准描述了一些内存布局和运行时约束，但这只是为了具体：它还定义了可观察的行为，并明确表示如果所有可观察的行为都匹配，则实现可以随心所欲（“as-if”规则） .

这意味着唯一合理的答案将基于实际执行的操作，答案是取决于具体情况。

为什么你想知道某些特定的代码行是否翻译成某些特定的机器代码？如果你说清楚了，也许我们可以回答一个对你真正有用的问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-02T18:17:14.933

您没有提到 x 是哪种类型。如果 x 不是 pod 类型并且它有一个接受 int 的构造函数，则

```
x = 5 
```

正如语法似乎暗示的那样，除了“在某处存储 5”之外，可能还有其他效果。

```
#include <iostream>

int i;

class X {
  int _y;
public:
  X(int y) : _y(y) {
    i ++;   // changes a global variable
    std::cout << "got " << y << std::endl;  // does IO
  };
}; 
```

现在

```
X x = 5; 
```

有着完全不同的含义。所以我想说，一般来说，在 c++ x = 5 中，它与任何其他语句一样，因为它可能会产生任何副作用（比如在我的示例中：更改全局状态或执行 IO）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T20:03:24.283

如果您的变量是原始类型（int、char 等）：

对于全局或静态变量，否。这只是 BSS 或 DATA 段中的一个条目（取决于它是否已初始化），不需要可执行代码。当然，除非必须在运行时评估初始化程序。

对于局部变量，如果它没有被初始化，通常第一个意味着汇编指令，其他的则不是。这是因为它们的空间分配通常是在堆栈指针上添加一个偏移量（实际上是减去 - 堆栈向后增长）。当你声明你的第一个 int 变量时，会生成一个“ADD SP, 4”；对于第二个，它只是更改为“ADD SP，8”。这条指令不会在你声明变量的地方，而是在函数开始处，因为局部变量的所有堆栈空间都必须在那里分配。

如果您在创建时初始化局部变量，那么您将有一条 MOV 指令将值加载到其在堆栈中的位置。相对于代码的其余部分，该指令将与声明位于同一位置。

这些局部变量的规则假设没有优化。一种常见的优化形式是使用 CPU 寄存器作为变量，在这种情况下不需要分配，但初始化会生成一条指令。此外，有时这些寄存器必须保留其值，因此您会在函数的开头看到一条 PUSH 指令，并在函数的结尾看到一条 POP 指令。

不涉及构造函数（或内联构造函数）的对象规则要复杂得多，但也适用类似的逻辑。当您有一个非内联构造函数时，当然您至少需要一条指令来调用它。

# c# - WPF 搜索框和数据绑定到树视图

> ID：939858
> 
> 赞同：0
> 
> 时间：2009-06-02T14:23:41.420
> 
> 标签：c#, wpf, data-binding

我正在尝试实现一个实时更新搜索栏，它会在搜索短语更改时更新 TreeView，但是我并没有设法让它以我想要的方式更新。

所有项目都存在于应用程序启动时的树视图中（目前它只包含一级子级）。当我在文本框中键入并调用 PropertyChanged 事件时，SearchPhrase 属性也会正确更新，但不会调用 Items get。我的猜测是它与表示模型的 Items 属性有关。我对吗？

这是我的 XAML：

```
<Border BorderBrush="Black">
        <TextBox VerticalAlignment="Top" x:Name="phrase" Text="{ Binding      Path=SearchPhrase, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged }" Height="24" />
    </Border>
    <TreeView  Height="200" Background="Gainsboro" Name="list" ItemsSource="{ Binding Path=Items, Mode=OneWay, UpdateSourceTrigger=PropertyChanged }" ItemTemplate="{StaticResource dataTemplate}" /> 
```

这是我的演示模型：

```
public class ProjectListPM : BasePM
{
    private List<AnalysisInfo> items;
    private String searchPhrase;

    /// <summary>
    /// Gets or sets the search phrase.
    /// </summary>
    public String SearchPhrase { 
        get
        {
            return this.searchPhrase;
        }
        set
        {
            if (value != null)
            {
                this.searchPhrase = value;
                FirePropertyChanged<ProjectListPM>(o => o.SearchPhrase);
            }
        }
    }

    /// <summary>
    /// The list of analysises to display in the list.
    /// </summary>
    public List<AnalysisInfo> Items { 
        get
        {
            return
                items.OrderByDescending(i => i.GetSearchRelevanceTo(SearchPhrase)).Where(
                    i => i.GetSearchRelevanceTo(SearchPhrase) > 0).ToList();
        }
        set
        {
            if (value != null)
            {
                this.items = value;
                FirePropertyChanged<ProjectListPM>(o => o.Items);
            }
        }
    }

    public ProjectListPM()
    {
        this.items = new List<AnalysisInfo>();
        this.SearchPhrase = String.Empty;
    }
}

public class BasePM : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    /// <summary>
    /// Called when a property is changed.       
    /// </summary>
    /// <typeparam name="T">Type</typeparam>
    /// <param name="exp">Function</param>
    protected void FirePropertyChanged<T>(Expression<Func<T, Object>> exp)
    {
        string propertyName;
        if (exp.Body is UnaryExpression)
            propertyName = ((MemberExpression)((UnaryExpression)exp.Body).Operand).Member.Name;
        else
            propertyName = ((MemberExpression)exp.Body).Member.Name;
        if (PropertyChanged != null)
        {
            //Switch to UI thread
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-15T21:12:57.950

看起来您想根据搜索短语过滤树视图的项目集合。

作为一个直接的解决方案，您可以在 SearchPhrase 设置器中添加一行：

```
set
{
    if (value != null)
    {
        this.searchPhrase = value;
        FirePropertyChanged<ProjectListPM>(o => o.SearchPhrase);
        FirePropertyChanged<ProjectListPM>(0 => o.Items);
    }
} 
```

这将在您设置 SearchPhrase 时通知 UI 刷新项目。

如果您想采用不同的方法，可以从 ItemsControl 扩展 BasePM，在构造函数中设置 ItemsSource 和 Items.Filter 属性，并在设置 SearchPhrase 时调用 Items.Refresh()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:06:19.697

您的 List 类是 WPF 可以使用的一类吗？我建议使用 System.Collections.ObjectModel.ObservableCollection，因为它已经实现了与 WPF 兼容的列表更改事件。

# c++ - 单线类定义？

> ID：939859
> 
> 赞同：7
> 
> 时间：2009-06-02T14:24:24.320
> 
> 标签：c++, class, definition

我正在更新一些代码，当我在标题中工作时，我遇到了以下行。

```
.
.
.
class HereIsMyClass;
.
.
. 
```

就是这样。它只是在另一个更长的类定义之前的一行。HereIsMyClass 实际上是其他地方的另一个类，但我不明白为什么要在这里写这行。它有什么作用？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-02T14:26:56.327

C++ 中的这一行是前向声明。它表明在未来的某个时候，可能会存在一个名为 HereIsMyClass 的类。它允许您在完全定义之前在声明中使用类。

它对分解循环依赖的类和头文件管理都有帮助。

例如

```
class HereIsMyClass;

class Foo { 
  void Bar(HereIsMyClass* p1) ...
};

class HereIsMyClass {
  void Function(Foo f1);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T14:28:36.590

它被称为“前向声明”。这告诉编译器“HereIsMyClass”是类的名称（相对于变量、函数或其他名称）。稍后必须定义该类才能使用它。

当您有需要相互引用的类时，这很有用。

[这是](http://www.eventhelix.com/RealtimeMantra/HeaderFileIncludePatterns.htm)一个描述。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T14:26:57.653

这就是所谓的*预先声明*。当 HereIsMyClass 的实际声明位于文件的更下方时，或者在文件更下方包含的另一个#include 中时，可能在此行之后有一个使用 HereIsMyClass 的类定义。

如果您没有该行，则该文件可能无法编译。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T14:56:40.837

这称为“前向声明”，本质上是对稍后定义此类的承诺。具有前向声明允许您声明指针，`HereIsMyClass`而不必包含它的头文件，但不包含它的实际对象，因为`HereIsMyClass`编译器仍然不知道对象的大小。

```
 class HereIsMyClass;

class Foo
{
private:
  HereIsMyClass *pointer; // works
  HereIsMYClass object;   // compiler error!
}; 
```

前向声明不会告诉编译器类的成员，所以你仍然需要在实际使用它时包含完整的类定义（头文件），即访问它的成员。

# asp.net-mvc - 这个 RenderAction 在做什么，怎么做？

> ID：939860
> 
> 赞同：1
> 
> 时间：2009-06-02T14:24:36.393
> 
> 标签：asp.net-mvc

我正在查看第三方开发的一些 ASP.NET MVC 代码，并在视图中遇到以下标记：

```
<div class="panel_body">   
    <% Html.RenderAction(((string[])Model)[0], "Customer"); %>
</div>
<!-- Some HTML omitted -->
<div class="wizard_body">
    <% Html.RenderAction(((string[])Model)[0], "Journey"); %>
</div> 
```

谁能告诉我为什么模型需要这样的转换和数组访问？

视图不是强类型的。

这两个`RenderAction`s 正在呈现在两个单独的 ASP.NET MVC 项目中定义的两个单独的视图。

## 编辑

此视图使用以下操作方法启动

```
public ActionResult Index()
{
    return View(new []{"Search"});
} 
```

从而`((string[])Model)[0]`将返回`"Search"`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T14:30:41.560

因为视图不是强类型的，`Model`是对象类型的。显然，他们实际上已经为 Model 变量分配了一个字符串数组，并且要呈现的动作的名称是数组的第一个元素。因此，他们将模型转换为字符串数组并提取第一个元素。

**编辑**：如果实际上是这种情况，那么您可以通过将视图强类型化为`string[]`. 他们可以简单地进行索引。代码本身让我对它的质量有点怀疑。我可能会将动作名称放入 ViewData 并按名称引用它，或者使用具有视图特定模型的强类型视图，以便我可以通过属性名称来引用动作。无论哪种方式都会比你所拥有的更清楚。我建议使用特定于视图的模型重构为强类型视图，除非这是以这种方式引用的唯一属性。

**编辑 2**：根据您的更新，我会将其更改为：

```
public ActionResult Index()
{
    return View();
} 
```

和

```
<div class="panel_body">   
    <% Html.RenderAction("Search", "Customer"); %>
</div>
<!-- Some HTML omitted -->
<div class="wizard_body">
    <% Html.RenderAction("Search", "Journey"); %>
</div> 
```

如果值是固定的，为什么还要将它作为模型的一部分传递呢？

# delphi - Rave Report 中的数字到单词

> ID：939864
> 
> 赞同：1
> 
> 时间：2009-06-02T14:25:30.747
> 
> 标签：delphi, numbers, rave-reports

我已经设法按照我想要的方式设计了一份报告，但我无法让 Rave Report 打印/将总计转换为 Words。

例如，如果总计是`1,200.00`它应该只打印`One Thousand and Two Hundred`.

在 Rave Report 中是否有可能发生这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T07:50:19.287

我认为 Rave Reports 没有任何将数字转换为作品的内置功能。但是，我在 About.com 上找到了一篇文章，解释了[如何将数字（货币）转换为单词。](http://delphi.about.com/od/objectpascalide/a/curr2words.htm)

查看**NumberToWords**单元中的**ConvertToWords**函数。

 **您可以在运行时转换数字并将单词传递给报告。

**编辑：**

您可以像这样将参数传递给您的报告。

```
 RvProject.Open;
  RvProject.SelectReport('ParametrizedReport',False);
  RvProject.SetParam('Name','Leonel');
  RvProject.Execute;
  RvProject.Close; 
```

查看[Rave Reports 简介](http://edn.embarcadero.com/article/30331/)文章。

# python - 打印与标准错误

> ID：939866
> 
> 赞同：28
> 
> 时间：2009-06-02T14:25:54.707
> 
> 标签：python, printing, stderr

两者有什么特定的优点或缺点吗`print`？`stderr`

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-06-02T14:31:45.210

`print`可以在任何类似文件的对象上打印，包括`sys.stderr`.

```
print >> sys.stderr, 'Text' 
```

使用`sys.stderr`for errors 而不是的优点`sys.stdout`是：

*   如果用户将标准输出重定向到文件，她仍然会在屏幕上看到错误。
*   它没有缓冲，因此如果`sys.stderr`重定向到日志文件，则程序在记录错误之前崩溃的可能性较小。

* * *

这个答案是用 Python 2 编写的。对于 Python 3，请`print('Text', file=sys.stderr)`改用。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-06-02T14:29:35.510

它们只是两种不同的东西。`print`一般去`sys.stdout`。值得了解[, 和- 之间的区别](http://en.wikipedia.org/wiki/Standard_streams)[`stdin`，`stdout``stderr`](http://en.wikipedia.org/wiki/Standard_streams)它们都有其用途。

特别是，`stdout`应该用于正常的程序输出，而`stderr`应该只保留用于错误消息（异常程序执行）。有用于拆分这些流的实用程序，它允许您的代码用户区分正常输出和错误。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2010-03-09T17:33:44.310

注意：这里有一些微妙之处，包括流是否会进入交互式设备。最大的惊喜是在 Python 3 中 stderr 是行缓冲的（至少在 Unix 中）。例如，在终端窗口中，以下在 Python 2 中每两秒打印一个数字：

```
for n in range(5):
    print >> sys.stderr, n,     # final comma to squelch newline character
    time.sleep(2) 
```

而在 Python 3 中，当循环结束时，以下代码会一起打印数字：

```
for n in range(5):
    print(n, file=sys.stderr, end='')    # print n to sys.stderr with no newline char
    time.sleep(2) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-16T16:16:23.353

在运行脚本时通过将它们重定向到不同的文件来分隔 stderr 和 stdout 很有用。我通常使用 stderr 来记录日志消息并跟踪程序的流程，但使用 stdout 来获取更多有用的消息，我将在以后使用它们。

另一种写入 stderr 的方法如下例所示：

```
import sys
sys.stderr.write("Error has occurred opening a file!") 
```

# java - 是否有具有 3D 样条函数的 Java 库？

> ID：939874
> 
> 赞同：2
> 
> 时间：2009-06-02T14:27:45.437
> 
> 标签：java, math, 3d

特别是，我需要一种方法来表示通过一组已知 3D 点的曲线/样条曲线，以及通过细分/插值找到曲线/样条曲线上其他点的方法。

例如，如果我有一组点 P0 到 PN，我想在通过 P0 和 P1 的样条曲线上找到 P0 和 P1 之间的 100 个点。

我看到 Java3D 的 KBRotPosScaleSplinePathInterpolator 执行了这样的计算，但它与该 API 的场景图模型相关联，我看不到如何返回我需要的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T16:11:24.153

您正在寻找类似[Catmull Rom spline](https://stackoverflow.com/questions/107598/point-sequence-interpolation/134203#134203)的东西。现实情况是，数学并不是[那么难处理](http://www.mvps.org/directx/articles/catmull/)（一些向量矩阵乘法）。我的建议是您只需在代码中实现您真正需要的样条。

[引用那篇文章](http://www.mvps.org/directx/articles/catmull/)：

> 定义样条曲线的点称为“控制点”。Catmull-Rom 样条的特点之一是指定的曲线将通过所有控制点 - 这并非适用于所有类型的样条。
> 
> ![通过所有控制点的 Catmull-Rom 样条曲线图。](https://www.mvps.org/directx/articles/shadeland.old/images/spline1.gif)
> 
> 要计算曲线上的一个点，需要在所需点的任一侧有两个点，如左图所示。该点由一个值 t 指定，该值表示两个最近控制点之间的距离部分。

但是，您应该知道，如果 Catmull-Rom 样条曲线在需要急转弯时靠得太近，可能会在控制点处导致小循环。

查看上图，想象 p1 和 p3 彼此相邻，在 p2 下方（基本上是压缩图片的右侧）。Catmull-Rom 样条很可能从 p0 下降，像现在一样通过 p1，从 p2 的右侧上升并从右到左穿过它，从左侧下降并从左到右穿过p3。

这是样条构造的结果。

*这有点像使用相当坚硬的柔性管道（就像我在水槽下面一样）。为了让一个较长的部分连接到靠近在一起的点，我必须添加一个循环。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-31T16:47:18.523

对于任何在曲线背后苦苦挣扎的人，您可能会发现[这](http://bimixual.org/AnimationLibrary/beziertangents.html)很有用，尤其是下面的图片。这个想法很简单：

让**t**从 0.0 循环到 1.0。

**对于灰色**集中的每一对点，计算它们之间距离的一小部分（使用 t）。这些点以**绿色**显示。

**对于绿色**集中的每一对点，计算它们之间距离的一小部分（使用 t）。该点以**黑色**显示。

对于不同的**t**值，黑点将是沿曲线的不同线。

第二张图显示了用一个额外的点和一个额外的插值级别重复的相同过程。

我发现这比我发现的任何其他选项更容易理解、实现和扩展到 3 维。

[使用线性插值](http://bimixual.org/AnimationLibrary/Bezier_2_big.gif) [逼近曲线 http://bimixual.org/AnimationLibrary/Bezier_2_big.gif 使用线性插值逼近曲线 http://bimixual.org/AnimationLibrary/Bezier_3_big.gif](http://bimixual.org/AnimationLibrary/Bezier_3_big.gif)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-12T16:28:29.483

我对线性插值有很好的理解，但我发现很难掌握样条数学的复杂性。这就是为什么我一直在寻找某种可以提供抽象来隐藏困难数学的库。事实证明，以下功能足以满足我的需求。这是基于[http://www.mvps.org/directx/articles/catmull/](http://www.mvps.org/directx/articles/catmull/)上的一个等式，但幸运的是您不需要了解它是如何工作的。请记住，与只需要两个点开始的线性插值不同，Catmull-Rom 样条插值在两端使用一个额外的点。所以如果你想要一条通过 10 个点的样条线，你需要 12 个。

该函数演示了一维的 Catmull-Rom 样条插值。（对于 2 或 3 维，只需使用 Y 或 Z 值重复。）此函数将在 p1 和 p2 之间的样条曲线上为我们提供一个点，其中 t 是两者之间距离的比例。

```
public class SplineTest {

    // Catmull-Rom spline interpolation function
    public static double q(double t, double p0, double p1, double p2, double p3) {

        return 0.5 * ((2 * p1) + (-p0 + p2) * t
                + (2 * p0 - 5 * p1 + 4 * p2 - p3) * (t * t) + (-p0 + 3 * p1 - 3
                * p2 + p3)
                * (t * t * t));
    }

    public static void main(String[] args) {
        double t = 0.0;
        while (t <= 1.0) {
            System.out.println(q(t, 5, 10, 20, 10));
            t += 0.1;
        }
    }
} 
```

该程序输出：

```
10.0
10.887500000000001
12.0
13.2625
14.6
15.9375
17.2
18.3125
19.2
19.7875
20.000000000000004 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T14:31:00.813

我知道没有内置库。[来源](http://www.mail-archive.com/java3d-interest@java.sun.com/msg13136.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-19T10:13:32.573

[http://www.ee.ucl.ac.uk/~mflanaga/java/Interpolation.html](http://www.ee.ucl.ac.uk/~mflanaga/java/Interpolation.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-09T11:48:53.973

我还没有尝试过，但很可能很快就会尝试使用随机点输入生成 3d 表面网格：toxiclib as a Spline3d tool

[http://code.google.com/p/toxiclibs](http://code.google.com/p/toxiclibs)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-03-21T18:02:13.437

我刚刚尝试了 libGDX，Apache 许可证 [http://github.com/libgtx/libgtx](http://github.com/libgtx/libgtx)

它包含一个 BSpline 类并且易于使用。

[https://github.com/Graphics3D/ect/blob/master/src/main/java/courbes_bsplines/TestGDXBSpline.java](https://github.com/Graphics3D/ect/blob/master/src/main/java/courbes_bsplines/TestGDXBSpline.java)

# c# - Trim() FormCollection 值

> ID：939890
> 
> 赞同：1
> 
> 时间：2009-06-02T14:30:29.753
> 
> 标签：c#, asp.net-mvc

我在玩 NerdDinner 教程 Dinner Edit 控件。
我得到一个 FormCollection 作为参数之一，我可以在使用 UpdateModel() 之前修剪其中的数据吗？

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Edit(int id, FormCollection formValues)
    {
        Dinner dinner = dinnerRepository.GetDinner(id);
        try
        {
            UpdateModel(dinner);
            dinnerRepository.Save();
            return RedirectToAction("Details", new { id = dinner.DinnerID });
        }
        catch
        {
            foreach (var issue in dinner.GetRuleViolations())
            {
                ModelState.AddModelError(issue.PropertyName, issue.ErrorMessage);
            }
            return View(dinner);
        }
    } 
```

还是我必须通过迭代 Request.Form 键来手动执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T15:02:46.130

您可以使用模型绑定器绑定到自定义对象，而不是使用原始表单值。

您可以通过实现 IModelBinder 接口来创建自己的模型绑定器。在 IModelBinder.BindModel 方法中，您可以修剪或执行您想要的任何其他字符串操作。

完成此操作后，您的操作将接收按您希望的方式格式化的数据。

有关更多信息，[K Scott Allen](http://odetocode.com/Blogs/scott/archive/2009/04/27/12788.aspx)和 Scott Hanselman 有几篇涵盖 IModelBinder 的文章。

# python - 覆盖 sqlalchemy 反射表中的默认值

> ID：939893
> 
> 赞同：1
> 
> 时间：2009-06-02T14:30:42.967
> 
> 标签：python, sqlalchemy

我已经反映了现有 mysql 数据库中的大量表。我想表达的是，任何表中具有特定名称的任何列都默认为 datetime.now()。然而，天真地循环遍历表和列，只是在我发现有特定名称的那些上设置默认值是行不通的，当做 session.add(); session.flush() 我收到以下错误：

```
AttributeError: 'builtin_function_or_method' object has no attribute '__visit_name__' 
```

这似乎与对 _set_parent 的调用有关（以及 sqlalchemy.schema`self._init_items(*toinit)`中第 721 行的 this。

有谁知道是否有一种方法可以做到这一点，而无需遍历我所有的反射表并在每个地方添加 Column(..) 行都做同样的事情或诉诸非常丑陋的黑客？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-04T12:41:27.363

另一种选择是在反映时覆盖需要默认值的列：

```
Table('some_table', metadata,
    Column('create_time', DateTime, default=datetime.now),
    autoload=True) 
```

不幸的是，您目前无法反映数据类型并同时设置 SQLAlchemy 端默认值。有人可能会争辩说，数据类型是接口定义的一部分，因此冗余不会造成维护问题 - 如果列数据类型发生更改，您很可能也需要更改默认值函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T14:50:02.317

好的，我已经解决了这个问题，这是一个相当可怕的黑客，因为我使用了一种内部方法。你需要做：

```
from sqlalchemy.schema import ColumnDefault
#....
ColumnDefault(callable)._set_parent(column) 
```

这会产生所需的行为。请注意，您还可以将 ColumnDefault 传递给 kwarg for_update=True，这将更改行为以更改 UPDATE 而不是插入。

我觉得脏:-(

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-02T17:04:01.040

五年后，您可以使用事件侦听器[1]。您可以使用要运行的函数注册侦听器：

```
def do_this_on_column_reflect(inspector, table, column_info):
    column_name = column_info.get("name")
    if column_name == "create_datetime":
        column_info["default"] = datetime.now()
event.listen(Table, "column_reflect", do_this_on_column_reflect) 
```

[1] [http://docs.sqlalchemy.org/en/latest/core/events.html#sqlalchemy.events.DDLEvents.column_reflect](http://docs.sqlalchemy.org/en/latest/core/events.html#sqlalchemy.events.DDLEvents.column_reflect) [2] [http://docs.sqlalchemy.org/en/latest/core/event .html#sqlalchemy.event.listen](http://docs.sqlalchemy.org/en/latest/core/event.html#sqlalchemy.event.listen)

# c# - 使用 WCF 服务返回 MembershipUser

> ID：939897
> 
> 赞同：1
> 
> 时间：2009-06-02T14:31:10.080
> 
> 标签：c#, .net, wcf, asp.net-membership

我有 WCF 服务从 ActiveDirectory 获取用户。我从请求（用户名）接收参数并使用 MembershipUser 属性创建响应。由于某种原因，连接变得紧密。服务操作找到用户并成功创建响应。执行该行时：“返回响应；” 我在客户端遇到了异常。异常：底层连接已关闭：连接意外关闭内部异常：响应 = null 状态 = System.Net.WebExceptionStatus.ConnectionClosed

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T17:55:37.730

打开 WCF 诊断跟踪以查看导致连接关闭的错误。它可能源自客户端或服务，因此您必须为双方打开它。

如何开启追踪：http: [//msdn.microsoft.com/en-us/library/ms733025.aspx](http://msdn.microsoft.com/en-us/library/ms733025.aspx)

使用服务跟踪查看器读取跟踪日志： http: [//msdn.microsoft.com/en-us/library/aa751795 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa751795(VS.85).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T08:16:44.910

我使用 WCF 跟踪发现了错误。错误是 XmlSeriazlier 无法序列化 MembershipUser 即使它是可序列化的，因为它也有 SecurityAttribute。来源：

[http://support.microsoft.com/kb/326971](http://support.microsoft.com/kb/326971)

# xslt - 从 WordML 中删除校对错误并合并节点

> ID：939898
> 
> 赞同：1
> 
> 时间：2009-06-02T14:31:15.540
> 
> 标签：xslt

我是 XML 新手。我有一个 WML 文件。我需要从文件中删除单词校对错误并合并拆分的节点。例如，WML 文件（带有文字校对错误）如下（为方便起见，我删除了几行代码）：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<?mso-application progid="Word.Document"?>
<w:wordDocument xmlns:aml=...
..
..
</wsp:rsids></w:docPr><w:body>

<w:p wsp:rsidR="00FD5EDD" wsp:rsidRDefault="00FD5EDD" wsp:rsidP="00FD5EDD">
<w:r><w:t>It are </w:t></w:r>
<w:proofErr w:type="spellStart"/>
<w:proofErr w:type="gramStart"/>
<w:r><w:t>dcoument</w:t></w:r>
   <w:proofErr w:type="spellEnd"/>
   <w:r><w:t> .</w:t></w:r>
   <w:proofErr w:type="gramEnd"/>
   </w:p>
   <w:p wsp:rsidR="00B67D59" wsp:rsidRDefault="0071345A"/>

   <w:sectPr wsp:rsidR...
   ...
   </w:sectPr></w:body></w:wordDocument> 
```

我的输出应该是这样的（我们得到的就是关闭校对错误的那个）：

```
 ....
   <w:p wsp:rsidR="00FD5EDD" wsp:rsidRDefault="00FD5EDD" wsp:rsidP="00FD5EDD">
   <w:r><w:t>It are dcoument .</w:t></w:r>
   </w:p>
   <w:p wsp:rsidR="00B67D59" wsp:rsidRDefault="003B7608"/>
   ... 
```

WML 文件（一个关闭文字校对错误，另一个打开文字校对错误）应该完全相同。我的要求是比较 XML 文件，因此我必须消除由于这些校对错误而引入的差异。

欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-12-14T05:51:46.793

尝试这个：

```
<xsl:template match="w:p[w:proofErr]/w:r[1]">
    <w:r>
        <w:t>
        <xsl:value-of select=".."/>
        </w:t>
    </w:r>
</xsl:template>

<xsl:template match="w:p[w:proofErr]/w:r[position() > 1]"/> 
```

**输出**

```
 <w:p wsp:rsidR="00FD5EDD" wsp:rsidRDefault="00FD5EDD" wsp:rsidP="00FD5EDD">
      <w:r>
         <w:t>It are dcoument .</w:t>
      </w:r>
   </w:p>
   <w:p wsp:rsidR="00B67D59" wsp:rsidRDefault="0071345A"/> 
```

# java - Java泛型和反射！

> ID：939903
> 
> 赞同：5
> 
> 时间：2009-06-02T14:31:51.527
> 
> 标签：java, generics, reflection

我有一个看起来像这样的类：

```
public class UploadBean {

    protected UploadBean(Map<String,?> map){ 
        //do nothing.
    }
} 
```

为了使用反射并通过调用相应的构造函数来创建对象，我编写了如下代码：

```
Class<?> parTypes[] = new Class<?>[1];
parTypes[0] = Map.class;
Constructor ct = format.getMappingBean().getConstructor(parTypes);
Object[] argList  = new Object[1];
argList[0] = map;
Object retObj = ct.newInstance(argList); 
```

此代码在运行时失败，并出现“无此类方法异常”。现在，如何正确设置参数类型？！这样构造函数中的通用映射参数被识别？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T14:40:12.743

构造函数是受保护的——如果你将它公开*或*使用它`getDeclaredConstructor`来代替`getConstructor`它应该可以工作。

（`setAccessible`如果您试图从您通常无法访问的地方调用它，则需要使用它。）

编辑：这是一个显示它工作正常的测试：

```
import java.lang.reflect.*;
import java.util.*;

public class UploadBean {

    // "throws Exception" just for simplicity. Not nice normally!
    public static void main(String[] args) throws Exception {
        Class<?> parTypes[] = new Class<?>[1];
        parTypes[0] = Map.class;
        Constructor ct = UploadBean.class.getDeclaredConstructor(parTypes);
        Object[] argList  = new Object[1];
        argList[0] = null;
        Object retObj = ct.newInstance(argList);
    }

    protected UploadBean(Map<String,?> map){ 
        //do nothing.
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T14:50:47.823

泛型信息在运行时不可用，它仅用于静态分析，因此就好像泛型不存在一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T14:41:31.120

我相信你需要打电话

```
ct.setAccessible(true) 
```

setAccessible 方法允许您覆盖访问方法。

# algorithm - 改变声音文件的速度

> ID：939904
> 
> 赞同：5
> 
> 时间：2009-06-02T14:32:15.070
> 
> 标签：algorithm, audio, multimedia

我正在寻找改变声音文件的速度，但不知道如何完成它。我假设在减慢速度的情况下必须进行某种类型的插值，但我不确定如何实现加速 - 也许是几个样本的平均值？是否改变节奏或音高目前并不重要，我想学习如何完成两者，但想至少完成一个或另一个开始。

如果有人对这些类型的操作背后的数学有任何参考，他们将不胜感激！

谢谢，本

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-02T14:43:11.897

有两个选项可以加快声音文件的播放：

*   提高采样率
*   减少每单位时间的样本数。

在这两种方法中，播放速度的提高都会使声音的音高发生相应的变化。

**提高采样率**

增加采样率将提高声音的播放速度。例如，从 22 KHz 采样率到 44 KHz 将使播放声音比原来快两倍。在这种方法中，原始采样数据没有改变——只需要改变音频播放设置。

**减少单位时间的样本数**

在这种方法中，播放采样率保持不变，但样本数量减少了——一些样本被丢弃了。

使声音的播放速度为原始速度的两倍的天真方法是删除每隔一个样本，并以原始播放采样率进行播放。

但是，使用这种方法会丢失一些信息，并且我预计会在音频中引入一些伪影，因此这不是最理想的方法。

虽然我自己没有尝试过，但平均样本以创建新样本的想法是一个很好的开始方法。这似乎意味着不仅可以丢弃音频信息，还可以通过平均过程在一定程度上“保留”它。

作为该过程的粗略想法，这里有一段伪代码可以使播放速度加倍：

```
original_samples = [0, 0.1, 0.2, 0.3, 0.4, 0.5]

def faster(samples):
    new_samples = []
    for i = 0 to samples.length:
        if i is even:
            new_samples.add(0.5 * (samples[i] + samples[i+1]))
    return new_samples

faster_samples = faster(original_samples) 
```

我还发布了对“[程序化音频入门](https://stackoverflow.com/questions/366187/getting-started-with-programmatic-audio)”问题的回答，其中我详细介绍了一些可以执行的基本音频操作，所以也许这也很有趣。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T14:54:12.230

维基百科上有一个关于[采样率转换的很好的解释。](http://en.wikipedia.org/wiki/Sample_rate_conversion)基本上，您将信号转换为两个采样率的最小公倍数，过滤掉任何不适合目标采样率（或不是来自源）的频率，并以目标采样率挑选新样本。有一些数学技巧可以使计算占用的资源大大减少（多相分解），但这应该可以帮助您入门。

# javascript - 动态选择框和动态 DIV，设置元素而不是删除/附加

> ID：939906
> 
> 赞同：2
> 
> 时间：2009-06-02T14:32:38.047
> 
> 标签：javascript, dhtml

我正在创建一个动态选择框，在更改文本部分时将填充数据。我宁愿将数据设置为某些文本，而不是追加。

例如：

更改选择框时调用此函数：

```
function createDetails(...) {

    var details = document.getElementById("detailsDIV");
    var docFragment = document.createDocumentFragment();
    containerDiv = document.createElement("div");

    // Create five div sections with the text for the details section
    var nameTextNode    = createTextDivSect(nameStr);
    var phoneTextNode   = createTextDivSect("Phone:  " + phoneStr);
    var faxTextNode     = createTextDivSect("Fax:    " + faxStr);
    var websiteTextNode = createTextDivSect("Website: " + websiteStr);
    var emailTextNode   = createTextDivSect("Email: " + emailStr);

    // Append the text sections to the container DIV
    containerDiv.appendChild(nameTextNode);
    containerDiv.appendChild(phoneTextNode);
    containerDiv.appendChild(faxTextNode);

    // Add the container div to the doc fragment
    docFragment.appendChild(containerDiv);
    // Add the doc fragment to the div
    details.appendChild(docFragment);
} 
```

////

使用这种方法，假设我要附加到一个部分。有没有办法让我设置孩子。我想我可以删除孩子然后设置它。但我认为这会浪费资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:36:25.497

如果你想在不使用 innerHTML 的情况下一次设置整个 div，你可以使用[`replaceChild()`](https://developer.mozilla.org/En/DOM/Node.replaceChild)：

```
function createDetails(...) {

    var details = document.getElementById("detailsDIV");
    var docFragment = document.createDocumentFragment();

    // Process docFragment here...

    var parentNode = details.parentNode;
    parentNode.replaceChild(docFragment, details);
} 
```

# html - ID、类和包含元素类型前缀的 HTML 命名约定？

> ID：939909
> 
> 赞同：62
> 
> 时间：2009-06-02T14:33:38.000
> 
> 标签：html, css, xhtml, naming-conventions

有没有人知道一个很好的资源来解释 HTML ID 和类的良好命名约定以及是否以元素类型（即 btn 或按钮或类似的元素类型）作为前缀？

类应该是复数还是单数？我知道 ID 应该是单数的，因为它们是唯一的，但是类呢？

ID 和类应该使用名词，对吧？

我正在使用在现有页面中注入其他页面的页面，有点像部分页面......因此......我想知道是否有人在 ID 和/或类前面加上名称前缀......有点像命名空间或相似的？

任何评论或见解都非常感谢。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2014-05-14T15:24:29.333

## 2015 年：关注现有 CSS 和 HTML 命名系统的新答案

对于您选择的任何约定，我建议您选择针对您项目需求的要求。

即：你的项目是小还是大？您的项目会被重用还是需要处理某种主题？从事 CSS/HTML 工作的开发人员是否热衷于或有足够的经验来遵守约定？＆ 很快..

* * *

首先，如果您不知道这种常见（好的？）做法：**避免使用 ID 作为样式挂钩，请尝试仅使用类**

因为：

*   只有极少数块（即页眉、页脚）可以 100% 保证它们不会在其他地方重复使用

*   你想保持低特异性，总有时候你需要覆盖它（不使用额外的 ID 选择器或！重要）

* * *

### 常见要求/约定：

*   名称应该直观/有意义
*   不要缩写名称，除非它是一个非常知名的缩写（即 msg 代表消息，acnt 代表帐户）
*   使用已知/常用名称：.site-nav、.aside-nav、.global-head、.btn-primary、.btn-secondary
*   允许结构层次结构（即 BEM 约定）
*   使用`-`或`_`命名：可能是主观的（开发人员的意见）和取决于使用的键盘语言。请注意，我认为由于浏览器兼容性问题，camelCase 已被搁置，尽管我从未找到证明这一点的证据。
*   除非特殊情况，否则永远不要在选择器中使用元素：这允许更大的灵活性，即。你有你创建的按钮 using`<input type="button"></input>`并且你想切换到 using `<button></button>`，如果你在某些选择器中使用了元素类型，那么你可以计划一些烦人/耗时的重构/测试/prod-bug-fixing，而如果你使用无元素选择器那么切换将无限容易。[SMACCS 在它的约定中也有它](http://smacss.com/book/type-module#avoid)
*   对于状态，尝试匹配来自其他语言（php、java、c#）的已知约定：即，使用“is-active”、“is-badass”等
*   名称从左到右：从最通用到最精确，即。`btn-bluetheme-create-accnt`或者`accordion-modrnlook-userlist`
*   类或 id 名称应始终足够具体，以便在整个项目中进行搜索并仅返回相关结果
*   如果你使用后代选择器，更喜欢直接后代 - 使用`.module-name > .sub-module-name`vs `.module-name .sub-module-name`- 你将来会省去一些麻烦（更简单的 CSS 但也更高效，尽管术语“CSS 性能可能是可笑的”）

* * *

### 已知约定：

***结构命名约定：***通过描述元素的类而不是它的位置或外观来命名元素的类。请参阅下面的示例。

```
.page-container
     .page-wrap-header-n-content
     .page-header
          .branding-logo
          .branding-tagline
          .wrapper-search
          .page-nav-main
     .page-main-content
     .page-secondary-content
          .nav-supplementary
     .page-footer
          .site-info 
```

***表现性命​​名约定：***通过描述元素的位置和/或外观来命名元素的类。请参阅下面的示例。

```
.theme-ocean-blue
.theme-apricot-orange
.skin-red-tango
.skin-darkness 
```

***语义命名约定：***通过描述它所包含的内容来命名。如。见下面的例子。

```
.product-review
.notification
.language-switch
.currency-switch
.list-of-friends
.latest-status 
```

***BEM 命名约定：***代表“块、元素、修饰符”。语法如`<module-name>__<sub-module-name>--<modifier-or-state>`. Block 是一个“主”容器，一种模块/组件，无论你怎么称呼它。Element 只是主组件（Block）的子组件。修饰符是某种状态。*特点：*语法（dbl underscore & dbl dash 的用法），& 子元素必须包含它们最接近的组件名称。请参阅下面的示例。

```
.nav-primary
.nav-primary__list
.nav-primary__item
.nav-primary__link
.nav-primary__link--is-active

.grid
.grid__item
.grid__description
.grid__img-wrap
.grid__img

.global-footer
.global-footer__col
.global-footer__header
.global-footer__link 
```

***OCSS 命名约定：***代表面向对象的 CSS。将皮肤用于品牌推广或设计一致性（即背景颜色、边框颜色……）。抽象结构样式。下面是抽象结构样式的示例。[OOCSS的两个主要原则：分离结构和皮肤，其次分离容器和内容。](https://github.com/stubbornella/oocss/wiki)

```
.global-width {
    min-width: 780px;    /* minimum width */
    max-width: 1400px;   /* maximum width */
    margin: 0 auto;      /* Centering using margin: auto */
    position: relative;  /* Relative positioning to create a positioning context for child elements */
    padding-left: 20px;
    padding-right: 20px;
    overflow: hidden;    /* Overflow set to "hidden" for clearfixing */
} 
```

* * *

### 一些 CSS 指南：

有一个“趋势”来分享你的 CSS 样式指南，这里有一些你可以阅读以挑选和选择任何适合你需要的东西（命名约定，还有更多，这可能超出了你的问题范围）：

*   [github.com/styleguide/css/](http://github.com/styleguide/css/)
*   [cssguidelines.es](http://cssguidelin.es)
*   [css-tricks.com/sass-style-guide](http://css-tricks.com/sass-style-guide)
*   [codepen.io/chriscoyier/blog/codepens-css](http://codepen.io/chriscoyier/blog/codepens-css)

* * *

### 我的偏颇意见：

我目前混合使用**BEM**、**语义**和**结构**命名约定，并且效果很好。

**BEM**和**语义**一起工作得很好（是的，我将我的类命名为 `.list-of-friends__single-friend`）。BEM 让事情变得特别简单：CSS 中没有疯狂的嵌套和非常冗长的代码。

**对于网站的裸结构，或者如果网站有多个结构，则每个“模板”也欢迎**结构命名约定。**在我看来，这应该仅用于非常通用的元素，因此请谨慎使用。**

 ****表示**命名约定：真的吗？？谢谢，但不，谢谢。您可以在特殊情况下考虑它（即，以不同的主题对整个页面进行皮肤）。

**OCSS**命名约定：我不得不承认，仍然需要进一步研究。我在以下资源中提供了链接，供您进一步调查。

* * *

### 资源：

*   [http://www.smashingmagazine.com/2011/12/12/an-introduction-to-object-oriented-css-oocss/](http://www.smashingmagazine.com/2011/12/12/an-introduction-to-object-oriented-css-oocss/)
*   [http://getbem.com/](http://getbem.com/)
*   [http://bem.info/method/definitions/](http://bem.info/method/definitions/)
*   [http://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/](http://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/)
*   [https://github.com/stubbornella/oocss/wiki](https://github.com/stubbornella/oocss/wiki)
*   [https://css-tricks.com/semantic-class-names/](https://css-tricks.com/semantic-class-names/)
*   [http://www.stuffandnonsense.co.uk/archives/naming_conventions_table.html](http://www.stuffandnonsense.co.uk/archives/naming_conventions_table.html)
*   [http://sixrevisions.com/css/css-tips/css-tip-2-structural-naming-convention-in-css/](http://sixrevisions.com/css/css-tips/css-tip-2-structural-naming-convention-in-css/)
*   [CSS 类命名约定](https://stackoverflow.com/questions/7927193/css-class-naming-convention)
*   [我可以在 CSS 类名中使用 camelCase](https://stackoverflow.com/questions/1547986/can-i-use-camel-case-in-css-class-names)
*   [https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Underscores_in_class_and_ID_Names](https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Underscores_in_class_and_ID_Names)
*   [https://softwareengineering.stackexchange.com/questions/141988/practical-considerations-for-html-css-naming-conventions-syntax](https://softwareengineering.stackexchange.com/questions/141988/practical-considerations-for-html-css-naming-conventions-syntax)
*   [http://smacss.com/book/type-module](http://smacss.com/book/type-module)
*   [github.com/styleguide/css/](http://github.com/styleguide/css/)
*   [cssguidelines.es](http://cssguidelin.es)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-06-02T14:41:02.913

很多人没有意识到你可以这样做：

```
.awesome {
 /* rules for anything awesome */
}

div.awesome {
 /* rules for only awesome divs */
}

button.awesome {
 /* rules for any awesome buttons, but not awesome divs */
}

div.awesome h1 {
 /* rules for H1s inside of any div.awesome */
}

div.awesome>button {
 /* rules for immediate children buttons (not grandchildren+) of div.awesomes */
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-02T14:39:36.893

我不会以类型为前缀，因为如果必须的话，你可以在选择器中推断出来

```
form#contact {
    property: value;

} 
```

您描述的方法被称为匈牙利符号，并且不是很流行。

对于您提到的内容，您可以将注入的 HTML 放在一个具有唯一类/id 的 div 中，该类/id 具有一种本地化重置。查找 CSS 选择器特性以确保您的规则生效，而不是主机页面 CSS 中的其他规则。[有关样式化父页面中元素的类似问题，请参阅此答案。](https://stackoverflow.com/questions/909025/javascript-widget-affecting-style-of-the-page-it-is-embedded-in/909039#909039)

# django - Django 不能 http 请求自己的页面？

> ID：939912
> 
> 赞同：1
> 
> 时间：2009-06-02T14:34:44.143
> 
> 标签：django, django-admin

有一次，我的 Django 应用程序需要加载它自己的一个页面来呈现另一个页面。我正在尝试使用 urllib2（与 Python 2.6 一起使用）来加载页面，但似乎较新的请求被阻止，直到前者完成。

这是 Django 在调试模式下仅使用一个线程的问题吗？（我只是使用默认值运行它`python manage.py runserver`）。有没有简单的方法让它多线程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T15:11:14.320

真的没有办法让开发服务器多线程。几年来，在 django 项目中有一张关于此的公开票，还有一个补丁（您可以尝试实施它以查看它是否适合您；-) ）[。](http://code.djangoproject.com/ticket/3357)票证不断关闭或推迟到“需要设计决策”，因为该项目不希望人们使用管理服务器进行部署……如果它是多线程的，他们可能只是“处于紧急情况”。管理服务器效率不高，也没有加强安全性，因此任何人可能会使用它运行生产环境的任何机会都是非常危险的......让 django 安装在世界各地以建立安全性差的声誉无济于事:-)

我的个人经验是像我的生产环境一样运行本地 Apache 实例来测试 AJAX 或其他可能会收到并发请求的场景。

在您的情况下，由于您只是在查找请求的结果并且您可以访问服务器代码，因此我建议您进行一些重构，以便您无需调用该页面即可获得该页面的输出结果通过 HTTP。编写一个返回实际结果的函数，并让您的普通 HTTP 视图简单地调用该函数。这样，任何其他应用程序代码也可以调用该函数，而无需服务器往返。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T15:02:29.890

不要尝试对自己使用http。即使你让它运行（可能在真实服务器上工作，而不是在测试服务器上）；这将是非常低效的。视图只是 Python 函数，调用它们！

当然，更好的是有一个健全的模型和一个单独的模板片段，你可以在两个视图上使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T15:08:46.163

为什么不直接使用`render_to_string`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-07T09:54:42.900

我刚刚在这里添加了我的解决方法：

[http://code.djangoproject.com/ticket/3357#comment:26](http://code.djangoproject.com/ticket/3357#comment:26)

您可能会发现这很有用。

# jquery - jquery：使日期选择器通过图像显示/隐藏？

> ID：939914
> 
> 赞同：3
> 
> 时间：2009-06-02T14:34:59.557
> 
> 标签：jquery, datepicker

我想使用日历的图像来显示/隐藏 jquery datepicker。根据文档，我似乎需要设置我拥有的 buttonImage 和 buttonImageOnly。日期选择器正在工作，但它始终可见。这是我的代码：

```
<script type="text/javascript">
$(document).ready(function(){
$("#datepicker").datepicker({ 
    altField: '#from', 
    altFormat: 'yymmdd', 
    buttonImage: 'datepicker.png', 
    buttonImageOnly: true, 
    defaultDate: <?=getDaysFromToday($_GET['from'])?>, 
    showOn: 'focus' 
    });
});

$('#datepicker').datepicker({
    onSelect: function(dateText, inst) {
    $("#myform").submit(); 
    }
});
 </script> 
```

此外，我试图让它在您选择日期时提交表格，我似乎也无法让它工作。

难道我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-02T14:52:59.817

代替

```
showOn: 'focus' 
```

和

```
showOn: 'button' 
```

这将使日期选择器仅在单击按钮时出现，而不是在文本字段获得焦点时出现。

无法告诉您为什么表单提交不起作用。您是否将任何提交事件绑定到可能返回错误的表单？

由于`this`refres 是事件处理程序中的 input 元素，也许您可​​以试试这个提交：

```
this.form.submit(); 
```

**评论后编辑**：看看[这个例子](http://jqueryui.com/demos/datepicker/icon-trigger.html)，按钮会自动添加。

我刚刚意识到您对`datepicker`. 将两者合二为一可能有助于解决您的事件问题：

```
$("#datepicker").datepicker({ 
    altField: '#from', 
    altFormat: 'yymmdd', 
    buttonImage: 'datepicker.png', 
    buttonImageOnly: true, 
    defaultDate: <?=getDaysFromToday($_GET['from'])?>, 
    showOn: 'focus'.
    onSelect: function(dateText, inst) {
        $("#myform").submit(); 
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-24T11:51:42.457

对于那些希望将图标放置在输入字段旁边不要太近的人：

[http://forum.jquery.com/topic/altering-position-of-datepicker-icon#14737000001522067](http://forum.jquery.com/topic/altering-position-of-datepicker-icon#14737000001522067)

```
.ui-datepicker-trigger {
margin-left : 5px;
vertical-align : top;
} 
```

# javascript - 原型：如何防止按钮按下直到做出响应

> ID：939915
> 
> 赞同：2
> 
> 时间：2009-06-02T14:34:59.743
> 
> 标签：javascript, html, prototypejs

我正在使用这段代码在网页上制作文本按钮

```
<a href='#' onclick="new Ajax.Updater('history', '/responsesG', {parameters: {name: '%s', port: '%s', profil: '201', action: 'profile'}, 
    insertion: Insertion.Top}
        ); return false;">Do something</a> 
```

因为这是一个昂贵的调用，我想防止用户多次点击它，因为它会进行异步调用，并且他们会为同一件事获得例如 3 个响应（因为响应持续 3 到 5 秒）我尝试了选项

> 异步：假

同样成功（失败）。我该怎么做？

编辑：

```
<a href="#" onclick="diagnostika('mac_adresa');return false;">-Mac address</a>
<script type="text/javascript">
function diagnostika(akcija) {
            if(!this.clicked) {
                this.clicked = true;
                button = this;
                new Ajax.Updater('history', '/responsesG', {
                    parameters: {
                        name: '%(name)s',
                        port: '%(port)s',
                        action: akcija},
                    insertion: Insertion.Top,
                    onComplete: function() {
                    button.clicked = false;}});}
                return false;};
</script> 
```

这就是我最终实现的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T14:43:00.100

给你的链接一个唯一的 ID 属性，例如：

```
<a href="#" id="foo">Do something</a> 
```

然后在你的 JavaScript 中你可以这样做：

```
$("foo").observe("click", function() {
  this.disabled = true;
  new Ajax.Updater("history", "/responsesG",
                   { parameters: { name: "%s",
                                   port: "%s",
                                   profile: "201",
                                   action: "profile" },
                   insertion: Insertion.Top });
  return false;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T14:41:39.357

您需要添加以下内容：

```
if(!this.clicked) {
    this.clicked = true;
    button = this;
    new Ajax.Updater('history', '/responsesG', {
        parameters: {
            name: '%s',
            port: '%s',
            profile: '201',
            action: 'profile'
        },
        insertion: Insertion.Top,
        onComplete: function() {
            button.clicked = false;
        }
    });
}

return false; 
```

但是，实际上，将其从内联 onClick 中取出，以便更易于阅读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T14:41:45.813

在 onclick 处理程序中禁用（甚至隐藏）链接，然后在收到响应时重新启用或显示它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T14:42:25.873

将 onclick 发送到您自己的函数，禁用按钮，启动将重新启用按钮的计时器，然后执行 Ajax.Updaer。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T14:43:03.313

返回一个全局标志 onclick，一旦请求发出就设置为 false，返回时返回 true

# diff - 有没有办法在 Araxis Merge 中保存补丁/差异文件？

> ID：939916
> 
> 赞同：8
> 
> 时间：2009-06-02T14:35:08.620
> 
> 标签：diff, patch, araxis

我正在合并一些代码，并想保存一个差异以与另一个差异进行比较。（我处于可怕的 diff-the-diff 场景中）。无论如何，我这样做的正常方法是保存到补丁文件并比较它们以确保应用了正确的更改。

有什么方法可以让 Araxis 为我当前正在查看的差异生成补丁文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T22:58:27.847

Araxis 的那些小恶作剧者删除了“*文件*”菜单。我花了几分钟才发现“*报告”*按钮现在隐藏在顶部面板中间的明显位置。

对于下一个好奇的灵魂，一点提示：

![不那么隐藏的报告按钮位置](https://i.stack.imgur.com/elDJl.png)

这将带您进入带有漂亮的*UNIX Diff*选项的*Reports对话框。*

 ** * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T14:37:13.450

好吧，我想我找到了。您必须通过“文件”菜单：

```
File -> Report 
```

在该对话框中，有一个选项可以获取 unix diff... viola！

# mysql - Wordpress 高级 SQL - 连接和计数

> ID：939929
> 
> 赞同：1
> 
> 时间：2009-06-02T14:37:25.370
> 
> 标签：mysql, wordpress, select, count

**这就是**
我使用 Wordpress 类别表并有 2 个主要类别的工作方式。第一个称为“ `location`”，另一个称为“ `subject`”。这两个类别都有自己的子类别。

在我的示例中，我们有“ `location`”类别 17 和“ `subject`”类别 3。

**这就是我想要做的**
我只想选择同时出现我的类别 17 和 3 的数据。

**到目前为止，此代码有效**

```
SELECT term_id, post_title, post_name, ID, object_id, post_status
FROM wp_posts AS wpost
INNER JOIN wp_term_relationships
   ON wpost.ID = wp_term_relationships.object_id

INNER JOIN wp_term_taxonomy
   ON wp_term_relationships.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id AND wp_term_taxonomy.taxonomy = 'category'

WHERE wp_term_taxonomy.term_id IN (17, 3)
   AND post_status = 'publish' 
```

**问题**
类别 17 和 3 都存在于同一列中。如果帖子出现在两个类别中，上面的代码会列出两次 ID。

有没有办法计算结果中相等的 ID？*如果 ID 存在两次，请从该 ID 中选择帖子*。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T14:54:38.690

如果每个帖子都存在于两个类别中，这将只选择一次：

```
SELECT  post_title, post_name, post_status
FROM    wp_posts AS wpost
WHERE   post_status = 'publish'
        AND EXISTS (
        SELECT   1
        FROM     wp_term_relationships
        INNER JOIN
                 wp_term_taxonomy
        ON       wp_term_relationships.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id
                 AND wp_term_taxonomy.taxonomy = 'category'
                 AND wp_term_taxonomy.term_id IN (17, 3)
        WHERE    wp_term_relationships.object_id = wpost.ID
        LIMIT 1, 1
        ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T21:26:52.437

这样就可以做到（前提是类别 3 或 17 中的条目没有重复的行），而无需嵌套查询：

```
SELECT term_id, post_title, post_name, ID, object_id, post_status, COUNT(*) as count
FROM wp_posts AS wpost
INNER JOIN wp_term_relationships
   ON wpost.ID = wp_term_relationships.object_id

INNER JOIN wp_term_taxonomy
   ON wp_term_relationships.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id AND wp_term_taxonomy.taxonomy = 'category'

WHERE wp_term_taxonomy.term_id IN (17, 3)
   AND post_status = 'publish'
   AND count = 2

GROUP BY ID 
```

添加[count 变量和 GROUP BY 子句](http://dev.mysql.com/doc/refman/5.1/en/counting-rows.html)会将重复项聚集在一起。然后过滤计数等于 2 的行以获取两个类别中的条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T07:17:04.130

更近了一步？现在我唯一需要做的就是在“count”列中显示包含“2”的行。

因为计数列是在“循环”中创建的，所以只写“AND count = 2”是行不通的。

此示例显示包含计数列的结果：

```
SELECT term_id, post_title, post_name, ID, object_id, post_status, COUNT(ID) as count
FROM wp_posts AS wpost
INNER JOIN wp_term_relationships
   ON wpost.ID = wp_term_relationships.object_id

INNER JOIN wp_term_taxonomy
   ON wp_term_relationships.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id AND wp_term_taxonomy.taxonomy = 'category'

WHERE wp_term_taxonomy.term_id IN (17, 3)
   AND post_status = 'publish'

GROUP BY ID 
```

# java - 如何在线程化的 Java 应用程序中确定运行时的主类？

> ID：939932
> 
> 赞同：23
> 
> 时间：2009-06-02T14:37:44.200
> 
> 标签：java, runtime, stack-trace, classloader, main

我想在运行时确定我的应用程序启动的类名，即具有 main() 方法的类名，但我在另一个线程中，并且我的堆栈跟踪并没有一直回到原始类。

我搜索了系统属性和 ClassLoader 必须提供的所有内容，但一无所获。这些信息不可用吗？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-11-07T16:27:21.677

请参阅 Tom Hawtin 对链接的评论。这些天的解决方案是（仅限 Oracle JVM）：

```
public static String getMainClassAndArgs() {
    return System.getProperty("sun.java.command"); // like "org.x.y.Main arg1 arg2"
} 
```

仅使用 Oracle Java 7 测试。有关特殊情况的更多信息： [https ://bugs.java.com/bugdatabase/view_bug.do?bug_id=4827318](https://bugs.java.com/bugdatabase/view_bug.do?bug_id=4827318)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-02T14:58:08.963

我想到了。谁能告诉我这个环境变量是否总是存在于跨操作系统的其他 java 实现中？这在 Oracle JVM 上会产生一个类似“org.xyClassName”的字符串

```
public static String getMainClassName() {
  for (final Map.Entry<String, String> entry : System.getenv().entrySet())
    if (entry.getKey().startsWith("JAVA_MAIN_CLASS")) // like JAVA_MAIN_CLASS_13328
      return entry.getValue();
  throw new IllegalStateException("Cannot determine main class.");
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-04-30T00:52:17.667

JAVA_MAIN_CLASS 环境值并不总是存在，具体取决于平台。如果您只想获取启动 Java 进程的“主”类的名称，您可以这样做：

```
 public static String getMainClassName()
  {
    StackTraceElement trace[] = Thread.currentThread().getStackTrace();
    if (trace.length > 0) {
      return trace[trace.length - 1].getClassName();
    }
    return "Unknown";
  } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-02T14:48:22.820

尝试使用[Thread.getAllStackTraces()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html#getAllStackTraces())。它从所有正在运行的线程返回堆栈跟踪的 Map，而不仅仅是当前线程。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-02T15:00:29.740

鉴于澄清，我建议使用“从上面的参数化”成语。你有信息开始，保持它。

我确实为这样的东西放入了 RFE [4827318](http://bugs.sun.com/view_bug.do?bug_id=4827318)（六年前！），以便与测试运行者一起使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-12T03:17:22.707

即使具有 main() 方法的线程已经终止并且您没有使用 Oracle JVM，您仍然可以尝试从操作系统获取信息。下面的代码获取了用于在 Linux 下启动 JVM 的命令行，但您可以为 Windows 等编写一个版本。然后您可以查看 JVM 的参数以找到应用程序入口点。它可能直接在命令行上，或者您可能已经在指定 jar 的清单中查找 Main-Class: classname。我会首先使用 System.getProperty("sun.java.command") 和朋友只在必要时回退到这个机制。

```
public final static long getSelfPid() {
    // Java 9 only
    // return ProcessHandle.current().getPid();
    try {
        return Long.parseLong(new File("/proc/self").getCanonicalFile().getName());
    } catch( Exception e ) {
        return -1;
    }
}

public final static String getJVMCommandLine() {
    try {
        // Java 9 only
        // long pid = ProcessHandle.current().getPid();
        long pid = getSelfPid();
        byte[] encoded = Files.readAllBytes(Paths.get("/proc/"+pid+"/cmdline"));
        // assume ISO_8859_1, but could look in /proc/<pid>/environ for LANG or something I suppose
        String commandLine = new String( encoded, StandardCharsets.ISO_8859_1 ); 
        String modifiedCommandLine = commandLine.replace((char)0, ' ').trim();
        return modifiedCommandLine;
    } catch( Exception e ) {
        return null;
    }
}` 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T14:50:21.193

怎么样：

```
Map<Thread,StackTraceElement[]> stackTraceMap = Thread.getAllStackTraces();
for (Thread t : stackTraceMap.keySet())
{
    if ("main".equals(t.getName()))
    {
        StackTraceElement[] mainStackTrace = stackTraceMap.get(t);
        for (StackTraceElement element : mainStackTrace)
        {
            System.out.println(element);
        }
    }
} 
```

这会给你类似的东西

```
java.lang.Object.wait(Native Method)
java.lang.Object.wait(Object.java:231)
java.lang.Thread.join(Thread.java:680)
com.mypackage.Runner.main(Runner.java:10) 
```

虽然可能不保证调用主线程`"main"`- 可能更好地检查包含的堆栈跟踪元素`(main`

**编辑**如果主线程已经退出，这不好！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T15:40:53.583

我建议将此信息放入系统属性中。当您从脚本启动应用程序时，这通常很容易做到。

如果你不能这样做，我建议在每个应用程序的 main() 方法中设置属性。这里最简单的方法是让每个应用程序从一个公共基类派生它的“主类”并在其中运行一个 init 步骤。我经常为命令行处理这样做：

```
public class Demo extends Main {
    main(String[] args) {
        Main._main(new Demo (), args);
    }

    // This gets called by Main._main()
    public void run (String[] args) {
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-07-23T04:47:02.407

这是我正在使用的，用于您不控制主要的情况：

```
public static Class<?> getMainClass() {
  // find the class that called us, and use their "target/classes"
  final Map<Thread, StackTraceElement[]> traces = Thread.getAllStackTraces();
  for (Entry<Thread, StackTraceElement[]> trace : traces.entrySet()) {
    if ("main".equals(trace.getKey().getName())) {
      // Using a thread named main is best...
      final StackTraceElement[] els = trace.getValue();
      int i = els.length - 1;
      StackTraceElement best = els[--i];
      String cls = best.getClassName();
      while (i > 0 && isSystemClass(cls)) {
        // if the main class is likely an ide,
        // then we should look higher...
        while (i-- > 0) {
          if ("main".equals(els[i].getMethodName())) {
            best = els[i];
            cls = best.getClassName();
            break;
          }
        }
      }
      if (isSystemClass(cls)) {
        i = els.length - 1;
        best = els[i];
        while (isSystemClass(cls) && i --> 0) {
          best = els[i];
          cls = best.getClassName();
        }
      }
      try {
        Class mainClass = Class.forName(best.getClassName());
        return mainClass;
      } catch (ClassNotFoundException e) {
        throw X_Util.rethrow(e);
      }
    }
  }
  return null;
}

private static boolean isSystemClass(String cls) {
  return cls.startsWith("java.") ||
      cls.startsWith("sun.") ||
      cls.startsWith("org.apache.maven.") ||
      cls.contains(".intellij.") ||
      cls.startsWith("org.junit") ||
      cls.startsWith("junit.") ||
      cls.contains(".eclipse") ||
      cls.contains("netbeans");
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-11T08:36:41.230

获取主类的另一种方法是在 Thread.getAllStackTraces 上查找该类，因此您甚至可以在 jar 中找到它，它适用于任何 SDK（Open、Oracle...）：

```
private static Class<?> mainClass = null;

public static Class<?> getMainClass()
{
    if (mainClass == null)
    {
        Map<Thread, StackTraceElement[]> threadSet = Thread.getAllStackTraces();
        for (Map.Entry<Thread, StackTraceElement[]> entry : threadSet.entrySet())
        {
            for (StackTraceElement stack : entry.getValue())
            {
                try
                {
                    String stackClass = stack.getClassName();
                    if (stackClass != null && stackClass.indexOf("$") > 0)
                    {
                        stackClass = stackClass.substring(0, stackClass.lastIndexOf("$"));
                    }
                    Class<?> instance = Class.forName(stackClass);
                    Method method = instance.getDeclaredMethod("main", new Class[]
                    {
                        String[].class
                    });
                    if (Modifier.isStatic(method.getModifiers()))
                    {
                        mainClass = instance;
                        break;
                    }
                }
                catch (Exception ex)
                {
                }
            }
        }
        return mainClass;
    }
} 
```

# tags - 热门话题：1 字词与组合词

> ID：939938
> 
> 赞同：3
> 
> 时间：2009-06-02T14:39:20.263
> 
> 标签：tags

[在您的完美帮助下，](https://stackoverflow.com/questions/787496/what-is-the-best-way-to-compute-trending-topics-or-tags)我已经了解了如何计算热门话题（标准分数 + 浮动平均值）。

我的下一个问题：我的数据库中的术语（由 1-3 个单词组成）与它们被提及的时间相关联。但热门话题总是只有 1 个单词的术语，因为一个术语的一部分总是比完整的术语更频繁地被提及。示例：昨天有 3 篇新闻文章是关于“巴拉克·奥巴马”的，今天有 148 篇。然后“巴拉克·奥巴马”当然正在上升。但“巴拉克”也在崛起，因此成为热门话题。

在计算热门话题时如何包含术语长度？我不想使用其他算法，我对上面的算法非常满意。我可以将所有两个词项的分数乘以 1.5 左右吗？

详细示例：我的主要趋势是：微软、中国、希拉里·克林顿、达拉斯小牛队。我想说“希拉里·克林顿”和“达拉斯小牛队”从来没有排名第一或第二，因为它们是两个词。“微软”和“中国”是一个词，所以总是排名靠前。有没有可能解决这个问题？

我希望你能帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-06T07:34:17.277

谈到奥巴马，是的，你可以。:)

也许您可以在输出之前测试您的高趋势是否包含在低趋势中。我会尝试这样的事情：

示例：你有

1.  奥巴马
2.  法国航空
3.  巴拉克
4.  A330
5.  巴拉克奥巴马
6.  ...

如果您要输出的列表不太长（例如您只取 100 个最佳分数），则仅选择其他列表中未包含的列表，可能会为包含其他列表的列表添加 50% 的奖励。（您可能必须先取 150 个值，然后进行处理以消除冗余，这可能会达到 110 之类的值，然后修剪最后 10 个值以恢复您的 100 个值。）

“Barack Obama”同时包含“Barack”和“Obama”，所以你可以给它 100% 的奖励，你的列表可能变成：

1.  法国航空
2.  巴拉克奥巴马
3.  A330
4.  ...

希望它不会改变你的算法太多，但实际上你可以在输出之前插入这个处理。

编辑 ：

或者，如果你真的没有列出最好的分数，而只是一个一个地计算，你可以拆分你的趋势来计算其组成部分的思考总和（比如“巴拉克奥巴马”的趋势是“巴拉克奥巴马”的+ 0.5*“巴拉克”+ 0.5*“奥巴马”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-07T13:04:41.010

基于@subtenante 的答案，您应该寻找的公式应该基于“巴拉克奥巴马”总是包含“巴拉克”和“奥巴马”这一事实......
如此简单的数学表明它应该是：

```
"Barack"s + "Obama"s - "Barack Obama"s 
```

...当然，假设您的部分术语仅出现在正确的上下文中，无论是单独出现还是与完整术语组合 - 即“巴拉克”将始终指代“巴拉克奥巴马”（而不是“埃胡德巴拉克” ）。

# c# - C# Authcookie 设置在哪里？

> ID：939941
> 
> 赞同：2
> 
> 时间：2009-06-02T14:39:47.597
> 
> 标签：c#, asp.net, forms-authentication

使用 FormsAuthentication 时，Authcookie 放在哪里？在服务器上还是在客户端？当客户端禁用 cookie 时，FormsAuthentication 是否仍然有效？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T14:53:56.943

在客户端。据说通过更改 web.config 支持 cookieless，但我没有成功实现它。如果使用 cookieless，则 cookie 存储在网页的 URI 中，例如[http://MySite.com/MyWebApplication/F(XXXX))/home.aspx](http://MySite.com/MyWebApplication/F(XXXX))/home.aspx)。

```
<forms 
   cookieless="[UseUri|UseCookie|AutoDetect|UseDeviceProfile]" 
</forms> 
```

从[表单元素进行身份验证（ASP.NET 设置架构）](http://msdn.microsoft.com/en-us/library/1d3t3c61.aspx)：

> *在启用 AJAX 的 ASP.NET 网站中，使用默认值 UseCookies 作为 cookieless 属性。ASP.NET AJAX 客户端脚本库不支持使用 URL 中编码的 cookie 的设置。*
> 
> **UseCookies**指定将始终使用 cookie，无论设备如何。
> 
> **UseUri**指定永远不会使用 cookie。
> 
> **AutoDetect**如果设备配置文件支持 cookie，则指定使用 cookie；否则，不使用 cookie。对于已知支持 cookie 的桌面浏览器，启用时将使用探测机制来尝试使用 cookie。如果设备不支持 cookie，则不会使用任何探测机制。
> 
> **UseDeviceProfile**指定使用 cookie，如果浏览器支持 cookie；否则，不使用 cookie。对于支持 cookie 的设备，不会尝试探查以确定是否启用了 cookie 支持。
> 
> 此属性是 .NET Framework 2.0 版中的新特性。
> 
> 默认值为 UseDeviceProfile。

使用 cookieless 可能不如要求使用 cookie 安全。从[了解 ASP.NET 无 Cookie 功能的工作原理](http://msdn.microsoft.com/en-us/library/aa479315.aspx)：

> 无 cookie 功能特有的一个大问题（使用 cookie 时不存在）是与用户向其他用户发送 URL（例如通过电子邮件和 IM）相关的漏洞。当此功能打开时，例如 FormsAuthentication，并且用户通过电子邮件将他（或她）的 URL 发送给其他用户，第二个用户将使用第一个用户的凭据自动登录到服务器。一种对策是通过减少表单身份验证的 cookie 超时来减少可能发生这种情况的时间窗口（如前面 (b) 点所述）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T14:51:56.213

它放置在客户端上，如果您使用 firebug，它在响应中应该如下所示： .ASPXFORMSAUTH=C8390F0E68890DF5C731DB2B.... 表单身份验证仍然可以工作，但所有内容都将在浏览器的 url 中设置。体面的文档[在这里](http://msdn.microsoft.com/en-us/library/aa480476.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T17:02:16.307

在服务器上。使用 Reflector 深入研究 FormsAuthentication 类，您可以跟踪 cookie 的初始化和设置位置。

[Reflector](http://www.red-gate.com/products/reflector/)是一个免费工具，可以“反编译”.NET 程序集，让您或多或少地看到它们在做什么（尽管它不显示原始源代码，只是基于 IL 的重构版本）。

使用它，您可以打开文件

```
c:\Windows\Microsoft.NET\Framework\<version>\System.Web.dll 
```

并查看 System.Web.Security 命名空间中的 FormsAuthentication 类。在那里，您可以看到 cookie 是在私有重载方法中创建和设置的

```
GetAuthCookie(string userName, bool createPersistentCookie, string strCookiePath, bool hexEncodedTicket) 
```

由 RedirectFromLoginPage（或 GetAuthCookie 的公共版本）调用。

研究这个文件，您还可以看到 .NET 如何处理无 cookie 身份验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T14:52:25.073

Cookie 始终存储在客户端。

支持 cookie 的浏览器解释`Set-Cookie`HTTP 标头（如果启用了 cookie），解析此标头的值以获取要存储的 cookie 的详细信息（名称、值、域、路径和到期时间）并将 cookie 值保存在某处。对于持久 cookie（即设置了过期值的 cookie），此位置通常位于文件系统上的某个位置，但该位置取决于浏览器。对于会话 cookie（没有过期值的 cookie，只要浏览器打开就一直存在），这可能是一种内存数据结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T15:07:41.550

为了更好地理解这一点，我强烈建议使用 Http 分析器，例如 FireFox 的[HttpFox](https://addons.mozilla.org/en-US/firefox/addon/6647)扩展。它允许您查看来自身份验证的 cookie 并被存储。

# entity-framework - 扩展实体模型

> ID：939955
> 
> 赞同：0
> 
> 时间：2009-06-02T14:42:42.177
> 
> 标签：entity-framework

我们有来自一些 SQL 数据库的 EMD。在这个模型上，我们创建了一些类。

现在我们要扩展我们的项目......这意味着在数据库的 CLIENTE 表中添加一些新列并扩展 CLASSES 以使用这些新列。

问题是否有任何方法可以扩展 EMD 模型，或者我们必须从头开始构建它并通过继承失去 CLASSES 功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T13:29:22.303

以 .NET 3.5 为目标？使用概念模型很困难。我宁愿遵循这些步骤，因为无论如何我总是不得不这样做：

1.  从应用程序或 Web 配置中删除实体框架连接字符串
2.  删除模型
3.  完成更改数据库后重新生成新模型

如果您有很多自定义名称等，这是很多工作。我知道有一些解决方法，但我宁愿更改数据库中表和列的名称以满足我的需要。如果您的主要工作是在自定义部分类中，您应该没问题。

如果您的目标是 EF 4，那么发疯就可以了。

# c# - 如何发出委托或 lambda 表达式

> ID：939956
> 
> 赞同：3
> 
> 时间：2009-06-02T14:42:45.967
> 
> 标签：c#, delegates, lambda, reflection.emit

我想发出一个返回 Func<> 的方法。在这个方法中，我必须创建一个完全服务于返回类型的委托或 lambda 表达式。

总而言之，它应该是这样的：

```
// I have a resolve method that will be called inside my missing method
// This is it's signature:
object Resolve( params object[] args);

// This is how I use it:
var barFactory = ( Func<IBar> )MissingMethod( typeof( IBar ) );
var bar = barFactory.Invoke();

// or - with one string argument:
var fooFactory = ( Func<string, IFoo> )MissingMethod( typeof( IFoo ), typeof( string ) );
var foo = fooFactory.Invoke( "argument for foo" ); 
```

在 MissingMethod() 内部，它应该如下所示：

```
object MissingMethod( Type returnType, params Type[] argTypes )
{
  // Create the type of Func<> based on the passed returnType and the argTypes
  var funcType = typeof(Func<,...,>).MakeGenericType( ... )

  // Here I have to use the Resolve() method and cast the lambda to the correct type
  return (cast to funcType)( (arg1, arg2) => Resolve( arg1, arg2 ) );
} 
```

我认为获得我的 MissingMethod() 的唯一方法是使用反射.emit。

你知道关于发出 lambda 或委托的好资源或教程吗？

您是否看到此问题的另一种可能的解决方案？

**编辑：**
这是我想要实现的场景：

```
static void Main()
{
  var container = new Container();
  container.Register<Foo>();
  container.Register<ConsumerClass>();

  var consumerClass = Container.Resolve<ConsumerClass>();
}

class Foo()
{
  public Foo( string argument ) {}
}

class ConsumerClass
{
  public ConsumerClass( [Inject] Func<string, Foo> factory )
  {
    var foo1 = factory.Invoke( "first foo" );
    var foo2 = factory.Invoke( "another foo" );
    // ...
  }
} 
```

我正在尝试实现 Container 和 Resolve() 方法。我知道注册了一个“Foo”类型。而且我知道它的构造函数需要一个字符串才能被调用。

当我必须解析“ConsumerClass”类型时，我看到它想要注入一个 Func。这不完全是我的容器可以提供的，因为通常它为 Foo 提供单个实例，如下所示：

```
Container.Resolve<Foo>( "argument" ); 
```

但是尽管如此，容器也应该能够提供 Func。它有所有需要的信息。

但是现在我被困在创建这个绑定的 Func<,> 中。请记住，它也可能是 Func<,,,>。因此，我正在寻找一种可以即时创建我的 this 代表的解决方案。它们必须可以转换为确切的绑定类型。

**编辑：**
我不知道如何更好地描述它......我正在尝试做这样的[事情](http://kohari.org/2009/03/06/fast-late-bound-invocation-with-expression-trees/)。但我不想通过目标。代替

```
delegate void object LateBoundMethod( object target, object[] arguments ); 
```

我的代表应该看起来像

```
delegate void object LateBoundMethod( object[] arguments ); 
```

并且目标作为实例字段提供。通过采用和“改进”Marc 的解决方案，我得到：

```
private Delegate CreateDelegate( Type returnType, Type[] parameterTypes )
{
  m_Type = returnType;

  var i = 0;
  var param = Array.ConvertAll( parameterTypes, arg => Expression.Parameter( arg, "arg" + i++ ) );
  var asObj = Array.ConvertAll( param, p => Expression.Convert( p, typeof( object ) ) );
  var argsArray = Expression.NewArrayInit( typeof( object ), asObj );

  var callEx = Expression.Call( null, typeof( FuncFactory ).GetMethod( "Resolve" ), argsArray );
  var body = Expression.Convert( callEx, returnType );

  var ret = Expression.Lambda( body, param ).Compile();
  return ret;
}

private readonly Container m_Container;
private Type m_Type;

public object Resolve( params object[] args )
{
  return m_Container.Resolve( m_Type, args );
} 
```

但这是不完整的。Resolve() 方法不再是静态的（因为它需要两个实例字段）并且不能被调用。所以这里的问题是

```
var callEx = Expression.Call( null, typeof( FuncFactory ).GetMethod( "Resolve" ), argsArray ); 
```

我认为我需要引用“this”，而不是将 null 作为第一个参数传递。我怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T14:47:37.283

第一个问题是`Func<...>`不存在的——你需要分别编码到`Func<>`, `Func<,>`, `Func<,,>`, `Func<,,,>`。

现在; 我了解代码，但我不确定您要解决的情况是什么……您能澄清一下吗？可能有更好的选择...

如果它听起来很复杂，那么自定义`Expression`可能是最合适的选择（比 简单得多`Reflection.Emit`）。

* * *

例如，这有效...

```
static Delegate MissingFunc(Type result, params Type[] args)
{
    int i = 0;
    var param = Array.ConvertAll(args,
        arg => Expression.Parameter(arg, "arg" + i++));
    var asObj = Array.ConvertAll(param,
        p => Expression.Convert(p, typeof(object)));
    var argsArray = Expression.NewArrayInit(typeof(object), asObj);
    var body = Expression.Convert(Expression.Call(
                null, typeof(Program).GetMethod("Resolve"),
                argsArray), result);
    return Expression.Lambda(body, param).Compile();
}
static void Main()
{
    var func2 = MissingFunc(typeof(string), typeof(int), typeof(float));
}
public static object Resolve( params object[] args) {
    throw new NotImplementedException();
} 
```

# sql - 更改数据类型后回收 SQL 2005 表中的空间？

> ID：939957
> 
> 赞同：1
> 
> 时间：2009-06-02T14:42:46.140
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我继承了一个包含许多 nvarchar 列的表的数据库。表变得相当大，我决定将数据类型更改为 varchar 以减少存储，因为我们不使用国际字符。表上的“数据空间”（右键单击，然后单击“属性”）没有改变。但是，如果我将这张表复制到一个新表中，那里使用的数据空间大约是原表大小的 60%。

在删除可变长度列后，我在其他实例中使用了“DBCC CLEANTABLE”来回收空间。但这在更改可变长度数据类型时似乎不起作用。我该如何找回这个空间？

对于那些不熟悉 DBCC CLEANTABLE 的人，MS 有一篇很好的文章，其中包含针对 AdventureWorks 的示例代码。

[http://msdn.microsoft.com/en-us/library/ms174418(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms174418(SQL.90).aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T14:47:36.380

如果 DBCC 不起作用，请重建聚集索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T14:57:45.033

由于 BOL 指定 CLEANTABLE 仅从可变长度列中释放页面。您的数据库可能是碎片化的，这通常发生在数据库操作期间。看起来 SQL Server 认为碎片页面正在使用中，并且不将其显示为可用空间（顺便说一下 sp_spaceused 调用此未分配空间）

您可以使用 DBCC SHOWCONTIG 查看表的碎片化程度。

通过重新构建数据库中的所有索引，您将摆脱碎片，当您将这些数据复制到其他地方时会发生这种情况。

# svn - 如何将 SVN 存储库迁移到另一个 SVN 存储库？

> ID：939963
> 
> 赞同：62
> 
> 时间：2009-06-02T14:43:26.747
> 
> 标签：svn, svnadmin, svndump, svndumpfilter

有没有一种简单的方法可以将目录从一个存储库复制到另一个存储库并复制所有历史记录？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-06-02T14:48:05.473

最简单的方法是使用：

```
svnadmin dump path/to/repos > repos.out 
```

这将为文件中的存储库（带有历史记录）创建可移植格式`repos.out`。然后你可以使用

```
svnadmin load path/to/newrepos < repos.out 
```

将您的“转储”存储库加载到新的或现有的存储库。

[Chapter 5\. Repository Maintenance -> Migrating Repository Data Elsewhere](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.migrate)有关于使用`svnadmin dump`1.7 版的说明：

> Subversion 存储库转储格式仅描述版本化存储库更改。它不会携带有关未提交事务、文件系统路径上的用户锁定、存储库或服务器配置自定义（包括挂钩脚本）等的任何信息。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-06-02T15:14:46.417

正如[Subversion 书中](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.maint.html "存储库维护")所建议的：

```
svnadmin dump path/to/repos_src \
    | svndumpfilter include path/inside/svn/to/directory \
    | svnadmin load path/to/repos_dst 
```

举个例子：

```
svnadmin dump /var/lib/svn/old_repo \
    | svndumpfilter include trunk/my_project/common_dir \
    | svnadmin load /var/lib/svn/new_repo 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-06-02T14:49:16.453

如果您不想要历史记录，您可以使用`svn export`获取一个没有文件夹的干净文件`.svn`夹，然后`svn import`进入您的其他存储库。

有了历史，您将需要使用`svnadmin dump`. 然后，您将[`svndumpfilter`](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.filtering)在使用`svnadmin load`.

阅读主题：

*   [将存储库数据迁移到其他地方](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.migrate)
*   [过滤存储库历史](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.filtering)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-06-29T16:57:35.207

使用[`svnsync`— Subversion Repository Mirroring](http://svnbook.red-bean.com/en/1.7/svn.ref.svnsync.html)命令：

> `svnsync`是 Subversion 远程仓库镜像工具。简而言之，它允许您将一个存储库的修订重播到另一个存储库中。

该`svnsync`命令的 Subversion 文档有以下警告（从 1.7 版开始），暗示一旦使用其他一些 SVN 命令修改镜像存储库，`svnsync`不应再次与该特定镜像一起使用：

> `svnsync`对镜像存储库中所做的更改非常敏感，这些更改不是作为镜像操作的一部分进行的。为防止这种情况发生，最好该`svnsync`进程是允许修改镜像存储库的唯一进程。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-07-10T04:11:28.467

在 Subversion 1.7 版中有一个新命令，`svnrdump`可用于访问远程存储库并生成与该`svnadmin dump`命令生成的相同的转储格式输出。这允许您使用`svnrdump`with`svnadmin load`来传输 Subversion 存储库。

请参阅[svnrdump — 远程 Subversion 存储库数据迁移](http://svnbook.red-bean.com/en/1.7/svn.ref.svnrdump.html)，其中包含对新命令的说明。

在红皮书的第 5 章中，[Migrating Repository Data Elsewhere部分有一个](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.migrate)**使用 Repository 数据迁移`svnrdump`**的子部分，其中提到：

> `svnrdump`[和]的主要区别在于`svnadmin dump`不需要直接访问存储库，而是`svnrdump` 使用与 Subversion 客户端完全相同的存储库访问 (RA) 协议进行远程操作。因此，您可能需要提供身份验证凭据。此外，您的远程交互 [原文如此] 受 Subversion 服务器上配置的任何授权限制的约束。

我还假设`svnadmin dump`有关服务器配置自定义的限制（例如挂钩可能无法转移）也适用于`svnrdump`.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-02T14:47:14.477

您可以使用 创建转储文件`svnadmin dump`，然后使用 导入到新存储库`svnadmin load`。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-02-01T10:29:18.510

我认为应该说明通过利用创建的转储文件

```
 svnadmin dump path/to/repos > dumpfile 
```

可以使用命令创建（从 svn 1.7 及以后）

```
 svnrdump dump url_to_repos > dumpfile 
```

当从远程计算机而不是服务器完成时，这很有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-06-23T12:14:16.223

要将存储库从一台服务器迁移到另一个版本，您需要遵循以下步骤。

第 1 步：将所有存储库版本转储到转储文件中。您可能在现有存储库中有数千个版本。因此，您可以使用以下脚本创建转储文件。

### 转储文件

```
# Here “i” is the version starting number, and “j” is the maximum version number of your existing #repository.
j=4999;
for ((i=0;i<=$j;i++));
do
   # your-unix-command-here
   echo $i
   svnadmin dump <old_server_repository_location > -r $i  –incremental > <dump_location>/$i.dump
done 
```

在上面的脚本中，您可能会根据可用空间获得旧存储库的完整转储，或者您可以在短时间内进行转储（即从 0-5000，然后从 5001-10000 等等）。

第 2 步：使用以下命令执行上述脚本。根据内核版本，您需要执行以下两个查询之一。

```
$ bash dump.sh > stdout.sh
$ ./sh dump.sh > stdout.sh 
```

这会将您必须使用上述命令执行的所有命令写入 stdout.sh 文件。您可以跟踪此文件以供将来参考。

第 3 步：检查防火墙是否对旧服务器和新服务器之间的端口号 22 开放。如果未打开，请让您的管理员将其设为可用。

第 4 步：现在使用以下命令将从旧 SVN 存储库生成的所有转储文件复制到新服务器。

```
$ sftp xxxx@<new_server>
Connecting to <new_server>…
Password:
sftp> mput *.dump <new_server>/dump_location 
```

在上面的命令中，`xxxx`是正在执行操作的用户。在执行 sftp 的过程中，您将转储文件从旧服务器复制到新服务器。

第 5 步：为新服务器创建一个新存储库

```
$ svnadmin create <new_repository> 
```

第 6 步：现在使用以下脚本加载所有转储文件。

### 加载.sh

```
# Here “i” is the version starting number, and “j” is the maximum version number of your existing #repository.
j=4999;
for ((i=0;i<=$j;i++));
do
   # your-unix-command-here
   echo $i
   svnadmin load –bypass-prop-validation <new_repository> < dump_location /$i.dump
done 
```

只需按照上述六个简单步骤，您就可以将现有存储库迁移到新存储库。通过此过程，您无需担心现有存储库的损坏修订。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-01-04T17:23:09.873

如果这对其他人有帮助，可以使用 svn2svn 将变更集从一个 Subversion 存储库重播到另一个：

[https://github.com/tonyduckles/svn2svn](https://github.com/tonyduckles/svn2svn)

# asp.net - 如何确定 64 位服务器上 IIS 崩溃的原因

> ID：939967
> 
> 赞同：7
> 
> 时间：2009-06-02T14:43:53.000
> 
> 标签：asp.net, iis, iis-6, crash, crash-dumps

我有一个使用 IIS 6 在 Windows server 2003 Standard x64 上运行的 .net 2.0 Web 应用程序。

我们网站的应用程序池最近开始崩溃，我无法确定原因。它开始发生在一个周末，该网站的最新版本是几天前发布的。我确定最近没有对服务器进行其他更改，包括代码和 Microsoft 更新。

每当发生崩溃而数据块中没有其他信息时，事件日志都会显示以下内容：

> 错误应用程序 w3wp.exe，版本 6.0.3790.3959，标记 45d691cc，错误模块 kernel32.dll，版本 5.2.3790.4062，标记 462643a7，调试？0，故障地址0x0000000000027d8d。

这是在 x64 服务器上运行的，所以我不能使用任何标准的调试诊断工具，因为即使它有 64 位版本，它也只能连接到以 32 位模式运行的 IIS。

我尝试使用 Windows 调试工具 (x64) 并能够附加到 w3wp 进程，并等待另一次崩溃。但是，这大大降低了服务器的速度，以至于它无法使用，所以我不得不停止它。

我可以使用哪些其他方法来尝试确定 IIS 崩溃的原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-02T15:15:25.997

阅读[ASP.NET 2.0 崩溃案例研究：未处理的异常](http://blogs.msdn.com/tess/archive/2006/04/27/asp-net-2-0-crash-case-study-unhandled-exceptions.aspx)。

> 策略#1 – 记录异常
> 第一种方法，也是我可能推荐的方法，是创建一个 UnhandledExceptionHandler 来在事件日志中记录异常及其堆栈跟踪，如本文 [http://support 所示。 microsoft.com/?id=911816](http://support.microsoft.com/?id=911816) 您将这样的处理程序添加到 web.config：
> 
> ```
> <system.web>
>   <httpModules>
>     <add type="WebMonitor.UnhandledExceptionModule, <strong name>"
>        name="UnhandledExceptionModule"/>
>   </httpModules>
>       …
> </system.web> 
> ```
> 
> 并且它将事件处理程序连接到当前应用程序域的 UnhandledException 事件。您实际上不需要对其进行强命名并将其添加到 GAC，但是如果您在多个应用程序中计划它，您应该避免多次加载 dll。现在，下次您遇到这些未处理的异常之一时，该进程仍将退出（除非您更改未处理的异常策略），但您很有可能解决问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-04T20:36:00.137

Microsoft 的[调试诊断工具 (DebugDiag)](https://www.microsoft.com/en-us/download/details.aspx?id=49924)可以解决问题。它将提供 IIS 内存转储和分析。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T15:18:53.010

您可以设置性能计数器来监控 CPU、内存和 .NET 特定计数器等内容。有很多细节，但这篇 TechNet 文章可能会有所帮助：

*   [监控 ASP.NET 性能 (IIS 6.0)](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/97d0872a-96b3-41e4-8997-b174a9dbb87f.mspx?mfr=true)

ASP.NET 本身具有用于监视应用程序运行状况的完整命名空间。您可以创建自己的事件，或者最常见的情况是，为您的应用程序配置默认事件。这篇 MSDN 文章有更多内容：

*   [ASP.NET 运行状况监视概述](http://msdn.microsoft.com/en-us/library/bb398933.aspx)

如果问题是应用程序代码，例如未处理的异常（尽管如果这是您的问题，我希望在 Windows 事件日志中看到更多详细信息），您可以使用工具来捕获和报告它们。[ELMAH](http://www.raboof.com/projects/Elmah/)是我过去为此使用的一个很好的工具。它被描述为[用于 Web 应用程序的 Tivo，](http://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx)并且有多种方式来提供异常的详细信息并帮助追踪问题所在。

# javascript - 如何在 IE 中设置浏览器选项卡的焦点？

> ID：939971
> 
> 赞同：0
> 
> 时间：2009-06-02T14:46:57.567
> 
> 标签：javascript, internet-explorer, dom

Setfocus() 仅适用于窗口，不适用于浏览器选项卡。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T14:50:35.517

如果你在谈论切换标签，你不能这样做。对不起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T15:09:41.623

如果这仅适用于 IE 和您对软件版本等具有重大控制权的 Intranet，则您可以通过为 IE 制作插件来解决此问题。

# php - 建立基于 Paypal 的会员网站 - 总菜鸟 - 将不胜感激

> ID：939972
> 
> 赞同：2
> 
> 时间：2009-06-02T14:46:57.643
> 
> 标签：php, paypal, membership, paypal-subscriptions

这是对我关于贝宝集成的问题的跟进。我正在为赛车迷开发会员网站。我的会员网站有 3 个会员级别——免费、黄金和高级。当用户注册时，他/她可以当场获得免费会员资格，但可以选择升级为每月 4 美元的金会员或每月 10 美元的高级会员。

不过，我已经阅读了几次贝宝集成指南，并且对如何使其发挥作用有一个模糊的理解。我认为定期付款选项就足够了 - 但是我不知道如何在我的系统中实现它。

就像当用户决定使用付费帐户时，即从基本的黄金或高级帐户 - 我应该在我的代码方面和贝宝帐户方面做什么 - 如果有人能概述我必须做的事情，我将不胜感激这里。

另外，当用户决定从让我们说黄金帐户升级到高级帐户时 - 存在计算升级他/她的帐户应该收取多少费用的问题，例如：用户已被收取 4 美元的费用，第二天选择去一个保费账户，所以假设本月剩余时间的盈余是 5 美元，而且所有付款将每月重复 10 美元 - 我该如何实施？

如果用户决定从每月 10 美元的高级帐户降级到每月 4 美元的黄金帐户 - 我如何处理仅当月必须退还的盈余并更改会员资格？

同样明智的是，如果有人希望取消会员资格并去拥有一个免费帐户 - 我如何退还欠款并取消订阅。

如果这听起来像是我要求用勺子喂食，我很抱歉:(我对此很陌生，这是针对客户的，我非常感谢这里的所有帮助，并且真的必须让这个工作正常。

再次感谢大家 - 等待您的所有回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T15:38:23.443

您需要开始阅读[即时付款通知](https://www.paypal.com/ipn)(IPN)。当发生某种交易时，这基本上只是从 PayPal 到您的网站的回调。

您需要的是您网站上的一个 php 脚本，您可以在您的 paypal 帐户中注册它。PayPal 将使用信息调用此脚本，然后您将信息发送回 PayPal，让他们知道交易是否正常。在执行此操作时，您有各种方法可以拦截发生的事情。

如果客户购买了产品 X，在您的情况下，X 可能是“黄金会员”，您可以检查您的数据库（假设您有一些 php/mysql 或类似设置），如果该特定客户已经拥有产品 Y，您应该退还 blabla。这个逻辑完全取决于你。由于它是一个 php 脚本，因此您可以访问 php 也可以访问的任何内容，读取/写入数据库、文件、邮件等。

还有各种支持此 IPN 的软件包。我相信 ColdFusion 就是其中之一。

干杯！

编辑：

> 很好的建议 - 但是考虑到我的情况，我想知道什么是最简单和最轻松的方法，即我应该使用定期计费还是让客户定期付款。我对所有选项持开放态度，更好的是我可以直接使用的任何代码示例:)

我个人会选择客户认为最简单的方法。使用定期计费适用于爱情和婚介网站，这些网站想要利用您作为人类最深切的感受。“当客户忘记了他的帐户时，我们可以给他额外的时间”（坐在他邪恶的窝里的轮椅上，大声笑着 muahahaha 并拍了拍他的白猫）。

这是一个可以用作 IPN 接收器的快速[php 框架。](http://www.pdncommunity.com/pdn/board/message?board.id=samplecode&thread.id=14)

编辑2

> 好的，所以定期计费不是一个好主意：-S - 我的意思是定期计费，我认为我们无法在我们的网站上维护客户何时计费的历史记录，是吗？

当然，你可以保留这方面的历史。您知道客户第一次开始付款的时间，并且您可以在客户再次开具发票/账单时在内部进行跟踪。这只是与第一次付款日期的定期检查。

编辑3

> 因此，在这种情况下，我最好采用我之前的想法，即允许客户提前支付 3、6、12 个月的费用，并在接近让他/她续订的时候进行检查。很酷 - 所以在那种情况下，我不会使用贝宝的定期订阅服务，而是使用他们的“立即购买”按钮或排序 :-S 是否有任何免费书籍关于如何做到这一点？我似乎有把事情复杂化的坏习惯。

是的。立即购买按钮非常适合与 IPN 一起使用。我认为您可以为不同的按钮设置不同的 IPN 处理程序（例如不同的 php 页面）。免费书籍？就像那些用纸做的旧东西一样？;) 网上有很多信息。PayPal 有关于如何开始的教程。PayPal 还有一个“沙盒”站点，您可以在其中创建测试按钮，对您的站点产生虚假交易。您将需要使用它。

编辑4

> 非常感谢你的好建议 - 我越简单，我遇到的问题就越少。如果我需要更多建议，我会再次对 SO 大喊大叫。我曾经在 2Checkout 工作过一次，但那是在已经构建的代码上，所以我对正在发生的事情有一个模糊的概念 - 这是我第一个使用 paypal 的项目 - 啊，学习永远不会太晚:)

最后一件事。确保您从一开始就设置了基本的日志记录功能，这样您就可以将数据转储到文件中并查看发生了什么，以及 PayPal 发送给您的数据类型。这对我帮助很大。它不必太高级，只需一个简单的文本文件就可以了。否则，“调试”这些事务可能会很痛苦。“FTW现在正在进行吗？” :)

祝你好运 ！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T15:09:07.350

我相当肯定有各种内容管理系统和社区的会员模块/附加组件/扩展/等，错误..管理系统添加了这个功能。

如果您基于像 Wordpress 这样的预制解决方案，只需在 google 上搜索[Wordpress 付费会员](http://www.google.co.uk/search?q=wordpress+paid+membership)，您就会发现各种插件可以为您完成 90% 的工作。

我应该补充一点，考虑到这些几乎总是用于商业用途，您可能必须为获得最佳结果付费。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T15:01:12.060

也许您最好自己管理订阅。让客户通过“调用”该月订阅的 Paypal 付款来每月付款。我认为这将解决您的大部分问题；）

**更新**：当然有很多网站提供了很好的信息，例如： [http ://ezinearticles.com/?PayPal---How-to-Setup-PayPal-on-Your-Website-in-Less-Than-30-Minutes&id =1704708](http://ezinearticles.com/?PayPal---How-to-Setup-PayPal-on-Your-Website-in-Less-Than-30-Minutes&id=1704708)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-04T17:02:33.307

阿里，如果你对这些类型的东西不熟悉，一定要使用 CMS 和模块。Drupal 是当今会员网站的最佳平台，我制作了一个集成了 Paypal 订阅系统的模块。检查一下，看看它是否有你需要的东西：[http](http://www.moneyscripts.net/drupal-paypal-subscriptions) ://www.moneyscripts.net/drupal-paypal-subscriptions （包括截图）

# firefox - 移植 ActiveX 控件以在多浏览器上运行

> ID：939974
> 
> 赞同：2
> 
> 时间：2009-06-02T14:47:02.853
> 
> 标签：firefox, activex, cross-browser

我目前有一个 ActiveX 控件，它链接许多 c/c++ dll。问题是我们现在需要这个控件在 IE 以外的浏览器（最重要的是 Firefox）上运行。

正如我所看到的，我有以下选择：

*   将控件编写为 Firefox 插件。这似乎是最快的，但随后会将我们与 Mozilla 紧密结合。
*   在 Silverlight 或 flex 中完全重写。由于我们控件的大小可能会花费太长时间。
*   创建一个混合的客户端和服务器端解决方案，使用 JavaScript 作为 UI，类似于 Google Docs。

只是想知道是否有其他人试图解决移植 ActiveX 控件的问题？如果有的话，他们可以提供什么建议？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T14:50:08.917

将其设为 Netscape 插件（请参阅[http://www.mozilla.org/projects/plugins/](http://www.mozilla.org/projects/plugins/)），它将适用于除 IE 之外的所有主流 Windows 浏览器（以及其他平台上的浏览器，如果您可以将代码移植到那些平台）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-27T18:04:07.347

使用 FireBreath：[http ://www.firebreath.org](http://www.firebreath.org)

它旨在准确解决您的问题；您在 firebreath 抽象下实现所有内容。如果您需要的任何功能不受支持，或者您不知道如何使用 FireBreath，那么开发列表非常适合快速回答查询。而且，由于它是开源的（但已获得许可，因此您不必开源代码），您也可以自己进行更改。

使用 firebreath 编写的任何内容都可以在 IE、Firefox、Chrome、Safari 和可能的 Opera 上运行（Opera 不能 100% 正确实现 NPAPI；只需稍加工作就可以使其全部兼容）。

# windows - 将进程的父进程更改为 explorer.exe

> ID：939978
> 
> 赞同：0
> 
> 时间：2009-06-02T14:47:29.733
> 
> 标签：windows, winapi, process

我正在使用 CreateProcess 来执行 Notepad.exe，但记事本的父进程是我自己的 AP。当我关闭自己的AP时，记事本的进程父级变成了资源管理器。我将如何将资源管理器作为这个新打开的进程的父进程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T21:56:53.103

这个问题没有意义。Windows 没有像其他操作系统那样在进程之间建立真正的父子关系。顺便说一句，一些关于启动进程的信息被保留了，但是，在 CreateProcess 启动代码之外，从父进程复制句柄和环境，进程之间没有进一步的特殊关系。他们完全独立地作为同龄人运行。

一些任务管理器确实显示了暗示父子关系持续存在的层级关系，但最终这只是通过扫描进程创建信息列表以查看是否可以找到暗示其他进程是它们的创建者的匹配项 - 因此是父进程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T01:31:51.173

尝试使用 CreateRemoteThread() 在 explorer.exe 的地址空间内创建一个新线程（如果它正在运行），然后让该线程启动记事本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T14:56:17.797

没有内置方法可以立即将 explorer.exe 设置为父进程。但是，据我所知，您可以使用 p/invoke 进行一些调用来完成此操作。

这是[一篇](http://www.dotnet247.com/247reference/msgs/32/160308.aspx)关于使用 p/invoke 以另一个用户身份启动的实现的文章。这让您了解 p/invoke 过程。然后这里有[一篇文章](http://winprogger.com/?p=311)讲的是启动一个非子进程。您可以结合两者的信息来实现您想要的目标。

# archive - 如何在不包括目录本身的情况下对文件和文件夹的目录进行 tar？

> ID：939982
> 
> 赞同：452
> 
> 时间：2009-06-02T14:48:04.007
> 
> 标签：archive, tar, gzip

我通常这样做：

```
tar -czvf my_directory.tar.gz my_directory 
```

如果我只想在 my_directory 中包含所有内容（包括任何隐藏的系统文件），而不是目录本身，该怎么办？我不想要：

```
my_directory
   --- my_file
   --- my_file
   --- my_file 
```

我想：

```
my_file
my_file
my_file 
```

* * *

## 回答 #1

> 赞同：745
> 
> 时间：2010-06-14T06:54:08.510

使用`-C`tar 的开关：

```
tar -czvf my_directory.tar.gz -C my_directory . 
```

`-C my_directory`告诉 tar 将当前目录更改为，`my_directory`然后`.`表示“添加整个当前目录”（包括隐藏文件和子目录）。

确保你在做`-C my_directory`之前做`.`，否则你会得到当前目录中的文件。

* * *

## 回答 #2

> 赞同：261
> 
> 时间：2009-06-03T13:46:20.460

```
cd my_directory/ && tar -zcvf ../my_dir.tgz . && cd - 
```

应该在一条线上完成这项工作。它也适用于隐藏文件。至少在 bash 中，“*”不会通过路径名扩展来扩展隐藏文件。下面是我的实验：

```
$ mkdir my_directory
$ touch my_directory/file1
$ touch my_directory/file2
$ touch my_directory/.hiddenfile1
$ touch my_directory/.hiddenfile2
$ cd my_directory/ && tar -zcvf ../my_dir.tgz . && cd ..
./
./file1
./file2
./.hiddenfile1
./.hiddenfile2
$ tar ztf my_dir.tgz
./
./file1
./file2
./.hiddenfile1
./.hiddenfile2 
```

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2009-06-02T15:01:25.853

您还可以像往常一样创建存档并使用以下命令提取它：

```
tar --strip-components 1 -xvf my_directory.tar.gz 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2016-09-16T11:30:06.160

# TL;DR（没有`./`也没有`./file1`！）

```
find /my/dir/ -printf "%P\n" | tar -czf mydir.tgz --no-recursion -C /my/dir/ -T - 
```

在某些条件下（仅归档文件、目录和符号链接）：

```
find /my/dir/ -printf "%P\n" -type f -o -type l -o -type d | tar -czf mydir.tgz --no-recursion -C /my/dir/ -T - 
```

# 解释

不幸的是，以下内容`./`在存档中包含了一个父目录：

```
tar -czf mydir.tgz -C /my/dir . 
```

您可以使用`--transform`配置选项将所有文件移出该目录，但这不会摆脱`.`目录本身。驯服命令变得越来越困难。

您可以使用`$(find ...)`将文件列表添加到命令中（如在[magnus 的回答](https://stackoverflow.com/a/19692619/1000608)中），但这可能会导致“文件列表太长”错误。最好的方法是将它与 tar 的`-T`选项结合起来，如下所示：

```
find /my/dir/ -printf "%P\n" -type f -o -type l -o -type d | tar -czf mydir.tgz --no-recursion -C /my/dir/ -T - 
```

基本上，它的作用是列出目录下的所有文件（`-type f`）、链接（`-type l`）和子目录（`-type d`），使用 使所有文件名相对`-printf "%P\n"`，然后将其传递给 tar 命令（它使用来自 STDIN 的文件名`-T -`）。需要该`-C`选项，以便 tar 知道具有相对名称的文件所在的位置。该`--no-recursion`标志是为了使 tar 不会递归到它被告知归档的文件夹中（导致重复文件）。

如果你需要对文件名做一些特殊的事情（过滤，跟随符号链接等），这个`find`命令非常强大，你可以通过删除`tar`上面命令的一部分来测试它：

```
$ find /my/dir/ -printf "%P\n" -type f -o -type l -o -type d
> textfile.txt
> documentation.pdf
> subfolder2
> subfolder
> subfolder/.gitignore 
```

例如，如果要过滤 PDF 文件，请添加`! -name '*.pdf'`

```
$ find /my/dir/ -printf "%P\n" -type f ! -name '*.pdf' -o -type l -o -type d
> textfile.txt
> subfolder2
> subfolder
> subfolder/.gitignore 
```

# 非 GNU 查找

该命令使用`printf`（在 GNU`find`中可用）告诉`find`使用相对路径打印其结果。但是，如果您没有 GNU `find`，这可以使路径相对（使用 删除父级`sed`）：

```
find /my/dir/ -type f -o -type l -o -type d | sed s,^/my/dir/,, | tar -czf mydir.tgz --no-recursion -C /my/dir/ -T - 
```

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2013-10-30T19:53:56.707

看看`--transform`/ `--xform`，它让您有机会在文件添加到存档时按摩文件名：

```
% mkdir my_directory
% touch my_directory/file1
% touch my_directory/file2
% touch my_directory/.hiddenfile1
% touch my_directory/.hiddenfile2
% tar -v -c -f my_dir.tgz --xform='s,my_directory/,,' $(find my_directory -type f)
my_directory/file2
my_directory/.hiddenfile1
my_directory/.hiddenfile2
my_directory/file1
% tar -t -f my_dir.tgz 
file2
.hiddenfile1
.hiddenfile2
file1 
```

变换表达式类似于`sed`，我们可以使用除`/`(`,`上例中的) 以外的分隔符。
[https://www.gnu.org/software/tar/manual/html_section/tar_52.html](https://www.gnu.org/software/tar/manual/html_section/tar_52.html)

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2009-06-02T14:53:38.223

```
cd my_directory
tar zcvf ../my_directory.tar.gz * 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2012-03-19T19:22:17.253

[这个答案](https://stackoverflow.com/a/944847)应该在大多数情况下都有效。但是请注意文件名是如何存储在 tar 文件中的，例如，`./file1`而不仅仅是`file1`. [我发现当使用此方法来操作在BuildRoot](http://buildroot.uclibc.org/)中用作包文件的 tarball 时，这会导致问题。

一种解决方案是使用一些 Bash glob 来列出所有文件，除了`..`这样的文件：

```
tar -C my_dir -zcvf my_dir.tar.gz .[^.]* ..?* * 
```

这是我从[这个答案](https://stackoverflow.com/a/2910105/991411)中学到的一个技巧。

现在 tar 如果没有匹配的文件，将返回一个错误`..?*`or `.[^.]*`，但它仍然可以工作。如果错误是一个问题（您正在检查脚本是否成功），则此方法有效：

```
shopt -s nullglob
tar -C my_dir -zcvf my_dir.tar.gz .[^.]* ..?* *
shopt -u nullglob 
```

虽然现在我们正在搞乱 shell 选项，但我们可能会认为`*`匹配隐藏文件会更整洁：

```
shopt -s dotglob
tar -C my_dir -zcvf my_dir.tar.gz *
shopt -u dotglob 
```

这可能不适`*`用于当前目录中的 shell glob，因此，或者，使用：

```
shopt -s dotglob
cd my_dir
tar -zcvf ../my_dir.tar.gz *
cd ..
shopt -u dotglob 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-02-09T17:19:47.300

```
cd my_directory && tar -czvf ../my_directory.tar.gz $(ls -A) && cd .. 
```

这个对我有用，它包含所有隐藏文件，而不将所有文件放在名为“。”的根目录中。就像在[tomoe 的回答](https://stackoverflow.com/a/944847/7541688)中一样：

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-02T16:38:22.467

如果它是 Unix/Linux 系统，并且您关心隐藏文件（将被 * 忽略），您需要执行以下操作：

```
cd my_directory
tar zcvf ../my_directory.tar.gz * .??* 
```

我不知道隐藏文件在 Windows 下是什么样子的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-02-27T10:46:45.633

我会提出以下 Bash 函数（第一个参数是目录的路径，第二个参数是生成的存档的基本名称）：

```
function tar_dir_contents ()
{
    local DIRPATH="$1"
    local TARARCH="$2.tar.gz"
    local ORGIFS="$IFS"
    IFS=$'\n'
    tar -C "$DIRPATH" -czf "$TARARCH" $( ls -a "$DIRPATH" | grep -v '\(^\.$\)\|\(^\.\.$\)' )
    IFS="$ORGIFS"
} 
```

你可以这样运行它：

```
$ tar_dir_contents /path/to/some/dir my_archive 
```

它将`my_archive.tar.gz`在当前目录中生成存档。它适用于隐藏 (.*) 元素和文件名中带有空格的元素。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-12-19T14:06:18.127

## 命令

创建标准存档文件。

`find my_directory/ -maxdepth 1 -printf "%P\n" | tar -cvf my_archive.tar -C my_directory/ -T -`

打包的文件和目录位于存档的根目录中，没有路径信息，更深的文件具有相对路径。
文件和目录前面没有奇怪的“./”。('./file')
没有特殊文件 '.' 被包含在内。

似乎需要另一个工具，如`find`or `ls`( `ls -A -1`) 来实现这些目标，并且`tar`仅使用其参数无法选择文件并创建具有此类要求的存档。

使用上述命令会创建一个归档 tar 文件，该文件可以进一步处理或交付给某人，而不会看起来很奇怪，也不需要解释或解包工具。

## 参数说明

`-maxdepth 1`
最多下降 1 级 - 无递归。在标准输出文件名上
`-printf`
打印**格式**
`%P`， 并在其下找到它的起始点的名称已被删除。
`\n` 换行符
printf 不在字符串末尾添加换行符。必须在此处添加

tar:
`-C DIR`,`--directory=DIR`
切换到目录 DIR

`-T FILE`，从管道中`--files-from=FILE`
获取名称以从 FILE 中提取或创建，
`-`
上面的 FILE 是**标准输入**

## 对其他解决方案的评论。

使用@aross 描述的解决方案可能会获得相同的结果。
这里与解决方案的区别在于哪个工具正在执行递归。如果您将作业留给`find`，则每个文件路径名称都会通过管道。它还发送所有目录名称，带有 --no-recursion 的 tar 忽略或添加为空目录，然后是每个目录中的所有文件。如果从 读取的文件中出现意外输出错误`find`，则 tar 不会知道或关心发生了什么。
但是通过进一步的检查，比如处理来自 find 的错误流，这可能是一个很好的解决方案，其中需要对文件进行许多选项和过滤器。
我更喜欢将递归保留在 tar 上，它看起来确实更简单，因此更稳定的解决方案。
以我复杂的目录结构，当 tar 不会报错时，我更有信心归档完整。

使用@serendrewpity 提出的另一种解决方案`find`似乎很好，但它在带有空格的文件名上失败。不同之处在于`find`$() 子 shell 提供的输出是按空间划分的。可以使用 printf 添加引号，但这会使语句更加复杂。

没有理由 cd 进入 my_directory 然后返回，同时使用 ../my_archive.tar 作为 tar 路径，因为 TAR 具有`-C DIR`,`--directory=DIR`命令，该命令仅用于此目的。

使用`.`(dot) 将包括点

使用 * 会让 shell 提供输入文件列表。可以使用 shell 选项来包含点文件。但这很复杂。该命令必须在允许的 shell 中执行。启用和禁用必须在 tar 命令之前和之后完成。如果未来存档的根目录包含太多文件，它将失败。

最后一点也适用于所有不使用管道的解决方案。

大多数解决方案都是在其中创建一个目录，其中包含文件和目录。这几乎是不可取的。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2021-02-05T23:37:21.567

```
cd DIRECTORY
tar -czf NAME.tar.gz  * 
```

星号将包括所有内容，甚至是隐藏的内容

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-05-16T22:19:53.947

这对我有用。

```
tar -cvf my_dir.tar.gz -C /my_dir/ $(find /my_dir/ -maxdepth 1 -printf '%P ') 
```

你也可以使用

```
tar -cvf my_dir.tar.gz -C /my_dir/ $(find /my_dir/ -mindepth 1 -maxdepth 1 -printf '%P ') 
```

在第一个命令中，***find返回******my_dir***的文件和子目录列表。但是，目录***my_dir***本身作为 '.' 包含在该列表中。***-printf***参数删除包含“.”的完整路径。还有所有[crlf](/questions/tagged/crlf "显示标记为“crlf”的问题") 但是***printf***的格式字符串***“%P”***中的[空格在](/questions/tagged/space "显示标记为“空间”的问题")***my_dir***的文件和子目录列表中留下了残留物，并且可以通过***find***命令结果中的前导空格看到。

 ***这对 TAR 来说不是问题，但如果你想解决这个问题，请在第二个命令中添加***-mindepth 1 。***

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-02-17T16:49:59.307

```
tar -czvf mydir.tgz -C my_dir/ `ls -A mydir` 
```

在 mydir 上一层运行它。这不包括任何 [.] 或东西。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-01-07T16:50:07.497

使用派克斯。

Pax 是一个已弃用的软件包，但它以一种简单的方式完美地完成了这项工作。

```
pax -w > mydir.tar mydir 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-08-23T18:04:20.623

```
# tar all files within and deeper in a given directory
# with no prefixes ( neither <directory>/ nor ./ )
# parameters: <source directory> <target archive file>
function tar_all_in_dir {
    { cd "$1" && find -type f -print0; } \
    | cut --zero-terminated --characters=3- \
    | tar --create --file="$2" --directory="$1" --null --files-from=-
} 
```

安全地处理带有空格或其他异常字符的文件名。您可以选择`-name '*.sql'`向 find 命令添加一个或类似的过滤器以限制包含的文件。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-05-16T12:45:59.560

我发现的最简单的方法：

cd my_dir && tar -czvf ../my_dir.tar.gz *

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-01-08T19:39:01.463

```
function tar.create() {
        local folder="${1}"

        local tar="$(basename "${folder}")".tar.gz

        cd "${folder}" && tar -zcvf "../${tar}" .; cd - &> /dev/null
} 
```

例子：

```
tar.create /path/to/folder 
```

不客气。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2013-02-13T21:37:00.250

```
 tar -cvzf  tarlearn.tar.gz --remove-files mytemp/* 
```

如果文件夹是 mytemp，那么如果您应用上述内容，它将压缩并删除文件夹中的所有文件，但不要管它

```
 tar -cvzf  tarlearn.tar.gz --remove-files --exclude='*12_2008*' --no-recursion mytemp/* 
```

您可以提供排除模式，也可以指定不查看子文件夹

* * *

## 回答 #20

> 赞同：-5
> 
> 时间：2009-06-02T15:05:44.470

```
tar -C my_dir -zcvf my_dir.tar.gz `ls my_dir` 
```

# c - 将 GCC 调用为“cc”与“gcc”

> ID：939989
> 
> 赞同：70
> 
> 时间：2009-06-02T14:49:11.633
> 
> 标签：c, linux, gcc, compiler-construction, gnu

我知道在大多数 GNU/Linux 系统上，可以从命令行通过名称“cc”调用 GCC（而不是“gcc”）。当 GCC 以一种方式与另一种方式调用时，它的行为有什么不同吗？

例如，我知道通过名称“g++”而不是“gcc”调用 GCC 会导致 GCC 的行为不同（它将 .c 文件视为 C++ 源代码和 C++ 标准库中的链接）。“gcc”与“cc”之间的行为是否有类似的差异？

**编辑：**到目前为止收到的答案都没有给出*明确*的“是”或“否”，即如果以一种方式调用与另一种方式调用，GCC 的行为是否会有所不同。然而，深入研究源代码以检查其行为的想法使我走上了这条路。根据我在那里的发现，我现在相信答案是：

**不。无论是通过 "gcc" 还是 "cc" 调用 GCC，它的行为都是相同的**。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-02T15:41:56.207

`argv[0]`对于咧嘴笑，我只是从 gcc ( [`main.c`](http://www.koders.com/c/fidF9A47C3300302CAAE31390DBB8C872977D7CD222.aspx?s=cdef%3atree)-> `top_lev.c`-> `opts.c`-> ) 中追踪了如何使用`langhooks.c`它，它似乎`argv[0]`目前仅用于`malloc`在失败时提供一些报告。`argv[0]`如果不是. ，则似乎没有任何行为变化`gcc`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-02T15:07:23.953

在我看来[`cc`](http://opengroup.org/onlinepubs/007908799/xcu/cc.html)（链接到一些旧的 SUS 规范）旨在成为系统编译器的供应商中立接口。它被标记为旧版：

> c89 实用程序提供了与 ISO C 标准的接口，但 cc 实用程序接受 C 语言的未指定方言：它可能是标准 C、通用 C 或其他一些变体。可移植 C 程序的编写应符合 ISO C 标准并使用 c89 编译。

POSIX 有一个名为的实用程序[`c99`](http://www.opengroup.org/onlinepubs/009695399/utilities/c99.html)，我相信它是`c89`. 它说

> c99 实用程序基于最初在 ISO POSIX-2:1993 标准中引入的 c89 实用程序。c89 的一些变化包括对标准库部分内容的修改，以考虑新的标题和选项；例如，添加到 -l rt 操作数，以及为跟踪函数添加 -l 跟踪操作数。

我对所有这些不同的标准都不是很熟悉，但看起来更新的 SUSv3（[POSIX:2004](http://en.wikipedia.org/wiki/POSIX#POSIX:2004)）和更新的[POSIX:2008](http://en.wikipedia.org/wiki/POSIX#POSIX:2008)（似乎还没有 SUS 编号）没有指定实用程序不再调用`cc`，但只有实用程序调用`c99`. 顺便说一句，我的 Linux 系统 ( [Arch_Linux](http://en.wikipedia.org/wiki/Arch_Linux) ) 包含`c99`但 not的联机帮助页`c89`，但只包含一个名为`cc`, but not `c89`nor的实用程序`c99`。那里有很多混乱:)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-02T14:55:11.607

在我的 Mac 上来自`man gcc`：

> 在 Apple 的 GCC 版本中，cc 和 gcc 实际上都是指向名为 gcc-version 的编译器的符号链接。类似地，c++ 和 g++ 是指向名为 g++-version 的编译器的链接。

基于此，我假设 cc 和 gcc 的行为方式相同。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-02-28T12:18:06.050

I had the same doubt today and I tried to find it on my own:

```
$ which cc
 /usr/bin/ccc

$file /usr/bin/cc
 /usr/bin/cc: symbolic link to '/etc/alternatives/cc'

$file /etc/alternatives/cc
 /etc/alternatives/cc: symbolic link to '/usr/bin/gcc'

$which gcc
 /usr/bin/gcc 
```

So, basically `cc` points to `gcc`.

You could also check using `cc -v` and `gcc -v`. If they print out the same thing, that means they are exactly the same.

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-12-17T16:25:45.470

即使 gcc 的操作与 argv[0] 的值无关，也不是所有的软件都会以相同的方式操作，无论您指定哪个编译器。

在 RHEL 5.5 (gcc 4.1.2) 上构建 zlib 1.2.5 时：

```
$ md5sum $(which cc)
69a67d3029b8ad50d41abab8d778e799  /usr/bin/cc
$ md5sum $(which gcc)
69a67d3029b8ad50d41abab8d778e799  /usr/bin/gcc 
```

但：

```
$ CC=$(which cc) ./configure
Checking for shared library support...
Tested /usr/bin/cc -w -c -O ztest20557.c
Tested cc -shared -O -o ztest20557.so ztest20557.o
/usr/bin/ld: ztest20557.o: relocation R_X86_64_32 against `a local symbol' can not be used when making a shared object; recompile with -fPIC
ztest20557.o: could not read symbols: Bad value
collect2: ld returned 1 exit status
No shared library support; try without defining CC and CFLAGS
Building static library libz.a version 1.2.5 with /usr/bin/cc.
Checking for off64_t... Yes.
Checking for fseeko... Yes.
Checking for unistd.h... Yes.
Checking whether to use vs[n]printf() or s[n]printf()... using vs[n]printf().
Checking for vsnprintf() in stdio.h... Yes.
Checking for return value of vsnprintf()... Yes. 
```

和：

```
$ CC=$(which gcc) ./configure
Checking for shared library support...
Building shared library libz.so.1.2.5 with /usr/bin/gcc.
Checking for off64_t... Yes.
Checking for fseeko... Yes.
Checking for unistd.h... Yes.
Checking whether to use vs[n]printf() or s[n]printf()... using vs[n]printf().
Checking for vsnprintf() in stdio.h... Yes.
Checking for return value of vsnprintf()... Yes.
Checking for attribute(visibility) support... Yes. 
```

配置脚本不考虑 Linux 系统上的 cc 可能是 gcc 的可能性。所以，要小心你的假设有多远。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-02T15:15:48.757

cc 只是调用编译器的 UNIX 方式，它适用于所有 Unices。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-06-18T17:28:40.333

这个线程可能很旧，但我想添加一些东西（也许将来有人会找到它）。

如果你编译了这个程序

```
#include <stdio.h>
#include <stdlib.h>

void
myFunction(char *args)
{
   char buff1[12];
   char buff2[4] = "ABC";

   strcpy(buff1,args);

   printf("Inhalt Buffer2: %s",buff2);

}

int main(int argc, char *argv[])
{

   if(argc > 1)
   {
      myFunction(argv[1]);
   }
   else
      printf("no arguments sir daimler benz");

   getchar();

   return 0;
} 
```

使用“gcc”，并且您将“AAAAAAAAAAAAAAAAAAAAAAAAA”作为参数传递，它不会溢出到buffer2，而如果您使用“cc”编译它会溢出，这对我来说是一个提示，如果您使用“gcc”，内存管理工作方式不同，也许是通过在 buff1 和 buff2 字段的内存段之间放置空间？

也许有更多经验的人可以在这里为黑暗注入光明。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-02T15:18:21.450

GCC 文档中没有任何内容表明如果 GCC 的可执行文件名称不是*gcc*而是*cc* ，它的行为会有所不同。GNU Fortran 编译器甚至[提到](http://gcc.gnu.org/onlinedocs/gcc-4.0.4/gfortran/Getting-Started.html)：

> gcc 命令的一个版本（也可以作为系统的 cc 命令安装）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-09-09T18:35:58.363

> “不。无论是通过 'gcc' 还是 'cc' 调用 GCC，它的行为都是一样的。”
> 
> [引自原帖。]

根据我在 Ubuntu 14.04 中的经验，情况并非如此。

当我使用以下方法编译我的程序时：

```
gcc -finstrument-functions test.c 
```

我的代码行为没有任何变化。但是当我编译使用

```
cc -finstrument-functions test.c 
```

它的行为确实不同。（在这两种情况下，我都在[此处](http://codingrelic.geekhold.com/2010/09/gcc-function-instrumentation.html)描述的代码中加入了适当的更改，以使 -finstrument-functions 工作）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-02T15:06:00.897

考虑到这是来自 UNIX，我会说“cc”是通用名称，“gcc”是实际的编译器。即“gcc”提供“cc”，因此寻找“cc”的程序会找到并使用“cc”，而幸福地不知道正在使用的实际编译器。

此外，UNIX 程序应该不知道用于调用它们的实际名称（想想 Windows 桌面快捷方式——检查快捷方式的名称是没有意义的），所以，不，“gcc”和“cc”做如果“cc”是指向“gcc”的链接，也是一样的。

当然，除非“cc”不是符号链接而是调用 gcc 的 shellscript。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-03-30T14:45:21.850

对于我的操作系统（Ubuntu 14.04）`cc`不允许制表符完成，而允许`gcc`。********~~*********