# StackOverflow 问答 10298000-10298999

# arrays - MongoDB查询IN对象数组

> ID：10298001
> 
> 赞同：11
> 
> 时间：2012-04-24T12:40:18.703
> 
> 标签：arrays, mongodb, mongodb-query

我在两个集合之间检索信息时遇到问题。第一个集合存储员工信息：

```
{
        "_id" : ObjectId("4f9643967f8b9a3f0a00005a"),
        "birth_date" : "1963-09-09",
        "departments" : [
                {
                        "departments_id" : ObjectId("4f9643957f8b9a3f0a000007"),
                        "from_date" : "1990-01-03",
                        "to_date" : "1990-01-15"
                }
        ],
        "first_name" : "Parviz",
        "gender" : "M",
        "hire_date" : "1990-01-03",
        "last_name" : "Lortz",
} 
```

第二个部门信息

```
{
        "_id" : ObjectId("4f9643957f8b9a3f0a000004"),
        "dept_name" : "Marketing",
        "managers" : [
                {
                        "employees_id" : ObjectId("4f96439b7f8b9a3f0a0186a9"),
                        "from_date" : "1985-01-01",
                        "to_date" : "1991-10-01"
                },
                {
                        "employees_id" : ObjectId("4f96439b7f8b9a3f0a0186aa"),
                        "from_date" : "1991-10-01",
                        "to_date" : "9999-01-01"
                }
        ]
} 
```

我试图找到：**给定员工的所有部门**。

我试过类似的东西：

```
employees = db.employees.find({_id:ObjectId("some_id")});
db.departments.find({_id:{$in:...}}); 
```

但我不知道如何解释来自 var 员工的所有部门的 $in department_id。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T14:06:44.137

这不能通过简单的查询来完成。您将不得不遍历employees.departments，并为每次迭代将其departments_id 添加到一个数组中。然后您可以在第二行中使用该数组。最好用您选择的语言来完成。

为了使这更容易，您必须更改架构。一种选择是将部门信息存储在员工记录中，但在您的情况下，您将复制大量数据。

相反，我建议让每个部门都包含一个包含员工 ID 和日期的列表，而不是像这样：

```
{
        "_id" : ObjectId("4f9643957f8b9a3f0a000004"),
        "dept_name" : "Marketing",
        "managers" : [
        ]
        "employees" : [
            {
                    "employee_id" : ObjectId("4f9643967f8b9a3f0a00005a"),
                    "from_date" : "1990-01-03",
                    "to_date" : "1990-01-15"
            }
        ]
} 
```

在这种情况下，您可以简单地运行：

```
db.departments.find( { "employees.employee_id": ObjectId("some_id") } ); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-15T00:03:53.003

在 Mongo 3.2 中有一种简单的方法可以做到这一点，至少只需一次操作：

```
const employees = db.employees.find(); // query the employees collection
db.departments.find({
  managers: {
    $elemMatch: {
      employees_id: {
        $in: employees.map(e => e._id)
      }
    }
  }
}); 
```

`$elemMatch`修饰符（参见[ref](https://docs.mongodb.org/manual/reference/operator/projection/elemMatch/) ）有助于查询对象属性的类似数组的值。

# matlab - matlab/octave: exponential scale on x axis in plot

> ID：10298004
> 
> 赞同：1
> 
> 时间：2012-04-24T12:40:29.437
> 
> 标签：matlab, plot, scale, octave

In **Matlab** or **Octave** I want to plot a vector with an **exponential scale on the x axis**.

Changing the `xticks` and `xticklabel` do not seem to solve the problem.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T12:45:11.320

尝试使用[semilogx](http://octave.sourceforge.net/octave/function/semilogx.html)。

# c - Alpha beta 修剪根移动

> ID：10298008
> 
> 赞同：1
> 
> 时间：2012-04-24T12:40:55.057
> 
> 标签：c, artificial-intelligence, chess, alpha-beta-pruning

我目前正在编写一个国际象棋引擎并且已经取得了不错的进展，但是我遇到了一个问题，并希望对这种方式提出一些意见。好的，我的问题是我的国际象棋人工智能没有做出“最好的”举动，它似乎看不到简单的事情，比如它的棋子可能会被收回或其他什么。我的 alpha beta 修剪如下。

```
int Search (TREE *tree, int ply, int wtm, int alpha, int beta) { 
    if (0 == ply) { 
        return quiesce(tree, ply, wtm, alpha, beta); 
    } 

    movePointer = GenCaptures(tree, MAXPLY, wtm, moves); 
    movePointer = GenNonCaptures(tree, wtm, movePointer); 
    for (move = &moves[0]; move < movePointer; move++) { 
        MakeMove(tree, &tree->movePath[ply], wtm); 
        score = -Search(tree, ply - 1, Flip(wtm), -beta, -alpha); 
        UnmakeMove(tree, &tree->movePath[ply], wtm); 
        tree->movePath[ply].move = 0; 
        if (score >= beta) { 
            return beta; 
         } 
         if (score > alpha) { 
             alpha = score; 
         } 
    } 
```

我认为我的 alpha beta 修剪效果很好，因为它确实返回了合理的移动，我认为问题在于当我尝试获取我的 rootMove 时。我试图让根移动（

```
int searchRoot( TREE *tree, int ply, int wtm ) { 
    //int depth = 1; 
    int moves[220]; 
    int *movePointer = 0; 
    int *move = 0;
    int rootAlpha = -MATE - 1; 
    int rootValue = -MATE - 1; 
    int rootBeta = MATE + 1; 
    MOVE currentMove; 
    currentMove.move = 0; 
    currentMove.capture = 0; 
    movePointer = GenCaptures( tree, MAXPLY, wtm, moves ); 
    movePointer = GenNonCaptures( tree, wtm, movePointer ); 
    for ( move = &moves[0]; move < movePointer; move++ ) { 
        currentMove.move = *move; 
        tree->movePath[MAXPLY] = currentMove; 
        MakeMove( tree, &currentMove, wtm ); 
        int lastValue = -Search( tree, MAXPLY -1, Flip(wtm), rootAlpha, rootBeta ); 
        UnmakeMove( tree, &currentMove, wtm ); 
        if ( lastValue > rootValue ) { 
            tree->rootMove = *move; rootValue = lastValue; 
        } 
    } 
} 
```

任何想法都会有所帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T09:35:48.337

您的 searchRoot 没有正确实现 negamax 的想法。你的线

```
int lastValue = -Search( tree, MAXPLY -1, Flip(wtm), rootAlpha, rootBeta ); 
```

应该读

```
int lastValue = -Search( tree, MAXPLY -1, Flip(wtm), -rootBeta, -rootAlpha ); 
```

# php - 登录 - 不想重定向

> ID：10298010
> 
> 赞同：1
> 
> 时间：2012-04-24T12:41:04.163
> 
> 标签：php

**已解决：有一个愚蠢的错误导致了这个问题。在 header.php 中，我写了 $_SESSION["header"]（它甚至不存在）而不是 $_SESSION["logged"]。感谢大家的帮助。**

在我输入正确的登录信息后，Login.php 不想重定向。

该页面只是刷新并清除输入字段。

（也在 /tmp 文件夹中创建会话）

有没有人有任何想法？:S

提前致谢！:)

**登录.php：**

```
<?php

$message = NULL;

if (isset($_POST["enter"])) {

    include 'cred.php';
    $newUser = $_POST["user"];
    $newPass = md5($_POST["pass"]);

  if ($newUser==$user AND $newPass==$pass) {

    session_start();
    $_SESSION["logged"]=1;
    $_SESSION["user"]=$newUser;
    header('Location: index.php');
    exit;

  } else {

    $message = 'failure';

  }

}

?>
<head>
<style type="text/css">

body {

    margin-top:120px;

}

</style>
</head>
<body>
<center>
<form method="post" action="<?php echo $_SERVER['PHP_SELF']; ?>" enctype="multipart/form-data">
Uporabnik:<br /> <input type="text" name="user" /><br /><br />
Geslo:<br /> <input type="password" name="pass" /><br /><br />
<input type="submit" value="submit" name="enter"/><br /><br />
<?php if($message!=NULL) {echo $message;} ?>
</form>
</center>
</body> 
```

**信用.php：**

```
<?php

$user = 'janeznovak';
$pass= md5('greek123');

?> 
```

**编辑：**添加了 header.php 文件，它是每个（index.php，second.php，third.php）页面的一部分。也许问题出在这里：

```
<?php

session_start();

if(!isset($_SESSION["header"])OR $_SESSION["header"]!=1){

    header('Location: login.php');
    exit;

} else {

    $nuser = $_SESSION["user"];
}

?>
<head>
</head>
<body>
<div>
<a href="index.php">Prva</a> | 
<a href="second.php">Druga</a> | 
<a href="third.php">Tretja</a> | 
<a href="logout.php">Logout</a> | 
Prijavljeni ste kot <?php echo $nuser; ?>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T12:57:18.817

在 login.php 上再添加一个会话变量

```
 session_start();
$_SESSION["logged"]=1;
$_SESSION["header"] = 1;
$_SESSION["user"]=$newUser;
header('Location: index.php'); 
```

希望现在它会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T12:58:29.347

您是否已经尝试使用带有 action="" 而不是 action="" 的表单

还要给输入类型一个 ID 并添加 session_start(); 打开php后：

编辑：我也不明白为什么你在表单页面中使用，而你包括已经包含在其中的 header.php。

我也看不到您设置会话 $_SESSION['header'] 的任何地方？

也改变这个：

if(!isset($_SESSION["header"])OR $_SESSION["header"]!=1){

到：

```
if (!isset ($_SESSION['header'])) {

    header("Location: login.php");

} elseif ($_SESSION['header'] != 1) {

    header("Location: login.php");

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T12:44:51.683

我没有看到你在哪里包含 cred.php？在第一行代码添加 login.php：

```
include("cred.php"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T12:49:18.937

我不认为检查您的用户名和密码的 if 语句实际上评估为真。与其在那里进行重定向，不如使用 print 或 echo 语句对其进行调试。

```
if ($newUser==$user AND $newPass==$pass) {
    session_start();
    $_SESSION["logged"]=1;
    $_SESSION["user"]=$newUser;
    $message = "success";
  } 
```

如果打印语句运行，则按照其他人已经说过的方式执行并 include("cred.php"); 在页面顶部，而不是在 if 语句内。

# eclipse - Eclipse MAT：远程jvm监控

> ID：10298011
> 
> 赞同：1
> 
> 时间：2012-04-24T12:41:06.990
> 
> 标签：eclipse, eclipse-plugin, jvm, jmx, eclipse-memory-analyzer

是否可以像使用 jConsole 或 jProfiler 一样，使用该 eclipse 插件远程连接到正在运行的 jvm（启用 jmx），以监视和调试堆、线程等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:59:48.810

可能不是根据这个线程：

[http://www.eclipse.org/forums/index.php/m/565234/](http://www.eclipse.org/forums/index.php/m/565234/)

# php - 如何实现博客文章的正文以获得换行符

> ID：10298012
> 
> 赞同：1
> 
> 时间：2012-04-24T12:41:13.923
> 
> 标签：php, mysql, text, textbox, blogs

周围有几十个*PHP 博客教程*。在这些教程中，*BlogPost*对象用于表示博客的新帖子。通常，BlogPost 有一个**文本字段**来存储新帖子的正文。当然，表单用于从网页的文本框中获取文本。

通常，帖子条目分为由换行符分隔的段落。当通过网页表单发送的 POST 操作获取文本时，将其存储在数据库中（在我的例子中是 MySQL）。

当数据库检索到新帖子并显示在网页中时，不会显示所有换行符。当然，每个单独的段落都应该通过循环到正确的 HTML 标记来呈现。

如何使用 MySQL 和 PHP5 从*入口端*和*渲染端*处理这个问题？

提前致谢。

PS：我认为这个问题本质上很简单，所以让我原谅这个问题。但是，我也认识到许多问题（博客、在线新闻报纸、论坛等）都很常见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T12:44:26.253

您可以使用几个编辑器，例如[TinyMCE](http://www.tinymce.com/)，它们可以为您解决这个问题。用户似乎在一个不错的文本编辑器中输入文本，但在幕后，该字段正在填充呈现该文本所需的 html。

# c++ - 在 C++ 代码中出现歧义错误

> ID：10298019
> 
> 赞同：1
> 
> 时间：2012-04-24T12:41:27.973
> 
> 标签：c++, overloading

我们从 RogueWave 的类派生了我们自己的 Utility String`RWCString`类。派生类通过`<<`和`>>`运算符处理数字到字符串的转换。

下面是这个类的声明。

```
#ifndef UtlString_h
#define UtlString_h 1
#include "platform.h"

#ifdef WIN32
#include "Utilities.h"
#endif

#include <iostream>
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

#include "rw/cstring.h"
#include "UtlIdentifier.h"

const troint64 BIGBUF_LEN = 56000L ;

class UtlString;
unsigned UtlExport gHashString (const UtlString &);

class  UtlExport UtlString : public RWCString  
{
  public:
      UtlString ();
      UtlString (char c);
      UtlString (char c, size_t N);
      explicit UtlString (const char* cs);
      UtlString (const char *cs, size_t N);
      UtlString (const RWCString& str);
      UtlString (RWCSubString& ss);
      UtlString (float f);
      UtlString (UtlID id);
      UtlString (int i);
      UtlString (RWSize_T ic);
      UtlString (double d);
      UtlString (const UtlString& that)
      {
        this->operator =(that.data());
      }
      virtual ~UtlString();
      operator float () const;
      operator UtlID () const;
      operator int () const;
      float AsFloat () const;
      int AsInt () const;
      double AsDouble () const;
      troint64 AsLong () const;
      trouint64 AsULong () const;
      UtlString& operator << (const int value);
      UtlString& operator << (const troint64 value);
      UtlString& operator << (const float value);
      UtlString& operator << (const double value);
      UtlString& operator << (const char value);
      UtlString& operator << (const RWCString& value);
      UtlString& operator << (const short value);
      UtlString& operator << (const bool value);
      UtlString& operator << (const unsigned char value);
      UtlString& operator << (const unsigned short value);
      UtlString& operator << (const trouint64 value);
      UtlString& operator << (const char *value);
      UtlString& operator =  (const char *value)
      {
        this->remove(0,this->length());
        return *this;
      }
}; 
```

我在下面的代码中收到错误。

UtlString errMsg;

```
 errMsg = UtlString("DB Error: ")
    + UtlString(aStatus.message())
    + " ("
    + UtlString(aStatus.errorCode())
    + ") - "
    + UtlString((double)aStatus.vendorError1())
    + ": "
    + UtlString((double)aStatus.vendorError2())
    + ", "
    + UtlString(aStatus.vendorMessage1())
    + ": "
    + UtlString(aStatus.vendorMessage2()); 
```

错误：重载“UtlString::operator=(const char*)”和“UtlString::operator=(const UtlString&)”之间的歧义。

你能帮我解决这个错误吗？我不明白`UtlString::operator=(const UtlString&)`要来的地方。我从未宣布过这样的运营商。

使用 CC：Sun C++ 5.8 编译器。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-04-24T12:58:24.673

`errMsg = UtlString...`是一个初始化，因此编译器可以随意考虑复制构造函数。这就是您拥有有效赋值运算符`UtlString::operator=(const UtlString&)`的地方。

# xamarin.ios - 为无 XIB 的 MonoTouch Enterprise 应用程序自动生成 OTA 分发清单？

> ID：10298020
> 
> 赞同：1
> 
> 时间：2012-04-24T12:41:30.693
> 
> 标签：xamarin.ios, manifest, xib, ota, over-the-air

我有一个没有 XIB 的 Enterprise MonoTouch iPhone 应用程序，我需要使用清单文件通过无线方式分发它。有没有办法自动生成清单文件，或者我必须手动构建它？

帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T19:49:57.067

在过去，我只是复制了一个现有的清单并对其进行了修改。我记得清单中没有太多需要修改的地方。

# android - 如何在 GoogleMap Android 中仅显示前五个标记

> ID：10298023
> 
> 赞同：0
> 
> 时间：2012-04-24T12:41:46.010
> 
> 标签：android, google-maps, google-maps-markers

大家好，我正在使用一个 Android 应用程序，该应用程序包含一个带有数百个标记的谷歌地图。这里我能够在地图上显示所有标记。但我的要求是我必须在谷歌地图中只显示前五个标记最大缩放级别。对于经纬度在当前显示的五个标记之间的标记是豁免的。这个要求是因为如果有数千个标记，地图就会变得多云。下面是我的代码。

```
public void displayMapView(final Vector<MapData> retVector){

  mapOverlays=mapView.getOverlays();
  Drawable marker = getResources().getDrawable(R.drawable.map_pin);
  marker.setBounds((int) (-marker.getIntrinsicWidth() / 2),-marker.getIntrinsicHeight(),(int) (marker.getIntrinsicWidth() / 2), 0);
  funPlaces = new MyItemizedOverlay(marker,mapView);
  mapView.getOverlays().add(funPlaces);
  GeoPoint pt = funPlaces.getCenterPt();
  int latSpan=funPlaces.getLatSpanE6();
  int longSpan=funPlaces.getLonSpanE6();
  mc=mapView.getController();
  mc.setCenter(pt);
  mc.zoomToSpan((int)(latSpan*1.5),(int)(longSpan*1.5));
  //mc.zoomToSpan((int)(minLatitude-maxLatitude),(int)(minLatitude-maxLatitude)); 
```

}

```
@Override
protected boolean isLocationDisplayed(){
  return false;
}

@Override
protected boolean isRouteDisplayed(){
  return false;
}

public class MyItemizedOverlay extends BalloonItemizedOverlay<OverlayItem> {
  private ArrayList<OverlayItem> m_overlays = new ArrayList<OverlayItem>();
  @SuppressWarnings("unused")
  private Context c;
  private GeoPoint center = null;   
  public MyItemizedOverlay(Drawable marker,MapView mapView){
    super(boundCenter(marker),mapView);
    c = mapView.getContext();
    try{
        String name="",cusine="",distance="",price="",popUpDataNew="";
        for(int pinret=0;pinret<mpDt.size();pinret++){
          MapData retMapData=(MapData)mpDt.get(pinret);
          resId=retMapData.getId();
          name=retMapData.getName();
          cusine=retMapData.getCusine();
          distance=retMapData.getDistance();
          price=retMapData.getPrice();
          popUpDataNew=name+"/"+cusine+"/"+distance+"/"+price;
          try{
            double lat=Double.parseDouble(retMapData.getLatitude());
            double lon=Double.parseDouble(retMapData.getLongitude());
            GeoPoint pointNew= new GeoPoint((int)(lat*1E6),(int)(lon*1E6)); 
            m_overlays.add(new OverlayItem(pointNew,popUpDataNew,resId));
            populate();
          }catch(NumberFormatException nfe){
           nfe.printStackTrace();
          }
        }
       }catch(Exception e){
         e.printStackTrace();
       }    
  }
  public GeoPoint getCenterPt(){
    if(center == null){
      int northEdge = -90000000;
      int southEdge = 90000000;
      int eastEdge = -180000000;
      int westEdge = 180000000;
      Iterator<OverlayItem> iter = m_overlays.iterator();
      while(iter.hasNext()){
        GeoPoint pt = iter.next().getPoint();
        if(pt.getLatitudeE6() > northEdge)
          northEdge = pt.getLatitudeE6();
        if(pt.getLatitudeE6() < southEdge)
          southEdge = pt.getLatitudeE6();
        if(pt.getLongitudeE6() > eastEdge)
          eastEdge = pt.getLongitudeE6();
        if(pt.getLongitudeE6() < westEdge)
          westEdge = pt.getLongitudeE6();
      }
      center = new GeoPoint((int) ((northEdge + southEdge) / 2),(int) ((westEdge + eastEdge) / 2));
     }
        return center;
  } 
```

非常感谢任何建议。

感谢和问候，

文卡特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T12:50:24.380

只画前5个和只加前5个是有区别的。我不知道只画前5个，但只加5个，你不能改成`pinret < mpDt.size()`吗`pinret < 5`？显然，如果 mpDt 包含少于 5 个项目，这可能会导致问题，因此您需要进行一些边界检查

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:53:44.600

改变这个

```
 for(int pinret=0;pinret<mpDt.size();pinret++){ 
} 
```

这个，

```
 int size = mpDt.size();
 if(size > 5)
    size =5 ;
 for(int pinret=0;pinret<size;pinret++){ 
} 
```

# eclipse - Eclipse HTML 编辑器：每个在新行上标记

> ID：10298024
> 
> 赞同：23
> 
> 时间：2012-04-24T12:41:59.903
> 
> 标签：eclipse

```
<input type="button" value=" 1 " /> 
<input type="button" value=" 2 " /> 
<input type="button" value=" 3 "/> 
```

我该怎么做？

**编辑：Eclipse HTML 编辑器**

**Ctrl + Shift + F**

我想使用自动格式化，但是在我按下 **Ctrl + Shift + F**之后，我得到了类似的东西

```
<input type="button" value=" 1 " /> <input type="button" 
                value=" 2 " /> 
```

![在此处输入图像描述](../Images/a3ab195ad40b2b7c68ac4e300c42819d.png)

**我想在自动格式化后将每个 html 标签放在新行上**

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-11T16:37:05.220

从内联元素列表中删除`input`将为您解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-27T08:53:22.187

在右侧面板中转到 Window -> Preferences -> Web -> HTML Files -> Editor 将 Line Width 设置为 999 并删除内联元素列表中的输入

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2012-04-24T12:45:33.897

你甚至可以使用桌子。

```
<table>
<tr><td>
<input type="button" value=" 1 " />
</td></tr>
<tr><td>
<input type="button" value=" 2 " />
</td></tr>
<tr><td>
<input type="button" value=" 3 "/>
</td></tr> 
```

# api - 必应地图 API 密钥（凭据）

> ID：10298028
> 
> 赞同：8
> 
> 时间：2012-04-24T12:42:12.437
> 
> 标签：api, bing-maps, credentials

有没有办法保护 Bing 地图 API 密钥不被暴露给客户端？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T16:38:26.677

很简单，没有。客户端应用程序需要知道密钥才能通过 Bing 地图的服务器进行身份验证，并且由于 Javascript 代码永远无法完全混淆，因此用户始终可以从客户端的代码中提取您的密钥。

有多种方法可以从浏览源代码的人眼中隐藏您的密钥（例如 Sandeep 列出的帖子中讨论的方法），但这些方法仅对最随意的用户有效 - 使用 Firebug 等工具是一件小事为任何有动机这样做的用户揭示密钥。

# jquery - 使用 jQuery 在回发期间更改单选按钮选定的项目文本

> ID：10298030
> 
> 赞同：4
> 
> 时间：2012-04-24T12:42:32.437
> 
> 标签：jquery, asp.net, asp.net-ajax, updatepanel

我在以下代码中有一个单选按钮列表，如下所示`update panel`：

```
<asp:RadioButtonList ID="RadioButtonList1" runat="server" Width="233px" 
                ClientIDMode="Static" AutoPostBack="true" 
                onselectedindexchanged="RadioButtonList1_SelectedIndexChanged">
                <asp:ListItem Value="1">1</asp:ListItem>
                <asp:ListItem Value="2">2</asp:ListItem>
                <asp:ListItem Value="3">3</asp:ListItem>
                <asp:ListItem Value="4">4</asp:ListItem>
            </asp:RadioButtonList> 
```

我希望当用户单击此单选按钮的任何项目时`Please Wait...`显示文本而不是单选按钮文本。我编写以下代码：

```
function pageLoad() {
        $(document).ready(function () {
            $('#RadioButtonList1').on("change", function () {
                $("#RadioButtonList1 input:checked").val("Please Wait...");
            });
       });
    } 
```

但它不起作用。我的错误在哪里？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T12:46:15.727

您应该更改此代码：

```
$("#RadioButtonList1 input:checked").val("Please Wait...");

to

$("#RadioButtonList1 input:checked").parent().find('label').text("Please Wait"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T12:50:42.973

`radio`按钮值不会显示在浏览器视口上，您应该使用`label`s 并更改其文本：

```
 $(document).ready(function () {
            $('#RadioButtonList1').on("change", function () {
                $("#RadioButtonList1 input:checked").closest("label").text("Please Wait...");
            });
       }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T12:45:56.643

省略函数调用，只需在您的 javascript 代码块中使用它：

```
$(document).ready(function () {
    $('#RadioButtonList1').on("change", function () {
        $("#RadioButtonList1 input:checked").val("Please Wait...");
    }); 
```

});

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T12:49:47.713

尝试：

```
function pageLoad() {
        $(document).ready(function () {
            $('#<%=RadioButtonList1.ClientID %>').on("change", function () {
               $("#<%=RadioButtonList1.ClientID %>").find("input[checked]").val("Please Wait...");
            });
       });
    } 
```

# python - 使用 time.strptime 格式在 Python 中解析日期和时间戳

> ID：10298032
> 
> 赞同：10
> 
> 时间：2012-04-24T12:42:38.330
> 
> 标签：python, time, timezone, strptime

我的云服务器以这种格式记录时间：

```
[17/Dec/2011:09:48:49 -0600] 
```

要将其读入 Python 变量，我可以说：

```
>>>str = '17/Dec/2011:09:48:49 -0600'
>>>import time
>>>print  time.strptime(str,"%d/%b/%Y:%H:%M:%S -0600") 
```

结果：

```
time.struct_time(tm_year=2011, tm-mon=12, tm=mday=17, tm_hour=9, tm_min=48, tm_sec=49, tm_wday=5, tm_yday=351, tm_isdst=-1) 
```

或者我可以试试

```
>>>mytime = time.strptime(str,"%d/%b/%Y:%H:%M:%S -0600")
>>>print mytime.tm_hour 
```

结果：

```
9 
```

做什么的`-0600`？我希望它调整日期时间对象中的小时值？是否可以使用通配符而不是硬编码`-0600`？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-24T14:55:53.323

这`-0600`是与格林威治标准时间 (GMT) 的偏移量。正如[另一个 SO question 已经说过](https://stackoverflow.com/questions/9959778/is-there-a-wildcard-format-directive-for-strptime)的那样， time.strptime 无法读取时区偏移量，但`datetime.strftime`可以生成它们。

[正如模块文档](https://stackoverflow.com/questions/9959778/is-there-a-wildcard-format-directive-for-strptime)开头所解释的那样，[在`datetime`](https://stackoverflow.com/questions/9959778/is-there-a-wildcard-format-directive-for-strptime)python 中，有两种方法可以接近“时间”，天真或有意识。当您只关心*系统内的*时间时，处理简单的时间/日期时间对象就可以了（在这种情况下，您可以按照艾伦的建议去除偏移量）。当您需要将系统内部的值与*现实世界的时间概念进行比较时*，您必须开始处理该偏移量。

解决这个问题的*简单*方法就是[使用`python-dateutil`](http://docs.python.org/library/datetime.html#module-datetime). 它有一个[解析函数](http://labix.org/python-dateutil#head-c0e81a473b647dfa787dc11e8c69557ec2c3ecd2)，它会尽最大努力将您传入的日期字符串模糊匹配为多种格式，并返回一个可行的日期时间实例，该实例代表它对您的意思的最佳猜测。

```
>>> from dateutil.parser import parse
>>> parse('17/Dec/2011:09:48:49 -0600', fuzzy=True)
datetime.datetime(2011, 12, 17, 9, 48, 49, tzinfo=tzoffset(None, -21600)) 
```

通常，让软件给出“最佳猜测”是一件坏事。在这种情况下，您的输入格式是否稳定似乎是合理的。处理软件开发的时间很困难，去购物吧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T12:50:23.210

这是与 GMT 的偏移量。如果您不想要它，只需将其剥离：

```
>>> import time
>>> line = '17/Dec/2011:09:48:49 -0600'
>>> line = line.split(' ')[0]
>>> print  time.strptime(line,"%d/%b/%Y:%H:%M:%S")
time.struct_time(tm_year=2011, tm_mon=12, tm_mday=17, tm_hour=9, tm_min=48,  tm_sec=49, tm_wday=5, tm_yday=351, tm_isdst=-1) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T12:50:59.250

`strptime`只需将修饰符 ( `%d`, `%b`, ...) 与字符串的相应段匹配，然后将匹配的字符串转换为整数。因此，在您的情况下，`-0600`唯一可以使您的格式字符串与输入字符串匹配。

如果要通过指定的偏移量调整时间，我建议使用`datetime`对象。

```
>>>s = '17/Dec/2011:09:48:49 -0600'
>>>from datetime import datetime,timedelta
>>>mytime = datetime.strptime(s,"%d/%b/%Y:%H:%M:%S -0600")
>>>dt = timedelta(minutes=6*60)  #6 hours
>>>mytime-=dt
>>>print mytime
2011-12-17 03:48:49
>>>print mytime.hour
3 
```

另请注意，由于`str`是内置的，因此通常不建议重新分配它。

# php - 将带有我的 jquery 脚本的 url 变量传递给服务器端文件

> ID：10298033
> 
> 赞同：0
> 
> 时间：2012-04-24T12:42:42.867
> 
> 标签：php, jquery

我有一个使用 jquery 和 php 脚本的分页脚本，我试图在这里传递一个`rev`在我的 url 中调用的 url 变量，它为分页服务器端文件提供一个 sql id 参数

这是我的jQuery代码：

```
function loadData(page){
                    loading_show(); 

                    $.ajax
                    ({
                        type: "POST",
                        url: "commentPagination.php",
                        data: "page="+page,

                        success: function(msg)
                        { 
```

我尝试了以下但没有奏效

```
function loadData(page){
                    loading_show(); 

                    $.ajax
                    ({
                        type: "POST",
                        url: "commentPagination.php",
                        data: "page="+page+"&rev="+rev,

                        success: function(msg)
                        { 
```

它不起作用，我如何从 URL 中获取变量，然后通过 jquery 将其传递到我的服务器端文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T12:47:44.023

您可以使用 Object 作为数据属性

```
//...
   data: {
       page: page,
       rev: rev
   },
//... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T12:44:59.940

你需要一个对象：

```
data: {page: page, rev: rev}, 
```

尽管您可能想要重命名变量，以免混淆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T12:48:35.163

好吧，这是您要查找的完整代码：

```
 $.ajax({
                            type: "POST",
                            url: "get-cities-xml/"+area,
                            data: "eid=0",
                            dataType: "xml",
                            success: function(data) {
                                $html = "";
                                $(data).find("city-name").each(function(){
                                    $html += "<li><a class='aclick' href='getproperty/"+$(this).find("name").text()+"'>"+$(this).find("name").text()+"</a></li>";

                                });
                                $("#show-cities").html("<ul>"+$html+"</ul>");
                            },
                        error:function(xhr,err){
                          //alert("readyState: "+xhr.readyState+"\nstatus: "+xhr.status);
                         alert("readyState: "+xhr.readyState+"\nstatus: "+xhr.status);

                        }

                        }); 
```

现在你的东西：

```
$.ajax
                    ({
                        type: "POST",
                        url: "commentPagination.php",
                        data: "page="+page,

                        success: function(msg)
                        {
alert(msg)// that msg contains ur html response.
}, 
```

# h2 - 检索 100 行包含 CLOB 的程序后仍然挂起

> ID：10298037
> 
> 赞同：0
> 
> 时间：2012-04-24T12:43:01.350
> 
> 标签：h2

这与版本 1.3.165 在检索其行包含一个或多个**CLOB**的远程（TCP/IP 连接）结果集时遇到的问题相同。版本 1.3.166 中的修复是将用于保存远程**CLOB**的缓存大小设置为**SysProperties.SERVER_RESULT_SET_FETCH_SIZE** * 2。这带来了一个新问题：

我的特定表恰好每行有 5 个**CLOB**，所以除非我知道总是在客户端调用*setFetchSize* ，并根据每行的**CLOB**数量为给定的结果集。

在版本 1.3.165 中，当缓存大小设置为**SysProperties.SERVER_CACHED_OBJECTS时，我可以在心里将****SERVER_RESULT_SET_FETCH_SIZE**的默认值乘以某个因子，该因子表示我希望在我的任何结果集中拥有的每行**CLOB**的最大数量，并且然后在服务器端相应地设置**SERVER_CACHED_OBJECTS**并忘记它。这也将允许我对所有查询使用默认提取大小，这可能会更有效。所以我已经回落到 1.3.165。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T19:55:21.500

恐怕这是一个不容易解决的限制。我会将默认大小更改为`SysProperties.SERVER_RESULT_SET_FETCH_SIZE * 5`，但这当然只是一种解决方法。真正的解决方案更复杂。一个问题是 LOB 需要在事务提交之前保持打开状态，而 TCP 服务器和客户端组件并不总是知道这种情况。

# c++ - 获取 LINK 错误：C++ 中的外部。如何在另一个文件 File B.CPP 中访问在文件 A.CPP 中修改的变量的值

> ID：10298041
> 
> 赞同：1
> 
> 时间：2012-04-24T12:43:03.167
> 
> 标签：c++, visual-c++, linker-errors, extern

在我的 C++ 代码中，我想在文件“B”中使用变量“VarX”，该变量实际上在另一个文件“A”中被修改。所以我看了一下@以下链接并使用了外部概念。

[如何使用 extern 在源文件之间共享变量？](https://stackoverflow.com/questions/1433204/what-are-extern-variables-in-c)

> 错误 LNK2005：“unsigned int VarX”(?VarX@@3IA) 已在 ***.obj 中定义。

我的情况如下：

```
File1.h
extern unsigned int VarX;

File2.cpp
#include File1.h
unsigned int VarX = 101;

File3.cpp
#include File1.h
unsigned int temp = VarX; 
```

**IMP 注意：在头文件 File1.h 中，除了 Extern 定义之外，还有许多其他结构定义和许多其他定义。**

有人可以帮助我吗？我该如何读取在另一个文件 File3.cpp 中的 File2.cpp 中修改的 VarX 的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T12:54:21.370

问题不在于可访问性，而在于多重定义。错误消息很清楚，在您正在重新定义的代码中的某处`VarX`。

常见原因可能是：

*   无效的构建 - 你在编译之前清理过构建吗？
*   你有多个`unsigned int VarX = 101;`或一个`unsigned int VarX;`地方（在头文件或实现文件中），没有`extern`声明。
*   你`#include "File2.cpp"`在代码的某个地方，导致它被编译多次。

我的赌注是第二种可能性。

# windows-phone-7 - WP7 XNA游戏：如何适应不同的手机分辨率？

> ID：10298046
> 
> 赞同：0
> 
> 时间：2012-04-24T12:43:20.090
> 
> 标签：windows-phone-7, xna

我创建了一款以 800 x 480 分辨率为目标的游戏，但对让它适应其他 WP7 分辨率产生了兴趣。另外，我听说可以通过 Mono 和 ExEn 将游戏移植到 iPhone 和 Android，从而打开大量其他屏幕分辨率。

处理这个问题的正确方法是什么？我想让游戏足够智能以检测屏幕尺寸并更改资产以使其看起来尽可能接近原始并且玩相同的游戏。

这是一款 2D 游戏，我认为理想的情况是为所有分辨率提供单独的图像，但为了面向未来，这是行不通的。我想有一个 800 x 480 的基线，在开始时检测大小，并改变我所有实体的边界以缩放，然后简单地将纹理绘制到这些目标。这将使我能够正确地进行碰撞检测以及缩放纹理，但可能有更好的方法。

无论如何，我希望我已经清楚地解释了这个问题。如果没有，我会在评论进来后编辑问题。

感谢您的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T14:42:55.927

为了那些在 Windows Phone 可能支持多种分辨率（或寻找这个答案以编写真正的多分辨率引擎）时登陆这里的人们的利益，我就是这样做的。

我枚举/检查可用的分辨率，并为具有我已经知道的纵横比的分辨率设置正交投影。为此，我硬编码了一张我测试过我的游戏的纵横比表，以及每个纵横比的“参考”宽度/高度。然后我查看当前请求的分辨率，找到它的纵横比并在我的表格中查看最接近的匹配纵横比并设置一个正射投影（居中 - 所以如果高度匹配但宽度不匹配，反之亦然，字母-boxing 自动发生）和相应的视口。

例如：我会为 qHD (960x540)、WXGA (1280x720) 和 FHD (1920x1080) 设置 1280x720 的正射投影，因为它们都具有相同的纵横比。

在纵横比为 1.5 的 SVGA 和 DVGA (960x640) 显示器上，我会设置 SVGA 800x600 分辨率，所以一切看起来都不错。

上述方法可确保如果您根据主要目标设备使用的纵横比设计资产，它们将不会看到任何挤压。*请注意，此方法**不适**用于确定资产的实际分辨率。*

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T13:13:40.373

目前 WP 仅支持 800 x 480 分辨率。将来当允许不同的分辨率时，就会谈到自动缩放。到目前为止还没有任何结果，我建议你放轻松。

编辑：感谢您的提醒..重新阅读帖子。是的，Mono 允许您为 Android 和 iOS 编写代码，并且您可以共享大量代码[http://xamarin.com/](http://xamarin.com/)以获取更多信息。

这个想法是拥有一个通用库（引擎等），然后优化 UI 以适应不同的平台。

# ms-access - 从组查询更新而不创建物理表

> ID：10298050
> 
> 赞同：0
> 
> 时间：2012-04-24T12:43:24.667
> 
> 标签：ms-access, select, group-by, temp-tables

我有一个名为 ECD 的表，如下所示：

```
Cle2                 Mont           Lettrage
acbd....            +8,36            Suspens    
abcd...             -8,36            Suspens
dced..              +12,89          Suspens
dced..              -12,89           Suspens 
```

`Cle2`标识表中属于同一组的记录的字段在哪里是
`Mont`存储每条记录
`Lettrage`数量的字段是存储标签的字段，该标签将根据我的查询结果发生变化。

我要做的基本上是按 Cle2 对表 ECD 进行分组，同时对 Mont ( `Sum(Mont)`) 的值求和，然后检查 Mont 中的值是否求和并分组`cle2`为 0。如果它们等于 0，我更新`Lettrage`将这些记录标记为 OK，如果不是，我将这些记录标记为 SUSPENS！

我已经在访问中完成了此操作，但是代码效率不高，我基本上要做的是：

1、创建一个名为`provisional`
2、将 select Query 的值插入到该表中的新表

代码：

```
INSERT INTO Provisor
SELECT Cle2 As Cle2p, Sum(MONTANT_ORACLE) AS Sum 
FROM ECD 
GROUP BY Cle2 
```

3，创建一个表ECD2，空的，与ECD相同的字段
4，将连接语句的结果插入到该表中，如下所示：

代码：

```
INSERT INTO ECDlet1 
SELECT Provisor.lettrage As Let2, ecd.*
FROM Provisor 
LEFT JOIN ECD ON Provisor.[Cle2p]=ECD.Cle2 
```

5，然后清理数据库并`Lettrage`使用正确的标签更新

所以我想做的就是在不创建所有那些愚蠢的物理表的情况下做这样的事情，我想强调我在 Visual Basic 中使用 CurrentDb.Execute 语句执行查询。

预先感谢您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:43:52.673

怎么样：

```
UPDATE ECD 
SET ECD.lettrage = IIf(DSum("Mont","ECD","cle2='" & [cle2] & "'")=0,"Ok","Suspens"); 
```

# mysql - 表本地化

> ID：10298053
> 
> 赞同：1
> 
> 时间：2012-04-24T12:43:41.043
> 
> 标签：mysql, database-design

我正在开发一个 Web 应用程序，它将以两种语言提供，将来可能会添加更多语言。

我在设计表格时发现了一个问题；这是结构：

```
Table: Tag;
Columns: TagId (PK)  {this column it's referenced by other tables like Posts, Users, etc...}

Table: TagLocale
Columns: TagLocaleId (PK), TagId(FK), LanguageId (FK), Name (the tag string) 
```

一张只有一列的表格是错误的，对吧？任何人都可以在这里帮助我吗？

提前致谢，

仁南

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T12:45:37.990

有一个只有一列的表是完全可以的。

它的意思是“这个标签确实存在”。

`MySQL`当您将构建标签统计信息时（假设不支持完全连接），它将非常方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:30:44.890

拥有一张只有一列的表格非常好。该表用于约束其他表并用作验证数据的参考。通常首先填充单行引用表以进行数据验证和引用。

# php - 使用 base64 编码的字符串将 XML 从 Javascript 发送到 PHP

> ID：10298054
> 
> 赞同：0
> 
> 时间：2012-04-24T12:43:41.713
> 
> 标签：php, javascript, xml, base64

我必须通过 Javascript 向 PHP 发送 XML，并通过 jQuery 执行此操作，如下所示：

```
$.ajax({
           url             :   'http://myurl',
           type            :   'POST',
           data            :   { documentXML : escape(xml) },
           dataType        :   'text',
           success         :   function( data ) {
              // Do something
           },
           error           :   function() {
              alert('Failed to send ajax request!');
           }
        }) 
```

我正在像这样在 PHP 中解码 xml：

```
if(isset($_REQUEST['documentXML'])) {
    $receivedXML = urldecode($_REQUEST['documentXML']);
} else {
   die('<?xml version="1.0"?><error>No documentXML given.</error>');
} 
```

但是，在 XML 中嵌入了其他 XML；这是通过对嵌入的 XML 进行 base64 编码来完成的。在此过程中，base64 变为无效。

鉴于更改 XML 结构或编码不是一种选择：

*   我能做些什么？
*   我这样做的方式是正确的吗？

谢谢。

# regex - 为什么 nchar("\\")=1 在 R 中？

> ID：10298055
> 
> 赞同：0
> 
> 时间：2012-04-24T12:43:47.940
> 
> 标签：regex, string, r, character

为什么`nchar("\\")=1, nchar("\abcde")=5`等在 R ？使用哪个功能`nchar("\\")=2, nchar("\abcde")=6`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T13:31:57.693

在 R 中，如果你想要一个文字`\`，你需要像其他人所说的那样逃避它。`encodeString()`我在您的示例中看不到原因。`nchar()`使用并记住我的答案的第一行会更容易： **escape your`\`**

```
> nchar("\\\\")
[1] 2
> nchar("\\abcde")
[1] 6 
```

如果您想忘记转义，那么`encodeString()`可以提供帮助，但是您要么做一个（手动转义）*要么*使用`escapeString()`，而不是两者：

```
> encodeString("\\")
[1] "\\\\"
> encodeString("\abcde")
[1] "\\abcde" 
```

最后，`\uXXXX`是一种在 R 中输入 unicode 字符的方法，这可以解决`encodeString()`：

```
> nchar(encodeString("\u2642"))
[1] 1 
```

因为它想将此视为 unicode 字符的表示。在这种情况下，“自己逃脱”的事情是正确的：

```
> nchar("\\u2642")
[1] 6 
```

我不确定在 R 中替换字符串为 a 的直接方法，`\`因为`\\`它将`\uXXXX`首先解释为 unicdoe 字符，然后才会发生替换（但此时没有`\`。请`?Quotes`参阅R 中使用的转义序列列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T12:48:20.280

反斜杠正在[转义](http://en.wikipedia.org/wiki/Escape_character)下一个字符。这在许多编程语言中很常见；允许您在字符串中嵌入控制和其他非打印字符，例如 `\n' 表示换行符。

所以'\'实际上是单个`\`字符。解决您的问题的最简单方法是将反斜杠加倍：`nchar("\\abcde") = 6`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T12:56:28.810

> `nchar(encodeString("\\"))`

应该给你你想要的。

# javascript - 在 jQuery UI Sortable 之后更新 CollectionView 内容的最佳方法？

> ID：10298057
> 
> 赞同：5
> 
> 时间：2012-04-24T12:43:50.580
> 
> 标签：javascript, jquery-ui, ember.js

由于@ghemton 的`safeClone`方法，我已经能够让 jQuery UI Sortable 在 Ember.js 中工作：[Ember.js + jQuery UI Draggable Clone](https://stackoverflow.com/questions/8797632/ember-js-jquery-ui-draggable-clone)

排序完成后，我无法让 Ember 知道更改。现在，我按照[将数组元素从一个数组位置移动到另一个位置中的](https://stackoverflow.com/questions/5306680/move-an-array-element-from-one-array-position-to-another)`splice`建议使用将集合中的项目移动到适当的位置。这很好，但我遇到了窗口滚动的问题。

在这个 jsfiddle [http://jsfiddle.net/chrisconley/g4aE6/](http://jsfiddle.net/chrisconley/g4aE6/)中，如果滚动到底部，然后重新排序任何元素，窗口会跳回顶部。如果在`propertyWillChange`and之间放置一个断点`propertyDidChange`，您可以看到 Ember 正在暂时从视图中删除所有项目，这导致窗口跳回顶部。

```
App.MySortableView = Em.CollectionView.extend({
  moveItem: function(fromIndex, toIndex){
    var items = this.get('content');
    this.propertyWillChange('content');
    item = items.splice(fromIndex, 1)[0];
    items.splice(toIndex, 0, item);
    this.propertyDidChange('content');
  }
}); 
```

有没有办法在不删除和替换整个集合的情况下通知 Ember 更改？

**更新的解决方案：**

（感谢克里斯托弗斯瓦西在下面的回答）

```
App.MySortableView = Em.CollectionView.extend({
  moveItem: function(fromIndex, toIndex){
    var items = this.get('content');
    item = items.objectAt(fromIndex);
    items.removeAt(fromIndex);
    items.insertAt(toIndex, item);
  }
}); 
```

此处的完整示例：http: [//jsfiddle.net/chrisconley/NN35P/](http://jsfiddle.net/chrisconley/NN35P/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T14:00:36.760

你不应该对像 Array 这样的对象使用 JS 标准库调用。这些调用不能被 Ember 的绑定/观察者捕获。而是使用 Ember 定义的 API，例如 'replace'、'objectAt' 等来与数组交互。

在这种情况下，您需要将#splice 替换为#replace。

# templates - 使用模板中的空对象，如何避免 NullPointerException？

> ID：10298069
> 
> 赞同：3
> 
> 时间：2012-04-24T12:44:35.233
> 
> 标签：templates, scala, playframework-2.0

在 Play 1.2 中，我曾经做过类似`${myobj?.item?.subitem}`.

我在 Play 2.0 中尝试过这个，但没有任何运气。有没有可能的替代方案？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T14:19:37.587

编辑：对不起，我认为我没有忠实地翻译这个，而且更丑陋。`myobj.item`也可以为 null，因此您必须将其包装在`Option(_)`：

```
@Option(myobj).flatMap(i => Option(i.item)).flatMap(s => Option(s.subitem)).getOrElse("empty") 
```

或者

```
@((for {o <- Option(myobj)
        item <- Option(o.item)
        subitem <- Option(item.subitem)
   }).getOrElse("empty")) 
```

请注意，对于这种常见情况，playframework 是否有一些额外的糖。

# c - 在 C 中重新分配结构

> ID：10298070
> 
> 赞同：4
> 
> 时间：2012-04-24T12:44:35.957
> 
> 标签：c

我是 C 新手，正在尝试使用结构。创建结构后，是否可以用大括号重新分配它？

```
typedef struct {
    int height;
    int age;
} Person;

int main (void)
{
    Person bill = {100,35};
    bill = {120,34}; // error: expected expression before ‘{’ token
    bill = Person {120,34}; // error: expected expression before ‘Person’

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T12:48:22.833

不是直接的，但是 C99 有复合文字

```
bill = (Person){120,34}; 
```

你甚至可以通过使用指定的初始化器来做更具可读性的事情，比如

```
bill = (Person){ .height = 120, .age = 34, }; 
```

# if-statement - Struts 2 if tag : 用常数测试

> ID：10298071
> 
> 赞同：4
> 
> 时间：2012-04-24T12:44:38.267
> 
> 标签：if-statement, struts2, constants

我正在制作以下代码：

```
<s:if test="%{#beanVar == com.mycompany.project.NOT_REGISTERED} ">
 <td>NOT REGISTRED</td>
</s:if> 
```

其中**com.mycompany.project.NOT_REGISTERED**是一个类静态字段：

```
public static final long NOT_REGISTERED == 0; 
```

我在 Struts2 文档中找不到在运行时评估中公开常量的方法。

在此先感谢您的帮助。

PS：我不想使用老式的构造 <% %>

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T12:50:13.990

来自 OGNL 基础：

> 访问静态属性 OGNL 支持访问静态属性和静态方法。
> 
> 默认情况下，Struts 2 配置为不允许这样做——要启用 OGNL 的静态成员支持，您必须通过任何常量配置方法将 struts.ognl.allowStaticMethodAccess 常量设置为 true。
> 
> OGNL 的静态访问如下所示：
> 
> ```
> @some.package.ClassName@FOO_PROPERTY
> @some.package.ClassName@someMethod() 
> ```
> 
> 但是，XWork 允许您避免必须指定完整的包名称并使用“vs”前缀调用动作类的静态属性和方法：
> 
> ```
> @vs@FOO_PROPERTY @vs@someMethod()
> @vs1@FOO_PROPERTY @vs1@someMethod()
> @vs2@BAR_PROPERTY @vs2@someOtherMethod() 
> ```
> 
> “vs”代表“值堆栈”。这里要注意的重要一点是，如果您指定的类名只是“vs”，则使用堆栈顶部对象的类。如果您在“vs”字符串之后指定一个数字，则会使用堆栈中更深的对象类。

问候，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T14:40:18.760

```
<s:if test="%{#beanVar == @com.mycompany.project@NOT_REGISTERED}">
  <td>NOT REGISTRED</td>
</s:if> 
```

**@**不见了。

# java - java.library.path 中没有应用

> ID：10298073
> 
> 赞同：0
> 
> 时间：2012-04-24T12:44:46.923
> 
> 标签：java

我在 Eclipse 项目的 lib 文件夹中有 app.jar。但是，当我运行使用 app.jar 的函数时。我在 java.library.path 中没有应用程序出现错误。我不知道我该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T12:50:07.923

Java 的 java.library.path 用于指定本地库目录，您应该将 app.jar 添加到 java 类路径：`java -cp app.jar;your/classes/*; com.your.Class`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:54:46.097

问题是，app.jar 中的代码尝试加载本机库（如果您使用的是 Windows，则为 *.dll 文件）。dll 很可能在您的 jar 文件中，但也可以单独发送。尝试提供一个明确的 java.library.path：

`java -Djava.library.path=lib YourMainClass`

或者

`java -Djava.library.path=lib/app.jar YourMainClass`

我不确定第二个是否像这样工作。例如，SWT 从 jar 中加载其本机库，但我认为他们添加了一些自己的代码来实现这一点。尝试先查找 dll 文件。它可能根本不在身边。

# delphi - Crystal Reports Delphi 7 VCL - 为日期范围参数设置 CurrentValue

> ID：10298075
> 
> 赞同：1
> 
> 时间：2012-04-24T12:44:50.000
> 
> 标签：delphi, parameters, crystal-reports, report, vcl

我使用Delphi 7 的Crystal Reports VCL 从Delphi 运行Crystal Reports。我想从这个 Delphi 应用程序中设置当前参数值。我成功地为数字或字符串参数发送了这个值。但现在我正在努力使用已设置`Allow Ranges`为的日期参数`True`。

我得到的错误是：`305:Error converting string to ValueInfo - ParamFields[2].CurrentValues.Add <StrToValueInfo>`

我正在使用这个代码，就像我说的那样适用于*没有范围*参数。在下面的代码中，参数`PARAM_DATE`是允许范围的日期参数。知道如何传递范围值吗？

```
procedure TReportFrame.btnExecuteReportClick(Sender: TObject);
var
    Crpe1 : TCrpe;
    varArr : variant;
    i : integer;
    a : TCrpeParamFieldRangesItem;
    b : TCrpeParamFieldCurrentValuesItem;
begin
  SetCurrentDir( GetCommonFilesPath );
  try
  Crpe1 := TCrpe.Create(Self);
  Crpe1.DiscardSavedData();
  Crpe1.ReportName := getReportBasePath() + reportFileName;

  Crpe1.IgnoreKnownProblems := true;
  Crpe1.LoadEngineOnUse := true;
  Crpe1.Connect.Clear;

  Crpe1.Tables[0].ConnectBuffer := glbDBMan.GetConnectionString;

    Crpe1.ParamByName('PARAM_SORTING_TYPE', EmptyStr).CurrentValue :=  VarToStr( paramSposobSortowania.getSelectedValue());

  varArr := parameterOsobaOdpowiedzialna.getSelectedValues();
  for i := VarArrayLowBound(varArr,1) to VarArrayHighBound(varArr,1) do
  begin
    Crpe1.ParamByName('PARAM_PERSON', EmptyStr).CurrentValues.Add(VarToStr( varArr[i]));
  end;

//  Crpe1.ParamByName('PARAM_DATA_ZLOZENIA_WNIOSKU', EmptyStr).CurrentValues.Add('2012-4-1');
//  a := TCrpeParamFieldRangesItem.Create;
//  a.RangeStart := '2012-4-1';
//  a.RangeEnd := '2012-4-6';
//  Crpe1.ParamByName('PARAM_DATE', EmptyStr).Ranges.Add();
//  Crpe1.ParamByName('PARAM_DATE', EmptyStr).Ranges[0].RangeStart := '2012-4-1';
//  Crpe1.ParamByName('PARAM_DATE', EmptyStr).Ranges[0].RangeEnd := '2012-4-6';

//  Crpe1.ParamByName('PARAM_DATE', EmptyStr).CurrentValues.Add('2012-4-1');

    //PARAM_DATE is a DATE Range
  Crpe1.ParamByName('PARAM_DATE', EmptyStr).CurrentValues.Add('2012-4-1');
  Crpe1.ParamByName('PARAM_DATE', EmptyStr).CurrentValues.Add('2012-4-6');

  if Crpe1.Connect.Test then
    Crpe1.Show
  else
    ShowMessage('Error Connecting');

    Crpe1.DiscardSavedData;

    finally
      SetCurrentDir( ExtractFileDir(ParamStr(0)) );
    end;
end; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T17:40:15.900

你尝试过这样的事情吗？

```
i:= Crpe1.ParamByName('PARAM_DATE', EmptyStr).Ranges.Add();
Crpe1.ParamByName('PARAM_DATE', EmptyStr).Ranges.Items[i].RangeStart := '2012-4-1';
Crpe1.ParamByName('PARAM_DATE', EmptyStr).Ranges.Itens[i].RangeEnd := '2012-4-6'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T07:14:07.667

```
Crpe1.ParamByName('PARAM_DATE', EmptyStr).Ranges.Add();
Crpe1.ParamByName('PARAM_DATE', EmptyStr).Ranges[0].RangeStart := '2012,4,1';
Crpe1.ParamByName('PARAM_DATE', EmptyStr).Ranges[0].RangeEnd := '2012,4,6'; 
```

更新：VCL（文件：UCrpeUtl）中有一个名为*CrDateToStr*的函数，它采用 TDateTime 并返回此格式的日期字符串。

# php - 如何避免在 PHP 中显示此错误？

> ID：10298082
> 
> 赞同：-6
> 
> 时间：2012-04-24T12:45:13.770
> 
> 标签：php, mysql

我想避免在数据库中插入重复条目时显示错误。

我添加了这个“@”，但总是显示错误：

```
$result = @mysql_query($query) or die("Query failed insert. Mysql error: ".mysql_error() ); 
```

输出：

```
Query failed insert. Mysql error: Duplicate entry for key 'url' 
```

如何避免在插入重复条目时显示错误？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-24T12:47:38.127

添加这个“@”是开发人员可以做的最愚蠢的事情。您将*错误消息*与*错误本身*混淆了。您必须修复错误，而不是消息。

要解决这个问题，您必须`IGNORE`在查询中使用关键字

```
INSERT IGNORE INTO ... 
```

具有讽刺意味的是，您实际上应该删除该`die()`语句，但只是用更可靠和安全的方式替换它`trigger_error()`，因此，代码应该是

```
$result = mysql_query($query) or trigger_error(mysql_error()." in ".$query); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-24T12:49:48.237

好吧，就像其他答案一样，您可以在之后删除该`die`子句，**但这将是您手头问题的错误解决方案！**.

您需要**解决**导致您有多个条目的问题，而不是把错误扫到地毯下并希望最好！

# 不要忽视你的错误，修复它们！

# php - 避免重写已经存在的文件

> ID：10298086
> 
> 赞同：1
> 
> 时间：2012-04-24T12:45:32.307
> 
> 标签：php

我编写了这个简单的代码来保存图像：

```
// $randomimage contains a random image url.
$content = file_get_contents($randomimage);
file_put_contents('images/'.$randomimage, $content); 
```

我需要一种不重写同名图像的方法。因此，如果我的 /images/ 文件夹中已经存在具有特定名称的图像，则什么也不做。这很简单，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T12:47:24.570

当然，使用[`file_exists`](http://php.net/file_exists).

```
$path = 'images/'.$randomimage;
if( !file_exists( $path)) {
    // Note, see below
    file_put_contents( $path, $content);
} 
```

重要的是要注意，这会在您的程序中固有地引入竞争条件，因为另一个进程可能会在您检查文件是否存在时创建文件，然后写入文件。在这种情况下，您将覆盖新创建的文件。然而，这是极不可能的，但有可能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T12:50:02.197

除了尼克b。is_file 比 file_exists 好，file_exists 将在目录和文件上返回 true。

所以它会是：

```
if( !is_file ( 'images/'.$randomimage)) {
    file_put_contents('images/'.$randomimage, $content);
} 
```

PS：还有一个函数 is_dir ，以防你想知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T12:47:27.723

[http://php.net/manual/en/function.file-exists.php](http://php.net/manual/en/function.file-exists.php)

# apache - 如何在本地主机上创建子域

> ID：10298091
> 
> 赞同：0
> 
> 时间：2012-04-24T12:45:48.170
> 
> 标签：apache, xampp, subdomain

我在我的 httpd.conf 文件中改变了这个

```
#Listen 1234 
```

并在我的 http.vhosts.conf 中创建了 2 个虚拟主机

```
<VirtualHost 127.0.0.5:1234>
 DocumentRoot "D:/SVN data/WebClient_PHP/trunk/current_project_re/public"
 ServerName prod
</VirtualHost>

<VirtualHost 127.0.0.6:1234>
  DocumentRoot "D:/SVN data/WebClient_PHP/trunk/current_project_dec/public"
  ServerName dev
</VirtualHost> 
```

在 windows/system32/drivers/etc/host 的我的主机文件中也改变了这个

```
127.0.0.5:1234 prod

127.0.0.6:1234 dev 
```

当我指向“dev”或“prod”时重新启动我的 apache 后两者都不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:00:08.637

你确定，两个地址都指向你的本地机器？

如果没有，您可以在两个文件中使用 127.0.0.1 并让 apache 处理由您的 ServerName 指定的文档根目录。

哦，并删除主机文件中的端口声明

# objective-c - 使用 NSURLConnection 异步连接，如何在主函数中获取接收到的数据？

> ID：10298093
> 
> 赞同：1
> 
> 时间：2012-04-24T12:45:51.933
> 
> 标签：objective-c, asynchronous, nsurlconnection

httpController.h 中的一些代码如下：

```
@interface httpController:NSObject{
  ...
  NSMutableData *receivedData;
}
@property (nonatomic,retain) NSMutableData *receivedData; 
```

httpController.m 文件中的一些代码如下：

```
@implementation httpController
@synthesize receivedData;
...
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
  [receivedData setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data               
{
  if (!receivedData) {
      receivedData = [[NSMutableData alloc] init];
  }
  [receivedData appendData:data];  
}
- (void)connectionDidFinishLoading:(NSURLConnection *)connection {

} 
```

然后我想在 main.m 文件中使用 receivedData，如下所示：

```
int main(int argc, const char *argv[])
{
   HttpController *httpController = [[HttpController alloc] init];
   NSURLRequest *request = ...;
   NSURLConnection *connetion = ...;
   if(connection)
   {
     NSMutableData *_receviedData = httpController.receivedData;
     NSString * dataString = [[[NSString alloc] initWithData:_receviedData encoding:NSUTF8StringEncoding] autorelease]; 
     NSLog(@"%@",dataString);
   }
   [[NSRunLoop currentRunLoop] run];
} 
```

但是我发现在main()函数中，_receivedData的值是空的，并且有注释输出。任何人都可以告诉我有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T14:51:58.430

`+connectionWithRequest:delegate:`异步运行。看起来它在返回之前没有完成连接，这就是你看不到任何数据的原因。改为尝试`+sendSynchronousRequest:returningResponse:error:`，因为这将阻塞线程，直到连接完成。

使用任何一个时都不需要 HttpController/delegate `+sendSynchronousRequest:returningResponse:error:`。这是如何做到的：

```
int main(int argc, const char *argv[])
{
    NSURL           *url        = [NSURL URLWithString:@"http://www.yahoo.com/"];
    NSURLRequest    *request    = [NSURLRequest requestWithURL:url];
    NSURLResponse   *response   = nil;
    NSError         *error      = nil;

    // This blocks "this" thread until it's done.
    NSData          *data       = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

    if (!data)
    {
        NSLog(@"Error: %@", error);
    }
    else
    {
        NSString *dataString = [[[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding] autorelease];
        NSLog(@"%@", dataString);
    }
} 
```

If you don't want to block the thread, then `+connectionWithRequest:delegate:` is the way to go. But you'll have to write your code differently, and [should read the docs](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html).

# java - 如何实现一个ExecutorService来执行批量任务

> ID：10298098
> 
> 赞同：5
> 
> 时间：2012-04-24T12:46:11.853
> 
> 标签：java, multithreading, executorservice

我正在寻找一种在 java 中执行批量任务的方法。这个想法是有一个`ExecutorService`基于线程池的线程池，它允许我在一个线程`Callable`的不同线程之间传播一组`main`。此类应提供一个*waitForCompletion*方法，该方法将使`main`线程进入睡眠状态，直到所有任务都执行完毕。然后`main`线程应该被唤醒，它会执行一些操作并重新提交一组任务。

这个过程会重复很多次，所以我想使用`ExecutorService.shutdown`它，因为这需要创建多个`ExecutorService`.

`AtomicInteger`目前我已经使用 a和 a `Lock`/以下列方式实现了它`Condition`：

```
public class BatchThreadPoolExecutor extends ThreadPoolExecutor {
  private final AtomicInteger mActiveCount;
  private final Lock          mLock;
  private final Condition     mCondition;

  public <C extends Callable<V>, V> Map<C, Future<V>> submitBatch(Collection<C> batch){
    ...
    for(C task : batch){
      submit(task);
      mActiveCount.incrementAndGet();
    }
  }

  @Override
  protected void afterExecute(Runnable r, Throwable t) {
    super.afterExecute(r, t);
    mLock.lock();
    if (mActiveCount.decrementAndGet() == 0) {
      mCondition.signalAll();
    }
    mLock.unlock();
  }

  public void awaitBatchCompletion() throws InterruptedException {
    ...
    // Lock and wait until there is no active task
    mLock.lock();
    while (mActiveCount.get() > 0) {
      try {
        mCondition.await();
      } catch (InterruptedException e) {
        mLock.unlock();
        throw e;
      }
    }
    mLock.unlock();
  } 
} 
```

请注意，我不一定会一次提交批次中的所有任务，因此`CountDownLatch`似乎不是一个选择。

这是一种有效的方法吗？有没有更有效/优雅的方式来实现它？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T12:59:22.497

我认为[ExecutorService](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html#invokeAll%28java.util.Collection%29)本身将能够执行您的要求。

调用`invokeAll([...])`并遍历您的所有任务。如果您可以遍历所有期货，则所有任务都已完成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T13:32:49.933

正如其他答案所指出的那样，您的用例中似乎没有任何部分需要自定义 ExecutorService。

在我看来，您需要做的就是提交一个批处理，等待它们全部完成，同时忽略主线程上的中断，然后可能根据第一批的结果提交另一个批处理。我相信这只是一个问题：

```
 ExecutorService service = ...;

    Collection<Future> futures = new HashSet<Future>();
    for (Callable callable : tasks) {
        Future future = service.submit(callable);
        futures.add(future);
    }

    for(Future future : futures) {
        try {
            future.get();
        } catch (InterruptedException e) {
            // Figure out if the interruption means we should stop.
        }
    }

    // Use the results of futures to figure out a new batch of tasks.
    // Repeat the process with the same ExecutorService. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:10:08.833

我同意@ckuetbach 的观点，默认 Java`Executors`应该为您提供执行“批处理”作业所需的所有功能。

如果我是你，我只会提交一堆工作，等待他们完成，`ExecutorService.awaitTermination()`然后开始一个新的`ExecutorService`. 这样做以节省“线程创建”是过早的优化，除非您每秒执行 100 次或其他操作。

如果您真的坚持对`ExecutorService`每个批次都使用相同的，那么您可以自己分配一个`ThreadPoolExecutor`，然后循环查看`ThreadPoolExecutor.getActiveCount()`. 就像是：

```
BlockingQueue jobQueue = new LinkedBlockingQueue<Runnable>();
ThreadPoolExecutor executor = new ThreadPoolExecutor(NUM_THREADS, NUM_THREADS,
    0L, TimeUnit.MILLISECONDS, jobQueue);
// submit your batch of jobs ...
// need to wait a bit for the jobs to start
Thread.sleep(100);
while (executor.getActiveCount() > 0 && jobQueue.size() > 0) {
    // to slow the spin
    Thread.sleep(1000);
}
// continue on to submit the next batch 
```

# vbscript - 当子对象没有属性时，如何在非叶子用户对象下的 Active Directory 中查询 dn？

> ID：10298099
> 
> 赞同：0
> 
> 时间：2012-04-24T12:46:12.727
> 
> 标签：vbscript, attributes, active-directory, ldap-query

基本上，我想要完成的是从 MS Active Directory 中删除一个非叶用户对象。在某个时间点，在这些非叶用户对象下放置了一些额外的对象，因此我尝试查询基础下的所有这些对象并首先将它们删除。

这是我在 VBScript 中的查询：

```
qQuery = "<LDAP://[SERVERNAME]/[BASE_USER_OBJECT]>;" & _
"(objectCategory=*);dn 
```

我期望这会返回`dn`我的基本用户对象下方的每个对象。该脚本引发“未指定的错误”。

如果我将请求属性更改为`distinguishedName`而不是`dn`，那么它运行得很好并`distinguishedName`从一些子对象返回属性。问题是大多数子对象没有这个`distinguishedName`属性，或者任何属性。

有没有办法`dn`在 VBScript 中查询？

感谢您提前提供任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T14:59:46.473

保证对象具有`distinguishedName`. 这是强制性的。您是否有足够的权限查看这些对象？

此链接有许多适合您情况的好例子 - [http://www.selfadsi.org/delete.htm](http://www.selfadsi.org/delete.htm)。

# python - 使用 pywinauto 自动化 MSI 安装程序

> ID：10298104
> 
> 赞同：2
> 
> 时间：2012-04-24T12:46:20.250
> 
> 标签：python, windows-installer, pywinauto

我正在考虑在 python 中使用 pywinauto 来自动安装 Windows MSI 安装程序以进行测试。

当我尝试通过 application.start 启动 MSI 时，出现以下错误：

“CreateProcess 返回的错误：[错误 193]”

是否有可能做到这一点，或者我是否需要先启动 MSI 然后连接到它，如果可以，我该如何实现？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:00:56.083

您需要启动“msiexec.exe”并将 MSI 作为命令行参数传递以进行安装。您不能像启动 EXE 文件那样直接启动 MSI。

示例：msiexec.exe /i [MSI_path]

# php - imap_mail_move 不工作

> ID：10298107
> 
> 赞同：4
> 
> 时间：2012-04-24T12:46:29.533
> 
> 标签：php, email, imap

我编写了一个类来连接到我的邮箱并将垃圾邮件移动到我的垃圾文件夹。它似乎没有工作，但我不知道为什么。这是我所拥有的：

```
<?php
$cleaner = new Mail_cleaner();

echo 'Deleted '.$cleaner->deleted.' files';

Class Mail_cleaner {

public $server = '{mail.gridhost.co.uk:993/imap/ssl}';
public $folder = 'INBOX';
public $user = 'email@domain.com';
public $password = 'password';

public $mailbox;
public $check;
public $thelist;
public $overviews;
public $ids = array();
public $deleted = 0;

function __construct() {
    $this->open_connection();
    $this->get_messages();
}

function get_messages() {
    $this->ids = array();
    $this->overviews = imap_fetch_overview($this->mailbox,"1:{$this->check->Nmsgs}");

    foreach($this->overviews as $overview) {
        //print_r($overview); exit;
        if(stripos($overview->subject, 'SPAM')!==FALSE
        || stripos($overview->subject, 'Luxury Replicas')!==FALSE
        || stripos($overview->subject, 'Pharmacy')!==FALSE
        || stripos($overview->subject, 'viagra')!==FALSE
        || stripos($overview->subject, 'dr.maxman')!==FALSE
        || stripos($overview->subject, 'cialis')!==FALSE
        || stripos($overview->subject, 'penis enlarge')!==FALSE
        || stripos($overview->from, 'westin')!==FALSE
        || stripos($overview->from, 'rightmove')!==FALSE
        || stripos($overview->from, 'groupon')!==FALSE
        || stripos($overview->from, 'primelocation')!==FALSE
        || stripos($overview->from, 'mg-rover')!==FALSE
        ) {
            $this->ids[] = $overview->uid;

        }
    }
    if(count($this->ids) > 0) {
        $this->move_and_delete();
    }
}

function move_and_delete() {
    foreach($this->ids as $id) {
        // move to junk
        $result = imap_mail_move($this->mailbox, $id, 'INBOX.Junk');

        if($result) {
            //imap_delete($this->mailbox, $id); 
            $this->deleted++;
        }
    }
    imap_expunge($this->mailbox);
    imap_close($this->mailbox);
}

function open_connection() {
    $this->mailbox = imap_open($this->server.$this->folder, $this->user, $this->password);
    $this->check = imap_check($this->mailbox);
    $this->thelist = imap_getmailboxes($this->mailbox, $this->server, "*");
}

}
?> 
```

每次说已删除 115 条消息时，我都会得到相同的输出。如果我快速连续运行两次，那么第二次的输出应该被删除 0 条消息。所以基本上它没有正确移动它们，因为它们没有从收件箱消失到垃圾箱中。有谁知道为什么？它正在获取所有消息并遍历它们，但似乎这一举动并没有发生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T15:25:39.063

首先，我想知道您将 UID 添加到数组中，但您尝试从消息序列中删除。您需要将选项参数 (CP_UID) 添加到 imap_mail_move 调用中。 `$result = imap_mail_move($this->mailbox, $id, 'INBOX.Junk', CP_UID);` 这也可能是您的删除不起作用的原因，因为它可能没有移动任何消息。在您尝试期间，$result 的价值是多少？由于您最后关闭了邮箱，因此您可以使用`imap_close($this->mailbox, CL_EXPUNGE)`. 希望有帮助，斯特凡

# javascript - 检查两个整数是否具有相同的符号

> ID：10298109
> 
> 赞同：13
> 
> 时间：2012-04-24T12:46:38.113
> 
> 标签：javascript

我正在寻找一种有效的方法来检查两个数字是否具有相同的符号。

基本上我正在寻找比这更优雅的方式：

```
var n1 = 1;
var n2 = -1;

( (n1 > 0 && n2 > 0) || (n1<0 && n2 < 0) )? console.log("equal sign"):console.log("different sign"); 
```

使用按位运算符的解决方案也可以。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-24T12:48:58.190

您可以将它们相乘；如果它们具有相同的符号，则结果将是肯定的。

```
bool sameSign = (n1 * n2) > 0 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-04-24T12:49:35.317

代码字符更少，但可能会溢出：

```
n1*n2 > 0 ? console.log("equal sign") : console.log("different sign or zero"); 
```

或没有整数溢出，但稍大：

```
(n1>0) == (n2>0) ? console.log("equal sign") : console.log("different sign"); 
```

如果您认为 0 为正值，则 > 应替换为 <

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-24T13:15:02.357

使用按位异或

```
n1^n2 >= 0 ? console.log("equal sign") : console.log("different sign"); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-05-31T05:39:51.587

这基于您如何为特殊值定义“相同符号”：

*   ,有相同的符号吗`NaN`？`NaN`

如果您的答案是“否”，那么答案是：

```
Math.sign(a) === Math.sign(b) 
```

如果您的答案是“是”，那么答案是：

```
Object.is(Math.sign(a) + 0, Math.sign(b) + 0) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T12:50:07.187

```
n = n1*n2;
if(n>0){ same sign }
else { different sign } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-29T13:20:36.320

简单易行：

```
bool sameSign = ((n1 < 0) == (n2 < 0)); 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2012-04-24T12:55:45.673

也许正则表达式应该可以解决问题

```
function isNegative(num) { 
        if (num.match(/^-\d+$/)) {
            return true;
        } else {
            return false;
        }
   }

function isSameSign(num1, num2) { 
        var sameSign = false;  
        if (num1.match(/^-\d+$/) && num2.match(/^-\d+$/) ) {
                sameSign = true;
            } else if(!num2.match(/^-\d+$/) && !num2.match(/^-\d+$/)) {
                sameSign =true;
            }
        return sameSign;
       } 
```

# c - 跨编译器的 C 结构对齐和可移植性

> ID：10298113
> 
> 赞同：11
> 
> 时间：2012-04-24T12:46:46.983
> 
> 标签：c, windows, portability

假设下面的头文件对应，例如一个共享库。导出的函数采用指向此标头中定义的自定义结构的指针：

```
// lib.h

typedef struct {
  char c;
  double d;
  int i;
} A;

DLL_EXPORT void f(A* p); 
```

如果共享库是使用一个编译器构建的，然后从另一个编译器构建的 C 代码中使用，则它可能由于内存对齐方式不同而无法工作，正如[C-structs 中的内存对齐](https://stackoverflow.com/questions/5435841/memory-alignment-in-c-structs)所暗示的那样。那么，有没有办法让我的结构定义在同一平台上的不同编译器之间可移植？

我对 Windows 平台特别感兴趣（显然它没有明确定义的 ABI），但也很想了解其他平台。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-24T13:20:44.320

TL; DR 在实践中你应该没问题。

C 标准没有定义这一点，但平台 ABI 通常会定义。也就是说，对于给定的 CPU 架构和操作系统，可以定义 C 如何映射到允许不同编译器互操作的程序集。

结构对齐并不是平台 ABI 必须定义的唯一内容，您还有函数调用约定和类似的东西。

C++ 使它变得更加复杂，ABI 必须指定 vtable、异常、名称修改等。

在 Windows 上，我认为有多个 C++ ABI，具体取决于编译器，但 C 大多在编译器之间兼容。我可能是错的，不是 Windows 专家。

一些链接：

*   什么是 ABI？[http://gcc.gnu.org/ml/libstdc++/2001-11/msg00063.html](http://gcc.gnu.org/ml/libstdc++/2001-11/msg00063.html)
*   ABI 必须定义的东西[C++ ABI 问题列表](https://stackoverflow.com/questions/7492180/c-abi-issues-list)
*   示例 C++ ABI 规范[http://sourcery.mentor.com/public/cxx-abi/abi.html](http://sourcery.mentor.com/public/cxx-abi/abi.html)
*   ABI 如何在 Solaris 上发展[http://developers.sun.com/solaris/articles/CC_abi/CC_abi_content.html](http://developers.sun.com/solaris/articles/CC_abi/CC_abi_content.html)

无论如何，底线是您正在寻找平台/编译器 ABI 规范中的保证，而不是 C 标准。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T13:22:29.607

唯一确定的方法是查阅相关编译器的文档。但是，通常情况下，C 结构布局（如您所说，位域除外）由您正在使用的环境的 ABI 描述定义，并且 C 编译器将倾向于遵循本机 ABI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:20:35.093

不仅没有保证，而且即使您使用相同的编译器，由于构建中使用的编译器开关不同，或者如果您使用相同编译器和相同开关的不同版本（发生在嵌入式编译器中，我从事）。

您需要确保结构的表示完全相同，使用开关、#pragmas，无论编译器为您提供什么。

我的建议 - 完全远离这个。在函数中传递您的参数，而不是包装在结构中。

即使以这种简单的形式，如果您处理两个编译器，这也不是微不足道的。例如，您需要确保 int 采用相同数量的字节。同样调用 conevntion - 参数顺序 - 从左到右或从右到左 - 编译器之间可能会有所不同。

# testing - Maven 未运行配置文件中指定的测试

> ID：10298115
> 
> 赞同：1
> 
> 时间：2012-04-24T12:46:51.123
> 
> 标签：testing, maven, selenium, profile

我的 maven pom 文件中有一个不同的简单配置文件，可以在正常测试阶段运行一些集成测试。注意我不想在正常的集成测试阶段运行这些测试，因为我不想构建战争和部署等。这些测试像正常的 JUnit 测试一样运行良好。

所以这是我的个人资料：

```
<profile>
  <id>AdminSeltests</id>
  <build>
    <plugins>
   <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-surefire-plugin</artifactId>
      <version>2.12</version>

      <configuration>
          <includes>
            <include>**/*/TestSellerSignupWizard.java</include>
          </includes>
      </configuration>

      <executions>
      <execution>
        <id>execution2</id>
        <phase>test</phase>
       </execution>
      </executions>
    </plugin> 
    </plugins>
  </build>
</profile> 
```

我的测试称为：

```
com.xxxxx.xxx.client.selenium.seller_signup.TestCustomerSignupWizard 
```

但是，当我运行上述配置文件时：

```
mvn test -P AdminSeltests 
```

不运行任何测试。我尝试了以下作为值：

```
<include>**/TestSellerSignupWizard.*</include>
<include>**/TestSeller*.*</include>
<include>**/TestSeller*.java</include>
<include>**/*/TestSeller*.java</include>
<include>
  com.xxxxx.xxx.client.selenium.seller_signup.TestCustomerSignupWizard.java
</include> 
```

这些都不起作用。

有什么想法吗？

谢谢亚当

已解决：我正在使用它`maven-surefire-plugin`，它有一个自动`includes`部分，其中包括您的正常测试内容。所以我做了一个`exclude`配置来排除正常的单元测试，然后是一个`include`包含我想要运行的集成测试模式的部分

不知道为什么它会这样工作，但确实如此：

```
<configuration>
    <excludes>
      <exclude>**/Test*.java</exclude>
      <exclude>**/*Test.java</exclude>
      <exclude>**/*TestCase.java</exclude>
    </excludes>
    <includes>
      <include>**/ITTestSellerSignupWizard.java</include>
    </includes>
</configuration> 
```

谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:37:43.967

您粘贴的实际代码显然不起作用，因为您`TestSellerSignupWizard`在`TestCustomerSignupWizard`. 但是我认为这是一个错字，实际上并不重要，因为 Surefire 的默认包含掩码之一`**/Test*.java`在这种情况下非常适合您。

所以这一切看起来都是可行的解决方案，所以我担心一个问题是你的测试类路径中没有这个类。你提到这在某种程度上与集成测试有关，所以这个类可能位于其中，`src/it/java`而不是`src/test/java`Maven 对 Surefire 的默认设置。如果我是对的，您应该将此类移入`src/test/java`或使用（如您尝试的那样）替代 Surefire 执行，但`testSourceDirectory`参数被覆盖（[链接](http://maven.apache.org/plugins/maven-surefire-plugin/test-mojo.html)）。

# javascript - 组织 javascript 文件以更好地进行混淆

> ID：10298121
> 
> 赞同：1
> 
> 时间：2012-04-24T12:47:05.813
> 
> 标签：javascript, global-variables, obfuscation

```
utilities.js:
function log(message)
{
....
}

module1.js
YAHOO.util.Event.onDOMReady(function()
{
  log("module1 is loaded");
});

module2.js
YAHOO.util.Event.onDOMReady(function()
{
  log("module2 is loaded");
}); 
```

对于页面请求，我将首先加载实用程序.js，然后加载 module1.js 和 module2.js

现在，当我尝试混淆这些文件时，模块中对“日志”的引用不会被混淆，因为它是隐含的全局。

我想将模块文件分开（尽管服务于同一页面）以提高可读性和维护性。此外，utilities.js 中的函数也可以用于其他页面。

如何更好地组织这些文件以改善混淆？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T12:48:34.803

将您的代码放在自执行匿名函数中：

```
(function(){
    YAHOO.util.Event.onDOMReady(function() {
        log("module2 is loaded");
    });
})(); 
```

因此，当您的代码混淆全局函数和变量时，它们仍将具有其*原始*名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:53:33.257

我个人喜欢使用 RequireJS：[http ://requirejs.org/](http://requirejs.org/)

它是一个加载模块的框架，您可以返回要使用的集合或对象，并将所有模块保存在单独的范围内。

# php - 使用 php 抓取 - preg_match_all

> ID：10298122
> 
> 赞同：0
> 
> 时间：2012-04-24T12:47:08.377
> 
> 标签：php, preg-match-all

尝试获取 Internet Data Volume Balance 的值 - 脚本应回显 146.30mb

所有这些都是新手，请查看所有教程。

如何才能做到这一点？

```
<tr >
    <td bgcolor="#F8F8F8"><div align="left"><B><FONT class="tplus_text">Account Status</FONT></B></div></td>
    <td bgcolor="#FFFFFF"><div align="left"><FONT class="tplus_text">You exceeded your allowed credit.</FONT></div></td>
</tr> 

<tr >
    <td bgcolor="#F8F8F8"><div align="left"><B><FONT class="tplus_text">Period Free Time Remaining</FONT></B></div></td>
    <td bgcolor="#FFFFFF"><div align="left"><FONT class="tplus_text">0:00:00 hours</FONT></div></td>
</tr> 

<tr >
    <td bgcolor="#F8F8F8"><div align="left"><B><FONT class="tplus_text">Internet Data Volume Balance</FONT></B></div></td>
    <td bgcolor="#FFFFFF"><div align="left"><FONT class="tplus_text" style="text-transform:none;">146.30 MB</FONT></div></td>
</tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:03:09.550

PHP 可以像 JavaScript 一样与 DOM 交互。这比解析标记要好得多，因为大多数人都会告诉你这是错误的方法：

### 从 HTML 文件加载

```
// Start by creating a new document
$doc = new DOMDocument();
// I've loaded the table into an external file, and am loading it into the $doc
$doc->loadHTMLFile( 'htmlpage.html' );
// Since you have six table cells, I'm calling up all of them
$cells = $doc->getElementsByTagName("td");
// I'm grabbing the sixth cell's textContent property
echo $cells->item(5)->textContent; 
```

此代码将在屏幕上输出“146.30 MB”。

### 从字符串加载

如果您将 HTML 存储在一个字符串中，您也可以将其加载到您的文档中。我们将用于加载文件的方法更改为用于从字符串加载的方法：

```
$str = "<table><tr><td>Foo</td></tr>...</table>";
$doc->loadHTML( $str ); 
```

然后我们将继续使用与上面相同的代码来选择单元格，并在输出中显示它们的 textContent。

查看[DOMDocument](http://www.php.net/manual/en/class.domdocument.php)类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:09:47.260

如果您愿意或已经安装了 phpQuery，您可以使用它。

```
phpQuery::newDocumentFileHTML('htmlpage.html');
echo pq('td:eq(6)')->text(); 
```

# android - 什么是安卓的超频内核？

> ID：10298124
> 
> 赞同：-4
> 
> 时间：2012-04-24T12:47:14.213
> 
> 标签：android, kernel

我在维基百科上读过关于[超频的内容。](http://en.wikipedia.org/wiki/Overclocking)我知道我们可以在 BIOS 设置和硬件设置中更改时钟频率。 **那么超频与作为一种软件的内核有什么关系呢？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:19:24.570

*   BIOS也是一种软件
*   Android 上没有 BIOS
*   CPU频率现在是动态的，必须在运行时控制，不能在启动时静态设置
*   阅读[https://wiki.archlinux.org/index.php/CPU_Frequency_Scaling](https://wiki.archlinux.org/index.php/CPU_Frequency_Scaling)

# forms - 使用 CodeIgniter 表单验证类重新填充隐藏字段

> ID：10298125
> 
> 赞同：0
> 
> 时间：2012-04-24T12:47:15.083
> 
> 标签：forms, validation, codeigniter, repopulation

在表单验证不成功后，我被困在如何重新填充表单中的隐藏字段。

重新填充使用 set_value() 函数打印出其他字段的选定值，但是对于隐藏字段，值字段中已经打印了一些内容。

这是我的视图代码：

```
<? echo validation_errors();?>
<? echo form_open('projects/start');?>
<input type="hidden" name="project_type_id" value="<? echo $this->uri->segment(3);?>" >
<input type="text" name="site" value="<?echo set_value('site');?>">
<input type="submit" value="submit">
<?echo form_close();?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:06:57.503

在这里猜测一下，您希望在首次加载时使用 URI 段填充它，并且一旦表单提交，这将不可用。

也许这会起作用

```
<input type="hidden" name="project_type_id" value="<? echo ($this->input->post())? set_value('project_type_id'): $this->uri->segment(3);?>" > 
```

根据您构建网站的方式，也可以这样做

```
<? echo form_open('projects/start/' . $this->uri->segment(3));?> 
```

保留 URI

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T17:18:48.890

在第二个参数中传递 URI 段值，提交表单后将采用提交的值，它重新填充提交的值而不是 URI 段值。

```
<?php echo validation_errors(); ?>
<?php echo form_open('projects/start'); ?>
<input type="hidden" name="project_type_id" value="<?php echo set_value('project_type_id', $this->uri->segment(3)); ?>" />
<input type="text" name="site" value="<?php echo set_value('site'); ?>" />
<input type="submit" value="submit" />
<?php echo form_close(); ?> 
```

希望这对您有所帮助。谢谢你。

# c++ - c++静态库和c++应用程序中wxwidgets设置路径的区别

> ID：10298132
> 
> 赞同：0
> 
> 时间：2012-04-24T12:47:32.567
> 
> 标签：c++, linker, wxwidgets, static-libraries

我在这里遇到了一个主要问题，我有 wxwidgets-2.8.12（最新稳定版本）和 Netbeans 7.1.1 我制作了一个使用 wxwidgets 的示例项目，在创建我包含的 c++ 应用程序（示例项目）时此链接提供的方式中的 wxwidgets 路径

访问[http://wiki.wxwidgets.org/Compiling_using_Netbeans](http://wiki.wxwidgets.org/Compiling_using_Netbeans)

但是在我的场景中，我有一个静态库，所以我需要询问如何`wx-config --libs`在 c++ 静态库中关联，因为没有链接器选项，而是有 Archiever。

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T12:55:35.283

仅在目标文件集合中的静态库。您无法将静态库与其他库关联。

如果您要为调用并将您的库附加到调用者`yourproject-config`的开发人员重新分发您的项目，请为其他人提供一个脚本。`wx-config --libs`

只有共享对象才能与其他对象关联。

# ajax - 如何在 Apache 中为 REST 设置代理

> ID：10298138
> 
> 赞同：4
> 
> 时间：2012-04-24T12:48:09.043
> 
> 标签：ajax, rest, tomcat, apache2

我正在尝试在 Apache 中为我在另一台服务器上的 RESTful 服务设置一个简单的代理。例如，如果我访问[https://myclient.com/services/hello](https://myclient.com/services/hello)，它将显示 URL [https://myserver.com/services/hello](https://myserver.com/services/hello)的 JSON 。

我这样做是为了让跨域 ajax 工作。我找到了很多关于如何设置的信息，但我找到的建议都没有。我认为这应该相当简单，所以对于某人来说这可能是一个简单的答案。

我当前的设置将我转发到 RESTful URL，而不仅仅是显示内容。我正在使用没有虚拟主机的基本 Apache 设置并在我的 httpd.conf 中配置所有内容。我正在使用 SSL，并且还在同一 Apache 服务器上使用 Tomcat 的代理：

```
SSLProxyEngine On

RewriteEngine On
RewriteCond %{SERVER_PORT} !^443$
RewriteRule ^/(.*) https://%{SERVER_NAME}/$1 [L,R]

ProxyPass /services/ https://myserver.com/services/
ProxyPassReverse /services/ https://myserver.com/services/
ProxyPass / http://localhost:8080/
ProxyPassReverse / http://localhost:8080/ 
```

我也尝试了许多其他设置的组合，包括添加 RewriteRule，但这个简单的配置是我得到的最接近的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T13:00:21.037

问题是由于我设置的 SSO 服务器造成的 - 请求通过该服务器重定向，这导致从 SSO 服务器重定向到 API 服务器。apache 设置是正确的。

# xpages - 如何从自定义控件的属性组中获取属性作为对象？

> ID：10298146
> 
> 赞同：0
> 
> 时间：2012-04-24T12:48:32.150
> 
> 标签：xpages, xpages-ssjs

我正在开发一个在谷歌地图上显示标记的自定义控件。我有几个属性，例如 "maptype" 、 "zoom" 等。在 Javascript 中很容易访问它们：我可以`#{javascript:compositeData.zoom}`用来获取 zoom 属性的值。

现在这是我的问题：我为每个标记使用一组属性。该组的名称是“marker”，一个marker有6个属性：“title”、“layer”、“infotext”、“icon”、“address”和“animation”。

如果我尝试使用

```
var markers = #{javascript:compositeData.marker}; 
```

我在萤火虫中遇到错误：

> 缺失：在属性 id var 标记 = [{layer=2, address=Oldenzaal, animation=DROP, icon=/ogo_notes.png...

一个箭头指向 layer 和 2 之间的第一个 =（我不允许在 stackoverflow 中放入图像）

如果我使用

```
var markers = #{javascript:'"' + compositeData.marker + '"'}; 
```

标记是一个对象，但每个对象都包含一个带有标记所有属性的字符串。

我知道我可以做一些编码来为每个字符串创建一个对象，但如果不是所有属性都需要，这并不容易。如果不需要属性，则它不会出现在字符串中。

我想必须有一种更简单的方法来将每个标记作为一个对象，这样我就可以使用如下代码获取图标的值：

```
var icon = marker.icon 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:08:00.913

您可以使用来获取组内`compositeData.marker.icon`的属性。如果您已为该组选中“允许多个实例”，那么要获取您必须去的属性：`icon``marker`

```
compositeData.marker[0].icon
compositeData.marker[1].icon 
```

等等...

**2012 年 4 月 26 日更新（纳文）**

要将它与客户端 javascript 一起使用，您可以尝试将值放在隐藏的输入字段中，如下所示：

```
<xp:inputHidden id="hdnIcon">
        <xp:this.defaultValue><![CDATA[#{javascript:var value = new Array();
for (var i=0 ; i<compositeData.marker.length ; i++) {
    value.push(compositeData.marker[i].icon);
}
return @Implode(value, ",");}]]></xp:this.defaultValue>
</xp:inputHidden> 
```

这个隐藏输入字段的值可以通过客户端 javascript 读取，如下所示：

```
var value = document.getElementById("#{id:hdnIcon}").value.split(",");
for (var i=0 ; i<value.length ; i++) {
    <YOUR CODE>
} 
```

另一种方法是将`compositeData.marker`其内容转换为 JSON 字符串，然后在其上运行客户端 javascript。

# php - curl请求返回错误的响应代码

> ID：10298149
> 
> 赞同：0
> 
> 时间：2012-04-24T12:48:37.497
> 
> 标签：php, curl, cron, http-response-codes

我需要从 sitemap.xml 文件中获取页面 url 的 http 响应代码。当我通过我的 cron 进程获得响应代码时，它返回 403（称为访问禁止：尽管我可以从浏览器访问传递的 url）。

但如果我从本地主机运行相同的代码，它会返回正确的 http 响应代码（即 200）。

为什么从本地主机和服务器返回不同的http响应代码有区别？如何解决问题？

提取http响应代码的代码如下。

```
function check_response_code() {
    $pageurl='http://www.certona.com/online-merchandising/';
    $trimurl = '';
    $start = '';
    $end = '';
    $total = '';

    $start = microtime(true);
    $response_code = '';
    if (!stristr($pageurl, "http://"))
    {
        if (!stristr($pageurl, "https://"))
        {
            $trimurl = "http://" . $pageurl;
        } else
        {
            $trimurl = $pageurl;
        }
    } else
    {
        $trimurl = $pageurl;
    }
    $curl = curl_init();
    //don't fetch the actual page, you only want headers

    curl_setopt($curl, CURLOPT_URL, $trimurl);
    curl_setopt($curl, CURLOPT_NOBODY, true);
    curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 0);
    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($curl, CURLOPT_FILETIME, true);

    $result = curl_exec($curl);

    $timestamp = curl_getinfo($curl, CURLINFO_FILETIME);
    $response_code = curl_getinfo($curl, CURLINFO_HTTP_CODE);
    $mime_type = curl_getinfo($curl, CURLINFO_CONTENT_TYPE);
    $end = microtime(true);
    $total = round($end - $start, 5);

    if ($timestamp != -1)
    { //otherwise unknown
        $arr=array(date("Y-m-d H:i:s", $timestamp), $response_code, $total, $mime_type); //etc
    } else
    {
        $arr=array("", $response_code, $total, $mime_type);
    }
    echo "<pre>";
    print_r($arr);
    echo "</pre>";
} 
```

谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:07:22.747

这可能有很多原因......

是你自己的服务器吗？=> [http://codewithdesign.com/2011/05/26/curl-403-error-returning/](http://codewithdesign.com/2011/05/26/curl-403-error-returning/)

也许将 CURLOPT_USERAGENT 设置为“Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.5) Gecko/20041107 Firefox/1.0”

或者阅读这个[curl 给出 403 错误？](https://stackoverflow.com/questions/3735403/curl-gives-403-error)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:11:06.207

您的本地主机通过您的计算机运行 curl。就像您的浏览器使用您的 IP 地址和其他内容打开了该站点。

服务器以另一种方式执行此操作。

`/`我记得有一次我通过删除url 中的尾随解决了一个类似的问题。

尝试运行代码为

```
$pageurl = rtrim('http://www.certona.com/online-merchandising/', '/)'; 
```

但基本上我认为您不允许从另一个站点获取目录的数据。
网址不应该`.xml`以获取站点地图为结尾吗？

```
$pageurl = 'http://www.certona.com/sitemap.xml'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:13:42.610

我不确定，但您的代码似乎工作正常

尝试

```
check_response_code();

function check_response_code() {
    $pageurl='http://www.certona.com/online-merchandising/';
    $curl = curl_init($pageurl);
    curl_setopt($curl, CURLOPT_NOBODY, true);
    curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 0);
    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($curl, CURLOPT_FILETIME, true);

    $result = curl_exec($curl);
    $info = curl_getinfo($curl);
    $info['filetime'] = date("Y-m-d H:i:s", $info['filetime']);
    echo "<pre>";
    print_r($info);
    echo "</pre>";
} 
```

输出

```
Array
(
    [url] => http://www.certona.com/online-merchandising/
    [content_type] => text/html; charset=utf-8
    [http_code] => 200
    [header_size] => 488
    [request_size] => 76
    [filetime] => 2012-04-24 15:11:28
    [ssl_verify_result] => 0
    [redirect_count] => 0
    [total_time] => 1.342
    [namelookup_time] => 0
    [connect_time] => 0.25
    [pretransfer_time] => 0.25
    [size_upload] => 0
    [size_download] => 0
    [speed_download] => 0
    [speed_upload] => 0
    [download_content_length] => 0
    [upload_content_length] => 0
    [starttransfer_time] => 1.342
    [redirect_time] => 0
    [certinfo] => Array
        (
        )

    [redirect_url] => 
) 
```

# php - 为 Penny 拍卖网站创建 PHP 套接字服务器心跳

> ID：10298153
> 
> 赞同：0
> 
> 时间：2012-04-24T12:48:53.930
> 
> 标签：php, ajax, serversocket

我相信这是很多人想做的事情，但在我发现的任何地方都没有明确解释。

我正在为客户开发一个便士拍卖网站，我需要构建它，以便每个人都能看到在用户之间同步的准确拍卖计时器。通过研究我得出的结论是我需要设置一个套接字服务器。

我对此知之甚少，希望有人能解释如何设置此功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T12:56:31.287

也许你觉得这里有点复杂。一个简单的 Javascript 倒计时应该可以解决问题。将它放在文档的顶部并立即启动它（而不是在页面加载时），它应该在每个客户端上或多或少地同步。它不是 100% 准确，但它适用于 ebay。

如果需要，请添加 ajax 刷新以重新同步它。

无论如何考虑所有被互联网延迟的客户端操作，因此即使计时器整整 1 秒，它也不应该有很大的不同。

# redis - Redis 读/写

> ID：10298154
> 
> 赞同：1
> 
> 时间：2012-04-24T12:48:56.973
> 
> 标签：redis

刚开始研究redis。

Redis 是一个单线程进程。

这是否意味着所有操作（例如 hset、hget 等）都以串行方式执行 - 这意味着例如使用以下操作：

```
hset foo:bar name 'Redis'
hget foo:bar name 
```

hget 只会在 hset 之后执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:02:28.590

是的，Redis 实例是单线程的，所有基本操作都是原子的和序列化的。使用 Redis，您有并发性，但没有并行性。

在您的示例中，您可以保证 hget 将始终在 hset 之后执行。

您还可以保证，当您在 Redis 连接上发送多个查询时，回复将以完全相同的顺序返回（即 Redis 支持协议流水线）。

请注意，这仅适用于与 Redis 实例的给定连接。如果数据在多个实例上分片，那么将使用多个连接，并且在不同连接上发送的查询之间没有这样的保证。

# iphone - 远程推送通知

> ID：10298157
> 
> 赞同：0
> 
> 时间：2012-04-24T12:49:00.307
> 
> 标签：iphone, ios, push-notification, apple-push-notifications, ipad-2

当应用程序不在前台或后台运行时，我们可以接收远程推送通知吗？基本上应用程序被杀死了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:00:52.690

> 如果在应用程序未运行时收到应用程序的通知，则设备会提醒用户该应用程序有数据等待它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:59:02.830

是的，即使应用程序未运行，您仍会收到推送通知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T14:08:49.420

否，如果收到消息，它将不会启动您的应用程序，它由 iOS 处理。

如果用户选择查看通知，您的应用程序将启动。因此，如果用户没有对通知做出反应，您的应用程序将不会启动。如果 iOS 在用户为您的应用选择推送通知时启动您的应用，您将必须检查 lauchOptions 字典以查看是否有任何推送通知：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {

    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
    // Override point for customization after application launch.
    _rootViewController = [[RootViewController alloc] init];

    self.window.rootViewController = self.rootViewController;   

        NSDictionary *remoteNotif = [launchOptions objectForKey:UIApplicationLaunchOptionsRemoteNotificationKey];

    if (remoteNotif) {
        //Handle notification
    } 
} 
```

如果您的应用程序已经在运行并且在前台，那么应用程序委托将直接收到通知。`- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo`在您的应用程序委托上调用该方法。

# jquery - 带有 jQ uery 样式的 WebForms MultiView

> ID：10298158
> 
> 赞同：1
> 
> 时间：2012-04-24T12:49:02.043
> 
> 标签：jquery, asp.net, webforms

我有一个使用嵌套 ASP.NET MultiView 控件的应用程序，我需要让它看起来像 jquery 选项卡控件。我怎样才能做到这一点？

```
<asp:MultiView ID="multiViewEdit" runat="server">
    <asp:View ID="list" runat="server">
    </asp:View>
    <asp:View ID="edit" runat="server">
        <asp:LinkButton ID="btn1" runat="server" CausesValidation="False" CommandName="cmd1" OnCommand="tabs_Command">Tab 1</asp:LinkButton>
        <asp:LinkButton ID="btn2" runat="server" CausesValidation="False" CommandName="cmd2" OnCommand="tabs_Command">Tab 2</asp:LinkButton>
        <asp:MultiView ID="multiViewEdit" runat="server">
            <asp:View ID="view1" runat="server">
            </asp:View>
            <asp:View ID="view2" runat="server">
            </asp:View>
        </asp:MultiView>
    </asp:View>
</asp:MultiView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T03:18:03.407

尝试将视图中的所有内容放到面板中。

只需运行以下代码作为示例。我想你会想到剩下的。

示例@http [://www.coderun.com/ide/? w=4LA6MssT1ESA32wMa5Uc4w](http://www.coderun.com/ide/?w=4LA6MssT1ESA32wMa5Uc4w)

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="ASPNETWebApplication._Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>jQuery Tabs Demo</title>

    <link rel="stylesheet" href="http://jqueryui.com/themes/base/jquery.ui.all.css">
    <link rel="stylesheet" href="http://jqueryui.com/demos/demos.css">
    <script type="text/javascript"  src="jquery-1.8.0.js"></script>
    <script type="text/javascript"  src="jquery.ui.core.js"></script>
    <script type="text/javascript"  src="jquery.ui.widget.js"></script>
    <script type="text/javascript"  src="jquery.ui.tabs.js"></script>
    <script type="text/javascript">
        $(function(){
            $("#tabsZone").tabs();
        });
    </script>   
</head>
<body>
    <form id="form1" runat="server">
    <div class="demo">
        <div id="tabsZone">
            <ul>
                <li><a href="#tab1">Nunc tincidunt</a></li>
                <li><a href="#tab2">Proin dolor</a></li>
                <li><a href="#tab3">Aenean lacinia</a></li>
            </ul>
            <asp:Panel runat="server" CssClass="ipsumText" ID="tab1">
                <p>Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin. Sed ut dolor nec orci tincidunt interdum. Phasellus ipsum. Nunc tristique tempus lectus.</p>
            </asp:Panel>
            <asp:Panel runat="server" CssClass="ipsumText" ID="tab2">
                <p>Morbi tincidunt, dui sit amet facilisis feugiat, odio metus gravida ante, ut pharetra massa metus id nunc. Duis scelerisque molestie turpis. Sed fringilla, massa eget luctus malesuada, metus eros molestie lectus, ut tempus eros massa ut dolor. Aenean aliquet fringilla sem. Suspendisse sed ligula in ligula suscipit aliquam. Praesent in eros vestibulum mi adipiscing adipiscing. Morbi facilisis. Curabitur ornare consequat nunc. Aenean vel metus. Ut posuere viverra nulla. Aliquam erat volutpat. Pellentesque convallis. Maecenas feugiat, tellus pellentesque pretium posuere, felis lorem euismod felis, eu ornare leo nisi vel felis. Mauris consectetur tortor et purus.</p>
            </asp:Panel>
            <asp:Panel runat="server" CssClass="ipsumText" ID="tab3">
                <p>Mauris eleifend est et turpis. Duis id erat. Suspendisse potenti. Aliquam vulputate, pede vel vehicula accumsan, mi neque rutrum erat, eu congue orci lorem eget lorem. Vestibulum non ante. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Fusce sodales. Quisque eu urna vel enim commodo pellentesque. Praesent eu risus hendrerit ligula tempus pretium. Curabitur lorem enim, pretium nec, feugiat nec, luctus a, lacus.</p>
                <p>Duis cursus. Maecenas ligula eros, blandit nec, pharetra at, semper at, magna. Nullam ac lacus. Nulla facilisi. Praesent viverra justo vitae neque. Praesent blandit adipiscing velit. Suspendisse potenti. Donec mattis, pede vel pharetra blandit, magna ligula faucibus eros, id euismod lacus dolor eget odio. Nam scelerisque. Donec non libero sed nulla mattis commodo. Ut sagittis. Donec nisi lectus, feugiat porttitor, tempor ac, tempor vitae, pede. Aenean vehicula velit eu tellus interdum rutrum. Maecenas commodo. Pellentesque nec elit. Fusce in lacus. Vivamus a libero vitae lectus hendrerit hendrerit.</p>
            </asp:Panel>
        </div>
    </div>
    </form>
</body>
</html> 
```

# actionscript-3 - 如何使用 flex（flash builder 4.6）桌面应用程序的单击功能从一个屏幕导航到另一个屏幕？

> ID：10298164
> 
> 赞同：0
> 
> 时间：2012-04-24T12:49:29.107
> 
> 标签：actionscript-3, apache-flex, flash-builder, desktop-application

我正在开发一个 flex 桌面应用程序，其中我有 2 个屏幕（即 mxml 窗口应用程序）。我想从一个屏幕导航到另一个屏幕（从 mxml 文件到另一个）。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T12:58:41.130

很多方法，但我可能会使用其中一种：

1.  你可以使用[States](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf63611-7ff1.html)来改变屏幕
2.  您可以使用[ViewStack](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7e4d.html)或其他导航器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T07:39:15.240

您可以在桌面应用程序中使用 ViewNavigator，只需要做一些技巧

1.  添加到您的项目 StageOrientationEvent 类

    包 flash.events {

    ```
    public class StageOrientationEvent extends Event
    {
        static public const ORIENTATION_CHANGE:String = "orientationChange";
        static public const ORIENTATION_CHANGING:String = "orientationChanging";

        public function StageOrientationEvent(type:String, bubbles:Boolean=false, cancelable:Boolean=false)
        {
            super(type, bubbles, cancelable);
        }
    } 
    ```

    }

2.  为 ViewNavigator 创建新皮肤

    < s:Skin xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark" xmlns:fb="http://ns.adobe.com/flashbuilder/2009" alpha.disabled="0.5" >

    ```
    <fx:Metadata>[HostComponent("spark.components.ViewNavigator")]</fx:Metadata>

    <fx:Script fb:purpose="styling">
        <![CDATA[         

            override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number) : void
            {
                super.updateDisplayList(unscaledWidth, unscaledHeight);
            }
        ]]>        
    </fx:Script>

    <s:states>
        <s:State name="normal" />
        <s:State name="disabled" />
        <s:State name="landscape" />
        <s:State name="portrait" />
        <s:State name="landscapeAndOverlay" />
        <s:State name="portraitAndOverlay" />
    </s:states>

    <s:Group id="contentGroup" left="0" right="0" top="0" bottom="0" minWidth="0" minHeight="0">
        <s:layout>
            <s:BasicLayout/>
        </s:layout>
    </s:Group> 
    ```

    < /s:Skin>

3.  Add mobilecomponents.swc to your project (you can find it in flex sdk folder, in my case path is C:\Program Files\Adobe\Adobe Flash Builder 4.6\sdks\4.6.0\frameworks\libs\mobile\mobilecomponents.swc)

4.  assign your new ViewNavigator skin (step 2) to ViewNavigator

direct to ViewNavigator instance:

```
<s:ViewNavigator skinClass="path.to.skin.ViewNavigatorSkin"/> 
```

or globally in css

```
s|ViewNavigator{
     skinClass: ClassReference("path.to.skin.ViewNavigatorSkin");
} 
```

# cocoa-touch - ：CGImageCreate：无效的图像位/像素：8

> ID：10298165
> 
> 赞同：2
> 
> 时间：2012-04-24T12:49:29.530
> 
> 标签：cocoa-touch, opencv, uikit

我将 opencv 与 Xcode 一起使用，我使用此方法将 IplImage 转换为 UIImage：

```
-(UIImage *)UIImageFromIplImage:(IplImage *)image {
NSLog(@"IplImage (%d, %d) %d bits by %d channels, %d bytes/row %s", image->width, image->height, image->depth, image->nChannels, image->widthStep, image->channelSeq);

CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
NSData *data = [NSData dataWithBytes:image->imageData length:image->imageSize];
CGDataProviderRef provider = CGDataProviderCreateWithCFData((__bridge  CFDataRef)data);
CGImageRef imageRef = CGImageCreate(image->width, image->height,
                         image->depth, image->depth * image->nChannels, image->widthStep,
colorSpace, kCGImageAlphaPremultipliedLast|kCGBitmapByteOrderDefault,
provider, NULL, false, kCGRenderingIntentDefault);
UIImage *ret = [UIImage imageWithCGImage:imageRef scale:1.0 orientation:UIImageOrientationUp];
CGImageRelease(imageRef);
CGDataProviderRelease(provider);
CGColorSpaceRelease(colorSpace);
return ret;
} 
```

问题是，当我将任何图像传递给此方法（png、jpg、tiff）时，会出现此错误：CGImageCreate: invalid image bits/pixel: 8，请帮助我解决该错误，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-06T09:25:40.183

如果您的图像是灰色的（不是 RGBA），请使用：

`colorSpace = CGColorSpaceCreateDeviceGray();`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T11:18:39.330

根据我在我的应用程序中所做的，您实际上需要在图像数据中提供一个 alpha 值。我所做的是将数据从 opencv 结构中取出，添加一个 alpha 值，然后创建 CGImage。这是我在 C++ API 中使用的代码（如果您坚持使用 C，只需将调用 aMat.ptr<>(y) 替换为指向第 y 行第一个像素的指针）：

```
// Colorspace
CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

 unsigned char* data = new unsigned char[4*aMat.cols*aMat.rows];
 for (int y = 0; y < aMat.rows; ++y)
 {
     cv::Vec3b *ptr = aMat.ptr<cv::Vec3b>(y);
     unsigned char *pdata = data + 4*y*aMat.cols;

     for (int x = 0; x < aMat.cols; ++x, ++ptr)
     {
         *pdata++ = (*ptr)[2];
         *pdata++ = (*ptr)[1];
         *pdata++ = (*ptr)[0];
         *pdata++ = 0;
     }
 }

 // Bitmap context
 CGContextRef context = CGBitmapContextCreate(data, aMat.cols, aMat.rows, 8, 4*aMat.cols, colorSpace, kCGImageAlphaNoneSkipLast);

 CGImageRef cgimage = CGBitmapContextCreateImage(context);

 CGColorSpaceRelease(colorSpace);
 CGContextRelease(context);
 delete[] data; 
```

改组部分是必要的，因为 OpenCV 处理 BGR 图像，而 Quartz 需要 RGB。

# mysql - Mysql 选择如果只有所有大小都等于 0

> ID：10298175
> 
> 赞同：2
> 
> 时间：2012-04-24T12:50:08.467
> 
> 标签：mysql

我有一些mysql表：

```
`items` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `cat_id_p` int(11) NOT NULL,
  `cat_id` int(11) DEFAULT NULL,
  `brand_id` int(11) DEFAULT NULL,
...
)

`items_sizes` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `item_id` int(11) NOT NULL,
  `size_id` int(11) NOT NULL,
  `count` int(11) DEFAULT '1',
...
) 
```

我需要选择只有 items_sizes.count < 1 的项目，而不是至少 count > 1 的项目

这是sql查询：

```
SELECT 
  DISTINCT `items`.* 
FROM 
  (`items2`) 
  LEFT JOIN `items_sizes` ON  items_sizes`.`item_id` = `items`.`id`
WHERE ... 
  AND `items_sizes`.`item_id` = items.id 
  AND `items_sizes`.`count` < 1
GROUP BY `items`.`id` 
ORDER BY `items`.`id` desc
LIMIT 30 
```

但它不起作用......我可能需要If语句吗？

* * *

解决了！只需 SUM 和 HAVING

```
SELECT DISTINCT `items`.*, sum(items_sizes.count)
FROM (`items`) 
LEFT JOIN `items_sizes` ON `items_sizes`.`item_id` = `items`.`id` 
WHERE ...
GROUP BY `items`.`id` 
having sum(items_sizes.count)=0
ORDER BY `items`.`id` desc LIMIT 30 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T12:55:08.747

假设`items2`您的`FROM`子句中的表名是拼写错误，或者`items.*`是拼写错误，应该是`items2.*`...

您没有聚合函数 ( `SUM(), COUNT(), AVG()`)，因此不需要`GROUP BY`. 您似乎也将该子句`WHERE`与. 第一个条件不应该存在：`ON``JOIN``WHERE`

```
SELECT 
  DISTINCT items2.* 
FROM 
  items2
  LEFT JOIN items_sizes ON  items2.id = items_sizes.item_id
WHERE ... 
  AND items_sizes.count < 1
ORDER BY items2.id desc
LIMIT 30 
```

请注意，您的`WHERE`子句中我们看不到的部分 ( `WHERE ...`) 在这里也可能很重要......

可能是不必要的`LEFT JOIN`，并且可能只是`JOIN`因为`items_sizes.count < 1`将消除无论如何都会返回的`NULL`值。`LEFT JOIN`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:55:26.767

```
SELECT 
  DISTINCT * 
FROM 
  `items`
WHERE
  NOT EXISTS (
    SELECT * FROM `items_sizes`
    WHERE
          `items_sizes`.`item_id` = `items`.`id`
      AND `items_sizes`.`count` > 0
  )
  -- ...
ORDER BY `id` desc
LIMIT 30 
```

# asp.net - 简而言之，如何加密一个巨大的查询字符串

> ID：10298177
> 
> 赞同：-2
> 
> 时间：2012-04-24T12:50:09.683
> 
> 标签：asp.net, encryption, query-string

我有一个大约 6000 到 7000 个字符的巨大查询字符串，是否可以简而言之对字符串进行加密？

任何算法？

使用 ASP.NET 作为 Web 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:28:34.613

The short answer is don't do it - it probably indicates you are doing something wrong.

If you have to then I would say the best way would be to store the long query string in a database field and generate a Guid you can store as a key against it.

You can then pass the Guid in the query string and when the page loads you can then retrieve the full details from the database using the key.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-28T10:22:18.817

该 URL 接受 255 个字符，之后您将一无所获。

使用 Kevin 先生提到的数据库存储，或使用上下文会话存储您在查询字符串中发送的变量。

# jquery - 带有价格更新的 AJAX 多个下拉列表

> ID：10298186
> 
> 赞同：0
> 
> 时间：2012-04-24T12:50:30.240
> 
> 标签：jquery, sql, ajax

有人可以帮我处理这段代码吗，我遗漏了一些东西，但不知道是什么。当您选择第一个列表中的一个项目时，它会弹出下一个框，但没有选项可供选择，并且与第三个选项相同，尽管这次我什至没有让该框出现。

我总共需要大约 10 个下拉列表，并且在选择每个选项后，使用 sql 表中的价格列更新底部的价格（我不知道该怎么做）所以你的所有帮助都会很棒，一直现在至少看了 4 个小时，我无处可去。

谢谢

这是html：

```
<body>
<select style="width: 150px;" name="country" id="add-event-dialog-country" onchange="getState(this.value)">
                <?php
                    echo "<option selected='selected' disabled='disabled'> Select Country</option>";
                    $result = mysql_query("SELECT DISTINCT country FROM country");
                    while($row = mysql_fetch_array($result)){
                       echo "<option value='".$row['country']."'>".$row['country']."</option>";
                    }
                ?>
           </select>
           <p id="statediv">
           <select style="width: 150px;" name="add-event-dialog-state" id="add-event-dialog-location" disabled="disabled">
                <option>Select State</option>
           </select>
           </p>
           <p id="citydiv">
           <select style="width: 150px;" name="add-event-dialog-city" id="add-event-dialog-city" disabled="disabled">
                <option>Select City</option>
           </select>
           </p>

Price =<br>
VAT = <br>
Total Price = <br>
</body> 
```

这是js脚本：

```
<script language="javascript" type="text/javascript">
function getXMLHTTP() { 
    var xmlhttp=false;  
    try{
        xmlhttp=new XMLHttpRequest();
    }
    catch(e)    {       
        try{            
            xmlhttp= new ActiveXObject("Microsoft.XMLHTTP");
        }
        catch(e){
            try{
            xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
            }
            catch(e1){
                xmlhttp=false;
            }
        }
    }

    return xmlhttp;
}

function getState(country_Id) {     

    var strURL="findState.php?country="+country_Id;
    var req = getXMLHTTP();

    if (req) {

        req.onreadystatechange = function() {
            if (req.readyState == 4) {
                // only if "OK"
                if (req.status == 200) {                        
                    document.getElementById('statediv').innerHTML=req.responseText;                     
                } else {
                    alert("There was a problem while using XMLHTTP:\n" + req.statusText);
                }
            }               
        }           
        req.open("GET", strURL, true);
        req.send(null);
    }       
}

function getCity(country_Id,state_id) {     

    var strURL="findCity.php?country_name="+country_Id+"&state_name="+state_Id;
    var req = getXMLHTTP();

    if (req) {

        req.onreadystatechange = function() {
            if (req.readyState == 4) {
                // only if "OK"
                if (req.status == 200) {                        
                    document.getElementById('citydiv').innerHTML=req.responseText;                      
                } else {
                    alert("There was a problem while using XMLHTTP:\n" + req.statusText);
                }
            }               
        }           
        req.open("GET", strURL, true);
        req.send(null);
    }       
}
</script> 
```

这是 findState.php

```
<?php 
include 'classes.php';

$country = $_GET['country'];

$query="SELECT state_name FROM state WHERE country_id='$country'";
$result=mysql_query($query) or die(mysql_error());

?>
<select style="width: 150px;" id="add-event-dialog-location" name="add-event-dialog- location" onchange="getZone('<?=$country?>',this.value)">
<option selected='selected' disabled='disabled'>Select State</option>
<?php 
while($row = mysql_fetch_array($result)){
echo "<option value='".$row['state_name']."'>".$row['state_name']."</option>";}
?>
</select> 
```

这是 findCity.php

```
<?php 
include 'classes.php';

$country_id = $_GET['country'];
$state_Id = $_GET['state'];

$query="SELECT city_name FROM city WHERE country_id='1' AND state_id='1'";
$result=mysql_query($query) or die(mysql_error());

?>
<select style="width: 150px;" id="add-event-dialog-location" name="add-event-dialog- location" onchange="getZone('<?=$country?>',this.value)">
<option selected='selected' disabled='disabled'>Select State</option>
<?php 
while($row = mysql_fetch_array($result)){
echo "<option value='".$row['city_name']."'>".$row['city_name']."</option>";}
?>
</select> 
```

我的 SQL 数据库有 3 个表

第一个表称为国家，有 3 列 id、国家和价格

第二个表称为 state，有 4 列 id、country_id、state_name 和 price

第三个表名为 city ，包含 5 列 id、country_id、state_id、city_name 和 price

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:09:07.643

In both findState.php and findCity.php you call the javascript function getZone when the selectlists changes? 而且我看不到您已在任何地方声明了该功能。

然后添加具有相同 ID 的州和城市选择列表。我不认为这是你的问题的原因，但它可能会在以后出现。

编辑：

似乎您在名为 country_name 的变量中提交了国家/地区 ID，但您尝试按国家/地区在 php 中访问它，findCity 也会发生同样的情况

编辑2：

尝试将您的 findstate.php 更改为此

```
<?php 
include 'classes.php';

$country = $_GET['country'];

$query="SELECT state_name FROM state WHERE country_id='$country'";
$result=mysql_query($query) or die(mysql_error());

$country = "'".$country."'";
echo '<select style="width: 150px;" id="add-event-dialog-location" name="add-event-dialog- location" onchange="getZone('.$country.',this.value)">';
echo "<option selected='selected' disabled='disabled'>Select State</option>";

while($row = mysql_fetch_array($result)){
echo "<option value='".$row['state_name']."'>".$row['state_name']."</option>";}
echo "</select>";
?> 
```

问题似乎是 php 无法识别您正在尝试将国家/地区 ID 插入到 html 选择元素中。通过回显所有内容，这应该会更容易。

# c# - 使用 Http Handlers 监听 80 端口

> ID：10298191
> 
> 赞同：3
> 
> 时间：2012-04-24T12:50:46.827
> 
> 标签：c#, asp.net, iis

我需要编写一个 Http Handler 来监听端口 80。

应该采取什么方法？就像我应该使用原始套接字来监听 Http Handler 中的端口 80 还是有更好的方法？

我经历了一些教程，如下所示..

[http://msdn.microsoft.com/en-us/library/ms228090.aspx](http://msdn.microsoft.com/en-us/library/ms228090.aspx)

但不能从中得到太多。任何想法将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T12:54:19.403

HTTP 处理程序只是由应用程序主机调用的处理程序，例如 Internet 信息服务 (IIS)。IIS*可以*侦听端口 80 并调用 HTTP 处理程序，但侦听端口不是 HTTP 处理程序的工作，甚至不关心应用程序主机正在侦听的端口。

> 应该采取什么方法？就像我应该使用原始套接字来监听 Http Handler 中的端口 80 还是有更好的方法？

只需使用 IIS 或[IIS Express 即可](http://learn.iis.net/page.aspx/868/iis-express-overview/)。创建一个 HTTP 处理程序，并让 IIS 侦听端口 80。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:00:47.247

好的。您正在查看的是一种在 IIS 中创建处理程序的方法。如果不需要 IIS，请考虑使用[HttpListener](http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx)从任何应用程序挂钩 HttpPipeline。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T12:56:52.087

套接字是创建 HTTP 处理程序的一种非常灵活的方式，但您必须对套接字做更多的事情。如果像 HttpListener 这样的类能满足你的要求，那么总是去满足它们。除非它会像重新发明轮子一样。

这是一个工作代码示例，展示了如何使用套接字来监听 TCP 请求。 [http://kaninotes.blogspot.com/2012/02/how-to-implement-threaded-server-socket.html](http://kaninotes.blogspot.com/2012/02/how-to-implement-threaded-server-socket.html)

但是，如果您处理 http 的东西，请选择**HttpListener 。**

# javascript - 找不到我的 javascript 函数

> ID：10298192
> 
> 赞同：2
> 
> 时间：2012-04-24T12:50:47.593
> 
> 标签：javascript, jquery

我有以下内容：

```
$(function () {

    $.ajaxSetup({ cache: false });
    var dialogs = {};

    var formSubmitHandler = function (e) {
        ...
    }

} 
```

然后在另一个脚本中我尝试调用

```
function dialogClick(link) {

    $.get(viewUrl + parameters)
            .success(function (content) {
                if (content.match(/^[eE]rror/)) {
                    mvcOnFailure(data)
                } else {
                    $.modal({
                        title: title,
                        closeButton: true,
                        content: content,
                        width: false,
                        resizeOnLoad: true
                    }).find('form').submit(formSubmitHandler).end();
                }
            }) 
```

请注意，我已删减部分脚本以使其易于阅读。没有脚本错误仅显示以下错误：

在第二个脚本中，我收到一条错误消息，提示“SCRIPT5009：'formSubmitHandler' 在 Internet Explorer 中未定义'。

我叫错了吗？我认为该函数将是全局的，当我检查它所在的脚本时，它会附加到页面上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T12:53:01.027

不，它不是全球性的；您的“formSubmitHandler”函数在您发布的第一个示例代码块的“就绪”回调中声明。因此，它是该功能的私有。

如果你真的想要一个全局函数，你可以做的是：

```
window['formSubmitHandler'] = formSubmitHandler; 
```

在第一个函数中。或者，您可以将其设为 jQuery“全局”函数：

```
$['formSubmitHandler'] = formSubmitHandler; 
```

在这种情况下，你会得到它作为`$.formSubmitHandler`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:54:43.570

尝试将您的功能移出功能块，例如

```
$(function () {

    $.ajaxSetup({ cache: false });
    var dialogs = {};
}

var formSubmitHandler = function (e) {
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T12:55:00.823

`formSubmitHandler`仅存在于您声明它的函数范围内，因为您使用了该`var`变量。

您需要：

1.  `dialogClick`在同一范围内声明
2.  `formSubmitHandler`在全局范围内声明，使用`window.formSubmitHandler`或简单地`function formSubmitHandler(){}`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T12:55:42.737

`formSubmitHandler`是在函数不可见的范围内声明的`dialogClick()`函数

所以

*   您要么声明`formSubmitHandler`为`global`
*   或者您在函数`dialogClick`内部定义`document.ready`函数（并且`formSubmitHandler`因为在父范围内所以可以访问）

# asp.net - 你如何让你在导航 div 中对齐树视图控件以防止它向下推内容页面？

> ID：10298195
> 
> 赞同：0
> 
> 时间：2012-04-24T12:50:53.227
> 
> 标签：asp.net, vb.net, html, menu

我在 asp.net VB 中的树视图控件有一个烦人的问题，它在扩展菜单时将内容页面区域向下推。

我创建了适当的 div 来分隔各个部分

母版页非常基本：-

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <link href="StyleSheet.css" rel="stylesheet" type="text/css" />
    <asp:ContentPlaceHolder id="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">

    <div id="wrapper">

    <div id="header">

    <h1>This is header</h1>

    </div>

       <div id="nav">
        <asp:TreeView ID="TreeView1" runat="server" DataSourceID="SiteMapDataSource1" 
               ImageSet="BulletedList2" ShowExpandCollapse="False">
            <HoverNodeStyle Font-Underline="True" ForeColor="#5555DD" />
            <NodeStyle Font-Names="Verdana" Font-Size="8pt" ForeColor="Black" 
                HorizontalPadding="0px" NodeSpacing="0px" VerticalPadding="0px" />
            <ParentNodeStyle Font-Bold="False" />
            <SelectedNodeStyle Font-Underline="True" ForeColor="#5555DD" 
                HorizontalPadding="0px" VerticalPadding="0px" />
        </asp:TreeView>
        <asp:SiteMapDataSource ID="SiteMapDataSource1" runat="server" />
    </div>

    <div id="content">
        <asp:ContentPlaceHolder id="ContentPlaceHolder1" runat="server">

        </asp:ContentPlaceHolder>
    </div>

    <div id="footer">
    <p>This is footer</p>
    </div>

    </div>
    </form>
</body>
</html> 
```

CSS是： -

```
body {

}
#wrapper{
    margin:0 auto;
    width:780px;
}

#nav{

    width:100px;
    border:1px solid black;
    padding:5px;

}

#header{

    height:100px;
    background:blue;
    color:white;
    float:left;
    width:100%;
}

#content{
    margin-left:110px;
    border:1px solid black;
    background:yellow;
    float:left; 

    width:600px;

}

#footer{
    height:200px;
    background:pink;
    clear:both;

} 
```

Treeview 只是将内容页面向下推，我觉得我已经尝试了所有方法，除了使用表格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:00:52.417

我猜你必须正确使用 float 和 z-index 属性，例如

```
nav{width: 100px; height: 100px; float: left; z-index: 1;} 
```

# android - 以编程方式在 android 中启用和禁用 gprs

> ID：10298198
> 
> 赞同：0
> 
> 时间：2012-04-24T12:51:07.300
> 
> 标签：android, gprs

按照我的要求。我想以编程方式启用和禁用 GPRS。我用谷歌搜索了一天，没有找到任何合适的解决方案。是否可以通过我们的代码启用和禁用 GPRS...如果是，请给我一些有价值的链接或想法来做到这一点 。作为**apndroid**应用程序使用相同的东西来实现要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:09:11.737

也许这可以帮助你：

[如何在 Android 上禁用移动数据](https://stackoverflow.com/questions/3644144/how-to-disable-mobile-data-on-android)

此外，您可以检查当前的连接类型（GPRS、2G、LTE 等）

```
TelephonyManager telMgr = (TelephonyManager) _context.getSystemService(Context.TELEPHONY_SERVICE);
telMgr.getNetworkType() 
```

TypeConstants 在 TelephonyManager 类中定义

[http://developer.android.com/reference/android/telephony/TelephonyManager.html](http://developer.android.com/reference/android/telephony/TelephonyManager.html)

总帐

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:12:46.820

这个开源项目中编写的代码可能对您切换 GPRS 很有用。

[在这里检查](http://code.google.com/p/gprswall/source/browse/trunk/src/com/pdaXrom/android/gprswall/GPRSWall.java)

到目前为止我还没有尝试过..所以不能写更多。

# objective-c - 需要选择最好的解决方案来存储我的 ios 数据

> ID：10298199
> 
> 赞同：0
> 
> 时间：2012-04-24T12:51:08.377
> 
> 标签：objective-c, ios

我有 1 兆字节（文本）（用户输入）存储在我的 iOS 应用程序中。用户回答问题（考试问题）。我的目标是将所有答案存储在我的应用程序中，稍后再询问他，例如“给我所有用户“a”回答的好答案，....）女巫存储这些信息的最佳选择`SQLite`？？`property list`（我可以使用 xpath`property list`吗？？），核心数据？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:42:24.973

Core Data 是 iOS 中此类数据存储的标准。

*   [苹果文档](http://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/iPhoneCoreData01/Introduction/Introduction.html)
*   [MagicalRecord](https://github.com/magicalpanda/MagicalRecord)，一个非常有用的核心数据简化库

# android - 格式化我的电脑后谷歌地图中的奇怪行为

> ID：10298200
> 
> 赞同：2
> 
> 时间：2012-04-24T12:51:15.030
> 
> 标签：android, google-maps, api-key

我为我的 Android 应用程序生成了一个 Google Maps API 密钥。它工作得很好。

```
Before some days ago i format my computer,but i stored my map api key. 
```

现在，当我奇怪地将它应用到我的另一个 android 项目中时，地图视图只显示空网格。

请注意，我已允许清单文件中的所有权限。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:06:15.010

您必须重新生成 MD5 指纹才能解决此问题。因为您的 debug.keystore 现在不同了。

# java - Java Applet 中的元素对齐

> ID：10298206
> 
> 赞同：2
> 
> 时间：2012-04-24T12:51:29.747
> 
> 标签：java, swing, applet, alignment, layout-manager

![在此处输入图像描述](../Images/ac82a8af2dfee7c71e250c2529df9a4f.png)![在此处输入图像描述](../Images/92329e90323862b3e956e7294e052d64.png)我正在尝试对齐 Java Applet 中的几个元素，但我无法做到。请帮我。这是我的代码：

```
public class User extends JApplet implements ActionListener,ItemListener  {

             public int sentp,recievedp,corruptedp;
             public String stetus;
             public double energi,nodeid,en;
             TextField name,time,initene,ampco,acttran;
             Button rsbt,vlbt,insd ;
             Choice ch,ch2;
             public String patrn;
             public void init() {

                 this.setSize(800,600);

                 Label namep= new Label("\n\nEnter the No. of Nodes: ", Label.CENTER);

                 name = new TextField(5);
                 Label timep = new Label("\n\nEnter time of Simulation: ",Label.CENTER);
                 time = new TextField(5);    
                 Label initen  = new Label("\n\nInitial Energy Of Each Sensor Node:");
                 initene = new TextField("10^-4 Joules");
                 initene.setEditable(false);
                 Label ampcon = new Label("\n\nAmplifier Constant:");
                 ampco = new TextField("10^-12 Joules");
                 ampco.setEditable(false);
                 Label acttrans = new Label("\n\nEnergy Required To Activate Transmitter/Reciever:");
                 acttran = new TextField("50 ^ -9 Joules");
                 acttran.setEditable(false);
            Label chp = new Label("\n\nSelect Radio Model:",Label.CENTER);
               rsbt = new Button("Run The Simulation");

             ch= new Choice();

             ch.add("");
             ch.add("Gaussian RadioModel");
             ch.add("Rayleigh RadioModel");
             Label pat= new Label("\n\nDistribution Pattern");
             ch2= new Choice();
             ch2.add("");
             ch2.add("Rectangular Pattern");
             ch2.add("Linear Pattern");
             ch2.add("Random Pattern");

             vlbt=new Button("ViewLog");
             insd=new Button("Details of node");
           JPanel cp = new JPanel();
          this.add(cp);
             GridBagLayout gridb = new GridBagLayout();
             Container cont = getContentPane();
            cont.setLayout(gridb);
            add(cp);

            GroupLayout layout = new GroupLayout(cp);
         cp.setLayout(layout);

             layout.setAutoCreateGaps(true);
             layout.setAutoCreateContainerGaps(true);
     layout.setVerticalGroup(
       layout.createSequentialGroup()

       .addGroup(layout.createParallelGroup()
.addComponent(namep)
.addComponent(name)
.addComponent(rsbt))
.addGroup(layout.createSequentialGroup()
.addComponent(timep)
.addComponent(time)
.addComponent(vlbt))
.addGroup(layout.createSequentialGroup()
.addComponent(chp)
.addComponent(ch))
.addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
.addComponent(pat)
.addComponent(ch2))
.addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
.addComponent(initen)
.addComponent(initene))
.addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
.addComponent(ampcon)
.addComponent(ampco))
.addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
.addComponent(acttrans)
.addComponent(acttran))
);

          rsbt.addActionListener(this);
          vlbt.addActionListener(this);
          insd.addActionListener(this);
          ch.addItemListener(this);   
            ch2.addItemListener(this); 
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T14:04:17.293

试试这个，这对你有好处吗：

```
import java.awt.*;
import javax.swing.*;

public class AppletLayout extends JApplet
{
    private JTextField noNodeField;
    private JTextField timeSimField;
    private JTextField iniEngField;
    private JTextField ampConsField;
    private JTextField engReqField; 

    private JComboBox selModeCombo;
    private JComboBox distPattCombo;

    private JButton runSimButton;
    private JButton logButton;
    private JButton detailNodeButton;

    private String[] selectionModelString = {"", "Gaussian RadioModel"
                                               , "Rayleigh RadioModel"};

    private String[] distPatternString = {"", "Rectangular Pattern"
                                               , "Linear Pattern"
                                               , "Random Pattern"}; 

    public void init()
    {
        try
        {
            SwingUtilities.invokeLater(new Runnable()
            {
                public void run()
                {
                    createAndDisplayGUI();
                }
            });
        }
        catch(Exception e)
        {
            System.err.println("Unable to Create and Display GUI : " + e.getMessage());
            e.printStackTrace();
        }
    }

    private void createAndDisplayGUI()
    {
        JLabel noNodeLabel = new JLabel("Enter the No. of Nodes :", JLabel.LEFT);
        noNodeField = new JTextField(5);

        JLabel timeSimLabel = new JLabel("Enter time of Simulation :", JLabel.LEFT);
        timeSimField = new JTextField(5);

        JLabel iniEngLabel = new JLabel("Initial Energy Of Each Sensor Node :", JLabel.LEFT);
        iniEngField = new JTextField("10^-4 Joules");

        JLabel ampConsLabel = new JLabel("Amplifier Constant :", JLabel.LEFT);
        ampConsField = new JTextField("10^-12 Joules");

        JLabel engReqLabel = new JLabel("Energy Required To Activate Transmitter/Reciever :", JLabel.LEFT);
        engReqField = new JTextField("50 ^ -9 Joules");

        JLabel selModeLabel = new JLabel("Select Radio Model :", JLabel.LEFT);
        selModeCombo = new JComboBox(selectionModelString);

        JLabel distPattLabel = new JLabel("Distribution Pattern :", JLabel.LEFT);
        distPattCombo = new JComboBox(selectionModelString);

        runSimButton = new JButton("Run Simulation");
        logButton = new JButton("View Log");
        detailNodeButton = new JButton("Details of Node");

        JComponent contentPane = (JComponent) getContentPane();

        JPanel topPanel = new JPanel();
        topPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
        topPanel.setLayout(new GridLayout(0, 2));
        topPanel.add(noNodeLabel);
        topPanel.add(noNodeField);
        topPanel.add(timeSimLabel);
        topPanel.add(timeSimField);
        topPanel.add(iniEngLabel);
        topPanel.add(iniEngField);
        topPanel.add(ampConsLabel);
        topPanel.add(ampConsField);
        topPanel.add(engReqLabel);
        topPanel.add(engReqField);
        topPanel.add(selModeLabel);
        topPanel.add(selModeCombo);
        topPanel.add(distPattLabel);
        topPanel.add(distPattCombo);
        JPanel buttonPanel = new JPanel();
        buttonPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
        //buttonPanel.setLayout(new BoxLayout(buttonPanel, BoxLayout.Y_AXIS));
        buttonPanel.setLayout(new GridLayout(0, 1, 5, 5));
        buttonPanel.add(runSimButton);
        buttonPanel.add(logButton);
        buttonPanel.add(detailNodeButton);

        JPanel mainPanel = new JPanel();
        mainPanel.setLayout(new BorderLayout(5, 5));
        mainPanel.add(topPanel, BorderLayout.CENTER);
        mainPanel.add(buttonPanel, BorderLayout.LINE_END);

        contentPane.add(mainPanel, BorderLayout.PAGE_START);

        setSize(1000, 600);
    }
} 
```

这是输出：

![杰普莱](../Images/7ef43b4ae5b810d02e26fe88c185c9f5.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T13:41:18.963

您当前的代码看起来很像您正在使用某种 GUI 构建器工具来生成最终布局。

为了最大程度地控制，构建组件并将它们添加到面板中。如果您希望使用代码中所示的 GridBagLayout，请遵循如下所示的序列构造

```
JPanel p1 = new JPanel(new GridBagLayout());
GridBagConstraints cs = new GridBagConstraints();
    cs.fill = GridBagConstraints.HORIZONTAL;
    lblUsername = new JLabel("Name: ");
    cs.gridx = 0;
    cs.gridy = 0;
    cs.gridwidth = 1;
    p1.add(lblUsername, cs);

    txtUsername = new JTextField("", 20);
    cs.gridx = 1;
    cs.gridy = 0;
    cs.gridwidth = 2;
    p1.add(txtUsername, cs);
   ...
   add(cp); 
```

或者使用 BorderLayout 或 FlowLayout 将组件保存在面板上：

```
JPanel p1 = new JPanel(new BorderLayout());
p1.add(lblUsername, BorderLaout.EAST);
... 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T13:17:36.010

当你这么说

```
JPanel cp = new JPanel(); 
```

这意味着您将`FlowLayout`自动获得一个。你可能想要一个[不同的](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)。

编辑：好的，我可以看到您在哪里提供`cp`a `GroupLayout`，但我看不到您所在`pack()`的窗口所在的位置`cp`或 call `setVisible()`。

编辑：但这对于小程序无关紧要。

# c++ - 虚拟继承

> ID：10298207
> 
> 赞同：1
> 
> 时间：2012-04-24T12:51:36.580
> 
> 标签：c++, constructor, virtual-inheritance

如果我有类似的东西

```
class Base1 {};

class Base2 {};

class Derived : public Base1, public Base2 {}; 
```

然后构造 Derived 对象的构造函数调用顺序是

```
Base1
Base2 
```

即按照它们出现的顺序

```
class Derived : public Base1, public Base2 {}; 
```

但是，如果我将其更改为派生类： public Base1, virtual public Base2 {}; 然后构造函数调用的顺序变为

```
Base2
Base1 
```

我不明白为什么会这样？

另一个简单的疑问：虚拟继承Base1的意义和目的是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T12:54:20.793

这些只是规则。正在构造的最派生类首先初始化层次结构中的所有虚拟基类，然后再开始初始化其非虚拟直接基类。

规则来自标准 (ISO/IEC 14882:2011) 第 12.6.2 [class.base.init] / 10 节。

这种方法的基本原理是，它确保所有基类在其派生类之前初始化，无论它们是否是虚拟基类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T13:07:40.727

关于初始化的顺序，Charles已经答对了：就是规则，先声明顺序的虚基，然后声明顺序的非虚基，然后声明顺序的成员变量。

虚拟继承是什么意思？这意味着您的对象派生自该特定基础，但是如果在层次结构中多个子对象（完整类型的基础）实际上继承自同一基础类型，则将仅存在一个基础子对象。您可以在那里阅读`virtual`关键字，因为*我愿意`base`与完整类型的其他对象*分享我的关键字。

```
struct ubase {};
struct sbase {};
struct A : ubase, virtual sbase {};   // has a sbase subobject, but is willing to share..
struct B : ubase, virtual sbase {};   // ... but want to have my own ubase
struct C : A, B {};                   // only one sbase subobject, shared by A and B
                                      // ... but two ubase subobjects, A::ubase and B::ubase 
```

根据第二个问题，你想什么时候使用虚拟继承？每当在类型层次结构中，您最终可能不止一次地从同一个基类继承，而在您的设计中，所有这些基类的出现都只是一个。一般来说，除了少数特殊情况外，使用虚拟继承是很不常见的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T12:59:50.193

至于虚拟继承。当你有一个像下面这样的派生类时，它就会发挥作用

```
class A {};
class B : public virtual A {} ;
class C : public virtual A {} ;
class D : B, C { }  // this class has only one instance of A! 
```

又名钻石问题！

# java - 通过java写入CSV

> ID：10298210
> 
> 赞同：0
> 
> 时间：2012-04-24T12:51:49.057
> 
> 标签：java, csv

通过java将列名写入CSV文件时，列中两个单词之间的空格会出现为双引号......

例如。test_data[0][36] = "真正接受"; 在 csv 文件中显示为 True" 接受..

有什么想法可以解决这个问题吗？

这是代码：

```
private void writeToCSV() throws IOException {
   CSVWriter writer = new CSVWriter(new FileWriter("list_of_churners.csv"),',',' '); 
   String [] data = new String[40]; 
   for(int i=0;i<341;i++)
   { 
      for(int k=0;k<40;k++)
      {      
         data[k] = test_data[i][k]; 
      }
      writer.writeNext(data); 
   }
   writer.close()
} 
```

**编辑：** 这是解决方案：

**CSVWriter writer = new CSVWriter(new FileWriter("list_of_churners.csv"),',','\t ');**

将空格 ' ' 更改为 '\t' 可以解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:27:49.930

Use a framework for writing and reading CSV files. I recommend [OpenCSV](http://opencsv.sourceforge.net/).

# postgresql - 如何将列添加到现有表，然后在单个 PostgreSQL 函数中使用它

> ID：10298212
> 
> 赞同：0
> 
> 时间：2012-04-24T12:52:07.267
> 
> 标签：postgresql

我有一个由第三方产品在 PostgreSQL（版本 9）数据库中创建的表，我需要更改该表以添加一个新列，然后将相关列设置为标准值。

我的函数中有以下内容：

```
CREATE FUNCTION alterscorecolumns()
  RETURNS void AS
$BODY$

ALTER TABLE "hi_scores" ADD "total_score" integer;

UPDATE "hi_scores" SET total_score = score1+score2+score3;

$BODY$ 
```

但是，我不允许这样做，因为它不知道该`total_score`字段存在。我刚收到消息`ERROR: column "total_score" of relation "hi_scores" does not exist.`

我猜这有一些与执行计划相关的原因，也许我需要告诉它`ALTER TABLE`在它尝试执行更新之前运行它，但我似乎无法弄清楚我需要做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T12:53:49.420

只需将 DEFAULT 添加到您的语句中，如下所示：

```
ALTER TABLE "hi_scores" ADD "total_score" integer DEFAULT 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:54:19.610

你不能那样做。创建函数时会解析函数中的 SQL。在创建函数时，该列不存在，因此您会收到错误消息。

您将需要使用动态 SQL 来运行 UPDATE 语句。

就像是：

```
CREATE FUNCTION alterscorecolumns()
  RETURNS void AS
$BODY$
begin
  execute 'ALTER TABLE hi_scores ADD total_score integer';
  execute 'UPDATE hi_scores SET total_score = score1+score2+score3';
$BODY$
language plpgsql; 
```

（未经测试，因此可能存在语法错误）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T05:21:51.460

@mu 已经提供：如果要将此过程保存为函数，则必须使用带有`EXECUTE`. 但仅限于`UPDATE`. 该`ALTER TABLE`声明工作得很好。

由于这显然是*一次性操作*（不能两次添加同一列），因此为此目的持久化一个函数几乎没有意义。您可以改用`DO`语句：

```
DO 
$BODY$
BEGIN
   ALTER TABLE hi_scores ADD total_score integer;
   EXECUTE 'UPDATE hi_scores SET total_score = score1+score2+score3';
END;
$BODY$; 
```

但话又说回来，保持简单：只需执行两条 SQL 语句。一旦`ALTER TABLE`完成，`UPDATE`它将正常工作。是否在交易中 - 没关系，只要您按顺序执行它们即可。

```
 ALTER TABLE hi_scores ADD total_score integer;

  UPDATE hi_scores SET total_score = score1+score2+score3; 
```

# mysql - linux中MySQL数据的自动备份

> ID：10298215
> 
> 赞同：1
> 
> 时间：2012-04-24T12:52:13.117
> 
> 标签：mysql, linux, backup

我一直在寻找一个简单的脚本来自动（每周）在 Linux 中备份 MySQL 数据，但找不到对我来说清楚的东西。我正在手动进行备份：

```
mysqldump -u root -ppassword billing  -r "/file/private/billing_backup.sql 
```

能否请您指导我执行自动备份的简单脚本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T12:56:02.663

我想您可以将自己提供的命令放入脚本中，然后将其添加到 cron。有关如何执行此操作的说明，请参见[http://www.scrounge.org/linux/cron.html 。](http://www.scrounge.org/linux/cron.html)

这将覆盖 /file/private/billing_backup.sql 每次；您可以使用带时间戳的文件名来避免这种情况

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-05-23T20:07:42.607

附加的 bash 脚本是我每天在 cron 中运行的脚本。备份完成后，bash 脚本会通过电子邮件通知您。备份保留 5 天，然后删除。我也有这个脚本向我发送有关服务器信息的通知，例如我的备份目录的内存和存储。请随时修改此脚本以满足您的需要。您将需要更改 bash 脚本的 # variables 部分中的一些变量。

脚本中的电子邮件部分也需要修改以在 NOTIFY_EMAIL="root@gmail.com" 中使用您的电子邮件地址。

您可以在根目录的 my.cnf 中或在 # [Define Variables] 下的 bash 脚本中添加 mysql root 用户帐户信息。

您将需要使用 chmod bash 脚本

```
$sudo chmod +x backupmysql.sh 
```

这将允许您使用以下命令手动运行脚本，或使用下面列出的 crontab 自动执行 MySQL 备份。

```
$sudo ./backupmysql.sh 
```

您可以随意命名脚本。在此示例中，我将其命名为 nightly_mysql_backup.sh。

这是 nightly_mysql_backup.sh bash 脚本：

```
#!/bin/bash
#
############################################################################
#
# Script:   nightly_mysql_backup.sh
# Date:     05-23-2018
# Author:   
#
# Description:  
#
# Usage:        
#
# History:  
#
############################################################################
#
# Variables
HOST=`hostname -s`
DELETE_BACKUPS_OLDER_THAN_DAYS=5
syslogtag=MySQL-Backup
DEST=/var/dba/backup/
DBS="$(mysql -u root -Bse 'show databases' | egrep -v '^Database$|hold$' | grep -v 'performance_schema\|information_schema')"
DATE=$(date +'%F')
MIN_BACKUP=1000 #NOTE: 1 Kilobit = 1000 bit
DAYS_KEPT=5

# Backup all existing databases.  Currently disabled, can be enabled to backup certain individual databases.
#DBS="$($MYSQL -u $MyUSER -h $MyHOST -p$MyPASS -Bse 'show databases')"
#DBS="$(mysql -u root -Bse 'show databases' | egrep -v '^Database$|hold$' | grep -v 'performance_schema\|information_schema')"
# Or specify which databases to backup
#DBS="mysql zarafa"

# DO NOT BACKUP these databases.  Currently disabled, can be enabled to not backup certain individual databases.
#NOBKDB="test"

# Send Result EMail can be toggled on or off
SEND_EMAIL=1
NOTIFY_EMAIL="root@gmail.com"
NOTIFY_SUBJECT="MariaDB Backup Notification on ${HOST}"

# Linux bin paths, change this if it can't be auto detected via which command
MYSQLDUMP="$(which mysqldump)"
GREP="$(which grep)"
CHOWN="$(which chown)"
CHMOD="$(which chmod)"
GZIP="$(which gzip)"
MAIL="$(which mail)"
FIND="$(which find)"
DF="$(which df)"
FREE="$(which free)"
DU="$(which du)"

# Function for generating Email
function gen_email {
DO_SEND=$1
TMP_FILE=$2
NEW_LINE=$3
LINE=$4
if [ $DO_SEND -eq 1 ]; then
if [ $NEW_LINE -eq 1 ]; then
echo "$LINE" >> $TMP_FILE
else
echo -n "$LINE" >> $TMP_FILE
fi
fi
}

# Temp Message file used for recording data on backup and cleanup
TMP_MSG_FILE="/tmp/$RANDOM.msg"
if [ $SEND_EMAIL -eq 1 -a -f "$TMP_MSG_FILE" ]; then 
rm -f "$TMP_MSG_FILE"
fi

set -o pipefail

# Start backing up databases and check if today's backup already exists
STARTTIME=$(date +%s)
for db in ${DBS[@]};
do  

skipdb=-1
if  [ "$NOBKDB" != "" ];
then
for i in $NOBKDB
do
[ "$db" == "$i" ] && skipdb=1 || :
done
fi

GZ_FILENAME=$HOST-$db-$DATE.sql.gz

if [[ -f ${DEST}${GZ_FILENAME} ]]; then 
echo "Backup file ${DEST}$GZ_FILENAME already exists for today. Exiting."
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "Error: Backup files ${DEST}$GZ_FILENAME: already exists for today."
elif  [ "$skipdb" == "-1" ] ; then
# connect to mysql using mysqldump for select mysql database
# and pipe it out to gz file in backup dir
mysqldump -u root --quote-names --opt --single-transaction --quick $db | gzip -cf > $DEST$HOST-$db-$DATE.sql.gz
ERR=$?
if [ $ERR != 0 ]; then
NOTIFY_MESSAGE="Error: $ERR, while backing up database: $db"
logger -i -t ${syslogtag} "MySQL Database Backup FAILED; Database: $db"
else
NOTIFY_MESSAGE="Successfully backed up database: $db "
logger -i -t ${syslogtag} "MySQL Database Backup Successful; Database: $db"
fi
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "$NOTIFY_MESSAGE"
echo $NOTIFY_MESSAGE
fi
done

ENDTIME=$(date +%s)
DIFFTIME=$(( $ENDTIME - $STARTTIME ))
DUMPTIME="$(($DIFFTIME / 60)) minutes and $(($DIFFTIME % 60)) seconds."

# Empty line in email and stdout
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 ""
echo ""

# Log Time
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "mysqldump took: ${DUMPTIME}"
echo "mysqldump took: ${DUMPTIME}"

# Empty line in email and stdout
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 ""
echo ""

#Make sure we have a minimum number of files.  If we don't than e-mail.
DATABASE_COUNT=$(mysql -u root -e 'show databases;' | egrep -v '^Database$|hold$' | grep -v 'performance_schema\|information_schema'| wc -l)
BACKUP_COUNT=$(find ${DEST} -maxdepth 1 -iname '*.gz' | wc -l)
if [ $BACKUP_COUNT -eq 0 ] 
then
NOTIFY_MESSAGE="No backup files exist in $DEST. total files: $BACKUP_COUNT  ERROR!!!!"
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "$NOTIFY_MESSAGE"
echo $NOTIFY_MESSAGE
elif  [ $BACKUP_COUNT -le  $((($DATABASE_COUNT) * ${DAYS_KEPT})) ]
then
NOTIFY_MESSAGE="Only found $BACKUP_COUNT backup files. No cleanup will be done at this time.";
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "$NOTIFY_MESSAGE"
echo $NOTIFY_MESSAGE
elif [ $BACKUP_COUNT -gt $((($DATABASE_COUNT) * ${DAYS_KEPT})) ]
then
NOTIFY_MESSAGE="$BACKUP_COUNT backup files over the amount. Cleanup to occur on $DEST"
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "$NOTIFY_MESSAGE"
echo $NOTIFY_MESSAGE
fi

# Empty line in email and stdout
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 ""
echo ""

#Delete backups older than 5 days
total_backup=$(ls -tr $DEST | wc -l)
TO_DELETE=$(find ${DEST} -maxdepth 1 -type f -iname "*.sql.gz" -daystart -mtime +    $(($DELETE_BACKUPS_OLDER_THAN_DAYS-1)) -print | sort | head -n $total_backup)
if [ -n "$TO_DELETE" ]
then
echo "Deleting the following files: $TO_DELETE"
NOTIFY_MESSAGE="Deleting the following files: $TO_DELETE "
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "Deleting: $TO_DELETE: "
echo $TO_DELETE | xargs rm
echo "Files deleted."
NOTIFY_MESSAGE="OK: Files deleted."
else
NOTIFY_MESSAGE="No files to delete."
fi

gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "$NOTIFY_MESSAGE"
echo "$NOTIFY_MESSAGE"

# Empty line in email and stdout
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 ""
echo ""

for i in ${DEST}*.sql.gz
do
#Check to make sure we have a backup from today. If we don't then e-mail
if [[ ! -f ${DEST}/${GZ_FILENAME} ]]; then 
echo "Today's backup file, ${DEST}/${GZ_FILENAME}, not found.";
NOTIFY_MESSAGE="Today's backup file, ${DEST}/${GZ_FILENAME}, not found.";
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "$NOTIFY_MESSAGE" 
fi

#Make sure the backups has some reasonable size to it. If it doesn't then e-mail
SIZE_BYTES=$(stat -c%s ${i} )
SIZE=$(( SIZE_BYTES + 512 / 1024 ))
if [[ ! $SIZE -gt $MIN_BACKUP ]]; then
echo "Backup file: ${i} is smaller than the expected size.  Expecting > ${MIN_BACKUP} bit and got ${SIZE} bit";
NOTIFY_MESSAGE="Backup file: ${i} is smaller than the expected size.  Expecting > ${MIN_BACKUP} bit and got ${SIZE} bit";
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "$NOTIFY_MESSAGE" 
fi
done

# Empty line in email and stdout
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 ""
echo ""

# Disk space stats of backup file system
if [ $SEND_EMAIL -eq 1 ]; then
$DF -h "$DEST" >> "$TMP_MSG_FILE"  
fi
$DF -h "$DEST"

# Empty line in email and stdout
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 ""
echo ""

# Memory stats of file system
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "Memory status on $HOST: "
echo "Memory status on $HOST: "
if [ $SEND_EMAIL -eq 1 ]; then
$FREE -m -h >> "$TMP_MSG_FILE"  
fi
$FREE -m -h

# Empty line in email and stdout
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 ""
echo ""

# List of current backup files email and stdout
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 "List of current backup files: "
echo "List of current backup files: "
if [ $SEND_EMAIL -eq 1 ]; then
$DU -hsc --time --apparent-size ${DEST}* >> "$TMP_MSG_FILE"
fi
$DU -hsc --time --apparent-size ${DEST}*

# Empty line in email and stdout
gen_email $SEND_EMAIL $TMP_MSG_FILE 1 ""
echo ""

# Sending notification email and cleanup of temporary file
if [ $SEND_EMAIL -eq 1 ]; then
$MAIL -s "$NOTIFY_SUBJECT" "$NOTIFY_EMAIL" < "$TMP_MSG_FILE"
rm -f "$TMP_MSG_FILE"
fi

exit 
```

使用 crontab -e 将 crontab 作业设置为以下内容。这将在每周日午夜运行。$sudo crontab -e

```
0 0 * * 0 /path to backup file/nightly_mysql_backup.sh 
```

您可以使用 gunzip 解压缩 sql.gz 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:17:59.450

[automysqlbackup](http://sourceforge.net/projects/automysqlbackup/)是一个相当不错的维护 mysql 数据库备份的工具。不确定是否可以指示它只进行每周备份，但它会每周和每月轮换备份。

# wpf - 在 wpf 中移动任何控件

> ID：10298216
> 
> 赞同：5
> 
> 时间：2012-04-24T12:52:16.970
> 
> 标签：wpf, controls

我正在尝试使用 wpf 移动控制`Canvas`

这是**XAML**

```
 <Canvas Grid.Column="1" Grid.Row="0" x:Name="DropCanvas"   AllowDrop="True"  DragOver="DropCanvas_DragOver" 
            Drop="Canvas_Drop" DragEnter="Canvas_DragEnter" Background="#12000000" >
        <TextBox Canvas.Left="162" Canvas.Top="188" Height="23" Name="textBox1" Width="120"  
                 PreviewMouseMove="textBox1_PreviewMouseMove" 
                 PreviewMouseLeftButtonDown="textBox1_PreviewMouseLeftButtonDown" 
                 PreviewMouseUp="textBox1_PreviewMouseUp" />
    </Canvas> 
```

这是**代码**

```
 Point p = new Point();
    private void textBox1_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
    {
        Control control = sender as Control;

        control.CaptureMouse();
        p = e.GetPosition(control);   
    }

    private void textBox1_PreviewMouseMove(object sender, MouseEventArgs e)
    {       
            Control control = sender as Control;
            Point x = e.GetPosition(control);
            if (e.LeftButton == MouseButtonState.Pressed)
            {
                Canvas.SetLeft(control, Canvas.GetLeft(control) + (x.X - p.X));
                Canvas.SetTop(control, Canvas.GetTop(control) + (x.Y - p.Y));
            }
            p = x;          
    }

    private void textBox1_PreviewMouseUp(object sender, MouseButtonEventArgs e)
    {
        Control control = sender as Control;
        control.ReleaseMouseCapture();

        activated = false;        
    } 
```

代码正在运行，但是当它移动时，控件会抖动。
问题是什么

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T13:20:45.083

当您调用时，`GetPosition`您应该使用`DropCanvas`作为参数而不是控件。您会看到振动，因为 TextBox 一直在移动，您需要修复一些东西。

或者，您可以使用`MouseDragElementBehavior`Expression Blend SDK 中的可用功能来移动容器中的对象。

此外，该项目对您可能有用：http: [//www.codeproject.com/Articles/24681/WPF-Diagram-Designer-Part-4](http://www.codeproject.com/Articles/24681/WPF-Diagram-Designer-Part-4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-20T07:18:34.213

```
 public void dragme(object sender, MouseButtonEventArgs e)
{
    if (_Move.IsChecked == true)
        db.Attach((DependencyObject)sender); 
```

}

//// MouseDragElementBehavior db;

```
 private void canvass_PreviewMouseDown(object sender, MouseButtonEventArgs e) 
{
if (_Move.IsChecked == true && filmgrid.Visibility == Visibility.Visible)// == true)  
        {
            filmgrid.PreviewMouseDown += new MouseButtonEventHandler(dragme); 
        } 
```

# sql - 在sql中查找移入移出的ascii值？

> ID：10298217
> 
> 赞同：0
> 
> 时间：2012-04-24T12:52:21.677
> 
> 标签：sql, sql-server, sql-server-2008, ascii

我有一些记录真的很乱。我的团队负责人告诉我找出 ascii 值为 14 和 15 的字符的位置。

我有一个查询

```
SELECT CHARINDEX(CHAR(14),X_CUSTOMER_COMMENTS)
FROM vp_service_requests;

SELECT CHARINDEX(CHAR(15),X_CUSTOMER_COMMENTS)
FROM vp_service_requests; 
```

它返回 0，因为在谷歌搜索后我无法找到具有 14 和 15 ascii 值的字符，我发现 14 和 15 ascii 值用于移入和移出它在键盘上的表示方式，因此我可以尝试使用 CHAR(14 ） 功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T12:56:09.783

它应该是 Ctrl-N 和 Ctrl-O 虽然我怀疑这会有所帮助。

尝试将记录加载到一个好的编辑器中并以 HEX 格式查看它们。奇怪的角色应该像拇指一样突出

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:57:02.053

作为旧 DOS 时代的保留，Windows 仍然允许您通过按住 ALT 键从键盘输入某些旧 ASCII 键，然后输入您希望输入的三位代码（从 10 键键盘，而不是键盘顶部的数字行），例如 14，输入 ALT-014。

但是，一些较低级别的代码是从旧的终端功能继承而来的，例如 ASCII 7 是响铃，8 是退格，例如，而不是键入*字符*，它们会导致光标以某种方式运行或引发应用程序以明确的方式作出回应。您可以嵌入一个 CHAR(XX) 值进行测试，只需将该值连接到一个字符串中并将其插入到您的测试表中。

# asp.net-mvc - 实体框架保存更改错误

> ID：10298221
> 
> 赞同：1
> 
> 时间：2012-04-24T12:52:33.257
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, savechanges

我有一个向导步骤，用户在其中填写字段。然后，我使用 json 将每个向导步骤的值保存到我的数据库中。但是，在我的存储库中，我有我的 savechanges()。但它不会保存更改，而是会引发错误：

> “NKImodeledmxContainer.SelectedQuestion”中的实体参与“QuestionSelectedQuestion”关系。找到 0 个相关的“问题”。预计有 1 个“问题”。

任何人都知道如何摆脱错误？我是否必须从 Question 中获取 ID 并将其保存到我的数据库中，或者我可以在 EF 中更改某些内容以便不会抛出错误消息？

这是我在控制器中的帖子：

```
 [HttpPost]
    public JsonResult AnswerForm(int id, SelectedQuestionViewModel model)
    {
        bool result = false;
        var goalCardQuestionAnswer = new GoalCardQuestionAnswer();
        goalCardQuestionAnswer.SelectedQuestion = new SelectedQuestion();

        goalCardQuestionAnswer.SelectedQuestion.Id = model.QuestionID;
        goalCardQuestionAnswer.Comment = model.Comment;
        goalCardQuestionAnswer.Grade = model.Grade;

            if (goalCardQuestionAnswer.Grade != null)
            {

                    answerNKIRepository.SaveQuestionAnswer(goalCardQuestionAnswer);
                    answerNKIRepository.Save();
                    result = true;
                    return Json(result);                   
            }

       answerNKIRepository.SaveQuestionAnswer(goalCardQuestionAnswer);
       answerNKIRepository.Save();

        return Json(result);
    } 
```

我的仓库

```
 public class AnswerNKIRepository
{
    private readonly NKImodeledmxContainer db = new NKImodeledmxContainer();

    public List<SelectedQuestion> GetAllSelectedQuestionsByGoalCardId(int goalCardId)
    {
        return db.SelectedQuestion.Where(question => question.GoalCard.Id == goalCardId).ToList();
    }

    public void SaveQuestionAnswer(GoalCardQuestionAnswer goalCardQuestionAnswer)
    {
        db.GoalCardQuestionAnswer.AddObject(goalCardQuestionAnswer);
    }

    public void Save()
    {
        db.SaveChanges();
    }
} 
```

这是我的视图模型：

```
 public class SelectedQuestionViewModel
{

    public int? Grade { get; set; }
    public string Comment { get; set; }
    public string SelectedQuestionText { get; set; }
    public int QuestionID { get; set; }
} 
```

这是我的数据库模型：

![在此处输入图像描述](../Images/88333d089f68906197bf6e2f85893a2d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:32:40.050

异常抱怨这`SelectedQuestion.Question`是必需的导航属性，但您没有在代码中设置此属性。尝试从存储库中按 Id 加载问题并将其设置为`SelectedQuestion.Question`参考：替换此行 ...

```
goalCardQuestionAnswer.SelectedQuestion.Id = model.QuestionID; 
```

...经过...

```
goalCardQuestionAnswer.SelectedQuestion.Question =
    answerNKIRepository.GetQuestionById(model.QuestionID); 
```

并在您的存储库中添加方法：

```
public Question GetQuestionById(int id)
{
    return db.Question.Single(q => q.Id == id);
} 
```

# c - 将带有结构列表的结构传递给函数

> ID：10298222
> 
> 赞同：1
> 
> 时间：2012-04-24T12:52:36.437
> 
> 标签：c

我有一个原型函数：

```
void procedureForEachWave(struct barge *Barge, struct settings *Settings, struct wave *Wave) 
```

在另一个函数中，我有另一个名为 的结构`threadData`，我用它来向在多个线程上运行的函数发送信息，并且该结构的元素之一是 的列表`struct wave`，因此该代码的简短版本如下：

```
struct threadData data;
data.waveList = (struct wave*) malloc(sizeof(struct wave)*nrOfWaves); 
```

我在另一个函数中使用它，我基本上首先发送一个指向结构数据的指针，然后在这个函数内部，在这样的循环中调用“procedureForEachWave”函数：

```
procedureForEachWave(data->Barge, data->Settings, &data->waveList[i]); 
```

这工作正常。但是，我还想做一个分析，我只使用一个波，这意味着列表只包含一个元素，因此我不需要调用第一个函数。我只想这样做：

```
procedureForEachWave(Barge, Settings, &data.waveList[0]); 
```

但这不起作用。为什么？以及如何让它工作？为了澄清，数据现在被声明为变量，而不是指针，并且 Barge 和 Settings 已经是指针。waveList 是这样声明的：

```
data.waveList = (struct wave*) malloc(sizeof(struct wave)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:24:06.280

在不知道内部发生的任何事情的情况下`procedureForEachWave`，很难（如果不是不可能的话）说出问题所在。

但是，看起来`data`在有效的调用和无效的调用之间的使用方式有所不同。如果他们使用相同`data`的，调用应该是相同的（用 0 代替`i`）。如果它们不同，请提供此 other 的定义`data`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:59:27.590

考虑代码片段：

```
extern void wave_function(struct wave *);
struct wave value     =   { ... };
struct wave array[10] = { { ... } };

wave_function(&value);
wave_function(array);
wave_function(&array[5]); 
```

被调用函数无法从给定的指针中分辨出它是传递了一个指向单个值的指针还是一个指向值数组的指针。调用函数和被调用函数必须就如何使用指针达成一致，可能通过将数组中元素的数量作为单独的参数包含在内：

```
extern void alt_wave_function(struct wave *, size_t);

alt_wave_function(&value, 1);
alt_wave_function(array, 10);
alt_wave_function(&array[5], 3); 
```

请注意，如果通过指针传递的大小`&value`大于 1，您将陷入未定义的行为。其他两个调用都是完全合法的：但是，第三个调用有效地将数组的三行子集传递给函数。

因此，在函数内部，任何指针参数都可以被视为指向单个值的指针，或指向值数组中第一项的指针。两者都是正确的。事实上，你甚至可以写：

```
void wave_function(struct wave *ptr)
{
}

void wave_function(struct wave ptr[])
{
} 
```

这些是等效的声明（但仅在参数列表中）。你甚至可以在数组表示法中包含一个大小，尽管这不会向函数传达任何信息，除非你用 C99 语法修饰它：

```
void wave_function(struct wave array[static 4])
{
} 
```

这种表示法意味着调用者必须保证传递给这个版本的数组中至少有 4 个元素`wave_function`。

# heroku - heroku 没有这样的应用程序

> ID：10298225
> 
> 赞同：4
> 
> 时间：2012-04-24T12:52:43.210
> 
> 标签：heroku, dns, sinatra

我按照 Heroku 和 Zerigo 的文档为 MYAPP.heroku.com 设置了一个自定义域。当我导航到 myapp.heroku.com 时，一切正常。但是当我导航到 myapp.com 或 www.myapp.com 时，我收到错误“Heroku | 没有这样的应用程序”

```
host myapp.heroku.com
myapp.heroku.com is an alias for proxy.heroku.com.
[.....] 
```

看起来不错，并且

```
host www.myapp.com
www.myapp.com is an alias for proxy.heroku.com.
[.....] 
```

看起来也不错。但我仍然得到“Heroku | 没有这样的应用程序”。

在这一点上完全困惑

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T13:15:00.170

DNS 条目看起来不错 - 如果您已将 www.myapp.com 作为自定义域添加到 Heroku 上的应用程序，那么它应该可以正常工作。您可以通过从 heroku.com 上的“我的应用程序”选项卡查看应用程序并确保自定义域在域部分中列为“www.myapp.com”来检查这一点。

如果那是那里，那么我会在您做的一切正确时记录一张支持票。

更新：Heroku Status 刚刚更新了自定义域的问题，这很可能是您的问题 - [https://status.heroku.com/](https://status.heroku.com/)

HEROKU 更新：工程师仍在调查有关自定义域的问题的根源。我们已确定只有在过去 48 小时内添加或更新的域才会受到影响。我们将继续提供更多可用信息。

# nlp - 词干化和去复数化之间的区别

> ID：10298231
> 
> 赞同：2
> 
> 时间：2012-04-24T12:53:06.840
> 
> 标签：nlp, stemming, pluralize

*理解字符串匹配：词干*化和去复数化之间的确切区别是什么*？*

还是他们的意思是一样的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T13:45:44.333

首先，**词干提取**是指将单词还原为其词干的过程。但是，这可能意味着许多不同的事情。大多数语言学家至少区分两种方法：

1.  删除*语法*词素，但不删除*派生*词素。语法语素是单词的组成部分，与它在特定句子中的语法作用相关，例如*数字*、格、*性别*、*时**态*、*方面*等。

****   删除语法*和*派生词素。派生语素是单词的组成部分，与它从另一个单词派生有关，例如，“worker”中的“-er”与它如何从“work”派生（或可以被认为是派生的）有关。*** 

 **因此，**去复数化**，这是一个相当不寻常的术语，但显然是指去除复数语素（例如“计算机”末尾的“-s”），是**一种词干提取**的一部分，具体来说是去除的一部分语法（但不是派生的）语素。

在**英语中，****名词**的形态主要限于复数（“computers”）和属格（第二种情况，“computer's”），因此就英语而言，去复数可能被视为（几乎）与（语法）词干提取的同义词，至少在词干应用于*名词*的范围内，以及在某种程度上，*形容词*，（例如在信息检索的上下文中）。然而，无论在哪里考虑*动词*，*过去时*、*被动语态*和其他屈折形式都会受到词干的影响（但不会被去复数化）。

此外，在英语以外的语言中，即使是名词也可能具有非常丰富的形态，包括用于诸如格、礼貌级别或特殊类型的复数（例如对偶）之类的语素。然后，去复数化（如果你想用这个词的话）只会指整个词干过程的一小部分。

另一个相关的术语是**词形还原**，它通常与**词干**同义使用。我发现很多人（包括我自己）在两者之间做出的一个区别是：

*   **词干**用于指一种**基于规则或基于机器学习的**技术，该技术可以删除看起来像语法词素的单词部分（主要是词尾）

*   **词形还原**用于指代执行相同操作的过程，但使用该语言的实际**词典**来处理高度不规则的形式（例如复数“妇女”）

（但是，同样，并不是每个人都会同意这种区别。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T12:57:20.540

它们是不相同的。词干有几种方法，去复数化是一种策略。

举个简单的例子：词干分析器可能会将“幼稚”词干变为“孩子”，或者将词“词干”词干变为“词干”，而去复数算法则不会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T12:59:59.090

词干提取是将具有相同词根的多个单词转换为一个单词。前任。“cats”、“catlike”、“catty”到“cat”

去复数化是将复数词转换为单数词。前任。“猫”到“猫”

词干和算法的附加信息 [http://en.wikipedia.org/wiki/Stemming#Algorithms](http://en.wikipedia.org/wiki/Stemming#Algorithms)**

# jquery - 如何使用 Jquery 从相册中获取 Facebook 照片

> ID：10298234
> 
> 赞同：0
> 
> 时间：2012-04-24T12:53:10.493
> 
> 标签：jquery, facebook-graph-api, photo

谁能帮我？我正在尝试从 Facebook 相册中提取所有照片

这个先前的答案很接近，但我需要提取**相册中的所有照片，**而不仅仅是个人资料照片：

[从 Facebook Graph API 中选择 JSON 中的项目编号](https://stackoverflow.com/questions/8834205/selecting-item-number-in-json-from-facebook-graph-api)

好的，这是我的脚本：

```
<script>

 var fburl = "https://graph.facebook.com/artisticpassion/albums?access_token=AAACEdEose0cBAE6xJxnAdD383u6h5CAjHmTbZCnoccvtS4AwDgL2SEP9wl92635df3KcV0T0ZB2ZAAZCmhEu7ZAuM2g7w8FM0XzqAnfZBMzgZDZD"

    $.getJSON(fburl, function(data){
    //var data = data["data"][0]["picture"];
    $.each(data["data"], function() {
        $a = $("<a></a>").attr("href", this.link);
        $img = $("<img />").attr("src", this.picture);
        $a.append($img)
        $("#photos").append($a);
    });
});

</script> 
```

然后将照片附加到一个 div 中，如下所示：

```
<div id="photos"></div> 
```

非常感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:16:52.930

试试这个：用“照片”替换“相册”

```
 var fburl = "https://graph.facebook.com/artisticpassion/photos?access_token=AAACEdEose0cBAE6xJxnAdD383u6h5CAjHmTbZCnoccvtS4AwDgL2SEP9wl92635df3KcV0T0ZB2ZAAZCmhEu7ZAuM2g7w8FM0XzqAnfZBMzgZDZD"

    $.getJSON(fburl, function(data){
    //var data = data["data"][0]["picture"];
    $.each(data["data"], function() {
        $a = $("<a></a>").attr("href", this.link);
        $img = $("<img />").attr("src", this.picture);
        $a.append($img)
        $("#photos").append($a);
    });
}); 
```

# php - Facebook 朋友图片/生日等名字都可以

> ID：10298238
> 
> 赞同：0
> 
> 时间：2012-04-24T12:53:30.027
> 
> 标签：php, facebook, json, facebook-graph-api

我正在使用以下内容，它可以完美地显示朋友的名字

```
$access_token = "___access-token___";
$friendsList = json_decode(file_get_contents("https://graph.facebook.com/me/friends?access_token=".$access_token),true) ;
$data = $friendsList['data'] ;

foreach ($data as $nr => $friends)
{
 echo $friends['name'].'<br /><br />';  // line AAA     
} 
```

但是，如果尝试将 AAA 行更改为 $friends['birthday'] 或 $friends['picture'] 我什么都得不到？有任何想法吗？

顺便说一句，RE 生日，我有 friends_birthday 允许此信息的范围

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:21:33.483

直接在请求中定义想要的字段：

```
https://graph.facebook.com/me/friends/?fields=birthday,picture 
```

如果允许您查看朋友的生日 - 它将在结果行中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:14:48.137

朋友只包含姓名和ID，您必须将其链接到用户表才能使用朋友ID获取您朋友的生日。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T09:49:31.740

[https://graph.facebook.com/me/friends](https://graph.facebook.com/me/friends) 将仅返回带有 id-name 的朋友列表。

如果您想要每个朋友的基本资料
- 请致电[https://graph.facebook.com/friend_user_id](https://graph.facebook.com/friend_user_id)

获取扩展个人资料
电话[https://graph.facebook.com/friend_user_id?access_token=append_valid_access_token](https://graph.facebook.com/friend_user_id?access_token=append_valid_access_token)

如果您想要更广泛的个人资料详细信息，则需要具有必要的权限，请参阅；[https://developers.facebook.com/docs/authentication/permissions/](https://developers.facebook.com/docs/authentication/permissions/)

为了能够获得扩展的个人资料信息，您

# android - Android - 从数据库服务器检索图像和数据

> ID：10298244
> 
> 赞同：0
> 
> 时间：2012-04-24T12:53:57.407
> 
> 标签：android, android-image

我在从远程数据库服务器检索数据和图像时遇到问题。我试图从互联网上搜索几天，但仍然找不到可以帮助我解决问题的有用链接、教程或解决方案。这里的任何人都可以帮助我。你可以给我一个显示详细教程的链接。我是安卓新手。任何帮助将不胜感激。

我将图像 url 保存在数据库中，我希望检索 url 并将其作为图像显示在我的 android 上。拜托，任何帮助都可以挽救我的生命。

先感谢您。

====================================================我发现了我的问题。我只是从我的清单文件中删除，然后程序正在运行。这很奇怪，但我也不知道为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T00:23:12.583

回答：

我通过从清单文件中删除“uses-sdk android:minSdkVersion="8"”解决了我的问题。

希望这可以帮助其他人:)祝你好运

# jquery - 打开 datebox jquerymobile 时是否有设置默认日期的选项

> ID：10298245
> 
> 赞同：1
> 
> 时间：2012-04-24T12:54:01.133
> 
> 标签：jquery, jquery-mobile

我认为这个问题很好地解释了我想要实现的目标。我有这个代码：

```
<input type="date" data-role="datebox" data-options='{"mode": "datebox","noButton": true,"useDialogForceTrue": true, "useDialogForceFalse": false}' name="mydate" id="mydate" /> 
```

当用户在输入数据选项中打开日期框窗口时，我想设置一些默认日期，这样它就不会占用另一行代码。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:02:16.473

**HTML**

```
<label for="mydate">Some Date</label>

<input name="mydate" id="mydate" type="date" data-role="datebox"
   data-options='{"mode": "calbox"}'>

<a href="#" id="linkmodelink">Open Link</a> 
```

**jQuery**

```
$('#thisPageID').live('pagecreate', function(event) {
  // Default picker value of Jan 1, 2012
  var defaultPickerValue = [2012, 0, 1];

  // Make it a date
  var presetDate = new Date(defaultPickerValue[0], defaultPickerValue[1], defaultPickerValue[2], 0, 0, 0, 0);

  // Get Today
  var todaysDate = new Date(); 

  // Length of 1 Day
  var lengthOfDay = 24 * 60 * 60 * 1000; 

  // Get the difference
  var diff = parseInt((((presetDate.getTime() - todaysDate.getTime()) / lengthOfDay)+1)*-1,10); 

  // Set the origin date
  $('#mydate').data('datebox').options.defaultPickerValue = defaultPickerValue;

  // Set minDays to disallow anything earlier
  $('#mydate').data('datebox').options.minDays = diff; 
}); 
```

*来源：[http ://dev.jtsage.com/jQM-DateBox/demos/script/start.html](http://dev.jtsage.com/jQM-DateBox/demos/script/start.html)*

# java - 私有方法中的私有字段 VS 从公共方法传递它们

> ID：10298246
> 
> 赞同：0
> 
> 时间：2012-04-24T12:54:03.693
> 
> 标签：java, methods, call, field, private

使用`private field`and的更好方法是什么`private methods`？

当从公共方法调用私有方法时，在私有方法中使用私有字段是优雅还是将它们作为参数更好？

场地：

```
private Item model; 
```

**1.** 公共方法：

```
...
if (model.getPrice() != null) {
 String formattedPrice = formatPrice();
}
... 
```

私有方法：

```
private int formatPrice(){
 int price =  model.getPrice() + 10;
} 
```

**VS**

**2.** 公共方法：

```
if (model.getPrice() != null) {
 String formattedPrice = formatPrice(model.getPrice());
}
... 
```

私有方法：

```
formatPrice(int price){
 int price = price + 10;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:03:48.157

> 当从公共方法调用私有方法时，在私有方法中使用私有字段是优雅还是将它们作为参数更好？

我认为这是非常主观的，取决于你的偏好，也取决于具体情况。

总的来说，这两种方法对我来说似乎都有效。从私有方法访问私有成员没有问题，将其作为参数传递也没有问题。

关于具体的例子，我稍微喜欢第二种实现方式。私有方法在那里是自包含的——它不依赖于除了它的参数之外的任何东西。这使得阅读、测试和重用变得更容易。您可以推理该方法并争论其正确性，而无需知道`model`它是什么以及它的`getPrice`方法是如何工作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:19:14.117

以下是我可以识别的优点和缺点：

这个版本...

```
 private int formatPrice() {
        // format model.getPrice()
    } 
```

...可能避免将错误的东西格式化为价格的“问题”，如果您在很多地方调用它，可能会节省一些字符。

这个版本...

```
 private int formatPrice(int price) {
        // format price
    } 
```

... 可用于格式化来自不同来源（而不仅仅是来自`model.getPrice()`）的价格，但调用有点冗长，没有什么可以阻止您格式化一些不代表*价格*的整数。

* * *

但是，在我看来，这两种方法之间没有太大区别。当然，对于一个或另一个来说，没有足够的差异显然是一种“更好的方式”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:00:41.080

当您不希望在您正在实现的类之外看到它们时，您应该使用私有方法。因此，如果要创建该类的实例，则该私有方法将无法访问。

至于私有领域，同样的逻辑。好吧，无论如何，Java中没有什么是真正私有的，无论如何你都可以通过使用反射来实现它..

# apache - 如何使 %{HTTP_HOST} 始终返回非 www

> ID：10298247
> 
> 赞同：0
> 
> 时间：2012-04-24T12:54:09.060
> 
> 标签：apache, .htaccess, mod-rewrite

我有这个重定向代码，无论使用什么子域，我都希望它始终将 %{HTTP_HOST} 作为非 www 返回。

```
RewriteEngine On
RewriteRule ^.*$ http://www.mywebsite.com/%{HTTP_HOST} [L,R=301] 
```

因此， www.website2.com 、 website2.com 、anything.website2.com 将始终被重定向到`http://www.mywebsite.com/website2.com`

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T19:59:42.723

有这样的重写规则：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^(?:[^.]+\.)(.+)$ [NC]
RewriteRule ^ http://www.mywebsite.com/%1%{REQUEST_URI} [L,R] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:59:09.397

你可以尝试这样的事情：

```
# we are now working on HTTP_REFERER,
# change to appropriate variable according to your needs
#   check if we got at least 2 dots in the URL
RewriteCond %{HTTP_REFERER} \.([^\.]+)\.([A-Z]{2,3})$ [NC]
#   if the condition was met, redirect using only last 2 parts of URL
RewriteRule ^ http://www.mywebsite.com/%1.%2 [R,L] 
```

让我知道这是否有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:18:19.173

我会使用谷歌，然后点击第一个链接。
[http://dense13.com/blog/2008/02/27/redirecting-non-www-to-www-with-htaccess/](http://dense13.com/blog/2008/02/27/redirecting-non-www-to-www-with-htaccess/)

然后您可以更改 RewriteCond 以匹配任何内容，而不是专门为 not-www

# javascript - 在openLayers中，如何用点、半径、弧度绘制扇形

> ID：10298252
> 
> 赞同：1
> 
> 时间：2012-04-24T12:54:29.123
> 
> 标签：javascript, openlayers

在openLayers中，如何用点、半径、弧度绘制扇形

如果提供示例代码，非常好

# java - Textview 搞砸了阿拉伯字母

> ID：10298257
> 
> 赞同：0
> 
> 时间：2012-04-24T12:54:44.677
> 
> 标签：java, android, xml, textview, arabic

我正在开发一个 android 应用程序，允许用户在编辑文本（阿拉伯字母）中插入一些信息，如用户名，并使用 textView 在另一个 Activity 中显示他插入的信息

但是，当我运行我的应用程序并以阿拉伯字母插入名称并在第二个活动中显示它时，它错过了！

我不知道如何让文本查看带有阿拉伯字母的顺序

任何帮助都会非常感激

这是我的 XML 代码：

```
 <?xml version="1.0" encoding="utf-8"?>
 <FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/frameLayout1"
android:layout_width="fill_parent"
android:layout_height="fill_parent"

android:padding="5dp" >

<AbsoluteLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"

    android:orientation="vertical" >

    <Button
        android:id="@+id/cancel3"
        android:layout_width="94dp"
        android:layout_height="34dp"
        android:layout_x="188dp"
        android:layout_y="437dp"

        android:text="إلغاء"
        android:textColor="@color/White" />

    <Button
        android:id="@+id/send3"
        android:layout_width="98dp"
        android:layout_height="34dp"
        android:layout_x="26dp"
        android:layout_y="436dp"

        android:text="إرسال"
         />

    <Button
        android:id="@+id/stoppingalram"
        android:layout_width="wrap_content"
        android:layout_height="23dp"
        android:layout_x="114dp"
        android:layout_y="438dp"
        android:text="إلغاء" 
        android:visibility="gone"
        />

    <ImageView
        android:id="@+id/imageView3"
        android:layout_width="548dp"
        android:layout_height="32dp"
        android:layout_x="-120dp"
        android:layout_y="8dp"
        />

    <ImageView
        android:id="@+id/imageView2"
        android:layout_width="68dp"
        android:layout_height="69dp"
        android:layout_x="120dp"
        android:layout_y="77dp"
         />

    <TextView
        android:id="@+id/tvmoreinfoReport"
        android:layout_width="54dp"
        android:layout_height="wrap_content"
        android:layout_marginTop="18dp"
        android:layout_x="156dp"
        android:layout_y="372dp"
        android:text="لا شئ"
         />

    <TextView
        android:id="@+id/tvclothesReport"
        android:layout_width="82dp"
        android:layout_height="wrap_content"
        android:layout_marginTop="18dp"
        android:layout_x="138dp"
        android:layout_y="321dp"
        android:text="فستان أحمر"
         />

    <TextView
        android:id="@+id/tvtimeReport"
        android:layout_width="47dp"
        android:layout_height="wrap_content"
        android:layout_marginTop="14dp"
        android:layout_x="159dp"
        android:layout_y="282dp"
        android:text="ساعة ١"
        />

    <TextView
        android:id="@+id/tvgenderReport"
        android:layout_width="46dp"
        android:layout_height="wrap_content"
        android:layout_marginTop="17dp"
        android:layout_x="177dp"
        android:layout_y="207dp"
        android:text="أنثى"
         />

    <TextView
        android:id="@+id/tvageReport"
        android:layout_width="68dp"
        android:layout_height="wrap_content"
        android:layout_x="174dp"
        android:layout_y="236dp"
        android:text="سنة ٩"
         />

    <TextView
        android:id="@+id/tvcasenameReport"
        android:layout_width="88dp"
        android:layout_height="wrap_content"
        android:layout_marginTop="14dp"
        android:layout_x="145dp"
        android:layout_y="174dp"
        android:text="محمد عبدالله"
        />

</AbsoluteLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T09:05:11.910

我单击右键单击按钮并更改为 4.0.3 并按 OK 然后完成 :) 2.1 它不支持阿拉伯语，2.3 不完全支持阿拉伯语，3.x 完全支持阿拉伯语

# c++ - 架构 x86_64 的未定义符号：使用头文件中定义的结构

> ID：10298266
> 
> 赞同：1
> 
> 时间：2012-04-24T12:55:03.833
> 
> 标签：c++, xcode, oop

我正在使用 xcode 4.2 来构建这个简单的程序。我意识到有很多关于这个错误的帖子，但我还没有找到任何可以回答我的问题的帖子。
我收到一个我不明白的错误。
这是编译输出：

> ld /Users/kotoko/Library/Developer/Xcode/DerivedData/stw-gyleohvghcrywgcqkihhkkkqeqnl/Build/Products/Debug/stw normal x86_64 cd /Users/kotoko/projectos/somethingToWear/stw_v6_xcode/stw setenv MACOSX_DEPLOYMENT_TARGET 10.6 /Developer/usr/bin/ llvm-g++-4.2 -arch x86_64 -isysroot /Developer/SDKs/MacOSX10.6.sdk -
> 
> L/Users/kotoko/Library/Developer/Xcode/DerivedData/stw-gyleohvghcrywgcqkihhkkkqeqnl/Build/Products/Debug-F/Users/kotoko/Library/Developer/Xcode/DerivedData/stw-gyleohvghcrywgcqkihhkkkqeqnl/Build/Products/Debug-filelist/用户/kotoko/Library/Developer/Xcode/DerivedData/stw-gyleohvghcrywgcqkihhkkkqeqnl/Build/Intermediates/stw.build/Debug/stw.build/Objects-normal/x86_64/stw.LinkFileList -mmacosx-version-min=10.6 -o /用户/kotoko/Library/Developer/Xcode/DerivedData/stw-gyleohvghcrywgcqkihhkkkqeqnl/Build/Products/Debug/stw
> 
> 架构 x86_64 的未定义符号：“ClosetItem::lc”，引用自：ClosetItem::ClosetItem(int)in ClosetItem.o ClosetItem::ClosetItem(int)in ClosetItem.o ld：未找到架构 x86_64 collect2 的符号: ld 返回 1 个退出状态

这是代码（主文件现在甚至不调用这个对象）：

```
//
//  ClosetItem.h
//  stw
//

#ifndef stw_ClosetItem_h
#define stw_ClosetItem_h

#include <iostream>

class LeakChecker { 
    int count;
public: 
    LeakChecker() : count(0) {}
    void print() { 
        std::cout << count << std::endl;
    } 
    ~LeakChecker() { print(); } 
    void operator++(int) { count++; } 
    void operator--(int) { count--; }
};

class ClosetItem{

public:
    ClosetItem(int identifier);
    virtual ~ClosetItem() {};

protected:
    static LeakChecker lc;
};
#endif
//
//  ClosetItem.cpp
//  stw
//

#include "ClosetItem.h"
#include <iostream>

ClosetItem::ClosetItem(int identifier){
    lc++;
    std::cout<<"ClosetItem #";
    lc.print();
} 
```

谁能指出我的问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T12:57:09.230

你还没有初始化你的`static`成员：

```
class ClosetItem{

public:
    ClosetItem(int identifier);
    virtual ~ClosetItem() {};

protected:
    static LeakChecker lc;  // <-- uninitialized
}; 
```

您需要在实现文件中对其进行初始化：

```
//ClosetItem.cpp
LeakChecker ClosetItem::lc; // <-- definition 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T12:57:35.187

您已经声明了一个静态 LeakChecker 变量，但需要实现它。在您的 c++ 文件中添加：

`LeakChecker ClosetItem::lc;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T12:58:59.257

您实际上还没有定义`lc`静态对象。你需要类似的东西：

```
LeakChecker ClosetItem::lc; 
```

# c# - 在新的 AppDomain 中加载插件

> ID：10298269
> 
> 赞同：1
> 
> 时间：2012-04-24T12:55:16.797
> 
> 标签：c#, .net, plugins, appdomain

我知道有很多关于在新应用程序域中加载插件的线程。我的错我以前没有读过它们。我有这个学校项目-基于插件的应用程序，几乎完成了。除了一个重要的点 - 插件必须加载到新域中。我使用这篇文章创建基于插件的应用程序[http://www.codeproject.com/Articles/6334/Plug-ins-in-C](http://www.codeproject.com/Articles/6334/Plug-ins-in-C)

我目前正赶上项目截止日期，并且我被同一应用程序域中的插件困住了。如果可以对链接中的应用程序进行一些简单的更改以在单独的应用程序域中加载插件，您能否建议我？我真的不会从一开始就编写应用程序。:(

感谢您的所有建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:52:11.527

尝试这个

```
AppDomain domain = AppDomain.CreateDomain("domain name");

// TODO: configure appdomain as needed

// to load the dll and get a type you can reference in your current appdomain
string pathToDll = @"C:\somedir\Mydll.dll";
Type myType = typeof(SomeType);
SomeType myObj = (SomeType)domain.CreateInstanceFromAndUnwrap(pathToDll, myType.FullName);

// to just load the dll into the new appdomain
byte[] file = File.ReadAllBytes(pathToDll);
domain.Load(file); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:35:22.767

我曾经尝试将我的 WinForms 应用程序划分为单独的 AppDomains，这并不容易。但是，在您的情况下，这应该不是很困难。

尝试创建一个新的 AppDomain 并在其中加载您的插件类型。然后使用反射或通用基本接口与该对象通信（请记住，如果您想避免将插件程序集加载到主机 AppDomain 中，则不能在主机应用程序中引用插件类型）。

您可能还想查看[System.AddIn 命名空间](http://msdn.microsoft.com/en-us/library/system.addin.aspx)- 它是专门为简化插件开发而实现的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:41:01.317

您可以使用 System.Addin。查看此示例（或此 CodePlex 页面中的其他示例）

[http://clraddins.codeplex.com/releases/view/9454](http://clraddins.codeplex.com/releases/view/9454)

# ipad - 使用 iPad 进行应用内购买

> ID：10298273
> 
> 赞同：0
> 
> 时间：2012-04-24T12:55:23.317
> 
> 标签：ipad, in-app-purchase

我已按照[“http://www.raywenderlich.com/2797/introduction-to-in-app-purchases”](http://www.raywenderlich.com/2797/introduction-to-in-app-purchases%22)链接进行应用内购买。

这适用于 iphone

但在 iPad 中，我可以进行应用内购买。它显示“无法连接到 iTunes”（仅限 ipad）

任何人都可以知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:44:40.143

很难知道到底是什么问题

1.  也许您使用了错误的测试用户
2.  沙盒可能有问题
3.  也许您应该硬重置（设置 => 常规 => 重置 => 删除所有内容和设置）。

尝试在stackoverflow上寻找不同的解决方案，您的要求有几十个

# sql-server - SQL Server 上的命令历史记录

> ID：10298283
> 
> 赞同：2
> 
> 时间：2012-04-24T12:55:46.360
> 
> 标签：sql-server, tsql, sql-server-2008-r2, logging

此查询为我提供了在 SQL Server 上执行的命令的历史记录：

```
Select *
From
(
SELECT      deqs.last_execution_time AS [Time],
            dest.TEXT AS [Query]
FROM        sys.dm_exec_query_stats AS deqs
CROSS APPLY sys.dm_exec_sql_text(deqs.sql_handle) AS dest
) x 
```

当我添加时，`Where x.Query LIKE '%Insert%'`我得到了不好的结果（我认为这是因为交叉连接）：

```
Select *
From
(
    SELECT      deqs.last_execution_time AS [Time],
                dest.TEXT AS [Query]
    FROM        sys.dm_exec_query_stats AS deqs
    CROSS APPLY sys.dm_exec_sql_text(deqs.sql_handle) AS dest
) x
Where x.Query LIKE '%Insert%' 
```

如何让交叉联接在 SQL Server 2008 R2 上正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T07:30:09.053

我不确定你的意思是：“坏结果”，但这对我有用：

```
SELECT deqs.last_execution_time AS [Time], dest.TEXT AS [Query]
FROM sys.dm_exec_query_stats AS deqs 
CROSS APPLY sys.dm_exec_sql_text(sql_handle) AS dest 
WHERE dest.TEXT LIKE '%Insert%' 
```

# reporting - 报表开发，totalPages() 方法

> ID：10298285
> 
> 赞同：0
> 
> 时间：2012-04-24T12:55:47.063
> 
> 标签：reporting, axapta, x++

是否可以重置 reportRun 类的 totalPages() 方法返回的值？

我有**一份**包含**多**张发票的报告，我想为每张提取的发票重置 totalPages() 值。

我试图在我的报告的 fetch() 方法中使用 element.reset() 并且它不起作用，它按发票拆分我的报告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T15:04:54.067

不，这是不可能的。

该`reset`方法可以解决问题，但会像您观察到的那样拆分报告。

除非您的线完全适合一条线，否则无法预先计算该值。

# jquery - 如何在 ASP.NET 中的代码中创建 jquery datepicker？

> ID：10298287
> 
> 赞同：1
> 
> 时间：2012-04-24T12:55:51.790
> 
> 标签：jquery, asp.net, datetimepicker

我想使用 cs 代码在 aspx 页面中使用 datetimepicker。但我必须在 cs 中动态创建它。我通常使用 jquery，但可以接受其他解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:02:57.403

您可以动态创建将 jquery 脚本附加到控件的脚本：

```
string csname1 = "BindDatePickerScript";
Type cstype = this.GetType();

// Get a ClientScriptManager reference from the Page class.
ClientScriptManager cs = Page.ClientScript;
// Check to see if the startup script is already registered.
if (!cs.IsStartupScriptRegistered(cstype, csname1))
{
System.Text.StringBuilder cstext1 = new System.Text.StringBuilder();
cstext1.Append("<script type='text/javascript'>");
cstext1.Append("Your Script");
cstext1.Append("});");
cstext1.Append("</");
cstext1.Append("script>");

cs.RegisterStartupScript(cstype, csname1, cstext1.ToString());
} 
```

该脚本被添加到 HTML 呈现页面的底部。

# git - 无法推送到 GitHub - 一直说需要合并

> ID：10298291
> 
> 赞同：767
> 
> 时间：2012-04-24T12:56:04.503
> 
> 标签：git

我是[GitHub](http://en.wikipedia.org/wiki/GitHub)的新手。今天我在尝试将代码推送到 GitHub 时遇到了一些问题。

```
Pushing to git@github.com:519ebayproject/519ebayproject.git
To git@github.com:519ebayproject/519ebayproject.git
 ! [rejected]        master -> master (non-fast-forward)
error: failed to push some refs to 'git@github.com:519ebayproject/519ebayproject.git'
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Merge the remote changes (e.g. 'git pull')
hint: before pushing again.
hint: See the 'Note about fast-forwards' in 'git push --help' for details. 
```

我还没有在存储库中推送任何东西，那么为什么我需要拉一些东西呢？

* * *

## 回答 #1

> 赞同：779
> 
> 时间：2013-08-08T20:08:07.187

> ### 这可能会导致远程存储库丢失提交；小心使用它。

如果您不想将远程分支合并到本地分支（请参阅与[git diff](https://www.kernel.org/pub/software/scm/git/docs/git-diff.html)的区别），并且想要强制推送，请使用[带有 -f 的 push 命令](https://www.kernel.org/pub/software/scm/git/docs/git-push.html)

```
git push -f origin <branch> 
```

[您的远程](https://www.kernel.org/pub/software/scm/git/docs/git-remote.html)`origin`仓库的名称在哪里。

> 通常，该命令拒绝更新不是用于覆盖它的本地引用的祖先的远程引用。此标志禁用检查。这可能会导致远程存储库丢失提交；小心使用它。

* * *

## 回答 #2

> 赞同：244
> 
> 时间：2012-04-24T13:01:32.363

正如消息告诉你的那样，

> 合并远程更改（例如“git pull”）

用于`git pull`将最新更改从远程存储库拉到本地存储库。在这种情况下，拉取更改将需要合并，因为您已对本地存储库进行了更改。

我将提供一个例子和一张图片来解释。假设您最后一次从源/分支拉取是在提交 B。您已经完成并提交了一些工作（提交 C）。同时，其他人完成了他们的工作并将其推送到源/分支（提交 D）。这两个分支之间需要合并。

> ```
> local branch:                         --- Commit C 
>                                     /
>                                    /
>                                   /
> origin/branch: Commit A ------ Commit B ---- Commit D 
> ```

因为您是想要推送的人，所以 Git 会强制您执行合并。为此，您必须首先从源/分支中提取更改。

> ```
> local branch:                         --- Commit C -- Commit E
>                                     /               /           
>                                    /               /             
>                                   /               /               
> origin/branch: Commit A ------ Commit B ---- Commit D 
> ```

完成合并后，您现在可以通过推送更改将源/分支快进到 Commit E。

Git 要求您自己处理合并，因为合并可能会导致冲突。

* * *

## 回答 #3

> 赞同：201
> 
> 时间：2012-04-24T13:01:03.530

你在推送之前更新了你的代码吗？

`git pull origin master`在你推动任何东西之前使用。

我假设您将`origin`其用作遥控器的名称。

您需要在推送之前拉取，以便在推送某些内容之前使您的本地存储库保持最新（以防其他人已经更新了代码`github.com`）。这有助于在本地解决冲突。

* * *

## 回答 #4

> 赞同：125
> 
> 时间：2014-06-03T18:09:49.183

这通常发生在您之前`git commit`尝试在其他人已经进行更改的分支上进行更改时。`git push``git pulling``x`

**正常流程如下，**

**第 1**步：`git stash`您在该分支上的本地未提交更改。

**第 2 步**：`git pull origin branch_name -v`到`pull and merge`该分支上本地提交的更改（*给这个合并一些消息，如果有的话，修复冲突。*）

**`git stash pop`第**3**步：`stash`ed 更改（*然后您可以根据需要对弹出的文件进行提交，或者先推送已提交的更改（STEP4），然后再对文件进行新的提交。*）**

 ****第 4 步**：`git push origin branch_name -v`合并的更改。

*替换`branch_name`为`master`（`master`分支）。*

* * *

## 回答 #5

> 赞同：61
> 
> 时间：2018-08-29T04:48:49.510

第一个简单的解决方案：

*   试试这个命令`git push -f origin master`。
*   **此命令将强制覆盖远程存储库（GitHub）**

# 推荐解决方案 1：

*   运行这些命令：

```
git pull --allow-unrelated-histories  //this might give you error but nothing to worry, next cmd will fix it
git add *
git commit -m "commit message"
git push 
```

如果这不起作用，请继续

## 解决方案2（不推荐）：

> 将删除您和您队友的所有提交历史记录。所以请不要在专业项目上这样做

*   从文件夹中删除`.git`目录。

*   然后执行这些命令：

    ```
     git init
      git add .
      git commit -m "First Commit"
      git remote add origin [url]
      git push -u origin master 
    ```

或者

```
git push -f origin master 
```

仅`git push -f origin master`在`-u`不适合您的情况下使用。

这将解决推送文件时发生的几乎所有类型的错误。

* * *

## 回答 #6

> 赞同：50
> 
> 时间：2014-07-29T16:17:22.357

Sometimes we forgot the pulling and did lots of works in the local environment.

If someone want to push without pull,

```
git push --force 
```

is working. This is not recommended when working with other people, but when your work is a simple thing or a personal toy project, it will be a quick solution.

* * *

## 回答 #7

> 赞同：35
> 
> 时间：2012-11-19T06:14:11.577

你们中的一些人可能会收到此错误，因为 Git 不知道您要推送哪个分支。

如果您的错误消息还包括

```
error: failed to push some refs to 'git@github.com:jkubicek/my_proj.git'
hint: Updates were rejected because a pushed branch tip is behind its remote
hint: counterpart. If you did not intend to push that branch, you may want to
hint: specify branches to push or set the 'push.default' configuration
hint: variable to 'current' or 'upstream' to push only the current branch. 
```

那么您可能需要遵循 Jim Kubicek 提供的便捷提示，将*[Git 配置为仅推送当前分支](https://jimkubicek.com/configure-git-to-only-push-current-branch.html)*，将默认分支设置为当前分支。

```
git config --global push.default current 
```

* * *

## 回答 #8

> 赞同：33
> 
> 时间：2017-11-24T07:16:49.843

```
git pull origin branch_name --rebase 
```

这对我有用——该命令`git pull origin branch_name --rebase`首先会从远程分支名称中提取更改，然后`rebase`是它顶部的当前分支。

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2017-01-20T09:17:33.967

除了上面的答案，以下对我有用： -

**设想 -**

1.  我成功地将**my_branch**推到了原点。
2.  我又做了一些改动。
3.  当我再次尝试推送时（当然是在添加，提交之后），我得到了上述错误。

**解决方案 -**

```
 1\. git checkout **my_branch**
 2\. git add, commit your changes.
 3\. git pull origin **my_branch** (not origin, master, or develop)
 4\. git push origin **my_branch** 
```

[![证明](../Images/6411c27c5306388225cf84e0e10bf3f2.png)](https://i.stack.imgur.com/H8vNX.png)

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2018-02-11T14:57:34.323

我有同样的问题，我所做的是我首先用这个强行推动它

```
git push --force 
```

我在提交文件后执行了此操作，并且收到了错误消息。它确实提交了所有文件并推送了它们。然后下次我推送到 github 时。我按照它的要求做了，然后就没事了。希望这对你也有用:)

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2014-01-25T06:02:36.740

我在我的教程*[如何使用 GitHub：初学者](http://www.betterwaytoweb.com/how-to-use-github-a-tutorial-for-beginners/)*教程中提到了这一点。

当您在 GitHub 上创建新存储库时，GitHub 可能会要求您创建自述文件。如果您直接在 GitHub 上创建自述文件，那么您需要先发出“拉取”请求，然后“推送”请求才会成功。这些命令将“拉”远程存储库，将其与您当前的文件合并，然后将所有文件“推送”回 GitHub：

```
git pull https://github.com/thomas07vt/MyFirstRepo.git master

git push https://github.com/thomas07vt/MyFirstRepo.git master 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2017-08-22T12:15:18.230

git push -f origin**分支名**

仅当您确定不需要远程分支代码时才使用上述命令，否则请先合并然后推送代码

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2015-07-22T13:58:46.583

当我尝试推送当前分支时收到上述错误消息`foobar`：

```
git checkout foobar
git push origin foo 
```

原来我有两个本地分支跟踪同一个远程分支：

```
foo -> origin/foo (some old branch)
foobar -> origin/foo (my current working branch) 
```

它对我有用，可以通过以下方式推送我当前的分支：

```
git push origin foobar:foo 
```

...并清理`git branch -d`

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2017-08-28T09:41:40.710

一旦你注意到它们，你的分支应该包含最新的合并更改，但你还没有提取最新的更改。

```
git fetch 
```

可能就是所有需要的。如果这不起作用，那么您可能需要：

```
git pull <sharedRepo> <branch> --rebase 
```

如果您没有任何合并冲突，您应该能够成功推送您的更改。

```
git push <forkedRepo> <branch> 
```

如果遇到合并冲突，则无法在 GitHub 中远程解决。您必须在本地解决它们，然后使用强制标签推送解决方案，因为合并冲突解决方案会更改历史记录。

```
git push <forkedRepo> <branch> -f 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2013-04-10T01:33:42.323

只是遇到了同样的问题，但就我而言，我在遥控器上输入了错误的分支。所以，这似乎是这个问题的另一个来源......仔细检查你正在推动正确的分支。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2015-04-21T10:04:51.263

我遇到了同样的问题，结果发现我在与我想象的不同的（本地）分支上，并且正确的本地分支落后于远程提交。

我的解决方案：检查正确的分支，从另一个本地分支中挑选提交，git pull 和 git push

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2016-09-02T09:53:42.060

我遇到了类似的问题，结果证明我保持分支最新的工作流程有问题。我正在做以下事情：

**在我当地的“主人”中**

```
git fetch upstream
git merge upstream/master --ff-only 
```

**然后回到我当地的分支机构**

```
git rebase master 
```

这适用于以前的 git 流，但不适用于 github。这`git rebase`是导致同步问题的问题（我承认这是我在没有完全理解的情况下不得不接受的事情），不幸的是让我处于`git push -f`可能成为最简单选择的位置。不好。

我的新流程是直接使用`git merge`如下更新分支：

**在我当地的分支机构**

```
git fetch upstream
git merge upstream/master 
```

没有快进，因为我当然会在本地分支中进行更改。

正如您可能知道的那样，我不是 git 专家，但我被可靠地告知这个工作流程可能会避免我遇到的特定问题。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2013-11-23T05:05:06.823

### 您的分支名称是否与远程分支名称相同？

如果不是，您应该签出一个与远程分支同名的新分支，然后再次尝试推送它。

### 假设你要推送的远程分支是 [ *testing* ]，而你的本地分支被命名为 [ *test* ]。

如果您不在*测试*分支中，请先切换到它。

```
git checkout test 
```

然后打开一个新分支并将其命名为*testing*。

```
git checkout -b testing 
```

现在，是时候推动它了：

```
git push [remote repo] testing 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2014-09-07T07:13:04.077

就我而言，我已经检查了“mybranch”，并且已经完成了`git pull`，所以我无法弄清楚为什么推送不起作用。最终，我意识到我推错了分支。我在打字`git push origin master`而不是`git push origin mybranch`.

因此，如果您已经完成`git pull`并且仍然收到此消息，请确保您正在推送正确的分支。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2016-08-19T21:27:44.663

如果您确定**没有人对您的 git 存储库进行更改并且您正在使用最新版本，`git pull`那么作为您心中的解决方案没有意义......**

那么这可能就是发生了什么，你用`git commit --amend`

> 它使您可以将分阶段的更改与先前的提交结合起来，而不是将其作为全新的快照提交。它还可以用于简单地编辑先前的提交消息而不更改其快照。

[ATLASSIAN 教程：重写历史](https://www.atlassian.com/git/tutorials/rewriting-history/)

`git commit --amend` **但是，如果您已经将提交推送到 GitHub** ，则不建议执行，这是因为“修改不只是更改最近的提交——它会完全替换它。对于 Git，它看起来像一个全新的提交”这意味着对于你 GitHub 上的其他开发人员来说，历史看起来像 A->B->C 但对你来说它看起来像 A->B->D，如果 GitHub 允许你`push`，其他人将不得不手动修复他们的历史

这就是您收到错误消息的原因`! [rejected] master -> master (non-fast-forward)`，如果您知道没有人拉您最新的更改，您可以这样做`git push --force`，这将**改变您公共仓库中的 git 历史记录**。否则......你可以执行`git pull`，但我相信这会产生与你没有经历相同的结果`git commit --amend`，它会创建一个新的提交（即：git pull之后的git历史：A->B->C->D )

更多细节：[如何更改您的最新提交](https://help.github.com/articles/changing-a-commit-message/)

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2016-11-15T06:31:35.103

我已经在我的 GIT 存储库中解决了这个问题。在这种情况下不需要`rebase`或`force`承诺。使用以下步骤解决此问题 -

```
local_barnch> git branch --set-upstream to=origin/<local_branch_name> 

local_barnch>git pull origin <local_branch_name>

local_barnch> git branch --set-upstream to=origin/master

local_barnch>git push origin <local_branch_name> 
```

希望它会有所帮助。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2012-07-19T21:18:31.157

在将最新更改推送到我用于[gitweb](http://git-scm.com/docs/gitweb.html)的裸 Git 存储库时，我遇到了类似的错误。就我而言，我没有在裸存储库中进行任何更改，所以我只是删除了我的裸存储库并再次克隆：

```
git clone --bare <source repo path> <target bare repo path> 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2015-05-27T14:32:50.877

另一个解决方案是如果可以的话，通过再次提交来提升遥控器的头部。将这个高级头拉入本地子树后，您将能够再次从中推送。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2018-06-14T11:02:57.713

# 另一种选择：在本地将您的分支重命名为新的名称。

然后，您将能够将其推送到远程存储库，例如，如果这是您保留副本（备份）并确保不会丢失任何内容的方式。

您可以获取远程分支以获得本地副本，并检查 (i) 远程拥有的内容（使用旧分支名称）和 (ii) 您拥有的内容（使用新分支名称）之间的差异，然后决定做什么. 由于您一开始并没有意识到遥控器的差异（因此出现了问题），因此简单地在某处合并或强制更改太残酷了。

查看差异，选择您想要处理的分支，从另一个分支中挑选您想要的更改，或者在您拥有的分支上恢复您不想要的更改等。

然后，您应该能够决定是否要将您的干净版本强制到遥控器上，或者添加新的更改，或者其他什么。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2019-03-15T20:44:35.577

这个问题一般是因为创建了一个readme.md文件导致的，这个文件算作commit，在系统本地没有同步，heading后面缺少，所以显示了一个git pull request。您可以尝试避开自述文件，然后尝试提交。它在我的情况下有效。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2018-02-25T11:57:59.687

push 命令的问题是您的本地和远程存储库不匹配。如果在从 git hub 创建新存储库时默认初始化自述文件，则会自动创建 master 分支。但是，当您尝试推送时，它没有任何分支。你不能推送......所以，最好的做法是在没有默认自述文件初始化的情况下创建 repo。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-03-16T15:30:19.197

这个问题的另一个原因（显然不那么常见）......

当我进行推送时，我的服务器落后了约 12 小时

我在服务器上配置了 NTP 同步我的时钟。

我执行了一个新的 git push，它导致了这篇文章中讨论的错误。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-08-03T20:23:00.023

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-10-11T23:29:40.223

如果有任何机会`git pull`打印`Already up-to-date`，那么您可能需要检查全局 git`push.default`参数 (In `~/.gitconfig`)。如果它`simple`在`matching`. 以下答案解释了原因：

[Git - push.default“匹配”和“简单”有什么区别](https://stackoverflow.com/questions/21839651/git-what-is-the-difference-between-push-default-matching-and-simple)

此外，值得检查您的本地分支是否已过时，`git remote show origin`并在需要时进行拉取

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-01-28T10:05:09.220

use `git pull https://github.com/username/repository` It's because the Github and remote repositories aren't in sync. If you `pull` the repo and then `Push` everything will be in sync and error will go away.

`**

# android - 有没有办法在 Android 清单中指定处理器架构要求？

> ID：10298293
> 
> 赞同：5
> 
> 时间：2012-04-24T12:56:11.027
> 
> 标签：android, android-ndk, android-manifest

我在编译为 armeabi-v7 的 Android 项目中使用了本机库。我的项目以 Android SDK 8 为目标。当我尝试在拔下手机的情况下运行它时，自动定位会选择一个 Android 2.2 (armeabi) 虚拟设备而不是 4.03 (armeabi-v7) 并尝试在其上安装它，但这会抛出一个 `Failed to install apk on device 'emulator!`错误。

我找不到指定所需处理器架构的方法，考虑到您可以在 AndroidManifest.xml中指定 Android SDK 版本、硬件要求（如硬件键盘） `<uses-configuration>`、更多硬件要求甚至 OpenGL 版本，这似乎很奇怪。`<uses-feature>`

有没有办法指定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:40:47.393

但请注意，当您将应用发布到 Google Play 时，目标架构被视为市场过滤器，您可以在开发控制台上看到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:37:13.880

不，我同意这样做，这并不奇怪。有一种指定架构的方法（在 Application.mk 中设置 APP_ABI := armeabi-v7a），但这仅在构建本机库时才考虑在内，而不是在选择合适的模拟器时考虑。

# svn - 如何从 teamcity 中 /tags Repo 目录下的分支创建分支

> ID：10298296
> 
> 赞同：0
> 
> 时间：2012-04-24T12:56:22.157
> 
> 标签：svn, tags, branch, teamcity

MyRoot URL 是[http://Repositories/svn/ibtis/](http://Repositories/svn/ibtis/)并且检出规则是 +:tags\TestReleaseHead=>。

现在我将标签规则设置为/tags/TestReleaseHead=>/tags。但它似乎什么也没做。任何想法如何将标签目录下的内容分支到其他版本。我的存储库结构是这样的

```
http://Repositories/svn/ibtis/
-branches
-tags
-trunk
-test 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T14:57:05.523

在你构建配置的第二步下，“版本控制设置”你设置了vcs标签吗？

看起来你现在只设置了标签规则。

见下图。

![在此处输入图像描述](../Images/43c3e2bc2407e3de7458207f4b2fee2a.png)

# if-statement - SPSS中的嵌套IF

> ID：10298297
> 
> 赞同：1
> 
> 时间：2012-04-24T12:56:22.490
> 
> 标签：if-statement, nested, spss

是否可以在 SPSS 中嵌套条件语句？

以下对我不起作用：

```
 DO IF (t = resultcodeid)

        DO IF t = 1
            COMPUTE hits = r.
        END IF.

        DO IF t = 2
            COMPUTE misses = r.
        END IF.

    END IF. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T21:56:59.143

DO IF 当然可以嵌套。请注意，每个语句都需要以句点终止。

此外，由于内部是替代方案，因此将其写成
if t = 1\.
...
else if t = 2\.
...
end if 会更清晰。

HTH，乔恩·派克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-27T18:26:50.343

```
 #YOU CAN USE THIS PROCESS:

          DO IF (t = resultcodeid)

         DO IF t = 1
        COMPUTE hits = r.

    ELSE IF t = 2
        COMPUTE misses = r.
    ELSE IF T=3
   COMPUTE  misses=r.
  ELSE IF .......

END IF.
EXECUTE. 
```

# entity-framework - 在 DVCS 项目中使用实体框架代码优先迁移

> ID：10298298
> 
> 赞同：13
> 
> 时间：2012-04-24T12:56:27.787
> 
> 标签：entity-framework, dvcs, entity-framework-migrations

当涉及到数据库模式时，我总是发现版本控制有点问题。

所以 - 我目前正在评估实体框架代码优先迁移，到目前为止我印象非常深刻。

我的问题是，有没有人有在使用 DVCS 的团队中使用迁移的经验？

如果在不同分支上工作的开发人员各自创建自己的迁移，那么当分支合并时，“更新数据库”工具能否很好地应对？

我想可能发生的情况是列表中间会出现一个新的迁移。然后这会被拾起，还是只是寻找比上次部署的“更新”的迁移？

我很欣赏团队将不得不小心不要创建冲突的架构更改 - 这是我们可以管理的 - 但是知道“更新数据库”是否足够聪明以发现“丢失”迁移会很有用？

谢谢， - 克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T01:13:33.583

根据我可以找到的关于该主题的一篇[博](http://www.pabich.eu/blog/archive/2012/05/16/Entity-Framework-migrations-donrsquot-support-parallel-development.aspx)文，似乎并行开发（无论使用哪种 VCS 工具）都与 EF 中数据库迁移的当前状态存在问题。由于它如何跟踪数据库的状态，似乎没有办法处理这种情况。Pawel[在 GitHub 上提供了一个示例项目](https://github.com/pawelpabich/EFMigrationsLimitations)来显示该问题。

实际上，使用独立工具来处理数据库迁移可能会好得多。我使用[Migrator.NET](http://nuget.org/packages/migratordotnet)取得了很大的成功，它确实可以正确处理并行开发人员的架构更改。它还使用一种技术含量相对较低的方法来跟踪数据库“版本”，只要您和您的团队决定哪一天除了通过迁移类（我们称之为那一天v1 数据库）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-08T15:24:55.923

本文中的解决方案可能对您有用。您需要创建一个忽略其他开发人员更改的空白迁移的额外步骤。这会将快照更新为与数据库同步。

[http://msdn.microsoft.com/en-us/data/dn481501.aspx](http://msdn.microsoft.com/en-us/data/dn481501.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T01:18:10.420

我认为它不起作用，我认为没有办法解决它。

有关更多详细信息，请参阅[此博客文章](http://www.pabich.eu/blog/archive/2012/05/16/Entity-Framework-migrations-donrsquot-support-parallel-development.aspx)。

我的建议是使用不同的工具来管理您的迁移。

# android - 与类 corona sdk 中的图像碰撞

> ID：10298302
> 
> 赞同：0
> 
> 时间：2012-04-24T12:56:51.307
> 
> 标签：android, ios, mobile, lua, coronasdk

当要测试的对象在另一个类中定义时，如何在 corona sdk 中测试 main.lua 中的冲突？我在玩家类中有一个图像，在敌人类中有一个图像。主要如何检测这些图像是否发生碰撞？

```
local function onGlobalCollision (event)

if ( event.phase == "began" ) then

print( "began: " .. event.object1.myName .. " & " .. event.object2.myName )

end

end

Runtime:addEventListener( "collision", onGlobalCollision ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:21:50.257

这真的取决于你如何设置你的课程。您可能需要发布更多代码。我创建了这个示例，它按预期工作：

**盒子.lua**

```
local Box = {}
local physics = require("physics")

function Box:new()

    local box = display.newRect(math.random(0,display.contentWidth),math.random(0,display.contentHeight),100,100)
    physics.addBody(box)

    local function onTouch(event)
        if(event.phase == "began") then
            display.getCurrentStage():setFocus(event.target)
        elseif(event.phase == "moved") then
            event.target.x = event.x
            event.target.y = event.y
        elseif(event.phase == "ended") then
            display.getCurrentStage():setFocus(nil)
        end
    end

    box:addEventListener("touch", onTouch)

    return box

end

return Box 
```

**主程序.lua**

```
local physics = require("physics")
physics:start()
physics.setGravity(0,0)

local box1 = require("box"):new()
box1.myName = "box 1"

local box2 = require("box"):new()
box2.myName = "box 2"

local function onGlobalCollision (event)
    if ( event.phase == "began" ) then
        print( "began: " .. event.object1.myName .. " & " .. event.object2.myName )
    end
end

Runtime:addEventListener( "collision", onGlobalCollision ) 
```

我很确定你甚至可以完全从 main 中删除这些东西。确保你在其他任何事情之前都调用了physics.start()。

# .net - Linq-to-XML 获取具有命名空间的元素

> ID：10298304
> 
> 赞同：5
> 
> 时间：2012-04-24T12:56:53.787
> 
> 标签：.net, linq-to-xml

我正在使用 linq-to-xml 来搜索元素。

```
 var doc = XDocument.Load(reader);
                    var ns = doc.Root.Attribute("xmlns").Value;
                    var result = (from u in doc.Descendants(XName.Get("MyElement", ns)) 
```

每当我尝试在 xml 中查找元素时，我都需要摆脱使用 XName.Get。如何将默认命名空间设置为 XDocument，以便在搜索时不会打扰。

问候。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T13:24:41.897

如果您真的想这样做，这是忽略默认命名空间的一种方法：

```
 XDocument doc;
        using (XmlTextReader xr = new XmlTextReader("input.xml"))
        {
            xr.Namespaces = false;
            doc = XDocument.Load(xr);
        }
        foreach (XElement bar in doc.Descendants("bar")) 
```

但我建议接受 XML 中命名空间的存在和重要性，并使用 LINQ to XML 提供的 XName 和 XNamespace 对象来处理它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T13:06:11.457

> 每当我尝试在 xml 中查找元素时，我都需要摆脱使用 XName.Get。如何将默认命名空间设置为 XDocument，以便在搜索时不会打扰。

你不能 - 但还有其他两种选择：

*   使用`+(XNamespace, string)`运算符：

    ```
    doc.Descendants(ns + "MyElement") 
    ```

*   只需创建`XName`一次值，然后在查询中引用它们，例如

    ```
    XName myElementName = ns + "MyElement";
    ...
    doc.Descendants(myElementName); 
    ```

理想情况下，无论如何您都不会动态创建名称空间——您不*知道*您应该查看的名称空间吗？如果这样做，您可以创建具有适当`XName`值的私有静态只读字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:02:14.267

你不能这样做：

```
doc = XDocument.Load(reader);
var ns = doc.Root.Attribute("xmlns").Value;
var result = from u in doc.Descendants.Elements(ns+"MyElement").Select(c=>c.Value); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-26T19:37:45.660

您还可以使用 LocalName，它使 LINQ 变得丑陋，但可以完成工作。（在这种情况下，从 MSBuild 项目文件中获取属性）。

```
var imports = from i in doc.Root.Elements()
              where i.Name.LocalName == "Import"
              from p in i.Attributes()
              where p.Name.LocalName == "Project"
              select p.Value; 
```

我喜欢这样做的原因是它使 XML 保持其原始形式，但它向其他人暗示正在发生一些有趣的事情。将“LocalName”放在 LINQ 表达式中是一种自我记录的技巧。

如果代码被分开，那么在 XmlTextReader 中关闭命名空间很容易被忽略。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-14T11:11:18.353

创建扩展方法：

```
 public static XElement ElementInCurrentNamespace(this XElement element, string elementName)
        {
            return element
                .Element(element.Name.Namespace.GetName(elementName));
        }

        public static IEnumerable<XElement> ElementsInCurrentNamespace(this XElement element, string elementName)
        {
            return element
                .Elements(element.Name.Namespace.GetName(elementName));
        } 
```

*   在第一次访问带有命名空间的元素时，使用`.Element`或`.Elements`带有命名空间的方法，例如`element.Element(namespace.GetName("foo"))`.
*   之后（只要后代元素具有相同的命名空间）使用上述扩展方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-08T11:21:24.557

这是一个旧帖子，但这是我的想法：

Elements.xml 根元素包含一个命名空间属性。以下代码忽略命名空间。

```
XDocument doc = XDocument.Load("Elements.xml");

            if (doc.Root != null)
                foreach (XElement xElement in doc.Root.Elements())
                {
                    Console.WriteLine(xElement);
                } 
```

# java - 守护线程和低优先级线程的区别

> ID：10298306
> 
> 赞同：9
> 
> 时间：2012-04-24T12:56:55.423
> 
> 标签：java, multithreading

最近有人问我一个问题：

> 我们已经有了将`setPriority()`线程设置为低优先级的方法。那为什么我们需要一个守护线程。他们之间有什么区别？

将线程标记为守护进程会改变它的调度吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-24T12:59:08.247

> 我们有 setPriority() 方法将线程设置为低优先级。那为什么我们需要一个守护线程。他们之间有什么区别？

通常，守护线程与优先级无关。当所有用户非守护线程完成时，JVM 将关闭。将线程标记为守护线程意味着它可以在 JVM 退出时被安全地杀死。

优先级与调度有关——与其他准备运行的线程相比，一个线程获得时间片的频率。您可以拥有低优先级守护线程或高优先级守护线程。您可以拥有低优先级和高优先级的非守护线程。顺便说一句，线程优先级仅适用于某些特定情况和某些架构，作为 Java 线程专家，我从不使用它们。

这些概念是正交的（相互独立的）——至少在 Java 线程模型中是这样。

至于何时创建线程守护进程，我将守护线程用于任何我不在乎它们是否在 JVM 退出时被中断的任务：保持活动线程、统计处理器、日志处理等。应用程序是一个非守护线程，必须特别中断或发出信号以某种方式退出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T14:22:26.853

正在运行的守护线程不会阻止您的程序结束/退出。但是，所有用户线程必须在您的程序退出之前结束。优先级可能适用于守护进程或用户线程。您可能会`priority`像在日常生活中那样理解它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-27T07:27:56.177

一个例子

1.  JVM 在低优先级线程完成时关闭。尽管守护线程仍在运行
2.  ALSO，显示由守护线程创建的线程自动成为守护线程

    ```
    package junk.daemon_thread_example;

    class DeamonThreadPlus implements Runnable{
        String id;
        boolean createChild;

        public DeamonThreadPlus(String id, boolean createChild){
            this.id = id;
            this.createChild = createChild;
        }

        @Override
        public void run() {
            // Parent daemon thread creates child daemon thread by default
            if (createChild)
                new Thread(new DeamonThreadPlus("DaemonChild", false)).start();

            // This thread never self-completes (only terminates when process dies)
            while (true){
                try {
                    Thread.sleep(1);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println("Daemon " 
                        + Thread.currentThread().isDaemon()
                        + " id = " + id);
                }
        }
    }

    class UThread implements Runnable{

        @Override
        public void run() {
            System.out.println("User thread start");
            try {
                Thread.sleep(5);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println("User thread end (program exits)");
        }
    }

    public class Caller{

        public static void main(String[] args) {
            Thread dt = new Thread( new DeamonThreadPlus("Daemon", true));
            dt.setDaemon(true);
            dt.start();

            Thread ut = new Thread(new UThread());
            ut.setPriority(Thread.MIN_PRIORITY);
            ut.start(); 
        }

    } 
    ```

    输出为： User thread start
    Daemon true id = Daemon
    Daemon true id = DaemonChild
    Daemon true id = Daemon
    Daemon true id = DaemonChild
    Daemon true id = Daemon
    Daemon true id = DaemonChild
    Daemon true id = Daemon
    Daemon true id = DaemonChild
    User thread end (程序退出)
    Daemon true id = DaemonChild
    Daemon true id = Daemon

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-24T13:25:53.937

如果 Java 运行时确定应用程序中运行的唯一线程是守护线程（即不存在用户线程），Java 运行时会立即关闭应用程序，从而有效地阻止所有死在其轨道上的守护线程。为了让应用程序继续运行，它必须始终具有至少一个活动用户线程。在所有其他方面，Java 运行时以完全相同的方式处理守护线程和用户线程。

除了在守护线程中......当 JVM 突然终止时，finally 块不会被执行，堆栈不会被展开——JVM 只是退出。由于这个原因，应该谨慎使用守护线程，并且将它们用于可能执行任何类型 I/O 的任务是很危险的。

# sql - SSIS 包中 ReadUncommitted 隔离级别的解决方法

> ID：10298315
> 
> 赞同：2
> 
> 时间：2012-04-24T12:57:29.340
> 
> 标签：sql, sql-server, ssis, locking, isolation-level

SSIS 中的 ReadUncommitted IsolationLevel 是 Microsoft 承认的以下错误，但“不会修复”，如下所述。

[http://connect.microsoft.com/SQLServer/feedback/details/498891/ssis-setting-isolationlevel-to-readuncommitted-still-uses-read-committed#details](http://connect.microsoft.com/SQLServer/feedback/details/498891/ssis-setting-isolationlevel-to-readuncommitted-still-uses-read-committed#details)

相同的解决方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T15:52:29.323

是的，但是您必须通知源上的 sql 命令，而不是选择表并在执行前设置隔离级别：

```
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
select * from test_isolation 
```

并且包应该选择可序列化的隔离级别（我认为错误可能是在组件上选择未提交的读取）

请参阅此示例。我有一个包可以将值从表复制`test_isolation`到表`test_isolation_destination`

这是我的两个表都是空的：

![在此处输入图像描述](../Images/82240afc15d7a006fe76d88748691662.png)

然后我开始了一个事务并运行下面的插入命令来插入一行`test_isolation`

![在此处输入图像描述](../Images/2e678931d31def4b9fbe91e30283bf0b.png)

该行是脏行，因为该事务尚未提交。

然后，我运行了这个包，你可以看到复制了一行：

![在此处输入图像描述](../Images/4b61e3b6dc1d2c4f26376e4e6fde3f06.png)

然后，我回滚了事务，如您所见，该行已从源表中清除，但未从目标表中清除。

![在此处输入图像描述](../Images/61f2680af32fab5c541cd3ff05782dd8.png)

这证明包以未提交的读取隔离级别运行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:34:59.117

使用 SQL Server Native Client Provider（如果您的目标平台是 MS-SQL）并设置隔离级别以查看它是否有效？

# android - 我想在片段中创建一个列表（比如左侧导航）。但无法在片段中填充列表

> ID：10298319
> 
> 赞同：0
> 
> 时间：2012-04-24T12:57:36.433
> 
> 标签：android

我想在片段中创建一个列表（比如左侧导航）。为此，我使用了以下代码，但无法在片段中填充列表。

主要.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <fragment android:id="@+id/categoryList"
              android:layout_height="fill_parent"
              android:name="com.example.fragments.CategoryListFragment"
              android:layout_width="wrap_content" />
</LinearLayout> 
```

主要活动：

```
public class MainActivity extends FragmentActivity {

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
} 
```

CategoryListFragment 类：

```
public class CategoryListFragment extends ListFragment {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        String[] values = new String[] { "AAAA", "BBBB", "CCCC" };
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(getActivity(),
                android.R.layout.simple_list_item_1, values);
        setListAdapter(adapter);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T04:59:09.247

在我的代码中，我在 main.xml 中包含了标题的布局，例如：

```
<include layout="@layout/titlebar"/> 
```

当我删除它时，一切正常。任何人都可以告诉我如何包含标题？

# c# - 数据从 C# 中的 sdf 数据库中消失

> ID：10298324
> 
> 赞同：2
> 
> 时间：2012-04-24T12:57:47.803
> 
> 标签：c#, database, visual-studio, sdf

我正在进行一些实验来掌握在 C# 和 Visual Studio 中管理数据库背后的概念。我所做的是创建一个简单的 sdf 数据库，其中只有一个表“书籍”，由两个列组成 - 自动递增键“ID”和“作者”字段。我尝试创建一个 DataSet 对象来加载、修改和存储更改。该程序将两个数字写入控制台 - 在从数据库加载数据之后，DataSet 中的行数，一个在修改它之后但在将其更新到 sdf 之前。

发生了什么，让我完全不知所措，是这样的：
第一次运行，我得到了我期望看到的结果，即 0 1 - 空表已成功加载，并且一个项目已添加到数据集中。

当我再次运行代码时，我得到 1 2。然后是 2 3、3 4 等等，正如预期的那样。直到我刷新数据库并尝试通过服务器资源管理器查看它的内容 - 我看到的只是空表。此外，当我之后再次运行该程序时，我得到 0 1 响应，就像一开始一样。

这是我正在使用的代码：

```
namespace DatasetTesting{
class Program
{
    static void Main(string[] args)
    {
        string conString = "Data Source=Books.sdf;Persist Security Info=False;Password=pass";
        SqlCeConnection objConn = new SqlCeConnection(conString);
        objConn.Open();

        SqlCeDataAdapter da = new SqlCeDataAdapter("Select * from Books", objConn);
        BooksDataSet booksSet = new BooksDataSet();
        da.FillSchema(booksSet,SchemaType.Source, "Books");
        da.Fill(booksSet, "Books");

        Console.Out.WriteLine(booksSet.Books.Rows.Count);

        BooksDataSet.BooksRow book = booksSet.Books.NewBooksRow();
        book.Author = "Tolkien";

        booksSet.Books.AddBooksRow(book);

        Console.Out.WriteLine(booksSet.Books.Rows.Count);

        SqlCeCommandBuilder comBuilder = new SqlCeCommandBuilder(da);
        da.Update(booksSet, "Books");

        Console.In.ReadLine();
    }
} 
```

我必须承认，在这一点上，我不知道可能出了什么问题——我会很感激任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:56:55.853

您是否将 .sdf 复制到您的项目中？

将 .sdf 复制到写入数据的项目中似乎是一个常见错误 - 然后您的 SQL 工作室经理正在查看不同的数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:02:39.793

做DataAdapter已经很久了，但是看[MSDN文档](http://msdn.microsoft.com/en-us/library/system.data.common.dataadapter.update.aspx)，我想你必须打电话

```
da.UpdateCommand = comBuilder.GetUpdateCommand(); 
```

在您更新之前。

# javascript - 使用Javascript在字符串中查找“#”字符

> ID：10298328
> 
> 赞同：1
> 
> 时间：2012-04-24T12:57:58.657
> 
> 标签：javascript

我需要通过 Javascript 解析给定的 url，但我无法使用 .split() 来完成此操作。

IE：

```
 var str = window.location.pathname;
  var substr = str.split('/');
  alert(substr) 
```

如果我输入此网址“http://mydomain.com/myaddress/page/2/”我有 thoose 值“myaddress,page,2”

但如果不是 / 我插入 #

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T12:59:33.333

使用[window.location.hash](https://developer.mozilla.org/en/DOM/window.location)，它会为您提供分解的部分。

此外，您正在尝试“拆分”在`#`中找不到的字符`window.location.pathname`，`window.location.hash`除非您使用`window.location`并搜索整个 url。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T12:59:42.813

您正在寻找[`location.hash`](https://developer.mozilla.org/en/DOM/window.location). 它包含了`#`它本身和它之后的一切。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T12:59:49.573

你需要使用`location.hash`属性

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T13:02:05.160

如果 jquery 是一个选项，请尝试[https://github.com/allmarkedup/jQuery-URL-Parser](https://github.com/allmarkedup/jQuery-URL-Parser) 示例

```
var url = $.url('"http://mydomain.com/myaddress/page/2/#lookforme');
alert(url.attr('fragment')); 
```

# c++ - 在 Linux 上的 C 中，popen / system to "ps all > file" 将所有行截断为 80 个字符

> ID：10298329
> 
> 赞同：7
> 
> 时间：2012-04-24T12:57:58.993
> 
> 标签：c++, c, linux, ubuntu, system

我正在使用 Ubuntu 11.10。如果我打开一个终端并调用：`ps all`我将结果截断（即每行最多 100 个字符）到终端窗口的大小。
如果我调用`ps all > file`这些行不会被截断并且所有信息都在文件中（有一行大约 200 个字符）

在 C 中，我试图实现相同的目标，但行被截断。
我已经尝试
`int rc = system("ps all > file");` 过以及 popen 的变体。
我假设系统（和popen）使用的shell默认每行的输出为80，如果我使用popen解析它是有意义的，但是由于我将它传递到一个文件，我希望它忽略大小就像我在 shell 中做的那样。

TL;DR
如何确保`ps all > file`从 C 应用程序调用时不截断行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T13:01:27.700

作为一种解决方法，请尝试在调用它时传递`-w`或可能传递`-ww`给它。`ps`

从手册页（BSD）：

```
-w      Use 132 columns to display information, instead of the default which is your 
        window size.  If the -w option is specified more than once, ps will use as many
        columns as necessary without regard for your window size.  When output is
        not to a terminal, an unlimited number of columns are always used. 
```

Linux：

```
-w      Wide output. Use this option twice for unlimited width. 
```

## 或者，

`fork/exec/wait`您自己而不是使用`system`;可能会取得一些成功 为简洁起见省略错误处理：

```
#include <unistd.h>
#include <stdio.h>

pid_t pid = fork();

if (!pid) {
   /* child */
   FILE* fp = fopen("./your-file", "w");
   close(STDOUT_FILENO);
   dup2(fileno(fp), STDOUT_FILENO);
   execlp("ps", "ps", "all", (char*)NULL);
} else {
  /* parent */
  int status;
  wait(&status);
  printf("ps exited with status %d\n", status);
} 
```

# datetime - 在 DQL 查询中添加 DateTime + Integer

> ID：10298332
> 
> 赞同：0
> 
> 时间：2012-04-24T12:58:08.023
> 
> 标签：datetime, symfony, doctrine

我想检索尚未完成的事件。我的问题是**startTime**是**DateTime**而**duration**是**Integer**。

我怎样才能做这个添加？

这段代码：

```
$events = $this->getRepository('Event')->createQueryBuilder('e')
               ->where('e.startTime+e.duration > CURRENT_TIMESTAMP()')
               ->getQuery();
               ->getResult(); 
```

扔给我 ：

```
SQLSTATE[42883]: Undefined function: 7 ERROR: operator does not exist: timestamp without time zone + integer 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:32:57.670

您不能将整数添加到日期。PHP/Doctrine 应该如何解释整数？天，小时，分钟，...？

MySQl 提供了一些处理 DATE 和 TIME 的函数，其中一些在 DQL 语言中可用，例如 DATE_ADD 如果您的整数是天数，这就是您所需要的！查看[Doctrine 文档](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.1/reference/dql-doctrine-query-language.html#dql-functions)

如果你的整数是秒数，它没有在 DQL 中实现，所以你需要创建一个“本机 SQL 查询”并使用 MySQL 函数，如[ADDTIME](http://dev.mysql.com/doc/refman/5.0/fr/date-and-time-functions.html#id694089)

如果您想为 DQL 创建一个 TIME_ADD 函数，请阅读这篇解释[如何创建自己的 DQL 函数的](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/cookbook/dql-user-defined-functions.html)文章！

# android - 如何弄清楚抛出了什么样的意图

> ID：10298340
> 
> 赞同：0
> 
> 时间：2012-04-24T12:58:39.443
> 
> 标签：android, android-intent, whatsapp

有没有可能找出某个应用程序正在抛出哪个 Intent？例如，如果有一条新的 whatsapp 消息作为通知，以便在单击通知时捕获该消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:02:04.240

您可以使用 Logcat。所有发送的 Intent 都记录在那里。

# c++ - Pantheios 未使用 MFC 应用程序登录到一个文件包含（一个 exe + 两个 DLL）

> ID：10298345
> 
> 赞同：0
> 
> 时间：2012-04-24T12:58:46.920
> 
> 标签：c++, dll, mfc, pantheios

我有一个由一个 exe 和两个 DLL 组成的 MFC 应用程序。exe 从这两个 DLL 调用函数。现在我正在尝试使用 Pantheios 日志库添加一些日志记录。

我想要实现
的目标： exe 和两个 DLL 都记录到硬盘驱动器中的同一个日志文件中。

这是我所做的：

1）在主exe程序中使用隐式链接：

* * *

```
#include "stdafx.h"

#include <pantheios/implicit_link/core.h>
#include <pantheios/implicit_link/fe.simple.h>
#include <pantheios/implicit_link/be.file.h>

#define USER_SPECIFIED_LEVEL
#ifndef USER_SPECIFIED_LEVEL
  #include <pantheios/implicit_link/fe.simple.h>
#endif

#ifdef USER_SPECIFIED_LEVEL
PANTHEIOS_CALL(int) pantheios_fe_init(void*   reserved,void**  ptoken)
{
    *ptoken = NULL;
    return 0;
}

PANTHEIOS_CALL(void) pantheios_fe_uninit(void* token)
{}

PANTHEIOS_CALL(PAN_CHAR_T const*)  pantheios_fe_getProcessIdentity  (void *  token)
{
    return PANTHEIOS_LITERAL_STRING(MY_PROGRAM_ID);
}

PANTHEIOS_CALL(int) pantheios_fe_isSeverityLogged(void* token
                                                  , int   severity
                                                  , int   backEndId)
{
    //SEV_CRITICAL=2 < SEV_ERROR=3 < SEV_WARNING=4 < SEV_INFORMATIONAL=6
    if(severity <= pantheios::SEV_INFORMATIONAL)
        return 1;//allow output for anything above information lvl
    return 0;
}

#endif 
```

* * *

在我需要添加我使用的日志记录的主 exe 程序中（在查看了 SO 中的这个[链接](https://stackoverflow.com/questions/10219300/connect-pantheios-logging-in-a-dll-to-the-main-applications-logging)`PANTHEIOS_BE_FILE_F_SHARE_ON_WINDOWS`之后）：

```
pantheios_be_file_setFilePath(PSTR("C:\\TestLog.log"),**PANTHEIOS_BE_FILE_F_SHARE_ON_WINDOWS**, 0, PANTHEIOS_BEID_ALL);
        pantheios::log_NOTICE(PSTR("process id: ["), pantheios::processId, PSTR("]"));
    pantheios::log_NOTICE(PSTR("thread id: ["), pantheios::threadId, PSTR("]"));
    pantheios::log_INFORMATIONAL(PSTR("testing log messagse")); 
```

这工作正常，我可以按预期登录 c:\TestLog.log 文件。但是，我根本无法在这两个 DLL 中进行日志记录，它只会为每个日志记录调用提供错误：

```
 pantheios::log_INFORMATIONAL(PSTR("testing message")); 
```

说令牌是空的，所以我用谷歌搜索并找到了一个解决方案：

2）我需要打电话：

```
pantheios::init(); 
```

对于每个 DLL 在其`DllMain`函数中的初始化。这样，当我尝试登录 DLL 时，不再出现“空令牌”错误，但日志文件中的 DLL 仍然没有记录任何内容（同样，主 exe 程序很好）。

3）我稍微调整了一下，我必须更改 DLL 日志中的日志文件名，以便它们都记录到不同的文件：

DLL #1：

```
pantheios_be_file_setFilePath(PSTR("C:\\TestLogDll1.log"),PANTHEIOS_BE_FILE_F_SHARE_ON_WINDOWS, 0, PANTHEIOS_BEID_ALL); 
```

DLL #2：

```
pantheios_be_file_setFilePath(PSTR("C:\\TestLogDll2.log"),PANTHEIOS_BE_FILE_F_SHARE_ON_WINDOWS, 0, PANTHEIOS_BEID_ALL); 
```

这样我就有 3 个日志文件都可以正常工作：

*   主程序的 TestLog.log
*   DLL #1 的 TestLogDll1.log
*   DLL #2 的 TestLogDll2.log

但是我仍然无法让两个 DLL 都记录到与主 exe 相同的文件（TestLog.log）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T08:58:31.340

要在 exe 和 dll 之间共享实体或对象，您可能需要在导出它们的 exe 中声明 __declspec(dllexport)，并在导入它们的 dll 中声明 __declspec(dllimport)。

供参考：
1) [http://sourceforge.net/projects/pantheios/forums/forum/647484/topic/1639420/index/page/1](http://sourceforge.net/projects/pantheios/forums/forum/647484/topic/1639420/index/page/1)
2)[从 dll 使用 Pantheios 日志框架](https://stackoverflow.com/questions/1460185/use-pantheios-logging-framework-from-a-dll)

# python - mongodb游标id无效错误

> ID：10298354
> 
> 赞同：42
> 
> 时间：2012-04-24T12:59:11.053
> 
> 标签：python, mongodb

我正在尝试遍历此循环：

```
for doc in coll.find() 
```

我在第 100,000 条记录中收到以下错误。

```
File "build\bdist.win32\egg\pymongo\cursor.py", line 703, in next
File "build\bdist.win32\egg\pymongo\cursor.py", line 679, in _refresh
File "build\bdist.win32\egg\pymongo\cursor.py", line 628, in __send_message
File "build\bdist.win32\egg\pymongo\helpers.py", line 95, in _unpack_response
pymongo.errors.OperationFailure: cursor id '1236484850793' not valid at server 
```

这个错误是什么意思？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-04-24T13:05:00.380

也许您的光标在服务器上超时。要查看这是否是问题所在，请尝试设置 timeout=False`：

```
for doc in coll.find(timeout=False) 
```

见[http://api.mongodb.org/python/1.6/api/pymongo/collection.html#pymongo.collection.Collection.find](http://api.mongodb.org/python/1.6/api/pymongo/collection.html#pymongo.collection.Collection.find)

如果是超时问题，一种可能的解决方案是设置`batch_size`(s. other answers)。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-10-01T13:34:15.507

*   设置`timeout=False`是危险的，永远不要使用，因为与游标的连接可以无限期保持打开状态，这会影响系统性能。[文档特别提到](http://api.mongodb.org/python/current/api/pymongo/collection.html#pymongo.collection.Collection.find)了手动关闭光标的需要。
*   将 设置`batch_size`为较小的数字会起作用，但会产生很大的延迟问题，因为我们需要比需要更频繁地访问数据库。
    例如：
    小批量的 500 万个文档需要数小时才能检索到默认 batch_size 在几分钟内返回的相同数据。

在我的解决方案中，必须在光标上使用**排序：**

```
done = False
skip = 0
while not done:
    cursor = coll.find()
    cursor.sort( indexed_parameter ) # recommended to use time or other sequential parameter.
    cursor.skip( skip )
    try:
        for doc in cursor:
            skip += 1
            do_something()
        done = True
    except pymongo.errors.OperationFailure, e:
        msg = e.message
        if not (msg.startswith("cursor id") and msg.endswith("not valid at server")):
            raise 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-07-14T21:36:50.757

设置`timeout=False`是一种非常糟糕的做法。摆脱 cursor id 超时异常的更好方法是估计您的循环在 10 分钟内可以处理多少个文档，并得出一个保守的批量大小。这样，只要前一批中的文档用完，MongoDB 客户端（在本例中为 PyMongo）就必须不时地查询服务器。这将使光标在服务器上保持活动状态，并且您仍将受到 10 分钟超时保护的保护。

以下是设置游标批量大小的方法：

```
for doc in coll.find().batch_size(30):
    do_time_consuming_things() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-01T23:45:34.883

你应该选择一个较低的 batch_size 值来解决这个问题：

```
col.find({}).batch_size(10) 
```

看下面的[答案](https://stackoverflow.com/a/24200795/7625684)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-11-27T18:37:42.777

您还可以使用以下命令强制评估：

```
for doc in list(coll.find()) 
```

# variables - 如何在 PHP5 中删除请求的变量

> ID：10298358
> 
> 赞同：0
> 
> 时间：2012-04-24T12:59:35.497
> 
> 标签：variables, php-5.3

我有一个 HTML 表，其中每一行都有一个数据库记录列表，并且每个人都有一个表单，其中包含使用其提交按钮（方法 POST）删除数据库中的记录所需的信息。

所以我从全局变量 $_POST 中获取值。我的问题是，当我单击任何这些提交按钮时，它会引发级联或递归删除，并且所有记录都被删除。

我一直在谷歌搜索，但我没有找到任何东西。我看到了类似 unset($_POST['myvar']) 的代码，但它不起作用。

我该如何解决这个问题？

问候， oggie0563

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T12:24:40.863

这是一个 PRG 问题。我找到了这个，

[php-postredirectget 类](http://patrickdawkins.com/web-development/php-postredirectget-class/)

也许这已经足够了。

# java - 带有类别的 JList

> ID：10298360
> 
> 赞同：2
> 
> 时间：2012-04-24T12:59:46.857
> 
> 标签：java, swing, jlist

我一直在努力寻找带有类别的 JList 实现。我想我可以自己实现一个，但是单元格渲染器、模型和一切都有点痛苦。所以我转向你！

我的问题是：如果我有一个分配给类别的项目列表，我可以在 JTree 中显示它们。但是因为我知道深度永远不会超过 2，所以我觉得 JTree 是矫枉过正的。您是否知道在 Swing（或某些外部库）中是否有一种简单的方法来制作这样的 JList：

[带有类别的 Jlist http://dl.dropbox.com/u/4607638/jlist-cats.png](http://dl.dropbox.com/u/4607638/jlist-cats.png)

蓝色字段是标签（不可选择），白色字段是普通列表单元格？

提前感谢任何提示和帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T14:03:09.960

是可能的

*   [具有一列的 JTreeTable](https://stackoverflow.com/a/8564627/714968)

*   [将 JTable 放入 JLists/JTree](https://stackoverflow.com/questions/8843638/put-jtable-in-the-jtree)，反之亦然

*   JPanels 的扩展/折叠

![在此处输入图像描述](../Images/537860037db4874f6889cdf8f74ec301.png)![在此处输入图像描述](../Images/5e546bee19a910526520587ed8d4f311.png)![在此处输入图像描述](../Images/98411957d1d4bd8788a3d230521a1308.png)

```
import java.awt.*;
import java.awt.event.*;
import java.awt.font.*;
import java.awt.image.BufferedImage;
import javax.swing.*;

public class ExpandingPanels extends MouseAdapter {

    private ActionPanel[] aps;
    private JPanel[] panels;

    public ExpandingPanels() {
        assembleActionPanels();
        assemblePanels();
    }

    @Override
    public void mousePressed(MouseEvent e) {
        ActionPanel ap = (ActionPanel) e.getSource();
        if (ap.target.contains(e.getPoint())) {
            ap.toggleSelection();
            togglePanelVisibility(ap);
        }
    }

    private void togglePanelVisibility(ActionPanel ap) {
        int index = getPanelIndex(ap);
        if (panels[index].isShowing()) {
            panels[index].setVisible(false);
        } else {
            panels[index].setVisible(true);
        }
        ap.getParent().validate();
    }

    private int getPanelIndex(ActionPanel ap) {
        for (int j = 0; j < aps.length; j++) {
            if (ap == aps[j]) {
                return j;
            }
        }
        return -1;
    }

    private void assembleActionPanels() {
        String[] ids = {"level 1", "level 2", "level 3", "level 4"};
        aps = new ActionPanel[ids.length];
        for (int j = 0; j < aps.length; j++) {
            aps[j] = new ActionPanel(ids[j], this);
        }
    }

    private void assemblePanels() {
        GridBagConstraints gbc = new GridBagConstraints();
        gbc.insets = new Insets(2, 1, 2, 1);
        gbc.weightx = 1.0;
        gbc.weighty = 1.0;
        JPanel p1 = new JPanel(new GridBagLayout());
        gbc.gridwidth = GridBagConstraints.RELATIVE;
        p1.add(new JButton("button 1"), gbc);
        gbc.gridwidth = GridBagConstraints.REMAINDER;
        p1.add(new JButton("button 2"), gbc);
        gbc.gridwidth = GridBagConstraints.RELATIVE;
        p1.add(new JButton("button 3"), gbc);
        gbc.gridwidth = GridBagConstraints.REMAINDER;
        p1.add(new JButton("button 4"), gbc);
        JPanel p2 = new JPanel(new GridBagLayout());
        gbc.gridwidth = 1;
        gbc.anchor = GridBagConstraints.EAST;
        p2.add(new JLabel("enter"), gbc);
        gbc.anchor = GridBagConstraints.WEST;
        p2.add(new JTextField(8), gbc);
        gbc.anchor = GridBagConstraints.CENTER;
        p2.add(new JButton("button 1"), gbc);
        gbc.gridwidth = GridBagConstraints.REMAINDER;
        p2.add(new JButton("button 2"), gbc);
        JPanel p3 = new JPanel(new BorderLayout());
        JTextArea textArea = new JTextArea(8, 12);
        textArea.setLineWrap(true);
        p3.add(new JScrollPane(textArea));
        JPanel p4 = new JPanel(new GridBagLayout());
        addComponents(new JLabel("label 1"), new JTextField(12), p4, gbc);
        addComponents(new JLabel("label 2"), new JTextField(16), p4, gbc);
        gbc.gridwidth = 2;
        gbc.gridy = 2;
        p4.add(new JSlider(), gbc);
        gbc.gridy++;
        JPanel p5 = new JPanel(new GridBagLayout());
        p5.add(new JButton("button 1"), gbc);
        p5.add(new JButton("button 2"), gbc);
        p5.add(new JButton("button 3"), gbc);
        p5.add(new JButton("button 4"), gbc);
        gbc.weighty = 1.0;
        gbc.fill = GridBagConstraints.BOTH;
        p4.add(p5, gbc);
        panels = new JPanel[]{p1, p2, p3, p4};
    }

    private void addComponents(Component c1, Component c2, Container c, GridBagConstraints gbc) {
        gbc.anchor = GridBagConstraints.EAST;
        gbc.gridwidth = GridBagConstraints.RELATIVE;
        c.add(c1, gbc);
        gbc.anchor = GridBagConstraints.WEST;
        gbc.gridwidth = GridBagConstraints.REMAINDER;
        c.add(c2, gbc);
        gbc.anchor = GridBagConstraints.CENTER;
    }

    private JPanel getComponent() {
        JPanel panel = new JPanel(new GridBagLayout());
        GridBagConstraints gbc = new GridBagConstraints();
        gbc.insets = new Insets(1, 3, 0, 3);
        gbc.weightx = 1.0;
        gbc.fill = GridBagConstraints.HORIZONTAL;
        gbc.gridwidth = GridBagConstraints.REMAINDER;
        for (int j = 0; j < aps.length; j++) {
            panel.add(aps[j], gbc);
            panel.add(panels[j], gbc);
            panels[j].setVisible(false);
        }
        JLabel padding = new JLabel();
        gbc.weighty = 1.0;
        panel.add(padding, gbc);
        return panel;
    }

    public static void main(String[] args) {
        ExpandingPanels test = new ExpandingPanels();
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.getContentPane().add(new JScrollPane(test.getComponent()));
        f.setSize(360, 500);
        f.setLocation(200, 100);
        f.setVisible(true);
    }
}

class ActionPanel extends JPanel {

    private static final long serialVersionUID = 1L;
    private String text;
    private Font font;
    private boolean selected;
    private BufferedImage open, closed;
    public Rectangle target;
    private final int OFFSET = 30, PAD = 5;

    public ActionPanel(String text, MouseListener ml) {
        this.text = text;
        addMouseListener(ml);
        font = new Font("sans-serif", Font.PLAIN, 12);
        selected = false;
        setBackground(new Color(200, 200, 220));
        setPreferredSize(new Dimension(200, 20));
        setBorder(BorderFactory.createRaisedBevelBorder());
        setPreferredSize(new Dimension(200, 20));
        createImages();
        setRequestFocusEnabled(true);
    }

    public void toggleSelection() {
        selected = !selected;
        repaint();
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2 = (Graphics2D) g;
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        int w = getWidth();
        int h = getHeight();
        if (selected) {
            g2.drawImage(open, PAD, 0, this);
        } else {
            g2.drawImage(closed, PAD, 0, this);
        }
        g2.setFont(font);
        FontRenderContext frc = g2.getFontRenderContext();
        LineMetrics lm = font.getLineMetrics(text, frc);
        float height = lm.getAscent() + lm.getDescent();
        float x = OFFSET;
        float y = (h + height) / 2 - lm.getDescent();
        g2.drawString(text, x, y);
    }

    private void createImages() {
        int w = 20;
        int h = getPreferredSize().height;
        target = new Rectangle(2, 0, 20, 18);
        open = new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
        Graphics2D g2 = open.createGraphics();
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2.setPaint(getBackground());
        g2.fillRect(0, 0, w, h);
        int[] x = {2, w / 2, 18};
        int[] y = {4, 15, 4};
        Polygon p = new Polygon(x, y, 3);
        g2.setPaint(Color.green.brighter());
        g2.fill(p);
        g2.setPaint(Color.blue.brighter());
        g2.draw(p);
        g2.dispose();
        closed = new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
        g2 = closed.createGraphics();
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2.setPaint(getBackground());
        g2.fillRect(0, 0, w, h);
        x = new int[]{3, 13, 3};
        y = new int[]{4, h / 2, 16};
        p = new Polygon(x, y, 3);
        g2.setPaint(Color.red);
        g2.fill(p);
        g2.setPaint(Color.blue.brighter());
        g2.draw(p);
        g2.dispose();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:26:33.800

Use a [`JTree`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTree.html) instead. It easily supports groups as branches, while items are leaves. See [How to Use Trees](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html) for more details and screen-shots like..

![DynamicTreeDemo](../Images/7c1331db4918e7907c0e7178c5e85976.png)

The renderer can adjust the look to need.

* * *

As noted by @Robin:

> I think the single `JTree` as well as a single `JList` with a custom renderer both have the same shortcoming: all nodes are selectable.

The branch nodes are selectable in order to open & close them, so I see no problem with them being selectable. It is a slightly different user action to the list with 'headings'. There are disadvantages to using a tree (e.g. having to tab past branch groups, & advantages also (e.g. the branches are closed by default to give access to the groups with fewer keystrokes/clicks).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T13:13:16.363

也许你可以使用`JComboBox`他们在这个[例子](https://stackoverflow.com/a/5231915/261156)中所做的那样。如果没有，它可能会让您了解如何使用`JList`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T14:01:36.970

您可以自己实现[ListCellRenderer](http://docs.oracle.com/javase/7/docs/api/javax/swing/ListCellRenderer.html)以满足您的需求。让它检查它正在渲染的项目是父节点还是子节点。

不让列表中的父类别可选择是有点棘手。如果选择了父类别，您可以修改渲染器以不显示，或者可能覆盖 jlist 的默认行为。

亲自？我会选择 JTree，你可以让它看起来和你的列表完全一样，但是它增加了很多其他的能力，比如 3 级深度，它看起来更灵活。

你有两个理由不使用 jtree。

可用性：您可以修改 jtree 以按照您想要的方式操作，就像使用列表一样

设计：我认为将树（类别和子类别是树）存储在平面列表中不是更好的设计。

# c++ - Cython 和 C++ 继承

> ID：10298371
> 
> 赞同：13
> 
> 时间：2012-04-24T13:00:28.463
> 
> 标签：c++, python, inheritance, cython

我有 2 个类，A 和 B。B 继承自 A。

```
//C++    
class A
{
    public:
        int getA() {return this->a;};
        A() {this->a = 42;}
    private:
        int a;

};

class B: public A
{
    public:
       B() {this->b = 111;};
       int getB() {return this->b;};
    private:
        int b;

}; 
```

现在我想使用 Cython 连接这两个类，并有可能从 B 实例调用 getA() 方法：

```
a = PyA()
b = PyB()
assert a.getA() == b.getA() 
```

目前我的 pyx 文件如下所示：

```
cdef extern from "Inherit.h" :
    cdef cppclass A:
       int getA()

    cdef cppclass B(A):
       int getB()

cdef class PyA:
    cdef A* thisptr

    def __cinit__(self):
       print "in A: allocating thisptr"
       self.thisptr = new A()
    def __dealloc__(self):
       if self.thisptr:
           print "in A: deallocating thisptr"
           del self.thisptr

    def getA(self):
       return self.thisptr.getA()

cdef class PyB(PyA):
    def __cinit__(self):
       if self.thisptr:
          print "in B: deallocating old A"
          del self.thisptr
       print "in B: creating new b"
       self.thisptr = new B()

    def __dealloc__(self):
       if self.thisptr:
           print "in B: deallocating thisptr"
           del self.thisptr
           self.thisptr = <A*>0

    def getB(self):
       return (<B*>self.thisptr).getB() 
```

虽然我希望这段代码不会做任何太危险的事情，但我也希望有更好的方法来处理它。

还使用该模块生成以下输出：

```
>>> from inherit import *
>>> b = PyB()
in A: allocating thisptr
in B: deallocating old A
in B: creating new b
>>> b.getA()
42
>>> b.getB()
111
>>> del b
in B: deallocating thisptr 
```

而且我真的不喜欢分配一个 A 实例只是为了在之后立即释放它。

有关如何正确执行此操作的任何建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-09T23:34:41.410

我做了一些实验，并且已经准备好了答案，但现在我知道问题出在哪里：

> 如果你的扩展类型有基类型，`__cinit__`在你的方法被调用之前，会自动调用基类型的`__cinit__`方法；您不能显式调用继承的`__cinit__`方法。

所以真正的问题是 Cython 类型仍然没有构造函数，只有预初始化钩子`__cinit__`，它的行为更像默认构造函数。您不能从构造函数调用虚拟方法，也不能从`__cinit__`任何一个调用它（如果您进行调用，它的行为就像非虚拟一样）。

不知何故，里面返回`__cinit__`了`type(self)`正确的类型对象，但它是没用的。Cython 没有静态字段，方法和类型对象只能是实例`type`（没有元类）。Python`@staticmethod`很容易被覆盖，所以它没用。

因此，没有其他方法可以将分配放入其中，并在您使用它的任何地方`def __init__(self):`检查是否已初始化。`thisptr`

您可以考虑创建一个全局虚拟 C++ 对象，并将其分配`thisptr`给以避免检查和崩溃。没有后初始化程序挂钩，因此您将无法检查是否已经进行了正确的初始化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T16:18:22.843

我以前从未关注过 Cython，所以如果这太离谱了，请原谅我。那说：

在 C++ 中，只要你有`bar : foo`（`bar`继承自`foo`），如果`foo`有一个默认构造函数，它会在`bar`创建时自动调用......除非你为父级调用你自己的自定义构造函数。

我不知道 Python，但一些快速的谷歌搜索告诉我，同样的原则也适用。即只有在不手动调用另一个`PyA`时才会调用默认构造函数。`PyB`

在那种情况下，这样的事情不会起作用吗？

```
cdef class PyA:
    cdef A* thisptr

    def __cinit__(self, bypasskey="")
       if bypasskey == "somesecret"
           print "in A: bypassing allocation"
       else
           print "in A: allocating thisptr"
           self.thisptr = new A()

...

cdef class PyB(PyA):
    def __cinit__(self):
       super( PyB, self ).__init__("somesecret") 
```

请注意，我敢肯定它很粗糙。但也许这里的想法会给你一些工作？

* * *

这是另一个想法。我几乎可以肯定它会起作用（但语法已关闭），而且它肯定比上面的要干净得多：

```
cdef class PyA:
    cdef A* thisptr

    def __cinit__(self, t=type(A))
           self.thisptr = new t()

...

cdef class PyB(PyA):
    def __cinit__(self):
       super( PyB, self ).__init__(type(B)) 
```

或者它可能看起来像这样？

```
cdef class PyA:
    cdef A* thisptr

    def __cinit__(self, t=A)
           self.thisptr = new t()

...

cdef class PyB(PyA):
    def __cinit__(self):
       super( PyB, self ).__init__(B) 
```

* * *

我不是为了赏金而发布这个（你也不会被迫将它分配给任何人），我只是与你分享一些想法。

我认为你可以/应该能够避免“崩溃解释器”，如果你要么

a）使第二个构造函数只对 b 可见（不知道这是否可能），或者

b) 在其他地方使用之前检查 a 是否为空，或者

c) 在绕过分配之前检查调用函数是否是 b 的构造函数。

此外，Cython C++ 文档[清楚地](http://docs.cython.org/src/userguide/wrapping_CPlusPlus.html)表明，对于所有 C++ 改编，可能没有惯用的解决方案，带有模糊的、手摇的引号，例如“其他人（你？）可能需要进行一些试验才能找到最优雅的处理方式这个问题。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T20:59:17.967

（我对 Python 和 Cython 都是新手，所以请接受这个答案来了解它的价值。）如果您在`__init__`函数而不是`__cinit__`函数中初始化 thisptr，那么在这个特定示例中，事情似乎在没有额外分配/删除的情况下工作......基本上将上面的函数更改`__cinit__`为：

```
def __init__(self):
    print "in A: creating new A"
    self.thisptr = new A() 
```

和

```
def __init__(self):
    print "in B: creating new B"
    self.thisptr = new B() 
```

分别。但是，我确信这至少在理论上是不安全的（实际上也可能是不安全的），但也许有人可以评论到底有多不安全......

例如，从 Cython 的介绍[论文](http://conference.scipy.org/proceedings/SciPy2009/paper_1/)中我们知道“`__init__`不能保证运行（例如，可以创建一个子类而忘记调用祖先构造函数）”。我无法构建发生这种情况的测试用例，但这可能是由于我普遍缺乏 Python 知识......

# android - 带有许多复选框的 ListView 适配器

> ID：10298387
> 
> 赞同：0
> 
> 时间：2012-04-24T13:01:19.567
> 
> 标签：android, listview, checkbox, xamarin.android, listview-adapter

我的列表视图有一些小问题。每个项目都有一些信息和一个复选框。这显示得很好，我可以选择和取消选择复选框等。

但是我发现了一些奇怪的行为。假设我单击第一行的第一个复选框。如果 ListView 很小，那么您不需要向下滚动，这可以正常工作。但是如果 ListView 很大，所以我需要向下滚动才能查看所有项目，底部的一些随机项目也会被点击。相反的行为相同，如果我单击列表视图底部的复选框并向上滚动，则会在顶部单击一些随机复选框。如果我在某处单击多个复选框，则在其他地方单击的复选框数量相同。我认为这发生在调用 GetView(...) 时，即更新时。然后它会点击一些新的复选框，但我不知道为什么。

在这里感谢一些帮助！:)

我的适配器的 SSSCE：

```
public class ListViewAdapterSSCCE : BaseAdapter
{
    private Activity myActivity;
    private string[] someData;
    private int numberOfElements;
    private CheckBox[] boxes;

    public ListViewAdapterSSCCE(Activity activity)
    {
        this.myActivity = activity;

        for (int i = 0; i < numberOfElements; i++)
            this.boxes[i] = new CheckBox(myActivity);
    }

    public void SetData(string[] someData)
    {
        this.someData = someData;
        this.numberOfElements = someData.Length;
    }

    public void CheckAllBoxes(bool isChecked)
    {
        for (int i = 0; i < numberOfElements; i++)
            this.boxes[i].Checked = isChecked;
    }

    public override Java.Lang.Object GetItem(int position)
    {
        return null;
    }

    public override long GetItemId(int position)
    {
        return 10;
    }

    public override int Count
    {
        get { return numberOfElements; }
    }

    public override View GetView(int position, View convertView, ViewGroup parent)
    {
        if (convertView == null)
        {
            LayoutInflater inflater = (LayoutInflater)myActivity.GetSystemService(Context.LayoutInflaterService);
            convertView = inflater.Inflate(Resource.Layout.ChildrenList_item, null);
        }

        var itemBox = convertView.FindViewById<CheckBox>(Resource.Id.checkbox);
        this.boxes[position] = itemBox;

        var textView = convertView.FindViewById<TextView>(Resource.Id.item_data);
        textView.Text = this.someData[position];

        return convertView;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:29:31.057

如前所述，问题在于您没有在 getView 中设置复选框值。

您还可以大大提高代码的效率。您应该做的第一件事是将复选框添加到您的子视图 xml，而不是创建它们的数组。而是创建一个布尔数组来存储该值。

请注意，我正在像对 Java 一样修改此内容，因此您可能需要在 C# 中更改一些内容。

```
 public class ListViewAdapterSSCCE : BaseAdapter
    {
    private string[] someData;
    private int numberOfElements;
    private boolean[] checkValue;
    private LayoutInflater inflater;

    public ListViewAdapterSSCCE(Context context)
    {

        inflater = LayoutInflater.from(context);
    }

    public void SetData(string[] someData)
    {
        this.someData = someData;
        this.numberOfElements = someData.Length;
    }

    public void CheckAllBoxes(bool isChecked)
    {
        for (int i = 0; i < numberOfElements; i++)
            checkValue[i] = true;
    }

    public override Java.Lang.Object GetItem(int position)
    {
        return null;
    }

    public override long GetItemId(int position)
    {
        return 10;
    }

    public override int Count
    {
        get { return numberOfElements; }
    }

    public override View GetView(final int position, View convertView, ViewGroup parent)
    {

        final ViewHolder holder; 

        if (convertView == null)
        {            
            convertView = inflater.Inflate(Resource.Layout.ChildrenList_item, null);

            holder = new ViewHolder();
            holder.itemBox = convertView.FindViewById<CheckBox>(Resource.Id.checkbox);
            holder.textView = convertView.FindViewById<TextView>(Resource.Id.item_data);

            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        itemBox = checkValue[position];    

        itemBox.setOnCheckedChangeListener(new OnCheckedChangeListener(){

            @Override
            public void onCheckedChanged(CompoundButton buttonView,
                    boolean isChecked) {

                        checkValue[positon] = isChecked;

            }

        });

        textView.Text = this.someData[position];

        return convertView;
    }

    class ViewHolder
    {
        CheckBox itemBox;
        TextView textView; 
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:27:56.693

您可以在此处查看示例代码，以对复选框状态进行替代修复：

[android中的自定义复选框难度](https://stackoverflow.com/questions/10214271/custom-checkbox-difficulty-in-android/10278905#10278905)

如果这篇文章对您有帮助，请将此帖子标记为答案。

谢谢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:04:47.213

问题可能与您在适配器中处理回收视图的方式有关。查看您的`getView`并检查您返回的每个项目的 CheckBox 是否根据其“模型”正确设置。

编辑：我确认。您必须像处理 textview 的文本一样设置复选框状态。顺便说一句，我认为以您的方式处理复选框是一个坏主意。您可以做的最好的事情是为复选框定义一个“模型”（即：一个简单的 boolean[] 可以做到这一点），避免实例化太多的复选框。在您的 getView 中，您可以检查相应的布尔值并相应地设置复选框。

为了全部选中/取消选中，您可以修改 checkAllBoxes 中的布尔数组，然后调用 notifyDatasetChanged()，触发列表视图的更新，但仅对实际显示的项目进行操作：)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T13:30:45.897

mr_archano 是对的，这是因为您使用的是 convertView，它允许您重新使用/回收不再查看的视图。这是您正确执行此操作所需的：

*保存每个复选框状态的对象*

因为您的列表视图项目正在被回收，所以您不能依赖它们来保持复选框的正确状态。因此，您需要某种对象/数组来保存每个列表项的复选框的正确状态。

*从状态管理对象中读取*

然后，当您调用 GetView 时，您必须根据该对象/数组的状态将复选框的值设置为选中/未选中。

*写入状态管理对象*

您需要为每个复选框实现某种 OnChecked 侦听器，以便您可以在语句管理对象/数组中正确设置该复选框的值。

*您应该尝试使用 ViewHolder 的*

ViewHolder 非常简单。当您第一次创建视图（不使用转换视图）时，您必须调用“FindViewByID”来获取对文本框和复选框的引用。如果您将它们保存在 ViewHolder 中，您应该能够在使用 ConvertView 对象时直接引用它们，这将节省对“FindViewByID”的额外调用。看到它练习要容易得多。

本教程几乎可以满足您的需要：[http ://windrealm.org/tutorials/android/listview-with-checkboxes-without-listactivity.php](http://windrealm.org/tutorials/android/listview-with-checkboxes-without-listactivity.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T07:11:14.540

我在处理大列表时遇到了同样的问题。对于喜欢我通过谷歌在这里找到的人，我想给出我的解决方案，我认为它更容易理解。正如人们指出的那样，`ListView`重用了视图。所以你不应该让视图保持你的数据状态。

我正在使用`SimpleAdapter`，通过设置自定义`ViewBinder`，我发现很容易解决这个问题。

```
listItemAdapter.setViewBinder(new SimpleAdapter.ViewBinder() {

    public boolean setViewValue(View view, Object obj, String s) {

    if(view instanceof CheckBox){
        ((CheckBox)view).setChecked((Boolean)obj);
        return true;
    }
    return false;
}
}); 
```

您需要以自己的方式保持*选中/未选中状态。*

# ravendb - RavenDb ：更新非规范化引用属性值

> ID：10298390
> 
> 赞同：5
> 
> 时间：2012-04-24T13:01:32.427
> 
> 标签：ravendb

我已经实现了 RavenDB[非规范化参考](http://ravendb.net/docs/faq/denormalized-updates)模式。我正在努力将静态索引和补丁更新请求连接在一起，以确保在更改引用的实例值时更新我的​​非规范化引用属性值。

这是我的域：

```
public class User
{
    public string UserName { get; set; }
    public string Id { get; set; }
    public string Email { get; set; }
    public string Password { get; set; }
}

public class UserReference
{
    public string Id { get; set; }
    public string UserName { get; set; }

    public static implicit operator UserReference(User user)
    {
        return new UserReference
                {
                        Id = user.Id,
                        UserName = user.UserName
                };
    }
}

public class Relationship
{ 
    public string Id { get; set; }
    public UserReference Mentor { get; set; }
    public UserReference Mentee { get; set; }
} 
```

您可以看到 UserReference 包含被引用用户的 Id 和 UserName。所以现在，如果我更新给定用户实例的用户名，那么我希望所有用户引用中的引用用户名值也更新。为此，我编写了一个静态索引和一个补丁请求，如下所示：

```
public class Relationships_ByMentorId : AbstractIndexCreationTask<Relationship>
{
    public Relationships_ByMentorId()
    {
        Map = relationships => from relationship in relationships
                                select new {MentorId = relationship.Mentor.Id};
    }
}

public static void SetUserName(IDocumentSession db, User mentor, string userName)
{
    mentor.UserName = userName;
    db.Store(mentor);
    db.SaveChanges();

    const string indexName = "Relationships/ByMentorId";
    RavenSessionProvider.UpdateByIndex(indexName,
        new IndexQuery
        {
                Query = string.Format("MentorId:{0}", mentor.Id)
        },
        new[]
        {
                new PatchRequest
                {
                        Type = PatchCommandType.Modify,
                        Name = "Mentor",
                        Nested = new[]
                                {
                                        new PatchRequest
                                        {
                                                Type = PatchCommandType.Set,
                                                Name = "UserName",
                                                Value = userName
                                        },
                                }
                }
        },
        allowStale: false);
} 
```

最后是由于更新未按预期工作而失败的 UnitTest。

```
[Fact]
public void Should_update_denormalized_reference_when_mentor_username_is_changed()
{
    using (var db = Fake.Db())
    {
        const string userName = "updated-mentor-username";
        var mentor = Fake.Mentor(db);
        var mentee = Fake.Mentee(db);
        var relationship = Fake.Relationship(mentor, mentee, db);
        db.Store(mentor);
        db.Store(mentee);
        db.Store(relationship);
        db.SaveChanges();

        MentorService.SetUserName(db, mentor, userName);

        relationship = db
            .Include("Mentor.Id")
            .Load<Relationship>(relationship.Id);

        relationship.ShouldNotBe(null);
        relationship.Mentor.ShouldNotBe(null);
        relationship.Mentor.Id.ShouldBe(mentor.Id);
        relationship.Mentor.UserName.ShouldBe(userName);

        mentor = db.Load<User>(mentor.Id);
        mentor.ShouldNotBe(null);
        mentor.UserName.ShouldBe(userName);
    }
} 
```

一切运行良好，索引在那里，但我怀疑这没有返回补丁请求所需的关系，但老实说，我已经没有天赋了。你能帮忙吗？

**编辑 1**

@MattWarren`allowStale=true`没有帮助。但是我注意到了一个潜在的线索。

因为这是一个单元测试，所以我使用的是 InMemory，嵌入式 IDocumentSession -`Fake.Db()`在上面的代码中。然而，当调用静态索引时，即在执行 时`UpdateByIndex(...)`，它使用一般的 IDocumentStore，而不是特定的假 IDocumentSession。

当我更改索引定义类然后运行单元测试时，索引会在“真实”数据库中更新，并且可以通过 Raven Studio 看到更改。但是，“保存”到 InMemory db 的假域实例（`mentor`等`mentee`）并未存储在实际数据库中（如预期的那样），因此无法通过 Raven Studio 看到。

会不会是我对 的调用`UpdateByIndex(...)`是针对不正确的 IDocumentSession 运行的，它是“真实”的（没有保存的域实例），而不是假的？

**编辑 2** - @Simon

我已经针对上面编辑 1 中概述的问题实施了您的修复，我认为我们正在取得进展。`IDocumentStore`你是对的，我使用的是对via 的静态引用`RavenSessionProvder`。现在情况并非如此。下面的代码已更新为使用`Fake.Db()`。

```
public static void SetUserName(IDocumentSession db, User mentor, string userName)
{
    mentor.UserName = userName;
    db.Store(mentor);
    db.SaveChanges();

    const string indexName = "Relationships/ByMentorId";
    db.Advanced.DatabaseCommands.UpdateByIndex(indexName,
                                        new IndexQuery
                                        {
                                                Query = string.Format("MentorId:{0}", mentor.Id)
                                        },
                                        new[]
                                        {
                                                new PatchRequest
                                                {
                                                        Type = PatchCommandType.Modify,
                                                        Name = "Mentor",
                                                        Nested = new[]
                                                                {
                                                                        new PatchRequest
                                                                        {
                                                                                Type = PatchCommandType.Set,
                                                                                Name = "UserName",
                                                                                Value = userName
                                                                        },
                                                                }
                                                }
                                        },
                                        allowStale: false);
}
} 
```

你会注意到我也重置了`allowStale=false`. 现在，当我运行它时，我收到以下错误：

```
Bulk operation cancelled because the index is stale and allowStale is false 
```

我认为我们已经解决了第一个问题，现在我使用了正确的 Fake.Db，我们遇到了首先突出显示的问题，即索引过时，因为我们在单元测试中运行速度超快。

现在的问题是：如何让`UpdateByIndex(..)`方法等到 command-Q 为空并且索引被认为是“新鲜的”？

**编辑 3**

考虑到防止过时索引的建议，我将代码更新如下：

```
public static void SetUserName(IDocumentSession db, User mentor, string userName)
{
    mentor.UserName = userName;
    db.Store(mentor);
    db.SaveChanges();

    const string indexName = "Relationships/ByMentorId";

    // 1\. This forces the index to be non-stale
    var dummy = db.Query<Relationship>(indexName)
            .Customize(x => x.WaitForNonStaleResultsAsOfLastWrite())
            .ToArray();

    //2\. This tests the index to ensure it is returning the correct instance
    var query = new IndexQuery {Query = "MentorId:" + mentor.Id};
    var queryResults = db.Advanced.DatabaseCommands.Query(indexName, query, null).Results.ToArray();

    //3\. This appears to do nothing
    db.Advanced.DatabaseCommands.UpdateByIndex(indexName, query,
        new[]
        {
                new PatchRequest
                {
                        Type = PatchCommandType.Modify,
                        Name = "Mentor",
                        Nested = new[]
                                {
                                        new PatchRequest
                                        {
                                                Type = PatchCommandType.Set,
                                                Name = "UserName",
                                                Value = userName
                                        },
                                }
                }
        },
        allowStale: false);
} 
```

从上面编号的评论中：

1.  放入一个虚拟查询以强制索引等到它不是陈旧的作品。消除了有关过时索引的错误。

2.  这是一条测试线，以确保我的索引正常工作。看来没问题。返回的结果是提供的 Mentor.Id ('users-1') 的正确关系实例。

    { "Mentor": { "Id": "users-1", "UserName": "Mr. Mentor" }, "Mentee": { "Id": "users-2", "UserName": "Mr. Mentee " } ... }

3.  尽管索引不是陈旧的并且看似正常运行，但实际的补丁请求似乎什么也没做。Mentor 的非规范化参考中的用户名保持不变。

所以怀疑现在落在了补丁请求本身上。为什么这不起作用？这可能是我设置要更新的 UserName 属性值的方式吗？

```
...
new PatchRequest
{
        Type = PatchCommandType.Set,
        Name = "UserName",
        Value = userName
}
... 
```

您会注意到，我只是将`userName`参数的字符串值直接分配给类型为 的`Value`属性`RavenJToken`。这可能是一个问题吗？

**编辑 4**

极好的！我们有一个解决方案。我已经修改了我的代码，以允许你们提供的所有新信息（谢谢）。以防万一有人真正读到这里，我最好放入工作代码以关闭它们：

*单元测试*

```
[Fact]
public void Should_update_denormalized_reference_when_mentor_username_is_changed()
{
    const string userName = "updated-mentor-username";
    string mentorId; 
    string menteeId;
    string relationshipId;

    using (var db = Fake.Db())
    {
        mentorId = Fake.Mentor(db).Id;
        menteeId = Fake.Mentee(db).Id;
        relationshipId = Fake.Relationship(db, mentorId, menteeId).Id;
        MentorService.SetUserName(db, mentorId, userName);
    }

    using (var db = Fake.Db(deleteAllDocuments:false))
    {
        var relationship = db
                .Include("Mentor.Id")
                .Load<Relationship>(relationshipId);

        relationship.ShouldNotBe(null);
        relationship.Mentor.ShouldNotBe(null);
        relationship.Mentor.Id.ShouldBe(mentorId);
        relationship.Mentor.UserName.ShouldBe(userName);

        var mentor = db.Load<User>(mentorId);
        mentor.ShouldNotBe(null);
        mentor.UserName.ShouldBe(userName);
    }
} 
```

*假货*

```
public static IDocumentSession Db(bool deleteAllDocuments = true)
{
    var db = InMemoryRavenSessionProvider.GetSession();
    if (deleteAllDocuments)
    {
        db.Advanced.DatabaseCommands.DeleteByIndex("AllDocuments", new IndexQuery(), true);
    }
    return db;
}

public static User Mentor(IDocumentSession db = null)
{
    var mentor = MentorService.NewMentor("Mr. Mentor", "mentor@email.com", "pwd-mentor");
    if (db != null)
    {
        db.Store(mentor);
        db.SaveChanges();
    }
    return mentor;
}

public static User Mentee(IDocumentSession db = null)
{
    var mentee = MenteeService.NewMentee("Mr. Mentee", "mentee@email.com", "pwd-mentee");
    if (db != null)
    {
        db.Store(mentee);
        db.SaveChanges();
    }
    return mentee;
}

public static Relationship Relationship(IDocumentSession db, string mentorId, string menteeId)
{
    var relationship = RelationshipService.CreateRelationship(db.Load<User>(mentorId), db.Load<User>(menteeId));
    db.Store(relationship);
    db.SaveChanges();
    return relationship;
} 
```

*用于单元测试的 Raven 会话提供程序*

```
public class InMemoryRavenSessionProvider : IRavenSessionProvider
{
    private static IDocumentStore documentStore;

    public static IDocumentStore DocumentStore { get { return (documentStore ?? (documentStore = CreateDocumentStore())); } }

    private static IDocumentStore CreateDocumentStore()
    {
        var store = new EmbeddableDocumentStore
            {
                RunInMemory = true,
                Conventions = new DocumentConvention
                    {
                            DefaultQueryingConsistency = ConsistencyOptions.QueryYourWrites,
                            IdentityPartsSeparator = "-"
                    }
            };
        store.Initialize();
        IndexCreation.CreateIndexes(typeof (RavenIndexes).Assembly, store);
        return store;
    }

    public IDocumentSession GetSession()
    {
        return DocumentStore.OpenSession();
    }
} 
```

*索引*

```
public class RavenIndexes
{
    public class Relationships_ByMentorId : AbstractIndexCreationTask<Relationship>
    {
        public Relationships_ByMentorId()
        {
            Map = relationships => from relationship in relationships
                                    select new { Mentor_Id = relationship.Mentor.Id };
        }
    }

    public class AllDocuments : AbstractIndexCreationTask<Relationship>
    {
        public AllDocuments()
        {
            Map = documents => documents.Select(entity => new {});
        }
    }
} 
```

*更新非规范化参考*

```
public static void SetUserName(IDocumentSession db, string mentorId, string userName)
{
    var mentor = db.Load<User>(mentorId);
    mentor.UserName = userName;
    db.Store(mentor);
    db.SaveChanges();

    //Don't want this is production code
    db.Query<Relationship>(indexGetRelationshipsByMentorId)
            .Customize(x => x.WaitForNonStaleResultsAsOfLastWrite())
            .ToArray();

    db.Advanced.DatabaseCommands.UpdateByIndex(
            indexGetRelationshipsByMentorId,
            GetQuery(mentorId),
            GetPatch(userName),
            allowStale: false
            );
}

private static IndexQuery GetQuery(string mentorId)
{
    return new IndexQuery {Query = "Mentor_Id:" + mentorId};
}

private static PatchRequest[] GetPatch(string userName)
{
    return new[]
            {
                    new PatchRequest
                    {
                            Type = PatchCommandType.Modify,
                            Name = "Mentor",
                            Nested = new[]
                                    {
                                            new PatchRequest
                                            {
                                                    Type = PatchCommandType.Set,
                                                    Name = "UserName",
                                                    Value = userName
                                            },
                                    }
                    }
            };
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:08:56.043

尝试更改您的线路：

```
RavenSessionProvider.UpdateByIndex(indexName,  //etc 
```

到

```
db.Advanced.DatabaseCommands.UpdateByIndex(indexName,  //etc 
```

这将确保在您在单元测试中使用的同一（假）文档存储上发出更新命令。

**编辑2的答案：**

使用 UpdateByIndex 时，没有自动等待非陈旧结果的方法。您的`SetUserName`方法有几个选择：

1 - 将您的数据存储更改为始终像这样立即更新索引（注意：这可能会对性能产生不利影响）：

```
store.Conventions.DefaultQueryingConsistency = ConsistencyOptions.MonotonicRead; 
```

2 - 在 UpdateByIndex 调用之前对您的索引运行查询，指定`WaitForNonStaleResults`选项：

```
var dummy = session.Query<Relationship>("Relationships_ByMentorId")
.Customize(x => x.WaitForNonStaleResultsAsOfLastWrite())
.ToArray(); 
```

3 - 当索引陈旧时捕获异常抛出，执行并重`Thread.Sleep(100)`试。

**编辑3的答案：**

我终于想通了，并且通过了测试……不敢相信，但这似乎只是一个缓存问题。当您重新加载文档以进行断言时，您需要使用不同的会话...例如

```
using (var db = Fake.Db())
{
    const string userName = "updated-mentor-username";
    var mentor = Fake.Mentor(db);
    var mentee = Fake.Mentee(db);
    var relationship = Fake.Relationship(mentor, mentee, db);
    db.Store(mentor);
    db.Store(mentee);
    db.Store(relationship);
    db.SaveChanges();

    MentorService.SetUserName(db, mentor, userName);
}

using (var db = Fake.Db())
{
    relationship = db
        .Include("Mentor.Id")
        .Load<Relationship>(relationship.Id);
    //etc...
} 
```

不敢相信我没有早点发现这个，对不起。

# ios - iOS - Inapp 购买 - 处理崩溃

> ID：10298397
> 
> 赞同：0
> 
> 时间：2012-04-24T13:02:00.857
> 
> 标签：ios, in-app-purchase

我成功地在我的应用程序中集成了应用内购买。但我带着疑问离开，并寻找如何处理这种情况。
当用户发起应用内购买时，提供他的身份验证详细信息。但由于某种原因，在我处理 finishedTransaction 方法并解锁应用程序中的功能之前，应用程序崩溃了。
下次启动应用时，如何知道购买是否成功？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:21:08.870

我不认为你可以。

但是如果用户已经购买，并且苹果收到了付款，用户可以随时恢复他的购买。当你按下支付按钮（或你编程的）它会说：你已经购买了这个项目，你想恢复这个购买吗？

如果恢复，finishedTransaction 将被调用。

您不必再次付款。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:28:11.503

仅从中`finishTransaction`删除事务`paymentsQueue`。**因此，如果在此之前**发生崩溃，付款**将停留在队列**中，并且下次用户启动应用程序时，将要求他输入密码，您将能够再次进行购买。

但是如果在调用后发生崩溃`finishTransaction`，在您提供内容之前，用户会注意到未提供不提供，因此他将能够按下**恢复**按钮。或者您可以在完成交易后自己**标记**并检查您是否提供了什么你应该提供的。

# internationalization - Kohana 3.2 中的自定义 i18n 错误消息

> ID：10298400
> 
> 赞同：1
> 
> 时间：2012-04-24T13:02:11.537
> 
> 标签：internationalization, kohana, kohana-3.2

我了解在 Kohana 3.2 中创建自定义错误消息的方式：[Kohana 3.2：自定义验证规则的自定义错误消息？](https://stackoverflow.com/questions/9591990/kohana-3-2-custom-error-message-for-a-custom-validation-rule)

我的问题是重复太多，因为我需要一个单独的文件用于用户模型、帖子模型等。

在大多数情况下，有什么方法可以使用我自己的错误消息吗？我想将它们与 i18n 一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T18:51:04.270

您可以在 application/messages/validate.php 中为每个验证规则设置默认错误消息：

```
<?php
return array(
    'not_empty' => 'Field is empty',
    'Custom_Class::custom_method' => 'Some error'
); 
```

对于以下示例，这将返回消息“字段为空”：

```
$post_values = array('title'=>'');

$validation = Validate::factory($post_values)
    ->rules('title', array(
            'not_empty'=>NULL) );

if($validation->check()){
    // save validated values
    $post = ORM::factory('post');
    $post->values($validation);
    $post->save();
}
else{
    $errors = $validation->errors(true);
} 
```

您还可以通过在 application/classes/validate.php 中扩展它来更改默认 Validate 类的行为：

```
class Validate extends Kohana_Validate
{
    public function errors($file = NULL, $translate = TRUE)
    {
        // default behavior
        if($file){
            return parent::errors($file, $translate);
        }

        // Custom behaviour
        // Create a new message list
        $messages = array();

        foreach ($this->_errors as $field => $set)
        {
            // search somewhere for your message
            list($error, $params) = $set;
            $message = Kohana::message($file, "{$field}.{$error}");
        }
        $messages[$field] = $message;
    }
    return $messages;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T10:37:11.687

消息国际化的方法是这样的：在你的消息文件中用翻译调用替换实际的英文文本，如下所示。

```
return array
( 
    'code' => array(
        'not_empty'    => __('code.not_empty'),
        'not_found'    => __('code.not_found'),
    ),
); 
```

然后像往常一样通过 i18n 文件夹中的文件条目处理翻译，例如：

```
'code.not_empty'  => 'Please enter your invitation code!', 
```

当然，根据您的自定义验证规则调整上述内容。

# linq-to-sql - Linq to sql Connection（存储过程）抛出转换异常

> ID：10298402
> 
> 赞同：0
> 
> 时间：2012-04-24T13:02:14.533
> 
> 标签：linq-to-sql, asp.net-4.0

我需要通过 linq 操作执行存储过程来访问数据。请看下面我的代码。告诉我哪里出错了。

```
public int ID { get; set; }
public string CategoryName { get; set; }

public static void GetCategory()
{
    string connectionString = ConfigurationManager.ConnectionStrings["MyDB"].ConnectionString;
    var query = "EXEC SP_GET_ALL_CATEGORY"; // my stored procedure which is in SQL server
    using (DataContext dc = new DataContext(connectionString))
    {
        if (dc.DatabaseExists())
        {
            var _vGetCategory = dc.ExecuteQuery<category>(string.Format(query, 1, "null")).ToList(); // execution should only through Stored Procedures

            for (int i = 0; i < _vGetCategory.Count; i++)
            {
                string _strName = _vGetCategory[i].CategoryName;
            }
        }
    } 
```

我的例外：

```
 System.InvalidCastException was unhandled by user code
  Message=Specified cast is not valid.
  Source=System.Data
  StackTrace:
       at System.Data.SqlClient.SqlBuffer.get_Int32()
       at System.Data.SqlClient.SqlDataReader.GetInt32(Int32 i)
       at Read_category(ObjectMaterializer`1 )
       at System.Data.Linq.SqlClient.ObjectReaderCompiler.ObjectReader`2.MoveNext()
       at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
       at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
       at category.GetCategory() in d:\Shankar\sample\LinqtoSql\App_Code\category.cs:line 28
       at _Default.Page_Load(Object sender, EventArgs e) in d:\Shankar\sample\LinqtoSql\Default.aspx.cs:line 8
       at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e)
       at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e)
       at System.Web.UI.Control.OnLoad(EventArgs e)
       at System.Web.UI.Control.LoadRecursive()
       at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
  InnerException: 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:05:15.860

它似乎无法将作为类别返回的数据转换为 Int32。是否有可能返回一个空值？或者是 Int32 的最小值/最大值之外的值？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:32:58.910

将**Int64**用于在数据列中声明的**Bigint**数据类型......它适用于我......

# android - RadioGroup 中带有 TextView 的 RadioButtons

> ID：10298409
> 
> 赞同：9
> 
> 时间：2012-04-24T13:02:58.157
> 
> 标签：android, textview, radio-button, radio-group

除了扩展和创建我的自定义 RadioButton 之外，是否可以在 RadioGroup 中的 RadioButton 下方添加 TextView？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T13:24:02.943

是的，有可能。见下文：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <RadioGroup
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <RadioButton
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="btn1" />

        <RadioButton
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="btn2" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="sample text" />

    </RadioGroup>

</LinearLayout> 
```

**样本输出**：

![在此处输入图像描述](../Images/2360c4e26a85be77e7ed22009884c728.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:21:16.647

您可以从 XML 中删除 RadioGroup 并一一添加单选按钮。看这个：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

  <RadioButton
    android:id="@+id/radioButton1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/radioGroup1"
    android:text="RadioButton" />

  <TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/radioButton1"
    android:text="Large Text"
    android:textAppearance="?android:attr/textAppearanceLarge" />

  <RadioButton
    android:id="@+id/radioButton2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/textView1"
    android:layout_below="@+id/textView1"
    android:text="RadioButton" />
</RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T15:02:34.600

我认为您可以使用另一个棘手的解决方案。在两个带有填充或边距的单选按钮之间创建一个间隙，然后将 textView 放在间隙上。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
     android:layout_height="fill_parent" >

<RadioGroup
    android:id="@+id/radioGroup1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="78dp" >

    <RadioButton
        android:id="@+id/radio0"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:checked="true"
        android:text="RadioButton" 
        android:layout_marginBottom="100dp"/>

    <RadioButton
        android:id="@+id/radio1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="RadioButton" 
        android:layout_marginBottom="100dp"/>

    <RadioButton
        android:id="@+id/radio2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="RadioButton" />

</RadioGroup>

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/radioGroup1"
    android:layout_centerHorizontal="true"
    android:text="Large Text"
    android:textAppearance="?android:attr/textAppearanceLarge" 
    android:layout_alignParentTop="true"
    android:layout_marginTop="200dp"/>

</RelativeLayout> 
```

![看图片：](../Images/88ba3679ef9d8e7e33886f1de6003a92.png)

# xcode - 无法在 xcode 中加载 sqlite 数据库

> ID：10298410
> 
> 赞同：-1
> 
> 时间：2012-04-24T13:02:58.667
> 
> 标签：xcode, sqlite, path

我已经使用 SqlManager 在 sqlite 中创建了一个简单的数据库，然后我将文件 (Person.sqlite) 复制到了一个简单的 xcode 项目中的资源中，并使用此代码访问数据库，但数据库似乎没有加载。init 中的函数 sqlite3_open 返回 0（一切正常），而 getAllPersons 中的 sqlite3_prepare 返回无法在数据库中找到我的数据库中的表“Persona”，所以我相信问题在于我无法访问真正的数据库。可能是打开的，没有找到数据库，创建一个新的空数据库......那么为什么会发生这种情况？我给出数据库路径的方式不正确？([[NSBundle mainBundle] pathForResource:@"Person" ofType:@"sqlite"];) 确实，定义路径 (sqLiteDb) 的变量上的 nslog 返回 null，但我尝试了其他几种方法来调用此路径，但都是错误的。

```
- (id)init
{
    self = [super init];
    if (self) {
        NSString *sqlLiteDb = [[NSBundle mainBundle] pathForResource:@"Persone" ofType:@"sqlite"];
        NSLog(@"Path db: %@",sqlLiteDb);
        if(sqlite3_open([sqlLiteDb UTF8String], &database) != SQLITE_OK){
            NSLog(@"Failed to open database");
        }else {
            NSLog(@"Database opened");
        }
    }

    return self;
}

- (NSArray *) getAllPersons{
    NSMutableArray *returnArray=[[NSMutableArray alloc] init];
    NSString *query= @"SELECT Nome FROM Persona";    
    sqlite3_stmt *statement;
    NSLog(@"%d", sqlite3_prepare_v2(database, [query UTF8String], -1, &statement, NULL));
    printf( "could not prepare statemnt: %s\n", sqlite3_errmsg(database) );

    if (sqlite3_prepare_v2(database, [query UTF8String], -1, &statement, NULL) == SQLITE_OK){
        NSLog(@"kndvnspò");
       while (sqlite3_step(statement)==SQLITE_ROW) {
            int uniqueId = sqlite3_column_int(statement, 0);
            char *nomeChar =(char *) sqlite3_column_text(statement, 1);
            char *cognomeChar =(char *) sqlite3_column_text(statement, 2);
            NSString *nome= [[NSString alloc] initWithUTF8String:nomeChar];
            NSString *cognome= [[NSString alloc] initWithUTF8String:cognomeChar];

            PersonInfo *info= [[PersonInfo alloc] initWithUniqueId:uniqueId nome:nome cognome:cognome];
            [returnArray addObject:info];
        }
        sqlite3_finalize(statement);
    }
    return returnArray;

} 
```

抱歉，我相信解决方案很简单，但我仍然不太喜欢 xcode ^^ 谢谢！

更新：不，它一直是“人”。经过两个小时的失败和这个问题的开始，我终于想到“那么，为什么不使用清洁剂？它永远不会起作用，但给它一个机会......”显然，它起作用了...... . -_-' 出于某种原因，该项目只需要一个干净的...谢谢您的帮助，无论如何！

* * *

正如我在更新中所说，出于某种原因，该项目只需要一个干净的......

当然调用准备两次不是一个好主意。抱歉，我发布的代码很脏，仅用于测试。很高兴知道打开可能有权限问题，我会检查一下！非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T20:10:03.490

sqlite 经常因打开数据库文件的权限而失败，并且放置了整个目录文件。

# objective-c - 将 NSMutableDictionary 添加到 NSMutableArray

> ID：10298414
> 
> 赞同：0
> 
> 时间：2012-04-24T13:03:11.777
> 
> 标签：objective-c, ios, parsing

我正在尝试解析通过 URL 获取的 XMLfile，然后解析我的 XML 的每个元素并将其添加到一个名为 objets 的 NSMutableDictionary 中，一切顺利，但是当我尝试将 myMutableDictionnary 添加到 myMutableArray 时没有任何反应...

[myMutableArray count] 返回 0 & [myMutableDictionary count] 返回 3 //这是正确的

这是我声明变量的接口：

```
@protocol XMLParserDelegate;//déclaration du delegate

@interface XMLParser : NSObject <NSXMLParserDelegate>// on adopte le délégate   NSXMLParserDelegate pour la classe
{
NSXMLParser *monParseur;
NSMutableArray *myMutablArray;

NSMutableDictionary *myMutableDictionary;

NSString *objetCourrant;
NSMutableString *journalCourrant;
NSMutableString *dateCourrant;
NSMutableString *descriptionCourrant;

id<XMLParserDelegate> delegate; //on déclare le délégate sous le nom de delegate
}
-(void)parseXMLByPath:(NSString*)chemin;

@property (nonatomic,retain) NSMutableArray *maTabledeJournals;
@property  (nonatomic,retain) id<XMLParserDelegate> delegate;

@end
@protocol XMLParserDelegate <NSObject>
-(void) parsingIsFinished;
@end 
```

这是我定义解析器的地方：

```
-(void)parserDidStartDocument:(NSXMLParser *)parser
{
 myMutableArray=[[NSMutableArray alloc] init];
NSLog(@"Started");
}
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
{

if (objetCourrant) {
    objetCourrant=nil;
}    
objetCourrant=[elementName copy];

if([elementName isEqualToString:kJournal ])
{
    if(myMutableDictionary)
    {
        myMutableDictionary=nil;
    }
    if(journalCourrant)
    {
        journalCourrant=nil;
    }
    if(dateCourrant)
    {
        dateCourrant=nil;
    }
    if(descriptionCourrant)
    {
        descriptionCourrant=nil;
    }

    myMutableDictionary = [[NSMutableDictionary alloc] init];

    journalCourrant = [[NSMutableString alloc] init];
    dateCourrant = [[NSMutableString  alloc] init];
    descriptionCourrant = [[NSMutableString alloc] init];

    NSLog(@"is parsing...");
}

}
-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
  {

if([elementName isEqualToString:kJournal])
{

    [myMutableDictionary setObject:journalCourrant forKey:kTitre]; NSLog(@"%@",journalCourrant);
    [myMutableDictionary setObject:dateCourrant forKey:kDate];  NSLog(@"%@",dateCourrant);
    [myMutableDictionary setObject:descriptionCourrant forKey:kDescription]; NSLog(@"%@",descriptionCourrant);

    NSLog(@"my dictionary %i",[myMutableDictionary count]);

    [myMutableArray addObject:myMutableDictionary];

    NSLog(@"my array %i",[myMutableArray count]);
}

  } 
```

知道什么可能在这里造成麻烦吗？

解决方案

而不是将 myMutableDictionary 添加到 myMutableArray 中，如下所示：

```
[myMutableArray addObject:myMutableDictionary]; 
```

我做了：

```
[self.myMutableArray addObject:myMutableDictionary]; 
```

现在一切正常。谢谢你们的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:06:15.227

您的代码不起作用的原因是您没有初始化可变数组。

添加

```
myMutableArray = [[NSMutableArray alloc] init]; 
```

初始化变量的地方

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:30:20.707

好吧，我已经阅读了其他答案和评论，看来您仍然遇到问题，使其工作的最基本代码如下：

```
NSMutableArray * myArray = [[NSMutableArray alloc] init];
NSMutableDictionary * myDict = [[NSMutableDictionary alloc] init];
[myArray addObject:myDict];
NSLog(@"Count = %i", [myArray count]); // returns 1 
```

您可以发布`@interface`到您声明 myMutableArray 变量的位置吗？

此外，最好不要在您拥有的同一行上调用两个函数/方法：

```
[myMutableDictionary setObject:journalCourrant forKey:kTitre]; NSLog(@"%@",journalCourrant);
[myMutableDictionary setObject:dateCourrant forKey:kDate];  NSLog(@"%@",dateCourrant);
[myMutableDictionary setObject:descriptionCourrant forKey:kDescription]; NSLog(@"%@",descriptionCourrant); 
```

# eclipse - Eclipse 3.6.0 All In One -> subclipse 未安装

> ID：10298415
> 
> 赞同：0
> 
> 时间：2012-04-24T13:03:13.880
> 
> 标签：eclipse, eclipse-plugin, subclipse, eclipse-pdt

我尝试通过“帮助->安装新软件”安装 subclipse，网址是[http://subclipse.tigris.org/update_1.8.x](http://subclipse.tigris.org/update_1.8.x)，但每次都失败。它显示以下项目

====================================

1.  CollabNet 合并客户端 3.0.8
2.  子剪辑（必需）1.8.8
3.  Mylyn 3.x 的 Subversion 集成（可选）3.0.0
4.  Subversion 客户端适配器（必需）1.8.2
5.  颠覆 JavaHL 1.7.4.1
6.  颠覆修订图

====================================

我一一试了，只能安装以下四个，其他四个都失败了：

1.  Subversion 客户端适配器（必需）1.8.2
2.  颠覆 JavaHL 1.7.4.1

# 我得到的错误之一是：

收集要安装的项目时发生错误会话上下文是：（profile=epp.package.php，phase=org.eclipse.equinox.internal.p2.engine.phases.Collect，operand=，action=）。比较方法违反了它的总合同！

=================================================

我的环境如下：

1.  操作系统：Windows 7 64 位
2.  Eclipse PDT All in one from [http://www.zend.com/en/downloads/thankyou?package=468](http://www.zend.com/en/downloads/thankyou?package=468)
3.  子剪辑 update_1.8.x

有什么我做错了吗？

除了可以安装的 Subversion Client Adapter 1.8.2、Subversion JavaHL 1.7.4.1 之外，我至少还需要 Subclipse 1.8.8 和 CollabNet Merge Client 3.0.8。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T06:15:57.573

我在使用 EGit for Eclipse 时遇到了类似的问题。似乎是由于 OpenJDK JRE7。以下链接对我有用：[https ://bugs.eclipse.org/bugs/show_bug.cgi?id=360057](https://bugs.eclipse.org/bugs/show_bug.cgi?id=360057)

希望它会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:27:46.183

It is hard to tell from your question what the actual problem is. It sounds like it cannot install the Revision Graph plugin? That requires the Eclipse GEF/Draw2D plugin, so maybe you do not have that installed.

The Subclipse Core plugin, Client Adapter, JavaHL and Merge Client should all install on any Eclipse version and they are all you need.

There is no need to install the Mylyn integration unless you use Mylyn and want to integrate it.

The Revision Graph plugin is optional. You will need the GEF plugin installed.

# android - 在活动可见之前设置屏幕方向

> ID：10298417
> 
> 赞同：3
> 
> 时间：2012-04-24T13:03:23.390
> 
> 标签：android, screen, orientation

仔细阅读有关 setRequestedOrientation 的 android 文档，我发现：

*   更改此活动的所需方向。如果 Activity 当前处于前台或以其他方式影响屏幕方向，则屏幕将立即更改（可能导致 Activity 重新启动）。否则，这将在下次活动可见时使用。

“否则，下次活动可见时将使用它。” 听起来很棒 - 只是在活动变得可见之前设置。哎呀。这个在哪里称呼？实际上在 onCreate 之前我们没有对活动的引用。那么如何设置屏幕方向呢？

更新： - 我的想法是直接以所需的方向创建活动。当用户从设置中选择方向时 - 设置屏幕方向和之后开始的所有活动 - 了解所需的方向 / 就像他们使用清单 / 中的值一样。如果我知道所需的方向 - 没有理由创建活动，设置方向并再次创建它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-01-22T13:13:22.040

我正在解决完全相同的情况，即 Activity 方向是已知的并由用户在“设置”中设置，我想以所需的方向启动 Activity。

对我来说，解决方案是锁定 Activity 的方向

安卓：screenOrientation="锁定"

```
 <activity android:name=".SomeActivity"
      android:label="@string/app_name"
      android:screenOrientation="locked"> 
```

和 onCreate() 我调用 setRequestedOrientation()：

再也不用重启了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:45:13.393

将它放在 onCreate 中似乎非常合理。

[http://russenreaktor.wordpress.com/2010/01/03/solved-set-screen-orientation-programmatically/](http://russenreaktor.wordpress.com/2010/01/03/solved-set-screen-orientation-programmatically/)

如果这不起作用，您可以尝试将其放入 onPostCreate(Bundle) 覆盖的方法中。

> protected void onPostCreate (Bundle savedInstanceState)
> 
> 自：API 级别 1 在活动启动完成时调用（在调用 onStart() 和 onRestoreInstanceState(Bundle) 之后）。应用程序一般不会实现此方法；它旨在让系统类在应用程序代码运行后进行最终初始化。
> 
> 派生类必须调用该方法的超类实现。如果他们不这样做，将引发异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-03T21:48:11.280

```
 v.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {
        @Override
        public void onGlobalLayout() {
            v.getViewTreeObserver().removeOnGlobalLayoutListener(this);                // reset
            Screen.Lock(); // lock
        }
    }); 
```

在 onCreate() 结束时

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-24T13:19:10.290

如果您想为活动设置屏幕方向，请使用 AndroidManifest.xml 文件中的此片段：

```
<activity android:screenOrientation="portrait" android:name="MyActivity"></activity> 
```

或者

```
<activity android:screenOrientation="landscape" android:name="MyActivity"></activity> 
```

# android - 如何从活动中添加小部件？安卓

> ID：10298419
> 
> 赞同：0
> 
> 时间：2012-04-24T13:03:37.443
> 
> 标签：android, android-intent, widget

我正在寻找一种在单个 apk 中添加伴随主应用程序的小部件的方法，

我设法通过 AppWidgetManager.ACTION_APPWIDGET_PICK 和意图类显示小部件选择器菜单，但是每当我选择任何小部件时，菜单只是简单地自行关闭，并且小部件没有添加到主屏幕。

为了将小部件从我的应用程序添加到主屏幕，我需要采取哪些步骤？

我的应用程序只是一个普通应用程序，它不是启动器应用程序或主屏幕

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:51:04.350

> 为了将小部件从我的应用程序添加到主屏幕，我需要采取哪些步骤？

用户使用主屏幕执行此操作。你不。您无权将您的应用小部件强加给用户。

# c++ - Windows 的 SetEvent 的确切行为是什么？

> ID：10298420
> 
> 赞同：4
> 
> 时间：2012-04-24T13:03:37.870
> 
> 标签：c++, windows, synchronization

我有一个自动重置事件对象，并且有一个线程在等待它。如果现在我调用 SetEvent，是否可以保证当 SetEvent 返回时事件对象是无信号的？

我有两个以 ABAB-... 方式运行的线程。一旦 A 唤醒 B，A 就会开始等待 B。如果我可以在发出信号后立即等待同一个事件对象，那么……我可以保存一个事件对象。

如果你问我为什么不只使用一个线程，它们是在不同的进程中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:08:05.467

当服务员被释放时，该事件变为无信号状态。不能保证在调用`SetEvent`返回之前服务员会被释放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:14:01.920

一般来说，没有。到那时，另一个线程可能已经发出信号，如果没有线程等待，它将保持设置状态。在只有两个线程的情况下，也许你会没事的。

你为什么还要对这样的“优化”感到厌烦。使用两个事件会更容易调试。

多线程、线程间和进程间通信已经够难了。你不应该增加更多的复杂性。

# php - jQuery AJAX 在带有 htaccess 的模型视图控件中不起作用

> ID：10298426
> 
> 赞同：0
> 
> 时间：2012-04-24T13:03:53.500
> 
> 标签：php, jquery, ajax, .htaccess, cross-domain

我目前正在使用 jQuery ajax，但我遇到了一些意外错误。我使用 firebug 来调试 javascript。在我的控制台中，GET 请求链接是红色的。

我的 jQuery 并不难...

```
$.ajax({
    method: "post",
    url: '/scores/update/' + $(this).val(), <-- could be '/scores/update/1'
    success: function( msg ) {
        $('.feedback').html( msg ).fadeIn();
    }
}); 
```

地图分数/更新并不真正存在。我用 htacces 把链接做成了。index.php?uri=scores/update/1。在此 $_GET['uri'] 进入我的 router.php 之后，这将直接指向以下方法

```
class scores()
{

   public function update($int)
   {

       echo $int;

   }
} 
```

我究竟做错了什么？回声不会发送，我的萤火虫控制台中的链接是红色的。这是跨域错误吗？是我的 htaccess 吗？这让我快疯了。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:19:58.783

我得到了修复，无论如何谢谢大家。

修复：

我有

`<input type="submit" name="score" value="1" class="score button1" />`

和 jquery 希望我有

`<input type="button" name="score" value="1" class="score button1" />`

# php - PHP按外观排序数组

> ID：10298430
> 
> 赞同：0
> 
> 时间：2012-04-24T13:04:08.640
> 
> 标签：php

我有需要按外观排序的数组，因为它们是按照我的意愿手动编写的。请注意，这些值是预期会出现的提示：

```
 $options = array("the array retrieved from some forms");
  $items   = array();
  foreach ($options as $key => $val) {
    switch ($key) {
      case 'three':
        $items[]          = "this should come first";
        $items[]          = "now the second in order";
        $items[]          = "the third";
        $items[]          = "forth";

        switch ($val) {
          case 'a':
          case 'b':
            $items[]       = "fifth";
            $items[]       = "should be six in order";
            break;

          case 'c':
          default:
            $items[]    = "7 in order";
            break;
        }

        break; 
```

…………………………………………………………………………

如您所见，这些值可以是任何值，但我需要的是根据它们的外观分解和显示项目。它的所有手动命令，首先应该打印在顶部。

**预期的：**

```
"this should come first";
"now the second in order";
"the third";
"forth";
"fifth";
"should be six in order";
"7 in order"; 
```

**当前意外：**

```
"should be six in order";
"forth";
"7 in order";
"the third";
"fifth";
"this should come first";
"now the second in order"; 
```

但我似乎无法从这个[http://www.php.net/manual/en/array.sorting.php](http://www.php.net/manual/en/array.sorting.php)应用任何排序 我怀疑这些 $items 是由我无法重新排序的表单在某处订购的. 我只是有能力从上到下写出我想要的输出和顺序。但是我不能在 $items 中插入键，只是因为我需要自由地重新排序。

我看了一下输出，键没有按预期排序。

非常感谢任何提示。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:12:38.520

似乎完成你的数组的步骤不是你想要的。

也许你可以使用一些技巧来实现你想要的

例如插入“键指针”

```
$ikey = 0;
$options = array("the array retrieved from some forms");
  $items   = array();
  foreach ($options as $key => $val) {
    switch ($key) {
      case 'three':
        $items[$ikey++]          = "this should come first";
        $items[$ikey++]          = "now the second in order";
        $items[$ikey++]          = "the third";
        $items[$ikey++]          = "forth";

        switch ($val) {
          case 'a':
          case 'b':
            $items[$ikey++]       = "fifth";
            $items[$ikey++]       = "should be six in order";
            break;

          case 'c':
          default:
            $items[$ikey++]    = "7 in order";
            break;
        }

        break; 
```

我不确定这是否有帮助，因为您发布了不完整的代码。

> 对不起我的英语，如果有任何错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:09:57.587

php 源代码在我们看来的方式与编译器不同。所以不可能那样做。但是，如果您在源代码上运行正则表达式，则有可能（不是很好）。

例子：

```
$source = file_get_contents(__FILE__);
preg_match_all('#\$items\[\]\s*=\s*"([^"]+)"#', $source, $match);
// now $match[1] contains the strings.
$strings = $match[1]; 
```

# iis - localhsot 上完全受信任的 SSL

> ID：10298432
> 
> 赞同：0
> 
> 时间：2012-04-24T13:04:09.497
> 
> 标签：iis, ssl

我正在编写一个由第三方工具使用的 Web 服务。该工具仅在完全受信任的 SSL 上接受服务。我尝试使用[Makecert.exe创建](http://msdn.microsoft.com/en-us/library/bfsktky3%28v=vs.80%29.aspx)[https://localhost](https://localhost) ，但问题是使用它创建的 ssl 不完全受信任，因此第三方工具不接受它。有什么方法可以在我的开发环境中创建一个完全受信任的 SSL 网站进行测试。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:15:22.790

没有预信任的 CA 会向 颁发证书`localhost`，因为它是每个人的本地主机名。

您需要将该证书显式导入您的客户端工具。如何完成将取决于此客户端工具使用的内容。您可以首先在 Windows 中的受信任根权限列表中导入证书（而不是私钥）。

# java - 活动开始方法错过了第一个事件

> ID：10298437
> 
> 赞同：0
> 
> 时间：2012-04-24T13:04:55.873
> 
> 标签：java, gwt

我有一个活动需要另一个类的服务来检索一些数据（“DataClass”）。可以调用此数据类来获取数据，并在成功时触发一个事件。该活动第一次需要数据时处于“开始”状态 - 解决当前位置带来的状态并相应地更新视图。

问题是活动 onDataEvent 方法不是第一次调用，而是在所有后续事件中调用。我检查了事件的处理程序。在第一个事件被触发时，该活动将注册到该事件中。我还尝试使用构造函数注册事件，但这没有任何改变。那么如何在 start 方法中为一个事件注册一个活动，触发并做出反应呢？或者如何普遍实现这样的用例。

**同时编辑** 我试图在[这里](http://code.google.com/searchframe#T04cSGC7sWI/trunk/samples/mobilewebapp/src/main/java/com/google/gwt/sample/mobilewebapp/client/activity/TaskActivity.java)实现它，但没有成功。

下面是 start 方法的代码：

```
 @Override
public final void start(final AcceptsOneWidget panel, final com.google.gwt.event.shared.EventBus eventBus) {
    this.eb = new ResettableEventBus(eventBus);
    if (!(pc.getWhere() instanceof DynamicTablePlace)) {
        throw new IllegalStateException(CreateDynamicTableActivity.class.getName() + " should only be called on "
                                        + DynamicTablePlace.class.getName());
    }
    view.setPresenter(this);
    this.eb.addHandler(DynamicTableHashResolvedEvent.TYPE, this);
    stateResolver.resolveState(((DynamicTablePlace) pc.getWhere()).getTablehash(), eb); //this is triggering the event
    panel.setWidget(view);
} 
```

onDynamicTableHashResolved(DynamicTableHashResolvedEvent event) 方法不是第一次调用，而是在所有后续事件中调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T07:07:12.967

在[谷歌群组](https://groups.google.com/forum/?fromgroups#!topic/google-web-toolkit/t1baOC4IfNo)中，有人向我指出了这个问题。我已经偶然发现了这种问题。问题是：如果浏览器处理一些事件（活动开始方法在位置更改事件上调用）并且您在此过程中注册另一个事件并触发刚刚注册的事件它将不起作用 - 注册不是“完成”在此时。解决方案很简单：在我的代码中触发“延迟”事件：

```
 Scheduler.get().scheduleFinally(new ScheduledCommand() {
        @Override
        public void execute() {
            stateResolver.resolveState(((DynamicTablePlace) pc.getWhere()).getTablehash(), eb);

        }
    }); 
```

问题是：这破坏了该活动的测试能力（没有 gwt 测试用例）。

来自[Thomas Broyer](https://groups.google.com/d/msg/google-web-toolkit/ktF5b1jLxtY/OG_Gp-MQ7HQJ)：如果调度程序被注入，我可以正常测试，并且提供了一个 StubScheduler 用于测试。在我的例子中，我为调度程序创建了一个模拟，它只执行命令 - 在我的例子中，只有 scheduleFinally(ScheduledCommand cmd) 必须实现。

# visual-studio - 加载从 TFS 服务器检索的项目时，如何解决错误消息“使用源代码管理注册此项目时发生错误”？

> ID：10298445
> 
> 赞同：35
> 
> 时间：2012-04-24T13:05:39.800
> 
> 标签：visual-studio, visual-studio-2010, visual-studio-2012, tfs, ide

完整的错误信息是：

“项目 'my.project.name' 受源代码管理。向源代码管理注册此项目时出错。建议您不要对此项目进行任何更改。”

似乎我可以使错误消息消失，并通过打开 csproj 文件正确加载项目，并删除名称以“scc”开头的所有节点 - 但是，我必须确认要使用解决方案源代码控制设置每次我打开解决方案。

有什么建议么？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-09-22T18:43:36.830

请打开您项目的 *.csproj 文件，然后替换以下标签：

```
<SccProjectName>SAK</SccProjectName>
<SccLocalPath>SAK</SccLocalPath>
<SccAuxPath>SAK</SccAuxPath>
<SccProvider>SAK</SccProvider> 
```

和

```
<SccProjectName>
</SccProjectName>
<SccLocalPath>
</SccLocalPath>
<SccAuxPath>
</SccAuxPath>
<SccProvider>
</SccProvider> 
```

关闭解决方案，关闭 VS，重新打开 VS，然后您的问题将得到解决。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-07T21:08:17.270

问题在于，`*.csproj.user`如果你有源代码控制`*.csproj.vspscc`（在 VS2012 中）。删除两者，关闭解决方案，关闭 VS，使用运行方式（最好是管理员）重新打开 VS，应该没问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-25T07:48:33.567

我会尝试删除 .csproj 文件中以前的源代码管理绑定，然后使用**File->Source Control->Change Source Control...（重新）绑定它...**

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-04-13T08:31:12.183

在 VS2012 中，工具 -> 选项 -> 源代码管理 -> 插件部分。更改当前源代码控制插件。

将项目从 mercurial 转移到 GiT 后，我遇到了同样的问题。我将“当前源代码控制插件”从 Mercucial 更改为 VisualHG（我必须从 Extensions 安装它，因为我在开始时没有此选项）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-24T11:43:02.607

当其他人向解决方案添加项目并且我获得了最新的解决方案时，我遇到了问题。我所做的只是重新启动 Visual Studio。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T12:11:59.943

万一其他人有同样的问题：我们最终解决了这个问题，备份了项目，从解决方案中删除了项目，没有它的情况下将解决方案签入源代码控制，然后再次添加项目。

幸运的是，这是一个新的小项目，历史很少——我不想用一个大的旧项目来做这件事……

如果我在哪里，我可能会先尝试 tbergstedt 的建议。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-22T11:38:55.777

由于上述方法都不适合我，而且我遇到了在其他项目中运行良好的库的问题，因此我有理由认为这是解决方案的问题，而不是单个项目的问题。

对我有用的是在记事本中打开解决方案文件（.sln）（为了安全起见先备份），如果有一个部分：

```
GlobalSection(SourceCodeControl) = preSolution
 ...
EndGlobalSection 
```

然后删除它，保存解决方案并重新打开。为我解决了问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-25T07:46:29.893

以防万一如果您使用其他工具进行源代码管理，例如 Git 和 Mercurial 的源代码树，那么您可以在 VS 中将 Current source control plugin 设置为 None。

*在 VS2015 中，工具 -> 选项 -> 源代码管理 -> 插件部分。将当前源代码控制插件更改为无。*

# java - 在 WCF 客户端的 Java Web 服务（或重用类型）之间共享 DataContract

> ID：10298446
> 
> 赞同：0
> 
> 时间：2012-04-24T13:05:40.157
> 
> 标签：java, wcf, web-services, datacontract, reusability

如何在多个 java web 服务中提供通用数据契约（例如托管在 jboss 上），因此它们将通过在 VS2010 中添加 ServiceReference 生成一次并在 WCF 客户端中重用。

对于 wcf 客户端的 WCF 服务，解决方案很清楚，就像这里写的在 [WCF 服务之间共享 DataContracts](http://www.freddes.se/2010/05/02/sharing-datacontracts-between-wcf-services/)。

如何为 java web 服务解决它？可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T14:44:30.067

您可以尝试 WCF 的合同优先开发。见这篇[文章](http://msdn.microsoft.com/en-us/magazine/ee335699.aspx)。这不是一种流行的方法。您还可以尝试创建 WCF 服务，生成其 WSDL 并使用 java 中的一些工具为 WSDL 生成一个 java 类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T01:53:41.923

推荐的互操作性方法是

*   首先在 XSD 中定义消息格式。
*   在您的 Java Web 服务框架中生成代码
*   并生成用于 .NET 的类

XSD 允许您“重用类”，但所需的具体步骤将根据您在 Java 端使用的 Web 服务堆栈而有所不同。

对于某些教程，您可以扫描[http://blogs.msdn.com/dotnetinterop](http://blogs.msdn.com/dotnetinterop) - 有关于使用 AXIS2、JAXWS 等的文章。

# ms-access - 计数最喜欢的 ms-access

> ID：10298448
> 
> 赞同：0
> 
> 时间：2012-04-24T13:05:44.953
> 
> 标签：ms-access, count, favorite

我有 3 个现有表：Instructor、Feedback、Class

在反馈表中，2 列

```
Class_ID
Likes 
```

（Class_ID 与出勤率相关，因为每个成员参加 1 堂课，例如 1、2、3 班等，Likes 是为喜欢该班的人数）。

在 Instructor 表中，相关列：

```
Instructor_ID 
```

在类表中，相关列：

```
Class_ID
Instructor_ID 
```

我需要一个查询来报告最喜欢的讲师，即带有 max(likes) 的讲师 ID。

```
Select
Class_ID.Class,
Instructor_ID.Instructor,
Likes.Feedback
WHERE Max(Likes.Feedback) 
```

欢迎提出建议/更正。谢谢

**编辑**

```
Select
Exercise_class_attendance.Class_ID,
Exercise_Instructor.Instructor_ID,
Feedback_FaceBook.Likes,
Max(Likes) FROM Feedback_Facebook AS Highest_Number_Like
GROUP BY Instructor_ID 
```

这是我正在处理的查询，它要求我输入代码中每个元素的参数值。拼写检查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:13:58.133

如果您使用查询设计窗口，它将向您显示问题所在。您不能拥有不属于 GROUP BY 或求和/计数等的字段（列）：

```
Select
Exercise_class_attendance.Class_ID,
Exercise_Instructor.Instructor_ID,
Feedback_FaceBook.Likes,
Max(Likes) AS Highest_Number_Like
FROM Feedback_Facebook, Exercise_class_attendance, Exercise_Instructor
GROUP BY Exercise_Instructor.Instructor_ID, Exercise_class_attendance.Class_ID,
   Feedback_FaceBook.Likes 
```

这**不是**一个很好的查询，它只是一些注释。

如果您阅读别名，您会轻松很多。

# javascript - 如何使用 OpenLayers 从 OSM 获取透明瓷砖

> ID：10298450
> 
> 赞同：2
> 
> 时间：2012-04-24T13:05:58.910
> 
> 标签：javascript, transparency, openlayers, openstreetmap, hybrid

我正在使用 OpenLayers 实现一个简单的基于 Web 的 GIS 应用程序。我想将热图显示为背景图像 - 就像 GoogleMaps 的混合视图一样。这似乎是不可能的——我想要一张漂亮的地图，所以我使用 OSM 层——但图像完全不透明——所以我所能做的就是在这一层之上覆盖一个图像（或任何其他层）——是的，我可以应用一些透明度，但当然，标签会淡出。

似乎没有办法只向 OSM 询问地砖（海洋等），然后插入我的自定义图层，然后在此之上插入一个带有街道、街道名称和所有其他元素的 OSM 图层。

我想，实现这一点的唯一方法是设置我自己的 OSM-TileServer 并相应地配置它？

有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T14:17:21.610

看起来你可以找到没有标签的 osm 瓷砖：http: [//help.openstreetmap.org/questions/1873/how-can-i-create-a-map-without-any-names-on-it](http://help.openstreetmap.org/questions/1873/how-can-i-create-a-map-without-any-names-on-it)

*   示例：[http ://toolserver.org/~osm/locale/en.html?zoom=12&lat=51.51473&lon=-0.13528&layers=BF](http://toolserver.org/~osm/locale/en.html?zoom=12&lat=51.51473&lon=-0.13528&layers=BF)

我不知道任何“仅标签”OSM 瓦片集。（编辑：除非我读得更好，我粘贴的链接；））

我在这里（[https://alastaira.wordpress.com/2011/05/13/displaying-labels-on-top-of-bing-maps-custom-tile-layers/](https://alastaira.wordpress.com/2011/05/13/displaying-labels-on-top-of-bing-maps-custom-tile-layers/)）发现似乎有 2 bing tile 集这将满足您的需求。[我猜想在 OpenLayers ( http://dev.openlayers.org/docs/files/OpenLayers/Layer/Bing-js.html](http://dev.openlayers.org/docs/files/OpenLayers/Layer/Bing-js.html) )中设置它们应该不难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:26:49.437

感谢 tonio 的快速回复！

它现在可以与 OSM 一起使用 - 对于所有感兴趣的人，这是我的解决方案：（MY-MIDDLE-LAYER.KML 是德国地图，红色半透明用于测试目的）

```
var kml = new OpenLayers.Layer.GML("KML", "MY-MIDDLE-LAYER.KML", {
format: OpenLayers.Format.KML,formatOptions:{extractStyles:true,extractAttributes:true},alwaysInRange:true,isBaseLayer: false,opacity:50,transparent:true
});

OpenLayers.Layer.OSM.Toolserver = OpenLayers.Class(OpenLayers.Layer.OSM, {
    initialize: function(name, options) {
        var url = [
            "http://a.www.toolserver.org/tiles/" + name + "/${z}/${x}/${y}.png", 
            "http://b.www.toolserver.org/tiles/" + name + "/${z}/${x}/${y}.png", 
            "http://c.www.toolserver.org/tiles/" + name + "/${z}/${x}/${y}.png",
            "http://d.www.toolserver.org/tiles/" + name + "/${z}/${x}/${y}.png",
            "http://e.www.toolserver.org/tiles/" + name + "/${z}/${x}/${y}.png",
            "http://f.www.toolserver.org/tiles/" + name + "/${z}/${x}/${y}.png"
        ];
        options = OpenLayers.Util.extend({numZoomLevels: 19}, options);
        OpenLayers.Layer.OSM.prototype.initialize.apply(this, [name, url, options]);
    },
    CLASS_NAME: "OpenLayers.Layer.OSM.Toolserver"
});
l1=new OpenLayers.Layer.OSM.Toolserver('osm-labels-de', {isBaseLayer: false, visibility: true});
l2=new OpenLayers.Layer.OSM.Toolserver('osm-no-labels');
map.addLayers([kml,l1,l2]); 
```

...并且标签在所有内容之上都非常易读:)

# c# - OpenXML Word 封面页和样式 C#

> ID：10298451
> 
> 赞同：1
> 
> 时间：2012-04-24T13:06:03.423
> 
> 标签：c#, ms-word, styles, openxml, cover

我正在开发一个库来帮助创建 word 文档，并且有几件事似乎并不清楚（反复试验通常是一个很好的起点，但时间在这里至关重要）。

首先，我想插入一个封面，一个已经内置在 word 中的页面……有没有办法做到这一点？

其次，我的word文档有一套样式，它是内置样式之一……现代。有没有办法将这种样式分配给文档？

有很多为文档的标题和部分分配样式的示例，但没有说从内置样式中选择样式。

我很感激在这一点上，拥有一个已经设置了所有这些的文档可能会更容易，但我想从头开始做所有这些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:56:17.753

我一直在 VSTO 项目中做这些事情，因为我可以访问 Word 对象模型，所以这很简单。

1.  封面页存储在构建基块中，因此它类似于在 Word 中添加任何构建基块。这是一个使用 Word 对象模型的[示例](http://msdn.microsoft.com/en-us/library/bb457184%28v=office.12%29.aspx)。

[在这里](http://social.msdn.microsoft.com/Forums/en-US/oxmlsdk/thread/19032efe-80af-4a16-b954-1f5a6d2f2236#x_Q27)发现您无法使用 open xml sdk 插入构建块

1.  [ApplyQuickStyleSet2](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.word.document.applyquickstyleset2.aspx)将为活动文档应用快速样式集。在 OpenXmlSdk 中不确定，但试试[这个](http://msdn.microsoft.com/en-us/library/documentformat.openxml.office2010.word.styleset.aspx)

2.  例如用于应用[样式](http://msdn.microsoft.com/en-us/library/cc850838.aspx)

# c - 在没有 try-catch 机制的纯 C 上捕获异常

> ID：10298455
> 
> 赞同：2
> 
> 时间：2012-04-24T13:06:25.590
> 
> 标签：c, exception-handling, callback, crash-dumps

出现异常时需要创建转储文件。

不使用`__try{...}`and是否可以这样做`__except(e){...}`？

有没有办法创建回调函数或注册等待系统崩溃的操作？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:08:40.457

是的，您可以使用`signal`为特定信号注册回调，包括异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T14:48:52.043

异常处理的基本功能是在发生错误时将控制权转移给异常处理程序，其中处理程序驻留在当前函数调用层次结构中较高的某个位置。标准 C 有一种机制来实现这一点：setjmp() 和 longjmp()。[这](http://www.on-time.com/ddj0011.htm)是两篇关于 C中异常处理的好文章。如果您使用 Microsoft Visual C，请查看[try-except 语句，](http://msdn.microsoft.com/en-us/library/zazxh1a9%28v=vs.80%29.aspx)[它](http://www.smartango.com/articles/c-language-exception-handling)是 C 语言的扩展，它使应用程序能够在发生通常终止执行的事件时获得对程序的控制.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:16:14.473

如果您想在 C 中实现自己的异常样式处理，则可以使用[setjmp() 和朋友](http://en.wikipedia.org/wiki/Setjmp.h)，但请注意这是黑魔法，如果您不小心的话，这是一种自取其辱的好方法。

对于其他错误，这取决于您所说的“异常”是什么意思。我可以认为您在调用库函数时表示错误（在这种情况下您应该适当地检查返回值）或 SEGV，在这种情况下您将获得一个 SIGSEGV 并且您的进程很快*就会死掉。*您可以编写一个信号处理程序来`backtrace()`为您提供线索，但仅此而已。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T13:10:53.573

程序或系统崩溃通常不在 C 语言的范围内。您必须查看操作系统的设施以检测和处理此类事情（当然这取决于操作系统）。

对于一般意义上的“异常”，旧 C 语言中执行异常处理的典型习惯用法是 with `goto`. 您在 return 语句之后放置一个标签以充当“异常处理程序”，并且任何检测到异常条件`goto`的调用都是该标签。

# javascript - HTML 列表隐藏顶层

> ID：10298456
> 
> 赞同：0
> 
> 时间：2012-04-24T13:06:26.223
> 
> 标签：javascript, html

我有一个这样的清单，

1.  键1
    *   比利时
    *   法国
2.  键2
    *   德国
3.  键3
    *   意大利
    *   美国

我怎样才能只隐藏外部列表（key1，key2，key3）隐藏而不删除，因为排序仅在键上完成。

结果应该是

*   比利时
*   法国
*   德国
*   意大利
*   美国

感谢您的支持

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:14:01.483

这应该可以解决问题：

HTML：

```
<ol>
    <li>Key1
        <ul>
            <li>Belgium</li>
            <li>France</li>
        </ul>
    </li>
    <li>Key2
        <ul>
            <li>Germany</li>
        </ul>
    </li>
    <li>Key3
        <ul>
            <li>Italy</li>
            <li>USA</li>
        </ul>
    </li>
</ol> 
```

JS：

```
$(function() {
    $("ol ul li").each(function() {
        $("ol").append("<li>" + $(this).html() + "</li>");
    });
    $("ol > li:has(ul)").hide();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:10:19.580

以下似乎可以按您的要求工作。

HTML：

```
<ol>
    <li>Key one
        <ul>
            <li>Belgium</li>
            <li>France</li>
        </ul></li>
    <li>Key two
        <ul>
            <li>Germany</li>
        </ul></li>
    <li>Key three
        <ul>
            <li>Italy</li>
            <li>USA</li>
        </ul></li>
</ol>​ 
```

CSS：

```
ol > li {
    font-size: 0;
}

​ol > li li {
    font-size: 16px;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/rXqYB/1/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:23:45.377

试试这个：

```
<ul>
<li>Key one
    <ul>
        <li>Belgium</li>
        <li>France</li>
    </ul></li>
<li>Key two
    <ul>
        <li>Germany</li>
    </ul></li>
<li>Key three
    <ul>
        <li>Italy</li>
        <li>USA</li>
    </ul></li> 
```

​</p>

CSS：

```
ul li {
    text-indent: -3000px;
    display:block;
}
ul li ul li {
    text-indent: 0px;
} 
```

希望它有效，尚未测试...但应该与 text-indent: -3000px;

编辑：更改文本缩进：无；到文本缩进：0px；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T13:28:56.577

作为先前答案的替代方案，如果您有权访问并且可以控制 HTML 的外观，则可以改为创建如下列表：

```
<ul>
    <li sort="Key1">Belgium</li>
    <li sort="Key1">France</li>
    <li sort="Key2">Germany</li>
    <li sort="Key3">Italy</li>
    <li sort="Key3">USA</li>
</ul> 
```

然后，您可以使用自定义`sort`属性而不是外部列表进行排序。

# gwt - GWT (2.4.0) + XSRF

> ID：10298463
> 
> 赞同：3
> 
> 时间：2012-04-24T13:07:00.800
> 
> 标签：gwt, asynchronous, rpc, csrf

我一直试图让 XSRF 在 webapp 上工作但无济于事。我正在研究一个典型的登录实现。

我正在关注[谷歌的代码](https://developers.google.com/web-toolkit/doc/latest/DevGuideSecurityRpcXsrf)。我将 web.xml 更改为包括：

```
<servlet>
    <servlet-name>xsrf</servlet-name>
    <servlet-class>com.google.gwt.user.server.rpc.XsrfTokenServiceServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>xsrf</servlet-name>
    <url-pattern>/gwt/xsrf</url-pattern>
</servlet-mapping>

<context-param>
    <param-name>gwt.xsrf.session_cookie_name</param-name>
    <param-value>JSESSIONID</param-value>
</context-param> 
```

`XsrfProtectedServiceServlet`并在我的登录服务的服务器 Impl 文件上进行了扩展。据我了解，服务器上不需要进行其他更改。我是否需要添加任何其他内容，例如返回`RpcToken`此处的方法（以及在我正在实现的接口中）？

在客户端，我使用注释。

```
@XsrfProtect
@RemoteServiceRelativePath("login")
public interface LoginService extends RemoteService {
    String check(String user, String pass) throws IllegalArgumentExceptionhere;
} 
```

这可能是我遗漏的地方。谷歌在提示中说：`Tip: To specify which RpcToken implementation GWT should generate serializers for use @RpcTokenImplementation annotation.`不确定这意味着什么，或者我是否需要另一种方法来返回 RpcToken。

我的异步接口是这样的：

```
public interface LoginServiceAsync {
    //Returns the Session ID
    void check(String user, String pass, AsyncCallback<String> callback);
} 
```

然后对于我的实际 RPC 调用，我将我的代码包装在 xsrf 令牌请求周围。我使用与谷歌相同的代码：

```
XsrfTokenServiceAsync xsrf = (XsrfTokenServiceAsync)GWT.create(XsrfTokenService.class);
((ServiceDefTarget)xsrf).setServiceEntryPoint(GWT.getModuleBaseURL() + "xsrf");
xsrf.getNewXsrfToken(new AsyncCallback<XsrfToken>() {

    public void onSuccess(XsrfToken token) {
        LoginServiceAsync rpc = (LoginServiceAsync)GWT.create(LoginService.class);
        ((HasRpcToken) rpc).setRpcToken(token);

        // make XSRF protected RPC call
        rpc.check(user, pass, new AsyncCallback<String>() {
            // ...
        });
    }

    public void onFailure(Throwable caught) {
        try {
             throw caught;
        } catch (RpcTokenException e) {
        // Can be thrown for several reasons:
        //   - duplicate session cookie, which may be a sign of a cookie
        //     overwrite attack
        //   - XSRF token cannot be generated because session cookie isn't
        //     present
        } catch (Throwable e) {
        // unexpected
    }
}); 
```

抱怨是我对 getNewXsrfToken 的调用失败，因为它不知道来自此处调用的 xsrf 位置：`GWT.getModuleBaseURL() + "xsrf"`。我感觉缺少导致此错误的令牌握手，但我不确定。

最后，我还尝试实现[Nick Siderakis 的代码](http://code.google.com/p/xsrf-safe/)，但他的示例使用了一个询问服务器的 JSP 页面：`XsrfTokenUtil.getToken(request.getSession().getId())`. 我不想使用 JSP 页面，而且我还没有弄清楚如何在没有 jsp 页面的情况下执行此操作。他的代码也不同于谷歌代码示例（即他不调用 getNewXsrfToken），我不知道这是否是谷歌处理 XSRF 的“首选”方式。

关于我缺少什么的任何想法？谢谢。

**编辑**

下面的解决方案...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T09:07:04.040

好的，我发现了问题。我不得不在上面的代码中将 GWT.getModuleBaseURL() + "xsrf" 更改为 "gwt/xsrf"，因为我怀疑它没有指向正确的位置。另外，服务器找不到 JSESSIONID cookie，所以我跟着[这个](http://code.google.com/p/google-web-toolkit/issues/detail?id=6314)添加了 Cookies.setCookie("JSESSIONID", "JSESSIONID", null, null, "/", false); 在我的 onModuleLoad() 里面。做到了。干杯。

# java - 强制继承链的每个类重写抽象方法

> ID：10298465
> 
> 赞同：3
> 
> 时间：2012-04-24T13:07:05.230
> 
> 标签：java, inheritance

假设我有一个继承链，其中每个类都通过添加一个新字段来扩展其超类，并且我希望该链的每个类都覆盖该`toString()`方法，如下所示：

```
public String toString()
{
    return super.toString() + "[newfield=" + newfield + "]";
} 
```

如果我使用抽象基类，那么当继承链的一个类通过实现抽象方法变得具体时，从那时起所有子类也通过继承已经实现的方法变得具体。

Java 中有没有办法强制*每个*类重写（重新实现）抽象方法，即使它已经在继承链中更高层实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:09:16.583

简短的回答：没有。

长答案：您可以编写一个扫描类路径的单元测试（为此使用[反射](http://code.google.com/p/reflections/)之类的库），加载抽象类的每个子类并使用反射检查方法。但是在编译时没有办法做到这一点。

除了 Java， [AspectJ](http://www.eclipse.org/aspectj/)有一个`hasMethod()`切入点，它可以为您进行检查，但不幸的是，这只对`declare parents`建议有效。也许您可以使用 aspectj 分两步完成：

*   定义一个接口`IllBehaved`。
*   定义一个建议，将此接口分配给从您的基类扩展但没有成员的类
*   然后为实现此接口的所有类型声明编译错误

    ```
    pointcut isSubTypeOfYourClass(): within(com.your.BaseClass+);
    pointcut overridesMethod(): hasmethod(public void yourMethodName(..));
    declare parents: isSubTypeOfYourClass() && !overridesMethod()
                     implements com.yourcompany.IllBehaved;
    declare error: isSubTypeOfYourClass() && within(com.yourcompany.IllBehaved+):
                     "Implementation class must override <Foo> method"; 
    ```

我没有对此进行测试，但是如果您打开该`-XhasMember`选项，它应该可以工作。当您使用 Maven、Ant、Eclipse 等标准工具时，很容易将 aspectj 集成到您的构建中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:08:54.883

不，但你可以让你的类实现一个接口而不是抽象超类。如果类实现了接口，您可以检查编译时间，这取决于您对这些类执行的操作。

# ruby-on-rails - 防止在 rails 3.2 中加载资源

> ID：10298468
> 
> 赞同：0
> 
> 时间：2012-04-24T13:07:23.527
> 
> 标签：ruby-on-rails

在我的应用程序的每个页面中，我都有一个“如何”按钮，它正在打开一个模态 js 视图，其中包含解释当前页面的视频/图片。

我遇到的问题是这个视频/图片在页面加载时被加载。我只想在按下“如何”按钮时加载这些资源。

我该怎么办？

PS。图像/视频由亚马逊 S3 提供。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T11:40:14.800

我认为您需要从页面中删除视频/图片并将其放在自己的视图中。当您单击 howto 按钮时，打开一个空弹出窗口并发出 ajax 请求以从控制器中获取 howto 图片/视频。然后将 ajax 请求（图片和视频）的答案附加到 javascript 弹出窗口中。这样，只有在您按下 howto 按钮时才会加载图片。我建议制作一个新的“howto”控制器。

# javascript - 如何用javascript完成标签中的href

> ID：10298473
> 
> 赞同：-1
> 
> 时间：2012-04-24T13:07:38.790
> 
> 标签：javascript, html, css, anchor, href

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:16:55.883

更改`onclick="geo()"`为`onclick="geo(this)"`

更改`function geo()`为`function geo(obj)`

将 userPosition 的警报替换为：

```
obj.setAttribute('href', 'http://maps.google.com/maps?  daddr=~ITEM.STREET~,+~ITEM.CITY~&saddr=' + position.coords.latitude +  ',' + position.coords.longitude); 
```

您必须对此进行调整以匹配 Google 地图格式。我不确定他们想要的地址是什么，但我很确定在这种情况下您指定的是街道地址，而不是纬度/经度组合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:15:11.390

我会存储整个网址并替换整个内容。

```
var url = "google.com/maps?etc";
var newval = "google.com/maps?etc&ll"+long+","+lat;
element.href = newval; 
```

# javascript - 更新/删除传播到不同节点的文本

> ID：10298476
> 
> 赞同：2
> 
> 时间：2012-04-24T13:07:42.953
> 
> 标签：javascript

标题可能看起来不言自明，但问题实际上很简单。想象一下下面的代码：

```
<div class="line">
    Some text node here. <span>Some nodeType 3 here.</span> 
    More text here. <span>And here as well.</span>
</div> 
```

现在，使用 javascript 我想删除 div 的内容。所以像：

```
function deleteContent(from, to) { 
    // Some code to execute here
} 
```

结果将是这样的：

```
<div class="line">
    Some text node here. <span>Some nodeType</span>
</div> 
```

所以基本上，从理论上讲，它就像使用`slice`函数一样`div.innerHTML.slice(from, to)`，只是这只有在 div 中没有标签时才有效。我已经考虑过创建一个文本范围并使用 deleteContent 删除内容，但我不知道这是否是最简单的方法。你有什么建议？

PS：我想要一个整洁且合乎逻辑的代码。

**编辑**

作为对 Felix 的回应：是的，我将 from 和 to 视为两个整数。对于空格，在我的应用程序中，我必须分别理解每个空格。也就是说，`&nbsp;&nbsp;`是两个字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T14:05:34.323

我正在为我的[Rangy](http://code.google.com/p/rangy)库做这个，我几乎准备好发布它了。同时，您可以使用以下在大多数情况下都可以使用但有缺点的东西：

*   在 IE < 9 中不起作用
*   不考虑块元素和`<br>`s 的隐式换行符
*   不会忽略不可见的文本，例如元素的内容或 CSS设置为`<script>`的`<style>`元素内的文本`display``none`
*   不会折叠空间，因为它们会出现在呈现的页面上
*   其他细微之处

现场演示：http: [//jsfiddle.net/nT28h/](http://jsfiddle.net/nT28h/)

代码：

```
function createRangeFromCharacterIndices(containerEl, start, end) {
    var charIndex = 0, range = document.createRange(), foundStart = false, stop = {};
    range.setStart(containerEl, 0);
    range.collapse(true);

    function traverseTextNodes(node) {
        if (node.nodeType == 3) {
            var nextCharIndex = charIndex + node.length;
            if (!foundStart && start >= charIndex && start <= nextCharIndex) {
                range.setStart(node, start - charIndex);
                foundStart = true;
            }
            if (foundStart && end >= charIndex && end <= nextCharIndex) {
                range.setEnd(node, end - charIndex);
                throw stop;
            }
            charIndex = nextCharIndex;
        } else {
            for (var i = 0, len = node.childNodes.length; i < len; ++i) {
                traverseTextNodes(node.childNodes[i]);
            }
        }
    }

    try {
        traverseTextNodes(containerEl);
    } catch (ex) {
        if (ex == stop) {
            return range;
        } else {
            throw ex;
        }
    }
}

function deleteBetweenCharacterIndices(el, from, to) {
    var range = createRangeFromCharacterIndices(el, from, to);
    range.deleteContents();
} 
```

# java - getLocalAddress() 返回 0.0.0.0

> ID：10298480
> 
> 赞同：6
> 
> 时间：2012-04-24T13:08:01.483
> 
> 标签：java, sockets, udp

我正在尝试使用 Sockets 编写程序，我需要获取自己的本地 IP 地址。

当我在套接字中使用 getLocalAddress 时，我只得到 0.0.0.0。

这是我的一小段代码：

```
DatagramSocket socket;
DatagramPacket pacoteEnvio = new DatagramPacket(msgByte, msgByte.length, addr, 6500);
socket = new DatagramSocket();
System.out.println("Local address = " + socket.getLocalAddress());
socket.send(pacoteEnvio); 
```

你有什么主意吗？

我正在使用 UDP，所以我不确定我是否可以通过这种方式获取我的 IP，因为它是无连接的，但我认为你可以帮助我！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T13:57:06.463

使用这样的机制获取本地地址通常不会以您期望的方式工作。一个系统通常至少有两个地址 - `127.0.0.1`and `ip address of nic`，当你绑定到一个地址进行监听时，你绑定到的是 INADDR_ANY，这与绑定到**and**`0.0.0.0`的地址相同。考虑一台带有有线和无线网卡的笔记本电脑——它们中的一个或两个可以同时连接。在这种情况下，哪个会被视为系统的 IP 地址？`127.0.0.1` **`ip address of nic`**

 **我窃取了[枚举所有已启用 NIC 卡的 ip 地址](https://stackoverflow.com/questions/494465/how-to-enumerate-ip-addresses-of-all-enabled-nic-cards-from-java)的答案的子集，它处理所有 NIC 的地址，其中列出了所有接口的 IP 地址，在我的系统上我有 10 个接口，所以我最终有很多IP地址。

```
try {
  System.out.println("Full list of Network Interfaces:");
  for (Enumeration<NetworkInterface> en = NetworkInterface.getNetworkInterfaces(); en.hasMoreElements();) {
      NetworkInterface intf = en.nextElement();
      System.out.println("    " + intf.getName() + " " + intf.getDisplayName());
      for (Enumeration<InetAddress> enumIpAddr = intf.getInetAddresses(); enumIpAddr.hasMoreElements(); ) {
          System.out.println("        " + enumIpAddr.nextElement().toString());
      }
  }
} catch (SocketException e) {
  System.out.println(" (error retrieving network interface list)");
} 
```

一般来说，如果你是服务器编程，当你在 UDP 服务上接收到一个数据包时，它包含发送者的 IP 地址，你只需将响应发送到该地址，并且计算机足够聪明，可以将它从正确的网络接口发送出去.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-12-10T21:40:45.657

我正在做一个类似的项目——一个贝尔福德人客户项目。我一开始尝试了你的方式，也得到了 0.0.0.0。然后我通过使用 InetAddress 的方法将地址输出为字符串来解决这个问题 - 不涉及数据报套接字。

```
String localIP = InetAddress.getLocalHost().getHostAddress();
System.out.println(localIP); 
```

我显示了我的内部 IP - 分配给我的路由器的 IP。这对我来说已经足够了。希望这可以帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-24T13:12:55.863

你可以试试 ：

> InetAddress ip = InetAddress.getLocalHost();

[http://docs.oracle.com/javase/1.4.2/docs/api/java/net/DatagramSocket.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/DatagramSocket.html)

> 公共 DatagramSocket（int 端口，InetAddress laddr）抛出 SocketException
> 
> 创建一个数据报套接字，绑定到指定的本地地址。本地端口必须介于 0 和 65535 之间（含）。如果 IP 地址为 0.0.0.0，则套接字将绑定到通配符地址，即内核选择的 IP 地址。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T15:17:19.650

javadoc for[`DatagramSocket.getLocalAddress()`](http://docs.oracle.com/javase/7/docs/api/java/net/DatagramSocket.html#getLocalAddress%28%29)说这个

> 返回 - 套接字绑定到的本地地址（`null`如果套接字已关闭），或者`InetAddress`表示通配符地址（如果套接字未绑定或安全管理器`checkConnect`方法不允许该操作）。

如果您`DatagramSocket`使用无参数构造函数创建一个，您将获得一个未绑定的套接字，因此（根据 javadoc）`getLocalAddress()`应该返回通配符 IP 地址`0.0.0.0`。它确实如此。

通过阅读文档可以学到的东西令人惊讶:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T13:19:05.080

虽然 DatagramSocket 没有连接，但它没有绑定本地机器上的任何端口，所以它的 IP 是 0.0.0.0 。尝试与之建立联系`socket.connect(SocketAddress addr)`，然后您将获得正确的结果。方法后您将获得相同的 0.0.0.0 ip 地址`socket.disconnect()`。**

# spring - Spring和休眠：没有为当前线程找到会话

> ID：10298483
> 
> 赞同：25
> 
> 时间：2012-04-24T13:08:08.587
> 
> 标签：spring, hibernate, sessionfactory

我得到以下错误

```
org.hibernate.HibernateException: No Session found for current thread
at org.springframework.orm.hibernate4.SpringSessionContext.currentSession(SpringSessionContext.java:97)
at org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFactoryImpl.java:1024)
at com.fexco.shoptaxfreemobile.service.ProfileService.registerVisitor(ProfileService.java:57)
at com.fexco.shoptaxfreemobile.controller.ProfileController.registerVisitor(ProfileController.java:91)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:213)
at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:126)
at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96)
at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617)
at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578)
at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at com.fexco.shoptaxfreemobile.jsonp.JsonpCallbackFilter.doFilter(JsonpCallbackFilter.java:33)
at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:928)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:539)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:300)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:619) 
```

服务等级

```
@Service
public class ProfileService {

    @Resource(name = "mySessionFactory")
    private SessionFactory sessionFactory;

    @Autowired
    private ProfileDao profileDao;

    private class CountrySorter implements Comparator<Country> {
        @Override
        public int compare(Country country1, Country country2) {
            if ( country1.getId().compareTo(new Long (3)) < 0){
                return country1.getId().compareTo(country2.getId());
            }
            return country1.getName().compareToIgnoreCase(country2.getName());
        }               
    }

    public List<Country> getCountries() {

        List<VisitorCountry> visitorCountries = profileDao.getAllCountries();       

        List<Country> countries = new ArrayList<Country>();
        for ( VisitorCountry country : visitorCountries){
            countries.add(country.getCountry());
        }

        Comparator<Country> comparator = new CountrySorter();       
        Collections.sort(countries, comparator);

        return countries;
    }

    public RegisterResponse registerVisitor(JsonVisitor visitorDetails){
        Visitor storedVisitor = (Visitor) sessionFactory.getCurrentSession().get(Visitor.class, visitorDetails.getTfscNumber(), LockMode.NONE);
        if ( storedVisitor == null){
            storedVisitor = new Visitor(visitorDetails);
        }else{
            storedVisitor.setVisitorDetails(visitorDetails);    
        }

        try{
            sessionFactory.getCurrentSession().saveOrUpdate(storedVisitor);

        }catch(Exception ex){
            return new RegisterResponse(false, "Failed To Register Card. Please Try Again Later.", visitorDetails);
        }

        return new RegisterResponse(true, "", visitorDetails);

    }
} 
```

一点 DAO 类

```
@Service
@Transactional
public class ProfileDao {

    @Resource(name = "mySessionFactory")
    private SessionFactory sessionFactory;

    public List getAllCountries(){

        List<VisitorCountry> visitorCountries = sessionFactory.getCurrentSession()
        .getNamedQuery("GET_ALL_COUNTRIES").list();

        return visitorCountries;

    }

    public List<Retailer> getRetailerByRetailerNumber(String retailerNo) {

        List<Retailer> retailerByRetailerNumber = sessionFactory.getCurrentSession()
        .getNamedQuery("FindRetailerByRetailerNo").setString("retailerNo", retailerNo).list();

        return retailerByRetailerNumber;
    } 
```

我的 application-context.xml 中有这个

```
<tx:annotation-driven transaction-manager="transactionManager"/>

<bean id="mySessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="myDataSource" />
    <property name="configLocation" value="classpath:hibernate.cfg.xml" />
    <property name="hibernateProperties">
        <value>
            <![CDATA[
        hibernate.show_sql=true
        hibernate.format_sql=true
        hibernate.cache.provider_class=org.hibernate.cache.NoCacheProvider
        ]]>
        </value>
    </property>
</bean> 
```

谁能发现我为什么会收到以下错误？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-04-24T13:17:39.640

您使用 @Transactional 注释了您的 Dao 类，但没有注释您的服务类。该行：

```
Visitor storedVisitor =
    (Visitor) sessionFactory.getCurrentSession().get(Visitor.class,
            visitorDetails.getTfscNumber(), LockMode.NONE); 
```

要求您进行交易。

您可以通过将 @Transactional 注释添加到 ProfileService 类或仅添加 registerVisitor() 方法来解决此问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-26T13:15:22.280

我通过以下 2 个步骤解决了同样的问题

1.  **按照本页答案中建议的jordan002**放置`@Transactional`在服务方法 上。

***   还有一件事，如果你有 2 个配置文件：说 `application-context.xml`（对于 DB 和应用程序上下文特定配置）和`webmvc-context.xml`（对于 web/控制器特定配置），那么你应该为你的控制器和 dao 扫描不同的包。

    之后`webmvc-context.xml`加载。`application-context.xml`我认为在加载 application-context.xml 时首先使用事务引用加载 DAO 类，但是当加载 webmvc-context.xml 时，它会被另一个对象替换，没有事务引用。

    无论如何，我解决了扫描特定包的问题：

    ```
    <context:component-scan base-package="com.app.repository" /> 
    ```

    为了`application-context.xml`

    和

    ```
    <context:component-scan base-package="com.app.web" /> 
    ```

    为`webmvc-context.xml`.** 

 *** * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-24T13:19:20.063

使用 @Repository 更改 DAO 的注释

```
@Repository
public class ProfileDao { 
.
.
.
} 
```

然后让你的服务方法@Transactional 例如像这样

```
@Transactional
public List<Retailer> getRetailerByRetailerNumber(String retailerNo) {} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-19T20:07:01.480

我通过以下两个步骤解决了上述问题

1-在调用 DAO 方法的服务方法中添加 @Transactional 支持

2-通过这种方式导入spring-servlet.xml中的applicationContext.xml

```
 <import resource="applicationContext.xml" />

<mvc:annotation-driven />
<context:component-scan base-package="com.json.api.*" />
<!--Third Party Integration should be injected in xml start here -->
    <bean id="integrationInterface" class="com.json.api.IntegerationInterface"></bean>
<!--Third Party Integration should be injected in xml start here -->
<mvc:interceptors>
    <bean id="apiServiceInterceptor" class="com.json.api.interceptor.ApiServiceInterceptor"></bean>
</mvc:interceptors>
<!--To Enable @Value to map key with provided fields for property files -->
<context:property-placeholder /> 
```

它消除了在 spring-servlet.xml 和 applicationContext.xml 两个地方扫描包的需要

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-02T15:57:39.523

我知道这是一个有一定年龄的问题，但我遇到了这个问题，发现如果您使用的是 Spring-Java 配置，那么解决方案有几个部分。某些配置与控制器的相对位置很重要。

一、CoreConfiguration

```
@Configuration
public class CoreConfiguration {
@Bean          
public LocalSessionFactoryBean sessionFactory() {
    LocalSessionFactoryBean factoryBean = new org.springframework.orm.hibernate4.LocalSessionFactoryBean();
    String annotatedPckgs[] ={"org.tigersndragons.reports.model.warehouse"};
    factoryBean.setAnnotatedPackages(annotatedPckgs);           
    Properties hibernateProperties = new Properties();
    try {
        hibernateProperties.load(this.getClass().getResourceAsStream("props/hibernate.properties"));        
        factoryBean.setHibernateProperties(hibernateProperties);
    } catch (IOException e) { }
    factoryBean.setPackagesToScan("org.telligen.reports.model.warehouse");
    factoryBean.setDataSource(warehouseDataSource());//("jdbc/warehouse");
    try {
        factoryBean.afterPropertiesSet();
    } catch (IOException e) {       }
    return factoryBean;
}
@Bean
public WarehouseDAO getWarehouseDAO(){
    WarehouseDAO wrhsDao = new WarehouseDAO();
    wrhsDao.setSessionFactory(sessionFactory().getObject());
    return wrhsDao;
} 
```

...

```
@Configuration
public class ScheduleConfiguration {
private static Logger logger = LoggerFactory.getLogger(ScheduleConfiguration.class);

@Autowired
private CoreConfiguration coreConfiguration;

@Bean
public HandlerMapping handlerMapping(){
    DefaultAnnotationHandlerMapping mapping =  new DefaultAnnotationHandlerMapping();
    mapping.setInterceptors(new Object []{coreConfiguration.openSessionViewInterceptor()});
    return mapping;
}

@Bean
public HandlerAdapter handerAdapter(){
    return new AnnotationMethodHandlerAdapter();
}

@Bean
public ScheduleController scheduleController() throws Exception{
    ScheduleController controller = new ScheduleController();
        controller.setWrhsDao(coreConfiguration.getWarehouseDAO());
    return controller;
}

 ... 
```

在控制器中，我必须设置

```
@Controller
@RequestMapping
public class ScheduleController {
private static Logger logger = LoggerFactory.getLogger(ScheduleController.class);

private WarehouseDAO wrhsDao;
    @RenderMapping
@RequestMapping("VIEW")
public String viewSchedule(Map<String, Object> modelMap){...}

public void setWrhsDao(WarehouseDAO wrhsDao) {
    this.wrhsDao = wrhsDao;
}
} 
```

WarehouseDAO 有 @Repository 注释，而 SessionFactory 没有自动装配。

希望这可以帮助其他有类似问题的人。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-01T19:36:42.493

我将添加一些需要我一些时间来调试的东西：不要忘记@Transactional 注释仅适用于“公共”方法。

我将一些@Transactional 放在“受保护”的上并收到此错误。

希望能帮助到你 ：）

[http://docs.spring.io/spring/docs/3.1.0.M2/spring-framework-reference/html/transaction.html](http://docs.spring.io/spring/docs/3.1.0.M2/spring-framework-reference/html/transaction.html)

> **方法可见性和@Transactional**
> 
> 使用代理时，您应该仅将 @Transactional 注释应用于具有公共可见性的方法。如果您使用 @Transactional 注释对受保护的、私有的或包可见的方法进行注释，则不会引发错误，但带注释的方法不会显示配置的事务设置。如果您需要注释非公共方法，请考虑使用 AspectJ（见下文）。**

# rrdtool - 从 RRDTool 中删除数据

> ID：10298484
> 
> 赞同：5
> 
> 时间：2012-04-24T13:08:18.907
> 
> 标签：rrdtool, rrd

我有几个由 RRDTool 创建的图表，它们在几个小时的时间段内收集了不良数据。

如何在该时间段内从 RRD 中删除数据，使其不再显示？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-25T14:11:00.943

我发现这样做的最佳方法...

1.  使用[RRDTool Dump](http://oss.oetiker.ch/rrdtool/doc/rrddump.en.html "RRD工具转储")将 RRD 文件导出为 XML。
2.  打开 XML 文件，查找并编辑不良数据。
3.  [使用RRDTool Restore](http://oss.oetiker.ch/rrdtool/doc/rrdrestore.en.html "RRDTool 恢复")恢复 RRD 文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-31T19:35:06.773

我有一个类似的问题，我想从我的 RRDtool 数据库中丢弃最近几个小时，所以我编写了一个快速脚本来完成它（为非常规的变量名称道歉 - 从工作中继承的编码风格，叹息）：

```
#!/usr/bin/env python2                                                                                                                                                                                 
"""                                                                                                                                                                                                    
Modify XML data generated by `rrdtool dump` such that the last update was at                                                                                                                           
the unixtime specified (decimal). Data newer than this is simply omitted.                                                                                                                              

Sample usage::                                                                                                                                                                                         

    rrdtool dump foo.rrd \
       | python remove_samples_newer_than.py 1414782122 \
       | rrdtool restore - foo_trimmed.rrd                                                                                          
"""                                                                                                                                                                                                    

import sys                                                                                                                                                                                             

assert sys.argv[1:], "Must specify maximum Unix timestamp in decimal"                                                                                                                                  

iMaxUpdate = int(sys.argv[1])

for rLine in iter(sys.stdin.readline, ''):                                                                                                                                                             
    if "<lastupdate>" in rLine:                                                                                                                                                                        
        # <lastupdate>1414782122</lastupdate> <!-- 2014-10-31 19:02:02 GMT -->                                                                                                                         
        _, _, rData = rLine.partition("<lastupdate>")                                                                                                                                                  
        rData, _, _ = rData.partition("</lastupdate")                                                                                                                                                  
        iLastUpdate = int(rData)                                                                                                                                                                       
        assert iLastUpdate < iMaxUpdate, "Last update in RRD older than " \                                                                                                                            
                                    "the time you provided, nothing to do"                                                                                                                             
        print "<lastupdate>{0}</lastupdate>".format(iMaxUpdate)                                                                                                                                        
    elif "<row>" in rLine:                                                                                                                                                                             
        # <!-- 2014-10-17 20:04:00 BST / 1413572640 --> <row><v>9.8244774011e+01</v><v>8.5748587571e-01</v><v>4.2046610169e+00</v><v>9.3016101695e+01</v><v>5.0000000000e-02</v><v>1.6652542373e-01</  v><v>1.1757062147e+00</v><v>1.6901226735e+10</v><v>4.2023108608e+09</v><v>2.1457537707e+08</v><v>3.9597816832e+09</v><v>6.8812800000e+05</v><v>3.0433198080e+09</v><v>6.0198912250e+06</v><v>2\.        0000000000e+00</v><v>0.0000000000e+00</v></row>                                                                                                                                                        
        rData, _, _ = rLine.partition("<row>")                                                                                                                                                         
        _, _, rData = rData.partition("/")                                                                                                                                                             
        rData, _, _ = rData.partition("--")                                                                                                                                                            
        rData = rData.strip()                                                                                                                                                                          
        iUpdate = int(rData)                                                                                                                                                                           
        if iUpdate < iMaxUpdate:                                                                                                                                                                       
            print rLine,                                                                                                                                                                               
    else:                                                                                                                                                                                              
        print rLine, 
```

为我工作。希望它可以帮助别人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-01T19:11:33.507

如果您想避免写入和编辑 xml 文件，因为这可能需要很少的文件 IO 调用（基于您拥有多少坏数据），您还可以使用 fetch 和 update 内存中的值将整个 rrd 读入内存。

我使用 python + rrdtool 做了类似的任务，我最终做了：

> 1.  在字典中读取内存中的rrd
> 2.  修复字典中的值
> 3.  删除现有的rrd文件
> 4.  创建具有相同名称的新 rrd。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-28T23:18:39.380

唯一提出要编辑什么的人是 RobM。我尝试了他的解决方案，但它在 rrdtool 1.4.7 中对我不起作用

我的数据库使用 AVERAGE、MAX 和 MIN。它包含 DERIVE、GAUGE 和 COMPUTED。间隔：秒 (70)、分钟 (70)、小时 (25)、天 (367)。我的任务：删除最后一部分（典型原因：时钟移回）。

我应用了 RobM 的解决方案：更改为我的新结束时间，之后全部删除。恢复的数据库似乎正常。但它不接受新的添加。我检查了一个新创建的空数据库。我在其中发现了 70 秒的 NaN 记录，分钟和小时也是如此。

所以，我的工作解决方案 - 如果我在某个时期结束时删除记录，我会在这个时期开始时添加相同数量的 NaN 记录，并正确减少时间。例外 - 每日记录，它们只删除而不添加。如果句点在删除后变为空，我用 NaN 记录填充到我的新结束时间（四舍五入到句点边界）。

# sql-server-2008 - SQL如何从单行创建多行

> ID：10298487
> 
> 赞同：3
> 
> 时间：2012-04-24T13:08:44.267
> 
> 标签：sql-server-2008

嗨，我是 SQL Server 2008 的新手

我想根据另一个列将单行扩展到多行，

例如

```
date          value
7-2011         5 
```

结果：

```
2011-07-01     
2011-08-01
2011-09-01
2011-10-01
2012-11-01 
```

日期应该是当前和下个月的第一天，重复 5 次

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T13:17:52.980

尝试：

```
DECLARE @YourTable table (YourDate datetime, value int)

insert into @YourTable VALUES ('2011-7-12',5)

;WITH AllNumbers AS
(
    SELECT 0 AS Number
    UNION ALL
    SELECT Number+1
        FROM AllNumbers
        WHERE Number<4
)
SELECT 
    dateadd(month,number,DATEADD(month,DATEDIFF(month,0,YourDate),0))
    FROM @YourTable        y
    INNER JOIN AllNumbers  a ON 1=1 
```

输出：

```
-----------------------
2011-07-01 00:00:00.000
2011-08-01 00:00:00.000
2011-09-01 00:00:00.000
2011-10-01 00:00:00.000
2011-11-01 00:00:00.000

(5 row(s) affected) 
```

它适用于表中的多行，请参见此处：

```
DECLARE @YourTable table (YourDate datetime, ValueOf int)

insert into @YourTable VALUES ('2011-7-12',5)
insert into @YourTable VALUES ('2012-4-24',6)

;WITH AllNumbers AS
(
    SELECT 0 AS Number
    UNION ALL
    SELECT Number+1
        FROM AllNumbers
        WHERE Number<4
)
SELECT 
    y.ValueOf
        ,dateadd(month,number,DATEADD(month,DATEDIFF(month,0,y.YourDate),0))
    FROM @YourTable        y
    INNER JOIN AllNumbers  a ON 1=1
    ORDER BY 1,2 
```

输出：

```
ValueOf     
----------- -----------------------
5           2011-07-01 00:00:00.000
5           2011-08-01 00:00:00.000
5           2011-09-01 00:00:00.000
5           2011-10-01 00:00:00.000
5           2011-11-01 00:00:00.000
6           2012-04-01 00:00:00.000
6           2012-05-01 00:00:00.000
6           2012-06-01 00:00:00.000
6           2012-07-01 00:00:00.000
6           2012-08-01 00:00:00.000

(10 row(s) affected) 
```

另外，我没有可用的 SQL Server 2008，所以我使用了 datetime，如果你有 2008，你可以使用`DATE`datatype 并且你不必设置 datetime，所以使用这一行：

```
dateadd(month,number,y.YourDate) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:25:00.590

```
create  function addMonths(@date date, @limit int)
returns @date_table TABLE(
myDate date
)
AS
begin
  declare @cont int
  set @cont = 1
  while (@cont <= @limit) begin
    insert into @date_table values(DATEADD(MONTH,@cont,@date))
    set @cont=@cont+1
  end

  return 
end 
```

用法：

```
select * from addMonths(GETDATE(),5) 
```

编辑：

```
create table mydates(
myDate date,
inc_months int)

insert into mydates values ('01/01/2005',3)
insert into mydates values ('01/01/2006',5)

select AM.mydate 
from mydates MD cross apply addMonths(MD.mydate,MD.inc_months) AM 
```

结果：

```
2005-02-01
2005-03-01
2005-04-01
2006-02-01
2006-03-01
2006-04-01
2006-05-01
2006-06-01 
```

# opengl-es - 来自模型/视图矩阵的 OpenGL 相机方向向量

> ID：10298488
> 
> 赞同：1
> 
> 时间：2012-04-24T13:08:47.630
> 
> 标签：opengl-es, matrix, euler-angles

我正在制作一个小游戏，我想在我面对的方向上扔一个物体。问题是我的（相机）方向是由模型/视图矩阵决定的。这个矩阵是由系统提供的（在安卓设备上）。

如何计算矢量，该矢量将用作我抛出的物体的速度矢量？
我尝试将一些向量与矩阵相乘，但结果并没有给我一个线索如何完成这个。

矩阵仅包含旋转部分（无缩放、倾斜或平移）。
我正在使用 OpenGL ES 1.1，但这可能并不重要。

按照[这个答案](https://stackoverflow.com/a/3537822/450580)，我能够获得围绕每个轴的旋转角度，但我仍然不知道如何从中建立我的速度矢量。

编辑：我想要完成的是以任何方式旋转模型/视图矩阵，并**以我面对的方式**抛出对象。我需要物体最终加速到地面。如果我知道我（相机）面对的确切矢量，我计算这个轨迹没有问题。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:30:35.463

模型视图矩阵的前 3 列是**视图**坐标系的基础。所以你只需要第三列（或行，取决于你是从相机到世界，还是从世界到相机）。

# c++ - 流缓冲区大小

> ID：10298494
> 
> 赞同：0
> 
> 时间：2012-04-24T13:09:07.537
> 
> 标签：c++, stream, buffer

在 Windows 中，对于缓冲流，我如何知道缓冲区的大小？例如，我可能需要知道标准流的大小。

# mysql - 大数据量能不能执行得更快【MySQL】

> ID：10298503
> 
> 赞同：0
> 
> 时间：2012-04-24T13:09:46.693
> 
> 标签：mysql, optimization, high-load, sql-optimization

有什么办法可以优化下一个查询：

```
EXPLAIN EXTENDED SELECT keyword_id, ck.keyword, COUNT( article_id ) AS cnt
FROM career_article_keyword
LEFT JOIN career_keywords ck
USING ( keyword_id ) 
WHERE keyword_id
IN (

SELECT keyword_id
FROM career_article_keyword
LEFT JOIN career_keywords ck
USING ( keyword_id ) 
WHERE article_id
IN (

SELECT article_id
FROM career_article_keyword
WHERE keyword_id =9
)
AND keyword_id <>9
)
GROUP BY keyword_id
ORDER BY cnt DESC 
```

这里的主要任务是如果我有特定的keyword_id（CURRENT_KID），我需要找到曾经属于任何文章的所有关键字以及CURRENT_KID，并根据这些关键字的使用量对结果进行排序

表定义为：

```
mysql> show create table career_article_keyword;
+------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table                  | Create Table                                                                                                                                                                                                                                                                                                                                               |
+------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| career_article_keyword | CREATE TABLE `career_article_keyword` (
  `article_id` int(11) unsigned NOT NULL,
  `keyword_id` int(11) NOT NULL,
  UNIQUE KEY `article_id` (`article_id`,`keyword_id`),
  CONSTRAINT `career_article_keyword_ibfk_1` FOREIGN KEY (`article_id`) REFERENCES `career` (`menu_id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 |
+------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> show create table career_keywords;
+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table           | Create Table                                                                                                                                                                                                         |
+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| career_keywords | CREATE TABLE `career_keywords` (
  `keyword_id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
  `keyword` varchar(250) NOT NULL,
  PRIMARY KEY (`keyword_id`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8 |
+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec) 
```

“解释”的输出吓到我了

[http://o7.no/J6ThIs](http://o7.no/J6ThIs)

在大数据上，这个查询可以杀死一切:) 我能以某种方式让它更快吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:28:01.567

查看您的`EXPLAIN`输出，我担心您对子查询的使用导致索引的使用不理想。我*觉得*（没有任何理由——我很可能错了）重写使用`JOIN`可能会导致更优化的查询。

为此，我们需要了解您的查询的目的是什么。如果您的问题已经阐明它会有所帮助，但经过一番摸索后，我决定您的查询试图获取*包含某个给定关键字的任何文章中出现的所有其他关键字的列表，以及所有文章的计数那些关键字出现在其中*。

现在让我们分阶段重建查询：

1.  获取“*任何包含给定关键字的文章*”（不用担心重复）：

    ```
    SELECT ca2.article_id
    FROM
           career_article_keyword AS ca2
    WHERE
          ca2.keyword_id = 9; 
    ```

2.  获取“*出现在[上述]中的所有其他关键字*”

    ```
    SELECT ca1.keyword_id
    FROM
           career_article_keyword AS ca1
      JOIN career_article_keyword AS ca2 ON (ca2.article_id = ca1.article_id)
    WHERE
          ca1.keyword_id <> 9
      AND ca2.keyword_id =  9
    GROUP BY ca1.keyword_id; 
    ```

3.  获取“ *[上述]，以及出现这些关键字的所有文章的计数*”

    ```
    SELECT ca1.keyword_id, COUNT(DISTINCT ca0.article_id) AS cnt
    FROM
           career_article_keyword AS ca0
      JOIN career_article_keyword AS ca1 USING (keyword_id)
      JOIN career_article_keyword AS ca2 ON (ca2.article_id = ca1.article_id)
    WHERE
          ca1.keyword_id <> 9
      AND ca2.keyword_id =  9
    GROUP BY ca1.keyword_id
    ORDER BY cnt DESC; 
    ```

4.  最后，我们想将表中匹配的关键字本身添加到输出`career_keyword`中：

    ```
    SELECT ck.keyword_id, ck.keyword, COUNT(DISTINCT ca0.article_id) AS cnt
    FROM
           career_keywords        AS ck 
      JOIN career_article_keyword AS ca0 USING (keyword_id)
      JOIN career_article_keyword AS ca1 USING (keyword_id)
      JOIN career_article_keyword AS ca2 ON (ca2.article_id = ca1.article_id)
    WHERE
          ca1.keyword_id <> 9
      AND ca2.keyword_id =  9
    GROUP BY ck.keyword_id -- equal to ca1.keyword_id due to join conditions
    ORDER BY cnt DESC; 
    ```

立即清楚的一件事是您的原始查询引用`career_keywords`了两次，而这个重写的查询仅引用了该表一次；仅此一项就可以解释性能差异 - 尝试删除对它的第二个引用（即它出现在您的第一个子查询中的位置），因为它在那里完全是多余的。

回顾这个查询，我们可以看到正在对以下列执行连接：

*   **`career_keywords.keyword_id`**在`ck JOIN ca0`

    这个表定义了`PRIMARY KEY (`keyword_id`)`，所以有一个很好的索引可以用于这个连接。

*   **`career_article_keyword.article_id`**在`ca1 JOIN ca2`

    该表定义`UNIQUE KEY `article_id` (`article_id`,`keyword_id`)`并且因为`article_id`是该索引中最左边的列，所以有一个很好的索引可用于该连接。

*   **`career_article_keyword.keyword_id`**在`ck JOIN ca0`和`ca0 JOIN ca1`

    没有可用于此连接的索引：此表中定义的唯一索引在-`article_id`左侧有另一列，`keyword_id`因此 MySQL`keyword_id`在不知道`article_id`. 我建议你创建一个新的索引，`keyword_id`它的最左边一列。

    （对这个索引的需求同样可以通过查看原始查询来确定，您的两个最外层查询在该列上执行连接。）

# python - 处理 MongoDB 中的主从/主从查询

> ID：10298507
> 
> 赞同：2
> 
> 时间：2012-04-24T13:09:57.133
> 
> 标签：python, mongodb, pymongo

我想用 MongoDB 扩展读取。为此，我可以设置主从复制或副本集，但如果我像这样创建与 Mongo 的连接：

```
from pymongo import ReplicaSetConnection, ReadPreference
from pymongo.errors import ConnectionFailure

try:
    connection = ReplicaSetConnection("somehost:10000", replicaSet='myapp_repl',
                                  read_preference=ReadPreference.SECONDARY) 
except ConnectionFailure ... 
```

或者：

```
from pymongo.master_slave_connection import MasterSlaveConnection
from pymongo.errors import ConnectionFailure

try:
    master = Connection(host="somehost", port=10000)
    slave1 = Connection(host="somehost", port=10001)
    slave2 = Connection(host="somehost", port=10002)
    connection = MasterSlaveConnection(master, slaves=[slave1, slave2])
except ConnectionFailure ... 
```

**pymongo**驱动程序将在副本集辅助服务器/从服务器之间分发查询。在这种情况下，primary/master 不会处理查询，所以如果我有 2 个节点，我不会增强读取能力，因为只有 1 个节点会处理查询。如何让主从（主要和次要）处理查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:28:45.940

这有点骇人听闻，但是：

```
connection = MasterSlaveConnection(master, slaves=[slave1, slave2, master) 
```

MasterSlaveConnection 已被弃用。

我不确定有什么其他方法可以解决这个问题。

您可能想研究分片或添加仲裁器以在新的初选中投票：[http ://www.mongodb.org/display/DOCS/Adding+an+Arbiter](http://www.mongodb.org/display/DOCS/Adding+an+Arbiter)

# php - 如何在不使用全局变量的情况下影响函数外部的变量

> ID：10298510
> 
> 赞同：0
> 
> 时间：2012-04-24T13:10:08.463
> 
> 标签：php, function, variables, global

需要一些关于如何在不使用全局变量的情况下影响函数外部变量的代码示例。另外我想知道我应该在哪里使用 global 而不是。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:17:38.473

在不使用全局变量的情况下影响另一个范围内的变量的*唯一方法是使用*[**引用**](http://php.net/manual/en/language.references.php)。您可以定义一个函数，通过在参数前面加上`&`. 例如：

```
function increment(&$var) {
  $var++;
}

$int = 1;
increment($int);
echo $int; // 2 
```

在回答“我什么时候应该使用全局变量”这个问题时——从不。它们使程序流程混乱并引发错误和意外行为，并且它们还使代码的可移植性降低，因为它依赖于另一个范围内的变量名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:15:40.860

不要使用全局变量它的邪恶。

对于问题的第二部分，您可以这样做：

```
function test(&$param) {
    $param = 'new';
}

$test = 'old';
test($test);
echo $test; // returns 'new' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:19:44.273

```
$var = 'value';

echo $var; //outputs "value"

a($var);
echo $var //outputs "new value; func a";

b('some other sutff', 'etc');
echo $var; //outputs "new value; func b";

function a(&$var2affect){

 $var2affect = 'new value; func a';

 return;

}

function b($some_var, $some_second_var){

  global $var;

  $var = 'new vaule; func b';

} 
```

或者只是告诉我们您具体想做什么

> 对不起我的英语不好

# java - Apache POI - 如何注册函数

> ID：10298512
> 
> 赞同：2
> 
> 时间：2012-04-24T13:10:11.677
> 
> 标签：java, excel, apache-poi

我阅读了**Apache POI**网站上关于[如何将自定义函数注册](http://poi.apache.org/spreadsheet/user-defined-functions.html)到 FormulaEvaluator 的教程，我想用它来定义 POI 不提供支持的函数 MINVERSE。因此，首先我创建了一个定义 MINVERSE 的类（仅出于测试目的，我将 MINVERSE 定义为始终返回值 10）。所以这里是 MINVERSE.java：

```
package simpleboxapi;

import org.apache.poi.ss.formula.OperationEvaluationContext;
import org.apache.poi.ss.formula.eval.NumberEval;
import org.apache.poi.ss.formula.eval.ValueEval;
import org.apache.poi.ss.formula.functions.FreeRefFunction;

public class MINVERSE implements FreeRefFunction{

    @Override
    public ValueEval evaluate(ValueEval[] args, OperationEvaluationContext ec) {
        return new NumberEval(10);
    }
} 
```

之后我尝试了一些非常简单的方法：我创建了以下 excel 表：

![来自 Excel 的屏幕截图](../Images/898a63f30fbb0da68a64f19db6430306.png)

A1 是给定常数，A2 是 A2=MINVERSE(A1)

这是我的主要课程代码：

```
package simpleboxapi;

import java.io.*;
import org.apache.poi.hssf.util.CellReference;
import org.apache.poi.openxml4j.exceptions.InvalidFormatException;
import org.apache.poi.ss.formula.functions.FreeRefFunction;
import org.apache.poi.ss.formula.udf.AggregatingUDFFinder;
import org.apache.poi.ss.formula.udf.DefaultUDFFinder;
import org.apache.poi.ss.formula.udf.UDFFinder;
import org.apache.poi.ss.usermodel.*;

public class SimpleBoxAPI {

    static String fileName = "workbook.xls";
    static Workbook wb;

    private static double updateInputVal(String cell, double val) throws IOException, InvalidFormatException{
        InputStream inp = new FileInputStream(fileName);
        wb = WorkbookFactory.create(inp);
        CellReference crInput = new CellReference(cell);
        Sheet sheet = wb.getSheetAt(0);
        Row rowInput = sheet.getRow(crInput.getRow());
        Cell cellInput = rowInput.getCell(crInput.getCol());
        cellInput.setCellValue(val);
        FileOutputStream fileOut = new FileOutputStream(fileName);
        wb.write(fileOut);
        fileOut.close();
        double cellContents = cellInput.getNumericCellValue();
        inp.close();
        return cellContents;
    }

    private static void registerMINVERSE(){
       String[] functionNames = {"MINVERSE"};
        FreeRefFunction[] functionImpls = {new MINVERSE()};
        UDFFinder udfs = new DefaultUDFFinder(functionNames, functionImpls);
        UDFFinder udfToolpack = new AggregatingUDFFinder(udfs);
        wb.addToolPack(udfToolpack); 
    }

    public static void main(String[] args) throws Exception {

        double updatedValue = updateInputVal("A1",55);
        System.out.println(updatedValue);
        registerMINVERSE();

        FormulaEvaluator evaluator = wb.getCreationHelper().createFormulaEvaluator();
        CellReference cr = new CellReference("A2");
        Sheet sheet = wb.getSheetAt(0);
        Row row = sheet.getRow(cr.getRow());
        Cell cell = row.getCell(cr.getCol());
        System.out.println(evaluator.evaluate(cell).getNumberValue());
    }
} 
```

但是，每当我尝试执行它时，我都会收到以下错误：

```
org.apache.poi.ss.formula.eval.NotImplementedException: Error evaluating cell 'new sheet'!A2
    at org.apache.poi.ss.formula.WorkbookEvaluator.addExceptionInfo(WorkbookEvaluator.java:356)
    at org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:297)
    at org.apache.poi.ss.formula.WorkbookEvaluator.evaluate(WorkbookEvaluator.java:229)
    at org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluateFormulaCellValue(HSSFFormulaEvaluator.java:354)
    at org.apache.poi.hssf.usermodel.HSSFFormulaEvaluator.evaluate(HSSFFormulaEvaluator.java:185)
    at simpleboxapi.SimpleBoxAPI.main(SimpleBoxAPI.java:56)
Caused by: org.apache.poi.ss.formula.eval.NotImplementedException: MINVERSE
    at org.apache.poi.ss.formula.functions.NotImplementedFunction.evaluate(NotImplementedFunction.java:42)
    at org.apache.poi.ss.formula.OperationEvaluatorFactory.evaluate(OperationEvaluatorFactory.java:132)
    at org.apache.poi.ss.formula.WorkbookEvaluator.evaluateFormula(WorkbookEvaluator.java:491)
    at org.apache.poi.ss.formula.WorkbookEvaluator.evaluateAny(WorkbookEvaluator.java:287)
    ... 4 more 
```

有什么建议么？提前非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T21:35:48.327

您一直在查看的自定义函数教程仅适用于真正的自定义函数。它不会让您覆盖尚未实现 POI 的内置 Excel 函数

如果您查看[org/apache/poi/ss/formula/function/functionMetadata.txt](http://svn.apache.org/repos/asf/poi/trunk/src/resources/main/org/apache/poi/ss/formula/function/functionMetadata.txt)，您将看到以文件格式定义的内置 Excel 函数列表。该列表中的任何内容都不能作为自定义函数被覆盖，因为它们以不同的文件格式存储。（当然，对于 .xls 文件，.xlsx 有点不同）。在查看该文件时，记下您的函数的 ID。

如果您的公式函数是内置函数，那么您应该看看[FunctionEval](http://svn.apache.org/repos/asf/poi/trunk/src/java/org/apache/poi/ss/formula/eval/FunctionEval.java)。您可以使用[getNotSupportedFunctionNames()](http://poi.apache.org/apidocs/org/apache/poi/ss/formula/eval/FunctionEval.html#getNotSupportedFunctionNames%28%29)或仅查看代码以查看该功能是否已实现。（数组由函数 ID 索引，您从 functionMetadata.txt 获得）

如果您的功能没有实现，您需要获取 POI 源代码，并且：

*   在某处添加您的函数实现
*   列出具有正确 ID 的 FunctionEval 中的函数
*   测试（您可以使用 POI 公式测试来帮助）
*   将其作为补丁提交！有关详细信息，请参阅[POI 贡献指南](http://poi.apache.org/guidelines.html)

提交补丁后不久，POI 将包含您缺少的功能，社区将帮助维护它，以便您继续前进 :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T08:10:27.507

[本教程](http://poi.apache.org/spreadsheet/user-defined-functions.html)是关于如何使用 Java 类覆盖在 Excel 端定义的自定义函数。为了覆盖 POI 不提供支持的现有 Excel 函数，您需要将其注册到 FunctionEval。这很简单：

```
FunctionEval.registerFunction("MINVERSE", new Minverse()); 
```

（但由于缺乏适当的文档而变得困难）。Minverse 类应该实现接口`org.apache.poi.ss.formula.functions.Function`或扩展同一个包的一些抽象类。

`Function`定义方法：

```
public ValueEval evaluate(ValueEval[] args, int srcRowIndex, int srcColumnIndex) 
```

需要覆盖哪个以提供所需的功能。我还不清楚如何处理允许数据区域并返回区域（不是向量/数组）的函数。我将开始一个新的问题...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T14:16:22.567

我不知道为什么，但是您必须将带有函数定义（甚至可以为空）的 VBA 代码放入工作表中 - 将函数放入模块中。

```
Function MINVERSE(principal As Double)
End Function 
```

# plone - 导航中文档条目的颜色编码（自定义工作流，自定义原型内容类型）

> ID：10298513
> 
> 赞同：2
> 
> 时间：2012-04-24T13:10:12.000
> 
> 标签：plone

在 Plone 4.1.4 上，我们安装了一个自定义工作流程和一个基于 Archetypes 的自定义文档类型。我们注意到文档在导航中没有用颜色编码（即，如果状态低于已发布，则标记为红色）。文件夹（仍然使用开箱即用的工作流程）仍然具有此功能。

我们可以在哪里以及如何调整它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:48:47.420

Plone 应该基于其工作流状态为导航树项目提供 CSS 类。

我认为类名类似于`state-private`后半部分是您的工作流状态 ID。

只需添加与您的自定义工作流程状态相对应的 CSS 样式。

# html - Html5 应用程序缓存

> ID：10298514
> 
> 赞同：2
> 
> 时间：2012-04-24T13:10:12.703
> 
> 标签：html, html5-appcache

我尝试使用 Html5 应用程序缓存在离线模式下运行我的应用程序。为此，我创建了 test.html 文件和 demo.appcache

在这个 html 页面中，我使用了来自本地主机的一些图像。当我的本地主机运行时，它工作正常。但是，如果我试图停止本地主机，图像不会从我的应用程序缓存中获取。输出只是显示为空白页。

这是我的 sampletest.html

```
<!DOCTYPE html>

<html manifest="demo.appcache">

<head>
</head>

<body>
Further modified........Test Again
<img src="http://172.17.0.238/SampleImages/two.jpg" width="225" height="151" alt="Milford Sound in New Zealand" />

</body></html> 
```

demo.appcache

```
CACHE MANIFEST
CACHE:
sampletest.html
NETWORK: 
```

倒退：

我的代码有什么问题吗？在缓存下：我加载了我的 html 文件。但是，当本地主机不可用时，它不会从应用缓存中加载 html。

任何帮助...问候，Lokesh。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T08:55:24.303

我有一个类似的问题。就我而言，我在 Android 设备中使用 WevView。在那里只需要 9 分钟来注册主机不可访问 - 然后它从 appcache 加载。我不知道其他代理是否有这样的行为，但值得一试；）

* * *

无论如何：如果它是第一个条目，则不必声明 CACHE 部分：

```
 CACHE MANIFEST
   sampletest.html
   NETWORK: 
```

仅当您想在使用 NETWORK 或 FALLBACK 后添加更多要缓存的内容时：

```
 CACHE MANIFEST
   sampletest.html

   NETWORK:
   *

   FALLBACK:
   online.html offline.html

   CACHE:
   additionalContent.html 
```

但是请不要问我为什么他们认为这必须是可能的；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:17:14.860

您必须在清单中包含页面所需的所有资源：图像、外部 javascript 和 css 等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-04T05:13:09.403

您面临的问题主要是由于根据情况不同的错误代码。如果您的计算机无法访问 Internet，它不会尝试访问服务器，而是会尝试从 appcache 加载。

问题是当您的计算机可以访问 Internet 并且您关闭服务器时，错误会有所不同（它可能会返回 4xx 或 5xx 或等效值）。这是服务器问题而不是用户问题，因此将无法加载缓存。

> 否则，如果获取清单以其他方式失败（例如，服务器返回另一个 4xx 或 5xx 响应或等效响应，或者存在 DNS 错误，或者连接超时，或者用户取消下载，或者清单解析器失败检查魔术签名时），或者如果服务器返回重定向，或者如果资源被标记为文本/缓存清单以外的 MIME 类型，则运行缓存失败步骤。

这记录在这里： [http ://www.w3.org/TR/2011/WD-html5-20110525/offline.html#downloading-or-updating-an-application-cache](http://www.w3.org/TR/2011/WD-html5-20110525/offline.html#downloading-or-updating-an-application-cache)

# java - 如何在 Tomcat webapp 中将日志从 rt.jar (JUL) 发送到 LOG4j？

> ID：10298515
> 
> 赞同：2
> 
> 时间：2012-04-24T13:10:16.430
> 
> 标签：java, tomcat, logging, log4j

我正在与我的客户斗争，因为他不希望我们的 webapp 的任何相关消息登录到 catalina.out。

到目前为止，我已将所有 System out/err 重定向到我的 log4j 实例。这很棒。但现在我面对的是使用 JUL 的标准 java 库。

我发现了我不喜欢的提示，因为它涉及使用 SLF4J 作为主日志（[JUL 到 LOG4j](https://stackoverflow.com/questions/869945/how-to-send-java-util-logging-to-log4j)），但我们处于项目的生产级别，我们没有更改记录器。

此外，Tomcat 6 允许使用 LOG4J 作为解决方案似乎有点激烈。我还找到了一个桥（[JUL 到 LOG4J 桥](http://people.apache.org/~psmith/logging.apache.org/sandbox/jul-log4j-bridge/apidocs/org/apache/logging/julbridge/JULLog4jBridge.html)），但它不够详细，我不知道如何继续。

我怎样才能只拾取我部署的 webapp 生成的日志以发送到我的 LOG4J 配置文件，即使它们来自任何 java 库，如 rt.jar？

# iphone - 将应用程序大小减少超过 50 兆的最佳方法

> ID：10298518
> 
> 赞同：1
> 
> 时间：2012-04-24T13:10:20.893
> 
> 标签：iphone, ios

两部分问题。

我有一个 26.5mbs 的 ipa 文件，在 itunes 中它说它正是那个大小，但是当我安装到设备上时，它说我的应用程序在设备上是 52.5mbs ......为什么？这是否意味着它超过了非 wifi 下载的 50mb 下载大小？

还有有没有办法像压缩或其他东西一样去除一些尺寸？除了删除图像和文件之外，我不确定如何使其更小。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:18:24.273

如果我没记错的话，.ipa 已经被压缩了。这就是为什么您的应用程序在商店中的大小为 26.5 MB，但安装后，它变成了 52.5 MB。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:44:44.053

我设法通过使用这项服务将我的 iPhone 应用程序减少了一半：[http](http://www.jpegmini.com/) : //www.jpegmini.com/ 我已经上传了我所有的 jpegs 并得到了它们的缩小版本（有时更小 3 倍）

我有一些动画（是一堆“png”），要求我的平面设计师将其展平为 jpg 而不是 png。

最后，我设法从我的应用程序中削减了 13 MB，只是我的缩小图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:15:37.397

设备上的大小将考虑您在运行、解压缩捆绑包等时创建的任何文件。下载限制适用于 iTunes 认为文件的大小（即签名的 IPA），而不是“设备上”的大小。

不过，您可能会得到一个较小的捆绑包，具体取决于您的应用程序的构成。如果有很多图像，您可能想查看[http://imageoptim.com/](http://imageoptim.com/)，它在处理 PNG 方面比 Xcode 的内置重新压缩要好得多。

# c++ - 内存分配责任

> ID：10298519
> 
> 赞同：1
> 
> 时间：2012-04-24T13:10:21.843
> 
> 标签：c++, memory-management, operating-system

我一直在思考这个问题，但还没有找到任何解释。

哪个模块决定应该为 C++ 程序分配多少内存？是操作系统决定编译器的推荐吗？..链接器？

分配的内存中堆栈和堆的比例是多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:17:27.037

对于不同的操作系统，答案是不同的。通常，可执行文件包含主线程所需的堆栈大小，由链接器放置在那里，可能会被操作系统设置覆盖。操作系统设置可以通过一种或多种方式配置，可能针对每个用户。一些操作系统不需要预先指定堆栈大小，它们可以在使用堆栈时或多或少无限期地添加堆栈（直到达到硬限制或系统耗尽可用内存）。那些确实需要预先确定大小的人可能最初只分配地址空间而不是内存，并且在堆栈达到那个距离时将地址映射到内存。

堆通常不会预先分配，因此没有“堆栈和堆的比例”。分配给进程的总内存可能会或可能不会受到限制——如果没有，那么它可以达到系统资源允许的上限，或者在 32 位系统上可能会受到可用地址空间的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:21:23.603

这不是 C++ 标准中的问题。它取决于编译器和操作系统。

有关链接器产生的那种事情的例子，操作系统在确定程序请求的资源时会考虑这些事情，请参阅：

[http://en.wikipedia.org/wiki/Executable_and_Linkable_Format#ELF_file_layout](http://en.wikipedia.org/wiki/Executable_and_Linkable_Format#ELF_file_layout)

在某些情况下，有一些 API 可以专门从操作系统请求资源：

[在使用 GNU 编译器编译期间更改 Linux 中 C++ 应用程序的堆栈大小](https://stackoverflow.com/questions/2275550/change-stack-size-for-a-c-application-in-linux-during-compilation-with-gnu-com)

还有一些方法可以告诉操作系统在某些环境中设置配额和限制：

[https://stackoverflow.com/questions/4983120/limit-memory-usage-for-a-single-linux-process](https://stackoverflow.com/questions/4983120/limit-memory-usage-for-a-single-linux-process)

[设置 Windows 进程（或用户）内存限制](https://stackoverflow.com/questions/192876/set-windows-process-or-user-memory-limit)

如果您想对某个操作系统如何管理资源使用进行实证研究，您可能会使用进程监视器实用程序来更好地了解它，而不是寻找文档......特别是。使用闭源操作系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:22:29.263

取决于您的程序和操作系统。通常，在启动时只分配足够的内存来保存可执行文件、任何只读数据，通常大约 4k 用于堆栈。然后，当您调用 malloc 或 new 来分配内存时，您将获得虚拟内存空间，而无需任何物理内存对其进行备份。这称为延迟分配，只有在您实际写入时才会物理分配内存。

编译并计时以下内容以了解我在说什么：

```
//justwrites.c
#include <stdlib.h>

int main(int argc, char **argv) {

int *big = calloc(sizeof(int),19531); // number of writes

return 0;
}

// deadbeef.c
#include <stdlib.h>

int main(int argc, char **argv) {

int *big = malloc(sizeof(int)*20000000); // allocate 8 million bytes
// immediately write to each page to simulate all at once allocation
// assuming 4k page size on 32bit machine
for ( int* end = big + 20000000; big < end; big+=1024 ) *big = 0xDEADBEEF ;

return 0;
}

// bigmalloc.c 
#include <stdlib.h>

int main(int argc, char **argv) {
int *big = malloc(sizeof(int)*20000000); // allocate 80 million bytes
return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T13:25:31.817

至少对于 32 位 Windows，每个进程都有自己的地址空间副本，2G 用户 2G 内核（由所有进程共享），虚拟内存子系统确保访问同一位置的进程获得其进程的适当数据。这就是一个程序可以具有相同的入口点并多次运行而不踩踏具有相同可执行文件的其他进程正在使用的数据的方式。

应用程序将继续使用更多的虚拟内存，内核将为该进程分配更多的物理内存，直到用完物理内存、交换空间/分页文件。您可以通过系统调用限制进程可以使用的内存。

堆栈和堆几乎总是分配在可用内存的两端，因此堆栈从可用内存的顶部向下增长，而堆从底部向上增长（这个决定取决于架构）。这允许它们单独增长，以便需要大量堆但不需要太多堆的程序可以使用与需要大量堆但不需要太多堆的程序相同的计划。

# css - 如何在不换行的情况下将所有内容浮动到左侧

> ID：10298520
> 
> 赞同：0
> 
> 时间：2012-04-24T13:10:23.183
> 
> 标签：css

我无法让主页上的社交按钮将所有内容浮动到左侧。

一旦我让它浮动，页面中的其他内容就会被弄乱。

这是我使用的代码

```
<div style="position:relative;float:left;margin-right: 10px;">

<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=339021756137381";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<a href="https://twitter.com/share" data-url="<?php the_permalink(); ?>" data-counturl="<?php the_permalink(); ?>" data-text="<?php the_title(); ?>" class="twitter-share-button" data-count="<?php the_permalink(); ?>" data-via="AppleSiam"></a>
<div class="fb-like" data-href="<?php the_permalink(); ?>" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false"></div>
</div> 
```

上面的代码不会对页面中的其他部分造成任何混乱，但按钮将在新行中

![在此处输入图像描述](../Images/4487b7fa18bf277b5af62824317d8fc0.png)

我发现了问题，我会尽快接受答案

`<div class="fb-like" data-href="<?php the_permalink(); ?>" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false"></div>`

如您所见，上面的代码`data-width="450"`设置得太长，无法放在同一行中，它必须转到另一行才能获取所有`450px`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:13:46.790

换句话说，您希望两个按钮位于同一行吗？在这种情况下，您只需要在按钮或它们所在的容器上定义一个宽度，这样它们就可以并排放置。如果他们有空间坐在一起，那么浮动他们不会让他们走上新的路线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:16:55.830

我建议给你`div`an`id`或 a `class`，然后：

```
#idOfDivElement,
.classOfDivElement {
    white-space: nowrap;
} 
```

A`width`也是有道理的。但这将取决于剩余的内容。

# vb6 - 将美元货币符号应用于数据网格视图中的货币价值

> ID：10298524
> 
> 赞同：1
> 
> 时间：2012-04-24T13:10:45.057
> 
> 标签：vb6

我正在尝试更改数据网格视图上的货币符号，这适用于当地货币（欧元）：

```
DBTotalGrid.Columns(9).DefaultCellStyle.Format = "C"
 but I can't change to a dollar sign, the following has no effect:
 DBTotalGrid.Columns(8).DefaultCellStyle.FormatProvider = CultureInfo.GetCultureInfo("c", "us") 
```

由于对单元格的值执行计算，因此我无法格式化为字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T15:25:45.570

您必须以二进制格式打印字符才能将其发送到网格。

只需写字符 $ => Chr(36) => 它会打印 $

您的问题将得到解决。

# javascript - 如何找出分配给 javascript 对象的内存量？

> ID：10298525
> 
> 赞同：7
> 
> 时间：2012-04-24T13:10:50.763
> 
> 标签：javascript, memory-management, memory-leaks

> **可能重复：**
> [JavaScript 对象大小](https://stackoverflow.com/questions/1248302/javascript-object-size)
> [如何测量内存使用和效率？](https://stackoverflow.com/questions/7473307/how-to-measure-memory-usage-and-efficiency)

我想答案可能是“你不能”，但是有没有办法查看在 DOM/javascript 环境中为每个对象分配了多少内存？有哪些工具，它是否因浏览器而异？

如果答案确实是“你不能”，谁能解释为什么不呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:18:28.467

使用 Chrome，您可以使用他们的开发工具（CTRL + SHIFT + I 或 F12）。单击配置文件选项卡，然后按状态栏中的眼球图标。

我的 Safari 和 IE8 版本也有分析工具，但仅用于 CPU，而不是内存使用。

# knockout.js - 使用嵌套的 foreach 导致停止脚本错误的 knockoutJS

> ID：10298527
> 
> 赞同：0
> 
> 时间：2012-04-24T13:11:02.593
> 
> 标签：knockout.js, knockout-mapping-plugin, knockout-2.0

我正在使用 knockout.js 来呈现我的视图，我正在从服务器获取数据并像这样绑定..

```
var viewModel = ko.mapping.fromJS(data);
ko.applyBindings(viewModel, $("#macro-wrapper")[0]); 
```

我的观点......我已经修剪了一些......但绑定是一样的......

```
<div data-bind="foreach: Data">
<h3>
    <a href="#" data-bind="text: Site.Name"></a>
</h3>
<div id="">
    <div data-bind="foreach: Comments">
        <div class="">
            <div class="" data-bind="click: $root.showContent">
            <a ></a>
            </div>
            <span>
                <a data-bind="attr: { 'href': Url }, text: SomeText"></a>
            </span>
            <span class="">
                <span class="" data-bind="text: ADate"></span>
            </span>
        </div>
    </div>
</div> 
```

数据包含一个对象数组，每个对象中都有另一个数组……大约有 500 个项目需要渲染。

虽然我一直在测试，但我没有遇到任何问题，但是在部署时，我不知道它是否是慢速电脑，但他们得到了“这个脚本正在执行慢 - 停止？” 信息。如果您单击“否”几次，它将呈现。

在淘汰赛中处理大数据集的技术是什么？理想情况下，我希望渲染异步完成，让用户在忙于工作时继续他们的事情......

这些属性实际上不需要是可观察的——这是一次渲染……什么都不会改变。为了方便起见，我使用了映射 API。

更新：好的，所以我进行了更改，不再使用映射 api - 页面正在加载，但仍然很慢......有什么想法吗？改变：`var viewModel = data;`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T13:12:45.367

每个元素都会触发 click 事件。这以前发生在我身上。

关于之前发帖人所说的：在一个页面上绑定 500 个元素，之前我不得不在一个页面上绑定 500+ 个元素，而且在更现代的浏览器上性能成本几乎可以忽略不计（您可能会看到 Ie 7- 的速度有所下降） 8，但还不错）。我建议在转换大型 json 对象时不要使用映射插件。KO 映射将每个元素与每个其他元素进行比较（以检查唯一性），因此您可以了解为什么转换 500 个项目会减慢速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T15:42:02.353

我认为从 UI 的角度来看，在页面上显示 500 个项目并不是一个好主意。也许您应该只显示顶级项目并具有“显示评论”链接，并且仅在用户请求时才呈现评论。或者仅使用子项渲染前 X 个顶级项目并具有“显示更多”链接。或者使用上述技术的组合。无论如何，这就是我在我的网站上解决相同问题的计划。

# c# - 为什么我们不能在 Page_Unload 事件上使用 Response.Write？

> ID：10298528
> 
> 赞同：3
> 
> 时间：2012-04-24T13:11:04.323
> 
> 标签：c#, asp.net

我正在使用`Respose.Write`事件 `Page_Unload`，然后我收到错误

> 在这种情况下没有响应。

我可以知道为什么我们不能使用吗？

```
protected void Page_Unload(object sender, System.EventArgs e)
{
  Response.Write(" hi ");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:13:19.640

[来自ASP.NET Page Lifecyle](http://msdn.microsoft.com/en-us/library/ms178472.aspx)上的 MSDN 文章：

> 在卸载阶段，页面及其控件已呈现，因此您无法对响应流进行进一步更改。**如果您尝试调用诸如 Response.Write 方法之类的方法，页面将抛出异常**。

因此，根据文档，您尝试做的实际上是不受支持的。

这在逻辑上是有道理的。当页面被卸载时，浏览器不需要*该页面*的进一步响应。这实际上只是执行清理的地方。

MSDN 上也提到了一些常见的用例：

对于用户控件：

> ...使用此事件对特定控件进行最终清理，例如关闭特定于控件的数据库连接。

对于整个页面：

> ...使用此事件进行最终清理工作，例如关闭打开的文件和数据库连接，或完成日志记录或其他特定于请求的任务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T13:13:26.103

那是因为该`Unload`事件是在页面呈现后触发的。该页面已经完成，在前往浏览器的途中，不再有您可以写入的响应流。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T13:13:44.513

Unload 事件发生在页面被发送回客户端之后。那时写响应为时已晚。

请参阅[ASP.NET 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)文档。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T13:13:16.473

**请记住**- 在卸载阶段，页面及其控件已被呈现，因此您无法对响应流进行进一步更改。如果您尝试调用诸如方法之类的`Response.Write`方法，页面将抛出一个`exception`.

那时页面已经以 HTML 呈现，并且无法修改 HTML。尽管如此，所有页面对象都是可用的。

请参阅[**ASP.NET 页面生命周期**](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-24T13:13:25.037

阅读页面生命周期：http: [//msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

UnLoad 是在渲染之后出现的，所以此时您已经将所有可以输出到屏幕上。

# sql - 使用 PostgreSQL 处理时间

> ID：10298538
> 
> 赞同：4
> 
> 时间：2012-04-24T13:11:31.080
> 
> 标签：sql, postgresql, datetime, time

我有一个带有`date`和`time`字段的表。我很难理解如何处理这个问题，部分原因是我不明白如何将时间转换为数字。我使用以下命令制作了一个表格：

```
CREATE TABLE tracking.time_record
(
  date date, 
  "time" time without time zone,
  id character(100)
) 
```

我的数据示例如下：

```
"2012-04-18" | "18:33:19.612" | "2342342384" 
```

例如，如何运行查询以检查在某一天`id`具有时间值的所有值？`> 10 pm`

我意识到，由于我的时间存储在字符类型变量中，所以这样的事情不起作用：

```
SELECT * FROM tracking.time_record 
WHERE "time" > "04:33:38.884" AND date > "2012-04-18" 
```

（这是我对时间/日期跟踪的第一次探索——我可能应该选择不同的列名）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T05:53:21.290

到目前为止，这两个答案都没有捕捉到您的实际问题。

虽然显式强制转换为适当的类型肯定不会有什么坏处，但也*没有必要*。PostgreSQL 自动将字符串文字强制转换为适当的类型。

您的问题源于基本语法错误：
**双引号**用于**标识符**：`"MyColumn"`- 并且仅对其他非法标识符（混合大小写，保留字，..）是必需的，应该避免开始。
**单引号**用于**值**: `'string literal'`。

您可能对PostgreSQL 手册中关于[**标识符**](http://www.postgresql.org/docs/current/interactive/sql-syntax-lexical.html#SQL-SYNTAX-IDENTIFIERS)和[**常量的精心编写的章节感兴趣。**](http://www.postgresql.org/docs/current/interactive/sql-syntax-lexical.html#SQL-SYNTAX-CONSTANTS)

当我们这样做时，*永远不要*使用`date`or`time`作为列名。两者都是每个 SQL 标准中的[保留字](http://www.postgresql.org/docs/current/interactive/sql-keywords-appendix.html)和 PostgreSQL 中的类型名称。这将导致混淆代码和错误消息。

我建议只使用单个`timestamp`列而不是单独的`date`and ：而且您*几乎*`time`肯定不希望`character(100)`用作数据类型，尤其是对于列。这种空白填充类型基本上只是出于历史原因。考虑或代替：*`id``text``varchar`*

 **   [使用数据类型“文本”存储字符串有什么缺点吗？](https://stackoverflow.com/questions/20326892/any-downsides-of-using-data-type-text-for-storing-strings/20334221#20334221)

可能看起来像这样：

```
CREATE TABLE tbl (
   tbl_id text CHECK(length(id) <= 100)
 , ts timestamp
); 
```

投射到`time`或`date`只需要这些组件的地方，它既短又便宜：

```
SELECT ts::time AS the_time, ts::date AS the_date FROM tbl; 
```

使用[`date_trunc()`](http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC)或[`extract()`](http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-EXTRACT)用于更具体的需求。
要查询*在某一天的时间值 > 10 pm 的 ... id 值*：

```
SELECT *
FROM   tbl
WHERE  ts::time > '22:00'
AND    ts::date = '2012-04-18'; 
```

或者，对于任何连续的时间段：

```
...
WHERE  ts > '2012-04-18 22:00'::timestamp
AND    ts < '2012-04-19 00:00'::timestamp; 
```

第二种形式可以`ts`更好地使用普通索引，并且在这种情况下对于大表会更快。

`timestamp`有关在 PostgreSQL 中处理的更多信息：

*   [在 Rails 和 PostgreSQL 中完全忽略时区](https://stackoverflow.com/questions/9571392/ignoring-timezones-altogether-in-rails-and-postgresql/9576170#9576170)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T13:26:54.067

您可以使用[date_part](http://www.postgresql.org/docs/8.0/static/functions-datetime.html)函数来获取小时

```
select id 
from tracking.time_record
where date_part('hour', time) >= 22
  and date = '2012-04-18' 
```

>= 22 而不是 > 22 是为了捕捉晚上 10 点到 11 点之间的间隔。这也捕获了晚上 10:00:00。但调整查询以捕捉正确的间隔并不难

[您在这里](http://sqlfiddle.com/#!1/92d52/1)有一个工作示例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T13:36:46.040

比较时间和日期值在 postgresql 中应该可以正常工作，只需确保将字符串转换为适当的类型：

```
SELECT * FROM tracking.time_record 
WHERE "time" > time '04:33:38.884' AND "date" > date '2012-04-18' 
```*

# objective-c - 使用核心数据创建用户配置文件/帐户

> ID：10298539
> 
> 赞同：0
> 
> 时间：2012-04-24T13:11:31.310
> 
> 标签：objective-c, ios, xcode, core-data, data-modeling

我正在创建一个具有添加两个配置文件/帐户功能的应用程序。每个配置文件都会有与之相关的数据，我目前正在使用核心数据进行管理。我的 CD 模型只有两个实体，“婴儿”有一个“生日”和“名字”，“照片”只有二进制数据来存储照片。数据将包含大约 100 到 200 张带有相关文本和日期值的照片。

我有两个关于我应该如何处理的问题：

1.  随着我可能拥有的数据量，核心数据是前进的方向。如果不是，那么我最好的选择是什么。

2.  您能否给我一些提示，说明我应该如何创建和管理用户配置文件/帐户。就像找出配置文件是否存在然后显示它而不是显示加号按钮的最佳方法是什么？

任何帮助都会很棒，即使只是为了让我朝着正确的方向前进。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:39:24.077

Core Data 确实是您的一种方式，它可以完美地处理更多的数据。

如果我理解正确，并且配置文件是**Baby**实体的实例，您可以获取该实体并计算对象的数量 - 如果它只有一个 - 显示添加按钮。如果有其他方式持有这两个账户，请说得更清楚一点。

# ruby-on-rails - 如何表示以下rails模型/ assocs

> ID：10298540
> 
> 赞同：0
> 
> 时间：2012-04-24T13:11:38.897
> 
> 标签：ruby-on-rails, associations

我有以下型号：

*   客户#这些代表第 3 方实体

*   GroupCo #集团内的个别公司

*   供应商#这些是第 3 方实体。

*   发票#这可能是以下之一：GroupCo 到客户、GroupCo 到其他 GroupCo、供应商到 GroupCo

在正常情况下，我只会有一个 ClientInv 模型和一个 SupplierInv 模型，具体取决于发票是给客户还是来自供应商。这里出现的问题是 GroupCo 向另一个 GroupCo 开票的地方。在这种情况下，第一个 GroupCo 充当供应商，第二个充当客户，我需要为每个 GroupCo 保留一个发票序列，无论他们是向客户还是其他 GroupCo 开票......所以这就是为什么我认为我不能拆分我的发票模型。

这不是一个特别不寻常的情况，所以我希望有人已经这样做了。

目前我对任何/所有建议持开放态度，如有必要，包括完全不同的模型。

我在 Rails 3.2.1 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:30:30.057

您所描述的问题，`GroupCo`通常可以通过继承解决发票和客户的问题。`Client`需要继承自`Company`，`GroupCo`需要继承自`Company`。然后您可以向 a 发送发票`Company`，然后系统不在乎您是在谈论 a`GroupCo`还是`Client`。

然而，给你一个具体的答案会很困难，因为看起来你还没有真正理解开票的领域问题。例如，您在谈论`ClientInv`模型时，`SupplierInv`模型让我认为您完全错误地处理了这个问题。

它们都是发票，只是系统的发票和系统的发票。但它们都是发票。您将不得不尽快处理信用票据和采购订单以及与发票相关的所有其他有趣的事情，您不想重复所有内容。

我还强烈建议您停止缩短您的类名称，这对于大型企业应用程序来说是一个坏习惯。称其为`GroupCompany`现状。和`SupplierInvoice`。和`ClientInvoice`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:52:17.203

马特的建议帮助我解决了这个问题。请记住，我对多态发票的主要问题是作为客户和供应商从 GroupCo 获得发票。所以我就是这样做的。

发票具有以下属性：

invclient_type

invclient_id

invsupp_type

invsupp_id

* * *

发票有以下关联

属于_to：invclient，多态：true

属于_to：invsupp，多态：true

* * *

GroupCo 有以下协会

has_many :clientinvoices, class_name: :Invoice, as: :invclient

has_many :suppinvoices, class_name: :Invoice, as: :invsupp

* * *

有了上述内容，我可以使用 GroupCo (gco) 的实例执行以下操作

gco.clientinvoices
gco.suppinvoices

并使用 Invoice (inv) 的实例，我可以照常前往 belongs_to

inv.invclient 获取发票的客户
inv.invsupp 获取发票的供应商

# mysql - sphinx 搜索部分关键字匹配

> ID：10298542
> 
> 赞同：1
> 
> 时间：2012-04-24T13:11:58.943
> 
> 标签：mysql, full-text-search, sphinx, thinking-sphinx, partial

**Ruby on Rails -> ThinkingSphinx -> SphinxSearch -> Mysql**

我想搜索标题表。预期的用户关键字不会完全匹配，而是部分匹配。

```
search_key = "android samsung galaxy ace black phones" 
```

搜索titles表，

**标题（表）**

## 编号 | 标题

*1 | 诺基亚c6
2 | 三星银河王牌
3 | 三星galaxy ace y
4 诺基亚 lumia 800
5 | 三星monte
6 | 三星银河笔记*

**情况1 ：**

```
Title.search search_key, :match_mode => :all

=>No results 
```

*评论：不好*

**案例-2：**

```
Title.search search_key, :match_mode => :any

=>[samsung galaxy ace, samsung galaxy ace y, samsung monte, samsung galaxy note] 
```

*评论：好的，但不相关，用户只想要她在关键字中明确指定的“三星银河王牌”。为什么要显示其他三星手机？*

**案例-3：**

```
Title.search 'search_key/3',:match_mode => :extended

=> samsung galaxy ace 
```

*评论：宾果游戏！，但硬编码。*

## 问题：

*现在，我应该知道有多少个关键字会在titles 表中得到完全匹配。（例如，“android samsung Galaxy ace 黑色手机”中的“samsung Galaxy ace”的 3）*

**我该如何解决这个问题？狮身人面像处理这个？如果不是怎么办？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:52:44.357

一种方法是将字数作为属性存储在 sphinx 索引中。

sql_field_str2wordcount 是执行此操作的好方法 [http://sphinxsearch.com/docs/current.html#conf-sql-field-str2wordcount](http://sphinxsearch.com/docs/current.html#conf-sql-field-str2wordcount)

然后，您可以将其用作过滤器的基础

```
$cl->setMatchMode(SPH_MATCH_EXTENDED);
$cl->setRankingMode(SPH_RANK_WORDCOUNT);
$cl->setSelect("*,IF(@weight=>titles,1,0) as myfilter");
$cl->setFilter("myfilter",array(1));
$cl->Query("\"$search_key\"/1",'Title'); 
```

（抱歉，在thinking-sphinx中不知道怎么做。以上是PHP API语法）

* * *

编辑，检查[http://freelancing-god.github.com/ts/en/searching.html](http://freelancing-god.github.com/ts/en/searching.html)和[http://freelancing-god.github.com/ts/en/common_issues.html#or_attributes](http://freelancing-god.github.com/ts/en/common_issues.html#or_attributes)

看起来可能是

```
with_display = "*, IF(@weight=>titles,1,0) AS display"
Title.search 'search_key/3',
  :match_mode => :extended,
  :rank_mode => :wordcount,
  :sphinx_select => with_display,
  :with          => {'display' => 1} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T17:37:47.907

## 找到答案

如果您安装 Sphinx 2.0.4-dev (rel20-r3193)，这将有效。

按照这个链接，

[http://sphinxsearch.com/forum/view.html?id=9387](http://sphinxsearch.com/forum/view.html?id=9387)

**Barry Hunter 先生，非常感谢您的支持。**

# jquery - Safari (Mac) 上的无限 AJAX 请求

> ID：10298544
> 
> 赞同：0
> 
> 时间：2012-04-24T13:12:03.433
> 
> 标签：jquery, safari

我需要一些帮助来调试在所有 Win 浏览器（包括 Safari）上运行良好但在 Mac 版本的 Safari 上运行良好的 JS。

在我的一个站点上有一个使用 jQuery 模式窗口和 AJAX 请求的登录屏幕。我收到的投诉是 Safari 上的登录请求没有完成（即“加载”图像永远不会消失并且用户没有登录）。

请求本身是一个简单的 $.post ，它接受用户的登录并基本上返回 true 或 false。

URL 是[http://i-marbella.com/](http://i-marbella.com/)（登录在右上角附近）。

所以我的问题是：有人可以确认这个错误吗？如果是这样，是否有任何可能导致这种情况的 JS 错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:19:30.237

我假设您正在全局或按请求绑定 ajaxStart 和 ajaxStop 方法。我唯一一次遇到加载对话框不消失的问题是当我将一些数据返回到页面并且它有问题时。

当我尝试将 html 从 ajax 请求附加到 div 时，我得到了很多这样的结果，而我返回的 html 要么格式错误，要么引用页面中未包含的 css 类，甚至未包含 js 函数。其他时候它发生了，我的 json 格式不正确等等等等。

每次这种情况发生在我身上时，我发送到服务器的数据或我从服务器返回的数据都会出现错误。

# c# - Silverlight 对象未在 Firefox 中显示

> ID：10298548
> 
> 赞同：0
> 
> 时间：2012-04-24T13:12:25.770
> 
> 标签：c#, silverlight, firefox

我已经检查了这个问题：

[Firefox 和 Silverlight](https://stackoverflow.com/questions/1448898/firefox-and-silverlight)

但我没有使用任何 100% 的宽度或高度，也没有使用动态值。我不确定这是否是由于 FF 更新，因为那段 HTML 工作得非常好~ 2 周前。

我直接在上面指定宽度和高度：

```
<div id="silverlightControlHost" 
     style="height: 200px !important;width: 300px !important;position: fixed !important;">
  <object data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="300" height="200">
    <param name="source" value="/ClientBin/BunkerTimer.xap"/>
    <param name="onError" value="onSilverlightError" />
    <param name="minRuntimeVersion" value="5.0.61118.0" />
    <param name="autoUpgrade" value="true" />
    <a href="http://go.microsoft.com/fwlink/?LinkID=149156&v=5.0.61118.0" style="text-decoration:none">
    <img src="http://go.microsoft.com/fwlink/?LinkId=161376" alt="Get Microsoft Silverlight" style="border-style:none;width: 400px !important;"/>
    </a>
</object><iframe id="_sl_historyFrame" style="visibility:hidden;height:0px;width:0px;border:0px"></iframe>
</div> 
```

我能够添加一个`background-color`并且我正确地看到它，它只是没有加载的 Silverlight 对象。

你可以在这里查看它[http://www.bunkerapp.com/addons](http://www.bunkerapp.com/addons)。这在 Safari、Chrome 和 Internet Explorer 中运行良好。

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T13:25:00.220

我解决了这个问题，添加了由 Site.Master 或 _Layout.cshtml 中的 silverlight 测试页面生成的 css 样式。

```
<style type="text/css">
    html, body {
        height: 100%;
        overflow: auto;
    }
    body {
        padding: 0;
        margin: 0;
    }
    #silverlightControlHost {
        height: 100%;
        text-align:center;
    }
</style> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:22:27.207

似乎在 Firefox 中， 的`object`高度为 0；

我通过向对象元素添加内联样式属性来使其工作：

```
style="width:300px;height:200px" 
```

# google-maps-api-3 - 我如何获得绘图坐标？

> ID：10298549
> 
> 赞同：9
> 
> 时间：2012-04-24T13:12:26.120
> 
> 标签：google-maps-api-3

伙计们，

我有这个代码[https://gist.github.com/2473387](https://gist.github.com/2473387)

但是，我如何获得绘制的多边形的坐标？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-24T18:09:49.083

我建议在[DrawingManager](https://developers.google.com/maps/documentation/javascript/reference#DrawingManager)上添加 'polygoncomplete' 侦听器并从多边形[MVCArray](https://developers.google.com/maps/documentation/javascript/reference#MVCArray)获取坐标。

```
google.maps.event.addListener(drawingManager, 'polygoncomplete', function (polygon) {
    var coordinates = (polygon.getPath().getArray());
    console.log(coordinates);
}); 
```

# c++ - 将 uint8_t* 转换为 char* 以用于 QIODevice

> ID：10298550
> 
> 赞同：1
> 
> 时间：2012-04-24T13:12:26.597
> 
> 标签：c++, qt, pointers, io, buffer

我正在修改[Qt 音频输出示例](http://doc.qt.nokia.com/4.7-snapshot/multimedia-audiooutput.html)，如下所示：

*   我可以从第三方访问混音器 API。
*   从这个混音器读取数据的方法是`void AudioMixer::ReadData(uint8_t *stream, uint32_t len);`
*   我正在更改以在示例中输出此数据的功能是`qint64 Generator::readData(char *data, qint64 len)`

如果我的理解是正确的，我应该能够`QIODevice`通过覆盖`Generator::readData`方法以调用该`AudioMixer::ReadData`方法并将`uint8_t*`使用的方法`AudioMixer`转换`char*`为与`QIODevice`.

我认为这是可能的吗？如果是这样，有人可以建议如何进行演员表吗？如果没有，您能否解释一下如何`uint8_t*`使用 a输出`QIODevice`？

为了完整起见，方法是：

```
void AudioMixer::ReadData(uint8_t *stream, uint32_t len)
{   
    if(buffer.GetMaximumReadSize() < len)
    {
        memset(stream, 0, len);
    }
    else
    {
        buffer.Read(stream, len);
    }
} 
```

和

```
qint64 Generator::readData(char *data, qint64 len)
{
    qint64 total = 0;
    while (len - total > 0) {
        const qint64 chunk = qMin((m_buffer.size() - m_pos), len - total);
        memcpy(data + total, m_buffer.constData() + m_pos, chunk);
        m_pos = (m_pos + chunk) % m_buffer.size();
        total += chunk;

        // Need to call AudioMixer::readData in here
    }
    return total;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T16:07:43.543

在 C++ 中没有表示“字节”的本机类型，只能`char`保证恰好保存一个字节。表示原始二进制数据的字节类型是否应该签名存在不同的意见，因此有些使用`unsigned char`( `uint8_t`) ，有些使用 plain `char`。最后，这并不重要，因为您通常不对二进制数据执行算术运算，而只是读取和解释它。

因此，您可以只使用类型转换在不同的二进制数据表示之间进行转换。由于这是 C++，您应该使用`reinterpret_cast`（支持 C 风格的强制转换）：

```
char* dst = reinterpret_cast<char*>(/* your uint8_t* expression */); 
```

是否使用`reinterpret_cast`或 C 风格的演员表显然是有争议的。C++ 的创造者 Bjarne Stroustrup[肯定会提倡 .`reinterpret_cast`](http://www.stroustrup.com/devXinterview.html)，但其他人不喜欢它，这没关系。

# vb.net - 在 ListView 中使单元格可编辑

> ID：10298551
> 
> 赞同：0
> 
> 时间：2012-04-24T13:12:28.453
> 
> 标签：vb.net, visual-studio-2010, listview

我坐在一个 VB 项目中，我有一个带有 3 个单元的 ListView；一个复选框、一个名称和另一个文本值。我希望最后一个单元格可供用户编辑。第二个单元格也可以编辑，完全没有问题。

如何将单元格设置为可编辑？

现在我有这个代码来填充列表框：

```
Dim row(3) As String
Dim itm As ListViewItem
Dim txtbox As New TextBox

row(0) = ""
row(1) = "some value"
row(2) = "0"

itm = New ListViewItem(row)
itm.SubItems.Add("txtbox")

ListView1.Items.Add(itm 
```

任何提示如何让用户更改最后一个（或第二个和最后一个）单元格？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T13:20:02.200

Winforms ListView 控件不能像 DataGrid 一样使用。
只有第一个项目可以通过设置属性 LabelEdit=True 进行编辑。

如果您真的希望能够在详细模式下编辑 ListView 的任何“单元格”，您有两种可能性：

*   切换到数据网格
*   使用网络上免费提供的众多扩展之一（可以[在此处找到](http://www.codeproject.com/Articles/6646/In-place-editing-of-ListView-subitems)示例）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-22T16:02:43.840

您不能编辑列表视图中的特定行，但可以删除，然后重新添加值。不幸的是，我不知道如何将多个单元格添加到同一行，但知道如何在列表视图控件中删除和添加单个列单元格。也许这可能是一个开始。

```
Dim item As ListViewItem = ListView1.SelectedItems(0)
Dim intIndex As Integer = item.Index

item.Remove()
ListView1.Items.Insert(intIndex, "New Text") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-03T10:20:45.597

编辑单元格有技巧。您必须创建偏移文本框并将其放在要编辑的单元格的位置（命中测试，设置位置和大小）。

```
Dim iRow, iCol as Integer

Private Sub TextOverlay_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)
        ListView1.Items(iRow).SubItems(iCol).Text = TextOverlay.Text
End Sub

Private Sub ListView1_Click(ByVal sender As System.Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles ListView1.MouseClick
        Dim hit As ListViewHitTestInfo = ListView1.HitTest(e.X, e.Y)
        Dim iWidth As Integer
        For iCol = 0 To hit.Item.SubItems.Count - 1
            If hit.Item.SubItems(iCol).Bounds.Left <= e.X Then
                If iCol = 0 And hit.Item.SubItems.Count > 1 Then
                    If e.X <= hit.Item.SubItems(1).Bounds.Left Then
                        iWidth = hit.Item.SubItems(1).Bounds.Left
                        Exit For
                    End If
                ElseIf e.X <= hit.Item.SubItems(iCol).Bounds.Right Then
                    iWidth = hit.Item.SubItems(iCol).Bounds.Width
                    Exit For
                End If
            End If
        Next
        iRow = hit.Item.Index
        TextOverlay.Left = ListView1.Left + hit.SubItem.Bounds.Left + 3
        TextOverlay.Top = ListView1.Top + hit.SubItem.Bounds.Top
        TextOverlay.Width = iWidth
        TextOverlay.Height = 18
        TextOverlay.Text = hit.SubItem.Text
        TextOverlay.Visible = True
        TextOverlay.ReadOnly = False
End Sub
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-30T07:26:55.500

有办法获取当前选定的项目，然后在 ListViewItem 上使用 BeginEdit() 调用。调度更改： ListView.AfterLabelEdit 事件

# php - 无法更新表存储触发器，它已被调用此存储函数/触发器的语句使用

> ID：10298552
> 
> 赞同：0
> 
> 时间：2012-04-24T13:12:32.947
> 
> 标签：php, mysql, triggers

我有一个保存用户信息的用户表，每次用户看到一个页面时，它的 last_activity 列都会更新。

```
 public function set_last_activity(){
    global $db;
    $t = time();
    $sql = "UPDATE `users` SET `last_activity` = '$t'
    WHERE 
   `id` = '$this->id'  ";
   $db->query($sql);   
   } 
```

每个用户可以有 3 种类型 1 - 雇员或简称 ee 2 - 雇主或 er 3 - 两种类型

和状态字段是： 0：禁止，不活跃 1：活跃

现在我有触发器，它正在处理用户计数器

（ee_counter 用于雇员 [type:1,3] ，er_counter 用于雇主 [type:2,3]）

在 stats 表中，当用户更改其状态时（0：禁止，1：活动），并且如果用户是雇员，它也会更新专业计数器

```
DELIMITER $$
CREATE TRIGGER user_status_change
  AFTER UPDATE
  ON users
  FOR EACH ROW
BEGIN
  UPDATE stats s 

 SET

    ee_counter =
      CASE 

        WHEN  (NEW.type= 1 || NEW.type= 3 )   && OLD.status !=1 && NEW.status  = 1  THEN ee_counter + 1
        WHEN  (NEW.type= 1 || NEW.type= 3 )   && OLD.status = 1 && NEW.status != 1  THEN ee_counter - 1

        WHEN  NEW.type= 3  && OLD.type  = 2   THEN ee_counter + 1
        WHEN  OLD.type= 1  && NEW.type  = 2   THEN ee_counter - 1
        ELSE ee_counter 
      END ,

    er_counter =
      CASE 
        WHEN  (NEW.type= 2 || NEW.type= 3 )   && OLD.status !=1 && NEW.status  = 1  THEN er_counter + 1
        WHEN  (NEW.type= 2 || NEW.type= 3 )   && OLD.status = 1 && NEW.status != 1  THEN er_counter - 1

        WHEN  NEW.type= 3  && OLD.type = 1   THEN er_counter + 1
        WHEN  OLD.type= 2  && NEW.type = 1   THEN er_counter - 1
        ELSE er_counter 
      END 

  WHERE
    s.id = 1;

  UPDATE specialitys s 
JOIN speciality_objects o
      ON s.id = o.speciality_id
    JOIN users u
      ON o.user_id = u.id
 SET
    counter =
      CASE 
        WHEN  NEW.status = 1  && OLD.status !=1 THEN counter + 1
        WHEN  NEW.status != 1 && OLD.status = 1 THEN counter - 1
         ELSE counter 
      END 

  WHERE
  o.user_id = NEW.id &&  s.id = o.speciality_id ;

END $$

DELIMITER ; 
```

在我更换主机并购买了一个 vps 之前，它曾经工作正常

不，我不断收到此错误

```
Database query failed: Can't update table 'users' in stored function/trigger because it is already used by statement which invoked this stored function/trigger. 
```

在我更新 last_activity 时的每一页上

我尝试使用 BEFORE UPDATE ，因为有些人建议它不起作用仍然出现此错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:05:02.133

我认为这个错误是由`UPDATE`触发器中最后一个查询的一部分引起的，无论如何都是毫无意义的。

由于查询的这一部分，错误消息正在抱怨：

```
JOIN users u
  ON o.user_id = u.id 
```

...您已将`JOIN`触发器附加到的表编辑到触发器`UPDATE`内的查询中。MySQL 正确地发现这可能导致递归并抛出错误。

但是，您应该能够简单地删除该部分查询。别名`u`不在任何地方使用，因此`JOIN`不需要。我认为这将解决问题。

# c# - 列表框多选项目到顶部

> ID：10298559
> 
> 赞同：0
> 
> 时间：2012-04-24T13:12:49.020
> 
> 标签：c#, asp.net, listbox

我正在使用带有多选控件的列表框。现在列表框中有 200 个名称。假设我选择员工号 50、76、34、65、95 等。首先选择 50 并按住 ctrl 键，然后选择 76 表示它转到名字的顶部。我在带有触发器的更新面板中有列表框。但它会为每个选择发回。请帮助我修复此错误...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:19:52.220

如果您将其设置`ListBox.AutoPostback`为 false，它会按照您的意愿行事吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:34:52.777

您的列表框放置在带有触发器的更新面板内。它不会为每个选择回发，它会因触发而回发。您可以通过设置触发器之间的长持续时间来选择多个项目。

# tomcat - 无法在 Windows 7 平台上启动我的 Apache Tomcat Server 6

> ID：10298560
> 
> 赞同：0
> 
> 时间：2012-04-24T13:12:49.973
> 
> 标签：tomcat, windows-7

我无法在 Windows 7 32 位平台上启动 Apache Tomcat 服务器 6。我已安装 JDK 1.7.0。尝试这样做时，它会显示以下错误消息：

“Windows 无法在本地计算机上启动 Apache Tomcat 6。有关详细信息，请查看系统事件日志。请参阅服务器特定错误代码 0”

当我尝试启动服务表单“服务（本地）”时，它说：

“Windows 无法在本地计算机上启动 Apache Tomcat。有关更多信息，请查看系统 Evert 日志。如果这是一项非 Microsoft 服务，请联系服务供应商，并参阅特定于服务的错误代码 0”

当浏览日志文件时，它会说：

“[174 javajni.c] [错误] 找不到指定的模块。”

我已经多次卸载并重新安装了Tomcat服务器，但问题仍然存在。请帮忙。高拉夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-05T08:10:58.137

这也有效！

cd C:\Program Files\Apache Software Foundation\Tomcat 6.0\bin>Tomcat6

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T16:39:20.200

用较早版本的JDK试试（1.6.x应该兼容）

# c# - 如何查找转发器的标签值（数据库列）并更改 repeater_ItemDataBound 事件的文本

> ID：10298563
> 
> 赞同：0
> 
> 时间：2012-04-24T13:12:59.707
> 
> 标签：c#, asp.net

这是我在中继器标签中显示的数据库值“2012/04/24”我必须在中继器标签中显示像 2012 年 4 月 12 日这样的数据库值。在 repeater_ItemDataBound 事件上我该怎么做。

```
<td class="csstablelisttd">
   <asp:Label ID="lblPatientsBirthDate" runat="server" Text='<%#Eval("Patients_Birth_Date")%>'></asp:Label>td>  
  protected void repeaterPatientList_ItemDataBound(object sender, RepeaterItemEventArgs e)
    {

        Label lblbirthDate = (Label)e.Item.FindControl("lblPatientsBirthDate");

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:17:59.130

要将日期格式化为特定格式，可以通过以下方式完成：

```
<asp:Label ID="lblPatientsBirthDate" runat="server" Text='<%# Eval("Patients_Birth_Date", "{0:dd-MMM-yyyy}")%>' </asp:Label> 
```

您需要更改 repeater_ItemDataBound 事件的文本。

希望这会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:28:06.527

试试这个：

```
protected void repeaterPatientList_ItemDataBound(object sender, RepeaterItemEventArgs e)
    {

        Label lblbirthDate = (Label)e.Item.FindControl("lblPatientsBirthDate");
        if(lblbirthDate!= null)
        {
           DateTime d = DateTime.Parse(lblbirthDate.Text);
           lblbirthDate.Text = d.ToString("dd-MMM-yyyy");
        }
    } 
```

如果日期转换导致错误，则遵循[DateTime.ParseExact 方法](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx#Y1596) 和[自定义日期和时间格式字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

# raphael - 可以运行的 Raphael 可点击路径，例如 fancybox

> ID：10298574
> 
> 赞同：1
> 
> 时间：2012-04-24T13:13:30.690
> 
> 标签：raphael

嗨，我正在使用 Raphael 中的路径，我想知道如何使该路径可点击，点击后让 fancybox 启动

我自己的路：

```
paper.path("M172.25,647 L381.75,640.75 L422,641.75 L422,665 L415.75,679.5 L402.75,679.5 L401.25,667 L393.751,665 L363.625,665 L352.005,671.673 L346,673 L338.625,677 L172.25,672.5 Z").attr({"fill":"white", "stroke-width": 0, "fill-opacity": .4}).mouseover(
        function () {
                this.animate({"fill-opacity": .8}, 600);
            }).mouseout(function () {
                this.animate({"fill-opacity": .4}, 600);
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:07:58.057

你大部分时间都在。只需添加一个 .click 函数即可。试试[这里的例子](http://jsfiddle.net/amadanNM/7n77v/)

# android - 从 xml listview 中删除滚动

> ID：10298581
> 
> 赞同：0
> 
> 时间：2012-04-24T13:13:50.987
> 
> 标签：android, xml

我目前在 1 页上有 5 个列表视图，每个视图都显示在一周中的几天过滤的数据库元素，周一，周二，周三等...当每个列表中只有 1 个元素但当我将多个元素添加到列表时看起来很好它设置了一个滚动而不是仅仅扩展列表。我目前已经在使用滚动视图，因此列表的滚动不起作用。如何更改列表视图以删除滚动？

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:background="@color/background"
android:layout_height="fill_parent"
android:layout_width="fill_parent"
android:padding="5dip"
android:orientation="horizontal"
android:paddingTop="5dip"
android:paddingBottom="5dip"
>
    <LinearLayout
    android:orientation="vertical"
    android:layout_height="fill_parent"
    android:layout_width="fill_parent">
    <TextView
        android:id="@+id/view_timetable_content"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/view_timetable_text"
        android:textColor="@color/text"
        android:textSize="30dip"
        android:layout_gravity="center"
        android:textStyle="italic"
        />
    <TextView
        android:id="@+id/text"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:textColor="@color/text"
        />  
        <TextView
        android:id="@+id/day"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Monday"
        android:textColor="@color/text"
        />
        <ListView
        android:id="@+id/mylist"
        android:layout_height="fill_parent"
        android:layout_width="fill_parent"
            android:layout_weight="1">
            </ListView>
        <TextView
        android:id="@+id/day"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Tuesday"
        android:textColor="@color/text"
        />
    <ListView
        android:id="@+id/mylist2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>
    <TextView
        android:id="@+id/day"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Wednesday"
        android:textColor="@color/text"
        />
    <ListView
        android:id="@+id/mylist3"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>
    <TextView
        android:id="@+id/day"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Thursday"
        android:textColor="@color/text"
        />
    <ListView
        android:id="@+id/mylist4"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>
    <TextView
        android:id="@+id/day"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Friday"
        android:textColor="@color/text"
        />
    <ListView
        android:id="@+id/mylist5"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>
    </LinearLayout>
    </ScrollView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:18:31.530

您需要为您在 xml 中使用过的Every使用`TableLayout`or 。[点击这里](https://stackoverflow.com/questions/6210895/listview-inside-scrollview-is-not-scrolling-on-android)`LinearLayout``ListView``ListView``ScrollView`

# glassfish-3 - 在 glassFish 中部署应用程序后出现错误

> ID：10298585
> 
> 赞同：6
> 
> 时间：2012-04-24T13:14:09.143
> 
> 标签：glassfish-3

我刚刚为玻璃鱼部署了一个应用程序。我做了什么，我做了一个目录结构。HelloWorld->index.jsp、WEB-INF->sun-web.xml、web.xml。我的 index.jsp 只是一个打印 HelloWorld 的页面

```
<%@page contentType="text/html"%>
<%@page pageEncoding="UTF-8"%>
<html>
    <head>
        <title>Hello World! Page</title>
    </head>
    <body>
        <h1>Hello World!</h1>
    </body>
</html> 
```

然后我转到 HelloWorld 目录并发出以下命令

```
jar cvf helloworld.war . 
```

战争文件已创建。然后我使用管理控制台将应用程序部署到 GlassFish。在上下文中我写了/HelloWorld。但后来我尝试使用 [http://localhost:8080/HelloWorld/打开应用程序](http://localhost:8080/HelloWorld/)

然后我得到了错误

```
type Exception report
message
descriptionThe server encountered an internal error () that prevented it from fulfilling this request.
exception

org.apache.jasper.JasperException: PWC6345: There is an error in invoking javac.  A full JDK (not just JRE) is required 
```

我的路径环境设置为

```
;C:\Program Files\Java\jdk1.6.0_06\bin;C:\Program Files\glassfish-3.0.1\bin; 
```

我的类路径上有 java，为什么会出现此错误？我正在使用 Windows 7。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T19:05:07.297

不知何故，glassfish 正在您的机器上安装另一个 JRE。尝试设置 AS_JAVA 环境变量：[http ://www.java.net/node/702274](http://www.java.net/node/702274)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-10T12:43:57.253

只需指定不带空格的路径。

首先创建一个符号链接

```
mklink /D c:\as_java C:\Program Files\Java\jdk1.6.0_06\ 
```

并创建环境变量 AS_JAVA 并将其设置为 c:\as_java

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-06T08:39:19.263

转到 GFdirectory/bin/asadmin.bat 文件，并手动替换所有出现的

```
set JAVA=<...> 
```

和

```
set JAVA="<absolute_java_path>\bin\java" 
```

硬编码总是 100% 有效 =)

# mysql - 如何跳过 MySQL 中的空白数据？

> ID：10298586
> 
> 赞同：6
> 
> 时间：2012-04-24T13:14:14.093
> 
> 标签：mysql, null

我想跳过 MySQL 中的空白数据。

我的示例查询是：

```
SELECT id, name, date from sample where name IS NOT NULL; 
```

样品表：

```
id     name         date
1                  24-04-2012
2      abc         23-04-2012 
```

现在，如果我触发上述查询，它会给我两个记录，但我想跳过存储为空白的数据，即什么都没有（**甚至没有 NULL**）？

那么我怎样才能跳过第一条记录呢？我的查询应该是什么？

**那么如何跳过 MySQL 中的空白数据呢？**

请指导我。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-24T13:16:00.547

您可以使用以下方法从结果中消除`NULL`空字符串和空字符串：

```
 where name IS NOT NULL AND name <> ''
                        ^^^^^^^^^^^^^^ add this 
```

演示：[http ://www.sqlfiddle.com/#!2/1155a/6](http://www.sqlfiddle.com/#!2/1155a/6)

**编辑**：正如评论中指出的那样，`trim`甚至没有必要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:29:17.470

这个问题已经被 mellamokb 解决了，但是在这里我提出了一个基于[“如何检查参数是 null 还是空 sql”](https://stackoverflow.com/questions/9855331/how-to-check-if-a-parameter-is-null-or-empty-sql)和[NULLIF MySQL 函数](http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html#function_nullif)的单向步骤：

```
where  nullif( trim(name) , '') is NULL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:18:27.537

```
SELECT id, name, date from sample where trim(name) 
```

# jquery - 使用 jQuery 将代码渲染到 MVC 视图中

> ID：10298587
> 
> 赞同：0
> 
> 时间：2012-04-24T13:14:25.353
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3, model-view-controller

我有一个字符串以字符串的形式到达我的控制器。它是一个具有以下元素模板的 List(Model.ToParticipantList)：

```
string.Format("<li id=\"Id_{0}" style=\"font-weight: bold; margin-top: 1px; list-style-type: none; display: inline; margin-bottom: 3px; cursor: pointer; font-size: 11px; color: Black; padding-top: 1px; padding-bottom: 1px; margin-left: 2px; width: 150px;\" 
onclick=\"RemFromList('{0}__#{2}');\">
<a>{1}</a>
</li>,", el.Id, el.Name, "To")); 
```

我希望将其传递给我的 jQuery 函数并产生以下结果：

```
<li id="Id_1" style="font-weight: bold; margin-top: 1px; list-style-type: none; display: inline; margin-bottom: 3px; cursor: pointer; font-size: 11px; color: Black; padding-top: 1px; padding-bottom: 1px; margin-left: 2px; width: 150px;" onclick="RemFromList('1__#To');">
<a>System System</a>
</li> 
```

这有效：

```
 document.getElementById('To1').innerHTML=@Html.Raw(Model.ToParticipantList);  //this works 
          // $("#To1").html('@Html.Raw(Model.ToParticipantList)');  //this doesn't 
          // $("#To1").append('@Html.Raw(Model.ToParticipantList)'); //this doesn't 
```

在最后两个示例中我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T18:17:55.457

任何插入 HTML 的方法都应该有效。如果你举这个简单的例子：

```
<div id="div1"></div>
<div id="div2"></div>
<div id="div3"></div>
<script type="text/javascript">
   document.getElementById( 'div1' ).innerHTML = '@Html.Raw("<li>Using getElementById</li>")';
   $( "#div2" ).html( '@Html.Raw("<li>Using jQuery html</li>")' );
   $( "#div3" ).append( '@Html.Raw("<li>Using jQuery append</li>")' );
</script> 
```

它将在 DOM 中呈现此 HTML：

```
<div id="div1"><li>Using getElementById</li></div>
<div id="div2"><li>Using jQuery html</li></div>
<div id="div3"><li>Using jQuery append</li></div> 
```

基本上它们都达到了相同的结果。代码中一定有一些您没有在示例中显示的内容。我确实在您的代码清单中注意到，当您使用**getElementById**时，**Html.Raw没有像您对 jQuery** **html**和**append**方法所做的那样被单引号包围。**如果您在ToParticipantList**中包含的字符串中包含单引号，它将不起作用。

# php - 重定向到个人资料页面

> ID：10298588
> 
> 赞同：1
> 
> 时间：2012-04-24T13:14:25.463
> 
> 标签：php

当有人登录时，我很难重定向到主页。我成功完成了登录表单，但似乎什么也没发生，我只是停留在同一页面上。我无法发现错误，任何帮助将不胜感激。谢谢。

```
<?php

include("scripts/connect.php");

$form = "<form action='home.php' method='post'>
    <table>
    <tr>
        <td>Email:</td>
        <td><input type='text' name='email' class='textbox' size='35'></td>
        <td><a href='register.php'>Register?</a></td>
    </tr>
    <tr>
        <td>Password:</td>
        <td><input type='password' name='password' class='textbox' size='35'></td>
        <td><input type='submit' name='login' value='Login' class='button' alt='Login'></td>
    </tr>
    </table>
</form>";

if ($_POST['login']){
    $email = strip_tags($_POST['email']);
    $password = strip_tags($_POST['password']);

if ($email && $password){

require("scripts/connect.php");

$pass = md5(md5($password));

$query = mysql_query("SELECT * FROM users WHERE email='$email' AND password='$pass'");
        $numrows = mysql_num_rows($query);

            if ($numrows == 1){

                $row = mysql_fetch_assoc($query);
                $dbid = $row['uid'];
                $dbuser = $row['name'];

                $_SESSION['name'] = $dbuser;
                $_SESSION['userid'] = $dbid;

                header("profile.php?uid=$userid");

            }
            else
                echo "Your login information was incorrect! $form";
    }
    else
        echo "You did not fill in the entire form! $form";
}
else
    echo "$form";

  ?> 
```

标头中的会话变量。

```
<?php
session_start();
$name = $_SESSION['name'];
$userid = $_SESSION['userid'];
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T13:16:04.990

```
header("profile.php?uid=$userid"); 
```

你错过了最重要的部分：

```
header( "Location: profile.php?uid=$userid" ); 
```

此外，正如 Pavel 在下面的评论中指出的那样，您的用户 ID 不存储在`$userid`.

```
$dbid = $row['uid'];
...
header( "Location: profile.php?uid=$dbid" ); 
```

最后，如果我没有在您的查询中指出 SQL 注入的可能性，这对您是不公平的。您正在从用户表中选择电子邮件和密码匹配的所有行。但是，如果我将以下内容作为我的电子邮件地址传递，并猜测一个随机密码，我将获得访问权限：

```
' or 'a' = 'a 
```

将其与您的查询结合起来，对数据库的查询现在变为：

```
SELECT * FROM users WHERE email='' or 'a' = 'a' AND password='$pass'" 
```

此时，我可以猜出一个随机密码，只要密码被您数据库中的某个人使用，我就会被认证为结果集中的第一个用户。如果密码太难了，但我知道您的一些用户的电子邮件地址（不难，因为很容易获得），我可以将其反转：

```
SELECT * FROM users WHERE email='admin@domain.com' AND password='' OR 'a' = 'a' 
```

同样，在这里，您的密码是什么并不重要，因为我不再需要它。如果 'a' = 'a' （并且总是如此），则不再需要密码。我将作为第一个拥有所提供电子邮件地址的用户登录。

更糟：

```
SELECT * FROM users WHERE email = '' OR 'a'='a' AND password = '' OR 'a' = 'a' 
```

这将使我以第一个返回的用户身份登录，这通常是管理员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:20:58.547

PHP 中的`header`函数允许您设置页眉。在您的情况下，您没有为标题指定任何内容。您可以使用`header()`特殊情况`Location`告诉浏览器重定向到所需的 url。

这将向浏览器推送 302 响应并进行重定向。所以你的代码应该是这样的：

```
header("Location: http://example.com"); 
```

在调用此方法之前，请确保您没有任何输出，因为它不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:56:13.390

你有没有尝试改变

```
if ($_POST['login']){ 
```

至：

```
if (isset($_POST['login'])) { 
```

?

并像这样使用标头重定向：

```
header("Location: page.php"); 
```

# c++ - 如何返回好的对象类型

> ID：10298594
> 
> 赞同：0
> 
> 时间：2012-04-24T13:14:53.837
> 
> 标签：c++, casting

我正在构建一个几何库，但我遇到了一些设计问题。

我有这个（简化的）设计：

我的基类是几何。它实现了一种计算两个几何图形交集的方法

```
class Geometry
{
    Geometry* intersection(Geometry* other)
    {
        //...compute intersection...
        //another lib does some work here
        Geometry* inter = compute_intersection()
        return inter;
    }
}; 
```

我也有一些来自几何的课程。

假设我有：

```
class Point : public Geometry
{
}; 
```

和

```
class Polyline : public Geometry
{
}; 
```

我的方法 intersection 返回一个几何，因为我不知道交集的结果是点还是折线。当我想使用生成的几何图形时，我的问题就出现了。

让我们在我主要的某个地方说，我愿意

```
Geometry* geom = somePolyline->intersection(someOtherPolyline); 
```

我知道 geom 实际上是一条折线。当我尝试做

```
Polyline* line = dynamic_cast<Poyline*>(geom) 
```

它返回一个 NULL 指针，这是正常的，因为 geom 的真实类型不是折线，而是几何。我可以尝试 reinterpret_cast 但是我失去了多态行为。

我的问题是：我可以像这样修改我的交集方法：

```
Geometry* intersection(Geometry* other)
{
    //...compute intersection...
    Geometry* inter = compute_intersection()

    // the intersection is computed by another lib and I can check (via a string)
    // the real type of the returned geometry.

    // cast the result according to its real type
    if (inter->realType() == "Polyline")
        return dynamic_cast<Polyline*>(inter);
} 
```

如果这不是一个好主意（我认为不是），那么做这样的事情会有什么好的设计？

提前致谢

（抱歉问题标题不好，我找不到好东西）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:22:19.010

只需创建一个`Polyline`对象并返回它：

```
Geometry* intersection(Geometry* other)
{
     Geometry* inter = 0; // Work out what it should be before creating it.

     // Work out what sort of thing it is ...

     if ( someCondition ) // which means it's a Polyline
         inter = new Polyline;

     return inter;
} 
```

您的函数本质上是一个**工厂**，因为它创建了不同类型的几何导数。您将返回一个指向 a 的指针，`Geometry`但如果您愿意，您可以将`dynamic_cast`它指向 a `Polyline`。

# comments - 如何将 jcomments 添加到我的自定义模块？

> ID：10298595
> 
> 赞同：1
> 
> 时间：2012-04-24T13:14:56.773
> 
> 标签：comments, joomla2.5

我在 joomla 2.5 中创建了一个模块。在该模块中，我一次显示一篇文章，从 url 获取其 id，然后在数据库中查询该 id 并显示文章标题和内容。

我还想在文章内容下显示评论表单，以便用户可以向该文章添加评论。

我正在使用 Jcomments 模块。

在内容区域下方，我放置了以下代码来显示 jcomments 表单，但它没有显示。

```
<?php

 $comments = 'components/com_jcomments/jcomments.php';
  if (file_exists($comments)) {
    require_once($comments);
?>
<center>
<div class="mtframe">
    <?php echo JComments::showComments($article->id, 'mod_article_detail', $article->title);?>
</div>
</center> 
```

那么如何将 jcomment 表单添加到我的自定义模块中呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:31:14.873

至于没有显示警告，它们可能被禁用。您应该删除`if`检查，因为找不到文件时会发生错误。

另外，指定一个绝对路径：

```
$comments = JPATH_SITE.'/components/com_jcomments/jcomments.php'; 
```

可以肯定的是，您可以添加一些调试行（但我建议不要让该模块对公众可用）：

```
var_dump(class_exists('JComments'));
var_dump(is_callable(array('JComments', 'showComments'));
var_dump($article->id); 
```

# iis-7 - VBScript 日期格式与区域设置不匹配

> ID：10298596
> 
> 赞同：2
> 
> 时间：2012-04-24T13:14:59.220
> 
> 标签：iis-7, asp-classic, vbscript, locale, date-format

我们正在为英国的客户维护一个旧的经典 ASP 网站。

区域设置 ID (LCID) 设置为 2057，这是应该的。（我已经使用 . 测试并确认了它`Response.Write GetLocale`。）

托管服务器也设置为英国语言环境。

最近，我们已将网站转移到另一台服务器（也具有英国设置）。自从搬家后，页面以美国格式显示日期。例如，页面显示的不是“16/05/2012”，而是“5/16/2012”。

新服务器实际上与旧服务器相同（旧服务器由于技术原因已停止使用）。

什么可能导致日期格式切换回美国格式？我不确定是否在此处或在[server fault](http://serverfault.com)中发布此问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T20:11:05.463

我一直有很多问题，前一刻还可以，下一刻没有任何改变是错误的。猜测 IIS 会记住其他页面的 LCID。我决定在每个处理日期的 asp 页面上放置声明“Session.LCID=XXXX”，现在我多年来没有遇到过这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-01T17:26:28.997

setlocale 仅影响脚本引擎区域设置。Session.LCID 影响脚本引擎以及 ASP 应用程序

# ios - 无法使文本视图滚动-xcode 4.3

> ID：10298600
> 
> 赞同：1
> 
> 时间：2012-04-24T13:15:03.903
> 
> 标签：ios, xcode, uiscrollview, scroll, uitextview

我正在使用 Xcode 4.3

我有一个单一的屏幕，它有一个文本视图`UITextView`，我希望能够垂直滚动。

我在屏幕上添加了一个滚动条，`UIScrollview`并`UITextview`在上面添加了一个。我创建了一个名为 theScroller 的新插座，并在`viewcontroller.m`文件中添加了该行。

```
(void)viewdidLoad 
{
self.thescroller.contentSize=CGSizeMake(280.0,600.0); 
```

然而，在我看过的大多数教程中，他们都在此之前添加了一行来将滚动条设置为 YES，但在 Xcode 4.3 中它不会让我这样做。如何打开滚动条。我究竟做错了什么。？

我是这方面的新手，所以请保持简单。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:21:07.033

首先，`UITextView`UITextView 的内容是否大于视图尺寸？如果它更大，那么它会滚动，如果不是，那么它不会滚动。

并且`UITextView`您不需要额外`UIScrollView`的滚动。

您已经添加了`contentSize`代码，但是，如果您的文本不大于正常视图大小，则 UITextView 将不会滚动。`UITextView`如果任何文本超出大小，则自动允许滚动。尝试添加比查看更多的文本，然后查看它是否滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T03:57:36.533

我的公共[仓库 TextScroller](https://github.com/freesuraj/TextScroller)中正好有你需要的东西。它支持正常的从右到左，从左到右（像LED）或像音乐播放器中的音乐名称一样浮动的浮动类型！

# routing - Symfony 2.0 路由参数_format

> ID：10298602
> 
> 赞同：1
> 
> 时间：2012-04-24T13:15:11.467
> 
> 标签：routing, symfony, format

我有路由：

```
user:
    pattern:  /.{_format}
    defaults: { _controller: AlefUserBundle:User:index, _format: json }
    requirements: { _format: (xml|json|php), _method: GET } 
```

当然，它可以在浏览器中使用。但是当我尝试创建菜单时，`KnpMenuBundle`我只得到`/user/`链接：

```
$menu->addChild('Użytkownicy', array('route' => 'user',
    'routeParameters' => array('_format' => 'json'),
        'attributes' => array(
            'title' => 'Lista użytkowników',
            'data-icon' => 'user',
            'data-id' => 'user_list',
        )
    )); 
```

我尝试清除缓存，但它根本不起作用。有没有办法存档这个？或者我需要输入 Uri？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T15:18:57.300

好吧，我将其更改为`{format}`. 它几乎按预期工作：

```
user:
    pattern:  /list.{format}
    defaults: { _controller: AlefUserBundle:User:index, format: html }
    requirements: { _format: (xml|json|html), format: (xml|json|html), _method: GET } 
```

但我还在控制器中添加了 1 行：

```
public function indexAction($format) //$_format
{
    $this->getRequest()->setRequestFormat($format);
...
} 
```

它有效...

# android - 更改快速搜索框的样式

> ID：10298603
> 
> 赞同：1
> 
> 时间：2012-04-24T13:15:11.873
> 
> 标签：android

我已经在我的应用程序上实现了快速搜索框，现在我想知道是否可以更改此快速搜索框的样式（设计）？

我真的很想在所有版本的 Android 上都有相同的快速搜索框设计。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:28:29.900

Just set a theme for the QuickSearchBox, to make sure it looks the same on every device. ;)

[http://developer.android.com/guide/topics/ui/themes.html](http://developer.android.com/guide/topics/ui/themes.html)

# web-services - Web 服务返回相同的值 FLEX 4.6

> ID：10298604
> 
> 赞同：0
> 
> 时间：2012-04-24T13:15:13.310
> 
> 标签：web-services, apache-flex, resultevent

嗨，我试图用我以前在 flex 应用程序中插入的值填充数据网格，但我得到的值与第一次插入和第二、第三、第四次插入相同，但 flex 带来了相同的值。有什么想法吗？上面的代码：

```
<s:HTTPService id="findPpl" url="http://server.com.br/requests/phprequest.php" useProxy="false" method="GET" result="findPpl_resultHandler(event)">
        <s:request xmlns="">
        <database>{Banco}</database>
        <function>findppl</function>
        <ID>{lastID}</ID>
    </s:request>
</s:HTTPService> 
```

结果事件代码在这里：

```
 protected function findPpl_resultHandler(event:ResultEvent):void
        {
            // TODO Auto-generated method stub
            if(event.result.request.pplis ArrayCollection){
                pplDp = event.result.request.ppl;
            }
            if(event.result.request.ppl is ObjectProxy){
                pplDp  = new ArrayCollection(ArrayUtil.toArray(event.result.request.ppl));
            }

        } 
```

无论我如何更改此返回相同的 Objectproxy，如果我再插入 3 个插入内容，如果有人介意请帮忙！泰。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T14:10:22.710

如果您在浏览器上运行它，则可能是它正在缓存第一个请求的结果。如果您可以控制服务，则可以将标头设置为过期。您也可以尝试通过在 URL 中传递一个随每个请求而变化的参数（例如`?dummy-parameter=<a-time-dependent-string>`）

# c# - ListBox 控件隐藏，不显示

> ID：10298607
> 
> 赞同：0
> 
> 时间：2012-04-24T13:15:21.840
> 
> 标签：c#, windows-phone-7, xaml

我已经开始将我的项目从其当前不稳定的性质转变为更高效的 MVVM 模型，因为这样做，我在视图区域中创建的 ListBoxes 不再呈现。代码构建和运行顺利，但列表框控件保持为空.. 一旦我从不同的类调用方法 fillList 就会发生这种情况

```
public void FillList(List<StockItem> sList)
{
    List<StockItem> locallist = new List<StockItem>();

    locallist.Add(new StockItem { AvailableStock = " ijeifji", BlockedStock = "ijji", DetailedInfo = "rrkorkork", IDCode = "rokro", TotalStock = " iijerijer", UOM = "o", WarehouseName = "blargh" });
    locallist.Add(new StockItem { AvailableStock = " ijeifji", BlockedStock = "ijji", DetailedInfo = "rrkorkork", IDCode = "rokro", TotalStock = " iijerijer", UOM = "o", WarehouseName = "blargh" });
    locallist.Add(new StockItem { AvailableStock = " ijeifji", BlockedStock = "ijji", DetailedInfo = "rrkorkork", IDCode = "rokro", TotalStock = " iijerijer", UOM = "o", WarehouseName = "blargh" });

    listBox.ItemsSource = locallist;
   // listBox.ItemsSource = siList;
} 
```

在这里，我创建了一个名为 locallist 的 TEMPORAL 列表来离线测试我的连接，发送到该方法的列表 sList 是一个类似的列表，包含具有相同绑定名称的项目，只是方式......更大......

我的列表框的 XAML 是：

```
<ListBox x:Name="listBox" FontSize="26" SelectionChanged="listBox_SelectionChanged" >
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid Height="176" Width="444" Background="#00292828">
                <Grid Height="159" VerticalAlignment="Top" Background="#6C5A5A5A">
                    <TextBlock Text="{Binding IDCode}" Height="28" Margin="8,7,164,0" VerticalAlignment="Top" Foreground="White" FontFamily="Segoe WP Light" FontSize="17.333"/>
                    <TextBlock Text="{Binding DetailedInfo}" Margin="8,39,164,0" Height="28" VerticalAlignment="Top" FontFamily="Segoe WP Light" FontSize="17.333"/>
                    <TextBlock Margin="24,73,15,0" TextWrapping="Wrap" FontFamily="Segoe WP Black" Height="29" VerticalAlignment="Top"><Run Text="TOTAL  "/><Run Text=" AVAILABLE  "/><Run Text=" BLOCKED"/></TextBlock>
                    <TextBox HorizontalAlignment="Left" Margin="8,0,0,-4" Text="{Binding TotalStock}" VerticalAlignment="Bottom" Height="61" Width="97" FontSize="18.667" Style="{StaticResource TextBoxStyle1}" Foreground="White" FontFamily="Segoe WP SemiLight" TextAlignment="Center"/>
                    <TextBox Margin="144,0,0,-4" Text="{Binding AvailableStock}" VerticalAlignment="Bottom" Height="61" FontSize="18.667" Style="{StaticResource TextBoxStyle1}" Foreground="White" FontFamily="Segoe WP SemiLight" TextAlignment="Center" HorizontalAlignment="Left" Width="102"/>
                    <TextBox HorizontalAlignment="Right" Margin="0,0,40,-4" Text="{Binding BlockedStock}" VerticalAlignment="Bottom" Height="61" Width="108" FontSize="18.667" Style="{StaticResource TextBoxStyle1}" Foreground="White" FontFamily="Segoe WP SemiLight" TextAlignment="Center"/>
                    <TextBlock HorizontalAlignment="Left" Margin="111,0,0,6.733" TextWrapping="Wrap" Text="{Binding UOM}" VerticalAlignment="Bottom" FontFamily="Segoe WP Light" FontSize="13.333"/>
                    <TextBlock HorizontalAlignment="Right" Margin="0,0,172.343,6.733" TextWrapping="Wrap" Text="{Binding UOM}" VerticalAlignment="Bottom" FontFamily="Segoe WP Light" FontSize="13.333"/>
                    <TextBlock HorizontalAlignment="Right" Margin="0,0,15.343,6.733" TextWrapping="Wrap" Text="{Binding UOM}" VerticalAlignment="Bottom" FontFamily="Segoe WP Light" FontSize="13.333"/>
                </Grid>
                <Button Content="Details" HorizontalAlignment="Right" VerticalAlignment="Top" Height="73" Width="146" Style="{StaticResource ButtonStyle1}" Foreground="#FFAAC028"/>
                <Rectangle Fill="White" Margin="0,-0.167,150.589,0" StrokeThickness="3" StrokeLineJoin="Round" RenderTransformOrigin="0.5,0.5" UseLayoutRounding="False" d:LayoutRounding="Auto" HorizontalAlignment="Right" Height="57.75" VerticalAlignment="Top" Width="6.906">
                    <Rectangle.RenderTransform>
                        <CompositeTransform SkewX="21.737" TranslateX="19.935"/>
                    </Rectangle.RenderTransform>
                </Rectangle>
                <!--<Button Click="Button_Click"/>-->
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

当我从 ViewModel.cs 调用 FillList 方法（位于 StockItemOverview.xaml.cs 中）时，问题就开始了（这里列表被创建并发送到 FillList(List sList) 一旦程序完成 FillList 方法，它继续运行，但没有出现列表框！请帮助！

从我的 ViewModel.cs 编辑代码

```
public void PopulateListbox(List<StockItem> sentSI, int MAX)
{
    List<StockItem> stockItemList = new List<StockItem>();

    for (int i = 0; i < MAX; i++)
    {
        stockItemList.Add(new StockItem() { IDCode = sentSI[i].IDCode, DetailedInfo = sentSI[i].DetailedInfo, AvailableStock = sentSI[i].AvailableStock, BlockedStock = sentSI[i].BlockedStock, TotalStock = sentSI[i].TotalStock, UOM = sentSI[i].UOM });
        //stockItemList.Add(new StockItem() { IDCode = "Hubla", DetailedInfo = "17 C", AvailableStock = "20", BlockedStock = "10", TotalStock = "30" });
    }

    StockItemOverview pageDisplayer = new StockItemOverview();

    pageDisplayer.FillList(stockItemList);
} 
```

和 StockItem 类：

```
public class StockItem
{
    public string IDCode { get; set; }
    public string AvailableStock { get; set; }
    public string BlockedStock { get; set; }
    public string TotalStock { get; set; }
    public string DetailedInfo { get; set; }
    public string WarehouseName { get; set; }
    public string UOM { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T14:06:21.833

只是一些想法。

1.  创建一个 BaseModel 类。
2.  一个。实施 INotifyPropertyChanged（使用适当的命名空间）。湾。实施方法。

例子：

```
public event PropertyChangedEventHandler PropertyChanged;

protected void OnPropertyChanged(string name)
{
   PropertyChangedEventHandler handler = PropertyChanged;
   if (handler != null)
      {
          handler(this, new PropertyChangedEventArgs(name));
      }
} 
```

1.  您的所有模型类（例如 StockItem）都将从 BaseModel 类继承。

2.  为 StockItem 类的所有字段详细说明 get 和 set。并通过在 Set 方法中将相应的公共属性名称作为参数来调用 PropertyChanged 方法。

例子：

```
private string _idCode;

public string IDCode
{
 get{
      return _idCode;
    }
 set{
     _idCode = value;
     PropertyChanged("IDCode");
    }
} 
```

1.  将所有 List<> 转换为 ObservableCollection<>

2.  让您的 ViewModel 实现 INotifyPropertyChanged 接口或从 BaseViewModel 继承（如上面解释的 BaseModel，它实现了该接口）。定义集合也是一个属性。像我们对 Model 类所做的那样调用 PropertyChanged 方法。

3.  有 listBox.ItemsSource = locallist; Load 事件或构造函数中的语句。

4.  将 DataContext 属性设置为 ViewModel。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T11:01:34.907

因此，在另一天搞砸代码之后，我注意到我创建了 2 个 ViewModel 实例并调用了彼此的 StockList ...通过正确使用相同的 ViewModel 实例，列表框现在可以正确绘制，你必须更改StockItem 类：

```
public class StockItem
{
        // Insert code required on object creation below this point.
        //      public string IDCode { get; set; }
        //      public string AvailableStock { get; set; }
        //      public string BlockedStock { get; set; }
        //      public string TotalStock { get; set; }
        //      public string DetailedInfo { get; set; }
        //      public string WarehouseName { get; set; }
        //      public string UOM { get; set; }

        //public StockItem() { }

        // public StockItem(string idcode, string avstock, string blstock, string totstock, string detinfo, string warehouse, string uom) 
        //  {
        //         this.IDCode = idcode;
        //         this.AvailableStock = avstock;
        //         this.BlockedStock = blstock;
        //         this.TotalStock = totstock;
        //         this.DetailedInfo = detinfo;
        //         this.WarehouseName = warehouse;
        //         this.UOM = uom;

        //     }
    private string _idcode;

    public string IDCode
    {
        get
        {
            return _idcode;
        }
        set
        {
            if (value != _idcode)
            {
                _idcode = value;
                NotifyPropertyChanged("IDCode");
            }
        }
    }
    private string _avstock;

    public string AvailableStock
    {
        get
        {
            return _avstock;
        }
        set
        {
            if (value != _avstock)
            {
                _avstock = value;
                NotifyPropertyChanged("AvailableStock");
            }
        }
    }
    private string _blstock;

    public string BlockedStock
    {
        get
        {
            return _blstock;
        }
        set
        {
            if (value != _blstock)
            {
                _blstock = value;
                NotifyPropertyChanged("BlockedStock");
            }
        }
    }
    private string _totstock;

    public string TotalStock
    {
        get
        {
            return _totstock;
        }
        set
        {
            if (value != _totstock)
            {
                _totstock = value;
                NotifyPropertyChanged("TotalStock");
            }
        }
    }
    private string _detinf;

    public string DetailedInfo
    {
        get
        {
            return _detinf;
        }
        set
        {
            if (value != _detinf)
            {
                _detinf = value;
                NotifyPropertyChanged("DetailedInfo");
            }
        }
    }
    private string _uom;

    public string UOM
    {
        get
        {
            return _uom;
        }
        set
        {
            if (value != _uom)
            {
                _uom = value;
                NotifyPropertyChanged("UOM");
            }
        }
    }
    private string _wareh;

    public string WarehouseName
    {
        get
        {
            return _wareh;
        }
        set
        {
            if (value != _wareh)
            {
                _wareh = value;
                NotifyPropertyChanged("WarehouseName");
            }
        }
    }
    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(String propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (null != handler)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

并将 ItemsSource 的绑定添加到正确的视图模型

```
private void StockItemOverview_Loaded(object sender, RoutedEventArgs e)
    {
        this.listBox.ItemsSource = App.ViewModel.StockItemList;

        if (!App.ViewModel.IsDataLoaded)
        {
            App.ViewModel.LoadData();
        }
    } 
```

# c++ - 如何在 MessageBox() 中显示数值？在 C++ 中

> ID：10298609
> 
> 赞同：0
> 
> 时间：2012-04-24T13:15:28.567
> 
> 标签：c++, mfc

我需要在 MessageBox 中显示屏幕分辨率像素作为输出。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:21:20.377

```
CString msg;
msg.Format(_T("%d"), number);
AfxMessageBox(msg); 
```

# ios - UIWebView 和本地存储

> ID：10298610
> 
> 赞同：4
> 
> 时间：2012-04-24T13:15:30.080
> 
> 标签：ios, webkit, local-storage

如何使用 webView 本地存储？我试试这个：

```
 WebPreferences* prefs = [webView preferences];
  [prefs _setLocalStorageDatabasePath:@"~/Library/Application Support/MyApp"];
  [prefs setLocalStorageEnabled:YES]; 
```

但在新的 IOS sdk (xcode 4.3.2) 中我没有 WebKit.framework

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T13:50:39.057

在新的 sdk webView 中有默认缓存 (tnx HTML5 =) )...所以你需要的只是在你的 HTML 中包含缓存

# iphone - 为 Xcode 4.3.2 和 SDK 5.1 编译 pjsip 2 时出错

> ID：10298615
> 
> 赞同：0
> 
> 时间：2012-04-24T13:15:45.707
> 
> 标签：iphone, macos, ios5, xcode4.3, pjsip

我正在尝试使用终端编译 pjsip 第 2 版，无论我尝试什么，我都会遇到不断的错误。一直在互联网上寻找答案，包括stackoverflow。

我今天使用他们的 subversion 存储库下载了 pjsip 版本 2，因此所有文件都应该是最新的。

遵循本指南时：[http](http://trac.pjsip.org/repos/wiki/Getting-Started/iPhone) ://trac.pjsip.org/repos/wiki/Getting-Started/iPhone运行“make dep && make clean && make”后出现此错误：

```
ld: symbol(s) not found for architecture armv7
collect2: ld returned 1 exit status
make[2]: *** [../bin/pjsua-arm-apple-darwin9] Error 1
make[1]: *** [pjsua] Error 2
make: *** [all] Error 1 
```

将上述指南与本指南结合使用时：[http](http://lists.pjsip.org/pipermail/pjsip_lists.pjsip.org/2011-October/013481.html) ://lists.pjsip.org/pipermail/pjsip_lists.pjsip.org/2011-October/013481.html运行“make dep && make clean && make”后出现此错误：

```
ld: symbol(s) not found for architecture arm
collect2: ld returned 1 exit status
make[2]: *** [../bin/pjsua-arm-apple-darwin10] Error 1
make[1]: *** [pjsua] Error 2
make: *** [all] Error 1 
```

我已将 /pjlib/include/pj/config_site.h 包含在以下代码中：

```
#define PJ_CONFIG_IPHONE 1
#include <pj/config_site_sample.h> 
```

如何让 pjsip 编译没有错误？

请考虑我是新手，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T02:23:40.463

从您的错误来看，似乎可能有几件事是错误的。我会确保在继续之前清除所有环境变量（为了安全起见）。

在 ./configure-iphone 中，确保更改：

```
./aconfigure --host=arm-apple-darwin9 --disable-floating-point $* 
```

到：

```
./aconfigure --host=arm-apple-darwin10 --disable-floating-point $* 
```

以下是我用来构建库的脚本：

模拟器：

```
 export DEVPATH=/Developer/Platforms/iPhoneSimulator.platform/Developer
    export CC=/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/gcc

    export CFLAGS="-O2 -m32 -miphoneos-version-min=5.0 -g -ggdb -g3 -DNDEBUG" 
    export LDFLAGS="-O2 -m32"

    ./configure-iphone

    make clean
    make dep
    make
    make clean 
```

设备：

```
 export ARCH="-arch armv7"
  export CFLAGS="-DNDEBUG -g -ggdb -g3"

  ./configure-iphone

  make clean
  make dep
  make
  make clean 
```

# google-app-engine - 谷歌应用引擎项目更新

> ID：10298616
> 
> 赞同：0
> 
> 时间：2012-04-24T13:15:49.077
> 
> 标签：google-app-engine

我是谷歌应用引擎的新手。我正在将在 python 中创建的 localhost 主机项目上传到谷歌应用引擎。它正在成功上传，但 js 更改并未实时反映。我已刷新 Memcache，但它无法正常工作。我怎样才能摆脱这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T14:15:07.963

谷歌应用引擎中有一个用于静态文件的内置缓存，您可以使用[default_expiration](https://developers.google.com/appengine/docs/python/config/appconfig#Static_File_Handlers)（或[设置每个文件夹的过期](https://developers.google.com/appengine/docs/python/config/appconfig#Static_Directory_Handlers)时间）来控制缓存的持续时间。

您还应该在资源 url 中添加一个 slug（使用 md5、random、timestamp 或 svn 修订版）以强制客户端加载资源，例如`/script/my_script?ver=XXX`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T14:22:05.943

您是否尝试过清空浏览器缓存？例如，如果您在合作网络上，也可能是其他一些缓存。

# c++ - 如何使用初始化列表初始化类的 const char 数组成员？

> ID：10298618
> 
> 赞同：0
> 
> 时间：2012-04-24T13:15:50.500
> 
> 标签：c++

```
#include<iostream>

using std::cout;
using std::endl;

/*
This example aims to test whether the default copy constructor and default assignment operator works for classes that has array member and whether initialzation list works for array member.

Test result: copy constructor and default assignment operator works for classes that has array member
                         initialization list doesn't work for array member.
*/

class A{
    private:
        const char list[10];
    public:
        A(const char *l="Nothing");
        void show()const;

};

A::A(const char*l):list(l){           //the compiler fails to initialize "list"
}

void A::show()const{
    for(int i=0;i<10;i++){

        cout<<list[i]<<'\t';
        if(i%5==4)
            cout<<endl;
        }
    cout<<endl;
}

int main(){
    char name[10]="hello";
    A a(name);
    A b;
    cout<<"Before assignment, b="<<endl;
    b.show();
    b=a;
    cout<<"After assignment, b="<<endl;
    b.show();
    A c(a);
    cout<<"After initialization, c="<<endl;
    c.show();

} 
```

该程序无法编译并抛出错误消息，说“将'const char *'分配给'const char [10]的类型不兼容”。如何初始化 const 成员列表？

# android - DialogFragment 用于启动 TimePicker

> ID：10298619
> 
> 赞同：1
> 
> 时间：2012-04-24T13:15:51.953
> 
> 标签：android

我意识到您需要在执行以下代码之前进行交易。如何使该事务成为 TimePickerDialog？

```
 DialogFragment newFragment = new DialogFragment();
        newFragment.show(getFragmentManager(), "dialog"); 
```

我将如何将该代码与此代码集成：

```
 private TimePickerDialog.OnTimeSetListener mTimeSetListener =
            new TimePickerDialog.OnTimeSetListener() {
                public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
                    mHour = hourOfDay;
                    mMinute = minute;
                }
    };
    @Override
    protected Dialog onCreateDialog(int id) {
        Log.d("is it in here","");
        switch (id) {
        case TIME_DIALOG_ID:
            return new TimePickerDialog(this,
                    mTimeSetListener, mHour, mMinute, false);
        }
        return null; 
```

新代码如下。由于“this”，它给出了一个未定义的构造函数错误。我该如何解决？我知道我需要传递一个上下文..但是如何？

```
 public static class MyAlertDialogFragment extends DialogFragment {
        private int mHour;
        private int mMinute;
        public static MyAlertDialogFragment newInstance(int title) {
            MyAlertDialogFragment frag = new MyAlertDialogFragment();
            Bundle args = new Bundle();
            args.putInt("title", title);
            frag.setArguments(args);
            return frag;
        }
        private TimePickerDialog.OnTimeSetListener mTimeSetListener =
                new TimePickerDialog.OnTimeSetListener() {
                    public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
                        mHour = hourOfDay;
                        mMinute = minute;
                    }
        };
        @Override
        public Dialog onCreateDialog(Bundle savedInstanceState) {
            Log.d("is it in here","");
            case TIME_DIALOG_ID:
                return new TimePickerDialog(this,
                        mTimeSetListener, mHour, mMinute, false);
            return null;

        }
    } 
```

代码编辑#2：

```
 public TimePickerDialog.OnTimeSetListener mTimeSetListener =
            new TimePickerDialog.OnTimeSetListener() {
                public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
                    mHour = hourOfDay;
                    mMinute = minute;
                }
    };
    public void notification(String value){
        // add a click listener to the button
        //showDialog(TIME_DIALOG_ID);
        new TimePickerDialog(this, mTimeSetListener, mHour, mMinute, false);

        // get the current time
        //final Calendar c = Calendar.getInstance();
        //mHour = c.get(Calendar.HOUR_OF_DAY);
        //mMinute = c.get(Calendar.MINUTE);

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T14:53:11.817

我不确定您当前要回答哪个编辑，但是对于编辑一个，您可以像这样替换它：

```
return new TimePickerDialog(getActivity(), mTimeSetListener, mHour, mMinute, false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:20:34.930

见[http://www.mkyong.com/android/android-time-picker-example/](http://www.mkyong.com/android/android-time-picker-example/)

您不需要时间选择器的事务，但是您可以在额外的 layout.xml 中设置一个时间选择器，用它填充一个片段并像您已经做的那样启动一个新的对话框片段。

此外，如果你想显示一个对话框，你真的不需要片段。你可以使用

`new TimePickerDialog.show()`

您所做的方式已被弃用，其中对话框通过当前活动的“onCreateDialog()”推送。见[http://developer.android.com/reference/android/app/Activity.html#onCreateDialog(int](http://developer.android.com/reference/android/app/Activity.html#onCreateDialog(int) )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:21:52.990

您完全按照通常为活动进行的方式进行操作。唯一的区别是您的 TimePickerDialog 将在 DialogFragment 中创建。

即，您需要创建 DialogFragment 子类（就像活动的子类一样），将您的选择器和其他所有东西放在那里，仅此而已 - 不涉及魔法:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-26T17:12:50.010

我的片段，它适用于对话框和嵌入式显示（见下文）：

```
public class TimePickerFragment extends DialogFragment implements TimePickerDialog.OnTimeSetListener {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        Time t = new Time();
        t.setToNow();

       // Uses the current time as the default values for the picker
       Bundle args = getArguments();
       int hour = args.getInt(GLarmStrings.FRAGMENT_ARGS_TIME_PICKER_HOUR, t.hour);
       int minute = args.getInt(GLarmStrings.FRAGMENT_ARGS_TIME_PICKER_MINUTE, t.minute);

       TimePicker tp = new TimePicker(getActivity());
       tp.setIs24HourView(GLarmApp.is24HourEnabled(getActivity()));
       tp.setCurrentHour(hour);
       tp.setCurrentMinute(minute);
       tp.setOnTimeChangedListener(...)
       return tp;
    }

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        Time t = new Time();
        t.setToNow();

       // Use the current time as the default values for the picker
       Bundle args = getArguments();
       int hour = args.getInt(GLarmStrings.FRAGMENT_ARGS_TIME_PICKER_HOUR, t.hour);
       int minute = args.getInt(GLarmStrings.FRAGMENT_ARGS_TIME_PICKER_MINUTE, t.minute);

       // Create a new instance of TimePickerDialog and return it
       return new TimePickerDialog(getActivity(), this, hour, minute, GLarmApp.is24HourEnabled(getActivity()));
    }

    @Override
    public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
        // TODO Auto-generated method stub
    }   
} 
```

要使用它：

```
if (hasDialogFrame) {
    fragment.setShowsDialog(false); // maybe unnecessary
    FragmentTransaction ft = getSupportFragmentManager().beginTransaction();
    ft.add(R.id.main_dialogs, fragment, "test").commit();  
} else {
    fragment.setShowsDialog(true); // maybe unnecessary
    fragment.show(getSupportFragmentManager(), GUI_DIALOG_TIME_PICKER);
} 
```

# regex - .htaccess 重定向与 RegEx 不起作用 - “未指定输入文件。”

> ID：10298624
> 
> 赞同：1
> 
> 时间：2012-04-24T13:16:16.800
> 
> 标签：regex, .htaccess, redirect, http-status-code-301

我的域上有一个由其他网络管理员设置的 Wordpress 博客。所有帖子都在此文件结构下归档：

```
http://www.example.com/blog/index.php/2012/04/24/name-of-the-post/ 
```

我正在尝试使用我的 .htaccess 文件来 301 将旧帖子的链接重定向到他们在此处看到的新地址（注意它是相同的 URL，除了`/index.php`缺少）：

```
http://www.example.com/blog/2012/04/24/name-of-the-post/ 
```

在我的 .htaccess 文件中，我试图用这个重定向 URL：

```
RewriteEngine on
RewriteRule ^blog/index\.php/([A-Za-z0-9-/.]+)$ http://www.example.com/blog/$1 [R=301] 
```

**问题**：当我在 .htaccess 文件中使用上述 RegEx 时，我收到错误消息**“未指定输入文件”。** 在浏览器中，重定向不会发生。我究竟做错了什么？我的正则表达式有问题吗？还是我还缺少其他东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T13:45:16.797

诀窍是我需要将一个 .htaccess 文件放入我的`blog`目录中。

这是对我有用的代码：

```
RewriteEngine On
RewriteRule ^index\.php/(.*)$ $1 [R=301,L,NC]

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /blog/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /blog/index.php [L]
</IfModule>

# END WordPress 
```

# java - 如何验证jar签名

> ID：10298627
> 
> 赞同：3
> 
> 时间：2012-04-24T13:16:33.573
> 
> 标签：java, jar, jar-signing

如何检查 .jar 文件是否具有签名以及如何在代码中验证此签名以确保我的代码仅使用特定库执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T15:18:08.093

不确定您的问题是如何以编程方式自行检查，还是参考如何让 Java 为您自动检查。

对于第二个，您可以使用 Java 提供的安全功能。首先，您必须对您的 jar 文件进行数字签名（使用 jarsigner 工具）。

然后，您必须使用安全管理器 ( `System.setSecurityManager(new SecurityManager()`) 运行您的程序。

最后，您必须配置您的安全策略文件以允许您的程序仅运行由某个实体签名的代码。

```
grant signedBy "mrm" {
    permission ...
}; 
```

[Java 教程](http://docs.oracle.com/javase/tutorial/security/toolsign/index.html)中有一个教程可以做到这一点。

# javascript - OnClick 事件 - 检查哪个是发件人

> ID：10298629
> 
> 赞同：-1
> 
> 时间：2012-04-24T13:16:36.680
> 
> 标签：javascript, jquery

有没有一种方法可以在每次单击我页面上的某些内容（无论是控件还是其他内容）时调用一个事件，然后在该函数中检查哪个是发件人？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T13:20:44.787

像这样？

```
$(document).click(function(e) {
  console.log(e.target);
}); 
```

这将捕获文档中的所有点击并记录事件开始的节点。这有点像大锤的方法，但是在不了解问题的情况下，这是我能做的最好的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:22:30.127

好吧，您可以执行以下操作：

```
$(function(){
    $('*').click(function(){
        var $sender = $(window.event.target);
    });
}); 
```

但是，您将遇到我想象的各种传播问题，而且我不知道是否所有 dom 元素都响应该`.click()`事件。

最好用类名标记您希望可点击的所有项目，因此它变为：

```
$(function(){
    $('.clickable').click(function(){
        var $sender = $(window.event.target);
    });
}); 
```

你到底想完成什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:22:43.413

您可以像这样识别被点击的项目。下面的脚本将处理您页面中的所有标签。

```
$(function(){
    $("a").click(function(e){
    // e.preventDefault(); prevent default behaviour if needed
     alert("Invoked from "+$(this).attr("id"));   
    });
});​ 
```

工作样本：http: [//jsfiddle.net/yBfUq/2/](http://jsfiddle.net/yBfUq/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T13:25:48.593

确实有，虽然我想不出你想要这样做的任何理由？

[http://jsfiddle.net/WkNPg/](http://jsfiddle.net/WkNPg/)

```
$(document).ready(function() {
    $("body *").click(function(event){
       alert($(this).attr('id'));
    })        

}); 
```

这将提醒 id，但您可以根据“发件人”进行任何您想要的操作。

# jquery - jQuery Mobile - 触发已选择的选项

> ID：10298635
> 
> 赞同：4
> 
> 时间：2012-04-24T13:17:02.357
> 
> 标签：jquery, jquery-mobile, jquery-events

**当再次选择已选择的选项**时，我试图触发一个事件。我尝试了不同的点击和触发功能，但没有。请帮忙。

HTML：

```
<select id="mySelect" name="mySelect">
    <option class="mylistitem" value="0" selected="selected">Option 0</option>
    <option class="mylistitem" value="1">Option 1</option>
    <option class="mylistitem" value="2">Option 2</option>
</select>​ 
```

JS：

```
$("#mySelect").live("change", function () {
    alert($("#mySelect").val());
}); 
```

或[http://jsfiddle.net/pioSko/tcWRP/38/](http://jsfiddle.net/pioSko/tcWRP/38/)

更新：结合两个答案；）[http://jsfiddle.net/pioSko/tcWRP/60/](http://jsfiddle.net/pioSko/tcWRP/60/)

```
$(document).delegate('#mySelect-menu li', 'vmousedown', function (event) {
    if ($(this).attr('aria-selected') === 'true') {
        $('#mySelect').trigger('change');
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T16:14:08.090

如果您使用本机选择菜单，那么您很快就会遇到问题。但是，如果您使用 jQuery Mobile 样式的选择菜单，那么您可以将事件处理程序绑定到菜单小部件，因为它是由 DIV 和 SPAN 组成的。

```
$(document).delegate('#mySelect-menu li', 'vmousedown', function (event) {
    if ($(this).attr('aria-selected') === 'true') {
        alert('That is already selected.');
    }
});​ 
```

这是一个演示：http: [//jsfiddle.net/ys8Kh/](http://jsfiddle.net/ys8Kh/)

基本思想是在自定义选择菜单中跟踪对“选项”元素（实际上是列表项）的点击，并检查`area-selected`属性以查看该元素是否已被选中。该值由 jQuery Mobile 自动更新。

请注意，这`#mySelect-menu`是作为 jQuery Mobile 选择菜单的自定义选择菜单界面创建的 UL 元素。另请注意，这`vmousedown`是一个自定义 jQuery Mobile 事件，有助于处理鼠标和触摸事件。我之所以选择`vmousedown`是因为它会在 select 的值发生变化之前触发，所以我们可以查看`click`ed 元素是否已经被选中。

此外，要强制非本地选择小部件，请将此属性添加到 SELECT 标记：`data-native-menu="false"`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T16:20:08.777

我通常做的是调用`$("#mySelect").trigger('change')`它将调用您的代码，就好像用户将其更改为当前值一样

# .net - 对于长时间运行的进程，是否最好手动执行线程而不是线程池？

> ID：10298641
> 
> 赞同：19
> 
> 时间：2012-04-24T13:17:38.117
> 
> 标签：.net, multithreading, c#-4.0, threadpool, task-parallel-library

前几天我读到，对于长时间运行的任务，我最好的选择是手动创建线程，而不是使用 .NET 的线程池或 Task Parallel。当我正在学习 c# 线程时，我真的很希望有人能启发我，特别是对于长时间运行的 IO 任务。先感谢您。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-24T13:22:59.740

那是真实的。线程池针对小型工作单元进行了优化，您可以通过保持线程池线程来干扰其他工作。

我的经验法则是，如果一个操作可能需要一秒钟以上，它不应该在线程池线程上。那可能很长。

尽管这是未记录的，但如果您开始使用，则将启动`Task`一个`TaskCreationOptions.LongRunning`新线程来运行任务。

对于大多数 IO 任务，您应该真正使用框架方法的异步版本。这些利用内核函数，意味着您不会阻塞任何线程。

一如既往，我推荐阅读[Joe Albahari 的免费电子书](http://www.albahari.com/threading/)，然后阅读[Joe Duffy 的 Concurrent Programming on Windows](https://rads.stackoverflow.com/amzn/click/com/032143482X)。后者长达 1000 页，但充满了有用的细节。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-24T13:22:54.950

没错，ThreadPool 线程轻巧且便宜，因为可以重新调度以服务来自 ThreadPool 的新请求，因此一旦线程操作完成，ThreadPool 就可以重新调度同一线程以进行其他操作，您也可以通过最小线程数进行操作（[ThreadPool.SetMinThreads()](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.setminthreads.aspx)），所以在新的请求到来之前它们会一直存在。因此，对于多个轻量级操作，这是一个很好的解决方案，例如，您需要每隔几秒钟创建一个单独的/新线程。

MSDN 杂志上非常好的文章：[专用线程还是 Threadpool 线程？](https://docs.microsoft.com/en-us/archive/blogs/pedram/dedicated-thread-or-a-threadpool-thread)

> 一旦达到最小线程数，线程池旨在将创建的线程数限制为每 500 毫秒一个。这是一种智能机制，避免了在该时间段内可能释放多个线程池线程时创建新线程的昂贵成本。

由于 .NET 4.0 - 任务并行库是手动线程管理和同步的一个很好的高级抽象和替代方案，因此您的代码将不易出错。因此，只需使用[TaskCreationOptions.LongRunning](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskcreationoptions.aspx)[创建一个任务](http://msdn.microsoft.com/en-us/library/dd321320.aspx)，我相信从可维护性的角度来看，这将是对应用程序架构的最佳投资。

有用的阅读：

*   [在任务并行库和线程池之间进行选择](https://devblogs.microsoft.com/pfxteam/choosing-between-the-task-parallel-library-and-the-threadpool/)

# c# - RestSharp示例不起作用

> ID：10298643
> 
> 赞同：0
> 
> 时间：2012-04-24T13:17:38.957
> 
> 标签：c#, restsharp

我有一个从[http://www.stum.de/2009/12/22/using-restsharp-to-consume-restful-web-services/](http://www.stum.de/2009/12/22/using-restsharp-to-consume-restful-web-services/)更新的代码。我已经更新了最新版本的 RestSharp：

```
var client = new RestClient("http://carma.org");
var request = new RestRequest("api/1.1/searchPlants", Method.GET);
request.AddParameter("location", 4338);
request.AddParameter("limit", 10);
request.AddParameter("color", "red");
request.AddParameter("format", "xml");
var plants = client.Execute<PowerPlantsDTO>(request);
MessageBox.Show(plants.Count.ToString())

using System.Collections.Generic;

namespace RestTest.Model
{
    public class CityDTO
    {
        public string value { get; set; }
    }

    public class LocationDTO
    {
        public CityDTO city { get; set; }
        public int zip { get; set; }
        public double latitude { get; set; }
        public double longitude { get; set; }
    }

    public class item
    {
        public string name { get; set; }
        public LocationDTO location { get; set; }
    }

    public class PowerPlantsDTO : List<item> { }
} 
```

不幸的是，plants.count 和plants.data 一样是空的，但是返回了一个XML 数据（参见下面的截图）。有人可以帮我看看我是否遗漏了什么？

截图： ![在此处输入图像描述](../Images/8a0ff6b9dcb0e4c0fe0a9107ecf90f1c.png)

![在此处输入图像描述](../Images/9bc3c068e56ef29da62ae116d9aae0f0.png)

错误消息显示

> “参数计数不匹配。”

并返回 XML 内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<items>
<item>
    <id>49046</id>
    <name>WATSON COGEN</name>
    <carbon>
        <past>4503176.0000</past>
        <present>4582168.0000</present>
        <future>5401482.0000</future>
    </carbon>
    <energy>
        <past>3827727.0000</past>
        <present>3017826.0000</present>
        <future>3506896.0000</future>
    </energy>
    <intensity>
        <past>2352.9250</past>
        <present>3036.7339</present>
        <future>3080.4910</future>
    </intensity>
    <location>
        <continent>
            <id>5</id>
            <value>North America</value>
        </continent>
        <country>
            <id>202</id>
            <value>United States</value>
        </country>
        <latitude>33.8219</latitude>
        <longitude>-118.2633</longitude>
        <state>
            <id>644</id>
            <value>California</value>
        </state>
        <city>
            <id>60769</id>
            <value>Carson</value>
        </city>
        <metroarea>
            <id>3203</id>
            <value>Los Angeles-Long Beach</value>
        </metroarea>
        <county>
            <id>4338</id>
            <value>Los Angeles</value>
        </county>
        <congdist>
            <id>5298</id>
            <value>Diane Watson</value>
        </congdist>
        <zip>90749</zip>
    </location>
</item>
<item>
    <id>7233</id>
    <name>CARSON COGEN</name>
    <carbon>
        <past>432223.9062</past>
        <present>440564.3125</present>
        <future>451224.5000</future>
    </carbon>
    <energy>
        <past>461797.6875</past>
        <present>348148.4062</present>
        <future>355428.0938</future>
    </energy>
    <intensity>
        <past>1871.9189</past>
        <present>2530.8989</present>
        <future>2539.0481</future>
    </intensity>
    <location>
        <continent>
            <id>5</id>
            <value>North America</value>
        </continent>
        <country>
            <id>202</id>
            <value>United States</value>
        </country>
        <latitude>33.8759</latitude>
        <longitude>-118.2491</longitude>
        <state>
            <id>644</id>
            <value>California</value>
        </state>
        <city>
            <id>60769</id>
            <value>Carson</value>
        </city>
        <metroarea>
            <id>3203</id>
            <value>Los Angeles-Long Beach</value>
        </metroarea>
        <county>
            <id>4338</id>
            <value>Los Angeles</value>
        </county>
        <congdist>
            <id>5433</id>
            <value>Juanita Millender-McDonald</value>
        </congdist>
        <zip>90746</zip>
    </location>
</item>

</items> 
```

堆栈跟踪：

```
 at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimePropertyInfo.SetValue(Object obj, Object value, BindingFlags invokeAttr, Binder binder, Object[] index, CultureInfo culture)
   at System.Reflection.RuntimePropertyInfo.SetValue(Object obj, Object value, Object[] index)
   at RestSharp.Deserializers.XmlDeserializer.Map(Object x, XElement root)
   at RestSharp.Deserializers.XmlDeserializer.HandleListDerivative(Object x, XElement root, String propName, Type type)
   at RestSharp.Deserializers.XmlDeserializer.Deserialize[T](IRestResponse response)
   at RestSharp.RestClient.Deserialize[T](IRestRequest request, IRestResponse raw) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T20:32:10.740

在查看堆栈跟踪时，它肯定与反序列化 XML 的能力有关。您遵循的教程是 2009 年的，看起来 RestSharp 已经从它下面发生了一些变化。

我能够让您的样本正常工作，并使用“plants.Data”访问植物列表，只需稍作改动：

```
var plants = client.Execute<PowerPlantsDTO>(request); 
```

变成

```
var plants = client.Execute<List<item>>(request); 
```

在查看 RestSharp 代码时，他们似乎使用[XmlDeserializer](https://github.com/restsharp/RestSharp/blob/master/RestSharp/Deserializers/XmlDeserializer.cs)中的通用参数的名称来确定 XML 节点名称。出于好奇，我快速浏览了使用[XmlElement](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlelementattribute.aspx)属性来尝试影响 XML 节点的名称，但该属性不能应用于类。据我所知，你最好的选择是塑造你的 DTO 以明确匹配预期的回报结构。

希望有帮助。

# c# - SQL 翻译成流畅的 Nhibernate => 加入静态值

> ID：10298651
> 
> 赞同：1
> 
> 时间：2012-04-24T13:18:00.847
> 
> 标签：c#, nhibernate, fluent-nhibernate

我正在尝试将此 sql 语句转换为流畅的 nhibernate 映射：

```
select *
from Project p
inner join ProjectData pd on p.Project = pd.Project
inner join ProjectCompany pc on p.Project = pc.Project and pc.InitComp = 'Yes' and pc.Company = pd.LogComp
inner join ProjectCustomer cust on cust.id = pd.custid 
```

将此语句放入单个实体中时遇到了许多问题（所有连接都是一对一的关系）。
我知道一个视图可以解决我的问题，但可惜我没有创建一个视图的权限。

目前我的代码看起来像这样

```
Table("Project");
Id(p=> p.Number);
Join("ProjectData", j =>
{
    j.Fetch.Join();
    j.KeyColumn("Project");
    j.Map(pd => pd.Customer);
});
Map(p => p.Complexity); 
```

我面临的问题是：

*   如何创建硬编码过滤器（pc.InitComp = 'Yes'）
*   我如何加入 2 个语句（p.project = pc.Project 和 pc.Company = pd.LogComp
*   我如何从连接表而不是基础表加入？（ProjectCustomer 加入 ProjectData）

对于 sql 中如此微不足道的事情有很多问题，但我似乎无法在互联网上找到一个简单的答案，然后创建一个视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T13:27:39.067

I ended up with a raw sql query and using a datareader to manually fill my object.
This worked cause i only needed to read from a table and not write.

# sql - 从存储过程中的动态 SQL 获取结果

> ID：10298654
> 
> 赞同：8
> 
> 时间：2012-04-24T13:18:07.397
> 
> 标签：sql, sql-server-2008, tsql, stored-procedures

我正在编写一个存储过程，我需要在该过程中动态构造一个 SQL 语句来引用传入的表名。

我需要让这个 SQL 语句返回一个结果，然后我可以在整个过程的其余部分使用该结果。

我试过使用临时表和所有东西，但我不断收到一条消息，我需要声明变量等。

例如：

```
DECLARE @FiscalYear INT    
DECLARE @DataSource NVARCHAR(25)
DECLARE @SQL NVARCHAR(250)
SELECT @DataSource = 'CustomerCosts20120328'
DECLARE @tempFiscalYear TABLE ( FiscalYear INT ) 
SELECT @SQL = 'INSERT INTO @tempFiscalYear SELECT DISTINCT FiscalYear FROM ' + @DataSource
EXEC(@SQL)
SELECT @FiscalYear = FiscalYear FROM @tempFiscalYear 
```

或者...

```
DECLARE @FiscalYear INT  
DECLARE @DataSource NVARCHAR(25)
DECLARE @SQL NVARCHAR(250)
SELECT @DataSource = 'CustomerCosts20120328'
SELECT @SQL = 'SELECT DISTINCT @FiscalYear = FiscalYear FROM ' + @DataSource
EXEC(@SQL) 
```

无论如何都可以在不使用实际表格的情况下做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T13:21:46.483

您是否尝试过类似的方法：

```
DECLARE @FiscalYear INT, @DataSource NVARCHAR(25), @SQL NVARCHAR(250);
SET @DataSource = N'CustomerCosts20120328';
SET @SQL = N'SELECT DISTINCT @FiscalYear = FiscalYear FROM ' + @DataSource;
EXEC sp_executesql @SQL, N'@FiscalYear INT OUTPUT', @FiscalYear OUTPUT;

PRINT @FiscalYear; 
```

您需要确保在 nvarchar 字符串前面加上 N，例如`SELECT @SQL = N'SELECT ...`.

此外，您知道如果查询返回多行，分配给的值`@FiscalYear`是完全任意的，对吧？虽然您可能希望从该表中获得一个值，但使用`MAX()`或`TOP 1 ... ORDER BY`确保只分配一个单一的、可预测的值并没有什么坏处。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-24T13:25:25.613

首先，您需要知道，使用动态 SQL，您将面临 SQL 注入攻击的风险，您应该在使用之前先查看[此链接。](http://www.sommarskog.se/dynamic_sql.html)完成此操作后，您可以将第一个查询更改为：

```
DECLARE @FiscalYear INT    
DECLARE @DataSource NVARCHAR(25)
DECLARE @SQL NVARCHAR(250)
SELECT @DataSource = 'CustomerCosts20120328'
DECLARE @tempFiscalYear TABLE ( FiscalYear INT ) 
SELECT @SQL = 'SELECT DISTINCT FiscalYear FROM ' + @DataSource

INSERT INTO @tempFiscalYear
EXEC(@SQL)

SELECT @FiscalYear = FiscalYear FROM @tempFiscalYear 
```

您还应该考虑@AaronBertrand 对`@FiscalYear`参数分配的评论。

# javascript - 我们可以在警告框中放置一个复选框吗？

> ID：10298657
> 
> 赞同：1
> 
> 时间：2012-04-24T13:18:12.737
> 
> 标签：javascript

我们可以在标准的 Windows 警报框中放置一个复选框吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:20:03.037

不，您不能这样做，但您可以使用[**jQuery 对话框插件**](http://jqueryui.com/demos/dialog/)，或者您可以为此创建您的自定义模型框...

# javascript - 自动缩放 SVG 内的鼠标位置

> ID：10298658
> 
> 赞同：59
> 
> 时间：2012-04-24T13:18:12.870
> 
> 标签：javascript, svg

我在我的 SVG 文档中遇到了关于鼠标光标位置的问题。我想设计一个电位器，在拖动时跟随光标，在 HTML 页面中使用**JavaScript 。**

我试过了`evt.clientX/Y`，`evt.screenX/Y`但由于我的 SVG 处于**autoscale**状态，我的 SVG 内的坐标是不同的。几天来我一直在寻找答案，但找不到任何解决方案（无论是实时了解我的 SVG 缩放因子还是在 SVG 坐标系中具有鼠标定位功能）。

旋转将遵循一个简单的规则：

```
if (evt.screenX < xc)
  ang = Math.atan((evt.screenY - yc) / (evt.screenX - xc)) * 360/(2*Math.PI) - 90;  

if (evt.screenX > xc)
  ang = Math.atan((evt.screenY - yc) / (evt.screenX - xc)) * 360/(2*Math.PI) + 90; 
```

以我的 SVG 内的鼠标坐标`(xc;yc)`作为旋转中心并替换所有内容。`evt.screenX/Y`

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2012-04-24T13:27:36.337

看这段代码，它不仅展示了如何从屏幕空间变换到全局 SVG 空间，还展示了如何将点从 SVG 空间变换到元素的变换空间：http:
[//phrogz.net/svg/drag_under_transformation.xhtml](http://phrogz.net/svg/drag_under_transformation.xhtml)

简而言之：

```
// Find your root SVG element
var svg = document.querySelector('svg');

// Create an SVGPoint for future math
var pt = svg.createSVGPoint();

// Get point in global SVG space
function cursorPoint(evt){
  pt.x = evt.clientX; pt.y = evt.clientY;
  return pt.matrixTransform(svg.getScreenCTM().inverse());
}

svg.addEventListener('mousemove',function(evt){
  var loc = cursorPoint(evt);
  // Use loc.x and loc.y here
},false); 
```

**编辑**：我已经根据您的需要创建了一个示例（尽管仅在全球 SVG 空间中）： http:
[//phrogz.net/svg/rotate-to-point-at-cursor.svg](http://phrogz.net/svg/rotate-to-point-at-cursor.svg)

它在上面添加了以下方法：

```
function rotateElement(el,originX,originY,towardsX,towardsY){
  var angle = Math.atan2(towardsY-originY,towardsX-originX);
  var degrees = angle*180/Math.PI + 90;
  el.setAttribute(
    'transform',
    'translate('+originX+','+originY+') ' +
      'rotate('+degrees+') ' +
      'translate('+(-originX)+','+(-originY)+')'
  );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-25T04:45:47.353

@Phrogz：感谢您的精彩示例，我从中吸取了教训。我已经改变了其中的一些，如下所示，让它更容易一些。正如我认为我们在核心 java 中处理鼠标事件一样，我们也可以在这里处理相同的方式，所以我在你的示例中尝试了我的方式。

我已经删除了“rotateElement”功能，因为我认为它有些困难，如果有的话我会找到一个替代品。

见下面的代码：

```
var svg=document.getElementById("svg1");
var pt=svg.createSVGPoint();
var end_small=document.getElementById("end_small");
var line=document.getElementById("line1");

end_small.addEventListener('mousemove', function(evt) {

    var loc=getCursor(evt);
    end_small.setAttribute("cx",loc.x);
    end_small.setAttribute("cy",loc.y);

    loc = getCursor(evt); // will get each x,y for mouse move

    line.setAttribute('x2',loc.x); // apply it  as end points of line
    line.setAttribute('y2',loc.y); // apply it as end points of line

}, false);

function getCursor(evt) {
    pt.x=evt.clientX;
    pt.y=evt.clientY;
    return pt.matrixTransform(svg.getScreenCTM().inverse());
} 
```

所以我所做的是我只是将侦听器添加到小圆圈而不是整个 SVG 并且每次当你移动鼠标时，我都会`x, y`从`getCursor()`上述函数中获得，我将在我的行中给出`x, y`它`x2, y2`，它不会翻译，也不会旋转。您必须将鼠标移动到圆圈然后缓慢移动，如果您的鼠标离开圆圈，则线将不会移动，因为我们刚刚在小圆圈右侧添加了侦听器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-12-14T21:10:02.430

获取正确的 svg 鼠标坐标很棘手。首先，一种常见的方法是使用事件属性的clientX 和clientY 分别用getBoundingClientRect() 和clientLeft 减去clientTop。

```
svg.addEventListener('click', event =>
{
    let bound = svg.getBoundingClientRect();

    let x = event.clientX - bound.left - svg.clientLeft - paddingLeft;
    let y = event.clientY - bound.top - svg.clientTop - paddingTop;
} 
```

**但是**，如果 svg 的填充样式信息大于零，则坐标正在移动。所以这个信息也必须减去：

```
let paddingLeft = parseFloat(style['padding-left'].replace('px', ''));
let paddingTop = parseFloat(style['padding-top'].replace('px', ''));

let x = event.clientX - bound.left - svg.clientLeft - paddingLeft;
let y = event.clientY - bound.top - svg.clientTop - paddingTop; 
```

不太好的想法是，在某些浏览器中，边框属性也会移动坐标，而在其他浏览器中则不会。*我发现，如果 event 属性的 x 和 y不可*用，就会发生转变。

```
if(event.x === undefined)
{
    x -= parseFloat(style['border-left-width'].replace('px', ''));
    y -= parseFloat(style['border-top-width'].replace('px', ''));
} 
```

在这种转换之后，x 和 y 坐标可能会超出范围，这应该是固定的。但那不是想法。

```
let width = svg.width.baseVal.value;
let height = svg.height.baseVal.value;

if(x < 0 || y < 0 || x >= width || y >= height)
{
    return;
} 
```

此解决方案可用于 click、mousemove、mousedown 等。您可以在这里进行现场演示：[https ://codepen.io/martinwantke/pen/xpGpZB](https://codepen.io/martinwantke/pen/xpGpZB)

# r - 不在较小的字符向量列表中而是在大列表中查找元素

> ID：10298662
> 
> 赞同：10
> 
> 时间：2012-04-24T13:18:23.180
> 
> 标签：r, list, character, subset

我有两个大大小小的清单。我想知道大列表中的哪些元素不在小列表中。该列表包括财产

```
([1] "character"           "vector"              "data.frameRowLabels"
[4] "SuperClassMethod" 
```

这是我得到的小例子和错误

```
 A <- c("A", "B", "C", "D")
 B <- c("A", "B", "C")
  new <- A[!B]
Error in !B : invalid argument type 
```

预期的输出是 new <- c("D")

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-24T13:26:12.113

看`help("%in%")`-在该页面的底部一直有一个示例可以解决这种情况。

```
A <- c("A", "B", "C", "D")
B <- c("A", "B", "C")
(new <- A[which(!A %in% B)])

# [1] "D" 
```

**编辑：**

正如泰勒指出的那样，我应该接受自己的建议并阅读支持文件。在本例中`which()`使用时是不必要的。`%in%`所以，

```
(new <- A[!A %in% B])

# [1] "D" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-24T13:30:00.267

`!`仅适用于逻辑向量。 `B`不合逻辑，这就是导致错误的原因。分解您尝试执行的步骤将向您展示这一点（即`!B`）。在这种情况下，您想使用`%in%`(或`match`)。

```
A[!A %in% B] 
```

分解上面的代码：

1.  `A %in% B`创建一个逻辑向量，用于 中存在的`TRUE`值。`A``B`
2.  `!A %in% B`否定（反转）（1）中的逻辑
3.  `A[!A %in% B]``TRUE`返回(2)中元素的向量

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-27T23:39:29.690

虽然我认为`sets`可能会帮助您处理不同的列表。

在您的情况下，您可以使用：

```
A <- c("A", "B", "C", "D")
B <- c("A", "B", "C")

# to find difference
setdiff(A, B)

# to find intersect
intersect(A, B)

# to find union
union(A, B) 
```

# haskell - 在纯代码中避免 IORef

> ID：10298664
> 
> 赞同：25
> 
> 时间：2012-04-24T13:18:25.583
> 
> 标签：haskell, data-structures, monads, union-find, ioref

我注意到[Data.UnionFind](http://hackage.haskell.org/package/union-find)使用 IO monad 通过 IORefs 提供指针。我想每个人在以纯代码在本地使用它时都会愉快地调用`unsafePerformIO`它，因为数据结构很好理解，但是..

这种数据结构是否有规范的清洁方法？也许是 IO 的包装器，它通过禁止大多数 IO 操作使不可避免`unsafePerformIO`的不安全“看起来”变得不那么安全？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-24T13:24:07.603

> 这种数据结构是否有规范的清洁方法？也许是围绕 IO 的包装器，它通过禁止大多数 IO 操作来减少不可避免的 unsafePerformIO 不安全的“外观”？

是的，确切地说。您刚刚发明[**了 ST monad**](http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad-ST.html)，它由[Launchbury 和 Peyton Jones](http://www.cs.fit.edu/~ryan/library/functional_programming/lazy-functional-state-threads.pdf)大约 20 年前介绍。

`ST`monad 只允许局部范围的记忆效果。值得注意的是，它使用类型系统来保证副作用在使用它们的代码块范围之外是不可见的。

因此，只要您仅通过引用使用内存，仅在本地范围内，您就可以避免`unsafePerformIO`并使用纯 ST，例如，[实现 union-find](http://hackage.haskell.org/packages/archive/equivalence/0.2.3/doc/html/Data-Equivalence-STT.html)。

# javascript - 使用 JavaScript 单击链接时在 youtube 上搜索视频？

> ID：10298672
> 
> 赞同：0
> 
> 时间：2012-04-24T13:19:02.157
> 
> 标签：javascript, html, youtube

当点击链接时，我也在尝试制作一个无需重新加载页面即可加载 youtube 视频的页面。当按下按钮时，我有代码工作，它看起来像：

```
$(document).ready(function() {
    $(".button").click(function() {
        var search = $(".input").val();
        var keyword= encodeURIComponent(search);
        var yt_url='http://gdata.youtube.com/feeds/api/videos?q='+keyword+'&format=5&max-results=1&v=2&alt=jsonc';

$.ajax({
        type: "GET",
        url: yt_url,
        dataType:"jsonp",
        success: function(response) {
            if(response.data.items) {
                $.each(response.data.items, function(i,data) {
                    var video_id=data.id;
                    var video_frame="<iframe width='420' height='236' src='http://www.youtube.com/embed/"+video_id+"' frameborder='0' type='text/html'></iframe>";
                    $("#video").html(video_frame); 
                });
            } else {
                $("#video").html("<div id='no'>No Video</div>");
            }
        }
    });
});
}); 
```

我一直在尝试从我在线遵循的教程中更改此代码，以获取链接。我不确定接下来应该做什么，我尝试更改类，但在从链接获取搜索数据时遇到了问题。我希望改进的是：

```
<div id="main_section">
    <div id=ytVid>
        <iframe width="480" height="360" src="http://www.youtube.com/embed/xJ3-NnNx6Zs" frameborder="0" allowfullscreen></iframe>
    </div>
    <p id="1">Jackie Wilson - Reet Petite</p>
    <p id="2">Queen - Bohemian Rhapsody</p>
</div> 
```

当有人点击“Jackie Wilson - Reet Petite”文字或链接时，它会更新 youtube 视频，女王歌曲也会更新。

谢谢

编辑：我将 JavaScript 文件更改为：

```
$(document).ready(function() {
    $("#songInfo").click(function() {
    function openLink(evt) {
            var search = evt.target.innerHTML;
            var keyword= encodeURIComponent(search);
            ... rest of code ... 
```

和 HTML 到：

```
<p id="1" onclick="openLink(evt);"> Jackie Wilson - Reet Petite</p>
<p id="2" onclick="openLink(evt);"> Queen - Bohemian Rhapsody</p> 
```

当我点击文本时什么也没发生对不起，我对 HTML 中的 JavaScript 很陌生，我应该早点说。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:39:22.390

我认为您会很幸运地使用标签的“onclick”事件做同样的事情`<p>`-[文档](http://www.w3schools.com/jsref/event_onclick.asp)说它对这些标签有效。像这样的东西：

```
document.getElementById("1").onclick = "openLink(evt);"; 
```

然后，如果您需要`<p>`标签的文本，请尝试以下操作：

```
function openLink(evt) {
    var search = evt.target.innerHTML;
    var keyword= encodeURIComponent(search);
    ... // just like your unnamed function
} 
```

# php - 基于php数组动态创建HTML表格行

> ID：10298676
> 
> 赞同：0
> 
> 时间：2012-04-24T13:19:16.863
> 
> 标签：php, jquery, html-table

我正在认真努力地掌握以下内容。我想基于 PHP 数组为每行表构建一个 3 个数据单元格。所以换句话说，如果数组中有 3 个值，则应该有如下结构：

```
<?php
$arr = array("value1","value2","value3");
?>

// Expected outcome:
<table>
      <tr>
           <td>value1</td>
           <td>value2</td>
           <td>value3</td>               
      </tr>
</table> 
```

但是如果将第四个值添加到数组中，它必须动态创建另一行，换句话说：

```
<?php
$arr = array("value1","value2","value3","value4");
?>

// Expected outcome:
<table>
      <tr>
           <td>value1</td>
           <td>value2</td>
           <td>value3</td>               
      </tr>
      <tr>
           <td>value4</td>
           <td></td>
           <td></td>               
      </tr>
</table> 
```

我真的不介意哪种解决方案，甚至是 php 和 jQuery 之间的混合，但只是我可以用来实现上述目标的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T13:23:42.057

使用模数。像这样：

```
<table>
<tr>
<?php
    $i = 1;
    foreach ($arr as $val){
        $i++;
        print '<td>'.$i.'</td>';
        if ($i % 3 == 0){
            print '</tr><tr>'^;
        }

    }
?>
</tr>
</table> 
```

您将需要添加更多内容以正确输出 html，但“硬”部分已完成。

**不要只是复制和粘贴，我没有测试代码，它很难看。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:25:10.010

使用[array_chunk](http://php.net/manual/en/function.array-chunk.php)函数将数组分成组，然后只做几个循环，例如

```
<?php
$arr = array("value1","value2","value3","value4");
echo "<table>";
$rows = array_chunk($arr,3);
foreach($rows as $row) {
  echo "<tr>";
  foreach($row as $cell) {
    echo "<td>".$cell."</td>";
  }
  echo "</tr>";
}
echo "</table>";
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:41:07.660

这是一个逻辑实现：

```
<?php
$input_array = array('a', 'b', 'c', 'd', 'e','f','g');
$new_array = array_chunk($input_array, 3);

$table = '<table border="1">';
foreach($new_array as $value){
$table .= '<tr><td>'.$value[0].'</td><td>'.$value[1].'</td><td>'.$value[2].'</td>    </tr>';
}
$table.='</table>';

echo $table;
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T13:26:00.497

```
<table><tr>
<?php
$arr = array("value1","value2","value3","value4","value5","value6","value7");

for($i=0;$i<count($arr)%3;$i++)
  $arr[] = null;

foreach($arr as $key => $val){

  if(($key)%3==0)
    echo '</tr><tr>';

  echo '<td>'.$val.'</td>';

}
?>
</tr></table> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T13:26:37.900

```
<table>
    <tr>
        <?php
        $x = 0;
        foreach($arr as $v){
            if ($x % 3 == 0 && $x != 0){
                echo '</tr><tr>';
            }

            echo '<td>'.$v.'</td>';
            $x++;
        }
        ?>
    </tr>
</table> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-24T13:37:34.583

这是我的建议，它将生成格式化的 html

```
<table>
    <tr>    
    <?php
    $i = 0;
    $items_per_row = 3;

    foreach ($arr as $elm) {
        echo '<td>'.$elm.'</td>';

        if (++$i % $items_per_row == 0 && $i < count($arr) - 1)
            echo '</tr><tr>';
    }
    ?>
    </tr>
</table> 
```

# javascript - 在 el 中查找节点

> ID：10298681
> 
> 赞同：2
> 
> 时间：2012-04-24T13:19:20.657
> 
> 标签：javascript, jquery, backbone.js

我在骨干实例化视图中像

```
var m=new StyleModel();
m.set({"test":"test"});
var a=new StyleView({"model":m,"el":$("#price")}); 
```

el 像行

```
<tr id="price">
<td>
<button class=".bold"/>
<button class=".italic"/>
</td>
<td>....</td></tr> 
```

如何找到粗体和斜体的节点？我需要将类切换到该节点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T07:19:33.260

首先，我认为你的 HTML 应该是这样的：

```
<button class="bold"/>
<button class="italic"/> 
```

您不想要属性中`.`的，那是用于类选择器。`class`

在您的视图中，您将拥有[`this.$el`](http://documentcloud.github.com/backbone/#View-$el)：

> 视图元素的缓存 jQuery（或 Zepto）对象。

和[`this.$`](http://documentcloud.github.com/backbone/#View-dollar)：

> 如果页面中包含 jQuery 或 Zepto，则每个视图都有一个 $ 函数，用于运行视图元素范围内的查询。[...] 这相当于运行：`view.$el.find(selector)`.

因此，您可以执行以下任一操作：

```
this.$el.find('.bold')   // bold elements
this.$el.find('.italic') // italic elements

this.$('.bold')
this.$('.italic') 
```

甚至：

```
$(this.el).find('.bold')
$(this.el).find('.italic') 
```

旧版本的 Backbone 没有，`this.$el`但它们会有`this.$`；除此之外，使用哪个是个人喜好问题。

# sencha-touch-2 - 向元素添加点击事件？

> ID：10298683
> 
> 赞同：11
> 
> 时间：2012-04-24T13:19:28.050
> 
> 标签：sencha-touch-2

`eg. &lt;span id="foo">foo&lt;/span>`如何在 ST2 应用程序中将 点击事件分配给任意范围 ( )？

我有一个简单的例子来说明我想做的事情。在示例中，我写了字母`A,B,C`，我想告诉用户他们点击了哪个字母。

这是一张图片：

![在此处输入图像描述](../Images/a57841294098824b75b5b7b969ccde6f.png)

* * *

**代码片段**

```
Ext.application({

    launch: function() {
        var view = Ext.create('Ext.Container', {

            layout: {
                type: 'vbox'
            },
            items: [{
                html: '&lt;span id="let_a">A&lt;/span>  &lt;span id="let_b">B&lt;/span> &lt;span style="float:right" id="let_c">C&lt;/span>',
                style: 'background-color: #c9c9c9;font-size: 48px;',
                flex: 1
            }]
        });
        Ext.Viewport.add(view);
    }
}); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-24T21:59:05.527

您可以使用委托将侦听器添加到特定元素。它实际上使用起来相当简单。

```
Ext.Viewport.add({
    html: 'test <span class="one">one</span> hmmm <span class="two">two</span>',
    listeners: [
        {
            element: 'element',
            delegate: 'span.one',
            event: 'tap',
            fn: function() {
                console.log('One!');
            }
        },
        {
            element: 'element',
            delegate: 'span.two',
            event: 'tap',
            fn: function() {
                console.log('Two!');
            }
        }
    ]
}); 
```

主要部分是`element`和`delegate`。

*   `element`几乎在所有情况下都具有 的价值`element`，除非您使用自定义模板使用自定义组件。
*   `delegate`是一个简单的 CSS 选择器。所以它可以是任何`span`东西`span .test.second`

**正如蒂姆**所说，理想情况下，您应该尽可能多地利用组件。他们会给你更多的灵活性。但我知道在某些情况下你肯定需要这样做。不会对性能产生影响；事实上，它会比使用组件更快。但是，您**永远不**应该按照他建议的方式实现侦听器。它不会高效并且非常脏（正如他所提到的）。

# java - 消费者和工人模式

> ID：10298687
> 
> 赞同：0
> 
> 时间：2012-04-24T13:19:33.303
> 
> 标签：java, multithreading, arraylist, deque

我有 10 名工人名单的代码和以下两种方法：

```
public void demoDeques() {
        int maxSizeOfJobDeque = 3;
        Producer producer = new ProducerImpl( maxSizeOfJobDeque );

        Logger.debug( "WorkFlowEngineImpl : " +
                "Creating Workers and adding them to allocator" );
        List<Worker> workerList = buildWorkerList( producer );
        Logger.debug( "WorkFlowEngineImpl : " +
                "Assigning some jobs to the workers. " +
                    "The workers have not been started yet");

        for ( int i=1; i<4; i++ ) {
            producer.assign( new JobImpl( "job " + i, i ) );
            try {
                Thread.sleep( 4000 );
            } catch( InterruptedException e ) {
                e.printStackTrace();
            }
        }

        Logger.debug( "WorkFlowEngineImpl : " + "Starting the workers" );
        startWorkersAndWait5Seconds( workerList );
        Logger.debug( "WorkFlowEngineImpl : " +
                "Assigning some more jobs to the " +
                    "started workers" );

        for ( int i=4; i<7; i++ ) {
            producer.assign( new JobImpl( "Job " + i, i ) );
            try {
                Thread.sleep( 4000 );
            } catch( InterruptedException e ) {
                e.printStackTrace();
            }
        }

        Logger.debug( "WorkFlowEngineImpl : " + "Assigning More Jobs" );
        for ( int i=7; i<11; i++ ) {
            producer.assign( new JobImpl( "job" + i, i ) );
            try {
                Thread.sleep( 4000 );
            } catch( InterruptedException e ) {
                e.printStackTrace();
            }
        }
    } 
```

生产商：

```
public synchronized void assign( Job job ) {
    Set<Worker> workerSet = jobMap.keySet();
    LinkedBlockingDeque<Job> jobQueue;
    StringBuffer sb;

    for ( Worker worker : workerSet ) {
        jobQueue = jobMap.get( worker );

        sb = new StringBuffer();
        sb.append( "Assigning job " );
        sb.append( job.getJobNumber() );
        sb.append( " to " );
        sb.append( worker );
        sb.append( "'s jobs Deque" );

        Logger.debug( "Producer : " + sb.toString() );

        if ( ! jobQueue.offerFirst( job ) ) { 
            jobQueue.pollLast();
            jobQueue.offerFirst( job );
        }
    }
} 
```

我正在尝试更改这两种方法，以便分配器有一个包含 100 个工作的列表，然后以这样的方式进行分配，即十个工人中的每一个在时间上最多分配三个工作，直到达到 100 个，即工人一个需要工作 1,2,3 工人 2 需要 4,5,6，所以当工人 10 到达时，它会返回给工人 1 分配三个工作，直到达到第 100 个工作，然后它会停止并警告所有工作都已分配。请帮助我被卡住了....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:54:55.893

尽管您的问题提到了具体的执行顺序，但您的评论似乎表明这不是真正的要求。我建议您使用`Executors`Java 1.5 中提供的线程池，而不是实现自己的线程池。例如：

```
ExecutorService threadPool =
    Executors.newFixedThreadPool(NUMBER_THREADS_TO_RUN_JOBS);
// your producers then just have to submit jobs to the pool
for ( int i=1; i<4; i++ ) {
    threadPool.submit(new JobImpl("Job " + i, i));
} 
```

我无法从您的示例中确切看到每个“作业”需要进行哪些处理，但是否`JobImpl`需要实现`Runnable`上述代码才能正常工作。如果您需要从您的工作中返回一些值，那么您可以更改`JobImpl`为 is`Callable`并使用方法`Future`返回的`submit(Callable)`方法来获取`call()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:52:25.083

我不同意你的工作分配方法，我认为这就是你的代码挂起的原因。

一般来说，生产者应该创建工作并将其分配给队列。担心分配工作不是制片人的责任。当工人可用时，他们将从队列中拉出作业。他们是拉 1 个工作还是 3 个工作只是工作线程拉动时的逻辑问题。

您可能希望为队列创建一个单例类。它应该处理接收和请求工作。

以这种方式接近它可以让您将工人与生产者分离。您可以根据工作量/瓶颈的要求添加更多生产者或工人。它还使您无法生成某种信号机制，其中工人向生产者指示他们已准备好进行更多工作。最后，这使您不必担心只有 1 个作业可用的各种竞争条件，或者作业编号与您在 demoDequeue 中的魔术数字顺序不符。

HTH，对不起，这不是一个直接的答案，但应该让你走上更好的解决问题的道路。

# jquery - 非 Flash 棋盘效果幻灯片或图像交换

> ID：10298688
> 
> 赞同：1
> 
> 时间：2012-04-24T13:19:34.833
> 
> 标签：jquery, html5-canvas, css-transitions

在不使用 Flash 的情况下，复制本网站主页上显示的 Flash 动画的最有效方法是什么？ [http://www.redhotdubai.com/](http://www.redhotdubai.com/)必须支持 IE7+ 和所有其他主流浏览器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:55:29.943

您可能应该使用一个`canvas`元素，因为您需要遮罩并且有很多动画正在进行。最终使用 CSS 和 DOM 会太笨拙，画布解决方案最终会运行得更快、更可靠。

以下是您需要的相关画布方法的一些文档：

[https://developer.mozilla.org/docs/Web/Guide/HTML/Canvas_tutorial/Using_images#Slicing](https://developer.mozilla.org/docs/Web/Guide/HTML/Canvas_tutorial/Using_images#Slicing)

# objective-c - iTunes U：“为 iOS 开发应用程序”如果有更新的版本，是否有意义？

> ID：10298691
> 
> 赞同：0
> 
> 时间：2012-04-24T13:19:42.900
> 
> 标签：objective-c, ios, xcode4, xcode4.2

我对所有 iOS 的东西和目标 C 编程都很陌生。由于我正在阅读一本学习Objective C的书，我意识到另外观看一些关于该主题的讲座可能对我有用。

在一些较旧的 Stackoverflow 主题中，我发现了斯坦福大学的“Developing Apps for iOS”（http://itunes.apple.com/us/itunes-u/developing-apps-for-ios-sd/id395631522）。看完第二堂课，我在想听课有没有用。我正在使用 XCode 4.2，它似乎与 XCode 4.1（他正在使用的）不同。所以我的问题是：听他的课有用吗？是否有一些深刻的主要变化，我将面临很多问题，如果是，是否有另一个关于 XCode 4.2 相同主题的播客/视频教程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:45:53.853

有一个涵盖 Xcode 4.2 的同一课程的更新版本。是的，4.1 和 4.2 之间存在*显着*差异。您绝对应该使用较新的。

只需在 iTunes U 中搜索“iPad 和 iPhone 应用程序开发”即可。它由 Paul Hegarty 教授。你会想要 2011 年秋季课程。

**更新**：这是一个链接： http: [//itunes.apple.com/WebObjects/MZStore.woa/wa/viewPodcast ?id=473757255](http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewPodcast?id=473757255)

# html - HTML5 视频不适用于 IE 和 Safari

> ID：10298693
> 
> 赞同：0
> 
> 时间：2012-04-24T13:19:44.987
> 
> 标签：html

我有以下 HTML5 视频标签。它在 Firefox 和 Chrome 中运行良好，但在 IE 9 和 Safari 中，根本不是视频。有任何想法吗？？

```
<video controls="true">
  <source src="ronald.mp4" type="video/mp4" />
  <source src="ronald.webm" type="video/webm" />

  Your browser does not support the video tag.
</video> 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:33:40.923

尝试这样的事情

```
 <video width="320" height="240" controls="controls">
    <source src="ronald.mp4" type="video/mp4" />
    <source src="ronald.webm" type="video/webm" />
     Your browser does not support the video tag.
  </video> 
```

# linux - 当数据到达Linux中的串行端口（RS232）时，是否可以向用户应用程序发送通知消息？

> ID：10298694
> 
> 赞同：0
> 
> 时间：2012-04-24T13:19:44.867
> 
> 标签：linux, linux-kernel, linux-device-driver

我知道Linux可以在连接/断开系统时为USB配件注册*udev*事件，通过udev应用程序可以获得有关USB事件的通知，因此应用程序可以应用必要的操作。

有什么方法可以为串行外围设备（RS232）的用户应用程序执行相同的事件通知？linux是否支持任何可以做到这一点的基础设施？基本上，当数据到达串行端口时，我是从串行端口读取数据，而不是创建一个线程并等待来自串行端口的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:50:20.757

如果没有带有程序/守护程序的串行设备上的 poll(ing)/select(ing)，如果数据到达串行控制台，您将无法做出反应。

您可以编写自己的内核驱动程序，但这需要更多的努力。

# java - JPA 2.0，标准 API，多对多

> ID：10298695
> 
> 赞同：1
> 
> 时间：2012-04-24T13:19:49.090
> 
> 标签：java, jpa-2.0, criteria-api

我有两个对象——汽车和颜色。每辆车都可以有一组颜色。在数据库中，我有三个表 Car、Car_color 和 Color。

我有 sql 查询 -

```
select  min(color.id) 

  from car
    join car_colors
      on car.id = car_color.car
    join color
      on car_color.color = color.id
  where car.id = 28; 
```

如何使用 Criteria API 获取有关对象的数据。

真的是你的，纳凡亚。

# java - 如何告诉 wsimport 使用代理异常 url

> ID：10298699
> 
> 赞同：4
> 
> 时间：2012-04-24T13:19:58.487
> 
> 标签：java, web-services, wsdl, jax-ws, wsimport

我需要连接到内部 Intranet Web 服务。我的公司使用代理服务器访问 Internet，但 Intranet 站点不通过代理。我可以在 IE 和 Firefox 中导航到 WSDL，但我必须将地址添加到两个浏览器中的代理例外列表中。

当我使用 wsimport 时，由于代理服务器，我无法获取 WSDL。添加或省略 -httpproxy 参数会给我一个错误“无法通过代理隧道”所以我猜这不是我需要这样做的方式。

有谁知道我可以告诉 wsimport 忽略此 url 的代理服务器的方法吗？

尼尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-06T05:26:15.777

我到达这篇文章是为了寻找一种使用 wsimport.exe（JDK 1.6、1.7 等的一部分）对内部（内部网）URL 使用代理并跳过外部 URL 代理（w3c.com）的方法。我看到它没有放置 nonProxyHosts 的工具，所以我继续使用 Java 类调用。

像这样的东西

```
java -Dhttp.proxyHost=proxyServer -Dhttp.proxyPort=9000 -Dhttp.nonProxyHosts="localhost|*.intranet-domain.com" -classpath %JAVA_HOME%\lib\tools.jar com.sun.tools.internal.ws.WsImport -p com.ws.client.pkg http://app.intranet-domain.com/endpoint?wsdl 
```

为了更容易阅读：

```
java
  -Dhttp.proxyHost=proxyServer
  -Dhttp.proxyPort=9000
  -Dhttp.nonProxyHosts="localhost|*.intranet-domain.com"
  -classpath %JAVA_HOME%\lib\tools.jar
  com.sun.tools.internal.ws.WsImport
  -p com.ws.client.pkg
  http://app.intranet-domain.com/endpoint?wsdl 
```

请记住，“-Dhttp.nonProxyHosts”仅在您之前在该行中配置代理时才有效，您需要所有参数。因此，如果您只想禁用默认代理，则必须在此处再次对其进行配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T09:09:25.123

我找到了答案。您需要将以下内容添加为 JVM 参数，它使用 Internet Explorer（或我假设 Mac 上的 Safari）代理地址和排除列表。

```
-Djava.net.useSystemProxies=true 
```

我从[http://jeannotsweblog.blogspot.co.uk/2009/06/wsimport-with-proxy.html得到了分析器](http://jeannotsweblog.blogspot.co.uk/2009/06/wsimport-with-proxy.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-29T20:26:23.060

目前`wsimport`在这方面被打破了。

我为此创建了两张票：

1.  [https://java.net/jira/browse/JAX_WS-1154](https://java.net/jira/browse/JAX_WS-1154)
2.  [https://java.net/jira/browse/JAX_WS_COMMONS-132](https://java.net/jira/browse/JAX_WS_COMMONS-132)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-11-19T02:36:43.463

```
wsimport -keep -verbose -httpproxy:172.18.14.192:8089 http://xxx.abc.com/services/s1?wsdl 
```

根据[Oracle JAVA 9 wsimport 文档](https://docs.oracle.com/javase/9/tools/wsimport.htm#JSWOR740)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-02-11T13:52:42.910

您也可以使用`--httpproxy`wsimport 选项的选项 -

`wsimport -keep -httpproxy:USERNAME:passwdsabc001@proxy.yourcmpny.com`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-05T19:38:21.860

如果您可以在应用程序级别设置该标志，Neil Kennedy 建议的方法将起作用。但是，如果您想对特定 url 使用代理，请查看 ProxySelector 类。您可以编写自己的代理选择器类，它使用您的代理主机和端口扩展 ProxySelector，然后将其设置为默认代理选择器。看看这个线程[如何在不设置系统的情况下将 HTTP 代理用于 JAX-WS 请求 -广泛的财产？](https://stackoverflow.com/questions/6447127/how-can-i-use-an-http-proxy-for-a-jax-ws-request-without-setting-a-system-wide-p)伊洛叔叔给出的答案。另请查看[http://docs.oracle.com/javase/7/docs/technotes/guides/net/proxies.html](http://docs.oracle.com/javase/7/docs/technotes/guides/net/proxies.html)了解 Proxyselector 的详细信息，它清楚地解释了正在发生的事情。

# plone - 克隆 4：如何创建多个克隆站点

> ID：10298701
> 
> 赞同：1
> 
> 时间：2012-04-24T13:19:59.720
> 
> 标签：plone, zope, buildout

我正在使用 Plone 4，我需要在我的 Zope 实例中添加另一个 Plone 站点，即一个 Plone 站点用于测试/开发，另一个 Plone 站点用于生产。我已经安装了一个 Plone 站点，想知道如何在同一实例中安装另一个站点。

我已按照[此处](http://plone.org/documentation/kb/multiple-plone-sites-per-zope-instance-using-separate-data-fs-files-for-each-one)列出的步骤进行操作，但没有成功。我正在使用构建。

谁能告诉我该怎么做，或者我做错了什么。谢谢。

编辑：我正在寻找一种方法，可以为每个 Plone 站点生成不同的 Data.fs 文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:45:31.840

要创建更多克隆站点，请访问：

```
http://<hostname>:<port>/manage 
```

例如：

```
http://localhost:8080/manage 
```

在那里你会在右上角找到一个按钮，上面写着“添加克隆站点”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T13:46:43.120

在 Zope 下添加多个 Plone 站点

*   转到 Zope 管理界面根目录：（`http://localhost:8080/manage`这通常直接在端口 8080 下）

*   在真正的 ZMI Zope 根目录中，您将 Plone 站点视为内容项之一

*   在右上角，您应该会看到按钮 Add Plone Site。按下。

![在此处输入图像描述](../Images/d985f6232fcf79b3f7db27d88a0743ff.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T11:55:41.423

你想在 Zope 中设置多个挂载点。每个挂载点都有自己的数据库文件。 [http://plone.org/documentation/kb/multiple-plone-sites-per-zope-in​​stance-using-separate-data-fs-files-for-each-one](http://plone.org/documentation/kb/multiple-plone-sites-per-zope-instance-using-separate-data-fs-files-for-each-one)

# azure - 访问 VM 映像中的页面而不是 VM 角色？

> ID：10298702
> 
> 赞同：0
> 
> 时间：2012-04-24T13:20:01.347
> 
> 标签：azure, azure-vm-role

我将带有 Sharepoint 2010 的 VM 映像部署到 Azure，创建了 VM 角色托管服务来访问它。我应该为我的 VM 映像中的访问页面提供什么 URL，而不是 VM 角色。默认情况下，它为 VM 角色提供一个 URL，该 URL 仅打开 IIS 页面，但我的实际应用程序安装在 VM 映像中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:28:27.417

I'll give you the same response I posted on [your messages in the MSDN](http://social.msdn.microsoft.com/Forums/en-US/windowsazuretroubleshooting/thread/9ff10956-f42b-4f42-a2a0-269835a462ed) forum....

Sharepoint hosting in Windows Azure is NOT supported nor recommended at this time. The stateless nature of the Windows Azure virtual machines makes is exceedingly difficult to reliable operation SharePoint in that envionment.

I highly recommend you abandon the current line of thinking and re-evaluate the scenario. Otherwise you are likely setting yourself up for a long and painful road that ultimate will be less than optimal.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T18:35:04.097

我不确定如何区分“VM Image - IIS”和“VM Role IIS”。如果我理解正确，您的目标是显示默认页面，它是您的 VM 中运行的 Web 服务器的一部分（因为它是 VM 角色并且您已经上传了自己的 VM。在 VM 中的这种情况下，您只有一个 IIS 服务器已配置为在其上运行 SP。因此，据我所知，VM Role IIS 和 VM Image IIS 是相同的。您真正需要的是在您的 VM Role 应用程序中添加一个 HTTP 端点（如果您愿意，也可以添加 HTTPS），这样您的主机可以配置为在 VM 运行时访问您的默认 ASPX 或基于 SP 的 ASPX 页面。在上传之前，请务必在 VM 上测试您的 IIS 服务器是否完全正常运行，就像您希望在 Azure 上看到的那样。

最后@Brent 的建议很重要，所以请听从他的宝贵建议，让自己不再痛苦。

# .net - GAC 文件夹 - 太多？

> ID：10298703
> 
> 赞同：3
> 
> 时间：2012-04-24T13:20:01.767
> 
> 标签：.net, visual-studio-2010, .net-4.0, clr, gac

我越来越困惑

*一劳永逸*

VS 添加参考（/net 选项卡）说 dll 的 gac 在这里： ![在此处输入图像描述](../Images/5984229948ebe52a59a2496825539458.png)

我找到了这个包含 GAC 的文件夹：（ps 为什么是 3 Gac 的类型？） ![在此处输入图像描述](../Images/1b762b61759cd0d97e2ae7348eb0d1fc.png)

还有这个包含 GAC 的文件夹：

![在此处输入图像描述](../Images/f6533660076c5e1925690f220523bb7c.png)

有人可以解决我的头痛吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:55:36.770

`%ProgramFiles%\Reference Assemblies\Microsoft\Framework\v4.0"`文件夹包含那些随 .Net Framework 一起提供的程序集，这些程序集对于在新组件的设计和构建过程中引用很有用。请参阅[http://blogs.msdn.com/b/msbuild/archive/2007/04/12/new-reference-assemblies-location.aspx](http://blogs.msdn.com/b/msbuild/archive/2007/04/12/new-reference-assemblies-location.aspx)。这根本**不是**GAC。

有两种不同的 GAC，一种用于 CLR 2.0，另一种用于 CLR 4.0。一个`%windir%\assembly`由 CLR 2.0（.Net 2.0 到 3.5）`%windir%\Microsoft.NET\assembly`使用，而由大于 2.0 的 CLR 使用（当前仅 4.0）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T13:55:51.793

安装 .NET 4 后，您的系统中实际上有*两个*GAC，一个用于 .NET 2-3.5 版，一个用于 4 版。这已经[在此处进行了解释](https://stackoverflow.com/questions/2660355/net-4-0-has-a-new-gac-why)。这些目录中的每一个都有许多子文件夹，其中包含带有 x86、x64 和 MSIL 代码的程序集图像。

Program Files**中的“参考程序集”目录不是**GAC。

还要回答 Alex Dn 的评论：在 GAC 中安装 DLL 后，您不应该关心 DLL 的去向。的真正目的`gacutil`是向您隐藏这些知识，以便.NET 不会采用熟悉的方式从部分“逆向工程”的人那里获取依赖项，然后例如在他们的应用程序中硬编码路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:47:07.147

我认为出于历史原因，它有两条路径。

他们必须为每个平台拆分程序集（例如 MSIL、Native 32、Native 64、Embedded、ARM 等）

因此，根据您编译流程的方式，您将链接一个或另一个部门。所以在可移植的.net（仅限 MSIL）和托管 C++（仅限本机）之间......

但我完全不确定:)

# c++ - 在 C++ 中查找多个 4 的总和

> ID：10298705
> 
> 赞同：0
> 
> 时间：2012-04-24T13:20:02.790
> 
> 标签：c++

我有作业要设计一个表格。
我对总和有疑问。我不知道他们是什么意思。

当点击“求和”按钮时，将查找所有大于 100 和小于 200 的 4 的倍数之和，并在结果编辑框中显示结果。

我的回答是这样的：

```
if(num>100)||(num<200)

  sum=sum+num 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T13:27:38.543

From what I can gather, it's asking you to "find" all numbers that are divisible by 4, that are between 100 and 200, and then sum them together. I'll provide the pseudo code, but as it's homework, you'll need to figure this one out on your own. :)

```
// Create an array of integers
// Loop from 100 to 200
//     If current index is divisible by 4
//         Add to array
// Sum the array of integers 
```

To help you get started with the code, you'll want to use the `for` loop, e.g.

```
for (var index = 0; i < 10; i++)
{
    // do something 10 times
} 
```

and you'll also want to use the [Mod operand](http://msdn.microsoft.com/en-us/library/0w4e0fzs.aspx) to determine if the current number if divisible by 4\. e.g.

```
if (number % 2 == 0)
{
    // number is even
}
else
{
    // number is odd
} 
```

**Alternative approach**

As suggested by @benhoyt, you could increment your loop index by 4 each time, that way you wouldn't need to `x % y` on each iteration, and your number of overall loop executions would go down. Here's the pseudo code:

```
// Create an array of integers
// Set index to 100
// (This loop determines where we should start)
// Whilst index is not divisible by 4, and index is less than 200
//     Add 1 to index
// Whilst index is less than 200
//     Add index to array
//     Add 4 to index
// Sum the array of integers 
```

Although this approach requires 2 loops, the number of overall loop executions will be reduced. Within the 2nd loop we're adding 4 to the index, thus we won't need to check if `x % y` is true. Our 2nd loop, instead of being a `for` loop, will now look like this:

```
// 2nd loop
while (index < 200)
{
    // add index to array
    index += 4
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-24T14:51:16.413

//我需要恢复我之前给出的断章取义的答案。

```
int i = 100, sum = 0;
while (i <200)
{
   i = i +4;
   if ( i % 4 == 0)
   {
      sum += i;
   }
} 
```

# maven - 为 hyperjaxb3 设置字符编码

> ID：10298708
> 
> 赞同：1
> 
> 时间：2012-04-24T13:20:08.437
> 
> 标签：maven, plugins, hyperjaxb

有没有办法设置 maven hyperjaxb3-plugin 生成的文件的字符编码？开箱即用，生成的 Java 文件使用 ISO-8859-1 字符集编码（至少在我的 Windows 机器上）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T21:18:56.310

这应该会在下一个版本（0.5.7，尚未发布）中自动运行。

对编码的支持在 XJC (2.2.5) 的最后一个版本中实现，因此在 maven-jaxb2-plugin 版本 0.8.1 中实现。maven-hyperjaxb3-plugin 应该会在下一个版本中继承此功能。

编码可以在插件配置（`encoding`元素）中配置。默认情况下是`${project.build.sourceEncoding}`.

如果您不使用 Maven，只需使用`-encoding`XJC 的选项。

# nhibernate - Fluent Nhibernate 不会在 hasmany 中保存布尔值

> ID：10298710
> 
> 赞同：1
> 
> 时间：2012-04-24T13:20:12.657
> 
> 标签：nhibernate, fluent-nhibernate, fluent-nhibernate-mapping

我使用 Nuget 升级到 Nhibernate 3.2.0.4000 和 fluent 1.3.0.717。当我尝试保存时，曾经有效的映射现在给我带来了问题。数据加载正常，但是当我尝试更改任何布尔值时，它们会被忽略。我可以毫无问题地保存文本字段。事实上，我可以一次保存更改文本字段和布尔值，它实际上只是将文本字段更改保存到数据库中。

首先，我有一个选项对象

```
public class Options
{
    public virtual long OptionsId { get; set; }

    private IList<MobileOptions> MobileGatewayList { get; set; }

    public virtual MobileOptions MobileGateway
    {
        get
        {
            if (MobileGatewayList == null)
                return null;

            return MobileGatewayList.FirstOrDefault();
        }
    }

} 
```

对于移动特定选项，我有一堂课

```
public class MobileOptions
{
    public virtual long MobileOptionsId { get; set; }

    public virtual Options Options { get; set; }

    public virtual SharedGatewayOptions SharedGatewayOptions { get; set; }
} 
```

`SharedGatewayOptions`是我所有选项子集的一类共享选项（我有 3 个，但仅显示移动设备以保持此示例简洁）。具体来说，我注意到错误出现在布尔标志中，以启用我的应用程序的移动部分。

```
public class SharedGatewayOptions
{
    public virtual bool GatewayActivated { get; set; }
} 
```

我的主要选项类地图选项中的移动选项映射如下所示

```
HasMany<MobileOptions>(Reveal.Member<GatewayOptions>("MobileGatewayList"))
            .KeyColumn("OptionsId")
            .Cascade.All(); 
```

我不得不使用hasmany，因为包含移动选项的表包含父ID，但父表不包含子表的列。数据库中没有 FK 关系，我无法让 HasOne 工作。

这是 MobileOptions 类图中的映射

```
References<GatewayOptions>(x => x.Options, "OptionsId");

Component(x => x.SharedGatewayOptions, y =>
{
     y.Map(x => x.GatewayActivated, "ActivateGateway").Generated.Insert();
}); 
```

当我创建一个新的选项记录和移动选项时，这一切都很好，并且设置为默认值。但是当我去更改激活布尔值（或任何其他布尔值）时，没有错误，也没有任何东西保存回数据库。`MobileOptions`但是，当我保存文本字段和布尔字段时，在另一个子选项（很像）上，只有文本字段会更改。

我更改位的代码如下所示

```
public void ToggleGateways(ToggleGatewaysRequest request)
{
    var options = GetOptions(new GatewayOptionsRequest() { SiteId = request.SiteId });

    options.RemoteGateway.SharedGatewayOptions.GatewayActivated = request.RemoteGatewayActivated;

    optionsRepository.Save(options);
} 
```

此代码曾经可以工作，但自从升级后它不再工作了。我跟踪它并且对象正在内存中被更改，但是在下一个请求中，对象被“还原”。我已经逐步检查了代码以查看在下一个请求中我是否以某种方式导致该位翻转，但事实并非如此。数据库永远不会变硬。就好像最新的 fluent 不再知道如何在保存时映射 boolean -> bit。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T08:21:17.283

AFAIK`.Generated.Insert();`意味着这个属性是在插入时生成的，然后永远不会改变，但既然你想改变它，你应该把它排除在外。

不是您问题的直接答案，但您是否考虑过加入另一个表以获得所需的值？

```
public class Options
{
    public virtual long OptionsId { get; set; }

    public virtual MobileOptions MobileGateway { get; set; }
}

// in OptionsMap
Join("MobileOptions", join =>
{
    join.Optional();
    join.KeyColumn("OptionsId");
    join.Component(x => x.SharedGatewayOptions, y =>
    {
        y.Map(x => x.GatewayActivated, "ActivateGateway");
    });
}); 
```

或替代类设计

```
public class GatewayOptions
{
    public virtual bool GatewayActivated { get; set; }
}

public class MobileOptions : GatewayOptions
{
    public virtual bool Something { get; set; }
}

// in OptionsMap
RefernecesAny(x => x.Options)...; 
```

# git - 在本地复制 master 分支

> ID：10298714
> 
> 赞同：0
> 
> 时间：2012-04-24T13:20:33.220
> 
> 标签：git, gitbox

我怎样才能合并这些？我不知道这是怎么发生的，我之前只与一个分支合作过，今天我要创建一个新分支（顶部模糊了一个）。

请注意：我是前端开发人员，基本上只知道（关于 git）我需要使用这个软件（gitbox）

编辑：我似乎无法将它们合并到 gitbox 中，我不能只选择其中一个总是被选中，我也尝试过重新启动 gitbox。

![重复主分支](../Images/c2dfb202e143df05342d2d7de57cf0d8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T14:13:33.047

似乎没有什么可以合并的。可能只是您的 GUI 工具上的一个错误。尝试打开终端并列出项目的分支：

```
git branch 
```

此命令将显示您的实际分支和当前使用的分支，前面带有星号 (*)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T08:47:09.407

我实际上有两个主分支，一个叫做“master”，一个叫做“master（computer_name）”，因为我愚蠢地尝试在我的站点文件夹上使用 Sugarsync（如 dropbox），而且我错误地添加了文件夹，因此它几乎复制了每个文件并在括号内添加了我的计算机名称。

（我做这个的时候感冒了）

我关闭了 gitbox 并删除了所有重复的文件，就像一个魅力。

# blackberry - 如何从我的应用程序中截取黑莓主屏幕的屏幕截图？

> ID：10298721
> 
> 赞同：1
> 
> 时间：2012-04-24T13:20:45.443
> 
> 标签：blackberry, blackberry-simulator, blackberry-eclipse-plugin

如何从我的应用程序中截取黑莓设备的[主屏幕](http://www.google.com/search?hl=en&client=firefox-a&hs=rJ7&rls=org.mozilla%3aen-US%3aofficial&tbm=isch&ct=mode&cd=2&q=Blackberry%20Home%20Screens&spell=1&sa=X&sout=0&ei=RQCXT6CkIYLTrQfNkrXeDQ&ved=0CCoQxxQ&biw=1304&bih=662&sei=UgCXT4nuPIrirAedg9nxDQ)（主显示屏）屏幕[截图（将其用作我的应用程序中的背景图像）？](http://en.wikipedia.org/wiki/Screenshot)我用过，但它需要我的应用程序当前屏幕的屏幕截图，我需要我设备主屏幕的屏幕截图。[`Display.screenshot(bm)`](http://www.blackberry.com/developers/docs/4.5.0api/net/rim/device/api/system/Display.html#screenshot%28net.rim.device.api.system.Bitmap%29)

```
private class CaptureThread extends Thread {

    public CaptureThread() {
    }

    public void run() {
        FileConnection fc = null;
        DataOutputStream out = null;

        try {

            // MainScreen objMainScreen=new MainScreen();

            int width = Display.getWidth();
            // int width=objMainScreen.getWidth();
            int height = Display.getHeight();

            Bitmap bm = new Bitmap(width, height);
            Display.screenshot(bm);

            PNGEncodedImage png = PNGEncodedImage.encode(bm);

            // Save the PNG to the micro SD card.
            fc = (FileConnection) Connector
                    .open("file:///SDCard/BlackBerry/pictures/screenCap.png");

            if (fc.exists()) {
                fc.delete();
            }

            fc.create();

            out = fc.openDataOutputStream();
            out.write(png.getData());
        } catch (Exception ex) {
            System.out.println("Exception: " + ex.toString());
        } finally {

            if (out != null) {
                try {
                    out.close();
                } catch (IOException e) {
                }
            }

            if (fc != null) {
                try {
                    fc.close();
                } catch (IOException e) {
                }
            }
        }
    }
} 
```

# php - PHP：具有嵌套键/值语法的字符串到多维数组

> ID：10298722
> 
> 赞同：0
> 
> 时间：2012-04-24T13:20:50.953
> 
> 标签：php, regex, multidimensional-array, nested

我正在搜索结合 php-recursion 的正则表达式，以将具有嵌套键/值语法的字符串解析为多维数组。有谁知道我怎么能做到这一点？感谢您的帮助！

```
$string = "value1 | key2=value2 | [value3.1 | key3.2=value3.2 | key3.3=[key3.3.1=value3.3.1]]";

$result = parseSyntax($string);

// RESULT
//===============================================
array(
 '0' => 'value1',
 'key2' => 'value2',
 '1' => array(
  '0' => 'value3.1',
   'key3.2' => 'value3.2',
   'key3.3' => array(
     'key3.3.1' => 'value3.3.1'
   )
  )
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T14:43:09.260

代码不干净，但试试吧，它对我有用：

```
<?php

function parseSyntax($string)
{
    // Get each parts in the string
    $toparse = array();

    do
    {   
        array_unshift($toparse, $string);

        preg_match('/\[.+\]/', $string, $matches);
        if(count($matches) > 0) {
            $begin = strpos('[', $string)+1;
            $end = strrpos(']', $string)-1;
            $string = substr($matches[0], $begin, $end);
        }
    }
    while(count($matches) > 0);

    // Get data in an array for each part
    $last = NULL;
    $final = array();
    do
    {
        $toExplode = $toparse[0];
        if($last !== NULL)
            $toExplode = str_replace ($last, '', $toparse[0]);

        $result = array();
        $cells = explode(' | ', $toExplode);
        foreach ($cells as $cell) {
            $pairs = explode('=', $cell);
            if(count($pairs) > 1)
                $result[$pairs[0]] = $pairs[1];
            else 
                $result[] = $pairs[0];
        }

        $last = $toparse[0];

        array_unshift($final, $result);
        array_splice($toparse, 0, 1);

    }
    while(count($toparse) > 0);

    // With each subarray, rebuild the last array
    function build($arrays, $i = 0)
    {
        $res = array();
        foreach ($arrays[$i] as $key => $val) {
            if($val == '[]') {
                $res[$key] = build ($arrays, $i+1);
            } else
                $res[$key] = $val;
        } return $res;
    }

    $final = build($final);

    // Display result
    return $final;
} 
```

# php - 在 javascript 调用中从 mysql 数据库中选择

> ID：10298737
> 
> 赞同：1
> 
> 时间：2012-04-24T13:21:39.193
> 
> 标签：php, javascript, jquery, mysql, ajax

我有一个用 PHP 和 Javascript/jQuery 构建的小型 Web 应用程序。

该应用程序涉及一个随机数生成器，当它落在数字 4 时，用户获胜。

然而，奖品是从数据库中提取的，并且在每天赢得 5 个奖品之后。用户无法获胜。

一旦用户获胜，奖品将更新为“排队”，直到他们填写表格并领取奖品。然后从可用奖品中取出。

如果用户刷新应用程序，这一切都可以正常工作。但是，如果一个用户开始玩应用程序并且另一个用户获胜，那么应用程序将不会更新，除非它被刷新，因为 PHP 是服务器端的。

我有一个 JavaScript 函数 OnStart。因此，如果我可以在这里执行 SQL 查询，那么每次用户掷骰子时都会发生这种情况。

如何从 jquery 函数运行 php 语句？

如果它有帮助，这里是声明：

```
$result = mysql_query("SELECT * FROM prizes WHERE dateavailable='$todayDate' AND queue='0' AND won='0' ORDER BY id ASC LIMIT 1");

while($row = mysql_fetch_array($result))

{   
    $prize = $row['prize'];
} 
```

谢谢

编辑：

所以我可以在一个单独的文件中使用这样的东西和 php。

```
<script type="text/javascript">
  function performAjaxSubmission() {
    $.ajax({
      url: 'file.php',
      method: 'POST',
      data: {
        action: 'save',
        arg1: 'val1',
        arg2: 'val2'
      },
      success: function() {
        alert("success!");
      }
    });
    return false; // <--- important, prevents the link's href (hash in this example) from executing.
  }

  jQuery(document).ready(function() {
    $("#linkToClick").click(performAjaxSubmission);
  });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:33:02.153

你必须使用 AJAX，jQuery 包含一些易于使用的函数来使用 AJAX。

用法很简单，您可以在[docs.jquery.com中阅读相关内容](http://docs.jquery.com)

如果您想将一些数组传递给您的 js 脚本，请查找 JSON 函数（`$.getJSON`在 jQuery 中，`json_decode`/`json_encode`在 PHP 中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:39:29.653

将发布的代码保存在一个 php 文件中，我们称之为`prizes_available.php`. 该文件还应该输出奖品是否可用，因此创建结果对象并为其分配值：

```
$result = new stdclass();
$result->prizes_available = $prize != null;
echo json_encode($result); 
```

如果您在浏览器中调用此脚本，它将输出如下内容：

```
{ prizess_available: true } 
```

使用 jQuery，您可以轻松地将这个字符串再次转换为对象：

```
$.getJSON('prizes_available.php', function(result)  {
    if (!result.prizes_available) {
        alert('no more prizes');
    }
}); 
```

# java - 使用 Java 的贝叶斯网络 API

> ID：10298739
> 
> 赞同：1
> 
> 时间：2012-04-24T13:21:44.943
> 
> 标签：java, bayesian-networks

是否有任何 API 用于使用 java 构建影响图的贝叶斯网络？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T17:55:40.230

我发现了两个带有 Java API 的影响图引擎，它们是免费和开源的：

[http://genie.sis.pitt.edu/](http://genie.sis.pitt.edu/)

> SMILE（结构建模、推理和学习引擎）是一个完全可移植的 C++ 类库，实现了图形决策理论方法，例如贝叶斯网络和影响图，可直接包含在智能系统中。

[http://sourceforge.net/projects/unbbayes/](http://sourceforge.net/projects/unbbayes/)

> UnBBayes 是一个用 Java 编写的概率网络框架。它有一个 GUI 和一个具有推理、采样、学习和评估功能的 API。支持BN、ID、MSBN、OOBN、HBN、MEBN/PR-OWL、PRM、结构、参数和增量学习。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-17T15:09:13.587

来自[杰伊斯](http://www.eclipse.org/recommenders/jayes/)网站：

> ## Jayes 是什么，不是什么
> 
> [Jayes](http://www.eclipse.org/recommenders/jayes/)是一个用于贝叶斯网络和此类网络推理的 Java 库。目前，没有包含学习组件。（不过，我们可以推荐[Apache Mahout](http://mahout.apache.org/)库。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:51:33.100

它不是免费的，但 Norsys Netica 有一个 Java API。它也不漂亮。

[http://www.norsys.com/netica-j.html](http://www.norsys.com/netica-j.html)

# c# - MS Visual Studio IDE 提示

> ID：10298742
> 
> 赞同：6
> 
> 时间：2012-04-24T13:21:54.683
> 
> 标签：c#

作为一名 java 开发人员，我需要在 C# 上工作。

我熟悉 Eclipse IDE。在 MS Visual Studio 2010 Ultimate 中，如何进行类似操作？

1.  如果我使用 F12 查看定义，那么我怎样才能回到原始文件？

2.  对于接口，如何查看所有实现该接口或方法的类？在 Eclipse 中，我们只需使用 CTRL+K。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:24:56.357

1）如果您的鼠标有一个“后退”拇指按钮，您通常可以使用它来向后导航。否则，将键盘快捷键绑定到“View.NavigateBackward”（编辑：默认键绑定是`Ctrl`+ `-`）。或单击此按钮：

![](../Images/41da5f264027907847c7bfc75007f457.png)

2) 如果没有某种扩展，这是不可能的，Visual Studio 不支持这个开箱即用。您可以做的最好的事情是在接口上“查找所有引用”，其结果应该包括实现该接口的每个类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:27:53.693

但是不确定第二个请求：

1.  `CTRL+-`回到之前的位置
2.  `CTRL+K, R`查找所有参考资料

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:26:15.970

1.  右键单击“转到定义”
2.  不支持，因为它是一个会导致错误的坏功能。你不应该使用它。原因？很可能不会加载具有实现接口的类型的重要项目，因此这会导致您误以为您已经接触了每个实现者。大多数时候，当您想要这样做时，您在继承树上寻找错误的方向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T13:29:32.347

按 F12 并导航到函数定义后，您可以使用 Ctrl+TabKey 返回源文件。

此外，有关 VS 2010 键盘快捷键的详细列表，请参阅此[列表](http://msdn.microsoft.com/en-us/library/da5kh0wa.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T13:32:08.320

对于第一个，F12 将带您到定义...其中 Ctrl + - (减号) ....将带您回到以前的位置...

正如其他人提到的那样，不支持第二种情况...这是 Visual Studio 2010 的[预定义键盘快捷键](http://msdn.microsoft.com/en-us/library/da5kh0wa.aspx)列表...对您有用...

# maven - maven：用同一个pom文件生成几个“工件”？

> ID：10298744
> 
> 赞同：12
> 
> 时间：2012-04-24T13:22:09.067
> 
> 标签：maven

我在[这里](https://github.com/fge/json-schema-validator)有一个项目，目前，它使用一个 pom.xml ( [link](https://github.com/fge/json-schema-validator/blob/master/pom.xml) ) 来生成一个“工件”。

我想做的是将项目（我们称之为 p）拆分为：

*   p-core，包含核心验证过程；
*   p-format，其中包含“format”关键字验证，这取决于p-core。

我想这样做的原因是依赖关系：p-format 仅在数量上就吸收了 70% 以上的内容，而且 JSON Schema 的很多使用都不需要格式支持。

我需要构建两个完全独立的项目，还是可以使用一个 pom.xml 来生成这两个工件？我想后者是可行的，因为很多项目已经这样做了（例如杰克逊）。

[如果它有任何重要性，我会通过 Sonatype 的 maven repo 发布]

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-24T13:48:09.717

您应该创建两个独立的项目（两个独立的 POM），但可能一个好主意是为它们创建公共父级，并将它们聚合为模块。查看[POM 简介的](http://maven.apache.org/guides/introduction/introduction-to-the-pom.html)*项目继承*和*项目聚合*部分了解一些基础知识。

在 Maven 中，尝试破解它绝不是一个好主意，因此它会从一个 POM 生成许多不同的工件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T13:46:06.483

如果您简单地将 p-format 分解为一个依赖于 p-core 的单独项目，您的生活将会轻松得多。

尽管有多种方法可以为每个项目发布多个工件，但 Maven 是围绕每个 pom/模块（加上测试工件）一个工件而设计的。根据经验，围绕这个设计点的巧妙尝试最终*会咬你一口——通常是在 6 个月后出现问题，包装无法在某人的机器上正常工作。*

您描述的场景非常适合多项目用例，我建议您顺其自然，让您未来的自我快乐。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T14:01:42.047

您可以使用[maven-assembly 插件](http://maven.apache.org/plugins/maven-assembly-plugin/)。如果两个工件有重叠的类并且更新一个总是需要更新另一个，那么这是一个不错的选择。

您必须考虑工件的生命周期。两个工件是否需要具有相同的版本号？每当您修复 p 格式的错误时，您想发布新版本的 p-core 吗？p核本身有用吗？

我猜，程序集插件应该主要用于为同一个工件提供不同的包装。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-09T08:17:58.573

我有一个类似的案例，我同意 Michal 的建议。但是，我想进一步扩展建议的解决方案：

我假设 p 有一个单一的来源，并且 p-core 和 p-format 都是从中生成的。因此，您应该为 p 创建一个带有子模块（及其各自的 POM）的父 POM——一个用于“核心”，一个用于“格式”，但这些都来自父的 /src/。

因此，基本上我们将“核心”和“格式”的构建过程分离以生成特定的工件，但不复制 p 的原始源。

Maven 支持但不推荐这种方法，但我不明白他们为什么不应该这样做。在我看来，它的结构化、干净和关注分离没有任何长期影响，没有更好的选择。

[http://maven.apache.org/guides/mini/guide-using-one-source-directory.html](http://maven.apache.org/guides/mini/guide-using-one-source-directory.html)

# vb.net - 使用 vb.net 代码将水晶报表连接到 oracle 数据库

> ID：10298753
> 
> 赞同：0
> 
> 时间：2012-04-24T13:22:30.157
> 
> 标签：vb.net, oracle, crystal-reports

我正在做的这个项目中使用水晶报表 9、visual studio 2008 和 oracle 9i。我的水晶报表从 oracle 数据库中提取数据，并显示在 windows 窗体上的 CrystalReportViewer 上。我将如何使用 vb.net 代码建立这种连接？

想象一下这个小场景：

oracle 服务器的主机名是 myHost。数据库名称是 myData 用户名是 myUser 密码是 myPass。

请用代码帮助我建立这种联系。

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:25:49.407

基本上，你有几个选择。如果您在 Crystal Report 中创建了一个连接，那么您可以将不同的登录凭据传递给该报表，Crystal 将处理它。你必须以特定的方式完成它，否则它不会起作用（它对它的完成顺序非常挑剔）。您将循环浏览报告和所有提交新凭证的子报告。第二条路线是使用 DataTable 作为您的数据源，通过 VB.Net 填充它并将其交给（这听起来不像您想要的路线）。

这里有两个博客条目，我在其中描述了如何将新的登录凭据传递给 Crystal。

[https://www.blakepell.com/2010-09-17-crystal-reports-changed-the-database-connection-from-net-subreport-links-and-the-case-of-the-missing-parameter-价值观](https://www.blakepell.com/2010-09-17-crystal-reports-changing-the-database-connection-from-net-subreport-links-and-the-case-of-the-missing-parameter-values)

[https://www.blakepell.com/2012-05-22-crystal-reports-extension-methods](https://www.blakepell.com/2012-05-22-crystal-reports-extension-methods)

在第一个博客条目中有一个“Private Sub ApplyNewServer(ByVal report As ReportDocument)”，它将向您展示如何传递您的新登录名和服务器信息。它是从另一个类中提取的，因此可能需要稍作修改才能引用您要传入的登录参数。

祝你好运。;)

# google-app-engine - 两个 AppEngine 应用程序如何相互通信？

> ID：10298755
> 
> 赞同：2
> 
> 时间：2012-04-24T13:22:42.243
> 
> 标签：google-app-engine

我尝试在 Google App Engine 中构建应用程序，但我有一些问题，不知道如何解决。

我尝试构建两个应用程序，一个是从用户那里获取一个字符串，另一个是像划分或加密一样处理字符串。

我的问题是如何在 Google App Engine 中的两个应用程序之间传输字符串？我可以构建一个应用程序只处理字符串，不显示WEB页面。

任何人都可以给我一些提示吗？多谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T14:39:49.230

两个 AppEngine 应用程序相互通信的唯一方法是通过正常的 HTTP 请求/响应模型。对于您的情况，我们将拥有 App A，它回答来自用户的请求，用户提供要处理的字符串。App B 将接收来自 App A 的请求，该请求将传递要处理的字符串。

1.  *应用程序 A*处理一些任意值`/providestring?string=...`的URL`...`
2.  *应用 B*处理任意值`/processstring?string=...`的URL`...`
3.  *用户*使用浏览器或编写应用程序来调用`/providestring`
4.  *应用 A 的*URL 处理代码运行并提取`string`参数的值
5.  *App A*使用[URLFetch](https://developers.google.com/appengine/docs/python/urlfetch/)调用*App B 的* `/processstring`
6.  *应用程序 B 的*URL 处理代码运行并提取`string`参数的值，并执行它所做的任何类型的处理，并向调用者发送某种类型的响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:31:50.473

一种方法是拥有一个共享数据库。应用 A 会获取用户数据并将其保存到数据库中。应用 B 会提取用户数据并进行处理。

已接受的功能请求是多个 App Engine 应用程序共享数据存储访问 [1]。

多个 App Engine 应用程序可以共享对 Google Cloud SQL 实例的访问 [2]。

```
To grant access to your App Engine application:

From the Google Cloud SQL pane of the APIs Console, find the instance that you 
want to grant access to and click the on the name of your instance.
Click on the Instance settings button on the instance's dashboard.
On the Instance settings window that appears, enter your Google App Engine
application ID under the Authorized applications section. You can grant access to
multiple applications, by entering them one at a time. 
```

注意：您可以通过使用数据存储的一个应用程序来实现这一点。以下是一些公认的模式：

1.  RequestHandler 接收用户数据，将任务排队以处理数据并保存。
2.  RequestHandler 接收用户数据并保存它。cron 作业会提取该类型的所有最新模型、处理它们并保存处理后的数据。

[1] [https://code.google.com/p/googleappengine/issues/detail?id=1300](https://code.google.com/p/googleappengine/issues/detail?id=1300)

[2] [https://developers.google.com/cloud-sql/docs/before_you_begin#configure_access_control](https://developers.google.com/cloud-sql/docs/before_you_begin#configure_access_control)

# jquery - JQUERY AJAX - 在成功的情况下更改 $(this) 的类

> ID：10298756
> 
> 赞同：4
> 
> 时间：2012-04-24T13:22:43.187
> 
> 标签：jquery, ajax

我有一个div。在那个 div 里面我有多个元素。某些元素具有类“myClass”。我也有一个按钮。单击时，将为每个在 div 中具有类 myClass 的元素运行一个 foreach 循环。为每个元素发送一个 ajaxCall。这些元素的文本颜色默认为黑色。在ajax调用成功的情况下。我想删除类 classBlackFont 并添加一个 classGreenFont。我尝试了以下代码，尽管 ajax 调用成功，但不幸的是没有切换类。

```
$("#someDiv .myClass").each(function() {

    var ajaxData = "myAjaxData";
    $.ajax({
        type: "POST",
        url: "somefile.php",
        data: ajaxData,
        success: function(data) {

            $(this).removeClass('classBlackFont').addClass('classGreenFont');
        }
    });

});​ 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-24T13:23:57.233

`this`不会自动引用 ajax 回调中的正确对象。您可以通过关闭具有正确值的变量来更改*它：*

```
$("#someDiv .myClass").each(function() {
    var $this = $(this);
    var ajaxData = "myAjaxData";
    $.ajax({
        type: "POST",
        url: "somefile.php",
        data: ajaxData,
        success: function(data) {
            $this.removeClass('classBlackFont').addClass('classGreenFont');
        }
    });

});​ 
```

或使用以下[`context`选项`$.ajax()`](http://api.jquery.com/jQuery.ajax/)：

```
$("#someDiv .myClass").each(function() {
    var ajaxData = "myAjaxData";
    $.ajax({
        type: "POST",
        url: "somefile.php",
        data: ajaxData,
        context: this,
        success: function(data) {
            $(this).removeClass('classBlackFont').addClass('classGreenFont');
        }
    });

});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-26T13:38:30.863

上下文：这个

喜欢某事

```
/**
* Default ajax
*/
$.ajaxSetup({
        type: 'post',
        dataType: 'json',
        context: this
}); 
```

# jquery - 诺基亚 E71 Jquery 未使用 facebook API 重定向到 facebook 登录

> ID：10298759
> 
> 赞同：1
> 
> 时间：2012-04-24T13:22:54.050
> 
> 标签：jquery, facebook, login, nokia

我使用 Facebook API 为 facebook 登录编写移动网络代码，当我在 iPhone 和 BlackBerry 上运行代码时，它工作正常重定向到 Facebook 登录页面并在警报框中为我提供与配置文件相关的 Json 数据，但此代码不起作用对于诺基亚 E71 手机，通过单击登录按钮，它没有重定向，没有发生任何事件，我在某处搜索并发现诺基亚不支持 Jquery 呼叫，我使用 jquery 1.3.2、1.4.2、1.7.2、1.5 进行了检查。

所以请给我一个有价值的解决方案谢谢

# ios - 有没有办法使同步关键字不阻塞主线程

> ID：10298762
> 
> 赞同：2
> 
> 时间：2012-04-24T13:23:05.557
> 
> 标签：ios, multithreading, ios5, thread-safety

想象一下，您想在 iOS 应用程序的后台做很多事情，但您正确地对其进行了编码，以便您创建线程（例如使用 GCD）来执行此后台活动。

现在，如果您需要在某些时候编写更新变量，但此更新可能发生或您创建的任何线程发生。

您显然想保护该变量，您可以使用关键字`@synchronized`为您创建锁，但这里有一个问题（摘自 Apple 文档）

> 该`@synchronized()`指令锁定一段代码供单个线程使用。其他线程被阻塞，直到线程退出受保护的代码——也就是说，当执行继续超过`@synchronized()`块中的最后一条语句时。

这意味着如果您同步一个对象并且两个线程同时写入它，即使主线程也会阻塞，直到两个线程都完成写入数据。

将展示所有这些的代码示例：

```
// Create the background queue
dispatch_queue_t queue = dispatch_queue_create("synchronized_example", NULL);

// Start working in new thread
dispatch_async(queue, ^
               {                   
                   // Synchronized that shared resource
                   @synchronized(sharedResource_)
                   {   
                       // Write things on that resource
                       // If more that one thread access this piece of code:
                       // all threads (even main thread) will block until task is completed.
                       [self writeComplexDataOnLocalFile];
                   }                         
               });

// won’t actually go away until queue is empty
dispatch_release(queue); 
```

所以问题很简单：如何克服这个问题？除了我们知道在这种情况下不需要阻塞的主线程之外，我们如何安全地在所有线程上添加锁？

**编辑澄清**

正如你们中的一些人评论的那样，只有两个试图获取锁的线程应该阻塞，直到它们都完成，这似乎是合乎逻辑的（这显然是我在使用同步时最初的想法）。

然而，在实际情况下测试，情况似乎并非如此，主线程似乎也受到锁的影响。

我使用这种机制在单独的线程中记录事物，这样 UI 就不会被阻塞。但是当我进行密集的日志记录时，UI（主线程）显然受到很大影响（滚动不那么流畅）。

所以这里有两个选择：要么后台任务太繁重以至于连主线程都会受到影响（我对此表示怀疑），或者同步在执行锁定操作时也会阻塞主线程（我正在重新考虑）。

我将使用 Time Profiler 进一步挖掘。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:29:21.193

我不确定我是否理解正确，`@synchronize`不会阻塞所有线程，而只会阻塞想要执行块内代码的线程。所以解决方案可能是；不要在主线程上执行代码。

如果您只是想避免让主线程获取锁，您可以这样做（并造成严重破坏）：

```
dispatch_async(queue, ^
               {              
                   if(![NSThread isMainThread])
                   {
                       // Synchronized that shared resource
                       @synchronized(sharedResource_)
                       {   
                           // Write things on that resource
                           // If more that one thread access this piece of code:
                           // all threads (even main thread) will block until task is completed.
                           [self writeComplexDataOnLocalFile];
                       }          
                   }
                   else
                       [self writeComplexDataOnLocalFile];               
               }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T13:33:38.320

我相信您误解了您从 Apple 文档中引用的以下句子：

> 其他线程被阻塞，直到线程退出受保护的代码......

这并不意味着所有线程都被阻塞，它只是意味着所有试图在同一个对象上同步的线程（`_sharedResource`在你的例子中）都被阻塞了。

以下引用摘自 Apple 的[线程编程指南](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Multithreading/ThreadSafety/ThreadSafety.html)，它清楚地表明只有在同一对象上同步的线程才会被阻塞。

> 传递给@synchronized 指令的对象是用于区分受保护块的唯一标识符。如果您在两个不同的线程中执行上述方法，为每个线程上的 anObj 参数传递不同的对象，则每个线程都将获取其锁定并继续处理而不会被另一个线程阻塞。但是，如果在这两种情况下都传递相同的对象，则其中一个线程将首先获取锁，而另一个线程将阻塞，直到第一个线程完成临界区。

**更新**：如果您的后台线程正在影响界面的性能，那么您可能需要考虑在后台线程中放置一些睡眠。这应该允许主线程有时间更新 UI。

我意识到您正在使用 GCD，但是，例如，`NSThread`有几个方法可以暂停线程，例如`-sleepForTimeInterval:`. 在 GCD 中，您可能只需调用`sleep()`.

或者，您可能还想考虑将线程优先级更改为较低的优先级。再次，`NSThread`有`setThreadPriority:`为此目的。在 GCD 中，我相信您只会对调度的块使用低优先级队列。

# css - Twitter Bootstrap 响应式 .hidden-desktop 类在 IE7 中无法使用 respond.js

> ID：10298764
> 
> 赞同：1
> 
> 时间：2012-04-24T13:23:09.513
> 
> 标签：css, internet-explorer-7, twitter-bootstrap

我添加了 respond.js 来支持 IE7-8 中的媒体查询。出于某种原因，“隐藏桌面”类在 IE8 中工作，但在 IE7 中不工作。请注意，其他响应式 Bootstrap 类在 IE7 中也可以使用，例如“visible-desktop”。

有谁知道为什么？

提前谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:32:25.797

问题是由于 bootstrap-responsive.css 中的以下定义造成的：

.hidden-desktop { 显示：继承！重要；}

IE7 不支持显示：继承。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T16:19:17.450

IE7 实际上有一个解决方案，即使它不支持继承。请看这个线程：

[https://stackoverflow.com/a/18854835/1370033](https://stackoverflow.com/a/18854835/1370033)

# iphone - 宣布在 facebook 上玩 ios 的游戏

> ID：10298766
> 
> 赞同：0
> 
> 时间：2012-04-24T13:23:19.033
> 
> 标签：iphone, ios, facebook

我在我的 facebook 订阅公告上看到某某玩过这个游戏。

![在此处输入图像描述](../Images/9b2f1061054d64a978bf4905ab11e360.png)

我想知道，这只是用户玩这个游戏时应用程序在某人墙上发布的常规帖子吗？或者当用户通过登录在 facebook 上注册他们的游戏时，它是某种其他类型的公告？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:41:39.813

[http://developers.facebook.com/docs/mobile/ios/build/](http://developers.facebook.com/docs/mobile/ios/build/)第 5 步是一个选项，或者您从应用程序用户那里获得 publish_actions 许可，然后您可以通过应用程序发布到他们的墙上。

# php - Symfony 1.4 不同角色的不同 CRUD

> ID：10298767
> 
> 赞同：0
> 
> 时间：2012-04-24T13:23:25.383
> 
> 标签：php, symfony1, crud, user-roles

我想为**Symfony 1.4**项目中的不同角色提供指定的操作。

*项目包含几个数据库表，其值只能由某些角色修改。*

例如，管理员可以访问所有模型的 CRUD。另一个角色（让它成为顾问）只能从指定的模型（不是全部）中检索（而不是修改或删除）结果。

如何在 symfony 中支持这样的功能？我假设将提前指定项目的角色。

我正在考虑的一个解决方案是分别为每个角色创建模块和操作（crud 面板 + 一个日志界面），但这听起来像是一项艰巨的工作。

只是想知道更聪明的方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T14:18:34.263

我认为实现这一目标的最佳方法绝对是[凭证](http://www.symfony-project.org/book/1_2/06-Inside-the-Controller-Layer#chapter_06_action_security)（适用于 sf1.2，但适用于 1.4）。

我建议您使用[sfGuardDoctrine](http://www.symfony-project.org/plugins/sfDoctrineGuardPlugin)来使用一些具有相关权限（即凭据）的组。您定义了一个组*admin*、*advisor*等。您关联了一些凭据，例如*modifiy*、*remove*、*create*、*edit*等。

 ***然后，每次用户登录时，它都会自动具有定义的凭据（与他或他的组相关联）。

之后，您必须检查用户是否可以执行每个操作：

```
if($this->getUser()->hasCredential('modify'))
{
  // authorized action
} 
```

这是sfGuard 的[更多文档](http://trac.symfony-project.org/wiki/sfGuardPluginExtraDocumentation)（与 sf1.0 相关，但最好了解它的工作原理）。***

# java - Guava 缓存在第二次命中时返回空结果

> ID：10298768
> 
> 赞同：4
> 
> 时间：2012-04-24T13:23:29.060
> 
> 标签：java, caching, guava

我对番石榴缓存有一个奇怪的（至少对我来说）行为。第一次命中后，以下访问将返回一个空对象。我没有使用奇怪的驱逐，所以我不知道我在哪里做错了。我声明了以下LoadingCache：

```
LoadingCache<String, Vector<Location>> locations = CacheBuilder.newBuilder()
            .maximumSize(100000)
            .build(
                    new CacheLoader<String,Vector<Location>>() {
                        @Override
                        public Vector<Location> load(String key)  {
                            return _getLocationListByTranscriptId(key);
                        }
                    }); 
```

我只在这种方法中使用它：

```
public Vector<Location> getLocationListByTranscriptId (String transcriptid) {
    if (transcriptid.equals("TCONS_00000046"))  System.out.println("tcons found, will this work?");
    Vector<Location> result;
    try {
        result = locations.get(transcriptid);
    } catch (ExecutionException e) {
        System.err.println("Error accessing cache, doing the hard way");
        result = _getLocationListByTranscriptId(transcriptid);
    }
    if (transcriptid.equals("TCONS_00000046")){
        if (result.size()==0){
            System.out.println("this is a problem");
            return null;
        }
        System.out.println("this is good!");
    }
    return result;
} 
```

迭代输入字符串的集合，我得到以下输出：

```
tcons found, will this work?
this is good!
tcons found, will this work?
this is a problem 
```

因此，我第一次使用缓存时，它可以工作，但是 A）该值未正确存储以供将来访问；B）该值被重置为一些奇怪的行为。我能做些什么？感谢大家阅读本文！

编辑：感谢 axtavt 的回答，我可以立即弄清楚我在哪里编辑结果列表。不知道为什么，我确信番石榴缓存会返回值的副本。感谢您的回答，以及有关防御性编程的建议。（对不起，如果我还不能评价你的答案）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T13:37:55.210

我相信你不小心清除了`Vector`代码中的某个地方。有两种可能：

*   `Vector`由从缓存中获取它的代码修改。

    可以通过制作防御性副本（尽管它破坏了缓存的想法）或返回不可变的集合视图来防止这种错误：

    ```
    LoadingCache<String, List<Location>> locations = CacheBuilder.newBuilder()
         .maximumSize(100000)
         .build(
                 new CacheLoader<String, List<Location>>() {
                     @Override
                     public List<Location> load(String key)  {
                         return Collections.unmodifiableList(
                             _getLocationListByTranscriptId(key));
                     }
                 }); 
    ```

    这样修改代码后，很容易发现非法修改集合的地方。

    请注意，没有不可修改的视图`Vector`，因此`List`应改为使用。

*   `_getLocationListByTranscriptId()`将其结果存储在一个字段中，可以通过其他方法（或同一方法的其他调用）访问它。因此，您应该检查`_getLocationListByTranscriptId()`是否不会在字段中留下对其结果的任何引用。

# c# - ITextSharp：从表单字段中删除“滚动长文本”

> ID：10298770
> 
> 赞同：0
> 
> 时间：2012-04-24T13:23:37.307
> 
> 标签：c#, asp.net, pdf, itextsharp

我想在标记该字段之前以编程方式从 PDF 中的表单字段中删除“滚动长文本”字段。我想在任何时候为给定的表单字段启用此设置的字段。我最近遇到了类似的问题，并使用我在这篇文章底部发布的解决方案解决了这个问题：[ITextSharp: Remove character Limit from a form field](https://stackoverflow.com/questions/10215119/itextsharp-remove-character-limit-from-a-form-field/10222175#10222175)

我认为我应该能够在同一区域执行此操作，但我不确定我需要寻找哪个 PdfName 设置来检测（并删除）此设置。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:58:35.727

根据[PDF 规范](http://www.adobe.com/devnet/pdf/pdf_reference.html)，部分`12.7.4.3`，**交互功能 -> 交互表单 -> 字段类型 -> 文本字段**，您要设置字段标志 ( `Ff`) 值。该值是位标记，位置 24 是“DoNotScroll”标记。位置 24 将是 binary`1000 0000 0000 0000 0000 0000`或 hex `0x800000`。使用这个和其他帖子中的代码，您可以添加它，它应该可以满足您的需求：

```
if (AnnotationDictionary.Contains(PdfName.FF)) {
    int Ff = AnnotationDictionary.GetAsNumber(PdfName.FF).IntValue;
    int doNotScrollBit = 0x800000;
    Ff = doNotScrollBit | Ff;
    AnnotationDictionary.Put(PdfName.FF, new PdfNumber(Ff));
} 
```

# c++ - 我应该使用 Malloc 吗？大量对象的错误

> ID：10298773
> 
> 赞同：1
> 
> 时间：2012-04-24T13:23:45.457
> 
> 标签：c++

我正在使用一些在框架上运行的遗留类型代码，所以我无法真正解释在较低级别发生了什么，因为我不知道。

但是，我的代码创建了一系列目标。

```
int maxSize = 20;
    myObjects = new Object*[maxSize+1];

    myObjects[0] = new item1(this);
    myObjects[1] = new item2(this);

    for(int i=2; i != maxSize+1; i++){
          myObjects[i] = new item3(this);
        }

    myObjects[maxSize+1] = NULL; 
```

如果`maxSize`大于 30，我会收到一大堆我从未见过的错误。Visual Studio 在 xutility 突出显示中出现错误：

```
const _Container_base12 *_Getcont() const
    {   // get owning container
    return (_Myproxy == 0 ? 0 : _Myproxy->_Mycont);
    } 
```

我以前从未使用过 Malloc，但这就是问题所在。我应该分配使用它来避免这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T13:26:31.083

The absolute value of `maxSize` is probably *not* a culprit: allocating 30 pointers should go without trouble on any computer, including most micro-controllers. Using `malloc` is not going to change anything: you are doing your allocation the way you're supposed to do it in C++.

Here is the likely source of your error:

```
myObjects[maxSize+1] = NULL; 
```

You have allocated storage for `maxSize+1` items, so the valid indexes are between `0` and `maxSize`. Writing one past the last element is *undefined behavior*, meaning that a crash could happen. You got lucky with 20 elements, but 30 smoked out this bug for you. Using [`valgrind`](http://valgrind.org/) utility is a good way to catch memory errors that *could* cause crashes, even if they currently don't cause them.

```
int maxSize = 20;
myObjects = new Object*[maxSize+1];

myObjects[0] = new item1(this);
myObjects[1] = new item2(this);

// if maxsize is 1, this loop could be trouble
for(int i=2; i != maxSize; i++){
    myObjects[i] = new item3(this);
}

myObjects[maxSize] = NULL; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:28:34.080

You're going past the bounds with:

```
myObjects[maxSize+1] = NULL; 
```

In your example, you created an array with 21 items. That will run from 0..20 but you're trying to write to the 21st element here.

The problem is not with `new` / `delete` as far as I can see, and I can't see any reason for switching to `malloc` here.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:27:15.997

You should not use `malloc()` in C++; you should use `new`.

There's one possible exception to this: if you have to allocate a block of memory which you intend to pass as an argument to a function which is going to eventually free it using `free()`. If you used `new` to allocate such a block the `free()` would likely cause heap corruption. But this is purely hypothetical -- I've never seen such an API!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T13:32:33.893

我认为您无法访问偏移量“maxSize+1”。解决方案如下：

```
myObjects = new Object*[maxSize+2];
...
myObjects[maxSize+1] = NULL; 
```

# node.js - npm 从本地位置而不是从网络安装软件包？

> ID：10298775
> 
> 赞同：14
> 
> 时间：2012-04-24T13:23:53.273
> 
> 标签：node.js, npm

这个问题把我逼疯了，npm 数据库中有一个包，但是它有一些错误，这些错误已经在 github 中修复，我该如何使用固定版本（github 版本）？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-24T13:53:40.887

**编辑：**

您可以直接从 GitHub 存储库安装，即使只使用 GitHub 用户名和存储库名称：

`npm install LearnBoost/socket.io`

您还可以添加一个[`<commit-ish>`](https://www.kernel.org/pub/software/scm/git/docs/#_identifier_terminology)，指定例如提交哈希或版本标签，如下所示：

`npm install LearnBoost/socket.io#1.7.x`

如果没有协议，这将被解释为`git://github.com/LearnBoost/socket.io`. 您还可以分别在 repo 前面加上`gitlab:`、`gist:`或`bitbucket:`。有关更多信息，请参阅[使用 git URL 作为依赖项](https://docs.npmjs.com/files/package.json#git-urls-as-dependencies)。

您可以直接从 URL 安装，例如：

```
npm install https://github.com/LearnBoost/socket.io/tarball/master 
```

您可以在 Github 上任何项目页面的“下载”下找到该 URL。选择“下载为 tar.gz”链接。

或者你可以安装一个 tarball：

```
npm install foo.tar.gz 
```

请参阅[npm install(1)](http://npmjs.org/doc/install.html)。

**编辑：**

`package.json`我应该提到这在文件中同样有效。在依赖项中指定 URL 而不是版本，如下所示：

```
...
"dependencies": {
  "foo": "http://example.com/foo.tar.gz",
  "bar": "1.2.x",
  ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:54:15.997

其他临时解决方案，获取github项目并使用`npm link`（[http://npmjs.org/doc/link.html](http://npmjs.org/doc/link.html)）将通过git获取的本地文件夹链接到`node_modules`您自己项目中的文件夹。无论如何，最后，您将不得不等待项目维护人员进行`npm publish`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:49:16.237

要么将模块作为 git 子模块（使用[git submodule](http://help.github.com/submodules/)）添加到您的项目中，要么告诉模块维护者更新版本并触发`npm publish`更新 npm 存储库。

使用子模块方式时，请注意不能使用`npm`-commands 更新引用。

# regex - 用于验证用户名的正则表达式

> ID：10298776
> 
> 赞同：1
> 
> 时间：2012-04-24T13:23:55.957
> 
> 标签：regex, cocoa-touch, validation

我正在寻找一个正则表达式来验证用户名。

用户名可能包含：

*   字母（西方、希腊、俄罗斯等）
*   数字
*   空格，但一次只有 1 个
*   特殊字符（例如：）`"!@#$%^&*.:;<>?/\|{}[]_+=-"`，但一次只有 1 个

编辑：

对困惑感到抱歉

*   我需要它用于可可触摸，但无论如何我都必须将它翻译为服务器端的 php。
*   一次 1 我的意思是空格或特殊字符应该用字母或数字分隔。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T14:52:12.457

与其编写一个大的正则表达式，不如编写单独的正则表达式来测试您想要的每个条件会更清楚。

*   测试用户名是否仅包含字母、数字、ASCII 符号`!`到`@`和空格：`^(\p{L}|\p{N}|[!-@]| )+$`。这必须匹配用户名才有效。注意`\p{L}`Unicode 字母`\p{N}`类和 Unicode 数字类的使用。

*   测试用户名是否包含连续空格：`\s\s+`. 如果匹配，则用户名无效。

*   测试符号是否连续出现：`[!-@][!-@]+`. 如果匹配，则用户名无效。

这完全符合您所写的标准。

但是，根据用户名的编写方式，这种方法可能仍会拒绝完全有效的名称，例如“Éponine”。这是因为“É”可以写成 U+00C9 LATIN CAPITAL E WITH ACUTE（由 匹配`\p{L}`）或`E`后跟 U+02CA MODIFIER LETTER ACUTE ACCENT（*不*匹配`\p{L}`。）

[Regular-Expressions.info 说得更好](http://www.regular-expressions.info/unicode.html#prop)：

> 同样，“字符”实际上意味着“Unicode 代码点”。\p{L} 匹配“字母”类别中的单个代码点。如果您的输入字符串 à 编码为 U+0061 U+0300，则它匹配没有重音符号的 a。如果输入是 à 编码为 U+00E0，它匹配 à 和重音。原因是代码点 U+0061 (a) 和 U+00E0 (à) 都属于“字母”类别，而 U+0300 属于“标记”类别。

Unicode 很麻烦，无论如何限制用户名中的字符也不一定是个好主意。你确定你要这么做吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:33:38.333

表达方式

```
^(\w| (?! )|["!@#$%^&*.:;<>?/\|{}\[\]_+=\-")](?!["!@#$%^&*.:;<>?/\|{}\[\]_+=\-")]))*$ 
```

如果您的方言支持前瞻断言，它将主要做您想做的事情。在[RegExr](http://regexr.com?30oh5)中查看它的实际应用。

请问问自己为什么要以这种方式限制用户名。大多数时候用户名以“!!”开头 应该不是问题，如果您拒绝用户想要的用户名，您会惹恼用户。

**编辑：** `\w`不匹配非拉丁字符。为此，根据您的正则表达式实现，替换`\w`为wich 可能有效，也可能无效。`\p{L}`不幸的是，Regexr 不支持它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:35:14.000

试试这个：

```
^[!@#$%^&*.:;<>?\/\|{}\[\]_+= -]?([\p{L}\d]+[!@#$%^&*.:;<>?/\|{}\[\]_+= -]?)+$ 
```

见[红字](http://rubular.com/r/PmRKf5FJVZ)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T13:38:27.533

你想要类似的东西

```
string strUserName = "BillYBob Stev#nS0&";
Regex regex = new Regex(@"(?i)\b(\w+\p{P}*\p{S}*\p{Z}*\p{C}*\s?)+\b");
Match match = regex.Match(strUserName); 
```

如果你想要这个解释，请告诉我。

我希望这有帮助。

注意：这是不区分大小写的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T13:47:28.440

由于我不知道您需要哪种语言的解决方案，因此我使用 Java 提供答案。它可以在任何其他平台上翻译：

```
String str = "à123 àà@bcà#";
String regex = "^([\\p{L}\\d]+[!@#$%\\^&\\*.:;<>\\?/\\|{}\\[\\]_\\+=\\s-]?)+$";
Pattern p = Pattern.compile(regex);
matcher = p.matcher(str);
if (matcher.find())
   System.out.println("Matched: " + matcher.group()); 
```

我做出的一个假设是用户名将以 unicode 字母或数字开头。

# nhibernate - NHibernate 映射异常：无效的子元素

> ID：10298779
> 
> 赞同：0
> 
> 时间：2012-04-24T13:24:03.817
> 
> 标签：nhibernate, nhibernate-mapping

当我尝试将我的饮料对象保存在我的 MVC 应用程序中时，我遇到了 NHibernate 和映射文件的问题。我的映射文件是嵌入式资源，我的 hibernate.cfg.xml 始终是副本。

这是我的class.cs：

```
namespace FrancosPoS.DBMapping {

    public class drink {
        public drink() { }
        public virtual int id { get; set; }
        public virtual string type { get; set; }
        public virtual string price { get; set; }
    }
} 
```

我的 XML 映射：

```
<?xml version="1.0" encoding="utf-8"?>
<hibernate-mapping assembly="FrancosPoS.DBMapping" namespace="FrancosPoS.DBMapping" xmlns="urn:nhibernate-mapping-2.2">
    <class name="drink" table="drink" lazy="true" >
        <id name="id">
            <generator class="identity" />
            <column name="id" sql-type="int(11)" not-null="true" />
        </id>
        <property name="type">
            <column name="type" sql-type="varchar(25)" not-null="true" />
        </property>
        <property name="price">
            <column name="price" sql-type="varchar(8)" not-null="true" />
        </property>
    </class>
</hibernate-mapping> 
```

顺便说一句，如果我不尝试将其保存在数据库中，则连接可以正常打开和关闭。

这是我的解决方案资源管理器：

[解决方案资源管理器图像](http://db.tt/BD4D4fyA)

这是让我发疯的错误：

```
"Error: NHibernate.MappingException: FrancosPoS.DBMapping.drink.hbm.xml(6,8): XML validation error: The element 'id' in namespace 'urn:nhibernate-mapping-2.2' has invalid child element 'column' in namespace 'urn:nhibernate-mapping-2.2'. ---> System.Xml.Schema.XmlSchemaValidationException: The element 'id' in namespace 'urn:nhibernate-mapping-2.2' has invalid child element 'column' in namespace 'urn:nhibernate-mapping-2.2'.\r\n   --- End of inner exception stack trace --- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:29:05.263

问题出在节点 id 中，它没有子节点，删除该节点，它会是这样的：

```
<id name="id">
        <generator class="identity" />
</id> 
```

列的名称在 id 节点中指定，并且您不必告诉列具有“非空”约束，因为始终需要 id 列

此外，在您的 xml 映射的这一行中：

```
<hibernate-mapping assembly="FrancosPoS.DBMapping" namespace="FrancosPoS.DBMapping" xmlns="urn:nhibernate-mapping-2.2"> 
```

“程序集”属性似乎是错误的，它应该是您的程序集的名称（我几乎可以肯定是“FrancosPos”）。

# c# - WPF 窗口立即最小化

> ID：10298784
> 
> 赞同：1
> 
> 时间：2012-04-24T13:24:07.890
> 
> 标签：c#, wpf, c++-cli

**解决方案** [在这里](https://stackoverflow.com/q/10299856/1256811)

我被要求使用 WPF 窗口模拟 Windows 窗体上下文菜单。当用户单击某个区域时，我创建了一个窗口，但该窗口立即最小化到任务栏。我需要它至少在它失去焦点或被停用之前保持在其他窗口的顶部。它的窗口样式是无，它在任务栏属性中的显示是真还是假都没有关系。SO上存在类似的问题，但在我的情况下它们似乎没有解决任何问题。为什么会有这种奇怪的行为？有解决办法吗？

```
<Window x:Class="InterceptRouteWindow"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" mc:Ignorable="d" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"  Width="200" ResizeMode="NoResize" SizeToContent="Height" ShowInTaskbar="False" Loaded="Window_Loaded" WindowStyle="None" Height="auto" Deactivated="Window_Deactivated">

        <StackPanel Height="auto" Name="stackPanel1" Width="200" Background="WhiteSmoke">
             <Separator Height="5"  FlowDirection="LeftToRight">
               <Separator.Background>
                 <SolidColorBrush />
               </Separator.Background>
            </Separator>
      </StackPanel>
</Window> 
```

所以这是一个简单的窗口。我调用它的方式：

```
 IRWindow = gcnew InterceptRouteWindow(routes, fpId, offsetPoint.x, offsetPoint.y);
 GetMainFrame()->IRWindow->Show(); 
```

这是由旧应用程序中的单击事件触发的，MFC 和 WindowsForms 的混合......不是我的代码，我必须遵守他们的设计并尽可能使用 WPF。

# php - PHP 多维数组按键重复数据删除

> ID：10298787
> 
> 赞同：2
> 
> 时间：2012-04-24T13:24:18.507
> 
> 标签：php, arrays, multidimensional-array, sorting, dynamic-arrays

我做了很多搜索，但找不到一个好的解决方案。

我有一个动态生成的数组，例如：

```
Array (
    [0] => Array ( [0] => a )
    [1] => Array ( [a] => Array ( [0] => aa ) )
    [2] => Array ( [a] => Array ( [aa] => Array ( [0] => aaa ) ) )
    [3] => Array ( [a] => Array ( [aa] => Array ( [0] => aab ) ) )
    [4] => Array ( [a] => Array ( [ab] => Array ( [0] => aba ) ) )
    [5] => Array ( [0] => b )
    [6] => Array ( [b] => Array ( [0] => bb ) ) ) 
```

我想要做的是删除每个级别的所有重复值（数组可能在维度上更大或更小）以创建类似于此的输出：

```
Array (
    [0] => Array ( [a] => Array ( [aa] => Array ( [0] => aaa
                                                  [1] => aab ) 
                                  [ab] => Array ( [0] => aba )
                                )
                 )
    [1] => Array ( [b] => Array ( [0] => bb )
                 )
      ) 
```

我已经尝试创建几个递归函数（下面的示例）来处理它，但仍然无法弄清楚如何获得所需的效果，并且由于失败而将它们全部删除。

```
function deduplicateArray(&$varTemp) }
  if (is_array($varTemp)) {
    foreach($varTemp as $key => &$value) {
  if (is_array($value)) {
        // do stuff.
        deduplicateArray($value);
      } else {
        // do stuff.
      }
    }
  } else {
    // do stuff.
  }
} 
```

即使只是在正确方向上的一点也会有所帮助，谢谢。

编辑：

该数组由此代码生成，该代码使用 %2F 作为分隔符从适当命名的文件中创建。

```
function generateStructure(&$arrStructure, $strContent, $strBaseURL, $strPageURL) {     // Generate Content Structure Code.
  if ($arrStructure === array(NULL)) {
    $arrStructure = array('');                           // Define Final Array.
    if ($dirTemp = opendir($strContent)) {
      while (false !== ($strFile = readdir($dirTemp))) {
        if ($strFile != '.' && $strFile != '..') {
          if (is_file($strContent.$strFile) && substr_count($strFile, '.php') > 0) {  // Make sure is file and is php.
            if (isset($arrFiles)) {
              array_push($arrFiles, strtok($strFile, '.php'));
            } else {
              $arrFiles = array(strtok($strFile, '.php'));
            }
          }
        }
      }
      closedir($dirTemp);
    } else {
      errorCode(403);
    }
    sort($arrFiles); // Put in Alphabetical Order
    $intTemp = 0;
    for ($i = 0; $i < count($arrFiles); $i++) {
      $arrTempSplit = explode('%2F',$arrFiles[$i]);        // Create an Array of Strings from FileName String by Delimiter.

      $ii = count($arrTempSplit) - 1;                      // Create integer that is equal to the potential Multi-Dimensional Array's Columns.
      //if ($ii > $intTemp) {
      //  $intTemp = $ii;                                    // Get highest elementt for The Final Array.
      //}

      $arrTemp=array($arrTempSplit[$ii]);                  // Turn current Element into Array.
      $ii--;

      for($ii; $ii >= 0 ; $ii--) {                         // Loop through the Multi-Dimentional Array from Right to Left.
        $arrTemp2 = array($arrTempSplit[$ii] => $arrTemp);
        unset($arrTemp);
        $arrTemp = &$arrTemp2;
      }

      // Deduplicate Multi-Dimensional Array.
      //if ($i > 0 && is_array($arrStructure[$i])) {
      //  $arrStructure[$i] = array_merge_recursive($arrTemp, $arrStructure[$i-1]);
      //} else {
        $arrStructure[$i] = $arrTemp;
      //}
    }
    //$arrStructure = array_unique($arrStructure);
    deduplicateArray($arrStructure);
    print_r($arrStructure);
  }
} 
```

最顶层的数组不作为 [0][1][2] 等存在并直接成为下一个级别是可以的。

也可以在生成表的文件名中出现这种情况

a%2Faa aa%2Fa bb%2Fb b%2Faa%2Fa

我只是让它们按照刚才的顺序排序，以便更容易调试。

@erwin-haasnoot

预期的行为是

```
Array (    
        [0] => Array ( [a] => Array ( [aa] => Array ( [0] => aab ) 
                                      [ab] => Array ( [0] => aba ) 
                                    )
                       [b] => Array ( [0] => abb )
                     )
        [1] => Array ( [b] => Array ( [0] => bba ) ) 
      ) 
```

认为它的方式是最左边的值是从左到右字符串是父子。

可能没有与另一个同名的父母，并且该一代的父母可能没有任何共享名字的孩子。

然而，孩子可能与他们的父母和属于其他父母的其他孩子同名。

不是所有的父母都可能有孩子。

并非所有的孩子都可能成为下一代的父母。

Parent 和 Child 的世代数没有限制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T14:16:59.143

由于我还不允许回复，所以我必须在答案中回复。

我认为您的问题没有得到很好的定义，例如，在这种情况下预期的行为是什么？（查看值为 'a' 而不是键的数组）：

```
Array (    
[0] => Array ( [a] => Array ( [0] => aa ) )
[1] => Array ( [a] => Array ( [aa] => Array ( [0] => aaa ) ) )
[2] => Array ( [a] => Array ( [aa] => Array ( [0] => aab ) ) )
[3] => Array ( [a] => Array ( [ab] => Array ( [0] => aba ) ) )
[4] => Array ( [0] => a )
[5] => Array ( [0] => b )
[6] => Array ( [b] => Array ( [0] => bb ) ) ) 
```

数字“键”（哪些索引基本上是或可以是）被扔掉了吗？还是会覆盖 key = 'a' 的数组

像这样的数组的预期行为是什么：

```
Array (    
[0] => Array ( [a] => Array ( [aa] => Array ( [0] => aab ) ) )
[1] => Array ( [a] => Array ( [ab] => Array ( [0] => aba ) ) )
               [b] => Array ( [0] => abb )
[2] => Array ( [b] => Array ( [0] => bba ) ) 
) 
```

而且我敢肯定，我能想到您自己的示例未涵盖的许多其他示例。如果你能想通这些，我想你会离你的实际解决方案更近一步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T14:43:25.333

这个功能会有所帮助，我仍在研究究竟如何。

**编辑：来源：[http ://sebastiano.ezion.cc/2008/03/13/php-foreach-function-for-multi-level-arrays/#](http://sebastiano.ezion.cc/2008/03/13/php-foreach-function-for-multi-level-arrays/#)**

```
$buff = "";  
function foreach_loop($array) {  
global $buff;  

    foreach ($array as $key => $value ) {  
        if (!is_array($value)) { // if it isn't an array show $key and $value  
                $buff .= '   ' . $key; 
                $buff .= '  ->  ' . $value . '<br> '; 
        }else {  // if it is an array -> show $key -> then process $value again will same function. 
                $buff .= '<strong>' . $key.'</strong> ';  
                foreach_loop($value);  
        }  
    }  
}  

foreach_loop($oldarray);
echo $buff; 
```

# c# - 如何获取当前系统光标并将其保存到文件 xxx.cur？

> ID：10298791
> 
> 赞同：0
> 
> 时间：2012-04-24T13:24:30.603
> 
> 标签：c#, wpf, cursor

我知道如何从 xxx.cur 文件设置系统光标，但我想知道如何将当前系统光标保存到文件中。

在 WPF 中，设置系统光标可以使用以下代码：

```
[DllImport("user32.dll")]
internal static extern IntPtr LoadCursorFromFile(string lpFileName);
[DllImport("user32.dll")]
internal static extern bool SetSystemCursor(IntPtr hcur, uint id);
internal const uint OCR_NORMAL = 32512;
IntPtr hAni = Win32Api.LoadCursorFromFile("file.cur");
bool b = SetSystemCursor(hAni, Win32Api.OCR_NORMAL); 
```

但我不知道如何将当前系统光标保存到磁盘。

谁能告诉我，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T00:44:26.093

这可能有点难看，而且我发布的代码没有很好地分解（描述解决方案很粗糙），但是您可以从注册表中拉出当前游标，然后再次将它们保存回来。

```
public class UserCursors
{
    [Serializable]
    internal enum ImageType
    {
        Bitmap = 0,
        Icon = 1,
        Cursor = 2,
        EnhMetafile = 3,
    }

    [Serializable, Flags]
    internal enum LoadImageFlags
    {
        DefaultColor = 0x0,
        Monochrome = 0x1,
        Color = 0x2,
        CopyReturnOriginal = 0x4,
        CopyDeleteOriginal = 0x8,
        LoadFromFile = 0x10,
        LoadTransparent = 0x20,
        DefaultSize = 0x40,
        VgaColor = 0x80,
        LoadMap3DColors = 0x1000,
        CreateDibSection = 0x2000,
        CopyFromResource = 0x4000,
        Shared = 0x8000,
    }

    [DllImport("user32.dll")]
    static extern IntPtr LoadImage(IntPtr hinst, String lpszName, ImageType uType, Int32 cxDesired, Int32 cyDesired, LoadImageFlags fuLoad);

    public IntPtr hInst = IntPtr.Zero;
    public String lpszName;
    public Int32 width = 0;
    public Int32 height = 0;
    public string regKeyName = String.Empty;
    public bool Changed = false;

    public UserCursors()
    {

    }

    public UserCursors(string cursorLocation, string keyName)
    {
        hInst = LoadImage(IntPtr.Zero, cursorLocation, ImageType.Cursor, width, height, LoadImageFlags.LoadFromFile);
        lpszName = cursorLocation;
        regKeyName = keyName;
    }
} 
```

然后创建一个列表例如

```
public List<UserCursors> systemCursors; 
```

加载列表

```
[DllImport("user32.dll", SetLastError = true)]
static extern bool SetSystemCursor(IntPtr hcur, uint id);
const uint OCR_NORMAL = 32512;
const uint OCR_HAND = 32649;
const uint OCR_IBEAM = 32513;

        IntPtr hArrow = LoadImage(IntPtr.Zero, "<my custom cursor file>", ImageType.Cursor, width, height, LoadImageFlags.LoadFromFile);
        IntPtr hHand = LoadImage(IntPtr.Zero, "<my custom cursor file>", ImageType.Cursor, width, height, LoadImageFlags.LoadFromFile);
        IntPtr hBeam = LoadImage(IntPtr.Zero, "<my custom cursor file>", ImageType.Cursor, width, height, LoadImageFlags.LoadFromFile);

        RegistryKey myCursors = Registry.CurrentUser.OpenSubKey(defaultCursors);
        string[] keyCursors = myCursors.GetValueNames();
        bool beamFound = false;
        int lastError = 0;

        foreach (string cursorKey in keyCursors)
        {
            RegistryValueKind rvk = myCursors.GetValueKind(cursorKey);
            switch (rvk)
            {
                case RegistryValueKind.ExpandString:
                    string cursorValue = myCursors.GetValue(cursorKey) as string;
                    if (!String.IsNullOrEmpty(cursorValue))
                    {
                        UserCursors currentSystemCursor = new UserCursors(cursorValue, cursorKey);
                        switch (cursorKey)
                        {
                            case "Arrow":
                                currentSystemCursor.Changed = SetSystemCursor(hArrow, OCR_NORMAL);
                                break;
                            case "Hand":
                                currentSystemCursor.Changed = SetSystemCursor(hHand, OCR_HAND);
                                if (!currentSystemCursor.Changed)
                                {
                                    lastError = Marshal.GetLastWin32Error();
                                    Win32Exception ex = new Win32Exception(lastError);
                                }
                                break;
                            case "IBeam":
                                beamFound = true;
                                currentSystemCursor.Changed = SetSystemCursor(hBeam, OCR_IBEAM);
                                break;
                            default:
                                break;
                        }
                        systemCursors.Add(currentSystemCursor);
                    }
                    break;
                default:
                    break;
            }
        }

        // if a user hasn't customised the IBeam then it doesn't appear in the registry so we still change it
        // and then clear the value to remove it.
        if (!beamFound)
        {
            UserCursors currentSystemCursor = new UserCursors("C:\\Windows\\Cursors\\beam_i.cur", "IBeam");
            currentSystemCursor.Changed = SetSystemCursor(hBeam, OCR_IBEAM);
            systemCursors.Add(currentSystemCursor);
        } 
```

然后在析构函数或 finalize 或类似的

```
 ~MainWindow()
    {
        int lastError = 0;
        bool changed = false;

        foreach (UserCursors savedCursor in systemCursors)
        {
            if (savedCursor.Changed)
            {
                switch (savedCursor.regKeyName)
                {
                    case "Arrow":
                        changed = SetSystemCursor(savedCursor.hInst, OCR_NORMAL);
                        if (!changed)
                        {
                            lastError = Marshal.GetLastWin32Error();
                            Win32Exception ex = new Win32Exception(lastError);
                        }
                        break;
                    case "Hand":
                        changed = SetSystemCursor(savedCursor.hInst, OCR_HAND);
                        if (!changed)
                        {
                            lastError = Marshal.GetLastWin32Error();
                            Win32Exception ex = new Win32Exception(lastError);
                        }
                        break;
                    case "IBeam":
                        changed = SetSystemCursor(savedCursor.hInst, OCR_IBEAM);
                        if (!changed)
                        {
                            lastError = Marshal.GetLastWin32Error();
                            Win32Exception ex = new Win32Exception(lastError);
                        }
                        break;
                    default:
                        break;
                }
            }
        }
    } 
```

# java - ResultSet.getString(1) throws java.sql.SQLException: Invalid operation at current cursor position

> ID：10298794
> 
> 赞同：11
> 
> 时间：2012-04-24T13:24:44.993
> 
> 标签：java, jdbc, resultset, sqlexception

当我运行以下 servlet 时：

```
// package projectcodes;
public void doPost(HttpServletRequest request,HttpServletResponse response) throws ServletException,IOException {
    String UserID = request.getParameter("UserID");
    String UserPassword = request.getParameter("UserPassword");
    String userName = null;
    String Email = null;
    Encrypter encrypter = new Encrypter();
    String hashedPassword = null;
    try {
        hashedPassword = encrypter.hashPassword(UserPassword);
        Context context = new InitialContext();
        DataSource ds = (DataSource)context.lookup("java:comp/env/jdbc/photog");
        Connection connection = ds.getConnection();
        String sqlStatement = "SELECT email,firstname FROM registrationinformation WHERE password='" + hashedPassword + "'";
        PreparedStatement statement = connection.prepareStatement(sqlStatement);
        ResultSet set = statement.executeQuery();
        userName = set.getString(1);  // <<---------- Line number 28
        response.sendRedirect("portfolio_one.jsp");
        // userName = set.getString("FirstName");
        Email = set.getString(3);
        if(set.wasNull() || Email.compareTo(UserID) != 0) {
            // turn to the error page
            response.sendRedirect("LoginFailure.jsp");
        } else {
            // start the session and take to his homepage
            HttpSession session = request.getSession();
            session.setAttribute("UserName", userName);
            session.setMaxInactiveInterval(900); // If the request doesn't come withing 900 seconds the server will invalidate the session
            RequestDispatcher rd = request.getRequestDispatcher("portfolio_one.jsp");
            rd.forward(request, response); // forward to the user home-page
        }
    }catch(Exception exc) {
        System.out.println(exc);
    } 
```

我得到以下异常：

```
INFO: java.sql.SQLException: Invalid operation at current cursor position.
at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)
at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)
at org.apache.derby.client.am.ResultSet.getString(Unknown Source)
at com.sun.gjc.spi.base.ResultSetWrapper.getString(ResultSetWrapper.java:155)

-----> at projectcodes.ValidateDataForSignIn.doPost(ValidateDataForSignIn.java:28

at javax.servlet.http.HttpServlet.service(HttpServlet.java:754)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1539)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:98)
at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:330)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:174)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:828)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:725)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1019)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
at java.lang.Thread.run(Thread.java:722)
    Caused by: org.apache.derby.client.am.SqlException: Invalid operation at current cursor position.
at org.apache.derby.client.am.ResultSet.checkForValidCursorPosition(Unknown Source)
at org.apache.derby.client.am.ResultSet.checkGetterPreconditions(Unknown Source)
... 30 more 
```

上面来自服务器的日志显示第 28 行是异常的原因。但我无法得到异常的原因。表中的所有列都具有 varchar 数据类型。

我在 servlet 代码中突出显示了第 28 行*（根据服务器日志导致异常的原因） 。*

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-04-24T13:27:57.780

您应该`next`首先使用该语句。

```
ResultSet set = statement.executeQuery();
if (set.next()) {
    userName = set.getString(1);
    //your logic...
} 
```

更新

正如 Java 6 文档所说

> ResultSet 游标最初位于第一行之前；第一次调用 next 方法使第一行成为当前行；第二次调用使第二行成为当前行，依此类推。

这意味着当你执行句子时

```
ResultSet set = statement.executeQuery(); 
```

ResultSet`set`将被创建并指向数据的第一个结果之前的一行。你可以这样看：

从注册信息中选择电子邮件、名字

```
 email              | firstname
    ____________________________________
0                                        <= set points to here
1   email1@gmail.com   | Email1 Person
2   foo@bar.com        | Foo Bar 
```

因此，在打开您的 ResulSet 之后，您执行该方法`next`将其移动到第一行。

```
if(set.next()) 
```

现在`set`看起来像这样。

```
 email              | firstname
    ____________________________________
0
1   email1@gmail.com   | Email1 Person   <= set points to here
2   foo@bar.com        | Foo Bar 
```

如果你需要读取 ResultSet 中的所有数据，你应该使用 while 而不是 if：

```
while(set.next()) {
    //read data from the actual row
    //automatically will try to forward 1 row
} 
```

如果`set.next()`返回 false，则意味着没有要读取的行，因此您的 while 循环将结束。

更多信息[在这里](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html#next%28%29)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:28:52.283

您必须将指针设置到正确的位置：

```
while(set.hasNext()){
    set.next();
    String a = set.getString(1);
    String b = set.getString(2);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:29:12.507

结果集集 = statement.executeQuery();

迭代集合，然后获取字符串。

```
 while(set.next()) {
me = set.getString(1);  // <<---------- Line number 28

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-22T11:20:49.190

初始化 ResultSet 后检查游标中是否有行，例如

`if(rs.next()){ //your all other works should go here }`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-18T05:58:34.263

您可以通过以下方式获得第一个：`rs.first()`

# java - 字节数组 -> 字符串 -> 加密文本的字节数组：大小不同

> ID：10298795
> 
> 赞同：2
> 
> 时间：2012-04-24T13:24:45.183
> 
> 标签：java, bytearray

我正在尝试加密一条消息，该消息有效并将其作为字节数组返回。然后我将此字节数组转换为字符串，以便通过 tcp 网络消息发送。另一方面，我将字符串转换回字节数组，但是结果数组更大，我不知道为什么。我认为这可能与编码有关，就好像我使用“MacRoman”一样，我没有这个问题，但是程序需要能够在不支持这种编码的系统上运行，所以我决定使用 UTF -8。

```
 String message="222233332221";

        //Encrypt message
        byte[] encryptedMsg = encryptString(message, temp.loadCASPublicKey());
        System.out.println("ENCRYPTED MESSAGE byte Length: "+encryptedMsg.length);

        //Convert to String in order to send
        String stringMessage = new String(encryptedMsg);
        System.out.println("ENCRYPTED MESSAGE String Length: "+stringMessage.length());

        //Convert String back to Byte[] and decrpt
        byte[] byteMessage = stringMessage.getBytes("UTF-8");
        System.out.println("ENCRYPTED MESSAGE byte Length: "+byteMessage.length); 
```

输出：

> 加密消息字节长度：256
> 
> 加密消息字符串长度：235
> 
> 加密消息字节长度：446

谁能指出我正确的方向，为什么结果字节数组是 446 字节而不是 256 字节。

encryptString 部分如下。我相信这会在 UTF-8 中返回一个字节数组？

```
private static byte[] encryptString(String message, Key publicKey) throws NoSuchAlgorithmException, NoSuchPaddingException, InvalidKeyException, IllegalBlockSizeException, BadPaddingException, UnsupportedEncodingException {
    Cipher cipher = Cipher.getInstance("RSA");
    cipher.init(Cipher.ENCRYPT_MODE, publicKey);

    byte[] cipherData = cipher.doFinal(message.getBytes("UTF-8"));     
    return cipherData;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T14:19:16.857

设法使用 Base64 修复它。

```
 byte[] encryptedMsg = Base64.encodeBase64(encryptString(message, temp.loadCASPublicKey()));

        System.out.println("ENCRYPTED MESSAGE byte Length: "+encryptedMsg.length);

        //Convert to String in order to send
        String stringMessage = new String(encryptedMsg, "UTF-8");
        System.out.println("ENCRYPTED MESSAGE String Length: "+stringMessage.length());

        //Convert String back to Byte[] and decrpt
        byte[] byteMessage = Base64.decodeBase64(stringMessage.getBytes("UTF-8"));
        System.out.println("ENCRYPTED MESSAGE byte Length: "+byteMessage.length); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:28:30.340

It's an encoding issue.

1) You have a byte array. It contains bytes
2) You convert it to a string. **As soon as you do this, you have a UTF16 encoded String**. So you have taken the bytes and changed them to characters.
3) You now convert those characters back to bytes. But if the original bytes were not UTF8 or UTF16, you might not have the same number of bytes. If the default encoding of the platform is MacRoman, then in step 3 you are translating your UTF16 String into bytes, but treating the characters as MacRoman.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T14:08:18.990

我想手动进行加密是有充分理由的，但是以防万一……您考虑改用 SSLSocket 吗？

# sql-server - 模仿 group_concat() 结合 GROUP BY

> ID：10298805
> 
> 赞同：2
> 
> 时间：2012-04-24T13:25:11.253
> 
> 标签：sql-server, sql-server-2008, tsql, group-by

我有一张这样的“预订”表：

```
booking_id,
date,
client,
sponsor 
```

我正在尝试获取每月摘要：

```
SELECT 
  MONTH(date) AS M,
  Sponsor,
  Client,
  COUNT(booking_id) AS c
FROM booking
GROUP BY
 M, Sponsor, Client 
```

现在我想看看客户在哪个日期进行了预订。我尝试使用 STUFF() （在这篇文章中引用：[在 Microsoft SQL Server 2005 中模拟 group_concat MySQL 函数？](https://stackoverflow.com/questions/451415/simulating-group-concat-mysql-function-in-ms-sql-server-2005)），但它与 group-by 语句冲突。

根据要求采样数据。目前我有以下内容：

```
M       Sponsor     Client  c     
March   AB          y       3
March   FE          x       4
April   AB          x       2 
```

期望的输出：

```
M       Sponsor     Client  c   dates
March   AB          y       3   12, 15, 18
March   FE          x       4   16, 19, 20, 21
April   AB          x       2   4, 8 
```

其中数字是天数（例如 3 月 12 日、3 月 15 日、3 月 18 日）。在 mysql 中，我会使用 group_concat(date) 来获取最后一列。

非常感谢答案:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T14:15:24.090

```
SELECT [Month] = DATENAME(MONTH, M), Sponsor, Client, c,
  [dates] = STUFF((SELECT N', ' + RTRIM(DATEPART(DAY, [date])) 
    FROM dbo.booking AS b
    WHERE b.Sponsor = x.Sponsor
      AND b.Client = x.Client
      AND b.[date] >= x.M AND b.[date] < DATEADD(MONTH, 1, x.M) 
    ORDER BY [date]
    FOR XML PATH(''),
    TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 2, N'')
FROM 
(
  SELECT 
      M = DATEADD(MONTH, DATEDIFF(MONTH, '19000101', [date]), '19000101'),
      Sponsor,
      Client,
      COUNT(booking_id) AS c
    FROM dbo.booking
    GROUP BY DATEADD(MONTH, DATEDIFF(MONTH, '19000101', [date]), '19000101'),
      Sponsor,
      Client
) AS x
ORDER BY M, Sponsor, Client; 
```

请注意，如果赞助商/客户组合在同一天有两个预订，则日期编号将出现在列表中两次。

**编辑**这是我的测试方式：

```
DECLARE @booking TABLE
( 
  booking_id INT IDENTITY(1,1) PRIMARY KEY,
  [date] DATE,
  Sponsor VARCHAR(32),
  Client VARCHAR(32)
);

INSERT @booking([date], Sponsor, Client) VALUES
('20120312','AB','y'), ('20120315','AB','y'), ('20120318','AB','y'),
('20120316','FE','x'), ('20120319','FE','x'), ('20120321','FE','x'), 
('20120320','FE','x'), ('20120404','AB','x'), ('20120408','AB','x');

SELECT [Month] = DATENAME(MONTH, M), Sponsor, Client, c,
  [dates] = STUFF((SELECT ', ' + RTRIM(DATEPART(DAY, [date])) 
    FROM @booking AS b
    WHERE b.Sponsor = x.Sponsor
      AND b.Client = x.Client
      AND b.[date] >= x.M AND b.[date] < DATEADD(MONTH, 1, x.M) 
    ORDER BY [date]
    FOR XML PATH(''),
    TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 2, N'')
FROM 
(
  SELECT 
      M = DATEADD(MONTH, DATEDIFF(MONTH, '19000101', [date]), '19000101'),
      Sponsor,
      Client,
      COUNT(booking_id) AS c
    FROM @booking
    GROUP BY DATEADD(MONTH, DATEDIFF(MONTH, '19000101', [date]), '19000101'), 
      Sponsor, 
      Client
) AS x
ORDER BY M, Sponsor, Client; 
```

结果：

```
Month   Sponsor Client  c       dates
------- ------- ------- ------- --------------
March   AB      y       3       12, 15, 18
March   FE      x       4       16, 19, 20, 21
April   AB      x       2       4, 8 
```

# jpa-2.0 - 实体管理器没有方法 getCriteriaBuilder()

> ID：10298806
> 
> 赞同：7
> 
> 时间：2012-04-24T13:25:11.570
> 
> 标签：jpa-2.0, entitymanager

我在使用 Oracle9i 数据库的应用程序中引入 JPA2.0，我添加了库 EclipseLink(JPA2.0) 并创建了实体类，但是当我使用

```
javax.persistence.criteria.CriteriaQuery cq = em.getCriteriaBuilder().createQuery(); 
```

我收到以下错误

找不到符号符号：方法 getCriteriaBuilder() 位置：接口 javax.persistence.EntityManager

我的 web.xml 是 2.4 版，这是我的 persistence.xml

```
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
   <persistence-unit name="MiraclinPU" transaction-type="JTA">
    <jta-data-source>jdbc/Miraclin</jta-data-source>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <properties/>
   </persistence-unit>
</persistence> 
```

看起来该应用程序正在使用 JPA1.0，正如我在论坛上看到的那样......有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-15T20:33:58.663

采用：

```
 <dependency>
        <groupId>org.hibernate.javax.persistence</groupId>
        <artifactId>hibernate-jpa-2.0-api</artifactId>
        <version>1.0.1.Final</version>
    </dependency> 
```

并不是：

```
 <dependency>
        <groupId>javax.persistence</groupId>
        <artifactId>persistence-api</artifactId>
        <version>1.0.2</version>
    </dependency> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-26T10:37:36.750

在项目中包含的所有库中搜索，并删除包含 persistence.xml 的库，您需要的除外。然后再次重新包含它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-14T16:11:47.873

在日食中：

*   项目 -> 属性 -> Java 构建路径 -> 配置构建路径 -> 库
*   删除对 j​​avax/persistente 的引用
*   插入对 hibernate-jpa-2.0-api-/*版本*/.jar的引用

如何验证：

在你的 sourceDAO.java`F3`中按下 EntityManagerFactory 并查看 .jar eclipse 打开的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-02T10:47:16.657

失踪

```
import javax.persistence.criteria.*; 
```

可能吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-07T07:56:49.037

[由于](https://mvnrepository.com/artifact/org.hibernate/hibernate-core) `org.hibernate.orm`神器被移动到`hibernate-core`；

我从以下位置删除了这个`pom.xml`：

```
<!-- https://mvnrepository.com/artifact/org.hibernate/hibernate-core -->
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-core</artifactId>
    <version>5.4.9.Final</version>
</dependency> 
```

并添加了这个：

```
<!-- https://mvnrepository.com/artifact/org.hibernate/hibernate-core -->
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-core</artifactId>
    <version>5.4.9.Final</version>
</dependency> 
```

这样就解决了`cannot find symbol getCriteriaBuilder()`问题。

# c++ - printf 如何显示 char* 中的字符串？

> ID：10298819
> 
> 赞同：3
> 
> 时间：2012-04-24T13:26:03.620
> 
> 标签：c++, pointers, char

考虑一个简单的例子

```
Eg: const char* letter = "hi how r u"; 
```

letter 是一个 const 字符指针，它指向字符串“hi how r u”。现在，当我想打印数据或访问数据时，我应该正确使用`*letter`吗？

但是在这种情况下，我不应该只需要在调用 printf 时使用地址吗？

```
printf("%s",letter); 
```

那么这是为什么呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T13:29:01.643

`*letter`实际上是一个字符；这是`letter`指向的第一个字符。如果您正在对整个字符串进行操作，那么*按照惯例*，函数将查看该字符以及下一个字符等，直到它们看到一个零 ('\0') 字节。

一般来说，如果你有一个指向一堆元素（即一个数组）的指针，那么指针指向第一个元素，并且不知何故，对这堆元素进行操作的任何代码都需要知道有多少元素。对于`char*`，有零约定；对于其他类型的数组，您通常必须将长度作为另一个参数传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T02:48:07.240

`printf`将指向数据数组的指针作为参数。因此，如果您要显示带有 、 、 等的字符串（一种数组）`%s`或带有`%d`、`%e`、`%f`等的数字，请始终传递不带`*`. 变量名*是*指向数组第一个元素的指针，`printf`将根据类型（`char`是 1 或 2 个字节，`int`s 是 4 等）使用简单的指针算法打印数组的每个元素，直到它到达 EOL 或零值。

当然，如果你创建一个指向*数组*变量的指针，那么你会想用`*`. 但这更多的是例外而不是规则。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:29:38.043

仅仅因为 printf 有这样的签名：`int printf(const char* format, ...);`这意味着它期望指向 char 表的指针，它将在内部取消引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T13:30:41.687

letter 并不指向整个字符串，而是指向字符串的第一个字符，因此是 char 指针。

当您取消引用指针（使用`*`）时，您指的是字符串的第一个字符。

然而，单个字符在打印字符串时非常有用（当打印字符串时），因此它取而代之的是指向第一个元素的指针并递增它的值，打印出取消引用值，直到找到空字符'\0'。

由于这是一个 C++ 问题，同样重要的是要注意您应该真正将字符串存储为安全封装类型`std::string`，并尽可能将类型安全 iostreams 存储为：

```
std::string line="hi how r u";
std::cout << line << std::endl; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-24T13:30:58.350

`%s`打印到第一次`\0`看到： http: [//msdn.microsoft.com/en-us/library/hf4y5e3w.aspx](http://msdn.microsoft.com/en-us/library/hf4y5e3w.aspx)，`%s`是一个字符串格式字段，这里没有什么奇怪的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-24T13:31:00.360

`printf("%s")`期望地址以通过内存搜索`NULL`( `\0`) = 字符串结尾。在这种情况下，您只说`letter`. `printf("%c")`期望值不是地址：`printf("%c", *letter);`

# asp.net-mvc - @Html.ActionLink 一种有效，一种无效

> ID：10298823
> 
> 赞同：1
> 
> 时间：2012-04-24T13:26:12.820
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, html.actionlink

我有两个@Html.ActionLink 的一个有效，一个无效，我不知道为什么？

它们都在同一个控制器中：StoreController 并且都在不同的控制器中调用 ActionResults，这是一个在 Director 类中工作并调用 Index 函数的控制器：

```
<ul>
@foreach (var item in Model)
{
    <li>
    <h2>@item.Title</h2>
    </li>
    <li class = "lihead">
    Directed by 
    @Html.ActionLink((string)item.Director.Name, "Index", "Director", new { searchString = item.Director.Name }, null)
    </li>
    <li>
    <i>@item.Synopsis</i>
    </li> 
    <li class = "lihead">
    Price per ticket £
    @item.Price
    </li>        
} 
```

这是一个不起作用的：

```
 @foreach (var item in Model) {
        @Html.ActionLink("Check Availability", "CheckAvail", "Booking", new { id = item.ShowId }) 
```

}

当我希望它在 BookingController 中调用 CheckAvail 函数时，它会在 StoreController 中调用。但是，当我这样修改它时它确实有效：

```
 @foreach (var item in Model) {
        @Html.ActionLink("Check Availability", "CheckAvail", "Booking")} 
```

但我需要它通过 ShowId 到函数？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:28:51.790

像这样使用它

```
@Html.ActionLink("Check Availability", "CheckAvail", "Booking", new { @id = item.ShowId },null) 
```

它正在使用这个重载

```
public static MvcHtmlString ActionLink(
    this HtmlHelper htmlHelper,
    string linkText,
    string actionName,
    string controllerName,
    Object routeValues,
    Object htmlAttributes
) 
```

[http://msdn.microsoft.com/en-us/library/dd504972.aspx](http://msdn.microsoft.com/en-us/library/dd504972.aspx)

最后一个参数是 HTML 属性。如果你有一些 HTML 属性要传递，你传递它而不是 null

```
@Html.ActionLink("Check Availability", "CheckAvail", "Booking", new { @id = item.ShowId },new { @class="myCssClass"} ) 
```

# c# - 侦听 TCP 服务器应用程序的以太网电缆拔出事件

> ID：10298824
> 
> 赞同：4
> 
> 时间：2012-04-24T13:26:13.493
> 
> 标签：c#, ethernet, tcpserver

我有一个 C# TCP 服务器应用程序。当 TCP 客户端与服务器断开连接时，我检测到它们断开连接，但是如何检测电缆拔出事件？当我拔下以太网电缆时，我无法检测到断开连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T14:14:11.673

您可能想要应用“ping”功能，如果 TCP 连接丢失，该功能将失败。使用此代码向 Socket 添加扩展方法：

```
using System.Net.Sockets;

namespace Server.Sockets {
    public static class SocketExtensions {
        public static bool IsConnected(this Socket socket) {
            try {
                return !(socket.Poll(1, SelectMode.SelectRead) && socket.Available == 0);
            } catch(SocketException) {
                return false;
            }
        }
    }
} 
```

如果没有可用的连接，方法将返回 false。即使您在 Reveice / Send 方法上没有 SocketExceptions，它也应该可以检查是否存在连接。请记住，如果您遇到与连接丢失相关的错误消息的异常，则不再需要检查连接。
当套接字看起来像已连接但可能与您的情况不同时，应使用此方法。

用法：

```
if (!socket.IsConnected()) {
    /* socket is disconnected */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:37:08.203

尝试[NetworkAvailabilityChanged](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkchange.networkavailabilitychanged.aspx)事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-08T09:36:32.143

我在[这里](https://stackoverflow.com/questions/722240/instantly-detect-client-disconnection-from-server-socket)找到了这个方法。它检查连接的不同状态并发出断开连接的信号。但**没有检测到拔下的电缆**。经过进一步的搜索和反复试验，这就是我最终解决它的方法。

作为`Socket`参数，我在服务器端使用来自已接受连接的客户端套接字，在客户端使用连接到服务器的客户端。

```
public bool IsConnected(Socket socket)    
{
    try
    {
        // this checks whether the cable is still connected 
        // and the partner pc is reachable
        Ping p = new Ping();

        if (p.Send(this.PartnerName).Status != IPStatus.Success)
        {
            // you could also raise an event here to inform the user
            Debug.WriteLine("Cable disconnected!");
            return false;
        }

        // if the program on the other side went down at this point
        // the client or server will know after the failed ping 
        if (!socket.Connected)
        {
            return false;
        }

        // this part would check whether the socket is readable it reliably
        // detected if the client or server on the other connection site went offline
        // I used this part before I tried the Ping, now it becomes obsolete
        // return !(socket.Poll(1, SelectMode.SelectRead) && socket.Available == 0);

    }
    catch (SocketException) { return false; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-08T13:44:43.000

这个问题也可以通过设置 KeepAlive 套接字选项来解决，如下所示：

```
 socket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.KeepAlive, true);
   socket.SetKeepAliveValues(new SocketExtensions.KeepAliveValues
   {
       Enabled = true,
       KeepAliveTimeMilliseconds = 9000,
       KeepAliveIntervalMilliseconds = 1000
   }); 
```

可以调整这些选项以设置检查的频率，以确保连接有效。Tcp KeepAlive的发送会触发socket自身检测网线断开。

# javascript - 如何在 JavaScript 中获取客户端时区？

> ID：10298829
> 
> 赞同：9
> 
> 时间：2012-04-24T13:26:34.407
> 
> 标签：javascript, timezone

谁可以编写一个函数来获取客户时区，返回值如：`EDT` `EST` `IST`等等

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-24T13:29:12.847

`toTimeString()`方法给时间与时区名称尝试下面...

```
var d=new Date();
var n=d.toTimeString();     

ouput

03:41:07 GMT+0800 (PHT) or 09:43:01 EDT 
```

# [演示](http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_totimestring)

**或者**

检查[：使用 JavaScript 自动检测时区](http://www.pageloom.com/automatic-timezone-detection-with-javascript)

下载 jstz.min.js 并向您的 html 页面添加一个函数

```
 <script language="javascript">
        function getTimezoneName() {
            timezone = jstz.determine_timezone()
            return timezone.name();
        }
    </script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:31:04.740

如果要使用时区值，请使用 Date().getTimezoneOffset() 函数，然后从此 URL [timeanddate构建一个哈希表以将其关联。](http://www.timeanddate.com/library/abbreviations/timezones/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T13:36:10.547

如果您查看调用`toString`Date 对象的方法的结果，您将获得类似于“Tue Apr 24 2012 23:30:54 GMT+1000 (AUS Eastern Standard Time)”的值。这将取决于您的系统区域设置。

从那里您可以匹配括号内的每个大写字母。

```
var paren = new Date().toString().match(/\(.+\)/);
return paren ? paren[0].match(/([A-Z])/g).join("") : ""; 
```

问题是并非每个浏览器都会包含括号中的值。

如果您使用已知的 Java 插件来定位 Firefox，您还可以利用`java`Javascript 中的对象根据名称（例如“America/Los_Angeles”）创建一个新的 TimeZone (java.util.TimeZone) 对象，然后调用`getDisplayName`方法给你的名字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-10T22:47:42.400

使用[jstz](http://pellepim.bitbucket.org/jstz/)获取时区名称：

```
jstz.determine().name(); 
```

它返回时区名称（如`'America/New York'`），然后您可以将其与`moment.js`等一起使用。

一个偏移量（例如从一个 js`Date`对象）是不够的，因为它不携带额外的 DST 信息（你不知道是否需要为夏令时调整时间以及何时）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-28T10:42:00.477

*   在javascript中获取客户端时区
*   -12 的输出：+12
*   你可以通过改变这一行来修改输出`-Math.round(a/60)+':'+-(a%60);`就像`-Math.round(a/60);`你得到 //+2

    ```
    var a = new Date().getTimezoneOffset();
    var res = -Math.round(a/60)+':'+-(a%60);
    res = res < 0 ?res : '+'+res;
    console.log(res); 
    ```

[参考](https://stackoverflow.com/questions/1091372/getting-the-clients-timezone-in-javascript)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-10-18T15:15:49.083

这是获得国家/地区完整时区的完美答案-

```
var a = new Date($.now());     
var regExp = /\(([^)]+)\)/;`enter code here`
var matches = regExp.exec(a);
alert(matches[1]); 
```

此警报将为您提供印度标准时间、美国标准时间、非洲标准时间等输出：

```
//$("#timezone option:contains(" + matches[1] + ")").attr('selected', 'selected'); 
```

# jms - 如何将 Glassfish 3 连接到外部 ActiveMQ 5 代理

> ID：10298835
> 
> 赞同：0
> 
> 时间：2012-04-24T13:26:57.823
> 
> 标签：jms, glassfish-3, activemq, cluster-computing, message-driven-bean

我需要能够从部署在 glassfish 3 上的应用程序向我们的 activemq 集群消费和产生消息。

我应该如何配置 glassfish 以实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T09:43:50.597

我找到了一些关于如何在 glassfish 中运行嵌入式 activemq 代理的信息，虽然这不是我想要的，但我能够弄清楚如何更改配置以连接到外部代理。

我写了一篇关于如何做到这一点的文章：http: [//geertschuring.wordpress.com/2012/04/20/how-to-connect-glassfish-3-to-activemq-5](http://geertschuring.wordpress.com/2012/04/20/how-to-connect-glassfish-3-to-activemq-5)

# php - Joomla redirect to login page with correct redirection parameter after unsuccessful login

> ID：10298837
> 
> 赞同：0
> 
> 时间：2012-04-24T13:27:13.520
> 
> 标签：php, joomla, joomla1.5, joomla1.7, joomla1.6

I have integrated Joomla with a vBulletin and a CPG using jFusion .

I have set the login link of vB and CPG as [http://fakesite.com/site/index.php?option=com_user&view=login&return=Zm9ydW0ucGhw](http://fakesite.com/site/index.php?option=com_user&view=login&return=Zm9ydW0ucGhw) , so that when a user logs into Joomla from that link , he will get redirected back to vB or CPG after a successful login .

This is happening correctly , but when I login with a wrong username and password , it just redirects back to vB or CPG without any warning, or prompting to try again .

I am using latest Joomla 1.5.x version .

How can I fix this ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:29:24.983

```
$un = $_POST['username'];
$pass = md5($_POST['password']);

$sql = mysql_query("SELECT * FROM melga_eveikals_lietotaji WHERE username='$un'AND password='$pass'");
if (mysql_num_rows($sql) == 0){
header('Location: ' . $_SERVER['HTTP_REFERER']);
} 
```

# c# - Webdriver, CSharp, C# - Cannot switch between windows

> ID：10298841
> 
> 赞同：5
> 
> 时间：2012-04-24T13:27:19.263
> 
> 标签：c#, selenium, automation, webdriver, selenium-webdriver

I am stuck when trying to switch windows using the latest version of webdriver in C#.

I have a base window, when i click a button, it opens a new window.

The target code for this button is as below.

```
window.open(uri, "DisplayPage", " width=1200, scrollbars=yes , resizable = yes ,   toolbar =  no , menubar =  no"); 
```

I am using the below mentioned code to target the new window

```
 string BaseWindow = _driver.CurrentWindowHandle;

   ReadOnlyCollection<string> handles = _driver.WindowHandles;

    foreach (string handle in handles)
    {

        if (handle != BaseWindow)
        {
            _driver.SwitchTo().Window(handle).Title.Equals("DisplayPage");

        }
    }
} 
```

As you can see from above, I am switching to the window using the Target Title from the base window. This does not seem to work.

I then noticed that the Title of the opened window was different, it was "Display - Transaction Page"

I then modified the code to this

```
 string BaseWindow = _driver.CurrentWindowHandle;

       ReadOnlyCollection<string> handles = _driver.WindowHandles;

        foreach (string handle in handles)
        {

            if (handle != BaseWindow)
            {
                _driver.SwitchTo().Window(handle).Title.Equals("Display - Transaction Page");

            }
        }
    } 
```

Still no luck.

Interestingly, I do not get any errors saying "Window not found".

The problem is that When i try to click on elements on the newly opened page, i get a NoSuchElementException which means that the newly opened window has not been targeted.

Any ideas?

Regards,

Hasan

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T07:07:52.297

一旦窗口更改为您的窗口，您应该打破循环，否则它将始终切换到最后打开的窗口：

```
foreach (string handle in handles) {
 if (handle != BaseWindow) {
  if(_driver.SwitchTo().Window(handle).Title.Equals("Display - Transaction Page")) 
    break;
  }
} 
```

您可以尝试使用`Contains`而不是`equal`，它将简化窗口搜索：

```
_driver.SwitchTo().Window(handle).Title.Contains("Display"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-19T11:57:53.500

尽管您自己破解了答案，但还有另一种方法可以在 C# 中处理窗口之间的切换。

```
// initiate webdriver
IWebDriver driver = new FirefoxDriver();

//perform some action to open a new window. Like clicking a link.
driver.FindElement(By.Id("btnId")).Click();

//switch to new window.
driver.SwitchTo().Window(driver.WindowHandles.Last());

//if you want to switch back to your first window
driver.SwitchTo().Window(driver.WindowHandles.First()); 
```

# iphone - UITableView not displaying data after altering frame and transform properties

> ID：10298842
> 
> 赞同：0
> 
> 时间：2012-04-24T13:27:32.727
> 
> 标签：iphone, ios, ipad, uitableview

I have created a tableView and changed it transform and frame properties mostly because i want it work much like a scrollView(with lazy loading).

```
 UITableView *tempTableView = [[UITableView alloc] init];

        //Rotating it 90`
        tempTableView.transform = CGAffineTransformMakeRotation(-1.5707);
        tempTableView.frame = CGRectMake(0, 30, 768, 79); 
```

A little later in the application i need to change the size of the tableView this seems to fail(the tableViews contents are no more visible although the table view itself is) wether i try to edit the tables 'frame' or 'bounds' properties

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:52:34.603

在您的代码中使用 addSubview 方法。

```
tempTableView.transform = CGAffineTransformMakeRotation(-1.5707);
tempTableView.frame = CGRectMake(0, 30, 768, 79);
 //tempTableView.frame =  CGRectMake(0, 0, 320, 480);
[self.view addSubview:tempTableView]; 
```

# php - 如果 ... AND ... AND (...) OR (..)

> ID：10298846
> 
> 赞同：1
> 
> 时间：2012-04-24T13:27:40.600
> 
> 标签：php, if-statement

我需要在 PHP 中实现它：

```
if submit isset
 AND myname isset
 AND adress not empty 
 AND phonenumber not empty
 AND email not empty
 AND ( 
 institution OR g_year not empty (one should be 'full') 
   OR
 donation_p OR loan_p isset (should be set)
   OR
 donation_m OR loan_m isset (should be set)..
) 
```

我写的：

```
if ((isset($_POST['submit'])) 
     && ($_POST['myname'] != '') 
     && ($_POST['adress'] != '')   
     && ($_POST['phonenumber'] != '') 
     && ($_POST['email'] != '') 
     && (($_POST['institution'] != '') || ($_POST['g_year'] != ''))
         || ((isset($_POST['donation_p'])) && (isset($_POST['loan_p'])))
         || ((isset($_POST['donation_m'])) && (isset($_POST['loan_m'])))) 
```

我的代码有什么问题？

我希望有人能给我答案..我希望你明白我想要什么;D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:38:46.790

1.  您需要设置“myname”，但您正在测试 myname != ''。
2.  您需要“捐赠或贷款”，但您正在测试“捐赠和贷款”。
3.  您应该考虑测试 !empty($var) 而不是 $var != ''。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:50:39.483

尝试使用`if` `elseif` `else`而不是您现在正在做的事情，这应该可以！

# javascript - unexpected "ui-li-static" and "ui-body-c" in jQuery-Mobile

> ID：10298854
> 
> 赞同：0
> 
> 时间：2012-04-24T13:27:59.443
> 
> 标签：javascript, jquery, jquery-mobile

I am a beginner of js and just begin to learn jQuery Mobile. I have created a listview page, I wrote the html code like this:

```
<li data-iconshadow="true" data-wrapperels="div" data-icon="arrow-r" data-iconpos="right" data-theme="c"
                    class="ui-btn ui-btn-icon-right ui-li-has-arrow ui-li ui-corner-top ui-btn-up-c">
      <div class="ui-btn-inner ui-li ui-corner-top">
        <div class="ui-btn-text">
         <a href="#" class="ui-link-inherit">Chuan</a>
        </div>
        <span class="ui-icon ui-icon-arrow-r ui-icon-shadow"></span>
      </div>
</li> 
```

and when I open this html in Chrome, the code begin to look like this:

```
<li data-iconshadow="true" data-wrapperels="div" data-icon="arrow-r" data-iconpos="right" data-theme="c"
                class="ui-btn ui-btn-icon-right ui-li-has-arrow ui-li ui-corner-top ui-li-static ui-body-c ui-btn-up-c">
  <div class="ui-btn-inner ui-li ui-li-static ui-body-c ui-corner-top">
    <div class="ui-btn-text">
     <a href="#" class="ui-link-inherit">Chuan</a>
    </div>
    <span class="ui-icon ui-icon-arrow-r ui-icon-shadow"></span>
  </div>
</li> 
```

You could see, there are "ui-li-static" and "ui-body-c" show up, and it makes my table cell very fat. Could anyone tell me how could these 2 attributes be added and how I could remove it? Thanks a lot.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T12:07:05.557

在 ready 函数中，您可以删除这个意外的类。

```
$('#your_page_or_pageRole_id').bind('pageinit', function() {
                $("#li_id").removeClass("ui-li-static");                
            }); 
```

# php - Zend Framework 2 无法渲染模板；解析器无法解析到第 461 行 PhpRenderer.php 中的文件

> ID：10298859
> 
> 赞同：2
> 
> 时间：2012-04-24T13:28:13.723
> 
> 标签：php, zend-framework

我正在尝试在没有 MVC 框架的情况下使用 ZF2 PhpRenderer。目前我无法实现所有东西，但想开始将一些东西重新分解为修改后的版本，直到我能够在以后的生活中实现整个框架。

我一直在尝试使用程序员参考。

在我的 tester.php 脚本的顶部。

```
use Zend\View\Model\ViewModel,
    Zend\View\Renderer\PhpRenderer,
    Zend\View\Resolver; 
```

然后稍后在脚本中，我开始尝试渲染脚本。

```
$renderer = new PhpRenderer();

$map = new Resolver\TemplateMapResolver(array(
    'tester' => __DIR__ . '/tester.phtml',
));

$resolver = new Resolver\TemplateMapResolver($map);

$model = new ViewModel();
$model->setVariable('foo', 'bar');
$model->setTemplate('tester');

echo $renderer->render($model); 
```

我得到的错误是这个

无法呈现模板“tester”；解析器无法解析到第 461 行 /home/lumberjacked/workspace/www/vendor/zf2/library/Zend/View/Renderer/PhpRenderer.php 中的文件

任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T15:08:56.933

I found the solution and its pretty simple. After declaring your $resolver you have to set it in the $renderer.

```
$renderer->setResolver($resolver); 
```

I found this in the constructor of the renderer calling this method.

# mysql - mysql存储过程中的嵌套循环

> ID：10298860
> 
> 赞同：1
> 
> 时间：2012-04-24T13:28:18.293
> 
> 标签：mysql, stored-procedures, while-loop

我在存储过程中有一个简单的嵌套 while 循环，但它给出了一个错误。该循环并没有什么大不了的，只是为了学习目的，我创建了两个循环。

```
delimiter $$
create procedure getSum(in input int , out output int)
begin

set output = 0;
while input >= 1 do

  declare tmp int default 1;
  while tmp <= 5 do
      set  output = output + input ;
      set tmp = tmp + 1;
   end while ;

set input = input - 1 ;

end while;

end $$
delimiter ; 
```

下面是错误

**`#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'declare tmp int default 1; while tmp <= 5 do set output = output + inpu' at line 7`**

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:31:49.160

试试这个：

```
delimiter $$
create procedure getSum(in input int , out output int)
begin
declare tmp int default 1;
set output = 0;
while input >= 1 do

  set tmp = 1;
  while tmp <= 5 do
      set  output = output + input ;
      set tmp = tmp + 1;
   end while ;

set input = input - 1 ;

end while;

end $$
delimiter ; 
```

# sql - 对子字符串的 SQL 检查约束

> ID：10298861
> 
> 赞同：1
> 
> 时间：2012-04-24T13:28:21.167
> 
> 标签：sql, substring, check-constraints

原谅我，如果这个问题在 SO 上的另一张票中得到解决……我一直在寻找，但似乎找不到完全正确的解决方案……

我正在创建一个表。“Creditor”列一直是数字，除了最后一个字符可能是破折号。

这意味着像“1234-”、“92846293”等示例是有效的，而“12354-53”、“12345K”是无效的。字符串长度不是固定的（除了它是 varchar(50)）。

我不知道如何创建检查约束。

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:36:26.387

您没有说明您的 DBMS。对于 PostgreSQL，这将是：

```
alter table foo 
  add constraint check_creditor check (creditor ~ '^([0-9]+)\-?$'); 
```

对于 Oracle，这将是：

```
alter table foo 
   add constraint check_creditor check (regexp_like(creditor, '^([0-9]+)\-?$')) 
```

如果您的 DBMS 支持正则表达式，您将需要使用 DBMS 的语法来检查这一点。正则表达式本身`'^([0-9]+)\-$'`很可能是相同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T11:12:47.250

谢谢您的回复。

这个提议`'%[^0-9]%'`让我大开眼界，因为我以前不认识`^`接线员。

我做了两个版本的所需约束。一种使用“仅”AND、OR、子字符串和非数字。没有花哨的索引或排除。太长了。另一个版本由 AND、OR、子字符串和 insmuric 组成，但包含了建议的 ^ 操作。看起来好看了很多。

然后，最后，我采用了第三种解决方案 :-) 在数据库中添加了一个 bool 列 RequiresCreditorValidation，并在我的 C# 代码中实现了一个正则表达式。

对于希望从结果检查中受益的其他人，他们在这里。从“丑陋”的开始：

```
CHECK ((val NOT IN ('+','-') AND (ISNUMERIC(val) = 1) OR 
(ISNUMERIC(SUBSTRING(val, 1, DATALENGTH(val) -1))) = 1) AND 
((SUBSTRING(val, (DATALENGTH(val)),1) LIKE '[0-9]') OR 
(SUBSTRING(val, DATALENGTH(val),1) = '-')) AND 
(SUBSTRING(val, 1, 1) NOT IN ('+','-')) ) 
```

第二个：

```
CHECK ( (SUBSTRING(val, 1, DATALENGTH(val) - 1) NOT LIKE '%[^0-9]%') AND 
(SUBSTRING(val, DATALENGTH(val),1) LIKE '%[0-9-]') AND (DATALENGTH(val) > 0) 
AND SUBSTRING(val, 1,1) NOT IN ('+','-') ) 
```

然后是正则表达式：

```
var allButLast = kreditorId.Substring(0, kreditorId.Length - 1);
        if (Regex.Match(allButLast, "[^0-9]").Success)
            return false;
        if (!kreditorId.EndsWith("-"))
            if (Regex.Match(kreditorId, "[^0-9]").Success)
                return false;
        return true; 
```

感谢大家的良好，合格和快速的答复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:59:03.213

对于 SQL Server：

测试 1：除最后一个之外的所有字符都是数字（或者，不存在非数字字符）：

```
CHECK ( SUBSTRING(Creditor, 1, LEN(Creditor) - 1) NOT LIKE '%[^0-9]%' ) 
```

测试 2：最后一个字符是数字或破折号：

```
CHECK ( SUBSTRING(Creditor, LEN(Creditor), 1) LIKE '%[0-9-%]' ) 
```

以上假设`Creditor`不能是空字符串，即

```
CHECK ( LEN(Creditor) > 0 ) 
```

* * *

只是为了好玩：

```
CHECK ( REVERSE(CAST(REVERSE(Creditor) + REPLICATE(0, 50) AS CHAR(50))) 
           LIKE REPLICATE('[0-9]', 49) + '[0-9-]' ) 
```

# jquery - add & removeClass jQuery

> ID：10298862
> 
> 赞同：1
> 
> 时间：2012-04-24T13:28:21.333
> 
> 标签：jquery, html, css, addclass, removeclass

I have a simple 2 level menu, and the upper menu should get the class "selected" if the mouse is over, and the class should be removed when moving over another first-level menu item. But thats not the problem, that already works.

My problem is: the first-level menuitem should leave on "selected" until i go on another first-level menuitem. Up to now my script removes the class "selected" as soon as i leave my mouse from the item

```
<script type="text/javascript">
    $(document).ready(function(){
        $("#navi li").hover(function(){
            $(this).addClass('selected');
        },function(){
            $(this).removeClass('selected');
        });
    });
</script> 
```

I want that all items with the class "selected" getting their class removed as soon as my mouse is on another item, but if the mouse is only on a submenu-item or whereever it could be on the page, the selected item should stay selected.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:34:18.510

这就是你所追求的吗？您可以在悬停时删除所有选定的类，然后将选定的类添加到所需的元素中。

```
 $(document).ready(function(){
        $("#navi li").hover(function(){
            $("#navi li").removeClass('selected');
            $(this).addClass('selected');
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:36:40.783

尝试绑定到`mousemove`事件：

```
$("ul").mousemove(function (e) {
    if (e.target.tagName == "LI") {
         $(".selected").removeClass("selected");
         $(e.target).addClass("selected");        
    }
});​ 
```

[**演示。**](http://jsfiddle.net/EuMBE/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:36:59.297

发生这种情况是因为以下 lin：

```
},function(){
                $(this).removeClass('selected');
            }); 
```

这意味着当您将鼠标移出时，上述回调将被执行。

而是这样做：

```
 $(document).ready(function(){
            $("#navi li").hover(function(){
                $(this).addClass('selected');
            },function(){ });
        }); 
```

[http://jsfiddle.net/SyvYv/](http://jsfiddle.net/SyvYv/)

参考[http://api.jquery.com/hover/](http://api.jquery.com/hover/)

# jquery - 在 Jquery 自动完成远程数据源中获取事件错误

> ID：10298864
> 
> 赞同：3
> 
> 时间：2012-04-24T13:28:25.200
> 
> 标签：jquery, jquery-ui, error-handling, jquery-ui-autocomplete

我正在使用带有远程数据源的 Jquery 自动完成功能，但是，有时尝试在我的服务器中进行搜索时会返回错误，因为我正在使用像数据源这样的休息 Web 服务。我想知道我的网络服务返回的状态码并打印错误消息示例：

```
$(idObjeto).autocomplete({
            source:url,
            minLength: 3,
            select:function(data,ui){
                $(formatIdJQuery(idObjValueReceptor)).val(ui.item.id);
            }
        }).data( "autocomplete" )._renderItem = function( ul, item ) {
        return $( "<li></li>" )
            .data( "item.autocomplete", item )
            .append( "<a>" + item.label + " - <strong>" + item.id + "</strong></a>" )
            .appendTo( ul );
        };
    } 
```

假设我的 web 服务返回状态码 404，例如，我想获取此状态码并调用警报窗口。

这就是所有的人！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T13:31:08.833

您可以重新构造您的小部件以使用函数作为`source`参数，然后自己发出 AJAX 请求，并在出现错误时执行您想做的任何事情：

```
$(idObjeto).autocomplete({
    source: function (request, response) {
        $.ajax({
            url: url,
            dataType: "json",
            data: request,
            success: function (data) {
                response(data);
            },
            error: function () {
                response([]); // send no results to the widget.
                alert("an error occurred!");
            }
        });
    },
    minLength: 3,
    select:function(data,ui){
        $(formatIdJQuery(idObjValueReceptor)).val(ui.item.id);
    }
}).data( "autocomplete" )._renderItem = function( ul, item ) {
    return $( "<li></li>" )
        .data( "item.autocomplete", item )
        .append( "<a>" + item.label + " - <strong>" + item.id + "</strong></a>" )
        .appendTo( ul );
    };
}; 
```

# javascript - “如果 n 大于形式参数或实际参数的数量，则无法设置参数 [n]”错误的状态？

> ID：10298873
> 
> 赞同：3
> 
> 时间：2012-04-24T13:28:47.087
> 
> 标签：javascript

可以设置函数属性的单个元素`arguments`（Mozilla 称之为“类数组”属性），但是 Mozilla 报告说，在 SpiderMonkey 1.5 中无法向该属性添加元素，尽管这在 1.6 中已修复（参考请注意此处的 SpiderMonkey... [https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope/arguments](https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope/arguments)）。

这是一个有用的属性，从子类链接构造函数，创建参数列表以传递给函数（例如，`myclassmethod.apply(this, arguments)`）等。

但是我发现 V8 不会像 Mozilla 报告的 SpiderMonkey 1.5 那样延长长度。（不确定其他 JavaScript 引擎、Opera、Rhino 等的状态如何）。

这实际上是 ECMA 功能吗？Mozilla 认为这是一个错误是错误的，还是 V8 有一个错误要修复？

[更新]我发现使用 V8`arguments.length`可以分配属性，因此`arguments`可以有效地扩展（或设置为您需要的任何长度）。然而 JSLint 确实抱怨这是一个糟糕的任务。

[更新] 一些测试代码如果有人想在 Opera、FF 等中尝试这个，创建一个子类的实例，用一个 arg 调用构造函数，同时`arguments`在子类构造函数中添加一个元素并调用超类构造函数，超类应该报告两个论点：

```
function MyClass() {
    if (arguments.length) {
        console.log("arguments.length === " + arguments.length);
        console.log("arguments[0] === " + arguments[0]);
        console.log("arguments[1] === " + arguments[1]);
    }
}

function MySubClass() {
    console.log(arguments.length);
    //arguments.length = 2;  // uncomment to test extending `length' property works
    arguments[1] = 2;
    MyClass.apply(this, arguments);
}

MySubClass.prototype = new MyClass();

new MySubClass(1); 
```

[更新] JSLint 实际上会在您`arguments`通过外观进行任何类型的分配时抱怨（例如，`arguments[0] = "foo"`）。所以也许 JSLint 在这里也有一些工作要做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T13:48:37.700

不确定这是否是您要查找的内容，但您可以将 arguments 对象转换为标准数组：

```
var args = [].slice.call(arguments, 0); 
```

[编辑]所以你可以这样做：

```
myclassmethod.apply(this, [].slice.call(arguments, 0).push(newValue)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:26:12.617

好的，我想我们可以就此得出结论。

在 FF、Comodo Dragon、Opera 和 IE（所有当前版本，Windoze）上运行上面的示例代码，它们都将接受`arguments.length`属性更改以调整（如 Mozilla 所说的那样，'array-like'）`arguemnts`对象的大小。None 会像通常的数组一样通过分配一个值来增加大小（即，`arguments[arguments.length] = "new arg"`）。

似乎 javascript 引擎的共识是，“类数组”对象的`arguments`行为类似于数组，但在其他方面倾向于引发一些惊喜；）无论哪种方式，ECMA 标准的解释似乎都是表面上的至少全面一致，因此语义并不是真正的问题（为什么和为什么是唯一剩下的问题，但仅具有历史意义）。

MSDN 和 Mozilla 似乎都没有这个文档（不确定 V8 或 Opera 将他们的 JS 文档隐藏在哪里）——简而言之，一些文档肯定不会出错。到那时我会退出，但是如果有人可以在某个时候机会主义地向相关方提出提示，那么偶尔使用一次是一种有用的技术。

感谢所有花时间研究这个问题的人。

[更新] BishopZ 已经在上面指出，`.apply`无论如何都会有一系列论据（自从我多年前上次使用它以来，我一直没有想到，这解决了我的问题）。然而，“类数组”`arguments`仍然可以使用，在某些情况下甚至可能更可取（例如更容易弹出一个值，或者只是将参数传递给超类）。再次感谢您查看问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T14:19:54.543

ECMA-262 10.1.8 说对象的`arguments`原型是对象原型，并且`arguments`对象以某种方式初始化，使用短语“初始值”。因此，您似乎可以将其任何属性分配给您想要的任何东西。我不确定这是否是正确的解释。

# ruby-on-rails - Redmine插件开发

> ID：10298888
> 
> 赞同：3
> 
> 时间：2012-04-24T13:29:15.113
> 
> 标签：ruby-on-rails, ruby, redmine, redmine-plugins

我正在尝试为 Redmine 创建一个消息插件。我对此有几个疑问

1.  如何在 Redmine 插件中发送电子邮件？是否可以在插件内创建邮件程序？如果是这样，创建邮件程序的命令是什么？

2.  我几乎可以在所有控制器文件中看到这个（**call_hook ）方法。**这种方法有什么用？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T08:48:54.263

有两种方法可以做到：

1.  创建新的 Mailer 并从 redmine mailer 继承它，然后根据需要添加新方法
2.  修补 redmine 邮件程序并添加发送邮件的方法

我在我的插件[RedmineCRM](http://redminecrm.com/projects/contacts-plugin/contacts)中使用了第二个，你可以下载它并检查 lib/redmine_contacts/patches/mailer_patch.rb

```
require 'dispatcher'   

module RedmineContacts
  module Patches    

    module MailerPatch
      module InstanceMethods
        def contacts_note_added(note, parent) 
          redmine_headers 'X-Project' => note.source.project.identifier, 
          'X-Notable-Id' => note.source.id,
          'X-Note-Id' => note.id
          message_id note
          if parent
            recipients (note.source.watcher_recipients + parent.watcher_recipients).uniq
          else
            recipients note.source.watcher_recipients
          end

          subject "[#{note.source.project.name}] - #{parent.name + ' - ' if parent}#{l(:label_note_for)} #{note.source.name}"  

          body :note => note,   
          :note_url => url_for(:controller => 'notes', :action => 'show', :note_id => note.id)
          render_multipart('note_added', body)
        end

        def contacts_issue_connected(issue, contact)
          redmine_headers 'X-Project' => contact.project.identifier, 
          'X-Issue-Id' => issue.id,
          'X-Contact-Id' => contact.id
          message_id contact
          recipients contact.watcher_recipients 
          subject "[#{contact.projects.first.name}] - #{l(:label_issue_for)} #{contact.name}"  

          body :contact => contact,
          :issue => issue,
          :contact_url => url_for(:controller => contact.class.name.pluralize.downcase, :action => 'show', :project_id => contact.project, :id => contact.id),
          :issue_url => url_for(:controller => "issues", :action => "show", :id => issue)
          render_multipart('issue_connected', body)
        end

      end  

      def self.included(receiver)
        receiver.send :include, InstanceMethods
        receiver.class_eval do 
          unloadable   
          self.instance_variable_get("@inheritable_attributes")[:view_paths] << RAILS_ROOT + "/vendor/plugins/redmine_contacts/app/views"
        end  
      end

    end

  end
end

Dispatcher.to_prepare do  

  unless Mailer.included_modules.include?(RedmineContacts::Patches::MailerPatch)
    Mailer.send(:include, RedmineContacts::Patches::MailerPatch)
  end   

end 
```

# android - 在android中的应用程序中控制音量？

> ID：10298891
> 
> 赞同：0
> 
> 时间：2012-04-24T13:29:24.800
> 
> 标签：android

我正在准备一个应用程序。我的应用程序有一个选项按钮，声音开启和关闭。为此，我使用了以下代码，

```
AudioManager audioManager = (AudioManager) getSystemService(Context.AUDIO_SERVICE);
  int maxVolume = audioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
  int curVolume = audioManager.getStreamVolume(AudioManager.STREAM_MUSIC); 
```

不幸的是，该应用程序的音量设置仍会反映该应用程序正在使用的流类型的系统音量设置。我想知道的是如何只为该应用程序设置音量而不影响系统设置。

在android中是否可以完全控制应用程序的音量？有没有什么方法可以做到这一点？我必须用代码做到这一点吗？请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:05:47.283

You could use AudioTrack, a lower level sound API. It has an setStereoVolume() which operates independent of the system volume.

# jsp - JSP 错误：期望具有“名称”和“值”属性的“jsp:param”标准操作

> ID：10298895
> 
> 赞同：2
> 
> 时间：2012-04-24T13:29:34.430
> 
> 标签：jsp, tomcat, jsp-tags, jspinclude

我有一个具有以下代码的 JSP 页面：

```
<td colspan=2>
    <div align="right">         
        <jsp:include page="/field_help.jsp" flush="true" >
            <% if(researchTabON) { %>
                <jsp:param name = "Command" value ="research"/>
            <% } else { %>
                <jsp:param name = "Command" value ="error"/>
            <% } %>
            <jsp:param name="Location" value="paperworkadmintool/xml/pwAdminFieldHelp.xml"/>
        </jsp:include>
    </div>
</td> 
```

上面的代码片段在*WAS 6*上运行良好，但是当我尝试在*Tomcat*上运行相同的代码时，它会抛出以下异常：

```
/my_page.jsp(71,7) Expecting "jsp:param" standard action with "name" and "value" 
    attributes org.apache.jasper.JasperException: /my_page.jsp(71,7) Expecting 
    "jsp:param"  standard action with " name"  and " value"  attributes

at org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:40)
at org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:407)
at org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:88)
at org.apache.jasper.compiler.Parser.parseParam(Parser.java:843) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T16:34:29.657

```
<%
String command = ... ;//calculate your desired value here
%>
    <jsp:include page="/field_help.jsp" flush="true" >
        <jsp:param name="Command" value="<%=command%>"/>
        <jsp:param name="Location" value="paperworkadmintool/xml/pwAdminFieldHelp.xml"/>
    </jsp:include> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T07:22:32.983

**:- 该动作标签允许在处理请求时将URL指定的HTML或JSP页面等静态或动态资源包含在当前JSP中。该包含标签包含2个属性1.page：类似于页面Diretive标签。2.flush：取true或false，表示在包含资源之前是否需要flush buffer。默认值为false。**

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:47:42.383

Tomcat 显然不喜欢这种语法。当正文为空时，您*通常会*收到此错误。`<jsp:include>`显然，这些 scriptlet 生成了令人困惑的 Java 代码。尝试如下更改：

```
<jsp:include page="/field_help.jsp" flush="true" >
    <jsp:param name="Command" value="<%=(researchTabON ? "research" : "error")%>"/>
    <jsp:param name="Location" value="paperworkadmintool/xml/pwAdminFieldHelp.xml"/>
</jsp:include> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-25T14:17:33.850

想添加到这个线程。我正在做一个 weblogic to tomcat switch，并且遇到了同样的错误。就我而言，这是因为 weblogic 可以使用 HTML 注释，但 tomcat 不行。

```
 <jsp:include page="/test.jsp"> <!-- COMMENT -->
      <jsp:param name="vType" value="<%=name%>" /> 
    </jsp:include> 
```**

# encoding - IPP中如何判断帧是否为IDR帧？

> ID：10298897
> 
> 赞同：0
> 
> 时间：2012-04-24T13:29:36.870
> 
> 标签：encoding, h.264, video-encoding, intel-ipp

在我的应用程序中，我尝试使用 IPP H.264 编码器。我设置了编码器选项，以便每个 I 帧都是 IDR 帧：

```
UMC::H264EncoderParams params = new UMC::H264EncoderParams;
// Here set some other useful parameters, and then set IDR interval.
// If it takes the n value then each n-th I frame is encoded as IDR.
params->key_frame_controls.idr_interval = 1; 
```

通常所有生成的 I 帧都是 IDR，但有时 IPP 会生成不是 IDR 的 I 帧。似乎它发生在发生了很大的场景变化时。

我需要检测 IDR 帧并将它们与所有其他帧（包括这些不是 IDR 的 I 帧）区分开来。IPP 中是否有一些方法可以解决此任务？还是只能手动完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:12:34.007

也许对 RTSP“恢复点”的一些研究会对您有所帮助。

[http://forum.doom9.org/archive/index.php/t-147533.html](http://forum.doom9.org/archive/index.php/t-147533.html)

# javascript - 使用 jQuery $.ajax() 时如何使用 GET 在请求正文中发送数据

> ID：10298899
> 
> 赞同：73
> 
> 时间：2012-04-24T13:29:38.830
> 
> 标签：javascript, jquery, ajax

我正在使用的服务 API 有一个给定的 GET 方法，该方法需要在请求正文中发送数据。

正文中所需的数据是由 hypen 分隔的 id 列表，可能非常大，因此必须在正文中发送，否则它可能会在浏览器/代理/网络服务器等链中的某个位置发送。请注意，我无法控制服务或 API，因此请不要提出更改建议。

我正在使用以下 jQuery 代码，但是观察提琴手中的请求/响应，我可以看到我发送的“数据”总是被转换并附加到查询字符串中，尽管我将“processData”选项设置为 false...

```
$.ajax({
   url: "htttp://api.com/entity/list($body)",
   type: "GET",
   data: "id1-id2-id3",
   contentType: "text/plain",
   dataType: "json",
   processData: false, // avoid the data being parsed to query string params
   success: onSuccess,
   error: onError
}); 
```

任何人都知道我如何强制在请求正文中发送“数据”值？任何帮助表示赞赏，在此先感谢。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-04-24T14:14:42.750

一般来说，这不是系统使用 GET 请求的方式。因此，很难让您的库配合使用。事实上，[规范](http://www.w3.org/TR/XMLHttpRequest/#the-send-method)说“如果请求方法是区分大小写的 GET 或 HEAD 匹配，就好像数据为空一样。” 所以，我认为你运气不好，除非你使用的浏览器不尊重规范的那一部分。

您可能可以在自己的服务器上为 POST ajax 请求设置一个端点，然后在您的服务器代码中将其重定向到带有正文的 GET 请求。

如果您不完全依赖以主体为数据的 GET 请求，那么您有两个选择。

**POST 与数据：**这可能是你想要的。如果您正在传递数据，那可能意味着您正在修改某些模型或在服务器上执行某些操作。这些类型的操作通常通过 POST 请求完成。

**使用查询字符串数据获取：**您可以将数据转换为查询字符串参数，然后以这种方式将它们传递给服务器。

```
url: 'somesite.com/models/thing?ids=1,2,3' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-06-17T07:33:23.107

我们都知道，根据http标准发送数据，我们一般使用POST请求。但是，如果您真的想在场景中使用 Get 发送数据，我建议您使用查询字符串或查询参数。

**1.GET 使用查询字符串作为**. `{{url}}admin/recordings/some_id`

这里 some_id 是**要**发送的补充参数，可以在服务器端使用和**req.params.some_id**。

2\. **GET 使用查询字符串作为**`{{url}}admin/recordings?durationExact=34&isFavourite=true`

这里的 durationExact ,isFavourite 是要发送的**可选**字符串，可以在服务器端使用**req.query.durationExact** 和**req.query.isFavourite**。

3\. **GET 发送数组** `{{url}}admin/recordings/sessions/?os["Windows","Linux","Macintosh"]`

你可以像这样在服务器端访问这些数组值

```
let osValues = JSON.parse(req.query.os);
        if(osValues.length > 0)
        {
            for (let i=0; i<osValues.length; i++)
            {
                console.log(osValues[i])
                //do whatever you want to do here
            }
        } 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2017-12-07T16:30:15.563

以防万一有人仍然提出这个问题：

任何请求中都有一个正文查询对象。您不需要自己解析它。

例如，如果您想使用 GET 从客户端发送 accessToken，您可以这样做：

```
const request = require('superagent');

request.get(`http://localhost:3000/download?accessToken=${accessToken}`).end((err, res) => {
  if (err) throw new Error(err);
  console.log(res);
});
```

然后服务器请求对象看起来像`{request: { ... query: { accessToken: abcfed } ... } }`

# javascript - 使用 jQuery 后，href 链接不起作用

> ID：10298901
> 
> 赞同：1
> 
> 时间：2012-04-24T13:29:44.140
> 
> 标签：javascript, jquery

HTML：

```
<ul class="current">
<li>
    <a href="#nogo"><b>Products</b>
     <div class="select_sub show">
         <ul class="sub">
          <li class="sub_show"><a href="product/product.php">Add product</a></li>
         </ul>
     </div>
   </a>
   </li>
 </ul>

<ul class="select">
<li>
   <a href="#nogo"><b>Item</b>
     <div class="select_sub">
         <ul class="sub">
          <li><a href="itea/item.php">Add Item</a></li>
         </ul>
     </div>
   </a>
</li>
</ul> 
```

jQuery：

```
$("ul").click(function (e) {
    e.preventDefault(); // if iI comment that line a href link work but navigation not work 
    var $this = $(this);
    var $siblings = $(this).siblings();

    $this.addClass("current").removeClass("select");
    $this.find('.select_sub').addClass('show');

    $siblings.removeClass("current").addClass('select');
    $siblings.find('.select_sub').addClass('show');

}); 
```

如果我单击`Add product`链接，则此 url 上有重定向`product/product.php`

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:45:28.630

我的猜测是，当您说 时`e.preventDefault()`，您实际上是在告诉您要防止`ul`默认值，这没什么。尝试`preventDefault()`直接在链接上调用。

# core-animation - 使用 actionForKey 的自定义属性动画：如何获取属性的新值？

> ID：10298905
> 
> 赞同：7
> 
> 时间：2012-04-24T13:29:58.513
> 
> 标签：core-animation

在我正在处理的 CALayer 子类中，我有一个要自动设置动画的自定义属性，也就是说，假设该属性称为“myProperty”，我想要以下代码：

```
[myLayer setMyProperty:newValue]; 
```

导致从当前值到“newValue”的平滑动画。

使用覆盖 actionForKey: 和 needsDisplayForKey: 的方法（见下面的代码）我能够让它运行得很好，只需在旧值和新值之间进行插值。

我的问题是我想根据属性的当前值和新值使用稍微不同的动画持续时间或路径（或其他），我无法弄清楚如何从 actionForKey 中获取新值：

提前致谢

```
@interface ERAnimatablePropertyLayer : CALayer {
    float myProperty;
}
@property (nonatomic, assign) float myProperty;
@end
@implementation ERAnimatablePropertyLayer
@dynamic myProperty;

- (void)drawInContext:(CGContextRef)ctx {
     ... some custom drawing code based on "myProperty"
}

- (id <CAAction>)actionForKey:(NSString *)key {
    if ([key isEqualToString:@"myProperty"]) {
        CABasicAnimation *theAnimation = [CABasicAnimation animationWithKeyPath:key];
        theAnimation.fromValue = [[self presentationLayer] valueForKey:key];

        ... I want to do something special here, depending on both from and to values...

        return theAnimation;
        }
    return [super actionForKey:key];
    }

+ (BOOL)needsDisplayForKey:(NSString *)key {
    if ([key isEqualToString:@"myProperty"])
        return YES;
    return [super needsDisplayForKey:key];
    }
    @end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-05T05:41:13.003

您需要避免为要设置动画的属性自定义 getter 和 setter。

覆盖`didChangeValueForKey:`方法。使用它来设置要设置动画的属性的模型值。

不要在动作动画上设置 toValue。

```
@interface MyLayer: CALayer

    @property ( nonatomic ) NSUInteger state;

@end 
```

-

```
@implementation MyLayer

@dynamic state;

- (id<CAAction>)actionForKey: (NSString *)key {

    if( [key isEqualToString: @"state"] )
    {
        CABasicAnimation * bgAnimation = [CABasicAnimation animationWithKeyPath: @"backgroundColor"];
        bgAnimation.fromValue = [self.presentationLayer backgroundColor];
        bgAnimation.duration  = 0.4;

        return bgAnimation;
    }

    return [super actionForKey: key];
}

- (void)didChangeValueForKey: (NSString *)key {

    if( [key isEqualToString: @"state"] )
    {
        const NSUInteger state = [self valueForKey: key];
        UIColor * newBackgroundColor;

        switch (state) 
        {
            case 0: 
                newBackgroundColor = [UIColor redColor]; 
                break;

            case 1: 
                newBackgroundColor = [UIColor blueColor]; 
                break;

            case 2: 
                newBackgroundColor = [UIColor greenColor]; 
                break;

            default: 
                newBackgroundColor = [UIColor purpleColor]; 
        }

        self.backgroundColor = newBackgroundColor.CGColor;
    }

    [super didChangeValueForKey: key];
}

@end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-01T04:53:57.080

Core Animation`actionForKey:`在更新属性值之前调用。它在通过发送更新属性值后运行该操作`runActionForKey:object:arguments:`。执行`CAAnimation`只是`runActionForKey:object:arguments:`调用`[object addAnimation:self forKey:key]`。

除了从 中返回动画`actionForKey:`，您还可以返回一个`CAAction`，它在运行时创建并安装动画。像这样的东西：

```
@interface MyAction: NSObject <CAAction>
@property (nonatomic, strong) id priorValue;
@end

@implementation MyAction

- (void)runActionForKey:(NSString *)key object:(id)anObject arguments:(NSDictionary *)dict {
    ERAnimatablePropertyLayer *layer = anObject;
    CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:key];
    id newValue = [layer valueForKey:key];
    // Set up animation using self.priorValue and newValue to determine
    // fromValue and toValue. You could use a CAKeyframeAnimation instead of
    // a CABasicAnimation.
    [layer addAnimation:animation forKey:key];
}

@end

@implementation ERAnimatablePropertyLayer

- (id <CAAction>)actionForKey:(NSString *)key {
    if ([key isEqualToString:@"myProperty"]) {
        MyAction *action = [[MyAction alloc] init];
        action.priorValue = [self valueForKey:key];
        return action;
    }
    return [super actionForKey:key];
} 
```

[您可以在此答案](https://stackoverflow.com/a/35714554/77567)中找到类似技术的工作示例（在 Swift 中，动画`cornerRadius`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T18:01:04.027

您可以将旧值和新值存储在 CATransaction 中。

```
-(void)setMyProperty:(float)value
{
    NSNumber *fromValue = [NSNumber numberWithFloat:myProperty];
    [CATransaction setValue:fromValue forKey:@"myPropertyFromValue"];

    myProperty = value;

    NSNumber *toValue = [NSNumber numberWithFloat:myProperty];
    [CATransaction setValue:toValue forKey:@"myPropertyToValue"];
}

- (id <CAAction>)actionForKey:(NSString *)key {
    if ([key isEqualToString:@"myProperty"]) {
        CABasicAnimation *theAnimation = [CABasicAnimation animationWithKeyPath:key];
        theAnimation.fromValue = [[self presentationLayer] valueForKey:key];
        theAnimation.toValue = [CATransaction objectForKey:@"myPropertyToValue"];

        // here you do something special.
    }

    return [super actionForKey:key];
} 
```

# configuration - PAC（代理自动配置）navigator.appName 不可用

> ID：10298909
> 
> 赞同：1
> 
> 时间：2012-04-24T13:30:10.943
> 
> 标签：configuration, proxy, pac

我已经有一个工作的 proxy.pac 文件。我希望客户根据他们的网络浏览器使用不同的代理服务器。

没问题，我想。那里有许多 java 脚本片段，用于检测浏览器名称/版本。

我发现的样本全部使用“navigator.appName”。如果我在常规网站上进行测试，那效果很好。当我将其放入我的 proxy.pac 时，它不起作用。导航器对象似乎不存在。

有没有人建议如何根据用户代理切换代理？

我的目标是，所有 IE6 都使用特定的代理，其余的只使用默认代理。

背景：IE6不支持Kerberos认证，默认代理上使用。因此，我使用 LDAP 身份验证设置了一个附加代理。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T11:27:11.160

也许人们可以发现的浏览器之间存在一些或多或少的细微 javascript 引擎差异，例如
`if (typeof(someIESpecificFunction) != "undefined")`
使用或使用 try 和 catch
或比较某些内置函数的结果以获得细微差异

[http://en.wikipedia.org/wiki/Comparison_of_layout_engines_(ECMAScript)](http://en.wikipedia.org/wiki/Comparison_of_layout_engines_%28ECMAScript%29)和[http://www.robertnyman.com/javascript/index.html](http://www.robertnyman.com/javascript/index.html)可能有助于开始？

更新：另一种特定于浏览器版本的行为：

来自[http://technet.microsoft.com/en-us/library/dd361918.aspx](http://technet.microsoft.com/en-us/library/dd361918.aspx)：

```
 function FindProxyForURL(url, host)
    {
        if(weekdayRange("WED", "SAT", "GMT"))
            return "PROXY proxy:80";
        else
            return "DIRECT";
    } 
```

*weekdayRange(<day1> [,<day2>] [,<GMT>] ) 函数返回当前系统时间是否在参数<day1>、<day2>和<GMT>指定的范围内。只有第一个参数是必需的。GMT 参数设置采用 GMT 而非本地时区的时间。*

*注意如果使用 <day1> == <day2> 调用该函数，则早期版本的 Internet Explorer 将产生与使用 Netscape Navigator 的结果不同的结果。具体来说，早期版本的 Internet Explorer 会将这一天范围解释为一整周，而 Internet Explorer 6 和 Netscape Navigator 将该范围解释为一天。**例如，如果当天是星期一，则调用 weekdayRange("TUE", "TUE") 在 Internet Explorer 的早期版本上返回 TRUE，在 Internet Explorer 6 和 Netscape Navigator 上返回 FALSE。***

**更新 2：**根据[http://blogs.msdn.com/b/wndp/archive/2006/07/18/ipv6-wpad-for-winhttp-and-wininet.aspx](http://blogs.msdn.com/b/wndp/archive/2006/07/18/ipv6-wpad-for-winhttp-and-wininet.aspx)应该能够区分 IE7 和旧版本IE 版本（其他浏览器可能支持也可能不支持这些扩展，例如这里提到的关于 Chrome：[http](http://code.google.com/p/pactester/issues/detail?id=9) ://code.google.com/p/pactester/issues/detail?id=9 ）

根据目前的信息，应该可以区分 IE 5.5、IE 6、IE 7、IE 8、IE 9？

如果您发现类似的有用信息，请告诉我们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-13T15:34:23.100

[您可以尝试通过条件编译](https://stackoverflow.com/questions/10072816/how-does-this-ie-check-work)检测 PAC 脚本中的`const ifIE = /*@cc_on!@*/false;`IE ：。
条件编译可能因新旧 IE/Edge 版本而异。

我没有对这个答案进行任何测试——请让我们知道它是否在评论中有效。

# sql - 使用 SQL Server 递归公用表表达式获取文件夹中所有文件的完整路径（带有子文件夹）

> ID：10298910
> 
> 赞同：4
> 
> 时间：2012-04-24T13:30:13.153
> 
> 标签：sql, sql-server, recursion, common-table-expression

有一个名为 的 SQL Server 未记录的扩展存储过程`xp_dirtree`，它可以以表格格式返回所有文件和文件夹名称（包括子文件夹）。为了练习我对递归 CTE 的理解，我决定使用它来获取指定文件夹（包括子文件夹）中所有文件的完整路径。但是，经过一个小时的挠头，我仍然无法弄清楚正确的方法。以下代码是我目前所拥有的。这个目的可以用递归 CTE 来实现吗？

```
DECLARE @dir NVARCHAR(260) ;
SELECT  @dir = N'c:\temp' ;

IF RIGHT(@dir, 1) <> '\' 
    SELECT  @dir = @dir + '\' ;

IF OBJECT_ID('tempdb..#dirtree', 'U') IS NOT NULL 
    DROP TABLE #dirtree ;
CREATE TABLE #dirtree
(
 id INT PRIMARY KEY
        IDENTITY,
 subdirectory NVARCHAR(260),
 depth INT,
 is_file BIT
) ;

INSERT  INTO #dirtree
        EXEC xp_dirtree 
            @dir,
            0,
            1 ;

SELECT  *
FROM    #dirtree ;

WITH    files
          AS (
              SELECT    id,
                        subdirectory,
                        depth,
                        is_file, subdirectory AS path
              FROM      #dirtree
              WHERE     is_file = 1
                        AND depth <> 1
   UNION ALL
               -- ...
             )
    SELECT  *
    FROM    files ; 
```

假设 xp_dirtree 输出为：

```
/*
id  subdirectory   depth   is_file
--- -------------- ------- -------
1   abc.mdf        1       1
2   a              1       0
3   a.txt          2       1
4   b.txt          2       1
5   a.rb           1       1
6   aaa.flv        1       1
*/ 
```

我想要的是：

```
/*
path
------------------
c:\temp\abc.mdf
c:\temp\a\a.txt
c:\temp\a\b.txt
c:\temp\a.rb
c:\temp\aaa.flv
*/ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:45:20.660

如果我理解你是正确的，你想要这样的东西：

**测试数据：**

```
CREATE TABLE #dirtree
(
    id INT,
    subdirectory NVARCHAR(260),
    depth INT ,
    is_file BIT,
    parentId INT
)

INSERT INTO #dirtree(id,subdirectory,depth,is_file)
VALUES
    (1,'abc.mdf',1,1),(2,'a',1,0),(3,'a.txt',2,1),
    (4,'b.txt',2,1),(5,'a.rb',1,1),(6,'aaa.flv',1,1) 
```

**更新了父 ID**

```
UPDATE #dirtree
SET ParentId = (SELECT MAX(Id) FROM #dirtree
      WHERE Depth = T1.Depth - 1 AND Id < T1.Id)
FROM #dirtree T1 
```

**询问**

```
;WITH CTE
AS
(
    SELECT
        t.id,
        t.subdirectory,
        t.depth,
        t.is_file
    FROM
        #dirtree AS t
    WHERE
        is_file=0
    UNION ALL
    SELECT
        t.id,
        CAST(CTE.subdirectory+'\'+t.subdirectory AS NVARCHAR(260)),
        t.depth,
        t.is_file
    FROM
        #dirtree AS t
        JOIN CTE
            ON CTE.id=t.parentId
    )
SELECT
    'c:\temp\'+CTE.subdirectory AS [path]
FROM
    CTE
WHERE
    CTE.is_file=1
UNION ALL
SELECT
    'c:\temp\'+t.subdirectory
FROM
    #dirtree AS t
WHERE
    is_file=1
    AND NOT EXISTS
    (
        SELECT
            NULL
        FROM
            CTE
        WHERE
            CTE.id=t.id
    ) 
```

**结果**

```
path
---------------
c:\temp\a\a.txt
c:\temp\a\b.txt
c:\temp\abc.mdf
c:\temp\a.rb
c:\temp\aaa.flv 
```

**编辑**

将示例中使用的表格更改为更像您问题中的表格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-06T21:12:46.160

```
/*
   traverse directory tree and get back complete list of filenames w/ their paths
*/

declare
   @dirRoot varchar(255)='\\yourdir' 

declare 
   @sqlCmd    varchar(255),
   @idx       int,
   @dirSearch varchar(255)

declare @directories table(directoryName varchar(255), depth int, isfile int, rootName varchar(255),rowid int identity(1,1))

insert into @directories(directoryName, depth,isFile)
exec master.sys.xp_dirtree @dirRoot,1,1

if not exists(select * from @directories)
   return

update @directories 
set rootName = @dirRoot + '\' + directoryName

-- traverse from root directory
select @idx=min(rowId) from @directories

-- forever always ends too soon 
while 1=1
begin

   select @dirSearch = rootName 
   from @directories 
   where rowid=@idx

   insert into @directories(directoryName, depth,isfile)
   exec master.sys.xp_dirtree @dirSearch,1,1

   update @directories
   set rootName = @dirSearch + '\' + directoryName
   where rootName is null

   set @idx = @idx + 1

   -- you see what i mean don't you?
   if @idx > (select max(rowid) from @directories) or @idx is null
      break

end

  select 
    case isFile when 0 then 'Directory' else 'File' end [attribute], 
    rootName [filePath]  
  from @directories
  order by filePath 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-04T23:23:39.010

差不多九年后，不幸的是，我所知道的没有开箱即用的解决方案。所以我仍在研究`xp_dirtree`并需要一个解决方案。

我尝试了 Arion 的答案，发现它正在产生结果。但是，对于超过 11K 对象的大型文件系统，它的运行速度非常慢。我看到它甚至从一开始就非常慢：

```
UPDATE #dirtree
SET ParentId = (SELECT MAX(Id) FROM #dirtree
      WHERE Depth = T1.Depth - 1 AND Id < T1.Id)
FROM #dirtree T1 
```

尽管这不是孤岛和差距问题，但它有一些相似之处，并且对这些问题的思考对我有所帮助。最后的代码是我的存储过程。这些部分对代码的作用有一些评论。

你会像这样使用它：

```
exec directory 
    @root = 'c:\somepath', 
    @depth = 3, 
    @outputTable = '##results';

select * from ##results; 
```

这导致输出如下：

```
+---------------------------------+------------+------------+-----------+--------+-----------+----------+
| path                            | name       | nameNoExt  | extension | isFile | runtimeId | parentId |
+---------------------------------+------------+------------+-----------+--------+-----------+----------+
| c:\somePath\DataMovers          | DataMovers | DataMovers | NULL      | 0      | 4854      | NULL     |
| c:\somePath\DataMovers\main.ps1 | main.ps1   | main       | ps1       | 1      | 4859      | 4854     |
+---------------------------------+------------+------------+-----------+--------+-----------+----------+ 
```

我必须以这种方式构建它，因为在内部它需要 xp_dirtree 输出并将其加载到临时表中。由于禁止嵌套的 insert-exec 语句，这阻止了获取 proc 的结果并将它们加载到 proc 之外的表中的能力。不要将 @outputTable 暴露给不受信任的用户，因为它容易受到 sql 注入的影响。当然，重新处理 proc 以避免这种情况，但它可以满足您的需求。

```
/*

    Summary:        Lists file directory contents.

    Remarks:        - stackoverflow.com/q/10298910
                    - This assumes that the tree is put in order where 
                      subfolders are listed right under their parent
                      folders.  If this changes in the future, a 
                      different logic will need to be implemented.

    Example:        exec directory 'c:\somepath', 3, '##results';
                    select * from ##results;

*/
create procedure directory
    @root nvarchar(255),
    @depth int,
    @outputTable sysname
as

-- initializations

    if @outputTable is null or not (left(@outputTable,2) = '##') or charindex(' ', @outputTable) > 0
        throw 50000, '@outputTable must be a global temp table with no spaces in the name.', 1;

    if exists (select 0 from tempdb.information_schema.tables where table_name = @outputTable) 
    begin
        declare @msg nvarchar(255) = '''tempdb.dbo.' + @outputTable + ''' already exists.'; 
        throw 50000, @msg, 1;
    end

-- fetch the tree (it doesn't have full path names)

    drop table if exists #dir;

    create table #dir (
        id int identity(1,1),
        parentId int null,
        path nvarchar(4000),
        depth int,
        isFile bit,
        isLeader int default(0),
        groupId int
    )

    insert      #dir (path, depth, isFile)
    exec        xp_dirtree @root, @depth, 1;

-- identify the group leaders (based on a change in depth)

    update  d
    set     isLeader = _isLeader
    from    (
                select  id, 
                        isLeader, 
                        _isLeader = iif(depth - lag(depth) over(order by id) = 0, 0, 1)
                from    #dir
            ) d;

-- find the parents for each leader (subsetting just for leaders improves efficiency)

    update      #dir
    set         parentId = (
                    select  max(sub.id) 
                    from    #dir sub
                    where   sub.depth = d.depth - 1 
                    and     sub.id < d.id
                    and     d.isLeader = 1
                )
    from        #dir d
    where       d.isLeader = 1;

-- assign an identifier to each group (groups being objects that are 'siblings' of the leader)

    update      d
    set         groupId = _groupId 
    from        (
                    select      *, _groupId = sum(isLeader) over(order by id)
                    from        #dir 
                ) d;

-- set the parent id for each item based on the leader's parent id

    update      d
    set         d.parentId = leads.parentId 
    from        #dir d
    join        #dir leads 
                    on d.groupId = leads.groupId 
                    and leads.parentId is not null;

-- convert the path names to full path names and calculate path parts

    drop table if exists #pathBuilderResults;

    with pathBuilder as (

        select      id, parentId, origId = id, path, pseudoDepth = depth 
        from        #dir 

        union all
        select      par.id, 
                    par.parentId,
                    pb.origId,
                    path = par.path + '\' + pb.path,
                    pseudoDepth = pb.pseudoDepth - 1
        from        pathBuilder pb
        join        #dir par on pb.parentId = par.id
        where       pb.pseudoDepth >= 2 

    )

    select      path = @root + '\' + pb.path,
                name = d.path,
                nameNoExt = iif(ext.value is null, d.path, left(d.path, len(d.path) - len(ext.value) - 1)),
                extension = ext.value,
                d.isFile,
                runtimeId = pb.origId,
                parentId = d.parentId
    into        #pathBuilderResults
    from        pathBuilder pb
    join        #dir d on pb.origId = d.id
    cross apply (select value = charindex('.', d.path)) dotPos
    cross apply (select value = right(d.path, len(d.path) - dotPos.value)) pseudoExt 
    cross apply (select value = iif(d.isFile = 1 and dotPos.value > 0, pseudoExt.value, null)) ext
    where       pb.pseudoDepth = 1
    order by    pb.origId;

-- terminate

    declare @sql nvarchar(max) = 'select * into ' + @outputTable + ' from #pathBuilderResults';
    exec (@sql); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2018-11-14T19:44:40.353

创建并使用 sp_dirtree @Path = 'c:\', @FileOnly = 1

```
 create or alter proc sp_dirtree
       @Path      nvarchar(4000) 
     , @Depth     int = 0
     , @FileOnly  bit = 0
    as -- Dir tree with fullpath. sergkog 2018-11-14
      set nocount on
      declare @Sep nchar(1) = iif(patindex('%/%',@Path) > 0,'/','\') -- windows or posix
      set @Path += iif(right(@Path,1) <> @Sep, @Sep,'')

    declare @dirtree table(
        Id int identity(1,1) 
      , subdirectory nvarchar(4000) not null
      , depth    int  not null
      , is_file  bit  not null
      , parentId int  null
    )

    insert @dirtree(subdirectory, depth, is_file)
    exec xp_dirtree @Path, @Depth, 1

    update @dirtree
       set ParentId = (select max(id) from @dirtree where Depth = t1.Depth - 1 and Id < t1.Id)
      from @dirtree t1

    ;with cte as(
      select t.*
      from @dirtree t
      where is_file=0
     union all
      select t.id
           , convert(nvarchar(4000), cte.subdirectory+ @Sep + t.subdirectory)
           , t.depth
           , t.is_file
           , t.parentId
      from
        @dirtree t join cte on cte.id = t.parentId
     )
     select @Path + cte.subdirectory as FullPath
          , cte.is_file as IsFile
     from cte
     where cte.is_file = iif(@FileOnly = 1, 1,cte.is_file)
     union all
     select @Path + t.subdirectory
          , t.is_file
     from @dirtree t    
     where
        t.is_file = iif(@FileOnly = 1, 1,t.is_file)
        and not exists(select null from cte 
                       where cte.id=t.id
        )
    order by FullPath, IsFile
    go 
```

# android - 后台应用程序扫描到活动文本框？

> ID：10298911
> 
> 赞同：-1
> 
> 时间：2012-04-24T13:30:13.160
> 
> 标签：android, iphone, smartphone

我正在寻找一款适用于手机（iPhone、Android 和 SmartPhone - 任何或所有）的应用程序，它可以简单地在后台运行并将任何扫描的 upc 代码数字放入当前活动的文本框中。

我用谷歌搜索了很长时间，只找到了一个真正取代手机键盘的 Android 应用程序。

看起来应该很容易（我有很多用于 PC），但自 Windows CE 时代以来我没有做过任何手持编程，所以我不知道这是否可能（应用程序可以看到这些手机中的其他应用程序控件）。

有没有人遇到过这样的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:38:06.103

您不能在整个系统范围内执行此操作。您只能将此功能添加到您的应用程序中。

这个问题很相似 看看。[Android 长按编辑文本行为](https://stackoverflow.com/q/4181309/857361)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T14:10:17.780

使用 zbar 中的 iphone sdk，您可以在您的应用程序中执行此操作。

# php - 包含带有 preg_quote 的命名子模式的转义字符串

> ID：10298914
> 
> 赞同：0
> 
> 时间：2012-04-24T13:30:21.640
> 
> 标签：php, regex

有没有办法使用`preg_quote`和忽略要转义的命名子模式？例如 ：

`/login/?next=(?P<next_url>.*)`

会逃到

`\/login\/\?next\=(?P<next_url>.*)`

代替

`\/login\/\?next\=\(\?P\<next_url\>\.\*\)`

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T17:46:37.890

您可以在单独的部分中构建正则表达式，以便仅`preg_quote`生成所需的表达式部分。

例如：

```
$pattern = preg_quote('\/login\/?next=').'(?P<next_url>.*)'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T12:03:11.457

我通过实现自己的功能提出了一种解决方法：

```
protected function escapeUrlPattern($pattern) {
    $chars = array('/', '=', '-', '.', '\\', '+', '*', '?', '^', '$', '{', '}', '!', '<', '>', '|', ':',);
    $patternChars = str_split($pattern);
    $idle = false;
    $escapedPattern = "";
    foreach ($patternChars as $char) {
        if ($char == "(" || $char == "[")
            $idle = true;

        if (!$idle && in_array($char, $chars))
            $char = "\\" . $char;

        $escapedPattern .= $char;

        if ($char == ")" || $char == "]")
            $idle = false;
    }
    return $escapedPattern;
} 
```

`

# ruby-on-rails - 如何将数据从 javascript 的 canvas.toDataURL 保存到 ruby 中的图像文件？

> ID：10298915
> 
> 赞同：6
> 
> 时间：2012-04-24T13:30:22.303
> 
> 标签：ruby-on-rails, ruby, save-image

如何将数据从 javascript 的 canvas.toDataURL 保存到 ruby​​ 中的图像文件？

下面的示例代码创建了图像，但给出了一个错误，指出格式无法识别或损坏

```
require 'base64'
chart1 = params[:chart1].split(',')
image = Base64.decode64(chart1[1])

File.open("#{Rails.root}/test.png", 'wb') do|f|
  f.write(image)
end 
```

谢谢！

**注意：已编辑。现在可以正常工作了**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T07:11:09.303

复制评论中的答案，以便从“未回答”过滤器中删除此问题：

[p0rter](https://stackoverflow.com/users/1228509/p0rter)注意到：

> 为什么你必须调用 Base64.decode64 两次？

[steamboy](https://stackoverflow.com/users/282360/steamboy)承认：

> @p0rter 不错。它现在正在工作。tnx

# javascript - 将鼠标悬停在 div 的嵌套项上

> ID：10298918
> 
> 赞同：2
> 
> 时间：2012-04-24T13:30:32.273
> 
> 标签：javascript, jquery, html

在 JQUERY 中，我试图创建一个简单的叠加层，当您将**鼠标悬停**在`content1`它上面时，它会消失并`content2`出现。然后你将鼠标**移出**`content2`并`content1`重新出现。

这工作正常，除了`content2`当`annoyingdiv`鼠标移动到`annoyingdiv`mouseout**事件**触发器时。我该如何解决这个问题？或者这是如何解决的？

**HTML**

```
<div class="content1">blah blah</div>

<div class="content2">
    <div class="annoyingdiv">
        blah blah
    </div>
</div> 
```

**jQuery javascript**

```
 $(function () {

    $('.content1').hover(function () {

        $(".content2").css("display", "block");
        $(this).css("display", "none");

    });

    $('.content2').mouseout(function () {

        $(".content1").css("display", "block");
        $(this).css("display", "none");
    });

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:32:52.283

使用[`mouseleave`事件](http://api.jquery.com/mouseleave/)而不是`mouseout`事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:35:06.690

使用 CSS。

证明：http: [//jsfiddle.net/iambriansreed/vaQTU/](http://jsfiddle.net/iambriansreed/vaQTU/)

HTML：

```
<div class="parent">
    <div class="content1">blah blah content1</div>

    <div class="content2">
        <div class="annoyingdiv">
            blah blah annoyingdiv
        </div>
    </div>
</div> 
```

CSS：

```
.parent .content2 {
    display: none;
}
.parent:hover .content1 {
    display: none;
}
.parent:hover .content2 {
    display: block;
}​​​ 
```

# database - Get the region name in maxmind database

> ID：10298922
> 
> 赞同：8
> 
> 时间：2012-04-24T13:30:42.890
> 
> 标签：database, attributes

I have downloaded a database cities

```
`Country`  `City`        `AccentCity`  `Region`  `Population`  `Latitude`  `Longitude`
af     amir kalay       Amir Kalay      16        0             34.6333     70.3333 
ad     aixas            Aixas           06        0             42.4833     1.4667 
and lot more records 
```

I have downloaded another database called fips_10_4 to show the state of the city

```
country,Region,State
AD,02,"Canillo"
AD,03,"Encamp"
AD,04,"La Massana"
AD,05,"Ordino"
AD,06,"Sant Julia de Loria"
AD,07,"Andorra la Vella"
AD,08,"Escaldes-Engordany"
AE,01,"Abu Dhabi" 
```

Now if you are thinking that Iam asking for some sql query then you are wrong. Everything was working fine but then I came to know that the file i downloaded from
[Maxmind website](http://www.maxmind.com/app/fips_include) is incomplete as 'fips_10_4' has no record for country 'af' and region '16' .May anybody help me to deal this problem and tell me the correct place to download this complete file

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-28T21:14:29.613

FIPS 10-4 has changed. The list of changes can be found [here](http://efele.net/maps/fips-10/data/).

In particular, AF16 (Laghman) has changed to AF35\. MaxMind uses the new list.

If you need both the old and the new codes, you can find them [here](http://efele.net/maps/fips-10/data/fips-all.txt). You can parse the contents of the file, and replace your database table with the information found there.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-29T20:47:09.457

AF is the two digit ISO code (IS0-3166-2) for Afghanistan, which ISO are currently trying to sell for the frankly astonishing sum of CHF 244 (Swiss Francs).

As [Teleo says](https://stackoverflow.com/a/10790475/458741) FIPS 10-4 has changed as detailed on the [ITL website](http://www.itl.nist.gov/fipspubs/fip10-4.htm) and the link Teleo has given provides the data in a more usable format. [MaxMind also provides it](http://www.maxmind.com/fips10-4.csv) in a better format.

I would be *extremely* wary about using this. Both MaxMind & Teleo's link are being provided, for free, by an external company/person that has no particular interest in keeping their data up-to-date. I notice, for instance, that the following *countries* are missing:

*   South Sudan
*   Sint Martaan (Dutch Part)
*   Bonaire, Sint Eustatius and Saba
*   Curaçao

The last three were part of the Netherlands Antilles, which was dissolved on 10th October 2010\. Incidentally, the Netherlands Antilles, which hasn't existed for a year and a half, is still on this file.

The reason for all of this? FIPS 10-4 was [*withdrawn* almost a decade ago](http://www.itl.nist.gov/fipspubs/withdraw.htm) on 8th September 2002\. To quote the ITS website (my emphasis):

> “For a replacement to FIPS 10-4, INCITS L1 is coordinating with other standards developers and interested parties to determine whether processing a draft proposed American National Standard or *adopting an ISO standard* would be the better way forward. For more information on the status of this activity, contact Rick Pearsall (Richard.A.Pearsall@nga.mil).”</p>

A quick Google brings the news the INCITS L1 is [next meeting on the 12th June 2012](https://standards.incits.org/apps/group_public/workgroup.php?wg_abbrev=l1). I wouldn't hold your breath.

Another reason not to use FIPS is that it is unlikely to be used much outside of the USA (obviously some people will still use it). While this may not matter immediately I would future proof your systems as a matter of course.

I would highly recommend using the ISO 3166 standard. It is a globally recognised way of categorising country data.

The [CommonDataHub](http://www.commondatahub.com/live/geography/state_province_region/iso_3166_2_state_codes) maintains a great version, which includes country and state in the same manner as FIPS 10-4\. They also have other [ISO states databases](http://www.commondatahub.com/state_source.jsp), which are more normalised and worth investigating.

It also maintains a [list of all cities](http://www.commondatahub.com/live/geography/city/cities_all_countries) with a population greater than 5,000.

[ISO maintain a copy](http://www.iso.org/iso/country_codes/iso_3166_code_lists/country_names_and_code_elements.htm) on their website of the 3166-2 standard, which will take a bit of coding to ensure it's you're always updated at least you'll be sure it's correct. [Wikipedia](http://en.wikipedia.org/wiki/ISO_3166-1) is also surprisingly good at keeping up-to-date. It beat CommonDataHub by a month when South Sudan was created, due to problems telling people that the data existed.

There are other places out there where this data exists, this just details what I use.

If you want to avoid databases all-together then the [Yahoo! PlaceFinder API](http://developer.yahoo.com/geo/placefinder/) is a good place to start. It has some [documented](https://meta.stackexchange.com/questions/90034/the-netherlands-antilles-do-not-exist-anymore) [problems](https://meta.stackexchange.com/questions/126379/south-sudan-becomes-augusta-ga-usa-in-list-of-places-willing-to-relocate-to/126383#126383) keeping up-to-date but at least there's a place where [you can tell them they've got it wrong](http://developer.yahoo.com/forum/PlaceFinder-Enhancement-Requests/Netherlands-Antilles-do-not-exist-anymore/1304685853000-e38c5308-8736-39f5-a528-43639fc3e92e).

### tl;dr

Don't use FIPS, it was withdrawn a decade ago. Use the globally recognised ISO standard instead.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-29T19:16:59.943

I am not sure what is your true goal, but [here](http://www.geodatasource.com/world-cities-database/free) is a great resource of countries and cities and all...

# scala - Scala中的“未经检查的类型模式”警告？

> ID：10298926
> 
> 赞同：6
> 
> 时间：2012-04-24T13:30:50.677
> 
> 标签：scala, compiler-warnings, type-erasure

假设我有一张地图`m: Map[Any, Int]`。现在我只想从中获取条目`(String, Int)`并使用这些条目`m`创建一个新地图。`m1: Map[String, Int]`

我正在尝试执行以下操作：

```
val m1: Map[String, Int] = m collect {case e:(String, Int) => e}
```

它似乎有效，但我收到警告：*类型模式 (String, Int) 中的非变量类型参数 String 未选中，因为它已被擦除消除*。

我怎样才能摆脱警告？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T13:46:32.387

你可能想要：

```
val m1: Map[String, Int] = m collect {case (k:String, v:Int) => k->v} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T13:46:48.577

（仅供参考。你想要的是[virtualeyes的答案](https://stackoverflow.com/a/10299218/200266)。）

```
val m1: Map[String, Int] = m flatMap { e =>
  e._1 match {
    case e1: String => Some(e1 -> e._2)
    case _ => None
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T19:50:59.313

仔细测试将显示您的解决方案实际上匹配地图中的所有内容，而不仅仅是类型 (String,Int) 的条目。来自编译器的警告告诉您匹配的类型将在运行时被丢弃，因此您的代码实际上正在执行以下操作：

`val m1: Map[String, Int] = m collect {case e:Tuple2[Any,Any] => e.asInstanceOf[Tuple2[String,Int]]}`

并且 asInstanceOf 调用不会崩溃，因为它只转换为 Tuple2 并且 (String,Int) 位由于擦除而再次丢失。但是，当您尝试对结果进行迭代时，您会遇到严重的失败...

在 REPL 中试试这个

```
 val m:Map[String,Int] = Map("2" -> 3, 3 -> 4, "6" -> 10) collect {case e:(String, Int) => e}
  // Oops, thought we would get '2'
  m size 
  // Nothing wrong with this code except m contains some
  // hidden nasties which causes us to blow up
  for ((s:String, i:Int) <- m) yield s.length + i 
```

`

# load-balancing - 负载均衡服务器

> ID：10298936
> 
> 赞同：-2
> 
> 时间：2012-04-24T13:31:17.140
> 
> 标签：load-balancing

我想了解负载平衡服务器。

我有一个具有负载平衡服务器的应用程序。当我对数据进行一些更改时，在我的应用程序中它是如何生效的？另外，当我们重新启动应用程序时，负载平衡服务器发生的所有步骤是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:45:28.897

好吧，负载均衡器与应用程序代码是分开的，基本上它只是将请求路由到处理实际要求。因此，要更新应用程序（即 java servlet、JSP、PHP 页面、静态 HTML 页面、图像等），必须更新所有下游服务器。至于数据（即文章、用户数据库等），通常会存储在所有下游服务器连接到的数据库中

至于重新启动应用程序，当您在每个下游服务器上执行此操作时，它将暂时无法为请求提供服务，因此负载均衡器在尝试将请求发送到应用程序的服务器时会出现“无法连接”问题重新启动，然后将尝试将请求发送到下游服务器列表中的下一个服务器。根据负载均衡器的设置方式，它将自动重试向先前重新启动的服务器发送新请求，并且当重新启动的下游服务器再次启动时，它将再次为请求提供服务。因此，要更新应用程序，您基本上只需同时更新一个下游服务器，因为其他服务器在重新启动时会接管负载，因此不会停机，客户端也不会更明智

这是硬件设备还是在运行 HAProxy/nginx/other 的服务器上？

# c# - Json编码和解码

> ID：10298937
> 
> 赞同：0
> 
> 时间：2012-04-24T13:31:20.170
> 
> 标签：c#, json, encoding, decoding

我正在编写的应用程序中使用 HTTP Post。我在那篇文章中传递了富文本字段值。我已经尝试使用 url 和 html 编码/解码来传递这个 html 文本，但我在解码后显示的结果没有保持格式和样式。我尝试了各种建议，但我一无所获。什么是编码解码的最佳方式，任何代码示例都值得赞赏。

谢谢

**我在下面发布数据。**

许多业内人士用不讨人喜欢的措辞描述了 Ed Crane 领导下的 Cato 文化。\n\n《国家评论》的史蒂文·海沃德最近表示，“相比之下，我还可以看到克兰如何让史蒂夫·乔布斯看起来温暖可爱（我怀疑 Ed 会认为这是一种恭维）。” \n\nRed State 的埃里克·埃里克森（Erick Erickson）更直截了当地描述了克瑞恩在卡托股东协议争议中的行为，称克瑞恩的行为“令人震惊”并且“坦率地说相当被宠坏了”。埃里克森总结道：“如果卡托要死，那将是因为埃德·克兰的领导。” \n\n福布斯作家约翰·塔姆尼（John Tamny）在赞扬埃德·克兰（Ed Crane）的同时承认：“卡托顽皮、暴躁和非常尖锐的文化是经营者的功劳……。卡托活动的气氛可能与在其他智囊团聚会上看到的完全不同。” \n\n在最近的事态发展中，也许是受到激烈的股东纠纷的鼓舞，这个自由主义智库金标准的前工作人员积极挺身而出，描绘了 Ed Crane 领导下的 Cato 工作环境令人不安的画面——这表明它至少在他们看来，这是对女性的敌意和侮辱。\n\n“这几乎不是你想让你的女儿工作或实习的环境，”一位前卡托员工在接受 Breitbart News 采访时说。“卡托的大多数学者都是优秀、正派、真诚的人。但埃德·克兰对女性不屑一顾和有辱人格的态度会让她们觉得自己更像是肉而不是平等。” \n\n“我认为，在卡托内部，最有吸引力的女性专业工作人员已经成为 Ed Crane 主动性挑逗的目标，这是相当公开的知识，”另一位前卡托员工告诉 Breitbart 新闻。当被问及为什么会容忍这种行为时，这位曾任职于卡托的员工回答说：“在一个没有正式的补救制度的地方，会产生一种自满的态度，‘哦，那只是埃德。’ 或者“他可能喝多了。”\n\n媒体关系总监克里斯·肯尼迪通过电子邮件联系以征求意见，他回答说：“如果有人想引用任何对 Ed 或卡托管理层其他成员提出的实际法律投诉，我们会回应他们。但我们不会回应来自未具名消息来源的毫无根据的谣言和影射。\" \n\n当然，这些都是令人震惊的指控（类似的指控可以追溯到很久以前）。卡托对自由主义运动至关重要，董事会有责任对他们进行全面审查。如果准确的话，他们会提出严重的问题，即卡托首席领导人的行为如何以及为什么会被这么多人容忍这么长时间。\n\n一位前卡托员工说，部分解释是，与其他智库不同，“卡托没有真正的禀赋”；其庞大的运营预算很大程度上取决于 Crane 每年筹集数百万美元的能力。\n\n“每个人的薪水都取决于 Ed Crane 赚取收入的能力，”前卡托员工解释说。“这意味着人们容忍 Ed 的行为，而 Ed 永远不会容忍其他人的行为。” \n\n与最接近卡托文化的人交谈时，给人的感觉是拥有独裁权力的领导者之一。正如一位前卡托工作人员所解释的那样，“卡托派的绞刑架式幽默认为，卡托真正代表的是：'起重机和其他人'。” \n\n***注意：除了和之外这些关于 Ed Crane 行为的指控，经济政策杂志的 Robert Wenzel 最近的一篇博客文章提到了“卡托高级官员”对严重不当行为的指控。Lew Rockwell 也对这些指控发表了评论。Breitbart News 目前无法核实 Wenzel 先生的指控是否准确，或者他所指的“卡托高级官员”的身份。” “卡托派的绞刑式幽默认为，卡托真正代表的是：'Crane And The Others'。” \n\n***注意：除了对 Ed Crane 行为的这些指控之外，最近的一个《经济政策杂志》的 Robert Wenzel 的博客文章提到了“卡托高级官员”对严重不当行为的指控。Lew Rockwell 也对这些指控发表了评论。Breitbart News 目前无法核实 Wenzel 先生的指控是否准确，或者他所指的“卡托高级官员”的身份。” “卡托派的绞刑式幽默认为，卡托真正代表的是：'Crane And The Others'。” \n\n***注意：除了对 Ed Crane 行为的这些指控之外，最近的一个《经济政策杂志》的 Robert Wenzel 的博客文章提到了“卡托高级官员”对严重不当行为的指控。Lew Rockwell 也对这些指控发表了评论。Breitbart News 目前无法核实 Wenzel 先生的指控是否准确，或者他所指的“卡托高级官员”的身份。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:40:07.453

JSON.NET 是使用 JSON 的最佳库。我从那里使用了编码和解码功能，它完美无缺。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T13:37:21.250

您可以使用 base64 编码和解码。

# mysql - MySQL 慢查询和 memcached

> ID：10298938
> 
> 赞同：2
> 
> 时间：2012-04-24T13:31:24.450
> 
> 标签：mysql, performance, memcached

我用 memcached 缓存了慢查询，它工作得很好，但有时我们在 mysql 中遇到很多慢查询，好像 memcached 已经停止，然后我们的网站就关闭了。

慢查询图：http: [//i.imgur.com/ReyWe.png](http://i.imgur.com/ReyWe.png)

此时我们在 30 秒内收到了大约 100 个慢查询。会是什么？我们的查询：

```
# Query_time: 5.942602  Lock_time: 0.010214 Rows_sent: 10000  Rows_examined: 493139  

SET timestamp=1335194149;  
SELECT story_id FROM dug_stories d WHERE d.story_is_permanent=0  AND  
                       (  
                        (d.story_time>1335190543 AND (d.story_pluses-d.story_minuses) > 5)  
                        OR  
                        ( ( (d.story_pluses-d.story_minuses) > 12 OR (d.story_pluses >= 10 AND d.story_minuses<=0) )  AND d.story_cat!=48 AND d.st  
ory_cat!=131 AND d.story_cat!=55 AND d.story_cat!=44 AND d.story_cat!=126 AND d.story_cat!=53 AND d.story_cat!=370 AND d.story_cat!=381 AND d.stor  
y_cat!=304 AND d.story_cat!=497)  OR (d.story_cat=48 AND (d.story_pluses-d.story_minuses) > 9) OR (d.story_cat=131 AND (d.story_pluses-d.story_min  
uses) > 8) OR (d.story_cat=55 AND (d.story_pluses-d.story_minuses) > 8) OR (d.story_cat=44 AND (d.story_pluses-d.story_minuses) > 9) OR (d.story_c  
at=126 AND (d.story_pluses-d.story_minuses) > 13) OR (d.story_cat=53 AND (d.story_pluses-d.story_minuses) > 8) OR (d.story_cat=370 AND (d.story_pl  
uses-d.story_minuses) > 8) OR (d.story_cat=381 AND (d.story_pluses-d.story_minuses) > 8) OR (d.story_cat=304 AND (d.story_pluses-d.story_minuses)  
> 8) OR (d.story_cat=497 AND (d.story_pluses-d.story_minuses) > 9)  
                       )  
                       ORDER BY d.story_rating DESC, d.story_time DESC LIMIT 0, 10000; 
```

**稍微调整了查询​​（而不是所有 != 类别，我更改为 NOT Category IN （要排除的类别列表），但格式化以便于阅读...另外，请注意，查询中甚至没有使用 SET TIMESTAMP 变量...这是一个硬编码的值。**

```
SET timestamp=1335194149;  
SELECT 
      story_id 
   FROM 
      dug_stories d 
   WHERE 
          d.story_is_permanent = 0  
      AND (     ( d.story_time > 1335190543 AND d.story_pluses - d.story_minuses > 5 )  
             OR (    (    d.story_pluses - d.story_minuses > 12 
                       OR (   d.story_pluses >= 10 AND d.story_minuses <= 0 ) 
                     )  
                  AND NOT d.story_cat IN ( 44, 48, 53, 55, 126, 131, 304, 370, 381, 497 )
                )
             OR ( d.story_cat = 44  AND d.story_pluses - d.story_minuses > 9 ) 
             OR ( d.story_cat = 48  AND d.story_pluses - d.story_minuses > 9 ) 
             OR ( d.story_cat = 53  AND d.story_pluses - d.story_minuses > 8 ) 
             OR ( d.story_cat = 55  AND d.story_pluses - d.story_minuses > 8 ) 
             OR ( d.story_cat = 126 AND d.story_pluses - d.story_minuses > 13 ) 
             OR ( d.story_cat = 131 AND d.story_pluses - d.story_minuses > 8 ) 
             OR ( d.story_cat = 304 AND d.story_pluses - d.story_minuses > 8 ) 
             OR ( d.story_cat = 370 AND d.story_pluses - d.story_minuses > 8 ) 
             OR ( d.story_cat = 381 AND d.story_pluses - d.story_minuses > 8 ) 
             OR ( d.story_cat = 497 AND d.story_pluses - d.story_minuses > 9 )  
          )  
   ORDER BY 
      d.story_rating DESC, 
      d.story_time DESC 
   LIMIT 
      0, 10000; 
```

非常感谢您的帮助！对不起我糟糕的英语:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:03:38.577

除了调整查询以提高可读性之外，我还会尝试对查询进行更多重组。
我会确保您对（ Story_Is_Permanent、Story_Cat、Story_Time ）有一个索引

我假设您有一个带有文字描述的“故事类别”表，用于向用户展示。由于您无论如何都在查询所有类别，但仅基于您想要包含或排除的某些类别......如果包含，它仅基于该类别的 PLUSES 与 MINUSES 的净计数。我会添加到该类别表的列......类似

```
DefaultToInclude   integer as 1 or 0
PlusMinusNetCount  integer 
```

然后，加入类别表并简化查询，例如

```
SELECT 
      story_id 
   FROM 
      dug_stories d
         JOIN YourCategories YC
            on d.story_cat = YC.categoryID
   WHERE 
          d.story_is_permanent = 0  
      AND (     ( d.story_time > 1335190543 AND d.story_pluses - d.story_minuses > 5 )  
             OR (     YC.DefaultToInclude = 0 
                  AND (    d.story_pluses - d.story_minuses > 12 
                       OR (d.story_pluses >= 10 AND d.story_minuses <= 0 ) 
                      )  
                )
             OR (     YC.DefaultToInclude = 1 
                  AND d.story_pluses-d.story_minuses > YC.PlusMinusNetCount )
          )
 ORDER BY 
      d.story_rating DESC, 
      d.story_time DESC 
   LIMIT 
      0, 10000; 
```

**这**

```
(     YC.DefaultToInclude = 0 
  AND (    d.story_pluses - d.story_minuses > 12 
        OR (d.story_pluses >= 10 AND d.story_minuses <= 0 ) 
      )  
) 
```

**最终将取代**

```
OR (    (    d.story_pluses - d.story_minuses > 12 
          OR (   d.story_pluses >= 10 AND d.story_minuses <= 0 ) 
        )  
    AND d.story_cat!=48 
    AND d.story_cat!=131 
    AND d.story_cat!=55 
    AND d.story_cat!=44 
    AND d.story_cat!=126 
    AND d.story_cat!=53 
    AND d.story_cat!=370 
    AND d.story_cat!=381 
    AND d.story_cat!=304 
    AND d.story_cat!=497 
   ) 
```

**这**

```
 OR (     YC.DefaultToInclude = 1 
      AND d.story_pluses-d.story_minuses > YC.PlusMinusNetCount ) 
```

**然后将最终取代**

```
( OR ( d.story_cat = 44  AND d.story_pluses - d.story_minuses > 9 ) 
  OR ( d.story_cat = 48  AND d.story_pluses - d.story_minuses > 9 ) 
  OR ( d.story_cat = 53  AND d.story_pluses - d.story_minuses > 8 ) 
  OR ( d.story_cat = 55  AND d.story_pluses - d.story_minuses > 8 ) 
  OR ( d.story_cat = 126 AND d.story_pluses - d.story_minuses > 13 ) 
  OR ( d.story_cat = 131 AND d.story_pluses - d.story_minuses > 8 ) 
  OR ( d.story_cat = 304 AND d.story_pluses - d.story_minuses > 8 ) 
  OR ( d.story_cat = 370 AND d.story_pluses - d.story_minuses > 8 ) 
  OR ( d.story_cat = 381 AND d.story_pluses - d.story_minuses > 8 ) 
  OR ( d.story_cat = 497 AND d.story_pluses - d.story_minuses > 9 ) 
) 
```

这允许灵活地简单地包含/排除具有其各自“净”计数的另一个类别，而无需向您已经冗长的查询添加更多 OR / AND 条件。不管怎样，它似乎总是必须遍历整个“dug_Stories”表，因为您正在查看每个类别的一个条件和另一个类别。您的时间戳仅适用于 NOT EQUAL 类别，但您的其他条件没有任何时间戳限制（除非这是您的查询中的错误）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T14:03:20.340

如果 rows_examined 大于结果集，慢日志可能表明索引没有被充分利用。

理想情况下，MySQL 应该能够为 WHERE 子句中的所有过滤器表达式使用单个索引。由于所有嵌套的 AND 和 OR 以及对多列的引用，您的 WHERE 子句非常复杂。MySQL 可能无法利用索引来优化此查询，即使您有索引。

通常，这种类型的查询可以通过将其分成几个较小的查询来改进，每个查询都能够利用索引，然后使用`UNION`.

例如，如果我在 first_name 上有一个索引，在 last_name 上有一个索引，则以下查询：

```
SELECT *
FROM Users
WHERE active = true
  AND ((first_name = 'Marcus') OR (last_name = 'Adams')) 
```

可以这样改进：

```
SELECT *
FROM Users
WHERE active = true
  AND first_name = 'Marcus'
UNION
SELECT *
FROM Users
WHERE active = true
  AND last_name = 'Adams' 
```

在 LIMIT 子句中检查的行数多于 10000 行这一事实也表明 ORDER BY 子句可能正在使用文件排序，而不是查询已按顺序返回行。这使得 MySQL 可以完成所有工作，即使您只需要部分记录。您很可能需要使用一个覆盖索引来处理您的所有条件，这可能是不可能的，或者您需要删除 ORDER BY 子句，或者，如您所指出的，依靠缓存来挽救这一天。

查询时间是高负载服务器上性能不佳的衡量标准，因为任何查询在繁忙的服务器上都可能很慢。您应该使用`EXPLAIN`and`SHOW PROFILE`来分析您的查询并改进它们，以便它们不会给您的服务器带来过多的负载。

允许在服务器上运行太多线程会导致级联效应，使您的服务器停止运行。如果您使用的是 InnoDB，请确保您的[线程并发](http://www.mysqlperformanceblog.com/2006/06/05/innodb-thread-concurrency/)度不要太高。最好让每个人一次等待并服务 8 个线程（非常快），而不是尝试一次服务 100 个或无限线程（非常慢）。

# c# - 从字符串 C# 中删除点字符

> ID：10298940
> 
> 赞同：16
> 
> 时间：2012-04-24T13:31:25.980
> 
> 标签：c#

假设我有一个字符串“2.36”，我希望它修剪为“236”

我在示例中使用了修剪功能

```
String amount = "2.36";
String trimmedAmount = amount.Trim('.'); 
```

trimmedAmount 的值仍然是 2.36

当`amount.Trim('6');`它完美运行但使用“。”时

我做错了什么？

非常感谢 干杯

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-04-24T13:32:28.477

修剪是从字符串的开头或结尾删除字符。

您只是试图删除`.`，这可以通过将该字符[替换为空来完成：](http://msdn.microsoft.com/en-us/library/fk49wtc1.aspx)

```
string cleanAmount = amount.Replace(".", string.Empty); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-24T13:39:11.027

如果要删除除数字以外的所有内容：

```
String trimmedAmount = new String(amount.Where(Char.IsDigit).ToArray()); 
```

或者：

```
String trimmedAmount = Regex.Replace(amount, @"\D+", String.Empty); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-24T13:34:09.350

`String.Trim`删除前导和尾随空格。你需要使用`String.Replace()`

像：

```
string amount = "2.36"; 
string newAmount = amount.Replace(".", ""); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-24T13:34:15.067

两种方式：

```
string sRaw = "5.32";
string sClean = sRaw.Replace(".", ""); 
```

Trim 用于删除前导和尾随字符（例如默认情况下的空格）。

# asp.net-mvc-3 - MVC3 WebGrid 复选框

> ID：10298941
> 
> 赞同：0
> 
> 时间：2012-04-24T13:31:32.973
> 
> 标签：asp.net-mvc-3, checkbox, webgrid

我正在尝试将复选框添加到 Web 网格上的列中，并且我发现使用 Html.CheckBox 来渲染它很难。如果我使用 input type="checkbox" 它会呈现，但我似乎无法将值保存在视图模型中。

我有一个相当复杂的视图，它有两个 webGrid，你选择一个中的项目移动到另一个，当移动到 grid1 时，如果你愿意，你可以在每一行上选中一个框。一切正常，除了我无法保存复选框的值。

具有复选框的网格的代码如下所示：

```
var grid1 = new WebGrid(source: Model.FieldsInTemplate, canSort: false, defaultSort:"FieldName");

    @grid1.GetHtml(headerStyle:"gridGroupRow", tableStyle: "gridGroup", rowStyle: "gridRow", alternatingRowStyle: "gridRowAlt", columns: grid1.Columns(
        grid1.Column("FieldName", "Field Name"),
        grid1.Column(header: "Required", format: @<text><input name="IsRequired" type="checkbox" value="@item.IsRequired" /></text>),
        grid1.Column(format: (item) => new HtmlString("<a href='#' id='test' onclick='updateTemplate(false," + item.FieldId.ToString() + ");'>Remove</a>"))
             )) 
```

因此，使用上述方法，网格呈现一个复选框，但在提交时实体始终为 false。该视图使用以下视图模型：

```
public class TemplateFieldInteractViewModel
{
    public IList<MetadataTemplateFieldInstanceDisplayViewModel> FieldsInTemplate
    {
        get;
        set;
    }

    public IList<MetadataTemplateFieldInstanceDisplayViewModel> FieldsNotInTemplate
    {
        get;
        set;
    }
} 
```

MetadataTemplateFieldInstanceDisplayViewModel 看起来像：

```
public class MetadataTemplateFieldInstanceDisplayViewModel
{
    public int FieldId {get;set;}

    public string FieldName {get;set;}

    public bool IsRequired {get;set;}
} 
```

如果这有点含糊，请告诉我，我是新来的，不想用太多不必要的代码让你超载。

干杯

标记

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T13:36:31.870

复选框的值不能确定它是否被“选中”。你需要使用checked="checked"。

我不是 100% 学过 Razor，但这里有一个尝试：

```
<input name="IsRequired" type="checkbox" @if(item.IsRequired) { <text>checked="checked"</text>} value="@item.IsRequired" /> 
```

这能解决你的问题吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-22T10:48:06.193

如果您像这样声明该列：

```
grid.Column("Select", "Select", format: @<input type="checkbox" name="selectedrows" value="@item.WedNo" />) 
```

然后在您的操作中，表单发布给您可以访问这些选定的项目，如下所示：

```
public ActionResult Selections(string[] selectedrows) 
```

这里 selectedrows 将包含所有选中的复选框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T01:16:03.763

我想出了如何以我想要的方式做到这一点：

```
 grid.Column("Select", header: "", format: (item) => @Html.Raw("<a href='" + item.GetSelectUrl() + "' /><img src='" + ((grid.SelectedRow == item) ? "../../Content/images/AdminSelect-ON.png" : "../../Content/images/AdminSelect-OFF.png") + "' />")), 
```

# android - 在使用 ListView 和 SimpleCursorAdaptor 显示之前如何修改行值？

> ID：10298944
> 
> 赞同：0
> 
> 时间：2012-04-24T13:31:47.663
> 
> 标签：android, sqlite, listview

我正在使用 SimpleCursorAdaptor 和 ListView 来显示我的 SQLite 数据库行中的值。我的行中的值之一是日期（列“日期”）。而不是显示这个日期，我需要通过一个方法来运行它，该方法将根据日期返回另一个字符串。这是我希望在列表中显示的值，而不是直接从数据库中获取的实际值。

简而言之，我希望显示我的数据库表行中的所有值，除了一个，我需要在显示之前更改它。

这是我的代码：

```
public class BinCollectionDayListActivity extends ListActivity{
    //
    private static final String fields[] = { "name", "date", BaseColumns._ID };
    //
    public void onCreate(Bundle savedInstanceState) {
        //
        super.onCreate(savedInstanceState);
        //
        DatabaseHelper helper = new DatabaseHelper(this);
        SQLiteDatabase database = helper.getWritableDatabase();
        Cursor data = database.query("names", fields, null, null, null, null, null);
        CursorAdapter dataSource = new SimpleCursorAdapter(this, R.layout.binrow, data, fields, new int[] { R.id.name, R.id.date });
        dataSource.getCursor().requery();
        //
        ListView view = getListView();
        view.setHeaderDividersEnabled(true);
        setListAdapter(dataSource);
        //
        helper.close();
        database.close();
    }
} 
```

正如您所说，我对 Android 开发还很陌生，并且很想知道实现预期结果的最佳方法是什么。

提前致谢，

托尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:51:55.037

我以前使用过的两个选项：

**数组适配器（首选）**：创建一个 ArrayAdapter 并将光标数据填充到您的 ArrayAdapter 中。 [http://anujarosha.wordpress.com/2011/11/17/how-to-create-a-listview-using-arrayadapter-in-android/](http://anujarosha.wordpress.com/2011/11/17/how-to-create-a-listview-using-arrayadapter-in-android/)

**ViewBinder**：在光标上，您可以设置/指定一个 ViewBinder，您可以在其中检查即将映射的数据，对其执行一些逻辑，并在需要时输出不同的结果。这可能正是您正在寻找的东西，但请考虑使用 ArrayAdapter，因为它往往会为您提供更好的控制，并且稍后切换这些东西会很痛苦。 [使用 SimpleCursorAdapter 从 Cursor 更改值](https://stackoverflow.com/questions/3609126/changing-values-from-cursor-using-simplecursoradapter)

# ruby-on-rails - 如何使用carrierwave（Ruby On Rails）通过HTTP post将图像上传到另一台服务器？

> ID：10298946
> 
> 赞同：0
> 
> 时间：2012-04-24T13:31:51.627
> 
> 标签：ruby-on-rails, file-upload, carrierwave

我正在尝试使用carrierwave通过HTTP post将图像上传到另一台服务器？目前我所了解的是，Carrierwave 支持一些已知的云存储。但是，在我们的应用程序中，我们有一个带有 MongoDB 的单独存储系统。为了在该服务器中存储任何文件，我们可以使用 HTTP post。现在，我正在尝试编写一个客户端代码来上传图像。是否可以通过使用 Carrierwave 来实现，或者是否有其他可用的 gem？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T15:24:31.257

如果您使用 CarrierWave 和 MongoDB，我会使用[https://github.com/jnicklas/carrierwave-mongoid](https://github.com/jnicklas/carrierwave-mongoid) gem 来连接和存储 GridFS 中的目录。

这是一篇关于通过载波和 gridfs 上传和检索图像的好帖子：http: [//hafizbadrie.wordpress.com/2011/04/14/image-upload-with-carrierwave-and-mongoid-gridfs-mongodb-in-导轨-3/](http://hafizbadrie.wordpress.com/2011/04/14/image-upload-with-carrierwave-and-mongoid-gridfs-mongodb-in-rails-3/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-24T13:40:05.900

您需要在教程中有 s3 数据的地方提供您的数据：

[堆栈溢出](https://stackoverflow.com/questions/6127079/rails-direct-upload-to-amazon-s3)

# php - 如何使用在局部范围内创建的变量“不分配”在全局

> ID：10298947
> 
> 赞同：0
> 
> 时间：2012-04-24T13:31:55.150
> 
> 标签：php, function, scope, global, local

我正在尝试使用在本地范围内创建的变量，而不在全局范围内分配该变量。看看我的意思：

```
<?
function foo(){
    $bar = inside;
}
foo();
echo $bar; // It will give an error that $bar is not assigned
?> 
```

现在你可能已经明白我在尝试什么了..？是的，我想回显该 $bar 而不在全局范围内分配它。

一些编码示例很受欢迎。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:34:07.057

使用返回值。

```
<?php
function foo(){
    $bar = "inside";
    return $bar;
}
$bar = foo();
echo $bar;
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:34:59.977

唯一可能的方法是使用[`$GLOBALS`](http://php.net/manual/en/reserved.variables.globals.php)超全局（至少不返回它）：

```
function foo(){
  $GLOBALS['bar'] = 'baz';
}

foo();
echo $bar; 
```

否则，您首先要考虑在全局范围内定义它，然后指定您需要使用以下命令访问它[`global`](http://php.net/manual/en/language.variables.scope.php)：

```
$bar = null;

function foo(){
  global $bar;

  $bar = 'baz';
}

foo();
echo $bar; 
```

* * *

更好的选择是使用范围保留在对象内的对象，并且您仍然可以保留代码的结构和完整性：

```
class Foo
{
  var $bar = null;

  function Bar()
  {
    $this->bar = 'baz';
  }
}

$foo = new Foo();
$foo->Bar();
echo $foo->bar; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:36:48.643

如果要从外部访问局部变量的内容，则有 3 个选项：

使用全局变量：通常不推荐，也不是您想要的。

返回该变量的值：

> ```
> <?
> function foo(){
>     $bar = inside;
> }
> $outisde_bar = foo();
> echo $outside_bar;
> ?> 
> ```

使用引用变量作为函数的属性：

> ```
> <?
> function foo(&$bar){
>     $bar = inside;
> }
> foo($bar);
> echo $bar;
> ?> 
> ```

这有帮助吗？

# c# - System.IO.FileInfo 未显示在 MonoDevelop 的下拉完成列表中

> ID：10298948
> 
> 赞同：-1
> 
> 时间：2012-04-24T13:31:56.210
> 
> 标签：c#, .net, mono, monodevelop

我正在写这堂课

```
using System;
using System.IO;
using Comparison.Strategies; // this namespace contains the ICompare interface

namespace Comparison{

    public class FileNameCompare : ICompare
    {   
        public bool compare(FileInfo a, FileInfo b)
        {
            a. 
        //   ^
        //   Pressing . does not show FileInfo properties or methods (!!)
        }
    }
} 
```

问题是当我按下`.`（参见上面的代码注释）时，它没有生成完成列表。当我按`Ctrl`+`space`它显示一个完成列表，但不显示`FileInfo`类的任何属性。

*   我的目标平台设置为`Mono/.NET 2.0`在项目选项中。
*   我还在其他项目中实现了相同的接口，其中完成列表正确显示。
*   如果我只是添加一个`return true`代码编译！

那么谁能告诉我**为什么**`.`没有触发课程的完成 列表`FileInfo`？我该**如何****解决**？

**更新：**

当我写完后按`Ctrl`+时，在完成列表中我看到了这个，`space``System.IO.`

![在此处输入图像描述](../Images/dac3bd2334f7ba9f51ae73d1e51ed15d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T18:01:57.807

好吧，MonoDevelop <= 2.8 中的代码完成和重构引擎并不理想，目前正在使用[NRefactory](https://github.com/icsharpcode/NRefactory)进行重新设计。您可以使用最新的 MD beta 或从 git 源编译它来尝试新引擎。不过，您很可能希望等到它稳定下来。

# r - 如何调用现有的顺序命名变量以在 for 循环中应用操作

> ID：10298953
> 
> 赞同：0
> 
> 时间：2012-04-24T13:32:09.150
> 
> 标签：r

我想使用 for 循环将某个操作应用于多个（按顺序命名的）变量，以缩短以下代码：

```
for(i in 1:ncol(data)) {assign(paste('var', i, sep = '.'), my.fun(data[,i]))}

result.1 <- new.fun(var.1)
result.2 <- new.fun(var.2)
result.3 <- new.fun(var.3)
... 
```

那么，如何调用现有变量 var.1、var.2、....？我也尝试在这里粘贴，但没有奏效。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T13:40:16.070

简短的回答：不要那样做；改用列表。

假设`data`是一个data.frame：

```
vars <- lapply(data, my.fun)
results <- lapply(vars, new.fun) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-24T15:50:17.493

要扩展@Jos​​hua 的答案，如果您的数据已经存在于 var.1、var.2 等变量中，那么您可以使用以下代码将它们组合成一个列表：

```
mydata <- lapply( paste('var.', 1:10, sep=''), get ) 
```

或者

```
mydata <- lapply( paste0('var.',1:10), get ) 
```

或者

```
mydata <- lapply( sprintf('var.%d',1:10), get ) 
```

`"var%03d"`如果您有 var001、var002 等变量名称，则可以使用最后一个。

如果您希望列表中的术语命名（不需要，但可以很好），您可以这样做：

```
names(mydata) <- sprintf('var.%d', 1:10) 
```

现在，如果您想访问列表中的单个元素，您可以使用`mydata[[3]]`或访问它`mydata$var.3`。但最大的优势是您现在可以使用`lapply`or `sapply`or or `vapply`or other tools 对列表的每个元素运行相同的功能，如果您想保存、复制、删除等数据，您只需担心一个对象而不是需要另一个循环。

对于未来的项目，最好直接将数据读取或创建到列表中，而不是先创建单个变量。

# javascript - 使用 Javascript 函数检查复选框

> ID：10298954
> 
> 赞同：0
> 
> 时间：2012-04-24T13:32:10.337
> 
> 标签：javascript, jquery, html, checkbox

如何根据发送到 Javascript 函数的值选中/取消选中复选框？请[检查](https://stackoverflow.com/questions/10160185/the-button-didnt-get-fired-while-clicked-on-the-modal-box/10267848#comment13205122_10267848)如何调用**showModalPopup**函数。

* * *

我有一个网格视图：

```
<asp:GridView ID="GV1" runat="server" DataSourceID="DS1" >
  <Columns>

    <asp:BoundField HeaderText="ID" DataField="ID"/>

    <asp:TemplateField ShowHeader="False">
      <ItemTemplate>
        <asp:LinkButton ID="Edit_LinkButton" runat="server" CausesValidation="False" >
          <asp:Image ID="Edit_Linkbutton_Image" runat="server" ImageUrl="~/edit.png"></asp:Image>
        </asp:LinkButton>
      </ItemTemplate>
    </asp:TemplateField>

    <asp:TemplateField HeaderText="Status" Visible="False">
      <ItemTemplate>
        <asp:Label ID="Status" runat="server" Text='<%# Bind("Status") %>'></asp:Label>
      </ItemTemplate>
    </asp:TemplateField>

  </Columns>
</asp:GridView> 
```

然后我通过代码隐藏将 Javascript 函数附加到 LinkBut​​ton：

```
Dim myLinkButton As LinkButton

For i As Integer = 0 To GV1.Rows.Count - 1
  Dim CheckBox1 As String = TryCast(GV1.Rows(i).FindControl("Status"), Label).Text

  myLinkButton = DirectCast(GV1.Rows(i).Cells(1).FindControl("Edit_LinkButton"), LinkButton)
  myLinkButton.Attributes.Add("onclick", "shopModalPopup('" & .Rows(i).Cells(0).Text & "', '" & CheckBox1 & "'); return false;")
Next 
```

`Rows(i).Cells(0)`是 Gridview 上的第一列，它是“ `ID`”。

然后，调用模态框的 Javascript 函数是：

```
<script>
                var grid_modal_options = {
                    height: 450,
                    width: 550,
                    modal: true
                };

                function shopModalPopup(Field1, Check1) {
                    var DataField1 = Field1; //--> ID
                    var CheckField1 = Check1; //--> Status

                    grid_modal_options.open = function () {
                        $('#dialog-form #Textbox1').val(DataField1);
                        $('#dialog-form #Checkbox1').checked = CheckField1;
                    };

                    $("#dialog-form").dialog(grid_modal_options);
                    $("#dialog-form").parent().appendTo('form:first');
                }
</script> 
```

以及显示模态框的代码：

```
<div id="dialog-form" title="Modal-box" style="display: none;">
    <asp:TextBox ID="Textbox1" runat="server" Text="" Enabled="false">
    <asp:CheckBox ID="Checkbox1" runat="server"/>
</div> 
```

上面的代码没有选中复选框，而是选中了成功分配的文本框值。我需要复选框一个也由javascript分配。我怎样才能做到这一点？非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:34:29.897

很确定它应该是这样的：

```
$('#dialog-form #Checkbox1').attr('checked', true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:34:45.280

使用`.prop()`命令：

```
$("#dialog-form #Checkbox1").prop("checked", CheckField1); 
```

[http://api.jquery.com/prop/](http://api.jquery.com/prop/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:38:37.053

您可以使用[`.val()`](http://api.jquery.com/val/), 将复选框的值作为单项数组来检查复选框：

```
$('#dialog-form #Checkbox1').val([ "Checkbox1" ]); 
```

确保复选框将“Checkbox1”指定为其`value`.

# html - div对齐以放大和缩小为中心

> ID：10298959
> 
> 赞同：1
> 
> 时间：2012-04-24T13:32:26.200
> 
> 标签：html, css, wordpress, cross-browser

我有网站[http://www.d1210091-6206.cp.blacknight.com/site/home/](http://www.d1210091-6206.cp.blacknight.com/site/home/)页面上有特定部分（News & fb）的 div id footerwrapper 的放大和缩小对齐问题。所有其他都在放大和缩小时居中对齐。

我也把屏幕截图发给你。[http://screencast.com/t/e95jEwR6dki](http://screencast.com/t/e95jEwR6dki)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:43:43.820

我检查你的代码，如果你触摸文件 style.css，元素#footer 的样式，如果你不使用

`float: left; margin-left: 210px; width: 600px`

擦除它，div#footer 将居中。但是在所有的 facebook 部分，你会发现它的顶部有一点裁剪。您可以为此保留一些边距或填充。

在一个临时的Backup old shool方法中，你可以使用标签（如果你想更自由地改变样式，不推荐），有两列和宽度，每列指定宽度。

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:43:54.763

您必须从#footer 中删除“margin-left：210px”。它会覆盖“margin: 0 auto;” 来自 .container-12 类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-28T10:20:20.850

我建议使用引导程序，这样对我很有帮助..

```
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 text-left" style="border:1px dashed red; ">
  I will be at left

</div>

<div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 text-center" style="border:1px dashed blue;">
  I will be at center

</div>

<div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 text-right" style="border:1px dashed green;">
  I will be at right

</div>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-25T14:45:40.663

唯一对我有用的东西（任何缩放）。

```
margin: 0 auto;
width: fit-content; 
```

在你的元素上

# jquery - 防止链接失败事件

> ID：10298961
> 
> 赞同：0
> 
> 时间：2012-04-24T13:32:28.467
> 
> 标签：jquery, html, css

我在页面上有这个 html：

```
<a href="review.asp?sitename=webcamking#video_embed" class="tutorials" data_site="webcamking">&nbsp;&nbsp;Tutorial 1</a> 
```

这个jQuery：

```
 $('.tutorials').click(function(event){
       event.preventDefault();
       event.stopPropagation()
       var linkText=$(this).text();
       var siteName= $(this).attr('data_site');
       alert("Test. linkText:"+linkText+". siteName:"+siteName);
      _gaq.push(['_trackEvent', 'LinkClicked', siteName, linkText]);
       //window.location.href=$(this).attr('href');

       return false;

  }) 
```

问题是链接仍然把我送到目的地。我需要阻止它。我需要检查我收到的警报......并希望触发谷歌分析事件！

**更新：修改代码：**

```
$(document).ready(function(){

       $('.tutorials').click(function(event){
       event.preventDefault();
       var linkText=$(this).text();
       var siteName= $(this).attr('data_site');
       alert("Test. linkText:"+linkText+". siteName:"+siteName);
      _gaq.push(['_trackEvent', 'LinkClicked', siteName, linkText]);
       //window.location.href=$(this).attr('href');

       return false;

  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:40:55.087

1.  `$( document ).ready( function() {})`您是否在语句中附上了您的 jQuery 代码块？
2.  此块上方是否有任何代码正在分解并阻止此块执行？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T13:39:53.357

用这个：

html:

```
<div id="tutorials">&nbsp;&nbsp;Tutorial 1</div>​ 
```

jQuery：

```
 $('#tutorials').click(function(event){
   event.preventDefault();
   event.stopPropagation()
   var linkText=$(this).text();
   var siteName= $(this).attr('data_site');
   alert("Test. linkText:"+linkText+". siteName:"+siteName);
  _gaq.push(['_trackEvent', 'LinkClicked', siteName, linkText]);
   //window.location.href=$(this).attr('href');

   return false; 
```

})​</p>

# google-app-engine - java.lang.NoClassDefFoundError GWT 导致无法初始化类

> ID：10298962
> 
> 赞同：2
> 
> 时间：2012-04-24T13:32:32.753
> 
> 标签：google-app-engine, gwt, gwt-rpc, gwt2

调用 GWT RPC 函数时出现以下错误，

```
com.google.gwt.user.client.rpc.StatusCodeException: 500 
```

我确实在 web.xml 中添加了 remoteservicepath 以及 servlet 名称和映射，但我得到了错误

> 无法初始化类 com.logins.server.Putquestion 由：java.lang.reflect 的 sun.reflect.GeneratedConstructorAccessor19.newInstance(Unknown Source) 处的 sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) 处的 java.lang.NoClassDefFoundError。构造函数.newInstance(Unknown Source) at java.lang.Class.newInstance0(Unknown Source) at java.lang.Class.newInstance(Unknown Source) at org.mortbay.jetty.servlet.Holder.newInstance(Holder.java:153)在 org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:428) 在 org.mortbay.jetty.servlet.ServletHolder.getServlet(ServletHolder.java:339)...

注意：1）com.logins.server.PutQuestion 是实现客户端定义的 rpc 接口的服务器代码。

任何猜测我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T15:25:38.567

确保 servlet 类存在于 war/WEB-INF/classes 文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T17:56:07.057

您的编辑器的类路径中有类，但在运行时没有。

跟踪表明您在构造函数中抛出了一些异常，该异常被传播到类加载器。尝试用 try/catch 包装你的构造函数并打印堆栈跟踪。可能您正在查找可能已关闭/不存在的数据库/文件。

# perl - Perl DBD::ODBC 到 Informix DBMS

> ID：10298964
> 
> 赞同：2
> 
> 时间：2012-04-24T13:32:37.803
> 
> 标签：perl, odbc, informix

我正在尝试使用 DBD::ODBC 在 Perl 脚本 (v5.12.4) 中建立与 Informix DB 的 ODBC 连接。我已经阅读了很多文档，似乎碰壁了，希望能在这里得到一些提示。

我安装了带有空 odbcinst.ini 和 odbc.ini 文件的 unixODBC 2.2.14（不好，我知道）。我还从 IBM 的站点下载了 Informix 的 CSDK。如果我检查 DBI 的可用驱动程序，那里也列出了 Informix。

我想我的问题与使用驱动程序和 dsn 的正确信息填充 .ini 文件有关。我不确定 Informix 驱动程序在哪里，我如何引用它们或 dsn 的语法。我已经将 DBI 与 mysql 一起使用了一段时间，但 ODBC 似乎更深入，现在有点过头了。

当我尝试运行脚本进行连接时，我得到：

```
DBI connect........failed: [unixODBC][Driver Manager]Data source name not found, and no default driver specified (SQL-IM002) at Informix.pl line 20 
```

如果我在帖子中遗漏了任何重要的细节，请告诉我，我会包括在内。

谢谢！

**更新**

我在另一篇文章中得到了一些帮助，发现 Java 和我的操作系统运行不佳，因此我无法正确安装 CSDK。所以，我删除了 Ubuntu 并安装了 SuSE。我（我希望）现在正确安装了 CSDK 并更新了 .ini 文件。附带说明一下，我无法运行 nm 来查看符号，但我确实在 /opt/IBM/informix/lib/ 目录中有几个 .so 文件，我试图在我的 odbcinst.ini 文件中引用这些文件。当我运行 isql 连接时，我得到：

```
[01000][unixODBC][Driver Manager]Can't open lib '/opt/IBM/informix/lib/nameofdriver.so.   : file not found 
```

你对这个有什么建议吗？我已经检查了文件中的恶意空格/字符，并且正在以 root 身份运行连接请求。任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T14:06:32.613

您是否阅读了 DBD::ODBC 中包含的 README.informix？我知道它已经很老了，但它至少给了你一个线索，你通常将 INFORMIXDIR 设置为 CSDK 的解包位置，并且客户端库位于/位于 $INFORMIXDIR/lib/cli 中。

您需要找到哪个共享对象是 Informix ODBC 驱动程序，因此请在 SDK 中查找以 .so 结尾的文件，如果这仍然让您无法猜测，请尝试在它们上运行 nm 并查找诸如 SQLAllochandle 之类的符号（所有 ODBC 驱动程序都需要这些符号） ）。找到驱动程序后，您需要创建可使用“odbcinst -j”定位的 ini 文件。在您的 odbcinst.ini 文件中添加如下内容：

```
[informix]
Description=Informix ODBC driver
Driver=/path/to/informix_odbc_driver_shared_object
DontDLClose=1 
```

然后，您需要在 odbc.ini 中创建一个 DSN，如下所示：

```
[mydsn]
Driver = informix
Database=myDataBase;
Host=192.168.10.10;
Server=db_engine_tcp;
Service=1492;
Protocol=onsoctcp; 
```

我从一个连接字符串站点偷了那些，所以你应该用你的 informix 文档检查它们。

然后你可以使用：

```
isql -v mydsn myusername mypassword 
```

测试连接。

一旦 README.informix 开始工作，我很乐意接受它的任何更改。

# ruby-on-rails - Rails 单元测试功能和下划线模块

> ID：10298967
> 
> 赞同：1
> 
> 时间：2012-04-24T13:32:49.927
> 
> 标签：ruby-on-rails, unit-testing

我在我的 REST Api 应用程序中启动单元测试实现。我使用[版本主义 gem](https://github.com/bploetz/versionist)。

所以，我有一个这样的类：`Api::V0_1_0::TestController`

```
class Api::V0_1_0::TestController < Api::V0_1_0::BaseController

  def test
    respond_with({
      :message => "done"
    })
  end

end 
```

`routes.rb`（没有所有路线，但只是必要的）：

```
MyApp::Application.routes.draw do

  # -----------------------------------------------------------------------------------------------------------------------------------------
  # ApiVersions
  #
  scope :module => "api",
        :defaults => {:format => "json"} do

    # ---------------------------------------------------------------------------------------------------
    # V0.1.0
    # Default version
    #
    api_version :module => "V0__1__0",
                :header => "X-Version", :value => "0.1.0" do

      # Test controller
      get "/test" => "test#test"
    end
    # ---------------------------------------------------------------------------------------------------

    # ---------------------------------------------------------------------------------------------------
    # V0.1.1
    # Default version
    #
    api_version :module => "V0__1__1",
                :header => "X-Version", :value => "0.1.1" do

      # Test Controller
      get "/test" => "test#test"

  end
  # -----------------------------------------------------------------------------------------------------------------------------------------

  # -----------------------------------------------------------------------------------------------------------------------------------------
  # ActiveAdmin routes
  #
  ActiveAdmin.routes(self)
  devise_for :admin_users, ActiveAdmin::Devise.config
  # -----------------------------------------------------------------------------------------------------------------------------------------

end 
```

功能测试文件：

```
class Api::V0_1_0::TestControllerTest < ActionController::TestCase

  test "should get test" do
    get :test
    assert_response :success
  end
end 
```

当我启动`rake test:functionals`. 我有这个错误：

> 没有路由匹配 {:controller=>"api/v0_1_0/test", :action=>"test"}

当我启动时`rake routes`，我有：

```
test GET  /test(.:format)   {:format=>"json", :controller=>"api/V0__1__0/test", :action=>"test"} 
```

带有双下划线 for`V0__1__0`和 not `V0_1_0`。

我不知道如何解决这个问题。

编辑：我添加了`routes.rb`.

注意：我在这里也发布了一个问题：[https ://github.com/bploetz/versionist/issues/9](https://github.com/bploetz/versionist/issues/9)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T13:41:05.733

看看你提供的链接，你能做这样的事情吗？

```
api_version :module => "V0__1__0",
            :path => "/V0_1_0",
            :header => "X-Version", :value => "0.1.0" do 
```

或者

```
get "/test" => "test#test", :controller => "api/V0_1_0/test" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T22:44:59.803

Rails 功能测试（ActionController::TestCase）用于单独测试控制器操作方法。他们没有通过完整的 Rails 堆栈，特别是 Rails 调度程序代码路径，这是版本主义挂钩的地方。

如果您想测试依赖于 HTTP 标头策略的版本化 API 路由，请使用集成测试 (ActionDispatch::IntegrationTest) 或在使用 rspec 时请求规范。

```
require 'test_helper'

class Api::V0_1_0::TestControllerTest < ActionDispatch::IntegrationTest

  test "should get test" do
    get '/test', nil, {"X-Version" => "0.1.0"}
    assert_response :success
    assert_equal @response.body, "0.1.0"
  end
end 
```

Versionist 0.2.0 向其生成器创建的组件添加了集成测试/请求规范 ( [https://github.com/bploetz/versionist/issues/11](https://github.com/bploetz/versionist/issues/11) )。

# asp.net - .Net 4.0 在 SqlServer 数据库中缓存数据，而不是在内存中缓存

> ID：10298973
> 
> 赞同：2
> 
> 时间：2012-04-24T13:33:04.700
> 
> 标签：asp.net, .net, caching

我知道微软在 .net 4.0 框架中给出了 System.Runtime.Caching 命名空间。这有助于我们很好地处理内存缓存数据（通过使用 MemoryCache 类）。但与企业库一样，它也支持数据库缓存。我需要知道如何使用 microsoft 引入的新功能在 sqlserver db 中进行数据缓存（仅用于放置和 pic 数据）。我已经浏览过，但找不到任何通过代码给出任何示例的文章。如果有人知道，请告诉我。

更重要的是，如果有人可以在示例中为此建议一个 db 模型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T16:03:21.267

更多的问题是您在哪里需要这些数据，以及您必须多久去一次“昂贵”的资源才能获得它。

例如，如果您有来自 3rd 方站点的数据，您可以在您自己的数据库中“缓存”该数据，从而更快地访问它。

如果您有来自自己的数据库的数据，那么生成或处理“昂贵”的数据，您还可以将该数据缓存在 Web 层的内存中。

# silverlight - 带虚线边框的richtextbox

> ID：10298975
> 
> 赞同：0
> 
> 时间：2012-04-24T13:33:19.723
> 
> 标签：silverlight, richtextbox, border

如何制作带有虚线边框的richtextbox

我试过这样的事情：

```
 <Border Width="100" Height="100" Background="White" BorderThickness="1,1,1,1">
        <RichTextBox Name="richTextBox1" />
        <Border.BorderBrush>
            <LinearGradientBrush StartPoint="0,0" EndPoint="0,.1" SpreadMethod="Repeat" >
                <GradientStopCollection>
                    <GradientStop Color="Transparent" Offset="0" />
                    <GradientStop Color="Transparent" Offset="0.2" />
                    <GradientStop Color="Red" Offset="0.2" />
                    <GradientStop Color="Red" Offset="0.4" />

                    <GradientStop Color="Transparent" Offset="0.4" />
                    <GradientStop Color="Transparent" Offset="0.6" />
                    <GradientStop Color="Red" Offset="0.6" />
                    <GradientStop Color="Red" Offset="0.8" />
                    <GradientStop Color="Transparent" Offset="0.8" />
                    <GradientStop Color="Transparent" Offset="0.9" />
                    <GradientStop Color="Red" Offset="0.9" />
                    <GradientStop Color="Red" Offset="1" />

                </GradientStopCollection>
            </LinearGradientBrush>

        </Border.BorderBrush>
    </Border> 
```

但这仅适用于左/右或上/下

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T18:15:19.373

（对不起，我的英语不好）

尝试这个：

```
<Grid Width="200" Height="80">
        <Rectangle Fill="Transparent" Stroke="Red" StrokeThickness="3"  StrokeDashArray="1 1"/>
        <RichTextBox BorderThickness="0" Margin="3"/>
</Grid> 
```

有点 hack，也许你可以用它创建一个样式，这样你也可以覆盖 RichTextBox 边框。

# android - SQLite 获取 Android 中两个 Long 之间的日期

> ID：10298984
> 
> 赞同：0
> 
> 时间：2012-04-24T13:33:48.403
> 
> 标签：android, sqlite

我有这段代码可以返回 Long A 和 Long B 之间的所有行

```
public ArrayList<CashGame> getAllCashGamesByDates(Long startdate, Long enddate) {
    ArrayList<CashGame> cashgameList = new ArrayList<CashGame>();

    SQLiteDatabase db = this.getWritableDatabase();
    Cursor cursor= db.query(TABLE_CASHGAMES, new String[] { KEY_ID,
            KEY_NAME, KEY_BUYIN, KEY_RESULT, KEY_START, KEY_END, KEY_LOCATION },      startdate + ">=? AND " + enddate + " <?",
            new String[]{startdate.toString(), enddate.toString()} , null, null, null);

    // looping through all rows and adding to list
    if (cursor.moveToFirst()) {
        do {
            CashGame cashgame = new CashGame();
            cashgame.setId(Integer.parseInt(cursor.getString(0)));
            cashgame.setName(cursor.getString(1));
            cashgame.setBuyin(cursor.getDouble(2));
            cashgame.setResult(cursor.getDouble(3));
            cashgame.setStartDate(date = new Date(cursor.getLong(4)));
            cashgame.setEndDate(date = new Date(cursor.getLong(5)));
            cashgame.setLocation(cursor.getString(6));
            // Adding contact to list
            cashgameList.add(cashgame);
        } while (cursor.moveToNext());
    }

    db.close();
    // return contact list
    return cashgameList;
} 
```

我想查询有问题，但我没有发现我犯的错误。希望有人看到！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:42:38.270

我会假设：

```
... startdate + ">=? AND " + enddate + " <?" ... 
```

应该更多：

```
... "startdate>=? AND enddate<?" ... 
```

**编辑：**

不知道如何理解你的 where 子句，但也许你的意思是：

```
... "startdate<=? AND enddate>?" ... 
```

**另一个编辑：**

为什么不直接调用`cursor.moveToNext()`：

```
 while (cursor.moveToNext()) {
     ...
 } 
```

# asp.net-mvc-3 - 如何强制脚手架自动生成的代码在我的 asp.net mvc 3 的同一行显示 Label 和 EditorFor 文本字段

> ID：10298986
> 
> 赞同：1
> 
> 时间：2012-04-24T13:33:56.477
> 
> 标签：asp.net-mvc-3, razor

我正在开发一个带有 razor view 的 asp.net mvc 3，我还使用脚手架模板自动生成关联的操作方法和视图。但是我面临的问题是，在视图中`lable`，`editorfor`输入字段将显示在两个单独的行中（每行都在一个单独的行上`Div`），如下所示：-

```
<div class="editor-label">
            @Html.LabelFor(model => model.FirstName)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.FirstName)
            @Html.ValidationMessageFor(model => model.FirstName)
        </div> 
```

那么有没有办法进行更改以强制标签和输入输入框并排显示，而无需在每个视图中手动修改代码？BR

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T17:59:27.043

您可以编辑直接输出标记的 t4 模板。脚手架文件可以在您的机器上找到：

C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\ItemTemplates\CSharp\Web\MVC 3\CodeTemplates\AddView\CSHTML

您将看到一个 .tt 文件列表，这些文件用于生成自动输出的 html。如果您不喜欢元素布局的默认方式，请更改它们！请记住，更改这些将导致脚手架永久更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T16:09:01.130

不确定这是否是您正在寻找的，但这是我的观点：

```
 <div class="editor-label">
    @Html.LabelFor(model => model.Title)
    </div>
    <div class="editor-field">
    @Html.EditorFor(model => model.Title)
    @Html.ValidationMessageFor(model => model.Title)
    </div>

    <div class="editor-label">
    @Html.LabelFor(model => model.DateCreated)
    </div>
    <div class="editor-field">
    @Html.EditorFor(model => model.DateCreated)
    @Html.ValidationMessageFor(model => model.DateCreated)
    </div> 
```

我修改了这个 CSS 来添加 float: left; 到每个班级

```
.display-label, 
.editor-label {
margin: 1em 0 0 0;
float: left;
}

.display-field, 
.editor-field {
margin: 0.5em 0 0 0;
float: left;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-06T13:12:11.057

在 Visual Studio (so )`Site.css`创建的默认文件中，在该部分下，您将看到以下内容：`\Your Project\Content\Site.css``/* forms */`

```
label {
    display: block;
    font-size: 1.2em;
    font-weight: 600;
} 
```

只需更改`display: block;`为`display: inline;`，现在您的所有输入字段都将显示在与标签相同的行上。

# android - 使用共享首选项保存数据

> ID：10298987
> 
> 赞同：-1
> 
> 时间：2012-04-24T13:33:58.780
> 
> 标签：android

SharedPreference 是否适用于用户按下后退按钮。那么当用户按下后退按钮时存储数据的方式是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T13:51:30.783

您可以覆盖后退按钮按下，然后使用 SharedPreferences：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)  {
    SharedPreferences SP =  = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
    SP.edit().putString(key, value);
    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:49:11.723

您可以覆盖后退按钮，然后使用共享首选项存储值，如果这就是您的意思！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T13:56:50.137

为此目的使用 Activity 的 onBackPressed 方法：

```
@Override
public void onBackPressed() {
    //Do stuff
    return;
} 
```

# jquery - jQuery ajaxComplete 事件：检测是否已从缓存中获取响应

> ID：10298998
> 
> 赞同：1
> 
> 时间：2012-04-24T13:34:30.600
> 
> 标签：jquery

我有一个奇怪的问题，我正在监听服务器返回的 HTTP 标头，该标头在`ajaxComplete`事件中注册自己（使用 jQuery）。现在在 Chrome 上，我注意到`ajaxComplete`当 Chrome 从缓存中获取实际内容时也会调用，因此也为我提供了潜在的旧标题信息（真的很奇怪）。

**我的问题：**有没有办法检测给定的响应是否已从缓存中获取？

（注意：我知道可以添加到 ajax 调用的不同缓存设置，但如前所述，我只是在`ajaxComplete`无法控制实际执行的 ajax 调用的情况下注册自己）

# ruby-on-rails - When to test security in a rails application

> ID：10298999
> 
> 赞同：0
> 
> 时间：2012-04-24T13:34:33.063
> 
> 标签：ruby-on-rails, rspec, cucumber

I'm diving into testing frameworks for about the first time, and I have problems to know what kind of test to implement for security functionnalities. Suppose a basic blog application where only an authorized user can create new posts.

For the "Posts" tests, should the fact that only authorized user can create a new post be tested by cucumber in a feature, or in rspec with the controller_spec? I know both can be done, but testing that in a cucumber feature seems a bit overkill, isn't it?

To me, it seems that "Guests should not be able to create new posts" is not a feature but a limitation of the system, so it should not be a cucumber feature but rather an rspec test. In the end application, there won't be a link from the guests pages to the "create post" feature, so what I am really testing is they don't input the URL `/posts/new`.

Is my understanding right?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T13:46:47.537

Any user can try to hack your site, just by sending raw data to your application. You have to be prepared to that. I recommend you a testcase where you check, that if an unauthorized user tries to create a new post (posts/create) he gets an error screen, and no database entry is created. You can check this for the new action too, but it is not an input action, so it is a lesser mistake. Try to cover all actions which can't be used unauthorized, so no db action happens and the testcase result in an error page or something.

Actually the security of the page IS a feature, maybe not the most important for a blog app, but it matters. And not just for direct attack, but you must expect accidental tries, e.g. someone starts to write a post on one tab, and logs out on another.

The exact method is up to you, it think.

Update: I think you should use Rspec controller test.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T14:18:04.603

Personally, I test my controllers with rspec to check user access. I create a couple of users in rspec's

```
before {}
```

with FactoryGirl, then log in with one of them and test that the other users can't access the current user's pages. This may take a bit of work to set up, but it's well worth it if you can test access security while you're creating your pages.