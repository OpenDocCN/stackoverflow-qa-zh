# StackOverflow 问答 10342000-10342999

# python - python帮助功能输出的标记语言？

> ID：10342004
> 
> 赞同：0
> 
> 时间：2012-04-26T21:57:30.263
> 
> 标签：python

输出是否`help(something)`遵循一些易于在 html 中格式化的标记语言？我知道`pydoc -w [topic]`但有两个问题：

*   风格的定制并不容易（http://bugs.python.org/issue10716）和
*   `pydoc -w`某些主题失败（http://stackoverflow.com/a/10333615/1318686）

下面是一些由 生成的示例输出`help('def')`。它具有其他标记语言的一些典型特征。例如代码块的空格，内联代码的`，高亮的**...

有任何想法吗？

谢谢！

```
Function definitions
********************

A function definition

Multiple decorators are applied in
nested fashion. For example, the following code:

   @f1(arg)
   @f2
   def func(): pass

just like a function defined by a lambda form.  The "``def``" form is
actually more powerful since it allows the execution of multiple
statements.

**Programmer's note:** Functions are first-class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:00:45.087

大多数人使用[reStructuredText](http://docutils.sourceforge.net/rst.html)并使用[Sphinx](http://sphinx.pocoo.org/)将其转换为 HTML 和其他格式。

但是，对于如何格式化函数的文档字符串没有要求。

# asp.net - IIS 请求限制

> ID：10342006
> 
> 赞同：0
> 
> 时间：2012-04-26T21:57:37.677
> 
> 标签：asp.net, iis, request, limit

我用 asp.net 创建了一个网站，该网站处理数据库中的数据并写入屏幕格式的 XML（未保存的 XML）

它运行良好，但是当它收到连续的 40-50 请求时，IIS 没有响应并被阻塞。

我认为IIS能够获得有限的人请求，我该如何改变它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:57:26.577

[http://support.microsoft.com/kb/821268](http://support.microsoft.com/kb/821268)

您通常会耗尽线程池。

# c# - 如何在详细信息视图中进行 html 解码？

> ID：10342009
> 
> 赞同：1
> 
> 时间：2012-04-26T21:58:01.867
> 
> 标签：c#, tinymce, detailsview, html-encode

```
<asp:DetailsView ID="DetailsView1" runat="server"
DataSourceID="SqlDataSource1" AutoGenerateRows="False"
DataKeyNames="ID" DefaultMode="Insert" > 
```

...

```
<asp:TextBox ID="ShortExcerptTextBox" runat="server"
Text='<%#Bind("ShortExcerpt") %>' class="mceEditor"
TextMode="MultiLine"></asp:TextBox> 
```

这是我的代码。

问题是我需要以某种方式以某种方式`HttpUtility.HtmlDecode`在那里`#Bind("ShortExcerpt")`，但不知道如何。

最初的问题是tinyMCE（富文本编辑器）本身对文本进行编码，但在读取时不会对其进行解码。说来话长：P

**所以请有人解释一下，如何`HttpUtility.HtmlDecode`阅读被读入的文本`#Bind("ShortExcerpt")`？**

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T22:09:03.980

我不认为你可以使用`HtmlDecode`with `Bind`。

所以要么尝试`HtmlDecode`代码隐藏中的文本框：

```
<asp:TextBox ID="ShortExcerptTextBox" runat="server"
    Text='<%# Eval("ShortExcerpt") %>' 
    OnDataBinding="ShortExcerptTextBox_DataBinding" class="mceEditor"
    TextMode="MultiLine">
</asp:TextBox>

protected void ShortExcerptTextBox_DataBinding(object sender, EventArgs e)
{
    var txt = (TextBox)sender;
    txt.Text = HttpUtility.HtmlDecode(txt.Text);
} 
```

或尝试`Eval`改用（如果可以接受）：

```
<asp:TextBox ID="ShortExcerptTextBox" runat="server"
    Text='<%# HttpContext.Current.Server.HtmlDecode((string)Eval("ShortExcerpt")) %>' 
    class="mceEditor"
    TextMode="MultiLine">
</asp:TextBox> 
```

两者都还没有测试。

# php - 按字母顺序对多维数组进行排序

> ID：10342010
> 
> 赞同：1
> 
> 时间：2012-04-26T21:58:05.563
> 
> 标签：php

**尝试按屏幕名称按此多维数组排序：**

```
//Looping through this for each member of a group
unset($member_info);
$member_info->id           =   $member->id;
$member_info->screen_name  =   $member->screen_name;
$member_info->first_name   =   $member->first_name;
$member_info->last_name    =   $member->last_name;
$member_info->email        =   $member->email;

//Sort member_info by screen name
$member_array = sort_by_array_key($member_info,$member_info->screen_name,'ASC');
$member_list[] = $member_array; 
```

**排序功能：**

```
function sort_by_array_key($array,$sort_key,$dir = 'ASC') {
    usort($array, function($a,$b) use ($sort_key){
        return strnatcasecmp($a["$sort_key"], $b["$sort_key"]);
    });
    if ( $dir == 'DESC' ) { return array_reverse($array); }
    else { return $array; }
} 
```

**例如，即使在我运行排序功能之后，屏幕名称当前也是如此：**

```
newUser
Chris
Carlos
Jason 
```

我可能在错误的时间应用了这种排序，但是在这里查看了其他类似的示例后，我遇到了麻烦，感谢您的帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:15:53.343

首先，您在那里对单个项目进行排序，您可能想要对实际列表 $member_list 进行排序。此外，您正在尝试对初始化对象的数组进行排序。要么初始化一个数组，要么对一个对象进行排序。

如果我假设你真的想玩数组，就像你暗示的那样，这可能是你想要做的事情：

```
<?php

$member_info = Array();
$member_info['id']           =   '1';
$member_info['screen_name']  =   'Chris';
$member_info['first_name']   =   '';
$member_info['last_name']    =   '';
$member_info['email']        =   '';

$member_list[] = $member_info;

$member_info = Array();
$member_info['id']           =   '2';
$member_info['screen_name']  =   'Carlos';
$member_info['first_name']   =   '';
$member_info['last_name']    =   '';
$member_info['email']        =   '';

$member_list[] = $member_info;

$member_info = Array();
$member_info['id']           =   '3';
$member_info['screen_name']  =   'Jason';
$member_info['first_name']   =   '';
$member_info['last_name']    =   '';
$member_info['email']        =   '';

$member_list[] = $member_info;

//Sort member_list by screen name
$member_list = sort_by_array_key($member_list,'screen_name','ASC');

function sort_by_array_key($array,$sort_key,$dir = 'ASC') {
    usort($array, function($a,$b) use ($sort_key){
        return strnatcasecmp($a["$sort_key"], $b["$sort_key"]);
    });
    if ( $dir == 'DESC' ) { return array_reverse($array); }
    else { return $array; }
}

print_r($member_list);

/*
Array
(
    [0] => Array
        (
            [id] => 2
            [screen_name] => Carlos
            [first_name] =>
            [last_name] =>
            [email] =>
        )

    [1] => Array
        (
            [id] => 1
            [screen_name] => Chris
            [first_name] =>
            [last_name] =>
            [email] =>
        )

    [2] => Array
        (
            [id] => 3
            [screen_name] => Jason
            [first_name] =>
            [last_name] =>
            [email] =>
        )

)
*/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-01T06:57:03.933

ksort - “按键对数组进行排序，维护数据相关性的关键。这主要用于关联数组。”

见[手册](https://secure.php.net/manual/en/function.ksort.php)

# wordpress - Wordpress 将 %E2%80%8E 放在我的网址末尾，怎么会？

> ID：10342012
> 
> 赞同：64
> 
> 时间：2012-04-26T21:58:16.213
> 
> 标签：wordpress, permalinks

Wordpress 将其放在我在实时站点上的永久链接的末尾... %E2%80%8E 有人知道为什么吗？多谢你们？！

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-12-11T14:44:32.130

**如果**您从 MS Word 或写字板或类似编辑器复制帖子标题。这个字符就像行尾。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-12-02T13:09:08.750

步骤 1) 识别链接，然后打开它出现在 WordPress 仪表板中的帖子或页面。

步骤 2) 我们需要删除导致问题的不可见字符，因此删除 URL 中的最后几个字符，包括引号，这样

步骤 3) 手动重新键入已删除的内容。

步骤 4) 单击更新，然后查看修改后的帖子以确认问题已解决。

[https://www.wpkb.com/fix-wordpress-links-%E2%80%8E-end/](https://www.wpkb.com/fix-wordpress-links-%E2%80%8E-end/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-10-21T14:23:06.510

这些**不可见的 unicode 字符**实际上是存在的（不情愿地）。使用箭头键在它们上移动光标时，您可以注意到它们。它们通常通过 Word 等格式编辑器添加。这很疯狂，但 Edge 甚至将它们添加到窗口标题 =-O（与密码管理器混淆）或 MS Teams Wiki 到代码片段（用于保留空格缩进的纯文本）。

摆脱它们很复杂，因为如今几乎所有纯文本编辑器和浏览器（因此所有 web 应用程序）都支持 unicode，甚至**ctrl-shift 粘贴它们也会保留它们**。即使您尝试退格它们，编辑器通常也会保留它们来为您保留 rtl/ltr 文本方向。

将标题复制到一些十六进制编辑器，删除那里的字符并将其复制回来。或者只复制地址栏中的 ascii 部分（如果它们是 URL 编码的）并通过选择全部（ctrl-a）来清除标题字段。

我用：

*   PSPad（本机）
*   Notepad++（带有 HEX-Editor 插件）

常见的隐形字符：

| 码点 | UTF-8 十六进制 | 姓名 |
| --- | --- | --- |
| U+200B | e2 80 8b | 零宽度空间 |
| U+200E | e2 80 8e | 从左到右的标记 |
| `U+200F | e2 80 8f | 从右到左的标记 |

[https://www.utf8-chartable.de/unicode-utf8-table.pl?start=8192&number=128](https://www.utf8-chartable.de/unicode-utf8-table.pl?start=8192&number=128)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-01T16:40:44.263

是的，如果您从某个编辑器那里复制它。

简单的解决方案是从编辑器中复制内容并将其粘贴到“记事本”文本编辑器中，因为它不支持 UTF-8 字符。

您会很容易地注意到文本中有错误的字符/文本，例如“%E2%80%8E”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-11-20T06:36:42.890

这些都是不可打印的 ASCII 字符

就像这些都是äÄçÇéÉêöÖÐþúÚ

删除使用此代码

```
function remove_non_ascii(str) {

  if ((str===null) || (str===''))
       return false;
 else
   str = str.toString();

  return str.replace(/[^\x20-\x7E]/g, '');
}

console.log(remove_non_ascii('äÄçÇéÉêHello-WorldöÖÐþúÚ'));
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-18T08:31:07.560

如果您在链接中使用某些字符，WordPress 将显示`%E2%80%8E`而不是那些。例如，如果您在链接中使用半空格（`CTRL + Space`或`CTRL + Shift + 2`），WordPress 会显示`%E2%80%8E`. `-`解决方案：只需在链接中使用 text +

# bash - 基本的shell编程

> ID：10342018
> 
> 赞同：9
> 
> 时间：2012-04-26T21:58:39.500
> 
> 标签：bash, shell, awk

对于 shell 程序员来说，这可能是一个非常基本的问题。但是假设我有一个文本文件 A 和 B 并且 B 是 A 的子集。

我想创建一个包含 (AB) 数据的文本文件 C。

所以省略所有常见的行。

文件中的行是数字数据：比如

```
id , some aspect, other aspec. 
```

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-26T22:00:26.133

使用[`sort`](http://linux.die.net/man/1/sort)和[`uniq`](http://ss64.com/bash/uniq.html)

```
sort a b | uniq -u 
```

如果你想要 A 和 B 之间的线相同，你可以使用`uniq -d`

```
sort a b | uniq -d 
```

这当然假设 A 和 B 中的数据*完全相同*。数据集中不能有任何丢失的空格或制表符。`sed`如果有，您必须先使用、`tr`或清理数据`awk`。

***编辑***

作为彼得。O 指出，如果文件中恰好有完全相同的重复项，这将失败`a`。如果这是一个问题，您可以通过执行以下操作来解决它：

```
sort <(sort -u a) b | uniq -u 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-27T01:55:25.623

有一个名为的实用程序[`comm`](http://man.cx/comm)仅用于此目的：

```
comm -23 A B > C 
```

where`-2`的意思是“拒绝文件 B 独有的行”（你说没有），`-3`意思是“拒绝两个文件共有的行”。

@BartonChittenden 提出了一个很好的观点：

```
comm -23 <(sort A) <(sort B) > C 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-26T22:19:20.140

一种使用方式`awk`。重定向以将内容保存在任何文件中，而不是`STDOUT`.

```
awk 'FNR == NR { data[ $0 ] = 1; next } FNR < NR { if ( $0 in data ) { next } print $0 }' fileB fileA 
```

* * *

**更新**了更有效的命令。感谢**彼得.O**：

```
awk 'FNR==NR{data[$0]; next}; $0 in data{next}; 1' fileB fileA 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-09T11:22:00.263

```
awk 'FNR==NR{a[$0];next}(!($0 in a))' B A 
```

# c++ - 声明一个对象数组：实例化它们

> ID：10342019
> 
> 赞同：0
> 
> 时间：2012-04-26T21:58:48.047
> 
> 标签：c++, arrays, oop

为什么 C++ 以这样的方式创建，如果你有一个类 A 并且你声明了一个类型为 A 的数组，那么整个数组就会被用该类的默认构造函数实例化的对象填充？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:00:50.750

因为当您创建给定大小的数组时，数组的每个元素必须在创建后立即有效。

如果您想要不同的行为，您可以使用`vector`and `push_back`。一个向量被创建为空；当你想添加一个新元素时， push_back 将获取一个以你想要的方式创建的对象，并在向量中复制它。

# c# - NHibernate Criteria 限制与数据库执行的 SHA1？

> ID：10342022
> 
> 赞同：2
> 
> 时间：2012-04-26T21:58:56.957
> 
> 标签：c#, mysql, nhibernate

是否可以转换这种查询：

```
SELECT field1, field2 FROM table WHERE SHA1(field1 + field2) = 'hash'; 
```

进入 NHibernate 的 Criteria 语言？例如，类似：

```
session.CreateCriteria<Car>()
    .Add(Expression.Eq("SHA1(field1 + field2)", "hash")); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:21:10.240

也许这个答案对你有用？

[https://stackoverflow.com/a/797243](https://stackoverflow.com/a/797243)

我会尝试类似的东西：

```
ISQLFunction sqlAdd = new VarArgsSQLFunction("(", "+", ")");
var concat = Projections.SqlFunction(sqlAdd, NHibernateUtil.String, Projections.Property("ObjectProperty1"), Projections.Property("ObjectProperty2"));
var sha1 = Projections.SqlFunction("SHA1", NHibernateUtil.String, concat);
...
session.CreateCriteria<Car>().Add(Expression.Eq(sha1, "hash")); 
```

# android - 如何以编程方式仅删除 android WebView 中的离线模式缓存？

> ID：10342030
> 
> 赞同：3
> 
> 时间：2012-04-26T21:59:33.810
> 
> 标签：android, android-webview, offline-caching, offline-mode

我正在尝试删除我的离线模式（在 cache.manifest 中定义）文件，而不删除任何 WebSQL 数据库或本地存储数据。

我一直在尝试删除缓存文件，并使用 stackoverflow 和其他地方的相关答案来使用以下方法的答案删除 WebView 缓存：

[Android Webview - Completely Clear the Cache](https://stackoverflow.com/questions/2465432/android-webview-completely-clear-the-cache) which states to手动删除`Context.getCacheDir();` FWIW中的文件，我注意到使用更简单的方法会产生相同的结果（这是一个不被接受的答案）`WebView.clearCache(true);`：。这种方法确实会删除未包含在 cache.manifest 中的缓存文件。

我还使用了其他多个提到使用的地方描述的技术

```
deleteDatabase("webview.db");
deleteDatabase("webviewCache.db"); 
```

对我的离线模式文件没有影响。我已经可验证地删除了 webview.db，但奇怪的是，我从未见过使用`Context.databaseList()`.

（顺便说一句，我对删除 webview.db 持怀疑态度，因为我注意到在删除 webview.db 后发生崩溃，并在下次打开我的应用程序时尝试将文本粘贴到输入字段中。似乎需要采取一些防御措施至少针对某些应用程序围绕该技巧进行编程

```
android.database.sqlite.SQLiteException: no such table: formurl: , while compiling: SELECT _id FROM formurl WHERE (url == ?)
    at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
    at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:64)
    at android.database.sqlite.SQLiteProgram.compileSql(SQLiteProgram.java:146)
    at android.database.sqlite.SQLiteProgram.compileAndbindAllArgs(SQLiteProgram.java:367)
    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:130)
    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:94)
    at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:46)
    at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:47)
    at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1539)
    at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1419)
    at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1375)
    at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1455)
    at android.webkit.WebViewDatabase.getFormData(WebViewDatabase.java:1150)
    at android.webkit.WebView$RequestFormData.run(WebView.java:4493)
    at java.lang.Thread.run(Thread.java:1020) 
```

)

我还使用了应用程序设置页面中的“清除缓存”按钮，对离线模式文件没有影响。应用程序设置页面上的“清除数据”按钮确实删除了离线模式文件，但也删除了其他所有内容，包括我的 WebSQL 数据库和本地存储密钥。我也不知道如何以编程方式模仿“清除数据”按钮，这也很有用，尽管不是我正在寻找的答案。

重申一下，关键是这些方法似乎都不够。我想要做的是删除我离线模式缓存的 JS/HTML/CSS 并保留所有通过 Android WebView 创建的 WebSQL db 文件和本地存储密钥。

我正在查看我的网络服务器日志，这样我就可以准确地知道我的应用程序何时请求文件。

# excel - 更改宏的默认图标

> ID：10342032
> 
> 赞同：3
> 
> 时间：2012-04-26T21:59:36.927
> 
> 标签：excel, excel-2007, openxml, excel-2010

任何宏的默认图标，无论是添加到快速访问工具栏还是功能区，看起来都是这样的：![宏图标](../Images/77533148b7146df8f5aaf80afc02918a.png). 有没有办法在将其分配给按钮之前对其进行更改？也许通过编辑加载项的 .xlam 文件中的**customUI.xml**（将其重命名为 .zip 文件后）？**customUI.xml**允许您在 Excel 选项中不可见的 2400 个隐藏图标中进行选择，这就是使该文件变得有趣的原因（更多信息[在这里](http://blogs.office.com/b/microsoft-excel/archive/2009/07/17/add-buttons-to-the-quick-access-toolbar-and-customize-button-images.aspx)和[这里](http://www.rondebruin.nl/ribbon.htm)）。

请注意，我不想更改默认宏图标，只更改**我**的宏的默认图标，以便将其与其他图标区分开来。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T00:38:57.577

在 Excel 2010 中，您需要转到文件 ->

并执行以下操作![宏](../Images/c339e69c2d847eac47c1dd629d1f442d.png)

# css - iPad垂直输入滑块

> ID：10342034
> 
> 赞同：0
> 
> 时间：2012-04-26T21:59:37.577
> 
> 标签：css, slider

我正在使用 jQuery UI 创建一个垂直输入范围滑块（[确切地说是这种样式](http://jqueryui.com/demos/slider/#slider-vertical)）。
我宁愿使用像 Zepto 这样更轻量级的框架，当然也可以使用原生 JS 来创建这个滑块。

我的具体用例仅适用于 iPad (iOS 4.3+)，因此只需要 webkit-support。CSS3 样式`<input type="range" />`不是一个选项，因为它不能在垂直方向上设置样式，并且`rotate(90deg)`在 iOS 上的行为不正确。此外，iOS 4.3 根本不支持它。

谁能指出我更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:51:00.310

这可能是你所追求的：

[https://stackoverflow.com/a/8696975/1170982](https://stackoverflow.com/a/8696975/1170982)

我不确定 rotate3d 变换在 iOS 中的行为如何不正确 - 我自己从未遇到任何问题，但您也可以将“vertical-slider”值应用于变换：

```
-webkit-appearance: slider-vertical; 
```

这是一个小预览：

[http://jsfiddle.net/pSfSx/](http://jsfiddle.net/pSfSx/)

# wcf - 集群 MSMQ 和 WCF

> ID：10342036
> 
> 赞同：0
> 
> 时间：2012-04-26T21:59:46.740
> 
> 标签：wcf, msmq, cluster-computing

不确定这属于哪个区域，但认为所有 3 个标签都是合适的。

设想：

使用事务性 MSMQ 的集群环境（即 1 个集群中的 3 台计算机）使用 WCF 服务从队列中读取消息。

在这种情况下，当消息进入队列并将其传递给 WCF 进行处理时会发生什么？它会同时在所有 3 台计算机上处​​理该 1 条消息吗？还是只有一台电脑？

我想确保如果一个节点出现故障，另一个节点会启动并继续，但同时要确保消息没有被多次处理（即那里有 3 台计算机并且它被处理了 3 次）

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T08:56:19.753

如果一条消息到达具有三个客户端的队列，则只有一个客户端会使用该消息。

为了提供您想要的冗余类型，有必要多播您的消息。这意味着每个客户端都有自己的输入队列，并且您向所有队列发送完全相同的消息。

# ios - 为什么通过 UIImagePickerController 高和中设置选择的视频会在结果中产生相同的质量属性？

> ID：10342037
> 
> 赞同：6
> 
> 时间：2012-04-26T21:59:46.740
> 
> 标签：ios, uiimagepickercontroller, resolution, videoquality

为什么选择使用 UIImagePickerController 高和中视频质量设置的视频会导致完全相同的视频属性，至少在 iPhone4 和 iPad3 等设备上是这样？

细节：

我们使用 UIImagePickerController 让我们的应用用户从照片库中选择图像或视频，然后将它们传输到他们的服务器。我们让用户选择视频质量的高、中或低，我们直接映射到 UIImagePickerControllerQualityTypeHigh、UIImagePickerControllerQualityTypeMedium 和 UIImagePickerControllerQualityTypeLow videoQuality 常量。

当使用相机在我们的应用程序之外拍摄的 10 秒左右的视频被挑选并在 3GS（iOS 5.0）上发送时，我们会看到每种质量设置的明显差异，例如：

*   低：226KB，144x192，编解码器：AAC H.264
*   中：1.1MB，360x480，编解码器：AAC H.264
*   高：480x640 时 5MB，编解码器：AAC H.264

当我们在 iPhone4 或 iPad3 上尝试相同的操作时（我们碰巧有这些设备；不确定它是否只发生在这些设备上）我们看到低设置产生了等效的低分辨率结果，但高和中设置给出了相同的结果我们得到相同的结果，如下所示：

*   低：194KB，144x192，编解码器：AAC H.264
*   中：2.87MB，720x1280，编解码器：AAC H.264
*   高：720x1280 时为 2.87MB，编解码器：AAC H.264

（请注意，中等和高结果是相同的。）

该设备的原始文件为 12.8 MB，720x1280，编解码器：AAC H.264，比特率更高。

任何人都可以解释这里发生了什么吗？我希望能够向我们的客户解释它，甚至更好地指出 Apple 文档中涵盖此内容的内容。

在此先感谢您的帮助...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T06:58:00.423

视频质量设置仅适用于捕获视频而不是从视频选择器中选择它们。该设置清楚地列在下面的捕获设置部分下。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html)

您可以使用下面的代码以原始形式导出视频。只需传递所选视频的 URL 值，该函数将返回导出视频的路径。

```
+(NSString*) videoAssetURLToTempFile:(NSURL*)url
{
    NSString * surl = [url absoluteString];
    NSString * ext = [surl substringFromIndex:[surl rangeOfString:@"ext="].location + 4];
    NSTimeInterval ti = [[NSDate date]timeIntervalSinceReferenceDate];
    NSString * filename = [NSString stringWithFormat: @"%f.%@",ti,ext];
    NSString * tmpfile = [NSTemporaryDirectory() stringByAppendingPathComponent:filename];

    NSURL *outputURL = [NSURL fileURLWithPath:tmpfile];

    AVURLAsset *asset = [AVURLAsset URLAssetWithURL:url options:nil];
    AVAssetExportSession *exportSession = [[AVAssetExportSession alloc] initWithAsset:asset presetName:AVAssetExportPresetHighestQuality];
    exportSession.outputURL = outputURL;
    exportSession.shouldOptimizeForNetworkUse = YES;
    exportSession.outputFileType = AVFileTypeQuickTimeMovie;
    [exportSession exportAsynchronouslyWithCompletionHandler:^(void) 
    {
        NSLog(@"Export Complete %d %@ %@", exportSession.status, exportSession.error, outputURL);
        [exportSession release];
    }];

    return tmpfile;
} 
```

# javascript - 如果用户已经登录 FB，如何阻止我的 Facebook 登录弹出窗口出现？

> ID：10342041
> 
> 赞同：1
> 
> 时间：2012-04-26T22:00:05.470
> 
> 标签：javascript, facebook, ruby-on-rails-3, omniauth

我有一个“使用 Facebook 登录”按钮，该按钮会生成一个弹出窗口，要求用户输入 FB 凭据。

如果用户已经加入我的应用程序，离开应用程序然后返回（同时仍登录 Facebook），我希望用户能够单击“使用 Facebook 登录”而不显示弹出窗口。

目前，鉴于上述段落中的情况，弹出窗口会打开一秒钟，然后页面重定向到应用程序的登录状态。

我已经在下面实现了以下代码 - 在 Javascript 方面我是一个完全的菜鸟，所以虽然答案可能很明显，但我不知道该怎么做！

```
window.fbAsyncInit = function() {
     FB.init({
       appId  : '372191216164729',
       status : true, // check login status
       cookie : true, // enable cookies to allow the server to access the session
       xfbml  : true  // parse XFBML
     });
   };

   (function(d) {
     var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     d.getElementsByTagName('head')[0].appendChild(js);
   }(document));

   $(function() {
     $('#fb_connect').click(function(e) {
       e.preventDefault();

       FB.login(function(response) {                    
         if (response.authResponse) {
           // $('#connect').html('Connected! Hitting OmniAuth callback (GET /auth/facebook/callback)...');

                    //this might not be the best way to do this ...
                    $('#welcome_form').submit();
           // since we have cookies enabled, this request will allow omniauth to parse
           // out the auth code from the signed request in the fbsr_XXX cookie
           // $.getJSON('/auth/facebook/callback', function(json) {
           //             $('#connect').html('Connected! Callback complete.');
           //             $('#results').html(JSON.stringify(json));
           //           });
         }
       }, { scope: 'email, read_stream' });
     });
   }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T22:26:44.887

当页面加载时，在您加载并初始化 fb sdk 后，使用*[FB.getLoginStatus](http://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)*方法检查用户状态。如果用户已经登录并授权您的应用程序，那么响应应该包含访问令牌、用户 ID 等。

例如：

```
FB.getLoginStatus(function(response) {
    if (response.status === "connected") {
        // use the response.authResponse
    }
    else if (response.status === "not_authorized") {
        FB.login(function(response) {
            ...
        }, { scope: "email, read_stream" });
    }
    else {
        // user not logged in to facebook
    }
}); 
```

# objective-c - 在 Xcode 中，如何链接动态库 (libcurl) 以便该应用程序也可以在旧版本的 Mac OS 上运行？

> ID：10342046
> 
> 赞同：11
> 
> 时间：2012-04-26T22:00:34.953
> 
> 标签：objective-c, xcode, macos, libcurl, dylib

我在 OS 10.7 Lion 上构建和编译的 Mac 项目中使用 libcurl。我可以很好地链接到动态库，使用其他链接器标志中的 -lcurl 选项或将库添加到我的项目中。一切都按预期进行。

我希望该应用程序也可以在 OS 10.6 和 10.5 上运行。我相应地设置了部署目标。当我在其中一个操作系统版本中运行应用程序时，我收到一个 dyld 错误：

未加载库：/usr/lib/libcurl.4.dylib 原因：库版本不兼容：X 需要 7.0.0 或更高版本，但 libcurl.4.dylib 提供 6.0.0 版本。

Mac OS 10.5 也有类似的问题。

如何在 Mac OS 10.7 上的 Xcode 中链接系统的 libcurl 库，以便应用程序也可以在 10.6 和 10.5 上运行？

我看过几个选项：

1.  一种是更改 Base SDK，如这篇文章中所建议的那样： [Mac OS X libcurl dylib 兼容版本](https://stackoverflow.com/questions/6363993/mac-os-x-libcurl-dylib-compatibility-version)如果我这样做，则应用程序可以正常工作。但这不是我的选择。我必须使用 10.7 SDK，因此不能接受回退到旧版本的 SDK。

2.  我已经尝试使用其他链接器标志中的 -weak_library /usr/lib/libcurl.dylib 选项对库进行弱链接。应用程序启动但当我尝试引用 libcurl 符号时崩溃。但是，我知道不兼容的代码不是问题，因为当我更改 Base SDK 时它可以工作。

3.  我尝试使用 dlopen("libcurl.dylib", RTLD_LOCAL|RTLD_LAZY); 在代码中动态加载库 该库似乎已加载，但我必须手动绑定我引用的所有符号？

肯定有办法做到这一点。libcurl 库安装在 Mac OS 10.5、10.6 和 10.7 上，但应用程序无法在旧版本的 Mac OS 上使用可用的库。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T00:26:58.687

一些选项：

*   从 libcurl 切换到 Mac 框架 API（CFNetwork、NSURLConnection 等）
*   使用您的应用程序构建和打包您自己的 libcurl 版本，而不是依赖系统库。
*   从 SDK 中复制或符号链接与您的部署目标相对应的存根库，并使用显式路径链接到它。

# devise - 将 facebook 登录添加到 spree 1.0.x

> ID：10342053
> 
> 赞同：0
> 
> 时间：2012-04-26T22:01:00.283
> 
> 标签：devise, omniauth, spree

我正在使用 spree 1.0.3 和 rails 3.1.4。我记得一年前搜索这个，使用设计和omniauth似乎相当容易。但是，我似乎找不到任何我之前找到的关于如何做到这一点的具体教程。此外，还进行了重大修订（spree 1.0、omniauth 1.0），所以我不确定任何旧教程的有效性（似乎没有任何新教程）。我在 github 中看到 spree_social 插件，但这似乎仍处于早期测试阶段。

我看到[rails dog 演示网站](http://demo.spreecommerce.com/login)有 facebook 登录，但我不知道他们用什么来创建它。

**可设计的omniauth 在spree 1.0 中仍然可行吗？如果是这样，那里有任何演示或源代码吗？如果没有，是否有任何选项可以像 devise/omniauth 与 spree 一样平滑地集成到社交媒体登录？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:05:25.443

齐伦，

我相信[https://github.com/spree/spree_social](https://github.com/spree/spree_social)正在用于演示。它应该完成您需要做的大部分事情。

# playframework - 如何访问scala模板中的请求对象

> ID：10342054
> 
> 赞同：4
> 
> 时间：2012-04-26T22:01:11.640
> 
> 标签：playframework

我有一个用@With 标记的控制器

```
@With(InitPages.class)
public class Application extends Controller {

    public static Result index() {

        return ok(mainpage.render());
        //return ok(index.render("Your new application is ready."));
    }

} 
```

这个 InitPages 类正在执行以下操作：

```
public class InitPages extends Action.Simple {

    public Result call(Http.Context ctx) throws Throwable {

        List<CustomPage> pages = CustomPage.find.all();
        ctx.args.put("pages", pages);

        Logger.info("Calling action for " + ctx);
        return delegate.call(ctx);
    }
} 
```

我想将“pages”变量放在scala模板中，正确的做法是什么？Play Framework 在其文档中描述它应该这样做，因此将对象放在请求映射中，但是我如何在 scala 模板中显示它？

我尝试了不同的版本：

```
@for(page <- request.pages) {
   <li class="parent"> <a href="#sds"> @page.title </a> </li>
} 
```

和

```
@for(page <- pages) {
   <li class="parent"> <a href="#sds"> @page.title </a> </li>
} 
```

但没有运气 [http://www.playframework.org/documentation/2.0/JavaActionsComposition](http://www.playframework.org/documentation/2.0/JavaActionsComposition)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T09:32:05.490

我没有使用过 Play 2.0 的 Java 版本，只使用了 Scala，但有几个地方我觉得你可能有错误（我可能错了）：

*   通常请求对象（除非您以某种方式对其进行了扩展，如果是，请附上代码），没有“页面”成员。你可能想调用方法`get("pages")`
*   页面已添加到 Context，但您尝试从请求中检索它。它们是等价的吗？您是否以某种方式复制了数据？或者您需要做的是访问 Response 对象？

# asp.net - ASP.Net MVC3 Azure - 我需要会员提供程序存储过程吗？

> ID：10342055
> 
> 赞同：4
> 
> 时间：2012-04-26T22:01:16.510
> 
> 标签：asp.net, asp.net-mvc-3, azure, membership-provider

我正在使用 Azure 作为数据库存储创建我的第一个 ASP.Net MVC3 应用程序。有许多很棒的教程，但我目前正在使用这个： [演练：在 Windows Azure 上托管 ASP.NET Web 应用程序](http://msdn.microsoft.com/en-us/library/windowsazure/hh694045%28v=vs.103%29.aspx)

我已将连接字符串连接到 Azure，并且工作正常。我在调试模式下运行应用程序并通过成员资格提供程序“注册”我的第一个用户。根据演练，“创建帐户会导致 ASP.NET 创建成员数据库。” 成功！我现在看到表（用户、角色、...）已在我的 Azure 数据库中创建。伟大的！

**为什么我很困惑**：很多年前，当我使用 Membership Provider 进行 ASP.Net 2.0 时，我使用 aspnet_regsql.exe 来运行 Membership Provider 所需的所有脚本。我知道他们有一套更新的[Azure 脚本](http://archive.msdn.microsoft.com/KB2006191)。这些脚本会创建所有表，但也会创建大量存储过程（例如 aspnet_Membership_CreateUser）

**我的问题**：我是否需要运行这些更新的 Azure 脚本来获取 SP？我没有看到在我的数据库中创建了任何存储过程，但没有它们，所有成员资格提供程序功能似乎都可以正常工作。所有这些存储过程是用来做什么的？我的 MVC3 Azure 应用程序中是否需要它们？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T00:07:43.363

您实际上应该使用[ASP.NET Universal Providers For SqlExpress 1.1](http://nuget.org/packages/System.Web.Providers)。这是官方支持的跨 SQL Azure 和独立 SQL Server 启用 SQL 成员资格、角色和会话提供程序的方法。Universal Providers 应该会自动为您创建必要的 SQL 对象，因此您不必手动运行任何脚本。

这里有几个链接供参考：

[Scott Hanselman - 介绍 System.Web.Providers](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx)

[SQL Azure 团队博客 - 使用 SQL Azure 处理会话状态](http://blogs.msdn.com/b/sqlazure/archive/2010/08/04/10046103.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T07:31:36.827

由于您正在学习该教程，因此您已经在使用 ASP.NET 通用提供程序。本教程中的一个步骤将通用提供程序添加为 NuGet 包。有关 NuGet 的更多信息，您可以参考[http://nuget.codeplex.com/](http://nuget.codeplex.com/)。Nuget 包本质上是一些预先编写的代码，可简化您的开发。例如，通用提供商会根据您的连接字符串自动创建成员数据库表。您当然可以继续手动创建数据库表，然后使用内置的 ASP.NET 成员资格提供程序。

# c# - c# Threadpool - 限制线程数

> ID：10342057
> 
> 赞同：26
> 
> 时间：2012-04-26T22:01:33.670
> 
> 标签：c#, multithreading, threadpool

我正在开发一个控制台应用程序。

我想使用 Threadpool 来执行网络下载。这是一些假代码。

```
 for (int loop=0; loop< 100; loop++)
 {
     ThreadPool.QueueUserWorkItem(new WaitCallback(GetPage), pageList[loop]);
 }

snip

private static void GetPage(object o)
{
    //get the page
} 
```

如何防止我的代码同时启动两个以上（或十个，或其他）线程？

我试过了

```
 ThreadPool.SetMaxThreads(1, 0);
    ThreadPool.SetMinThreads(1, 0); 
```

但它们似乎没有影响。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-04-27T02:22:41.780

我会使用`Parallel.For`并`MaxDegreeOfParallelism`相应地设置。

```
Parallel.For(0, 1000, new ParallelOptions { MaxDegreeOfParallelism = 10 },
  i =>
  {
    GetPage(pageList[i]);
  }); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-11-10T11:33:06.143

只需从以下代码反转该代码：

```
ThreadPool.SetMaxThreads(1, 0);
ThreadPool.SetMinThreads(1, 0); 
```

到：

```
ThreadPool.SetMinThreads(1, 0);
ThreadPool.SetMaxThreads(1, 0); 
```

您不能将 MaxThread 设置为小于 MinThread

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-26T22:08:45.567

就个人而言，我会使用[SmartThreadPool](http://www.codeproject.com/Articles/7933/Smart-Thread-Pool)并单独保留 ThreadPool。但是，这可能是您想要的：[C# thread pool limited threads](https://stackoverflow.com/questions/444627/c-sharp-thread-pool-limiting-threads)

链接中包含的代码（请注明原作者，而不是我）

```
System.Threading.Semaphore S = new System.Threading.Semaphore(3, 3);  
try 
{     
  // wait your turn (decrement)     
  S.WaitOne();     
  // do your thing 
}  
finally 
{     
  // release so others can go (increment)     
  S.Release(); 
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-26T22:03:13.780

### 描述

您可以使用该`ThreadPool.SetMaxThreads`方法执行此操作。

但是使用 ThreadPool for WebRequest 存在一些问题。例如，阅读[这个（ThreadPool 或 HttpWebRequest 中的错误？）](http://bytes.com/topic/net/answers/46984-bug-threadpool-httpwebrequest)

### 样本

```
ThreadPool.SetMaxThreads(2,2); 
```

## 编辑

我个人会为此使用 AsParallel from `Linq`。

### 更多信息

*   [MSDN - ThreadPool.SetMaxThreads 方法](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.setmaxthreads.aspx)
*   [MSDN - ParallelEnumerable.AsParallel 方法](http://msdn.microsoft.com/en-us/library/system.linq.parallelenumerable.asparallel.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-26T22:55:07.390

查看ThreadPool.SetMaxThreads的参数。第一个参数是工作线程的数量，第二个参数是异步线程的数量，也就是你说的那个。

在文档的下方，它说：

> 您不能将工作线程数或 I/O 完成线程数设置为小于计算机中处理器数的数字。

听起来您正在尝试将 ThreadPool 用于不打算用于的事情。如果您想限制下载量，请创建一个为您管理的类，因为 ThreadPool 不一定是您问题的完整解决方案。

我建议在 ThreadPool 中启动两个线程并等待回调的类。当它接收到一个线程完成的回调时，会排队一个新的线程。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-09-16T21:40:33.333

如果您对 .Net 2.0 很紧张，您可以使用以下技术：

知道您将任务排入队列的事实`ThreadPool`将创建一个新线程（当然，如果没有空闲线程），您将在执行此操作之前等待，直到有一个空闲线程。为此目的，`BlockingCounter`使用该类（如下所述），一旦达到限制，将等待增加，直到有人（另一个线程）减少它。然后它进入“关闭”状态，表示不会完成新的增量并等待完成。

以下示例显示最多 4 个任务，总数为 10。

```
class Program
{

    static int s_numCurrentThreads = 0;

    static Random s_rnd = new Random();

    static void Main(string[] args)
    {

        int maxParallelTasks = 4;
        int totalTasks = 10;

        using (BlockingCounter blockingCounter = new BlockingCounter(maxParallelTasks))
        {
            for (int i = 1; i <= totalTasks; i++)
            {

                Console.WriteLine("Submitting task {0}", i);
                blockingCounter.WaitableIncrement();
                if (!ThreadPool.QueueUserWorkItem((obj) =>
                                                      {
                                                          try
                                                          {
                                                              ThreadProc(obj);
                                                          }
                                                          catch (Exception ex)
                                                          {
                                                              Console.Error.WriteLine("Task {0} failed: {1}", obj, ex.Message);
                                                          }
                                                          finally
                                                          {
                                                              // Exceptions are possible here too, 
                                                              // but proper error handling is not the goal of this sample
                                                              blockingCounter.WaitableDecrement();
                                                          }
                                                      }, i))
                {
                    blockingCounter.WaitableDecrement();
                    Console.Error.WriteLine("Failed to submit task {0} for execution.", i);
                }
            }

            Console.WriteLine("Waiting for copmletion...");
            blockingCounter.CloseAndWait(30000);
        }

        Console.WriteLine("Work done!");
        Console.ReadKey();

    }

    static void ThreadProc (object obj)
    {
        int taskNumber = (int) obj;
        int numThreads = Interlocked.Increment(ref s_numCurrentThreads);

        Console.WriteLine("Task {0} started. Total: {1}", taskNumber, numThreads);
        int sleepTime = s_rnd.Next(0, 5);
        Thread.Sleep(sleepTime * 1000);
        Console.WriteLine("Task {0} finished.", taskNumber);

        Interlocked.Decrement(ref s_numCurrentThreads);
    } 
```

它使用基于[此处](https://stackoverflow.com/a/530228/725903)发布的 Marc Gravell 的 SizeQueue 的 BlockingCounter 类，但没有计数器而不是队列。当您结束排队新线程时，调用 Close() 方法，然后等待它完成。

```
public class BlockingCounter : IDisposable
{
    private int m_Count;
    private object m_counterLock = new object();

    private bool m_isClosed = false;
    private volatile bool m_isDisposed = false;

    private int m_MaxSize = 0;

    private ManualResetEvent m_Finished = new ManualResetEvent(false);

    public BlockingCounter(int maxSize = 0)
    {
        if (maxSize < 0)
            throw new ArgumentOutOfRangeException("maxSize");
        m_MaxSize = maxSize;
    }

    public void WaitableIncrement(int timeoutMs = Timeout.Infinite)
    {
        lock (m_counterLock)
        {
            while (m_MaxSize > 0 && m_Count >= m_MaxSize)
            {
                CheckClosedOrDisposed();
                if (!Monitor.Wait(m_counterLock, timeoutMs))
                    throw new TimeoutException("Failed to wait for counter to decrement.");
            }

            CheckClosedOrDisposed();
            m_Count++;

            if (m_Count == 1)
            {
                Monitor.PulseAll(m_counterLock);
            }

        }
    }

    public void WaitableDecrement(int timeoutMs = Timeout.Infinite)
    {
        lock (m_counterLock)
        {
            try
            {
                while (m_Count == 0)
                {
                    CheckClosedOrDisposed();
                    if (!Monitor.Wait(m_counterLock, timeoutMs))
                        throw new TimeoutException("Failed to wait for counter to increment.");
                }

                CheckDisposed();

                m_Count--;

                if (m_MaxSize == 0 || m_Count == m_MaxSize - 1)
                    Monitor.PulseAll(m_counterLock);
            }
            finally
            {
                if (m_isClosed && m_Count == 0)
                    m_Finished.Set();
            }
        }
    }

    void CheckClosedOrDisposed()
    {
        if (m_isClosed)
            throw new Exception("The counter is closed");
        CheckDisposed();
    }

    void CheckDisposed()
    {
        if (m_isDisposed)
            throw new ObjectDisposedException("The counter has been disposed.");
    }

    public void Close()
    {
        lock (m_counterLock)
        {
            CheckDisposed();
            m_isClosed = true;
            Monitor.PulseAll(m_counterLock);
        }
    }

    public bool WaitForFinish(int timeoutMs = Timeout.Infinite)
    {
        CheckDisposed();
        lock (m_counterLock)
        { 
             if (m_Count == 0)
                 return true;
        }
        return m_Finished.WaitOne(timeoutMs);
    }

    public void CloseAndWait (int timeoutMs = Timeout.Infinite)
    {
        Close();
        WaitForFinish(timeoutMs);
    }

    public void Dispose()
    {
        if (!m_isDisposed)
        {
            m_isDisposed = true;
            lock (m_counterLock)
            {
                // Wake up all waiting threads, so that they know the object 
                // is disposed and there's nothing to wait anymore
                Monitor.PulseAll(m_counterLock);
            }
            m_Finished.Close();
        }
    }
} 
```

结果将是这样的：

```
Submitting task 1
Submitting task 2
Submitting task 3
Submitting task 4
Submitting task 5
Task 1 started. Total: 1
Task 1 finished.
Task 3 started. Total: 1
Submitting task 6
Task 2 started. Total: 2
Task 3 finished.
Task 6 started. Total: 4
Task 5 started. Total: 3
Task 4 started. Total: 4
Submitting task 7
Task 4 finished.
Submitting task 8
Task 7 started. Total: 4
Task 5 finished.
Submitting task 9
Task 7 finished.
Task 8 started. Total: 4
Task 9 started. Total: 4
Submitting task 10
Task 2 finished.
Waiting for copmletion...
Task 10 started. Total: 4
Task 10 finished.
Task 6 finished.
Task 8 finished.
Task 9 finished.
Work done! 
```

# grails - Jboss 7 Blocks 日志记录上的 Grails 项目

> ID：10342058
> 
> 赞同：0
> 
> 时间：2012-04-26T22:01:39.417
> 
> 标签：grails, logging, jboss7.x

我有一个 grails 项目，我正试图让我的公司正常工作。我们让项目在 Jboss 4.2.3 上顺利运行，但升级到 Jboss 7 会导致问题。当我在 jboss 7 的部署文件夹中使用另一个耳朵项目部署 grails 战争时，Jboss 在部署过程中停止记录。grails 战争和 ear 项目都正确部署，但日志记录不起作用。即使在部署之后，当我运行可从 ear 项目获得的 web 服务时，webservice 方法也可以正常运行，但我添加到 webservice 方法中的日志不会显示在日志中。如果我停止服务器并删除 grails 项目并重新启动它并运行相同的 webservice 方法，所有的日志记录都会显示出来，所有应该在部署期间显示的日志记录也会显示出来。

我没有在涉及类加载器问题的日志中看到任何错误。请有人给我一块骨头！

真挚地，

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T01:05:41.503

我认为您需要编辑 Jboss 配置，这通常是一个 xml 文件。

请参阅[JBoss AS7 日志记录](https://community.jboss.org/wiki/JBossAS7Logging)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T16:58:08.527

听起来您可能正在覆盖日志记录。您是否有一些代码正在删除日志处理程序或类似的东西？虽然我怀疑这不是问题，但有一些[日志记录文档。](https://docs.jboss.org/author/display/AS71/Logging+Configuration)看起来确实有些东西可能正在清除日志处理程序。

# matlab - 具有自定义阈值的舍入数字

> ID：10342060
> 
> 赞同：4
> 
> 时间：2012-04-26T22:01:50.797
> 
> 标签：matlab, rounding

如果超过阈值（不是 0.5），我希望能够向上“四舍五入”一个数字，否则向下舍入。

这是我想出的一些糟糕的代码。matlab 中是否有为此的内置函数，或者更优雅的解决方案（可能是矢量化的）？

```
function [ rounded_numbers ] = custom_round( input_numbers, threshold )
%CUSTOM_ROUND rounds between 0 and 1 with threshold threshold

  [input_rows, input_cols] = size(input_numbers);
  rounded_numbers = zeros(input_rows, input_cols);

  for i = 1:length(input_numbers)
    if input_numbers(i) > threshold
      rounded_numbers(i) = 1;
    else
      rounded_numbers(i) = 0;
    end
  end
end 
```

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-27T11:57:16.867

只需使用

```
round(x - treshold + 0.5) 
```

测试用例：

```
>> x = -10:0.3:10
ans =
    -2   -1.7  -1.4  -1.1  -0.8  -0.5  -0.2  0.1    0.4   0.7    1    1.3   1.6   1.9

>> treshold = 0.8; % round everything up for which holds mod(x,1) >= treshold
>> y = round(x-treshold+0.5)

ans =
    -2    -2    -2    -1    -1    -1    -1     0     0     0     1     1     1     2 
```

负数也可以正确舍入，但边界除外：-0.8 舍入为 -1 而不是 0，但这与 round 通常具有的行为相同：round(-0.5) 返回 -1

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T22:11:21.477

这是一个解决方案，如果数字已超过阈值，我们会从零舍入

```
in = [0.2,-3.3,4.1];
th = 0.2;

%# get the fractional part of the number
frac = mod(in,1); %# positive for negative in

%# find the sign so we know whether to round
%# to plus or minus inf
sig = sign(in);

%# identify which way to round
upIdx = frac>th; %# at threshold, we round down

%# round towards inf if up
out = abs(in);
out(upIdx) = ceil(out(upIdx));
out(~upIdx) = floor(out(~upIdx));
%# re-set the sign
out= out.*sig
out =
 0    -4     4 
```

注意：如果数字只在 0 和 1 之间，那就更简单了：

```
%# this does exactly what your code does
out = double(in>th); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T22:44:32.637

这应该适用于任何数字，而不仅仅是介于 0 和 1 之间。阈值必须在 [0,1) 范围内。

我没有用负数测试过。

```
function [result] = custom_round( num, threshold )

if ( threshold < 0 ) || ( threshold >= 1 )
  error( 'threshold input must be in the range [0,1)' );
end

fractional = num - floor( num );
idx1 = fractional > threshold;
idx2 = fractional <= threshold;
difference = 1 - fractional;
result = num + ( difference .* idx1 ) - ( fractional .* idx2 );

end 
```

测试

```
>> custom_round( [0.25 0.5 0.75 1], 0.3 )
ans =
     0     1     1     1

>> custom_round( [0.25 0.5 0.75 1], 0.8 )
ans =
     0     0     0     1

>> custom_round( [10.25 10.5 10.75 11], 0.8 )
ans =
    10    10    10    11 
```

# svn - 检查本地路径中存储库的 svn 状态

> ID：10342067
> 
> 赞同：0
> 
> 时间：2012-04-26T22:02:57.363
> 
> 标签：svn

是否有命令检查给定的本地路径是否是给定存储库的工作副本？

我需要检查一个文件夹是否已经包含 repo 的工作副本，如果有，我将运行更新，如果没有，我将清除文件夹的内容，然后进行结帐。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:04:41.280

是的，只需运行

```
svn info 
```

在有问题的目录中。这将告诉您该目录是工作副本的存储库（如果有）。浏览此处获取更多信息：

[http://svnbook.red-bean.com/en/1.1/re13.html](http://svnbook.red-bean.com/en/1.1/re13.html)

# iphone - 使用没有阻塞 UI 的 NSXMLParser 和 NSOperation

> ID：10342068
> 
> 赞同：0
> 
> 时间：2012-04-26T22:03:03.033
> 
> 标签：iphone, ios, nsxmlparser, uisearchbar, nsoperation

我有一个搜索栏并从 Internet 搜索一些信息，然后从 url 启动一个 NSXMLParser，然后显示在 UITableView 中解析的信息，但在此过程中 UI 被阻止，如果我想取消搜索以进行另一个搜索，我可以't 而且我必须等待解析器完成，所以我的问题是如果它是正确的解决方案，我如何在另一个线程上执行，然后在必要时中止搜索以进行另一个搜索？...我知道 NSOperation 类但是然后这个类如何将信息提供给表格视图以显示数据？......以及我如何中止操作以执行另一个操作？

现在我这样做是为了进行搜索：

```
 [self performSelector:@selector(request:) withObject:searchText afterDelay:0.7]; 
```

然后是请求方法，在另一个类中开始使用 NSXMLParser 进行搜索...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:42:13.120

为避免阻塞 UI，您可以使用

`[self performSelectorInBackground:@selector(request:) withObject:text];`

我对 NSOperation 的工作不多，但是从文档中，看起来您可以为操作设置一个完成块，您可以在其中调用类似

`[self performSelectorOnMainThread:@selector(populateMyTable) withObject:nil waitUntilDone:NO];`

此外，NSOperation 有一个实例方法`cancel`，它似乎可以提供您正在寻找的东西，只要中止您的搜索方法。

# javascript - 检查文件是否存在于不同的服务器上

> ID：10342071
> 
> 赞同：4
> 
> 时间：2012-04-26T22:03:36.943
> 
> 标签：javascript

我需要查看文件是否存在于另一台服务器上。因此，如果我调用[http://www.someotherserver.com/index.html](http://www.someotherserver.com/index.html)如果页面存在则返回 true，否则返回 false。我试了一下：

```
 $.ajax({
        type: 'HEAD',
        url: 'http://localhost/HTMLPage1.htm',
        success: function () {
        },
        error: function () {
            alert("Unable to connect to secure checkout.");
            return false;
        }
    }); 
```

但它每次都返回一个错误。我在想可能是因为跨域脚本。有谁知道如何使这项工作或有一种可行的方法？

谢谢！

* * *

## 回答 #1

> 赞同：-6
> 
> 时间：2012-07-30T08:18:49.603

只需在您的代码中设置`crossDomain`为，如下所示：`true`

```
 $.ajax({
        type: 'HEAD',
        url: 'http://localhost/HTMLPage1.htm',
        crossDomain: true,
        success: function () {
        },
        error: function () {
            alert("Unable to connect to secure checkout.");
            return false;
        }
    }); 
```

# python - 如果我使用 render_to_response，我是否需要一个 HttpRequest 对象？

> ID：10342074
> 
> 赞同：0
> 
> 时间：2012-04-26T22:04:17.210
> 
> 标签：python, django, http, authentication

Django 告诉我我的登录视图没有返回 HttpResponse 对象：

```
The view accounts.views.login didn't return an HttpResponse object. 
```

但是，我在`render_to_response()`任何地方都在使用，并且视图无法在没有得到响应的情况下完成解析。这是代码：

```
def login(request):
    if request.method == 'POST':
        form = LoginForm(request.POST)
        if form.is_valid():
            username = request.POST['username']
            password = request.POST['password']
            user = authenticate(username=username, password=password)
            if user is not None:
                if user.is_active:
                    auth_login(request, user)
                    render_to_response('list.html')
                else:
                    error = "It seems your account has been disabled."
                    render_to_response('list.html', {'error': error})
            else:
                error = "Bad login information. Give it another go."
                render_to_response('list.html', {'error': error})
        else:
            error = "Bad login information. Give it another go."
            render_to_response('list.html', {'error': error})
    else:
        error = "Whoa, something weird happened. You sure you're using the form on our site?"
        render_to_response('list.html', {'error': error}) 
```

我确信代码可以更高效（更少的渲染），但这应该有效，对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T22:07:24.713

你错过了**回报**

```
return render_to_response('list.html', {'error': error}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T23:43:38.490

您需要返回 render_to_response 的响应。我还建议您进行一些代码改进：

```
def login(request):
    if request.method == 'POST':
        form = LoginForm(request.POST)
        if form.is_valid():
            username = request.POST['username']
            password = request.POST['password']
            user = authenticate(username=username, password=password)
            if user is not None:
                if user.is_active:
                    auth_login(request, user)
                    return render_to_response('list.html')
                else:
                    error = "It seems your account has been disabled."
            else:
                error = "Bad login information. Give it another go."
        else:
            error = "Bad login information. Give it another go."
    else:
        error = "Whoa, something weird happened. You sure you're using the form on our site?"
    return render_to_response('list.html', {'error': error}) 
```

# python - 在 PyQt4 中向 MPL 图添加工具栏

> ID：10342078
> 
> 赞同：3
> 
> 时间：2012-04-26T22:04:35.820
> 
> 标签：python, matplotlib, pyqt4

我有一个非常简单的 pyqt4 应用程序，它嵌入了一个 MatPlotLib 图。我通过 MatplotlibWidget 嵌入 matplotlib 图，并通过 QtDesigner 和 pyuic4 创建了[界面](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/designer.html)。

我想为用户提供[对交互式导航工具栏的](http://matplotlib.sourceforge.net/users/navigation_toolbar.html)访问权限。但是，尽管他们在 GTK 上有很好的例子，但我似乎无法让它为 pyQt 工作。它提到了示例，但[提供的 QT4 示例](http://matplotlib.sourceforge.net/examples/user_interfaces/embedding_in_qt4.html)不包括工具栏。

我很感激这方面的任何帮助。

* * *

[这个问题](https://stackoverflow.com/questions/10133478/how-to-programmatically-select-pan-zoom-in-pyqt-matplotlib-navigation)很相似，但并没有完全解决我的需求，而且我无法适应它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T01:19:33.190

QtDesigner 中没有工具栏小部件，但可以通过代码添加工具栏：

这是示例，`plot_layout`是`QVBoxLayout`由 QtDesigner 设计的，`plot_canvas`是`MatplotlibWidget`小部件。

```
import numpy as np
from PyQt4.QtCore import Qt
from PyQt4.QtGui import *
from matplotlib.backends.backend_qt4 import NavigationToolbar2QT as NavigationToolbar
from plot_dialog2 import Ui_Form

class PlotDialog(QWidget, Ui_Form):
    def __init__(self):
        QWidget.__init__(self)
        self.setupUi(self)
        self.navi_toolbar = NavigationToolbar(self.plot_canvas, self)
        self.plot_layout.addWidget(self.navi_toolbar)

if __name__ == "__main__":
    import sys
    app = QApplication(sys.argv)
    dialog = PlotDialog()
    dialog.show()
    sys.exit(app.exec_()) 
```

# java - 无法将 Scala 类导入我的 Java 代码

> ID：10342079
> 
> 赞同：1
> 
> 时间：2012-04-26T22:04:39.643
> 
> 标签：java, scala

我尝试过了

> 导入 com.twitter.finagle.service.RetryPolicy$；

但是蚂蚁抱怨它找不到符号。我的图书馆里确实有这个类：

```
com/twitter/finagle/service/RetryPolicy$$anon$1.class
com/twitter/finagle/service/RetryPolicy$.class
com/twitter/finagle/service/RetryPolicy$$anonfun$backoffJava$1.class
com/twitter/finagle/service/RetryPolicy.class
com/twitter/finagle/service/RetryPolicy$$anonfun$1.class 
```

不过，我可以在没有美元符号的情况下导入课程。有一些我没有弄清楚的scala魔法吗？谢谢！

> 导入 com.twitter.finagle.service.RetryPolicy；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:05:45.610

你确定你没有因为依赖 RetryPolicy$ 需要解决而收到错误？

你能包括实际的错误信息吗？

# ios - Xcode 调试不遵循线路进展，优化关闭

> ID：10342081
> 
> 赞同：0
> 
> 时间：2012-04-26T22:04:50.740
> 
> 标签：ios, xcode, debugging

我正在尝试在我的应用程序中调试特定函数，但发现它很棘手，因为局部变量没有显示出来，代码执行也没有逐行进行。相反，它似乎有点跳跃，我的许多本地范围变量在调试区域中不可见。

该函数是从*assetForURL* **结果**块调用的。

我希望在优化时会出现一些这种行为，但我将它们关闭并遇到同样的问题。这是一些代码，以防万一这可能是原因。

```
{
UIImageView* newImage = [[tvVC imageViewArray] objectAtIndex:viewIndex];
UIImageView* oldImage = [[tvVC imageViewArray] objectAtIndex:((viewIndex + 1) % 2)];

[newImage setImage:image];
[newImage setBounds:CGRectMake(0, 0, image.size.width, image.size.height)];         
[newImage setTransform:CGAffineTransformMakeScale(scalar * minScalar, scalar * minScalar)];
CGPoint adjust = [scrollView contentOffset];
CGPoint curCenter = [oldImage center];
NSLog(@" offset %f, %f   center %f, %f",adjust.x, adjust.y, curCenter.x, curCenter.y);
} 
```

让我丧命的是 NSLog 打印了有效的结果，但是如果我尝试逐步执行，我实际上无法手动检查*adjust*或*curCenter*元素。

使用 Apple LLVM 3.1 编译

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T13:55:53.870

一个周末的假期和新鲜的头脑有助于解决这个问题。

最后，我切换到 GDB 调试而不是 LLDB。这导致了一个更有用的错误消息，“变量被编译器优化掉”。我想即使优化关闭，编译器也会摆脱那些并不真正需要的愚蠢变量。（我添加它们只是为了让我更清楚地调试，我意识到它们对于代码来说不是必需的）

一旦确定，我只是将*调整*和*curCenter*确定为“不稳定”，问题就解决了。我仍然看到代码执行中的一些跳跃，但我将其归结为其他优化

# javascript - javascript中字符串中的Javascript代码

> ID：10342082
> 
> 赞同：-1
> 
> 时间：2012-04-26T22:04:51.437
> 
> 标签：javascript, multiline

如何在变量中保存 javascript 代码，我这样做了，但没有成功：

```
var reportD = '<html><head>';
reportD = reportD + '<script type="text/javascript" src="http://www.google.com/jsapi"></script>';
reportD = reportD + '<script type="text/javascript">';
reportD = reportD + 'google.load("visualization", "1", {packages: ["corechart"]});';
reportD = reportD + '</script>';
reportD = reportD + '<script type="text/javascript">';
reportD = reportD + 'function drawVisualization() {';
reportD = reportD + 'var data = google.visualization.arrayToDataTable([["x", "Cats", "Blanket 1", "Blanket 2"],["N",1,0.5,1]]);';
reportD = reportD + 'new google.visualization.LineChart(document.getElementById("visualization")).';
reportD = reportD + 'draw(data, {curveType: "function",width: 500, height: 400,vAxis: {maxValue: 10}});';
reportD = reportD + '}google.setOnLoadCallback(drawVisualization);';
reportD = reportD + "</script>";
reportD = reportD + '</head>';
reportD = reportD + '<body style="font-family: Arial;border: 0 none;">';
reportD = reportD + '<div id="visualization" style="width: 500px; height: 400px;"></div>';
reportD = reportD + '</body></html>'; 
```

我想这样做，以便将这些代码注入 iframe 元素

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:08:58.763

`script>`标签内的字符串/注释/任何内容可能不包含`</script>`. 使用转义正斜杠`\`，它应该可以工作（即`<\/script>`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:12:35.020

写你的html（记事本/你的ide），复制它转到

> [http://accessify.com/tools-and-wizards/developer-tools/html-javascript-convertor/](http://accessify.com/tools-and-wizards/developer-tools/html-javascript-convertor/)

粘贴到您的 html 中，转换为 JS 变量。

# erlang - 为什么 erlang io:format 输出丢失，我需要做什么来恢复它？

> ID：10342085
> 
> 赞同：4
> 
> 时间：2012-04-26T22:05:06.247
> 
> 标签：erlang, format, gen-server

我正在编写一个 gen_server，我们将称之为 gen_server_db，它并没有什么特别之处。它使用的库 (emysql) 有可能在尝试查找数据库服务器时遇到连接失败（在 gen_server_db:init() 中）。当我捕捉到异常并尝试将某些内容打印到控制台时，我得到了 zip。在下面的代码示例中，两个 io:format 消息都无法到达控制台。我似乎记得很久以前听到过这个的原因，但我不记得为什么。

```
init(Args) ->
    % I've condensed the way I actually get this stuff to one line, but if I have a
    % database online I connect properly, so I know that I'm getting the Host, User, etc.  
    {Host, User, Password, DB, PoolSize} = application:get_env(gen_server_db, config),

    init_mysql_connection(gen_server_db_pool, PoolSize, User, Password, Host, DB),

    % When the net connection to the db is down, I never get here.
    ok.

init_mysql_connection(bgo_db_pool, PoolSize, User, Password, Host, DB) ->
    try
        emysql:add_pool(bgo_db_pool, PoolSize, User, Password, Host, 3306, DB, utf8)
    catch
        exit:failed_to_connect_to_database ->
            io:format("Cannot connect to the mysql database server.  Retrying in 1 sec.~n"),
            timer:sleep(1000),
            init_mysql_connection(bgo_db_pool, PoolSize, User, Password, Host, DB);
        Error:Reason ->
            io:format("Database connection error: ~p:~p~n", [Error, Reason]),
            1/0
    end. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T08:27:43.707

通过 io:format 发送的所有 I/O 都发送到正在运行的进程的当前[group_leader](http://www.erlang.org/doc/man/erlang.html#group_leader-0)。然后这个进程负责使用 io:fwrite 打印消息。

如果您只想在编码时转储一些调试信息，您可以使用 erlang:display/1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T15:50:59.653

我建议您使用 error_logger 模块而不是 io:format。io:format 将消息输出到 tty 控制台，一个标准输出。如果您的 gen_server 由控制台启动，您将看到这些消息，但是，如果您的服务器以分离模式启动，您将永远不会看到这些消息。

这是一本手册，您需要启动 SASL。

```
http://www.erlang.org/doc/man/error_logger.html 
```

在您的配置文件中，您需要为此日志定义输出文件。

```
....
{sasl, [{sasl_error_logger, {file,"/tmp/sasl_error.log"}},{errlog_type, all}]}
.... 
```

# asp.net-mvc-3 - 什么是 ASPNET GUID？

> ID：10342086
> 
> 赞同：-4
> 
> 时间：2012-04-26T22:05:09.093
> 
> 标签：asp.net-mvc-3, guid

我在 Music Store MVC3 教程的 ShoppingCart 类中看到了这段代码：[http ://www.asp.net/mvc/tutorials/mvc-music-store](http://www.asp.net/mvc/tutorials/mvc-music-store)

```
// We're using HttpContextBase to allow access to cookies.
        public string GetCartId(HttpContextBase context)
        {
            if (context.Session[CartSessionKey] == null)
            {
                if (!string.IsNullOrWhiteSpace(context.User.Identity.Name))
                {
                    context.Session[CartSessionKey] =
                        context.User.Identity.Name;
                }
                else
                {
                    // Generate a new random GUID using System.Guid class
                    Guid tempCartId = Guid.NewGuid();
                    // Send tempCartId back to client as a cookie
                    context.Session[CartSessionKey] = tempCartId.ToString();
                }
            }
            return context.Session[CartSessionKey].ToString();
        } 
```

为什么需要 GUID？我要求有人解释它在这个例子中的用途。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:07:38.583

搜索“C# GUID”会让您得到一个简单的答案：[MSDN](http://msdn.microsoft.com/en-us/library/system.guid.aspx)。

GUID*表示全局唯一标识符*，它与 ASP.NET MVC 无关。

请在发布问题之前检查文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T04:33:53.743

Have a look at [part 8](http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-8) of that tutorial, under the heading "Managing the Shopping Cart business logic" - this explains the purpose of that code.

Basically, the GUID is used to uniquely identify a user, without forcing them to have logged in, so that the application can keep track of items that they have put into the shopping cart.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T22:07:07.947

GUID 是全局唯一标识符。请参阅以下维基百科条目：

[http://en.wikipedia.org/wiki/Globally_unique_identifier](http://en.wikipedia.org/wiki/Globally_unique_identifier)

# mysql - 哪种编码使用 mysql 将数据存储在 .MYD 文件中？

> ID：10342090
> 
> 赞同：1
> 
> 时间：2012-04-26T22:05:22.500
> 
> 标签：mysql, utf-8

我知道我可以在 mysql 中设置变量来处理 utf8（客户端、连接、数据库、结果、服务器和系统）。事实上，我将它们全部设置为 utf8（文件系统除外）。但是，当我在 mysql 文件夹的数据目录（使用 textwrangler）中打开*sometable* .MYD 文件时，它说文本编码是西方（Mac OS 罗马），并显示奇怪的字符而不是西班牙口音。当我通过 mysqldump 将数据库导出到某个*.sql*文件并使用 TextEdit 打开它时，那些奇怪的字符会传递给该文件（即使我将 --default-character-set 设置为 utf8）。有没有办法让 mysql 在 .MYD 文件中存储实际的 utf8 字符？如果可能的话，在mysql中处理非ascii字符是一个好习惯吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:20:42.617

要在 mysql 中查看名为 mydb 的数据库，请运行以下命令

```
SHOW CREATE DATABASE mydb; 
```

要在操作系统中查看它，请运行此

```
cd /var/lib/mysql/mydb
cat db.opt 
```

如果表在特定列中具有不同的编码，您可以在 mydb.mytable 中看到它

```
SHOW CREATE TABLE mydb.mytable\G 
```

如果您没有看到任何编码，那么表的默认值应该是数据库的编码

# python - 使用迭代器协议访问排序字典

> ID：10342092
> 
> 赞同：3
> 
> 时间：2012-04-26T22:05:29.000
> 
> 标签：python, dictionary, iterator

我有一个字典'vcomments'，其中的键是非顺序整数。在遍历键时，我需要按排序或反向排序的顺序进行。目前我使用

```
for key_pt in sorted(self.view.vcomments.iterkeys()): 
```

但我还需要找到超出或之前某个数字的那些键（或下一个键）：

```
 if direction == 'down':
        sorted_pts = (key_pt for key_pt in sorted(self.view.vcomments.iterkeys()) if key_pt > curr_pt)
    else:
        sorted_pts = (key_pt for key_pt in reversed(sorted(self.view.vcomments.iterkeys())) if key_pt < curr_pt)
    try:
        next_pt = sorted_pts.next()
    except StopIteration: 
```

1.  我是否可以创建一个迭代器类（使用迭代器协议）来存储字典并使我能够以正向或反向顺序循环它们？我假设/猜测我可能需要首先分配一个属性值，该值将指示下一个循环是否应该是正向/反向。

2.  我可以在我的迭代器类中包含一个生成器函数（嵌套），这将使我能够检索下一个键吗？也就是说，超出或之前提供的整数？

3.  同样，我是否有办法提供起点和终点并检索落在这些值之间的所有键（按排序顺序）？

对于提出三个（尽管相关）问题，我深表歉意——第一个问题的答案会给我一个开始。而且我并没有粗鲁地期待一个完整的解决方案，只是表明这些对我来说是否是可行的目标。

补充：我仍然需要能够通过其键检索单个特定的字典项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T23:02:20.753

我认为满足您需求的最佳数据结构是[跳过列表](http://en.wikipedia.org/wiki/Skip_list)。我从来没有实现过——一直想要——但在我看来，它拥有你需要的所有东西。

1.  跳过列表按排序顺序存储其项目。使基本列表成为双向链表将允许在 O(n) 中进行正向和反向迭代。

2.  跳过列表允许 O(log n) 的插入、修改、删除和搜索。这不像字典那么快，但在我看来，如果你需要按排序顺序存储的项目，字典会给你带来麻烦——甚至是`OrderedDict`，除非你*很少*添加键。

3.  通过上面维基百科文章中描述的一些修改，即使是索引访问也可以在 O(log n) 中实现。

[这里](http://infohost.nmt.edu/tcc/help/lang/python/examples/pyskip/web/index.html)有一个 Python 实现——可能还有其他实现。

但是，您的一些评论表明您可能满足于简单地迭代字典的排序副本，而您只是试图清理上面的代码。所以这是一种解决方法。这很幼稚，但这是一个起点。这假设你对 O(n) 搜索时间和 O(n log n) 迭代时间完全没问题，这都是次优的......

```
>>> class SortIterDict(dict):
...     def __iter__(self):
...         return iter(sorted(super(SortIterDict, self).__iter__()))
...     def __reversed__(self):
...         return reversed(tuple(iter(self)))
...     def get_next(self, n):
...         return next((x for x in iter(self) if x > n), None)
...     def get_prev(self, n):
...         return next((x for x in reversed(self) if x < n), None)
... 
>>> d = SortIterDict({'d':6, 'a':5, 'c':2})
>>> list(d)
['a', 'c', 'd']
>>> list(reversed(d))
['d', 'c', 'a']
>>> d.get_next('b')
'c'
>>> d.get_prev('b')
'a' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T22:26:42.267

首先，你应该注意到你需要一个更好的数据结构。Python dicts 根本没有顺序，`OrderedDict`只是保持插入顺序（因此您需要在每次键更改时重新排序）。一个排序的字典[`blist.sorteddict`](http://stutzbachenterprises.com/blist/sorteddict.html)，甚至一个排序的列表，`blist.sortedlist`可能更适合您的需求。

> 我是否可以创建一个迭代器类（使用迭代器协议）来存储字典并使我能够以正向或反向顺序循环它们？我假设/猜测我可能需要首先分配一个属性值，该值将指示下一个循环是否应该是正向/反向。

您在这里不需要单独的迭代器类。您可以通过内置[`reversed`](http://docs.python.org/library/functions.html#reversed)函数获得免费的前向迭代和后向迭代：

```
for key in mydict:
  # do something

for key in reversed(mydict.keys()):
  # do something 
```

> 我可以在我的迭代器类中包含一个生成器函数（嵌套），这将使我能够检索下一个键吗？也就是说，超出或之前提供的整数？

当然，`itertools`有很多功能可以让你做这样的事情：

```
from itertools import dropwhile, takewhile
# find next key beyond 4
next(dropwhile(lambda x: x <= 4, mydict))
# find last key before 20
next(dropwhile(lambda x: x >= 20, reversed(mydict.keys())) 
```

您还可以将其打包成一个函数：

```
def first_beyond(pivot, seq):
  next(dropwhile(lambda x: x <= pivot, seq))

first_beyond(4, mydict)
first_beyond(20, reversed(mydict.keys())) 
```

> 同样，我是否有办法提供起点和终点并检索落在这些值之间的所有键（按排序顺序）？

您可以轻松地为此构建一个通用工具：

```
from itertools import dropwhile, takewhile
def between(begin, end, seq):
  return takewhile(lambda x: x <= end, 
                   dropwhile(lambda x: x < begin, seq)) 
```

像这样使用：

```
>>> list(between(4, 30, [1,2,4,8,16,32]))
[4, 8, 16] 
```

**编辑：**如果您只需要偶尔检查排序的键，您可以将它们转换为排序列表并使用它们。成语和上面一样：

```
keys = sorted(mydict)

# forward and backward iteration
for k in keys:
  # ...
for k in reversed(keys):
  # ...

# function that returns a forward or backward iterator based on an argument
def forward_or_backward(seq, forward=True):
  for x in (iter if forward else reversed)(seq):
    yield x

# random access inside a loop
for i, key in enumerate(keys):
  # next element
  key[i+1]

# the between and first_beyond functions above also work for lists 
```

您的其余功能可以从这些部分粘合在一起。请注意，创建一个特殊的类是不明智的，因为我们可以以一种足够通用的方式编写函数，以便它们适用于*任何*可迭代的对象，而不仅仅是您的键列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T22:17:03.523

在这种情况下，我倾向于以两种不同的方式存储部分数据。

如果您保留在您的 dict 周围，但添加了一个由 int 索引的列表，该列表会显示您的 dict 的键（r 值？）？这将为您提供您可能需要的随机访问（我假设您有 dict 是有原因的），以及您似乎需要添加的前后行为。

如果你走这条路，你可能会将它全部包装在一个类中，这样你就不会在你的代码中分散双重更新。

采用 treap 或红黑树实现，并对其进行修改以让您指定一个键，并在下一个或前一个键处取回键、值对，这可能是可行的。如果您经常插入或删除值，则其中之一可能会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T22:33:24.907

似乎一个有序的字典可能会给你你想要的。文档在[这里](http://docs.python.org/library/collections.html#collections.OrderedDict)。

# c# - 使用 AForge 对 Kinect 视频进行 C# 图像处理

> ID：10342097
> 
> 赞同：3
> 
> 时间：2012-04-26T22:05:47.400
> 
> 标签：c#, image-processing, kinect, aforge

**我的目标：**
使用 Kinect 视频做形状识别（图片上的大矩形），在图片上绘制矩形以突出显示结果。

**我使用的技术：**

*   C#代码，
*   AForge，更具体地说是它的形状检查器

[http://www.aforgenet.com/articles/shape_checker/](http://www.aforgenet.com/articles/shape_checker/)

**魔法应该如何运作：**

1.  每次帧准备好时，我都会将帧数据作为字节数组获取并将其转换为位图以允许我对其进行分析
2.  应用形状识别算法
3.  渲染结果...

**我的问题：**
到目前为止，整个过程都有效，但是当我尝试在 WPF 图像中渲染结果时，它会严重滞后...（每 10 秒 1 帧）...

**我的代码：**

```
// AllFramesReady is called every time a frame is ready to use...
private void AllFramesReady(object sender, AllFramesReadyEventArgs e)
    {
        using (ColorImageFrame colorFrame = e.OpenColorImageFrame())
        {
            if (colorFrame == null)
            {
                return;
            }

            _Pixels = new byte[colorFrame.PixelDataLength];
            colorFrame.CopyPixelDataTo(_Pixels);

            // Analyze the image

            int stride = colorFrame.Width * 4;
            System.Drawing.Size size = new System.Drawing.Size(colorFrame.Width, colorFrame.Height);
            // get the bitmap from bytes
            Bitmap btmap = BytesToBmp(_Pixels, size);
            //analyze the data...
            btmap = _shapeReco.AnalyzeImage(btmap);

            // copy the new data back to pixels
            _Pixels = BmpToBytes(btmap);

            // rendering the analyzed image
            imageAnalyzed.Source =
                BitmapSource.Create(colorFrame.Width, colorFrame.Height,
                96, 96, PixelFormats.Bgr32, null, _Pixels, stride);
        }
    }

//
// HERE IS MY SHAPE RECOGNIZER THAT IMPLEMENTS THE SHAPE RECOGNITION ALGORITHM
//

using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Imaging;

using AForge;
using AForge.Imaging;
using AForge.Math.Geometry;

namespace KinectSetupDev
{
    class MyShapeRecognizer
    {

        private static String TAG = "MyShapeRecognizer";

        /***************************************************************************
         *                                VARIABLES                                *
         ***************************************************************************/

        private SimpleShapeChecker _ShapeChecker;
        private Bitmap _Image; // the image to analyze
        private Blob[] _Blobs;
        private BlobCounter _BlobCounter;

        /***************************************************************************
         *                              CONSTRUCTOR                                *
         ***************************************************************************/

        public MyShapeRecognizer()
        {
            Debug.Log(TAG, "MyShapeRecognizer");

            _ShapeChecker = new SimpleShapeChecker();
            _Image = new Bitmap(300, 400);
            _Blobs = null;
            _BlobCounter = null;
        }

        /***************************************************************************
         *                                METHODS                                  *
         ***************************************************************************/

        public Bitmap AnalyzeImage(Bitmap image)
        {
            Debug.Log(TAG, "AnalyzeImage");

            this._Image = image;
            this.LocatingObjects();
            this.AnalyzeObjects();

            return _Image;
        }

        private void LocatingObjects()
        {
            Debug.Log(TAG, "LocatingObjects");

            // lock image
            BitmapData bitmapData = _Image.LockBits(
                new Rectangle(0, 0, _Image.Width, _Image.Height),
                ImageLockMode.ReadOnly, _Image.PixelFormat);

            //locating objects
            _BlobCounter = new BlobCounter();

            _BlobCounter.FilterBlobs = true;
            _BlobCounter.MinHeight = 5;
            _BlobCounter.MinWidth = 5;

            _BlobCounter.ProcessImage(bitmapData);
            _Blobs = _BlobCounter.GetObjectsInformation();

            // unlock image
            _Image.UnlockBits(bitmapData);
        }

        private void AnalyzeObjects()
        {
            Debug.Log(TAG, "AnalyzeObjects");

            Graphics g = Graphics.FromImage(_Image);

            [DRAW RECT OR CIRCLE ON GRAPHICS]

            g.Dispose();
        }

        // Conver list of AForge.NET's points to array of .NET points
                                        private System.Drawing.Point[] ToPointsArray(List<IntPoint> points)
    {
        System.Drawing.Point[] array = new System.Drawing.Point[points.Count];

        for (int i = 0, n = points.Count; i < n; i++)
        {
            array[i] = new System.Drawing.Point(points[i].X, points[i].Y);
        }

        return array;
    }

    }
} 
```

我可以提供完整的代码（MV C# 2010 项目...）。我很感激任何帮助！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:26:57.017

嗯，从您上面的评论看来，AForge 代码使事情运行缓慢。据我所知，您有以下选择

1.  （重新）编写 blob 处理以使用 OpenCL（在 CPU 或 GPU 上）来加快速度
2.  使用更快的图像处理库，如[EmguCV](http://www.emgu.com/wiki/index.php/Main_Page)？可能还有很多
3.  如果不需要实时处理，缓冲输入帧并在多个后台线程中尽可能快地处理它们，以尝试尽可能多地吸收延迟。

也许我在这里错过了更多 - 但这些应该让你走上正轨。

# blackberry - WebWorks 应用程序未在 Verizon Bold 9650 上打开

> ID：10342101
> 
> 赞同：0
> 
> 时间：2012-04-26T22:06:34.343
> 
> 标签：blackberry, blackberry-webworks

我已经为此工作了几个小时，但我一生都无法弄清楚为什么这不起作用。我是使用 WebWorks 并为 BlackBerry 开发的新手，所以这可能是一个简单的修复。

我将一个简单的 Hello, World 页面编译为 index.html 并使用以下配置创建了一个 config.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<widget xmlns="http://www.w3.org/ns/widgets"
        xmlns:rim="http://www.blackberry.com/ns/widgets"
        version="1.0.0.0"> 

    <name>Test</name>
    <author>Me</author>
    <description>Testing</description>

    <content src="index.html"/> 

    <feature id="blackberry.ui.dialog"/>
</widget> 
```

我使用 bbwp 打包它，我得到一个没有问题的 .cod 文件。我可以在模拟器上加载这个应用程序，然后页面显示“Hello, World!”。显然，当我在实际设备上加载它时，我收到与访问安全 API 有关的错误。

现在，我尝试使用 bbwp 对其进行签名（我已经使用签名工具设置了我的 .csi 文件），它说它已正确签名并创建了正确的 .cod。我使用 JavaLoader 将它加载到设备上，它看起来好像已正确安装。当我在设备上运行应用程序时，什么也没有发生。没有错误消息，没有弹出任何内容，也没有任何迹象表明正在发生任何事情。签名的 .cod 也可以在模拟器上运行。

黑莓运行 OS 6.0.0.719 并锁定到 Verizon。有谁知道问题可能是什么或我该如何解决？如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:57:13.683

我发现了这个问题。我只安装了三个 .csi 文件之一。这只是对应用程序进行了部分签名，并且不允许应用程序启动。

# asp.net - 命名空间中的不明确引用

> ID：10342104
> 
> 赞同：11
> 
> 时间：2012-04-26T22:06:52.763
> 
> 标签：asp.net, resharper, servercontrols

我有一个服务器控件作为我的程序集中的一个类`MySite`（即，我的站点项目不仅包含 aspx 文件，还包含这些 aspx 文件引用的服务器控件）。我在 aspx 文件中使用以下代码：

```
<%@ Register Assembly="MySite" Namespace="MySite.misc" TagPrefix="TAC" %>
...
<TAC:CustomACM ID="myID" runat="server" /> 
```

该类的代码如下：

```
namespace MySite.misc
{
    public class CustomACM : AutoCompleteExtender, INamingContainer
    {
        //...
    }
} 
```

该站点可以完美运行和编译，但 IntelliSense 在 myID 的子项中中断。更改类和 register 指令中的命名空间以`MySiteSC.misc`解决此问题，尽管 using`MySite.miscSC`没有帮助。在我的解决方案中的其他地方既不使用`MySiteSC`也不使用，并且任何命名空间中都不存在其他类。`miscSC``CustomACM`

ReSharper 用红色下划线“MySite”（即 register 指令中的命名空间的一部分）并带有工具提示，“Register Directive 未使用，可以安全地删除\n 模糊参考。” 禁用 ReSharper 可防止出现此错误，但不能解决问题。

我是否可以在不更改 CustomACM 控件的命名空间（并且不将 CustomACM 控件移动到不同的程序集）的情况下解决此问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-21T11:15:19.787

恕我直言，Resharper 在这里有问题。可以通过清除 ReSharper 的缓存（ReSharper > Options > General > Clear Caches），然后重新启动 VS 并再次构建来解决该问题。该消息应该会消失。我知道，这不是一个真正的解决方案，但它确实有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T02:33:36.263

要使您的控件能够在页面中以声明方式使用，您必须将标记前缀映射到控件的命名空间。

在您的自定义服务器控件项目中，您是否`TagPrefixAttribute`在您的文件 AssemblyInfo.cs 中添加了该属性？

您必须在文件末尾添加此行以创建命名空间和前缀之间的映射。

```
[assembly: TagPrefix("MySite.misc", "TAC")] 
```

在文件开头添加这一行：

```
Using System.Web.UI; 
```

之后，每当您将自定义服务器控件从工具箱拖到 .aspx 页面时，VS 应该会自动添加 Register 指令。

或者，如果您的自定义控件将在 Web 应用程序的多个页面中使用，您可以在 web.config 文件中指定标记前缀/命名空间映射，而不是使用 register 指令。

```
<?xml version="1.0"?>
<configuration>
  <system.web>    
   <pages>
     <controls>
       <add tagPrefix="TAC" Assembly="MySite" 
         namespace="MySite.misc">
       </add>
     </controls>
   </pages>
  </system.web>
</configuration> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T19:44:16.627

检查您的 web.config 文件

```
<assemblies>
...
</assemblies> 
```

部分以查看您是否有对 MySite.misc 的重复引用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-31T07:26:34.190

我通过删除`.suo`-file（[解决方案用户选项（.Suo）文件](http://msdn.microsoft.com/en-us/library/bb165909.aspx)）解决了类似的问题

# java - 如何在java上打开磁铁链接的默认处理程序

> ID：10342109
> 
> 赞同：4
> 
> 时间：2012-04-26T22:07:11.013
> 
> 标签：java

TLDR；如何使用 java 上的默认应用程序打开类似“magnet:?xt=blablablabl”的磁力链接

* * *

我正在开发一个在网站上搜索磁铁链接并打开它的应用程序。目前我正在打开firefox，将磁铁url作为参数传递，但它会留下一个打开的选项卡，如果没有安装firefox，这个方法似乎不适用于chrome（我没有用ie测试过）。我想要的是打开处理磁铁协议的默认应用程序。我知道在 Windows 中我可以从注册表中获取它，在 ubuntu 上我可以调用 xdg-open，但我正在寻找一个更优雅的 java 解决方案或已经这样做的库。有这样的事吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-04T05:08:06.993

由于缺乏更好的解决方案，我自己编写了：
[https](https://github.com/beothorn/URISchemeHandler) ://github.com/beothorn/URISchemeHandler 还添加了对注册新协议处理程序的支持。仍然希望有一种方法可以在不检查正在运行的操作系统的情况下处理此问题。
编辑：
这个标识符的正确名称是 URI 方案，更多细节在[http://en.wikipedia.org/wiki/URI_scheme](http://en.wikipedia.org/wiki/URI_scheme)。

# ruby-on-rails - 缓存带有 Nokogiri 错误的 Youtube API XML 响应 - 编组错误？

> ID：10342113
> 
> 赞同：3
> 
> 时间：2012-04-26T22:07:30.890
> 
> 标签：ruby-on-rails, xml, caching, nokogiri, youtube-api

我想尽量减少对 Youtube API 的调用，因为这些数据不会经常刷新。当我尝试缓存这个时：

```
Rails.cache.fetch("youtube-#{@yt_name}", :expires_in => 1.day) do
  @youtube_doc = Nokogiri::XML(open("https://gdata.youtube.com/feeds/api/users/#{@yt_name}/uploads"))
end 
```

我在heroku中遇到错误：

```
Marshalling error for key 'youtube-NAME': no marshal_dump is defined for class Nokogiri::XML::NodeSet 
You are trying to cache a Ruby object which cannot be serialized to memcached. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T21:56:55.800

您可能想要缓存 XML 而不是 Nokogiri 对象。试试这个：

```
xml = Rails.cache.fetch("youtube-#{@yt_name}", :expires_in => 1.day) do
  open("https://gdata.youtube.com/feeds/api/users/#{@yt_name}/uploads").read
end
@youtube_doc = Nokogiri::XML(xml) 
```

# django - 如何在 Web 服务器上设置 PYTHONPATH

> ID：10342114
> 
> 赞同：4
> 
> 时间：2012-04-26T22:07:35.260
> 
> 标签：django, apache, ubuntu, mod-wsgi

我已经成功运行了一段时间的 Apache 和 PHP，现在也想使用 python。我已经安装了 django 和 mod_wsgi，但仍然没有让它们工作。

我收到类似的错误

```
ImportError: Could not import settings '/srv/django_projects/proj1/settings.py' (Is it on sys.path?): 
```

在我的 apache 日志中。关于设置 PYTHONPATH 的教程似乎需要向网络服务器启动脚本添加一个导出命令，但坦率地说，我不知道我在做什么，所以我想弄清楚发生了什么，以及我应该做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:40:47.017

使用如下所述的虚拟环境：

[http://code.google.com/p/modwsgi/wiki/VirtualEnvironments](http://code.google.com/p/modwsgi/wiki/VirtualEnvironments)

另见：

[http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIPythonPath](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIPythonPath)

和 python-path 选项：

[http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIDaemonProcess](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIDaemonProcess)

您可能使用后者中的哪一个取决于您运行 mod_wsgi 的方式。

所以，有很多可用的文档。

# delphi - 在画布上绘图 - 如何检查鼠标左键是否按下？

> ID：10342117
> 
> 赞同：0
> 
> 时间：2012-04-26T22:07:51.050
> 
> 标签：delphi

我有一个画布，我想像 MS Paint 一样在上面画画。

我尝试了以下方法但没有成功：

**(1)**

Canvas.OnMouseDown

```
procedure TForm1.Image1MouseDown(Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Integer);
begin
       //Draw something (Lets say a rect for example*)
       Image1.Canvas.Rectangle(x,y,x+4,y+4);
end; 
```

**(2)**

我尝试将 Canvas.OnMouseDown 和 Canvas.OnMouseUp 结合起来，如本网站的示例所示：

[http://www.delphipages.com/forum/showthread.php?t=142153](http://www.delphipages.com/forum/showthread.php?t=142153)

**(3)**

GetAsyncKeyState：

[http://msdn.microsoft.com/en-us/library/ms646293%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms646293%28VS.85%29.aspx)检测鼠标按下

**(4)**

Mouse.IsDraging 函数。

我尝试过的上述方法仍然无法取得任何成功。

每次我想拖动光标并绘制它时，只需在我第一次单击的位置放置 1 个 Rect*，我如何让它逐步绘制？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T22:19:28.690

您需要跟踪您是否正在拖动鼠标（左键按下），保存起点的位置，并在`OnMouseUp`事件中画线。（这不会完全满足您的要求，因为它不会显示您的线条将出现的位置，也不会清除您之前绘制的任何线条。您需要在 中跟踪这些线条`OnMouseMove`。不过，它应该可以帮助您入门.)

```
unit Unit2;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Vcl.Graphics,
  Controls, Forms, Dialogs;

type
  TForm2 = class(TForm)
    procedure FormMouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure FormMouseMove(Sender: TObject; Shift: TShiftState; X, Y: Integer);
    procedure FormMouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
  private
    { Private declarations }
    Drawing: Boolean;
    mX, mY: Integer;
  public
    { Public declarations }
  end;

var
  Form2: TForm2;

implementation

{$R *.dfm}

procedure TForm2.FormMouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  if [ssLeft] = Shift then
  begin
    Drawing := True;
    mX := X;
    mY := Y;
  end;
end;

procedure TForm2.FormMouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  if Drawing and not (ssLeft in Shift) then  // Left button released
  begin
    Canvas.MoveTo(mX, mY);
    Canvas.LineTo(X, Y);
    Drawing := False;
  end;
end;

end. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T22:13:45.590

在 MouseDown 中，设置一个布尔值来表示它的向下并存储鼠标的位置。InMouseMove 如果鼠标从上一个位置向下绘制到当前位置，则存储当前位置。在 MouseUp 中重置布尔值

无论如何，一种方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-27T10:39:12.940

我会这样做的方式是这样的：

```
var
  Form1: TForm1;

  IsDrawing: Boolean; // flag to determine if drawing or not

implementation

{$R *.dfm}

procedure DoPaint(ACanvas: TCanvas; X, Y: Integer; AColor: TColor;
  ASize: Integer; AStyle: TPenStyle; Persistent: Boolean);
begin
  with ACanvas do
  begin
    Pen.Color := AColor;
    Pen.Style := AStyle;
    Pen.Width := ASize;

    if not Persistent then
      MoveTo(X, Y);
    LineTo(X, Y);
  end;
end;

procedure TForm1.FormMouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  case Button of
    mbLeft:
    begin
      IsDrawing := True;
      DoPaint(Form1.Canvas, X, Y, clBlue, 10, psSolid, False);
    end;
  end;
end;

procedure TForm1.FormMouseMove(Sender: TObject; Shift: TShiftState; X,
  Y: Integer);
begin
  if (GetAsyncKeyState(VK_LBUTTON) <> 0) and
     (IsDrawing) then
  begin
    DoPaint(Form1.Canvas, X, Y, clBlue, 10, psSolid, True);
  end;
end;

procedure TForm1.FormMouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  IsDrawing := False;
end; 
```

这里需要注意的两件事是 MouseMove 事件和 GetAsyncKeyState。您使用了 MouseDown 和 MouseUp，但是继续绘图需要 MouseMove。

MouseMove 事件将跟踪画布上的移动。显然，如果你要开始的话，你只需要画画。要处理这个问题，你可以设置一个简单的布尔标志，正如我所演示的那样`IsDrawing`- 当你在画布上 MouseDown 时设置为 True，当你在画布上 MouseUp 时设置为 False。

与您一起使用该`IsDrawing`标志`GetAsyncKeyState`现在可以确定是否继续在画布上绘图。如 MSDN 文章中所述，您需要注意`GetAsyncKeyState`仅跟踪物理按钮布局，而不是逻辑按钮布局：

> GetAsyncKeyState 函数适用于鼠标按钮。但是，它会检查物理鼠标按钮的状态，而不是物理按钮映射到的逻辑鼠标按钮。例如，调用 GetAsyncKeyState(VK_LBUTTON) 始终返回物理鼠标左键的状态，无论它是映射到逻辑鼠标左键还是逻辑鼠标右键。您可以通过调用 GetSystemMetrics(SM_SWAPBUTTON) 确定系统当前物理鼠标按钮到逻辑鼠标按钮的映射。
> 
> 如果鼠标按钮已被交换，则返回 TRUE。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-29T19:55:46.113

如果您需要排队代码：

```
procedure TForm1.img1MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  (Sender as TImage).Canvas.MoveTo(X, Y);
end;

procedure TForm1.img1MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  (Sender as TImage).Canvas.LineTo(X, Y);
end; 
```

或者，如果您需要免费绘制线条，请使用：

```
procedure TForm1.img1MouseMove(Sender: TObject; Shift: TShiftState; X,
  Y: Integer);
begin
  with (Sender as TImage) do begin
    if Shift = [ssLeft] then
      Canvas.LineTo(X, Y);
    Canvas.MoveTo(X, Y);
  end;
end; 
```

# eclipse - 集成tomcat和eclipse但无法测试servlet？

> ID：10342123
> 
> 赞同：0
> 
> 时间：2012-04-26T22:08:45.963
> 
> 标签：eclipse, apache, tomcat, eclipse-wtp

我关注了几个链接，但在部署 servlet 页面时仍然遇到问题。

**参考链接：** [http ://www.ibm.com/developerworks/opensource/library/os-eclipse-tomcat/index.html](http://www.ibm.com/developerworks/opensource/library/os-eclipse-tomcat/index.html)

**任务完成：** 1\. 能够将tomcat Apache 7.x 与Eclipse 集成[添加服务器] 2\. 创建JSP 页面以检查当前日期和时间[创建示例页面] 3\. 部署JSP 页面[部署页面]

**问题：** 1\. 使用包名“de.vogella.wtp.filecounter”和类名“HelloServlet.java”创建服务器。

***下面提到：*** 重新启动现在出现在 Tomcat 服务器旁边的状态列中。要重新启动服务器，请在“服务器”视图中右键单击服务器，然后选择重新启动 > 启动。打开浏览器并导航到**[http://localhost:8080/de.vogella.wtp.filecounter/HelloServlet](http://localhost:8080/de.vogella.wtp.filecounter/HelloServlet)**（其中 de.vogella.wtp.filecounter 是您的动态 Web 项目的名称）。

**错误：** ![在此处输入图像描述](../Images/c387b4a62978a681e1cca3596ace832f.png)

**解决方案：**

正如巴鲁斯所说，工作完美

进口 ：

```
import javax.servlet.annotation.WebServlet; 
```

在类声明之前和 IMPORT 之后添加：

```
@WebServlet("/hello") 
```

结果 ：

![在此处输入图像描述](../Images/1c7f2d1006ecbd732607c9bd880f438b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:13:23.543

此错误表示 URL 错误或 servlet 未映射到`web.xml`. 它应该与in 中`<url-pattern>`指定的 servlet匹配。`<servlet-mapping>``web.xml`

如果是例如

```
<url-pattern>/hello</url-pattern> 
```

并且您的项目的上下文路径确实是`de.vogella.wtp.filecounter`（虽然奇怪的上下文路径）：

> [http://localhost:8080/de.vogella.wtp.filecounter/hello](http://localhost:8080/de.vogella.wtp.filecounter/hello)

或者，由于您已经在使用 Tomcat 7，您也可以只使用新的`@WebServlet`注解，这样您就不需要再摆弄`web.xml`了。在 servlet 类上添加以下注解：

```
@WebServlet("/hello") 
```

这会将 servlet 映射到`/hello`.

### 也可以看看：

*   [我们的 servlets wiki 页面](https://stackoverflow.com/tags/servlets/info)- 也包含一些 hello world 示例（并且比那些旧的 IBM/Vogella 教程更新）

# xcode4 - 如何在 OS X 上强制 _al_mangled_main 的“默认”可见性？

> ID：10342128
> 
> 赞同：1
> 
> 时间：2012-04-26T22:09:19.450
> 
> 标签：xcode4, xcode4.3, allegro, allegro5

我遇到了与下面链接中询问的人相同的错误。已经有答案了，但我该怎么做呢？谢谢你的帮助

[https://stackoverflow.com/a/5294039/1333847](https://stackoverflow.com/a/5294039/1333847)

*编辑1）* **这是代码：**

```
#include "allegro5/allegro.h"
#include "allegro5/allegro_image.h"
#include "allegro5/allegro_native_dialog.h"

int main(){

   ALLEGRO_DISPLAY *display = NULL;
   ALLEGRO_BITMAP  *image   = NULL;

   if(!al_init()) {
      al_show_native_message_box(display, "Error", "Error", "Failed to initialize allegro!", 
                                 NULL, ALLEGRO_MESSAGEBOX_ERROR);
      return 0;
   }

   if(!al_init_image_addon()) {
      al_show_native_message_box(display, "Error", "Error", "Failed to initialize al_init_image_addon!", 
                                 NULL, ALLEGRO_MESSAGEBOX_ERROR);
      return 0;
   }

   display = al_create_display(800,600);

   if(!display) {
      al_show_native_message_box(display, "Error", "Error", "Failed to initialize display!", 
                                 NULL, ALLEGRO_MESSAGEBOX_ERROR);
      return 0;
   }

   image = al_load_bitmap("image.png");

   if(!image) {
      al_show_native_message_box(display, "Error", "Error", "Failed to load image!", 
                                 NULL, ALLEGRO_MESSAGEBOX_ERROR);
      al_destroy_display(display);
      return 0;
   }

   al_draw_bitmap(image,200,200,0);

   al_flip_display();
   al_rest(2);

   al_destroy_display(display);
   al_destroy_bitmap(image);

   return 0;
} 
```

**这些是错误：**

```
Undefined symbols for architecture x86_64:
  "_al_show_native_message_box", referenced from:
      __al_mangled_main in main.o
  "_al_init_image_addon", referenced from:
      __al_mangled_main in main.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

*编辑2）*记录此代码[链接到代码](http://wiki.allegro.cc/index.php?title=Allegro_5_Tutorial/Displays)一切正常

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T01:54:02.470

Allegro 5 是模块化的。经验法则是，如果您使用的是`#include <allegro5/allegro_...>`，那么您需要与相应的库链接。在你的情况下：

`_al_show_native_message_box`: 链接`-lallegro_native_dialog`

`_al_init_image_addon`: 链接`-lallegro_image`

# objective-c - 从 Cocoa（OSX，不是 iPhone）WebView 仅加载 Safari 中的指定链接？

> ID：10342135
> 
> 赞同：0
> 
> 时间：2012-04-26T22:10:45.597
> 
> 标签：objective-c, macos, webview

我在这里找到了几篇文章，解释了如何在 Safari（或默认浏览器）中打开嵌入式 WebView 中的*所有*链接，但我找不到任何关于如何在 Safari 中仅打开您选择的链接的信息，而默认情况下，它们将加载到 WebView 中。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T11:25:42.323

您实际上可以在默认浏览器中加载您单击的链接。

为此，您必须实施`WebPolicyDecisionListener`协议并`policyDelegate`设置`WebView`：

```
[webView setPolicyDelegate:self]; 
```

然后实现以下方法：

```
-(void)webView:(WebView *)webView decidePolicyForNavigationAction:(NSDictionary *)actionInformation request:(NSURLRequest *)request frame:(WebFrame *)frame decisionListener:(id<WebPolicyDecisionListener>)listener
    {

        if (WebNavigationTypeLinkClicked == [[actionInformation objectForKey:WebActionNavigationTypeKey] intValue])
        {
            [listener ignore];
            NSLog(@"Opening URL in browser:%@",[request URL]);
            [[NSWorkspace sharedWorkspace] openURL:[request URL]];

        }    
        [listener use];
    }

-(void)webView:(WebView *)webView decidePolicyForNewWindowAction:(NSDictionary *)actionInformation request:(NSURLRequest *)request newFrameName:(NSString *)frameName decisionListener:(id <WebPolicyDecisionListener>)listener
    {
        if (WebNavigationTypeLinkClicked == [[actionInformation objectForKey:WebActionNavigationTypeKey] intValue])
        {
            [listener ignore];
            NSLog(@"Opening URL new window:%@",[request URL]);
            [[NSWorkspace sharedWorkspace] openURL:[request URL]];
        }
        [listener ignore];
    } 
```

您单击的此链接将在 [request URL] 处接收到此委托方法

# c# - Entity Framework 3.0 和 Helper 类

> ID：10342145
> 
> 赞同：0
> 
> 时间：2012-04-26T22:11:57.787
> 
> 标签：c#, .net, entity-framework

我在类库中使用静态帮助程序类，例如使用 LINQ 过滤掉某些实体。我传递了 ObjectContext 和我想要过滤的参数。问题是 ObjectContext 被破坏了。

例如：

```
Users u = EntityHelper.GetUsersOfCertainAge(ObjectContext, 24);
ObjectContext.SaveChanges(); 
```

用户列表将正确填充，但程序将在 时崩溃`ObjectContext.SaveChanges()`，即使没有进行任何更改。我根本无法保存更改，即使在进行更改的情况下也是如此。

我得到“空引用异常”和 DateTime 溢出等。似乎一个空对象最终出现在 ObjectContext 中，所以当我尝试保存时，它违反了数据库中的各种约束。我不知道为什么，我在 Helper 类中所做的只是使用 LINQ 过滤 ObjectContext 中的一些列表并返回结果。

你们知道什么可能导致这种腐败，如果方法完全错误/坏或者是否有好的选择？创建一个新的上下文后记是可行的，但感觉就像一个黑客。

示例（存储在单独的类库中，在静态类中）：

```
public static User GetFirstUserOfCertainAge(Entities ctx, int inputAge)
{
    return ctx.Users
        .Where(x => x.Age == inputAge)
        .OrderByDescending(x => x.Created)
        .FirstOrDefault();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:45:58.390

问题是我创建了一个测试用户，其中一个测试用户复杂属性是从 ObjectContext 中获取的，这显然导致该测试用户间接也属于 ObjectContext（有点奇怪）。当我保存时，它也试图保存这个测试用户。无论如何，确保不要在此测试用户属性中设置与 ObjectContext 相关的任何复杂类型解决了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:15:45.280

我建议使用这样的东西作为其清洁剂的替代品：

```
public static IQueriable<User> FilterByAge(this IQueriable<User> users, int inputAge)
{
    return users
        .Where(x => x.Age == inputAge)
        .OrderByDescending(x => x.Created);
} 
```

用途：

```
User u = ctx.Users.FilterByAge(24).FirstOrDefault(); 
```

就错误而言，您当前使用的方法应该可以与 EF 一起正常工作（尽管上面的内容更干净/流畅）。我敢打赌，问题在于您的上下文范围不太正确。您能否也发布获取/处理上下文的位？

# scala - 如何在 Play 2 中指定复杂的表单验证？

> ID：10342151
> 
> 赞同：10
> 
> 时间：2012-04-26T22:12:50.813
> 
> 标签：scala, playframework, playframework-2.0

我了解如何在 Play 2 中添加简单的表单验证，例如`nonEmptyText`，但我将如何实现更复杂的验证，例如“必须定义至少一个字段”？目前，如果我的模型对象被所有`None`s 初始化，我会在它中抛出一个异常，但这会产生一个令人讨厌的错误消息。我希望在表单页面上收到一条友好的错误消息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T19:41:43.847

您可以在表单定义中嵌套`mappings`/并在映射、子映射、元组和子元组上添加规则。然后在您的模板中，您可以使用特定字段或一组字段检索错误。`tuples``verifying``form.errors("fieldname")`

例如 ：

```
val signinForm: Form[Account] = Form(
    mapping(
        "name" -> text(minLength=6, maxLength=50),
        "email" -> email,
        "password" -> tuple(
            "main" -> text(minLength=8, maxLength=16),
            "confirm" -> text
        ).verifying(
            // Add an additional constraint: both passwords must match
            "Passwords don't match", password => password._1 == password._2
        )
    )(Account.apply)(Account.unapply)
) 
```

如果您有两个不同的密码，则可以使用以下方法检索模板中的错误`form.errors("password")`

*在此示例中，您必须自己编写`Account.apply`并`Account.unapply`处理`(String, String, (String, String))`*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-09T19:56:13.973

我已经改进了@kheraud 接受的答案。您可以获取元组并将其转换回单个字符串。这允许您使用默认的应用/取消应用功能。

例子 ：

```
val signinForm: Form[Account] = Form(
    mapping(
        "name" -> text(minLength=6, maxLength=50),
        "email" -> email,
        "password" -> tuple(
            "main" -> text(minLength=8, maxLength=16),
            "confirm" -> text
        ).verifying(
            // Add an additional constraint: both passwords must match
            "Passwords don't match", password => password._1 == password._2
        ).transform(
            { case (main, confirm) => main },
            (main: String) => ("", "")
        )
    )(Account.apply)(Account.unapply)
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T13:19:21.493

在玩！框架，您可以通过使用 flash 变量显示友好的错误消息。你只需要写一些类似的东西；

```
flash.error("Oops. An error occurred"); 
```

到您的控制器。例如，应该设置此错误消息将驻留在 html 页面上的位置；

```
<h1>${flash.error}</h1> 
```

玩！框架会将错误消息放在它找到这个 ${flash.error} 的地方。

# javascript - Firefox：点击事件未调用 SPAN 标签

> ID：10342152
> 
> 赞同：1
> 
> 时间：2012-04-26T22:12:55.097
> 
> 标签：javascript, jquery, css

我在我的个人网站上遇到了一个奇怪的问题。我正在对其进行改造，并有一些 DIV 和 SPAN 元素。由于某些未知原因，Firefox 没有调用我通过 jQuery 附加的点击事件。代码在 Chrome 上运行良好。以下是示例网址：

[http://adnansiddiqi.com/main.html](http://adnansiddiqi.com/main.html)

当您单击任何框时，例如关于框，它会显示页面和右侧的十字**X ，****悬停时应显示 HAND 光标，单击时应重置状态**，即带框。该代码在 Chrome(Mac) 上完美运行，但在 FireFox 11(Mac) 上不运行

如果这违反了共享个人 URL 的条款，请原谅我，但上帝知道我已尽力将主代码粘贴到 jsFiddle 上，但遗憾的是，要求 jsFiddle 代码也无法在 CHrome 上正确执行，所以除了提供实际 URL 外，我别无选择. 尽管我删除了所有具有个人风格的东西。Fiddle的链接如下：

[http://jsfiddle.net/RGL7a/20/](http://jsfiddle.net/RGL7a/20/)

我正在拉扯我的头发，却找不到任何明智的线索。

请帮助我！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:47:12.700

div#bigcontent 遮住了你的十字架，可能是 -10% 的边距，ff 也不支持光标使用指针的手值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T23:05:57.513

首先`hand`，该属性的值`cursor`是旧的 Microsoft 声明。您可以在此页面上看到它在不同浏览器中的支持： [http://www.quirksmode.org/css/cursor.html](http://www.quirksmode.org/css/cursor.html)
显示此光标手的“新”方式是使用`pointer`值。因此，将此`hand`值更改为`pointer`, 会有所帮助。但并非一直如此。

另一个问题，也是主要问题，是你不能点击十字架。原因是，在它上面的一层上有一个划分。为了解决这个问题，我会给`absolute` `position`这个元素一个很高的`z-index`值，这样你就可以确定十字架总是在上面。
所以我会将样式更改为`.cross`以下内容：

```
.cross {
    font-family: Arial, Helvetica, sans-serif;
    font-weight: bolder;
    font-size: 2.0em;
    float: right;
    color: #B9C0C7;
    cursor: pointer;
    position: absolute;
    top: 25px; //this puts the element right underneath the top bar
    right: 2%; //so that it has the same distance from the right side, as you defined with padding-right
} 
```

我希望这有帮助:)

# c# - 隐藏对word文档保存的控制

> ID：10342153
> 
> 赞同：0
> 
> 时间：2012-04-26T22:12:56.883
> 
> 标签：c#, asp.net, .net

任何人都可以阐明如何隐藏保存为word文档的控件吗？到目前为止，我已经能够捕获保存事件，但无法访问类模块内的控件。我可以在 as 后面的代码中做到这一点`me.Label1.caption="Test"`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:35:55.503

通过将我的代码放在文档关闭事件中，我能够让它工作。

# modbus - 在 SCADA 系统中，有没有办法让一个 modbus 主站与另一个主站对话？

> ID：10342156
> 
> 赞同：1
> 
> 时间：2012-04-26T22:13:17.100
> 
> 标签：modbus, scada

我正在制作两个交换数据的 SCADA 系统。我的目标是在 tcp 上使用 modbus，因为两个系统都支持这个协议。当然，问题是这两个系统都只能充当 modbus 主站。

在所有现场总线开源的情况下，我很惊讶没有“桥接”实用程序可以让两个主站互相交谈。我对这些技术并不是特别精通，但从外部看来，实现一个打开两个端口并充当两个独立主机的从属的进程似乎是微不足道的。

两个主设备都将中介视为从设备，但来自 Master1 的 POV 的输入寄存器是来自 Master2 的 POV 的输出寄存器，反之亦然。

是否有任何东西，从概念上或协议方面，表明这是有问题的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T10:01:25.713

如果两个 SCADA 系统都可以访问同一个 PLC，则使用 SCADA1 将数据写入该 PLC 中的某个数据块，并使用 SCADA2 读取相同的数据。另一种选择是以某种高级语言实现简单的 MODBUS TCP 服务器，并将其放在一些 PC 上，这样两个 SCADA 系统都可以访问它。或者，您可以运行一些 MODBUS TCP 服务器模拟器，而不是自己实现它。

SCADA 系统不是内置的不是非常友好的支持选项，因此在 SCADA 内部构建 MODBUS TCP 服务器的任务范围从非常困难到不可能 - 取决于您使用的 SCADA 系统。大多数 SCADA 系统既可以充当 OPC 客户端（访问来自各种 OPC 数据源的数据），也可以充当 OPC 服务器（为 OPC 客户端的所有标签提供读/写选项）。如果您的 SCADA 系统是这样的，那么您可以使用 OPC 来实现您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-20T09:10:40.077

喜欢 OPC Server 一起使用`KEPware LinkMaster`，就完美解决这个问题。

# spring-mvc - 不使用 maven 的 Restful 客户端

> ID：10342157
> 
> 赞同：1
> 
> 时间：2012-04-26T22:13:20.463
> 
> 标签：spring-mvc

我正在尝试使用 Spring MVC 框架创建一个安静的客户端。我想从特定的 url 接收 xml 文件，并将其打印在屏幕上。我看到了很多教程，它们都使用了 Maven 依赖项等。是否可以在不使用 Maven 的情况下创建 RESTfull Web 服务？有谁知道一个好的教程来提出？我是 Web 技术的新手，但我个人认为，当使用 Spring 框架时，REST Web 服务的实现也非常烦人和困难。有没有人知道其他可以使 REST 客户端服务更容易的 Java Web 框架？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:33:32.093

您可以使用 Apache HTTP 客户端库

[http://hc.apache.org/downloads.cgi](http://hc.apache.org/downloads.cgi)

只需将所需的罐子放在应用程序类路径中。

[本教程](http://www.alexanderinteractive.com/blog/2011/04/simple-java-rest-client-with-commons-htttpclient/)将帮助您开始使用它：

# c# - C# 数组作为类属性

> ID：10342161
> 
> 赞同：0
> 
> 时间：2012-04-26T22:13:50.877
> 
> 标签：c#, arrays, class

我搜索了很多，但找不到任何解决方案。我可能使用了错误的关键字。我有一个类，它基本上是 ListView 控件的扩展版本。

我为我的自定义 ListView 定义了一些自定义属性，例如 FileName、OrderType 等，它们工作正常。

我还想将一个数组传递给我的类，其中包括 ColumnNames 以填充类中的数据。

课堂`MyListView`上

```
public class ColumnNames : Attribute
{
    public string[] Values { get; set; }

    public ColumnNames(params string[] values)
    {
        this.Values = values;
    }
}

[ColumnNames("a1","a2","a3","a4","a5","a6","a7","a8","a9")]

public MyListView() {

     for (int i = 0; i < 7; i++)
            this.Columns.Add(this.ColumnNames[i]);

    } 
```

课堂`Form1`上

```
MyListView lstv = new MyListView();

lstv.ColumnNames[0] = "hede1";
lstv.ColumnNames[1] = "hede2";
lstv.ColumnNames[2] = "hede3"; 
```

**编辑：**我根本无法实现我想要的。你能给我看一个可行的例子吗？

我使用这个列表视图来显示从数据库中获取的信息。（我使用 ListView 而不是 DataGrid）我想将列名传递给这个类，这将用于 SQL 查询“SELECT xxxxx, yyyyy, zzzz FROM table;” 和列名 this.columns.add("xxxxx"); this.columns.add("yyyyy"); this.columns.add("zzzzz");

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:33:29.513

如果你想坚持这个属性，你可以像这样访问它的数据：

```
var attributes = this.GetType().GetCustomAttributes(typeof(ColumnNames), false);
foreach (var attr in attributes)
{
    var a = attr as ColumnNames;
    foreach (var column in a.Values)
    {
        this.Columns.Add(column);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:26:30.147

在初始化控件之前，您正在类构造函数中添加列。尝试覆盖`OnLoad`事件并在那里执行：

```
protected override void OnLoad(EventArgs e)
{
    base.OnLoad(e);

    foreach (var columnName in this.ColumnNames)
        this.Columns.Add(columnName);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T22:28:27.793

我认为您误解了属性的目的。属性描述了一个成员或类，但似乎试图像继承一样使用它。

也许这就是您正在寻找的：

```
public class MyListView{
   public string[] ColumnNames {get; set;}
} 
```

# c - #include-ing Ubuntu 上旧 C 源代码（page.h 等）中的某些头文件

> ID：10342164
> 
> 赞同：3
> 
> 时间：2012-04-26T22:14:04.923
> 
> 标签：c, linux, header-files

我是 GNU/Linux (Lubuntu 11.10) 的新手，正在尝试从 2001 年的 Linux 编程书中编译一些 C 源代码。我对在 GNU/Linux 中包含头文件感到有些困惑。

该程序是John R. Hall 等人 (2001)的**Programming Linux Games**一书中的“simplefb.c” 。我直接跳到了使用帧缓冲区进行控制台编程的章节，但立即遇到了这个问题。只是想在 Linux 上用 C 语言制作一些简单的非 GUI（和非“文本”）游戏，以获得乐趣......

问题似乎与头文件的一些#includes有关：

```
#include <asm/page.h>
#include <sys/mman.h>
#include <sys/ioctl.h>
#include <linux/fb.h> 
```

尝试书中给出的代码：

**> cc the_file.c**
给出
*致命错误：asm/page.h：没有此类文件或目录编译终止。*

事实上，这些文件似乎存在于其他地方（现在？）所以我最初尝试将第一个 #include 修改为：

```
#include </usr/src/linux-headers-3.0.0-17-generic/include/asm-generic/page.h> 
```

我选择了这个特定的标题文件夹（/usr/src/ 中有几个），因为
**> uname -r**
*3.0.0-17-generic*

使用修改后的#include，我得到编译错误：

在 the_file.c
*/usr/src/linux-headers-3.0.0-17-generic/include/asm-generic/page.h:96:38 包含的文件中：致命错误：asm-*
generic/memory_model.h：否此类文件或目录
编译终止。

并查看该 page.h，它指定包含 asm-generic/memory_model.h（删除了散列和“标签”，否则该行将不会正确显示在此处），但该文件确实存在于同一文件夹中。

所以，在我继续追逐野鹅之前（首先删除前一个包含的 asm-generic/ 位并将其放在引号中），我应该在这里使用什么正确的程序？有没有明显正确的方法来编译本书的源代码？

谢谢你。将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T22:22:19.570

有*两组不同*的头文件：一组用于 Linux 内核编程，另一组用于一般用户空间程序。

/usr/src/linux* 用于内核的东西。

/usr/include/* 是“正常”标头。

您*不想*将两者混合使用。

如果您正在编写游戏，我强烈建议您查看 SDL 或 OpenGL：

*   [http://www.linuxjournal.com/article/6410](http://www.linuxjournal.com/article/6410)

*   [http://content.gpwiki.org/index.php/SDL:Tutorials](http://content.gpwiki.org/index.php/SDL:Tutorials)

*   [http://www.opengl.org/wiki/Getting_Started](http://www.opengl.org/wiki/Getting_Started)

*   [http://www.dreamincode.net/forums/topic/63945-game-programming-in-linux-for-windows-programmers-part-1/](http://www.dreamincode.net/forums/topic/63945-game-programming-in-linux-for-windows-programmers-part-1/)

附录：

1.  问题是您缺少 fbdev （用户空间）标头。您不想引入任何 Linux 内核源头文件。

2.  您应该能够使用以下命令获取标题：

    `sudo apt-get xserver-xorg-video-fbdev`

3.  您可能还需要引入其他依赖项 - apt-get 应该会告诉您。

'希望有帮助.. PSM

PS：

看来您的书“Programming Linux Games”也是一本备受推崇的 SDL 教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:21:59.350

gcc的`-I`参数添加了一个目录来查找头文件。

```
gcc ... -I /usr/src/.../include ... 
```

# html - 将“nth-of-child”应用于表格单元格的困难

> ID：10342168
> 
> 赞同：1
> 
> 时间：2012-04-26T22:14:27.313
> 
> 标签：html, css, css-selectors

我正在尝试将 nth-of-child 样式应用于表格单元格，但这不起作用。根据我的代码，我希望每个第二个单元格内容右对齐并具有灰色。但这种风格没有任何效果。

这是代码：

```
<!DOCTYPE html>
<html>
<head><title>test table centerring</title></head>
<body>
<style type="text/css">
    td:nth-of-child(2) {
        text-align: right;
        color: #ccc;
    }
</style>

<table border="1">
    <thead>
        <tr>
            <th>#</th>
            <th>Name</th>
            <th>Value</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>Name 1</td>
            <td>Value 1</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Name 2, Name 2, Name 2, Name 2</td>
            <td>Value 2</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Name 3</td>
            <td>Value 3</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Name 4</td>
            <td>Value 4, Value 4, Value 4, Value 4</td>
        </tr>
    </tbody>
</table>        
</body></html> 
```

我尝试了不同类型的规范来修改对象类型：“td”、“tr td”、“table tbody tr td”没有任何影响我的表。

我还尝试使用 ID 来识别表格并将样式应用于 id - 这也无济于事。

PS 我在 IE9、Chrome、FF 中测试过

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T22:18:56.093

没有`:nth-of-child`选择器之类的东西。您似乎将两者`:nth-child`和`:nth-of-type`选择器混合在一起......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:20:16.610

```
tr td:nth-child(2) {
    text-align: right;
    color: #ccc;
}​ 
```

[**演示。**](http://jsfiddle.net/5ZLk2/)

# jquery - jquery在点击时检查字符串的href？

> ID：10342169
> 
> 赞同：0
> 
> 时间：2012-04-26T22:14:34.617
> 
> 标签：jquery, href, contains

我想知道如何检查我的 href 是否在 click 函数中包含字符串？我尝试了不同的方法并查看了其他类似的问题，但我似乎无法让它工作..我尝试过包含和正则表达式..这是代码：

```
$.each($ul.find('a'),function(){
  $(this).click(function(e){
    e.preventDefault();
    if (  ) { // this is where i've been trying check whether the href contains 'cid'...
      alert( 'your href contains cid' );
    } else {
      alert(' do nothing');
    };
  });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T22:15:55.377

使用[`indexOf`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/indexOf)它的方法：

```
if($(this).attr('href').indexOf('cid') != -1) 
```

你不需要`.each()`顺便说一句：

```
$ul.find('a').click(function(e) {
    //...
}); 
```

# android - 如何通过知道行的名称来获得微调行？

> ID：10342170
> 
> 赞同：1
> 
> 时间：2012-04-26T22:14:38.000
> 
> 标签：android, spinner, android-spinner, simpleadapter

我有一个简单的 Android Spinner，我用两列“图标”和“名称”列表填充。这很完美。

```
ArrayList<HashMap<String, Object>> stationList = new ArrayList<HashMap<String, Object>>();
... // fill stationList 
Spinner spinner = (Spinner) findViewById(R.id.stations);
SimpleAdapter adapter = new SimpleAdapter(
                                this,
                                stationList,
                                R.layout.listitem,
                                new String[] { "icon", "name" },
                                new int[] {R.id.option_icon, R.id.option_text });
spinner.setAdapter(adapter); 
```

如何仅通过知道“名称”从列表中检索一行？我不知道 id 也不知道微调器中的位置！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T20:50:55.837

如果要搜索`stationList`以查找特定值，可以尝试以下操作：

```
for(HashMap<String, Object> map : stationList) {
    if(map.containsValue("name")) {
        // Do something
    }
} 
```

# .net - DBContext Linq to entity read uncommitted

> ID：10342171
> 
> 赞同：1
> 
> 时间：2012-04-26T22:14:39.083
> 
> 标签：.net, performance, linq, dbcontext

我的问题有两个方面。首先，我通常会在使用 ObjectContext 时做类似`entity.ExecuteStoreCommand`的事情，但是这似乎不是 DBContext 的情况。

*   A）我认为如果您想对数据库进行未提交的读取，则必须将其设置在某个地方是正确的，DBConext 仍然是这种情况。
*   B）虽然我从不提倡在处理付款细节等时进行脏读……其他人是否发现它可以提高他们的 linq 语句的性能，如果是的话……是否有人在事情？

我的代码示例

```
protected String isolationLevel = "SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;";
 public UserAccountDetail GetUserAccount(string userName, int userId)
        {
            using (var personEntity = new PersonEntity())
            {
                // set isolation level here such as... personEntity.ExecuteStoreCommand(isolationLevel, null);

                userAccountDetails = personEntity.UserAccountDetails.FirstOrDefault(q => q.Username == userName && q.UserID == userId);
            }
        } 
```

如果任何人有任何可能是 phat 的 DBConext 指针，关于性能、最佳实践等。

干杯，辛普斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T20:59:20.273

DbContext 不设置隔离级别。如果您需要使用 DbContext API 执行 SQL 命令，您可以执行以下操作：

```
dbContext.Database.ExecuteSqlCommand("Your SQL statement here"); 
```

如果您需要支持您的 DbContext 对象的 ObjectContext 实例，您可以执行以下操作：

```
var objecCtx = ((IObjectContextAdapter)dbContext).ObjectContext; 
```

# servlets - Jboss seam 自定义 servlet “没有活动的事件上下文”

> ID：10342175
> 
> 赞同：3
> 
> 时间：2012-04-26T22:15:33.433
> 
> 标签：servlets, jboss, seam

我有 jboss seam 网络服务。我在 web.xml 中映射我的服务类，如下所示

```
<servlet>
    <servlet-name>pluginhandler</servlet-name>
    <servlet-class>service.PlugInHandler</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>pluginhandler</servlet-name>
    <url-pattern>/*</url-pattern> 
</servlet-mapping> 
```

我在一些博客上读到，如果您在 jboss seam 中使用自定义 servlet，那么您必须添加过滤器 org.jboss.seam.servlet.SeamServletFilter 以生成我可能需要与 seam 组件对话的所有必需上下文

```
<filter>
    <filter-name>Seam Servlet Filter</filter-name>
    <filter-class>org.jboss.seam.servlet.SeamServletFilter</filter-class>
</filter> 
<filter-mapping>
    <filter-name>Seam Servlet Filter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

我有一个接缝组件 Action，我试图在 web 方法中实例化它，但我不断收到空指针异常（当我尝试调用它的方法时），根本原因是“没有活动的事件上下文”。我已附加异常堆栈如下

```
 Servlet.service() for servlet pluginhandler threw exception
java.lang.IllegalStateException: No active event context
    at org.jboss.seam.core.Manager.instance(Manager.java:250)
    at org.jboss.seam.servlet.ContextualHttpServletRequest.run(ContextualHttpServletRequest.java:55)
    at org.jboss.seam.web.ContextFilter.doFilter(ContextFilter.java:37)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:230)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:179)
    at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:84)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:157)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:262)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:446)
    at java.lang.Thread.run(Unknown Source) 
```

我不知道可能出了什么问题。使用自定义 servlet 是否缺少某些特定配置？我非常感谢您的帮助和时间。我正在使用 seam 2.0.1.GA 而 jboss 版本是 4.2.2.GA

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T14:26:49.507

如果您以非标准方式访问 Seam 组件，您需要使用`Lifecycle.beginCall()`和包装方法调用`Lifecycle.endCall()`

```
Lifecycle.beginCall() 
Component.getInstance('...').call();
Lifecycle.endCall() 
```

# jquery - iFrame Colorbox 内的表单验证，如何在父页面中打开 href URL 并关闭 Colorbox。

> ID：10342176
> 
> 赞同：0
> 
> 时间：2012-04-26T22:15:34.253
> 
> 标签：jquery, validation, colorbox

我已经在这上面花费了太多时间，但仍然无法弄清楚。当表单通过验证时，尝试从 parent.page 打开表单提交页面。这是我们到目前为止所得到的，它完成了工作，但我只是不喜欢我们必须放置“window.parent.location.href="/page1.hmtl";”的事实 ...从技术上讲，它并没有真正提交表单。此代码位于被调用的 iframe 颜色框内。

```
$(document).ready(function() {
$("#formResultQuote").validate({
          rules: {
              rqResult: {
                  required: true,
                  minlength:1
              }
          },
          messages: {
              rqResult: {
                  required: 'Please select one of the saved quotes.'
              }
          },
          errorPlacement: function (error, element) {
              if (element.attr('name') == 'rqResult') {
              error.appendTo(element.parents().find('.rqResultError'));
          parent.$.colorbox.resize({height:580});
          },
         submitHandler: function() {
         if ($('#formResultQuote').valid()) {
         parent.jQuery.colorbox.close();
         window.parent.location.href="/page1.hmtl";
         }
       }                  
    });
}); 
```

此页面上的基本 HTML 非常像这样：

```
<form name="formResultQuote" id="formResultQuote" action="/page1.html" method="post">

<input name="rqResult" id="core" type="radio" class="radioCircle" validate="required:true, minlength:2"/>
<input name="rqResult" id="core" type="radio" class="radioCircle"/></div>
<input name="rqResult" id="core" type="radio" class="radioCircle"/></div>

<input type="submit" value="Retrieve your quote." id="regularSubmitBtn" name="Retrieve_a_Quote" tabindex="27" class="rqSubmitBtn" >
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T05:01:34.913

而不是这个：

```
parent.jQuery.colorbox.close();
window.parent.location.href="/page1.hmtl"; 
```

你可以试试这个：

```
parent.jQuery('document').bind('cbox_closed', function(){
    location.href="/page1.hmtl";
});
parent.jQuery.colorbox.close(); 
```

# bash - 在 Bash 脚本中具有多个条件的 for 循环

> ID：10342184
> 
> 赞同：4
> 
> 时间：2012-04-26T22:16:20.197
> 
> 标签：bash, for-loop

自从我编写了密集的 bash 脚本以来已经有一段时间了，我忘记了在 for 循环中执行多个条件的语法。

在 C 中，我会这样做：

```
for(var i=0,j=0; i<arrayOne.length && j<arrayTwo.length; i++,j++){
  // Do stuff
} 
```

我一直在谷歌搜索，只发现涉及嵌套 for 循环的语法，而不是一个 for 循环的多个条件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-26T22:24:29.693

听起来你在谈论*for loop 的算术*。

```
for ((i = j = 0; i < ${#arrayOne[@]} && j < ${#arrayTwo[@]}; i++, j++)); do
    # Do stuff
done 
```

哪个假设`i`和`j`要么未设置要么为零，大约相当于：

```
while ((i++ < ${#arrayOne[@]} && j++ < ${#arrayTwo[@]})); do ... 
```

只要您不关心循环之后`i`/的值，并且更便携。`j`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T22:23:43.367

如果和C比较，差别不大

```
for (( c=1,d=1; c<=5 && d<=6; c++,d+=2 ))
do
        echo "$c : $d"
done 
```

# c++ - 迁移 am2cmake

> ID：10342185
> 
> 赞同：1
> 
> 时间：2012-04-26T22:16:21.790
> 
> 标签：c++, cmake, automake

我尝试转移到一些 CMake 程序中，并且有一个从 xml 生成头文件的函数。

生成文件.am

```
adaptor_glue.hpp: dbus_introspect.xml
    $(DBUSXX_XML2CPP) '$<' --adaptor='$@'

proxy_glue.hpp: dbus_introspect.xml
    $(DBUSXX_XML2CPP) '$<' --proxy='$@' 
```

配置

```
DBUSXX_XML2CPP='$(top_builddir)/dbus-c++/tools/dbusxx-xml2cpp' 
```

我怎么能在cmake上做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T13:54:27.720

正确的方法是：

```
add_custom_command(OUTPUT proxy_glue.hpp adaptor_glue.hpp PRE_BUILD
                   COMMAND "${CMAKE_SOURCE_DIR}/dbus-c++/tools/dbusxx-xml2cpp" ARGS "./dbus_introspect.xml" "--proxy=./proxy_glue.hpp" "--adaptor=./adaptor_glue.hpp"
                   ) 
```

# php - 错误不断出现实施基本的 phpthumb 脚本...GdThumb.in.php 的第 1070 行权限被拒绝

> ID：10342190
> 
> 赞同：-3
> 
> 时间：2012-04-26T22:16:58.560
> 
> 标签：php, permissions, directory-structure, thumbnails, phpthumb

我想要一个脚本，当从一个装满较大图像的文件夹中时，它会自动生成缩略图。我在实现它时遇到了一些问题。

我很早就遇到了一些错误，因为我没有包含我需要的所有 phpthumb 文件，但现在错误来自 phpthumb 代码本身。将根据需要发布更多代码。

错误：

```
Warning: getimagesize(.\.) [function.getimagesize]: failed to open stream: Permission denied in C:\xampp\htdocs\mysite\GdThumb.inc.php on line 1070

Fatal error: Uncaught exception 'Exception' with message 'File is not a valid image: .\.' in C:\xampp\htdocs\mysite\ThumbBase.inc.php:193 Stack trace: #0 C:\xampp\htdocs\mysite\GdThumb.inc.php(1081): ThumbBase->triggerError('File is not a v...') #1 C:\xampp\htdocs\mysite\GdThumb.inc.php(98): GdThumb->determineFormat()
#2 C:\xampp\htdocs\mysite\ThumbLib.inc.php(127): GdThumb->__construct('.\.', Array, false) #3 C:\xampp\htdocs\mysite\save_differentformat.php(47): PhpThumbFactory::create('.\.') #4 {main} thrown in C:\xampp\htdocs\mysite\ThumbBase.inc.php on line 193 
```

剧本：

```
require_once '../mysite/ThumbLib.inc.php';

$dir = "../mysite/images" ;
$destination = "../mysite/thumbnails" ;
$images = scandir($dir);

foreach ($images as $image)
{
    $ext = pathinfo($dir . DIRECTORY_SEPARATOR . $image,PATHINFO_EXTENSION);
    $thumb = PhpThumbFactory::create($image  . DIRECTORY_SEPARATOR. $image);
    $thumb->adaptiveResize(100, 100);
    $thumb->save($destination . DIRECTORY_SEPARATOR. $image, $ext);
    $thumb->show();
}
?> 
```

**编辑**

这是我现在收到的错误消息。它不知道 $mode 是什么，我可能在该文件夹中混合了图像类型。

```
Notice: Undefined variable: mode in C:\xampp\htdocs\mysite\save_differentformat.php on line 51

    Warning: getimagesize(.\.) [function.getimagesize]: failed to open stream: Permission denied in C:\xampp\htdocs\mysite\GdThumb.inc.php on line 1070

    Fatal error: Uncaught exception 'Exception' with message 'File is not a valid image: .\.' in C:\xampp\htdocs\mysite\ThumbBase.inc.php:193 Stack trace: #0 C:\xampp\htdocs\mysite\GdThumb.inc.php(1081): ThumbBase->triggerError('File is not a v...') #1 C:\xampp\htdocs\mysite\GdThumb.inc.php(98): GdThumb->determineFormat()
    #2 C:\xampp\htdocs\mysite\ThumbLib.inc.php(127): GdThumb->__construct('.\.', Array, false) #3 C:\xampp\htdocs\mysite\save_differentformat.php(64): PhpThumbFactory::create('.\.') #4 {main} thrown in C:\xampp\htdocs\mysite\ThumbBase.inc.php on line 193 
```

这是 scandir() 返回的内容：

```
array(19) { [0]=> string(1) "." [1]=> string(2) ".." [2]=> string(36) "13912d3e8b4ae1890457fe935cc0c7fe.png" [3]=> string(36) "266c484ca488d053255c7767af212bee.png" [4]=> string(36) "8af941c37874dc3a7edee2772b60c323.png" [5]=> string(9) "Thumbs.db" [6]=> string(15) "butterflies.png" [7]=> string(22) "butterfliesinverse.png" [8]=> string(11) "favicon.png" [9]=> string(36) "fb9e25f57d12ec5019aa548665f34fa5.png" [10]=> string(20) "image1.png" [11]=> string(25) "image11 (1).png" [12]=> string(21) "image11.png" [13]=> string(25) "image12 (1).png" [14]=> string(21) "image12.png" [15]=> string(21) "image15.png" [16]=> string(20) "image2.png" [17]=> string(21) "image25.png" [18]=> string(21) "image28.png" } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T07:44:39.453

好的道歉接受

`../`A.处理路径时不能使用真正的建议.. 这可能会导致很多问题我的建议是使用真实路径

B. 始终检查文件夹是否存在，您可以在执行文件操作之前写入该文件夹

例子

```
$dir = "mysite/images";
$destination = "mysite/thumbnails";
$mode = 0777;
if (! is_dir ( $dir )) {
    die ( "Source  Direcotry Does not exist :  $dir" );
}

if (! is_readable ( $dir )) {
    die ( "Source  Direcotry Does not readable :  $dir" );
}

if (! mkdir_recursive ( $destination, $mode )) {
    die ( "Can't wite  create $destination" );
}

$images = scandir ( $dir );

$allowedExtention = array (
        "jpg",
        "gif",
        "png" 
);

$errors = array ();
foreach ( $images as $image ) {
    $imageFile = $dir . DIRECTORY_SEPARATOR . $image;

    if (is_file ( $dir . DIRECTORY_SEPARATOR . $image )) {

        if ($image == "." || $image == "..") {
            continue;
        }

        $ext = pathinfo ( $dir . DIRECTORY_SEPARATOR . $image, PATHINFO_EXTENSION );
        if (! in_array ( $ext, $allowedExtention )) {
            continue;
        } else {
            $errors [] = $imageFile . " has invalid extention $ext";
        }

        try {
            $thumb = PhpThumbFactory::create ( $dir . DIRECTORY_SEPARATOR . $image );
            $thumb->adaptiveResize ( 100, 100 );
            $thumb->save ( $destination . DIRECTORY_SEPARATOR . $image, $ext );
            $thumb->show ();
        } catch ( Exception $e ) {
            $errors [] = "PhpThumbFactory  : " . $e->getMessage ();
        }
    } else {
        $errors [] = $imageFile . " not a valid File";
    }
}

// Check for errors

if (count ( $errors )) {
    foreach ( $errors as $error ) {
        echo $error . " <br />";
    }
}

function mkdir_recursive($pathname, $mode) {
    is_dir ( dirname ( $pathname ) ) || mkdir_recursive ( dirname ( $pathname ), $mode );
    return is_dir ( $pathname ) || mkdir ( $pathname, $mode );
} 
```

# c# - 使用 linq 到 DataSet 后进行转换

> ID：10342193
> 
> 赞同：0
> 
> 时间：2012-04-26T22:17:09.463
> 
> 标签：c#, linq, casting, dataset

我做了以下 linq 查询

```
var results = from myRow in QCAllDataSet.DataTable1.AsEnumerable()
                                      where myRow.Field<String>("ESRNumber") == value
                                      select new ESR(myRow.ESRNumber,
                                                           myRow.CreationDate,
                                                           myRow.Subsystem,
                                                           myRow.Name,
                                                           myRow.Product,
                                                           myRow.Version,
                                                           myRow.ESRStatus,
                                                           myRow.Owner,
                                                           myRow.Priority,
                                                           myRow.LastPHNote,
                                                           myRow.LastPHNoteDate,
                                                           myRow.LastPHNoteUser,
                                                           myRow.DaysFromLastUpdate,
                                                           myRow.Customer,
                                                           myRow.T2Owner,
                                                           myRow.T2Group,
                                                           myRow.comment,
                                                           myRow.ESRAge); 
```

我想转换`results`为`ESR`对象

有点像`ESR t=(ESR)results`

但我收到以下错误：

> 无法将类型“System.Data.EnumerableRowCollection”转换为 ESR

我应该怎么做这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:20:21.520

用于`FirstOrDefault`从结果中仅获取一项。

```
var esrObject=  (from myRow in QCAllDataSet.DataTable1.AsEnumerable()
 where myRow.Field<String>("ESRNumber") == value
  select new ESR(myRow.ESRNumber,
                  myRow.CreationDate,
                  myRow.Subsystem)).FirstOrDefault(); 
```

`SingleOrDefault` 当您确定您的集合将只返回一条记录时，您可以使用，否则使用 FirstOrDefault。`FirstOrDefault`将返回序列的第一个元素，如果序列不包含任何元素，则返回默认值。因此，即使您的集合表达式返回多行，您也不必担心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T22:20:23.680

当您`select`使用 LINQ 时，您将返回一个集合，即使您打算只检索一个结果。要指示单个结果，请使用`Single()`LINQ 方法：

```
ESR t = results.Single(); 
```

如果它可能不返回任何结果（不匹配），那么您可以使用`SingleOrDefault()`并检查 null：

```
ESR t = results.SingleOrDefault();
if (t == null)
    // could not find match 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T22:26:26.420

An`Enumerable<T>`不是单个对象，即使它只包含一个对象。你必须指定你想要什么。有很多[扩展方法，`Enumerable`](http://msdn.microsoft.com/en-us/library/bb341635.aspx)例如：

*   [第一个](http://msdn.microsoft.com/en-us/library/bb291976.aspx)或[最后一个](http://msdn.microsoft.com/en-us/library/bb549138.aspx)
*   不言自明的[ToList](http://msdn.microsoft.com/en-us/library/bb342261.aspx)或[ToArray](http://msdn.microsoft.com/en-us/library/bb298736.aspx)
*   [Single](http://msdn.microsoft.com/en-us/library/bb155325.aspx)或[SingleOrDefault](http://msdn.microsoft.com/en-us/library/bb342451.aspx)这很可能是您想要[的（ First 和 Single 的区别](https://stackoverflow.com/questions/2724096/linq-single-vs-first)）

例如：

```
List<ESR> allESR = results.ToList();
ESR firstESR = results.First(); // throws an exception if there is not at least one
ESR firstESR = results.FirstOrDefault(); // returns null if there's not at least one 
```

**请注意**，在您调用这些方法之一之前不会执行查询（或`foreach to iterate them)`由于 LINQ 的[延迟执行](https://stackoverflow.com/questions/7324033/what-are-the-benefits-of-a-deferred-execution-in-linq)而使用 a 。

# shiro - 如何用 Shiro 处理 UnauthenticatedException

> ID：10342213
> 
> 赞同：0
> 
> 时间：2012-04-26T22:18:59.103
> 
> 标签：shiro, guice-3

我的资源中有一个带有 @RequiresGuest 注释的方法。当登录用户点击链接时，它会正确地抛出一条`UnauthenticatedException`带有此消息的链接

> 尝试执行仅限访客的操作。当前主题不是来宾（他们已通过身份验证或从以前的登录中记住）。拒绝访问。

但是我该如何处理呢？例如，如何将请求重定向到注销页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T16:49:44.247

这通常取决于您选择的 MVC 框架：

*   一些 UI 机制（例如 JSP）允许您拥有一个“错误页面”，您可以使用它来处理任何异常。
*   更优雅的 UI 框架具有“捕获所有”异常处理程序和/或控制器，允许您做任何您想做的事情（检查异常、设置 HTTP 状态代码、将最终用户重定向到特定于该特定问题的错误页面等） .

但是，如果您不希望为此使用 MVC 机制，则可以创建一个 Servlet 过滤器来执行此操作：

过滤器将在 try/catch 块中执行 FilterChain，捕获 AuthorizationException。如果它捕获到一个，它会发出一个 302 重定向到“unauthorizedUrl”。

Shiro 的现有过滤器不这样做的原因是因为它们在调用 FilterChain 之前对 Subject 进行了授权：如果 Subject 不符合授权条件，*则过滤器链甚至不会被调用*（因此没有要捕获的 AuthorizationException）。

如果您想在 Shiro 中看到替代行为，请提交[问题](http://shiro.apache.org/issues.html)并将其作为潜在的新功能进行讨论。

# jquery - 使用jquery根据url更改下拉列表中的选定值

> ID：10342215
> 
> 赞同：0
> 
> 时间：2012-04-26T22:19:26.240
> 
> 标签：jquery, iphone

这是我正在尝试做的事情：

```
<select id="dynamic_select">
<option value="http://blog.mysite.com/">United Kingdom</option>
<option value="http://fr.blog.mysite.com/">France</option>
<option value="http://de.blog.mysite.com/">Deutschland</option>
<option value="http://it.blog.mysite.com/">Italia</option>
<option value="http://jp.blog.mysite.com/">日本</option>
<option value="http://es.blog.mysite.com/">España</option>
</select> 
```

第一个脚本

```
jQuery(function(){
  // bind change event to select
  jQuery('#dynamic_select').bind('change', function () {
      var url = jQuery(this).val(); // get selected value
      if (url) { // require a URL
          window.location = url; // redirect
      }
      return false;
  });
}); 
```

另一个脚本

```
jQuery(document).ready(function() {
 if(window.location.href.indexOf("fr") != -1) {
jQuery("#dynamic_select option[value='2']").attr('selected', 'selected');
}
}); 
```

这是一个语言选择器，将在 iphone 上显示（使用 WPtouchPro），第一部分，即基于选择的 url 更改工作完美..但我想更改下拉列表中选择的选项，其值等于页面的 url.. 还有如何写这些日文字母，以便它们在所有浏览器上正确显示.. 谢谢 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:37:10.150

对日文字符使用 UTF-8 字符集：

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
```

通过使用`data`属性，你可以试试这个：

```
<select id="dynamic_select">
<option data-c="uk" value="http://blog.mysite.com/">United Kingdom</option>
<option data-c="fr" value="http://fr.blog.mysite.com/">France</option>
<option data-c="de" value="http://de.blog.mysite.com/">Deutschland</option>
<option data-c="it" value="http://it.blog.mysite.com/">Italia</option>
<option data-c="jp" value="http://jp.blog.mysite.com/">日本</option>
<option data-c="es" value="http://es.blog.mysite.com/">España</option>
</select> 
```

假设`window.location.href.slice(7, 9)`等于`de`：

```
$(document).ready(function() {
      lt = "de";
    $("#dynamic_select option").each(function(){
       if ($(this).data("c") == lt ) $(this).prop("selected", true);
    })
}); 
```

[http://jsfiddle.net/qj8x8/1/](http://jsfiddle.net/qj8x8/1/)

# haskell - 在 GHCi 中获取评估时间

> ID：10342217
> 
> 赞同：31
> 
> 时间：2012-04-26T22:19:34.580
> 
> 标签：haskell, ghc, timing, ghci

我有一个相对较慢的过程（恰当地命名为慢），我想做类似的事情

```
time $ slow [1,2,3,4,5] 
```

在控制台（REPL）中获取时间，而不必编译程序然后运行时间。

这可以做到吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-04-26T22:23:30.603

如果您输入`:set +s`GHCi，则在计算每个表达式后将打印时间和内存信息。

例子：

```
Prelude> :set +s
Prelude> sum [1..2^20]
549756338176
it :: (Num a, Enum a) => a
(0.34 secs, 169,197,008 bytes) 
```

请注意，这将是在解释器中评估的表达式的时间，没有优化，因此它不一定是对事情需要多长时间的准确衡量，或者甚至是相同代码的两个版本中的哪个版本会更快，在实际编译的代码。为此，请查看[标准](http://hackage.haskell.org/package/criterion)基准测试库。

# macos - 具有库引用自动完成、调试和在 Mac 上运行 Nodejs 的 IDE

> ID：10342218
> 
> 赞同：0
> 
> 时间：2012-04-26T22:19:38.417
> 
> 标签：macos, debugging, node.js, ide, autocomplete

我目前正在学习使用 Node.js 进行服务器端 javascript 开发，并希望找到一个可以很好地使用它的 IDE。

我已经尝试为 eclipse 和 Aptana 安装[Chrome Dev Tools](http://code.google.com/p/chromedevtools/)，但这些解决方案并不能完全满足我的要求。

我喜欢 eclipse 当前如何自动完成并显示 Java 的编译时错误，并且非常喜欢自动完成不仅基于文本，而且实际上是类型匹配的。虽然 Javascript 没有很多类型，但我仍然想要相关的自动完成选项，我认为 eclipse 已经有了这个功能。我想使用 eclipse，因为它内置了很多功能，但如果没有解决方案，我可能会进入我的洞穴并尝试构建自己的 Nodejs IDE。

我很感激任何回应！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T07:41:26.797

查看 JetBrains 的[WebStorm](http://www.jetbrains.com/webstorm/)。自动完成、智能感知，并且它们支持通过调试器以交互方式运行 node.js。它不是免费的，但 49 美元的个人执照或 99 美元的营业执照相当便宜。

最好的办法是尝试下载——它功能齐全，可以运行 30 天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T00:47:13.440

[netbeans](http://netbeans.org/)几乎肯定值得一看。如果你在 linux 上开发，有一个[节点插件](http://plugins.netbeans.org/plugin/36653/nodejs)，看起来它可以让你直接从 IDE 运行你的节点项目。

我还没有使用 netbeans 进行节点开发，但一直在我正在研究的前端项目（HTML5、CSS、jQuery）上使用它，并且对它印象深刻。我之前使用过 Aptana，然后是 Visual Studio，发现两者都需要在许多领域。netbeans 似乎可以正常工作，并且没有任何使我放弃其他两个的烦恼。

# asp.net-mvc - 用于 ASP.NET MVC 的组合框

> ID：10342223
> 
> 赞同：3
> 
> 时间：2012-04-26T22:20:02.107
> 
> 标签：asp.net-mvc, asp.net-mvc-3, combobox

我正在尝试在 ASP.NET MVC 3.0 中创建一个组合框，用户可以在其中输入文本字段中的值或从下拉列表中选择值。用户不应受限于选择列表中的值。视图有一个视图模型，因此需要通过模型绑定填充值并发布到控制器操作。

我已经[创建了一个不错](https://stackoverflow.com/a/10341126/529612)的基于 jquery 自动完成小部件的 jquery 解决方案，但我还没有让它与 MVC 不显眼的 javascript 验证一起玩得很好。我在[这个 HtmlHelper 扩展](http://www.veadas.net/article/aspnet-mvc-combo-box)方面取得了进展，但我正在努力解决 IE/兼容模式和我现有的 CSS 的 UI 问题。购买 Telerik 或 Infragistics 等控制套件是不可能的。（编辑：这是一个商业应用程序，所以我不能使用免费的 Telerik 控件，因为它们是 GPL，如果您在应用程序中使用 GPL 组件，您的整个应用程序就会成为 GPL）。

有没有人有一个很棒的 MVC 组合框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T02:46:48.150

请参阅[使用 jQuery UI 将新类别添加到 DropDownList](http://www.asp.net/mvc/tutorials/javascript/working-with-the-dropdownlist-box-and-jquery/adding-a-new-category-to-the-dropdownlist-using-jquery-ui) 最初我破解了一个 jQuery 插件以允许用户输入新的 FK 字段（在本例中为 Genre 或 Artist）。没有允许组合框条目的 HTML UI，所以我转向了另一个方向。我的教程还使用了所选的 jquery 插件，尽管它不允许输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T00:55:25.663

我发现**所选 jquery 插件**的功能可以很好地满足 javascript 增强下拉列表的需求。

该组件来自 Harvest 开发团队。[这里](http://harvesthq.github.com/chosen/)有一些文档和下载。

我特别喜欢它在 MIT 许可下，因此无需担心所有权或修改权问题。

# tree - 从列表中制作prolog BST并在参数中返回

> ID：10342224
> 
> 赞同：1
> 
> 时间：2012-04-26T22:20:06.467
> 
> 标签：tree, prolog

我需要做一个序言谓词`from_list/2`，这样如果我打电话，`from_list([], T)`我会得到一个包含列表（ints）中项目的树，到目前为止我有：

```
from_list([], empty).
from_list([X], T) :-
    insert(X, empty, T).
from_list([X|Y], T) :-
    from_list(Y, NT),
    insert(X, NT, T). 
```

编辑：想通了，但它以列表的相反顺序将它们添加到树中。有什么帮助吗？

这是我的插入谓词，它似乎工作得很好。

```
insert( X, empty, bt(X, empty, empty) ). 
insert( X, bt(X2, L, R), bt(X2, NL, R) ) :-
    X < X2,
    !,
    insert(X, L, NL). 
insert( X, bt(X2, L, R), bt(X2, L, NR) ):-
    insert(X, R, NR). 
```

也不是第二个不需要答案的小得多的问题

我知道 prolog 在正确使用时具有非常优雅的风格......而这段代码......不是那么优雅......

```
is_search(empty).
is_search( bt(_, empty, empty) ).
is_search( bt( X, empty, bt(Y,LEFT,RIGHT) ) ) :-
    X < Y,
    is_search(LEFT),
    is_search(RIGHT).
is_search( bt(X, bt(Y,LEFT,RIGHT), empty) ) :-
    X > Y,
    is_search(LEFT),
    is_search(RIGHT).
is_search( bt( X, bt(Y,L1,R1), bt(Z, L2, R2) ) ) :-
    X > Y,
    X < Z,
    is_search( bt(Y, L1, R1) ),
    is_search( bt(Z, L2, R2) ). 
```

关于如何清理它的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T12:15:26.270

关于你的第二个问题，我想说你应该描述二叉树的两种（不是五个！）情况：要么是空的，要么是一个内部节点，其中左右所有元素分别较小和较大, 并且是二叉树本身：

```
bt(empty).
bt(bt(Val, Left, Right)) :-
    all_smaller_than(Left, Val),
    all_larger_than(Right, Val),
    bt(Left),
    bt(Right). 
```

我将 all_smaller_than/2 和 all_larger_than/2 作为练习留给你。提示：同样，两个子句对它们中的每一个都足够了。你也可以找到一种方法让它更快......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T12:03:36.950

只是我这边的一个提示：

```
from_list([], empty).
from_list([X], T):- insert(X, empty, T).
from_list([X|Y], T):- from_list(Y, NT), insert(X, NT, T). 
```

这是行不通的，因为您不知道第 2 行是否为空。

要以相反的顺序使用列表

```
reverse(X,R). 
```

PS：据我所知，我们正在谈论 SWI-Prolog，对吗？

# iphone - 关闭 iPhone 网页应用

> ID：10342230
> 
> 赞同：3
> 
> 时间：2012-04-26T22:20:32.757
> 
> 标签：iphone, ipad, web-applications, mobile-safari

我只想关闭或最小化（隐藏）全屏 iPhone 网络应用程序。

这个怎么做？`window.close();`不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T22:39:21.943

你不能。您无法从 JavaScript 退出浏览器。

但是您可以尝试使浏览器崩溃……这并不是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:44:09.047

我不确定你为什么要这样做，但**你不能**。

# c# - 获取周期数的 excel 或 c# 或 SQL 解决方案

> ID：10342232
> 
> 赞同：0
> 
> 时间：2012-04-26T22:20:45.093
> 
> 标签：c#, sql, algorithm, excel

我有一个看起来像这样的数据集

```
id, value1,value2,value3,value4,value5...value200 (i am showing only 5 but solution needs to accomodate 200 values)
a, 10,4,2,0,0
b, 23,0,0,2,0
c, 0,2,4,0,0
d, 0,0,0,1,0 
```

我想返回每行有多少个值的 COUNT，尾部只有零。

对于上述数据，它将是：

```
3
4
2
1 
```

解决方案可以是 c# 或 excel（公式，而不是 vba）

非常感谢您的帮助。/指导，如果我不清楚，请告诉我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:32:08.917

如果您将文件作为 CSV 数据读取并手动解析，您可以执行以下操作来查找开头和结尾的第一个非零条目：

```
// prepare sample data (as CSV)
var csv =
@"id, value1,value2,value3,value4,value5
a, 10,4,2,0,0
b, 23,0,0,2,0
c, 0,2,4,0,0
d, 0,0,0,1,0";

// get column data
var lines = csv.Split('\n');
var rows = lines.Skip(1).Select (
    line => line.Split(',').Skip(1).Select (l => Convert.ToInt32(l)));
var result = new List<int>();

foreach (var row in rows)
{
    // for each row, remove 0's at beginning and end
    var data = row.SkipWhile (r => r == 0).Reverse()
        .SkipWhile (r => r == 0).Reverse();
    // and retrieve the count
    result.Add(data.Count());
}
// result = [3, 4, 2, 1] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:39:50.080

这是我想到的解决方案：

1.  连接值行
2.  转换为数字（这将摆脱开头的零）
3.  取单元格的 mid()，在第一个 0 的起始位置结束（这将摆脱尾随的 0）
4.  获取最终字符串的长度（这将产生所需的结果）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-27T01:34:49.900

Excel 数组公式。按 Ctrl+Shift+Enter 确认公式输入：

```
=MAX((B2:F2>0)*COLUMN(B2:F2))-MATCH(1,--(B2:F2>0),0)-0 
```

请注意，这假设感兴趣的数据从 B 列开始。`-0`如果数据从不同的列开始，则需要更改最终数据。

# java - PrimeFaces Growl 不适用于 JSF 页面上的谷歌地图

> ID：10342237
> 
> 赞同：1
> 
> 时间：2012-04-26T22:21:38.010
> 
> 标签：java, jsf, growl

p:growl 在不包含任何 Google 地图的其他页面上运行良好，但是当我在 jsf 页面上将 p:growl 与 Google 地图一起使用时，p:growl 无法正常工作。我在 chrome 中检查了这个页面的元素，它显示了这个错误：

> 未捕获的类型错误：无法调用未定义的 primefaces.js.xhtml:16 的方法“添加”

# android - 如何动态添加按钮

> ID：10342240
> 
> 赞同：0
> 
> 时间：2012-04-26T22:21:53.920
> 
> 标签：android, android-widget

我想让用户添加按钮，这样每一行只有四个按钮。所以我写了以下函数：

```
private void addContact() {
        //numButton Count how many buttons there are in line
        if(numButton==0){
            LinearLayout linearLayout =new LinearLayout(this);
            linearLayout.setOrientation(0);//horizontal
            ImageButton imageButton =new ImageButton(this);
            imageButton.setImageBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.button1));
            linearLayout.addView(imageButton);
            LinearLayout linearbase= (LinearLayout)findViewById(R.id.linearBase);
            linearbase.addView(linearLayout);
            numButton++;
        }
        else if(numButton<4)
        {
            LinearLayout linearlayout= ----####Here I do not know what to write!!!!###
            ImageButton imageButton =new ImageButton(this);
            imageButton.setImageBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.button1));
            linearlayout.addView(imageButton);
            numButton++;
        }
        else 
        {
            numButton=0;
        }
    } 
```

我标记了我的问题的代码行具体来说，我的问题是如何将新按钮放入之前调用此函数中定义的线性布局中？第二个问题：即使关闭应用程序，如何保持新的情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:11:30.590

在 addContact 方法之外声明您的 LinearLayouts，否则它们只存在于该方法中。我认为*这样的事情*应该可以工作（我还没有测试过）：

```
class myclass{

    private LinearLayout linearLayout;
    private LinearLayout linearbase;
    private int numButton;

    @Override
    public void onFinishInflate() {
        super.onFinishInflate();

        linearbase= (LinearLayout)findViewById(R.id.linearBase);
        LinearLayout linearLayout =new LinearLayout(this);
        linearLayout.setOrientation(0);//horizontal

        numButton=0;
    }

    private void addContact() {
        //numButton Count how many buttons there are in line
        if(numButton==0){

            ImageButton imageButton =new ImageButton(this);
            imageButton.setImageBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.button1));
            linearLayout.addView(imageButton);
            linearbase.addView(linearLayout);
            numButton++;
        }
        else if(numButton<4)
        {
            linearLayout= new LinearLayout(this);
            ImageButton imageButton =new ImageButton(this);
            imageButton.setImageBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.button1));
            linearlayout.addView(imageButton);
            numButton++;
        }
        else 
        {
            numButton=0;
        }
    }   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:51:35.513

当你第一次创建 LinearLayout 时，给它一个 id。然后你可以用 findViewById() 第二次得到它。要回答您的第二个问题，请在[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)中存储一个布尔值。

# wpf - 使用触发器更改 ContentControl 模板

> ID：10342242
> 
> 赞同：1
> 
> 时间：2012-04-26T22:22:06.217
> 
> 标签：wpf, popup, contentcontrol

我有一个包含许多项目的列表框。当我将鼠标悬停在一个项目上时，我需要显示一个相当“沉重”的弹出窗口。我很确定为每个项目加载弹出窗口是一种资源浪费，所以我想要的只是当我将鼠标悬停在项目上时，我修改了项目中 ContentControl 的模板以包含弹出窗口。这是我目前所拥有的：（简化版）（这段代码可以粘贴到 Kaxaml 中）

```
<Page
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <Page.Resources> 

    <ControlTemplate x:Key="WithPopup" TargetType="ContentControl">
      <Grid>
        <ContentPresenter Content="{TemplateBinding Content}" Name="Target" />
        <Popup PlacementTarget="{Binding ElementName=Target}" IsOpen="True" >
            <Border BorderBrush="Red" BorderThickness="1" Background="Pink"> 
                <TextBlock Text="I'd like this to behave like a Popup - not a tooltip!" Margin="10" /> 
            </Border> 
        </Popup> 
      </Grid>
    </ControlTemplate>   
  </Page.Resources>
  <Grid Height="20" Margin="50,50,0,0" Name="ParentGrid">  
    <ContentControl>
      <TextBlock x:Name="TargetControl" Text="Hover over me!"  /> 
      <ContentControl.Style>
        <Style TargetType="ContentControl">
          <Style.Triggers>
            <DataTrigger Binding="{Binding IsMouseOver, ElementName=TargetControl}" Value="True">
              <Setter Property="Template" Value="{StaticResource WithPopup}" />
            </DataTrigger>
          </Style.Triggers>
        </Style>
      </ContentControl.Style>
    </ContentControl>
  </Grid>
</Page> 
```

问题是，当我尝试将鼠标悬停在弹出窗口上时 - 它消失了（就像工具提示一样），因为我是鼠标离开了原始的 ControlTemplate - 这导致带有弹出窗口的模板消失。有任何想法吗？ **编辑：**我也有可用的代码隐藏来实现这一点（即使我更喜欢 xaml）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T13:48:07.347

我有我认为（至少部分）的解决方案：不是通过触发器更改 ContentControl 的模板，而是使用触发器更改弹出窗口的内容似乎可行。因此，我没有为每个项目加载一个带有大型可视化树的复杂弹出窗口，而是为每个项目加载一个没有内容的简单弹出窗口 - 并且仅在鼠标输入 ContentControl 时填充该内容。像这样：

```
<Page
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <Page.Resources>
    <DataTemplate x:Key="popupContent" DataType="{x:Type ContentControl}">
      <Border BorderBrush="Red" BorderThickness="1" Background="Pink"> 
          <TextBlock Text="This is behaving like a Popup now!" Margin="10" /> 
      </Border>
    </DataTemplate>

    <ControlTemplate x:Key="WithPopup" TargetType="ContentControl">
      <Grid Name="popupGrid">
        <TextBlock Text="Hover over me!"  />
        <Popup IsOpen="True" > 
            <ContentControl Name="content" />
        </Popup> 
      </Grid>
      <ControlTemplate.Triggers>
        <DataTrigger Binding="{Binding IsMouseOver, ElementName=popupGrid}" Value="True"> 
          <Setter Property="ContentTemplate" Value="{StaticResource popupContent}"  TargetName="content" />
        </DataTrigger>
      </ControlTemplate.Triggers>
    </ControlTemplate>

  </Page.Resources>
  <Grid Height="20" Width="100" HorizontalAlignment="Left" Margin="50,50,0,0">  
    <ContentControl Template="{StaticResource WithPopup}" />
  </Grid>
</Page> 
```

我不太确定如何衡量使用这种方法在性能方面会获得多少收益，但我认为这似乎是有道理的。我仍然想听听任何其他更好的想法。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T08:51:51.540

你需要做一些不同的事情 - 尝试这样的事情：

```
<ContentControl Content="hover over me!">
    <ContentControl.ContentTemplate>
        <DataTemplate>
            <Grid>
                <TextBlock x:Name="TargetControl" Text="{TemplateBinding Content}"  />
                <Popup PlacementTarget="{Binding ElementName=Target}" x:Name="popup">
                    <Border BorderBrush="Red" BorderThickness="1" Background="Pink">
                        <TextBlock Text="I'd like this to behave like a Popup - not a tooltip!" Margin="10" />
                    </Border>
                </Popup>
            </Grid>
            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding IsMouseOver, ElementName=TargetControl}" Value="True">
                    <Setter TargetName="popup" Property="IsOpen" Value="true" />
                </DataTrigger>
                <DataTrigger Binding="{Binding IsMouseOver, ElementName=popup}" Value="true">
                    <Setter TargetName="popup" Property="IsOpen" Value="true" />
                </DataTrigger>
            </DataTemplate.Triggers>
        </DataTemplate>
    </ContentControl.ContentTemplate>
</ContentControl> 
```

# oledb - 关闭命令后访问 OleDBDataReader 是否安全

> ID：10342243
> 
> 赞同：0
> 
> 时间：2012-04-26T22:22:08.320
> 
> 标签：oledb, oledbcommand, oledbdatareader

在 Java 中，一旦 Statement 关闭，您将无法访问 ResultSet，尽管很多时候您会获得少量获取的数据，使其看起来像是打开的。但总的来说，它违反了 API 规则。

但是在 OLEDB 中，我想知道命令和阅读器是否适用相同的规则。例如，以下代码 100% 安全吗？即使命令被释放，SQL 提取游标是否会保持打开状态？

```
public OleDbDataReader ExecuteReader(string sql, OleDbConnection connection)
{
  using (OleDbCommand command = CreateCommand(sql, connection))
  {
     return command.ExecuteReader();
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:04:54.140

根本不建议这样做。你为什么要这样做？

释放命令时（当执行离开 using 块时会发生这种情况），连接不会关闭，因此您可能可以继续使用 DataReader。

然而，这是一个非常糟糕的主意：

*   您无法确定连接是否会关闭，因为它取决于外部代码。

*   这可以将锁放在数据库中，这样您就会遇到争用问题。

*   您的阅读器使用的连接保持“忙碌”状态，因此无法重复使用。

您应始终确保关闭阅读器，然后关闭相关连接。使用这种设计，您应该依靠返回的 DataReader 的用户来关闭阅读器和连接。或者至少是阅读器，如果您使用接收 CommandBehavior 的 SqlCommand.ExecuteReader 重载，您可以在其中设置 CloseConnection，以便在阅读器关闭时自动关闭连接。

但我坚持认为，你永远不应该让 DataReader 打开太久。应尽快迭代并关闭数据读取器。它可以避免将数据传输到 DataTables 和使用它的开销。即当你绑定到一个控件，比如一个DataGridView，你可以直接将数据绑定到控件，避免中间使用DataTable，这需要额外的处理时间和内存（数据到数据表然后控制，而不是直接从要控制的数据源）。

所以，也许你可以这样做，但绝对不应该！

# time-complexity - 这段代码的执行时间增长率 Big O 是多少？

> ID：10342246
> 
> 赞同：-1
> 
> 时间：2012-04-26T22:22:49.313
> 
> 标签：time-complexity, big-o

这段代码的执行时间增长率 Big O 是多少？

```
int maxValue = m[0][0];         
for (int i = 0; i < N; i++)         
{                       
    for (int j = 0; j < N; j++)         
    {                       
        if ( m[i][j] > maxValue )           
        {                       
            maxValue = m[i][j];         
        }                       
    }                       
}                   
cout << maxValue << endl;           
int sum = 0;                    
for (int i = 0; i < N; i++)         
{                       
    for (int j = 0; j < N; j++)         
    {                       
        sum = sum + m[i][j];            
    }                       
}                           
cout << sum << endl; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:26:14.653

O(N^2) 因为你有两个从 0 到 N 运行的嵌套“for”循环。

# postgresql - PostgreSQL 不允许我按顺序对列进行分组

> ID：10342247
> 
> 赞同：18
> 
> 时间：2012-04-26T22:23:04.857
> 
> 标签：postgresql, group-by, distinct, distinct-on

在 PostgreSQL 中，我想一次获取每个用户并按日期排序。

这是我的查询：

```
SELECT id, useridx, isread, message, date
  FROM messages
 WHERE isread = 1
 GROUP BY useridx
 ORDER BY date DESC 
```

这是一个**示例数据**：

```
------------------------------------------------------
+  id  |  useridx |  isread  |  messsage |  date     +
------------------------------------------------------
   1   |  1       |  0        | Hello    |  2012-01-01    
   2   |  2       |  1        | Hi       |  2012-01-02    
   3   |  3       |  1        | Test     |  2012-01-03    
   4   |  3       |  0        | My Msg   |  2012-01-04    
   5   |  4       |  1        | sadasd   |  2012-01-05    
   6   |  4       |  1        | sdfsdfd  |  2012-01-06    
   7   |  4       |  0        | sdfsdfsd |  2012-01-07    
   8   |  5       |  0        | 5345634  |  2012-01-08
   9   |  6       |  0        | sdfdfsd  |  2012-01-09
   10  |  7       |  0        | sdfsdfsf |  2012-01-10
------------------------------------------------------ 
```

现在，我要做的是通过 useridx 对它们进行分组并按日期排序来获取此表。

**预期结果**：

```
------------------------------------------------------
+  id  |  useridx |  isread  |  messsage |  date     +
------------------------------------------------------  
   6   |  4       |  1        | sdfsdfd  |  2012-01-06 
   3   |  3       |  1        | Test     |  2012-01-03  
   2   |  2       |  1        | Hi       |  2012-01-02    
------------------------------------------------------ 
```

**实际结果**

```
ERROR:  column "messages.date" must appear in the GROUP BY clause or be used in an aggregate function 
```

我也不想分组日期。我只想用 useridx 分组并按日期 DESC 对它们进行排序。

任何帮助/想法表示赞赏！

~~注意：我也尝试过 Distinct。不符合我的需要或我做错了。~~

我**很困惑，被困**在`DISTINCT ON`和`rank()`方法之间。

**结论**：对于在这里遇到相同问题的人，可以将其作为答案阅读。@kgrittn 和 @mu 都太短了，答案都是正确的。我将继续在我的项目中使用答案和模式，并且及时我可以理解哪个是最好的-我猜-。因此，选择其中之一并继续您的工作。你会没事的。

**上次更新**：有时，Distinct On 会从结果中排除一些 id。假设我有一个 id 列，我有 6 行是相同的。因此，从结果中排除它是不同的，但 rank() 只是结果。**所以，使用 rank()！**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-26T22:56:54.977

与 MySQL 不同，PostgreSQL 不显示未在聚合查询中聚合的列的随机数据。

解决方案在错误消息中

```
ERROR:  column "messages.date" must appear in the GROUP BY clause or be used in an aggregate function 
```

这意味着您必须在选择此列时按“messages.date”列分组或使用 MIN() 或 MAX() 等聚合函数

例子：

```
SELECT MIN(id), useridx, isread, message, MAX(date)
FROM messages WHERE isread = 1 
GROUP BY useridx, isread, message
ORDER BY MAX(date) DESC 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-26T23:25:17.297

您想使用[`rank()`窗口函数](http://www.postgresql.org/docs/current/static/functions-window.html)对每个`useridx`组中的结果进行排序，然后通过将排名结果包装在派生表中来剥离第一个：

```
select id, useridx, isread, message, date
from (
    select id, useridx, isread, message, date,
           rank() over (partition by useridx order by date desc) as r
    from messages
    where isread = 1
) as dt
where r = 1 
```

这将为您提供`id`样本中包含 2、3 和 6 的行。当您在同一日期`over`有多条消息时，您可能希望在其中添加辅助排序键以始终如一地做出选择。`useridx`

您至少需要 PostgreSQL 8.4 (AFAIK) 才能拥有窗口函数。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-27T12:21:49.230

另一种选择是使用`SELECT DISTINCT ON`（这与简单的非常不同`SELECT DISTINCT`）：

```
SELECT *
  FROM (SELECT DISTINCT ON (useridx)
            id, useridx, isread, message, date
          FROM messages
          WHERE isread = 1
          ORDER BY useridx, date DESC) x
  ORDER BY date DESC; 
```

在某些情况下，这可以比其他方法更好地扩展。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-08-26T08:29:41.130

多年后，但你不能只在 FROM 子查询中订购：

```
SELECT m.id, m.useridx, m.isread, m.message, m.date
FROM (
   SELECT m2.id, m2.useridx, m2.isread, m2.message, m2.date 
   FROM message m2 
   ORDER BY m2.id ASC, m2.date DESC
) m
WHERE isread = 1
GROUP BY useridx 
```

这在 PostgreSQL 9.2 中对我有用

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-26T22:34:34.660

您正在汇总结果。

这意味着`3`您将只有一行，而不是用户的 2 行。但您也为聚合行选择 `id`, `message`,`isread`列。PostgreSQL 应该如何传递这些数据？它应该`max()`是可能的值吗？也许`min()`？

我假设您希望获得有关最新消息的数据。试试这个查询：

```
SELECT id, useridx, isread, message, date FROM messages
 WHERE isread = 1 AND (useridx, date) IN
  (SELECT useridx, max(date) FROM messages WHERE isread = 1 GROUP BY useridx); 
```

# c# - 带有单引号和双引号的 XElement.SetText 编码问题

> ID：10342252
> 
> 赞同：1
> 
> 时间：2012-04-26T22:23:29.443
> 
> 标签：c#, xml, xpath, encoding, xelement

关于我正在处理的应用程序，我对 XElement 类有一个非常具体的问题。

假设我尝试将元素值设置为“test & testing more < >”

```
 XElement tester = updatedElement.XPathSelectElement("Test");
        tester.SetValue("test & testing more < >");

        // outputs
        //<Test>test &amp; testing more &lt; &gt;</Test> 
```

这是正确的，但由于我正在使用的应用程序的限制，我还需要对单引号和双引号进行编码。

假设我在调用 XElement.SetText() 之前清理了输入。

```
 XElement.SetText(stringValue.EscapeXml())

      public static string EscapeXml(this string s)
    {
        string xml = s;
        if (!string.IsNullOrEmpty(xml))
        {
            xml = xml.Replace("\"", "&quot;");
            xml = xml.Replace("'", "&apos;");
        }
        return xml;
    } 
```

将在调用 SetText 函数时`&quot;`变为。`&amp;quot;`因此，当呈现 HTML 时，它看起来像“，当我真的想要显示”时。

我需要对单引号进行编码的原因是因为有一项服务可以在运行时创建 xpath 表达式。

IE - 服务创建的 xpath 将等同于

```
XElemenet test = testParent.XPathSelectElement("Test[.='some value with single quote's ']") 
```

当作为过滤器作为 xpath 表达式放入时，单引号将导致异常。你可能会说，“为什么我不能用`&apos;`构建过滤器时替换单引号。”

我不能这样做的原因是因为有一些 ID 元素基于与 XML 节点具有相同值的过滤器进行匹配。过滤器也不会返回元素，因为父级没有任何匹配过滤表达式的内容。

双引号起作用是因为我将大量 XML 传递给服务，并且服务将我传递的 XML 转换为另一种形式的 XML。然后服务将 XML 发送到另一个服务，该服务返回另一个具有许多属性的表单：

所以说我发送了以下内容：

```
<test>Some value from the original XML "123"<test/> // cannot encode here, must be done before hand 
```

我回来

```
<test value="Some value from the original XML "123""/> 
```

在评估响应时，将双引号传递给它会导致失败。我不能简单地在它进入服务之前对其进行编码，因为属性中的值必须与我的原始元素完全匹配。

有没有人有一个 XElement 类的扩展方法，它将编码 " 和 ' 引号。我试图覆盖 SetText，但它没有成功。

任何有关解决此问题的帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T09:48:41.023

我看不出使用 XML 语法转义引号对 XPath 1.0 表达式有何帮助，因为 XPath 1.0 语法`&apos;`不被理解为转义单引号。即使使用 XPath 2.0，您也需要遵循 XPath 2.0 语法约定来转义引号，这需要将引号加倍，例如`Test[.='some value with single quote''s ']`.

如果要保存 XDocument 或 XElement 并希望强制将单引号或双引号作为实体引用进行转义，那么正确的方法是扩展 XmlWriter 实现，确保每个引号都根据需要进行转义。然后保存到您的自定义 XmlWriter 实现的实例。

# wcf - 用于故障的自定义数据合约序列化程序

> ID：10342256
> 
> 赞同：3
> 
> 时间：2012-04-26T22:23:44.047
> 
> 标签：wcf, serialization, datacontract, fault

有没有办法替换默认的数据合同序列化程序的故障？

可以通过替换`DataContractSerializerOperationBehavior`每个操作的默认值来附加自定义数据协定序列化程序。但这不会序列化/反序列化错误......

# css - CSS 字体在 IE7 和 IE8 中显示不同？

> ID：10342257
> 
> 赞同：0
> 
> 时间：2012-04-26T22:23:57.777
> 
> 标签：css

```
#solutionsNav div.leadgen div 
{
    position: relative;
    font-family: Arial, Helvetica, sans-serif;
    color: #ffffff;
    font-size: 9pt;
    padding-right: 30px;
} 
```

在 IE8 中字体看起来比在 IE7 中更粗我只是想知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:29:28.973

可能是这个？ [http://blogs.msdn.com/b/ie/archive/2006/02/03/524367.aspx](http://blogs.msdn.com/b/ie/archive/2006/02/03/524367.aspx)

# javascript - jslint：测试（新 XMLHttpRequest（））中的 overrideMimeType（）属性

> ID：10342258
> 
> 赞同：0
> 
> 时间：2012-04-26T22:24:03.690
> 
> 标签：javascript, xmlhttprequest, jslint

此代码在 Firefox 中返回 true：

```
('overrideMimeType') in (new XMLHttpRequest()) 
```

但是 jslint 给了我这个信息：

第 1 行字符 22 处的问题：意外的 'in'。与 undefined 进行比较，或者改用 hasOwnProperty 方法。

如何根据 jslint 正确编写语句？

我试过了，但它返回 false ：

```
(new XMLHttpRequest()).hasOwnProperty('overrideMimeType') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:47:08.000

采用：

```
XMLHttpRequest.prototype.hasOwnProperty('overrideMimeType') 
```

# jquery - jQuery 表单验证 (http://validator.codeplex.com/) 不适用于特定需求

> ID：10342259
> 
> 赞同：0
> 
> 时间：2012-04-26T22:24:12.303
> 
> 标签：jquery, forms, validation

我正在尝试使用此脚本来验证表单：http: [//validator.codeplex.com/](http://validator.codeplex.com/)

我正在尝试创建一个具有默认值的输入字段：“名字和姓氏”

```
<div class="RightForm"><input type="text" id="firstlastname" name="firstlastname"
value="First and Last Name" style="width: 175px; float:right;" validate="form" invalid=
"<b>First and Last Name missing</b><br/>Please enter your First and Last name." 
invalidVal="First and Last Name" /></div> 
```

如果此人在不更改默认值的情况下单击提交，我希望验证显示脚本的默认弹出警告消息“需要名字和姓氏...” - 另外，我不希望该字段留空. 所以警告应该出现在这两种情况下。

但是，现在脚本只显示“未定义”而不是错误消息。

关于如何解决的任何想法？非常感谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:33:34.167

立即脱颖而出的一件事是这段代码：

```
invalid="<b>First and Last Name missing</b><br/>Please enter your First and Last name." 
```

如果您在 HTML 属性中使用 HTML 语法字符，它们*必须*作为实体转义，否则您将破坏 javascript 可能无法理解的 HTML：

```
invalid="&lt;b&gt;First and Last Name missing&lt;/b&gt;&lt;br/&gt;Please enter your First and Last name." 
```

不用说，`invalid`这不是一个合法的 HTML 属性，而且这似乎纯粹用作 javascript 钩子。

此外，您不应填充`value`属性，而应使用`placeholder`：

```
placeholder="First and Last Name" 
```

这可能会解决您遇到的问题，因为该字段实际上没有“值”，但如果留空，文本将出现在输入中。

另外：如果你厌倦了你正在使用的库，事实上的 jQuery 验证库就是这个：

*   [http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

# c# - 是否有任何 .NET API 来获取所有防火墙规则

> ID：10342260
> 
> 赞同：4
> 
> 时间：2012-04-26T22:24:15.810
> 
> 标签：c#

我们有一个向防火墙添加一些规则的应用程序。我们需要检索防火墙的规则，以便我们可以检查该规则是否存在于防火墙中。我正在使用 C#。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-21T20:32:47.667

使用规则名称搜索防火墙规则并将其删除：

```
public static void RemoveFirewallRules(string RuleName)
{
    try
    {
        Type tNetFwPolicy2 = Type.GetTypeFromProgID("HNetCfg.FwPolicy2");
        INetFwPolicy2 fwPolicy2 = (INetFwPolicy2)Activator.CreateInstance(tNetFwPolicy2);
        var currentProfiles = fwPolicy2.CurrentProfileTypes;               

        // List of rules
        // List<INetFwRule> RuleList = new List<INetFwRule>();

        foreach (INetFwRule rule in fwPolicy2.Rules)
        {
            // Add a rule to list
            // RuleList.Add(rule);
            // Console.WriteLine(rule.Name);
            if (rule.Name.IndexOf(RuleName) != -1)
            {
                // Remove a rule
                INetFwPolicy2 firewallPolicy = (INetFwPolicy2)Activator.CreateInstance(Type.GetTypeFromProgID("HNetCfg.FwPolicy2"));                     
                firewallPolicy.Rules.Remove(rule.Name);
                Console.WriteLine(rule.Name + " has been deleted from the Firewall Policy");
            }
        }
    }
    catch (Exception r)
    {
        Console.WriteLine("Error deleting a Firewall rule");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-12-03T20:50:59.397

如果不想为提供 INetFwPolicy2 接口的程序集添加额外的引用，可以使用C# 中[的动态类](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/types/using-type-dynamic)来反映“HNetCfg.FwPolicy2”类型。请参阅此工作代码：

```
Type tNetFwPolicy2 = Type.GetTypeFromProgID("HNetCfg.FwPolicy2");
dynamic fwPolicy2 = Activator.CreateInstance(tNetFwPolicy2) as dynamic;                          
IEnumerable Rules = fwPolicy2.Rules as IEnumerable;
foreach (dynamic rule in Rules)
  {
  if (rule.Name=="My firewall rule")
    {

    }                              
  } 
```

请注意，以这种方式使用动态对象需要引用 Microsoft.CSharp 程序集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-15T13:22:13.227

已编辑：INetFwPolicy2 是管理防火墙规则的 .Net 接口[msdn](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365309%28v=vs.85%29.aspx) INetFwPolicy2 有一个规则集合，其中包含此策略的所有规则。您可以使用 Lambda 查询规则集合，如下所示：

```
INetFwPolicy2 fwPolicy = (INetFwPolicy2)Activator.CreateInstance(Type.GetTypeFromProgID("HNetCfg.FwPolicy2"));
fwPolicy2.Rules.OfType<INetFwRule>.Select.... 
```

和所有其他 Lambda 扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-28T08:55:55.890

你可以从这段代码中得到一个想法。

```
INetFwPolicy2 fwPolicy2 = (INetFwPolicy2)Activator.CreateInstance(typeFWPolicy2);

List<INetFwRule> RuleList = new List<INetFwRule>();

foreach (INetFwRule rule in fwPolicy2.Rules)
{
  RuleList.Add(rule);
} 
```

# jquery - JuiceUI 更改主题/样式

> ID：10342263
> 
> 赞同：2
> 
> 时间：2012-04-26T22:24:25.433
> 
> 标签：jquery, styles, juice-ui

是否有更改 JuiceUI 控件样式的选项？任何预定义的主题？（如果是，我找不到任何关于它的文档。）我是否像其他控件一样使用常规 CSS 设置它们的样式？（这似乎也不起作用。）

TIA

编辑：这是按钮的外观：（我没有预装 jquery 主题 - 这是一个新网站。）

![在此处输入图像描述](../Images/c25e5f416d19abd6ec1de9f03170e311.png)
我确实注意到 JuiceUI 安装了一个内容 - 主题文件夹，其中包含基础、Fresh-Squeezed 和 Supercharged。

不知道它在哪里被引用以及如何更改它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-27T13:22:22.903

目前，JuiceUI 的源代码可以成为你最好的朋友。查看这一行：[https ://github.com/appendto/juiceui/blob/master/Juice/JuiceApp.cs#L52](https://github.com/appendto/juiceui/blob/master/Juice/JuiceApp.cs#L52)

这是您要添加到 Global.asax.cs 的内容：

```
CssManager.CssResourceMapping.AddDefinition("juice-ui", new CssResourceDefinition {
    Path = "~/Content/themes/[Name of custom theme dir]/jquery-ui-1.8.18.custom.css",
    DebugPath = "~/Content/themes/[Name of custom theme dir]/jquery-ui-1.8.18.custom.css"
}); 
```

这将重新定义“juice-ui”渲染主题的位置，您将看到每个页面中的输出都使用了果汁。

抱歉，目前这一点并不明显。我们计划撰写一系列文章来涵盖这些主题，并且更新网站上的文档已经在进行中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T03:24:31.533

对于 VB... 是的，人们仍在使用它！:P

```
<%@ Application Language="VB" %>
<%@ Import Namespace="System" %>
<%@ Import Namespace="System.IO" %>
<%@ Import Namespace="System.Web.UI" %>
<%@ Import Namespace="Juice.Framework" %>

<script runat="server">

    Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)
        ' Code that runs on application startup

        Dim juiResDef As New CssResourceDefinition
        juiResDef.Path = "~/Content/themes/[Name of custom theme dir]/jquery-ui-1.8.18.custom.css"
        juiResDef.DebugPath = "~/Content/themes/[Name of custom theme dir]/jquery-ui-1.8.18.custom.css"
        CssManager.CssResourceMapping.AddDefinition("juice-ui", juiResDef)

    End Sub

</script> 
```

好走:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T17:49:33.573

另一种覆盖 Fresh-Squeezed 默认值的方法是将 jquery-ui-XXXX.custom.css 文件拖放到页面上并创建指向它的 html 链接。这将覆盖默认的 css 并应用您想要的主题。它必须在您想要使用主题的任何页面上完成。另一种方法是将 Fresh-Squeezed 文件夹视为您要使用的主题的容器，并替换该文件夹中的图像和 custom.css 文件。希望他们会在未来的版本中提供一种不同的修改方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T22:30:49.107

贝基，在查看了 GitHub 存储库后，它似乎正在使用 ui-lightness css 文件用于 jQuery UI。[https://github.com/appendto/juiceui/tree/master/Juice-Test-Site/css](https://github.com/appendto/juiceui/tree/master/Juice-Test-Site/css)您可以尝试加载不同的 jQuery 主题来代替它吗？您可能必须确保此文件未加载到您的站点上。如果我离基地很远，而你已经尝试过，请告诉我。

# java - 是否有将复制的 Web 内容转换为其底层 HTML 的 Java 库？

> ID：10342265
> 
> 赞同：0
> 
> 时间：2012-04-26T22:24:29.820
> 
> 标签：java, html

我正在尝试编写一个简单的工具，允许我从网页复制内容，将其粘贴到 JTextArea 中并将其转换为 HTML。有没有办法做到这一点？那里有图书馆可以提供帮助吗？这类似于 Dreamweaver 在您将呈现的 HTML 内容粘贴到设计区域并在代码区域中为您转换回 HTML 时所做的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:35:21.970

[您可以使用TinyMCE](http://www.tinymce.com/)，而不是使用 jTextArea

这是一个 JavaScript 所见即所得的编辑器，允许编辑 HTML，并获得代码的可视化结果。

您可以使用任何服务器技术，因为所有管道都在客户端完成。

您可以完全自定义工具栏，甚至使其完全不可见，以便它只获取粘贴的 html 并显示它。

你可以[在这里试试](http://www.tinymce.com/tryit/full.php)

# c# - C#/WCF TransactionScopeOption.Required

> ID：10342266
> 
> 赞同：2
> 
> 时间：2012-04-26T22:24:48.163
> 
> 标签：c#, transactions

我有 3 个关于 TransactionScopeOption.Required 的问题，这让我发疯，我在网上找不到他们的答案。

**A.**我很难思考什么时候我必须编写这段代码？为什么我不应该将 DoSomething2() 放在 TransactionScope4 之外的 TransactionScope3 中？
**B.**在这之后：TransactionScope4.Complete()，TransactionScope3 也是 Complete 因为它的 TransactionScope 相同，对吧？
**C.**在WCF中，当我在客户端使用TransactionScope并在其中调用一些服务的方法时，每个方法都使用我在客户端创建的TransactionScope还是创建新的？为什么要创造一个新的？如果方法创建新方法，**这就是为什么属性：TransactionAutoComplete 存在吗？**

```
using (TransactionScope TransactionScope3 = new TransactionScope())
            {
                Service1.DoSomething1();
                using (TransactionScope TransactionScope4 = new TransactionScope(TransactionScopeOption.Required))
                {
                    Service1.DoSomething2();
                    TransactionScope4.Complete();
                }
                TransactionScope3.Complete();
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:57:55.373

[这里](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.complete.aspx)记录了一个关键句子：

> ***如果 TransactionScope 对象创建了事务***，则资源管理器之间的实际提交工作发生在 End Using 语句中。如果它没有创建事务，那么只要 CommittableTransaction 对象的所有者调用 Commit，就会发生提交。

因此，要回答问题**B**，不，您的调用`TransactionScope4.Complete()`不会提交事务，因为该 TransactionScope 实例将重新使用`TransactionScope3`的事务。

回答**C**，如果你指出 WCF 服务需要一个事务，那么如果客户端上已经创建了一个现有的 TransactionScope，那么 WCF 将不会启动一个新事务（并且它不会在服务调用结束时提交，例如原因同上）。但是，如果客户端没有打开的 TransactionScope，那么 WCF 将启动一个新的，并在服务调用结束时自动提交或回滚。

# php - 在 Symfony 2 的一个简单的 bundle 类中使用容器

> ID：10342267
> 
> 赞同：4
> 
> 时间：2012-04-26T22:25:01.377
> 
> 标签：php, symfony

我在 Symfony 2 的包中创建了一个简单的类：

```
class MyTest {
    public function myFunction() {
        $logger = $this->get('logger');
        $logger->err('testing out');
    }
} 
```

我怎样才能访问容器？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-26T22:43:08.070

您需要注入服务容器。您的课程将如下所示：

```
use Symfony\Component\DependencyInjection\ContainerInterface;

class MyTest
{
    private $container;

    public function __construct(ContainerInterface $container)
    {
        $this->container = $container;
    }

    public function myFunction()
    {
        $logger = $this->container->get('logger');
        $logger->err('testing out');
    }
} 
```

然后在控制器或 ContainerAware 实例中：

```
$myinstance = new MyTest($this->container); 
```

如果您需要更多解释：[http ://symfony.com/doc/current/book/service_container.html](http://symfony.com/doc/current/book/service_container.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-27T05:28:32.473

在大多数情况下，注入整个容器是一个坏主意。单独注入所需的服务。

```
namespace Vendor;

use Symfony\Component\HttpKernel\Log\LoggerInterface;

class MyTest 
{
    private $logger;

    public function __construct(LoggerInterface $logger) 
    {
        $this->logger = $logger;
    }

    public function myFunction() 
    {
        $logger->err('testing out');
    }
} 
```

在以下位置注册服务`services.yml`：

```
services:
    my_test:
        class: Vendor\MyTest
        arguments: [@logger] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-26T22:56:23.533

为什么不只添加`@logger`服务？例如

```
arguments: [@logger] 
```

如果要添加容器（不推荐），则可以添加`@service_container`.`services.yml`

# c++ - 我可以让 Visual Studio 中断用户定义的 C++ 异常吗？

> ID：10342272
> 
> 赞同：4
> 
> 时间：2012-04-26T22:25:52.080
> 
> 标签：c++, windows, visual-studio, exception, breakpoints

我有一个引发许多（已处理）异常的应用程序。我特别想打破一种例外情况。

是否可以使调试器在特定的用户定义的异常上中断？我不明白为什么这是不可能的，因为它确实知道抛出的异常的类型。

我可以通过在异常的构造函数中设置断点来解决这个问题，但如果知道如何以“正确”的方式来做这件事会很好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T22:36:46.103

如果您进入`Debug`菜单并选择`Exceptions...`（或按`Ctrl+Alt+E`），您将看到一个对话框：

![例外对话框](../Images/2f3efb0e7e03a83aa724827ed55d6288.png)

您需要单击该`Add...`按钮，输入您的自定义类型名称，并确保选中您的新异常类型的复选框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T22:30:53.787

尝试`Debug menu > Exceptions > Add`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T22:33:05.777

是的，只需使用该[`__debugbreak`](http://msdn.microsoft.com/en-us/library/f408b4et.aspx)功能

# android - 首先还是最后调用 super.onSaveInstanceState(bundle)？

> ID：10342274
> 
> 赞同：46
> 
> 时间：2012-04-26T22:26:21.380
> 
> 标签：android

哪个更正确？这：

```
@Override protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putLong(ID, mId);
} 
```

或这个：

```
@Override protected void onSaveInstanceState(Bundle outState) {
    outState.putLong(ID, mId);
    super.onSaveInstanceState(outState);
} 
```

它们都适用于我的 Gingerbread 设备以及 Froyo 和 Ice Cream Sandwich 模拟器，而且我看到的例子很多，其中一种方式和另一种方式一样多。有关系吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-04-26T22:27:23.267

只要您的键不冲突（例如，`ID`与 Android 内部使用的相同），两者是相同的。

# c++ - 与 c/c++ 中的结构指针混淆

> ID：10342279
> 
> 赞同：3
> 
> 时间：2012-04-26T22:26:49.240
> 
> 标签：c++, c

我试图消除一些与在类中用作成员的结构的指针的混淆。我编写了以下代码，但即使程序编译它也会崩溃。你能说一下我在下面的代码中做错了什么吗？

```
#include<stdio.h>
#include<string.h>

struct a{
    int s;
    int b;
    char*h;
};

class test
{
public:
    a * f;
    void dh();
    void dt();
};

void test::dh()
{
    a d;
    d.s=1;
    d.b=2;
    d.h="ffdf";
    f=&d;
}

void test::dt()
{
    printf("%s %d %d",f->h,f->b,f->s);
}

int main()
{
    test g;
    g.dh();
    g.dt();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T22:28:20.043

```
void test::dh()
{
    a d; <--
    d.s=1;
    d.b=2;
    d.h="ffdf";
    f=&d; <--
} 
```

您正在创建一个本地对象，`d`然后设置`f`为该对象的地址。一旦函数结束，对象就会超出范围，你会留下一个悬空指针。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-26T22:29:39.460

你最大的问题是，到了`dh()`回报的时候，`d`已经不在范围内了。而不是`a d;`in `dh()`，你需要`f = new a(); f.s=1; f.b=2, f.h="ffdf";`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T22:31:44.043

在 test::dh 中，您将公共指针 f 分配给 d 的地址，它是一个局部变量。退出时`g.dh();` ，d 的地址不再有效，这就是对 f 的引用`g.dt();`失败的原因。

# android - 为 Android 应用选择数据库

> ID：10342286
> 
> 赞同：0
> 
> 时间：2012-04-26T22:27:45.587
> 
> 标签：android, sql, mongodb, database

我想和我的朋友一起构建一个饮料应用程序，只是为了玩构建 Android 应用程序和编程。

我们希望包括用户登录，即身份验证。将保留的数据将包括饮料配方、与评论、书面评论、数字评级、类别等相关联。

我的主要问题是这种类型的应用程序使用什么样的数据库？我有使用 SQL（MySQL 和 MSSQL）和 MongoDB 的经验。我倾向于 Mongo - 缺乏结构化列的灵活性对我很有吸引力，但是我以前从未做过用户身份验证 - 将密码存储为哈希等。如果 Mongo 合适，有人能指出我正确的方向吗？我以前用谷歌搜索过，记得有一些图书馆可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:31:56.340

对于持久性本地存储，您只能在 android 中使用 SQLite。[使用这些](http://developer.android.com/reference/android/database/sqlite/package-summary.html)类的 android 操作系统支持此 SQLite 存储。

如果您正在考虑远程持久存储，那么在这种情况下，托管在远程服务器上的任何数据库都可以用于存储数据。

# git - Git - 相同程序实例的独立分支或不同存储库，用途略有不同

> ID：10342287
> 
> 赞同：1
> 
> 时间：2012-04-26T22:27:51.703
> 
> 标签：git, branch, organization, project-organization

我最近开始使用 git 并有一个问题。我有一个程序的两个分支，一个使用算法 A，一个使用算法 B。这些算法做同样的事情不同。现在，对于这两个分支中的每一个，我都想为不同类型的数据创建不同的程序实例（最多可以有 50 个不同的实例）。在您问之前，由于复杂性和性能问题，我无法将它们全部合并到同一个程序中。

此外，如果可能的话，我希望能够修改核心（即在所有实例之间共享的源的一部分）和所有要随更改更新的实例。

你会推荐什么方法来实现这一目标？

PS：由于我的问题可能不是很清楚，请随时询问任何其他信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:42:36.660

如果他们以不同的方式做同样的事情，请尝试使它们符合通用接口/API。如果你能做到这一点，那么应用桥接模式这两个实现可以只存在于不同的子目录中。您实际上并不需要 git 或分支来管理这个——只需在 Bridge 后面有两种不同的实现，并在运行时（或编译时，因为您似乎更喜欢编译时方法）选择正确的 impl。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:32:12.447

您可以拥有一个带有核心代码的 master 分支和 2 个带有 alg 和 alg B 的其他分支，这样您就可以将 master 合并到您的算法分支。这样，您可以拥有两个不同的程序，它们具有不同的算法但具有相同的核心。我真的不明白你所说的实例是什么意思

# apache - htaccess rewrite 用 / 替换 .php

> ID：10342289
> 
> 赞同：0
> 
> 时间：2012-04-26T22:27:56.747
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting, rewrite

我最近开始了一个新网站，为了保持链接干净，我想重写 url。
我需要像这样重写链接：

www.domain.com/post.php?post=15
↓
www.domain.com/post/15

和

www.domain.com/user.php?user=USERNAME
↓
www.domain .com/user/USERNAME

我曾经将链接从 www.domain.com/page.php?page=PAGE 更改为 www.domain.com/PAGE ，但这次我需要“post”和“user”才能正常工作，但我不能很清楚。
有人可以帮我提供有关如何执行此操作的提示吗？
提前谢谢你
克里斯

在 Jon Lin 的帮助下解决了。他的回答很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T16:09:05.373

您需要正则表达式中的“/”才能使其工作。但是如果你的链接是相对的，浏览器会尝试解析它们`http://domain.com/page/some.css`而不是`http://domain.com/some.css`. 您需要将此添加到所有页面的顶部：

```
<base href="/"> 
```

或者你所有相关链接的基础应该是什么。你的规则应该是这样的：

```
RewriteRule ^post/([^/]*)$ /post.php?p=$1 [L]
RewriteRule ^user/([^/]*)$ /user.php?p=$1 [L] 
```

这应该重写像`http://www.domain.com/post/15`和`http://www.domain.com/user/USERNAME`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:29:58.987

尝试研究一些 PHP 框架。他们将帮助您做到这一点，并帮助您保持代码更清洁和更易于管理

# c# - 我的控件位置与 MouseDown 和 -Up 事件的位置之间似乎不匹配

> ID：10342291
> 
> 赞同：0
> 
> 时间：2012-04-26T22:28:09.557
> 
> 标签：c#, winforms, coordinates, point

我正在尝试设置在 MouseDown 和 MouseUp 事件之间定义的矩形内的每个 TextBox 的背景颜色，其中 MouseUp 事件发生在 MouseDown 事件的右侧和下方。

我以这种方式捕获积分：

```
static readonly Color PSEUDO_HIGHLIGHT_COLOR = Color.Gainsboro;
private Point selectionStart; 
private Point selectionEnd; 

. . .

private void flowLayoutPanelGreatGooglyMoogly_MouseDown(object sender, MouseEventArgs e) {
    if (e.Button == MouseButtons.Left) {
        selectionStart = PointToClient(MousePosition);
    }
}

private void flowLayoutPanelGreatGooglyMoogly_MouseUp(object sender, MouseEventArgs e) {
    if (e.Button == MouseButtons.Left) {
        selectionEnd = PointToClient(MousePosition);

        HighlightAllTextBoxValsBetweenPoints();
    }
} 
```

...下面的代码应该将 TextBoxes 的 BackColor 设置在点描述的虚拟矩形“下方”：

```
private void HighlightAllTextBoxValsBetweenPoints() {
    TextBox tb;
    foreach (Control ctrl in flowLayoutPanelGreatGooglyMoogly.Controls) {
        if (ctrl is TextBox) {
            tb = (TextBox)ctrl;
            if ((tb.Location.X >= selectionStart.X) &&
                (tb.Location.Y >= selectionStart.Y) &&
                (tb.Location.X <= selectionEnd.X) &&
                (tb.Location.Y >= selectionEnd.Y)) {
                tb.BackColor = PSEUDO_HIGHLIGHT_COLOR;
            }
        }
    }
} 
```

...但是，尽管代码正在执行，但没有一个 TextBox 被视为在这些约束范围内。

就好像我在拖着一张好美国的地图，但桥下的巨魔告诉我堪萨斯州真的在加拿大。

我的逻辑可能混淆或倒退（未能正确比较 X 和 Y 坐标），或者我未能将点从相对转换为绝对，反之亦然。

## 更新：

答案几乎是完美的（约翰怎么知道我的 FlowLayoutPanel 位于它所在的位置）；为了让它工作，我只需要在他的代码上方添加这个：

```
// Have to subtract the Top (Y) value of the Panel 
int DeltaFromFormTopToPanelTop = flowLayoutPanelGreatGooglyMoogly.Location.Y; 
selectionStart.Y = selectionStart.Y - DeltaFromFormTopToPanelTop; 
selectionEnd.Y = selectionEnd.Y - DeltaFromFormTopToPanelTop; 
```

## 更新到更新

当用户只选择一个控件时，为了防止着色/提示，我也必须添加以下代码：

```
if (e.Button == MouseButtons.Left) {
  selectionEnd = PointToClient(MousePosition);
  if (MouseHasNotMovedFar()) {
    return;
  }
  HighlightAllTextBoxValsBetweenPoints();
  PromptForAndAssignInputValue();
}

private bool MouseHasNotMovedFar() {
// The "X" or horizontal, is TextBoxWidth*2 + LabelWidth*1
// The "Y" or vertical, is TextBoxHeight*2
// If the user has moved the mouse less than these between
// MouseDown and MouseUp, they probably have not dragged to 
// select multiple TextBoxes.
  const int ACCEPTABLE_X_DELTA = 74;
  const int ACCEPTABLE_Y_DELTA = 40;
  return (selectionEnd.X - selectionStart.X) <= ACCEPTABLE_X_DELTA &&
         (selectionEnd.Y - selectionStart.Y) <= ACCEPTABLE_Y_DELTA;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:21:14.850

有几个问题。
首先 - 文本框坐标相对于 flowLayoutPanel。因此，您的 PointToClient 必须相同：

```
selectionStart = flowLayoutPanelGreatGooglyMoogly.PointToClient(MousePosition); 
```

第二 - 你有一个逻辑错误；最后的比较被颠倒了。(tb.Location.Y **>=** selectionEnd.Y)) {

简化过程并允许向任何方向拖动的建议是使用矩形：

```
private void HighlightAllTextBoxValsBetweenPoints()
{
    var selectionBounds = new Rectangle(
        selectionStart.X, 
        selectionStart.Y, 
        selectionEnd.X - selectionStart.X, 
        selectionEnd.Y - selectionStart.Y);
    foreach (Control ctrl in flowLayoutPanel1.Controls)
    {
        var tb = ctrl as TextBox;
        if (tb == null)
            continue;

        if (tb.Bounds.IntersectsWith(selectionBounds))
            tb.BackColor = PSEUDO_HIGHLIGHT_COLOR;
    }
} 
```

# asp.net-mvc-3 - MVC ASP.NET 返回 response.GetResponseStream() 作为 FileResultStream

> ID：10342294
> 
> 赞同：1
> 
> 时间：2012-04-26T22:28:23.620
> 
> 标签：asp.net-mvc-3, c#-4.0, stream, httpwebresponse, fileresult

我正在尝试编写一个控制器，该控制器创建并向返回图像的服务发出 HttpWebRequest。然后我想将此图像作为 FileResult 返回。我该怎么做。我已经尝试了下面的代码，但它返回一个损坏的图像而不是完整的图像：

```
public FileResult SomeAction()
{
    var request = Make some request here

    using (var response = (HttpWebResponse)request.GetResponse())
    {
        string contentType = response.ContentType;
        return File(response.GetResponseStream(),contentType);
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T22:42:08.467

由于您没有提及“它不起作用”，我只能告诉您，总的来说，您正在做的事情应该起作用。但是，我不确定实际读取响应流的位置。由于您将 return 放在 using 中，因此可能是在实际读取流之前处理了流。尝试删除 using 语句，然后执行以下操作：

```
var response = request.GetResponse();
File(response.GetResponseStream(), response.ContentType); 
```

如果这不起作用，则验证响应实际上返回的是内容类型和有效的流。

编辑：

看来我是对的，如果将文件流包装在 using 中，文件流在读取之前会被关闭。您不必担心处理流，因为 File 会在处理完后处理它。

请参阅另一个问题：

[在 ASP.NET 中实现文件下载时如何处理我的文件流？](https://stackoverflow.com/questions/3084366/how-do-i-dispose-my-filestream-when-implementing-a-file-download-in-asp-net)

# java - Google App Engine 本地数据存储控制台

> ID：10342295
> 
> 赞同：2
> 
> 时间：2012-04-26T22:28:25.160
> 
> 标签：java, google-app-engine, localdb

当我使用 Eclipse 插件运行我的 GWT 应用程序时，我可以在 [http://localhost:8888/_ah/admin](http://localhost:8888/_ah/admin)访问本地 ds 查看器，但是在转换为 mvn 项目后，我得到了一个 `HTTP ERROR: 404 NOT_FOUND RequestURI=/_ah/admin Powered by Jetty://` 我可以在同一个端口上访问我的应用程序，所以确实如此8888.请给点建议，谢谢

**更新**：pom.xml

`

```
<plugin>
  <groupId>net.kindleit</groupId>
 <artifactId>maven-gae-plugin</artifactId>
                <version>0.8.4</version>
                <configuration>
                    <port>81</port>
                    <disableUpdateCheck>true</disableUpdateCheck>
                    <encoding>UTF-8</encoding>                                
                 <keepTempUploadDir>true</keepTempUploadDir>
                 <unpackVersion>${gaeVersion}</unpackVersion>
            <sdkDir>${settings.localRepository}/com/google/appengine/appengine-java-sdk/1.5.2/appengine-java-sdk-1.5.2</sdkDir>
                </configuration>                
            </plugin> 
```

`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T09:29:41.287

I managed to get it to work by adding:

```
<server>com.google.appengine.tools.development.gwt.AppEngineLauncher</server>
            <appEngineVersion>${gaeVersion}</appEngineVersion> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T05:16:14.293

您可以在以下位置设置端口`pom.xml`：

```
 <plugin>
    <groupId>net.kindleit</groupId>
    <artifactId>maven-gae-plugin</artifactId>
    <version>0.9.2</version>
    ...
    <configuration>
      <port>8765</port>
    </configuration>
  </plugin>

  <pluginRepositories>
    <pluginRepository>
      <id>maven-gae-plugin-repo</id>
      <name>maven-gae-plugin repository</name>
      <url>http://maven-gae-plugin.googlecode.com/svn/repository/</url>
    </pluginRepository>
  </pluginRepositories> 
```

然后检查控制台输出：

```
27.04.2012 07:13:22 com.google.appengine.tools.development.DevAppServerImpl start
INFO: The server is running at http://localhost:8765/
27.04.2012 07:13:22 com.google.appengine.tools.development.DevAppServerImpl start
INFO: The admin console is running at http://localhost:8765/_ah/admin 
```

# php - 它没有附加正确的文件名？

> ID：10342305
> 
> 赞同：0
> 
> 时间：2012-04-26T22:29:25.827
> 
> 标签：php, javascript, json

我在附加 imageNameArray 时遇到问题，它应该显示已上传的文件名。

问题是，假设我之前上传了 3 个文件（cat.png、dog.png 和 pig.png），当我刷新页面并上传另一个文件（panda.png）时，当我上传文件时，它应该显示'熊猫.png'。但它只是附加了之前上传的文件（cat.png、dog.png 和 pig.png）的名称，而不附加 panda.png。

如果我再次刷新页面并上传另一个文件（tiger.png），那么当我上传文件时，它应该显示“tiger.png”。但它只是附加了之前上传的文件的名称（cat.png、dog.png 和 pig.png 和 panda.png），它不附加tiger.png。

如果我上传另一个文件（不是刷新页面），例如 monkey.png，那么它会再次附加 cat.png、dog.png 和 pig.png 和 panda.png。没有猴子.png。

为什么会这样？我想要的是，当一个文件被上传时，它的名字被附加，但它不想这样做:(

下面是发生附加的 javascript 代码：

```
function stopImageUpload(success){
    var imageNameArray = <?php echo json_encode(isset($_SESSION ['fileImage']) ? $_SESSION ['fileImage'] : null); ?>;
    var result = '';
    if (success == 1) {
        result = '<span class="msg">The file was uploaded successfully!</span><br/><br/>';

        console.log(imageNameArray);
        for(var i=0;i<imageNameArray.length;i++) {
            $('.listImage').append(imageNameArray[i]+ '<br/>');
        }
        console.log((imageNameArray instanceof Array ? 'for' : 'for-in'));    
    } else {
        result = '<span class="emsg">There was an error during file upload!</span><br/><br/>';
    }
    return true;   
} 
```

下面是它上传文件的 php 脚本以及 $_SESSION 变量检索其文件名的位置：

```
<?php

    session_start();

    $result = 0;
    $errors = array ();
    $dirImage = "ImageFiles/";

    if (isset ( $_FILES ['fileImage'] ) && $_FILES ["fileImage"] ["error"] == UPLOAD_ERR_OK) {
        $fileName = $_FILES ['fileImage'] ['name'];

        $fileExt = pathinfo ( $fileName, PATHINFO_EXTENSION );
        $fileExt = strtolower ( $fileExt );

        $fileDst = $dirImage . DIRECTORY_SEPARATOR . $fileName;

        if (count ( $errors ) == 0) {
            if (move_uploaded_file ( $fileTemp, $fileDst )) {
                $result = 1;
            }
        }
    }

    $_SESSION ['fileImage'][] = $_FILES ['fileImage']['name'];

?>

<script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php echo $result;?>);</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T04:57:01.343

您在第一行 stopImageUpload 函数将会话值分配给 imageNameArray 变量。所以 imageNameArray 变量包含了之前上传的图片名称。尝试换行 `var imageNameArray = <?php echo json_encode(isset($_SESSION ['fileImage']) ? $_SESSION ['fileImage'] : null); ?>;`

作为

```
var imageNameArray = new Array(); 
```

# algorithm - 使用堆栈的非递归深度优先搜索 (DFS)

> ID：10342306
> 
> 赞同：12
> 
> 时间：2012-04-26T22:29:26.977
> 
> 标签：algorithm, graph, graph-algorithm, depth-first-search

好的，这是我在 Stack Overflow 上的第一篇文章，我已经阅读了一段时间，非常欣赏这个网站。我希望这是可以接受的问题。因此，我一直在阅读 Intro to Algorithms (Cormen. MIT Press)，并且一直在学习图形算法。我一直在非常详细地研究为广度和深度优先搜索制定的正式算法。

这是深度优先搜索的伪代码：

```
DFS(G)
-----------------------------------------------------------------------------------
1  for each vertex u ∈ G.V
2      u.color ← WHITE       // paint all vertices white; undiscovered
3      u.π ← NIL
4      time ← 0              // global variable, timestamps
5  for each vertex u ∈ G.V
6      if u.color = WHITE
7          DFS-VISIT(G,u)

DFS-VISIT(G, u)
-----------------------------------------------------------------------------------
1  u.color ← GRAY          // grey u; it is discovered
2  time ← time + 1 
3  u.d ← time
4  for each v ∈ G.Adj[u]   // explore edge (u,v)
5      if v.color == WHITE
6          v.π ← u
7          DFS-VISIT(G,v) 
8  u.color ← BLACK         // blacken u; it is finished
9  time ← time + 1
10 u.f ← time 
```

该算法是递归的，它从多个来源进行（将发现未连接图中的每个顶点）。它具有大多数特定于语言的实现可能会遗漏的几个属性。它区分了 3 种不同的顶点“颜色”。它最初将它们全部涂成白色，然后当它们被“发现”（在 DFS-VISIT 中访问）时，它们被涂成灰色。DFS-VISIT 算法运行一个循环，在当前顶点的邻接列表上递归地调用自身，并且仅当顶点没有到任何白色节点的边时才将顶点绘制为黑色。

每个顶点的另外两个属性也被维护 ud 和 uf 是发现顶点（涂成灰色）或完成顶点（涂成黑色）的时间戳。第一次绘制节点时，它的时间戳为 1，每次绘制另一个节点时（无论是灰色还是黑色），它都会递增到下一个整数值。u.π 也被维护，它只是一个指向发现 u 的节点的指针。

```
Algorithm Non-Recursive-DFS(G)
-----------------------------------------------------------------------------------
1   for each vertex u ∈ G.V
2       u.color ← WHITE
3       u.π ← NIL
4   time = 0
5   for each vertex u ∈ G.V
6       if u.color = WHITE
7           u.color ← GRAY
8           time ← time + 1
9           u.d ← time
7           push(u, S)
8           while stack S not empty
9               u ← pop(S)
10              for each vertex v ∈ G.Adj[u]
11                  if v.color = WHITE
12                      v.color = GRAY
13                      time ← time + 1
14                      v.d ← time
15                      v.π ← u
16                      push(v, S)
17              u.color ← BLACK 
18              time ← time + 1
19              u.f ← time 
```

*** 编辑 2012 年 10 月 31 日 ***很尴尬，我的算法已经错误了这么久，它在大多数情况下都可以工作，但不是全部。我刚刚为该问题获得了一个受欢迎的问题徽章，我看到 Irfy 在下面的答案中发现了问题，所以这就是功劳所在。我只是在这里为将来需要它的任何人修复它。

有人看到上述算法的缺陷吗？到目前为止，我还不是图论方面的专家，但我认为我对递归和迭代有很好的掌握，我相信这应该也是一样的。我希望使它在功能上等同于递归算法。即使不需要，它也应该保留第一个算法的所有属性。

当我开始写它时，我不认为我会有一个三重循环，但结果就是这样。当我环顾谷歌时，我看到了其他只有双重嵌套循环的迭代算法，但是，它们似乎并没有从多个来源进行。（即他们不会发现未连接图的每个顶点）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T23:10:14.917

两种算法都很好。第二个是从递归到基于堆栈的直接转换。所有变异状态都存储在堆栈中。`G`在算法执行过程中永远不会改变。

算法将根据算法访问每个节点的顺序为每个断开连接的区域生成生成树。树将通过对父节点 ( `u.π`) 的引用和分段树 (`u.d`和`u.f`) 来表示。

子节点将引用其父节点（或者`NULL`如果它是根节点），并且其范围 ( `child.d .. child.f`) 包含在其父节点的范围内。

```
parent.d < child.d < child.f < parent.f

child.π = parent 
```

* * *

**编辑：**我在翻译中发现了一个错误。您实际上并不是将当前状态推入堆栈，而是未来的方法参数。此外，您没有为弹出的节点着色`GRAY`并设置`f`字段。

这是对原始第一个算法的重写：

```
algorithm Stack-DFS(G)
    for each vertex u ∈ G.V
        u.color ← WHITE
        u.π ← NIL
    time ← 0
    S ← empty stack
    for each vertex u ∈ G.V
        if u.color = WHITE
            # Start of DFS-VISIT
            step ← 1
            index ← 0
            loop unconditionally
                if step = 1
                    # Before the loop
                    u.color ← GRAY
                    time ← time + 1
                    u.d ← time
                    step ← 2
                if step = 2
                    # Start/continue looping
                    for each vertex v ∈ G.Adj[u]
                        i ← index of v
                        if i ≥ index and v.color = WHITE
                            v.π ← u
                            # Push current state
                            push((u, 2, i + 1), S)
                            # Update variables for new call
                            u = v
                            step ← 1
                            index ← 0
                            # Make the call
                            jump to start of unconditional loop
                    # No more adjacent white nodes
                    step ← 3
                if step = 3
                    # After the loop
                    u.color ← BLACK
                    time ← time + 1
                    u.right ← time
                    # Return
                    if S is empty
                        break unconditional loop
                    else
                        u, step, index ← pop(S) 
```

可能有几个地方可以优化，但至少现在应该可以工作。

结果：

```
Name   d    f   π
q      1   16   NULL
s      2    7   q
v      3    6   s
w      4    5   v
t      8   15   q
x      9   12   t
z     10   11   x
y     13   14   t
r     17   20   NULL
u     18   19   r 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-05T18:26:38.280

我想我设法编写了一个更简单的伪代码。

但首先要说几句让事情变得更清楚：

1.  v.pDescendant - 指向由其邻接列表给出的顶点后代的指针。
2.  在邻接列表中，我假设每个元素都有一个字段“pNext”，指向链表上的下一个元素。
3.  我使用了一些 C++ 语法，主要是“->”和“&”来强调什么是指针，什么不是。
4.  Stack.top() 返回指向堆栈第一个元素的指针。但与 pop() 不同的是，它不会删除它。

该算法基于以下观察：一个顶点在被访问时被压入堆栈。并且仅在我们完成检查（变黑）其所有后代时才删除（弹出）。

```
DFS(G)
1\. for all vertices v in G.V do
2\.   v.color = WHITE; v.parent = NIL; v.d = NIL; v.f = NIL; v.pDescendant = adj[v].head
3\. time = 0 
4\. Initialize Stack
5\. for all vertices v in G.V s.t. v.color == WHITE do
6\.   time++
7\.   Stack.push(&v)
8\.   v.color = GRAY 
9\.   v.d = time 
10\.   DFS-ITERATIVE(G,v)

DFS-ITERATIVE(G,s) 
1\. while Stack.Empty() == FALSE do
2\.   u = Stack.top();
3\.   if u.pDescendant == NIL // no Descendants to u || no more vertices to explore
4\.      u.color = BLACK
5\.      time++
6\.      u.f = time
7\.      Stack.pop()
8\.   else if (u.pDescendant)->color == WHITE
9\.      Stack.push(u.pDescendant)
10\.     time++
10\.     (u.pDescendant)->d = time
11\.     (u.pDescendant)->color = GRAY
12\.     (u.pDescendant)->parent = &u
12\.     u.pDescendant= (u.pDescendant)->pNext // point to next descendant on the adj list      
13\.  else
14\.     u.pDescendant= (u.pDescendant)->pNext // not sure about the necessity of this line 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-31T16:46:29.840

```
int stackk[100];
int top=-1;
void graph::dfs(int v){
 stackk[++top]=v;
// visited[v]=1;
 while(top!=-1){
   int x=stackk[top--];
   if(!visited[x])
    {visited[x]=1;
     cout<<x<<endl;
    }
   for(int i=V-1;i>=0;i--)
   {
        if(!visited[i]&&adj[x][i])
        {   //visited[i]=1;
            stackk[++top]=i;
        }
   }
 }
}
void graph::Dfs_Traversal(){
 for(int i=0;i<V;i++)
  visited[i]=0;
 for(int i=0;i<V;i++)
  if(!visited[i])
    g.dfs(i); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-20T13:46:04.470

这是 C++ 中的代码。

```
class Graph
{
    int V;                          // No. of vertices
    list<int> *adj;                 // Pointer to an array containing adjacency lists
public:
    Graph(int V);                    // Constructor
    void addEdge(int v, int w);             // function to add an edge to graph
    void BFS(int s);                    // prints BFS traversal from a given source s
    void DFS(int s);
};

Graph::Graph(int V)
{
    this->V = V;
    adj = new list<int>[V]; //list of V list
}

void Graph::addEdge(int v, int w)
{
    adj[v].push_back(w); // Add w to v’s list.
}

  void Graph::DFS(int s)
        {
                 //mark unvisited to each node
        bool *visited  = new bool[V];
        for(int i = 0; i<V; i++)
            visited[i] =false;
        int *d = new int[V];  //discovery
        int *f = new int[V]; //finish time

        int t = 0;       //time

        //now mark current node to visited
        visited[s] =true;
        d[s] = t;            //recored the discover time

        list<int> stack;

        list<int>::iterator i;

        stack.push_front(s);
        cout << s << " ";

        while(!(stack.empty()))
        {
            s= stack.front();
            i = adj[s].begin();

            while ( (visited[*i]) && (i != --adj[s].end()) )
            {
                ++i;
            }
            while ( (!visited[*i])  )
            {

                visited[*i] =true;
                t++;
                d[*i] =t;
                if (i != adj[s].end())
                    stack.push_front(*i);

                cout << *i << " ";
                i = adj[*i].begin();

            }

            s = stack.front();
            stack.pop_front();
            t++;
            f[s] =t;

        }
        cout<<endl<<"discovery time of the nodes"<<endl;

        for(int i = 0; i<V; i++)
        {
            cout<< i <<" ->"<< d[i] <<"    ";
        }
        cout<<endl<<"finish time of the nodes"<<endl;

        for(int i = 0; i<V; i++)
        {
            cout<< i <<" ->"<< f[i] <<"   ";
        }

    }

         int main()
         {
        // Create a graph given in the above diagram
        Graph g(5);
        g.addEdge(0, 1);
        g.addEdge(0, 4);
        g.addEdge(1, 4);
        g.addEdge(1, 2);
        g.addEdge(1, 3);
        g.addEdge(3, 4);
        g.addEdge(2, 3);

        cout << endl<<"Following is Depth First Traversal (starting from vertex 0) \n"<<endl;
        g.DFS(0);

        return 0;
    } 
```

*简单的迭代 DFS。您还可以查看发现时间和完成时间。有任何疑问请评论。我已经包含了足够的注释来理解代码。*

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-05-19T12:18:52.023

在非递归版本中，我们需要另一种颜色来反映递归堆栈中的状态。因此，我们将添加一个 color=RED 来指示该节点的所有子节点都被推入堆栈。我还将假设堆栈有一个 peek() 方法（否则可以用 pop 和立即推送来模拟）

因此，添加后原始帖子的更新版本应如下所示：

```
for each vertex u ∈ G.V
      u.color ← WHITE
      u.π ← NIL
  time = 0
  for each vertex u ∈ G.V
      if u.color = WHITE
          u.color ← GRAY
          time ← time + 1
          u.d ← time
          push(u, S)
          while stack S not empty
              u ← peek(S)
              if u.color = RED
                  //means seeing this again, time to finish
                  u.color ← BLACK
                  time ← time + 1
                  u.f ← time
                  pop(S) //discard the result
              else
                  for each vertex v ∈ G.Adj[u]
                     if v.color = WHITE
                         v.color = GRAY
                         time ← time + 1
                         v.d ← time
                         v.π ← u
                         push(v, S)
                   u.color = RED 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-08-17T12:39:14.450

```
I used Adjacency Matrix:    

void DFS(int current){
        for(int i=1; i<N; i++) visit_table[i]=false;
        myStack.push(current);
        cout << current << "  ";
        while(!myStack.empty()){
            current = myStack.top();
            for(int i=0; i<N; i++){
                if(AdjMatrix[current][i] == 1){
                    if(visit_table[i] == false){ 
                        myStack.push(i);
                        visit_table[i] = true;
                        cout << i << "  ";
                    }
                    break;
                }
                else if(!myStack.empty())
                    myStack.pop();
            }
        }
    } 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-04-26T22:41:42.570

您的非递归代码确实存在严重缺陷。

检查是否`v`为 is后`WHITE`，在 push 之前从未标记它`GRAY`，因此它可能会被视为`WHITE`一次又一次来自其他未访问的节点，从而导致对该`v`节点的多次引用推入堆栈。这可能是一个灾难性的缺陷（可能导致无限循环等）。

`.d`此外，除了根节点之外，您不进行设置。这意味着[嵌套集模型](http://en.wikipedia.org/wiki/Nested_set_model)属性`.d`s 和`.f`s 将不正确。（如果您不知道`.d`s 和`.f`s 是什么，请阅读那篇文章，当时对我很有启发。这篇文章`left`是你的`.d`，`right`也是你的`.f`。）

您的内部`if`基本上需要与外部相同，`if`减去循环，加上父引用。那是：

```
11                  if v.color = WHITE
++                      v.color ← GRAY
++                      time ← time + 1
++                      v.d ← time
12                      v.π ← u
13                      push(v, S) 
```

纠正那个，它应该是一个真正的等价物。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-02-01T16:21:37.733

我相信至少有一种情况是递归和堆栈版本在功能上不等效。考虑三角形的情况 - 顶点 A、B 和 C 相互连接。现在，使用递归 DFS，使用源 A 获得的前驱图将是 A->B->C 或 A->C->B （ A->B 意味着 A 是 B 的父级第一棵树）。

但是，如果您使用 DFS 的堆栈版本，则 B 和 C 的父级将始终记录为 A。B 的父级永远不会是 C，反之亦然（递归 DFS 始终是这种情况）。这是因为，在探索任意顶点（此处为 A）的邻接表时，我们一次性推送所有邻接表（此处为 B 和 C）的*成员*。

如果您尝试使用 DFS 在图中查找关节点，这可能会变得相关 [1]。一个例子是，仅当我们使用 DFS 的递归版本时，以下语句才成立。

> 当且仅当它在深度优先树中至少有两个孩子时，根顶点才是一个关节点。

在三角形中，显然没有关节点，但 stack-DFS 仍然为深度优先树中的任何源顶点提供两个孩子（A 有孩子 B 和 C）。只有当我们使用递归 DFS 创建深度优先树时，上述陈述才成立。

[1] 算法简介，CLRS - 问题 22-2（第二版和第三版）

# asp.net - 运行 aspnet_regsql.exe 错误

> ID：10342308
> 
> 赞同：1
> 
> 时间：2012-04-26T22:29:38.223
> 
> 标签：asp.net, database, asp.net-membership

当我尝试在我的数据库上运行 aspnet_regsql.exe 时，当我进入选择服务器和数据库屏幕并尝试选择数据库时，会显示以下错误：

*从 SQL 服务器查询数据库名称列表失败。建立与 SQL Server 的连接时发生网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL 服务器是否配置为允许远程连接。（提供者：命名管道提供者，错误：40 - 无法打开与 SQL Server 的连接）*

我遵循了几个教程，但没有任何效果。大多数人只是说遵循安装向导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:44:48.827

您的 SQL Server 实例是否可以通过命名管道访问？默认情况下，SQL Server 现在被锁得很紧，所以你可能需要启用命名管道（或者如果它不在本地计算机上，则打开防火墙端口）。

网络协议更改是使用[SQL Server 配置管理器](http://technet.microsoft.com/en-us/library/ms174212%28v=sql.105%29.aspx)进行的。

[这里](http://blog.sqlauthority.com/2009/05/21/sql-server-fix-error-provider-named-pipes-provider-error-40-could-not-open-a-connection-to-sql-server-microsoft-sql-server-error/)有一个很好的教程。

# java - JProgressBar 绘制问题

> ID：10342309
> 
> 赞同：1
> 
> 时间：2012-04-26T22:29:39.330
> 
> 标签：java, swing, jframe, jprogressbar, event-dispatch-thread

当我设置 JProgressBar 的最小值、值和最大值时，它们不会更新，除非我关闭窗口并重新打开它。

* * *

图片：

![在此处输入图像描述](../Images/cebd322759d9dc444153ee9ba979814b.png)

谁能给我任何见解？我在这个问题上摸不着头脑。我进行了测试以确保解析正确完成（就是这样）。我测试只是直接输入数字。显然它有效，它只是在第一次打开窗口时不显示（这让我认为如果我更新值它只会显示最后一个值。

*** 编辑 ***

女士们，先生们……我可以介绍一下……SSCCE。我很抱歉发布这个，因为现在你会因为这个而感到我的痛苦：x

* * *

```
package com.jayavon.game.helper;

import javax.swing.*;
import java.awt.event.*;

public class SSCCE extends JFrame implements WindowListener {

    private static final long serialVersionUID = 1L;
    JFrame frame;
    JPanel panel;
    JButton characterButton;
    JInternalFrame characterFrame;
    /* Character Window */
    JProgressBar totalExpProgressBar;

    Action ClassCharacterButton = new ClassCharacterButton();

    public static void main(String[] args){
        //for thread safety     
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new SSCCE();
            }
        });
    }

    SSCCE() {
        initGUI();
    }

    public void initGUI(){

        frame = new JFrame("SSCCE");
        panel = (JPanel)frame.getContentPane();

        /**********************************
         ** 
         **     Buttons
         **    
         *********************************/
        characterButton = new JButton("");
        characterButton.setBounds(50,175,395,100);
        characterButton.setVisible(true);
        characterButton.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke("C"), "characterButtonPress");
        characterButton.getActionMap().put("characterButtonPress", ClassCharacterButton);
        characterButton.setAction(ClassCharacterButton);
        characterButton.setText("Click me three times(open/close/open) to get progress bar to fill");
        panel.add(characterButton);

        /**********************************
         ** 
         **     Internal Frames
         **    
         *********************************/
        //#### Character frame start ####
        characterFrame = new JInternalFrame("Character", true, true, false, false);
        characterFrame.setLocation(50, 50);
        characterFrame.setSize(300,105);

        totalExpProgressBar = new JProgressBar();
        totalExpProgressBar.setString("0/0");
        totalExpProgressBar.setStringPainted(true);

        characterFrame.add(totalExpProgressBar);
        characterFrame.setResizable(false);
        panel.add(characterFrame);
        //#### Character frame end ####

        /**********************************
         ** 
         **     Panel Code
         **    
         *********************************/
        panel.setLayout(null);
        panel.setFocusable(true);

        /**********************************
         ** 
         **     Frame Code
         **    
         *********************************/
        frame.setLocation(100, 100);
        frame.setSize(500, 350);
        frame.setVisible(true);
        frame.setFocusable(true);
        frame.addWindowListener(this);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }

    class ClassCharacterButton extends AbstractAction {  
        private static final long serialVersionUID = 1L;

        public void actionPerformed(ActionEvent e) {
            if (characterFrame.isVisible()){
                characterFrame.setVisible(false);
            } else {
                fakeGetServerResponse();
            }
        }
    }

    public void fakeGetServerResponse(){
        String incommingReply = "proskier-charactersWindow@20|10|10|10|0|234|3|200|400"; //fake message from server
        final String splitAt[] = incommingReply.split("@"); //split the character name from the incommingReply at the '@' sign
        String beforeAt[] = splitAt[0].split("-");
        String commandName = beforeAt[1];
        final String afterAt[] = splitAt[1].split("\\|");

        if (commandName.equals("charactersWindow")){
            SwingUtilities.invokeLater(new Runnable() {
                @Override
                public void run() {
                    totalExpProgressBar.setString(afterAt[5] + "/" + afterAt[8]);
                    totalExpProgressBar.setMinimum(0);
                    totalExpProgressBar.setMinimum(Integer.parseInt(afterAt[7])); //TODO::SCREW YOU JAVA
                    totalExpProgressBar.setValue(Integer.parseInt(afterAt[5]));   //TODO::SCREW YOU JAVA
                    totalExpProgressBar.setMaximum(Integer.parseInt(afterAt[8])); //TODO::SCREW YOU JAVA
                    characterFrame.setVisible(true);
                }
            });
        }
    }

    @Override
    public void windowClosing(WindowEvent arg0){
        frame.dispose();
        System.exit(1);
    }
    @Override
    public void windowActivated(WindowEvent arg0) {
    }
    @Override
    public void windowClosed(WindowEvent arg0) {
    }
    @Override
    public void windowDeactivated(WindowEvent arg0) {
    }
    @Override
    public void windowDeiconified(WindowEvent arg0) {           
    }
    @Override
    public void windowIconified(WindowEvent arg0) {
    }
    @Override
    public void windowOpened(WindowEvent arg0) {            
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T22:36:11.793

您可能正在 EDT（事件调度线程）中执行工作。该线程有一个事件队列，它们一次按顺序分派一个，因为 AWT 不是线程安全的。这允许 UI 更新和响应事件（程序事件，如 repaint 或 invokeLater，或用户事件，如鼠标和按键事件）。

因此，当您在 EDT 中工作时，您会阻塞线程并阻止它调度事件，例如重绘、点击、按键事件等......

通常解决方案是将工作转移到另一个线程中，例如使用[SwingWorker](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html)。

顺便说一句，Thread.sleep(long) 是一个静态方法，所以不需要调用 currentThread()，如果需要，只需调用 Thread.sleep(...)。但同样，你真的应该避免在 EDT 中这样做，因为它会阻塞它并且也会阻塞 UI。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T23:17:53.473

这对所有人都有效`Swing JComponents`， `Runnable`并且`Thread.sleep(int)`对 GUI 有准动画

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class ShakingButtonDemo implements Runnable {

    private JButton button;
    private JRadioButton radioWholeButton;
    private JRadioButton radioTextOnly;

    public static void main(String[] args) throws Exception {
        SwingUtilities.invokeLater(new ShakingButtonDemo());
    }

    @Override
    public void run() {
        radioWholeButton = new JRadioButton("The whole button");
        radioTextOnly = new JRadioButton("Button text only");
        radioWholeButton.setSelected(true);
        ButtonGroup bg = new ButtonGroup();
        bg.add(radioWholeButton);
        bg.add(radioTextOnly);
        button = new JButton("  Shake with this Button  ");
        button.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                shakeButton(radioWholeButton.isSelected());
            }
        });
        JPanel p1 = new JPanel();
        p1.setBorder(BorderFactory.createTitledBorder("Shake Options"));
        p1.setLayout(new GridLayout(0, 1));
        p1.add(radioWholeButton);
        p1.add(radioTextOnly);
        JPanel p2 = new JPanel();
        p2.setLayout(new GridLayout(0, 1));
        p2.add(button);
        JFrame frame = new JFrame();
        frame.setTitle("Shaking Button Demo");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(p1, BorderLayout.NORTH);
        frame.add(p2, BorderLayout.SOUTH);
        frame.setSize(240, 160);
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    private void shakeButton(final boolean shakeWholeButton) {
        final Point point = button.getLocation();
        final Insets margin = button.getMargin();
        final int delay = 75;
        Runnable r = new Runnable() {

            @Override
            public void run() {
                for (int i = 0; i < 30; i++) {
                    try {
                        if (shakeWholeButton) {
                            moveButton(new Point(point.x + 5, point.y));
                            Thread.sleep(delay);
                            moveButton(point);
                            Thread.sleep(delay);
                            moveButton(new Point(point.x - 5, point.y));
                            Thread.sleep(delay);
                            moveButton(point);
                            Thread.sleep(delay);
                        } else {// text only
                            setButtonMargin(new Insets(margin.top, margin.left + 3, margin.bottom, margin.right - 2));
                            Thread.sleep(delay);
                            setButtonMargin(margin);
                            Thread.sleep(delay);
                            setButtonMargin(new Insets(margin.top, margin.left - 2, margin.bottom, margin.right + 3));
                            Thread.sleep(delay);
                            setButtonMargin(margin);
                            Thread.sleep(delay);
                        }
                    } catch (InterruptedException ex) {
                        ex.printStackTrace();
                    }
                }
            }
        };
        Thread t = new Thread(r);
        t.start();
    }

    private void moveButton(final Point p) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                button.setLocation(p);
            }
        });
    }

    private void setButtonMargin(final Insets margin) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                button.setMargin(margin);
            }
        });
    }
} 
```

编辑

例如 SwingWorker 和 JProgressBar & SwingWorker#cancel()

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.util.ArrayList;

public class SwingWorkerExample extends JFrame implements ActionListener {

    private static final long serialVersionUID = 1L;
    private final JButton startButton, stopButton;
    private JScrollPane scrollPane = new JScrollPane();
    private JList listBox = null;
    private DefaultListModel listModel = new DefaultListModel();
    private final JProgressBar progressBar;
    private mySwingWorker swingWorker;

    public SwingWorkerExample() {
        super("SwingWorkerExample");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        getContentPane().setLayout(new GridLayout(2, 2));
        startButton = makeButton("Start");
        stopButton = makeButton("Stop");
        stopButton.setEnabled(false);
        progressBar = makeProgressBar(0, 99);
        listBox = new JList(listModel);
        scrollPane.setViewportView(listBox);
        add(scrollPane);
        //Display the window.
        pack();
        setVisible(true);
    }
//Class SwingWorker<T,V> T - the result type returned by this SwingWorker's doInBackground
//and get methods V - the type used for carrying out intermediate results by this SwingWorker's
//publish and process methods

    private class mySwingWorker extends javax.swing.SwingWorker<ArrayList<Integer>, Integer> {
//The first template argument, in this case, ArrayList<Integer>, is what s returned by doInBackground(),
//and by get(). The second template argument, in this case, Integer, is what is published with the
//publish method. It is also the data type which is stored by the java.util.List that is the parameter
//for the process method, which recieves the information published by the publish method.

        @Override
        protected ArrayList<Integer> doInBackground() {
//Returns items of the type given as the first template argument to the SwingWorker class.
            if (javax.swing.SwingUtilities.isEventDispatchThread()) {
                System.out.println("javax.swing.SwingUtilities.isEventDispatchThread() returned true.");
            }
            Integer tmpValue = new Integer(1);
            ArrayList<Integer> list = new ArrayList<Integer>();
            for (int i = 0; i < 100; i++) {
                for (int j = 0; j < 100; j++) { //find every 100th prime, just to make it slower
                    tmpValue = FindNextPrime(tmpValue.intValue());
//isCancelled() returns true if the cancel() method is invoked on this class. That is the proper way
//to stop this thread. See the actionPerformed method.
                    if (isCancelled()) {
                        System.out.println("SwingWorker - isCancelled");
                        return list;
                    }
                }
//Successive calls to publish are coalesced into a java.util.List, which is what is received by process,
//which in this case, isused to update the JProgressBar. Thus, the values passed to publish range from
//1 to 100.
                publish(new Integer(i));
                list.add(tmpValue);
            }
            return list;
        }//Note, always use java.util.List here, or it will use the wrong list.

        @Override
        protected void process(java.util.List<Integer> progressList) {
//This method is processing a java.util.List of items given as successive arguments to the publish method.
//Note that these calls are coalesced into a java.util.List. This list holds items of the type given as the
//second template parameter type to SwingWorker. Note that the get method below has nothing to do with the
//SwingWorker get method; it is the List's get method. This would be a good place to update a progress bar.
            if (!javax.swing.SwingUtilities.isEventDispatchThread()) {
                System.out.println("javax.swing.SwingUtilities.isEventDispatchThread() + returned false.");
            }
            Integer percentComplete = progressList.get(progressList.size() - 1);
            progressBar.setValue(percentComplete.intValue());
        }

        @Override
        protected void done() {
            System.out.println("doInBackground is complete");
            if (!javax.swing.SwingUtilities.isEventDispatchThread()) {
                System.out.println("javax.swing.SwingUtilities.isEventDispatchThread() + returned false.");
            }
            try {
//Here, the SwingWorker's get method returns an item of the same type as specified as the first type parameter
//given to the SwingWorker class.
                ArrayList<Integer> results = get();
                for (Integer i : results) {
                    listModel.addElement(i.toString());
                }
            } catch (Exception e) {
                System.out.println("Caught an exception: " + e);
            }
            startButton();
        }

        boolean IsPrime(int num) { //Checks whether a number is prime
            int i;
            for (i = 2; i <= num / 2; i++) {
                if (num % i == 0) {
                    return false;
                }
            }
            return true;
        }

        protected Integer FindNextPrime(int num) { //Returns next prime number from passed arg.
            do {
                if (num % 2 == 0) {
                    num++;
                } else {
                    num += 2;
                }
            } while (!IsPrime(num));
            return new Integer(num);
        }
    }

    private JButton makeButton(String caption) {
        JButton b = new JButton(caption);
        b.setActionCommand(caption);
        b.addActionListener(this);
        getContentPane().add(b);
        return b;
    }

    private JProgressBar makeProgressBar(int min, int max) {
        JProgressBar progressBar1 = new JProgressBar();
        progressBar1.setMinimum(min);
        progressBar1.setMaximum(max);
        progressBar1.setStringPainted(true);
        progressBar1.setBorderPainted(true);
        getContentPane().add(progressBar1);
        return progressBar1;
    }

    private void startButton() {
        startButton.setEnabled(true);
        stopButton.setEnabled(false);
        System.out.println("SwingWorker - Done");
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        if ("Start" == null ? e.getActionCommand() == null : "Start".equals(e.getActionCommand())) {
            startButton.setEnabled(false);
            stopButton.setEnabled(true);
// Note that it creates a new instance of the SwingWorker-derived class. Never reuse an old one.
            (swingWorker = new mySwingWorker()).execute(); // new instance
        } else if ("Stop" == null ? e.getActionCommand() == null : "Stop".equals(e.getActionCommand())) {
            startButton.setEnabled(true);
            stopButton.setEnabled(false);
            swingWorker.cancel(true); // causes isCancelled to return true in doInBackground
            swingWorker = null;
        }
    }

    public static void main(String[] args) {
// Notice that it kicks it off on the event-dispatching thread, not the main thread.
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                SwingWorkerExample swingWorkerExample = new SwingWorkerExample();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T02:15:59.533

问题似乎是您在设置进度条的值*后*设置了它的最大值，这会将值重置为最小值。

```
import javax.swing.*;

public class ProgressBarMinValue {
   private static void createAndShowGui() {
      JProgressBar progressBar = new JProgressBar();

      int value = 234;
      int denominator = 400;
      int minValue = 200;
      progressBar.setString(value + "/" + denominator);
      progressBar.setMinimum(minValue);
      System.out.println("value := " + value);

      progressBar.setValue(value);  // (A)

      progressBar.setMaximum(denominator);

      // progressBar.setValue(value);  // (B)

      JPanel mainPanel = new JPanel();
      mainPanel.add(progressBar);

      JOptionPane.showMessageDialog(null, mainPanel);
      System.out.println("progressBar.getValue() := " + progressBar.getValue());
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

交换注释和取消注释行 (A) 和 (B)，如果您在设置进度条的最小值和最大值*后设置进度条的值，则一切正常。*

这就是你的解决方案。

请注意，我通过不断缩减您的代码直到问题无法重现，才获得了这个最小的 SSCCE。

# c# - Windows 服务未连接到数据库

> ID：10342311
> 
> 赞同：0
> 
> 时间：2012-04-26T22:29:43.223
> 
> 标签：c#, windows, c#-4.0, windows-services, timer

我有一个 Windows 服务。在向外部客户端发送肥皂消息之前，它每 18 秒连接并检查一次我的数据库。我已经在我的计算机上成功安装了该服务，但它没有做任何特别的事情，也没有用任何错误填充我的服务器日志。

我怎么知道我哪里出错了？

**更新**

```
protected override void OnStart(string[] args)
    {
        timer.Elapsed += new ElapsedEventHandler(timer_Elapsed);
        timer.Interval = 15000;
        timer.Enabled = true;
        timer.Start();
        eventLog1.WriteEntry("Windows Service 3 Started");
    }

    protected override void OnStop()
    {
        eventLog1.WriteEntry("Windows Service 3 Stopped");

    } 
```

My`RunAPP()`是我通过存储过程连接到数据库的地方。

对我的问题的任何见解都会很棒！

```
 private void RunApp()
    {

        p.Start();
        string connStr = ConfigurationManager.ConnectionStrings["bbsConnectionString"].ConnectionString;
        try
        {
            SqlConnection Con = new SqlConnection(connStr);
            Con.Open();
            SqlCommand cmd = new SqlCommand("AvailableChanges", Con);
            cmd.CommandType = CommandType.StoredProcedure;
            SqlParameter NewSysChangeVersionParam = new SqlParameter("@NewSysChangeVersion", SqlDbType.Int);
            NewSysChangeVersion.Value = (object)NewSysChangeVersion ?? DBNull.Value;
            NewSysChangeVersion.Direction = ParameterDirection.InputOutput;
            NewSysChangeVersion.SqlDbType = SqlDbType.BigInt;
            SqlDataReader sdr = cmd.ExecuteReader();
            int sdrreader = sdr.FieldCount;
            InventoryPushSubscriptionRecord rec = new InventoryPushSubscriptionRecord();

            while (sdr.Read())
            {

                inrec.InventoryPushSubscriptionId = sdr.GetInt32(0);
                inrec.SysChangeVersion = sdr.IsDBNull(1) ? (long?)null : sdr.GetInt64(1);
                inrec.InvDate = sdr.GetDateTime(2);
                inrec.ResortId = sdr.GetInt32(3);
                inrec.RoomType = sdr.GetString(4);
                inrec.InvCount = sdr.GetInt32(5);
                inrec.ResortName = sdr.GetString(6);

                Int64 NewSysChangeVersion;
                NewSysChangeVersion = Convert.ToInt64(rec.LastSysChangeVersion);
                int ResortId;
                ResortId = inrec.ResortId;
                string RoomType;
                RoomType = inrec.RoomType;
                int avail = inrec.InvCount;
                DateTime frodte = inrec.InvDate;
                DateTime todte = inrec.InvDate;
                int NoofRatePackages = sdrreader;
                Int32 InventoryPushSubscriptionId;
                InventoryPushSubscriptionId = inrec.InventoryPushSubscriptionId;
                Int64 NewLastSysChangeVersion;
                NewLastSysChangeVersion = Convert.ToInt64(inrec.SysChangeVersion);
                if (NewSysChangeVersion != null)
                {
                    sendUpdate(NewSysChangeVersion, ResortId, RoomType, avail, frodte, todte, NoofRatePackages, InventoryPushSubscriptionId, NewLastSysChangeVersion);
                }
            }

            //    sdr.Close();
            //    sdr.Dispose();

        }

        catch (Exception ex)
        { 
```

**更新** eventLog1.WriteEntry("exception"); 扔; } }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T20:26:30.620

按照建议编辑了我的例外。

捕捉（异常前）{

```
 eventLog1.WriteEntry(ex.Message);
            eventLog1.WriteEntry(ex.StackTrace);
            throw;

        } 
```

# javascript - 有没有办法在函数中重新分配参数，并且它也会影响调用范围？

> ID：10342313
> 
> 赞同：1
> 
> 时间：2012-04-26T22:29:56.833
> 
> 标签：javascript, jquery, clone

我想要做的是为 Javascript 对象构建一个 clone() 函数。如您所知，Javascript 中缺少本机功能可能会很痛苦。我有一个很好的方法来做到这一点，但在可用性方面，这很尴尬。这是到目前为止的功能：

```
function clone(objectToClone) {
    var myClone = function() {};
    myClone.prototype = objectToClone;
    return [
        new myClone(),
        new myClone()
    ];
} 
```

如您所见，目前我只返回一个包含两个克隆的数组。这使得用法看起来像这样：

```
// usage
var bar = new foo();
bar = clone(bar); // forks bar into two separate copies of bar (awkward)
// bar[0] is now clone 1
// bar[1] is now clone 2 
```

我想做的是能够执行以下操作：

```
function clone(objectToClone) {
    var myClone = function() {};
    myClone.prototype = objectToClone;
    objectToClone = new myClone(); // somehow magically?
    return new myClone();
}

// usage
var bar = new foo();
var baz = clone(bar); // returns a copy, and bar is now one of the copies as well.
// bar is now clone 1
// baz is now clone 2 
```

不幸的是，这不起作用，因为分配参数不会影响调用范围。我希望有人可以帮助想出一些 js 技巧，让我可以在所需的庄园中使用该功能。任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:59:15.040

你想让我解释我的评论，给你：

```
function replaceClones(){
    for(var i = 0; i < arguments.length; i++){
        var varName = arguments[i];
        this[varName] = getClone(this[varName]);
    }    
}

function getClone(obj){
    var Clone = function(){};
    Clone.prototype = obj;
    return new Clone();
}

replaceClones("varA","varB"); 
```

如果你想要另一个范围，只需使用

```
replaceClones.call(newScope,"varA","varB"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:41:58.800

您可以让您的克隆函数返回副本，而保留原件。

如果由于某种原因这是不可能或不切实际的，那是你能做的最好的事情：

```
var bar = new foo();
var clones = clone(bar);
bar = clones[0];
barCopy = clones[1]; 
```

除非你诉诸极其不雅的`eval`诡计。

我认为你真正想要的是只`return new myClone()`使用并且从不使用`bar`. 这实际上使事情变得更加优雅（`bar_template`如果需要，您可以调用它或其他名称），因为您现在可以克隆原始模板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T23:14:38.733

为了得到你想要的结果，你需要传入一个带有属性的对象，然后修改这些属性。这是在允许您更改原始文件的 javascript 中获取参考的最佳方式。当它只是作为普通函数参数传递时，您无法更改原始文件。Javascript 没有这些类型的引用。

```
function clone(holder) {
    var myClone = function() {};
    myClone.prototype = holder.input;
    holder.input = new myClone(); // somehow magically?
    return new myClone();
}

// usage
var holder = {};
var holder.input = new foo();
var holder.output = clone(holder); // returns a copy, and holder.input is now a copy too
// holder.input is now clone 1
// holder.putput is now clone 2 
```

# php - mysql 查询：LIKE %$var% 但不是当 $var 为空时

> ID：10342316
> 
> 赞同：0
> 
> 时间：2012-04-26T22:30:16.540
> 
> 标签：php, mysql

使用此查询调出铃声。

```
$result2 = mysql_query("select * from ringtones where (artist LIKE '%$artist%' or title LIKE '%$title%') and id!='$ringtoneid' limit 50"); 
```

问题是：如何防止 $artist 或 $title 为空时显示所有行？不涉及查询变量（检查并将适当的查询字符串放入 PHP 变量中）。

关于它的其他“想法”？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T22:32:25.960

只需添加附加条件：

```
 AND '$artist$title' != '' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:38:46.343

除非设置了 $var，否则不要将条件添加到 WHERE 子句：

```
if (isset($artist)) 
    $condition .= "artist LIKE '%$artist%'"
....
$result2 = mysql_query("select * from ringtones where $condition"); 
```

但是正如 Bobby Tables 所提到的，您需要使用准备语句

# java - 如何在android中设置延伸到相对于右边框的点的布局宽度？

> ID：10342317
> 
> 赞同：0
> 
> 时间：2012-04-26T22:30:21.547
> 
> 标签：java, android, listview, android-layout

我有一个列表视图，左侧有一个小而长的文本视图（两者都有不同的文本），最右侧有一个图像视图。问题是当长文本视图变得太长时，它会压缩右侧的图像视图，然后再换行到第二行。由于两个文本视图在每一行中都有不同的长度，我无法为它们的长度设置一个固定的 dp 值。我该怎么做才能使 imageview 不被压缩？

PS：我像这样在列表视图中创建行：

```
<TextView
android:id="@+id/info"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:textSize="10sp"
android:layout_gravity="center_vertical"/>

<TextView
android:id="@+id/text"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:textSize="12sp"
android:layout_gravity="center_vertical"/>

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent">

<ImageView
android:id="@+id/image"
android:layout_width="45dp" 
android:layout_height="45dp"
android:layout_alignParentRight="true"
android:focusable="false"/>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:33:01.097

将 android:toLeftOf="@+id/image" 添加到您的 TextViews。您可能需要将 TextView 的 layout_width 设置为 fill_parent。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent">

<TextView
android:id="@+id/info"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:textSize="10sp"
android:toLeftOf="@+id/image"
android:layout_gravity="center_vertical"/>

<TextView
android:id="@+id/text"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:textSize="12sp"
android:toLeftOf="@+id/image"
android:layout_gravity="center_vertical"/>

<ImageView
android:id="@+id/image"
android:layout_width="45dp" 
android:layout_height="45dp"
android:layout_alignParentRight="true"
android:focusable="false"/>

</RelativeLayout> 
```

# css - 使用 CSS 动画保持元素直立，同时旋转一圈

> ID：10342319
> 
> 赞同：0
> 
> 时间：2012-04-26T22:30:31.023
> 
> 标签：css, css-animations

我有大约 10 个图标，全部排列成直径约 400 像素的圆形。图标均为 80x80。

我想让这些图标绕一圈旋转，但是当我实现动画时，图标本身当前也在旋转——例如，底部的图标会倒置。

有没有办法让它们一起旋转一圈但保持图标本身直立？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:03:11.033

礼貌[http://lea.verou.me/2012/02/moving-an-element-along-a-circle/](http://lea.verou.me/2012/02/moving-an-element-along-a-circle/)

这个小提琴解决了它：http: [//jsfiddle.net/cswkd/](http://jsfiddle.net/cswkd/)

好问题！

# java - 我应该使用什么来转换为 unicode、po2prop o native2ascii？

> ID：10342320
> 
> 赞同：1
> 
> 时间：2012-04-26T22:30:44.487
> 
> 标签：java, unicode, properties, translation

我想做一个简单的任务，将 iso-8859-1 中的文件编码转换为 UNICODE。根据[docs.oracle.com上的 java 规范](http://translate.sourceforge.net/wiki/toolkit/prop2po)

> 对于相应的十六进制值 xxxx，属性键或值中小于 \u0020 的字符和大于 \u007E 的字符写为 \uxxxx。

从网上看，native2ascii 似乎很旧并且有问题，而[翻译工具包](http://translate.sourceforge.net/wiki/toolkit/prop2po)（和 po2prop）要好得多。

如何对带有“à”之类的字符的 aa 文件进行直接翻译，以便将其翻译为 \00e0 (http://www.fileformat.info/info/unicode/char/00e0/index.htm)？

我已经看了很长时间了，但一直没有找到正确的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:35:57.360

不确定这是否是您要查找的内容，但您可以在我的`crlf`实用程序中看到我如何处理各种输入文本流类型（包括 UTF-8 和 ISO 8859-1）和各种输出文本流类型（包括 UTF-16）前段时间写过。该程序具有将控制字符转换为`\udddd`字符序列的选项。

它位于： http:
[//david.tribble.com/src/crlf.cpp](http://david.tribble.com/src/crlf.cpp)
[http://david.tribble.com/src/src.html](http://david.tribble.com/src/src.html#crlf)

请注意，它是用 C++ 编写的，而不是 Java。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:34:39.970

作为一种快速而肮脏的技巧，您可以将字符串编码为 JSON 并去掉结尾引号。不太确定像其他常见的 JSON 这样的属性是如何转义的......

# c# - 如何判断我何时丢失了 Application.ThreadException 的 EventHandler

> ID：10342323
> 
> 赞同：0
> 
> 时间：2012-04-26T22:30:54.853
> 
> 标签：c#, .net, vb.net

我有一个未处理的异常处理程序，它执行以下操作：

```
 AddHandler Application.ThreadException, AddressOf Application_ThreadException 
```

我正在查看这到底意味着什么，并注意到 Application 的反编译代码显示：

```
 /// <include file='doc\Application.uex' path='docs/doc[@for="Application.ThreadException"]/*' />
        /// <devdoc> 
        ///    <para>Occurs when an untrapped thread exception is thrown.</para>
        /// </devdoc>
        public static event ThreadExceptionEventHandler ThreadException {
            add { 
                Debug.WriteLineIf(IntSecurity.SecurityDemand.TraceVerbose, "AffectThreadBehavior Demanded");
                IntSecurity.AffectThreadBehavior.Demand(); 

                ThreadContext current = ThreadContext.FromCurrent();
                lock(current) { 
                    current.threadExceptionHandler = value;
                }
            }
            remove { 
                ThreadContext current = ThreadContext.FromCurrent();
                lock(current) { 
                    current.threadExceptionHandler -= value; 
                }
            } 
        } 
```

因此，从“添加”看来，订阅 Application.ThreadException 的最后一个人是获得它的人（它不像大多数事件处理程序那样是附加的）。无论如何，我都不想放弃对这个事件处理程序的订阅。当我失去对 Application.ThreadException 的订阅时，任何人都可以想出一种我可以跟踪的方法，这样我就可以从从我那里偷走它的人那里偷回来吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:47:25.633

不幸的是，这是一个[已知问题](http://connect.microsoft.com/VisualStudio/feedback/details/115355/application-threadexception-allows-only-one-handler-to-exist-at-a-time-it-is-incorrectly-implemented)。没有已知的解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:39:09.307

我在想也许我可以用计时器来做到这一点。检查是否有人已经订阅了此活动，并且不是我，然后重新订阅。我知道这有点骇人听闻……只是在想……

# php - 从 Windows DOS 提示符中提取数据

> ID：10342324
> 
> 赞同：1
> 
> 时间：2012-04-26T22:31:02.407
> 
> 标签：php, string, parsing

**更新：想通了**

答：我想通了。

每个字符后面都有一个隐藏的\0。

解决方法很简单：

```
trim(str_replace("\0", '', $string)) 
```

ASCII 输出：

```
|0()|84(T)|0()|104(h)|0()|101(e)|0()|32( )|0()|110(n)|0()|117(u)|0()|109(m)|0()|98(b)|0()|101(e)|0()|114(r)|0()|32( )|0()|111(o)|0()|102(f)|0()|32( )|0()|112(p)|0()|101(e)|0()|110(n)|0()|100(d)|0()|105(i)|0()|110(n)|0()|103(g)|0()|32( )|0()|100(d)|0()|101(e)|0()|118(v)|0()|105(i)|0()|99(c)|0()|101(e)|0()|40(()|0()|115(s)|0()|41())|0()|32( )|0()|105(i)|0()|115(s)|0()|32( )|0()|48(0)|0()|46(.)|0()|13(
)|0()| 
```

**问题：**

这是我正在测试的字符串的一个很好的例子：

$string = "待处理设备的数量为 1。";

string(73) "待处理设备的数量为 1。"

我试图运行的代码是：

```
$string = "the number of pending device(s) is 1.";
if(strstr($string, "pending"))
{
    echo "Found";
} 
```

我一直在测试的另一个是：

```
$text = "The number of pending device(s) is 1.";
        $re1='.*?'; # Non-greedy match on filler
        $re2='(?:[a-z][a-z]+)'; # Uninteresting: word
        $re3='.*?'; # Non-greedy match on filler
        $re4='(?:[a-z][a-z]+)'; # Uninteresting: word
        $re5='.*?'; # Non-greedy match on filler
        $re6='(?:[a-z][a-z]+)'; # Uninteresting: word
        $re7='.*?'; # Non-greedy match on filler
        $re8='((?:[a-z][a-z]+))';   # Word 1
        $re9='.*?'; # Non-greedy match on filler
        $re10='(\\d+)'; # Integer Number 1

        if ($c=preg_match_all ("/".$re1.$re2.$re3.$re4.$re5.$re6.$re7.$re8.$re9.$re10."/is", $text, $matches))
        {
            $word1=$matches[1][0];
            $int1=$matches[2][0];
            print "($word1) ($int1) \n";
        } 
```

现在，如果它只是一个字符串，这将非常有用。我从 Windows DOS 提示符中提取数据，我可以很好地回显数据，但不幸的是，当我尝试通过 preg_match_all 或 strpos 或 strstr 运行数据时，它总是返回 false。这可能是编码问题吗？所有数据都很好地回显到浏览器中。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:52:13.537

如您的示例所示，两者都`strstr()`可以`preg_match_all()`正常工作。因此，我们除了推测之外别无他法。

由于您正在阅读的 shell 输出存在问题，并且关键是该字符串与您的测试字符串之间的区别，因此您需要编辑此问题或提出一个新问题，提供您的代码“从 Windows DOS 提示符中提取数据” .

此外，“回显到浏览器中”不是检查字符串的好方法。尝试读取单个字节。（我通常使用 for 循环、十六进制编辑器或数据包捕获实用程序。）

# android - “三星应用程序”是否支持 URI 方案以重定向到特定应用程序？

> ID：10342327
> 
> 赞同：30
> 
> 时间：2012-04-26T22:31:14.120
> 
> 标签：android, android-intent

我的一位客户热衷于在许多流行的三星设备上推广他的完整应用程序的“精简”版本。这个精简版将被上传到[http://www.samsungapps.com](http://www.samsungapps.com)，然后用户将能够通过[“三星应用程序”应用程序](https://play.google.com/store/apps/details?id=com.sec.android.app.samsungapps)下载它。精简版具有指向完整应用程序的应用程序内链接。

现在，我一直在三星的网站上搜索有关三星应用程序可以获取并用于直接向用户展示完整应用程序的相关详细信息的 URI 方案的任何信息。对于 Google Play 和 Amazon，您可以简单地使用特定的 URI 方案和应用程序的包名称触发意图；例如：

**谷歌播放：**

```
marketIntent.setData(Uri.parse("market://details?id=" + FULL_VERSION_PACKAGE_NAME)); 
```

**亚马逊：**

```
marketIntent.setData(Uri.parse("http://www.amazon.com/gp/mas/dl/android?p=" + FULL_VERSION_PACKAGE_NAME)); 
```

这一切都有据可查，而且很容易找到。但是，我无法弄清楚三星应用程序是否为类似行为提供了自己的 URI 方案。

我确实发布了，因为我们在这里讨论的是 Android 设备，所以我可以链接到 Google Play。对我来说，三星会提供一个类似市场的系统而无法链接到那里的特定产品，这让我觉得很奇怪，所以我希望我忽略了一些东西。

有人对此有任何指示吗？请注意，我没有与三星应用程序兼容的设备来实际测试任何东西。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-04-28T06:28:59.237

所以我终于设法找到隐藏在 pdf 文档中的问题的答案。它的标题是[*“Samsung Apps Deeplink Guide”*](http://developer.samsung.com/android/technical-docs/Samsung-Apps-Deeplink-Guide)，可以从三星的资源中心下载。

对于那些对整个文档不感兴趣的人，其中包含有关如何在三星应用程序中调用特定屏幕的一些信息，答案很简单。`Intent`使用以下格式将 URI 附加到的数据：

```
samsungapps://ProductDetail/<the package name of the AndroidManifest.xml> 
```

例如，三星应用程序中的三星应用程序应用程序的直接链接（措辞仍然有意义？）将是：

```
samsungapps://ProductDetail/com.sec.android.app.samsungapps 
```

因此，该应用程序确实支持类似于 Google Play 和 Amazon 的 URI 方案，正如怀疑的那样。

~~请注意，我还不能对此进行测试，但我确实遇到了一个最近[提出的标志](http://innovator.samsungmobile.com/bbs/discussion/view.do?platformId=1&parentCategoryId=4&messageCategoryId=4&messageId=149814&boardId=1132&listLines=5&searchParameters=/bbs/discussion/forum.list.do?)（从 2012 年 4 月 27 日开始），显然这个功能突然停止工作。根据对该标志的回复，三星开发人员正在对其进行调查，但我可能会暂缓此事，直到确认修复。~~

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-02-10T21:54:28.290

我使用以下代码通过包名称链接到 Google Play、Amazon Appstore 和 Samsung Galaxy Apps。

```
public static final String MARKET_GOOGLE_URL = "market://details?id=";
public static final String WEB_GOOGLE_URL = "http://play.google.com/store/apps/details?id=";

public static final String MARKET_SAMSUNG_URL = "samsungapps://ProductDetail/";
public static final String WEB_SAMSUNG_URL = "http://www.samsungapps.com/appquery/appDetail.as?appId=";

public static final String MARKET_AMAZON_URL = "amzn://apps/android?p=";
public static final String WEB_AMAZON_URL = "http://www.amazon.com/gp/mas/dl/android?p=";

public static void openOnMarket(String market, String web, Context context, String packageName) {

    try {
        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(market + packageName));
        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        context.startActivity(intent);
    } catch (android.content.ActivityNotFoundException anfe) {
        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(web + packageName));
        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        context.startActivity(intent);
    }

}

public static void openOnGooglePlayMarket(Context context, String packageName) {
    openOnMarket(MARKET_GOOGLE_URL, WEB_GOOGLE_URL, context, packageName);
}

public static void openOnSamsungMarket(Context context, String packageName) {
    openOnMarket(MARKET_SAMSUNG_URL, WEB_SAMSUNG_URL, context, packageName);
}

private static void openOnAmazonMarket(Context context, String packageName) {
    openOnMarket(MARKET_AMAZON_URL, WEB_AMAZON_URL, context, packageName);
} 
```

起初尝试通过URI打开市场应用程序，但如果找不到打开Web链接。我希望这段代码对某人有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-04T23:06:13.810

这是 Android Samsung Apps 的较新文档 [互通指南的链接](http://developer.samsung.com/technical-doc/view.do?v=T000000076)

# javascript - Facebook Like Box 只显示一张脸

> ID：10342331
> 
> 赞同：3
> 
> 时间：2012-04-26T22:31:55.303
> 
> 标签：javascript, facebook, facebook-likebox

我的赞框有问题 - 它与粉丝页面连接良好，显示正确的赞数，但在框中只显示一张脸......我知道这不是用户权限的问题，因为页面有超过300 个赞，并且它的一些用户面孔出现在另一个赞框中。

有人知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T09:20:28.573

我刚刚想通了 - 当我输入 'facebook.com/pages/MyPageName/PAGE_ID' 而不是 'facebook.com/MyPageName' 字段时，问题消失了

# flash - ActionScript 3 声音

> ID：10342340
> 
> 赞同：0
> 
> 时间：2012-04-26T22:32:51.937
> 
> 标签：flash, actionscript, audio, simplify, soundchannel

[青蛙](http://epickris.co.uk/portfolio/frog)

我正在开发一个名为 Frog 的 Flash 游戏，目前我的声音代码似乎有点多，我想简化它，但看不出如何。任何帮助，将不胜感激。

```
var musicSC:SoundChannel = new SoundChannel();
var musicST:SoundTransform = new SoundTransform();
var musicS:Sound = new Sound();
var musicURLR:URLRequest = new URLRequest('audio/music.mp3');
var flySC:SoundChannel = new SoundChannel();
var flyST:SoundTransform = new SoundTransform();
var flyS:Sound = new Sound();
var flyURLR:URLRequest = new URLRequest('audio/fly.mp3');
var frogSC:SoundChannel = new SoundChannel();
var frogST:SoundTransform = new SoundTransform();
var frogS:Sound = new Sound();
var frogURLR:URLRequest = new URLRequest('audio/frog.mp3');

function loopMusic():void {
    musicSC = musicS.play();
    musicSC.addEventListener(Event.SOUND_COMPLETE, loopMusic);
}
function loopFrog():void {
    frogSC = frogS.play();
    frogSC.addEventListener(Event.SOUND_COMPLETE, loopFrog);
}
function playFly():void {
    flySC = flyS.play();
}

musicS.load(musicURLR);
flyS.load(flyURLR);
frogS.load(frogURLR);
loopMusic();
loopFrog(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:01:07.757

声音对象的播放方法有第二个参数，用于循环次数：

musicS.play(0, int.MAX_VALUE);

int.MAX_VALUE 对于您的应用来说应该是足够的循环。

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/Sound.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/Sound.html)

# javascript - Google Maps V3 - 使用 infowindows 绘制矩形

> ID：10342348
> 
> 赞同：0
> 
> 时间：2012-04-26T22:33:30.227
> 
> 标签：javascript, google-maps, google-maps-api-3

我想在谷歌地图上画出大约 15 个矩形，大约 40% 的不透明度——这样做并将一些 HTML 数据与之关联的最佳做法是什么？

一个数组然后遍历它？我将如何制作鼠标悬停（最好）工具提示或至少在点击时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:47:00.670

您可以创建一组[google.maps.Rectangle](https://developers.google.com/maps/documentation/javascript/reference#Rectangle)实例并使用[RectangleOptions](https://developers.google.com/maps/documentation/javascript/reference#RectangleOptions)将其设置`fillOpacity`为`0.4`。矩形是一个 JavaScript 对象，因此您可以自由地将所需的任何数据与任何实例相关联。

该矩形还会触发：`mouseover`和的事件`click`，因此您可以触发您提到的 DOM 事件。为了使矩形接受点击，`RectangleOptions`您传递给构造函数的 可能还包括一个成员：`clickable`，如果设置为： ，它允许您让矩形接受点击事件`true`。

或者，如果您只是想在地图上放置一个矩形标签并添加一些 innerHTML 内容，就像地图上的便利贴一样，您可能会对 google-maps-utility-library [InfoBox 感兴趣](http://code.google.com/p/google-maps-utility-library-v3/wiki/Libraries#InfoBox)。它允许完全控制样式，并具有让您控制事件处理/传播的机制。

# iphone - 将 ivar 设置为自定义子类对象不起作用

> ID：10342349
> 
> 赞同：1
> 
> 时间：2012-04-26T22:33:31.483
> 
> 标签：iphone, objective-c, ios, cocoa-touch, automatic-ref-counting

我可能忽略了一些小东西，但我似乎无法弄清楚。

我正在尝试将自定义类的实例传递给另一个自定义类的实例。 **注意：我正在使用 ARC***

设置了第二个自定义类：

```
#import "OneArtsDay.h"

@interface SocialButton : UIButton {    
    OneArtsDay *artsDay;
}

@property (nonatomic) OneArtsDay *artsDay;

- (void)setArtsDay:(OneArtsDay *)day;

@end 
```

和

```
#import "SocialButton.h"

@implementation SocialButton
@synthesize artsDay;

- (void)setArtsDay:(OneArtsDay *)day {
  if (day ==nil) {
    NSLog(@"Error, cannot set artsDay");
  }
  else {
  artsDay = day;
  }
}

@end 
```

现在，当我在代码中调用这些命令时：

```
 SocialButton *social = [[SocialButton alloc] init];
    OneArtsDay *day = [[OneArtsDay alloc] init];
    //Do things with day here//
    [social setArtsDay:day]; 
```

当我尝试访问属性 OneArtsDay *artsDay 时，仍然出现错误。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:51:57.563

该属性应声明为强。这是我编写相同代码的方式：

```
#import "OneArtsDay.h"

@interface SocialButton : UIButton

// property decl gives me the file var and the public getter/setter decls
// strong tells ARC to retain the value upon assignment (and release the old one)
@property (nonatomic, strong) OneArtsDay *artsDay;

@end

#import "SocialButton.h"

@implementation SocialButton

// _underscore alias let's me name stack vars and prams the same name as my property
// without ambiguity/compiler warnings

@synthesize artsDay=_artsDay;

- (void)setArtsDay:(OneArtsDay *)artsDay {
    if (artsDay==nil) {
        NSLog(@"Error, cannot set artsDay");
    } else {
        _artsDay = artsDay;
    }
}

@end 
```

# javascript - 有没有办法使用 JS 来检查 IE SmartScreen 是否开启？

> ID：10342353
> 
> 赞同：1
> 
> 时间：2012-04-26T22:33:41.187
> 
> 标签：javascript, internet-explorer, dhtml

有没有办法使用 JS 来检查 IE SmartScreen 是否开启？我希望我的网站检查是否为用户浏览器启用了 SmartScreen。如果不使用JS，那怎么办？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:43:32.357

不，浏览器中没有用于 SmartScreen 的 API。这将破坏目的，因为恶意站点将能够使用此信息来尝试绕过过滤器。

# git - 当项目方向发生变化时需要 GIT 工作流程中的建议

> ID：10342354
> 
> 赞同：0
> 
> 时间：2012-04-26T22:33:49.533
> 
> 标签：git

我正在构建一些东西，它是一个工作原型，但有一些小故障，现在我们决定使用一个库来为我们做一些繁重的工作，然后在此基础上对其进行编码。到目前为止，我一直致力于掌握。我现在应该如何进行？

*   我应该创建一个 master 分支并在那里推送新代码并让 master 处于这种状态吗？
*   我应该标记最后一次提交，然后继续在 master 上工作吗？

当项目方向发生变化时，您对我应该如何处理工作流程有什么看法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:01:20.363

由于您希望您的代码在您实现库之前可用，因此创建一个新分支并在您完成实现库后开始在 master 上实现它创建一个标签，然后合并您的新分支。

# apache - 无论在何处请求，如何将固定文件夹名称重定向到另一个固定文件夹

> ID：10342356
> 
> 赞同：1
> 
> 时间：2012-04-26T22:34:05.240
> 
> 标签：apache, mod-rewrite, redirect, url-rewriting

我的 Web 应用程序中存在当前情况：

html 文件将请求来自 {currentpath}/images/ 的图像

由于使用 MVC，我的 URL 经常更改：

```
domain.com/app/main/welcome/ 
```

（从主类获取欢迎方法）

在这种情况下，视图将请求来自

```
domain.com/app/main/welcome/images/ 
```

在任何情况下，如果脚本从其图像子文件夹中调用某些内容，我都需要将其重定向到固定文件夹（例如 domain.com/app/images/）。

到目前为止，我已经尝试过这个：

```
RewriteRule ^(.*)/app/(.*)/images/(.*)$ $1/app/images/$3 [R=301,L,QSA] 
```

这是行不通的。

我的意图是重定向：

```
domain.com/app/{anything}/images/ 
```

到

```
domain.com/app/images/{the requested image} 
```

这是我在 stackoverflow 上的第一篇文章，通常我会通过搜索直接找到所有答案，但在这方面我不知道该怎么做。

顺便说一句，我知道我可以简单地使用固定路径对我的所有视图执行 replace_all，但由于它将来可能会改变，这将是一种更优雅的方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T20:56:25.583

你可以试试：

```
RewriteRule ^/?app/.+/images/(.*)$ /app/images/$1 [R=301,L,QSA] 
```

您可能想决定如何永久保留网址，只需更改重定向以匹配，然后在后台更改其余部分。您可能还想考虑别名：

...必须填写 {currentpath} 的地方

```
Alias /app/{currentpath}/images /app/images 
```

或别名匹配

```
AliasMatch ^/app/.+/images(.*) /app/images$1 
```

然后在文件夹更改时更改最后一部分，您也可以通过 mod_alias 永久重定向，尽管它有点不同：

```
Redirect 301 /app/{currentpath}/images http://domain.com/app/images 
```

还有一个 RedirectMatch。

见：[http ://httpd.apache.org/docs/2.0/mod/mod_alias.html](http://httpd.apache.org/docs/2.0/mod/mod_alias.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T21:51:51.060

您需要的规则是：

```
RewriteRule ^(app/)[^/]+/(images/.*)$ $1$2 [R=301,L,NC] 
```

# android - Android - 来自下载资源的 Widget RemoteView setImageViewBitmap

> ID：10342358
> 
> 赞同：1
> 
> 时间：2012-04-26T22:34:18.707
> 
> 标签：android, multithreading, image, download, widget

我有一个小部件，它用一些下载的信息填充列表，其中包括从给定 URL 下载的图像。

我想使用 setImageViewBitmap 和从 URL 创建的位图来显示此图像。我可以成功创建位图，但我遇到了一个问题：

当我使用：

```
itmap bitmap = BitmapFactory.decodeStream((InputStream)new URL(item.getPosterUrl()).getContent());
remoteViews.setImageViewBitmap(R.list_item.poster, bitmap); 
```

图像已成功显示在小部件列表中，但是下载有点慢（通常这应该在任何网络操作中完成）所以我想使用线程在后台执行下载，而用户可以看到其余部分名单。

我的问题是，当我使用线程时，下载执行良好，但 remoteViews 没有更新图像。我也尝试使用具有相同结果的处理程序。

也许我需要像 runOnUIThread 这样的东西，但我没有找到类似的小部件方法。

我能做些什么？

提前致谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T22:37:40.277

步骤#1：下载图像。

步骤#2：下载完成后，使用图像通过 a`RemoteViews`和 an更新应用小部件`AppWidgetManager`

**更新**

为了澄清一点，您不能可靠地直接在主应用程序线程上调用`AppWidgetProvider`--下载某些东西`onUpdate()`，因此下载可能需要太长时间。

但是，`onUpdate()`可以将其工作委托给`IntentService`下载图像并更新应用小部件本身的应用程序。`AppWidgetProvider`是更新应用小部件的*地方，但您应用中的其他代码也可以更新应用小部件。*只需让您`IntentService`创建`RemoteViews`、获取`AppWidgetManager`并进行更新。

# dynamics-crm-2011 - 配置 Microsoft Dynamics CRM 2011 IIS 设置、注册表设置和电子邮件路由器部署 URL

> ID：10342359
> 
> 赞同：2
> 
> 时间：2012-04-26T22:34:22.723
> 
> 标签：dynamics-crm-2011

我需要有关 CRM 2011 On-Premise 配置设置的帮助。我在使用负载平衡的应用服务器查找示例配置时遇到问题。互联网上的大多数示例似乎都是针对单个应用服务器配置的。

我们当前的设置包括一对 Cisco CSS（硬件负载平衡器），配置为负载平衡 2 个应用服务器 CRMAPP1 和 CRMAPP2。Cisco CSS 配置有 VIP，即 crmtest.domain.org，传入/传出设置为端口 80。

## IIS 设置

在 IIS 管理器中，我最初配置了两个绑定，如下所示：

绑定1：

> 类型：http
> 主机名：crmtest.domain.org
> 端口：80
> IP 地址：*

绑定2：

> 类型：http
> 主机名：
> 端口：1000
> IP 地址：*

我最初添加了第二个绑定（使用端口 1000），因此我们可以针对每个单独的应用服务器。例如，如果我们在每个 CRM 应用服务器“http://crmapp1:1000/HealthCheck/default.aspx”和“http://crmapp2:1000/HealthCheck/default.aspx”上部署了一个健康检查应用程序，这将是检查每台服务器运行状况的一种方法。

我说最初是因为我已经取出了绑定 2（使用端口 1000），现在只有一个用于负载平衡 URL (crmtest.domain.org) 的绑定。我将尝试解释原因。

从互联网上的许多来源，我一直在阅读，CRM 不支持多个 IIS 绑定，我们应该只有 1 个单一绑定。在我的例子中，这将是负载平衡 URL crmtest.domain.org。

**问题 1：** 添加第二个 IIS 绑定（端口 1000）会导致 CRM 应用程序出现任何问题吗？

**问题 2：**要使网络负载平衡和 WCF 服务端点正常工作，是否需要将一个 IIS 绑定设置为集群地址，即 crmtest.domain.org，端口 80，IP 地址：*？

**问题 3：** CRM 中是否有任何设置或配置需要我们针对单个应用服务器？

## 注册表设置

每个应用服务器的注册表设置如下：
IncomingEmailServer: crmtestmr1
LocalSdkPort: 80
ServerUrl: "http://crmtest.domain.org/MSCRMServices"

**问题 4：**每个应用服务器上的两个 ServerURL 注册表设置是否应该是相同的负载平衡 URL，例如“http://crmtest.domain.org/MSCRMServices”或每个应用服务器的不同 URL，例如“http://crmapp1 :1000/MSCRMServices”和“http://crmapp2:1000/MSCRMServices”？

**问题 5：** IncomingEmailServer 注册表设置是否应该只是电子邮件路由器服务器名称？

**问题6：** LocalSdkPort注册表设置应该是80端口还是1000等本地端口？

## 电子邮件路由器部署 URL

**问题 7：**在电子邮件路由器配置管理器的 [部署] 选项卡下，Microsoft Dynamics Server 应该是负载平衡 URL“http://crmtest.domain.org/Organization-Test”还是单个应用服务器 URL，例如“http://crmapp1:1000/Organization-Test”？

## 其他配置设置（尽量彻底）

**服务主体名称 (SPN)**
服务主体名称 (SPN) 当前配置如下：

> HOST/CRMAPP1
> HOST/CRMAPP1.main.domain.org
> RestrictedKrbHost/CRMAPP1
> RestrictedKrbHost/CRMAPP1.main.domain.org
> tapinego/CRMAPP1
> tapinego/CRMAPP1.main.domain.org
> TERMSRV/CRMAPP1
> TERMSRV/CRMAPP1.main.domain.org
> WSMAN/ CRMAPP1
> WSMAN/CRMAPP1.main.domain.org

**问题 8：** 我们有什么理由应该在 HTTP/CRMAPP1 或 HTTP/CRMAPP1.main.domain.org 中添加？

**开发人员资源中**
的服务端点当前的服务端点配置如下：

> 发现服务
> “http://crmtest.domain.org/XRMServices/2011/Discovery.svc”
> 
> 组织服务
> “http://crmtest.domain.org/Organization-Test/XRMServices/2011/Organization.svc”
> 
> 组织数据服务
> “http://crmtest.domain.org/Organization-Test/XRMServices/2011/OrganizationData.svc”

**Deployment Manager 配置 Deployment Manager**
中的 Web 地址当前配置如下：

> 绑定类型：
> (x) HTTP
> 
> Web 应用服务器：
> crmtest.domain.org :80
> 
> 组织网络服务：
> crmtest.domain.org :80
> 
> 发现 Web 服务：
> crmtest.domain.org :80
> 
> 部署 Web 服务：
> crmtest.domain.org :80

**MSCRM_CONFIG 数据库中的 CRM 部署属性**

> ADDeploymentSdkRootDomain: crmtest.domain.org:80
> ADDiscoveryRootDomain: crmtest.domain.org:80
> ADsdkRootDomain: crmtest.domain.org:80
> ADWebApplicationRootDomain: crmtest.domain.org:80
> AsyncSdkRootDomain: crmtest.domain.org:80

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T07:39:31.010

我认为[在多台计算机上安装 Microsoft Dynamics CRM Server 2011](http://technet.microsoft.com/en-us/library/hh699803.aspx)文章将回答您的大部分问题。

1.  这是不受支持的配置。只允许一个用于 http 或 https 的绑定。否则，您将遇到 WCF 服务端点问题

2.  不，您也可以使用 catch all 绑定。

3.  没有。见文章
4.  这些设置仅适用于在此服务器上运行的插件等。因此，您可以更改它们，但您不需要这样做。如果您想让它们也“负载平衡”，请使用集群地址。如果不是，请不要更改默认设置（只要您的 Web 服务器可以使用此地址访问）。
5.  您可以放心地忽略此设置
6.  根据 Dynamics CRM 的端口。如果它侦听端口 80，则您无需更改任何内容，因为这是默认设置。如果您有不同的端口，例如 443，请更改它。确保您还调整了 LocalSdkHost
7.  使用集群地址
8.  不，您必须为服务帐户和集群地址设置一个 SPN，您必须在整个集群中使用它。见文章

# ruby-on-rails - JSON & Rails：如何删除 JSON 结果的 keypath 中的数组括号

> ID：10342364
> 
> 赞同：0
> 
> 时间：2012-04-26T22:34:40.077
> 
> 标签：ruby-on-rails, ruby-on-rails-3, json

我有一个 JSON 格式问题——本质上我只是想删除从 Rails 控制器返回的 keypath 内的对象周围的数组 []：

```
# channels controller
  def index
    @channels = Channel.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render :json => { :channels => @channels } }
    end
  end

# channels.rb
  def as_json(options={})
    { self.id => self.attributes }
  end

# returns this JSON:
{"channels":[{"78":{"id":78,"name":"Zombie Bass","created_at":"2012-03-21T04:04:36Z","updated_at":"2012-04-20T01:21:12Z","num_of_listeners":1}},{"82":{"id":82,"name":"The Beatles123","created_at":"2012-03-22T20:28:34Z","updated_at":"2012-04-17T04:34:07Z","num_of_listeners":1}},{"125":{"id":125,"name":"New!","created_at":"2012-04-19T04:05:47Z","updated_at":"2012-04-19T04:05:47Z","num_of_listeners":1}},{"132":{"id":132,"name":"Test!","created_at":"2012-04-26T21:00:30Z","updated_at":"2012-04-26T21:00:30Z","num_of_listeners":1}}]}

# I want this JSON (just remove the array around all the channels):
{"channels":{"78":{"id":78,"name":"Zombie Bass","created_at":"2012-03-21T04:04:36Z","updated_at":"2012-04-20T01:21:12Z","num_of_listeners":1}},{"82":{"id":82,"name":"The Beatles123","created_at":"2012-03-22T20:28:34Z","updated_at":"2012-04-17T04:34:07Z","num_of_listeners":1}},{"125":{"id":125,"name":"New!","created_at":"2012-04-19T04:05:47Z","updated_at":"2012-04-19T04:05:47Z","num_of_listeners":1}},{"132":{"id":132,"name":"Test!","created_at":"2012-04-26T21:00:30Z","updated_at":"2012-04-26T21:00:30Z","num_of_listeners":1}}} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:50:18.703

那是不可能的。您不能在 JSON（这只是 JavaScript）中拥有不是数组或数组类型结构的对象列表。

如果您编辑您的问题以告诉我们您为什么要实现这一目标，我们可能会提供更多帮助。

# php - 空值 SQL Server 和 PHP

> ID：10342367
> 
> 赞同：0
> 
> 时间：2012-04-26T22:34:51.580
> 
> 标签：php, sql-server

您好，我有一个关于 Null 值的问题。

基本上我有一堆变量，我想做一堆检查，然后在最后添加值，但是其中一些值需要为 NULL。

因此，例如，如果未设置值，我想将变量的值设置为 null，以便在我插入数据库时​​它不会放入任何内容。

```
$sql = "INSERT into specified table the values (?, ?,?)":
$params = "$param1, $NULLVALUEparam2, $param3); 
```

所以基本上每次都会执行相同的查询，但是允许表单中的一些输入为空，如何将这些添加为 NULL？

背景故事 我正在创建一个注册页面，并且不需要一些信息。这些值通过 POST 方法发送到此操作页面，并在其中添加到数据库中。

我是不是错了，有更好的方法吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T06:50:39.647

如果要将 NULL 插入一行中的特定列，请使用关键字 NULL

```
INSERT INTO yourtable (id, created_at, string, string1)
VALUES (NEWID(), GETDATE(), 'your string you have', NULL) 
```

这将插入一行并将其设置为 NULL。

如果您没有特定列的值，您甚至不需要插入它，那么您只需跳过它。

```
INSERT INTO yourtable (id, created_at, string)
VALUES (NEWID(), GETDATE(), 'your string you have') 
```

这将添加一行并将 string1 列保留为 NULL。但是，当然，您的列在这两种情况下都必须允许 NULL 值。

因此，当您构建您之后执行的 sql 语句时，您的代码应该跳过该列或仅将 NULL 作为字符串写入。

# core-data - 比较 Core Data 中的两个 NSDate

> ID：10342372
> 
> 赞同：0
> 
> 时间：2012-04-26T22:35:00.847
> 
> 标签：core-data, nsdate

我有一个问题...我在核心数据中有一个具有日期属性的实体。如果存在今天日期的记录，我希望我的应用程序能够检查数据存储，以便用户可以继续它或覆盖它。问题是我只是使用这样的 NSPredicate 获取请求：

```
self.whereClause = [NSPredicate predicateWithFormat:@"(date = %@)", [NSDate date]]; 
```

当我将日期打印到控制台时，它们会出现

```
date: 2012-04-26 22:16:45 +0000 
```

并且应用程序无法识别存在现有记录....我觉得这可能是因为时间/时区组件.....

那么我如何比较从 Core Data 中检索到的两个 NSDate 对象而没有时间组件呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T06:57:41.520

您需要使用 00:00 时间创建和比较日期 [NSDate date] 始终包含当前时间，因此无法仅匹配日期。

查看[NSDateComponents](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateComponents_Class/Reference/Reference.html)以创建具有完全相同时间的日期。

另一种解决方案是创建一个查询搜索 (date > 2012-04-26 00:00:00 AND date < 2012-04-26 23:59:59) （需要在一天的开始和结束时创建日期）

如果您想搜索单个完全匹配，我会推荐第一个解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T14:16:38.147

这是从 NSDate 中删除时间组件的代码片段的链接，以防有人想知道

[从 NSDate 中移除时间组件](https://stackoverflow.com/questions/3916392/removing-time-components-from-an-nsdate-object-using-objective-c-cocoa)

# php - jQuery是否可以将 js var 等同于 php var

> ID：10342374
> 
> 赞同：1
> 
> 时间：2012-04-26T22:35:06.003
> 
> 标签：php, jquery

是否可以将 js var 等同于 php var？

```
<?php $count=0; ?> 
<?php $count++; ?> 
```

...

```
<script>var $total = {<?php $count; ?>};</script> 
```

像这样的东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:39:26.710

```
<script>
    var total = 5;
    var total2 = <?= $count ?>;
    if( total == total2 ) {
        // IT works!
    }
 </script> 
```

请记住，此处的 PHP 是在页面到达浏览器之前呈现的（将在其中执行 javascript）。

编辑：另请注意，在您发布的示例中，使用 {} 将导致 javascript 将元素视为对象而不是原始整数，这似乎是您的目标。

# javascript - 使用 Javascript 添加文本字段，但值不断擦除

> ID：10342375
> 
> 赞同：0
> 
> 时间：2012-04-26T22:35:18.923
> 
> 标签：javascript, jquery, html

我有一个我创建的表格如下

```
<label>Search:</label>
        <form name="findrecipe" action="#">

            <input type="radio" name="search" id="search_name" value="name" checked>Name
            <input type="radio" name="search" id="search_ing" value="ingredients">Ingredients<br/>
            <input type="text" name="searchBox" onchange="javascript:addBox(this.value);"/>
            <div id="search">
            </div>
        <input type="submit" value="Submit" />
        </form> 
```

每次使用 java 脚本代码更改字段时，我都会添加一个框

```
function addBox(formVal){
    var temp = this.value;
    alert(formVal);
    if(document.getElementById("search_ing").checked){
        document.getElementById("search").innerHTML += "<br/><input type='text' name='searchBox' onchange='javascript:addBox();'/>";
        this.value = temp;
    }
} 
```

如您所见，我尝试重新输入该值，这样它就不会清除前面框中的值，但我肯定有问题。如何在不清除其余部分的情况下添加文本字段？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:43:16.610

尝试将新元素附加到容器而不是附加 HTML 标记。

```
$('.container').append($('br')).append($('input')); 
```

jQuery 文档：[http ://api.jquery.com/append/](http://api.jquery.com/append/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:39:58.477

看起来您正在传递表单值，但是除了 alert() 之外忽略了它。

改变

```
var temp = this.value; 
```

至

```
var temp = formVal; 
```

和改变

```
this.value = temp; 
```

至

```
document.getElementById("search").value = temp; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T02:47:54.903

您的部分问题是您没有像您认为的那样设置输入的值。

在的情况下

```
this.value = temp; 
```

“this”指的是 DOMWindow，而不是输入，因此您尝试设置窗口的值，而不是输入。

我的解决方案（快速 HTML 注入黑客方式）将类似于

```
function addBox(formVal){
    var temp = formVal;
    //alert(formVal);
    if(document.getElementById("search_ing").checked){

        document.getElementById("search").innerHTML += "<br/><input type='text' name='searchBox' onchange='addBox(this.value);' value='"+formVal+"'/>";
        //this.value = temp;
    }
} 
```

如果我有更多的时间，我会使用一些更优雅的东西（这未经测试，所以它不会开箱即用）

```
var newINput = document.createElement("input");
newINput.type='text';
newINput.value= "";
newInput.name= some unique name ;

document.getElementById('search').appendChild(newINput); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T23:14:01.947

尽管您没有使用任何 jQuery，但您已经标记了问题 jQuery，所以我冒昧地使用了 jQuery...

我会将html简化为：

```
<label>Search:</label>
<form name="findrecipe" action="#">
    <input type="radio" name="search" id="search_name" value="name" checked />Name
    <input type="radio" name="search" id="search_ing" value="ingredients" />Ingredients<br/>
    <input class="searchbox" type="text" name="searchBox" />
    <br/>
    <input type="submit" value="Submit" />
</form> ​ 
```

使用以下 javascript：

```
$(function() {
    $('form').on('change', '.searchbox', function() {
       $('form').append('<br/><input class="searchbox" type="text" name="searchBox" />');
    });
});​ 
```

每当有人更改现有输入的值时，jQuery 将添加一个新输入，但不会更改现有输入，因此所有现有值都将保留。

[这里](http://jsfiddle.net/Cm5Ug/)有一个演示。

# c++ - C++11 友好的图形库

> ID：10342380
> 
> 赞同：8
> 
> 时间：2012-04-26T22:36:15.260
> 
> 标签：c++, c++11, directx

在用其他语言开发了几年之后，由于 ISO C++11 引入了一些不错的特性，我重新开始使用 C++。是否有任何库（基于 DirectX/OpenGL）在其公共 API（共享 ptrs、lambda 友好等）中使用这些新功能？

**编辑：**该库也可以处于 beta 状态，因为我不希望任何库在尚未完全发布的规范上能够商业化。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-06-01T15:36:12.150

从自述文件：

> [Magnum](https://github.com/mosra/magnum)是用 C++11/C++14 和现代 OpenGL 编写的 2D/3D 图形引擎。它的目标是使用最新的 C++11/C++14 特性来简化底层图形开发和与 OpenGL 的交互，并抽象出特定于平台的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T22:56:25.967

没有什么可以阻止您使用例如。任何代码中的 lambdas、auto 和初始化列表。

Gtkmm 和亲戚（你可能喜欢[Cairo C++ 绑定](http://www.cairographics.org/cairomm/)）有干净的 C++ 接口，允许你在你认为合适的时候使用 lambdas 和 autos。能够使用 lambda 作为信号处理程序以及在从 Gtk 智能指针初始化变量时使用 auto 非常有用。

此外，图形代码通常是应用程序的一小部分，而对于*其他部分*，您可以使用适当的 C++ 及其完整的标准库。

除此之外，还没有完全支持 C++11（Visual Studio 远远落后，g++ 的支持还没有完成），因此*为 C++11 设计的*库还没有出现。

没有什么能阻止你尝试和制作你自己的:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T23:00:22.033

据我所知，目前还没有完整的 C++11 编译器。G++ 非常[接近](http://gcc.gnu.org/projects/cxx0x.html)，但还没有。我建议等一下。学习语言是有意义的（即使它不可用），但我认为尘埃落定需要几年时间。

据我所知，在任何图形库中几乎没有地方可以使用任何“高级”语言功能（甚至包括 c++03 中存在的所有内容）。试图充分利用硬件资源并不是使用“编程功夫”有意义的地方——你最终会担心其他事情，而 KISS 原则是优先考虑的。要么就是这样，要么你最终会陷入某种非常具体的破坏心灵的三角噩梦，其中 KISS 原则再次成为优先事项。

据我所知，因为单一语言而改变图形 API 是不值得的，因为多语言的可用性更重要。对于 OpenGL 尤其如此，但即使是 DirectX 也有一些“粉丝制作”的绑定。

目前，在开发在现有 3d API 之上运行的自定义框架时，您可以自由使用所需的任何功能。共享/弱指针在资源管理中很有用。但是，没有理由为此使用 C++11，因为功能在 boost 中可用。

- 编辑 -

[据说](http://labs.qt.nokia.com/2012/04/18/qt-5-c-and-qt-widgets/)Qt 5支持 C++11。从技术上讲，它是一个使用 OpenGL 的图形库...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T23:03:38.677

最接近您想要的可能是[**SFML**](http://www.sfml-dev.org/)，它是一个非常干净的 OpenGL 对象包装器，它或多或少地始终使用现代 C++ 习语。

但是，它没有使用 C++11，而且它太大而无法移植（它包括声音、网络以及除图形之外的更多内容）。

我认为它可以作为 C++11 增量 API 更新的良好基础。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T22:42:44.240

好吧，在 OpenGL 上不行，因为它是一个 C 兼容的 API。

就 DirectX 而言，他们当然不会到处更改 API，只为了在不需要时包含像 lambdas 这样的简洁语言功能。与标准的先前版本相比，C++11 编译器仍然不常用，因此创建一个只有一小部分开发人员可以使用的 API 将是非常愚蠢的。

当成千上万的人使用它时，更改您的 API 会产生广泛的影响。他们将 lambdas 添加到 API 函数中是非常不负责任的，只是因为它们整洁而有光泽。最重要的是，如果您关心实际使用它的人，那么您就不能在每个新版本中破坏您的 API。

EJDIT：

一开始我误解了这个问题。C++11 太新了，目前可能还没有对现有库的 API 更改，因为它会严重限制它们的用户群（据我所知，目前还没有功能齐全的 C++11 编译器，并且即使我们大多数人都不会使用它）。

正如一些评论者正确指出的那样，我最初的反应太狭窄了。您补充说测试版是可以接受的。我仍然不知道有任何库已经大幅修改了他们的 API 以包含 C++11 中的新功能，我之前的观点仍然成立。

更改 API 函数签名很危险，因为您破坏了向后兼容性。如果/当这些更改确实到来时，我希望它们是对 API 的补充，而不是修改。也许这里的某个人知道我不知道的对现有库的最新更改。

# cassandra - 创建 Cassandra 集群失败

> ID：10342385
> 
> 赞同：0
> 
> 时间：2012-04-26T22:36:53.430
> 
> 标签：cassandra, hector

使用这行代码创建集群很简单：

```
Cluster c = HFactory.getOrCreateCluster("MyTest Cluster","localhost:9160"); 
```

编译正常，运行时出现以下错误。感谢任何建议。

> 错误：[java] INFO 连接。CassandraHostRetryService：停机主机重试服务以队列大小 -1 开始，重试延迟 10 秒 [java] 线程“主”java.lang.NoClassDefFoundError 中的异常：org/apache/cassandra/thrift/InvalidRequestException [java ] 在 me.prettyprint.cassandra.connection.ConcurrentHClientPool.(ConcurrentHClientPool.java:48) [java] 在 me.prettyprint.cassandra.connection.RoundRobinBalancingPolicy.createConnection(RoundRobinBalancingPolicy.java:68) [java] 在 me.prettyprint.cassandra .connection.HConnectionManager.(HConnectionManager.java:65) [java] 在 me.prettyprint.cassandra.service.AbstractCluster.(AbstractCluster.java:69) [java] 在 me.prettyprint.cassandra.service.AbstractCluster.(AbstractCluster. java:65) [java] 在 me.prettyprint.cassandra。service.ThriftCluster.(ThriftCluster.java:17) [java] 在 me.prettyprint.hector.api.factory.HFactory.createCluster(HFactory.java:176) [java] 在 me.prettyprint.hector.api.factory.HFactory .getOrCreateCluster(HFactory.java:155) [java] 在 me.prettyprint.hector.api.factory.HFactory.getOrCreateCluster(HFactory.java:128)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T06:32:09.657

It's not finding thrift on your classpath. If you're using Maven and Eclipse, you might expect to see this if you didn't include the cassandra-thrift dependency, or if you performed a recent mvn eclipse:eclipse and need to "refresh" your project.

# ios - 如何观察 NSURLConnection 何时被取消？

> ID：10342387
> 
> 赞同：0
> 
> 时间：2012-04-26T22:37:12.450
> 
> 标签：ios, nsurlconnection, nsnotificationcenter, nsnotifications, nsnotification

如何观察 NSURLConnection 何时被取消？

我有一个方法。

```
- [TSMWebServer sendPage: withArguments: etc...] 
```

sendPage 方法返回一个“NSURLConnection”指针。当 NSURLConnection 被取消时，我需要网络服务器来通知。有没有办法观察何时使用 "NSNotificationCenter" 取消 "NSURLConnection" ？我知道我可以返回一个“NSInvocation”或某种取消连接并向“TSMWebServer”对象发出信号的块（该对象，而不是实际的网络服务器），但我以后可能需要更多的权力，并观察“NSURLConnection”是取消对我来说似乎更好。同样，我可以返回一个包装对象，但这似乎是一堆不需要的工作。

PS 我发现有时很难找到正确的通知。iOS 文档中是否没有列出标准库中使用的所有通知的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:40:16.960

仅当您向其发送消息时，`NSURLConnection`它才会取消`cancel`。因此，如果您向它发送`cancel`消息，您可以告诉自己您正在取消它，因此无需观察。

# android - 如何在android中重新绘制（刷新）listview

> ID：10342390
> 
> 赞同：0
> 
> 时间：2012-04-26T22:37:41.203
> 
> 标签：android, listview, adapter

我在第一个活动中有一个列表视图，我`notifyDataSetChanged();` 在

```
onResume() 
```

和

```
onStart() 
```

但什么也没发生。

当我回到列表视图的活动时，我想重新绘制（刷新）列表视图

代码：

```
package pit.opensource.customizedlist;

import java.util.ArrayList;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.ListView;
import android.widget.TextView;

public class ListViewCustomizedAdapter1Activity extends Activity{

    private ArrayList<Order> m_orders = null;
    private OrderAdapter m_adapter;
    private ListView list;
    private Button btnAdd;
    private Runnable viewOrders;
    private ProgressDialog m_ProgressDialog;
    DBHelper db;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        list = (ListView) this.findViewById(R.id.list);
        btnAdd = (Button) this.findViewById(R.id.btnAdd);

        db = new DBHelper(getApplicationContext());

        //  db.insertOrder(u);
        btnAdd.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View arg0) {
                Intent i = new Intent(getApplicationContext(),Activity1.class);
                startActivity(i);

            }
        });
        m_orders = new ArrayList<Order>();
        m_adapter = new OrderAdapter(getApplicationContext(), R.layout.row, m_orders); // data

        list.setAdapter(m_adapter);

        viewOrders = new Runnable(){ // inner class
            @Override
            public void run() {
                getOrders();
            }
        };

        // Creating a new thread to perform a long-running opertaions, rather than making it in the UI thread
        Thread thread =  new Thread(viewOrders);
        thread.start();

        // Showing a simple progress dialog 
        m_ProgressDialog = ProgressDialog.show(ListViewCustomizedAdapter1Activity.this,    
                "Please wait...", 
                "Retrieving data ...", 
                true);

    }
    @Override
    public void onResume(){
        super.onResume();
        m_adapter.notifyDataSetChanged();
    }
    @Override
    public void onStart(){
        super.onResume();
        // to re-bind the list after adding
        m_adapter.notifyDataSetChanged();
    }
    private Runnable r2 = new Runnable(){

        @Override
        public void run() {
            if(m_orders != null && m_orders.size() > 0){
                for(int i=0;i<m_orders.size();i++)
                    m_adapter.add(m_orders.get(i));
            }
            m_ProgressDialog.dismiss();
            //notifyDataSetChanged() : to refresh the DataSet to re-draw the ListView
            m_adapter.notifyDataSetChanged();
        }
    };

    // Getting the data, here we fill the data manually and simulate the Network operations
    private void getOrders(){
        try{
            m_orders = new ArrayList<Order>();
            /*
            Order o1 = new Order();
            o1.orderName = "SF services";
            o1.orderStatus = "Pending";
            o1.id=1;
            o1.imgName = "a";

            Order o2 = new Order();
            o2.orderName = "SF Advertisement";
            o2.orderStatus = "Completed";
            o2.id = 2;
            o2.imgName = "b";

            Order o3 = new Order();
            o3.orderName = "SF development";
            o3.orderStatus = "Completed";
            o3.id = 3;
            o3.imgName = "c1";      

            Order o4 = new Order();
            o4.orderName = "SF training";
            o4.orderStatus = "Completed";
            o4.id = 4;
            o4.imgName = "c";

            m_orders.add(o1);
            m_orders.add(o2);
            m_orders.add(o3);
            m_orders.add(o4);*/

            //fill from database
            m_orders = db.getAllOrders();

            Thread.sleep(5000);

            Log.i("ARRAY", ""+ m_orders.size());
        } catch (Exception e) {
            Log.e("BACKGROUND_PROC", e.getMessage());
        }
        runOnUiThread(r2);
    }

    // Here we create a customized ArrayAdapter -----------------------------------------------------
    private class OrderAdapter extends ArrayAdapter<Order> {

        private ArrayList<Order> items;
        Context context;

        public OrderAdapter(Context context, int textViewResourceId, ArrayList<Order> items) {
            super(context, textViewResourceId, items);
            this.items = items;
            this.context = context;
        }
        @Override
        public View getView( int position, 
                View convertView // (ListItem)Row = textView ... etc
                , ViewGroup parent) {

            View v = convertView;
            if (v == null) {
                // LayoutInflater: to convert the 'layout XML file' to a corresponding Java 'View' object
                // getSystemService(): A system level service to retrieve the LayoutInflater
                LayoutInflater vi = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                v = vi.inflate(R.layout.row, null);
            }
            Order o = items.get(position);
            if (o != null) {
                TextView tt = (TextView) v.findViewById(R.id.toptext);
                TextView bt = (TextView) v.findViewById(R.id.bottomtext);
                Button btn = (Button) v.findViewById(R.id.btnMore);
                ImageView img = (ImageView) v.findViewById(R.id.icon);

                tt.setText("Name: "+o.orderName);                            
                bt.setText("Status: "+ o.orderStatus);
                Log.d("Adpdter status",o.orderStatus);
                // To get Image ID using the image name ---------
                try{
                    if(o.imgName!=null){
                        int resID = getResources().getIdentifier(o.imgName, "drawable", getPackageName());
                        img.setImageDrawable(getResources().getDrawable(resID));
                    }else{
                        img.setImageDrawable(getResources().getDrawable(R.drawable.ic_launcher));
                    }
                }catch(Exception ex){}

                btn.setOnClickListener(new OnClickListener() {

                    @Override
                    public void onClick(View arg0) {

                        //btn.en
                        Intent i = new Intent(getApplicationContext(),Activity1.class);
                        //  i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                        //  startActivity(i);

                    }
                });
            }
            return v;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:56:42.143

呼叫`notifyDataSetChanged()`后立即呼叫`db.update()`,`db.insert()`等。

**加法**哦，看，代码！:)

这条线正确吗？

```
 m_adapter.add(m_orders.get(i)); 
```

或者你的意思是添加项目`m_orders`？适配器已经链接到`m_orders`并将反映*此*数组中的任何内容。

如果我们改为`Runnable r2`：

```
@Override
public void run() {
    m_orders.add(new Order("Pizza"));
    m_orders.add(new Order("Beer"));
    m_orders.add(new Order("Other American Health Food"));
    m_adapter.notifyDataSetChanged();
} 
```

这会反映变化吗？（我对您的 Order 课程有些随意）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:54:44.500

数据是否真的发生了变化？没有看到更多代码，我猜“不”。

# c# - 拦截 ESC 而不从缓冲区中删除其他按键

> ID：10342392
> 
> 赞同：1
> 
> 时间：2012-04-26T22:37:50.640
> 
> 标签：c#, .net, console, pinvoke

我有一个控制台应用程序，提示用户输入多个输入。我希望用户能够在任何提示取消操作后按转义键。

就像是：

```
if (Console.ReadKey().Key != ConsoleKey.Escape) {
  string input = Console.ReadLine();
  ...
} 
```

但是，这样做的问题是，如果按下了除转义之外的键，则它不会成为输入的一部分（从 中返回`ReadLine`）。

有没有办法“偷看”下一个键，或者这样做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T15:01:49.273

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
internal struct InputRecord
{
  internal short eventType;
  internal KeyEventRecord keyEvent;
}
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
internal struct KeyEventRecord
{
  internal bool keyDown;
  internal short repeatCount;
  internal short virtualKeyCode;
  internal short virtualScanCode;
  internal char uChar;
  internal int controlKeyState;
}

[DllImport("kernel32.dll", SetLastError = true)]
internal static extern bool PeekConsoleInput(IntPtr hConsoleInput, out InputRecord buffer, int numInputRecords_UseOne, out int numEventsRead);

[DllImport("kernel32.dll", SetLastError = true)]
internal static extern bool ReadConsoleInput(IntPtr hConsoleInput, out InputRecord buffer, int numInputRecords_UseOne, out int numEventsRead);

[DllImport("kernel32.dll", SetLastError = true)]
internal static extern IntPtr GetStdHandle(int nStdHandle);

static Nullable<InputRecord> PeekConsoleEvent()
{
  InputRecord ir;
  int num;
  if (!PeekConsoleInput(GetStdHandle(-10), out ir, 1, out num))
  {
    //TODO process error
  }
  if (num != 0)
    return ir;
  return null;
}
static InputRecord ReadConsoleInput()
{
  InputRecord ir;
  int num;
  if (!ReadConsoleInput(GetStdHandle(-10), out ir, 1, out num))
  {
    //TODO process error
  }
  return ir;
}
static bool PeekEscapeKey()
{
  for (; ; )
  {
    var ev = PeekConsoleEvent();
    if (ev == null)
    {
      Thread.Sleep(10);
      continue;
    }
    if (ev.Value.eventType == 1 && ev.Value.keyEvent.keyDown && ev.Value.keyEvent.virtualKeyCode == 27)
    {
      ReadConsoleInput();
      return true;
    }
    if (ev.Value.eventType == 1 && ev.Value.keyEvent.keyDown)
      return false;
    ReadConsoleInput();
  }
} 
```

使用示例：

```
 for (; ; )
  {
    Console.Write("?");
    if (PeekEscapeKey())
    {
      Console.WriteLine("esc");          
      continue;
    }
    Console.Write(">");
    var line = Console.ReadLine();
    Console.WriteLine(line);
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T22:47:12.030

要查看，您必须使用 TextReader.Peek。要将其与控制台一起使用，您将使用`Console.In.Peek()`. 要使用您正在考虑的代码：

```
if(Console.In.Peek() != "\0x1B") // 0x1B is the Escape Key
{
        string input = Console.ReadLine();
        ....
} 
```

这应该有效。我没有测试它，但它似乎是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T22:53:05.647

或者比@user823682 稍微不那么优雅的方法

```
ConsoleKeyInfo key = Console.ReadKey().Key;
if (key != ConsoleKey.Escape) {
  string input = String.Concat(key.KeyChar,Console.ReadLine());
  ...
} 
```

# cryptography - AES-CCM 附加认证数据长度 l(a)

> ID：10342394
> 
> 赞同：0
> 
> 时间：2012-04-26T22:38:04.113
> 
> 标签：cryptography, aes, cc-mode

我根据 RFC-3610 实现了 AES-CCM，我想知道为什么额外的认证数据 l(a) 的长度需要由 MAC 保护。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T02:36:40.217

标准警告：不要编写自己的加密并使用它。使用由专业加密人员编写的可信库。几乎所有你需要的语言/运行时都有一些，或者应该为它编译。

### 至于你的问题：

默认情况下，CBC-MAC 仅适用于固定长度的[消息](http://en.wikipedia.org/wiki/CBC-MAC#Security_with_fixed_and_variable-length_messages)。如果攻击者知道消息 m 上的标签 t 和消息 m' 上的标签 t'，他们就可以在实际上未发送的第三条消息上伪造标签。事实上这是![在此处输入图像描述](../Images/e537c497005adbd82c1b1cc00752db6a.png)

如果您在前面加上长度，它会更安全，尽管您仍然可以获得彼此前缀的消息并遇到类似的问题。因此，一个随机数也被前置的原因之一。

# macos - 如何在 Mac 的 emacs 中将 ESC 绑定到 Quit (Cg)

> ID：10342397
> 
> 赞同：3
> 
> 时间：2012-04-26T22:38:11.313
> 
> 标签：macos, emacs, keyboard-shortcuts

我正在为 Mac 使用 emacs 24.0.95（来自 emacsformacosx.com 构建）。

我试过做

```
(global-set-key (kbd "<escape>") 'keyboard-escape-quit) 
```

正如在类似（但特定于获胜）的问题（http://stackoverflow.com/questions/648817/how-to-bind-esc-to-keyboard-escape-quit-in-emacs）中所建议的，这似乎适用于 Win但不是在 Mac 上，所有元击键都停止工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-16T17:45:27.747

我无法帮助您解决 OSX 问题，因为我在这里使用的是 linux 机器，但我确实注意到 Cg 运行命令**keyboard-quit**而不是**keyboard-escape-quit**。对于 emacs 文档，您可以调用：**Ch k Cg**来查看它......但无论如何它都是这样说的：

“Cg 运行命令keyboard-quit，这是一个在`simple.el' 中的交互式编译Lisp 函数。

它与 Cg 绑定。

（键盘退出）

发出“退出”条件的信号。在执行 Lisp 代码期间，此字符会直接导致退出。在顶层，作为编辑器命令，这只是发出哔哔声。”

所以也许这对你有帮助？

编辑：我可以在我的设置中确认：

`(global-set-key (kbd "<escape>") 'keyboard-quit)`

成功地将**Cg**重新绑定到单个 Escape 中风。

# c# - REST HttpWebRequest GetResponseStream() 错误 500

> ID：10342398
> 
> 赞同：1
> 
> 时间：2012-04-26T22:38:18.217
> 
> 标签：c#, web-services, rest

我正在使用第三方开源服务器软件 Bonitasoft 的工作流引擎上的 REST Web 服务。这是在 Apache 上运行的。不幸的是，该软件只允许对任何 Web 服务调用使用 POST 方法。

为了测试通话的基础知识，我可以毫无问题地使用 Firefox 的海报插件。以下是实用程序中使用的请求信息：

*   **网址：** [http://internalserver/bonita-server-rest/API/queryDefinitionAPI/getLightProcesses](http://internalserver/bonita-server-rest/API/queryDefinitionAPI/getLightProcesses)
*   **用户验证：**用户名、密码
*   **内容类型：** application/x-www-form-urlencoded
*   **正文：** options=user%3a100%2cpassword%3a100

使用此信息运行加载项后，我会收到包含我正在寻找的信息的响应。在客户端和服务器上都没有与调用相关的错误。这是通过海报进行此调用时写入服务器日志的内容：

```
10.0.5.1 - username [26/Apr/2012:16:06:24 -0600] "POST /bonita-server-rest/API/queryDefinitionAPI/getLightProcesses HTTP/1.1" 200 981091 
```

所有系统都去！

现在，我正在尝试制作一个 C# 控制台应用程序，该应用程序将与此海报实用程序执行相同的操作。以下是我正在使用的当前测试代码：

```
// Create the URI Address
var address = new Uri(url);  

// Create the web request  
var request = WebRequest.Create(address) as HttpWebRequest;  

// Set type to POST  
request.Method = "POST";
request.ContentType = "application/x-www-form-urlencoded";
request.Credentials = new NetworkCredential("username", "password");

// Create the data we want to send  
var data = HttpUtility.UrlEncode("options=user:100,password:100"); 

// Set the content length in the request headers  
request.ContentLength = data; 

// Write data  
using (Stream postStream = request.GetRequestStream())  
{
    using (StreamWriter writeStream = new StreamWriter(postStream))
    {
        writeStream.Write(data);
    }
}  

// Get response  
using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)  
{  
    // Get the response stream  
    StreamReader reader = new StreamReader(response.GetResponseStream());  

    // Console application output  
    Console.WriteLine(reader.ReadToEnd());  
} 
```

当我运行应用程序时，它会毫无问题地进入 GetResponse() 方法，但是一旦调用此方法，我就会收到以下错误（截断堆栈跟踪）：

```
System.Net.WebException: The remote server returned an error: (500) Internal Server Error. 
```

以下是Apache写出的日志信息：

```
10.0.5.1 - - [26/Apr/2012:16:21:08 -0600] "POST /bonita-server-rest/API/queryDefinitionAPI/getLightProcesses HTTP/1.1" 401 1331172
10.0.5.1 - username [26/Apr/2012:16:21:08 -0600] "options%3duser%3a100%2cpassword%3a100POST /bonita-server-rest/API/queryDefinitionAPI/getLightProcesses HTTP/1.1" 500 1150384 
```

当然，第一个想法是该服务无法正常运行，但事实并非如此，因为独立客户端可以毫无错误地调用该服务。我一直在浏览大量文章和问题，但无法解决此问题。在收到回复方面我做错了什么吗？其他想法？

作为参考，我已经使用 Grails 完成了完全相同的服务调用（叹气）并且没有收到任何错误。

** 更新 1 ** 我试图通过添加以下内容来消除 401：

```
request.PreAuthenticate = true; 
```

但这并没有解决我的问题。

** 更新 2 ** 我已经能够通过使用以下代码手动设置标题来消除 401：

```
byte[] authBytes = Encoding.UTF8.GetBytes("username:password".ToCharArray());
request.Headers["Authorization"] = "Basic " + Convert.ToBase64String(authBytes); 
```

为了确保我手动将标头添加到海报请求中，我没有收到 500 错误，而是收到了我期望的数据。但是，我仍然通过 .NET 实现收到 500 错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T19:29:16.673

我已经解决了我的问题。

为了与那里的大多数文档保持一致，我将需要写出的正文数据移回字节数组。

```
// Create the data we want to send   
var data = HttpUtility.UrlEncode("options=user:100,password:100");  

// Create a byte array of the data we want to send  
byte[] byteData = UTF8Encoding.UTF8.GetBytes(data);  

// Set the content length in the request headers   
request.ContentLength = byteData.Length;  

// Write data   
using (Stream postStream = request.GetRequestStream())   
{ 
  postStream.Write(data);
} 
```

这并没有解决我的问题，但让我回到了共同点。然后，我查看了通过浏览器加载项发送的标题和正文，并反转了任何 UTF8 编码，发现内容在 UTF8 编码之前不是 URL 编码的。然后我将我的代码更改为不执行 URL 编码并且它没有问题地工作：

```
// Create the data we want to send   
var data = "options=user:100,password:100";

// Create a byte array of the data we want to send  
byte[] byteData = UTF8Encoding.UTF8.GetBytes(data);  

// Set the content length in the request headers   
request.ContentLength = byteData.Length;  

// Write data   
using (Stream postStream = request.GetRequestStream())   
{ 
  postStream.Write(data);
} 
```

看起来很简单，我不知道我是怎么错过的。感谢您对此的帮助。希望这会帮助一些人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T02:45:31.347

假设请求在 Web 浏览器中正常工作，问题很可能是身份验证信息传递到服务器的顺序。

设置`request.PreAuthenticate`为真。那应该可以解决问题。

# algorithm - A* 算法和 F 和 G 启发式的使用

> ID：10342399
> 
> 赞同：0
> 
> 时间：2012-04-26T22:38:23.443
> 
> 标签：algorithm

我的 A* 算法在一定程度上发挥了作用。它会跟随玩家在一个空间中四处走动，但它不会绕过一个需要远离目标才能绕过它的物体。当它意识到下一个节点具有更高的 F 值（离目标更远）时，它会拒绝去那里，并且会继续寻找更低的 F 值（离目标更近的节点）而不找到一个（它卡在一个永无止境的循环）。

我认为我对启发式使用的理解可能是问题所在。

我的 A* 总是移动到具有最低 F 值 (H+G) 的下一个节点。除了将它们添加到 F 之外，我从不考虑 G 或 H 值。

在我读过的教程中，他们谈到使用 G 值，但我认为 F 值是唯一重要的值。

有人可以总结一下我如何使用启发式值。我想我快到了，只是启发式的使用令人困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:45:16.767

您是否保留了备用路径段的优先级队列？如果你只看成本最低的下一步，你将无法绕过障碍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T22:46:39.390

你明白了。H 告诉您到达该节点实际需要多远；G 是您必须走多远的估计值。如果您只考虑 G，那么您会选择最接近目标的路径，即使到达该节点需要很长时间。这就是你使用 F (=H+G) 的原因，这样当你第一次达到一个目标时，你就知道它是最短路径的那个。

现在，如果您有无数条路径，那么试图找到最佳路径可能是个问题。或者您的路径生成算法可能有问题（例如，导致您重新考虑路径）。由于您没有就问题提供更多详细信息，因此我不能说更多可能有用的信息。

再说一次，你可能有一个糟糕的（或更糟糕的，不可接受的）启发式函数......

# sql - 返回每组一列最大值的行

> ID：10342405
> 
> 赞同：7
> 
> 时间：2012-04-26T22:39:07.860
> 
> 标签：sql, oracle, max, greatest-n-per-group

如果没有至少两次搜索同一个表以获取最大行，然后获取该行的值，我很难做到这一点。有问题的桌子很大，所以这是不可接受的。

这是我的表可能的样子：

```
SCORES
ID    ROUND    SCORE
1     1        3
1     2        6
1     3        2
2     1        10
2     2        12
3     1        6 
```

我需要返回每个 ID 在最近一轮中获得的分数。也就是说，具有最大值（回合）的行，但不是最高分数。

```
OUTPUT:
ID   ROUND   SCORE
1    3       2
2    2       12
3    1       6 
```

现在我有：

```
SELECT * FROM 
(SELECT id, round,
CASE WHEN (MAX(round) OVER (PARTITION BY id)) = round THEN score ELSE NULL END score
 FROM
 SCORES
 where id in (1,2,3)
) scorevals
WHERE
scorevals.round is not null; 
```

这行得通，但是效率很低（我必须手动过滤掉所有这些行，而我一开始就应该无法抓取这些行。）

我该怎么做才能获得正确的价值观？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T23:04:58.473

这在没有子查询的情况下也是可能的：

```
SELECT DISTINCT
       id
      ,max(round) OVER (PARTITION BY id) AS round
      ,first_value(score) OVER (PARTITION BY id ORDER BY round DESC) AS score
FROM   SCORES
WHERE  id IN (1,2,3)
ORDER  BY id; 
```

准确返回您要求的内容。
关键是*在*窗口函数之后`DISTINCT`应用。

 *[SQL小提琴。](http://sqlfiddle.com/#!4/7cc38/1)

也许更快，因为它两次使用相同的窗口：

```
SELECT DISTINCT
       id
      ,first_value(round) OVER (PARTITION BY id ORDER BY round DESC) AS round
      ,first_value(score) OVER (PARTITION BY id ORDER BY round DESC) AS score
FROM   SCORES
WHERE  id IN (1,2,3)
ORDER  BY id; 
```

否则做同样的事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-26T22:44:19.387

使用分析函数，您走在了正确的轨道上。但是你可能想要这样的`rank`功能

```
SELECT *
  FROM (SELECT a.*,
               rank() over (partition by id order by round desc) rnk
          FROM scores
         WHERE id IN (1,2,3))
 WHERE rnk = 1 
```

如果可能存在关联（具有相同`id`和的行`round`），您可能希望使用`row_number`分析函数而不是`rank`-- 这将任意选择两个关联行中的一个以使 a`rnk`为 1，而不是按原样返回两者`rank`。

如果你想使用`MAX`分析功能，你也可以做类似的事情

```
SELECT *
  FROM (SELECT a.*,
               MAX(round) OVER (partition by id) max_round
          FROM scores
         WHERE id IN (1,2,3))
 WHERE round = max_round 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-06T16:49:14.303

对于这类问题，我倾向于使用以下`max...keep...dense_rank`构造：

```
select
  id,
  max(round)  round,
  max(score) keep (dense_rank last order by round) score
from
  tq84_scores
group by
  id; 
```

[sql小提琴](http://sqlfiddle.com/#!4/2e606/1)*

# javascript - jQuery插件架构，在哪里定义对象和变量的生命周期？

> ID：10342406
> 
> 赞同：0
> 
> 时间：2012-04-26T22:39:15.637
> 
> 标签：javascript, jquery, jquery-plugins, requestanimationframe

我正在编写一个 jquery 插件来在画布中渲染图像。

最终目标是实现类似

```
var myImageSource = new ImageSource(path,width,height);
$("#myCanvas").Render({"source" : myImageSource}); 
```

该插件需要几个类、herpers 和其他一些 jquery 插件才能正常工作。

所以假设我依赖于

*   鼠标滚轮jQuery插件
*   一个缓存库，它不是一个 jquery 插件，而是一个带有原型和一些枚举的对象

我有一个动画引擎，它是一个需要全局变量（或至少在插件级别）的循环

```
function runAnimations(timeStamp) {

    window.requestAnimationFrame(runAnimations);

    for (var i = 0; i < animations.length; i++) {
        animations[i].update(timeStamp);
    }
} 
```

我必须定义我自己的对象

*   观点
*   长方形
*   视口
*   图像源
*   动画1

所以我的尝试是这样的：

```
 - Reference to other script library (like Cache)
 - Reference to other JQuery Plugin

; (function ($, window, document, undefined) {

   //global variable declaration
   var animations = [];
   var isAnimationLoopStarted = false;

   //global functions
   function runAnimations(timeStamp) {

        window.requestAnimationFrame(runAnimations);

        for (var i = 0; i < animations.length; i++) {
            animations[i].update(timeStamp);
        }
    }

   //objects declarations
   function Rect(x, y, height, width) {
      this.x = x;
      this.y = y;
      this.width = width;
      this.height = height;
   }

  Rect.prototype.moveTo = function (x, y) {
      this.x = x;
      this.y = y;
   };

   //other object declarations Point, ImageSource, ViewPort etc..

   //plugin interface
    var methods = {
        init: function () {
            return this.each(function () {

                });
            });
        },
        destroy: function () {
            return this.each(function () {
            });
        }
    };

    $.fn.render = function (method) {
        if (method === 'destroy') {
            return methods.destroy.apply(this);
        } else {
            return methods.init.apply(this);
        }
    }

})(jQuery, window, document); 
```

所以我的问题是：

*   你觉得走这条路好吗？
*   如果我这样做，ImageSource 的定义将在插件之外不可用
*   我是否应该放弃 ImageSource 对象来使用数组，所以我对对象定义没有问题
*   插件内部定义的全局变量的生命周期是怎样的，比如动画，会一直可用吗？
*   使用动画之类的变量是最佳做法，还是使用 .data jquery 函数更好，但在这种情况下如何共享变量？

提前感谢您的帮助

弗雷德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T08:13:00.400

所以我的答案是：

*   看起来不错。然而，在你的闭包参数中你不需要`window`or `document`，它们是简单的全局变量。如果你想“重命名”它们，你只需要它们，例如 to `global`and `doc`。我宁愿将该脚本库接口对象作为函数的参数。
*   是的。但是构造函数需要在外部可用吗？我想不是。如果你真的需要它们，可以在闭包中声明它们；例如将它们导出到静态属性中，例如`$.render`.
*   您需要向我们提供 的代码`ImageSource`，否则我们无法回答该问题
*   您**没有**在插件中定义任何全局变量（请调整您的评论）。它们是本地的（不是说插件闭包中的“私有”变量，可用于该范围内的所有其他内容。当没有任何东西（可以）再引用它们时，它们的生命周期将结束（自动垃圾收集）。但是你导出一个函数to `$.fn.render`，它一直都有这些引用。因此，只要该导出存在，您的局部变量就会存在。
*   你应该挂钩 jQuerys 动画队列。你如何“分享”你的变量没有`.data()`？我会说属于某个（DOM-）节点的所有内容都应该设置为数据属性，否则在初始化后您将无法访问它，对吗？

# node.js - Nodejs Coffescript 在没有翻译和咖啡命令的情况下执行

> ID：10342408
> 
> 赞同：2
> 
> 时间：2012-04-26T22:39:24.220
> 
> 标签：node.js, coffeescript

这里有什么方法可以在 Nodejs 中执行 Coffescript 脚本而不需要翻译成 js 或 coffee 命令。

什么会即时翻译coffeesctipts，节点将如何请求它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T22:47:20.043

首先， do `npm install coffee-script`，然后在你的 server.js（或 app.js）中 do `require('coffee-script')`，所有的 coffeescript 文件都会被自动编译。

本教程系列介绍如何包含咖啡脚本文件，以便在编辑它们时自动重新编译它们：

[http://nodetuts.com/tutorials/16-introduction-to-coffeescript-and-nodejs.html#video](http://nodetuts.com/tutorials/16-introduction-to-coffeescript-and-nodejs.html#video)

[http://nodetuts.com/tutorials/14-some-nodejs-tools.html#video](http://nodetuts.com/tutorials/14-some-nodejs-tools.html#video)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T13:12:18.243

如果您的代码是 100% 咖啡，您可能需要检查[nodemon](https://github.com/remy/nodemon)

我目前直接在 coffescript 中编写我的代码，然后运行我的服务器而不是做`node <server-file>coffee`，我只是运行：

`nodemon <server-file>.coffee`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-17T20:08:45.853

您使用一个只有 2 行的小 JS 文件：

```
require('coffee-script/register');
require('my_program.coffee'); 
```

您可以直接使用 Node.js 运行这个微小的 JS 文件。反过来，它会加载、编译和运行您的咖啡脚本代码。然后你可以修改你的coffeescript程序并重新运行它而无需任何单独的编译步骤——只需重新运行JS文件。

# postgresql - 文本字段相等

> ID：10342412
> 
> 赞同：0
> 
> 时间：2012-04-26T22:39:28.513
> 
> 标签：postgresql, triggers, plpgsql

我有一个表 foo，里面有一个文本字段栏。在那张桌子上，我有一个更新后触发器，基本上如下：

```
 CREATE OR REPLACE FUNCTION update_foo() 
RETURNS TRIGGER
SECURITY DEFINER
AS
$_$
DECLARE 
BEGIN
  IF TG_OP = 'UPDATE' and NEW.bar = OLD.bar THEN
    return NEW;
  END IF;

  /* Do some stuff */

END
$_$
LANGUAGE PLPGSQL; 
```

然后我做这样的事情： `Update foo set bar = bar || '';`。

但是当文本值相等时它不会保释。

我的问题是，为什么 PostgreSQL 8.3，特别是 pl/PgSQL 不称它们为平等并尽早退出？

*免责声明：表、字段和变量名称已从其原始名称更改，以允许在线发布。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:02:26.027

这将是因为其中一个值是空值。并且 null 不能等于任何其他值，

所以你需要添加额外的标准

```
(New.bar is  null or Old.bar is null) 
```

或者

```
 NEW.bar is not distinct from OLD.bar 
```

# c# - 如何删除超过 7 天的文件夹 C#/NET

> ID：10342415
> 
> 赞同：6
> 
> 时间：2012-04-26T22:39:51.520
> 
> 标签：c#, winforms, visual-studio-2010, .net

我想编写一些代码来删除所有超过 7 天的 DIRECTORIES。

所以：

1.  检查目录：`D:\this`
2.  如果文件夹超过 7 天 -> 从系统中删除它。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-26T22:44:29.047

您可以使用 DirectoryInfo 实用程序进行查找

```
 DirectoryInfo d = new DirectoryInfo(dir);
   if (d.CreationTime    < DateTime.Now.AddDays(-7))
       d.Delete(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T22:45:05.100

您可以使用 DirectoryInfo

[http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)

经验之声说要在您的代码中包含健全性检查，以确保您要删除的目录实际上是您要删除的目录......

# javascript - 如何摆脱一系列字符串替换（）？

> ID：10342419
> 
> 赞同：0
> 
> 时间：2012-04-26T22:40:11.737
> 
> 标签：javascript

我有一组 [a][z] 形式的短字符串，其中 a 和 z 是（组件）子字符串。[z]中能进去的字符串限制在100个左右，整个输入字符串中只能出现一个。

现在，我需要将 [z] 字符串替换为另一个字符串。鉴于数据格式，一旦我找到匹配项，我知道我可以停止查找。我想返回替换的字符串。

我的方法不是最理想的，因为我在返回修改后的字符串之前遍历了所有可能性。我想知道是否有办法打破搜索，可能是使用输入字符串在匹配时更改的事实？我怎么知道更换发生了？每个页面加载我需要运行这个函数大约 1000 次，所以我认为任何改进都会被注意到。提前致谢！

[http://jsfiddle.net/MsWAZ/3/](http://jsfiddle.net/MsWAZ/3/)

```
function replaceEnd(input) {
        // bb, cc, and d are what I call [z]
        input = input.replace("bb", "Bob");
        input = input.replace("ccc", "Carl");
        input = input.replace("d", "Dave");

        return input;
}

document.write(replaceEnd("aabb") + "<br>");
document.write(replaceEnd("eaccc") + "<br>");
document.write(replaceEnd("uoid") + "<br>"); 
```

输出：

```
aaBob
eaCarl
uoiDave 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T22:48:58.317

```
function replaceEnd(input) {
    input2 = input;
    // bb, cc, and d are what I call [z]
    if((input2 = input.replace("bb", "Bob")) != input) return input2;
    if((input2 = input.replace("ccc", "Carl")) != input) return input2;
    if((input2 = input.replace("d", "Dave")) != input) return input2;

    return input2;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T22:49:57.800

```
function replaceEnd(input) {
        // bb, cc, and d are what I call [z]
        var replacements = {"bb" : "Bob", "ccc" : "Carl", "d" : "Dave"}, newInput;
    for(var key in replacements){
        if((newInput = input.replace(key,replacements[key])) != input)
            return newInput;
    }
    return input;
} 
```

# php - 删除彼此相邻的重复字符

> ID：10342423
> 
> 赞同：15
> 
> 时间：2012-04-26T22:40:38.773
> 
> 标签：php, string

我试图删除直接相邻的重复字符

1,2,3,4,5 - 有几个逗号，但它们不会被删除 1,,2,,3,,4,,5 - 必须变成常规的 1,2,3,4 ,5 无论每个数字之间有多少个逗号，我都希望只有一个。我有类似的东西可以确保字符串末尾没有逗号：

```
$n = "1,2,3,4,5";
for ($i=0;$i< strlen($n);$i++) {

    if (substr($n, -1) == ',') {
        $n = substr($n, 0, -1);
    }
} 
```

希望能在这个问题上提供一些帮助，

谢谢 ：）

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-04-26T22:42:28.660

看起来您只想使用逗号来执行此操作，因此使用[preg_replace](http://php.net/manual/en/function.preg-replace.php)非常容易：

```
$n = '1,2,,3,,,,,4,5';
$n = preg_replace('/,+/', ',', $n);     // $n == '1,2,3,4,5' 
```

[您也可以用rtrim](http://php.net/manual/en/function.rtrim.php)替换上面给出的确保字符串末尾没有逗号的代码。它会更快更容易阅读：

```
$n = '1,2,3,4,5,,,,,'
rtrim($n, ',');                         // $n == '1,2,3,4,5' 
```

您可以将它们组合成一个单行：

```
$n = preg_replace('/,+/', ',', rtrim($n, ',')); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-26T22:48:47.200

```
$n = '1,2,,3,,,,,4,5';
$n = preg_replace('/(.)\\1+/', '$1', $n); 
```

这*应该*适用于紧随其后的任何重复字符。

但是，提问者不太可能希望以这种方式替换*任何*重复的字符（包括像 44 => 4 这样的数字）。更有可能是这样的：

```
$n = preg_replace('/([,.;])\\1+/', '$1', $n); # replace repetitions of ,.:
$n = preg_replace('/([^\d])\\1+/', '$1', $n); # replace repetitions of non-digit characters 
```

# jax-rs - 用于序列化一个元素的数组的 JAX-RS 标准解决方案

> ID：10342427
> 
> 赞同：0
> 
> 时间：2012-04-26T22:40:57.530
> 
> 标签：jax-rs

就像球衣文档中描述的那样，球衣用作默认的 MAPPED 表示法，所以我有一个元素列表的序列化问题。

[http://jersey.java.net/nonav/documentation/latest/json.html#d4e949](http://jersey.java.net/nonav/documentation/latest/json.html#d4e949)

到目前为止，我在客户端解决了问题，但现在，我无法访问客户端代码。

我需要以自然表示法序列化数组，但我不能让我的代码依赖于球衣。我需要一个符合 JAX-RS 标准的解决方案，一个跨平台的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T12:34:23.360

在 JAX-RS 中，不要指定 JSON 提供程序，因此如果我想要一个可移植的解决方案，我必须实现我自己的提供程序。

# matlab - 使用Matlab检测并标记功率谱分析图上的最大峰值？

> ID：10342440
> 
> 赞同：2
> 
> 时间：2012-04-26T22:42:12.610
> 
> 标签：matlab, plot

我试图在 Matlab 中创建的功率谱密度图上找到最大峰值。我可以很好地创建情节，但很难正确标记它。我使用 find peaks 和 max 函数找到它，但 Matlab 无法正确标记它。它会找到正确的高度，但会稍微向左或向右标记。这是代码：

```
data = load ('EEGData(test1).txt', '-ascii');
figure(1)
plot(data)

Y =fft(data,251);

Pyy = Y.*conj(Y)/251;

f = 1000/251*(0:127);

figure(2) 
plot(f,Pyy(1:128))
title('Power spectral density')
xlabel('Frequency (Hz)')

[a,b] = findpeaks(Pyy(1:128));
MAX = max(a);
hold on
plot(f(b), MAX,'or') 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T22:55:31.380

当我通过替换数据来测试您的代码时

```
data=randn(251,1); 
```

...我发现红色 o 标记指示的局部峰值位置在正确的位置。只是所有峰都标记在最大峰的高度。

我不是 100% 确定您要做什么，但看起来您似乎只是想找到最大峰值。如果是这种情况，那么您不需要 findpeaks 功能。只需将代码的最后几行替换为以下...

```
[MAX, MAXidx] = max(Pyy(1:128));
hold on
plot(f(MAXidx), MAX,'or') 
```

# entity-framework-4 - 为什么将 EntityState 设置为 Detached 会清空 List 类型的属性 ?

> ID：10342445
> 
> 赞同：9
> 
> 时间：2012-04-26T22:42:49.580
> 
> 标签：entity-framework-4, ef-code-first

首先使用实体​​框架代码，我有类似的东西：

```
public class Foo
{
    public int Id { get; set; }

    public List<Bar> Bars { get; set; }
}    

Foo foo = (from f in ctx.Foos.Include("Bars") where f.Id == 42 select f).Single();

// At this point foo.Bars is populated

ctx.Entry(foo).State = EntityState.Detached;

// At this point foo.Bars is an empty List 
```

为什么分离对象会导致其`public List<string> Bars`明确且成功包含的属性被清空？

分离可能具有许多属性的对象的正确程序是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-27T00:22:59.873

列表被清空的原因是实体框架中的两个规则的组合：

1.  当你分离一个对象时，只有这个对象本身被分离，没有任何导航属性引用的对象。

2.  `ObjectContext`/`DbContext`不允许保存部分附加到上下文并部分分离的对象图。虽然这可能在使用 POCO 时作为临时状态发生，但 EF 将始终通过在各种方法（如`Add`、`Attach`、设置实体的状态等）或最近`SaveChanges`调用时自动附加图表中的分离对象来修复此临时状态。

这意味着当您从上下文中分离根对象时，EF 将清除子对象列表，因为：a) 子对象保持连接状态（规则 1）和 b) 不允许在图中混合分离和附加对象（规则2）。

据我所知，在保持原始树结构的同时，无法将对象图从上下文中分离出来。您可以将父级分离，然后将子级一个接一个地分离。结果，您已将树的所有对象从上下文中分离出来，但树同时被销毁 - 每个导航属性都无效。

手动分离实体的主要目的是在您有内存资源限制并且不希望并且需要在上下文中保存大量对象的情况下释放它们以进行垃圾回收。为此，图结构被破坏并不重要。

我不知道为什么需要从上下文中分离对象。但请记住，还可以选择从数据库中加载实体而不首先将它们附加到上下文中，例如使用`AsNoTracking()`.

关于 MSDN 文档的一些引用的问题的另一个答案在这里：[https ://stackoverflow.com/a/7693732/270591](https://stackoverflow.com/a/7693732/270591)

# javascript - Jquery 定义一个 $(this) 变量以便在许多函数中重用

> ID：10342449
> 
> 赞同：1
> 
> 时间：2012-04-26T22:43:39.437
> 
> 标签：javascript, jquery, global-variables

我在一个 javascript 文件中有大约 10 个函数。开头的每个函数都有以下语句：

```
var $me = $(this); 
```

`$me`在全局范围内定义，然后在每个函数的开头重新定义它会更好吗？或者它没有任何区别？例如...

```
var $me;
function doo() {$me = $(this)}
function foo() {$me = $(this)}
// etc. etc. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:06:43.417

您永远不应该`$me`在全局定义的情况下实现您的第二个选项，但在每个本地函数中都被覆盖。这是灾难的秘诀。如果一个函数调用另一个函数（或触发事件处理程序），`$me`将被覆盖并从第一个函数中的正确值中被淘汰。不 - 不要这样做。

正确的方法是在您使用它的每个函数中定义一个新的局部变量。这既更快又不容易覆盖错误。仅供参考，局部变量比全局变量访问速度更快。

如果您需要在函数中保存 $(this) 的副本，请输入：

```
var $me = $(this); 
```

靠近函数顶部（在函数体内），所以它是一个临时局部变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T22:47:35.010

我能想到的保持变量本地化和使其全局化之间的唯一区别是你污染了全局空间。

如果您出于某种原因更喜欢全球性，我建议您这样做

```
(function() {
    var $me;
    function doo() { $me = $(this); }
})(); 
```

相反，以防止范围`$me`真正全球化。

但是，一个重要的考虑因素是，如果您只`$me`声明了一个，并且调用了另一个也设置了的函数`$me`，那么您将遇到麻烦。

最后，本地化**更有意义**`$me`，因为它只适用于它所在的函数。谁在`$me`函数调用之外？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T22:49:47.520

如果这些是全局函数，则可能根本不需要“me”变量。此构造通常用于对象的成员函数中。当您定义一个将被其他人调用的函数但该函数需要对您的原始对象的引用时，它很有用。例如，这里我们定义了一个将被 setTimeout 调用的匿名函数：

```
{
   foo: function() {
     var me = this;
     setTimeout(function() {
       me.bar();
     }, 1000);
   },
   bar: function() {
   }
} 
```

# jquery - MVC3返回值到模态对话框

> ID：10342457
> 
> 赞同：1
> 
> 时间：2012-04-26T22:45:13.650
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3

我是 MVC3 的新手，想知道是否可以将值返回到模态对话。请参见下面的示例。

在我的 .cshtml 文件中，当单击“日志”按钮时，它会调用日志操作。

```
<button name="button" value="log" id="log">Log</button>
<div id="dialog-message" title="Input Error!">
  <p>
    <span class="ui-icon ui-icon-circle-check" style="float:left; margin:0 7px 50px 0;"></span>
    The result from the controller is :
  </p>
</div> 
```

在我的控制器动作中，我有这个

```
public ActionResult Log(FormCollection collection)
{
    if(x+2!=4)
    {
       // return the value of x to the modal dialog
    }
    else
    {
       // save record to database
    }
} 
```

我希望 jquery 模态对话框显示 x 的值。

在 jquery 脚本中，我有以下内容

```
$("#dialog-message").dialog({
        autoOpen: false,
        modal: true,
        buttons: {
            Ok: function () {
                $(this).dialog("close");
            }
        }
    });

    $("#log").click(function () {
        $("#dialog-message").dialog("open");
        this.defaultShowErrors();
    }); 
```

请帮忙！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:14:03.210

看起来您缺少两件事：1）结果的容器，2）获取结果的 Ajax 调用。首先是容器：

```
The result from the controller is : <span id='result_container'></span> 
```

Ajax 调用：

```
$("#log").click(function() {
    var ajaxUrl = // set the URL for **Log** here
    $.get(ajaxUrl, function(data) {
        $("#result_container").html(data);
    });
    $("#dialog-message").dialog("open");
}); 
```

在控制器中，您只需将结果作为纯文本返回：

```
if(x+2!=4)
{
   // return the value of x to the modal dialog
   return new ContentResult() { 
       Content = x, 
       ContentEncoding = System.Text.Encoding.UTF8, 
       ContentType = "text/plain" 
   };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T23:38:53.527

谢谢大家，看完这篇文章我就搞定了

[http://www.matthidinger.com/archive/2011/02/22/Progressive-enhancement-tutorial-with-ASP-NET-MVC-3-and-jQuery.aspx](http://www.matthidinger.com/archive/2011/02/22/Progressive-enhancement-tutorial-with-ASP-NET-MVC-3-and-jQuery.aspx)

# java - 当我将多个自定义匹配器分配给单个方法时，Mockito 的行为很奇怪

> ID：10342461
> 
> 赞同：6
> 
> 时间：2012-04-26T22:45:23.443
> 
> 标签：java, mocking, mockito, matcher, hamcrest

我想为一个方法使用两个自定义匹配器。基本上，如果我通过方法 VALUE_A，我希望它返回 RESULT_A，如果我通过它 VALUE_B，我希望它返回 RESULT_B。所以这里有一段代码摘录：

```
class IsNonEmpty extends ArgumentMatcher<Get> {
    public boolean matches(Object get) {
        //For some reason, this method is called when I assign the IsEmpty matcher to MockHtable.get()
        //When this happens, the value of the get argument is null, so this method throws an NPE

        return Arrays.equals(((Get) get).getRow(), SERIALIZATION_HELPER.getValidBytes(key)); 
    }
}

class IsEmpty extends ArgumentMatcher<Get> {
    public boolean matches(Object get) {
        return !(Arrays.equals(((Get) get).getRow(), SERIALIZATION_HELPER.getValidBytes(key))); 
    }
}      

[...]

//This line executes just fine
Mockito.when(mockHTable.get(Mockito.argThat(new IsNonEmpty()))).thenReturn(dbResult);

[...]

//This line calls IsNonEmpty.matches() for some reason.  IsNonEmpty.matches() throws an NPE
Mockito.when(mockHTable.get(Mockito.argThat(new IsEmpty()))).thenReturn(emptyResult); 
```

当我将 IsEmpty 自定义匹配器分配给 mockHTable.get() 方法时，它会调用 IsNonEmpty.matches() 函数。不知道为什么要这样做。所以我将 IsNonEmpty 类更改为：

```
class IsNonEmpty extends ArgumentMatcher<Get> {
    public boolean matches(Object get) {
        //For some reason, this method is called when I assign the IsEmpty matcher.  Weird, no?
        if(get == null) {
            return false;
        }

        return Arrays.equals(((Get) get).getRow(), SERIALIZATION_HELPER.getValidBytes(key)); 
    }
} 
```

然后一切正常！当我将 IsEmpty 匹配器分配给 mockHTable.get() 函数时，仍然调用 IsNonEmpty.matches()，但我的匹配器完全按照它们应该的方式工作。

那么有什么关系呢？为什么会这样？我的变通办法是弥补这种古怪行为的充分方法，还是我做错了？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-27T06:06:16.343

`IsNonEmpty.matches()`在存根的第二行调用的原因是`Mockito.argThat(new IsEmpty())`返回 null，然后将其传递给`mockHTable.get()`. 这个调用必须与之前的存根进行检查，看它是否匹配；这意味着调用`IsNonEmpty.matches()`.

我不知道为什么这会让你的测试失败——如果没有看到所有的代码就很难说清楚。

但是，我强烈建议您使用，`doReturn...when`而不是`when...thenReturn`在您必须多次存根同一模拟时使用。如果你这样做，你就不会遇到这样的问题。事实上，尽管大多数人更`doReturn...when`喜欢.`when...thenReturn``doThrow``doAnswer``when...thenReturn`

使用语法重写您的存根行之一，`doReturn...when`如下所示。另一个类似。

```
Mockito.doReturn(dbResult).when(mockHTable).get(Mockito.argThat(new IsNonEmpty())); 
```

最后，代表 Mockito 开发团队（我是其中的一员）提出请求。如果您认为此处的 Mockito 存在错误-根据您的描述，我认为很可能存在错误-请

*   向 Mockito 邮件组发送消息 (mockito@googlegroups.com) 或
*   在 Mockito 问题列表 (http://code.google.com/p/mockito/issues/list) 上提出问题。

如果您实际上可以发布一个完整的示例，而不仅仅是您认为的关键行，这对 Mockito 团队很有用 - 有时 Mockito 问题的原因出乎意料。

# java - Spring：使用工厂 bean 创建任意数量的 bean

> ID：10342463
> 
> 赞同：4
> 
> 时间：2012-04-26T22:45:33.327
> 
> 标签：java, spring

我有一个工厂式 bean，它在启动时创建了许多对象，我希望这些对象本身就是 Spring bean。

如果我正在创建单个对象，我可以使用工厂方法进行实例化，例如。（来自 Spring 文档第 4.3.2.3 节）：

```
<!-- the factory bean, which contains a method called createInstance() -->
<bean id="serviceLocator" class="examples.DefaultServiceLocator">
  <!-- inject any dependencies required by this locator bean -->
</bean>

<!-- the bean to be created via the factory bean -->
<bean id="clientService"
      factory-bean="serviceLocator"
      factory-method="createClientServiceInstance"/> 
```

如果我提前知道我有 n 个对象，我可以调用 n 个不同的方法，但我没有——我的工厂创建了任意数量的事先不知道的对象。

有谁知道如何做到这一点？

目标是让它们像上面那样产生“适当的”Spring bean；具体来说，它们应该有资格作为源和目标进行自动装配。请注意，这意味着我不只是想返回一个 Collection 并让它成为 bean。

我正在使用 XML 配置的 Spring 3.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:14:48.737

好像你需要动态bean创建......

以前从未尝试过，但如[本问题](https://stackoverflow.com/questions/8711560/dynamic-creation-of-beans-in-spring)所述，您可以尝试使用[BeanDefinitionBuilder](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/beans/factory/support/BeanDefinitionBuilder.html)。似乎它有你需要的一切。从您的工厂 bean 中使用它（现在不需要将其定义为工厂 bean）。

[编辑：我在这里](http://www.devdaily.com/java/jwarehouse/spring-framework-2.5.3/test/org/springframework/beans/factory/support/BeanDefinitionBuilderTests.java.shtml)找到了一个很好的用法示例。

就像是：

```
String className = ... // get class name from wherever you get it

// Build your dynamic bean:
BeanDefinitionBuilder bdb = BeanDefinitionBuilder.genericBeanDefinition(className);
bdb.setSingleton(true);
// add dependencies:
bdb.addDependsOn(dependeeBeanName);
// Eventually - validate it and get it:
AbstractBeanDefinitionb bean = db.getBeanDefinition();

// I guess only now you get other already existing beans
// and make them depend on the one you created in the same way 
```

# javascript - 来自 Firefox 扩展的 XMLHttpRequest

> ID：10342464
> 
> 赞同：0
> 
> 时间：2012-04-26T22:45:36.487
> 
> 标签：javascript, firefox-addon, xmlhttprequest

我正在使用 XMLHttpRequest 在服务器和我正在开发的 Firefox 扩展之间交换数据。不幸的是，这些请求似乎与当前打开的页面有某种联系——如果我在当前选项卡关闭时尝试发出请求，它将失败并出现错误。如何使我的请求源自扩展程序本身，而与选项卡中发生的事情无关？

编辑：这是重现此问题的代码。它作为主要扩展主体运行（我的设计基于[http://kb.mozillazine.org/Getting_started_with_extension_development](http://kb.mozillazine.org/Getting_started_with_extension_development)的“Hello world”教程，因此没有附加 SDK）。这意味着它与上述教程中“overlay.js”中的代码在同一位置执行。

```
function createXMLHttpRequest() {
    return Components.classes["@mozilla.org/xmlextras/xmlhttprequest;1"]
       .createInstance(Components.interfaces.nsIXMLHttpRequest);    
}

function issueRequest() {
    var req = createXMLHttpRequest();
    req.open("GET", "http://google.com", true);
    req.addEventListener("load", function(event) {
        alert("SUCCES");
    });
    req.addEventListener("error", function(event) {
        alert("ERROR");
    });
    req.send();
};

window.addEventListener("DOMContentLoaded",  function(event) {
    issueRequest();

    var doc = event.originalTarget;
    var win = doc.defaultView;

    win.addEventListener("unload", function(event) {
        issueRequest();
    });
}); 
```

这会在打开新标签后导致“成功”，在关闭标签后会导致“错误”。我宁愿有两个成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T21:05:45.827

如果该脚本在浏览器窗口覆盖层中运行，那么您将`DOMContentLoaded`处理程序附加到错误的节点 - 您只会在浏览器窗口本身加载时收到通知。因此，您的`unload`处理程序等待浏览器窗口关闭，您可能打算等待选项卡关闭。正确的代码如下所示：

```
// Wait for the browser window to load before doing anything
window.addEventListener("load", function() {
  // Attach a listener to the tabbrowser to get notified about new pages
  window.gBrowser.addEventListener("DOMContentLoaded", function(event) {
    issueRequest();

    var doc = event.originalTarget;
    var win = doc.defaultView;

    win.addEventListener("unload", function(event) {
      issueRequest();
    });
  }, false);
}, false) 
```

# android - 操作系统上的安卓书籍

> ID：10342467
> 
> 赞同：6
> 
> 时间：2012-04-26T22:45:55.067
> 
> 标签：android, operating-system

我知道有很多针对 Android 开发人员的书籍，但我需要一些针对操作系统本身的书籍。所以任何人都可以帮助我，我知道它是基于 Linux 的，但我需要更多的东西。提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T22:52:33.150

根据我最近对该领域的调查，目前没有关于操作系统内部的书籍。在接下来的几个月里应该会发布一对夫妇：

*   来自 O'Reilly 的“嵌入式 Android”被列为 5 月 22 日到期
*   Wiley 的“XDA 的 Android 黑客工具包”将于 6 月 13 日发布

# tomcat - 错误：正在从引导类加载器加载 JAXB 2.1 API，但此 RI 需要 2.2 API

> ID：10342468
> 
> 赞同：1
> 
> 时间：2012-04-26T22:46:03.163
> 
> 标签：tomcat, jaxb, endorsed

我正在尝试将 Java Web 服务部署到 Tomcat 5.5.20 服务器中。我将 Web 服务打包在 Tomcat 的 webapps 目录中的 .war 文件中，我可以看到当我启动 Tomcat 时 .war 文件被提取。

但是，当我启动 Tomcat 时出现以下错误：

```
2012 年 4 月 22 日上午 5:16:31 com.sun.xml.ws.transport.http.servlet.WSServletContextLstener contextInitialized
信息：WSSERVLET12：JAX-WS 上下文侦听器正在初始化
2012 年 4 月 22 日上午 5:16:31 com.sun.xml.ws.transport.http.servlet.WSServletContextLstener parseAdaptersAndCreateDelegate
严重：WSSERVLET11：无法解析运行时描述符：java.lang.LinkageError：正在从引导类加载器加载 JAXB 2.1 API，但是这个 RI（来自 jar:file:/home/username/WebNMS/apache/tomcat/webapps/WebServices /WEB-INF/lib/jaxb-impl.jar!/com/sun/xml/bind/v2/model/impl/ModelBuilder.class) 需要 2.2 API。使用认可的目录机制将 jaxb-api.jar 放置在引导类加载器中。（参见 http://java.sun.com/j2se/1.6.0/docs/guide/standards/）
java.lang.LinkageError: JAXB 2.1 API 正在从引导类加载器加载，但是这个 RI（来自 jar:file:/home/username/WebNMS/apache/tomcat/webapps/WebServices/WEB-INF/lib/jaxb-impl .jar!/com/sun/xml/bind/v2/model/impl/ModelBuilder.class) 需要 2.2 API。使用认可的目录机制将 jaxb-api.jar 放置在引导类加载器中。（参见 http://java.sun.com/j2se/1.6.0/docs/guide/standards/）
在 com.sun.xml.bind.v2.model.impl.ModelBuilder.(ModelBuilder.java:178)

```

/home/username/WebNMS/apache/tomcat/webapps/WebServices/WEB-INF/lib 目录是 JAX-WS 2.2.6 中的所有 jar 文件所在的位置，包括 jaxb-api.jar。

我已经在启动 Tomcat 的 WebNMS 进程的命令中添加了“-Djava.endorsed.dirs=/home/username/WebNMS/apache/tomcat/webapps/WebServices/WEB-INF/lib”，但这没有帮助.

此外，我尝试在 /home/username/WebNMS/jre/lib 目录中添加一个名为“endorsed”的符号链接，该链接指向 /home/username/WebNMS/apache/tomcat/webapps/WebServices/WEB-INF/lib，并且那也没有帮助。

一件有趣的事情是，当我执行“查找 /home/username/WebNMS -name jaxb-api.jar”时，它只会在 /home/username/WebNMS/apache/tomcat/webapps 中找到一个 jaxb-api.jar /WebServices/WEB-INF/lib 目录。没有其他 jaxb-api.jar 文件。所以我不知道为什么错误说正在加载 JAXB 2.1 API，而只有 JAXB 2.2.6 API jar 文件。除非它在 ​​/home/username/WebNMS 目录之外找到了一些东西，但考虑到我尝试了 2 种不同的方法来设置认可的目录，这不应该发生。

# c++ - 在 Gtk+ 中列出向量的内容

> ID：10342469
> 
> 赞同：0
> 
> 时间：2012-04-26T22:46:27.490
> 
> 标签：c++, gtkmm

我正在用 Gtk+ 练习一下。我一直在创建一个带有工作菜单的窗口。我可以创建测试对象（基本上是一个正方形，要求用户输入边长）并将它们存储在一个向量中，但我无法列出它们。

我想要的是显示一个滚动窗口，列出所有存储的对象，例如：

```
_Square 1-side:7_  
_Square 2-side:25_ 
```

到目前为止，我可以显示带有文本标签的滚动窗口，但没有关于存储对象的信息。这是我尝试过的代码：

```
Gtk::Dialog dialog("Listing Squares",false,true);
dialog.set_default_size(500,30);
Gtk::Button close("Close");
close.signal_clicked().connect( sigc::mem_fun(*this,&Window::onFileListButtonClose) );
Gtk::VBox* vbox = dialog.get_vbox();

Gtk::ScrolledWindow sw;
sw.set_policy(Gtk::POLICY_AUTOMATIC,Gtk::POLICY_AUTOMATIC);

/** FETCH FROM ARRAY*/
  for(unsigned int i(0); i<vc.size();++i){
    Gtk::Label label( "Square number " + i );
    sw.add( label );
  }
sw.show_all_children();
vbox->pack_start( sw );
vbox = 0;
dialog.add_action_widget(close,1);
dialog.show_all_children();
dialog.run(); 
```

[编辑：]

1) **vc**是一个 std::vector。它是一个类属性。

2）要求用户输入正方形的长度并将其存储在vc中的一段代码。

```
void Window::onMenuFileNew(void) { 
  Gtk::Dialog dialog("New Square",true,true);
  dialog.set_default_size(70,20);
  dialog.set_has_separator(true);
  Gtk::Button close("Close");

  entry.set_max_length(2);
  entry.set_text("");
  close.signal_clicked().connect( sigc::mem_fun(*this,&Window::onFileNewButtonClose) );
  Gtk::Label lab("Square side length:");
  Gtk::VBox* vbox = dialog.get_vbox();
  vbox->pack_start( lab );
  vbox->pack_start( entry );
  vbox = 0;
  dialog.add_action_widget(close,1);
  dialog.show_all_children();
  dialog.run();
}

void Window::onFileNewButtonClose(void) {
  int side = atoi( (entry.get_text()).c_str() );
  vc.push_back(Cuadrado( side ));
} 
```

任何帮助，将不胜感激。:)

PS：在尝试列出正方形之前，我创建了一些正方形！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T23:40:18.257

根据[文档](http://developer.gnome.org/gtkmm/unstable/classGtk_1_1ScrolledWindow.html#a17c588d56d93923841d38f0d5e2ec9d7)，`add`成员函数通过引用接受小部件。这意味着您在此处传递的对象必须存在于引用它们的容器的整个生命周期中。在`for`循环中，一旦循环进行一次迭代，它们就不再存在，如果您在循环之前创建标签，它们在函数结束时不再存在。您会遇到类似的情况：[返回对本地或临时变量的引用](https://stackoverflow.com/questions/2744264/returning-the-address-of-local-or-temporary-variable)。

现在，这有点在黑暗中拍摄，因为我并不真正了解 Gtk，也不知道小部件是否被复制到其他地方，因此原始可能会被破坏，但它看起来像我上面描述的方式从纯 C++ 的角度来看。

只是为了确保这是罪魁祸首，将所有标签全局定义到您的应用程序并查看它们是否出现。如果他们这样做了，您就会知道您需要`label`在该函数/循环结束后（并且仍然可以适当地销毁）以使它们处于活动状态（例如在堆上）的方式声明 s。

# linux - Process niceness (priority) 设置对 Linux 没有影响

> ID：10342470
> 
> 赞同：7
> 
> 时间：2012-04-26T22:46:39.093
> 
> 标签：linux, kernel, scheduling, nice

我写了一个测试程序，它只包含一个无限循环，里面有一些计算，并且不执行 I/O 操作。我尝试启动程序的两个实例，一个具有高 niceness 值，另一个具有低 niceness 值：

```
sudo nice -n 19 taskset 1 ./test
sudo nice -n -20 taskset 1 ./test 
```

taskset 命令确保两个程序在同一个内核上执行。与我的预期相反，top 报告说这两个程序都获得了大约 50% 的计算时间。这是为什么？nice 命令甚至有效果吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-12-04T11:06:57.103

您看到的行为几乎可以肯定是由于 Linux 2.6.38（2010 年）中添加的自动组功能。大概当您描述运行这两个命令时，它们是在**不同**的终端窗口中运行的。如果您在**同一个**终端窗口中运行它们，那么您应该已经看到 nice 值产生了效果。这个答案的其余部分详细说明了这个故事。

内核提供了一种称为自动分组的功能，以在面对多进程、CPU 密集型工作负载（例如使用大量并行构建进程（即`make(1) -j`标志）构建 Linux 内核）时提高交互式桌面性能。

通过创建新会话时会创建一个新的自动组`setsid(2)`；例如，当一个新的终端窗口启动时，就会发生这种情况。创建的新进程`fork(2)`继承其父级的自动组成员身份。因此，会话中的所有进程都是同一个自动组的成员。

启用自动分组后，自动分组的所有成员都被放置在同一个内核调度程序“任务组”中。Linux 内核调度程序采用一种算法来均衡 CPU 周期在任务组之间的分布。这对于交互式桌面性能的好处可以通过以下示例进行描述。

假设有两个自动组竞争同一个 CPU（即假设一个 CPU 系统或使用`taskset(1)` 将所有进程限制到 SMP 系统上的同一个 CPU）。第一组包含来自内核构建的十个 CPU 绑定进程`make -j10`. 另一个包含一个受 CPU 限制的进程：视频播放器。自动分组的效果是两个组将各自接收一半的 CPU 周期。也就是说，视频播放器将接收 50% 的 CPU 周期，而不是仅 9% 的周期，这可能会导致视频播放质量下降。SMP 系统上的情况更复杂，但总体效果是相同的：调度程序在任务组之间分配 CPU 周期，这样包含大量 CPU 绑定进程的自动组最终不会以牺牲 CPU 周期为代价系统上的其他作业。

**不错的价值和组调度**

在调度非实时进程（例如，在默认`SCHED_OTHER`策略下调度的进程）时，调度器采用称为“组调度”的技术，在该技术下，线程被调度在“任务组”中。任务组是在各种情况下形成的，这里的相关案例是自动分组。

如果启用了自动分组，则（隐式）放置在自动组中的所有线程（即，由 创建的同一会话`setsid(2)`）形成一个任务组。因此，每个新的自动组都是一个单独的任务组。

在组调度下，线程的 nice 值**仅对与同一任务组中的其他线程相关**的调度决策产生影响。就 UNIX 系统上 nice 值的传统语义而言，这会产生一些令人惊讶的后果。特别是，如果启用了自动分组（这是各种 Linux 发行版中的默认设置），则`nice(1)`在进程上使用仅对相对于在同一会话中执行的其他进程（通常：同一终端窗口）中执行的其他进程的调度有影响。

相反，对于（例如）不同会话中唯一受 CPU 限制的进程的两个进程（例如，不同的终端窗口，其每个作业都绑定到不同的自动组），修改其中一个会话中进程的 nice 值对于调度程序相对于另一个会话中的进程的决策没有影响。这大概是您看到的场景，尽管您没有明确提到使用两个终端窗口。

如果您想防止自动分组干扰`nice`此处描述的传统行为，您可以禁用该功能

```
echo 0 > /proc/sys/kernel/sched_autogroup_enabled 
```

请注意，这也会导致禁用自动分组功能旨在提供的桌面交互性优势（见上文）。

**自动分组不错的价值**

可以通过文件查看进程的自动组成员身份`/proc/[pid]/autogroup`：

```
$ cat /proc/1/autogroup
/autogroup-1 nice 0 
```

此文件还可用于修改分配给自动组的 CPU 带宽。这是通过将“nice”范围内的数字写入文件来设置自动组的 nice 值来完成的。允许的范围是从 +19（低优先级）到 -20（高优先级）。

autogroup nice 设置与 process nice 值具有相同的含义，但适用于将 CPU 周期分配给整个 autogroup，基于其他 autogroup 的相对 nice 值。对于自动组内的进程，它接收的 CPU 周期将是自动组的 nice 值（与其他自动组相比）和进程的 nice 值（与同一自动组中的其他进程相比）的乘积。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T23:51:24.023

我整理了一个 test.c ，它只是：

```
for(;;)
   {
   } 
```

然后用你的nice运行它。我没有为每个人运行不同的 sudo，而是 sudo 了一个交互式 shell 并从那里运行它们。我用了两个&。

我得到一个 ./test 重击我的 CPU，而一个几乎没有碰到它。

自然，系统仍然感觉反应灵敏。在现代处理器上需要大量占用 CPU 的进程才能获得如此多的负载，您可以“感觉到”它。

这与 I/O 占用进程和内存占用进程形成鲜明对比。在这些情况下，单个贪婪进程可能会使系统难以使用。

我猜您的系统有一个相对独特的与优先级相关的错误（或微妙之处），或者您的方法有问题。

我在 Ubuntu 11.04 系统上进行了测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-05T09:56:45.647

**Process niceness (priority) 设置对 Linux 有影响！** *（在实践中，但前提是你给它足够的工作去做！）*

在我的系统上，只要所有内核都满载，nice*确实*会产生影响。在 ubuntu 14.04 上，使用 nice -N 运行的进程与在不改变 nice 值的情况下运行的进程相比，运行了 0.807 ** N 次操作（假设您为每个 nice 级别运行每个核心一个实例）。

在我的情况下，我有关闭超线程的四核 i7，所以如果我运行四个或更少的进程，那么它们的好值是什么并不重要——它们每个都有一个完整的核心。如果我在 nice 级别 0 和 4 在 nice 级别 12 运行四个进程，那么级别 12 的进程通过 0.807 ^ 12，即大约 7% 的工作在 nice 级别 0 中。该比率似乎是从 nice 级别 0 到 14 的合理预测指标，之后它会波动（例如，几次运行的 nice 级别 18 处理超过 nice 16） - 运行更长时间的测试可能会使结果变得平滑。

（使用红宝石 2.1.2）

,cl 文件：

```
uptime
nices='-0 -6 -12 -18'
nices='-0 -18'
nices='-0 -2 -4 -6 -8 -10 -12 -14 -16 -18'
rm -f ,n-*
for i in 1 2 3 4
do
  for n in $nices
  do
    nice $n ruby ,count_loops.rb > ,n${n}-$i &
  done
done
ps -l
uptime
wait
uptime
ps -l
c=`cat ,n-0-[1234] | total`
last=$c
for n in $nices
do
  echo
  c2=`cat ,n${n}-[1234] | total`
  echo total of `cat ,n${n}-[1234]` is $c2
  echo -n "nice $n count $2, percentage: "
  echo "3 k $c2 100 * $c / p" | dc
  echo -n "                  percent of last: "
  echo "3 k $c2 100 * $last / p" | dc
  last=$c2
done
uptime
echo total count: `cat ,n-*-[1234] | total` 
```

,count_loops.rb 文件

```
#!/usr/bin/env  ruby
limit = Time.new + 70
i=0
while Time.new < limit
 i += 1
 j = 0
 while (j += 1) < 10000
   t = j
 end
end
puts i 
```

结果`sh ,cl`- 初始诊断输出：

```
 19:16:25 up 20:55,  2 users,  load average: 3.58, 3.59, 2.88
F S   UID   PID  PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD
0 S  1000  4987  4977  0  80   0 -  7297 wait   pts/3    00:00:00 bash
0 S  1000 11743  2936  0  80   0 -  2515 wait   pts/3    00:00:00 rubymine.sh
0 S  1000 11808 11743  6  80   0 - 834604 futex_ pts/3   00:18:10 java
0 S  1000 11846 11808  0  80   0 -  4061 poll_s pts/3    00:00:02 fsnotifier64
0 S  1000 19613  4987  0  80   0 -  2515 wait   pts/3    00:00:00 sh
0 R  1000 19616 19613  0  80   0 -  7582 -      pts/3    00:00:00 ruby
0 R  1000 19617 19613  0  82   2 -  7582 -      pts/3    00:00:00 ruby
0 R  1000 19618 19613  0  84   4 -  7582 -      pts/3    00:00:00 ruby
0 R  1000 19619 19613  0  86   6 -  7416 -      pts/3    00:00:00 ruby
0 R  1000 19620 19613  0  88   8 -  6795 -      pts/3    00:00:00 ruby
0 R  1000 19621 19613  0  90  10 -  6247 -      pts/3    00:00:00 ruby
0 R  1000 19622 19613  0  92  12 -  6247 -      pts/3    00:00:00 ruby
0 R  1000 19623 19613  0  94  14 -  6247 -      pts/3    00:00:00 ruby
0 R  1000 19624 19613  0  96  16 -  6078 -      pts/3    00:00:00 ruby
0 R  1000 19625 19613  0  98  18 -  6012 -      pts/3    00:00:00 ruby
0 R  1000 19626 19613  0  80   0 -  7582 -      pts/3    00:00:00 ruby
0 R  1000 19627 19613  0  82   2 -  7582 -      pts/3    00:00:00 ruby
0 R  1000 19628 19613  0  84   4 -  7582 -      pts/3    00:00:00 ruby
0 R  1000 19629 19613  0  86   6 -  7582 -      pts/3    00:00:00 ruby
0 R  1000 19630 19613  0  88   8 -  6247 -      pts/3    00:00:00 ruby
0 R  1000 19631 19613  0  90  10 -  6247 -      pts/3    00:00:00 ruby
0 R  1000 19632 19613  0  92  12 -  6247 -      pts/3    00:00:00 ruby
0 R  1000 19633 19613  0  94  14 -  6144 -      pts/3    00:00:00 ruby
0 R  1000 19634 19613  0  96  16 -  4971 -      pts/3    00:00:00 ruby
0 R  1000 19635 19613  0  98  18 -  4971 -      pts/3    00:00:00 ruby
0 R  1000 19636 19613  0  80   0 -  7582 -      pts/3    00:00:00 ruby
0 R  1000 19637 19613  0  82   2 -  7449 -      pts/3    00:00:00 ruby
0 R  1000 19638 19613  0  84   4 -  7344 -      pts/3    00:00:00 ruby
0 R  1000 19639 19613  0  86   6 -  7582 -      pts/3    00:00:00 ruby
0 R  1000 19640 19613  0  88   8 -  7416 -      pts/3    00:00:00 ruby
0 R  1000 19641 19613  0  90  10 -  6210 -      pts/3    00:00:00 ruby
0 R  1000 19642 19613  0  92  12 -  6247 -      pts/3    00:00:00 ruby
0 R  1000 19643 19613  0  94  14 -  5976 -      pts/3    00:00:00 ruby
0 R  1000 19644 19613  0  96  16 -  6111 -      pts/3    00:00:00 ruby
0 R  1000 19645 19613  0  98  18 -  4971 -      pts/3    00:00:00 ruby
0 R  1000 19646 19613  0  80   0 -  7582 -      pts/3    00:00:00 ruby
0 R  1000 19647 19613  0  82   2 -  7516 -      pts/3    00:00:00 ruby
0 R  1000 19648 19613  0  84   4 -  7416 -      pts/3    00:00:00 ruby
0 R  1000 19649 19613  0  86   6 -  6247 -      pts/3    00:00:00 ruby
0 R  1000 19650 19613  0  88   8 -  6177 -      pts/3    00:00:00 ruby
0 R  1000 19651 19613  0  90  10 -  6247 -      pts/3    00:00:00 ruby
0 R  1000 19652 19613  0  92  12 -  6078 -      pts/3    00:00:00 ruby
0 R  1000 19653 19613  0  94  14 -  6247 -      pts/3    00:00:00 ruby
0 R  1000 19654 19613  0  96  16 -  4971 -      pts/3    00:00:00 ruby
0 R  1000 19655 19613  0  98  18 -  4971 -      pts/3    00:00:00 ruby
0 R  1000 19656 19613  0  80   0 -  3908 -      pts/3    00:00:00 ps
 19:16:26 up 20:55,  2 users,  load average: 3.58, 3.59, 2.88
 19:17:37 up 20:56,  3 users,  load average: 28.92, 11.25, 5.59
F S   UID   PID  PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD
0 S  1000  4987  4977  0  80   0 -  7297 wait   pts/3    00:00:00 bash
0 S  1000 11743  2936  0  80   0 -  2515 wait   pts/3    00:00:00 rubymine.sh
0 S  1000 11808 11743  6  80   0 - 834604 futex_ pts/3   00:18:10 java
0 S  1000 11846 11808  0  80   0 -  4061 poll_s pts/3    00:00:02 fsnotifier64
0 S  1000 19613  4987  0  80   0 -  2515 wait   pts/3    00:00:00 sh
0 R  1000 19794 19613  0  80   0 -  3908 -      pts/3    00:00:00 ps 
```

结果`sh ,cl`- 统计：（最后的百分比是此总数与最后一组进程的计数相比的百分比）

```
total of 99951 101725 100681 104046 is 406403
nice -0 count , percentage: 100.000
                  percent of last: 100.000

total of 64554 62971 64006 63462 is 254993
nice -2 count , percentage: 62.743
                  percent of last: 62.743

total of 42997 43041 43197 42717 is 171952
nice -4 count , percentage: 42.310
                  percent of last: 67.434

total of 26882 28250 27151 27244 is 109527
nice -6 count , percentage: 26.950
                  percent of last: 63.696

total of 17228 17189 17427 17769 is 69613
nice -8 count , percentage: 17.129
                  percent of last: 63.557

total of 10815 10792 11021 11307 is 43935
nice -10 count , percentage: 10.810
                  percent of last: 63.113

total of 7023 6923 7885 7323 is 29154
nice -12 count , percentage: 7.173
                  percent of last: 66.357

total of 5005 4881 4938 5159 is 19983
nice -14 count , percentage: 4.917
                  percent of last: 68.542

total of 3517 5537 3555 4092 is 16701
nice -16 count , percentage: 4.109
                  percent of last: 83.576

total of 4372 4307 5552 4527 is 18758
nice -18 count , percentage: 4.615
                  percent of last: 112.316
 19:17:37 up 20:56,  3 users,  load average: 28.92, 11.25, 5.59
total count: 1141019 
```

（纯粹主义者会注意到我正在混合 ruby​​、shell 和 dc - 他们将不得不原谅我上个世纪的旧习惯；））

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T23:03:46.867

我假设`&`命令行末尾缺少一个。否则，在第一行完成之前，第二行不会运行。

当两个进程都在运行时，使用类似的东西`top`并确保它们每个都具有您分配的不错的值。

如果您仅使用启动进程`taskset`，然后`renice`在它们运行后调整它们的优先级，会发生什么情况？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-19T14:41:12.767

*我从APUE*运行了一个示例程序并且`nice`确实有效果。

示例程序主要是`fork`一个孩子，父母和孩子都在`i++`给定的时间（10s）内执行递增操作。通过给孩子不同的`nice`价值，结果表明是否`nice`有所作为。

这本书警告说我应该在单处理器 PC 上运行该程序，首先我尝试使用自己的 PC `i5-7500 CPU @ 3.40GHz × 4`（4 核），给出不同的`nice`值，几乎没有区别。

然后我登录到我的远程服务器`1 processor 1 GB`，并获得预期的差异。

* * *

`1 core processor 1 GB`测试结果：

`./a.out`

```
NZERO = 20 
current nice value in parent is 0
current nice value in child is 0, adjusting by 0
now child nice value is 0
parent count = 13347219
child count = 13357561 
```

`./a.out 20 //child nice set to 20`

```
NZERO = 20
current nice value in parent is 0
current nice value in child is 0, adjusting by 20
now child nice value is 19
parent count = 29770491
ubuntu@VM-0-2-ubuntu:~$ child count = 441330 
```

* * *

测试程序（我做了一点修改），来自第 8.16 节，*APUE*：

`apue.h`只是一个标头包装器
`err_sys()`也是一个错误处理程序包装器，您可以`printf`临时使用。

```
#include "apue.h"
#include <errno.h>
#include <sys/time.h>

#if defined(MACOS)
#include <sys/syslimits.h>
#elif defined(SOLARIS)
#include <limits.h>
#elif defined(BSD)
#include <sys/param.h>
#endif

unsigned long long count;
struct timeval end;

void
checktime(char *str)
{
    struct timeval  tv;

    gettimeofday(&tv, NULL);
    if (tv.tv_sec >= end.tv_sec && tv.tv_usec >= end.tv_usec) {
        printf("%s count = %lld\n", str, count);
        exit(0);
    }
}

int
main(int argc, char *argv[])
{
    pid_t   pid;
    char    *s;
    int     nzero, ret;
    int     adj = 0;

    setbuf(stdout, NULL);
#if defined(NZERO)
    nzero = NZERO;
#elif defined(_SC_NZERO)
    nzero = sysconf(_SC_NZERO);
#else
#error NZERO undefined
#endif
    printf("NZERO = %d\n", nzero);
    if (argc == 2)
        adj = strtol(argv[1], NULL, 10);
    gettimeofday(&end, NULL);
    end.tv_sec += 10;   /* run for 10 seconds */

    if ((pid = fork()) < 0) {
        err_sys("fork failed");
    } else if (pid == 0) {  /* child */
        s = "child";
        printf("current nice value in child is %d, adjusting by %d\n",
          nice(0), adj);
        errno = 0;
        if ((ret = nice(adj)) == -1 && errno != 0)
            err_sys("child set scheduling priority");
        printf("now child nice value is %d\n", ret);
    } else {        /* parent */
        s = "parent";
        printf("current nice value in parent is %d\n", nice(0));
    }
    for(;;) {
        if (++count == 0)
            err_quit("%s counter wrap", s);
        checktime(s);
    }
} 
```

完整源代码链接：[https ://wandbox.org/permlink/8iryAZ48sIbaq27y](https://wandbox.org/permlink/8iryAZ48sIbaq27y)

# c# - 嵌套“使用”语句的正确格式？

> ID：10342479
> 
> 赞同：4
> 
> 时间：2012-04-26T22:47:21.727
> 
> 标签：c#, ado.net

我有以下一组代码：

```
using (OracleConnection conn = new OracleConnection(m_fceConn))
{
    conn.Open();

    using (OracleCommand cmd = new OracleCommand(m_sql, conn))
    {
        using (OracleDataReader reader = cmd.ExecuteReader())
        {
            reader.Read();
        }
    }

    conn.Close();
} 
```

有没有更好的方法来格式化它？当然，稍后我可能会打破打开连接，运行查询，并在以后将连接关闭到单独的函数中，但是可以说这种嵌套仍然存在于“幕后”。

我在另一个线程上读到，我可以像这样格式化：

```
using (OracleConnection conn = new OracleConnection(m_fceConn))
using (OracleCommand cmd = new OracleCommand(m_sql, conn)) 
```

但是考虑到我在这些语句之间都有代码，我不相信我可以像这样省略括号。我只是在这里寻找最佳/最安全的做法，因为我仍然是 C# 的新手/菜鸟。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T22:58:10.033

我可能是错的，但我认为您不需要在将连接传递给 OracleCommand 之前打开连接。您只需在执行命令之前打开它。所以你可以把上面写成：

```
using (OracleConnection conn = new OracleConnection(m_fceConn)) 
using (OracleCommand cmd = new OracleCommand(m_sql, conn))
{ 
    conn.Open(); 
    using (OracleDataReader reader = cmd.ExecuteReader()) 
    { 
        reader.Read(); 
    } 
} 
```

（您也不需要显式关闭，因为处理连接应该自动关闭它）。

上面的代码没有什么特别之处（除了看起来不错），它只是使用了普通的 C# 规则，将单个命令应用于这些块。与此相同：

```
if (...)
if (...)
   dosomething(); // Look Ma, no curly braces 
```

只是您正在“堆叠”多个单个语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T22:51:07.363

您所拥有的格式正确，尽管没有必要调用`conn.Close()`，因为连接将在`using`声明它的块的末尾被释放（并因此关闭）。

但是，您可以省略第二个语句的括号，因为该语句的整体只是另一个`using`块。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T22:51:19.623

你的第一个 using 语句需要有括号，因为你在`conn.Open()`那里有调用。如您所说，第二个和第三个可以堆叠，这是非常惯用的 C#（在我的情况下是首选）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T22:52:15.367

```
using (OracleConnection conn = new OracleConnection(m_fceConn))
{
    conn.Open();

    using (OracleDataReader reader = new OracleCommand(m_sql, conn).ExecuteReader())
    {
        reader.Read();
    }

    conn.Close();
} 
```

**编辑再三** 考虑，不要这样做。它不会处理命令对象。我将把答案留在这里作为不应该做的一个例子。

# database - 每个用户的 WordPress 插件数据库

> ID：10342481
> 
> 赞同：0
> 
> 时间：2012-04-26T22:47:29.770
> 
> 标签：database, wordpress

我正在尝试开发商店定位器脚本。然而，WordPress 可能存在，安装后，无论谁登录 WordPress，每个用户都在该地址数据库中添加/删除条目。

我想拥有它，以便每个用户都属于一个组/公司。当他们登录 WordPress 时，他们只能在数据库中看到他们的条目。

实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:22:03.147

将商店实现为[自定义帖子类型](http://codex.wordpress.org/Post_Types#Custom_Types)，并且不为您的普通用户提供该功能[`edit_others_posts`](http://codex.wordpress.org/Roles_and_Capabilities#edit_others_posts)。

然后 WordPress 将不会显示来自其他用户的商店，您无需执行任何其他操作。

# php - 安装 AjaXplorer 时出错

> ID：10342483
> 
> 赞同：8
> 
> 时间：2012-04-26T22:47:49.440
> 
> 标签：php, exception, installation, pydio

我正在尝试安装 AjaXplorer，但遇到了问题。第一次运行测试要求我将语言环境设置为，`UTF-8`但我不确定如何执行此操作。

如果我跳过警告，我会收到以下错误，并想知道它是否与此有关。

> 异常处理程序中抛出的异常！消息是：在 C:\UniServer\www\domain\secure\core\classes\class.ConfService.php 第 164 行 #0 C:\UniServer\www\domain\secure\core\classes 中找不到类型登录的插件文本\class.ConfService.php(184): ConfService->initUniquePluginImplInst('LOG_DRIVER', 'log') #1 C:\UniServer\www\domain\secure\core\classes\class.ConfService.php(229): ConfService ->getUniquePluginImplInst('LOG_DRIVER', 'log') #2 C:\UniServer\www\domain\secure\core\classes\class.AJXP_Logger.php(89): ConfService::getLogDriverImpl() #3 C:\UniServer \www\domain\secure\core\classes\class.AJXP_Logger.php(69): AJXP_Logger::getInstance() #4 C:\UniServer\www\domain\secure\core\classes\class.AJXP_XMLWriter.php(195 ): AJXP_Logger::logAction('error', Array) #5 C:

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T09:44:01.650

它可能是由 PHP >= 5.4 引起的

在 PHP 更新之前我没有错误。

编辑：降级到 PHP 5.3 固定错误，所以它是由 PHP 5.4 引起的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T14:21:02.143

刚刚遇到了同样的问题：由“数据”目录中文件夹的写权限引起。

设置顶级目录“data”和所有子目录的写权限。我以为我已经用 Filezilla 设置了权限，但经过快速检查，我没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T21:04:54.820

关于“设置语言环境”通知，您可以在 PHP 文档中找到详细的解释和一些示例：http: [//php.net/manual/en/function.setlocale.php](http://php.net/manual/en/function.setlocale.php)。

至于 AjaXplorer 异常，其[文档](http://ajaxplorer.info/documentation/administration/4-step-install/)指出：

> 您可以通过 FTP 访问运行 PHP (>5.1) 并可通过 Web 访问的远程服务器

我用谷歌搜索了这个异常，大多数时候它是由于错误的 PHP 版本而引发的。您可以使用 PHP 函数轻松检查您的 PHP 版本`phpversion()`：

```
echo phpversion(); 
```

如果您的 PHP 版本不符合 AjaXplorer 的要求，您显然必须升级 PHP 或放弃 AjaXplorer 以支持其他解决方案。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-01T07:17:06.543

只需更改权限 `chmod -R 777 /etc/zpanel/panel` 和日志 `tail /etc/httpd/logs/error_log`

# powershell - 使用 Powershell 在没有 WMI 或远程处理的情况下远程停止服务

> ID：10342486
> 
> 赞同：26
> 
> 时间：2012-04-26T22:48:50.297
> 
> 标签：powershell

我遇到了一个似乎有效的班轮：

```
stop-service -inputobject $(get-service -ComputerName remotePC -Name Spooler) 
```

谁能解释为什么，因为我认为 stop-service 不起作用，除非您使用远程处理或它发生在本地主机上。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-26T23:56:20.343

的输出`Get-Service`是一个`System.ServiceProcess.ServiceController`可以在远程计算机上运行的 .NET 类。我不知道它是如何做到这一点的——可能是 DCOM 或 WMI。一旦您从 中获得其中之一`Get-Service`，就可以将其传递给`Stop-Service`最有可能仅调用`Stop()`此对象上的方法的地方。这会停止远程机器上的服务。事实上，你也可以这样做：

```
(get-service -ComputerName remotePC -Name Spooler).Stop() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-09T05:42:07.380

感谢大家对这个问题的贡献，我想出了以下脚本。更改值`$SvcName`并`$SvrName`满足您的需要。如果远程服务停止，此脚本将启动它，如果它启动则停止它。它使用cool`.WaitForStatus`方法等待服务响应。

```
#Change this values to suit your needs:
$SvcName = 'Spooler'
$SvrName = 'remotePC'

#Initialize variables:
[string]$WaitForIt = ""
[string]$Verb = ""
[string]$Result = "FAILED"
$svc = (get-service -computername $SvrName -name $SvcName)
Write-host "$SvcName on $SvrName is $($svc.status)"
Switch ($svc.status) {
    'Stopped' {
        Write-host "Starting $SvcName..."
        $Verb = "start"
        $WaitForIt = 'Running'
        $svc.Start()}
    'Running' {
        Write-host "Stopping $SvcName..."
        $Verb = "stop"
        $WaitForIt = 'Stopped'
        $svc.Stop()}
    Default {
        Write-host "$SvcName is $($svc.status).  Taking no action."}
}
if ($WaitForIt -ne "") {
    Try {  # For some reason, we cannot use -ErrorAction after the next statement:
        $svc.WaitForStatus($WaitForIt,'00:02:00')
    } Catch {
        Write-host "After waiting for 2 minutes, $SvcName failed to $Verb."
    }
    $svc = (get-service -computername $SvrName -name $SvcName)
    if ($svc.status -eq $WaitForIt) {$Result = 'SUCCESS'}
    Write-host "$Result`: $SvcName on $SvrName is $($svc.status)"
} 
```

当然，您运行它的帐户需要适当的权限才能访问远程计算机以及启动和停止服务。在对旧的远程机器执行此操作时，您可能首先必须在旧机器上安装 WinRM 3.0。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-04T15:34:13.523

基于内置的 Powershell 示例，这是 Microsoft 的建议。测试和验证：

停止：

```
(Get-WmiObject Win32_Service -filter "name='IPEventWatcher'" -ComputerName Server01).StopService() 
```

开始：

```
(Get-WmiObject Win32_Service -filter "name='IPEventWatcher'" -ComputerName Server01).StartService() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-11T11:47:03.887

这对我有用，但我用它作为开始。powershell 输出，等待服务完成启动几次然后完成，然后远程服务器上的 get-service 显示服务已启动。

```
**start**-service -inputobject $(get-service -ComputerName remotePC -Name Spooler) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-06T13:52:40.230

另外一个选项; 使用`invoke-command`：

```
cls
$cred = Get-Credential
$server = 'MyRemoteComputer'
$service = 'My Service Name' 

invoke-command -Credential $cred -ComputerName $server -ScriptBlock {
    param(
       [Parameter(Mandatory=$True,Position=0)]
       [string]$service
    )
    stop-service $service 
} -ArgumentList $service 
```

注意：要使用此选项，您需要在远程计算机上安装 PowerShell，并让防火墙允许请求通过，并让 Windows 远程管理服务在目标计算机上运行。您可以通过直接在目标机器上运行以下脚本来配置防火墙（一次性任务）`Enable-PSRemoting -force`：.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-13T01:38:09.673

你也可以做`(Get-Service -Name "what ever" - ComputerName RemoteHost).Status = "Stopped"`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-15T11:51:05.003

您可以只运行一个 foreach 并启用日志记录。如果出现问题，控制台将显示，您可以查看日志。

这样，您就可以单独处理错误。

我认为这种方式比为验证部分运行测试网络连接更好，因为防火墙规则可以创建值 false。

对于此示例，您需要一个 csv 文件，其中包含列 ServerName，使用 servername.contoso.com 填充列

```
$ServerList = "$PSScriptRoot\Serverlist.csv"

$Transcriptlog = "$PSScriptRoot\Transcipt.txt"

    Start-Transcript -Path $Transcriptlog -Force
    Get-Date -Format "yyyy/MM/dd HH:mm" 

    Try 
     { # Start Try  
       $ImportServerList = Import-Csv $ServerList -Encoding UTF8 | ForEach-Object { # Start Foreach 
        New-Object PsObject -Prop @{ # Start New-Object 
         ServerName = $_.ServerName } # End NewObject 
          Invoke-Command -ComputerName $_.ServerName -ErrorAction Continue -ScriptBlock  { # Start ScriptBlock  
           # Disable Service PrintSpooler
           Get-Service -Name Spooler | Stop-Service -Force 

       } # End ScriptBlock
      } # End Foreach       
     } # End Try

    Catch
     { # Start Catch 
      Write-Warning -Message "## ERROR## " 
      Write-Warning -Message "## Script could not start ## " 
      Write-Warning $Error[0]
     } # End Catch

    Stop-Transcript 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-05-23T16:34:49.423

`stop-service -inputobject $(get-service -ComputerName remotePC -Name Spooler)`

这失败了，因为您的变量 `-ComputerName remotePC`需要是变量`$remotePC`或字符串`"remotePC" -Name Spooler`（假脱机程序也是如此）

* * *

## 回答 #9

> 赞同：-6
> 
> 时间：2012-04-27T11:22:16.113

据我所知，我现在无法验证，您无法使用 Stop-Service cmdlet 或 .Net 停止远程服务，它不受支持。

是的，它可以工作，但它会停止本地计算机上的服务，而不是远程计算机上的服务。

现在，如果上述情况正确，则无需启用远程处理或 wmi，您可以使用 AT 在远程系统上设置计划作业，该作业在本地运行 Stop-Service。

# encryption - 在服务器上加密 在客户端上解密

> ID：10342490
> 
> 赞同：1
> 
> 时间：2012-04-26T22:49:17.097
> 
> 标签：encryption

我正在构建一个简单的琐事游戏，其中包含“刽子手”风格的线索（当玩家要求提示时会显示字母）。我不想用任何有足够聪明的用户都可以弄清楚的问题直接发送答案）-而是我想在服务器上加密答案并在客户端解密它们。安全性并不是很重要，我只是想让这个过程变得更难，然后它对玩家来说是值得的。我想知道是否有人可以推荐这样做的策略？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:44:22.590

一种对大多数用户来说可能很难的简单方法是将答案和加密密钥发送到 Web 客户端（作为隐藏的表单字段），然后使用 Javascript 即时解密（在浏览器内）。答案字符串字符与密钥字符串的简单异或应该足以“掩盖”答案，而无需在客户端进行大量加密处理。使用多个密钥串也可能会增加破解它的难度。

我假设您不想在客户端实现完整的商业级加密，并且还假设您最多只想隐藏答案几分钟。

# php - 创建新用户或更新（如果已存在）

> ID：10342492
> 
> 赞同：-1
> 
> 时间：2012-04-26T22:49:23.293
> 
> 标签：php, apache-flex

我正在使用 Adob​​e Flex 通过 PHP 成功地将用户提交到我的数据库中。现在我需要修改我的 PHP 以首先查看用户是否在数据库中，如果是，则更新一些字段，但如果它们是新的，那么我们需要完全创建用户。我已经评论了肯定已经用于创建不存在的用户的代码部分。我不确定我要去哪里错了。我已经删除了关于连接到数据库的部分；效果很好。

```
public function createUser (User $item)
{
    //Checking to see if user exists
    $checkdb = mysqli_prepare($this->connection, "SELECT firstname FROM users WHERE id =?");
    mysqli_stmt_bind_param($checkdb, "s", $item->id);
    mysqli_stmt_execute($checkdb);
    mysqli_stmt_fetch($checkdb);

    if ($checkdb == 0)
    {
      // If user exists, create record. This code definitely works.
      $stmt = mysqli_prepare($this->connection,
        "INSERT INTO users (
         id,firstname,lastname,gender,dob,latitude,longitude,datesubmitted)
         VALUES (?,?,?,?,?,?,?,?)");
      $this->throwExceptionOnError();

      mysqli_bind_param($stmt, 'sssssdds', $item->id, $item->firstname,
        $item->lastname, $item->gender, $item->dob, $item->latitude,
        $item->longitude, $item->datesubmitted);
      $this->throwExceptionOnError();

      mysqli_stmt_execute($stmt);
      $this->throwExceptionOnError();

      mysqli_stmt_free_result($stmt);
      mysqli_close($this->connection);
    }

    //If user does exist, then update record
    $stmt = mysqli_prepare($this->connection,
      "UPDATE users SET latitude=?,longitude=?,datesubmitted=? WHERE id=?");
    $this->throwExceptionOnError();

    mysqli_bind_param($stmt, 'dds', $item->latitude,
      $item->longitude, $item->datesubmitted);
    $this->throwExceptionOnError();

    mysqli_stmt_execute($stmt);
    $this->throwExceptionOnError();

    mysqli_stmt_free_result($stmt);
    mysqli_close($this->connection);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:12:15.447

您的意思是在一个`else`块中包含更新用户帐户的代码吗？

```
public function createUser (User $item)
{
    ...     

    if ($checkdb == 0)
    {
      // If user exists, create record. This code definitely works.
      $stmt = mysqli_prepare($this->connection,
        "INSERT INTO users (
         id,firstname,lastname,gender,dob,latitude,longitude,datesubmitted)
         VALUES (?,?,?,?,?,?,?,?)");
      ...
    }
    else
    {
      //If user does exist, then update record
      $stmt = mysqli_prepare($this->connection,
        "UPDATE users SET latitude=?,longitude=?,datesubmitted=? WHERE id=?");
      ...
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:12:53.047

您有很多不需要的代码可以删除。还可以考虑通过数据库不会自动生成的唯一值进行搜索，例如用户的电子邮件地址。

另外，不要担心关闭数据库连接。它会让事情变得简单得多。

我建议您查看一个 PHP 框架来帮助您入门。查看[Zend Framework](http://framework.zend.com/)和[CodeIgniter](http://codeigniter.com/)（最小的学习曲线，但没有那么强大）。

这应该让你开始使用你的代码......

```
<?php
class UserService {
  public $username = "*****";
  public $password = "*****";
  public $server = "localhost";
  public $port = "3306";
  public $databasename = "******";
  public $tablename = "users";
  public $connection;

  public function __construct () {
    $this->connection = mysqli_connect($this->server, $this->username, $this->password, $this   ->databasename, $this->port);

    $this->throwExceptionOnError($this->connection);
  }

  public function createUser($user) {
    $email = mysqli_real_escape_string($user->email);

    //Check to see if the user exists - we need this to be as precise as possible. People     often have the same name. But they won't have the same email.
    $sql = "SELECT * FROM users WHERE email = '{$email}'";
    $res = mysqli_query($sql);
    $cnt = mysqli_num_rows($res);

    if ($cnt > 0) {
      //Update the user or do whatever you need to do
    }
    else {
      //Create the user
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T23:23:15.093

我不知道mysqli是否支持这一点，但值得看看这里记录的“INSERT ... ON DUPLICATE KEY UPDATE”语法：http: [//dev.mysql.com/doc/refman/5.0/en/insert -on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

它可以让您让数据库为您执行“它们是否已经存在”检查（使用电子邮件地址或某些等效字段作为主键，如其他答案中所建议的那样）。

# javascript - 使用 Javascript 变量设置 Webkit 关键帧值

> ID：10342494
> 
> 赞同：40
> 
> 时间：2012-04-26T22:49:30.400
> 
> 标签：javascript, css, variables, webkit, keyframe

我有一段 JS 代码来生成随机数并将它们作为变量输出，以代替旋转值

```
@-webkit-keyframes rotate {
    0% {-webkit-transform: rotate(-10deg);}
    100% {-webkit-transform: rotate(10deg);}
}

#dog{
/*irrelevant settings*/
-webkit-animation: rotate 5s infinite alternate ease-in-out;
} 
```

上面的代码可以正常工作，但是当我尝试将 javascript 中的变量粘贴到其中时，`rotate(variable);`我无法让它工作。我是新手，所以我 90% 确定我只是没有为变量找到正确的语法（说真的，我很难记住是否需要括号、引号、squigglys 等，我已经尝试了所有我能想到的） .

或者可能是因为该变量是函数的本地变量，而 CSS 无法读取它。

所以基本上我只需要一些陌生人告诉我正确的语法以及如果可能的话如何让 CSS 读取变量。

否则，看起来我需要该函数来创建全部：

```
@-webkit-keyframes rotate {
    0% {-webkit-transform: rotate(-10deg);}
    100% {-webkit-transform: rotate(10deg);}
} 
```

...这可能有点混乱，因为随机变量可能会应用于多个 css 元素。

哦，目前该变量已格式化为包含`deg`数字之后的数字，因此这不是问题。事实上，为了方便起见，假设我使用的是 var dogValue = "20deg"; 并忘记随机元素。

谢谢。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-04-27T04:09:49.933

好吧，不是你的实际代码的样子，但你不能把 JavaScript 变量扔到 CSS 中，它不会识别它们。

相反，您需要通过 JavaScript 创建 CSS 规则并将它们插入到 CSSOM（CSS 对象模型）中。这可以通过几种方式完成——您可以只创建一个关键帧动画并将其添加，也可以覆盖现有动画。为了这个问题，我将假设您想要不断地用不同的旋转值覆盖现有的关键帧动画。

我已经整理（并记录了）一个 JSFiddle 供您查看：http: [//jsfiddle.net/russelluresti/RHhBz/2/](http://jsfiddle.net/russelluresti/RHhBz/2/)

它开始运行 -10 -> 10 度旋转动画，但随后您可以单击按钮让它在随机值（-360 和 360 度之间）之间执行旋转。

这个例子主要来自 Simon Hausmann 早期的实验。您可以在此处查看源代码：http: [//www.gitorious.org/~simon/qtwebkit/simons-clone/blobs/ceaa977f87947290fa2d063861f90c820417827f/LayoutTests/animations/change-keyframes.html](http://www.gitorious.org/~simon/qtwebkit/simons-clone/blobs/ceaa977f87947290fa2d063861f90c820417827f/LayoutTests/animations/change-keyframes.html)（只要该链接有效，gitorious 就是非常不擅长维护网址）。

我还从这里获取了 randomFromTo JavaScript 函数代码：http: [//www.admixweb.com/2010/08/24/javascript-tip-get-a-random-number-between-two-integers/](http://www.admixweb.com/2010/08/24/javascript-tip-get-a-random-number-between-two-integers/)

我已将文档添加到我从他那里获取的 Simon Hausmann 脚本的部分中（尽管我对它们进行了一些修改）。我还使用 jQuery 将点击事件附加到我的按钮上——所有其他脚本都是用原生 JavaScript 编写的。

我已经针对 Chrome 18 和 Safari 5.1 进行了测试，它似乎在两种浏览器中都能正常工作。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-08-25T09:22:10.053

`chrome 49`以后你可以利用`Firefox 48`新的 Javascript API`element.animate()`来推送你的关键帧动画。

请注意，此 API 是实验性的，除上述之外不能跨浏览器工作。

可以利用添加`class`或[注入关键帧等过时的解决方案来实现向后兼容性。](http://jeremyckahn.github.io/blog/2013/07/28/60-fps-or-bust-dynamically-prerendering-css-animations/)没有立即提供相同的垫片。

抽出 MDN 示例

```
document.getElementById("tunnel").animate([
  // keyframes
  { transform: 'translateY(0px)' }, 
  { transform: 'translateY(-300px)' }
], { 
  // timing options
  duration: 1000,
  iterations: Infinity
}); 
```

参考：

*   [caniuse.com/#feat=网络动画](http://caniuse.com/#feat=web-animation)
*   [MDN 文档](https://developer.mozilla.org/en-US/docs/Web/API/Element/animate)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-08-22T12:50:54.500

对于任何在 2017 年寻找这个答案的人，这里是[RussellUresti answer](https://stackoverflow.com/a/10344602/5122821)的变化。

在他的示例中，这将不再起作用：

```
keyframes.insertRule("0% { -webkit-transform: rotate(" + randomFromTo(-360,360) + "deg); }");
keyframes.insertRule("100% { -webkit-transform: rotate(" + randomFromTo(-360,360) + "deg); }"); 
```

这是因为 .insertRule() 是一个非标准名称。现在是 .appendRule()，所以 RusselsUresti 的代码现在是：

```
keyframes.appendRule("0% { -webkit-transform: rotate(" + randomFromTo(-360,360) + "deg); }");
keyframes.appendRule("100% { -webkit-transform: rotate(" + randomFromTo(-360,360) + "deg); }"); 
```

^(（只需替换*`insertRule`*为*`appendRule`*。）)

[关于 CSSKeyframeRule 的更多信息可以在这里找到](https://developer.mozilla.org/en-US/docs/Web/API/CSSKeyframesRule)

# asp.net - 如何在 ASP.NET 下获取未解码的请求 URL？

> ID：10342495
> 
> 赞同：1
> 
> 时间：2012-04-26T22:49:36.973
> 
> 标签：asp.net, uri, rawurl

我的请求网址是：[http://domain.com/some/path%2Fescaped](http://domain.com/some/path%2Fescaped)。

我想检索这个确切的 URL。我不希望它被解码，比如[http://domain.com/some/path/escaped](http://domain.com/some/path/escaped)；我希望它像[http://domain.com/some/path%2Fescaped](http://domain.com/some/path%2Fescaped)一样编码。

**我如何获得这个网址？**我尝试过 Request.Path、Request.RawUrl、Request.Url.AbsoluteUri、Request.Url.OriginalString ......每个都提供解码的 URL，如[http://domain.com/some/path/escaped](http://domain.com/some/path/escaped)。

我可以用 $_SERVER["REQUEST_URI"] 在 PHP 中得到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-01T12:37:38.237

你需要`Request.Url.OriginalString;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:18:10.043

我不知道这是否可行，但是您是否已经尝试`Server.URLDecode`过`Server.URLEncode`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T00:28:58.217

Javascript 调用 document.location.href 应该返回预期的格式。这是一个建议；检查这是否适合您。

1）有一个隐藏变量

```
<input type="hidden" id="hdn" runat="server" /> 
```

2）使用javascript函数设置隐藏变量

```
function setURL() {
        document.getElementById("hdn").value = document.location.href;
    } 
```

3）在服务器端

```
Page.ClientScript.RegisterStartupScript(this.GetType(),
        "setURL", "setURL();", true); 
```

4）在服务器端读取隐藏变量值（即实际格式的URL）

```
hdn.Value 
```

# java - 算法分析和结构识别

> ID：10342496
> 
> 赞同：0
> 
> 时间：2012-04-26T22:49:40.887
> 
> 标签：java, algorithm, big-o, structure

```
public class Structure <E extends Comparable<? super E>>{
  private E[] d;

  public Structure() { d = getArray(1); }

  public void show() { show(0); }

  private void show(int p){
    if( p < d.length && d[p] != null) {
      show(r(p));
      show(l(p));
      System.out.print(d[p] + " ");
    }
  }
  public void add(E obj) {
    int p = getPos(obj);
    if(p >= d.length)
      resize();
    d[p] = obj;
  }

  public boolean present(E obj){
    int p = getPos(obj);
    return p < d.length && d[p] != null;
  }

  private int getPos(E obj){
    int p = 0;
    while(p < d.length && d[p] != null){
      int dir = <*1>;
      if(dir < 0)
        p = l(p);
      else if(dir >0)
        p = r(p);
      else
        return p;
    }
    return p;
  }
  private E[] getArray(int size) {
    return (E[]) new Comparable[size];
  }

  private void resize(){
    E[] temp = getArray(d.length*2 + 1);
    for( int i = 0; i < d.length; i++)
      temp[i] = d[i];
    d = temp;
  }

  private int l(int i) { return 2 * i + 1;}
  private int r(int i) { return 2 * i + 2;}
} 
```

采用该数据结构。它是什么？我认为这是一个二叉搜索树，但我很确定它是那个或一个最大堆。不过，我在很大程度上倾向于 BST。

```
public void fillCol (int n, Collection<Integer> col){
    for(int i = 0; i < n; i++)
    col.add (i);
} 
```

如果 col 是链表，那么该方法的大 O 是多少？我认为是O（N）。

col 是树集吗？我认为它是 O (N log N)。

```
public void sort (List<Double> data){
  int lim = data.size();
  for(int i = 0; i < lim; i++){
    int m = i;
    for(int j = i + 1; j < lim; j++)
      if(data.get(j) < data.get(m) )
        m = j;
    data.set( i, data.set(m, data.get(i)));
  }
} 
```

每种类型的列表都有大 o。我认为 ArrayList 为 O (N²)，链表为 O (N³)。

表示图的类使用邻接矩阵来表示顶点之间的连接。包含 N 个节点且每个节点平均有 M 个连接的图的空间要求是多少？

我认为是 O (N²)

请帮忙！确认我是否正确，如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:14:37.863

它看起来像一棵（非必要平衡的）二叉树，其实现方式类似于二叉堆的实现方式——在 i 的子节点为 2i 和 2i+1 的数组中。

应该有人记录下他们做得更好的地方。

我同意你对 fillCol 的评价。

那种可调用的似乎是一个不相关的问题，是的，它确实看起来 O(n^2) 具有正常的数据结构。

# java - JSF 链接不工作（使用 Primefaces）

> ID：10342501
> 
> 赞同：3
> 
> 时间：2012-04-26T22:49:48.437
> 
> 标签：java, jsf-2, primefaces

对不起，真的很基本的问题......

我有一个显示在页面上的“留言板线程”列表。我希望能够单击其中一个并重定向到显示该线程详细信息的页面。尽管谷歌搜索了一段时间，但我仍在挣扎......

（顺便说一下，我正在使用 PrimeFaces）

这是我的“列表”页面中的相关代码：

```
<p:commandLink value="#{thread.title}" action="#{messageboardBean.showThread()}"> 
    <f:param name="threadId" value="#{thread.id}" />
</p:commandLink> 
```

（它在一个 h:form 元素中）

这是我命名 bean 的一部分（其他方法工作正常）

```
...
    @ManagedProperty(value="#{param.threadId}")
    private Long threadId;
...
    public String showThread() {
        System.out.println("id is " + getThreadId());
        return "messageboard/list";
    }
... 
```

正如你所看到的，我的方法还没有实现，但它甚至没有被调用。请问有人能告诉我为什么吗？

顺便说一句，我也尝试过使用 h:link，同样（或类似）的问题。

谢谢！

**更新 - 已解决**

感谢下面的帮助，这是我的解决方案（我已将“留言板”重命名为“讨论”）。

该链接是使用此代码生成的

值：在页面上显示什么，在我的例子中，我的讨论结果的标题：指的是 edit.xhtml，我想去的 faces 文件......并且 [request] 参数将被称为“threadId”并且在我的“线程”对象中具有 id 属性的值。

在 edit.xhtml 页面中，我有这个

```
<f:metadata>
    <f:viewParam name="threadId" value="#{viewDiscussionBean.threadId}" />
    <f:event type="preRenderView" listener="#{viewDiscussionBean.loadDiscussion}" />
</f:metadata> 
```

请注意，'threadId' 与第一页中的参数名称相同，并且绑定到我的 viewDiscussionBean 的 threadId 属性。

然后，一旦在我的 bean 上设置了所有参数，我就会调用 viewDiscussionBean 的 loadDiscussion 方法。由于它现在具有 threadId 属性，因此它能够做到这一点（见下文）

我的 viewDiscussionBean 具有以下托管属性（我认为 viewParam 标记设置了这个，而不是相反）。

```
@ManagedProperty(value="#{param.threadId}")
private Long threadId; 

private Discussion thread; 
```

所以一旦设置好了，这个方法就可以运行（因为它现在有一个 ID）

```
public String loadDiscussion() {
    thread = mbDao.find(threadId);
    return "edit";
} 
```

这只是使用 DAO（使用 Hibernate）来查找具有该 ID 的讨论线程，并将其设置在 bean 中。进而...

在我的 edit.xhtml 页面中，我可以使用类似的东西访问讨论线程中的值

```
<h:outputText value="#{viewDiscussionBean.thread.message}" /> 
```

瞧！谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T22:57:38.987

`UICommand`未调用操作有很多可能的原因。您可以在此处找到它们：[commandButton/commandLink/ajax action/listener 方法未调用或输入值未更新](https://stackoverflow.com/questions/2118656/hcommandlink-hcommandbutton-is-not-being-invoked/2120183#2120183)其中缺少表单、嵌套表单或表单中其他地方的转换/验证错误，位于其数据模型的数据表中没有妥善保存，等等。

至于您的特定功能要求，最好使用`<h:link>`. 命令链接发出 POST 请求，在您的特定情况下，该请求不会以 URL 中带有线程 ID 的可书签 URL 结束。A`<h:link>`创建一个完整的链接，该链接可添加书签且可搜索机器人索引。

例如

```
<h:link value="#{thread.title}" outcome="messageboard/list"> 
    <f:param name="threadId" value="#{thread.id}" />
</h:link> 
```

这不需要表单或操作方法。您只需要将其移动`@ManagedProperty`到与 关联的 bean `messageboard/list`，或者`<f:viewParam>`在`messageboard/list`视图中将其替换为允许更细粒度的验证/转换。

### 也可以看看：

*   [JSF2 中的通信 - 处理 GET 请求参数](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ProcessingGETRequestParameters)
*   [什么时候应该使用 h:outputLink 而不是 h:commandLink？](https://stackoverflow.com/questions/4317684/when-should-i-use-houtputlink-instead-of-hcommandlink)
*   [ViewParam 与 @ManagedProperty(value = "#{param.id}")](https://stackoverflow.com/questions/4888942/viewparam-vs-managedpropertyvalue-param-id)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T12:53:54.600

你最好的选择可能是使用[BalusC](https://stackoverflow.com/users/157882/balusc)的[答案](https://stackoverflow.com/a/10342565/244191)和使用`<h:link>`。但是，我对您所看到的行为有一些想法。

Primefaces `<p:commandLink>`(like `<p:commandButton>`) 默认使用 ajax。因此，从您的操作返回结果不会产生任何实际导航。这可能会使您的操作看起来没有被调用。尝试添加`ajax=false`到您的`<p:commandLink>`.

使用 时`<h:link>`，导航会在呈现链接时解决，而不是在单击时解决。修改您的示例：

```
<h:link value="#{thread.title}" outcome="#{messageboardBean.showThread()}"> 
    <f:param name="threadId" value="#{thread.id}" />
</h:link> 
```

`showThread()`将在呈现包含链接的视图时被调用（我认为）。如果您没有在正确的时间进行检查，这也可能使它看起来像是正在调用该方法。

在这两种情况下，这都不能解释为什么你根本看不到 System.out 的消息，但我知道我已经尝试过认为它是故障安全的，但仍然没有看到输出，这完全取决于你的容器、配置、启动方式等。

# php - 数据索引的最佳哈希算法（即 crc）

> ID：10342510
> 
> 赞同：1
> 
> 时间：2012-04-26T22:51:28.547
> 
> 标签：php, file, hash

基本上，我正在跟踪文件修改，例如：

```
array (
    'crc-of-file' => 'latest-file-contents'
) 
```

这是因为我同时在运行时处理不同文件的文件内容。

所以，问题是，我应该对文件内容使用什么散列算法（作为一个字符串，因为文件正在被加载）？

碰撞预防和性能一样至关重要。到目前为止，我没有看到任何安全隐患。

**编辑：**我可以用来代替散列内容的另一件事是文件修改时间戳，但我不确定它有多可靠。另一方面，我认为监视所述标记比每次散列文件更快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T02:01:51.607

CRC 它不是散列算法，是校验和算法，因此您发生冲突的机会将非常高。

`md5`速度非常快，并且对于您的应用程序/体积而言，碰撞风险相当小。如果您正在缓冲文件，您可能还想查看使用扩展的[增量哈希。](http://php.net/manual/en/function.hash-final.php)`hash`

有点复杂，但也值得一看（如果你有的话）是[`Inotify`扩展名](http://php.net/manual/en/function.inotify-init.php)。

# bash - bash 处理来自两个文件的数据

> ID：10342516
> 
> 赞同：0
> 
> 时间：2012-04-26T22:51:54.117
> 
> 标签：bash

文件1：

```
456
445
2323 
```

文件2：

```
433
456
323 
```

我想得到两个文件中数据的亏缺并输出到output.txt，即：

```
23
-11
2000 
```

我如何意识到这一点？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T22:54:34.857

```
$ paste file1 file2 | awk '{ print $1 - $2 }'
23
-11
2000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T22:55:53.677

在纯 bash 中，没有外部工具：

```
while read -u 4 line1 && read -u 5 line2; do
  printf '%s\n' "$(( line1 - line2 ))"
done 4<file1 5<file2 
```

这通过打开两个文件来工作（将它们附加到文件描述符 4 和 5）；进入一个循环，每次迭代从每个描述符中读取一行（如果*其中一个*没有值，则退出循环），然后计算并打印结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T01:50:20.707

使用 paste 创建公式，并使用 bc 执行计算：

```
paste -d - file1 file2 | bc 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T23:06:37.670

您可以使用 paste 和 awk 在列之间进行操作：

```
paste -d" " file1 file2 | awk -F" " '{print ($1-$2)}' 
```

甚至管道到文件：

```
paste -d" " file1 file2 | awk -F" " '{print ($1-$2)}' > output.txt 
```

希望能帮助到你！

# ruby-on-rails - 从模型中的 method_missing 访问会话的最佳方式

> ID：10342521
> 
> 赞同：0
> 
> 时间：2012-04-26T22:52:40.540
> 
> 标签：ruby-on-rails, ruby, model-view-controller, polymorphic-associations, method-missing

我知道模型不应该知道会话数据，但我需要访问模型上定义的 method_missing 中的一小部分状态信息。由 method_missing 捕获的方法由表单助手调用，即：

```
client_medias/new.haml:
    f.text_field :new_display_name

client_media.rb:
    has_many :custom_properties, :as => :extensible 
```

这里的 'new_display_name' 是通过多态关联定义的自定义属性键。我需要知道上下文（在我的情况下，由控制器中可访问的 current_app 方法提供）以获取不同自定义属性键的集合，我将其映射到 method_missing 中的动态方法定义。

有任何想法吗？我查看了 Thread.current 并且现在倾向于使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T06:36:46.563

我们有一个类似的问题，我们在一个应用程序中处理多个命令。在我们的例子中，上下文是命令，它是通过用户加载站点的顶级域来识别的。

我们的方法是使用 I18n 中的逻辑来提供一个“单例”，我们可以在应用程序的每个部分中访问它，就像它`I18n.locale`也使用 which uses一样`Thread.current`。

然后，我们在应用程序控制器中将单例设置为前置过滤器，以便应用程序的每个其他部分都可以在同一响应中使用它。

作为起点，看看 sven fuchs 的实现[https://github.com/svenfuchs/i18n/blob/master/lib/i18n.rb](https://github.com/svenfuchs/i18n/blob/master/lib/i18n.rb)

# c# - 麻烦 Linq to SQL 查询

> ID：10342522
> 
> 赞同：-1
> 
> 时间：2012-04-26T22:52:40.880
> 
> 标签：c#, sql, asp.net-mvc, linq-to-sql

这是我的数据库（它的一部分）：

```
Vehicule table :
Matv string primary ;
cCode int foreign key references city,
// some other columns
Indisponible(unavailable) table:
idin int primary,
from date 
to date
idv string foreign key references Matv in vehicule table. 
```

一辆车可以有许多不可用的日期。

这是我的搜索方法：

```
 public ActionResult search(int citycode, string from, string to)
        {
            DateTime dd1 = Convert.ToDateTime(from);
            DateTime df1 = Convert.ToDateTime(to);
            var model = (from p in entity.vehicule
                         join y in entity.indisponible on p.Matv equals y.idv
                         where p.cCode == citycode && ( dd1 > y.Df && df1 < y.Dd )
                         select p).ToList();
            return View(model);
        } 
```

这个搜索查询将允许我找到日期`from`和之间城市中的所有可用汽车`to`。所以要做到这一点，我必须检查用户选择的日期是否不在不可用的表中。
例如这辆车不可用

> 从 01/04/201 到 26/04/2012 和从 01/05/2012 到 09/05/2012。

因此，如果用户从 28/04/2012 到 30/04/2012 进行搜索，则必须显示此车
否则，如果他从 28/04/2012 到 03/05/2012 进行搜索，则此车将不会显示在搜索结果中。

但是出了点问题，它永远不会显示任何结果。任何人都可以帮我解决它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T22:56:29.743

我要在这里在黑暗中拍摄：是`Df`指“Date Fin”还是`Dd`“Date Debut”？如果是这样，您的查询将查找日期范围*结束之后*和*开始之前的项目。*

你可能想要这样的东西：

```
dd1 < y.Df && df1 > y.Dd 
```

### 更新

如果您只想包含给定范围之外的日期，则*需要*在开始日期之前*或*结束日期之后的日期：

```
dd1 > y.Df || df1 < y.Dd 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T15:47:17.920

这`where`适用于每一行。它不能同时考虑多行来确定可用性。但它应该......我们范围内的任何不负责任的记录都应该完全过滤汽车。

这可能更接近您想要的：

```
from p in entity.vehicule
where p.cCode == citycode
where p.indisponibles.All(y => y.Df < dd1 || df1 < y.Dd)
select p 
```

如果每条记录都满足该条件，则所有返回 true，并且当源为空时返回 true。

如果在我们的范围之后开始或在我们的范围之前结束，那么不负责任的记录不应该过滤我们的汽车。如果所有不负责任的记录都是这样，那么我们保留汽车。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T18:42:35.300

以这种方式爱抚：

```
from p in entity.vehicule                        
                         where p.agence.idgov == idv
                         where !p.indisponible.Any(b => (dd1 >= b.Dd && dd1 <= b.Df) || (df1 >= b.Dd && df1 <= b.Df))
                         where !p.indisponible.Any(c => (c.Dd >= dd1 && c.Dd <= df1) || (c.Df >= dd1 && c.Df <= df1))
                         select p).ToList(); 
```

感谢你的帮助。

# ruby-on-rails - 将 Google Maps Business API 密钥与地理编码器搜索相关联？

> ID：10342525
> 
> 赞同：2
> 
> 时间：2012-04-26T22:53:25.203
> 
> 标签：ruby-on-rails, google-maps, google-geocoding-api, rails-geocoder

我有一个使用地理编码器来处理具有纬度和经度的记录的后台 Rails 工作。我还拥有 Google Maps API v3 的许可证。这（显然）不会触及 javascript API。

根据[此处](https://developers.google.com/maps/documentation/geocoding/)列出的文档：

```
User of Google Maps API for Business may perform up to 100,000 requests per day. 
```

但是，根据 API 文档，您不要**在**请求 URL 中包含 api 密钥。

有谁知道我可以确保我通过 rails geocoder gem 对 geocoder api 的使用可以与我的帐户相关联？我宁愿不要达到极限。

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2012-04-27T10:38:33.860

您需要包含一个客户端参数，即您的客户端 ID，并且您需要签署您的请求。您可以在文档中找到更多信息：[https ://developers.google.com/maps/documentation/business/webservices](https://developers.google.com/maps/documentation/business/webservices)

# c# - C# TCP 套接字性能随着应用程序运行而下降

> ID：10342526
> 
> 赞同：5
> 
> 时间：2012-04-26T22:53:36.927
> 
> 标签：c#, .net, sockets

我编写了一个 C# 服务器应用程序。服务器使用异步 TCP 套接字。

数据包是 80-180 字节的数据。

对于性能测试，我有一个客户端连接并连续发送数据包。在大约 5 秒内接收前 100 个数据包（0-100）进行调试。当服务器接收到数据包#300-400 时，大约需要 30 秒才能接收到数据包。随着更多接收的发生，性能继续下降。

我环顾四周，未能找到解决方案。我尝试设置 Socket.NoDelay 标志，以防 Nagle 算法禁止服务器。

我已禁用服务器内的所有功能；所以它只是接收以确保我没有在其他代码中失去性能。

我还检查了我的 CPU 利用率，约为 13%。我有超过 2 GB 的可用内存。运行应用程序时，内存不会不断增长并且利用率最低。

我不知道接下来要调试和研究什么......

编辑：添加代码示例

```
public void StartListening()
    {

        try
        {
            IPAddress ipAddress = IPAddress.Parse("192.168.2.60");
            IPEndPoint localEndPoint = new IPEndPoint(ipAddress, m_Port);
            m_MainSocket = new Socket(localEndPoint.Address.AddressFamily, SocketType.Stream, ProtocolType.Tcp);
            m_MainSocket.NoDelay = true;
            m_MainSocket.Bind(localEndPoint);
            m_MainSocket.Listen(10);
            m_MainSocket.BeginAccept(new AsyncCallback(clientConnected), null);

            System.Diagnostics.Debug.WriteLine("Listening on:Local IP Address: " + localEndPoint.Address.ToString() + " Port :" + localEndPoint.Port.ToString() + "\n");
        }
        catch (SocketException se)
        {
            System.Diagnostics.Debug.WriteLine("Listening Exception \n");
            System.Diagnostics.Debug.WriteLine(se.Message);
        }
    }

    void clientConnected(IAsyncResult ar)
    {
        try
        {
            SocketState state = new SocketState(m_MainSocket.EndAccept(ar));
            Client client = new Client(state);

            if (client.SocketState.clientSocket.Connected)
            {
                System.Diagnostics.Debug.WriteLine("Client #?????? Connected \n");
                AddLogText("Client #?????? Connected \r\n\r\n");
                waitForData(client);
                SetSendButton(true);
            }

            m_MainSocket.BeginAccept(new AsyncCallback(clientConnected), null);
        }
        catch (ObjectDisposedException)
        {
           System.Diagnostics.Debug.WriteLine("Client Connected: Socket has been closed\n");
        }
        catch (SocketException se)
        {
            System.Diagnostics.Debug.WriteLine("Client Connected Exception \n");
            System.Diagnostics.Debug.WriteLine(se.Message);
        }
    }

    void waitForData(Client client)
    {
        try
        {
            SocketState state = new SocketState(client.SocketState.clientSocket);
            client.SocketState.clientSocket = null; 
            client.SocketState = state;
            client.SocketState.clientSocket.BeginReceive(client.SocketState.DataBuffer, 0, client.SocketState.DataBuffer.Length, SocketFlags.None, new AsyncCallback(readDataCallback), client);
        }
        catch (SocketException se)
        {
            System.Diagnostics.Debug.WriteLine("Wait For Data Exception \n");
            System.Diagnostics.Debug.WriteLine(se.Message);
        }

    }

    public void readDataCallback(IAsyncResult ar)
    {
        Client client = (Client)ar.AsyncState;
        try
        {                
            // Read data from the client socket.
            int iRx = client.SocketState.clientSocket.EndReceive(ar);
            client.SocketState.SB.Append(Encoding.ASCII.GetString(client.SocketState.DataBuffer, 0, iRx));
            string sPacketString = client.SocketState.SB.ToString();

            Server formServer = this;
            Packet_Helper packet_helper = new Packet_Helper(sPacketString, formServer);

            Packet packet = new Packet(sPacketString);
            client.SerialNumber = packet.SerialNumber;
            client.FirmwareVersion = packet.FirmwareVersion;
            client.ProductID = packet.ProductID;
            client.HardwareVersion = packet.HardwareVersion;
            if (!m_Clients.ContainsKey(packet.SerialNumber))
            {
                m_Clients.Add(packet.SerialNumber, client);
                UpdateClientList();
                string[] packets = client.refreshAll();
                for (int i = 0; i < packets.Length; i++)
                {
                    byte[] byteData = Encoding.ASCII.GetBytes(packets[i]);
                    client.SocketState.clientSocket.BeginSend(byteData, 0, byteData.Length, SocketFlags.None, new AsyncCallback(SendCallback), client);
                    AddPacketsSentText(packets[i] + "--" + (iSent++).ToString() + "\r\n\r\n");
                }
            }

            System.Diagnostics.Debug.WriteLine("Read " + sPacketString.Length.ToString() + " bytes from " + client.SerialNumber + "\n" + sPacketString + "\n");
            AddLogText("Read " + sPacketString.Length.ToString() + " bytes from " + client.SerialNumber + " \r\n");
            AddLogText(sPacketString.ToString() + "\r\n\r\n");

            waitForData(client);
        }
        catch (ObjectDisposedException)
        {
            System.Diagnostics.Debugger.Log(0, "1", "\nOnDataReceived: Socket has been closed\n");
        }
        catch (SocketException se)
        {
            if (se.ErrorCode == 10054) // Error code for Connection reset by peer
            {
                string sclientSerial = "??????";
                if (client.SerialNumber != null || client.SerialNumber != "")
                    sclientSerial = client.SerialNumber;
                AddLogText("Client " + sclientSerial + " Disconnected" + "\r\n\r\n");
                System.Diagnostics.Debug.WriteLine("Client " + sclientSerial + " Disconnected" + "\n");

                m_Clients.Remove(sclientSerial);
                UpdateClientList();
            }
            else
            {
                System.Diagnostics.Debug.WriteLine("Read Data Exception \n");
                System.Diagnostics.Debug.WriteLine(se.Message);
            }
        }
    }

class SocketState
{
    private Socket m_ClientSocket;                   //Socket connection to the client
    private byte[] m_DataBuffer = new byte[256];        //Buffer to store the data sent by the client
    private StringBuilder m_SB = new StringBuilder();  //for building recieved data into a string 

    /// <summary>
    /// Gets or Sets the client Socket
    /// </summary>
    public Socket clientSocket
    {
        get { return m_ClientSocket; }
        set { m_ClientSocket = value; }
    }

    /// <summary>
    /// Gets the DataBuffer
    /// </summary>
    public byte[] DataBuffer
    {
        get { return m_DataBuffer; }
        set { DataBuffer = value; }
    }

    /// <summary>
    /// Gets or Sets the SB
    /// </summary>
    public StringBuilder SB
    {
        get { return m_SB; }
        set { m_SB = value; }
    }

    public SocketState(Socket socket)
    {
        m_ClientSocket = socket;
        m_ClientSocket.ReceiveBufferSize = 256;
        m_ClientSocket.NoDelay = true;
        //m_DataBuffer = Enumerable.Repeat((byte)0, 256).ToArray();
    }
} 
```

编辑：添加了 AddLogText() 函数。此函数用于向 UI 中的文本框添加文本。

//Delegate - 启用异步调用以设置 tb_ListeningLog 的 text 属性

```
delegate void AddLogTextCallback(string text);

private void AddLogText(string text)
    {
        // InvokeRequired required compares the thread ID of the
        // calling thread to the thread ID of the creating thread.
        // If these threads are different, it returns true.
        if (this.tb_ListeningLog.InvokeRequired)
        {
            AddLogTextCallback d = new AddLogTextCallback(AddLogText);
            this.Invoke(d, new object[] { text });
        }
        else
        {
            this.tb_ListeningLog.Text += text;
            tb_ListeningLog.SelectionStart = tb_ListeningLog.Text.Length;
            tb_ListeningLog.ScrollToCaret();
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T15:46:43.097

我对这个答案有点摸不着头脑，但是您发布的代码肯定会有所帮助。

随着时间的推移，您可能会看到性能缓慢的原因是因为您的`readDataCallback`方法中的代码。按照您的设置方式，数据的处理是在您进行另一次接收之前完成的。这意味着随着处理时间的增加，接收数据之间的持续时间也会增加。

我不知道您的许多方法中有什么代码，但您通常应该查看可能需要一段时间才能完成的任何循环。如果您无法通过查看代码来找到瓶颈，请尝试找出哪些方法完成时间最长，并继续缩小代码范围。

例如（我猜瓶颈在这个代码区域）：

```
if (!m_Clients.ContainsKey(packet.SerialNumber))
{
    m_Clients.Add(packet.SerialNumber, client);

    AddLogText("Running UpdateClientList\r\n");

    UpdateClientList();

    AddLogText("Doing client.refreshAll\r\n");

    string[] packets = client.refreshAll();

    AddLogText("Doing for loop\r\n");

    for (int i = 0; i < packets.Length; i++)
    {
        byte[] byteData = Encoding.ASCII.GetBytes(packets[i]);
        client.SocketState.clientSocket.BeginSend(byteData, 0, byteData.Length, SocketFlags.None, new AsyncCallback(SendCallback), client);
        AddPacketsSentText(packets[i] + "--" + (iSent++).ToString() + "\r\n\r\n");
    }
} 
```

只需用眼睛观察每种方法之间的时间量，或使其更容易并使用`Stopwatch`或`DateTime`显示准确时间。

此外，如果您发现代码的行为无法提高效率，您可以考虑在单独的线程中处理数据的想法。不过，由于手头的问题，我假设这种行为是不希望的。

* * *

对于您的`AddLogText`方法，请尝试使用`tb_ListeningLog.Text.AppendText`而不是 +=。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:24:53.130

我不知道为什么你有这么长的一段代码来读取更多的数据。此外，尝试将消息放入可由不同线程处理的队列中。

这是我使用的一个实现：

```
// Read data from the client
private void ReadCallback(IAsyncResult ar)
{
    StateObject state = (StateObject)ar.AsyncState;
    Socket socket = state.workSocket;

    try
    {
        if (socket.Connected)
        {
            // Read the socket
            int bytesRead = socket.EndReceive(ar);

            // Deserialize objects
            foreach (MessageBase msg in MessageBase.Receive(socket, bytesRead, state))
            {
                // Add objects to the message queue
                lock (this.messageQueue)
                    messageQueue.Enqueue(msg);
            }

            // Notify any event handlers
            if (DataRecieved != null)
                DataRecieved(socket, bytesRead);

            // Asynchronously read more client data
            socket.BeginReceive(state.Buffer, state.readOffset, state.BufferSize - state.readOffset, 0,
                ReadCallback, state);
        }
        else
        {
            HandleClientDisconnect(socket);
        }
    }
    catch (SocketException)
    {
        HandleClientDisconnect(socket);
    }
} 
```

# javascript - 跨浏览器和屏幕尺寸映射点击位置

> ID：10342527
> 
> 赞同：1
> 
> 时间：2012-04-26T22:53:51.383
> 
> 标签：javascript, css

我有一个收集点击事件的页面，`event.pageX`我`event.pageY`想将这些位置按比例映射到另一个页面上的 600 像素 x 750 像素框。这意味着如果框中有其他页面的屏幕截图，则单击位置的标记将在同一位置直观地显示。

我知道我有`($('body').width(), $('body').height())`、`(document.body.offSetWidth, document.body.offSetHeight)`和`(screen.width, screen.height)`，但我不太确定如何最好地将它们结合起来以获得准确的比率。

目前我只是在使用（在 sudo 代码中）：

```
x_ratio = 600 / document.body.offSetWidth
y_ratio = 750 / document.body.offSetHeight

new_x_position = event.pageX * x_ratio
new_y_position = event.pageY * y_ratio 
```

然后框内点击事件的标记是

```
<div id='click_marker' 
    style="position: relative; top: new_y_position px; left: new_x_position px;">
</div> 
```

但这似乎无法保持跨浏览器和屏幕尺寸的准确性。我想在一个浏览器和屏幕尺寸中获取点击位置，并能够准确地将其映射到任何浏览器和屏幕尺寸。

我怎样才能始终如一地准确地进行此计算？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:13:05.793

pageX 和 pageY，为您提供相对于网页而不是屏幕的坐标
使用 screenX 和 screenY 获取相对于屏幕的坐标，或者使用 clientX 和 clientY 获取相对于浏览器客户端窗口的坐标。这些事件字段可能并非在所有浏览器中都可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:40:00.247

首先，您需要确定要从中转换坐标的区域。它是浏览器窗口还是文档正文？即，如果您有滚动条，您是否希望有人向下滚动并单击页面底部也出现在您的 600x750 框的底部或外部？从您的问题中显然不清楚。

event.pageX 和 event.pageY 提供从*文档的左边缘和上边缘的*位置因此使用 body.offsetWidth 将仅在 body 填充整个文档时保持一致。请检查以下小提琴以了解： http: [//jsfiddle.net/Exceeder/YPHkr/](http://jsfiddle.net/Exceeder/YPHkr/) - 注意越过右身体边界如何使相对坐标超过 1.0

最简单的做法是获取 $(window).width() 和 $(window).height() - 如果不需要考虑滚动位置。否则，您将需要计算滚动位置，并且算法会有点困难。

确定后，您需要获得正确的宽度和高度。相关问题：[不同浏览器的 document.body.offsetWidth 变化](https://stackoverflow.com/questions/312244/document-body-offsetwidth-variations-for-different-browsers)

# php - 吸气剂中重复开关的设计模式？

> ID：10342528
> 
> 赞同：5
> 
> 时间：2012-04-26T22:53:57.843
> 
> 标签：php, design-patterns, language-agnostic, if-statement

例如，我有一个用于博客系统的 ORM 模型（PHP Active Record）。我有一个`post`模型，可以存储喜欢的数量。`post`可以是 a`picture`或`quote`（比如说），它们是不同的表（因此是模型）。

架构是 a与 a或 a`post`一起保存共享数量、喜欢、描述等数据。`picture``quote`

因此，在为模型编写吸气剂时，`post`我必须编写

```
public function getX() {
    if ($this->isPicture()) {
       return $this->picture->getX();
    }
    else if ($this->isQuote()) {
       return $this->quote->getX()
    }
    else {
       return self::DEFAULT_X
    }
} 
```

我目前不得不为许多吸气剂编写这种结构。我可以做些什么来避免这种情况吗？

**PS：**标记为 PHP 因为那是我的代码。

### 编辑

*   将注释更改为代码。
*   这是一个模型（以及数据库中的相应表），它具有比 a`picture`和更多的数据`quote`。例如，`description`这是 的一部分，`post`并且不位于`picture`或 上`quote`。
*   有`picture`s 和`quote`s 的表格。
*   使用 PHP Active Record，这三个类中的每一个都扩展了 PHP Active Record 提供的通用模型类。
*   该`picture`模型有它自己的数据。对`quote`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T00:04:59.997

扩展评论中提到的策略模式的想法：

```
class Post {
    // get the correct 'strategy'
    public function getModel() {
        if ($this->isPicture()) {
            return $this->picture;
        }

        if ($this->isQuote()) {
            return $this->quote;
        }

        return null;
    }

    // using the strategy
    public function getX() {
        $model = $this->getModel();

        if (null === $model) {
            return self::DEFAULT_X;
        }

        return $model->getX();
    }
} 
```

`Post`每个策略都可能实现与暴露这些 getter 的类相同的接口。更好的是提供一个默认策略（而不是返回 null）并让它返回默认值。这样，每个 getter 中的空检查就变得多余了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:48:47.347

另一种方法是元编程的一种非常基本的形式。这个想法是你比手动调用你的方法更高，让代码为你做这件事。

（假设方法定义都是 的一部分`Post`）

```
public function getX($model = null) {
   if ($model) return $model->getX();
   else return self::DEFAULT_X;
}

// usage
$postModel->getX($pictureModel); 
```

这里发生的情况是，在模型中的这个单个实例中，`getX`您`Post`传入另一个类的名称，并在该实例上执行“getX”方法（如果它存在并且是可调用的）。

您可以通过其他方式扩展它。例如，当方法无论如何都可以做到时，也许您不想传递实例：

```
public function getX($model_name = null) {
  if ($model_name && $class_exists($model_name) && is_callable(array($model_name, 'getX')) {
    $model = new $model_name;
    return $model->getX();

  } else {
    return self::DEFAULT_X;
  }
} 

// usage
$postModel->getX('Picture'); 
```

在这种情况下，您将模型作为字符串传入，然后该方法将完成其余的工作。虽然这可以更快地获得您想要的东西，但您可能会发现您不想一直使用新实例（或者您不能），因此需要对这种“方便”进行权衡方法。

但是，这仍然不能完全解决您的问题，因为您仍然必须一遍又一遍地为每个吸气剂重复此操作。相反，您可以尝试这样的事情：

```
public function __call($method, $args) {
  $class = $args[0];

  if (class_exists($class) && is_callable(array($class, $method))) {
    $model = new $class;  
    return $model->$method();
  }
}

// usage
$postModel->getX('Picture');
$postModel->getY('Quote');
$postModel->getZ('Picture'); 
```

如果您调用模型上不存在的函数，则将`Post`调用该魔术方法，并且它将启动您作为参数提供的模型名称的新实例，并`getWhatever`在其上调用该方法（如果存在） .

重要的是要注意，您**不能在 中定义这些 getter`Post`**，除非您想**覆盖**其他类中的方法。

但是，始终存在创建新实例的问题，为了解决这个问题，您可以使用一些依赖注入。这意味着您让`Post`该类包含它希望将来使用的其他类实例的列表，因此您可以随意添加和删除它们。

这就是我认为的实际解决方案，其他示例有望展示我是如何到达这里的（当然，将编辑以澄清事情）。

```
public $models = array();

public function addModel($instance) {
  $this->models[get_class($instance)] = $instance;
}

public function __call($method, $args) {
  $class = $args[0];

  if (array_key_exists($class, $this->models)) {
    $model = $this->models[$class];
    if (is_callable(array($model, $method)) {
      return $model->$method();
    }
  }     
}

// usage
$this->addModel($pictureModel);
$this->addModel($quoteModel);

$this->getX('Picture');
$this->getY('Quote'); 
```

在这里，您将现有的模型实例传递给`Post`类，然后将它们存储在一个数组中，并以类的名称为键。然后，当您使用上一个示例中描述的类时，它不会创建新实例，而是使用它已经存储的实例。这样做的好处是您可以对您的实例做一些您希望在`Post`模型中反映出来的事情。

这意味着您可以添加任意数量的需要插入的新模型，而您`Post`唯一需要做的就是注入它们`addModel`，并在这些模型上实现 getter。

它们都要求你告诉班级在某个时候要调用什么模型。既然您有一系列依赖模型，为什么不添加一种获取所有内容的方法呢？

```
public function __call($method, $args) {
  $class = $args[0];

  if (array_key_exists($class, $this->models)) {
    $model = $this->models[$class];
    if (is_callable(array($model, $method)) {
      return $model->$method();
    }
  } elseif ($class === 'all') {
    // return an array containing the results of each method call on each model
    return array_map(function($model) use ($method) {
      if (is_callable(array($model, $method) return $model->$method();
    }, $this->models);

  }    
}

// usage
$postModel->getX('all'); 
```

使用它，您将获得一个数组，其中包含`getX`您添加的每个模型上每个方法的返回值`addModel`。您可以创建非常强大的函数和类来完成所有这些工作，而无需重复繁琐的逻辑。

我不得不提一下，这些例子是未经测试的，但至少我希望你能做什么的概念已经清楚了。

**注意：** 同样的事情也可以应用于`__GET`和`__SET`方法，用于访问属性。还值得一提的是，库已经使用这些魔术方法可能存在轻微风险，在这种情况下，您需要使代码更加智能。

# objective-c - CocoaAsyncTask 无法连接真实设备

> ID：10342529
> 
> 赞同：0
> 
> 时间：2012-04-26T22:54:18.373
> 
> 标签：objective-c, ios, tcp, cocoaasyncsocket

我正在使用 CocoaAsyncTask 并尝试连接到本地主机。当我从模拟器运行它时，它可以工作（我正在使用提供的回显服务器检查它）但是当我在实际设备上运行它时，什么也没有发生......代码是：

```
if(![socket connectToHost:@"localhost" onPort:8080 error:nil]) {
    NSLog(@"Error..");
}
-(void)socket:(GCDAsyncSocket *)socket didConnectToHost:(NSString *)host: port:(uint16_t)port {
    NSLog(@"Connected");
} 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T00:21:02.767

当您尝试连接到未在本地安装的服务器（本地 = 在完全相同的主机和接口上）时，您提供的地址为“localhost”。请参阅[“localhost”上的维基百科条目](http://en.wikipedia.org/wiki/Localhost)。

它在模拟器上工作，因为它使用 Mac 的网络接口，因此“localhost”指的是您运行服务器的机器以及客户端。

您需要提供主机（例如您的 Mac）的本地 IP 地址。通常这类似于 192.168.1.100 或 192.168.0.100 - 但更准确地说是；

> 192.168.xxx.xxx = C 类不可路由地址
> 
> 10.xxx.xxx.xxx = A 类不可路由地址

而***xxx***代表 0 到 255 之间的任何值。

要了解您的本地 IP 地址，请使用*System Preferences* -> *Network Panel*。检查***“...IP地址xxx.xxx.xxx.xxx”的****状态*下方的值

 *![在此处输入图像描述](../Images/fed2cf7b65584bcb4676a93bada33df4.png)*

# java - 控制器无法扩展类

> ID：10342542
> 
> 赞同：0
> 
> 时间：2012-04-26T22:55:30.163
> 
> 标签：java, spring-mvc

我在下面的构造函数中得到了一个 nullPointerException ......我还包含了父类。

```
SEVERE: Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'contentController' defined in file [C:\Users\bkuhl\JavaProjects\cmt\cmt\target\cmt\WEB-INF\classes\com\site\cmt\web\ContentController.class]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [com.fettergroup.cmt.web.ContentController]: Constructor threw exception; nested exception is java.lang.NullPointerException 
```

和类（构造函数被省略，以便它使用父构造函数）

```
public class ContentController extends com.site.cmt.library.Controller {
     ...
} 
```

和父类

```
public class Controller {
    private SortedMap<Integer, String> cssFiles;
    private SortedMap<Integer, String> jsFiles;

    public Controller () {
        this.addCss("global.css");
        this.addJs("global.js");
    }
    .... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:00:55.200

您是否尝试过 ommit `addCss`并`addJs`确保问题不在实现方法之内？

# node.js - socket.io：没有触发断开事件

> ID：10342548
> 
> 赞同：37
> 
> 时间：2012-04-26T22:56:03.723
> 
> 标签：node.js, events, socket.io, disconnect

我做了一个简单的实时访客计数器。

您可以从此[存储库](https://bitbucket.org/bitliner/nodejs-mycounter)下载它。

发生的事情是永远不会触发服务器上的断开连接事件（即使在浏览器关闭之后）。

server.js 是：

```
(function () {
var app, count, express, io;

express = require('express');
io = require('socket.io');

app = module.exports = express.createServer();

app.configure(function () {
    app.set('views', __dirname + '/views');
    app.set('view engine', 'jade');
    app.use(express.bodyParser());
    app.use(express.methodOverride());
    app.use(require('stylus').middleware({
        src: __dirname + '/public'
    }));
    app.use(app.router);
    return app.use(express.static(__dirname + '/public'));
});

app.configure('development', function () {
    return app.use(express.errorHandler({
        dumpExceptions: true,
        showStack: true
    }));
});
app.configure('production', function () {
    return app.use(express.errorHandler());
});

io = require('socket.io').listen(app);

count = 0;

io.sockets.on('connection', function (socket) {
    count++;
    io.sockets.emit('count', {
        number: count
    });
});

io.sockets.on('disconnect', function () {
    console.log('DISCONNESSO!!! ');
    count--;
    io.sockets.emit('count', {
        number: count
    });
});

app.get('/', function (req, res) {
    return res.render('index', {
        title: 'node.js express socket.io counter'
    });
});
if (!module.parent) {
    app.listen(10927);
    console.log("Express server listening on port %d", app.address().port);
}

}).call(this); 
```

客户端上的脚本是：

```
 script(type='text/javascript')

        var socket = io.connect();

        socket.on('count', function (data) {
            $('#count').html( data.number );
        }); 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-04-26T23:02:43.823

将您的 on disconnect 代码放在 on connect 块中并像这样编辑它：

```
io.sockets.on('connection', function (socket) {
    count++;
    io.sockets.emit('count', {
        number: count
    });

    socket.on('disconnect', function () {
        console.log('DISCONNESSO!!! ');
        count--;
        io.sockets.emit('count', {
            number: count
        });
    });
}); 
```

这样，您就可以检测到特定套接字（特别是传递给在连接上运行的匿名函数的套接字）何时断开连接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-24T03:25:49.470

**从 Socket.IO 1.0 开始**，该`io.engine.clientsCount`属性可用。这个属性告诉你你的应用当前有多少打开的连接。

```
io.sockets.on('connection', function (socket) {
    io.sockets.emit('count', {
        number: io.engine.clientsCount
    });

    socket.once('disconnect', function () {
        io.sockets.emit('count', {
            number: io.engine.clientsCount
        });
    });
}); 
```

注意：使用`.once`而不是，`.on`侦听器将自动从`socket`现在对我们有益的内容中删除，因为每个套接字仅触发一次断开连接事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-23T21:45:46.897

以防万一其他人犯了这个愚蠢的错误：确保您定义的任何套接字中间件都`next()`在最后调用，否则没有其他套接字处理程序将运行。

```
// make sure to call next() at the end or...
io.use(function (socket, next) {
    console.log(socket.id, "connection middleware");
    next(); // don't forget this!
});

// ...none of the following will run:

io.use(function (socket, next) {
    console.log(socket.id, "second middleware");
    next(); // don't forget this either!
});

io.on("connection", function (socket) {
    console.log(socket.id, "connection event");
    socket.once("disconnect", function () {
        console.log(socket.id, "disconnected");
    });
}); 
```

# php - Yii 中的关系数据库

> ID：10342549
> 
> 赞同：0
> 
> 时间：2012-04-26T22:56:05.293
> 
> 标签：php, yii, gii, yii-cactiverecord

所以我试过这个：[http ://www.yiiframework.com/wiki/285/accessing-data-in-a-join-table-with-the-related-models](http://www.yiiframework.com/wiki/285/accessing-data-in-a-join-table-with-the-related-models)

基本上我有一个名为 User 的表，它与 ToolAccess 相关；通过 User 上的主键和 ToolAccess 上的 userID 字段相关。现在工具访问与包含 ToolID 的表 Tool 相关。现在这在 Yii 中不起作用，我似乎无法使用 Yii 从工具表中删除 toolName 字段。关于如何在 Active Record 上执行此操作的任何想法？

如果这很重要，我正在使用 giix。

关系代码：

```
public function relations() {
    return array(
        'usergalleries' => array(self::HAS_MANY, 'Usergallery', 'userid'),
        'userinroles' => array(self::HAS_MANY, 'Userinroles', 'userid'),
        'userfailedlogin' => array(self::HAS_MANY, 'Userfailedlogin','userid'),
        // table name, relation, class name, relation key
        'toolaccess' =>array(self::HAS_MANY, 'Toolaccess','userid'),
        'tool' =>array(self::HAS_MANY, 'Tool','toolid')
    );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T04:27:22.157

我假设您的架构看起来像这样：

```
User table             tool_access table          Tool table

id | other columns     userid | toolid            id | name | other columns 
```

在这种情况下，`User`模型应该有这样的关系（请注意，在这种情况下，工具将按名称排序）：

```
public function relations() {
    return array(
        // other relations here...
        'tools' =>array(self::MANY_MANY, 'Tool', 'tool_access(userid,toolid)',
          'order' => 'tools.name',
        ),
    );
} 
```

读取工具的代码应如下所示：

```
$user = User::model()->with('tools')->findByPk($id);
foreach($user->tools as $tool) {
    echo $tool->name;
} 
```

我在这里使用了急切加载，`tools`主要是因为个人喜好，在这种情况下使用延迟加载应该也能正常工作。但是，当您一次处理多条记录时，应该首选预先加载`User`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:52:16.630

因此，如果我理解正确，用户和工具通过它们的主键以多对多的关系相关。

因此，您应该在 User 模型中定义这种关系，例如：

```
'tools' => array(self::MANY_MANY, 'Tool', 'tool_access(userid, toolid)', 'index' => 'id'), 
```

这样就可以在获取用户模型后访问工具的名称

```
$user = User::model->findByPk($id);
$tools = $user->tools;
foreach ($tools as $tool)
{
    echo $tool->name;
} 
```

我希望这个对你有用。

# javascript - javascript 通过 id 与对象 id 获取元素

> ID：10342551
> 
> 赞同：0
> 
> 时间：2012-04-26T22:56:12.803
> 
> 标签：javascript

如果您已经知道对象的 ID，为什么还要使用 getObjectById？它一直让我失望，因为我用我所指的元素的 ID 替换它。

编辑：我想我可能只是忘记了#。但是，如果您可以为元素分配 ID，为什么 getObjectById 存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:23:11.633

要首先对任何元素应用一些操作，您必须告诉 javascript 该元素的标识，假设您想在特定元素上添加一个事件侦听器，并且您必须这样做（简短示例）

```
​&lt;div id="myDiv">​Some Text</div>​

document.getElementById('myDiv').onclick=function(){
    alert('clicked on div !');
} 
```

上面的代码`document.getElementById('myDiv').onclick=function(){...}`告诉 javascript 在有人单击具有 id 的 div 时执行该函数（就在 = 之后）`myDiv`。

**实际上通过其 ID 返回对元素的引用。**

[**演示。**](http://jsfiddle.net/g2wKz/1/)

**参考：** [**这里。**](https://developer.mozilla.org/en/DOM/document.getElementById)

# ruby-on-rails-3 - Rails UTF-8 响应

> ID：10342552
> 
> 赞同：3
> 
> 时间：2012-04-26T22:56:15.017
> 
> 标签：ruby-on-rails-3, encoding

我有一个在 Ruby 1.9.3 上运行的 Rails 3.2 应用程序，它返回存储在 MongoDB 数据库中的 JSON 数据。数据似乎正确存储在 mongo 中，例如（查看 name 属性）：

```
{ "_id" : ObjectId("4f986cbe4c8086fdc9000002"), "created_at" : ISODate("2012-04-25T21:31:45.474Z"), "updated_at" : ISODate("2012-04-26T22:07:23.901Z"), "creator_id" : ObjectId("4f6b4d3c4c80864381000001"), "updater_id" : null, "name" : "Trädgår'n", "sort" : "tradgarn", "address" : "Nya Allén 11", "coordinates" : [ 11.9764791, 57.7045625 ], "phone" : "46031102080", "url" : "http://www.profilrestauranger.se/tradgarn/", "user_ids" : [ ] } 
```

但是当我发出一个返回这条记录的请求时，我得到了类似的东西（现在看看 name 属性）：

```
{"address":"Nya All\u00e9n 11","coordinates":[11.9764791,57.7045625],"created_at":"2012-04-25T23:31:45+02:00","id":"4f986cbe4c8086fdc9000002","name":"Tr\u00e4dg\u00e5r'n","phone":"46031102080","sort":"tradgarn","updated_at":"2012-04-27T00:07:23+02:00","url":"http://www.profilrestauranger.se/tradgarn/"} 
```

任何感兴趣的人的响应标头：

```
HTTP/1.1 200 OK
Server: nginx/1.2.0
Date: Thu, 26 Apr 2012 22:41:13 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 909
Connection: keep-alive
Status: 200 OK
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: POST, GET, OPTIONS
Access-Control-Max-Age: 1000
Access-Control-Allow-Headers: *,x-requested-with
X-UA-Compatible: IE=Edge
ETag: "d2a95f06bec10d8087c3188280292d3c"
Cache-Control: max-age=0, private, must-revalidate
X-Request-Id: fdd042568195df279e59affe45bdcd37
X-Runtime: 0.037134 
```

我似乎无法弄清楚编码为什么或在哪里弄乱了？是什么赋予了？帮助？:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T19:20:48.847

这个问题确实是 JSON UTF-8 编码之一。该`#to_json`方法是转义Unicode字符。这可以通过以下方式观察到：

```
user.to_json

#  => "{\"created_at\":\"2012-04-19T18:48:01Z\",\"email\":\"tr\\u00e4dg\\u00e5r@example.com\",\"id\":10,\"updated_at\":\"2012-04-27T18:37:10Z\"}" 
```

但是，在解析时，它会转换回您所期望的方式。但是，可以使用可以使用`JSON.generate`该`#as_json`方法的 JSON 以及用于构造的任何选项来生成 JSON。这不会逃避 unicode。这样做：

```
JSON.generate(user.as_json)

#  => "{\"created_at\":\"2012-04-19T18:48:01Z\",\"email\":\"trädgår@example.com\",\"id\":10,\"updated_at\":\"2012-04-27T18:37:10Z\"}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T15:02:04.483

原来我看到的问题是 gem `colorful_json`。我通过它的 CLI 实用程序运行 JSON `cjson`，它弄乱了 Unicode。我报告了这个问题，新版本的 gem 修复了这个问题。

# symfony1 - 在 Symfony 1.4.11 中启用/禁用自定义执行过滤器？

> ID：10342553
> 
> 赞同：2
> 
> 时间：2012-04-26T22:56:19.053
> 
> 标签：symfony1, action-filter

我创建了一个自定义 Symfony 执行过滤器，通过扩展 sfFilter 类来管理 POST 请求的完整性。过滤器工作正常，但有时我需要禁用它，事实是在 filters.yml 文件中的过滤器定义中指定的参数条件（见下文）不起作用。

```
# filters.yml

rendering: ~
security:  ~
SSL:
  class: SSLFilter
  condition: %APP_ENABLE_SSLFILTER%

integrity:
  class:  IntegrityFilter
  param:
    integrity_header:   x-integrity-cnonce
    condition:  %APP_ENABLE_INTEGRITYCHECK%

cache:     ~
execution: ~ 
```

如您所见，IntegrityFilter 的条件要求 app.yml 文件中的配置条目 ENABLE_INTEGRITYCHECK 为 ON 才能执行过滤器。

```
# app.yml
all:
  sf_guard_plugin:
    algorithm_callable:   md5
    success_signout_url:  /
    success_signin_url:   /
  enable_sslfilter: off
  # Enables de IntegrityFilter check
  enable_integritycheck: off 
```

好吧，事情是它不起作用，因为我使用脚本来启用/禁用某些设置以及其他任务，并且没有禁用它。有趣的是，启用/禁用两个 YAML 文件中显示的 SSL 过滤器都可以正常工作。有任何想法吗...？

# c - OpenGL：从读取文件的 while 循环中调用 glutPostRedisplay()

> ID：10342560
> 
> 赞同：0
> 
> 时间：2012-04-26T22:57:00.553
> 
> 标签：c, opengl, glut

所以我试图从 IMU 读取传感器数据并相应地更新角度。我打开传感器数据文件，逐行读取，将四元数转换为旋转，然后更新我的模型。问题是当从 while 循环调用 glutPostRedisplay() 时，循环继续，而 glutPostRedisplay() 并行运行。这使得一切看起来都是瞬间发生的。我想要做的是强制程序停止，直到显示更新。

我想不出另一种方法来做到这一点，因为我不想经常打开和关闭文件或跟踪我当前在文件中的位置。如果我可以只读取该行，处理它，然后强制 OpenGL 渲染，然后读取下一行等，那会更容易。

有没有人有什么建议？

**注意：**目前，当我能够渲染时，while 循环已完全执行。我尝试在 glutPostRedisplay() 之后直接使用 glutSwapBuffers()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:19:39.020

GLUT 不是这样工作的。您必须停止循环并从您想要的任何功能返回，以便 GLUT 发出渲染命令。通常你把这种东西放在一个空闲的函数中。

或者您可以使用 GLFW，它允许您拥有渲染循环的所有权。或者您可以使用 FreeGLUT [`glutMainLoopEvent`](https://stackoverflow.com/a/10154782/734069)，它允许您拥有渲染循环的所有权（尽管您需要一些代码重写才能使其工作）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T23:30:19.507

您可以注册一个在 GLUT 不忙于[glutIdleFunc](http://www.opengl.org/resources/libraries/glut/spec3/node63.html)时调用的函数，而不是使用 while 循环。在此空闲函数中从 IMU 读取，并在需要强制重新显示时调用 glutPostRedisplay。

# ruby-on-rails - 任何acts_as_commentable_with_threading 示例？

> ID：10342562
> 
> 赞同：2
> 
> 时间：2012-04-26T22:57:20.503
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rubygems

我是 Ruby on Rails 的新手，目前我正在尝试创建一个简单的博客平台。我想用[acts_as_commentable_with_threading](https://github.com/elight/acts_as_commentable_with_threading) gem 实现评论功能。我对嵌套表单不太熟悉，但这是我的尝试：

**评论控制器.rb**

```
class CommentsController < ApplicationController
  before_filter :get_spot

  # GET /comments/new
  def new
    @comment = Comment.new

    respond_to do |format|
      format.html
    end
  end

  private
    def get_spot
      @spot = Spot.find(params[:spot_id])
    end    
end 
```

**_form.html.erb**

```
<%= form_for(@comment) do |f| %>
  ... form elements ...
<% end %> 
```

但它给了我`undefined method 'comments_path'`错误。我确定我以非常错误的方式做这件事，因为我对示例有点困惑，`2.x`但是`3.x`如果您能给我指出一些好的示例，更好的宝石或只是写信告诉我应该如何做，我将非常感激：） 提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T06:51:27.217

确保您已经为评论控制器设置了路由。

```
# routes.rb
...
resources :comments
... 
```

更新：

根据下面的评论，这些路线嵌套在帖子下。在这种情况下，您将获得类似“#{RAILS_ROOT}/posts/1/comments”的路线，您可以（http）向其发表评论。但是，您的表单正在尝试发布到“#{RAILS_ROOT}/comments”，因此出现错误。在这种情况下，您需要在 posts/show.html.erb 中添加一个表单构建器：

```
<p>
  <b>Name:</b>
  <%= @post.name %>
</p>

<p>
  <b>Title:</b>
  <%= @post.title %>
</p>

<p>
  <b>Content:</b>
  <%= @post.content %>
</p>

<h2>Add a comment:</h2>
<%= form_for([@post, @post.comments.build]) do |f| %>
  <div class="field">
    <%= f.label :commenter %><br />
    <%= f.text_field :commenter %>
  </div>
  <div class="field">
    <%= f.label :body %><br />
    <%= f.text_area :body %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

请参阅从中提取此代码的[Rails 入门指南。](http://guides.rubyonrails.org/getting_started.html)

# google-chrome-extension - chrome 的“立即更新扩展”不起作用

> ID：10342564
> 
> 赞同：1
> 
> 时间：2012-04-26T22:57:33.400
> 
> 标签：google-chrome-extension, auto-update

我做了一个非常基本的 chrome 扩展并设置了一个简单的 node.js 服务器来测试自动更新。服务器托管 .crx 文件，因此我只需访问 .crx 即可轻松安装扩展程序`localhost:3000/clients/chrome/extension.crx`。但是当我去`tools->extensions`点击时`Update extensions now`，服务器没有收到请求。我原以为 chrome 会 GET `localhost:3000/clients/chrome/updates.xml`，但这并没有发生。我在这里做错了什么？

* * *

**代码**

让我引导您完成代码以使其可重现：

**$树**

```
.
|-- clients
|   `-- chrome
|       |-- extension
|       |   `-- manifest.json
|       |-- extension.crx
|       |-- extension.pem
|       `-- updates.xml
`-- web.js 
```

扩展实际上只是一个清单文件。

**清单.json**

```
{
  "name": "testing auto-updates",
  "version": "1.0",
  "update_url": "localhost:3000/clients/chrome/updates.xml",
  "description": "Version 1.0"
 } 
```

如您所见，我指的是使自动更新成为可能的 update_url。

**更新.xml**

```
<?xml version='1.0' encoding='UTF-8'?>
<gupdate xmlns='http://www.google.com/update2/response' protocol='2.0'>
  <app appid='fkphbmkcjefhhnnlhhjlnkellidponel'>
    <updatecheck codebase='localhost:3000/clients/chrome/extension.crx' version='1.0' />
  </app>
</gupdate> 
```

打包扩展会创建**extension.crx**和**extension.pem**。

我还制作了一个简单的 node.js 服务器来提供文件：

**网页.js**

```
var express = require('express');

var app = express.createServer(express.logger());

/* ROUTES */

app.get('/clients/chrome/extension.crx', function(request, response)
{
    response.contentType('application/x-chrome-extension');
    response.sendfile('clients/chrome/extension.crx');
});

app.get('/clients/chrome/updates.xml', function(request, response)
{
    response.sendfile('clients/chrome/updates.xml');
});

/* ROUTES END */

var port = process.env.PORT || 3000;

app.listen(port, function() {
  console.log("Listening on " + port);
}); 
```

好的，让我们测试一下。首先，启动服务器： **$ node web.js**

```
Listening on 3000 
```

通过访问 localhost:3000/clients/chrome/extension.crx 安装扩展。这部分在第二次尝试时工作正常。服务器记录两次尝试：

```
127.0.0.1 - - [Thu, 26 Apr 2012 22:22:50 GMT] "GET /clients/chrome/extension.crx HTTP/1.1" 200 596 "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.19 (KHTML, like Gecko) Ubuntu/11.10 Chromium/18.0.1025.151 Chrome/18.0.1025.151 Safari/535.19"
127.0.0.1 - - [Thu, 26 Apr 2012 22:25:47 GMT] "GET /clients/chrome/extension.crx HTTP/1.1" 304 - "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.19 (KHTML, like Gecko) Ubuntu/11.10 Chromium/18.0.1025.151 Chrome/18.0.1025.151 Safari/535.19" 
```

接下来，我转到工具-> 扩展并单击`Update extensions now`. 我希望 chrome 能够获取 updates.xml 文件以查看是否有任何更改，但服务器不会记录任何请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T00:57:34.163

试试`http://localhost:3000/clients/chrome/updates.xml`吧。

# entity-framework - 在 ASP.NET MVC 控制器中管理实体框架 ObjectContext 依赖注入的正确方法是什么？

> ID：10342566
> 
> 赞同：2
> 
> 时间：2012-04-26T22:57:42.080
> 
> 标签：entity-framework, dependency-injection, inversion-of-control

在我的 MVC 控制器中，我使用的是 IoC 容器（Ninject），但不确定如何最好地使用实体框架 ObjectContext。

目前，我正在做类似的事情：

```
using(var context = new MyObjectContext())
{
     var stuff = m_repository.GetStuff(context);
} 
```

从尽可能短的时间内保持数据库连接打开的角度来看，这是最好的管理方式。

如果我要根据每个请求通过 Ninject 创建 ObjectContext，这显然会使数据库连接打开太久。

上面的代码也会变成......

```
var stuff = m_repository.GetStuff(m_myObjectContext); 
```

（我什么时候处理上下文......？）

我应该为 ObjectContext 创建一个工厂并通过 DI 传递它吗？这会放松耦合，但是如果没有简单的方法来维护 ObjectContext 的接口（我知道），这真的有助于可测试性吗？

有没有更好的办法？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T07:27:32.903

> 从尽可能短的时间内保持数据库连接打开的角度来看，这是最好的管理方式。
> 
> 如果我要根据每个请求通过 Ninject 创建 ObjectContext，这显然会使数据库连接打开太久。

Entity Framework 将在执行每个查询后直接关闭连接（从外部提供打开的连接时除外），因此您执行此类操作的论点不成立。

过去，我曾经通过业务逻辑（准确地说是我的[命令处理程序](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=91)）控制上下文（创建、提交和处置它），但缺点是您需要将此上下文传递给所有其他方法和所有依赖项。当应用程序逻辑变得更复杂时，这会导致代码的可读性和可维护性降低。

出于这个原因，我转向了一个模型，在该模型中，工作单元（您的`MyObjectContext`）在业务逻辑的控制之外被创建、提交和处置。这允许您将工作单元注入所有依赖项并为所有对象重用相同的工作单元。缺点是这会使您的 DI 配置更加困难。您需要确保的一些事项：

1.  必须根据 Web 请求或在一定范围内创建工作单元。
2.  工作单元必须在请求或作用域的末尾被释放（尽管如果不释放它可能不是问题`DbContext`，因为底层连接已关闭并且`DbContext`没有实现终结器）。
3.  您需要明确提交工作单元，但您不能在 Web 请求结束时执行此操作，因为此时您不知道提交是否安全（因为您不想提交业务逻辑抛出异常，但在请求结束时无法正确检测这是否真的发生）。

我可以给您的一个提示是围绕[命令处理程序](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=91)对系统中的业务逻辑进行建模，因为这允许您定义一个处理事务行为（提交工作单元，甚至可能在数据库事务中运行所有内容）的单个装饰器一个点。这个装饰器可以包裹在系统中的每个处理程序周围。

我必须承认我不知道如何使用 Ninject 注册泛型类型和泛型装饰器，但是当您在 Stackoverflow 上提问时，您可能会很快得到答案。

# css - 如何获得清晰的css旋转文本？

> ID：10342567
> 
> 赞同：0
> 
> 时间：2012-04-26T22:57:47.877
> 
> 标签：css, transform, rotation

我在网站的布局中使用 css3 转换来获得一些“活泼”的角度，它确实影响了文本的易读性。这是我正在谈论的一个例子......

[http://rotatetest.s3-external-3.amazonaws.com/index.html](http://rotatetest.s3-external-3.amazonaws.com/index.html)

上面示例中的文本使用 css 转换和 jquery 插件进行比较，两者都产生相同的锯齿状结果。

有没有什么技术可以让结果更流畅，也许是使用画布的东西？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T14:53:51.363

You could try font-smooth but I doubt that this will solve your problem:

[https://developer.mozilla.org/en/CSS/font-smooth](https://developer.mozilla.org/en/CSS/font-smooth)

(BTW: The jQuery and CSS examples both use the same css transform so they are equivalent - no need to post both)

# vim - NERDCommenter：在 html 文件中给我 js 评论

> ID：10342568
> 
> 赞同：6
> 
> 时间：2012-04-26T22:57:53.393
> 
> 标签：vim

我正在编辑一个 html 文件，但是当我调用 NERD 评论器时，它正在添加 js 评论 ( `/*...*/`) 而不是 html评论 ( `<!-- ... -->`)。我刚刚安装了最新版本（2.3.0）并且正在使用 vim 7.3。

我怎样才能解决这个问题？

谢谢

编辑：深入研究，我在 NERD_commenter.vim 的源代码中找到了所有支持的文件类型的列表。奇怪的是，xhtml 和 html 并没有出现在列表中：

```
\ 'htmlcheetah': { 'left': '##' },
\ 'htmldjango': { 'left': '<!--','right': '-->', 'leftAlt': '{#', 'rightAlt': '#}' },
\ 'htmlos': { 'left': '#', 'right': '/#' }, 
```

我觉得这在某种程度上是不对的。另外，额外的问题：假设你让 html 评论工作，这个插件可以检测光标何时在`<script>`标签之间并在它的时候将评论更改为 js 评论？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T00:35:33.807

深入研究 NERD-commenter 代码，似乎当文件类型不在其列表中时，它会从名为`&commentstring`. 我的猜测是`&commentstring`html 文件的其他一些插件/配置已更改（可能是为了更好地支持 javascript 注释）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-19T07:05:16.020

从[以下 PR 添加 hooks](https://github.com/scrooloose/nerdcommenter/pull/249)开始，NERDCommenter 允许配置特定于文件中语言块的注释样式。

这是为支持`.vue`文件而构建的，这些文件与常规 HTML 文件不同，具有`<template>`(html) 块、a`<script>`和`<style>`块，每个文件都需要独特的注释语法。

您可以[在文档的 Hooks 部分](https://github.com/scrooloose/nerdcommenter/blob/057f6150bdb11124bcb63e85f5445fae47f383c3/doc/NERD_commenter.txt#L396-L423)`vue`找到示例实现。如果您选择这样做，它可能有助于指导您为与框架无关的 HTML 文件编写一个。

# datagrid - Flash Builder：用户单击标题时如何对火花数据网格列进行排序？

> ID：10342570
> 
> 赞同：0
> 
> 时间：2012-04-26T22:58:01.557
> 
> 标签：datagrid, flash-builder

当用户单击单个列的标题时，我正在尝试对 spark datagrid 列进行排序。我搜索了谷歌，但没有找到任何好的教程。如果这里有人可以帮助我，我将不胜感激。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T11:34:40.910

你设置`sortableColumns`了`true`吗？因为实际上如果设置了该属性，它应该可以立即使用。

# animation - 动画 div 闪光灯

> ID：10342574
> 
> 赞同：0
> 
> 时间：2012-04-26T22:58:13.437
> 
> 标签：animation, css

如何像这个网站一样为加上一个 div 制作动画...我只是复制和粘贴 css 但什么也没发生。

[http://vbiran.ir](http://vbiran.ir)

请帮我做这样的事情

我的代码是这样的`googleplus{position:absolute;top:100px;right:310px;background:#F3EBDB;border:1px solid #C3B8A3;padding:14px 6px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;animation:googleplus 2s infinite;-moz-animation:googleplus 2s infinite;-webkit-animation:googleplus 2s infinite;font-family:BKoodakBold !important}`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T00:58:45.620

这是用 CSS3 动画制作的。您指定动画的名称，然后使用`@keyframes`属性对其进行描述。有关更多详细信息，请参见[此处](http://www.w3schools.com/css3/css3_animations.asp)，[这里是工作示例](http://jsfiddle.net/Shevchuk/56RAm)。

# jsf - jsf post redirect get 模式的好习惯

> ID：10342576
> 
> 赞同：1
> 
> 时间：2012-04-26T22:58:27.353
> 
> 标签：jsf, post, redirect, get, design-patterns

我使用带有 Facelets 的 JSF 2.1.7 Mojarra，我的大部分页面都是杂乱无章的页面，由视图范围的托管 bean 支持，使用发布到同一页面（返回“”）。根据我在 bean 中的标志，我将我想要的 html 代码（结果列表、插入/编辑/删除的表单）呈现到 crud 页面中。

在良好的实践、良好的设计、任何 webapp 的良好运行等方面......使用 PRG 模式更好吗？如果不使用 PRG 会不会有什么严重的问题？

就我而言，我正在考虑使用 PRG，但我认为这很乏味，因为 f:viewparams 必须用于任何表单字段，并且更改所有页面是一项艰巨（乏味）的工作。我错了吗？我必须在 JSF 中将 POST 转换为 GET 进行哪些更改？

我考虑使用 PRG 的原因（除了显示警报弹出窗口的糟糕用户体验）是我在会话已经超时时发布表单的问题。

谢谢你。

# templates - Handlebars - 将 {{x}} 语法替换为 <%x%> 或类似的

> ID：10342580
> 
> 赞同：0
> 
> 时间：2012-04-26T22:59:17.397
> 
> 标签：templates, jsp-tags, ember.js, mustache, handlebars.js

我发现了有趣[的 Ember.js](http://emberjs.com/)框架，它使用[Handlebars.js](http://handlebarsjs.com/)作为视图模板。但是，我的服务器端模板语言[Latte](http://doc.nette.org/en/templating)禁止`{{variable}}`在 HTML 页面上键入内容。例如，有什么方法可以设置车把以使用不同的标志`<%variable%>`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T00:42:36.447

这并不能直接回答您的问题，因为我认为这是不可能的，但您不必在 html 中包含任何把手。您可以将所有 ember html 放入车把文件中，然后在编辑和保存文件时预编译它们（将它们转换为 javascript）。从那里您可以将它们作为 javascript 提供并在客户端附加这些视图。

[http://handlebarsjs.com/precompilation.html](http://handlebarsjs.com/precompilation.html)

根据您的编辑器/操作系统，有很多工具可以监视目录并在修改文件时执行脚本。这种做法也用于咖啡脚本。

也可以在没有把手的情况下使用 ember，但您确实会丢失绑定。

# javascript - 浏览#！对于非 JavaScript 用户

> ID：10342583
> 
> 赞同：0
> 
> 时间：2012-04-26T22:59:47.770
> 
> 标签：javascript, ajax

我网站上的所有链接都包含google`#!`为ajax 网站 [提出的链接。](https://developers.google.com/webmasters/ajax-crawling/)

对于 URL 的实例，`http://site.com/#!/about`会自动转换为`http://site.com/?_escaped_fragment_=about`.

有没有办法让非 JavaScript 能够像 Google 一样浏览这些 URL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:16:56.010

不，阿法克。相反，为了获得一致的 URL，您可能希望摆脱`#!`那些拥有 JS 的用户——例如，请参阅[https://github.com/defunkt/jquery-pjax 。](https://github.com/defunkt/jquery-pjax)

# spring - IntelliJ：JSP 页面中的 Spring MVC bean 未解析

> ID：10342586
> 
> 赞同：4
> 
> 时间：2012-04-26T22:59:56.807
> 
> 标签：spring, jsp, spring-mvc, intellij-idea

当我像这样在spring mvc中放入模型时：

```
@RequestMapping(method = RequestMethod.GET)
public String createForm(Model model) {
    model.addAttribute("item", new Item());
    return "item/new";
} 
```

IntelliJ 在相应的 JSP 页面中未解析 bean“项目”。我的意思是，它工作得非常好，但自动完成不能：/

在这种情况下有什么办法可以自动完成？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-27T06:39:18.620

IntelliJ 的 JSP 支持理解一种特殊的注释注释：

```
<%--@elvariable id="foo" type="com.yourcompany.YourClass"--%> 
```

如果您将此注释放在文件的顶部，idea 将`${foo.`根据类的属性为以开头的表达式提供自动补全`com.yourcompany.YourClass`

`foo`如果您将鼠标悬停在表达式的一部分上，IntelliJ 还将提供创建此注释。

# c++ - 在 C++ 中使用默认构造函数进行隐式构造

> ID：10342593
> 
> 赞同：0
> 
> 时间：2012-04-26T23:01:00.240
> 
> 标签：c++, default-constructor, juce

我创建了一个简单的类来传递给 Juce 数组的排序方法 [http://www.rawmaterialsoftware.com/api/classArray.html#ac1dca4ab2895315dd85e25eaca2fcab1](http://www.rawmaterialsoftware.com/api/classArray.html#ac1dca4ab2895315dd85e25eaca2fcab1)

它看起来像这样：

```
class XComparison
{
public:
    static int compareElements (StraightPath first, StraightPath second)
    {
        return (int) (first.xOrigin - second.xOrigin);
    }
}; 
```

当我创建一个传递给比较器的实例时，这两个工作：

```
XComparison x;
XComparison x = XComparison(); 
```

但这给了我一个编译器错误：

```
XComparison x(); 
```

[http://juce.git.sourceforge.net/git/gitweb.cgi?p=juce/juce;a=blob](http://juce.git.sourceforge.net/git/gitweb.cgi?p=juce/juce;a=blob;f=modules/juce_core/containers/juce_ElementComparator.h;h=f976c40c7741b3df30d10e699c282a3569a49e3c;hb=HEAD#l74)的第 74、101、119 行上的“'.compareElements' 的左侧必须有类/结构/联合” [;f=modules/juce_core/containers/juce_ElementComparator.h;h=f976c40c7741b3df30d10e699c282a3569a49e3c;hb=HEAD#l74](http://juce.git.sourceforge.net/git/gitweb.cgi?p=juce/juce;a=blob;f=modules/juce_core/containers/juce_ElementComparator.h;h=f976c40c7741b3df30d10e699c282a3569a49e3c;hb=HEAD#l74)

为什么隐式分配在这里不起作用？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T23:04:40.393

X比较 x(); 被解析为 x 的函数声明，它不接受任何参数并返回 XComparison。

[http://yosefk.com/c++fqa/ctors.html#fqa-10.19](http://yosefk.com/c++fqa/ctors.html#fqa-10.19)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T23:03:51.843

您正在声明一个函数而不是一个表达式，这就是您收到错误的原因。

```
XComparison x; // default construction, unitialised
XComparison x = XComparison(); // construct x from default constructor
XComparison x(); // all you are doing is declaring a function x that returns XComparison 
```

请参阅此[C++ 常见问题解答](http://www.parashift.com/c++-faq-lite/new/fn-decl-vs-obj-instantiation.html)

# android - 如何在android进度条上设置延迟

> ID：10342594
> 
> 赞同：0
> 
> 时间：2012-04-26T23:01:03.453
> 
> 标签：android, xml, loading, android-progressbar

我想要的是设置它，以便进度条加载 15 秒，然后继续下一个活动。

现在活动有：

```
public class MainActivity extends Activity {

  /** Called when the activity is first created. */
  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Button btn5 =(Button)findViewById(R.id.button);

    btn5.setOnClickListener(new Button.OnClickListener() {

      public void onClick(View v) {
        Intent myIntent = new Intent();

        myIntent.setAction(Intent.ACTION_VIEW);

        myIntent.setData(android.provider.MediaStore.Images.Media.INTERNAL_CONTENT_URI);
        setContentView(R.layout.loading);

      }        
    });
  }

} 
```

xml页面有：

```
<ProgressBar
    android:id="@+id/progressBar1"
    style="?android:attr/progressBarStyleHorizontal"
    android:layout_width="match_parent"
    android:layout_height="144dp"
    android:layout_gravity="center_vertical" /> 
```

我想知道如何使 progressBar1 加载 15 秒，然后转到 result.xml

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T00:16:18.017

查看 sdk 示例代码中包含的 api 演示中的进度对话框示例。我相信它在 /src/com/example/android/apis/app/AlertDialogSamples.java 中。如果您查看最底部，则它具有通过时间延迟消息更新进度条的代码。

您的问题有点不清楚，您发布的第一个或第二个活动的代码是什么

# javascript - 使用 jQuery 替换和正则表达式替换字符串

> ID：10342596
> 
> 赞同：1
> 
> 时间：2012-04-26T23:01:13.230
> 
> 标签：javascript, jquery, html, regex

我目前正在使用 .replace 函数来替换页面上的特定字符串。鉴于我不知道当前字符串的位置，所以我无法选择它，我的代码如下所示：

```
$('body').html( $('body').html().replace(regex, 'sometext') ); 
```

因此，如果页面最初看起来像这样：

```
<div class="a">Hello</div>

It now looks like this:

<div class="a">sometext</div> 
```

有没有办法在不使用的情况下做到这一点`$('body').html( $('body').html().replace() )`？

谢谢！

编辑：示例

```
<p class="last">Mac, iPhone, iPod and iPad customers within 90 days of ownership are eligible for complimentary phone support — one support incident per iPod and unlimited incidents per Mac, iPhone and iPad. <a href="/support/" onclick="s_objectID=&quot;http://www.apple.com/support/_3&quot;;return this.s_oc?this.s_oc(e):true">Online technical support</a> for Apple products is available beyond the initial 90 days.</p> 
```

使用这个：

```
$('body').html( $('body').html().replace("iPhone", '<a href="#">iPhone</a>') ); 
```

它将替换 iPhone 的每个实例，使其看起来像 iPhone

导致：

```
<p class="last">Mac, <a href="#">iPhone</a>, iPod and iPad customers within 90 days of ownership are eligible for complimentary phone support — one support incident per iPod and unlimited incidents per Mac, <a href="#">iPhone</a> and iPad. <a href="/support/" onclick="s_objectID=&quot;http://www.apple.com/support/_3&quot;;return this.s_oc?this.s_oc(e):true">Online technical support</a> for Apple products is available beyond the initial 90 days.</p> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:39:11.857

您可以逐个节点遍历 DOM 层次结构，检查文本节点，然后比较每个单独文本节点中的文本。这将消除您当前代码可能导致的损坏类型。它将避免像您当前的代码那样破坏所有事件处理程序。

[仅供参考，这是我为不同答案](https://stackoverflow.com/a/9549882/816620)编写的不同函数的修改，可以满足您的要求：

```
function replaceTextInDomTree(root, searchRegEx, replace) {
    var node = root.firstChild;
    while(node) {
        if (node.nodeType == 3) {
            if (searchRegEx.test(node.nodeValue)) {
                // we do the test first to avoid setting 
                // nodeValue when there's no change
                // to perhaps save the browser some layout time
                // since we'd be operating on every single text node
                node.nodeValue = node.nodeValue.replace(searchRegEx, replace);
            }
        }
        if (node.hasChildNodes()) {
            // go down into the children
            node = node.firstChild;
        } else {
            while (!node.nextSibling) {
                node = node.parentNode;
                if (node == root) {
                    return;
                }
            }
            node = node.nextSibling;
        }
    }
} 
```

笔记：

1) 这将仅替换连续文本块中的文本，其中没有 HTML 标记。

2）如果您想在同一个文本节点中进行多次替换，请确保将 g 标记为您传入的正则表达式。

# android - 拥有手机和平板电脑布局

> ID：10342597
> 
> 赞同：1
> 
> 时间：2012-04-26T23:01:14.537
> 
> 标签：android, android-layout

我通读了有关[支持两者](http://developer.android.com/guide/practices/tablets-and-handsets.html)的 android 文档，但没有真正解释的是您如何知道何时调用手机的活动和平板电脑的活动？

我的意思是说在平板电脑上我有 2 个片段、一个列表视图和一些其他片段，这些片段会根据列表视图的点击而改变。现在在手机上，我显然不想要那个平板视图，因为一切都太紧凑了，所以我想用列表视图开始一个活动，然后用另一个片段转到另一个活动。

我知道不同的布局文件夹类型，并且我已经使用它来跨屏幕尺寸调用该布局`layout`，但是常规布局视图没有所有部分，因为那是手机布局，那么我该如何处理呢？ `layout-sw600dp``layout-sw720dp`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:50:10.337

Google [I/O 应用程序](http://code.google.com/p/iosched/)就是一个很好的例子。基本上，您有不同的布局，其中包含针对不同设备的不同片段。由于每个 Fragment 都像 Activity 一样管理自己，除了创建 Fragment 布局之外，您无需做太多事情。

还有一个很好的[视频](http://www.youtube.com/watch?v=WGIU2JX1U5Y)，解释了很多关于该应用程序的信息。

# asp.net-mvc-3 - 正在控制器上执行的 Url Helper 操作

> ID：10342599
> 
> 赞同：0
> 
> 时间：2012-04-26T23:01:29.863
> 
> 标签：asp.net-mvc-3, t4mvc

我不确定发生了什么，但控制器中正在执行以下操作。为什么会这样做？它不应该只是呈现 URL。_schoolsService 为空，但我使用的是 Ninject。我删除了 Action 上的属性并收到了同样的东西。

```
<a href="#" data-bind="click: manage.teacher.changeSchools.open.bind($data, true, '@(Url.Action(MVC.Schools.GetDistrictSchoolsForUser(Model.Teacher.Id)))')">Change</a>) 
```

MVC.Schools 是一种 T4MVC 方法。

```
[HttpPost, NatGeoUserAccessAuthorization]
        public virtual ActionResult GetDistrictSchoolsForUser(string id)
        {
            return Json(_schoolsService.GetDistrictSchoolsForUserId(id), JsonRequestBehavior.AllowGet);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:39:45.477

我再次为 T4MVC 运行了自定义工具，它必须重新生成一些东西来纠正问题。它现在正在工作。

# mysql - SHOW FIELDS 查询可以使用 ORDER BY 吗？

> ID：10342600
> 
> 赞同：1
> 
> 时间：2012-04-26T23:01:55.260
> 
> 标签：mysql

[文档](http://dev.mysql.com/doc/refman/5.0/en/extended-show.html)没有提到 ORDER BY 并且我没有运气来表达这个查询：

```
SHOW FIELDS FROM `TB_Main`  WHERE Type = 'mediumtext' OR Type = 'bit(1)' ORDER BY Field; 
```

我必须在我的脚本中进行排序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:03:43.123

您可以直接查询信息架构表。正如[手册所说](http://dev.mysql.com/doc/refman/5.0/en/columns-table.html)：

> 以下语句几乎是等价的：
> 
> ```
> SELECT COLUMN_NAME, DATA_TYPE, IS_NULLABLE, COLUMN_DEFAULT
>   FROM INFORMATION_SCHEMA.COLUMNS
>   WHERE table_name = 'tbl_name'
>   [AND table_schema = 'db_name']
>   [AND column_name LIKE 'wild']
> 
> SHOW COLUMNS
>   FROM tbl_name
>   [FROM db_name]
>   [LIKE 'wild'] 
> ```

您可以将`ORDER BY`子句应用于第一种类型的语句，因为它是一个普通`SELECT`命令。

因此，代替您的`SHOW`命令，您可以执行以下操作：

```
SELECT COLUMN_NAME, DATA_TYPE, IS_NULLABLE, COLUMN_DEFAULT
FROM INFORMATION_SCHEMA.COLUMNS
WHERE
      TABLE_NAME = 'TB_Main'
  AND COLUMN_TYPE IN ('mediumtext', 'bit(1)')
ORDER BY COLUMN_NAME; 
```

# ios - NativeControls 或 ActionSheet Cordova 插件文档？

> ID：10342601
> 
> 赞同：4
> 
> 时间：2012-04-26T23:01:56.163
> 
> 标签：ios, uiactionsheet, cordova

我已经看到很多关于在 NativeControls 插件中使用 TabBar 或 ToolBar 的文档，但是，使用 ActionSheet 几乎为零。

我遵循了 ActionSheet 插件的 README： [https ://github.com/phonegap/phonegap-plugins/tree/master/iOS/ActionSheet](https://github.com/phonegap/phonegap-plugins/tree/master/iOS/ActionSheet)

我已经让它工作了，但这些例子创建了不做任何事情的按钮。我想创建一个具有“推文”按钮、“在 Facebook 上分享”按钮、“电子邮件”按钮和取消的 ActionSheet，并且显然会触发 Javascript 以访问 Twitter 和 Facebook-Connect 功能。

有没有人使用 NativeControls/ActionSheet 插件作为创建共享按钮的一种方式？或者任何类型的真正具有某种功能的按钮。我只是在寻找某种模板。

我没有成功从 NativeControls 插件创建 ActionSheet。我正在使用 Cordova 1.6.1、Xcode 4.3.2 和来自 GitHub 的最新插件。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T23:17:58.177

一个应用程序可能有一个带有 onclick="selectAction();" 的按钮 如果用户选择“相机”，则将调用 capturePhoto()。如果他们选择“照片库”，则将调用 getPhoto()。

```
function selectAction() {
var actionSheet = window.plugins.actionSheet;
actionSheet.create('Select Image Source', ['Camera', 'Photo Library', 'Cancel'], function(buttonValue, buttonIndex) {
   switch (arguments[1]) {
       case 0:
       capturePhoto();
       break;
       case 1:
       getPhoto(pictureSource.PHOTOLIBRARY);
       break;
       default:
       console.log('selectAction default case says: go back to page1');
   }
   }, {cancelButtonIndex: 2}); 
} //End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T05:13:24.253

我刚刚创建了一个与[Cordova ActionSheet 插件](https://github.com/EddyVerbruggen/cordova-plugin-actionsheet)类似的示例 ActionSheet 。

如果您也使用[SocialSharing 插件](https://github.com/EddyVerbruggen/SocialSharing-PhoneGap-Plugin)，您可以根据返回的 buttonIndex调用`shareViaFacebook`和从 ActionSheet 插件的回调中调用。`shareViaTwitter`

![Cordova ActionSheet 插件正在运行](../Images/75cc73c67e7dd6709aab755470dec575.png)

# delphi - 如何在具有透明度和不透明度的画布上绘画？

> ID：10342603
> 
> 赞同：12
> 
> 时间：2012-04-26T23:02:13.153
> 
> 标签：delphi, delphi-xe

**概述**

从 GR32 库中，我使用 TImgView32 来渲染一个网格，这将是我的透明背景，如下所示：

![在此处输入图像描述](../Images/f7c72db450ccabf9a78ce61a5a31571e.png)

放置在 TImgView32 内，我有一个常规的 TImage，我将在其中绘制到画布上，如下所示：

![在此处输入图像描述](../Images/686b7851a16fc7418cb7e2c29ae21039.png)

**任务**

我想要实现的是能够设置画笔的不透明度，从而为我的程序中的图像编辑提供更多可能性。设置画笔的不透明度允许不同级别的颜色深度等，而不是绘制一种平面颜色。

我早些时候在四处搜索时发现了这个问题：[Draw opacity ellipse in Delphi 2010](https://stackoverflow.com/questions/4916913/draw-opacity-ellipse-in-delphi-2010/4917296#comment13314494_4917296) - Andreas Rejbrand 在他对该问题的回答中提供了一些示例。

我看过 Andreas 做了什么，并想出了我自己的简化尝试，但我遇到了一个问题。看看下面这两张图片，第一张是透明背景，第二张是黑色背景，更清楚地显示问题：

![在此处输入图像描述](../Images/cd037e94463b988adf0d3a86497a5f36.png) ![在此处输入图像描述](../Images/f7b0e8fc1f771be6d8f54e13cc92b0c8.png)

如您所见，画笔（圆圈）周围是一个非常烦人的正方形，我无法摆脱。所有应该可见的是画笔。这是我用来产生这些结果的代码：

```
procedure DrawOpacityBrush(ACanvasBitmap: TBitmap; X, Y: Integer;
  AColor: TColor; ASize: Integer; Opacity: Integer);
var
  Bmp: TBitmap;
begin
  Bmp := TBitmap.Create;
  try
    Bmp.SetSize(ASize, ASize);
    Bmp.Transparent := False;

    with Bmp.Canvas do
    begin
      Pen.Color := AColor;
      Pen.Style := psSolid;
      Pen.Width := ASize;
      MoveTo(ASize div 2, ASize div 2);
      LineTo(ASize div 2, ASize div 2);
    end;

    ACanvasBitmap.Canvas.Draw(X, Y, Bmp, Opacity);
  finally
    Bmp.Free;
  end;
end;

procedure TForm1.Image1MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  DrawOpacityBrush(Image1.Picture.Bitmap, X, Y, clRed, 50, 85);
end; 
```

在常规位图上产生：

![在此处输入图像描述](../Images/fe1c22048907add1e41d67e043ed298b.png)

我的想法（基于 Andreas 创建具有不透明度的椭圆的方法）是在画布上渲染一个典型的画笔，将其分配给屏幕外位图，然后将其重新绘制到具有不透明度的主位图上。哪个有效，除了边缘周围的那个烦人的正方形。

**如屏幕截图所示，如何渲染具有不透明度的画笔，但在画笔圆圈周围没有那个正方形？**

如果我设置`Bmp.Transparent := True`仍然有一个白框，但不再不透明。只是一个实心的白色正方形和实心填充的红色圆圈。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-27T00:39:10.900

的不透明度功能`TCanvas.Draw()`不支持您尝试执行的操作，至少不支持您尝试使用它的方式。为了达到你想要的效果，你需要创建一个 32 位`TBitmap`，这样你就有一个每像素的 alpha 通道，然后为每个像素填充 alpha，将你不想要的像素的 alpha 设置为 0，并将alpha 到您想要的像素所需的不透明度。然后，在调用 时`TCanvas.Draw()`，将其不透明度设置为 255 以告诉它仅使用每像素不透明度。

```
procedure DrawOpacityBrush(ACanvas: TCanvas; X, Y: Integer; AColor: TColor; ASize: Integer; Opacity: Byte);
var
  Bmp: TBitmap;
  I, J: Integer;
  Pixels: PRGBQuad;
  ColorRgb: Integer;
  ColorR, ColorG, ColorB: Byte;
begin
  Bmp := TBitmap.Create;
  try
    Bmp.PixelFormat := pf32Bit; // needed for an alpha channel
    Bmp.SetSize(ASize, ASize);

    with Bmp.Canvas do
    begin
      Brush.Color := clFuchsia; // background color to mask out
      ColorRgb := ColorToRGB(Brush.Color);
      FillRect(Rect(0, 0, ASize, ASize));
      Pen.Color := AColor;
      Pen.Style := psSolid;
      Pen.Width := ASize;
      MoveTo(ASize div 2, ASize div 2);
      LineTo(ASize div 2, ASize div 2);
    end;

    ColorR := GetRValue(ColorRgb);
    ColorG := GetGValue(ColorRgb);
    ColorB := GetBValue(ColorRgb);

    for I := 0 to Bmp.Height-1 do
    begin
      Pixels := PRGBQuad(Bmp.ScanLine[I]);
      for J := 0 to Bmp.Width-1 do
      begin
        with Pixels^ do
        begin
          if (rgbRed = ColorR) and (rgbGreen = ColorG) and (rgbBlue = ColorB) then
            rgbReserved := 0
          else
            rgbReserved := Opacity; 
          // must pre-multiply the pixel with its alpha channel before drawing
          rgbRed := (rgbRed * rgbReserved) div $FF;
          rgbGreen := (rgbGreen * rgbReserved) div $FF;
          rgbBlue := (rgbBlue * rgbReserved) div $FF;
        end;
        Inc(Pixels);
      end;
    end;

    ACanvas.Draw(X, Y, Bmp, 255);
  finally
    Bmp.Free;
  end;
end;

procedure TForm1.Image1MouseDown(Sender: TObject; Button: TMouseButton;  
  Shift: TShiftState; X, Y: Integer);  
begin  
  DrawOpacityBrush(Image1.Picture.Bitmap.Canvas, X, Y, clRed, 50, 85);  
end; 
```

# tsql - SQL Server 锁定并发表

> ID：10342611
> 
> 赞同：0
> 
> 时间：2012-04-26T23:02:51.017
> 
> 标签：tsql, sql-server-2008-r2

我有以下情况：

*   由多个程序访问（更新、删除、插入和选择）的表。实际上它们是相同的，但由多个用户实例化。该表永远不会增长到超过 1000 行，因为程序会在使用后删除数据并再次插入新数据。这就像供应商/收藏家的情况。

*   由于这是一个工业生产场景，我必须保证一些操作，所以当用户确认任何操作时，程序会使用来自系统上其他表的数据更新该表。

所以我们在很多命令上实现了事务，结果是很多死锁的情况。

我想要一些关于我们可以做些什么来避免这些锁的提示。实际上我们不需要事务，我们只需要保证一个命令会运行，如果由于某种原因它失败了，整个操作就会被回滚。我不知道是否有办法在不使用事务的情况下做到这一点。

PS：我们使用的是 SQL Server 2008 R2。

PS2：我发现我在更新的 FROM 子句中使用的一些系统表是个大问题。这些表用于整个系统并获得大量的插入/更新/选择。所以我只是锁定了不应该的东西，因为我没有使用这个程序更改该表上的数据。

前任：

```
 Update t1
   set x= 1
   from systable1 as t
   inner join systable2 t2
   where ..... 
```

我想这是个大问题，所以我`WITH (NOLOCK)`在 t 和 t2 以及`WITH (ROWLOCK)`t1 上添加了提示。

我必须提到的另一件事是，这是一个测试环境，我们正在最大程度地强调数据库和程序，因为我们不能冒险在生产中失败。

如果失败，我可以使用检查点策略重新执行操作吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:12:18.613

您可以通过使用 READ UNCOMMITTED 来消除锁定问题（请参阅[为什么使用 READ UNCOMMITTED 隔离级别？](https://stackoverflow.com/questions/2471055/why-use-a-read-uncommitted-isolation-level)和[http://msdn.microsoft.com/en-us/library/aa259216(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa259216(v=sql.80).aspx)） . 但请注意，这可能会导致读取不一致或不一定会保留在数据库中的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:22:49.260

使用 readuncommitted 是一种可能的解决方案，尽管它会产生连锁反应。不过，我会先尝试行锁。SQL Server 对页锁进行了优化以减少记录上的锁数量，因为您只有一千条记录，除非它们非常宽，页锁将锁定其中的好几条。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T23:24:40.750

首先对 Transaction 中的所有查询进行性能调优。有时，通过添加索引来加速事务内部的查询可能会对您看到的死锁数量产生很大影响。

此外，保持事务尽可能小，以便在出现故障时实现所需的回滚。例如，如果您有 5 个查询来查找数据，但只有 3 个查询会更改数据，那么您可以将事务缩减为仅更改数据的 3 个查询。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T00:40:01.137

首先，是的，您需要事务来确保成功或失败（回滚）。只有 1,000 条记录？那张桌子一定被插入/更新/删除撞到了！所以对我来说，这听起来像是一个繁重的事务表——所以要小心添加索引，因为它们只会让你的插入/更新/删除变慢。而且我必须确认您的繁重事务表上没有触发器，对吗？

那么你的阅读量呢？有没有想过分离出报表或其他东西？复制可能是矫枉过正。数据需要多么准确和最新？

最后 - 个人资料，个人资料，个人资料。

# c++ - C++ 重载 operator= 在构造时用于不同的 rhs 类型

> ID：10342613
> 
> 赞同：1
> 
> 时间：2012-04-26T23:03:31.650
> 
> 标签：c++, char, operator-overloading

我编写了一个`Tag`将标签保存为字符串并允许对其进行操作的类。为了便于使用，我重载了`operator=`for 类字符串类型。到目前为止我得到了什么：

```
Tag& Tag::operator=(const std::string& rhs)
{
    setTag(rhs);
    return *this;
}

Tag& Tag::operator=(const char* rhs)
{
     setTag(rhs);
     return *this;
} 
```

（其中和`setTag()`重载）。大部分用法都包含在此范围内：`std::string``char`

```
 Tag tag1 = std::string("lala");
 Tag tag2;
 tag2 = std::string("lala2");
 Tag tag3;
 tag3 = "lala"; 
```

但是，最“基本”的一个不会计算：

```
 Tag tag4 = "lala"; 
```

它给了我这个错误：

```
 conversion from 'const char [5]' to non-scalar type 'Tag' requested 
```

我怎样才能解决这个问题？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T23:07:49.733

最后一个不是`operator=()`- 你需要一个带有`char const*`.

```
Tag(char const* s); 
```

# javascript - 谷歌地图侦听器上下文

> ID：10342615
> 
> 赞同：-1
> 
> 时间：2012-04-26T23:03:42.140
> 
> 标签：javascript, google-maps-api-3, scope

我需要一个谷歌地图标记来响应由地图（空闲）触发的事件。该事件触发一个函数。这个函数应该作用于 Marker，但当然，“this”指的是地图。如何在函数内部引用设置事件侦听器的标记。

每个 Marker 都会向地图添加一个空闲侦听器。我可以跟踪所有标记，并在地图空闲事件中循环它们并触发该功能，但我希望使用更禅宗的方法。

我目前的方法是这样的：

```
var self=newMarker;
google.maps.event.addListener(window.gmap,'idle',function(){
    self.setVisible(false); }); 
```

但它似乎只适用于 1 个标记。“newMarker”是我试图从事件内部访问的标记对象，正如我所说的有多个标记，所以我不能只将它存储在全局变量或任何东西中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T11:37:55.007

使用 jQuery 的“代理”，[jQuery Proxy](http://api.jquery.com/jQuery.proxy/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T00:51:05.697

我可以为您看到 2 个基本选项：

1 - 创建一个`Array`标记，实现一个`function`传递给`addListener`的标记，然后在事件触发函数回调时循环标记：

```
var markerList = new Array();
//build the markers and add them to markerList with multiple calls to push...
google.maps.event.addListener( window.gmap, "idle", function() {
    for ( var i = 0; i < markerList.length; i++ ) {
        markerList[i].setVisible( false );
    }
}); 
```

2 - 添加一个新的回调函数`google.maps.Marker.prototype`并多次调用`addListener`，以便每个标记接收自己的事件通知：

```
google.maps.Marker.prototype.idleCallback = function() {
    this.setVisible( false );
};

var newMarker1 = new google.maps.Marker( opts1 );
google.maps.event.addListener( window.gmap, "idle", newMarker1.idleCallback );
var newMarker2 = new google.maps.Marker( opts2 );
google.maps.event.addListener( window.gmap, "idle", newMarker2.idleCallback );
//and repeat for each marker; you get the idea 
```

我自己，我总是选择选项 1，我坚持这种方法。我担心将许多侦听器附加到 Map 会降低性能。此外，它还涉及在 google 代码原型中乱搞。

但这是一个有趣的想法。如果你试一试这样的事情，请告诉我它是如何执行的以及它对你的效果如何。

# javascript - 通过滑块移动更改滑块值

> ID：10342621
> 
> 赞同：1
> 
> 时间：2012-04-26T23:04:13.433
> 
> 标签：javascript, variables, user-interface, slider

我的滑块值有问题。我希望 var R、G 和 B 随滑块而变化。目前它们只有在我停止使用滑块后才会改变。有任何想法吗？

```
var R = $("#RSlider").slider('value');
var G = $("#GSlider").slider('value');
var B = $("#BSlider").slider('value');

var colour = R + 256 * G + 65536 * B;
document.getElementById('color').innerHTML = colour.toString(16);

$("#BSlider").slider({
value: props["col1"].toFixed(2).replace('-',''),
step: 5,
min: 100,
max: 255,
slide: function(event, ui) {
}
});

$("#GSlider").slider({
value: props["col2"].toFixed(2).replace('-',''),
step: 5,
min: 100,
max: 255,
slide: function(event, ui) {
}
});

$("#RSlider").slider({
    value: props["col3"].toFixed(2).replace('-',''),
step: 5,
min: 100,
max: 255,
slide: function(event, ui) {                    
} 
```

});

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T00:00:05.303

好吧，我假设您使用的是 jQuery UI。如果是这样，您只需要使用“幻灯片”回调，而不是您现在使用的空函数。

```
function print_color() {
    var R = $("#RSlider").slider('value');
    var G = $("#GSlider").slider('value');
    var B = $("#BSlider").slider('value');

    var colour = R + 256 * G + 65536 * B;
    //document.getElementById('color').innerHTML = colour.toString(16);
    $('#color').html(colour.toString(16));
}

$("#BSlider").slider({
    //These are giving me errors and I'm not sure what they do, so I'm commenting them out.
    //value: props["col1"].toFixed(2).replace('-', ''),
    step: 5,
    min: 100,
    max: 255,
    slide: print_color
});

$("#GSlider").slider({
    //value: props["col2"].toFixed(2).replace('-', ''),
    step: 5,
    min: 100,
    max: 255,
    slide: print_color
});

$("#RSlider").slider({
    //value: props["col3"].toFixed(2).replace('-', ''),
    step: 5,
    min: 100,
    max: 255,
    slide: print_color
});

print_color(); 
```

小提琴，如果你想要的话：http: [//jsfiddle.net/luhn/5b4Kc/](http://jsfiddle.net/luhn/5b4Kc/)

# iphone - iPhone：ABPeoplePickerNavigationController 不会在 UITabBarController 中正确显示

> ID：10342624
> 
> 赞同：2
> 
> 时间：2012-04-26T23:04:25.857
> 
> 标签：iphone, objective-c, ios, uitabbarcontroller

我正在尝试在 UITabBarController 中显示 iPhone 通讯录中的联系人。我来了这么远：

```
- (void)contacts 
{
ABPeoplePickerNavigationController *picker = [[ABPeoplePickerNavigationController alloc] init];
// place the delegate of the picker to the controller
picker.peoplePickerDelegate = self;

CGRect newFrame = self.tabBarController.view.frame;
newFrame.size.height = newFrame.size.height - 49;
picker.view.frame = newFrame;
[picker setAccessibilityViewIsModal:YES];
// showing the picker
[self.tabBarController presentModalViewController:picker animated:NO];
} 
```

来电：

```
-(void)viewWillAppear:(BOOL)animated
{
   [self contacts];
} 
```

结果我得到了这个：

![在此处输入图像描述](../Images/0c5348ecffbb781347babfa71280ab1b.png)

1.  我看不到标签
2.  我的标签样式是黑色的，但选择器是蓝色的。
3.  有取消按钮。

如何使标签可见，使样式变黑并摆脱取消按钮？

先感谢您。

编辑：

改变方法后：

```
-(void)contacts
{
   ABPeoplePickerNavigationController *picker = [[ABPeoplePickerNavigationController alloc] init];
picker.peoplePickerDelegate = self;
picker.navigationBar.tintColor=[UIColor blackColor];
// Display only a person's phone, email, and birthdate
NSArray *displayedItems = [NSArray arrayWithObjects:[NSNumber numberWithInt:kABPersonPhoneProperty], nil];
picker.displayedProperties = displayedItems;
// Show the picker
picker.navigationBar.hidden=YES;
CGRect newFrame = picker.view.frame;
newFrame.size.height = newFrame.size.height - 49;
picker.view.frame = newFrame;

[self.tabBarController.view addSubview:picker.view];

} 
```

我得到了这个结果：

![在此处输入图像描述](../Images/17aeaef6309b4c3a719060f9bde7325f.png)

是的，联系人位于选项卡内，但现在有问题：

1.  当我用联系人触摸 tableView 时，联系人完全消失了。
2.  当我切换标签时，联系人视图不会消失，我可以在所有标签中看到它。
3.  UISearchbar 的一半保持隐藏。

现在邪恶在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:17:11.787

您在 tabBarController 顶部显示视图控制器，这就是隐藏 tabBar 的原因。尝试类似：

```
UIViewController *controller = [tabBarController.viewControllers objectAtIndex:0]; // Let's assume this is the desired view controller that should display the ABPeoplePickerNavigationController
[controller presentModalViewController:picker animated:NO]; 
```

请记住，在标签栏控制器下方呈现 UIViewController（子类）可能会导致一些非常奇怪的用户体验。此外，您必须为 ABPeoplePickerNavigationController 设置一个表格视图底部插图（与 tabBar 相同的高度，通常为 49px），以便查看表格的最后一个条目。

ABPeoplePickerNavigationController 有一个 navigationBar 属性，您可以将它的色调更改为（例如）黑色：

```
ABPeoplePickerNavigationController *picker = [[ABPeoplePickerNavigationController alloc] init];
picker.navigationBar.tintColor = [UIColor blackColor]; 
```

我怀疑您是否能够删除取消按钮而不会在应用程序批准过程中被拒绝。此外，ABPeoplePickerNavigationController 中没有取消按钮的属性，因此您必须从例如浏览导航栏子视图中获取参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T21:34:17.370

我希望你现在已经弄清楚了，但这是因为模态视图控制器被添加到活动窗口的顶部。这就是为什么它会越过标签栏的顶部。 `UIViewController`还有一种方法`presentViewController:animated:completion:`可能对您更有效。`modalTransitionStyle`如果您使用该属性指定动画的类型，则您有一些动画选项。祝你好运（如果它仍然是一个问题）。

# c# - c#可以向包含法语字符的地址发送电子邮件吗？

> ID：10342627
> 
> 赞同：2
> 
> 时间：2012-04-26T23:04:34.793
> 
> 标签：c#, email, exception, internationalization

我有使用标准`MailMessage`和`SmtpClient`类发送电子邮件的 ac# 应用程序。这很好用。但是，我们最近上传了来自政府机构的数据，其中一些电子邮件地址包含法语字符。例如 Hélène@somedomain.com

当我向法国电子邮件地址发送电子邮件时，出现以下异常：

> 在邮件标题中发现无效字符：é

我的问题是：

*   是否可以使用 c# 向包含法语重音字符的地址发送电子邮件？
*   如果是，那么如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:10:01.207

法语字符的 URL 编码`é`是

```
%E9 
```

您可以使用：

```
HttpUtility.UrlEncode("é", System.Text.Encoding.GetEncoding("ISO-8859-1")) 
```

这给出了正确的编码输出：`%E9`

# java - 如何以编程方式检查 JMX MBean 操作和属性？

> ID：10342630
> 
> 赞同：6
> 
> 时间：2012-04-26T23:04:52.250
> 
> 标签：java, jmx, websphere-7, mbeans

假设我们有一个具有以下属性和操作的 MBean。

属性：名称大小

操作：getName() getSize()

有没有办法以编程方式检查属性和操作？我一直在使用 IBM WebSphere MBeans，他们的文档不是很好。

例如，如果您转到[IBM 信息中心](http://publib.boulder.ibm.com/infocenter/wasinfo/v7r0/index.jsp "IBM WAS7 信息中心")并导航到 Network Deployment -> Reference -> Programming interfaces -> Mbean interfaces -> ThreadPool。它们只有列出的属性，没有操作。

使用 WebSphere wsadmin 工具，我实际上可以查看操作和属性。我想知道是否有办法对所有 MBean 执行此操作。

```
wsadmin>print Help.attributes(object)
Attribute                       Type                            Access
name                            java.lang.String                RO
maximumSize                     int                             RW
minimumSize                     int                             RW
inactivityTimeout               long                            RW
growable                        boolean                         RW
stats                           javax.management.j2ee.statistics.Stats  RO

wsadmin>print Help.operations(object)
Operation
java.lang.String getName()
int getMaximumPoolSize()
void setMaximumPoolSize(int)
int getMinimumPoolSize()
void setMinimumPoolSize(int)
long getKeepAliveTime()
void setKeepAliveTime(long)
boolean isGrowAsNeeded()
void setGrowAsNeeded(boolean)
javax.management.j2ee.statistics.Stats getStats() 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-27T14:26:12.077

> 如何以编程方式检查 JMX MBean 操作和属性？

我不太清楚您是在谈论以编程方式从当前 JVM 内部还是从客户端远程查找 MBean。有许多 JMX 客户端库。您可能想试试我的[SimpleJMX 包](http://256stuff.com/sources/simplejmx/)。

使用我的代码，您可以执行以下操作：

```
JmxClient client = new JmxClient(hostName, port);
Set<ObjectName> objectNames = getBeanNames() 
for (ObjectName name : objectNames) {
    MBeanAttributeInfo[] attributes = getAttributesInfo(name);
    MBeanOperationInfo[] operations = getOperationsInfo(name);
} 
```

如果您询问当前的 JVM，那么您应该能够通过这种方式从内部 bean 获取 bean 信息：

```
MBeanServer server = ManagementFactory.getPlatformMBeanServer();
Set<ObjectName> objectNames = server.queryNames(null, null);
for (ObjectName name : objectNames) {
    MBeanInfo info = server.getMBeanInfo(name);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T09:54:25.693

这是一个用于 ActiveMQ 的简单 JMX 示例。将来只需替换 activeMQ 值即可对某人有用：

```
String brokerName = "AMQBroker";
String username = "";
String password = "";
String hostname = "localhost";
int port = 1099;

Map<String, Object> env = new HashMap<String, Object>();
if (username != null || password != null) {
    String[] credentials = new String[] { username, password };
    env.put("jmx.remote.credentials", credentials);
}

JMXServiceURL url = new JMXServiceURL("service:jmx:rmi:///jndi/rmi://" + hostname + ":" + port + "/jmxrmi");
JMXConnector jmxc = JMXConnectorFactory.connect(url, env);
MBeanServerConnection conn = jmxc.getMBeanServerConnection();

// here is example for Type=Broker, can be different like
// "org.apache.activemq:BrokerName=" + brokerName + ",Type=Connection,ConnectorName=openwire,Connection=*"
// "org.apache.activemq:BrokerName=" + brokerName + ",*,Type=NetworkBridge" or same for Queue, Topic, Subscription
ObjectName name = new ObjectName("org.apache.activemq:BrokerName=" + brokerName + ",Type=Broker");
Set<ObjectName> queryNames = conn.queryNames(name, null);
// here is set with one element, but can be more depending on ObjectName query
for (ObjectName objectName : queryNames) {
    System.out.println(objectName.getCanonicalName());
    // use attribute you can be interested in
    System.out.println(conn.getAttribute(objectName, "Slave"));
} 
```

# ajax - 大型 Ajax 应用程序设计模式

> ID：10342633
> 
> 赞同：2
> 
> 时间：2012-04-26T23:05:03.670
> 
> 标签：ajax, asp.net-mvc, design-patterns

我目前非常擅长用 ASP.NET MVC 3、PHP + Cake 和 Java Spring 编写 C# Web 应用程序。使用这三个，我对创建分层数据、域、服务和演示应用程序感到很自在。我可以很好地组织它们。

但是需要高度响应的 AJAX。使用 jQuery 将每个小模型回传到控制器时，我真的感到不舒服。

是否有任何 MVC（控制器 + 视图 + 视图模型 + JavaScript）设计模式？我最近开始阅读有关 Knockout JS 和 Backbone.js 的内容，但似乎并不真正理解“架构”大词及其带来的好处，更不用说健康的设计模式了。

是否有任何好的教程或示例可以演示高级 JavaScript 应用程序，如 Google Docs/Calendar/Mail 或 Compilr 之类的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:11:19.083

javascript中有相当多的MVC实现。

坦率地说，ajax 开发做得越多，就越明显你不仅需要服务器端模板、模型、视图、控制器等，在 javascript 端也需要类似的东西，尤其是在大量 dom 操作时被关注到。

以下是流行框架列表： [http ://codebrief.com/2012/01/the-top-10-javascript-mvc-frameworks-reviewed/](http://codebrief.com/2012/01/the-top-10-javascript-mvc-frameworks-reviewed/)

但是，请注意其中很多已经向 node.js 模型发展（其中客户端和服务器端都使用 javascript 语法。

使用 C# 或 asp.net 等进行开发时，最好将架构的那部分规划为服务层。然后，您将大量模板责任推给静态文件和 javascript，这绝对是您扩大规模时想要的地方。

话又说回来，在此过程中，您还将遇到许多意识形态问题，您必须自己决定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T17:26:29.110

如果您从事严肃的 JS 开发，除了 MVC 之外，您还需要考虑许多问题。

*   构建解决方案
*   创建模块层次结构
*   JS文件的依赖管理
*   用于解耦通信的基于事件的消息传递
*   路由、书签和可嵌入组件
*   单元测试
*   本土化
*   文档生成
*   JS 优化和混淆

在完成了几个复杂的 JS 项目之后，我想分享我在构建复杂应用程序方面的经验，因此创建了 BoilerplateJS。BoilerplateJS 是用于大规模开发的参考架构，解决了上述问题。

[http://boilerplatejs.org/](http://boilerplatejs.org/)

BoilerplateJS 允许您将复杂的产品套件构建到产品模块和 UI 组件中。在参考架构代码库中实现了几个示例。

# ruby - 用 Ruby 找出歌曲的标题和艺术家

> ID：10342635
> 
> 赞同：1
> 
> 时间：2012-04-26T23:05:18.183
> 
> 标签：ruby, audio, sound-recognition

我发现了一个有趣的宝石，可以从一个未知的文件中发现它来自返回标题和艺术家的音乐：[https ://github.com/tenderlove/earworm](https://github.com/tenderlove/earworm)

事实是最后一次提交是 4 年前，使用的网站不再工作......

有谁知道这个问题的另一种解决方案？另一个宝石或另一个片段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T17:49:13.953

你可以使用标签库。我在[mylastfavourite](https://github.com/matthiasbeyer/mylastfavourite)脚本中使用了它，它运行得非常好而且很快。

它读取 mp3 标签。如果您搜索从 webservive 获取内容的 gem，您可以尝试[rbrainz](http://rbrainz.rubyforge.org/)。我以前从未使用过这个。

# c# - 如何在 SQL Server CE 和实体框架中使用默认 DateTime 值

> ID：10342636
> 
> 赞同：3
> 
> 时间：2012-04-26T23:05:28.113
> 
> 标签：c#, sql-server, entity-framework, sql-server-ce

为简单起见，假设我有一个名为的 SQL Server CE 表`Widgets`：

```
create table [Widgets] (
  [Id] int not null primary key,
  [Created] datetime not null default getdate()) 
```

在不指定`Created`列值的情况下插入按预期工作：

```
insert into [Widgets] ([Id]) values (1) 
```

生成名为 的实体框架模型后`Database`，我编写以下代码：

```
Database db = new Database();
db.Widgets.AddObject(new Widget { Id = 2 });
db.SaveChanges(); 
```

但它引发了一个例外：`An overflow occurred while converting to datetime.`我将此归结为 EF 将该`Created`列视为 non-nullable的事实，`DateTime`因此当`Widget`构造一个新列时，它的`Created`属性设置为默认值`DateTime`(0001-01-01 12:00:00 )，这超出了 SQL Server CE 的有效范围。

那么，如何让上述 C# 示例工作？我不想更改数据库架构。而且我知道我可以在构造函数中将`Created`属性设置为，但是从构造 a 到它实际插入数据库可能需要几分钟，这是我想要捕获的实际时间。`DateTime.Now``Widget``Widget`

**更新：**我尝试设置`StoreGeneratedPattern`为`Identity`and `Computed`，但它引发了一个异常：`Server-generated keys and server-generated values are not supported by SQL Server Compact`. 默认值在 SQL Server CE 中确实有效，因此它必须是实体框架的限制。（显然这在 SQL Server CE 4.0 中已修复。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T16:41:59.977

看起来 DanM 的相关问题链接为我指明了更改跟踪的正确方向。以下代码将非常接近我正在寻找的行为：

```
public partial class Database
{
  public override int SaveChanges(SaveOptions options)
  {
    foreach(var w in this.ObjectStateManager
                         .GetObjectStateEntries(EntityState.Added)
                         .Where(e => e.Entity is Widget)
                         .Select(e => (Widget)e.Entity))
    {
      if(w.Created == default(DateTime))
        w.Created = DateTime.Now;
    }

    return base.SaveChanges(options);
  }
} 
```

所有`Widget`s'`Created`值都将设置为当前日期和时间。我看到的唯一其他问题是该值是根据客户端的时钟设置的，而不是服务器的。而且，如果您一次插入多行，时间戳将比正常插入时的时间戳稍早。

最好的解决方案是允许 SQL Server 执行其配置的操作 — 如果未提供，则设置列的值。这就是生活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T04:00:59.117

您可以在其构造函数中设置 Widget 部分类的 Created 属性：

```
public partial class Widget
    {
        public Widget()
        {
            this.Created = System.DateTime.Now;
        }
    } 
```

# c# - 隐藏或显示字段时如何防止重新绑定详细信息视图

> ID：10342637
> 
> 赞同：0
> 
> 时间：2012-04-26T23:05:29.300
> 
> 标签：c#, asp.net, .net, data-binding, detailsview

我有一个 DetailsView 控件，在编辑模式下，我想根据其中的 DropDownList 的值隐藏和显示字段（DropDownList 进行回发）。

问题是当进行隐藏和显示操作时，DetailsView 控件会对其进行重新绑定，并且所有填充的字段都会被清除！

我怎样才能防止这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T01:15:37.857

你说你使用下拉列表。我假设你使用 SelectedIndexChanged 事件来执行你的操作。您是否将您的下拉列表自动回发属性设置为 true？

如果没有，请尝试设置

```
<asp:DropDownList ID="DDList1" runat="server" AutoPostBack="True">
</asp:DropDownList> 
```

这可能是一个原因。

希望能帮助到你... ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:08:24.407

您需要检查它是第一次加载还是回发，所以这样的事情应该会有所帮助：

```
if (!isPostBack)
{
   // do binding
} 
```

# string - 将字符串视为二进制并在 perl 中进行二进制操作

> ID：10342638
> 
> 赞同：1
> 
> 时间：2012-04-26T23:05:31.237
> 
> 标签：string, perl, binary, bit-manipulation

假设我在 perl 中有两个字符串

```
$a = "10001";
$b = "10101"; 
```

我需要找到这两个字符串的按位异或，即

```
$a XOR $b = "00100"; 
```

我应该如何在 perl 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T02:03:12.427

[异或两个](http://perldoc.perl.org/perlop.html#Bitwise-Or-and-Exclusive-Or)数字：

```
my $n1 = 0b10001;
my $n2 = 0b10101;
my $n = $n1 ^ $n2;
say sprintf '%05b', $n; 
```

异或两个数字（从字符串形式开始）：

```
my $n1 = '10001';
my $n2 = '10101';
my $len = max map length, $n1, $n2;
my $n = oct("0b$n1") ^ oct("0b$n2");
say sprintf '%0*b', $len, $n; 
```

对[两个字符串进行异](http://perldoc.perl.org/perlop.html#Bitwise-String-Operators)或运算：（任何长度，只要两个字符串相同）：

```
my $n1 = '10001';
my $n2 = '10101';
my $n = ($n1 ^ $n2) | ("\x30" x length($n1));
say $n; 
```

异或两个字符串：（任意长度）：

```
my $n1 = '010001';
my $n2 = '10101';
my $len = max map length, $n1, $n2;
$n1 = substr((" " x $len).$n1, -$len);
$n2 = substr((" " x $len).$n2, -$len);
my $n = ($n1 ^ $n2) | ("\x30" x $len);
say $n; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T23:35:23.533

使用[八月](http://perldoc.perl.org/functions/oct.html)：

> 如果 EXPR 以 开头`0b`，则将其解释为二进制字符串。

```
#!/usr/bin/env perl

my ($x, $y) = map oct "0b$_", qw(10001 10101);
printf "%08b\n", $x ^ $y; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T23:25:20.133

如果您要自己声明信息，则可以使用一些文字：

```
my $first = 0b10001;
my $second = 0b10101;

my $xored = $first ^ $second;

if ($xored == 0b00100)
{
    print "Good!";
} 
```

也适用于数字和十六进制：

```
my $first = 21;    # or 0b10101 or 0x15
my $second = 0x11; # or 0b10001 or 17

my $xored = $first ^ $second;

if ($xored == 0b00100) # or == 4,  or == 0x04 
{
    print "Good!";
} 
```

顺便说一句，您还应该避免使用`$a`and `$b`，因为它们对`sort`函数具有特殊含义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T23:17:45.463

使用这个子程序：

```
sub bin2dec {
    return unpack("N", pack("B32", substr("0" x 32 . shift, -32)));
} 
```

它将字符串转换为整数，您可以`^`对它们使用按位异或，然后测试它是否等于 4。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-27T09:27:11.580

只要 $a 和 $b 有一个固定的长度，比如说 5：

```
 $a = '00011';
 $b = '00110';
 $xor = ($a ^ $b) | '00000'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-26T23:17:17.540

您可以编写一些执行一位操作的函数：

```
sub xor
{
   my $p = shift;
   my $q = shift;

   return ( $p eq $q ) "0" : "1";
} 
```

那么您可以为每对字符（每个连续的位）成功调用它。

```
for (my $index = 0; $index < inputLength; $index++)
{
     $result = $result . xor ( substr ($a, $index, 1), substr ($b, $index, 1) );
} 
```

和`inputLength`的长度在哪里。这是一种方法。希望这可以帮助！`$a``$b`

# facebook-graph-api - 打开图形对象的重定向路径错误

> ID：10342642
> 
> 赞同：2
> 
> 时间：2012-04-26T23:05:56.603
> 
> 标签：facebook-graph-api, object, redirect, url-rewriting

我试图让 facebook 与我的网站一起工作。我在我的站点中创建了所有必需的元标记，每个对象通过其 url 都是唯一的：

[http://DOMAIN/#!tvoice/244016](http://DOMAIN/#!tvoice/244016)

通过 facebook 调试器调试此链接，facebook 将从以下位置提取元数据：[http://DOMAIN/](http://DOMAIN/)

但这不是对象链接。它的主要网站。我认为主要问题是使用#! 创建对象 url。但这被许多网站（尤其是推特）使用。所以应该有办法解决这个问题。

您知道完成此任务的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:23:27.767

我必须为我的网站创建一个 php url 方案，例如`/?fbid=4`facebook 上的 id 4，在您的情况下，您可能需要创建相同的`domain.com/?id=244016&catagory=tvoice`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:25:36.267

最近几天我尝试了几件事，但由于 facebook 爬虫，它真的不可能通过 javascript 或客户端上的其他东西“创建”元标记。

正如 Shawn 所说，您必须从服务器端传递元标记。

# entity-framework-4 - 使用 EF Code First 急切加载对象图

> ID：10342644
> 
> 赞同：0
> 
> 时间：2012-04-26T23:06:09.520
> 
> 标签：entity-framework-4, ef-code-first

我有一个相当深的对象图，并且想急切地加载整个图。

我知道我可以使用 .Include() 急切地加载特定的导航属性。

然而，这似乎很脆弱（如果我添加一个导航属性，我还必须添加一个额外的 .Include）并且需要（在我的情况下）相当多的 .Include() 语句。

有没有办法指示 EF 急切地加载整个对象图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T07:27:30.873

您必须手动包含要预先加载的每个导航属性。EF 不提供任何内置方式来包含所有内容。

> 然而，这似乎很脆弱（如果我添加一个导航属性，我还必须添加一个额外的 .Include）并且需要（在我的情况下）相当多的 .Include() 语句。

它比自动包含所有内容更脆弱。这样的特性只会导致太多的问题，因为在许多情况下它会意外地急切地加载导航属性。

作为一种解决方法，您可以创建一些自定义扩展方法，该方法将探索实体类型的 EF 元数据并`Include`为图表中的每个导航属性添加调用。

有[几个提议的功能](http://www.ladislavmrnka.com/2012/04/eager-loading-improvements-needed-in-ef/)可用于改进 EF 中的急切加载。您可以浏览它们，为您认为有价值的功能投票或提出新的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-03T19:10:19.583

> 然而，这似乎很脆弱（如果我添加一个导航属性，我还必须添加一个额外的 .Include）并且需要（在我的情况下）相当多的 .Include() 语句。

为了将加载对象图的所有代码保存在一个地方，我创建了一个扩展方法，可以在代码中的任何位置使用

```
static public IQueryable<My> IncludeAll(this DbSet<My> parent)
{
    var include = parent
        .Include(p => p.CollA)
        .Include(p => p.CollB)
        .Include(p => p.CollC)
        .Include(p => p.CollD)
        .Include(p => p.CollE)
        .Include(p => p.CollF)
        .Include(p => p.Etc);

    return include;
} 
```

用法

```
var query = ctx.Mys.IncludeAll().Where(...); 
```

# c# - .XmlSerializers.dll 未加载

> ID：10342646
> 
> 赞同：2
> 
> 时间：2012-04-26T23:06:19.190
> 
> 标签：c#, serialization

我有 ac# BHO taht 使用 CML 序列化。为了避免 IT 提示 csc.exe 生成用于序列化的程序集，我创建了 My.App.XmlSerializers.dll 作为使用 sgen 构建的一部分。但是 My.App.dll 大量加载 My.App.XmlSerializers.dll 失败：

```
LOADED ASSEMBLIES:
My.App, Version=1.0.0.0, Culture=neutral, PublicKeyToken=615a444ac04be6dd

FirstChanceException event raised in DefaultDomain: Could not load file or assembly 'My.App.XmlSerializers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=615a444ac04be6dd' or one of its dependencies. The system cannot find the file specified. - C:\MyPath\bin\Debug\My.App.dll 
```

我做了很多研究，我已经证实：

*   两个 DLL 都在同一个文件夹中
*   两个 DLL 都使用相同的强密钥进行签名

我不明白为什么 My.App.XmlSerializers.dll 没有找到或 loadec 不正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-05-07T22:32:30.693

此链接将为您提供解决方案： [MyAssembly.XmlSerializers.dll 生成的目的是什么？](https://stackoverflow.com/questions/934411/what-is-myassembly-xmlserializers-dll-generated-for) 您有 3 个选项：

1.  更改构建选项：GenerateSerializationAssemblies 为 Off
2.  在项目属性的“应用程序”选项卡中将“程序集名称”重命名为与“默认命名空间”相同
3.  使用 AppDomain.CurrentDomain.AssemblyResolve 事件，您可以在此处找到示例：[如何在运行时更新配置文件中的 assemblyBinding 部分？](https://stackoverflow.com/questions/325788/how-to-update-assemblybinding-section-in-config-file-at-runtime/326011)

# c# - 使用 AForge.Video.FFMPEG / AForge.Video.VFW 截屏视频。帧率问题

> ID：10342647
> 
> 赞同：5
> 
> 时间：2012-04-26T23:06:24.293
> 
> 标签：c#, .net, screen-capture, frame-rate, aforge

我的 WinForms .NET 4 C# 应用程序在用户与之交互时记录桌面。

它根据系统的速度使用 AForge FFMPEG 或 VFW 包装器。捕获当然是在后台线程中完成的。

在任何一种情况下，包装器都需要预先指定帧速率。这是有问题的，因为捕获频率是不确定的，并且很容易受到目标机器繁忙程度的影响。在一个好的系统上，我最多可以得到 10 FPS。

所以这里有两个问题：

*   如何根据实际捕获帧速率对齐帧？
*   如何提高帧速率，也许通过使用 AForge 以外的解决方案？

为了清楚起见，下面列出了我使用的代码：

```
private void ThreadWork ()  
{  
    int count = 0;  
    string filename = "";  
    RECT rect = new RECT();  
    System.Drawing.Bitmap bitmap = null;  
    System.Drawing.Graphics graphics = null;  
    System.DateTime dateTime = System.DateTime.Now;  
    System.IntPtr hWndForeground = System.IntPtr.Zero;  
    AForge.Video.FFMPEG.VideoFileWriter writer = null;  

    filename = @"c:\Users\Raheel Khan\Desktop\Temp\Capture.avi";
    if (System.IO.File.Exists(filename))
        System.IO.File.Delete(filename);

    writer = new AForge.Video.FFMPEG.VideoFileWriter();
    writer.Open
    (
        filename,
        System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width,
        System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height,
        10, // FPS
        AForge.Video.FFMPEG.VideoCodec.MPEG4
    );

    bitmap = new Bitmap
    (
        System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width,
        System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height,
        System.Drawing.Imaging.PixelFormat.Format24bppRgb
    );
    graphics = System.Drawing.Graphics.FromImage(bitmap);

    dateTime = System.DateTime.Now;

    while (System.DateTime.Now.Subtract(dateTime).TotalSeconds < 10) // 10 seconds.
    {
        graphics.CopyFromScreen(Screen.PrimaryScreen.Bounds.X, Screen.PrimaryScreen.Bounds.Y, 0, 0, Screen.PrimaryScreen.Bounds.Size);

        rect = new RECT();
        hWndForeground = GetForegroundWindow();
        GetWindowRect(hWndForeground, ref rect);
        graphics.DrawRectangle(Pens.Red, rect.Left, rect.Top, rect.Right - rect.Left, rect.Bottom - rect.Top);
        graphics.DrawString(count++.ToString(), this.Font, Brushes.Red, 10, 10);

        writer.WriteVideoFrame(bitmap);

        System.Threading.Thread.Sleep(10);
    }

    writer.Close();
    writer.Dispose();

    System.Diagnostics.Process.Start(System.IO.Path.GetDirectoryName(filename));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T16:25:20.830

您可以将帧捕获为 jpegs 或 mjpeg 文件的临时文件夹，然后在用户需要时将其重新处理为 avi 视频文件。这将减少您需要“即时”执行的处理量并释放资源 - 并使您的系统达到更高和更常规的帧速率。

# java - 如何绕过这些不兼容的类型？

> ID：10342648
> 
> 赞同：0
> 
> 时间：2012-04-26T23:06:25.820
> 
> 标签：java, string, incompatibility

我正在开发一个创建简单的基于文本的冒险游戏的项目。这有点复杂，但游戏中基本上有大约八个房间，每个房间都有特定的物品。您只能根据房间向某些方向移动，目标是到达最后一个房间。我有一个名为 Item 的类，一个名为 Room 的类，然后是主 Game 类。

我的最后三种方法有很多问题。（我将其余代码作为上下文包含在内。）我的说明说要使用字符串的参数，但方法必须处理“项目”。数据类型 Item 是在不同的类中创建的，由四个参数（字符串名称、字符串描述、int 重量和 boolean edible）组成。有人能指出我正确的方向吗？

```
import java.util.ArrayList;

public class Game
{
    private ArrayList<Item> itemsHeld;
    private Room planetHarvest;
    private Room planetReach;
    private Room alphaHalo;
    private Room newMombasa;
    private Room deltaHalo;
    private Room voi;
    private Room theArk;
    private Room forerunnerShieldWorld;
    private Item DMR;
    private Item Launcher;
    private Item Shotgun;
    private Item Health;
    private Item Key;
    private Room currentLocation;
    private String msg;

    public Game(){
        createRooms();
        ArrayList<Item> itemsHeld = new ArrayList<Item>(0);
        currentLocation = planetHarvest;
    }

    private void createRooms(){
        DMR = new Item("DMR", "The Designated Marksman Rifle fires a medium-range shot that defeats one enemy at a time.",
        10, false);
        Launcher = new Item("Launcher", "The rocket launcher fires a long-range rocket that defeats two enemies at a time.",
        30, false);
        Shotgun = new Item("Shotgun", "The shotgun fires a short-range buckshot blast that defeats one enemy at a time.",
        10, false);
        Health = new Item("Health", "The health pack heals you if you've been attacked.", 10, true);
        Key = new Item("Key", "The Key is the secret to saving the galaxy.", 10000, false);

        planetHarvest = new Room("a farming colony at the edge of human-controlled space. Though usually quiet, it has now been disturbed by an invasion from extraterrestrials who call themselves the Covenant. The Covenant will not let you escape without a fight.", DMR);
        planetReach = new Room("twenty-seven years in the future. The Covenant has invaded every human colony world and bombarded each one with plasma, reducing the surface to molten glass. Planet Reach is the only human colony that remains. The aliens know their campaign to exterminate humanity is almost over and they show it in their ferocity on the battlefield.", Launcher);
        alphaHalo = new Room("a strange, alien, planet-sized ring following your escape from the doomed planet Reach. The inside of the mysterious non-Covenant hoop structure has continents, oceans, ecosystems, breathable atmosphere – and two relentless foes. The Covenant has arrived; so has the Flood, a terrifying alien parasite that will eat both you and the Covenant. On top of that, you learn that this Halo is not just a habitat but also a weapon that will destroy all life in the galaxy if you don’t stop it.", Key);
        newMombasa = new Room("an African city on Earth, humanity's last safe haven in the universe. A Covenant invasion force has landed. You’ll need to fend them off and follow them to wherever they’re headed next.", Health);
        deltaHalo = new Room("where the Covenant and the Flood are already waiting. The same rules from Alpha Halo apply here, but now you learn that there are a total of eleven Halos and that the only way to stop them all is to shut them down from a structure outside the galaxy called the Ark. Meanwhile, the Covenant is still attacking Earth.", Key);
        voi = new Room("The Flood has arrived and is infecting humans and aliens; meanwhile, the Covenant is in civil war and some of the aliens are helping you. Following your escape from Delta Halo, all of the Halos in the galaxy have been put on standby, so if you don’t find the Ark soon then it’s the end of life as we know it.", Shotgun);
        theArk = new Room("a massive installation many times bigger than even a Halo. Shutting down the Ark will mean saving the galaxy. However, most of the Covenant and the Flood are still after you. Finish the fight.", Key);
        forerunnerShieldWorld = new Room("an artificial planet made by a super-advanced alien civilization that disappeared 100,000 years ago – the makers of the Halos and the Ark. The war against the Covenant is finally over, the Flood has been defeated, and the galaxy is safe. The mysteries of the Forerunners, however, are just beginning to be unraveled.");

        planetHarvest.addNeighbor("Slipspace Forward", planetReach);

        planetReach.addNeighbor("Slipspace Out", alphaHalo);

        alphaHalo.addNeighbor("Slipspace Back", planetReach);
        alphaHalo.addNeighbor("Slipspace Forward", newMombasa);

        newMombasa.addNeighbor("Slipspace Out", deltaHalo);
        newMombasa.addNeighbor("Forward", voi);

        deltaHalo.addNeighbor("Slipspace Back", newMombasa);

        voi.addNeighbor("Slipspace Out", theArk);
        voi.addNeighbor("Back", newMombasa);

        theArk.addNeighbor("Slipspace Unknown", forerunnerShieldWorld);
    }

    private void setWelcomeMessage(){
        msg = "You are John-117, an augmented soldier fighting for Earth and its colonies in the year 2552\. You battle the Covenant, an alien religious alliance, and the Flood, an alien parasite that infects both humans and Covenant and turns them into zombies. Your battles take you to planetary colonies like Harvest and Reach, ancient alien ring-worlds called Halos, futuristic cities in Africa, and the Halos’ control station called the Ark, located outside the galaxy. The goal of the game is to defeat all enemies and make it to the safety of the Forerunner Shield World.";
    }

    public String getMessage(){
        return msg;
    }

    public void help(){
        msg = "Every place you enter is crawling with Covenent and/or Flood. You'll have to neutralize them before they neutralize you. As a Reclaimer, you're the only one who can use Keys on a Halo or Ark. Some places involve more than one mission.";
    }

    public void look(){
        msg = currentLocation.getLongDescription();
    }

    public void move (String direction){
        Room nextRoom = currentLocation.getNeighbor(direction);
        if (nextRoom == null){
            msg = "You can't go there.";
        }else{
            currentLocation = nextRoom;
            msg = currentLocation.getLongDescription();
        }
    }

    public void list(){
        if(itemsHeld != null){
            msg += itemsHeld;
        }else{
            msg = "You are not holding anything.";
        }
    }

    public boolean gameOver(){
        if(currentLocation == forerunnerShieldWorld){
            msg = "You defeated the Covenant and survived the war. You won!";
        }
        return false;
    }

    public void pickup(){
        if(currentLocation.hasItem()){
            if(currentLocation.getItem().getWeight() < 50){
                msg = "You are now holding the " + currentLocation.getItem().getName();
                itemsHeld.add(currentLocation.getItem());
                currentLocation.removeItem();
            }else{
                msg = "This item is too heavy to pick up.";
            }
        }else{
            msg = "There is no item to pick up.";
        }
    }

    private Item checkForItem (String name){
        if(itemsHeld.contains(name)){
            return item;
        }else{
            return null;
        }
    }

    public void drop (String item){
        if(itemsHeld.contains(item)){
            if(currentLocation.getItem() != null){
                msg = "You successfully dropped the " + item;
                itemsHeld.remove(item);
                currentLocation.addItem(item);
            }else{
                msg = "There's no room to drop that here.";
            }
        }else{
            msg = "You are not holding the " + item;
        }
    }

    public void eat (String item){
        if(itemsHeld.contains(item)){
            if(item.isEdible()){
                msg = "You have eaten the " + item.getName();
            }else{
                msg = "You can't eat that!";
            }
        }else{
            msg = "You are not holding a " + item.getName();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:15:12.877

研究使用 HashMap `itemsHeld`，使用`item.GetName()`作为键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:11:18.267

您正在使用字符串作为另一个对象项...

> public void eat (String item){
> ...
> if(item.isEdible()){

那段代码的作用是，`isEdible()`为提供的字符串调用 String 类方法`item`。显然，没有这样的方法，并且您将字符串与另一个（自定义）对象混淆了。

正确的方法是使用这样的 Item 对象：

```
public void eat (Item item) { 
```

我认为您犯了一个令人厌烦的错误，但如果不是这样，我可以帮助您处理 Item 对象...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T23:18:59.663

您需要有一种将项目名称`String`转换为`Item`对象的方法。包含您的项目的简单 HashMap 将起作用。

将项目作为`Item`对象后，您可以在其上调用成员方法，例如`isEdible()`.

# c# - $_POST array is empty when POSTing with C# WebRequest

> ID：10342652
> 
> 赞同：0
> 
> 时间：2012-04-26T23:06:45.833
> 
> 标签：c#, php

I've been trying to get some client-server interaction happening with JSON, however, the data that I post to the server is not arriving; the `$_POST` array in my PHP script is empty.

I've just ended up grabbing the WebRequest example straight from [MSDN](http://msdn.microsoft.com/en-us/library/debx8sh9.aspx) and testing that. That still doesn't work. I've also tried just posting some data with HTML form, and that works fine. I'm completely stumped.

When I call `getallheaders()` in my PHP I get

```
OK
array(5) {
  ["Content-Type"]=>
    string(33) "application/x-www-form-urlencoded"
  ["Host"]=>
    string(9) "localhost"
  ["Content-Length"]=>
    string(2) "54"
  ["Expect"]=>
    string(12) "100-continue"
  ["Connection"]=>
    string(10) "Keep-Alive" 
```

though doing a var_dump($_POST) returns array(0)

Can anyone suggest anything?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:23:33.590

The code in MSDN sends a raw string, so PHP doesn't know how to brake it into fields and put it in `$_POST`. You should be able to get that POST data with `file_get_contents('php://input')`.

If you want the data to get to `$_POST`, you need to encode it(the same way you encode it, the same way you encode GET parameters:

```
string postData="fieldName="+System.Web.HttpUtility.UrlEncode("The data that goes in the field"); 
```

As always, if you need multiple fields you need to separate them with `&`s.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:24:00.187

Those are just your Headers. You shouldn't expect your POST parameters in the result of getallheaders() call. You're sending *something* as the content-length suggest 54 bytes. Try var dumping $_REQUEST parameter, see if they're being submitted with another method.

# ruby-on-rails - 评估数组是否在 ruby 中有任何项目

> ID：10342653
> 
> 赞同：2
> 
> 时间：2012-04-26T23:06:48.567
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

有没有更好的方法来声明这一点？

```
if current_user.received_replies.unread.count > 0 
```

我要做的是仅在至少有一个`unread`对象时才匹配条件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T23:08:49.483

```
unless current_user.received_replies.unread.empty?
  # ...
end 
```

或者，如果您`if`有`else`，请切换案例（因为`unless/else`太丑了）：

```
if current_user.received_replies.unread.empty?
  # ...
else
  # ...
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T23:17:21.207

我会使用：

```
if current_user.received_replies.unread.any? 
```

从文档：

```
= Array.any?

（来自红宝石核心）
=== 从 Enumerable 实现
-------------------------------------------------- ----------------------------
  枚举。任何？[{|对象| 块 } ] -> 真或假

-------------------------------------------------- ----------------------------

将集合的每个元素传递给给定的块。方法返回
如果块曾经返回 false 或 nil 以外的值，则返回 true。如果块
没有给出，Ruby 添加了 {|obj| 的隐式块 obj} （那是什么？将
如果至少有一个集合成员不是 false 或 nil，则返回 true。

       %w{蚂蚁熊猫}.any? {|字| word.length >= 3} #=> 真
       %w{蚂蚁熊猫}.any? {|字| word.length >= 4} #=> 真
       [无，真实，99]。任何吗？#=> 真

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T23:08:54.703

这可能会好一点：

```
unless current_user.received_replies.unread.empty? 
```

# .htaccess - 为什么htaccess没有在域名后和变量前添加“\”？

> ID：10342654
> 
> 赞同：0
> 
> 时间：2012-04-26T23:06:51.207
> 
> 标签：.htaccess, mod-rewrite

我正在一个 .htaccess 文件中工作，我已经成功完成了几次重定向。我遇到问题的行是：

```
RedirectMatch 301 ^bookfox/(.*)/(.*)/(.*) http://www.thejohnfox.com/$3 
```

我正在尝试获取此 URL：`http://thejohnfox.com/bookfox/2006/10/joyce_carol_oat`
并将其转发到`http://thejohnfox.com/joyce_carol_oat`

我只能让 RedirectMatch 做到这一点：**`http://thejohnfox.comjoyce_carol_oat`** 我已经尝试了所有我能找到的东西，但没有任何效果。

有谁知道为什么正斜杠在之后被取出`thejohnfox.com`？

这是我的 Wordpress .htaccess 文件中的完整代码：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]

Redirect 301 /bookfox/bio.html http://thejohnfox.com/bio/
Redirect 301 /bookfox/journals-accepting-novellas.html http://thejohnfox.com/journals-accepting-novellas/
Redirect 301 /bookfox/ranking-of-literary-journ.html  http://thejohnfox.com/ranking-of-literary-journals/
Redirect 301 /bookfox/what-is-bookfox.html http://thejohnfox.com/what-is-bookfox/
Redirect 301 /bookfox/journals-accepting-electronic-submissions.html http://thejohnfox.com/journals-accepting-electronic-submissions/

RedirectMatch 301 ^(.*)\.html$ http://thejohnfox.com$1/
RedirectMatch 301 ^bookfox/(.*)/(.*)/(.*) http://www.thejohnfox.com/$3

</IfModule>

# END WordPress 
```

# xml - 如何使用 PowerShell 将部分添加到 web.config？

> ID：10342657
> 
> 赞同：3
> 
> 时间：2012-04-26T23:07:26.333
> 
> 标签：xml, sharepoint, powershell, web-config

`system.serviceModel`如果 web.config 中尚不存在该部分，如何将其添加到该部分？

前：

```
<system.serviceModel>
  <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
</system.serviceModel> 
```

后：

```
<system.serviceModel>
 <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
 <bindings>
      <basicHttpBinding>
        <binding name="ValidationServiceSoap" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="Transport">
            <transport clientCredentialType="Ntlm" />
            <message clientCredentialType="UserName" />
          </security>
        </binding>
      </basicHttpBinding>
 <bindings>
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T00:21:04.247

在 PowerShell 中执行此操作还不错：

```
$origXml = [xml]@'
<configuration>
<system.serviceModel> 
  <serviceHostingEnvironment aspNetCompatibilityEnabled="true" /> 
</system.serviceModel> 
</configuration>
'@

$newXml = @'
 <bindings> 
      <basicHttpBinding> 
        <binding name="ValidationServiceSoap" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true"> 
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" /> 
          <security mode="Transport"> 
            <transport clientCredentialType="Ntlm" /> 
            <message clientCredentialType="UserName" /> 
          </security> 
        </binding> 
      </basicHttpBinding> 
 </bindings> 
'@

if (!$origXml.configuration.'system.serviceModel'.bindings)
{
    $tempXmlDoc = new-object System.Xml.XmlDocument
    $tempXmlDoc.LoadXml($newXml)
    $newNode = $origXml.ImportNode($tempXmlDoc.DocumentElement, $true)
    $origXml.configuration.'system.serviceModel'.AppendChild($newNode)
} 
```

请注意，这种方法之所以有效，是因为您要注入的 XML 有一个根元素`<bindings>`。

# php - 在PHP中，将函数中的参数设置为true有什么意义？

> ID：10342660
> 
> 赞同：1
> 
> 时间：2012-04-26T23:07:55.730
> 
> 标签：php, parameters

在查看 wordpress 源代码中的函数时，我遇到了一个列出几个参数的函数

```
function mysql2date( $dateformatstring, $mysqlstring, $translate = true ) 
```

我的问题围绕着最后一个参数“$translate = true”，这是将变量设置为 true，还是仅在它等于 true 时才调用 $translate？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T23:10:05.457

这是一个默认值。如果在调用函数时提供了参数，则函数`$translate`内的值将是传入的任何值。如果没有，它将默认为`true`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T23:11:54.670

这意味着第三个参数`$translate`将是*可选*`true`的，如果在调用函数时未提供该参数，则默认为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T23:09:52.467

这是一个默认值，将其设置为 true

# c# - C# P/Invoke 嵌入式 VB6 DLL 资源：ActiveXObject “无法在 DLL 'DLLName' 中找到名为 'FunctionName' 的入口点。”

> ID：10342661
> 
> 赞同：0
> 
> 时间：2012-04-26T23:07:57.867
> 
> 标签：c#, dll, vb6, wrapper, activexobject

我正在尝试为 VB6 DLL 创建一个 C# 包装器 DLL，然后在网页中将该包装器用作 ActiveXObject，但在调用 ClassTesting() 时出现此错误：

> 无法在 DLL 'VB6DLL' 中找到名为 'ClassTest' 的入口点。

应用程序将 DLL 导出到临时目录，然后将其加载到内存中。DLL的结构可以描述为：

VB6DLL.dll -> 公共类“VB6.cls” -> 公共函数“ClassTest()”。

C#代码如下：

```
namespace SystemDeviceDriver
{
    [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
    public interface IDeviceDriver
    {
        [DispId(1)]
        string ClassTesting();
    }

    [Guid("655EE123-0996-4c70-B6BD-7CA8849799C7")]
    [ComSourceInterfaces(typeof(IDeviceDriver))]
    public class DeviceDriver : IDeviceDriver
    {

        [DllImport("kernel32", CharSet = CharSet.Unicode)]
        static extern IntPtr LoadLibrary(string lpFileName);

        [DllImport("VB6DLL", CharSet = CharSet.Unicode)]
        static extern string ClassTest();

        public DeviceDriver()
        {
            //Write the VB6DLL to a temp directory
            string dirName = Path.Combine(Path.GetTempPath(), "SystemDeviceDriver." + Assembly.GetExecutingAssembly().GetName().Version.ToString());
            if (!Directory.Exists(dirName))
            {
                Directory.CreateDirectory(dirName);
            }
            string dllPath = Path.Combine(dirName, "VB6DLL.dll");
            File.WriteAllBytes(dllPath, SystemDeviceDriver.Properties.Resources.VB6DLL);

            //Load the library into memory
            IntPtr h = LoadLibrary(dllPath);
            Debug.Assert(h != IntPtr.Zero, "Unable to load library " + dllPath);
        }

        public string ClassTesting()
        {
            return ClassTest();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:54:43.533

DllImport / P/Invoke 函数用于包含“旧 C 风格”的 dll 文件，因此从库中导出的简单函数

以下是列出的调用方法，可能的函数类型：http: [//msdn.microsoft.com/de-de/library/system.runtime.interopservices.callingconvention.aspx](http://msdn.microsoft.com/de-de/library/system.runtime.interopservices.callingconvention.aspx)

COM 完全不同，参见：[http ://en.wikipedia.org/wiki/Component_Object_Model](http://en.wikipedia.org/wiki/Component_Object_Model)

COM dll 通常导出的唯一函数是 DllRegisterServer、DllUnregisterServer，您可以首先使用 P/Invoke 函数来调用该函数。COM dll 文件在注册表中注册自己。那么应该可以创建一个 COM 对象。

# iphone - iOS 上的页面卷曲：继续显示工具栏，就像在标准地图应用程序中一样

> ID：10342667
> 
> 赞同：1
> 
> 时间：2012-04-26T23:08:56.510
> 
> 标签：iphone, ios, sdk, uiviewcontroller, page-curl

我试图达到与地图应用程序相同的效果：工具栏不是卷曲一部分的页面卷曲。例如看这个：

[http://www.patentlyapple.com/.a/6a0120a5580826970c0120a8a7172c970b-800wi](http://www.patentlyapple.com/.a/6a0120a5580826970c0120a8a7172c970b-800wi)

目前这是启动 curl 的代码：

```
MKTModalViewController *controller = [self.storyboard instantiateViewControllerWithIdentifier:@"MapOptions"];
controller.modalTransitionStyle = UIModalTransitionStylePartialCurl;
[self presentViewController:controller animated:YES completion:nil]; 
```

当前的视图控制器（上面的 self）包含一个地图和一个工具栏。使用上面的代码，整个页面都被卷曲了。我只希望地图在工具栏保持在同一位置时卷曲。

有谁知道这是怎么做到的吗？我是否想做到（相对容易）？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:27:51.317

我假设在地图应用程序中，UIToolbar 实际上是 UINavigationController 拥有的工具栏。确保您的 UIToolbar 不是您添加到 ViewController 的新工具栏。

在你的 UIViewController 中尝试这样的事情：

```
// add your buttons and controls to self.navigationController.toolbar;
self.navigationController.toolbarHidden = NO;

MKTModalViewController *controller = [self.storyboard instantiateViewControllerWithIdentifier:@"MapOptions"];
controller.modalTransitionStyle = UIModalTransitionStylePartialCurl;
[self presentModalViewController:controller animated:YES]; 
```

不确定这是否会在我的脑海中形成，但它应该会让你朝着正确的方向前进。

# wpf - 在 DataTemplate 内绑定控件

> ID：10342675
> 
> 赞同：0
> 
> 时间：2012-04-26T23:10:02.750
> 
> 标签：wpf, wpf-controls

我正在尝试将组合框的字体系列绑定到另一个组合框的字体系列。它工作正常，直到我将数据模板放在我试图从中提取的组合框中。请看下面的代码：

```
<Window Height="350" x:Class="MainWindow" Width="525" FontFamily="Palatino Linotype" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
    <StackPanel Grid.Column="1" Name="ComboBoxStackPanel" Margin="6" VerticalAlignment="Top">
        <ComboBox FontFamily="Wingdings" Name="SS0">
            <ComboBox.ItemTemplate>
                <DataTemplate x:Name="SSD">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition SharedSizeGroup="Row" Height="Auto"/>
                        </Grid.RowDefinitions>
                        <TextBlock Name="SS1" FontSize="14" Text="{Binding}" FontFamily="Wingdings"/>
                    </Grid>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>
        <ComboBox FontFamily="{Binding FontFamily, ElementName=SS1}" SelectedIndex="1">
            Test
            <ComboBoxItem FontStyle="Normal" FontWeight="Normal">Regular</ComboBoxItem>
            <ComboBoxItem FontStyle="Italic" FontWeight="Normal">Italic</ComboBoxItem>
            <ComboBoxItem FontStyle="Normal" FontWeight="Bold">Bold</ComboBoxItem>
            <ComboBoxItem FontStyle="Italic" FontWeight="Bold">Bold Italic</ComboBoxItem>
        </ComboBox>
    </StackPanel>
</Window> 
```

我可以很好地访问 SS0，但是当我尝试访问 SS1 时，它会失败。我试过使用RelativeSource，但我很困惑如何在这种情况下使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T08:21:17.777

有`DataTemplate`一个`VisualTree`属性，您可以使用它来询问其内容，但是在应用模板之前内容不存在。

# facebook - Facebook 请求对话框 - 对于移动应用程序

> ID：10342678
> 
> 赞同：0
> 
> 时间：2012-04-26T23:10:29.850
> 
> 标签：facebook, facebook-graph-api, mobile, apprequests, facebook-app-requests

是否可以在移动应用程序中显示 FACEBOOK REQUEST DIALOG。至于我所看到的，大多数人说请求对话框仅适用于画布应用程序。但是文档页面 [https://developers.facebook.com/docs/channels/](https://developers.facebook.com/docs/channels/) 说

> 如果您已经构建了 Canvas 或移动 Web 应用程序，请求是让用户邀请他们的朋友使用您的应用程序的好方法。

那么有没有可能。[我尝试了https://developers.facebook.com/docs/reference/dialogs/requests/](https://developers.facebook.com/docs/reference/dialogs/requests/)中提到的 URL 方法

```
https://www.facebook.com/dialog/apprequests?
  app_id=APP_ID&
  message=Facebook%20Dialogs%20are%20so%20easy!&
  redirect_uri=http://www.example.com/response 
```

对话框打开。但即使在我选择朋友并发送应用请求后，朋友也没有收到我的请求。

难道我做错了什么？或者用户是否可以通过移动应用程序请求对话框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:14:44.673

您链接到的页面还说：

> 请求仅适用于 Desktop Canvas 应用程序，不适用于网站。接受请求会将用户定向到发送请求的应用程序的画布页面 URL。

“Desktop Canvas 应用程序”一词在排除移动本机客户端应用程序和移动 Web 应用程序时似乎非常明确。所以我认为不支持。

# node.js - io.sockets.emit 和广播有什么区别？

> ID：10342681
> 
> 赞同：113
> 
> 时间：2012-04-26T23:10:59.270
> 
> 标签：node.js, socket.io

io.sockets.emit 和 socket.broadcast.emit 有什么区别？只是广播向所有人发出，但发送它的套接字？

似乎它们可以互换使用：

```
io.sockets.on('connection', function (socket) {
  //these should do the same thing  
  io.sockets.emit('this', { receivers: 'everyone'});

  socket.broadcast.emit('this', { receivers: 'everyone but socket'}); //emits to everyone but socket
  socket.emit('this', { receivers: 'socket'}); //emits to socket
}); 
```

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2012-04-27T04:49:50.203

`io.sockets.emit`将发送给所有客户

`socket.broadcast.emit`将消息发送给除了新创建的连接之外的所有其他客户端

[这个 Socket.IO Wiki 帖子将帮助每个阅读这个问题的人：](https://github.com/Automattic/socket.io/wiki/How-do-I-send-a-response-to-all-clients-except-sender%3F)

最近的备忘单也可以在这里查看：

[https://socket.io/docs/v4/emit-cheatsheet](https://socket.io/docs/v4/emit-cheatsheet)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2013-03-21T07:58:18.143

`socket.broadcast.emit()`行为类似于`io.sockets.emit`，但不是发射到所有连接的套接字，而是发射到所有连接的套接字，除了它被调用的那个。所以在这种情况下，被引用的套接字`socket`将不会收到事件。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-08-11T14:05:10.637

场景：1：-通过使用**io.sockets.emit** [详细图：-io.sockets.emit](https://i.stack.imgur.com/f52nC.jpg)

> 在这里，每个 Socket 都会收到包含**Initiator**的消息。

```
 // BY IO>SOCKETS>EMIT
   io.sockets.emit('MyChannelBroadcast',
               {
                 owner:"Anshu Ashish",
                 clientCount:clients,
                 message:"Welcome All"
               }
    ); 
```

场景：2：- 通过使用**socket.broadcast.emit 详图** [：-socket.broadcast.emit](https://i.stack.imgur.com/b2ioe.jpg)

> 在这里，每个 Sockets 都收到消息，除了一个，即**Initiator**。

```
 // BY SOCKET>BROADCAST>EMIT
   socket.broadcast.emit('BroadCastExceptMe',{data:"HAVE A NICE DAY"}); 
```

结论：- 现在完全取决于我们的业务需求，哪个更可取。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-09-13T09:39:39.213

为简单起见，请考虑以下示例：有 2 个客户**端 client A**，**client B**和我们正在使用的**服务器** 来响应客户端发出的某些事件。

```
socket.brodcast.emit() 
```

**客户端 A**发送事​​件 在这种情况下，服务器不会将事件发送回**客户端 A**，但会将事件发送到所有其他连接的套接字。所以在这种情况下，只有**客户端 B**会得到事件响应

```
io.emit() 
```

客户端 A 发送事​​件，服务器会将回复事件发送到**客户端 A**和**客户端 B的所有连接的套接字**

# mono - 在 OSX Snow Leopard 上构建 EmguCV

> ID：10342682
> 
> 赞同：0
> 
> 时间：2012-04-26T23:11:07.050
> 
> 标签：mono, emgucv

非常感谢您对安装错误的帮助。这几天我一直在尝试解决这个问题，但在网上找不到答案。此外，我的工作需要使用 EMGUCV 包装器，并且不能将 OpenCVsharp 或其他 .net 包装器用于 opencv。

我使用的是 OSX 10.6.8，我已经安装了 mono/cmake 并按照主干版本的[wiki中的说明进行操作。](http://www.emgu.com/wiki/index.php/Download_And_Installation#OSX)我执行以下命令，但包配置失败。我不知道如何解释输出。也在 EmguCV 论坛上问过，但在那里没有得到很多意见。

谢谢，里希

```
cmake -DCMAKE_OSX_ARCHITECTURES=i386 -DBUILD_NEW_PYTHON_SUPPORT:BOOL=FALSE -DBUILD_PERF_TESTS=FALSE -DBUILD_TESTS:BOOL=FALSE -DBUILD_DOCS:BOOL=FALSE -DBUILD_JPEG=TRUE -DBUILD_PNG=TRUE -DBUILD_TIFF=TRUE .

-- Found csc: /usr/bin/gmcs
-- Found gacutil: /usr/bin/gacutil
-- Found al: /usr/bin/al
-- Found resgen: /usr/bin/resgen
-- Extracting Emgu CV svn version, please wait...
-- Emgu CV SVN VERSION: 1661
-- Building 32bit library
-- Detected version of GNU GCC: 42 (402)
-- Extracting svn version, please wait...
-- SVNVERSION: svn:8208
-- Could NOT find Jasper (missing: JASPER_LIBRARIES JASPER_INCLUDE_DIR) 
-- checking for module 'libavcodec'
-- package 'libavcodec' not found
-- checking for module 'libavformat'
-- package 'libavformat' not found
-- checking for module 'libavutil'
-- package 'libavutil' not found
-- checking for module 'libswscale'
-- package 'libswscale' not found
-- checking for module 'libdc1394-2'
-- package 'libdc1394-2' not found
-- checking for module 'libdc1394'
-- package 'libdc1394' not found
-- CUDA detected: 4.1
-- CUDA NVCC target flags: -gencode;arch=compute_11,code=sm_11;-gencode;arch=compute_12,code=sm_12;-gencode;arch=compute_13,code=sm_13;-gencode;arch=compute_20,code=sm_20;-gencode;arch=compute_20,code=sm_21;-gencode;arch=compute_20,code=compute_20
-- 
-- General configuration for OpenCV 2.4.0 =====================================
-- Version control: svn:8208
-- 
-- Platform:
-- Host: Darwin 10.8.0 i386
-- CMake: 2.8.8
-- CMake generator: Unix Makefiles
-- CMake build tool: /usr/bin/make
-- 
-- C/C++:
-- Built as dynamic libs?: YES
-- C++ Compiler: /usr/bin/c++ (ver 4.2.1)
-- C++ flags (Release): -Wall -pthread -O3 -DNDEBUG -fomit-frame-pointer -msse -msse2 -DNDEBUG
-- C++ flags (Debug): -Wall -pthread -g -O0 -DDEBUG -D_DEBUG -ggdb3
-- C Compiler: /usr/bin/gcc
-- C flags (Release): -Wall -pthread -O3 -DNDEBUG -fomit-frame-pointer -msse -msse2 -DNDEBUG
-- C flags (Debug): -Wall -pthread -g -O0 -DDEBUG -D_DEBUG -ggdb3
-- Linker flags (Release): 
-- Linker flags (Debug): 
-- 
-- OpenCV modules:
-- To be built: calib3d contrib core features2d flann gpu highgui imgproc legacy ml nonfree objdetect photo stitching ts video videostab
-- Disabled by user: python
-- Disabled by dependency: -
-- Unavailable: androidcamera java
-- 
-- GUI: 
-- Cocoa: YES
-- OpenGL support: NO
-- 
-- Media I/O: 
-- ZLib: /usr/lib/libz.dylib (ver 1.2.3)
-- JPEG: libjpeg (ver 62)
-- PNG: build (ver 1.5.9)
-- TIFF: build (ver 42)
-- JPEG 2000: build (ver 1.900.1)
-- OpenEXR: NO
-- OpenNI: NO
-- OpenNI PrimeSensor Modules: NO
-- 
-- Video I/O: QTKit
-- FFMPEG: NO
-- codec: NO
-- format: NO
-- util: NO
-- swscale: NO
-- gentoo-style: NO
-- 
-- Other third-party libraries:
-- Use IPP: NO
-- Use TBB: NO
-- Use Cuda: YES (ver 4.1)
-- Use Eigen: NO
-- Use Clp: NO
-- 
-- NVIDIA CUDA:
-- Use CUFFT: YES
-- Use CUBLAS: NO
-- NVIDIA GPU arch: 11 12 13 20 21
-- NVIDIA PTX archs: 11 12 13 20 21
-- NVIDIA GPU features: 11 12 13 20 20 20
-- 
-- Python:
-- Interpreter: /Library/Frameworks/EPD64.framework/Versions/Current/bin/python (ver 2.7.2)
-- 
-- Tests and samples:
-- Tests: NO
-- Performance tests: NO
-- Examples: NO
-- 
-- Install path: /usr/local
-- 
-- cvconfig.h is in: /Users/rawatenator/emgucv
-- -----------------------------------------------------------------
-- 
CMake Warning at opencv/CMakeLists.txt:973 (message):
The source directory is the same as binary directory. "make clean" may
damage the source tree

-- WITH CVBLOB: ON
-- Could NOT find TIFF (missing: TIFF_LIBRARY) (found version "3.8.2")
-- CVEXTERN: ZLIB found.
-- Skipping GEOTIFF
-- CPACK_GENERATOR: Bundle
CMake Error: The following variables are used in this project, but they are set to NOTFOUND.
Please set them or make sure they are set and tested correctly in the CMake files:
CUDA_nvcuvid_LIBRARY (ADVANCED)
linked by target "opencv_gpu" in directory /Users/rawatenator/emgucv/opencv/modules/gpu 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T08:09:05.963

这个库不见了，看起来它只适用于 Windows。

CUDA_nvcuvid_LIBRARY [http://www.cmake.org/cmake/help/v2.8.8/cmake.html](http://www.cmake.org/cmake/help/v2.8.8/cmake.html)

如果你只是想编译然后做：“ccmake -G”Unix makefiles“..”

并禁用以下标志：“with_cuda”

这对我行得通

# mysql - Mysql 选择匹配 4、5 或 6 列

> ID：10342692
> 
> 赞同：2
> 
> 时间：2012-04-26T23:11:58.307
> 
> 标签：mysql, sql

我正在对具有 6 个不同列的数据库进行自定义搜索。为了进行搜索，我有 6 个只接受数字的不同输入字段。

我已经让 6 列搜索工作了，代码：

```
SELECT * FROM data 
WHERE 1_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a')
AND 2_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a')
AND 3_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a')
AND 4_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a')
AND 5_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a')
AND 6_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a')
ORDER BY id ASC; 
```

尽管输入的顺序，这给出了正确的结果。

但是我需要选择来给我结果，无论它是否匹配输入的 4 个或 5 个数字。我尝试了 OR，但我不知道如何定义匹配的列数。

这可能吗？

感谢关注！

**编辑： - - - - - - - - - -**

我被 dbaseman 提供的代码卡住了。

因为我得到了一个真实的结果，但我真的不知道它是通过匹配 4、5 还是 6 列生成的。

我想在之后插入一个 CASE ，但不起作用。

有没有办法知道哪个列组合给了我结果？

想到类似（粗略的）if = 4，然后是 result-4，else if = 5，然后是 result-5 ......等等......然后能够将行放入数组中。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T23:16:48.483

而不是使用和/或，总结命中：

```
SELECT *,
    CASE WHEN 1_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_1,
    CASE WHEN 2_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_2,
    CASE WHEN 3_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_3,
    CASE WHEN 4_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_4,
    CASE WHEN 5_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_5,
    CASE WHEN 6_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_6,

    CASE WHEN 1_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    + CASE WHEN 2_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    + CASE WHEN 3_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    + CASE WHEN 4_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    + CASE WHEN 5_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    + CASE WHEN 6_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    AS no_of_matches
FROM data 
WHERE 
    (
    CASE WHEN 1_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    + CASE WHEN 2_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    + CASE WHEN 3_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    + CASE WHEN 4_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    + CASE WHEN 5_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    + CASE WHEN 6_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END
    ) in (4,5,6)
ORDER BY id ASC; 
```

替代，使用嵌套查询更漂亮：

```
SELECT a.*, a.match_1+a.match_2+a.match_3+a.match_4+a.match_5+a.match_6 AS no_of_matches
FROM (
    SELECT *,
        CASE WHEN 1_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_1,
        CASE WHEN 2_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_2,
        CASE WHEN 3_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_3,
        CASE WHEN 4_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_4,
        CASE WHEN 5_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_5,
        CASE WHEN 6_column IN ('$a1a','$a2a','$a3a','$a4a','$a5a','$a6a') THEN 1 ELSE 0 END AS match_6
        FROM data 
    ) a
WHERE a.match_1+a.match_2+a.match_3+a.match_4+a.match_5+a.match_6 in (4,5,6)
ORDER BY id ASC; 
```

# python - 将文本分块成 5 行块，然后处理每个块

> ID：10342693
> 
> 赞同：1
> 
> 时间：2012-04-26T23:12:01.260
> 
> 标签：python, loops, chunking

我正在尝试编写一个程序，它将一个文本文件组织成 5 个行块，并将整个文本分割成这些块以分别处理。

目前我正在尝试使用：

```
text = open(filename).readlines()
chunk5 = zip(*(iter(text),) * 5)

for lines in chunk5:
    line = re.split('\n', text) # split a chunk into lines by line break
    # ...more statements 
```

请原谅我，因为我是一个完整的初学者，但这是正确的方法吗？我觉得chunk5 中的行中的chunk5 中缺少一些东西，这些行将指定我正在使用哪个块。

我如何让程序遍历每个块，直到它也完成了文本中的所有块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:24:43.853

我总是喜欢生成器来解决这样的问题：

```
def chunkN(lines, N):
    acc = []
    for line in lines:
        acc.append(line)
        if len(acc) == N:
             yield acc
             acc = []
    if len(acc): # remainder
        yield acc

# Now you can do this...
for chunk in chunkN(open('myfile', 'r'), 5):
    print '-' * 80
    print ''.join(chunk) 
```

我将保留块大小的参数化并访问其余部分

# python - 使用 Python 的 urllib2 向网页发送请求

> ID：10342694
> 
> 赞同：1
> 
> 时间：2012-04-26T23:12:04.420
> 
> 标签：python, urllib2

我对使用 Python 自动执行某些任务很感兴趣。具体来说，我想使用 Python 与网站交互以执行诸如从页面获取特定信息、发出请求（POST 数据并读取响应）以及下载和上传文件等任务。到目前为止，我只能使用 Python 从使用 urllib2 的页面获取 HTML。我尝试的下一件事是向页面发送请求；我做了几次尝试，但都失败了。

```
 >>> import urllib2
    >>> import urllib
    >>> url = "http://www.stackoverflow.com/"
    >>> values = {}
    >>> values["input"] = "foo"
    >>> data = urllib.urlencode(values)
    >>> request = urllib2.Request(url + "search/", data)
    >>> response = urllib2.urlopen(request)
    >>> html = response.read()
    >>> print html 
```

到目前为止，我理解的方式是我需要创建一个包含字段名称和输入的字典，并使用 urllib.urllencode(values) 对其进行编码。然后我需要使用 urllib2.Request(theUrlReceivingTheRequest, data, headers) 发出请求，如果只给定一个 url，则只会 GET，但是，如果给定数据，将 POST，并且可以给定可以将程序伪装成Firefox 或 IE 等常用浏览器。然后我得到一个带有 urllib2.urlopen(request) 的响应，它返回一个类似对象的文件，因此我可以 read()。据我了解，我还可以使用 urllib2.build_opener() 来接收处理程序（可以处理 cookie、重定向、身份验证等）并使用 .addheaders("User-Agent", "") 添加标头。我希望最终能够做到（并理解）所有这些事情，但是，首先，我只是想提交一个表格。在我与 Python 交互会话的上述代码中，我是否遵循了正确的程序？（我试图在stackoverflow首页的搜索字段中输入搜索“foo”。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T19:58:08.180

如果你使用[requests](http://python-requests.org)而不是 urllib2，你的生活会更轻松。这是您使用请求 API 的示例：

```
import requests
r=requests.post("http://www.stackoverflow.com/search/",data={'input':'foo'})
print r.text 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:38:00.037

如果您只想使用 GET 方法获取搜索结果，您可以查看 FORM 的 html 代码： `<form id="search" action="/search" method="get" autocomplete="off"> <div> <input autocomplete="off" name="q" class="textbox" placeholder="search" tabindex="1" type="text" maxlength="140" size="28" value="foo" style="width: 200px; max-width: 200px; "> </div> </form>`

操作是“/search”，输入名称是“q”，所以请求 url 将是[https://stackoverflow.com/search?q=foo](https://stackoverflow.com/search?q=foo)

所以只要使用 urllib2 打开上面的 url 就可以了。

您无需担心像“用户代理”这样的请求标头，因为 urllib2 会为您添加它，但是，您可以[显式设置它](http://docs.python.org/library/urllib2.html)。

要让它工作，你需要将“input”改为“q”并且不要在请求中使用“data”参数，否则会使用GET以外的POST，程序将是：

```
import urllib2
import urllib
url = "http://www.stackoverflow.com/"
values = {}
values["q"] = "foo"
data = urllib.urlencode(values)
request = urllib2.Request(url + "search" +"?"+ data)
response = urllib2.urlopen(request)
html = response.read()
print html

enter code here 
```

# prolog - 用 X [] 填充列表（空列表）

> ID：10342695
> 
> 赞同：0
> 
> 时间：2012-04-26T23:12:05.710
> 
> 标签：prolog

```
fillwith(X,List2):-
    length(List2,Y)
    ,Y>=X;
    append(List2,[[]],List3)
    ,fillwith(X,List3). 
```

这里的问题是，一旦它到达目标，它就会开始做一些奇怪的事情，它会回到它发出的第一个调用。例如：

```
fillwith(3,List2):-
    length(List2,Y)
    ,Y>=X;
    append(List2,[[]],List3)
    ,fillwith(X,List3). 
```

这里在第一个调用 List2 = [[]]，在第二个调用 list2 = [[]，[]]，在第三个调用 list2 = [[]，[]，[]]。但是，当它开始（我猜是回溯）时，我最终只接到了第一个电话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:17:37.430

I am still not sure, what you want, but from the comments, you simply want:

```
fillwith(X, Nils) :-
   length(Nils, X),
   nils(Nils).

nils([]).
nils([[]|Nils]) :-
   nils(Nils).

```

The goal `nils(Nils)` could be equally expressed as `maplist(=([]),Nils)`.

```
?- fillwith(4, Xs).
Xs = [[], [], [], []].

?- fillwith(X, Xs).
X = 0,
Xs = [] ;
X = 1,
Xs = [[]] ;
X = 2,
Xs = [[], []] ;
X = 3,
Xs = [[], [], []] ;
X = 4,
Xs = [[], [], [], []] ...

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T14:16:13.977

```
fillwith(X,List2):- 
   must_be(nonneg, X),
   length(List2, X),
   maplist(=([]), List2). 
```

如果您想*追加*使用：

```
fillwith(X, List2), append(List1, List2, List3). 
```

# javascript - 加速列表的 jQuery 操作

> ID：10342698
> 
> 赞同：1
> 
> 时间：2012-04-26T23:12:33.350
> 
> 标签：javascript, jquery, performance, dom, optimization

我的应用程序有一长串对象，其宽度需要通过 jQuery 进行修改。目前我正在使用这样的代码：

```
$('#my_list div.text_field').each(function() {
  // Cache objects we're going to use multiple times.
  var $textField = $(this);
  var $listContents = $textField.closest('div.list_contents');

  // Find widths.
  var contentsWidth = $listContents.outerWidth();
  var avatarsWidth = $listContents.find('div.avatars').outerWidth();
  var tagsWidth = $listContents.find('div.tags').outerWidth();
  var textLeft = $textField.position().left;

  // Update the width.
  var newTextWidth = contentsWidth - textLeft - avatarsWidth - tagsWidth;
  $textField.css({ width: newTextWidth });
}); 
```

但是，当有数百个对象需要操作时，需要一段时间（> 1 秒）。知道如何使这更快吗？我应该完全避开 jQuery 并使用原生 JS 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T02:57:11.877

好的，通过一系列改进，我能够将运行此代码（在 Chrome 18 上的一系列约 600 个项目上）所需的时间从 3000 多毫秒缩短到 70 毫秒。

最大的改进来自在原始 HTML 元素上使用 offsetWidth 而不是 jQuery 的 outerWidth() 语句。仅此一项就减少了 50% 以上的时间：

```
avatarsWidth = $listContents.find('div.avatars')[0].offsetWidth; 
```

第二个最剧烈的变化来自于减少我所做的 DOM 修改的数量。在上面的代码中，我循环遍历元素，计算它们的宽度，然后立即将这些宽度应用到 DOM。在我改进的代码中，我仍然循环计算宽度，但是我*存储*这些宽度，从 DOM 中分离元素，应用存储的宽度，然后重新附加它们。感谢@muffel 提出这个想法。这节省了总时间的 30% 以上：

```
$('#my_list div.text_field').each(function() {
  var $textField = $(this);
  // ...
  var newTextWidth = contentsWidth - textLeft - avatarsWidth - tagsWidth;
  $textField.attr('data-width', newTextWidth);
});

$('#my_list')
  .detach()
  .find('div.text_field')
    .each(function() {
      $(this).css({ width: $(this).attr('data-width') });
    })
    .end()
  .appendTo('#container'); 
```

第三大改进来自于减少遍历 DOM 的次数。我不是每次通过循环都选择元素，而是预先选择它们，然后引用循环内的索引。这构成了其余改进的大部分：

```
var $avatars = $('#my_list .avatars');
// ...
$('#my_list div.text_field').each(function(i) {
  // ...
  avatarsWidth = $avatars.eq(i).offsetWidth;
  // ...
}); 
```

希望这对某人有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:18:59.867

对于初学者来说，你不应该用 $(this) 把它包起来......除非我错过了一些东西（我可能是）你应该能够在每个 $textfield 上下文中使用“this”......这将为你节省函数调用和 var 创建。还将 var 声明移出函数......这也将节省更多周期。让我知道这是否会加快速度。

# python - 从 JSON 式值生成 SQLAlchemy 查询的工具？

> ID：10342700
> 
> 赞同：2
> 
> 时间：2012-04-26T23:12:48.243
> 
> 标签：python, json, sqlalchemy

我正在开发一个执行报告类型的应用程序，我经常需要使用 JSON 指定的过滤器，将其转换为 SQLAlchemy 查询，然后将结果发送回浏览器（例如过滤器`start_date: 1234, end_date: 5678, widget_ids: [1, 2, 3]`需要转换进入查询`… WHERE start_date >= 1234 AND end_date <= 5678 AND widget_id in (1, 2, 3)`）。

是否有工具可以自动进行这种转换（例如，使用 Django 的 ORM: 之类的后缀`start_date__ge: 1234, end_date__le: 5678, widget_id__in: [1, 2, 3]`）？

显然，这样的方案会对安全性和性能产生影响……但我想知道在我自己构建之前是否存在类似的东西。

**编辑**：我意识到我可以构建自己的东西，但我特别想知道是否有现有的工具/库，所以我不需要重新发明轮子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T06:54:00.350

我有一些可能感兴趣的简单代码（[来源](https://github.com/elemoine/papyrus/blob/master/papyrus/protocol.py#L108)）：

```
def create_attr_filter(request, mapped_class):
    """Create an ``and_`` SQLAlchemy filter (a ClauseList object) based
    on the request params (``queryable``, ``eq``, ``ne``, ...).

    Arguments:

    request
        the request.

    mapped_class
        the SQLAlchemy mapped class.
    """

    mapping = {
        'eq'   : '__eq__',
        'ne'   : '__ne__',
        'lt'   : '__lt__',
        'lte'  : '__le__',
        'gt'   : '__gt__',
        'gte'  : '__ge__',
        'like' : 'like',
        'ilike': 'ilike'
    }
    filters = []
    if 'queryable' in request.params:
        queryable = request.params['queryable'].split(',')
        for k in request.params:
            if len(request.params[k]) <= 0 or '__' not in k:
                continue
            col, op = k.split("__")
            if col not in queryable or op not in mapping.keys():
                continue
            column = getattr(mapped_class, col)
            f = getattr(column, mapping[op])(request.params[k])
            filters.append(f)
    return and_(*filters) if len(filters) > 0 else None 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T08:15:29.927

我写了类似的东西。我称之为 Python 代理。它提供了一个 Javascript API 来通过 JSON 对 Python 进行 RPC。

这是我的开源项目的一部分。

相关文件是：

[http://code.google.com/p/pycopia/source/browse/trunk/WWW/pycopia/WWW/json.py#135](http://code.google.com/p/pycopia/source/browse/trunk/WWW/pycopia/WWW/json.py#135)

Javascript方面：

[http://code.google.com/p/pycopia/source/browse/trunk/WWW/media/js/proxy.js](http://code.google.com/p/pycopia/source/browse/trunk/WWW/media/js/proxy.js)

用法：

[http://code.google.com/p/pycopia/source/browse/trunk/storage/pycopia/db/webservice.py](http://code.google.com/p/pycopia/source/browse/trunk/storage/pycopia/db/webservice.py)

示例配置：

[http://code.google.com/p/pycopia/source/browse/trunk/storage/etc/storage.conf.example](http://code.google.com/p/pycopia/source/browse/trunk/storage/etc/storage.conf.example)

但是，它是完整框架的一部分，可惜没有很好的文档记录。需要最新的 Linux 平台和一些设置。

但也许你可以从中得到一些想法。

下面是一些从 CLI 样式 (argv) 字符串构建查询的其他代码。它进行动态运算符选择。

```
def _get_query(self, argv):
    mapper = models.class_mapper(self._obj)
    args, kwargs = _query_args(argv[1:], self._environ)
    q = _session.query(self._obj)
    if args:
        grps, left = divmod(len(args), 3)
        if grps:
            for name, op, val in _by_three(args[:grps*3]):
                col = getattr(self._obj, name)
                opm = {"=": col.__eq__, 
                        ">": col.__gt__, 
                        "<": col.__lt__, 
                        "match": col.match, 
                        "contains": col.contains, 
                        "in": col.in_, 
                        "like": col.like}.get(op)
                if opm:
                    if op == "like":
                        val = val.replace("*", "%")
                        val = val.replace(".", "_")
                        if "%" not in val:
                            val = "%" + val + "%"
                    if op == "in":
                        val = val.split(",")
                    q = q.filter(opm(val))
        for name in args[grps*3:]:
            if name.startswith("="):
                q = q.order_by(name[1:])
    if kwargs:
        for name, value in kwargs.items():
            col = getattr(self._obj, name)
            value = CLI.clieval(value)
            q = q.filter(col.__eq__(value))
    return q 
```

这也可能让你开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T06:58:33.337

查看您的示例，您的`JSON`字符串实际上并不包含`operators`，因此不清楚它是否是`==, >=, <=, IN, etc`. 您的`JSON`字符串可以轻松转换为`dict`.

对于你的简单情况`have ==`，你可以简单地使用[filter_by](http://docs.sqlalchemy.org/en/rel_0_7/orm/query.html#sqlalchemy.orm.query.Query.filter_by)提供一个命名的字典：

```
query_dict = {'name': 'parent-2', 'description': 'test', }
query = query.filter_by(**query_dict) 
```

同样，您可以使用SQLAlchemy`getattr`中的回答来[构建查询 - 从 dict 动态构建查询过滤器](https://stackoverflow.com/a/7605366/99594)，但这仍然需要知道`operator`条件的。在下面的代码中仅`like`使用：

```
q = session.query(myClass)
for attr, value in web_dict.items():
    q = q.filter(getattr(myClass, attr).like("%%%s%%" % value)) 
```

如果您需要动态指定运算符，则可以进一步使用`getattr`：

```
klass, attr, oper, value = MyClass, "startDate", "__ge__", 1234
q = q.filter(getattr(getattr(klass, attr), oper)(value)) 
```

# c# - WPF 渲染的多边形形状

> ID：10342702
> 
> 赞同：0
> 
> 时间：2012-04-26T23:12:53.210
> 
> 标签：c#, wpf, geometry

我将一组点放入多边形形状中，如下所示：

```
<Polygon Points="{Binding vertices, Converter={StaticResource pointCollectionConverter}}" Stretch="None" Stroke="Black" StrokeThickness="2" Fill="#7EBB9A" /> 
```

然而，在相对复杂的输入上，多边形并没有像我期望的那样出现。例如，这是一个输出：

![在此处输入图像描述](../Images/1b4923772ce7e79927f2f16da9fe6cf1.png)

问题是这个多边形有两个不应该存在的交叉点。它应该有这些边缘（红色）：

![在此处输入图像描述](../Images/6b6bb04fed374c14dfe5dcb9783ad1c3.png)

我不知道如何解决这个问题，如果没有，我想我必须求助于手动绘制它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:29:01.167

这是正常行为，来自创建点的顺序。您的积分的来源是什么，可以重新排序吗？如果您要交换下图中指示的点，您将得到您想要的结果。

![交换这两点。](../Images/0a6ca45229069defe5e191ea3ec9aee1.png)

# visual-studio-2010 - SVN 分支 - 使用图像和 PDF 的 Visual Studio 开发环境

> ID：10342704
> 
> 赞同：0
> 
> 时间：2012-04-26T23:13:48.540
> 
> 标签：visual-studio-2010, svn, cdn

我们正在维护一个包含数千张图像和大型 PDF 文件的大型电子商务网站的代码。

我们非常擅长创建 SNV 分支，因为我们处理使用错误跟踪号命名分支的错误报告。

我们遇到了一些重大问题，因为由于大量的图像和 PDF 文件，分支需要 20 分钟来创建和上传。

然而，由于我们只处理与代码和设计相关的图像，因此在我们的解决方案中我们不需要产品图像或 PDF 手册。

**使用解决方案 > 项目（DAL、BLL、WEB 等）使用 Visual Studio 设置开发环境但没有所有额外的“媒体”文件的最佳方法是什么？**

我们仍然希望 \images\ 带有设计元素，以便我们可以看到网站设计。

如果将额外的“媒体”文件放在同一服务器内的迷你 CND 上，并且 Web.Config 设置指向它呢？

对此有任何想法/解决方案吗？

**更新 - 工作**

*详情请看我下面的回答。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T23:09:22.077

我只是不会在代码仓库中包含这些类型的资产。确实不需要 PSD 等作为 Visual Studio 解决方案的一部分。如果你继续这样做，每个分支都需要很长时间才能创建。

相反，我会为图像资产文件创建一个单独的存储库。该存储库可以位于您的代码存储库旁边，但将在服务器上单独处理。这样您就不会在每次分支代码时都制作新版本。同样，设计人员可以在该存储库中工作，而不必担心代码存储库。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T16:50:42.053

这是我们最终为解决问题所做的工作。

1.  在 /image/ 目录中，我们删除了所有“非设计”资产，例如产品图片、零售商图片等……包括 PDF 文件。

2.  为 #1 中的所有移动资产创建了一个完全独立的域名/ftp，例如 CDN.DOMAINNAME.COM

3.  重构代码/设计页面以指向所有资产的 CDN 位置示例：/images/products/<%#Eval("productImg")%> />

4.  删除了整个 SVN 项目（我们使用[BeanStalkApp](http://beanstalkapp.com/)），从本地驱动器中删除了该项目。

5.  创建 (2) SVN 和本地文件夹：DOMAINNAME.COM 和 CDN.DOMAINNAME.COM

我们的项目文件夹 DOMAINNAME.COM 大小从 24 MB 变为 3.30 MB。

CDN.DOMAINNAME.COM 的大小具有其他 20 MB 的资产。

**设计师和程序员**每隔几个小时就提交一次 DOMAINNAME.COM，包括创建需要几分钟的分支，之前需要 20-30 分钟。

**设计师**每天只提交一次或两次 CDN.DOMAINNAME.COM。我们的程序员在很大程度上选择远离 CDN.DOMAINNAME.COM SVN。

我们最近使用了[Beanstalk 的部署工具（自动）](http://support.beanstalkapp.com/customer/portal/articles/68162-what-are-deployments) ——当新产品图像发布到 SVN 时，BeanStalk 会自动将新文件推送到服务器——太酷了！

新结构一切正常，设计师和程序员都非常高兴。

# iphone - 切换视图黑页

> ID：10342707
> 
> 赞同：0
> 
> 时间：2012-04-26T23:14:08.467
> 
> 标签：iphone, xcode

我正在尝试切换视图。我的第一个视图是故事板，我想切换到 view2，在我的第一个视图中单击按钮时我没有问题，一切都很好。问题是当我试图返回时，屏幕变黑并且不会返回到第一个视图。这是我正在使用的代码。

## 视图控制器.h

```
- (IBAction)View2:(id)sender; 
```

## 视图控制器.m

```
- (IBAction)View2:(id)sender {
    View2 *second = [[View2 alloc] initWithNibName:nil bundle:nil];
    [self presentModalViewController:second animated:YES];
} 
```

这里是我用来从第二个视图返回到第一个视图的代码。

## 视图2.h

```
- (IBAction)back:(id)sender; 
```

## View2.m

```
- (IBAction)back:(id)sender {
    ViewController *second = [[ViewController2 alloc] initWithNibName:nil bundle:nil];
    [self presentModalViewController:second animated:YES];
} 
```

我在做某种错误吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:34:12.080

您的问题在 View2.m

```
- (IBAction)back:(id)sender {
    [self dismissModalViewControllerAnimated:YES];
} 
```

应该做的伎俩

苹果有一个[视图控制器编程指南](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html)，我建议浏览一下

更新如果您需要跳回多个 ViewController，您应该使用 NSNotificationCenter 或保留对您需要跳回的 viewController 的引用。

根据我的经验，以下行做了 2 件事中的 1 件事（其中 self 是 UIViewController 的子类）

```
[self dismissModalViewControllerAnimated:YES]; 
```

1）如果`self`已经呈现了另一个视图控制器，上面的行将关闭所有已经呈现在上面的视图控制器`self`

2）如果`self`还没有呈现任何其他视图控制器，上面的行将解散`self`回之前的视图控制器

# entity-framework-4 - 急切加载列表的导航属性

> ID：10342709
> 
> 赞同：2
> 
> 时间：2012-04-26T23:14:21.747
> 
> 标签：entity-framework-4, ef-code-first

使用 EF Code First 并给定一个包含列表的实体，我怎样才能急切地加载该实体的整个对象图：

例子：

```
public class Foo
{
    public int Id { get; set; }

    public List<BarBase> Bars { get; set; }
}    

public class BarBase
{
    public int Id { get; set; }

    public string Text { get; set; }
}

public class BarTypeA : BarBase
{
    public List<Baz> Bazes { get; set; }
}    

public class BarTypeB : BarBase
{
    public List<Quux> Quuces { get; set; } { get; set; }
} 
```

如果`BarBase`不是可以包含多个不同子类型实例的基类，我可以使用

```
.Include("Bars").Include("Bars.Bazes") 
```

如果我尝试

```
.Include("BarBase").Include("BarBase.Bazes").Include("BarBase.Quuces") 
```

我得到错误

> 指定的包含路径无效。EntityType 'BarBase' 没有声明名为 'Bazes' 的导航属性。

但是如何处理`Bars`可能包含不同具体类型的情况，并且我想急切地加载所有这些实例，包括`List<T>`这些具体类型中包含的实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T07:29:30.950

这是EF中[报告的问题，目前没有解决方案。](http://data.uservoice.com/forums/72025-entity-framework-feature-suggestions/suggestions/1249289-include-property-of-derived-classes)

# java - 编辑条目后列表视图滚动到顶部

> ID：10342713
> 
> 赞同：0
> 
> 时间：2012-04-26T23:14:47.523
> 
> 标签：java, android

我正在尝试创建一个列表视图，当您单击一个条目时，您可以对其进行修改，并且在点击确认后它仍将显示您刚刚修改的条目，而不是滚动到顶部。

进行了建议的更改，离开编辑活动后，它仍然滚动到顶部并且找不到正确的滚动位置。我错过了什么吗？

```
static int firstPosition = 0;

protected void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);
    Cursor c = mNotesCursor;
    ListView mListView = getListView();
    firstPosition = mListView.getFirstVisiblePosition();
    c.moveToPosition(position);
    Intent i = new Intent(this, QuoteEdit.class);
    i.putExtra(QuotesDBAdapter.KEY_ROWID, id);
    i.putExtra(QuotesDBAdapter.KEY_QUOTES, c.getString(
    c.getColumnIndexOrThrow(QuotesDBAdapter.KEY_QUOTES)));
    startActivityForResult(i, ACTIVITY_EDIT);
}
    public void onResume(int requestCode, int resultCode, Intent intent) {
ListView mListView = getListView();

if (mListView != null && firstPosition >= 0){
   mListView.scrollTo(0,firstPosition);
//  mListView.setSelection(firstPosition);

}

}
protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
    try {
        super.onActivityResult(requestCode, resultCode, intent);
        Bundle extras = intent.getExtras();
        switch(requestCode) {
            case ACTIVITY_CREATE:
                String title = extras.getString(QuotesDBAdapter.KEY_QUOTES);
                mDbHelper.createQuote(title);
                break;
            case ACTIVITY_EDIT: 
                ListView mListView = getListView();
                Long rowId = extras.getLong(QuotesDBAdapter.KEY_ROWID);
                if (rowId != null) {
                    String editTitle = extras.getString(QuotesDBAdapter.KEY_QUOTES);
                    mDbHelper.updateQuote(rowId, editTitle);
                    mListView.setSelection(firstPosition);
                }
                fillData();
                break;
        }
    }
    catch (Exception ex){
        Context context = getApplicationContext();
        CharSequence text = ex.toString();
        int duration = Toast.LENGTH_LONG;

        Toast toast = Toast.makeText(context, text, duration);
        toast.show();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T02:53:55.063

您的编辑器是另一个`Activity`，您正在调用它`startActivityForResult()`。这一行实际上并没有在这里停止——它将继续处理方法的其余部分，包括`mListView.setSelection(firstPosition);`语句。换句话说，`setSelection()`在用户开始编辑值之前调用。

当编辑器`Activity`关闭时，它会将结果返回到`onActivityResult()`. 在这种方法中，您需要告诉它再次滚动`ListView`到正确的位置。所以也许是这样的......

```
static int firstPosition = 0; // this is a global variable - set it in onListItemClick()

public void onActivityResult (int requestCode, int resultCode, Intent data){
    mListView.setSelection(firstPosition);
    } 
```

并更改您的`onListItemClick()`方法以使用全局变量，如下所示...

```
protected void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);
    Cursor c = mNotesCursor;
    ListView mListView = getListView();
    firstPosition = mListView.getFirstVisiblePosition(); // changed this line
    c.moveToPosition(position);
    Intent i = new Intent(this, QuoteEdit.class);
    i.putExtra(QuotesDBAdapter.KEY_ROWID, id);
    i.putExtra(QuotesDBAdapter.KEY_QUOTES, c.getString(
    c.getColumnIndexOrThrow(QuotesDBAdapter.KEY_QUOTES)));
    startActivityForResult(i, ACTIVITY_EDIT);
    mListView.setSelection(firstPosition);
} 
```

现在，该`setSelection()`方法不会改变滚动位置，但你可以试试这个......

在`onListItemClick()`中，更改为以下...

```
 firstPosition = mListView.getScrollY(); 
```

在 中`onActivityResult()`，更改为以下...

```
 mlistView.scrollTo(0,firstPosition); 
```

可能还会将以下代码添加到`onResume()`方法的末尾（在您的 main 中`Activity`），以便在您返回 main 时运行它`Activity`...

```
ListView mListView = getElementById("myListView");
if (mlistView != null && firstPosition >= 0){
    mlistView.scrollTo(0,firstPosition);
} 
```

# wpf - ValidationStep="UpdatedValue" 的 ValidationRule 使用 BindingExpression 而不是更新值调用

> ID：10342715
> 
> 赞同：26
> 
> 时间：2012-04-26T23:14:59.460
> 
> 标签：wpf, validation, data-binding

我开始在我的 WPF 应用程序中使用 ValidationRules，但很困惑。

我有以下简单的规则：

```
class RequiredRule : ValidationRule
{
    public override ValidationResult Validate(object value, System.Globalization.CultureInfo cultureInfo)
    {
        if (String.IsNullOrWhiteSpace(value as string))
        {
            return new ValidationResult(false, "Must not be empty");
        }
        else
        {
            return new ValidationResult(true, null);
        }

    }
} 
```

在 XAML 中使用如下：

```
<TextBox>
    <TextBox.Text>
        <Binding Path="Identity.Name">
            <Binding.ValidationRules>
                <validation:RequiredRule/>
            </Binding.ValidationRules>
         </Binding>
     </TextBox.Text>
</TextBox> 
```

这*主要*按我的预期工作。我惊讶地发现我的源属性 ( `Identity.Name`) 没有被设置；我有一个永远不会看到更改的撤消功能，除了重新键入它（不好）之外，没有办法恢复该值。

微软的[数据绑定概述](https://msdn.microsoft.com/en-us/library/vstudio/ms752347(v=vs.100).aspx)在底部附近描述了验证过程，很好地解释了这种行为。基于此，我希望将我的`ValidationStep`设置为`UpdatedValue`.

```
<validation:RequiredRule ValidationStep="UpdatedValue"/> 
```

这就是我觉得奇怪的地方。我没有使用对象值作为设置的属性值（即字符串）调用 Validate()，而是得到一个`System.Windows.Data.BindingExpression`! 我在 Microsoft 的文档中没有看到任何描述此行为的内容。

在调试器中，我可以看到源对象（ 的`DataContext`）`TextBox`，导航到属性的路径，并看到值已设置。但是，我没有看到任何在验证规则中获取正确属性的好方法。

注意：使用`ValidationStep`as `ConvertedProposedValue`，我得到输入的字符串（我没有使用转换器），但它也会在验证失败时阻止源属性更新，正如预期的那样。使用`CommittedValue`，我得到的`BindingExpression`是字符串而不是字符串。

这里有几个问题：

1.  为什么我会根据 ValidationStep 设置将不一致的参数类型传递给 Validate()？

2.  如何从 BindingExpression 获得实际值？

3.  或者，是否有一种好方法可以让用户将 TextBox 恢复到以前的（有效）状态？（正如我所提到的，我自己的撤消功能永远不会看到变化。）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-18T01:14:55.050

我已经解决了从 中提取值的问题，但`BindingExpression`有一个小的限制。

首先，一些更完整的 XAML：

```
<Window x:Class="ValidationRuleTest.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ValidationRuleTest"
        Title="MainWindow" Height="100" Width="525">
    <Window.DataContext>
        <local:MainWindowViewModel/>
    </Window.DataContext>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="50"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <TextBlock Text="String 1"/>
        <TextBox Grid.Column="1">
            <TextBox.Text>
                <Binding Path="String1" UpdateSourceTrigger="PropertyChanged">
                    <Binding.ValidationRules>
                        <local:RequiredRule ValidationStep="RawProposedValue"/>
                    </Binding.ValidationRules>
                </Binding>
            </TextBox.Text>
        </TextBox>
        <TextBlock Text="String 2" Grid.Row="1"/>
        <TextBox Grid.Column="1" Grid.Row="1">
            <TextBox.Text>
                <Binding Path="String2" UpdateSourceTrigger="PropertyChanged">
                    <Binding.ValidationRules>
                        <local:RequiredRule ValidationStep="UpdatedValue"/>
                    </Binding.ValidationRules>
                </Binding>
            </TextBox.Text>
        </TextBox>
    </Grid>
</Window> 
```

请注意，第一个 TextBox 使用`ValidationStep="RawProposedValue"`（默认），而第二个使用`ValidationStep="UpdatedValue"`，但两者都使用相同的验证规则。

一个简单的 ViewModel（忽略 INPC 和其他有用的东西）：

```
class MainWindowViewModel
{
    public string String1
    { get; set; }

    public string String2
    { get; set; }
} 
```

最后，新的RequiredRule：

```
class RequiredRule : ValidationRule
{
    public override ValidationResult Validate(object value,
        System.Globalization.CultureInfo cultureInfo)
    {
        // Get and convert the value
        string stringValue = GetBoundValue(value) as string;

        // Specific ValidationRule implementation...
        if (String.IsNullOrWhiteSpace(stringValue))
        {
            return new ValidationResult(false, "Must not be empty"); 
        }
        else
        {
            return new ValidationResult(true, null); 
        }
    }

    private object GetBoundValue(object value)
    {
        if (value is BindingExpression)
        {
            // ValidationStep was UpdatedValue or CommittedValue (Validate after setting)
            // Need to pull the value out of the BindingExpression.
            BindingExpression binding = (BindingExpression)value;

            // Get the bound object and name of the property
            object dataItem = binding.DataItem;
            string propertyName = binding.ParentBinding.Path.Path;

            // Extract the value of the property.
            object propertyValue = dataItem.GetType().GetProperty(propertyName).GetValue(dataItem, null);

            // This is what we want.
            return propertyValue;
        }
        else
        {
            // ValidationStep was RawProposedValue or ConvertedProposedValue
            // The argument is already what we want!
            return value;
        }
    }
} 
```

如果该方法获得 BindingExpression，则该`GetBoundValue()`方法将挖掘出我关心的值，或者如果不是，则简单地回退参数。真正的关键是找到“路径”，然后使用它来获取属性及其值。

限制：在我最初的问题中，我的绑定有`Path="Identity.Name"`，因为我正在挖掘我的 ViewModel 的子对象。这**不起作用**，因为上面的代码期望路径直接指向绑定对象上的属性。幸运的是，我已经扁平化了我的 ViewModel，因此不再是这种情况，但一种解决方法可能是首先将控件的 datacontext 设置为子对象。

我想感谢 Eduardo Brites，因为他的回答和讨论让我重新开始研究这个问题，并且确实为他的难题提供了一块。此外，虽然我打算完全放弃 ValidationRules 并改用 IDataErrorInfo，但我喜欢他关于将它们一起用于不同类型和复杂性的验证的建议。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-07T15:58:17.800

这是对 mbmcavoy 的[回答](https://stackoverflow.com/a/10645538/385995)的扩展。

我已经修改了该`GetBoundValue`方法以消除绑定路径的限制。BindingExpression 方便地具有属性 ResolvedSource 和 ResolvedSourcePropertyName，它们在调试器中可见，但不能通过普通代码访问。不过，通过反射获得它们是没有问题的，而且这个解决方案应该适用于任何绑定路径。

```
private object GetBoundValue(object value)
{
    if (value is BindingExpression)
    {
        // ValidationStep was UpdatedValue or CommittedValue (validate after setting)
        // Need to pull the value out of the BindingExpression.
        BindingExpression binding = (BindingExpression)value;

        // Get the bound object and name of the property
        string resolvedPropertyName = binding.GetType().GetProperty("ResolvedSourcePropertyName", BindingFlags.Public | BindingFlags.DeclaredOnly | BindingFlags.Instance).GetValue(binding, null).ToString();
        object resolvedSource = binding.GetType().GetProperty("ResolvedSource", BindingFlags.Public | BindingFlags.DeclaredOnly | BindingFlags.Instance).GetValue(binding, null);

        // Extract the value of the property
        object propertyValue = resolvedSource.GetType().GetProperty(resolvedPropertyName).GetValue(resolvedSource, null);

        return propertyValue;
    }
    else
    {
        return value;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-08T09:26:31.447

这是 mbmcavoy 和 adabyron 答案的替代扩展。

为了消除绑定路径的限制，我使用这种方法获取属性值：

```
public static object GetPropertyValue(object obj, string propertyName)
{
    foreach (String part in propertyName.Split('.'))
    {
        if (obj == null) { return null; }

        Type type = obj.GetType();
        PropertyInfo info = type.GetProperty(part);
        if (info == null) { return null; }

        obj = info.GetValue(obj, null);
    }

    return obj;
} 
```

现在简单地改变

```
object propertyValue = dataItem.GetType().GetProperty(propertyName).GetValue(dataItem, null); 
```

到

```
object propertyValue = GetPropertyValue(dataItem, propertyName); 
```

**相关文章**：[使用 C# 中的反射从字符串中获取属性值](https://stackoverflow.com/questions/1196991/get-property-value-from-string-using-reflection-in-c-sharp)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T14:16:56.120

为了回答你的2个问题：

> string strVal = (string)((BindingExpression)value).DataItem

# javascript - 如何显示动态添加内容的提示框？

> ID：10342718
> 
> 赞同：1
> 
> 时间：2012-04-26T23:15:24.030
> 
> 标签：javascript, jquery, html

我有一个网页，其中一些内容是通过 javascript 函数调用添加的。页面上的某些项目分配有提示框。对于自显示页面加载提示框以来存在的那些。而对于动态添加的内容，它们不会显示。我使用 [http://code.google.com/p/jquery-tipbox/downloads/list](http://code.google.com/p/jquery-tipbox/downloads/list) tipbox 工具

听起来这个问题没有例子就不清楚。所以，代码

```
<html>
<head>

<link rel="stylesheet" href="css/style.css" type="text/css">
<script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="js/jquery.tipbox.js" type="text/javascript"></script>

<script src="js/my_js_functions.js" type="text/javascript"></script>

<script  type="text/javascript">

$().ready(function(){  

    $("#ele1_id").tipbox("tipbox message 1", 0);
    $("#ele2_id").tipbox("tipbox message 2", 0);
    $("#inc1").tipbox("tipbox message 3", 0);
    $("#inc2").tipbox("tipbox message 4", 0);
});

</script>

</head>
<body>
<center>

<div style="visibility:visible"  >
<input id='ele1_id' type='radio' name='test' value='test1'
onClick=get_fields(id,checked)
> test 1 option <br>

<input id='ele2_id' type='radio' name='test' value='test2'
onClick=get_fields(id,checked)
>test 2 option <br>

</div>
</div></td><td alighn=center>
<div style='visibility:hidden' id='parameters'></div>
<div style='visibility:hidden' id='parameters_extra'></div>

</center>

</body>
</html> 
```

my_js_functions.js ：

```
function add_fields(name,value){

     var target=document.getElementById('parameters_extra');
     var content2="";
   if (name == 'ele1_id') {
   if (value == 'sele1') {
    content2="<table><tr><td id='inc1'>\
<b> text to which I want to have tipbox assigned (tipbox message 3) </b></td>\
<td><input type='text' maxlength=5 name='inp_value1' ></td></tr></table>";
   }
   else if (value == 'sele2') {
    content2="<table><tr><td id='inc2'>\
<b> another text for which 'tipbox message 4' has to appear </b></td>\
<td><input type='text' maxlength=5 name='inp_value2' ></td></tr></table>";
   }
  }
     target.innerHTML = content2;
     target.style.visibility = "visible";

return false;

}

function get_fields(el,checked){

     var target=document.getElementById('parameters');
     var content;

     var target2=document.getElementById('parameters_extra');
     target2.style.visibility = "hidden";

   if (checked){
   if (el == 'ele1_id') {
        content="<table><tr><td><b>select one of the options:</b></td><td>\
<select onChange=add_fields('ele1_id',this.options[this.selectedIndex].value) na
me='ele1_id'>\
<option selected='selected' value='None'>None</option>\
<option value='sele1'>Selection 1</option>\
<option value='sele2'>Selection 2</option>\
</select></td></tr></table>";
    }
   else if (el == 'ele2_id') {

        content="<table><tr><td><b>select one of the options:</b></td><td> \
  <select onChange=add_fields('ele2_id',this.options[this.selectedIndex].value) 
name='ele2_id'> \
<option selected='selected' value='None'>None</option>\
<option value='sele1'>Selection A</option>\
<option value='sele2'>Selection B</option>\
 </select></td></tr></table>";

    }
     target.innerHTML = content; 
     target.style.visibility = "visible"; 
    }
return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:28:10.633

您需要使用 jQuery 的 getScript 函数在动态加载后加载脚本，或者在 jquery 中使用 delegate()/on()/live() 将事件绑定到动态加载的元素。

[http://api.jquery.com/delegate/](http://api.jquery.com/delegate/)（已弃用） [http://api.jquery.com/live/](http://api.jquery.com/live/)（已弃用） [http://api.jquery.com/on/](http://api.jquery.com/on/) http://api.jquery。 com/jQuery.getScript/

您会看到问题在于 jquery 甚至 javascript 本身无法将事件附加到不存在的内容，因此，如果在 jquery 将事件附加到元素类型之后加载元素，则该事件不会附加到新的元素。因此，为了解决这个问题，Jquery 获取元素的父元素（通过委托/实时/打开）并动态附加事件。这真的很酷，因为它允许事件按需附加，而不是在有人在表格的每一行或类似的情况下附加事件的情况下使用 1000 个事件绑定使 JavaScript 陷入困境。

或者，如果这个动态内容只加载一次左右，虽然会更混乱、更不准确，而且效率肯定会更低，但您可以使用 getScript() 与内容一起动态加载脚本。:)

让我知道这是否有帮助。:)

# c - 交互式壳止水管

> ID：10342719
> 
> 赞同：1
> 
> 时间：2012-04-26T23:15:35.467
> 
> 标签：c, linux, shell, pipe

我的程序如下：

```
//... init fd[2] as pipe ...
if (child==0){
        close(fd[1]);
        dup2(fd[0], 0);
        execlp("/bin/sh","sh",NULL);
} else {
        close(fd[0]);
        char *line; int nbytes=100; int bytes=0;
        line=(char*) malloc(nbytes+1);
        while ( (bytes = getline((char **)&line,&nbytes,stdin))!= -1 ){
            write(fd[1],line, bytes);
        }
} 
```

这运行正常，但是当我尝试替换`exec("/bin/sh","sh",NULL)`为`exec("/bin/sh","sh","-i",NULL)`强制交互式 shell 时，我的程序在执行第一个命令后停止。

我是管道新手，所以请帮助我理解原因并让交互式外壳工作......我也觉得我的代码读取行并传递给子管道有点奇怪..有没有更好的方法来实现同样的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T04:44:56.110

你应该`close(fd[0]);`在`dup2()`孩子之后。如果您提供绝对或相对路径，则使用;`"/bin/sh"`是没有意义的。`execlp()`它只会对裸文件名（程序名）进行基于路径的搜索。调用中的演员`getline()`应该是不必要的；尽可能避免这样的演员阵容。您至少应该包括`exit(1);`after`execlp()`以防万一失败；诊断消息也是一个好主意。您应该`close(fd[1]);`在父级循环之后向子级指示 EOF。（只是一次，如果你没有检测到错误返回也没关系`malloc()`；将指针持有 NULL 的指针的地址传递给`getline()`函数，然后它会尝试自己分配内存。当然，如果主程序分配内存失败，很有可能`getline()`也会分配内存失败。）

这些变化导致：

```
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>

int main(void)
{
    int fd[2];
    pid_t child;

    if (pipe(fd) != 0)
        perror("pipe");
    else if ((child = fork()) < 0)
        perror("fork");
    else if (child == 0)
    {
        close(fd[1]);
        dup2(fd[0], 0);
        close(fd[0]);
        execl("/bin/sh", "sh", NULL);
        perror("oops");
        exit(1);
    }
    else
    {
        close(fd[0]);
        size_t nbytes = 100;
        int bytes = 0;
        char *line = (char*)malloc(nbytes+1);
        while ((bytes = getline(&line, &nbytes, stdin)) != -1)
        {
            write(fd[1], line, bytes);
        }
        close(fd[1]);
    }
    return(0);
} 
```

这在严格的编译标志下毫无怨言地编译：

```
gcc -O3 -g -std=c99 -Wall -Wextra xf.c -o xf 
```

`sh`当使用上面的代码（在没有选项的情况下调用）运行（在 Mac OS X 10.7.3 上）时`-i`，事情的表现相当合理。您可以键入命令，shell 会执行它们。您可以键入“exit”，shell 退出，但是您编写的程序（我称之为`xf`）在我键入新命令之前不会退出。然后它因为 SIGPIPE 信号而退出，因为它写入现在的无读取器管道。这个 shell 没有提示，因为它的标准输入不是终端（它是管道）。

当使用该`-i`选项运行子 shell 时，作业控制 shell 之间似乎存在关于哪个 shell 负责终端的斗争。当我运行它时，我得到：

```
$ ps -f
  UID   PID  PPID   C STIME   TTY           TIME CMD
  503   381   372   0 Wed08PM ttys001    0:00.07 -sh
  503 21908   381   0  9:32PM ttys001    0:00.01 sh
$ ./xf
sh-3.2$ 

[1]+  Stopped(SIGTTIN)        ./xf
$ 
$ ps -f
  UID   PID  PPID   C STIME   TTY           TIME CMD
  503   381   372   0 Wed08PM ttys001    0:00.07 -sh
  503 21908   381   0  9:32PM ttys001    0:00.01 sh
  503 22000 21908   0  9:36PM ttys001    0:00.00 ./xf
  503 22001 22000   0  9:36PM ttys001    0:00.00 sh -i
$ ls
awk.data           osfile-keep.c      pthread-2.c        send.c             xf
const-stuff.c      perl.data          pthread-3.c        so.8854855.sql     xf.c
fifocircle.c       piped-merge-sort.c quine.c            strandsort.c       xf.dSYM
madump.c           powa.c             recv.c             unwrap.c           xxx.sql
makefile           pthread-1.c        regress.c          vap.c              yyy.sql
$ jobs
[1]+  Stopped(SIGTTIN)        ./xf
$ fg %1
./xf
exit
$ 
```

（最初`-sh`是我的终端窗口的登录 shell。在那里，我运行`sh`以获得一个子 shell，并且我已经设置了提示符`PS1='$ '`以使提示符与众不同。）

AFAICT，`sh-3.2$`提示来自`sh -i`外壳。父shell好像在读输入，把`xf`程序dump到后台了，不太文明。`ps -f`输出不显示命令，这`ps`很麻烦。我确实设法让`ls`命令在一次运行中显示在`ps`列表中，它是原始 shell 的子代，而不是`sh -i`run by `xf`。当我`xf`进入前台时，它立即退出（大概它从标准输入读取 0 字节，表示 EOF，因此`getline()`返回 -1，一切都关闭了。`exit`来自`sh -i`; 它回应它。它从未得到任何输入因为`sh`shell接受了命令而不是让`xf`控制终端。这是非常混乱的。我不知道为什么会这样，但我觉得它不应该那样发生。

# c# - 更改 AutoScaleMode，或从 FlowLayoutPanel 更改为 TableLayoutPanel？

> ID：10342722
> 
> 赞同：2
> 
> 时间：2012-04-26T23:16:12.457
> 
> 标签：c#, winforms, scale, tablelayoutpanel, flowlayoutpanel

FlowLayoutPanel 上的控件在我的机器上看起来很完美，但在另一台机器上却全都搞砸了（这是“未对齐”的技术术语）。我的是XP，他的是Windows 7，但我不知道这是不匹配的原因还是它的屏幕分辨率或其他原因。

我确实注意到 FlowLayoutPanel 非常敏感/笨拙 - 即使在设计时更改 BorderStyle 也会导致控件重新排列，使它们不再相互对齐。

我在 StackOverflow 文章中看到了更改（表单的）AutoScaleMode 属性的建议，但发帖人没有指定什么（或从什么；我猜默认属性值为“Font”）。

从 FlowLayoutPanel 切换到 TableLayoutPanel 是否会在 DPI 设置或任何问题之间提供更一致的视觉体验？

顺便说一句：WPF 目前不是我们的选择。

# php - 限制对 pdf 的直接访问，但允许通过查看 After googling I didn't find answer to my question. So, question. I have site with http://www.emathhelp.net Inside it there is folder with pdf files. 问问题 问问题 2012-04-26T23:16:27.183 1002 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. After googling I didn't find answer to my question. So, question. I have site with http://www.emathhelp.net Inside it there is folder with pdf files. I want to restrict direct access to pdf files, so http://www.emathhelp.net/1/3192849.pdf will return error, but a page with code will correctly fetch pdf. One of the attempts was to redirect all urls that end with .pdf to php script which then will find the page where pdf is embedded and redirect there. It was done, however inside there is black screen, because I guess data="pdf/1/3192849.pdf" is rewritten also an thus infinite loop is created. Can you help me? Maybe there are some solutions through .htaccess, maybe I don't need to use . Please, write your suggestions. Take it out of the web root folder. However, when it is supposed to be shown, use PHP to copy it to a temp location in your web root folder and display it to the user who is meant to see it. Keep a record of the temp file in a database, so that it is removed after say 1-2hrs. Links: Copy a file in PHP PHP PDO tutorial phppdfmod-rewriteapache2file-access 4 1 回答 1 This answer is useful 1 将其从 Web 根文件夹中取出。但是，当它应该显示时，使用 PHP 将其复制到您的 Web 根文件夹中的临时位置，并将其显示给打算查看它的用户。在数据库中记录临时文件，以便在 1-2 小时后将其删除。 链接： 在 PHP 中复制文件 PHP PDO 教程 于 2012-04-26T23:18:51.413 回答 Related 4 php - jQuery - 使用 return false 后查询不会停止 0 symfony - FOS 用户包。如何在“记住我”登录时重定向？ 1 c++ - 未解决的重载函数类型——C++中的数组下标重载 2 python - 通过发布表格从网站收集数据 2 redirect - 在 Go 中查询没有重定向的 URL 4 c# - 为什么在 Parallel.ForEach 中每个线程多次调用 localInit Func 2 python - 如何从列表创建二维表？ 1 php - 在php中为通用api编写保存方法 1 php - 从文件中删除扩展名 3 unicode - 带有 Gtk3 的 Python 没有正确设置 unicode Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10342723
> 
> 赞同：1
> 
> 时间：
> 
> 标签：php, pdf, mod-rewrite, apache2, file-access

After googling I didn't find answer to my question. So, question. I have site with [http://www.emathhelp.net](http://www.emathhelp.net) Inside it there is folder with pdf files.

I want to restrict direct access to pdf files, so [http://www.emathhelp.net/1/3192849.pdf](http://www.emathhelp.net/1/3192849.pdf) will return error, but a page with code `<object data="pdf/1/3192849.pdf"></object>` will correctly fetch pdf.

One of the attempts was to redirect all urls that end with .pdf to php script which then will find the page where pdf is embedded and redirect there. It was done, however inside `<object></object>` there is black screen, because I guess `data="pdf/1/3192849.pdf"` is rewritten also an thus infinite loop is created.

Can you help me? Maybe there are some solutions through .htaccess, maybe I don't need to use `<object>`. Please, write your suggestions.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:18:51.413

将其从 Web 根文件夹中取出。但是，当它应该显示时，使用 PHP 将其复制到您的 Web 根文件夹中的临时位置，并将其显示给打算查看它的用户。在数据库中记录临时文件，以便在 1-2 小时后将其删除。

链接：

*   在 PHP 中[复制文件](http://php.net/manual/en/function.copy.php)
*   PHP [PDO 教程](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)

# access-token - 访问令牌？

> ID：10342725
> 
> 赞同：1
> 
> 时间：2012-04-26T23:16:45.537
> 
> 标签：access-token, facebook-authentication, facebook-access-token

我正在开发一个托管在 Heroku 上的 PHP 应用程序，我最大的问题是没有为用户获取访问令牌以使我的应用程序完全工作。该应用程序非常适合我（因为我是管理员），但与该应用程序无关的其他人无法让该应用程序显示任何内容。我还尝试使用测试用户来查看它是否会起作用，但仍然没有运气。我很确定这与访问令牌和应用程序无权执行其操作有关。我该如何以及在哪里解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T05:53:59.490

**对于我使用的用户 access_token**，数字是应用程序 ID。

* * *

```
if($_SESSION['fb_135669679827333_access_token']){
$access_token = $_SESSION['fb_135669679827333_access_token'];
} 
```

* * *

**对于应用程序访问令牌，**我使用 cURL。返回结果就像 access_token=xxxxxxxxxx 一样使用 - /anotherfeed/feed?$app_access_token

* * *

```
$app_access_token = GetCH();
function GetCH(){
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "https://graph.facebook.com/oauth/access_token?client_id=APP_ID&client_secret=SECRET_KEY&grant_type=client_credentials");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERAGENT, $_SERVER['HTTP_USER_AGENT']);
if(substr($url,0,8)=='https://'){
    // The following ensures SSL always works. A little detail:
    // SSL does two things at once:
    //  1\. it encrypts communication
    //  2\. it ensures the target party is who it claims to be.
    // In short, if the following code is allowed, CURL won't check if the 
    // certificate is known and valid, however, it still encrypts communication.
    curl_setopt($ch,CURLOPT_HTTPAUTH,CURLAUTH_ANY);
    curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,false);
}
$sendCH = curl_exec($ch);
curl_close($ch);
return $sendCH;
}; 
```

# javascript - 从 startIndex 到 endIndex 加入数组

> ID：10342728
> 
> 赞同：18
> 
> 时间：2012-04-26T23:17:00.567
> 
> 标签：javascript, arrays, join, indexing

我想问一下是否有某种实用函数可以在提供索引的同时提供数组连接。也许jQuery的原型提供了这个，如果没有，我会自己写:)

我期望的是

```
var array= ["a", "b", "c", "d"];
function Array.prototype.join(seperator [, startIndex, endIndex]){
  // code
} 
```

这样 array.join("-", 1, 2) 将返回 "bc"

在一个非常常见的 Javascript 库中是否有这种实用功能？

关于全球蠕虫

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-04-26T23:20:39.337

它在本地工作

```
["a", "b", "c", "d"].slice(1,3).join("-") //b-c 
```

如果你想让它表现得像你的定义，你可以这样使用它：

```
Array.prototype.myJoin = function(seperator,start,end){
    if(!start) start = 0;
    if(!end) end = this.length - 1;
    end++;
    return this.slice(start,end).join(seperator);
};

var arr = ["a", "b", "c", "d"];
arr.myJoin("-",2,3)  //c-d
arr.myJoin("-") //a-b-c-d
arr.myJoin("-",1) //b-c-d 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-26T23:20:47.897

只需将您想要的阵列切片，然后手动加入即可。

```
var array= ["a", "b", "c", "d"];
var joinedArray = array.slice(1, 3).join("-"); 
```

注意：`slice()`不包括指定的最后一个索引，因此 (1, 3) 等价于 (1, 2)。

# php - 升级到 PHP 5.4.0 后调用未定义的方法

> ID：10342738
> 
> 赞同：3
> 
> 时间：2012-04-26T23:17:58.260
> 
> 标签：php, apc, fatal-error

被这个给难住了。这段代码给了我

> PHP 致命错误：调用未定义的方法 MyObject::helloWorld()

但只有我第二次运行它，第一次运行良好。

```
class MyObject
{

  function __construct()
  {
    echo("creating MyObject...");
  }

  public function helloWorld()
  {
    echo("Hello World!");
  }

}

$obj = new MyObject();
$obj->helloWorld(); 
```

我还看到第二次生成“正在创建 MyObject ...”，但没有看到“Hello World！”。

我正在升级到 PHP 5.4.0。

我一定错过了一些非常明显的东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-27T04:34:14.587

这是 APC 错误...您可以根据您的配置应用补丁`/etc/php.ini`或禁用 APC。`/etc/php.d/apc.ini`

第一次运行脚本时，操作码会生成并由 APC 缓存，第二次运行脚本时，操作码会从 APC 缓存中提取。因为 APC 缓存很糟糕，所以您的脚本在运行的几秒钟内就会失败。

请参阅此错误以获取参考[php #61219](https://bugs.php.net/bug.php?id=61219)和[php #60658](https://bugs.php.net/bug.php?id=60658)

# c - 多线程程序中的输出

> ID：10342739
> 
> 赞同：0
> 
> 时间：2012-04-26T23:18:06.650
> 
> 标签：c, pthreads

在多线程上编写我的基本程序，我遇到了几个困难。

在下面的程序中，如果我在位置 1 休眠，则打印的共享数据的值始终为 10，而在位置 2 保持休眠，共享数据的值始终为 0。

为什么会出现这种输出？如何决定我们应该在哪个地方睡觉。这是否意味着如果我们在互斥锁中放置一个睡眠，那么另一个线程根本不会被执行，因此共享数据为 0。

```
 #include <pthread.h>
    #include <stdio.h>
    #include <stdlib.h>
    #include<unistd.h>

    pthread_mutex_t lock;

    int shared_data = 0;

    void * function(void *arg)
    {
        int i ;
        for(i =0; i < 10; i++)
        {
            pthread_mutex_lock(&lock);
            shared_data++;
            pthread_mutex_unlock(&lock);
        }

        pthread_exit(NULL); 
    }

    int main()
    {
        pthread_t thread;
        void * exit_status;
        int i;

        pthread_mutex_init(&lock, NULL);

        i = pthread_create(&thread, NULL, function, NULL);

        for(i =0; i < 10; i++)
        {
            sleep(1);      //POSITION 1
            pthread_mutex_lock(&lock);
            //sleep(1);    //POSITION 2
            printf("Shared data value is %d\n", shared_data);
            pthread_mutex_unlock(&lock);
        }

        pthread_join(thread, &exit_status);

        pthread_mutex_destroy(&lock);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:32:42.140

当您在锁定互斥锁之前休眠时，您将给另一个线程足够的时间来更改共享变量的值。这就是为什么您在位置#1 中看到“sleep”的值为“10”。

当您首先获取互斥锁时，您可以足够快地锁定它，以便在其他线程有机会修改它之前打印出该值。另一个线程坐下来阻塞`pthread_mutex_lock()`调用，直到你的主线程完成睡眠并解锁它。那时，第二个线程终于开始运行并更改值。这就是为什么您在位置#2 处看到“睡眠”的值为“0”的原因。

这是竞态条件的经典案例。`sleep`在不同的机器上，相同的代码可能不会在位置#2的调用中显示“0” 。在您的主线程锁定互斥锁之前，第二个线程完全有可能有机会更改变量的值一次或两次。互斥锁可以确保两个线程不会同时访问同一个变量，但它无法控制两个线程访问它的顺序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T23:33:03.467

我在这里有一个完整的解释，但最终删除了它。这是一个基本的同步问题，您应该能够在处理任何更复杂的问题之前对其进行跟踪和识别。

但我会给你一个提示：只有`sleep()`在位置 1 才重要；锁内的另一个无关紧要，只要它不更改锁外的代码即可。

# java - 有没有人使用 Java，javax.microedition.contactless 使用 NFC？

> ID：10342741
> 
> 赞同：2
> 
> 时间：2012-04-26T23:18:12.413
> 
> 标签：java, android, api, nfc

我一直在尝试对此进行调查，似乎很难找到好的可靠信息。有没有人创建了任何与 NFC 手机、卡等交互的 java 包。我还没有找到很多关于 NFC 如何真正工作的信息。我只想在扫描时能够读取手机的 ID 或电话号码。有什么办法可以做到这一点？

我在读这个：

[http://java.sun.com/developer/technicalArticles/javame/nfc/](http://java.sun.com/developer/technicalArticles/javame/nfc/)

其中提到了包裹`javax.microedition.contactless`

但似乎无法弄清楚如何实现它。我在 Java 方面不是很好，只是在我的第二个学期。这在我头上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T03:24:46.767

Android 有自己的 Java API，这与 JavaMe 不同。这不仅适用于 NFC，也适用于其他领域。您可以在诺基亚 6212、一些三星和 Sagem 等支持 JavaMe NFC 的手机上使用上述 API。

如果您打算使用 NFC，我建议您使用 Android - 市场上有 2 款广泛使用的 NFC 手机或 Symbian，其中已经发布了数十种型号。另一种选择是使用 RIM BlackBerry。

BR 斯坦

# jsp - 如何通过 EL 表达式语言根据其他变量的值查找变量的值

> ID：10342745
> 
> 赞同：1
> 
> 时间：2012-04-26T23:18:48.407
> 
> 标签：jsp, jstl

假设我有两个请求属性：

1.  “fieldnames”是字段名称的列表。示例：["fielda", "fieldb"]
2.  “field.fielda”，其中包含一段 html。示例：输入字段或类似的东西

在我的 JSP 页面中，我有如下内容：

```
<c:forEach var="field" value="${fieldnames}">
  <c:set var="tmp" value="field.${field}"/>
  ${request.getAttribute(tmp)}
</c:forEach> 
```

现在的问题是，我可以通过列表看到字段的名称。我可以在临时变量中生成“正确”字段名称。但我不知道如何从请求属性映射中获取引用属性的值。这可以做到吗？我也尝试过使用 request[variable] 表示法，但无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:44:07.227

假设你有一个像这样的bean：

```
public class MyBean {
   private String fielda;
   private String fieldb;

   public String getFielda() {
      return fielda;
   }
   public void setFielda(String fielda) {
      this.fielda = fielda;
   }
   public String getFieldb() {
      return fieldb;
   }
   public void setFieldb(String fieldb) {
      this.fieldb = fieldb;
   }
} 
```

在某处使用代码：

```
MyBean field = new MyBean();
field.setFielda("Message from A");
field.setFieldb("Message from B");
request.setAttribute("field", field);

request.setAttribute("fieldnames", new String[] { 
   "fielda", "fieldb" 
}); 
```

那么这样的事情应该可以工作：

```
<c:forEach var="fn" items="${fieldnames}">
   ${requestScope.field[fn]}
</c:forEach> 
```

如果失败，或者您的代码比这更复杂，您可以在 [自定义标签](http://docs.oracle.com/javaee/5/tutorial/doc/bnalj.html)或[自定义函数](http://docs.oracle.com/javaee/5/tutorial/doc/bnahq.html#bnaio)中提取逻辑来执行[EL 评估](http://docs.oracle.com/javaee/1.4/api/javax/servlet/jsp/JspContext.html#getExpressionEvaluator%28%29)。如果这对于这种情况来说开销太大，那么也许您可以重新考虑您的代码并找到另一种方法来获得相同的结果。

# hibernate - JPA 与 Hibernate 和 Weblogic 冲突

> ID：10342746
> 
> 赞同：2
> 
> 时间：2012-04-26T23:18:48.833
> 
> 标签：hibernate, weblogic, jpa-2.0, fortify

我正在尝试使用以下版本将我的应用程序和 Web 服务部署到 weblogic：

*   网络逻辑 10.3.5
*   休眠 4.1.1
*   休眠 JPA API 2.0
*   EJB 2.0
*   爪哇 6

当我调用我的网络服务时，我得到了错误

```
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
   <S:Body>
      <ns2:Fault xmlns:ns2="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns3="http://www.w3.org/2003/05/soap-envelope">
         <faultcode>ns2:Server</faultcode>
         <faultstring>javax/persistence/OneToMany.orphanRemoval()Z</faultstring>
        <detail>
           <ns2:exception class="java.lang.NoSuchMethodError" note="To disable this feature, set com.sun.xml.ws.fault.SOAPFaultBuilder.disableCaptureStackTrace system property to false" xmlns:ns2="http://jax-ws.dev.java.net/">
               <message>javax/persistence/OneToMany.orphanRemoval()Z</message>
               <ns2:stackTrace>
                  <ns2:frame class="org.hibernate.cfg.AnnotationBinder" file="AnnotationBinder.java" line="1868" method="processElementAnnotations"/>
                  <ns2:frame class="org.hibernate.cfg.AnnotationBinder" file="AnnotationBinder.java" line="768" method="processIdPropertiesIfNotAlready"/>
... 
```

我已经检查过，没有包含其他持久性 api jar。

我的外部 jar 列表是：

*   ant-jakarta-oro-1.6.jar
*   antlr-2.7.2.jar
*   aspectjrt-1.5.3.jar
*   cactus.core.framework.uberjar.javaEE.14-1.8.1.jar
*   cactus.integration.maven2-1.8.1.jar
*   commons-beanutils-1.8.0.jar
*   commons-chain-1.2.jar
*   commons-codec-1.3.jar
*   commons-collections-3.2.1.jar
*   commons-digester-1.8.jar
*   commons-fileupload-1.1.1.jar
*   commons-httpclient-2.0-rc2.jar
*   commons-lang3-3.0.1.jar
*   commons-logging-1.1.1.jar
*   commons-validator-1.3.1.jar
*   dom4j-1.6.1.jar
*   generic-web-service-schema-4.0.jar
*   hibernate-commons-annotations-4.0.1.Final.jar
*   hibernate-core-4.1.1.Final.jar
*   hibernate-jpa-2.0-api-1.0.1.Final.jar
*   httpunit-1.6.jar
*   javassist-3.15.0-GA.jar
*   jboss-logging-3.1.0.GA.jar
*   jboss-transaction-api_1.1_spec-1.0.0.Final.jar
*   js-1.5R4.1.jar
*   jstl-1.0.2.jar
*   jtidy-4aug2000r7-dev.jar
*   junit-3.8.2.jar
*   nekohtml-1.9.6.jar
*   oracle.webservices.standalone.client-11.1.1.jar
*   oro-2.0.8.jar
*   标准 1.0.6.jar
*   struts-core-1.3.10.jar
*   struts-el-1.3.10.jar
*   struts-taglib-1.3.10.jar
*   struts-tiles-1.3.10.jar
*   weblogic-webservices-api-1.1.0.0.jar
*   xercesImpl-2.8.1.jar
*   xml-apis-1.3.03.jar
*   xmlParserAPIs-2.2.1.jar

我已经检查了这些，Hibernate JPA 是唯一具有 OneToMany 类的。我知道问题是 JPA 1.0 和 JPA 2.0 之间的冲突，所以我只想知道是否有解决冲突的方法。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T19:23:12.450

WebLogic 10.3.5*可以*支持 JPA 2，但只有在应用了本页所述的补丁之后：（至少，这是*我*让它为我工作的方式。）

*   [https://forums.oracle.com/forums/thread.jspa?threadID=1112476](https://forums.oracle.com/forums/thread.jspa?threadID=1112476)

它归结为编辑和添加`setDomainEnv.cmd`环境变量。`javax.persistence_1.0.0.0_2-0-0.jar``com.oracle.jpa2support_1.0.0.0_2-0.jar``PRE_CLASSPATH`

对于我的 Windows XP WebLogic 安装，我添加了这些行：

```
REM Add JARs for JPA 2.0 at the front of the class path.
set WLS_MODULES=%WL_HOME%\..\modules
set PRE_CLASSPATH=%WLS_MODULES%\javax.persistence_1.0.0.0_2-0-0.jar;%WLS_MODULES%\com.oracle.jpa2support_1.0.0.0_2-0.jar 
```

祝你好运，
兰迪

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T00:42:26.200

你必须使用 Hibernate JPA API 2.0 吗？

如[WebLogic doc](http://docs.oracle.com/cd/E21764_01/web.1111/e13852/toc.htm#autoId1)中所述，WebLogic 10.3.5 似乎大致只支持一个 JPA 2.0 提供程序，称为[TopLink](http://oss.oracle.com/toplink-essentials-jpa.html)。

也许你可以`hibernate-jpa-2.0-api-1.0.1.Final.jar`从你的类路径中删除并尝试使用上面提到的 WebLogic 文档中描述的 TopLink。

鉴于文档，我将只做一点说明：默认情况下，WebLogic 10.3.5 使用 JPA 1.0 以保持 Java EE 5 的兼容性。由于 JPA 2.0 是 Java EE 6 的一部分，因此您必须显式启用它。

# java - java小程序运行后重定向？

> ID：10342754
> 
> 赞同：1
> 
> 时间：2012-04-26T23:20:00.527
> 
> 标签：java, redirect, applet-servlet

我已经用谷歌搜索了，但没有得到答案。唯一接近我目标的是在 X 秒后使用元重定向，如下所示：

```
<meta http-equiv="refresh" content="5;url=index2.html"> 
```

我需要的是 php 或 html 代码来检测我的 java 小程序是否已在页面上运行，然后重定向到另一个文件地址。

我该怎么做，有人可以给我一个示例代码吗？非常感谢，感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T08:18:18.430

如果您想从您的小程序重定向，请编写以下代码：

```
import java.applet.*;
import java.awt.Graphics;
import java.net.MalformedURLException;
import java.net.URL;

public class AppletExample extends Applet
{

public void init() {

try {
getAppletContext().showDocument(new URL("http://www.google.com"), "_blank");//This is new tab/
getAppletContext().showDocument(new URL("http://www.google.com"), "_parent");//This is in the parent tab/
}
catch (MalformedURLException ex) {
System.out.println(ex.getMessage());
}
}

public void paint( Graphics g ) {

g.drawString("Go Google", 0,100);
}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:26:58.547

如果您希望从小程序内触发重定向，我会尝试使用[showDocument()](http://docs.oracle.com/javase/6/docs/api/java/applet/AppletContext.html#showDocument%28java.net.URL,%20java.lang.String%29)。它可以这样使用：

```
this.getAppletContext().showDocument(URL, "_parent"); 
```

# cakephp-2.1 - CakePHP 2.1.1 foreach

> ID：10342755
> 
> 赞同：0
> 
> 时间：2012-04-26T23:20:01.930
> 
> 标签：cakephp-2.1

在我看来，我想要一个类似这样的 HTML 表格：

```
 COUNTRY         TOWN
      france         paris 
```

这是我的查询：

```
$foo=$this->country->find('all', array(
    'contain' => array(
            'Town' => array(
                'conditions' => array("Town.country_id = country.id"),
                'fields' => array('id','name')
            )
        )
    )
); 
```

我想像这样显示到我的视图中：

```
 line6        <?php foreach ($diponibilite as $f): ?>
 line7  
 line8            <tr>
 line9                <td><?php echo $f['country']['name'];?></td>
 line10             <td><?php echo $f['town']['name'];?></td>
 line11         
 line12            </tr>
 line13        <?php endforeach; ?> 
```

模型“国家”和“城镇”是相关联的：

```
country hasmany town and town belongsto country 
```

不幸的是，一个错误：

> 注意（8）：未定义索引：名称[APP\View\index\index.ctp，第10行]

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T09:27:08.513

问题是，由于您有`Country hasmany Town`关系，一个国家可能有多个城镇（作为`debug( $f )`节目的输出）。

要打印所有城镇，您需要另一个循环：

```
<?php foreach( $diponibilite as $f ): ?>
    <tr>
        <td><?php echo $f[ 'country' ][ 'name' ]; ?></td>
        <td><?php 
            foreach( $f[ 'town' ] as $town ) {
                echo $town[ 'name' ].' ';
            }
        ?></td>
    </tr>
<?php endforeach; ?> 
```

或者，如果您只想要第一个，请使用`$f[ 'town' ][ 0 ][ 'name' ]`.

旁注：如果您正确设置了关联，则不需要查找中的条件。你可以做

```
$foo = $this->country->find( 'all', array(
    'contain' => array(
            'Town.id',
            'Town.name'
        )
    )
); 
```

# jakarta-ee - 从 servlet 运行 jar 中的类时出现 FileNotFoundException

> ID：10342756
> 
> 赞同：0
> 
> 时间：2012-04-26T23:20:29.247
> 
> 标签：jakarta-ee, servlets, filenotfoundexception

在eclipse IDE中，有一个独立的java应用程序可以读取文件。文件都在项目下的一个文件夹中。
我创建了另一个 Web 应用程序并编写了一个 servlet，并将上述应用程序的 jar 文件添加到 WEB_INF/lib 中，以便我可以使用其中的所有类。servlet 非常简单，但 java 应用程序无法读取文件，因为它使用到更早。我得到java.io.FileNotFoundException（系统找不到指定的路径）。
我检查了 jar 文件，它包含包含要读取的文件的文件夹。我什至尝试将文件夹添加到 TOMCAT 的类路径中。但我仍然无法摆脱那个错误。有人可以告诉我出了什么问题吗？

我得到错误的地方

```
public class KnowledgeSummaryServlet extends HttpServlet {

Answerer a = new Answerer(); 
```

类 Answerer 是这样的

```
public class Answerer {
Lookup lvg  = new Lookup("resources/test/xyz", "resources/test/test.txt"); 
```

这是我运行 servlet 后的错误跟踪

```
java.io.FileNotFoundException: resources\test\xyz (The system cannot              
find the path specified)
at java.io.FileInputStream.open(Native Method)
at java.io.FileInputStream.<init>(FileInputStream.java:138)
at java.util.Scanner.<init>(Scanner.java:656)
at com.Lookup.localInitialize(Lookup.java:49)
at com.Lookup.<init>(Lookup.java:44)
at com.Answerer.<init>(Answerer.java:27)
at com.web.KnowledgeSummaryServlet.<init>(KnowledgeSummaryServlet.java:20)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
at java.lang.Class.newInstance0(Class.java:372)
at java.lang.Class.newInstance(Class.java:325)
at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:119)
at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1048)
at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:799)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:135)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:108)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:558)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:379)
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:243)
at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:259)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:281)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T04:32:29.677

您不应该使用`FileInputStream`. 这是没有意义的。使用 . 获取类路径资源作为类路径资源`ClassLoader`。

假设您在一个 servlet 中并假设该`/resources`文件夹是类路径的一部分，只需按如下方式获取它们：

```
ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
InputStream xyzInput = classLoader.getResourceAsStream("test/xyz");
InputStream txtInput = classLoader.getResourceAsStream("test/test.txt");
// ... 
```

# android - 使用renderscript操作android活动窗口？

> ID：10342758
> 
> 赞同：1
> 
> 时间：2012-04-26T23:20:47.390
> 
> 标签：android, animation, android-activity, renderscript

我想知道是否可以使用 Android 渲染脚本来操作活动窗口。例如，如果可以实现类似 [3dCarousel](http://www.youtube.com/watch?v=d2caXMF-ud8)的东西，并且在每个窗口中都运行活动？

我研究了很长时间，我找到的所有示例都是用于在屏幕上操作位图的。如果这是真的，并且 renderscript 仅适用于图像，那么[SPB Shell 3d](http://spb.com/android-software/shell)中使用的是什么，或者这些面板不是实际的活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:50:33.350

在我看来，这些不是活动。要直接回答您的问题，据我所知，没有办法使用 renderscript 做您想做的事情，因为它的工作原理阻止它控制活动。该控件实际上以相反的方式工作……但是，您可以构建一系列包含渲染脚本表面视图的片段，但是至少可以说，它的处理负载是可怕的。我不确定如何获取这些片段或活动，然后绘制轮播。

我*认为*他们正在做的是使用渲染脚本或打开 gl 来绘制轮播，然后将图标图像放置在需要的位置。但我从未制作过主屏幕应用程序，所以在这方面我可能并且很可能是错误的。

# multithreading - Scala 中共享非线程安全资源的简单并行化

> ID：10342760
> 
> 赞同：1
> 
> 时间：2012-04-26T23:20:53.950
> 
> 标签：multithreading, scala, parallel-processing

我经常想要并行化依赖于非线程安全共享资源的任务。考虑以下非线程安全类。我想在`data: Vector[String]`.

```
class Processor { def apply: String => String } 
```

基本上，我想创建`n`线程，每个线程都有一个数据实例`Processor`和一个分区。Scala 并行集合让我觉得并行化应该很简单。但是，它们似乎不太适合这个问题。是的，我可以使用演员，但 Scala 演员可能会被弃用，而 Akka 似乎有点矫枉过正。

首先想到的是有一个同步的映射，然后使用并行集合，在这个线程安全的映射中`Thread -> Processor`查找我的。`Processor`有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T13:57:25.120

您可以使用[`ThreadLocal`](http://docs.oracle.com/javase/7/docs/api/java/lang/ThreadLocal.html). 这将保证`Processor`每个线程都是唯一的。

```
val processors = new ThreadLocal[Processor] {
  def initialValue() = new Processor
}

data.par.map(x => processors.get.apply(x)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T16:30:04.903

或者，您尝试使用配置为显式使用指定数量的线程的执行器服务：

```
 val processors = new ThreadLocal[Processor] {
    override def initialValue() = new Processor
  }

  val N = 4

  // create an executor with fixed number of threads
  val execSvc = Executors.newFixedThreadPool(N)

  // create the tasks
  data foreach {
    loopData =>
      execSvc.submit(new Runnable() {
        def run = processors.get().apply(loopData)
      })
  }

  // await termination
  execSvc.shutdown()
  while(!execSvc.awaitTermination(1, TimeUnit.SECONDS)) {
    ;
  }

  // processing complete! 
```

# php - 将变量发送到 PHP 并使用 jquery 重新加载？

> ID：10342761
> 
> 赞同：0
> 
> 时间：2012-04-26T23:21:00.200
> 
> 标签：php, jquery

我对所有这些编码都是全新的......所以我提前为我的无知道歉。

我有这个 jquery 函数（按钮），它改变了加载 Post.php 的表的大小（在纵向和横向之间交替）。该函数本身在更改大小方面效果很好，但是我被困在重新加载 post.php 页面。

```
 $("#cSize").toggle(
 function () {
 $('#p_CWidth').animate({width:720});
 $('#p_SWidth').animate({width:110});
 }, function() {
     $('#p_CWidth').animate({width:520});
 $('#p_SWidth').animate({width:310});
 }); 
```

我需要添加到此代码中的是将变量 p_Type 更改为 true 或 false 并重新加载 post.php 或 div p_Post

```
 <div id="p_Post">
 <? $p_type = true;
 include 'profile/post.php'; ?>
 </div> 
```

带有上述代码的 post.php 加载正常，我通过手动将 p_type 更改为 false/true 对其进行了测试，并且加载正常。但是我怎样才能用上面的 jquery functoin 实现这个自动化呢？

我已经尝试过 .load('profile/post.php') 但这给我带来了数据库访问错误！

非常感谢任何帮助 AB

# 更新

我已将我的 php 文件更改为一个简单的 php，没有任何指向 mysql 的链接进行测试，并且我尝试了建议的代码：

```
var p_type = false;
$("#cSize").toggle(function () {
   $("#p_post").load('profile/post.php',{ 'p_type' : p_type }, function { 
       p_type = !p_type; //toggle the value for automation
});

   $('#p_CWidth').animate({width:720});
   $('#p_SWidth').animate({width:110});

}); 
```

可悲的是，这似乎不起作用？！

但是经过一些试验和错误，我已经设法使大小的变化再次起作用，并且第一次使用新的正确变量（p_type）重新加载了 php，但是由于某种原因，php 文件只加载了一次！所以它不会回到正常大小（p_type 设置为假后为真）？？？这是代码：

```
 $("#cSize").toggle(
    function () {
  $('#p_CWidth').animate({width:720});
  $('#p_SWidth').animate({width:110});
  $("#p_Post").load('profile/p_post.php',{ p_type : false });
}, function() {
      $('#p_CWidth').animate({width:520});
  $('#p_SWidth').animate({width:310});
  $("#p_Post").load('profile/p_post.php',{ p_type : true });
   }); 
```

再次感谢您

附言。这是我遵循的切换示例[http://jsfiddle.net/6FMZY/](http://jsfiddle.net/6FMZY/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:26:03.923

您可以像这样向您的 jQuery 代码段添加其他数据

```
$("#p_post").load('profile/post.php',{ p_type : false }); 
```

但是由于您正在尝试自动化此操作，同时重新加载

```
var p_type = false;
$("#p_post").load('profile/post.php',{ 'p_type' : p_type }, function(data) { 
    'p_type' = !p_type; //toggle the value for automation
}); 
```

**更新：**

这是在切换时[*发送*](http://jsfiddle.net/6FMZY/408/)数据的模拟

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T13:15:19.670

太棒了！

我编辑了 p_post.php 通过添加 get 函数使其更容易：

```
<?
if(isset($_GET['p_type'])){
$p_type=$_GET['p_type'];
}

if($p_type == "normal"){
 // what happen here
} if($p_type == "wide"){
 // what happen here
}
?> 
```

对于我使用的 jquery：

```
$("#cSize").toggle(
function () {
   $('#p_CWidth').stop(true).animate({width:720});
   $('#p_SWidth').stop(true).animate({width:110});
   $("#p_Post").load('profile/p_post.php?p_type=wide');
}, function() {
   $('#p_CWidth').stop(true).animate({width:520});
   $('#p_SWidth').stop(true).animate({width:310});
   $("#p_Post").load('profile/p_post.php?p_type=normal');
}); 
```

现在它的工作完美，只需要对 php 的拒绝访问问题进行排序！再次感谢您的帮助

# java - Windows 64 位上的 com4j

> ID：10342765
> 
> 赞同：4
> 
> 时间：2012-04-26T23:21:20.953
> 
> 标签：java, com, java-native-interface, native-code, com4j

我已经下载了最新的 com4j jar，我正在尝试运行他们最简单的示例。

我在 Windows 7 64 位并使用 64 位 JVM。

当我运行命令时（来自 com4j 教程）：

```
java -jar tlbimp.jar -o wsh -p test.wsh %WINDIR%\system32\wshom.ocx 
```

我得到：

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: com4j-amd64.dll: %1 is 
not a valid Win32 application
        at java.lang.ClassLoader$NativeLibrary.load(Native Method)
        at java.lang.ClassLoader.loadLibrary0(Unknown Source)
        at java.lang.ClassLoader.loadLibrary(Unknown Source)
        at java.lang.Runtime.load0(Unknown Source)
        at java.lang.System.load(Unknown Source)
        at com4j.COM4J.loadNativeLibrary(COM4J.java:569)
        at com4j.COM4J.<clinit>(COM4J.java:522)
        at com4j.tlbimp.driver.Lib.getLibid(Lib.java:90)
        at com4j.tlbimp.driver.Driver.addLib(Driver.java:38)
        at com4j.tlbimp.driver.Main.doMain(Main.java:123)
        at com4j.tlbimp.driver.Main.main(Main.java:56)
Exception in thread "Com4J shutdown hook" java.lang.NoClassDefFoundError: Could
not initialize class com4j.COM4J
        at com4j.COM4J$3.run(COM4J.java:476) 
```

java代码提取jar旁边的“com4j-amd64.dll”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T20:43:52.950

最新版本刚刚发布：

[http://kohsuke.org/2012/04/27/com4j-updates/](http://kohsuke.org/2012/04/27/com4j-updates/)

[https://github.com/kohsuke/com4j/downloads](https://github.com/kohsuke/com4j/downloads)

使用这个解决了我所有的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-10T17:48:57.693

你有两个选择：

1.  下载并使用完整的最新版本（位于此处： [https](https://github.com/kohsuke/com4j/downloads) ://github.com/kohsuke/com4j/downloads ）
2.  从最新版本中提取最新的 com4j-amd64.dll
    *   下载最新版本（位于此处：[https](https://github.com/kohsuke/com4j/downloads) ://github.com/kohsuke/com4j/downloads ）。
    *   使用您最喜欢的 zip 实用程序打开 com4j.jar（阅读 7zip）
    *   将 com4j.jar\com4j\com4j-x64.dll 解压到应用程序的基本目录
    *   （可选）使用注册 dll`REGSVR32 <path to dll>\com4j-x64.dll`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T08:58:35.707

我一开始也有类似的结果。我发现 com4j 生成的 com4j-amd64.dll 是空的。补救方法是从com4j jar文件中提取文件，并通过手动操作将其放在相关目录中。Com4j 将不会自动生成该文件，因为它已经存在。因此，第一步检查文件是否为空-Carl

# java - 用数组实现最小堆：插入和删除 Min（有重复项）

> ID：10342766
> 
> 赞同：2
> 
> 时间：2012-04-26T23:21:40.397
> 
> 标签：java, arrays, data-structures, heap, min-heap

我正在尝试在 Java 中实现 Min Heap，但在插入和删除元素时遇到问题（在末尾插入，以 min 删除根）。它似乎在大多数情况下都有效（我使用一个程序来直观地显示堆，并在删除 min 时打印出新的根，诸如此类）。

我的问题是，由于某种原因，添加新项目时根不会切换到新项目，但我根本不知道为什么。此外，这似乎只是有很多重复项时的问题，堆似乎并不完全能够保持有序（父项小于子项）。在大多数情况下，它确实如此。只是偶尔不会，对我来说这似乎是随机的。

这是通过泛型完成的，并且基本上遵循大多数算法。我所知道的所有其他事实都有效，这绝对是这两种方法的问题。

```
public void insert(T e)  {
    if (size == capacity)
        increaseSize(); //this works fine

    last = curr; //keeping track of the last index, for heapifying down/bubbling down when removing min
    int parent = curr/2;
    size++; //we added an element, so the size of our data set is larger

    heap[curr] = e; //put value at end of array

    //bubble up
    int temp = curr;

    while (temp > 1 && ((Comparable<T>) heap[temp]).compareTo(heap[parent]) < 0) { //if current element is less than the parent
        //integer division
        parent = temp/2;
        swap(temp, parent); //the swapping method should be correct, but I included it for clarification
        temp = parent; //just moves the index value to follow the element we added as it is bubbled up
    }

    curr++; //next element to be added will be after this one

}

public void swap(int a, int b){
    T temp = heap[a];
    heap[a] = heap[b];
    heap[b] = temp;
}

public T removeMin() {

    //root is always min
    T min = heap[1];

    //keep sure array not empty, or else size will go negative
    if (size > 0)
        size--;

    //put last element as root
    heap[1] = heap[last];
    heap[last] = null;

    //keep sure array not empty, or else last will not be an index
    if (last > 0)
        last--;

    //set for starting at root
    int right = 3;
    int left = 2;
    int curr = 1;
    int smaller = 0;

    //fix heap, heapify down
    while(left < size && right < size){ //we are in array bounds

        if (heap[left] != null && heap[right] != null){ //so no null pointer exceptions
            if (((Comparable<T>)heap[left]).compareTo(heap[right]) < 0) //left is smaller
                smaller = left;
            else if (((Comparable<T>)heap[left]).compareTo(heap[right]) > 0) //right is smaller
                smaller = right;
            else //they are equal
                smaller = left;
        }
        if (heap[left] == null || heap[right] == null)//one child is null
        {
            if (heap[left] == null && heap[right] == null)//both null, stop
                break;
            if (heap[left] == null)//right is not null
                smaller = right;
            else //left is not null
                smaller = left;
        }

        if (((Comparable<T>)heap[curr]).compareTo(heap[smaller]) > 0)//compare smaller or only child
        {
            swap(curr,smaller); //swap with child
            curr = smaller; //so loop can check new children for new placement
        }
        else //if in order, stop
            break;

        right = 2*curr + 1; //set new children
        left = 2*curr;
    }

    return min; //return root
} 
```

任何未在方法中声明的变量都是全局的，我知道有几件事可能是多余的，比如 add 中的整个当前/最后/临时情况，所以我很抱歉。我试图让所有名称都一目了然，并解释了我在 removeMin 中所做的所有检查。任何帮助将不胜感激，我已经尽我所能查找和调试。我想我只是从根本上错过了一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-04T16:41:54.983

只是为了帮助您调试，您应该简化代码。“最后一个”变量发生了一些奇怪的事情。同样在“插入”中，当您执行循环时，温度可能应该变为 0，即

```
while (temp >= 0 &&...... 
```

# java - java中的工作线程和守护线程

> ID：10342767
> 
> 赞同：0
> 
> 时间：2012-04-26T23:21:46.070
> 
> 标签：java

我已经阅读了有关后台线程（或工作线程）的教程，现在我对 SwingWorker 和守护线程感到困惑，它们是一样的吗？如果我正在编写非 GUI 应用程序，我应该创建 SwingWorker 或守护线程，因为它们都在后台完成工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:29:03.733

s有两种类型`Thread`：守护进程和非守护进程。当所有非守护进程`Thread`停止运行时，JVM 将停止执行。

`SwingWorker`s 是一个实用程序，用于从事件调度线程异步执行一些耗时的任务，以防止您的 GUI 变得无响应。A`SwingWorker`不是 a `Thread`，它是一个`Runnable`可以提交到 a`Thread`执行的任务。

如果您不使用 GUI 做任何事情，请使用`Thread`. 如果您需要为您的 GUI 单独执行操作`Thread`，请使用`SwingWorker`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:27:16.390

SwingWorker 是一个专门的类，可以简化与用户界面的交互。只能从特殊的 gui 线程访问 gui 组件。SwingWorker 具有`done`保证在 gui 线程中执行的方法，因此您可以安全地更新 ui。

如果你不与 swing ui 交互，你应该使用简单的 Thread。此外，如果您需要几个线程，最好看看`ExecutorService`哪个是线程池。

# dynamics-crm - MSCRM for Outlook 2011 完全离线安装、SQL Exp 和所有先决条件

> ID：10342771
> 
> 赞同：0
> 
> 时间：2012-04-26T23:22:05.690
> 
> 标签：dynamics-crm, dynamics-crm-2011, crm

需要一种方法来安装 Microsoft Dynamics CRM 2011 for Outlook 的所有先决条件，我上个月一直在编写脚本安装程序应用程序，它安装的一个项目是 Outlook 的 MSCRM，初步内部测试是积极的，虽然我们在向小型测试组推出时开始看到一些问题，但主要问题是这些是偏远地区的销售代表。

我们注意到在安装 CRM 的过程中，可能需要几个小时，因为它们是通过移动宽带（空中卡）安装的，这些不是城市区域，所以充其量可能是 2G/3G 连接。

我正在寻找的是一种将所有这些打包在某些媒体上的方法，这样我就可以让它只进行本地安装，而不是仅仅从 MS 下载它，无论我抛出哪个命令开关，安装程序似乎都会这样做在那里，我已经查阅了部署指南，但在“离线”安装方面缺乏这方面的内容

这是我用来启动它的代码

```
objShell.Run("C:\OfficeTemp\CRM\Setupclient.exe /l c:\clientinstalllog.txt INSTALLLEVEL=3 /targetdir " & CRMINSTALLDIR & " /norestart") 
```

然后一些 sendkeys 回答了剩下的问题，因为我还没有找到一种方法来进行安静的基本安装，以创建一个完整的“无人值守”安装

任何帮助表示赞赏，即使 MS 也没有为我们提供答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T06:31:28.890

> echo Installing CRM 2011 prerequisites echo.
> 
> START "Installing CRM 2011 prerequisites, Please wait..." /WAIT .\prereq_XP\ReportViewer.exe /passive /norestart
> 
> START "Installing CRM 2011 prerequisites, Please wait..." /WAIT .\prereq_XP\vcredist_x86.exe /passive /norestart
> 
> START "Installing CRM 2011 prerequisites, Please wait..." /WAIT msiexec /i %CD%\prereq_XP\SSCERuntime_x86-ENU.msi /qb-! REBOOT=ReallySuppress
> 
> START "Installing CRM 2011 prerequisites, Please wait..." /WAIT msiexec /i %CD%\prereq_XP\wllogin_32.msi /qb-! REBOOT=ReallySuppress
> 
> echo Done!
> 
> echo. echo. echo Installing CRM 2011 echo.
> 
> START "Installing CRM 2011, Please wait..." /WAIT .\Client\SetupClient.exe /q /disableofflinecapability

# android - 从 Android 备份文件

> ID：10342775
> 
> 赞同：2
> 
> 时间：2012-04-26T23:22:49.853
> 
> 标签：android

我正在为 android 制作一个应用程序，旨在将用户手机上的文件备份到服务器。我该怎么做？

# sql - SQL查询将SUM结果乘以内部元素的数量

> ID：10342776
> 
> 赞同：6
> 
> 时间：2012-04-26T23:22:56.360
> 
> 标签：sql, stored-procedures

我有一个根据组件状态和可用性列出功能的查询

```
SELECT Brand.Id
  , Brand.Name
  , Brand.Impact
  , Brand.Visibility
  , Brand.Risk
  , SUM(Brand.Impact + Brand.Visibility + Brand.Risk) AS Priority

FROM Brand 
LEFT OUTER JOIN Type 
  ON Brand.Id = Type.FeatureId 
LEFT OUTER JOIN Model 
  ON Type.Id = Model.SubFeatureId 
LEFT OUTER JOIN TestingStatus 
  ON Model.StatusId = TestingStatus.Id

WHERE (Model.IsDeleted = 'False') 
  AND (Brand.IsDeleted = 'False') 
  AND (Type.IsDeleted = 'False')
  AND (@TeamId = 0 OR Model.TeamId = @TeamId)
GROUP BY Brand.YearId, Brand.Id, Brand.Name, Brand.Impact, Brand.Visibility, Brand.Risk
HAVING (Brand.YearId = @YearId) 
```

我的结果如下：

```
ID  Name    Impact  Visibility  Risk    Priority
403 Chevy   1       2           3       48
404 Nissan  1       1           1       24
405 Toyota  3       2           1       42 
```

代替

```
ID  Name    Impact  Visibility  Risk    Priority
403 Chevy   1       2           3       6
404 Nissan  1       1           1       3
405 Toyota  3       2           1       6 
```

每个品牌分别有 8、8 和 7 个型号。这意味着我的查询正在为所有人计算优先级：`Impact*models + Visibility*models + Risk*models`。

我怎样才能让我的 SQL 查询不做那个乘法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:42:41.903

根据您的评论，除非我不了解您的需求，否则我认为您不需要`SUM()`. 我想你只想要每个模型的总数。使用`SUM()`您将获得听起来不像您想要的所有记录的总数。这也将删除您的`GROUP BY`和`HAVING`

```
SELECT Brand.Id
  , Brand.Name
  , Brand.Impact
  , Brand.Visibility
  , Brand.Risk
  , (Brand.Impact + Brand.Visibility + Brand.Risk) AS Priority

FROM Brand 
LEFT OUTER JOIN Type 
  ON Brand.Id = Type.FeatureId 
LEFT OUTER JOIN Model 
  ON Type.Id = Model.SubFeatureId 
LEFT OUTER JOIN TestingStatus 
  ON Model.StatusId = TestingStatus.Id

WHERE (Model.IsDeleted = 'False') 
  AND (Brand.IsDeleted = 'False') 
  AND (Type.IsDeleted = 'False')
  AND (@TeamId = 0 OR Model.TeamId = @TeamId)
  AND (Brand.YearId = @YearId) 
```

# delphi - 如何设计类依赖试图避免得墨忒耳法则

> ID：10342782
> 
> 赞同：5
> 
> 时间：2012-04-26T23:23:41.927
> 
> 标签：delphi, law-of-demeter

好的，我已经搜索并找不到适合我的问题的解决方案，我正在重新设计我们销售点系统的一部分。假设我们有以下类：

```
TWorkShift = class
   Date: TDateTime;
   fTotalSold: Currency;
   fSales: TList<TSale>; 
public
   property TotalSold: Currency read fTotalSold write fTotalSold;
   property Sales: Currency read fSales write fSales;
end;

TSale = class
    fAmount: Currency;
    fWorkShift: TWorkShift;
public
    property Amount: Currency read fAmount write fAmount; 
    procedure Save;  
end; 
```

现在，我面临的问题是试图在不违反得墨忒耳法则的情况下得出最好的主意。我想要完成的是以下内容：

1.  每次保存新的 TSale 时，我都想将其添加到当前用户的 TWorkShift 的销售列表中，并且我想将销售金额与 TWorkShift 的“TotalSold”相加。

我尝试了两种不同的方法：

**方法一：**

// 假设我们有一个 ID 为 1 的工作班次，并从数据库中加载： CurrentShift := TWorkShift.Create(1);

```
NewSale := TSale.Create;
NewSale.Amount:=100;
NewSale.Save;

CurrentShift.Sales.Add(NewSale);
CurrentShift.TotalSold := CurrentShift.TotalSold + NewSale.Amount; 
```

这种方法的问题在于它很难测试，因为我想将求和的逻辑封装在某些类或其他地方（可能是一个新类？）。

**方法 B：**

我的另一种方法是将该代码包含在 TSale 类本身中：

```
procedure TSale.Save;
begin
    SaveToDataBase; 

    fWorkShift.Sales.Add(Self);
    fWorkShift.TotalSold := fWorkShift.TotalSold + Self.Amount;
end; 
```

我认为这种方法违反了得墨忒耳法则，我觉得不对。

我想找到一种“正确的方法”来最大限度地简化代码并在未来易于维护。因此，任何建议将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:38:07.220

如果您想向 TWorkShift 添加销售，那么您应该

```
TWorkShift.AddSale(aSale: TSale);
begin
  Sales.Add(aSale);
end; 
```

换句话说，TWorkShift 应该“要求”它需要的东西。

此外，我看不出 TSale 会有 TWorkShift 字段的任何理由。Workshift 有很多销售，但为什么 Sale 会有 WorkShift？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T09:23:43.850

当您将项目添加到 TList 时，您正在做一些事情，以便您可以使用 OnNotify。我不知道 Aurelius 是否也在使用该事件，所以我为此添加了一些代码。您只需要在将列表分配给 TWorkShift 对象后查看是否可以在框架内分配 OnNotify，因为那样它可能会覆盖 NotifySales 事件处理程序。

```
type
  TWorkShift = class
  private
    Date: TDateTime;
    fTotalSold: Currency;
    fSales: TList<TSale>;
    fNotifySales: TCollectionNotifyEvent<TSale>;
    procedure NotifySales(Sender: TObject; const Item: TSale;
      Action: TCollectionNotification);
    procedure SetSales(const Value: TList<TSale>);
  public
    property TotalSold: Currency read fTotalSold write fTotalSold;
    property Sales: TList<TSale> read fSales write SetSales;
  end;

procedure TWorkShift.NotifySales(Sender: TObject; const Item: TSale;
  Action: TCollectionNotification);
begin
  if Assigned(fNotifySales) then
    fNotifySales(Sender, Item, Action);

  case Action of
    cnAdded: fTotalSold := fTotalSold + Item.Amount;
    cnRemoved: fTotalSold := fTotalSold - Item.Amount;
  end;
end;

procedure TWorkShift.SetSales(const Value: TList<TSale>);
begin
  if Assigned(fSales) then
  begin
    fSales.OnNotify := fNotifySales;
    fNotifySales := nil;
  end;

  fSales := Value;

  if Assigned(fSales) then
  begin
    fNotifySales := fSales.OnNotify;
    fSales.OnNotify := NotifySales;
  end;
end; 
```

# android - 如何在 ListView 中保留复选框选择

> ID：10342785
> 
> 赞同：0
> 
> 时间：2012-04-26T23:24:03.603
> 
> 标签：android

我创建了一个自定义 ListView.. 我的 ListView 的每个元素都是从布局构造的。

我的布局将有一些 TextViews 和一个 ToggleButton。我的 ListView 将有大约 50 个元素，我的设备屏幕一次可以显示 2 个元素。

现在，如果我们在 Item 上选择 ToggleButton 并向下滚动我的 ListView ，则所选项目将不在屏幕上，当我回到上一个所选项目时，我发现该切换按钮的选择消失了。

我知道这是 android 中的正常行为，它将构造当前显示的元素。

但我想保持这个价值。有什么方法可以保留选择。或者我可以告诉 ListView 不要每次都构造.. 内存对我的应用程序来说不是问题。

请让我知道是否有任何好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T02:04:16.283

您可以将复选框的状态存储在以位置为键的地图中。因此，每当列表在滚动后重新加载时，它都会根据 hashmap 状态进行加载。您应该在 getView() 中编写此逻辑

# iphone - NSArray 的排序

> ID：10342786
> 
> 赞同：-1
> 
> 时间：2012-04-26T23:24:14.037
> 
> 标签：iphone, objective-c, xcode, nsmutablearray, nsarray

我正在尝试设置我的 TableView，但遇到了麻烦。我的 NSArray 的值彼此不同。我知道这很难理解，但我会尽力解释。例如

```
-(void)setUpContacts{
//set up the contacts
NSString *string = @"ABCDEFGHIJKLMNOPQRSTUVWXYZ";

letterArray = [[NSMutableDictionary alloc]init];

Contacts *contact = [[Contacts alloc]init];
contactNumbers = [contact phoneNumbers];

for (NSDictionary* info in contactNumbers) {
    firstLetter = [info objectForKey:@"lastName"];
    index = @"_";
    if([firstLetter length] > 0){
        firstLetter =[firstLetter substringToIndex:1];
        firstLetter= [firstLetter capitalizedString];
        NSRange range = [string rangeOfString:firstLetter];
        if(range.length >= 0){
            index= firstLetter;
        }
    }
    if(![letterArray objectForKey:index]){

        [letterArray setValue:[NSMutableArray array] forKey:index];
    }
    [[letterArray objectForKey:index] addObject:info];    
}NSLog(@"%@",letterArray);}

-(NSArray *)getLetterArraycount{
NSMutableArray *countArray = [[NSMutableArray alloc]init];
NSNumber *subCount;

for(id key_main in letterArray){
    subCount = 0;

    for(id key_sub in [letterArray objectForKey:key_main]){
        subCount = [NSNumber numberWithInt:[subCount intValue]+1];
    }
    [countArray addObject:subCount];

}
return countArray; 
```

}

```
- (void)viewDidLoad{
[super viewDidLoad];
[self setUpContacts];
countArrays = [self getLetterArraycount];    
indexPaths = [[NSMutableDictionary alloc]init];   

NSArray *temp = [letterArray allKeys];
NSLog(@"%@",temp);

NSLog(@"%@",countArrays);

//set up the tableView
self.myTableView = [[UITableView alloc]initWithFrame:self.view.bounds style:UITableViewStyleGrouped];
self.myTableView.delegate = self;
self.myTableView.dataSource = self;
self.title = @"Select Friends";
self.myTableView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
[self.view addSubview:myTableView];} 
```

它在控制台中像这样记录

```
 C =     (
            {
        firstName = Alex;
        kind = Mobile;
        lastName = Chang;
        name = "Alex Chang (Mobile)";
        number = "(555) 555-5555";
    },
            {
        firstName = YuYu;
        kind = Mobile;
        lastName = Chen;
        name = "YuYu Chen (Mobile)";
        number = "(408) 112-2334";
    },
            {
        firstName = Chris;
        kind = Mobile;
        lastName = Choi;
        name = "Chris Choi (Mobile)";
        number = "(999) 999-9999";
    },
            {
        firstName = Kevin;
        kind = Mobile;
        lastName = Chung;
        name = "Kevin Chung (Mobile)";
        number = "1 (231) 241-2312";
    }
);
H =     (
            {
        firstName = Danny;
        kind = Mobile;
        lastName = Huang;
        name = "Danny Huang (Mobile)";
        number = "(408) 599-9770";
    },
            {
        firstName = Ice;
        kind = Mobile;
        lastName = Huang;
        name = "Ice Huang (Mobile)";
        number = "(408) 444-4444";
    }
);
K =     (
            {
        firstName = Will;
        kind = Mobile;
        lastName = King;
        name = "Will King (Mobile)";
        number = "(415) 123-4567";
    }
);
L =     (
            {
        firstName = "";
        kind = iPhone;
        lastName = LastName;
        name = " LastName (iPhone)";
        number = "(408) 123-2555";
    },
            {
        firstName = david;
        kind = Mobile;
        lastName = lub;
        name = "david lub (Mobile)";
        number = "(666) 666-1111";
    }
);
P =     (
            {
        firstName = Jennifer;
        kind = Mobile;
        lastName = Pie;
        name = "Jennifer Pie (Mobile)";
        number = "(666) 666-6666";
    }
);
S =     (
            {
        firstName = Martin;
        kind = Mobile;
        lastName = Shen;
        name = "Martin Shen (Mobile)";
        number = "(415) 333-1234";
    },
            {
        firstName = Francis;
        kind = Mobile;
        lastName = Shung;
        name = "Francis Shung (Mobile)";
        number = "(408) 345-6789";
    }
);
V =     (
            {
        firstName = Brian;
        kind = Mobile;
        lastName = Vu;
        name = "Brian Vu (Mobile)";
        number = "(408) 234-5678";
    }
);
Y =     (
            {
        firstName = Qiu;
        kind = Mobile;
        lastName = Yang;
        name = "Qiu Yang (Mobile)";
        number = "(408) 567-8901";
    }
);
Z =     (
            {
        firstName = Joy;
        kind = Mobile;
        lastName = Zhou;
        name = "Joy Zhou (Mobile)";
        number = "(408) 765-4321";
    }
);
"_" =     (
            {
        firstName = FirstName;
        kind = Mobile;
        lastName = "";
        name = "FirstName  (Mobile)";
        number = "1 (408) 234-5141";
    }
); 
```

}

```
2012-04-26 16:14:05.195 UpOut[2693:15803] (
L,
Y,
V,
"_",
Z,
S,
K,
C,
P,
H 
```

我的问题是为什么它不首先记录“C”，而是记录“L”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:49:03.740

按字母顺序排列的答案始终获得更多支持：

```
NSArray *sortedArray = [countArray sortedArrayUsingSelector:@selector(localizedCaseInsensitiveCompare:)]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T23:33:01.750

听起来你需要学习如何使用[“ `NSSortDescriptor`”](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSSortDescriptor_Class/Reference/Reference.html)（我已经为你链接了文档）。

[这是一个相关的问题，可能有一些有用的示例代码，您可以参考](https://stackoverflow.com/questions/1844031/how-to-sort-nsmutablearray-using-sortedarrayusingdescriptors)。在您的情况下，您想要排序的键将是每个 NSDictionary 条目的 lastName 值。

# iis-7 - 我无法在网络上访问我的 IIS7 站点

> ID：10342790
> 
> 赞同：0
> 
> 时间：2012-04-26T23:24:44.953
> 
> 标签：iis-7

我有一个 IIS7 站点在服务器上运行良好，但拒绝在网络上的任何地方运行。

当登录到 IIS 服务器本身（使用远程桌面）时，网站显示正常，根据此链接（我使用此站点的端口 801）：

```
http://localhost:801/ 
```

但是，当尝试从网络访问此站点时，它会拒绝工作，并给出通用的“无法显示网页”消息，同时使用以下链接：

```
http://<<my IIS server>>:801/ 
```

然而，我注意到的另一件事是，在网络上，IIS 服务器的默认页面（端口 80）确实有效。IE 以下链接显示了标准的 IIS7 页面：

```
 http://<<my IIS server>>:80/ 
```

我读过的大多数帮助主题都指向它是防火墙问题，但是作为测试，我禁用了 IIS 服务器上的所有防火墙设置，但它仍然拒绝显示。

有没有人有任何其他建议？非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-20T09:04:17.900

运行以下测试：

检查两台计算机的连接。
防火墙设置，暂时禁用所有配置文件（私有、域、公共）的防火墙，如果可行，请尝试向防火墙添加端口规则，允许传入端口 80 的连接。
此外，检查您的绑定配置也很重要网站，绑定指定服务器应该监听传入连接的地址，确保您有“所有未分配”。

参考：[点这里！！](https://superuser.com/questions/289379/cant-access-iis7-from-my-home-network)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-20T08:58:48.540

您是否尝试过使用计算机名称和/或 IP 地址

```
e.g: http://192.168.1.105:80/
     http://DELL_PC:80/ 
```

# mingw - 无法从 Sourceforge 下载 MinGW

> ID：10342791
> 
> 赞同：12
> 
> 时间：2012-04-26T23:24:46.233
> 
> 标签：mingw, sourceforge

我想使用 mingw-get-inst-20120421.exe 从 Sourceforge 下载 MinGW C 和 C++ gnu 编译器。它让我可以选择下载预打包的存储库或最新的存储库。当我在卡巴斯基 AV 防火墙后面时，最新的一个失败了。在任何情况下，前一个都失败了。无论如何，他们根本不安装 gcc.exe。这是我的 mingw/bin 目录的图像：

[http://img163.imageshack.us/img163/5953/capturephw.jpg](http://img163.imageshack.us/img163/5953/capturephw.jpg)

```
 mingw-get.exe: *** WARNING *** http://prdownloads.sourceforge.net/mingw/pkginfo-0.5-mingw32-beta-20120416-1-bin.tar.xz?download: opened with unexpected status: code = 404
mingw-get.exe: *** WARNING *** please report this to the mingw-get maintainer
mingw-get.exe: *** ERROR *** Get package: http://prdownloads.sourceforge.net/mingw/pkginfo-0.5-mingw32-beta-20120416-1-bin.tar.xz?download: download failed
install: mingw-get-0.5-mingw32-beta-20120416-1-bin.tar.xz
mingw-get.exe: *** ERROR *** required package file is not available
mingw-get.exe: *** ERROR *** cannot install mingw-get-0.5-mingw32-beta-20120416-1-bin.tar.xz
mingw-get.exe: *** ERROR *** due to previous download failure
install: mingw-get-0.5-mingw32-beta-20120416-1-lic.tar.xz
mingw-get.exe: *** ERROR *** required package file is not available
mingw-get.exe: *** ERROR *** cannot install mingw-get-0.5-mingw32-beta-20120416-1-lic.tar.xz
mingw-get.exe: *** ERROR *** due to previous download failure
install: pkginfo-0.5-mingw32-beta-20120416-1-bin.tar.xz
mingw-get.exe: *** ERROR *** required package file is not available
mingw-get.exe: *** ERROR *** cannot install pkginfo-0.5-mingw32-beta-20120416-1-bin.tar.xz
mingw-get.exe: *** ERROR *** due to previous download failure
install: libiconv-1.14-2-mingw32-dll-2.tar.lzma
 installing libiconv-1.14-2-mingw32-dll-2.tar.lzma
install: libgmp-5.0.1-1-mingw32-dll-10.tar.lzma
 installing libgmp-5.0.1-1-mingw32-dll-10.tar.lzma
install: libmpfr-2.4.1-1-mingw32-dll-1.tar.lzma
 installing libmpfr-2.4.1-1-mingw32-dll-1.tar.lzma
install: libpthreadgc-2.9.0-mingw32-pre-20110507-2-dll-2.tar.lzma
 installing libpthreadgc-2.9.0-mingw32-pre-20110507-2-dll-2.tar.lzma
install: pthreads-w32-2.9.0-mingw32-pre-20110507-2-dev.tar.lzma
 installing pthreads-w32-2.9.0-mingw32-pre-20110507-2-dev.tar.lzma
install: libquadmath-4.6.2-1-mingw32-dll-0.tar.lzma
 installing libquadmath-4.6.2-1-mingw32-dll-0.tar.lzma
install: libgomp-4.6.2-1-mingw32-dll-1.tar.lzma
 installing libgomp-4.6.2-1-mingw32-dll-1.tar.lzma
install: libmpc-0.8.1-1-mingw32-dll-2.tar.lzma
 installing libmpc-0.8.1-1-mingw32-dll-2.tar.lzma
install: libssp-4.6.2-1-mingw32-dll-0.tar.lzma
 installing libssp-4.6.2-1-mingw32-dll-0.tar.lzma
install: libgcc-4.6.2-1-mingw32-dll-1.tar.lzma
 installing libgcc-4.6.2-1-mingw32-dll-1.tar.lzma
install: libintl-0.18.1.1-2-mingw32-dll-8.tar.lzma
 installing libintl-0.18.1.1-2-mingw32-dll-8.tar.lzma
install: mingwrt-3.20-mingw32-dll.tar.gz
 installing mingwrt-3.20-mingw32-dll.tar.gz
install: w32api-3.17-2-mingw32-dev.tar.lzma
 installing w32api-3.17-2-mingw32-dev.tar.lzma
install: mingwrt-3.20-mingw32-dev.tar.gz
 installing mingwrt-3.20-mingw32-dev.tar.gz
install: binutils-2.22-1-mingw32-bin.tar.lzma
 installing binutils-2.22-1-mingw32-bin.tar.lzma
install: libexpat-2.0.1-1-mingw32-dll-1.tar.gz
 installing libexpat-2.0.1-1-mingw32-dll-1.tar.gz
install: gdb-7.4-2-mingw32-bin.tar.lzma
 installing gdb-7.4-2-mingw32-bin.tar.lzma
install: make-3.82-5-mingw32-bin.tar.lzma
 installing make-3.82-5-mingw32-bin.tar.lzma
install: gcc-4.6.2-1-mingw32-lic.tar.lzma
 installing gcc-4.6.2-1-mingw32-lic.tar.lzma
install: libstdc++-4.6.2-1-mingw32-dll-6.tar.lzma
 installing libstdc++-4.6.2-1-mingw32-dll-6.tar.lzma
install: gcc-core-4.6.2-1-mingw32-bin.tar.lzma
 installing gcc-core-4.6.2-1-mingw32-bin.tar.lzma
install: mingw32-base-2011060500-mingw32-bin.meta
 installing mingw32-base-2011060500-mingw32-bin.meta
install: gcc-4.6.2-1-mingw32-doc.tar.lzma
 installing gcc-4.6.2-1-mingw32-doc.tar.lzma
install: gcc-4.6.2-1-mingw32-lang.tar.lzma
 installing gcc-4.6.2-1-mingw32-lang.tar.lzma
install: gcc-c++-4.6.2-1-mingw32-bin.tar.lzma
 installing gcc-c++-4.6.2-1-mingw32-bin.tar.lzma 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-02-10T19:47:22.887

prdownloads.sourceforge.net URL 通常不起作用。

我的解决方案是在 at 中编辑文件`var\lib\mingw-get\data\profile.xml`并将`<repository uri="...>`行更改为：

```
<repository uri="http://sourceforge.net/projects/mingw/files/Installer/mingw-get/catalogue/%F.xml.lzma/download"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T12:27:02.697

根据[这个](http://sourceforge.net/tracker/index.php?func=detail&aid=3524614&group_id=2435&atid=202435)问题线程，这可能是 SourceForge 的问题。我今天尝试使用 mingw-get 安装 mingw，但问题仍然存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-06-25T15:18:28.050

在尝试使用 GUI 和 CLI 安装程序在 AWS Windows 实例上安装 MinGW 时，我遇到了类似的问题。我尝试了上述“存储库 uri”设置，但这对我没有帮助。

它最终成为 Internet Explorer 的“增强”安全性。一旦我将 https://*.sourceforge.net 添加到我信任的站点，它就可以工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-02T06:08:48.803

尝试从 osdn.net 安装它
这是链接：[https](https://osdn.net/projects/mingw/releases/)
://osdn.net/projects/mingw/releases/ 它与 sourceforge 相同，但能够连接和下载
对我和我的朋友有用！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-16T13:00:57.100

以管理员身份运行 minGW 设置，这解决了我的问题

# ruby-on-rails - 是否有 yaml 格式的命名约定？

> ID：10342793
> 
> 赞同：5
> 
> 时间：2012-04-26T23:25:10.540
> 
> 标签：ruby-on-rails, internationalization, yaml

在为我的 Rails 应用程序编写 i18n yaml 文件时，我可以遵循命名约定吗？

我有一个“保存更改”按钮，对应于`Users.update`. 我不知道该怎么称呼钥匙：

```
users.edit.update
users.edit.update_button
users.edit.save_changes
users.edit.btn_update 
```

我可以遵循任何命名约定吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-06-05T19:18:39.533

没有固定的约定。您应该为您的应用程序和编程语言选择最自然的方法。

# jquery - 被其他函数调用时函数失败

> ID：10342796
> 
> 赞同：0
> 
> 时间：2012-04-26T23:25:19.173
> 
> 标签：jquery

对 jQuery 来说相当新，所以请多多包涵。

我无法将一个函数的结果传递给另一个函数并执行它。

然后重点是将文本作为 var 传递给函数 populateMessage() 并将文本写入文本框。

我可以获得文本，它确实被传递给了 populateMessage 函数，但该函数永远不会完全执行并且文本框没有被填充。如果我将 populateMessage 函数包装在 document.ready 中并让它编写类似 .text('test'); 它会起作用的。

我怎样才能使这项工作？

谢谢您的帮助

```
$(document).ready(function () {
    getClickedInvite();
});

//gets clicked item template and sends it to message box

function getClickedInvite() {
    $('.card').click(function () {
        var selectedMessage = $(this).text();
        alert(selectedMessage);
        populateMessage(selectedMessage);
    });
}

function populateMessage(selectedMessage) { 
    alert(selectedMessage + ' has been sent to the message box ')
    var inviteMessageBoxId = $('#inviteMessageBox').find('textarea').attr('id');
    alert(inviteMessageBoxId);
    $('#' + inviteMessageBoxId).text(selectedMessage);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T23:32:04.847

没有必要像那样扩展功能。如果你阅读[手册](http://api.jquery.com/find/)，它会说

> 获取当前匹配元素集中每个元素的后代，由选择器、jQuery 对象或元素过滤。

所以.find [()](http://api.jquery.com/find/)总是不返回单个元素。

```
$('#inviteMessageBox').find('textarea')[0].text(selectedMessage); 
```

或者，如果得到`id`真的那么必要，那么

```
var id = $('#inviteMessageBox').find('textarea')[0].attr('id');
$("#"+id").text(selectedMessage); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:32:41.510

jQuery 不要求您通过 'id' 引用所有内容，因此您可以将`populateMessage`函数更改为如下所示：

```
function populateMessage(selectedMessage) {
    $('#inviteMessageBox')
        .find('textarea')
        .text(selectedMessage);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T23:35:06.050

这仅在之后调用时才有效的原因`$(document).ready()`是，当您尝试将 click 事件绑定到具有该类的所有元素时，`.card`它们实际上并不存在于页面上，因此绑定失败。

当`$(document).ready();`DOM 被完全写入之后，您可以确信页面上的所有元素都准备好接受绑定到它们的事件。

解决这个问题的最好方法是立即定义你的函数，并在你知道文档准备好后将它们绑定到元素，如下所示：

```
function sayHello() {
    alert('hello');
}

$(document).ready(function() {
    $('.button1').click(sayHello);
    $('.button2').click(sayHello);
    $('.button3').click(sayHello);
}); 
```

这种方法应该让你的代码更干净。首先引用所有函数，最后绑定事件。

# css - 如何使用语义网格系统/Less 定位图像？

> ID：10342799
> 
> 赞同：1
> 
> 时间：2012-04-26T23:25:38.293
> 
> 标签：css, grid, semantics, less

我在使用语义网格系统定位图像时遇到问题。文字没有问题。

使用文本，示例代码可以正常工作。HTML：

```
<body>
<article>Main</article>
<section>Sidebar</section>
</body> 
```

较少的：

```
@import 'grid.less';

@columns: 12;
@column-width: 60;
@gutter-width: 20;

article {
.column(9);
}
section {
.column(3);
} 
```

对于 HTML 中的图像，具有以下相同的实现：

```
<body>
<article>Mainr</article>
<section><img src="title.png"
       width="705"
       height="66.5"
       alt="Title"
       class="pngimg"></section>
</body> 
```

无法定位图像。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T05:14:59.703

我假设您指的是图像比您的列更宽？这是因为即使容器很小，浏览器也不会缩放图像。在您的情况下，您有一个`.column(3)`应该渲染为 220px 宽度的图像和一个 705px 宽的图像。

解决问题的最佳方法是将图像手动缩放到 220px 的宽度或`width="100%"`在图像标签中设置（在这种情况下删除高度）。

# c# - 需要一些关于简单撤消/重做的指南

> ID：10342802
> 
> 赞同：0
> 
> 时间：2012-04-26T23:25:55.133
> 
> 标签：c#, winforms, undo-redo

这是我的第一个 C# 应用程序，完全自学，没有任何软件编程背景。我对撤消/重做进行了一些研究，但找不到任何有用的东西（或易于理解）。因此，我希望有人可以帮助我为我的程序（winforms 应用程序）设计撤消/重做功能。该应用程序由一个主窗体组成，其中将调用后续子窗体以在某些事件（按钮单击等）期间记录用户指定的值。处理完每个事件后，将在缓冲区中绘制一个位图，然后在主窗体的 OnPaint 事件期间将其加载到主窗体内的图片框。每个输入都分离成自定义类对象并添加到单独的 List 和 BindingList 中。List 中包含的对象用于图形（指示坐标等），而 BindingList 中的对象用于在 DataGridView 上显示一些重要值。只是为了给出一个简短的描述，代码看起来像这样：

```
public partial class MainForm : form
{
    public class DataClass_1
    {
        public double a { get; set; }
        public double b { get; set; }
        public SubDataClass_1 { get; set; }
    }

    public class SubDataClass_1
    {
        public double x { get; set; }
        public double y { get; set; }
        public string SomeString { get; set; }
        public CustomEnum Enum_SubDataClass_1 { get; set; }
    }

    public class DisplayDataClass
    {
        public string SomeString { get; set; }
        public double e { get; set; }
        public double f { get; set; }
    }

    public enum CustomEnum { Enum1, Enum2, Enum3 };

    // Lists that contain objects which hold the necessary values to be drawn and displayed
    public List<DataClass_1> List_1 = new List<DataClass_1>();
    public List<DataClass_2> List_2 = new List<DataClass_2>(); // Object has similar data types as DataClass_1
    public BindingList<DisplayDataClass> DisplayList = new BindingList<DisplayDataClass>();

    Bitmap buffer;

    public MainForm()
    {
        InitializeComponent();

        dgv.DataSource = DisplayList;
    }

    private void DrawObject_1()
    {
        // some drawing codes here
    }

    private void DrawObject_2()
    {
        // some drawing codes here
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        DrawObject_1();
        DrawObject_2();
        pictureBox1.Image = buffer;
    }

    // Event to get input
    private void action_button_click(object sender, EventArgs e)
    {
        ChildForm form = new ChildForm(this);
        form.ShowDialog();
        Invalidate();
    }
} 
```

子表单的代码如下所示：

```
public partial class ChildForm : form
{
    public ChildForm(MainForm MainForm)
    {
        InitializeComponent();

        // Do something
    }

    private void ok_button_click(object sender, EventArgs e)
    {
        DataClass_1 Data_1 = new DataClass_1();
        DisplayDataClass DisplayData = new DisplayDataClass();

        // Parsing, calculations, set values to Data_1 and DisplayData

        MainForm.List_1.Add(Data_1);
        MainForm.DisplayList.Add(DisplayData);

        this.DialogResult = System.Windows.Forms.DialogResult.OK;
        this.Close();
    }
} 
```

由于所有必要的数据都存储在列表中，并且只有在触发某些事件（主要是按钮单击）后才会更改，因此我尝试使用这些列表来确定运行时应用程序的状态。我实现撤消/重做功能的方法是添加以下代码：

```
public partial class MainForm : form
{
    public class State()
    {
        public List<DataClass_1> List_1 { get; set; }
        public List<DataClass_2> List_2 { get; set; }
        public BindingList<DisplayDataClass> DisplayList { get; set; }
        // and so on

        public State()
        {
            List_1 = new List<DataClass_1>();
            List_2 = new List<DataClass_2>();
            DisplayList = new BindingList<DisplayDataClass>();
        }
    }

    State currentState = new State();
    Stack<State> undoStack = new Stack<State>();
    Stack<State> redoStack = new Stack<State>();

    private void MainForm_Shown(object sender, EventArgs e)
    {
        // Saves original state as first item in undoStack
        undoStack.Push(currentState);            
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        // Update lists from currentState before drawing
        List_1 = new List<DataClass_1>(currentState.List_1);
        List_2 = new List<DataClass_2>(currentState.List_2);
        DisplayList = new BindingList<DisplayDataClass>(currentState.DisplayList);
    }

    // When undo button is clicked
    private void undo_button_Click(object sender, EventArgs e)
    {
        if (undoStack.Count > 0)
        {
            redoStack.Push(currentState);
            undoStack.Pop();
            currentState = undoStack.Last();
            Invalidate();
        }
    }

    // When redo button is clicked
    private void redo_button_Click(object sender, EventArgs e)
    {
        // Have not thought about this yet, trying to get undo done first
    }

    // Events that trigger changes to values held by data objects
    private void action_button_Click(object sender, EventArgs e)
    {
        // Replace the following code with previously stated version         
        if (form.ShowDialog() == System.Windows.Forms.DialogResult.OK)
        {
            ChildForm form = new ChildForm(this)
            UpdateState();
            undoStack.Push(currentState);
            Invalidate();
        }
    }

    // To update currentState to current values
    private void UpdateState()
    {
        currentState.List_1 = new List<DataClass_1>(List_1);
        currentState.List_2 = new List<DataClass_2>(List_2);
        currentState.DisplayList = new BindingList<DisplayDataClass>(DisplayList);
        // and so on
    }
} 
```

**结果：** 应用程序未正确执行撤消功能。程序在正常情况下显示正确的输出，但是当触发撤消事件时，无论绘制了多少对象，应用程序都会恢复到初始状态（没有记录数据的状态）。在更改堆栈以检查 undoStack 中的计数数的事件期间，我使用了 System.Diagnostics.Debug.WriteLine() 并且它似乎给出了正确的计数。我猜这些列表需要以不同的方式复制/克隆？还是我在这里做错了什么？谁能指导我？无需考虑性能、可读性、资源管理、未来维护等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:58:37.507

有很多方法可以使用，每种方法都有不同的优点和缺点，但我通常喜欢定义一个抽象的 Action 类，然后定义一个单独的 UndoRedoStack 类。

Action 类将有两个方法（Do 和 Undo），每个子类 Action 都可以实现。您将任何可以“更改状态”的逻辑隔离到这些 Action 子类，从而保持该逻辑的简洁封装。

UndoRedoStack 与常规堆栈类似，但具有三个核心方法。

1.  ApplyAction（如 Push）
2.  UndoAction（类似于 Pop，但确保只移动指针/索引而不截断或丢弃任何现有操作）。
3.  RedoAction（类似于 Push，但您使用已经在底层堆栈/列表中的下一个值，而不是推送/插入一个新值）。

通常我发现最大的挑战是设计每个 Action 子类，使其保持足够的信息来撤消和重做自身。但是，能够将所有状态操作逻辑封装到各个 Action 子类中，通常会使我在长期内更容易维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:50:06.263

您将参考对象存储在堆栈中。如果你想让你的方法工作，你需要在你的状态对象中实现一个 clone() 方法，并且每次都存储一个新的克隆，否则，所做的更改是对堆栈的每个成员进行的，因为它们都指向同一个参考对象。

# java - 数据存储区/动态文本文件中的 Google App Engine (Java) 文本

> ID：10342808
> 
> 赞同：1
> 
> 时间：2012-04-26T23:26:24.657
> 
> 标签：java, google-app-engine, text, google-cloud-datastore

我正在使用带有 Java 的 GAE 根据表单中提供的信息动态创建“文本文件”。使用表单参数，我成功生成了一个应作为 txt 文件中的文本的字符串。但是，我不确定如何以易于阅读的格式获取该字符串。最终，我希望有一个 iOS 应用程序能够阅读文本。这是我正在考虑使用的两条路线，但我都遇到了问题。

1.  将文本存储在数据库中，然后在另一个页面中显示。不幸的是，我超过了 GAE 字符串的 500 个字符限制。然后我尝试使用 Text 类，但由于它不可查询，我不确定如何从 jsp 页面访问它。

2.  动态生成带有文件内容字符串的文本文件。通过实际创建一个新文件，这个选项似乎更像是“正确的方式”。老实说，我只是不知道该怎么做。我在网上查了很多，但没有找到答案。我已经研究了 Blob API，但是是什么让我可以创建一个可以在另一个 URL 位置访问的全新文件？大多数文档处理图像或其他文件类型。

非常感谢所有回复。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T05:53:01.883

对于 1，只需记住实体的键，然后使用该键获取实体。对于 2，您也可以提供文本文件。现在我们提供[Google Cloud Storage 集成](https://developers.google.com/appengine/docs/java/googlestorage/)，因此它可能是一个更好的选择。

# java - 基于 key=String 和 Value=following Char 的 Linkedhashmap 随机生成文本

> ID：10342809
> 
> 赞同：0
> 
> 时间：2012-04-26T23:26:29.057
> 
> 标签：java, string, random, character, linkedhashmap

我有一个`LinkedHashMap`调用`generateMap`，其中包含一个字符串作为键，并且该字符串的以下字符的所有可能变体都存储为值。现在我想打印一个随机文本。（字符串的存储不是问题）

```
Example:
String = "Lorem ipsum Loram ipar"

Key----------Value
After Lor -> e,a
After ore -> m
After rem -> " "
After em  -> i
After m i -> p,p
After  ip -> s,a 
```

应该使用随机选择的下一个字符生成随机文本，然后选择下一个“窗口”，依此类推。我不知道如何生成新文本，也许你能给我一个提示？这是我到目前为止得到的：

```
for (Entry<String, ArrayList<String>> e : generateMap.entrySet()) {
            //store the values into an ArrayList        
            ArrayList<String> valuesList = new ArrayList<String>(e.getValue());
            // randomly choose on of the values
            int random = (int) (Math.random() * (valuesList.size()));
            String randomWort = valuesList.get(random);
            String print = e.getKey() + randomWort;
}
System.out.println(print); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:38:39.927

我认为你的代码没问题。以方便的方式，使用 Guava 类[LinkedHashMultimap](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/LinkedHashMultimap.html)。

一个小的改进：您不需要在循环中创建 ArrayList，`e.getValue()`已经是 ArrayList。

# jquery - 需要帮助找出错误是什么，它是 jQuery 代码

> ID：10342811
> 
> 赞同：-2
> 
> 时间：2012-04-26T23:26:56.300
> 
> 标签：jquery, lightbox

我正在尝试使用 jQuery 和 CSS 为消息制作类似灯箱的东西，但它不起作用！！！这是jQuery代码

```
$(document).ready(function(e) {

    function myFunction(){
        $("#overLay").hide();
        $("#x").hide();
        $("#message").hide();
    }

    $("#overLay").click( myFunction() );
    $("#x").click( myFunction() );

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:32:18.887

```
function myFunction(){
    $("#overLay").hide();
    $("#x").hide();
    $("#message").hide();
}
$(function(){ //run after page is loaded
   $("#overLay").click(myFunction);
   $("#x").click(myFunction);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:31:08.413

```
function myFunction(){
 $("#overLay").hide();
 $("#x").hide();
 $("#message").hide();
}

$(document).ready(function() {
 $("#overLay").click( function(){
  myFunction(); 
 });
 $("#x").click( function(){
  myFunction();
 } );
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T23:42:38.080

*至于语法部分，*您调用函数的方式是错误的，请在没有括号的情况下调用它们

```
$("#overLay").click( myFunction );
$("#x").click( myFunction ); 
```

# sql-server - 向表 sql server 添加一列零

> ID：10342818
> 
> 赞同：37
> 
> 时间：2012-04-26T23:27:20.757
> 
> 标签：sql-server

> **可能重复：**
> [将具有默认值的列添加到 SQL Server 中的现有表](https://stackoverflow.com/questions/92082/add-column-with-default-value-to-existing-table-in-sql-server)

我在 sql server 中有一个表，但想添加一个充满零的额外列

这样做的最佳方法是什么

```
att1 att2
---------
1.0   5.8
2.7   3.8
5.1   6.8 
```

变成

```
att1 att2  extra
----------------
1.0   5.8   0.0
2.7   3.8   0.0
5.1   6.8   0.0 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-26T23:30:01.647

如果我没记错的话，应该是这样的：

```
ALTER TABLE table_name 
ADD extra REAL DEFAULT 0 
```

请参阅：http: [//msdn.microsoft.com/en-us/library/ms190273.aspx](http://msdn.microsoft.com/en-us/library/ms190273.aspx)

请参阅：[向 SQL Server 中的现有表添加具有默认值的列](https://stackoverflow.com/questions/92082/add-column-with-default-value-to-existing-table-in-sql-server)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-27T01:18:34.427

我了解此列的值始终为 0.0。那么它不必是一个真正的列

```
CREATE TABLE extraColumn (
     att1   float  NULL
    ,att2   float  NULL
    ,extra AS 0.0 
) 
```

但如果你需要，你可以坚持下去

```
CREATE TABLE extraColumn (
     att1   float  NULL
    ,att2   float  NULL
    ,extra AS 0.0  PERSISTED 
) 
```

# java - 游戏UNO java代码设计

> ID：10342825
> 
> 赞同：0
> 
> 时间：2012-04-26T23:28:53.083
> 
> 标签：java, arrays, inheritance, object

因此，在设计流行的纸牌游戏“UNO”时，我遇到了一个问题，如果用户输入 (-1) 从牌组中抽出一张牌并将其放入手中，我会遇到 ArrayIndexOutOfBoundsException。现在我知道这是因为没有创建数组的另一个元素，但我不确定在这种情况下如何创建。

这是我的 addCardToHand 方法的代码：

```
public void addCardToHand(Card c)

    {
        this.cards[this.cardCount] = c;
        this.cardCount++;
    } 
```

这种方法最初适用于让玩家每人 5 张牌，但这就是我所能做的。它被另一个类中的另一个方法调用，该方法从“卡片组顶部”生成 Card 对象参数。接下来我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:34:55.420

请记住，简单数组不像`ArrayList`s 那样动态，因为它们不会自动调整大小以容纳更多条目。您可以使用 an`ArrayList`或创建一个大于 的新数组，`this.cards`并将所有值复制到其中（包括`Card`您要添加的新值），然后发出语句`this.cards = newArray`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:56:13.333

每当您无法插入新卡时，您可以创建一个大小为前一个数组两倍的新数组。这样您就不需要在每次添加卡片时复制整个数组。

因此，假设您有一个数组 a=[1,2,3] 并且您想添加一张新卡 4 但不能。您创建一个新数组 b=new Card[a.length*2]，从数组 a 复制先前的值，并将 4 放在您需要的位置。你最终得到一个数组 a=[1,2,3,4,-,-]。添加 3 张卡片后，您将有一个数组 a=[1,2,3,4,5,6,7,-,-,-,-,-] 等。

# java - Java中的合并排序

> ID：10342829
> 
> 赞同：1
> 
> 时间：2012-04-26T23:29:12.443
> 
> 标签：java, list, mergesort

我有一个类可以对通用列表进行一些递归合并排序，只要元素实现 Comparable。我有一个名为 mergeSort(List toSort) 的 void 方法和一个方法 mergeSortedLists(List left, List right)，它采用两个已经排序的列表，然后将它们组合成一个排序列表。问题是，mergeSort(...) 方法似乎没有操纵 toSort 变量。是的，但是在它跃升一个级别后不会显示更改。以下是排序方法：

```
public static <E extends Comparable<E>> void mergeSort(List<E> toSort)
{
  if(toSort.size() > 1)
  {
    List<E> temp = toSort.subList(0, toSort.size()/2);

    ArrayList<E> left = new ArrayList<E>(0);
      for(E e : temp) left.add(e);

    temp = toSort.subList(toSort.size()/2, toSort.size());

    ArrayList<E> right = new ArrayList<E>(0);
      for(E e : temp) right.add(e);

    if(right.size() != 1) mergeSort(right);
    if(left.size() != 1) mergeSort(left);

    toSort = mergeSortedLists(left, right);
  }
}

public static <E extends Comparable<E>> List<E> mergeSortedLists(List<E> leftList, List<E> rightList)
{
  ArrayList<E> list = new ArrayList<E>();

  while(!leftList.isEmpty() && !rightList.isEmpty())
  {
    if((leftList.get(0)).compareTo(rightList.get(0)) <= 0)
      list.add(leftList.remove(0));

    else
      list.add(rightList.remove(0));
  }

  while(!leftList.isEmpty())
    list.add(leftList.remove(0));

  while(!rightList.isEmpty())
    list.add(rightList.remove(0));

  return list;
} 
```

我通常有用于错误检查的打印语句，这些语句表明 mergeSortedLists(...) 正确排序并返回正确的列表。然后，我将 mergeSort(...) 中的 toSort 变量分配给 mergeSortedLists(...) 返回的任何内容。该任务有效。现在，它跳回一个级别以将该列表与不同的列表组合在一起，并且更改似乎丢失了。我不知道发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:32:38.827

*参数（甚至是对对象的引用！）在 Java 中是按值*传递的，因此您正在修改 的本地副本`toSort`，而不是调用函数中的副本。解决此问题的一种方法是返回您再次传入的列表，即

```
public static <E extends Comparable<E>> List<E> mergeSort(List<E> toSort) 
```

然后你会说这样的话：

```
right = mergeSort(right); 
```

等，并返回使用：

```
return mergeSortedLists(left, right); 
```

我还没有通读其余的代码，但希望这能让你走上正确的道路:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T23:36:11.500

而不是这个

```
toSort = mergeSortedLists(left, right); 
```

尝试

```
toSort.clear();
toSort.addAll(mergeSortedLists(left, right)); 
```

您的方法的问题是您重置了对列表的引用，但这不会传播回原始函数。建议的版本会操纵您被引用的原始列表。由于您不更改引用，因此对原始列表的更改将在函数返回后显示在调用者处。

澄清一下：当您将参数传递给函数时，会创建该参数的副本，该副本用作函数内的局部变量。当您更改该变量本身的值时，这些更改是对副本进行的，而不是对原始的（调用函数时复制的副本）。在建议的版本中，副本是一个引用，所以尽管引用被复制，但对象（这里：列表）不是，所以两个引用指向同一个对象。因此，通过副本（局部变量）对对象所做的更改会在函数返回时“显示”出来。

# java - Java中HBase表的自定义过滤

> ID：10342830
> 
> 赞同：0
> 
> 时间：2012-04-26T23:29:20.633
> 
> 标签：java, filter, hbase, comparator

我有几个 HBase 表。它们的键控方式都不同，但每个键都有 32 位整数所有者 ID 作为键的一部分。每个表的偏移量不同，但我确实知道这些偏移量。现在，我传入了一个 ID 集合，我需要将与传入的所有者有关的数据转储到文件中。即我需要做一些与下面的 SQL 语句等效的事情：

```
SELECT * FROM table WHERE substr(key_field, offset, length) IN (...); 
```

试图实现这一点，我写了这样的东西：

```
public class SubKeyComparator extends BinaryComparator {

    private Set<Integer> idSet;
    private int         idLength = 4;
    private int         idOffset = 0;

    // getters/setters are here

    @Override
    public int compareTo(byte[] value) {
        return idSet.contains(Bytes.toInt(value, offset, length))? 0 : 1;
    }
} 
```

它似乎没有按预期工作。它实际上根本不起作用。我正在打开一张桌子，当我试图得到

```
ResultScanner scanner = htable.getScanner(scan); 
```

它稍等片刻，然后抛出一个 org.apache.hadoop.hbase.client.RetriesExhaustedException，在 org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getRegionServerWithRetries(HConnectionManager.java:1231 )

尝试在 Web 上找到解决方案或通过 HBase 源代码了解出了什么问题并没有产生任何显着的结果。如果我不将过滤器插入扫描对象，一切正常。

如果有人知道出了什么问题或做过类似的事情，我们将非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T21:26:45.303

首先重要的是要注意您已经实现了 Comparator ，*而不是 filter*。如果你真的想要一个*过滤器*，你需要做的是扩展[org.apache.hadoop.hbase.filter.FilterBase](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/filter/FilterBase.html)

如果您查看 HBase 日志，您可能会看到类似以下内容：

```
2012-09-20 16:55:27,913 ERROR org.apache.hadoop.hbase.io.HbaseObjectWritable: Can't find class com.mycompany.project.MyCustomComparator
java.lang.ClassNotFoundException: com.mycompany.project.MyCustomComparator
  at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    {lines removed for brevity}
2012-09-20 16:55:27,913 ERROR org.apache.hadoop.hbase.io.HbaseObjectWritable: Error in readFields
java.io.IOException: Can't find class com.mycompany.project.MyCustomComparator
  at org.apache.hadoop.hbase.io.HbaseObjectWritable.readObject(HbaseObjectWritable.java:514)
    {lines removed for brevity}
Caused by: java.lang.ClassNotFoundException: com.mycompany.project.MyCustomComparator
  at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    {lines removed for brevity}
  at org.apache.hadoop.hbase.io.HbaseObjectWritable.getClassByName(HbaseObjectWritable.java:549)
  at org.apache.hadoop.hbase.io.HbaseObjectWritable.readObject(HbaseObjectWritable.java:511)
  ... 15 more 
```

这是因为比较器类在 HBase 服务器的类路径中不可用。

在任何一种情况下，都需要编译自定义类并将其部署到所有区域服务器（可能在 JAR 中）并添加到 HBase 类路径中。

# c# - 相对 SourceURI 不起作用

> ID：10342834
> 
> 赞同：1
> 
> 时间：2012-04-26T23:29:58.773
> 
> 标签：c#, wpf, xaml, .net-4.0

我无法找出适用于我的资源的相对路径。我已经尝试了我能想到的一切。唯一有效的是一个绝对路径，它只在我的系统上是正确的，但在任何部署的版本中都是不正确的。

据我所知，这条非常简单的路径应该可行。

```
public class GreyscaleEffect : ShaderEffect
{
    private static PixelShader _pixelShader = new PixelShader()
        { UriSource = new Uri("/Effects/Greyscale.ps", UriKind.Relative) }; 
```

为此我收到错误`The type initializer for 'FSR.WPF.Utilities.UI. GreyscaleEffect' threw an exception.`内部异常：`Cannot locate resource 'effects/greyscale.ps'.`

我还尝试了以下方法：

```
Uri(";component/Effects/Greyscale.ps", UriKind.Relative)
Uri("/;component/Effects/Greyscale.ps", UriKind.Relative)
Uri("/FSR.WPF.Utilities.UI;component/Effects/Greyscale.ps", UriKind.Relative) 
```

在其他地方（在 MUSUI 中的 xaml 文件中），使用了以下路径，并且工作正常：

```
<Image Source="/FSR.WPF.Utilities.UI;component/assets/CurrencyFlags/USD.png" 
```

所以我不明白为什么这个如此相似的案例不起作用。

只有以下绝对路径有效：

```
Uri("C:\TFS\MUS 6.1.x\Mosaic Middleware\FSR.WPF.Utilities\FSR.WPF.Utilities.UI" +
    "\Effects\Greyscale.ps") 
```

我还尝试了上述所有方法，`@`包括在字符串前面使用、使用 UriKind.Absolute 并完全省略第二个参数。除了绝对路径之外没有任何作用，我正在失去理智。

这是解决方案的结构。主要项目是 MUSUI，底部以粗体显示。此效果类和 .ps 文件都位于 Effects 文件夹中，该文件夹位于引用的程序集 FSR.WPF.Utilities.UI 的根目录中。

![在此处输入图像描述](../Images/c61cb6245023de1b3bf72f6cba29269d.png)

无论如何，我知道这必须以某种方式工作。任何能够找出可能的最短工作相对路径的人，特别是如果它不需要在程序集名称中进行硬编码，都会获得奖励。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T23:53:17.880

您不能指定相对 URI，它必须是绝对的。当您在 XAML 中指定相对 URI 时，它实际上是使用 转换为绝对 URI [`IUriContext.BaseUri`](http://msdn.microsoft.com/en-us/library/system.windows.markup.iuricontext.baseuri.aspx)，但在 C# 代码中没有关于当前位置的信息，因此您不能使用相对 URI。

您需要使用[`pack://`URI 方案](http://msdn.microsoft.com/en-us/library/aa970069.aspx)指定 URI ：

```
UriSource = new Uri("pack://application:,,,/YourAssembly;component/Effects/Greyscale.ps"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-25T09:57:24.077

我认为这是 WPF 的 PixelShader 类 bug，因为 PixelShader 没有实现可以持久化 BaseUri 上下文的 IUriContext 接口，而 System.Windows.Controls.Image & System.Windows.Documents.Hyperlink & System.Windows.ResourceDictionary 等实现IUriContext，所以他们可以使用相对的 Uri

要启用 PixelShader 相对 Uri 敏感，可以使用 Hyperlink 作为重定向器，例如

```
 <Window>
    <Window.Resources>
    <Hyperlink x:Key="ItemForRedirectKey" NavigateUri="{Your PixelShader.ps relative uri}" TargetName="{Binding Path= NavigateUri,RelativeSource={RelativeSource Self}}" />
    <PixelShader x:Key="PixelShaderKey" UriSource={Binding Path=TargetName,Source={StaticResouce ItemForRedirectKey}   }/>
    </Window.Resources>
    </Window> 
```

# android - Android GPS 位置更新

> ID：10342840
> 
> 赞同：0
> 
> 时间：2012-04-26T23:30:59.777
> 
> 标签：android, gps

我需要实现一个系统，该系统需要用户设备不断向我发送 GPS 更新。这对电池和数据计划来说真的很重。有没有由android开发的模型来处理这些要求？

在应用程序运行时打开和关闭 GPS 是否明智？

我正在为此任务寻找优化模型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:40:42.430

这取决于所需的更新间隔。如果 GPS 已打开，获得精确定位的时间取决于它看到的卫星数量（例如，可见的自由天空的数量）以及它关闭的时间。

因此，例如，如果您需要在十分钟内修复一次，则可以关闭和打开 GPS。它会很快得到修复，但取决于天空的能见度，例如。可能需要更长的时间（如果可以修复，通常在几秒钟到一分钟之间，在最坏的情况下）才能获得准确的修复。另一方面，如果您需要每分钟更新一次，那么在大多数情况下（例如城市驾驶）切换将没有用，因为修复已经花费了大量时间。

切换 GPS 时，拥有良好的天空能见度是非常有益的，例如。指导用户不要将设备放在车内或口袋里，而最好将其安装在挡风玻璃上或例如将其放在车身前面。然后，您可以快速修复并缩短工作时间。

# java - 如果 Xms5120m，jvm 会分配 5G RAM

> ID：10342841
> 
> 赞同：1
> 
> 时间：2012-04-26T23:31:05.313
> 
> 标签：java, memory, jvm

我们有一个 java 进程，它有这样的 start 参数：-Xms5120m -Xmx5120M

jvm会在启动时分配5G RAM吗？

与 -Xms1024m -Xmx5120M 相比，这是一个好习惯吗？

[更新]

即使我设置了Xms5120M，它似乎也被忽略了。当进程启动时，任务管理器显示它只使用了大约 2G RAM。这是为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-19T15:21:52.807

java 只会分配当时需要的东西。当你告诉它你想要 -Xmx5G 时，它告诉计算机最大。而 xms 是最小系统内存。如果初始内存堆不超过 5G，而是使用 2G，任务管理器只是告诉您 2G 内存正在使用中，但不会显示您的分配。这表明你的内存堆没有消耗全部 5G 分配的内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-16T07:42:59.207

如果您真的希望立即初始化初始堆内存，您可能可以尝试使用`-XX:+AlwaysPreTouch`JVM 选项：

> 在 JVM 初始化期间预接触 Java 堆。因此，堆的每一页在初始化期间都被需求归零，而不是在应用程序执行期间递增。

[http://www.oracle.com/technetwork/articles/java/vmoptions-jsp-140102.html](http://www.oracle.com/technetwork/articles/java/vmoptions-jsp-140102.html)

# asp.net-mvc - 相当于 MVC4 Web Api 中的 [Bind(Prefix = "principalId")]？

> ID：10342845
> 
> 赞同：12
> 
> 时间：2012-04-26T23:31:37.337
> 
> 标签：asp.net-mvc, asp.net-web-api, asp.net-mvc-routing

**背景：**

在 MVC3 中，我使用以下语法来指定自定义`Action`参数名称：

```
public ActionResult ActionName([Bind(Prefix = "principalID")] int userID,
                               [Bind(Prefix = "dependentID")] long applicationID) 
```

此操作的路线定义如下（`ActionNameConstraint`是自定义的`IRouteConstraint`）：

```
routes.MapHttpRoute(
    "DependantAction",
    "{controller}/{principalID}/{action}/{dependentID}",
    new {controller = @"[^0-9]+", action = ActionNameConstraint.Instance, dependentID = RouteParameter.Optional}
    ); 
```

**问题：**

是`BindAttribute`一`System.Web.Mvc`类。Web Api 中是否有等效的 this（参数绑定）？

当然，如果有其他解决方案可以达到相同的结果，我很想听听！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-17T10:45:36.543

您可以使用该`System.Web.Http.FromUriAttribute`属性来指定用于模型绑定的参数名称。

```
public ActionResult ActionName(
                    [FromUri(Name = "principalID.userID")] int userID,
                    [FromUri(Name= "dependentID.applicationID")] long applicationID
                    ) 
```

`FromUri`告诉模型绑定检查查询字符串和`RouteData`请求。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-27T00:09:08.743

我知道在 WebAPI 中您只使用特殊的控制器类基和特殊的动作名称，但毕竟它们是控制器和动作。

你试过了吗，它没有用？快速浏览一下这篇文章似乎表明模型绑定通常（不是特定属性）应该正常工作：

[http://blogs.msdn.com/b/jmstall/archive/2012/04/16/how-webapi-does-parameter-binding.aspx](http://blogs.msdn.com/b/jmstall/archive/2012/04/16/how-webapi-does-parameter-binding.aspx)

**编辑：**

有人说这应该只与 MVC 一起工作，并否决了答案。给你，更多参考：

*   微软文档： [http ://www.asp.net/web-api/overview/formats-and-model-binding/parameter-binding-in-aspnet-web-api](http://www.asp.net/web-api/overview/formats-and-model-binding/parameter-binding-in-aspnet-web-api)
*   MSDN 博客文章
    [http://blogs.msdn.com/b/jmstall/archive/2012/04/16/how-webapi-does-parameter-binding.aspx](http://blogs.msdn.com/b/jmstall/archive/2012/04/16/how-webapi-does-parameter-binding.aspx)
*   接受 SO 回答
    [ASP.NET Web API MVC 4 中带有特殊字符的自定义参数名称](https://stackoverflow.com/questions/12298409/custom-parameter-names-with-special-characters-in-asp-net-web-api-mvc-4)
*   一篇探索几种方法的帖子（一直到最后）
    [http://blogs.msdn.com/b/jmstall/archive/2012/04/20/how-to-bind-to-custom-objects-in-action-signatures -in-mvc-webapi.aspx](http://blogs.msdn.com/b/jmstall/archive/2012/04/20/how-to-bind-to-custom-objects-in-action-signatures-in-mvc-webapi.aspx)
*   另一篇 MSDN 博文（参见场景 3）
    [http://blogs.msdn.com/b/hongmeig1/archive/2012/09/28/how-to-customize-parameter-binding.aspx](http://blogs.msdn.com/b/hongmeig1/archive/2012/09/28/how-to-customize-parameter-binding.aspx)

# java - 为什么哈希图中的不可变对象如此有效？

> ID：10342859
> 
> 赞同：38
> 
> 时间：2012-04-26T23:33:34.313
> 
> 标签：java, performance, caching, hashmap, immutability

所以我读到了[HashMap](http://javarevisited.blogspot.com/2011/02/how-hashmap-works-in-java.html)。有人指出：

> “不变性还允许缓存不同键的哈希码，这使得整个检索过程非常快，并表明`Integer`Java 集合 API 提供的 String 和各种包装类（例如 ）是非常好的`HashMap`键。”

我不太明白……为什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-26T23:43:50.093

`String#hashCode`：

```
private int hash;

...

public int hashCode() {
    int h = hash;
    if (h == 0 && count > 0) {
        int off = offset;
        char val[] = value;
        int len = count;

        for (int i = 0; i < len; i++) {
            h = 31*h + val[off++];
        }
        hash = h;
    }
    return h;
} 
```

由于 a 的内容`String`永远不会改变，因此类的创建者选择在计算一次哈希后缓存它。这样，就不会浪费时间重新计算相同的值。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-26T23:46:13.460

引用链接的博客条目：

> 具有正确 equals() 和 hashcode() 实现的最终对象将充当完美的 Java HashMap 键，并通过减少冲突来提高 Java hashMap 的性能。

我看不到两者如何`final`以及`equals()`与哈希冲突有什么关系。这句话引起了我对文章可信度的怀疑。它似乎是教条式的 Java“智慧”的集合。

> 不变性还允许缓存不同键的哈希码，这使得整个检索过程非常快，并建议 String 和各种包装类（例如 Java Collection API 提供的 Integer）是非常好的 HashMap 键。

我看到这句话有两种可能的解释，两种都是错误的：

*   **`HashMap`缓存不可变对象的哈希码**。这是不正确的。地图无法确定对象是否“不可变”。
*   **对象缓存其自己的哈希码需要不变性**。理想情况下，一个对象的哈希值应该*始终*只依赖于对象的非变异状态，否则该对象不能被明智地用作键。所以在这种情况下，作者也没有说明一点：如果我们假设我们的对象没有改变它的状态，我们也不必每次都重新计算哈希值，即使我们的对象是可变的！

### 例子

因此，如果我们真的很疯狂并且实际上决定使用 a`List`作为 a 的键`HashMap` *并使*哈希值依赖于内容，而不是列表的身份，我们可以决定在每次修改时使缓存的哈希值无效，因此将哈希计算的次数限制为对列表的修改次数。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-26T23:45:28.843

这很简单。由于*不可变*对象不会随时间变化，因此它只需要执行一次哈希码的计算。再次计算将产生相同的值。因此，通常在构造函数（或惰性）中计算哈希码并将其存储在字段中。然后该`hashcode`函数只返回该字段的值，这确实非常快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T23:46:40.827

基本上，Java 中的不变性是通过使类不可扩展来实现的，并且对象中的所有操作在理想情况下都不会改变对象的状态。如果您看到像 replace() 这样的 String 操作，它不会更改您正在操作的当前对象的状态，而是为您提供一个带有替换字符串的新 String 对象。因此，理想情况下，如果您将此类对象维护为键，则状态不会改变，因此哈希码也保持不变。因此，在检索期间缓存哈希码将提高性能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-26T23:47:48.350

将 hashmap 想象成一个大数组的编号框。数字是哈希码，盒子按数字排序。

现在如果对象不能改变，散列函数将总是重现相同的值。因此，该对象将始终留在它的盒子里。

现在假设一个可变对象。它在添加到散列后被更改，所以现在它放在错误的盒子里，就像琼斯夫人碰巧嫁给了 Doe 先生，现在也被命名为 Doe，但在许多寄存器中仍然命名为 Jones。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-07-20T17:06:14.843

不可变类是不可修改的，这就是为什么它们被用作 Map 中的键。

举个例子——

```
 StringBuilder key1=new StringBuilder("K1");
    StringBuilder key2=new StringBuilder("K2");

    Map<StringBuilder, String> map = new HashMap<>();
    map.put(key1, "Hello");
    map.put(key2, "World");

    key1.append("00");
    System.out.println(map); // This line prints - {K100=Hello, K2=World} 
```

您会看到插入到映射中的键 K1（它是可变类 StringBuilder 的对象）由于无意更改而丢失。如果您使用不可变类作为 Map 系列成员的键，则不会发生这种情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-26T16:48:29.630

仅当对象的哈希码在存储在表中时永远不会更改时，哈希表才会起作用。这意味着哈希码不能考虑对象在表中时可能更改的任何方面。如果一个对象最有趣的方面是可变的，这意味着：

*   哈希码将不得不忽略对象的大部分有趣方面，从而导致许多哈希冲突，或者......

*   拥有哈希表的代码必须确保其中的对象在存储在哈希表中时不会暴露于任何可能改变它们的东西。

如果 Java 哈希表允许客户端提供 EqualityComparer（.NET 字典的方式），则知道哈希表中对象的某些方面不会意外更改的代码可以使用考虑这些方面的哈希码，但是在 Java 中实现这一点的唯一方法是将存储在哈希码中的每个项目包装在一个包装器中。然而，这种包装可能不是世界上最邪恶的事情，因为包装器能够以一种无法缓存的方式缓存哈希值`EqualityComparer`，并且还可以缓存更多与相等性相关的信息[例如，如果存储的东西是嵌套集合，可能值得计算多个哈希码，并在对元素进行任何详细检查之前确认所有哈希码匹配]。

# jquery - 有条件的 .addClass()

> ID：10342860
> 
> 赞同：2
> 
> 时间：2012-04-26T23:33:40.850
> 
> 标签：jquery, tabs, jquery-tools, addclass

我这辈子都想不通。我需要为一系列 7 个选项卡（基于星期几）、.past、.today 和 .future 分配三个类

我的 .today 使用 .getDay() 可以很好地工作，但是我无法将 .today 之前的所有 li 分配给 .past，以及 .today 之后的所有 li 分配给 .future

HTML：

```
<ul class="days-of-the-week tabs clearfix">
  <li class="sunday"><span><a href="#">Sunday</a></span></li>
  <li class="monday"><span><a href="#">Monday</a></span></li>
  <li class="tuesday"><span><a href="#">Tuesday</a></span></li>
  <li class="wednesday"><span><a href="#">Wednesday</a></span></li>
  <li class="thursday"><span><a href="#">Thursday</a></span></li>
  <li class="friday"><span><a href="#">Friday</a></span></li>
  <li class="saturday"><span><a href="#">Saturday</a></span></li>
</ul> 
```

jQuery：

```
// Add class .today to the correct day-of-week tab
$('ul.days-of-the-week li:eq(' + new Date().getDay() + ')').addClass('today'); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T23:38:40.567

您可以使用`prevAll()`获取当前元素的所有先前兄弟姐妹，以及`nextAll()`所有以下兄弟姐妹。

文档`prevAll`：[http ://api.jquery.com/prevAll/](http://api.jquery.com/prevAll/)

文档`nextAll`：[http ://api.jquery.com/nextAll/](http://api.jquery.com/nextAll/)

使用这些很容易。JSFiddle：http: [//jsfiddle.net/qYt2p/](http://jsfiddle.net/qYt2p/)

```
var today = $('ul.days-of-the-week li:eq(' + new Date().getDay() + ')').addClass('today');
today.prevAll().addClass("past");
today.nextAll().addClass("future");​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T23:40:57.503

我认为您正在寻找 netxAll 和 prevAll：

```
var today = $('ul.days-of-the-week li:eq(' + new Date().getDay() + ')');
today.prevAll().addClass('past');
today.addClass('today');
today.nextAll().addClass('future'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T23:50:32.080

```
$('ul.days-of-the-week li').each(function() {
    var c = new Date().getDay() <= $(this).index() ? new Date().getDay() == $(this).index() ? 'today' : 'future' : 'past';
    $(this).addClass(c);
}); 
```

# java - 使用 Dropbox 将 jar 部署到远程服务器

> ID：10342861
> 
> 赞同：0
> 
> 时间：2012-04-26T23:33:56.960
> 
> 标签：java, maven, deployment, dropbox

我有几台服务器，需要定期将它们同步到最新的 maven jar。我正在考虑将具有依赖关系的 jar 部署到 Dropbox，然后我的服务器会自动更新到最新版本。

这是个好主意还是坏主意？有哪些替代方案？

目前我必须手动 SCP 周围的 JAR 或使用 SVN 和 Maven exec 来运行。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T01:07:39.257

我会远离使用诸如投递箱之类的东西。它并不是真的打算以这种方式同步文件。例如，如果在更新关闭时打开文件，下拉框会做什么？当一个依赖的 jar 在它下面发生变化时，你的应用程序会做什么？

我认为您想使用 Maven 存储库（如[Nexus](http://www.sonatype.org/nexus/)）来部署您的应用程序更改。它允许您对依赖项进行版本控制，并可以组织构建升级，以便您可以准确地确定要推送到生产中的内容。

我还发现了一个有趣的[演示文稿](http://www.slideshare.net/wakaleo/automated-deployment-with-maven-going-the-whole-nine-yards)，其中涵盖了您正在尝试做的事情。到目前为止，自动化构建/部署过程是最好的方法。

# iphone - 将新对象插入 coreData

> ID：10342864
> 
> 赞同：0
> 
> 时间：2012-04-26T23:34:15.357
> 
> 标签：iphone, ios, core-data

我正在尝试将 NSData 对象插入 CoreData，因此我不得不在事后将所有内容添加到我的应用程序中，因为我从未在选择 coredata 的情况下启动它。没关系，因为我已经开始了一个新项目并复制了所有适当的代码以进行所有设置。

从那里我现在正在尝试设置 insertNewObject 方法。然而，这给了我一些问题。

我首先尝试从像这样的另一种方法传递一些 NSData

```
[self insertNewObject:myData]; 
```

然后我使用这样的 insertNewObject 方法

```
- (void)insertNewObject:(id)sender
{
    NSManagedObjectContext *context = [self.fetchedResultsController managedObjectContext];
    NSEntityDescription *entity = [[self.fetchedResultsController fetchRequest] entity];
    NSManagedObject *newManagedObject = [NSEntityDescription insertNewObjectForEntityForName:@"Entity" inManagedObjectContext:context];

    // If appropriate, configure the new managed object.
    // Normally you should use accessor methods, but using KVC here avoids the need to add a custom class to the template.
    [newManagedObject setValue:sender forKey:@"manufacturers"]; //not sure if this is correct, but sender has myData, and @"manufactures" is the attribute of my entity.

    // Save the context.
    NSError *error = nil;
    if (![context save:&error]) {
        // Replace this implementation with code to handle the error appropriately.
        // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }
} 
```

从这里发生的事情是，当线程太第三行“NSManagedObject *newManagedObject ...”时，应用程序崩溃了，我收到了这个错误

```
> 2012-04-27 11:18:21.579 thecode[1452:fb03] *** Terminating app due to
> uncaught exception 'NSInternalInconsistencyException', reason:
> '+entityForName: could not locate an NSManagedObjectModel for entity
> name 'Entity''
> *** First throw call stack: (0x14b5022 0x1952cd6 0x61d47 0xa8102 0x1a595 0x199a4 0x18b99 0x15097 0x1136a49 0x1134e84 0x1135ea7
> 0x1134e3f 0x1134fc5 0x1079f5a 0x1c02a39 0x1ccf596 0x1bf9120 0x1ccf117
> 0x1bf8fbf 0x148994f 0x13ecb43 0x13ec424 0x13ebd84 0x13ebc9b 0x215b7d8
> 0x215b88a 0x733626 0x762d 0x1c75 0x1) terminate called throwing an
> exception 
```

我已经在我的 xcdatamodeld 中设置了所需的实体和属性

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:41:18.270

我不知道您的 CoreData 模型，但我猜您没有名称为“Entity”的实体，因此当您尝试在此处插入名称为“Entity”的新实体时，这可能会导致崩溃：

```
[NSEntityDescription insertNewObjectForEntityForName:@"Entity" inManagedObjectContext:context]; 
```

当您在上面一行获取实体描述但以后不再使用它时，我猜您正在尝试插入此实体。所以你要做的基本上是：

```
 [NSEntityDescription insertNewObjectForEntityForName:entity.name inManagedObjectContext:context]; 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T02:25:06.717

还要检查您的 managedObjectContext 是否不为零。当它出现时，你会得到这个错误。当您实例化 fetchedResultsController 时，您将 NSManagedObjectContext 与它相关联。你从哪里得到这个背景的？

如果这是在您深入研究的视图控制器中，请确保您将 managedObjectContext 从应用委托传递到每个后续控制器，以便他们都可以访问它。然后，您可以正确地将其传递给 fetchedResultsController。

# hibernate - 无法使用 hbm2ddl 创建架构

> ID：10342865
> 
> 赞同：0
> 
> 时间：2012-04-26T23:34:24.500
> 
> 标签：hibernate, hbm2ddl

我正在尝试使用休眠工具 ant 任务生成模式。

下面是我的蚂蚁任务

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<project name="GenerateDDL" basedir="." default="createddl">
<property name="src" location="src" />
<property name="bin" location="bin" />
<target name="createddl">

    <property name="lib" location="C:\eclipse\plugins\org.hibernate.eclipse.libs_3.4.0.v20120307-2104-H60-Beta1\lib" />
    <property name="vob.libs" location="C:/lib/java/jars" />
    <property name="jdbc.driver.name" value="${vob.libs}/postgresql-9.0-801.jdbc4.jar" />
    <unjar dest="config">
        <fileset dir="lib" includes="*.jar" />
        <patternset>
            <include name="**/*.class" />
        </patternset>
    </unjar>
    <path id="toolslib">
        <path location="${vob.libs}/hibernate-tools.jar" />
        <path location="${vob.libs}/hibernate3.jar" />
        <path location="${vob.libs}/freemarker.jar" />
        <path location="${jdbc.driver.name}" />
        <path location="${vob.libs}/hibernate-jpa-2.0-api-1.0.0.Final.jar" />
        <path location="${vob.libs}/hibernate-annotations.jar" />
        <path location="${vob.libs}/hibernate-entitymanager.jar" />
        <path location="${vob.libs}/ejb3-persistence.jar" />
        <path location="${vob.libs}/commons-logging.jar" />
        <path location="${vob.libs}/slf4j-jboss-logging.jar" />
        <path location="${vob.libs}/slf4j-api.jar" />
        <path location="${vob.libs}/dom4j.jar" />
        <path location="${vob.libs}/javassist.jar" />
        <path location="${vob.libs}/jboss-logging-spi.jar" />
    </path>

    <taskdef name="hibernatetool" classname="org.hibernate.tool.ant.HibernateToolTask" classpathref="toolslib" />
    <mkdir dir="src/generated" />
    <mkdir dir="bin" />
    <hibernatetool destdir="src/generated">
        <classpath>
            <path location="config" />
        </classpath>
        <jpaconfiguration persistenceunit="myPersistenceUnit" />

        <hbm2ddl export="true" drop="true" outputfilename="ddl.sql" format="true" />

    </hibernatetool>
</target>
</project> 
```

这里 config 目录包含所有类文件，包括实体类的类文件。当我运行这个 ant 任务时，我没有看到任何错误，但我也没有看到在 ddl.sql 文件中生成任何模式。我试图在互联网上对此进行研究，但没有找到任何令人满意的答案。我不确定如何进一步调试，因为在运行 ant 任务后我没有在控制台上看到任何错误消息。在这个 ant 任务中我是否缺少一些明显的东西来生成模式。

任何形式的帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T19:46:29.117

我发现问题与persistence.xml有关。我项目中的 persistence.xml 指的是数据源。我需要在类路径中有完整的 persistence.xml 并且没有对数据源的引用，因为在将应用程序部署到 JBoss 之前不会加载数据源

# javascript - javascript、html5模拟电玩HUD效果

> ID：10342868
> 
> 赞同：0
> 
> 时间：2012-04-26T23:34:56.570
> 
> 标签：javascript, html

我正在尝试在 HTML5 中模拟视频游戏 HUD。我有一个带有 CSS 样式的 div，使它看起来像一个游戏覆盖，当单击导航链接时，我需要 div 从**display:none**状态转到，然后快速闪烁两次，然后淡入。

此外，当单击 div 中的关闭按钮时，应该会发生同样的情况，只是最后的淡入淡出从 100% 反转为 0%。

我必须对其他导航链接和不同的 div 做同样的事情。如果我能让一个人工作，我应该也能让其他人工作。

所以div的透明度是这样的：

点击前关闭状态 0%
on 100% 点击时
关闭 0%
on 100%
off 0%
然后
在 1.5 秒内淡入 0% 到 100%

**导航链接：**

```
<li><a href="#target" id="about">About</a></li> 
```

**分区：**

```
 <div id="overlay">
<a href="#" class="btn" id="close">X</a>
    <h3>Overlay</h3>
    Fusce commodo congue ante, quis venenatis nibh blandit ut. Aenean felis est, dictum eget venenatis ac,vestibulum vel urna. Quisque felis metus, vehicula et semper quis, fermentum a dolor.  
    </div> 
```

我试过这个，但没有达到预期的效果。

```
 $("#target").click(function() {
    //alert("Handler for .click() called.");

    // set interval
     var timeCount=0;
    setInterval(function() {

        if(timeCount == 1){
        //alert("timeCount"+ timeCount);
          $('#overlay').toggle();
        }
        if(timeCount == 2){
        //alert("timeCount"+ timeCount);
          $('#overlay').toggle();
        }
        if(timeCount == 3){
        //alert("timeCount"+ timeCount);
          $("#overlay").fadeIn("slow");
        }
        if(timeCount == 4){
          //abortTimer();
        }
        timeCount++;
      }, 50);
      }); 
```

setInterval 速度低于 50 的任何值都太快而无法呈现开/关切换。我只看到淡入淡出。

任何超过 60 的东西都太慢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T03:16:20.167

您当前的时间间隔仅使显示屏闪烁一次，因为您将其打开然后再次关闭一次。你应该有类似的东西：

```
if( timeCount < 4) $("#overlay").toggle();
else {
    $("#overlay").fadeIn("slow");
    clearInterval(timer);
} 
```

此外，即使有两次闪光，闪光也只会持续 20 分之一秒。显示器刷新率为每秒 60 次，因此即使浏览器是实时的，它也只会显示三帧。我不了解你，但对我来说这似乎*真的*很快。我会让它显示大约 10 帧（间隔为 100），隐藏 10 帧，再次显示，再次隐藏，然后淡出。这将使闪烁持续大约半秒，这仍然很快但至少可见。你现在这样做的方式，就像你试图引起癫痫发作......

# perl - 如何正确使用error.pm提供的perl中的try catch？

> ID：10342875
> 
> 赞同：36
> 
> 时间：2012-04-26T23:35:54.183
> 
> 标签：perl, error-handling, try-catch

我发现有一个模块[Error](http://search.cpan.org/perldoc/Error)提供了 java 中的 try 和 catch 功能。但是我对如何打印返回的异常感到困惑。

我想了解如何执行以下操作

```
try {
    // do something that will fail!

} catch (Error e) {
    // Print out the exception that occurred
    System.out.println(e.getMessage());
} 
```

如何使用堆栈跟踪打印错误？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-04-27T00:53:28.940

您可能最好使用[Try::Tiny](http://search.cpan.org/perldoc/Try%3a%3aTiny)，这将帮助您避免一些[旧`perl`s](http://search.cpan.org/perldoc/perl5140delta#Exception_Handling)的陷阱。

```
use Try::Tiny;

try {
        die "foo";
} catch {
        warn "caught error: $_";
}; 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2012-04-26T23:57:14.247

最后我检查，[错误](http://search.cpan.org/perldoc/Error)已被弃用。但是，如果没有该模块，您将如何做到这一点：

```
eval {
    die "Oops!";
    1;
} or do {
    my $e = $@;
    print("Something went wrong: $e\n");
}; 
```

基本上，使用[eval](http://perldoc.perl.org/functions/eval.html)代替`try`，[die](http://perldoc.perl.org/functions/die.html)代替`throw`，并在[`$@`](http://perldoc.perl.org/perlvar.html#%24@). eval 块末尾的真值是一个习惯用法的一部分，用于防止`$@`在 5.14 之前的 Perl 版本中再次使用它之前无意更改，有关详细信息，请参阅[P::C::P::ErrorHandling::RequireCheckingReturnValueOfEval](http://p3rl.org/Perl%3a%3aCritic%3a%3aPolicy%3a%3aErrorHandling%3a%3aRequireCheckingReturnValueOfEval)。例如，这段代码就存在这个缺陷。

```
# BAD, DO NOT USE WITH PERLS OLDER THAN 5.14
eval {
    die "Oops!";
};
if (my $e = $@) {
    print("Something went wrong: $e\n");
}
# BAD, DO NOT USE WITH PERLS OLDER THAN 5.14 
```

* * *

但请注意，许多 Perl 操作在失败时不会引发异常；他们只是返回一个错误代码。可以通过[autodie](http://perldoc.perl.org/autodie.html)为内置和标准模块更改此行为。如果您正在使用`autodie`，那么执行 try/catch 的标准方法是这样的（直接来自 autodie perldoc）：

```
use feature qw(switch);

eval {
   use autodie;

   open(my $fh, '<', $some_file);

   my @records = <$fh>;

   # Do things with @records...

   close($fh);

};

given ($@) {
   when (undef)   { say "No error";                    }
   when ('open')  { say "Error from open";             }
   when (':io')   { say "Non-open, IO error.";         }
   when (':all')  { say "All other autodie errors."    }
   default        { say "Not an autodie error at all." }
} 
```

要获取堆栈跟踪，请查看[Carp](http://perldoc.perl.org/Carp.html)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-06-06T18:58:03.480

如果您想要比 Try::Tiny 更强大的东西，您可能想尝试查看 CPAN 中的[TryCatch](http://search.cpan.org/~ash/TryCatch-1.003002/lib/TryCatch.pm)模块。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-06-02T04:15:55.347

不幸的是， [Devel::Declare](https://metacpan.org/pod/Devel::Declare)的新版本 0.006020 破坏了[TryCatch](https://metacpan.org/pod/TryCatch)，似乎没有修复它的打算。perl 核心开发团队也抱怨 TryCatch 依靠一些时髦的东西来使其工作。

取而代之的是一个名为[Nice::Try](https://metacpan.org/pod/Nice::Try)的新实现，它是一个完美的替代品。

最后一个大括号不需要像 Try::Tiny 这样的分号。

您还可以进行异常变量赋值，例如

```
 try
  {
    # something
  }
  catch( $e )
  {
    # catch this in $e
  } 
```

它也可以使用类异常，例如

```
 try
  {
    # something
  }
  catch( Exception $e )
  {
    # catch this in $e
  } 
```

它还支持`finally`. 它的功能集使其非常独特。

完全披露：当 TryCatch 被破坏时，我开发了这个模块。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-02T11:59:01.913

恕我直言[`Syntax::Keyword::Try`](https://metacpan.org/pod/Syntax::Keyword::Try)，是比`Try::Tiny`大多数情况更好的选择。

`Try::Tiny`比 eval 或 慢一个数量级`Syntax::Keyword::Try`。这是否存在问题取决于您的应用程序。对于许多应用程序来说，它并不重要。

此外，如果您是来自另一种语言的访问者，`Try::Tiny`则存在语法怪癖，这使其与您习惯的 try/catch 不太一样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-10T21:18:01.597

如前所述，旧的错误模块已被弃用，但它在很长一段时间后仍然对我有用。自从我上次检查它是否仍然工作以来已经有一段时间了。我尝试了一些“更好”的替代品，发现它们都缺少，所以我仍然使用 Error。

这是一些代码的示例，该示例非常简单，并打印了捕获的错误。这是来自我编写的一个应用程序，它使用 Storable 将序列化的 perl 对象存储和检索到 MLDBM 后端文件。

```
use Error(':try');
...

     try {
        $obj = retrieve( $objfile );
      } catch Error::Simple with {
        my $E = shift;
        warn "Caught error $E";
      }; 
```

这将返回一条消息，例如：

```
Caught error Not a HASH reference at ./json2text.pl line 12. 
```

如果您想要完整的堆栈跟踪，您可以在调试器下运行代码，或者您可以阅读 perldoc 上有关 Error 类本身的堆栈跟踪方法。我从来没有发现有必要让应用程序不在调试器下运行来打印完整的堆栈跟踪，所以我的集合中没有任何示例可以从中粘贴示例。

我希望这有帮助。有时你只需要等待恐龙出现。

# haskell - 函子和内函子之间的区别

> ID：10342876
> 
> 赞同：46
> 
> 时间：2012-04-26T23:35:55.730
> 
> 标签：haskell, functional-programming, functor

有人可以简单地解释两者之间的区别吗？我不完全理解单子是内函子而不是函子的部分。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-04-26T23:37:22.677

一个函子可以从一个类别转到另一个类别，内函子是一个起点和目标类别相同的函子。

与内同态与态射相同。

现在，为什么单子必须是内函子？

有一句名言“Monads 只是内函子范畴中的幺半群”。幸运的是，其他人已经[在这个答案](https://stackoverflow.com/a/3870310/1011995)中很好地解释了这一点。

monad 必须是 endofunctor 的关键点在于`join`，正如在 Haskell 中所称的那样，或者`µ`如在范畴论中通常所称的那样，是 monad 定义¹的一部分。现在

```
Prelude Control.Monad> :t join
join :: Monad m => m (m a) -> m a 
```

所以将函子`m`应用于对象的结果（在 Hask 中，Haskell 类型的范畴为对象，函数为态射，一种类型）必须是`m`可以再次应用的对象。这意味着它必须属于函子的领域`m`。

只有当它的域和 codomain 相同时，一个函子才能与它自己组合[严格来说，如果它的 codomain 是它的域的子类别]，换句话说，如果它是一个 endofunctor。由于与自身的可组合性是 monad 定义的一部分，因此 monad 更何况是内函子。

¹ 一种定义，可以选择使用`(>>=)`or`bind`和 have`join`作为派生属性来定义 monad。

# regex - 正则表达式最佳实践？

> ID：10342879
> 
> 赞同：1
> 
> 时间：2012-04-26T23:36:02.700
> 
> 标签：regex, database, content-management-system

今天我收到老板发来的一封电子邮件，说要更改进入我们客户网站的 java 脚本代码中的正则表达式

```
[a-zA-Z0-9]+[a-zA-Z0-9_\.\-] 
```

到

```
[a-zA-Z0-9]+[a-zA-Z0-9_\-\.] 
```

因为我们的一位客户抱怨这不是正则表达式的最佳实践，这会导致他们的 CMS 和数据库出现问题。

看看这两个正则表达式，在我看来它们匹配完全相同的东西。

这 。和 - 最后交换，但这不应该有所作为。应该是？

我错过了什么吗？

我们客户公司的开发人员非常坚持我们要改变它。

有人可以阐明一下吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:51:55.090

没有功能上的区别。

如果该正则表达式有任何问题，那么它是一个非标准/错误的实现。我建议找出问题所在。

虽然我认为没有理由改变它，但我认为没有理由*不*改变它，所以按照你的意愿去做。

提示：我猜正则表达式写错了。如果我知道它应该是什么意思，我会写它：

```
[a-zA-Z0-9]+[_\.\-]? 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T23:39:35.103

如果您`-`在字符组中使用 a ，它会排在最后，否则它表示一个字符范围，例如`A-Z`. 如果你像你一样逃避它，那么它可以在任何地方。

`-`他们使用的 CMS 或其他代码可能会取消转义正则表达式，因此在这种情况下，如果不是组中的最后一个字符，它将引发错误。我想说的是，正则表达式中的转义字符越少越好，但这是从个人角度来看的。

# android - 我可以使用 phoneGap 部署到多平台吗？

> ID：10342880
> 
> 赞同：1
> 
> 时间：2012-04-26T23:36:09.527
> 
> 标签：android, ios, blackberry, cordova, windows-mobile

我目前正在为 IOS 和 Android SDK 开发。所以每次我必须做一个应用程序时，我都必须为 2 个独立的平台开发，这需要很长时间。我还计划在 BB、Windows Mobile 等上进行开发。我遇到了 Phonegap，我有一些问题。

首先假设我正在 MAC OS 和 Xcode 4 上进行开发，并且我已经安装了 phonegap 所需的 SDK，我使用模板创建了一个项目并开始使用 HTML5/CSS3 进行编码。项目完成后如何将其导入 Android 平台？我是否应该开始创建一个项目并添加 phonegap 库和所需的 jar，然后我可以立即将 HTML5/CSS3 从 www 文件夹脚本复制粘贴到所需的目录 /assets/www 中？如果这是它应该做的方式，那么我将不得不为 BB 和 Windows 做同样的事情（当然在 Windows 机器上）我们可以做同样的事情吗？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T00:19:08.577

build.phonegap.com 将从您的 Web 内容构建所有需要的应用程序。

# python - 在 Python 中使用 smtplib 发送电子邮件

> ID：10342884
> 
> 赞同：3
> 
> 时间：2012-04-26T23:36:58.467
> 
> 标签：python, email, smtplib

我正在尝试通过 SMTPlib 使用 Gmail 发送电子邮件，当我将它们发送给自己时它工作正常，但每次我尝试向其他人发送电子邮件时，它仍然会将其发送到我自己的电子邮件。

```
import smtplib as s

username = raw_input("Gmail Username: ")
password = raw_input("Gmail Password: ")
obj = s.SMTP("smtp.gmail.com:587")
obj.starttls()
obj.login(username, password)
v_email = raw_input("Email: ")
email_message = raw_input("Message: ")
obj.sendmail(username, v_email, email_message) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T01:00:05.767

查看示例[http://docs.python.org/library/smtplib.html](http://docs.python.org/library/smtplib.html)，在传递给 smtplib.sendmail() 之前检查“msg”是如何填充的

# opengl-es - 跨多个网格对象共享 VBO

> ID：10342885
> 
> 赞同：0
> 
> 时间：2012-04-26T23:37:06.373
> 
> 标签：opengl-es, opengl-es-2.0

我正在开发一个使用 OpenGL ES 2.0 的非常小的游戏引擎。我在将 VBO 集成到我的网格类中时遇到了一些设计问题。

问题是我不想为每个网格实例化一个新的 VBO，我希望 VBO 的大小由我加载到其中的网格的数量来确定（不仅仅是 2MB 的固定大小或其他东西）。

由于 VBO 没有 realloc 函数，我需要一次批量加载所有顶点数据。这没关系，因为我只有 4 或 5 个小网格。所以我创建了一个 MeshList 类。

我调用 MeshList.AddMesh(Mesh mesh) ，它聚合网格对象的顶点/索引数据，并将偏移返回到顶点数据/索引数据数组中，返回到添加的网格。这样，网格就知道它在 VBO 中的位置（但不知道它在哪个 VBO 中）。

但是，在我调用 MeshList.BindToVBO() 之前，没有任何 MeshList 数据上传到 VBO。但是现在，我的网格都不知道它们在哪个 VBO 中。所以我想在 MeshList 中创建一个指针数组，指向每个 Mesh 类中的整数成员变量，这些变量将持有 VBO 句柄。这样，当调用 BindToVBO() 时，它会遍历指针数组并更新网格对象中的 VBO 句柄。

我想，通过这种方式，我可以灵活地将不同的网格对象放在不同的 VBO 中或全部放在一个 VBO 中。我唯一担心的是这是否是一个好的设计。

看一眼代码的人并不清楚 MeshList.BindToVBO() 正在更新一大堆网格对象。我的意思是，MeshList 在调用 BindToVBO() 之前确实与所有 Mesh 对象交互，但是没有明确说明通过将 Mesh 对象传递给 MeshList.AddMesh()，它本质上是订阅它的 VBOHandle 成员以在某个时间点进行更新未来。

我试图尽可能清楚地说明这一点。让我知道是否需要澄清。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T00:35:29.300

老实说，对我来说，一个可疑的回报听起来很麻烦。您是否有理由相信将多个网格放在同一个缓冲区中会显着提高您的性能？

对我来说，这听起来像是过早的优化。

当然，如果您有一个包含 50,000 个粒子的粒子系统，我可以看到希望它位于共享缓冲区中，但总的来说，我不知道将两个任意网格存储在同一个缓冲区中是否有好处。这听起来像是错误和头痛的巨大潜力。

# facebook - 如何在网站上显示您自己的 Facebook 数据

> ID：10342887
> 
> 赞同：0
> 
> 时间：2012-04-26T23:37:21.330
> 
> 标签：facebook, facebook-graph-api, facebook-fql, feed

我得到“您提出的问题似乎很主观，很可能已关闭。” 当我开始写这篇文章时，出现了很多类似的标题。

所以我浏览了所有这些，只有两个可能真正帮助我解决问题，但没有得到回答。

所以......我会继续问我的问题，并希望它不会被关闭。

它是这样的：

我想要的只是在单独的网站上显示 Facebook 页面的提要。即状态更新、照片、视频、事件、评论和喜欢，全部公开。

我用谷歌搜索并查看了 facebook 开发者页面上的一些文档，但我发现的只是关于如何让访问者授予我的 fb-app 做事的权利。然后我会得到一个我可以使用的 access_token，但是这个令牌过期了。

没关系...我*不想*让访问者授予东西，我只想展示*我*的东西，这已经是公开的了。

最好我想用javascript和ajax来做。我的网站可能不支持 PHP。所以如果你有我的答案，请先用javascript说出来:)

尽管所有答案都非常受欢迎。

拜托，非常拜托，上面加糖，帮我做这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T00:02:39.023

获取 Facebook 页面的公共数据很容易，您甚至不必为此拥有该页面。

为此，您将需要一个 facebook 应用程序，一旦您拥有该应用程序，您就可以将 facebook 作为应用程序（来自您的服务器）进行[身份验证，如 Authenticating as an App guide](http://developers.facebook.com/docs/authentication/applications/)中所述。你可以通过一个简单的 curl 请求来尝试它：

```
https://graph.facebook.com/oauth/access_token?
    client_id=YOUR_APP_ID
   &client_secret=YOUR_APP_SECRET
   &grant_type=client_credentials 
```

在您进行身份验证后，您会收到一个应用访问令牌，您可以使用它来对公共数据进行 api 请求。

例如，尝试南方公园页面[对象](http://developers.facebook.com/tools/explorer?method=GET&path=southpark)、[提要连接](http://developers.facebook.com/tools/explorer?method=GET&path=southpark/feed)、[照片连接](http://developers.facebook.com/tools/explorer?method=GET&path=southpark/photos)和[事件连接](http://developers.facebook.com/tools/explorer?method=GET&path=southpark/photos)。图资源管理器中使用的令牌是用户令牌，但您可以将例如从 curl 请求中获得的访问令牌粘贴到那里，它将起作用。

# ios - 从另一个 UIViewController 中呈现一个 UIViewController？

> ID：10342889
> 
> 赞同：1
> 
> 时间：2012-04-26T23:37:29.970
> 
> 标签：ios, uiviewcontroller

我对 iOS 还很陌生，我正在尝试从另一个视图控制器中呈现一个视图控制器，如此处所述：

[堆栈溢出答案](http://www.iphonedevsdk.com/forum/iphone-sdk-development/98797-switching-uiviewcontrollers-programmatically.html)（见第三个答案）

也在[苹果的网站上](https://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html#//apple_ref/doc/uid/TP40007457-CH1-SW1)

我从[Hello World 示例代码](https://developer.apple.com/library/ios/#samplecode/HelloWorld_iPhone/Introduction/Intro.html#//apple_ref/doc/uid/DTS40007709)开始。我打开 MyViewController.m 并修改 updateString() 方法，将这段代码添加到末尾：

```
{
        // Get the application's "window"
    UIWindow *window = [UIApplication sharedApplication].keyWindow;
        // Get the window's rootViewController (NOTE: Only works on iOS 4.0 or later!)
    UIViewController *rootViewController = window.rootViewController;

        // Create our new controller
    UIViewController *enterNameController = [[UIViewController alloc] initWithNibName:@"HighScore" bundle:[NSBundle mainBundle]];

    if (enterNameController != NULL)
    {
        printf("\nLoaded UIView controller. Installing as actionSheetController...\n\n");

        UINavigationController *navigationController = [[UINavigationController alloc]
                         initWithRootViewController:enterNameController];

            // Present out Enter Name for High Score view as a modal view
    //  [rootViewController presentViewController:navigationController animated:YES];       // iOS 2.0 and newer
        [self presentViewController:navigationController animated:YES completion: nil];     // iOS 5.0 and newer
    }
} 
```

我还创建了一个名为“HighScore.xib”的 NIB 文件，我将它与 HelloWorld 附带的其他 NIB 文件放在一起，并将 HighScore.xib 添加到 XCode 项目中，并将其拖到“复制捆绑资源”部分.

按原样，在运行并将文本输入编辑字段时出现错误：

***由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“无法在包中加载 NIB：“NSBundle（已加载）”，名称为“HighScore”

但是，如果我将最后的语句更改为使用“rootViewController”而不是“self”，那么*什么也不会*发生。也不例外，但也没有提出新的观点。

问题：

1) 为什么我的笔尖无法加载？我显然在这里做错了什么。

2）为什么使用“rootViewController”而不是“self”会产生不同的结果？rootViewController 不应该找到与“self”相同的类吗？

请注意，当使用“rootViewController”时，我在 XCode 中收到警告：“MyViewController”可能无法响应“-presentViewController:animated:completion”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:56:22.910

我通过以下方式解决了这个问题：

a) 在此处使用教程：

[http://timneill.net/2010/09/modal-view-controller-example-part-1/](http://timneill.net/2010/09/modal-view-controller-example-part-1/)

b) 在 XCode 项目中的 .xib 文件上单击鼠标右键并执行“获取信息”，并将其类型修改为“file.xib”而不是“sourcecode.xib”。如果没有第二次更改，它将*无法加载*！奇怪。但这最终是问题！

# algorithm - 合并排序时间和空间复杂度

> ID：10342890
> 
> 赞同：42
> 
> 时间：2012-04-26T23:37:39.003
> 
> 标签：algorithm, time-complexity, mergesort, space-complexity

我们以这种合并排序的实现为例

```
void mergesort(Item a[], int l, int r) {
if (r <= l) return;
int m = (r+l)/2;
mergesort(a, l, m);   ------------(1)
mergesort(a, m+1, r); ------------(2)
merge(a, l, m, r); 
```

a) 这种归并排序的时间复杂度是`O(n lg(n))`。并行化（1）和（2）会带来任何实际收益吗？从理论上讲，似乎在将它们并行化之后，您最终也会进入`O(n lg(n))`. 但实际上我们能获得任何收益吗？

b) 这里合并排序的空间复杂度是`O(n)`。但是，如果我选择使用链表执行就地合并排序（不确定是否可以合理地使用数组完成），空间复杂度是否会变为`O(lg(n))`，因为您必须考虑递归堆栈帧的大小？我们可以将`O(lg(n))`其视为常数，因为它不能超过 64 吗？我可能在几个地方误解了这一点。64到底有什么意义？

c)[比较排序算法 - Cprogramming.com](http://www.cprogramming.com/tutorial/computersciencetheory/sortcomp.html)说合并排序需要使用链表的恒定空间。如何？他们对待`O(lg(n))`恒定吗？

d)*添加以获得更清晰。*对于空间复杂度计算，假设输入数组或列表已经在内存中是否公平？当我进行复杂性计算时，我总是计算除了输入已经占用的空间之外我需要的“额外”空间。否则空间复杂度将永远是`O(n)`或者更糟。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2015-02-21T03:17:05.773

MergeSort 时间复杂度是 O(nlgn)，这是一个基础知识。合并排序空间复杂度将始终为 O(n)，包括数组。如果你把空间树画出来，看起来空间复杂度是 O(nlgn)。但是，由于代码是深度优先代码，您将始终只沿着树的一个分支扩展，因此，所需的总空间使用将始终以 O(3n) = O(n) 为界。

比如把空间树画出来，好像是O(nlgn)

```
 16                                 | 16
                            /  \                              
                           /    \
                          /      \
                         /        \
                        8          8                            | 16
                       / \        / \
                      /   \      /   \
                     4     4    4     4                         | 16
                    / \   / \  / \   / \
                   2   2 2   2.....................             | 16
                  / \  /\ ........................
                 1  1  1 1 1 1 1 1 1 1 1 1 1 1 1 1              | 16 
```

其中树的高度是 O(logn) => 空间复杂度是 O(nlogn + n) = O(nlogn)。但是，实际代码中并非如此，因为它不是并行执行的。例如，在 N = 16 的情况下，这就是合并排序代码的执行方式。N = 16。

```
 16
                          /
                         8
                        /
                       4
                     /
                    2
                   / \
                  1   1 
```

注意使用的空间数量是 32 = 2n = 2*16 < 3n

然后向上合并

```
 16
                          /
                         8
                        /
                       4
                     /  \
                    2    2
                        / \                
                       1   1 
```

这是 34 < 3n。然后向上合并

```
 16
                          /
                         8
                        / \
                       4   4
                          /
                         2
                        / \ 
                       1   1 
```

36 < 16 * 3 = 48

然后它向上合并

```
 16
                          / \
                         8  8
                           / \
                          4   4
                             / \
                            2   2
                                /\
                               1  1 
```

16 + 16 + 14 = 46 < 3*n = 48

在更大的情况下，n = 64

```
 64
                    /  \
                   32  32
                       / \
                      16  16
                          / \
                         8  8
                           / \
                          4   4
                             / \
                            2   2
                                /\
                               1  1 
```

这是 64*3 <= 3*n = 3*64

您可以通过对一般情况的归纳来证明这一点。

因此，空间复杂度总是以 O(3n) = O(n) 为界，即使您使用数组实现，只要您在合并后清理已用空间并且不并行执行代码而是顺序执行代码。

我的实现示例如下：

```
templace<class X> 
void mergesort(X a[], int n) // X is a type using templates
{
    if (n==1)
    {
        return;
    }
    int q, p;
    q = n/2;
    p = n/2;
    //if(n % 2 == 1) p++; // increment by 1
    if(n & 0x1) p++; // increment by 1
        // note: doing and operator is much faster in hardware than calculating the mod (%)
    X b[q];

    int i = 0;
    for (i = 0; i < q; i++)
    {
        b[i] = a[i];
    }
    mergesort(b, i);
    // do mergesort here to save space
    // http://stackoverflow.com/questions/10342890/merge-sort-time-and-space-complexity/28641693#28641693
    // After returning from previous mergesort only do you create the next array.
    X c[p];
    int k = 0;
    for (int j = q; j < n; j++)
    {
        c[k] = a[j];
        k++;
    }
    mergesort(c, k);
    int r, s, t;
    t = 0; r = 0; s = 0;
    while( (r!= q) && (s != p))
    {
        if (b[r] <= c[s])
        {
            a[t] = b[r];
            r++;
        }
        else
        {
            a[t] = c[s];
            s++;
        }
        t++;
    }
    if (r==q)
    {
        while(s!=p)
        {
            a[t] = c[s];
            s++;
            t++;
        }
    }
    else
    {
        while(r != q)
        {
            a[t] = b[r];
            r++;
            t++;
        }
    }
    return;
} 
```

希望这会有所帮助！=）

顺志龙，

多伦多大学

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-04-27T00:06:52.297

a）是的-在一个完美的世界中，您必须进行 log n 大小为 n、n/2、n/4 的合并 ...（或者更好地说是 1、2、3 ... n/4、n/2 , n - 它们不能并行化），这给出了 O(n)。它仍然是 O(n log n)。在不那么完美的世界中，您没有无限数量的处理器，上下文切换和同步抵消了任何潜在的收益。

b) 空间复杂度始终为 Ω(n)，因为您必须将元素存储在某处。额外的空间复杂度在使用数组的实现中可能是 O(n)，在链表实现中可能是 O(1)。在实践中，使用列表的实现需要额外的空间用于列表指针，因此除非您已经在内存中拥有该列表，否则这无关紧要。

**编辑** 如果你计算堆栈帧，那么它是 O(n)+ O(log n) ，所以在数组的情况下仍然是 O(n) 。在列表的情况下，它是 O(log n) 额外的内存。

c) 列表只需要在合并过程中改变一些指针。这需要不断增加的内存。

d）这就是为什么在合并排序复杂性分析中人们提到“额外的空间要求”或类似的东西。很明显，您必须将元素存储在某个地方，但最好提及“附加内存”以阻止纯粹主义者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T00:01:02.397

a) 是的，当然，并行化归并排序是非常有益的。它仍然是 nlogn，但您的常数应该会显着降低。

b) 链表的空间复杂度应该是 O(n)，或者更具体地说是 O(n) + O(logn)。请注意，这是一个 +，而不是 *。在进行渐近分析时，不要过多关注常数。

c) 在渐近分析中，只有方程中的主导项很重要，所以我们有一个 + 而不是一个 * 的事实使它成为 O(n)。如果我们全部复制子列表，我相信这将是 O(nlogn) 空间 - 但是基于智能链表的合并排序可以共享列表的区域。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-19T06:53:16.883

合并排序的最坏情况性能： **O(n log n)**，合并排序的最佳情况性能：**O(n log n) 通常，O(n) 自然变体**，合并排序的平均性能：**O(n log n)** , 归并排序的最坏情况空间复杂度：**О(n) 总，O(n) 辅助**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-13T04:22:03.267

**简单而聪明的思维。**

总水平 (L) = log2(N)。在最后一级节点数 = N。

**第 1 步：**让我们假设所有级别 (i) 都有节点 = x(i)。

**第 2 步：**所以时间复杂度 = x1 + x2 + x3 + x4 + .... + x(L-1) + N(对于 i = L);

**第 3 步：**事实我们知道，x1,x2,x3,x4...,x(L-1) < N

**第 4 步：**让我们考虑 x1=x2=x3=...=x(L-1)=N

**第 5 步：** 所以时间复杂度 = (N+N+N+..(L) 次)

时间复杂度 = O(N*L); 放 L = log(N);

**时间复杂度 = O(N*log(N))**

我们在合并时使用额外的数组，

**空间复杂度：O(N)。**

**提示：大 O(x) 时间意味着，x 是我们可以肯定地说在平均情况下它永远不会超过 x 的最小时间**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-21T13:34:08.853

对于最好和最坏的情况，复杂度都是 O(nlog(n)) 。虽然每一步都需要额外的 N 大小的数组，所以空间复杂度是 O(n+n) 是 O(2n)，因为我们删除了计算复杂度的常数值，所以它是 O(n)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-07-18T08:17:05.917

合并排序空间复杂度是`O(nlogn)`，考虑到它最多可以进行`O(logn)`递归并且对于每个递归都有额外的空间`O(n)`来存储需要重新分配的合并数组，这是非常明显的。对于那些说`O(n)`请不要忘记它是`O(n)`为了到达堆栈帧深度的人。

# java - Unix 上的 Java Apache Commons CLI；> 被视为可执行文件的参数而不是重定向

> ID：10342893
> 
> 赞同：2
> 
> 时间：2012-04-26T23:38:02.017
> 
> 标签：java, unix, apache-commons, apache-commons-cli

我正在尝试在 Windows 和 Unix 上自动化一些命令行测试。我正在使用 Java 1.6 和 Apache Commons CLI 1.1 来执行此操作。我在 Java 代码中所做的是构建我想要使用 Apache Commons CLI addArgument 方法运行的命令。在构建要运行的命令行后，我想将命令的输出通过管道传输到文件中，因此我将以下内容添加到命令的末尾

```
cloudscan_cmdl.addArgument(">");
cloudscan_cmdl.addArgument(cloudscanOutputFilename); 
```

cloudscanOutputFilename 是包含我要使用的文件名的字符串。这在 Windows 上运行良好，命令被构建，被重定向的两个参数被添加并且文件被很好地创建。但是，在 Unix 上，它将 > 和文件名字符串视为可执行文件的附加参数，而不是重定向。

我该怎么做才能让 Unix 读取这个命令，就好像它是在命令行上直接输入的一样？我已将命令作为字符串输出并在 Unix 中复制并粘贴它，它按预期工作，但是当从 Java 程序运行时，重定向没有得到正确处理。

我尝试使用该方法的 addArgument(string, boolean) 版本作为 true 和 false ，但都没有帮助。这真的让我发疯了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T23:47:44.353

您误解了[课程](http://commons.apache.org/exec/apidocs/org/apache/commons/exec/CommandLine.html#addArgument%28java.lang.String,%20boolean%29)的目的。如前所述，它用于“指定要执行的进程”。它可以帮助您将参数列表传递给程序。它不是为了告诉 shell 做什么。 `>`是由 shell 实现的重定向操作符。它在 Windows 上工作的事实是一个意外。

另外，请注意，这是[Apache Commons Exec](http://commons.apache.org/exec/index.html)的一部分，而不是[Apache Commons CLI](http://commons.apache.org/cli/)的一部分。

为了避免自己进行重定向，最好的选择可能是为每个平台制作一个简单的批处理文件或 shell 脚本并调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:43:11.723

逃生`>`，例如

```
cloudscan_cmdl.addArgument("\>"); 
```

# reporting-services - 在 SSRS 中使用多个数据集中的字段

> ID：10342896
> 
> 赞同：9
> 
> 时间：2012-04-26T23:38:34.323
> 
> 标签：reporting-services, ssrs-2008

我知道 Crystal Reports 在开发社区中已经失去了一些人的青睐，也许这是正确的：我已经有 15 年没有使用它了。但是当我这样做时，我可以让它唱歌。

也许这就是我觉得 SSRS 如此令人失望的原因。该软件笨拙，不直观且一维。上周我一直在与它作斗争，作为最后的手段，我在这里发帖。

我被迫完全在 SQL Server 表中创建我的报告，我不应该这样做。

例如：为什么我不能在文本框中使用表达式；

```
 Fields!Foo1.Value/Fields.Foo2.Value 
```

其中 Foo1 在 Dataset1 中，而 Foo2 在 Dataset2 中。

如果这超出了软件的能力，那没关系。我开始认为是。

所以也许有人可以回答这个问题：除了Crystal Reports 和Reporting Services，还有谁知道其他更通用的报表软件吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-10T07:21:45.770

我想你现在应该已经解决了，但是如果你面临同样的问题，那么你可以`lookup`在表达中使用。
它使您能够浏览其他数据集的值，而这两个数据集中都有一个公共字段

```
=Lookup(value in dataset1,value in dataset2, common field in both datasets, dataset name from which we need to get data) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-27T09:36:00.353

Crystal 和 SSRS 都不允许您逐行直接比较两个不同数据集中的值。

在*这两种*工具中：

*   如果两个数据集都来自同一个关系数据库，那么比较值的最简单方法是将两个数据集组合成一个查询。
*   如果两个数据集来自可以链接在一起的不同关系数据库（例如，通过使用 SQLServer 中的链接服务器或 Oracle 中的数据库链接），那么比较值的最简单方法是将两个数据集组合成一个访问两个链接的数据库。
*   如果两个数据集都来自无法直接链接在一起的数据源，则可以通过子报表在 Crystal/SSRS 中将这两个数据集链接在一起。（有关 SSRS 中的子报告的更多详细信息，请[点击此处](http://msdn.microsoft.com/en-us/library/ms160348%28v=sql.100%29.aspx)。）

有一个名为 BIRT 的报告工具，它具有与 SSRS 类似的报告范式（即 Web 样式的布局，而不是 Crystal 的带状报告方法），包括与 SSRS 大致相同的功能，是开源的，使您能够将数据集链接在一起直接创建联合数据集。但是，它的使用不如 Crystal 或 SSRS 直观。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-27T00:18:54.353

坚持下去 - Reporting Services 是一个非常灵活的报告平台。

您可以通过在字段名称后指定数据集来做您想做的事情，但您必须指定您想要的 Foo2 或您想要如何处理 Foo2。

你这样做的方式是通过聚合函数。例如，假设 Dataset2 只有一行数据，那么您会得到第一个：

```
=Fields!Foo1.Value / First(Fields!Foo2.Value, "Dataset2") 
```

如果有很多行并且您想除以 Foo2 的总和，那么您可以这样做：

```
=Fields!Foo1.Value / Sum(Fields!Foo2.Value, "Dataset2") 
```

关键是，您当前正在逐步执行 Dataset1 - 您需要让 Reporting Services 知道如何处理 Dataset2 才能返回您需要的 Foo2。

# c++ - 无法将 JPEG 编码的 BITMAP 转换为 Gdiplus::Bitmap 对象

> ID：10342903
> 
> 赞同：2
> 
> 时间：2012-04-26T23:39:15.450
> 
> 标签：c++, bitmap, gdi+, jpeg, gdi

我正在使用 c++ 做一些图像工作，我希望能够使用 jpeg 压缩文件。GDI+ 库似乎有我需要的东西，特别是 Gdiplus::Bitmap::GetPixel() 例程是我最终想要使用的。

有几个 Gdiplus::Bitmap 构造函数，我想使用的一个接受一个 BITMAPINFO 结构和一个指向图像位的指针。[Bitmap.Bitmap(const BITMAPINFO* lpbmi, VOID* lpbits)](http://msdn.microsoft.com/en-us/library/ms536312%28v=vs.85%29.aspx) 我已经从挂钩的[StretchDIBits()](http://msdn.microsoft.com/en-us/library/dd145121%28v=vs.85%29.aspx)中获得了这些信息，所以我什至没有创建原始的 BITMAP，它是给我的。但是位图上是为**JPEG设置的压缩**[(BITMAPINFO.BITMAPINFOHEADER.biCompression = BI_JPEG)](http://msdn.microsoft.com/en-us/library/dd183376%28v=vs.85%29.aspx)，所以解析不好，也不知道怎么做，或者想写个jpeg解压算法。

以下是我用来尝试利用 GDI+ 库来查看 jpeg 压缩图像中的单个像素的代码：

```
// lpbmi and lpBits come from a hooked StretchDIBits call. I did not generate this data.
// The following is some sample data that i've seen go in and not work:
//
// lpbmi->bmiHeader.biSize = 40 
// lpbmi->bmiHeader.biWidth = 1299 
// lpbmi->bmiHeader.biHeight = -1 
// lpbmi->bmiHeader.biPlanes = 1 
// lpbmi->bmiHeader.biBitCount = 0 
// lpbmi->bmiHeader.biCompression = 4        // resolves to BI_JPEG 
// lpbmi->bmiHeader.biSizeImage = 955 
// lpbmi->bmiHeader.biXpelsPerMeter = 0 
// lpbmi->bmiHeader.biYpelsPerMeter = 0 
// lpbmi->bmiHeader.biClrUsed = 0 
// lpbmi->bmiHeader.biClrImportant = 0 
//
// This data looks valid to me, so i don't know why nothing happens when trying to convert
// it into a Gdiplus::Bitmap
void SomeMethod(const BITMAPINFO * lpbmi, const void * lpBits)
{
    // Apparently, this is needed before using GDI+ libraries. I experimented
    // without this and nothing different happend.  Not even a crash.
    GdiplusStartupInput gdiplusStartupInput;
    ULONG_PTR gdiplusToken;
    GdiplusStartup(&gdiplusToken, &gdiplusStartupInput, NULL);

    // Because the BitmapClass doesn't take in a (const void *), I have to copy the data
    // into another array.  Not much i can do about it because i'm given lpBits as a
    // (const void *)
    void * data = malloc(lpbmi->bmiHeader.biSizeImage);
    memcpy(data, lpBits, lpbmi->bmiHeader.biSizeImage);

    // I "expect" that this bascially reads in the data provided and creates our
    // Bitmap class.
    Bitmap bitmap(lpbmi, data);

    // The problem is, Width and Height are always 0\.  Can't figure out why.
    UINT Width = bitmap->GetWidth();        // Why always 0????
    UINT Height = bitmap->GetHeight();      // Why always 0????

    //////////////////////
    // Some more code ...
    //////////////////////
} 
```

任何人都知道为什么 Gdiplus::Bitmap 类没有对我提供的数据做任何事情？

# php - 从数据库中的多个表中删除数据

> ID：10342911
> 
> 赞同：0
> 
> 时间：2012-04-26T23:40:18.023
> 
> 标签：php, database, sql-delete

我一直在试图弄清楚如何从数据库中的多个表中删除数据。只是为了提供一些背景知识，有一个用户表，其中包含名字和姓氏等基本信息。然后是一个包含密码和用户名的登录表。我正在制作一个管理页面，允许我查看包含两个表中信息的用户列表。那部分工作正常。我的问题是尝试创建删除脚本。我尝试进行单独的查询，但我一无所获。有人可以给我一些方向吗？或者至少在某个地方我可以专门阅读这个？

```
// Get IDs
$lid = $_POST['lid'];
$uid = $_POST['uid'];

// Delete the product from the database
require_once('database.php');

$query = "DELETE user,login FROM user INNER JOIN login ON user.uid = '$uid' AND login.lid= '$lid'";
 $db->exec($query); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:45:41.223

添加一个外键，然后在您的列定义中使用 ON DELETE CASCADE 这将在删除父行时负责删除子行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T23:46:11.230

是否可以在单个 DML 语句中执行此操作将取决于数据库（以及可能存在哪些约束）。不过，更简单的选择通常是使用两个 DML 语句来执行类似的操作。

```
$query = "DELETE FROM user WHERE user.uid = '$uid'";
$db->exec($query);
$query = "DELETE FROM login WHERE login.lid= '$lid'";
$db->exec($query); 
```

# c# - 在 Windows 窗体中使用 EF 4 掌握详细信息

> ID：10342916
> 
> 赞同：0
> 
> 时间：2012-04-26T23:41:00.693
> 
> 标签：c#, winforms, entity-framework, linq-to-entities

使用 Northwind 数据库作为实体数据模型，我从数据源窗口 2 中拖出包含 Orders 和 Order_details 的 datagridview 控件，并将它们放在 Windows 窗体上。运行项目时，我只填充了 Orders Gridview，而不是排序。接下来是我在表单加载事件中使用的代码：

```
 using(NorthwindEntities context = new NorthwindEntities())
        {

        ordersDataGridView.DataSource = context.Orders;
        ordersBindingSource.Sort = "CustomerID ASC";

        order_DetailsDataGridView.DataSource = order_DetailsBindingSource;

        } 
```

如何使明细网格显示与所选订单实体相关的项目，以及如何对订单网格进行排序？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T02:13:25.813

1.  在详细信息网格中显示选择订单的相关项目应自动工作，无需任何添加代码。请检查您的详细信息绑定源的 BindingSource.DataSource 属性。它应该包含您的主绑定源的名称。

2.  您可以使用 linq 查询对订单进行排序：

    ordersDataGridView.DataSource = context.Orders.OrderBy(o => o.CustomerID);

# c# - 将 basicHttpBinding 与 Windows 身份验证一起使用

> ID：10342928
> 
> 赞同：0
> 
> 时间：2012-04-26T23:42:44.793
> 
> 标签：c#, asp.net, wcf, web-services

我正在尝试遵循此处的操作指南：

[http://msdn.microsoft.com/en-us/library/ff648505.aspx](http://msdn.microsoft.com/en-us/library/ff648505.aspx)

但是，第 2 步：

> 在配置编辑器的配置部分中，展开服务，然后展开端点。选择第一个节点 [Empty Name]。将 name 属性设置为 BasicHttpEndpoint。

我的服务节点无法扩展，没有服务设置？我创建了一个新的网络服务。然后右键单击编辑 WCF 配置？

# iphone - ALAsset valueForProperty:ALAssetPropertyLocation 未声明？

> ID：10342931
> 
> 赞同：1
> 
> 时间：2012-04-26T23:43:09.673
> 
> 标签：iphone, objective-c, ios, uiimagepickercontroller, alasset

这可能看起来太容易了，或者只是让我感到困惑……或者我太累了，无法理性思考。

我正在尝试使用 imagePickerController 从相册中获取用户已选择的 UIImage 的位置。

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    UIImage *pic = [info objectForKey:@"UIImagePickerControllerOriginalImage"];
    NSData *data = UIImageJPEGRepresentation(pic, 0.01f);
    UIImage *image1 = [UIImage imageWithData:data];
    bookmarkImage.image = image1;

    NSLog(@"new image size = %i", [data length]);

    NSURL *url = [info objectForKey:@"UIImagePickerControllerReferenceURL"];
    4NSLog(@"%@",url);

    ALAssetsLibraryAssetForURLResultBlock resultBlock = ^(ALAsset *myAsset){
        [myAsset valueForProperty:ALAssetPropertyLocation];
    };

    [self dismissModalViewControllerAnimated:YES];
} 
```

现在，我尝试为 ALAsset调用**valueForProperty时遇到了麻烦。**这是我得到的错误：

使用未声明的标识符“ALAssetPropertyLocation”。

请帮忙！这真是令人沮丧...我需要照片的位置...

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-27T19:54:08.620

这很愚蠢，但我一直缺少导入：

```
#import <AssetsLibrary/ALAsset.h> 
```

感谢指出它的markus！

# java - Neo4j 中的索引

> ID：10342934
> 
> 赞同：4
> 
> 时间：2012-04-26T23:43:18.687
> 
> 标签：java, indexing, neo4j

我想知道当需要基于某些节点类型或字段有多个 indecies 时，什么是更好的方法。例如，假设我想要一个学生图表，并希望按他们的学校和 ID 对他们进行索引。

据我了解，我可以像这样为每所学校建立一个索引：

```
// add student
Index<Node> index = this.graphDb.index().forNodes(schoolName);
Node node = this.graphDb.createNode();
node.setProperty("id", studentId);
index.add(node, "id", studentId);

// get student
Index<Node> index = this.graphDb.index().forNodes(schoolName);
Node node = index.get("id", studentId).getSingle(); 
```

另一方面，我可以使用一个索引并执行以下操作：

```
// add student
Index<Node> index = this.graphDb.index().forNodes("schools");
Node node = this.graphDb.createNode();
node.setProperty("id", studentId);
index.add(node, schoolName + ":id", studentId);

// get student
Index<Node> index = this.graphDb.index().forNodes("schools");
Node node = index.get(schoolName + ":id", studentId).getSingle(); 
```

什么是更好的方法？一个比另一个有什么优势？当涉及很多节点时，尤其是性能方面或存储方面。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T06:14:13.603

你的方法是完全有效的。如果要查询一所学校的所有学生，可以使用：

```
Iterable<Node> pupils = index.query(schoolName + ":*"); 
```

您也可以将两个字段都添加到索引中：

```
index.add(node, "schoolName", studentId);
index.add(node, "id", studentId); 
```

然后通过组合查询来查询它们

```
Iterable<Node> pupils = index.query("schoolName:"+schoolName + " AND id:"+id); 
```

第一个索引大小较小，但第二个更强大。性能方面它不会产生如此大的差异（但您可以对其进行测试并报告）。

您还可以在图中使用一个结构，其中学校是一个节点，学生通过关系连接到它，该`LEARNS_AT`关系也可以具有`start`和`end`时间属性，因此更容易为您的域建模。请参阅此[演示图](http://tinyurl.com/7qtn647)

# css - 在页面底部放置一个 div

> ID：10342936
> 
> 赞同：1
> 
> 时间：2012-04-26T23:43:37.660
> 
> 标签：css

我有一个正在处理的页面[http://s361608839.websitehome.co.uk/testsite/](http://s361608839.websitehome.co.uk/testsite/)

基本上，div #footer 应该位于页面底部，因为它位于标记的末尾，并且它也在 #wrapper 之外。

**HTML：**

```
 <div id="footer">This footer text should be underneath the white box (at the bottom)</div> 
```

**CSS：**

```
#footer{
width: 960px;
margin: 0 auto;
color: #FFF;
} 
```

我尝试将 a 添加`clear:both`到 CSS 中，因为我认为页面中某处的浮动可能会导致此问题，但它似乎没有做任何事情。

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T23:54:43.280

将您的#header 位置更改为相对并删除#register 上的'top' 声明，一切都好起来了！

绝对定位会对页面流造成严重破坏，因此在使用时请记住这一点！

# python - 一组python的幂集和笛卡尔积

> ID：10342939
> 
> 赞同：10
> 
> 时间：2012-04-26T23:43:52.777
> 
> 标签：python, python-3.x

我试图找到两个不同集合的笛卡尔积。我在网上找不到任何关于集合的笛卡尔积的任何东西，它要么是列表，要么是字典。

电源组也很混乱。

我一直在使用的书中没有一个。

你们中的一个能否指出我正确的方向。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-26T23:45:11.160

对于笛卡尔积，请查看[`itertools.product`](http://docs.python.org/library/itertools.html#itertools.product)。

对于 powerset，[文档`itertools`还](http://docs.python.org/library/itertools.html#recipes)为我们提供了一个秘诀：

```
def powerset(iterable):
    "powerset([1,2,3]) --> () (1,) (2,) (3,) (1,2) (1,3) (2,3) (1,2,3)"
    s = list(iterable)
    return chain.from_iterable(combinations(s, r) for r in range(len(s)+1)) 
```

例如：

```
>>> test = {1, 2, 3}
>>> list(powerset(test))
[(), (1,), (2,), (3,), (1, 2), (1, 3), (2, 3), (1, 2, 3)]
>>> list(product(test, test))
[(1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (2, 3), (3, 1), (3, 2), (3, 3)] 
```

# java - Java：计算内存使用量时结果不准确

> ID：10342940
> 
> 赞同：1
> 
> 时间：2012-04-26T23:43:59.017
> 
> 标签：java, memory, jvm

我想计算我的 java 应用程序的当前内存使用情况。但是，当我使用以下代码时，任务管理器中显示的内容有很大不同。

```
Runtime rt = Runtime.getRuntime();
long usedMemory = (rt.totalMemory() - rt.freeMemory()) / 1024; 
```

根据任务管理器的说法，当进程消耗 3.000.000 K 时，此代码将例如计算 2.015.203 和一秒钟后的 1.712.296，而实际上内存使用量已经增长。

根据类似的问题，代码应该没问题，但为什么和任务管理器相比有这么大的差异呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T23:49:13.700

TaskManager 告诉您 Java 进程（JVM）的所有可用内存。

在内部，JVM 根据程序的需要管理此内存（因此，在 JVM 内部有“空闲”内存，但对 TaskMan 来说似乎已使用）。

此外，当 GC 认为它最有用时，它会释放内存。所以，很有可能在创建更多对象后，使用的内存变少了，因为 GC 已经清扫了之前分配的（但无法到达的）内存。

# asp.net - 标记 生成解析器异常

> ID：10342941
> 
> 赞同：4
> 
> 时间：2012-04-26T23:43:59.937
> 
> 标签：asp.net, visual-studio-2010, master-pages, meta-tags, contentplaceholder

我有一个使用主文件的 Web 表单。

我正在尝试默认设置一些元标记，但可以在子文件中覆盖

我将 Main.Master 文件设置为如下所示：

```
<head runat="server">    
    <asp:ContentPlaceHolder ID="pgTitle" runat="server"> 
        <meta id="mtaPgTitle" runat="server" class="pgTitle" content="DefaultTitle"/>
    </asp:ContentPlaceHolder> 
```

这会在 Main.Master.designer.cs 文件中创建一行，如下所示

```
protected global::System.Web.UI.HtmlControls.HtmlMeta mtaPgTitle; 
```

但是，当我尝试运行它时，我收到一条带有解析器错误的消息

```
The base class includes the field 'mtaPgTitle', but its type (System.Web.UI.HtmlControls.HtmlMeta) is not compatible with the type of control (System.Web.UI.HtmlControls.HtmlGenericControl). 
```

我们最近刚刚从 VS2008 升级到 VS2010。有没有办法解决这个问题，无法手动梳理设计器文件以将类型恢复为 HtmlGenericControl？我尝试为各种加载事件添加修复程序，但解析器错误似乎发生在其中任何一个事件之前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T02:59:36.803

我偶然发现了一篇很棒的文章，它可能会帮助您为您的页面开发动态 html 元标记... [ASP.Net Master Pages 和 ContentPlaceholders 中的元标记](http://weblogs.asp.net/jasonconway/archive/2008/03/24/meta-tags-in-asp-net-using-masterpage-and-contentplaceholders.aspx)

希望这可以帮助！

# jquery - 下拉列表和高亮效果

> ID：10342946
> 
> 赞同：0
> 
> 时间：2012-04-26T23:44:57.947
> 
> 标签：jquery, jquery-ui

我有一个下拉列表，我想用这个来突出显示：

```
$('#album').effect("highlight", {}, 1000); 
```

我的下拉菜单改变了它的颜色，但颜色没有变回来。如果我尝试使用 div 的方法，它会起作用，所以我猜该方法不是真的适用于下拉菜单，但它们有类似的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T01:39:23.387

突出显示在带有或不带有选项参数的下拉列表中都可以正常工作。看看这个 jsFiddle。

[http://jsfiddle.net/py7B8/1/](http://jsfiddle.net/py7B8/1/)

您的代码中还有其他内容吗？你能在 jsFiddle 中重现这个问题吗？

# zend-framework - 如何在控制器内的变量中捕获 default.phtml

> ID：10342947
> 
> 赞同：2
> 
> 时间：2012-04-26T23:45:05.740
> 
> 标签：zend-framework, zend-view, zend-layout

我有一个简单的问题...如何将 Project/application/layouts/scripts/default.phtml 中的 default.phtml 的内容呈现给变量，以便我可以拥有它的 html。

在索引控制器中，使用一个动作和一个名为 test 的 phtml 文件，这将起作用：

```
$html = $this->view->render('index/test.phtml'); 
```

但是，当然，这不会：

```
$htmlDefaultLayout = $this->view->render('default.phtml'); 
```

由于 default.phtml 不在任何控制器内，我猜。

有什么好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T00:07:59.210

您可以停止渲染并像这样获取输出：

```
$this->_helper->layout()->disableLayout();
$this->_helper->viewRenderer->setNoRender(true);
$this->view->addScriptPath(APPLICATION_PATH . '/layouts/scripts/'); //default layout path
$htmlDefaultLayout = $this->view->render('default.phtml'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T01:45:50.277

您可以添加到`Zend_View`查找视图的路径，这样您就可以渲染 default.phtml 文件。

例子：

```
// add the layout directory to the path
$this->view->addScriptPath(APPLICATION_PATH . '/layouts/scripts/');

$htmlDefaultLayout = $this->view->render('default.phtml'); 
```

在 Zend_View 中添加到 scriptPath 的最后一个路径是第一个要检查的 (LIFO)。

请参阅[查看脚本路径](http://framework.zend.com/manual/en/zend.view.controllers.html#zend.view.controllers.script-paths)。

# asp.net - Ajax scriptmanager 出现 404 错误的问题

> ID：10342949
> 
> 赞同：2
> 
> 时间：2012-04-26T23:45:14.743
> 
> 标签：asp.net, asp.net-ajax

我对 ajaxtoolkit 的脚本管理器有问题，它给出了 404 错误。

default.aspx?_TSM_HiddenField_=ScriptManager1_HiddenField&_TSM_CombinedScripts_=%3b%3bAjaxControlToolkit%2c+Version%3d3.5.51116.0%2c+Culture%3dneutral%2c+PublicKeyToken%3d28f01b0e84b6d53e%3aen-US%3a2a06c7e2-728e-4b15-83d6-9b269fb7261e%3a475a4ef5 %3a5546a2b%3ad2e10b12%3aeffe2a26%3a37e2e5c9%3a5a682656%3a12bbc599

这给出了 404 错误，但 default.asp 文件显示正常

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T03:45:09.600

404是因为Url太长被web服务器拒绝了。尽管页面通常看起来不错，但 Ajax 控件将无法正常工作。

如果您的 Web 服务器在 .NET Framework 4.0 或更高版本上，您可以通过将以下部分添加到 web.config 中的 <system.webServer> 元素来克服该错误：

```
 <security>
     <requestFiltering>
        <requestLimits maxQueryString="5000" />
     </requestFiltering>
  </security> 
```

# jquery - JQuery：一个无限滚动的div内容？

> ID：10342958
> 
> 赞同：1
> 
> 时间：2012-04-26T23:46:24.150
> 
> 标签：jquery

我有一个简单的 JQuery 函数，可以让 DIV 的内容无休止地横向滚动。它工作正常，但是当它到达内容的末尾时，它会继续滚动但没有显示任何内容，这是由于内容完成后的预期。我想让它重复，所以它永远不会停止滚动，当内容完成时，它会重复自己。

到目前为止，我认为这样做的唯一方法是多次复制 div 内容，即：

```
var element = $("#divContent")
for(var x=0; x<=50; x++)
    element.html( element.html + element.html ); 
```

我认为这会起作用，但必须有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T00:09:37.497

如果您最初创建了 2 个版本的内容 - 当第一个项目完全看不见时，您可以使用 css 将其移动为最后一个项目（您可以只使用相对或绝对定位）。我制作了一个动画来说明它是如何工作的。您必须`overflow:hidden`在父容器上设置（示例中为#wrapper）并限制它的宽度才能使其正常工作。

![动画片](../Images/68f832f972e309f750ded5f93937e670.png)

# sql - 我不知道如何使用我的存储过程从旧表中读取并将新结果保存到另一个表中

> ID：10342962
> 
> 赞同：0
> 
> 时间：2012-04-26T23:47:08.343
> 
> 标签：sql, sql-server, tsql, stored-procedures

我如何从下面的逻辑中获得结果，我想将其放入存储过程中，并计算原始行将被分成多少行的循环。因此，给定的行最终可能最终被计算为三个新行......或没有行......或一个。所以我需要一个柜台和一种方法来把它从诱惑中拿出来，放到一张真正的桌子上。我已经尝试更新临时表并在今天工作了几个小时，但没有运气。我已经尝试将我所有的 id 插入到临时表中。我只是不熟悉如何做到这一点，今天已经研究了很多。帮助表示赞赏：

```
declare @StartTime time
declare @EndTime time
declare @Temp_StartTime time

declare @temp_StartHour int
declare @temp_EndHour int
declare @temp_StartMinute int
declare @temp_EndMinute int

SET @StartTime='2:30:00'
SET @EndTime='4:01:00'
SET @Temp_StartTime=@StartTime

SET @temp_StartHour=DATEPART(HOUR, @StartTime)
SET @temp_EndHour=DATEPART(HOUR, @EndTime)
SET @temp_StartMinute=DATEPART(MI, @StartTime)
SET @temp_EndMinute=DATEPART(MI, @EndTime)

if(@temp_EndMinute>0)
    BEGIN
        SET @temp_EndHour=@temp_EndHour+1
    END

DECLARE @Temp_Table TABLE
(
  StartHour int,
  StartMinute int,
  EndHour int,
  EndMinute int,
  StartTime time,
  EndTime time
)

WHile((@temp_EndHour-@temp_StartHour>=1))
    BEGIN
        INSERT INTO @Temp_Table
        SELECT (DATEPART(HOUR, @Temp_StartTime)) AS StartHour,(DATEPART(MINUTE, @Temp_StartTime)) AS StartMinute,
        @temp_StartHour+1 AS EndHour, 
        0 AS EndMinute, @StartTime as StartTime, @EndTime as EndTime

        SET @temp_StartHour=@temp_StartHour+1
        SET @Temp_StartTime=DATEADD(HOUR,1,@Temp_StartTime)

        if(DATEPART(MI, @Temp_StartTime)!=0)
            BEGIN
                SET @Temp_StartTime=DATEADD(MI,-@temp_StartMinute,@Temp_StartTime)
            END
    END

--here's where it all goes horribly wrong
SELECT * INTO newTable FROM @Temp_Table 
```

* * *

更多信息：

答案可以在我之前提出的问题中找到。我开始了这个问题的缩小版，因为我认为我发布了太多信息，以至于有人找不到帮助我的观点。但这并不完全正确，因为我从另一个用户那里得到了很好的回答。

*   [需要通过临时表中的 ID 更新存储过程中的行 - SQL SERVER](https://stackoverflow.com/questions/10341080/need-to-update-rows-from-a-stored-procedure-via-ids-in-a-temp-table-sql-server)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T00:03:29.943

从表面上看，最后一行出现了可怕的错误，应该是：

```
INSERT INTO newTable SELECT * FROM @Temp_Table 
```

这是将所有行从一个表传输到另一个表的标准方法。通常首选在 INSERT 部分中明确列出列并代替`*`：

```
INSERT INTO newTable(StartHour, StartMinute, EndHour, EndMinute, StartTime, EndTime)
    SELECT StartHour, StartMinute, EndHour, EndMinute, StartTime, EndTime
      FROM @Temp_Table 
```

这确实假设两个表中的列名相同。如有必要，您可以使用名称来解决问题。@Temp_Table 中未列出的 newTable 中的任何额外列都将插入一个空值；如果这导致违反约束，则应中止整个语句。

# php - PHP LZW 二进制解压函数

> ID：10342963
> 
> 赞同：8
> 
> 时间：2012-04-26T23:47:29.423
> 
> 标签：php, javascript, lzw

我一直在网上寻找，在 PHP 中找不到与这些 javascript 函数输出的数据一起使用的 LZW 解压缩实现：

```
function lzw_encode(s) {
    var dict = {};
    var data = (s + "").split("");
    var out = [];
    var currChar;
    var phrase = data[0];
    var code = 256;
    for (var i=1; i<data.length; i++) {
        currChar=data[i];
        if (dict[phrase + currChar] != null) {
            phrase += currChar;
        }
        else {
            out.push(phrase.length > 1 ? dict[phrase] : phrase.charCodeAt(0));
            dict[phrase + currChar] = code;
            code++;
            phrase=currChar;
        }
    }
    out.push(phrase.length > 1 ? dict[phrase] : phrase.charCodeAt(0));
    for (var i=0; i<out.length; i++) {
        out[i] = String.fromCharCode(out[i]);
    }
    return out.join("");
}

function lzw_decode(s) {
    var dict = {};
    var data = (s + "").split("");
    var currChar = data[0];
    var oldPhrase = currChar;
    var out = [currChar];
    var code = 256;
    var phrase;
    debugger;
    for (var i=1; i<data.length; i++) {
        var currCode = data[i].charCodeAt(0);
        if (currCode < 256) {
            phrase = data[i];
        }
        else {
           phrase = dict[currCode] ? dict[currCode] : (oldPhrase + currChar);
        }
        out.push(phrase);
        currChar = phrase.charAt(0);
        dict[code] = oldPhrase + currChar;
        code++;
        oldPhrase = phrase;
    }
    return out.join("");
} 
```

我真的只需要一个 PHP 中的解压缩算法，它可以与上面的压缩 javascript 函数一起使用。

上面的 lzw_encode 函数将“This is a test of the compression function”编码为**“This Ă a test ofĈhe comprĊsion functěn”**

我发现的库要么有问题（http://code.google.com/p/php-lzw/），要么不输入 UTC 字符。

任何帮助将不胜感激，

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-27T11:53:42.113

我已经为您移植并测试了它到 PHP：

```
function lzw_decode($s) {
  mb_internal_encoding('UTF-8');

  $dict = array();
  $currChar = mb_substr($s, 0, 1);
  $oldPhrase = $currChar;
  $out = array($currChar);
  $code = 256;
  $phrase = '';

  for ($i=1; $i < mb_strlen($s); $i++) {
      $currCode = implode(unpack('N*', str_pad(iconv('UTF-8', 'UTF-16BE', mb_substr($s, $i, 1)), 4, "\x00", STR_PAD_LEFT)));
      if($currCode < 256) {
          $phrase = mb_substr($s, $i, 1);
      } else {
         $phrase = $dict[$currCode] ? $dict[$currCode] : ($oldPhrase.$currChar);
      }
      $out[] = $phrase;
      $currChar = mb_substr($phrase, 0, 1);
      $dict[$code] = $oldPhrase.$currChar;
      $code++;
      $oldPhrase = $phrase;
  }
  var_dump($dict);
  return(implode($out));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-18T18:57:12.537

现在有一个[PHP 扩展](https://github.com/quickshiftin/lzw-ext)！

```
lzw_decompress_file('3240_05_1948-1998.tar.Z', '3240_05_1948-1998.tar');
$archive = new PharData('/tmp/3240_05_1948-1998.tar');
mkdir('unpacked');
$archive->extractTo('unpacked'); 
```

# php - CodeIgniter htaccess mod_rewrite 无法正常工作

> ID：10342964
> 
> 赞同：2
> 
> 时间：2012-04-26T23:47:30.107
> 
> 标签：php, .htaccess, codeigniter, mod-rewrite

我正在尝试将网址设置为 `http://127.0.0.1/dev/blog/welcome`，但是当我键入时，它会将网址更改为`http://127.0.0.1/dev/blog/index.php/welcome`

但是当我这样做 `http://127.0.01/dev/blog//welcome`时，出于某种原因，它会保持这种状态。

我的 .htaccess 是

```
RewriteEngine On
RewriteBase /dev/blog
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond $1 !^(index\.php|images|robots\.txt|css)
RewriteRule ^(.*)$ index.php?/$1 [L] 
```

并且我的 config.php 已配置

```
$config['base_url'] = 'http://127.0.0.1/dev/blog/';
$config['index_page'] = ''; 
```

哦，我确实检查了 mod_rewrite 是否打开并且我正在使用 WAMP

另一个信息：我正在使用 Firefox，但是当我使用 IE(9) 时，它不会将 url 从更改 `http://127.0.0.1/dev/blog/welcome`为`http://127.0.0.1/dev/blog/index.php/welcome`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:59:46.473

对于您的`RewriteRule`，添加 NC 和 QSA 标志。QSA 确保附加查询字符串。除非您计划在 CodeIgniter 上管理您的 css 文件、图像和 robots.txt，否则也请忽略倒数第二行。

试试这个：

```
RewriteEngine On
RewriteBase /dev/blog/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [NC,L,QSA] 
```

另外，请检查您`uri_protocol`的 config.php。我遇到了一些 WAMP 无法正确检测到它的问题，并且最幸运的是将它设置为`PATH_INFO`而不是`AUTO`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-16T16:04:23.983

您是否已在 apache 配置中设置[`AcceptPathInfo`](http://httpd.apache.org/docs/2.2/mod/core.html#AcceptPathInfo)为？`ON`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T14:12:45.950

确保您在 webroot 目录而不是应用程序目录上编辑文件。我一直在努力让它正常工作，直到我最终认为这是我的问题

# javascript - 如何防止双击使用 JavaScript 突出显示网页文本？

> ID：10342965
> 
> 赞同：3
> 
> 时间：2012-04-26T23:47:43.387
> 
> 标签：javascript

在我的 HTML 页面上有一个带有一些文本的元素。我指定了在单击该元素时发生的操作。当用户连续多次点击元素时，有时会出现双击，导致文本被选中（高亮），从而破坏外观。我试图使用一个虚拟事件处理程序来阻止它，该处理程序可以防止双击 (dblclick) 事件的默认行为。但是，这似乎不起作用。似乎在我的虚拟事件处理程序甚至执行之前选择并突出显示了文本。

```
function doNothing(event) {
  alert('doNothing'); // Added for debugging. The alert is shown, meaning the event handler is invoked. When I get the alert, the text is already highlighted.
  if(!event) event = window.event;
  if(event.preventDefault) event.preventDefault();
  event.cancelBubble = true;
  if(event.stopPropagation) event.stopPropagation();
  return false;
}

myElem.onlick = doSomething; // This is the event for a single click. Works well.
myElem.ondblclick = doNothing; // The event handler is called, but the text is already highlighted. 
```

具体问题：

1）我所追求的与双击事件有什么关系吗？（当我看到触发警报时文本已经突出显示，我怀疑这可能是另一种机制。我怀疑（单击）事件的默认行为可能与它有关，但我取消了默认行为（单击）事件也是如此。）

2）如果它与 dblclick 事件无关，那么它与什么有关？我该如何预防？

3）如果是关于 dblclick 事件，我做错了吗？（顺便说一句，我想使用所有`preventDefault()`and`cancelBubble = true`和`stopPropagation()`and`return false`是一种矫枉过正。为了防止默认行为，我需要的最少代码是多少？）

4）任何其他想法如何获得所需的结果（双击不选择并突出显示文本）？

我正在使用 FF 11 进行测试（但最终需要一个跨浏览器的解决方案）。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T23:54:13.473

```
myElem.onmousedown = function(e) {
    e.preventDefault()
} 
```

编辑：将其从 return fasle 更改为 e.preventDefault，这仍将允许触发 click 事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-12-05T10:49:56.157

有同样的问题，我马上在*dblclick处理程序中添加了**event.preventDefault()*并没有帮助。我没有考虑的是事件冒泡以及默认行为在子元素中触发之前在父元素中触发的事实。

 *如果有多个孩子的父母，您仍然需要在其中选择文本，但不希望在双击时进行选择，有 2 个选项：

1.  清除父事件处理程序中的选择，例如： *window.getSelection().empty()*。这种方法的问题是您会注意到所选文本的闪烁，并且在 Opera 中会有一个弹出窗口（“复制”、“搜索”）。
2.  遍历所有孩子并在他们的*dblclick中调用**e.PreventDefault()*。*

# java - 如何初始化SortedMap？

> ID：10342968
> 
> 赞同：0
> 
> 时间：2012-04-26T23:47:56.113
> 
> 标签：java

如何初始化 SortedMap？我真正需要的是一系列字符串，这些字符串保持它们添加到系列中的顺序。我假设 SortedMap 甚至是最好的解决方案。但是，每次我尝试设置`cssFiles`一个实例，`Map()`否则`SortedMap()`我什么也得不到。

```
public class Controller {
    private SortedMap<Integer, String> cssFiles;
    private SortedMap<Integer, String> jsFiles;

    public Controller () {
        this.addCss("global.css");
        this.addJs("global.js");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T23:51:13.997

排序集合不用于维护插入顺序，当您想要使用与项目内容相关的一些排序属性来检索项目时使用它们。

如果要按插入顺序检索项目，请使用 ArrayList、Vector 或其中一个队列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T23:51:00.827

> 我真正需要的是一系列字符串，这些字符串保持它们添加到系列中的顺序

似乎您需要一个[列表](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)（如果您不遇到并发问题，则需要[ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)或[LinkedList ）。](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedList.html)

从javadoc：

> 有序集合（也称为序列）。

# security - TFS：是否可以从版本控制中删除项目权限对象？

> ID：10342970
> 
> 赞同：0
> 
> 时间：2012-04-26T23:48:13.913
> 
> 标签：security, tfs, permissions, acl

使用 TFS 对象模型时，可以使用 VersionControlServer.SetPermissions 方法设置项级 ACL。此方法采用 PermissionChange 继承的 SecurityChange 对象数组。PermissionChange 类为 Allow 权限、Deny 权限和 Removes 获取字符串数组（以便将某个权限重置为未设置）。然后可以使用 VersionControlServer.GetPermissions 方法查看这些项目级权限。

当使用 VersionControlServer.SetPermissions 方法设置项目级权限时，将创建一个新的权限对象，并将 ServerItem 设置为该项目的服务器路径。权限对象有一个 Entries 属性，该属性包含在源代码管理中的项目上方定义的每个用户或组的条目，即使该用户或组的所有权限都是继承的。此外，即使重置之前在项目上设置的权限，权限对象仍保留在服务器上，即使它不包含未继承的条目。

简而言之，随着时间的推移，这些权限对象的大小似乎在严格增加。由于返回了大量信息（例如，在分支级别），这些方法的性能开始受到影响，而且我不知道有任何类型的 RemovePermissions 方法可以清理这些信息。这样的事情存在吗？我怎样才能永久删除这些，以便项目只是透明地继承它们的 ACL，而没有在服务器上定义这些杂乱的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T20:33:20.950

2010 年，TFS 推出了一项新的安全服务，用于管理产品中的所有权限。每个权限组被分解为一个安全命名空间。您可以使用公开此功能的新服务来实现您想要的。我没有在下面测试过这段代码，但它应该能让你接近。

首先，添加这些引用：

```
using Microsoft.TeamFoundation.Client;
using Microsoft.TeamFoundation.Framework.Client;
using Microsoft.TeamFoundation.VersionControl.Common; 
```

然后运行这段代码：

```
// Somehow define which paths you want to delete security on.
string[] pathsToDeleteSecurityOn = new string[0];

TfsTeamProjectCollection tpc = new TfsTeamProjectCollection(new Uri("http://your-server:8080/tfs/your-collection"));
ISecurityService securityService = tpc.GetService<ISecurityService>();

// Get the version control security namespace
SecurityNamespace vcSecurity = securityService.GetSecurityNamespace(SecurityConstants.RepositorySecurityNamespaceGuid);

// Delete the ACLs on each path
foreach (string path in pathsToDeleteSecurityOn)
{
    vcSecurity.RemoveAccessControlLists(path, false);
} 
```

如果您遇到任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-27T09:35:49.377

看起来你想做的事情是不可能的。最好的方法是联系[Buck Hodges](http://blogs.msdn.com/b/buckh/)并直接询问他。

如果有可能，您会在[Microsoft.TeamFoundation.VersionControl.Server](http://msdn.microsoft.com/fr-fr/library/dd545177.aspx)命名空间（这是版本控制的服务器，而不是客户端）中找到答案。

查看文档后我找不到这样的功能。

# ubuntu - 在 AWS 上安装 nginx 后禁止 403（不欢迎 nginx 消息）

> ID：10342971
> 
> 赞同：2
> 
> 时间：2012-04-26T23:48:38.420
> 
> 标签：ubuntu, nginx, amazon-web-services, http-status-code-403

我在 AWS 上建立了一个基本的 ubuntu 10 微实例，并使用 apt-get 和 make 等安装了它。

nginx 正在运行，但是当我尝试访问 ip 进行测试时，它会返回 403。工作进程作为 www-data 运行。/var/www/nginx-default 拥有 755 个权限，并且也归 www-data 所有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-09T15:02:43.353

我通过调整 /etc/nginx/sites-available/default 找到了解决方案，这是默认服务器配置所在的位置。我将它剥离到几乎没有，然后意识到根路径并没有指向我认为的位置。

```
server {
    listen 80;
    location / {
            root   /var/www;
    } 
```

变成

```
server {
    listen 80;
    location / {
            root   /var/www/nginx-default;
    } 
```

安装期间创建的 nginx-default 目录误导了我。

也许真正的解决方案是更改 /var/www 的权限，就像我对 /var/www/nginx-default 所做的那样

# c# - 实例化一个类对象并初始化一个列表

> ID：10342978
> 
> 赞同：1
> 
> 时间：2012-04-26T23:49:39.980
> 
> 标签：c#, list, object

有没有办法可以用现有项目初始化一个类中的列表？

我基本上想实例化一个类对象并初始化一个列表，其中已有一些元素来自现有项目和新项目。

```
public class Item
{
    public string Property {get; set;}
}

public class MyClass
{
    public virtual IEnumerable<Item> Items {get; set;}
}

var itemToAdd = context.Items( i => i.Property == "Desired" );

MyClass myclass = new MyClass()
{
    Items = new List<Item>() 
    {
        new List<Item> (),
        { 
            Property = "New" 
        },
        // Would like itemToAdd to be added here when I create a new List.
    }
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T00:02:38.860

您可以通过将集合传递给构造函数来使用数据初始化列表。例如

```
var itemToAdd = context.Items( i => i.Property == "Desired" );

MyClass myclass = new MyClass()
{
    Items = new List<Item>(itemToAdd) // You can pass any collection of IEnumerable here.
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T23:53:33.657

```
var itemToAdd = context.Items( i => i.Property == "Desired" );  

MyClass myclass = new MyClass() 
{     
    Items = new List<Item>(itemToAdd)  // <--####  Here    
    {         
       new List<Item> () 
       {              
           Property = "New"          
       }
    } 
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T23:51:39.713

当然，您只需将`Add`方法和 IEnumerable 添加到您的类

```
class InitEx<T> : IEnumerable<T>
{
  List<T> _data = new List<T>();

  public IEnumerator<T> GetEnumerator()
  {
    return _data.GetEnumerator();
  }

  System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
  {
    return _data.GetEnumerator();
  }

  public void Add(T i)
  {
    _data.Add(i);
  }
} 
```

示例使用

```
var ie = new InitEx<int> { 1, 2, 3 }; 
```

# eclipse - 将 Eclipse 与 AVRDude 一起使用

> ID：10342982
> 
> 赞同：0
> 
> 时间：2012-04-26T23:49:56.973
> 
> 标签：eclipse, arduino, atmel, avrdude

我正在尝试通过 Eclipse 对我的 Arduino 进行编程（因为 Eclipse 是初学者最简单的 IDE），但显然，当我在 Eclipse 中为 AVRDude 更新我的程序员时，它显示找不到配置文件。此外，它还说它不支持我试图与之通信的任何 MCU ......甚至更奇怪。有解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T14:34:15.193

我会礼貌地不同意 Eclipse 对初学者来说最简单的说法。对于有经验的程序员来说，这是一个很棒的 IDE，但是对于学习特定环境的人来说，开始使用 Eclipse 任何语言/开发环境总是有问题的。

因此，我建议学习如何配置 Arduino 开发环境的解决方法是使用为初学者（和有经验的用户）设计的[官方 Arduinio IDE 。](http://arduino.cc/en/Main/Software)它可以让您在任何平台上几乎立即开箱即用。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2015-02-16T13:08:58.230

Eclipse 的问题是日常事务:)。在 AVRdude 配置选项卡中添加 -C /etc/avrdude.conf 后，MCU 可用。

# php - finfo_* 函数

> ID：10342984
> 
> 赞同：2
> 
> 时间：2012-04-26T23:50:06.967
> 
> 标签：php

这些`finfo_*`函数返回有关文件的信息；最有趣的功能是

```
string finfo_file(resource $finfo, string $file_name = NULL [, int $options = FILEINFO_NONE [, resource $context = NULL ]]) 
```

第一个参数是一个*资源*，它只是你想要返回的关于文件的信息；就我而言，我想要`FILEINFO_MIME_TYPE`，所以我使用以下`finfo_open()`功能：

```
resource finfo_open([int $options = FILEINFO_NONE [, string $magic_file = NULL ]]) 
```

最后得到

```
$a = finfo_open(FILEINFO_MIME_TYPE)
echo finfo_file($a,$fileatt['tmp_name']); 
```

获取我上传文件的 mime 类型，一切正常

但是，有两个问题：

*   的第三个（可选）参数`finfo_file`是`int $options = FILEINFO_NONE`，但这与 的第一个选项相同`finfo_open`；既然它是的第一个参数中*资源*`finfo_file`的一部分，为什么它也是`int`同一函数中的可选 () 参数？

*   其次，术语*资源*和函数名称`finfo_open`似乎相当混乱；在`mysql_*`函数中，*资源*是查询的结果，我可以理解为一个相当复杂的对象；然而，这里的*资源*只是一个字符串，那么为什么 PHP 让它看起来比看起来更复杂呢？类似地，通常在任何地方正在操作文件并且需要使用的功能之一在其名称中带有*open*一词最初（对我来说，无论如何）暗示这是打开/启动文件流的功能，而在这里它用于指定您想要从文件中获取的信息。这些术语在这里有什么奇怪的历史原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T01:16:14.807

> 术语资源和函数名称 finfo_open 似乎相当混乱；在 mysql_* 函数中，资源是查询的结果，我可以理解为一个相当复杂的对象；但是，这里的资源只是一个字符串

不，结果`finfo_open`是*资源*。资源可以是任何东西，通常是外部程序的标识符。对于 MySQL，MySQL 资源是由较低级别的 mysql 客户端库打开的连接的标识符。MySQL 结果资源是通过特定连接打开的结果的标识符。

在 的情况下`finfo_open`，将打开一个“魔术文件”。这个魔法文件包含 MIME 类型信息。您可以指定一个特定的魔术文件用作第二个参数`finfo_open`：

```
resource finfo_open([int $options = FILEINFO_NONE [, string $magic_file = NULL ]]) 
```

所以这里的外部资源就是打开的魔法文件的文件句柄。如果您正在执行多个 finfo 查询，您希望保持此文件处于打开状态，因此已将其抽象为一个资源。

> 的第三个（可选）参数`finfo_file`是`int $options = FILEINFO_NONE`，但这与第一个选项相同`finfo_open`

这确实是一个好问题，我不知道这背后的想法是什么。也许如果您一遍又一遍地执行相同类型的 finfo 查询，您可以将其指定为参数一次`finfo_open`，而不是每次调用`finfo_file`.

# php - 底部固定 div 的 JQuery 切换将所有 div 向上移动

> ID：10342993
> 
> 赞同：2
> 
> 时间：2012-04-26T23:51:25.713
> 
> 标签：php, jquery, html, css, node.js

我正在使用 node JS，我们建立了一个完美的聊天，现在我们正在转向它的 CSS 部分。

现在我遇到的问题是，当我们有多个选项卡时，我们只单击一个，所有选项卡都会向上移动。

***这可以在下面的图片中查看。***红色区域是`div`选项卡所在的区域，显示它们应该能够使用 CSS 向下移动

![](../Images/695ced7d3a7c2cdbfafcc6ee2dce3356.png) 前

![](../Images/5ece5aea2a89f4245c70e3fa6043686d.png) 单击 1 个选项卡后

![](../Images/a1b903f6fe569765f51bd0352c17755b.png) 再次单击选项卡以向您显示我的 jQuery 部分是正确的

**这是位于页面底部的固定 div**

下面的代码针对每个选项卡重复，但具有不同的 id 、`tramsTalk`、`Calvin`，`srcc-test`如图所示。

```
<div style="position:fixed;bottom:0;right:26px;background-color:red;">
    <div id="tramsTalk_chat" style="background-color:white;position:relative;bottom:0px;width:275px;float:right">
        <div id="tramsTalk_chat_header" class="chat_header"><p><i class="icon-chevron-up icon-white pull-right"></i>tramsTalk</p></div>
        <div class="overflow_chat" id="tramsTalk_chat_textarea"><hr style="margin-top:-8px;margin-bottom:1px;"></div>
        <div class="chat_textarea_holder" id="tramsTalk_msg_textarea_holder"><textarea class="chat_box" rows="3" id="tramsTalk_msg" ignoreesc="true" name="tramsTalk_chat_message" onkeyup="check(this,event);" style="resize: none; overflow-y: hidden; "></textarea></div>
    </div>
</div> 
```

我认为这会起作用，并且它仍然将标签保留在顶部。

只是重申一下：

jQuery 工作正常，我们切换但向上移动仍应固定在底部的选项卡。（我可以点击它们，然后他们会拉下他们的文本框）。我认为 CSS 是问题所在，我不确定。

**解决方案**

```
<style>
.wrappers > div {
   margin-top: 275px;
}

.active {
    height: 300px;
    background-color: white;
    margin-top: 0 !important;
}
</style>

<script type="text/javascript">
$(document).ready(function(){
$('#Calvin_chat').click(function(){
   alert('test');
   $(this).attr('class','active');
});});
</script> 
```

奇迹般有效！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T01:05:11.053

尽管您声明“以下代码针对每个选项卡重复但具有不同的 ID”并给出：

```
<div style="position:fixed;bottom:0;right:26px;background-color:red;">
    <div id="tramsTalk_chat" style="background-color:white;position:relative;bottom:0px;width:275px;float:right">
        <div id="tramsTalk_chat_header" class="chat_header"><p><i class="icon-chevron-up icon-white pull-right"></i>tramsTalk</p></div>
        <div class="overflow_chat" id="tramsTalk_chat_textarea"><hr style="margin-top:-8px;margin-bottom:1px;"></div>
        <div class="chat_textarea_holder" id="tramsTalk_msg_textarea_holder"><textarea class="chat_box" rows="3" id="tramsTalk_msg" ignoreesc="true" name="tramsTalk_chat_message" onkeyup="check(this,event);" style="resize: none; overflow-y: hidden; "></textarea></div>
    </div>
</div> 
```

**我的猜测是，根据我从您的图像中看到的以及您所说的行为**，您确实拥有这个（为了说明，我已经消除了胆量）：

```
<div style="position:fixed;bottom:0;right:26px;background-color:red;">
    <div id="tramsTalk_chat" style="background-color:white;position:relative;bottom:0px;width:275px;float:right">
    </div>
    <div id="sccr_test_chat" style="background-color:white;position:relative;bottom:0px;width:275px;float:right">
    </div>
    <div id="Calvin_chat" style="background-color:white;position:relative;bottom:0px;width:275px;float:right">
    </div>
</div> 
```

也就是说，`fixed`定位的 div 不会对每个重复，而是实际上将它们全部包裹起来。如果是这样，那么您遇到的行为就是我所期望的，因为一旦放大一个选项卡，固定 div 的高度就会扩展，所有标题都会随之上升。[你从这样的东西开始](http://jsfiddle.net/nKg5S/1/)（为了说明的目的，我缩小了宽度）。您单击并扩展一个的高度并[得到类似这样的东西](http://jsfiddle.net/nKg5S/4/)。可能解决它的一种方法是`em`在 div 上设置单位高度，同样设置扩展大小，以便您可以`margin-top` [像这样](http://jsfiddle.net/nKg5S/16/)进行控制。

我在这里假设您的`fixed`div 不会真正具有红色背景，但实际上将是透明的（红色是为了说明）。如果不是这样，那么您需要将每个元素单独设置为一个`fixed`位置，但是您将无法使用`float`它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T02:28:07.410

我认为您不需要调整控股 div 中任何子选项卡上的位置，因为它们的位置可以由控股 div 的位置决定。（或者至少`vertical-align: bottom`在每个子选项卡上放一个/窗口/聊天框）

所以你会有类似的东西：

```
<div style="position: fixed; bottom: 0; right: 26px; background-color:red">
    <div id="tramsTalk_chat" style="vertical-align: bottom">
    </div>
    <div id="sccr_test_chat" style="vertical-align: bottom">
    </div>
    <div id="Calvin_chat" style="vertical-align: bottom">
    </div>
</div> 
```

# google-maps-api-3 - Google maps-api v3 InfoWindow 在页面加载时自动打开

> ID：10342994
> 
> 赞同：23
> 
> 时间：2012-04-26T23:51:27.597
> 
> 标签：google-maps-api-3

我正在开发一个使用 Google Maps api-v3 的项目，在地图上会有一些地方标记，其中包含我存储在 InfoWindow 中的信息。

我想知道您是否可以将 InfoWindow 设置为在页面加载时自动打开（即在没有用户交互的情况下自动打开）。

在网上搜索，我似乎发现它需要绑定到一个事件侦听器，但 InfoWindow 对象似乎拥有的所有事件都是鼠标事件。

有谁知道某种解决方法？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-27T00:38:10.737

不确定我是否完全理解您的问题，但这适用于我使用硬编码的 LatLng：

```
var infoWindow = null;
function initialize() 
{
    infoWindow = new google.maps.InfoWindow();
    var windowLatLng = new google.maps.LatLng(43.25,-68.03);
    infoWindow.setOptions({
        content: "<div>This is the html content.</div>",
        position: windowLatLng,
    });
    infoWindow.open(map); 
} // end initialize

google.setOnLoadCallback(initialize); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-09T21:21:49.600

这个问题我很晚了，但我想分享一些东西。我也搜索了它的解决方案，甚至没有从上述解决方案中得到工作。然后我尝试了自己并得到了自己的解决方案（我不是专家，我的想法可能不好但对我来说很好）。我们通常喜欢

```
var infowindow = new google.maps.InfoWindow();
google.maps.event.addListener(marker, 'click', (function(marker) {
return function() {
    infowindow.setContent('some content here');
      infowindow.open(map, marker);
    }
})(marker)); 
```

将上面的行替换为：

```
var infowindow = new google.maps.InfoWindow();
infowindow.setContent('some content here');
infowindow.open(map, marker); 
```

不要等待标记的点击事件，只需设置内容并打开它（您必须定义地图和标记以及信息窗口指向您的标记）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-26T15:46:23.463

只需使用 infowindow.open(map,marker); 离开 google.maps.event.addListener。它应该如下所示：

```
 var marker = new google.maps.Marker({
      position: myLatlng1,
      map: map,
      title: 'Uluru (Ayers Rock)'

  });

  infowindow.open(map,marker);

  google.maps.event.addListener(marker, 'click', function() {
  }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-09T09:46:57.437

这是我的代码，它使用地图和鼠标悬停加载信息窗口。

```
map.setCenter(results[0].geometry.location);
var marker = new google.maps.Marker({
    map: map,
    icon: "/images/map-marker.png",
    draggable: true,
    position: results[0].geometry.location

});
var infowindow = new google.maps.InfoWindow({
    content: "Use pin to point your exact locality"
});
google.maps.event.addListener(marker, 'mouseover', function () {
    infowindow.open(map, marker);
});
infowindow.open(map, marker); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-16T06:46:22.190

```
function initMap() {
    var cairo = {lat:18.519331, lng: 73.849421};
    var map = new google.maps.Map(document.getElementById('map'), {
        scaleControl: true,
        center: cairo,
        zoom: 15,
    });

    var infowindow = new google.maps.InfoWindow;
    infowindow.setContent('<b>adddress</b>');

    var marker = new google.maps.Marker({map: map, position: cairo});
    infowindow.open(map, marker);
    infoWindow.open(map); 
}
```

```
<script async defer 
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCrCByzXY6y5KMSOi9AuqWVf4VYZPyJ5SE&language=hi&region=EG&callback=initMap">
</script>
<div id="map"></div>
```

# php - 解析错误：语法错误，第 41 行 /home/rixo/public_html/login/process.php 中的意外 T_VARIABLE

> ID：10342998
> 
> 赞同：-1
> 
> 时间：2012-04-26T23:52:05.727
> 
> 标签：php, syntax

我是 php 新手。我一直有这个错误 - 解析错误：语法错误，第 41 行 /home/rixo/public_html/login/process.php 中的意外 T_VARIABLE

这是完整的代码 - [http://pastebin.com/8Yqmk0MX](http://pastebin.com/8Yqmk0MX)

如果你能帮我看一下，看看有什么问题，那将是一个很大的帮助。

-先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T23:57:18.943

这是由于这条线上的未封闭报价

```
$checkuser = mysql_query('SELECT username FROM user WHERE username='$user'); 
```

修理它

```
$checkuser = mysql_query("SELECT username FROM user WHERE username='$user'"); 
```

* * *

**更新：**

在粘贴的第 61 行发现另一个查询错误。有不匹配的引号

```
$write = “INSERT INTO user (username, password, email) VALUES ('$user', '$pwd', '$mail’)'; 
```

修复它们

```
$write = "INSERT INTO user (username, password, email) VALUES ('$user', '$pwd', '$mail')"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T23:57:40.187

更改此行

```
if (isset($_POST["save"]) && $_POST["user"] && $_POST["pwd"] && $_POST["mail"]) 
```

至

```
if ((isset($_POST["save"]) && $_POST["user"] && $_POST["pwd"] && $_POST["mail"])) 
```