# StackOverflow 问答 10918000-10918999

# python - INSTALLED_APPS 中的猴子补丁形式

> ID：10918002
> 
> 赞同：1
> 
> 时间：2012-06-06T16:10:03.863
> 
> 标签：python, django, django-forms, monkeypatching

我有一个`INSTALLED_APPS`需要猴子修补的应用程序。问题是我没有从这个应用程序（`django-allauth`）中明确导入模块。

当 Django 导入应用程序并对其内部表单之一进行猴子补丁时，有什么方法可以获得一些访问权限？

在我的情况下是`socialaccount.forms.DisconnectForm.clean = smth`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T10:21:18.020

这里的解决方案是将包复制到我的应用程序文件夹并在本地修补它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-06T16:24:31.543

导入ipdb；ipdb.set_trace() 在模块的 __init__ 中。并写下字符“w”以查看跟踪

# sql-server - 自动为 SSMS 中的鼠标点击生成脚本？

> ID：10918006
> 
> 赞同：0
> 
> 时间：2012-06-06T16:10:18.393
> 
> 标签：sql-server, sql-server-2008, macros, ssms

我们可以通过 SQL 命令或在 SQL Server Management Studio (Express) 2008 中使用鼠标/键盘简单地单击选项/命令来创建（更新、填充）表等。

有没有办法可以记录我用鼠标执行时发生的所有命令？

SSMS 中有宏录制功能吗？

是否有 3rd 方插件支持 SSMS 中的宏录制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:17:28.013

不，SSMS 中没有内置任何内容来记录击键/鼠标点击。[不过，有很多 3rd 方程序可用](http://www.google.com/webhp?sourceid=chrome-instant&ie=UTF-8&ion=1&nord=1#hl=en&nord=1&output=search&sclient=psy-ab&q=keypress%20macro%20recorder)。

您应该做的是使用 T-SQL 或 DDL 编写您想要运行的命令。这些非常容易保存到文件、存储在源代码管理中、查看、稍后再次运行等。

在较新版本的 SSMS 中，您通过对话框执行的几乎所有任务都能够编写出您将要执行的更改的脚本（或者只生成一个脚本而不是单击确定）：

![在此处输入图像描述](../Images/edf8b004ba18d939fbd21d7750e945b1.png)

**编辑**您在评论中提出的用例，您可以在其中创建表、添加约束、添加一些虚拟数据。您可以执行以下操作来生成稍后可以使用的脚本：

1.  打开对象资源管理器
2.  右键单击您的数据库并选择任务 > 生成脚本
3.  点击下一步，点击下一步
4.  在“选择脚本选项”页面上，向下滚动并将“脚本数据”设置为 True
5.  点击下一步
6.  检查表并单击下一步
7.  检查您想要的表，然后单击下一步
8.  选择是否将脚本写入文件、剪贴板或新的查询编辑器窗口。

你最终会得到这样的东西：

```
USE [your_database]
GO
/**** set options, object name, script date, etc ****/
CREATE TABLE [dbo].[foo](
  bar INT,
  blat INT,
  CONSTRAINT PK_foo PRIMARY KEY CLUSTERED(bar ASC)
) -- with/on etc.
GO
INSERT [dbo].[foo]([bar],[blat]) VALUES(1,2);
INSERT [dbo].[foo]([bar],[blat]) VALUES(3,4);
GO
ALTER TABLE [dbo].[foo] WITH NOCHECK ADD CONSTRAINT [chk_blat]
  CHECK ((blat > bar))
GO
ALTER TABLE [dbo].[foo] CHECK CONSTRAINT [chk_blat]
GO 
```

我知道这比您想要的要多，但 Management Studio 的工作不是保存您执行的每个命令并将其存储在某个位置以便您以后可以检索它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T05:11:11.623

这里有两个可能会有所帮助的选项。

SSMS 工具包有一个查询历史： [http ://www.ssmstoolspack.com/Images/Features/QEH1.png](http://www.ssmstoolspack.com/Images/Features/QEH1.png)

我认为这将按您的预期工作，因为您与 GUI 的交互将转换为 T-SQL 命令，应该由该工具记录。

你可以在这里下载： [http ://www.ssmstoolspack.com/Features](http://www.ssmstoolspack.com/Features)

如果您开始熟悉实际命令，您可以使用 SQL Tab Magic，它会自动保存您的 SSMS 查询窗口以供将来检索： [http ://www.red-gate.com/products/sql-development/sql-prompt/ entrypage/sqltabmagic](http://www.red-gate.com/products/sql-development/sql-prompt/entrypage/sqltabmagic)

# signals - localtime_r() 是否有信号安全的替代方案？

> ID：10918007
> 
> 赞同：1
> 
> 时间：2012-06-06T16:10:32.060
> 
> 标签：signals, localtime

我们有一些代码来爬取堆栈，当我们这样做时能够转储当前时间非常方便。不幸的是，虽然该`localtime_r()`函数是可重入的，但它不是信号安全的，我们看到它在某些平台上调用内部 pthread 互斥函数：

```
0: c000000000436b90 : __ksleep() + 0x30 (/usr/lib/hpux64/libc.so.1)
1: c000000000152060 : __spin_lock_spin() + 0x1b0 (/usr/lib/hpux64/libpthread.so.1)
2: c0000000001d3da0 : __pth_bound() + 0x160 (/usr/lib/hpux64/libpthread.so.1)
3: c0000000001d9080 : __mxn_wakeup() + 0x140 (/usr/lib/hpux64/libpthread.so.1)
4: c0000000001429a0 : __pthread_mutex_unlock_ng() + 0x940 (/usr/lib/hpux64/libpthread.so.1)
5: c000000000142040 : pthread_mutex_unlock() + 0x20 (/usr/lib/hpux64/libpthread.so.1)
6: c000000000458370 : __thread_mutex_unlock() + 0xb0 (/usr/lib/hpux64/libc.so.1)
7: c000000000321cd0 : __localtime_r_posix() + 0x7e0 (/usr/lib/hpux64/libc.so.1) 
```

我们可以通过调用来安全地转储时间`gettimeofday()`（在后续`localtime_r()`调用中省略“漂亮的时间打印”），然后对堆栈跟踪文件进行后处理。这个想法有一些困难，如果可能的。

不需要在信号处理程序之外进行后处理，是否有任何已知的其他方法可以实现`localtime`信号安全的类似结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T03:34:32.677

我想出了一个解决这个问题的方法。为信号上下文之外的进程调用`localtime`不同的线程，并在清除小时/分钟/秒字段后缓存该值（以及`mktime`该操作的结果`struct tm`）。

只要我有一个自上次缓存值以来的 24 小时内的值，我就可以在信号处理程序中使用它，通过添加回增量的小时/分钟/秒字段来手动构造处理程序中`struct tm`的`gettimeofday`从缓存的时间点开始。

它并不完美，并且有一些棘手的方面要确保我在处理程序执行时不会读取正在更新的值，但在大多数情况下我可以避免对事后转储文件进行后处理，并且不会由于信号不安全而陷入或挂起处理程序中的函数。

# c++ - C++ - 初始化 SOCKADDR_IN

> ID：10918008
> 
> 赞同：9
> 
> 时间：2012-06-06T16:10:39.027
> 
> 标签：c++, initialization, winsock

我正在解决一些静态分析缺陷，而导致我出现问题的缺陷就是这个。

```
SOCKADDR_IN m_stLclAddr; 
```

[SOCKADDR_IN 是 WinSock API 的成员](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740496%28v=vs.85%29.aspx)

缺陷是说我没有初始化以下内容：

*   m_stLclAddr.sin_port
*   m_stLclAddr.sin_zero
*   m_stLclAddr.sin_addr
*   m_stLclAddr.sin_family

我对 WinSock API 不是很熟悉，但我做了一些研究，我只想知道以下代码行是否会使用默认值初始化 m_stLclAddr？：

```
m_stLclAddr = { 0 }; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T16:21:24.830

`m_stLclAddr = {0}`将第一次将所有内容设置为零（不一定是默认值或您实际想要做的事情）。 `memset(&m_stLclAddr, 0, sizeof(SOCKADDR_IN));`将 m_stLclAddr 中的所有内容设置为零，不仅用于初始化，还用于后续调用。

我想你会想做这样的事情：

```
local_sin.sin_family = AF_INET;
local_sin.sin_port = htons (PORTNUM);
local_sin.sin_addr.s_addr = htonl (INADDR_ANY); 
```

如此处所示：http: [//msdn.microsoft.com/en-us/library/aa454002.aspx](http://msdn.microsoft.com/en-us/library/aa454002.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T16:17:05.470

是的，使用`{0}`将初始化`m_stLclAddr`为全零

# windows - 最近安装的装有 Windows Server 2008 R2 Foundation 的计算机上缺少 c:\inetput\mailroot

> ID：10918013
> 
> 赞同：1
> 
> 时间：2012-06-06T16:11:03.597
> 
> 标签：windows, windows-server-2008

`c:\inetpub` 在那里，但不是子目录： `mailroot\`

我最近安装了一台预装了 Windows Server 2008 R2 Foundation 的新 HP 服务器计算机。

应该`\mailroot\`自动安装，还是手动安装？

向/从我托管在服务器上的 Web 应用程序发送和接收电子邮件是必需的；用 Visual Basic 2010 等编写的 Web 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:40:36.570

我有自己的 Windows Server 2008 R2 服务器，也没有 mailroot 目录。我会假设这不是一个自动安装的组件。

或许[如何：在 IIS 中安装和配置 SMTP 虚拟服务器](http://msdn.microsoft.com/en-us/library/8b83ac7t%28v=vs.80%29.aspx)会有所帮助。

# ruby-on-rails-3 - Rails 3.1 client_side_validations Gem 错误 uninitialized constant 唯一性约束错误

> ID：10918015
> 
> 赞同：2
> 
> 时间：2012-06-06T16:11:08.820
> 
> 标签：ruby-on-rails-3, client-side-validation

我有一个名为 Business 的模型，我对其进行了电子邮件唯一性验证。ajax 请求被发送到 url

```
http://localhost.com/validators/uniqueness?case_sensitive=true&business%5Bemail%5D=mabid.mah%40gmail.com 
```

但这给了我一个奇怪的错误

```
uninitialized constant Busines 
```

s 不见了，它去哪儿了？这是堆栈跟踪

```
activesupport (3.2.3) lib/active_support/inflector/methods.rb:229:in `block in constantize'
activesupport (3.2.3) lib/active_support/inflector/methods.rb:228:in `each'
activesupport (3.2.3) lib/active_support/inflector/methods.rb:228:in `constantize'
activesupport (3.2.3) lib/active_support/core_ext/string/inflections.rb:54:in `constantize'
client_side_validations (3.1.4) lib/client_side_validations/middleware.rb:59:in `is_unique?'
client_side_validations (3.1.4) lib/client_side_validations/middleware.rb:45:in `response'
client_side_validations (3.1.4) lib/client_side_validations/middleware.rb:16:in `call' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T12:57:10.777

意识到这是rails变形器的问题`classify`

分类方法不适用于像“Business”这样的单数名称

[http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-classify](http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-classify)

要解决方法，请将以下内容添加到您的`config/initializers/inflections.rb`

```
ActiveSupport::Inflector.inflections do |inflect|
  inflect.singular(/ess$/i, 'ess')
end 
```

# c# - 从 WinForms 应用程序打印

> ID：10918018
> 
> 赞同：0
> 
> 时间：2012-06-06T16:11:24.160
> 
> 标签：c#, printing

我正在制作一个 WinForms 应用程序，并设法让所有界面正常工作。我需要能够在交易结束时打印发票。发票应包含带有公司名称地址等的信头以及表格中的其他信息，例如发票编号，项目类型和价格等。

所有项目信息都需要对齐，就像在普通发票中一样。

有什么方法可以将表格上的信息导出到 Word 或 Excel 中，然后在页面上的相关位置填写信息？

直接从代码打印并确保它对齐（等）会更容易吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:17:34.940

我总是使用 Chrystal Reports、Active Reports 或 DevExpress 等可用的报告引擎之一来解决打印问题，仅举三例。对我来说，主要优势是它们通过 API 提供了相当完整的集成，并且专门用于打印。他们通常提供一个相当完整的设计师。在看起来不错的不同打印机上打印发票的完整过程很复杂。

# ruby-on-rails - Gem 问题，Database Rake 中止

> ID：10918019
> 
> 赞同：4
> 
> 时间：2012-06-06T16:11:34.393
> 
> 标签：ruby-on-rails, ruby

我正在寻找 rake 我的数据库并启动我的服务器，但是当我想要 rake 数据库时遇到以下问题：

```
/.rvm/gems/ruby-1.9.3-p194/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.bundle, 9):     Symbol not found: _ruby_current_thread 
```

和两行指定相同的问题`Symbol not found: _ruby_current_thread`：

```
Referenced from: /.rvm/gems/ruby-1.9.3-p194/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.bundle
/.rvm/gems/ruby-1.9.3-p194/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.bundle 
```

`Expected in: flat namespace`

似乎无法找到与此有关的问题，提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T14:51:57.630

ruby 1.9.3 和 ruby​​ 调试存在一些已知问题。你有两个选择。您可以使用调试器 gem，而不是使用 ruby​​-debug，它是 ruby​​ 调试的一个分支，适用于 ruby​​ 1.9.3。它的 github 页面在[这里](https://github.com/cldwalker/debugger)。

```
gem 'debugger' 
```

如果您想继续使用 ruby​​ 调试，您将需要获取预发布版本（在删除您当前使用的版本之后。）：

```
gem install ruby-debug-base19x --pre
gem install ruby-debug-ide --pre 
```

宝石文件：

```
gem 'ruby-debug-base19x', '0.11.30.pre10'
gem 'ruby-debug-ide', '0.4.17.beta9' 
```

干杯，肖恩

# seo - META标签和搜索引擎排名的顺序？

> ID：10918025
> 
> 赞同：0
> 
> 时间：2012-06-06T16:12:26.840
> 
> 标签：seo

如果我将 META 描述标签放在 META 关键字标签之后，会影响一个人在搜索引擎中的排名吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T16:15:52.680

不。不仅顺序无关紧要，而且无论如何都不会影响您的搜索引擎排名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:18:45.503

It doesn't really matter, as long as you have all the required ones there. Things like dublin core seem to be more of a good thing to include now, however there is a thread about this very subject here: [SO thread on subject](https://stackoverflow.com/questions/5572471/in-head-which-comes-first-meta-or-title)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T19:44:40.857

元标签很适合用于信息目的，但它们本身并没有太多的 SEO 权重。

如果您正在寻找 SERP 改进，您最好保留一个常规博客。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T15:53:12.033

位置没有区别。目前对 META 描述和关键字的想法是，它们在决定 SERP 排名的总方程中不再有太大的权重。即便如此，我还是小心翼翼地让它们适合我的每一页。最重要的考虑因素是 SERP 上经常使用的 META 描述，因此请确保它写得很好，平衡了 SEO 和您的营销角度。

# java - Guava/Google Collections 的向后兼容性如何？

> ID：10918027
> 
> 赞同：8
> 
> 时间：2012-06-06T16:12:34.377
> 
> 标签：java, guava

我正在开发具有多个项目的大型应用程序，它们都仍然使用 Google Collections 1.0。我想升级到 Guava 12。项目的测试覆盖率不是很好。有没有人在升级这个方面有类似的经验，有没有不兼容的地方？主要问题是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T17:02:51.090

番石榴贡献者在这里。

Guava 12 几乎完全向后兼容 Google Collections，但极少数方法已经过了规定的 18 个月弃用期并被删除；请参阅[https://code.google.com/p/guava-libraries/issues/detail?id=836](https://code.google.com/p/guava-libraries/issues/detail?id=836)。

也就是说，*没有人*应该仍然在 Google 收藏中，我们强烈建议您迁移。

# asp.net-mvc - 对象列表上的 MVC3 自定义不显眼验证器

> ID：10918028
> 
> 赞同：4
> 
> 时间：2012-06-06T16:12:34.507
> 
> 标签：asp.net-mvc, asp.net-mvc-3, validation, unobtrusive-validation

开始的基本问题：如何将自定义的、不显眼的验证器放在模型中的对象列表之上？比如，假设我的模型允许上传多个文件，因此我有一个文件列表，我希望我的验证器在每个文件上运行？

现在举一个具体的例子。我有一个自定义的、不显眼的验证器，可以检查文件扩展名是否不在禁止扩展名列表中：

```
public class FileExtensionValidatorAttribute : ValidationAttribute, IClientValidatable {

    protected static string[] PROHIBITED_EXTENSIONS = {
        // ... List of extensions I don't allow.
    };

    public override bool IsValid(object value) {
        if (value is IEnumerable<HttpPostedFileBase>) {
            foreach (var file in (IEnumerable<HttpPostedFileBase>)value) {
                var fileName = file.FileName;
                if (PROHIBITED_EXTENSIONS.Any(x => fileName.EndsWith(x))) return false;
            }
        } else {
            var file = (HttpPostedFileBase)value;
            var fileName = file.FileName;
            if (PROHIBITED_EXTENSIONS.Any(x => fileName.EndsWith(x))) return false;
        }

        return true;
    }

    public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context) {
        var modelClientVlidationRule = new ModelClientValidationRule {
            ErrorMessage = this.ErrorMessageString,
            ValidationType = "fileextension",
        };
        modelClientVlidationRule.ValidationParameters.Add("prohibitedextensions", string.Join("|", PROHIBITED_EXTENSIONS));

        yield return modelClientVlidationRule;
    }
} 
```

请注意在我的 IsValid 中，我构建它是为了接受单个文件或文件列表。

在我的模型类中，我可以在单个 HttpPostedFileBase 上使用它：

```
[FileExtensionValidator(ErrorMessage = "Invalid Extension")]
public HttpPostedFileBase Upload { get; set; } 
```

然后我在我的视图中附加到 jquery 的验证器：

```
jQuery.validator.addMethod("fileExtension", function (value, element, param) {
    var extension = "";
    var dotIndex = value.lastIndexOf('.');
    if (dotIndex != -1) extension = value.substring(dotIndex + 1).toLowerCase();

    return $.inArray(extension, param.prohibitedExtensions) === -1;
});

jQuery.validator.unobtrusive.adapters.add('fileextension', ['prohibitedextensions'], function (options) {
    options.rules['fileExtension'] = {
        prohibitedExtensions: options.params.prohibitedextensions.split('|')
    };
    options.messages['fileExtension'] = options.message;
}); 
```

这一切都很好，客户端和服务器端......但仅在单个 HttpPostedFileBase 上。问题是我需要为用户提供上传一个或多个文件的能力。如果我将模型更改为：

```
[FileExtensionValidator(ErrorMessage = "Invalid Extension")]
public List<HttpPostedFileBase> Uploads { get; set; } 
```

...客户端验证不再运行；只有服务器端有效。这在查看源代码时很明显。生成的 <input> 标记缺少运行所需的所有 data-val 属性。在进行调试时，永远不会调用 GetClientValidationRules。

我错过了什么？

这可能是因为我如何渲染它吗？我只是为 HttpPostedFileBase 使用 EditorTemplate：

```
@model System.Web.HttpPostedFileBase
@Html.TextBoxFor(m => m, new { type = "file", size = 60 }) 
```

...我的观点是这样的：

```
<p>@Html.EditorFor(m => m.Uploads)</p> 
```

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T20:00:04.120

这就是我想出的。

我实际上认为问题最终是因为 MVC 不知道我希望列表上的数据注释应用于其所有成员。我也不应该这样想。

所以我只是在 HttpPostedFileBase 周围制作了一个“viewmodel”包装器，并将我的验证器放在那里：

```
public class UploadedFile {
    [FileExtensionValidator(ErrorMessage = "Invalid Extension")]
    public HttpPostedFileBase File { get; set; }
} 
```

然后，在我的实际模型中，我现在只使用这些列表：

```
public List<UploadedFile> Uploads { get; set; } 
```

...当然这里没有更多的数据注释，因为它们现在在 UploadedFile 中。

然后，对视图和编辑器模板稍作修改以使用它们，现在可以正常工作，客户端和服务器端。（不过，对我来说感觉很笨拙。如果有人有更简单的方法，我仍然很高兴听到它。）

# javascript - 打开模式时我需要使用什么来提交表单？

> ID：10918029
> 
> 赞同：1
> 
> 时间：2012-06-06T16:12:39.950
> 
> 标签：javascript, jquery, html, css, django-forms

我正在尝试为帖子创建一个“编辑”按钮，单击该按钮将提交表单，该表单将传入帖子 ID 并调用模态（我正在使用引导模态）。打开的模式将显示传入的帖子 ID 中的内容。

但是，我想出一个既可以提交又可以调用模态（href）的标签时遇到了麻烦。我尝试了锚标签、输入标签和按钮标签的组合，但似乎都没有真正协同工作来实现目标。我会很感激任何建议。谢谢

```
<form>
<a  class="btn" data-toggle="modal" title="edit" id="editbtn" href="#myeditModal">
<input type="submit" name="edit" id="edit"></a>
</form>

----the modal div -------
<div class="modal hide" id="myeditModal"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:17:50.790

如果我正确理解了您的问题，我只需在提交按钮上使用 JQuery 单击功能，例如：

*   用户点击表单上的提交按钮
*   jQuery点击功能打开模式
*   返回真
*   表单被提交

如果您需要模态在 Ajax 发布期间保持打开状态，那么只需使用相同的单击函数序列化表单、发布、等待响应并返回 false。

**更新：**

例如：

```
$(".your-submit-button").click(function() {
    // Do something with modal box
    $("#your-modal-box").show();
    // Do ajax request
    var url = $(this).parents("form").attr("action");
    var params = $(this).parents("form").serialize(); 
    $.post(url, params, function(output) {
        // Optionally do something with the output of ajax request
    });
    return false;
}); 
```

# json - 将数据从 json 文件加载到 extjs

> ID：10918030
> 
> 赞同：4
> 
> 时间：2012-06-06T16:12:40.317
> 
> 标签：json, extjs4

我有一个 .json 文件，其内容应该由 Ext.data.Store 读取并由 Ext.grid.Panel (extjs 4) 显示。但是，没有显示数据，只有网格。代码是：

```
var user = Ext.create('Ext.data.Store', {
    storeId: 'user',
    model: 'User',
    autoLoad: 'true',
    proxy: {
        type: 'ajax',
        url : '/users.json',
        reader: {type: 'json', root: 'blah'}
    }
});

 Ext.create('Ext.grid.Panel',{
    store :user,
    id : 'user',
    title: 'Users',
    columns : [ 
        {header: 'ID',     dataIndex : 'id'}, 
        {header : 'NAME',  dataIndex : 'name'}, 
        {header : 'Email', dataIndex: 'email'}
    ],
    height :300,
    width: 400,
    renderTo:'my-portlet2'
}); 
```

我的json文件是：

```
{ blah[
  {
    "id": 1,
    "name": "Ed Spencer",
    "email": "ed@sencha.com"
  },
  {
    "id": 2,
    "name": "Abe Elias",
    "email": "abe@sencha.com"
  }
]} 
```

显示内联数据，但是当我尝试从 json 文件中读取时，它不起作用。我正在使用 firefox，而 firebug 说从我的 .js 文件加载脚本时出错。能否请你帮忙？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T14:44:40.807

非常感谢大家。现在工作正常。服务器找不到文件，因为路径不正确。经过一番试验，我终于能够通过提供正确的路径从 json 文件中获取 json 数据，例如 - “TestPortlet3-portlet/js/example.json”。最初，我只给出“/example.json”或“users.json”。将 .json 文件保存在正确的文件夹中并提供正确的路径，我能够显示 json 数据:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T12:14:45.833

尝试这个：

```
{ "blah": [
  {
    "id": 1,
    "name": "Ed Spencer",
    "email": "ed@sencha.com"
  },
  {
    "id": 2,
    "name": "Abe Elias",
    "email": "abe@sencha.com"
  }
]} 
```

# java - 如何在 JavaFX 中将数据从 WebView 传递到控制器，反之亦然

> ID：10918039
> 
> 赞同：8
> 
> 时间：2012-06-06T16:13:19.963
> 
> 标签：java, javascript, google-maps, webview, javafx

所以我找到了关于如何在桌面 JavaFX 应用程序中使用谷歌地图 API 的[教程。](http://java-buddy.blogspot.ro/2012/03/embed-google-maps-in-javafx-webview.html)

关键是我不知道如何将数据从 WebView（javascripts 变量、jsons ..）传递到控制器，反之亦然。

我想在 textinput 上创建一个文本字段，以自动搜索该地址并在那里添加一个标记（反之亦然，当我移动标记以填充输入时）。javascript 独立对我来说没问题，但我不知道如何从 JavaFX 控制器调用 javascript 函数或如何从 javascript 发回变量（经度、纬度等）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T23:58:11.100

请参阅[JavaFX WebView 教程](http://docs.oracle.com/javafx/2/webview/jfxpub-webview.htm)部分：

*   处理 JavaScript 命令
*   从 JavaScript 向上调用 JavaFX

确保在执行此操作时使用 JavaFX 2.1+，因为 JavaFX 2.0 不完全支持从 javaScript 到 JavaFX 的调用。

* * *

> 如何从 JavaFX 控制器调用 javascript 函数？

加载文档后要执行的 Java 代码：

```
webView.getEngine().executeScript("<write your javascript here>"); 
```

* * *

> 如何从javascript（经度，纬度等）发回变量？

这是一个通用通信示例，将其替换为您要执行的实际 Java 和 JavaScript 逻辑。

Java代码：

```
// Add a Java callback object to a WebEngine document once it has loaded.
webEngine.getLoadWorker().stateProperty().addListener(
  new ChangeListener<State>() {  
    @Override public void changed(ObservableValue<? extends State> ov, State oldState, State newState) {
      if (newState == State.SUCCEEDED) {
        JSObject win = (JSObject) webEngine.executeScript("window");
        win.setMember("app", new JavaApp());
      }
    }
  });
}
...
// JavaScript interface object
private class JavaApp {
  public void exit() {
    Platform.exit();
  }
} 
```

JavaScript 代码（在这种情况下嵌入在 html href 的 onclick 处理程序中）：

```
<a href="about:blank" onclick="app.exit()">Exit the Application</a> 
```

# cakephp - CakePHP 在另一个控制器中保存模型

> ID：10918042
> 
> 赞同：0
> 
> 时间：2012-06-06T16:13:25.817
> 
> 标签：cakephp

所以我刚刚在 CakePHP 中开始了一个小项目，我不确定如何最好地处理以下问题。
假设我有用户、帖子和 PostsUser。帖子用户。用户与 Posts 有一个 hasMany through 关系。
PostsUser 表示已阅读帖子的用户（它具有 userId、postId 和创建日期）。

现在，在我的帖子列表中，我希望能够单击一个链接以将帖子标记为已读，并在 PostsController 中使用“markRead”方法。

现在最后的问题是，如何在 PostController 中保存一个新的 PostsUser，我已经阅读了有关添加 $uses 和添加 PostsUser 的信息，但这似乎不起作用。

其次，这甚至是正确的做事方式吗？有一个 posts/markRead/14 url​​ 看起来不错，但我愿意改变它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T18:55:42.617

使用 Controller::uses 被认为是不好的做法。应通过关联访问关联的模型。

在 PostsController::markAsRead() 方法中，您可以使用 ClassRegistry::init('PostsUser') 获取模型的实例并从该对象调用方法。

或使用[Controller::loadModel()](http://api20.cakephp.org/class/controller#method-ControllerloadModel)。

如果只是关于链接的命名，您还可以使用 PostsUsersController::markAsRead() 并[使用路由器](http://book.cakephp.org/2.0/en/development/routing.html)将 /posts/markAsRead/:id 路由到 PostsUsersController。

# c# - 有没有办法在没有第二个属性来保存值的情况下定义私有属性的 getter/setter？

> ID：10918044
> 
> 赞同：3
> 
> 时间：2012-06-06T16:13:31.487
> 
> 标签：c#, properties

我有一个公共只读属性，它根据其他几个私有变量计算它的值。我从计算的属性中读了很多。计算中使用的变量很少改变。我目前让只读的 getter 执行计算逻辑，但是当因变量发生变化时，将新值推送到属性中对我来说更有意义。

我当前代码的一个示例：

```
public class rectangle()
{
    public rectangle(int height, int width)
    {
        _height = height;
        _width = width;
    }

    public void resize(int heightOffset, int widthOffset)
    {
        _height += heightOffset;
        _width += widthOffset;
    }

    private int _height;
    private int _width;
    public int area
    {
        get
        {
            return _height * _width;
        }
    }
} 
```

上面的代码过于简化，但很好地表达了我的意思。_height 和 _width 可以改变，但他们很少这样做。area 属性被大量读取...我估计每读取 area 属性 100,000+ 次，_height/_width 就会更改一次。

现在，如果它只是乘法，我不会担心......但实际计算很复杂，我看到很多运行时间陷入重复的多余计算中。

我知道我可以执行以下操作来修复它：

```
...

private int _height;
private int height
{
    set
    {
        _height = value;
        _area = _height * _width;
    }
}

private int _width;
private int width
{
    set
    {
        _width = value;
        _area = _height * _width;
    }
}

private int _area;
public int area
{
    get
    {
        return _area;
    }
}

... 
```

考虑到我的情况，上面的代码更有意义，但在我看来，必须有更好的方法来做到这一点。我知道，鉴于我的第一个示例，我可以摆脱属性并将计算逻辑移动到 resize() 方法......但在实际代码中，它不仅仅是影响私有值的一种方法。我不想梳理我的代码来查找每一个事件，而且这样做似乎不可维护。

第二种方法是要走的路吗？我知道它有效，但感觉有些不对劲。我认为我担心的是，将私有属性的值存储到私有变量中似乎很奇怪。这点我可能想多了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T16:17:44.487

你知道属性访问器可以有访问修饰符吗？

例如：

```
public string A
{
    internal get
    {
        // Whatever
    }
    private set
    {
        // Whatever
    }
} 
```

这也适用于自动属性：

```
public string A
{
    internal get;
    private set;
} 
```

**更新：** 好的，现在你知道访问器访问修饰符了，这个呢？

```
public class rectangle()
{
    public rectangle(int height, int width)
    {
        Height = height;
        Width = width;
    }

    public int Height { get; private set; }
    public int Width { get; private set; }
    public int Area { get; private set; }

    public void resize(int heightOffset, int widthOffset)
    {
        Height += heightOffset;
        Width += widthOffset;

        RefreshArea();
    }

    private void RefreshArea() 
    {
        Area = Height * Width;
    }
} 
```

*再见，私人领域！*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:23:23.867

只要您确保始终使用高度/宽度属性来设置 _height 和 _width，您建议的方法就可以使用。

将私有属性用于私有变量并没有错。它将更新代码移动到一个位置，以便于维护。

正如 Matías 所说，您可以使您的 height 和 width 属性具有具有不同访问修饰符的访问器，以便您可以读取，但不能写入此类之外的 height/width 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:29:01.897

您说您从代码中的许多地方修改私有字段，而不是总是通过这些字段的属性。最好的情况是，您将访问权限限制为仅调用属性，然后确保您只有几个地方调用重新计算。

但是，如果您不能或不会这样做，那么您是对的，确保每次修改您的私有字段时都必须确保您计算了相应的字段，这将是一件痛苦的事情。

您还说性能是一个问题，您希望节省调用计算例程的时间。

因此，如果您必须保留对私有字段的访问权限，也许您可​​以根据这些私有字段实际更改的时间来重新计算。像这样：

```
private int _height; 
private int height 
{ 
    set 
    { 
        _height = value; 
    } 
} 

private int _width; 
private int width 
{ 
    set 
    { 
        _width = value; 
    } 
} 

private int _area; 
// have some variables to store the values used in the calculation
private int _areaWidth;
private int _areaHeight;
public int area 
{ 
    get 
    { 
        // only do the calculation if these values have changed
        if(_areaWidth != _width || _areaHeight != _height)
        {
            _areaWidth = _width;
            _areaHeight = _height;
            _area = _width * _height;
        }
        return _area; 
    } 
} 
```

这样，您可以将计算保存在一个地方，并且只有在值发生变化时才重新计算。进行条件检查比您的实际计算成本要低。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:29:25.363

我通常这样做的一种方式是这样的：

```
class Rectangle
{
    int _height;
    public int height { get { return _height; } set { _height = value; _area = null; }}

    int _width;
    public int width { get { return _width; } set { _width = value; _area = null; } }

    int? _area;
    public int area
    {
        get
        {
            if(!_area.HasValue)
                _area = _width * _height;
            return _area.Value;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T16:34:40.010

*注意：为了便于阅读，我将使用传统的 C# 编码风格（即：类名和公共属性的大写字母）。我建议你也这样做*

解决问题的一种方法是简单地使`Rectangle`类不可变并使用`Lazy<T>`该区域来延迟计算昂贵的东西：

```
public class Rectangle
{
    private readonly Lazy<int> _area;

    public Rectangle(int height, int width)
    {
        Height = height;
        Width = width;
        _area = new Lazy<int>(() => Height * Width);
    }

    public int Height { get; private set; }

    public int Width { get; private set; }

    public int Area
    {
        get
        {
            return _area.Value;
        }
    }
} 
```

不可变类/结构的好处数不胜数。不利的一面是，每当您想“更改”`Rectangle`您必须使用的对象`new`或类似的静态成员时`Rectangle`：

```
...
public static Rectangle Widen(Rectangle rect, int widenByAmount)
{
    return new Rectangle(rect.Height, rect.Width + widenByAmount);
}
... 
```

如果您有 LinqPad，请尝试以下操作：

```
void Main()
{
    Rectangle r = new Rectangle(5, 10);
    r.Height.Dump();
    r.Width.Dump();
    r.Area.Dump();
    r.Area.Dump();
    r = Rectangle.Widen(r, 10);
    r.Area.Dump();
    r.Area.Dump();
}

// Define other methods and classes here
public class Rectangle
{
    private readonly Lazy<int> _area;

    public Rectangle(int height, int width)
    {
        Height = height;
        Width = width;
        _area = new Lazy<int>(() =>
            {
                "Calculating...".Dump();
                return Height * Width;
            });
    }

    public int Height { get; private set; }

    public int Width { get; private set; }

    public int Area
    {
        get
        {
            return _area.Value;
        }
    }

    public static Rectangle Widen(Rectangle rect, int widenByAmount)
    {
        return new Rectangle(rect.Height, rect.Width + widenByAmount);
    }
} 
```

对我来说，它吐出：

```
5
10
Calculating...
50
50
Calculating...
100
100 
```

# wpf - 如何按完整日期格式化 WPFToolkit.DataGridTextColumn？

> ID：10918045
> 
> 赞同：3
> 
> 时间：2012-06-06T16:13:34.160
> 
> 标签：wpf, datetime, sorting, datagrid, wpftoolkit

我已经搜索并尝试了许多方法来格式化出生日期列，不仅按月份和日期，而且还考虑到年份。

我不敢相信这很难做到。

我创建了几个类型转换器，它们将字符串“MM/dd/yyyy”转换为日期时间，尝试转换为没有“/”字符的字符串，然后转换为带有年份的字符串：“yyy/MM/dd” . 最后一个确实有效，但我不能使用它，因为日期必须以“MM/dd/yyyy”格式显示。

我找不到在该单列上轻松实现自定义排序（ICoparable）的方法。

我还搜索了 Stack Overflow 和其他网站，我很惊讶我找不到答案。

非常感谢您的帮助！

这是我的一些代码：

```
<dg:DataGrid Grid.Row="10" Grid.ColumnSpan="3" ItemsSource="{Binding Path=Members}"
  Visibility="{Binding Path=ShowMemberResults, Converter={StaticResource boolTovisConverter}}"
  SelectionMode="Single" SelectionUnit="FullRow"
  HorizontalAlignment="Left"
  Name="MemberGrid" AutoGenerateColumns="False" IsReadOnly="True"
  SelectedItem="{Binding Path=SelectedMemberItem}" MaxHeight="200">
  <dg:DataGrid.Columns>
    <dg:DataGridTextColumn Header="Member ID" Binding="{Binding Path=MemberID}" Width="100"/>
    <dg:DataGridTextColumn Header="First Name" Binding="{Binding Path=FirstName}" Width="100"/>
    <dg:DataGridTextColumn Header="Middle" Binding="{Binding Path=MiddleInitial}" Width="50"/>
    <dg:DataGridTextColumn Header="Last Name" Binding="{Binding Path=LastName}" Width="100"/>
    <dg:DataGridTextColumn Header="Suffix" Binding="{Binding Path=Title}" Width="50"/>
    <dg:DataGridTextColumn Header="DOB" Binding="{Binding Path=DOB, Converter={StaticResource dateConverter}}" Width="80"/>
    <dg:DataGridTextColumn Header="Relationship" Binding="{Binding Path=Relationship}" Width="100"/>
    <dg:DataGridTextColumn Header="Group Name" Binding="{Binding Path=GroupName}" Width="225"/>
    <dg:DataGridTextColumn Header="Address " Binding="{Binding Path=Addr1}" Width="180"/>
    <dg:DataGridTextColumn Header="City" Binding="{Binding Path=City}" Width="120"/>
    <dg:DataGridTextColumn Header="State" Binding="{Binding Path=State}" Width="45"/>
    <dg:DataGridTextColumn Header="Zip" Binding="{Binding Path=Zip}" Width="50"/>
    <dg:DataGridTextColumn Header="SSN" Binding="{Binding Path=SSN}" Width="100"/>
    <dg:DataGridTextColumn Header="Family Link ID" Binding="{Binding Path=FamilyLinkID}" Width="100"/>
  </dg:DataGrid.Columns>
</dg:DataGrid> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T16:15:53.490

使用[StringFormatter](http://blogs.msdn.com/b/vsdata/archive/2009/07/07/customize-format-of-datetime-string-in-wpf-and-winform-data-binding.aspx)绑定数据：

```
 <wpfToolkit:DataGridTextColumn Header="Your Header" Binding="{Binding TheDate,StringFormat={}\{0:dd/MM/yyyy hh:mm\}}" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:23:25.017

```
<TextBlock Text="{Binding MyText,StringFormat={}\{0:dd-MM-yyyy HH:mm tt\}}" /> 
```

并查看更多绑定字符串格式选项

[http://msdn.microsoft.com/en-us/library/0c899ak8.aspx](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)

# foreign-key-relationship - 如何递归地包含导航属性

> ID：10918046
> 
> 赞同：0
> 
> 时间：2012-06-06T16:13:34.197
> 
> 标签：foreign-key-relationship, navigation-properties, entity-framework-5

我有 2 个数据库，每个数据库都有一个相应的 EntityFramework DB 上下文，我正在使用 Entity Framework 5，代码优先。

我有类似于以下的表格：

```
Table     : Foo (resides in database 1)
-- Column : Id (is primary key)
-- Column : ParentId (is foreign key into Foo)
-- Column : BarId (is foreign key into Bar)

Table     : FooBar (resides in database 1)
-- Column : Id (is primary key)
-- Column : FooId (is foreign key into Foo)
-- Column : BarId

Table     : Bar (resides in database 2)
-- Column : Id (primary key) 
```

然后，我有实体`Foo`，`FooBar`in`Database1DbContext`和`Bar`in `Database2DbContext`。

`Foo`具有导航属性`Parent`（类型`Foo`）、`Children`（类型`ICollection<Foo>`）和`Bar`（类型`Bar`）。 `FooBar`具有导航属性`Foo`（类型`Foo`）和`Bar`（类型`Bar`）。

现在，我想要的是能够`.Include(foo => foo.Bar)`，这样所有的和也`Bar`被加载了。`Parent``Children``Foo`

我希望我没有太混乱。

PS：我知道设置`Bar`导航属性会出现问题，因为它位于不同的数据库中。我在一些相关答案中看到了一些建议，这些建议暗示了观点或同义词。任何也考虑到我情况的这方面的答案将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T20:56:42.370

这不可能。您不能进行跨上下文查询或跨上下文急切/延迟加载。您必须自己为所有必需的 Foo 和 FooBars 加载 Bar 实例。

# html - 在html中获取图像的字符串位置

> ID：10918047
> 
> 赞同：0
> 
> 时间：2012-06-06T16:13:35.013
> 
> 标签：html, parsing

我希望能够从此 html 中获取 src 图像。起初我在想正则表达式模式和匹配器，但我似乎不知道如何得到它。我在JAVA上操作。

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<body class="calibre">
<div class="calibre1">
<div class="s">
<p class="calibre2">
<img class="calibre3" src="0001.jpg"/>
</p>
<br id="calibre_pb_0" class="calibre4"/>
</div>
</div>
</body>
</html> 
```

字符串一个；输出：a = "src="0001.jpg""

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:20:17.687

With jQuery you can use the following to get src on click

```
$("img").click(function() {
alert($(this).attr('src'));
}); 
```

[http://jsfiddle.net/n63HE/5/](http://jsfiddle.net/n63HE/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:56:29.887

这个问题的答案其实很简单。[模式和匹配器的基本用法。](http://www.leepoint.net/notes-java/data/strings/40regular_expressions/26pattern-matcher.html)

这是我如何获得字符串“src="0001.jpg"”的示例代码。

```
 Pattern p = Pattern.compile("src=(.*?)/");
        Matcher m = p.matcher(html);
        if(m.find()){
            String item_found = m.group();
            Log.i("Image Found!", item_found);
        } 
```

我想再次为忘记我使用的编程语言道歉，是的，除非你需要，否则永远不要用正则表达式解析 html。我只是想在 html 中找到一个特定的项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T16:17:59.780

查看解决方案以获取更通用的问题，尝试调整 for 循环以查找您特别需要的内容： [How to get all Images src's of some html](https://stackoverflow.com/questions/10538737/how-to-get-all-images-srcs-of-some-html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:15:41.023

`src`使用 HTML 解析器或浏览器的文档对象模型并从“”中的 Attribute 接口获取值`<img class="calibre3" src="0001.jpg"/>`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T16:17:19.620

您可以使用 jquery/javascript 来获取 img 的 src。我你想做这样的事情然后给我回复

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-06T16:18:00.930

为什么不使用 Javascript `getElementsByTagName()`？

# mysql - 在多对多关系中仅获取项目链接一次

> ID：10918048
> 
> 赞同：2
> 
> 时间：2012-06-06T16:13:41.283
> 
> 标签：mysql

我正在使用 MySQL 中的多对多关系，如下面的简化示例所示。我想做的是给定一个类别 ID，找到该类别中的对象，并且只找到该类别。

我可以轻松获取一个类别中的所有对象：

```
SELECT * from object INNER JOIN link ON object.objectID = link.objectID WHERE link.categoryID=1; 
```

这给了我object1和object2，但是我想要的只是object1，因为object2也在category2中。

我唯一能想到的就是使用它作为子查询来获取这些对象 id 的所有链接，然后获取计数为 1 的链接。

我希望有一个更简单，更有效的方法！

```
-- Table: object
+---------+-----------+
| id      | name      |
+---------+-----------+
|       1 | object1   |
|       2 | object2   |
+---------+-----------+

-- Table: category
+------+-----------+
| id   | name      |
+------+-----------+
|    1 | category1 |
|    2 | category2 |
+------+---------+

-- Table: link
+-----------+-------------+
| objectid  | categoryid  |
+-----------+-------------+
|    1      | 1           |
|    2      | 1           |
|    2      | 2           |
+-----------+-------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:15:01.680

您可以`link`按对象对表进行分组，并仅筛选包含一条记录的组：

```
SELECT objectid FROM link GROUP BY objectid HAVING COUNT(*) = 1 AND categoryid = 1 
```

# android - c undefined reference to function - 编译android/linux内核

> ID：10918052
> 
> 赞同：1
> 
> 时间：2012-06-06T16:13:56.723
> 
> 标签：android, c, compiler-construction, linux-kernel

我正在编译在[OMAPZoom.org](http://omapzoom.org/)上找到的 Android 2.6.35 内核，我被我认为是一个愚蠢的 Makefile 问题所困扰。

```
make ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabi- uImage 
```

产生以下错误（加上更多相关错误）：

```
drivers/built-in.o: In function `dsscomp_createcomp':
drivers/video/omap2/dsscomp/device.c:175: undefined reference to `tiler_set_buf_state' 
```

drivers/video/omap2/dsscomp/device.c 具有以下#include 指令：

```
#include <mach/tiler.h> 
```

我相信它引用了以下包含原型的文件：

```
arch/arm/mach-omap2/include/mach/tiler.h 
```

反过来，tiler_set_buf_state 定义在：

```
drivers/media/video/tiler/tiler.c 
```

该功能正在正确使用，包含标题。这让我认为定义没有被编译。这个项目正在使用一个相当大的递归 Makefile 设置。

我不确定我还能在这里放什么有用的东西，但是如果有什么有用的东西可以问我。我希望有人可以推动我朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:43:00.093

驱动程序/媒体/视频/tiler/Kconfig 说什么？你确定所有的 CFLAGS 都设置正确了吗？我已经为 omap4 平台构建了一个 android，并且必须在我的 makefile 中传递这个变量：“TARGET_BOARD_PLATFORM=omap4”。我还没有确切地追踪到它的去向。（我的系统也有一个复杂的 Makefile）。但是您可能应该确保在您的 makefile 中某处正确设置了 ARCH_OMAP4。

在我的系统上，Kconfig 有：

```
config TILER_OMAP
    tristate "OMAP TILER support"
    default y
    depends on ARCH_OMAP4
help
       TILER driver for OMAP based boards.

config DUCATI_BUFFER_PROTECTION
    tristate "OMAP DUCATI input buffer protection"
    default y
    depends on TILER_OMAP
help
       Reserve 8MB memory for input buffer protection 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:03:28.697

好吧，这很尴尬：

该存储库中有两个（相关）分支：

```
p-android-omap-2.6.35
p-android-omap3-2.6.35 
```

第一个不适用于 OMAP3，或者至少不适用于 Zoom3（android_zoom3_defoncifg 的板配置）。

要为 Zoom3 构建内核，您必须使用第二个 (p-android-omap3-2.6.35) 分支，否则您会遇到大量构建错误。浪费了一天的大部分时间从第一个分支重写“损坏的”代码，认为这是不正确的，因为我使用的是旧板。在正确的分支上进行了结帐，并且它没有任何错误地构建。

对不起。希望这对其他人有帮助！

# ruby-on-rails - 在 API 中设计 RegistrationsController 创建操作

> ID：10918053
> 
> 赞同：3
> 
> 时间：2012-06-06T16:14:01.147
> 
> 标签：ruby-on-rails, ruby, api, ruby-on-rails-3.1, devise

我正在尝试使用 API 创建 Rails 3 应用程序。我使用设计作为我的身份验证系统。我想让注册和稍后通过 API 登录成为可能。我不太确定我应该怎么做。我创建了单独的控制器来管理 API，即`api/v1/account/1/projects.json`. 我目前正在尝试`Devise::RegistrationsController`为 API 创建自定义，但我不太确定如何执行此操作。

我的创建操作目前如下所示：

```
class API::V1::RegistrationsController < Devise::RegistrationsController
  redpond_to :json, :xml

  def create
    build_resource
    if resource.save
      if resource.active_for_authentication?
        # Account is a nested resource for User, I want to 
        # create an associated account when the User signs up through the client, 
        # how should I do this?
        account = resource.accounts.build 
        # How can I get the sign_in to work?
        sign_in(resource_name, resource)
        # Probably wrong
        respond_with resource, :location => after_sign_up_path_for(resource)
      else
        # probably wrong
        expire_session_data_after_sign_in!
        respond_with resource, :location => after_inactive_sign_up_path_for(resource)
      end
    else
      # probably wrong, or?
      clean_up_passwords resource
    end
  end 
```

正如我的评论中提到的那样，这可能是非常不正确的，所以我想知道是否有人可以就如何使其发挥作用给我任何指导。还应该提到帐户是用户的嵌套资源。

我还想知道如何使用 Devise 在 API 中设置登录和注销功能。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T16:18:27.403

[This](https://stackoverflow.com/questions/7614798/devise-api-authentication) other SO question可能会对您有所帮助。它看起来非常相似。请特别注意答案中链接的[要点。](https://gist.github.com/1255275)

# unit-testing - 来自 shell 脚本的 C++ Google 测试框架

> ID：10918056
> 
> 赞同：2
> 
> 时间：2012-06-06T16:14:12.660
> 
> 标签：unit-testing, googletest

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T09:18:29.097

如果您的程序使用推荐的方法来调用 google 测试，它应该能够默认将 --gtest_ 命令行选项转发到 google 测试框架。

这是通过简单地调用来完成的

```
::testing::InitGoogleTest(&argc, argv); 
```

如果你想放弃你的 exe，你可以将你编译的测试链接到提供的 gtest_main 库，它提供了一个执行测试的标准主程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:43:47.517

如果我正确理解了您的问题，那么您的程序将运行 Google 测试代码，但您还没有机制将与 Google 测试框架相关的命令行选项传递给调用 Google 测试框架的代码。

如果这是正确的，那么您将需要添加代码以将用于测试的命令行选项传递给您的程序。您可以添加一个选项`--google-test="..."`，然后将参数值传递给 Google 测试基础架构。您将不得不担心从一个选项中解析多个选项等。

然后，您将能够调用：

```
 your_program --google-test="-gtest_output=xml:report.xml" ... 
```

你的代码会管理它。不太可能有一个标准的方法来处理它；没有任何东西会自动将命令行参数传播到 Google 测试框架。（请注意，您的程序不会看到引号；它们会被 shell 删除。）

您可以使用环境变量而不是命令行参数，但作为一种方法不太理想。

# android - 可以编辑系统Android的活动吗？

> ID：10918062
> 
> 赞同：0
> 
> 时间：2012-06-06T16:14:37.330
> 
> 标签：android, android-activity, contactscontract

有人知道是否可以在android中编辑系统活动？

例如在 ContactContracts.people 的活动中插入一个新的 EditText .....如果可能的话，我该怎么办？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:31:19.127

对的，这是可能的。编辑 android IOS ContactContracts 功能，然后在您的手机中设置它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:10:50.510

编辑它？当然。

安装它，甚至构建它？没那么快。

不幸的是，许多内置应用程序都是针对完整的 android 系统构建构建的，而不是 android SDK 导出的。有时可以修改它们以针对 SDK 构建，但在其他情况下，您需要构建 android 本身的整个源代码。

安装也可能有点棘手。几乎所有您可以购买使用的安卓设备都是“安全的”，因为您无法更改系统应用程序所在的分区或以相同的名称为它们安装替代品。由 Google 直接销售的设备，以及越来越多的制造商品牌的设备有时会让您解锁其引导加载程序以允许安装自定义固件映像（请注意，这与 SIM 解锁不同）。但是，即使在允许您修改系统分区的设备上，您也不是免费的，因为您可能无法使用用于签署设备上已有系统应用程序的相同密钥对修改后的 apk 进行签名。这意味着您最终必须重新签署所有系统应用程序，以便您而不是供应商成为受信任的作者。

实际上，如果您将整个原始构建替换为您可以选择或获取签名密钥的修改过的构建，则更改系统应用程序是最直接的。这是 android 模型的一大悲剧，对您自己的设备进行“只是一个小改动”就变成了一个如此大的项目 - 并且通过扩展，您只能在完全替代构建的上下文中与其他用户真正共享这些更改.

一种可能的简化方法是，如果您要更改的功能不必保留在系统应用程序中 - 即，如果您可以复制和重命名应用程序，并以新名称安装修改后的版本并简单地使用它。如果应用程序不需要任何特殊权限，并且您想出了所有完整系统与 sdk 构建问题的解决方案，那么这可能是一条可行的路径。

# javascript - 如何使用 requirejs 使 jQuery 插件可加载

> ID：10918063
> 
> 赞同：88
> 
> 时间：2012-06-06T16:14:42.207
> 
> 标签：javascript, jquery, requirejs

我正在使用 requirejs+jquery，我想知道是否有一种聪明的方法可以使 jQuery 插件与 require 一起工作。

例如，我正在使用 jQuery-cookie。如果我理解正确，我可以创建一个名为 jquery-cookie.js 的文件并在里面做

```
define(["jquery"], // Require jquery
       function($){
// Put here the plugin code. 
// No need to return anything as we are augmenting the jQuery object
});
requirejs.config( {
    "shim": {
        "jquery-cookie"  : ["jquery"]
    }
} ); 
```

我想知道我是否可以做像 jQuery 那样的事情，就像这样：

```
if ( typeof define === "function" && define.amd && define.amd.jQuery ) {
    define( "jquery", [], function () { return jQuery; } );
} 
```

或者如果这是使 jQuery 插件与 requirejs 或任何 amd 兼容的唯一方法

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-08-09T19:04:38.200

[在http://requirejs.org/docs/api.html#config-shim](http://requirejs.org/docs/api.html#config-shim)中指出，在 RequireJS 中使用 shim 配置有一些注意事项。即，当您使用优化器时，“不要在构建中混合 CDN 加载和 shim 配置”。

我一直在寻找一种在有和没有 RequireJS 的网站上使用相同 jQuery 插件代码的方法。[我在https://github.com/umdjs/umd/blob/master/jqueryPlugin.js](https://github.com/umdjs/umd/blob/master/jqueryPlugin.js)找到了 jQuery 插件的这个片段。您将插件包装在此代码中，无论哪种方式它都可以正常工作。

```
(function (factory) {
if (typeof define === 'function' && define.amd) {
    // AMD. Register as an anonymous module depending on jQuery.
    define(['jquery'], factory);
} else {
    // No AMD. Register plugin with global jQuery object.
    factory(jQuery);
}
}(function ($) {

    $.fn.yourjQueryPlugin = function () {
        // Put your plugin code here
    };  

})); 
```

归功于 jrburke；像很多 javascript 一样，它是函数内部的函数作用于其他函数。但我想我已经解开了它在做什么。

第一行中的函数参数`factory`本身就是一个函数，被调用以在`$`参数上定义插件。当不存在与 AMD 兼容的加载器时，会直接调用它以在全局`jQuery`对象上定义插件。这就像常见的插件定义习语：

```
function($)
{
  $.fn.yourjQueryPlugin = function() {
    // Plugin code here
  };
}(jQuery); 
```

如果有模块加载器，则`factory`注册为加载器在加载 jQuery 后调用的回调。加载的 jQuery 副本是参数。相当于

```
define(['jquery'], function($) {
  $.fn.yourjQueryPlugin = function() {
     // Plugin code here
  };
}) 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2012-06-07T02:37:55.797

你只需要做任何一个

```
define(["jquery"], // Require jquery
       function($){
// Put here the plugin code. 
// No need to return anything as we are augmenting the jQuery object
}); 
```

在 jquery-cookie.js 的末尾，或者

```
requirejs.config( {
    "shim": {
        "jquery-cookie"  : ["jquery"]
    }
} ); 
```

在包含 jquery-cookie 之前的任何位置（例如，数据主指向的任何位置）。

您发布的最后一个代码块适用于重新分发的 jQuery 之类的东西，并且可能会或可能不会在 AMD 环境中。理想情况下，每个 jQuery 插件都已经设置好了。

我更喜欢尽可能地保持包含的库的纯正，因此**每页一次的全局 shim 配置对我来说似乎是最干净的解决方案**。这样升级更安全，CDN 成为可能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-09T17:11:28.283

就像所有一些 jquery 插件已经使用 amd/require 一样，你不需要在 shim 中声明任何东西。事实上，在某些情况下这样做可能会给您带来问题。

如果您查看 jquery cookie JS，您将看到定义调用和 require(["jquery"])。

在 jquery.js 中，您将看到对 define("jquery",[],function()... 的调用

# sql - 查询以返回具有组的额外行的元素

> ID：10918065
> 
> 赞同：0
> 
> 时间：2012-06-06T16:14:56.207
> 
> 标签：sql, sqlite

我有一个*SQLite*数据库，该数据库存储带有类别的项目列表。类别是*隐含*的，它们没有单独的表。我想要一个查询，该查询将返回按类别排序的所有项目，每个类别有一个额外的行。

考虑以下场景：

```
ID    Name       Category
1     Item 1     C1
2     Item 2     C2
3     Item 3     C1 
```

我期望的结果是这样的：

```
ID    Name       Category
null  null       C1
1     Item 1     C1
3     Item 3     C1
null  null       C2
2     Item 2     C2 
```

这是为了*直接映射*到将显示结果的列表视图，每个类别包含一个额外的分隔项。我现在正在做的是返回按类别排序的所有元素，并遍历所有元素以了解分隔符的位置。

我已经尝试了许多不同`JOIN`的 s，但是我的*SQL-fu*很弱，我无法弄清楚如何编写这样的查询。我该怎么做呢？哪些*SQL*结构可以让我添加这些额外的行？是否有可能以我需要的方式在单个查询中获得结果*- 无论多么复杂 -*查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:16:11.120

考虑一个`union`：

```
select  ID    
,       Name
,       Category
union all
select  distinct null
,       null
,       Category
order by 
        Category 
```

An`order by`适用于整个联合——不需要子查询。

# c# - Visual Basic 2010 登录视图 asp.net

> ID：10918066
> 
> 赞同：1
> 
> 时间：2012-06-06T16:14:58.487
> 
> 标签：c#, asp.net

我最近使用 Visual Studios 2010 中的通用模板创建了一个带有会员登录和注册的 asp.net 应用程序。下面是模板在 Visual Studios 中的样子：http: [//www.flickr.com/photos/79954191@ N05/7345407648/](http://www.flickr.com/photos/79954191@N05/7345407648/)

然后，一旦我加载应用程序，它就会将我重定向到登录屏幕（应该如此），但问题是它缺少所有模板/css 元素。下面是加载后的图片：http: [//www.flickr.com/photos/79954191@N05/7160199089/](http://www.flickr.com/photos/79954191@N05/7160199089/)

先感谢您！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T16:21:09.160

检查 web.config 以获取对 css 文件夹的权限。

您必须使用位置来授予未经身份验证的用户的权限

```
<location path="pathToCssFolder">
    <system.web>
        <authorization>
            <allow users ="*" />
        </authorization>
    </system.web>
</location> 
```

检查此链接： http: [//support.microsoft.com/kb/316871](http://support.microsoft.com/kb/316871)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:22:34.930

确保样式表指向正确的目录。打开您的 Site.Master 文件并确保该文件的链接如下： href="~/path/to/folder/yourcss.css" 波浪号 (~) 表示项目的根目录。

# javascript - 单击处理程序以获取 JS 中的列表？

> ID：10918067
> 
> 赞同：0
> 
> 时间：2012-06-06T16:15:00.510
> 
> 标签：javascript, jquery

我的每个 li 都有一个“galleryImage”类，里面是一个带有“delete”类的跨度。当用户点击span delete时，我想让js做点什么，但是下面的代码似乎没有触发，这是怎么回事？

```
$('.galleryImage .delete').click(function() {
          alert("Handler for .click() called.");
    }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T16:18:54.177

Try this:

```
$('body').on('click', '.galleryImage .delete', function() {
      alert("Handler for .click() called.");
}); 
```

with jQuery > 1.7

**Your question doesn't clarify that, those element on which you're trying to add event are dynamic (added to document page after page load) or previously exists in at page load. So I assume that your elements are added to document after page load.**

* * *

### Note

To add events that added to DOM after page load need delegate event which can be done with [`.on()`](http://api.jquery.com/on) in jQuery.

### Use of `.on()`

```
$(container).on(eventName, target, handlerFunction); 
```

# jquery - 提交后恢复选择不起作用

> ID：10918071
> 
> 赞同：1
> 
> 时间：2012-06-06T16:15:15.817
> 
> 标签：jquery, forms, select, each

这就是我尝试（没有萤火虫错误）将我的表单的每个选择恢复到其第一个选项值的方式

```
/* $(this) is the form */
$(this).find('input[type="text"],textarea').val(''); /* This works */
$(this).find("select").each(function(){
    $(this).val($(this,"option:first").val());  /* this doesnt do anything */
}); 
```

我在做什么？

-编辑-

刚刚发现..这行得通，为什么不用逗号？

```
$(this).val($(this).find("option:first").val()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:17:09.870

试试这个：

```
$(this).find("select").change(); 
```

这将自动将第一个选项值设置为默认值。

如果您使用您需要的代码：

```
$(this).find("select").each(function(){

    $(this).val($("option:first", this ).val());  /* this doesnt do anything */

                                   ^--- this will places here

}); 
```

你`$(this, "option:first")`没有工作，因为你的代码是在 a`select`内搜索`option`，但它应该`option`在`search`.

jquery 选择器的一种格式是

```
$(target, context); 
```

# c++ - 简化嵌套的 STL 容器遍历

> ID：10918072
> 
> 赞同：2
> 
> 时间：2012-06-06T16:15:25.813
> 
> 标签：c++, stl

我有一个包含 STL 容器的嵌套遍历代码。特别是我有一个包含子列表的顶级容器（列表），而这些子列表包含更多的子列表。例如，在 DICOM 结构中，患者可以有多个研究，每个研究可以有多个系列。我必须对 Series 对象执行一些操作，到达它们的唯一方法是深入循环，如下所示。

伪代码如下所示。

```
STLContainer top;
STLContainer::iterator top_iter;

for ( top_iter= top.begin(); top_iter != top.end(); ++top_iter) {
 STLContainer mid = *top_iter;
 STLContainer::iterator mid_iter;

 for ( mid_iter = mid.begin(); mid_iter!= mid.end(); ++mid_iter) {
  STLContainer bottom = *mid_iter;
  STLContainer::iterator bottom_iter;

  for(bottom_iter = bottom.begin(); bottom_iter != bottom.end(); ++bottom_iter){
     ExecuteSomething(*bottom_iter); // Finally do something with the stored object
  }
 } 
```

}

现在，如果我必须对这些“底部”对象重复执行一系列操作，我必须一次又一次地进行这种遍历。如果我想使用 STL 算法，我需要为每个嵌套级别编写至少 3 行“for_each”。

有谁知道缩短此代码的技术，它可以像这样工作？

```
// Drills down to the deepest nested container
for_each(top.begin(), top.end(), DrillDownAndExecuteOnBottom()); 
```

哪一个可以在一行中工作？像这样的东西？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T17:18:09.310

假设容器不都是相同的元素类型：

```
struct DrillDownAndExecuteOnBottom
{
  template<typename T>
    void operator()(T& t) const
    { for_each(t.begin(), t.end(), *this); }

  void operator()(Bottom& b) const
  { ExecuteSomething(b); }
}; 
```

这将进行深度优先遍历，直到它到达`Bottom`对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:20:13.603

您可以编写一次遍历并使用 lambda 封装它。

```
void for_each_bottom( Top &top, const std::function<void(Bottom &)> &fn ) {  
    for (auto t = top.begin(); t != top.end(); ++t)  
        for (auto m = t->begin(); m != t->end(); ++m)  
            for (auto b = m->begin(); b != b->end(); ++b)  
                 fn( *b );

}  

void demo( Top &top ) {
    for_each_bottom( top, []( Bottom &bottom ) {
        ExecuteSomething( bottom );
    } );
} 
```

（如果您愿意，可以使用 Jonathan Wakely 的递归/模板方法进行遍历；这些嵌套循环很简单但不太通用。如果您也愿意，请使用模板类型而不是 std::function<>。我通常更喜欢避免使用模板除非需要。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:21:31.633

这是一个递归函数的一些半伪代码，应该可以解决问题：

```
void iterate(Container c)
{
    for (Iterator iter = c.begin(); iter != c.end(); iter++)
    {
        if (*iter is a Container)  // I forget how to do type-checking in C++
            iterate(*iter);
        else
            ExecuteSomething(*iter);
    }
} 
```

编辑：

像这样的东西可能更灵活（不记得 C++ 处理函数指针是否与 C 不同/有更好的利用它们的方式，但无论如何）

```
void recursiveIterateAndExecute(Container c, void func(Container))
{
    for (Iterator iter = c.begin(); iter != c.end(); iter++)
    {
        if (*iter is a Container)  // I forget how to do type-checking in C++
            recursiveIterateAndExecute(*iter, func);
        else
            func(*iter);
    }
} 
```

可能有一些方法可以修改这些以更符合 STL 算法，但由于我没有用 C++ 做太多工作，所以我无法对此发表评论。

# asp.net-mvc-3 - Autofac MultiTenant - 我如何路由到子域？

> ID：10918076
> 
> 赞同：1
> 
> 时间：2012-06-06T16:15:47.390
> 
> 标签：asp.net-mvc-3, autofac

n00b 在这里。重新提出问题，因为我没有正确标记它。

我正在尝试利用 Autofac 的 MutliTenant 功能。我从源文件中得到了一个“工作”示例。我已经扫描了文档，但无法弄清楚如何“路由”租户。

目前，我想为基本的 CRUD 应用程序使用单个代码库。CRUD 应用程序将被几个不同的站点使用，只专注于单个站点的特定服务。

我最终想这样做：

*   codebase.website1.com（租户 1）
*   codebase.website2.com（租户 2）
*   codebase.website3.com（租户 3）

有什么想法或参考吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T14:59:04.093

如果您查看[wiki 上的 Autofac 多租户文档，](http://code.google.com/p/autofac/wiki/MultitenantIntegration)您会注意到您确定租户的方式是通过实现`ITenantIdentificationStrategy`. 该 wiki 页面上提供了一个示例，显示了如何从请求中的参数（如查询字符串）中获取租户。

修改示例以查看请求的其他部分很容易——主机名、域名或其他任何内容。

```
using System;
using System.Web;
using AutofacContrib.Multitenant;

namespace DemoNamespace
{
  public class DomainStrategy : ITenantIdentificationStrategy
  {
    public bool TryIdentifyTenant(out object tenantId)
    {
      tenantId = null;
      try
      {
        var context = HttpContext.Current;
        if(context != null && context.Request != null)
        {
          var site = context.Request.Url.Authority;
          // Here's where you map the site to the tenant ID:
          tenantId = MapTheSiteToTheTenantId(site);
        }
      }
      catch(HttpException)
      {
        // Happens at app startup in IIS 7.0
      }
      return tenantId != null;
    }
  }
} 
```

显然你需要按摩它才能为你工作。如何进行映射，是否返回 null 作为默认租户 ID，等等。

请注意，如果您基于 HTTP 请求值进行测试，那么只要解决了依赖项并且没有 Web 上下文，您将获得应用程序级别的依赖项，而不是特定于租户的依赖项......因为您赢了'无法识别租户。您会在 catch 块中看到一个小工件 - 如果在应用程序启动时解决了任何依赖项，则不一定存在 Web 上下文，因此当您调用 HttpContext.Current 时 IIS 7.0 会引发 HttpException。你必须测试这样的东西。

此外，如果它是服务调用或昂贵的东西，您将需要考虑租户 ID 映射的缓存策略。每次您解决多租户依赖关系时，都会调用该策略，因此您希望使策略实现尽可能高效。

[我真的建议您查看该文档。](http://code.google.com/p/autofac/wiki/MultitenantIntegration)它很长，但那是因为多租户是一个复杂的主题，并且需要涵盖很多内容。如果你深入那里，你会找到这些问题的答案。

# c - C 两个函数合二为一

> ID：10918078
> 
> 赞同：0
> 
> 时间：2012-06-06T16:15:52.630
> 
> 标签：c, casting

我有两个功能完全相同，但在两种不同类型的结构中，这两种类型的结构非常相似。

想象一下我有这两个结构。

```
typedef struct nodeOne{
    Date *date;
    struct nodeOne *next;
    struct nodeOne *prev;
}NodeOne;

typedef struct nodeTwo{
    Date *date;
    struct nodeTwo *next;
    struct nodeTwo *prev;
}NodeTwo; 
```

由于我销毁每个列表的函数几乎相同（只是参数的类型不同），我只想制作一个函数来使两个变薄。

我有这两个功能

```
void destroyListOne(NodeOne **head, NodeOne **tail){
    NodeOne *aux;

    while (*head != NULL){
        aux = *head;
        *head = (*head)->next;
        free(aux);
    }
    *tail = NULL;
} 
```

和这个：

```
void destroyListTwo(NodeTwo **head, NodeTwo **tail){
    NodeTwo *aux;

    while (*head != NULL){
        aux = *head;
        *head = (*head)->next;
        free(aux);
    }
    *tail = NULL;
} 
```

由于它们非常相似，我想制作这样的东西：

```
void destroyList(void **ini, void **end, int listType){

    if (listType == 0) {
        NodeOne *aux;
        NodeOne head = (NodeOne) ini;
        NodeOne tail = (NodeOne) ed;

    }
    else {
        NodeTwo *aux;
        NodeTwo head = (NodeTwo) ini;
        NodeTwo tail = (NodeTwo) ed;
    }

    while (*head != NULL){
        aux = *head;
        *head = (*head)->next;
        free(aux);
    }
    *tail = NULL;
} 
```

正如您现在可能无法正常工作，但我想知道这是否可以实现。

我必须保持这两个结构原样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:37:33.480

正如@Dancrumb 所指出的，这里有一些设计问题，我不建议你做你想做的事情。

也就是说，铸造*可以*完成，提供`nodeOne`并且`nodeTwo`总是相同的（我在生产代码中**永远****不会**依赖这一点）。

你可以只选择一个，然后总是投给它（*颤抖*）。由于它们是具有不同名称的相同结构，因此演员表有效：

```
void destroyList(void *ini, void *end, int listType){

    NodeOne *aux = NULL;
    NodeOne **head = ini;
    NodeOne **tail = end;

    while (*head != NULL){
        aux = *head;
        *head = (*head)->next;
        free(aux);
    }
    *tail = NULL;
} 
```

另请注意，在 C 中，您不需要显式强制转换，因为 void * 可以在没有强制转换的情况下隐式转换为任何其他指针类型。

但说真的，请不要这样做。它是脆弱的、不可维护的和容易出错的。

* * *

看了@Torp 的回答后，我想详细说明一下问题的精神和我的回答。通过对@Torp 代码的错误修复（它无法编译并且存在几个指针问题），它可以工作。也就是说，我仍然*认为你不应该*让它工作。

特别是当我们谈论 C（而不是 C++）时，我肯定会将销毁函数分开用于单独的列表类型。我尽量避免剪切和粘贴代码，但在这种情况下，我认为安全性、清晰性和可维护性会胜出。我的意见，当然。你的旅费可能会改变 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T16:38:51.500

尽管我不想这么说，这就是模板是在 C++ 中发明的原因。你确定不能用吗？

像这样的东西应该工作：

```
void destroyList(void **ini, void **end, int listType)
{
    void *aux;
    void *head = ini;
    void *tail = end;

    while (*head != NULL){
        if (listType == 0) {
           aux = (NodeOne *)*head;
           *head = ((NodeOne*)*head)->next;
           free((NodeOne*)aux;
        } else {
           ... same thing with casts to NodeTwo* ...
        }
    }
    *tail = NULL;
} 
```

不确定我把所有的类型转换都放在哪里，但你明白了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:22:49.440

如果我设计这个，我会这样做：

```
typedef struct node{
    Date *date;
    struct node *next;
    struct node *prev;
} Node; 
```

既然`NodeOne`和`NodeTwo`是相同的，为什么会有两种不同的类型呢？

如果有某种原因我失踪了，那么我会扩展这个：

```
typedef struct nodeOne {
    Node nodeInfo;
    /* additional */
} NodeOne

typedef struct nodeTwo {
    Node nodeInfo;
    /* additional */
} NodeTwo 
```

然后，只需将该`nodeInfo`字段传递给您的节点操作函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:55:40.563

编写一个包含所有函数的#define，只需将函数名和结构类型作为参数。

```
#define DECLARE_DESTRUCTION_FUNCT(_name_, _type_) void _name_(_type_ **head, _type_ **tail){\
_type_ *aux;\
\
while (*head != NULL){\
    aux = *head;\
    *head = (*head)->next;\
    free(aux);\
}\
*tail = NULL;\
}

DECLARE_DESTRUCTION_FUNCT(destroyListOne, NodeOne)
DECLARE_DESTRUCTION_FUNCT(destroyListTwo, NodeTwo) 
```

这种从 C++ 复制模板。带来编译时类型检查的好处。

# javascript - 谷歌地图多边形是否被索引/我如何参考它们的索引？

> ID：10918080
> 
> 赞同：2
> 
> 时间：2012-06-06T16:15:54.457
> 
> 标签：javascript, google-maps, google-maps-api-3, polygon

下面是我添加到地图的 3 个多边形的示例。我打算将点击事件包含在每个事件中；但是，我想输出每个多边形的一些元素，我可以参考这些元素并与其他数据相关，例如描述、图像等。输出可以是给每个形状的短标题（变量名）——这里是 e609、c815 , 和 c840- 或索引号- 理想情况下是在每个多边形之前的注释中给出的数字。

多边形是否按照它们进入地图的顺序给出了索引号？如果是这样，我如何引用这个数字以将其传递给另一个函数？或者，我怎么能传递短标题？

```
//0
var e609;
var e609_c = [
    //Latlng, cut for space.
];
e609 = new google.maps.Polygon({
    paths: e609_c,
    strokeOpacity: 0,
    fillColor: "#B1509E",
    fillOpacity: .4
});
e609.setMap(map);

//1
var c815;
var c815_c = [
    //Latlng, cut for space.
];
c815 = new google.maps.Polygon({
    paths: c815_c,
    strokeOpacity: 0,
    fillColor: "#B1509E",
    fillOpacity: .4
});
c815.setMap(map);

//2
var c840;
var c840_c = [
    //Latlng, cut for space.
];
c840 = new google.maps.Polygon({
    paths: c840_c,
    strokeOpacity: 0,
    fillColor: "#B1509E",
    fillOpacity: .4
});
c840.setMap(map); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:19:04.460

您可以包含自定义字段来描述对象创建中的多边形，例如，我添加了描述和短标题。我不知道获取变量名的直接方法，所以它只是重复。尽管我不确定如何访问该信息，但应该在内部对多边形进行索引。使用您分配给新多边形的变量名称，您可以对其进行操作。

```
e609 = new google.maps.Polygon({
    description: "Polygon named e609",
    shortTitle: "e609",
    paths: e609_c,
    strokeOpacity: 0,
    fillColor: "#B1509E",
    fillOpacity: .8
}); 
```

添加点击侦听器时，您需要通过其变量名称（e609）来引用它，或者我会做一个多边形数组，比如`var myPolygons = []`将`push`e609 放入这个数组中。然后您可以将其寻址为`myPolygons[0]`. 或者，您可以使用对象通过短标题来保存多边形，例如`myPolygons['e609']`.

无论如何，以下是您可以如何使用在多边形定义中创建的字段。

```
google.maps.event.addListener(e609, 'click', function(event) {
  alert("Clicked on " + this.description + " short title " + this.shortTitle);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-21T16:47:58.730

我这样做的方式是使用[TAFFY.JS](http://taffydb.com/)。

创建多边形时，我传递了一个唯一的索引号作为自定义参数，称为“indexID”

```
var returnObj = new google.maps.Polygon({
             paths: [arcPts],
             strokeColor: beamColor,
             strokeOpacity: 0.5,
             strokeWeight: 3,
             fillColor: fillColor,
             fillOpacity: 0.1,
             map: map,
             indexID: i
    }); 
```

然后我将它添加到我命名为“toggle”的 TAFFY 数据库中（我正在使用该函数来显示/隐藏多边形）

```
google.maps.event.addListener(returnObj, 'rightclick', function (event) {
  // add to make visible db
  toggle.insert({
    "indexID":i,
    "obj":returnObj
  });
}); 
```

现在，我可以通过 ID 引用地图对象并对其进行处理

```
var ret=toggle({"indexID":5}).get();    
ret[0].obj.setVisible(true); 
```

# ember.js - BoundView 和 UnboundView 回顾

> ID：10918086
> 
> 赞同：0
> 
> 时间：2012-06-06T16:16:15.203
> 
> 标签：ember.js

我想分享以下绑定/未绑定视图的片段以获得反馈。任何建议都将受到欢迎。

```
Yn.UnboundView = Em.View.extend({

  item: null,

  didInsertElement: function() {
    this._super();
    this.$().text( this.get('item') );

  }

});

Yn.BoundView = Em.View.extend({

  item: null,

  render: function(buffer) {
    buffer.push( this.get('item') );
  },

  _itemDidChange: Ember.observer(function() {
    this.rerender();
  }, 'item')

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T08:03:47.210

这是更惯用的：

```
App.MyBoundView = Ember.View.extend({
    template: Ember.Handlebars.compile('Value: {{value}}'),
    valueBinding: 'App.myController.value'
}); 
```

或未绑定版本：

```
App.MyUnboundView = Ember.View.extend({
    template: Ember.Handlebars.compile('Value: {{unbound value}}'),
    valueBinding: 'App.myController.value'
}); 
```

甚至：

```
App.MyOtherUnboundView = Ember.View.extend({
    template: Ember.Handlebars.compile('Value: {{unbound value}}'),
    value: 42
}); 
```

*示例[@http://jsfiddle.net/MikeAski/GcUMu/](http://jsfiddle.net/MikeAski/GcUMu/)*

# java - java - 如何在Java Web应用程序中使数据库参数可配置？

> ID：10918087
> 
> 赞同：0
> 
> 时间：2012-06-06T16:16:18.463
> 
> 标签：java, web-applications

大家好，以下是我的数据库连接文件，

```
package org.slingemp.common;

import java.sql.Connection;
import java.sql.DriverManager;

public class JDBCManager {

    public Connection mysqlConnection()  {
        Connection dbConnection = null;
        try {

          Class.forName("com.mysql.jdbc.Driver");
          dbConnection=DriverManager.getConnection("jdbc:mysql://localhost:3306/slingemp","root","root");
          //System.out.println("mysql Driver Connedted::::::::");

        } catch (Exception e) {
            e.printStackTrace();
        }
        return dbConnection;

    }
} 
```

在这我想让连接字符串和驱动程序名称可配置。如何做到这一点以及将包含可配置值的文件放在哪里？

问候托尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:20:32.297

您可以将这些值放在属性文件中，例如`database.properties`文件，然后使用如下代码加载这些属性：

```
private void loadProperties(){
  InputStream inputStream = JDBCManager.class.getClassLoader().getResourceAsStream("database.properties");
  try {
            databaseProperties.load(inputStream); // database properties is an instance variable Properties databaseProperties;
        } catch (IOException e) {
            logger.error("Exception occurred while loading server properties", e);
        }
} 
```

根据评论：

是的，JNDI 可以在 Tomcat 中使用，要在 Tomcat 7 上配置数据源，请阅读这个[官方文档](http://tomcat.apache.org/tomcat-7.0-doc/jndi-datasource-examples-howto.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:20:59.323

您可以将它们放入`.properties`文件或服务器 JNDI 资源中。

jdbc.properties 示例：

```
jdbc.driverClassName=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/yourDatabaseName
jdbc.username=username
jdbc.password=password 
```

然后在java类中使用它来获取属性：

```
public static ResourceBundle getJdbcBundle() {
    return ResourceBundle.getBundle("jdbc");
}

String url = SomeClass.getJdbcBundle().getString("jdbc.url"); 
```

但更有效的方法是使用 JNDI。

# jquery-ui - Jquery UI 滑块 - Tubeplayer 插件的 Seekbar

> ID：10918089
> 
> 赞同：2
> 
> 时间：2012-06-06T16:16:29.260
> 
> 标签：jquery-ui, seekbar, jquery-ui-slider

我正在尝试调整 Jquery ui 滑块以与 Tubeplayer jquery 插件一起使用以获得简单的搜索栏。当您单击某处的栏时，我已经让它适当地寻找，但是当视频播放时，我无法让滑块自行移动。这是我的工作代码片段：

```
$.tubeplayer.defaults = {

            afterReady: function($player){$( "#slider" ).slider({
                                value:0,
                                orientation: "horizontal",
                                range: "min",
                                max: $("#youtube-player-container").tubeplayer("data").duration,
                                step:1,
                                animate: true,
                                slide:  function(event, ui) {
                                         jQuery("#youtube-player-container").tubeplayer("seek",ui.value);
                                     }

                                    });                         
}, 
```

我知道这段代码不会解决随着视频移动的滑动手柄，只会在点击时寻找视频中的正确时间。滑块移动的任何简单解决方案？我写了一个手动的while循环，但它似乎把事情挂了：

```
onPlayerPlaying: function(){
        var playing = 1;
        while(playing == 1){    
        var cur = $("#youtube-player-container").tubeplayer("data").currentTime;
        var dur = $("#youtube-player-container").tubeplayer("data").duration;
        if(cur<dur){
            $( "#slider" ).slider( "option", "value", cur);
}}}, 
```

我在这里也看到了一个例子：[http](http://dev.opera.com/articles/view/custom-html5-video-player-with-css3-and-jquery/) ://dev.opera.com/articles/view/custom-html5-video-player-with-css3-and-jquery/但似乎无法弄清楚它们是如何实现css“width”和“left”属性随着seekbar中的currentTime而变化。我很难让它与我的插件一起使用。任何帮助深表感谢！！谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T05:55:03.610

我花了太长时间才弄清楚这一点。归结为缺乏对javascript的了解。我只需要 setInterval() 方法。这是我的工作代码：

```
onPlayerPlaying: function(){

        var seekUpdate='';
        seekUpdate=setInterval(function(){
        var cur = Math.floor($("#youtube-player-container").tubeplayer("data").currentTime);
        var time =  Math.floor(cur*254/dur);
        $(".ui-slider-handle").css("left",time);
        $(".ui-slider-range").css("width",time);
        },100);
        }, 
```

我更新的滑块初始化调用：

```
$.tubeplayer.defaults = {

    afterReady: function($player){$( "#slider" ).slider({
                                range: "min",
                                max: 254,
                                step:1,
                                animate: true,
                                slide:  function(event, ui) {
                                         jQuery("#youtube-player-container").tubeplayer("seek",(ui.value/254)*dur);
                                         clearInterval(seekUpdate);
                            },

                    }); 

}, 
```

和暂停，只是为了很好的衡量：

```
onPlayerPaused: function(){
        var cur = Math.floor($("#youtube-player-container").tubeplayer("data").currentTime);
        var time =  Math.floor(cur*254/dur);
        $( "#slider" ).slider( "option", "value", time);
}, 
```

这一切都可以完美地使用带有 HTML5 支持的 Tubeplayer 插件创建一个功能齐全的自定义 jquery ui 滑块搜索栏！具有移动支持的惊人的自定义 Youtube 无铬播放器解决方案。一定会喜欢的！

# sql - 更改 postgres 数据库中某些值的部分字符串

> ID：10918093
> 
> 赞同：0
> 
> 时间：2012-06-06T16:16:44.153
> 
> 标签：sql, postgresql-9.1

我有一个三列的表。Column1 是 id。Column2 是文件名。第 3 列是位置。我需要编写一个查询，它将获取所有文件名 = X 的文件，并将部分字符串替换为 'location' 比如说 location = '/home/AAA/bin' 并将其替换为 '/home/BBB/斌'。位置的起点总是相同的，但终点并不总是相同的。我的意思是它总是以 /home/AAA/ 开头，但每个文件的位置结尾都不同 - /bin/ 可能是 /somethingelse/。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T18:29:29.627

你需要使用这个 Postgres 函数

```
overlay(string placing string from int [for int]) 
ex: overlay('Txxxxas' placing 'hom' from 2 for 4) 
```

您的情况涉及具有以下内容的 select 语句：

```
overlay(location placing '/home/BBB' from 1 for 9) 
```

[您可以从这里](http://www.postgresql.org/docs/8.3/static/functions-string.html)获得更多信息。

# c++ - 数组的名称是右值吗？

> ID：10918100
> 
> 赞同：3
> 
> 时间：2012-06-06T16:17:24.810
> 
> 标签：c++, c

> **可能重复：**
> [数组名称是 C 中的指针吗？](https://stackoverflow.com/questions/1641957/is-array-name-a-pointer-in-c)

```
#include <stdlib.h>
int main(int argc, const char *argv[])
{
    char *b=(char*)malloc(sizeof(char)*50);
    b=(char*)"hello world";
    // works

    char a[50];
    a=(char*)"hello world";
    //doesn't work. why? I thought array names are just pointers that point
    //to the first element of the array (which is char). so isn't a char*?
    return 0;
} 
```

我认为它不起作用的原因是因为没有一个名为“a”的变量实际上存储了一个 char* 值。那么'a'应该被认为是一个右值吗？我不确定我是否正确理解了这个概念

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T16:19:54.173

数组不是指针，***有时***^([注1：])当数组名称无效时（*例如：传递给函数*），数组的名称会衰减为指针。
数组是**不可修改的左值**，它们不能被分配并且可以获取地址。

^([注1：])
例如：
数组名在使用时不会衰减为指针`sizeof()`

数组地址不能更改，但内容可以更改。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-06T16:22:43.223

数组是不可修改的左值。您不能为它分配任何东西，但您可以将一元运算`&`符应用于它。

当您说这里不`char *`涉及变量时，您是对的。数组名直接指数组对象——一块连续的内存块，其大小等于元素个数和元素大小的乘积。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-06T16:19:27.570

> 我认为数组名称只是指针

不，他们不是。它们是数组。当您将它们作为参数传递时，它们会**衰减**为指针，仅此而已。您不能重新分配数组，只能更改单个值。

# r - R - 在使用注释时向 ggmap (ggplot2) 添加图例

> ID：10918102
> 
> 赞同：3
> 
> 时间：2012-06-06T16:17:34.810
> 
> 标签：r, plot, ggplot2, legend, ggmap

仅供参考：我对 ggplot2 和 ggmap 还很陌生，所以我为草率的代码道歉，但这是我能够绘制每组都有自己颜色的点组的唯一方法。我的操作系统也是ubuntu。

我正在尝试向 ggmap 对象添加一个图例，特别是一个具有连续渐变颜色的图例。有什么建议吗？我已经尝试过 ggmap 中的 legend 属性，但它似乎不起作用。以下是我到目前为止所拥有的。

```
syd = get_map(location = center, zoom = zoom, maptype = type,color = "bw")

(SYDmap = ggmap(syd, extent = "panel",legend="right")+ annotate('point',x=lng[[1]],xend=max(lng[[1]]),y=lat[[1]],yend=max(lat[[1]]),colour=colorval[1],cex=cexval,pch=pchval))

for(i in 2:(topnum - 1))
  SYDmap<- SYDmap + annotate('point',x=lng[[i]],xend=max(lng[[i]]),y=lat[[i]],yend=max(lat[[i]]),colour=colorval[i],cex=cexval,pch=pchval)

i=topnum;  (SYDmap <-   SYDmap + annotate('point',x=lng[[i]],xend=max(lng[[i]]),y=lat[[i]],yend=max(lat[[i]]),colour=colorval[i],cex=cexval,pch=pchval)) + guides(fill = "colourbar") 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T09:07:44.250

而不是使用`annotate`，这是一种使用 添加点图层的方法`geom_point`。几乎任何几何图形都可以添加到 ggmap 对象中，就像它会添加到 ggplot 对象中一样。因为`Size`（参见`df`下面数据框的内容）是调用中的一种颜色美学`geom_point`，所以图例是自动生成的。

```
library(ggmap)

# Get a map - A map of Canberra will do
ACTmap = get_map(c(149.1, -35.325), zoom = 12, source = "google", maptype = "roadmap")

# A data frame of lon and lat coordinates and the variable Size
df = data.frame(lon = c(149.0307, 149.1326, 149.089, 149.048, 149.0965),
            lat = c(-35.3892, -35.28225, -35.34005, -35.34857, -35.34833),
            Size = c(1,2,3,4,5))

# Draw the map
ACTmap = ggmap(ACTmap)

# Add the points
ACTmap = ACTmap + geom_point(data = df, aes(x = lon, y = lat, colour = Size), 
      alpha = 0.6,  size = 10)

# Change the legend
ACTmap + scale_colour_continuous(low = "red", high = "blue", space = "Lab", guide = "colorbar") 
```

![在此处输入图像描述](../Images/50692eac459728d404ad09c435a77b1c.png)

# java - java.io.File.toURI() IO 绑定？

> ID：10918106
> 
> 赞同：1
> 
> 时间：2012-06-06T16:17:46.840
> 
> 标签：java

我正在分析负责在磁盘上存储二进制文件的 J2EE 应用程序。在分析过程中，我们发现了大量的 IO 瓶颈，我们需要解决这些问题。但是，我们也看到这行代码的速度变慢了：

```
// Example URI path
String filename = "/path/to/file.txt"  

// This line at load takes almost 500 ms
return new File(filename).toURI(); 
```

有问题的方法接受文件路径并返回可以写入文件的文件路径。

由于减速只发生在负载时，我猜这个过程在这条线上是 IO 绑定的。是这样吗？如果是这样，是否有更好的方法来分配性能更好的 URI？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:17:05.693

这是该方法的源代码：

```
 public URI toURI() {
    try {
        File f = getAbsoluteFile();
        String sp = slashify(f.getPath(), f.isDirectory());
        if (sp.startsWith("//"))
        sp = "//" + sp;
        return new URI("file", null, sp, null);
    } catch (URISyntaxException x) {
        throw new Error(x);     // Can't happen
    }
    } 
```

“getAbsoluteFile()”确实是 IO 绑定的，因为它必须访问文件系统才能将任何相对路径解析为绝对路径（通过链下的 FileSystem.resolve() 方法）。

# php - Opencart 付款扩展仅适用于管理员

> ID：10918111
> 
> 赞同：0
> 
> 时间：2012-06-06T16:18:01.380
> 
> 标签：php, opencart

使用诸如“免费结帐”之类的付款扩展来测试结帐（下测试订单）的最佳方法是什么。尽管此付款扩展仅对管理员可用，例如管理员登录时与维护模式相同，但他们可以选择免费结帐？

还是有另一种不修改代码的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:50:03.983

打开`/catalog/model/payment/free_checkout.php`

寻找

```
if ($total <= 0) { 
```

将其更改为

```
if ($total <= 0 || !empty($this->session->data['user_id'])) { 
```

# php - 用直接文件上传替换表单输入文件

> ID：10918115
> 
> 赞同：1
> 
> 时间：2012-06-06T16:18:15.800
> 
> 标签：php, curl, upload

我正在使用 php 开发服务器端 Youtube 上传器。使用[此脚本](http://rubensargsyan.com/generate-youtube-video-browser-based-uploading-form-by-php/)，我将视频文件成功上传到 Youtube。但是，我不想手动选择文件，但我想上传一个已经在我的服务器上的文件。我知道文件名/路径（如果这对您有任何帮助，也可以对视频进行 base64 编码），并且我拥有 Youtube 所需的所有密钥和令牌。但是，我不知道如何将所有这些信息转换为适当的 http-post。

```
<form action="<?php echo($response->url); ?>?nexturl=<?php echo(urlencode($nexturl)); ?>" method="post" enctype="multipart/form-data">
   <input id="file" type="file" name="file"/>
   <input type="hidden" name="token" value="<?php echo($response->token); ?>"/>
   <input type="submit" value="go" />
</form> 
```

我已经尽力深入研究 cURL，但我不确定这是否对我有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:40:59.533

根据您提供的网址中找到的脚本，我将首先尝试：

```
$ch = curl_init($response->url."?nexturl=".urlencode($nexturl));
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_VERBOSE, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERAGENT, $_SERVER["HTTP_USER_AGENT"]);
curl_setopt($ch, CURLOPT_POST, true);
$post = array(
    "file"=>"@/path/to/file.avi",
    "token"=>$response->token
);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post); 
$response = curl_exec($ch); 
```

# c# - 使用属性将派生类成员变量引用到基类成员变量

> ID：10918117
> 
> 赞同：0
> 
> 时间：2012-06-06T16:18:20.007
> 
> 标签：c#, inheritance, properties

我当前的代码看起来有点像这样。

```
class BaseClass2
{
    public List<BaseClass1> list { get; set; }
}

class DerivedClass2 : BaseClass2
{
    public DerivedClass1A objA { get; set; }
    public DerivedClass1B objB  { get; set; }
} 
```

我有一个 DerivedClass2，我知道基类中列表的类型，并且我知道会有两种类型的 DerivedClass1A 和 DerivedClass1B。

我可以像上面那样创建新变量，但我不想使用内存并巧妙地访问和设置原始列表，我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:22:08.410

您可以使用泛型：

```
class BaseClass2<T>
  T : BaseClass1
{
    public List<T> list { get; set; }
}

class DerivedClass2 : BaseClass2<BaseClass1>
{
    public DerivedClass1A objA { get; set; }
    public DerivedClass1B objB  { get; set; }
} 
```

或者，如果您只想从列表中获取子类，您可以使用`TypeOf()`方法：

```
baseClass2Instance.list.TypeOf<DerivedClass1A>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:22:38.130

你的意思是这样的吗？

```
class DerivedClass2 : BaseClass2
{
    public DerivedClass1A objA
    {
        get
        {
            return (DerivedClass1A)base.list[0];
        }
        set
        {
            base.list[0] = value;
        }
    }

    public DerivedClass1B objB
    {
        get
        {
            return (DerivedClass1B)base.list[1];
        }
        set
        {
            base.list[1] = value;
        }
    }
} 
```

不过那不是好的设计……你为什么会有那个清单？你真正想做什么？

# java - 我如何在java中使用相同的输入调用不同供应商提供的多个Web服务

> ID：10918119
> 
> 赞同：0
> 
> 时间：2012-06-06T16:18:22.757
> 
> 标签：java, web-services, axis2

我是网络服务的新手。我的要求是在 java 类中使用相同的输入调用不同供应商提供的不同 web 服务。例如：天气信息由不同的供应商提供，所有供应商都将输入作为城市名称。我想在 java 类中调用一个方法，该方法并行调用不同供应商提供的所有 web 服务。然后我必须按供应商（所有供应商使用axis2）在jsp中显示结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:28:24.153

如果您有相同的输入，这应该不难。

假设您使用的是axis2 Java API，您可以执行以下操作：

```
public class Test {

    public static void main(String[] args) throws AxisFault,Exception {

        RPCServiceClient serviceClient = new RPCServiceClient();
        Options options = serviceClient.getOptions();

        String [] vendors = {"http://example.com/vendor1/services/GETWeatherHttpSoap12Endpoint", "http://example.com/vendor2/services/GETWeatherHttpSoap12Endpoint"}; // Array of all vendors

        for (String vendor : vendors) {
            EndpointReference targetEPR = new EndpointReference(vendor);
            options.setTo(targetEPR);
            QName opGetExchange = new QName("http://ws.apache.org/axis2", "getWeather");

            // preparing the parameters
            String country = "USA";
            Object[] opGetExchangeArgs = new Object[] {country};

            // preparing the return type
            Class[] returnTypes = new Class[] { String.class };

            // invoking the service passing in the arguments and getting the response
            Object[] response = serviceClient.invokeBlocking(opGetExchange, opGetExchangeArgs, returnTypes);
            // obtaining the data from the response
            String result = (String) response[0];

            System.out.println("Vendor: " + result);
        }
    }
} 
```

这会将每个供应商的结果打印在不同的行上。

# grails - 使用 Homebrew 安装 grails 1.3.7（或任何其他特定版本）

> ID：10918121
> 
> 赞同：8
> 
> 时间：2012-06-06T16:18:23.803
> 
> 标签：grails, homebrew

如何在 Homebrew 中安装特定版本的公式？- 就我而言；圣杯 1.3.7

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-06T17:04:04.333

## 更新：

正如akst所指出的，自制软件已删除该`versions`命令，因此这种原始方法不再可行。

如果你真的想要，你仍然可以使用`brew log grails`代替`brew versions grails`来查找旧版本 Grails 的 git SHA。该公式现在也位于更深的目录结构中，因此我建议使用`find . -name grails.rb -execdir git checkout <YOUR SHA HERE> {} \;`

但是，我建议使用出色的[SDKMAN！](http://sdkman.io/)用于管理 Grails 的版本（和其他语言/框架！）。

## 老答案：

去你的酿造基地，

```
cd $(brew --prefix) 
```

列出 grails 的版本，

```
brew versions grails 
```

选择你想要的版本（1.3.7）

```
git checkout 232acd0 $(brew --prefix)/Library/Formula/grails.rb 
```

现在像往常一样安装，

```
brew install grails 
```

它将安装版本 1.3.7

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T18:54:42.143

Rob Brinkman 提供了有关此方法的更多详细信息：http: [//blog.jdriven.com/2012/09/quick-tip-installing-a-specific-grails-version-on-os-x-using-homebrew/](http://blog.jdriven.com/2012/09/quick-tip-installing-a-specific-grails-version-on-os-x-using-homebrew/)

*在这里转述：*

```
brew unlink grails
brew versions grails
cd `brew --prefix` 
git checkout <some hash> <path to formula, i.e. /usr/local/Library/Formula/grails.rb>
brew install grails # install grails
git checkout -- /usr/local/Library/Formula/grails.rb # reset formula 
```

# python - 如何存储由 facebook-sdk 提供的用户，并且每个请求都没有一个电话

> ID：10918122
> 
> 赞同：2
> 
> 时间：2012-06-06T16:18:23.803
> 
> 标签：python, facebook, google-app-engine

我有以下代码（取自[facebook-sdk appengine 示例](https://github.com/pythonforfacebook/facebook-sdk/blob/master/examples/appengine/example.py#L48)）：

```
class BaseHandler(webapp2.RequestHandler):
    @property
    def current_user(self):
        if not hasattr(self, "_current_user"):
            self._current_user = None
            cookie = facebook.get_user_from_cookie(
                self.request.cookies, FACEBOOK_APP_ID, FACEBOOK_APP_SECRET)
            if cookie:
                user = User.get_by_key_name(cookie["uid"])
                if not user:
                    graph = facebook.GraphAPI(cookie["access_token"])
                    profile = graph.get_object("me")
                    user = User(key_name=str(profile["id"]), ...)
                    user.put()
                elif user.access_token != cookie["access_token"]:
                    user.access_token = cookie["access_token"]
                    user.put()
                self._current_user = user
        return self._current_user 
```

我有[问题 #23中描述的确切问题](https://github.com/pythonforfacebook/facebook-sdk/issues/23)

**项目中包含的 Google App Engine 示例对每个请求调用 get_user_from_cookie，现在它向 Facebook 发送请求。该示例应缓存返回的访问令牌，以免发生这种情况。**

我该如何解决这个问题？我担心的一个问题是，如果我将它们存储在会话中，我怎么知道访问令牌是有效的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:26:45.467

get_user_from_cookie 调用 facebook 以获取访问令牌，访问令牌可以在其到期期间被缓存（使用 memache）（您也可以在调用 facebook 获取访问令牌时获得到期）。

获取访问令牌的步骤应该是：

1.  检查它是否缓存在类（处理程序）级别。
2.  检查它是否缓存在 memache 中。
3.  从 facebook 中恢复，并缓存它（用于令牌的 duartion）
4.  如果由于过期而失败，请使用访问令牌检索它（并缓存它）。

# php - 供 URL 使用的 Codeigniter 过滤器输出

> ID：10918132
> 
> 赞同：2
> 
> 时间：2012-06-06T16:18:50.847
> 
> 标签：php, codeigniter

我可能想太多了，但是假设我在数据库上有一个网站字段。我使用 strip_tags 去除所有 HTML 标签。但是如果用户输入这个

javascript:alert('测试')

它会被传递，因为它是一个字符串。但随后，HTML 将生成

```
<a href="<?php echo prep_url($website);?>">Website</a> //the code in view file
<a href="javascript:alert('test')">Website</a> //bad 
```

如果单击，Javascript 将执行。还要注意 prep_url 不起作用。

有什么建议吗？我看过 HTMLPurifier，但它的尺寸很大，我真的不想做一些重大的改变。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:27:06.897

如果您期望一个 url，您不应该使用`strip_tags`，您应该验证该 URL 并且可能`urlencode`它。这是一种方法`filter_var`：

```
$url = "javascript:alert('test')";
var_dump(filter_var($url, FILTER_VALIDATE_URL));
// bool(false)

$url = "http://stackoverflow.com/questions/10918132";
var_dump(filter_var($url, FILTER_VALIDATE_URL));
// string(43) "http://stackoverflow.com/questions/10918132" 
```

所以如果`filter_var($user_input, FILTER_VALIDATE_URL)`是`FALSE`，不接受用户输入。这应该消除对 CI 的需求，`xss_clean()`尽管当您将其放在 HTML 属性中时，您可能仍想运行它。`prep_url`如果您不要求用户输入部件，您可能需要在验证之前运行输入`http://`。

验证 URL 的方法有很多种，只需选择您喜欢的一种即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:23:11.677

Codeigniter 有一个 xss 过滤器类。这不是世界上最好的东西，但它过滤了最常见的问题。[安全等级](http://codeigniter.com/user_guide/libraries/security.html)

您可以通过更改配置文件中的选项使 codeigniter 过滤所有 POST 和 GET，或者您可以通过这样做要求手动过滤。

```
$this->input->post('whatever',TRUE); //Note the TRUE 
```

# php - Error 403 in Codeigniter when sending text from CKEDITOR trough ajax

> ID：10918135
> 
> 赞同：1
> 
> 时间：2012-06-06T16:19:00.010
> 
> 标签：php, jquery, ajax, codeigniter, http-status-code-403

I'm using CKEDITOR and ajax to post news in a website I've created.

Everything works just fine, but apparently when I send text containing **style="display:none"**, for example, when posting I get a 403 error. It doesn't happen If I remove that line or change letters like **style="misplay:none"**

Here is my code

**PHP**

```
$title=$this->input->post('title');
$body=$this->input->post('body');
$published=$this->input->post('published');
$tags=$this->input->post('tags'); 
```

**Ajax call**

```
$.ajax({
    url: '/reviews_aj/addreviews',
    type: 'POST',
    data: {'title':title,'body':body,'published':published,'tags':tags},
    success: function(result){
         ...            

    }
}); 
```

The weirdest part is that the **addreviews** function is actually called but $_POST seems to be empty and a 403 error is returned.

This is what's being sent

```
id=18&title=asdasdas&body=style%3D%22display%3Anone%22&published=false&tags= 
```

**var_dump($_POST);** returns an empty array.

I've started to think that the problem is Jquery, somehow converting special chars the wrong way (and messing with the uri rerouting of Codeigniter. But I don't really know

**EDIT for @shershams** You asked me to try this.

```
var temp = {'title':title,'body':body,'published':published,'tags':tags}; 
console.log( JSON.stringify(temp, undefined, 4) ); 
```

This is the output

```
{
    "title": "style=\"display:none\"",
    "body": "<p>\n\tasdasd</p>\n",
    "published": false,
    "tags": ""
} 
```

Looks exactly to what I expected

EDIT:

Just noticed that sending it through a simple POST (not ajax, a simple form) wont work either.

EDIT:

style='display:none' with single quotes works, I don't control CKEDITOR's output though, it should work with both double and single quotes

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T07:17:58.390

根据您的评论，当“显示：无”时会出现问题

当一个元素显示为 none 时，它​​的行为总是奇怪和意外，它不会改变位置，不会在某些浏览器中返回 innerHTML，等等......

我假设这是因为浏览器随后将其转储到“无用的东西”箱中，并断开所有连接器的正常行为以节省内存/cpu 空间或其他东西。

尝试定位视口的绝对“外部”("position:absolute;top:-100px;left:-100px;") 并检查您的代码，然后检查其功能。

如果它无论如何都被隐藏了，那么它在页面上的位置并不重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T00:48:51.427

将双引号更改为单引号：D！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T10:54:14.567

我认为你应该使用`site_url()`. 不确定某些 url 会发生什么，例如`/foo/bar`.

这是[类似问题的答案](https://stackoverflow.com/a/10935321/700643)。试试看 ：）

```
<script type="text/javascript">
    var site_url = '<?php echo site_url(); ?>';
    var url = site_url + '/controller/action/param1/param2';
    // AJAX with url
</script> 
```

如果事情没有解决，请尝试检查您的日志。您可能会看到实际请求了哪个 url。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T04:41:20.700

像这样双重编码和发送呢？

```
<?php $string = urlencode(urlencode("style=\"display: none;\"";)) ?> 
```

然后通过 ajax 发送该编码字符串：

```
$.ajax({
    url: '/reviews_aj/addreviews/$string',
    type: 'POST'
}); 
```

在另一端，只需使用段解码：

```
$text = urldecode(urldecode($this->uri->segment(3))); 
```

# jsf - 在 JSF 中迭代和渲染嵌套树状对象结构的组件

> ID：10918137
> 
> 赞同：3
> 
> 时间：2012-06-06T16:19:08.997
> 
> 标签：jsf, collections, tree

给定下面的类定义：

```
public class Comment {

    String username;
    String comment;
    List<Comment> replies;

    // ...
} 
```

是否可以使用构造一个 JSF 页面来呈现包含在`Comment`树状结构中的实例中的数据，如下所示？

```
Comments
UserOne said
blah blah
----
    UserThree replied
    blah blah blah
    ----
    UserThree replied
    blah blah blah
----
UserTwo said
blah blah
----
UserOne said
blah blah 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T16:32:36.860

如果嵌套只有一层深度，或者具有固定数量的最大深度，那么您可以像往常一样嵌套 JSF 转发器组件，`<ui:repeat>`或者`<h:dataTable>`以通常的方式相互嵌套。

```
<ul>
    <ui:repeat value="#{bean.comments}" var="comment">
        <li>#{comment.username} #{comment.comment}
            <ul>
                <ui:repeat value="#{comment.replies}" var="reply">
                    <li>#{reply.username} #{reply.comment}</li>
                </ui:repeat>
            </ul>
        </li>
    </ui:repeat>
</ul> 
```

但是如果嵌套级别是“无限的”，那么您需要一个 JSF 组件来代替它来呈现树层次结构。这在标准 JSF 组件集中不可用。您需要查看[PrimeFaces](http://primefaces.org) [`<p:tree>`](http://www.primefaces.org/showcase/ui/data/tree/basic.xhtml)、[RichFaces](http://richfaces.jboss.org/) [`<rich:tree>`](http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=tree&skin=blueSky)或[OmniFaces](http://omnifaces.org) [`<o:tree>`](http://showcase.omnifaces.org/components/tree)等 3rd 方组件库。OmniFaces 允许您完全控制树标记，而对于其他人，您可能需要摆弄一些好的 CSS 以使其看起来像您想要的那样。

```
<o:tree value="#{bean.comments}" var="comment">
    <o:treeNode>
        <ul>
            <o:treeNodeItem>
                <li>#{comment.username} #{comment.comment}
                    <o:treeInsertChildren />
                </li>
            </o:treeNodeItem>
        </ul>
    </o:treeNode>
</o:tree> 
```

*为了清楚起见，我只想将`String comment`属性重命名为`message`orso `text`。*

如果您已经在使用 JSF 2.x，那么请考虑如下所示的`<my:comments comment="#{bean.comments}">` [复合组件。](https://stackoverflow.com/tags/composite-component/info)

```
<cc:interface componentType="commentsComposite">
    <cc:attribute name="comment" type="com.example.Comment" required="true" />
</cc:interface>
<cc:implementation>
    <c:if test="#{not empty cc.comment.replies}">
        <ul>
            <c:forEach items="#{cc.comment.replies}" var="comment" varStatus="loop">
                <li>
                    #{comment.username} #{comment.comment}
                    <my:comments comment="#{cc.parent.comment.replies[loop.index]}" />
                </li>
            </c:forEach>
        </ul>
    </c:if>
</cc:implementation> 
```

```
@FacesComponent("commentsComposite")
public class CommentsComposite extends UINamingContainer {

    private Comment comment;

    @Override
    public void setValueExpression(String name, ValueExpression expression) {
        if ("comment".equals(name)) {
            setComment((Comment) expression.getValue(getFacesContext().getELContext()));
        }
        else {
            super.setValueExpression(name, expression);
        }
    }

    public Comment getComment() {
        return comment;
    }

    public void setComment(Comment comment) {
        this.comment = comment;
    }

} 
```

另请参阅有关主题的博客，[复合组件的递归树](http://balusc.omnifaces.org/2016/02/recursive-tree-of-composite-components.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:34:46.790

您可以创建一个包装评论的新类。它将有一个注释和一个深度属性。

```
public CommentWithDepth {
   private Comment comment;
   private int depth;

   public CommentWithDepth(Comment comment, int depth) {
      this.comment = comment;
      this.depth = depth;
   }

   public Comment getComment() {
      return comment;
   }
   public int getDepth() {
      return depth;
   }
} 
```

然后创建一个 CommentWithDepth 列表，所有评论都按正确的顺序排列，属性 depth 是评论树的深度（0 表示基本级别，1 表示基本级别的子级，2 表示下一个，等等。 ）。

现在您可以使用 ui:repeat 来呈现此列表，使用 depth 属性来确定缩进。

# c# - How can I remove the "Today" button from DateTimePicker control (of Windows form Control)

> ID：10918138
> 
> 赞同：4
> 
> 时间：2012-06-06T16:19:09.590
> 
> 标签：c#, winforms, datetimepicker

In the DateTimePicker control, when we click the dropdown button , a calendar gets displayed . at the bottom of the calendar , there is a button : Today , which on being clicked , sets the present date as the selected date. I want to remove/hide that button from the control. How can I do it?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-06T20:11:05.057

本机 Windows DateTimePicker 控件支持 DTM_SETMCSTYLE 消息来设置月历的样式。创建控件并更改默认样式时，您只需要一点 pinvoke 即可发送消息。向您的项目添加一个新类并粘贴如下所示的代码。编译。将新控件从工具箱顶部拖放到表单上，替换旧控件。

```
using System;
using System.Windows.Forms;
using System.Runtime.InteropServices;

class MyDateTimePicker : DateTimePicker {
    protected override void OnHandleCreated(EventArgs e) {
        int style = (int)SendMessage(this.Handle, DTM_GETMCSTYLE, IntPtr.Zero, IntPtr.Zero);
        style |= MCS_NOTODAY | MCS_NOTODAYCIRCLE;
        SendMessage(this.Handle, DTM_SETMCSTYLE, IntPtr.Zero, (IntPtr)style);
        base.OnHandleCreated(e);
    }
    //pinvoke:
    private const int DTM_FIRST = 0x1000;
    private const int DTM_SETMCSTYLE = DTM_FIRST + 11;
    private const int DTM_GETMCSTYLE = DTM_FIRST + 12;
    private const int MCS_NOTODAYCIRCLE = 0x0008;
    private const int MCS_NOTODAY = 0x0010;

    [DllImport("user32.dll")]
    private static extern IntPtr SendMessage(IntPtr hWnd, int msg, IntPtr wp, IntPtr lp);
} 
```

它在运行时看起来像这样，在 Windows 7 上：

![在此处输入图像描述](../Images/d375eb51a6cb31f000ca27c86282979d.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T19:09:30.373

我似乎记得不久前想自己修改这个控件，然后发现这是不可能的。解决方案是构建您自己的自定义控件。

如果有帮助，我确实找到了这个[Show a custom calendar dropdown with a derived DateTimePicker class](https://stackoverflow.com/questions/2137997/show-a-custom-calendar-dropdown-with-a-derived-datetimepicker-class)，它链接到自定义 Winforms 日历[Culture Aware Month Calendar 和 DatePicker](http://www.codeproject.com/Articles/45684/Culture-Aware-Month-Calendar-and-Datepicker)。

# c# - Using an identical interface in different versions of a 3rd party interop library

> ID：10918141
> 
> 赞同：1
> 
> 时间：2012-06-06T16:19:22.250
> 
> 标签：c#, .net, interop, dry, autocad

We have an app where we switch between different versions of a 3rd party interop library (AutoCad). The subset of the interop API we use is the same across all versions of the interop library.

What would be the most effective way to reference different versions of the library while reusing the client code?

One approach is to use reflection: define a wrapper type for each of the used interop interfaces and use reflection inside the wrappers to load the interop type from the specified version of the interop assembly and just proxy every call to the interop object. This approach looks wasteful to me when all the interfaces in the used subset are exactly the same across all versions of the interop.

Other approach would be to reference different interop assemblies in different configurations of the project. With the identical interfaces across interop assemblies this should allow to compile different versions of the client assembly for each version of the interop assembly. One thing I'm not sure how to implement in this approach is configuring the project so that it builds all the versions of the client assembly at the same time to include them all in a single distribution.

It should be possible to employ code gen here as well, but I'm not sure how difficult it could be.

How would you solve this kind of problem?

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:48:07.533

对于低于 AutoCAD 2013 的版本，您实际上可以只引用一个互操作程序集并提供相同的输出程序集。AutoCAD 互操作程序集不是强签名的，不需要特定版本。多年来有一些 API 发生了变化，可以通过反射或引用正确互操作程序集的“子”程序集来解决。

AutoCAD 2013 显着改变了互操作库。您可以为每个配置引用不同的程序集，这需要手动编辑项目文件，因为您无法通过 gui 执行此操作，或者设置两个不同的项目，它们可以在同一个解决方案中，引用不同的程序集。您可以将文件从一个项目链接到另一个项目，以免重复文件。

我已经使用了这两种技术，哪种方法效果更好取决于具体情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T23:28:26.167

这取决于。如果您只调用 AutoCAD Interop 的少数接口，则使用反射或更高版本的绑定可能是一个不错的选择。这样，您就不必担心不同的 AutoCAD 版本、不同的 COM 引用等，因为您提到所有接口在您关注的所有 AutoCAD 版本中都是相同的。

如果有很多 COM 调用，您可能会发现反射或 COM 后期绑定非常繁琐且容易出错。这样，为不同的 AutoCAD 创建不同的构建似乎不是一个坏主意，尽管这些 COM 接口可能是相同的。就同​​时创建所有这些构建而言，可以将一些不同的项目配置生成到单个解决方案中，或者使用一些 MAKE 文件更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:50:35.403

我会采用您的第一种方法的修改版本。定义您自己的界面，这样您就可以随时引用它。有一个单独的实现来加载从构造函数传入的库。构造函数通过反射实例化互操作程序集对象的实例，并将其保存在私有成员字段中。实现对象的方法使用反射调用对象的方法。

# asp.net - Could not load file or assembly 'Microsoft.SqlServer.DTSRuntimeWrap'

> ID：10918142
> 
> 赞同：20
> 
> 时间：2012-06-06T16:19:24.503
> 
> 标签：asp.net, sql-server

I can't figure out why I'm getting this error when I run my application (MVC 3). The project has a reference to Microsoft.SQLServer.ManagedDTS. I have both SQL Server 2008 R2 and SQL Server 2012 (both Express) installed. I'm using 2012 with this application.

> Server Error in '/' Application.
> 
> Could not load file or assembly 'Microsoft.SqlServer.DTSRuntimeWrap' or one of its dependencies. An attempt was made to load a program with an incorrect format.
> 
> Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.
> 
> Exception Details: System.BadImageFormatException: Could not load file or assembly 'Microsoft.SqlServer.DTSRuntimeWrap' or one of its dependencies. An attempt was made to load a program with an incorrect format.

Source Error:

> An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.
> 
> Assembly Load Trace: The following information can be helpful to determine why the assembly 'Microsoft.SqlServer.DTSRuntimeWrap' could not be loaded.
> 
> WRN: Assembly binding logging is turned OFF. To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1\. Note: There is some performance penalty associated with assembly bind failure logging. To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog].

Stack Trace:

> [BadImageFormatException: Could not load file or assembly 'Microsoft.SqlServer.DTSRuntimeWrap' or one of its dependencies. An attempt was made to load a program with an incorrect format.]
> System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0
> System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks) +567
> System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +192 System.Reflection.Assembly.Load(String assemblyString) +35
> System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +123
> 
> [ConfigurationErrorsException: Could not load file or assembly 'Microsoft.SqlServer.DTSRuntimeWrap' or one of its dependencies. An attempt was made to load a program with an incorrect format.]
> System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +11568160
> System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +485 System.Web.Configuration.AssemblyInfo.get_AssemblyInternal() +79 System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +337
> System.Web.Compilation.BuildManager.CallPreStartInitMethods() +280
> System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException) +1167
> 
> [HttpException (0x80004005): Could not load file or assembly 'Microsoft.SqlServer.DTSRuntimeWrap' or one of its dependencies. An attempt was made to load a program with an incorrect format.]
> System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +11700896 System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +141 System.Web.HttpRuntime.ProcessRequestNotificationPrivate(IIS7WorkerRequest wr, HttpContext context) +4869125

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-27T20:30:47.137

如果这是 Web 应用程序的一部分，则需要从 IIS 的应用程序池中启用运行 32 位应用程序。这将解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:31:38.107

Microsoft.SqlServer.DTSRuntimeWrap.dll 可能不在[GAC](http://en.wikipedia.org/wiki/Global_Assembly_Cache)中，这意味着它必须被复制到您的 Web 应用程序的*bin*文件夹中或手动添加到您机器的 GAC 中（例如，使用 GACUTIL.exe）。您可能可以在`C:\Program Files (x86)\Microsoft SQL Server\100\SDK\Assemblies\`. 如果您从 Visual Studio 项目中类似的位置引用它，那么您可能只需在引用的属性中将选项设置为*Copy Local* to *True*。

请注意，此 DLL 可能不可再分发，因此您可能必须在运行应用程序的任何 Web 服务器上实际安装 SSIS，以免违反 SSIS 许可，但您必须验证这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-26T14:40:07.707

在我的情况下，在 IIS 中的“DefaultAppPool”上启用“允许 32 位应用程序”后，问题就解决了。

以下是执行此操作的步骤

1.  开放互联网信息服务
2.  转到应用程序池
3.  右键点击“DefaultAppPool”</li>
4.  选择高级设置
5.  将“启用 32 个应用程序”设置为 true
6.  点击确定
7.  回收应用程序池
8.  重新启动 IIS

# sql-server-2008 - t-sql i am transforming data

> ID：10918146
> 
> 赞同：1
> 
> 时间：2012-06-06T16:19:37.387
> 
> 标签：sql-server-2008, tsql

I am transforming data from this legacy table: **MovTime (IdMov INT, IdPerson NVARCHAR(20), Date1 datetime, Type1 nvarchar(30) )**

```
IdMov       IdPerson             Date1                   Type
----------- -------------------- ----------------------- ------------------------------
1           David                2012-06-01 09:00:00.000 Entered
2           David                2012-06-01 12:30:00.000 Exit
3           David                2012-06-01 14:00:00.000 Entered
4           David                2012-06-01 18:30:00.000 Exit
5           Kim                  2012-06-02 09:00:00.000 Entered
6           Kim                  2012-06-02 12:00:00.000 Exit 
```

... I want the result to be the following:

```
IdPerson     Data        Total Time
----------  ----------  ----------
David       2012-06-01   08:00:00 
Kim         2012-06-02   03:00:00 
```

T-SQL

```
declare @WK_TABLE TABLE (IdMov INT, IdPerson NVARCHAR(20), Date1 datetime, Type1 nvarchar(30)) 

Insert into @WK_TABLE values(1,'David', '2012-06-01 09:00', 'Entered')
Insert into @WK_TABLE values(2,'David', '2012-06-01 12:30', 'Exit')
Insert into @WK_TABLE values(3,'David', '2012-06-01 14:00', 'Entered')
Insert into @WK_TABLE values(4,'David', '2012-06-01 18:30', 'Exit')
Insert into @WK_TABLE values(5,'Kim', '2012-06-02 09:00', 'Entered')
Insert into @WK_TABLE values(6,'Kim', '2012-06-02 12:00', 'Exit')

select * from @WK_TABLE 
```

Can someone help me?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:38:27.507

假设任何班次都不能超过 24 小时（例如延长到第二天），并且有一些约束可以防止没有相应进入/退出的行：

```
;WITH x AS 
(
  SELECT IdPerson, Date1, Type1, rn = ROW_NUMBER() 
  OVER (PARTITION BY IdPerson ORDER BY Date1)
  FROM @WK_TABLE
)
SELECT 
  x.IdPerson, [Data] = CONVERT(DATE, x.Date1), 
  [Total Time] = CONVERT(TIME(0), DATEADD(MINUTE, 
    SUM(DATEDIFF(MINUTE, x.Date1, x2.Date1)), '00:00:00')) 
FROM x INNER JOIN x AS x2
ON x.IdPerson = x2.IdPerson 
AND x.rn = x2.rn - 1
AND x.TYpe1 = 'Entered' AND x2.type1 = 'Exit'
GROUP BY x.IdPerson, CONVERT(DATE, x.Date1)
ORDER BY [Data], IdPerson; 
```

# graph - 在 Labview 中绘制定向运动图形

> ID：10918148
> 
> 赞同：1
> 
> 时间：2012-06-06T16:19:43.020
> 
> 标签：graph, labview

我想知道是否可以在 Labview 中绘制定向运动图。也就是说，我正在尝试绘制操纵杆顶部的运动和它移动的方向，也许用箭头。

预先感谢您对此事的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-23T20:42:21.140

我不确定这是否是您要求的。然而，这就是我用箭头绘制一些东西的方式：

**代码作为截图：**

框图

[![框图](../Images/4a827b792dc430f33f104069dbcb9d52.png)](https://i.stack.imgur.com/mbet1.png)

前面板

[![前面板](../Images/230f3e2367fc8e841b7e5dcdf9263d7b.png)](https://i.stack.imgur.com/onj72.png)

**以文本形式解释的代码：**

*   前面板由“2D Compass”图形组成，可在 Modern/Graph/Compass Plot 下找到
*   为了创建绘图数据，我使用了两个双数组常量。一个用于箭头的角度，另一个用于箭头的长度。这两个常量连接到 Plot Helper vi，它会自动插入并与绘图指示器连接。

# android - Android - Download App

> ID：10918150
> 
> 赞同：1
> 
> 时间：2012-06-06T16:19:46.713
> 
> 标签：android, apk, code-signing

I'm attempting to create an unsigned internal test build of an application I'm writing, and I'm getting some strange errors.

I'm using Eclipse's Android Tools to generate an Unsigned APK, then attach it to our group wiki, at which point a user can click to download it, and attempt to install it, but it keeps erroring with:

`Application not installed`

LogCat reveals:

```
06-06 11:11:25.532: W/ActivityManager(1401): No content provider found for permission revoke: file:///mnt/sdcard/Download/2012-06-06-02-App-Name.apk
06-06 11:11:25.652: W/ActivityManager(1401): No content provider found for permission revoke: file:///mnt/sdcard/Download/2012-06-06-02-App-Name.apk
06-06 11:11:25.712: E/PackageParser(1401): Package com.site.appname has no certificates at entry res/anim/slide_in_1.xml; ignoring! 
```

I attempted deleting and recreating that XML file, but to no avail.

**EDIT:** Also, I have tried this on 3 different development devices, from Android 2.1 to 4.0, one with a custom ROM, all of which had previous builds, but I force stop / clear data / uninstalled them. Additionally I just created a new emulator, based on 4.0, x86, and it does the same thing.

**EDIT 2:** Signing it with a new key made it work, but I'd still like to know why it will not work unsigned.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T16:50:47.133

它只是操作系统中内置的一项安全功能。除非您正在运行 Android 的 userdebug 或 eng 版本，否则所有 APK 都必须使用某些东西（即使它是您的调试密钥）签名才能将它们安装在设备上。

默认情况下，模拟器正在运行 userdebug 构建，这就是为什么如果您之前尝试过，您可以在那里安装未签名的 APK。

# c++ - 在计算实验期间将结果写入文件的有效方法

> ID：10918156
> 
> 赞同：4
> 
> 时间：2012-06-06T16:20:16.273
> 
> 标签：c++, c, performance, file, file-io

我有一个执行一组实验的软件（C++）。如果不存储结果，所有实验都需要一分钟多一点的时间。生成的总数据量为 2.5 GB，太大了，无法在实验结束前存储在内存中，然后再写入文件。因此，我将它们分块编写。

```
for(int i = 0; i < chunkSize;i++){
    outfile << results_experiments[i] << endl;
} 
```

其中 ofstream outfile("data"); 并且 outfile 仅在最后关闭。

但是，当我将它们写入 4700 KB 的块（实际上是 4700/Chunksize = results_experiments 元素的大小）时，实验需要大约 50 倍的时间（超过一个小时......）。这是不可接受的，并且使我之前的优化尝试看起来相当愚蠢。特别是因为这些实验再次需要使用许多不同的参数设置等进行。（至少 100 次，但最好更多）

具体我的问题是：

*   理想的块大小是多少？

*   有没有比我目前写入数据的方式更有效的方式（或效率非常低的方式）？

基本上：帮助我尽可能少地引入文件 IO 开销..

我认为应该可以更快地完成此操作，因为复制（写入和读取！）生成的文件（相同大小）需要我不到一分钟的时间..

代码应该是完全独立于平台的，并且不使用任何（非标准）库（我可以为单独的平台提供单独的版本和更复杂的安装说明，但这很麻烦..）如果获得总实验时间不可行在 5 分钟内，没有平台/库依赖（并且可能有），我会认真考虑引入这些。（平台是windows，但至少应该有一个简单的linux端口）

感谢你的付出。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T16:24:08.207

对于初学者来说，不为每个块刷新缓冲区似乎是个好主意。似乎也可以异步执行 IO，因为它完全独立于计算。您还可以使用它`mmap`来提高文件 I/O 的性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T19:23:57.767

如果输出不必是人类可读的，那么您可以研究二进制格式。以二进制格式存储数据比文本格式占用更少的空间，因此需要更少的磁盘 i/o。但是如果数据都是字符串，那差别不大。因此，如果您尽可能多地写出数字而不是格式化文本，您可以获得很大的收益。

但是我不确定这是否/如何使用 STL iostreams 完成。C 风格的方式是使用`fopen(..., "wb")`and `fwrite(&object, ...)`。

我认为[boost::Serialisation](http://www.boost.org/doc/libs/1_49_0/libs/serialization/doc/index.html)可以使用`<<`运算符进行二进制输出。

另外，你能减少你写的数量吗？例如，没有格式或多余的文本，只是最低限度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:51:19.120

endl 在写入 ofstream 时是否刷新缓冲区取决于实现——

您也可以尝试增加 ofstream 的缓冲区大小

```
char *biggerbuffer = new char[512000];

  outfile.rdbuf()->pubsetbuf(biggerbuffer,512000); 
```

pubsetbuf 的可用性可能因您的 iostream 实现而异

# c# - How do I output console to multiple streams at once in C#?

> ID：10918157
> 
> 赞同：2
> 
> 时间：2012-06-06T16:20:16.460
> 
> 标签：c#, .net-4.0, stream

I have a program that takes the Console output and writes it to a logfile, however it no longer shows up in the console window. Is there a way to keep it in the window but write it to the log file as well?

**Update:**

```
appLogStream = new FileStream(logFile, FileMode.Append, FileAccess.Write, FileShare.Read);
TextWriter logtxtWriter = Console.Out;
logstrmWriter = new StreamWriter(appLogStream);
if(!console) Console.SetOut(logstrmWriter);
logstrmWriter.AutoFlush = true;
Console.WriteLine("Started at " + DateTime.Now); 
```

console is a constant set in the class. It basically tells it whether it is using the console window or not (readline is not called, etc, if not in console).

So is there a way to write to both the console and the file?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:21:46.627

您可以简单地读取该流日志并将其打印出来。

如果您将输出流分配给 outfile 的输入流，这在一定程度上取决于您的代码，如果您将内容读取到应该更容易一点的缓冲区，这可能会有点困难。

* * *

关于您的更新，我建议您`Console`使用自定义日志记录功能交换所有内容，例如 MyLogger 的实例（代码如下）。它将您的输出写入控制台和日志文件。

```
class MyLogger {
    private FileStream appLogStream;

    public MyLogger() {
        appLogStream = new FileStream(logFile, FileMode.Append, FileAccess.Write,
                                      FileShare.Read);
        appLogStream.WriteLine("Started at " + DateTime.Now);
    }

    public Write(string msg) {
        Console.Write(msg);
        appLogStream.Write(msg);
    }

    public WriteLine(string msg) {
        Console.WriteLine(msg);
        appLogStream.WriteLine(msg);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:32:02.367

我认为你可以这样做：

```
 public class ConsoleDecorator : TextWriter
{
    private TextWriter m_OriginalConsoleStream;

    public ConsoleDecorator(TextWriter consoleTextWriter)
    {
        m_OriginalConsoleStream = consoleTextWriter;
    }

    public override void WriteLine(string value)
    {
        m_OriginalConsoleStream.WriteLine(value);

        // Fire event here with value
    }

    public static void SetToConsole()
    {
        Console.SetOut(new ConsoleDecorator(Console.Out));
    }
} 
```

您必须通过调用 ConsoleDecorator.SetToConsole(); 来“注册”包装器；之后，每个 Console.WriteLine 调用都将到达自定义方法，您可以在那里触发事件并获取写入其他位置的文本（例如日志记录）。

如果您想使用这种方式，则必须使该类成为单例，然后您可以访问其他类的偶数注册（当偶数被触发时应该写入日志文件）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:34:54.093

当您调用 Console.SetOut 时，您指定 Console 应写入的位置。如果您没有（即通常使用 Console 的方式），并且您调用 Console.Write，它会检查它是否有输出写入器，如果没有，则将其设置为

```
 stream = OpenStandardOutput(256); 
```

接着

```
 Encoding encoding = Encoding.GetEncoding((int) Win32Native.GetConsoleOutputCP());
        writer = TextWriter.Synchronized(new StreamWriter(stream, encoding, 256, false) { HaveWrittenPreamble = true, AutoFlush = true }); 
```

所以你应该能够做你现在正在做的事情，如果你还想将所有内容都回显到标准输出，就好像你没有重定向控制台一样，你可以使用你自己使用`Console.OpenStandardOutput`方法打开的流来创建自己的编写器。该`Win32Native`代码中使用的 是内部的，因此您无权访问它，但您可以使用`Console.OutputEncoding`来检索它正在使用的编码。

您还可以尝试`Console.Out`在调用 SetOut 之前使用该属性获取并挂起标准输出 TextWriter。然后你可以用它来回显到标准输出。

# sharepoint - Sharepoint list permission for user to read,create but can only edit their own

> ID：10918159
> 
> 赞同：0
> 
> 时间：2012-06-06T16:20:21.197
> 
> 标签：sharepoint, sharepoint-list, sharepointfoundation2010, sharepoint-security

I'm trying to allow the user to edit their own list item in Sharepoint Foundation 2010,

1.  Open the list that you want to configure.
2.  On the Settings menu, click List Settings.
3.  On the Customize page, in the General Settings column, click Advanced settings.
4.  On the List Advanced Settings page, in the Item-level Permissions section

On my particular list this setting is missing, so I opened a powershell window to do the equivalent

```
$web = Get-SPWeb YourSite/
$list = $web.Lists["List name"]
$list.WriteSecurity
1
$list.WriteSecurity = 2
$list.Update()
$list.WriteSecurity
1 
```

It does not change to 2 and there is no error. There must be something about this list that makes it different, but I can't find out what it is.

# xcode - TWRequest from a dictionary in a tableView Cell

> ID：10918160
> 
> 赞同：0
> 
> 时间：2012-06-06T16:20:25.013
> 
> 标签：xcode, uitableview, twrequest

I am trying to propagate a table view with a custom cell with the results of a TWRequest with no luck. I am trying to store the tweets in a dictionary object then calling an ObjectAtKey request and putting into a string. Here is my code - any help would be appreciated. Thanks -

```
-(void)fetchTweets
{
    // Do a simple search, using the Twitter API
    TWRequest *request = [[TWRequest alloc] initWithURL:[NSURL URLWithString:
                                                         @"http://search.twitter.com/search.json?q=iOS%205&rpp=5&with_twitter_user_id=true&result_type=recent"] 
                                             parameters:nil requestMethod:TWRequestMethodGET];

    // Notice this is a block, it is the handler to process the response
    [request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error)
    {
        if ([urlResponse statusCode] == 200) 
        {
            // The response from Twitter is in JSON format
            // Move the response into a dictionary and print
            NSError *error;        
            NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:responseData options:0 error:&error];
            NSLog(@"Twitter response: %@", dict);                           
        }
        else
            NSLog(@"Twitter error, HTTP response: %i", [urlResponse statusCode]);
    }];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return tweets.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"cell";
    CustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {

        cell = [[CustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

    }  

    NSString *tweetText = [dict objectForKey:@"text"];
    NSArray *tweetComponents = [tweetText componentsSeparatedByString:@":"]; 

    cell.Header.text = [tweetComponents objectAtIndex:0];
    cell.Details.text = [tweetComponents objectAtIndex:1];
    cell.Date.text = [tweetComponents objectAtIndex:2];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T00:28:29.737

您将需要从 Twitter 响应中创建推文的 NSMutableArray。每条推文都是一个单独的对象。

```
NSMutableArray *resultArray = [[NSMutableArray] alloc] init];
for (NSDictionary *tweet in dict)
{
     [resultArray addObject:tweet];
} 
```

然后`cellForRowAtIndexPath`根据表的行检索对象，例如

`TweetResult *tweetResult [resultArray objectAtIndex:[indexPath row]];`

# python - PyDBG Python 2.7 错误：“TypeError：‘模块’对象不可调用”

> ID：10918162
> 
> 赞同：1
> 
> 时间：2012-06-06T16:20:33.023
> 
> 标签：python, pydbg

我正在尝试将 PyDBG 与 Python 2.7 一起使用。我相信它安装正确。

```
import pydbg
dbg = pydbg() 
```

运行时产生错误：

```
Traceback (most recent call last):
File "[path removed..]\pydbg.py", line 1, in <module>
import pydbg
File "[path removed..]\pydbg.py", line 5, in <module>
dbg = pydbg()
TypeError: 'module' object is not callable 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:22:59.037

试试这个：

```
from pydbg import pydbg
dbg = pydbg() 
```

通常，您应该在调用其任何成员*之前*添加导入模块的名称：

```
import pydbg
dbg = pydbg.pydbg() 
```

**编辑 ：**

此外，请确保包含您的脚本的文件*未*命名`pydbg.py`，因为它会与您尝试导入的模块的名称冲突。事实证明，这就是问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:21:27.260

你可能必须这样做：

```
 dbg = pydbg.pydbg() 
```

除非您专门从 pydbg 导入 pydbg

```
 from pydbg import pydbg 
```

我更喜欢前者。

# javadoc - Gradle javadoc doclet。找不到 doclet

> ID：10918169
> 
> 赞同：4
> 
> 时间：2012-06-06T16:21:02.377
> 
> 标签：javadoc, gradle, doclet

我是 Gradle 的新手，我正在尝试将我自己和美丽的 doclet 与 gradle 一起使用。我做了下一个任务：

```
task myDoclet(type: Javadoc, dependsOn: myJavadocs) {
source = sourceSets.main.allJava
options.doclet = "com.myproject.webservice.doclets.Doclet2"
classpath = configurations.compile  } 
```

有了这个，我总是成为下一个错误：

```
javadoc: error - Cannot find doclet class com.myproject.webservice.doclets.Doclet2 
```

我知道有一个 options.docletpath ，它应该是我的 doclet 的路径（但是...... src 或类？），但由于缺乏解释，我无法理解我应该放在那里[文档](http://gradle.org/docs/current/javadoc/org/gradle/external/javadoc/MinimalJavadocOptions.html#docletpath%28java.io.File...%29)

谁能解释我如何正确设置 doclet 的路径，以便它找到我漂亮的 doclet？

谢谢你的时间！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T09:09:20.747

docletpath 指定 doclet 起始类文件的路径。这可以是 jar 的路径（包含类文件）或指向类文件所在的目录。[在http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/javadoc.html#docletpath](http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/javadoc.html#docletpath)查看有关 doclet 类路径的 javadoc 文档

希望有帮助，问候， René

# javascript - 让第三方 JavaScript 访问全局变量

> ID：10918173
> 
> 赞同：1
> 
> 时间：2012-06-06T16:21:19.470
> 
> 标签：javascript, api, security

我正在为非程序员创建一个 API，以便为虚拟多人战斗机器人竞技场编写第三方代码。使用全局变量的语法会很好：

```
function Step() {
    if (sensor.wall) {
        movement.brake();
        movement.turnLeft();
    }
    if (sensor.enemy) {
        movement.shoot()
    }
    if (movement.speed < 1)  {
        movement.accelerate(.1);
    }
} 
```

上例中的全局变量是`sensor`and `movement`。剧本作者不在乎它们来自哪里，只关心它们是可访问的。（不，这不是最终的语法。这里只是原型。）

脚本将在客户端（浏览器）和服务器（通过 Node 或 Spidermonkey）上运行。

那么，如何做到这一点呢？看来我的选择是：

*   在词法上设置所有全局变量然后`eval()`是脚本（但这很糟糕，对吧？）
*   在全局范围内设置所有全局变量，然后正常运行脚本（但是 DOM 全局变量呢，比如`window`？）

我可能可以使用[Google Caja](http://code.google.com/p/google-caja/)来保护全局范围。我也希望这是高性能的，因为许多`Step()`功能将在同一台服务器上每秒运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:05:28.087

由于用户脚本是作为文本接收的，我不关心限制对`document`,`window`等的访问（这是一个私有应用程序），`eval()`ing 是最好的选择。

```
function evaluateScript(movement, sensor, content) {
    return eval(content);
} 
```

# asp.net - 如何在 Visual Studio 2010 中从网站创建解决方案文件 (.sln)

> ID：10918175
> 
> 赞同：4
> 
> 时间：2012-06-06T16:21:21.220
> 
> 标签：asp.net, .net, visual-studio-2010, visual-studio

我将在这里使用 Visual Studio 术语...

我有一个网站，位于`/Visual Studio 2010/Projects/My Project/Code/WebSite`.

我想为此网站创建一个解决方案文件 (.sln) 文件，该文件位于`/Visual Studio 2010/Projects/My Project/`.

有没有一种简单的方法可以从网站创建解决方案文件，并指定它所在的目录？还是我需要采取其他步骤...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T18:53:28.027

注意：以下适用于网站项目，而不是 Web 应用程序项目。WSP 在 Visual Studio 项目中有点独特，因为它们没有项目文件，所有项目设置都存储在解决方案文件中。

可能有两种方法可以做到这一点：

1.  在所需的文件夹中创建一个新的空解决方案。然后只需添加现有网站，将其指向您的网站文件夹，就可以了！您可能需要为您的网站自定义一些设置以匹配您之前的设置。
2.  如果您已经有一个现有的解决方案文件（您可能在磁盘的某个位置进行），您可以将它移动到您想要的路径，然后更新网站的相对文件路径。对于网站项目，解决方案文件的内容将如下所示：

    ```
    Project("{E24C65DC-7377-472B-9ABA-BC803B73C61A}") = "WebSite1", "..\..\WebSites\WebSite1\", "{AB75CF01-6B54-4BB1-A14A-01A26727FEF2}"
        ProjectSection(WebsiteProperties) = preProject
            TargetFrameworkMoniker = ".NETFramework,Version%3Dv4.0"
            Debug.AspNetCompiler.VirtualPath = "/WebSite1"
            Debug.AspNetCompiler.PhysicalPath = "..\..\WebSites\WebSite1\"
            Debug.AspNetCompiler.TargetPath = "PrecompiledWeb\WebSite1\"
            ... snip ...
            Release.AspNetCompiler.VirtualPath = "/WebSite1"
            Release.AspNetCompiler.PhysicalPath = "..\..\WebSites\WebSite1\"
            Release.AspNetCompiler.TargetPath = "PrecompiledWeb\WebSite1\"
            ... snip ...
            VWDPort = "47656"
            DefaultWebSiteLanguage = "Visual C#"
        EndProjectSection
    EndProject 
    ```

    您可以看到网站实际所在文件夹的相对路径。

# grails - 使用 g:each 引用另一个表中的值

> ID：10918183
> 
> 赞同：0
> 
> 时间：2012-06-06T16:21:43.693
> 
> 标签：grails

使用 Grails，我使用`<g:each />`标签在视图中循环遍历数组，但是我想在同一个循环中使用数组中的值作为对数据库中另一个表中的外键的引用。

是否可以创建对其他表的变量引用字符串？例如：

```
${productId.Users.UserId} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:07:43.510

如果我正确理解你的问题，你想做类似的事情......

```
//Assuming this is the list to run through your <g:each>
def list = ['userId1', 'userId2', 'userId3'] 
```

并假设上面列表的值是您喜欢的某个表或数据模型的某些属性...

```
def model = [
  userId1: 'John Doe',
  userId2: 'Jane Doe',
  userId3: 'Jack Doe'
] 
```

如果以上是您正在考虑的场景，那么您应该能够做这样的事情......

```
<g:each in="${list}" var="element">
   ${model[element]}
</g:each>

//output
John Doe
Jane Doe
Jack Doe 
```

# php - Zend Auth 重定向插件与 AJAX

> ID：10918189
> 
> 赞同：0
> 
> 时间：2012-06-06T16:22:20.843
> 
> 标签：php, ajax, zend-framework, zend-auth

有没有办法让插件在通过 AJAX 请求调用时重定向整个页面？

这是我用来将未经身份验证的用户重定向到登录页面的代码。

```
public function dispatchLoopStartup(Zend_Controller_Request_Abstract $request) {
    if ($request->getControllerName() != 'authentication') {
        if (!Zend_Auth::getInstance()->hasIdentity()) {
            $request->setControllerName('authentication');
            $request->setActionName('login');
            return;
        }
    }
} 
```

这适用于正常请求，但我希望它在用户注销后发出 AJAX 请求时将用户重定向到登录页面。使用我现在拥有的内容，它会在 HTML 元素中加载登录页面的 HTML，该元素被指定用于存放 AJAX 请求的结果。

如何让它将浏览器重定向到登录页面，而不仅仅是在当前页面中加载登录页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:27:37.433

好吧，如果我理解正确的话。draw010 是正确的，ajax 调用是不同的 http 请求，而不是用户实际看到并与之交互的请求。因此，如果不使用 javascript，php 就无法从一个 http 连接跳转到另一个连接并执行重定向。PHP 不是一种“主动”语言，而是一种“反应性”语言。这意味着在页面加载/刷新之前它不会做任何事情。

但是，如果您想通过 ajax 或不通过 ajax 处理重定向，则它是您重定向的发起者。因为这实际上是调用触发您想要的整个过程的原因。

# java - 使用java识别mp3末尾的静音

> ID：10918200
> 
> 赞同：1
> 
> 时间：2012-06-06T16:22:57.723
> 
> 标签：java, audio, javasound, audio-analysis

尝试在 mp3 格式的音频末尾检测静音，所有格式都会有用，但 mp3 格式是最重要的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T17:21:07.570

我知道在声音剪辑结束时可靠地检测静音的唯一方法是将其转换为 PCM 格式并执行以下计算之一，检查某个最小截止幅度。

*   [分贝](http://en.wikipedia.org/wiki/Decibel)(dB)
*   [均方根](http://en.wikipedia.org/wiki/Root_mean_square)(RMS)

我从未设法实现 dB，但 RMS 相对简单，应该适用于此用途。我将它用于在 DukeBox 播放器的跟踪区域左下方/右下方看到的小条。

![杜克盒子截图](../Images/4951594bc5da1614048710b9bacd4c2d.png)

至于如何使用 MP3 格式执行任何操作，请参阅[Java Sound 信息中的详细信息。页](https://stackoverflow.com/tags/javasound/info)。

# c++ - C++ 的跨平台睡眠功能

> ID：10918206
> 
> 赞同：46
> 
> 时间：2012-06-06T16:23:17.947
> 
> 标签：c++, cross-platform, sleep

宏是否可以制作跨平台睡眠代码？例如

```
#ifdef LINUX
#include <header_for_linux_sleep_function.h>
#endif
#ifdef WINDOWS
#include <header_for_windows_sleep_function.h>
#endif
...
Sleep(miliseconds);
... 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-06-30T18:18:12.617

是的。但这仅适用于[C++11](http://en.wikipedia.org/wiki/C%2B%2B11)及[更高版本](http://en.wikipedia.org/wiki/C%2B%2B14)。

```
#include <chrono>
#include <thread>
...
std::this_thread::sleep_for(std::chrono::milliseconds(ms)); 
```

哪里`ms`是你想睡觉的时间，以毫秒为单位。

您也可以替换`milliseconds`为`nanoseconds`、`microseconds`、`seconds`、`minutes`或`hours`。（这些是[std::chrono::duration](http://en.cppreference.com/w/cpp/chrono/duration)类型的特化。）

**更新：**在[C++14](http://en.wikipedia.org/wiki/C%2B%2B14)中，如果你正在睡觉一段时间，例如 100 毫秒，`std::chrono::milliseconds(100)`可以写成`100ms`. 这是由于[C++11](http://en.wikipedia.org/wiki/C%2B%2B11)中引入的[用户定义的文字](http://en.cppreference.com/w/cpp/language/user_literal)。在[C++14](http://en.wikipedia.org/wiki/C%2B%2B14)中，该库已扩展为包含以下用户定义的文字：`chrono`

*   [`std::literals::chrono_literals::operator""h`](http://en.cppreference.com/w/cpp/chrono/operator%22%22h)
*   [`std::literals::chrono_literals::operator""min`](http://en.cppreference.com/w/cpp/chrono/operator%22%22min)
*   [`std::literals::chrono_literals::operator""s`](http://en.cppreference.com/w/cpp/chrono/operator%22%22s)
*   [`std::literals::chrono_literals::operator""ms`](http://en.cppreference.com/w/cpp/chrono/operator%22%22ms)
*   [`std::literals::chrono_literals::operator""us`](http://en.cppreference.com/w/cpp/chrono/operator%22%22us)
*   [`std::literals::chrono_literals::operator""ns`](http://en.cppreference.com/w/cpp/chrono/operator%22%22ns)

实际上这意味着你可以写这样的东西。

```
#include <chrono>
#include <thread>
using namespace std::literals::chrono_literals;

std::this_thread::sleep_for(100ms); 
```

请注意，虽然`using namespace std::literals::chrono_literals`提供了最少的[命名空间污染](https://softwareengineering.stackexchange.com/questions/236404/what-is-using-namespace-pollution)`using namespace std::literals`，但这些运算符在或时也可用`using namespace std::chrono`。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-06-06T16:38:08.153

就在这里。您所做的是将不同的系统睡眠调用包装在您自己的函数中，以及如下的包含语句：

```
#ifdef LINUX
#include <unistd.h>
#endif
#ifdef WINDOWS
#include <windows.h>
#endif

void mySleep(int sleepMs)
{
#ifdef LINUX
    usleep(sleepMs * 1000);   // usleep takes sleep time in us (1 millionth of a second)
#endif
#ifdef WINDOWS
    Sleep(sleepMs);
#endif
} 
```

然后你的代码调用`mySleep`睡眠而不是直接进行系统调用。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2013-04-07T10:46:59.497

shf301 有一个好主意，但这种方式更好：

```
#ifdef _WINDOWS
#include <windows.h>
#else
#include <unistd.h>
#define Sleep(x) usleep((x)*1000)
#endif 
```

然后像这样使用：

```
Sleep(how_many_milliseconds); 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-06-06T16:33:50.347

获得[升压](http://www.boost.org/doc/libs/1_49_0/)。

```
#include <boost/thread/thread.hpp>
#include <boost/date_time/posix_time/posix_time.hpp>
...
boost::this_thread::sleep(boost::posix_time::millisec(milliseconds)); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-06-06T16:41:36.577

常用的解决方案是 select() 调用（需要 Winsock）。此特定调用在 Linux 和 Windows 上具有完全相同的行为。

```
long value; /* time in microseconds */

struct timeval tv;
tv.tv_sec = value / 1000000;
tv.tv_usec = value % 1000000;
select(0, NULL, NULL, NULL, &tf); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-07T08:50:15.530

在 linux 中，请记住 usleep 有一个限制。您的“睡眠”时间不能超过 1000 秒。

我会这样写

```
struct timespec req={0},rem={0};
req.tv_sec=(milisec/1000);
req.tv_nsec=(milisec - req.tv_sec*1000)*1000000;
nanosleep(&req,&rem); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-15T10:13:27.560

从 c++ 11 开始，你可以这样做。

```
#include<chrono>
#include<thread>
int main(){
    std::this_thread::sleep_for(std::chrono::milliseconds(x));//sleeps for x milliseconds
    std::this_thread::sleep_for(std::chrono::seconds(x));//sleeps for x seconds  
    std::this_thread::sleep_for(std::chrono::minutes(x));//sleeps for x minutes
    std::this_thread::sleep_for(std::chrono::hours(x));//sleeps for x hours.
  return 0;  
} 
```

我不知道当你能做到这一点时你为什么要使用凌乱的宏，这种方法很棒，跨平台并且包含在 c++ 标准中。

# ruby-on-rails - 活动管理员：包括 Javascript

> ID：10918213
> 
> 赞同：12
> 
> 时间：2012-06-06T16:23:28.157
> 
> 标签：ruby-on-rails, layout, activeadmin

我想将 Gon ( [https://github.com/gazay/gon](https://github.com/gazay/gon) ) 添加到我的 activeadmin

但我需要添加该行

```
<%= include_gon %> 
```

到布局中的头部

但我不知道怎么做？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-02T16:24:58.990

添加到 Mexxer 的评论中。转到`config/initializers/active_admin.rb

在页面底部，您会发现以下内容：

```
# == Register Stylesheets & Javascripts
#
# We recommend using the built in Active Admin layout and loading
# up your own stylesheets / javascripts to customize the look
# and feel.
#
# To load a stylesheet:
#   config.register_stylesheet 'my_stylesheet.css'
#
# To load a javascript file:
#   config.register_javascript 'my_javascript.js' 
```

取消注释最后一行并将 my_javascript.js 替换为您的文件，如下所示...

```
# To load a javascript file:
config.register_javascript 'invoices.js' 
```

该文件可以位于`app/assets/javascripts/invoices.js`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-09-24T10:26:16.953

这也可能是相关的：

```
# The Active Admin equivalent of putting this in your application layout:
# <head>
#   <%= cloudinary_js_config %>
# </head>

module ActiveAdmin
  module Views
    module Pages
      class Base < Arbre::HTML::Document

        alias_method :original_build_head, :build_active_admin_head

        def build_active_admin_head
          original_build_head

          within @head do
            text_node include_gon
          end
        end

      end
    end
  end
end 
```

来源：[https ://gist.github.com/seanlinsley/9786622](https://gist.github.com/seanlinsley/9786622)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-12-13T12:47:48.287

register_javascript 配置将在 V2 中弃用。

因此`config/initializers/active_admin.rb`，您可以更改 `assets/javascripts/active_admin.js，而不是更改，只需将 .js 的名称文件放在

```
//= require active_admin/base
//= require activeadmin_addons/all
//= require masks 
```

此文件位于 assets 文件夹内，如 mask.js

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-17T14:48:35.970

```
Rails.application.config.after_initialize do
  javascripts = [] 
  javascripts << "//maps.googleapis.com/maps/api/js?sensor=false&key="
  javascripts += ActiveAdmin.application.javascripts.to_a
  ActiveAdmin.application.javascripts.replace javascripts
end 
```

[https://github.com/activeadmin/activeadmin/issues/340#issuecomment-92512556](https://github.com/activeadmin/activeadmin/issues/340#issuecomment-92512556)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-01T22:07:58.113

如今有

```
active_admin_namespace.head 
```

很方便。不要忘记**html_safe**连接字符串。

# dotnetopenauth - 当 IsAuthorizationValid 返回 false 时获取 invalid_request

> ID：10918215
> 
> 赞同：0
> 
> 时间：2012-06-06T16:23:36.813
> 
> 标签：dotnetopenauth

每当我的 IAuthorizationServer 实现中的 IsAuthorizationValid 方法返回 false 时，AuthorizationServer.HandleTokenRequest 都会给我一个 invalid_request 响应。我期待像 invalid_scope 或 authorization_expired 之类的东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T05:28:38.637

OAuth 2 错误代码未在 DotNetOpenAuth v4.0.x 中正确实现。v4.1 对其进行了显着改进，但尚未发布。

# c# - 同步两个列表框

> ID：10918218
> 
> 赞同：0
> 
> 时间：2012-06-06T16:23:58.040
> 
> 标签：c#, silverlight, windows-phone-7, windows-phone-7.1

我有一个布局，其中有两个列表框，我试图使它们同步，并在网上找到了一些教程，例如[http://www.software-architects.com/TechnicalArticles/ScrollSync/tabid/101/Default.aspx](http://www.software-architects.com/TechnicalArticles/ScrollSync/tabid/101/Default.aspx)或[Listboxes ，同步滚动，](https://stackoverflow.com/questions/2025402/listboxes-scrolling-in-sync)但它们似乎无法在 WP7 SDK 下工作，因为缺少事件或属性。有没有人解决了在 windows phone 7 下同步两个或多个列表框的问题？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:31:45.477

在这个问题中查看我的答案：[WP7 ScrollViewer programatically scroll a background ScrollViewer in sync with front ScrollViewer](https://stackoverflow.com/questions/10790357/wp7-scrollviewer-programatically-scroll-a-background-scrollviewer-in-sync-with-f/10790812#10790812)

您将能够使滚动查看器保持同步，但它可能不流畅，因为 WP7 滚动查看器没有 Scroll 事件。

要获取由 ListBox 生成的 ScrollViewer，请使用 ColinE [WP7 的此解决方案 - 在外部 ScrollViewer 中滚动 ListBox](https://stackoverflow.com/questions/4611185/wp7-scrolling-listbox-in-external-scrollviewer)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T02:29:53.840

我想出了一个使用 Silverlight Toolkit for Wp7 提供的 WarpPanel 的解决方案

```
 <ListBox Height="350" HorizontalAlignment="Left" Margin="102,72,0,0" Name="lsScore" VerticalAlignment="Top" Width="450" HorizontalContentAlignment="Center">
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <toolkit:WrapPanel ItemWidth="220" ItemHeight="50"/>
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
        </ListBox> 
```

该解决方案使用一个总是同步的列表框，为了分离数据并对齐它们，我使用 ItemWidth 这就是它具有如此高值的原因。如果您知道任何其他在不使用 ItemWidth 属性的情况下分隔数据的方法，请随时添加答案。提前致谢。

# c# - C# - 使用 DataRow 从行中获取记录

> ID：10918222
> 
> 赞同：0
> 
> 时间：2012-06-06T16:24:33.870
> 
> 标签：c#, row, record, datarow

我正在尝试使用 DataRow 获取一行的记录。这是我到目前为止所做的：

```
 uID = int.Parse(Request.QueryString["id"]);
 PhotoDataSetTableAdapters.MembersTableAdapter mem = new PhotoDataSetTableAdapters.MembersTableAdapter();
 PhotoDataSet.MembersDataTable memTable = mem.GetMemberByID(uID);
 DataRow[] dr = memTable.Select("userID = uID");
 string uName = dr["username"].ToString(); 
```

然后我得到了错误：

> 无法将类型“string”隐式转换为“int”

错误指向`"username"`。我不知道出了什么问题，因为我只是想将一个字符串变量分配给一个字符串值。有人弄清楚错误的原因吗？请帮助和感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T16:27:22.353

更改以下语句

```
DataRow[] dr = memTable.Select("userID = uID"); 
```

至

```
DataRow[] dr = memTable.Select("userID = "+ uID); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T16:27:45.053

`dr`is a `DataRow[]`not a `DataRow`，因此编译器抱怨你在他需要`int`索引时传递了一个 String 。

您实际上想要单曲的用户名，`DataRow`对`DataTable`吗？

```
String uName = memTable.AsEnumerable().Single().Field<String>("username"); 
```

请注意，如果`DataTable`. 但是由于您将 ID 传递给`DataAdapter`，我假设它应该只返回一条记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T16:35:47.820

似乎有两个问题。一个是 Asif 建议 uID 应该是“userId =” + uID（可能应该将 uID 转换为字符串），并且正如 Tim 指出的那样， dr 是一个数据行数组。您也可以通过索引访问它： dr[0]["userName"].ToString()

# git - 如何在 gitolite2 中使分支只读？

> ID：10918225
> 
> 赞同：1
> 
> 时间：2012-06-06T16:24:50.477
> 
> 标签：git, configuration, authorization, gitolite

如何在 gitolite v2 中以只读方式声明分支？

我目前的配置是：

```
@group1 = user1 user2
@group2 = user3

repo xxx
    R          = @group1  # should make everything readonly per default
    RW  fix    = @group1  # this can be pushed and created
    RW+        = @group2  # for the admin 
```

但是每个人都可以到处推。

* * *

还有 2 个案例 - 作为用户 2，我被锁在这里（什么是正确的）：

```
repo xxx
    R          = @group1  # should make everything readonly per default
    RW+        = @group2  # for the admin 
```

现在我可以推送*master*，这不应该是：

```
repo xxx
    R          = @group1  # should make everything readonly per default
    RW  fix    = @group1  # this can be pushed and created
    RW+        = @group2  # for the admin 
```

我用*^refs/heads/fix替换了**fix* ，但这并没有改变。

# java - 以编程方式居中 WebView

> ID：10918226
> 
> 赞同：0
> 
> 时间：2012-06-06T16:24:54.350
> 
> 标签：java, android, layout, webview

我正在基于从服务器接收到的 JSON 以编程方式创建我的控件。我需要创建的控件之一`WebView`是在屏幕上水平居中的控件。这在 xml 布局中很简单，如下所示，使用 layout_gravity 选项。但是你如何在代码中做到这一点，就像没有方法`WebView`一样。`TextView``setGravity(Gravity.HORIZONTAL_GRAVITY_MASK)`

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<WebView 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"/>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:30:32.020

我会使用RelativeLayout，然后您可以在添加视图时使用LayoutParams：

```
RelativeLayout.LayoutParams layoutParams= new RelativeLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT);
layoutParams.addRule(RelativeLayout.CENTER_IN_PARENT, 1);
relativeLayout.addView(yourWebView, layoutParams); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:55:11.627

我使用 LinearLayout 来显示 webview 和 setGravity。

```
 LinearLayout linearLayout = new LinearLayout(this);
    linearLayout.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,
            LayoutParams.FILL_PARENT));
    linearLayout.setGravity(Gravity.CENTER);
    WebView view = new WebView(this);
    linearLayout.addView(view);
    setContentView(linearLayout); 
```

它可以帮助你。

# javascript - Javascript：在该对象中调用对象方法

> ID：10918228
> 
> 赞同：29
> 
> 时间：2012-06-06T16:25:12.100
> 
> 标签：javascript, oop, methods

实现以下目标的最佳设计模式是什么（不起作用）？

```
var obj = (function() {

  // code defining private variables and methods

  var _obj = {
    property: value,
    method1: function() {
      // do stuff
    },
    method2: function() {
      // use property
      var prop = _obj.property; // obviously doesn't work
      // call method1
      obj.method1(); // "obj" not finished being defined yet!
    }
  };

  // obviously now I could do...
  var prop = _obj.property;

  return _obj;

})();

// and I could now do...
obj.method1(); 
```

我认为应该起作用的变体是

```
var obj = (function() {

  var property = value,
      method1 = function() {
        // do stuff
      },
      method2 = function() {
        // use property
        var prop = property;
        // call method1
        method1();
      },
      _obj = {
        property: property,
        method1: method1,
        method2: method2
      };

  return _obj;

})(); 
```

类似地，它对于打算用操作符创建的对象是如何工作的`new`？在构造函数本身中，您可以编写`this.method()`. 但是如果你想保持构造函数很小，只定义那些可能在创建时定制的东西，然后在原型中定义其余的东西呢？（这似乎是常见的模式。）原型中的属性/方法可以以任何方式交互吗？

```
var MyObj = function(name) {
  this.name = name;
};

var obj = new MyObj('Bob');

MyObj.prototype = {
  called_often: function() {
    // lots more code than just the following
    return document.getElementById('someID').value;
  },

  global_default: 'value', // can be changed, so need to pull value when run

  does_stuff: function(value) {
    var str = global_default + value, // can't access global_default on its own
        input = MyObj.called_often(), // doesn't work; MyObj.prototype.called_often() DOES
        name = this.name; // 'this' used in the prototype doesn't work
                          // even within a created object
    return name + input + str;
  }
}; 
```

我敢肯定，每当我遇到这个问题时，都会有更好的方法来实现我的结果。此代码不是特定情况，只是说明一般问题。因此，对于我遇到的那些特定情况，您将无法为我提供替代方案。但也许你可以帮助我的整体思考。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-06-06T16:28:31.473

好吧，从你的第一个例子：

```
var _obj = {
    property: value,
    method1: function() {
      // do stuff
    },
    method2: function() {
      // use property
      var prop = this.property; 
      // call method1
      this.method1(); 
    }
  }; 
```

这就是`this`价值所在。

现在，您不能做的是在对象文字语法的其他地方引用“正在构建”对象的属性。（很难给出一个例子，因为它在语法上是不可能的。）如果你想这样做，你确实需要一个或多个单独的赋值语句。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-06T16:34:50.597

你猜怎么着？你让简单的东西变得复杂。Pointy 的回答很好，但由于几个原因，原型方式更好。这就是为什么我要描述（而不是更正）最后一种方法。[检查这个小提琴](http://jsfiddle.net/yAPgW/)。

```
var MyObj = function(name) {
  this.name = name;
};

MyObj.prototype = {
  called_often: function() {
    // lots more code than just the following
    return 'VALUE'; //document.getElementById('someID').value;
  },

  global_default: 'value', // can be changed, so need to pull value when run

  does_stuff: function(value) {
    var str = this.global_default + value, // can't access global_default on its own
        input = this.called_often(), // doesn't work; MyObj.prototype.called_often() DOES
        name = this.name; // 'this' used in the prototype doesn't work
                          // even within a created object
    return name + input + str;
  }
};

var obj = new MyObj('Bob'); 
```

# ios - XCode/iOS - AppDelegate 中 ViewController 的参考

> ID：10918231
> 
> 赞同：4
> 
> 时间：2012-06-06T16:25:34.953
> 
> 标签：ios, cocoa-touch

在我看来，我的 iPad 应用程序会自行加载 Storyboard File 及其 ViewController。我在 plist 文件中看到“主故事板文件基本名称”的条目。

来自我曾经在 Xcode 中创建“空应用程序”的背景，然后我将创建 UIViewController 和 nib 文件，在里面实例化

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

并添加到视图中，我已经引用（变量）这个 ViewController 对象

现在在这个“单视图应用程序”中，我没有看到任何对基于 Storyboard 的 ViewController 的引用，我需要有一个引用来做一些工作。请指教。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T16:37:00.810

查看此问题以获取有关通过情节提要访问视图控制器的一些示例代码 - [Accessing a view controller created through Storyboard using the App Delegate](https://stackoverflow.com/questions/8784143/accessing-a-view-controller-created-through-storyboard-using-the-app-delegate)

对于基本答案，您应该能够引用“窗口”属性。您应该能够使用“窗口”引用的属性来引用您的其他视图。UIWindow 附加了一个“rootViewController”属性。

UIWindow 文档 - [http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIWindow_Class/UIWindowClassReference/UIWindowClassReference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIWindow_Class/UIWindowClassReference/UIWindowClassReference.html)

# iphone - 将 iphone 与网络界面同步？

> ID：10918233
> 
> 赞同：0
> 
> 时间：2012-06-06T16:25:52.633
> 
> 标签：iphone, mysql, objective-c, synchronization

如果我同时拥有 Web 界面和 iOS 应用程序，我可以使用哪些技术来确保两者之间的数据同步？

我正在寻找一些不太复杂的东西，并且可能不是一个 100% 有效的解决方案，但是一些合理的东西。

所以场景是，有人在他们的 iphone 应用程序打开时使用网络界面，并说广告一些数据。假设这是一个购物清单应用程序，他们将“香蕉”添加到列表中。

现在 iphone 与 Web 界面上所做的更改不同步。

在这种情况下我应该/可以做什么？

**更新**

数据将存储在 mysql 中，理想情况下一些将在 iphone 上本地缓存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:40:17.827

您在这里描述的是移动设备和 Web 服务之间的经典同步问题。

在高层次上，一个经典的解决方案是每隔 x 秒在您的移动设备上轮询一次数据到您的 Web 服务，以查看是否有任何更新（您需要将“x”基于您需要考虑的同步级别较低的值会给数据传输带来更大的压力，因此需要更多的电池电量）。为了将移动设备上的更改提交到您的网络服务，您可以要求数据连接可用，以便在输入数据时立即将其提交到您的网络服务，或者您可以将其排队，以便当数据连接可用时，它批处理将请求发送到 Web 服务，Web 服务根据时间戳或其他一些指标处理冲突数据。

# visual-studio-2010 - VS2010 和 2012 中的发布向导错误

> ID：10918234
> 
> 赞同：6
> 
> 时间：2012-06-06T16:25:53.580
> 
> 标签：visual-studio-2010, visual-studio-2012, webdeploy, microsoft-web-deploy

我一直在使用 VS2010 中的发布向导来部署我的 MVC 应用程序，我没有遇到任何问题，但间歇性地发布将失败并出现以下错误。

> 错误 23 Web 部署任务失败。（无法完成对远程代理 URL 'https://webserver:8172/msdeploy.axd?site=mysite'的请求。）
> 
> 无法完成对远程代理 URL“https://webserver:8172/msdeploy.axd?site=mysite”的请求。请求被中止：请求被取消。无法使用已与其底层 RCW 分离的 COM 对象。

它似乎是随机发生的，但是我打开 VS 的时间越长，它发生的可能性就越大，修复它的保证方法是重新启动 VS，但如果我让 VS 长时间打开（全天或一夜之间）并且开始变得非常令人沮丧，每次发生时都必须重新启动VS。老实说，我不记得错误号是否始终为 23，下次发生时我会寻找，但有其他人遇到过这个问题或知道是什么原因造成的吗？

**更新：** 使用 VS2012 时问题仍然存在。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-11T19:22:04.960

我们在完成 Web 发布的 RTW 组件后不久就发现了这个错误。给你一些背景知识，我们很难发现潜在的问题。经过一番调查，我们能够查明问题与 WPF 使用的单例 RCW 对象如何管理 Internet 连接以及请求是否来自 STA 或 MTA 线程有关。

幸运的是，我们能够解决潜在问题并准备好修复。我们计划在几个月内更新网络发布位，这应该可以一劳永逸地解决这个问题。在那之前，解决方法是关闭 VS，然后重新打开它。我知道这不是一个理想的解决方法，但这是我们目前能做的最好的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T12:59:12.277

根据[http://www.asp.net/mvc/tutorials/deployment/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12- 12 个](http://www.asp.net/mvc/tutorials/deployment/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12)

> “无法使用已与其底层 RCW 分离的 COM 对象。” 场景您已经成功使用一键发布来部署您的应用程序，然后您开始收到此错误：
> 
> Web 部署任务失败。（无法完成对远程代理 URL“https://serverurl.com/msdeploy.axd?site=sitename”的请求。）无法完成对远程代理 URL“https://url/msdeploy.axd?site”的请求=站点名称'。请求被中止：请求被取消。无法使用已与其底层 RCW 分离的 COM 对象。

解决方案是：

> 可能的原因和解决方案 通常只需关闭并重新启动 Visual Studio 即可解决此错误。

# tfs - 将工作项模板应用于现有工作项

> ID：10918236
> 
> 赞同：0
> 
> 时间：2012-06-06T16:26:01.367
> 
> 标签：tfs, workitem

我使用 Process Editor 为 User Story 工作项创建了一个新状态（Proposed 状态）。当我创建一个新故事时，它工作正常，创建了用户故事并且初始状态是 Proposed，就像我想要的那样。

但是，当我打开现有的用户故事工作项（在我进行更改之前创建的）时，它没有建议状态作为选项，而且如果我在状态字段中键入建议，它也不会接受它。

这是否意味着对工作项模板所做的任何更改都将仅适用于未来的新工作项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:56:25.023

建议的状态不在下拉列表中，很可能是因为没有从工作项的当前状态转换到建议的状态。

你能证实这一点吗？

# php - userfunctions.php 为什么我不能在 Typo3 fileadmin/ 中添加这个文件

> ID：10918238
> 
> 赞同：0
> 
> 时间：2012-06-06T16:26:34.000
> 
> 标签：php, web, typo3

我正在关注如何使用typo3 创建现代模板的教程。[带有教程的网站](http://typo3.org/documentation/document-library/tutorials/doc_tut_templselect/0.1.0/view/1/2/) 我被指示在 fileadmin/userfunctions.php 下添加一个 php 文件，但由于某种原因 Typo3 说这个文件是不允许的>![在此处输入图像描述](../Images/9d5187ea57646b6d236a0666eae1d2da.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:27:40.817

红色错误足以回答您的问题

php 扩展名不允许上传。只需手动将文件添加到目录中。通过 web 面板单击文件夹 nat

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T07:27:24.807

有时是因为 BE 允许文件扩展名。

1.  转到 TYPO3 后端
2.  安装工具所有配置
3.  [textfile_ext] -> 检查此输入框是否在此框中列出了 php、php3、phtml。如果没有，包括它们。

# entity-framework - 如何在我的业务逻辑中对实体框架 (EF) 进行单元测试？

> ID：10918240
> 
> 赞同：1
> 
> 时间：2012-06-06T16:26:37.670
> 
> 标签：entity-framework, unit-testing

我已经阅读了很多关于单元测试实体框架的内容。

我发布这个问题是因为我只是看到这个问题有***太多的***解决方案！

以下是我找到的解决方案：

1.  使用名为[**TypeMock**](http://www.typemock.com/)[的昂贵的商业工具（此处](https://stackoverflow.com/questions/2703100/ef4-possible-to-mock-objectcontext-for-unit-testing)提到）。
2.  [**使用名为Effort**](http://effort.codeplex.com/)的 alpha 开源工具（[此处](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2466931-make-entity-framework-fully-mockable-and-injectabl)提到）。
3.  使用**Repository Pattern**和**Rhino Mock**。针对真实数据库（提到[这里](https://stackoverflow.com/questions/9390666/how-to-write-a-solid-unit-test-for-this-business-logic-code)）测试隔离的 LINQ 查询。

此处所述的某些方法存在一些问题：

*   您无法绕过需要为*ObjectContext*提供连接字符串的事实
*   如果你伪造了*ObjectContext* - 一些可能在单元测试中起作用的东西在生产中不起作用（比如在查询中运行函数）

我读到的一些文章是 3-4 年前的。

这里有没有人对这个问题有任何经验并且可以帮助我寻求最佳解决方案？

澄清一下：我的业务逻辑函数不仅仅是像“GetUserById”这样的简单函数。

一些功能包括访问与其他对象有关系的对象。（例如 - 我可以在同一功能中添加用户 + 部门 + 办公室）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:48:33.317

对于这样的事情，我建议使用存储库模式并使用像[Rhino](http://ayende.com/blog/tags/rhino-mocks)或[MOQ](http://code.google.com/p/moq/)这样的模拟框架来测试您的业务逻辑，然后我会建议您对存储库进行一些集成测试。

首先，这遵循“单一职责原则”，允许您以几乎同样多的开销测试您的业务逻辑（模拟 ObjectContext 是一种痛苦），它允许您使用真实数据测试您的查询。我强烈声明任何经过良好测试的解决方案都将包括单元测试和集成测试。

# algorithm - 算法：如何比较两个分组

> ID：10918241
> 
> 赞同：1
> 
> 时间：2012-06-06T16:26:37.763
> 
> 标签：algorithm, mapreduce

我有两组数字（或字符串）的分组。每个组都有一些 ID（编号），并且相同的组在两个分组中可能有不同的 ID。我想对这两个分组执行某种差异，并且想知道是否有这样的算法可以使用:) 如果有可用的 map reduce 实现，它会更好。

这里有一些例子需要澄清，因为我不确定我的术语是否容易理解。假设有 1、2、3、4 和 5 5 个数字。

在 Grouping (1) 中，有两个组：

在 Grouping (2) 中，有三组：

然后差异工具应该识别来自 Grouping (1) 的 Group 1 和 Group 2 from Grouping (2) 是相同的，并且来自 Grouping (1) 的 Group 2 的元素 5 已经在 Grouping (2) 中作为一个新组或类似的东西那。

# javascript - 回到溢出内容中的子页面锚点

> ID：10918242
> 
> 赞同：4
> 
> 时间：2012-06-06T16:26:38.610
> 
> 标签：javascript, jquery, html, css

我有一个 HTML 页面，其中包含指向内容包装器中的子部分的链接，该内容包装器定位/调整大小并用于`overflow:auto`显示滚动条。子部分的链接有效（导致内容滚动到正确的高度），但**使用后退按钮不会重新滚动到**Firefox v13、IE v9 或 Opera v11 中的正确部分（它在 Chrome v20 和 Safari v5 中有效）。

鉴于我不能*彻底*改变我的 CSS（我需要使用定位、大小、溢出的内容），我该如何解决这个问题？

*可以接受涉及 JavaScript/jQuery 的解决方案，但最好使用纯 CSS 修复。*

## 测试页面：[phrogz.net/tmp/backing...containers.html](http://phrogz.net/tmp/backing-into-subpage-anchors-in-overflowed-containers.html)

```
<!DOCTYPE html>
<html><head><title>Backing into Subpage Anchors in Overflowed Containers</title>
  <style type="text/css">
    #site-nav { position:fixed; width:10em; top:0; left:0 }
    #contents { position:fixed; top:3em; bottom:5em; left:11em; right:0;
                overflow:auto; background:#fed }
    div            { height:15em }
    div:last-child { height:55em }
  </style>
</head><body>

<article id="contents">
  <div>
    <h1 id="a">Section A</h1>
    <p>Navigate to the different sections at left, and then press the Back button.</p>
  </div>
  <div><h1 id="b">Section B</h1></div>
  <div><h1 id="c">Section C</h1></div>
</article>
<ul id="site-nav">
  <li><a href="#a">Section A</a></li>
  <li><a href="#b">Section B</a></li>
  <li><a href="#c">Section C</a><ul>
</ul>

</body></html> 
```

先前提交的 Firefox 错误：[https](https://bugzilla.mozilla.org/show_bug.cgi?id=391664)
://bugzilla.mozilla.org/show_bug.cgi?id=391664 引用为 Opera 错误：DSK-365451@bugs.opera.com

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T18:21:23.613

我使用 jQuery、@barius 建议的[hashchange 插件](http://benalman.com/projects/jquery-hashchange-plugin/)和以下代码解决了这个问题：

```
jQuery(function($){
  var $content = $('#contents');
  $(window).hashchange(scrollHashIntoView);

  function scrollHashIntoView(){
    // Ensure that the ID I'm looking for is within my scrolling content
    var offset = $content.find(location.hash).offsetRelativeTo($content);
    $content.scrollTop( offset ? offset.top : 0 );
  }
});

// Find the offset of an element relative to some ancestor
jQuery.fn.offsetRelativeTo = function(el){
  var $el=$(el), o=this.offset(), o2=$el.offset();
  if (o){
    o.top  -= o2.top  - $el.scrollTop();
    o.left -= o2.left - $el.scrollLeft();
  }
  return o;
} 
```

`offsetRelativeTo()`对于我更复杂的情况，当其中一个子锚点碰巧在`position:relative`父级内（它本身在滚动内容内）时，该代码是必要的。

我创建了`scrollHashIntoView()`一个单独的函数，因为 (a) 它有助于自我记录行为，并且 (b) 它允许我在需要时单独调用它，以及 (c) 它将工作的实现与简洁的事件注册和他们的行动。

一个更强大的解决方案（处理嵌套滚动区域的不太可能但可能的情况）将找到 id 并沿着`offsetParent`s 的树向上走，并在适当的时候将每个滚动到视图中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:21:17.003

我认为您可以使用 onhashchange 事件。它仅由较新的浏览器支持，但可以使用插件，例如[http://benalman.com/projects/jquery-hashchange-plugin/](http://benalman.com/projects/jquery-hashchange-plugin/)

当 hash 发生变化时，您可以通过 ID 查找元素并更改容器的 scrollTop 属性。像这样的东西：

```
$(function(){
    $(window).hashchange(function(){
        var elem = $(location.hash);
        if (elem.count() > 0) {
            elem.offsetParent().animate({scrollTop: elem.position().top});
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-06T17:35:58.697

我也打算推荐这个`onhashchange`活动，但旧版浏览器不支持它。一个简单的解决方案是简单地使用页面上第一个锚点的哈希值，如果您没有哈希值，则自动将其设置为该值。

```
$(function() {
    if(window.location.hash == '') {
        window.location.hash = $("a[href^='#']:first").attr('href');
    }
}); 
```

# git - 没有壁球的 git-subtree：查看日志

> ID：10918244
> 
> 赞同：17
> 
> 时间：2012-06-06T16:26:49.753
> 
> 标签：git, git-subtree

我使用不带 squash 选项的 git subtree add 将一棵树合并到我的存储库中。git 日志显示提交已成功添加到存储库。但是，如果我执行 a `git log --follow filename`，历史记录会在合并处停止，并且不会显示以前的提交。我尝试使用`-M`而不是，`--follow`但这也不起作用。如何获取合并前特定文件或文件的提交日志？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-21T22:00:22.863

提交由来自子树的文件创建`git subtree merge`或执行“添加”，而不是“移动”。`git subtree add`这意味着他们的历史不能像其他合并或移动一样被跟踪。

您仍然可以通过在合并前直接查看子树来显示所需文件的历史记录。如果您的工作区是`git subtree`创建的合并提交，那么它的第二个父级 ( `HEAD^2`) 将是原始子树的最后一个提交。从这里你可以看到原始子树的内容：

```
# Display the contents of the original subtree
git ls-tree HEAD^2 
```

从此提交中，您可以跟踪您感兴趣的文件的更改。请注意，您的文件路径在工作区中的子树中会有所不同。您需要删除`--prefix`给定的 to`git subtree`才能获得文件的正确路径。

```
git log HEAD^2 --follow -- path-in-subtree/file 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-10-31T19:22:02.673

实际上，`git log --follow` *应该*与子树合并一起使用，但众所周知它在很长一段时间内都是 hackish [1-3]。

人们可以坚持使用子树合并，并确信该策略对跟踪多个历史记录有效，并耐心等待不可避免的事件`git log --follow`将得到改善。这实际上可能是一个可行的决定，因为目前`git log --follow`可以在非常有用的情况下看到一些历史。假设您将文件从顶级存储库移动到子存储库，然后它可以跟踪完整移动。当您想要跟踪特定于子存储库的历史记录时，您确实必须拥有单独的副本或签出子存储库分支。

# 替代方案和解决方法

您可以获取此类文件的日志 [1]：

```
git log -- '*filename'          # from the toplevel 
```

这将查看每个涉及名称以 . 结尾的文件的提交`filename`。它不会跟随实际的重命名，并且如果您有多个具有相同基本名称的文件 [1]，则可能会显示误报。

您还可以使用不同的策略合并存储库。参考文献 [4] 展示了一种执行此操作的方法，该方法与常规子树合并的方法非常接近，但具有可追溯的历史记录。基本上，你：

1.  将每个子存储库添加、获取和合并到顶级存储库，作为常规远程，没有 git 子树或 readtree。起初，这会污染你的根目录，就好像它是他们的一样，所以这是在项目生命的开始时完成的。
2.  `git mv`子仓库文件到单独的文件夹

然后：

*   上游更改可以正常获取和合并，但带有`-Xsubtree`git merge 的标志。
*   其他情况应该类似。我已经测试了向上游推送并且它有效，请参阅 [4] 中的评论。

# 参考

[1] 来自 git 邮件列表 [http://git.661346.n2.nabble.com/Bug-Files-are-losing-history-after-subtree-merge-td7597197.html](http://git.661346.n2.nabble.com/Bug-Files-are-losing-history-after-subtree-merge-td7597197.html)

[2] 来自 git 邮件列表 [http://git.661346.n2.nabble.com/gsoc-Better-git-log-follow-support-td6188083.html#a6188352](http://git.661346.n2.nabble.com/gsoc-Better-git-log-follow-support-td6188083.html#a6188352)

[3]`git log --follow`已在 Google Summer of Code [https://git.wiki.kernel.org/index.php/SoC2011Ideas#Better_git_log_--follow_support](https://git.wiki.kernel.org/index.php/SoC2011Ideas#Better_git_log_--follow_support)

[4] [https://saintgimp.org/2013/01/22/merging-two-git-repositories-into-one-repository-without-losing-file-history](https://saintgimp.org/2013/01/22/merging-two-git-repositories-into-one-repository-without-losing-file-history)

# javascript - 即使所选选项没有改变，是否有任何方法可以在 Chrome 中的 SELECT 元素上触发点击事件？

> ID：10918247
> 
> 赞同：3
> 
> 时间：2012-06-06T16:27:03.477
> 
> 标签：javascript, jquery, google-chrome, javascript-events

我有一个 SELECT 元素，其内容（OPTION 元素）通过 AJAX 加载并在准备就绪时插入，并且在更改不同的 SELECT 时插入。两个 SELECTS 都有两个 OPTION 元素附加到通过 AJAX 加载的列表中：

```
<option disabled="disabled"></option>
<option value="edit">Edit&hellip;</option> 
```

我已经准备好以下 jQuery 事件绑定：

```
$('#theSelect').bind('change click', handleSelection); 
```

然后，该`handleSelection()`方法拦截正在选择的“编辑...”选项，将选择切换回先前选择的选项，并触发显示允许用户编辑菜单中的选项的对话框的其他功能。这在 Safari 和 Chrome 中效果很好，但有一种情况在 Chrome 中不起作用：如果没有通过 AJAX 加载的选项，那么只有禁用的和“编辑...”选项可见，它不会触发选择“编辑...”选项上的事件。这似乎是因为，在 Chrome 中，默认选择“编辑...”选项（因为它是第一个启用的选项；另一方面，Safari 选择禁用的选项，因为它是第一个选项）并且它[只会触发更改 SELECT 元素的事件，而不是点击](https://stackoverflow.com/questions/4340690/javascript-onclick-alert-not-working-in-chrome)（为什么我同时听点击和更改），但是当“编辑...”已经被选中时，它实际上并没有*改变*，所以不会触发事件。

那么，我该如何解决这个问题？我是否需要拦截所有焦点事件并做脏活来解释发生了什么？有没有办法让 Chrome 选择禁用的选项而不是“编辑...”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T18:41:49.210

根据[Slavo 在评论中的建议](https://stackoverflow.com/questions/10918247/is-there-any-way-to-fire-a-click-event-on-a-select-element-in-chrome-even-if-the#comment14239809_10918247)，我强制所有浏览器在 AJAX 注入时选择第一个选项：

```
// force select the first option (fixes a Chrome issue)
$('#theSelect option:selected').removeAttr('selected')
$('#theSelect option:first-child').attr('selected', 'selected'); 
```

这标准化了浏览器的行为，并使 Chrome 选择禁用的选项，而不是默认启用的“编辑...”选项。

# spring - Spring jdbc：初始化数据库不起作用

> ID：10918248
> 
> 赞同：2
> 
> 时间：2012-06-06T16:27:05.233
> 
> 标签：spring, spring-mvc, hsqldb

我无法让 spring 初始化我的数据库，尽管据我所见，我做对了。我不断收到 org/springframework/dao/DataAccessResourceFailureException。

这是我的 springapp-servlet.xml：

```
 <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName" value="${jdbc.driverClassName}"/>
    <property name="url" value="${jdbc.url}"/>
    <property name="username" value="${jdbc.username}"/>
    <property name="password" value="${jdbc.password}"/>
</bean>

<jdbc:initialize-database data-source="dataSource" ignore-failures="DROPS">
<jdbc:script location="classpath:create_products.sql" />
<jdbc:script location="classpath:load_data.sql" />
 </jdbc:initialize-database> 
```

jdbc.properties 文件位于 Java Resources/src 中，是这样的：

```
 jdbc.driverClassName=org.hsqldb.jdbcDriver
 jdbc.url=jdbc:hsqldb:hsql://localhost
 jdbc.username=sa
 jdbc.password= 
```

create_products.sql 也在 Java Resources/src 中，它是：CREATE TABLE products (id INTEGER NOT NULL PRIMARY KEY, description varchar(255), price decimal(15,2));

load_data.sql 位于同一位置，是这样的：

```
INSERT INTO products (id, description, price) values(1, 'Lamp', 5.78);
INSERT INTO products (id, description, price) values(2, 'Table', 75.29);
INSERT INTO products (id, description, price) values(3, 'Chair', 22.81); 
```

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T22:10:04.037

Dave 可能您的 springapp-servlet.xml 中也出现此错误`cvc-complex-type.2.4.b: The content of element 'jdbc:initialize-database' is not complete. One of '{"http://www.springframework.org/schema/jdbc":script}' is expected.`？

org.springframework.jdbc.datasource.init 包提供对初始化现有数据源的支持。只需检查您的 spring-jdbc 版本。参考：`[http://static.springsource.org/spring/docs/3.0.0.RC3/reference/html/ch12s09.html][1]`

只需打开 spring-jdbc jar 并查看下：`org/springframework/jdbc/datasource`如果您可以按名称看到任何文件夹`init`。如果`init`文件夹不存在，那么您使用的 Spring Framework 版本不支持此功能。

![在此处输入图像描述](../Images/4b904a1744144f988ff9fc3d66962069.png)

# c++ - #pragma once 和 #include 问题

> ID：10918250
> 
> 赞同：1
> 
> 时间：2012-06-06T16:27:08.543
> 
> 标签：c++, include, pragma

我遇到了循环引用的问题（即 Ah 和 Bh #包括彼此），有些人建议我使用 #pragma 一次来防止这种情况。但是，此解决方案似乎仍然无法正常工作。

发生的情况是 A 类不再在 Ah 以外的任何文件中被识别（甚至在 A.cpp 中也不被识别），B 类也是如此。

让我给你看一下代码：

**啊**

```
#pragma once
#include "B.h"

class A {
public: B* b;

}; 
```

**溴化氢**

```
#pragma once
#include "A.h"

class B {
    public: A* a;
}; 
```

**A.cpp**

```
#include "stdafx.h"
#include "A.h"
#include "B.h" 
```

**B.cpp与****A.cpp**相同

 **错误跟踪如下所示：

> 1> B.cpp 1>c:\users\user\documents\visual studio 2010\projects\envmodel\test\bh(5): 错误 C2143: 语法错误: 缺少';' 在 ' *' 1>c:\users\user\documents\visual studio 2010\projects\envmodel\test\bh(5) 之前：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持 default-int 1>c:\users\user\documents\visual studio 2010\projects\envmodel\test\bh(5)：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持 default-int 1> A.cpp 1>c:\users\user\documents\visual studio 2010\projects\envmodel\test\bh(5): error C2143: syntax error: missing ';' 前 '*' 1>c:\users\user\documents\visual studio 2010\projects\envmodel\test\bh(5)：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持 default-int 1>c:\users\user\documents\visual studio 2010\projects\envmodel\test\bh(5)：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数

还有两点我想澄清：

1.  如何以及何时在 Visual Studio 2010 中使用 #include "stdafx.h"（我真的很讨厌这个 IDE，但它似乎是唯一一个与 C++ 兼容的 IDE——Netbeans 完全是这种语言的垃圾）

2.  如何正确使用#pragma 一次？我假设我只是把它放在每个文件的第一行（好吧，显然这并不能解决我的问题！）。另外，它应该放在#include "stdafx.h" 之前还是之后？注意：我没有在 stdafx.h 中放置一次#pragma

谢谢。

编辑：我忘记了分号，因此原来的错误跟踪是臃肿的。Edit2：我忘了使用指针。我的实际程序确实使用了指针而不是普通的对象值，我在匆忙创建一个小例子时忽略了这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T16:34:35.497

你不能有循环依赖。

像这样想。如果您实例化类型 A 的对象；那么它有多大？答案是无限大的。所以无论如何你都不能创建像那样的圆形对象。

您需要使用可选值（指针）来打破循环。
因此，如果您更改 B 以保存指向 A 的指针并使用前向引用，那么它就可以工作。

```
#pragma once
class A; // Forward reference.

class B {
    public: A* a; // Break cycle with a pointer. (In real life use a smart pointer)
} 
```

注意：您仍然应该`#pragma once`在头文件中使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-06T16:32:19.687

不，`#pragma once`不解决循环依赖问题，而不是标准包含保护。你所做的本质上是一个递归结构，你*不能*有一个使用普通值的递归结构，因为这意味着`sizeof(T) == infinity`. 这里的解决方案是：

1.  不包括 Ah 中的 Bh
2.  使用`std::unique_ptr`（或者只是一个原始指针，如果它不拥有实例）而不是普通值来保存`B`实例`A`。

反之亦然，具体取决于您的课程实际上是什么。当然，最好的解决方案是在设计级别完全摆脱循环依赖（重构公共部分，诸如此类）。

`stdafx.h`不相关（名称只是一个约定）- 搜索“预编译头”。**

# java - log4j UTC 日期时间配置

> ID：10918252
> 
> 赞同：2
> 
> 时间：2012-06-06T16:27:20.663
> 
> 标签：java, log4j

> **可能重复：**
> [Log4J；如何使用 ConversionPattern 确保时间戳始终在 GMT 中？](https://stackoverflow.com/questions/3634585/log4j-how-to-ensure-timestamps-are-always-in-gmt-using-conversionpattern)

如何配置 log4j 以 UTC 格式显示日期时间。

目前我正在使用以下配置

```
<appender name="trap-appender" class="org.apache.log4j.DailyRollingFileAppender">
    <param name="file" value="logs/exception/ExceptionLog.log" />
    <param name="append" value="true" />
    <param name="encoding" value="UTF-8" />
    <layout class="org.apache.log4j.PatternLayout">
         <param name="ConversionPattern" value="%d{yyyy-MM-dd/HH:mm:ss.SSS}:%m%n" />
    </layout>
</appender> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:42:30.547

我不认为有什么好办法。但是解决这个问题的一种方法是扩展`PatternLayout`：

1.  编写自己的 DateFormat，类似于 log4j 的`AbsoluteTimeDateFormat`.

2.  扩展`PatternParser`和覆盖`void finalizeConverter(char c)`以支持新的特殊格式代码，例如`%d{UTC}`.

3.  扩展`PatternLayout`并覆盖`createPatternParser`以返回您的`PatternParser`.

4.  更改您的配置以使用您的子类`PatternLayout`.

# spring - 加载应用程序上下文时出现 Spring Velocity 异常

> ID：10918254
> 
> 赞同：0
> 
> 时间：2012-06-06T16:27:28.920
> 
> 标签：spring, velocity

我们在我们的应用程序中使用 spring，velocity 作为电子邮件代码，我得到了以下异常。任何想法来解决这个问题。

```
 "org.springframework.beans.ConversionNotSupportedException: Failed to convert property value of type 'org.springframework.ui.velocity.VelocityEngineFactoryBean' to required type 
'org.apache.velocity.app.VelocityEngine' for property 'velocityEngine'; nested exception is java.lang.IllegalStateException: Cannot convert value of type 
[org.springframework.ui.velocity.VelocityEngineFactoryBean] to required type [org.apache.velocity.app.VelocityEngine] for property 'velocityEngine': no matching editors or conversion strategy found " 
```

以下是我的上下文配置。

http://www.springframework.org/schema/beans/spring-beans.xsd">

```
<bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
    <property name="host" value="xxxx.US"/>
    <property name="port" value="25"/>
    <property name="javaMailProperties">
        <props>
            <prop key="mail.transport.protocol">smtp</prop>
            <prop key="mail.smtp.auth">false</prop>
            <prop key="mail.smtp.starttls.enable">false</prop>
            <prop key="mail.debug">true</prop>
        </props>
    </property>
</bean>

<bean id="velocityEngine" class="org.springframework.ui.velocity.VelocityEngineFactoryBean">
    <property name="velocityProperties">
        <value>
            resource.loader=class
            class.resource.loader.class=org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader       
        </value>
    </property>
</bean>

<bean id="emailUtil" class="com.example.MailUtil">
    <property name="mailSender" ref="mailSender" /> 
    <property name="velocityEngine" ref="velocityEngine" />
</bean> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T19:39:02.297

您不需要在 emailUtil bean 中引用velocityEngine。关于您的弹簧配置的其他所有内容都是正确的。

我从我的应用程序中获取了以下代码，向您展示我们如何能够使用速度模板。

```
private String generateMessageFromTemplate(User user, VelocityTemplateEnum velocityTemplateEnum) {
    VelocityContext context = new VelocityContext();
    context.put("user", user);
    StringWriter stringWriter = new StringWriter();
    String template = velocityTemplateDao.findById(velocityTemplateEnum.name()).getTemplate();
    Velocity.evaluate(context, stringWriter, velocityTemplateEnum.name(), template);
    return stringWriter.getBuffer().toString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T01:11:53.877

我有一个类似的设置，只是我在 VelocityEngine 中自动装配，这对我有用。自动装配是您的选择吗？另外，你可以为你的 MailUtil 类添加代码吗？速度引擎字段/设置器可能不是 100% 正确的？

# vb.net-2010 - 无法将“System.Windows.Forms.Button”类型的对象转换为“System.Windows.Forms.PictureBox”类型

> ID：10918260
> 
> 赞同：-1
> 
> 时间：2012-06-06T16:28:01.300
> 
> 标签：vb.net-2010

我正在尝试对多个图片框执行相同的操作，但以下代码的第一行正在生成此错误：

```
Unable to cast object of type System.Windows.Forms.Button to type System.Windows.Forms.PictureBox 
```

所以我想知道是否有人可以提供帮助。提前致谢。

```
For Each pb As PictureBox In Me.Controls
    Dim bp As New Bitmap(pb.Image)
    pb.Region = GetRegion(bp, Color.FromArgb(255, 255, 0, 255))
    pb.Image = Nothing
    pb.BackColor = Color.FromArgb(100, Color.Yellow)
Next 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:19:25.683

`For Each`正在循环中的所有控件`Me.Controls`

`PictureBox`在开始对控件进行操作之前，您需要检查类型

```
For Each ctrl As Control In Me.Controls
    If TypeOf ctrl Is PictureBox Then
        Dim bp As New Bitmap(ctrl.Image)
        ctrl.Region = GetRegion(bp, Color.FromArgb(255, 255, 0, 255))
        ctrl.Image = Nothing
        ctrl.BackColor = Color.FromArgb(100, Color.Yellow)
    End If
Next 
```

# c - 我应该添加哪个库来解决 fcntl64、stat64、...？

> ID：10918261
> 
> 赞同：3
> 
> 时间：2012-06-06T16:28:03.647
> 
> 标签：c, gcc, cross-compiling, uclibc

我正在尝试为 ARM uClibc 环境构建一个项目，但我缺少一些功能。找不到我应该包含哪个库来解决依赖关系。`nm`不要帮我搜索，因为它在工具链附带的大多数库上都说：

```
nm: ./host/usr/arm-unknown-linux-uclibcgnueabi/sysroot/lib/libuClibc-0.9.32.1.so: no symbols 
```

这是 GCC 的输出：

```
./host/usr/bin/arm-unknown-linux-uclibcgnueabi-gcc
 -Wl,-rpath,./host/usr/lib/
 -Wl,-rpath,./host/usr/../lib/
 -Wl,-rpath,./host/usr/arm-unknown-linux-uclibcgnueabi/sysroot/lib/
 -Llibzway -o test_so main.o -lzway
 -L./host/usr/lib/
 -L./host/usr/../lib/
 -L./host/usr/arm-unknown-linux-uclibcgnueabi/sysroot/lib/  -lpthread
 -lxml2 -lz -lm
./host/usr/lib/libxml2.so: warning: gethostbyname is obsolescent, use getnameinfo() instead.
./host/usr/lib/libxml2.so: undefined reference to `fcntl64'
./host/usr/lib/libxml2.so: undefined reference to `fopen64'
./host/usr/../lib/libz.so: undefined reference to `lseek64'
./host/usr/lib/libxml2.so: undefined reference to `stat64'
./host/usr/lib/libiconv.so.2: undefined reference to `mbrtowc'
./host/usr/lib/libiconv.so.2: undefined reference to `_stdlib_mb_cur_max'
./host/usr/lib/libiconv.so.2: undefined reference to `wcrtomb'
./host/usr/lib/libxml2.so: undefined reference to `open64'
collect2: ld returned 1 exit status
make: *** [test_so] Error 1 
```

UPD：我已经从目标主机复制了 uClibc 并明确定义要求与它链接：

```
./host/usr/bin/arm-unknown-linux-uclibcgnueabi-gcc
 -Wl,-rpath,./host/usr/lib/
 -Wl,-rpath,./host/usr/../lib/
 -Wl,-rpath,./host/usr/arm-unknown-linux-uclibcgnueabi/sysroot/lib/
 -Llibzway -o test_so main.o -lzway
 -L./host/usr/lib/
 -L./host/usr/../lib/
 -L./host/usr/arm-unknown-linux-uclibcgnueabi/sysroot/lib/
 -luClibc-0.9.31
 -lpthread -lxml2 -lz -lm
./host/usr/bin/../lib/gcc/arm-unknown-linux-uclibcgnueabi/4.5.3/../../../../arm-unknown-linux-uclibcgnueabi/bin/ld:
  errno: TLS reference in ./host/usr/bin/../arm-unknown-linux-uclibcgnueabi/sysroot/lib/libpthread.so.0 mismatches non-TLS definition in ./host/usr/lib/libuClibc-0.9.31.so section .bss
./host/usr/bin/../arm-unknown-linux-uclibcgnueabi/sysroot/lib/libpthread.so.0: could not read symbols: Bad value
collect2: ld returned 1 exit status
make: *** [test_so] Error 1 
```

这大大超出了我对交叉编译的了解。任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:48:17.907

听起来你有几个问题：

1.  您似乎正在尝试使用主机的`libxml2.so`. 这是行不通的。您需要为您的目标系统及其 libc 构建一个。

2.  您的 uClibc 是在没有大文件支持的情况下编译的。返回并修复构建选项或 uClibc。这不是绝对必要的（正确构建的`libxml2.so`与 uClibc 的链接将在不这样做的情况下工作），但是使用预大文件接口确实是倒退的，并且会不必要地限制您的程序。

# css - div / 间距和格式问题内的文本

> ID：10918266
> 
> 赞同：2
> 
> 时间：2012-06-06T16:28:23.867
> 
> 标签：css, html, spacing

有没有办法让我的例子中的线条之间的间距更小？

```
<html>
<head>
<title>test</title>
</head>
<body>
<div>
  <p>test</p>
  <p>test</p>
  <p>test</p>
  <p>test</p>
</div>
</body>
</html> 
```

当我看到结果时，“测试”行之间有很多空间。

谢谢，

马可，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T16:36:58.840

间距可能是由一些不同的事情引起的。`<p>`最值得注意的是，与标签相关的行高、边距和填充。

它们都可以使用 CSS 进行调整：

```
p {
  line-height: 1.2em;
  margin: 0.2em 0;
} 
```

有很多实验可以在这里完成，谷歌上有很多帮助，以获取更多关于 CSS 如何影响事物的详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T16:30:12.673

使用 CSS，只需在您的样式部分添加这一行：

```
​p { margin-bottom: -.2em; }​ 
```

[jsFiddle](http://jsfiddle.net/fm7LC/)在这里

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T16:33:00.877

```
​p{
    line-height: 16px;
}​ 
```

演示：http: [//jsfiddle.net/3cCJX/](http://jsfiddle.net/3cCJX/)

# hadoop - 无法检查 hadoop 上的节点 [连接被拒绝]

> ID：10918269
> 
> 赞同：11
> 
> 时间：2012-06-06T16:28:29.453
> 
> 标签：hadoop

如果我键入 `http://localhost:50070`或 `http://localhost:9000`查看节点，我的浏览器不会显示任何内容，我认为它无法连接到服务器。我用这个命令测试了我的hadoop：

```
hadoop jar hadoop-*test*.jar TestDFSIO -write -nrFiles 10 -fileSize 1000 
```

但也没有工作，它试图连接到服务器，这是输出：

```
12/06/06 17:25:24 INFO mapred.FileInputFormat: nrFiles = 10
12/06/06 17:25:24 INFO mapred.FileInputFormat: fileSize (MB) = 1000
12/06/06 17:25:24 INFO mapred.FileInputFormat: bufferSize = 1000000
12/06/06 17:25:25 INFO ipc.Client: Retrying connect to server: localhost/127.0.0.1:9000\. Already tried 0 time(s).
12/06/06 17:25:26 INFO ipc.Client: Retrying connect to server: localhost/127.0.0.1:9000\. Already tried 1 time(s).
12/06/06 17:25:27 INFO ipc.Client: Retrying connect to server: localhost/127.0.0.1:9000\. Already tried 2 time(s).
12/06/06 17:25:28 INFO ipc.Client: Retrying connect to server: localhost/127.0.0.1:9000\. Already tried 3 time(s).
12/06/06 17:25:29 INFO ipc.Client: Retrying connect to server: localhost/127.0.0.1:9000\. Already tried 4 time(s).
12/06/06 17:25:30 INFO ipc.Client: Retrying connect to server: localhost/127.0.0.1:9000\. Already tried 5 time(s).
12/06/06 17:25:31 INFO ipc.Client: Retrying connect to server: localhost/127.0.0.1:9000\. Already tried 6 time(s).
12/06/06 17:25:32 INFO ipc.Client: Retrying connect to server: localhost/127.0.0.1:9000\. Already tried 7 time(s).
12/06/06 17:25:33 INFO ipc.Client: Retrying connect to server: localhost/127.0.0.1:9000\. Already tried 8 time(s).
12/06/06 17:25:34 INFO ipc.Client: Retrying connect to server: localhost/127.0.0.1:9000\. Already tried 9 time(s).
java.net.ConnectException: Call to localhost/127.0.0.1:9000 failed on connection exception: java.net.ConnectException: Connection refused 
```

我更改了一些这样的文件：在 conf/core-site.xml 中：

```
<configuration>
  <property>
    <name>fs.default.name</name>
    <value>hdfs://localhost:9000</value>
  </property> 
```

在 conf/hdfs-site.xml 中：

```
<configuration>
  <property>
    <name>dfs.replication</name>
    <value>1</value>
  </property>
</configuration>
</configuration> 
```

在 conf/mapred-site.xml 中：

```
<configuration>
  <property>
    <name>mapred.job.tracker</name>
    <value>localhost:9001</value>
  </property>
</configuration> 
```

感谢您的关注。如果我运行这个命令：

```
cat /etc/hosts 
```

我懂了：

```
127.0.0.1   localhost
127.0.1.1   ubuntu.ubuntu-domain    ubuntu

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters 
```

如果我运行这个：

```
ps axww | grep hadoop 
```

我看到了这个结果：

```
2170 pts/0    S+     0:00 grep --color=auto hadoop 
```

但没有效果。你有什么想法，我该如何解决我的问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-06T17:59:37.663

在启动 hadoop 服务之前，您需要注意的事项很少。

检查返回的内容：

```
hostname --fqdn 
```

在您的情况下，这应该是 localhost。还要在 /etc/hosts 中注释掉 IPV6。

您是否在启动 HDFS 之前格式化了名称节点。

```
hadoop namenode -format 
```

你是如何安装 Hadoop 的。日志文件的位置将取决于此。如果您使用过 cloudera 的发行版，通常它位于“/var/log/hadoop/”位置。

如果你是一个完全的新手，我建议使用 Cloudera SCM 安装 Hadoop，这很容易。我已经发布了使用 Cloudera 的发行版[安装 Hadoop 的方法。](http://pyfunc.blogspot.com/2012/05/hadoop-pseudo-cluster-installation.html)

# 还

确保 DFS 位置具有**写入权限**。它通常坐@`/usr/local/hadoop_store/hdfs`

这是一个常见的原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-23T10:44:47.977

我遇到了同样的问题，这解决了我的问题：

问题在于对文件夹“chmod”755 或更高权限的文件夹 /home/username/hadoop/*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-22T15:35:45.710

另一种可能是namenode没有运行。

您可以删除 HDFS 文件：

```
rm -rf /tmp/hadoop* 
```

重新格式化 HDFS

```
bin/hadoop namenode -format 
```

并重启hadoop服务

```
bin/hadoop/start-all.sh (Hadoop 1.x) 
```

或者

```
sbin/hadoop/start-all.sh (Hadoop 2.x) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-06T19:15:51.543

还编辑您的 /etc/hosts 文件并将 127.0.1.1 更改为 127.0.0.1 ...正确的 dns 分辨率对于 hadoop 非常重要，而且也有点棘手..还在您的 core-site.xml 文件中添加以下属性 -

```
<property>
      <name>hadoop.tmp.dir</name>
      <value>/path_to_temp_directory</value>
    </property> 
```

此属性的默认位置是 /tmp 目录，该目录在每次系统重新启动后都会被清空。所以每次重新启动时都会丢失所有信息。还在 hdfs-site.xml 文件中添加这些属性 -

```
<property>
        <name>dfs.name.dir</name>
        <value>/path_to_name_directory</value>
    </property>

    <property>
        <name>dfs.data.dir</name>
        <value>/path_to_data_directory</value>
    </property> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-06T18:44:18.787

我假设这是您第一次安装 hadoop。

在开始时，请检查您的守护进程是否正常工作。为此使用（在终端中）：

```
jps 
```

如果只有 jps 出现，则意味着所有守护程序都已关闭。请检查日志文件。特别是名称节点。日志文件夹可能在某处 /usr/lib/hadoop/logs

如果您有一些权限问题。在安装过程中使用本指南。

[很好的安装指南](http://blog.timmattison.com/archives/2011/12/23/how-to-install-hadoop-on-debian-ubuntu/)

我正在使用这种解释进行拍摄，但这些是最常见的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-05T18:58:43.163

嗨编辑您的核心 conf/core-site.xml 并将 localhost 更改为 0.0.0.0。使用下面的conf。那应该行得通。

```
<configuration>
  <property>
    <name>fs.default.name</name>
    <value>hdfs://0.0.0.0:9000</value>
  </property> 
```

# html - 为什么 div 菜单呈现在标题之外？

> ID：10918271
> 
> 赞同：-4
> 
> 时间：2012-06-06T16:28:33.883
> 
> 标签：html, css, visual-studio-2010, razor

这是 HTML/Razor 视图：

```
 </head>
    <body>
        <header>
            <div class="divHeader">
                Title Here
            </div>
            <div class="divMenu">
               <nav>
                    <ul id="menu">
                        <li>@Html.ActionLink("Home", "Index", "Home")</li>
                        <li>@Html.ActionLink("About", "About", "Home")</li>
                        <li>@Html.ActionLink("Contact", "Contact", "Home")</li>
                    </ul>
                </nav>
           </div>
        </header>
        <div class="divBody">
            @RenderBody()
        </div>
        <footer>
            <div class="divFooter">
                All Rights Reserved.
             </div>
        </footer>
    </body>
    </html> 
```

这是CSS：

```
body
{
    margin: 0 auto;
    max-width: 960px;
    padding: 0px;
    background-color: White;
    text-align: center;
}
header
{
    height: 60px;
    background-color: #C0C0C0;
}
footer
{
    height: 20px;
    background-color: #C0C0C0;
}
div.divHeader
{
    color: #006600;
    font-style: normal;
    font-family: Shruti;
    font-size: 3em;
    font-weight: bold;
}
div.divBody
{
    color: #000000;
    font-style: normal;
    font-family: Georgia;
    font-size: small;
    font-weight: normal;
    text-align: left;
}
div.divFooter
{
    color: #006600;
    font-style: italic;
    font-family: Shruti;
    font-size: 0.75em;
    font-weight: bold;
}
header div.divMenu
{
    position: relative;
}

/* menu
----------------------------------------------------------*/
ul#menu {
    font-size: 1.3em;
    font-weight: 600;
    margin: 0;
    text-align: left;
}

    ul#menu li {
        display: inline;
        list-style: none;
        padding-right: 15px;
    }

        ul#menu li a {
            background: none;
            color: #999;
            text-decoration: none;
        }

        ul#menu li a:hover {
            color: #333;
            text-decoration: none;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:48:53.017

它只是视觉上的，渲染是正确的，但是您的 css 样式给 divheader 的高度小于它，除了包含菜单。

# php - 像 facebook 一样将 facebook 时区转换为我的本地时区

> ID：10918272
> 
> 赞同：1
> 
> 时间：2012-06-06T16:28:41.823
> 
> 标签：php, javascript, facebook, facebook-graph-api, timezone

我正在使用 facebook api 并将 created_time 设置为 2012-06-06T16:20:43+0000

我在 21:57 (IST) 左右发布了这个状态

我得到 2012-06-06T16:20:43+0000

任何帮助将不胜感激，以与我发布的时间相同以获得确切的更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T11:42:34.283

您可以使用以下代码转换任何时区：

```
$timestamp = strtotime("2012-06-06T16:20:43+0000");   //here you put your string with the tie

$dtime = new DateTime();
$dtime->setTimestamp($timestamp);
$localtz = new DateTimeZone("Asia/Calcutta");         //choose the correct PHP timezone
$dtime->setTimeZone($localtz);                        //we apply the timezone

$stringtime = $dtime->format('Y-m-d\TH:i:sO');        //here you return the time in the same format as facebook
$unixtime = $dtime->format('U');                      //here u get the unix timestamp format of the same string

print $stringtime; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T20:49:21.363

我之前为此任务编写了一个函数，

我已根据您的需要对其进行了更新，

```
var fbDateFix = function(date){ 
var local = new Date(date.replace(/-/g,'/').replace('T',' ').replace('+0000',''));
local.setSeconds(local.getSeconds() + 19800);
return local;
}
var padZero = function(t){
  if(t<10){
     return '0' + t;
  }
  return t;
}
var d = fbDateFix('2012-06-06T16:20:43+0000');
console.log(d);
var month = padZero(+d.getMonth()+1);
var date = padZero(+d.getDate());
var hour = padZero(+d.getHours());
var min = padZero (+d.getMinutes());
var sec = padZero (+d.getSeconds());
console.log(d.getFullYear() + '-' + month + '-' + date + 'T' + hour + ':' + min + ':' + sec + '+0000') 
```

**编辑：**

这在php中对我有用，

```
date_default_timezone_set('Asia/Calcutta');
$timestamp = strtotime('2012-06-06T16:20:43+0000');
$local_datetime = date('c',$timestamp); 
echo $local_datetime; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:36:44.097

看起来返回给您的日期是[UTC](https://en.wikipedia.org/wiki/Coordinated_Universal_Time)日期时间。您需要将其转换为您当地的时区（IST）...

请参阅以下 SO 问题以使用 php 转换日期时间： [php convert datetime to UTC](https://stackoverflow.com/questions/2095703/php-convert-datetime-to-utc)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-06T16:36:19.563

您可以使用 PHP 的[strtotime](http://php.net/manual/en/function.strtotime.php)转换`created_time`为 UNIX 时间戳。然后您可以添加或减去您的时区偏移量（IST 是 UTC+05:30）。

# mobile - 移动设备的最佳实践身份验证

> ID：10918274
> 
> 赞同：0
> 
> 时间：2012-06-06T16:28:48.183
> 
> 标签：mobile, digest-authentication

我开发了一个网站，要求对某些部分进行用户注册和身份验证。现在我正在寻找一种最佳实践来从连接到服务器的移动应用程序中实现注册和身份验证。这个应用程序将使用 json 与服务器进行通信。我在考虑 HTTP 摘要，但我想听听其他人的意见。

只是为了记录，服务器是用 Grails (groovy) 编写的，并使用 spring security 进行身份验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:08:18.230

基本上你应该将“j_username”和“j_password”发布到“/j_spring_security_check?ajax=true”。

spring-security 插件安装了一个 LoginController，查看它以查看基于 ajax 登录的默认公开操作。

有关流程和代码示例的更深入信息：[grails-spring-security-core](http://grails-plugins.github.com/grails-spring-security-core/docs/manual/guide/single.html#9.4%20Ajax%20Authentication)

# linux - ipc:// 和并发上的 ZeroMQ REQ/REP

> ID：10918276
> 
> 赞同：2
> 
> 时间：2012-06-06T16:29:00.083
> 
> 标签：linux, unix, rpc, zeromq, json-rpc

我使用 REQ/REP 0MQ ipc:// 套接字实现了一个 JSON-RPC 服务器，我遇到了奇怪的行为，我怀疑这是由于 ipc:// 底层 unix 套接字不是真正的套接字，而是一根管子。

从文档中，必须强制执行严格的 zmq_send()/zmq_recv() 交替，否则无序的 zmq_send() 将返回错误。

但是，我希望执行是针对每个客户端，而不是每个套接字。当然，对于 Unix 套接字，从多个客户端到服务器只有一条管道，因此服务器不会知道它在与谁通信。两个客户端可以同时 zmq_send() 并且服务器会将此视为交替违规。

顺序可以是：

*   客户端A：zmq_send()
*   ClientB: zmq_send() : 它会阻塞直到另一个发送/接收完成吗？它会返回-1吗？（由于固有的低级问题，我怀疑它会使用 ipc:// ，但使用 TCP 可以区分两个客户端）
*   客户A：zmq_recv()
*   客户端B：zmq_recv()

那么 tcp:// 套接字呢？它会同时工作吗？我应该使用其他一些锁定机制来解决这个问题吗？

示例服务器：

```
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>

#include <czmq.h>

int main(void) 
{
    zctx_t *zctx   ;
    void *zsocket_rpc;

        printf ("rpcserver create context\n");
    zctx = zctx_new();
        printf ("rpcserver create socket\n");
    zsocket_rpc = zsocket_new (zctx, ZMQ_REP);
        if (!zsocket_rpc) {
                fprintf (stderr, "zsocket_rpc is NULL\n");

                exit(1);
        }
    zsocket_bind (zsocket_rpc, "ipc:///tmp/rpcserver");

        for(;;) {
                int rc;

                char *msg = zstr_recv(zsocket_rpc);
                printf ("rpcserver received %s\n", msg);

                printf ("rpcserver sleep\n");
                usleep(200000);

                printf ("rpcserver send %s\n", msg);
                rc = zstr_send(zsocket_rpc, msg);
                if (rc < 0) {
                        fprintf (stderr, "rpcserver zstr_send returned %d\n", rc);
                        continue;
                }
                free(msg);
        }

} 
```

示例客户端（作为 ./rpcclient letter 启动）：

```
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <czmq.h>

int main(int argc, char *argv[]) 
{
        char msg[] = "A:MESSAGE 999";
    zctx_t *zctx;
    void *zsocket_rpc;

        if (argc != 2) {
                fprintf (stderr, "Usage: rpcclient letter\n");
                exit(1);
        }

    zctx = zctx_new();
        printf ("rpcclient new socket\n");
    zsocket_rpc = zsocket_new (zctx, ZMQ_REQ);
        if (!zsocket_rpc) {
                fprintf (stderr, "zsocket_rpc is NULL\n");

                exit(1);
        }
        printf ("rpcclient connect\n");
    zsocket_connect (zsocket_rpc, "ipc:///tmp/rpcserver");

        for (int cnt = 0; cnt < 1000; cnt++) {
                int rc;

                sprintf (msg, "%c:MESSAGE %03d", argv[1][0], cnt);
                printf  ("rpcclient send %s\n", msg);
                rc = zstr_send(zsocket_rpc, msg);
                if (rc < 0) {
                        fprintf (stderr, "rpcclient zstr_send returned %d\n", rc);
                        continue;
                }
                printf ("rpcclient sleep...\n");
                usleep(200000);

                char *reply = zstr_recv(zsocket_rpc);
                printf  ("rpcclient recv %s\n", reply);

                free(reply);
        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T06:07:37.560

您必须解释哪些事件序列无法完成您想要的操作。这样就不清楚你的问题是什么了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T13:45:20.833

谢谢彼得。很抱歉，我今天进行的广泛测试证实，即使在 ipc:// 上有多个客户，REQ/REPLY 也是坚如磐石的，我认为这个问题已经结束。

（问题是由于多个线程调用 RPC 函数而没有锁定......像往常一样）

# matlab - 在 MATLAB 中的两个函数之间共享一个变量？

> ID：10918282
> 
> 赞同：5
> 
> 时间：2012-06-06T16:29:23.527
> 
> 标签：matlab

我在matlab中有两个函数，大致是这样的

```
function f1()
  setup_callback(@f2);
  a = 1;
  evaluate_callback();
end

function f2()
  ...
end 
```

其中 evaluate_callback 是调用 f2 的外部库函数。

我希望能够从 f2 内部读取 a 的当前值。有没有办法在不使用全局变量的情况下实现这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T16:55:08.590

在里面做`f2`一个嵌套函数`f1`：

```
function f1()
    setup_callback(@f2);
    a = 1;
    evaluate_callback();

    function f2()
      %# you can access a here
      disp(a)
    end
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T16:53:54.137

嵌套函数将提供您想要的范围。请注意，除了从 f1 内部或通过函数句柄之外，没有其他方法可以调用 f2 回调函数。所以 f1 可以返回`@f2`句柄，全局范围内的其他函数可以这样调用它。

```
function f1()
  setup_callback(@f2);
  a = 1;
  evaluate_callback();

  function f2()
    % refer to a
    ...
  end
end 
```

# flash - Netty Flash XmlSocket 消息接收错误

> ID：10918285
> 
> 赞同：1
> 
> 时间：2012-06-06T16:29:34.437
> 
> 标签：flash, netty, xmlsocket

我正在 netty 中创建自己的 Flash 游戏服务器。我在端口 843 中使用 flash 策略服务器，在 8080 中使用游戏服务器端口......另外，我使用 zerodelimeter 进行成帧；但是，当我在 flash 客户端上接收消息时，我收到了两条消息而不是一条消息。第一条信息是我应该得到的真实信息；但是，第二个是空消息。如何避免在 netty 端收到第二条消息？

谢谢，

在下面，您可以查看我的 ChannelPipelineFactory...

```
 public class SocketServerPipelineFactory implements ChannelPipelineFactory {

    public ChannelPipeline getPipeline() throws Exception {
        PlayerController controller = PlayerController.createPlayerController();

        ChannelPipeline pipeline = Channels.pipeline();

        pipeline.addLast("framer", new DelimiterBasedFrameDecoder(8192,
                zeroDelimiter()));
        pipeline.addLast("decoder", new StringDecoder(CharsetUtil.UTF_8));
        pipeline.addLast("encoder", new StringEncoder(CharsetUtil.UTF_8));

        pipeline.addLast("handler", new SocketServerHandler(controller));

        return pipeline;
    }

    public static ChannelBuffer[] zeroDelimiter() {
        return new ChannelBuffer[] { ChannelBuffers.wrappedBuffer(new byte[] { '\0' }),
                ChannelBuffers.wrappedBuffer(new byte[] { '\r', '\n' }) };
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:21:42.067

我认为您应该使用[nul 分隔符](http://docs.jboss.org/netty/3.2/api/org/jboss/netty/handler/codec/frame/Delimiters.html#nulDelimiter%28%29)而不是 0。这是一个提供 Flash 策略文件的[netty 游戏服务器。](https://github.com/menacher/java-game-server)[策略服务器](https://github.com/menacher/java-game-server/blob/master/jetserver/src/main/java/org/menacheri/jetserver/server/netty/FlashPolicyServer.java)在 843 运行。下面粘贴的是相关的 spring 配置，这里是策略[文件解码器](https://github.com/menacher/java-game-server/blob/master/jetserver/src/main/java/org/menacheri/jetserver/handlers/netty/FlashPolicyServerDecoder.java)供参考。

```
<!-- Configure the Flash policy server. By default it runs at 843 -->
<bean id="flashPolicyServer" class="org.menacheri.jetserver.server.netty.FlashPolicyServer"
    init-method="createServerBootstrap" destroy-method="stopServer">
    <property name="pipelineFactory" ref="flashPolicyServerPipelineFactory"></property>
    <property name="gameAdminService" ref="gameAdminService"></property>
    <property name="portNumber" value="${flash.policy.port}"></property>
</bean>

<!-- All the pipeline factory beans are now defined -->
<bean id="flashPolicyServerPipelineFactory" class="org.menacheri.jetserver.server.netty.FlashPolicyServerPipelineFactory">
    <lookup-method name="getFlashPolicyServerHandler" bean="flashPolicyServerHandler"/>
    <property name="timer" ref="hashedWheelTimer"></property>
</bean> 
```

# xna - Linking Content Project (XNA) to a non XNA project

> ID：10918287
> 
> 赞同：5
> 
> 时间：2012-06-06T16:29:42.220
> 
> 标签：xna, monogame, content-pipeline

Can I reference a Content Project to a Non-XNA project (MonoGame, if it's important)?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-07T02:19:36.417

Not directly.

The ability to add a content project reference to a project is only available for projects of the types "XNA Game" and "XNA Game Library".

One trick that I use when I want to build and include an XNA Content Project in a WinForms project is to make an empty XNA Game Library project. Reference the XNA Game Library project from the main (Windows) project, and the Content Project from the XNA Game Library project.

Whether this will work for MonoGame is another matter.

The alternative is to simply have a blank XNA Game project that references the content project. Then set up the project dependencies so the XNA Game will rebuild first if necessary. If you need to copy the output files around, perhaps do it as a post-build step?

The sledgehammer option would be to create a custom MSBuild file that does exactly what you want.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T17:17:42.010

I know you already have it solved but yesterday I was having the same problem, Tom Spillman sent me this link:

[https://github.com/mono/MonoGame/wiki/MonoGame-Content-Processing](https://github.com/mono/MonoGame/wiki/MonoGame-Content-Processing)

So apparently you can reference it directly

# ios - iPad 应用程序 - 在 airplay 中镜像应用程序

> ID：10918289
> 
> 赞同：0
> 
> 时间：2012-06-06T16:29:51.987
> 
> 标签：ios, airplay

我有一个图形丰富的儿童应用程序。
它没有任何视频。只有背景音频会在那里
它有一些活动，如数数、阅读字母等。
我可以使用 airplay 在苹果电视中镜像应用程序，以便他们在 iPad 应用程序上看到的内容也必须在电视上显示吗？
我用谷歌搜索了很多......但我找不到任何代码。但我读到它是可能的。有人可以指导如何继续使用此功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:36:17.007

要使用 AirPlay，您的应用程序不必做任何特别的事情。AirPlay 内置于 iOS，任何应用程序或游戏都可以利用它。用户只需双击主页按钮，向左滑动，按下 AirPlay 按钮并选择镜像选项。这适用于所有应用程序，包括视频和声音。

# java - 使用java抽象类

> ID：10918291
> 
> 赞同：2
> 
> 时间：2012-06-06T16:29:57.270
> 
> 标签：java, class, abstract

在我的 UI 项目中，我有几个屏幕共享相同的标题样式，只有文本特定于屏幕。什么是实现这一点的好方法？

1.  让超类创建所有的头部组件，并把组件开放给子类，子类会访问组件的setText方法来更新文本吗？

或者

1.  超类中有抽象方法来创建组件，子类将实现这些方法来创建组件。

希望有意义..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T16:35:37.880

你真的需要一个抽象类吗？

```
public class UIScreen {
     public UIScreen(String headerText) {
         //set everything up here w/ the right text
     }
}

// elsewhere ....

UIScreen mainScreen = new UIScreen("Main Screen"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:36:27.957

第二种选择更可行。

记住：[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)

这两个选项都有效，但第二个选项可以减少代码中的耦合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:36:35.837

当行为不断变化时......将其封装在抽象类或接口中。

最好有一个

```
 Abstract class, with the non-abstract method to create the Header, 
and an Abstract method to create the text 
```

..在子类中，您可以通过实现抽象方法来创建您选择的文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:37:02.377

“在超类中有抽象方法来创建组件，子类将实现这些方法来创建组件。”

在我看来，这个解决方案更容易维护。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T16:38:41.337

您可以稍微更改选项 1

```
public abstract class SuperUI {

   private HeaderComponenet headerComponent;//have getter setter

}

public class BaseUI extends SuperUI{
    private void changeHeaderComponent(){
       headerComponent.setText("Changed");
    }
}

public class HeaderComponent extends JComponent{
   public HeaderComponent(){
      //create the default header here
   }
} 
```

在这种情况下，如果必须更改默认页眉组件，则不必更改 SuperUI，因为您已将页眉与 SuperUI 分开，如果需要，您可以对页脚组件执行相同操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-06T16:33:02.200

使用通用头方法创建抽象类，并为所有子类定义一种方法来实现最好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-06T16:33:58.807

取决于您是否希望超类能够被实例化。这就像拥有一个`Animal`超类`Dog`和`Cat`子类。您是否希望人们能够创建泛型`Animal`？

如果是这样，它应该是一个正常的类。如果不是，则应声明`abstract`。

所以最终的问题是：是否存在默认行为？如果不是，则将其抽象化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-06T17:14:29.940

我的问题是子类有什么有用的功能吗？如果没有，您为什么不只拥有一个具体的类并将其传递给某种数据容器来填充字段？

如果没有行为差异，那么将数据和/或协作者传递给构造函数或通过属性设置器会更好。

# ruby-on-rails-3 - 将 underscore.js 与 rails 3 一起使用

> ID：10918292
> 
> 赞同：1
> 
> 时间：2012-06-06T16:30:06.833
> 
> 标签：ruby-on-rails-3, underscore.js

我一直在查看**underscore.js**并想将其添加到我的 rails 项目中。我已经在使用 jQuery。一起使用这两个库时是否有最佳实践？另外，你如何处理带有下划线的 jQuery 对象？您是否使用 jquery 选择一堆元素，然后通过**下划线**运行它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T21:07:24.500

我建议你在没有`underscore-rails`gem 的情况下使用它。这是非常没用的。

它只会为项目产生新的依赖关系。

没有理由害怕`underscore.js`直接使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T20:57:51.443

您可以在资产中手动包含下划线 js 文件，也可以使用此 gem：

[https://github.com/rweng/underscore-rails](https://github.com/rweng/underscore-rails)

Underscore 适用于 Javascript 集合和任何类型的对象，因此这些函数也适用于 jQuery 对象。

# python - Python FTP（来自 ftplib 模块）登录 SFTP 服务器失败

> ID：10918295
> 
> 赞同：0
> 
> 时间：2012-06-06T16:30:23.580
> 
> 标签：python

我正在做以下事情

```
>> from ftplib import FTP
>> s = FTP('host','user','password') # Connect 
```

它没有给出以下内容

```
Traceback (most recent call last):   File "<stdin>", line 1, in  <module>
   File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/ftplib.py", line 117, in __init__
     self.connect(host)
   File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/ftplib.py", line 132, in connect
     self.sock = socket.create_connection((self.host, self.port), self.timeout)
   File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py", line 571, in create_connection
     raise err socket.error: [Errno 60] Operation timed out 
```

*   我知道主机、用户、密码是正确的
*   如何调试/修复此错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T18:06:48.820

WinSCP（您一直使用它来连接到同一台服务器）支持 SFTP 和 SCP，而不是 FTP。

要使用 SFTP 编写 Python 程序，您应该使用[Paramiko](http://www.lag.net/paramiko/)库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T18:48:05.257

尝试这样做：

```
try:
    s = FTP(host)
    s.login(user, password)
except Exception, e:
    print "The error was:", str(e) 
```

# iphone - 无法将 NSString 转换为 NSDate 对象

> ID：10918297
> 
> 赞同：0
> 
> 时间：2012-06-06T16:30:41.997
> 
> 标签：iphone, ios

这是从我的服务器字符串的示例结果：

> 2011 年 12 月 24 日星期六 14:33:43 +0000

我正在尝试将其转换为 NSDate 并且一直为空。

这是我的代码：

```
NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
    [dateFormat setDateFormat:@"EEE, dd MMM yyyy HH:mm:ss +0000"];
    NSDate *date = [dateFormat dateFromString:dateString]; 
```

为什么我会得到空值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T16:49:19.397

它在这里工作正常。您可能希望您的格式是这样的：

```
@"EEE, dd MMM yyyy HH:mm:ss z" 
```

否则，如果服务器返回的时区不是 GMT，它将失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-28T07:19:01.683

试试这个

```
NSString *dateString =@"Sat, 24 Dec 2011 14:33:43 +0000";
NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
[dateFormat setDateFormat:@"EEE, dd MMM yyyy HH:mm:ss Z"];
[dateFormat setTimeZone:[NSTimeZone timeZoneWithAbbreviation:@"UTC"]];
NSDate *date = [dateFormat dateFromString:dateString];
NSLog(@"%@",date); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:49:56.203

您的代码一定有其他问题。检查您分配或分配 dateString 的位置。一开始可能是空的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:50:35.893

刚刚用你说你从服务器获取的字符串尝试了你的代码，它工作正常。我什至尝试了 mvds 所说的使用`[dateFormat stringFromDate:date]`它也返回正确的日期

# clojure - Java 互操作——Netty + Clojure

> ID：10918300
> 
> 赞同：6
> 
> 时间：2012-06-06T16:30:47.800
> 
> 标签：clojure, netty

我正在尝试通过clojure使用netty。我能够启动服务器，但是，它无法初始化一个接受的套接字。下面分别是错误信息和代码。有谁知道什么是/或可能是错的？我相信问题在于`(Channels/pipeline (server-handler))`谢谢。

**错误信息**

```
#<NioServerSocketChannel [id: 0x01c888d9, /0.0.0.0:843]>
Jun 6, 2012 12:15:35 PM org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink
WARNING: Failed to initialize an accepted socket.
java.lang.IllegalArgumentException: No matching method found: pipeline 
```

**项目.clj**

```
(defproject protocol "1.0.0-SNAPSHOT"
  :description "Upload Protocol Server"
  :dependencies [
    [org.clojure/clojure "1.2.1"]
    [io.netty/netty "3.4.5.Final"]]) 
```

**核心.clj**

```
(ns protocol.core
    (:import (java.net InetSocketAddress)
             (java.util.concurrent Executors)
             (org.jboss.netty.bootstrap ServerBootstrap)
             (org.jboss.netty.channel Channels ChannelPipelineFactory SimpleChannelHandler)
             (org.jboss.netty.channel.socket.nio NioServerSocketChannelFactory)
             (org.jboss.netty.buffer ChannelBuffers)))

(def policy
    "<content>Test</content>")

(defn server-handler
    "Returns netty handler."
    []
    (proxy [SimpleChannelHandler] []
        (messageReceived [ctx e]
            (let [ch (.getChannel e)]
                (.write ch policy)
                (.close ch)))

        (channelConnected [ctx e]
            (let [ch (.getChannel e)]
                (.write ch policy)
                (.close ch)))

        (exceptionCaught [ctx e]
            (let [ex (.getCause e)]
                (println "Exception" ex)
                (-> e .getChannel .close)))))

(defn setup-pipeline
    "Returns channel pipeline."
    []
    (proxy [ChannelPipelineFactory] []
        (getPipeline []
            (Channels/pipeline (server-handler)))))

(defn startup
    "Starts netty server."
    [port]
    (let [channel-factory (NioServerSocketChannelFactory. (Executors/newCachedThreadPool) (Executors/newCachedThreadPool))
          bootstrap (ServerBootstrap. channel-factory)]
        (.setPipelineFactory bootstrap (setup-pipeline))
        (.setOption bootstrap "child.tcpNoDelay" true)
        (.setOption bootstrap "child.keepAlive" true)
        (.bind bootstrap (InetSocketAddress. port)))) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T18:22:37.910

您的代码存在三个问题

1.  Java 与 vararg Channels.channel() 方法的互操作。您可以制作一个通道处理程序向量并将其包装为`(into-array ChannelHandler ..)`

2.  您不能将 String 对象直接写入 Netty Channel。您必须先将字符串写入 ChannelBuffer 并写入该缓冲区或使用 StringCodecHandler。

3.  写入 Netty 频道是异步的，所以你不能立即关闭它。您必须注册一个未来的听众并在完成后关闭频道。

这是工作代码。

```
 (ns clj-netty.core
   (:import (java.net InetSocketAddress)
            (java.util.concurrent Executors)
            (org.jboss.netty.bootstrap ServerBootstrap)
            (org.jboss.netty.buffer ChannelBuffers)
            (org.jboss.netty.channel Channels ChannelFutureListener ChannelHandler ChannelPipelineFactory SimpleChannelHandler)
           (org.jboss.netty.channel.socket.nio NioServerSocketChannelFactory)
           (org.jboss.netty.buffer ChannelBuffers)))

(def policy
  (ChannelBuffers/copiedBuffer
    (.getBytes "<content>Test</content>")))

(defn server-handler
  "Returns netty handler."
  []
  (proxy [SimpleChannelHandler] []
    (messageReceived [ctx e]
      (let [ch (.getChannel e)]
        (.addListener
          (.write ch policy)
          (ChannelFutureListener/CLOSE))))

    (channelConnected [ctx e]
      (let [ch (.getChannel e)]
        (.addListener
          (.write ch policy)
          (ChannelFutureListener/CLOSE))))

    (exceptionCaught [ctx e]
      (let [ex (.getCause e)]
        (println "Exception" ex)
        (-> e .getChannel .close)))))

(defn setup-pipeline
  "Returns channel pipeline."
  []
  (proxy [ChannelPipelineFactory] []
    (getPipeline []
      (let [handler (server-handler)]
        (Channels/pipeline (into-array ChannelHandler [handler]))))))

 (defn startup
      "Starts netty server."
      [port]
      (let [channel-factory (NioServerSocketChannelFactory. (Executors/newCachedThreadPool) (Executors/newCachedThreadPool))
            bootstrap (ServerBootstrap. channel-factory)]
        (.setPipelineFactory bootstrap (setup-pipeline))
        (.setOption bootstrap "child.tcpNoDelay" true)
        (.setOption bootstrap "child.keepAlive" true)
        (.bind bootstrap (InetSocketAddress. port)))) 
```

看一下[Aleph](https://github.com/ztellman/aleph)（也使用 Netty），它可以使用漂亮的 Clojure API 在许多不同的协议中构建客户端和服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-27T17:50:03.047

在 2021 年，在 Netty 之上构建 Clojure 服务的最简单方法是采用 Donkey，它提供了与使用 Netty 作为后端的 Vert.x 的良好 Clojure 互操作性。Donkey 相对较新，还没有很多文档，因此请查看此[博客](https://glennengstrand.info/software/architecture/microservice/clojure/vertx)，其中涵盖了相关的开源项目（可用源代码），包括架构、设计、编码和负载测试。

# vb.net - vbnet 多个组合框填充一个数据集

> ID：10918302
> 
> 赞同：1
> 
> 时间：2012-06-06T16:30:54.067
> 
> 标签：vb.net, combobox, dataset

我有以下代码使用一个数据集填充两个组合框：

```
Private Sub sub_cbo_type_load()
    Dim ds As New DataSet
    ds = cls.cbo_type()
    If ds IsNot Nothing _
    AndAlso ds.Tables.Count > 0 _
    AndAlso ds.Tables(0).Rows.Count > 0 Then
        Me.r_cbo_type.DataSource = ds.Tables(0)
        Me.r_cbo_type.DisplayMember = "desc"
        Me.r_cbo_type.ValueMember = "code"
        Me.r_cbo_type.SelectedIndex = -1
        Me.m_cbo_type.DataSource = ds.Tables(0)
        Me.m_cbo_type.DisplayMember = "desc"
        Me.m_cbo_type.ValueMember = "code"
        Me.m_cbo_type.SelectedIndex = -1
    End If
End Sub 
```

问题是：每当在一个组合框中更改索引时，另一个组合框中的索引也会自动更改。

有谁知道我该如何解决这个问题？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:44:45.727

尝试克隆表：

```
Private Function CopyTable(ByVal sourceTable As DataTable) As DataTable
  Dim newTable As DataTable = sourceTable.Clone
  For Each row As DataRow In sourceTable.Rows
    newTable.ImportRow(row)
  Next
  Return newTable
End Function 
```

那么您的数据源将引用不同的源：

```
Me.r_cbo_type.DataSource = CopyTable(ds.Tables(0))

Me.m_cbo_type.DataSource = CopyTable(ds.Tables(0)) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-01-07T03:51:26.763

这样做

```
 Private Sub btn_update1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btn_update1.Click
        If MsgBox("Are you sure to update?" & "", MsgBoxStyle.YesNo, "Confirmation") = MsgBoxResult.Yes = True Then
            Dim transmode As String = vbNullString
            Dim byair As String = vbNullString
            Dim bysea As String = vbNullString
            If rb_air.Checked = True Then
                transmode = "A"
                byair = txt_mserial.Text '.Substring(txt_mserial.TextLength - 4, 4)
                bysea = vbNullString
            ElseIf rb_sea.Checked = True Then
                transmode = "B"
                byair = vbNullString
                bysea = txt_mserial.Text '.Substring(txt_mserial.TextLength - 4, 4)
            End If
            Try
                If con.State = ConnectionState.Closed Then con.Open()
                global_command = New SqlCommand("update ytmi_finished_products set rev_ctrl_no = '" & txt_mrev.Text & "', by_air = '" & byair & "', by_sea = '" & bysea & "', transport_mode = '" & transmode & "' where REPLACE(prod_no, '-', '') +'-'+ ISNULL(CONVERT(varchar(50), prod_sx), '') + prod_lvl = '" & txt_mpart.Text & "' and cast(serial_no as numeric) = '" & txt_mserial.Text & "' and req_box_qty = '" & txt_mqty.Text & "' and remarks is null", con)
                global_command.ExecuteNonQuery()
                global_command.Dispose()

                MsgBox("Successfully Updated!", MsgBoxStyle.Information, "Message")
                mclear()
            Catch ex As Exception
                MsgBox("Trace No 20: System Error or Data Error!" + Chr(13) + ex.Message + Chr(13) + "Please Contact Your System Administrator!", vbInformation, "Message")
            End Try
        End If
    End Sub 
```

# javascript - 如何在 jquery 中为元素选择器执行 OR？

> ID：10918307
> 
> 赞同：1
> 
> 时间：2012-06-06T16:31:07.143
> 
> 标签：javascript, jquery

> **可能重复：**
> [将两个选择器与一个 jQuery 对象组合](https://stackoverflow.com/questions/10515888/combine-two-selectors-with-one-jquery-object)

我有以下 jquery 代码：

```
 $("#try").click(function(){
  ... 
```

如果我单击`#try`，浏览器将执行该功能。假设我想添加另一个元素，`#try2`它将执行相同的功能。我如何`or`在上面的代码中添加一个？我试过用，

```
 $("#try" or "#try2").click(function(){
  ... 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T16:32:09.380

你只有`try`，`try2`然后你应该去

```
 $("#try, #try2").click(function(){
    // your code
 }); 
```

您可以在其中使用逗号分隔的多个选择器`$()`

* * *

但如果你有更多然后尝试

```
 $("[id^=try]").click(function(){
    // your code
 }); 
```

这会将 click 事件绑定到以、 like或or等`id`​​开头的元素。`try``try``try1``try2`

* * *

## 根据评论

### 如何检测点击元素的 id

```
 $("#try, #donttry").click(function(){
    if(this.id == 'try') {
     // do something when try
    } else {
      // do something when donttry
    }
 }); 
```

**[证明](http://jsfiddle.net/thecodeparadox/QStkd/161/)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T16:32:33.207

只需用昏迷将它们分开即可。

```
$( "#try, #try2" ).click( function() {
}); 
```

# javascript - Blogger 代码图像链接到帖子页面

> ID：10918308
> 
> 赞同：0
> 
> 时间：2012-06-06T16:31:08.447
> 
> 标签：javascript, jquery, html, xml, blogger

这可以在博客中实现吗？

我的目标是使静态页面图像变得可点击并将其链接到实际的帖子页面。

我知道通过编辑每个帖子是可能的，但我想让它自动化。例如：在 9gag.com 中，当您从主页单击图片时，它实际上会将您链接到帖子页面。

我想做同样的事情，但在博客中。像这样的东西

```
<b:if cond='data:blog.pageType == "static_page"'><a expr:href='data:post.url'><static page images></a></b:if> 
```

截屏：![在此处输入图像描述](../Images/8f18d41afdffe1790d9b8cfbaa12c845.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:52:49.020

鉴于 jQuery 是可用的，你应该能够用这样的东西来做到这一点：

```
$('a.title').each(function() {
    var href = this.href;
    $(this).next('.article').find('img:not(a img)').each(function() {
        var a = $('<a/>', {
            'href': href
        });
        $(this).replaceWith(a);
        a.append(this);
    });
}); 
```

当然不知道你的 HTML 的结构，我只是编了类名。

# android - 当我单击其中的 imageview 时检测 expandiblelistview 组

> ID：10918309
> 
> 赞同：1
> 
> 时间：2012-06-06T16:31:10.203
> 
> 标签：android

`ExpandableListView`当我单击该组的内部时，我正在尝试扩展一`ImageView`组。我试过这个：

```
 expLista.setOnGroupClickListener(new OnGroupClickListener() {

        @Override
        public boolean onGroupClick(ExpandableListView parent, View v,
                int groupPosition, long id) {
            grupoCLickeado = groupPosition;
            ImageView btnExpandir = (ImageView) v
                    .findViewById(R.id.imgExpandir);
            // btnExpandir.setFocusable(false);
            btnExpandir.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View v) {
                    LinearLayout parentRow = (LinearLayout) v.getParent()
                            .getParent();

                    expLista.expandGroup(grupoCLickeado);
                }
            });

            return true;
        }
    }); 
```

但这仅适用于每次我想折叠或展开组时，我单击组的空白区域。

否则我无法获取组 ID，当我在`ImageView`一行内部单击时，它不会检测到哪个组是 this 的组`ImageView`。

我怎样才能检测到这个？

# xml - XML 多重签名有标准吗？

> ID：10918314
> 
> 赞同：5
> 
> 时间：2012-06-06T16:31:42.583
> 
> 标签：xml, security, w3c, digital-signature

我已经检查了 W3C 网站上的 XML 签名语法和处理，但是它几乎没有提到多重签名。是否有在一个 xml 文件上创建多重签名的标准或规则？谢谢

示例：（仅考虑同文件引用）

原始xml

```
<root>
  <item>
    <name>Apple</name>
    <price>100</price>
  </item>
</root> 
```

第一个 A 用信封签名签名

签名的 XML

```
<root>
  <item>
    <name>Apple</name>
    <price>100</price>
  </item>
  <Signature>this is Signature signed by A with Ref URL=""</Signature>
</root> 
```

现在，B 想要签署 XML（包含 A 的签名）

B 签名的 XML

```
<root>
  <item>
    <name>Apple</name>
    <price>100</price>
  </item>
  <Signature>Signature A: this is Signature signed by A with Ref URL=""</Signature>
  <Signature>Signature B: this is Signature signed by B with Ref URL=""</Signature>
</root> 
```

然后，当涉及到验证时，它变得混乱......

对于签名 A，在验证时，它看到

```
<root>
  <item>
    <name>Apple</name>
    <price>100</price>
  </item>
  <Signature>Signature B: this is Signature signed by B with Ref URL=""</Signature>
</root> 
```

但它实际签署的是

```
<root>
  <item>
    <name>Apple</name>
    <price>100</price>
  </item>
</root> 
```

（请注意，由于包络变换，签名和验证时会删除一个人的签名节点）在进行包络签名时将签名节点视为根可以解决相同的问题。但是如果涉及多个引用，它可能会变得更加复杂。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T16:54:35.533

使用当前 XMLDSig 标准在一组节点上制作多个签名并将它们包含到同一个 XML 文档中没有问题。不需要特殊的规则或标准。

对于您的示例，每个签名（应该）不是在“根”上制作，而是在“项目”节点（或项目节点集）上制作。因此，签名 B 不涵盖签名 A 作为要签名的数据。

# android - 动画停止后如何定位ScrollView

> ID：10918316
> 
> 赞同：0
> 
> 时间：2012-06-06T16:31:48.720
> 
> 标签：android, android-widget, android-animation

我有一个包含 LinearLayout 的 ScrollView，在 LinearLayout 中我有一个视图，我根据按下的按钮展开或折叠。这件作品很好。

我想做的是重新定位 ScrollView 以便在展开视图时自动重新定位滚动视图，以便展开视图可见。我想让视图自动重新定位它，这样用户就不必滚动了。
目前，当视图展开时，所有内容都会被向下推，您必须向上滚动才能查看新展开的内容。我尝试在动画结束后重新定位，但那段代码永远不会触发。下面是我的代码。

```
public void animateExpandCollapse(View v) {

        View captionLayout = null;
        View parentLayout  = null;

        if(v.getId() == R.id.squareCal) {
            captionLayout = (LinearLayout) findViewById(R.id.layout3);
            parentLayout  = (LinearLayout) findViewById(R.id.squareLayout);
        } else if(v.getId() == R.id.circleCal) {
            captionLayout = (LinearLayout) findViewById(R.id.layout2);
            parentLayout  = (LinearLayout) findViewById(R.id.circleLayout01);
        }

        if (!more) {
            dda = new DropDownAnim(captionLayout, 350, false);
            more=true;
        } else {
            dda = new DropDownAnim(captionLayout, 350, true);
            more=false;
        }
        dda.setDuration(350);
        parentLayout.startAnimation(dda);

        // Here, I want to position ScrollView to the bottom
        // After the animation has finished but this never fires.
        if(dda.hasEnded() ) {
            ScrollView sv = (ScrollView)findViewById(R.id.calScroller);
            sv.scrollTo(0, sv.getBottom());
        }

        return;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T01:06:53.723

在网上搜索后，我找到了以下解决方案。我希望这可以帮助别人。

```
dda.setAnimationListener(new AnimationListener() {
            @Override
            public void onAnimationStart(Animation animation) {
            }
            @Override
            public void onAnimationRepeat(Animation animation) {
            }
            @Override
            public void onAnimationEnd(Animation animation) {
                ScrollView sv = (ScrollView)findViewById(R.id.calScroller);
                sv.scrollTo(0, sv.getBottom());
            }
        }); 
```

# iphone - 可以将下载的图像/文件添加到我的应用程序包中吗？

> ID：10918319
> 
> 赞同：2
> 
> 时间：2012-06-06T16:31:57.113
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我有一个允许我下载字符（图像）、声音等的应用程序。当用户选择要下载的字符时，我可以将其存储在我的 App Bundle 的目录中吗？如果没有，存储我的内容（数据）的最佳位置在哪里？我在考虑文档目录，但后来我在某处看到 Apple 现在希望将数据存储在缓存目录中。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T16:55:10.873

> 我可以将它存储在我的 App Bundle 的目录中吗？

不，您不能修改应用程序包。

> 如果没有，存储我的内容（数据）的最佳位置在哪里？

*   如果您的应用必须支持 iOS 5.0 或更早版本，您需要将应用数据存储在`Caches`目录中。但是，请记住，文件可能会在空间不足的情况下被删除，因此如果您的应用数据被删除，您的应用将需要正常降级。

*   从 iOS 5.0.1 开始，您可以将数据文件存储在 Documents Directory 中并将[它们标记为“不备份”](http://developer.apple.com/library/ios/#qa/qa1719/_index.html#//apple_ref/doc/uid/DTS40011342)。通过标记文件，您的应用程序符合*应用程序负责确保仅将用户数据而不是应用程序数据备份到 iCloud 和 iTunes* 并避免 Apple 可能拒绝的准则。在这种情况下，文件不会在空间不足的情况下被删除。

*   从 iOS 5.1 开始，您可以将数据文件存储在 Documents Directory 中，并使用文件属性`NSURLIsExcludedFromBackupKey`或`kCFURLIsExcludedFromBackupKey`文件属性从备份中排除文件。这些 API 中的任何一个都优于将它们标记为“不备份”。在这种情况下，您的应用程序符合 App Store 指南，并且文件不会在空间不足的情况下被删除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T00:04:36.797

## 我知道这是一个相当长的讨论，但您可能应该阅读它。:)

**[iOS 数据存储指南](http://developer.apple.com/icloud/documentation/data-storage/)指出：**

为确保备份尽可能高效，请务必按照以下准则存储应用程序的数据：

1.  只有用户生成的或应用程序无法重新创建的文档和其他数据，才应存储在 /Documents 目录中，并由 iCloud 自动备份。

2.  可以再次下载或重新生成的数据应存储在 /Library/Caches 目录中。您应该放在 Caches 目录中的文件示例包括数据库缓存文件和可下载内容，例如杂志、报纸和地图应用程序使用的内容。

3.  仅临时使用的数据应存储在 /tmp 目录中。虽然这些文件没有备份到 iCloud，但请记住在完成后删除这些文件，以免它们继续占用用户设备上的空间。

* * *

如果您有 OS X 或 Unix 背景，很容易理解 Apple 的立场，即此类目录无法保证其中的数据将保留多长时间。

*应用程序沙箱中的tmp*目录与根*/tmp*目录不同，这一事实不应影响您对该目录的看法。

如果您过去从未观察到文件从这些目录中删除，则不能保证将来不会更改。特别是当更改符合文档时。这是一般规则。

* * *

**Apple 文档中的更改/差距：**

直到 2011 年 6 月 29 日，Apple 关于 /Documents 的文档说：

*使用此目录来存储用户文档和应用程序数据文件。*

这很清楚。难怪开发人员会不高兴 iOS 5 中 Documents 目录的规则发生了变化，但没有任何合适的替代方案。

**关于/库/缓存：**

*使用此目录来编写您希望在应用程序启动之间或应用程序更新期间保留的任何特定于应用程序的支持文件。*您的应用程序通常负责添加和删除这些文件。它还应该能够根据需要重新创建这些文件，因为 iTunes 会在设备完全恢复期间删除它们。

* * *

**应用审核拒绝**

开发人员报告说，在 Documents 目录中存储任何/一些/很多数据的应用程序被 App Review 拒绝。

App Review 团队不太可能详细了解哪些文件存储在哪个目录中，哪些是用户生成的，哪些是可以再次下载或重新生成的数据。一些开发人员报告称，他们成功地回应了 App Review 团队，解释了他们的应用程序如何存储数据以及如何符合规则。

**iTunes 和 iCloud 正在备份什么**

备份应用程序主目录中的所有内容，但以下内容除外：

*   应用程序包本身 (.app)
*   /tmp 目录
*   /图书馆/缓存目录

其他文档明确指出，应用程序支持目录也由 iTunes（可能是 iCloud）备份。在讨论中，一些开发人员建议应用程序支持目录会比缓存更安全（= 更永久）。在我看来，App Review 似乎会以与 Documents 目录相同的热情来处理存储在 Application Support 中的大量数据，因为它完全是关于 iCloud 存储的。

**iOS 5 中的行为变化**

从 iOS 5 开始，如果设备遇到磁盘空间不足警告，则 /Library/Caches 可能会在您的应用未运行时被清除。

不再有您的应用可以存储以下文件的目录：

*   未备份到 iTunes/iCloud
*   没有被清除的风险

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T16:45:43.093

根据 Apple 的指南，下载的内容不应存储在 Documents 目录中：

```
Only documents and other data that is user-generated, or that cannot otherwise be recreated by your application, should be stored in the <Application_Home>/Documents 
```

改用 /Library/Caches 目录

```
Data that is used only temporarily should be stored in the <Application_Home>/tmp directory. 
```

# mysql - 在 MySQL 中使用子查询删除

> ID：10918327
> 
> 赞同：0
> 
> 时间：2012-06-06T16:32:27.203
> 
> 标签：mysql, subquery, sql-delete

我想转换以下

```
SELECT * `members` m
WHERE NOT EXISTS
  (SELECT s.mid
   FROM   memberships s 
   WHERE  s.mid = m.id); 
```

到等效的删除语句。但是，下面的代码不起作用：

```
DELETE FROM `members` m
WHERE NOT EXISTS
  (SELECT s.mid
   FROM   memberships s 
   WHERE  s.mid = m.id); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:36:17.163

您可以使用多表`DELETE`语法在表之间执行外连接：

```
DELETE FROM members
USING members LEFT JOIN memberships ON memberships.mid = members.id
WHERE memberships.mid IS NULL 
```

# php - 通过代码提交表单

> ID：10918330
> 
> 赞同：0
> 
> 时间：2012-06-06T16:32:37.867
> 
> 标签：php, form-submit

我正在尝试以编程方式提交表单，但收到一条错误消息： SCRIPT5007: Unable to get value of the property 'submit': object is null or undefined verify1.php, line 9 character 5

谁能看到我做错了什么？这是代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script type="text/javascript">
function submitform()
{
    document.getElementById("repeatForm").submit();
}
</script>
</head>

<body>
  <?php  
  require_once('recaptchalib.php');  
  $privatekey = "6Ld1N9ISAAAAAB_lXt0Es0muh2cfikSgVrUP4ZXh";  
  $resp = recaptcha_check_answer ($privatekey,
                                  $_SERVER["REMOTE_ADDR"],
                                 $_POST["recaptcha_challenge_field"],                                
                                 $_POST["recaptcha_response_field"]);  
if (!$resp->is_valid) {    
// What happens when the CAPTCHA was entered incorrectly    
echo '<script language="JavaScript">submitform();</script>'; 
; 
/*echo "<script>window.location.href = 'Information-Request-Voodoo-Websites.php';</script>";*/
        } else {
        echo "<script>window.location.href = 'Confirm-Information-Request.html';</script>";   
        // Your code here to handle a successful verification  
        }  ?>

        <?php
if (isset($_POST['name2'])) $_SESSION['name2'] =$_POST['name2'];
if (isset($_POST['phone'])) $_SESSION['phone'] =$_POST['phone'];
if (isset($_POST['email'])) $_SESSION['email'] =$_POST['email'];
if (isset($_POST['company'])) $_SESSION['company'] =$_POST['company'];
if (isset($_POST['pages'])) $_SESSION['pages'] =$_POST['pages'];
if (isset($_POST['shopping'])) $_SESSION['shopping'] =$_POST['shopping'];
if (isset($_POST['new'])) $_SESSION['new'] =$_POST['new'];
if (isset($_POST['general'])) $_SESSION['general'] =$_POST['general'];
if (isset($_POST['respond'])) $_SESSION['respond'] =$_POST['respond'];
?>

          <form id="repeatForm" action="Information-Request-Voodoo-Websites.php" method="post">

    <span name="sprytextfield1">
      <label for="name2">Please enter your name:</label>
      <input name="name" type="text" class="inputTextBoxFormat" id="name2" value="<?php echo((isset($_POST["name"]))?$_POST["name"]:"") ?>" size="30" />
      <span class="textfieldRequiredMsg">A value is required.</span></span>
    <p><span id="sprytextfield2">
      <label for="phone">Please enter your phone number:</label>
      <input name="phone" type="text" class="inputTextBoxFormat" id="phone" value="<?php echo((isset($_POST["phone"]))?$_POST["phone"]:"") ?>" />
      <span class="textfieldRequiredMsg">A value is required.</span></span></p>
    <p><span id="sprytextfield3">
      <label for="email">Please enter your email address:</label>
      <input name="email" type="text" class="inputTextBoxFormat" id="email" value="<?php echo((isset($_POST["email"]))?$_POST["email"]:"") ?>" size="40" />
      <span class="textfieldRequiredMsg">A value is required.</span><span class="textfieldInvalidFormatMsg">Invalid format.</span></span></p>
    <p><span id="sprytextarea1">
      <label for="company">Enter a brief description of your company:</label>
      <br />
      <textarea name="company" cols="65" rows="3" class="inputTextBoxFormat" id="company"><?php echo((isset($_POST["company"]))?$_POST["company"]:"") ?></textarea>
      <span class="textareaRequiredMsg">A value is required.</span></span></p>
    <p>Anticipated number of pages:<span id="sprytextfield4">
    <label for="pages"></label>
    <input name="pages" type="text" class="inputTextBoxFormat" id="pages" value="<?php echo((isset($_POST["pages"]))?$_POST["pages"]:"") ?>" size="7" />
    <span class="textfieldRequiredMsg">A value is required.</span></span><span id="spryselect1">
        <label for="shopping">Shopping cart required?</label>
        <select name="shopping" class="inputTextBoxFormat" id="shopping">
          <option value="yes">yes</option>
          <option value="no">no</option>
        </select>
      <span class="selectRequiredMsg">Please select an item.</span></span></p>
    <p><span id="spryselect2">
      <label for="new">Does this work concern a new or existing web site?</label>
      <select name="new" class="inputTextBoxFormat" id="new">
        <option value="existing" <?php if (!(strcmp("existing", ((isset($_POST["new"]))?$_POST["new"]:"")))) {echo "selected=\"selected\"";} ?>>existing</option>
        <option value="new" <?php if (!(strcmp("new", ((isset($_POST["new"]))?$_POST["new"]:"")))) {echo "selected=\"selected\"";} ?>>new</option>
        </select>
      <span class="selectRequiredMsg">Please select an item.</span></span></p>
    <p><span id="sprytextarea2">
      <label for="general">Add any additiional comments here or ask questions. </label>
      <textarea name="general" cols="65" rows="4" class="inputTextBoxFormat" id="general"><?php echo((isset($_POST["general"]))?$_POST["general"]:"") ?></textarea>
</span></p>
    <p><span id="spryselect3">
      <label for="respond">How would you like us to respond?</label>
      <select name="respond" class="inputTextBoxFormat" id="respond">
        <option value="email" <?php if (!(strcmp("email", ((isset($_POST["respond"]))?$_POST["respond"]:"")))) {echo "selected=\"selected\"";} ?>>email</option>
        <option value="phone" <?php if (!(strcmp("phone", ((isset($_POST["respond"]))?$_POST["respond"]:"")))) {echo "selected=\"selected\"";} ?>>phone</option>
        </select>
<input type="submit" name="formSubmit" value="Submit" />
  </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:38:46.850

您的问题是您正在尝试在加载表单之前提交表单。

只需将您的提交行向下推或在主体标签的 onload 事件中执行它。

```
<?php
if(!$resp->is_valid) {
    $submit=' onload="submitform()"';
} else {
    $submit="";
}
?>
<body<?php echo($submit); ?>> 
```

# c# - 解析 HTML 标签以查找特定的表格行

> ID：10918331
> 
> 赞同：0
> 
> 时间：2012-06-06T16:32:42.640
> 
> 标签：c#, html-agility-pack

大家好，我设置了一个挑战，我必须解析一个 HTML 页面来找到所有课程的结束日期。我正在使用 HTMLAgilityPack，但这是我第一次使用它，设置它的网页也没有类或 Id，结束日期存储在 Tr H4 标记中。我不确定如何解析任何命中？

我的代码：

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.Load(txtURL.Text);

sw.WriteLine("GET /academics/academic-calendar/ HTTP/1.1");
sw.WriteLine();
String response = sr.ReadToEnd();

txtHTML.Text = response; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:36:27.843

`HtmlDocument`可以查询对象 - 您可以使用[XPath](http://www.w3.org/TR/xpath/)查找遵循特定路径或其他约束的所有元素，也可以使用 LINQ 进行查询。

我建议下载源包——它带有许多带有使用示例的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:37:55.587

使用 XPath 可以让您获得所需的东西。这是一个如何从声明的 html 中获取所有表行的示例。

```
HtmlDocument htmlDocument = Markup.Parser();                                  
htmlDocument.LoadHtml(html);
htmlDocument.DocumentNode.SelectNodes("/tr"); 
```

# c# - 用于在 solr 查询中使用 c# 修复“and”和“or”的正则表达式

> ID：10918337
> 
> 赞同：0
> 
> 时间：2012-06-06T16:33:11.037
> 
> 标签：c#, regex, solr

我们需要处理用户通过 ac# dot net web app 输入的 AND 和 OR 来解决 "q=" 查询。它还必须正确处理引用的短语（这是困难的部分......）。

Da 规则：必须删除“或”，除非它在带引号的字符串中。'And' 必须全部大写，除非它在带引号的字符串中。

当然，问题在于匹配 OR 的正则表达式也匹配“OR”，我们需要一个匹配 OR 但*不*匹配“OR”的正则表达式。

给定输入：A OR B, c "OR" d,"e OR f"

输出必须是：AB, c "OR" d,"e OR f"

给定输入：A 和 B，c“和”d，“e 和 f”

输出必须是：A AND B, c "and" d,"e and f"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:33:12.457

解决方案：匹配 OR 和“OR”（或 AND 和“AND”）（说快 5 倍），并使用自定义替换委托来确定我们是否正在替换，是这样，是什么。

```
public string Fixup(string input)
{
//matches any quoted string containing the words OR or AND: "a and b" matches, 
//"andor" does not. 
string pattern1=@"""\w*?\W*?\b(AND|OR)\W*?\w*?"""; 
string pattern2=@"\b(AND|OR)\b"; //matches AND or OR as standalone words
string pattern3=pattern1+"|"+pattern2;//matches either pattern

MatchEvaluator Eval=ReplaceMatch;//set the delegate

string output=Regex.Replace(input,pattern3,Eval,RegexOptions.IgnoreCase);

return output;
}

public string ReplaceMatch(Match m)
{
string str=m.Value;
if(str.Contains("\""))return str;//do nothing if it's a quoted string
if(str.ToLower().Contains("or")) return String.Empty;//strip out 'or' from the query
return str.ToUpper();// string is 'and', uppercase it.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:04:47.013

假设 " 不能在带引号的字符串中转义，您还可以在 MatchEvaluator 中使用组，如下所示：

```
// Check for "[^"]*" first to filter out any quoted strings
// Assign any matches of AND to the "AND" group
// Assign any matches of OR to the "OR" group
const string pattern = @"(""[^""]*"")|\s+((?<AND>AND)|(?<OR>OR))\s+";

public static string FixUp(string s)
{
    return Regex.Replace(s, pattern, ReplaceANDsAndORs, RegexOptions.IgnoreCase);
}

public static string ReplaceANDsAndORs(Match m)
{
    if (m.Groups["AND"].Length > 0)
    {
        return " AND ";
    }
    else if (m.Groups["OR"].Length > 0)
    {
        return " ";
    }
    else
    {
        return m.Value;
    }
} 
```

**更新**：“AND”匹配的处理正在删除它们周围的空白（即“a 和 b”被更新为“aANDb”）。这已得到纠正。

# tfs - TFS 报告问题。可报告字段

> ID：10918341
> 
> 赞同：4
> 
> 时间：2012-06-06T16:33:31.113
> 
> 标签：tfs, reporting

我对 TFS 报告有疑问。这是情况。我想在一些报告中包含一个名为“发行说明”的字段。这个字段是一个 HTML 文件，据我所知不能设置为可报告。

我可以将信息从 HTML 字段复制到字符串字段。字符串是可报告的。但是它们只有 256 个字符。

因此，鉴于这些条件，我将如何让“发布说明”HTML 字段中的数据最终可报告。

我一直在到处寻找，找不到任何好的解决方案。

感谢您的关注。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:57:50.473

您可以使用[reportable=detail](http://msdn.microsoft.com/en-us/library/ms194980.aspx#Reporting)让它们显示在仓库中。它们不会在多维数据集中，但您至少可以报告它们。

# c++ - 迭代自定义分类对象列表

> ID：10918343
> 
> 赞同：1
> 
> 时间：2012-06-06T16:33:49.893
> 
> 标签：c++, iteration

所以我查找了这个问题并使用了给定的解决方案并想出了这段代码：

```
list<Projectile*>::iterator bullet;
for(bullet = bullets.begin(); bullet != bullets.end(); bullet++)
    .
            .
            .               
} 
```

问题：没有运算符 '=' 匹配这些操作数。与 != 相同...我不知道为什么：/

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T16:40:36.663

至少根据您的评论，您正在尝试使用 a`list<Projectile *>::iterator`需要的`list<Projectile>::iterator`地方。

顺便说一句，1)`list`很少是容器的最佳选择，2) 大多数时候，最好使用预先打包的算法迭代集合，而不是编写循环。

# wpf - WPF MultiLanguage 我应该从服务器（WCF）还是客户端读取资源？

> ID：10918346
> 
> 赞同：0
> 
> 时间：2012-06-06T16:34:04.353
> 
> 标签：wpf, wcf

我正在 WPF 和 WCF 中创建一个多语言应用程序……我所有的业务逻辑都由 WCF 公开。

从服务器或本地加载我的资源的最佳方式是什么？

1.  本地：在本地加载客户端的所有资源。

2.  服务器：通过网络传递所有资源（xaml），在本地缓存所有资源。我应该失去性能吗？

所有的选择都应该被重视。

Tks，威廉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:33:26.817

我的观点是客户端与用户交互，所以应该本地化，所以资源属于客户端。另一方面，服务与其他软件交互，所以它应该是文化独立的，所以它不应该需要本地化资源。因此，由于资源以某种方式自然地属于客户端的域，我也会将它们与客户端一起部署。

# visual-studio - 奇怪的行为：立即窗口启动应用程序而不是评估表达式

> ID：10918348
> 
> 赞同：1
> 
> 时间：2012-06-06T16:34:07.380
> 
> 标签：visual-studio

我不知道以下代码是否真的相关，但为了充分披露，这里是我试图从即时窗口调用的代码：

```
abstract class Test
{
    public int x;

    public Test()
    {
        x = 5; 
    }
}

class TestImp : Test
{
    public int GetX()
    {
        return this.x;
    }
} 
```

这只是一个测试，看看默认的基本构造函数是否被自动调用，或者我是否必须专门调用它，因为我不记得了。

好的，直奔问题。我在即时窗口中输入了这个来查看结果：

```
new Mercury_Reports.TestImp().GetX(); 
```

而不是评估表达式，它只是启动了我的应用程序。我关闭了应用程序并再次尝试了两次并得到了相同的结果。下一次，我在我的 Program.cs 文件中放置了一个断点。然后，它没有像过去 3 次那样启动应用程序然后到达断点，而是决定实际上只评估我的表达式。

我以前在 Visual Studio IDE 中看到过一些奇怪的事情，但我认为这是最奇怪的事情之一。有人知道那里发生了什么吗？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T16:37:43.260

在不调试时在即时窗口中评估表达式时，会发生以下过​​程

*   将您的项目/应用程序二进制文件加载到托管进程中
*   以静默方式将调试器附加到托管进程
*   针对该调试器会话评估表达式

大多数情况下，这样做的方式很难检测到应用程序实际上正在运行。但有时应用程序的副作用会显示出来并揭示幕后的真实情况。

**编辑**

一般来说，它不应该显示 UI。我可以想到一些**晦涩**的极端情况，虽然这种情况会发生，但不是 Visual Studio 错误。基本上都归结为相同的情况

> 评估的字符串会导致意外的副作用发生在正常程序流程中不会发生的时间。

这实际上比您在即时窗口中所期望的更常见，因为它实际上是在乱序执行您的代码。`new Mercury_Reports`通常你在执行之前永远不会到达，`Program.Main`但在即时窗口中，这正是发生的事情。这可能会产生令人讨厌的影响，例如重新排序静态类型构造函数

以下是一些意想不到的后果，它们可以通过即时窗口表达式浮出水面

*   导致类型被加载，从而导致它们的静态初始化程序运行
*   更改静态初始化程序的运行顺序
*   表达式的返回类型有一个`ToString`调试器执行的方法
*   表达式的返回类型具有`DebuggerDisplay`调试器执行的值

在过去，我看到过静态构造函数案例导致 UI 显示。本质上是一个静态类型构造函数正在评估`MainForm.Instance`（一个惰性创建属性）。在正常的程序流程中，它被调用从`Program.Main`运行并且从那时起简单可用。在即时窗口中虽然`Program.Main`没有运行。但是正在执行的表达式无意中加载了该类型，因此显示了一个微不足道的属性 getter 的 UI。

这是一个非常模糊的极端案例。我想说最可能的原因是 Visual Studio 中的一个错误。调试是一件令人讨厌的事情，尤其是在执行实时代码时，这可能就是其中的一个症状。

# java - 在java中使用随机字符串？

> ID：10918350
> 
> 赞同：-2
> 
> 时间：2012-06-06T16:34:37.737
> 
> 标签：java, random

我正在尝试从 4 个字符串中随机选择一个字符串，并在控制台上显示该字符串。我该怎么做 ？例如，有一个问题，如果用户回答正确，那么控制台将显示我选择的字符串之一。我知道如何随机选择一个整数值，但我不知道如何随机选择一个字符串。请帮忙？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T16:38:21.783

```
import java.util.Random;
public class RandomSelect {

    public static void main (String [] args) {

         String [] arr = {"A", "B", "C", "D"};
         Random random = new Random();

         // randomly selects an index from the arr
         int select = random.nextInt(arr.length); 

         // prints out the value at the randomly selected index
         System.out.println("Random String selected: " + arr[select]); 
    }
} 
```

使用字符：

```
import java.util.Random;
public class RandomSelect {

    public static void main (String [] args) {

         String text = "Hello World";
         Random random = new Random();

         // randomly selects an index from the arr
         int select = random.nextInt(text.length()); 

         // prints out the value at the randomly selected index
         System.out.println("Random char selected: " + text.charAt(select)); 
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-06T16:37:32.357

1.  把你的字符串放在一个数组中。
2.  然后从类中获取一个在数组长度范围内的随机整数`Random`（查看模`%`运算符以了解如何执行此操作；或者，通过传递上界限制对 random.nextInt() 的调用）。
3.  通过使用刚刚获得的数字索引到数组中来获取字符串。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-17T05:04:56.080

```
String[] s = {"your", "array", "of", "strings"};

Random ran = new Random();
String s_ran = s[ran.nextInt(s.length)]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-06T16:36:23.010

使用您随机选择的整数值作为字符串数组的索引。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-06T17:08:03.187

```
Random r = new Random();
System.out.println(list.get(r.nextInt(list.size()))); 
```

这将在 0 [包含] 和 list.size() [不包含] 之间生成一个随机数。然后，只需将该索引处的元素从列表中取出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-06T16:39:24.813

> shuffle(List list) 使用默认随机源随机排列指定的列表。

```
// Create a list
List list = new ArrayList();

// Add elements to list
..

// Shuffle the elements in the list
Collections.shuffle(list);
list.get(0); 
```

# android - 在 ICS 中实现 FindMe 配置文件

> ID：10918357
> 
> 赞同：0
> 
> 时间：2012-06-06T16:34:48.533
> 
> 标签：android, bluetooth, profiles, bluetooth-lowenergy

我正在开发 android 中的蓝牙应用程序。我正在 ICS 上编写 FindMe Server 应用程序。我们在 ICS 中加入了 Gatt 方法，因为我们正在研究低能量。我目前没有 FindMe 配置文件 API，因此尝试使用 GATT 方法来完成应用程序。我的应用程序正在向 GATT 注册，它也在进行服务发现，但是在进行服务发现时，蓝牙设备突然与我的手机断开连接。你能告诉我出了什么问题吗？

我在这里复制了代码....所有代码都来自一个文件

```
public class FindMEService extends Service {

private static final String TAG = "FindMEService";

public static final int MSG_REG_GATT_SERVER_CONFIG = 300;
public static final int MSG_UNREG_GATT_SERVER_CONFIG = 301;

public static final int MSG_REG_GATT_SERVER_SUCCESS = 400;
public static final int MSG_REG_GATT_SERVER_FAILURE = 401;
public static final int MSG_UNREG_GATT_SERVER_SUCCESS = 500;
public static final int MSG_UNREG_GATT_SERVER_FAILURE = 501;

BluetoothGatt gattProfile;
private BluetoothGattAppConfiguration serverConfiguration = null;

InputStream raw = null;

public static ArrayList<Attribute> FMPHandleToAttributes;

public static int serverMinHandle = 0;

public static int serverMaxHandle = -1;

public static HashMap<String, List<Integer>> AttribTypeToHandle =
    new HashMap<String, List<Integer>>();

final Messenger mMessenger = new Messenger(new handler());

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

public void onCreate() {
    super.onCreate();
    BluetoothAdapter mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
    if(mBluetoothAdapter == null || !mBluetoothAdapter.isEnabled()) {
        stopSelf();
        return;
    }

    if (!mBluetoothAdapter.getProfileProxy(this, mBluetoothServiceListener,
            BluetoothProfile.GATT)) {
                stopSelf();
                return;
            }

    populateFMPAttribTypeMap();
    ReadXML readxml= new ReadXML();
            raw = getResources().openRawResource(R.raw.fmpservice);

           if (raw != null) {
              readxml.parse(raw);        
           }

           sendMessage(MSG_REG_GATT_SERVER_CONFIG,0);
       }

public int onStartCommand(Intent intent, int flags, int startId) {
    super.onStartCommand(intent,flags, startId);
    return START_STICKY;
}

public void onDestroy() {
    super.onDestroy();
    sendMessage(MSG_UNREG_GATT_SERVER_CONFIG,0);
}

 private final BluetoothProfile.ServiceListener mBluetoothServiceListener =
     new BluetoothProfile.ServiceListener() {
 public void onServiceConnected(int profile, BluetoothProfile proxy) {
     if (profile == BluetoothProfile.GATT) {
         gattProfile = (BluetoothGatt) proxy;
     }
 }

 public void onServiceDisconnected(int profile) {
     if (profile == BluetoothProfile.GATT) {
         gattProfile = null;
     }
 }
};

private class handler extends Handler {

    public void handleMessage(Message msg) {
        switch(msg.what) {
        case MSG_REG_GATT_SERVER_CONFIG :
            registertoGATT();
            break;
        case MSG_UNREG_GATT_SERVER_CONFIG:
            unregistertoGATT();
            break;
        case MSG_REG_GATT_SERVER_SUCCESS:
                break;
        case MSG_REG_GATT_SERVER_FAILURE:
                break;
        case MSG_UNREG_GATT_SERVER_SUCCESS:
                break;
        case MSG_UNREG_GATT_SERVER_FAILURE:
                break;
        }
    }

}

/**
 * Sending Messages to the Handler
 * @param what
 * @param value
 */
private void sendMessage(int what, int value) {

    if (mMessenger == null) {
        return;
    }

    try {
            mMessenger.send(Message.obtain(null, what, value, 0));
    } catch (RemoteException e) {
        e.printStackTrace();
    }
}

/**
 * Register to GATT
 */
private void registertoGATT() {
         gattProfile.registerServerConfiguration("FMP",0xffff,bluetoothGattCallBack));
}

 private void populateFMPAttribTypeMap() {
        AttribTypeToHandle.put("00002800-0000-1000-8000-00805F9B34FB", new ArrayList<Integer>());
        AttribTypeToHandle.put("00002803-0000-1000-8000-00805F9B34FB", new ArrayList<Integer>());
 }

    /**
     * Callback to handle application registration, unregistration events and other
     * API requests coming from the client device.
    */
    private final BluetoothGattCallback bluetoothGattCallBack = new BluetoothGattCallback() {
        public void onGattAppConfigurationStatusChange(BluetoothGattAppConfiguration config,
                int status) {
            serverConfiguration = config;

            switch(status) {
                case BluetoothGatt.GATT_CONFIG_REGISTRATION_SUCCESS:
                        sendMessage(MSG_REG_GATT_SERVER_SUCCESS, 0);
                        break;
                case BluetoothGatt.GATT_CONFIG_REGISTRATION_FAILURE:
                        sendMessage(MSG_REG_GATT_SERVER_FAILURE, 0);
                        break;
                case BluetoothGatt.GATT_CONFIG_UNREGISTRATION_SUCCESS:
                        sendMessage(MSG_UNREG_GATT_SERVER_SUCCESS, 0);
                        break;
                case BluetoothGatt.GATT_CONFIG_UNREGISTRATION_FAILURE:
                        sendMessage(MSG_UNREG_GATT_SERVER_FAILURE, 0);
                        break;
            }
        }

        public void onGattActionComplete(String action, int status) {
            Log.d(TAG, "FindMEService :  onGattActionComplete: " + action + "Status: " + status);
        }

        /**
         * Processes the Discover Primary Services Request from client and sends the response
         * to the client.
        */
        public void onGattDiscoverPrimaryServiceRequest(BluetoothGattAppConfiguration config,
                        int startHandle, int endHandle, int requestHandle) {
            System.out.println("FindMEService :  onGattDiscoverPrimaryServiceRequest");

        }

        /**
         * Processes the Discover Primary Services by UUID Request from client and sends the
         * response to the client.
        */
        public void onGattDiscoverPrimaryServiceByUuidRequest(BluetoothGattAppConfiguration config,
                        int startHandle, int endHandle, ParcelUuid uuid, int requestHandle) {
             int j, k, hdlFoundStatus =0;
             int startAttrHdl = 0, endAttrHdl = 0;
             int status = BluetoothGatt.ATT_ECODE_ATTR_NOT_FOUND;
             boolean retVal;
             List<Integer> hndlList = null;
             if(AttribTypeToHandle != null) {
                 for(Map.Entry<String, List<Integer>> entry : AttribTypeToHandle.entrySet()) {
                     if("00002800-0000-1000-8000-00805F9B34FB".
                                 equalsIgnoreCase(entry.getKey().toString())) {
                         //List of primary service handles
                         hndlList = entry.getValue();
                     }
                 }
             }
             if(hndlList != null) {
                 for(j=0; j< hndlList.size(); j++) {
                     int handle = hndlList.get(j);
                     if(handle >= 0) {
                         if((handle >= startHandle) && (handle <= endHandle)){
                             if(FMPHandleToAttributes != null) {
                                 for(k=0; k<FMPHandleToAttributes.size(); k++) {
                                     if(handle ==FMPHandleToAttributes.get(k).handle) {
                                         Attribute attr = FMPHandleToAttributes.get(k);
                                         startAttrHdl = attr.startHandle;
                                         endAttrHdl = attr.endHandle;
                                         if(attr.uuid != null &&
                                                         attr.uuid.equalsIgnoreCase(uuid.toString())) {
                                             Log.d(TAG, "Primary Handle with UUID available ::");
                                             hdlFoundStatus = 1;
                                             status = BluetoothGatt.GATT_SUCCESS;
                                             break;
                                         }

                                     }
                                 }
                             }
                         }
                     }
                     if(hdlFoundStatus == 1) {
                         Log.d(TAG, "Primary Handle found, success ::");
                         status = BluetoothGatt.GATT_SUCCESS;
                         break;
                     }
                     if(j == (hndlList.size()-1)) {
                         Log.d(TAG, "Primary Handle not found, failure ::");
                         status = BluetoothGatt.ATT_ECODE_ATTR_NOT_FOUND;
                         break;
                     }
                 }
             }
             retVal = gattProfile.discoverPrimaryServiceByUuidResponse(config, requestHandle, status,
                         startAttrHdl, endAttrHdl, uuid);

        }

        /**
         * Processes the Find Included Services Request from client and sends the response
         * to the client.
        */
        public void onGattFindIncludedServiceRequest(BluetoothGattAppConfiguration config,
                        int startHandle, int endHandle, int requestHandle) {
            System.out.println("FindMEService :  onGattFindIncludedServiceRequest");
        }

        /**
         * Processes the Discover Characteristic Descriptors Request from client and sends the
         * response to the client.
        */
        public void onGattDiscoverCharacteristicDescriptorRequest(BluetoothGattAppConfiguration
                        config, int startHandle, int endHandle, int requestHandle) {
            System.out.println("FindMEService :  onGattDiscoverCharacteristicDescriptorRequest");

        }

        /**
         * Processes the Discover Characteristics Request from client and sends the response
         * to the client.
        */
        public void onGattDiscoverCharacteristicRequest(BluetoothGattAppConfiguration config,
                        int startHandle, int endHandle, int requestHandle) {
            System.out.println("FindMEService :  onGattDiscoverCharacteristicRequest");
              }

        /**
         * Processes the Read By Attribute Type Request from client and sends the response
         * to the client.
        */
        public void onGattReadByTypeRequest(BluetoothGattAppConfiguration config, ParcelUuid uuid,
                int startHandle, int endHandle, String authentication, int requestHandle) {
            System.out.println("FindMEService :  onGattReadByTypeRequest");
        }

        /**
         * Processes the Read Request from client and sends the response
         * to the client.
        */
        public void onGattReadRequest(BluetoothGattAppConfiguration config, int handle,
                        String authentication, int requestHandle) {
            System.out.println("FindMEService :  onGattReadRequest");

        }

        /**
         * Processes the Write Request from client and sends the response
         * to the client.
        */
        public void onGattReliableWriteRequest(BluetoothGattAppConfiguration config, int handle,
                        byte value[], String authentication, int sessionHandle,
                        int requestHandle) {
            System.out.println("FindMEService :  onGattReliableWriteRequest");

        }

        /**
         * Processes the Write Request from client and sends the response
         * to the client.
        */
        public void onGattWriteRequest(BluetoothGattAppConfiguration config, int handle,
                        byte value[], String authentication) {
            System.out.println("FindMEService :  onGattWriteRequest");

        }

        public void onGattSetClientConfigDescriptor(BluetoothGattAppConfiguration config,
                        int handle, byte[] value, int sessionHandle) {
            System.out.println("FindMEService :  onGattSetClientConfigDescriptor");
        }

    };

 // Unregister Gatt server application through Bluetooth Gatt API.
    private void unregistertoGATT() {
        Log.d(TAG, "FindMEService :  Unregister Server config called::");
        gattProfile.unregisterServerConfiguration(serverConfiguration);
    } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T03:38:58.437

你能找到根本原因吗。由于您尚未发布，所以我假设您可能没有发布。从共享源代码中，很明显您的应用程序使用来自众多供应商之一的 BT-Low-energy 堆栈，例如 qualcomm、broadcomm 和 CSR。通过实际获取场景的 Air Sniffed 日志，有助于您了解断开连接的真正原因。您的 FindMeService 对我来说看起来是正确的。但是我个人希望看到 Air Sniff 日志。

谢谢和干杯！

# android - 如何为不同的屏幕尺寸制作图像？

> ID：10918358
> 
> 赞同：0
> 
> 时间：2012-06-06T16:34:49.560
> 
> 标签：android, android-layout, resolution, device

了解Android，我有点难以理解对多种设备的支持。我已经浏览了开发文档，现在进行清理：

使用 dp 背后的想法是，例如按钮具有相同的“真实世界”尺寸，与实际屏幕尺寸无关，对吧？如果是这样，这意味着，我提供 ldpi、hdpi 等格式的图像。这会产生一个按钮，它始终具有相同的大小。如果仍然正确，我现在明白，我的按钮始终具有相同的大小，我应该提供不同的布局，因为在小型设备上，可能只有两个相邻的空间，而在较大的设备上，有空间三。

如果以上所有内容都是正确的，我的问题是，我如何处理图形工具方面的问题。假设我有一个 100 像素 x 100 像素的按钮，分辨率为 300 dpi，那么对于不同屏幕尺寸的 Gimp 中的新文档，它的尺寸和 dpi 是多少？

提前感谢任何吸烟！马库斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:50:05.417

当您可以将自定义资产用于不同的屏幕密度时，这意味着当您放置这些各自的资产时，它们将不会再次缩放并按原样使用它们。现在确实屏幕的大小也有所不同。那是您可以考虑调整布局的时候。

例如，在大屏幕中，您可以将两个组件并排放置，并使用水平对齐的线性布局。但是当涉及到一个小屏幕时，这可能是不可能的，一个选择是为小屏幕定义一个新的布局，并在垂直布局中说 pt 这两个组件。

有关如何实施此和最佳实践的更多信息，请查看[这些 Android 文档](http://developer.android.com/guide/practices/screens_support.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T11:52:41.200

经过更多研究，似乎graphocs-tools DPI实际上是例如基线中提到的那个。因此，要创建基线文档，您确实需要创建一个大小为 470 x 320 像素且分辨率为 160 dpi 的文档。其余的从那里开始。

# c# - 为什么我用 Any CPU 编译的应用程序在我的 64 位机器上作为 32 位进程运行？

> ID：10918366
> 
> 赞同：8
> 
> 时间：2012-06-06T16:35:18.887
> 
> 标签：c#, 64-bit, anycpu

为什么我使用**AnyCPU**编译的应用程序在我的 64 位计算机上作为 32 位进程运行，因此无法与作为 64 位进程运行的记事本交互？

我有以下代码不会在 x64 操作系统上运行，因为`notepad.exe`它是 x64 并且 x86 应用程序无法获取 x64 进程的模块信息：

```
prc.Modules[0].FileName 
```

.Net 异常抛出我的代码：

> System.ComponentModel.Win32Exception (0x80004005)：32 位进程无法访问 64 位进程的模块。

根据这个论坛上的许多答案和文章，MSDN，...，我知道我需要使用 AnyCPU，因为使用 x64 对我没有特别的好处。即使在 AnyCPU 配置上编译时，我的错误仍然存​​在，此外，在**任务管理器**`(32-bit)`中，我在进程名称的末尾看到一个。

（实际上，我通过检查性能测试了代码，x64 代码运行速度快了约 40 毫秒。没关系，我不希望我的代码运行速度快 40 毫秒：D）

我不知道这是错的。

VS 2011 测试版 (x64)

Windows 8 消费者预览版 (x64)

此致，佩曼·莫尔塔扎维

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2017-12-10T13:10:41.620

尽管发问者已经接受了答案，但我觉得答案不完整，因为发问者提到他正在使用 Visual Studio 2011，因此假设目标 .Net Framework 为 4.5，关于“ **AnyCPU** ”的含义很少有警告.

请参考这两个链接，以更好地了解“ **AnyCPU** ”的含义是如何随时间变化的。

1.  [http://blogs.microsoft.co.il/sasha/2012/04/04/what-anycpu-really-means-as-of-net-45-and-visual-studio-11/](http://blogs.microsoft.co.il/sasha/2012/04/04/what-anycpu-really-means-as-of-net-45-and-visual-studio-11/)
2.  [https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/platform-compiler-option](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/platform-compiler-option)

从这些链接中，您可以找到为什么您的应用程序作为 32 位进程运行的问题的答案

> 在 64 位 Windows 操作系统上：
> 
> 使用 /platform:anycpu32bitpreferred 编译的可执行文件在 32 位 CLR 上执行。

这是你的罪魁祸首。

[![在此处输入图像描述](../Images/6bef0dc177238c6cd356d15911d54471.png)](https://i.stack.imgur.com/gGjgo.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T16:43:16.867

进入项目属性。在左侧，选择构建。

查看当前活动平台的“平台目标：”设置。将其更改为 x64。

（我怀疑您的“平台目标：”对于“任何 CPU”将明确为 x86）

![在此处输入图像描述](../Images/fc3b151e73eee1fe9586f90fe58cd33a.png)

# python - 在python中找到一列数据的最小最大值和平均值

> ID：10918370
> 
> 赞同：-3
> 
> 时间：2012-06-06T16:35:26.090
> 
> 标签：python

我有一组看起来像这样的数据

> 201206040210 -3461.00000000 -8134.00000000 -4514.00000000 -4394.00000000 0 201206040211 -3580.00000000 -7967.00000000 -4614.00000000 -7876.00000000 0 201206040212 -3031.00000000 -9989.00000000 -9989.00000000 -3419.00000000 0 201206040213 -1199.00000000 -6961.00000000 -3798.00000000 -5822.00000000 0 201206040214 -2940.00000000 -5524.00000000 -5492.00000000 -3394.00000000 0

我想取倒数第二列并找到最小值、最大值和平均值。当列由空格和 - 分隔时，我对如何使用拆分有点困惑。我想一旦我这样做了，我就可以使用 min() 和 max 函数。我已经写了一个 shell 脚本来做同样的事情

```
#!/bin/ksh
awk '{print substr($5,2);}' data' > /data1
sort -n data1 > data2
tail -1 data2
head -1 data2
awk '{sum+=$1} END {print "average = ",sum/NR}' data2 
```

我只是不确定如何在 python 中执行此操作。谢谢

编辑：决定使用 numpy 来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T16:39:04.823

```
with open("filename") as f:    
    cols = [float(row.split("-")[-2]) for row in f.readlines()]
print min(cols), max(cols), sum(cols) / len(cols) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:02:03.913

这样做：

```
with open('rows.txt', 'r') as f:
    col=[float(row.split("-")[-2]) for row in f]

print 'min: {} max: {} avg: {}'.format(min(col),max(col),sum(col)/float(len(col))) 
```

输出：

```
min: 3798.0 max: 9989.0 avg: 5681.4 
```

如果你想阅读标准输入，这个：

```
import sys

col=[float(row.split("-")[-2]) for row in sys.stdin]

print 'min: {} max: {} avg: {}'.format(min(col),max(col),sum(col)/float(len(col))) 
```

将读取标准输入文本来做同样的事情。

# facebook - 如何创建响应式共享按钮

> ID：10918376
> 
> 赞同：0
> 
> 时间：2012-06-06T16:36:16.807
> 
> 标签：facebook, wordpress, share, social, sharing

我正在尝试创建响应页面大小的社交共享按钮，例如[Techcrunch](http://techcrunch.com/2012/06/05/foodzie/)或[Business2Community](http://www.business2community.com/branding/how-a-strong-personal-brand-makes-you-money-0190952)在他们的文章中所做的。您会注意到，一旦缩小窗口，按钮就会跳到标题上方。谁能告诉我这是怎么做到的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T07:11:59.033

他们使用媒体查询来应用不同的样式，这是 RWD 背后的基本思想。

[http://www.alistapart.com/articles/responsive-web-design/](http://www.alistapart.com/articles/responsive-web-design/)

[http://stuffandnonsense.co.uk/blog/about/hardboiled_css3_media_queries](http://stuffandnonsense.co.uk/blog/about/hardboiled_css3_media_queries)

[http://www.w3.org/TR/css3-mediaqueries/](http://www.w3.org/TR/css3-mediaqueries/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-02T06:31:53.550

我会查看[https://www.addthis.com](https://www.addthis.com)（专业版，每年 99 美元）。“专业版”为您提供了在 Techcrunch 网站上针对这些共享按钮显示的所有移动响应功能。我会这样做，而不是试图重新发明轮子。

# facebook - 当用户单击“停止发布活动”时会发生什么 "和"删除 “？

> ID：10918380
> 
> 赞同：0
> 
> 时间：2012-06-06T16:36:25.797
> 
> 标签：facebook, facebook-graph-api, publishing

我在 Facebook 上注意到，当单击时间轴上每个帖子右上角的“编辑或删除”按钮时，由 3rd 方应用程序发布的帖子具有上述菜单选项。

我很好奇如果用户选择“Stop Publishing Activity from”或“Remove”会有什么影响？

有没有办法检测何时发生这种情况？它是否在见解中记录数据？

它只是撤销应用程序发布到用户墙上的权限吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:19:15.017

删除应用会触发对回调 URL 的调用，您可以在应用设置中为此目的进行设置。

我猜，停止发布只会撤销相关权限。

# iframe - 是否有允许在 IFRAME 中传递 sso/凭证的 Websphere portlet？

> ID：10918388
> 
> 赞同：1
> 
> 时间：2012-06-06T16:36:49.137
> 
> 标签：iframe, websphere, single-sign-on, portlet, websphere-portal

这个问题的答案是使用 Web Page portlet；但是，portlet 的工作方式并不能提供我需要的解决方案。在建议特定的 portlet 之前，请继续阅读。

简短的版本是我们正在将我们的 Intranet 转换为 Websphere Portal 7 解决方案。这意味着我们希望在门户中显示的各种服务器上的多个应用程序。Web Page portlet 可以做到这一点，但由于以下两个限制，它不能满足我们的需求：

1) 网页 portlet 的应用程序 URL 必须在同一个域中。这些应用程序将是我们域的本地应用程序，但可能位于不同的服务器上。2) 身份验证必须通过 HTTP GET 方法完成。这真的很可笑，因为这会将凭据放在 URL 上。到底谁会想要那个？

这个 portlet 满足我们需求的功能是：1) 允许通过字段名称/值对设置凭据 2) 在 IFrame 中加载应用程序

因此，我几乎需要一个能够绕过这些限制的 portlet，但像这个 portlet 一样将应用程序加载到 IFRAME 中。我很难相信 Portlet 还没有满足这种需求，因此任何提示或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T11:54:47.570

我不确定它是否完全符合您的需求，但 Web 应用程序桥使用反向 HTTP 代理对 url 执行 get（或 put 等）请求，并通过 Portal 中的 iframe 对其进行操作。这是解决方案目录中的页面：[https ://greenhouse.lotus.com/plugins/plugincatalog.nsf/assetDetails.xsp?action=editDocument&documentId=9FAAD6D44DC64231852577EB006F4D9D](https://greenhouse.lotus.com/plugins/plugincatalog.nsf/assetDetails.xsp?action=editDocument&documentId=9FAAD6D44DC64231852577EB006F4D9D)

# php - 通过 AIR 应用上传图片

> ID：10918395
> 
> 赞同：2
> 
> 时间：2012-06-06T16:37:05.057
> 
> 标签：php, image, actionscript-3, air, upload

Air 应用程序出现问题并通过 php 将图像上传到服务器。我做错了什么？进展中一切正常，正在显示进展和响应，但 php 找不到图像。

```
 var request:URLRequest = new URLRequest("http://xxxxxxxxxx/api.php");           
        request.method = URLRequestMethod.POST;
        request.contentType = "application/octet-stream";
        var variables:URLVariables = new URLVariables();  
        variables.action = "addEntry";  
        variables.user = "1";
        request.data = variables; 

        var file:FileReference = new FileReference();           
        var filenameSmall:String = "xxxxx/" + _userName+"/thumbnail.jpg";
        if(_fb == true)
        {
            filenameSmall = "xxxxx/" + user +"/thumbnail.jpg";
        }
        file = File.desktopDirectory.resolvePath( filenameSmall );
        file.addEventListener(ProgressEvent.PROGRESS, uploadProgress);
        file.addEventListener(DataEvent.UPLOAD_COMPLETE_DATA, uploadDataComplete);
        file.addEventListener(SecurityErrorEvent.SECURITY_ERROR, uploadError);
        file.addEventListener(HTTPStatusEvent.HTTP_STATUS, uploadError); 
        file.addEventListener(IOErrorEvent.IO_ERROR, uploadError);
        file.upload(request, "image"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T12:00:40.907

文件引用的上传无法向 php 文件发送任何请求或变量。它只是将文件上传到您在 url 中给出的路径。如果要使用 php 保存图像

1.  您应该将图像转换为字节数组，
2.  执行任何一个编码过程（PNGEncoding 或 JPEGEncoding），
3.  如果您愿意，请执行任何标准编码（base64）以确保安全
4.  然后将该字符串发送到 php
5.  让您的 php 文件读取并写入该数据。

# java - 用 CSS 清理我的 customLabel

> ID：10918396
> 
> 赞同：0
> 
> 时间：2012-06-06T16:37:08.643
> 
> 标签：java, css, gwt, uibinder

我正在自定义标签并将标签的名称放在网格的一个单元格中，并将星号（图像）放在下一个单元格中。

```
<ui:image field="requiredImage" src="images/required_indicator.gif"/>
<ui:style type="com.equillore.mcmexternal.client.ui.IndicatorLabel.Style">
    @sprite 
    .requiredAsterisk
     {
        gwt-image: 'requiredImage';
        width: 7px;
        height: 14px;
    }
    .labRequired
    {
        color:#B22222;
        font-size:14;
        font-style:normal;
        font-weight:bold;
        font-family: serif;
        letter-spacing: 0.07em; 
    }
</ui:style>
<g:Grid >
    <g:row>
        <g:customCell>
            <g:Label ui:field="label" addStyleNames="{style.labRequired}"/>
        </g:customCell>
        <g:customCell>
            <g:Label addStyleNames="{style.requiredAsterisk}"/>
        </g:customCell>
    </g:row>
</g:Grid> 
```

当我运行它时，星号图像显示在标签（labRequired）的前面以及它之后。所以它显示了两次。

为什么会发生这种情况，我怎样才能摆脱“额外的”星号图像？

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:54:51.767

```
<ui:image field="requiredImage" src="images/required_indicator.gif"/> 
```

这一行实际上是在 UIBinder 中插入图像。去掉它。

而是将其作为托管资源添加到客户端捆绑包中。

[https://developers.google.com/web-toolkit/doc/latest/DevGuideClientBundle#Image_Sprites](https://developers.google.com/web-toolkit/doc/latest/DevGuideClientBundle#Image_Sprites)

# javascript - 地铁Javascript。对项目进行分组时出错。ui.js firstItemIndexHint 属性

> ID：10918398
> 
> 赞同：1
> 
> 时间：2012-06-06T16:37:25.767
> 
> 标签：javascript, windows-8, windows-runtime, microsoft-metro

好吧，我把我的头发拉出来，错误地将项目分组以在列表视图中呈现。当我通过 WinJS.UI.setOptions 将项目/组数据源设置为列表时，我在 ui.js 中的第 16812 行出现错误，提示“**无法获取未定义或空引用的属性 'firstItemIndexHint'** ”。

我的应用程序中有其他页面可以正常工作，但这个页面似乎不起作用。我在所有这些中都使用相同的绑定方法，但我找不到它们之间导致此错误的任何区别。

谁能告诉我是什么导致以下代码崩溃？谢谢。

准备好的功能中的javascript页面代码：

```
 var arr = new Array();
        //fill in an array with sample data.
        //name property is the one used for grouping
        //nm is rendered in the item template.
        for (var i = 0; i < 10; i++) {

            arr.push({
                name: "group" + (i % 5),
                nm: "namer" + i,
            });

        }
        //create a list based on the array.
        var items = new WinJS.Binding.List(arr);

        //group items by the name property (key selector function) and 
        //use it for rendering the group template (group data function)
        var groupDataSource = items.createGrouped(
            function (item) {
                return item.name;

            },
            function (item) {

                return {
                    name: item.name,
                    click: function () {
                        nav.navigate("mynavpage.html");
                    }
                };

            });

         //get a reference to the listview control
         var listView = element.querySelector(".itemGroups").winControl;

         //set templates and datasources to listview
         //here's where calls to base.js/ui.js are made and where app fails.
         WinJS.UI.setOptions(listView, {
            groupHeaderTemplate: $(".headerTemplate")[0],
            itemTemplate: $("#itemTemplate1")[0],
            itemDataSource: items.dataSource,
            groupDataSource: groupDataSource.groups.dataSource,
        }); 
```

html页面代码

```
 <!-- group header template -->
 <div class="headerTemplate" data-win-control="WinJS.Binding.Template" style="display: none">
    <h2 class="group-title" data-win-bind="textContent: name" role="link">
    </h2>
 </div>

<!-- item template -->
<div id="itemTemplate1" data-win-control="WinJS.Binding.Template" style="display: none">
    <div class="itemTemplate item1x1" id="item1">
        <div class="itemText">
            <h4 class="itemTitle win-type-ellipsis" data-win-bind="textContent: nm"></h4>
        </div>
    </div>
</div>

<!-- fragment section -->
 <div class="myPage fragment">
    <header aria-label="Header content" role="banner">
        <button class="win-backbutton" aria-label="Back" disabled></button>
        <h1 class="titlearea win-type-ellipsis">
            <span class="pageTitle">Page Title</span>
        </h1>
    </header>
    <section aria-label="Main content" role="main">
        <!-- listview Grid -->
        <div class="itemGroups" aria-label="List of groups" data-win-control="WinJS.UI.ListView"
            data-win-options="{ tapBehavior: 'toggleSelect' }">
        </div>

    </section>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-16T01:43:37.597

您需要对项目和组使用 groupDataSource。

```
WinJS.UI.setOptions(listView, { 
        groupHeaderTemplate: $(".headerTemplate")[0], 
        itemTemplate: $("#itemTemplate1")[0], 
        itemDataSource: groupDataSource.dataSource, 
        groupDataSource: groupDataSource.groups.dataSource, 
    }); 
```

# matlab - Matlab列表理解

> ID：10918404
> 
> 赞同：14
> 
> 时间：2012-06-06T16:37:44.460
> 
> 标签：matlab, list-comprehension

我可以在一个衬里写以下内容吗？

```
x = [1,3,5,7,9]
res = zeros(1,size(x,2));
for i=1:size(x,2);
    res(i) = foo(x(i));
end; 
```

假设 foo 函数没有按预期处理数组。在我的情况下，即使将数组作为参数，foo 也会返回一个标量。

例如，在 Python 中，它看起来像这样：

```
x = [1,3,5,7,9]
res = [foo(y) for y in x] 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-06T16:41:27.247

[`arrayfun`](http://www.mathworks.com/help/techdoc/ref/arrayfun.html)是你需要的。例如：

```
res = arrayfun(@foo, x) 
```

由于`foo`总是返回一个标量，因此上述方法将起作用，并且`res`也将是一个与`x`. 如果`foo`返回可变长度输出，那么您将必须设置`'UniformOutput'`为`false`或`0`在调用`arrayfun`. 然后输出将是一个`cell`数组。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-06T16:45:36.987

只是为了补充@yoda的好答案`UniformOutput`，您还可以使用`{}`括号而不是使用：

```
res = arrayfun(@(t){foo(t)}, x) 
```

此外，在某些情况下，`foo`已经矢量化了。

```
x = 1:10;
foo = @(t)(power(t,2));
res = foo(x); 
```

# javascript - 如何在表单内的 div 中显示警报消息

> ID：10918408
> 
> 赞同：2
> 
> 时间：2012-06-06T16:37:55.783
> 
> 标签：javascript, jquery, html, css

我有这个脚本，它会发出一条警报消息。我想要的只是将警报消息放在表单内的 div 中。这是脚本：

```
<script type="text/javascript">
var registered=false

function ExamineRegistration()
{
var email =document.regform.email.value;
var emailcheck= email.indexOf("@")
var emailcheck2= email.indexOf(".")
var password = document.regform.pass.value;
var passcheck = password.charAt(0)
var message_out = "Errors: "

if(email=="" || password==""){
message_out = message_out+"All boxes should be filled in, "
}

if(emailcheck==-1 || emailcheck2==-1)
{
message_out = message_out+"email must contain @ and ., "
}

if(password!=password)
{
message_out=message_out+"password must match"
}

if(message_out == "Errors: ") {
    message_out = "You have successfully been logged in!"
    registered=true
}

alert(message_out);
}
--> This function helps the user first to register and than to enter the site.
function Checkreg() {
if (registered ==true) {
location.replace("http://www.google.com")
}
else alert("Please Login to proceed")
}
</script> 
```

我有一个表格。我只希望警报消息出现在顶部的表单中。我只是不知道如何在表单中显示警报消息而不是弹出窗口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:41:30.837

```
function customAlert(message){
    $('#divId').html(message);
}

..
..
customAlert('Danger! aliens attacking us!') 
```

您还可以缓存 div 元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:39:49.863

```
window.realAlert = window.alert;
window.alert = function(msg) {document.getElementById('my_div_id').innerHTML = msg;}

.... some code with redirected alerts ....

// restoring alert
window.alert = window.realAlert; 
```

# intersystems-cache - 使用父子关系和缓存sql存储的Cache Class编译错误

> ID：10918418
> 
> 赞同：1
> 
> 时间：2012-06-06T16:38:44.767
> 
> 标签：intersystems-cache

我有下面列出的全局，我正在尝试使用 sql 存储创建几个缓存类：

```
^WHEAIPP(1,26,1)=2 
^WHEAIPP(1,26,1,1)="58074^^SMSNARE^58311" 
                2)="58074^59128^MPHILLIPS^59135" 
^WHEAIPP(1,29,1)=2 
^WHEAIPP(1,29,1,1)="58074^^SMSNARE^58311" 
                2)="58074^59128^MPHILLIPS^59135" 
^WHEAIPP(1,93,1)=2 
^WHEAIPP(1,93,1,1)="58884^^SSNARE^58948" 
                2)="58884^59128^MPHILLIPS^59135" 
^WHEAIPP(1,166,1)=2 
^WHEAIPP(1,166,1,1)="58407^^SMSNARE^58420" 
                 2)="58407^59128^MPHILLIPS^59135" 
^WHEAIPP(1,324,1)=2 
^WHEAIPP(1,324,1,1)="58884^^SSNARE^58948" 
                 2)="58884^59128^MPHILLIPS^59135" 
^WHEAIPP(1,419,1)=3 
^WHEAIPP(1,419,1,1)="59707^^SSNARE^59708" 
                 2)="59707^^MPHILLIPS^59910,58000^^^^" 
                 3)="59707^59981^SSNARE^60117,53241^^^^" 
```

全局的前两个下标（Hmo 和 Keen）构成一个唯一条目。第三个下标 (Seq) 有一个属性 (IppLineCount)，它是第四个下标级别 (Seq2) 中的 IppLine 的数量。我在下面创建了类 WIppProv，它是父类：

```
/// <PRE> 
/// ============================ 
/// Generated Class Definition 
/// Table:          WMCA_B_IPP_PROV 
/// Generated by:   FXALTMAN 
/// Generated on:   05/21/2012 13:46:41 
/// Generator:      XWESTblClsGenV2 
/// ---------------------------- 
/// </PRE> 
Class XFXA.MCA.WIppProv Extends (%Persistent, %XML.Adaptor) [ ClassType = persistent, Inheritance = right, ProcedureBlock, StorageStrategy = SQLMapping ]

{

/// .HMO 
Property Hmo As %Integer;

/// .KEEN 
Property Keen As %Integer;

/// .SEQ 
Property Seq As %String;

Property IppLineCount As %Integer;

Index iMaster On (Hmo, Keen, Seq) [ IdKey, Unique ];

Relationship IppLines As XFXA.MCA.WIppProvLine [ Cardinality = many, Inverse = relWIppProv ];

<Storage name="SQLMapping"> 
<DataLocation>^WHEAIPP</DataLocation> 
<ExtentSize>1000000</ExtentSize> 
<SQLMap name="DBMS"> 
<Data name="IppLineCount"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>1</Piece> 
</Data> 
<Global>^WHEAIPP</Global> 
<PopulationType>full</PopulationType> 
<Subscript name="1"> 
<AccessType>Sub</AccessType> 
<Expression>{Hmo}</Expression> 
<LoopInitValue>1</LoopInitValue> 
</Subscript> 
<Subscript name="2"> 
<AccessType>Sub</AccessType> 
<Expression>{Keen}</Expression> 
</Subscript> 
<Subscript name="3"> 
<AccessType>Sub</AccessType> 
<LoopInitValue>1</LoopInitValue> 
<Expression>{Seq}</Expression> 
</Subscript> 
<Type>data</Type> 
</SQLMap> 
<StreamLocation>^XFXA.MCA.WIppProvS</StreamLocation> 
<Type>%Library.CacheSQLStorage</Type> 
</Storage> 
} 
```

这个类编译得很好。接下来我创建了下面列出的 WIppProvLine 类，并在两者之间建立了父子关系：

```
/// Used to represent a single line of IPP data 
Class XFXA.MCA.WIppProvLine Extends (%Persistent, %XML.Adaptor) [ ClassType = persistent, Inheritance = right, ProcedureBlock, StorageStrategy = SQLMapping ]

{

/// .CLM_AMT_ALLOWED node: 0 piece: 6<BR> 
/// This field should be used in conjunction with the Claim Operator field to 
/// define a whole claim dollar amount at which a particular claim should be 
/// flagged with a Pend status. 
Property ClmAmtAllowed As %String;

/// .CLM_LINE_AMT_ALLOWED node: 0 piece: 8<BR> 
/// This field should be used in conjunction with the Clm Line Operator field to 
/// define a claim line dollar amount at which a particular claim should be flagged 
/// with a Pend status. 
Property ClmLineAmtAllowed As %String;

/// .CLM_LINE_OP node: 0 piece: 7<BR> 
/// A new Table/Column Reference that gives the SIU (Special Investigative Unit) 
/// the ability to look for claim line dollars above, below, or equal to a set 
/// amount. 
Property ClmLineOp As %String;

/// .CLM_OP node: 0 piece: 5<BR> 
/// A new Table/Column Reference that gives the SIU (Special Investigative Unit) 
/// the ability to look for claim dollars above, below, or equal to a set amount. 
Property ClmOp As %String;

Property EffDt As %Date;

Property Hmo As %Integer;

/// .IPP_REASON node: 0 piece: 10<BR> 
/// IPP Reason Code   
Property IppCode As %Integer;

Property Keen As %Integer;

/// .LAST_CHG_DT node: 0 piece: 4<BR> 
/// Last Changed Date 
Property LastChgDt As %Date;

/// .PX_DX_CDE_FLAG node: 0 piece: 9<BR> 
/// A Flag to indicate whether or not Procedure Codes or Diagnosis Codes are to be 
/// associated with this SIU Flag Type Entry. If the Flag = Y, then control would 
/// jump to a new screen where the user can enter the necessary codes. 
Property PxDxCdeFlag As %String;

Property Seq As %String;

Property Seq2 As %String;

Index iMaster On (Hmo, Keen, Seq, Seq2) [ IdKey, PrimaryKey, Unique ];

/// .TERM_DT node: 0 piece: 2<BR> 
/// Term Date 
Property TermDt As %Date;

/// .USER_INI node: 0 piece: 3 
Property UserIni As %String;

Relationship relWIppProv As XFXA.MCA.WIppProv [ Cardinality = one, Inverse = IppLines ];

Index relWIppProvIndex On relWIppProv;

//Index NewIndex1 On (RelWIppProv, Seq2) [ IdKey, PrimaryKey, Unique ];

<Storage name="SQLMapping"> 
<ExtentSize>1000000</ExtentSize> 
<SQLMap name="DBMS"> 
<ConditionalWithHostVars></ConditionalWithHostVars> 
<Data name="ClmAmtAllowed"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>6</Piece> 
</Data> 
<Data name="ClmLineAmtAllowed"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>8</Piece> 
</Data> 
<Data name="ClmLineOp"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>7</Piece> 
</Data> 
<Data name="ClmOp"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>5</Piece> 
</Data> 
<Data name="EffDt"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>1</Piece> 
</Data> 
<Data name="Hmo"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>11</Piece> 
</Data> 
<Data name="IppCode"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>10</Piece> 
</Data> 
<Data name="LastChgDt"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>4</Piece> 
</Data> 
<Data name="PxDxCdeFlag"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>9</Piece> 
</Data> 
<Data name="TermDt"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>2</Piece> 
</Data> 
<Data name="UserIni"> 
<Delimiter>"^"</Delimiter> 
<Node>+0</Node> 
<Piece>3</Piece> 
</Data> 
<Global>^WHEAIPP</Global> 
<Subscript name="1"> 
<AccessType>Sub</AccessType> 
<Expression>{Hmo}</Expression> 
<LoopInitValue>1</LoopInitValue> 
</Subscript> 
<Subscript name="2"> 
<AccessType>Sub</AccessType> 
<Expression>{Keen}</Expression> 
<LoopInitValue>1</LoopInitValue> 
</Subscript> 
<Subscript name="3"> 
<AccessType>Sub</AccessType> 
<Expression>{Seq}</Expression> 
<LoopInitValue>1</LoopInitValue> 
</Subscript> 
<Subscript name="4"> 
<AccessType>Sub</AccessType> 
<Expression>{Seq2}</Expression> 
<LoopInitValue>1</LoopInitValue> 
</Subscript> 
<Type>data</Type> 
</SQLMap> 
<StreamLocation>^XFXA.MCA.WIppProvLineS</StreamLocation> 
<Type>%Library.CacheSQLStorage</Type> 
</Storage> 
} 
```

当我尝试编译这个时，我收到以下错误：

错误 #5502：编译 SQL 表“XFXA_MCA.WIppProvLine %msg”时出错：表 XFXA_MCA.WIppProvLine 具有以下未映射（未在数据映射中定义）字段：relWIppProv

> ERROR #5030：编译类 XFXA.MCA.WIppProvLine 时发生错误，在 2.745 秒内编译期间检测到 1 个错误。

我究竟做错了什么？

提前致谢，弗雷德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:17:02.170

当您有父子关系时，子类（XFXA.MCA.WIppProvLine）中的索引声明看起来像

索引 iMaster On (Hmo, Keen, Seq, Seq2) [IdKey, PrimaryKey, Unique ];

不需要来自父级的属性。在子类中附加您没有在类定义中声明任何来自父类的属性，因此您不需要在子类中

属性 Hmo 作为 %Integer; 属性敏锐为 %Integer;

从 OO 的角度来看，您永远不会设置子级的 Hmo，而是设置父级的 Hmo，并且由于子级是相关的，因此它沿层次结构应用。

# ruby-on-rails - 如何使用路由过滤器 gem Rails I18n 应用程序更改 URL 中的语言环境？

> ID：10918428
> 
> 赞同：0
> 
> 时间：2012-06-06T16:39:33.730
> 
> 标签：ruby-on-rails, internationalization

我按照 gem 文档页面中的说明安装并设置了路由过滤器。 [https://github.com/svenfuchs/routing-filter](https://github.com/svenfuchs/routing-filter)

它适用于默认语言环境。例如，如果我将默认语言环境设置为 :en，则该站点为英文，如果我将默认语言环境设置为 :zh，则该站点为中文。

www.site.com/zh/home（默认的语言环境路径 /en 会自动添加到 URL 中）

但是我怎样才能让我的网站同时支持这两种语言呢？

当默认区域设置为 :zh 时，我尝试通过将“zh”替换为“en”来更改 URL，但页面仍然是中文，而不是英文。

这是路由过滤器gem不支持的东西吗？如果没有，我可以使用其他宝石吗？

还是我没有正确设置路由过滤器 gem？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:17:55.553

阅读源代码后，我看到了这个 gem 在做什么。

以下是源代码中的注释。

Locale 过滤器从识别路径的开头提取匹配 /:locale 的段，并将页面参数公开为 params[:locale]。生成路径时，如果将页面参数传递给 url 帮助程序，则过滤器会相应地将段添加到路径中。

```
incoming url: /de/products
filtered url: /products
params: params[:locale] = 'de' 
```

您可以像这样安装过滤器：

```
# in config/routes.rb
Rails.application.routes.draw do
filter :locale
end 
```

要使您的 named_route 助手或 url_for 添加您可以使用的语言环境段：

```
products_path(:locale => 'de')
url_for(:products, :locale => 'de')) 
```

我向 application_controller.rb 添加了所需的逻辑，所以一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-29T10:39:17.147

如果您只想在当前页面中切换语言环境，那么您不需要放入路径。只是编码`url_for(:locale => 'de')`或`url_for(params.merge(:locale => 'ko'))`所以我像这样编码我的翻译导航。不妨使用此代码节省您的时间:)

```
<nav id="trans-nav">
    <%= link_to 'KOR', url_for(params.merge(:locale => 'ko')), :class => ('active' if I18n.locale.to_s == 'ko' ) %>
    <%= link_to 'ENG', url_for(params.merge(:locale => 'en')), :class => ('active' if I18n.locale.to_s == 'en' ) %>
    <%= link_to 'CHI', url_for(params.merge(:locale => 'cn')), :class => ('active' if I18n.locale.to_s == 'cn' ) %>
</nav> 
```

或者

```
<nav id="trans-nav">
    <%= link_to 'KOR', url_for(:locale => 'ko'), :class => ('active' if I18n.locale.to_s == 'ko' ) %>
    <%= link_to 'ENG', url_for(:locale => 'en'), :class => ('active' if I18n.locale.to_s == 'en' ) %>
    <%= link_to 'CHI', url_for(:locale => 'cn'), :class => ('active' if I18n.locale.to_s == 'cn' ) %>
</nav> 
```

# ios - iPod touch 上的 phoneGap 错误

> ID：10918431
> 
> 赞同：2
> 
> 时间：2012-06-06T16:39:57.833
> 
> 标签：ios, cordova, ipod-touch

我在控制台中收到以下错误：

```
 "Error in success callback: com.phonegap.file9 = TypeError: 'undefined' is not a function." 
```

我的应用程序在 iPad 和 Android 上运行完美，但如果无法在 iPod touch 上写入文件。有人知道这是硬件问题还是PhoneGap？

# asterisk - 特定事件后星号与应用断开连接

> ID：10918439
> 
> 赞同：0
> 
> 时间：2012-06-06T16:40:38.927
> 
> 标签：asterisk

我正在使用 Asterisk-Java 来收听来自 Asterisk PBX 的消息。这个应用程序以前可以工作，但我做了一些更改，现在当我尝试运行它并从我的桌面电话进行测试电话会议时，它说：

```
Asterisk-Java ManagerConnection-0-Reader-2 2012-06-06 17:17:46,858 DEBUG [manager.internal.ManagerConnectionImpl] - Dispatching event:
org.asteriskjava.manager.event.MeetMeJoinEvent[dateReceived='Wed Jun 06 17:17:46 BST 2012',privilege='call,all',sequencenumber=null,meetme='1',calleridname=null,timesta
mp=null,uniqueid='1338999461.46707',server=null,calleridnum=null,channel='SIP/10.252.26.15-08b76ab0',usernum='1',systemHashcode=233612073]
Asterisk-Java ManagerConnection-0-Reader-2 2012-06-06 17:17:46,869 DEBUG [manager.internal.ManagerConnectionImpl] - Dispatching event:
org.asteriskjava.manager.event.DisconnectEvent[dateReceived='Wed Jun 06 17:17:46 BST 2012',timestamp=null,sequencenumber=null,server=null,systemHashcode=681515782]
Asterisk-Java ManagerConnection-0-Reader-2 2012-06-06 17:17:46,870 INFO  [manager.internal.ManagerConnectionImpl] - Closing socket. 
```

可以看到`DisconnectEvent`后面直接有received `MeetMeJoinEvent`。每次都会发生这种情况 - 它总是在`MeetMeJoinEvent`. 这`DisconnectEvent`是一个伪事件，意味着 Asterisk 与我的应用程序断开连接 - 它没有与呼叫者断开连接。

随后，Asterisk-Java 会立即自动重新连接，但如果我再次进行测试调用，它会以同样的方式再次发生。我尝试重新启动 Glassfish 应用程序服务器。

我认为我的任何更改都不应该导致这种情况，并且只有一行代码在 Asterisk 连接上调用断开连接（当 Web 应用程序关闭时），并且与该行对应的日志消息不会出现在日志。

这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T11:16:33.427

实际上并不是 Asterisk 与应用程序断开连接——而是应用程序与 Asterisk 断开连接。

这是因为 Asterisk-Java 有一个错误：它在事件处理程序中捕获异常，而不是错误。然后它假设如果 Asterisk 得到一个未捕获的 Throwable，则它必须断开连接。

我在 Glassfish 主日志文件中找到了未捕获的异常堆栈跟踪。

# javascript - 如何使用 Strust2 和 Ajax 从对话框中获取 bean

> ID：10918444
> 
> 赞同：1
> 
> 时间：2012-06-06T16:41:15.680
> 
> 标签：javascript, ajax, struts2

我有一个包含表格的对话框（由另一个窗口调用）。此表中的每一行都有一个“用户”bean 的信息和一个“选择”按钮。

我想要做的是，当单击“选择”按钮时，调用窗口会收到选择的 bean。

我正在使用 Struts2 和 DOJO，因为我希望所有这些过程都通过 Ajax 进行。

我应该怎么办？

# elastic-map-reduce - 如何通过 Elastic MapReduce 使用外部数据

> ID：10918450
> 
> 赞同：1
> 
> 时间：2012-06-06T16:41:32.793
> 
> 标签：elastic-map-reduce

来自亚马逊的 EMR 常见问题解答：

> 问：我可以从 Internet 或 Amazon S3 以外的其他地方加载我的数据吗？
> 
> 是的。您的 Hadoop 应用程序可以从 Internet 上的任何位置或从其他 AWS 服务加载数据。请注意，如果您从 Internet 加载数据，将收取 EC2 带宽费用。Amazon Elastic MapReduce 还提供对 DynamoDB 中数据的基于 Hive 的访问。

从外部（非 S3）源加载数据的规范是什么？这个选项似乎缺乏资源，并且似乎没有以任何形式记录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:24:17.060

如果您想以“hadoop 方式”执行此操作，您应该在您的数据源上实现 DFS，或者将对您的源 URL 的引用放入某个文件中，该文件将作为 MR 作业的输入。
同时，hadoop 是关于将代码移动到数据中的。从这个角度来看，即使 EMR over S3 也不理想 - EC2 和 S3 是不同的集群。因此，如果数据源在物理上位于数据中心之外，则很难想象有效的 MR 处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T12:35:20.950

我知道用于 java 的 Cassandra 包有一个名为**org.apache.cassandra.hadoop**的源包，其中有两个类在您运行 AWS Elastic MapReduce 时从 Cassandra 获取信息。

基本课程：`ColumnFamilyInputFormat.java`和`ConfigHelper.java`

转到**[此链接](https://stackoverflow.com/questions/13566966/columnfamilyinputformat-could-not-get-input-splits)**以查看我正在谈论的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T20:48:03.110

基本上亚马逊所说的是，您可以通过您的代码以编程方式访问来自互联网或任何其他来源的任何内容。例如，您可以通过任何基于 HTTP 的客户端 API 访问 Couch 数据库实例。

# drupal - Drupal Views 输出错误日期 - 1969 年 12 月 31 日

> ID：10918454
> 
> 赞同：2
> 
> 时间：2012-06-06T16:41:48.217
> 
> 标签：drupal, drupal-6, drupal-views, drupal-modules, drupal-theming

问题：Drupal 视图模块仅显示日期字段的 1969 年 12 月 31 日星期三

我创建了一个名为 field_gse_event_start_time 的 CCK 内容字段类型。我还有几个使用此字段的视图显示——日历视图、表格视图和主页的块视图。我还有一个用于该字段所属的事件内容类型的主题节点模板。

开始时间字段需要“到”日期和开始日期。我试图将 field_gse_event_start_time 的类型更改为日期、日期时间和日期戳。在所有情况下，字段的节点显示都是正确的，但任何视图都显示 1969 年 12 月 31 日星期三。

我确信这是由于一些转换错误或 null 导致的，它会调整到这个 pre-epoc 值。

我什至不知道从哪里开始或如何解决。

一些配置 Drupal core 6.26 ctools-6.x-1.8.tar date-6.x-2.9.tar views-6.x-2.16.tar

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T19:24:42.280

您可能知道 1969 年的日期是由 date() 返回的，当您传递一个无效的纪元时间并且您有一个负时区偏移量时。因此， date() 会将无效纪元默认为 1，并且时区偏移使其成为前纪元。

为什么在您的 Drupal 视图中发生这种情况可能是因为视图字段处理程序期望错误的格式。您对 field_gse_event_start_time 使用什么字段类型？

# java - 为对象列表的子字段调用 Iterables.contains

> ID：10918455
> 
> 赞同：0
> 
> 时间：2012-06-06T16:41:48.597
> 
> 标签：java, map, hashmap, guava

我希望能够测试 List 是否包含具有给定键值的对象

例如，我想做类似*Iterables.contains(l2, "lname", "Jordan"));* 而不必在 l2 中创建所有其他 Map 对象，如下所示

```
//List<String> l = Arrays.asList("Mickael", "Jordan", "His Airness");
//System.out.println(Iterables.contains(l, "Jordan"));

Map<String, String> p1 = new HashMap<String, String>();
p1.put("fname", "Mickael");
p1.put("lname", "Jordan");
p1.put("nname", "His Airness");

Map<String, String> p2 = new HashMap<String, String>();
p2.put("fname", "Paul");
p2.put("lname", "Pierce");
p2.put("nname", "The Truth");
List<Map<String, String>> l2 = Arrays.asList(p1, p2);
Map<String, String> p3 = new HashMap<String, String>();
p3.put("fname", "Mickael"); //
p3.put("lname", "Jordan");
p3.put("nname", "His Airness"); //
System.out.println(Iterables.contains(l2, p3)); 
```

我想知道是否有这样的番石榴的功能，而不是在 l2 上循环并测试每个 elt.get("lname")

***编辑***

回答了 3 个解决方案：尝试查看哪个更高效

```
System.out.println(Iterables.any(l2, withEntry("lname", "Jordan"))); //@axtavt
System.out.println(has("lname", "Jordan")); //@JB
System.out.println(Iterables.any(l2, new KeyValuePredicate("lname", "Jordan"))); //@JB

public static Boolean has(final String key, final String value) {
    return Iterables.any(l2, new Predicate<Map<String, String>>() {
        @Override
        public boolean apply(Map<String, String> input) {
            return input.get(key).equals(value);
        }
    });
}

public static Predicate<Map<String, String>> withEntry(final String key, final String value) {
    return new Predicate<Map<String, String>>() {
        public boolean apply(Map<String, String> input) {
            return value.equals(input.get(key));
        }
    };
}

class KeyValuePredicate implements Predicate<Map<String, String>>{
private String key;
private String value;
public KeyValuePredicate(String key, String value) {
    super();
    this.key = key;
    this.value = value;
}
@Override
public boolean apply(Map<String, String> arg0) {
    // TODO Auto-generated method stub
    return arg0.get(key).equals(value);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:47:51.383

```
return Iterables.any(l2, new Predicate<Map<String, String>>() {
    @Override
    public boolean apply(Map<String, String> input) {
        return input.get("lname").equals("Jordan");
    }
}); 
```

但是当您应该使用具有属性的对象时，您正在使用地图。

当然，如果您需要多次使用各种属性，您应该将谓词转换为非匿名、可重用的类：

```
return Iterables.any(l2, new KeyValuePredicate("lname", "Jordan")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:47:34.223

您可以实施适当的[`Predicate`](http://guava-libraries.googlecode.com/svn/tags/release08/javadoc/com/google/common/base/Predicate.html)并使用`Iterables.any()`：

```
public Predicate<Map<String, String>> withEntry(final String key, final String value) {
    return new Predicate<Map<String, String>>() {
        public boolean apply(Map<String, String> input) {
            return value.equals(input.get(key));
        }
    };
}

System.out.println(Iterables.any(l2, withEntry("lname", "Jordan"))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:50:34.200

这很简单。

您应该创建一个适当的实体类：

```
public class Person {

    private String fName;
    private String lName;
    private String nName;

    public Person(String fName, String lName, String nName) {
        this.fName = fName;
        this.lName = lName;
        this.nName = nName;
    }

    public String getFName() {
        return fName;
    }

    public String getLName() {
        return lName;
    }

    public String getNName() {
        return nName;
    }

} 
```

然后您可以执行以下操作：

```
import java.util.*;
public class Test {

    public static void main (String [] args) {

        List<Person> list = new ArrayList<Person>();
        Person p1 = new Person("Mickael", "Jordan", "His Airness");

        for (Person person : list) {
            if (person.getFName().equals("Mickael")) {
                System.out.println("Mickael is in the list!");
                break;
            }
        }
    }
} 
```

# ruby-on-rails-3 - 具有深度嵌套属性的 jQuery TokenInput 插件在编辑时预填充标记

> ID：10918456
> 
> 赞同：1
> 
> 时间：2012-06-06T16:41:51.623
> 
> 标签：ruby-on-rails-3, activerecord, nested-attributes, jquery-tokeninput

我的应用程序具有以下结构。

```
class Foo < ActiveRecord::Base
  has_many :examples, :dependent => :destroy

  accepts_nested_attributes_for :examples
end

class Example < ActiveRecord::Base
  belongs_to :foo
  has_many :codes, :dependent => :destroy

  accepts_nested_attributes_for :codes, :reject_if => lambda { |a| a[:code].blank? }
end
class Code < ActiveRecord::Base
  belongs_to :example
  has_many :code_kinds
  has_many :kinds, :through => :code_kinds
  attr_reader :kind_tokens

  def kind_tokens=(ids)
    self.kind_ids = ids.split(",")
  end
end
class CodeKind < ActiveRecord::Base

  belongs_to :code
  belongs_to :kind

end
class Kind < ActiveRecord::Base
    has_many :code_kinds
    has_many :codes, :through => :code_kinds   
end 
```

`fields_for`它在创建和保存时非常适合表单。

我按照[RailsCast #258 Token Fields](http://railscasts.com/episodes/258-token-fields)`kind_tokens`中的描述使用

但是在编辑表单上，现在一切都完美显示了，我应该在 in的嵌套属性内`data-pre`的字段上的属性中预先填充数据。`kind_tokens``code``examples`

RailsCast 说：

```
<%= f.text_field :author_tokens, "data-pre" => @book.authors.map(&:attributes).to_json %> 
```

但我不能这样做`@foo.examples.codes.kinds.map...`，因为与`Foo`和`examples`返回一个集合的关系，与 . 的情况相同`codes`。

我只是在使用：

`<%= f.fields_for :codes do |codes_form| %>`

那是里面

`<%= f.fields_for :examples do |examples_form| %>`

现在，如果我没有任何循环，并且一切都由`nested_attributes`and完成，我该如何预先填充代码类型`fields_for`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:59:08.473

**解决了**

每次使用

`<%= f.fields_for ...`

Rails 会自动生成 a `loop`，因此您可以在其中使用某种计数器，例如：

```
<%
@ctrEx = 0
@ctrCd = 0
%>
<%= form_for @foo ...
    <%= f.fields_for :examples do |examples_form| %>
        ...

        <%= examples_form.fields_for :codes do |codes_form| %>
            ...
            <%= codes_form.text_field :kind_tokens, :class => "tag_matcher", "data-pre" => @foo.examples[@ctrEx].codes[@ctrCd].kinds.map(&:attributes).to_json %>
            ...
            <%@ctrCd +=1%>
        <%end%>

        ...
        <%
        @ctrEx += 1
        @ctrCd = 0
        %>
    <%end%>
<%end%> 
```

现在您可以`data-pre`像这样使用您的计数器：

```
@foo.examples[@ctrEx].codes[@ctrCd].kinds.map(&:attributes).to_json 
```

这就是我想出来的方式，但必须有另一种方式。

# php - 将 GEvent addListener 添加到谷歌地图

> ID：10918459
> 
> 赞同：0
> 
> 时间：2012-06-06T16:42:01.473
> 
> 标签：php, google-maps, map

请任何人帮助我。

我想添加`GEvent.addListener`到地图中的每个标记，但它不起作用我尝试了很多方法但没有结果，请你帮忙。

我认为代码只是将最后一个标记保留在循环中。

你可以在线查看我的作品：[http ://www.ermes.net/user/profile/zoommap.php](http://www.ermes.net/user/profile/zoommap.php)

```
<script type="text/javascript">
function getIcon_Comunita() {
    var icon = new GIcon();
    icon.image = "/include/png/com_locali.png";
    icon.iconAnchor = new GPoint(48, 48);
    icon.infoWindowAnchor = new GPoint(16, 0);
    icon.iconSize = new GSize(30, 34);
    return icon;    
}
  var map1;
  function map1_initialize( )  {

        <?php       
    $db=new db_publish;
    $db->connect();
    $query="SELECT * FROM user_account ua LEFT JOIN user_details ud ON ua.user_id = ud.user_id WHERE ua.user_profileC LIKE  '%$user_id%' LIMIT 0,10";
    $result=$db->query($query);
    while($db->next()) {
    if (strlen($db->record["user_coordinates"]) > 0) { 
    $pieces = explode(",",$db->record["user_coordinates"]);
    $resultArrayAd[$cnt]['Lat']=trim($pieces[0]);
    $resultArrayAd[$cnt]['Lng']=trim($pieces[1]);
    $cnt++;
    }
    }
        ?>

    if ( google.maps.BrowserIsCompatible( ) )
    {
      map1 = new google.maps.Map2( document.getElementById( 'map1div' ) );
      map1.addControl( new google.maps.LargeMapControl3D( ) );
      map1.addControl( new google.maps.MenuMapTypeControl( ) );
      map1.setCenter( new google.maps.LatLng( 0, 0 ), 0 );

        var latlng = [ 
        <? foreach($resultArrayAd as $doc) { ?>
            new google.maps.LatLng(parseFloat(<?=$doc['Lat']?>),parseFloat(<?=$doc['Lng']?>)),
            <? } ?>             
            ];
      for ( var i = 0; i < latlng.length; i++ )
      { 
        var marker = new google.maps.Marker( latlng[ i ],getIcon_Comunita());   
        GEvent.addListener(marker, "click", function () {
        map1.setZoom(map1.getZoom() + 1);
        marker.openInfoWindowHtml("This the coordinate of this point"+marker+"yups");
        });

        map1.addOverlay( marker );
      }
      var latlngbounds = new google.maps.LatLngBounds( );
      for ( var i = 0; i < latlng.length; i++ )
      {
        latlngbounds.extend( latlng[ i ] );
      }
      map1.setCenter( latlngbounds.getCenter( ), map1.getBoundsZoomLevel( latlngbounds ) );
    }
  }
  google.maps.Event.addDomListener( window, 'load', map1_initialize );
  google.maps.Event.addDomListener( window, 'unload', google.maps.Unload );

</script>
<div id="map1div" style="height: 600px;"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:11:08.043

您在每次迭代时都在此处覆盖变量标记：

```
for ( var i = 0; i < latlng.length; i++ )
      { 
        var marker = new google.maps.Marker( latlng[ i ],getIcon_Comunita());   
        GEvent.addListener(marker, "click", function () {
        map1.setZoom(map1.getZoom() + 1);
        marker.openInfoWindowHtml("This the coordinate of this point"+marker+"yups");
        });

        map1.addOverlay( marker );
      } 
```

为了解决这个问题，您可以在循环内使用匿名函数：

```
 for ( var i = 0; i < latlng.length; i++ )
  { 
    (
     function(latlng){
        var marker=new google.maps.Marker( latlng,getIcon_Comunita());
        GEvent.addListener(marker, "click", function () {
                map1.setZoom(map1.getZoom() + 1);
                marker.openInfoWindowHtml("This the coordinate of this point:"                                            
                                              +latlng.toUrlValue());
                });
                map1.addOverlay(marker);
    })(latlng[i])
 } 
```

# syntax - VBscript, what is mean "Const VARIABLE = &h3&"

> ID：10918461
> 
> 赞同：3
> 
> 时间：2012-06-06T16:42:13.387
> 
> 标签：syntax, vbscript, initialization

As described in the title, I am confused by such initialization as "&h3&". What does this mean? Thank you very much.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T16:48:20.433

This declares a long variable with the value `3`. Here's a quick break down of the syntax

*   `&h`: In VB this is the prefix which indicates a hexadecimal number. It's the equivalent of `0x` in C / C++ / C#
*   `3`: The number 3 which is still just 3 when evaluated as a hexadecimal number
*   `&`: Specifies it should be a long vs normal integral value

# python - 如何将 utf-8 字符从 python 保存到 mySQL

> ID：10918471
> 
> 赞同：0
> 
> 时间：2012-06-06T16:43:02.963
> 
> 标签：python, mysql

我在服务器上使用 python 与 mySQL 进行通信。如果将具有非 ascii 字符的字符串提供给 python 以传送到 mySQL 表字段中，我会从服务器收到此错误。

```
UnicodeEncodeError: 'ascii' codec can't encode characters in position 251-256: ordinal not in range(128) 
```

我怎样才能通过 utf-8 数据。我确实有评论：

```
"# -*- coding: utf-8 -*-" 
```

...包含在 python 主代码页以及所有代码页中。

奇怪的是，我能够从包含 UTF-8 字符的 mySQL 中获取数据，并且可以很好地传输到 JavaScript。

尝试传输数据的代码行如下：

```
sql = '''INSERT INTO clientMail (clientID,coID,MessageDate,TypeSent,Comments,FName)
        VALUES(%s, %s, '%s', '%s', '%s', '%s') ''' % (clientID,companyID,currentDate,TypeSent,emailMessage,company_Name)
print "===>>>>>>>>>>>>>",sql 
```

UTF-8 字符出现在 Comments 字段中

任何帮助，将不胜感激...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T16:56:05.013

一个非常快速的解决方法应该是确保您的字符串以 Unicode 开头：

```
sql = u"INSERT..." 
```

即在字符串前面加上`u`.

但是，您**不**应该使用字符串格式将值插入到 SQL 语句中。您应该依靠 MySQL 适配器为您执行此操作，以确保您免受 SQL 注入：

```
sql = u"INSERT... VALUES (%s, %s..)"
cursor.execute(sql, (clientID, companyID...,)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:47:25.883

我想说这里有人确实提供了帮助，但无论我多么努力，我都无法做到……不过，谢谢大家的努力。无论如何，我从所有人那里学到了一些东西。

解决这个公认的难题的方法如下：
连接参数必须包括以下项目

```
... charset="utf8", use_unicode=True" 
```

正如我得出的结论，没有这些，你做什么都行不通。但我是新手，所以不要把我当回事。

尽管如此，还是非常感谢你们的参与……你们摇滚。

丹尼斯

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-06T16:48:32.907

您的数据应该是 Unicode 并且字符串格式 (%s) 强制它使用默认编码 (ASCII) 为字符串类型。

在 Unicode 字符串上使用 .encode('utf-8') 就可以了。

# cdi - 如何强制使用 CDI 生产者方法？

> ID：10918474
> 
> 赞同：5
> 
> 时间：2012-06-06T16:43:07.677
> 
> 标签：cdi, jsr299

我在这里的部分问题是使用正确的词汇，所以我提前为这可能是一个简单的术语问题道歉。

假设我有一个`Person`接口和一个`PersonBean`实现该接口的类。

进一步假设我在某处（带注释`@Produces`）有一个生产者方法，它返回一个`Person`. 在内部它返回一个 new `PersonBean`，但这既不在这里也不在那里。

最后，假设我在某个地方有另一个 CDI bean，其注入点定义如下：

```
@Inject
private Person person; 
```

假设我有我的所有`beans.xml`文件等，并且已经引导了 Weld 或另一个符合 CDI-1.0 的环境，因为这一切都代表我将得到一个模棱两可的定义错误。这是有道理的：Weld 会发现 my`PersonBean`作为注入候选者（它可以只调用构造函数）并且会发现我的 producer 方法的输出作为注入候选者。

我想做的是以某种方式强制`Person`此应用程序中实例的生成始终通过生产者方法。

我知道我可以在某处发明一些限定符，并使生产者方法产生`Person`由该限定符限定的实例。如果我这样做，并将我的注入点更改为包含限定符，那么显然这些合格的注射剂只有一个来源（即我的生产者方法），所以*瞧*，问题解决了。

但是假设我不想发明一些虚假的限定词。（我不是说是这种情况；只是想更深入地理解这些问题。）我有什么选择？我有吗？我想我可以穿上它`@Typed(Object.class)`，`PersonBean`这样它就不会被 CDI 视为`Person`...。

欢迎任何想法，包括指向文档的指针，或更好的理解方式。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T13:15:21.497

将您的 PersonBean 注释为 @Alternative 然后它将使用生产者方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:15:01.190

通过在这里和其他地方消化几个不同的答案，我采用的解决方案是在我的 bean 上使用`@Typed`值为 的注释。`Object.class`这意味着它只能被注入到像这样声明的字段中：

```
@Inject
private Object something; 
```

...谢天谢地，这几乎不存在。:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T18:01:06.017

> 我想做的是以某种方式强制此应用程序中 Person 实例的生成始终通过生产者方法。

缝焊[对此有一个解决方案](http://docs.jboss.org/seam/3/3.1.0.Final/reference/en-US/html/solder-unwraps.html)。

我不能 100% 确定 Seam 3 和[Deltaspike](https://cwiki.apache.org/DeltaSpike/)的合并将如何发展（页面是如此 90 年代，但内容摇滚:-)，但将 Solder 放入类路径肯定是一个安全的选择。

哦，据我所知，CDI 1.1 规范中有一个类似的机制。

# behat - 努力让 Mink 与 Behat 合作

> ID：10918475
> 
> 赞同：9
> 
> 时间：2012-06-06T16:43:08.237
> 
> 标签：behat, mink

我一直在关注本指南（并通过作曲家安装了所有东西）：[http](http://docs.behat.org/cookbook/behat_and_mink.html) : //docs.behat.org/cookbook/behat_and_mink.html 并试图让 Behat + Mink 工作，但每次我尝试运行 bin/behat 我得到以下错误：

```
PHP Fatal error:  Call to a member function getSession() on a non-object in vendor/behat/mink-extension/src/Behat/MinkExtension/Context/RawMinkContext.php on line 80 
```

那行代码是：

```
return $this->getMink()->getSession($name); 
```

所以由于某种原因，貂属性是空的，但我不知道为什么。

我的 .feature 文件与指南中的完全相同，FeatureContext 类也来自指南：

```
use Behat\Behat\Context\ClosuredContextInterface,
    Behat\Behat\Context\TranslatedContextInterface,
    Behat\Behat\Context\BehatContext,
    Behat\Behat\Exception\PendingException;
use Behat\Gherkin\Node\PyStringNode,
    Behat\Gherkin\Node\TableNode;     

use Behat\MinkExtension\Context\MinkContext;

/**
 * Features context.
 */
class FeatureContext extends MinkContext 
{

} 
```

我的 vendor/behat/mink/behat.yml 文件包含：

```
context:
  extensions:
    Behat\MinkExtension\Extension:
      base_url:  'http://en.wikipedia.org/'
      goutte:    ~
      selenium2: ~ 
```

我也试过让我的类扩展 BehatContext 然后调用 useContext 但这给了我同样的错误。Behat 本身似乎工作它只是任何与 Mink 产生致命错误，我不知道如何解决它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T09:07:16.500

这是因为您应该将`vendor/behat/behat/behat.yml.dist`文件复制到`your/project/root/behat.yml`，而不是在供应商目录中编辑文件并添加`extesions`到该`default`部分。

这就是它的样子：

```
default:
  extensions:
    Behat\MinkExtension\Extension:
      base_url: http://lunch-time/app_dev.php
      goutte: ~
      selenium2: ~

  paths:
    features:  features
    bootstrap: features/bootstrap

annotations:
  paths:
    features: features/annotations

closures:
  paths:
    features: features/closures 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-30T06:10:19.887

我面临着类似的问题。我们需要告诉 Symfony 初始化对象。

在默认 > 套件 > my_suite 下添加后，我的问题得到了修复。

```
contexts: [Behat\MinkExtension\Context\MinkContext] 
```

这是我的新 behat.yml 的样子。

```
default:
    suites:
        my_suite:
            type: symfony_bundle
            bundle: AcmeProjectManagerBundle
            contexts: [Behat\MinkExtension\Context\MinkContext]
extensions:
    Behat\Symfony2Extension: ~
    Behat\MinkExtension:
        base_url: http://en.wikipedia.org
        goutte: ~
        selenium2: ~
        sessions:
            default:
                symfony2: ~ 
```

# java - 使用 Java 的帕斯卡三角

> ID：10918480
> 
> 赞同：-9
> 
> 时间：2012-06-06T16:43:42.833
> 
> 标签：java, pascals-triangle

我在许多网站上进行了搜索，但找不到以下帕斯卡三角形的确切输出。谁能帮我解决如何获得以下输出。

```
 1
          1   1
        1   2    1
     1    3    3    1
   1    4    6    4   1
1    5    10   10    5   1 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-06T16:46:39.327

你可以试试

```
System.out.println(
        "        1\n" +
        "      1 2 1\n" +
        "    1 2 3 2 1\n" +
        "  1 2 3 4 3 2 1\n" +
        "1 2 3 4 5 4 3 2 1\n"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T16:58:38.260

只是在这里的格式方面给你一点帮助。您应该能够处理数字部分。

```
for(int i = 0; i < numberOfRows; i++)
{
    System.out.print(2 * (numberOfRows - i) * " "); //2 is gonna be the number of spaces between each entry. You could change it to whatever you want to stretch/shrink the triangle
    System.out.print(""); //pascal-specific stuff goes here
} 
```

顺便说一句——那不是帕斯卡三角。帕斯卡三角形不是那样的线性。帕斯卡三角形如下：

```
 1
          1   1
        1   2    1
     1    3    3    1
   1    4    6    4   1
1    5    10   10    5   1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T16:46:24.263

想想你的第一个数字之前的空格数和你所在的“级别”之间的关系。一旦你明白这一点，它应该很容易编码。

如果您无法对其进行编码，请向我们展示您迄今为止所做的尝试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:50:49.007

其他答案已经给出了有关格式的提示，但您似乎不清楚[帕斯卡的三角形](http://en.wikipedia.org/wiki/Pascal%27s_triangle)是什么。一旦您从概念上理解了三角形实际上是什么，将其转换为代码应该相对简单。

# caching - 防止IOS WebView缓存图片

> ID：10918482
> 
> 赞同：1
> 
> 时间：2012-06-06T16:43:57.027
> 
> 标签：caching, ios5, webview

**情况：** 一个原生IOS5 App从FTP下载一个网站到本地存储，一个webview显示下载的页面。如果 FTP-Server 上有新版本，App 会自动下载新版本并覆盖本地存储中的旧版本。现在 webview 应该加载新版本。

**问题：** 当新版本覆盖旧版本时，一些图像的名称会相同。现在 webview 将从文件系统的缓存中加载每个图像。-.-

**问题：** 是否有可能阻止 webview 从缓存中加载所有图像或清除整个缓存？我不能做的是更改下载页面的html或js。因此，无法在每张图片后面添加时间戳（test.img?timestamp=23444）。更改必须在 IOS 应用程序中完成。

我已经尝试过但失败了：

```
[[NSURLCache sharedURLCache] removeAllCachedResponses];

NSURLCache *sharedCache = [[NSURLCache alloc] initWithMemoryCapacity:0 diskCapacity:0 diskPath:nil];
[NSURLCache setSharedURLCache:sharedCache];

NSURL *url = [NSURL fileURLWithPath:[ftpPath stringByAppendingPathComponent:@"index.html"]];

NSURLRequest *urlRequest = [NSURLRequest requestWithURL:url cachePolicy:NSURLRequestReloadIgnoringLocalCacheData timeoutInterval:1.0];
[[NSURLCache sharedURLCache] removeCachedResponseForRequest: urlRequest];

[webView stopLoading];
[webView loadRequest:urlRequest];
[webView reload];
webView.delegate = self; 
```

非常感谢您的帮助，我不明白。

西娅·南多

# javascript - javascript counter - 如何在同一页面上包含多个计数器？

> ID：10918483
> 
> 赞同：1
> 
> 时间：2012-06-06T16:44:02.690
> 
> 标签：javascript, counter

有人可以帮我在一个页面中实现两个 javascript 计数器吗？我目前已经启动并运行了计数器，但是当我尝试为另一个计数器创建一个新的 div 时，原来的计数器消失了，只显示了一个计数器。这是我的第一篇文章，所以请原谅任何混乱的格式。我将不胜感激任何帮助，我对 javascript 很陌生。谢谢！

这是我的代码：

```
<div id="counter"></div>
<div id="counter1"></div>

<script type="text/javascript">
var START_DATE = new Date("July 27, 2010 13:30:00"); // put in the starting date here
var INTERVAL = 1; // in seconds
var INCREMENT = 2; // increase per tick
var START_VALUE = 9001; // initial value when it's the start date
var count = 0;

window.onload = function()
{
var msInterval = INTERVAL * 1000;
var now = new Date();
count = parseInt((now - START_DATE)/msInterval) * INCREMENT + START_VALUE;
document.getElementById('counter').innerHTML = addCommas(count);
setInterval("count += INCREMENT; document.getElementById('counter').innerHTML = 
addCommas(count);", msInterval);
}
</script>

<script type="text/javascript">
var START_DATE = new Date("July 27, 2011 13:30:00"); // put in the starting date here
var INTERVAL = 1; // in seconds
var INCREMENT = 2; // increase per tick
var START_VALUE = 8001; // initial value when it's the start date
var count = 0;

window.onload = function()
{
var msInterval = INTERVAL * 1000;
var now = new Date();
count = parseInt((now - START_DATE)/msInterval) * INCREMENT + START_VALUE;
document.getElementById('counter1').innerHTML = addCommas(count);
setInterval("count += INCREMENT; document.getElementById('counter1').innerHTML =   
addCommas(count);", msInterval);
}
</script>

<script type="text/javascript">
function addCommas(nStr)
{
nStr += '';
x = nStr.split('.');
x1 = x[0];
x2 = x.length > 1 ? '.' + x[1] : '';
var rgx = /(\d+)(\d{3})/;
while (rgx.test(x1)) {
    x1 = x1.replace(rgx, '$1' + ',' + '$2');
}
return x1 + x2;
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:01:04.407

你不能有两个`window.onload`脚本，最后一个会覆盖第一个。

只需重用相同的代码，只需将下一个计数器添加到下一个 div 即可。

```
window.onload = function()
{
    var msInterval = INTERVAL * 1000;
    var now = new Date();
    count = parseInt((now - START_DATE)/msInterval) * INCREMENT + START_VALUE;
    document.getElementById('counter').innerHTML = addCommas(count);
    setInterval("count += INCREMENT; document.getElementById('counter').innerHTML = addCommas(count);", msInterval);
    document.getElementById('counter1').innerHTML = addCommas(count);
    setInterval("document.getElementById('counter1').innerHTML =  addCommas(count);", msInterval);
} 
```

编辑：只增加一次计数，否则第二个计数器总是在第一个之前

# javascript - 在 Javascript 中测试未定义的嵌套对象

> ID：10918488
> 
> 赞同：4
> 
> 时间：2012-06-06T16:44:31.580
> 
> 标签：javascript, object, properties

> **可能重复：**
> [javascript 测试是否存在嵌套对象键](https://stackoverflow.com/questions/2631001/javascript-test-for-existence-of-nested-object-key)

我试图`formset`通过测试某个对象是否为 a 来构造一条错误消息，如果它不是*，* 那么我最终会用该错误消息填充它。主要问题是我必须验证每个嵌套对象是否为，这会导致一些非常丑陋的代码。这是示例：`undefined``undefined``undefined`

```
errorsForField: function(fieldName, formsetName, formNumber) {
            if (typeof this.model.errors != 'undefined'){

                var fieldError = document.createElement('span');
                $(fieldError).addClass('field-error');

                // THE FOLLOWING LINE THROWS ERROR.
                if (formsetName && _.isUndefined(this.model.errors[formsetName][fieldName]) != true) {
                    $(fieldError).text(this.model.errors[formsetname][fieldName]);
                } else if (typeof this.model.errors[fieldName] != "undefined"){
                    $(fieldError).text(this.model.errors[fieldName]);
                }

                this.errors[fieldName] = fieldError.outerHTML;
                return fieldError.outerHTML; 
            }
            return false; 
        }, 
```

我收到一条错误消息，指出我无法`[fieldName]`确定`undefined object` `this.model.errors[formsetName]`. 换句话说，我必须先确定 if `this.model.errors[formsetName]`is empty*然后*测试 if `[fieldname]`is `undefined`。

这似乎是一个非常麻烦的解决方案。有什么改变这个的建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T17:36:55.420

您可以创建一个库函数，将属性名称作为参数并返回最终值（如果存在）或 null：

```
function TryGetPropertyValue(o, propertyName1 /*, ... propertyNameN */) {
    var names = [].slice.call(arguments, 1);
    while (o && names.length) {
        o = o[names.shift()];
    }
    return names.length ? null : o;
} 
```

像这样称呼它：

```
var err = TryGetPropertyValue(this.model.errors, formsetName, fieldName) ||
          TryGetPropertyValue(this.model.errors, fieldName);
if (err != null) {
    $(fieldError).text(err);
} 
```

如果您希望它返回`undefined`而`null`不是找不到该字段，您可以稍微更改函数：

```
function TryGetPropertyValue(o, propertyName1 /*, ... propertyNameN */) {
    var names = [].slice.call(arguments, 1);
    while (o && names.length) {
        o = o[names.shift()];
    }
    if (names.length == 0) {
        return o;
    }
} 
```

[http://jsfiddle.net/HbggQ/](http://jsfiddle.net/HbggQ/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T17:41:17.233

正如 Paul 所建议的，这是 Javascript 的固有限制。即使是 Coffeescript（它只是 JS 之上的一层语法糖）也不能真正*解决*问题；它只是将解决方法隐藏在它的语法糖下（诚然这真的很方便）

如果你想坚持使用 Javascript，你基本上有两个选择：使用三元运算符，或者使用布尔运算符。以下是每个检查 ABCD 的示例（其中 A、B、C 或 D 可能不存在）：

```
// Returns A.B.C.D, if it exists; otherwise returns false (via ternary)
return !A ? false :
            !A.B ? false :
                   !A.B.C ? false :
                            A.B.C.D ? A.B.C.D : false;

// Returns A.B.C.D, if it exists; otherwise returns false (via booleans)
return A && A.B && A.B.C && A.B.C.D; 
```

显然后者要短得多。两种解决方案都依赖于 Javascript 的“真实性”（即值`0`、`""`、`null`和`undefined`被视为假）。这对您的情况应该没问题，因为这些值都没有错误属性。但是，如果您确实需要区分 (say)`0`和`undefined`，则可以使用三元样式，并替换`!A`为`typeof(A) == 'undefined'`.

# r - 根据数据框中其他列的测试将 NA 设置为列

> ID：10918489
> 
> 赞同：0
> 
> 时间：2012-06-06T16:44:33.113
> 
> 标签：r, plyr, na

我有一个包含 48 列的大型数据框，我想在数据框的每一行上运行一个函数，从而将通过函数给出的测试的列设置为 NA。该测试涉及从另一个数据帧中获取一个数字。adply 很适合这个，但是我很难让它给我想要的结果。

让我解释一下：

这是我要操作的数据框的示例：

```
 >df
  pt depth Cell1_avgvel Cell1_avgdir Cell2_avgvel Cell2_avgdir
1  1   0.1           NA           NA           NA           NA
2  2   0.2           NA           NA        1.344        324.0
3  3   0.3           NA           NA        0.445        167.0
4  4   0.4        1.455        354.2        0.322        321.2 
```

这是从中派生测试的小数据框：

```
> tcell
  depth  name
1   0.2 Cell1
2   0.4 Cell2
3   0.6 Cell3
4   0.8 Cell4 
```

整个想法是将NA分配给比大数据框中列出的实际深度更深的Cells数据点（即在第3行，深度为0.3但有两个数据点对应于Cell2，位于0.4 m 深度，因此这些都是错误的。我想 NA 这些）。

我想编写一个函数，它一次接收一行，并且：1）获取仪器深度 2）获取列名列表 3）获取比仪器深度更深的单元格索引 4）获取名称这些单元格（即 Cell1、Cell2、Cell4 等）5）使用正则表达式在列名列表中查找具有相应单元格的列（即 Cell1_avgdir、Cell1_avgvel 等）6）使用这些索引，设置那些列值到 NA。

这是我到目前为止所拥有的：

```
depthNA = function(x) {
  depth = x$depth
  nms = names(df)
  ind = as.character(which(depth < tcell$depth))
  c = tcell$name[ind]
  patt = paste(c,collapse="|")
  c_ind = grep(patt,nms)
  x[,c_ind] <- NA
}

adply(df,1,depthNA) 
```

不幸的是，这并没有像我想象的那样做，我现在正试图找出原因。

它给了我这个：

```
 pt depth Cell1_avgvel Cell1_avgdir Cell2_avgvel Cell2_avgdir V1
1  1   0.1           NA           NA           NA           NA NA
2  2   0.2           NA           NA        1.344        324.0 NA
3  3   0.3           NA           NA        0.445        167.0 NA
4  4   0.4        1.455        354.2        0.322        321.2 NA 
```

当我想要的是：

```
 pt depth Cell1_avgvel Cell1_avgdir Cell2_avgvel Cell2_avgdir
1  1   0.1           NA           NA           NA           NA
2  2   0.2           NA           NA           NA           NA
3  3   0.3           NA           NA           NA           NA
4  4   0.4        1.455        354.2        0.322        321.2 
```

希望我已经充分解释了我的问题。感谢任何可以：1）修复我已经开始的东西，或者 2）告诉我一个更好的方法来做到这一点，我不知道。

-SH

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:45:02.363

以下是回答您的想法概述但与您的输出不匹配的答案。请参阅我上面关于输出是否正确的评论。答案取决于`reshape2`使加入更容易。

首先，我读了你的数据：

```
df <- read.table(text = "  pt depth Cell1_avgvel Cell1_avgdir Cell2_avgvel Cell2_avgdir
1  1   0.1           NA           NA           NA           NA
2  2   0.2           NA           NA        1.344        324.0
3  3   0.3           NA           NA        0.445        167.0
4  4   0.4        1.455        354.2        0.322        321.2", header = TRUE)

tcell <- read.table(text = " depth  name
1   0.2 Cell1
2   0.4 Cell2
3   0.6 Cell3
4   0.8 Cell4", header = TRUE) 
```

然后解决你的问题：

```
library(reshape2)

#Melt into long format
df.m <- melt(df, id.vars = 1:2)
#Split the column into two new columns based on _
df.m[, c("Cell", "OtherCol")] <- with(df.m, colsplit(variable, "_", c("Cell", "OtherCol")))
#Merge together with tcell
df.m <- merge(df.m, tcell, by.x = "Cell", by.y = "name")
#Add a new column which sets the offending values to NA
df.m <- transform(df.m, newvalue = ifelse(value > depth.y, NA, value))
#Cast back into wide format
dcast(pt + depth.x ~ variable, value.var = "newvalue", data = df.m)

  pt depth.x Cell1_avgvel Cell1_avgdir Cell2_avgvel Cell2_avgdir
1  1     0.1           NA           NA           NA           NA
2  2     0.2           NA           NA           NA           NA
3  3     0.3           NA           NA           NA           NA
4  4     0.4           NA           NA        0.322           NA 
```

# java - 编译不同文件格式的Java项目

> ID：10918491
> 
> 赞同：0
> 
> 时间：2012-06-06T16:44:39.220
> 
> 标签：java, build, compilation, compiler-construction, build-tools

我正在创建一个系统来编译第一年和第二年的 Java 程序，目前我正在编译单个 Java 文件。

当我开始尝试让系统编译具有多个类的项目时，我认为作为一年级和二年级的学生，他们不会以相同的格式提交所有项目。

我昨天一直在尝试研究这一切，但找不到很多关于以下内容的信息：

*   编译时 Netbeans 和 Eclipse 项目之间的主要区别是什么
*   如何在jar文件中编译项目
*   一般只是不同的格式

所以我的问题是，是否有编译器可以编译所有不同的格式，或者您是否必须将不同的格式设置为某种方式来编译它们？

这也有什么例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:02:59.460

要求使用 Maven 构建（是的，它有它的缺点，但至少你会得到一致性）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-16T18:57:06.747

What I understand is you want something that can compile all types of Java projects (NetBeans, Eclipse, etc.)

Sorry to say this but there isn't one that can compile **all the formats out there**. But you could write your own, for at least the most common types of formats that you receive from the students.

Check out this page for more information: [Building Java Projects](https://docs.oracle.com/cd/E50453_01/doc.80/e50452/build_japps.htm).

What I suggest is, start by studying the build architecture used by those tools (NetBeans, Eclipse, etc.) and come up with a build script of your own that can extract the class paths of all the classes in the java project. Let your script do the work for you!

If you don't wish to write your own scripts, then you may consider changing the projects you receive into a standard project format. Check out [this](https://stackoverflow.com/a/4031478/4062881) and [this](https://www.mkyong.com/maven/how-do-create-an-ant-build-file-from-maven-pomxml/) link to see more about migrating from Ant to Maven or Maven to Ant.

Else, you can always manually port your existing projects into other IDE, provided they follow the same build mechanism. Check out [this](https://stackoverflow.com/a/33407417/4062881) answer to know more.

# java - 使用Java中具有相同类型属性的另一个数组列表的顺序按对象属性对数组列表进行排序

> ID：10918492
> 
> 赞同：0
> 
> 时间：2012-06-06T16:44:40.333
> 
> 标签：java, sorting, collections, arraylist

我有 2 个数组列表包含这样的对象：

第一个数组列表包含字符串和双精度：[a 1.1, b 1.2, d 0.4, g 1.9, f 0.5 等等...]

第二个数组列表包含字符串、双精度和整数：[b 0.1 2, f 1.1 5, g 2.3 1, a 1.1 2 等等...]

第二个数组列表可能包含与第一个相同或更多或更少的项目，但其所有字符串属性值将是仅存在于第一个字符串属性中的任何值。

我只需要根据第一个数组列表字符串属性的顺序通过字符串属性对第二个数组列表进行排序。第一个数组列表已经按顺序排列，如果我对第二个进行排序，那么预期的输出将是：

[a 1.1 2，b 0.1 2，g 2.3 1，f 1.1 5 .....]

我已经看到了一些关于比较器的问题和答案，但他们都在使用一种类型的数组列表进行排序。但是在这里我有两种类型的arraylist，我真的不知道该怎么做！

因此，如果您有任何想法，请与我分享，如果可能的话，分享一些示例代码。

我是 stackoverflow 的新手，在 Java 方面没有太多经验。我在这种情况下遇到了很大的麻烦。在谷歌搜索和搜索之后，特别是在 stackoverflow 中，但无法获得任何有用的想法。我已经解释了上面的情况，如果我犯了任何错误，请原谅我！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:53:18.277

这相当简单。这是一些伪 Java，它假设 中没有重复的键`list1`，并且不需要任何外部库。

假设以下...

```
class List1Item {
    String stringValue;
    double doubleValue;
};
class List2Item {
    String stringValue;
    double doubleValue;
    int    intValue;
};

List<List1Item> list1 = new ArrayList<>();
List<List2Item> list2 = new ArrayList<>(); 
```

一般的方法是在每个键值和它在第一个列表中的位置之间建立一个映射。

```
// Map to hold list1 key-to-position association
Map<String,Integer> sortKeys = new HashMap<>();

// Populate the key-to-position map with keys from list1
int pos=0;
for (List1Item i : list1)
    sortKeys.put(i.stringValue,pos++); 
```

然后使用 map`list2`按 in 键的位置对项目进行排序`list1`：

```
// Define a comparator that will use the map to sort list2 keys
Comparator<List2Item> comp = new Comparator<List2Item>() 
{
    public int compare(List2Item v1, List2Item v2)
    {
        return sortKeys.get(v1.stringValue).compareTo(sortKeys.get(v2.stringValue));
    }
}
Collections.sort(list2,comp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:57:09.657

这是一个相当复杂的问题，不会有任何真正简单的解决方案。

我能想到的最简单的事情取决于第三方库[Guava](https://code.google.com/p/guava-libraries/)。（披露：我是贡献者。）

让我们调用第一个对象类型`Foo`和第二个对象类型`Bar`，因为您还没有命名它们。我还假设s的`String`字段在第二个列表中是*唯一的。*`Bar`

 *```
List<String> stringOrder = new ArrayList<String>();
for (Bar bar : list2) {
  stringOrder.add(bar.getString());
}
Ordering<String> stringComparator = Ordering.explicit(stringOrder);
// construct a String comparator based on that ordering
Ordering<Foo> fooOrdering = stringComparator.onResultOf(
  new Function<Foo, String>() {
    public String apply(Foo foo) {
      return foo.getString();
    }
  });
Collections.sort(list1, fooOrdering); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T17:54:11.487

让我们假设对象 in`list1`和`list2`是 Foo 和 Bar 类型，它们都实现了一个`getString()`返回字符串属性的方法。就像你说的，列表 1 中的字符串值是唯一的。

```
ArrayList<Foo> list1 = new ArrayList<Foo>();
ArrayList<Bar> list2 = new ArrayList<Bar>();

final HashMap<String, Integer> positions = new HashMap<String, Integer>();
for(int i=0;i<list1.size();i++){
    positions.put(obj.getString(), i);
}

Collections.sort(list2, new Comparator<Bar>(){
    public int compare(Bar obj1, Bar obj2){
        return positions.get(obj2.getString()) - positions.get(obj1.getString());
    }
}); 
```*

# android - Activity finish() 刷新 ListActiviyt

> ID：10918493
> 
> 赞同：0
> 
> 时间：2012-06-06T16:44:44.247
> 
> 标签：android, listview, android-activity, contextmenu, listactivity

我想在我选择“删除”ContextItem 之后刷新/更新，它会删除但不“刷新”在代码 ListActivity 上看到的列表视图：

```
public class ProjetoProTelefoneActivity extends ListActivity {
public final static String ID_EXTRA = "br.com.DaniloDeLuca.ProjetoProTelefone._ID";
Cursor modelo = null;
RestaurantAdapter adapter = null;
RestauranteHelper helper=null;
SharedPreferences prefs=null;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    helper = new RestauranteHelper(this);
    prefs = PreferenceManager.getDefaultSharedPreferences(this);
    initList();
    prefs.registerOnSharedPreferenceChangeListener(prefListener);

    registerForContextMenu(getListView());
}

public void onDestroy(){
    super.onDestroy();

    helper.close();
}

//*********************************************************************************************************************************
// Long Press menu
//*********************************************************************************************************************************
public void onCreateContextMenu(ContextMenu menu,View v,ContextMenuInfo menuInfo){
    super.onCreateContextMenu(menu, v, menuInfo);
    AdapterView.AdapterContextMenuInfo info;
    try {
        info = (AdapterView.AdapterContextMenuInfo) menuInfo;
    } catch (ClassCastException e) {        
        return;
    }
    Cursor cursor = (Cursor) getListAdapter().getItem(info.position);
    if (cursor == null) {
        return;
    }
    new MenuInflater(this).inflate(R.menu.option_item,menu);
    super.onCreateContextMenu(menu,v,menuInfo);
}

public boolean onContextItemSelected(MenuItem item)
{
    AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo();
    int index = info.position;
    View view = info.targetView;
    long id = info.id;

    if(item.getItemId()==R.id.edit){
        Intent i=new Intent(ProjetoProTelefoneActivity.this, DetailForm.class);
        i.putExtra(ID_EXTRA, String.valueOf(id));
        startActivity(i);
        return(true);
    }
    else if(item.getItemId()==R.id.remove){

        Intent i=new Intent(ProjetoProTelefoneActivity.this, DeleteItemList.class);
        i.putExtra(ID_EXTRA, String.valueOf(id));
        startActivity(i);
        return(true);
    }
    return super.onContextItemSelected(item);
}
//*********************************************************************************************************************************
// Fim Long Press menu
//*********************************************************************************************************************************
public void onListItemClick(ListView list, View view,
        int position,long id){
    Intent i=new Intent(ProjetoProTelefoneActivity.this, DetailForm.class);
    i.putExtra(ID_EXTRA, String.valueOf(id));
    startActivity(i);
}
//hook into menu button for activity 
public boolean onCreateOptionsMenu(Menu menu){
    new MenuInflater(this).inflate(R.menu.option,menu);
    return(super.onCreateOptionsMenu(menu));
}
/// when menu button option selected 
public boolean onOptionsItemSelected(MenuItem item){
    if(item.getItemId()==R.id.add){
        startActivity(new Intent(ProjetoProTelefoneActivity.this, DetailForm.class));
        return(true);
    }
    else if(item.getItemId()==R.id.prefs){
        startActivity(new Intent(this, EditPreferences.class));
        return(true);
    }
    return(super.onOptionsItemSelected(item));
}

private SharedPreferences.OnSharedPreferenceChangeListener prefListener=
        new SharedPreferences.OnSharedPreferenceChangeListener() {

            public void onSharedPreferenceChanged(SharedPreferences sharedPreferences,
                    String key) {
                if(key.equals("sort_order")){
                    initList();
                }

            }
};
private void initList(){
    if(modelo!=null){
        stopManagingCursor(modelo);
        modelo.close();
    }

    modelo =helper.getAll(prefs.getString("sort_order","nome DESC"));
    startManagingCursor(modelo);

    adapter = new RestaurantAdapter(modelo);       
    setListAdapter(adapter);         

}

class RestaurantAdapter extends CursorAdapter {
    RestaurantAdapter(Cursor c) {
      super(ProjetoProTelefoneActivity.this, c);
    }

    public void bindView(View row, Context ctxt,
                         Cursor c) {
      RestaurantHolder holder=(RestaurantHolder)row.getTag();

      holder.populateFrom(c, helper);
    }

    public View newView(Context ctxt, Cursor c,
                         ViewGroup parent) {
      LayoutInflater inflater=getLayoutInflater();
      View row=inflater.inflate(R.layout.row, parent, false);
      RestaurantHolder holder=new RestaurantHolder(row);

      row.setTag(holder);

      return(row);
    }
  }

  static class RestaurantHolder {
    private TextView name=null;
    private TextView address=null;
    private ImageView icon=null;

    RestaurantHolder(View row) {
      name=(TextView)row.findViewById(R.id.title);
      address=(TextView)row.findViewById(R.id.address);
      icon=(ImageView)row.findViewById(R.id.icon);
    }

    void populateFrom(Cursor r,RestauranteHelper helper) {
      name.setText(helper.getNome(r));
      address.setText(helper.getEnd(r));

      if (helper.getTipo(r).equals("casa")) {
        icon.setImageResource(R.drawable.casa_icon);
      }
      else if (helper.getTipo(r).equals("apartamento")) {
        icon.setImageResource(R.drawable.apartamento_icon);
      }
      else {
        icon.setImageResource(R.drawable.comercio_ico);
      }
    }
  } 
```

}

现在我的 DeleteItemList：

```
public class DeleteItemList extends Activity{
RestauranteHelper helper = null;
String restauranteId= null;
public void onCreate(Bundle savedInstaceState){
    super.onCreate(savedInstaceState);
    helper= new RestauranteHelper(this);

    restauranteId=getIntent().getStringExtra(ProjetoProTelefoneActivity.ID_EXTRA);

    helper.delete(restauranteId);
    finish();
}

public void onDestroy(){
    super.onDestroy();
    helper.close();

} 
```

}

RestauranteHelper.delete：

```
 public void delete(String id){
    String[] args = {id};

    getWritableDatabase().delete("restaurantes", "_ID =?", args);

} 
```

idk，如果它清楚我想要做什么......我想刷新列表，在选择“删除”选项之后。

=D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:51:48.930

更改列表中的项目后，调用列表适配器上的 notifyDatasetChanged。这样就可以了。

下面是 ListView 的工作方式。

初始化列表后，设置列表适配器中的项目。现在调用 listview.setAdapter 方法来设置适配器。

现在，当您对项目进行任何更改时，请在您传递给适配器的列表中更改它们。

然后调用适配器上的 notofyDatasetChanged。

那应该行得通。如果这不起作用，那么还有其他问题，请尝试调试代码的每个步骤。

** 在您的情况下，您正在调用数据库助手上的删除，但是当您更改数据库上的内容时，您的光标或适配器不会更新。您需要从游标中删除该项目或再次查询数据库，然后将其传递给适配器。

# android - 适用于移动设备或特定移动设备的 Web 应用程序

> ID：10918497
> 
> 赞同：0
> 
> 时间：2012-06-06T16:45:14.817
> 
> 标签：android, ios, html, blackberry, mobile

我有一个关于移动应用程序开发的问题。我想为我的 Kindle 开发一个应用程序，并浏览了教程，我发现 HTML5 CSS 和 JavaScript 可用于开发移动应用程序，而不是 Java、Objective C 等原生编程语言。

不要误会我的意思，我并不反对多学习一点 Java 和 Kindle/Android 特定的 API。但是知道您可以在 Android、Blackberry 和 iOS 平台和网站上使用 HTML5 CSS JavaScript 对我来说听起来很有趣。我还看到了像 Google Play'n 这样的游戏框架，它似乎在 HTML5 和 JavaScript 方面做得很好。

我的问题是，是否值得每个 API 和编程语言的学习曲线，或者 HTML5 CSS JavaScript 是否会改变我们进行前端开发的方式？

对此的任何意见将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:56:02.130

一般来说，为您的目标平台学习原生 SDK 是值得的，因为您将拥有最大的灵活性、最佳性能、最广泛的 API 覆盖范围，跟上平台供应商的最新进展（例如 iCloud、Siri API 等），并且您会发现大量由平台的本地开发人员构建并为该平台的本地开发人员构建的开源软件（参见[http://cocoacontrols.com](http://cocoacontrols.com)作为一个示例）。因此，绝对值得投资于平台的原生 SDK，特别是如果平台本身被证明是成功的，例如 iOS 和 Android。

但是，有时使用 Javascript/HTML5 框架（如 Titanium Appcelerator）构建应用程序可能更实用。*这在受控环境*中很有用，例如您的客户群有限的企业应用程序，或者只是为了快速制作概念原型。

如果我的应用程序或游戏必须在公开市场/应用程序商店与数以千计的其他本地应用程序竞争，我会认为 Javascript 框架是一个劣势。如果我的竞争对手正在使用本机代码并且可以快速发展他们的用户体验或功能，我不想被有限的 Javascript 框架“卡住”。

另一方面，如果我在一家大型超市工作，而我的工作是创建一个只有他们的员工每天会使用几个小时来做​​库存的应用程序，那么 Javascript 框架将帮助我更快地进行原型设计，而不会产生任何威胁竞争或意外要求。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:00:56.897

这个话题可以永远争论不休，但这是我的看法：

*   如果您需要设备上的性能（例如复杂的游戏），那么最好使用本机，因为您可以微调到您所针对的特定设备或一组设备和平台。
*   如果您可以使用 Web 技术构建您的想法并使其规模化和运行良好，那么继续使用 Web 技术将是明智的，因为它非常容易以相对较少的努力扩展到多个平台。
*   如果您想为特定平台利用尖端 API，那么最好使用原生

我个人认为，如果您的应用程序将变得复杂（超出标准的企业数据 API 内容），那么从长远来看，本地化会更容易。我已经利用了这两种方法，虽然 Web 技术非常容易实现和原型化，但实现任何复杂的东西都会大量增加所需的工作量，以至于它否定了通过不采用原生方式节省的任何时间。最终我只是决定专注于原生应用程序，但随着 Web 技术的不断改进，你的里程可能会有所不同。

# javascript - 如何使 Dreamweaver AP Div 显示/隐藏功能在 IE9 中工作？

> ID：10918503
> 
> 赞同：2
> 
> 时间：2012-06-06T16:45:36.143
> 
> 标签：javascript, html, internet-explorer, google-chrome, dreamweaver

我使用 Dreamweaver 和 Fireworks 创建了一个页面，该页面使用一个 AP Div 作为按钮来显示和隐藏其他两个使用 JavaScript 的 AP Div。但是，AP div是相对的地方。在 google chrome 和 safari 中一切正常，但在 IE 9 中根本不起作用。我怀疑这是 JavaScript 和 IE9 的问题。我是新手，我知道我的网站是以一种奇怪的方式构建的。感谢所有帮助。

我还尝试使用本教程： [http](http://webdesign.about.com/od/dhtml/a/aa101507.htm) : //webdesign.about.com/od/dhtml/a/aa101507.htm（显示和隐藏 div 带有链接）

其中a div 是一个链接，以使其工作，但它没有修复它。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T19:25:45.613

是的，我已经废弃了你的代码，不是因为它不好，而是因为我不理解它：P，我使用了不同的东西，这可能意味着你必须在你的页面上重新编写一些代码。我的代码做了什么，它用 div 中的内容替换了内容，而不是在 2 个 div 之间隐藏/显示...下面是 jsfiddle 的链接，尝试在 IE9 中运行它，看看是否有效。

[http://jsfiddle.net/hSMk3/](http://jsfiddle.net/hSMk3/)

如果它不起作用，请在下面的评论部分告诉我:)

# java - 从加速度计类获取值到主要活动类

> ID：10918505
> 
> 赞同：0
> 
> 时间：2012-06-06T16:45:40.870
> 
> 标签：java, android, class, accelerometer

我正在尝试制作一个读取加速度计值并将它们发送到服务器的 Android 应用程序。我在两个文件中有两个类 - 带有 httpget 方法的主类和加速度计类。

我从 onSensorChanged 方法中没有收到任何信息（我通过从加速度计类创建新对象来发送值），或者我的加速度计类不起作用。

问题：1）你能给我一个小例子，当我有一个加速度计类并且我在另一个类中读取值时？

2）我应该从主要活动开始加速计类吗？

如果您能回答我的问题并举个小例子，我将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:02:49.160

请查看源代码。这是关于加速度计的示例源代码。

[关联](http://developer.android.com/resources/samples/AccelerometerPlay/src/com/example/android/accelerometerplay/AccelerometerPlayActivity.html)

我认为它对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:03:01.333

这个问题有点不清楚，所以从以下假设：

文件 1：带有 httpget 的服务器线程

文件2：读取加速度计数据并将其发送到服务器线程

您处于调试环境中，您可以在其中一起运行它们来测试它。

这里的名字似乎有点混乱。仅仅因为您有一个 Accelerometer 类，并不意味着代码处于活动状态并且正在运行。如果您只是使用它的 main 方法启动一个，并且它不引用另一个对象，那么该代码将永远不会运行。

```
public class Server
{
  public void onSensorChanged()
  {
    //do stuff to listen for accelerometer data
  }
  public static void main(String args[])
  {
    onSensorChanged();
  }
} 
```

如果只是这样运行，则没有人读取加速度计数据。

```
public class Accelerometer implements Runnable
{
  public void run()
  {
    while (!dead)
    {
      //read data
      //send to server
      //wait for a bit?
    } 
  }
} 
```

所以我们在Server主方法中添加一行

```
new Thread(new Accelerometer()).start(); 
```

1）我不确定你在问什么。第 1 类从传感器获取数据，第 2 类从第 1 类读取数据并将其发送到服务器？2) 是的，如果您需要运行多个线程，您的入口点将需要同时启动这两个线程。或者他们需要单独启动

# java - Java Switch 语句抛出 Java.lang.NullPointerException - Android 初学者

> ID：10918506
> 
> 赞同：0
> 
> 时间：2012-06-06T16:45:40.920
> 
> 标签：java, android, eclipse, android-layout, nullpointerexception

我是新手，请多多包涵。我创建了一个微调器并用一个字符串数组填充它，然后我创建了一个方法“OnItemSelected”并插入了一个 switch 语句。然后该活动抛出 NullPointerException。当我删除 switch 语句时，该活动有效。我怎样才能解决这个问题？

代码：

```
EditText player1 = null;
EditText player2 = null;
EditText player3 = null;
EditText player4 = null;
EditText player5 = null;
EditText player6 = null;
EditText player7 = null;
EditText player8 = null;

Spinner spinner;

int numberOfPlayers = 0;
int counter = 0;

private String[] players ={"2","3","4", "5", "6", "7", "8"};
//private String[] names ={" "};

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    try {        
    spinner = (Spinner)findViewById(R.id.spinnerplayers);
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, players);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    spinner.setAdapter(adapter);

    spinner.setOnItemSelectedListener(this);
    }catch (Exception e) {

        // handle any errors

        Log.e("TestActivity", "Error in activity", e);  // log the error

        // Also let the user know something went wrong

        Toast.makeText(getApplicationContext(), e.getClass().getName() + " " + e.getMessage(),Toast.LENGTH_LONG).show();
    }
}

@Override
public void onItemSelected(AdapterView<?> arg0, View arg1, int pos,
        long id) {
        numberOfPlayers = pos + 2;

    /*switch(pos){
    case 0:
        player1.findViewById(R.id.editTextPlayer1);
        player2.findViewById(R.id.editTextPlayer2);

        player1.setVisibility(View.VISIBLE);
        player2.setVisibility(View.VISIBLE);
        break;
    case 1:
        player1.findViewById(R.id.editTextPlayer1);
        player2.findViewById(R.id.editTextPlayer2);
        player3.findViewById(R.id.editTextPlayer3);

        player1.setVisibility(View.VISIBLE);
        player2.setVisibility(View.VISIBLE);
        player3.setVisibility(View.VISIBLE);
        break;
    case 2:
        player1.findViewById(R.id.editTextPlayer1);
        player2.findViewById(R.id.editTextPlayer2);
        player3.findViewById(R.id.editTextPlayer3);
        player4.findViewById(R.id.editTextPlayer4);

        player1.setVisibility(View.VISIBLE);
        player2.setVisibility(View.VISIBLE);
        player3.setVisibility(View.VISIBLE);
        player4.setVisibility(View.VISIBLE);
        break;
    case 3: 
        player1.findViewById(R.id.editTextPlayer1);
        player2.findViewById(R.id.editTextPlayer2);
        player3.findViewById(R.id.editTextPlayer3);
        player4.findViewById(R.id.editTextPlayer4);
        player5.findViewById(R.id.editTextPlayer5);

        player1.setVisibility(View.VISIBLE);
        player2.setVisibility(View.VISIBLE);
        player3.setVisibility(View.VISIBLE);
        player4.setVisibility(View.VISIBLE);
        player5.setVisibility(View.VISIBLE);
        break;
    case 4:
        player1.findViewById(R.id.editTextPlayer1);
        player2.findViewById(R.id.editTextPlayer2);
        player3.findViewById(R.id.editTextPlayer3);
        player4.findViewById(R.id.editTextPlayer4);
        player5.findViewById(R.id.editTextPlayer5);
        player6.findViewById(R.id.editTextPlayer6);

        player1.setVisibility(View.VISIBLE);
        player2.setVisibility(View.VISIBLE);
        player3.setVisibility(View.VISIBLE);
        player4.setVisibility(View.VISIBLE);
        player5.setVisibility(View.VISIBLE);
        player6.setVisibility(View.VISIBLE);
        break;
    case 5:
        player1.findViewById(R.id.editTextPlayer1);
        player2.findViewById(R.id.editTextPlayer2);
        player3.findViewById(R.id.editTextPlayer3);
        player4.findViewById(R.id.editTextPlayer4);
        player5.findViewById(R.id.editTextPlayer5);
        player6.findViewById(R.id.editTextPlayer6);
        player7.findViewById(R.id.editTextPlayer7);

        player1.setVisibility(View.VISIBLE);
        player2.setVisibility(View.VISIBLE);
        player3.setVisibility(View.VISIBLE);
        player4.setVisibility(View.VISIBLE);
        player5.setVisibility(View.VISIBLE);
        player6.setVisibility(View.VISIBLE);
        player7.setVisibility(View.VISIBLE);
        break;
    case 6:
        player1.findViewById(R.id.editTextPlayer1);
        player2.findViewById(R.id.editTextPlayer2);
        player3.findViewById(R.id.editTextPlayer3);
        player4.findViewById(R.id.editTextPlayer4);
        player5.findViewById(R.id.editTextPlayer5);
        player6.findViewById(R.id.editTextPlayer6);
        player7.findViewById(R.id.editTextPlayer7);
        player8.findViewById(R.id.editTextPlayer8);

        player1.setVisibility(View.VISIBLE);
        player2.setVisibility(View.VISIBLE);
        player3.setVisibility(View.VISIBLE);
        player4.setVisibility(View.VISIBLE);
        player5.setVisibility(View.VISIBLE);
        player6.setVisibility(View.VISIBLE);
        player7.setVisibility(View.VISIBLE);
        player8.setVisibility(View.VISIBLE);
        break;
    }*/

} 
```

然后这是我的日志：

```
 06-06 12:44:42.433: E/AndroidRuntime(5764): FATAL EXCEPTION: main
06-06 12:44:42.433: E/AndroidRuntime(5764): java.lang.NullPointerException
06-06 12:44:42.433: E/AndroidRuntime(5764):     at com.brightdesign.truthordare.Main.onItemSelected(Main.java:69)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at android.widget.AdapterView.fireOnSelected(AdapterView.java:873)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at android.widget.AdapterView.access$300(AdapterView.java:45)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at android.widget.AdapterView$SelectionNotifier.run(AdapterView.java:839)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at android.os.Handler.handleCallback(Handler.java:587)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at android.os.Handler.dispatchMessage(Handler.java:92)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at android.os.Looper.loop(Looper.java:123)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at android.app.ActivityThread.main(ActivityThread.java:4627)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at java.lang.reflect.Method.invokeNative(Native Method)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at java.lang.reflect.Method.invoke(Method.java:521)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
06-06 12:44:42.433: E/AndroidRuntime(5764):     at dalvik.system.NativeStart.main(Native Method) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:48:05.823

您设置了全局变量，然后使用了局部变量，因此该变量仍然为空。

这是我可以从您的代码中推断出的唯一问题，因为一半的 onItemSelected 已被注释掉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:48:30.427

您正在 com.brightdesign.truthordare.Main.onItemSelected(Main.java:69) 访问空指针。例外是答案，而不是问题:-)

鉴于您有“EditText player1 = null;”这一行 而且我们从来没有看到它被分配，我们必须通灵来帮助您（除非这确实是所有代码，在这种情况下，您需要回到您的“学习 Java”书籍并涵盖基础知识）。

您需要在访问它之前对其进行分配。它是空的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:49:52.693

findViewById 应该在您正在寻找的视图的父级上调用。

代替

```
player1.findViewById(R.id.editTextPlayer1); 
```

你需要

```
player1 = (EditText)findViewById(R.id.editTextPlayer1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:53:30.727

首先，利用`switch`'s fall-through 功能来发挥你的优势：

```
switch(pos){
case 2:
    player4 = (EditText) findViewById(R.id.editTextPlayer4);
    player4.setVisibility(View.VISIBLE);
    // Notice: no break command!

case 1:
    player3 = (EditText) findViewById(R.id.editTextPlayer3);
    player3.setVisibility(View.VISIBLE);

case 0: default:
    player1 = (EditText) findViewById(R.id.editTextPlayer1);
    player2 = (EditText) findViewById(R.id.editTextPlayer2);

    player1.setVisibility(View.VISIBLE);
    player2.setVisibility(View.VISIBLE);
} 
```

此代码尝试在 main.xml 中查找每个 EditText 并将该 View 设置为适当的`player`变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T17:01:49.237

我认为这会导致 onItemSelected() 方法中的代码出现问题：

```
player1.findViewById(R.id.editTextPlayer1);
player2.findViewById(R.id.editTextPlayer2);
//... 
```

findViewById() 方法返回另一个视图或活动主视图的子视图。在您的情况下，引用似乎是 Null 指针，您也不处理结果，这将是使用该方法的唯一原因。

您应该在 onCreate() 方法中只设置一次这些引用：

```
spinner = (Spinner)findViewById(R.id.spinnerplayers);
//...
player1 = (EditText)findViewById(R.id.editTextPlayer1);
player2 = (EditText)findViewById(R.id.editTextPlayer2);
//... 
```

这样，您的所有引用在 onCreate() 之后都是有效的，您可以在 onItemSelected() 方法中安全地访问它们（我认为这会导致 NullPointerException）

# html - 在 Internet Explorer 中重复的背景图像

> ID：10918510
> 
> 赞同：3
> 
> 时间：2012-06-06T16:45:57.103
> 
> 标签：html, css, internet-explorer-8

我正在尝试为表单内的按钮应用背景图像。该代码在所有浏览器（Chrome、FF、Opera 和 Safari）中都能正常工作并且看起来很完美。但是，在 IE8（我检查过的唯一版本）中，图像正在重复。我正在尝试遵循标准和简单的 HTML 和 CSS，但这真的很烦人。请看下面的图片

![在此处输入图像描述](../Images/56c6d685fb0c667742d5333fe112f195.png)

以下是 HTML

```
<div id="header">
            <div id="TopHead">
                <div id="logo">
                    <a href="/" alt="eyaas">
                        <img src="logo.gif" alt="eyaas" />
                    </a>
                </div>
                <div id="country">India | Rest of the World
                </div>
                <div id="linksAndSearch">
                    <div id="linksTop">My Account | Login | Register | Cart
                    </div>
                    <div id="searchBar">
                        <form id="search_mini_form" action="" method="get" class="search"> 
                            <div class="searchBox"> 
                                    <input id="Text1" type="text" name="" class="searchBoxDefaultText jsSearchTerm jsToggle" value="" /> 
                            </div>
                            <div class="searchButton"> 
                                <button type="submit" title="" class="searchBoxSubmitButton" />
                            </div>
                            <div class="clear"></div> 
                        </form>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
            <div id="TopNav">
            </div>
        </div> 
```

以下是CSS

```
#linksAndSearch { float:left; }

.search { width:393px; height:35px; background-image:url('SearchBoxGrayFrameText.gif'); }

.searchBox { float:left; margin:6px 0 0 65px; background-image:url('SearchBoxFramed.gif'); width:275px; height:23px; overflow:hidden; }

.searchBox .searchBoxDefaultText { width:257px; height:19px; margin:2px 0 0 5px; font-size:15px; color:#CCC; }

.searchButton { float:left; margin:6px 0 0 10px; } 

.searchBoxSubmitButton { width:29px; height:23px; background-image:url( SearchSubmitBtnYellowArrow.gif); background-repeat:no-repeat; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:49:08.990

[http://css-tricks.com/how-to-create-an-ie-only-stylesheet/](http://css-tricks.com/how-to-create-an-ie-only-stylesheet/)

你参考这个网站，我认为它可能对你有用，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T20:05:04.710

问题已解决

```
<button type="submit" title="" class="searchBoxSubmitButton"/> 
```

到

```
<button type="submit" title="" class="searchBoxSubmitButton"></button> 
```

**有人可以详细说明为什么会这样吗？**

# perl - 如何删除perl脚本中文件的第一行

> ID：10918513
> 
> 赞同：2
> 
> 时间：2012-06-06T16:46:11.217
> 
> 标签：perl, header, line

如何删除 perl 脚本中 txt 文件的第一行？

```
`sed "1d" filename.txt` 
```

不工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:00:09.477

您可以使用[`Tie::File`](http://search.cpan.org/perldoc?Tie%3a%3aFile)：

```
use Tie::File;
tie @array, 'Tie::File', $filename or die $!;
shift @array;
untie @array; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:50:14.457

```
`sed 1d filename.txt > newfile.txt` 
```

应该管用。如果你不将它重定向到一个文件，它只会读取整个文件减去第一行到标准输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T05:52:37.660

因为您使用内联 sed 执行此操作，所以这里是 Perl 等价物。

```
perl -ne'$.==1?next:print' <(seq 1 10) 
```

选项意味着什么，

```
-n                assume "while (<>) { ... }" loop around program
-e program        one line of program (several -e's allowed, omit programfile) 
```

其他注意事项，

*   `$.`是当前行号的变量。
*   `<()`是用于在后台生成 FIFO 的 Bash 巫术。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:56:25.600

这会将输出发送到`sed`的 STDOUT（Perl 继续捕获到变量中）而不是`filename.txt`. 你想使用`sed`'s `-i`。

```
sed -i "1d" filename.txt 
```

由于没有要捕获的输出，因此使用反引号是没有意义的。你想要`system`。

```
system('sed -i "1d" filename.txt'); 
```

更好：（避免启动另一个外壳）

```
system('sed', '-i', '1d', 'filename.txt'); 
```

最佳：（是否为您检查错误）

```
use IPC::System::Simple qw( systemx );
systemx('sed', '-i', '1d', 'filename.txt'); 
```

# c++ - 在 C++ 中初始化映射和删除的正确方法

> ID：10918514
> 
> 赞同：7
> 
> 时间：2012-06-06T16:46:12.540
> 
> 标签：c++, data-structures, stl, map

我正在尝试创建在我的类的构造函数中声明的静态映射。该映射将在一种方法中初始化并填充数据，并在另一种方法中释放。这是正确的方法吗？

```
using namespace std;
#include <map>

struct a {
     string b;
     string c;
}

class aClass:public myClass
 {
 public:
      aClass();
      virtual ~aClass();

 private: 
      map<string, a> myMap;
      void method(int a);
      void amethod(int b);
 }
 void aClass::method(int a)
 {
      myMap = new map<string, a>;
      // Addition of elements;
 }
 void aClass::amethod(int b)
 {
      // retrival of elements
      myMap.clear();
      delete myMap;
 } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-06T16:47:48.080

```
 map<string, a> myMap;
  ....
  myMap = new map<string, a>; 
```

这里`myMap`不是指针，所以初始化`new`不正确。也许您正在寻找：

```
 myMap = map<string,a>(); 
```

复制到*默认的初始化*`myMap`映射中。

 *请注意，您不需要（实际上也不需要）`delete myMap`，因为它不是指针。它是一个成员变量，当你的类被销毁时，编译器会自动销毁它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T17:11:23.317

```
void aClass::method(int a)
{
  myMap.clear();  // ensure it starts off empty
  // Addition of elements;
}
void aClass::amethod(int b)
{
  // retrival of elements
  myMap.clear();  // maybe not necessary
} 
```

该对象`myMap`已经存在于一个实例中，`aClass`并在其包含的实例被构造时被构造。您不需要使用`new`来创建它，这是 Java 和 C# 的一项功能，其中变量只是对堆上某个实例的引用，并且所有内容都被垃圾收集。在 C++ 中，使数据成员成为值而不是指针或对其他对象的引用更容易。*

# c - eclipse 编辑器无法识别 C #define 指令

> ID：10918517
> 
> 赞同：0
> 
> 时间：2012-06-06T16:46:24.740
> 
> 标签：c, eclipse

我有一个要导入到 eclipse 中的 C 项目。它是预先编写的，但不是 C 程序，所以我将它作为 C Makefile 程序导入。实际上，由于某种原因，该程序是用在适当目录中调用 make 的 shell 脚本编写的，我添加了一个调用 shell 脚本的 Makefile，尽管我可能会将其更改为仅使用 make 文件。

无论如何，不​​寻常的是`#define`我的 C 代码中使用的所有变量都出现异常。这些变量在 C 代码顶部包含的 .h 文件中定义，并且`#include`没有警告。我可以编译代码并毫无例外地运行它。`#define`然而，在编辑器中使用这些值时，我仍然会遇到几十个错误。定义变量的 .h 与引发异常的 C 代码位于不同的文件夹中，但是将带有 .h 的文件夹添加到 C 包含路径中并没有任何好处。任何人都知道我怎样才能让编辑器很好地处理我的`#define`变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T16:57:31.083

你真的在打字`#DEFINE`吗？它应该是`#define`。C 区分大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:28:23.703

.c 文件中如何包含 .h 文件？

```
#include <file.h> 
```

或者

```
#include "file.h" 
```

这些在预处理器中具有不同的含义。

你得到的错误是什么？.h 文件是否找不到，导致其他错误？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T11:55:54.647

以下是进一步调查该问题的一些选项：

1.  在 Eclipse 中右键单击您的项目，转到`Properties`-> `C/C++ General`-> `Paths and Symbols`-> `Symbols`。您可以检查那里定义的符号，也许那里的预处理器搞砸了。
2.  将以下选项添加到您的 g++ 命令行：`-save-temps`. 这将输出一些中间编译文件。检查`.i`or`.ii`文件 - 这些包含预处理的输出。关于这个 g++ 选项的更多信息在[这里](http://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html)。

此外，如果您能提供有关实际错误/警告的更多信息，那就太好了。

# c# - 连续创建位图会导致内存泄漏

> ID：10918518
> 
> 赞同：7
> 
> 时间：2012-06-06T16:46:28.647
> 
> 标签：c#, memory, bitmap, memory-leaks

我有一个线程不断生成位图并截取另一个程序窗口的屏幕截图。现在，我的表单上有一个图片框，它会随着生成的位图不断更新。这是我在线程中的代码：

```
 Bitmap bitmap = null;

        while (true)
        {
            if (listBoxIndex != -1)
            {
                Rectangle rect = windowRects[listBoxIndex];
                bitmap = new Bitmap(rect.Width, rect.Height);
                Graphics g = Graphics.FromImage(bitmap);
                IntPtr hdc = g.GetHdc();
                PrintWindow(windows[listBoxIndex], hdc, 0);
                pictureBox1.Image = bitmap;
                g.ReleaseHdc(hdc);
            }
        } 
```

如您所见，这会导致内存泄漏，因为不断调用 new Bitmap(rect.Width, rect.Height)。我尝试将“bitmap.Dispose()”添加到 while 循环的底部，但这会导致 pictureBox 的图像也被处理，这使得一个巨大的红色 X 代替了实际图像。有什么方法可以在不处理图片框图像的情况下处理“位图”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T16:51:33.873

您还“泄漏”了 Graphics 对象。尝试这个：

```
 while (true)
    {
        if (listBoxIndex != -1)
        {
            Rectangle rect = windowRects[listBoxIndex];
            Bitmap bitmap = new Bitmap(rect.Width, rect.Height);
            using (Graphics g = Graphics.FromImage(bitmap))
            {
                IntPtr hdc = g.GetHdc();
                try
                {
                    PrintWindow(windows[listBoxIndex], hdc, 0);
                }
                finally
                {
                    g.ReleaseHdc(hdc);
                }
            }
            if (pictureBox1.Image != null)
            {
                pictureBox1.Image.Dispose();
            }
            pictureBox1.Image = bitmap;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T17:43:39.543

已回答的示例在 Graphics g 之后有泄漏`g.ReleaseHdc(..);`

记得配置图形变量

例如：

```
g.Dispose(); 
```

# php - 通过 dlvr.it 在我的 RSS 提要中包含一张图片到 Twitter

> ID：10918519
> 
> 赞同：1
> 
> 时间：2012-06-06T16:46:31.500
> 
> 标签：php, twitter, rss

我有一个提要，我安排每 6 小时使用 dlvr.it 交付。它包含潮汐时间和简短的冲浪报告。我还想包括我们网络摄像头的最新图像。这是我更新版本的 RSS 提要，包括图片 URL，但 Twitter 没有获取图片

这是现在包含图像标签的提要

```
<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xml:base="http://www.gowerlive.co.uk/twitterfeed-mumbles.php" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel>
<title>Mumbles.co.uk</title>
<link>http://www.mumbles.co.uk</link>
<description>The Definitive Guide to Mumbles</description>
<language>en</language>
<item>
<title>Tide Times for Mumbles</title>
<link>http://www.mumbles.co.uk/</link>
<description>Todays tides:L02:04 H08:21 L14:23 H20:42\. @ 16:00 the buoy was 4ft@6secs | Wind:gentle SW@9mph. Visit http://www.mumbles.co.uk</description>
<image>
<url>http://www.gowerlive.co.uk/netcam.jpg</url>
<title>Langland Bay</title>
<link>http://www.gowerlive.co.uk/webcams/langland-webcam</link>
</image> 
<pubDate>Wed, 6 Jun 2012 16:34:00 GMT</pubDate>
<dc:creator>Mumbles.co.uk</dc:creator>
<guid isPermaLink='false'>Wed, 6 Jun 2012 16:34:00 GMT</guid>
</item>
</channel>
</rss> 
```

谢谢

李

# ruby-on-rails - Postgres 只是随机停止工作（Rails，PGSQL.5432）

> ID：10918523
> 
> 赞同：4
> 
> 时间：2012-06-06T16:46:47.767
> 
> 标签：ruby-on-rails, postgresql

我已经在同一个应用程序中使用同一个 Postgres 数据库一个月了，没有任何问题，在今天随机出现这个错误之前，我没有更改数据库中的任何内容。但是，今天当我尝试“rails s”时，Postgres 随机开始抛出此错误（运行 createdb 或 createuser 时出现相同类型的错误）：

退出 /Users/Joe/.rvm/gems/ruby-1.9.2-p290/gems/activerecord-3.2.2/lib/active_record/connection_adapters/postgresql_adapter.rb:1194:in `initialize': 无法连接到服务器：没有这样的文件或目录 (PG::Error) 服务器是否在本地运行并接受 Unix 域套接字“/tmp/.s.PGSQL.5432”上的连接？

真正奇怪的是，我的朋友昨天遇到了完全相同的错误（在同一个应用程序上工作），并且通过他运行来自[http://nextmarvel.net/blog/2011/09/brew-install-postgresql的脚本来修复-on-os-x-lion/](http://nextmarvel.net/blog/2011/09/brew-install-postgresql-on-os-x-lion/)。运行脚本后，他卸载并重新安装了 PG gem 以使一切正常。但是，他正在运行 OS X Lion，而我正在运行 Snow Leopard，因此该脚本对我不起作用。

关于（1）为什么这会随机开始发生以及（2）如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T13:15:43.713

我今天遇到了类似的问题，虽然在我的情况下 postgres（通过 MacOS 10.8 上的自制软件安装）没有运行，但我无法启动或重新启动它。似乎由于崩溃，僵尸阻塞了套接字，为了解决它，我做了以下

```
lsof -i :5432 
```

这显示了进程阻塞的PID，我只是用

```
kill -9 PID 
```

并且 postgres 重新启动正常。

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T07:19:42.103

*   也许有些东西被删除了`/tmp/.s.PGSQL.5432`套接字 -`/tmp/`例如清洁服务。
*   也许您将能够使用`:host => 'localhost'`作为连接参数进行连接`PG::Connection.new()`——它将避免为 Unix 套接字或文件权限问题定位正确路径的问题。
*   如果您不想使用`localhost`（它可能比套接字慢一点），那么您可以`lsof | grep PGSQL`以操作系统管理员的身份使用命令找到它在哪里 - 如果是例如`/var/run/postgres/.s.PGSQL.5432`- 你会使用`:host => '/var/run/postres/'`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-30T22:59:29.107

我有一个类似的错误，发现这个答案很有帮助

[升级到 OSX 10.7 Lion 后修复 Postgresql](https://stackoverflow.com/questions/6770649/repairing-postgresql-after-upgrading-to-osx-10-7-lion)

我通过添加解决了

```
export PATH=/usr/local/bin:$PATH 
```

到我的 .bash_profile

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T21:33:31.617

我在启动 rails 时遇到了同样的错误（没有这样的文件或目录）。**[使用PostgreSQL 一键安装程序](http://www.postgresql.org/download/macosx/)****重新安装 postgres并重新启动**解决了该问题。

就我而言，这发生在安装 Mountain Lion 之后，它可能清理了 tmp 目录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-14T09:23:03.053

我遇到了同样的问题，当我检查 server.log 时，我可以看到它无法找到 var/postgres 文件夹和一些 conf 文件。

我这样做了，但是在那种情况下我丢失了我的数据

```
brew uninstall postgres
brew install postgres
initdb `brew --prefix`/var/postgres/data -E utf8`` 
```

这对我来说效果很好，一切都恢复正常。

# java - 在 JSP 文件中调用 java 方法

> ID：10918526
> 
> 赞同：2
> 
> 时间：2012-06-06T16:47:13.517
> 
> 标签：java, jsp

我想在我的jsp页面中调用我的方法getSelectedLayouts，方法在哪里

```
public Iterable<Layouts> getSelectedLayouts(String Subject){
     Session sess=getCurrentSession();
     return sess.createCriteria(Layouts.class, Subject).list();
 } 
```

在类 LayoutManager 中。我使用 Spring Bean 将 LayoutManager 传递到我的 jsp 页面

```
<custom:useSpringBean var="layoutManager" bean="LayoutManager"> 
```

jsp页面要求主题

```
<form method="post">
      <label for="subjectName">SubjectName:</label>
      <input type="text" name="subjectName" size="50" id="subjectName">
      <input class="button" type="submit" value="Search Layout" name="submit">
</form> 
```

然后我传递给

```
<jsp:useBean id="subjectName" class="LayoutManager">
    <c:if test="${param.submit!=null}">

           (here's where I want to call my getSelectedLayouts method)

    </c:if> 
```

我一直在尝试使用 scriplets，包括

```
<jsp:setProperty name="layout" property="*"/>
((LayoutManager)pageContext.getAttribute("layoutManager")).getSelectedLayout((La‌​youts)pageContext.getAttribute("layout")); 
```

要不就

```
<jsp:setProperty name="layout" property="*"/>
list<Layouts> = LayoutManager.getSelectedLayouts(layout); 
```

布局是我的对象类

请告诉我是否需要提供任何其他信息

编辑：当我尝试

```
LayoutManager layoutManager = new LayoutManager();
String subjectNa = request.getParameter("subjectName");
Iterable<Layouts> bla = layoutManager.getSelectedLayouts(subjectNa); 
```

我得到错误列表

```
org.apache.jasper.JasperException: An exception occurred processing JSP page /search.jsp at line 72

Iterable<Layouts> waters = layoutManager.getSelectedLayouts(subjectNa);

java.lang.NullPointerException
com.amazon.basalt.examples.octane.tomcat.LayoutManager.getCurrentSession(LayoutManager.java:37)
com.amazon.basalt.examples.octane.tomcat.LayoutManager.getSelectedLayouts(LayoutManager.java:50)
org.apache.jasper.JasperException: java.lang.NullPointerException
org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:502)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:430)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
javax.servlet.http.HttpServlet.service(HttpServlet.java:820)

    root cause

    java.lang.NullPointerException   com.amazon.basalt.examples.octane.tomcat.LayoutManager.getCurrentSession(LayoutManager.java:37)
com.amazon.basalt.examples.octane.tomcat.LayoutManager.getAllLayouts(LayoutManager.java:68)
org.apache.jsp.search_jsp._jspService(search_jsp.java:221)
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:388)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
javax.servlet.http.HttpServlet.service(HttpServlet.java:820) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T18:49:02.347

我建议您使用 ajax 来获取布局列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:18:37.013

一种可能的解决方案。（如果使用脚本不是问题。）

```
<% 
LayoutManager layoutManager = new LayoutManager();
String subjectName = request.getParameter("subjectName");

layoutManager.getSelectedLayouts(subjectName);
%> 
```

请记住在 JSP 中导入类

# debugging - 暂停任何错误/异常并暂停提交

> ID：10918527
> 
> 赞同：2
> 
> 时间：2012-06-06T16:47:16.550
> 
> 标签：debugging, google-chrome-devtools

我需要一些关于 Google Chrome 调试器的指导。由于对 HTML5 的良好支持，我的应用程序只能在 Google Chrome 中运行。

您如何在检测到的每一个错误/异常上暂停？

这个问题的来源是我正在做一个带有一些Javascript验证的简单表单提交。单击提交按钮时，我可以看到我的开发工具错误框架中出现错误，但它立即切换到我的 PHP 调用仍在开发中的提交，切换页面，因此我无法读取错误。

我试过设置断点，我点击了例外按钮的暂停，但这对我没有帮助，我做错了什么。我完全不知道如何使用调试器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:43:02.313

您是否考虑过尝试在 window.onSubmit 事件的处理函数中设置断点？

对于 jquery，可能是这样的：http: [//jsfiddle.net/7UZsk/27/](http://jsfiddle.net/7UZsk/27/)

```
$(window).bind('submit',function(){
  alert("submitting");
});​ 
```

这是实际的 DOM 事件参考： [https ://developer.mozilla.org/en/DOM/window.onsubmit](https://developer.mozilla.org/en/DOM/window.onsubmit)

# ruby-on-rails - 多选

> ID：10918528
> 
> 赞同：1
> 
> 时间：2012-06-06T16:47:20.573
> 
> 标签：ruby-on-rails, forms, has-many-through, fields-for, html-select

我正在尝试创建一个表单，允许将多个项目成员分配给一个项目。（用户和项目模型通过 UserProject 关联）

这是我的看法：

```
<div class="field">
<%= fields_for :projectmember do |u| %> 
  <%= u.label :projectmember %><br />
  <%= select_tag :projectmember, options_for_select(User.all.collect {|u| [u.id, u.lastname]}, :projectmember),:multiple => true, :prompt => 'Select Person' %>

<% end %>
  </div> 
```

我已经把projectmember标签到处都是，但我不知道如何将这个字段projectmember保存到我的数据库项目和user_projects中！！？？

我的项目控制器：

```
def new
@project = Project.new
@user_project=UserProject.new
@user=User.all    
@user_lastnames = User.all.collect do |u| 
  u.lastname
end

respond_to do |format|
  format.html # new.html.erb
  format.json { render json: @project }
end
end 
```

和

```
def create
@project = Project.new(params[:project])  

respond_to do |format|
  if @project.save
    format.html { redirect_to @project, notice: 'Project was successfully created.' }
    format.json { render json: @project, status: :created, location: @project }         

    @user_project=UserProject.create(:project_id => @project.id, :user_id => @project.projectmember)       

  else
    format.html { render action: "new" }
    format.json { render json: @project.errors, status: :unprocessable_entity }
  end
end
end 
```

创建一个实例后，使用控制台的命令：@project=Project.all 给出：项目 id: 55, projectname: "fdfd", projectdescription: "fdfd", projectheader: "5", projectmember: nil, projecttypename: "dffd ">]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:15:41.820

假设您的关联是这样的：

```
class Project < ActiveRecord::Base
  has_many :project_users
  has_many :users, :through=>:project_users
end 
```

...对于您的项目表单，使用带有“名称”选项的以下帮助**程序 (:name=>'project[user_ids][]')**将选定的 ids 传递给您的控制器：

```
<%= select_tag :user_ids, options_for_select(User.all.collect {|u| [u.lastname, u.id]}),:multiple => true, :prompt => 'Select Person', :name=>'project[user_ids][]' %> 
```

这将为您提供参数中选定的 id，然后您必须连接控制器操作以分配它们。例如：

```
def create
    @project = Project.new(params[:project])  
    users = User.find(params[:project][:user_ids]) rescue []
    @project.users = users
    if @project.save
      ...
    else
      ...
    end
end

def update
    @project = Project.find(params[:id])
    users = User.find(params[:project][:user_ids]) rescue []
    @project.users = users
    if @project.update_attributes(params[:project])
      ...
    else
     ...
    end
end 
```

为了在您呈现编辑表单时重新选择所选项目，我假设您必须将其作为参数添加到 options_for_select 方法。不完全确定。执行上述所有操作的替代方法是使用复选框来选择用户，因为可以在表单呈现时为每个分配的用户设置检查。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T13:37:51.087

我的模型确实是这样的：

```
class Project < ActiveRecord::Base
  has_many :project_users
  has_many :users, :through=>:project_users

  attr_accessible :colourcode, :projectdescription, :user_id, :projectname, :projectheader, :projectmember, :projecttypename
end 
```

我需要改变我的观点（否则不能批量分配受保护的属性）：

```
 <%= select_tag :user_ids, options_for_select(User.all.collect {|u| [u.lastname, u.id]}),:multiple => true, :prompt => 'Select Person', :name=>'project[user_ids][]' %> 
```

经过

```
<%= select_tag :projectmember, options_for_select(User.all.collect {|u| [u.lastname, u.id]}),:multiple => true, :prompt => 'Select Person', :name=>'project[projectmember][]' %> 
```

在我的控制器中：

```
def create
@project = Project.new(params[:project])  

users = User.find(params[:project][:projectmember]) rescue []
@project.users = users    

respond_to do |format|
  if @project.save
    format.html { redirect_to @project, notice: 'Project was successfully created.' }
    format.json { render json: @project, status: :created, location: @project }         

   @user_project=UserProject.create(:project_id => @project.id, :user_id => @project.projectmember)
    @user_project=UserProject.create(:project_id => @project.id, :user_id => @project.projectheader) 
```

创建后我现在得到了：

```
@p=Project.all

 Project id: 69, projectname: "test", projectdescription: "blabla", colourcode: "blue", projectheader: "5", projectmember: "---\n- '5'\n- '6'\n", projecttypename: "caucasian">]

@up=UserProject.all

UserProject id: 86, project_id: 69, user_id: 5, created_at: "2012-06-07 13:04:51", updated_at: "2012-06-07 13:04:51">

UserProject id: 87, project_id: 69, user_id: 6, created_at: "2012-06-07 13:04:51", updated_at: "2012-06-07 13:04:51">, 
```

我很高兴:)

仍然需要：

如果项目被删除，则自动删除项目/用户对

在屏幕上显示相应的成员名称而不是 ID 号...

# ruby-on-rails - 如何使用 Rails 路由从一个域重定向到另一个域？

> ID：10918529
> 
> 赞同：22
> 
> 时间：2012-06-06T16:47:22.983
> 
> 标签：ruby-on-rails, routing, rails-routing

我的应用程序曾经在 foo.tld 上运行，但现在它在 bar.tld 上运行。请求仍然会进入 foo.tld，我想将它们重定向到 bar.tld。

我怎样才能在铁路路线中做到这一点？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-06-06T17:32:24.227

这适用于 Rails 3.2.3

```
constraints(:host => /foo.tld/) do
  match "/(*path)" => redirect {|params, req| "http://bar.tld/#{params[:path]}"}
end 
```

这适用于 Rails 4.0

```
constraints(:host => /foo.tld/) do
  match "/(*path)" => redirect {|params, req| "http://bar.tld/#{params[:path]}"},  via: [:get, :post]
end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-12-01T01:06:20.817

这完成了另一个答案的工作。此外，它还**保留了查询字符串**。（导轨 4）：

```
# http://foo.tld?x=y redirects to http://bar.tld?x=y
constraints(:host => /foo.tld/) do
  match '/(*path)' => redirect { |params, req|
    query_params = req.params.except(:path)
    "http://bar.tld/#{params[:path]}#{query_params.keys.any? ? "?" + query_params.to_query : ""}"
  }, via: [:get, :post]
end 
```

注意：如果您处理的是完整域而不仅仅是子域，请使用 :domain 而不是 :host。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-08T20:41:29.903

以下解决方案在所有其他请求上返回 http 400 时重定向多个域`GET`和`HEAD`请求（根据类似问题中的[此评论）。](https://stackoverflow.com/questions/4372896/rails-ensuring-www-is-in-the-url#comment4763365_4373733)

**/lib/constraints/domain_redirect_constraint.rb：**

```
module Constraints
  class DomainRedirectConstraint
    def matches?(request)
      request_host = request.host.downcase
      return request_host == "foo.tld1" || \
             request_host == "foo.tld2" || \
             request_host == "foo.tld3"
    end
  end
end 
```

**/config/routes.rb：**

```
require 'constraints/domain_redirect_constraint'

Rails.application.routes.draw do
  match "/(*path)", to: redirect {|p, req| "//bar.tld#{req.fullpath}"}, via: [:get, :head], constraints: Constraints::DomainRedirectConstraint.new
  match "/(*path)", to: proc { [400, {}, ['']] }, via: :all, constraints: Constraints::DomainRedirectConstraint.new

  ...
end 
```

由于某种原因`constraints Constraints::DomainRedirectConstraint.new do`，在heroku上对我不起作用，但`constraints: Constraints::DomainRedirectConstraint.new`效果很好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-05-28T14:21:07.310

更现代的方法：

```
constraints(host: 'www.mydomain.com') do
    get '/:param' => redirect('https://www.mynewurl.com/:param')
end 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-06-22T18:39:18.003

与其他答案类似，这个对我有用：

```
# config/routes.rb
constraints(host: "foo.com", format: "html") do
  get ":any", to: redirect(host: "bar.com", path: "/%{any}"), any: /.*/
end 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-02-03T08:02:32.957

```
constraints(host: /subdomain\.domain\.com/) do
  match '/(*path)' => redirect { |params, req|
    "https://www.example.com#{req.fullpath}"
  }, via: [:get, :head]
end 
```

我在 Heroku 上使用自定义域时使用它，我想从 myapp.herokuapp.com -> www.example.com 重定向。

# c# - 在 DefaultControllerFactory 中使用 Unity 2 解析命名注册

> ID：10918532
> 
> 赞同：2
> 
> 时间：2012-06-06T16:47:34.233
> 
> 标签：c#, asp.net-mvc-3, unity-container, controller-factory

我在使用在 DefaultControllerFactory 中设置 DI 的 ASP.NET MVC 3 解决 Unity 2 中注册类型的命名注册时遇到问题。

在一个程序集中，我定义了具有注册类型和命名注册的 Unity 容器

```
public class VisUnityContainer : UnityContainer
{
    public IUnityContainer RegisterVisComponents()
    {
         // register types
         this               
             .RegisterType<ICompanyService, CompanyService>()
             .RegisterType<ICompanyService, TestCompanyService>( "2" );
    }
} 
```

在我的 MVC 项目中，我继承了 DefaultControllerFactory 我正在解析类型并传递 VisUnityContainer

```
public class UnityControllerFactory : DefaultControllerFactory
{
    private readonly IUnityContainer unityContainer;

    public UnityControllerFactory( IUnityContainer unityContainer )
    {
        // set contracts
        if( unityContainer == null )
            throw new ArgumentNullException( null, "Unity container is not initialized." );

        // set associations
        this.unityContainer = unityContainer;
    }

    protected override IController GetControllerInstance( RequestContext requestContext, Type controllerType )
    {
        // set contracts
        if( controllerType == null )
            throw new HttpException( 404, String.Format(  "The controller for path '{0}' could not be found or it does not implement IController.",
                     requestContext.HttpContext.Request.Path ) );
        if( !typeof( IController ).IsAssignableFrom( controllerType ) )
            throw new ArgumentException( String.Format( "Type requested is not a controller: {0}", controllerType.Name ) );

        // action result
        IController controller;

        // company law
        string companyLaw = String.Empty;

        // set user properties
        if( Thread.CurrentPrincipal != null &&
            Thread.CurrentPrincipal.Identity.Name != null &&
            !String.IsNullOrWhiteSpace( Thread.CurrentPrincipal.Identity.Name ) )
        {
            // set culture for law of companies region
            CultureInfo cultureInfo = new CultureInfo( Profile.GetCurrent().CompanyState );

            // set language
            CultureInfo uiCultureInfo = new CultureInfo( Profile.GetCurrent().UserLanguage );

            // set dates etc.
            Thread.CurrentThread.CurrentCulture = cultureInfo;

            // get proper resource file
            Thread.CurrentThread.CurrentUICulture = uiCultureInfo;

            // set company law
            companyLaw = Profile.GetCurrent().CompanyLaw;
        }

        try
        {
            // resolve container
            controller = this.unityContainer.Resolve( controllerType, companyLaw ) as IController;
        }
        catch( Exception )
        {
            // throw exception
            throw new InvalidOperationException( String.Format( "Error resolving controller {0}", controllerType.Name ) );
        }

        // action end
        return controller;

    }
} 
```

问题在于线路

```
controller = this.unityContainer.Resolve( controllerType, companyLaw ) as IController; 
```

虽然 companyLaw 等于 2，但它不解析命名注册 TestCompanyService，但始终解析 CompanyService。如果我还使用一些命名注册设置 CompanyService，它会抛出一个错误，指出它无法解析类型。

另外，如果我尝试手动解析类似的类型

```
var test = this.unityContainer.Resolve<ICompanyService>( companyLaw ); 
```

它返回正确的类型。

有人知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T10:20:57.533

```
Container.Resolve(type,string) 
```

和

```
Container.Resolve<T>(string) 
```

不是不同的方法。

Resolve(string) 实际上是一个扩展方法，它在内部调用 Container.Resolve(type,string)。

看代码，“controllerType”是类还是接口？如果“controllerType”是类 (CompanyService) 而不是接口 (ICompanyService)，它将始终解析为 CompanyService。它还可以解释为什么当您尝试时它会出错

```
Resolve(controllerType,"2") 
```

因为你实际上在这里说的是：

```
container.Resolve(typeof(CompanyService),"2"); 
```

这不存在。

这也可以解释为什么它在您调用时起作用：

```
container.Resolve<ICompanyService>("2"); 
```

因为你在这里设置了正确的界面

所以，简短的回答：

我认为您传递的是具体的类类型而不是 Unity 的接口。应该很容易检查。

# c# - 这种格式的正则表达式

> ID：10918533
> 
> 赞同：-1
> 
> 时间：2012-06-06T16:47:39.910
> 
> 标签：c#, asp.net-mvc

我想在 C# 中使用这种格式的正则表达式

像这样的格式：

（EMPnnnRTLnnnn-aaaa 或 EMPnnnnBBCaaaa-nn）其中 n 表示 (0 – 9) 之间的单个数字，“a”表示 (A – Z) 之间的单个小写字母。

例如 EMP0001RTL1489-azio、EMP9212BBCgqui-02

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T16:51:21.380

```
Regex r = new Regex(@"EMP(\d{3}RTL\d{4}-[a-z]{4})|\d{4}BBC[a-z]-\d{2}"); 
```

你真的应该学会使用你的工具，@swapnil - 剪贴板开发不是一个好习惯，对你的灵魂有害。

# connection-pooling - 使用类中的查询时超时（池已完全使用）

> ID：10918535
> 
> 赞同：1
> 
> 时间：2012-06-06T16:47:43.213
> 
> 标签：connection-pooling, sqlconnection

我的 asp.net (vb) 网站上有几个页面。所有页面都需要数据库，所以我创建了一个类，并在其中添加了下一个函数：

```
 Public Shared Function query(ByVal sql_str As String) As DataTable

        conn As New SqlConnection()
        conn.ConnectionString = connStringReadOnly
        conn.Open()

        Dim cmd As SqlCommand = conn.CreateCommand()
        cmd.CommandText = sql_str
        Dim ors As SqlDataReader = cmd.ExecuteReader()

        Dim tmp_dt As New DataTable
        tmp_dt.Load(ors)

        ors.Close()
        conn.Close()

        Return tmp_dt

    End Function 
```

现在，当我在我的代码中使用它时，我很快就会超时......我正在关闭连接......

我哪里错了？

# javascript - 带时区的 node-cron

> ID：10918541
> 
> 赞同：6
> 
> 时间：2012-06-06T16:48:11.370
> 
> 标签：javascript, node.js, cron, timezone

我有一个带有[node-cron](https://github.com/ncb000gt/node-cron) (0.3.2) 和[node-time](https://github.com/TooTallNate/node-time) (0.8.2)的[节点](http://nodejs.org/)(v0.7.3-pre) 服务器：

```
var cronJob = require('cron').CronJob;
var cronJ = new cronJob({
 cronTime: "00 29 16 6 * *",
 onTick: function() {
  console.log("Tick");
 },
 start:true,
 timeZone: "America/Los_Angeles"
});
console.log(cronJ); 
```

它运行，但 Cron 始终使用服务器时间（UTC），返回的 cron 是：

```
{ _callbacks: [ [Function] ],
  onComplete: undefined,
  cronTime:
   { source: '00 29 16 6 * *',
     zone: undefined,
     second: { '0': true },
     minute: { '29': true },
     hour: { '16': true },
     dayOfWeek:
... 
```

`zone`设置为，`undefined`我错过了什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T00:35:53.927

因为 node-cron 模块中的错误。我已经发送了一个[拉取请求](https://github.com/baryshev/node-cron/commit/912fb5e07d61458d36d1d39d62a28461d65ed9be)来修复它。您可以在此模块的本地副本中更改此行。

您还可以使用多个函数参数来初始化 cronJob 而不是一个对象：

```
var cronJob = require('cron').CronJob;
var cronJ = new cronJob("00 29 16 6 * *", function() {
        console.log("Tick");
}, undefined, true, "America/Los_Angeles");

console.log(cronJ); 
```

# c# - 对象引用未设置为对象的实例（不知道该怎么办）

> ID：10918545
> 
> 赞同：2
> 
> 时间：2012-06-06T16:48:23.890
> 
> 标签：c#, asp.net, sql

这是错误：

> 异常详细信息：System.NullReferenceException：对象引用未设置为对象的实例。

它停在这里：`con.Open();`

这是代码：

```
SqlConnection con = new SqlConnection(DBHelper.connection);
    SqlCommand com = new SqlCommand();
    con = com.Connection;
    con.Open();
    com.CommandType = CommandType.Text;
    com.CommandText = "select catname,catdescription,photo from category where catid=" + catselectddl.SelectedValue ;
     SqlDataReader dr= com.ExecuteReader();
     DataTable dt = new DataTable();
     dt.Load(dr);
     DataRow drr;
     drr=dt.Rows[0];
     con.Close(); 
```

错误：

```
Line 19:         SqlCommand com = new SqlCommand();
Line 20:         con = com.Connection;
Line 21:         con.Open(); // here the error
Line 22:         com.CommandType = CommandType.Text;
Line 23:         com.CommandText = "select catname,catdescription,photo from category where catid=" + catselectddl.SelectedValue 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:52:43.357

第三行是错误的。它应该是

```
 com.Connection = con; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T16:52:53.453

您需要更改此行（此时`com.Connection`是`null`）：

```
con = com.Connection; 
```

对此：

```
com.Connection = con; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T16:53:10.730

您以错误的顺序分配连接。您应该将在第一行创建的连接分配给 SqlCommand，而不是将 SqlCommand 的连接（尚未创建）分配给您之前创建的 SqlConnection 变量 con。

```
SqlConnection con = new SqlConnection(DBHelper.connection);
con.Open();
SqlCommand com = new SqlCommand();
com.Connection = con 
```

您还应该检查您的连接状态，以确保它在执行命令之前成功打开。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:58:10.377

试试这个：

```
SqlConnection con = new SqlConnection(DBHelper.connection);
SqlCommand com = con.CreateCommand();
con.Open();
com.CommandType = CommandType.Text;
com.CommandText = "select catname,catdescription,photo from category where catid=" + catselectddl.SelectedValue ;
 SqlDataReader dr= com.ExecuteReader();
 DataTable dt = new DataTable();
 dt.Load(dr);
 DataRow drr;
 drr=dt.Rows[0];
 con.Close(); 
```

您实际上是在尝试从命令创建连接 - 需要为命令分配连接，反之亦然。

我还建议使用我喜欢的“使用”语法，它还负责处理命令和连接。

```
using (SqlConnection con = new SqlConnection(DBHelper.connection))
{
  using(SqlCommand com = con.CreateCommand())
  {
   con.Open();
   com.CommandType = CommandType.Text;
   com.CommandText = "select catname,catdescription,photo from category where catid=" + catselectddl.SelectedValue ;
   SqlDataReader dr= com.ExecuteReader();
   DataTable dt = new DataTable();
   dt.Load(dr);
   DataRow drr;
   drr=dt.Rows[0];
   }
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T17:50:47.847

"从 catid=" + catselectddl.SelectedValue 的类别中选择猫名、猫描述、照片

附带说明：
这种类型的 SQL 脚本，如果变成一种习惯，将会打开大门`SQL-Injection`；而且我认为没有开发人员喜欢这种类型的缺陷......

# ios - 使用 UIAppearance 移动 UINavigationBar

> ID：10918547
> 
> 赞同：7
> 
> 时间：2012-06-06T16:48:29.430
> 
> 标签：ios, ios5, uinavigationbar, uiappearance

我正在尝试增加`UINavigationBar`通孔的高度`UIAppearance`

高度本身确实发生了变化，但部分栏被设备状态栏遮挡。我想将条向下移动 22 像素，使其完全可见：

```
[[UINavigationBar appearance] setFrame:CGRectMake([[UINavigationBar appearance] frame].origin.x, 22, [[UINavigationBar appearance] frame].size.width, 103)]; 
```

我还设置了自动调整大小的蒙版

```
[[UINavigationBar appearance] setAutoresizingMask:UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleBottomMargin]; 
```

不过没有翻译吧。这里有其他方法或其他步骤吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T23:05:03.527

您可以通过以下方式仅向下移动标题：

```
[[UINavigationBar appearance] setTitleVerticalPositionAdjustment:5 forBarMetrics:UIBarMetricsDefault]; 
```

# php - php 导航数组包括 - 添加新项目

> ID：10918552
> 
> 赞同：1
> 
> 时间：2012-06-06T16:48:41.290
> 
> 标签：php, arrays, navigation

我需要帮助将新项目添加到先前创建的现有菜单中。我在菜单中添加了以下代码行，但没有显示任何内容。

```
 ,'support'   => array('str'=>'Support','href'=>'/search/movies/support.php') 
```

我在包含文件中更改的代码如下：

```
EOF;

$ary_menu = array(
     'learn'     => array('str'=>'Learn','href'=>'/tech/index.php'
        ,'sub'   => array(
             'principles' => array('str'=>'Laser Principles','href'=>'/tech/index.php')
            ,'standards'  => array('str'=>'Safety and International Standards','href'=>'/tech/install.php')
            ,'glossary'   => array('str'=>'Laser Terms Glossary','href'=>'/tech/yougo/a.php'
                ,'src'    => $src_glossary
            )
            ,'techniques' => array('str'=>'Laser Processing Techniques','href'=>'/tech/kakou.php')
            ,'faq'        => array('str'=>'Laser Marker FAQ','href'=>'/tech/faq.php'
                ,'sub' => $sub_faq
            )
        )
     )
    ,'explore'   => array('str'=>'Explore','href'=>'/search/movies/index.php'
        ,'sub'   => array(
             'mov'         => array('str'=>'Videos','href'=>'/search/movies/index.php')
            ,'appl'        => array('str'=>'Industries and <br/>Applications','href'=>'/search/appli/index.php')
            ,'character'   => array('str'=>'Laser Characteristics <br/>by Material','href'=>'/search/features/index.php'
                ,'sub'     => $sub_lcm
            )
        )
    )
    ,'products'  => array('str'=>'Products','href'=>'/products/index.php'
        ,'sub'   => array(
             'pd_overview' => array('str'=>'Overview','href'=>'/products/index.php')
            ,'mdt1000'     => array('str'=>'Green Laser Marker<br><font size="1">MD-T 1000 Series</font>','href'=>'/products/green-laser-marker.php')
            ,'mdf3000'     => array('str'=>'Fiber Laser Marker<br><font size="1">MD-F 3000 Series</font>','href'=>'/products/fiber-laser-marker.php')
            ,'mdv9900'     => array('str'=>'YVO4 Laser Marker<br><font size="1">MD-V 9900A Series</font>','href'=>'/products/yvo4-laser-marker.php')
            ,'mlz9500'     => array('str'=>'CO2 Laser Marker<br><font size="1">ML-Z 9500 Series</font>','href'=>'/products/co2-laser-marker.php')
            ,'mlg9300'     => array('str'=>'CO2 Laser Marker<br><font size="1">ML-G 9300 Series</font>','href'=>'/products/high-speed-co2-laser-marker.php')
            ,'mdh9800'     => array('str'=>'YAG Laser Marker<br><font size="1">MD-H 9800 Series</font>','href'=>'/products/yag-laser-marker.php')
        )
    )
    ,'downloads' => array('str'=>'Downloads','href'=>'/downloads/index.php'
        ,'sub'   => array(
             'dl_top'      => array('str'=>'Download Catalog','href'=>'/downloads/index.php')
            ,'lib_top'     => array('str'=>'Laser Marking Library','href'=>'/downloads/index.php#lib'
                ,'sub'     => array(
                     'lib_qa'      => array('str'=>'Marking Q&A','href'=>'/topics/library_question.php')
                    ,'lib_app'     => array('str'=>'Introduction Examples','href'=>'/topics/library_application.php')
                    ,'lib_cost'    => array('str'=>'Expert Knowledge','href'=>'/topics/library_costdown.php')
                    ,'lib_other'    => array('str'=>'Industry','href'=>'/topics/library_other.php')
        )
    )
    ,'support'   => array('str'=>'Support','href'=>'/search/movies/support.php')
            )
        )
    ,'virtual'   => array('str'=>'Virtual','href'=>'/virtual/index.php')
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:10:05.213

从当前结构来看，支持菜单将出现在下载的子菜单下。那是你要的吗？如果要将其作为主菜单，则结构应为：

```
<?php
$ary_menu = array(
     'learn'     => array('str'=>'Learn','href'=>'/tech/index.php'
        ,'sub'   => array(
             'principles' => array('str'=>'Laser Principles','href'=>'/tech/index.php')
            ,'standards'  => array('str'=>'Safety and International Standards','href'=>'/tech/install.php')
            ,'glossary'   => array('str'=>'Laser Terms Glossary','href'=>'/tech/yougo/a.php'
                ,'src'    => $src_glossary
            )
            ,'techniques' => array('str'=>'Laser Processing Techniques','href'=>'/tech/kakou.php')
            ,'faq'        => array('str'=>'Laser Marker FAQ','href'=>'/tech/faq.php'
                ,'sub' => $sub_faq
            )
        )
     )
    ,'explore'   => array('str'=>'Explore','href'=>'/search/movies/index.php'
        ,'sub'   => array(
             'mov'         => array('str'=>'Videos','href'=>'/search/movies/index.php')
            ,'appl'        => array('str'=>'Industries and <br/>Applications','href'=>'/search/appli/index.php')
            ,'character'   => array('str'=>'Laser Characteristics <br/>by Material','href'=>'/search/features/index.php'
                ,'sub'     => $sub_lcm
            )
        )
    )
    ,'products'  => array('str'=>'Products','href'=>'/products/index.php'
        ,'sub'   => array(
             'pd_overview' => array('str'=>'Overview','href'=>'/products/index.php')
            ,'mdt1000'     => array('str'=>'Green Laser Marker<br><font size="1">MD-T 1000 Series</font>','href'=>'/products/green-laser-marker.php')
            ,'mdf3000'     => array('str'=>'Fiber Laser Marker<br><font size="1">MD-F 3000 Series</font>','href'=>'/products/fiber-laser-marker.php')
            ,'mdv9900'     => array('str'=>'YVO4 Laser Marker<br><font size="1">MD-V 9900A Series</font>','href'=>'/products/yvo4-laser-marker.php')
            ,'mlz9500'     => array('str'=>'CO2 Laser Marker<br><font size="1">ML-Z 9500 Series</font>','href'=>'/products/co2-laser-marker.php')
            ,'mlg9300'     => array('str'=>'CO2 Laser Marker<br><font size="1">ML-G 9300 Series</font>','href'=>'/products/high-speed-co2-laser-marker.php')
            ,'mdh9800'     => array('str'=>'YAG Laser Marker<br><font size="1">MD-H 9800 Series</font>','href'=>'/products/yag-laser-marker.php')
        )
    )
    ,'downloads' => array('str'=>'Downloads','href'=>'/downloads/index.php'
        ,'sub'   => array(
             'dl_top'      => array('str'=>'Download Catalog','href'=>'/downloads/index.php')
            ,'lib_top'     => array('str'=>'Laser Marking Library','href'=>'/downloads/index.php#lib'
                ,'sub'     => array(
                     'lib_qa'      => array('str'=>'Marking Q&A','href'=>'/topics/library_question.php')
                    ,'lib_app'     => array('str'=>'Introduction Examples','href'=>'/topics/library_application.php')
                    ,'lib_cost'    => array('str'=>'Expert Knowledge','href'=>'/topics/library_costdown.php')
                    ,'lib_other'    => array('str'=>'Industry','href'=>'/topics/library_other.php')
        )
    )

            )
        ),'support'   => array('str'=>'Support','href'=>'/search/movies/support.php')
    ,'virtual'   => array('str'=>'Virtual','href'=>'/virtual/index.php')
);

?> 
```

**编辑：**在下面，如果您的意思是在“学习”链接之后（不是作为子链接）..这里是：

```
<?php
$ary_menu = array(
     'learn'     => array('str'=>'Learn','href'=>'/tech/index.php'
        ,'sub'   => array(
             'principles' => array('str'=>'Laser Principles','href'=>'/tech/index.php')
            ,'standards'  => array('str'=>'Safety and International Standards','href'=>'/tech/install.php')
            ,'glossary'   => array('str'=>'Laser Terms Glossary','href'=>'/tech/yougo/a.php'
                ,'src'    => $src_glossary
            )
            ,'techniques' => array('str'=>'Laser Processing Techniques','href'=>'/tech/kakou.php')
            ,'faq'        => array('str'=>'Laser Marker FAQ','href'=>'/tech/faq.php'
                ,'sub' => $sub_faq
            )
        )
     ),'support'   => array('str'=>'Support','href'=>'/search/movies/support.php')
    ,'explore'   => array('str'=>'Explore','href'=>'/search/movies/index.php'
        ,'sub'   => array(
             'mov'         => array('str'=>'Videos','href'=>'/search/movies/index.php')
            ,'appl'        => array('str'=>'Industries and <br/>Applications','href'=>'/search/appli/index.php')
            ,'character'   => array('str'=>'Laser Characteristics <br/>by Material','href'=>'/search/features/index.php'
                ,'sub'     => $sub_lcm
            )
        )
    )
    ,'products'  => array('str'=>'Products','href'=>'/products/index.php'
        ,'sub'   => array(
             'pd_overview' => array('str'=>'Overview','href'=>'/products/index.php')
            ,'mdt1000'     => array('str'=>'Green Laser Marker<br><font size="1">MD-T 1000 Series</font>','href'=>'/products/green-laser-marker.php')
            ,'mdf3000'     => array('str'=>'Fiber Laser Marker<br><font size="1">MD-F 3000 Series</font>','href'=>'/products/fiber-laser-marker.php')
            ,'mdv9900'     => array('str'=>'YVO4 Laser Marker<br><font size="1">MD-V 9900A Series</font>','href'=>'/products/yvo4-laser-marker.php')
            ,'mlz9500'     => array('str'=>'CO2 Laser Marker<br><font size="1">ML-Z 9500 Series</font>','href'=>'/products/co2-laser-marker.php')
            ,'mlg9300'     => array('str'=>'CO2 Laser Marker<br><font size="1">ML-G 9300 Series</font>','href'=>'/products/high-speed-co2-laser-marker.php')
            ,'mdh9800'     => array('str'=>'YAG Laser Marker<br><font size="1">MD-H 9800 Series</font>','href'=>'/products/yag-laser-marker.php')
        )
    )
    ,'downloads' => array('str'=>'Downloads','href'=>'/downloads/index.php'
        ,'sub'   => array(
             'dl_top'      => array('str'=>'Download Catalog','href'=>'/downloads/index.php')
            ,'lib_top'     => array('str'=>'Laser Marking Library','href'=>'/downloads/index.php#lib'
                ,'sub'     => array(
                     'lib_qa'      => array('str'=>'Marking Q&A','href'=>'/topics/library_question.php')
                    ,'lib_app'     => array('str'=>'Introduction Examples','href'=>'/topics/library_application.php')
                    ,'lib_cost'    => array('str'=>'Expert Knowledge','href'=>'/topics/library_costdown.php')
                    ,'lib_other'    => array('str'=>'Industry','href'=>'/topics/library_other.php')
        )
    )

            )
        )
    ,'virtual'   => array('str'=>'Virtual','href'=>'/virtual/index.php')
);

?> 
```

# amazon-s3 - 如何使用 Amazon S3 存储桶策略设置 HTTP 标头？

> ID：10918558
> 
> 赞同：4
> 
> 时间：2012-06-06T16:49:01.143
> 
> 标签：amazon-s3, http-headers

所以[显然](http://forums.macrumors.com/showthread.php?t=941136)Firefox[不会](https://developer.mozilla.org/en/HTTP_access_control)从另一个域加载 @font-face 字体，除非这些字体带有`Access-Control-Allow-Origin "*"`标题。

如何使用 Amazon S3 存储桶策略在键前缀上设置此标头？还是我必须手动将其添加到每个对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T00:26:18.063

终于有可能了： http: [//docs.amazonwebservices.com/AmazonS3/latest/dev/cors.html](http://docs.amazonwebservices.com/AmazonS3/latest/dev/cors.html)

# ruby - Rails 3.1 应用程序不会自动更新 div

> ID：10918559
> 
> 赞同：1
> 
> 时间：2012-06-06T16:49:07.127
> 
> 标签：ruby, ruby-on-rails-3, jquery, ruby-on-rails-3.1

我有一个 Rails 3.1 应用程序，其中视图具有以下链接：

```
<%= link_to("Answer Question",question_ajaxans_path(@question.id),:remote=>true)%> 
```

其中有控制器选项：

```
def answer
    @answer = Answer.new(:question_id=>params[:question_id])
    respond_to do |format|
        format.js
    end
end 
```

呈现此部分代码：

```
 alert("it worked");
 $("div#answers").append(<%= escape_javascript(render :partial=>"answers/form") %>); 
```

Firebug 显示部分已呈现，我仔细检查了我的视图以验证是否存在带有答案 id 的 div。

这个 turorial ，[http://railscasts.com/episodes/205-unobtrusive-javascript?view=asciicast](http://railscasts.com/episodes/205-unobtrusive-javascript?view=asciicast)，似乎表明它应该只是加载，我在网上找到的其他内容也是如此。但是，我认为情况并非如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:20:30.170

感谢这篇文章[http://rails3stuff.posterous.com/#!/59899595](http://rails3stuff.posterous.com/#!/59899595)我意识到我的问题在于 .append()。我没有用引号包裹内部。

# android - android - 图片未从 url 显示在设备上

> ID：10918563
> 
> 赞同：3
> 
> 时间：2012-06-06T16:49:16.090
> 
> 标签：android, image, url, drawable

我从 URL 接收图像，它们显示在模拟器上，但是当我使用设备时，会显示默认图像。我不完全确定您需要代码的哪一部分，所以我会根据要求添加更多：

```
pubImage = extras.getString("pubImage");

ImageView ivimage = (ImageView) findViewById(R.id.image);
try{
            ivimage.setImageDrawable(grabImageDrawableFromUrl(pubImage));
            Log.d(TAG, pubImage);   

        }catch(Exception e){
            e.printStackTrace();
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T16:51:05.237

我在 Android 中使用[Prime](https://github.com/DHuckaby/Prime)来加载我的所有图像。如果您正在使用它，那么您将不必担心此类问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T16:55:21.597

尝试这个...

```
InputStream is = (InputStream) this.fetch(url);
Drawable d = Drawable.createFromStream(is, "src");
ivimage.setImageDrawable(drawable); 
```

如果您仍然没有得到解决方案，请使用[Universal Image Loader](https://github.com/nostra13/Android-Universal-Image-Loader)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:53:07.187

看看[这个问题的答案](https://stackoverflow.com/questions/3375166/android-drawable-images-from-url)，似乎你可能遗漏了一些细节，但也许你应该粘贴`grabImageDrawableFromUrl()`任何一种方式。

# view - 查看 spring mvc Web 应用程序的技术

> ID：10918566
> 
> 赞同：1
> 
> 时间：2012-06-06T16:49:27.360
> 
> 标签：view, presentation

我正在使用 Spring MVC 开发一个 Web 应用程序，我在 Web 设计方面是全新的我想编写我的`Views`，但我真的不知道如何设计所有这些，我需要两个视图，一个表单用于高级搜索项目，另一个用于查看结果。

我可以从任何框架或设施开始吗？

我浏览了 spring 文档中的视图技术部分，我发现：

1.  JSP/JSTL
2.  瓷砖
3.  速度与自由制造者
4.  XSLT

这就是我能用的吗？你推荐哪一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T16:57:14.703

最常用的视图实现（也有最好的工具支持）是 JSP/JSTL。

从 Velocity/Freemarker 系列（有点）你可以看看[ThymeLeaf](http://www.thymeleaf.org) - 它很干净而且很容易学习。它还使您能够使用*自然模板*- HTML 文件，无需更改即可在 Web 应用程序（作为 SpringMVC 视图）中工作并且直接在浏览器中打开。

# ruby-on-rails-3 - 在保存到数据库之前更新嵌套属性

> ID：10918569
> 
> 赞同：2
> 
> 时间：2012-06-06T16:49:35.613
> 
> 标签：ruby-on-rails-3, nested-forms

Stackoverflow 的长期读者，但从未发现自己能够提出问题（尚未回答）。我想每件事都有第一次，所以就这样吧……

**系统信息：**
Ruby 版本 = 1.8.7
Rails 版本 = 3.2.2

**情况：**
我们有一个带有用户注册系统的应用程序。为了正确连接和填充我们所有的表格，我们在注册视图中使用复杂/嵌套表格。实际上，我的嵌套表单工作得很好，一切都按照它应该的方式填充，真的很棒。

这是问题所在：我需要在表单发布之后但在保存记录之前设置嵌套属性之一的值之一。

这是一个简单的示例，因此您可以更好地了解我在说什么：用户在我们的网站上注册。当他们注册时，会在用户数据表中创建一条记录。每个用户也被归类为一个 team_mate（加入表）并分配给他们自己的团队（起初）。但是，“团队”（表）中也有一个“别名”字段，在初始创建用户时，我们希望将其设置为用户的名字（无需让他们将名字输入到“表单上的别名字段）。

**所以，我想问题是：** 如何在表单发布之后和记录保存到数据库之前手动设置嵌套属性的值？

表模式的一个（简单）示例如下所示：

用户（id、first_name、last_name、created_at、updated_at）

Team_mates(id, user_id, team_id, created_at, updated_at) - 加入表

团队（id、别名、created_at、updated_at）

**楷模：**

用户.rb

```
class User < ActiveRecord::Base
  has_many :team_mates, :dependent => :destroy
  has_many :teams, :through => :team_mates, :foreign_key => :team_id
  accepts_nested_attributes_for :team_mates, :allow_destroy => true

  before_save :set_defaults

  private
    def set_defaults
      #want to set :users => :team_mates_attributes => :team_attributes => :alias to @user.first_name here

      # Would prefer to handle this here instead of in the controller.
    end
  end 
```

团队.rb

```
class Team < ActiveRecord::Base
  has_many :team_mates, :dependent => :destroy
  has_many :users, :through => :team_mates, :foreign_key => :user_id

end 
```

Team_mate.rb

```
class TeamMate < ActiveRecord::Base
  belongs_to :user
  belongs_to :team

  accepts_nested_attributes_for :team, :allow_destroy => true
end 
```

**控制器**

用户控制器.rb

```
class UsersController < ApplicationController

def new
  @user = User.new
  @user.emails.build(:is_default_email => 1)
  @user.build_login

  @user.team_mates.build.build_team(:alias => 'Clinton444', :created_at => Time.new, :updated_at => Time.new)

  respond_to do |format|
    format.html
    format.json { render :json => @match }
  end
end

def create
  @user = User.new(params[:user])

  @user.attributes = ({ "user" => { "team_mates" => { "team" => { "alias" => @user.first_name } } } }) #--this doesn't work...

  @user.attributes = ({ :user => { :team_mates => { :team => { :alias => @user.first_name } } } }) #--neither does this...

  respond_to do |format|
    if @user.save
      format.html  { redirect_to(@user, :notice => 'User was successfully created.') }
      format.json  { render :json => @user, :status => :created, :location => @user }
    else
      format.html  { render :action => "new" }
      format.json  { render :json => @user.errors, :status => :unprocessable_entity }
    end
  end
end 
```

**看法**

新的.html.haml

```
 = form_for(@user, :html => {:class => 'form-horizontal'}) do |f|
- if @user.errors.any?
  .alert
    %h2
      = pluralize(@user.errors.count, "error")
      prohibited this post from being saved:
    %ul
      - @user.errors.full_messages.each do |msg|
        %li
          = msg
%fieldset
.control-group
  = f.label :first_name, :class => "control-label"
  .controls
    =f.text_field :first_name, :class => "span8"

.control-group
  = f.label :last_name, :class => "control-label"
  .controls
    =f.text_field :last_name, :class => "span8"

= f.fields_for :emails do |e|
  =e.hidden_field :is_default_email, :class => "span8"

  .control-group
    = e.label :email, :class => "control-label"
    .controls
      =e.text_field :email, :class => "span8"

= f.fields_for :team_mates do |tm|
  = tm.fields_for :team do |t|
    =t.hidden_field :alias, :class => "span8"
    =t.hidden_field :created_at, :class => "span8"
    =t.hidden_field :updated_at, :class => "span8"

= f.fields_for :login do |e|
  .control-group
    = e.label :user_login, :class => "control-label"
    .controls
      =e.text_field :user_login, :class => "span8"

  .control-group
    = e.label :password_encrypted, :class => "control-label"
    .controls
      =e.text_field :password_encrypted, :class => "span8"

.control-group
  .controls
    =f.submit :class => 'btn btn-primary btn-medium' 
```

**最后**

表单发布上的 Rails 服务器输出

```
 Parameters: {"user"=>{"team_mates_attributes"=>{"0"=>{"team_attributes"=>{"created_at"=>"Wed Jun 06 09:52:19 -0600 2012", "alias"=>"asfs444", "updated_at"=>"Wed Jun 06 09:52:19 -0600 2012"}}}, "first_name"=>"lkjlkjlsdfslkjeowir", "last_name"=>"ouisodifuoixv", "emails_attributes"=>{"0"=>{"is_default_email"=>"1", "email"=>"lpisfsopf@psflsjdk.com"}}, "login_attributes"=>{"user_login"=>"lkjsdfooiusfd", "password_encrypted"=>"[FILTERED]"}}, "utf8"=>"✓", "commit"=>"Create User", "authenticity_token"=>"CQLQ93/0VlncSzMlmtLPHgaVrrvjuHFN+lN6CYCsiR8="} 
```

查看模型后，您可能想知道电子​​邮件/登录的来源。它们是在我们系统的模型中构建的，但实际上并不是这个问题的一部分，所以我省略了它们的代码。他们正在工作，所以问题不在那边。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:23:28.347

检查[http://archives.ryandaigle.com/articles/2009/2/1/what-s-new-in-edge-rails-nested-attributes](http://archives.ryandaigle.com/articles/2009/2/1/what-s-new-in-edge-rails-nested-attributes)

> 为了支持新对象的创建和现有对象的编辑，我们必须为一对多关联使用散列数组或为一对一关联使用单个散列。如果不存在 :id 属性，则假定它表示要创建的嵌套模型。

不是 100% 确定..我以前没有使用过\测试过，但这应该给你一个想法

```
@user.teams.each do |team| 
  team.team_mates do |team_mate|
    # To edit existing
    team_mate.team_attributes = [ { :id => team.id,  :alias => @user.first_name } ]

    # To create new
    team_mate.team_attributes = [ { :alias => @user.first_name } ]

    team_mate.save
  end 
end 
```

# php - 如何在 PHP 脚本中最好地对 MySQL 表中的数据进行排序？

> ID：10918571
> 
> 赞同：0
> 
> 时间：2012-06-06T16:49:51.440
> 
> 标签：php, mysql, sorting

我在 PHP 中有一个像这样的脚本：

```
if(isset($_GET["ord"]))
{
    switch($_GET["ord"])
    {
      case 1: $ord = "name ASC";
              break;

      case 2: $ord = "surname ASC";
              break;

      case 3: $ord = "date ASC";
              break;

      case 4: $ord = "zone ASC";
              break;

      case 5: $ord = "latency DESC";
              break;

      default: $ord = "name ASC";
               break;

    }
}
else
{
    $ord = "name ASC";
} 
```

并在这样的代码中使用它：

```
$res = mysql_query("SELECT people.name AS Name, surname, date, zone, latency FROM people WHERE online=1 ORDER BY $ord");
$content->ADD('<table class="online"><tr><th><a href="?s=online&amp;ord=1">Name</a></th><th><a href="?s=online&amp;ord=2">Surname</a></th><th><a href="?s=online&amp;ord=3">Date</a></th><th><a href="?s=online&amp;ord=4">Zone</a></th><th><a href="?s=online&amp;ord=5">Latency</a></th></tr>');
while ($resss = mysql_fetch_array($res))
{
  $content->ADD('<tr><td align="center">'.$resss["name"].'</td>');
  $content->ADD('<td>'.$resss["surname"].'</td>');
  $content->ADD('<td>'.$resss["date"].'</td>');
  $content->ADD('<td>'.$resss["zone"].'</td>');
  $content->ADD('<td>'.$resss["latency"].'</td>');
  $content->ADD('</tr>');

} 
```

它实际上工作得非常糟糕，但是当我需要更改 ASC 和 DESC 排序时我遇到了问题 - 所以我的问题是如何重写我的脚本以使其也可以在输出数据中使用 acs/desc 排序？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:02:52.773

如果你不介意的话，我只能想到 jQuery 解决方案：[jQuery DataTables 插件](http://datatables.net/)。使用它可以消除不必要地调用数据库的需要。

最基本的实现是：

```
$(document).ready(function(){
    $('#example').dataTable();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:56:51.027

假设您有一个带有名称的标题行，例如：

```
$content->ADD('<tr><td align="center">Name</td>'); 
```

您可以将其更改为：

```
$sort_order = "name ASC";
if($ord == 'name ASC') {
    $sort_order = "name DESC";
}
$content->ADD('<tr><td align="center"><a href="?ord=$sort_order">Name</a></td>'); 
```

然后，当您的脚本处理“ord”变量时，它将基于您的“名称”列标题。一旦你开始这样做，你可能想要稍微改变你的变量，使用类似“?sortby=name&sortorder=ASC”的请求变量，但是首先让上面的工作，然后你会看到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T17:08:03.780

整个开关有点不必要。执行时`ORDER BY`，您可以指定在查询中按其数字位置（顺序）对哪一列进行排序。

```
select `uid`, `name` from `test` order by `uid` asc 
```

应该给出相同的结果

```
select `uid`, `name` from `test` order by 1 asc 
```

您可以使用开关修改代码以接受`desc`/的参数`asc`，并简单地使用数字作为`order by`目标。您发布的开关的好处是不会产生奇怪的查询`order by 555`，但也可以通过其他方式解决。这只是一些让您开始编码的基本信息，但如果您需要澄清，请发表评论

# jquery - Jquery appendTo 没有像我想象的那样工作

> ID：10918574
> 
> 赞同：-1
> 
> 时间：2012-06-06T16:49:58.513
> 
> 标签：jquery, html

```
<div id="likelyToBeCalled">
    <div class="likelyOddHeader" id="Test1">
        <div class="likelyOddA">Test1</div>
        <div class="likelyOddB"><img src="image002.png"/></div>
        <div class="timeZone">West</div>

//closing tags here

<div id="unlikelyToBeCalled">
    <div class="likelyOddHeader" id="Test3">
        <div class="likelyOddA">Test3</div>
        <div class="likelyOddB"><img src="image002.png"/></div>
        <div class="timeZone">West</div>
    </div> 
```

//这里有更多结束标签

jQuery代码：

```
<script type="text/javascript">

$(document).ready(function() {
$('#Test1').click(function() {
$('#Test1').appendTo('#unlikelyToBeCalled')
)};
)};
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:53:18.820

修复你的脚本：

```
$(document).ready(function() {
     $('#Test1').click(function() {
        $('#Test1').appendTo('#unlikelyToBeCalled')
     });
}); 
```

（最后两行）

我测试了它，它按**我**想的那样工作。

使用任何浏览器开发工具（如[Chrome 控制台](https://developers.google.com/chrome-developer-tools/)），您都会看到 javascript 错误。

# ruby - 如何关闭作为参数传入的临时（匿名）文件对象？

> ID：10918578
> 
> 赞同：0
> 
> 时间：2012-06-06T16:50:20.120
> 
> 标签：ruby, file-io

有时我发现自己需要打开一个文件，读取它的内容并进行一些功能操作并将数据存储到一个变量中。这将得到以下代码行：

```
@some_vars = File.open("items.txt").read.chomp!.split(',') 
```

我在这里有两个问题：

*   File 实例是否`File.open()`在此行之后关闭？
*   如何在不牺牲可读性的情况下关闭这样的 File 实例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T16:58:39.447

不，[`File.open`](http://ruby-doc.org/core-1.9.3/File.html#method-c-open)让文件句柄保持打开状态。您应该改用[`IO.read`](http://ruby-doc.org/core-1.9.3/IO.html#method-c-read)它，它返回文件的全部内容并在完成后关闭它：

```
IO.read("items.txt").chomp!.split(',') 
```

对于单行代码来说，这比将一个块传递给`File.open`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:00:07.497

您发布的示例不会自动关闭文件描述符。您必须在描述符上手动调用 File#close，或者让 Ruby 在解释器退出时自动关闭文件。

如果要自动关闭文件，则需要[File#open 块语法](http://ruby-doc.org/core-1.9.3/File.html#method-c-open)：

```
File.open('items.txt') { |f| f.read.chomp!.split(',') } 
```

Ruby 将在块终止时关闭文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T17:09:10.133

即使使用 block in`File.open`也不能确保文件将始终关闭，例如，当应用程序挂起时。有一个技巧可以防止这种情况。

```
f = File.open('items.txt', 'w')

at_exit { f.flush; f.close } 
```

然后`at_exit`块将在应用程序结束或程序退出时执行。

# javascript - 将预加载器添加到 div 标签

> ID：10918583
> 
> 赞同：1
> 
> 时间：2012-06-06T16:50:36.900
> 
> 标签：javascript, html, ajax, preloader

我们有一个 ajax 脚本，它获取一个单词并将一些相关数据加载到一个 div 标签中。

它工作正常，但我们想将预加载器（不带 jQuery）添加到 div 标签，我们尝试[了 spin.js](http://fgnass.github.com/spin.js/)但它仅适用于整个页面，这就是我们所做的：（总结）

```
<head>
<script src="spin.min.js"></script>
</head>

<body>
 <div id="data">

 //data loads here

 </div>

<script type="text/javascript" charset="utf-8">
var opts = {
  lines: 13, // The number of lines to draw
  length: 7, // The length of each line
  width: 4, // The line thickness
  radius: 28, // The radius of the inner circle
  rotate: 0, // The rotation offset
  color: '#000', // #rgb or #rrggbb
  speed: 1, // Rounds per second
  trail: 92, // Afterglow percentage
  shadow: false, // Whether to render a shadow
  hwaccel: false, // Whether to use hardware acceleration
  className: 'spinner', // The CSS class to assign to the spinner
  zIndex: 2e9, // The z-index (defaults to 2000000000)
  top: 'auto', // Top position relative to parent in px
  left: 'auto' // Left position relative to parent in px
};
var target = document.getElementById('data');
var spinner = new Spinner(opts).spin(target);
</script>

</body> 
```

怎么了？以及任何其他（和更好的）解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:57:52.533

您`data` `div`具有全宽并将`spin.js`图像垂直和水平放置在元素的中心，这就是您在全屏上看到它的原因。

例如

```
<head>
    <script src="spin.js"></script>
</head>
<body>
    <div id="data" style="width: 100px; height: 100px; float: left;">
        <!-- Data Loads Here-->
    </div>
    <div id="NoData" style="width: 100px; height: 100px; float: left;">
        Hello Hi Bye
    </div>
    <script type="text/javascript" charset="utf-8">
        var opts = {
            lines : 13, // The number of lines to draw
            length : 7, // The length of each line
            width : 4, // The line thickness
            radius : 28, // The radius of the inner circle
            rotate : 0, // The rotation offset
            color : '#000', // #rgb or #rrggbb
            speed : 1, // Rounds per second
            trail : 92, // Afterglow percentage
            shadow : false, // Whether to render a shadow
            hwaccel : false, // Whether to use hardware acceleration
            className : 'spinner', // The CSS class to assign to the spinner
            zIndex : 2e9, // The z-index (defaults to 2000000000)
            top : 'auto', // Top position relative to parent in px
            left : 'auto' // Left position relative to parent in px
        };
        var target = document.getElementById('data');
        var spinner = new Spinner(opts).spin(target);
    </script>
</body> 
```

# php - 在 Joomla 中添加属性以选择选项

> ID：10918584
> 
> 赞同：3
> 
> 时间：2012-06-06T16:50:44.420
> 
> 标签：php, html, joomla

我正在尝试为 Joomla 2.5 的下拉列表中的某些选择选项添加额外的 HTML 属性，并且希望使用内置的 HTML 帮助程序而不是自己编写 HTML。当前输出为：

```
<select>
    <option value="Red">Red</option>
</select> 
```

但我希望它是这样的：

```
<select>
    <option value="Red" data-img="red.jpg">Red</option>
</select> 
```

这样我就可以在所选选项更改时使用 Javascript 访问 data-img 属性。

我正在创建这样的选择选项：

```
$select = JHtml::_('select.option', "Red", "Red"); 
```

然后将它们传递给 JHTML 以创建通用列表 HTML：

```
$html = JHTML::_('select.genericlist', ...); 
```

我查看了文档并尝试将各种不同的参数传递给函数，但就函数使用的所有选项（等）而言，它非常令人困惑`option.attr`，`attr`而且谷歌也没有发现任何东西。

谁能告诉我需要传递给函数的额外参数才能正确地将额外属性添加到`<option>`元素中？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T18:15:26.947

今天我在这个确切的场景中苦苦挣扎，需要使用选择的选项添加一些额外的数据。在对 joomla/libraries/joomla/html/html/select.php 文件进行彻底分析后，我成功地做到了这一点，但有一些缺点......

首先，在我的例子中，用于选择的数据来自数据库，需要为这种情况做一些准备：

```
$db =& JFactory::getDBO();
$sql = 'SELECT  nom AS value , nom AS text, prix FROM #__reservation_nourritures order by `ordering` asc';
$db->setQuery($sql);
$nourritures = $db->loadObjectList();
foreach ($nourritures as $nourriture){
    //the data to use MUST be in an array form for the extra html attributes...
    $nourriture->data = array('data'=>$nourriture->prix);
} 
```

数据准备好后，您可以将其传递给 JHTML 函数来构建 select ：

```
echo JHTML::_('select.genericlist',$nourriture,'myId',array('class'=>'nourritures','option.attr'=>'data')); 
```

简而言之，必须使用“option.attr”将属性插入到选项中。注意：select.genericlist 函数**必须**只有 3 个参数才能工作。根据我对函数的理解，如果您将恰好 3 个参数传递给函数，属性只会合并到选项中，否则它只会忽略它。因此，例如，如果您想使用附加参数定义预选选项，那么您就不走运了。这是函数中有关此的部分：

```
if (is_array($attribs) && func_num_args() == 3)
{
    // Assume we have an options array
    $options = array_merge($options, $attribs);
} 
```

据我了解，这是一个错误和/或不良行为。当我有时间时，我会在 joomla 跟踪器中填写一个错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-12-03T19:51:56.480

你可以做这样的事情

```
$option = JHtml::_('select.option', "Red", "Red", array('option.attr' => 'optionattr', 'attr' => array('data-img' => "red.jpg"))); 
```

或者像这样

```
$option = JHtml::_('select.option', "Red", "Red");

$option->optionattr = array(
    'data-img' => "red.jpg"
); 
```

# java - 在谷歌地图中转换纬度和经度？

> ID：10918587
> 
> 赞同：0
> 
> 时间：2012-06-06T16:50:55.300
> 
> 标签：java, android, android-emulator

我正在创建一个应用程序，通过单击 android mobile 上的按钮，我可以跟踪 gps 跟踪器设备。响应按钮单击包含 sim 卡响应的 gps 设备及其纬度和经度以及设备的速度。设备发送的消息在我手机的收件箱中收到。我想将该纬度和经度转换为谷歌地图或至少以某种地址形式。有人可以建议我一个正确的方法或给我一些提示我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T16:57:20.273

我认为有两种方法可能对您有用。

1.  使用您已经拥有的 GPS 坐标并打开地图意图并将 ap 以经纬度为中心。

2.  使用一些第三方 api，它将为您提供附近的纬度和经度地址，并以您想要的方式使用它。

注意：这两个都需要互联网许可。第一个还需要您拥有 maps api 密钥，但这是这两者中最简单的解决方案，但两者都应该相对容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:08:51.837

使用以下代码获取当前位置坐标和城市名称

* * *

```
private class myLocationListener implements LocationListener{

        @Override
        public void onLocationChanged(Location location) {          
            if(location!=null){             
                locManager.removeUpdates(locListener);
                String longitude = "Longitude: " +location.getLongitude();
                String latitude = "Latitude: " +location.getLatitude();
                String altitiude = "Altitiude: " + location.getAltitude();          
                String cityName;

                Geocoder gcd = new Geocoder(getBaseContext(), Locale.getDefault());
                public List<Address> addresses= gcd.getFromLocation (double latitude1, double longitude1, int maxResults)   

                List<Address> addresses;
                try {
                    addresses = gcd.getFromLocation(location.getLatitude(), location.getLongitude(), 1);
                    if (addresses.size() > 0)
                        System.out.println(addresses.get(0).getLocality());
                    cityName=addresses.get(0).getLocality();
                } catch (IOException e) {                   
                    e.printStackTrace();
                }
                showLocation.setText("City Name: "+cityName+"+ "\n"+longitude + "\n" + latitude + "\n" + altitiude);
                progress.setVisibility(View.GONE);
            }
        } 
```

* * *

然后您可以使用此代码使用城市名称或位置值获取 gmap

* * *

```
public void getMap(String location) {
        map_location = "geo:0,0?q=" + location;
        Uri geoUri = Uri.parse(map_location);
        Intent mapCall = new Intent(Intent.ACTION_VIEW, geoUri);            
    } 
```

* * *

甚至你可以检查[这个](http://rdcworld-android.blogspot.in/2012/01/get-current-location-coordinates-city.html)例子以获得一点帮助

让我知道你是否还有麻烦

# javascript - 如何使用 jQuery 使多个 div 出现

> ID：10918589
> 
> 赞同：0
> 
> 时间：2012-06-06T16:51:08.840
> 
> 标签：javascript, jquery

我觉得我非常接近完成这个。我有一个带有“添加子项”按钮的表单，按下该按钮会显示一个 div。该表单隐藏了 15 个 div (#child1 - #child15)。我让它只显示第一行（#child1）。

我的问题是，当再次按下按钮时，下一行（#child2、#child3 等）应该会出现，我不知道如何让它显示。我尝试放入柜台，但我是 jQuery 新手，任何帮助将不胜感激。我不认为这是一个困难的问题，只是一个正在逃避我的新手能力的问题。

这是jQuery。如果我需要编辑或添加更多代码来帮助解决问题，请告诉我。提前致谢！

```
<script type="text/javascript">
var counter=0

$(document).ready(function() {
    $('#addChildren').click(function() {
        $('#child1').show(function() {
        counter++
        });
      });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T16:55:58.523

`children-to-show`向您的 div添加一个类`#child1 - #child15`并编写

```
<script type="text/javascript">
$(document).ready(function() {
    $('#addChildren').click(function() {
        $('.children-to-show:hidden').first().show();
    });
</script> 
```

这样您就不需要计数器并且 div id 不必连续，因此您有更多方法来配置您的 div id。

**解释**

每次点击`addChildren`，都会显示下一个带有类的隐藏元素`children-to-show`。

**编辑**

gdoron 是对的，所以如果你想让它与类一起工作：

```
<script type="text/javascript">
$(document).ready(function() {
    $('#addChildren').click(function() {
        $('.children-to-show').not('.is-visible').first().show().addClass('is-visible');
    });
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T16:55:14.327

如果`<div>`s 的顺序为 1,2,3,4...15：

```
$('#addChildren').click(function() {        
        $('div[id^="child"]').eq(counter).show();
        counter++;
}); 
```

如果它们不按顺序排列：

```
$('#addChildren').click(function() {        
        $('#child' + (++counter)).show();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T16:54:49.053

如果您知道确切的 div 数量，则可以使用 for 循环

```
$(document).ready(function() {
    $('#addChildren').click(function() {

for (i=1; i<=15; i++)
  {
  $('#child'+i).show();
  }

   });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T16:55:14.347

这应该为你做

```
<script type="text/javascript">
var counter=1

$(document).ready(function() {
    $('#addChildren').click(function() {
        $('#child' + counter).show(function() {
        counter++
        });
      });
    });
</script> 
```

您也可以添加一个条件来检查 15 的限制。就像是 ..

```
 <script type="text/javascript">
        var counter=1

        $(document).ready(function() {
            $('#addChildren').click(function() {
                if(counter <= 15) {
$('#child' + counter).show(function() {
                counter++
                });
}
              });
            });
        </script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-06T16:55:33.437

您可以将 counter 变量连接到 jQuery 选择器中：

```
<script type="text/javascript">
var counter=0

$(document).ready(function() {
    $('#addChildren').click(function() {
        $('#child' + counter).show(function() {
        counter++
        });
      });
    });
</script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-06T16:55:38.200

您需要使显示变量的 div 像这样，随着值的更新`$('#child' + counter)`，它将显示不同的 div 。`counter`

```
var counter=1

$(document).ready(function() {
    $('#addChildren').click(function() {
        $('#child' + counter).show(function() {
            counter++
        });
    });
}); 
```

我整理了这个[演示](http://jsfiddle.net/mbQNp/)来向您展示。

# php - 我什么时候应该在 require/include 语句中使用括号？

> ID：10918598
> 
> 赞同：6
> 
> 时间：2012-06-06T16:52:01.300
> 
> 标签：php, joomla

我收到了一堆代码，其中包含很多`require`/`include`语句（混合在`require`和之间`require_once`）。有时，路径周围有括号，即`require_once (JPATH_COMPONENT.DS.'controller.php');`，而其他时候没有：`require_once $path;`。

include 的 php 文档[提到了这一点](http://www.php.net/manual/en/function.include.php)，但并不具体。我应该在找到它们时删除括号，还是可以不理会它们？在编写进一步的 require/include 语句时，是否存在我应该使用它们的特定情况？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-06T17:01:34.193

您可以在“include/require”中使用括号，不是因为 include 允许它本身，而是因为您可以在 PHP 中的任何字符串或数字周围使用括号进行分组。

例如，`"dog"`等价于`("dog")`，`("dog")."dog"`等价于`"dog"."dog"`等。

当您使用涉及计算和字符串连接的复杂表达式时，括号会变得很有用，但在这种简单的情况下，它们只是被允许使用并且对单个字符串值执行不必要且无害的“分组”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:01:18.137

离开或取出它们没有问题，归根结底，这取决于开发人员的舒适度。

就个人而言，我将它们关闭。我认为它看起来更干净一些，并且 IDE 语法着色效果更好一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T16:56:29.957

两种语法都有效。所以，这取决于你。:)
文档说明：

> 因为 include 是一种特殊的语言结构，所以它的参数不需要括号。

# java - Primefaces：“空转换器”的转换错误设置值“管理员”

> ID：10918604
> 
> 赞同：1
> 
> 时间：2012-06-06T16:52:30.980
> 
> 标签：java, jsf, primefaces

我在这段代码中遇到错误，我被困在这一点上。请帮我。

selectedRole 的 getter 和 setter，allRolesList 包含在代码中

**爪哇代码**

```
private String selectedRole;

List<String> allRolesList = new ArrayList<String>();

    if(!roleList.isEmpty()){
        isRolesPresent = true;
        for(UserRole ur : roleList){
            allRolesList.add(ur.getRoleName().toString());

/* printing allRolesList results: [admin] */

System.out.print("allRolesList "+allRolesList);

        }
    }else{
        isRolesPresent = false;
    } 
```

**素面代码：**

```
 <p:selectOneMenu id="role" value="#{usersDAO.selectedUser}" effect="fade" required="true" 
                     requiredMessage="Role cannot be null">  
            <f:selectItems value="#{usersDAO.allRolesList}" />
        </p:selectOneMenu> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T16:57:28.253

`#{usersDAO.selectedUser}`显然不是`String`type 。JSF 不知道如何转换`String`为`User`，因为没有为`User`类型注册转换器，因此您收到了错误消息。

您通常需要为此创建一个自定义`Converter`，如[本答案](https://stackoverflow.com/questions/10601710/primefaces-selectonemenu-listener-not-called-with-objects-other-than-strings/10601865#10601865)中所述，但根据给定的 Java 代码，您*实际上*需要`#{usersDAO.selectedRole}`的是已经是`String`类型的。因此，您无需创建自定义`Converter`.

```
<p:selectOneMenu ... value="#{usersDAO.selectedRole}"> 
```

* * *

顺便说一句，名称中带有“DAO”的托管 bean 很奇怪。您确定您没有在一个类中混合概念或将不同的职责紧密耦合（这会导致较差的可重用性/可维护性）？

# sql - 从不同数据库导入的语法 - MS Access

> ID：10918605
> 
> 赞同：1
> 
> 时间：2012-06-06T16:52:32.063
> 
> 标签：sql, ms-access, import, insert, multiple-databases

我正在尝试（基本上）从一个后端到另一个后端的自动行复制，因为后端正在使用但尚未完全开发（有些表已完成，有些则没有；最后将完成的数据添加到更高级的数据库中当天）。

我想知道 SQL 语句的语法是什么：

```
INSERT INTO tblMyBetterTable * IN "C:\\path_to_db\db.accdb"
FROM tblMyTable IN "C:\\path_to_in_use_db\in-use-db.accdb" 
```

语法不正确，但我已经搜索了一段时间，无法找到如何.. 我已经看到如何从一个表导入到另一个表等，但不是跨后端。如果不清楚，我想基本上将所有行的表复制`in-use-db.accdb`到`tblMyTable`backend`db.accdb`的 table的最新版本`tblMyBetterTable`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:06:03.520

我建议你试试[DoCmd.TransferDatabase](http://msdn.microsoft.com/en-us/library/bb214131%28v=office.12%29.aspx)

对于查询，您需要以下内容：

```
SELECT * INTO NewTable 
FROM [;DATABASE=Z:\Docs\Test.accdb].Table1 
```

或者反过来：

```
SELECT * INTO [;DATABASE=Z:\Docs\Test.accdb].NewTable
FROM Table1 
```

要插入现有表：

```
INSERT INTO table1 
SELECT * 
FROM [;DATABASE=Z:\Docs\Test.accdb].Table1 
```

# version-control - 如何防止 Mercurial 补丁被拉取？

> ID：10918607
> 
> 赞同：4
> 
> 时间：2012-06-06T16:52:38.773
> 
> 标签：version-control, mercurial, dvcs, patch, mercurial-queue

到目前为止，我还没有找到明确的答案，尽管答案可能是“改变你的工作流程”。

我刚刚开始使用 Mercurial 的补丁队列，我可以看到其中的强大功能。看起来非常棒。在我的测试中，我发现如果你有一个补丁队列`repo1`，并且你从 中拉取`repo2`，你可以做一些坏事。例如：

1.  创建 repos 1，然后克隆它。
2.  启用队列`repo1`
3.  进行一些提交和一些补丁`repo1`
4.  将更改拉到`repo2`
5.  在`repo1`取消应用（流行？）你所有的补丁
6.  将更改拉到`repo2`

现在您将看到两个不同的分支 - 从某个角度来看这是有道理的。但是，由于我的补丁不是`repo1`'s 历史的一部分（至少在它们被应用之前），似乎应该有一种方法告诉 mercurial 我的补丁是禁止使用的，并且只提供“官方历史”。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T17:58:46.500

Mercurial[阶段](https://www.mercurial-scm.org/repo/hg/help/phases)可能是这个问题的答案。

从 Mercurial v2.1 开始，您可以将`mq`变更集配置为自动标记为`secret`. 和命令`secret`忽略变更集。`incoming/pull``outgoing/push`

要启用此行为，您需要将以下内容添加到您的配置中：

```
[mq]
secret = True 
```

启用后，它的行为如下：

```
$ hg qpush --all
applying my-patch
now at: my-patch

$ hg phase -r .
16873: secret

$hg outgoing
comparing with https://www.mercurial-scm.org/repo/hg
searching for changes
no changes found (ignored 1 secret changesets) 
```

# ruby-on-rails - FactoryGirl step_definitions 包含导致错误

> ID：10918608
> 
> 赞同：-1
> 
> 时间：2012-06-06T16:52:39.290
> 
> 标签：ruby-on-rails, cucumber, factory-bot

我成功地使用了 FactoryGirl，但我刚刚尝试要求 factory_girl/step_definitions 文件，并得到如下所示的回溯。

如果我删除 factory_girl/step_definitions 的要求，错误就会消失。

要求是在 spark prefork 块中的 features/support/env.rb 中完成的（尽管我目前没有在 spork 活动的情况下运行这些测试）。

使用 Ruby 1.9.2。

有人见过这个错误吗？有什么想法吗？

我的宝石的相关部分

```
capybara (1.1.2)
ci_reporter (1.7.0)
factory_girl_rails (3.2.0, 3.0.0)
rails (3.1.0)
rspec (2.9.0)
rspec-core (2.9.0)
rspec-expectations (2.9.1)
rspec-mocks (2.9.0)
rspec-rails (2.9.0)
cucumber-rails (1.3.0) 
```

功能/支持/env.rb 详细信息：

```
require 'rubygems'
require 'spork'
#uncomment the following line to use spork with the debugger
#require 'spork/ext/ruby-debug'

Spork.prefork do

  require 'cucumber/rails'
  require 'factory_girl'
  require 'factory_girl/step_definitions'

  Capybara.default_selector = :xpath

  ActionController::Base.allow_rescue = false

  begin
    DatabaseCleaner.strategy = :truncation
  rescue NameError
    raise "You need to add database_cleaner to your Gemfile (in the :test group) if you wish to use it."
  end

  Cucumber::Rails::Database.javascript_strategy = :truncation

end

Spork.each_run do
  # This code will be run each time you run your specs.
  FactoryGirl.reload
end 
```

回溯详细信息：

```
Testing started at 11:07 AM ...
Using the default and skip_broken profiles...
uninitialized constant TestItemSetting (NameError)
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/activesupport-3.1.0/lib/active_support/inflector/methods.rb:124:in `block in constantize'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/activesupport-3.1.0/lib/active_support/inflector/methods.rb:123:in `each'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/activesupport-3.1.0/lib/active_support/inflector/methods.rb:123:in `constantize'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/activesupport-3.1.0/lib/active_support/core_ext/string/inflections.rb:43:in `constantize'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/factory_girl-3.2.0/lib/factory_girl/factory.rb:25:in `build_class'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/factory_girl-3.2.0/lib/factory_girl/step_definitions.rb:100:in `block (2 levels) in <top (required)>'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/factory_girl-3.2.0/lib/factory_girl/step_definitions.rb:99:in `each'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/factory_girl-3.2.0/lib/factory_girl/step_definitions.rb:99:in `block in <top (required)>'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/factory_girl-3.2.0/lib/factory_girl/registry.rb:17:in `each'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/factory_girl-3.2.0/lib/factory_girl/registry.rb:17:in `each'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/factory_girl-3.2.0/lib/factory_girl/disallows_duplicates_registry.rb:7:in `each'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/factory_girl-3.2.0/lib/factory_girl/step_definitions.rb:97:in `<top (required)>'
/Users/wwilliam/Development/projectset/projectset/features/support/env.rb:20:in `block in <top (required)>'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/spork-1.0.0rc3/lib/spork.rb:24:in `prefork'
/Users/wwilliam/Development/projectset/projectset/features/support/env.rb:6:in `<top (required)>'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/lib/cucumber/rb_support/rb_language.rb:129:in `load'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/lib/cucumber/rb_support/rb_language.rb:129:in `load_code_file'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:171:in `load_file'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:83:in `block in load_files!'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:82:in `each'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:82:in `load_files!'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/lib/cucumber/runtime.rb:175:in `load_step_definitions'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/lib/cucumber/runtime.rb:40:in `run!'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/lib/cucumber/cli/main.rb:43:in `execute!'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/lib/cucumber/cli/main.rb:20:in `execute'
/Users/wwilliam/.rvm/gems/ruby-1.9.2-head@projectset/gems/cucumber-1.1.9/bin/cucumber:14:in `<top (required)>'
/Users/wwilliam/Development/projectset/projectset/script/cucumber:9:in `load'
/Users/wwilliam/Development/projectset/projectset/script/cucumber:9:in `<top (required)>'
-e:1:in `load'
-e:1:in `<main>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T19:27:50.600

正如评论中所讨论的，它之所以抱怨是因为工厂 test_item 设置的运行时定义存在问题。很高兴你明白了:)

# checkbox - php：用于发送带有复选框的电子邮件的正确逻辑

> ID：10918611
> 
> 赞同：1
> 
> 时间：2012-06-06T16:52:51.473
> 
> 标签：checkbox, php

我的网站上有一个简单的联系表格，可以根据用户填写的复选框向不同的电子邮件地址（不同的实体办公室和电子邮件帐户）发送电子邮件。

有两个复选框，一个 NMB 和一个 MB 用于值。

这是我想要做的： 如果选中一个复选框（NMB），发送电子邮件到 addy1 如果选中一个复选框（MB），发送到电子邮件 addy2 如果选中两个复选框（NMB 和 MB），发送电子邮件到两个

所以，到目前为止，我有这个，但我怀疑它不会工作，或者会发送多封电子邮件......

```
 $office  = $_POST['office'];

    if  ($office == "NMB" ){
        $address = "adyy1@narf.com";
    }
    elseif  ($office == "MB" ){
        $address = "adyy2@narf.com";
    }
    elseif  ($office == "NMB"  && $office == "MB" ){
        $address = "addy1@narf.com,addy2@narf.com";
    } 
```

我觉得我很接近，但没有雪茄。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:56:17.137

这应该可以，但我不确定您的复选框的名称是什么。您可以将`cb1`和替换`cb2`为相应的复选框名称。

```
if  ($_POST['cb1'] == "NMB"  && $_POST['cb2']=='MB'){
    $address = "addy1@narf.com,addy2@narf.com";
}else if($_POST['cb1']=="NMB"){
    $address = "adyy1@narf.com";
}else if($_POST['cb2'] == "MB" ){
    $address = "adyy2@narf.com";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:59:08.417

您的复选框值将是您的 value 属性设置的任何值，以及数组键，即您的 name 属性的值。

如果你设置 $office = $_POST['checkbox']，如果你的值是 'NMB' 和 'MB'，你就完成了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T17:24:45.880

我会有这样的 HTML：

```
<form method=POST>
    <input type="checkbox" name="cb_NMB" id="cb_NMB" value=1 /><label for="cb_NMB">NMB</label>
    <input type="checkbox" name="cb_MB" id="cb_MB" value=1 /><label for="cb_MB">MB</label>
</form> 
```

然后是 PHP：

```
$addr = array();
if(isset($_POST['cb_NMB']))
    $addr[] = 'adyy1@narf.com';
if(isset($_POST['cb_MB']))
    $addr[] = 'adyy2@narf.com';

$message = '<b>Form Submitted</b><br />The form was submitted.';
foreach($addr as $a)
    mail($a,'Form Submission Notice',$message,"Content-type: text/html\r\n"); 
```

我使用 isset 是因为如果未选中该框，则不会设置 $_POST['cb_NMB'] 并且 PHP 会抛出警告。

# html - CSS 让 fb like 和 twitter 在一行中共享

> ID：10918614
> 
> 赞同：0
> 
> 时间：2012-06-06T16:53:03.207
> 
> 标签：html, css

```
<div style="float: left"; class="fb-like" data-send="false" data-layout="button_count" data-width="450" data-show-faces="true"></div>

<a style="float: right"; href="https://twitter.com/share" class="twitter-share-button" data-url="" data-lang="ko">트윗하기</a>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> 
```

是我的代码，

这是一个类似 fb 的按钮和 twitter 分享图标/按钮。我希望它们彼此相邻，但它们总是在每一行上。

我该如何解决这个问题？就像两者都有一个`display: block;`默认值

正如您在上面的代码中看到的，我尝试了 float: left 和 float: right，但没有任何成功

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:00:08.807

减小 iframe 的宽度。FB 是 450 像素，推特是 139 像素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:24:45.680

将 Twitter IFrame 放入 div 容器中。浮动 div 容器并将 Twitter IFrame 的宽度减小到大约 70px 左右。我在 Firebug 的网站上测试了这 2 个更改，它似乎工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:57:45.430

DIV 是块级元素，Anchor (A) 是内联元素。您可以设置`A`为块级 ( `display: block`) 或将 Anchor 包装在另一个 DIV 中并浮动容器 DIV。

希望有帮助。

# ruby-on-rails - Ruby on Rails：如何使用 ActiveRecord 对具有两个外键引用的表进行查询

> ID：10918615
> 
> 赞同：4
> 
> 时间：2012-06-06T16:53:05.717
> 
> 标签：ruby-on-rails, activerecord

我有三个模型：客户、银行和帐户。每个客户可以有多个账户，银行也是如此。

```
class Customer < ActiveRecord::Base
has_many :Accounts

class Bank < ActiveRecord::Base
has_many :Accounts

Account < ActiveRecord::Base
belongs_to :Customer, :foreign_key => 'customerID'
belongs_to :Bank, :foreign_key => 'bankID' 
```

如果我想找到客户 Jack 的所有帐户，我可以这样做

```
Customer.find_by_name('jack').Accounts 
```

如果我想找到花旗银行的所有账户，那么我可以像这样查询

```
Bank.find_by_name('Citi').Accounts 
```

我的问题是如何使用 ActiveRecord 找到属于 Citi 银行的 Customer Jack 的帐户？有一些方法可以显式生成 SQL 语句，但我想知道如何以通用方式对具有相同关系的其他模型进行类似查询。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T18:14:17.727

```
accounts = Account.joins(:bank, :customer)
                  .where( banks: { name: "Citi" }, customers: { name: "Jack" } ) 
```

我想我有复数银行/银行，客户/客户正确的方式。如果它第一次不起作用，请在控制台中尝试 - 分阶段构建它，首先连接，然后是 where 位。

这样做的好处是只有一个 SQL 调用。

rails 查询指南非常有用 - [http://guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:05:29.370

```
bank = Bank.find_by_name('City')
accounts = Customer.find_by_name('jack').accounts.where(:bank_id => bank.id) 
```

# scala - Scalas manifest.erasure 可以正确输入吗？

> ID：10918619
> 
> 赞同：2
> 
> 时间：2012-06-06T16:53:15.837
> 
> 标签：scala, type-erasure

我有一个 Java 类，它接受一个泛型类型参数和一个与该类型相关的类对象：

```
public class Foo<T> {
    public Foo(Class<? extends T> type) {
    ...
    }
} 
```

起初我以为我可以在 Scala 中为它做一个聪明的包装器：

```
class Bar[T](implicit m: Manifest[T]) {
    ...
    new Foo[T](m.erasure)
    ...
} 
```

但这会导致与此类似的编译器错误：

```
error: type mismatch;
found   : java.lang.Class[_$1(in value <local Bar>)] where type _$1(in value <local Bar>)
required: java.lang.Class[_ <: T] 
class Bar[T](implicit m: Manifest[T]) { new Foo[T](m.erasure) } 
```

我想我理解为什么会发生这种情况，但是有什么办法可以得到正确的类类型并使这段代码编译？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:06:33.467

怎么样`m.erasure.asInstanceOf[Class[T]]`？

顺便说一句，请参阅[此问题](https://stackoverflow.com/questions/10920820/creating-a-classt-from-a-manifestt-without-casting)以了解为什么`erasure`返回`Class[_]`而不是返回`Class[T]`。

# java - Hibernate Annotations Java Map

> ID：10918621
> 
> 赞同：2
> 
> 时间：2012-06-06T16:53:21.820
> 
> 标签：java, hibernate, map, annotations

我需要一些有关休眠注释的帮助。

我有以下 2 个实体：

```
public class Custom {
 private Map<KeyObject, ValueObject> properties;

 @oneToMany(mappedBy = "customId", cascade = CascadeType.All)
 @MapKey(name = "keyObject")
 public Map<KeyObject, ValueObject> getProperties();

.....
}

public class ValueObject {
 private KeyObject keyObject;
 private Long customId;
 private String value;

...getters and setters
} 
```

我有一个简单的 dao 类来保存、更新、选择和删除记录。

如果我从 Custom 对象中的地图中删除一条记录，然后调用 customDao.save(custom) 我的更改永远不会保存到数据库中。它也没有抛出任何错误。

我在休眠示例中看到我可以将 customId 定义为自定义对象，而不是 KeyValue 表中的 Long，但我不想这样做。

我是否错误地设置了我的实体？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T17:02:14.337

当一个关联具有该`mappedBy`属性时，意味着：我不是这个关联的所有者。对关联这一端所做的任何更改对 Hibernate 都无关紧要。重要的是协会的另一面。

我很惊讶这甚至可以工作，因为我本来希望 Hibernate 在另一边需要一个 ManyToOne 类型的`Custom`. 但是可以确定的是，如果在 KeyValue/ValueObject 中没有将 custom/customId 字段设置为 null，Hibernate 不会将此列设置为 null。

# javascript - 使用 HTML 和 JavaScript 发送电子邮件

> ID：10918624
> 
> 赞同：0
> 
> 时间：2012-06-06T16:53:27.713
> 
> 标签：javascript, html

我正在尝试创建网页，用户可以在其中输入其详细信息，例如名字、姓氏、地址和电话号码。一旦他们输入了详细信息并单击发送按钮，它应该将电子邮件发送到我的电子邮件地址，并且它应该重定向到另一个页面。

我可以使用 mailto:email@gmail.com 发送电子邮件，但它会打开带有用户详细信息的 Outlook，然后他们需要单击发送按钮来发送电子邮件。我不希望 Outlook 打开，当他们单击表单上的发送按钮时，它应该直接发送电子邮件。

我正在使用 JavaScript 进行验证，并使用基本的 HTML 标记来创建表单。谁能帮助我如何使用 HTML/JavaScript 直接发送电子邮件？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:58:18.493

不，仅使用 JavaScript 和 HTML 发送电子邮件是不可能的，您需要一些服务器端代码才能使用邮件协议自动发送电子邮件。如果您有 Web 服务器设置，则可以使用 PHP 等服务器端语言创建脚本来发送数据，请参阅[http://php.net/manual/en/function.mail.php](http://php.net/manual/en/function.mail.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:01:49.157

正如其他人所说，您不能从客户端发送电子邮件。但是，如果您受到同源策略的限制，您可以使用 JavaScript 通过 XMLHttpRequest 或 jsonp 调用服务器端脚本。

如果您是服务器端脚本的新手，我建议您查看 PHP 及其[`mail()`](http://php.net/manual/en/function.mail.php)功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:55:57.613

没有使用客户端代码发送电子邮件的可靠方法。

您需要将数据提交到服务器并使用服务器端程序对其进行处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:56:04.173

您不能直接从客户端 HTML/JS 发送电子邮件。您需要在服务器上执行此操作。

# ruby-on-rails - 如何将 link_to 内部资源放入带有 rails 2.3.x 的模型中

> ID：10918625
> 
> 赞同：1
> 
> 时间：2012-06-06T16:53:28.057
> 
> 标签：ruby-on-rails, ruby

我需要在 DataTables 报告中包含内部链接。因此我必须从 Model#as_json 返回报告数据，例如：

```
class Error < ActiveRecord::Base

  include ActionView::Helpers::UrlHelper # provides link_to
  include ActionController::UrlWriter # provides *_path

  def as_json(options={})
  {
    :date => self.created_at,
    :level => self.level,
    :ip => self.ip,
    :title => truncate(self.title, :length => 100),
    :show => link_to('Show', error_path(self)),
    :hide => self.handled ? "" : "#{link_to 'Hide', handle_error_path(self)}"
  }
end

... 
```

弄清楚我需要包括什么是多么努力。但现在我收到错误：“无法将字符串转换为哈希”

这是因为 'link_to' 使用了 'url_for'，这是 UrlHelper 和 UrlWriter 都拥有的一种方法，但实际上行为不同。

所以我束手无策。如果有人可以帮助我弄清楚如何做到这一点，或者告诉我如何在不破坏 MVC 的情况下满足要求，我将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:37:01.743

我将用最好的解决方案来跟进我自己的问题：使用 json_builder gem 并将您的 json 保留在它所属的视图中:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:32:37.340

尝试手动创建链接：

```
:hide => self.handled ? "" : "<a href='/handle_error?params=something'>Hide</a>" 
```

# c# - ASP.NET 启动性能分析网络

> ID：10918631
> 
> 赞同：6
> 
> 时间：2012-06-06T16:54:02.847
> 
> 标签：c#, asp.net, performance, iis

我正在尝试确定 ASP.NET 应用程序初始启动时间很长（恕我直言）的原因。

该应用程序使用各种第三方库，并且我确信可以合并许多引用，但是，我正在尝试识别（并分配责任）dll 以及它们对扩展启动过程的贡献。

到目前为止，启动时间从 2-5 分钟不等，具体取决于盒子上其他东西的使用情况。基于站点的复杂性，我认为这是不可接受的，我需要将其减少到最多 30 秒的范围内。

为了明确我正在寻找的性能范围，这是从第一个请求到初始 Application_Start 方法被命中的时间。

那么我从哪里开始获取有关加载哪些 DLL 以及加载它们需要多长时间的信息，以便我可以尝试将我们需要解决/整合的成本/收益放在一起。

从能力的角度来看，我使用 JetBrains dotTrace 已经有一段时间了，我很清楚一旦我们进入应用程序后如何对应用程序进行基准测试，但它似乎在应用程序代码之外，因此在什么之外我目前知道。

我正在寻找的是关于如何在我的代码的第一个入口点之前了解正在发生的事情的方法。

*注意：我知道我可以在回收/升级时调用默认页面来进行初始加载，但我宁愿解决实际问题，也不愿在上面糊涂。*

*注意2：硬件在功能方面已经足够扩展和分离，因此我很确定这不是问题。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T20:20:21.587

关于分析/调试启动代码的单独答案：

w3wp 只是一个运行.Net 代码的进程。因此，您可以使用所有用于普通 .Net 应用程序的分析和调试工具。

一个棘手的问题是 w3wp 进程会在第一次向应用程序发出请求时自动启动，如果您的工具不支持在启动时附加到进程，那么调查应用程序的启动代码就会有问题。

解决它的技巧是将另一个应用程序添加到同一个应用程序池中。这样，您可以通过导航到另一个应用程序来触发 w3wp 创建，而不是针对已经运行的进程附加/配置您的工具。当您最终触发您的原始应用程序工具时，将看到现有 w3wp 进程中发生加载。

延迟 2-5 分钟，您甚至可能不需要分析器 - 只需按照上面建议的方式附加 Visual Studio 调试器，并在加载站点期间随机触发“全部中断”几次。代码的最慢部分很有可能位于许多线程之一的堆栈上。还要注意调试输出 - 可能会给你一些线索是怎么回事。

您也可以使用 WinDbg 以类似的方式捕获所有线程的堆栈（可能比 VS 更轻松）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T17:00:13.627

您的 DLL 引用是根据需要加载的，而不是一次全部加载。

[外部引用会减慢我的 ASP.NET 应用程序的速度吗？（VS：添加参考对话框）](https://stackoverflow.com/questions/3424375/do-external-references-slow-down-my-asp-net-application-vs-add-reference-dial)

如果启动需要 2-5 分钟，我会看看 Application_Start 中发生了什么，以及加载后 DLL 会做什么。他们是否试图连接到非常慢的远程服务？机器对于它正在做的事情是否太小了（例如，运行具有大量数据的数据库以及 AWS 微实例或类似实例上的 Web 服务器）？

由于加载时间可能不是 IIS 工作进程解析引用，所以我会求助于传统的应用程序分析器（例如 Jetbrains、Antz、dotTrace）来查看在 DLL 初始化时以及在 Application_Start 方法中花费的时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T17:22:03.553

娱乐选项与分析一起检查：

*   分析所有内容，为所有内容添加时间跟踪并记录信息
*   如果您有许多 ASPX 视图需要在启动时编译（我认为这是发布配置的默认设置），则需要一些时间
*   如果尚不存在对 Web 服务或其他 XML 序列化相关代码的引用，则需要编译序列化程序集
*   访问远程服务（包括本地 SQL）也可能需要启动服务
*   应用程序/远程服务中的积极缓存可能需要每个缓存群

生产：

*   启动时间的目标是什么？先弄清楚它，否则你将无法达到它。
*   你愿意为减少启动时间付出多少代价。与花费数月的开发/测试时间和延迟产品相比，增加 1-10 台服务器可能更便宜。
*   考虑多台服务器，通过热身呼叫滚动重启，网络花园
*   如果数据库对象的缓存或一般来说是一个问题，请考虑现有的分布式内存缓存......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T16:58:00.890

尽管有大量的 dll，但我几乎可以肯定，对于一个合理的应用程序，它不会成为问题的原因。大多数时候是静态对象初始化导致启动缓慢。

在 C# 中，静态变量在第一次访问类型时被初始化。我建议使用 sql profiler 并查看在应用程序启动期间执行的查询是什么，然后从那里查看初始化成本高昂的对象是什么。

# annotations - SandCastle 和数据注释

> ID：10918647
> 
> 赞同：4
> 
> 时间：2012-06-06T16:55:15.313
> 
> 标签：annotations, data-annotations, sandcastle

有谁知道是否有办法让 SandCastle 从 POCO 属性上的实体框架中获取数据注释？

# oop - PowerShell：如何使用方法和参数

> ID：10918649
> 
> 赞同：1
> 
> 时间：2012-06-06T16:55:21.903
> 
> 标签：oop, shell, powershell, command-line

# 关于方法的语法：

我听说过参数声明的两种语法。我将第一个用于`MulT`，另一个用于`MulV`：

```
$MathObject = (New-Module {
    function MulT([int]$Factor1, [int]$Factor2) {
        $Factor1 * $Factor2
    }

    function MulV{
        param(
            [int]$Factor1,
            [int]$Factor2
        )
        return $a * $b
    }
} -AsCustomObject) 
```

`MulT`的语法和的语法有什么区别`MulV`？我应该使用哪个？

# 命名参数：

Cmdlet 可以有命名参数：

```
Multiply-IntegerFactors -Factor1 5 -Factor2 8 
```

对象的方法也可以有命名参数吗？我正在考虑类似的事情：

```
$MathObject.MulT(-Factor1 5, -Factor2 8) 
```

***编辑：***您认为使用**哈希表作为参数**以便在那里存储命名参数`$MathObject.MulT(@{Faktor1=5, Faktor2=8})`- 或者有更好的解决方案吗？

# 方法约定：

`Verb-CamelCaseNoun`Cmdlet ( ) 和模块 ( )有严格的命名约定`CamelCaseModuleName`。方法上也有任何（命名）约定吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T18:22:29.423

声明参数的方式不同不会对这两个函数产生影响。通常，如果使用 param() 语法，则可以更灵活地使用属性修改参数。参数的名称以及它们在 MulV 函数体中的引用方式似乎确实存在问题（$factor1/2 和 $a/$b）。

至于为方法使用命名参数，那是行不通的。

# oracle - 如何在 Oracle 应用服务器中从 java 1.5 升级到 java 1.6

> ID：10918656
> 
> 赞同：0
> 
> 时间：2012-06-06T16:55:49.807
> 
> 标签：oracle, application-server, oas, oracle-application-server

有兴趣将 JAVA VERSION 从 JAVA 1.5 升级到 JAVA 1.6

```
[oracle@server301 /]$ java -version
java version "1.5.0_12"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_12-b04)
Java HotSpot(TM) Server VM (build 1.5.0_12-b04, mixed mode) 
```

也有兴趣了解 Oracle 应用服务器版本（从命令行）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:34:42.083

首先 - 你需要安装 java 1.6

如果您想为整个 OAS 更改它，那么`java`您的新 java 目录 (1.6) 的别名。
如果您想将其更改为特定的`OC4J`，则：

1.  打开 opmn/conf/opmn.xml
2.  找到代表您的 OC4J 的元素
3.  更新元素中的值：`process-type/module-data/category/data`where id="java-bin", 到你的新 java 路径
4.  重启 OAS

# android - 将包含在 url 中的图像上传到 android 中的 Facebook

> ID：10918660
> 
> 赞同：0
> 
> 时间：2012-06-06T16:55:58.947
> 
> 标签：android, facebook, image, upload

我使用以下代码将图像上传到我的 Facebook 墙。

```
 try {
    bitmap=BitmapFactory.decodeFile(imagePostion);
    HttpClient httpClient = new DefaultHttpClient();
    HttpContext localContext = new BasicHttpContext();
    HttpPost httpPost = new HttpPost(
   "https://graph.facebook.com/me/photos?access_token="+ a);
    MultipartEntity entity = new MultipartEntity(HttpMultipartMode.BROWSER_COMPATIBLE);
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    bitmap.compress(CompressFormat.PNG, 100, bos);
    byte[] data = bos.toByteArray();
    entity.addPart("source", new ByteArrayBody(data, imagePostion));
    httpPost.setEntity(entity);
    HttpResponse response = httpClient.execute(httpPost,localContext);
    Log.v("Response !!!!!!!!",response+"");
    } catch (UnsupportedEncodingException e) {
    // TODO Auto-generated catch block
    e.printStackTrace()
    } catch (ClientProtocolException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
    } catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
    } 
```

我在这一行得到空指针异常

> ByteArrayOutputStream bos = new ByteArrayOutputStream();

需要帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T14:18:04.763

最后我得到它的工作。MultipartEntity 适用于 Android 2.1 及更高版本。我曾在 1.6 中尝试过。这就是我得到这个错误的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:14:07.220

这里没有要上传的图像位图。创建一个上传图像位图。

添加此行

bitmap.compress(CompressFormat.JPEG, 100, bos);

后

ByteArrayOutputStream bos = new ByteArrayOutputStream();

# c# - jQuery OnUserExit 插件 - OnlineUsers 计数

> ID：10918662
> 
> 赞同：0
> 
> 时间：2012-06-06T16:56:00.443
> 
> 标签：c#, jquery, asp.net, exit

我正在寻找类似下面的东西（jQuery`OnUserExit`插件）： http:
[//archive.plugins.jquery.com/project/onUserExit](http://archive.plugins.jquery.com/project/onUserExit)

但正如您所见，他们的网站无法正常工作。

那么我在哪里可以找到那个插件，或者我怎样才能用 jQuery 编写类似的东西呢？

请参阅此线程：[使用 asp.net 统计在线用户](https://stackoverflow.com/questions/10481351/counting-online-users-using-asp-net)

我需要那个插件来开火`Session_End`。`global.asax`-> 指的是链接上面的答案。

所以下面的代码对 OnlineUsers Count( `fire Session_End in global.asax`) 没有用处：

```
<script type ="text/javascript" >
    function CloseWindow()
    {
       alert("You are closing the window.Fire Session_End using EndSession.ashx");
    }
    window.onunload=CloseWindow;
</script> 
```

因为当用户打开两个或多个网站时，这些功能将通过关闭其中一个来将该用户从 OnlineUsers 中删除。
但正在寻找一个能够识别该网站所有打开的浏览器并通过关闭最后一个（`others are close`）来触发的功能。

**编辑后评论：**
有一些网站可以处理其他网站的在线用户数使用 javascript。
这些网站如何工作以及它们如何识别 OnUserExit。
例如，他们在我的网站中的代码之一是这样的：

```
document.write('<script language="javascript" src="http://www.Counter.com/c.aspx?t=stats&code=2562977&ref=' + escape(document.referrer) + '"></script>'); screensize=screen.width+'x'+screen.height;colors=(navigator.appName.indexOf('Microsoft')==0)?screen.colorDepth:screen.pixelDepth;if(colors=='undefined'){colors='5';};if(colors=='32'){colors='1';};if(colors=='24'){colors='2';};if(colors=='16'){colors='3';};if(colors=='8'){colors='4';};document.write ('<div align="center"><iframe scrolling=no width=125 height=110 border=0 frameborder=0 allowtransparency="true" src="http://engine.Counter.com/counter/xstat.aspx?t=sum1&code=2562977&rnd=' + Math.round(Math.random()*50000) + '&s=' + screensize + '&c=' + colors + '&ref=' + escape(document.referrer) + '&title=' + escape(document.title) + '" ></iframe></div>'); 
```

请你给我们一些关于这些代码的解释！

提前致谢

# vb.net - 如何在存储过程上构建 Crystal 报表？

> ID：10918677
> 
> 赞同：3
> 
> 时间：2012-06-06T16:56:30.207
> 
> 标签：vb.net, sql-server-2008, stored-procedures, crystal-reports-2010

我有几十个旧报表，其中许多都使用 Sql Server 存储过程作为数据源。我正在尝试在使用**VB.NET 2010**和**CR for Visual Studio 2010 version 13.0.2**构建的应用程序中使用它们。

当我基于存储过程运行报告时，我收到一条错误消息，内容类似于

> 找不到表“REPORT_SCHEDULEB”

报告中的表定义如下所示：

```
LogOnInfo.ConnectionInfo for REPORT_SCHEDULEB:
Name: "REPORT_SCHEDULEB", Location: "Proc(REPORT_SCHEDULEB;1)"
AllowCustomConnection: False, DBName: myDb, IntegratedSecurity: False
ServerName: myComputer, User: myName, Password: myPassword, Attributes:
    Database DLL: crdb_ado.dll
    QE_DatabaseName: myDb
    QE_DatabaseType: OLE DB (ADO)
        Auto Translate: -1
        Connect Timeout: 0
        Data Source: myComputer
        General Timeout: 0
        Initial Catalog: myDb
        Integrated Security: False
        Locale Identifier: 1033
        OLE DB Services: -5
        Provider: SQLOLEDB
        Tag with column collation when possible: 0
        Use DSN Default Properties: False
        Use Encryption for Data: 0
        Owner: dbo
    QE_ServerDescription: myComputer
    QE_SQLDB: True
    SSO Enabled: False
    Owner: dbo 
```

我猜测*Location*字段的定义方式存在一些问题，但是

1.  当我尝试在报告编辑器中更改*覆盖的限定表名称*时，它不会接受更改，并且
2.  我真的宁愿找到一个程序化的解决方案，而不是手动编辑数十份报告。

因此，我尝试在我的代码中设置 table.Location 值，但这会引发 COM 异常——我猜它在某种程度上是只读的。

我还想到了设置某种*QualifiedName*属性的可能性，但还没有找到一种方法来做到这一点。

有任何想法吗？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-08T20:44:12.193

通过在运行时使用从存储过程创建的数据表设置报表数据源，我在 VB 中实现了一个解决方案。这样，所有连接详细信息只需在应用程序中存储一次，而不是针对每个报告。

（大致）

```
Dim SourceDatabase as datatable = GetDatatableFromSP(SPName)
Dim DocumentToShow as New ReportDocument

DocumentToShow.Load(DocumentPath)
DocumentToShow.SetDataSource(SourceDatabase)

ReportViewer.ViewerCore.ReportSource = DocumentToShow 
```

# visual-studio-2010 - 使用 VS2010 Ultimate 进行 FxCop / 代码分析

> ID：10918678
> 
> 赞同：8
> 
> 时间：2012-06-06T16:56:32.817
> 
> 标签：visual-studio-2010, optimization, code-analysis, fxcop

我已经得到了一些关于这个的信息，但我仍然可以找到一个正确的答案，我最近在我的公司被问到这个问题：“对该代码运行 fxcop 分析并告诉我结果”。

好的，我有具有代码分析功能的 VS2010 Ultimate，但在发表任何评论之前，我在互联网上浏览它，因为我想实现最佳选择...

所以，假设我要在两个分析器上使用相同的规则：

*   我应该推荐使用其中一个吗？
*   我应该说“嘿，那有点老了，让我们使用代码分析吧！”
*   我应该在不同的计算机上得到相同的结果吗？（据我所知，fxcop 为您提供了一些“点”，而对于我所阅读的内容，有时它会为您提供 diff 计算机上的差异点，我不知道这与代码分析有关

谢谢，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T18:22:51.740

FxCop 和代码分析本质上是一回事，但有以下区别：

1.  代码分析包括一个 VS IDE 扩展。FxCop 可以在 IDE 中执行并显示结果，但结果并不完整。另一方面，FxCop 包括一个独立的 UI，它在某些类型的结果探索方面功能更全面。
2.  代码分析包含比 FxCop 更多的规则。部分原因是它包含一个额外的规则引擎，但部分只是微软决定我们应该支付的额外规则。（如果您想在独立的 FxCop UI 中查看结果，可以从 FxCop 运行额外的规则。）

对于任何给定的规则，您应该在任何给定的机器上看到完全相同的结果，无论您使用的是两种工具中的哪一种。您应该看到差异的唯一情况是您没有为 FxCop 分析指定区域性设置，并且机器之间的系统区域性不同。

# java - 如何组合两个线程以实现自动完成的目标（智能感知）

> ID：10918679
> 
> 赞同：1
> 
> 时间：2012-06-06T16:56:35.877
> 
> 标签：java, swing, autocomplete, awt, intellisense

在我之前的帖子之后[，](https://stackoverflow.com/questions/10911554/how-to-add-intellisense-to-a-search-line-in-java-swing)善良的先生。`@bunta`建议使用[此处](http://www.roseindia.net/tutorial/java/swing/autosuggest.html)的代码 并将其与我的代码一起使用，以使自动完成工作。

问题是我已经在使用一个线程。

这是部分代码（它很大，然后我只发布重要的内容）：

```
private javax.swing.JTextField boxOfCurrentPath;

// more code 

boxOfCurrentPath.setToolTipText("");
boxOfCurrentPath.addActionListener(new java.awt.event.ActionListener() 
{
    public void actionPerformed(java.awt.event.ActionEvent evt) 
        {
            boxOfCurrentPathActionPerformed(evt);
        }
   }); 
```

但是当我尝试添加另一个线程时，上面的自动完成示例与我当前的代码，没有任何反应。代码在没有自动完成的情况下运行：

```
boxOfCurrentPath.setToolTipText("");

boxOfCurrentPath.addActionListener(new java.awt.event.ActionListener() 
{
    public void actionPerformed(java.awt.event.ActionEvent evt) 
    {
        boxOfCurrentPathActionPerformed(evt);
    }

     class AutoSuggest2 extends JPanel
    {
         private final JTextField tf;
         private final JComboBox combo = new JComboBox();
         private final Vector<String> v = new Vector<String>();

        public AutoSuggest2() 

        {
            super(new BorderLayout());
            combo.setEditable(true);
            tf = (JTextField) combo.getEditor().getEditorComponent();
            tf.addKeyListener(new KeyAdapter() 
            {
              public void keyTyped(KeyEvent e) 
              {
                   EventQueue.invokeLater(new Runnable() {
                public void run() 
                {
                    String text = tf.getText();

                        if(text.length()==0) 

                        {
                        combo.hidePopup();
                        setModel(new DefaultComboBoxModel(v), "");
                        }

                        else
                        {
                            DefaultComboBoxModel m = getSuggestedModel(v, text);
                            if(m.getSize()==0 || hide_flag) 
                            {
                                combo.hidePopup();
                                hide_flag = false;
                            }

                            else
                            {
                                setModel(m, text);
                                combo.showPopup();
                            }

                        } // end else 

                } // end run 
                });

              } // end keyTyped   

              public void keyPressed(KeyEvent e) 
              {
                  String text = tf.getText();
                  int code = e.getKeyCode();
                  if(code==KeyEvent.VK_ENTER) 
                  {
                        if(!v.contains(text)) 
                        {
                            v.addElement(text);
                            Collections.sort(v);
                            setModel(getSuggestedModel(v, text), text);
                        }
                        hide_flag = true; 
                  } 

                  else 
                      if(code==KeyEvent.VK_ESCAPE)
                      {
                          hide_flag = true; 
                      }
                      else 

                          if(code==KeyEvent.VK_RIGHT) 
                          {
                              for(int i=0;i<v.size();i++) 
                              {
                                  String str = v.elementAt(i);
                                  if(str.startsWith(text)) 
                                  {
                                      combo.setSelectedIndex(-1);
                                      tf.setText(str);
                                      return;
                                  }
                              }
                          }
                }  // end keyPressed
          }); // end addKeyListener

        String[] axesTypes = 
            {"child::", "attribute::", "descendant::", "descendant-or-self::", 
             "slef::", "parent::", "following-sibling::", "preceding-sibling::",
             "ancestor-or-self::", "ancestor::", "following::", "preceding::" ,
             "preceding::", "namespace::", "node()"};

            for(int i=0;i<axesTypes.length;i++)
            {
                      v.addElement(axesTypes[i]);
            }
            setModel(new DefaultComboBoxModel(v), "");
            JPanel p = new JPanel(new BorderLayout());
            p.setBorder(BorderFactory.createTitledBorder("AutoSuggestion Box"));
            p.add(combo, BorderLayout.NORTH);
            add(p);
            setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
            setPreferredSize(new Dimension(300, 150));

        } // end AutoSuggest

        private boolean hide_flag = false;

        private DefaultComboBoxModel getSuggestedModel(java.util.List<String> list, String text)
        {
                DefaultComboBoxModel m = new DefaultComboBoxModel();
                for(String s: list) 
                {
                    if(s.startsWith(text)) m.addElement(s);
                }
                return m;
        }

        private void setModel(DefaultComboBoxModel mdl, String str)
        {
         combo.setModel(mdl);
         combo.setSelectedIndex(-1);
         tf.setText(str);
        }

    } // end AutoSuggest2 extends 

}); 
```

我显然做错了什么，但似乎无法理解为什么。任何想法？谢谢 ！

# zend-framework - 我如何在没有时间的情况下从 Zend_Date 获取国际化日期字符串

> ID：10918681
> 
> 赞同：0
> 
> 时间：2012-06-06T16:56:38.600
> 
> 标签：zend-framework, zend-date

我需要为不同的语言以不同的格式回显国际化时间。现在我在创建日期时使用语言环境，但它也输出时间：

```
$date->toString();
29.05.2012 0:00:00 
```

预期结果：

```
29.05.2012 
```

在文档中，我只能看到自定义格式（据我所知，如果我使用它们，将不会应用国际化格式）。是否可以只输出日期，没有时间，就像那里描述的那样（据我所知，zf 支​​持国际格式：[http](http://en.wikipedia.org/wiki/Date_format_by_country) ://en.wikipedia.org/wiki/Date_format_by_country ）？

我试过：

```
echo $date->get(Zend_Date::DATE_SHORT, $locale);
echo $date->toString(Zend_Date::DATE_SHORT); ?>
// produces  MMMMMMMM (letters instead of date? Oo) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:32:52.267

它不起作用，因为需要添加

```
Zend_Date::setOptions(array('format_type' => 'iso')); 
```

在引导程序中而不是

```
Zend_Date::setOptions(array('format_type' => 'php')); 
```

使用此选项，它可以正常工作！

# python - 使用“/”、“\”的平台无关路径连接？

> ID：10918682
> 
> 赞同：109
> 
> 时间：2012-06-06T16:56:40.610
> 
> 标签：python, path

在 python 中，我有变量`base_dir`和`filename`. 我想将它们连接起来以获得`fullpath`. 但是在 windows 下我应该使用`\`and 用于 POSIX `/`。

```
fullpath = "%s/%s" % ( base_dir, filename ) # for Linux 
```

我怎样才能使这个平台独立？

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2012-06-06T16:57:40.440

您想为此使用[os.path.join()](http://docs.python.org/library/os.path.html?highlight=os.path.join#os.path.join)。

使用它而不是字符串连接等的优势在于它知道各种操作系统特定的问题，例如路径分隔符。例子：

```
import os 
```

在**Windows 7**下：

```
base_dir = r'c:\bla\bing'
filename = r'data.txt'

os.path.join(base_dir, filename)
'c:\\bla\\bing\\data.txt' 
```

在**Linux**下：

```
base_dir = '/bla/bing'
filename = 'data.txt'

os.path.join(base_dir, filename)
'/bla/bing/data.txt' 
```

[os](http://docs.python.org/library/os.path.html)模块包含许多用于目录、路径操作和查找操作系统特定信息的有用方法，例如通过[os.sep在路径中使用的分隔符](http://docs.python.org/library/os.html?highlight=os.sep#os.sep)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-06-06T16:58:07.747

使用[`os.path.join()`](http://docs.python.org/library/os.path.html#os.path.join)：

```
import os
fullpath = os.path.join(base_dir, filename) 
```

[os.path](http://docs.python.org/library/os.path.html)模块包含平台无关路径操作所需的所有方法，但如果您需要知道当前平台上的路径分隔符是什么，您可以使用[`os.sep`](http://docs.python.org/library/os.html#os.sep).

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2017-03-14T05:22:02.417

在这里挖掘一个老问题，但在 Python 3.4+ 上，您可以使用[pathlib 运算符](https://docs.python.org/3/library/pathlib.html#operators)：

```
from pathlib import Path

# evaluates to ./src/cool-code/coolest-code.py on Mac
concatenated_path = Path("./src") / "cool-code\\coolest-code.py" 
```

`os.path.join()`与您有幸运行最新版本的 Python相比，它可能更具可读性。但是，如果您必须在僵化或遗留环境中运行代码，您也需要权衡与旧版本 Python 的兼容性。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-06-06T17:01:10.483

```
import os
path = os.path.join("foo", "bar")
path = os.path.join("foo", "bar", "alice", "bob") # More than 2 params allowed. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-25T19:21:30.220

我为此制作了一个助手类：

```
import os

class u(str):
    """
        Class to deal with urls concat.
    """
    def __init__(self, url):
        self.url = str(url)

    def __add__(self, other):
        if isinstance(other, u):
            return u(os.path.join(self.url, other.url))
        else:
            return u(os.path.join(self.url, other))

    def __unicode__(self):
        return self.url

    def __repr__(self):
        return self.url 
```

用法是：

```
 a = u("http://some/path")
    b = a + "and/some/another/path" # http://some/path/and/some/another/path 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-12T14:05:23.577

谢谢你。对于使用 fbs 或 pyinstaller 和冻结应用程序看到此内容的任何其他人。

我可以使用以下现在完美的方法。

```
target_db = os.path.join(os.path.abspath(os.path.dirname(sys.argv[0])), "sqlite_example.db") 
```

我之前正在做这种笨拙的事情，这显然不理想。

```
if platform == 'Windows':
    target_db = (os.path.abspath(os.path.dirname(sys.argv[0])) + "\\" + "sqlite_example.db")

if platform == 'Linux' or 'MAC':
    target_db = (os.path.abspath(os.path.dirname(sys.argv[0])) + "/" + "sqlite_example.db")

target_db_path = target_db
print(target_db_path) 
```

# opengl - 加载 GL_RGB 纹理后奇怪的颜色偏移

> ID：10918684
> 
> 赞同：6
> 
> 时间：2012-06-06T16:56:54.440
> 
> 标签：opengl, texture2d

这是一个原始的 5x2 纹理，以 RGB 和 RGBA 格式定义。

```
//                       1               2               3                     4               5
unsigned char rgb[]  = { 0, 0, 0,        0, 0, 0,        200, 200, 200,        0, 0, 0,        200, 200, 200,
                         0, 0, 0,        0, 0, 0,        200, 200, 200,        0, 0, 0,        200, 200, 200,       };
unsigned char rgba[] = { 0, 0, 0, 255,   0, 0, 0, 255,   200, 200, 200, 255,   0, 0, 0, 255,   200, 200, 200, 255,
                         0, 0, 0, 255,   0, 0, 0, 255,   200, 200, 200, 255,   0, 0, 0, 255,   200, 200, 200, 255,  }; 
```

加载 RGBA 版本按预期工作：

```
glTexImage2D(GL_TEXTURE_2D,
             0,       // mipmap level
             GL_RGB,  // dest format
             5,       // width
             2,       // height
             0,       // deprecated
             GL_RGBA, // source format
             GL_UNSIGNED_BYTE,
             rgba); 
```

![在此处输入图像描述](../Images/6cca6d1dba28f34e8114490ed5b77403.png)

加载 RGB 纹理会导致奇怪的颜色偏移：

```
glTexImage2D(GL_TEXTURE_2D,
             0,       // mipmap level
             GL_RGB,  // dest format
             5,       // width
             2,       // height
             0,       // deprecated
             GL_RGB,  // source format
             GL_UNSIGNED_BYTE,
             rgb); 
```

![在此处输入图像描述](../Images/3574165300c51a40094fea99be900eb3.png)

第一个和第二个屏幕截图之间的代码差异只是 glTexImage2D 的这两个参数。

我究竟做错了什么？

**环境**

*   ATI Radeon HD5450，OpenGL 4.2
*   Windows 7、64 位
*   视觉工作室 2010

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-06T18:32:53.203

[见这里](http://www.opengl.org/wiki/Common_Mistakes#Texture_upload_and_pixel_reads)-`glPixelStorei(GL_UNPACK_ALIGNMENT, 1)`应该修复它。

# ruby-on-rails - 重启后当前未安装 rails

> ID：10918685
> 
> 赞同：5
> 
> 时间：2012-06-06T16:57:04.517
> 
> 标签：ruby-on-rails, ruby, ubuntu

我有一个奇怪的问题：我在 rvm 上的 rails 上安装了 ruby​​。一切正常，我可以创建项目了。但是当我输入“rails new”重新启动后，我有“程序'rails'当前没有安装。”。

```
System Ubuntu 12.04

ruby -v
"1.9.3p194"

gem list
actionmailer (3.2.5)
actionpack (3.2.5)
activemodel (3.2.5)
activerecord (3.2.5)
activeresource (3.2.5)
activesupport (3.2.5)
arel (3.0.2)
builder (3.0.0)
bundler (1.1.4)
coffee-rails (3.2.2)
coffee-script (2.2.0)
coffee-script-source (1.3.3)
erubis (2.7.0)
execjs (1.4.0)
hike (1.2.1)
i18n (0.6.0)
journey (1.0.3)
jquery-rails (2.0.2)
json (1.7.3)
mail (2.4.4)
mime-types (1.18)
multi_json (1.3.6)
polyglot (0.3.3)
rack (1.4.1)
rack-cache (1.2)
rack-ssl (1.3.2)
rack-test (0.6.1)
rails (3.2.5)
railties (3.2.5)
rake (0.9.2.2)
rdoc (3.12)
rubygems-bundler (1.0.2)
rvm (1.11.3.3)
sass (3.1.19)
sass-rails (3.2.5)
sprockets (2.1.3)
sqlite3 (1.3.6)
thor (0.15.2)
tilt (1.3.3)
treetop (1.4.10)
tzinfo (0.3.33)
uglifier (1.2.4) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T02:00:41.013

将此添加到 ~/.bashrc 文件的底部：

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" 
```

如果这不起作用，请尝试：

```
[[ -s "/home/yourusername/.rvm/scripts/rvm" ]] && source "/home/yourusername/.rvm/scripts/rvm" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-24T09:53:15.543

`Terminal`-> `Edit`-> `Profile Preferences`-> `Title and Command`->`Run command as a login shell`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-09T09:29:49.823

我想你需要编辑你的终端设置

只需尝试 [https://beatreader.wordpress.com/2016/08/09/ruby-on-rails-problemmissing-after-reboot/](https://beatreader.wordpress.com/2016/08/09/ruby-on-rails-problemmissing-after-reboot/) 或者每次打开终端时都需要运行此代码

```
源“$HOME/.rvm/scripts/rvm”
```

# c++ - 在 c++ 中通过 int id 跟踪少量结构类型的有效方法是什么？

> ID：10918686
> 
> 赞同：0
> 
> 时间：2012-06-06T16:57:06.430
> 
> 标签：c++, optimization

我有大约 70-150 个带有无符号整数 ID 字段的不同结构 X。它们在程序初始化时被读入并初始化，此后不再修改。在以下（或其他方法？）中，访问它们的最快方法是什么（这种情况经常发生）：

1.  使用 std::vector v; 其中 v[X.id] = X；通过执行 X& x = v[id]; 访问 （这应该在开始时做一个副本，但后来只是在本质上是一个平面数组上通过 id 进行查找。

2.  同上，但 std::vector v; X* x = v[id]; 我对这个很谨慎，因为它有一个额外的间接级别。

3.  std::map - 与上面相比感觉有点矫枉过正？

4.  与上面相同，但 unordered_map - 再次出现 70-150 次可能甚至不会超过建议 3。

5.  还有更聪明的吗？我在 1 中看到的一个问题是访问模式可能有点稀疏，但如果这是最快的方法，我不确定如何解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T17:05:02.710

使用向量绝对是最快的方法：

*   向量的复杂度为 O(1)。无需搜索或散列，您将立即找到您的实例。
*   地图的复杂度为 O(log N)。该地图需要将您的索引与 logN 其他条目进行比较才能找到您的实例。
*   Unordered_map 的复杂度为 O(1)，但计算哈希值的开销相当大（尽管对于简单的数字来说不会那么多）。但是，std::unordered_map 仍然在一个哈希索引后面放置多个条目，因此它必须比较多个索引，而不是比较一个索引（我认为默认情况下它是 4）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T17:01:34.460

我认为对于少数项目，没有比使用数组或向量数据类型更快的访问方式，因为它提供了恒定时间访问。在许多对象的情况下，这种方法也是最快的，但也是最昂贵的内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T17:07:51.737

如果您不介意预先为所有结构预先分配空间，并且 ID 可以按顺序排序，因此它们也是索引，只需使用方法 1。

如果结构的构建成本很高，可以通过不将构建代码实际放置在默认构造函数中（稍后通过方法调用显式执行）或使用原始数组并将[新数组放置](http://en.wikipedia.org/wiki/Placement_syntax)在该数组内的内存“插槽”上来延迟构造.

如果 ID 不是连续的，请使用`std::unordered_map`以防止在“孔”上浪费空间。

# javascript - 创建 Javascript 函数确认框的问题

> ID：10918687
> 
> 赞同：0
> 
> 时间：2012-06-06T16:57:07.553
> 
> 标签：javascript, popup

我对这一切都很陌生，但试图创建一个执行以下操作的 javascript 函数：

1.  用户点击电子邮件
2.  出现一个确认框，用户点击“确定”或取消
3.  点击“确定”后，他们将被带到电子邮件窗口
4.  点击“取消”后，窗口关闭

这是我到目前为止所拥有的，我只是遇到了取消关闭窗口的问题。它的作用类似于“确定”按钮并转到电子邮件窗口。非常感谢您的帮助！！

```
 <html>
    <head>
    <script type="text/javascript">
    <!--
    function getConfirmation(){
       var retVal = confirm("This is the disclaimer copy to agree or disagree to.");
       if( retVal == true ){
          return true;
       }else{
          return false;
       }
    }
    //-->
    </script>
    </head>
    <body>

    <a href="mailto:test@mywebsite.com" onclick="getConfirmation()">test@mywebsite.com</a>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T16:58:33.343

你需要`onclick="return getConfirmation()">`

标记`return`..

[Jsfiddle 演示](http://jsfiddle.net/QTCNK/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:59:57.107

尝试这个：

```
<a href="mailto:test@mywebsite.com" onclick="return getConfirmation()">test@mywebsite.com</a> 
```

在. `return`_`onclick`

* * *

您还可以将功能简化为：

```
function getConfirmation(){
 return confirm("This is the disclaimer copy to agree or disagree to."); // DONE!
} 
```

# ipad - 响应来自滚动视图 ios5 内的 UIImageViews 数组的事件

> ID：10918693
> 
> 赞同：0
> 
> 时间：2012-06-06T16:57:21.857
> 
> 标签：ipad, ios5, uiview, uiimageview

对于我的 iPad 应用程序，我正在以编程方式创建几个显示在屏幕上的 UIImage 视图。代码看起来基本上是这样的：

```
for(ModelObject *ModelsList 中的模型){
    //从模型对象创建一个 UIImage 视图
    UIImageView *icon = [[UIImageView alloc] initWithFrame:model.icon_frame];
    icon.image = [UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:model.icon_path ofType:@"png"]];

     //将图像视图添加到可变数组以跟踪它们
    [myImageViews addObject:icon];

    // 将视图添加为子视图
    [self.view addSubview:icon];
}

```

所以现在我在屏幕上显示了一堆图标。但是我想从`UIImageViews`我以编程方式创建的触摸事件中截取，以便它调用其他方法，最好使用包含发送者 id 的参数或其他一些我可以用来确定`UIImageView`被触摸的区分信息的参数。

实现这一目标的最佳实践方式是什么？

我是 iOS 新手，所以推荐阅读也将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T20:14:23.277

请提供任何适用的反馈，因为我不知道这是否是常见的做法，甚至是一种体面的做事方式......

所以基本上我所做的就是保留一个在视图对象和模型对象之间映射的 id 字典，然后查找发送视图的 id 并找到合适的模型对象，（然后我将使用该模型对象加载另一种观点）

代码如下所示：

```
// 在标题中
@property（非原子，保留）NSMutableDictionary *icons_to_models

// 在创建了一个 UIButton 之后叫做 icon
[图标 setBackgroundImage:model.image forState:UIControlStateNormal];
[icon addTarget:self action:@selector(tappedIcon:) forControlEvents:UIControlEventTouchUpInside];
NSNumber *key = [NSNumber numberWithUnsignedInt:[icon hash]];
[icons_to_models setObject:model forKey:key];

...

//将发件人与被按下的图标匹配
-(void)tappedIcon:(id)sender{
    NSNumber *key = [NSNumber numberWithUnsignedInt:[sender hash]];
    ModelObject *model = [icons_to_models objectForKey:key];
    NSLog(@"点击：%@", model.name);
}

```

# ios - 强制 UITableView 缓存可重用单元格

> ID：10918697
> 
> 赞同：3
> 
> 时间：2012-06-06T16:57:31.100
> 
> 标签：ios, uitableview

我使用具有相对“重”的自定义表格视图单元格的表格视图 - 比如说单个单元格中有大约 100 个子视图（完整层次结构）。尽管如此，我已经能够实现非常平滑的滚动 - 使用标准做法，例如仅使用不透明视图、隐藏未使用的子视图（甚至从视图层次结构中删除）、预加载单元格高度等。

问题是创建单个单元实例仍然相对昂贵。由于标准 UITableView 的单元重用逻辑是如何工作的，这个问题只在特定条件下才明显。

通常在加载表格视图（并显示初始内容）时，它会创建几乎所有必需的单元格实例 - 因此，当您开始滚动时，它很少需要创建更多可重用的单元格。但是，如果由于某种原因它只在开始时显示几个单元格，那么在启动滚动时显然需要创建更多单元格。在我的情况下，如果有一个宽表视图标题或者如果第一个单元格足够大，这很明显。当您开始滚动时发生这种情况时，会有片刻的明显滞后，这显然是由创建新单元格实例引起的。没有什么丑陋但仍然引人注目，尤其是与之后的绝对平滑滚动相比。

现在，显而易见的解决方案是让单元格“更轻”——比如将它们分成不同的更具体的类型，这样每个单元格就可以包含更少的子视图。但是由于我的内容的组织方式，这将是一个非常复杂的解决方案。

所以我的问题是——有没有什么好的方法可以“欺骗”表格视图逻辑来强制加载和缓存特定数量的可重用单元格实例——尽管实际可见的单元格数量是多少？

我一直在考虑的选项之一是拥有自己的显式单元缓存，并在需要时用单元预填充它（比如在 -viewDidLoad 中）。这种方法的问题是你必须事先知道你需要的确切类型的细胞——对我来说效果不佳。改进将是在加载初始数据时构建缓存（因此至少知道内容的确切类型），但我一直想知道是否有任何简单的选项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T17:12:35.117

您可以通过将自己的“二级缓存”层添加到数据源来实现。

初始化数据源时，根据需要预先创建尽可能多的单元格，并将它们放入数组中。当你`dequeueReusableCellWithIdentifier`失败时，先去那个数组，然后从那里取一个单元格。一旦数组用完，就开始创建新的单元格（如果您预先创建了足够多的单元格，则不需要即时创建新的单元格：当您有足够多的单元格旋转进出可见性时，出队最终将停止失败）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-17T03:00:00.957

我也有类似的情况，我想在不同的单元格中加载几个网站，并且 loadrequest 必须只触发一次。想法是在通过向上或向下滚动使单元格可见/不可见时避免重复调用。假设我的表格视图中有 5 个单元格，每个单元格都有一个加载不同网站的 web 视图。loadrequest 将被调用一次，单元格将被缓存。这是最简单的实现。

变量声明

```
let weblinks:[String] = ["http://www.google.com",
                         "http://www.facebook.com",
                         "http://www.yahoo.com",
                         "http://www.puthiyathalaimurai.com/",
                         "http://www.github.com"]
var mycells:[MyTableViewCell] = [MyTableViewCell(),
                                 MyTableViewCell(),
                                 MyTableViewCell(),
                                 MyTableViewCell(),
                                 MyTableViewCell()] 
```

细胞换行。我希望你知道它的作用，

```
func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    let cellIdentifier = String(describing: MyTableViewCell.self)

    let cell = tableView.dequeueReusableCell(withIdentifier: cellIdentifier) as? MyTableViewCell
    if cell?.isNewCell == true { //return from cache
        return mycells[indexPath.row]
    }
    cell?.title.text = weblinks[indexPath.row].uppercased()
    cell?.web.loadRequest(URLRequest(url: URL(string: weblinks[indexPath.row])!))
    cell?.isNewCell = true //mark it for cache
    mycells[indexPath.row] = cell!
    return cell!
} 
```

# android - 使用 EDITEXT 的 SQLITE 列表视图过滤器

> ID：10918702
> 
> 赞同：-2
> 
> 时间：2012-06-06T16:57:53.380
> 
> 标签：android

请我真的需要 listview 过滤器的帮助。因为我看过很多教程，但它不起作用。我真的厌倦了，只是我需要 EdiText 过滤器

我的项目包含四个类：

1-LocationActivity (l'activity prencipale)

```
public class LocationActivity extends Activity implements LocationListener{

    public final static String LOCATION_ID = "location_id";

    private long location_id;
    private EditText name;
    private EditText comment;

    private RatingBar ratevalue;

    private EditText latitude;
    private EditText longitude;
    private TextView current_latitude;
    private TextView current_longitude;
    private TextView current_source;
    private TextView current_accuracy;
    private LocationDatabase db;
    private BestLocationProxy best_location_proxy;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        db = new LocationDatabase(this);
        best_location_proxy = new BestLocationProxy(this);

        if (savedInstanceState != null) {
            location_id = savedInstanceState.getLong(LOCATION_ID);
        }

        Intent intent = getIntent();
        location_id = intent.getLongExtra(LOCATION_ID, -1);

        setContentView(R.layout.location);
        name = (EditText) findViewById(R.id.name);

        comment = (EditText) findViewById(R.id.comment);
        ratevalue = (RatingBar) findViewById(R.id.ratingbar);
        latitude = (EditText) findViewById(R.id.latitude);
        longitude = (EditText) findViewById(R.id.longitude);
        current_latitude = (TextView) findViewById(R.id.current_latitude);
        current_longitude = (TextView) findViewById(R.id.current_longitude);
        current_source = (TextView) findViewById(R.id.current_source);
        current_accuracy = (TextView) findViewById(R.id.current_accuracy);

        updateLocation(best_location_proxy.getLastKnownLocation());

        Button set_location = (Button) findViewById(R.id.set_location);

        set_location.setOnClickListener(new OnClickListener(){

            public void onClick(View arg0) {
                Location l = best_location_proxy.getLastKnownLocation();
                if (l == null) {
                    return;
                }
                latitude.setText(Double.toString(l.getLatitude()));
                longitude.setText(Double.toString(l.getLongitude()));
            }
        });

        Button closeButton = (Button) findViewById(R.id.close_location_window);
        closeButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                finish();
            }
        });

        if (location_id != -1) {
            Cursor c = db.getLocation(location_id);
            if (c.getCount() != 1) {
                finish();
                return;
            }
            c.moveToFirst();
            int name_id = c.getColumnIndex(LocationDatabase.FIELD_LOCATIONS_NAME);
            int comment_id = c.getColumnIndex(LocationDatabase.FIELD_LOCATIONS_COMM);
            int ratevalue_id = c.getColumnIndex(LocationDatabase.FIELD_LOCATIONS_RATE);
            int latitude_id = c.getColumnIndex(LocationDatabase.FIELD_LOCATIONS_LATITUDE);
            int longitude_id = c.getColumnIndex(LocationDatabase.FIELD_LOCATIONS_LONGITUDE);

            name.setText(c.getString(name_id));

            comment.setText(c.getString(comment_id));
            ratevalue.setRating(c.getLong(ratevalue_id));
            latitude.setText(Double.toString(c.getDouble(latitude_id)));
            longitude.setText(Double.toString(c.getDouble(longitude_id)));
            c.close();
        }

    }

    @Override
    protected void onResume() {
        super.onResume();
        best_location_proxy.requestLocationUpdates(100000, 0, this);
    }

    @Override
    protected void onPause() {
        super.onPause();
        best_location_proxy.removeUpdates(this);

        String s_name = name.getText().toString();
        if (s_name.equals("")) {
            return;
        }

        String s_comment = comment.getText().toString();
        if (s_comment.equals("")) {
            return;
        }
        Double d_ratevalue = (double) ratevalue.getRating();

        Double d_latitude = null;
        String s_latitude = latitude.getText().toString();
        if (!s_latitude.equals("")) {
            d_latitude = Double.parseDouble(s_latitude);
        }

        Double d_longitude = null;
        String s_longitude = longitude.getText().toString();
        if (!s_longitude.equals("")) {
            d_longitude = Double.parseDouble(s_longitude);
        }

        if (location_id != -1) {
            db.updateLocation(location_id, s_name,  s_comment, d_ratevalue, d_latitude, d_longitude);
        } else {

            location_id = db.createLocation(s_name, s_comment, d_ratevalue, d_latitude, d_longitude);
        }
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        outState.putLong(LOCATION_ID, location_id);
    }

    private void updateLocation(Location l){

        if (l == null){
            current_source.setText(R.string.no_provider);
            current_latitude.setText(R.string.unavailable);
            current_longitude.setText(R.string.unavailable);
            current_accuracy.setText(R.string.unavailable);
            return;
        }

        String source;
        if (l.getProvider().equals(LocationManager.GPS_PROVIDER)){
            source = getString(R.string.location_map);
        } else if (l.getProvider().equals(LocationManager.NETWORK_PROVIDER)){
            source = getString(R.string.cell);
        } else {
            source = getString(R.string.unknown);
        }

        current_source.setText(source);
        current_latitude.setText(Double.toString(l.getLatitude()));
        current_longitude.setText(Double.toString(l.getLongitude()));
        current_accuracy.setText(Float.toString(l.getAccuracy()));
    }

    public void onLocationChanged(Location location) {
        updateLocation(location);
    }

    public void onProviderDisabled(String provider) {
    }

    public void onProviderEnabled(String provider) {    
    }

    public void onStatusChanged(String provider, int status, Bundle extras) {
    }

} 
```

2-LocationListActivity（列表视图活动）

```
public class LocationListActivity extends ListActivity {

    private Cursor locations;
    private LocationDatabase db;

    private final static String RADAR_ACTION = "com.google.android.radar.SHOW_RADAR";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        db = new LocationDatabase(this);

        setContentView(R.layout.list);
        registerForContextMenu(this.getListView());
        getListView().setOnItemClickListener(new OnItemClickListener() {

            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                Cursor c = (Cursor) parent.getAdapter().getItem(position);

                int name_id = c.getColumnIndex(LocationDatabase.FIELD_LOCATIONS_NAME);
                int latitude_id = c
                        .getColumnIndex(LocationDatabase.FIELD_LOCATIONS_LATITUDE);
                int longitude_id = c
                        .getColumnIndex(LocationDatabase.FIELD_LOCATIONS_LONGITUDE);
                String name = c.getString(name_id);
                float latitude = c.getFloat(latitude_id);
                float longitude = c.getFloat(longitude_id);

                startBest(latitude, longitude, name);
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        super.onCreateOptionsMenu(menu);

        MenuItem add = menu.add(R.string.location_add);
        add.setIcon(android.R.drawable.ic_menu_add);
        add.setOnMenuItemClickListener(new OnMenuItemClickListener() {

            public boolean onMenuItemClick(MenuItem item) {
                Intent i = new Intent();
                i.setClass(LocationListActivity.this, LocationActivity.class);
                startActivity(i);
                return true;
            }
        });

        return true;
    }

    @Override
    protected void onResume() {
        super.onResume();
        updateList();
    }

    @Override
    protected void onStop() {
        super.onStop();
        if (locations != null){
            locations.close();
        }
    }

    @Override
    public void onCreateContextMenu(ContextMenu menu, View v,
            ContextMenuInfo menuInfo) {
        super.onCreateContextMenu(menu, v, menuInfo);
        AdapterView.AdapterContextMenuInfo info = (AdapterView.AdapterContextMenuInfo) menuInfo;
        Cursor c = (Cursor) getListView().getItemAtPosition(info.position);

        int id_id = c.getColumnIndex(LocationDatabase.FIELD_LOCATIONS_ID);
        int name_id = c.getColumnIndex(LocationDatabase.FIELD_LOCATIONS_NAME);
        int latitude_id = c.getColumnIndex(LocationDatabase.FIELD_LOCATIONS_LATITUDE);
        int longitude_id = c.getColumnIndex(LocationDatabase.FIELD_LOCATIONS_LONGITUDE);

        final long id = c.getLong(id_id);
        final String name = c.getString(name_id);
        final float latitude = c.getFloat(latitude_id);
        final float longitude = c.getFloat(longitude_id);

        menu.setHeaderTitle(name);

        MenuItem map = menu.add(R.string.location_map);
        map.setOnMenuItemClickListener(new OnMenuItemClickListener() {

            public boolean onMenuItemClick(MenuItem item) {
                startMap(latitude, longitude, name);
                return true;
            }
        });

        MenuItem edit = menu.add(R.string.location_edit);
        edit.setOnMenuItemClickListener(new OnMenuItemClickListener() {

            public boolean onMenuItemClick(MenuItem item) {
                Intent i = new Intent();
                i.setClass(LocationListActivity.this, LocationActivity.class);
                i.putExtra(LocationActivity.LOCATION_ID, id);
                startActivity(i);
                return true;
            }
        });

        MenuItem delete = menu.add(R.string.location_delete);
        delete.setOnMenuItemClickListener(new OnMenuItemClickListener() {

            public boolean onMenuItemClick(MenuItem item) {
                db.deleteLocation(id);
                updateList();
                return true;
            }
        });
    }

    private void updateList() {

        if (locations != null) {
            locations.close();
        }

        locations = db.getAllLocations();
        ListAdapter adapter = new SimpleCursorAdapter(this,
                android.R.layout.simple_list_item_1, locations,
                new String[] { LocationDatabase.FIELD_LOCATIONS_NAME, },
                new int[] { android.R.id.text1 });
        setListAdapter(adapter);
    }

    private void startRadar(float latitude, float longitude){
        Intent i = new Intent(RADAR_ACTION);
        i.putExtra("latitude", latitude);
        i.putExtra("longitude", longitude);
        startActivity(i);
    }

    private void startMap(float latitude, float longitude, String name){
        Formatter f = new Formatter(Locale.US);
        f.format("geo:0,0?q=%1$.5f,%2$.5f(%3$s)", latitude, longitude, name);
        Uri uri = Uri.parse(f.toString());
        Intent i = new Intent(Intent.ACTION_VIEW, uri);
        startActivity(i);
    }

    private void startBest(float latitude, float longitude, String name){
        if (isRadarAvailable()){
            startRadar(latitude, longitude);
        } else {
            startMap(latitude, longitude, name);
        }
    }

    private boolean isRadarAvailable(){
        return isIntentAvailable(RADAR_ACTION);
    }

    private boolean isIntentAvailable(String action) {
        PackageManager packageManager = getPackageManager();
        final Intent intent = new Intent(action);
        @SuppressWarnings("rawtypes")
        List list =
                packageManager.queryIntentActivities(intent,
                        PackageManager.MATCH_DEFAULT_ONLY);
        return list.size() > 0;
    }
} 
```

3-LocationDataase（数据库活动sqlite）

```
public class LocationDatabase extends SQLiteOpenHelper {

    public final static String TAG = LocationDatabase.class.toString();

    public final static String DB_NAME = "locations";
    public final static int DB_VERSION = 1;

    public final static String TABLE_LOCATIONS = "locations";

    public final static String FIELD_LOCATIONS_ID = "_id";
    public final static String FIELD_LOCATIONS_NAME = "name";
    public final static String FIELD_LOCATIONS_COMM = "comment";
    public final static String FIELD_LOCATIONS_RATE = "ratevalue";
    public final static String FIELD_LOCATIONS_LATITUDE = "latitude";
    public final static String FIELD_LOCATIONS_LONGITUDE = "longitude";

    public final static String[] PROJECTION_LOCATIONS = { FIELD_LOCATIONS_ID,
            FIELD_LOCATIONS_NAME, FIELD_LOCATIONS_COMM, FIELD_LOCATIONS_RATE, FIELD_LOCATIONS_LATITUDE,
            FIELD_LOCATIONS_LONGITUDE };

    public LocationDatabase(Context context) {
        super(context, DB_NAME, null, DB_VERSION);
        getWritableDatabase(); // make upgrades work
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL("CREATE TABLE " + TABLE_LOCATIONS + " ( " + 
                FIELD_LOCATIONS_ID + " INTEGER PRIMARY KEY NOT NULL, " + 
                FIELD_LOCATIONS_NAME + " Text, " +

                FIELD_LOCATIONS_COMM + " Text, " +
                FIELD_LOCATIONS_RATE + " REAL, " +
                FIELD_LOCATIONS_LATITUDE + " REAL, "
                + FIELD_LOCATIONS_LONGITUDE + " REAL )");
    }

    @Override
    public void onUpgrade(SQLiteDatabase arg0, int arg1, int arg2) {
    }

    public long createLocation(String name, String comment, Double ratevalue, Double latitude, Double longitude) {
        Log.d(TAG, "Inserting location " + name + comment + ratevalue);
        SQLiteDatabase db = getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(FIELD_LOCATIONS_NAME, name);

        values.put(FIELD_LOCATIONS_COMM, comment);
        values.put(FIELD_LOCATIONS_RATE, ratevalue);
        values.put(FIELD_LOCATIONS_LATITUDE, latitude);
        values.put(FIELD_LOCATIONS_LONGITUDE, longitude);

        long id = db.insert(TABLE_LOCATIONS, null, values);
        Log.d(TAG, Long.toString(id));
        db.close();
        return id;
    }

    public void updateLocation(Long location_id, String name, String comment, Double ratevalue, Double latitude,
            Double longitude) {
        Log.d(TAG, "Updating location");
        SQLiteDatabase db = getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(FIELD_LOCATIONS_NAME, name);

        values.put(FIELD_LOCATIONS_COMM, comment);
        values.put(FIELD_LOCATIONS_RATE, ratevalue);
        values.put(FIELD_LOCATIONS_LATITUDE, latitude);
        values.put(FIELD_LOCATIONS_LONGITUDE, longitude);

        db.update(TABLE_LOCATIONS, values, "_id = ?",
                new String[] { location_id.toString() });
        db.close();
    }

    public Cursor getAllLocations() {
        Log.d(TAG, "Selecting all locations");
        SQLiteDatabase db = getReadableDatabase();
        Cursor c = db.query(TABLE_LOCATIONS, PROJECTION_LOCATIONS, null, null,
                null, null, FIELD_LOCATIONS_NAME);
        Log.d(TAG, Integer.toString(c.getCount()));
        db.close();
        return c;
    }

    public Cursor getLocation(long location_id) {
        Log.d(TAG, "Selecting location " + Long.toString(location_id));
        SQLiteDatabase db = getReadableDatabase();
        Cursor c = db.query(TABLE_LOCATIONS, PROJECTION_LOCATIONS, "_id = ?",
                new String[] { Long.toString(location_id) }, null, null, null);
        Log.d(TAG, Integer.toString(c.getCount()));
        db.close();
        return c;
    }

    public void deleteLocation(long location_id){
        Log.d(TAG, "Deleting location " + Long.toString(location_id));
        SQLiteDatabase db = getWritableDatabase();
        db.delete(TABLE_LOCATIONS, "_id = ?", new String[] {Long.toString(location_id)});
    }
} 
```

4-BestLocationProxy

在布局中我有 location.xml 和 list.xml

1-location.xml

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="311dp"
        android:orientation="vertical"
        android:paddingRight="20dip" >

        <TableLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content">

                <TextView
                    android:text="@string/name"
                    android:gravity="left|center_vertical"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:paddingRight="10dip" />
                <EditText
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:editable="true"

                    android:id="@+id/name"
                    android:singleLine="true"
                    android:layout_weight="1" />

                                <TextView
                    android:text="@string/comment"
                    android:gravity="left|center_vertical"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:paddingRight="10dip" />
                <EditText
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:editable="true"

                    android:id="@+id/comment"
                    android:singleLine="true"
                    android:layout_weight="1" />

                <TextView
                    android:text="@string/Rate"
                    android:gravity="left|center_vertical"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:paddingRight="10dip" />
</TableLayout>

                <RatingBar
                    android:id="@+id/ratingbar"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content" 
                    android:stepSize="1"
                    />

            <TableLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                >
                <TextView
                    android:text="@string/latitude"
                    android:gravity="left|center_vertical"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:paddingRight="10dip" />
                <EditText
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:editable="true"

                    android:id="@+id/latitude"
                    android:singleLine="true"
                    android:layout_weight="1"
                    android:numeric="signed|decimal" />

                <TextView
                    android:text="@string/longitude"
                    android:gravity="left|center_vertical"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:paddingRight="10dip" />
                <EditText
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:editable="true"

                    android:id="@+id/longitude"
                    android:singleLine="true"
                    android:layout_weight="1"
                    android:numeric="signed|decimal" />

        </TableLayout>
        <TableLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content">
        <TableRow>
        <TextView 
            android:text="@string/source" 
            android:gravity="right|center_vertical" 
            android:textAppearance="?android:attr/textAppearanceMedium" 
            android:paddingRight="10dip" /> 
        <TextView android:layout_width="fill_parent" 
            android:layout_height="wrap_content" 
            android:id="@+id/current_source" 
            android:layout_weight="1" 
            android:textAppearance="?android:attr/textAppearanceSmall" /> 
  </TableRow>

            <TableRow>
                <TextView
                    android:text="@string/latitude"
                    android:gravity="right|center_vertical"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:paddingRight="10dip" />
                <TextView
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:id="@+id/current_latitude"
                    android:layout_weight="1"
                    android:textAppearance="?android:attr/textAppearanceSmall" />
            </TableRow>
            <TableRow>
                <TextView
                    android:text="@string/longitude"
                    android:gravity="right|center_vertical"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:paddingRight="10dip" />
                <TextView
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:id="@+id/current_longitude"
                    android:layout_weight="1"
                    android:textAppearance="?android:attr/textAppearanceSmall" />
            </TableRow>
            <TableRow>
                <TextView
                    android:text="@string/accuracy"
                    android:gravity="right|center_vertical"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:paddingRight="10dip" />
                <TextView
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:id="@+id/current_accuracy"
                    android:layout_weight="1"
                    android:textAppearance="?android:attr/textAppearanceSmall" />
            </TableRow>
        </TableLayout>

        <View
            android:layout_width="fill_parent"
            android:background="@android:drawable/divider_horizontal_bright"
            android:layout_marginBottom="10dip"
            android:layout_marginTop="10dip"
            android:layout_height="4dip" />

        <Button
            android:id="@+id/set_location"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/set_location" />

        <Button
            android:id="@+id/close_location_window"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/close" />

    </LinearLayout>
</ScrollView> 
```

2- list.xml

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">
    <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:longClickable="true"
        android:layout_weight="1" />
    <ScrollView
        android:id="@android:id/empty"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:fillViewport="true">
        <TextView
            android:id="@+id/emptyText"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="@string/empty_msg"
            android:textSize="20sp"
            android:textColor="?android:attr/textColorSecondary"
            android:paddingLeft="10dip"
            android:paddingRight="10dip"
            android:paddingTop="10dip"
            android:lineSpacingMultiplier="0.92" />
    </ScrollView>
</LinearLayout> 
```

抱歉……太长了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:50:10.063

我想我明白你在做什么。下面是一个使用 ListView 的 TextFilter 的示例：

```
public class Example extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        LinearLayout layout = new LinearLayout(this);
        ListView list = new ListView(this);
        layout.addView(list);
        setContentView(layout);

        String[] array = {"one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten"};
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, array);
        list.setAdapter(adapter);
        list.setTextFilterEnabled(true);
    }
} 
```

您需要通过长按菜单按钮来打开键盘。

**不幸的是，**此功能完全不足以对来自 CursorAdapter 的结果集进行排序。事实上，当我将 TextFilter 绑定到 SimpleCursorAdapter 时，它甚至没有响应。

**解决方案：**

这是一种基本方法，尝试添加一个 EditText 和一个 Button。假设您想按名称对位置进行排序。当用户单击按钮时，您使用 EditText 中的内容查询数据库，如下所示：

```
db.query(TABLE_LOCATIONS, PROJECTION_LOCATIONS, 
            FIELD_LOCATIONS_NAME " LIKE '%?%'", editTextString,
            null, null, FIELD_LOCATIONS_NAME); 
```

当然`editTextString`是来自EditText的用户输入。现在只需将这个从数据库返回的新光标设置到适配器，如下所示：

```
adapter.changeCursor(newCursor); 
```

您将不得不使用相同的方法来排序，而不仅仅是名称，但这是一般的想法。设计明智，您可以将搜索 EditText 和 Button 移动到 PopUpWindow 中，或者代替 Button，您可以使用 TextWatcher 将每个新字母输入到 EditText 中重新查询数据库；有很多不同的方法。希望有帮助。

# apache-flex - 在桌面上制作 Flex 移动全屏（作为空中应用程序）

> ID：10918703
> 
> 赞同：0
> 
> 时间：2012-06-06T16:58:00.520
> 
> 标签：apache-flex, air, flex4, flex-mobile

我需要让 flex 移动应用程序在桌面操作系统上运行时全屏显示（我已将其打包为 air 应用程序）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:20:51.127

无法在创建完成处理程序上通过 stage.displayState = StageDisplayState.FULL_SCREEN_INTERACTIVE 切换到全屏。它必须通过用户交互来完成。实际上我昨天才这样做。向您的应用程序添加一个按钮并将 onClick 设置为设置全屏并隐藏按钮的功能。反正我就是这样做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:49:24.490

我很确定您的视图会在将主应用程序添加到舞台之前调度它的 creationComplete 事件，这可能就是您收到错误的原因。

过去，我使用过 applicationComplete 事件和 StageDisplayState.FULL_SCREEN。这是我写的一篇旧[博客文章](http://www.jeffryhouser.com/index.cfm/2008/12/11/How-do-I-make-an-AIR-Window-be-always-on-top)。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" alwaysInFront="true"
applicationComplete="onApplicationComplete()">
<mx:Script><![CDATA[

public function onApplicationComplete():void{
this.stage.displayState = StageDisplayState.FULL_SCREEN;
}
]]></mx:Script>
</mx:WindowedApplication> 
```

我看不出为什么这段代码不能在 Flex 4 / Spark 应用程序中运行。

# modx - 使用 getResources 和自定义日期电视，我如何根据在电视中输入的年份限制我的结果？

> ID：10918707
> 
> 赞同：0
> 
> 时间：2012-06-06T16:58:11.287
> 
> 标签：modx, modx-revolution

在 MODx 革命中，在使用 getResources 和自定义日期电视（称为：press-release-date）时，如何按年份限制我的结果（使用 URL 参数设置年份，以便我可以输入任何年份）？

例如，我的 URL 有 page.html?year=2012

我希望 getResources 的结果只包括与那一年相关的结果。我相信我想使用 &where 属性（如果是这样，我肯定会搞砸格式）：

```
&where=`{"press-release-date":[[*press-release-date:strtotime:date=`%Y`]:isequalto:`2012`]}` 
```

我也试过

```
&where=`{[[*press-release-date]]:[[*press-release-date:strtotime:date=`%Y`]:isequalto:`2012`]}` 
```

谢谢！

更新：这是我目前使用的完整代码：

```
[[!getResources?
    &parents=`780,781,782,783,784`
    &tpl=`list-press-tpl`
    &limit=`1000`
    &sortdir=`DESC`
    &includeTVs=`1`
    &includeContent=`1` 
    &depth=`0`
    &showHidden=`1`
    &sortbyTV=`press-release-date`
    &where=`{[[*press-release-date]]:[[*press-release-date:strtotime:date=`%Y`]:isequalto:`2012`]}`
]] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T13:52:18.263

你可以试试`tvFilters`。但是您必须将您的日期格式转换`[[+year]]`为您的`press-release-date`日期格式并在 intertleave 中限制搜索：

```
&tvFilters=`press-release-date>=[[+year:dec:strtotime]]||press-release-date<=[[+year:strtotime]]` 
```

*   [http://rtfm.modx.com/display/revolution20/Input+and+Output+Filters+%28Output+Modifiers%29](http://rtfm.modx.com/display/revolution20/Input+and+Output+Filters+%28Output+Modifiers%29)
*   [http://rtfm.modx.com/display/revolution20/Date+Formats](http://rtfm.modx.com/display/revolution20/Date+Formats)
*   [http://ru2.php.net/strtotime](http://ru2.php.net/strtotime)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T18:41:13.610

您将要使用 &tvFilters 属性：[http](http://rtfm.modx.com/display/ADDON/getResources) ://rtfm.modx.com/display/ADDON/getResources您可能还需要 &includeTVs、&includeTvsList 和~可能~还有 &processTVList。至于如何从 url 中删除 post 值，您可能需要编写一个快速的小片段来获取所有 url 变量并将它们设置为占位符。类似于：

```
foreach($_POST as $key => $value){

$modx->setPlaceholder($key,$value);

} 
```

然后你应该能够访问它们：

```
&where=`{[[*press-release-date]]:[[*press-release-date:strtotime:date=`%Y`]:isequalto:`[[+year]]`]}` 
```

猜测...未经测试。:)

# ios - 数学/OpenGL ES：绘制不同宽度的 3D 贝塞尔曲线

> ID：10918715
> 
> 赞同：3
> 
> 时间：2012-06-06T16:58:51.980
> 
> 标签：ios, math, opengl-es-2.0

我已经解决了几个星期的问题，并且已经达到了一个点，我想确保我没有使我的方法过于复杂。这是在 iOS 上的 OpenGL ES 2.0 中完成的，但原理是通用的，所以我不介意答案是纯粹的数学形式。这是纲要。

我在 3D 空间中有 2 个点以及一个控制点，用于生成具有以下等式的贝塞尔曲线：

**B(t) = (1 - t) ² P [0] + 2(1 - t)tP [1] + t ² P [2]**

起点/终点位于相当大的球体上的动态坐标上，因此 x/y/z 变化很大，使得静态解决方案不太实用。我目前正在使用 GL_LINE_STRIP 渲染这些点。下一步是使用 GL_TRIANGLE_STRIP 渲染曲线并控制相对于高度的宽度。

根据这个[快速讨论](https://stackoverflow.com/questions/3076140/thick-bezier-curves-in-opengl)，解决我的问题的一个好方法是在考虑到它的方向的情况下找到与曲线两侧平行的点。我想总共创建 3 条曲线，传入索引以创建不同宽度的贝塞尔曲线，然后绘制它。

还有关于[插值](https://stackoverflow.com/questions/313297/simple-way-to-interpolate-between-points-in-3d-space-to-form-a-smooth-surface)和使用[Loop-Blinn 技术](https://stackoverflow.com/questions/5533945/is-it-possible-to-thicken-a-quadratic-bezier-curve-using-the-gpu-only)的讨论，这似乎解决了他们各自问题的具体问题。但是，我相信解决方案对于我所追求的而言可能过于复杂。我也不感兴趣将纹理融入其中。我更喜欢使用稍后在我的着色器中计算的颜色来绘制三角形。

因此，在我进一步阅读 Trilinear Interpolation、Catmull-Rom splines、Loop-Blinn 论文或进一步探索采样之前，我想确定哪个方向最有可能是最好的选择。我想我可以说最基本形式的问题是在 3D 空间中取一个点，并在它旁边找到两个平行点，考虑到下一个点将被绘制的方向。

感谢您抽出宝贵时间，如果我能提供更多信息，请告诉我，我会尽力添加。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:41:49.833

这个答案（据我所知）不赞成您在问题中提到的一种方法，但这是我在这种情况下会做的。

我会计算曲线的归一化法线（或副法线）。假设我采用标准化法线并将其作为 t ( `N(t)`) 的函数。有了这个我会写一个辅助函数来计算偏移点P：

```
P(t, o) = B(t) + o * N(t) 
```

其中`o`表示曲线在法线方向上的有符号偏移。

给定这个函数，只需通过以下方式计算曲线左侧和右侧的点：

```
Points = [P(t, -w), P(t, w), P(t + s, -w), P(t + s, w)] 
```

`w`您想要达到的曲线宽度在哪里。

然后通过两个三角形连接这些点。

对于在三角形带中使用，这意味着索引：

```
0 1 2 3 
```

**编辑**

要对曲线做一些工作，通常会计算 Frenet 框架。

这是一组 3 个向量（Tangent、Normal、Binormal），在给定参数值 (t) 处给出曲线的方向。

Frenet 框架由下式给出：

```
unit tangent = B'(t) / || B'(t) ||
unit binormal = (B'(t) x B''(t)) / || B'(t) x B''(t) ||
unit normal = unit binormal x unit tangent 
```

在此示例`x`中，表示两个向量的叉积，表示`|| v ||`封闭向量的长度（或范数）`v`。

如您所见，您需要曲线的一阶 ( `B'(t)`) 和二阶 ( `B''(t)`) 导数。

# mysql - 比较两个大致相等的数字

> ID：10918716
> 
> 赞同：8
> 
> 时间：2012-06-06T16:58:54.657
> 
> 标签：mysql, sql

我有两个表，表 A 和表 B。每个表都有两个属性 L1 和 L2。我正在尝试输出两个表的所有行，其中两个表的 L1 和 L2 相等。问题是 L1 和 L2 可能与我的少量不同。所以当我运行时：

```
SELECT * FROM TableA l1 join TableB l2 on l1.L1 =l2.L1 and l1.L2 = l2.L2 
```

即使有匹配的记录，我也会得到一个空集。我该如何解决这个问题？

例子：

L1 = 118.4363 对于表 A 但对于表 B L1 = 118.445428

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-06T17:01:09.077

不是检查相等，而是检查差异是否低于某个阈值（例如，0.1，如下例所示）。

```
SELECT * FROM 
    TableA l1, TableB l2 
WHERE 
    ABS(l1.L1-l2.L1) < 0.1 
    AND
    ABS(l1.L2-l2.L2) < 0.1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-06T17:01:21.920

您将需要设计一些公差，例如 0.01 的差异。然后在减去时计算两者的绝对值，看看它是否在您的公差范围内

```
SET @tolerance_value = 0.01;
SELECT * 
FROM 
  TableA l1 join 
  TableB l2 
     on ABS(l1.L1 - l2.L1) < @tolerance_value and ABS(l1.L2 - l2.L2) < @tolerance_value; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T17:04:04.560

您不能要求引擎退回“少量”不同的引擎。

您可以选择差异“abs(a - b)”在两个固定值之间的行。

就像**ab > 5**或**a - b > x** *和* **a - b < x+10**的行。例如

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T17:52:29.743

尝试在 Sybase 或 SQL Server 中使用 round 函数，使 118 与 118 匹配。对于其他 DBMS，找到等效的 round。

麦克风

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-03T19:01:39.373

为了使@cheeken 的回答起作用，您必须在最后一个查询中加上分号，否则它将不起作用：

```
SELECT * FROM 
    TableA l1, TableB l2 
WHERE 
    ABS(l1.L1-l2.L1) < 0.1 
    AND
    ABS(l1.L2-l2.L2) < 0.1; 
```

# android - 使用 Android 4.0 的 ActionBar 兼容版本

> ID：10918717
> 
> 赞同：0
> 
> 时间：2012-06-06T16:58:57.497
> 
> 标签：android, android-actionbar

我遵循了[ActionBar 兼容版本中的代码](http://developer.android.com/resources/samples/ActionBarCompat/index.html)

当我使用 API 级别 10 或更低级别的代码时，它会显示一个 ActionBar，但当我将其用于 API 级别 11 或更高级别时，它不会显示徽标图标和操作项。

我检查了课程，我明白了：

ActionBarHelperBase ：API 级别 10 或更低。

ActionBarHelperHoneycomb ：API 级别 11 或更高。

ActionBarHelperICS ：API 级别 14 或更高。

修复适用于 Android 3.0 或更高版本的 ActionBar 的最佳方法是什么？特别是安卓4.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T00:36:19.993

问题出在清单文件中。我应该`android:theme="@style/Theme.ThemeCompabilityVersion` 从清单文件中删除。

然后我需要在 OnCreate() 方法中检查代码中的版本，例如：

```
private void setTheme() {
    if (Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB) 
        setTheme(R.style.ThemeCompabilityVersion);
    else 
        setTheme(R.style.AppTheme);         
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:06:22.757

有一个名为[ActionBarSherlock](http://actionbarsherlock.com/)的令人难以置信的项目，它允许在 2.X 以上的 API 中使用所有 ActionBar 功能

它会带你一个示例项目来理解和设置依赖关系，它会解决你的很多问题:) 只需调用 getSupportActionBar() 并且所有方法都可用。

我犯的一些常见错误是没有正确设置主题。

```
<style name="Theme.Styled" parent="Theme.Sherlock.Light.DarkActionBar">
<item name="actionBarStyle">@style/Widget.Styled.ActionBar</item>
<item name="android:actionBarStyle">@style/Widget.Styled.ActionBar</item>
</style>

<style name="Widget.Styled.ActionBar" parent="Widget.Sherlock.Light.ActionBar.Solid.Inverse">
<item name="background">@drawable/bg_striped</item>
<item name="android:background">@drawable/bg_striped</item>

<item name="backgroundSplit">@drawable/bg_striped_split</item>
<item name="android:backgroundSplit">@drawable/bg_striped_split</item> 
```

然后，您必须将该主题应用于将支持 ActionBar 的每个活动或应用程序标记。

```
<application android:icon="@drawable/icon" 
             android:label="@string/app_name" 
             android:name=".ApplicationClass"
             android:theme="@style/Theme.Styled"> 
```

您还可以设置一个 menu.xml，其中包含 Bar 上的项目：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
<item android:id="@+id/menu_save"
      android:icon="@drawable/ic_launcher"
      android:title="TestMe"
      android:menuCategory="system"
      android:showAsAction="never" />
<item android:id="@+id/menu_launch"
      android:icon="@drawable/ic_launcher"
      android:title="Test2"
      android:menuCategory="secondary"
      android:showAsAction="never" />
<item android:id="@+id/menu_go"
      android:icon="@drawable/ic_launcher"
      android:title="Test"
      android:showAsAction="always|withText" />
</menu> 
```

我学到的最有趣的事情是每个活动或片段都可以将他们的动作放在栏上，所以如果片段是可搜索的，则可以设置带有放大镜图标的选项等。

它在以前的版本中存在片段问题，在当前版本中似乎已解决，如果需要，我可以使用[RoboGuice](http://code.google.com/p/roboguice/)和片段支持设置一些示例代码。

希望它有所帮助，问候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T19:00:24.663

你有设置你`targetSdkVersion`的`11`或更高的吗？您可以保持较低`minSdkVersion`的 ，例如：

```
<uses-sdk
    android:minSdkVersion="7"
    android:targetSdkVersion="15" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T17:05:08.633

强烈推荐 ActionbarSherlock，它是一个更完整、更高级的兼容性版本。如果在具有等的 android 版本上运行，它使用本机操作栏。

[actionbarsherlock.com](http://actionbarsherlock.com)

# entity-framework - Entity Framework 4.3.1 到 5.0 RC - 模型创建期间出现 NullReferenceException

> ID：10918721
> 
> 赞同：2
> 
> 时间：2012-06-06T16:59:32.777
> 
> 标签：entity-framework, entity-framework-5

我刚刚切换我们的项目以尝试在 .NET 4.0 下运行的 Entity Framework 5.0 RC。除了更新命名空间引用之外，我们没有进行任何代码更改。当我们第一次尝试访问实体框架对象时，我得到以下信息：

```
 at System.Data.Entity.ModelConfiguration.Conventions.ForeignKeyNavigationPropertyAttributeConvention.System.Data.Entity.ModelConfiguration.Conventions.IEdmConvention<System.Data.Entity.Edm.EdmNavigationProperty>.Apply(EdmNavigationProperty navigationProperty, EdmModel model)
   at System.Data.Entity.ModelConfiguration.Configuration.ConventionsConfiguration.EdmConventionDispatcher.Dispatch[TEdmDataModelItem](TEdmDataModelItem item)
   at System.Data.Entity.ModelConfiguration.Configuration.ConventionsConfiguration.EdmConventionDispatcher.VisitEdmNavigationProperty(EdmNavigationProperty item)
   at System.Data.Entity.Edm.Internal.DataModelItemVisitor.VisitCollection[T](IEnumerable`1 collection, Action`1 visitMethod)
   at System.Data.Entity.Edm.Internal.EdmModelVisitor.VisitDeclaredNavigationProperties(EdmEntityType entityType, IEnumerable`1 navigationProperties)
   at System.Data.Entity.ModelConfiguration.Configuration.ConventionsConfiguration.EdmConventionDispatcher.VisitEdmEntityType(EdmEntityType item)
   at System.Data.Entity.Edm.Internal.DataModelItemVisitor.VisitCollection[T](IEnumerable`1 collection, Action`1 visitMethod)
   at System.Data.Entity.Edm.Internal.EdmModelVisitor.VisitEntityTypes(EdmNamespace edmNamespace, IEnumerable`1 entityTypes)
   at System.Data.Entity.Edm.Internal.EdmModelVisitor.VisitEdmNamespace(EdmNamespace item)
   at System.Data.Entity.ModelConfiguration.Configuration.ConventionsConfiguration.EdmConventionDispatcher.VisitEdmNamespace(EdmNamespace item)
   at System.Data.Entity.Edm.Internal.DataModelItemVisitor.VisitCollection[T](IEnumerable`1 collection, Action`1 visitMethod)
   at System.Data.Entity.Edm.Internal.EdmModelVisitor.VisitNamespaces(EdmModel model, IEnumerable`1 namespaces)
   at System.Data.Entity.Edm.Internal.EdmModelVisitor.VisitEdmModel(EdmModel item)
   at System.Data.Entity.ModelConfiguration.Configuration.ConventionsConfiguration.EdmConventionDispatcher.VisitEdmModel(EdmModel item)
   at System.Data.Entity.ModelConfiguration.Configuration.ConventionsConfiguration.EdmConventionDispatcher.Dispatch()
   at System.Data.Entity.ModelConfiguration.Configuration.ConventionsConfiguration.ApplyModel(EdmModel model)
   at System.Data.Entity.DbModelBuilder.Build(DbProviderManifest providerManifest, DbProviderInfo providerInfo)
   at System.Data.Entity.DbModelBuilder.Build(DbConnection providerConnection)
   at System.Data.Entity.Internal.LazyInternalContext.CreateModel(LazyInternalContext internalContext)
   at System.Data.Entity.Internal.RetryLazy`2.GetValue(TInput input)
   at System.Data.Entity.Internal.LazyInternalContext.InitializeContext()
   at System.Data.Entity.Internal.InternalContext.Initialize()
   at System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType)
   at System.Data.Entity.Internal.Linq.InternalSet`1.Initialize()
   at System.Data.Entity.Internal.Linq.InternalSet`1.get_InternalContext()
   at System.Data.Entity.Infrastructure.DbQuery`1.System.Linq.IQueryable.get_Provider()
   at System.Linq.Queryable.FirstOrDefault[TSource](IQueryable`1 source, Expression`1 predicate)
   at BackEnd.Facade.Implementations.UserService.GetUserByUserName(String userName) in c:\Development\FundApps\Rapptr\src\FundApps.Rapptr.ServiceLayer\Facade\Implementations\UserService.cs:line 61
   at FundApps.Rapptr.Common.Web.Security.WebUserContextModule.OnPostAuthenticateRequest(HttpContextBase context) in c:\Development\FundApps\Rapptr\src\FundApps.Rapptr.Common.Web\Security\WebUserContextModule.cs:line 54
   at FundApps.Common.Mvc.BaseHttpModule.<Init>b__1(Object sender, EventArgs e) in c:\Development\FundApps\Rapptr\src\FundApps.Common.Mvc\BaseHttpModule.cs:line 14
   at System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

有没有人对可能导致此问题的原因以及如何缩小范围有任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T19:33:52.383

更新：此错误已在 EF5 RTM 中修复。

这是 EF5 中的一个错误。当您具有 1:1 关系并且还使用该`ForeignKey`属性显式指定 FK 时，就会发生这种情况。例如：

```
public class OneToOneResult
{
    public int OneToOneResultId { get; set; }

    [ForeignKey("OneToOneResultId")]
    public virtual OneToOneResultDetail Detail { get; set; }
}

public class OneToOneResultDetail
{
   [Key]
   public int OneToOneResultId { get; set; }
   public DateTime DataDate { get; set; }
} 
```

在 OnModelCreating 中：

```
modelBuilder.Entity<OneToOneResult>()
   .HasRequired(r => r.Detail)
   .WithRequiredPrincipal(); 
```

解决方法是删除该`ForeignKey`属性。在这种情况下不需要它，因为 1:1 关系必须是 PK 到 PK，因为这就是 EF 在这种情况下所支持的全部。

# django - 添加新应用并安装南时如何同步数据库？

> ID：10918725
> 
> 赞同：0
> 
> 时间：2012-06-06T16:59:49.437
> 
> 标签：django, django-south

我有一个安装了 South 的 Django 应用程序。我在我的`INSTALLED_APPS`. 现在，当我运行 python 时，`manage.py` `syncdb`我得到：

```
$ python manage.py syncdb
Syncing...
Creating tables ...
Installing custom SQL ...
Installing indexes ...
No fixtures found.

Synced:
 > django.contrib.auth
 > django.contrib.contenttypes
 > django.contrib.sessions
 > django.contrib.sites
 > django.contrib.admin
 > south

Not synced (use migrations):
 - myapp
 - guardian 
```

并尝试迁移返回：

```
Nothing seems to have changed. 
```

有没有办法使用原始的syncdb，而不是南方的？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T17:22:33.647

你在跑步`manage.py migrate guardian`吗？

*“似乎没有任何改变”*看起来像 running 的输出`manage.py schemamigration`，它不会创建任何表开始......

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-06T17:18:24.400

您可以从 INSTALLED_APPS 中删除“south”，然后运行 ​​syncdb，最后，再次将“south”添加到 INSTALLED_APPS。

# javascript - 更改 Javascript 中的复选框颜色

> ID：10918737
> 
> 赞同：0
> 
> 时间：2012-06-06T17:00:16.290
> 
> 标签：javascript, html, css, styles

```
<!DOCTYPE html>
<html>
<body>

<form action="form_action.asp" method="get">
  <span style='background-color: red;'>
    <input style="FILTER: progid:DXImageTransform.Microsoft.Alpha( style=0,opacity=50);" type="checkbox" name="vehicle" value="Bike" /></span>I have a bike<br />

  <span style='background-color: red;'>
    <input style="-moz-opacity:0.5" type="checkbox" name="vehicle" value="Car" /></span> I have a car <br />
  <input type="submit" value="Submit" />
</form>

<p>Click on the submit button, and the input will be sent to a page on the server called "form_action.asp".</p>

</body>
</html> 
```

我在网上找到了一些示例并将其拼凑在一起，顶部输入复选框应该适用于 ie，底部适用于 FF 和 chrome。两者都不好用。IE 看起来很草率，FF 和 chrome 似乎根本不起作用。我试图找出一个复选框列表，其中一些是根据以前的选择被禁用的。我让它适用于大多数浏览器，但有些浏览器不会将框变灰。

所以，我需要弄清楚如何使用 javascript 使这些框变灰。这似乎不起作用，`document.getelementbyid(elementID).style.background = "#dbdbdb";`只是勾勒出框。

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:08:07.327

您的清单不需要可点击？

在某些浏览器中禁用它作为简单的解决方案，然后增加其他浏览器的不透明度：

```
document.getElementById(elementID).disabled="disabled";
document.getElementById(elementID).style.opacity="0.5"; 
```

那是假设您的背景是黑色的……可能不是。

否则获取复选框的 x,y 位置：

```
function getOffset( el ) {
    var _x = 0;
    var _y = 0;
    while( el && !isNaN( el.offsetLeft ) && !isNaN( el.offsetTop ) ) {
        _x += el.offsetLeft - el.scrollLeft;
        _y += el.offsetTop - el.scrollTop;
        el = el.offsetParent;
    }
    return { top: _y, left: _x };
}
var x = getOffset( document.getElementById('yourElId') ).left; 
```

然后在复选框前面创建一个具有更高 z-index 和绝对定位的不透明度黑色 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:05:01.787

如果它们被禁用，那么您应该使用复选框中内置的“禁用”属性。这将禁用它们并赋予它们禁用的外观。

# c++ - 如何使用顶点的测地距离平滑骨骼顶点权重？

> ID：10918741
> 
> 赞同：4
> 
> 时间：2012-06-06T17:00:33.457
> 
> 标签：c++, algorithm

我目前正在研究一种实现骨骼顶点权重（关节变形的皮肤权重）平滑的方法，并且在用户设置的参数距离内使用顶点之间的测地线（表面）距离的方法上空无一物。
到目前为止，有人提到可能使用 Dijkstra 算法来获得近似测地线距离 - 但它对某些类型的网格拓扑有限制。
我在这个问题上找到的唯一一篇论文（所谓的“骨骼顶点权重平滑”）在蒙皮网格上使用拉普拉斯平滑权重，但它只考虑每个顶点的单环相邻顶点，这不满足我的需要包括一个距离（最短测地距离）的顶点：

```
L(Wi) = 1/m * Sum(j from 0 to m-1)(Wj - Wi) 
```

其中 vertex`i`和`j`是相对于 vertex 考虑的`i`，`m`是相邻顶点的数量，并且`W`是顶点上的权重。

我所设想的是一种改进的拉普拉斯平滑，其中使用了所有发现在参数距离内的顶点，但距离也需要是一个因素。也许只是将权重影响乘以参数距离减去当前顶点与总和中使用的顶点之间的距离。像这样的东西，也许：

```
Wmj = Wj * (maxDistance - Dji)

L(Wi) = 1/m * Sum(j from 0 to m-1)(Wmj - Wi) 
```

这样平滑的影响`Wj`会减少（衰减）其顶点距离（`Dji`）。当然，随意的顶点`maxDistance`没有影响，可能需要作为`m`.

这行得通吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T20:41:01.053

我想到的第一个想法是投影。首先获取代表起点和终点之间欧几里得距离的线（穿过网格）。然后将其投影到网格上。但我意识到这在某些情况下是行不通的。为了其他人的利益，这样的一种情况是，如果起点是深坑的一侧，而目标在另一侧，那么最短的距离将是在篮筐周围，而不是直通。这对您来说可能仍然足够，具体取决于您正在使用的网格类型，因此如果这对您来说足够好，我可以沿着这些思路详细说明更完整的方法。

所以我的想法是细分然后使用搜索。我会使用自适应细分，即分割边缘，直到所有边缘都小于某个阈值。从那时起，您可以使用 Dijkstra 或 A* 或任何其他数量的搜索方法。这解决了窄三角形的问题，因为边会被细分直到它们变小，所以不会有长而窄的边。

# image - 如何测量验证码强度

> ID：10918747
> 
> 赞同：-1
> 
> 时间：2012-06-06T17:01:11.490
> 
> 标签：image, image-processing, ocr, captcha

我开发了一个验证码生成器并想测量它的强度。然后我用 Adob​​e Acrobat 的 OCR 测试了很多易于阅读的内容，但它们都无法重新识别单个字符。

我能说它够强吗？如果没有，我该如何测试或测量它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T19:20:31.417

好的，认真的回答。

任何防御系统的最大问题是“我创建了一个我无法破解的代码 - 因此它必须是安全的”态度。

最好的通用 OCR 包通常是 Google 的[tesseract](http://code.google.com/p/tesseract-ocr/)，但这并不意味着它在验证码方面是最好的。我确信在互联网的黑暗角落有很多验证码破解工具 - 你可能需要付出一些努力才能找到它们。

你真正需要的是让潜在的敌人测试它。这就是为什么要发布加密算法以及一系列专家和学者试图破解它们的原因。问题是你需要激励别人为你做这件事。
这样做的最佳方式可能是为打破它提供某种奖励，无论是现金还是名望。这种方法的问题在于，如果验证码是为了保护具有任何实际价值的东西——破坏它和利用它的经济回报超过了你能负担得起的赏金。

# perl - Perl在文件中的读写

> ID：10918750
> 
> 赞同：2
> 
> 时间：2012-06-06T17:01:20.673
> 
> 标签：perl

好吧，所以我又回来了另一个问题。我知道在 Python 中有一种读取文件的方法，而无需指定它将是哪个文件，直到您进入命令提示符。所以基本上你可以设置脚本，这样你就可以读取任何你想要的文件，而不必每次都返回并更改编码。有没有办法在 Perl 中做到这一点？如果是这样，你也可以写这样的文件吗？谢谢。

这就是我所拥有的：

```
open (LOGFILE, "UNSUCCESSFULOUTPUT.txt") or die "Can't find file";       
open FILE, ">", "output.txt" or die $!;

while(<LOGFILE>){
print FILE "ERROR in line $.\n" if (/Error/);
}

close FILE;
close LOGFILE; 
```

这就是我的名字：

```
#!/usr/local/bin/perl

my $argument1 = $ARGV[0];
open (LOGFILE, "<$argument1") or die "Can't find file";     

open FILE, ">>output.txt" or die $!;

while(<LOGFILE>){
print FILE "ERROR in line $.\n" if (/Error/);
}

close FILE;
close LOGFILE; 
```

它仍然没有附加......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T17:05:43.210

命令行参数在[`@ARGV`](http://perldoc.perl.org/perlvar.html#@ARGV). 您可以随心所欲地使用它们，包括将它们作为文件名传递给`open`.

```
my ($in_qfn, $out_qfn) = @ARGV;
open(my $in_fh,  '<', $in_qfn ) or die $!;
open(my $out_fh, '>', $out_qfn) or die $!;
print $out_fh $_ while <$in_fh>; 
```

但这不是一种非常统一的做事方式。在 unix 传统中，将从命令行上指定的每个文件读取以下内容，一次一行：

```
while (<>) {
    ...
} 
```

输出通常通过重定向放置在文件中。

```
#!/usr/bin/env perl
# This is mycat.pl
print while <>;

# Example usage.
mycat.pl foo bar > baz

# Edit foo in-place.
perl -i mycat.pl foo 
```

通常唯一接触`@ARGV`的是处理选项，即便如此，人们通常使用[Getopt::Long](http://search.cpan.org/perldoc?Getopt%3a%3aLong)而不是直接接触`@ARGV`。

* * *

关于您的代码，您的脚本应该是：

```
#!/usr/bin/env perl
while (<>) {
   print "ERROR in line $.\n" if /Error/;
} 
```

用法：

```
perl script.pl UNSUCCESSFULOUTPUT.txt >output.txt 
```

如果您制作可执行文件（） ，则可以摆脱`perl`该命令。`script.pl``chmod u+x script.pl`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T17:06:25.870

我假设您在问如何将参数传递给 perl 脚本。这是通过[`@ARGV`变量完成的。](http://perldoc.perl.org/perlvar.html#@ARGV)

```
use strict;
use warnings;

my $file = shift;   # implicitly shifts from @ARGV
print "The file is: $file\n"; 
```

您还可以利用菱形运算符的魔力`<>`，它将脚本的参数作为文件打开，或者如果没有提供参数，则使用 STDIN。菱形运算符用作普通文件句柄，通常`while (<>) ...`

**预计到达时间：**

使用您提供的代码，您可以通过执行以下操作使其更加灵活：

```
use strict;
use warnings;  # always use these
my $file    = shift;                 # first argument, required
my $outfile = shift // "output.txt"; # second argument, optional

open my $log, "<", $file    or die $!;
open my $out, ">", $outfile or die $!;

while (<$log>) {
    print $out "ERROR in line $.\n" if (/Error/);
} 
```

另请参阅 ikegami 的回答，了解如何使其更像其他 unix 工具，例如接受 STDIN 或文件参数，并打印到 STDOUT。

正如我在您之前的问题中所评论的那样，您可能只是希望使用已经存在的工具来完成这项工作：

```
grep -n Error input.txt > output.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T17:31:12.313

这就是我相信你想要的：

```
#!usr/bin/perl
my $argument1 = $ARGV[0];

open (LOGFILE, "<$argument1") or die "Can't find file";       
open (FILE, ">output.txt") or die $!;

while(<LOGFILE>){
print FILE "ERROR in line $.\n" if (/Error/);
}

close FILE;
close LOGFILE; 
```

从命令行运行：

```
> perl nameofpl.pl mytxt.txt 
```

对于附加更改此行：

```
 open (FILE, ">output.txt") or die $!; 
```

与非常相似的：

```
 open (FILE, ">>output.txt") or die $!; 
```

# asp.net - 是否可以在 appSettings 键中使用 & 符号？错误：未定义 web.config 值

> ID：10918753
> 
> 赞同：22
> 
> 时间：2012-06-06T17:01:29.890
> 
> 标签：asp.net, appsettings

我有以下 appSettings 部分

```
<appSettings>
  <add key="Foo" value="http://foo.bar.com/?app=xxx&FormName=yyy" />
</appSettings> 
```

但是 IDE 给了我两个错误：

1.  错误 25 实体 'FormName' 未定义。
2.  错误 26 应为“;”。

似乎**&**引起了问题。我不想将值拆分成单独的键。有没有解决这个问题的优雅方法？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-06-06T17:03:16.253

我相信你只需要在这里使用 XML 编码 - 所以`&`变成`&amp;`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-06T17:04:29.637

```
Try &amp;

<appSettings>
  <add key="Foo" value="http://foo.bar.com/?app=xxx&amp;FormName=yyy" />
</appSettings> 
```

# bash - 使用 tar - --listed-incremental -g 创建增量备份

> ID：10918756
> 
> 赞同：3
> 
> 时间：2012-06-06T17:01:35.367
> 
> 标签：bash, backup, tar

我对 tar linux 程序有疑问。我想创建一个增量备份。我使用以下 tar 命令进行第一次完整备份：

```
tar --create --gzip --listed-incremental=$SAVEDIR/backup.snar --file=$SAVEDIR/$DATE.tar.gz $EXCLUDE $DIRECTORY 
```

`$EXCLUDE`包含 例如`"--exclude test/testdir --exclude test/testdir2"` `$DIRECTORY`包含`"-C /Users/user1/Desktop/ test"`

如果我执行命令，我会收到以下错误：

```
tar: Option --listed-incremental=/Users/hofmeister/Desktop/test/backup.snar is not supported
Usage:
  List:    tar -tf <archive-filename>
  Extract: tar -xf <archive-filename>
  Create:  tar -cf <archive-filename> [filenames...]
  Help:    tar –help 
```

如果我将`--listed-incremental`选项更改为`-g =$SAVEDIR/backup.snar`. 我得到：

```
Usage:
  List:    tar -tf <archive-filename>
  Extract: tar -xf <archive-filename>
  Create:  tar -cf <archive-filename> [filenames...]
  Help:    tar --help 
```

什么地方出了错？我使用以下版本的 tar：`bsdtar 2.8.3 - libarchive 2.8.3`

问题是 tar 版本是 bsd。使用 macports，您可以安装 gnutar。在这里一切正常！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T17:10:01.270

看起来你正在使用`bsdtar`，而不是 gnu `tar`。 `bsdtar`不支持增量备份。它们的标志也略有不同。

# php - JQgrid 如何根据服务器数据更改行的背景颜色？

> ID：10918760
> 
> 赞同：2
> 
> 时间：2012-06-06T17:01:55.973
> 
> 标签：php, jquery, jqgrid, background, row

我正在尝试根据从 SQL 查询返回的数据更改多行的背景颜色。我使用 JSON 作为我的数据类型，并尝试使用 loadComplete 来遍历网格并通过在加载网格后添加一个 css 类来为行着色。这可行，但我返回了 1000 行，这种方法大大减慢了网格的加载速度。用户必须等待很长时间才能最终加载网格。

我没有尝试使用客户格式化程序为行着色，因为我被告知当触发客户格式化程序时网格将不可用，所以会出现错误？我已经看到有关设置超时时间的文档，因此网格在 DOM 中可供客户格式化程序使用，但这听起来会减慢网格的加载速度，这是我试图避免的。

理想情况下，我想在服务器调用（PHP）期间根据表数据为该行分配一个类，然后当在客户端加载网格时，它会根据 CSS 样式为该行着色。似乎在服务器端分配一个类是最有效的方法，所以我不必多次循环数据或多次绘制网格？有哪些其他技术可用于执行此操作？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:36:53.183

做你想做的最好的方法是使用`rowattr`. 我在[答案](https://stackoverflow.com/a/10531680/315935)中准确描述了您的需求。在更旧的版本中，您将不得不像更旧的[答案](https://stackoverflow.com/a/6575634/315935)中描述的那样进行迭代，并将类设置为某些行。

最重要的是要了解页面上一个元素的每次更改都会重新计算页面上存在的**所有**其他元素的位置。最少需要做的是回流（见[这里](https://developers.google.com/speed/articles/reflow)）。`gridview: true`在jqGrid的使用选项的情况下，网格体的*所有*行都将首先创建为字符串，然后通过**一个**操作（类似于分配`innerHTML`属性）放置在页面上。在使用大量行而不分页的情况下，它可以显着提高性能。如果您使用自定义格式化程序，`cellattr`或者`rowattr`您可以自定义构建网格体的默认过程，而不会有任何性能劣势。

自定义格式化程序的使用通常是正确的，但问题是您必须为每一列定义格式化程序。此外，如果您想使用许多不同类型的列（复选框、数字、货币），自定义格式化程序的使用并不好，因为您将不得不再实现一次所有格式化程序或从自定义格式化程序调用预定义格式化程序，这会产生很大的影响不需要的代码。

的用法`cellattr`更好（参见[此处](https://stackoverflow.com/a/5281391/315935)、[此处](https://stackoverflow.com/a/8774139/315935)或[此处](https://stackoverflow.com/a/8022860/315935)），但您必须设置**所有**`class`单元格（列）的属性，而不是仅设置行（）的属性。**`class``<tr>`**

 **因此，我找到了最好的使用方法，`rowattr`就像我在回答开头所建议的那样。在[答案中](https://stackoverflow.com/a/10531680/315935)，您将准确找到所需的内容。**

# mysql - MySQL通过多对多关系计算帖子对之间的共同用户

> ID：10918762
> 
> 赞同：0
> 
> 时间：2012-06-06T17:02:04.087
> 
> 标签：mysql

我有一个带有 3 个表的 MySQL 数据库：users、posts 和 users_posts。用户与帖子的关系是多对多的。如何获取所有帖子对的列表以及它们有多少共同用户？它本质上给了我一个帖子列表以及有多少用户对这两个帖子发表了评论。关键是准备好将数据导入网络分析软件。结果列表在网络术语中称为“边缘列表”，用户的共同点是边缘权重。

架构：

```
users
id
name

posts
id
title
body

users_posts
user_id
post_id 
```

期望的输出：

```
postname1         postname2     users_in_common
Here's a title    Title #2      2
Another post      Title #2      11 
```

我尝试了搜索，但在多对多、连接、三张表、计数、配对、共享等中什至不知道正确的搜索词。感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:36:05.963

`0`我的查询会生成所有帖子对，包括那些没有普通用户的帖子（在`users_in_common`这种情况下会有）。[在SQL Fiddle](http://sqlfiddle.com/#!2/df599/1)上尝试我的解决方案或查看代码：

```
select
    p1.title as postname1,
    p2.title as postname2,
    coalesce(s.users_in_common, 0) as users_in_common
from posts p1
    inner join posts p2 on p1.id < p2.id
    left join (
        select
            up1.post_id as post1_id,
            up2.post_id as post2_id,
            count(*) as users_in_common
        from users_posts up1, users_posts up2
        where up1.user_id = up2.user_id
            and up1.post_id < up2.post_id
        group by up1.post_id, up2.post_id
    ) s
    on (s.post1_id = p1.id and s.post2_id = p2.id)
order by p1.id, p2.id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:20:10.810

试试这个

```
select
  p1.title as postname1,
  p2.title as postname2,
  (select count(*) from user_posts up where up.post_id in (p1.post_id, p2.post_id) as users_in_common
from
  posts p1, posts p2 
```

# java - 在 Java 中在静态块中创建对象的优缺点是什么？

> ID：10918766
> 
> 赞同：0
> 
> 时间：2012-06-06T17:02:49.930
> 
> 标签：java, singleton, instantiation, static-block

这个问题对于一些 Java 专家来说可能是错误的。但我想知道为什么我们在像 main 这样的静态方法中创建对象，而不是在静态块中。我知道如果我们在静态块中实例化并且当然如果我们不进一步使用它，它将不必要地创建对象。这种方法还有其他需要注意的地方吗？我们可以将其与单例模式联系起来吗？

例如：

```
public class MyClass {

    static {
        AnotherClass object = new AnotherClass();
            // Do Some operations here with object.
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:47:47.823

主要原因是控制它何时实际执行。静态块中的内容将在第一次加载类时执行，并且很容易意外地导致类被加载（例如通过引用类上的常量）。

拥有静态方法意味着您可以完全控制何时调用该方法（因为您必须显式调用它）。

关于单例，热加载单例的 java 习惯用法将实例初始化为静态字段。这将基本上与静态块一样运行。

```
public class Singleton {
    private static final Singleton instance = new Singleton();

    private Singleton() {}

    public static Singleton getInstance() {
        return instance;
    }
} 
```

# java - 如何在画布上绘制画布

> ID：10918773
> 
> 赞同：1
> 
> 时间：2012-06-06T17:03:04.173
> 
> 标签：java, android, android-canvas

我正在构建一个 android 应用程序，但我遇到了一件简单的事情：如何将 Canvas 对象绘制（或“添加”）到另一个 Canvas 对象，例如“合并”它们？

如果那不可能，那么最好的解决方案是什么？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T20:05:00.227

这完全取决于您的实施。

*   如果每个 Canvas 直接从每个帧的数组（形状等）中绘制对象，您可以简单地将一个数组附加到另​​一个数组。这样，您的 Canvas 不需要彻底改变，只需将一个数组添加到另一个数组（可能是`ArrayList`这里的方式）。

*   如果不是上述情况，您可能需要进行一些更剧烈的更改。当我遇到类似的问题时，我创建了一个名为 的新方法`commitChanges()`，它为现有的 Canvas 添加了一系列更改（在顶部添加线条等）。

    1.  我首先使受影响的区域无效，然后创建了一个具有 Canvas: 大小的位图`Bitmap bmp = Bitmap.createBitmap(width, height, Bitmap.Config.RGBA_8888);`。
    2.  接下来，我从该位图创建了一个画布：`Canvas workingDrawing = new Canvas(bmp);`.
    3.  然后，我把我需要的所有东西都画到了那个新的画布上。在这种情况下，这将是来自您的一个画布的数据。
    4.  现在，在你的另一个画布中，你必须得到你刚刚画的位图，然后把它画到这个画布上。像这样：`canvas.drawBitmap(yourDrawnBitmap, 0.0f, 0.0f, null);`。

我认为您将面临的困难是将数据从一个 Canvas 传输到另一个。但是，无论您的实现如何，上述方法之一都应该对您有效。

# delphi - 将阴影添加到 TBitmap

> ID：10918776
> 
> 赞同：2
> 
> 时间：2012-06-06T17:03:20.810
> 
> 标签：delphi, image-processing, delphi-7, vcl, dropshadow

我有一个截取屏幕截图（TBitmap）的例程，我需要在最终的 TBitmap/图像中添加阴影，我有这段代码（以前可以工作，但是......）有些不对劲，只是阴影未绘制：

```
// --------------------------------------------------------------------- //
procedure TakeScreenshot();
var
   lCapRect : TRect;
   DestBitmap : TBitmap;
begin
     // Take the screenshot & assign it to DestBitmap
     // ...

     // Add the drop shadow to DestBitmap
     DestBitmap.Width  := DestBitmap.Width + 6;
     DestBitmap.Height := DestBitmap.Height + 6;

     PaintShadow(DestBitmap.Canvas, lCapRect);
end;
// --------------------------------------------------------------------- //
procedure PaintShadow(ACanvas : TCanvas; ARect : TRect);
var
   AColor         : TColor;
   i, iMax        : Integer;
   h1, h2, v1, v2 : Integer;
begin
     AColor := ACanvas.Brush.Color;
     iMax   := 6;
     h1     := ARect.Left;
     h2     := ARect.Right;
     v1     := ARect.Top;
     v2     := ARect.Bottom;

     with ACanvas do
     begin
      for i := iMax downto 0 do
      begin
           ACanvas.Pen.Mode := pmMask;
           Pen.Color        := DarkenColorBy(AColor, ((iMax - i) * 4 + 10));

           MoveTo(h1 + 4{i}, v2 + i);
           LineTo(h2 + i + 1, v2 + i);
      end;    // for

      for i := iMax downto 0 do
      begin
           ACanvas.Pen.Mode := pmMask;
           Pen.Color        := DarkenColorBy(AColor, ((iMax - i) * 4 + 10));

           MoveTo(h2 + i, v1 + 4{i});
           LineTo(h2 + i, v2 + i);
      end;    // for
     end;    // with
end;
// --------------------------------------------------------------------- //
function Max(const A, B: Integer): Integer;
begin
     if (A > B) then
    Result  := A
     else
     Result := B;
end;
// --------------------------------------------------------------------- //
function DarkenColorBy(BaseColor : TColor; Amount : Integer) : TColor;
begin
     Result := RGB(Max(GetRValue(ColorToRGB(BaseColor)) - Amount, 0),
           Max(GetGValue(ColorToRGB(BaseColor)) - Amount, 0),
           Max(GetBValue(ColorToRGB(BaseColor)) - Amount, 0));
end; 
```

**我的问题是**：我该如何解决这个问题（或者有人知道将阴影添加到 TBitmap 的简单方法）？

最终的图像是要保存为 bmp/jpg，而不是在 TImage 中显示，所以我真的需要为图像本身添加阴影。

PS。我正在使用 Delphi 7 Pro，我的应用程序仅限于 Windows XP 或更高版本

**编辑**

**lCapRect**取决于设置（我是捕获活动监视器、窗口还是所有桌面监视器），但假设它是这样计算的：

```
lCapRect.Right  := Screen.DesktopLeft + Screen.DesktopWidth;
lCapRect.Bottom := Screen.DesktopTop + Screen.DesktopHeight;
lCapRect.Left   := Screen.DesktopLeft;
lCapRect.Top    := Screen.DesktopTop; 
```

位图确实包含屏幕截图（在底部和右侧添加了 6 个像素以为阴影腾出空间），只是没有发生阴影绘制

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T17:46:40.110

你还没有显示你是如何计算的`lCapRect`。为了不绘制有关您的`PaintShadow`程序的位图，它必须小于位图，例如：

```
lCapRect := DestBitmap.Canvas.ClipRect;

// Add the drop shadow to DestBitmap
DestBitmap.Width  := DestBitmap.Width + 6;
DestBitmap.Height := DestBitmap.Height + 6;

PaintShadow(DestBitmap.Canvas, lCapRect); 
```

# java - JNLP 获得许可

> ID：10918777
> 
> 赞同：5
> 
> 时间：2012-06-06T17:03:28.313
> 
> 标签：java, security, digital-signature, jnlp, java-web-start

我最近在通过 JNLP 启动我的应用程序时偶然发现了一个问题。我现在将其缩小到 a `java.security.AccessControlException`，这拒绝我关闭我的`ExecuterService`.

所以，我做了一些阅读，发现我需要权限（`modifyThread`）才能成功关闭服务。我还发现我应该使用`<security>`-tag（在 JNLP 文件中）来请求它，但我对如何请求它有点困惑。

[标签](http://docs.oracle.com/javase/1.5.0/docs/guide/javaws/developersguide/syntax.html#security)的文档说：

> [...] 如果**`all-permissions`指定了元素，应用程序将拥有对客户端机器和本地网络的完全访问权限**。如果应用程序请求完全访问权限，则所有**JAR 文件都必须签名**。将**提示用户**[...]

通过阅读本文，在我看来，我可以选择获得*所有*权限或*不*获得权限……这似乎是一个令人困惑的实现。因为我只需要一个来关闭我的服务。

我还阅读[了这篇文章](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/appA.html)，告诉我不应该请求所有权限，因为这样我会打开用户计算机以获取恶意代码。

那么，有没有办法指定我只需要特定的权限（`modifyThread`），因此我不需要签署我的 jar？还是我必须采用“签署我的罐子并要求一切”的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T17:24:42.827

> ..我是否必须采用“签署我的罐子并要求一切”的方法？

是的。JWS 权限分为 3 个级别¹，唯一允许修改线程的级别是`all-permissions`.

## 1) JWS 安全级别

*   沙盒。提供了一个非常有限的环境。仅允许使用 JNLP API 服务访问打印机和本地文件系统等内容，这些服务`File`在提示用户后提供了更有限的形式。附带橱窗横幅。只能与自己的服务器通信。
*   `j2ee-application-client-permissions`- 提供那些自发（在用户接受数字签名代码后）的 JNLP API 服务移除窗口横幅。
*   **`all-permissions`**- 几乎任何东西，包括替换现有的安全管理器（是的，即使是“所有权限”代码也可以在 JWS 中获得安全管理器 - 它非常宽松）。

还要追逐[JNLP](https://stackoverflow.com/tags/jnlp/info)和[JWS](https://stackoverflow.com/tags/java-web-start/info)页面中的链接。我个人可以推荐这些摘要和链接。

# java - Java：高分系统

> ID：10918781
> 
> 赞同：-6
> 
> 时间：2012-06-06T17:03:41.567
> 
> 标签：java, http, ftp

我正在做一个项目，我被告知要实施一个`highscore`系统。我没有超长的时间，所以一个相对简单的方法会很棒。

游戏在`java`，既适用于平台`Android`，也适用于`Computer`平台。

我应该使用 FTP、txt 文件 HTTP 还是其他？

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:08:42.193

一种可行的方法是创建一个简单的 API。如果您在应用程序中提供 FTP 凭据，它很可能会被黑客入侵。

如果您创建一个简单的 HTTP API，您可以为每个客户端分配一个唯一的 API 密钥，如果有人将其用于垃圾邮件或其他什么，您可以禁止他们而不影响其他人。（看，您将有效的 API 密钥存储在数据库中，或其他任何东西。）

一般来说，几乎任何不使用唯一的、每个客户端的身份验证的东西都可能被滥用，如果您在应用程序中存储 FTP 或 SQL 连接数据，那么您将度过一段糟糕的时光。

# .net - 1.2GB内存异常

> ID：10918783
> 
> 赞同：12
> 
> 时间：2012-06-06T17:03:50.907
> 
> 标签：.net, wpf, memory, limit

我读到了内存限制

*   [.NET 真的有 1.2GB 的限制吗？](http://www.velocityreviews.com/forums/t20387-is-there-really-a-1-2gb-limit-for-net.html)
*   [单个 .NET 进程是否有内存限制](https://stackoverflow.com/questions/200348/is-there-a-memory-limit-for-a-single-net-process)
*   [DotNET 应用程序的内存使用情况](https://stackoverflow.com/questions/1376526/memory-usage-of-dotnet-app)

我有一个应用程序可以处理需要流式传输的巨大图像。就像在单帧视频处理中一样。该应用程序有大约 40 个插件，每个插件都可以包含数据库、图像处理和 WPF GUI。

该应用程序还有 2 个使用较旧的 DotNet Winforms 的插件。

除了应用程序在 RAM 中超过 1.2GB 之外，一切都运行良好。然后在插件中分配新内存的不寻常位置上，我收到“内存不足异常”。

我正在开发一个编译为 32 位的 64 位系统。我不知道该做什么以及如何寻找任何故障。

有限制还是我可以抓住它们？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-08T13:37:41.083

*编写一个消耗所有*可用虚拟内存空间的 32 位程序是非常困难的。您将在 2 GB 以下碰壁，首先用完的是一块足够大以适应请求大小的虚拟内存。您只能通过小分配来达到 2GB 的限制，小到足以容纳孔。

在操作位图的程序中，这堵墙很早就出现了。他们可以消耗大量的 VM 来存储位图像素，并且它需要是一个连续的分配。它们存储在一个`array`，而不是一个`tree`。这是一种非托管内存分配，典型的 .NET 内存分析器往往无法向您展示问题。

对于地址空间碎片，您无法做任何合理的事情，应该可以消耗所有可用 VM 的想法是错误的。`editbin.exe`通过在[构建后事件](https://stackoverflow.com/questions/4588373/vs-2010-ide-2gb-limt/4588675#4588675)中运行并使用其`/LARGEADDRESSAWARE`命令行选项，您可以在 64 位操作系统上获得更多喘息空间。这允许该进程使用可用的 4 GB 的 VM，这是一个特定于 64 位版本的 Windows 的选项，并且可能因为 Windows 不需要上面的 2 GB。当然，将平台目标更改为 AnyCPU 是获得大量虚拟内存的快速简便的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T07:40:59.707

为了变得更具确定性，您应该编写一些集成测试来检查您的内存最终在哪里。您现在可以使用[WMemoryProfiler](http://geekswithblogs.net/akraus1/archive/2012/06/22/150026.aspx)来完成。我会首先加载 1500x1500 大小的图像，清理所有内容，然后将所有对象标记为已知。然后我会重新加载大图像并检查分配了哪些新对象，并仔细查看其中有多少以及谁拥有它们。

您说使用了许多外部模块。也许你应该因为不明智地使用内存而放弃其中的一些，并用更好的东西替换它们。现在你可以检查了。

如果您达到限制，您仍然可以卸载一些图像并按需加载它们，如果您和您的插件确实支持惰性结构，例如`IEnumerable<Image>`您作为提供者可以决定何时加载图像以及将其保存在缓存中多长时间，直到您摆脱引用以帮助释放一些内存。

```
[Test]
public void InstanceTracking()
{
   using (var dumper = new MemoryDumper())  // if you have problems use to see the debugger windows true,true))
   {
      TestWith1500x1500();
      dumper.MarkCurrentObjects();
      TestWith3000x3000();
      ILookup<Type, object> newObjects = dumper.GetNewObjects()
                                               .ToLookup( x => x.GetType() );

      // here we do find out which objects are holding most of the memory
      MemoryStatistics statOld = dumper.GetMemoryStatistics();
      foreach (var typeInfo in statOld.ManagedHeapStats
                                   .OrderByDescending(x => x.Value.Count))
      {
            Console.WriteLine("Type {0} has {1} instances of total size {2:N0} bytes", 
                           typeInfo.Key, 
                           typeInfo.Value.Count,
                           typeInfo.Value.TotalSize);
      }

      // then check with the info from above who is holding the most interesting new objects. 
      Console.WriteLine("New Strings:"); // just an example perhaps you should have a look at the images.
      foreach (var newStr in newObjects[typeof(string)] )
      {
          Console.WriteLine("Str: {0}", newStr);
      }
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T13:18:32.257

在 Windows 上运行的 32 位应用程序（即使操作系统是 64 位）具有 4 Gb 地址空间，但这被分为 2 Gb 应用程序/2 Gb 系统（这可以通过不同的启动开关更改为 3/1）。

您使用的总内存很可能实际上是 2Gb 而不是 1.2Gb，您如何确定这个 1.2Gb 的数字，您是否使用[进程资源](http://technet.microsoft.com/en-US/sysinternals/bb896653)管理器工具查看了应用程序？

如果您将应用程序更改为 ANYCPU 或 64 位，您应该会发现此限制在 64 位操作系统上消失（很好地移动到更大的值）。

# jquery - 如何使用jQuery选择锚标签内的文本

> ID：10918784
> 
> 赞同：2
> 
> 时间：2012-06-06T17:03:55.197
> 
> 标签：jquery, html, dynatree, jquery-dynatree

我想选择`a`标签并在单击时显示其文本。

换句话说，当我单击第一个链接 - “One”时，我想使用`alert`.

当我单击第二个链接 - “示例”时，我想使用`alert`.

```
<body>
    <div id="tree">
        <ul>
        <li><a target="_blank" href="one.html">One</a></li>
        <li class="folder expnded"><a target="_blank" href="two.html">Examples</a></li>
        </ul>
    </div>    
    <div id="display"></div>    
</body> 
```

**更新1：**

谢谢大家的回答。我真正想做的是我需要创建一个树结构，当我单击树叶节点时，我必须显示该叶节点的名称。

我使用 jQuery DynaTree 创建了树结构，但 jQuery 选择器在上面的代码中对我不起作用。

我无法选择标签或标签内的任何其他元素`div`。

下面是树形结构：

![在此处输入图像描述](../Images/199114eb25404299643b68125e4d3be9.png)

## 这是我的完整 HTML 代码（以上只是示例代码）

```
<html>
<head>
<!-- Include the required JavaScript libraries: -->
<script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>
<script src='js/jquery-ui-1.8.20.custom.min.js' type="text/javascript"></script>
<script src='js/myjquery.js' type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="css/ui.dynatree.css">
<link rel="stylesheet" type="text/css" href="css/style.css">
<script src="js/jquery.dynatree.js" type="text/javascript"></script>

</head>

<body>
    <div id="tree">
        <ul>
            <li>one</li>
            <li><a target="_blank" href="">Google</a>
            <li class="folder expnded">Examples
                <ul>
                    <li><a target="content" href="" id="s">one</a>
                    <li><a target="content" href="two.html">two</a>
                    <li class="folder">Folder one
                        <ul>
                            <li><a target="content" href="one.html">one</a>
                            <li><a target="content" href="two.html">two</a>
                        </ul>
                    <li><a target="content" href="three.html">three</a>
                    <li><a target="content" href="four.html">four</a>
                    <li class="folder">Folder two
                        <ul>
                            <li><a target="content" href="one.html">one</a>
                            <li><a target="content" href="two.html">two</a>
                        </ul>
                    <li class="folder">Folder three
                        <ul>
                            <li><a target="content" href="one.html">one</a>
                            <li><a target="content" href="two.html">two</a>
                            <li class="folder">Inner Folder
                                <ul>
                                    <li><a target="content" href="one.html">one</a>
                                    <li><a target="content" href="two.html">two</a>
                                </ul>
                        </ul>
                </ul>
        </ul>
    </div>

    <div id="display">
    <a href="" id="s">one</a>
    </div>

</body>
</html> 
```

我发布的图片是上述 HTML 代码的输出。

在 myjquery.js 文件中，我有这样的代码（旧）

```
$(function() {
        // --- Initialize sample trees
        $("#tree").dynatree({
            autoFocus : true,
            //          persist: true,
            minExpandLevel : 2,
            onFocus : function(node) {
                // Auto-activate focused node after 1 second
                if (node.data.href) {
                    node.scheduleAction("activate", 1000);
                }
            },
            onBlur : function(node) {
                node.scheduleAction("cancel");
            },
            onActivate : function(node) {
                if (node.data.href) {
                    window.open(node.data.href, node.data.target);
                }
            }
        });
    }); 
```

**更新 2：**

## 我的问题的解决方案

在 myjquery.js 文件中，以下新代码适用于我。您可以将其与上面的旧代码进行比较。

```
$(function() {
    // --- Initialize sample trees
    $("#tree").dynatree({
        autoFocus : true,
         persist: true,
        minExpandLevel : 1,
        onFocus : function(node) {
            // Auto-activate focused node after 1 second
            if (node.data.href) {
                node.scheduleAction("activate", 1000);
            }
        },
        onBlur : function(node) {
            node.scheduleAction("cancel");
        },
        onActivate : function(node) {
            if (node.data.href) {
                window.open(node.data.href, node.data.target);
            }
        },
        onClick : function(node) {
            $.ajax({
                type : "GET",
                url : "Display",
                data : {
                    id : node.data.title
                },
                success : function(data) {
                    $("#display").html(data);
                }
            });
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T17:05:27.350

```
$('a', '#tree li').on('click', function(e) {
  e.preventDefault();    // this line is for prevent page reload
  alert($(this).text());
}); 
```

**[演示](http://jsfiddle.net/thecodeparadox/QStkd/163/)**

阅读更多关于[jQuery 选择器](http://api.jquery.com/category/selectors)[`.text()`](http://api.jquery.com/text)的信息

### 根据编辑

您可以尝试如下：

```
$('span[class^=dynatree-exp-c] a').on('click', function(e) {
    e.preventDefault();
    alert( $(this).text() );
}); 
```

dynatree 的每个叶节点都是具有 等类的跨度`dynatree-exp-c`，`dynatree-exp-c1`所以我`[class^=dynatree-exp-c]`用来选择类以 . 开头的跨度`dynatree-exp-c`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:07:54.247

```
$('a').click(function(){
    alert($(this).text());
    return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T17:07:54.113

使用这个脚本。

```
jQuery('a').click(function(){
   var x = jQuery(this).text();
    alert(x);
});​ 
```

这是[演示](http://jsfiddle.net/5rTTN/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T17:12:28.283

```
$('a').click(function(e){
    alert( $(this).text() );
    e.preventDefault();
}); 
```

# c# - C# 在发送之前强制转换数组接口引用

> ID：10918785
> 
> 赞同：1
> 
> 时间：2012-06-06T17:03:58.040
> 
> 标签：c#, interface, casting, ref

我有这个代码

```
public MyResponse innerFunc(ref MyElem[]);
public IResponse myFunc(ref IElem[] myElem)
{
     return this.innerFunc(ref (A_CAST_OR_SOMETHING) myElem);
} 
```

在哪里

*   我的回应:IResponse
*   MyElem:IElem
*   A_CAST_OR_SOMETHING 应该属于 MyElem[]

当我这样做时

```
public IResponse myFunc(ref IElem[] myElem)
{
     return this.innerFunc(ref ((MyElem[]) myElem));
} 
```

编译器突出**显示括号**（仅括号）并说：

> *ref 或 out 参数必须是可赋值变量*

我应该做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:10:51.780

这种方式`ref`和`out`工作方式，您作为该参数传入的东西必须能够直接分配给。简而言之，它必须能够出现在`=`标志的左侧。因为你不能这样做：

```
((MyElem[])myElem) = foo; 
```

那么你也不能这样做：

```
foo((MyElem[])myElem); 
```

要解决此问题，您需要引入一个临时变量：

```
public IResponse myFunc(ref IElem[] myElem)
{
    var temp = (MyElem[])myElem;
    var response = this.innerFunc(ref temp);

    myElem = (IElem[])temp;
    return response;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T17:12:37.000

您不能转换`ref`参数。参数的类型必须完全匹配。因此，在这个位置上没有铸造操作员是可能的。您可以在调用之前创建一个匹配的变量`innerFunc`：

```
public IResponse myFunc(ref IElem[] myElem)
{
    MyElem[] p = (MyElem[])myElem;
    var result = this.innerFunc(ref p);
    myElem = p;
    return result;
} 
```

如果参数的实际类型是 a ，则此方法有效`MyElem[]`。如果它只是一个`IElem[]`，则需要创建一个单独的数组。

# mysql - atk4 高级杂物？

> ID：10918786
> 
> 赞同：3
> 
> 时间：2012-06-06T17:04:01.183
> 
> 标签：mysql, crud, atk4

我有以下表格：

```
-- -----------------------------------------------------

-- Table `product`

-- -----------------------------------------------------

CREATE  TABLE IF NOT EXISTS `product` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `productName` VARCHAR(255) NULL ,
  `s7location` VARCHAR(255) NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB;

-- -----------------------------------------------------

-- Table `pages`

-- -----------------------------------------------------

CREATE  TABLE IF NOT EXISTS `pages` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `productID` INT NULL ,
  `pageName` VARCHAR(255) NOT NULL ,
  `isBlank` TINYINT(1) NULL ,
  `pageOrder` INT(11) NULL ,
  `s7page` INT(11) NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `productID` (`productID` ASC) ,
  CONSTRAINT `productID`
    FOREIGN KEY (`productID` )
    REFERENCES `product` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- -----------------------------------------------------

-- Table `field`

-- -----------------------------------------------------

CREATE  TABLE IF NOT EXISTS `field` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `pagesID` INT NULL ,
  `fieldName` VARCHAR(255) NOT NULL ,
  `fieldType` VARCHAR(255) NOT NULL ,
  `fieldDefaultValue` VARCHAR(255) NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `id` (`pagesID` ASC) ,
  CONSTRAINT `pagesID`
    FOREIGN KEY (`pagesID` )
    REFERENCES `pages` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB; 
```

我已经让 CRUD 在“产品”表上工作。

```
//addproduct.php
class page_addproduct extends Page {
    function init(){
        parent::init();

        $crud=$this->add('CRUD')->setModel('Product');

    }
} 
```

这行得通。但我需要得到它，以便在创建新产品时它基本上允许我将新行添加到页面和字段表中。

例如，表格中的产品是要呈现多个页面的印刷产品（如贺卡）。第 1 页可能有 2 个可以自定义的文本字段，第 2 页可能有 3 个文本字段，一个用于定义文本大小的滑块和一个用于选择颜色的下拉列表，第 3 页可能有五个都可以自定义的文本字段. 所有三个页面（以及所有表单元素，在本示例中为 12 个）都与 1 个产品相关联。

所以当我创建产品时，我可以添加一个按钮来为该产品创建一个页面，然后在页面中我可以添加一个按钮来添加一个新的表单元素字段吗？

我对此还有些陌生，所以我的数据库结构可能并不理想。我很感激任何建议和反馈！有人可以向我指出一些关于如何实现这一点的信息、教程、文档、想法、建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T22:38:44.693

通常，除非您有现有产品，否则您无法添加页面。我们通常使用状态字段来解决这个问题。将此添加到您的产品模型中：

```
$this->addField('state')->enum(array('active','draft'))->defaultValue('draft'); 
```

也可以在 SQL 中创建它。此外，描述关系通常很好，因此将其添加到您的产品模型中：

```
$this->hasMany('Page','productID'); 
```

接下来，您需要在添加新记录时更改操作。您可以通过扩展 crud 类轻松做到这一点：

```
class MyCRUD extends CRUD {
    function formSubmitSuccess(){
        if($_GET['id']) return parent::formSubmitSuccess(); // edit ->save

        // add ->save handled here
        $this->js()->univ()->location($this->api->url('./details',
          array('id'=>$this->form->model->id)))->execute();
    }
} 
```

并将 add('CRUD') 替换为 add('MyCRUD')。接下来，如果您将 CRUD 放置在页面“mypage”上，您将需要创建“mypage/details”。成功保存新产品后，您的新方法会将用户重定向到这个新页面，并且它也会传递 productID。

在这个新页面上，您应该有

```
$m=$this->add('Model_Product')->load($_GET['id']); // makes sure ID is valid
$this->api->stickyGET('id');  // configures page to carry id= value along
$crud=$this->add('CRUD');
$crud->setModel($m->ref('Page')); 
```

这将在此处显示 CRUD，它将自动编辑该特定产品的页面。您现在唯一想念的是后退按钮。

```
if($crud->grid){
    if($crud->grid->addButton('Save')->isClicked()){
        // AJAX action on button click

        $m->set('status','active')->save(); // update status of current product
        $this->js()->univ()->location($this->api->url('..'))->execute();
        // redirect back to parent page
    }

    // You might want a cancel button too
    $crud->grid->addButton('Cacel')->js('click')
         ->univ()->location($this->api->url('..'));

    // no AJAX, simple javascript action.
} 
```

要完美地完成所有内容，请返回原始页面并添加条件。您不必创建新模型，除非您愿意，可以是这样的：

```
// on my page
$this->add('MyCRUD')->setModel('Product')->addCondition('state','active'); 
```

这样，您的主要 CRUD 将不会显示不完整的记录。您的数据库可能会累积草稿记录，您可以偶尔删除这些记录。如果这里有任何问题，请在 Github 上发布您的项目并与我们的 Agile Toolkit 开发小组分享，我们中的一些人肯定会为您实施。

奖金：

您可能想如何编辑现有的产品页面？最简单的方法是在主 crud 的网格中使用扩展器：

```
$crud=$this->add('MyCRUD');
$crud->setModel('Product')->addCondition('state','active');
$crud->addColumn('expander','details'); // will expand into page mypage/details and will automatically pass ID. 
```

该解决方案并非 100% 理想，但考虑到 WEB 应用程序的特性以及它们对 SQL 的依赖，这是管理数据的好方法。

# jquery - Internet Explorer 8 中带有前导空格和锚标记的 jQuery.html()

> ID：10918798
> 
> 赞同：0
> 
> 时间：2012-06-06T17:04:40.817
> 
> 标签：jquery, internet-explorer-8, innerhtml

**更新：这个问题应该被关闭，因为问题是由于我自己的编码错误而不是真正有用。**

当内部有前导空格和锚标记时，我在使用 IE8 和 jQuery.html() 时遇到问题。要重现该问题，请转到此处：

```
http://jquery.com/ 
```

现在在 IE8 开发者控制台中输入：

```
$('body').html(' test<a href="">foo<a>'); 
```

您会注意到屏幕上没有打印任何内容。在控制台输入这个将确认正文的内容是空的：

```
$('body').html(); 
```

如果我使用本机 innerHTML，则不会出现此问题。jQuery 绕过了 IE8 的本机 innerHTML，而是使用 jQuery.append()，因为 IE8 会去除前导空格。

有谁知道为什么会这样？这是一个已知的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T17:46:25.250

您的标记无效，如果您关闭它，它会起作用，

```
$('body').html(' test<a href="">foo</a>'); 
```

我不知道jQuery应该如何在这里处理无效标记，所以它可能仍然是一个错误。

# javascript - Twitter bootstrap：向打开的手风琴标题添加一个类

> ID：10918801
> 
> 赞同：18
> 
> 时间：2012-06-06T17:04:56.597
> 
> 标签：javascript, jquery, jquery-ui, twitter-bootstrap, accordion

我是一个 jquery/javascript 新手。我想要做的是在打开的手风琴标题中添加一个类，并在我打开另一个时将其删除。

继承人的代码：

```
<div class="accordion" data-collapse-type="manual" id="parent">
  <div class="accordion-group">
    <div class="accordion-heading">             
      <a class="accordion-toggle category" data-toggle="collapse" data-parent="#parent" href="#category1">Category 1
      </a>
    </div><!--/accordion-heading-->
    <div id="category1" class="accordion-body collapse">
      <ul class="accordion-inner unstyled">
        <li id="" class="sidelink"><a href="">Open Link 1</a></li>
        <li id="" class="sidelink"><a href="">Open Link 2</a></li>
        <li id="" class="sidelink"><a href="">Open Link 3</a></li>
      </ul>
    </div><!--/category1-->
  </div><!--/accordion-group-->
  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle category" href="#Category2">Category 2</a>
    </div><!--/accordion-heading-->
  </div><!--/accordion-group-->
</div><!--/accordion--> 
```

我附在页面上的脚本是

```
<script src="js/jquery-1.7.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.tools.min.js"></script> 
```

所以我一直在寻找的是在菜单打开时将**.active**类添加到 a.accordion-toggle （手风琴风格），然后在选择另一个时让它消失。我在[这里查看](http://twitter.github.com/bootstrap/javascript.html#collapse)了引导程序的文档，但它似乎对我没有多大帮助（因为我不知道如何处理

> $('#myCollapsible').on('hidden', function () { // 做某事... })

或放置它的位置）我也尝试过**.addClass()** jquery 加法器，但我只能获得 javascript 版本**document.getElementById("accordion-heading").className += "newClass";** 工作（如果我给手风琴组标题一个 ID，但在这种情况下会有多个手风琴组）当我把脚本放在 div 层之后。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-06T17:52:30.833

您可以为此使用折叠事件。

```
$(function() {

    $('.accordion').on('show', function (e) {
         $(e.target).prev('.accordion-heading').find('.accordion-toggle').addClass('active');
    });

    $('.accordion').on('hide', function (e) {
        $(this).find('.accordion-toggle').not($(e.target)).removeClass('active');
    });

});​ 
```

这是一个 JsFiddle [http://jsfiddle.net/D2RLR/251/](http://jsfiddle.net/D2RLR/251/)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-06-04T09:28:44.753

这是我对这个问题的解决方案。基于上面的一些很好的答案，但适用于 Bootstrap 3.1.x

```
$('#accordion')
  .on('show.bs.collapse', function(e) {
    $(e.target).prev('.panel-heading').addClass('active');
  })
  .on('hide.bs.collapse', function(e) {
    $(e.target).prev('.panel-heading').removeClass('active');
  }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-21T15:00:30.980

我也想添加一个“活动”类或类似的，但我在检查过程中注意到，当所有链接处于非活动状态时，都有一个“折叠”类，在选择选项卡/链接时会被删除，因此我只是在没有标签的情况下标记了选项卡“崩溃”的班级。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-13T08:48:03.883

我已经尝试过 Michael D. Irizarry 的解决方案，但这对我不起作用。所以我想出了自己的代码：

```
$(function() {
    $('a.accordion-toggle').click(function(e) {
        e.preventDefault();
        if(!$(this).parent().hasClass('active')) {
            $('.accordion-heading').removeClass('active');
            $('.accordion-body').removeClass('active');
            $(this).parent().addClass('active').next().addClass('active');
        } else {
            $('.accordion-heading').removeClass('active');
            $('.accordion-body').removeClass('active');
        }
    });
}); 
```

如果手风琴标题还没有活动类，则所有手风琴标题和正文都将失去活动类，并且已单击的标题及其对应的正文标签将获得添加的类。

如果它已经激活了类（所以如果它已经打开并被单击），那么活动类将被删除并且不会发生其他任何事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-20T17:40:43.740

只需检查 BS 代码添加的折叠类：

```
$('a.accordion-toggle').on('click', function () {
    if( $(this).hasClass('collapsed') !== true ){
        $(this).removeClass('active');
    }else{
        $(this).addClass('active');
    }
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-21T09:36:40.610

我认为这是迄今为止最简单的方法。

```
$('a.accordion-toggle').on('click', function () {
  $('a.accordion-toggle').removeClass('active');
  $(this).addClass('active');
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-06T17:15:41.977

我认为如果你把它放在你的javascript上它会起作用：

```
$('.accordion-toggle').on('shown', function () {
 $(this).addClass('active') });

$('.accordion-toggle').on('hidden', function () {
 $(this).removeClass('active') }); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-27T10:33:16.703

类活动不要给项目，因为在更少的文件中这个类改变了你必须给它css而不是类。此代码效果最好，您可以添加另一个所需的 css

```
 $(function () {
            $('#accordion')
     .on('show.bs.collapse', function (e) {
         $(e.target).prev('.panel-heading').css({'background-color': 'red','color':'white'})
     })
     .on('hide.bs.collapse', function (e) {
         $(e.target).prev('.panel-heading').css({ 'background-color': '#b6ff00', 'color': 'black' })
     });
        }); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-09T16:13:58.380

这适用于我使用 Bootstrap 3.3.6，

```
 $('#accordion')
   .on('show.bs.collapse', function (e) {
       $(e.target).parent('.panel').addClass('panel-primary');
   })
   .on('hide.bs.collapse', function (e) {
       $(e.target).parent('.panel').removeClass('panel-primary');
   });
        }); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-18T15:53:53.133

[https://jsfiddle.net/u2ay67Lo/6/](https://jsfiddle.net/u2ay67Lo/6/)

**HTML**

```
 <div id="accordion2" class="accordion panel-group">
  <div class="accordion-group panel panel-default">
    <div class="panel-heading accordion-heading">
      <a href="#collapse5" data-parent="#accordion2" data-toggle="collapse" class="accordion-toggle panel-title">
             Lorem ipsum dolor sit amet ..
            </a>
    </div>
    <div class="accordion-body collapse" id="collapse5">
      <div class="accordion-inner panel-body">
        <div class="row">
          <div class="col-md-10">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur blandit faucibus elit nec mollis. Phasellus tempor urna tellus, eget lobortis magna porttitor eget. Sed risus ex, ultrices ac quam at, ultrices feugiat dolor. Mauris nec fermentum arcu.
            <br>
            <br>
            <i aria-hidden="true" class="fa fa-file-pdf-o"></i> <a href="#">Peças escritas e desenhadas (39.5 MB)</a>
            <br>
            <i aria-hidden="true" class="fa fa-file-pdf-o"></i> <a href="#">Formulário de Participação (101 KB)</a>
          </div>
          <div class="col-md-2">
            <button class="pull-right" href="#">Participa</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="accordion-group panel panel-default">
    <div class="panel-heading accordion-heading">
      <a href="#collapse7" data-parent="#accordion2" data-toggle="collapse" class="accordion-toggle panel-title">
               Donec vitae efficitur magna...
            </a>
    </div>
    <div class="accordion-body collapse" id="collapse7">
      <div class="accordion-inner panel-body">
        <div class="row">
          <div class="col-md-10">
            Donec vitae efficitur magna, non iaculis sapien. Pellentesque ut leo turpis. Sed aliquet, lorem vel sollicitudin pretium, sapien augue rutrum risus, eu ultricies risus est in nibh. Etiam molestie non lorem in mollis. Cras non mi tempus, varius elit id,
            ultrices diam. Vestibulum bibendum lacus vitae augue interdum, ut ultricies elit aliquam. Fusce rhoncus nunc convallis luctus ornare. Curabitur vulputate posuere ligula in eleifend. Vivamus commodo mi sed felis dignissim, rutrum pharetra odio
            varius. Sed vel aliquet tortor. Nunc sit amet nibh eget sem elementum pulvinar. Maecenas et felis at felis venenatis lacinia vitae sit amet nulla.
            <br>
            <br>
            <i aria-hidden="true" class="fa fa-file-pdf-o"></i> <a href="#">Peças escritas e desenhadas (39.5 MB)</a>
            <br>
            <i aria-hidden="true" class="fa fa-file-pdf-o"></i> <a href="#">Formulário de Participação (101 KB)</a>
          </div>
          <div class="col-md-2">
            <button class="pull-right" href="#">Participa</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="accordion-group panel panel-default">
    <div class="panel-heading accordion-heading">
      <a href="#collapse8" data-parent="#accordion2" data-toggle="collapse" class="accordion-toggle panel-title">
              Maecenas et felis at felis...
            </a>
    </div>
    <div class="accordion-body collapse" id="collapse8">
      <div class="accordion-inner panel-body">
        <div class="row">
          <div class="col-md-10">
            Maecenas et felis at felis venenatis lacinia vitae sit amet nulla.Morbi tempor facilisis aliquam. Suspendisse ac velit ut lectus vehicula finibus imperdiet et leo.
            <br>
            <br>
            <i aria-hidden="true" class="fa fa-file-pdf-o"></i> <a href="#">Peças escritas e desenhadas (39.5 MB)</a>
            <br>
            <i aria-hidden="true" class="fa fa-file-pdf-o"></i> <a href="#">Formulário de Participação (101 KB)</a>
          </div>
          <div class="col-md-2">
            <button class="pull-right" href="#">Button1</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="accordion-group panel panel-default">
    <div class="panel-heading accordion-heading">
      <a href="#collapse9" data-parent="#accordion2" data-toggle="collapse" class="accordion-toggle panel-title">
               Quisque placerat in dui quis vestibulum. ..
            </a>
    </div>
    <div class="accordion-body collapse" id="collapse9">
      <div class="accordion-inner panel-body">
        <div class="row">
          <div class="col-md-10">
            Quisque placerat in dui quis vestibulum. Morbi tempor facilisis aliquam. Suspendisse ac velit ut lectus vehicula finibus imperdiet et leo. Mauris commodo auctor tellus, at lobortis sapien. Class aptent taciti sociosqu ad litora torquent per conubia nostra,
            per inceptos himenaeos. Morbi fringilla lectus et urna blandit porta. Aliquam sed dolor gravida tellus pharetra laoreet in vel dolor. Sed cursus lacus vel metus porttitor, sed tempus enim pharetra. Vestibulum malesuada faucibus diam hendrerit
            molestie. Aenean eget malesuada ipsum. Phasellus vitae erat at tellus aliquet sollicitudin. Integer nec neque nec felis egestas efficitur. Aliquam sodales est neque, in vulputate orci cursus in. Nunc ac leo suscipit, porttitor tellus non,
            fermentum eros. Sed aliquet elit at est consequat, et semper risus porta.
            <br>
            <br>
            <i aria-hidden="true" class="fa fa-file-pdf-o"></i> <a href="#">File1 (39.5 MB)</a>
            <br>
            <i aria-hidden="true" class="fa fa-file-pdf-o"></i> <a href="#">Formulário de Participação (101 KB)</a>
          </div>
          <div class="col-md-2">
            <button class="pull-right" href="#">Test</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 
```

**JavaScript**

```
$(function() {
  $('a.accordion-toggle').click(function(e) {
    e.preventDefault();
    if (!$(this).parent().hasClass('accordionPannelActive')) {
      $('.accordion-heading').removeClass('accordionPannelActive').find('a').removeClass('accordionPannelActive');
      $(this).parent().addClass('accordionPannelActive').find('a').addClass('accordionPannelActive');
    } else {
      $('.accordion-heading').removeClass('accordionPannelActive').next().removeClass('accordionPannelActive');
      $(this).parent().find('a').removeClass('accordionPannelActive');
    }
  });
}); 
```

**CSS**

```
.accordionPannelActive {
      background-color: #8dc640!important;
      color: white !important;
}

a.accordion-title:focus {
      color: inherit;
      text-decoration: none;
}

.panel-default > .panel-heading {
      background-image: none;
}

a.accordion-title:hover {
      color: inherit;
      background-color: inherit;
      text-decoration: none;
}

.panel-default > .panel-heading {
      background-image: none;
}
.panel-title{
      display:block;
} 
```

**需求：** jquery.min.js、jquery.min.js、bootstrap.min.css、bootstrap-theme.min.css 和 bootstrap.min.js

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-06-25T17:52:30.007

这对我有用..

```
$('.panel-default').on('show.bs.collapse', function () {
     $('.panel-heading').addClass('active');
});

$('.panel-default').on('hide.bs.collapse', function () {
     $('.panel-heading').removeClass('active');
}); 
```

# directx - DirectX 11 仅在屏幕的一部分？

> ID：10918806
> 
> 赞同：1
> 
> 时间：2012-06-06T17:05:21.487
> 
> 标签：directx, viewport, rendertarget

我正在尝试设置 Direct X 仅参与一半屏幕的窗口。

我的交换链 desc 宽度是半屏，我的视口宽度是半屏，但是当我将渲染目标清除为蓝色时，整个屏幕都是蓝色的，而不是我指定使用的一半。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T13:53:04.590

我知道这是个老问题，但无论如何，如果有人会从搜索中来到这里：

[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ff476388%28v=vs.85%29.aspx)说：

> Direct3D 9 和 Direct3D 11/10 之间的区别：
> 
> 与 Direct3D 9 不同，资源视图的全部范围始终被清除。不应用视口和剪刀设置。

# mysql - 添加外键时如何知道引用表的删除操作

> ID：10918811
> 
> 赞同：1
> 
> 时间：2012-06-06T17:05:49.137
> 
> 标签：mysql, database, wordpress, foreign-keys, relational-database

我正在努力在数据库上构建新的东西，这些东西已经由其他人构建并且几乎没有文档。我需要添加一个新表，其中包含对已经存在的表的多对多引用。

以下是已经存在的wp_posts表：

```
+-----------------------+---------------------+------+-----+---------------------+----------------+
| Field                 | Type                | Null | Key | Default             | Extra          |
+-----------------------+---------------------+------+-----+---------------------+----------------+
| ID                    | bigint(20) unsigned | NO   | PRI | NULL                | auto_increment |
| post_author           | bigint(20) unsigned | NO   | MUL | 0                   |                |
| post_date             | datetime            | NO   |     | 0000-00-00 00:00:00 |                |
| guid                  | varchar(255)        | NO   |     |                     |                |
| menu_order            | int(11)             | NO   |     | 0                   |                |
| post_type             | varchar(20)         | NO   | MUL | post                |                |
| post_mime_type        | varchar(100)        | NO   |     |                     |                |
| comment_count         | bigint(20)          | NO   |     | 0                   |                |
| legacy_id             | int(11)             | YES  |     | NULL                |                |
+-----------------------+---------------------+------+-----+---------------------+----------------+ 
```

我需要创建一个表标签和 tag_posts_reference 来帮助我创建多对多的参考表。Tag 表是 wp_tags：

```
+-------+---------------------+------+-----+---------+----------------+
| Field | Type                | Null | Key | Default | Extra          |
+-------+---------------------+------+-----+---------+----------------+
| id    | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| tag   | varchar(255)        | YES  |     | NULL    |                |
+-------+---------------------+------+-----+---------+----------------+ 
```

我在创建表 wp_tags_posts 时遇到问题。它给了我以下错误：

```
 mysql> create table wp_posts_tags( id bigint(20) unsigned auto_increment, 
    post_id bigint(20) unsigned not null, 
    tag_id bigint(20) unsigned not null, 
    primary key(id), index(post_id), 
    foreign key(post_id) references wp_posts(id) on Update cascade on delete restrict,
index(tag_id), 
    foreign key(tag_id) references wp_tags(id)) 
    ENGINE = INNODB;
    ERROR 1005 (HY000): Can't create table 'openexhibits_dev.wp_posts_tags' (errno: 150) 
```

我认为我应该添加的级联动作有一些删除。我添加了一些并通过反复试验进行了尝试，但它们都不起作用。有没有办法在创建外键引用时找到我应该使用的删除级联操作？有没有像 dec table_name 这样的命令可以显示这些操作？我尝试过 delete no action 和 delete set null 等，但我不想盲目地通过反复试验来做某事，尤其是在处理表之间的关系时。谁能帮我？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T20:14:00.533

哪个引擎是您的默认引擎，对具有外键的表使用 InnoDB 引擎。

mysql> 创建表 wp_tags_posts(id bigint(20) unsigned auto_increment,
tag_id bigint(20) unsigned, post_id bigint(20) unsigned, 主键(id), 外键(tag_id) 引用 wp_tags(id), 外键(post_id)参考 wp_posts(ID))engine=InnoDB;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:02:37.527

这适用于 MySQL 5.5。据我所知，目标表是 Wordpress 表这一事实不应该影响外键引用。

```
create table wp_posts (
  ID bigint(20) unsigned,
  post_author bigint(20) unsigned,
  post_date datetime,
  guid varchar(255),
  menu_order int(11),
  post_type varchar(20),
  post_mime_type varchar(100),
  comment_count bigint(20),
  legacy_id int(11),
  primary key (ID)
) engine = INNODB;

create table wp_tags (
  id bigint unsigned,
  tag varchar(25),
  primary key (id)
) engine = INNODB;

create table wp_tags_posts(
  id bigint(20) unsigned auto_increment,  
  tag_id bigint(20) unsigned, 
  post_id bigint(20) unsigned, 
  primary key(id), 
  foreign key(tag_id) references wp_tags(id), 
  foreign key(post_id) references wp_posts(ID)
) engine = INNODB; 
```

# java - 如何在 Eclipse 插件中检索当前文件的编程语言？

> ID：10918812
> 
> 赞同：2
> 
> 时间：2012-06-06T17:05:49.633
> 
> 标签：java, eclipse, plugins

我正在尝试开发一个 Eclipse 插件，它可以猜测有关当前正在编辑的文件的一些属性。

例如，我想猜测编程语言（例如 Java、C++、xml 等）、支持的 JRE 版本（例如用于 Java 项目）等。

我使用以下内容找到了一些东西：

```
ResourcePlugin.GetWorkspace().getRoot().getFileExtension();
ResourcePlugin.GetWorkspace().getNatureDescriptors();
ResourcePlugin.GetWorkspace().getRoot().getPersistentProperties(); 
```

但这些对我来说还不够。对此有任何提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T19:29:27.653

检查`IFile.getContentDescription().getContentType().getName()`...它将为您提供 Eclipse 如何选择用于打开文件的编辑器的基础...

# php - Wordpress query_posts orderby rand 在类别存档模板中不起作用

> ID：10918814
> 
> 赞同：3
> 
> 时间：2012-06-06T17:05:57.873
> 
> 标签：php, wordpress

我无法让我的 Wordpress 主题随机化我在类别档案中显示的帖子 [我将其用作 CMS]。主页正常随机化，我 [我认为] 正确更改了 WP_query。下面是确切的 args 数组：

```
array(4) { ["orderby"]=> string(4) "rand" ["order"]=> string(3) "ASC" ["posts_per_page"]=> string(2) "-1" ["category_name"]=> string(8) "branding" } 
```

为了便于阅读，它是：

```
orderby => rand
order => ASC
posts_per_page => -1
category_name => branding (or whatever the query_string brings in) 
```

我从该类别中获取所有帖子，但它们是按发布日期顺序排列的。

有什么线索吗？或在have_posts中改组我的WP_query结果的替代方法？

谢谢。

```
************EDIT************ 
```

抱歉，我应该更清楚上面的 args 数组。它是查询数组的 var_dump，而不是我添加到查询中的参数。

```
 $args = array(
        'orderby'        => 'rand',
        'order'      => 'ASC',
        'posts_per_page' => '-1',
    );
    global $wp_query;           
    remove_all_filters('posts_orderby');
    $theq = array_merge($args, $wp_query->query);
    query_posts($theq); 
```

我根据 Sheikh Heera 的建议添加了 remove_all_filters ，但并没有什么不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T11:03:16.060

那时您最好创建一个新查询。这应该只在分类模板上使用，尽管如 category.php 或 taxonomy-yourcustomtaxonomy.php。

```
global $wp_query;

$term = $wp_query->queried_object;

$args=array(
    'orderby' => 'rand',
    'posts_per_page' => -1,
    'post_type' => 'post',
    'tax_query' => array(
            array(
                'taxonomy'  => $term->taxonomy,
                'field'     => 'slug',
                'terms'     => $term->slug,
                )
            )
    );

$new_query = null;
$new_query = new WP_Query($args);

while ($new_query->have_posts()) : $new_query->the_post(); ?>
    <div id="post-<?php the_ID(); ?>" <?php post_class(); ?>>
        <h2 class="entry-title"><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
        <div class="entry-meta"><?php // Meta ?></div><!-- .entry-meta -->
        <div class="entry-content"><?php the_content(); ?></div>
    </div>
<?php
endwhile;
wp_reset_postdata(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T18:36:00.070

可能是另一个插件造成了问题，但您可以执行以下操作

```
remove_all_filters('posts_orderby');
$args=array(
    orderby => 'rand'
    order => 'ASC'
    posts_per_page => -1
    category_name => 'branding'
);
query_posts($args); 
```

但请记住，您可以使用此解决方案破坏插件的功能，但它可能有助于解决问题，但可能并不完美。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T20:02:35.043

我认为您希望将其与原始查询合并。无需指定类别，并且如果它也以这种方式使用自定义分类法，则可以使用。

```
$args = array(
    'posts_per_page' => -1,
    'orderby' => 'rand'
    );

query_posts( array_merge( $wp_query->query, $args) ); 
```

# regex - 正则表达式 - 负前瞻

> ID：10918817
> 
> 赞同：4
> 
> 时间：2012-06-06T17:06:08.693
> 
> 标签：regex, negative-lookahead, negative-lookbehind

我正在尝试使用 Perl 的负前瞻正则表达式从目标字符串中排除某些字符串。请给我你的建议。

我试图获取没有-sm、-sp 或-sa 的字符串。

正则表达式：

```
hostname .+-(?!sm|sp|sa).+ 
```

输入

```
hostname 9amnbb-rp01c
hostname 9tlsys-eng-vm-r04-ra01c
hostname 9tlsys-eng-vm-r04-sa01c
hostname 9amnbb-sa01
hostname 9amnbb-aaa-sa01c 
```

预期输出：

```
hostname 9amnbb-rp01c              - SELECTED
hostname 9tlsys-eng-vm-r04-ra01c   - SELECTED 
hostname 9tlsys-eng-vm-r04-sa01c
hostname 9amnbb-sa01
hostname 9amnbb-aaa-sa01c 
```

但是，我在下面得到了这个实际输出：

```
hostname 9amnbb-rp01c              - SELECTED
hostname 9tlsys-eng-vm-r04-ra01c   - SELECTED
hostname 9tlsys-eng-vm-r04-sa01c   - SELECTED
hostname 9amnbb-sa01
hostname 9amnbb-aaa-sa01c          - SELECTED 
```

请帮我。

ps：我使用[Regex Coach](http://www.weitz.de/regex-coach/#install) 来可视化我的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T17:10:02.670

移动`.+-`前瞻的内部：

```
hostname (?!.+-(?:sm|sp|sa)).+ 
```

rubular：[http ://www.rubular.com/r/OuSwOLHhEy](http://www.rubular.com/r/OuSwOLHhEy)

您当前的表达式无法正常工作，因为当`.+-`超出前瞻时，它可以回溯，直到前瞻不再导致正则表达式失败。例如对于字符串`hostname 9amnbb-aaa-sa01c`和正则表达式`hostname .+-(?!sm|sp|sa).+`，第一个`.+`将 match `9amnbb`，前瞻将看到`aa`接下来的两个字符并继续，第二个将`.+`match `aaa-sa01c`。

我当前的正则表达式的替代方法如下：

```
hostname .+-(?!sm|sp|sa)[^-]+?$ 
```

这将防止回溯，因为`-`在前瞻之后不会发生任何事情，因此使用了非贪婪`?`，以便在多行全局模式下正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:28:45.837

以下通过了您的测试用例：

```
hostname [^-]+(-(?!sm|sp|sa)[^-]+)+$ 
```

我认为它比 FJ 的答案更容易阅读。

回答鲁迪：这个问题是作为排除案例的情况提出的。这似乎很适合负前瞻。:)

# android - 为什么我的安卓应用程序崩溃了？

> ID：10918818
> 
> 赞同：0
> 
> 时间：2012-06-06T17:06:12.710
> 
> 标签：android, android-intent, runtime-error

所以我知道这与我的“startActivity(myIntent)”代码行有关。这是我的第一个活动文件

```
public class Commander2 extends Activity {
    /** Called when the activity is first created. */

    private static final String TAG = "AccessCodeEntry";
    private static final String LEVEL_ONE_ACCESS_CODE = "derp";

    @Override
    public void onCreate( Bundle savedInstanceState ) {
        super.onCreate( savedInstanceState );
        setContentView( R.layout.accesscodeentry );
    }

protected void onDestroy() {
    super.onDestroy();
}

public void accessCodeEntered( View v ) {
    EditText loginPassword = (EditText) findViewById( R.id.editText1 );
    if( loginPassword.toString().equals( LEVEL_ONE_ACCESS_CODE ) ) {
        Intent myIntent = new Intent( Commander2.this, LevelOne.class );
        startActivity( myIntent );
    } else {
        Intent myIntent = new Intent( Commander2.this, LevelZero.class );
        startActivity( myIntent );
    }
}
} 
```

这里也是 XML 文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:onClick="accessCodeEntered"
        android:text="OK" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/button1"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="19dp"
        android:ems="10"
        android:inputType="textPassword" >

        <requestFocus />
    </EditText>

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@+id/editText1"
        android:layout_alignLeft="@+id/editText1"
        android:text="Enter Access Code, or leave blank for Level 0"
        android:textAppearance="?android:attr/textAppearanceLarge" />

</RelativeLayout> 
```

只要我输入密码并按下 OK 按钮，我的代码就会退出，无论输出是什么。我已经注释掉了 startActivity( myIntent ) 行并且代码完成而没有崩溃。有谁知道我做错了什么？

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="my.eti"
  android:versionCode="1"
  android:versionName="1.0">
<uses-sdk android:minSdkVersion="10" />
<application android:icon="@drawable/ic_launcher" android:label="@string/app_name">
    <activity android:name=".Commander2"
              android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
     <activity android:name=".LevelOne"
              android:label="@string/app_name">
        <intent-filter>                
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name=".LevelZero"
              android:label="@string/app_name">
        <intent-filter>                
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:08:27.053

请发布您的 logcat 错误，但我的猜测是确保`LevelOne`并且`LevelZero`在您的清单文件中。此外，它可能有助于改变这一点：

```
loginPassword.toString().equals( LEVEL_ONE_ACCESS_CODE ) 
```

到：

```
loginPassword.getText().toString().equals( LEVEL_ONE_ACCESS_CODE ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:09:23.520

让你在清单文件中注册**LevelOne**和**LevelZero**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T17:13:57.883

这是一个类似 SO 问题的链接，该问题显示了如何将活动添加到清单中。

[向 AndroidManifest 添加新活动？](https://stackoverflow.com/questions/3832619/add-a-new-activity-to-the-androidmanifest)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T17:17:40.887

> **编辑**：我正在更新我的答案

所以我终于知道你哪里错了

*   检查你的 if 条件
*   在 accessCodeEntered() 方法中
*   Commander2.java Activity 的

* * *

```
 if(loginPassword.toString().equals(LEVEL_ONE_ACCESS_CODE)){} 
```

在这里你没有得到密码的值并尝试使用它所以我添加了“ `getText()`”方法并且它像这样工作正常

* * *

```
if(loginPassword.getText().toString().equals(LEVEL_ONE_ACCESS_CODE)){} 
```

* * *

指挥官2.java

* * *

```
package my.eti;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;

public class Commander2 extends Activity implements OnClickListener {
    /** Called when the activity is first created. */

    private static final String TAG = "AccessCodeEntry";
    private static final String LEVEL_ONE_ACCESS_CODE = "derp";

    private Button btnOK;
    private EditText passTxt;

    private String strPass;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.accesscodeentry);

        passTxt = (EditText) findViewById(R.id.editText1);

        btnOK =(Button) findViewById(R.id.button1);
        btnOK.setOnClickListener(this);
    }

    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub

        if(v==btnOK){

            /*... here is the problem we havent added getText() to get value from EditText...*/
        if(loginPassword.getText().toString().equals(LEVEL_ONE_ACCESS_CODE)){
            Intent myIntent = new Intent( Commander2.this, LevelOne.class );
            Toast.makeText(getBaseContext(), "if condition is true..", Toast.LENGTH_SHORT).show();
            startActivity( myIntent );
        }
        else{
            Intent myIntent = new Intent( Commander2.this, LevelZero.class );
            Toast.makeText(getBaseContext(), "else condition is true..", Toast.LENGTH_SHORT).show();

            startActivity(myIntent);
        }
        }

    }
} 
```

* * *

尝试实现此代码以及您出错的地方。

仍然有任何麻烦与我分享谢谢。

# javascript - 是否可以在不使用 eval() 的情况下以编程方式从字符串或其他技术定义函数？

> ID：10918827
> 
> 赞同：1
> 
> 时间：2012-06-06T17:06:38.427
> 
> 标签：javascript, jquery

我正在为需要构建一个未知长度的嵌套回调函数的情况编写代码。它是创建一个序列化的动画队列来将一个元素移动到一个未知的位置。

例如，输出看起来像这样，其中嵌套了 X 'complete' 回调：

```
$('#element').animate(css, { complete: function () {
          $('#element').animate(css, { complete: function () {
              // more nested calls inside
          }
}); 
```

现在我将这些函数生成为字符串，然后在完成后将其提供给 new Function()：

```
myFunc = new Function(generatedFuncString); 
```

内容是可信的，但这仍然使用具有负面性能影响的 eval()。我只是想知道是否有另一种/更好的方法？

编辑：我这样做的原因是因为我有一组非常复杂的动画要执行并且在 jQuery 动画队列之外工作。如果有人对如何完成这样的情况有更好的建议，那将是有帮助的......

想象一个棒球场，第一名是跑步者（A），第三名是跑步者（B）。在一个动画包中，我想将跑步者 A 设置为第 3 名（中间停在第 2 名，2 次前进），并将跑步者 B 设置为 HOME（1 次前进）。

我必须用“queue: false”启动初始推进，以便跑垒员 A 和 B 同时移动到他们的一垒（跑垒员 A 到第二垒，跑垒员 B 到家）。

当 Runner A 完成移动到第二个时，我想将他移动到第三个（因此以编程方式构建一个带有嵌套回调的 animate() 调用以确保保留此顺序）。

我通过字符串构造函数的原因是因为我知道最里面的回调将首先是什么，然后从那里递归构造1个或多个外部回调。我无法通过将函数用作对象并保持所有引用保持完整来找到一种方法。

请记住，这是一个简单的示例。想象一下，当基地被加载时，我需要制作一个大满贯的动画（所有 4 名跑步者都绕着所有基地，来自家乡的跑步者需要在跑回家乡之前停下 3 次）。等等等等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T17:11:15.910

回答您在标题中提出的问题：您可以通过 , 和插入包含所需文本的元素从字符串`eval`创建`new Function`函数`script`。但这都是同一件事：启动 JavaScript 解析器并创建函数。

但不是嵌套，我认为你想要链接。在数组中构建动画列表，并使用`animate`回调调用数组中的下一个动画。*像*：

```
var animations = [
    /* css for first animation */,
    /* css for second animation */,
    /* etc. */
];
var index = 0;

function runAnimation() {
    if (index < animations.length) {
        $("#element").animate(animations[index++], runAnimation);
    }
} 
```

当然，您会动态地构建数组。

* * *

gdoron 在评论中指出，如果你所有的动画都在同一个元素上，它可以更简单：

```
var animations = [
    /* css for first animation */,
    /* css for second animation */,
    /* etc. */
];
var index = 0;

for (index = 0; index < animations.length; ++index) {
    $("#element").animate(animations[index]);
} 
```

...因为当您在**同一个**[`animate`](http://api.jquery.com/animate)元素上多次调用时，默认情况下动画会排队（该选项默认为; 遗憾的是，文档似乎没有这么说）。我上面的代码示例不依赖于队列，因此理论上数组中的每个条目都可以是一个对象，该对象具有选择器的属性，用于设置动画元素和应用 css。但如果它都是一个元素，你可以使用直接循环。**`queue``true`**

# webgl - 检查 Dart 中的 WebGL 支持

> ID：10918830
> 
> 赞同：4
> 
> 时间：2012-06-06T17:06:48.087
> 
> 标签：webgl, dart

我正在使用**WebGL**和**Dart**，但我不知道如何检查某个对象是否具有某种方法。例如，在 JavaScript 中，我会检查 WebGL 是否可用，`window.WebGLRenderingContext`但在 Dart 中是否有相同的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T21:45:00.063

IIRC Dart 的目标之一是规范浏览器定义的不一致。因此，WebGL 将*始终*“可用”，因为它的接口将始终存在于 Dart 中，无论您运行的浏览器是否已本地定义它们。

最好检查是否支持 WebGL，就像在 Javascript 中一样：

```
WebGLRenderingContext gl = canvas.getContext("experimental-webgl"); 
```

如果`gl`为 null，则不支持 WebGL。否则就是！

（顺便说一句：仅仅因为`window.WebGLRenderingContext`存在于 Javascript 中并不意味着支持 WebGL！这只告诉您浏览器能够调度 WebGL 命令。您运行的系统可能不接受它们。最好还是尝试创建一个上下文并检测它何时失败。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T17:12:44.377

编辑：顺便说一句，有一种初始化 WebGL 上下文的 Dart 方式：

```
RenderingContext gl = canvas.getContext3d();
if (gl == null) {
  print("WebGL: initialization failure");
} 
```

旧答案：

```
WebGLRenderingContext gl = canvas.getContext("experimental-webgl");
if (gl == null) {
    print("WebGL is not supported");
    return;
} 
```

当我在 chrome://flags/ 下打开“禁用 WebGL”时，此代码会在 Chrome JavaScript 控制台上打印“不支持 WebGL”。

但是，在 Firefox 下禁用 WebGL（about:config -> webgl.disabled;true），它会在 Web 控制台上产生错误：

> NS_ERROR_FAILURE：组件返回失败代码：0x80004005 (NS_ERROR_FAILURE) [nsIDOMHTMLCanvasElement.getContext]

编辑：这是 Firefox 的固定错误：[https ://bugzilla.mozilla.org/show_bug.cgi?id=645792](https://bugzilla.mozilla.org/show_bug.cgi?id=645792)

# asp.net-mvc - MVC 模型绑定模型上的持久复杂属性

> ID：10918834
> 
> 赞同：2
> 
> 时间：2012-06-06T17:07:15.807
> 
> 标签：asp.net-mvc, asp.net-mvc-3, model-binding

我有以下设置

```
public class Profile
{
    //Some Properties

    //Some Methods
}

/*Model Class*/
public class LineItem
{
    public Profile Profile {get;set;}
} 
```

在我的控制器中。我有以下两个动作

```
public ActionResult GetRequest(){

    LineItem model = new LineItem();
    model.Profile = new Profile(){/*Initialize Properties*/};
    return View(model);
}

public ActionResult PostRequest(LineItem item(){
      item.Profile ....  /*Profile Is Null*/
      return View(...);
} 
```

我已验证 LineItem 模型类上的 Profile 属性已在 GetRequest 上设置，并返回到视图，但我想知道在提交该模型时如何保留该复杂属性。我知道人们通常使用隐藏字段进行模型持久性，并且会话也可用，但似乎我有时应该能够告诉 ModelBinder（可能通过属性或注释）在我的模型上保留复杂的属性。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T18:22:02.767

您可以`@Html.HiddenFor(model => model.Profile.Id)` `@Html.HiddenFor(model => model.Profile.Name)`对需要保留的 Model.Profile 的每个属性使用 etc.。您不应该触摸模型绑定器 - 它将使用标准模型绑定器自动绑定。如果您使用其他 html 帮助程序，它会为某些属性生成输入标签 - 您不应该使用`@Html.HiddenFor()`此属性。

# html - html5 IE9 缓存问题

> ID：10918848
> 
> 赞同：0
> 
> 时间：2012-06-06T17:08:05.853
> 
> 标签：html, internet-explorer-9, html5-appcache

我有以下内容：

```
 var webappCache = window.applicationCache;

    switch (webappCache.status) {
         case 0:
            console.log("Cache status: Uncached");
            break;
       case 1:
             console.log("Cache status: Idle");
             break;
        case 2:
            console.log("Cache status: Checking");
             break;
         case 3:
             console.log("Cache status: Downloading");
            break;
         case 4:
             console.log("Cache status: Updateready");
            break;
       case 5:
             console.log("Cache status: Obsolete");
             break;
         default:
             console.log("Cache status: unknown");
    } 
```

在 IE 9 中，它无法理解 webappCache.status 是什么。我还读到 IE 9 不支持应用程序缓存。这是真的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T17:23:47.800

是的，它仅在 IE10 + 中支持

[我可以用吗](http://caniuse.com/#search=appcache)

# c# - 使用 C# 读取深层 xml 标签

> ID：10918849
> 
> 赞同：0
> 
> 时间：2012-06-06T17:08:06.813
> 
> 标签：c#, .net, xml, linq

我需要一些使用 Linq to xml 的帮助，我一直在阅读在线文章但仍然没有运气，有人可以帮我吗？

我只需要读取一个 xml 文件，我遇到的问题是它有很多子级别，我无法访问它们。

```
<Dias>
  <Dia id="0">
     <Restricciones>
        <Restriccion tipo="Ambiental" horaInicio="6" horaFin="10">
            <Placas>
               <Placa>4</Placa>
            </Placas>
         </Restriccion>
      </Restricciones>
   </Dia>
</Dias> 
```

我目前的代码是：

```
var dia = (int)DateTime.Now.DayOfWeek;

var xElement = XElement.Load("Bogota.xml");

var d = (from dias in xElement.Descendants("Dia")
where dias.Attribute("id").Value == dia.ToString()
select dias).First();

var rest = (from r in d.Descendants("Restricciones")
select r); 
```

但是我尝试了几种变体，但到目前为止没有运气

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:24:37.407

这应该工作

```
var d = (from s in myXel.Descendants("Dia") 
                 where s.Attribute("id").Value == dia.ToString()
             select s).FirstOrDefault();

var rest = d.Descendants("Restriccion").ToList(); 
```

# design-patterns - 什么是打破 Game1() 的好习惯

> ID：10918853
> 
> 赞同：2
> 
> 时间：2012-06-06T17:08:18.963
> 
> 标签：design-patterns, xna

它在“Game1.cs”中增长了太多的纹理/矢量。Draw 和 Update 也更大，不易管理。你们是怎么做的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T17:32:03.643

这是一个非常开放的问题。如果您的代码变得过于复杂，请使用其他类型来处理特定职责。

对于 XNA，请查看[GameComponent](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.gamecomponent.aspx)和[DrawableGameComponent](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.drawablegamecomponent.aspx)类。这将使您入门，但您可能需要引入其他类型。找一本关于面向对象设计的好书来获得一些想法。

# winapi - 我如何做很酷的对话 (MFC)

> ID：10918854
> 
> 赞同：0
> 
> 时间：2012-06-06T17:08:24.503
> 
> 标签：winapi, visual-c++, mfc

我是否必须使用对话框或消息并不重要，但我需要以某种方式执行以下操作：

我有一个基于对话框的 MFC 应用程序。主对话框调用一个创建线程的过程。对过程的调用在 while 循环内。（基本上它是一个文件处理程序 - 产生一个用于保存文件的线程。因此，为每个正在保存的文件产生一个线程。）

我正在正确暂停和恢复主线程。但是，我不知道如何让消息框/对话框显示“请稍候”之类的内容，并且仍然有主对话框更新... 0.o

基本上，我想锁定用户交互的主对话框（比如阻止他们选择任何东西或点击任何按钮），但我希望对话框上的进度条更新......

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T19:18:01.733

有点旧但可以工作： [microsoft.com/msj/0297/wicked/wicked0297.aspx](http://microsoft.com/msj/0297/wicked/wicked0297.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:33:38.187

好吧，这是一个非常古老的应用程序。

您无需遵循此示例；但是你可以按照这个想法。

您有两个选择：在主对话框中创建进度条，禁用除进度之外的所有对话框。启动线程传递对话框的句柄。从线程使用此句柄发送自定义消息以允许对话推进。另一条消息将通知对话框线程已完成并启用所有控件。

另一种选择是生成无模式对话框，启动线程传递无模式对话框的句柄和进程，如上所述。将主对话框指针传递给无模式对话框，用于在无模式启动 (OnInitDialog) 时禁用和启用主对话框，并在接收到线程完成消息时启用，然后销毁无模式对话框窗口。

# java - 表达语言和接口

> ID：10918857
> 
> 赞同：4
> 
> 时间：2012-06-06T17:08:32.327
> 
> 标签：java, jsp, spring-mvc, jstl, el

我不是 JSTL 和表达式语言的专家，所以我的问题可能很愚蠢......

我正在使用 Spring MVC，在我的控制器中我有：

```
@ModelAttribute("export_types")
public ExportType[] getExportTypes() {
    return edService.getTypes();
} 
```

`ExportType`是一个自定义界面：

```
public interface ExportType {

    String getName();

    //...
} 
```

在我的页面中，我有：

```
<c:forEach var="item" items="${export_types}">
    <tr>
        <td><input type="checkbox" value="${item.name}"></td>
        <td>${item.name}</td>
    </tr>
</c:forEach> 
```

但是当我运行我的网络应用程序时，我得到了这个期望：`javax.el.PropertyNotFoundException: Property 'name' not found on type java.lang.String`

奇怪的是异常说`on type java.lang.String`而不是 type `ExportType`。所以我的问题是：**我不能将表达式语言与接口一起使用吗？**

* * *

**注1**

`edService.getTypes()`返回一个`ExportType[]`包含接口具体实现的数组。

为了清楚起见，我有一个实现`ExportType`接口的抽象类。具体类型继承自：

```
public abstract class AbstractExportType implements ExportType {
    protected String name;

    protected AbstractExportType() {
        this.name = this.getClass().getSimpleName();
    }

    @Override
    String getName(){
        return this.name;
    }

    //...
} 
```

* * *

**笔记2**

转发到 export.jsp 的控制器方法很简单：

```
@RequestMapping(value = "/export", method = RequestMethod.GET)
public String getExportForm() {
    return "jsp/export";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T11:16:17.433

我认为它与接口无关。正如@doublep 所说，很可能`export_types`实际上不是`ExportType[]`. 我试过重现你正在做的事情，它工作正常。

# c# - 返回类型为对象的通用方法

> ID：10918863
> 
> 赞同：-2
> 
> 时间：2012-06-06T17:09:01.447
> 
> 标签：c#, generics, object, return

```
ClassA
{
        int a;
        public int aValue
        {
            get { return a; }
        }
}

ClassB : ClassA
{
      int b;
        public int bValue
        {
            get { return b; }
        }
}

ClassC : ClassA
{
      int c;
        public int cValue
        {
            get { return c; }
        }
}

public void getObject(int i) 
{
    if(i==1)
    {
        ClassB objB = new ClassB();
         objB.aValue = 20;
         objB.bValue = 30;
         Console.Writeline(objB.aValue);
         Console.Writeline(objB.bValue);
    }
    else
    {
        ClassC objC = new ClassC();
        objC.aValue = 20;
        objC.cValue = 40;
        Console.Writeline(objC.aValue);
        Console.Writeline(objC.cValue);
    }
} 
```

相反，我想创建返回一个对象的通用方法，例如：

```
public T getObject<T>(int i) where T : class
{
    if(i==1)
    {
        ClassB objB = new ClassB();
         return objB as T;
    }
    else
    {
        ClassC objC = new ClassC();
        return objC as T;
    }
}

public static void main()
{
    Object obj = getObject<Object>(5);
    obj.aValue = 20;
    obj.bValue = 30;
    obj.cValue = 40;
    Console.Writeline(obj.aValue);
    Console.Writeline(obj.bValue);
    Console.Writeline(obj.cValue);
} 
```

在这种情况下 obj = objC 所以 bValue = 30 和 cValue = 40 应该发生。但我不能这样做。这是我的第三次尝试。我希望我至少这次是清楚的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:18:43.473

似乎问题可能出在您提出问题的方式上...

您将在通用约束中使用 where 子句来约束它。

我不确定您为什么要为通用方法强制装箱对象...

# html - html5音频进度条/ tribbles的问题

> ID：10918864
> 
> 赞同：0
> 
> 时间：2012-06-06T17:09:01.873
> 
> 标签：html, audio

我正在调整这个进度条：http://www.richardshepherd.com/tv/audio/ 以使用我的播放列表代码，但我不知道为什么它不起作用。我认为这很荒谬（我尝试添加 (document).ready 函数，但这破坏了我的其余代码）。

这就是我所拥有的：

```
function loadPlayer() {
    var audioPlayer = new Audio();
    audioPlayer.controls="controls";
    audioPlayer.preload="auto";
    audioPlayer.addEventListener('ended',nextSong,false);
    audioPlayer.addEventListener('error',errorFallback,true);
    document.getElementById("player").appendChild(audioPlayer);
    nextSong();
}

function nextSong() {
    if(urls[next]!=undefined) {
        var audioPlayer = document.getElementsByTagName('audio')[0];
        if(audioPlayer!=undefined) {
            audioPlayer.src=urls[next];
            audioPlayer.load();
            audioPlayer.play();
            next++;
        } else {
            loadPlayer();
        }
    } else {
        alert('the end!');
    }
}
function errorFallback() {
        nextSong();
}
function playPause() {
    var audioPlayer = document.getElementsByTagName('audio')[0];
    if(audioPlayer!=undefined) {
        if (audioPlayer.paused) {
            audioPlayer.play();
        } else {
            audioPlayer.pause();
        }
    } else {
        loadPlayer();
    }
}

function stop() {
    var audioPlayer = document.getElementsByTagName('audio')[0];
    audioPlayer.pause();
    audioPlayer.currentTime = 0;
}

function pickSong(num) {
    next = num;
    nextSong();
}

var urls = new Array();
    urls[0] = '01_horses_mouth/mp3/01\. Let The Dog See The Rabbit preface.mp3';
    urls[1] = '01_horses_mouth/mp3/02\. The Other Horse\'s Tale.mp3';
    urls[2] = '01_horses_mouth/mp3/03\. Caged Tango.mp3';
    urls[3] = '01_horses_mouth/mp3/04\. Crumbs.mp3';
    urls[4] = '01_horses_mouth/mp3/05\. Mood Elevator Reprise.mp3';
    urls[5] = '01_horses_mouth/mp3/06\. Mood Elevator.mp3';

var next = 0;

// Display our progress bar
audioPlayer.addEventListener('timeupdate', function(){
var length = audioPlayer.duration;
var secs = audioPlayer.currentTime;
var progress = (secs / length) * 100;
$('#progress').css({'width' : progress * 2});
var tcMins = parseInt(secs/60);
var tcSecs = parseInt(secs - (tcMins * 60));
if (tcSecs < 10) { tcSecs = '0' + tcSecs; }
$('#timecode').html(tcMins + ':' + tcSecs);

}, false); 
```

我最终得到了可以正常工作的默认播放器，我自己的播放/暂停和停止按钮也是如此，但进度条什么也没做。

哦，这就是我在我的 css 中遇到的问题：

```
#progressContainer {position: relative; display: block; height: 20px; 
background-color: #fff; width: 200px; 
-moz-box-shadow: 2px 2px 5px rgba(0,0,0,0.4); 
-webkit-box-shadow: 2px 2px 5px rgba(0,0,0,0.4); 
box-shadow: 2px 2px 5px rgba(0,0,0,0.4);
margin-top: 5px;}
#progress {
display: block; 
height: 20px; 
background-color: #99f; 
width: 0; 
position: absolute; 
top:  0; 
left: 0;} 
```

这是html：

```
<div id="player" > 

     <span id="timecode"></span>
     <span id="progressContainer">
     <span id="timecode"></span>
     <span id="progress"></span>

    </div> 
```

该页面在这里： http: [//lisadearaujo.com/clientaccess/wot-sound/indexiPhone.html](http://lisadearaujo.com/clientaccess/wot-sound/indexiPhone.html)

请注意，这仅适用于 iPhone 纵向的媒体查询，因此如果您在桌面上查看它，则需要向上挤压窗口。:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T09:05:51.443

我现在采用了不同的解决方案 (http://www.adobe.com/devnet/html5/articles/html5-multimedia-pt3.html)，它解释了如何更好地实现这一点。我是一个副本/粘贴者，所以对事情必须遵循的正确顺序知之甚少。我现在得到的是：

```
 function loadPlayer() {
    var audioPlayer = new Audio();
    audioPlayer.controls="controls";
    audioPlayer.preload="auto";
    audioPlayer.addEventListener('ended',nextSong,false);
    audioPlayer.addEventListener('error',errorFallback,true);
    audioPlayer.addEventListener('timeupdate',updateProgress, false);
    document.getElementById("player").appendChild(audioPlayer);
    nextSong();
    }

var urls = new Array();
    urls[0] = '01_horses_mouth/mp3/01\. Let The Dog See The Rabbit preface.mp3';
    urls[1] = '01_horses_mouth/mp3/02\. The Other Horse\'s Tale.mp3';
    urls[2] = '01_horses_mouth/mp3/03\. Caged Tango.mp3';
    urls[3] = '01_horses_mouth/mp3/04\. Crumbs.mp3';
    urls[4] = '01_horses_mouth/mp3/05\. Mood Elevator Reprise.mp3';
    urls[5] = '01_horses_mouth/mp3/06\. Mood Elevator.mp3';

var next = 0;

function updateProgress() 
{ 
var audioPlayer = document.getElementsByTagName('audio')[0];
var value = 0; 
if (audioPlayer.currentTime > 0) { 
   value = Math.floor((100 / audioPlayer.duration) * audioPlayer.currentTime); 
   } 
progress.style.width = value + "%"; 
} 
```

欢呼。有用。我不完全确定为什么，但现在没关系......

# css - 重复 bg 图像有问题

> ID：10918865
> 
> 赞同：1
> 
> 时间：2012-06-06T17:09:03.473
> 
> 标签：css, image

我试图在我的内容区域上方的页面顶部有一个带有边框的标题图像，但由于某种原因，我的 bg 图像正在重复。你知道是什么导致图像重复吗？任何帮助是极大的赞赏！

这是我的代码：

```
<div class="container_12">
<div class="subheader">
<img src="images/subheader_1.png" alt="Subheader" width="940px" height="240px" />
</div>
</div> 
```

这是我的CSS：

```
.subheader{background:url(../images/subheader_1.png);background-repeat:no-repeat; min-height:300px; width:940px}

.subheader img {border:1px solid #ccc;padding:5px;background:#efefef} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:15:06.943

~~您只`background`在 css.xml 中指定了属性。这是一个全局属性，需要在那里定义的所有设置。要将`background-repeat`与您必须使用的图像相结合`background-image`：~~

**编辑：**
根据您的编辑和发布的屏幕截图，看起来您没有重复图像，因为您在背景和图像标签中都包含了图像。您应该选择其中一个，但要使其正确排列，您需要删除填充和边距：

```
.subheader img {
    border:1px solid #ccc;
    padding:5px;    <--- TAKE THIS OUT
    margin: 0px;    <--- ADD THIS
    background:#efefef
} 
```

# mod-rewrite - 结合 mod_rewrite 和 vhost_dbd_module

> ID：10918869
> 
> 赞同：1
> 
> 时间：2012-06-06T17:09:13.560
> 
> 标签：mod-rewrite, apache2, vhosts

我正在尝试为用户提供从其 chroot 内部提供的静态文件夹。以下代码在其他条件下工作（基本上不包含 DBDocRoot 指令），但只是不符合预期。mod_vhost_dbd 与 mod_rewrite 根本不兼容吗？它的部分工作原理是请求命中正确的 python 脚本，然后执行一些其他操作并启动 wsgi 应用程序。

使用此代码，rewrite.log 中不会记录任何内容。如果您注释掉 DBDocRoot 指令行，则会记录内容，但重写规则当然不起作用，因为 ${ENV:username} 是空字符串。从 mysql 控制台运行时，查询工作得很好。

```
LoadModule vhost_dbd_module /usr/lib/apache2/modules/mod_vhost_dbd.so
DBDExptime 5

<VirtualHost *:80>
    ServerAlias *

    RewriteEngine On
    RewriteLog "/var/log/apache2/rewrite.log"
    RewriteLogLevel 9

    DBDriver mysql
    DBDParams host=amysqlhost,user=abdbuser,pass=private,dbname=adbname
    DBDocRoot "SELECT concat('/mnt/user_storage/webscripts/', username, '/user_script.py'), username from user, userdomain where user.id = userdomain.user_id and userdomain.domain_name = %s" HOSTNAME

    RewriteCond /mnt/user_storage/homedirs/%{ENV:username}/var/www/static%{REQUEST_URI} -f
    RewriteRule ^/(.*) /mnt/user_storage/homedirs/%{ENV:username}/var/www/static/$1 [L]

</VirtualHost> 
```

有没有其他人成功地使用这个模块来设置环境变量？[mod_vhost_dbd wiki](http://code.google.com/p/dbd-modules/wiki/mod_vhost_dbd)上的注释说可以做到。

# javascript - 除非在页脚中执行，否则脚本不起作用

> ID：10918870
> 
> 赞同：3
> 
> 时间：2012-06-06T17:09:17.450
> 
> 标签：javascript, jquery

这是一个奇怪的情况。尽管确保它的所有依赖项都在它之前加载（在我的情况下它只是 jQuery 库），但我的脚本在加载到 head 部分（即`<head>`）时不起作用，但在加载到页脚时（在上面的某个地方）它的工作`</body>`标签）。

由于这还不够清楚，让我举一个活生生的例子。[这是网页](http://whatthenerd.com/2012/06/hello-world/)。现在，查看页面的源代码，这就是我正在谈论的代码。

```
<script type='text/javascript'>
/* <![CDATA[ */
var yjlSettings = {"gifUrl":"http:\/\/whatthenerd.com\/wp-content\/themes\/reddlec\/images\/ajax-loader.gif","autoGrow":"enable"};
/* ]]> */
</script>
<script type='text/javascript' src='http://whatthenerd.com/wp-content/themes/reddlec/js/no-reload-comments.js?ver=3.3.2'></script> 
```

它应该做的是允许用户在不重新加载页面的情况下发表评论。（请随时在页面上测试评论`:)`）——但事实并非如此。为什么？

PS：就像我之前说的，当上述脚本在`</body>`标签之前加载时，一切正常。我真的不明白是什么导致了冲突。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T17:13:26.170

您的脚本会立即在 DOM 中查找元素：

```
var $commentlist = jQuery('.commentlist');
var $respond = jQuery('#respond'); 
```

在脚本中找到两个示例。这些项目在加载标题时不存在，但在到达正文末尾时它们确实存在。如果你想从你的标题中加载它，你需要将它包装在一个文档就绪块中：

```
jQuery(document).ready(function($) {
  // Code using $ as usual goes here.
}); 
```

通过延迟代码的执行直到文档完全加载并构建 DOM，这使得在页面顶部加载是安全的。

更多关于`ready`在线的信息： http: [//api.jquery.com/ready/](http://api.jquery.com/ready/)

# c# - Linq to sql Haversine 公式

> ID：10918874
> 
> 赞同：3
> 
> 时间：2012-06-06T17:09:28.870
> 
> 标签：c#, sql-server, tsql, linq-to-sql

我在 C# 和 TSQL 中都有一个 Harversine 公式的实现。我不确定如何最好地在服务器端实现公式，以便我能够在 Linq 查询中使用它。

理想情况下，我只需将本地公式链接到服务器上的函数。从而避免“没有转换为 sql”错误，并让一切都变得美好而无缝。

显然，对这个问题的任何看法都是有帮助的。

我知道 SQL2008 中的地理类型。但是，我正在处理的代码库已经对 Linq to SQL 如此依赖，我希望这比它值得付出的努力更多！

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T17:32:44.870

为什么不使用 100% SQL，因为它是进行计算的最佳方式，并且只需得到一个已经填满距离的表？

从[现有答案](https://stackoverflow.com/a/5362942/28004)

```
CREATE FUNCTION dbo.udf_Haversine(@lat1 float, @long1 float, @lat2 float, @long2 float) RETURNS float 
  BEGIN
    DECLARE @dlon float, @dlat float, @rlat1 float, @rlat2 float, @rlong1 float, @rlong2 float, @a float, @c float, @R float, @d float, @DtoR float

    SELECT @DtoR = 0.017453293
    SELECT @R = 3937 --3976

    SELECT 
        @rlat1 = @lat1 * @DtoR,
        @rlong1 = @long1 * @DtoR,
        @rlat2 = @lat2 * @DtoR,
        @rlong2 = @long2 * @DtoR

    SELECT 
        @dlon = @rlong1 - @rlong2,
        @dlat = @rlat1 - @rlat2

    SELECT @a = power(sin(@dlat/2), 2) + cos(@rlat1) * cos(@rlat2) * power(sin(@dlon/2), 2)
    SELECT @c = 2 * atn2(sqrt(@a), sqrt(1-@a))
    SELECT @d = @R * @c

    RETURN @d 
  END 
```

并使用如下：

```
var table = from r in db.VenuePostCodes 
            select new {
                lat = r.Latitude,
                lng = r.Longitude,
                name = r.Name,
                distance = db.udf_Haversine(
                                  r.Latitude,r.Longitude,
                                  r.Latitude,r.Longitude2)
            }; 
```

但最好的办法是始终将所有内容都放在 SQL 上，这样您的托管服务器就不用做太多事情了，只需在 SQL 中添加一个 VIEW 并调用该视图，让我们想象一下：

```
SELECT 
   latitude, longitude, name, latitude1, longitude2, postcode, 
   udf_Haversine(latitude, longitude, latitude2, longitude2) AS distance 
FROM 
   venuepostcodes
ORDER BY 
   distance 
```

并使用 LINQ 直接调用该视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T17:16:54.640

@balexandre 的回答很好，但我对提供的 SQL 函数不满意（它缺少注释，有趣的注释是否不变，是英里吗？公里？等等......）

```
CREATE FUNCTION [dbo].[udf_Haversine](@lat1 float, @long1 float, @lat2 float, @long2 float) RETURNS float 
BEGIN
    DECLARE @dlon float, @dlat float,
            @rlat1 float, @rlat2 float, @rlong1 float, @rlong2 float,
            @a float, @c float, @R float, @d float, @DtoR float

    SELECT
        @DtoR = PI() / 180, -- Degrees to radians const
        @R = 6371 -- Radius of Earth in KM

    SELECT 
        @rlat1 = @lat1 * @DtoR,
        @rlong1 = @long1 * @DtoR,
        @rlat2 = @lat2 * @DtoR,
        @rlong2 = @long2 * @DtoR

    SELECT 
        @dlat = @rlat1 - @rlat2,
        @dlon = @rlong1 - @rlong2

    SELECT @a = SIN(@dlat / 2) * SIN(@dlat / 2) +
                SIN(@dlon / 2) * SIN(@dlon / 2) * COS(@rlat2) * COS(@rlat1)

    SELECT @c = 2 * atn2(sqrt(@a), sqrt(1 - @a))
    SELECT @d = @R * @c -- Final distance in KM

    SELECT @d = @d * 0.621371192 -- Final distance in miles

RETURN @d 
END 
```

它是从我们从这里获取的 JavaScript 实现转换而来的，最后还转换为英里：

```
// Converted from JavaScript implementation:
// http://www.movable-type.co.uk/scripts/latlong.html

var R = 6371; // km
var dLat = (lat2-lat1).toRad();
var dLon = (lon2-lon1).toRad();
var lat1 = lat1.toRad();
var lat2 = lat2.toRad();

var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
        Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2); 
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
```

# jsp - 获取表达式语言的参数

> ID：10918876
> 
> 赞同：1
> 
> 时间：2012-06-06T17:09:35.787
> 
> 标签：jsp, parameters, el

如何在el中获取参数？我有

```
<select id="odd">
...
</select> 
```

我想在此下拉菜单中获取选定的值。我想用表达语言来做。

```
<c:out value="${param.odd}"/> 
```

我试过这个但没有任何反应，我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:25:25.937

```
<select name="odd"> 
```

它是浏览器用作参数名称的名称，而不是 ID。

# c# - OpenSubKey 不适用于我需要的注册表值

> ID：10918877
> 
> 赞同：5
> 
> 时间：2012-06-06T17:09:41.673
> 
> 标签：c#

我已经安装了 SQL Server。

在注册表中，*HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft* 处的键**MSSQLServer**如下所示： ![在此处输入图像描述](../Images/780d200438a18b5d9128d5181da250e6.png)

以下所有代码行都从注册表返回值：

```
 var mainKey = Microsoft.Win32.Registry.LocalMachine.OpenSubKey("SOFTWARE").OpenSubKey("Microsoft").OpenSubKey("MSSQLServer");
    var subKey1 = Microsoft.Win32.Registry.LocalMachine.OpenSubKey("SOFTWARE").OpenSubKey("Microsoft").OpenSubKey("MSSQLServer").OpenSubKey("Client");
    var subKey2 = Microsoft.Win32.Registry.LocalMachine.OpenSubKey("SOFTWARE").OpenSubKey("Microsoft").OpenSubKey("MSSQLServer").OpenSubKey("MSSQLServer").OpenSubKey("CurrentVersion"); 
```

但是，这个没有：

```
var subKey3 = Microsoft.Win32.Registry.LocalMachine.OpenSubKey("SOFTWARE").OpenSubKey("Microsoft").OpenSubKey("MSSQLServer").OpenSubKey("Setup"); 
```

“设置”看起来与其他键的值类型相同。任何想法为什么这个命令返回null？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T17:54:24.240

您的应用程序是 32 位的，这是一个 64 位的注册表项。32 位和 64 位应用程序具有不同的注册表视图。在 regedit 中，您在代码中获得的密钥位于 HKLM\Software\Wow6432Node\MSSQLServer，而不是 HKLM\Software\MSSQLServer（在您的图片中）。

不幸的是，用于访问注册表项的托管[API](http://en.wikipedia.org/wiki/Application_programming_interface)不允许 32 位应用程序获取注册表的 64 位视图。

有两个选项： 将您的应用程序更改为以 AnyCPU 或 x64 为目标或[P/Invoke](http://en.wikipedia.org/wiki/Platform_Invocation_Services)非托管 API。[这](http://geekswithblogs.net/derekf/archive/2007/06/26/113485.aspx)有一个如何执行 P/Invoke 和[MSDN](http://msdn.microsoft.com/en-us/library/aa384129%28v=vs.85%29.aspx)文档的示例。

顺便说一句，您可以将路径传递给 OpenSubKey 方法，而不是像那样将它们链接在一起。

**更新**：我上面不太正确。从 .NET 4 开始，该`OpenBaseKey`方法 ( [MSDN](http://msdn.microsoft.com/en-us/library/microsoft.win32.registrykey.openbasekey.aspx) ) 可用于在 32 位应用程序中获取 64 位视图。

# caching - W3TC Minify HTML/XML 返回的空白页

> ID：10918878
> 
> 赞同：4
> 
> 时间：2012-06-06T17:09:47.513
> 
> 标签：caching, wordpress, wordpress-theming

我的客户正在使用带有 minify html/xml 的 W3TC，当我启用该功能时，它会显示已损坏的页面。该页面是由为其站点创建的插件生成的，我在 php 或 apache 日志中没有发现任何错误。它根本不返回任何数据，只是一个空白源。该服务器带有 RackSpace 但没有 eAccelerator 或任何其他缓存插件。任何关于在哪里看的想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T22:03:32.703

通常的通用方法是禁用所有插件（w3tc 除外）并恢复为 212 主题并尝试这种方式。然后你会一个一个地打开（可能从一个主题开始），看看它是否有效。

对于特定错误，请检查是否可以提高日志级别： http: [//php.net/manual/en/errorfunc.configuration.php](http://php.net/manual/en/errorfunc.configuration.php)

# arrays - MATLAB中的分类树数组

> ID：10918882
> 
> 赞同：0
> 
> 时间：2012-06-06T17:10:05.453
> 
> 标签：arrays, oop, matlab, classification

我对 MATLAB 很陌生。我试图训练一些分类树并使用以下代码段将它们分配到数组中

```
for k = 1:rows
   tree=ClassificationTree.fit(data(1:k, 1:cols),labels(1:k));
   ensemble(k)=tree;
end 
```

但是，当我运行此程序时，出现以下错误

```
??? Error using ==> DisallowVectorOps>DisallowVectorOps.subsasgn at 28
You cannot assign to an object of class double using () indexing.

Error in ==> dwm02 at 7
ensemble(k)=tree; 
```

有什么办法吗？对象数组上的 MATLAB 帮助有点令人困惑..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:21:45.123

正如用户小厨房所建议的那样，答案是使用单元阵列代替？

```
ensemble{k}=tree; 
```

# api - 如何访问声纳指标的结果以用于 PowerPivot 等应用程序

> ID：10918887
> 
> 赞同：1
> 
> 时间：2012-06-06T17:10:32.047
> 
> 标签：api, sonarqube, powerpivot

我正在尝试通过 Sonar 运行许多具有已知故障率的应用程序，希望确定哪些指标在确定特定应用程序是否会失败时最有价值。最终，我将制作某种算法，查看我正在使用的任何指标的输出并生成 1 到 100 之间的分数。我有大约 21 个应用程序通过 Sonar，结果已存储在MySQL 数据库。我最初计划使用 PowerPivot 来查找数据中的关系，但表格的格式似乎不适合这样做。stackoverflow 上的其他问题告诉我，Sonar 的表格没有格式化，我应该改用 Web Service API 来获取信息。一世'

从另一个问题的答案： http://nemo.sonarsource.org/api/timemachine?resource=org.apache.cxf:cxf&format=csv&metrics=ncloc,violations_density,comment_lines_density,public_documented_api_density,duplicated_lines_density,blocker_violations,critical_violations,major_violations, [minor_violations](http://nemo.sonarsource.org/api/timemachine?resource=org.apache.cxf:cxf&format=csv&metrics=ncloc,violations_density,comment_lines_density,public_documented_api_density,duplicated_lines_density,blocker_violations,critical_violations,major_violations,minor_violations)

这看起来与我想要的非常相似，除了我只查看每个应用程序一次（我正在分析网格上所有实时应用程序的样本），这意味着 Timemachine 并不是我真正想要的米找。是否可以生成一个类似的表，除了每个日期的特定应用程序的统计信息，它显示应用程序及其所有类的统计信息等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T06:44:20.487

如果您不熟悉 WS API，您还可以创建自己的 Sonar 插件来实现您想要的任何东西：它是用 Java 编写的，它将在您运行的每个分析中执行。这样，在这个自定义插件的代码中，您可以做任何您想做的事情：在输出文件中刷新您需要的指标，将它们推送到第三方系统，......等等。

看看[如何编写插件](http://docs.codehaus.org/display/SONAR/Getting+Started)（很可能你会创建一个装饰器）。你也有[具体的例子](https://github.com/SonarSource/sonar-examples)可以更快地开始。

# ruby-on-rails - Ruby 中的块是否被过度使用？

> ID：10918889
> 
> 赞同：3
> 
> 时间：2012-06-06T17:10:38.153
> 
> 标签：ruby-on-rails, ruby

我开始学习 Ruby，毫无疑问，最难理解的事情就是积木。

看看他们使用的一些例子，其中一些似乎不必要的复杂，几乎就像有人试图混淆代码一样。

例如，下面是 Rails 的一些迁移代码：

```
create_table :posts do |t|
    t.string :name
    t.string :title
    t.text :content
    t.timestamps
end 
```

假设**t**指的是创建的表，这和这个不一样吗？：（添加括号以使其更清楚）

```
t = create_table(:posts)
t.string(:name)
t.string(:title)
t.text(:content)
t.timestamps() 
```

第一个版本如何“更好”或更清晰？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T17:16:20.997

翻转你的问题：第一个版本如何更复杂？

简短的回答：一般来说，没有。块用于特定目的。

IMO 该块更具交流性，因为：

*   块中的所有内容都是相关的
*   范围在语言级别强制执行（块之后不再`t`）

块也可以在方法的`yield`. 例如，产生文件的块可以关闭文件。

那些添加的括号并没有使任何事情变得更清楚：Ruby（和类似语言）的优点之一是可选括号使事情看起来更具声明性，这就是表定义。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-06T17:16:37.750

使用块的一个原因是在块之后是否需要做一些事情。

例如，假设`now_commit_sql`需要调用一些私有迁移方法来实际提交 SQL 以创建`posts`表。在您列出的第二种方式中，由用户记住输入`t.now_commit_sql()`（除了`now_commit_sql`必须公开的方法）。

在块方式中，在 之后`yield`，它可以自己调用，因此对用户来说更加无缝且不易出错。此外，如果 Rails 开发人员需要在未来的版本中调用其他方法，例如`log_sql()`你有什么，他们可以将其粘贴在那里，而不是用户现在必须知道`t.log_sql()`除了调用`.now_commit_sql()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T17:41:31.003

块的真正好处是它们允许您将代码作为参数传递。您将要执行的操作提供给该方法，并在某个时候该方法执行您的块。当这种情况发生时，之前和之后发生的事情都是由你封装的，你只需要关心你给方法的代码。

有没有可以通过其他方式完成的情况？也许吧，但是你根据块改变的类，你不需要担心它或采取额外的行动，因为它们是封装的，你只需要关心块代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T17:14:35.557

因为它是一个块，所以乍一看很清楚，整个东西都是相关的。在第二个示例中，您必须查看两次。

# c# - 添加新项目时如何将所选项目保留在列表视图中？

> ID：10918893
> 
> 赞同：0
> 
> 时间：2012-06-06T17:11:02.117
> 
> 标签：c#, winforms, listview, items

我正在尝试制作一个应用程序，让我检查 ListView 中的项目，并且一切正常，但是如果我在检查项目时向 ListView 添加更多项目。由于 ListView 已重新加载，因此将它们全部取消选中。有没有办法解决这个问题？所以即使我向其中添加新项目，我的所有项目都会保持检查状态？这是我当前的代码。

```
 TextReader reader = new StringReader(richTextBox1.Text);
            string[] strItems = null;
            foreach (ListViewItem items in listView1.Items)
            {
                items.Remove();
            }
            while (reader.Peek() != -1)
            {
                ListViewItem item = new ListViewItem();
                strItems = reader.ReadLine().Split("-".ToCharArray());
                item.Text = strItems[0].ToString();
                item.SubItems.Add(strItems[1].ToString());
                item.SubItems.Add(strItems[2].ToString());
                item.SubItems.Add(strItems[3].ToString());
                item.SubItems.Add(strItems[4].ToString());
                listView1.Items.Add(item);
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:19:01.330

你可以做类似的事情（并通过找到更好的标签/存在逻辑来改进它）：

```
 TextReader reader = new StringReader(richTextBox1.Text);
        string[] strItems = null;
        while (reader.Peek() != -1)
        {
            string nextRow = reader.ReadLine();
            if (!listView1.Items.ContainsKey(nextRow.GetHashCode().ToString()))
            {
               ListViewItem item = new ListViewItem();
               item.Name = nextRow.GetHashCode().ToString();
               strItems = nextRow .Split("-".ToCharArray());
               item.Text = strItems[0].ToString();
               item.SubItems.Add(strItems[1].ToString());
               item.SubItems.Add(strItems[2].ToString());
               item.SubItems.Add(strItems[3].ToString());
               item.SubItems.Add(strItems[4].ToString());
               listView1.Items.Add(item);
            }
        } 
```

唯一的问题是，如果您尝试删除不在新读取字符串中的项目，但您也可以解决它（告诉我您是否需要它，我会添加它）

# python - 如何使用 BeautifulSoup 模拟“:contains”？

> ID：10918898
> 
> 赞同：5
> 
> 时间：2012-06-06T17:11:16.167
> 
> 标签：python, google-app-engine, beautifulsoup

我正在做一个需要一点点刮擦的项目。该项目位于 Google App Engine 上，我们目前使用的是 Python 2.5。理想情况下，我们会使用[PyQuery](http://packages.python.org/pyquery/)，但由于在 App Engine 和 Python 2.5 上运行，这不是一个选项。

我已经看到过类似这样的问题，即[查找带有特定文本的 HTML 标记](https://stackoverflow.com/questions/866000/using-beautifulsoup-to-find-a-html-tag-that-contains-certain-text)，但它们并没有完全达到目标。

我有一些看起来像这样的 HTML：

```
<div class="post">
    <div class="description">
        This post is about <a href="http://www.wikipedia.org">Wikipedia.org</a>
    </div>
</div>
<!-- More posts of similar format --> 
```

在 PyQuery 中，我可以做这样的事情（据我所知）：

```
s = pq(html)
s(".post:contains('This post is about Wikipedia.org')")
# returns all posts containing that text 
```

天真地，我以为我可以在 BeautifulSoup 中做这样的事情：

```
soup = BeautifulSoup(html)
soup.findAll(True, "post", text=("This post is about Google.com"))
# [] 
```

然而，这并没有产生任何结果。我将查询更改为使用正则表达式，并且走得更远，但仍然没有运气：

```
soup.findAll(True, "post", text=re.compile(".*This post is about.*Google.com.*"))
# [] 
```

如果我省略它，它会起作用`Google.com`，但是我需要手动进行所有过滤。**无论如何可以`:contains`使用 BeautifulSoup 进行模拟吗？**

*或者*，是否有一些适用于 App Engine（在 Python 2.5 上）的类似 PyQuery 的库？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T17:28:30.530

来自 BeautifulSoup 文档（强调我的）：

> “文本是一个参数，可让您搜索 NavigableString 对象 *而不是*标签”

也就是说，你的代码：

```
soup.findAll(True, "post", text=re.compile(".*This post is about.*Google.com.*")) 
```

不一样：

```
regex = re.compile('.*This post is about.*Google.com.*')
[post for post in soup.findAll(True, 'post') if regex.match(post.text)] 
```

您必须删除 Google.com 的原因是 BeautifulSoup 树中有一个 NavigableString 对象用于`"This post is about"`，另一个用于`"Google.com"`，但它们位于不同的元素下。

顺便说一句，`post.text`存在但没有记录，所以我也不会依赖它，我偶然编写了那个代码！使用其他方法将 . 下的所有文本混合在一起`post`。

# javascript - 在折线图上隐藏 D3 中的刻度标签

> ID：10918901
> 
> 赞同：18
> 
> 时间：2012-06-06T17:11:33.763
> 
> 标签：javascript, d3.js

我是 D3 的新手，只是有一个关于用 D3 制作的折线图上的刻度标签的快速问题。我正在使用 d3.svg.axis.scale().tickSize().tickSubdivide() 来生成我的刻度线。

有没有办法隐藏它们或改变它们的价值？例如，我有一个折线图，其中刻度标签是间隔（1、2、3 等），我想将它们更改为字符串，如 ('Jan', 'Feb', 'Mar', 'Apr '， ETC）。那可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-21T04:03:16.890

您可以像这样隐藏刻度格式：

```
myGraph.yAxis.tickFormat(function (d) { return ''; }); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-07T09:10:57.497

是的，可以为您的报价生成不同的格式。您可以在此处找到一些详细信息：[https](https://github.com/mbostock/d3/wiki/SVG-Axes#wiki-tickFormat) ://github.com/mbostock/d3/wiki/SVG-Axes#wiki-tickFormat 。不幸的是，目前并非所有格式都记录在案，因此您可能需要查看该方法的 d3 代码。如果您同时拥有 xAxis 和 yAxis，则可以执行以下操作：

```
myGraph.yAxis.tickFormat(d3.format(',.2%')); 
```

还可以查看 Bob Monteverde 的图表库：[https](https://github.com/novus/nvd3) ://github.com/novus/nvd3 （尤其是在源文件夹中，在轴组件处），如果您想查看与轴组件和轴刻度格式相关的许多技巧.

另一方面，如果您不希望显示刻度，那么我想您可以创建一个没有刻度的轴组件（我没有尝试过，很难），但是当您有自定义时，我看不出这样做的意义格式化程序，你几乎可以用刻度做任何你想做的事情。

此致！

# jquery - 无法从网页写入 XML

> ID：10918902
> 
> 赞同：0
> 
> 时间：2012-06-06T17:11:37.580
> 
> 标签：jquery, html, css, xml

我用 HTML/CSS/JQuery/XML/XSLT 编写了一个小型应用程序，最终写入位于服务器上我的文件旁边的 XML 文件。99% 的情况下一切正常，但某些用户在写入 XML 文件时会遇到问题。

遇到问题的用户都使用位于其工作场所的计算机，对于所有用户来说，这些计算机似乎都在大公司中，可能具有严格的安全措施。但仍然 - XML 在我的服务器上，不应该与世界上最偏执的系统真正相关吗？

现在，我想知道这到底是什么。这是什么原因造成的？我怎样才能发现这个问题用户，以便我可以给他们特殊的待遇？

该网站可以在 www.northcreek.no/em 查看

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:33:59.160

我猜所有这些用户都使用 IE，因为当我在 IE 中尝试它时，我得到脚本错误并且无法完成最后一步。

所以你首先应该修复脚本错误。

# python - 类似 cron 的调度器，介于 cron 和 celery 之间

> ID：10918905
> 
> 赞同：3
> 
> 时间：2012-06-06T17:11:44.143
> 
> 标签：python, django, cron, celery

我想在我的 django 项目上运行定期任务，但我不希望在我的项目中捆绑 celery/django-celery（带有 celerybeat）的所有复杂性。

我还想将配置与时间以及在我的 SCM 中运行的命令一起存储。

我的生产机器运行的是 Ubuntu 10.04。

虽然我可以学习和使用 cron，但我觉得应该有更高级别（用户友好）的方式来做到这一点。（就像 UFW 对 iptables 一样）。

有这种事吗？任何提示/建议？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T19:22:04.423

有几个基于 Django 的调度应用程序，例如[django](https://bitbucket.org/wnielson/django-chronograph/) -chronograph和django [-chroniker](https://github.com/chrisspen/django-chroniker)和[django-cron](http://code.google.com/p/django-cron/)。我将 django-chronograph 分叉到 django-chroniker 以修复一些错误并将其扩展为我自己的用例。我仍然在一些项目中使用 Celery，但就像你指出的那样，它有点过于复杂并且有很大的堆栈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:19:02.177

在我个人看来，我会学习如何使用 cron。这不会超过 5 到 10 分钟，它是在 Linux 服务器上工作时必不可少的工具。

您可以做的是设置一个 cronjob，它每分钟请求 django 实例的一页，并让 django 脚本根据存储在数据库中的配置确定现在是什么时间以及需要做什么。这是我在其他类似应用程序中看到的方法。

# video - 如何使用ffmpeg在视频中心添加透明水印？

> ID：10918907
> 
> 赞同：85
> 
> 时间：2012-06-06T17:12:14.937
> 
> 标签：video, ffmpeg, watermark

我目前正在使用这些命令：

```
Top left corner
ffmpeg –i inputvideo.avi -vf "movie=watermarklogo.png [watermark]; [in][watermark] overlay=10:10 [out]" outputvideo.flv

Top right corner
ffmpeg –i inputvideo.avi -vf "movie=watermarklogo.png [watermark]; [in][watermark] overlay=main_w-overlay_w-10:10 [out]" outputvideo.flv

Bottom left corner
ffmpeg –i inputvideo.avi -vf "movie=watermarklogo.png [watermark]; [in][watermark] overlay=10:main_h-overlay_h-10 [out]" outputvideo.flv

Bottom right corner
ffmpeg –i inputvideo.avi -vf "movie=watermarklogo.png [watermark]; [in][watermark] overlay=(main_w-overlay_w-10)/2:(main_h-overlay_h-10)/2 [out]" outputvideo.flv 
```

如何放置视频的水印中心？

* * *

## 回答 #1

> 赞同：210
> 
> 时间：2012-06-06T19:29:56.400

[使用叠加](https://ffmpeg.org/ffmpeg-filters.html#overlay)过滤器在视频上添加水印/徽标图像的示例。

# 居中

[![在此处输入图像描述](../Images/c60154f05a6ef140de82ce91b884e3f3.png)](https://i.stack.imgur.com/npQKo.jpg)

```
ffmpeg -i input.mp4 -i logo.png -filter_complex "overlay=(main_w-overlay_w)/2:(main_h-overlay_h)/2" -codec:a copy output.mp4 
```

或使用缩短的覆盖选项：

```
overlay=(W-w)/2:(H-h)/2 
```

# 左上方

这是最简单的，因为如果您没有提供叠加选项，默认设置是将图像放在左上角。

此示例添加 5 个像素的填充，因此图像不会接触边缘：

```
overlay=5:5 
```

# 右上

使用 5 像素的填充：

```
overlay=main_w-overlay_w-5:5 
```

或使用缩短的选项：

```
overlay=W-w-5:5 
```

# 右下角

使用 5 像素的填充：

```
overlay=main_w-overlay_w-5:main_h-overlay_h-5 
```

或使用缩短的选项：

```
overlay=W-w-5:H-h-5 
```

# 左下方

使用 5 像素的填充：

```
overlay=5:main_h-overlay_h 
```

或使用缩短的选项：

```
overlay=5:H-h-5 
```

# 透明度/不透明度/阿尔法

[使用format](https://ffmpeg.org/ffmpeg-filters.html#format)和[colorchannelmixer](https://ffmpeg.org/ffmpeg-filters.html#colorchannelmixer)过滤器使水印 50% 透明的示例：

```
ffmpeg -i input.mp4 -i watermark.jpg -filter_complex "[1]format=rgba,colorchannelmixer=aa=0.5[logo];[0][logo]overlay=(W-w)/2:(H-h)/2:format=auto,format=yuv420p" -c:a copy output.mp4 
```

# 提高质量

使用[覆盖](https://ffmpeg.org/ffmpeg-filters.html#overlay)`format=auto`过滤器中的选项可以使 PNG 水印看起来更好：

```
ffmpeg -i input.mp4 -i watermark.png -filter_complex "overlay=5:H-h-5:format=auto,format=yuv420p" -c:a copy output.mp4 
```

请注意添加[格式](https://ffmpeg.org/ffmpeg-filters.html#format)过滤器（是的，与选项同名，但独立过滤器）将其重置为 MP4 输出所需的 YUV 4:2:0。`,format=yuv420p`如果您不输出 MP4，请删除。

# 相对于主视频缩放水印

使用[scale2ref](https://ffmpeg.org/ffmpeg-filters.html#scale2ref)过滤器：

使徽标成为主视频大小的 10% (1/10) 的示例：

```
ffmpeg -i input.mp4 -i watermark.png -filter_complex "[1][0]scale2ref=w=oh*mdar:h=ih*0.1[logo][video];[video][logo]overlay=5:H-h-5" -c:a copy output.mp4 
```

# spring - 数据库中数据的@Valid 和绑定结果

> ID：10918916
> 
> 赞同：1
> 
> 时间：2012-06-06T17:12:41.423
> 
> 标签：spring, spring-mvc

我在其中一个 Web 应用程序中使用 Spring 验证（JSR 303）。当用户提交数据并且 Spring 验证工作非常整洁时，我没有任何问题。但是我有一个场景，我必须从服务中获取数据并验证它和然后将它们绑定到我的视图。（非表单验证）。在这种情况下我如何使用@Valid 还是必须以不同的方式完成？

这是一个示例代码，我从

```
 @RequestMapping(value = "/{id}", method = RequestMethod.GET)
public ModelAndView getView(
        @PathVariable("id") final String id, @User user,
        HttpSession session) {

    User user=  getUser();

   BindingResult result = new BeanPropertyBindingResult(user, "user");

   validator.validate(user, result);

   if(result.hasErrors()){
       logger.log(Level.ERROR, "Errors");
   }

  ModelAndView view = new ModelAndView ("home");
  view.addObject("user",user );
  view.addAllObject(result.getModel());

   return view; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T17:38:46.833

据我了解，您需要将默认值`org.springframework.validation.Validator`注入您的控制器（如果`@Valid`有效，您应该能够做到）

```
@Autowired
Validator validator; 
```

手动运行验证如下

```
User user = ...;
BindingResult result = BeanPropertyBindingResult(user, "user");
validator.validate(user, result); 
```

并将结果合并到`ModelMap`（将其声明为您的方法的参数）如下

```
model.addAllAttributes(result.getModel()); 
```

# facebook - 一些 facebook 朋友的生日返回为空，但我拥有正确的 API 权限

> ID：10918919
> 
> 赞同：3
> 
> 时间：2012-06-06T17:12:55.247
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我想在我的应用程序中获取**我朋友的生日**，其中一些是**null**。我以为那些人没有生日套餐，但**他们确实有**。

我的 fql 查询是：

`SELECT uid,name,birthday_date FROM user WHERE uid IN (SELECT uid2 from friend where uid1=me())`

当我请求时，生日也是空的`/me/friends?fields=birthday`

我的访问令牌具有`friends_birthday`权限集。

我也尝试在 FQL 查询中使用`birthday`而不是。`birthday_date`结果相同。

我想这是因为他们以某种方式选择退出，但我不知道如何。

是否有其他解决方案可以实际从 Facebook 获取他们的生日？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T17:32:52.963

当您的朋友使用它们时，也可以删除应用程序访问您的数据的能力，此选项将阻止当前会话用户通过 API 看到有关其朋友的某些信息，即使该信息可在 Facebook.com 上访问

此设置位于[https://www.facebook.com/settings/?tab=privacy](https://www.facebook.com/settings/?tab=privacy)的隐私设置中，位于“广告、应用程序和网站”->“人们如何将您的信息带到他们使用的应用程序”下，如下所示：

![截屏](../Images/389af5f66b6ec83eb5478427984d9562.png)

{edit} 你可以用测试用户自己测试这个，这是假设生日在前端对你可见的最可能的原因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:27:12.787

这些人可能已将他们的生日设置为仅对他们自己或仅对某些受限朋友可见。如果我们尝试在其旁边编辑我们的生日，这是一个可用的选项。这可能会导致您的应用无法使用它进行查询。

# mongodb - MongoDB数据库架构设计

> ID：10918921
> 
> 赞同：12
> 
> 时间：2012-06-06T17:13:03.960
> 
> 标签：mongodb, android-activity, stream

我有一个拥有 50 万用户的网站（在 sql server 2008 上运行）。我现在想包括用户及其朋友的活动流。在 SQL Server 上测试了一些东西之后，很明显 RDMS 不是这种功能的好选择。它很慢（即使我对数据进行了严重的非规范化）。因此，在查看了其他 NoSQL 解决方案之后，我认为我可以使用 MongoDB 来解决这个问题。我将遵循基于**activitystrea.ms** [json 规范的活动流数据结构](http://activitystrea.ms/specs/json/1.0/) 所以我的问题是：MongoDB 中活动流的最佳模式设计是什么（有这么多用户，您几乎可以预测它的写入量会很大，因此我选择了 MongoDB——它具有出色的“写入”性能。我考虑了 3 种类型的结构，请告诉我这是否有意义或者我应该使用其他模式模式。

1 - 以这种模式将每个活动与所有朋友/关注者一起存储：

```

    {
     _id:'activ123',
     演员：{
            编号：person1
            },
    动词：'跟随'，
    目的：{
            对象类型：'人'，
            id:'person2'
            },
    更新：日期（），
    消费者：[
            person3, person4, person5, person6, ... 等等
            ]

    }

```

2 - 第二个设计：集合名称-activity_stream_fanout

```
    {
    _id:'activ_fanout_123',
    人名：person3，
    活动：[
    {
     _id:'activ123',
     演员：{
            编号：person1
            },
    动词：'跟随'，
    目的：{
            对象类型：'人'，
            id:'person2'
            },
    更新：日期（），
    }

    ],[
    //活动提要2
    ]

    }

```

3 - 这种方法是将活动项目存储在一个集合中，将消费者存储在另一个集合中。在活动中，您可能有这样的文档：

```
    { _id：“123”，
      演员：{人：“UserABC”}，
      动词：“跟随”，
      对象：{人：“someone_else”}，
      更新日期：日期（...）

    }

```

然后，对于追随者，我将拥有以下“通知”文件：

```
    { activityId：“123”，消费者：“someguy”，updatedOn：日期（...）}
    {activityId：“123”，消费者：“otherguy”，updatedOn：日期（...）}
    {activityId：“123”，消费者：“thirdguy”，updatedOn：日期（...）}

```

非常感谢您的回答。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-07T10:52:03.490

我会采用以下结构：

1.  对发生的所有操作使用一个集合，`Actions`

2.  为谁关注谁使用另一个集合，`Subscribers`

3.  使用第三个集合，`Newsfeed`对于某个用户的新闻提要，从`Actions`集合中扇出项目。

该`Newsfeed`集合将由异步处理 new 的工作进程填充`Actions`。因此，新闻提要不会实时填充。我不同意 Geert-Jan 的观点，即实时性很重要。我相信大多数用户都不关心*大多数*（不是全部）应用程序中的一分钟延迟（对于实时，我会选择完全不同的架构）。

如果您有大量的`consumers`，则扇出可能需要一段时间，确实如此。另一方面，将消费者直接放入对象中也不适用于非常大的追随者数量，并且会创建占用大量索引空间的过大对象。

然而，最重要的是，扇出设计**更加灵活**，并且允许相关性评分、过滤等。我最近刚刚写了一篇关于[使用 MongoDB 进行新闻提要模式设计](http://www.waistcode.net/blog/mongodb-newsfeed-schema-design-for-entexis)的博客文章，其中我更详细地解释了其中的一些灵活性。

说到灵活性，我会小心那个 activitystrea.ms 规范。作为不同提供商之间互操作的规范似乎是有意义的，但只要您不打算聚合来自各种应用程序的活动，我就不会将所有详细信息存储在我的数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T22:14:33.500

我相信你应该看看你的访问模式：你可能对这些数据执行最多的查询，等等。

对我来说，需要最快的用例是能够将某个活动推送到每个“活动消费者”的“墙上”（以 fb 而言），并在活动进入时立即执行。

从这个角度来看（我没有考虑太多）我会选择 1，因为 2\. 似乎在处理某个用户之前为某个用户批处理活动？因此，如果失败，则“立即”需要更新。此外，对于这个用例，我没有看到 3\. 超过 1 的优势。

对 1 的一些增强？问问自己，您是否真的需要为每个活动定义一组消费者的灵活性。真的有必要在这个细粒度的范围内指定这个吗？相反，提及“演员”的“朋友”还不够吗？（从长远来看，这将有很多空间，因为当消费者通常在数百个（？）范围内时，我看到消费者数组是每个活动的整个消息的大部分。

在一些相关的注释上：根据您可能希望如何为这些活动流实现实时通知，可能值得查看 Pusher - [http://pusher.com/](http://pusher.com/)和类似的解决方案。

hth

# php - PHP 单引号字符串中的转义反斜杠字符

> ID：10918924
> 
> 赞同：0
> 
> 时间：2012-06-06T17:13:27.943
> 
> 标签：php

我从 PHP 手册中摘录了这些句子：

```
'this is a simple string',
'Arnold once said: "I\'ll be back"',
'You deleted C:\\*.*?',
'You deleted C:\*.*?',
'This will not expand: \n a newline',
'Variables do not $expand $either' 
```

我想使用 PHP 代码来回显它们，就像它们出现的那样，使用转义的单引号（如第二句）和双反斜杠（如第三句）。这是我到目前为止所拥有的：

```
<?php

$strings = array(
        'this is a simple string',
        'Arnold once said: "I\'ll be back"',
        'You deleted C:\\*.*?',
        'You deleted C:\*.*?',
        'This will not expand: \n a newline',
        'Variables do not $expand $either');

$patterns = array('~\\\'~', '~\\\\~');
$replacements = array('\\\\\'', '\\\\\\\\');

foreach($strings as $string)
{
        echo '\'' . preg_replace($patterns, $replacements, $string) . '\'' . '</br>';
}
?> 
```

输出是：

```
'this is a simple string'
'Arnold once said: "I\\'ll be back"'
'You deleted C:\\*.*?'
'You deleted C:\\*.*?'
'This will not expand: \\n a newline'
'Variables do not $expand $either' 
```

但如果可能的话，我想完全按照我的代码中列出的方式回显这些字符串。我在使用双反斜杠字符 (\) 时遇到问题。我的第二个模式（'~\\~'）似乎取代了单反斜杠和双反斜杠。我还尝试使用具有相同结果的 addcslashes()。

（我最近在别处问过这个问题，但没有解决方案）

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T09:53:27.117

与其干涉 ，不如`preg_replace()`考虑使用`var_export()`打印字符串的“真实副本”：

```
foreach ($strings as $s) {
    echo var_export($s, true), PHP_EOL;
} 
```

输出：

```
'this is a simple string'
'Arnold once said: "I\'ll be back"'
'You deleted C:\\*.*?'
'You deleted C:\\*.*?'
'This will not expand: \\n a newline'
'Variables do not $expand $either' 
```

如您所见，第 3 句和第 4 句与 PHP 相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:38:28.063

试试这个代码。它按预期工作。

```
 <?php

$strings = array(
    'this is a simple string',
    'Arnold once said: "I\'ll be back"',
    'You deleted C:\\*.*?',
    'You deleted C:\*.*?',
    'This will not expand: \n a newline',
    'Variables do not $expand $either');

 $patterns = array('~\\\'~', '~\\\\~');
 $replacements = array('\\\\\'', '\\\\\\\\');

 foreach($strings as $string){
    print_r(strip_tags($string,"\n,:/"));
    print_r("\n");
 }
?> 
```

您可以在 strip_tags 中指定 allowable_tags。参考[strip_tags](http://www.php.net/manual/en/function.strip-tags.php)进一步了解这里是[DEMO](http://codepad.org/rdc7AzXL)

# php - Cakephp 工作队列

> ID：10918925
> 
> 赞同：1
> 
> 时间：2012-06-06T17:13:44.240
> 
> 标签：php, cakephp, amazon-web-services, cakephp-2.0, amazon-sqs

我正在寻找使用工作队列来委派一些工作。我知道像 Amazon SQS 或 Beanstalkd 这样的服务非常适合解决这个问题。但是，在这两种情况下，我都必须创建一个每隔 x 秒轮询一次队列的守护进程。还有其他方法可以通过某种推送系统来做到这一点吗？

有人有使用 SQS+SNS 呼叫工人的经验吗？

谢谢。

# iphone - 如何延迟地图视图中的注释

> ID：10918927
> 
> 赞同：2
> 
> 时间：2012-06-06T17:13:57.687
> 
> 标签：iphone, objective-c, mkmapview, mkannotation

我的应用程序中有两个位置。欧洲第一，美国第二。

当我的应用程序加载时，拳头位置区域是可见的，并且小红球注释会动画化。但是，当我按下将我带到第二个位置的按钮时，应用程序会将我带到那里，但是当新区域出现时，第二个位置注释已经存在。

有没有办法延迟新的注释动画并仅在新区域可见时才显示？

可能当地图从位置 1 移动到位置 2 时，会出现动画。

注意：当我将第二个位置设置为离位置 1 更近时，注释动画效果很好，我可以看到它。

谢谢指教！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T20:55:10.620

是的，你可以使用`NSTimer`.

```
NSTimer *timer = [NSTimer scheduledTimerWithTimeInterval:(Amount of Time you want before the method) target:self selector:@selector(MethodName) userInfo:nil repeats:NO];
[timer invalidate];
timer = nil; 
```

这只是说，运行`@selector(method)`之后`(Amount of Time you want...)`并`repeats:NO`说它会发生一次，然后永远不会再发生。

这应该可以，但是您需要创建一个新方法来制作注释并在此处调用该方法。

# android - android - 在重建列表视图之前删除列表视图项

> ID：10918930
> 
> 赞同：0
> 
> 时间：2012-06-06T17:14:08.687
> 
> 标签：android, list, listview

我有一个列表视图，当我返回并返回我的列表活动时，列表被复制了。需要删除第一个列表，因此只显示一个列表。有任何想法吗？？？

这是我的列表活动代码：

```
package com.sportspubfinder;

import java.net.MalformedURLException;
import java.net.URL;
import java.util.ArrayList;
import java.util.HashMap;

import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;

import org.xml.sax.InputSource;
import org.xml.sax.XMLReader;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.Intent;
import android.net.ConnectivityManager;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListView;

public class ListPubsActivity extends Activity {

    ProgressDialog ShowProgress;

    ListView lv1;

    int selectedRadius;

    Double userLat;
    Double userLong;

    public static ArrayList<SetterGetter> PubList = new ArrayList<SetterGetter>();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.pubslist);

        lv1 = (ListView) findViewById(R.id.listView1);

        Bundle extras = getIntent().getExtras();
        if(extras != null){
            //retrieve the passed through radius and location readings 
            selectedRadius = extras.getInt("radius_set");
            userLat = extras.getDouble("latitude_set");
            userLong = extras.getDouble("longitude_set");
        }

         //show progres bar whilst a connection is made with the url
        ShowProgress = ProgressDialog.show(ListPubsActivity.this, "",
                "Loading Pubs. Please wait...", true);

        /* --If the INAPUB api was implemented, the url would take the passed radius (selectRadius) and location of the user---
          * "http://api.inapub.co.uk/venues/geocode/"+userLat+"/"+userLong+"/"+selectedRadius+"/?API_Key=7xa3tdmjkhu6jwjvp746zgg4");*/ 
        new loadingTask().execute("http://itsuite.it.brighton.ac.uk/jp232/pubs.php");

        //check which list item has been selected
        lv1.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {

                Intent intent = new Intent(ListPubsActivity.this, PubActivity.class);
                //pass the pubs information through to the next activity
                intent.putExtra("pubName", PubList.get(position).getName()); 
                intent.putExtra("pubImage", PubList.get(position).getThumbnail()); 
                intent.putExtra("pubAddress", PubList.get(position).getAddress()); 
                intent.putExtra("pubTown", PubList.get(position).getTown()); 
                intent.putExtra("pubCounty", PubList.get(position).getCounty()); 
                intent.putExtra("pubDescription", PubList.get(position).getDescription()); 
                intent.putExtra("pubFacilities", PubList.get(position).getFacilities()); 
                intent.putExtra("pubRating", PubList.get(position).getRating()); 
                intent.putExtra("pubLatitude", PubList.get(position).getLatitude()); 
                intent.putExtra("pubLongitude", PubList.get(position).getLongitude());

                startActivity(intent);

            }
        });

    }

    class loadingTask extends AsyncTask<String, Void, String> {
        //check if there's an Internet connection
        /*public boolean isOnline() {
            ConnectivityManager cm =
                (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);

            return cm.getActiveNetworkInfo() != null && 
               cm.getActiveNetworkInfo().isConnectedOrConnecting();
        }*/

        protected String doInBackground(String... urls) {
            //in background wait to receive the information from the ListHandler
            SAXHelper sh = null;
            try {
                sh = new SAXHelper(urls[0]);
            } catch (MalformedURLException e) {
                e.printStackTrace();
            }
            sh.parseContent("");
            return "";

        }

        protected void onPostExecute(String s) {
            //add Custom List Adapter once ListHandler has been received 
            lv1.setAdapter(new CustomAdapter(ListPubsActivity.this, PubList));
            //stop progress bar
            ShowProgress.dismiss();
        }
    }

    class SAXHelper {

        public HashMap<String, String> userList = new HashMap<String, String>();
        private URL url2;

        public SAXHelper(String url1) throws MalformedURLException {
            this.url2 = new URL(url1);
        }

        public ListHandler parseContent(String parseContent) {
            //add the ListHandler
            ListHandler df = new ListHandler();
            try {

                SAXParserFactory spf = SAXParserFactory.newInstance();
                SAXParser sp = spf.newSAXParser();
                XMLReader xr = sp.getXMLReader();
                xr.setContentHandler(df);
                xr.parse(new InputSource(url2.openStream()));
            } catch (Exception e) {
                e.printStackTrace();
            }
            return df;
        }

    }

    @Override
    protected void onPause(){
       super.onPause();
    }

    @Override
    protected void onStop(){
       super.onStop();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:19:42.130

```
公共静态 ArrayList PubList = new ArrayList();

```

我相信，由于静态类型，您的列表内容会被附加。

# php - 动态读取文件的保护

> ID：10918931
> 
> 赞同：0
> 
> 时间：2012-06-06T17:14:19.763
> 
> 标签：php

使用 URL 变量防止动态文件访问的最佳方法是什么？我正在连接两个 URL 变量，它们将形成我要访问的文件名，该文件名将加载 XML。

```
$type = $_REQUEST['type']
//(ie. AB);
$timeframe = $_REQUEST['timeframe']
//(ie. 00.04);

//create XML document object model (DOM)
$main_doc = new DOMDocument();
$s = SITE_DIR."/data/file.".$type.".".$timeframe.".xml"; 
// example file.AB.00.04.xml)
// will be adding test to see if file exists
$main_doc->load($s); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:31:43.343

您应该检查请求字符串是否不包含“..”并且也不包含“/”（如果您在 Windows 上，则为“\”），以便路径不指向您所在的目录以外的目录参考。

也许试试这个：

```
$timeframe = str_replace(array('..','/','\'),array('','',''),$timeframe); 
```

# iphone - UITableview 混合单元格

> ID：10918940
> 
> 赞同：0
> 
> 时间：2012-06-06T17:15:33.880
> 
> 标签：iphone, ios, uitableview

我的`UITableview`. 滚动或按下开关后，有时会开始混淆单元格。所以你可以让一个单元格的文本显示在另一个单元格中。我阅读了很多关于 tableViews 的内容，但没有发现任何适合我的代码的内容。这里是：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:CellIdentifier];

}

    if (indexPath.section == 0) {
        if (indexPath.row == 0) {
            cell.textLabel.text = NSLocalizedString(@"Course:",@"Course Section");
            cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
            cell.detailTextLabel.text = entryTableCourseName;

        }

       else if (indexPath.row == 1) {
            cell.textLabel.text = @"Due Date:";
            cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
            cell.detailTextLabel.text = entryTableDueDateString;            }
    }

    else if (indexPath.section == 1) {
        if (indexPath.row == 0) {
            //cell.textLabel.text = NSLocalizedString(@"Title", @"entryTableTaskTitle");
            [cell.contentView addSubview:nameField];

        }

        else if (indexPath.row == 1) {
            [cell.contentView addSubview:TaskView];
        }

    }

    else if (indexPath.section == 2) {

        if (entryTableGradeSwitch.on) {
            if (indexPath.row == 0) {
                cell.textLabel.text = NSLocalizedString(@"Grading", @"GradingCell");
                cell.accessoryView = entryTableGradeSwitch;
            }
            else if (indexPath.row == 1) {
                cell.textLabel.text = NSLocalizedString(@"Options", @"GradingCellOptions");
            }
        }
        else {
            cell.textLabel.text = NSLocalizedString(@"Grading", @"GradingCell");
            cell.accessoryView = entryTableGradeSwitch;
        }
    }

} 
```

我觉得我在设置细胞时做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T17:21:15.457

这一切都归功于单元格的可重用性。StackOverflow 上有很多关于此的帖子，我建议您搜索“UITableViewCell Reusability Problems”，您会遇到解决方案。

简而言之..这里发生的是，当您滚动时，单元格实质上会重新使用之前在该 indexPath 处使用的单元格，并且 cellForRowAtIndexPath 在该 indexpath 处分配一个不同的单元格。

***解决方案 ？***

1.  Use different reuse identifiers for each cell.
2.  Subclass your tableViewCell with the view or label that is getting messed up.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T18:27:00.180

Make sure you implement

```
- (void) prepareForReuse 
```

in your cell if you reuse them. In this routine clean up anything you added to the cell that you don't want to show up in another reuse. If you don't add any custom items just make sure when you populate a cell that you set everything even if it's empty.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T17:26:01.540

Every time you do this:

```
 [cell.contentView addSubview:TaskView] 
```

Or something like it, you are adding a new subview to the cell. As the cells get reused, you add more and more subviews.

From your code, it isn't even clear where nameView and taskView come from. They should be either added once when a cell is first created, and just configured thereafter, or they should be part of your cell as designed in the xib or storyboard.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-21T04:39:56.303

Here's a super-simple fix for this, and you still get to keep your reuse-identifiers! Also no subclassing or anything needed.

It's simple: just make sure and set ***all*** of your labels and views. This means that if one cell isn't going to use the detail text label, **still** set it to `@""`. By doing this, you make sure that no leftover data from the content that used the cell before is still there.

Super simple, and works every time! Also way better resource wise than not reusing your cells.

# magento - Magento 1.6 - 抱歉，此订单目前没有报价

> ID：10918943
> 
> 赞同：1
> 
> 时间：2012-06-06T17:15:53.900
> 
> 标签：magento, magento-1.6

我的 Magento 安装出现问题，它在结帐时不会显示任何运输方式。奇怪的是，购物车中的报价功能运行良好。查看 UPS 日志，我可以看到它在结帐期间从 UPS 获得了正常的运输信息，但它只是在沿线的某个地方发生故障并且没有显示它。UPS 日志中此结帐的条目在[这里](http://pastebin.com/cRWRiEvv)

我还启用了统一运费，但也不会显示。有什么想法吗？这可能会或可能不会有所不同，但我也安装了多仓库扩展。如果您需要更多信息

# python - IPython 在 PYTHONPATH 中搜索文件

> ID：10918944
> 
> 赞同：0
> 
> 时间：2012-06-06T17:16:03.497
> 
> 标签：python, path, ipython, pythonpath

如果只给出文件名，是否有任何方法可以让 IPython 搜索您的系统路径以查找文件？

我有一个文件`foo_060112.dat`位于一个文件夹中，其中包含许多在我的路径中的文件夹中唯一命名的数据文件。我希望能够在不指定完整路径的情况下简单地在此文件上调用一个`load`或`open`函数——这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:29:58.183

您可以编写自己的函数来搜索路径并根据您选择的模式返回一个打开的文件对象：

```
import sys
import os

def my_open(filename, mode):
    for path in sys.path:
        try:
            return open(os.path.join(path, filename), mode)
        except IOError:
            continue
    return None 
```

例子：`my_open('foo_060112.dat', 'rb')`

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-06T17:31:38.797

我认为这可能会对您有所帮助：

```
import os,sys

path = os.sytem('locate foo_060112.dat')

print path 
```

或者您也可以使用：

```
_SOURCE_FILE_PATH = '/home/admin/'
_each_folder = os.walk("%s/" %(_SOURCE_FILE_PATH))  
for x in _each_folder:           
        print x   
        if x[1] == []:   
            for y in x[2]:
                 if y == 'locate foo_060112.dat'    
                      f = open(y,'r')
                      data = f.read() 
```

# .net - 如何从未编译的 .NET Web 服务中引用自定义 DLL

> ID：10918947
> 
> 赞同：1
> 
> 时间：2012-06-06T17:16:21.080
> 
> 标签：.net, web-services, dll

由于各种原因，我不会深入探讨我需要在 Visual Studio 之外编写我的 .NET Web 服务。这本身并不困难，以下工作正常......

```
<%@ WebService Language="C#" Class="TestHW" %>

using System;
using System.Web.Services;
using System.Xml.Serialization

[WebService(Namespace="http://www.mydomain.com/services")]
public class TestHW : WebService {
    [WebMethod()]
    public string Add(int a, int b) {
        return a + b;
    }
} 
```

我需要从此 Web 服务引用自定义 .NET DLL，但我无法通过 .asmx 找到 DLL（位于同一目录中）。谷歌很难，因为每个人显然都想从 DLL 中引用 Web 服务，而不是反过来。一切都以 .NET 2.0 为目标。

```
using websvc; //DLL is websvc.dll with namespace websvc 
```

给出错误...

```
CS0246: The type or namespace name 'websvc' could not be found (are you missing a using directive or an assembly reference?) 
```

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:57:53.037

终于在[如何引用内联 Web 服务中的组件？](https://stackoverflow.com/questions/8345875/how-do-i-reference-a-component-in-an-inline-web-service)

```
<%@ Assembly Name="MyAssembly" %> 
```

或者

```
<%@ Assembly Src="path/myFile.cs" %> 
```

名称语法适用于已编译的 DLL，src 语法适用于开放代码。该dll似乎需要在根目录下的bin目录中。

# android - 重新映射传感器坐标

> ID：10918948
> 
> 赞同：1
> 
> 时间：2012-06-06T17:16:21.013
> 
> 标签：android, orientation

我想要发生的是重新映射坐标系，当手机远离它的“自然”方向时。因此，当使用手机时，它是横向的，它应该读取相同的值，就好像它是纵向的一样。

我正在检查旋转是否等于`Surface.ROTATION_90`，如果是，则重新映射坐标系。

我承认我不太明白如何正确地做到这一点，并且可以使用一些指导。

因此，您需要运行这两种方法：

```
SensorManager.getRotationMatrix(inR, I, grav, mag); 
SensorManager.remapCoordinateSystem(inR, SensorManager.AXIS_Y,SensorManager.AXIS_MINUS_X, outR); 
```

传递到这些方法需要什么？我创建了一个新的浮点数组，然后只将方向传感器数据传递给了磁场，但这不起作用。所以，我注册了加速度计和磁场传感器。将这两个数据中的数据输入到`getRotatioMatrix`方法中，我总是得到一个`NullPointerException`（即使 JavaDoc 说某些参数可以为空）。我什至尝试将数据传递给每个参数，但仍然得到一个`NullPointerException`.

我的问题是，我需要传递给 getRotationMatrix 方法的正确数据是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-23T14:31:12.087

我发现一种非常简单的方法是 SDK 示例**AccelerometerPlay**中使用的方法。

首先你得到这样的显示，例如在 onResume() 中：

```
WindowManager windowManager = (WindowManager) getSystemService(WINDOW_SERVICE);
mDisplay = windowManager.getDefaultDisplay(); 
```

然后在 onSensorChanged() 你可以使用这个简单的代码：

```
@Override
public void onSensorChanged(SensorEvent event) {
    if (event.sensor.getType() != Sensor.TYPE_ACCELEROMETER)
        return;

    switch (mDisplay.getRotation()) {
        case Surface.ROTATION_0:
            mSensorX = event.values[0];
            mSensorY = event.values[1];
            break;
        case Surface.ROTATION_90:
            mSensorX = -event.values[1];
            mSensorY = event.values[0];
            break;
        case Surface.ROTATION_180:
            mSensorX = -event.values[0];
            mSensorY = -event.values[1];
            break;
        case Surface.ROTATION_270:
            mSensorX = event.values[1];
            mSensorY = -event.values[0];
            break;
    }
} 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-22T05:56:29.910

这是我的代码，它可以在没有 NPE 的情况下工作。请注意，我只有一个 Listener，但您必须注册它才能监听两个传感器（ACCELEROMETER 和 MAGNETICFIELD）。

```
private SensorEventListener mOrientationSensorsListener = new SensorEventListener() {

    private float[] mR = new float[9];
    private float[] mRemappedR = new float[9];
    private float[] mGeomagneticVector = new float[3];
    private float[] mGravityVector = new float[3];

    @Override
    public void onSensorChanged(SensorEvent event) {
        synchronized(this) {
            if (event.sensor.getType() == Sensor.TYPE_ACCELEROMETER) {
                mGravityVector = Util.exponentialSmoothing(event.values, mGravityVector, 0.2f);
            } else if (event.sensor.getType() == Sensor.TYPE_MAGNETIC_FIELD) {
                mGeomagneticVector = Util.exponentialSmoothing(event.values, mGeomagneticVector, 0.5f);

                SensorManager.getRotationMatrix(mR, null, mGravityVector, mGeomagneticVector);
                SensorManager.remapCoordinateSystem(mR, SensorManager.AXIS_Y,SensorManager.AXIS_MINUS_X, mRemappedR);
            }
        }
    } 
```

该`exponentialSmoothing`方法对传感器结果进行了一些平滑处理，看起来像这样（alpha 值可以从 0 变为 1，其中 1 表示完全没有平滑）：

```
public static float[] exponentialSmoothing(float[] input, float[] output, float alpha) {
    for (int i=0; i<input.length; i++) {
        output[i] = output[i] + alpha * (input[i] - output[i]);
    }
    return output;
} 
```

至于`synchronized`位 - 我不确定它是否需要，只需在某处阅读并添加它。

# performance - 为什么选择 pk 列比选择非索引列快？

> ID：10918950
> 
> 赞同：1
> 
> 时间：2012-06-06T17:16:30.530
> 
> 标签：performance, oracle

我目前正在做一些测试，我注意到以下几点：

```
select field1 from table1 
```

将导致`index fast full scan`when`field1`是主键，因此成本较低（在我的情况下是**4690**），而

```
select field2 from table1 
```

将导致 a `table access full`（没有约束也没有索引 on `field2`，*但即使使用常规索引，结果也是相同的*），成本为**117591**。

当索引/约束涉及 JOIN/WHERE 子句时，我知道增益，但在我的情况下，没有任何过滤：我不明白为什么 PK 应该更快，因为*无论如何*，我正在检索*所有*行。 ..

是因为独特吗？Tom 说[唯一索引在结构上与传统索引相同](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:7641143144618)，这真的让我想知道为什么选择 PK 会比任何其他列花费更少。

感谢您的启发:-)

rgds。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T17:20:09.683

单列 b 树索引不存储 NULL 行的数据。因此，如果您有一个索引`field2`但`field2`允许`NULL`，Oracle 无法对索引进行扫描，而不会冒可能返回不正确数据的风险。因此，全表扫描是 Oracle`field2`检索`table1`. 如果添加`NOT NULL`约束`field2`，Oracle 至少应该能够考虑对索引进行全扫描。

当然，优化器是否选择使用索引（以及它最终分配给使用索引的成本）将取决于您在索引和表上收集的统计信息。如果您的统计数据不准确，优化器的成本估计将不准确，因此生成的计划可能效率低下。这就是人们通常被建议谨慎对待甲骨文对计划成本的估计的原因之一——如果您正在查看一个计划，很可能是因为您怀疑它效率低下，这应该意味着你不能依赖成本。通常，您最好查看每个步骤的基数估计，并根据您的数据分布确定这些估计是否有意义。

# macos - 当从 OSX 10.6 构建框架时，otool -l 在 OSX 10.5 上显示 (0x80000022) 未知加载命令

> ID：10918951
> 
> 赞同：2
> 
> 时间：2012-06-06T17:16:36.030
> 
> 标签：macos, frameworks, osx-leopard, otool

我使用 OSX 10.6 构建了一个框架，一切都很好，我将 Base SDK 和 Deployment SDK 设置为 10.5。我也只建造一个 i386 拱门。

当我将此框架带到 OSX 10.5 并在其上运行 otool -l 时，我得到以下结果：

“加载命令 6 cmd？（0x80000022）未知加载命令”

有人知道如何解决这个问题吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T15:40:25.710

结果是加载命令消息上的或位（0x80000000）：

```
"Load command 6 cmd ?(0x80000022) Unknown load command" 
```

意味着该命令是必需的，然后我发现我的基本 SDK 设置不正确，一旦我将其更正并将部署目标更改为 10.5，我得到 (0x00000022) ，这意味着它不需要，所以它是弱链接并且不不会造成任何问题。

所以我的问题是我的一个错误，但我添加了一些关于如何阅读失败的信息，所以希望这对其他人有用。

# eclipse-wtp - 在 Eclipse WTP 中部署 jar 依赖项时 JiBX 绑定丢失

> ID：10918952
> 
> 赞同：0
> 
> 时间：2012-06-06T17:16:37.030
> 
> 标签：eclipse-wtp, m2e, jibx

我正在使用 Elipse Indigo、maven 2.2.1、m2e 1.0.2、用于 wtp 0.15.2 的 maven 集成、用于 JiBX 1.2.3 的 m2e 连接器。

我有一个包含 jibx 绑定的共享 maven jar 工件。.project 文件如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
    <name>my-binding</name>
    <comment></comment>
    <projects>
    </projects>
    <buildSpec>
            <buildCommand>
                <name>org.eclipse.wst.common.project.facet.core.builder</name>
            <arguments>
                </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.jdt.core.javabuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.jibx.eclipse.JibxBindingBuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.m2e.core.maven2Builder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.wst.validation.validationbuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
    </buildSpec>
    <natures>
        <nature>org.eclipse.jem.workbench.JavaEMFNature</nature>
        <nature>org.eclipse.wst.common.modulecore.ModuleCoreNature</nature>
        <nature>org.eclipse.jdt.core.javanature</nature>
        <nature>org.eclipse.m2e.core.maven2Nature</nature>
        <nature>org.jibx.eclipse.JibxNature</nature>
        <nature>org.eclipse.wst.common.project.facet.core.nature</nature>
    </natures>
    </projectDescription> 
```

我已按照给出的说明设置[m2e Maven Eclipse 插件](http://jibx.sourceforge.net/maven-jibx-plugin/m2e.html)。我使用 build-helper-maven-plugin（带有 eclipse 连接器）将生成的源包含在源文件夹中。

当我在 Eclipse 中编译它时，JiBX 绑定运行正常 - 我可以在 JiBX 控制台中看到输出，并在 target/classes 目录中看到修改后的类。

然后我在战争神器中使用这个生成的 jar。

项目文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
    <name>my-webapp</name>
    <comment></comment>
    <projects>
    </projects>
    <buildSpec>
        <buildCommand>
            <name>org.eclipse.wst.jsdt.core.javascriptValidator</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.wst.common.project.facet.core.builder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.jdt.core.javabuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.wst.validation.validationbuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.m2e.core.maven2Builder</name>
            <arguments>
            </arguments>
        </buildCommand>
    </buildSpec>
    <natures>
        <nature>org.eclipse.jem.workbench.JavaEMFNature</nature>
        <nature>org.eclipse.wst.common.modulecore.ModuleCoreNature</nature>
        <nature>org.eclipse.jdt.core.javanature</nature>
        <nature>org.eclipse.m2e.core.maven2Nature</nature>
        <nature>org.eclipse.wst.common.project.facet.core.nature</nature>
        <nature>org.eclipse.wst.jsdt.core.jsNature</nature>
    </natures>
</projectDescription> 
```

我生成`org.eclipse.wst.common.component`的文件是（部分）：

```
<?xml version="1.0" encoding="UTF-8"?>
<project-modules id="moduleCoreId" project-version="1.5.0">
    <wb-module deploy-name="my-webapp">
        <wb-resource deploy-path="/" source-path="/target/m2e-wtp/web-resources"/>
        <wb-resource deploy-path="/" source-path="/src/main/webapp" tag="defaultRootSource"/>
        <wb-resource deploy-path="/WEB-INF/classes" source-path="/src/main/java"/>
        <wb-resource deploy-path="/WEB-INF/classes" source-path="/src/main/resources"/>
        <dependent-module archiveName="my-binding-1.79.0-SNAPSHOT.jar" deploy-path="/WEB-INF/lib" handle="module:/resource/my-binding/my-binding">
            <dependency-type>uses</dependency-type>
        </dependent-module>
        <property name="context-root" value="my-webapp"/>
        <property name="java-output-path" value="/my-webapp/target/classes"/>
    </wb-module>
</project-modules> 
```

我使用“服务模块而不发布”和“从不自动发布”选项集运行 wtp。当试图在 jar 中引用 jibx 修改的类时，我`java.lang.NoSuchMethodError`在引用 JiBX 生成的方法时得到了标准。绑定项目的目标目录仍然包含 jibx 修改的类文件。

这可能是错误的路径，但是当我修改 jar 工件的 .project 文件以跳过 wtp 添加的性质时，它似乎可以工作，即使用以下命令重建 my-binding 项目：

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
    <name>my-binding</name>
    <comment></comment>
    <projects>
    </projects>
    <buildSpec>
        <buildCommand>
            <name>org.eclipse.jdt.core.javabuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.jibx.eclipse.JibxBindingBuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.m2e.core.maven2Builder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.wst.validation.validationbuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
    </buildSpec>
    <natures>
        <nature>org.eclipse.jdt.core.javanature</nature>
        <nature>org.eclipse.m2e.core.maven2Nature</nature>
        <nature>org.jibx.eclipse.JibxNature</nature>
    </natures>
    </projectDescription> 
```

..重新启动webapp，它工作正常。重建 webapp，性质被添加回绑定项目，它再次被破坏。

我在这里错过了一个技巧（我曾希望旧的 wtp-eclipse 舞蹈已成为过去）。有任何想法吗？

**更新：** 进一步播放后，我将其范围缩小到共享类上的损坏绑定

从命令行构建时，似乎所有绑定都是一次构建的（或者至少不更改依赖 jar 中的类），但是当通过 eclipse 插件构建时，各种项目“从早期的绑定”，根据本节的结构化绑定部分[-](http://jibx.sourceforge.net/binding/tutorial/binding-advanced.html)工厂类被破坏。

我正在努力将公共类绑定提取到预编译的包含中，但这不是一项小工作——我们有很多共享类，并且在进行更改时一定会错过共享对象绑定。有什么方法可以标记（命名？）与每个项目关联的绑定，以便多个工厂类可以存在于公共类包中而不是覆盖它们，即

```
com.alfonzo.common 
    shared.class
    foobar1_JiBX_bindingFactory.class
    foobar2_jibx_bindingFactory.class 
```

那么项目 foobar1，包括共享类的构建绑定可以引用它的工厂，而项目 foobar2 引用不同的工厂。

还是我完全误解了这一点？...

# php - access_token - 在粉丝页面相册中上传照片的脚本

> ID：10918954
> 
> 赞同：2
> 
> 时间：2012-06-06T17:16:44.803
> 
> 标签：php, facebook, facebook-page, facebook-access-token

我正在开发一个应用程序以包含在我的页面选项卡中。在这个应用程序中，用户将使用您的网络摄像头拍照，并将照片发送到我的粉丝页面中的特定相册。

我在这里找到了一个脚本：他工作得很好，但是我有一个问题，脚本使用用户access_token来上传图片，不需要所有用户的权限来上传图片，因为脚本使用我的管理员用户来上传图片发送到页面。

最大的问题是：用户访问令牌在 2 小时后过期，或者当我的管理员用户未登录时，offline_access 权限已停止，我不知道我的脚本将如何工作。

我需要所有用户都可以使用系统上传照片，有人知道我该怎么做吗？

这是PHP中的脚本：

```
`
require_once 'library/facebook.php';

$facebook = new Facebook(array(
    'appId'  => '<appid>',
    'secret' => '<appsecret>',
    'fileUpload' => true
));
$access_token = 'access_token';
$params = array('access_token' => $access_token);
$fanpage = 'page_id';
$album_id ='album_id';
$accounts = $facebook->api('/ADMIN_ACCOUNT/accounts', 'GET', $params);

foreach($accounts['data'] as $account) {
    if( $account['id'] == $fanpage || $account['name'] == $fanpage ){
        $fanpage_token = $account['access_token'];
    }
}

$valid_files = array('image/jpeg', 'image/png', 'image/gif');
$img = realpath("image_path");

$args = array(
    'message' => 'message to write in legend',
    'image' => '@' . $img,
    'aid' => $album_id,
    'no_story' => 1,
    'access_token' => $fanpage_token
);

$photo = $facebook->api($album_id . '/photos', 'post', $args);

if( is_array( $photo ) && !empty( $photo['id'] ) ){
    echo '<p><a target="_blank" href="http://www.facebook.com/photo.php?fbid='.$photo['id'].'">Click here to watch this photo on Facebook.</a></p>';
}` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:24:23.017

您需要通过点击端点来请求长期访问令牌：

```
https://graph.facebook.com/oauth/access_token?             
    client_id=APP_ID&
    client_secret=APP_SECRET&
    grant_type=fb_exchange_token&
    fb_exchange_token=EXISTING_ACCESS_TOKEN 
```

查看以下文档中的场景 4：http: [//developers.facebook.com/roadmap/offline-access-removal/](http://developers.facebook.com/roadmap/offline-access-removal/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:44:03.600

如果您使用该脚本发布到粉丝页面的相册，那么您应该获得一个*页面*访问令牌——它们不会过期。

详情见这里：[https ://developers.facebook.com/docs/authentication/pages/](https://developers.facebook.com/docs/authentication/pages/)

# javascript - ExtJS：使用一个网格加载多个商店

> ID：10918955
> 
> 赞同：0
> 
> 时间：2012-06-06T17:16:50.117
> 
> 标签：javascript, extjs

我对 ExtJS 相当陌生，所以我想知道哪种方法最适合使用一个网格显示不同的信息视图。这就是我正在考虑做的事情。我有三个不同的数据存储，每个都使用代理并返回 JSON。我们称它们为 STORE1、STORE2 和 STORE3。我正在使用不同的商店，因为每个商店都有不同的参数，这些参数正在执行以从服务器检索。现在，我想包含三个按钮，每个按钮都会触发一个用于填充网格的商店。在实例化之后，如何为 Grid 指定一个新的 store 来使用？我在 Grid 对象中没有看到 setStore() ，所以我不确定如何解决我的问题。如果有人能给我一些见解，那将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T18:00:40.993

网格有方法`bindStore`。如果您还需要分配不同的列集 - 检查`reconfigure`方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T18:06:06.743

有几种方法可以解决这个问题。

*   我要做的第一件事就是仔细考虑您的用例。您确定这是您想要处理用户界面的方式吗？**过滤**数据（默认情况下或用户交互）是否更有意义。有几个这样的例子。想到的一个是简单的任务小部件（不是那么简单）[http://docs.sencha.com/ext-js/4-1/#!/example/simple-tasks/index.html](http://docs.sencha.com/ext-js/4-1/#!/example/simple-tasks/index.html) - 右上角的按钮根据用户选择过滤商店。它使用一个网格+一个商店..但根据用户选择过滤数据。

*   如果您准备从不同的商店加载数据，您可以利用一个商店来管理视图，而其他商店来获取数据。在加载获取数据的商店时，您使用 loadData（或 loadRecords）方法来更新控制视图的商店。说得通？不过要注意这里的极端情况..如果两次加载相同的数据会发生什么？您应该在 loadData 方法上使用“附加”选项吗？

祝你好运。

# wcf - Log4Net 和 WCF IErrorHandler - ServiceSecurityContext.Current.WindowsIdentity.Name 返回 NullReferenceException

> ID：10918956
> 
> 赞同：2
> 
> 时间：2012-06-06T17:16:54.087
> 
> 标签：wcf, log4net, handleerror, ierrorhandler

我正在使用 WCF 服务并且我已经实现*了 IErrorHandler*。在*HandleError*方法中，我想检索调用者的用户名，以便为*Log4Net设置**ThreadContext*属性（将用户名与 SQL Server 中的异常详细信息一起保存）

 *如果我避免尝试检索调用者的用户名，我的代码运行良好。

这是 HandleError 方法中返回***NullReferenceException***的代码行：

```
string username = ServiceSecurityContext.Current.WindowsIdentity.Name; 
```

似乎在*IErrorHandler的**HandleError*方法启动时，原来的调用者信息已经被处理掉了。

有谁知道如何在 IErrorHandler 的 HandlerError 方法中检索调用者*的**用户*名？

 *谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T21:34:12.383

感谢那些响应帮助的人。我的安全似乎配置正确，但我无法在 WCF 服务的 IErrorHandler 接口*的 HandleError**方法*中检索用户名。但是，我可以在*ProvideFault*方法中检索用户名。*因此，我在ErrorHandler* ( *IErrorHandler* ) 类中声明了一个类级别变量，该变量在*ProvideFault*方法期间设置，然后在 ErrorHandler 方法中读取并记录异常。这是一种“解决方法”，而不是我的偏好，但不幸的是，我似乎无法访问*HandleError*方法中的安全上下文。

这是代码示例：

```
public class ErrorHandler : IErrorHandler, IServiceBehavior
{
    private string username = null;

    public bool HandleError(Exception error)
    {
        //Log the exception along with the username.
        //...logging call including the username class member string...

        //Return true to indicate we have performed our behaviour.
        return true;
    }

    public void ProvideFault(Exception error, MessageVersion version, ref Message fault)
    {
            //Retrieve the username.
            username = ServiceSecurityContext.Current.WindowsIdentity.Name;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T11:23:09.930

如果您收到此异常，那么您可能没有正确配置安全性。另请参阅此答案：[https ://stackoverflow.com/a/2869481/106567](https://stackoverflow.com/a/2869481/106567)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-08T18:37:21.217

使用类级别变量似乎有副作用。处理程序的同一实例似乎用于处理的每个错误（待确认）。因此，如果同时出现 2 个错误，我不知道它会如何反应。因此，在 ProvideFault 中，我使用接收到的异常作为参数将用户名传输到 HandleError 方法。异常有一个 «Data» 属性，它是一个字典。我只添加了两个键值对（一个用于 PrimaryIdentity，一个用于 WindowsIdentity）。在 HandleError 中，我检索了作为参数接收的异常的 Data 属性中的信息。**

# javascript - Adobe Edge - 从 html 页面控制动画

> ID：10918957
> 
> 赞同：0
> 
> 时间：2012-06-06T17:17:01.660
> 
> 标签：javascript, jquery, adobe-edge

我正在尝试将 Adob​​e Edge 动画集成到我正在使用专有发布系统准备的 HTML5 出版物的一页上。系统显示不同的 HTML 页面，如杂志中的页面。

我想在包含动画的页面出现时开始播放动画。当页面显示时，发布系统触发 onScreen 事件，而不是 onLoad 事件。我知道如何为该事件设置回调，但我需要回调来启动动画。谁能告诉我该怎么做？

我基本上想做我们过去用 Flash 做的那种事情，当我们可以从包含它的 HTML 页面中的 Javascript 函数向 SWF 发送指令时。

我是否给动画起一个名字，然后用 document.animationName.play() 之类的东西来处理它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T23:06:31.290

这花了我一段时间才弄清楚。AdobeEdge 对象将使您能够访问时间线和所需的符号。

该`getComposition()`功能将让您访问特定的组合。您将合成的名称传递给它，该名称位于属性面板中，通常是 Edge 生成的 ID，例如 EDGE-344514744。如果你愿意，你可以重命名它。假设你将其命名为 myAnim

`getStage()`让您可以访问舞台，从那里，您可以使用 、 等方法`play()`。`stop()`如果您想播放您在时间轴中创建的标签，您已命名为“开始”，您可以使用它。

```
AdobeEdge.getComposition("myAnim").getStage().play("start"); 
```

# java - Tomcat 启动后的 Ant 脚本

> ID：10918961
> 
> 赞同：1
> 
> 时间：2012-06-06T17:17:06.983
> 
> 标签：java, tomcat, ant, startup

有没有办法在tomcat启动完成后写一个hook来执行一个ant脚本。尝试更改 startup.bat 以在最后调用 ant 脚本，但在 tomcat 完全启动之前调用了 ant。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T06:05:17.683

无需处理与 Tomcat 相关的任何事情的简单方法：

```
<!-- run tomcat here -->

<!-- wait for the server to be available -->
<waitfor>
    <http url="http://host:port">
</waitfor>

<!-- run other ant scripts from here... --> 
```

# php - 我的网络摄像头到本地网站（直播和图像捕获）

> ID：10918962
> 
> 赞同：0
> 
> 时间：2012-06-06T17:17:07.193
> 
> 标签：php, silverlight, flash, apache-flex, webcam

我最近开始考虑一个副项目，该项目将利用 USB 触发的继电器开关来允许互联网和机械对象之间的交互（例如单击站点上的按钮并敲响真正的铃铛）。

现在我已经弄清楚了这部分，但我想做的是通过网络摄像头在流媒体视频中捕捉到它（并可能在特定时间拍摄快照）。我很确定我必须使用某种可以与硬件交互的脚本语言（flash/flex/silverlight）。还要考虑这将在本地托管在具有网络摄像头的计算机上。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:37:41.620

我建议在 adobe air 中编写一个 kiosk 类型的应用程序。您可以很容易地捕获相机，并通过一些简单的网络事件监听来告诉它何时拍摄一些视频。

听起来有些有趣，如果您需要帮助，请告诉我（我的堆栈昵称有我的电子邮件）

# php - PHP - 我们如何满足不同时区的需求？

> ID：10918963
> 
> 赞同：1
> 
> 时间：2012-06-06T17:17:10.387
> 
> 标签：php, date, timezone

因此，假设服务器时间保持不变并且不会改变，我已经制作了一个基于/相对于服务器时间的完整系统。我使用 date() 函数在整个应用程序中获取服务器时间。然后我们觉得有必要迎合不同的时区。例如，伊利诺伊州可以在该州内有两个不同的时区，即东部时间和中部时间。

同样，美国可能在国内有 5 个不同的时区。

现在我的方法是让用户在我的网站上注册时告诉我他所处的时区，并基于此，根据他的输入进行计算。

所以我想知道的是，我们如何使用 date() 函数来满足不同时区的需求。或者，如果有人有更好的方法来解决这个问题，我全神贯注:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T17:24:25.827

[日期时间::设置时区](http://www.php.net/manual/en/datetime.settimezone.php)

在一个时区喂它时间，设置时区，在另一个时区输出时间。链接后面的示例很好地说明了这一点。

# linux - 使用 lessc 从 .less 文件生成 .css 的 Bash 脚本

> ID：10918964
> 
> 赞同：3
> 
> 时间：2012-06-06T17:17:13.930
> 
> 标签：linux, bash, less

我正在寻找一个 bash 脚本，它将递归地查找`.less`目录中的所有文件，`.css`并`css`使用`lessc`. 视觉上看起来像这样。

前：

```
/css
/less
    a.less
    b.less
/whatever
    /css
    /less
        c.less
        d.less 
```

后：

```
/css
    a.css
    b.css
/less
    a.less
    b.less
/whatever
    /css
        c.css
        d.css
    /less
        c.less
        d.less 
```

到目前为止，我能够弄清楚的是，我可以使用以下方法找到所有文件：

```
find . -name *.less 
```

我可以使用以下方法生成单个文件：

```
lessc foo.less > ../css/foo.css 
```

我的问题是试图将结果通过管道传输`find`到`lessc`. 根据[这个问题](https://stackoverflow.com/questions/864316/how-to-pipe-list-of-files-returned-by-find-command-to-cat-to-view-all-the-files)，我可以看到如何将结果`find`输入`cat`，但同样的方法不适用于我`lessc`。

一般来说，我只是无法将这些碎片拼凑在一起。任何帮助，将不胜感激。

谢谢。

**编辑**

这对我有用。谢谢@ghoti！

```
find . -name \*.less -print | sed -rne 's:(.*)/less/([^/]+).less$:lessc & > \1/css/\2.css:p' | sh 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T17:35:53.383

你已经得到了所有的成分。你只需要食谱。:-)

并且有多种食谱。

通常，您可以使用`find`'`-exec`选项根据找到的内容执行操作。但是，您可以命名事物的方式受到限制。例如，如果你要使用这个：

```
find . -name \*.less -exec lessc {} ../css/{}.css 
```

您将在运行 find 的父级的 css 目录中创建文件，并且文件将被命名为 a.less.css、b.less.css 等。这不好。您需要将`dirname`等嵌入到您的命令中，然后由于引号和反斜杠过多，事情变得无法管理。

当我必须像这样进行模式匹配和更改时，我经常求助于管道。这是我要做的：

```
find . -name \*.less -print | \
  sed -rne 's:(.*)/less/([^/]+).less$:lessc & > \1/css/\2.css:p' 
```

`find`正如您所期望的那样，获取您的文件。然后`sed`脚本将它们变成命令行。它的输出是一组命令行，一旦您验证它们看起来正确`lessc`，您就可以简单地输入这些命令行。`sh`

这是结果。

前：

```
[ghoti@pc ~/tmp1]$ find . -type f -print
./whatever/less/c.less
./whatever/less/d.less
./less/a.less
./less/b.less
[ghoti@pc ~/tmp1]$ 
```

然后测试运行：

```
[ghoti@pc ~/tmp1]$ find . -name \*.less -print | sed -rne 's:(.*)/less/([^/]+).less$:cat & > \1/css/\2.css:p'
cat ./whatever/less/c.less > ./whatever/css/c.css
cat ./whatever/less/d.less > ./whatever/css/d.css
cat ./less/a.less > ./css/a.css
cat ./less/b.less > ./css/b.css
[ghoti@pc ~/tmp1]$ 
```

然后最后运行，结果。

```
[ghoti@pc ~/tmp1]$ find . -name \*.less -print | sed -rne 's:(.*)/less/([^/]+).less$:cat & > \1/css/\2.css:p' | sh
[ghoti@pc ~/tmp1]$ find . -type f -print
./css/b.css
./css/a.css
./whatever/less/c.less
./whatever/less/d.less
./whatever/css/d.css
./whatever/css/c.css
./less/a.less
./less/b.less
[ghoti@pc ~/tmp1]$ 
```

对于我的测试，我替换`lessc`为`cat`，因为我的工作站上没有安装 less。

请注意，这仅适用于示例中的简单文件名。如果您有空格或其他可能的“特殊”字符，它将中断。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:27:10.113

使用 for 循环

```
for file in $(find . -name *.less)
do
    css="${file//less/css}"
    mkdir -p $(dirname "$css")
    lessc "$file" > "$css"
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-03T08:04:25.063

如果您的 .css 文件在`D:\demo`文件夹中，请创建一个包含以下内容的文件`convert.bat`：

```
$ d:
$ cd demo
$ lessc style.less style.css 
```

当您运行此文件时，它会将 .less 转换为 .css。

# nhibernate - NHibernate discriminator-value="null" 不适用于基类 - 未应用过滤器

> ID：10918966
> 
> 赞同：1
> 
> 时间：2012-06-06T17:17:39.673
> 
> 标签：nhibernate

对于以下类映射：

```
<class name="Person" table="Person" discriminator-value="null">
    <id name="ID" column="ID" >
        <generator class="identity"/>
    </id>
    <discriminator column="MasterId" />
    <property name="LongName" column="LONGNAME" />
    <property name="ShortName" column="SHORTNAME" />
    // other stuff here ...
    <subclass name="PersonHistory" discriminator-value="not null">
        <property name="MasterId" />
    </subclass>
</class> 
```

当我执行：

```
 var query =
            from lac in session.Query<Person>()
            orderby lac.LongName
            select lac;
        return query.ToList(); 
```

我从**Person**表中获取所有条目，其中 MasterId 都设置为 null 而不是 null。有没有办法让 NHibernate 只获取 MasterId = null 的实体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T23:10:36.360

在你的情况下使用[鉴别](http://www.nhforge.org/doc/nh/en/index.html#mapping-declaration-discriminator)器公式怎么样？

```
<discriminator formula="case when MasterId is null then 0 else 1 end" /> 
```

然后为类设置鉴别器属性值：

*   对于人：discriminator-value="0"
*   对于 PersonH​​istory：discriminator-value="1"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T13:22:22.103

为了实现我想要的，我创建了基类 + 两个子类。这是配置：

*   具有**discriminator-value 的**子类：

    ```
    <subclass name="People" discriminator-value="null">
    </subclass>
    <subclass name="PeopleHistory" discriminator-value="not null">
        <property name="MasterRowId" />
    </subclass> 
    ```

*   **基类**中的鉴别器：

    ```
    <discriminator column="MasterRowId" /> 
    ```

# android - Android HTTP 请求总是返回代码 404

> ID：10918974
> 
> 赞同：1
> 
> 时间：2012-06-06T17:18:25.867
> 
> 标签：android

我正在尝试实现一个简单的 HTTP 请求。该请求将验证来自服务器的用户名和密码。服务器配置为只返回两个错误代码，200 表示已验证，404 表示其他所有错误代码。我已经用 eclipse 进行了广泛的调试，发现我总是收到代码 404。在发布之前我已经阅读了所有其他现有问题。

```
private class loginTask extends AsyncTask<String, Integer, Boolean> {
    String check;
    @Override
    protected Boolean doInBackground(String... arg0) {
                ("http://www.unite.upmc.edu/account/IPhoneLogin?username=username&password=password

        String username = arg0[0];
        String password = arg0[1];
        URI uri = null;
        try {
            uri = new URI("http://unite.upmc.edu/account/IPhoneLogin?"+"username="+username+"&"+"password="+password);// I know the method is called IPhoneLogin, it's being used by both Android and IOS clients
        } catch (URISyntaxException e1) {

            e1.printStackTrace();
        }
        HttpClient client = new DefaultHttpClient();

        try {//Look here

            HttpResponse response = client.execute(new HttpGet(uri));
            String code = "" + response.getStatusLine().getStatusCode();
            check = code;
            if(code.equals("200")){
                loggedIn = true;
            }else{
                                    //need to re-enter username and password
            }
        } catch (ClientProtocolException e) {

            e.printStackTrace();
        } catch (IOException e) {

            e.printStackTrace();
        }

        hasPin = false;
        return true;
    }

    @Override
    protected void onProgressUpdate(Integer... integers) {
        setProgress(integers[0]);
    }

    @Override
    protected void onPreExecute() {

        ProgressDialog dialog = new ProgressDialog(UniteActivity.this);
        dialog.setMessage("Logging in...." + check);
        dialog.show();

    } 
```

我知道服务器已经启动并且密码和用户名是正确的，因为我已经使用 Internet Explorer 正常登录了很多次。我正在使用带有 Android SDK 的 Eclipse IDE，我担心这可能是它提供的错误模拟器的产品。关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T06:14:46.180

在 doInBackground 方法中尝试此代码以获取响应代码

```
url = new URL(mUrl);

            Log.i(LOG_TAG, url+"");
            HttpGet method= new HttpGet(new URI(mUrl));
            HttpClient client = new DefaultHttpClient();
            HttpGet request = new HttpGet();
            request.setURI(new URI(mUrl));
            HttpResponse response = client.execute(method);
            responseCode = response.getStatusLine().getStatusCode(); 
```

希望这会正常工作。

# ruby-on-rails - ActiveMQ 和 Rails

> ID：10918979
> 
> 赞同：0
> 
> 时间：2012-06-06T17:18:43.100
> 
> 标签：ruby-on-rails, activemq

我是 ActiveMQ 的新手，正在做一个涉及从队列中读取消息然后批量处理它们的项目。（我将它们铲到一次只能处理 100 个的第 3 方 API，尽管少于 100 个也可以）

我发现的每个示例都涉及以原子方式处理每条消息的事件驱动代码。是否有允许表单伪代码的 gem、插件或其他方法

```
while(!queue.empty?) do
   chunk = []

   while(!queue.empty? && chunk.size < 100) do 
      chunk << queue.read
   end

   do_something_with(chunk)
end 
```

或者这是一个傻瓜的差事还是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T20:34:49.100

我认为您可以在这种情况下使用消息分组。这样，您可以在一批邮件中分组，因为发件人已经设置了分组标头。以下是有关 ActiveMQ 如何处理此问题的信息：[ActiveMQ on Message Grouping](http://activemq.apache.org/message-groups.html)

我不是 ruby​​ 编码器，但我假设您在谈论事件驱动 API 时使用了一些“on_message”函数。IBM 有一个很好的教程，如何在消息侦听器 (MDB) 中接收 JMS 消息组。是java和WebSphere MQ，但是JMS的概念应该是一致的。
[IBM 在 MDB 中的 JMS 消息分组](http://www.ibm.com/developerworks/websphere/library/techarticles/0602_currie/0602_currie.html#listing5)

您可能会也可能无法将其转换为 Rails，但它可能会在等待正确的代码示例出现在这里时给出一些提示！:)

# c# - 在 Visual Studio 的调试模式下获取问号而不是属性名称和值

> ID：10918981
> 
> 赞同：17
> 
> 时间：2012-06-06T17:18:45.723
> 
> 标签：c#, visual-studio-2010, debugging

我的问题是：在 Visual Studio 的调试模式下，我看不到属性名称及其值。有什么建议么？**UPD 此错误/功能可在大学 PC 中重现。** ![在此处输入图像描述](../Images/89556d1b6f01bca0b6d622d873a005a7.png)

![在此处输入图像描述](../Images/0253d98a6290744f0135ca5a1d4df463.png)

![在此处输入图像描述](../Images/9c174d566ddd4bfa09aa5fa1504cf6a3.png)

**UPD(15.06.2012)**

基类被放置到单独的库中。基类是抽象的。并且......两次调试工作正常，在源文件中进行更改（在屏幕截图中）然后运行项目。

请注意，即时窗口无法评估此表达式。

MailProcessingViewModelContext 继承了我在 UPD 顶部提到的那个基类。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-12T01:31:07.830

这是 Visual Studio 中的一个错误，它是在您使用鼠标滚动属性列表时引起的。而是单击菜单底部的向下箭头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-08T18:19:47.883

如果您正在调试 ASP.NET 向导并想要检查某些内容的集合，则会发生这种情况，集合中当前向导步骤（当前上下文）中的所有元素都将可见，而其他元素存在但不只是在上下文中现在因此标记为问号->？

也许在你的情况下可能是这样的。我想这可能是相同的场景

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T09:24:02.977

正如上面已经提到的那样，您需要为您正在使用的每个不是您的代码的 dll 调试符号文件（.pdb），否则 VS 无法查看“内部”。

如果它被混淆了，你将什么也看不到

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-18T08:04:03.797

对我来说，当我在类模型中有一个指向自身的 getter 属性时，就会发生这种情况。这是一个复制粘贴错误，请注意属性名称是 ShouldNotProcess，并且在 getter 中它会自行返回。返回应该是：return !this。**应该处理；**

```
public bool ShouldNotProcess
{
    get { return !this.ShouldNotProcess; }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T13:46:01.477

不确定您的情况是否属于这种情况，但这里有一个类似问题的[帖子。](https://stackoverflow.com/questions/8438087/question-mark-in-visual-studio-debugger)希望能帮助到你

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-11T06:19:53.727

您无法访问这些菜单项或在设计模式下显示这些窗口。要显示这些菜单项，调试器必须正在运行或处于中断模式。

参考：

[http://msdn.microsoft.com/en-us/library/bhawk8xd](http://msdn.microsoft.com/en-us/library/bhawk8xd)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-12T11:17:59.287

您所引用的对象是否有可能属于另一个项目（库模板）并且您将其添加为文件引用而不是项目引用？

请分享有关您解决方案中项目结构的详细信息。还有您尝试访问的课程的位置。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-13T21:15:09.850

确保您在调试模式下运行，我知道我可能在那里说明了明显的情况。另外，检查您正在评估的表达式 - 对吗？您是否投射到正确的对象。最后，包含您正在查看的类的程序集是作为项目包含在解决方案中，还是仅作为外部程序集引用？确保它是 sln 的一部分。

如果它可以在另一个 Visual Studio 副本上重新创建，那么我猜这不是 Visual Studio 的问题，而是您正在查看的对象。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-06T17:53:11.377

您是在尝试调试自己的代码还是其他人的代码？

如果不是您的代码，则代码可能已被混淆，因此您无法看到私有成员或使用反射器对其进行逆向工程。

如果您使用触控板滚动成员列表，也可能会发生这种情况。尝试改用键盘。

# javascript - 如何解码sha1代码？

> ID：10918983
> 
> 赞同：-7
> 
> 时间：2012-06-06T17:18:50.243
> 
> 标签：javascript, sha1

**我有一个代码，但我无法解码它，所以我需要你的帮助。请帮我。首先我不知道它的类型。它是什么 ？沙1？MD5 ? 哈希？我知道这个代码有 40 个字符。**

怎样才能破译这个安全码？它有游戏分数，所以我需要对其进行解码，但我无法对其进行解码。

此代码：“安全”：“ **c6aefe7f8c9fd439f59635efc82fcbd4f6cd4b9c** ”

这是保护游戏通知。当我更改任何内容时，它不是确认安全代码。

完整代码： `{"security":"c6aefe7f8c9fd439f59635efc82fcbd4f6cd4b9c","time":40844,"numberOfBirdsShot":2,"type":"LevelComplete","blocks":"800,100,130,130,130,130,310,110,300,300,110,10,150,70,120,60,40,60,60,110,130,80,70,140,180,20,190,20,40,40,90,70,10,10,40,10,40,190,190,40,40,50,20,130,20,140,10,60,90,120,120,10,10,80,100,120,30,90,90,290,100,80,120,70,70,370,150,50,50,160,160,10,30,250,160,180,180,130,70,70,130,60,30,30,130,320,70,70,170,70,150,40,40,90,30,110,120,270,60,40,180,140,220,30,20,160,460,10,30,70,110,350,290,700,550,90,100,90,10,100,40,40,80,40,40,170,80,80,70,70,70,120,170,10,20,50,10,10,40,70,70,50,20,80,80,20,20,90,220,220,230,50,20,20,80,60,30,30,280,90,50,260,80,120,80,80,50,110,90,20,20,30,30,60,70,40,40,10,30,110,100,50,40,50,100,90,20,20,30,160,10,10,20,10,10,90,70,30,210,180,90,80,80,40,160,60,30,80,80,80,0,500,5000,500,500,500,500,5000,500,500,500,500,500,500,500,500,500,500,500,5000,500,500,5000,500,500,500,500,500,500,0,10000,10000","sessionID":"2DAB169CF4F766CC69CA2C5A02339CB7.f119dcaaa5c087f52aa2ad687312f9f46d402972","levelID":"1-1","score":73150,"gameplay":"WIN1-1@@2@321:16.489984194253722:-25.291503791549072:1:-161.45947702629903@505:16.306849998012037:-27.166930977940375:1:172.61390103177405@@2@333@517@@0","userLevelID":"0c4679cd-5fb0-441e-a257-a060010bdb3d","userID":"1a7c1755-a7e7-48a0-9e7d-a04a0142a595"}`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T17:22:47.597

您无法解码`sha1`哈希。

> 密码学上的强哈希函数具有两个特征：**它是不可逆的**，并且可以最大限度地减少冲突。不可逆性意味着无法从其哈希中重建原始数据。参照。加密，它必须是可逆的（请参阅只写内存。）当两组不同的数据生成相同的散列时，就会发生冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:21:53.347

如果它有 40 个十六进制字符，那么就是 20 个字节或 160 位，这表明它是 SHA-1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T17:23:40.260

这是不可能的（在合理的时间内）。您可以做的是检查彩虹表或尝试查找哈希冲突。

# php - PHP 脚本未在 HTML 表单“提交”时执行

> ID：10918990
> 
> 赞同：1
> 
> 时间：2012-06-06T17:19:17.450
> 
> 标签：php, mysql, html, forms, apache

我正在用 HTML 构建一个网站表单，我想从用户那里收集信息，并将其存储在 MySQL 中。但是，当我输入信息后提交表单时，没有执行 PHP 脚本。它只是以原始形式显示 PHP 脚本。在浏览器中，它会下载 PHP 文件。

起初，我以为这是我的 MySQL、PHP、Apache 配置的问题，但[按此](http://akrabat.com/php/setting-up-php-mysql-on-os-x-10-7-lion/)步骤操作后，我仍然无法执行 PHP 脚本。

我的表单标题如下所示：

```
<form id="form-settings" method="post" action="file.php"> 
```

file.php 是我要在提交时执行的脚本。

这是我的 PHP 脚本：

```
<?php
error_reporting(E_ALL);

$link = mysql_connect("localhost","username","password");

if (!$link) 
{
       die('Not connected : ' . mysql_error());
}

mysql_select_db("mysql", $link) or die("Unable to select database");

$var1=$_POST['var1'];
$var2=$_POST['var2'];
$var3=$_POST['var3'];
$var4=$_POST['var4'];
$var5=$_POST['var5'];

$query = "INSERT INTO table VALUES ('','$var1','$var2','$var3','$var4','$var5')";
mysql_query($query);

mysql_close($link); ?> 
```

我可以从终端执行 PHP 文件。我可以查询我的 MySQL 表并在其中输入信息，但是当我尝试通过 HTML 表单运行它时，它不起作用。Vars 是从 HTML 表单中提取的值。任何建议将不胜感激。显然，php没有被识别，但是这个问题是从哪里来的呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:23:44.497

您确定您的网络服务器支持 PHP 吗？

如果只是从服务器提供源代码，那么似乎 PHP 支持不可用。您应该联系您的网络托管服务商。也可以检查其他文件扩展名。

如果您有权访问配置，请为 apache 安装 php 模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T17:32:08.863

Apache 配置文件之一应包含以下指令：

```
AddHandler php5-script .php 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T17:33:19.390

（我会将此作为评论发布，但我不能因为我的业力太少......）

查看日志文件，尤其是错误日志文件。它们可能在 /var/log/apache2 或其他地方。看看有没有什么问题？

您的 phpinfo()-script 是否与其他脚本位于同一目录中？您是否使用相同的主机名访问脚本？（例如，127.0.0.1 与 localhost？）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T17:36:45.990

好的，为了在 PHP 文件中获取这些：

```
$var1=$_POST['var1'];
$var2=$_POST['var2'];
$var3=$_POST['var3'];
$var4=$_POST['var4'];
$var5=$_POST['var5']; 
```

您的表单必须包含以下内容：

```
<form method="post" action="file.php">
    <input type="text" name="var1" />
    <input type="text" name="var2" />
    <input type="text" name="var3" />
    <input type="text" name="var4" />
    <input type="text" name="var5" />
    <input type="submit" value="Submit" />
</form> 
```

如果您的表单是这种情况，我的意思是`name`输入中的属性，您得到什么输出？你得到未解析的 PHP 文件？？？

# c# - 如何像在 C# 中那样在 Java 中使用回调调用函数？

> ID：10918994
> 
> 赞同：6
> 
> 时间：2012-06-06T17:19:33.643
> 
> 标签：c#, java, android, delegates

我对 Java 很陌生，但我需要编写类似这样的 C# 代码（这是手工输入的原型，只是为了说明我需要什么）

```
private void ParentFunc()
{
    var worker = new WorkerClass()

    worker.DoWork(e => console.Write("Progress" + e));

}

public class WorkerClass()
{
    public method DoWork(Action<int> callback)
    {
        for (int i=1; i<1000; i++) callback.Invoke(i);  
    }
} 
```

一点解释。我`AsyncTask`在 android 中使用并调用外部处理器分类但希望他们发回信号以便我可以`publishProgress`。我不想把界面放在我的`AsyncTask`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T17:27:26.880

由于尚不支持闭包，因此您必须使用接口和匿名内部类。

```
private void ParentFunc {
    WorkerClass worker = new WorkerClass();

    worker.doWork(new Callback<Integer>() {
        public void invoke(Integer arg) {
            System.out.println("Progress" + arg);
        }
    });
}

public class WorkerClass {
    public doWork(Callback<Integer> callback) {
        for (int i=1; i<1000; i++) callback.invoke(i);  
    }
}

public interface Callback<T> {
    public void invoke(T arg);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-06T17:23:19.973

在 java 中，您使用实现接口的匿名类。这有点冗长，但它工作得很好：

```
interface MyAction {
    void doit(String str);
}

class WorkerClass {
    void doWork(MyAction action);
}

void main(String args[]) {
    WorkerClass worker = new WorkerClass();
    worker.doWork(new MyAction {
        public void doit(String e) {
            System.out.println("Progress" + e)
        }
    });
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-06T17:23:12.417

在支持类的帮助下：

```
interface CallBack<P>
{
  public void callback(P p);
}

class MyCallBack implements CallBack<String> {
  public void callBack(String p) {
    System.out.println(p);
  }
}

class WorkerClass {
  public void doWork(CallBack<String> callback)
  {
    // do work
    callback.callBack("Done!");
  }
}

WorkerClass wc = new WorkerClass();
wc.doWork(new MyCallBack()); 
```

我不会建议您使用匿名类，因为我发现它们非常冗长，直到无法使用更流畅的语法，但这只是个人喜好问题，当我使用它们时，我最终会在大括号之间迷失自我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-06T12:28:03.703

使用 java 8 是可能的。请参阅我对重复问题的回答：

[https://stackoverflow.com/a/26776520/1206998](https://stackoverflow.com/a/26776520/1206998)

使用函数作为参数：

```
import java.util.function.Function;

public String applyFunction(Function<String,String> function){
        return function.apply("what ever");
} 
```

称呼

```
// with someObject.someMethod(String) => String
xxx.applyFunction(someObject::someMethod); 
```