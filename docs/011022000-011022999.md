# StackOverflow 问答 11022000-11022999

# ruby - 使用 Mongoid 查找集合中的所有文档

> ID：11022010
> 
> 赞同：9
> 
> 时间：2012-06-13T19:29:26.483
> 
> 标签：ruby, mongodb, mongoid

我一直在摆弄 Mongo，但无法让这个简单的例子起作用。我只是想检索集合中的所有文档：

```
require 'mongoid'

# configuration ...    

class Category

  include Mongoid::Document
  field :name, type: String

end

Category.each do |test|
  puts test.inspect
end 
```

我得到错误：`undefined method 'each' for Category:Class (NoMethodError).`

与数据库的连接已经建立，一个名为的集合`categories`包含一些文档。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-13T19:44:58.357

`Category`确实没有方法`each`，因为它是模型类，而不是集合。然而，它有几个方法可以返回类似集合的对象。其中之一是`all`。所以代码应该是这样的：

```
Category.all.each do |test|
  puts test.inspect
end 
```

# excel - 如何更改 Excel 连接以停止只读错误

> ID：11022018
> 
> 赞同：3
> 
> 时间：2012-06-13T19:29:54.337
> 
> 标签：excel, pivot-table

我有 3 个源 Excel 文件和一个主 Excel 文件。

主文件连接到 3 个源文件，并根据 3 个文件中的数据创建数据透视表。

当用户打开主文件并更新数据时，这 3 个源文件变为“只读”。

我想知道一些获取数据然后释放连接的方法。

连接中的连接字符串为：

Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=Z:\Supply Chain Planning\Short Shipment Reports\RT- Shortage Report 2012.xls;Mode=Share Deny Write;Extended Properties="HDR=YES ;";Jet OLEDB:System database="";Jet OLEDB:Registry Path="";Jet OLEDB:Engine Type=35;Jet OLEDB:数据库锁定模式=0;Jet OLEDB:Global Partial Bulk Ops=2;Jet OLEDB :Global Bulk Transactions=1;Jet OLEDB:New Database Password="";Jet OLEDB:Create System Database=False;Jet OLEDB:加密数据库=False;Jet OLEDB:不要在 Compact=False 上复制区域设置;Jet OLEDB: Compact without Replica Repair=False;Jet OLEDB:SFP=False;Jet OLEDB:Support Complex Data=False

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T19:55:23.203

尝试将`Mode`参数从更改`Share Deny Write`为`Read`。

# android - 重启后模拟器中的 C2DM registrationId

> ID：11022021
> 
> 赞同：0
> 
> 时间：2012-06-13T19:30:08.450
> 
> 标签：android, android-c2dm

在经历了几次断断续续之后，我已经让 Android C2DM 在模拟器中工作了。应用程序第一次启动时，它使用来自[chrometophone 项目](https://code.google.com/p/chrometophone/)的代码注册到 C2DM 服务。保存在首`registrationId`选项中，并在后续启动时使用。

**只要模拟器继续运行**，这似乎就可以很好地启动。但是，如果我杀死模拟器并重新启动它，那么应用程序需要重新注册才能再次开始接收 C2DM 消息。这是已知/预期的行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T19:28:13.737

是的，这是已知/预期的行为。[启用 C2DM 中的第 2 项](https://developers.google.com/android/c2dm/#register)内容如下：

> *如果注册成功，C2DM 服务器会广播一个 REGISTRATION Intent 给应用程序一个注册 ID。应用程序应存储此 ID 以供以后使用。**请注意，Google 可能会定期刷新注册 ID**，因此您应该在设计应用程序时理解 REGISTRATION Intent 可能会被多次调用。您的应用程序需要能够做出相应的响应。*

我发现注册ID经常变化。我还发现即使注册ID更改后，旧的可能仍然可以使用一段时间。

# java - 为什么我无法编译此 java 代码？

> ID：11022023
> 
> 赞同：0
> 
> 时间：2012-06-13T19:30:11.040
> 
> 标签：java, compilation, javac

```
import java.io.*;
import java.nio.ByteBuffer;
import java.nio.channels.FileChannel;

public class ExplicitChannelRead {

    /**
    * @param args
    */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

        FileInputStream fIn = null;
        FileChannel fChan = null;
        ByteBuffer mBuf;
        int count;

        try{
            fIn = new FileInputStream("text.txt");

            fChan = fIn.getChannel();

            mBuf = ByteBuffer.allocate(128);

            do{
                count = fChan.read(mBuf);

                if(count!=-1){
                    mBuf.rewind();

                    for(int i =0; i<count; i++)
                        System.out.print((char) mBuf.get());

                }
            }while(count!=-1);

            System.out.println();
        }catch(IOException e){
            System.out.println("I/O Error : " + e);
        }finally{
            try{
                if(fChan!=null)
                    fChan.close();
            }catch(IOException e){
                System.out.println("Error closing Channel.");
            }

            try{
                if(fIn!= null)
                    fIn.close();
            }catch(IOException e){
                System.out.println("Error closing file.");
            }
        }
    }
} 
```

当我在命令提示符下编译此代码时，出现错误

```
ExplictChannelRead.java:58:error:class, interface, or enum expected } 
```

当我在我的 IDE 中编译它时，我收到以下错误

```
"Exception in thread "main" java.lang.Error: Unresolved compilation problem: 

at nio_path.ExplicitChannelRead.main(ExplicitChannelRead.java:12)" 
```

我从书中复制了整个代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T19:34:43.333

对我来说很好:)

引用文本后有一个悬挂 }...确保您有匹配的大括号...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T19:35:10.403

您的源代码中有 11 个`{`字符和 12 个`}`字符。

找到丢失的`{`或删除`}`不需要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T19:33:28.933

尝试在文件末尾添加一个 }，您似乎缺少一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T19:37:25.253

它使用 JDK 1.7.0_01 对我来说编译得很好。

# ruby - 两个连接表的续集模型

> ID：11022025
> 
> 赞同：5
> 
> 时间：2012-06-13T19:30:17.047
> 
> 标签：ruby, orm, model, left-join, sequel

我有一个遗留的 PostgreSQL 数据库，它有一个模型分成两个表，它们之间具有一对一的映射。

```
CREATE TABLE auth_user (
    id SERIAL,
    username VARCHAR(30),
    email VARCHAR(75),
    password VARCHAR(64),
    first_name VARCHAR(75),
    last_name VARCHAR(75)
)
CREATE TABLE user_profile (
    user_id INTEGER REFERENCES auth_User.id,
    phone VARCHAR(32)
) 
```

不幸的是，我无法更改数据库结构。

我想将其用作单个 Sequel 模型。从数据库中检索数据按预期工作：

```
class User < Sequel::Model
end

# Variant 1: using LEFT JOIN
#User.set_dataset DB[:auth_user].left_join(:user_profile, :user_id => :id)

# Variant 2: using two FROM tables
User.set_dataset DB[:auth_user, :user_profile]\
                   .where(:auth_user__id => :user_profile__user_id)

user = User[:username => "root"] # This works. 
```

但是，保存模型失败：

```
user.set :first_name => "John"
user.save                        # This fails. 
```

如果我使用数据集的第一个变体（带有`left_join`），我会得到一个“ `Need multiple FROM tables if updating/deleting a dataset with JOINs`”错误。如果我使用第二种变体，它仍然会失败：“ `PG::Error: ERROR: column "phone" of relation "auth_user" does not exist LINE 1: ..."email" = 'nobody@example.org', "password" = '!', "phone"...`”

有没有办法让 Sequel 无缝地发出两个 UPDATE 语句？（同样的问题也适用于 INSERT）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T16:20:47.110

您可以拥有使用连接数据集的 Sequel 模型，但没有简单的方法可以保存这样的模型。

就个人而言，我会使用 many_to_one 关系、嵌套属性和挂钩来满足您的需求：

```
class UserProfile < Sequel::Model(:user_profile)
end
class User < Sequel::Model(:auth_user)
  many_to_one :user_profile, :key=>:id, :primary_key=>:user_id
  plugin :nested_attributes
  nested_attributes :user_profile

  def phone
    user_profile.phone
  end

  def phone=(v)
    user_profile.phone = v
  end

  def user_profile
    if s = super
      s
    else
      self.user_profile_attributes = {}
      super
    end
  end

  def before_destroy
    user_profile.destroy
    super
  end

  def before_create
    user_profile
    super
  end

  def after_update
    super
    user_profile.save
  end
end 
```

我还没有测试过，但类似的东西应该可以工作。如果您对此有疑问，您可能应该在 sequel-talk Google Group 上发帖。

# zeromq - 加载模块时出现pyzmq错误

> ID：11022027
> 
> 赞同：0
> 
> 时间：2012-06-13T19:30:26.420
> 
> 标签：zeromq, pyzmq

我正在尝试安装 pyzmq 以在 qtconsole 模式下获取 ipython wotking。

我已经在默认位置（/usr/local）安装了 zeromq。动态库和标题都在正确的位置。

我为 pyzmq 克隆了 git repo 并运行配置命令：

```
[root@XXXXX pyzmq]# python setup.py configure --zmq=/usr/local
running configure
************************************************
Configure: Autodetecting ZMQ settings...
Custom ZMQ dir:       /usr/local
gcc -pthread -fno-strict-aliasing -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -DNDEBUG -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/usr/local/include -Izmq/utils -Izmq/core -Izmq/devices -c detect/vers.c -o detect/vers.o
gcc -pthread detect/vers.o -L/usr/local/lib -Wl,-R/usr/local/lib -lzmq -o detect/vers
ZMQ version detected: 2.2.0
************************************************ 
```

到目前为止，一切都很好。然后我运行安装命令：

```
[root@XXXXXX pyzmq]# python setup.py install
 running install
running build
running build_py
running build_ext
************************************************
Configure: Autodetecting ZMQ settings...
Custom ZMQ dir:       /usr/local
gcc -pthread -fno-strict-aliasing -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -DNDEBUG -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/usr/local/include -Izmq/utils -Izmq/core -Izmq/devices -c detect/vers.c -o detect/vers.o
gcc -pthread detect/vers.o -L/usr/local/lib -Wl,-R/usr/local/lib -lzmq -o detect/vers
    ZMQ version detected: 2.2.0
************************************************
skipping 'zmq/core/_poll.c' Cython extension (up-to-date)
skipping 'zmq/core/_version.c' Cython extension (up-to-date)
skipping 'zmq/core/constants.c' Cython extension (up-to-date)
skipping 'zmq/core/context.c' Cython extension (up-to-date)
skipping 'zmq/core/device.c' Cython extension (up-to-date)
skipping 'zmq/core/error.c' Cython extension (up-to-date)
skipping 'zmq/core/message.c' Cython extension (up-to-date)
skipping 'zmq/core/socket.c' Cython extension (up-to-date)
skipping 'zmq/core/stopwatch.c' Cython extension (up-to-date)
skipping 'zmq/utils/initthreads.c' Cython extension (up-to-date)
skipping 'zmq/utils/rebuffer.c' Cython extension (up-to-date)
skipping 'zmq/devices/monitoredqueue.c' Cython extension (up-to-date)
running install_lib
running install_egg_info
Writing /usr/lib64/python2.7/site-packages/pyzmq-2.2dev-py2.7.egg-info 
```

然后我尝试在 python 中加载模块：

```
>>> import zmq 
```

这有效（在 setup.py 命令中添加了 --inplace 之后）

但是当我启动 ipython qtconsole 时，我得到了这个错误（在其他几行之后）：

```
import zmq
 File "/usr/lib64/python2.7/site-packages/zmq/__init__.py", line 29, in <module>
    from zmq import core, devices
  File "/usr/lib64/python2.7/site-packages/zmq/core/__init__.py", line 26, in <module>
    from zmq.core import (constants, error, message, context,
  File "message.pxd", line 39, in init zmq.core.poll (zmq/core/poll.c:2950)
ValueError: zmq.core.message.Message has the wrong size, try recompiling 
```

知道这可能来自哪里吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T09:45:31.513

@akira - 可能是您从他们的 github 存储库中签出标签（v2.2.0）。我这样做也看到了同样的问题。然后我从 pypi 下载了 v2.2.0 的 tar.gz，它运行良好。

# android - 在整个 Activity 生命周期中管理相机预览 SurfaceView？

> ID：11022031
> 
> 赞同：2
> 
> 时间：2012-06-13T19:30:41.743
> 
> 标签：android, android-camera, surfaceview, android-lifecycle

我正在尝试将[Android 开发人员指南](http://developer.android.com/guide/topics/media/camera.html)中定义的 CameraPreview 放到 ApiDemos/OS/Sensors 应用程序屏幕上。一半的时间按预期工作。但是，每隔一次我恢复这个测试应用程序（假设我通过按下设备的“主页”图标暂停它）都会记录以下异常：

> 06-13 14:10:17.369: D/SENSORS_TEST(11888): 支持的预览宽度 x 高度: 640 x 480 06-13 14:10:17.369: D/SENSORS_TEST(11888): 支持的预览宽度 x 高度: 320 x 240 06-13 14:10:17.369: D/SENSORS_TEST(11888): 支持的预览宽度 x 高度: 176 x 144 06-13 14:10:17.600: D/dalvikvm(11888): GC_FOR_ALLOC 释放 56K，3% 释放 9091K/ 9347K，暂停 22 毫秒 06-13 14:10:17.600：I/dalvikvm-heap(11888)：将堆（碎片情况）增加到 9.610MB，分配 695056 字节 06-13 14:10:17.631：D/dalvikvm(11888 ): GC_CONCURRENT 释放 1K, 3% 空闲 9768K/10055K, 暂停 2ms+2ms 06-13 14:10:31.510: D/AndroidRuntime(11888): 关闭 VM 06-13 14:10:31.510: W/dalvikvm(11888 ）：threadid = 1：线程以未捕获的异常退出（组= 0x40a351f8）06-13 14：10：3​​1.518：E / AndroidRuntime（11888）：致命异常：主要06-13 14：10：3​​1.518：E/AndroidRuntime(11888): java.lang.RuntimeException: 释放后调用的方法() 06-13 14:10:31.518: E/AndroidRuntime(11888): at android.hardware.Camera.setPreviewDisplay(Native Method) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 android.hardware.Camera.setPreviewDisplay(Camera.java:405) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在**com.example.sensor.Sensors10Activity$CameraPreview.surfaceCreated(Sensors10Activity.java:221)**
> 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 android.view.SurfaceView.updateWindow(SurfaceView.java:533) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 android. view.SurfaceView.onWindowVisibilityChanged(SurfaceView.java:226) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 android.view.View.dispatchWindowVisibilityChanged(View.java:5839) 06-13 14:10: 31.518: E/AndroidRuntime(11888): 在 android.view.ViewGroup.dispatchWindowVisibilityChanged(ViewGroup.java:945) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 android.view.ViewGroup.dispatchWindowVisibilityChanged(ViewGroup .java:945) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 android.view.ViewGroup.dispatchWindowVisibilityChanged(ViewGroup.java:945) 06-13 14:10:31.518: E/AndroidRuntime(11888 ): 在 android.view.ViewGroup。dispatchWindowVisibilityChanged(ViewGroup.java:945) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:965) 06-13 14:10:31.518: E/ AndroidRuntime(11888): 在 android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2442) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 android.os.Handler.dispatchMessage(Handler.java:99 ) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 android.os.Looper.loop(Looper.java:137) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 android .app.ActivityThread.main(ActivityThread.java:4424) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 java.lang.reflect.Method.invokeNative(Native Method) 06-13 14:10: 31.518: E/AndroidRuntime(11888): 在 java.lang.reflect.Method.invoke(Method.java:511) 06-13 14:10:31.518: E/AndroidRuntime(11888):在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) 06-13 14:10:31.518: E/AndroidRuntime(11888): 在 com.android.internal.os.ZygoteInit.main( ZygoteInit.java:551) 06-13 14:10:31.518: E/AndroidRuntime(11888): at dalvik.system.NativeStart.main(Native Method)

这是代码，大部分代码直接取自开发指南的相机示例和 ApiDemos/OS/Sensors 示例。有没有人看到在 Activity 生命周期中应该做些什么来避免在第 221 行发生的异常（如代码中所述）？

提前感谢您的检查，
格雷格

```
public class Sensors10Activity extends Activity {
private final String TAG = "SENSORS_TEST";
private SensorManager mSensorManager;
private GraphView mGraphView;
private Camera mCamera;
private CameraPreview mCameraPreview;

public class GraphView extends View implements SensorEventListener {
    private Bitmap  mBitmap;
    private Paint   mPaint = new Paint();
    private Canvas  mCanvas = new Canvas();
    private Path    mPath = new Path();
    private RectF   mRect = new RectF();
    private float   mLastValues[] = new float[3*2];
    private float   mOrientationValues[] = new float[3];
    private int     mColors[] = new int[3*2];
    private float   mLastX;
    private float   mScale[] = new float[2];
    private float   mYOffset;
    private float   mMaxX;
    private float   mSpeed = 1.0f;
    private float   mWidth;
    private float   mHeight;
    public GraphView(Context context) {
        super(context);
        mColors[0] = Color.argb(192, 255, 64, 64);
        mColors[1] = Color.argb(192, 64, 128, 64);
        mColors[2] = Color.argb(192, 64, 64, 255);
        mColors[3] = Color.argb(192, 64, 255, 255);
        mColors[4] = Color.argb(192, 128, 64, 128);
        mColors[5] = Color.argb(192, 255, 255, 64);

        mPaint.setFlags(Paint.ANTI_ALIAS_FLAG);
        mRect.set(-0.5f, -0.5f, 0.5f, 0.5f);
        mPath.arcTo(mRect, 0, 180);
    }

    @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        mBitmap = Bitmap.createBitmap(w, h, Bitmap.Config.RGB_565);
        mCanvas.setBitmap(mBitmap);
        mCanvas.drawColor(0xFFFFFFFF);
        mYOffset = h * 0.5f;
        mScale[0] = - (h * 0.5f * (1.0f / (SensorManager.STANDARD_GRAVITY * 2)));
        mScale[1] = - (h * 0.5f * (1.0f / (SensorManager.MAGNETIC_FIELD_EARTH_MAX)));
        mWidth = w;
        mHeight = h;
        if (mWidth < mHeight) {
            mMaxX = w;
        } else {
            mMaxX = w-50;
        }
        mLastX = mMaxX;
        super.onSizeChanged(w, h, oldw, oldh);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        synchronized (this) {
            if (mBitmap != null) {
                final Paint paint = mPaint;
                final Path path = mPath;
                final int outer = 0xFFC0C0C0;
                final int inner = 0xFFff7010;

                if (mLastX >= mMaxX) {
                    mLastX = 0;
                    final Canvas cavas = mCanvas;
                    final float yoffset = mYOffset;
                    final float maxx = mMaxX;
                    final float oneG = SensorManager.STANDARD_GRAVITY * mScale[0];
                    paint.setColor(0xFFAAAAAA);
                    cavas.drawColor(0xFFFFFFFF);
                    cavas.drawLine(0, yoffset,      maxx, yoffset,      paint);
                    cavas.drawLine(0, yoffset+oneG, maxx, yoffset+oneG, paint);
                    cavas.drawLine(0, yoffset-oneG, maxx, yoffset-oneG, paint);
                }
                canvas.drawBitmap(mBitmap, 0, 0, null);

                float[] values = mOrientationValues;
                if (mWidth < mHeight) {
                    float w0 = mWidth * 0.333333f;
                    float w  = w0 - 32;
                    float x = w0*0.5f;
                    for (int i=0 ; i<3 ; i++) {
                        canvas.save(Canvas.MATRIX_SAVE_FLAG);
                        canvas.translate(x, w*0.5f + 4.0f);
                        canvas.save(Canvas.MATRIX_SAVE_FLAG);
                        paint.setColor(outer);
                        canvas.scale(w, w);
                        canvas.drawOval(mRect, paint);
                        canvas.restore();
                        canvas.scale(w-5, w-5);
                        paint.setColor(inner);
                        canvas.rotate(-values[i]);
                        canvas.drawPath(path, paint);
                        canvas.restore();
                        x += w0;
                    }
                } else {
                    float h0 = mHeight * 0.333333f;
                    float h  = h0 - 32;
                    float y = h0*0.5f;
                    for (int i=0 ; i<3 ; i++) {
                        canvas.save(Canvas.MATRIX_SAVE_FLAG);
                        canvas.translate(mWidth - (h*0.5f + 4.0f), y);
                        canvas.save(Canvas.MATRIX_SAVE_FLAG);
                        paint.setColor(outer);
                        canvas.scale(h, h);
                        canvas.drawOval(mRect, paint);
                        canvas.restore();
                        canvas.scale(h-5, h-5);
                        paint.setColor(inner);
                        canvas.rotate(-values[i]);
                        canvas.drawPath(path, paint);
                        canvas.restore();
                        y += h0;
                    }
                }
            }
        }
    }

    public void onSensorChanged(SensorEvent event) {
        //Log.d(TAG, "sensor: " + sensor + ", x: " + values[0] + ", y: " + values[1] + ", z: " + values[2]);
        synchronized (this) {
            if (mBitmap != null) {
                final Canvas canvas = mCanvas;
                final Paint paint = mPaint;
                if (event.sensor.getType() == Sensor.TYPE_ORIENTATION) {
                    for (int i=0 ; i<3 ; i++) {
                        mOrientationValues[i] = event.values[i];
                    }
                } else {
                    float deltaX = mSpeed;
                    float newX = mLastX + deltaX;

                    int j = (event.sensor.getType() == Sensor.TYPE_MAGNETIC_FIELD) ? 1 : 0;
                    for (int i=0 ; i<3 ; i++) {
                        int k = i+j*3;
                        final float v = mYOffset + event.values[i] * mScale[j];
                        paint.setColor(mColors[k]);
                        canvas.drawLine(mLastX, mLastValues[k], newX, v, paint);
                        mLastValues[k] = v;
                    }
                    if (event.sensor.getType() == Sensor.TYPE_MAGNETIC_FIELD)
                        mLastX += mSpeed;
                }
                invalidate();
            }
        }
    }

    public void onAccuracyChanged(Sensor sensor, int accuracy) {
    }
}

public class CameraPreview extends SurfaceView implements SurfaceHolder.Callback {
    private SurfaceHolder mHolder;
    private Camera mCamera;

    public CameraPreview(Context context, Camera camera) {
        super(context);
        mCamera = camera;

        // Install a SurfaceHolder.Callback so we get notified when the
        // underlying surface is created and destroyed.
        mHolder = getHolder();
        mHolder.addCallback(this);
        // deprecated setting, but required on Android versions prior to 3.0
        mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    }

    public void surfaceCreated(SurfaceHolder holder) {
        // The Surface has been created, now tell the camera where to draw the preview.
        try {
            mCamera.setPreviewDisplay(holder);  // !!! LINE 221: exception occurs here.
            mCamera.startPreview();
        } catch (IOException e) {
            Log.d(TAG, "Error setting camera preview: " + e.getMessage());
        }
    }

    public void surfaceDestroyed(SurfaceHolder holder) {
        // empty. Take care of releasing the Camera preview in your activity.
    }

    public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {
        // If your preview can change or rotate, take care of those events here.
        // Make sure to stop the preview before resizing or reformatting it.

        if (mHolder.getSurface() == null){
          // preview surface does not exist
          return;
        }

        // stop preview before making changes
        try {
            mCamera.stopPreview();
        } catch (Exception e){
          // ignore: tried to stop a non-existent preview
        }

        // set preview size and make any resize, rotate or
        // reformatting changes here

        // start preview with new settings
        try {
            mCamera.setPreviewDisplay(mHolder);
            mCamera.startPreview();

        } catch (Exception e){
            Log.d(TAG, "Error starting camera preview: " + e.getMessage());
        }
    }
}

//////////////
// LIFE CYCLE
//

/**
 * Initialization of the Activity after it is first created.  Must at least
 * call {@link android.app.Activity#setContentView setContentView()} to
 * describe what is to be displayed in the screen.
 */
@Override
protected void onCreate(Bundle savedInstanceState) {
    // Be sure to call the super class.
    super.onCreate(savedInstanceState);

    mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    mCamera = Camera.open(1);
    mCameraPreview = new CameraPreview(this, mCamera);
    mGraphView = new GraphView(this);
    // setContentView(mGraphView);

    // Create RelativeLayout for layout root.
    RelativeLayout relativeLayout = new RelativeLayout(this);
    RelativeLayout.LayoutParams rlp = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.FILL_PARENT,
            RelativeLayout.LayoutParams.FILL_PARENT);

    // Add GraphView to layout.
    RelativeLayout.LayoutParams lpGraph = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.FILL_PARENT,
            RelativeLayout.LayoutParams.FILL_PARENT);
    mGraphView.setLayoutParams(lpGraph);
    relativeLayout.addView(mGraphView);

    // Add SurfaceView to layout.
    List<Camera.Size> ls = mCamera.getParameters().getSupportedPreviewSizes();
    int n = ls.size();
    int widthMin = 10000;
    int imin = -1;
    for (int i=0; i<n; i++) {
        Log.d(TAG, "supported preview width x height: " + ls.get(i).width + " x " + ls.get(i).height);
        if (widthMin > ls.get(i).width) {
            widthMin = ls.get(i).width;
            imin = i;
        }
    }
    if (imin >= 0) {
        RelativeLayout.LayoutParams lpSurface = new RelativeLayout.LayoutParams(
                ls.get(imin).width, ls.get(imin).height);
        lpSurface.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM);
        lpSurface.addRule(RelativeLayout.CENTER_HORIZONTAL);
        mCameraPreview.setLayoutParams(lpSurface);
        relativeLayout.addView(mCameraPreview);
    }

    // Provide Android framework with layout root.
    setContentView(relativeLayout, rlp);
}

@Override
protected void onResume() {
    super.onResume();
    mSensorManager.registerListener(mGraphView,
            mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER),
            SensorManager.SENSOR_DELAY_FASTEST);
    mSensorManager.registerListener(mGraphView,
            mSensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD),
            SensorManager.SENSOR_DELAY_FASTEST);
    mSensorManager.registerListener(mGraphView, 
            mSensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION),
            SensorManager.SENSOR_DELAY_FASTEST);

    if (mCamera == null)
        mCamera = Camera.open(1);
    if (mCameraPreview == null) 
        mCameraPreview = new CameraPreview(this, mCamera);
}

@Override
protected void onPause() {
    super.onPause();
    if (mCamera != null) {
        mCamera.stopPreview();
        mCamera.release();        // release the camera for other applications
        mCamera = null;
    }
    if (mCameraPreview != null) {
        mCameraPreview = null;
    }
}

@Override
protected void onStop() {
    mSensorManager.unregisterListener(mGraphView);
    super.onStop();
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T00:33:12.703

经过几个小时的反复试验，这些生命周期处理程序似乎工作了（即，它们处理由电源按钮引起的暂停、由主页图标引起的停止、由后退图标引起的破坏以及释放相机onPause() 以使其可用于系统的相机应用程序）。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    // Be sure to call the super class.
    super.onCreate(savedInstanceState);

    mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    mCamera = Camera.open(1);
    mCameraPreview = new CameraPreview(this, mCamera);
    mGraphView = new GraphView(this);
    // setContentView(mGraphView);

    // Create RelativeLayout for layout root.
    mLayoutRoot = new RelativeLayout(this);
    RelativeLayout.LayoutParams rlp = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.FILL_PARENT,
            RelativeLayout.LayoutParams.FILL_PARENT);

    // Add GraphView to layout.
    RelativeLayout.LayoutParams lpGraph = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.FILL_PARENT,
            RelativeLayout.LayoutParams.FILL_PARENT);
    mGraphView.setLayoutParams(lpGraph);
    mLayoutRoot.addView(mGraphView);

    // Add SurfaceView to layout.
    List<Camera.Size> ls = mCamera.getParameters().getSupportedPreviewSizes();
    int n = ls.size();
    int widthMin = 10000;
    int imin = -1;
    for (int i=0; i<n; i++) {
        Log.d(TAG, "supported preview width x height: " + ls.get(i).width + " x " + ls.get(i).height);
        if (widthMin > ls.get(i).width) {
            widthMin = ls.get(i).width;
            mCameraPreviewSize = ls.get(i);
            imin = i;
        }
    }
    if (imin >= 0) {
        RelativeLayout.LayoutParams lpSurface = new RelativeLayout.LayoutParams(
                ls.get(imin).width, ls.get(imin).height);
        lpSurface.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM);
        lpSurface.addRule(RelativeLayout.CENTER_HORIZONTAL);
        mCameraPreview.setLayoutParams(lpSurface);
        mLayoutRoot.addView(mCameraPreview);
    }

    // Provide Android framework with layout root.
    setContentView(mLayoutRoot, rlp);
    Log.d(TAG, "onCreate OUT mCamera, mCameraPreview: " + mCamera + ", " + mCameraPreview);
}

@Override
protected void onStart() {
    super.onStart();
    Log.d(TAG, "onStart OUT mCamera, mCameraPreview: " + mCamera + ", " + mCameraPreview);
}

@Override
protected void onResume() {
    super.onResume();
    mSensorManager.registerListener(mGraphView,
            mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER),
            SensorManager.SENSOR_DELAY_FASTEST);
    mSensorManager.registerListener(mGraphView,
            mSensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD),
            SensorManager.SENSOR_DELAY_FASTEST);
    mSensorManager.registerListener(mGraphView, 
            mSensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION),
            SensorManager.SENSOR_DELAY_FASTEST);

    if (mCamera == null)
        mCamera = Camera.open(1);
    if (mCameraPreview == null) {
        mCameraPreview = new CameraPreview(this, mCamera);
        RelativeLayout.LayoutParams lpCameraPreview = new RelativeLayout.LayoutParams(
                mCameraPreviewSize.width, mCameraPreviewSize.height);
        lpCameraPreview.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM);
        lpCameraPreview.addRule(RelativeLayout.CENTER_HORIZONTAL);
        mCameraPreview.setLayoutParams(lpCameraPreview);
        mLayoutRoot.addView(mCameraPreview);
    }
    Log.d(TAG, "onResume OUT mCamera, mCameraPreview: " + mCamera + ", " + mCameraPreview);
}

@Override
protected void onPause() {
    if (mCamera != null) {
        mCamera.stopPreview();
        mCamera.release();        // release the camera for other applications
        mCamera = null;
    }
    if (mCameraPreview != null) {
        mLayoutRoot.removeView(mCameraPreview);
        mCameraPreview = null;
    }
    super.onPause();
    Log.d(TAG, "onPause OUT mCamera, mCameraPreview: " + mCamera + ", " + mCameraPreview);
}

@Override
protected void onStop() {
    mSensorManager.unregisterListener(mGraphView);
    super.onStop();
    Log.d(TAG, "onStop OUT mCamera, mCameraPreview: " + mCamera + ", " + mCameraPreview);
}

@Override
protected void onDestroy() {
    super.onDestroy();
    Log.d(TAG, "onDestroy OUT mCamera, mCameraPreview: " + mCamera + ", " + mCameraPreview);
} 
```

# schema.org - Schema.org 和 Google Rich Snippets 测试工具的问题

> ID：11022034
> 
> 赞同：0
> 
> 时间：2012-06-13T19:30:46.047
> 
> 标签：schema.org, rich-snippets

我正在尝试让 Google Rich Snippets Tool 在我的帖子上显示星星，但我找不到我显然犯过的错误。

[http://www.google.com/webmasters/tools/richsnippets?url=http%3A%2F%2Fvpnstars.com%2Fvpn%2Fhide-my-ass%2F](http://www.google.com/webmasters/tools/richsnippets?url=http%3A%2F%2Fvpnstars.com%2Fvpn%2Fhide-my-ass%2F)

我希望有人可以通过上面的链接指导我。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T15:21:14.813

下面的代码有效，请随意调整它以适应您的喜好。

```
<div itemscope itemtype="http://schema.org/LocalBusiness">
    <h1 itemprop="name">Title</h1>
    <div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
        <div class="rating">
        <meta itemprop="ratingValue" content="4.0">
        </div>
        <span itemprop="reviewCount">33</span>
    </div>
</div> 
```

快乐编码:)

# c# - 使用 DDD 创建子实体的正确方法

> ID：11022036
> 
> 赞同：16
> 
> 时间：2012-06-13T19:30:53.950
> 
> 标签：c#, nhibernate, domain-driven-design, parent-child

我对 DDD 世界还很陌生，在阅读了几本关于它的书（其中包括 Evans DDD）后，我无法在互联网上找到我的问题的答案：用 DDD 创建子实体的正确方法是什么？你看，互联网上的很多信息都在一些简单的层面上运作。但是细节上的魔鬼，为了简单起见，在几十个 DDD 示例中总是省略它们。

我来自[我自己](https://stackoverflow.com/questions/2155845/domain-driven-design-parent-child-relation-pattern-specification-pattern/11001953#11001953)在stackoverflow上对类似问题的回答。我对自己对这个问题的看法并不完全满意，所以我认为我需要详细说明这个问题。

例如，我需要创建代表汽车命名的简单模型：公司、型号和改装（例如，Nissan Teana 2012 - 这将是“Nissan”公司、“Teana”型号和“2012”改装）。

我要创建的模型草图如下所示：

```
CarsCompany
{
    Name
    (child entities) Models
}

CarsModel
{
    (parent entity) Company
    Name
    (child entities) Modifications
}

CarsModification
{
    (parent entity) Model
    Name
} 
```

所以，现在我需要创建代码。我将使用 C# 作为语言，使用 NHibernate 作为 ORM。这很重要，并且通常不会在 Internet 上的大量 DDD 示例中显示。

**第一种方法。**

我将从通过工厂方法创建典型对象的简单方法开始。

```
public class CarsCompany
{
    public virtual string Name { get; protected set; }
    public virtual IEnumerable<CarsModel> Models { get { return new ImmutableSet<CarsModel> (this._models); } }

    private readonly ISet<CarsModel> _models = new HashedSet<CarsModel> ();

    protected CarsCompany ()
    {
    }

    public static CarsCompany Create (string name)
    {
        if (string.IsNullOrEmpty (name))
            throw new ArgumentException ("Invalid name specified.");

        return new CarsCompany
        {
            Name = name
        };
    }

    public void AddModel (CarsModel model)
    {
        if (model == null)
            throw new ArgumentException ("Model is not specified.");

        this._models.Add (model);
    }
}

public class CarsModel
{
    public virtual CarsCompany Company { get; protected set; }
    public virtual string Name { get; protected set; }
    public virtual IEnumerable<CarsModification> Modifications { get { return new ImmutableSet<CarsModification> (this._modifications); } }

    private readonly ISet<CarsModification> _modifications = new HashedSet<CarsModification> ();

    protected CarsModel ()
    {
    }

    public static CarsModel Create (CarsCompany company, string name)
    {
        if (company == null)
            throw new ArgumentException ("Company is not specified.");

        if (string.IsNullOrEmpty (name))
            throw new ArgumentException ("Invalid name specified.");

        return new CarsModel
        {
            Company = company,
            Name = name
        };
    }

    public void AddModification (CarsModification modification)
    {
        if (modification == null)
            throw new ArgumentException ("Modification is not specified.");

        this._modifications.Add (modification);
    }
}

public class CarsModification
{
    public virtual CarsModel Model { get; protected set; }
    public virtual string Name { get; protected set; }

    protected CarsModification ()
    {
    }

    public static CarsModification Create (CarsModel model, string name)
    {
        if (model == null)
            throw new ArgumentException ("Model is not specified.");

        if (string.IsNullOrEmpty (name))
            throw new ArgumentException ("Invalid name specified.");

        return new CarsModification
        {
            Model = model,
            Name = name
        };
    }
} 
```

这种方法的坏处是模型的创建不会将其添加到父模型集合中：

```
using (var tx = session.BeginTransaction ())
{
    var company = CarsCompany.Create ("Nissan");

    var model = CarsModel.Create (company, "Tiana");
    company.AddModel (model);
    // (model.Company == company) is true
    // but (company.Models.Contains (model)) is false

    var modification = CarsModification.Create (model, "2012");
    model.AddModification (modification);
    // (modification.Model == model) is true
    // but (model.Modifications.Contains (modification)) is false

    session.Persist (company);
    tx.Commit ();
} 
```

提交事务并刷新会话后，ORM 将正确地将所有内容写入数据库，下次我们加载该公司时，它的模型集合将正确保存我们的模型。修改也是如此。所以这种方法让我们的父实体处于不一致的状态，直到它从数据库中重新加载。不去。

**第二种方法。**

这次我们将使用特定于语言的选项来解决设置其他类的受保护属性的问题 - 即我们将在设置器和构造器上使用“受保护的内部”修饰符。

```
public class CarsCompany
{
    public virtual string Name { get; protected set; }
    public virtual IEnumerable<CarsModel> Models { get { return new ImmutableSet<CarsModel> (this._models); } }

    private readonly ISet<CarsModel> _models = new HashedSet<CarsModel> ();

    protected CarsCompany ()
    {
    }

    public static CarsCompany Create (string name)
    {
        if (string.IsNullOrEmpty (name))
            throw new ArgumentException ("Invalid name specified.");

        return new CarsCompany
        {
            Name = name
        };
    }

    public CarsModel AddModel (string name)
    {
        if (string.IsNullOrEmpty (name))
            throw new ArgumentException ("Invalid name specified.");

        var model = new CarsModel
        {
            Company = this,
            Name = name
        };

        this._models.Add (model);

        return model;
    }
}

public class CarsModel
{
    public virtual CarsCompany Company { get; protected internal set; }
    public virtual string Name { get; protected internal set; }
    public virtual IEnumerable<CarsModification> Modifications { get { return new ImmutableSet<CarsModification> (this._modifications); } }

    private readonly ISet<CarsModification> _modifications = new HashedSet<CarsModification> ();

    protected internal CarsModel ()
    {
    }

    public CarsModification AddModification (string name)
    {
        if (string.IsNullOrEmpty (name))
            throw new ArgumentException ("Invalid name specified.");

        var modification = new CarsModification
        {
            Model = this,
            Name = name
        };

        this._modifications.Add (modification);

        return modification;
    }
}

public class CarsModification
{
    public virtual CarsModel Model { get; protected internal set; }
    public virtual string Name { get; protected internal set; }

    protected internal CarsModification ()
    {
    }
}

...

using (var tx = session.BeginTransaction ())
{
    var company = CarsCompany.Create ("Nissan");
    var model = company.AddModel ("Tiana");
    var modification = model.AddModification ("2011");

    session.Persist (company);
    tx.Commit ();
} 
```

这次每个实体创建都使父实体和子实体处于一致状态。但是子实体状态的验证泄漏到父实体（`AddModel`和`AddModification`方法）中。由于我不是 DDD 方面的专家，我不确定它是否可以。当子实体的属性不能简单地通过属性设置并且基于传递的参数设置一些状态需要更复杂的工作来为属性分配参数值时，它可能会在未来产生更多问题。我的印象是，我们应该尽可能地将关于实体的逻辑集中在该实体内部。对我来说，这种方法将父对象变成了某种实体和工厂的混合体。

**第三种方法。**

好的，我们将颠倒维护亲子关系的职责。

```
public class CarsCompany
{
    public virtual string Name { get; protected set; }
    public virtual IEnumerable<CarsModel> Models { get { return new ImmutableSet<CarsModel> (this._models); } }

    private readonly ISet<CarsModel> _models = new HashedSet<CarsModel> ();

    protected CarsCompany ()
    {
    }

    public static CarsCompany Create (string name)
    {
        if (string.IsNullOrEmpty (name))
            throw new ArgumentException ("Invalid name specified.");

        return new CarsCompany
        {
            Name = name
        };
    }

    protected internal void AddModel (CarsModel model)
    {
        this._models.Add (model);
    }
}

public class CarsModel
{
    public virtual CarsCompany Company { get; protected set; }
    public virtual string Name { get; protected set; }
    public virtual IEnumerable<CarsModification> Modifications { get { return new ImmutableSet<CarsModification> (this._modifications); } }

    private readonly ISet<CarsModification> _modifications = new HashedSet<CarsModification> ();

    protected CarsModel ()
    {
    }

    public static CarsModel Create (CarsCompany company, string name)
    {
        if (company == null)
            throw new ArgumentException ("Company is not specified.");

        if (string.IsNullOrEmpty (name))
            throw new ArgumentException ("Invalid name specified.");

        var model = new CarsModel
        {
            Company = company,
            Name = name
        };

        model.Company.AddModel (model);

        return model;
    }

    protected internal void AddModification (CarsModification modification)
    {
        this._modifications.Add (modification);
    }
}

public class CarsModification
{
    public virtual CarsModel Model { get; protected set; }
    public virtual string Name { get; protected set; }

    protected CarsModification ()
    {
    }

    public static CarsModification Create (CarsModel model, string name)
    {
        if (model == null)
            throw new ArgumentException ("Model is not specified.");

        if (string.IsNullOrEmpty (name))
            throw new ArgumentException ("Invalid name specified.");

        var modification = new CarsModification
        {
            Model = model,
            Name = name
        };

        modification.Model.AddModification (modification);

        return modification;
    }
}

...

using (var tx = session.BeginTransaction ())
{
    var company = CarsCompany.Create ("Nissan");
    var model = CarsModel.Create (company, "Tiana");
    var modification = CarsModification.Create (model, "2011");

    session.Persist (company);
    tx.Commit ();
} 
```

这种方法在相应实体中获得了所有验证/创建逻辑，我不知道它是好是坏，但是通过使用工厂方法简单地创建对象，我们隐式地将其添加到父对象子集合中。在事务提交和会话刷新之后，即使我从未在我的代码中编写过一些“添加”命令，也会有 3 次插入到数据库中。我不知道这可能只是我和我在 DDD 世界之外的丰富经验，但现在感觉有点不自然。

**那么，用 DDD 添加子实体的最正确方法是什么？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-17T19:09:32.233

我在这里得到了可以接受的答案：[https ://groups.yahoo.com/neo/groups/domaindrivendesign/conversations/messages/23187](https://groups.yahoo.com/neo/groups/domaindrivendesign/conversations/messages/23187)

基本上，它是方法 2 和 3 的组合 - 将 AddModel 方法放入 CarsCompany 并使其调用 CarsModel 的受保护内部构造函数，其名称参数在 CarsModel 的构造函数中验证。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-20T10:47:56.393

> 那么，用 DDD 添加子实体的最正确方法是什么？

第三种方法称为[紧耦合](https://stackoverflow.com/q/2832017/2444725)。`Company`，`Car`并且`Modification`几乎了解彼此的一切。

第二种方法在 DDD 中被广泛提出。域对象负责创建嵌套域对象并将其注册到内部。

第一种方法是经典的 OOP 风格。对象的创建与将对象添加到某个集合中是分开的。这样，代码使用者可以用任何派生类（例如 TrailerCar）的对象替换具体类（例如 Car）的对象。

```
// var model = CarsModel.Create (company, "Tiana");

var model = TrailerCarsModel.Create (
    company, "Tiana", SimpleTrailer.Create(company));

company.AddModel (model); 
```

尝试在第 2 种/第 3 种方法中采用这种业务逻辑更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-24T03:12:23.043

有趣的。DDD vs Repository / ORM 导航属性。我认为答案取决于您是在处理一个聚合还是两个聚合。CarsModel 应该是 CarsCompany 聚合的一部分，还是它自己的聚合？

方法一是让问题消失。MikeSW 暗示了这一点。如果 CarsCompany 和 CarsModel 不需要是同一个聚合的一部分，那么它们应该只通过身份相互引用，导航属性在域中不可见。

方法二是将添加到关系中的方式与我们处理获取聚合的方式相同 - 使应用程序服务从存储库中调用一个方法，这是解决您的 ORM 特定问题的正确位置。这种方法可以填充关系的两端。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-15T10:10:19.980

这是一个非常具体且非常诚实的答案：您所有的方法都是错误的，因为您违反了 DDD 的“第一条规则”，即数据库不存在。

您定义的是 ORM (nhibernate) 的 PERSISTENCE 模型。为了设计域对象，首先您必须识别[有界上下文](https://blog.sapiensworks.com/post/2012/04/17/DDD-The-Bounded-Context-Explained.aspx)、它的模型、该模型的实体和值对象以及[聚合根](https://blog.sapiensworks.com/post/2012/04/18/DDD-Aggregates-And-Aggregates-Root-Explained.aspx)（它将在内部处理子和业务规则）。

Nhibernate 或 db 模式在这里没有位置，您只需要纯 C# 代码和对领域的清晰了解。

# mysql - MySQL在一列的最后5个字符内搜索？

> ID：11022038
> 
> 赞同：3
> 
> 时间：2012-06-13T19:30:56.553
> 
> 标签：mysql, search, substring

我的用户表有一个“名称”列，其中包含如下信息：

```
Joe Lee
Angela White 
```

我想有效地搜索名字或姓氏。名字很简单，我可以

```
SELECT * FROM user WHERE name LIKE "ABC%" 
```

但是对于姓氏，如果我这样做

```
SELECT * FROM user WHERE name LIKE "%ABC" 
```

那将是非常缓慢的。

所以我正在考虑计算输入的字符，例如“ABC”有 3 个字符，如果我只能搜索名称列中的最后三个字符，那就太好了。所以我想要类似的东西

```
SELECT * FROM user WHERE substring(name, end-3, end) LIKE "ABC%" 
```

MySQL中有什么可以做到这一点吗？

非常感谢！

PS。我不能做全文，因为我们的搜索引擎不支持。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:51:36.570

原因是

```
 WHERE name LIKE '%ith' 
```

按姓氏查找“约翰·史密斯”是一种缓慢的方法。

```
 WHERE Right(name, InStr(name, ' ' )) LIKE 'smi%' 
```

或列上的任何其他表达式都很慢。它破坏了使用索引进行快速查找，并使 MySQL 服务器进行全表扫描或全索引扫描。

如果您使用的是 Oracle（也就是说，如果您为以前富有的雇主工作），您可以使用函数索引。因为它是你必须添加一些额外的列或一些其他帮助数据来加速你的搜索。

你最聪明的做法是将你的名字和姓氏分成不同的列。其他几个人已经指出了这样做的充分理由。

如果你不能这样做，你可以尝试创建一个包含反向名称字符串的额外列，并在该列上创建一个索引。例如，该列将存储为“htimS nhoJ”的“John Smith”。然后你可以搜索如下。

```
 WHERE nameReversed LIKE CONCAT(REVERSE('ith'),'%') 
```

此搜索将使用索引并且速度相当快。我已经取得了很好的成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T19:43:51.000

你很近。在 MySQL 中，您应该能够使用`InStr(str, substr)`并`Right(str, index)`执行以下操作：

```
 SELECT * FROM user WHERE Right(name, InStr(name, " ")) LIKE "ABC%" 
```

`InStr(name, " ")`返回空格字符的索引（您可能必须使用`" "`语法）。然后在`Right()`函数中使用该索引仅搜索姓氏（基本上；当您有多个名称、多个空格等时会出现问题）。`LIKE "ABC%"`然后将搜索以 ABC 开头的姓氏。

您不能使用固定索引，因为长度超过 3 个或少于 3 个字符的名称不会按照您的建议正确返回。

但是，正如 Zane 所说，使用单独的字段是一种**更好的做法。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T19:47:20.050

如果它是一个 MyIsam 表，您可以使用自由文本搜索来做同样的事情。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-13T19:44:42.323

您可以使用 REGEXP 运算符：

```
SELECT * FROM user WHERE name REGEXP "ABC$" 
```

[http://dev.mysql.com/doc/refman/5.1/en/regexp.html](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)

# jquery - ie9 中的 jquery 问题（.slidedown()、.hide()）

> ID：11022044
> 
> 赞同：0
> 
> 时间：2012-06-13T19:31:09.140
> 
> 标签：jquery, internet-explorer-9, slidedown

在单击上面的链接后，我试图将隐藏的 div 添加到 .slideDown()/.slideUp() 。div 具有显示属性“隐藏”。它在除 IE9 之外的所有浏览器中都可以正常工作。当我在 IE9 中单击我的链接时，没有任何反应，这意味着隐藏的 div 没有显示。但是，如果我将 div 的显示属性设置为“可见”，它会很好地切换。我尝试了 .show()/.hide() 和 .toggle() 但我得到了相同的结果。知道如何解决这个问题吗？

这是我的 HTML 代码

```
<span class="toggle">
<li id="toggler">
    <a id="atoggler1" href="#">
        '.$info['category'].'
    </a></li></span>
<div class="hiddenDiv">
<p>
    $info['description']
</p>
.....
.....
 </div> 
```

这是我的 CSS 代码

```
.hiddenDiv{
    display: none;
 } 
```

这是我的 JavaScript

```
$(document).ready(function() {

$(".toggle").click(function () {

    // check the visibility of the next element in the DOM
    if ($(this).next().is(":hidden")) {
        $(this).next().slideDown("fast"); // slide it down
        return false;
    } else {
        $(this).next().slideUp("fast"); // hide it
        return false;
      }
  });
}); 
```

也只是为了记录，我的 HTML 代码被包裹在 php 代码中。为了清楚起见，我没有包括在内。

如何解决这个问题？或者我的选择是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:37:28.320

`$(this).next()`从

```
<span class="toggle"> 
```

是

```
<li id="toggler"> 
```

而不是你想要展示的

```
<div class="hiddenDiv"> 
```

根据你的标记。如果你使用

```
$('#toggler').find('.hiddenDiv') 
```

相反，这应该可以解决问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T19:47:18.187

在修复 HTML 中缺少的关闭 div 并修改代码以定位正确的 div 之后，这在 IE9 中对我来说工作正常：

```
$(document).ready(function() {

    $(".toggle").click(function () {
        $(this).closest(".toggle").next().slideToggle("fast");
        return(false);
    });

});​ 
```

工作演示：http: [//jsfiddle.net/jfriend00/d3TX9/](http://jsfiddle.net/jfriend00/d3TX9/)

1.  您的问题中的 HTML 没有`</div>`为 hiddenDiv关闭
2.  我确保无论点击发生在哪里，它都会`.next()`从`.toggle`对象开始。
3.  为了简单起见，我切换到`slideToggle()`了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T16:00:37.537

出于某种原因，如果我的 CSS 文件的链接标签在 HTML 标签内，它就不起作用。但如果我把它们留在外面，它就会影响我的造型。经过大量研究后，我发现 jQuery 或 IE9 中存在错误。当我运行控制台时，单击链接时出现无效调用错误。此错误出现在我的 jQuery 代码中，位于此特定行。电话`this.appendChild( elem );`只是为了修复它，我不得不将其更改为`this.parentNodeappendChild( elem );`并修复它。

因此，如果将来其他人遇到此问题，请按照以下方法解决：

1.  根据您的 jQuery 版本，通过运行控制台检查有错误的行
2.  转到该行并更改`this.appendChild( elem );`为`this.parentNode.appendChild( elem );`

# c# - String.Split() 可以返回 null 吗？（。网）

> ID：11022049
> 
> 赞同：32
> 
> 时间：2012-06-13T19:31:55.583
> 
> 标签：c#, .net, string

有没有`System.String.Split()`回来`null`？（。网）

我知道我一直在编码，但是在阅读文档时我没有看到这样的声明。由于文档中没有这样的说法，所以想问问在社区的经验中，有没有人真正遇到过`string.Split`退货的情况`null`？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-06-13T19:34:25.863

不，它不能返回 null。如果你看它的来源，它甚至用代码契约来保证它：

```
public String[] Split(params char[] separator) {
    Contract.Ensures(Contract.Result<String[]>() != null); 
```

所有公共重载也做出同样的保证。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-06-13T19:34:46.443

不，它不返回 null。如果分隔符不存在，则返回整个字符串

来自[MSDN](http://msdn.microsoft.com/en-us/library/tabh47cf.aspx)

> 如果此实例不包含分隔符中的任何字符串，则返回的数组由包含此实例的单个元素组成。如果 separator 参数为 null 或不包含字符，则假定空白字符为分隔符

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T20:03:59.790

它无法返回，请确保您的财产不是空的

```
if (property != null)
{
    string[] splitData = sampleObject.property.Split(new char[] { ',' },
    StringSplitOptions.RemoveEmptyEntries);
} 
```

# matlab - 来自 CLUSTERGRAM 对象的置换向量 (MATLAB)

> ID：11022051
> 
> 赞同：4
> 
> 时间：2012-06-13T19:32:05.457
> 
> 标签：matlab, permutation, dendrogram

我正在使用来自 Bioinformatics Toolbox（版本 3.7）的[**CLUSTERGRAM对象。**](http://www.mathworks.com/help/toolbox/bioinfo/ref/clustergram.html)MATLAB 版本 R2011a。

我想为clustergram获取行和列的排列向量，就像我可以使用[树状图](http://www.mathworks.com/help/toolbox/stats/dendrogram.html)函数一样：

```
x = magic(10);
>> [~,~,permrows] = dendrogram(linkage(x,'average','euc'))
permrows =
     9    10     6     7     8     1     2     4     5     3
>> [~,~,permcols] = dendrogram(linkage(x','average','euc'))
permcols =
     6     7     8     9     2     1     3     4     5    10 
```

我发现 clustergram 和 dendrogram 的聚类不一样，很可能是由于优化的叶子排序计算（我不想禁用它）。

例如，对于来自的 clustergram：

```
clustergram(x) 
```

（`'average'`并且`'eucledian'`是 clustergram 的默认方法）

向量（如附图所示）应为：

```
permrows = [1 2 4 5 3 10 9 6 7 8];
permcols = [1 2 8 9 6 7 10 5 4 3]; 
```

![簇图示例](../Images/572df52e5a5b6d9c30bd3d45d579b01b.png)

那么，如何以编程方式获取这些向量呢？有熟悉这个物体的吗？

有人可以提出一个好的选择吗？我知道我可以创建一个结合 imagesc 和 dendrogram 函数的类似图形，但是在 clustergram 中的叶子排序比在 dendrogram 中要好得多（最佳）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T16:40:17.273

通过查看文档，我猜想`get(gco,'ColumnLabels')`和`get(gco,'RowLabels')`，`gco`clustergram 对象在哪里，应该给你重新排序的标签。请注意，相应的`set`-methods 以原始顺序接收标签并在内部重新排序它们。

因此，如果您使用了自定义标签 ( `set(gco,'RowLabels',originalLabels)`)

```
[~,permrows] = ismember(get(gco,'RowLabels'),originalLabels) 
```

应该返回行排列。

# stored-procedures - 将调用从 C# 转换为 VB.net 的存储过程

> ID：11022052
> 
> 赞同：0
> 
> 时间：2012-06-13T19:32:06.827
> 
> 标签：stored-procedures, c#-to-vb.net

```
Dim sql1 As String = ("EXEC [dbo].[usp_GetReportData_All] @ReportID=N'{0}', @StartDate=N'{1}' @EndDate=N'{2}', @StartDate2=N'{3}' @EndDate2=N'{4}'", repotid1, startdata1, EndDate1, StartDate3,Enddate3 ) (this is what I tried to do in VB.net) 
```

好的，通常我在 C# 中将这行代码保存到一个字符串中，然后从那里我使用该字符串将存储过程运行到数据表中。显然 vb.net 似乎不喜欢这种格式，所以我只是想知道是否可以将此行保存到字符串中或不在 vb.net 中

糟糕，这是我在 C# 中所做的：

```
string srcSQL = string.Format(then the line in parans up there) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:45:04.563

正如您在 Console.Writeline(http://msdn.microsoft.com/en-us/library/aa324760(v=vs.71).aspx) 示例中看到的那样，您可以使用它，例如：

`Console.WriteLine("Grand total:\t{0,8:c}", Total);`

例如

```
 Dim total As String
    Dim result As String
    total = "1000"
    result = String.Format("restulado {0}", total)
    MsgBox(result) 
```

var Total 被格式化为货币

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T19:35:20.640

使用 String.Format("YourSQLText", parameter0, parameter1)

# ruby-on-rails - 在rails中向link_to添加方法和html选项？

> ID：11022056
> 
> 赞同：3
> 
> 时间：2012-06-13T19:32:16.813
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我是 ruby​​ 和 rails 的新手，在创建注销链接时遇到问题（使用 devise 进行身份验证）。我想将自定义 :method 参数传递给 link_to 函数，并设置一个自定义类。我似乎能够做到其中之一，但不能两者兼而有之。

当我尝试：

```
<%= link_to "Sign out", destroy_user_session_path, :method => :delete, { :class => 'signout'}   %> 
```

我通过单击链接获得了正确的结果，但我失去了我的样式。另一方面，当我尝试：

```
<%= link_to "Sign out", destroy_user_session_path, { :class => 'signout'}, :method => :delete %> 
```

我得到了我想要的样式，但链接请求作为 GET 而不是 DELETE 传递，导致路由错误。

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T19:38:02.983

尝试将`:class`和`:method`放在哈希内。

所以： `<%= link_to "Sign out", destroy_user_session_path, { :class => 'signout', :method => :delete} %>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T19:46:02.317

您在这里不需要哈希，因为它已经是哈希：D

```
link_to "Sign out", destroy_user_session_path, method: "delete", class: "signout" 
```

利润！

# model-view-controller - 如何在 MVC（CFWheels）中跨 2 个控制器/模型处理 1 个表单？

> ID：11022060
> 
> 赞同：2
> 
> 时间：2012-06-13T19:32:41.273
> 
> 标签：model-view-controller, coldfusion, cfwheels

我是一名老 CFML 开发人员，对 CF on Wheels 和 MVC 编程很陌生。我很快就学会了，但对我来说并不明显的一件事是如何提供一个表单来选择性地更新多个数据库表记录（模型）。我特别想为用户信息和用户个人资料信息设置一个选项卡式表单，前者是必需的，后者不是。此数据存储在两个不同的一对一表中。为了调用两个“新”或“编辑”视图，运行 2 个“创建”或“更新”过程，影响两个不同的表，我需要什么设置。或者我认为这一切都错了。

更新：添加更多关于我正在尝试做的事情的信息。为简单起见，我将坚持使用 2 个选项卡和 2 个表格，尽管在这种情况下我真的至少要查看 3 个。

所以我有一个 Users 表和一个 UserProfiles 表，我有一个名为 User.cfc 和 UserProfile.cfc 的模型，它们是一对一相关的，而 UserProfile 依赖于用户。很标准的东西。对于每个我都有控制器：Users.cfc 和 UserProfiles.cfc，每个都包含操作。添加、编辑、创建、更新、做显而易见的事情（添加和编辑显示表单）。我有部分显示每个的添加/编辑表单字段，所以已经准备好了。现在，我想创建一个有效的添加/编辑表单，可以同时更新两个表。标签并不重要。实际上它可能都在一页上。

所以从概念上讲，我正在做类似的事情：

```
#startFormTag(action=???)#
#includePartial("form_user_add-edit")#
#includePartial("form_userprofile_add-edit")#
<button type="submit" class="btn">#operation#</button>
#endFormTag()# 
```

我是否需要创建一个单独的控制器操作，该操作基本上结合了两个不同控制器的创建和更新操作？

提前感谢一位高兴和热切的 CFWheels 新手...

布赖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T13:14:31.013

如果所有数据都通过`hasMany`或`hasOne`关联相关，我建议查看嵌套属性。

[http://cfwheels.org/docs/1-1/chapter/nested-properties](http://cfwheels.org/docs/1-1/chapter/nested-properties)

但是，如果您是新手，则可能要避免这样做，直到您解决了一些更简单的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T19:49:37.630

我猜你说的是代表这两个表的两个模型，可能使用[hasOne](http://cfwheels.org/docs/1-1/chapter/associations)关联。模型允许您[验证数据](http://cfwheels.org/docs/1-1/chapter/object-validation)，这使得控制器更简单。这样，您可以在两个选项卡下创建两个[表单](http://cfwheels.org/docs/1-1/chapter/form-helpers-and-showing-errors)，并将记录的主键保留为隐藏字段。控制器可以运行验证并重新显示表单（[部分](http://cfwheels.org/docs/1-1/chapter/partials)可能会有所帮助）......等等，我只是通过[参考](http://cfwheels.org/docs/1-1/chapter)。

我意识到这个答案和您的问题一样非常笼统。我建议你继续尝试一些东西，看看它是如何工作的。

之后用代码示例更新您的问题，并询问您是否有一些具体问题。例如，在 CFWheels 中验证和显示错误可能有点棘手。

# android - 箭头键访问的 Android 状态名称

> ID：11022069
> 
> 赞同：0
> 
> 时间：2012-06-13T19:33:21.763
> 
> 标签：android, selector

这里有一个简单的问题，当用户使用箭头键访问按钮时，它叫什么？例如，当用户按下按钮时，称为按下状态。

此外，在使用选择器时如何定位此状态？这是我当前的选择器

```
 <?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:state_pressed="true"
      android:color="#d7d6d6"/> <!-- pressed -->
<item android:state_focused="true"
      android:color="#d7d6d6"/> <!-- focused -->
<item android:color="#d7d6d6"/> <!-- default --> 
```

当用户使用箭头键进入视图时，我还想更改颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:52:41.373

它在 XML 中称为焦点状态或 state_focused。

引用参考：

> onFocusChange() 来自 View.OnFocusChangeListener。当用户使用导航键或轨迹球导航到或离开项目时调用此方法。

[在同一页面](http://developer.android.com/guide/topics/ui/ui-events.html#HandlingFocus)的下方，您会发现如何处理焦点更改。希望有帮助！:)

# java - Java：想要对数组的子集进行二进制搜索

> ID：11022075
> 
> 赞同：3
> 
> 时间：2012-06-13T19:33:39.843
> 
> 标签：java, binary-search

在 Java 中，Arrays.binarySearch 总是搜索整个数组。有时数组的一部分还没有被填充。是否有任何功能可以搜索数组的一部分，例如

```
int binarySearch(int[] a, int end, int value) 
```

是的，我可以只使用 a `TreeMap<Integer>`，但我有很多这些，并且`TreeMap<Integer>`使用的内存是 int[] 的几倍。

是的，我当然可以编写二进制搜索，但鉴于 Arrays.binarySearch 的存在，我似乎不必自己编写。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-13T19:35:39.150

有一个重载[`Arrays.binarySearch()`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#binarySearch%28int%5B%5D,%20int,%20int,%20int%29)就是这样做的：

```
public static int binarySearch(int[] a,
                               int fromIndex,
                               int toIndex,
                               int key) 
```

它在 Java 1.6+ 中可用。

# iphone - 如何使用多个子视图作为 iPad 的封面流？

> ID：11022081
> 
> 赞同：1
> 
> 时间：2012-06-13T19:34:14.517
> 
> 标签：iphone, ios, ipad, uipagecontrol, coverflow

![在此处输入图像描述](../Images/a6eca78c0ad8a338763fad548f87f99b.png)

我正在开发 Ipad 应用程序。在这个应用程序中，我想在 MainClass.Xib 上添加 15 个子视图。正如我的屏幕截图所示，当我单击任何子视图时，它会缩小。我的问题与coverflow有点相关，但对我来说，问题是我如何在mainview.xib中添加所有这些子视图，然后使用所有这些子视图，就像封面一样flow.all 这些子视图从服务器获取一些数据。所以任何人都可以指导我如何做到这一点。任何帮助都将被 Appriated.Thanx

# iphone - 设置 UIImagePickerController 的 UIBarStyle

> ID：11022086
> 
> 赞同：4
> 
> 时间：2012-06-13T19:34:33.760
> 
> 标签：iphone, ios, uiimagepickercontroller

我想将 a 的条形样式设置`UIImagePickerController`如下，但条形仍然是`UIBarStyleBlackTranslucent`. 是否可以设置栏样式`UIImagePickerController`？提前致谢！

```
UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];
imagePicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;        
imagePicker.navigationBar.barStyle = UIBarStyleBlack; 
```

编辑 1

我可以通过以下方式设置色调颜色：

```
imagePicker.navigationBar.tintColor = UIColorFromRGB(0xCC6600); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-27T09:14:07.277

这对我有用（您需要测试navigationController的类，而不是正在呈现的viewController，并且您似乎还需要设置不透明的背景颜色）

```
- (void)navigationController:(UINavigationController *)navigationController
      willShowViewController:(UIViewController *)viewController
                    animated:(BOOL)animated
{
    if ([navigationController isKindOfClass:[UIImagePickerController class]])
    {
        navigationController.navigationBar.barStyle = UIBarStyleBlack;
        navigationController.navigationBar.backgroundColor = [UIColor blackColor];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-27T13:39:02.200

```
imagePicker.navigationBar.tintColor=[UIColor blackColor]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T19:50:50.917

您可以通过实现`UINavigationControllerDelegate`方法来进行更改`navigationController:willShowViewController:`，如下所示：

```
- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController
            animated:(BOOL)animated {
    if([viewController isKindOfClass:[UIImagePickerController class]])
             navigationController.navigationBar.barStyle = UIBarStyleBlack;
 } 
```

# ios - 您如何像 iPhone 上的地图应用程序一样将工具栏保持在顶部？

> ID：11022088
> 
> 赞同：0
> 
> 时间：2012-06-13T19:34:40.943
> 
> 标签：ios, iphone, toolbar, page-curl

当页面卷曲影响发生时，我的工具栏也会卷曲。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:41:31.050

不幸的是，这并不容易做到。似乎 Apple 使用了未记录的 mapCurl 动画（我们不允许使用）。

Tim Arnold 在[此处列出了有关堆栈溢出的解决方案。](https://stackoverflow.com/questions/6873903/uimodaltransitionstylepartialcurl-with-uitabbarcontroller/)我尝试从 github 下载他的示例，但是该项目有一些问题（我在 github 上提交了一个问题）。

我所做的只是把地图卷起来，它会在同一个包含视图上显示它后面的任何内容：

```
- (IBAction)curlMap:(id)sender {

    [UIView animateWithDuration:.5 animations:^{
        [UIView setAnimationTransition:self.mapCurledUp?UIViewAnimationTransitionCurlDown:UIViewAnimationTransitionCurlUp forView:self.mapView cache:YES];
        self.mapCurledUp = !self.mapCurledUp;
        self.mapView.hidden = self.mapCurledUp;
   } completion:^(BOOL finished){}];
} 
```

这并不完全模仿地图应用程序，因为它不会使地图部分卷曲，而是关闭。

# ruby-on-rails - 与 Heroku/MongoHQ 冲突的 Mongoid 版本

> ID：11022093
> 
> 赞同：1
> 
> 时间：2012-06-13T19:34:59.247
> 
> 标签：ruby-on-rails, mongoid

我有一个 Rails 3.2 应用程序，我正在尝试使用 Mongoid 和 MongoHQ 在 Heroku 上运行，我发现我必须使用不同版本的 Mongoid gem 来进行本地开发与 Heroku。
这是我发现的；

要让应用程序在 Heroku 和 MongoHQ 上运行，我必须使用 Mongoid 2.4.11 要让应用程序在本地运行，我必须使用 Mongoid 3.0.0.rc

这是我得到的错误；

Mongoid 2.4.10 本地，

```
undefined class/module Moped:: 
```

Heroku/MongoHQ 上的 Mongoid 3.0.0.rc

```
We're sorry, but something went wrong. 
```

为什么不兼容？

# android - 预打包图像的位置

> ID：11022095
> 
> 赞同：0
> 
> 时间：2012-06-13T19:35:12.143
> 
> 标签：android

我有一个名为的图像`image01.png`与我的应用程序一起打包在`res/drawable`. 由于要指定的原因，我需要获取该图像的文件路径。我在模拟器上查看了 DDMS 透视图，但似乎找不到图像。在哪里/如何找到图像的文件路径？

对于不介意“tl;dr”的人：我正在尝试将图像用作地图视图上的叠加层。但是，图片实在是太大了，超过了安卓分配的16MB预算。我发现我可以使用 BitmapRegionDecoder 以一口大小的块加载图像，但 BitmapRegionDecoder 使用文件路径字符串、InputStream、FileDescriptor 或字节数组来创建新实例。由于这是我将与应用程序一起预先打包的图像，因此我不觉得使用 InputStream 是所有必要的。但是，如上所述，我找不到图像的文件路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:44:46.153

将您的所有图像放在项目资产文件夹中，然后您就可以通过文件路径（如 sdcard 图像）访问它。

请查看[链接](https://stackoverflow.com/questions/5860873/how-to-get-the-path-to-the-android-assets-folder-in-the-application-package)

认为它对你有帮助。谢谢

# c++ - OpenSSL 配置最大连接数

> ID：11022096
> 
> 赞同：8
> 
> 时间：2012-06-13T19:35:15.653
> 
> 标签：c++, c, openssl

我的应用程序在内部出现段错误之前拥有 950-970 个 SSL 连接`SSL_read`。是否可以将 OpenSSL 配置为接受比这更多的连接？

我已经对其进行了编程，使其在获取连接后不对连接执行任何操作，所以我知道这是打开连接数的函数，而不是当前读/写或时间的连接数。

更新：

*   ubuntu 在同一个地方出现同样的错误。我正在开发 ubuntu。
*   如果我在相同数量的连接下将我的机器大小（RAM、交换、CPU）加倍，则会出现同样的错误。
*   上下文不为空。
*   `ulimit -n`设置为 4096。我也通过设置验证了这一点，`ulimit -100`在这种情况下会观察到不同的错误。
*   即使线程被池化，问题也会发生。问题发生在相同数量的连接上，无论是 1 个线程/连接还是 1 个线程/10 个连接。

我正在尝试从启用调试选项的源代码构建 OpenSSL。我开始怀疑这是否需要几个小时或告诉我任何有用的信息。我在这里有一个问题[。](https://stackoverflow.com/questions/11129826/build-openssl-on-linux-with-g-for-debugging)

我已经确定在 openssl v 1.0.1.c 的这条线上发生了段错误：

```
ssl_lib.c:968

968     return(s->method->ssl_read(s,buf,num)); 
```

此外，我已经确定这不是`ssl_read`函数内部的段错误（应该指向`ssl3_read`）。的成员实际上本身是无效的，而且它本身似乎`ssl_read`也是无效的（我是根据“奇怪的地址”推断出来的。）`method``method`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T05:40:37.470

恕我直言，您似乎达到了一些限制。正如你所说，数字文件描述符是可以的。因此，您可以尝试使用`ulimit`. 例如：

```
ulimit -s 32768 
```

此外，您可以使用[valgrind](http://valgrind.org/)之类的工具来帮助您找出应用程序段错误时的实际情况。

希望能帮助到你。

# c++ - 将浮点向量转换为字节向量并返回

> ID：11022099
> 
> 赞同：4
> 
> 时间：2012-06-13T19:35:25.460
> 
> 标签：c++, floating-point, byte

我正在尝试在 float 和 unsigned char 数组（在本例中为 std::vector ）之间进行一些转换，但遇到了一些麻烦。

我已经将浮点向量转换为 unsigned char 像这样......

```
vector<float> myFloats;
myFloats.push_back(1.0f);
myFloats.push_back(2.0f);
myFloats.push_back(3.0f);

const unsigned char* bytes = reinterpret_cast<const unsigned char*>(&floats[0]);

vector<unsigned char> byteVec;

for (int i = 0; i < 3; i++)
    byteVec.push_back(bytes[i]); 
```

我希望我已经正确地做到了这一点，如果不是这将是下一部分将无法工作的原因。

```
// converting back somewhere later in the program
unsigned char* bytes = &(byteVec[0]);    // point to beginning of memory
float* floatArray = reinterpret_cast<float*>(*bytes);

for (int i = 0; i < 3; i++)
    cout << floatArray[i] << endl;  // error here 
```

我尝试在最后一部分中使用 (bytes) 而不是 (*bytes) ，但打印出错误的值。这样做也会打印错误的值

```
for (int i = 0; i < 3; i++)
    cout << (float)bytes[i] << endl; 
```

不知道如何从中取回我的原始浮点值。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T19:51:44.253

解决了：

我认为问题出在这里

```
vector<unsigned char> byteVec;

for (int i = 0; i < 3; i++)
    byteVec.push_back(bytes[i]); 
```

我将其删除并替换为

```
vector<unsigned char> byteVec(bytes, bytes + sizeof(float) * myFloats.size()); 
```

然后其余的工作正常！

另外，请记住在这里使用 (bytes) 而不是 (*bytes)

```
float* floatArray = reinterpret_cast<float*>(bytes); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T19:43:20.127

我不得不做这种事情来通过 TCP 发送原始字节数据。我使用了一个包含单个`unsigned char[4]`数组的结构，并用于`memcpy`将我的浮点值中的字节复制到该数组的开头。它可能并不理想，但对于我的目的来说它确实足够好。显然，您可以执行相反的操作来检索数据。

# c# - XNA 的 Content 项目中添加的引用的文件路径是什么？

> ID：11022100
> 
> 赞同：0
> 
> 时间：2012-06-13T19:35:25.657
> 
> 标签：c#, .net, file, xna

这个问题与此有些相似[。](https://stackoverflow.com/questions/6103839/how-to-point-to-file-in-content-in-xna)

就我而言，我有一个文本文件。而且由于没有适用于文本文件的内容导入器，我必须使用流阅读器编写自己的函数。我想要完成的是从文本文件中读取，并在选项屏幕中相应地设置一些值。我已经添加了所有必要的引用，但是使用“../options.txt”作为文件路径不起作用。文件路径很可能被解析为 Content 文件夹以外的其他内容。那我该如何进行呢？

此外，我收到错误消息说“尝试访问方法（System.IO ....ctor）失败”。我是否缺少添加其他参考？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T07:45:48.120

这必须在 xBox 360 上工作吗？如果是这样，则无法像在 Windows 中那样仅使用文件系统，则需要使用存储设备。老实说，无论如何我都会使用这种方法，所以如果你决定将你的游戏带到 WP7 或 360 上，它就可以工作。

有一个很好的演示游戏，可以在[这个](http://msdn.microsoft.com/en-us/library/bb203921.aspx)Microsoft 页面上加载和保存数据以及它在做什么的描述

这是从demo中截取的，它展示了如何打开一个存储容器并将一些配置数据序列化到它，加载操作同样简单。

```
// Create the data to save.
SaveGameData data = new SaveGameData();
data.PlayerName = "Hiro";
data.AvatarPosition = new Vector2(360, 360);
data.Level = 11;
data.Score = 4200;

// Open a storage container.
IAsyncResult result =
    device.BeginOpenContainer("StorageDemo", null, null);

// Wait for the WaitHandle to become signaled.
result.AsyncWaitHandle.WaitOne();

StorageContainer container = device.EndOpenContainer(result);

// Close the wait handle.
result.AsyncWaitHandle.Close();

string filename = "savegame.sav";

// Check to see whether the save exists.
if (container.FileExists(filename))
    // Delete it so that we can create one fresh.
    container.DeleteFile(filename);

// Create the file.
Stream stream = container.CreateFile(filename);

// Convert the object to XML data and put it in the stream.
XmlSerializer serializer = new XmlSerializer(typeof(SaveGameData));
serializer.Serialize(stream, data);

// Close the file.
stream.Close();

// Dispose the container, to commit changes.
container.Dispose(); 
```

# sql - 在 Azure SQL 数据库中执行任意 SQL 命令并返回 XML？

> ID：11022102
> 
> 赞同：1
> 
> 时间：2012-06-13T19:35:37.813
> 
> 标签：sql, xml, azure-sql-database, sql-server-2012

我正在研究是否可以*在 Azure SQL Database*中执行任意 SQL 命令（动态 SQL 语句或存储过程）并将结果作为 XML 返回。

我知道它可以使用常规的本地 SQL Server 数据库来完成——在我们的例子中，我们使用 CLR 函数。替代“常规”解决方案包括使用 OPENROWSET 或 OPENQUERY，这两种方法都不适用于 Azure。

自 SQL Server 2012 起提供了一个新的[EXECUTE ... AS FOR XML](http://msdn.microsoft.com/en-us/library/ms188332.aspx)选项，但是当我尝试它时，我得到一个错误 - 我无法找到正确的使用示例。

```
exec ('select ''A'', 2, ''d''')
with result sets (as for xml) 
```

返回

> 消息 11537，级别 16，状态 1，第 1 行 EXECUTE 语句失败，因为其 WITH RESULT SETS 子句为结果集编号 1 指定了 1 列，但该语句在运行时发送了 3 列。

要明确明确；我无法控制正在传递的命令——它很可能是一个存储过程，并且很可能返回一个“常规”（即非 xml）结果集。用例是一组 SQL 测试，而不是实际的生产代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T19:49:54.687

我从客户咨询团队的微软高级项目经理史蒂夫霍华德那里找到了一个权威的答案：

> AS FOR XML 不会将来自已执行语句或存储过程的非 XML 表格结果转换为 XML。AS FOR XML 指定EXECUTE 语句调用的语句或存储过程*的 XML 结果*将被转换为好像它们是由 SELECT ... FOR XML ... 语句生成的格式。原始语句中类型指令的所有格式都将被删除，返回的结果就像没有指定类型指令一样。

但他也为我提供了这个替代方案：

```
/*
       Demo of how to display results from a stored procedure in XML
       Author: Steve Howard
       Date: June 21, 2012
       Intended as a demo only. Adapt to your purposes

*/

-- for this demo, declare a variable @tsql_batch to hold the batch to be executed
-- note that this could become a parameter in a stored procedure if this is how this is used

declare @tsql_batch  nvarchar(4000)

-- set the variable for the demo only
-- you will need to set this in your testing

set @tsql_batch = N'exec forDemo'

-- declare a table to hold the results of sp_describe_first_result_set
-- note that this can also be used for multiple result sets. See the documentation
-- at: http://technet.microsoft.com/en-us/library/ff878602(v=sql.110).aspx
declare @resultDescription table
(
       is_hidden                                       bit                        null
,      column_ordinal                                  int                        not null primary key
,      name                                            sysname                    not null
,      is_nullable                                     bit                        null
,      system_type_id                                  int                        null
,      system_type_name                         nvarchar(256) null
,      max_length                                      smallint             null
,      precision                                       tinyint                    null
,      scale                                           tinyint                    null
,      collation_name                                  sysname                    null
,      user_type_id                             int                        null
,      user_type_database                       sysname                    null
,      user_type_schema                         sysname                    null
,      user_type_name                                  sysname                    null
,      assembly_qualified_type_name      nvarchar(4000)       null
,      xml_collection_id                        int                        null
,      xml_collection_database                  sysname                    null
,      xml_collection_schema                    sysname                    null
,      xml_collection_name                      sysname                    null
,      is_xml_document                                 bit                        null
,      is_case_sensitive                        bit                        null
,      is_fixed_length_clr_type          bit                        null
,      source_server                            sysname                    null
,      source_database                                 sysname                    null
,      source_schema                            sysname                    null
,      source_table                             sysname                    null
,      source_column                            sysname                    null
,      is_identity_column                       bit                        null
,      is_part_of_unique_key                    bit                        null
,      is_updateable                            bit                        null
,      is_computed_column                       bit                        null
,      is_sparse_column_set              bit                        null
,      ordinal_in_order_by_list          smallint             null
,      order_by_list_length              smallint             null
,      order_by_is_descending                   smallint             null
,      tds_type_id                                     int                        null
,      tds_length                                      int                        null
,      tcs_collation_id                         int                        null
,      tds_collation_sort_id                    tinyint                    null
)

-- populate the table variable
insert into @resultDescription
       exec sp_describe_first_result_set @tsql_batch

-- declare the cursor to create the "create table statement:
declare crs cursor for SELECT '[' + name + '] ' + system_type_name + ' ' + case is_nullable when 0 then 'not null ' else 'null ' end + '
' FROM @resultDescription order by column_ordinal asc

-- variables to hold the statement to be executes as well as the current value from the cursor
declare @exec NVARCHAR(4000)
declare @curVal      nvarchar(1000)
open crs
fetch next from crs into @curval
-- begin building the dynamic SQL statement to be executed
set @exec = 'DECLARE @temp TABLE 
(
' + @curval

fetch next from crs into @curval

while @@FETCH_STATUS = 0
begin
       set @exec = @exec + ', ' + @curVal
       fetch next from crs into @curVal
end
close crs
deallocate crs
set @exec = @exec + '
)

INSERT INTO @temp
       exec sp_executesql N''' + @tsql_batch + '''

SELECT * FROM @temp FOR XML AUTO

' 

-- get the results
exec (@exec)

-- of you want to just see the statement that was executed:

print @exec 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T20:55:04.427

基于使用“FOR XML AUTO TYPE”对 SQL Azure 表进行的快速测试，确实返回了 XML 格式的结果，所以我相信您肯定可以得到 XML 格式的结果，但并非每个查询都可以返回为 XML，这是需要考虑的事情。

获得完全/正确格式的 XML 有点困难，因此您可能想看看这些[文章](http://msdn.microsoft.com/en-us/library/ms190025.aspx)[和](http://msdn.microsoft.com/en-us/library/ms178107.aspx)这篇文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T01:08:43.683

要输出简单的（即无类型的 XML），您可以使用如下所示的“for XML”子句。

不支持键入的 XML 和 XML 索引。Windows Azure SQL 数据库支持 XML 数据类型。

![在此处输入图像描述](../Images/c1b3717989b0ae91e7a25a1c06d07f83.png)

我在 SQL Azure 中用这个例子测试了你的场景，它工作得很好：

```
--Create the procedure
CREATE PROC SalesLT.ProductList @ProdName nvarchar(50)
AS
-- First result set
SELECT ProductID, Name, ListPrice
    FROM SalesLT.Product
    WHERE Name LIKE @ProdName
    FOR XML AUTO;
-- Second result set 
SELECT Name, COUNT(S.ProductID) AS NumberOfOrders
    FROM SalesLT.Product AS P
    JOIN SalesLT.SalesOrderDetail AS S
        ON P.ProductID  = S.ProductID 
    WHERE Name LIKE @ProdName
    GROUP BY Name
    FOR XML AUTO;
GO

-- Execute the procedure 
EXEC SalesLT.ProductList '%tire%' 
```

# ios - OpenGL 纹理渲染质量非常低

> ID：11022105
> 
> 赞同：2
> 
> 时间：2012-06-13T19:35:42.893
> 
> 标签：ios, opengl-es, textures

由于 Core Graphics 的性能瓶颈，我尝试在 iOS 上使用 OpenGL EL 来绘制 2D 场景，但 OpenGL 以极低的分辨率渲染我的图像。

这是我正在使用的图像的一部分（在 Xcode 中）：

![在此处输入图像描述](../Images/cb619d838530e76e5c57fdeb87467041.png)

以及 OpenGL 的纹理渲染（在模拟器中）：

![在此处输入图像描述](../Images/e03e0091f7463eeee2085f9800b84ccb.png)

我正在使用 Apple 的 Texture2D 从 PNG 创建纹理，然后将其绘制到屏幕上。按照 Apress 的“开始 iPhone 开发”一书中的建议，我正在使用 Ortho 投影直视场景。该图像恰好是屏幕的确切尺寸并且是这样绘制的（我没有在上面的屏幕截图中拍摄完整图像）。我没有在模型上使用任何变换，所以绘制图像应该不会导致子像素渲染。

我很高兴发布代码示例，但如果没有简单的解释，我想我会开始。

为什么使用这种方法图像会损失这么多质量？我在我的环境设置中错过了一步吗？我简要阅读了纹理在 2 的幂次方时表现更好的信息——这对 iPhone 有影响吗？我还阅读了有关多重采样的信息，但我不确定这是否相关。

编辑：更新屏幕截图以减轻混乱。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T10:04:29.163

我仍然不完全理解为什么我的代码会出现质量问题，但我设法解决了这个问题。我最初使用的是 Apress 书籍“开始 iPhone 4 开发”的制造商提供的 OpenGLES2DView 类，我怀疑问题出在这段代码的某个地方。然后我遇到了[这个教程](http://www.raywenderlich.com/9743/how-to-create-a-simple-2d-iphone-game-with-opengl-es-2-0-and-glkit-part-1)，它建议我改用 GLKit。GLKit 让我可以做我想做的事！

一些经验教训：

1.  使用上面链接的教程中的 GLKit 和 sprites 类，我的纹理不需要是 2 的幂。GLKit 似乎处理得很好。

2.  多重采样不是解决问题的方法。使用 GLKit，在渲染 2D 图形时，使用多重采样似乎没有效果（在我看来）。

感谢所有试图提供帮助的人。

# android - 在 Android 中获取最大 OpenGL ES 2.0 纹理大小限制

> ID：11022109
> 
> 赞同：9
> 
> 时间：2012-06-13T19:36:07.760
> 
> 标签：android, opengl-es, textures

我正在尝试在 Android 中为 OpenGL 2.0 获取最大纹理大小限制。但是我发现下一条指令只有在我当前在 OpenGL 上下文中时才有效，换句话说，我必须有一个 GL Surface 和一个 GL Renderer 等，这是我不想要的。

```
int[] maxTextureSize = new int[1];
GLES20.glGetIntegerv(GLES20.GL_MAX_TEXTURE_SIZE, maxTextureSize, 0); 
```

所以我提出了下一个算法，它给了我最大的纹理大小，而无需创建任何表面或渲染器。它工作正常，所以我的问题是这是否适用于所有 Android 设备，以及是否有人能发现任何错误，以防万一。

```
public int getMaximumTextureSize()
{
    EGL10 egl = (EGL10)EGLContext.getEGL();
    EGLDisplay display = egl.eglGetDisplay(EGL10.EGL_DEFAULT_DISPLAY);

    // Initialise
    int[] version = new int[2];
    egl.eglInitialize(display, version);

    // Query total number of configurations
    int[] totalConfigurations = new int[1];
    egl.eglGetConfigs(display, null, 0, totalConfigurations);

    // Query actual list configurations
    EGLConfig[] configurationsList = new EGLConfig[totalConfigurations[0]];
    egl.eglGetConfigs(display, configurationsList, totalConfigurations[0], totalConfigurations);

    int[] textureSize = new int[1];
    int maximumTextureSize = 0;

    // Iterate through all the configurations to located the maximum texture size
    for (int i = 0; i < totalConfigurations[0]; i++)
    {
        // Only need to check for width since opengl textures are always squared
        egl.eglGetConfigAttrib(display, configurationsList[i], EGL10.EGL_MAX_PBUFFER_WIDTH, textureSize);

        // Keep track of the maximum texture size
        if (maximumTextureSize < textureSize[0])
        {
            maximumTextureSize = textureSize[0];
        }

        Log.i("GLHelper", Integer.toString(textureSize[0]));
    }

    // Release
    egl.eglTerminate(display);
    Log.i("GLHelper", "Maximum GL texture size: " + Integer.toString(maximumTextureSize));

    return maximumTextureSize;

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T18:02:29.060

不幸的是，PBUFFER 最大尺寸与最大纹理尺寸无关（但可能相同）。

我相信获得最大纹理大小的最佳方法是创建 GL 上下文（在与您实际使用此纹理的上下文相同的上下文中）并请求 GL_MAX_TEXTURE_SIZE。

这背后有一个强有力的理由：在表面（和上下文）创建之前，ogl 驱动程序没有为当前进程初始化。一些驱动程序在初始化时执行底层硬件/SKU 检测，并根据硬件功能计算最大表面尺寸。

此外，最大纹理大小允许根据上下文（并且创建 EGLConfig 上下文）而变化。

还有一件事：eglGetConfigs 将为您提供所有 EGLconfigs，即使这些来自默认、软件 android 渲染器或来自 OpenGL ES 1.1CM 硬件驱动程序的这些（如果目标平台上有 1.1 和 2.0 的单独驱动程序）。驱动程序在图形堆栈中是独立的，可以返回不同的 max-es。

# c# - 尝试连接到 Oracle 数据库时出现“ORA-01012”错误消息

> ID：11022111
> 
> 赞同：5
> 
> 时间：2012-06-13T19:36:13.277
> 
> 标签：c#, oracle10g, odp.net

使用 C# 和 Oracle Data Provider for .NET (ODP) 我对数据库进行了长时间查询，然后使用 TOAD 在服务器端结束连接。之后，对数据库的后续调用，甚至创建一个新的 OracleConnection 对象，都会抛出以下错误：

```
ORA-01012: not logged on
Process ID: xxx
Session ID: yyy Serial number: zzz 
```

其中 Process ID 和 Session ID 是我用来结束连接的标识符。

似乎当我在服务器端结束与 Oracle 数据库的连接时，断开的连接将返回到连接池。并且当 C# 客户端代码（使用 ODP）打开新连接时，可能会检索返回到连接池的断开连接。

关于如何解决这种行为的任何想法？

顺便说一句，我正在使用 Oracle 客户端 10

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T17:33:11.587

我通过将连接字符串中的“验证连接”属性设置为真解决了我的问题。

[你可以在这里](http://docs.oracle.com/html/B14164_01/featConnecting.htm#i1006393)阅读更多

作为警告，我引用了 Oracle 文档。

> Validate Connection 属性验证来自池的连接。仅在绝对必要时才应使用此属性，因为它会导致服务器往返数据库以在将每个连接提供给应用程序之前对其进行验证。如果无效连接不常见，开发人员可以创建自己的事件处理程序来检索新连接，而不是使用验证连接。这通常提供更好的性能。

# objective-c - 不使用@autoreleasepool 不会发生内存泄漏

> ID：11022113
> 
> 赞同：0
> 
> 时间：2012-06-13T19:36:21.347
> 
> 标签：objective-c

我在 ARC 下并试图使用 @autoreleasepool，但我怀疑它没用，最好说即使我不使用 @autoreleasepool 我也没有内存泄漏，就像在这段代码中一样：

```
#import <Foundation/Foundation.h>
#import <Cocoa/Cocoa.h>

int main (int argc, const char * argv[])
{
    NSMutableArray* array = [ [NSMutableArray alloc] init];
    NSDate* date= [[NSDate alloc]init];
    [array addObject: date];
    return 0;
} 
```

我不使用@autoreleasepool，但是如果我尝试去product->profile->leaks 并运行测试以查看是否存在内存泄漏，它说一切正常并且没有检测到泄漏。有人可以解释一下吗这是什么原因？

PS：我使用 xcode 4.3.3 。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T19:47:07.163

这些对象都不需要自动释放池。创建它们`alloc`意味着它们在 .*`release`末尾由 ARC 发送处理，`main`即使它存在，它们也不会被放入池中。没有泄漏报告，因为没有泄漏。

如果您使用`[NSDate date]`而不是`alloc`.

* * *

~~*实际上，如果 ARC 甚至没有打扰我也不会感到惊讶，因为所有内存都将在`main`结束时回收并且您的程序终止。~~

# asp.net - Itextsharp：导入页面时有没有办法复制链接？

> ID：11022117
> 
> 赞同：3
> 
> 时间：2012-06-13T19:36:55.717
> 
> 标签：asp.net, c#-4.0, itextsharp, hyperlink

我正在做一个项目，我需要在显示之前编辑 pdf

我需要

*   添加水印
*   编辑权限（锁定以避免“复制/粘贴”和“另存为”）
*   编辑查看器首选项

我做到了......并且工作正常，除了一件事，原始文件中的链接在新文件中不起作用......知道吗？

注意：实际上，这是我的代码（我使用的是 itextsharp）

```
 private void loadPdf()
    {
        if (Request.QueryString.HasKeys())
        {
            if (Request.QueryString.GetKey(0) == "thepath" && Request.QueryString.GetKey(1) == "isprintable" && Request.QueryString.GetKey(2) == "type")
            {
                #region kuak
                Document doc = new Document();
                PdfReader pdfReader = new PdfReader(Request.QueryString["thepath"]);
                using (MemoryStream memoryStream = new MemoryStream())
                {
                    PdfWriter pdfWriter = PdfWriter.GetInstance(doc, memoryStream);
                    pdfWriter.ViewerPreferences = PdfWriter.PageModeUseOutlines;
                    //pdfWriter.ViewerPreferences = PdfWriter.PageLayoutTwoColumnLeft;  /// Despliega el docuemnto en pares de hojas
                    pdfWriter.ViewerPreferences = PdfWriter.PageLayoutOneColumn;
                    pdfWriter.ViewerPreferences = PdfWriter.HideToolbar;
                    //pdfWriter.ViewerPreferences = PdfWriter.HideWindowUI; /// quita los scrollbars y el panel de la derecha qur contiene los bookmarks y las buskedas dentro del pdf
                    if (Request.QueryString["isprintable"] == "n")
                    {
                        pdfWriter.ViewerPreferences = PdfWriter.HideMenubar;
                        System.Text.UTF8Encoding encoding = new System.Text.UTF8Encoding();
                        pdfWriter.SetEncryption(null, encoding.GetBytes("mYpAssss"), 0, PdfWriter.STRENGTH40BITS);
                    }
                    doc.Open();
                    PdfContentByte pdfContentByte = pdfWriter.DirectContent;
                    doc.AddDocListener(pdfWriter);
                    for (int page = 1; page <= pdfReader.NumberOfPages; page++)
                    {
                        //doc.SetPageSize(pdfReader.GetPageSize(page));
                        doc.SetPageSize(pdfReader.GetPageSizeWithRotation(page));
                        doc.NewPage();
                        PdfImportedPage pdfImportedPage = pdfWriter.GetImportedPage(pdfReader, page);
                        int rot = pdfReader.GetPageRotation(page);
                        if (rot == 90 || rot == 270)
                            pdfContentByte.AddTemplate(pdfImportedPage, 0, -1.0F, 1.0F, 0, 0, pdfReader.GetPageSizeWithRotation(page).Height);
                        else
                            pdfContentByte.AddTemplate(pdfImportedPage, 1.0F, 0, 0, 1.0F, 0, 0);
                        string theId = findId();
                        if (isWatermarkNeeded(theId))
                        {
                            #region ADD TEXT WATERMARK
                            //pdfContentByte.BeginText();
                            //iTextSharp.text.Rectangle pageSize = pdfReader.GetPageSizeWithRotation(page);
                            //BaseFont baseFont = BaseFont.CreateFont(BaseFont.HELVETICA_BOLD, System.Text.Encoding.ASCII.EncodingName, false);
                            //pdfContentByte.SetFontAndSize(baseFont, 200);
                            //BaseColor baseColor = new BaseColor(255, 0, 0, 20);
                            //pdfContentByte.SetColorFill(baseColor);
                            //float textAngle = (float)GetHypotenuseAngleInDegreesFrom(pageSize.Height, pageSize.Width);
                            //pdfContentByte.ShowTextAligned(PdfContentByte.ALIGN_CENTER, "DRAFT", 350, pageSize.Height / 2, textAngle);
                            //pdfContentByte.EndText();
                            #endregion
                            #region ADD IMAGE WATERMARK

                            string fechaExp = "Este documento vence: " + GetExpirationDate(theId).ToShortDateString();
                            pdfContentByte.BeginText();
                            //iTextSharp.text.Image img = iTextSharp.text.Image.GetInstance(Server.MapPath("~/images/watermark3.png"));
                            iTextSharp.text.Image img = iTextSharp.text.Image.GetInstance(ImageCheck.CreatePicture(@"C:\Users\myUser\Desktop\watermark.png", fechaExp).ToArray());
                            img.SetAbsolutePosition(0, 0);
                            pdfContentByte.AddImage(img);
                            pdfContentByte.EndText();
                            #endregion
                        }

                    }
                    pdfReader.Close();
                    doc.Close();
                    byte[] content = memoryStream.ToArray();
                    Response.ContentType = "application/pdf";
                    Response.AddHeader("content-length", content.Length.ToString());
                    Response.BinaryWrite(content);
                }
                #endregion
            }
            else
            {
                //hay querystring pro no corresponden con los que se necesita
            }
        }
        else
        {
            //no se enviaron los querystring
        }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-11T10:15:21.730

您必须从原始 PDF 中获取链接

```
var links = reader.GetLinks(pageNumber); 
```

并将它们写入新的 PDF

```
 foreach (var link in links)
                    {
                        var annotation = link.CreateAnnotation(pdfWriter);
                        writer.AddAnnotation(annotation);
                    } 
```

# javascript - 对象的事件处理方法

> ID：11022118
> 
> 赞同：0
> 
> 时间：2012-06-13T19:36:59.010
> 
> 标签：javascript, jquery, javascript-events

我对变量范围有疑问。我正在设置事件侦听器（onclick），但处理程序是对象的方法，我需要在处理程序方法中引用该对象。

例子：

```
var FOO = function () {
 this.clicked = false
};

FOO.prototype.handler = function(e)
{
 this.clicked = true;
}

FOO.prototype.setListeners = function()
{
 $("#but").click(this.handler);
}

var oop = new FOO();
oop.setListeners(); 
```

示例工作到`this.clicked = true;`因为`this`没有引用`oop`.

如何将对象的引用传递给处理函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:49:12.020

```
FOO.prototype.setListeners = function()
{
    var that = this;
    $("#but").click(function(){that.handler();});
} 
```

# ruby-on-rails - 在 Rails 中使用 Curb 进行流式传输

> ID：11022121
> 
> 赞同：0
> 
> 时间：2012-06-13T19:37:10.307
> 
> 标签：ruby-on-rails, stream, curb

`curb`在 Rails 中使用流式 API 管理和处理是否可行？我以前曾将它用于一次性请求，但还没有看到任何在流式传输情况下使用它的示例。如果可能的话 - 关于代码看起来像什么让这个滚动的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:44:14.103

不确定，如果遏制是答案，但您可以使用 EventMachine 来使用流式 API，请参见示例[http://adam.heroku.com/past/2010/3/19/sumption_the_twitter_streaming_api/](http://adam.heroku.com/past/2010/3/19/consuming_the_twitter_streaming_api/)

# android - Android：如何在文本视图焦点上显示下拉选项？

> ID：11022124
> 
> 赞同：2
> 
> 时间：2012-06-13T19:37:23.937
> 
> 标签：android, user-interface, android-widget

我想在股票 Android 短信应用程序中实现类似于“收件人：”功能的东西。当焦点位于文本字段上时，其正下方会显示 3 个按钮（最近、联系人和组）。

我一直在试图找出什么样的小部件可以做到这一点。我能想到的最接近的是显示一个带有 3 个按钮的弹出对话框，但这不一样。我也考虑过一个下拉框，但这也不一样。

感谢您的任何建议。

编辑：安卓 2.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:34:26.423

有一个类似这样的布局：一个编辑文本和三个按钮：（注意水平布局定义为消失，这意味着它不会显示。

```
<EditText
    android:id="@+id/editText1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"</EditText>

<LinearLayout
    android:id="@+id/horizontal_layout"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" 
    android:id="@+id/horizontal_layout"
    android:visibility="gone">

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

    <Button
        android:id="@+id/button3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

</LinearLayout> 
```

现在在活动上有这样的东西：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.test);

    EditText edit = (EditText) findViewById(R.id.teste_editText1);
    final LinearLayout layout = (LinearLayout)findViewById(R.id.horizontal_layout);

    edit.setOnFocusChangeListener(new OnFocusChangeListener() {

        public void onFocusChange(View paramView, boolean paramBoolean) {
            if (paramBoolean) {//if is focused
                layout.setVisibility(View.VISIBLE);
            } else {
                layout.setVisibility(View.GONE);                    
            }
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:47:39.460

Android MMS 应用程序（AOSP 附带的那个）中使用的实际小部件是一个`MultiAutoCompleteTextView`（[文档链接](http://developer.android.com/reference/android/widget/MultiAutoCompleteTextView.html)），用于显示基于输入的建议。 [这是](https://github.com/android/platform_packages_apps_mms/blob/froyo-release/src/com/android/mms/ui/RecipientsEditor.java)他们在 Froyo 应用程序中使用的子类的源链接。

当然，如果你指的是特定设备上的应用程序，它可能不是应用程序的开源版本，但这仍然是 SDK 中的小部件，它提供了一个基于键入的建议的弹出列表。

高温高压

# meteor - 渲染流星模板后运行 JS

> ID：11022131
> 
> 赞同：9
> 
> 时间：2012-06-13T19:38:10.280
> 
> 标签：meteor

我有一个看起来像这样的模板：

```
<template name="foo">
  <textarea name="text">{{contents}}</textarea>
</template> 
```

我用以下方式渲染它：

```
Template.foo = function() {
  return Foos.find();
} 
```

我有一些事件处理程序：

```
Template.foo.events = {
  'blur textarea': blurHandler
} 
```

我想要做的是根据其内容的大小设置`rows`属性。`textarea`我意识到我可以编写一个 Handlebars 助手，但它无法访问正在呈现的 DOM 元素，这将迫使我做一些不必要的重复。理想情况下，我想要的是让流星在渲染元素后触发事件。就像是：

```
Template.foo.events = {
  'render textarea': sizeTextarea
} 
```

这可能吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-05T16:44:58.523

从 Meteor 0.4.0 开始，可以检查模板是否已完成渲染，请参阅[http://docs.meteor.com/#template_rendered](http://docs.meteor.com/#template_rendered)

如果我正确理解您的问题，您应该将您的 textarea 调整大小代码包含在 Template.foo.onRendered 函数中：

```
Template.foo.onRendered(function () {
  this.attach_textarea();
}) 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-14T00:09:50.863

我认为当前的“最佳”方法（这有点像 hack）是[在 Meteor.js 中更新 DOM 之后](https://stackoverflow.com/questions/10109788/callback-after-the-dom-was-updated-in-meteor-js)`Meteor.defer`使用ala Callback 。

杰夫是流星的开发者之一，所以他的话就是福音：）

因此，在您的情况下，您可以执行以下操作：

```
 <textarea id="{{attach_textarea}}">....</textarea> 
```

和

```
 Template.foo.attach_textarea = function() {
   if (!this.uuid) this.uuid = Meteor.uuid();

   Meteor.defer(function() {
     $('#' + this.uuid).whatever();
   });

   return this.uuid;
 } 
```

**编辑**

请注意，作为 0.4.0，您可以以非常特别的方式执行此操作（如 Sander 所指出的）：

```
Template.foo.rendered = function() {
  $(this.find('textarea')).whatever();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-27T23:28:23.420

自 2014 年 6 月左右以来，正确的做法是使用 [Template.myTemplate.onRendered()](http://docs.meteor.com/#/full/template_onRendered)设置回调。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T23:39:45.790

是的，我想是的-不确定这是否是“正确的方式”，但这对我有用：

在您的应用程序 JS 中，客户端部分将在客户端上运行任何 javascript。例如：

```
if (Meteor.is_client) {
    $(function() {
        $('textarea').attr('rows' , 12) // or whatever you need to do
    })
    ... 
```

请注意这里的示例使用 JQuery，在这种情况下，您需要将其提供给客户端（我认为 :-)。就我而言：

我创建了一个 /client 目录，并在其下添加了 jquery.js 文件。

希望这可以帮助。

# php - 正则表达式维护字符a-zA-Z0-9$!.,

> ID：11022137
> 
> 赞同：1
> 
> 时间：2012-06-13T19:38:43.057
> 
> 标签：php, regex

我可以知道如何在 php 中使用正则表达式仅批准字母 az、AZ 和数字 0-9 和特殊字符 $!. 吗？

```
preg_match("/^[a-zA-Z0-9$!\.\,]{1,100}$/", $name); 
```

这里出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T19:41:20.437

从我的头顶上掉下来

```
if (preg_match('/^[^a-z\d\$!\.,]$/i', $string)){
     // fail
} 
```

# javascript - 中止页面上的时钟脚本执行

> ID：11022138
> 
> 赞同：-1
> 
> 时间：2012-06-13T19:38:49.343
> 
> 标签：javascript

我有一个特别的问题。有一个带有时钟的页面，我需要阻止它们。我尝试过类似`throw new Error()`或无限/递归循环的方法，但没有帮助。这不是我的网站或脚本，所以我无法更改任何内容，有什么方法可以阻止它们从 firebug/chrome 控制台访问？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:16:15.767

这将停止其组件包含在 DOM 中的任何时钟：

```
document.removeChild(document.documentElement); 
```

这可能在大多数情况下都有效，但时钟脚本可能会在每次迭代时清除并重绘文档元素上的时钟。如果是这样，这是我能想到的最有效的选择：

```
window.close(); 
```

对于您的目的来说，这些可能有点矫枉过正，但除非您包含有关时钟的更多详细信息或提供演示链接，否则我真的无法告诉您更具体的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T08:18:34.407

好吧，实际上禁用 JavaScript 做了我需要的，而无需删除/重新加载页面。

# parameters - 函数参数导致 GMP 中的分段错误

> ID：11022139
> 
> 赞同：0
> 
> 时间：2012-06-13T19:38:53.330
> 
> 标签：parameters, segmentation-fault, gmp

我正在尝试更改函数 extended_gcd 中 mpz_t 类型的 d 的值，然后将其传递回我的主函数，当我执行程序时出现分段错误。

```
 int extended_gcd(mpz_t c, mpz_t a, mpz_t b)
    {

      mpz_t x, lastx, y, lasty, temp, quotient, temp2;

      mpz_init(temp); 
      mpz_init(temp2); 
      mpz_init(a);
      mpz_init(b);
      mpz_init(c);
      mpz_init(quotient); 
      mpz_init_set_ui(x,0); 
      mpz_init_set_ui(lastx,1);
      mpz_init_set_ui(lasty,0);
      mpz_init_set_ui(y,1);

while(!(mpz_cmp(b, 0)==0))
{
    mpz_set(temp, b);
    mpz_cdiv_q(quotient, a, b);
    mpz_mod(b, a, b);
mpz_set(a, temp);
    mpz_set(temp, x);
mpz_mul(temp2, quotient, x);
mpz_sub(x, lastx, temp2);
    mpz_set(lastx, temp);
    mpz_set(temp, y);
    mpz_mul(temp2, quotient, y);
mpz_sub(y, lasty, temp2);
    mpz_set(lasty, temp);                 
}

mpz_set(c, lastx);        
mpz_clear(x);
mpz_clear(y);
mpz_clear(lastx);
mpz_clear(lasty);
mpz_clear(temp);
mpz_clear(temp2);
mpz_clear(quotient);
 return 0; 
```

}

这是我主要的代码：

```
 extended_gcd(d,e,phi);  
    printf("d=");
    mpz_out_str(stdout, 10, d);
    printf("\n"); 
```

知道可能出了什么问题，我该如何解决？感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T06:26:47.380

我看到一个问题：您不应该在extended_gcd() 的参数上调用mpz_init()。您应该只对在extended_gcd() 中声明的mpz_t 变量调用mpz_init()/mpz_clear()。

# php - 每个循环的php不起作用

> ID：11022140
> 
> 赞同：1
> 
> 时间：2012-06-13T19:38:57.900
> 
> 标签：php, mysql

我正在尝试清理可能缺少书名或生物信息的数据库表。用户应该能够单击一个按钮，而程序会完成其余的工作。我已经在我的数据库中运行了查询，它返回了我正在寻找的信息，所以我认为我的问题在于 for each 循环。这是我的代码：

```
<?php
    require_once ('../db.php');
    require_once ('../amazon/amazon.php');
    $conn = db_connect();
    session_start();
    $x = 0;

    // find all of the books with no Titles or Bios
    $result = $conn->query("
        select 
            i.date_created, 
            users.username, 
            i.sku,
            i.isbn13,
            i.quantity, 
            source.source,
            i.date_process, 
            location.location 
        from inventory i
            left join book on i.isbn13 = book.isbn13
            left join source on i.source_id = source.source_id
            left join location on i.location_id = location.location_id
            left join users on i.created_by = users.user_id
        where sku > '10000000' 
            and quantity >= 1 
            and (book.title = ''  
                 or book.title is null  
                 or book.author = '' 
                 or book.author is null) 
            and i.isbn13 >1");

    $num_rows = $result->num_rows;

    if($num_rows > 0)
    { 
        while($row = $result->fetch_assoc()) {
            $isbnArray[$x] = $row['isbn13'];
            $qtyArray[$x] = $row['quantity'];
            $x++;
        } // end of while loop
    $sum = array_sum($qtyArray);
        for each ($isbnArray as $isbn)
        {
            //retrieve amazon data
            $parsed_xml = amazon_xml($isbn);
            $amazonResult = array();

            $current = $parsed_xml->Items->Item;

            if($parsed_xml->Items->Request->IsValid == 'True') {
                $amazonResult = array(
                    'Title' => $current->ItemAttributes->Title,
                    'Author' => $current->ItemAttributes->Author,
                    'Edition' => $current->ItemAttributes->Edition,
                    'Weight' => ($current->ItemAttributes->PackageDimensions->Weight / 100),
                    'Publisher' => $current->ItemAttributes->Publisher,
                    'PublishDate' => $current->ItemAttributes->PublicationDate,
                    'Binding' => $current->ItemAttributes->Binding,
                    'SalesRank' => $current->SalesRank,
                    'ListPrice' => str_replace('$','',$current->ItemAttributes->ListPrice->FormattedPrice),
                    'ImageURL' => $current->LargeImage->URL,
                    'DetailURL' => $current->DetailPageURL      
                );
        } // end of if statement

        //update Title and Bio info in book table
        $conn->query("
            update book 
            set isbn13 = '$isbn', 
                author = '" . $amazonResult['Author'] . "', 
                title ='" . $amazonResult['Title'] . "',
                edition =  '" . $amazonResult['Edition'] . "', 
                weight = '" . $amazonResult['Weight'] . "', 
                publisher = '" . $amazonResult['Publisher'] . "',
                binding = '" . $amazonResult['Binding'] . "', 
                listed_price = '" . $amazonResult['ListPrice'] . "', 
                pub_date = '" . $amazonResult['PublishDate'] . "'
            WHERE isbn13 = '$isbn'");
        } // end of for each loop
    }

    $message = array( 'message' => $sum.' Records were updated' );
    $conn->close();

    echo json_encode($message);
?> 
```

对我来说，一切看起来都不错，但是当我在 firebug 上运行它时，没有任何消息。我的成功函数中的 Console.log(data) 显示空字符串。

我究竟做错了什么？我应该为每个循环重组我的吗？

编辑：我更改了部分代码以准确计算更新了多少记录。这是 $qtyArray[$x] = $row['quantity'] 行。我的console.log(data) 显示更新了2995 条记录，但#message 没有出现在屏幕上，只是console.log(data)。希望这能提供更多的见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:52:39.290

您的错误可能在于您的 while 循环：

```
while($row = $result->fetch_assoc()) {
        $isbnArray[$x] = $row['isbn13'];
        $sum = array_sum($isbnArray);
} // end of while loop 
```

$x 被初始化为 0，并且从未改变，所以你每次只覆盖数组中的相同条目。

你必须改变：

```
$isbnArray[$x] = $row['isbn13']; 
```

到：

```
$isbnArray[] = $row['isbn13']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:27:22.323

您需要在查询中转义您的 "

```
$result = $conn->query("
    select 
        i.date_created, 
        users.username, 
        i.sku,
        i.isbn13,
        i.quantity, 
        source.source,
        i.date_process, 
        location.location 
    from inventory i
        left join book on i.isbn13 = book.isbn13
        left join source on i.source_id = source.source_id
        left join location on i.location_id = location.location_id
        left join users on i.created_by = users.user_id
    where sku > '10000000' 
        and quantity >= 1 
        and (book.title = \"\"  
             or book.title is null  
             or book.author = \"\" 
             or book.author is null) 
        and i.isbn13 >1"); 
```

# scala - 存在类型的惯用替换

> ID：11022142
> 
> 赞同：8
> 
> 时间：2012-06-13T19:39:07.337
> 
> 标签：scala

我有一些使用存在类型的 Scala 代码，我正在升级到 2.10，我注意到一个关于添加“import language.existentials”的警告，这让我认为应该有更好的方法来编写它。我的代码归结为：

```
class A {
  private var values = Set.empty[(Class[_], String)]
  def add(klass: Class[_], id: String) {
    val key = (klass, id)
    if (!values(key)) {
      values += key
      // More logic below..
    }
  } 
```

我收到这个警告：

```
[warn] test.scala:4 inferred existential type (Class[_$2], String) forSome { type _$2 }, which cannot be expressed by wildcards, should be enabled
[warn] by making the implicit value language.existentials visible.
[warn] This can be achieved by adding the import clause 'import language.existentials'
[warn] or by setting the compiler option -language:existentials.
[warn] See the Scala docs for value scala.language.existentials for a discussion
[warn] why the feature should be explicitly enabled.
[warn]       val key = (klass, id) 
```

有没有一种方法可以重写我的代码而不生成此警告（或需要导入），或者这是表达它的最惯用的方式？我从不在代码中的任何地方询问 Class 的类型参数。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-13T22:19:15.390

警告是关于存在类型的推断，这通常是不可取的。添加 import 语句，或使其显式：

```
val key: (Class[_], String) = (klass, id) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T21:10:11.757

如果您为 add 方法提供类型参数，警告就会消失。这不会影响可以存储在 var 值中的内容。至于为什么，我没有一个很好的答案，但这是一种解决方法。希望有能力的人也能做出解释。

```
 class A {
    private var values = Set.empty[(Class[_], String)]

    def add[T](klass: Class[T], id: String) {
      val key = (klass, id)
      if (!values(key)) {
        values += key
        // More logic below..
      }
    }
  } 
```

# asp.net - 如何将字符串添加到仅属于一种语言的 ASP.NET 全局资源？

> ID：11022143
> 
> 赞同：1
> 
> 时间：2012-06-13T19:39:10.910
> 
> 标签：asp.net, localization

我有不同语言的全球资源文件：

```
Resource.resx
Resource.de-DE.resx
Resource.ro-RO.resx 
```

在大多数情况下，其中的所有字符串`Resource.resx`也具有其他语言的本地化版本。

但是，我有某些字符串应该只存在于`Resource.de-DE.resx`而不是`Resource.resx`. 当我尝试在我的代码中使用它们时：

```
GetGlobalResourceObject("Resource", "Personal Identification Number") 
```

我收到一条错误消息，显示**无法解析资源项 'Personal Identification Number'**。当我用德语查看页面时，字符串仍然可以正确本地化，因为它存在于 中`Resource.de-DE.resx`，但因为它不在 中`Resource.resx`，所以我在 Visual Studio 中收到此错误，我想摆脱该错误。

如何解决此问题，以免收到此错误消息？我应该将本地特定的字符串移动到另一个资源文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T10:58:23.020

整个资源回退方法确实假设所有字符串都存在于基础语言中。

我想您会遇到这种情况，因为您实现了一些仅适用于德语的功能，并且您不想向基础语言添加不必要的资源，因为这会增加不需要它的语言的本地化工作。

一种解决方案是创建一个单独的本地资源文件。并且要么只将其翻译成德语（而不是其他语言），要么将其作为基础资源（没有`de-DE` 语言代码但仍然包含您的德语字符串）。

另一种解决方案（如果您无法创建本地资源文件并且由于某种原因只能使用全局资源）是将这些额外的条目添加到您的基本全局资源（`Resource.resx`）中，并明确表示您不希望这些被翻译。例如，将它们全部设为空白字符串并使用注释字段来说明这些字符串仅用于德语。不大好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T19:56:29.347

我刚刚复制了你的场景，它工作正常。只需创建另一个包含本地特定字符串的资源文件。希望这可以帮助 ：）

# c# - 和 Visual Studio 2010 的 Thread 窗口中的 [Thread Destroyed] 详细信息

> ID：11022147
> 
> 赞同：9
> 
> 时间：2012-06-13T19:39:22.323
> 
> 标签：c#, .net, multithreading, visual-studio-2010, callstack

我一直在尝试使用一个应用程序调试与线程相关的一些问题。当我附加到应用程序时，我看到一个像这样的窗口：

![在此处输入图像描述](../Images/cf83b274487d678ab8d8c04eb9f283f0.png)

这个名为“[Thread Destroyed]”的线程是什么？应用程序代码肯定不会写这个名字。

什么意味着线程的调用堆栈不可用。“采集引擎”线程在应用程序内部创建并在循环中运行直到停止。如果线程停止，它将退出循环并结束其生命，因此它应该在线程列表中。如果它在那里是因为它还没有退出循环，那么，再次，调用堆栈不可用是什么意思？

在此先感谢您的帮助，这似乎并不容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T09:39:40.583

[Thread Destroyed] 表示析构函数已被调用，线程不再存在。

# python - python/django 正则表达式和包含 '#' 符号的 unicode 字符串

> ID：11022151
> 
> 赞同：1
> 
> 时间：2012-06-13T19:39:27.243
> 
> 标签：python, django

我有这个模式：

```
url(r'^(?P<slug>.+)-prod(?P<product_id>[0-9]+).html$', 'product_detail', name='product_detail', ) 
```

当我有以下情况时它工作正常：

```
"some unicode characters"-prod"some numbers".html 
```

但是当我在“一些 unicode 字符”中输入“#”时，它不匹配。Python/django/re 将字符串截断为#的第一个字符

例如，如果我有：

```
"some unicode # string"-prod"some numbers".html 
```

django 将搜索匹配

```
"some unicode " 
```

有没有其他人有同样的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T19:47:44.647

`#`是一个特殊字符，因为它涉及 URL。你不应该在 URL 中使用它，除非它在字面上表示页面中的锚点。如果你坚持使用它，它应该是 urlencoded（即`%23`），你甚至*应该*能够让 Django 的 urlresolver 匹配 urlencoded 版本。

# view - 如何将主视图控制器上按下的 IBAction 的名称放在模态视图的 NSString 中？

> ID：11022154
> 
> 赞同：1
> 
> 时间：2012-06-13T19:39:47.237
> 
> 标签：view, nsstring, modal-dialog, ibaction

我的主视图上有大约 10 个 IBAction，它们转到同一个模态视图，我需要知道如何查看 IBActon 被按下以到达那里并将其放在模态视图上的 NSString 中。

这是将您发送到模态视图的代码。IBActions 的唯一区别是名称。比如playMovie:和playMovie2:等等。

```
-(IBAction)playMovie:(id)sender{
VideoSubViewController *subView = [[[VideoSubViewController alloc] init] autorelease];
[subView setModalTransitionStyle:UIModalTransitionStyleCrossDissolve];
[self presentModalViewController:subView animated:YES];} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T02:25:28.377

`init*`您可以在获取该信息的模式视图上创建一个。用法是：

```
VideoSubViewController *subView = 
  [[[VideoSubViewController alloc] initForAction:@"playMovie"] autorelease]; 
```

然后，您将该信息存储在视图实例中以便使用它。

# c# - 如何在同步处理程序中检查身份验证？

> ID：11022155
> 
> 赞同：0
> 
> 时间：2012-06-13T19:39:47.477
> 
> 标签：c#, asp.net, authentication

我编写了一个处理程序类，我想知道如何验证身份验证。我还写了一篇测试 XML 帖子，其中包含了一些网络凭据。使用 Handler 读取/验证这些网络凭据需要什么？

处理程序：

```
public class HelloWorldHandler : IHttpHandler {
public HelloWorldHandler() {}

    public void ProcessRequest(HttpContext context){

    HttpRequest request = context.Request;
    HttpResponse response = context.Response;

    var stream = context.Request.InputStream; 
    byte[] buffer = new byte[stream.Length]; 
    stream.Read(buffer, 0, buffer.Length); 
    string xml = Encoding.UTF8.GetString(buffer);
}

public bool IsReusable
{
    // To enable pooling, return true here.
    // This keeps the handler in memory.
    get { return false; }
} 
```

XML 帖子片段：

```
 HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);

        byte[] requestBytes = System.Text.Encoding.UTF8.GetBytes(xml);
        req.Method = "POST";
        req.ContentType = "text/xml;charset=utf-8";
        req.ContentLength = requestBytes.Length;
        req.Credentials = new NetworkCredential("Test", "Password");
        Stream requestStream = req.GetRequestStream();
        requestStream.Write(requestBytes, 0, requestBytes.Length); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T19:45:38.033

我认为`HttpContext`应该提供所有这些信息。就像是：

```
context.User.Identity.IsAuthenticated 
```

如果一切都配置好了，应该正确设置。

# java - 圆到圆的碰撞

> ID：11022156
> 
> 赞同：1
> 
> 时间：2012-06-13T19:39:51.367
> 
> 标签：java, graphics, collision-detection

我正在尝试编写一个 Java 程序来支持非晶格扩散有限聚合模拟。模拟移动粒子的基本代码已经到位，直到所述粒子撞击静态中心粒子。在这一点上，我试图确保移动的粒子只是接触（相切）静态粒子。但是，由于未知原因，它有时会失败（8 个粒子中的前 2 个相交，其他 6 个很好）。

这是代码：

```
 boolean killed, collide;
    double xp, yp, dx, dy, theta, xpp, ypp, length;

    int xc = 200;
    int yc = 200;
    int killRadius = 200;
    int releaseRadius = 150;
    int partRadius = 14;
    int partDiam = 2 * partRadius;

    drawCircle(xc, yc, killRadius); // kill
    drawCircle(xc, yc, releaseRadius); // release
    drawCircle(xc, yc, partRadius); // center particle

    //while (true) {
        killed = false;
        collide = false;

        theta = Math.random() * Math.PI * 2;
        xp = xc + releaseRadius * Math.cos(theta);
        yp = yc + releaseRadius * Math.sin(theta);

        while (true) {

            theta = Math.random() * Math.PI * 2;
            length = partDiam;

            xpp = xp;
            ypp = yp;

            xp = xp + length * Math.cos(theta);
            yp = yp + length * Math.sin(theta);

            //drawCircle((int) xp, (int) yp, partRadius);

            // Should it be killed ? (maybe could use a box to fasten
            // computations...
            // Would switching the test for kill w test for collision
            // improve perf ?
            dx = xp - xc;
            dy = yp - yc;
            if ((dx * dx) + (dy * dy) > killRadius * killRadius) {
                killed = true;
                break;
            }

            // Does it collide with center? replace by any particle...
            dx = xp - xc;
            dy = yp - yc;
            if ((dx * dx) + (dy * dy) < (partDiam) * (partDiam)) {
                collide = true;
                break;
            }
        }
// Probably something is wrong here...
        if (collide) {
            // no absolute value because particles move at most by diameter
            double depthPenetration = partDiam
                    - Math.sqrt((dx * dx) + (dy * dy));
            dx = xpp - xp;
            dy = ypp - yp;
            // shorten distance travelled by penetration length to ensure
            // that
            // particle is tangeant
            length = Math.sqrt((dx * dx) + (dy * dy)) - depthPenetration;
            xp = xpp + length * Math.cos(theta);
            yp = ypp + length * Math.sin(theta);
            drawCircle((int) xp, (int) yp, partRadius);
        }
    //} 
```

当然，我在询问之前检查了许多参考资料，但找不到代码有任何问题......不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T01:10:37.553

I made some simple refactorings through your code, just to get a feeling what it does, what is happening.

Let me mention one thing at start: It's the revival of the sphaghetti-monster, isn't it? Do you like global variables? Long, superpotent *let's do it all right now and here* methoods?

If you introduce variables as late as possible, the reader of your code needn't search upwards, what this variable has been been before - if something is overridden, for example, if there is a ungood reuse.

If your variables don't change: Make them final. That simplifies reasoning about them. `final int killRadius = 200;` means, that get the type information, together with the value, and hopefully shortly before first usage, and that it will never get changed. Configuration only in source code. Probably not a too complicated candidate. In contrast to double dx - not initialized, because it get's initialized inside the loop,

```
static void foo () {

    final int xc = 200;
    final int yc = 200;
    final int killRadius = 200;
    final int releaseRadius = 150;
    final int partRadius = 14;

    drawCircle (xc, yc, killRadius); // kill
    drawCircle (xc, yc, releaseRadius); // release
    drawCircle (xc, yc, partRadius); // center particle

    //while (true) {
    boolean killed = false;
    boolean collide = false;

    double theta = Math.random() * Math.PI * 2;     
    double xp = xc + releaseRadius * Math.cos (theta);
    double yp = yc + releaseRadius * Math.sin (theta);
    double dx, dy, xpp, ypp;

    while (true) {

        theta = Math.random () * Math.PI * 2;
        final int partDiam = 2 * partRadius;
        final double length = partDiam;

        xpp = xp;
        ypp = yp;

        xp += length * Math.cos (theta);
        yp += length * Math.sin (theta);

        dx = xp - xc;
        dy = yp - yc;
        if ((dx * dx) + (dy * dy) > killRadius * killRadius) {
            killed = true;
            break;
        }

        // Why again assign dx = xp -xc? Did any of these values change meanwhile? 
        // I don't think so.
        // dx = xp - xc;
        // dy = yp - yc;
        if ((dx * dx) + (dy * dy) < (partDiam) * (partDiam)) {
            collide = true;
            break;
        }
    }
    if (collide) {
        // no absolute value because particles move at most by diameter
        double depthPenetration = partDiam - Math.sqrt((dx * dx) + (dy * dy));
        dx = xpp - xp;
        dy = ypp - yp;
        // shorten distance travelled by penetration length to ensure
        // that
        // particle is tangeant
        final double length = Math.sqrt((dx * dx) + (dy * dy)) - depthPenetration;
        xp = xpp + length * Math.cos (theta);
        yp = ypp + length * Math.sin (theta);
        drawCircle ((int) xp, (int) yp, partRadius);
    } 
```

If you structure your code like this, you not only see, that some value like xc is 200 and never changed - in the head of the while loop you see that theta is not declared inside the loop, so either it is used later outside the loop, or it is sequentially modified inside the loop. To do an x += 4; you can't initialize x in ever loop passing.

In the end of the big while, you have two similar blocks:

```
 dx = xp - xc;
    dy = yp - yc;
    if ((dx * dx) + (dy * dy) (OP) a OP b) {
        c = true;
        break;
    } 
```

but xp, xc and dx aren't changed meanwhile - nor the y-equivalents. Is this a mistake, or why do you assign them again?

Then, you can get rid of your endless while this way: Since both conditions terminate the while, put the conditions into the while - test, and call the second block (without repeating the assignment) only if the first wasn't entered - keyword to do so is `else`:

```
 while (!killed && !collide) {

        // ...

        dx = xp - xc;
        dy = yp - yc;
        if ((dx * dx) + (dy * dy) > killRadius * killRadius) {
            killed = true;
        }
        else if ((dx * dx) + (dy * dy) < (partDiam) * (partDiam)) {
            collide = true;
        }
    } 
```

What does it help in finding the error? Not so much. If two circles are placed wrongly, and the rest fine, a screenshot would be fine, and values, which lead to bad circles, and values which are alright.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:21:55.197

我不认为我可以调试您的代码，但我在多年前（十多年前）编写了一些基于 java.awt.Shape 的碰撞例程，这可能会有所帮助......从这里查看 ShapeUtils.java：

[http://www.cs101.org/psets/breakout/solns/breakout-src.jar](http://www.cs101.org/psets/breakout/solns/breakout-src.jar)

您可能遇到的一个非常可能的问题是 java 圆是具有 4 个点的样条曲线，因此如果您检查定义圆的所有点是否都在另一个形状内，您仍然会错过样条曲线凸入其他形状，但实际上没有一个点在对象内部。我的解决方案（对于您的情况可能不够好是重新制作形状，直到沿各自边缘的点之间的距离小于最大可接受误差：

```
 /**
     * Convert any AWT shape into a shape with a specified precision.
     * The specified precision indicates the maximum tolerable distance
     * between knot points. If the shape is already precise enough then 
     * it is returned unmodified.
     *
     * @param aShape the shape to be converted if necessary.
     * @param precision the maximum tolerable distance between knot points.
     * @return A more precise version of the shape, or the same shape if
     *         the precision is already satisfied.
     */
    public static Shape getPreciseShape(Shape aShape, float precision) { 
```

这种精度以及模拟物体的速度，告诉我在模拟中我必须多久检查一次碰撞（最大增量时间）......如果你快速移动的模拟物体可以在一个时间间隔内直接穿过固体物体不要将时间间隔缩放到小于达到所需精度所需的时间。

基本上以这种方式，它成为计算成本和结果精度之间的直接权衡。就我而言，我只是希望游戏看起来不错，所以我只需要精确到确保对象的重叠不会超过半个像素左右。

**编辑：**让我总结一下我的建议......在重新阅读时，我意识到我迷失在细节中并且从未设法指出关键概念......Java有很多例程可以很好地测试Shape的各种实现（包括圆圈）。我的建议是尽可能多地使用 java 库，并得到你可以验证的结果是正确的。一旦你有了工作代码和检查代码是否工作的方法，如果你需要更快的速度，开始优化它的部分，最好是在分析正在运行的程序（产生正确的结果）之后，看看哪些部分限制了你的性能。

# ruby-on-rails - Foursquare API 与 Rails 应用程序？

> ID：11022161
> 
> 赞同：1
> 
> 时间：2012-06-13T19:40:15.323
> 
> 标签：ruby-on-rails, api, foursquare, endpoints

我已经使用 Foursquare API 和我的 Rails 应用程序设置了身份验证，现在是时候添加功能了。我对 Rails 不太精通——它不是我的第一语言。我想让商家与 Foursquare（工作）建立联系，然后将商家引导到一个页面，他们可以在该页面上查看其场所的唯一访客、场所的签到数量以及场所的市长是谁。我知道要使用哪些端点，只是不确定如何在 Rails 中实现它们。（访问令牌等）

谢谢！

**回答后**

我正在尝试实施 Turd Ferguson 的回答，但我一无所获。我不断收到错误消息，说该方法未定义。我想在用户通过身份验证后立即尝试简单的场地搜索。（创建动作）

另外，我正在使用 OmniAuth 进行身份验证。

**session_controller.rb**

```
class SessionsController < ApplicationController

  require 'foursquare'

  def create
    auth_hash = request.env['omniauth.auth']
    venues = Foursquare::search_venues("starbucks")
    render :text => venues
  end

  def failure
  end

  def destroy
    session[:user_id] = nil
    render :text => "Logged out!"
  end

  def callback
      code = params[:code]
      @access_token = foursquare.access_token(code, callback_session_url)
      session[:access_token] = @access_token

      redirect_to examples_path
  end

end 
```

**Foursquare.rb** 类 Foursquare

```
 def self.search_venues(text)
    client.search_venues(:ll => '36.142064,-86.816086', :query => text)
  end

  def self.client
    @client ||= Foursquare2::Client.new(:client_id => '0YO3F0JNZIPVKG1DE01MNPB132D4JZ0QYRQSOWTZQKHHOPKB', :client_secret => 'GMBOGWUNL2GIKZZXQPSLE4BMFNGB5LDHQREH2UKUCK1TJ1L0')
  end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T19:42:44.180

您是否考虑过使用诸如[foursquare2](https://github.com/mattmueller/foursquare2)之类的宝石？

使用 gem，您可以创建一个 Foursquare 类，例如：

```
class Foursquare

    def self.search_venues(text)
        client.search_venues(:ll => '36.142064,-86.816086', :query => text)
    end

    def self.client
        @client ||= Foursquare2::Client.new(:client_id => 'your_client_id', :client_secret => 'your_secret')
    end
end 
```

然后，您可以通过执行以下操作在任何您想要的地方调用它：

```
venues = Foursquare::search_venues "foobar" 
```

# iphone - 恢复不可更新的订阅

> ID：11022162
> 
> 赞同：2
> 
> 时间：2012-06-13T19:40:18.523
> 
> 标签：iphone, ios, in-app-purchase

目前我正在为社交网络开发一个应用程序，用户必须购买高级会员才能解锁一些额外的功能。起初我使用自动更新订阅，但我的应用被拒绝了。他们告诉我使用不可更新的订阅，并且：

> 不可再生订阅内容必须可供单个用户拥有的所有 iOS 设备使用，如 App Store 审核指南的指南 11.6 中所述：
> 
> 11.6 使用 IAP 的内容订阅必须至少持续 7 天，并且用户可以从他们的所有 iOS 设备上使用
> 
> 如果您选择使用用户注册来满足此要求，请记住，要求用户注册是不合适的。此类用户注册必须是可选的。向用户明确说明，只有通过注册，他们才能访问所有 iOS 设备上的内容。如果他们希望在未来访问其他 iOS 设备上的内容，并为他们提供一种稍后注册的方式。

在我的情况下，最合乎逻辑的转移订阅的方法是使用注册，因为用户在没有注册和登录的情况下无法查看内容（或购买订阅）。所以这意味着需要注册。

我的应用程序会再次被拒绝吗？如果是，那么您会建议什么解决方法？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T02:00:34.330

是和否。

*   如果您强迫您的用户注册（尤其是使用电子邮件地址）= REJECTED
*   如果您将注册设为可选并让用户以有限的访问权限使用您的应用 = 已批准

（以上陈述是我自己的经验和理解，如有错误请指正。）

首先，我的应用因使用自动更新订阅而被拒绝。

但我的应用第二次被拒绝（这次不可更新）。原因是，我的应用程序需要用户注册。在苹果的术语中，*'requires' 的*意思是*'force'*。

> 如果您选择使用用户注册来满足此要求，请记住，要求用户注册是不合适的。此类用户注册必须是可选的。**向用户明确说明，只有通过注册，他们才能访问所有 iOS 设备上的内容。** 如果他们希望在未来访问其他 iOS 设备上的内容，并为他们提供一种稍后注册的方式。

从上面，突出显示的行清楚地表明，用户注册必须是可选的。如果用户希望在其他 iOS 设备上访问，他们可以选择注册。*但又有一个问题*。

问题是，

> **17.2**要求用户分享电子邮件地址和出生日期等个人信息才能正常运行的应用程序将被拒绝

所以我要做的是，

1.  我会让用户无需注册即可购买订阅。但我稍后会使用唯一 ID 自动注册用户以识别用户。并向用户展示，他们必须使用用户名和密码注册才能在其他 iOS 设备中访问订阅。
2.  我不会强迫用户使用电子邮件地址注册。相反，我将使用“用户名”作为必填项，使用“电子邮件”作为可选内容，但要说明的是，建议输入“电子邮件”，以便在找回密码时更容易。

这是我迄今为止对苹果应用内购买的体验。如果我在任何地方错了，请纠正我...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T18:34:18.253

自动续订订阅仅适用于报刊亭应用程序中出现的杂志、报纸等期刊内容。Apple 将坚决拒绝将自动更新用于任何其他目的。您必须为“服务”使用非续订订阅。最好的信息是[http://developer.apple.com/news/pdf/in_app_purchase.pdf](http://developer.apple.com/news/pdf/in_app_purchase.pdf)

至于用户注册鸡蛋和鸡蛋的场景，如果它允许任何人注册，无论应用内购买如何，您都可以获得批准。也就是说，只有在用户注册后才允许IAP。您的“免费”用户只能拥有有限的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T06:47:50.103

我*认为*Apple 不会仅仅因为需要注册而拒绝应用程序，除非该注册的唯一目的是允许用户在所有设备上共享他们的订阅。在这种情况下，Apple 坚持您为用户提供一个*可选*的方法来共享订阅。

# file - Haskell读取文件行

> ID：11022163
> 
> 赞同：20
> 
> 时间：2012-06-13T19:40:20.470
> 
> 标签：file, haskell, io

我想将整个文件读入一个字符串，然后使用该函数`lines`来获取字符串的行。我正在尝试使用这些代码行来做到这一点：

```
main = do
   args <- getArgs
   content <- readFile (args !! 0)
   linesOfFiles <- lines content 
```

但是我通过编译失败的广告得到以下错误：

```
Couldn't match expected type `IO t0' with actual type `[String]'
In the return type of a call of `lines'
In a stmt of a 'do' block: linesOfFiles <- lines content 
```

我认为通过将结果绑定`readFile`到内容它将是一个`String`DataType，为什么不是呢？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-06-13T20:04:23.410

> 我认为通过将 readFile 的结果绑定到内容，它将是一个字符串数据类型，为什么不是呢？

确实`String`，这不是编译器所抱怨的。让我们看一下代码：

```
main = do
   args <- getArgs
   content <- readFile (args !! 0) 
```

现在`content`，根据需要，是一个普通的`String`. 然后`lines content`是一个`[String]`。但是你在下一行使用一元绑定

```
 linesOfFiles <- lines content 
```

在一个`IO ()`做块。所以编译器期望 的`IO something`右侧有一个类型的表达式`<-`，但它找到了`[String]`.

由于计算`lines content`不涉及任何，您应该使用绑定而不是单子绑定来`IO`绑定其结果，`let`

```
 let linesOfFiles = lines content 
```

是你需要的那条线。

# javascript - 在通过引用传递的方法中维护它

> ID：11022164
> 
> 赞同：1
> 
> 时间：2012-06-13T19:40:22.630
> 
> 标签：javascript, jquery

在下面的例子中，作为参数发送给方法“lostThis”对象“instObj”，“this”是窗口对象。

```
var obj = function() {};
obj.prototype.lostThis = function() {
    console.log('lostThis', this instanceof obj, this);
};

var instObj = new obj;

var caller = {
    runFn: function(fn) {
        fn();
    }
};

caller.runFn(instObj.lostThis); 
```

控制台响应：

```
lostThis false Window 
```

[运行示例](http://jsfiddle.net/adescalzo/tkQYV/)

在下面的例子中（稍微复杂一点），有不同的方法来调用“instObj”的方法，它是相同的，而其他的方法我可以保留“this”对象。

```
var obj = function() {};

obj.prototype.methodRefHasThis = function() {
    var t = this;
    return function() {
        console.log('methodRefHasThis ', t instanceof obj, t);
    };
};

obj.prototype.methodRefLostThis = function() {
    console.log('methodRefLostThis ', this instanceof obj, this);
};

obj.prototype.methodRefMaybeThis = function() {
    console.log('methodRefMaybeThis ', this instanceof obj, this);
};

var instObj = new obj;
var caller = {
    runFn: function(fn) {
        fn();
    }
};

// width jQuery
$('button')
    .bind('click', instObj.methodRefHasThis())
    .bind('click', instObj.methodRefLostThis);

caller.runFn(instObj.methodRefHasThis());
caller.runFn(instObj.methodRefLostThis);
caller.runFn(function() {
    instObj.methodRefMaybeThis();
});​ 
```

控制台响应：

```
methodRefHasThis  true obj
methodRefLostThis  false Window
methodRefMaybeThis  true obj

methodRefHasThis  true obj
methodRefLostThis  false <button>​press here​&lt;/button>​ 
```

[运行示例](http://jsfiddle.net/adescalzo/N95Y3/2/)

我知道 jQuery 会发生这种情况以将方法分配给事件，但**我可以调用方法“methodRefLostThis”而不丢失“this”对象以通过引用传递吗？**

谢谢

**@am_not_i_am、@Dan_Davies_Brackett 和 @Ben_Lee 的解决方案**

```
var obj = function() {};
obj.prototype.lostThis = function() {
    console.log('lostThis', this instanceof obj, this);
};

var instObj = new obj;

var caller = {
    runFn: function(fn) {
        fn();
    }
};

caller.runFn(instObj.lostThis.bind(instObj));
caller.runFn($.proxy(instObj.lostThis, instObj)); 
```

控制台响应：

```
lostThis true obj
lostThis true obj

 ​ 
```

[运行示例](http://jsfiddle.net/adescalzo/7VUGm/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T19:46:22.197

您可以使用`bind`将对象绑定到`this`被调用方。例如：

```
caller.runFn(instObj.lostThis.bind(this)); 
```

在这里，`this`方法运行时的 at 将被转移到`this`in `lostThis`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T19:48:20.943

有两种方法可以解决这个问题。`this`您可以捕获对（我通常称之为）的本地引用`self`，然后在方法内部使用`self.`而不是使用`this.`，或者您可以使用函数绑定。

Ben Lee 给出了 JS5 的绑定方式；[jQuery.proxy](http://api.jquery.com/jQuery.proxy/) 是不支持`Function.bind`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T19:46:31.950

如果您不想使用您发现有效的技术之一，您可以使用`Function.prototype.bind`将调用上下文绑定到新函数...

```
caller.runFn(instObj.lostThis.bind(instObj)); 
```

这将返回一个新函数，当调用该函数时，会将调用上下文设置为您作为第一个参数传递给`.bind()`.

传递给的任何附加参数`.bind()`都将设置为返回函数的固定参数。

# javascript - UIAutomation，UITableViewCell里面的UITableView

> ID：11022166
> 
> 赞同：1
> 
> 时间：2012-06-13T19:40:34.483
> 
> 标签：javascript, ios, instruments, ios-ui-automation

我有一组可怕的编码控制器，我目前无法重构。我需要对它们进行自动化测试，但遇到了 UIAutomation 工具的问题。

这些控制器是动态生成的。有很多方法可以做到这一点，但有人认为最好制作一个包含单元格的表格视图，每个单元格都包含更多表格视图，包含用户将看到并与之交互的单元格。

这些控制器之一的简单示例如下：

![在此处输入图像描述](../Images/f22ed96b28737dbbc9adc520e6c2244b.png)

我需要自动按下其中一个表格视图单元格。

在解决了一些视图层次结构问题之后，我终于设法让 logElementTree 查看所有具有正确可访问性标识符的单元格。结果如下：

![在此处输入图像描述](../Images/88c3399d0495afa8ad239ba8fcacd076.png)

现在只是为了测试我可以按下脚本中的一个按钮......

![帮助](../Images/d2659204276d561f4f023d61853f4f86.png)

不。即使 logTree 清楚地显示它们存在并且可见，我似乎也无法深入研究这些元素。

任何想法都非常受欢迎。我对javascript不是很有经验，所以我可能会遗漏一些明显的东西。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T10:23:36.817

回答我自己的问题并感谢 WWDC 的一位乐于助人的工程师：

```
target.frontMostApp().mainWindow().tableViews()[0].cells()[0].tableViews()[0].cells()["Open"].tap(); 
```

# powershell - 在 PowerShell 中抛出参数异常的替代方法？

> ID：11022170
> 
> 赞同：0
> 
> 时间：2012-06-13T19:41:02.320
> 
> 标签：powershell, exception-handling, parameters, validation

**底线在前面**

我正在寻找一种方法来验证 powershell (v1) 命令行参数，而不会将异常传播回命令行。

**细节**

我有一个当前用于验证命令行参数`param`的powershell 脚本：`[ValidateNotNullOrEmpty]`

```
param(
   [string]
   [ValidateNotNullOrEmpty()]$domain = $(throw "Domain (-d) param required.")
) 
```

我们正在改变错误处理的范例，我们不再希望将异常传递回命令行，而是提供自定义错误消息。由于该`param`块不能包装在 try catch 块中，因此我采用*了*以下方法：

```
param(
   [string]$domain = $("")
)
Try{
   if($domain -like $("")){
      throw "Domain (-d) param required."
    }
...

}Catch{
#output error message 
} 
```

我担心的是，我们绕过了所有可用的内置验证 using `param`。我的新技术是一个合理的解决方案吗？在脚本中封装异常时，是否有更好的方法来验证命令行参数？我非常有兴趣了解 PowerShell 专业人员如何处理这种情况。

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-25T13:33:24.443

您可以编写自定义验证脚本。试试这个参数。

```
Param(
    [ValidateScript({
        If ($_ -eq $Null -or $_ -eq "") {
            Throw "Domain (-d) param required."
        }
        Else {
            $True
        }
    })][string]$Domain
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T21:51:09.227

正如我在评论中提到的：我阅读您的描述越多，我得出的结论越多，您不应该担心“绕过所有内置验证”。为什么？因为那*正是*你的目标。你想绕过它的默认行为，所以如果这是你需要并且必须做的 - 不仅仅是做它。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T20:41:58.747

一种方法是`default parameters`像这样使用 [来自[msdn]](http://blogs.technet.com/b/heyscriptingguy/archive/2011/05/15/simplify-your-powershell-script-with-parameter-validation.aspx) -

```
Function CheckIfKeyExists 
{ 
    Param( 
        [Parameter(Mandatory=$false,ValueFromPipeline=$true)] 
        [String] 
        $Key = 'HKLM:\Software\DoesNotExist' 
    ) 
    Process 
    { 
        Try 
        { 
            Get-ItemProperty -Path $Key -EA 'Stop' 
        } 
        Catch 
        { 
            write-warning "Error accessing $Key $($_.Exception.Message)"   
        } 
    } 
} 
```

因此，在这里，如果您尝试在不传递任何参数的情况下调用该函数，您将收到您在 try/catch 块中定义的警告。而且，您没有为此使用任何默认验证属性。您应该始终假设您将遇到错误，并编写可以在错误中幸存的代码。但这里的教训是`if you implement a default value, remember that it is not being validated.`

[在这里](http://technet.microsoft.com/en-us/library/dd347600.aspx)阅读更多

# android - ProgressDialog 不会使用 Asynk Task Android 阻塞 UI 线程

> ID：11022183
> 
> 赞同：0
> 
> 时间：2012-06-13T19:42:22.767
> 
> 标签：android, android-asynctask, progressdialog

嗨，我是一名安卓应用程序的初学者开发者。我为大学考试做这项工作。我阅读了更多文档，但在我的活动中显示进度对话框时遇到问题，而 asynktask 从服务器下载 Json 字符串，然后我必须将其放入列表视图中。在我的 UI 线程中，我调用了 Asynk 任务，但线程继续工作，我无法使用 httpGet 的结果（工作正常）。我使用 Log.i(...) 理解这一点 为什么 UI线程不会停止并参加结果？我做错了什么？请帮我。

```
package my.pack;

import java.util.concurrent.ExecutionException;

import android.app.Activity;
import android.app.ProgressDialog;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;

public class TestDialogActivity extends Activity 
{

ProgressDialog dialog;
String url = "My URL";
String result= "init";

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    DownloadJsonDataTask task = (DownloadJsonDataTask) new DownloadJsonDataTask(result).
            execute(url);   

    try {
        String ris = task.get();
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ExecutionException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    Log.i("GET",result);

}

public String requestInfoFromServer() {
    String request = null;
    HttpConnection http = HttpConnection.getInstance();
    http.setHttpClient(url);
    request = http.executeRequest();

    return request;
}   

private class DownloadJsonDataTask extends AsyncTask<String, Integer, String> 
{

    String Result;

    protected void onPreExecute()
    {
        dialog = new ProgressDialog(TestDialogActivity.this);
        dialog.setTitle("Download");
        dialog.setMessage("Please wait...");
        dialog.setIndeterminate(true);
        dialog.show();

    }

            public DownloadJsonDataTask(String response) {

                this.Result=response;
            }

    protected String doInBackground(String... urls) {
        String urldisplay = urls[0];

        Log.i("STRING URL:", urldisplay);

        String result = requestInfoFromServer();

        return Result; 

    }

    protected void onPostExecute(String result) {
        this.Result = result;
        dialog.dismiss();
    }
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:11:42.347

除了萨米尔·曼格罗利亚。

`task.get();`是调用该方法的线程的阻塞调用。因此，在主 UI 线程上使用它会阻止它，这很糟糕，因为下载 smth 可能需要几秒钟。因此系统检测到 UI 线程被阻塞了这么长时间，并以 ANR（应用程序无响应）弹出窗口终止应用程序。将此移动结果处理修复到 AsyncTask 的 onPostExecute() （至少此时应启动结果处理，您可以在此处调用某些主机 Activity 的方法传递结果）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:11:29.770

啊，我在`doInBackground(String... urls)`函数中看到了问题，您现在已经声明了两个具有相似名称的不同字符串，因为变量名区分大小写，将一个字符串命名为 R 并且`Result`将另一个命名`result`为 R 和 r 被视为两个不同的字符是完全合法的，因此两者有唯一的名字。尽管这是有效的语法；这很容易出现逻辑错误。我相信这就是你遇到问题的地方。您没有在函数调用结束时为`Result`to分配任何值，`result`这又是有效的语法，并且不像您声明时那样指向空变量`Result`它确实输入了一个空字符串的默认值。所以它会编译并且不会抛出空指针错误，因为变量不为空，即使其中没​​有字符串数据，指针仍然指向内存中的有效位置，所以就编译器而言，一切都是好，它不应该检查字符串的内容，只是传递它。同时`result`，您在通话结束之前将所有数据分配给的变量会加载您想要的所有数据。在调用结束之前被完全忽略，因为没有进一步的命令处理它。然后在调用结束时它被垃圾收集并且数据永远不会传递，因为它没有被告知只传递该变量`Result`一

有道理？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:25:11.040

在您的 doInBackground() 例程中，将下载的结果保存在成员变量 Result 中。然后，在 onPostExecute() 中，您将需要阅读 Result 并更新您的 UI。

例如：

```
private void updateUI(String jsondata)
{
    foo = do.something.to.derive.some.data.from.jsondata.

    TextView tv = findViewById(R.id.textview1);
    tv.setText (foo);
}

private class DownloadJsonDataTask extends AsyncTask<String, Integer, String> 
{

    String Result = null;
    ...
    protected String doInBackground(String... urls) 
    {
            Result = requestInfoFromServer();
    }

    protected void onPostExecute(String result) 
    {
         dialog.dismiss();
         updateUI(Result);
     }
  } 
```

# javascript - 如何防止fancybox删除点击的缩略图

> ID：11022193
> 
> 赞同：1
> 
> 时间：2012-06-13T19:43:22.250
> 
> 标签：javascript, jquery, fancybox

第一次使用fancybox，它并不顺利.. 开始希望我不打扰它。

我连续有一些缩略图，很好，然后当我单击一个时，它会打开 THUMBNAIL 而不是链接，更糟糕的是它会从 DOM 中删除缩略图。我已经在fancybox src 中挖掘了这个问题，但它有很多，我可能最终会杀死功能，所以我想我会在这里发布。

继承人的代码：

原始 HTML 来自 CMS，如下所示：

```
<img src="http://blah..blah..from..flickr..001_s.jpg" alt="my image one" class="flickr-square" title="test image" longdesc="" data-url="http://blah..blah..flickr..detail..page" data-orig="http://blah..blah..flickr..big..001_b.jpg">
<img src="http://blah..blah..from..flickr..002_s.jpg" alt="my image one" class="flickr-square" title="test image" longdesc="" data-url="http://blah..blah..flickr..detail..page" data-orig="http://blah..blah..flickr..big..002_b.jpg"> 
```

然后我在主干视图渲染中运行一些东西，重要的是：

```
 var imgs = this.$el.find("img"); //:a jquery group of the img elements above
    this.content = this.$el.find("span.postcontent");
    //empty current
    this.content.empty();
    //make replacement
    for(i= 0;i<imgs.length;i++)
    {

        var curImg = $(imgs[i]);
        var curLink = $("<a/>");
        curLink.attr("href",curImg.attr('data-orig'))
        curLink.append(curImg);
        curLink.on("click",function(e){
            e.preventDefault();
            $.fancybox.open(imgs)
        });
        this.content.append(curLink)
    } 
```

我现在已经像这样渲染了 html：

```
 <a href="http://blah..blah..flickr..big..001_b.jpg">
    <img src="http://blah..blah..from..flickr..001_s.jpg" alt="my image one" class="flickr-square" title="test image" longdesc="" data-url="http://blah..blah..flickr..detail..page" data-orig="http://blah..blah..flickr..big..001_b.jpg">
   </a>
   <a href="http://blah..blah..flickr..big..002_b.jpg">
    <img src="http://blah..blah..from..flickr..002_s.jpg" alt="my image one" class="flickr-square" title="test image" longdesc="" data-url="http://blah..blah..flickr..detail..page" data-orig="http://blah..blah..flickr..big..002_b.jpg">
   </a> 
```

到目前为止一切都很好......现在，当我单击链接/拇指时，它会做花式框的事情，但显示的是 THUMBNAIL 而不是链接的图像，中间很小，它是 lightboxy 的东西，真正令人讨厌的是页面中单击的缩略图本身现在已完全从 dom 中删除，即：

```
 <a href="http://blah..blah..flickr..big..001_b.jpg"> 
         ///THIS IS MISSING COMPLETELY..... ggggggrrrrr 
       </a>
       <a href="http://blah..blah..flickr..big..002_b.jpg">
        <img src="http://blah..blah..from..flickr..002_s.jpg" alt="my image one" class="flickr-square" title="test image" longdesc="" data-url="http://blah..blah..flickr..detail..page" data-orig="http://blah..blah..flickr..big..002_b.jpg">
       </a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:36:00.523

我从未见过 Fancybox 被这样使用。通常，您不需要那样触发`$.fancybox.open`。您可以绑定`fancybox()`到`<a>`标签。

HTML：

```
<a href="big-image.jpg" class="fancybox">
    <img src="thumbnail.jpg">
</a> 
```

JavaScript：

```
$('.fancybox').fancybox(); 
```

在使 DOM 看起来像这样之后，尝试使用该函数。

[编辑]

我无法让您的 DOM 操作正常工作，但我用这个小提琴进行了测试，它似乎正在工作：http: [//jsfiddle.net/haRnQ/4/](http://jsfiddle.net/haRnQ/4/)

**注意：**我没有为演示导入样式或图像，因此它不会设置样式，但它仍然有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T21:27:33.947

我正在回答并投票赞成前两个，因为它们都有帮助，但不是确定的答案。[文档](http://fancyapps.com/fancybox/#docs)不清楚，如果您只使用“组”作为 jquery 数组，您还必须指定选项，因此正确的答案是这样做（传递两个参数）：

```
 $.fancybox.open(imgs,
                {
                    href:this.href,
                    title:curImg.attr("title")
                }
            ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T20:37:39.250

尝试改变这个

```
$.fancybox.open(imgs) 
```

这样

```
$.fancybox({
 href: this.href
}); 
```

因为`imgs`是您的缩略图（所有`<img>`元素）的集合，这些缩略图被移到了fancybox，`click`但在关闭后没有移回。

在任何情况下，我都建议您添加一个`class`，`<a>`否则您页面中可能拥有的任何其他锚点都会尝试打开fancybox。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-01T22:04:19.577

I believe Fancybox prefers wrapping your images in an anchor. This is important to note as Fancybox **removes** the anchor when activating a slide show to prevent clicking on the anchor when the modal is active.

Calling FB from the thumb behaves like you have experienced by deleting the thumb and not recovering it after the modal is closed.

This is my typical FB setup (not a thumb gallery):

```
<a href="image1.jpg" class="fb" rel="fb1"><img src="image1.jpg" alt="" /></a>
<div style="display: none">
    <a href="image2.jpg" class="fb" rel="fb1"></a>
    <a href="image3.jpg" class="fb" rel="fb1"></a>
    ...
</div> 
```

# c++ - C++ MPI：杀死奴隶

> ID：11022194
> 
> 赞同：-1
> 
> 时间：2012-06-13T19:43:24.060
> 
> 标签：c++, mpi

我正在使用 MPI 开发一个 c++ 应用程序。我将奴隶之间的任务分开。

但是，一些slave可以成功完成主要任务，我希望slave警告master，master杀死其他slave。那有可能吗？

我阅读了有关 MPI_Abort 的信息，但我认为这仅对异常有用。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T23:20:38.093

从站必须定期检查是否需要退出。一种方法是让每个从属调用都`MPI_Irecv`带有一个特殊的“kill tag”，并定期`MPI_Test`完成。一旦 master 想要 slave 退出，它就会发出匹配`MPI_Send`的 s。

# eclipse - 如何使内部编辑器成为eclipse中的默认编辑器

> ID：11022199
> 
> 赞同：1
> 
> 时间：2012-06-13T19:43:46.373
> 
> 标签：eclipse

我希望默认编辑器是内部编辑器而不是系统编辑器。

我已在 window->preferences->file associations 中配置为使用 *.xml 的默认内部 xml 编辑器，但 eclipse 总是尝试使用 OS 系统编辑器打开文件。我怎样才能防止这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:47:43.737

编辑器类型映射到文件类型；您可以在每个工作区（全局）或每个项目的基础上执行此操作。

它应该非常简单：

*   [http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.wst.xmleditor.doc.user%2Ftopics%2Ftxprefs.html](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.wst.xmleditor.doc.user%2Ftopics%2Ftxprefs.html)

*   进入“帮助，安装软件，已经安装了什么？” 并确保您已安装“Eclipse XML 编辑器和工具”。你不知道，那就拿去吧。

*   最后，创建一个*新*的“干净”项目，添加一个 XML 文件，并验证它是否正常工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T20:53:51.277

我找到了这个问题，但答案对我没有帮助，所以我继续搜索并在这里找到了答案[http://help.eclipse.org/juno/index.jsp?topic=%2Forg.eclipse.platform.doc.user %2Ftasks%2Ftasks-51.xhtml](http://help.eclipse.org/juno/index.jsp?topic=%2Forg.eclipse.platform.doc.user%2Ftasks%2Ftasks-51.xhtml)

基本上，在首选项中，常规 > 编辑器 > 文件关联，然后定义您的文件类型（如果还没有的话），然后选择一个编辑器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-13T19:48:21.557

右键单击项目中的文件，

选择打开方式...。选择您的编辑器

# python - 如何使用二进制文件读取和写入值

> ID：11022201
> 
> 赞同：2
> 
> 时间：2012-06-13T19:43:56.207
> 
> 标签：python, python-3.x

我有一个 int 类型的变量，我希望将它写入二进制文件中的某个位置：

所以是这样的：

```
with open("file","wb") as f:
    f.seek(position)
    f.write(variable) 
```

但变量是在这个位置取 4 个字节。写作时如何传达这一点？

这就是我的阅读方式：

```
def read(self, position, length):
    self.file.seek(position)
    a=self.file.read(length)
    data=0
    for i in range(length):
        data=data + (a[i])*pow(256,i)
    return data 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T19:46:25.313

使用 Python[结构](http://docs.python.org/library/struct)模块。例子：`struct.pack("<I", 3)`

该示例将整数值 3 转换为无符号整数 little-endian。

以下是使用本机大小和对齐方式读取和写入本机整数的函数。

```
import struct

def write_int(f, position, x):
    f.seek(position)
    f.write(struct.pack("i", x))

_int_length = len(struct.pack("i", 0))  # find out size of native integer
def read_int(f, position):
    f.seek(position)
    return struct.unpack("i", f.read(_int_length)) 
```

# asp.net - 未知的服务器标签“dxtc:ASPxTabControl”

> ID：11022202
> 
> 赞同：0
> 
> 时间：2012-06-13T19:44:00.183
> 
> 标签：asp.net, devexpress

我被分配了一个新项目来做一些增强，但是在编译给定的解决方案时我遇到了这个错误：

```
Unknown server tag 'dxtc:ASPxTabControl' 
```

解决方案是使用 devExpress 库版本 11。我从未使用过 DevExpress，也不知道这个错误是什么。任何人都可以帮助我吗？下面是我的代码：

```
<dxtc:ASPxTabControl ID="tabMaster" runat="server" ActiveTabIndex="3" CssFilePath="~/App_Themes/Glass/{0}/styles.css"
        CssPostfix="Glass" TabSpacing="0px">
        <Tabs>
            <dxtc:Tab Text="Calibrations">
            </dxtc:Tab>
            <dxtc:Tab Text="Custom Assemblies">
            </dxtc:Tab>
            <dxtc:Tab Text="Panel Orders">
            </dxtc:Tab>
            <dxtc:Tab Text="Will Call">
            </dxtc:Tab>
        </Tabs>
        <Paddings PaddingLeft="0px" />
        <TabStyle HorizontalAlign="Center" Width="55px">
        </TabStyle>
        <ContentStyle>
            <BorderTop BorderStyle="None" />
        </ContentStyle>
    </dxtc:ASPxTabControl> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:16:12.580

您需要在 .aspx 标记中注册 dx 控件

```
<%@ Register assembly="DevExpress.Web.v8.3, Version=8.3.2.0, Culture=neutral, 
    PublicKeyToken=b88d1754d700e49a" namespace="DevExpress.Web.ASPxTabControl"
    tagprefix="dxtc" %> 
```

（[文档](http://documentation.devexpress.com/#AspNet/DevExpressWebASPxTabControlASPxTabControl_NavigateUrlFieldtopic)）

或在 web.config

```
 <system.web>
    <pages>
      <controls>
        <add tagPrefix="dxtc" assembly="DevExpress.Web.v10.2" namespace="DevExpress.Web.ASPxTabControl" />
      </controls>
    </pages> 
```

不要忘记将程序集名称调整为您正在使用的版本。

# java - 如何使用反射来调用带参数的方法？

> ID：11022208
> 
> 赞同：20
> 
> 时间：2012-06-13T19:44:17.130
> 
> 标签：java, reflection, dynamic, types, parameters

这是我的课：

```
public class A{
    private void doIt(int[] X, int[] Y){
       //change the values in X and Y
    }
} 
```

我有另一个类试图用来`doIt`修改两个数组。我的代码中有错误，但找不到。

```
public class B{
  public void myStuff(){
    A myA = new A();
    int[] X = {1,2,3,4,5};
    int[] Y = {4,5,6,7,8,9};
    Method doIt = A.class.getDeclaredMethod("doIt",new Object[]{X,Y}); // error
    doIt.setAccessible(true);
    doIt.invoke(myA,new Object[]{X,Y});
  }
} 
```

有关如何修复方法的任何帮助`myStuff`？

如果我使用`getDeclaredMethod("doIt",new Object[]{X,Y});`代码不编译。

相反，如果我有，`getDeclaredMethod("doIt",null);`那么它会说`NoSuchMethodException`。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-13T19:50:00.840

您的方法是用两个 int 数组声明的

```
private void doIt(int[] X, int[] Y) 
```

如果您想找到该方法，您还需要放置其参数类型，以防止找到具有相同名称但类型不同的其他方法。

```
A.class.getDeclaredMethod("doIt", int[].class, int[].class) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T19:47:37.347

该`doIt`方法有**两个**参数。因此，除了方法名称之外，您还需要将**两个**[`Class#getDeclaredMethod()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getDeclaredMethod%28java.lang.String,%20java.lang.Class...%29)参数传递给. 两个附加参数必须是 的实例[`Class`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html)，而 an`Object[]`显然*不是。*具体来说，这些`Class`实例需要与接受的参数类型相同`doIt`。

```
Method doIt = A.class.getDeclaredMethod("doIt", int[].class, int[].class); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-13T19:48:45.110

不应该吗？

```
Method doIt = A.class.getDeclaredMethod("doIt", int[].class, int[].class); 
```

# python - supervisor 和 uWSGI 不能与 nginx 一起工作

> ID：11022209
> 
> 赞同：3
> 
> 时间：2012-06-13T19:44:30.357
> 
> 标签：python, nginx, uwsgi, supervisord

我使用 supervisord 来管理龙卷风，使用 nginx 作为负载均衡器没有问题。

我在使用 nginx 作为负载平衡器的主管和 uWSGI 方面遇到了严重问题。我使用瓶子作为框架。

当我从命令行运行以下命令并在 FF 中加载一个页面并点击 nginx 时，一切正常。

```
sudo command = /usr/local/bin/uwsgi --loop gevent --socket 127.0.0.1:8070 --wsgi-file /home/ubuntu/workspace/uwsgiServer.py -b 32768 --master --async 5 --enable-threads --listen 100 --uid root 
```

如果我将命令行放在supervior中，那么我找不到页面。

```
uWSGI Error
Python application not found

[program:uwsgi]
#autostart=true
#autorestart=true
#process_name = uwsgi-%(process_num)s
command = /usr/local/bin/uwsgi --loop gevent --socket 127.0.0.1:8070 --wsgi-file /home/ubuntu/workspace//uwsgiServer.py -b 32768 --master --async 5 --enable-threads --listen 100 --uid root
#--port=%(process_num)s
#--log_file_prefix=%(here)s/logs/%(program_name)s-%(process_num)s.log
#numprocs = 1
#numprocs_start = 8070 
```

以下是 nginx.conf 文件的相关部分：

```
upstream uwsgi_b {
      server 127.0.0.1:8070;
    }

location /u/ {
                       include uwsgi_params;
                       uwsgi_param X-Real-IP $remote_addr;
                       uwsgi_param Host $http_host;
                       uwsgi_pass uwsgi_b;
                 } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T21:16:35.763

您可能会在 supervisord 配置中添加更多参数，例如 --pp（python 路径）到 uwsgi 命令，可能还有一些环境变量：

```
[program:uwsgi]
command = /usr/local/bin/uwsgi 
    --loop gevent 
    --socket 127.0.0.1:8070 
    --wsgi-file uwsgiServer.py 
    --buffer-size 32768 --master --async 5 --enable-threads --listen 100 --uid root 
    --pp /home/ubuntu/workspace/

autostart=true
autorestart=true
environment=ENV_VAR='var'
user=root # or other
group=root # or other
directory=/home/ubuntu/workspace/
umask=022 
```

**编辑**：删除了 Django 特定的设置

# php - PHP写二进制响应

> ID：11022213
> 
> 赞同：18
> 
> 时间：2012-06-13T19:44:37.950
> 
> 标签：php, binary, response

在 php 中有一种方法可以将二进制数据写入响应流，
就像 (c# asp)

```
System.IO.BinaryWriter Binary = new System.IO.BinaryWriter(Response.OutputStream);
Binary.Write((System.Int32)1);//01000000
Binary.Write((System.Int32)1020);//FC030000
Binary.Close(); 
```

然后我希望能够在 ac# 应用程序中读取响应，例如

```
System.Net.HttpWebRequest Request = (System.Net.HttpWebRequest)System.Net.WebRequest.Create("URI");
System.IO.BinaryReader Binary = new System.IO.BinaryReader(Request.GetResponse().GetResponseStream());
System.Int32 i = Binary.ReadInt32();//1
i = Binary.ReadInt32();//1020
Binary.Close(); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-13T20:50:41.053

在 PHP 中，字符串和字节数组是一回事。用于`pack`创建然后可以写入的字节数组（字符串）。一旦我意识到这一点，生活就会变得更轻松。

```
$my_byte_array = pack("LL", 0x01000000, 0xFC030000);
$fp = fopen("somefile.txt", "w");
fwrite($fp, $my_byte_array);

// or just echo to stdout
echo $my_byte_array; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-18T01:57:46.397

[这是我在这个类似的问题](https://stackoverflow.com/questions/14014175)上发布的相同答案。

假设该数组`$binary`是您希望按此确切顺序写入磁盘的先前构造的数组字节（如我的情况下的单色位图像素），则以下代码在运行 ubuntu 服务器 10.04 LTS 的 AMD 1055t 上为我工作。

我遍历了我可以在网上找到的每一种答案，检查输出（我使用了 shed 或[vi，就像在这个答案中一样](https://stackoverflow.com/a/9441399/946112)）来确认结果。

```
<?php
$fp = fopen($base.".bin", "w");
$binout=Array();
for($idx=0; $idx < $stop; $idx=$idx+2 ){
    if( array_key_exists($idx,$binary) )
        fwrite($fp,pack( "n", $binary[$idx]<<8 | $binary[$idx+1]));
    else {
        echo "index $idx not found in array \$binary[], wtf?\n";
    }
}
fclose($fp);
echo "Filename $base.bin had ".filesize($base.".bin")." bytes written\n";
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T19:46:04.997

通常，我使用`chr()`;

```
echo chr(255); // Returns one byte, value 0xFF 
```

[http://php.net/manual/en/function.chr.php](http://php.net/manual/en/function.chr.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T19:54:32.603

您可能需要[pack](http://php.net/manual/en/function.pack.php)函数——它可以让您对值的结构方式进行相当多的控制，即一次 16 位或 32 位、小端与大端等。

# vim - 如何在 Vim 中报告每个折叠的第一行？

> ID：11022226
> 
> 赞同：1
> 
> 时间：2012-06-13T19:45:23.083
> 
> 标签：vim

我以为

```
:folddoc execute v:foldstart."p" 
```

会起作用，但它只会重复返回*其中一个*折叠的第一行。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T04:45:44.783

可以使用该`foldclosed()` 函数检测闭合折叠的第一行。对于闭合折叠内的给定行号，它返回折叠开始的行号；否则，它返回 -1。显然，如果一行的编号等于该`foldclosed()` 编号的值，则该行是折叠中的第一行。在 Vimscript 中，这个测试可以写成

```
foldclosed('.') == line('.') 
```

因此，要打印所有闭合折叠的第一行，可以使用以下命令：

```
:folddoc if foldclosed('.') == line('.') | # | endif 
```

（ 当不需要显示行号时，使用`:p` 命令而不是命令。）`:#`

# c# - 将数据表加载到数据网格视图问题

> ID：11022227
> 
> 赞同：1
> 
> 时间：2012-06-13T19:45:26.817
> 
> 标签：c#, sql, datagridview, datatable, sqldatasource

我正在尝试从我的 SQL 服务器获取信息并根据用户选择的参数将其加载到 datagridview 中。我在这个问题末尾发布的示例在程序的早期函数中工作，但现在不是。这使我相信问题在于实际将数据输出到 DGV 的线路。关于为什么它没有填满 DGV 的任何想法？我已经包含了两个示例，但都没有工作。出于某种原因，他们只是没有向 DGV 输入任何信息，即使我从调试中知道他们确实成功地从服务器中提取了信息。

```
SqlConnection DBConnection = new SqlConnection(ConnectionString);

        //Opens the connection
        DBConnection.Open();

        //Creates a string to hold the query
        string query = "SELECT * FROM PRD WHERE PRD_NUM LIKE '" +OutputBeforeIncrement + "%'";

        //Creates an SQLCommand object to hold the data returned by the query 
        SqlCommand queryCommand = new SqlCommand(query, DBConnection);        

        //Uses the aforementioned SQLCommand to create an SQLDataReader object
        SqlDataReader queryCommandReader = queryCommand.ExecuteReader();      

         //Creates a DataTable to hold the data                               
        DataTable dataTable = new DataTable();

        //This part actually loads the data from the query into the table     
        dataTable.Load(queryCommandReader);
        dgvOutput.DataSource = dataTable; 
```

另一个例子：

```
using (SqlDataAdapter newDA = new SqlDataAdapter(query, DBConnection))
            {
                DataTable Table = new DataTable();
                newDA.Fill(Table);

                dgvOutput.DataSource = Table;
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:24:40.120

你可以试试这个或类似的东西：

```
SqlDataAdapter myDataAdapter;
SqlCommandBuilder myCommandBuilder;
SqlCommand mySqlCommand = new SqlCommand(myQuery, MySQLConnection);
//I think this is the default command type, and thus can be omitted
mySqlCommand.CommandType = CommandType.Text; 
myDataAdapter = new SqlDataAdapter(mySqlCommand);
//Automates your insert/update/delete
myCommandBuilder = new SqlCommandBuilder(myDataAdapter);
myDataAdapter.Fill(myDataTable);
dgvOutput.DataSource = myDataTable.DefaultView; 
```

# xaml - Winrt 应用程序，随机出现未处理的异常

> ID：11022238
> 
> 赞同：4
> 
> 时间：2012-06-13T19:46:07.577
> 
> 标签：xaml, windows-runtime

在开发过程中，我偶尔会遇到未处理的异常，但主要是在关闭应用程序之后。在“异常中断”上设置所有选项不会触发任何代码。任何经历相同行为的人。我正在开发发布预览版本和 Visual Studio RC 版本。

![截图未处理的异常](../Images/76fc21c10a9b4232838430b6aae9c69b.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-25T11:35:07.833

我为解决问题所做的第一步是：

*   在项目属性中启用本机调试（调试选项卡，调试器类型）（谢谢詹姆斯！我现在知道你的意思了 :-)）
*   将符号服务器设置到正确的位置（工具、选项、调试、符号、所有模块）

并开始调试。这将需要几分钟才能开始加载所有符号......

当绑定到 URL 未解析的位图时，我将其追溯到几个异常。绑定是 GridView 到类的 SmallImageSource 位图属性。调试时，这将在本机代码中给出异常，但不会跟踪到输出窗口或在应用程序中给出异常。最终我的应用程序崩溃了……修复这些资源后，我的应用程序不再崩溃。虽然这在小场景中是不可重现的。在它崩溃的一小段应用程序代码下方。GridView 嵌入在 SemanticZoom 控件中

XAML（用于语义缩放控件）

```
 <GridView.ItemTemplate>
                <DataTemplate>
                    <Grid Background="Gray" Width="300" Height="80">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="80"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Image Source="{Binding Group.Key.SmallImageSource}" Stretch="Uniform" Margin="15" Grid.Column="0"/>
                        <TextBlock Text="{Binding Group.Key.Name}" Margin="0,10" TextAlignment="Center" Grid.Column="1" VerticalAlignment="Center"/>
                    </Grid>
                </DataTemplate>
            </GridView.ItemTemplate> 
```

C#（这里是一个不解析为本地资源的 URI）

```
public Uri SmallImage
    {
        get
        {
            return new Uri("ms-appx:///Resources/Images/SubCategories/" + Id + "_" + FunctionHelper.StripCharacter(Name) + ".png", UriKind.Absolute);
        }

    }
    public BitmapImage SmallImageSource
    {
        get
        {
            return new BitmapImage(SmallImage);
        }
    }
    } 
```

# mysql - 排序，在末尾添加 0，同时保持升序搜索顺序

> ID：11022241
> 
> 赞同：3
> 
> 时间：2012-06-13T19:46:11.997
> 
> 标签：mysql

我有一个使用的查询，`ORDER BY ASC`因此首先出现 0。我希望它们排在最后，同时仍保持升序搜索顺序。我怎样才能做到这一点？

这方面的一个例子是：

```
SELECT product_price ORDER BY product_price ASC 
```

所以而不是

```
0
1
2
3 
```

我想要

```
1
2
3
0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T19:52:09.173

我没有要测试的 MySQL，但这适用于 SQL Server 和 Advantage Database Server：

```
SELECT 
  product_price 
ORDER BY 
  CASE product_price WHEN 0 then 99999999 ELSE product_price END 
```

将系列替换为列类型`99999999`的最大值。`product_price`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T19:48:45.490

```
SELECT product_price FROM tablename ORDER BY IF(product_price=0,4294967295,product_price) ASC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T20:07:50.043

为了获得最佳性能，请使用[union](http://dev.mysql.com/doc/refman/5.0/en/union.html)。

```
(
    SELECT
        *
    FROM
        products
    WHERE
        product_price > 0
    ORDER BY
        product_price ASC
)
UNION
(
    SELECT
       *
    FROM
        products
    WHERE
       product_price = 0
) 
```

另一种方法是使用文件排序，当你有大表时，这可能会很慢。

```
EXPLAIN SELECT
    *
FROM
    products
ORDER BY
    IF(product_price = 0, 1, 0) ASC
    ,product_price ASC 
```

产量`Using filesort`。这意味着正在将临时表写入磁盘。处理大型查询时非常慢。

# .htaccess - .htaccess 301 重定向排除子页面

> ID：11022244
> 
> 赞同：1
> 
> 时间：2012-06-13T19:46:27.513
> 
> 标签：.htaccess, mod-rewrite

我的规则如下所示：

```
RewriteRule ^page-parent.*$ http://www.domain.com/new-page/?%{QUERY_STRING} [R=301,L] 
```

我的问题是有一个页面 /page-parent/thanks 我不想被重定向。

我还传递了查询字符串，以便任何 ?gclid= 字符串都可以使用。

我一生无法弄清楚如何排除单个子页面或所有子页面，这也可以。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:52:18.490

您可以检查`RewriteCond`请求的页面是否是您要排除的页面。

```
RewriteCond %{REQUEST_URI} !^/page-parent/thanks
RewriteRule ^page-parent.*$ http://www.domain.com/new-page/ [R=301,L,QSA] 
```

确保在重试时清除浏览器缓存，因为 301 重定向被缓存。

注意：您不需要手动附加查询字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T19:51:59.437

您可以使用 mod_rewrite 创建条件：

```
RewriteCond %{REQUEST_URI} !^/page-parent/thanks
RewriteRule ^page-parent.*$ http://www.domain.com/new-page/ [R=301,L] 
```

请注意，您可以`?%{QUERY_STRING}`从目标中省略 ，因为默认情况下查询字符串会附加到目标中，除非您通过**?添加了新参数。**.

# delphi - 对象列表未检索数据

> ID：11022251
> 
> 赞同：1
> 
> 时间：2012-06-13T19:47:09.673
> 
> 标签：delphi, tobjectlist

我将一些图像加载到对象列表中，然后尝试调用它们。但它不显示图像？

```
procedure TForm1.LoadImages(const Dir: string);
var
  i: Integer;
  CurFileName: string;
  JpgIn: TJPEGImage;
  BmpOut: TBitmap;
begin
//sets index for object list
  CurIdx := -1;
  i := 0;
  while True do
  begin
//gets current folder 
    CurFileName := Format('%s%d.jpg',
                          [IncludeTrailingPathDelimiter(Dir), i]);
    if not FileExists(CurFileName) then
      Break;
//creates jpgin
    JpgIn := TJPEGImage.Create;
    try
//loads jpgin 
      JpgIn.LoadFromFile(CurFileName);
//creates TBitmap and sets width to same as jpgs
      BmpOut := TBitmap.Create;
      bmpout.Width := jpgin.Width;
      bmpout.Height := jpgin.Height;
     try
         BmpOut.Assign(JpgIn);
//if i assign it here it works, showing last image of course
         //zimage1.Bitmap.Width := bmpout.Width;
        //zimage1.Bitmap.Height := bmpout.Height;
         //ZImage1.Bitmap.Assign(bmpout);
//adds 1 to index for object list. thus starting at 0
         curIdx := curIdx+1;
//add bitmap to objectlist
         CurIdx:= mylist.Add(TBitmap(bmpout));
      finally
//free bitmap and jpg
        BmpOut.Free;
      end;
    finally
      JpgIn.Free;
    end;
    Inc(i);
  end;
//makes sure cout is above 0  
  if mylist.Count > 0 then
  begin
//create bitmap
    BmpOut := TBitmap.Create;
      try
//sets width and heigh of bitmap before getting image
      bmpout.Height := TBitmap(mylist[curidx]).Height;
      bmpout.Width := TBitmap(mylist[curidx]).Width;
      bmpout.Assign(TBitmap(mylist[CurIdx]));
//sets zimage width height before getting image.
      zimage1.Bitmap.Width := bmpout.Width;
      zimage1.Bitmap.Height := bmpout.Height;
      ZImage1.Bitmap.Assign(bmpout);
    finally
      BmpOut.Free;
    end;
  end;
  page:= '0';
end; 
```

如果你注意到我有这个部分，看看将 iamge 加载到 zimage1 中是否有问题。

```
 //zimage1.Bitmap.Width := bmpout.Width;
    //zimage1.Bitmap.Height := bmpout.Height;
     //ZImage1.Bitmap.Assign(bmpout); 
```

当我这样做时，它会将 bmpout 加载到 zimage1 中，这导致我认为它与我做错的对象列表有关？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:18:35.997

你有这个代码：

```
 CurIdx:= mylist.Add(TBitmap(bmpout));
finally
  //free bitmap and jpg
  BmpOut.Free;
end; 
```

您将一个项目添加到列表中，然后立即释放该项目。`TList`它的后代`TObjectList`不会对他们持有的对象进行“深拷贝”。

当您稍后阅读列表的内容时，您得到的是*过时的引用*。它们不再引用它们最初引用的对象，而且它们可能根本不引用任何对象。这些位置的内存可能仍然包含结构看起来像那些以前的对象的数据，但不能保证这一点。也不能保证您的程序不会崩溃。崩溃是典型的，但下一个最常见的行为是您的程序出现细微的错误，例如继续运行但不显示预期的数据。

* * *

如果你想要一个对象列表，那么不要释放它们；摆脱`finally`我上面引用的块。为了异常安全，您需要小心地将所有权从当前代码块转移到列表，如下所示：

```
BmpOut := TBitmap.Create;
try
  BmpOut.Assign(JpgIn);
  CurIdx := mylist.Add(bmpout);
except
  BmpOut.Free;
  raise;
end; 
```

`Assign`如果在or调用期间发生异常`Add`，则本地过程应释放位图。否则，列表获得对象的所有权，释放列表将隐式释放其所有对象（假设列表的`OwnsObjects`属性为`True`）。

一旦您加载了所有位图并将它们存储在列表中，就没有真正需要创建另一个位图只是为了将某些内容分配给您的图像控件。您可以只使用您存储在列表中的那个：

```
if mylist.Count > 0 then
begin
  ZImage1.Bitmap.Assign(mylist[mylist.Count - 1]);
end; 
```

从该代码中，您可以看到您甚至不需要跟踪`CurIdx`. 它的值将始终是最后添加的对象的索引，并且该索引将始终比列表中对象的总数小一。

您也不必在从另一个图形对象为其分配值之前设置位图的高度和宽度。它将自动获取源对象的尺寸。

# android - 从ID中找出android控件类型

> ID：11022253
> 
> 赞同：0
> 
> 时间：2012-06-13T19:47:18.260
> 
> 标签：android, controls

我正在处理android项目，我正在循环遍历布局中的每个控件以添加到数组中，然后我将此数组传递给一个函数，该函数将遍历数组并根据控件执行一些事件。有没有办法可以确定控件类型是什么。作为伪代码，它会是这样的。

```
 void getControlType(List<View> myControls)
    {
        foreach (List<View> control in myControls)
        {
             string controlType = getControlType(control);
             if (controlType == "Button")
             {
                  //do something on the button
             }
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:50:14.010

虽然它通常不是一个好的设计模式，但这会起作用：

```
foreach (List<View> control in myControls)
{
     if (control instanceof Button)
     {
         Button button = (Button)control;
         //do something on the button
     }
} 
```

# wpf - 具有双值的帆布线条笔画粗细创建云纹效果

> ID：11022254
> 
> 赞同：1
> 
> 时间：2012-06-13T19:47:19.460
> 
> 标签：wpf, canvas, drawing, double, line

我正在尝试绘制波形。我有一个预先计算好的要绘制的数据点数量（例如 1000 个）。我想用波形填充画布控件的整个宽度。因此，我必须重新计算我绘制的每个数据点的宽度。

为此，我尝试将 StrokeThickness 设置为总宽度除以数据点的 nr。（例如 0.35629）并**每 0.35629 像素打印一条 0.35629 像素宽的线。**

**这会产生不想要的波纹效果。**

对我来说，StrokeThickness 是双倍的感觉很奇怪，因为 WPF 将如何绘制一条 0.35629 像素宽的线？

下面是一个代码示例来说明我的意思。前半部分还可以，后半部分有云纹效果。

这是要走的路还是我需要另一种方法？

```
for (int i = 0; i < 500; i++)
{
    Line line = new Line();
    line.X1 = i;
    line.X2 = i;
    line.Y1 = 0;
    line.Y2 = 100;
    line.Stroke = new SolidColorBrush(Colors.Black);
    line.StrokeThickness = 1;
    this.demoCanvas.Children.Add(line);
}

const double canvasWidth = 525;
const double nrOfDatapoints = 500d;
const double pixelsPerPoint = canvasWidth/nrOfDatapoints  ;
double x = 500;
for (int i = 0; i < nrOfDatapoints; i++)
{
    Line line = new Line();
    line.X1 = x;
    line.X2 = x;
    line.Y1 = 0;
    line.Y2 = 100;
    line.Stroke = new SolidColorBrush(Colors.Black);
    line.StrokeThickness = pixelsPerPoint;
    this.demoCanvas.Children.Add(line);
    x += pixelsPerPoint;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:35:33.440

为避免出现波纹，您应该设置 SnapToDevicePixels="True"。[在这里查看](http://msdn.microsoft.com/en-us/library/aa970908.aspx)

# google-bigquery - 使用 COUNT(DISTINCT ...) 时出现 BigQuery 错误“响应太大而无法返回”

> ID：11022256
> 
> 赞同：3
> 
> 时间：2012-06-13T19:47:26.343
> 
> 标签：google-bigquery

我有一个大约 20M 行的数据集，我正在观察以下行为。

下面的查询返回错误“响应太大而无法返回”。'id' 字段在多个记录之间共享，并且'field' 字段对每条记录都有一些任意值。我希望结果集应该只包含 10 行，远低于查询响应限制。

```
SELECT id, COUNT(DISTINCT field)
FROM [my.dataset]
GROUP BY id
LIMIT 10 
```

但是，当从 COUNT 聚合函数中删除 DISTINCT 关键字时，BigQuery 会按预期返回 10 个结果。

```
SELECT id, COUNT(field)
FROM [my.dataset]
GROUP BY id
LIMIT 10 
```

我不明白为什么第一个查询返回错误而第二个查询成功完成。两个查询不应该返回相同数量的行吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T22:01:17.053

导致此响应的不是结果大小，而是您的 COUNT DISTINCT 查询生成的数据的中间大小。

注意： COUNT DISTINCT 在 1000 个值之后返回统计近似值 - 您可以通过为 DISTINCT 将返回近似值的限制选择一个特定值来更改近似值。例如：`COUNT(DISTINCT your_field, 500)`

请参阅：[https ://developers.google.com/bigquery/docs/query-reference#aggfunctions](https://developers.google.com/bigquery/docs/query-reference#aggfunctions)

这种行为是由于 BigQuery 的设计，这使得它变得如此之快：通过单独的节点查询数据，并在混合器中聚合结果。COUNT 将计算结果的总数并组合答案，但 COUNT DISTINCT 需要跟踪潜在的数百万个单独的总和，然后再组合这些值。因此 COUNT DISTINCT 可以创建大量数据，并且可能超过单个节点的内部最大值。

另请注意，目前，BigQuery LIMIT 子句是在确定整个结果集之后应用的。

# php - $_POST 单击提交按钮时的 javascript Date() 时间

> ID：11022257
> 
> 赞同：2
> 
> 时间：2012-06-13T19:47:33.440
> 
> 标签：php, javascript, html, post

我目前正在编写一个网页，允许用户在单板嵌入式计算机上更改本地设置。我目前正在研究的一项功能是将板上的时钟与用户计算机上的时钟同步。Javascript Date() 函数允许我获取本地机器的时间，所以我使用它来获取当前时间。

我的目标是创建一个提交按钮，当按下该按钮时，它将从 javascript Date() 函数中获取确切时间，然后使用 POST 方法将该时间返回给我的 php 代码。我需要发布该值的原因是我可以运行一个 Linux 命令行程序，该程序有权更改板的时间设置。

现在，董事会正确获取时间并正确发布，但我遇到的问题是返回的时间是加载页面的时间，而不是单击提交按钮的时间。

这是一个问题，因为如果用户在网页上停留 5 分钟，然后单击该按钮，则板上的时钟将被提交 5 分钟后的时间。

我尝试通过将值分配给隐藏的输入项来发布值，该输入项成功发布，但发布的时间是页面加载时间。我尝试过的另一种方法是将javascript函数的onUnload调用添加到`<body>`标记中，但是在尝试使用相同的方法传递该时间时，该值似乎没有被发布。

以下是我目前正在使用的重要代码块：

```
<?php
echo "<form method='POST' action='".$PHP_SELF."'>";

if (isset($_POST['getLocalTime']))
{
    echo $_POST['localTime'].'<br>';
    $setLocalTime = "My Commandline String";
    exec($setLocalTime);
}
?>

<input type="hidden" id="localTime" name="localTime">

<script language='JavaScript'>
var date = new Date();
var d = date.getUTCDate();
var day = (d < 10) ? '0' + d : d;
var m = date.getUTCMonth() + 1;
var month = (m < 10) ? '0' + m : m;
var year = date.getUTCFullYear();
var h = date.getUTCHours();
var hour = (h < 10) ? '0' + h : h;
var mi = date.getUTCMinutes();
var minute = (mi < 10) ? '0' + mi : mi;
var sc = date.getUTCSeconds();
var second = (sc < 10) ? '0' + sc : sc;
var loctime = month + day + hour + minute + year + "." + second;

document.getElementById('localTime').value = loctime;
</script>

<?php
echo "<pre>";
print_r($_POST);
echo "</pre>";
?>

<input class="button" type="submit" name="getLocalTime" value="Copy Local Time">
</form> 
```

我很感激可以给出的任何建议，并在此先感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T19:53:37.780

您应该将脚本放在一个函数中，并使用表单对象的 onSubmit 运行该函数。

在您的表单定义中：

```
echo "<form method='POST' action='".$PHP_SELF."' onsubmit='getTime();'>"; 
```

对于 javascript：

```
<script language='JavaScript'>
function getTime(){
var date = new Date();
var d = date.getUTCDate();
var day = (d < 10) ? '0' + d : d;
var m = date.getUTCMonth() + 1;
var month = (m < 10) ? '0' + m : m;
var year = date.getUTCFullYear();
var h = date.getUTCHours();
var hour = (h < 10) ? '0' + h : h;
var mi = date.getUTCMinutes();
var minute = (mi < 10) ? '0' + mi : mi;
var sc = date.getUTCSeconds();
var second = (sc < 10) ? '0' + sc : sc;
var loctime = month + day + hour + minute + year + "." + second;

document.getElementById('localTime').value = loctime;
}
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:09:46.500

发生这种情况是因为您在呈现页面时声明了变量`loctime`，您需要在提交时执行此操作。

基本上你想将你的javascript包装在一个函数中并在提交时调用它。无需对代码进行太多更改，您可以这样做：

```
<?php
echo "<form method='POST' onsubmit='getTime();' action='".$PHP_SELF."'>";

if (isset($_POST['getLocalTime']))
{
    echo $_POST['localTime'].'<br>';
    $setLocalTime = "My Commandline String";
    exec($setLocalTime);
}
?>

<input type="hidden" id="localTime" name="localTime">

<script language='JavaScript'>
function getTime() {
  var date = new Date();
  var d = date.getUTCDate();
  var day = (d < 10) ? '0' + d : d;
  var m = date.getUTCMonth() + 1;
  var month = (m < 10) ? '0' + m : m;
  var year = date.getUTCFullYear();
  var h = date.getUTCHours();
  var hour = (h < 10) ? '0' + h : h;
  var mi = date.getUTCMinutes();
  var minute = (mi < 10) ? '0' + mi : mi;
  var sc = date.getUTCSeconds();
  var second = (sc < 10) ? '0' + sc : sc;
  var loctime = month + day + hour + minute + year + "." + second;

  document.getElementById('localTime').value = loctime;
}
</script>

<?php
echo "<pre>";
print_r($_POST);
echo "</pre>";
?>

<input class="button" type="submit" name="getLocalTime" value="Copy Local Time">
</form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T19:54:02.977

```
<?php
echo "<form id="loctimeform" method='POST' action='".$PHP_SELF."'>";

if (isset($_POST['getLocalTime']))
{
    echo $_POST['localTime'].'<br>';
    $setLocalTime = "My Commandline String";
    exec($setLocalTime);
}
?>

<input type="hidden" id="localTime" name="localTime">
</form>

<script language='JavaScript'>

function doGetLocTime() {

var date = new Date();
var d = date.getUTCDate();
var day = (d < 10) ? '0' + d : d;
var m = date.getUTCMonth() + 1;
var month = (m < 10) ? '0' + m : m;
var year = date.getUTCFullYear();
var h = date.getUTCHours();
var hour = (h < 10) ? '0' + h : h;
var mi = date.getUTCMinutes();
var minute = (mi < 10) ? '0' + mi : mi;
var sc = date.getUTCSeconds();
var second = (sc < 10) ? '0' + sc : sc;
var loctime = month + day + hour + minute + year + "." + second;

document.getElementById('localTime').value = loctime;

}

function doSubmitForm() {
  doGetLocTime();
  document.getElementById('loctimeform').submit();
}

</script>

<?php
echo "<pre>";
print_r($_POST);
echo "</pre>";
?>

<input class="button" type="button" name="getLocalTime" value="Copy Local Time" onclick="doSubmitForm();"> 
```

# symfony - 加载学说装置

> ID：11022260
> 
> 赞同：1
> 
> 时间：2012-06-13T19:47:41.917
> 
> 标签：symfony

我正在尝试使用以下命令生成固定装置：

```
php app/console generate:fixtures:load 
```

它给了我这个错误：

```
The autoloader expected class "Doctrine\Bundle\DoctrineFixturesBundle\Doctrine
FixturesBundle" to be defined in file "C:\wamp\www\SymfonyV1\app/../vendor/Bundl
es\Doctrine\Bundle\DoctrineFixturesBundle\DoctrineFixturesBundle.php". The file
was found but the class was not in it, the class name or namespace probably has
a typo. 
```

我检查了那里的课程。

请问你知道怎么解决吗？？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T13:01:35.110

您必须将您的捆绑包移动到

```
App\vendor\bundles\Doctrine\Bundle\FixturesBundle\Doctrine 
```

并将其声明为您的 appKernel ：

```
new Doctrine\Bundle\FixturesBundle\DoctrineFixturesBundle(), 
```

此更改是由于从 Symfony 文件夹移动到 Doctrine 的教义2

[https://github.com/doctrine/DoctrineFixturesBundle/issues/22](https://github.com/doctrine/DoctrineFixturesBundle/issues/22)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T16:29:23.520

我认为这与 DoctrineFixtures 捆绑包正在从 Symfony 移动到 github 上的 Doctrine 相关联。当我更新到 2.0.15 时，这让我有点困惑。

DoctrineFixturesBundle.php 文件应该位于 vendor/bundles/Symfony/Bundle/DoctrineFixturesBundle/ 并具有命名空间 Symfony\Bundle\DoctrineFixturesBundle。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:14:15.297

该错误是不言自明的。您是否忘记在类文件中添加正确的命名空间声明？

# android - 试图让 Android WebView 正确缩放

> ID：11022263
> 
> 赞同：1
> 
> 时间：2012-06-13T19:47:48.163
> 
> 标签：android, android-webview

我需要能够显示具有缩放和滚动功能的图像。由于 ImageView 看起来有点乏味，所以我使用 WebView 来加载本地图像然后显示它。这是我当前的代码：

```
 WebView image = (WebView)findViewById(R.id.image);
    image.getSettings().setBuiltInZoomControls(true);
    image.getSettings().setLoadWithOverviewMode(true);
    image.getSettings().setUseWideViewPort(true);
    image.setInitialScale(40);
    image.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT,LinearLayout.LayoutParams.WRAP_CONTENT));
    image.loadUrl("file:///android_asset/image.png"); 
```

虽然这会加载图像，但我无法让它只显示图像。因为 setUseWideViewPort(true) 让它一直向外缩放宽度，所以它下面总是有相当数量的空白。

关于允许它只滚动加载的图像有什么建议吗？谢谢。我也试过 setDefaultZoom 并不能让它走得足够远。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:56:38.787

我认为在您的 setInitialScale 方法中使用静态百分比 40 是不错的，但是，它没有考虑到屏幕密度或大小。目前你的 40 意味着你被缩放到实际大小的 40%。

想一想，当您仅在 PC 上的 Web 浏览器中打开图像时，它的响应方式基本相同，将其放在左上角。是的，您可以使用 WebView 对其进行缩放，但在这种情况下，要使其适用于所有平台，您必须根据屏幕分辨率减去任何相关的边界矩形（Android 案例中的顶部和底部）来计算缩放因子到图像的实际宽度和高度。

我建议你回到 ImageView ！

# ruby-on-rails-3 - Rails：ActiveRecord::RecordNotFound，找不到 id=num

> ID：11022264
> 
> 赞同：0
> 
> 时间：2012-06-13T19:47:54.480
> 
> 标签：ruby-on-rails-3, activerecord

我的 Ruby on Rails 应用程序中有两个模型：User 和 Bookcase。我为每个书柜提供了一个编辑链接，但是当我点击这些链接时，我遇到了一个错误：

```
ActiveRecord::RecordNotFound in BookcasesController#edit
Couldn't find User with id=19 
```

（请注意，它要求提供用户 ID。此外，值得注意的是 Bookcases belongs_to Users。）

这是我用来创建链接的片段：

```
<%= link_to "edit", edit_bookcase_path(bookcase.id) %> 
```

如果您需要任何进一步的代码，请告诉我，我会发布它！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:19:52.860

据我所知，如果您在 EDIT 方法中的 BookcasesController 中，则不应调用用户，而应调用 BookCase，如下所示：

```
@bookcase = BookCase.find(params[:id]) // WHAT YOU WANT 
```

看来您有此代码，这给了您错误：

```
@bookcase = User.find(params[:id]) // NOT WHAT YOU WANT 
```

这将返回 ID 为 19 的 BookCase，它应该属于用户。如果您需要访问该书所属的用户，您可以这样做：

```
@user = @bookcase.user 
```

此外，您可以只使用编辑链接，而无需 id 调用：

```
<%= link_to "edit", edit_bookcase_path(bookcase) %> 
```

# c# - 如何使用 MongoDB 和 C# 驱动程序查询数组是否为空或空？

> ID：11022265
> 
> 赞同：6
> 
> 时间：2012-06-13T19:48:00.570
> 
> 标签：c#, linq, mongodb, mongodb-.net-driver

**背景：**

如果记录上的特定数组为空或为空，我需要完成的是删除集合中的任何记录。

我了解查找空数组的 C# 驱动程序查询是：

```
IMongoQuery query = Query.Exists("myArray", false); 
```

这对于检测空数组很好，但有时数组不会为空，但不会有任何元素。我需要的更像是：

```
// Note: second subquery will not work
IMongoQuery query = Query.Or(
    Query.Exists("myArray", false),
    Query.IsEmpty("myArray", false) // error
); 
```

**模型：**

我的课看起来像：

```
public class MyClass
{
    // This property may be null or empty
    [BsonElement("myArray")]
    public string[] MyArray { get; set; }

    [BsonElement("someElement")]
    public int SomeElement{ get; set; }

} 
```

**概括：**

1.  我应该使用什么 C# 驱动程序方法来查询数组是否为空？
2.  或者，检查数组是否为空或为空的最佳方法是什么？

对此的任何帮助将不胜感激！:)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-13T21:02:45.543

您正在寻找 $size 运算符。

`Query.Size("myArray", 0)`如果数组为空，则为真。

[http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24size](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24size)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-19T05:08:20.693

$exists 仅匹配不存在的字段。如果一个字段存在，但它的值为 null (BSON null)，那么这些字段与 $exists 不匹配。[http://docs.mongodb.org/manual/reference/operator/query/exists/](http://docs.mongodb.org/manual/reference/operator/query/exists/)

但是，在两种情况下都检查字段值是否与空匹配：该字段不存在，并且该字段值为空。[http://docs.mongodb.org/manual/faq/developers/#faq-developers-query-for-nulls](http://docs.mongodb.org/manual/faq/developers/#faq-developers-query-for-nulls)

所以，在这种情况下。它应该是两个条件的 OR 条件： 1\. field: null 2\. field size =0;

{ "$or" : [ { "MyArray" : { "$size" : 0}} , { "MyArray" : null }]}

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-11-09T03:33:23.873

请注意，`$size` [不能使用索引](https://docs.mongodb.com/manual/reference/operator/query/size/)并且`$or`也有一些[与索引相关的限制](https://docs.mongodb.com/manual/reference/operator/query/or/#or-clauses-and-indexes)。我发现以下是查询具有空数组或未设置数组的文档的好方法，同时避免了 $or 和 $size 的限制。而且还很短！:)

`{myArray: {$in: [null, []]}}`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-10T06:50:58.680

要在 MongoDb 集合中查找空白数组字段，请在 Mongo shell 中使用以下查询 `db.COLLECTION.find({ myArray: [] }).pretty();`

使用您的数据库集合名称更改 COLLECTION。

# java - 使用 lambdaj 进行不区分大小写的过滤

> ID：11022266
> 
> 赞同：0
> 
> 时间：2012-06-13T19:48:01.227
> 
> 标签：java, lambda, matcher, hamcrest, lambdaj

我正在尝试让自己熟悉 lambdaj，但不确定如何最好地解决这个问题。给定以下测试：

```
@Test
public void test() {
  final List<String> l1 = new ArrayList<>();
  final List<String> l2 = new ArrayList<>();

  l1.add("same");
  l1.add("Upper");
  l1.add("lower");

  l2.add("same");
  l2.add("upper");
  l2.add("lower");
  l2.add("extra");

  final List<String> l3 = Lambda.filter(Matchers.not(Matchers.isIn(l1)), l2);
  Assert.assertThat("There should be one item in l3", l3.size(), Matchers.equalTo(1));
} 
```

我怎样才能让 Matcher 不关心大小写？即，无论大小写如何，我都想要一个不在 l1 中的 l2 中的项目列表？我宁愿不必运行另一个 Lambda 来将每个字符串列表转换为相同的大小写，而是一种修改 Matcher 以按照我的意愿进行操作的方法。这是可能的还是我必须先将这些项目转换为相同的情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:02:26.623

这对我有用：

```
import static org.hamcrest.text.IsEqualIgnoringCase.equalToIgnoringCase;
//..
List<String> allJedis = asList("Luke","Obiwan","Yoda");
List<String> someJedis = filter(equalToIgnoringCase("obiwan"), allJedis);
System.out.println(someJedis); 
```

输出是`[Obiwan]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-07T09:50:49.953

希望这个答案可以帮助你：

```
 List<String> convert = convert(list1, new Converter<String, String>() {
        @Override
        public String convert(String from) {
            return from.toLowerCase();
        }
    });
    List<String> filter2 = filter(isIn(list2), convert);

    System.out.println("filter2 -> " + filter2);
    // filter2 -> [same, upper, lower] 
```

# php - 如果不是来自某些引用者 PHP，则限制访问

> ID：11022275
> 
> 赞同：3
> 
> 时间：2012-06-13T19:49:00.687
> 
> 标签：php, restrict, referer

**我正在绞尽脑汁想为什么这不起作用。**

我想要实现的是限制对我自己网站上的页面的访问，只有来自某个网​​站，例如 Facebook。

由于链接将发布在 1 个或多个 Facebook 页面和/或我的个人资料上，因此如果来自 Facebook 和/或发布它的任何其他“页面”，希望脚本能够执行。

例如，如果我在**www.facebook.com/This_is_my_PAGE**上发布我的链接或在我的个人资料**www.facebook.com/freds_personal_profile**上发布我的链接，或者有人在 Facebook 上分享我的链接，我希望该页面仅供来自 Facebook 的人访问领域。

我在搜索解决方案时找到了下面的脚本，但它正在回显我的错误消息，而不是重定向到有问题的链接。

```
$target_site = 'https://www.facebook.com/';
if (isset($_SERVER['HTTP_REFERER']) && preg_match("/$target_site/",$_SERVER['HTTP_REFERER'])) {
// do something with people from facebook.com
} 

else {
// do something else with everyone else

echo "Sorry, viewable to Facebook fans only.";

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T19:54:08.827

首先，您的代码存在缺陷，因为：

*   如果用户没有使用 Facebook 的“安全版本”（http 而不是 https）怎么办？
*   如果用户来自`facebook.com`而不是`www.facebook.com`怎么办？
*   如果恶意用户正在诱使用户进入类似的网站`http://example.com/evilpage.php?https://www.facebook.com/`怎么办？

它不起作用的主要原因是您的正则表达式完全无效。相反，它应该遵循以下原则：

```
preg_match("/".preg_quote($target_site,"/")."/i",$_SERVER['HTTP_REFERER']); 
```

（[关于文档`preg_quote()`](http://php.net/preg-quote)）

除此之外，检查推荐人没有安全性。它可以更改，可以完全阻止。它不应该被依赖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T19:53:14.643

Facebook 将外部链接连接到`http`协议，而不是`https`. 将您的目标站点更改为：

```
$target_site = 'http://www.facebook.com/'; 
```

您可以通过右键单击 facebook 中发布的链接并将其复制到剪贴板（然后粘贴）来确认这一点。你会看到它看起来像这样：

```
`http://www.facebook.com/l.php?u=...` 
```

无论您实际上是使用`https`或浏览，情况都是如此`http`。

# spring - Spring 两个事务管理器，相同的数据源不同的实现

> ID：11022276
> 
> 赞同：0
> 
> 时间：2012-06-13T19:49:05.980
> 
> 标签：spring

我们使用带有 AOP 的 Spring 3.0.5 来处理我们的事务。

我们已经创建了一个 WebLogicJtaTransactionManager 实例，并在该服务下调用的所有方法上创建了切入点（如 SessionFacade ......但这些不是 ejb）。

稍后在代码中，有人从 Spring Batch 教程中剪切/粘贴代码并创建了一个 JtaTransactionManager 并切入了该 Repository 类的所有方法。

这会导致两个不同实现类的事务管理器出现问题（即使 WebLogicJtaTransactionManager 扩展了 JtaTransactionManager）？

如果外部 WebLogicJtaTransactionManager 启动一个 REQUIRED 事务，然后 JtaTransactionManager 启动一个 REQUIRED，它们本质上会在同一个事务线程上吗？

# xml - 用 XML 表示 C:\Program Files

> ID：11022279
> 
> 赞同：1
> 
> 时间：2012-06-13T19:49:21.307
> 
> 标签：xml, error-handling, path, escaping, cdata

在我的 XML 文件中，我尝试使用文件路径；它是这样开始的：

```
<value key="myPath"><![CDATA[C:\Program Files\myFile.exe]]> 
```

然后，当我启动我的应用程序时，它总是说，找不到文件：

> 找不到文件 C:\Program

所以，显然它仍然被困在程序和文件之间的空间中。我以为我的 CDATA 会解决这个问题。

我错到什么程度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:51:49.650

尝试在路径周围放置双引号。

```
<value key="myPath"><![CDATA["C:\Program Files\myFile.exe"]]> 
```

如果您想进一步清理它，您可能也不需要使用 CDATA。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T19:52:01.060

这可能不是 XML，它可能是您的应用程序在空格后终止。

几种可能

*   用引号“”包裹你的路径
*   转义空格 C:\Program\ Files
*   URL 编码从空格到 %20 的空格

如果没有更多关于如何执行 XML 的信息，很难说。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T19:54:01.260

默认情况下，XML 不会弄乱您的空格。它也不关心文件扩展名之前的退格、冒号或点。实际上，大多数有效路径字符也是有效的 XML 字符。（我认为它们实际上都是有效的 XML 文本节点内容。）

问题肯定出在 XML 处理上，而不是 XML 内容上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-14T07:52:16.870

如果我正在设计这个应用程序，我会存储 URI 而不是文件名。在通常使用 XML 的世界中，这似乎是正确的方法。当然，您可以在 XML 中存储您喜欢的任何内容，如果需要存储 Windows 文件名，那么欢迎您这样做。

它不起作用的事实与 XML 无关。从 XML 中提取文件名并尝试打开文件的接收应用程序做错了：它要么弄乱了文件名本身，要么将其传递给无法处理包含空格的文件名的 API。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T19:04:35.030

你可以使用`&quote;Path%quote;`技术。很脏，但工作正常，

# c# - 跟踪 WCF REST 服务错误

> ID：11022280
> 
> 赞同：1
> 
> 时间：2012-06-13T19:49:25.450
> 
> 标签：c#, .net, wcf, rest, iis-7

这个问题来自我在客户端看到的内容：[Intermittent Connection Reset by Peer errors in Android connected to .NET REST endpoint](https://stackoverflow.com/questions/11021551/intermittent-connection-reset-by-peer-errors-in-android-connecting-to-net-rest)

简单地说，我怀疑我的 WCF 服务出于某种原因会间歇性地拒绝客户端。我想知道是否有任何方法可以记录这些拒绝？我什至不确定这是否发生在 WCF 级别，也许它在路由到 WCF 之前发生在 IIS 本身中？

我想知道如何为到达我的 WCF 端点的请求记录任何错误。在 WCF 内部没有问题，我记录了抛出的任何类型的异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:02:30.070

正如您在此链接上看到的那样：http: [//msdn.microsoft.com/en-us/library/ms733025.aspx](http://msdn.microsoft.com/en-us/library/ms733025.aspx) 使用配置的 system.diagnostics 部分，您可以配置您的服务以跟踪执行的所有操作以完成操作。此参数：initializeData="c:\log\Traces.svclog" /> 是保存跟踪信息的文件位置。

# c++ - cs106b 库 vector.cpp 错误 C2143：语法错误：缺少“；” 在'<'之前

> ID：11022281
> 
> 赞同：-1
> 
> 时间：2012-06-13T19:49:26.437
> 
> 标签：c++, vector

关系到`Vector<ElemType>::Vector(int capacity)`

*   C2143：语法错误：缺少“；” 在'<'之前
*   C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数
*   C2988：无法识别的模板声明/定义
*   C2059：语法错误：'<'

关系到`Vector<ElemType>::~Vector()`

*   C2588: '::~Vector' : 非法的全局析构函数

```
/*
 * File: private/vector.cpp
 * Last modified on Fri Jun  5 16:19:42 2009 by eroberts
 * -----------------------------------------------------
 * This file contains the implementation of the vector.h interface.
 * Because of the way C++ compiles templates, this code must be
 * available to the compiler when it reads the header file.
 */

#ifdef _vector_h

#include "stdafx.h"

/*
 * Vector class implementation
 * ---------------------------
 * The Vector is internally managed as a dynamic array of elements.
 * It tracks capacity (numAllocated) separately from size (numUsed).
 * All access is bounds-checked for safety.
 */

template <typename ElemType>
Vector<ElemType>::Vector(int capacity) {
    elements = new ElemType[capacity];
    numAllocated = capacity;
    numUsed = 0;
    timestamp = 0L;
}

template <typename ElemType>
Vector<ElemType>::~Vector() {
    if (elements != NULL) delete[] elements;
}

template <typename ElemType>
inline int Vector<ElemType>::size() {
    return numUsed;
}

template <typename ElemType>
bool Vector<ElemType>::isEmpty() {
    return size() == 0;
}

template <typename ElemType>
ElemType Vector<ElemType>::getAt(int index) {
    checkRange(index, "getAt");
    return elements[index];
}

template <typename ElemType>
void Vector<ElemType>::setAt(int index, ElemType elem) {
    checkRange(index, "setAt");
    elements[index] = elem;
}

/* Private method: checkRange
 * --------------------------
 * Verifies that index is in range for this vector, if not, raises an
 * error.  The verb string is used in the error message to describe the
 * operation that caused the range error, .e.g "setAt" or "removeAt".
 */

template <typename ElemType>
inline void Vector<ElemType>::checkRange(int index, const char *verb) {
    if (index < 0 || index >= size()) {
        Error("Attempt to " + string(verb) + " index "
              + IntegerToString(index) + " in a vector of size "
              + IntegerToString(size()) + ".");
    }
}

template <typename ElemType>
inline ElemType &Vector<ElemType>::operator[](int index) {
    checkRange(index, "access");
    return elements[index];
}

template <typename ElemType>
void Vector<ElemType>::add(ElemType elem) {
    insertAt(numUsed, elem);
}

template <typename ElemType>
void Vector<ElemType>::insertAt(int index, ElemType elem) {
    if (numAllocated == numUsed) enlargeCapacity();
    if (index != numUsed) checkRange(index, "insertAt");
    for (int i = numUsed; i > index; i--) {
        elements[i] = elements[i-1];
    }
    elements[index] = elem;
    numUsed++;
    timestamp++;
}

template <typename ElemType>
void Vector<ElemType>::removeAt(int index) {
    checkRange(index, "removeAt");
    for (int i = index; i < numUsed-1; i++) {
        elements[i] = elements[i+1];
    }
    numUsed--;
    timestamp++;
}

template <typename ElemType>
void Vector<ElemType>::clear() {
    delete[] elements;
    elements = NULL;
    numUsed = numAllocated = 0;
    timestamp++;
}

template <typename ElemType>
const Vector<ElemType> &Vector<ElemType>::operator=(const Vector & rhs) {
    if (this != &rhs) {
        clear();
        copyInternalData(rhs);
        timestamp = 0L;
    }
    return *this;
}

template <typename ElemType>
Vector<ElemType>::Vector(const Vector & rhs) {
    copyInternalData(rhs);
    timestamp = 0L;
}

template <typename ElemType>
void Vector<ElemType>::mapAll(void (*fn)(ElemType)) {
    long t0 = timestamp;
    for (int i = 0; i < numUsed; i++) {
        if (timestamp != t0) {
            Error("Vector structure has been modified");
        }
        fn(elements[i]);
    }
}

template <typename ElemType>
template <typename ClientDataType>
void Vector<ElemType>::mapAll(void (*fn)(ElemType, ClientDataType&),
                              ClientDataType & data) {
    long t0 = timestamp;
    for (int i = 0; i < numUsed; i++) {
        if (timestamp != t0) {
            Error("Vector structure has been modified");
        }
        fn(elements[i], data);
    }
}

/*
 * Vector::Iterator class implementation
 * ----------------------------------
 * The Iterator for Vector maintains a pointer to the original Vector and
 * an index into that vector that identifies the next element to return.
 */

template <typename ElemType>
Vector<ElemType>::Iterator::Iterator() {
    vp = NULL;
}

template <typename ElemType>
typename Vector<ElemType>::Iterator Vector<ElemType>::iterator() {
    return Iterator(this);
}

template <typename ElemType>
Vector<ElemType>::Iterator::Iterator(Vector *vecRef) {
    vp = vecRef;
    curIndex = 0;
    timestamp = vp->timestamp;
}

template <typename ElemType>
bool Vector<ElemType>::Iterator::hasNext() {
    if (vp == NULL) Error("hasNext called on uninitialized iterator");
    if (timestamp != vp->timestamp) {
        Error("Vector structure has been modified");
    }
    return curIndex < vp->size();
}

template <typename ElemType>
ElemType Vector<ElemType>::Iterator::next() {
    if (vp == NULL) Error("next called on uninitialized iterator");
    if (!hasNext()) {
        Error("Attempt to get next from iterator"
              " where hasNext() is false");
    }
    return (*vp)[curIndex++];
}

template <typename ElemType>
ElemType Vector<ElemType>::foreachHook(FE_State & fe) {
    if (fe.state == 0) fe.iter = new Iterator(this);
    if (((Iterator *) fe.iter)->hasNext()) {
        fe.state = 1;
        return ((Iterator *) fe.iter)->next();
    } else {
        fe.state = 2;
        return ElemType();
    }
}

/* Private method: enlargeCapacity
 * -------------------------------
 * Doubles the current capacity of the vector's internal storage,
 * copying all existing values.
 */

template <typename ElemType>
void Vector<ElemType>::enlargeCapacity() {
    numAllocated = (numAllocated == 0 ? 10 : numAllocated*2);
    ElemType *newArray = new ElemType[numAllocated];
    for (int i = 0; i < numUsed; i++) {
        newArray[i] = elements[i];
    }
    delete[] elements;
    elements = newArray;
}

/* Private method: copyInternalData
 * --------------------------------
 * Common code factored out of the copy constructor and operator= to
 * copy the contents from the other vector.
 */

template <typename ElemType>
void Vector<ElemType>::copyInternalData(const Vector & other) {
    elements = new ElemType[other.numUsed];
    for (int i = 0; i < other.numUsed; i++) {
        elements[i] = other.elements[i];
    }
    numUsed = other.numUsed;
    numAllocated = other.numUsed;
}

#endif 
```

向量类定义示例

```
/*
 * File: set.h
 * Last modified on Thu Jun 11 09:17:43 2009 by eroberts
 *      modified on Tue Jan  2 14:34:06 2007 by zelenski
 * -----------------------------------------------------
 * This interface file contains the Set class template, a
 * collection for efficiently storing a set of distinct elements.
 */

#ifndef _set_h
#define _set_h

#include "cmpfn.h"
#include "bst.h"
#include "vector.h"
#include "foreach.h"

/*
 * Class: Set
 * ----------
 * This interface defines a class template that stores a collection of
 * distinct elements, using a sorted relation on the elements to
 * provide efficient managaement of the collection.
 * For maximum generality, the Set is supplied as a class template.
 * The element type is determined by the client. The client configures
 * the set to hold values of a specific type, e.g. Set<int> or
 * Set<studentT>. The one requirement on the element type is that the
 * client must supply a comparison function that compares two elements
 * (or be willing to use the default comparison function that uses
 * the built-on operators  < and ==).
 */

template <typename ElemType>
class Set {

public:

/* Forward references */
    class Iterator;

/*
 * Constructor: Set
 * Usage: Set<int> set;
 *        Set<student> students(CompareStudentsById);
 *        Set<string> *sp = new Set<string>;
 * -----------------------------------------
 * The constructor initializes an empty set. The optional
 * argument is a function pointer that is applied to
 * two elements to determine their relative ordering. The
 * comparison function should return 0 if the two elements
 * are equal, a negative result if first is "less than" second,
 * and a positive resut if first is "greater than" second. If
 * no argument is supplied, the OperatorCmp template is used as
 * a default, which applies the bulit-in < and == to the
 * elements to determine ordering.
 */
    Set(int (*cmpFn)(ElemType, ElemType) = OperatorCmp);

/*
 * Destructor: ~Set
 * Usage: delete sp;
 * -----------------
 * The destructor deallocates  storage associated with set.
 */
    ~Set();

/*
 * Method: size
 * Usage: count = set.size();
 * --------------------------
 * This method returns the number of elements in this set.
 */
    int size();

/*
 * Method: isEmpty
 * Usage: if (set.isEmpty())...
 * ----------------------------
 * This method returns true if this set contains no
 * elements, false otherwise.
 */
    bool isEmpty();

/*
 * Method: add
 * Usage: set.add(value);
 * ----------------------
 * This method adds an element to this set. If the
 * value was already contained in the set, the existing entry is
 * overwritten by the new copy, and the set's size is unchanged.
 * Otherwise, the value is added and set's size increases by one.
 */
    void add(ElemType elem);

/*
 * Method: remove
 * Usage: set.remove(value);
 * -----------------------
 * This method removes an element from this set. If the
 * element was not contained in the set, the set is unchanged.
 * Otherwise, the element is removed and the set's size decreases
 * by one.
 */
    void remove(ElemType elem);

/*
 * Method: contains
 * Usage: if (set.contains(value))...
 * -----------------------------------
 * Returns true if the element in this set, false otherwise.
 */
    bool contains(ElemType elem);

/*
 * Method: find
 * Usage: eptr = set.find(elem);
 * -----------------------------
 * If the element is contained in this set, returns a pointer
 * to that elem.  The pointer allows you to update that element
 * in place. If element is not contained in this set, NULL is
 * returned.
 */
    ElemType *find(ElemType elem);

/*
 * Method: equals
 * Usage: if (set.equals(set2)) . . .
 * -----------------------------------
 * This predicate function implements the equality relation
 * on sets.  It returns true if this set and set2 contain
 * exactly the same elements, false otherwise.
 */
    bool equals(Set & otherSet);

/*
 * Method: isSubsetOf
 * Usage: if (set.isSubsetOf(set2)) . . .
 * --------------------------------------
 * This predicate function implements the subset relation
 * on sets.  It returns true if all of the elements in this
 * set are contained in set2\.  The set2 does not have to
 * be a proper subset (that is, it may be equals).
 */
    bool isSubsetOf(Set & otherSet);

/*
 * Methods: unionWith, intersectWith, subtract
 * Usage: set.unionWith(set2);
 *        set.intersectWith(set2);
 *        set.subtract(set2);
 * -------------------------------
 * These fmember unctions modify the receiver set as follows:
 *
 * set.unionWith(set2);      Adds all elements from set2 to this set.
 * set.intersectWith(set2);  Removes any element not in set2 from this set.
 * set.subtract(set2);       Removes all element in set2 from this set.
 */
    void unionWith(Set & otherSet);
    void intersectWith(Set & otherSet);
    void subtract(Set & otherSet);

/*
 * Method: clear
 * Usage: set.clear();
 * -------------------
 * This method removes all elements from this set. The
 * set is made empty and will have size() = 0 after being cleared.
 */
    void clear();

/*
 * SPECIAL NOTE: mapping/iteration support
 * ---------------------------------------
 * The set supports both a mapping operation and an iterator which
 * allow the client access to all elements one by one.  In general,
 * these  are intended for _viewing_ elements and can behave
 * unpredictably if you attempt to modify the set's contents during
 * mapping/iteration.
 */

/*
 * Method: mapAll
 * Usage: set.mapAll(Print);
 * -------------------------
 * This method iterates through this set's contents
 * and calls the function fn once for each element.
 */
    void mapAll(void (*fn)(ElemType elem));

/*
 * Method: mapAll
 * Usage: set.mapAll(PrintToFile, outputStream);
 * --------------------------------------------
 * This method iterates through this set's contents
 * and calls the function fn once for each element, passing
 * the element and the client's data. That data can be of whatever
 * type is needed for the client's callback.
 */
    template <typename ClientDataType>
    void mapAll(void (*fn)(ElemType elem, ClientDataType & data),
                ClientDataType & data);

/*
 * Method: iterator
 * Usage: iter = set.iterator();
 * -----------------------------
 * This method creates an iterator that allows the client to
 * iterate through the elements in this set.  The elements are
 * returned in the order determined by the comparison function.
 *
 * The idiomatic code for accessing elements using an iterator is
 * to create the iterator from the collection and then enter a loop
 * that calls next() while hasNext() is true, like this:
 *
 *     Set<int>::Iterator iter = set.iterator();
 *     while (iter.hasNext()) {
 *         int value = iter.next();
 *         . . .
 *     }
 *
 * This pattern can be abbreviated to the following more readable form:
 *
 *     foreach (int value in set) {
 *         . . .
 *     }
 *
 * To avoid exposing the details of the class, the definition of the
 * Iterator class itself appears in the private/set.h file.
 */
    Iterator iterator();

private:

#include "private/set.h"

};

#include "private/set.cpp"

#endif 
```

此类[Vector](http://www.stanford.edu/class/cs106x/documentation/vector_8h.html)是库的标准组件，因此应该编译 - 直觉是缺少头文件或编译器设置错误。我从[sourceforge CS106B 库中获得了这个副本](http://sourceforge.net/projects/progabstrlib/files/)

此外，这里是 vector.h 公共和私人文件

```
/*
 * File: private/vector.h
 * Last modified on Fri Jun  5 15:39:26 2009 by eroberts
 * -----------------------------------------------------
 * This file contains the private section of the vector.h interface.
 * This portion of the class definition is taken out of the vector.h
 * header so that the client need not have to see all of these
 * details.
 */

public:

/*
 * Class: Vector<ElemType>::Iterator
 * ---------------------------------
 * This interface defines a nested class within the Vector template that
 * provides iterator access to the Vector contents.
 */
    class Iterator : public FE_Iterator {
    public:
        Iterator();
        bool hasNext();
        ElemType next();

    private:
        Iterator(Vector *vecRef);
        Vector *vp;
        int curIndex;
        long timestamp;
        friend class Vector;
    };
    friend class Iterator;
    ElemType foreachHook(FE_State & _fe);

/*
 * Deep copying support
 * --------------------
 * This copy constructor and operator= are defined to make a
 * deep copy, making it possible to pass/return vectors by value
 * and assign from one vector to another. The entire contents of
 * the vector, including all elements, are copied. Each vector
 * element is copied from the original vector to the copy using
 * assignment (operator=). Making copies is generally avoided
 * because of the expense and thus, vectors are typically passed
 * by reference, however, when a copy is needed, these operations
 * are supported.
 */
    const Vector & operator=(const Vector & rhs);
    Vector(const Vector & rhs);

private:
    ElemType *elements;
    int numAllocated, numUsed;
    long timestamp;

    void checkRange(int index, const char *msg);
    void enlargeCapacity();
    void copyInternalData(const Vector & other); 
```

和

```
/*
 * File: vector.h
 * Last modified on Fri Jun  5 15:35:35 2009 by eroberts
 *      modified on Tue Jan  2 13:56:15 2007 by zelenski
 * -----------------------------------------------------
 * This interface file contains the Vector class template, an
 * efficient, safer, convenient replacement for the built-in array.
 */

#ifndef _vector_h
#define _vector_h

#include "genlib.h"
#include "strutils.h"
#include "foreach.h"

/*
 * Class: Vector
 * -------------
 * This interface defines a class template that stores a homogeneous
 * indexed collection. The basic operations are similar to those
 * in the built-in array type, with the added features of dynamic
 * memory management, bounds-checking on indexes, and convenient
 * insert/remove operations. Like an array, but better!
 * For maximum generality, the Vector is supplied as a class template.
 * The client specializes the vector to hold values of a specific
 * type, e.g. Vector<int> or Vector<studentT>, as needed
 */

template <typename ElemType>
class Vector {

public:

/* Forward references */
    class Iterator;

/*
 * Constructor: Vector
 * Usage: Vector<int> vec;
 *        Vector<student> dormlist(200);
 *        Vector<string> *vp = new Vector<string>;
 * -----------------------------------------------
 * The constructor initializes a new empty vector. The optional
 * argument is a hint about the expected number of elements that
 * this vector will hold, which allows vector to configure itself
 * for that capacity during initialization.  If not specified,
 * it is initialized with default capacity and grows as elements
 * are added. Note that capacity does NOT mean size, a newly
 * constructed vector always has size() = 0\. A large starting
 * capacity allows you to add that many elements without requiring
 * any internal reallocation. The explicit keyword is required to
 * avoid accidental construction of a vector from an int.
 */
    explicit Vector(int sizeHint = 0);

/*
 * Destructor: ~Vector
 * Usage: delete vp;
 * -----------------
 * The destructor deallocates storage associated with this vector.
 */
    ~Vector();

/*
 * Method: size
 * Usage: nElems = vec.size();
 * ---------------------------
 * This method returns the number of elements in
 * this vector.
 */
    int size();

/*
 * Method: isEmpty
 * Usage: if (vec.isEmpty())...
 * -----------------------------
 * This method returns true if this vector contains no
 * elements, false otherwise.
 */
    bool isEmpty();

/*
 * Method: getAt
 * Usage: val = vec.getAt(3);
 * --------------------------
 * This method returns the element at the specified index
 * in this vector. Elements are indexed starting from 0\.  A call to
 * vec.getAt(0) returns the first element, vec.getAt(vec.size()-1)
 * returns the last. Raises an error if index is outside the range
 * [0, size()-1].
 */
    ElemType getAt(int index);

/*
 * Method: setAt
 * Usage: vec.setAt(3, value);
 * ---------------------------
 * This method replaces the element at the specified index
 * in this vector with a new value.  The previous value at that
 * index is overwritten with the new value. The size of the vector
 * is unchanged. Raises an error if index is not within the
 * range [0, size()-1].
 */
    void setAt(int index, ElemType value);

/*
 * Method: operator[]
 * Usage: vec[0] = vec[1];
 * -----------------------
 * This method overloads [] to access elements from
 * this vector. This allows the client to use array-like notation
 * to get/set individual vector elements. Returns a reference to
 * the element to allow in-place modification of values. Raises
 * an error if index is not within the range [0, size()-1].
 */
    ElemType & operator[](int index);

/*
 * Method: add
 * Usage: vec.add(value);
 * ----------------------
 * This method adds an element to the end of this vector.
 * The vector's size increases by one.
 */
    void add(ElemType elem);

/*
 * Method: insertAt
 * Usage: vec.insertAt(0, value);
 * ------------------------------
 * This method inserts the element into this vector at
 * the specified index, shifting all subsequent elements one
 * index higher. A call to vec.insertAt(0, val) inserts a new
 * element at the beginning, vec.insertAt(vec.size(), val) add
 * a new element to the end. The vector's size increases by one.
 * Raises an error if index is outside the range [0, size()].
 */
    void insertAt(int index, ElemType elem);

/*
 * Method: removeAt
 * Usage: vec.removeAt(3);
 * -----------------------
 * This method removes the element at the specified
 * index from this vector, shifting all subsequent elements one
 * index lower. A call to vec.removeAt(0) removes the first
 * element, vec.removeAt(vec.size()-1), removes the last. The
 * vector's size decreases by one. Raises an error if index is
 * outside the range [0, size()-1].
 */
    void removeAt(int index);

/*
 * Method: clear
 * Usage: vec.clear();
 * -------------------
 * This method removes all elements from this vector. The
 * vector is made empty and will have size() = 0.
 */
    void clear();

/*
 * SPECIAL NOTE: mapping/iteration support
 * ---------------------------------------
 * The Vector class supports both a mapping operation and an iterator which
 * allow the client access to all elements one by one.  In general,
 * these  are intended for _viewing_ elements and can behave
 * unpredictably if you attempt to modify the vector's contents during
 * mapping/iteration.
 */

/*
 * Method: mapAll
 * Usage: vector.mapAll(Print);
 * ----------------------------
 * This method iterates through this vector's contents
 * and calls the function fn once for each element.
 */
    void mapAll(void (*fn)(ElemType elem));

/*
 * Method: mapAll
 * Usage: vector.mapAll(PrintToFile, outputStream);
 * ------------------------------------------------
 * This method iterates through this vector's contents
 * and calls the function fn once for each element, passing
 * the element and the client's data. That data can be of whatever
 * type is needed for the client's callback.
 */
    template <typename ClientDataType>
    void mapAll(void (*fn)(ElemType elem, ClientDataType & data),
                ClientDataType & data);

/*
 * Method: iterator
 * Usage: iter = vector.iterator();
 * --------------------------------
 * This method creates an iterator that allows the client to
 * iterate through the elements in this vector.  The elements are
 * returned in index order.
 *
 * The idiomatic code for accessing elements using an iterator is
 * to create the iterator from the collection and then enter a loop
 * that calls next() while hasNext() is true, like this:
 *
 *     Vector<int>::Iterator iter = vector.iterator();
 *     while (iter.hasNext()) {
 *         int elem = iter.next();
 *         . . .
 *     }
 *
 * This pattern can be abbreviated to the following more readable form:
 *
 *     foreach (int elem in vector) {
 *         . . .
 *     }
 *
 * To avoid exposing the details of the class, the definition of the
 * Iterator class itself appears in the private/vector.h file.
 */
    Iterator iterator();

private:

#include "private/vector.h"

};

#include "private/vector.cpp"

#endif 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:04:29.790

尽管它的名字，你不能从该项目编译vector.cpp。.CPP 文件仅存在于`#include`vector.h 中。

不知何故，您正在直接编译 vector.cpp。错误消息源于`template<> class Vector { ... }`.

# ios - NSSortDescriptor 忽略 Comperator 块

> ID：11022287
> 
> 赞同：4
> 
> 时间：2012-06-13T19:49:49.440
> 
> 标签：ios, xcode, nssortdescriptor

我有一个带有属性“日期”的核心数据类“会议”，我想使用 NSFetchedResultsController 在 TableView 中显示它。会议应按两种方式排序：首先，应将一个月的所有会议汇总在同一部分中，然后将一个月/部分中的所有会议按日期排序。

```
 NSComparisonResult (^periodSortBlock)(id, id) = ^(id obj1, id obj2) {                
        NSLog(@"Debug");            

        NSDate *date1 = (NSDate *)obj1;
        NSDate *date2 = (NSDate *)obj2;

        // Pseudocode
        Month *month = [Month monthWithDate:date1];
        NSComparisonResult result = NSOrderedSame;

        if ([Month date:date2 afterDate:month.end])
            result = NSOrderedAscending;
        else if ([Month date:date2 beforeDate:month.start])
            result = NSOrderedDescending;

        return result;
    };        

    NSFetchRequest *fetchRequest = [NSFetchRequest fetchRequestWithEntityName:@"Meeting"];        
    fetchRequest.predicate = [NSPredicate predicateWithFormat:@"SELF IN %@", self.meetings];

    NSSortDescriptor *sectionByMonth = [NSSortDescriptor sortDescriptorWithKey:@"date" ascending:false comparator:periodSortBlock];
    NSSortDescriptor *sortByDate = [NSSortDescriptor sortDescriptorWithKey:@"date" ascending:false];

    fetchRequest.sortDescriptors = [NSArray arrayWithObjects:sectionByMonth, sortByDate, nil];

    frc = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:@"date" cacheName:nil];
    [frc performFetch:nil]; 
```

代码编译没有任何错误，但排序没有按预期工作：每个会议都有自己的部分。

据我所见，排序块被完全忽略且未被调用： NSLog 语句不会产生任何输出，并且块内的断点不会停止执行。

代替 sortDescriptorWithKey:ascending:comarator: 我可以使用 sortDescriptorWithKey:ascending:。结果是完全一样的。

如果块直接在 sortDescriptorWithKey:ascending:comparator: 语句中声明或作为变量（如上）也没有任何区别。

将块定义为 (NSDate*, NSDate*) 而不是 (id, id) 也没有区别。

这里出了什么问题？我会理解块内的排序是否会产生一些错误。但是它没有调用的块怎么可能呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T10:23:31.087

感谢保罗的提示，我能够找出问题所在。该解决方案可以在[Apple 文档](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdPersistentStores.html#//apple_ref/doc/uid/TP40002875-SW3)中找到（查看“获取谓词和排序描述符”部分）。

我认为 NSFetchRequest 只会使用 SQL 从 SQLite DB 中获取对象，然后使用 SortDiscriptors 对内存中获取的对象进行排序。这不是真的：似乎完整的排序工作也交给了 SQLite 存储。当然，来自块的 Obective-C 语句不能被翻译成 SQL 查询，因此该块被忽略。

# date - 如何强制使用 4 位数年份格式

> ID：11022288
> 
> 赞同：3
> 
> 时间：2012-06-13T19:49:53.973
> 
> 标签：date, jsf-2, converter

我正在使用 JSF 2.0 和 RichFaces 4。对于日期输入，我正在尝试强制使用模式`mm/dd/yyyy`。

```
<h:inputText value="#{bean.startDate}">
    <f:convertDateTime pattern="mm/dd/yyyy"/>
</h:inputText> 
```

当用户实际输入带有 2 位数年份的日期时`mm/dd/yy`，转换器会自动将年份转换为 4 位数。这是不希望的。在不创建自定义转换器的情况下如何阻止它这样做？这是 JSF 转换器中的错误吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-19T18:44:10.027

这不是错误。这就是[`SimpleDateFormat`](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)工作原理。这是来自链接的 javadoc 的相关引用：

> *   **Year**：如果格式化程序`Calendar`是公历，则应用以下规则。
>     *   ...
>     *   对于解析，如果模式字母的数量超过 2 个，则按字面解释年份，而不考虑位数。所以使用模式 "MM/dd/yyyy", "01/11/12" 解析到公元 12 年 1 月 11 日
>     *   ...

JSF[`<f:convertDateTime>`](http://download.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/f/convertDateTime.html)只是在幕后使用它。您最好的选择是[`DateTimeConverter`](http://docs.oracle.com/javaee/6/api/javax/faces/convert/DateTimeConverter.html)在传递到 real 之前扩展并验证提交值的长度`DateTimeConverter`。您不能到处创建自定义转换器，但它毕竟相当简单。

```
@FacesConverter("myDateTimeConverter")
public class MyDateTimeConverter extends DateTimeConverter {

    public MyDateTimeConverter() {
        setPattern("MM/dd/yyyy");
    }

    @Override
    public Object getAsObject(FacesContext context, UIComponent component, String value) {
        if (value != null && value.length() != getPattern().length()) {
            throw new ConverterException("Invalid format");
        }
        return super.getAsObject(context, component, value);
    }

} 
```

按如下方式使用它：

```
<h:inputText ... converterMessage="Please enter date in MM/dd/yyyy format">
    <f:converter converterId="myDateTimeConverter" />
</h:inputText> 
```

请注意，我`mm`将模式中的（分钟）固定为`MM`（月）。

# android - 如何在 ActivityGroup 中添加 MapActivity

> ID：11022289
> 
> 赞同：0
> 
> 时间：2012-06-13T19:49:56.763
> 
> 标签：android, android-layout

我有一个 ViewGroup 将屏幕分为两种布局，每个布局都有不同的 Activity：一个是地图，另一个是列表。此 ViewGroup 位于选项卡布局内。

问题是在这种情况下，地图没有完成加载或更新，并且列表运行速度非常慢。

有谁知道我可以以不同的方式获得此布局或如何解决地图问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:17:25.463

将它们放在同一个 Activity 中，在本例中为 a `MapActivity`，其中您的布局由 a`ListView`和`MapView`并排组成。从给出的信息来看，我看不出为什么每个子组件都需要是一个成熟的 Activity。

高温高压

# python - python中的lxml xpath，如何处理丢失的标签？

> ID：11022292
> 
> 赞同：3
> 
> 时间：2012-06-13T19:50:07.950
> 
> 标签：python, xml, lxml

假设我想用 lxml xpath 表达式解析以下 xml

```
<pack xmlns="http://ns.qubic.tv/2010/item">
    <packitem>
        <duration>520</duration>
        <max_count>14</max_count>
    </packitem>
    <packitem>
        <duration>12</duration>
    </packitem>
</pack> 
```

这是可以在[http://python-thoughts.blogspot.fr/2012/01/default-value-for-text-function-using.html找到的变体](http://python-thoughts.blogspot.fr/2012/01/default-value-for-text-function-using.html)

我怎样才能实现对压缩后会给我的不同元素的解析（在 zip 或 izip python 函数意义上）

[(520,14),(12,无)]

?

第二个包装中缺少的`max_count`标签使我无法获得我想要的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-21T12:11:36.483

```
def lxml_empty_str(context, nodes):
    for node in nodes:
        node.text = node.text or ""
    return nodes

ns = etree.FunctionNamespace('http://ns.qubic.tv/lxmlfunctions')
ns['lxml_empty_str'] = lxml_empty_str

namespaces = {'i':"http://ns.qubic.tv/2010/item",
          'f': "http://ns.qubic.tv/lxmlfunctions"}
packitems_duration = root.xpath('f:lxml_empty_str('//b:pack/i:packitem/i:duration)/text()',
namespaces={'b':billing_ns, 'f' : 'http://ns.qubic.tv/lxmlfunctions'})
packitems_max_count = root.xpath('f:lxml_empty_str('//b:pack/i:packitem/i:max_count)    /text()',
namespaces={'b':billing_ns, 'f' : 'http://ns.qubic.tv/lxmlfunctions'})
packitems = zip(packitems_duration, packitems_max_count)

>>> packitems
[('520','14'), ('','23')] 
```

[http://python-thoughts.blogspot.fr/2012/01/default-value-for-text-function-using.html](http://python-thoughts.blogspot.fr/2012/01/default-value-for-text-function-using.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:46:56.717

您可以使用`xpath`来查找`packitem`s，然后`xpath`再次调用（或`findtext`如下所示）以查找`duration`and `max_count`s。不得不`xpath`多次调用可能不会很快，但它确实有效。

```
import lxml.etree as ET

content = '''<pack xmlns="http://ns.qubic.tv/2010/item">
    <packitem>
        <duration>520</duration>
        <max_count>14</max_count>
    </packitem>
    <packitem>
        <duration>12</duration>
    </packitem>
</pack>
'''

def make_int(text):
    try:
        return int(text)
    except TypeError:
        return None

namespaces = {'ns' : 'http://ns.qubic.tv/2010/item'}
doc = ET.fromstring(content)
result = [tuple([make_int(elt.findtext(path, namespaces = namespaces))
                           for path in ('ns:duration', 'ns:max_count')])
          for elt in doc.xpath('//ns:packitem', namespaces = namespaces) ]
print(result)
# [(520, 14), (12, None)] 
```

另一种方法是使用 SAX 解析器。这可能会快一点，但它需要更多的代码，如果 XML 不是很大，速度差异可能并不重要。

# java - 如何使用 java/thrift 删除超列

> ID：11022294
> 
> 赞同：3
> 
> 时间：2012-06-13T19:50:15.520
> 
> 标签：java, cassandra, thrift

谁能提供一个清晰的例子来说明如何使用 thrift 在 Java 中删除超列？

编辑：找到了一个解决方案，这允许我在一批变异中删除我想要的任意数量的超级列。

```
 List<Mutation> mutations = new ArrayList<Mutation>();
    Map<String, List<Mutation>> keyMutations = new HashMap<String, List<Mutation>>();
    Map<ByteBuffer, Map<String, List<Mutation>>> mutationsMap = new HashMap<ByteBuffer, Map<String, List<Mutation>>>();
    try {
        tr.open();
        client.set_keyspace("my_keyspace");

        Deletion deletion = new Deletion();
        SlicePredicate slicePredicate = new SlicePredicate();

        List<ByteBuffer> columns = new ArrayList<ByteBuffer>();

        // Add as many supercolumns as you want here 
        columns.add(toByteBuffer("supercolumn_name"));

        slicePredicate.setColumn_names(columns);
        deletion.setPredicate(slicePredicate);

        // timestamp in microseconds        
        deletion.setTimestamp(System.currentTimeMillis() * 1000);

        Mutation m = new Mutation();
        m.setDeletion(deletion);

        mutations.add(m);

        keyMutations.put("column_family_name", mutations);

        mutationsMap.put(toByteBuffer("row_id_in_column_family"), keyMutations);
        client.batch_mutate(mutationsMap, ConsistencyLevel.ONE);
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
         tr.flush();
         tr.close();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T09:09:34.603

我不知道，我也使用原始 Thrift，但您应该使用更高级别的[客户端](http://wiki.apache.org/cassandra/ClientOptions)

使用 Hector 添加 CF 是这样完成的：

```
String KEYSPACE = "Keyspace";
Cluster cluster = getOrCreateCluster("MyCluster", "127.0.0.1:9170");
CfDef cfDef = new CfDef(KEYSPACE, "Users").setComparator_type(BytesType.class.getSimpleName()).setKey_cache_size(0)
            .setRow_cache_size(0).setGc_grace_seconds(86400));

try {
    cluster.addColumnFamily(new ThriftCfDef(cfDef));
} catch (Throwable e) {
    logger.error("Exception while creating CF, " + cfDef.getName()
        + " - probably already exists", e);
    }
} 
```

下降更容易：

```
cluster.dropColumnFamily(KEYSPACE, "Users"); //with exceptions 
```

[文件](http://hector-client.github.com/hector//source/content/API/core/1.0-1/me/prettyprint/hector/api/Cluster.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T18:53:07.617

找到了一个解决方案，这使我可以在一批变异中删除我想要的任意数量的超级列。

```
List<Mutation> mutations = new ArrayList<Mutation>();
Map<String, List<Mutation>> keyMutations = new HashMap<String, List<Mutation>>();
Map<ByteBuffer, Map<String, List<Mutation>>> mutationsMap = new HashMap<ByteBuffer, Map<String, List<Mutation>>>();
try {
    tr.open();
    client.set_keyspace("my_keyspace");

    Deletion deletion = new Deletion();
    SlicePredicate slicePredicate = new SlicePredicate();

    List<ByteBuffer> columns = new ArrayList<ByteBuffer>();

    // Add as many supercolumns as you want here 
    columns.add(toByteBuffer("supercolumn_name"));

    slicePredicate.setColumn_names(columns);
    deletion.setPredicate(slicePredicate);

    // timestamp in microseconds        
    deletion.setTimestamp(System.currentTimeMillis() * 1000);

    Mutation m = new Mutation();
    m.setDeletion(deletion);

    mutations.add(m);

    keyMutations.put("column_family_name", mutations);

    mutationsMap.put(toByteBuffer("row_id_in_column_family"), keyMutations);
    client.batch_mutate(mutationsMap, ConsistencyLevel.ONE);
} catch (Exception e) {
    e.printStackTrace();
} finally {
     tr.flush();
     tr.close();
} 
```

# php - php。如何获得双月定期事件？

> ID：11022295
> 
> 赞同：6
> 
> 时间：2012-06-13T19:50:16.873
> 
> 标签：php

我正在尝试很多方法，但后来我被卡住了一半。

假设今天创建了订单。我需要显示下一个重复订单何时发生。所以我在 2012 年 6 月 13 日创建了订单。然后我将计划设置为双月定期订单，每个月的第一天。如何计算下一个重复订单何时发生？答案是 8 月 1 日。

如果有人可以概述一种方法，那将非常有用，它不必是代码。这是我目前所拥有的......

```
 // first, get starting date
    $start_date_month = date('m', strtotime($start_date));

    // get this year
    $this_year = date('Y');

    // if this month is december, next month is january
    $this_month = date('m', $timestamp_month);
    if($this_month == 12){
      $next_month = 1;
    // if this month is not december add 1 to get next month
    }else{
      $next_month = $this_month + 1;
    }

    // get array of months where recurring orders will happen
    $months = array();
    for ($i=1; $i<=6; $i++) {
      $add_month = $start_date_month+(2*$i); // 2, 4, 6, 8, 10, 12
      if($add_month == 13){$add_month = 1;$year = $this_year+1;}
      elseif($add_month == 14){$add_month = 2;$year = $this_year+1;}
      elseif($add_month == 15){$add_month = 3;$year = $this_year+1;}
      elseif($add_month == 16){$add_month = 4;$year = $this_year+1;}
      elseif($add_month == 17){$add_month = 5;$year = $this_year+1;}
      elseif($add_month == 18){$add_month = 6;$year = $this_year+1;}
      elseif($add_month == 19){$add_month = 7;$year = $this_year+1;}
      elseif($add_month == 20){$add_month = 8;$year = $this_year+1;}
      else{$year = $this_year;}
      echo $what_day.'-'.$add_month.'-'.$year.'<br />';
      $months[] = $add_month;
    }

    echo '<pre>';
    print_r($months);
    echo '</pre>'; 
```

**我不想简单地找出两个月后的日期。假设在 6 月 1 日创建订单。下一个定期订单是 8 月 1 日。那么现在假设今天是 9 月 1 日，但下一个定期订单是 10 月 1 日。看到我的困境了吗？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T19:53:52.553

只取当月，所以既然是六月，我们得到 6\. `6 mod 2 == 0`. 下个月是七月，我们得到7 `7 mod 2 == 1`..

所以只需检查是否`current month % 2 == (first month % 2)`.

然后只需检查它是否是本月的 1 日。

在 PHP 中，模数是用百分比符号定义的。

```
$month = date('n');
$createdMonth = 6;
if($month % 2 == $createdMonth % 2){
    // stuff
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T20:28:52.287

您可能会发现名为[When](https://github.com/tplaner/When)对此有用的库（我是作者）。

这是代码，它将为您提供接下来的 2 个重复的每月日期（从今天开始）：

```
include 'When.php';

$r = new When();
$r->recur(new DateTime(), 'monthly')
  ->count(2)
  ->interval(2) // every other month
  ->bymonthday(array(1));

while($result = $r->next())
{
    echo $result->format('c') . '<br />';
}

// output
// 2012-08-01T13:33:33-04:00
// 2012-10-01T13:33:33-04:00 
```

更进一步，您可能只想找到前 2 个工作日：

```
include 'When.php';

$r = new When();
$r->recur(new DateTime(), 'monthly')
  ->count(2)
  ->interval(2)                                 // every other month
  ->byday(array('MO', 'TU', 'WE', 'TH', 'FR'))  // week days only
  ->bymonthday(array(1, 2, 3))                  // the first weekday will fall on one of these days
  ->bysetpos(array(1));                         // only return one per month

while($result = $r->next())
{
    echo $result->format('c') . '<br />';
}

// output
// 2012-08-01T13:33:33-04:00
// 2012-10-01T13:33:33-04:00 
```

另请注意，代码目前正在重写——它运行良好，但有点令人困惑，并且没有很好的文档记录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T19:56:48.477

我懂了：

```
$today = new DateTime();
$target_date = $today->modify("first day of +2 months");

echo "Your event is on " . $target_date->format("d/m/Y") . "!"; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-13T20:05:52.100

`strtotime`救援：

```
<?php
date_default_timezone_set('Europe/London');
$d = new DateTime('2012-01-31');
$d->modify('first day of +2 months');
echo $d->format('r'), "\n";
?> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-13T20:12:05.603

假设您想要接下来的六个订单：

```
$order_date = '6/13/2012';
$start      = date('Y-m-01', strtotime($order_date));

$order_count = 6;

$future_orders = array();

$next = strtotime('+2 months', strtotime($start));
while(count($future_orders) < $order_count){
    $future_orders[] = date('m/d/Y',$next);
    $next = strtotime('+2 months', $next);
} 
```

显然，这可以改进，但它应该让你开始......

# objective-c - 如何在 Coredata 中动态创建新实体（表）和模型

> ID：11022296
> 
> 赞同：0
> 
> 时间：2012-06-13T19:50:19.690
> 
> 标签：objective-c, ios, core-data

我构建了一个应用程序字典，在这个应用程序中字典的数据是 json，它将存储在我的服务器中。用户购买字典，解析为coredata。我的数据库结构是有`Dictionary(type,name)`和表存储数据库字典`NameDictionary(word, def)`。示例：用户下载的字典`en-en`，我将在 coredata 中有 2 个表`Dictionary(type,name)`，`English(word,def)`如果我再得到一个字典（例如`en-fr`：），我的 coredata 将被添加一个表`France(word, def). So, my problem is:`我可以通过代码动态创建该实体的实体和模型类吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:58:27.527

不，你不能。您可以拥有一个`Dictionaries`具有 2 个属性的实体：`type`，`name`以及另一个`Definitions`具有属性的实体：`word`，`def`，`type`并在两个实体之间添加关系。然后，当用户购买字典时，您添加一个带有 type`en-en`和 name:的新 Dictionary ，`"English-English"`然后添加 type 的所有单词的定义`en-en`。

# html - 如何在不影响其他单元格高度的情况下向表格单元格添加数据

> ID：11022298
> 
> 赞同：-2
> 
> 时间：2012-06-13T19:50:35.283
> 
> 标签：html, css

我必须动态地将数据添加到表格单元格中。但是当我向一个单元格添加数据时，所有其他单元格的高度也会增加。那么，有没有什么方法可以增加只有添加数据的那个单元格的高度，其余的保持不变。

还有什么方法可以在一行中的某些单元格下方仅插入表格单元格而不添加新行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:56:09.013

`<table><tr><td height="50"> Hello World!!</td></tr></table>`

将高度放在 td 标签内

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T19:56:53.710

将内容嵌入 DIV 中的每个单元格并在该 div 上启用溢出：自动，以便在高度超过允许的最大值时出现滚动条。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T23:29:55.480

基本问题...表格是网格。您可以合并单元格（col/rowspan），但一条线始终是一条线 - 也就是说，根据定义，您不能使单元格的高度与其相邻单元格的高度不同。

如果您尝试以分层方式显示数据，请使用`<ul>`/之类的分层结构`<li>`并根据需要设置样式（边距等...）。如果您需要块元素，请每个`<li>`包装一个`<div>`

# c# - C# - 如何使用 webrequest 来模拟 curl 调用

> ID：11022299
> 
> 赞同：1
> 
> 时间：2012-06-13T19:50:36.830
> 
> 标签：c#, curl, google-api, webrequest

我有这个 curl 请求，我已经能够从各种教程中拼凑起来，它可以工作，但我需要能够在 C# 中完成它。

curl -k -d "code=4/blahBLMUeFewxYi7AblahgdBf_7Lm.IrGYEyuzz8QfOl05ti8ZT3bppze2bgI&client_id=xxxxxxxxxxxx-xxxxxxxxxxxxxxxxxxxxxxx.apps.googleusercontent.com&client_secret=blahjf5z45yLNIjXGSO&redirect_uri=http://localhost/token_type=authorization_code.com ["](https://accounts.google.com/o/oauth2/token)

我没有代码可看，因为我不知道从哪里开始。

有没有人有任何关于如何做到这一点的教程？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:54:54.737

到目前为止，您是否一直在使用[WebRequest 类？](http://msdn.microsoft.com/en-us/library/system.net.webrequest.aspx)这似乎是一个明智的起点。

如果您正在寻找进行 OAuth 集成，[则可以使用相应的客户端库](https://stackoverflow.com/questions/3997172/oauth-2-0-service-provider-net-libraries)。

# awesomium - 有没有办法在 Awesomium 中使用代理身份验证？

> ID：11022304
> 
> 赞同：4
> 
> 时间：2012-06-13T19:50:53.907
> 
> 标签：awesomium

我似乎找不到使用用户名和密码 (http/socks4) 的代理的方法。任何输入都会很棒:)

我正在使用 .net 包装器，但我想这没有任何区别。

谢谢，

约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-13T14:41:00.557

您需要处理 WebControl`LoginRequest`事件，即如果您想在代码中指定用户名和密码

```
private void webcontrol_LoginRequest (object sender, LoginRequestEventArgs e)
                {
                    e.Username = "username";
                    e.Password = "password";
                    e.Handled = EventHandling.Modal;
                    e.Cancel = false;
                } 
```

测试：

```
 WebPreferences prefs = new WebPreferences() { ProxyConfig = "xxx.xxx.xxx.xxx:port" };
    session = WebCore.CreateWebSession(prefs);
    webcontrol = new WebControl() { WebSession = session };
    webcontrol.LoginRequest += new LoginRequestEventHandler(webcontrol_LoginRequest); 
```

*   如果您不想处理该事件，那么您将获得一个对话框，您可以在其中输入凭据。

# ruby-on-rails - 在 mongoid rails Query 中包含其他集合的一个属性

> ID：11022317
> 
> 赞同：1
> 
> 时间：2012-06-13T19:52:01.230
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, rubygems, mongoid

我想用 mongoid 查询，我有以下模型

```
class Score
   include Mongoid::Document
   field :value, :type => Integer
   belongs_to :user
end

class User
   include Mongoid::Document
   field :name, :type => String
   field :age, :type => Integer
   has_many :scores 
```

我想与他们的用户一起查询集合中的所有分数。但是用户对象中应该只有“名称”字段

我会是这样的

```
 Score.find.all.includes(:user).only(:name) 
```

请说出正确的语法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:55:16.733

`Score`references `User`，因此不可能在一个查询中同时检索它们，因为 MongoDB 中没有连接。

非规范化并在其中包含用户名`Score`或执行多个查询。

# c# - 完全无法解释的 NullReferenceException

> ID：11022319
> 
> 赞同：0
> 
> 时间：2012-06-13T19:52:11.513
> 
> 标签：c#, .net, exception, clr, nullreferenceexception

好的，所以我在这行代码中偶尔会收到 NullReferenceException：

```
if (!_oracleTenantSettings.OraclePlanSettings.ContainsKey(_key) || _oracleTenantSettings.OraclePlanSettings[_key] == null) 
```

和/或这一行：

```
_oraclePlanSettings = _oracleTenantSettings.OraclePlanSettings[_key]; 
```

其中 OraclePlanSettings 是一个 SortedList，它不能为空，因为有问题的代码由以下内容包围：

```
 if (_oracleTenantSettings.OraclePlanSettings != null && _oracleTenantSettings.OraclePlanSettings.Count > 0) 
```

所以我得到了一个 NRE，但整个代码行中没有一个部分可能永远为空。时期。（感觉到挫败感？）这包括密钥，但无论如何都不会抛出 NRE。我不明白。VS可能只是放错了CLR异常吗？如果是这样，哪里是开始寻找的好地方？

堆栈跟踪只是一个单行：

```
 at company.product.Mvc.OracleSettingsStoreCache.VerifyValueInCacheOrInsert[T](T& returnVal, SettingsType settingType, String tenantId, String planId, String pageMnemonic, String processId, String transcationType, String language, String country, String wapTransactionType, String wapCodeGroup, String wapLoanReasons, String palleteType, Boolean isInsert, Object _cacheValue) in blahblahblah.OracleSettingsStoreCache.cs:line 290 
```

这是整个代码块：

```
if (!string.IsNullOrEmpty(tenantId) && (!IsWacMode() || (IsWacMode() && settingType == OracleSettingsType.SettingsType.FetchWAPInvestmentTransfer)) && _useCache != "false")
                {
                    tenantId = tenantId.ToUpper().Trim();

                    _oracleTenantSettings = null;

                    if (_oracleCacheManager.Contains(_cacheKey))
                        _oracleTenantSettings = _oracleCacheManager.Get<OracleTenantSetting>(_cacheKey);

                    if (_oracleTenantSettings != null)
                    {
                        if (_oracleTenantSettings.OraclePlanSettings != null && _oracleTenantSettings.OraclePlanSettings.Count > 0)
                        {
                            _key = language + "_" + country + "_" + tenantId;
           ***LINE 290***   if (!_oracleTenantSettings.OraclePlanSettings.ContainsKey(_key) || _oracleTenantSettings.OraclePlanSettings[_key] == null)
                            {
                                _objectMissing = TypeOfObjectMissing.TenantObjectDoesNotExist;
                            }
                        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:07:30.243

如果没有看到代码所在的上下文，就很难确定。但是根据您描述的症状，即非常零星的......莫名其妙的......不可能的东西是空的......我强烈怀疑是线程问题。例如，如果集合是静态的并且可能被多个线程访问，则可能会发生（尽管这是一种罕见的机会时机）第二个线程在第一个线程测试是否存在某些东西和它访问之间修改集合内容那东西。

如果是这种情况，您必须使您的代码更加线程安全。您可以使用锁定或并发集合来避免此问题。要使用锁，您需要使用同步对象（而不是动态创建的新对象）。您还希望搜索访问该集合的所有位置，并用锁围绕每个位置...仅查看该集合的代码必须使用锁以及修改该集合的代码。对于 SO 答案来说，这是一个很大的话题，所以我建议您使用这个非常棒的资源：

[http://www.albahari.com/threading/](http://www.albahari.com/threading/)

在这种情况下，您可以通过以下方式获得 NRE：

```
thread 1 checks if entry exists in SortedList myList for _key="hello" 
gets true
thread 1 checks if entry for _key="hello" is non-null
gets true
thread 2 sets myList["hello"] = null
thread 1 executes myList["hello"].Something() and gets NRE. 
```

根据对您帖子的编辑，似乎在这些行中

```
if (_oracleTenantSettings != null) {
    if (_oracleTenantSettings.OraclePlanSettings != null && _oracleTenantSettings.OraclePlanSettings.Count > 0) {
        _key = language + "_" + country + "_" + tenantId;
         if (!_oracleTenantSettings.OraclePlanSettings.ContainsKey(_key) || _oracleTenantSettings.OraclePlanSettings[_key] == null) 
```

如果 NRE 发生在最后一行，则在执行第一行或第二行之后，另一个线程可以设置`_oracleTenantSettings`或`_oracleTenantSettings.OraclePlanSettings`为 null。发生这些事情中的任何一个都会导致最后一行抛出 NRE。

以下代码不是使代码线程安全的正确方法，但可以作为一种快速方法来查看是否确实如此，因为它会降低这种情况（空引用异常）的可能性：

```
var oracleTS = _oracleTenantSettings;
if (oracleTS != null) {
    var planSettings = oracleTS.OraclePlanSettings;
    if ((planSettings != null) && (planSettings.Count > 0)) {
        _key = language + "_" + country + "_" + tenantId;
        if (!planSettings.ContainsKey(_key) || planSettings[_key] == null) 
```

请注意，最后一行可能仍然存在与线程相关的其他问题，例如在条件的第一部分和第二部分之间被另一个线程删除的键，或者在测试后 planSettings Count 发生变化。但是，如果这段代码大大减少了 NRE，那么您就可以很好地了解发生了什么，并且您应该仔细检查并适当地使您的代码线程安全，并在需要的地方使用锁。进一步说，人们需要更多地了解其他代码在做什么，尤其是修改 _oracleTenantSettings 的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:14:45.260

我的猜测是有另一个线程访问该属性。

**每次您像这样访问它时，**一种快速修复它的方法是锁定它：

```
var oraclePlanSettings = _oracleTenantSettings.OraclePlanSettings;
lock (oraclePlanSettings)
{
    // from now on you can safely access your cached reference "oraclePlanSettings"
    if (oraclePlanSettings != null && oraclePlanSettings.Count > 0)
        _oraclePlanSettings = oraclePlanSettings[_key]; // ... blabla
} 
```

谨防死锁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T14:31:50.877

我同意以前的答案，这可能是线程问题，但我有一些要补充的。

这是一个快速而肮脏的测试，以确定它是否是线程。

设置一个重现错误的场景（比如在一夜之间在几个（10）个线程中以恒定循环运行它）

将此属性应用于您的班级

[同步​​]

您的类必须继承自 ContextBoundObject。

这会强制类的所有实例在单个线程上运行（速度较慢）。

重新运行您的测试。

如果您的问题消失了，则说明您遇到了线程问题。如果速度是一个问题，您需要返回并围绕接触该对象的代码进行所有锁定。如果您将所有内容转换为使用相关对象的属性，您只需锁定 getter 和 setter。

如果快速而肮脏的测试无法解决问题，则可能是其他问题。例如，如果您使用不安全的代码或不安全的 dll（即用非 .Net c++ 编写的东西），则可能是内存损坏问题。

希望这可以帮助。

这里是关于属性的更多细节，包括从 ContextBoundObject 继承。

[女士文档](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.contexts.synchronizationattribute.aspx)

代码示例：

```
// Context-bound type with the Synchronization context attribute.
[Synchronization()]
public class SampleSynchronized : ContextBoundObject {

    // A method that does some work, and returns the square of the given number.
    public int Square(int i)  {

        Console.Write("The hash of the thread executing ");
        Console.WriteLine("SampleSynchronized.Square is: {0}", 
                             Thread.CurrentThread.GetHashCode());
        return i*i;
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-13T20:38:39.187

## 更新

我建议在代码中的某处 Equality 运算符或 == 已在相关对象之一上重载，并且当未正确检查 null （或失败）或返回相等时发生故障不是。

检查在这种情况下使用的任何类对象的 == 上的所有运算符重载并纠正..

## 原来的

将逻辑更改为此，因为您想首先检查是否没有键...然后..当存在有效键但（*和*）其值为空时进行检查：

```
 if ((_oracleTenantSettings.OraclePlanSettings.ContainsKey(_key) == false) || 
     ((_oracleTenantSettings.OraclePlanSettings.ContainsKey(_key)) && 
       _oracleTenantSettings.OraclePlanSettings[_key] == null))) 
```

如果您仔细考虑原始语句的逻辑流程，它实际上是预期的，为什么它会间歇性地失败。:-)

**编辑**：让我解释一下，按步骤遵循这个逻辑

1.  在原始 if 子句中，当它评估 (!ContainsKey(_key)) 时，意味着当密钥不存在时 (true)，它会更改为 FALSE。
2.  然后由于 #1 中的 False，Or 开始起作用。它评估 OraclePlanSettings[_key]*但*关键不在那里吗？
3.  因此，它执行代码以检查 null 是否*存在无效键*并引发异常。

只有打破我所展示的逻辑，才不会抛出异常。

# c# - 被正则表达式难倒（积极的前瞻问题？）

> ID：11022324
> 
> 赞同：1
> 
> 时间：2012-06-13T19:52:29.803
> 
> 标签：c#, regex, parsing

我被一个正则表达式问题难住了。我一直在将它们用于一个项目并且它们一直在完美地工作，但后来我遇到了一种情况，我认为可以通过积极的前瞻性来解决，但我的尝试并没有达到我的预期。

为了说明，我在下面画了一条线。其中，我想返回两个匹配项，第一个包含“This”和“thisThing”，另一个包含“That”和“thatThing”，其中第一个值只能是“This”或“That” " 并且第二个值可以是任何 (\w*) 模式。

```
adsf(49) asd k:38* K.This(jfkael dk&$% thisThing) and K.That($$$$ djaf aj_dfj^^ ^ thatThing); 
```

我认为这将是这样的：

```
K\.(This|That)  (????????????????)    (\w*)(?=\)) 
```

意思是，找到出现在“K”之后的“This”或“That”。然后得到“）”之前的第一个单词。但是，我真的不明白我如何指定（向前看，直到找到“）”，然后回溯，直到你得到它背后的单词。这样的事情可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T19:58:10.510

您可以使用[非贪婪量词](http://www.regular-expressions.info/repeat.html)：

```
K\.(This|That).*?(\w*)\) 
```

或：（如果您不希望右括号成为匹配的一部分）

```
K\.(This|That).*?(\w*)(?=\)) 
```

这样，它将匹配 This|That 和单词之间的任何内容，但它是懒惰的（所以一旦找到一个好的匹配项，`\w*`它就会使用它，如果没有`)`跟随者则回溯）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T19:59:34.470

怎么样：`K\.(This|That)\(.*?(\w+)\)`

这非贪婪地匹配括号之间的部分，但只要在右括号之前只剩下单词字符就停止。

# c# - 在 WebBrowser 的 RadDatePicker 中更改日期值

> ID：11022329
> 
> 赞同：0
> 
> 时间：2012-06-13T19:52:50.567
> 
> 标签：c#, javascript, browser

我需要更改日期值，然后使用 C# 中的 Webbrowser 控件继续在网页上执行一些操作。

这是我将自定义 JS 函数添加到网页然后调用它的方式：

```
 HtmlElement head = webBrowser1.Document.GetElementsByTagName("head")[0];
        HtmlElement scriptEl = webBrowser1.Document.CreateElement("script");
        IHTMLScriptElement element = (IHTMLScriptElement)scriptEl.DomElement;

        element.text = "function SelectDate1() { " +
        "var frames = window.frames; " +
        "for (var i = 0; i < frames.length; i++) { " +
        "var calendar = frames[i].document.getElementById('ctl00_ContentPlaceHolder1_RadDatePicker1'); " +
        "} " +
        "}";

        head.AppendChild(scriptEl);
        webBrowser1.Document.InvokeScript("SelectDate1"); 
```

但我需要使用 $find('<%= RadDatePickerName.ClientID %>') 来查找此控件，然后对其调用 selectDates。但是 find 方法返回 NULL。这里有什么问题？请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T21:00:41.503

这应该解决它：

```
window.frames[0].$find('ctl00_ContentPlaceHolder1_RadDatePicker1').set_selectedDate(new Date('2020/10/12')) 
```

# javascript - 在 url 上使用 javascript 设置一个值

> ID：11022331
> 
> 赞同：0
> 
> 时间：2012-06-13T19:52:59.233
> 
> 标签：javascript

当弹出窗口出现时，有没有办法在 url 上添加选择结果？选择结果给出了选定框的值，我想将选定的值传递给表单，但我没有使用表单。我可以使用 url 传递值吗？

我想添加选定的值，如 form.php?id=2882,222,22412,23

```
$(function() {
    $(".selectable").selectable({
        filter: "td.cs",

        stop: function() {
            var result = $("#select-result").empty();
            var result2 = $("#result2");
            $('.ui-selecting:gt(31)').removeClass("ui-selecting");

          confirmation($(".ui-selected").length + " box selected. "+($(".ui-selected").length));

          function confirmation() {
    var answer = confirm($(".ui-selected").length + " box selected.  "+($(".ui-selected").length));
    if (answer){

        window.open ("form.php","mywindow","menubar=no,resizable=no,width=650,height=700");
    }
    else{

    }
}

$('#divmsg').html($(".ui-selected").length + " box selected")

              $('#divmsg2').html($(".ui-selected").length)
            if ($(".ui-selected").length > 90) {
               alert("Selection of only 90 boxes allowed");
                $('#divmsg').html($('#divmsg').html() + ",<br><b>Message: Selection of only 90 pixels allowed!!</b>");
                $(".ui-selected").each(function(i, e) {                  
                    if (i > 3) {

                        $(this).removeClass("ui-selected");
                    }
                });
                return;
            }

            $(".ui-selected", this).each(function() {
                var cabbage = this.id + ', ';
                result.append(cabbage);
            });

            var newInputResult = $('#select-result').text();
            newInputResult = newInputResult.substring(0, newInputResult.length - 1);
            result2.val(newInputResult);
        }
    });
}); 
```

这是小提琴 [http://jsfiddle.net/dw6Hf/57/](http://jsfiddle.net/dw6Hf/57/)

提前致谢​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:55:04.453

将值附加到查询字符串。基本思路：

```
window.open ("form.php?foo=" + bar,"mywindow"... 
```

# perl - perl win32 ole 超时

> ID：11022334
> 
> 赞同：1
> 
> 时间：2012-06-13T19:53:09.187
> 
> 标签：perl, excel, winapi, ole

我使用 perl 和 Win32::OLE 来自动化一些 Excel 任务。由于 Excel 文件太大，因此该过程需要相当长的时间才能完成......但是在一夜之间离开后，我相信它会因为“超时”问题而卡住。如果我减小文件大小，那就没问题了。

无论如何增加超时？

我的部分代码：

```
#   Open the rules file
my $xlBook = $xlApp->Workbooks->Open("$file");
my $xlSheet = $xlBook->Worksheets(1);

#Replace FALSE -> 0
$xlSheet->Cells->Replace ({ What => "FALSE", Replacement => "0" });
#Replace TRUE -> 1
$xlSheet->Cells->Replace ({ What => "TRUE", Replacement => "1" }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T23:19:26.240

更改自动化超时的方法是调用[CoRegisterMessageFilter](http://msdn.microsoft.com/en-us/library/windows/desktop/ms693324%28v=vs.85%29.aspx)来注册您的[IMessageFilter](http://msdn.microsoft.com/en-us/library/windows/desktop/ms693740%28v=vs.85%29.aspx)实现以处理 COM 调用，例如[调用 OLEUIBusy 以显示服务器繁忙对话框](http://msdn.microsoft.com/en-us/library/windows/desktop/ms694352%28v=vs.85%29.aspx)。

我不认为 Win32::OLE 实现了这一点，您可以尝试将 CoRegisterMessageFilter 代码包装在进程内 COM 服务器中并在服务器中注册消息过滤器。

# html - H1 标签与 H2 标签 - SEO 的内容权重

> ID：11022335
> 
> 赞同：1
> 
> 时间：2012-06-13T19:53:09.323
> 
> 标签：html, seo

在 SEO 方面，标题标签内容的权重是否不同？

例如，如果我用 h2 替换我的 h1 元素...（假设每页只有一个 h2 元素，没有其他标题元素）

1.  这会减少优化吗？内容的排名会更低吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T19:57:20.840

假设`<h1>`标签比`<h2>`通常的`<h1>` 页面标题更重要并传达以下内容的一般主题是合乎逻辑的。因此，从和切换`<h1>` 到 an`<h2>` *应该*会降低语义标记的价值，从而对您的排名产生负面影响。但是由于排名页面涉及许多其他因素，除非您追求的是一个非常长的尾关键词，否则我不希望它产生任何明显的差异。

如果您这样做是因为您更喜欢标签的样式而不是`<h2>`标签，`<h1>` 那么您肯定犯了一个错误。您应该使用 CSS 来更改`<h1>`标签的外观以满足您的需要。从 SEO 的角度来看，这完全可以做到，只要您不试图使`<h1>`标签看起来像普通文本（您不是）。

# mysql - 插入更新不同的列，同时在一个查询中保持其他所有内容相同

> ID：11022340
> 
> 赞同：0
> 
> 时间：2012-06-13T19:53:31.287
> 
> 标签：mysql, sql, insert

假设我有以下查询：

```
INSERT INTO TABLE (column1, column2, column3, column4) VALUES

(val11, val21, val31, val41),
(val12, val22, val32, val 42)
          ....
And then I put in a whole bunch of more values

ON DUPLICATE KEY UPDATE (some update clause) 
```

是否可以修改此查询，以便对于某些行（假设它们是重复键），我设置它以便 column3 更新为我设置的值，而第 4 列保持原样，而对于某些行，我更新column4 到某些值，而 column3 保持原样......即。是否可以有选择地更新这个单个查询中的不同列，而其余部分保持原样而不将其拆分为多个查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:22:54.103

看起来 MySQL 支持在 DUPLCIATE KEY UPDATE 子句中执行条件逻辑

[http://thewebfellas.com/blog/2010/1/18/conditional-duplicate-key-updates-with-mysql](http://thewebfellas.com/blog/2010/1/18/conditional-duplicate-key-updates-with-mysql)

IF 允许您提供“if-else”参数。所以我认为你可以做这样的事情

```
INSERT INTO table (column1, column2, column3, column4)
VALUES (val11, val21, val31, val41), (val12, val22, val32, val42)
ON DUPLICATE KEY UPDATE
column3 = IF(<some_condition>, <new_value>, <cur_value>),
column4 = IF(<some_condition>, <new_value>, <cur_value>); 
```

# regex - 每行第一次出现 vi/vim/sed 等

> ID：11022342
> 
> 赞同：4
> 
> 时间：2012-06-13T19:53:35.847
> 
> 标签：regex, vim, sed, awk, vi

使用 VI 替换第一个匹配项/实例非常简单。

```
 :%s/search/replace/args 
```

但是，这是我的 .csv 格式/文件的数据集：

```
"192.168.2.1","www.google.com","2009/01/11_10:00"," What a great website"
"192.168.2.2/driving/is/fun","-","2009/03/22_00:00","Driving website"
"192.168.2.4/boating/is/crazy","-","2009/03/22_00:00","Boating Website"
"192.168.2.5","www.cars.com","2009/04/27_00:00","What a good car website" 
```

因此，您会注意到第一行有 4 列，这是 .csv 格式的理想行。

但是，在第二行中，有 4 列，但第一列只接受 ip 地址，仅此而已，因此 192.168.2.2/driving/is/fun 必须删除或用“，”.csv 分隔符分隔。

在 vi 中，我能够使用以下内容：

```
 :/^"\d\{,3}\.\d\{,3}\.\d\{,3}\.\d\{,3}\//s/\//","/ 
```

它执行以下操作：

*   /^"\d{,3}.\d{,3}.\d{,3}.\d{,3}/ - 使用正斜杠 / 设置锚点以在第一个 IP 处开始搜索。对于例如，第 2 行：“192.168.2.2/

*   /s///","/ - 替换 IP 地址末尾的 / 并将其替换为 .csv 分隔符 ","

这在 VI/VIM 中效果很好，一次准确地替换了我需要的一行。但是，数据集要大得多，手动使用以下 vi 搜索和替换非常耗时。我正在寻找脚本或找到替代解决方案，因为 VI/VIM 一次只会执行一行，以下 :s/search/replace/g 替换了每行 / 更改日期列。

显然，我尝试了以下方法：

在替换的开头添加整个文件的 % ，如下所示：

```
 :/^"\d\{,3}\.\d\{,3}\.\d\{,3}\.\d\{,3}\//%s/\//","/ 
```

它突出显示了我需要修改但错误的每个条目：

```
 E492: Not an editor command: /^"\d\{,3}\.\d\{,3}\.\d\{,3}\.\d\{,3}\//%s/\// 
```

这相当令人困惑。

我最终想使用 sed/perl 一次性编写整个文件的编辑脚本。

所以..

"192.168.2.2/ --> "192.168.2.2","

每行第一次出现。

任何帮助将不胜感激..

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:03:21.403

在 vi/vim 中，您可以指定要替换的搜索范围。在这种情况下，您要`:%s`在所有行中替换：

```
:%s/search/replace/g 
```

您还可以指定：

```
:2,5s/search/replace/g      Replace on lines 2-5
:.,$s/search/replace/g      Replace from current line (.) to last line ($)
:.,+3s/search/replace/g     Replace on the current line (.) and the two next lines (+3)
:g/^asd/s/search/replace/g  Replace on lines starting with 'asd'. 
```

然后，您可以将其与更简单的模式结合起来，在整个文件中进行所需的替换：

```
:%s/^\("[^/"]*\)[^"]*"/\1"/ 
```

这将从 CSV 中的第一个条目中删除 IP 地址之后的所有内容。

```
:%s/^\("[^/"]*\)\/\([^"]*\)"/\1","\2/ 
```

这会将第一个条目分成 IP 地址和其余部分，尽管这只会针对那些在 IP 后面有斜线的行执行。您要做的是找到模式，转到该行然后替换。在这种情况下添加 '%' 会使命令无效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:22:58.363

在 ViM 中，尝试：

```
 :%s/^\("\d\{,3}\.\d\{,3}\.\d\{,3}\.\d\{,3}\)\(\/[^"]\)/\1","\2 
```

也就是说，我使用全局（即*从第一行到最后一行*`%`的快捷方式）替换，而不是搜索/替换。我将您的搜索模式移到了替换模式中，并在不同的组中捕获了 IP 地址和路径。然后将它们放回原处，在两者之间挤压。`1,$`*`","`*

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T20:03:47.450

你可以用更简单的模式做你想做的事：

```
s/^\("[^/"]*\)[^"]*"/\1"/ 
```

这是：匹配行首，开始匹配组：匹配 a `"`，匹配任意数量的非斜杠和非 a 的字符`"`，关闭匹配组，匹配任意数量的非 a 字符`"`，并匹配 a `"`。替换为匹配组内容加上`"`.

上面的模式应该很容易编写脚本。这是一个 Python 示例。

```
#!/usr/bin/env python
import re
import sys

if len(sys.argv) != 3:
    print("Usage: log_file_cleaner <input_file> <output_file>")
    sys.exit(1)

pat = re.compile(r'^("[^/"]*)[^"]*"')

with open(sys.argv[1]) as in_f, open(sys.argv[2], "w") as out_f:
    for line in in_f:
        line = re.sub(pat, r'\1"', line)
        out_f.write(line) 
```

注意：您需要最新版本的 Python 才能执行`with`两次`open()`调用。如果您卡在 Cygwin 上，您可以将上面的内容编辑为两个嵌套`with`语句，每个语句执行一个`open()`调用。*

# grails - 部署时空对象上的 Grails 多部分表单服务器 500 错误，但不在本地主机上

> ID：11022348
> 
> 赞同：1
> 
> 时间：2012-06-13T19:53:57.607
> 
> 标签：grails, groovy, glassfish

在我的 grails 项目中，我有一个多部分表单，它抓取文件并将文件名分配给存储在数据库中的变量。

当我使用生产标志从 localhost 运行应用程序时，我能够成功提交表单，但是，在将应用程序部署到 glassfish 服务器后，我收到服务器 500 错误：

```
Cannot get property 'originalFilename' on null object 
```

我在想这可能与没有正确处理多部分有关。任何人都有这个问题，或者可以指出我正确的方向来解决它吗？

使用使用 Oracle db 部署到 Glassfish 3 服务器的 Grails 2.0.4。

我的操作中的相关代码：

```
def uploadedFile = request.getFile('filepath')// see if there is a file to upload
        if (!uploadedFile?.empty) { // is there a file? 
            sampleInstance.filepath = "file://///FileLocation/${uploadedFile?.originalFilename}" // save the original filename

        } 
```

gsp上的表格：

```
<g:form action="sample" enctype="multipart/form-data">
 <g:textField name="name" value="${sampleInstance?.name}"/>
 ...
 <input type="file" id="filepath" name="filepath" />
 <g:submitButton name="submit" value="Submit" /></td>
</g:form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:04:30.010

如果`uploadedFile`为空，则为空`uploadedFile?.empty`，所以

```
if (!uploadedFile?.empty) { // is there a file? 
```

会做与你期望相反的事情

你可能应该做

```
if ( uploadedFile && !uploadedFile.empty) { // is there a file? 
```

# java - 无法将数据存储到数据库

> ID：11022351
> 
> 赞同：0
> 
> 时间：2012-06-13T19:54:08.670
> 
> 标签：java, php, android, mysql

我正在开发一个应用程序，该应用程序通过 PHP API 将用户输入存储到数据库表中，但我从 PHP 代码到 LogCat 收到一条错误消息。任何建议将不胜感激。

```
D/Create Response(284): {"message":"Required field(s) is missing","success":0} 
```

**PHP API**

```
<?php
// array for JSON response
$response = array();

// check for the fields
if (isset($_POST['title']) && isset($_POST['request_date']) && isset($_POST['reqEndDate']) && isset($_POST['reason']) && isset($_POST['requestor']) && isset($_POST['status']) && isset($_POST['submitDate']) && isset($_POST['explanation']) && isset($_POST['hours']) && isset($_POST['id'])) {

    $title = $_POST["request_title"];
    $date = $_POST["request_date"];
    $eDate = $_POST["reqEndDate"];
    $reason = $_POST["reason"];
    $requestor = $_POST["requestor"];
    $status = $_POST["status"]; 
    $dateSubmitted = $_POST["submitDate"];
    $explanation = $_POST["explanation"];
    $numhours = $_POST["hours"];
    $id = $_POST['id'];

    // mysql inserting a new row
    $result = mysql_query("INSERT INTO requests(request_title, request_date, reqEndDate, reason, requestor, status, submitDate, explanation, hours, empid) 
                            VALUES('$title', '$date', '$eDate', '$reason', '$requestor', '$status', '$dateSubmitted', '$explanation', '$numhours', '$id')");

?> 
```

**JAVA类**

```
 // url to the PHP API to create new request
    private static String url_create_request = "http://mywebsite.com/create_request.php";

    // JSON Node names
    private static final String TAG_SUCCESS = "success";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.add_request);

        // Edit Text
        inputTitle = (EditText) findViewById(R.id.inputTitle);
        inputSdate = (EditText) findViewById(R.id.inputSdate);
        inputEdate = (EditText) findViewById(R.id.inputEdate);
        inputHours = (EditText) findViewById(R.id.inputHours);
        inputReason = (EditText) findViewById(R.id.inputReason);
        inputExp = (EditText) findViewById(R.id.inputExp);

        // Create button
        Button btnCreateRequest = (Button) findViewById(R.id.btnCreateRequest);

        // button click event
        btnCreateRequest.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                // creating new product in background thread
                new CreateNewRequest().execute();
            }
        });
    }

    class CreateNewRequest extends AsyncTask<String, String, String> {

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            pDialog = new ProgressDialog(NewRequestActivity.this);
            pDialog.setMessage("Creating Request..");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(true);
            pDialog.show();
        }

        /**
         * Creating Request Required Fields
         * */
        protected String doInBackground(String... args) {
            String title = inputTitle.getText().toString();
            String date = inputSdate.getText().toString();
            String eDate = inputEdate.getText().toString();
            String hours = inputHours.getText().toString();
            String reason = inputReason.getText().toString();
            String explanation = inputExp.getText().toString();

            // Building Parameters
            List<NameValuePair> params = new ArrayList<NameValuePair>();
            params.add(new BasicNameValuePair("request_title", title));
            params.add(new BasicNameValuePair("request_date", date));
            params.add(new BasicNameValuePair("reqEndDate", eDate));
            params.add(new BasicNameValuePair("hours", hours));
            params.add(new BasicNameValuePair("reason", reason));
            params.add(new BasicNameValuePair("explanation", explanation));

            // getting JSON Object
            // Note that create request url accepts POST method
            JSONObject json = jsonParser.makeHttpRequest(url_create_request,
                    "POST", params);

            // check log cat fro response
            Log.d("Create Response", json.toString());

            // check for success tag
            try {
                int success = json.getInt(TAG_SUCCESS);

                if (success == 1) {
                    // successfully created request
                    Intent i = new Intent(getApplicationContext(), AllRequestsActivity.class);
                    startActivity(i);

                    // closing this screen
                    finish();
                } else {
                    // failed to create request
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }

            return null;
        }

        protected void onPostExecute(String file_url) {
            // dismiss the dialog once done
            pDialog.dismiss();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:01:37.747

只计算您的数据库列：似乎有 12 个。您只插入 11，在消除过程之后，您似乎忽略了“活动”，除非它具有默认值或可以为空，否则会抛出“缺少必填字段" 尝试插入数据库时​​遇到的错误。

# iphone - 在 MapView 中添加和删除注释会导致闪烁

> ID：11022354
> 
> 赞同：1
> 
> 时间：2012-06-13T19:54:18.280
> 
> 标签：iphone, ios, ipad, annotations, mkmapview

在我的应用程序中，我正在向我的地图视图添加和删除注释，但实际上即使我先添加新的然后删除旧的，注释也会闪烁

新注释是从互联网上收到的，所以我不能把它们从新注释的数组中删除......

我的问题是眨眼行为是如何产生的，我该如何避免这种情况？

我不想遍历注释并比较每个位置...所以我尝试延迟删除并最终以 0.2 秒结束。正是由于这种延迟，没有可见的眨眼，但这根本是不可取的。

谢谢

```
 NSMutableArray *annotationsToRemove = [[NSMutableArray alloc] initWithArray:[_mapView annotations]]; 
    [annotationsToRemove removeObject:[_mapView userLocation]];
    [_mapView addAnnotations:locations];
    // [_mapView performSelector:@selector(removeAnnotations:) withObject:annotationsToRemove afterDelay:0.2];
    [_mapView removeAnnotations:annotationsToRemove]; 
```

（“位置”是我的新注释数组）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T23:36:55.320

在删除注释后添加注释时总是会出现闪烁。如果您可以控制 Web 服务，请添加一个 unique `id`，检查您的地图上是否已存在具有该 ID 的注释，如果不存在则仅添加新注释。如果您无法添加`id`，请使用纬度和经度（可能应该是唯一的）进行检查。遍历它们不会很昂贵。

# java - 处理草图不会用java在线运行？

> ID：11022359
> 
> 赞同：0
> 
> 时间：2012-06-13T19:54:30.997
> 
> 标签：java, javascript, macos, applet, processing

我最近一直在学习 Processing，一种基于 Java 的视觉语言。它具有将草图/脚本导出为 html 文档并在浏览器中打开它们并使用 java 小程序运行它们的功能。但是，当我尝试打开它们时（在 Mac OS X 10.5.8 上），它会将我重定向到 Java 页面，告诉我 Apple 提供了自己的版本。我检查了软件更新并尝试下载另一个版本的 Java 无济于事。另外，我在一个网站上查看了 Firefox 是否有 Java，但它说它已被禁用，尽管我的偏好已检查了 Javascript。

有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T19:59:39.353

您正在运行不受支持的 Java 版本，您需要更新到 10.6 或更高版本才能获得最新版本。[https://discussions.apple.com/thread/3995956?start=0&tstart=0](https://discussions.apple.com/thread/3995956?start=0&tstart=0)

这也属于[https://apple.stackexchange.com/](https://apple.stackexchange.com/)。

# backbone.js - Backbone.js 不更新视图中的 HTML

> ID：11022376
> 
> 赞同：0
> 
> 时间：2012-06-13T19:55:44.243
> 
> 标签：backbone.js

我有这样的看法：

```
class FoursquareSearch.Views.SearchNew extends Backbone.View

  tagName: 'sidebar'

  template: JST["templates/search/new_search"]

  #events:
  #  'submit': 'create'

  initialize: ->
    @render

  render: ->
    console.log('hello')
    $this = $('#sidebar')
    $this.html('<p>All new content. <em>You bet!</em></p>')
    $this 
```

用这个路由器

```
class FoursquareSearch.Routers.Maps extends Backbone.Router

  routes:
    '': 'index'

  index: ->
    FoursquareSearch.Views.maps = new FoursquareSearch.Views.Maps()
    @model = new FoursquareSearch.Models.Map()
    #originForm = new Traveltime.Views.ShapesOriginForm(model: model, map: Traveltime.Views.map)
    newSearch = new FoursquareSearch.Views.SearchNew(model: model, map: FoursquareSearch.Views.maps) 
```

而这个 HTML

```
 <div id="top"></div>  
  <div id="sidebar">

  </div> 
```

初始化代码：

```
window.FoursquareSearch =
  Models: {}
  Collections: {}
  Views: {}
  Routers: {}
  init: -> 

    new FoursquareSearch.Routers.Maps()
    Backbone.history.start()

$(document).ready ->
  FoursquareSearch.init() 
```

我可以看到该`console.log`消息，但是 HTML 类/ID 没有得到更新！

如果我运行：

```
$this = $('#sidebar')
$this.html('<p>All new content. <em>You bet!</em></p>') 
```

在控制台中，我可以看到页面上的 HTML 更改，似乎 Backbone.js 不想为我更新视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:13:00.957

在您的初始化方法中将@render 更新为@render()。您只是返回该方法，但从不调用它。

# regex - 如何在 Perl 的匹配正则表达式中包含变量，并检查该变量是否不在字符串中？

> ID：11022379
> 
> 赞同：2
> 
> 时间：2012-06-13T19:56:05.713
> 
> 标签：regex, string, perl, variables, match

我想在 Perl 中的匹配正则 r 表达式中包含一个变量，并检查该变量是否不在字符串中。

[此处](http://www.troubleshooters.com/codecorn/littperl/perlreg.htm#VariableAsMatchExpression)的链接说明了如何包含变量，但如果变量不匹配，我很难测试。当然，我可以像这样否定 if 条件：

```
if (!($string =~ m/$Myvar/)) {
# Do some code here
} 
```

但我确信在正则表达式匹配中必须有一种方法。有任何想法吗？

提前谢谢你的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T19:57:32.087

使用[`!~`](http://perldoc.perl.org/perlop.html#Binding-Operators)运算符。

```
if ($string !~ m/$Myvar/) {
# Do some code here
} 
```

或者[`index`](http://perldoc.perl.org/functions/index.html)完全使用并避免使用正则表达式引擎。即使`$Myvar`有正则表达式引擎特别对待的字符，这也将起作用。

```
if ( index($string, $Myvar) < 0 ) {
# Do some code here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T19:58:30.107

否定结果有什么问题？

“负匹配”（需要负[前瞻断言](http://www.regular-expressions.info/lookaround.html)）使您的正则表达式更加复杂：

```
if ($string =~ m/^(?!.*$Myvar)/s) {
    # Do some code here
} 
```

# javascript - 如何在 Datepicker 中选择日期之前防止 isNaN

> ID：11022383
> 
> 赞同：0
> 
> 时间：2012-06-13T19:56:19.093
> 
> 标签：javascript

我想阻止 NaN 出现在这些文本框中：“total_full”、“total_half”、“total_single”。我**尝试**将所有计算/数字字段的初始值设置为“0”，但“total_single”仍然是 NaN，直到选择了“check_out”日期并更新了 total_days_acc？

我不确定我应该在这里放多少代码，而且我不想留下一些重要的东西，所以这里有一个问题的链接，我错误地发布了“所有”编码。：

[根据输入值隐藏/显示字段](https://stackoverflow.com/questions/11006316/hide-show-fields-based-on-input-value)

谢谢

```
<td>Accommodation:</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>Check in Date</p></td>
    <td><input type="text" name="check_in_date" id="check_in_date" class="datepicker" /></td>
    <td><p>&nbsp;</p></td>
    <td><p>Check out Date</p></td>
    <td><p>
      <input type="text" name="check_out_date" id="check_out_date" class="datepicker" />
        </p></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>Total Days Accommodation</td>
    <td><input type="text" name="total_days_acc" id="total_days_acc" /></td>
  </tr>
  <tr>
    <td>Number of Rooms:</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Single</td>
    <td><input type="text" name="no_of_rooms_single" id="no_of_rooms_single" /></td>
    <td>&nbsp;</td>
    <td>Double / Twin</td>
    <td><input type="text" name="no_of_rooms_double" id="no_of_rooms_double" /></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Contact Person</td>
    <td><input type="text" name="contact_person" id="contact_person" /></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Telephone Number</td>
    <td><input type="text" name="tel_no" id="tel_no" /></td>
    <td>&nbsp;</td>
    <td>Fax Number</td>
    <td><input type="text" name="fax_no" id="fax_no" /></td>
  </tr>
  <tr>
    <td>Cell Number</td>
    <td><input type="text" name="cell_no" id="cell_no" /></td>
    <td>&nbsp;</td>
    <td>Email</td>
    <td><input type="text" name="email" id="email" /></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Full Day Conference @ R260.00 p/p</td>
    <td><input type="text" name="full_day" id="full_day" /></td>
    <td>&nbsp;</td>
    <td>Total Cost Full Day</td>
    <td><input type="text" name="total_full" id="total_full" readonly="readonly" /></td>
  </tr>
  <tr>
    <td>Half Day Conference @ R240.00 p/p</td>
    <td><input type="text" name="half_day" id="half_day" /></td>
    <td>&nbsp;</td>
    <td>Total Cost Half Day</td>
    <td><input type="text" name="total_half" id="total_half" readonly="readonly" /></td>
  </tr>
  <tr>
    <td>Single Rooms @ R480.00 p/p</td>
    <td><input type="text" name="single_rooms" id="single_rooms" /></td>
    <td>&nbsp;</td>
    <td>Total Cost Single Rooms</td>
    <td><input name="total_single" type="text" id="total_single" readonly="readonly" /></td>
  </tr>
  <tr>
    <td>Double / Twin Rooms @ R720.00 p/p</td>
    <td><input type="text" name="double_rooms" id="double_rooms" /></td>
    <td>&nbsp;</td>
    <td>Total Cost Double / Twin</td>
    <td><input name="total_double" type="text" id="total_double" readonly="readonly" /></td>
  </tr>
  <tr>
    <td>Data Projector @ R400.00 rental p/day</td>
    <td><input type="text" name="data_proj" id="data_proj" /></td>
    <td>&nbsp;</td>
    <td>Total Cost Projector Rental</td>
    <td><input name="total_project" type="text" id="total_project" readonly="readonly" /></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Sub Total</td>
    <td><input type="text" name="sub_total" id="sub_total" /></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td height="23">&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>

  </form>
</table>

</div>

<div id="hideme">
Hello Hideme
</div>

<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>

<script type="text/javascript">
//Datepicker
$(function() {
    $(".datepicker").datepicker({ minDate: -0, maxDate: "+100M +10D",dateFormat: 'dd-mm-yy'})
    ({
        changeMonth: true,
        changeYear: true,
    });
        });

//Datepicker Enquiry Date Set to Today
var enquiry_date = $.datepicker.formatDate('dd-mm-yy', new Date());
document.getElementById('enquiry_date').value = enquiry_date;

//Datepicker Conference in / out
var calcDate = function() {
    var start = $('#conference_date_in').datepicker('getDate');
    var end = $('#conference_date_out').datepicker('getDate');
    var days = (end - start) / 1000 / 60 / 60 / 24 + 1;

    if(days==0) {days=1
    }
    if( days >= 0 ) {
    document.getElementById('total_days').value = days;
    } 
        }

$('#conference_date_out').change(calcDate);
$('#conference_date_in').change(calcDate);

//Datepicker Check in  / Out Accommodation
var calcDateAcc = function() {
    var startacc = $('#check_in_date').datepicker('getDate');
    var endacc = $('#check_out_date').datepicker('getDate');
    var daysacc = (endacc - startacc) / 1000 / 60 / 60 / 24;

    if(daysacc==0) daysacc=1
    if( daysacc >= 0 ) {
    document.getElementById('total_days_acc').value = daysacc;
    } 
        }

$('#check_in_date').change(calcDateAcc);
$('#check_out_date').change(calcDateAcc);

//Calculate Total Cost FullDay Conference
function calculateFull()
{
    var fulldays = parseInt(document.getElementById("full_day").value);

    var no_of_delegates = parseInt(document.getElementById("no_of_delegates").value);

    var fullprice = 260;

    var resultfull =  fulldays * no_of_delegates * fullprice;

    document.getElementById("total_full").value = resultfull;
    }

    $('#full_day').change(calculateFull).keyup(calculateFull);

//Calculate Half Day conference total   

    function calculateHalf()
{
    var halfdays = parseInt(document.getElementById("half_day").value);

    var no_of_delegates = parseInt(document.getElementById("no_of_delegates").value);

    var halfprice = 240;

    var resulthalf =  halfdays * no_of_delegates * halfprice;

    document.getElementById("total_half").value = resulthalf;
    }

    $('#half_day').change(calculateHalf).keyup(calculateHalf);

//Calculate Total Cost Single Rooms
    function calculateSingle()
{
    var single_rooms = parseInt(document.getElementById("single_rooms").value);

    var total_days_acc = parseInt(document.getElementById("total_days_acc").value);

    var single_rooms_price = 480;

    var resultsingle =  single_rooms * total_days_acc * single_rooms_price;

    document.getElementById("total_single").value = resultsingle;
    }

    $('#single_rooms').change(calculateSingle).keyup(calculateSingle);
    $('#check_in_date').change(calculateSingle);
    $('#check_out_date').change(calculateSingle);

//Hide me Testing   
$("#full_day").keyup(function(){

        if ($('#full_day').val() == "1") {   
            $("#hideme").show("fast"); //Slide Down Effect
        }
        else {
            $("#hideme").hide("fast");    //Slide Up Effect
        }
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:03:48.317

不只是将值插入页面，只需执行以下操作：

```
document.getElementById("total_days").value = isNaN(days) ? 0 : days; 
```

# php - 使用 strtotime() 在 php 中计算相对日期

> ID：11022384
> 
> 赞同：6
> 
> 时间：2012-06-13T19:56:22.027
> 
> 标签：php, strtotime

我正在寻找一种可靠的方法来返回*当前*一周指定工作日（例如“星期一”）的完整日期。

由于今天是 2012 年 6 月 13 日星期三，我预计`<?php echo date("Y-m-d", strtotime('Mon this week')); ?>`会导致`2012-06-11`，但 php 返回`2012-06-18`时好像将本周解释**为下周****的**含义。为什么会出现这种行为，我应该怎么做？

谢谢。

——杰夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T20:02:46.607

`date( 'Y-m-d', strtotime( 'last Monday', strtotime( 'Sunday' ) ) );`

这将搜索下周日之前的周一。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:34:32.583

根据文档[php 相对日期格式](http://php.net/manual/en/datetime.formats.relative.php)。

然后`Monday this week`会先前进到`next Monday`再处理 的相关文本`this week`。

**dayname**：移动到该名称的下一天，除非它是当天，否则它不会前进。换句话说，如果当前日期是 6 月 11 日，则`strtotime('Monday this week')`返回 6 月 11 日，而如果当前日期是 6 月 13 日，则`strtotime('Monday this week')`返回 6 月 19 日。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:02:36.920

我认为这是您问题的解决方案：

```
$monday_date = date("Y-m-d", mktime(0,0,0, date("m"), date("j")-(date("w")+1), date("Y"))); 
```

# c - 从数组中检索多维数组

> ID：11022386
> 
> 赞同：4
> 
> 时间：2012-06-13T19:56:29.927
> 
> 标签：c, arrays, pointers

我现在对 C 语言中的指针感到疯狂。我有以下两个多维数组：

```
int num0[5][3] =
{ {0,1,0},
  {1,0,1},
  {0,1,0},
  {1,0,1},
  {0,1,0}
};

int num1[5][3] =
{ {1,1,1},
  {1,0,1},
  {0,1,1},
  {0,1,0},
  {1,0,0}
}; 
```

然后将它们打包到另一个数组中：

```
int (*numbers[])[3] = { num0, num1 }; 
```

如果我这样做：

```
printf( "Result: %d\n", numbers[0][2][2] ); 
```

我得到了预期的结果，在这种情况下结果：1。

但是，我想将 numbers[0] 分配给另一个变量。所以在现代编程语言中，你会做一些简单的事情：

```
int newvar[5][3] = numbers[0];
printf( "Result: %d\n", newvar[2][2] ); 
```

尽管我的指针知识有限，但我知道这行不通（当然也行不通）。但是对于我的一生，我无法弄清楚使它起作用的正确语法（更重要的是，了解它为什么起作用）。

如果有人可以在这里帮助我，我将非常感激！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:09:40.523

您不能在 C 中分配数组，`memcpy`用于复制数组：

```
 memcpy(newvar, numbers[0], sizeof newvar); 
```

# actionscript-3 - 如何构建与从 Flex 3.5B 到 Flex 4.6 的客户端应用程序兼容的 Flex 库？

> ID：11022389
> 
> 赞同：2
> 
> 时间：2012-06-13T19:56:44.473
> 
> 标签：actionscript-3, apache-flex, flex4, flex3, rsl

我的目标是构建一个与基于 3.5B 到 4.6 的 Flex 版本的客户端（其他库和 Flex 应用程序）兼容的 Flex 库。此外，我希望能够在我的库中尽可能使用最新版本的 Flex 功能，尽管与兼容性相比，这是次要问题。

**我有必要使用不大于 3.5B 的 Flex 版本吗？**

我在使用 3.5B 时遇到的一个特别困难是，当我将 Flex 静态链接到我的库并在 Flex 4.5.1A 项目中使用它时，它会因编译时错误而失败，例如`1044: Interface method get baseline in namespace mx.core:ILayoutElement not implemented by class panels:BasePanel.`

运行时共享链接似乎在一定程度上解决了这个问题。当我使用 Flex 集的 RSL 为 Flex 3.5B 编译库时，它会生成一个 swc，可以在我的 4.5.1A 项目中干净地编译并且基本上可以工作，但我对静态选项不起作用这一事实感到不舒服。我觉得以这种方式进行运行时链接似乎很奇怪，因为使用 Flex 3 构建的项目是与 Flex 4 进行运行时链接的（为什么运行时链接不会产生相同的接口投诉？）。

运行时链接看起来很松散（也就是说，我什至可以使用 4.6 构建我的原始项目，只是要非常小心，不要使用 4.6 之前的功能并在 3.5 项目中使用它），我对我目前的水平感到不舒服理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T20:15:48.337

> 我有必要使用不大于 3.5B 的 Flex 版本吗？

版本之间的 Flex Framework 类有很多变化。因此，保证 SWC 可用于 Flex SDK 的多个版本的唯一方法是不依赖于 Flex SDK。

在 Flex 3.5B 中创建具有 Flex 依赖项的 SWC 库不一定适用于 Flex 4、Flex 4.5 或 Flex 4.6。

我在使用我们的商业组件时遇到了很多麻烦。以[AutoCompleteComboBox](https://www.flextras.com/index.cfm?event=ProductHome&ProductID=19)为例。我们目前有 5 个不同的版本（Flex 3、Flex 3.2、Flex 3.5、Flex 4 和 Flex 4.5）。每个版本都有特定于该 SDK 版本的错误修复。Flex 3.5 是对组件的完全重写，因为对我们组件扩展的 Flex ComboBox 进行了重大更改。

此外，如果您使用的库是在与当前版本不同的 Flex SDK 版本上编译的，有时 Flex 编译器会给出“奇怪的”编译错误，这些错误可以通过使用与主应用程序相同的 SDK 版本重新编译您的库来解决. 我认为这正是你所看到的。

因此，答案是，如果您想将 SWC 与为多个 Flex SDK 版本创建的项目一起使用，那么保证兼容性的唯一方法是在您的 SWC 中不依赖于 Flex SDK。

# asp.net-mvc-3 - MVC3 中的包装类

> ID：11022391
> 
> 赞同：1
> 
> 时间：2012-06-13T19:56:47.960
> 
> 标签：asp.net-mvc-3, sql-server-2008

我想创建一个包装类，以便所有查询都不应该在控制器中。当前选择查询放置在控制器中。但我想创建另一个抽象层。

我已经创建了一个视图模型类。但是包装类是另一回事。

我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T12:49:05.977

我不直接在我的控制器中进行任何查询。我有一个服务层，我的控制器会调用它，每个服务层都会调用存储库来插入、更新或删除数据或带回数据。

下面的示例代码使用`ASP.NET MVC3`和`Entity Framework code first`。假设您想带回所有国家/地区并在您的控制器/视图中出于任何原因使用它：

我的数据库上下文类：

```
public class DatabaseContext : DbContext
{
     public DbSet<Country> Countries { get; set; }
} 
```

我的国家存储库类：

```
public class CountryRepository : ICountryRepository
{
     DatabaseContext db = new DatabaseContext();

     public IEnumerable<Country> GetAll()
     {
          return db.Countries;
     }
} 
```

我调用我的存储库的服务层：

```
public class CountryService : ICountryService
{
     private readonly ICountryRepository countryRepository;

     public CountryService(ICountryRepository countryRepository)
     {
          // Check for nulls on countryRepository

          this.countryRepository = countryRepository;
     }

     public IEnumerable<Country> GetAll()
     {
          // Do whatever else needs to be done

          return countryRepository.GetAll();
     }
} 
```

我的控制器将调用我的服务层：

```
public class CountryController : Controller
{
     private readonly ICountryService countryService;

     public CountryController(ICountryService countryService)
     {
          // Check for nulls on countryService

          this.countryService = countryService;
     }

     public ActionResult List()
     {
          // Get all the countries
          IEnumerable<Country> countries = countryService.GetAll();

          // Do whatever you need to do

          return View();
     }
} 
```

互联网上有很多关于如何获取数据并显示、插入、编辑等的信息。一个很好的起点是[http://www.asp.net/mvc](http://www.asp.net/mvc)。完成他们的教程，它会对你有好处。祝一切顺利。

# ajax - 对 WCF Web 服务的 Ajax 调用返回 400 Bad Request

> ID：11022395
> 
> 赞同：0
> 
> 时间：2012-06-13T19:56:59.560
> 
> 标签：ajax, wcf, web-services

> **可能重复：**
> [通过 Javascript 调用 WCF Web 服务时返回“错误请求”错误](https://stackoverflow.com/questions/10986479/wcf-web-service-returns-bad-request-error-when-invoked-through-javascript)

我有一个简单的 WCF Web 服务 Service1，只有一个返回字符串的方法 Test()。我已经在测试机器上部署了这个 Web 服务，但是当我尝试从浏览器调用 Test 方法时，我只是收到 400 Bad Request 错误。当我尝试通过 AJAX GET 请求调用该方法时，也会发生同样的情况。但令人惊讶的是，该方法在通过 WCFTestClient 调用时返回正确的结果。

这是代码：

```
[ServiceContract]
public interface IService1
{
    // This method can be called to get a list of page sets per report.
    [OperationContract]
    [WebGet]
    string Test();
}       

public class Service1 : IService1
{
    public string Test()
    {
        return "test";
    }
} 
```

这是我的 AJAX 请求：

```
 var serverUrl1 = 'http://' + baseUrl + ':86/Service1.svc';

 function GetTestString()
 {
        var methodUrl = serverUrl1 + "/Test";
        $.ajax({
    async: false,
                type: "GET",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
            url: methodUrl,
                beforeSend: function (XMLHttpRequest) {
        //ensures the results will be returned as JSON.
              XMLHttpRequest.setRequestHeader("Accept", "application/json");
                },
    success: function (data) {
        ShowQRGSlides(data.d);
    },
    error: function (XmlHttpRequest, textStatus, errorThrown) {
        alert("ERROR: GetAvailablePages() Check your browsers javascript console for more details." + " \n XmlHttpRequest: " + XmlHttpRequest + " \n textStatus: " + textStatus + " \n errorThrown: " + errorThrown);
    }
  });

 } 
```

这是我的 Web 服务的 web.config 文件：

```
<?xml version="1.0"?>
<configuration>

<system.web>
<compilation debug="true" targetFramework="4.0" />
<customErrors mode="Off"/>
</system.web>
<system.serviceModel>
<behaviors>
  <serviceBehaviors>
    <behavior>
      <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
      <serviceMetadata httpGetEnabled="true"/>
      <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
      <serviceDebug includeExceptionDetailInFaults="false"/>
    </behavior>
  </serviceBehaviors>
</behaviors>
<serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
</system.serviceModel>
<system.webServer>
<modules runAllManagedModulesForAllRequests="true"/>
</system.webServer>

</configuration> 
```

这只是自动生成的简单 web.config。我无法弄清楚为什么无法通过浏览器或 ajax 访问这种简单的 Web 服务方法。通过 WCFTestClient 访问时，相同的方法返回结果。

任何输入将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:24:13.400

您需要将服务部分添加到您的 web.config 文件中。`webHttpBinding`除非您告诉他，否则主机不知道您要使用。

```
<services>
  <service name="Service1">
    <endpoint address=""
              binding="webHttpBinding"
              contract="IService1" />
  </service>
</services> 
```

下面的链接提供了在 IIS 中托管服务的详细说明（带有`wsHttpBinding`）。你只需要使用`webHttpBinding`而不是`wsHttpBinding`- [http://msdn.microsoft.com/en-us/library/ms733766.aspx](http://msdn.microsoft.com/en-us/library/ms733766.aspx)

# javascript - php 页面正确呈现，但“查看源代码”未显示正确的 HTML

> ID：11022403
> 
> 赞同：2
> 
> 时间：2012-06-13T19:57:48.307
> 
> 标签：javascript, php, ajax, console

我对相同的 php/ajax 解决方案有两个问题。首先是一个奇怪的问题。或者，也许我只是错过了一些东西。我有一个显示来自数据库的数据的 php 页面。所以假设它第一次加载时，“myavalue”= 1。

在同一页面上，我有一个刷新按钮，它触发 ajax 函数以从数据库中获取最新数据。如果我将数据库中的值从 1 更改为 2，然后使用此按钮，页面会显示 2。但是，当我在页面上查看源代码时，它会显示值 1 而不是 2。这是为什么？我在 IE 9 和火狐中都试过了。

第二个问题可能与此有关……问题出在我上面提到的同一页面上。单击刷新按钮时，我实际上是在我的控制器中生成 html，然后让我的视图显示它。我注意到的是，在视图源代码中，html 缺少我分配给表格单元格的类名。但是，在我的控制台中，我可以看到控制器生成的 html 实际上包含正确的类名。这是控制台显示的内容：

```
 <tr><td>10.14.193.0/27</td><td>Vancouver Island</td><td class='deadclient'>2012-06-13 12:12:12</td></tr> 
```

这是视图源显示的内容：

```
 <tr>
       <td>10.14.193.0/27</td>
       <td>Vancouver Island</td>
       <td>2012-06-13 12:12:12</td>
    </tr> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T19:59:16.253

查看源代码不会显示 JavaScript 对原始源代码的影响。您需要通过 Firebug 或 chrome 的开发工具等工具查看更改后的源代码，以查看您正在使用的任何 JavaScript 的效果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:02:14.597

“查看源代码”更好地表述为“查看原始源代码”（我相信它在某些浏览器中）。在 JavaScript 对此事有任何发言权之前，它就是页面的来源。

要查看实时源代码，请使用浏览器拥有的任何开发者工具。IE 有 F12 Tools，Chrome 有 Inspector，Firefox 最近添加了 Web Developer。

关键是“查看源代码”与页面上的实际内容之间存在差异。这就像试图通过观察河流与海洋的交汇处来观察河流的源头。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T20:04:16.030

Firefox 的 view-source 选项将向页面发出另一个请求以获取 HTML 响应。要确认我的意思，您可以尝试使用表单的页面，它会询问您是否要重新发送数据两次。

您想要的是类似于 Chrome 内置开发工具的东西，您将实时看到源代码，因为它是由 Javascript 修改的，甚至可以更改标记并实时查看。

玩得开心，你的问题不是真正的问题：]

# sql - 在数据库中建模一对多关系

> ID：11022404
> 
> 赞同：1
> 
> 时间：2012-06-13T19:57:50.823
> 
> 标签：sql, database, design-patterns, orm, relational

我试图找到一种合适的模式来模拟从几个表到一个公用表的一对多关系。

EntityA、EntityB等实体有一个或多个GenericInfo。

*   EntityA (0..1) ------ (1..N) GenericInfo*   EntityB (0..1) ------ (1..N) GenericInfo*   EntityC (0..1) ------ (1..N) GenericInfo

    选项1：这些实体是不同的，所以我不能使用超级表来模拟关系，比如

    *   超级实体 (S_Id pk)*   EntityA (S_Id pk fk)*   实体 B (S_Id pk fk)*   GenericInfo (G_Id pk, S_id fk)

    选项 2：我不想通过从 GenericInfo 表中删除外键约束来失去参照完整性。

    *   EntityA (S_Id pk fk)*   实体 B (S_Id pk fk)*   GenericInfo（G_Id pk，unique_id 非 fk）

    选项3：我目前正在使用关联表进行关系映射。

    *   实体A (A_Id pk)*   实体 B (B_Id pk)*   EntityAInfo(A_Id pk fk, G_Id pk fk)*   EntityBInfo(B_Id pk fk, G_Id pk fk)*   GenericInfo (G_Id pk)

    我不喜欢这个解决方案，因为必须在数据库中创建太多表，其全部目的是保留链接/关系。

    选项4：我能想到的另一种方法是创建一个像这样具有单个 Id 属性的映射表，

    *   EntityA（A_Id pk，I_id fk 可为空）*   EntityB（B_Id pk，I_id fk 可为空）*   信息映射（I_Id pk）*   GenericInfo (G_Id pk, I_Id fk)

    我喜欢您的专家意见和意见。

    谢谢，

    # 更新

    瓦塞克，感谢您的评论。

    我试图解决的问题是：如何为公开对象集合的接口实现建立对象关系映射？

    我们为 OR 映射使用每个类策略一个表。因此，示例中的每个表都是从一个类映射的。假设我们有以下类型定义和表格（很遗憾我不能在这里发布图表）

    公共接口 IGenericInfoProvider
    {
    GenericInfo [ ] GenericInfoArray {get;set;}
    }

    公共类 BaseClassForA {} ---------------------------------------------表 BaseEntityForA
    公共类 BaseClassForB {} ------------------------------------------- -- 表 BaseEntityForB
    公共类 ClassA : BaseClassForA, IGenericInfoProvider {} --- 表 EntityA
    公共类 ClassB : BaseClassForB, IGenericInfoProvider {} --- 表 EntityB
    公共类 GenericInfo {} ------------- --------------------------------------- 表 GenericInfo

    我正在尝试对 EntityA/EntityB 和 GenericInfo 之间的一对多关系进行建模。这种关系在我们的领域模型中很常见。
    [Option1](https://stackoverflow.com/questions/11022404/model-one-to-many-relationship-in-database#options1)不被​​考虑，因为这会导致创建一个超级表来包含许多表中的所有 id，并且它在 OO 世界中没有任何意义。 由于参照完整性，选项 2 是不可接受的
    [。](https://stackoverflow.com/questions/11022404/model-one-to-many-relationship-in-database#options2)
    [Option3](https://stackoverflow.com/questions/11022404/model-one-to-many-relationship-in-database#options1)是我目前使用的模式。
    我正在考虑[Option4](https://stackoverflow.com/questions/11022404/model-one-to-many-relationship-in-database#options1)，但不确定它是否是正确方向的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T13:42:18.597

我不确定您希望实现什么，但我想尝试使用一些数据库设计工具来创建包含表、主/外/备用键、复合键、关系等的结构可能会很有用。一张图片值得一看千言万语：）你可以快速创建各种设计，生成 SQL 代码并考虑如何存储示例数据。

对我来说，第一个场景（选项 3）似乎代表了 M:N 关系。第二种情况（选项 4）代表不同的情况 - 不同的参照完整性，因此这两种情况不具有可比性。

尝试创建示例数据库、插入示例记录并编写查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T17:50:04.193

您当前的解决方案是正确的解决方案。这是保持数据完整性的最佳方式，这是数据库最关键的功能。制作更多的桌子甚至不应该成为设计考虑因素。

# mysql - 如果不存在相同的整行，则 MySQL INSERT

> ID：11022407
> 
> 赞同：3
> 
> 时间：2012-06-13T19:58:09.590
> 
> 标签：mysql, insert, row, unique

我有一个有 10 列的表，我必须从 CSV 文件中添加很多很多行。当然，我不能添加两个相同的行，所以如果整行确实存在，我需要一个忽略该命令的 SQL 语句。仅当所有字段都相同时，才必须忽略 INSERT。两行可能具有相同的*field1*或*field2*，但并非所有字段都相同。

我试过`INSERT IGNORE`了，但它不起作用。没有将列设置为`UNIQUE`，因为`INSERT`只有当整行相同时才必须忽略 onyl。

您对此有什么解决方案？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:01:23.240

然后或根据您的需要在**所有列**上创建组合索引。`INSERT IGNORE``REPLACE INTO`

从[文档](http://dev.mysql.com/doc/refman/5.5/en/insert.html)：

> 如果使用 IGNORE 关键字，则执行 INSERT 语句时发生的错误将被视为警告。例如，如果没有 IGNORE，复制表中现有**UNIQUE 索引**或 PRIMARY KEY 值的行会导致重复键错误并且语句被中止。使用 IGNORE，行仍然没有插入，但不会发出错误。

# java - OpenGL ES 2.0 不绘制任何东西

> ID：11022409
> 
> 赞同：0
> 
> 时间：2012-06-13T19:58:10.910
> 
> 标签：java, android, graphics, opengl-es, 3d

我对 OpenGL ES 2.0 有疑问。我设计了一个非常简单的框架来帮助我加载 OBJ 文件并在我的 Android 手机上绘制它们，但是我有 2 个我无法修复的错误：

1.  在我更改方向并且 Activity 被抓取并重新加载之前，我的应用程序不会显示任何内容。在它重新加载之前，只能看到 GLES20.glClear() （我已将其设置为灰色）。

2.  有时，当我加载 OBJ 并执行定位技巧时，我的一半脸不见了，我看到了间隙，但问题可能出在我使用的 OBJ 文件上。

```
package com.ideas.opengl;

import java.io.IOException;
import javax.microedition.khronos.egl.EGLConfig;
import javax.microedition.khronos.opengles.GL10;

import android.opengl.GLES20;
import android.opengl.GLSurfaceView.Renderer;
import android.opengl.Matrix;

public class DemoRenderer implements Renderer {
    public static int mProgramHandle;
    private int mMVPMatrixHandle;
    private float[] mModelMatrix = new float[16];
    private float[] mViewMatrix = new float[16];
    private float[] mProjectionMatrix = new float[16];
    private float[] mMVPMatrix = new float[16];

    public Object banana;

    private OpenGLDemoActivity activity;

    private int angle;

    public DemoRenderer(OpenGLDemoActivity activity) throws IOException {
        this.activity = activity;
    }

    @Override
    public void onSurfaceCreated(GL10 gl, EGLConfig config){
        GLES20.glClearColor(0.65f, 0.65f, 0.65f, 0.65f);

        //GLES20.glEnable(GLES20.GL_CULL_FACE);

        GLES20.glEnable(GLES20.GL_DEPTH_TEST);

        GLES20.glEnable(GLES20.GL_TEXTURE_2D);

        Shader shader = null;
        try {
            shader = new Shader(activity, "simple");
        } catch (IOException e) {
            e.printStackTrace();
        }
        Vector position = new Vector();
        Vector speed = new Vector();
        Vector accel = new Vector();
        Model model = null;
        try {
            model = new Model("banana", activity);
        } catch (IOException e) {
            e.printStackTrace();
        }

        banana = new Object(position, speed, accel, model);

        mProgramHandle = shader.getProgramHandle();

        final float eyeX = 0.0f;
        final float eyeY = 0.0f;
        final float eyeZ = 3.5f;

        final float lookX = 0.0f;
        final float lookY = 0.0f;
        final float lookZ = -5.0f;

        final float upX = 0.0f;
        final float upY = 1.0f;
        final float upZ = 0.0f;

        Matrix.setLookAtM(mViewMatrix, 0, eyeX, eyeY, eyeZ, lookX, lookY, lookZ, upX, upY, upZ);

        mMVPMatrixHandle = GLES20.glGetUniformLocation(mProgramHandle, "u_MVPMatrix");
    }

    @Override
    public void onSurfaceChanged(GL10 gl, int width, int height) {
        GLES20.glViewport(0, 0, width, height);

        final float ratio = (float) width / height;
        final float left = -ratio;
        final float right = ratio;
        final float bottom = -1.0f;
        final float top = 1.0f;
        final float near = 1.0f;
        final float far = 10.0f;

        Matrix.frustumM(mProjectionMatrix, 0, left, right, bottom, top, near, far);

    }

    @Override
    public void onDrawFrame(GL10 gl) {      
        GLES20.glClear(GLES20.GL_DEPTH_BUFFER_BIT | GLES20.GL_COLOR_BUFFER_BIT);

        angle++;

        Matrix.setIdentityM(mModelMatrix, 0);
        Matrix.rotateM(mModelMatrix, 0, angle, 0.0f, 1.0f, 1.0f);

        Matrix.multiplyMM(mMVPMatrix, 0, mViewMatrix, 0, mModelMatrix, 0);

        Matrix.multiplyMM(mMVPMatrix, 0, mProjectionMatrix, 0, mMVPMatrix, 0);

        GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mMVPMatrix, 0);

        banana.draw();
    }
} 
```

`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T18:28:05.853

尝试了一些 glGetError() 并遇到了错误，一个是关于其值未更改的变量，另一个是如果该属性未在顶点着色器中使用，则 glGetAttributeLocation() 返回 -1。谢谢你的帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-14T17:13:38.357

几何问题可能是由于在矩阵乘法中对输入和输出使用相同的浮点数组： `Matrix.multiplyMM(mMVPMatrix, 0, mProjectionMatrix, 0, mMVPMatrix, 0);` 根据 multiplyMM() 规范，输入和输出数组可能没有重叠元素，但您使用相同的数组 mMVPMatrix 开头相同的索引 0。解决此问题的一种方法是使用另一个矩阵作为最后一次乘法结果的缓冲区，因此而不是：

```
Matrix.multiplyMM(mMVPMatrix, 0, mProjectionMatrix, 0, mMVPMatrix, 0);
GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mMVPMatrix, 0); 
```

采用：

```
Matrix.multiplyMM(mMatrixFinal, 0, mProjectionMatrix, 0, mMVPMatrix, 0);
GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mMatrixFinal, 0); 
```

# c++ - 当 seekg 查找文件末尾（C++，Linux）时未设置故障位

> ID：11022417
> 
> 赞同：3
> 
> 时间：2012-06-13T19:58:53.007
> 
> 标签：c++

我看到了我认为 istream::seekg 的奇怪行为。具体来说，当我寻找一个明显远离文件末尾的点时，它似乎没有设置故障位。

从我在文档中可以看出，应该设置故障位，但事实并非如此。

谁能解释这种行为？相关代码片段：

```
class Tester 
{

  ... 

  void testTriggered()
  {
    fs.open("/pathtofile/testFile.TEST", std::ios_base::in|std::ios_base::binary);
    prv_testbits("testTriggered(): OpeningFile");

    fs.seekg(2000,std::ios_base::beg);
    prv_testbits("testTriggered(): seekTwoThousand");
    int g = fs.tellg();
    std::cout << "get pointer is:" << g << std::endl; 
  }

  void prv_testbits(std::string msg){
    if (fs.fail()) {
      std::cout << msg << ": failbit set." << std::endl;
    } else {
      std::cout << msg << ": failbit NOT set." << std::endl;
    }
    if (fs.bad()) {
      std::cout << msg << ": badbit set." << std::endl;
    }else {
      std::cout << msg << ": badbit NOT set." << std::endl;
    }
    if (fs.eof()) {
      std::cout << msg << ": eofbit set." << std::endl;
    } else {
      std::cout << msg << ": eofbit NOT set." << std::endl;
    }
  }

   ....

 private:
  std::ifstream fs;
}; 
```

输入文件由二十个字节组成：0123456789abcdefghij

样本运行的输出：

```
testTriggered(): OpeningFile: failbit NOT set.
testTriggered(): OpeningFile: badbit NOT set.
testTriggered(): OpeningFile: eofbit NOT set.
testTriggered(): seekTwoThousand: failbit NOT set.
testTriggered(): seekTwoThousand: badbit NOT set.
testTriggered(): seekTwoThousand: eofbit NOT set.
get pointer is:2000 
```

g++ 版本信息： $ g++ -v 使用内置规范。目标：x86_64-linux-gnu 配置为：../src/configure -v --with-pkgversion='Ubuntu 4.4.3-4ubuntu5' -with-gxx-include-dir=/usr/include/c++/4.4 [ snip] gcc 版本 4.4.3 (Ubuntu 4.4.3-4ubuntu5)

$ uname -a Linux hostx 2.6.32-36-server #79-Ubuntu SMP Tue Nov 8 22:44:38 UTC 2011 x86_64 GNU/Linux

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:57:25.237

`fseek()`（可能用于实现）的 Open Group 规范`fstream::seekg`需要允许文件位置超出当前文件结尾：

> *fseek()*函数应允许将文件位置指示符设置在文件中现有数据的末尾之外。如果稍后在此点写入数据，则后续读取间隙中的数据应返回值为 0 的字节，直到数据实际写入间隙。

[http://pubs.opengroup.org/onlinepubs/009696699/functions/fseek.html](http://pubs.opengroup.org/onlinepubs/009696699/functions/fseek.html)

# slickgrid - 当我在 SlickGrid 上调用 setColumns 时，为什么我的列设置得非常宽

> ID：11022419
> 
> 赞同：0
> 
> 时间：2012-06-13T19:59:02.987
> 
> 标签：slickgrid

当我以这种方式创建 SlickGrid 时：

```
var grid = new Slick.Grid(
  element, //needs to be something jQuery can act on: element, css selector, etc.
  dataView,
  [], //columns
  gridOptions
); 
```

然后像这样设置列：

```
grid.setColumns(parameters.columns);
grid.autosizeColumns(); 
```

我的列是否很宽？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:00:20.617

如果我删除或注释掉该行：

```
grid.autosizeColumns(); 
```

列按照我的预期呈现。

# ember.js - 检查项目是否已在 ember-data 存储中

> ID：11022422
> 
> 赞同：1
> 
> 时间：2012-06-13T19:59:10.317
> 
> 标签：ember.js, ember-data

我正在进行很多异步调用并使用 loadMany 来预加载 ember 数据存储，如下所示：

```
if(data.feed.activities.length > 0){
  App.store.loadMany(App.Activity, data.feed.activities);
} 
```

如果我不止一次地阅读同一个项目，我的一些绑定会搞砸，这是有可能的。

如果商品已经在商店中，有没有办法不重新加载商品？我不想遍历每个项目并检查是否可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T01:08:16.807

这是来自 store.js 中的 load() 文档

> “为给定的 id 和类型组合将新的数据哈希加载到存储中。如果先前已加载该记录的数据，则新信息将覆盖旧信息。如果您正在为其加载数据的记录具有尚未完成的未完成更改保存，会抛出异常。”

如您所见，新信息会覆盖旧信息，因此重新加载相同的数据应该是可以的。也许你还有另一个问题。您是否正确配置了您的 id？

# chef-infra - 厨师角色和环境 default_attributes 不可访问

> ID：11022425
> 
> 赞同：4
> 
> 时间：2012-06-13T19:59:19.930
> 
> 标签：chef-infra

假设我有以下厨师角色：

```
name "test"
description "role for test"
run_list %w(recipe[cookbook_name])
default_attributes(
  :cookbook_name => {
    :a => 1
  }
) 
```

以及对应的环境：

```
name "test environment"
description "environment for test"
default_attributes(
  :cookbook_name => {
    :b => 2
  }
) 
```

然后在我的食谱的属性中，我有类似的东西：

```
parent = default[:cookbook_name]
parent[:c] = 3 
```

[属性文档](http://wiki.opscode.com/display/chef/Attributes#Attributes-AttributeAccessorMethods)会让我相信这些将在配方上下文中可用`node[:cookbook_name][:a]`或`node[:cookbook_name][:b]`。但是，当我尝试访问我实际食谱中的那些时，我得到`nil`. 这是怎么回事？我是否误解了这些属性的作用？我认为值得注意的是，即使我在属性文件中为这些属性设置了默认值，我也会得到相同的结果，这让我相信我错误地访问了这些属性。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T23:18:03.963

这确实是事情应该如何运作的。在“cookbook_name”配方中，您应该能够`:cookbook_name`使用两个元素`:a`和`:b`.

您是否在节点上设置了运行列表和环境以包含您列出的角色和环境？跑步`knife node show`应该显示这一点。

# c# - SFML C# 旋转视图

> ID：11022428
> 
> 赞同：0
> 
> 时间：2012-06-13T19:59:36.157
> 
> 标签：c#, rotation, sfml

在查看 SFML 的文档时，我注意到旋转 View 对象的能力，这似乎是 C#/.net 绑定中缺少的，它仍然可能吗？如果没有，是否有解决方法？

```
View V = new View(new FloatRect(0,0,640,640));
V.Rotate(45); 
```

“SFML.Graphics.View”不包含“Rotate”的定义，并且没有扩展方法“Rotate”接受“SFML.Graphics.View”类型的第一个参数

我正在使用此处提供的 .Net 1.6 版本 [http://www.sfml-dev.org/download.php](http://www.sfml-dev.org/download.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T20:26:35.923

SFML 1.6 不支持这一点，请使用 SFML 2.0 Release Candidate。

# javascript - jsp-如何将输入值分配给我以后想使用的另一个变量？

> ID：11022432
> 
> 赞同：0
> 
> 时间：2012-06-13T19:59:48.420
> 
> 标签：javascript, html, jsp

问题是

当我说：

```
alert(parseInt(document.frmFuture.txtDays.value) + 7); 
```

（值是用户输入的数字）它显示得很好。

但是当我说：

```
var tmp = document.frmFuture.txtDays.value;
alert(tmp + 7); 
```

它给了我未定义的。

实际上，我想稍后使用输入的数字做一些 cals。但这看起来不可能？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:46:00.067

你忘了`parseInt`.

```
var tmp = parseInt(document.frmFuture.txtDays.value);
alert(tmp + 7); 
```

现在它应该可以工作了。

# asp.net-mvc-3 - 如何在剃须刀 MVC3 中绘制复选框

> ID：11022435
> 
> 赞同：0
> 
> 时间：2012-06-13T19:59:57.013
> 
> 标签：asp.net-mvc-3, razor

```
@model IEnumerable<FacetValue>
<ul>
    @foreach (var association in Model)
    {
        <li>

            **@Html.CheckBox("association",association.IsSelected) @Html.Label("association", association.Text)**

            @if (association.IsSelected == true)
            {
                <input type="checkbox" id="association" class="left" value="@association.Text" checked="checked"/>
            }
            else
            {
                <input type="checkbox" id="association" class="left" value="@association.Text"/>
            }
            <label>@association.Text</label>
        </li> 
    }
</ul> 
```

我正在使用以@if 与@htmlCheckBox 开头的代码。1\. 布局乱了 2\. 不显示乱了 一个地方显示复选框，另一个地方显示文字。3\. 为每个复选框生成一个隐藏值。

现在的问题是如何在没有@if else 逻辑的情况下显示我想要的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:07:52.547

要绑定复杂的对象，我们需要为每个项目提供一个索引以确保正确的回发。这就是我们需要将 IEnumerable<> 更改为 IList<> 的原因（或者您可以创建另一个变量并使用 Model.ToList() 填充它）。比我们需要将 foreach() 更改为 for()，因此 Html.CheckBoxFor 可以正确地创建将确保正确回发的 ID 和 NAME。

```
@model IList<FacetValue>
<ul>
    @for (int i = 0; i < Model.Count(); i++)
    {
        <li>
            @Html.LabelFor(model => model.Model[i].IsSelected, Model[i].Text)
            @Html.CheckBoxFor(model => model.Model[i].IsSelected)
        </li> 
    }
</ul> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T03:46:05.467

没有必要重新发明轮子。这是一个非常好的帖子： [Asp.net MVC Multiple check-boxes in an array](http://www.shawnmclean.com/blog/2011/04/asp-net-mvc-multiple-check-boxes-in-an-array-or-list/)

如果它仍然没有涵盖您的场景，请查看此预先存在的讨论：

[讨论1](https://stackoverflow.com/questions/3291501/maintain-state-of-a-dynamic-list-of-checkboxes-in-asp-net-mvc/3298821#3298821)、[讨论2](https://stackoverflow.com/q/3291501/1437962)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:13:17.837

您可以使用属性附加 Visible 自定义 Check box 的扩展方法，并在创建 checkbox 时，传递 visible 的值

# android - libgdx 不显示 admob

> ID：11022438
> 
> 赞同：0
> 
> 时间：2012-06-13T20:00:05.160
> 
> 标签：android, admob, libgdx

请告诉我为什么看不到横幅广告。画面与游戏一起显示，好像没有提供横幅一样。不会发生错误。

```
@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);             
    RelativeLayout layout = new RelativeLayout(this);  

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
                    WindowManager.LayoutParams.FLAG_FULLSCREEN);
    getWindow().clearFlags(WindowManager.LayoutParams.FLAG_FORCE_NOT_FULLSCREEN);

    View gameView = initializeForView(new GraphicsView(), false);
    AdView adView = new AdView(this, AdSize.BANNER, "a14fd65977f0c9f");
    adView.loadAd(new AdRequest());

    RelativeLayout.LayoutParams adParams = 
            new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, 
                            RelativeLayout.LayoutParams.WRAP_CONTENT);
    adParams.addRule(RelativeLayout.ALIGN_PARENT_TOP);
    adParams.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);

    layout.addView(gameView);
    layout.addView(adView, adParams);
    setContentView(layout);
} 
```

应用程序时写入的日志：

```
06-16 00:24:38.359: W/webcore(1236): Can't get the viewWidth after the first layout
06-16 00:24:38.639: I/Ads(1236): Received ad url: <url: "http://googleads.g.doubleclick.net:80/mads/gma?preqs=0&session_id=6766832335174985152&u_sd=1&slotname=a14fd65977f0c9f&u_w=320&msid=ru.bk.sobaka.n.e.k&cap=m&js=afma-sdk-a-v6.0.1&mv=4002306.com.android.vending&isu=ECF7E913C428C1C5F97C257CF153F328&cipa=0&format=320x50_mb&net=ed&app_name=1.android.ru.bk.sobaka.n.e.k&hl=ru&u_h=480&carrier=25001&ptime=0&u_audio=1&u_so=p&output=html&region=mobile_app&u_tz=-240&ex=1&client_sdk=1&caps=interactiveVideo_clickTracking_sdkAdmobApiForAds&jsv=26" type: "admob" afmaNotifyDt: "null">
06-16 00:24:38.879: W/Ads(1236): IOException connecting to ad url.
06-16 00:24:38.879: W/Ads(1236): java.net.ConnectException: googleads.g.doubleclick.net/127.0.0.1:80 - Connection refused
06-16 00:24:38.879: W/Ads(1236):    at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:207)
06-16 00:24:38.879: W/Ads(1236):    at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:437)
06-16 00:24:38.879: W/Ads(1236):    at java.net.Socket.connect(Socket.java:983)
06-16 00:24:38.879: W/Ads(1236):    at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection.<init>(HttpConnection.java:75)
06-16 00:24:38.879: W/Ads(1236):    at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection.<init>(HttpConnection.java:48)
06-16 00:24:38.879: W/Ads(1236):    at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection$Address.connect(HttpConnection.java:322)
06-16 00:24:38.879: W/Ads(1236):    at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnectionPool.get(HttpConnectionPool.java:89)
06-16 00:24:38.879: W/Ads(1236):    at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getHttpConnection(HttpURLConnectionImpl.java:285)
06-16 00:24:38.879: W/Ads(1236):    at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.makeConnection(HttpURLConnectionImpl.java:267)
06-16 00:24:38.879: W/Ads(1236):    at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:205)
06-16 00:24:38.879: W/Ads(1236):    at com.google.ads.internal.f.b(SourceFile:428)
06-16 00:24:38.879: W/Ads(1236):    at com.google.ads.internal.f.run(SourceFile:399)
06-16 00:24:38.879: W/Ads(1236):    at java.lang.Thread.run(Thread.java:1019) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T06:53:58.667

这是我在《非常愤怒的机器人》中投放广告时使用的代码。直到我的视图被添加到布局之后，我才要求加载广告。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    goFullScreen();
    View gameView = createGameView();
    AdView adView = createAdView();
    LinearLayout layout = new LinearLayout(this);
    layout.setOrientation(LinearLayout.VERTICAL);
    LayoutParams layoutParams = new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
    layout.addView(adView, layoutParams);
    layout.addView(gameView, layoutParams);
    setContentView(layout);
    startAdvertising(adView);
}

private AdView createAdView() {
    AdView adView = new AdView(this, AdSize.BANNER, PUBLISHER_ID);
    return adView;
}

private void startAdvertising(AdView adView) {
    AdRequest adRequest = new AdRequest();
    adRequest.addTestDevice(MY_PHONE);
    adView.loadAd(adRequest);
} 
```

# emacs - org-mode 文字示例中的下划线

> ID：11022439
> 
> 赞同：5
> 
> 时间：2012-06-13T20:00:06.280
> 
> 标签：emacs, org-mode

根据文字示例的[说明](http://orgmode.org/manual/Literal-examples.html)，文字示例不应进行标记。但是有没有办法在文字示例中使用任何标记？

例如，考虑以下文字示例片段。

```
 #+BEGIN_EXAMPLE
 Enter the city you're from: Chicago
 #+END_EXAMPLE 
```

我想在 Chicago 这个词上加一个下划线，因为我想强调 Chicago 这个词是由用户输入的。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T20:42:20.707

如果您想要的只是以示例方式排版的示例，您可能可以使用[强调标记](http://orgmode.org/manual/Emphasis-and-monospace.html#Emphasis-and-monospace)，至少对于需要标记的行。那将是

```
=Enter the city you're from:= _Chicago_ 
```

我认为您的要求根本不可能，可能是因为这些块似乎是**设计**的，不受标记的影响。

对于特定于语言的标记，请使用源代码`#+begin_src`块`#+begin_src org`（ ，我想这就是 in-line org 的用途）。

# entity-framework - 为什么 GetValidationResult 在执行验证之前禁用延迟加载？

> ID：11022442
> 
> 赞同：1
> 
> 时间：2012-06-13T20:00:17.880
> 
> 标签：entity-framework

为什么实体框架的 GetValidationResult 方法会在执行验证之前禁用延迟加载。

验证期间延迟加载有哪些不利影响？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:31:55.377

不加载在验证开始之前未加载的实体。第一次验证仅用于验证而不是加载实体。其次，您不希望在验证时向数据库发送额外的查询。第三（与第二个相关） - 额外的查询会破坏验证的性能 - 单个查询可能需要比验证本身更长的时间，并且存在发送大量这些查询的风险。顺便提一句。您希望在验证期间启用延迟加载的场景是什么？

# javascript - 从 Highcharts 中的 HTML 表格中解析日期

> ID：11022445
> 
> 赞同：1
> 
> 时间：2012-06-13T20:00:36.077
> 
> 标签：javascript, jquery, highcharts

我正在尝试使用 HighCharts 的 HTML-table-to-chart 脚本从表格中创建折线图。

我想要一个`datetime`x轴，所以这就是我所做的：

*   用于`Date.parse(this.innerHTML)`将行标题转换为日期字符串。
*   在我的 xAxis 选项对象中设置`type`为。`datetime`

日期转换工作正常，并在默认工具提示中正确显示，但图表本身将 x 值视为类别，而不是日期时间。我假设它与点对象的设置方式有关，但我不确定如何解决它。

```
Highcharts.visualize = function(table, options) {

    // the categories
    options.xAxis.categories = [];

    $('tbody th', table).each(function(i) {
        var date = Date.parse(this.innerHTML);
        options.xAxis.categories.push(date);
    });

    // the data series
    options.series = [];
    $('tr', table).each(function(i) {
        var tr = this;
        $('th, td', tr).each(function(j) {
            if (j > 0) { // skip first column
                if (i === 0) { // get the name and init the series
                    options.series[j - 1] = {
                        name: this.innerHTML,
                        data: []
                    };
                } else { // add values
                    options.series[j - 1].data.push(parseFloat(this.innerHTML));
                }
            }
        });
    });

    charts[charts.length] = new Highcharts.Chart(options);
}; 
```

有什么建议么？

这是一个小提琴：http: [//jsfiddle.net/supertrue/et2Vy/](http://jsfiddle.net/supertrue/et2Vy/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:16:31.920

Highcharts 将 xAxis 视为类别，因为您告诉它这样做。
这里：`options.xAxis.categories.push(date);`

您必须使用`{ x: xval, y: yval }`（或`[xval,yval]`）作为您的系列的数据类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:18:09.627

您可能已将 xAxis 设置为 datetime，但您正在设置类别列表 ( `options.xAxis.categories = [];`)。您需要做的是将 x,y 值作为一个“点”发送到您的 data.push 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T07:08:28.590

dateTimeLabelFormats : Object 对于日期时间轴，刻度会自动调整到适当的单位。该成员给出了用于每个单元的默认字符串表示。有关替换代码的概述，请参阅 dateFormat。默认为：{ 秒：'%H:%M:%S'，分钟：'%H:%M'，小时：'%H:%M'，天：'%e。%b'，周：'%e. %b', month: '%b \'%y', year: '%Y' } [highcharts 参考示例](http://jsfiddle.net/gh/get/jquery/1.7.1/highslide-software/highcharts.com/tree/master/samples/highcharts/xaxis/datetimelabelformats/)

无论如何这可能不是正确的答案，希望这会有所帮助:)

# c++ - 两个向量之间的最短旋转方向

> ID：11022446
> 
> 赞同：7
> 
> 时间：2012-06-13T20:00:37.507
> 
> 标签：c++, vb.net, geometry, rotation

我的问题是关于计算二维中两个向量之间最小角度的方向。我正在用 C++ 制作游戏，其中一个障碍是寻热导弹发射器。我通过计算目标和子弹之间的向量、标准化向量然后乘以它的速度来让它工作。但是，我现在要回到这门课上，让它变得更好。我希望它仅在子弹矢量处于某个角度（子弹矢量和矢量 bulletloc-> 目标之间的角度）内时才立即锁定玩家，而不是立即锁定玩家。否则，我希望它缓慢地向目标平移一个度数，从而为玩家提供足够的空间来避开它。我已经完成了所有这些（在一个 vb.net 项目中，所以我可以简化问题，解决它然后用 C++ 重新编写）。然而，即使最快的路线是逆时针方向，子弹总是顺时针方向旋转。所以问题在于确定应用旋转的方向，以便覆盖最小的角度。这是我的代码，因此您可以尝试查看我所描述的内容：

```
 Function Rotate(ByVal a As Double, ByVal tp As Point, ByVal cp As Point, ByVal cv As Point)
    'params a = angle, tp = target point, cp = current point, cv = current vector of bullet'
    Dim dir As RotDir 'direction to turn in'
    Dim tv As Point 'target vector cp->tp'
    Dim d As Point 'destination point (d) = cp + vector'
    Dim normal As Point
    Dim x1 As Double
    Dim y1 As Double
    Dim VeritcleResolution As Integer = 600

    tp.Y = VeritcleResolution - tp.Y 'modify y parts to exist in plane with origin (0,0) in bottom left'
    cp.Y = VeritcleResolution - cp.Y
    cv.Y = cv.Y * -1

    tv.X = tp.X - cp.X 'work out cp -> tp'
    tv.Y = tp.Y - cp.Y

    'calculate angle between vertor to target and vecrot currntly engaed on'
    Dim tempx As Double
    Dim tempy As Double

    tempx = cv.X * tv.X
    tempy = cv.Y * tv.Y

    Dim DotProduct As Double

    DotProduct = tempx + tempy 'dot product of cp-> d and cp -> tp'

    Dim magCV As Double 'magnitude of current vector'
    Dim magTV As Double 'magnitude of target vector'

    magCV = Math.Sqrt(Math.Pow(cv.X, 2) + Math.Pow(cv.Y, 2))
    magTV = Math.Sqrt(Math.Pow(tv.X, 2) + Math.Pow(tv.Y, 2))

    Dim VectorAngle As Double

    VectorAngle = Acos(DotProduct / (magCV * magTV))
    VectorAngle = VectorAngle * 180 / PI 'angle between cp->d and cp->tp'

    If VectorAngle < a Then 'if the angle is small enough translate directly towards target'
        cv = New Point(tp.X - cp.X, tp.Y - cp.Y)
        magCV = Math.Sqrt((cv.X ^ 2) + (cv.Y ^ 2))

        If magCV = 0 Then
            x1 = 0
            y1 = 0
        Else
            x1 = cv.X / magCV
            y1 = cv.Y / magCV
        End If

        normal = New Point(x1 * 35, y1 * 35)
        normal.Y = normal.Y * -1

        cv = normal
    ElseIf VectorAngle > a Then 'otherwise smootly translate towards the target'
        Dim x As Single
        d = New Point(cp.X + cv.X, cp.Y + cv.Y)

        a = (a * -1) * PI / 180 'THIS LINE CONTROL DIRECTION a = (a*-1) * PI / 180 would make the rotation counter clockwise'

        'rotate the point'
        d.X -= cp.X
        d.Y -= cp.Y

        d.X = (d.X * Cos(a)) - (d.Y * Sin(a))
        d.Y = (d.X * Sin(a)) + (d.Y * Cos(a))

        d.X += cp.X
        d.Y += cp.Y

        cv.X = d.X - cp.X
        cv.Y = d.Y - cp.Y

        cv.Y = cv.Y * -1
    End If

    Return cv

End Function 
```

我的一个想法是计算出两个向量的方位角，如果差异大于 180 度，则顺时针旋转，否则逆时针旋转，任何想法都会有所帮助。谢谢。

编辑：我想补充一点，这个网站非常有帮助。我经常用别人提出的问题来解决我自己的问题，我想借此机会说声谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-13T20:13:07.077

正如您在代码中所写，两个（归一化）向量之间的角度是它们的点积的反余弦。

要获得带*符号*的角度，您可以使用第三个向量表示其他两个向量所在的平面的法线 - 在您的 2D 情况下，这将是一个指向“向上”直线的 3D 向量，例如 (0, 0, 1）。

然后，取第一个向量（您希望角度相对的向量）与第二个向量的叉积（注意叉积不是可交换的）。角度的符号应与结果向量和平面法线之间的点积符号相同。

在代码中（C#，抱歉）——注意所有向量都被假定为标准化：

```
public static double AngleTo(this Vector3 source, Vector3 dest)
{
    if (source == dest) {
        return 0;
    }
    double dot; Vector3.Dot(ref source, ref dest, out dot);
    return Math.Acos(dot);
}

public static double SignedAngleTo(this Vector3 source, Vector3 dest, Vector3 planeNormal)
{
    var angle = source.AngleTo(dest);
    Vector3 cross; Vector3.Cross(ref source, ref dest, out cross);
    double dot; Vector3.Dot(ref cross, ref planeNormal, out dot);
    return dot < 0 ? -angle : angle;
} 
```

这是通过利用两个向量之间的叉积产生第三个向量的事实来工作的，该向量与前两个向量定义的平面垂直（法线）（因此它本质上是一个 3D 操作）。`a x b`= `-(b x a)`，因此向量将始终垂直于平面，但在不同的一侧取决于和之间的（有符号）角度`a`（`b`有一种叫做[右手法则](http://en.wikipedia.org/wiki/Cross_product#Definition)的东西）。

所以叉积为我们提供了一个垂直于平面的有符号矢量，当矢量之间的角度超过 180° 时，该平面会改变方向。如果我们事先知道一个垂直于平面的向量，*它指向正上方*，那么我们可以通过检查它们的点积的符号来判断叉积是否与该平面法线的方向相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-03T15:41:48.667

根据@Cameron 的回答，这里是我使用的python 翻译：
*作为奖励，我添加了signed_angle_between_headings 函数来直接返回两个指向北方的航向之间的“最快”转角。*

```
 import math
    import numpy as np

    def angle_between_vectors(source, dest):
        if np.array_equal(source, dest):
            return 0
        dot = np.dot(source, dest)
        return np.arccos(dot)

    def signed_angle_from_to_vectors(source, dest, plane_normal):
        angle = angle_between_vectors(source, dest)
        cross = np.cross(source, dest)
        dot = np.dot(cross, plane_normal)
        return -angle if dot < 0 else angle

    def signed_angle_between_headings(source_heading, destination_heading):
        if source_heading == destination_heading:
            return 0
        RAD2DEGFACTOR = 180 / math.pi

        source_heading_rad = source_heading / RAD2DEGFACTOR
        dest_heading_rad = destination_heading / RAD2DEGFACTOR
        source_vector = np.array([np.cos(source_heading_rad), np.sin(source_heading_rad), 0])
        dest_vector = np.array([np.cos(dest_heading_rad), np.sin(dest_heading_rad), 0])

        signed_angle_rad = signed_angle_from_to_vectors(source_vector, dest_vector, np.array([0,0,1]))

        return signed_angle_rad * RAD2DEGFACTOR 
```

# excel - Excel 10 单元格内容验证依赖于另一个字段

> ID：11022449
> 
> 赞同：0
> 
> 时间：2012-06-13T20:00:51.910
> 
> 标签：excel, validation

我正在尝试根据同一工作簿中另一个单元格的内容来验证单元格中的条目。例如，A1 可以包含 AAA 或 BBB。我在 A2 中输入数据。

如果单元格 A1 包含 AAA，则单元格 A2 中的条目必须大于 6。如果单元格 A1 包含 BBB，则单元格 A2 中的条目必须大于 14。

我尝试使用基于公式的自定义验证和验证，但我无法按照我想要的方式工作。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:30:45.147

您的自定义验证公式将是：

```
=OR(AND(A1="BBB",A2>14),AND(A1="AAA",A2>6)) 
```

请务必包含有用的错误消息。

# objective-c - 在 NSUserDefaults 上获取 BOOL 值

> ID：11022450
> 
> 赞同：-1
> 
> 时间：2012-06-13T20:00:58.313
> 
> 标签：objective-c, ios

在我的 viewDidLoad 里面，我有以下内容。但我似乎无法正确使用语法。

```
[led.highlighted: [[NSUserDefaults standardUserDefaults] boolForKey:@"led"]]; 
```

我也试过

```
[led.highlighted setValue:[[NSUserDefaults standardUserDefaults] boolForKey:@"led"]]; 
```

但是那个错误与“错误的接收器类型'BOOL'”

我从 IBAction 设置值的方法似乎没问题。

```
[[NSUserDefaults standardUserDefaults] setBool:led.isHighlighted forKey:@"led"]; 
```

那么我究竟如何返回 led.highlighted 的值呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:10:35.217

`led.highlighted`访问该财产；根据它位于语句的右侧或左侧，它分别使用 getter 或 setter。

```
led.highlighted = YES;
// Equivalent to: [led setHighlighted:YES];
BOOL thatLEDIsLitUp = led.highlighted;
// Equivalent to: BOOL thatLEDIsLitUp = [led highlighted]; 
```

这假设您没有将 getter 和 setter 名称更改为`isHighlighted`and`setIsHighlighted:`

鉴于此，要设置属性，您可以执行以下任一操作：

```
led.highlighted = [[NSUserDefaults standardUserDefaults] boolForKey:@"led"]; 
```

或者

```
[led setHighlighted:[[NSUserDefaults standardUserDefaults] boolForKey:@"led"]]; 
```

您的第一次尝试`[led.highlighted:...]`只是语法不正确。第二个，`[led.highlighted setValue:...]`使用访问器获取`highlighted`a `BOOL`，然后尝试向它发送消息。`BOOL`s 不是对象，因此您不能向它们发送消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:06:35.420

```
led.highlighted = [[NSUserDefaults standardUserDefaults] boolForKey:@"led"]; 
```

只要你的`highlighted`财产是 `@property (nonatomic, assign) BOOL highlighted;`

# mysql - 多对多关系数据库中与标签表结合的同义词

> ID：11022455
> 
> 赞同：0
> 
> 时间：2012-06-13T20:01:27.963
> 
> 标签：mysql, many-to-many

我正在使用歌曲数据库系统在多对多关系数据库上使用 mysql 学习 php。下面显示了三个表的组织方式：

```
Songs       Link        Tags
=======     =====       =======
Sid          Sid        Tid
Songname     Tid        Tagname 
```

现在我在想如果有标签同义词怎么办？因为我正在计算每首歌曲的匹配百分比，并结合输入的标签。我不想为一首歌曲输入 20 个标签，所以我涵盖了所有可能性，但因此破坏了匹配百分比，因为输入了 4 个标签，这导致 4/20 匹配，即 20%，而它可能必须是 4/8 （50%）。

有没有一种聪明的方法来为同义词创建一个表，确保标签是“分组的”，以便首先用这个表检查输入的标签，然后这个/这些“头标签”与链接表匹配导致歌曲名和输入标签的匹配百分比/“头部标签”的总数×100％？

最重要的是，您将如何创建一个查询，当输入一首新歌曲时，新标签会被输入到它们所属的组中，而现有的标签会被跳过。同时将这个头标签也链接到新歌？

我不确定这个想法是否现实，但我想知道其他系统如何做到这一点，以确保您获得准确的匹配，同时也考虑同义词。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:13:08.243

当然 - 你的部分答案只是更进一步：

```
tag_synonym
-----------
Tid
Tid2 
```

然后您可以查询是否有任何同义词被链接以及原始标签

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:38:57.783

您可以在表标签中添加第三行：

```
Tags
--------------
Tid
Tagname
HeadTagId 
```

所以每个标签都会引用一个 HeadTag，而 HeadTags 会引用它们自己。

关于查询，我想象两种情况。任何一个

**- 标签是预定义的：**当输入一首新歌曲时，您只需在歌曲中添加一行，在链接中添加与它所拥有的标签一样多的行。无需触摸表标签。

或者

**- 用户可以定义新标签：**输入新歌曲时，检查标签是否已经存在，如果不存在，用户应该能够输入新标签，并将它们定义为头标签或选择现有的“头标签” ' 对于他们（即第三行标签中引用的标签）。

无论如何，要检索给定歌曲的头部标签，您需要类似以下内容：

```
SELECT HeadTagId FROM Tags
JOIN Link ON Tags.Tid=Link.Tid
WHERE Link.Sid=12345 
```

如果您想要直接使用 head_tag 的名称（而不是 Id）：

```
SELECT Tagname FROM Tags AS TagParents
JOIN Tags AS TagChildren ON TagParents.Tid=TagChildren.HeadTagId
JOIN Link ON Link.Tid=TagChildren.Tid
WHERE Link.Sid=12345 
```

**编辑：**在这种情况下，您不需要多对多关系，因为每个标签必须要么声明它是主标签，要么声明它是同义词，并指向主标签。这是由第三行完成的。对我来说，将它包含在同一个表中是有意义的，因为它是每个标签的必要属性，并且每个标签只有一个这样的属性。

所以主要标签是指自己，即：

```
Tid: 1
Tagname: 'Classical'
HeadTagId: 1 
```

同义词指的是主要标签：

```
Tid: 2
Tagname: 'Classical music'
HeadTagId: 1 
```

这种方法的唯一问题是您没有直接的主要标签列表，但您可以使用简单的方法生成它：

```
SELECT DISTINCT HeadTagId FROM Tags 
```

# jsf - Primefaces 重复值的行分组

> ID：11022456
> 
> 赞同：3
> 
> 时间：2012-06-13T20:01:29.833
> 
> 标签：jsf, datatable, primefaces, icefaces

primefaces 是否能够像 icefaces 那样在数据表中动态地对行进行分组？

```
 <ice:column groupOn="#{employee.region}">...<ice:column>
 <ice:column groupOn="#{employee.office}">...<ice:column> 
```

> **不幸的是，可扩展的行分组不适合我！**

![icefaces 行分组](../Images/daf66ce5acab5242170cf6dfff39f7cd.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-04-25T21:42:50.313

在 6.0.11 之前的 PrimeFaces 中，这是不可能的。在 6.0.11 或 6.1 及更高版本中它可以工作。它是作为功能请求实现的：[https ://github.com/primefaces/primefaces/issues/39](https://github.com/primefaces/primefaces/issues/39)

# cabal - 安装pango时cabal安装失败

> ID：11022458
> 
> 赞同：4
> 
> 时间：2012-06-13T20:01:32.847
> 
> 标签：cabal, cabal-install

Cabal 在尝试安装 pango 时失败，抱怨找不到 pkg-config。

```
peauters:~ $ sudo cabal install pango -v
Password:
Reading available packages...
Choosing modular solver.
Resolving dependencies...
Extracting
/Users/chris/Library/Haskell/repo-cache/hackage.haskell.org/pango/0.12.3/pango-0.12.3.tar.gz
to /tmp/pango-0.12.3-76116...
creating /tmp/pango-0.12.3-76116/pango-0.12.3/dist/setup
creating /tmp/pango-0.12.3-76116/pango-0.12.3/dist
creating /tmp/pango-0.12.3-76116/pango-0.12.3/dist/setup
/usr/bin/ghc --make /tmp/pango-0.12.3-76116/pango-0.12.3/Setup.hs -o /tmp/pango-0.12.3-76116/pango-0.12.3/dist/setup/setup -odir /tmp/pango-0.12.3-76116/pango-0.12.3/dist/setup -hidir /tmp/pango-0.12.3-76116/pango-0.12.3/dist/setup -i -i/tmp/pango-0.12.3-76116/pango-0.12.3 -package Cabal-1.14.0
[1 of 2] Compiling SetupWrapper     ( /tmp/pango-0.12.3-76116/pango-0.12.3/SetupWrapper.hs, /tmp/pango-0.12.3-76116/pango-0.12.3/dist/setup/SetupWrapper.o )
[2 of 2] Compiling Main             ( /tmp/pango-0.12.3-76116/pango-0.12.3/Setup.hs, /tmp/pango-0.12.3-76116/pango-0.12.3/dist/setup/Main.o )
Linking /tmp/pango-0.12.3-76116/pango-0.12.3/dist/setup/setup ...
/tmp/pango-0.12.3-76116/pango-0.12.3/dist/setup/setup configure --verbose=2
--ghc --prefix=/Library/Haskell/$compiler/lib/$pkgid --libsubdir=
--datasubdir= --docdir=$prefix/doc --enable-library-profiling --global
--flags=new-exception --constraint=process ==1.1.0.1 --constraint=pretty
==1.1.1.0 --constraint=mtl ==2.1.1 --constraint=glib ==0.12.3.1
--constraint=directory ==1.1.0.2 --constraint=containers ==0.4.2.1
--constraint=cairo ==0.12.3.1 --constraint=base ==4.5.0.0 --constraint=array
==0.4.0.0 --disable-tests --disable-benchmarks
[1 of 2] Compiling Gtk2HsSetup      ( Gtk2HsSetup.hs, dist/setup-wrapper/Gtk2HsSetup.o )
[2 of 2] Compiling Main             ( SetupMain.hs, dist/setup-wrapper/Main.o )
Linking dist/setup-wrapper/setup ...
Configuring pango-0.12.3...
Flags chosen: new-exception=True
Dependency array ==0.4.0.0: using array-0.4.0.0
Dependency base ==4.5.0.0: using base-4.5.0.0
Dependency cairo ==0.12.3.1: using cairo-0.12.3.1
Dependency containers ==0.4.2.1: using containers-0.4.2.1
Dependency directory ==1.1.0.2: using directory-1.1.0.2
Dependency glib ==0.12.3.1: using glib-0.12.3.1
Dependency mtl ==2.1.1: using mtl-2.1.1
Dependency pretty ==1.1.1.0: using pretty-1.1.1.0
Dependency process ==1.1.0.1: using process-1.1.0.1
setup: The pkg-config package pango version <1.26.0 || >1.26.2 is required but
it could not be found.
World file is already up to date.
cabal: Error: some packages failed to install:
pango-0.12.3 failed during the configure step. The exception was:
ExitFailure 1 
```

pkg-config 通过 Homebrew 安装：

```
peauters:~ $ which pkg-config
/usr/local/bin/pkg-config
peauters:~ $ pkg-config --version
0.25 
```

关于这个问题的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:43:34.513

这个错误有点令人困惑。

这就是说你需要安装非阴谋集团包“pango”。

我用 brew install pango 做到了这一点并解决了这个问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-10T10:22:05.127

对于 ubuntu，请参阅[http://www.haskell.org/haskellwiki/Gtk2Hs/Linux](http://www.haskell.org/haskellwiki/Gtk2Hs/Linux)它给出了

`sudo apt-get install libgtk2.0-dev libpango1.0-dev libglib2.0-dev libcairo2-dev`

# c# - 按钮点击事件错误

> ID：11022465
> 
> 赞同：0
> 
> 时间：2012-06-13T20:01:46.060
> 
> 标签：c#, asp.net, visual-studio-2005

刚刚在我的 Web 应用程序中添加了一个新按钮，单击它时出现错误，我想知道这是否与错误放置的代码有关。我将简要描述我做了什么/在哪里。非常感谢。

在 ascx 文件中：

```
<asp:Button ID="btn_rezerv" runat="server" Text="Reserve film" OnClick="btn_rezerv_Click"/> 
```

在 ascx.cs 文件中：

```
namespace CinProj.UserControls
{
    public partial class FilmsList : System.Web.UI.UserControl
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            PopulateControls();

        }

        private void PopulateControls()
        {
            string categId = Request.QueryString["CategID"];
            string filmId = Request.QueryString["FilmID"];
            ....

            if (categId != null)
            {
                .....
            }
            if (filmId != null)
            {
                ......
                Button btn_rezerv = (Button)item.FindControl("btn_rezerv");

            }

        }

        protected void btn_rezerv_Click(object sender, EventArgs e)
        {
            string fid = Request.QueryString["FilmID"];
            ShoppingCartAccess.AddItem(fid);
        }

    }
} 
```

## “'/'应用程序中的服务器错误。

无效的回发或回调参数。使用配置或页面中的 <%@ Page EnableEventValidation="true" %> 启用事件验证。出于安全目的，此功能验证回发或回调事件的参数是否源自最初呈现它们的服务器控件。如果数据有效且符合预期，请使用 ClientScriptManager.RegisterForEventValidation 方法注册回发或回调数据以进行验证。"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:13:28.120

这可能是服务器不知道的某种客户端更改的结果。例如，很多时候这是在 JavaScript 中更改下拉列表中的值的结果。

要修复，您可以：

1.  取消使用 JavaScript 进行上述修改
2.  使用 UpdatePanel 并将您的控件添加到其中。如果客户端需要进行更改，请触发 UpdatePanel 的更新以更新控件的视图状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:43:58.837

另一个问题可能是因为您的 PopulateControls 方法可能只应在页面加载期间调用，而不是 PostBack。我无法从上面看出，但对我来说，它看起来只需要在加载时完成。尝试用这个包装那个调用：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {    
            PopulateControls();
        }
    } 
```

# iphone - 如何使用 UIAppearance 设置子类而不是超类的样式？

> ID：11022468
> 
> 赞同：4
> 
> 时间：2012-06-13T20:01:57.763
> 
> 标签：iphone, ios, cocoa-touch

我正在用[UIAppearance 为](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html)我的 UINavigationBar 设计样式。我希望所有后退按钮都有**灰色**文本，我的所有 rightBarButtonItems 都有**绿色**文本（颜色是假设的）。由于默认情况下这两个按钮都是 UIBarButtonItems，因此 UIAppearance 将无法区分两者。所以我决定继承一个 UIBarButtonItem，称之为 ActionBarButtonItem。我在需要 rightBarButtonItem 的任何地方使用这个新的子类。

## rightBarButtonItem

```
UIBarButtonItem* done = [[ActionBarButtonItem alloc] 
    initWithTitle:@"Done"
    style:UIBarButtonItemStyleDone
    target:self 
    action:@selector(onDonePress)];
self.navigationItem.rightBarButtonItem = done;
[done release]; 
```

## UI外观

```
NSDictionary* buttonStyle = [NSDictionary 
    dictionaryWithObjects:[NSArray 
        arrayWithObjects:
            [UIColor grayColor],
            , nil
        ]
        forKeys:[NSArray
            arrayWithObjects:
                UITextAttributeTextColor,
                nil
        ]
];

NSDictionary* actionStyle = [NSDictionary 
    dictionaryWithObjects:[NSArray 
        arrayWithObjects:
            [UIColor greenColor],
            nil
        ]
        forKeys:[NSArray
            arrayWithObjects:
                UITextAttributeTextColor,
                nil
        ]
]; 

[[UIBarButtonItem appearanceWhenContainedIn:[UINavigationController class], nil] 
    setTitleTextAttributes:buttonStyle
    forState:UIControlStateNormal
];

[[ActionBarButtonItem appearanceWhenContainedIn:[UINavigationController class], nil]
    setTitleTextAttributes:actionStyle
    forState:UIControlStateNormal
]; 
```

理论上，灰色文本将应用于所有 UIBarButtonItem。然后我只为 ActionBarButtonItems 用绿色文本覆盖灰色文本。最终结果并不如预期。由于未知原因，*每个*UIBarButtonItem 都会获得绿色文本。为什么？

![在此处输入图像描述](../Images/0be30cc88c19ac1d38b6b6e332ce37fe.png)![在此处输入图像描述](../Images/d3c010c67fc9840c74a6d35c586a8b84.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T23:49:04.953

你是子类`UIBarButton`，所以我最初的想法是，当你调用`appearanceWhenContainedIn`结果`ActionBarButtonItem`是调用超类时`appearanceWhenContainedIn`，这就是发生这种情况的原因。这并不理想，但您可以更改加载视图上左右项目的外观，或者视图将出现在每个视图中。

```
NSDictionary* buttonStyle = [NSDictionary 
                                 dictionaryWithObjects:[NSArray 
                                                        arrayWithObjects:
                                                        [UIColor blueColor],nil]
                                 forKeys:[NSArray
                                          arrayWithObjects:
                                          UITextAttributeTextColor,
                                          nil
                                          ]
                                 ];

NSDictionary* actionStyle = [NSDictionary 
                             dictionaryWithObjects:[NSArray 
                                                    arrayWithObjects:
                                                    [UIColor greenColor],
                                                    nil
                                                    ]
                             forKeys:[NSArray
                                      arrayWithObjects:
                                      UITextAttributeTextColor,
                                      nil
                                      ]
                             ]; 

[self.navigationItem.leftBarButtonItem setTitleTextAttributes:buttonStyle forState:UIControlStateNormal];
[self.navigationItem.rightBarButtonItem setTitleTextAttributes:actionStyle forState:UIControlStateNormal]; 
```

你也可以选择把它放在某个地方，比如你的应用程序委托，这样你就可以更简单地使用`[[UIApplication sharedApplication].delegate setBarButtonColors]`. 另一种选择可能是`UINavigationBar`.

# ruby-on-rails - 如何使用 Twilio 接收来自用户的文本消息并用消息回复该文本？

> ID：11022471
> 
> 赞同：4
> 
> 时间：2012-06-13T20:02:11.040
> 
> 标签：ruby-on-rails, twilio

1.) 用户向指定的 Twilio 电话号码发送短信 2.) 应用程序接收到此消息并解析它以获取可操作的数据 3.) 应用程序通过提供所请求信息的短信回复发件人

我怎么用rails做到这一点？！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-14T14:45:03.070

假设您的业务逻辑不需要那么长时间来执行，那么处理文本并发送响应非常简单。以下是核心步骤：

1.  获取[twilio-ruby](https://www.twilio.com/docs/ruby/install/?utm_source=stackoverflow&utm_medium=social&utm_campaign=stackdocsupdate)助手库。
2.  将您的 SMS Url 指向您要调用的 Rails 控制器/操作
3.  处理[传入的请求](http://www.twilio.com/docs/api/twiml/sms/twilio_request#synchronous)并执行您的业务逻辑
4.  不返回 HTML，而是返回[TwiML](http://www.twilio.com/docs/api/twiml/sms)

这是一个简单的应用程序的链接，它可以做到这一点：

[https://github.com/crabasa/twilio-rails-demo](https://github.com/crabasa/twilio-rails-demo)

更新：我写了两篇关于将 Twilio 集成到 Rails 4.x 应用程序的详细博客文章：[第 1](https://www.twilio.com/blog/2014/02/twilio-on-rails-integrating-twilio-with-your-rails-4-app.html)部分和[第 2 部分](https://www.twilio.com/blog/2014/10/twilio-on-rails-part-2-rails-4-app-sending-sms-mms.html)。

# javascript - 想要在用户重新加载页面时重定向到我的主页

> ID：11022478
> 
> 赞同：1
> 
> 时间：2012-06-13T20:02:31.370
> 
> 标签：javascript

当用户按下浏览器的刷新按钮时，我想重定向到我的主页。

例子。当某个用户在我的应用程序的第二页（例如 www.mydomain.com/second.php ）并点击浏览器刷新按钮时，我想要一个 javascript 弹出窗口进行确认并将用户重定向到我的应用程序主页（例如 www.mydomain .com ），我想用javascript来做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:05:46.630

您可以使用隐藏输入来完成此操作。当用户第一次登陆页面时，将值设置为`true`。隐藏输入通常会在浏览器刷新时保存，因此当页面刷新时，请设置以检查隐藏输入是否设置为`true`。如果是，请使用`window.location`将用户重定向到您想要的页面。

此页面描述了您要查找的内容：[http ://www.tedpavlic.com/post_detect_refresh_with_javascript.php](http://www.tedpavlic.com/post_detect_refresh_with_javascript.php)

这是直接取自此页面的示例：

```
<html>
<head>

<script language="JavaScript"> <!--
function checkRefresh()
{
    if( document.refreshForm.visited.value == "" )
    {
        // This is a fresh page load
        document.refreshForm.visited.value = "1";

        // You may want to add code here special for
        // fresh page loads
    }
    else
    {
        // This is a page refresh

        // Insert code here representing what to do on
        // a refresh
    }
} -->
</script>
</head>
<body onLoad="JavaScript:checkRefresh();">
    <form name="refreshForm">
        <input type="hidden" name="visited" value="" />
    </form>
</body>
</html> 
```

# c++ - C ++：相当于使用命名空间进行类定义？

> ID：11022482
> 
> 赞同：2
> 
> 时间：2012-06-13T20:03:07.343
> 
> 标签：c++, class, namespaces, scope

所以，我希望让我的代码更干净。这是我所拥有的：

对象.hpp

```
class obj {
    obj();

    int return0();
}; 
```

对象.cpp

```
using namespace obj; //illegal!!
obj() { }

int return0()
{
    return 0;
} 
```

基本上，我认为写作`obj::return0()...`有点多余。当我有子类时，这变得更加棘手，我在其中做类似的事情`obj::child::child2::return0()...`

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T20:05:35.267

`using namespace x`让您`call`在 x 中运行，而不是`define`它们。

正如评论指出的那样，如果函数很短，您可以在头文件中内联该函数。

对象.hpp

```
class obj {
    obj(){}
    int return0(){return 0;}
} 
```

# java - 我什么时候应该使用 Double.longBitsToDouble(...) 而不是简单地将 long 转换为 double？

> ID：11022487
> 
> 赞同：2
> 
> 时间：2012-06-13T20:03:40.107
> 
> 标签：java, casting, type-conversion, primitive-types

我有一个 double 值数组，其中最后一个值实际上是一个 long 表示时间（以毫秒为单位）。因此，需要将这个 long 转换为 double 以适合数组。稍后在检索此 long 值时，需要将其转换回 long 类型。至关重要的是，从双精度数组中检索后的 long 值与将其放入数组之前的值完全相同（低至一毫秒）。在数组中，不会对 long 值执行任何操作。所以问题是：
我应该简单地将 long 值转换为 double 并在检索时将其转换回 long 吗？这会保留我多头的确切价值吗？
或者我应该使用 Double.longBitsToDouble(time) 方法将 long 放入数组并使用 Double.doubleToLongBits(time) 检索它。
或者也许我应该使用 Double.longBitsToDouble(time) 将 long 值放入数组中，并通过简单地将其转换为 long 类型来检索编码的 long ？
预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T20:06:26.897

我的意思是，你*应该*做的是*不*使用数组来表示表示不同事物的值......

但是从听起来的情况来看，您别无选择，只能使用`Double.longBitsToDouble`，因为 a`double`无法为您提供所有`long`值的完全精确度。只是铸造一个`long`to`double`会失去精度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:11:16.683

我将创建一个自定义类，它基本上是一个`double`数组和单个`long`值的容器。您永远不应使用数组来存储不同类型的数据，或者将数组的某些元素用于不同目的。

使用 a 的示例`List<double>`：

```
public class DoublesWithTimestampStructure
{
    private List<double> doubles;
    private long timestamp;

    public DoublesWithTimestampStructure()
    {
        this.doubles = new List<double>();
        this.timestamp = 0;
    }

    /*
    ... getter and setter methods, miscellaneous methods, etc.
    */
} 
```

# javascript - Javascript 使用四舍五入到最接近的 10

> ID：11022488
> 
> 赞同：95
> 
> 时间：2012-06-13T20:03:41.510
> 
> 标签：javascript

我想使用 JavaScript 对整数进行舍入。例如：

```
10 = 10
11 = 20
19 = 20
24 = 30
25 = 30
29 = 30 
```

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2012-06-13T20:05:55.180

这应该这样做：

```
Math.ceil(N / 10) * 10; 
```

其中 N 是您的数字之一。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-06-13T20:24:00.400

要将数字四舍五入到 10 的下一个最大倍数，请在得到除以 10 的 Math.ceil 之前将数字加一。将结果乘以 10。

**数学.ceil((n+1)/10)*10;**

```
1->10
2->10
3->10
4->10
5->10
6->10
7->10
8->10
9->10
10->20
11->20
12->20
13->20
14->20
15->20
16->20
17->20
18->20
19->20
20->30
21->30
22->30
23->30
24->30
25->30
26->30
27->30
28->30
29->30
30->40
35-> 40
40-> 50
45-> 50
50-> 60
55-> 60
60-> 70
65-> 70
70-> 80
75-> 80
80-> 90
85-> 90
90-> 100
95-> 100
100-> 110 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-06-13T20:06:37.647

`Math.round()`四舍五入到最接近的整数。要四舍五入到任何其他数字，除以乘以十的幂。

一种这样的方法是：

```
function round(num,pre) {
    if( !pre) pre = 0;
    var pow = Math.pow(10,pre);
    return Math.round(num*pow)/pow;
} 
```

`floor`您可以为和制作类似的功能`ceiling`。但是，无论你做什么，`10`都永远不会圆`20`。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-13T20:06:59.253

或这个

```
var i = 20;
var yourNumber = (parseInt(i/10, 10)+1)*10; 
```

# facebook - “Fb.ui 发送对话框”返回错误

> ID：11022491
> 
> 赞同：0
> 
> 时间：2012-06-13T20:03:51.613
> 
> 标签：facebook, dialog, send, fb.ui

我对对话框有一个奇怪的问题。这是我在项目中使用的简单代码：

```
 FB.ui({
            app_id: 'MY_APP_ID',
            method: 'send',
            name: 'Test',
            link: 'MY_APP_LINK',
            display: 'iframe'
        }, function(response) {
            console.log(response);
        }); 
```

对话框打开后，我遇到了一个常见错误，没有任何描述：

这里是原始语言：“Обнаружена ошибка в APP_NAME。Пожалуйста, попробуйте ещё раз позже。” 而且我认为用英语听起来应该是：“APP_NAME 发生错误。请稍后再试。”

任何人都可以帮助我，并解释为什么会这样吗？我已经阅读了至少三遍文档，但没有发现任何有用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:08:12.317

验证您的应用程序的域设置 - 从应用程序不允许的页面调用对话框是此类错误的常见原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T21:40:27.717

你必须给它一个有效的链接 - 尝试将我的链接设置为“http://www.google.com”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-10T17:47:42.073

你使用什么样的设备？

如果您在平板电脑/手机上执行此操作，“发送”对话框当前不支持这些设备，并且会导致错误。

[http://developers.facebook.com/docs/reference/dialogs/send/](http://developers.facebook.com/docs/reference/dialogs/send/)

从他们的文档中：

> 您应该指定一个 URL，并且可以在“收件人”字段中预填充用户。发送对话框不需要任何扩展权限。移动设备目前不支持此对话框。

# java - 有没有办法用Java检查.txt文件的字符集编码？

> ID：11022497
> 
> 赞同：7
> 
> 时间：2012-06-13T20:04:19.637
> 
> 标签：java, unicode, utf-8, character-encoding, file-encodings

有没有办法检查文本文件 (.txt) 是用 Unicode 编码还是用 Java 编码的 UTF-8？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-13T20:15:23.793

您无法绝对确定在一般情况下使用哪种字符集。我发现这是一本好书。

[http://illegalargumentexception.blogspot.co.uk/2009/05/java-rough-guide-to-character-encoding.html](http://illegalargumentexception.blogspot.co.uk/2009/05/java-rough-guide-to-character-encoding.html)

特别是**自动检测编码**部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T20:11:07.523

嗯，理论上，你怎么知道它是否是 unicode？

这是真正的问题。说实话，你无法知道，但你可以做出一个体面的猜测。

有关详细信息，请参阅： [Java：如何确定流的正确字符集编码](https://stackoverflow.com/questions/499010/java-how-to-determine-the-correct-charset-encoding-of-a-stream)。:)

# javascript - 使用 Jquery 更改名称属性 onClick

> ID：11022498
> 
> 赞同：3
> 
> 时间：2012-06-13T20:04:20.587
> 
> 标签：javascript, jquery, html

我正在尝试使用 jQuery 更改文本框内容的 DIV 的 NAME 属性。

这是我的小提琴：http: [//jsfiddle.net/e6kCH/](http://jsfiddle.net/e6kCH/)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:06:46.757

代替：

```
$(#divId).attr("name")=content; 
```

采用：

```
$("#divId").attr("name", content); 
```

[`attr`](http://api.jquery.com/attr/)是一个`function`不是一个`property`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T20:09:53.233

最大的问题是逻辑问题。

```
content = document.getElementById("theid").value 
```

这将获取输入的当前值。问题是，当您更改输入值时，它不会更新。为了解决这个问题，将该行移动到单击事件处理程序中。

一旦修复了各种其他 javascript 错误（单击 JSLint 按钮！！！），它将起作用。[http://jsfiddle.net/e6kCH/4/](http://jsfiddle.net/e6kCH/4/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-13T20:17:57.463

保持相同的代码，只为此更改 JS：

```
$('#buttonId').click(function() {
    $('#divId').attr('name', $('#textId').val());
}); 
```

请记住，它只会更改 div 的名称，您需要类似 Google Chrome 的开发人员工具才能看到它的更改。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-13T20:07:19.457

使用[.attr()](http://api.jquery.com/attr/)设置属性值的方法是：

> **.attr(attributeName, value)**
> 描述：为匹配的元素集设置一个或多个属性。
> 
> attributeName：要设置的属性的名称。
> value：要为属性设置的值。

```
$('#divId').attr("name", content); 
```

*注意：不要忘记在 jQuery 函数中用引号（或双引号）包围您的选择器`$()`*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-13T20:13:14.120

[http://jsfiddle.net/e6kCH/10/](http://jsfiddle.net/e6kCH/10/)那应该可以得到你想要的。

# jquery - jQuery find option in Select with empty/null value remove it and select the first option after it with a value

> ID：11022502
> 
> 赞同：10
> 
> 时间：2012-06-13T20:04:32.243
> 
> 标签：jquery, forms

总而言之，我想从 SELECT 输入中删除所有空选项。选择是根据它接收到的对象从其他人编写的脚本动态生成的。我的问题是有时对象有空值，给我留下了一个选择选项集，留下了一些不足之处。

无论如何，几乎每次集合中的第一个选项都是空的。所以我想删除它并应用于`selected="selected"`第一个选项被删除后出现的第一个选项。同时删除任何其他具有空值的可能性。

所以在测试最初的概念时，我想出了

```
$(select).each(function(){
                if ($(this+' option:selected').val() == '')
                {
                    //this assumes that your empty value is ''
                    $(this).remove();
                }
            }); 
```

这似乎删除了整个选择，我知道它的原因`this`被定义为选择本身。

我也试过 `$(select +'option[value=""]').remove();`

目前我只是想让它删除具有空值的选项，在我实现这一点之后，我将弄清楚我如何正式选择列表中的第一项，就 DOM 而言。

还值得一提的是，“选择”传递的变量是先前在函数中定义的，因此它适用于该部分的概念。只是这么说，所以没有人认为我有些混淆它与其他东西。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-13T20:15:12.810

*   您可以使用[.filter()](http://api.jquery.com/filter/)过滤掉空选项元素并一次将它们全部删除

*   使用[.prop()](http://api.jquery.com/prop/)设置特殊属性，如`selected`

代码：

```
$('select option')
    .filter(function() {
        return !this.value || $.trim(this.value).length == 0;
    })
   .remove();

$('select option')
    .first()
    .prop('selected', true);​ 
```

[**演示**](http://jsfiddle.net/didierg/cL5NH/)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-07-01T14:07:00.460

这可以更容易地完成：

```
Element.find('option[value=""]').remove(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:14:14.927

POJS来救援！

```
function fixSelectOptions(SelectId){
 var sel = document.getElementById(SelectId);
 for(var i = 0; i < sel.options.length; i++){
  if(sel.options[i].value === ""){
   sel.remove(i--);//decrease i to preserve future index references after removal
  }
 }
 sel.options.selectedIndex = 0;
} 
```

# mysql - MySQL - 表格代码和显示内容

> ID：11022503
> 
> 赞同：0
> 
> 时间：2012-06-13T20:04:37.357
> 
> 标签：mysql

我需要一个表，该表将具有一个自动递增的 ID 号（因此每个条目为 1、2、3、4）、一个名称、一个 ss:ms ms 形式的时间（秒和毫秒）和一个联系号码。

我遇到的问题是我需要将它们显示在显示 10 个最快时间的网站中。您认为我应该如何编写 ss:ms ms 时间码以便我可以在页面上显示它们？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:15:02.140

这是您需要的查询。根据提供的少量信息，我假设表的结构与此类似。

```
SELECT id, name, speed FROM records
ORDER BY speed ASC
LIMIT 10; 
```

# c# - TabControl 的 SelectionChanged 事件问题

> ID：11022504
> 
> 赞同：5
> 
> 时间：2012-06-13T20:04:37.450
> 
> 标签：c#, wpf, tabcontrol

我正在研究 WPF，我正在创建一个包含 TabControl 的 userControl，其中包含一些 TabItems。

I need to execute some stuff when the selected tab changes, so, what I tried to do is to use the event `myTabControl.SelectionChanged`but it was raised many times, even though I only clicked once a TabItem. 然后我阅读了这篇文章[is-there-selected-tab-changed-event-in-the-standard-wpf-tab-control](https://stackoverflow.com/questions/772841/is-there-selected-tab-changed-event-in-the-standard-wpf-tab-control)并将这段代码放入我的方法中：

```
void mainTabControl_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    if (e.Source is TabControl)
    {       
        //do work when tab is changed
    }
} 
```

这样做之后，第一个问题已经解决，但是当我运行应用程序并尝试更改选项卡时，出现了一个错误：

```
Dispatcher processing has been suspended, but messages are still being processed 
```

Visual Studio 指向里面的第一行代码`if (e.Source is TabControl) { //here }`

但我发现这篇文章[selectionchanged-event-firing-exceptions-for-unknown-reasons](https://stackoverflow.com/questions/4504310/selectionchanged-event-firing-exceptions-for-unknown-reasons)我可以通过编写如下代码来解决这个问题：

```
void mainTabControl_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    if (e.Source is TabControl)
    {       
        if (this.IsLoaded)
        {
            //do work when tab is changed
        }
    }
} 
```

但是现在我遇到了另一个我无法解决的问题：

**该事件正在触发两次！另一个奇怪的事情是，只有在我第一次尝试更改所选选项卡时，事件才会引发两次，但所选选项卡仍然相同**

我希望有人可以帮助我，提前谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T20:11:05.950

我想我需要休息一下，因为我的问题真的很傻：

事实证明，`TabControl`我不应该使用`TabItem`它，因为它是我感兴趣的控件。

所以，我的代码必须如下：

```
 void mainTabControl_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        if (e.Source is TabItem)
        {       
            if (this.IsLoaded)
            {
                //do work when tab is changed
            }
        }
    } 
```

# google-chrome-devtools - 有效地使用时间轴

> ID：11022507
> 
> 赞同：3
> 
> 时间：2012-06-13T20:04:56.233
> 
> 标签：google-chrome-devtools

有没有办法让时间轴在页面开始加载的时候开始录制？我觉得必须先按开始然后刷新页面很烦人，因为这会在时间轴的开头添加一些垃圾信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T20:14:28.403

没有这种方法，但您可以使用键盘快捷键。

*   `CTRL`+`e`用于开始/停止录制
*   `CTRL`+`r`用于检查页面重新加载

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-03T14:46:01.540

当您在 DevTools (Chrome 47) 中选择此选项时，您可以找到所有可用快捷方式的列表： [![在此处输入图像描述](../Images/3504609c76f7739b361afbf8ac7c0e86.png)](https://i.stack.imgur.com/GGaJF.png)

# php - PHP 动态数据库页面重写 URL

> ID：11022509
> 
> 赞同：4
> 
> 时间：2012-06-13T20:05:13.753
> 
> 标签：php, url-rewriting, dynamic-pages

如何制作 www.mydomain.com/folder/?id=123 ---> www.mydomain.com/folder/xCkLbgGge

我希望我的数据库查询页面获得它自己的 URL，就像我在 twitter 等上看到的那样。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T20:19:04.737

这被称为“蛞蝓”wordpress，使这个词很受欢迎。无论如何。

最终，您需要做的是拥有一个 .htaccess 文件，该文件可以捕获所有传入流量，然后在服务器级别对其进行改造以与您的 PHP 一起使用，您仍将保持 ?id=123 逻辑完整，但对客户端side '/folder/FHJKD/' 将是可见的结果。

这是一个 .htaccess 文件的示例，我在上面使用了类似的逻辑。（wordpress 也是如此）。

```
RewriteEngine On
#strips the www out of the domain if there
RewriteCond %{HTTP_HOST} ^www\.domain\.com$

#applies logic that changes the domain from http://mydomain.com/post/my-article
#to resemble http://mydomain.com/?id=post/my-article
RewriteRule ^(.*)$ http://domain.com/$1 [R=301,L]
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?id=$1 [QSA,L] 
```

这将做的是获取 domain.com/ 之后的所有内容并将其作为变量传递给 index.php 在此示例中的变量将是“id”，因此您必须设置最适合您网站需求的逻辑。

例子

```
<?php
 //the URL for the example here: http://mydomain.com/?id=post/my-article
 if($_GET['id'])
 {
   $myParams = explode('/', $_GET['id']);
   echo '<pre>';
   print_r($myParams);
   echo '</pre>';
 }
?> 
```

现在这个逻辑必须更深入，这只是一个基本级别的纯示例，但总体而言，特别是导致您使用我假设的数据库，您要确保 $myParams 没有恶意代码，那可以注入您的 PHP 或数据库。

上述`$myParams`通过的输出`print_r()`将是：

```
Array(
   [0] => post
   [1] => my-article
) 
```

要使用它，您至少需要做

```
echo $myParams[0].'<br />'; 
```

或者你可以这样做，因为大多数浏览器会添加一个最终 /

```
<?php
 //the URL for the example here: http://mydomain.com/?id=post/my-article
 if($_GET['id'])
 {
   //breaks the variable apart, removes any empty array values and reorders the index
   $myParams = array_values(array_filter(explode('/', $_GET['id'])));
   if(count($myParams > 1)
   {
       $sql = "SELECT * FROM post_table WHERE slug = '".mysql_real_escape_string($myParams[1])."'";
       $result = mysql_query($sql);
   }

 }
?> 
```

诚然，这是一个非常粗略的示例，您可能希望在其中处理一些逻辑以防止 mysql 注入，然后您将像现在使用 id=123 提取文章一样应用查询。

或者，您也可以走完全不同的路线，探索 MVC（模型视图控制）的奇妙之处。CodeIgniter 之类的东西是一个非常容易上手的 MVC 框架。但这取决于你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:08:05.010

这可以通过`mod_rewrite`例如`.htaccess`文件来实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T20:15:13.813

在您的 .htacess 中，您需要添加 RewriteEngine。

在那之后，你需要做一些正则表达式来让这个小野兽工作。我假设 ?id 是 folder.php?id=123。

例如文件夹片段：RewriteRule ^folder/([a-zA-Z0-9_-]+)/([0-9]+).html$ folder.php?id=$123

# c# - 在 Windows server 2008 R2 和 IIS7.5 中托管 WCF

> ID：11022510
> 
> 赞同：2
> 
> 时间：2012-06-13T20:05:16.950
> 
> 标签：c#, wcf, windows-server-2008

在我将 WCF Web 服务部署到 Windows Server 2008 R2 之后，我能够在“http://192.168.100.22:4567/HrmsService.svc”处拥有一个页面，这适用于服务器，但不适用于我的 PC。我创建了一个 Windows 窗体应用程序，并尝试将其添加为服务参考，但出现如下错误消息。我在服务器上安装了 VS2010，并尝试将其添加为服务参考，它适用于 Windows 窗体应用程序。我什至在服务器防火墙中添加了端口 4567 以允许它。我今天早上尝试了所有，但我无法弄清楚。请告诉我。

> 错误信息
> 
> 下载“http://192.168.100.22:4567/HrmsService.svc?wsdl”时出错。Unable to connect to the remote server 连接尝试失败，因为连接的一方在一段时间后没有正确响应，或者建立连接失败，因为连接的主机没有响应 192.168.100.22:4567 元数据包含无法解析的引用： 'http://192.168.100.22:4567/HrmsService.svc?wsdl'。在“http://192.168.100.22:4567/HrmsService.svc?wsdl”处没有可以接受消息的端点监听。这通常是由不正确的地址或 SOAP 操作引起的。有关更多详细信息，请参阅 InnerException（如果存在）。Unable to connect to the remote server 连接尝试失败，因为连接方在一段时间后没有正确响应，

这是我的 Web.config 文件。

```
<system.web>
    <compilation debug="true" targetFramework="4.0"><assemblies><add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" /></assemblies></compilation>
  </system.web>
  <system.serviceModel>
      <services>
          <service name="WcfServiceHrms.HrmsService" behaviorConfiguration="BehaviorHrms">
              <endpoint address= ""  binding="wsHttpBinding" contract="WcfServiceHrms.IHrmsService" />
              <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
               <host>
                   <baseAddresses>
                       <add baseAddress="http://192.168.100.22:4567" />
                  </baseAddresses>
              </host>
          </service>
      </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="BehaviorHrms">
             <serviceMetadata httpGetEnabled="true" />
             <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true" />
  </system.webServer> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:49:15.603

99% 认为此错误与网络配置有关，与 WCF 无关。

尝试远程登录 192.168.100.22 4567

[http://technet.microsoft.com/en-us/library/cc771275(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc771275(v=ws.10).aspx)

将您的服务移至端口 80。非标准端口通常被防火墙关闭。

# c# - 使用流利的 nhibernate 的通用查找表

> ID：11022516
> 
> 赞同：2
> 
> 时间：2012-06-13T20:05:54.470
> 
> 标签：c#, fluent-nhibernate, fluent-nhibernate-mapping

我不知道如何在流利的 nhibernate 中映射如下表结构。根据我在下面放置数据的方式，您可以看到 Transaction 或 Member 表与 CodeSet 表之间没有直接关系。id 直接进入 CodeValue 表。因此，在代码中，您会发现 CodeSet 表的硬编码值。这是旧代码，我不知道是否应该更改它或者 nHibernate 是否可以处理它。

我有以下表格：

通用查找表：

**代码集**

```
 ID
    Name
    Display 
```

**代码值**

```
 ID
    CodeSetId
    Name
    Display
    ReferenceValue 
```

然后我有像

**交易**

```
 ID
    TransactionTypeId
    Name 
```

**成员**

```
 ID
    FirstName
    LastName
    MemberTypeId 
```

**TransactionTypeId**和**MemberTypeId**与 CodeValue 表上的 CodeValueId 相关 。

## 所以数据看起来像：

### CodeSetId 名称显示

*   1 “交易类型” “交易类型”
*   2“会员类型”“会员类型”

### CodeValueId CodeSetId 名称 显示参考值

*   1 1 急诊就诊 急诊就诊 100
*   2 1 手术 手术 200
*   3 2 医生 医生 500
*   4 2 患者 患者 600

### TransactionId TransactionTypeId 名称

*   1 1 一些 ER 交易
*   2 2 一些手术交易

### MemberId 名字姓氏 MemberTypeId

*   1 贝蒂·布（医生） 3
*   2 Sammy Sue（病人） 4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:54:09.937

我建议您阅读或演练 Fluent NHibernate 的“入门”文档中的“您的第一个项目”。

零售公司示例的结构与您尝试实施的结构非常相似。

[https://github.com/jagregory/fluent-nhibernate/wiki/Getting-started](https://github.com/jagregory/fluent-nhibernate/wiki/Getting-started)

# php - 随机数：将 JavaScript 转换为 PHP

> ID：11022527
> 
> 赞同：1
> 
> 时间：2012-06-13T20:06:38.687
> 
> 标签：php, javascript

我在javascript中有以下代码行：

```
(Math.random() + "") * 1000000000000000000 
```

生成如下数字：

```
350303159372528000 
```

我在 PHP 中尝试了同样的事情：

```
rand()*1000000000000000000 
```

返回：

```
2.272e+21 
```

我需要使用 PHP，因为生成的数字将存储为 SESSION 变量，稍后将由 JavaScript 使用。

**如何让 PHP 强制数字为 int 而不是 float？**

* * *

编辑 PHP 似乎很难解决这个问题。

如果我只是在 PHP 中生成 rand 数并将其保存到 SESSION 然后在 JavaScript 中乘以 1000000000000000000，它会起作用吗？

我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T20:10:44.510

我建议打电话

```
PHP_INT_MAX 
```

看看您的 PHP 安装是否可以处理这么大的整数。我猜它不能，这就是为什么它将它降低到科学计数法的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:11:56.777

我建议[将](http://php.net/manual/en/function.intval.php)您的结果转换为 int：

```
intval(rand()*1000000000000000000) 
```

也就是说，有关精度问题，请参阅 Kolink 和 Jeremy1026 的答案。如果您只需要一个唯一标识符，请参阅 Truth 的答案。

**更新：**如果您使用字符串来表示您的数字，不希望或不能使用[任意精度库](https://stackoverflow.com/questions/211345/working-with-large-numbers-in-php)，并且**不需要**完全公平的随机数，您可以生成较小的数字并将它们连接在一起：

```
strval(rand()*999999999 + 1) . strval(rand()*1000000000) 
```

（这`+1`是为了避免结果中出现前导零；另请注意，您的数字永远不会有一个数字，但其他数字都是可能的）

对于（正好）18 位的随机数，您还可以[`str_pad`](http://www.php.net/manual/en/function.str-pad.php)在第二部分中使用前导零填充它：

```
strval(rand(100000000,999999999)) .
    str_pad(strval(rand(0,999999999)), 9, "0", STR_PAD_LEFT) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T20:11:12.237

如果您需要一个唯一标识符（这就是您想要做的），请使用 PHP 的`uniqid()`函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-13T20:44:06.593

floor() / ceil() / round() / (int) / intval() 将数字转换为 int。此外， rand() 接受两个参数。如果提供了整数 - 它将返回一个整数

并且 printf() 应该负责以您希望的格式打印（ printf('%d', $int) 应该可以解决问题）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-13T21:53:14.073

最后我解决了这样的问题：

```
<?php
error_reporting(0);
 function RandNumber($e){

 for($i=0;$i<$e;$i++){
 $rand =  $rand .  rand(0, 9);  
 }
 return $rand;

 }

 echo RandNumber(18);
// Outputs a 18 digit random number

?> 
```

# google-maps - Google Maps API 无法显示信息窗口的内容

> ID：11022535
> 
> 赞同：0
> 
> 时间：2012-06-13T20:07:01.860
> 
> 标签：google-maps, google-maps-api-3, oracle-apex

我有一个听起来很傻的问题。我编写了 javascript 代码来集成 APEX。这部分的目的是根据地址显示谷歌地图并有信息窗口。信息窗口将显示名称作为内容，它是一个链接，指向那个人的详细报告。问题是：infowindow 适用于数据库中的大多数名称，但没有显示具有特定名称的内容（链接）。我没有发现这些名字有什么特别之处，比如“Robert Allan Lockett”。这里我附上代码如下：

```
<script type="text/javascript"       src="http://maps.googleapis.com/maps/api/js?sensor=false">     </script>     
<script type="text/javascript">       
function initialize() {  

var myOptions = { zoom: 18, mapTypeId: google.maps.MapTypeId.ROADMAP};   
var map = new google.maps.Map(document.getElementById("map"), myOptions); 

var markerBounds = new google.maps.LatLngBounds(); 
var point=new google.maps.LatLng(&P3006_TF_GEOCODING.);

markerBounds.extend(point);  
map.fitBounds(markerBounds); 

var listener = google.maps.event.addListener(map, "idle", function() {  
map.setZoom(map.getZoom()-4);  
google.maps.event.removeListener(listener);  
});  

var marker;

marker = new google.maps.Marker({ position: new google.maps.LatLng(&P3006_TF_GEOCODING.), map: map }); 

var infowindow = new google.maps.InfoWindow({    content: "&P3006_H_OFFENDER_NAME."});

var current_parameter ="&APP_ID.:216:&SESSION.::NO::P216_DETAIL:"+"&P3006_H_OFFENDER_ID.";
var my_URL="http://lsg-solutions.com:9704/apex/f?p="+encodeURIComponent(current_parameter);

infowindow.setContent('<a href='+my_URL+'>&P3006_H_OFFENDER_NAME.</a>');

google.maps.event.addListener(marker, 'click', function() {   infowindow.open(map,marker);});

}     
</script> 
```

# c# - Html 页面上的 Html 表 - 无 XML

> ID：11022536
> 
> 赞同：0
> 
> 时间：2012-06-13T20:07:05.953
> 
> 标签：c#, html, web-scraping, html-table, html-agility-pack

我正在尝试从网站上的 Html 表中获取数据。不涉及 XML。

```
<table id="e-cal-table" class="e-cal-table" width="100%">

<tr>

    <th>Date</th>

    <th>Time</th>

    <th>Currency</th>

    <th>Event</th>

    <th>Importance</th>

    <th>Actual</th>

    <th>Forecast</th>

    <th>Previous</th>

    <th>Notes</th>

</tr> 
```

以下结果导致“对象引用未设置为对象的实例”。

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml("http://www.example.com");

string table = doc.DocumentNode.SelectSingleNode("//table[@id='e-cal-table']").InnerText; 
```

我不知道如何识别表以供将来解析。不幸的是，我能找到的唯一示例与 XML 有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:21:03.370

如果您从`string`.

如果您想从 url 加载它，请 `doc.Load(url);`不要 使用`doc.LoadHtml(htmlString);`

- 编辑 -

对不起，我的错，`doc.Load`不接受`http` 你可以使用这样的东西

```
using (var wc = new WebClient())
{
    doc.LoadHtml(wc.DownloadString(url);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:10:36.480

您上面的 HTML 缺少结束表格标记。这可能是问题吗？你可以试试 Hpricot 或 Nokogiri。

# c# - 使用实体框架执行后期绑定存储过程

> ID：11022546
> 
> 赞同：2
> 
> 时间：2012-06-13T20:07:58.510
> 
> 标签：c#, entity-framework

我正在寻找一种方法来做这样的事情：

```
var  db = new DALEntities();
db.StoredProcedureToCall(); 
```

但是，我希望它是动态的，因为在将其他一些数据传递给我之前，我不会知道要拨打哪个电话。

```
var db = new DALEntities();
db[tSproc](); 
```

我知道我可以有一个 switch 语句测试 tSproc 的值，然后像上面那样调用，但是有没有更优雅的方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:43:09.477

将光标放在上面`db.StoredProcedureToCall()`并按 F12。您将看到 EF 生成的代码已经是动态的。

根据您使用的 EF 版本，它看起来像：

```
public ObjectResult<OrderDetail> GetDetailsForOrder
 (Nullable<global::System.Int32> orderid)
{
  ObjectParameter orderidParameter;
  if (orderid.HasValue)
  {
    orderidParameter = new ObjectParameter("orderid", orderid);
  }
  else
  {
    orderidParameter = new ObjectParameter("orderid", typeof(global::System.Int32));
  }
  return base.ExecuteFunction<OrderDetail>("GetDetailsForOrder", orderidParameter);
} 
```

只需类似地编写代码。你不需要开关。

# php - 图像随机标题有问题

> ID：11022550
> 
> 赞同：2
> 
> 时间：2012-06-13T20:08:33.870
> 
> 标签：php, css, image

我想知道我可以为这个随机脚本添加一个标题

```
<div style="background:transparent url(
 backgrounds/<?php echo 'image-'.rand(0,20).'.jpg'; ?>);"> 
 Welcome to my Site!
</div> 
```

还有另一种方法是使用数组作为标题：

```
$images = array(array("image 1" => "caption 1"),
                array("image 2" => "caption 2"),
                array("image 3" => "caption 3"); 
```

我可以将它们两者结合起来吗？是否可以？如果是这样，我该怎么做？如果没有办法。我还可以做些什么？我很感激任何建议

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:12:18.493

您可以打乱您的`$images`数组并获取第一个索引。

```
$images = array( array('file' => 'image1', 'caption' => 'Caption 1'),
                 array('file' => 'image2', 'caption' => 'Caption 2') );

shuffle($images);
$file = $images[0]['file'];
$caption = $images[0]['caption']; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:25:39.453

如果您的图像数组与您所说的类似：

```
$images = array(
array('file' => 'image1.jpg',
'caption' => 'Caption 1'),

array('file' => 'image2.jpg',
'caption' => 'Caption 2'),
); 
```

然后，您可以使用以下方法获取随机条目`array_rand`：

```
$image_key = array_rand($images); 
```

然后您可以使用此键为您提供图像和标题：

```
<div style="background:transparent url(
 backgrounds/<?php echo $images[$image_key]['file']; ?>);"> 
 <?php echo $images[$image_key]['caption']; ?>
</div> 
```

# websocket - Jelastic 或 Cloudbees 支持 websockets

> ID：11022551
> 
> 赞同：1
> 
> 时间：2012-06-13T20:08:38.303
> 
> 标签：websocket, railo, cloudbees, jelastic

有谁知道是否可以在 Cloudbees 或 Jelastic 上使用 websocket。我在端口 10126 上部署了一个带有 websockets 的 Railo 项目，它在我的 Tomcat 本地设置上运行良好，但是在部署到 Jelastic 和 Cloudbees 时没有任何反应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:25:48.273

在 Jelastic，我们做到了。这是我们提供公共 IP 的成果之一。我们将针对这个主题撰写一篇简短的操作指南文章。您可以在我们的博客 (http://blog.jelastic.com) 或我们的 Twitter 帐户 (@jelastic) 上查看它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T06:01:56.803

Cloudbees 现在支持 Websockets。

这是通过代理完成的 - 因此可以通过 http 升级与任何应用程序一起使用。

只需设置：

蜜蜂应用程序：代理：更新 http_version=1.1

由于 http 1.1 支持升级到 websocket（因此 ws 和 wss 将起作用）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T08:01:29.113

CloudBees 现在提供对 WebSockets 的支持 - 您只需要使用不同的端点来访问您的应用程序：http: [//developer.cloudbees.com/bin/view/RUN/WebSockets](http://developer.cloudbees.com/bin/view/RUN/WebSockets)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T20:10:51.390

AFAIK，目前只有[dotCloud](http://dotcloud.com)支持 websockets：[http ://docs.dotcloud.com/guides/websockets/](http://docs.dotcloud.com/guides/websockets/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-02T18:17:30.593

好的，在我对 Jelastic 的理解中，他们支持在 GlassFish 中运行 Websocket，并且可以支持公共 IP。

而 Cloudbees 支持运行单独的 JVM（纯 Java 应用程序，无应用程序服务器）但没有公共 IP。

以下是一些参考资料：

[Cloudbees JVM 容器](http://developer.cloudbees.com/bin/view/RUN/Java+Container)

# c - 在内存中操作具有多个空字符的 C 字符串

> ID：11022555
> 
> 赞同：5
> 
> 时间：2012-06-13T20:09:10.100
> 
> 标签：c

我需要在一块内存中搜索一串字符，但是其中几个字符串的每个字符都为空字符，如下所示：
“I. .am .a. .string”
，所有的 '.' 都是空的人物。我的问题实际上来自于将它记入内存。我尝试了几种方法，例如：

```
 char* str2; 
 str2 = (char*)malloc(sizeof(char)*40);   
 memcpy((void*)str2, "123\0567\09abc", 12); 
```

将以下内容放入 str2 指向的内存中： 将 str2 指向一个看起来像 的内存块`123.7.9abc..`
，其中 '.' 是一个空字符，',' 是一个实际的逗号。
`str2 = "123456789\0abcde\054321";`
`123456789.abcde,321`

很明显，将空字符插入 cstrings 并不像我想象的那么容易，就像插入换行符一样。我在尝试使用字符串库时也遇到了类似的困难。我可以做单独的任务，比如：

```
 char* str;    
 str = (char*)malloc(sizeof(char)*40);  
 strcpy(str, "123");  
 strcpy(str+4, "abc");  
 strcpy(str+8, "ABC"); 
```

但这肯定不是可取的，我相信问题在于我对 c 样式字符串如何存储在内存中的理解。`61 62 63 00 31 32 33`显然“abc\0123”实际上并没有像（十六进制）那样进入内存。它是如何存储的，我如何存储我需要的东西？

（我也很抱歉没有将代码设置为块，这是我第一次发布问题，不知何故“四行间距”显然比我能处理的要困难。谢谢你，Luchian。我看到需要更多的换行符。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T20:11:47.697

如果每个其他都`char`包含一个空值，那么几乎可以肯定你实际上有 UTF-16 编码的字符串。相应地处理它们，您的问题就会消失。

假设你在 Windows 上，UTF-16 很常见，你会使用`wchar_t*`而不是`char*`保存这样的字符串。您将使用宽字符字符串处理函数对此类数据进行操作。例如，使用`wcscpy`而不是`strcpy`等等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:24:01.497

`\0`是八位字节中转义字符的起始序列，它不仅仅是一个“*空字符*”（即使使用它自己的会导致一个）。

* * *

定义包含*空字符*的字符串后跟也可以视为八位字节中转义字符的一部分的字符串（例如 "\012" ^(**1**)）的最简单方法是使用以下 C 功能将其拆分：

```
char const * p = "123456789" "\0" "abcde" "\0" "54321"; 
```

^(**1**、“\012”会产生等价十六进制值0x0A的字符，**而不是**三个字符；0x00、“1”和“2”。)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T20:16:03.860

首先，每个第二个字符都是 NULL 是宽字符串的明显标志 - 一个由双字节字符组成的字符串，实际上是一个`unsigned short`s 数组。根据您的编译器和设置，您最好使用数据类型`wchar_t`而不是函数系列而`char`不是.`wcsxxx()``strxxx()`

在 Windows 上，2 字节宽字符串（UTF-16，技术上）是操作系统的原生字符串格式，所以它们无处不在。

也就是说，strxxx() 函数都假定字符串是空终止的。所以相应地计划。有时 memxxx() 会来救援。

"abc\0123" 不会以您期望的方式进入内存，因为 \012 被编译器解释为单个八进制转义序列 - 八进制代码为 12 的字符（即 0a 十六进制）。为避免，请使用以下文字之一：

```
"abc\000123"
"abc\x00123"
"abc\0""123" 
```

从块中生成字符串的片段大部分是正确的。只是我宁愿使用

```
strcpy(str+strlen(str)+1, "123"); 
```

这保证了下一个块将被写入前一个块的空字符之后。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T20:17:25.220

我对你的问题有点困惑。但让我猜猜发生了什么。您正在查看 16 位 wchat_t 字符串，而不是普通的 c 字符串。wchar 获取 ascii 字符可能看起来像在字母之间分隔的空值，但实际上这是正常的。

简单地说 (wchar_t *)XXX 其中 XXX 是指向该内存区域的指针并查找 wchar_t 操作（如 wcscpy 等）...至于字符串之间的空值，这实际上可能是传递多个字符串构造的已知方法。您可以在读取每个字符串后简单地迭代，直到通常遇到 2 个连续的空值。

希望我已经回答了你的问题。祝你好运！

# flash - 如何在 Flash CS5 中制作通用暂停按钮？

> ID：11022556
> 
> 赞同：4
> 
> 时间：2012-06-13T20:09:15.233
> 
> 标签：flash, actionscript

我正在尝试在 Flash 中制作一个按钮，以暂停在我的文件中运行的所有影片剪辑。这些电影剪辑都不是我主时间线中的补间，它们都有自己的时间线。每个移动剪辑都由一个按钮触发，该按钮告诉剪辑开始播放。所以，如果有人能帮我创建这个暂停按钮，我将不胜感激。感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T14:08:21.563

使用像这样的基类导出您想要以递归方式暂停/恢复的所有符号，然后您不必遍历整个显示树：

```
package com.stackoverflow
{
import flash.display.MovieClip;
import flash.events.Event;

[Event(name="clipAdded", type="flash.events.Event")]
[Event(name="clipRemoved", type="flash.events.Event")]
public class BaseClip extends MovieClip
{
    protected var baseClipChildren:Array;
    protected var paused:Boolean = true;

    public function BaseClip()
    {
        super();
        baseClipChildren = new Array();
        addEventListener(Event.ADDED_TO_STAGE, onAdded);
        addEventListener("clipAdded", onClipAdded);
        addEventListener(Event.REMOVED_FROM_STAGE, onRemoved);
        addEventListener("clipRemoved", onClipRemoved);
    }

    protected function onAdded(event:Event):void
    {
        var target:BaseClip = event.target as BaseClip;
        if(target == this) {
            dispatchEvent(new Event("clipAdded", true));
        }
    }

    protected function onClipAdded(event:Event):void
    {
        var target:BaseClip = event.target as BaseClip;
        if(target && target != this) {
            event.stopImmediatePropagation();
            baseClipChildren.push(target);
        }
    }

    protected function onRemoved(event:Event):void
    {
        var target:BaseClip = event.target as BaseClip;
        if(target == this) {
            dispatchEvent(new Event("clipRemoved", true));
        }
    }

    protected function onClipRemoved(event:Event):void
    {
        var target:BaseClip = event.target as BaseClip;
        if(target && target != this) {
            event.stopImmediatePropagation();
            baseClipChildren.splice(baseClipChildren.indexOf(target),1);
        }
    }

    public function stopAll():void {
        stop();
        for each(var clip:BaseClip in baseClipChildren) {
            clip.stopAll();
        }
    }

    public function playAll():void {
        play();
        for each(var clip:BaseClip in baseClipChildren) {
            clip.playAll();
        }
    }
}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T23:28:36.527

以下应该可以解决问题：

```
// create an array to store all playing movieclips 
var playing = [];

// when a movieclip is played add it to the array like this:
// playing.push(myMovieClip);

// call this from your pause button's click handler
function pauseAll() 
{
    // loop through all the playing movieclips ...
    for (var i = 0; i < playing.length; i ++)
    {
        // ... and stop them
        playing[i].stop();
    }

    // now clear the array
    playing = [];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:35:23.340

我知道没有一种内置的方法可以暂停所有影片剪辑。

如果您在全局可访问对象中保留了对要暂停的影片剪辑的引用，则可以遍历这些引用调用暂停。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T18:08:01.907

此函数将停止对象的所有嵌套影片剪辑。只需通过您的舞台或顶级展示课程即可停止/播放所有内容。这样您就不必跟踪向数组添加内容，也没有开销。

```
function recursiveStop(parentClip:DisplayObjectContainer, useStop:Boolean = true, gotoFrame:Object = null):void {
    var tmpClip:MovieClip = parentClip as MovieClip;
    if (tmpClip) {
        if (useStop) {
            (gotoFrame != null) ? tmpClip.gotoAndStop(gotoFrame) : tmpClip.stop();
        }else {
            (gotoFrame != null) ? tmpClip.gotoAndPlay(gotoFrame) : tmpClip.play();
        }
    }

    var i:int = parentClip.numChildren;
    while(i--){
        if(parentClip.getChildAt(i) is DisplayObjectContainer){
            recursiveStop(parentClip.getChildAt(i) as DisplayObjectContainer, useStop, gotoFrame);
        }
    }
} 
```

# asp.net - ASP.NET mvc4 GridView 不显示来自数据库的数据

> ID：11022557
> 
> 赞同：1
> 
> 时间：2012-06-13T20:09:16.107
> 
> 标签：asp.net, asp.net-mvc-4

我有一个问题，在我的项目中，我试图将数据从我的数据库中获取到 GridView，但是在页面数据未显示...但在 VisualStudio 设计器模式下，我可以将数据检索到 gridview...我是什么做错了吗？

这里是 .aspx 页面中的代码

```
<div id="default">
<%: Html.ValidationSummary() %>
    <fieldset>
        <ol class="actionRefresh">
            <a href="/Admin/UsersInRolesList" target="_self" title="Refresh Users In Roles List">Users In Roles List<b>&nbsp;</b> </a>
        </ol>

        <form runat="server" id="frmUsers">

            <asp:SqlDataSource ID="sdsUsers" runat="server" 
                ConnectionString="<%$ ConnectionStrings:DefaultConnection %>" 
                SelectCommand="UserProfiles_s_sp" SelectCommandType="StoredProcedure" DataSourceMode="DataReader" ViewStateMode="Disabled">
                <SelectParameters>
                    <asp:Parameter Name="UserProfileID" Type="Int32" />
                    <asp:Parameter Name="UserId" Type="String" />
                    <asp:Parameter Name="UserName" Type="String" />
                    <asp:Parameter Name="PageSize" Type="Int32" />a
                    <asp:Parameter Name="PageNum" Type="Int32" />
                    <asp:Parameter Name="Sort" Type="String" />
                    <asp:Parameter Name="FirstName" Type="String" />
                    <asp:Parameter Name="Additional" Type="String" />
                </SelectParameters>
            </asp:SqlDataSource>

            <asp:GridView ID="gvUsers" runat="server" DataSourceID="sdsUsers" AutoGenerateColumns="true" ViewStateMode="Disabled">
                    <EmptyDataTemplate>
                        No data found.
                    </EmptyDataTemplate>
            </asp:GridView>

        </form>

        <div id="divBackTo">
            <a href="<%= Url.Action("Index", "Admin") %>" target="_self" title="Back to Menu"><<
                &nbsp;&nbsp; Back to Menu </a>
        </div>

    </fieldset>
</div> 
```

在控制器中我有这个代码：

```
try
        { }
        catch (Exception ex)
        {
            ModelState.AddModelError(String.Empty, ex.Message);
        }return View(); 
```

当我加载页面时，gridview 中显示“未找到数据”...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:15:44.073

GridView 用于 ASP.NET WebForms，而不是 ASP.NET MVC。在 MVC 中，控制器以模型的形式检索数据并将它们发送到视图。视图中没有数据访问权限。

有关许多教程，包括数据访问，请参阅[ASP.NET MVC3 入门。](http://www.asp.net/mvc/tutorials)

# android - 无尽的适配器总是在后台运行以下载数据

> ID：11022562
> 
> 赞同：0
> 
> 时间：2012-06-13T20:09:34.123
> 
> 标签：android, commonsware-cwac

我在我的应用程序中自定义了 EndlessAdapter 的代码，但我犯了一个错误，因为这个 Endless Adapter 总是在后台下载数据，而不是在用户向下滚动列表后下载相同的数据，我无法在我们的项目中找到相同的错误。由于这个错误，我的应用程序有时会返回 OutOfMemoryException，这是不可接受的。

请向我建议任何有关相同的解决方案。

**代码：** * *MyEndlessAdapter：* *

```
 class DemoAdapterCat extends EndlessAdapter {
              private RotateAnimation rotate=null;
              ArrayList<String> tempListNamesCat = new ArrayList<String>();
              ArrayList<String> tempListImagesCat = new ArrayList<String>();
              ArrayList<String> tempListYearCat1 = new ArrayList<String>();
              ArrayList<String> tempListYearCat2 = new ArrayList<String>();
              ArrayList<String> tempListmpgCat1 = new ArrayList<String>();
              ArrayList<String> tempListmpgCat2 = new ArrayList<String>();
              ArrayList<String> tempListpriceCat1 = new ArrayList<String>();
              ArrayList<String> tempListpriceCat2 = new ArrayList<String>();
              ArrayList<String> tempListRatingCat1 = new ArrayList<String>();
              ArrayList<String> tempListRatingCat2 = new ArrayList<String>();

              DemoAdapterCat() {
               super(new CategoryListLazyAdapter(ResearchList.this, countriesSubCat, imagesSubCat, YearSubCat1,YearSubCat2, mpgSubCat1,mpgSubCat2, priceSubCat1,priceSubCat2, ratingSubCat1, ratingSubCat2));
               Utility util = new Utility();
                util.setListViewHeightBasedOnChildren(lvCategory);
               rotate=new RotateAnimation(0f, 360f, Animation.RELATIVE_TO_SELF,
                 0.5f, Animation.RELATIVE_TO_SELF,
                 0.5f);
               rotate.setDuration(600);
               rotate.setRepeatMode(Animation.RESTART);
               rotate.setRepeatCount(Animation.INFINITE);
              }
            /* 
              @Override
            public int getCount()
              {
                  //return brandList.getDisplayNames().size();
                  return countriesSubCat.size();
              }*/
              @Override
              protected View getPendingView(ViewGroup parent) {
               row=getLayoutInflater().inflate(R.layout.categorylist, null);

               child=row.findViewById(R.id.tv_CategoryItem_Name);
               child.setVisibility(View.GONE);
               child = row.findViewById(R.id.tv_CategoryItem_MPG1);
               child.setVisibility(View.GONE);
               child = row.findViewById(R.id.tv_CategoryItem_MPG2);
               child.setVisibility(View.GONE);
               child = row.findViewById(R.id.tv_CategoryItem_Price1);
               child.setVisibility(View.GONE);
               child = row.findViewById(R.id.tv_CategoryItem_Price2);
               child.setVisibility(View.GONE);
               child = row.findViewById(R.id.tv_CategoryItem_Rating1);
               child.setVisibility(View.GONE);
               child = row.findViewById(R.id.tv_CategoryItem_Rating2);
               child.setVisibility(View.GONE);
               child = row.findViewById(R.id.tv_CategoryItem_Year1);
               child.setVisibility(View.GONE);
               child = row.findViewById(R.id.tv_CategoryItem_Year2);
               child.setVisibility(View.GONE);
               /*child = row.findViewById(R.id.img_CategoryItem);
               child.setVisibility(View.GONE);
               child = row.findViewById(R.id.img_CategoryItem_Arrow);
               child.setVisibility(View.GONE);*/

               /*child = row.findViewById(R.id.linear_main_MPG);
               child.setVisibility(View.GONE);*/
               child=row.findViewById(R.id.throbber);
               child.setVisibility(View.VISIBLE);
               child.startAnimation(rotate);

               return(row);
              }

              @Override
              protected boolean cacheInBackground() {

                    SystemClock.sleep(10000); 
               tempListNamesCat.clear();
               tempListImagesCat.clear();
               tempListmpgCat1.clear();
               tempListmpgCat2.clear();
               tempListpriceCat1.clear();
               tempListpriceCat2.clear();
               tempListYearCat1.clear();
               tempListYearCat2.clear();
               tempListRatingCat1.clear();
               tempListRatingCat2.clear();
               int lastOffset = getLastOffset();
               if(lastOffset < LIST_SIZE){
                int limit = lastOffset + BATCH_SIZE;
                for(int i=(lastOffset+1); (i<=limit && i<LIST_SIZE); i++){
                 tempListNamesCat.add(coll.getDisplayNames().get(i));
                 tempListImagesCat.add(coll.getImages().get(i));
                 tempListmpgCat1.add(coll.getMpg().get(i));
                 tempListmpgCat2.add(coll.getMpg().get(i+1));
                 tempListpriceCat1.add(coll.getPrice().get(i));
                 tempListpriceCat2.add(coll.getPrice().get(i+1));
                 tempListRatingCat1.add(coll.getRating().get(i));
                 tempListRatingCat2.add(coll.getRating().get(i+1));
                 tempListYearCat1.add(coll.getYears().get(i));
                 tempListYearCat2.add(coll.getYears().get(i+1));
                }    
                setLastOffset(limit);

                if(limit<LIST_SIZE){
                 //return true;
                    return(getWrappedAdapter().getCount()<coll.getDisplayNames().size());
                } else {
                 return false;
                }
               } else  {
                return false;
               }
              }

              @Override
              protected void appendCachedData() {

               @SuppressWarnings("unchecked")
               //Activity activity = this;
               //ArrayAdapter<String> arrAdapterNew = (ArrayAdapter<String>)getWrappedAdapter();
             CategoryListLazyAdapter arrAdapterNewCategory = (CategoryListLazyAdapter)getWrappedAdapter();
               //int listLen = tempList.size();
              // int listLen = tempListNames.size();
              countriesSubCat.addAll(tempListNamesCat);
              imagesSubCat.addAll(tempListImagesCat);
              mpgSubCat1.addAll(tempListmpgCat1);
              mpgSubCat2.addAll(tempListmpgCat2);
              priceSubCat1.addAll(tempListpriceCat1);
              priceSubCat2.addAll(tempListpriceCat2);
              ratingSubCat1.addAll(tempListRatingCat1);
              ratingSubCat2.addAll(tempListRatingCat2);
              YearSubCat1.addAll(tempListYearCat1);
              YearSubCat2.addAll(tempListYearCat2);
              arrAdapterNewCategory.notifyDataSetChanged();
              Utility util = new Utility();
              util.setListViewHeightBasedOnChildren(lvCategory);
              /* for(int i=0; i<listLen; i++){
              //  arrAdapterNew.add(tempList.get(i));
               }*/
              }
             } 
```

**将 Demoadapter 设置为列表：**

```
public void setValuesInCategoryChildSortByAZ(String url,final String filter, final String from, final String to)
    {
        if(isOnline())
        {
            final ProgressDialog dialog = ProgressDialog.show(
                    ResearchList.this, "Research List       ",
                    "Please wait...   ", true);

            final Handler handler = new Handler() {

                public void handleMessage(Message msg) {

                    // System.out.println("The id after Save:"+id.get(0).toString());

                    // catagory.addAll(keyword_vector1);
                    linear_Category_Child.setVisibility(View.GONE);
                    linear_Category_Child_Child.setVisibility(View.VISIBLE);
                    //tv_Child_Header.setText("Volvo");
                    /*adapter = new CategoryListLazyAdapter(
                            ResearchList.this);
                    lvCategory.setAdapter(adapter);*/
                    demoAdapterCat.notifyDataSetChanged();
                    Utility util = new Utility();
                    util.setListViewHeightBasedOnChildren(lvCategory);
                    dialog.dismiss();
                }
            };

            final Thread checkUpdate = new Thread() {

                public void run() {
                    try {
                        String sortEncode = URLEncoder.encode("alpha");
                        String filterEncode = URLEncoder.encode(filter);
                        String clientEncode = URLEncoder.encode("10030812");
                        String fromEncode = URLEncoder.encode(from);
                        String toEncode = URLEncoder.encode(to);
                        String catUrl = "/v1/vehicles/get-make-models.json?sort="+sortEncode+"&filter="+filterEncode+"&client-id="+clientEncode+"&from="+fromEncode;
                        genSig = new GetSignature(catUrl, "acura");
                        try {
                            signature = genSig.getUrlFromString();
                        } catch (InvalidKeyException e1) {
                            // TODO Auto-generated catch block
                            e1.printStackTrace();
                        } catch (NoSuchAlgorithmException e1) {
                            // TODO Auto-generated catch block
                            e1.printStackTrace();
                        }
                        // jsonString =
                        // getJsonSring("http://api.highgearmedia.com/v1/vehicles/get-models.json?make=acura&client-id=10030812&signature=LWQbdAlJVxlXZ1VO2mfqAA==");
                        //String signatureEncode = URLEncoder.encode(signature);
                        String urlEncode = URLEncoder.encode(catUrl+"&signature="+signature);
                        jsonString = getJsonSring("http://apibeta.highgearmedia.com"+catUrl+"&signature="+signature);
                        System.out.println("The json category:===>"+jsonString);
                    } catch (ClientProtocolException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    } catch (URISyntaxException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    } catch (IOException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                    JsonParse json = new JsonParse(jsonString);
                    json.parseCat();
                    handler.sendEmptyMessage(0);

                }

            };
            checkUpdate.start();
        }else
        {
            AlertDialog.Builder builder = new Builder(ResearchList.this);
            builder.setTitle("Attention!");
            builder.setMessage("Network Connection unavailable.");
            builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {
                    // TODO Auto-generated method stub

                }
            });

            builder.create().show();
        }

    } 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:17:34.920

> 我在我们的项目中找不到同样的错误

EndlessAdapter 示例应用程序在这里：[https](https://github.com/commonsguy/cwac-endless/tree/master/demo) ://github.com/commonsguy/cwac-endless/tree/master/demo 。

如果您查看该示例应用程序，您会注意到它没有派生任何线程。

如果您阅读[文档，您](https://github.com/commonsguy/cwac-endless)[将`EndlessAdapter`](https://github.com/commonsguy/cwac-endless)看到：

> 您的 EndlessAdapter 子类还需要实现 cacheInBackground()。此方法将从后台线程调用，它需要下载更多数据，这些数据最终将添加到您在构造函数中使用的 ListAdapter 中。虽然演示应用程序只是休眠了 10 秒，但真正的应用程序可能会进行 Web 服务调用或以其他方式加载更多数据。
> 
> **由于此方法是在后台线程上调用的，因此您不需要 fork 自己的线程。**但是，同时，不要尝试直接更新 UI。

所以，改变你的项目，不要分叉你自己的线程，而是做你的工作`cacheInBackground()`来检索和添加下一批数据。

如果该方法不适合您的应用程序需要运行的方式，那很好，但您可能在使用`EndlessAdapter`.

# python - 使用 ctypes libc.strlen 时总是返回 1？

> ID：11022571
> 
> 赞同：1
> 
> 时间：2012-06-13T20:10:16.060
> 
> 标签：python, python-3.x, ctypes

我有一个使用 ctypes 的简单代码：

```
Python 3.1.1 (r311:74480, Feb 23 2010, 11:06:41)
[GCC 4.1.2 20071124 (Red Hat 4.1.2-42)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import ctypes
>>> libc = ctypes.CDLL("libc.so.6")
>>> libc.strlen("HELLO")
1
>>> print(libc.strlen("HELLO"))
1 
```

我做错什么了 ？。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:50:00.450

Python 3 对字符串使用 Unicode。当传递给 C 函数时，每个字符将超过一个字节，对于 ASCII 字符，其中一个字节将为零。`strlen`将在它找到的第一个零处停止。

我能够在 Python 2.7 中复制这些结果，并进行了修复：

```
>>> libc.strlen("HELLO")
5
>>> libc.strlen(u"HELLO")
1
>>> libc.strlen(u"HELLO".encode('ascii'))
5 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T05:50:06.040

`ctypes`告诉它参数的类型是个好主意，当你弄错时它会告诉你：

```
Python 3.2.3 (default, Apr 11 2012, 07:15:24) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import ctypes
>>> libc = ctypes.CDLL("msvcrt")
>>> libc.strlen('hello')
1
>>> libc.strlen.argtypes=[ctypes.c_char_p]
>>> libc.strlen('hello')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ctypes.ArgumentError: argument 1: <class 'TypeError'>: wrong type 
```

在 Python 3 中，字符串是默认的 Unicode。 `b''`语法是字节字符串，这就是 strlen 的作用：

```
>>> libc.strlen(b'hello')
5 
```

至少在 Windows 上，strlen 有多种版本：

```
>>> libc.wcslen.argtypes=[ctypes.c_wchar_p]
>>> libc.wcslen('hello')
5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:30:17.197

```
$ python
Python 2.7.3 (default, Apr 20 2012, 22:39:59)
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import ctypes
>>> libc = ctypes.CDLL('libc.so.6')
>>> libc.strlen('HELLO')
5 
```

您的 Python 或 gcc 版本，或者它可能需要显式 NUL 终止，如`libc.strlen('HELLO\0')`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T20:35:39.247

奇怪....与 b 它的作品！

```
>>> libc.strlen(b'HELLO')
5 
```

# zend-framework - 如何处理 Zend Framework 最终用户 INI/Config 设置

> ID：11022577
> 
> 赞同：1
> 
> 时间：2012-06-13T20:10:39.180
> 
> 标签：zend-framework, config, ini

我已经搜索并搜索了这个，但我认为我的术语不正确，因为它一直给我 zend 站点的应用程序设置，而不是最终用户的应用程序设置。

我想要一个 config.ini 类型的文件，最终用户可以在其中编辑值。我希望它只是我希望他们看到的设置，并且能够创建我认为的值名称对他们有感觉。所以它会像

```
[General]
SiteName=MySite
ShowResources=TRUE

[Database]
Server=myServer
databasepath=mydbpath
... 
```

所以我的两个问题。1.这种类型的文件叫什么，因为当我搜索应用程序设置时，我得到的 ZF 应用程序设置不是最终用户的（大概）

1.  处理此类文件的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:29:25.823

1.  它是一个 INI 文件，您可以通过 Zend_Config 对其进行读写。
2.  ZF 没有“用户设置”的概念——用户是由您定义的，而不是由框架定义的。

应用程序通常将用户配置存储在数据库中，但这完全取决于您。您可以改为存储 INI 文件的目录。无论哪种方式，您都必须自己进行实施。

编辑：假设您有一个要分发给客户的 ZF 应用程序，并且他们只会使用它连接到一个数据库，这会显着改变事情。（我以为您最初的意思是让应用程序的一个实例同时连接到多个数据库。）

在您的情况下，我会使用标准的 ZF application/configs/application.ini 文件作为您应用程序的“内部”设置。然后，我将在同一个 application/configs 目录中有一个单独的 local.ini（或其他），其中仅包含您希望客户编辑的那些设置。使用应用程序分发一个骨架 local.ini 文件，其中包含说明，如下所示：

```
; Remove the comment from this line.
;configured = 1

; You need to put your database credentials in here.
db_host = "PUT YOUR DATABASE SERVER NAME HERE"
db_user = "PUT YOUR DATABASE USERNAME HERE"
db_pass = "PUT YOUR DATABASE PASSWORD HERE" 
```

然后只需通过 Zend_Config 加载 local.ini 文件。我还会在您的索引控制器的 init 方法中添加一个检查，以检查您是否配置正确：

```
$localConfig = Zend_Registry::get('local_config'); // or wherever you put it
if (!$localConfig->configured) {
    $this->_helper->redirector('config', 'error');
} 
```

然后制作一个错误/配置视图，上面写着：

```
You didn't read the instructions. Go do that now. 
```

请注意，没有什么可以阻止客户编辑他们想要的任何内容，但这会产生逻辑分离，并且更难意外搞砸。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T11:49:22.723

在您的引导程序中添加：

```
protected function _initConfig()
{
    $config = new Zend_Config_Ini(APPLICATION_PATH.'/configs/config.ini');

    Zend_Registry::set('config', $config);

    return $config;
} 
```

用您想要的文件名替换 config.ini。

然后，您可以作为应用程序资源或通过注册表 ( `Zend_Registry::get('config')`) 在应用程序的任何位置访问此配置对象。因此，要从您的示例中获取 SiteName：

```
$config = Zend_Registry::get('config');
echo $config->General->SiteName; 
```

对于诸如数据库设置之类的事情，您需要在引导程序中访问它们，以便您可以使用它们来设置其他资源。我建议您不要尝试在 application.ini 中包含数据库设置，而是通过添加另一个引导方法手动设置 DB 资源：

```
protected function _initDb()
{
    $this->bootstrap('config');
    $config = $this->getResource('config');

    $db = Zend_Db::factory('Pdo_Mysql', array(
        'host'     => $config->Database->Server,
        'username' => $config->Database->Username,
        'password' => $config->Database->Password,
        'dbname'   => $config->Database->Dbname
    ));

    return $db;
} 
```

为了进一步解释这一点，`$this->bootstrap('config');`请确保首先加载配置资源。`$this->getResource('config');`返回配置资源（由 _initConfig() 方法创建的资源）。然后它使用来自该对象的数据来创建数据库连接。

# powershell - 将当前用户添加到管理员组

> ID：11022579
> 
> 赞同：2
> 
> 时间：2012-06-13T20:10:45.527
> 
> 标签：powershell, powershell-2.0

我正在编写一个脚本，该脚本将检查用户是否是管理员，如果不是，它将当场添加它们，注销，然后我可以重新登录以进行测试。这是我遇到问题的部分：

```
$Cred = Get-Credential ("$env:COMPUTERNAME\Administrator")
$Group = [ADSI]("WinNT://"+$env:COMPUTERNAME+"/Administrators,Group")
$User = $env:USERNAME
$Domain = $env:USERDOMAIN
Invoke-Command -Computername localhost -Cred $Cred -ScriptBlock {$Group.add("WinNT://$Domain/$User,user")} 
```

每次我运行这个我都会收到以下错误：

```
You cannot call a method on a null-valued expression. 
```

有什么想法可以解决这个问题吗？

工作解决方案：

```
$Cred = Get-Credential ("$env:COMPUTERNAME\Administrator")
$User = $env:USERNAME
$Domain = $env:USERDOMAIN
Invoke-Command -Computername localhost -Cred $Cred -ScriptBlock {
    param ($User, $Domain, $ComputerName)
    $Group = [ADSI]("WinNT://$ComputerName/Administrators,Group")
    $Group.add("WinNT://$Domain/$User,user")
} -ArgumentList $User, $Domain, $ENV:COMPUTERNAME 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:32:55.857

Invoke-Command 对 $Group 变量一无所知，这就是它不能那样工作的原因。您需要使用 -ArgumentList 参数将变量传递给脚本块。

另外：我宁愿在这个脚本块中定义诸如 $Group 之类的东西：

```
$Cred = Get-Credential ("$env:COMPUTERNAME\Administrator")
$User = $env:USERNAME
$Domain = $env:USERDOMAIN
Invoke-Command -Computername localhost -Cred $Cred -ScriptBlock {
    param ($User, $Domain, $ComputerName)
    $Group = [ADSI]("WinNT://$ComputerName/Administrators,Group")
    $Group.add("WinNT://$Domain/$User,user")
} -ArgumentList $User, $Domain, $ENV:COMPUTERNAME 
```

高温高压

巴特克

PS：只有一个问题：为什么不做简单的方法，用：

```
net localgroup administrators domain\user /add 
```

# winapi - 如何在没有 UAC 的情况下覆盖 windows 资源管理器的复制处理程序

> ID：11022581
> 
> 赞同：0
> 
> 时间：2012-06-13T20:10:58.007
> 
> 标签：winapi, regsvr32

我已经看到 Teracopy 和 CopyHandler，通过覆盖复制处理程序拦截副本。但就我而言，这唤醒了 UAC。

使用的代码：[https://github.com/alphaonex86/Ultracopier/blob/master/plugins/PluginLoader/catchcopy-v0002/pluginLoader.cpp](https://github.com/alphaonex86/Ultracopier/blob/master/plugins/PluginLoader/catchcopy-v0002/pluginLoader.cpp) 到 PluginLoader::RegisterShellExtDll()

其他接缝也一样。主要是我使用 regsvr32 my_dll.dll 加载到资源管理器中。有些人有提示不要打开UAC？

谢谢。

# yaml-cpp - 使用 yaml-cpp new api 确定列表中的项目数

> ID：11022582
> 
> 赞同：1
> 
> 时间：2012-06-13T20:11:03.763
> 
> 标签：yaml-cpp

有没有办法确定 YAML 列表中的项目数，或者使用新的 yaml-cpp api 检查条目是否存在？例如，假设我有清单

```
Food:
  - pizza: 270
  - ice_cream: 90
  - fruit: 30 
```

如何确定食物的数量？另外，有没有办法检查 YAML 字符串中是否存在食物？`root_node["Foods"]["fruit"].as<int>()`我知道如果水果不存在，我可以尝试对食物进行索引并捕获异常，但是在旧 api 中是否有类似于 FindValue() 的函数（ [http://code.google.com/p/yaml -cpp/wiki/HowToParseADocument](http://code.google.com/p/yaml-cpp/wiki/HowToParseADocument) ) 检查条目是否存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:22:59.873

要获取食物的数量，请使用

```
root_node["Food"].size(); 
```

在您的示例中检查食物是否存在有点棘手，因为它是一系列地图，每个地图都有一个键/值对。（这通常用于创建有序映射。）您只需遍历每个条目并检查它是否是您想要的：

```
bool does_food_exist(const std::string& name) {
    for(std::size_t i=0;i<root_node["Food"].size();i++) {
        if(root_node["Food"][i][name])
            return true;
    }
    return false;
} 
```

相反，如果您的意思是实际拥有一个实际的地图，那么您的 YAML 文件应该如下所示：

```
Food:
  pizza: 270
  ice_cream: 90
  fruit: 30 
```

在这种情况下，检查食物是否存在很容易：

```
if(root_node["Food"]["fruit"]) {
    // "fruit" exists
} else {
    // it doesn't exist
} 
```

# ruby-on-rails - Eager Loading N+1 问题

> ID：11022588
> 
> 赞同：0
> 
> 时间：2012-06-13T20:11:28.740
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, eager-loading

```
 <%- @lessons.includes(:bookmarks).each_with_index do |lesson, index| -%>
          <tr>
            <td class="w6 pl">
              <%- bookmark = lesson.bookmarks.where(user_id: current_user).first -%>
              <%= render :partial => "student/lessons/bookmark", :locals => {:bookmark => bookmark, :lesson => lesson} %>
            </td>
          </tr>
 <%- end -%> 
```

上面的代码产生以下 N+1 个查询：

```
 Bookmark Load (0.3ms)  SELECT "bookmarks".* FROM "bookmarks" WHERE "bookmarks"."lesson_id" IN (1, 2, 3, 4, 5, 6)
  Bookmark Load (0.3ms)  SELECT "bookmarks".* FROM "bookmarks" WHERE "bookmarks"."lesson_id" = 1 AND "bookmarks"."user_id" = 1 LIMIT 1
Rendered student/lessons/_bookmark.html.erb (1.4ms)
  Bookmark Load (0.3ms)  SELECT "bookmarks".* FROM "bookmarks" WHERE "bookmarks"."lesson_id" = 2 AND "bookmarks"."user_id" = 1 LIMIT 1
Rendered student/lessons/_bookmark.html.erb (0.6ms)
  Bookmark Load (0.3ms)  SELECT "bookmarks".* FROM "bookmarks" WHERE "bookmarks"."lesson_id" = 3 AND "bookmarks"."user_id" = 1 LIMIT 1
Rendered student/lessons/_bookmark.html.erb (0.6ms)
  Bookmark Load (0.3ms)  SELECT "bookmarks".* FROM "bookmarks" WHERE "bookmarks"."lesson_id" = 4 AND "bookmarks"."user_id" = 1 LIMIT 1
Rendered student/lessons/_bookmark.html.erb (0.6ms)
  Bookmark Load (0.2ms)  SELECT "bookmarks".* FROM "bookmarks" WHERE "bookmarks"."lesson_id" = 5 AND "bookmarks"."user_id" = 1 LIMIT 1
Rendered student/lessons/_bookmark.html.erb (0.6ms)
  Bookmark Load (0.1ms)  SELECT "bookmarks".* FROM "bookmarks" WHERE "bookmarks"."lesson_id" = 6 AND "bookmarks"."user_id" = 1 LIMIT 1 
```

由于我在循环内使用 where 查询，如何防止第一个查询之后的额外查询？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:42:09.130

您需要手动执行两个查询：

```
@lessons = Lesson.all # i.e.
@bookmarks = Bookmark.select("bookmarks.*, DISTINCT(lesson_id)").where(user_id: current_user.id) 
```

进而

```
@lessons.each do |lesson|
  ...
  bookmark = @bookmarks.detect{ |b| b.lesson_id == lesson.id }
  ...
end 
```

# php - php - 将 2012-06-25 19:00:00 转换为另一种格式

> ID：11022591
> 
> 赞同：0
> 
> 时间：2012-06-13T20:11:34.317
> 
> 标签：php, time, strtotime, mktime

通过 xml，我得到了以这种格式给出时间的变量：2012-06-25 19:00:00

我希望将其转换为以下格式：6 月 25 日 - 晚上 7:00

我查看了 mktime 和 strtotime，但我不确定如何处理作为日期和时间出现的格式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T20:13:35.773

正如你所说，你可以使用[strtotime](http://php.net/strtotime)：

```
echo date('F-m - h:iA', strtotime($old_format)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:17:27.070

```
<?php

$input = "2012-06-25 19:00:00";

$dateTimeObject = new DateTime($input);
echo "First way: " . $dateTimeObject->format("F d - g:iA") . "<br>\n";

$date = date("F d - g:iA", strtotime($input));
echo "Second way: " . $date; 
```

# image - 显示彩色图像的子数组

> ID：11022598
> 
> 赞同：0
> 
> 时间：2012-06-13T20:12:02.160
> 
> 标签：image, matlab, image-processing

给定一个彩色图像，我只需要显示图像的一个子部分，在 matlab 中，这就像从数组图像中显示一个子数组。

```
I=imread('lena_std.tif');
imshow(I(1:200,1:200); 
```

对于灰度图像，上面的代码正确显示了所需图像的子部分，但是对于彩色图像，它显示的是灰度图像。我知道有一个 3° 维度，其颜色的值为 3 (RGB)，但我只是不知道如何考虑该维度以显示颜色的子部分。

你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:19:09.277

您可以添加到代码`:`中以处理三维中的所有元素：

```
I=imread('lena_std.tif');
imshow(I(1:200,1:200,:); 
```

# java - 无法在 32 位 JVM 上加载 64 位 SWT 库（替换 SWT 文件）

> ID：11022600
> 
> 赞同：25
> 
> 时间：2012-06-13T20:12:11.983
> 
> 标签：java, eclipse-plugin, jvm, swt, eclipse-rcp

我正在尝试调试此问题，但不确定我需要在哪里**替换**Eclipse 的 SWT jar 文件。

当前系统配置：

```
Eclipse Helios 3.6 - 32 Bit
JDK 1.6 
JVM - 32 Bit 
Windows 7 - 64 Bit 
```

错误信息：

```
java.lang.UnsatisfiedLinkError: Cannot load 64-bit SWT libraries on 32-bit JVM
    at org.eclipse.swt.internal.Library.loadLibrary(Library.java:194)
    at org.eclipse.swt.internal.Library.loadLibrary(Library.java:174)
    at org.eclipse.swt.internal.C.<clinit>(C.java:21)
    at org.eclipse.swt.widgets.Display.<clinit>(Display.java:138)
    at org.eclipse.ui.internal.Workbench.createDisplay(Workbench.java:687)
    at org.eclipse.ui.PlatformUI.createDisplay(PlatformUI.java:161)
    at de.vogella.rcp.intro.first.Application.start(Application.java:18)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:620)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:575)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1408)
    at org.eclipse.equinox.launcher.Main.main(Main.java:1384)
An error has occurred. See the log file 
```

解决方法：

1.  [Link1](https://stackoverflow.com/questions/2921193/swt-on-windows-64-bit)：了解问题的原因，我尝试将 64 位 SWT 替换为 32 位，但我不确定我是否做得对？

    下载 32 位文件 swt-3.6.1-win32-win32-x86.zip 解压 zip 文件 有文件如下图

    ![在此处输入图像描述](../Images/1e0ab71b9c9680cf3ea0bd433f752ce6.png)

    复制的 swt.jar 文件导航到 C:\Program Files\eclipse\plugins 删除 64 位 Swt 文件（即 org.eclipse.swt.win32.win32.x86_64.source_3.6.2.v3659c ）放置复制的 swt.jar 文件并重新启动

    **仍然抛出相同的错误**

    还尝试将 swt.jar 文件重命名为 org.eclipse.swt.win32.win32.x86_64.source_3.6.2.v3659c

    **还是一样的错误**

2.  [Link2](http://www.badprog.com/eclipse-standard-widget-toolkit-swt-installation)：建议了替代解决方案，但无法解决问题。

    **还是一样的错误**

3.  我真的不想卸载 32-JVM 和 32-Bit Eclipse 并安装相应的 64 位版本。

    **不是选项**

解决方法 在**paulsm4**和**Paul Webster**响应之后，**我很困惑**

当我尝试执行此操作以检查 Eclipse 中的 JVM、JRE 版本时

```
package javaVersion;

public class JavaVersion
{

    public static void main( String[] args )
    {
        System.out.println( "JRE Version :" + System.getProperty( "java.runtime.version" ) );
        System.out.println( "JVM Bit size: " + System.getProperty( "sun.arch.data.model" ) );

    }

} 
```

输出：

```
1.6.0_31-b05
JVM Bit size: 32 
```

但是，当我在命令行上尝试 JAVA - VERSION

![在此处输入图像描述](../Images/3b2b5cdb9e8191b6cd974f5a445dc082.png)

所以我的理解系统有 64 位 JVM，而 Eclispe 正在读取 32 位 JVM。那么如何转移系统读取 32 位 JVM 呢？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-14T17:20:59.170

Eclipse 正在使用您在启动配置中定义的任何 JRE 启动您的应用程序。由于您正在运行 32 位 Eclipse，因此您正在运行/调试它的 32 位 SWT 库，并且您需要运行 32 位 JRE。

无论出于何种原因，您的 64 位 JRE 都是您的默认已安装 JRE。

要更改此设置，首先确保在 Installed JREs 首选项中配置了 32 位 JRE。转到 Window -> Preferences 并导航到 Java -> Installed JREs：

![已安装的 JRE](../Images/a38bf00c15ef65c0ac6a1f203f8075d4.png)

您可以单击添加并导航到您的 32 位 JVM`JAVA_HOME`以添加它。

然后在您的运行配置中，找到您的 Eclipse 应用程序并确保将运行时 JRE 设置为您刚刚配置的 32 位 JRE：

![运行配置](../Images/2ef3ab75ac231b06277d2f48971356b8.png)

（请注意未突出显示的组合框。）

不要尝试更换 SWT 罐子，这可能会以失败告终。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-13T20:15:11.100

好吧，duh :) SWT 使用 JNI ...并且 JNI 是严格特定于平台的。

使用 32 位库和 32 位 JVM，64 位库和 64 位 JVM，确保版本*完全*匹配，不要混用。

恕我直言...

PS：您可以在同一个盒子上同时存在多个 JVM 和/或多个 Eclipse。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-03-15T18:26:10.693

我从路径中删除了 **C:\ProgramData\Oracle\Java\javapath** ，它对我有用。

并确保在路径中包含 x64 JDK 和 JRE 地址。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-12T17:20:18.453

只需将 -d32 添加到“编辑启动配置属性”中的 VM 参数即可。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-26T06:13:53.693

I also faced the same problem a long time ago.

Here is the Solution

In Eclipse Click on "Windows"-->"Preferences"---->"Java"---> "Installed JREs"---->Select the JDK, click on "Edit".

Check your JDK path, is it according to your path in environmental variables defined in system. if not then change it to "path" defined directory.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-11T03:24:43.130

我刚刚用 64 位版本替换了我的包中的 swt.jar，它立即工作。无需重新编译整个包，只需替换 swt.jar 文件并确保您的应用程序清单包含它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-14T19:09:15.687

非常感谢你们！

我忽略了我的**ECLIPSE 版本**，它是**64 位**和 3.6

我必须确保它是 32 位 Eclipse、32 位 JVM，所以我卸载了 Eclipse 和所有 JVM 以进行干净启动。[从这里](http://www.eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/heliossr2)安装 32Bit JDK1.6 和从[这里](http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-javase6-419409.html)安装32Bit Eclipse

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-08T12:26:41.870

如果您正在使用 RCP-SWT 项目，请检查目标定义。

打开目标编辑器并导航到环境定义。在那里你可以设置架构。这个想法是，通过启动您的 RCP 应用程序，然后只会加载 32 位 SWT 库/包。如果您已经有运行时配置，建议您也创建一个新配置。

[![Eclipse 中的目标编辑器](../Images/9860bb02a6b358c4c17f33d40288def3.png)](https://i.stack.imgur.com/I9DwR.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-04-13T07:02:04.990

所以，只要确保您在正确的环境中，即 32 位 SWT LIBRARIES 应该匹配 32 位 JVM，反之亦然。

我通过安装 64 位 jdk 、64 位 jre 解决了这个问题，最后通过在环境变量中添加设置 jdk 路径并将 jre 添加到 Eclipse 中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-06-07T05:10:55.043

I removed C:\ProgramData\Oracle\Java\javapath from my path, and it worked for me.

But make sure you include x64 JDK and JRE addresses in your path.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-11-30T03:17:51.433

安装 JDK。

使用 JRE 运行 Eclipse 是可能的，或者至少以前是这样，但是为什么要麻烦呢？Eclipse 对 JDK 更满意。

请记住，用于运行 Eclipse 的 JRE 不必是 Eclipse 用于运行应用程序的 JRE。

PS。我在这里假设原始发布者的问题是让 Eclipse 启动，而不是（正如其他一些答案似乎解决的那样）让 Eclipse 启动应用程序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-03-27T03:42:22.200

转到路径 C:\ProgramData\Oracle\Java\javapath （在我的情况下，此路径可能与您的情况不同）。使用其他名称行 ORACLE_OLD 重命名文件夹 ORACLE。并重新启动 STS/IDE 。这对我有用

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2017-11-16T14:47:11.397

我从路径中删除了 C:\ProgramData\Oracle\Java\javapath，它对我有用。完美的答案，谢谢尼基尔。

# ruby-on-rails - 在 Rails 视图中创建公式？

> ID：11022602
> 
> 赞同：0
> 
> 时间：2012-06-13T20:12:18.277
> 
> 标签：ruby-on-rails, ruby-on-rails-3, logic, formula

我想在我的视图/主页中创建一个小公式。基本上它应该说如果当前用户登录（正确的部分）并且用户创建了一个注册表= TRUE那么这个或那个。

下面是代码：

```
 <% if user_signed_in? and?????? %>

 <%= link_to "Show My Registry", current_user.registry %>

 <% else %>

 <%= link_to "Create a new registry", new_registry_path %>

 <% end %> 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:21:08.203

假设`Registry`是属于 a 的模型`User`，您可以使用`<% if user_signed_in? && current_user.registry.exists? %>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:27:03.757

您可能想要嵌套这两个决策。如果用户没有登录会发生什么？您是否仍希望用户无需登录即可创建注册表？其他选择是考虑使用 before_filter 以确保用户在到达您的应用程序中的此决策点之前始终登录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:20:59.887

我假设你们都准备好建立用户和注册表之间的关系。如果是这样，如果是这样，您可以在用户控制器中创建一个看起来像这样的方法。

```
def user_registry
  User.current.registry
end 
```

然后，如果您查看您的 if 语句应该类似于

```
<% if user_signed_in? and user_registry? %>

<%= link_to "Show My Registry", current_user.registry %>

<% else %>

<%= link_to "Create a new registry", new_registry_path %>

<% end %> 
```

# objective-c - 设置 MPMediaItem 的图稿

> ID：11022604
> 
> 赞同：0
> 
> 时间：2012-06-13T20:12:30.253
> 
> 标签：objective-c, ios, cocoa-touch, cocoa

我知道我可以`MPMediaItem`通过执行以下操作来检索 的艺术品：

```
MPMediaItemCollection *collection;
/* Get media item collection here */
MPMediaItem *item = [[collection items] objectAtIndex:0];
MPMediaItemArtwork *artwork = [item valueForKey:MPMediaItemPropertyArtwork]; 
```

我想用另一个替换艺术品图像。我将如何做到这一点？

我尝试了以下但它不起作用。

```
UIImage *newImage;
/* get image here */
MPMediaItemArtwork *artwork = [[MPMediaItemArtwork alloc] initWithImage:newImage];
[item setValue:artwork forKey:MPMediaItemPropertyArtwork]; 
```

抛出运行时异常并显示以下消息：
`this class is not key value coding-compliant for the key artwork.`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:16:11.000

MPMediaItem 是不可变的——您不能使用 API 更改 iPod 库中的任何内容。

[http://developer.apple.com/library/ios/#documentation/Audio/Conceptual/iPodLibraryAccess_Guide/AboutiPodLibraryAccess/AboutiPodLibraryAccess.html#//apple_ref/doc/uid/TP40008765-CH103-SW9](http://developer.apple.com/library/ios/#documentation/Audio/Conceptual/iPodLibraryAccess_Guide/AboutiPodLibraryAccess/AboutiPodLibraryAccess.html#//apple_ref/doc/uid/TP40008765-CH103-SW9)

# java - 哪个效率更高？for循环中使用的缓存方法调用结果

> ID：11022606
> 
> 赞同：2
> 
> 时间：2012-06-13T20:12:40.070
> 
> 标签：java, performance

差异可能很小或不存在，但哪个更有效，为什么？

```
int nItems = param.getItemList().size();
for (...) {
    if (nitems == 1) doSomething();
} 
```

或者

```
for (...) {
    if (param.getItemList().size() == 1) doSomething();
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T20:15:25.120

从理论上讲，第一个会更快（你分析过它吗？你应该！），因为它把一个经常使用的方法调用拉到循环之外。但是，如果有足够的时间，JIT 编译器可能会优化/内联方法调用，从而使两种解决方案在性能方面无法区分。

这样的微优化不值得努力，更好地针对更清晰、更易于理解的解决方案。恕我直言，这恰好是第一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:14:53.923

在循环外进行方法调用效率更高。有时它甚至可能很重要。第二种方法可能更有效的一种情况是`for`循环的条件是否导致循环被完全跳过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:14:58.540

第一个更有效，因为不需要多次调用该方法。但是，由于两者`getItemList()`似乎`size()`都是访问者，因此差异将是微乎其微的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T20:15:59.083

第一个，因为您不需要为循环的每次迭代都进行两次调用

# jquery - jQuery - 在页面上键入时进行搜索，就像 cpanel 搜索一样

> ID：11022612
> 
> 赞同：0
> 
> 时间：2012-06-13T20:13:12.210
> 
> 标签：jquery, search, find, jquery-filter

我正在寻找类似于 cpanel 搜索的功能。当您在搜索框中输入内容时，相似的内容会保留下来，而其余内容则会消失。例子

```
<div>hello</div>
<div>world</div>
<div>good</div>
<div>bad</div>
<input type="text" name="search"> 
```

现在，当我开始输入“他”时。只有你好显示和其余的 div 去 display:none;

可能吗？看过Cpanel搜索框的人都知道我在问什么。我一直在寻找这个，但找不到任何类似的东西。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:21:02.467

当然很简单，只需使用并相应地`keyup` `event`切换`<div>`

[jsFiddle](http://jsfiddle.net/wCTqC/)

**HTML**

```
<div id="example">
  <div>hello</div>
  <div>world</div>
  <div>good</div>
  <div>bad</div>
</div>
<input type="text" name="search" id="search"> 
```

**JS**

```
$(function(){
    $('#search').keyup(function(event){
        var keyCode = event.which; // check which key was pressed
        var term = $(this).val();
        $('#example').children().hide(); // hide all
        $('#example').children(':Contains("' + term + '")').show(); // toggle based on term
    });
 });​

 $.expr[':'].Contains = function(a, i, m) { 
    return jQuery(a).text().toUpperCase().indexOf(m[3].toUpperCase()) >= 0; 
 }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:21:51.060

是的，这是可能的。

这是我的小提琴：http: [//jsfiddle.net/HQFQ5/2/](http://jsfiddle.net/HQFQ5/2/)

这是使其工作的功能：

```
$('input').bind('keyup',function(){
  var selfVal = $(this).val()
  var compareDivs = $('div');
  compareDivs.each(function(){
     var divVal = $(this).text().toString();
     if (divVal.indexOf(selfVal)<0)
         $(this).fadeOut();
     else
         $(this).fadeIn();
  });
});​ 
```

# extjs - 在启用自动同步的同步后存储执行某些操作

> ID：11022616
> 
> 赞同：4
> 
> 时间：2012-06-13T20:13:26.837
> 
> 标签：extjs, extjs4.1

我正在尝试检测并删除同步后仍在存储但未添加到数据库中的那些字段（成功：false）。然后，向用户返回一条错误消息（带有一些错误代码）。但是，我只能在商店文档中看到“beforesync”事件。

有没有可能做这样的事情？我正在尝试使用“更新”事件，但只有在同步成功时才会在同步后调用它们（否则它们只会在同步之前调用）。

我真的找不到同步后触发的事件。有什么解决办法吗？

请注意，我正在使用自动同步，这就是为什么我不能挂钩回调，否则一切都会更容易。

我可以在文档中看到的另一个重要点是：

代码：

```
Ext.data.Model.EDIT
Ext.data.Model.REJECT
Ext.data.Model.COMMIT 
```

为什么 REJECT 事件永远不会被触发？我认为如果成功 = false REJECT 会被调用，我是否需要类似 404 的东西才能获得该结果？

编辑：不，我找不到触发更新事件的 REJECT 版本的方法。有什么建议吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-13T23:49:30.587

如果你问我，这是 ExtJS 中的一些设计缺陷。

AbstractStore 有`onCreateRecords`,`onUpdateRecords`和`onDestroyRecords`, 是可以覆盖的空函数。如果成功为假，您可以调用 rejectChanges() 。

```
Ext.define('BS.store.Users', {
    extend: 'Ext.data.Store',    
    model: 'BS.model.User',

    autoSync: true,
    autoLoad: true,

    proxy: {
        type: 'direct',
        api: {
            create: Users.Create,
            read: Users.Get,
            update: Users.Update,
            destroy: Users.Delete,

        },
        reader: {
            type: 'json',
            root: 'data',
        },
    },

    onCreateRecords: function(records, operation, success) {
        console.log(records);
    },

    onUpdateRecords: function(records, operation, success) {
        console.log(records);
    },

    onDestroyRecords: function(records, operation, success) {
        console.log(records);
    },

}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-08T11:14:42.990

仅供参考：更新记录时的事件序列（ExtJs 5.0.1）

```
Scenerio 1
javascript executes 
record.set('some data')  // Store has autoSync: true, The database will succeed

'update' event fires (operation = 'edit')
'beforesync' event fires
network traffic occurs database returns a success (json)
'update' event fires (operation = 'commit') 
'onUpdateRecord' method runs

Scenerio 2
javascript executes
record.set('some data')  // Store has autoSync: true, The database will fail

'update' event fires (operation = 'edit')
'beforesync' event fires
network traffic occurs database returns a failure (json)
'onUpdateRecord' method runs and calls rejectChanges()
'update' event fires (operation = 'reject') 
'exception' event fires 
```

两个注意事项：a）最后一次更新和 onUpdateRecord 是相反的，b）如果 onUpdateRecord 没有调用 rejectChanges()，则不会触发以下 'update' 事件。这将使记录处于脏状态，这意味着后续的 sync() 将发送它。

对于 record.add() 事件是相似的，但是我看到 'add' 事件没有被触发。该事件的 Ext 文档说它被触发，但相同的文档没有说 add() 方法将触发该事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-04T06:11:50.050

解决这个问题的另一种方法是使用store`suspendAutoSync`的`resumeAutoSync`方法，然后手动`sync`（Ext JS > 4.1.0）：

```
store.suspendAutoSync();
store.insert(0, record);
store.sync({
   success: function (batch, options) {
      // do something
   },
   failure: function (batch, options){
      // handle error
   }
});
store.resumeAutoSync(); 
```

# webgl - ray 没有到达 JSON

> ID：11022621
> 
> 赞同：0
> 
> 时间：2012-06-13T20:13:39.660
> 
> 标签：webgl, three.js

我正在尝试使用鼠标单击事件捕获 JSON 对象。我使用射线来识别物体，但由于某种原因，物体并不总是被识别出来。我怀疑这与我移动相机有关，因为当我在对象附近单击时，我被识别出来了。

你能帮我弄清楚如何根据相机移动正确设置光线吗？

这是代码：

这是鼠标按下事件的一部分 *

```
 document.addEventListener("mousemove", onDocumentMouseMove, false);
    document.addEventListener("mouseup", onDocumentMouseUp, false);
    document.addEventListener("mouseout", onDocumentMouseOut, false);
    mouseXOnMouseDown = event.clientX - windowHalfX;
    targetRotationOnMouseDown = targetRotation;
    var ray, intersections;
    _vector.set((event.clientX / window.innerWidth) * 2 - 1, -(event.clientY / window.innerHeight) * 2 + 1, 0);
    projector.unprojectVector(_vector, camera);
    ray = new THREE.Ray(camera.position, _vector.subSelf(camera.position).normalize());
    intersections = ray.intersectObjects(furniture);

    if (intersections.length > 0) {
        selected_block = intersections[0].object;
        _vector.set(0, 0, 0);
        selected_block.setAngularFactor(_vector);
        selected_block.setAngularVelocity(_vector);
        selected_block.setLinearFactor(_vector);
        selected_block.setLinearVelocity(_vector);
        mouse_position.copy(intersections[0].point);
        block_offset.sub(selected_block.position, mouse_position);
        intersect_plane.position.y = mouse_position.y;
    } 
```

}

这是相机移动的一部分 *

```
camera.position.x = (Math.cos(timer) * 10);
camera.position.z = (Math.sin(timer) * 10);
camera.lookAt(scene.position); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T01:17:53.017

Hmmm, It is hard to say what your problem might be without seeing some kind of demonstration of how your program is actually acting. I would suggest looking at my demo that I have been working on today. I handle my camera, controls, and rays. I am using a JSON as well.

First you can view my demo: **[here](http://cmg0030.zxq.net/threejs/jsonDemo2)** to get an idea of what it is doing, what your describing sounds similar. You should be able to adapt my code if you can understand it.
--If you would like a direct link to the source code: **[main.js](http://cmg0030.zxq.net/threejs/jsonDemo2/main.js)**

I also have another you might find useful where I use rays and mouse collisions to **[spin a cube](http://cmg0030.zxq.net/threejs/acclDemo7)**.
--Source code: **[main.js](http://cmg0030.zxq.net/threejs/acclDemo7/main.js)**

Finally I'll post the guts of my mouse events and how I handle it with the trackball camera in the first demo, hopefully some of this will lead you to a solution:

```
/** Event fired when the mouse button is pressed down */
function onDocumentMouseDown(event) {
    event.preventDefault();

    /** Calculate mouse position and project vector through camera and mouse3D */
    mouse3D.x = mouse2D.x = (event.clientX / window.innerWidth) * 2 - 1;
    mouse3D.y = mouse2D.y = -(event.clientY / window.innerHeight) * 2 + 1;
    mouse3D.z = 0.5;
    projector.unprojectVector(mouse3D, camera);

    var ray = new THREE.Ray(camera.position, mouse3D.subSelf(camera.position).normalize());

    var intersects = ray.intersectObject(maskMesh);

    if (intersects.length > 0) {
        SELECTED = intersects[0].object;
        var intersects = ray.intersectObject(plane);
        offset.copy(intersects[0].point).subSelf(plane.position);
        killControls = true;
    }
    else if (controls.enabled == false)
        controls.enabled = true;
}

/** This event handler is only fired after the mouse down event and
    before the mouse up event and only when the mouse moves */
function onDocumentMouseMove(event) {
    event.preventDefault();

    /** Calculate mouse position and project through camera and mouse3D */
    mouse3D.x = mouse2D.x = (event.clientX / window.innerWidth) * 2 - 1;
    mouse3D.y = mouse2D.y = -(event.clientY / window.innerHeight) * 2 + 1;
    mouse3D.z = 0.5;
    projector.unprojectVector(mouse3D, camera);

    var ray = new THREE.Ray(camera.position, mouse3D.subSelf(camera.position).normalize());

    if (SELECTED) {
        var intersects = ray.intersectObject(plane);
        SELECTED.position.copy(intersects[0].point.subSelf(offset));
        killControls = true;
        return;
    }

    var intersects = ray.intersectObject(maskMesh);

    if (intersects.length > 0) {
        if (INTERSECTED != intersects[0].object) {
            INTERSECTED = intersects[0].object;
            INTERSECTED.currentHex = INTERSECTED.material.color.getHex();
            plane.position.copy(INTERSECTED.position);
        }
    }
    else {
        INTERSECTED = null;
    }
}

/** Removes event listeners when the mouse button is let go */
function onDocumentMouseUp(event) {
    event.preventDefault();
    if (INTERSECTED) {
        plane.position.copy(INTERSECTED.position);
        SELECTED = null;
        killControls = false;
    }

}

/** Removes event listeners if the mouse runs off the renderer */
function onDocumentMouseOut(event) {
    event.preventDefault();
    if (INTERSECTED) {
        plane.position.copy(INTERSECTED.position);
        SELECTED = null;
    }
} 
```

And in order to get the desired effect shown in my first demo that I wanted, I had to add this to my animation loop in order to use the killControls flag to selectively turn on and off the trackball camera controls based on the mouse collisions:

```
if (!killControls) controls.update(delta);
else controls.enabled = false; 
```

# c++ - FFMpeg 未定义对 get_buffer 的引用

> ID：11022625
> 
> 赞同：0
> 
> 时间：2012-06-13T20:13:58.323
> 
> 标签：c++, ffmpeg

我正在尝试升级与我们的一个项目一起使用的 FFMpeg 源，但 get_buffer 已经消失。我不能 100% 确定用哪种方法替换它。这是使用它的两种情况，感谢您的帮助。

希望能早日收到你的消息，

谢谢，凯文

```
 cur_offset = avio_tell(pb);
    if (!para->playctrl_info.read_end_flag && (0 == pkt->data_size)) {
        rev_byte = get_buffer(pb, pbuf, para->max_raw_size);
        if ((rev_byte > 0) && (cur_offset <= para->pFormatCtx->data_offset)) {
            try_count = 0;
            pkt->data_size = rev_byte;
            para->read_size.total_bytes += rev_byte;
            pkt->avpkt_newflag = 1;
            pkt->avpkt_isvalid = 1;

  do {
                read_length = get_buffer(s->pb, data + 12, read_size);
                if ((read_length <= 0) || (sync_flag == 1024)) {
                    if (read_length == AVERROR(EAGAIN)) {
                        continue;
                    } else {
                        FREE(data);
                        log_error("[%s]get data failed. ret=%d\n", __FUNCTION__, read_length);
                        return 0;
                    }
                } else {
                    break;
                }
            } while (retry_get_data < am_p->playctrl_info.read_max_retry_cnt);
            pkt = data; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T17:37:23.630

虽然您已经找到了答案，但如果其他人有同样的问题，我会提供答案。durandal_1707 在#ffmpeg-devel IRC 中为您提供了答案（我假设）：

> expresspotato：我在将最新版本的 ffmpeg 与大约一年半前的旧版本集成时遇到了麻烦。aviobuf.c 中定义的 get_buffer 似乎已经消失。你知道我应该用哪种方法代替它吗？
> 
> durandal_1707: in [e63a362857d9807b23e65872598d782fa53bb6af](http://git.videolan.org/?p=ffmpeg.git;a=commit;h=e63a362857d9807b23e65872598d782fa53bb6af) get_buffer have been renamed to avio_read

# jquery - Rails 3 - DIV 的定期刷新

> ID：11022627
> 
> 赞同：1
> 
> 时间：2012-06-13T20:14:02.687
> 
> 标签：jquery, ruby-on-rails-3, ujs

我正在尝试使用 AJAX/Unobtrusive JavaScript/JQuery 刷新 div 的内容。

如果我创建一个“刷新”链接并给它一个数据远程属性，这很容易做到。

但是，我想使用 setInterval 函数而不是使用链接每 2 秒刷新一次。

这段代码应该演示我正在尝试做的事情。放入 application.js 时它不起作用，因为没有评估 ERB，但希望它能解释我的目标。

```
 setInterval(function(){
    $("#scuttlebutt").html("<%= escape_javascript(render 'scuttlebutt') %>");
  },2000); 
```

在 Rails 3 中执行此操作的正确方法是什么？

（我正在使用 Rails 3.2.5）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T14:48:31.263

我最终将代码放在 application.js 中：

*   检查div是否存在
*   使用 setInterval 制作计时器
*   在当前 URL 处从 Rails 请求一个 js 脚本，这将导致评估 js.erb 视图文件。当这个文件运行时，它会更新我的 div。

看...

资产/javascripts/application.js

```
$(function() {

  if ($('#scuttlebutt').length) {
    setInterval(function(){
      $.getScript(window.location.pathname, function(data, textStatus, jqxhr) {
        console.log('Load was performed.');
      });
    },2000);
  }

}); 
```

意见/门票/show.js.erb

```
$("#scuttlebutt").html(" <%= escape_javascript(render 'scuttlebutt') %>" ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T21:15:26.030

好的，我明白你在做什么。我以前做过这个，我找到了一个简单的方法。

您仍然希望在控制器中调用远程方法的按钮，该控制器在浏览器中执行一些 javascript 以刷新该 DIV。我知道，我知道，你不想拥有它，但我在这里。我的页面上有一个，但我把它藏在一边，这样没人能找到它，链接这个：

```
:id => "refresh_button", :style => "position: absolute; left: -9999px" // Rails ERB notation 
```

然后，我将它添加到同一个文件中，我认为它是一个 .html.erb 文件。

```
<script type="text/javascript">
  function doSomething() {
    $('#refresh-button').click();
  }

  setInterval('doSomething()',2000);
</script> 
```

这将每 2 秒按下一次按钮，调用您的远程功能，就好像有人每两秒点击一次该按钮一样。我知道，这不是最干净的方法，但它在紧要关头工作得很好，直到你可以得到更强大的东西为你工作。虽然你可以在技术上使用它。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:20:42.080

看看[这个问题](https://stackoverflow.com/questions/4485856/json-rails-parse-error-in-javascirpt)。

它指出 .js 文件不像 .erb 文件那样被解析。它们按原样传递。

# javascript - 向下拉菜单添加超时不起作用

> ID：11022628
> 
> 赞同：1
> 
> 时间：2012-06-13T20:14:13.327
> 
> 标签：javascript, jquery, menu, slidedown, slideup

我在一个网站上工作，想修改下拉菜单项的当前代码。这是当前代码：

```
$(document).ready(function () { 

$('#nav li').hover(
    function () {
        //show its submenu
        $('ul', this).slideDown(300);

    }, 
    function () {
        //hide its submenu
        $('ul', this).slideUp(300);         
    }
);

}); 
```

我尝试更改代码以添加超时，目的是在用户将鼠标从菜单上移开时设置超时，以便菜单不会立即切换上滑效果。我想要的效果是，如果用户将鼠标从菜单上移开 200 毫秒，然后将其移回菜单，则它不会执行任何操作。所以菜单要等待 300-400 毫秒才能切换上滑功能。这是我编写的不起作用的代码。部分原因是`this`无论如何`$('ul', this).slideUp(250);`，这是我尝试实现的代码不起作用：

```
$(document).ready(function () { 
var timeoutID;
$('#nav li').hover(
    function () {
        //show its submenu
        $('ul', this).slideDown(250);
        window.clearTimeout(timeoutID);
        timeoutID = window.setTimeout(SlideUp, 350);
    },  
);
function SlideUp() {
    //hide its submenu
    $('ul', this).slideUp(250);         
}
}); 
```

**让程序等待切换上滑功能的最佳方法是什么？**任何想法表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:27:42.910

这就是你想做的。

```
$(document).ready(function () { 
  var timeout;
  $('#nav li').hover(function () {
    //show its submenu
    clearTimeout(timeout);
    $('ul', this).slideDown(300);
  }, function () {
    //hide its submenu
    var self = this;
    timeout = setTimeout(function(){
      $('ul', self).slideUp(300);         
    }, 300);
  });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:18:14.123

> jQuery.Deferred()，在 1.5 版本中引入，是一个可链接的实用程序对象，可以将多个回调注册到回调队列中，调用回调队列，并中继任何同步或异步函数的成功或失败状态。

看看[这个](http://api.jquery.com/category/deferred-object/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:50:19.723

不是您的具体问题的答案，但`transition-delay`如果可能的话，我会使用[fiddle](http://jsfiddle.net/Exj3w/1/)。

# javascript - 如何将表单元素与变量结合起来？

> ID：11022630
> 
> 赞同：1
> 
> 时间：2012-06-13T20:14:21.150
> 
> 标签：javascript

首先，如何在 Javascript 中将数据附加到变量的末尾？我知道您使用的 PHP：

```
$foo = "bar";
$foo.= "bar2"; 
```

接下来，我可以让以下内容适用于一个表单字段：

```
var test = document.form1.option1.value; 
```

但是，我将如何使用 for 循环执行此操作，同时将每次迭代附加到变量的末尾？例如（其中 XXX 是循环变量 i）：

```
for(i=0; i<10; i++){
    test.= document.form1.optionXXX.value;
} 
```

基本上，我需要一组随机表单字段中的所有数据，这些表单字段的范围可以从 option1 到 option20。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T20:29:48.197

尝试使用此表示法来避免`eval()`.

```
for(i=0; i<10; i++){
    test += document.form1['option' + i].value;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T20:22:52.160

```
var test = "";
for (var i=0; i<10; i++){
    test += document.form1["option" + i].value;
} 
```

# jboss - Dynamic Code Evolution Vm - 用于 Ejb Jar 部署

> ID：11022631
> 
> 赞同：0
> 
> 时间：2012-06-13T20:14:39.740
> 
> 标签：jboss, ejb, dcevm

我目前正在使用 Jboss 6.1 开发 EJB 3.0。在我更改 EJB 模块（服务器端）中的某些内容后，我必须将 JAR 文件导出到 /jboss-6.1.0.Final/server/default/deploy

这很不舒服。我知道 DCEVM 可以自动做到这一点。我刚刚安装了 Dynamic Code Evolution VM，但现在我不明白我现在应该做什么？Eclipse 需要任何 DCEVM 插件吗？

这是我的屏幕，我使用 Ubuntu 12.04：

[http://i.stack.imgur.com/ixcku.png](http://i.stack.imgur.com/ixcku.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T11:14:30.803

在这里您可以找到说明：

[http://blog.rafaelsanches.com/2012/02/02/spring-mvc-velocity-dcevm/](http://blog.rafaelsanches.com/2012/02/02/spring-mvc-velocity-dcevm/)

# python - Sphinx、gettext 和 html：如何创建多行翻译？

> ID：11022653
> 
> 赞同：2
> 
> 时间：2012-06-13T20:15:45.933
> 
> 标签：python, html, python-sphinx

我的项目文档（使用 Python 3.2）是用 Sphinx (1.1.3) 创建的，由 HTML 文件组成。我必须用英文和法文编写此文档；这就是我使用 Sphinx 和 gettext 构建文档的原因，使用通常的一堆 .po(t) 和 .mo 文件。

例如，我的 .po 文件由这样的行组成：

```
msgid "original text"
msgstr "translation" 
```

我的问题在于，如果某些翻译由几行组成，则相应的 HTML 文件会丢失“换行”字符：我的不同行被打包成一个大段落。我尝试了不同的东西，比如：

```
msgid "original text"
msgstr "translation : first line \n second line" 
```

当然，HTML 并不关心 \n 字符；\r 字符也有同样的问题。

然后我尝试了这个：

```
msgid "original text"
msgstr "translation : first line <br> second line" 
```

但我得到的只是类似的东西，`&lt;br&gt;`而不是预期的“换行符”。与`<br/>`.

我能做些什么 ？我很乐意帮助我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T13:11:33.973

好吧，感谢 ms4py，我能够回答我自己的问题：

*   如果您在此文件中使用“换行符”字符，请在每个 .rst 文件中添加以下行：

    .. |br| 原始:: html

然后添加一个空行，然后在新行上添加以下字符：“小于”和 br />。然后是一个新的空行。

*   在每个翻译中使用以下字符以便有一个换行符：`|br|` 前后有空格`|br|`。

谢谢 ！

# python - 带有可选占位符的 string.format()

> ID：11022655
> 
> 赞同：25
> 
> 时间：2012-06-13T20:15:48.947
> 
> 标签：python, string-formatting, template-variables

我有以下 Python 代码（我使用的是 Python 2.7.X）：

```
my_csv = '{first},{middle},{last}'
print( my_csv.format( first='John', last='Doe' ) ) 
```

我得到一个`KeyError`例外，因为没有指定“中间”（这是预期的）。但是，我希望所有这些占位符都是可选的。如果未指定这些命名参数，我希望删除占位符。所以上面打印的字符串应该是：

```
John,,Doe 
```

是否有内置功能可以使这些占位符成为可选，还是需要一些更深入的工作？如果是后者，如果有人可以向我展示最简单的解决方案，我将不胜感激！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-13T20:20:32.357

这是一种选择：

```
from collections import defaultdict

my_csv = '{d[first]},{d[middle]},{d[last]}'
print( my_csv.format( d=defaultdict(str, first='John', last='Doe') ) ) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-07-24T07:35:34.913

```
"It does{cond} contain the the thing.".format(cond="" if condition else " not") 
```

我想我会添加这个，因为自从提出问题以来它一直是一个功能，这个问题仍然在谷歌结果的早期弹出，并且这个方法直接内置在 python 语法中（不需要导入或自定义类）。这是一个简单的[快捷条件语句](https://mail.python.org/pipermail/python-dev/2005-September/056846.html)。它们读起来很直观（保持简单），而且它们[短路](https://en.wikipedia.org/wiki/Short-circuit_evaluation)通常很有帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-13T21:04:21.090

这是使用字符串插值运算符的另一个选项`%`：

```
class DataDict(dict):
    def __missing__(self, key):
        return ''

my_csv = '%(first)s,%(middle)s,%(last)s'
print my_csv % DataDict(first='John', last='Doe')  # John,,Doe 
```

或者，如果您更喜欢使用更现代的`str.format()`方法，以下方法也可以使用，但在某种意义上不太自动化，因为您将提前明确定义每个可能的占位符（尽管如果需要，您*可以*`DataDict.placeholders`即时修改）：

```
class DataDict(dict):
    placeholders = 'first', 'middle', 'last'
    default_value = ''
    def __init__(self, *args, **kwargs):
        self.update(dict.fromkeys(self.placeholders, self.default_value))
        dict.__init__(self, *args, **kwargs)

my_csv = '{first},{middle},{last}'
print(my_csv.format(**DataDict(first='John', last='Doe')))  # John,,Doe 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-06T17:26:56.203

我遇到了和你一样的问题，并决定创建一个库来解决这个问题：[pyformatting](https://pypi.org/project/pyformatting/)。
这是解决您的pyformatting问题的方法：

```
>>> from pyformatting import defaultformatter
>>> default_format = defaultformatter(str)
>>> my_csv = '{first},{middle},{last}'
>>> default_format(my_csv, first='John', last='Doe')
'John,,Doe' 
```

唯一的问题是 pyformatting 不支持 python 2。pyformatting 支持 python 3.1+ 如果我看到任何关于需要 2.7 支持的反馈，我想我会添加该支持。

# java - 复合对象如何与父对象通信？

> ID：11022661
> 
> 赞同：0
> 
> 时间：2012-06-13T20:16:03.933
> 
> 标签：java, oop, message, composition

我来自 C 系统编程背景，Java 编程对我来说是希腊语和拉丁语。

所以我的问题是：-我有 2 个`JFrame`对象

*   我有一个父对象 A
*   它有子对象 B。

对象 B 上有按钮。如果在 BI 中单击按钮，则希望更新父对象的 UI。

我怎样才能与父母沟通 - 更新自己？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T20:24:01.257

> 当值正在调整并且第二个 GUI 打开时，是否需要“实时”更新，或者它们可以延迟到它关闭吗？
> 
> > 他们可以延迟到关闭。

使用模态对话框或`JOptionPane`代替。

*   [如何制作对话框](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)
*   [如何在对话框中使用模态](http://docs.oracle.com/javase/tutorial/uiswing/misc/modality.html)

使用模式对话框，在设置为可见后立即出现的任何代码行都将被阻止处理，直到它被关闭。这是您检查（选项窗格的返回值和）您在对话框中放置的控件的值的地方。请注意，这里的想法是**不扩展对话框**。相反，只需在主代码中创建一个实例，创建控件，将它们添加到其中，并使用主框架作为父框架来显示它。

将“所有东西都放在一个类中”不是一个好的设计，也不是我的一般建议。只是这里没有什么理由让主 GUI*没有*对影响/更新它的控件的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:28:16.177

通常情况下，您有一个父 JFrame 对象，您可以在其中放置按钮、面板等小部件。您可以简单地使用按钮添加一个匿名操作侦听器，然后从其中调用父类的任何函数。

```
public class MyFrame extends JFrame{
  private Button button 2 = new Button();

  public void init(){
       b = new Button("Click me");
       b.addActionListener(new ActionListener(){
                                       public void actionPerformed(ActionEvent e) {
                                        //CALL ANY FUNCTION OF PARENT CLASS FROM HERE.
                                        updateText();
                                       }
                                      });
  }

    updateText(){
    this.button2.setText("new text");
  }
} 
```

您可以在此页面上找到有关它的更多信息[http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T06:25:32.717

我找到了另一种解决这个问题的方法。

我想它可以解决一般的委托问题。

父对象由子对象组成。父对象将此值传递给构造函数中的子对象。这样子可以调用父对象上的方法并通知任何更改。

在这种情况下，子框架调用父框架并要求父框架刷新自己。

# mod-rewrite - RewriteRule 保留查询字符串

> ID：11022663
> 
> 赞同：0
> 
> 时间：2012-06-13T20:16:04.590
> 
> 标签：mod-rewrite

我需要更改以下重写规则，以使其保留查询字符串（如果存在）并将其传递：

```
Options +FollowSymLinks
RewriteEngine on
RewriteCond %{HTTP_HOST} ^a.domain.com$ [NC]
RewriteRule ^(.*)$ http://b.domain.com/subdir/ [R=301,NC] 
```

你能帮我解决我需要对我的 RewriteRule 做些什么来传递任何现有的查询字符串吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:09:35.880

( `QSA`Query String Append) 标志应该可以解决问题。

[Mod_Rewrite 文档](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:15:27.550

查询字符串默认传递，它应该显示在您的重定向中。如果您`?`的规则目标中有 a （例如[http://b.domain.com/subdir/?something](http://b.domain.com/subdir/?something)），那么您需要一个`QSA`标志来附加传入的查询字符串。

如果在重定向时查询字符串没有附加到[http://b.domain.com/subdir/](http://b.domain.com/subdir/)，则可能是其他东西在剥离它们。

# c# - WCF 序列化服务器配置

> ID：11022668
> 
> 赞同：0
> 
> 时间：2012-06-13T20:16:15.400
> 
> 标签：c#, wcf

我有以下服务合同：

```
[ServiceContract(Namespace = "http://WebAdmin.Services.AdministrativeService", Name = "AdministrativeService")]
public interface IAdministrativeService
{
    /// <summary>
    /// Add the group based on the provided criteria 
    /// </summary>
    /// <example>
    /// <code>
    ///     service.AddWebGroup
    ///             (new User   {
    ///                             SequenceNumber = 1,
    ///                         },
    ///              new Group 
    ///                         {
    ///                             GroupName = "Example Group"
    ///                         },
    ///             new Application
    ///                         { 
    ///                             ApplicationCode = "DS"
    ///                         }
    ///             );
    /// </code>
    /// </example>
    /// <param name="webUser"><see cref="WebUser"/>The user a</param>
    /// <param name="group"><see cref="Group"/></param>
    /// <param name="application"><see cref="Application"/></param>
    /// <returns><see cref="Group"/></returns>
    [OperationContract]
    [TransactionFlow(TransactionFlowOption.Mandatory)]
    [FaultContract(typeof(ErrorFault))]
    [PrincipalPermission(SecurityAction.Demand, Role = "WEB_ADMIN_SVC")]
    Group AddWebGroup(WebUser webUser, Group group, Application application);

} 
```

使用以下数据合同：

```
[DataContract]
public class WebUser
{
    [DataMember]
    public long? SequenceNumber { get; set; }

    [DataMember]
    public List<UserRole> Roles { get; set; }
}

    [DataContract]
public class UserRole
{
    [DataMember]
    public long? RoleID { get; set; }
    [DataMember]
    public string Name { get; set; }
    [DataMember]
    public Application Application { get; set; }
    [DataMember]
    public Group Group { get; set; }
}
{
[DataContract]
public class Application
{
    [DataMember]
    public string ApplicationCode { get; set; }
    [DataMember]
    public string ApplicationName { get; set; }
    [DataMember]
    public string ContactEmailAddress { get; set; }
    [DataMember]
    public string DivisionCode { get; set; }
}
[DataContract]
public class Group
{
    [DataMember]
    public long? GroupID { get; set; }
    [DataMember]
    public string GroupName { get; set; }
} 
```

通过以下实现：

```
 [ServiceBehavior(
ConcurrencyMode = ConcurrencyMode.Single,
InstanceContextMode = InstanceContextMode.PerSession,
ReleaseServiceInstanceOnTransactionComplete = false,
TransactionIsolationLevel = System.Transactions.IsolationLevel.Serializable
)]
public class AdministrativeService : ServiceBase, IAdministrativeService
{
    #region Implementation of IAdministrativeService

    /// <summary>
    /// Add the group based on the provided criteria 
    /// </summary>
    /// <example>
    /// <code>
    ///     service.AddWebGroup
    ///             (new User   {
    ///                             SequenceNumber = 1,
    ///                         },
    ///              new Group 
    ///                         {
    ///                             GroupName = "Example Group"
    ///                         },
    ///             new Application
    ///                         { 
    ///                             ApplicationCode = "DS"
    ///                         }
    ///             );
    /// </code>
    /// </example>
    /// <param name="webUser"><see cref="WebUser"/>The user adding the group</param>
    /// <param name="group"><see cref="Group"/>The Group being added</param>
    /// <param name="application"><see cref="Application"/>The associated application</param>
    /// <returns><see cref="Group"/> With the ID set</returns>
    [OperationBehavior(TransactionAutoComplete = true, TransactionScopeRequired = true)]
    public Group AddWebGroup(WebUser webUser, Group group, Application application)
    {
        if (webUser == null)
            throw new ArgumentException("user");
        if (webUser.SequenceNumber == long.MinValue)
            throw new ArgumentException("user sequence number");

        if (group == null || string.IsNullOrWhiteSpace(group.GroupName))
            throw new ArgumentNullException("group");
       if (application == null || string.IsNullOrWhiteSpace(application.ApplicationCode))
            throw new ArgumentException("application");

        var service = Resolve<IWebGroupService>();

        var criteria = new GroupCriteriaEntity
                           {
                               ApplicationCode = application.ApplicationCode,
                               Group = new GroupEntity{GroupName = group.GroupName,},
                               User = new UserEntity{SequenceNumber = webUser.SequenceNumber,}
                           };
        GroupEntity result = null;
        try
        {
            result = service.InsertWebGroup(criteria);
        }
        catch (Exception ex)
        {
            ex.Data.Add("result",criteria);
            ExceptionPolicy.HandleException(ex, "Service Policy");
        }
        var groupResult = new Group
        {
            GroupID = result.SequenceNumber
        };

        return groupResult;

    } 
```

服务模型绑定正在使用带有 TransportMessageCredential 的 wsHttpBinding ...

所有这些优秀的东西都可以在开发环境中使用。事务按预期提交和回滚。用户凭证允许和阻止用户执行代码，总而言之，每个人都很高兴。

测试环境应该是与开发环境相同的设置。但是，当代理客户端调用服务时，出现以下异常：

> 处理实例ID：44a7c5ae-17fc-4d14-b55e-1aa53bb156e0
> 
> ## 发生并捕获了“System.ArgumentException”类型的异常。

2012 年 6 月 13 日 15:39:11 类型：System.ArgumentException，mscorlib，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089 消息：传入的参数不可序列化。参数名称：值源：mscorlib 帮助链接：ParamName：值数据：System.Collections.ListDictionaryInternal TargetSite：Void Add(System.Object, System.Object) 堆栈跟踪：在 System.Collections.ListDictionaryInternal.Add(Object key, Object value ) 在Administrative.Service.AdministrativeService.AddWebGroup(WebUser webUser, Group group, Application application) 在 SyncInvokeAddWebGroup(Object , Object[] , Object[] ) 在 System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] 输入, Object[]& 输出) 在 System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc& rpc) 在 System.ServiceModel。

关于为什么这会发生在一台机器上而不是另一台机器上的任何想法？当传递的所有对象都是代理客户端中生成的对象并带有 DataContract 标记时，为什么我会收到一个错误，即我正在传递一个不可序列化的对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:33:12.290

看起来异常发生在您执行以下操作的异常处理程序中：`ex.Data.Add("result",criteria);`，但我没有在定义 GroupCriteriaEntity 的数据合约（您展示的那些）中看到，那也是可序列化的吗？

# java - 批处理编号的 Java 算法

> ID：11022670
> 
> 赞同：-9
> 
> 时间：2012-06-13T20:16:29.393
> 
> 标签：java, algorithm, discrete-mathematics

我有一点不寻常的问题要解决。我需要一些提示或链接才能开始。我有 10 个数据槽的队列。一旦队列已满，我需要将其发送到服务器。但是，连同该数据，我还发送开始和结束序列号。现在，这个数字必须是唯一的并且按递增顺序排列。因此，对于第一次发送，start = 1，end = 10。在第二次发送时，它将是 start = 11，end = 20，依此类推。发送队列中的数据后，将从队列中的索引 0 开始记录新条目。

我如何有效地解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:15:09.810

*（您的问题缺少很多上下文，所以这主要是在黑暗中拍摄......）*

由于任何 16 位数字都可以放入 Java`int`原语中，因此您可以：

*   `int`通过使用合适的位掩码对数字进行与运算，将 Java 转换为 16 位数字：

    ```
    i16 = i32 & 0xffff 
    ```

    警告：这种转换是有损的，不容易逆转。

*   将 16 位数字转换为 32 位，方法`int`是保留一个单独的*epoch* `int`，每次翻转时递增 1：

    ```
    if (previous16 > current16)
        epoch += 1;

    current32 = (epoch << 16) | current16; 
    ```

    我认为它不会比 Java更*有效。*更不用说任何可以运行 Java 的 CPU 通常都会围绕任何 16 位处理器运行，也许除了一些 DSP 之外......

几个相关的问题：

*   注意有符号/无符号转换：Java 没有无符号类型，这可能会使事情复杂化，具体取决于您正在做什么。

*   请注意，根据 JLS，`byte`所有操作都隐式转换为`char`和原始类型。当存储在内存中时，它们是否实际上比 32 位更窄是特定于实现的。是的，这使得类型几乎没用......`short``int``short`

# java - 我想恢复我的 MAC os 10.7.4 的默认 java CLASSPATH

> ID：11022672
> 
> 赞同：0
> 
> 时间：2012-06-13T20:16:36.213
> 
> 标签：java, macos, classpath

我已经多次询问 www.google.com 但我似乎无法弄清楚如何将其恢复为默认值..

我现在不能简单地编译和运行java文件..

```
romel$ java test.java 
Exception in thread "main" java.lang.NoClassDefFoundError: test/java
Caused by: java.lang.ClassNotFoundException: test.java
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:24:19.417

您的测试类在哪个包中？

假设您没有指定要运行的命令的包，则为`java test`. 通过运行“test.java”，它在名为“test”的包（目录）中寻找名为“java”的类。

例如：

**测试.java**

```
class test {
    public static void main(String[] args) {
        System.out.println("Hello World");
    }
} 
```

* * *

```
$ javac test.java
$ java test
Hello World 
```

* * *

系统类路径位于`/System/Library/Java/JavaConfig.plist`. 默认值为：

```
<key>DefaultClasspath</key>
    <string>$HOME/Library/Java:$NEXT_ROOT/Library/Java:$NEXT_ROOT/System/Library/Java:$NEXT_ROOT/Network/Library/Java:$NEXT_ROOT/System/Library/Frameworks/JavaVM.framework/Classes/classes.jar:$NEXT_ROOT/System/Library/Frameworks/JavaVM.framework/Classes/ui.jar</string> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-13T20:26:24.710

试试这个，

```
java test 
```

并且您的班级名称必须大写第一个单词，如下所示`Test`

# javascript - 在 iPad 版网络应用程序中使用 Google 地图

> ID：11022674
> 
> 赞同：0
> 
> 时间：2012-06-13T20:16:39.177
> 
> 标签：javascript, ipad, google-maps-api-3

是否有一种特殊的方法可以在 HTML 中为移动网络应用程序调用 Google Maps API？

我目前以标准方式调用它们..即

```
 <%= javascript_include_tag "http://maps.google.com/maps/api/js?sensor=false" %>
lat = 53.80620266482967
lng = -3.205146811523491
latlng = new google.maps.LatLng(lat, lng)
options =
  zoom: 6

  center: latlng
  mapTypeId: 'OSM'
  panControlOptions:
     position: google.maps.ControlPosition.TOP_RIGHT
  zoomControlOptions:
    position: google.maps.ControlPosition.TOP_RIGHT
  mapTypeControlOptions:
    mapTypeIds: ['CloudMade', 'OSM', google.maps.MapTypeId.ROADMAP]
    style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
    position: google.maps.ControlPosition.TOP_RIGHT
@gMap = new google.maps.Map(document.getElementById("map"), options)
@gMap.mapTypes.set('OSM', osmMapType)
@gMap.mapTypes.set('CloudMade', cloudMadeMapType)
@gMap.setMapTypeId(cloudMadeMapType) 
```

但是它们看起来有点慢而且非常颠簸，不如原生应用程序流畅……以前有人这样做过。我想让它们尽可能顺利。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T14:44:15.000

无论您使用标准方式还是任何其他方式都没关系 - 地图无论如何都会显示在几乎任何设备（包括 iPad）上，但它很可能会“颠簸”和“缓慢”。毕竟，您是在 Web 浏览器中运行它。

但是，有一些特殊的**jQuery**插件可用于为移动设备开发**Google 地图**应用程序（例如[jquery-ui-map](http://code.google.com/p/jquery-ui-map/)）。

# r - 在 R 中旋转直方图或在条形图中覆盖密度

> ID：11022675
> 
> 赞同：12
> 
> 时间：2012-06-13T20:16:39.807
> 
> 标签：r

我想旋转 R 中的直方图，由 hist() 绘制。这个问题并不新鲜，在几个论坛中我发现这是不可能的。然而，所有这些答案都可以追溯到 2010 年甚至更晚。

有没有人同时找到解决方案？

解决此问题的一种方法是通过提供选项“horiz=TRUE”的 barplot() 绘制直方图。该图工作正常，但我未能在条形图中覆盖密度。问题可能出在 x 轴上，因为在垂直图中，密度位于第一个 bin 的中心，而在水平图中，密度曲线混乱。

很感谢任何形式的帮助！

谢谢，

尼尔斯

代码：

```
require(MASS)
Sigma <- matrix(c(2.25, 0.8, 0.8, 1), 2, 2)
mvnorm <- mvrnorm(1000, c(0,0), Sigma)

scatterHist.Norm <- function(x,y) {
 zones <- matrix(c(2,0,1,3), ncol=2, byrow=TRUE)
 layout(zones, widths=c(2/3,1/3), heights=c(1/3,2/3))
 xrange <- range(x) ; yrange <- range(y)
 par(mar=c(3,3,1,1))
 plot(x, y, xlim=xrange, ylim=yrange, xlab="", ylab="", cex=0.5)
 xhist <- hist(x, plot=FALSE, breaks=seq(from=min(x), to=max(x), length.out=20))
 yhist <- hist(y, plot=FALSE, breaks=seq(from=min(y), to=max(y), length.out=20))
 top <- max(c(xhist$counts, yhist$counts))
 par(mar=c(0,3,1,1))
 plot(xhist, axes=FALSE, ylim=c(0,top), main="", col="grey")
 x.xfit <- seq(min(x),max(x),length.out=40)
 x.yfit <- dnorm(x.xfit,mean=mean(x),sd=sd(x))
 x.yfit <- x.yfit*diff(xhist$mids[1:2])*length(x)
 lines(x.xfit, x.yfit, col="red")
 par(mar=c(0,3,1,1))
 plot(yhist, axes=FALSE, ylim=c(0,top), main="", col="grey", horiz=TRUE)
 y.xfit <- seq(min(x),max(x),length.out=40)
 y.yfit <- dnorm(y.xfit,mean=mean(x),sd=sd(x))
 y.yfit <- y.yfit*diff(yhist$mids[1:2])*length(x)
 lines(y.xfit, y.yfit, col="red")
}
scatterHist.Norm(mvnorm[,1], mvnorm[,2])

scatterBar.Norm <- function(x,y) {
 zones <- matrix(c(2,0,1,3), ncol=2, byrow=TRUE)
 layout(zones, widths=c(2/3,1/3), heights=c(1/3,2/3))
 xrange <- range(x) ; yrange <- range(y)
 par(mar=c(3,3,1,1))
 plot(x, y, xlim=xrange, ylim=yrange, xlab="", ylab="", cex=0.5)
 xhist <- hist(x, plot=FALSE, breaks=seq(from=min(x), to=max(x), length.out=20))
 yhist <- hist(y, plot=FALSE, breaks=seq(from=min(y), to=max(y), length.out=20))
 top <- max(c(xhist$counts, yhist$counts))
 par(mar=c(0,3,1,1))
 barplot(xhist$counts, axes=FALSE, ylim=c(0, top), space=0)
 x.xfit <- seq(min(x),max(x),length.out=40)
 x.yfit <- dnorm(x.xfit,mean=mean(x),sd=sd(x))
 x.yfit <- x.yfit*diff(xhist$mids[1:2])*length(x)
 lines(x.xfit, x.yfit, col="red")
 par(mar=c(3,0,1,1))
 barplot(yhist$counts, axes=FALSE, xlim=c(0, top), space=0, horiz=TRUE)
 y.xfit <- seq(min(x),max(x),length.out=40)
 y.yfit <- dnorm(y.xfit,mean=mean(x),sd=sd(x))
 y.yfit <- y.yfit*diff(yhist$mids[1:2])*length(x)
 lines(y.xfit, y.yfit, col="red")
}
scatterBar.Norm(mvnorm[,1], mvnorm[,2]) 
```

#

带有边缘直方图的散点图来源（点击“改编自...”后的第一个链接）：

[http://r.789695.n4.nabble.com/newbie-scatterplot-with-marginal-histograms-done-and-axes-labels-td872589.html](http://r.789695.n4.nabble.com/newbie-scatterplot-with-marginal-histograms-done-and-axes-labels-td872589.html)

散点图中的密度来源：

[http://www.statmethods.net/graphs/density.html](http://www.statmethods.net/graphs/density.html)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-20T07:17:08.353

```
scatterBarNorm <- function(x, dcol="blue", lhist=20, num.dnorm=5*lhist, ...){
    ## check input
    stopifnot(ncol(x)==2)
    ## set up layout and graphical parameters
    layMat <- matrix(c(2,0,1,3), ncol=2, byrow=TRUE)
    layout(layMat, widths=c(5/7, 2/7), heights=c(2/7, 5/7))
    ospc <- 0.5 # outer space
    pext <- 4 # par extension down and to the left
    bspc <- 1 # space between scatter plot and bar plots
    par. <- par(mar=c(pext, pext, bspc, bspc),
                oma=rep(ospc, 4)) # plot parameters
    ## scatter plot
    plot(x, xlim=range(x[,1]), ylim=range(x[,2]), ...)
    ## 3) determine barplot and height parameter
    ## histogram (for barplot-ting the density)
    xhist <- hist(x[,1], plot=FALSE, breaks=seq(from=min(x[,1]), to=max(x[,1]),
                                     length.out=lhist))
    yhist <- hist(x[,2], plot=FALSE, breaks=seq(from=min(x[,2]), to=max(x[,2]),
                                     length.out=lhist)) # note: this uses probability=TRUE
    ## determine the plot range and all the things needed for the barplots and lines
    xx <- seq(min(x[,1]), max(x[,1]), length.out=num.dnorm) # evaluation points for the overlaid density
    xy <- dnorm(xx, mean=mean(x[,1]), sd=sd(x[,1])) # density points
    yx <- seq(min(x[,2]), max(x[,2]), length.out=num.dnorm)
    yy <- dnorm(yx, mean=mean(x[,2]), sd=sd(x[,2]))
    ## barplot and line for x (top)
    par(mar=c(0, pext, 0, 0))
    barplot(xhist$density, axes=FALSE, ylim=c(0, max(xhist$density, xy)),
            space=0) # barplot
    lines(seq(from=0, to=lhist-1, length.out=num.dnorm), xy, col=dcol) # line
    ## barplot and line for y (right)
    par(mar=c(pext, 0, 0, 0))
    barplot(yhist$density, axes=FALSE, xlim=c(0, max(yhist$density, yy)),
            space=0, horiz=TRUE) # barplot
    lines(yy, seq(from=0, to=lhist-1, length.out=num.dnorm), col=dcol) # line
    ## restore parameters
    par(par.)
}

require(mvtnorm)
X <- rmvnorm(1000, c(0,0), matrix(c(1, 0.8, 0.8, 1), 2, 2))
scatterBarNorm(X, xlab=expression(italic(X[1])), ylab=expression(italic(X[2]))) 
```

![在此处输入图像描述](../Images/3c4b498aba82fe7ee10c77242252099e.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-14T03:42:11.330

知道该`hist()`函数以不可见的方式返回使用更简单的绘图函数（例如`rect()`.

```
 vals <- rnorm(10)
    A <- hist(vals)
    A
    $breaks
    [1] -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5

    $counts
    [1] 1 3 3 1 1 1

    $intensities
    [1] 0.2 0.6 0.6 0.2 0.2 0.2

    $density
    [1] 0.2 0.6 0.6 0.2 0.2 0.2

    $mids
    [1] -1.25 -0.75 -0.25  0.25  0.75  1.25

    $xname
    [1] "vals"

    $equidist
    [1] TRUE

    attr(,"class")
    [1] "histogram" 
```

您可以像这样手动创建相同的直方图：

```
 plot(NULL, type = "n", ylim = c(0,max(A$counts)), xlim = c(range(A$breaks)))
    rect(A$breaks[1:(length(A$breaks) - 1)], 0, A$breaks[2:length(A$breaks)], A$counts) 
```

使用这些部件，您可以随意翻转轴：

```
 plot(NULL, type = "n", xlim = c(0, max(A$counts)), ylim = c(range(A$breaks)))
    rect(0, A$breaks[1:(length(A$breaks) - 1)], A$counts, A$breaks[2:length(A$breaks)]) 
```

对于类似的自己动手`density()`，请参阅： [R 直方图和密度图中的轴标记；密度图的多重叠加](https://stackoverflow.com/questions/9246040/axis-labeling-in-r-histogram-and-density-plots-multiple-overlays-of-density-plo)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-09T09:55:12.700

我不确定它是否感兴趣，但我有时想使用没有任何包的水平直方图，并且能够在图形的任何位置书写或绘图。

这就是我编写以下函数的原因，下面提供了示例。如果有人知道适合的包，请写信给我：gmx.de 的 berry-b

请确保您的工作区中没有变量 hpos，因为它会被函数覆盖。（是的，对于一个包，我需要在函数中插入一些安全部件）。

```
horiz.hist <- function(Data, breaks="Sturges", col="transparent", las=1, 
ylim=range(HBreaks), labelat=pretty(ylim), labels=labelat, border=par("fg"), ... )
  {a <- hist(Data, plot=FALSE, breaks=breaks)
  HBreaks <- a$breaks
  HBreak1 <- a$breaks[1]
  hpos <<- function(Pos) (Pos-HBreak1)*(length(HBreaks)-1)/ diff(range(HBreaks))
  barplot(a$counts, space=0, horiz=T, ylim=hpos(ylim), col=col, border=border,...)      
  axis(2, at=hpos(labelat), labels=labels, las=las, ...) 
  print("use hpos() to address y-coordinates") } 
```

举些例子

```
# Data and basic concept
set.seed(8); ExampleData <- rnorm(50,8,5)+5
hist(ExampleData)
horiz.hist(ExampleData, xlab="absolute frequency") 
# Caution: the labels at the y-axis are not the real coordinates!
# abline(h=2) will draw above the second bar, not at the label value 2\. Use hpos:
abline(h=hpos(11), col=2)

# Further arguments
horiz.hist(ExampleData, xlim=c(-8,20)) 
horiz.hist(ExampleData, main="the ... argument worked!", col.axis=3) 
hist(ExampleData, xlim=c(-10,40)) # with xlim
horiz.hist(ExampleData, ylim=c(-10,40), border="red") # with ylim
horiz.hist(ExampleData, breaks=20, col="orange")
axis(2, hpos(0:10), labels=F, col=2) # another use of hpos() 
```

一个缺点：该函数不适用于作为具有不同条形宽度的向量提供的断点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-19T21:46:48.680

谢谢蒂姆和保罗。您让我更加努力地思考并使用 hist() 实际提供的功能。

这是我现在的解决方案（在 Alex Pl. 的大力帮助下）：

```
scatterBar.Norm <- function(x,y) {
 zones <- matrix(c(2,0,1,3), ncol=2, byrow=TRUE)
 layout(zones, widths=c(5/7,2/7), heights=c(2/7,5/7))
 xrange <- range(x)
 yrange <- range(y)
 par(mar=c(3,3,1,1))
 plot(x, y, xlim=xrange, ylim=yrange, xlab="", ylab="", cex=0.5)
 xhist <- hist(x, plot=FALSE, breaks=seq(from=min(x), to=max(x), length.out=20))
 yhist <- hist(y, plot=FALSE, breaks=seq(from=min(y), to=max(y), length.out=20))
 top <- max(c(xhist$density, yhist$density))
 par(mar=c(0,3,1,1))
 barplot(xhist$density, axes=FALSE, ylim=c(0, top), space=0)
 x.xfit <- seq(min(x),max(x),length.out=40)
 x.yfit <- dnorm(x.xfit, mean=mean(x), sd=sd(x))
 x.xscalefactor <- x.xfit / seq(from=0, to=19, length.out=40)
 lines(x.xfit/x.xscalefactor, x.yfit, col="red")
 par(mar=c(3,0,1,1))
 barplot(yhist$density, axes=FALSE, xlim=c(0, top), space=0, horiz=TRUE)
 y.xfit <- seq(min(y),max(y),length.out=40)
 y.yfit <- dnorm(y.xfit, mean=mean(y), sd=sd(y))
 y.xscalefactor <- y.xfit / seq(from=0, to=19, length.out=40)
 lines(y.yfit, y.xfit/y.xscalefactor, col="red")
} 
```

举些例子：

```
require(MASS)
#Sigma <- matrix(c(2.25, 0.8, 0.8, 1), 2, 2)
Sigma <- matrix(c(1, 0.8, 0.8, 1), 2, 2)
mvnorm <- mvrnorm(1000, c(0,0), Sigma) ; scatterBar.Norm(mvnorm[,1], mvnorm[,2]) 
```

不对称的 Sigma 会导致相应轴的直方图更加庞大。

为了增加可理解性，代码被故意留下“不雅”（对于我自己，当我稍后重新访问它时......）。

尼尔斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T21:25:46.103

使用 ggplot 时，翻转轴效果很好。例如，参见[这个例子](http://wiki.stdout.org/rcookbook/Graphs/Axes%20%28ggplot2%29/)，它展示了如何为箱线图执行此操作，但它对于我假设的直方图同样适用。在 ggplot 中，可以很容易地覆盖不同的绘图类型或 ggplot2 行话中的几何图形。所以结合密度图和直方图应该很容易。

# objective-c - SQLite 中的响应时间限制

> ID：11022681
> 
> 赞同：0
> 
> 时间：2012-06-13T20:17:13.957
> 
> 标签：objective-c, ios, performance, sqlite

有没有办法限制 SQLite 的响应时间？

我有 SQL 请求，执行时间为 0 到 10 秒，具体取决于设备性能。此 SQL 是可选的。如果请求时间超过 3 秒，它应该被终止。如果我能先验地知道它需要超过 3 秒，我宁愿不要运行这个 SQL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T06:56:19.913

使用[`sqlite3_progress_handler`](http://www.sqlite.org/c3ref/progress_handler.html)接口注册回调函数。

正如@JeremyP 建议的那样，您可以传入一个指向 的指针`NSDate`，或者将其他存储时间的东西作为上下文进行比较。如果它达到某个阈值以上，则从使用此函数注册的回调中返回一个非零值以终止操作。

```
int progressHandler(void *context) {
    NSDate *start = (NSDate *)context;
    NSTimeInterval wait = -[start timeIntervalSinceNow];

    if (wait > 3.0) {
        return 1;
    } else {
        return 0;
    }
} 
```

此函数的第二个参数是调用回调的频率。该值以执行的跳转操作码数为单位，并且会因机器而异。就上下文而言，在我的 Macbook 上，它每秒处理大约 2000 万个操作码。您的用例的一个不错的数字可能是 10K-100K。

```
sqlite3_progress_handler(db, 100000, &progressHandler, (void *)someDate); 
```

# c# - 使用 C# 在网页上的文本框中突出显示文本

> ID：11022688
> 
> 赞同：0
> 
> 时间：2012-06-13T20:17:29.847
> 
> 标签：c#, textbox

无论如何使用C#在网页上的文本框中突出显示初始文本？我知道如何在 Windows 窗体上执行此操作，但我找不到任何有关如何在网页上执行此操作的示例。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:20:58.473

你可以用[javascript](https://developer.mozilla.org/en/DOM/Input.select)做到这一点。

```
document.getElementById('textbox-id').select(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:21:35.633

我的建议是使用 javascript。例子：

```
document.getElementById('test').focus();
document.getElementById('test').select(); 
```

如果您愿意，可以从代码隐藏中执行此操作并从那里注册脚本。

在这个问题中已经讨论过：[Add JavaScript reference from code behind (C#)](https://stackoverflow.com/questions/3701534/add-javascript-reference-from-code-behind-c)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:22:11.577

你需要在客户端做，所以你应该使用javascript。如果您使用的是 jquery，您可以执行以下操作：

```
$("#myTextBox").select(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T20:35:13.380

你不能使用 C# 来做到这一点。网站不像 Windows 窗体，但您可以使用 Javascript 来实现。你应该看看[jQuery](http://jquery.com/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T21:19:43.077

之前给出的答案应该可以满足您的需求。但是如果你想使用服务器端 c# 编码，你可以在你的`Page_Load`函数中使用这些行：

```
 TextBox1.Text = "This Is the initial text";

    TextBox1.ForeColor = System.Drawing.Color.Blue; 
```

这将产生突出显示初始文本的错觉。

# wordpress - 多个 Wordpress 子主题

> ID：11022690
> 
> 赞同：1
> 
> 时间：2012-06-13T20:17:42.973
> 
> 标签：wordpress

我有一个快速的问题：

是否可以同时激活多个子主题？我需要一次激活许多不同的页面模板。如果不可能，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:57:57.783

从来没听说过。但是，您可以设置自定义页面布局，如果您需要以不同方式定义它们（例如每个背景不同），请使用自定义字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:18:20.950

要激活多个主题/子主题，您根本不能。但是您可以仅使用一个主题向访问者显示不同的布局。一次激活许多不同的模板是什么意思？您是指页面将如何显示？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:32:09.207

我不认为这是可能的。您可以做的是根据您的需要编写不同的样式表。您可以在 php 代码中管理它们，甚至可以轻松地在 javascript 中切换它们。

# jquery - Drupal 7 jQuery 问题

> ID：11022693
> 
> 赞同：0
> 
> 时间：2012-06-13T20:17:45.487
> 
> 标签：jquery, drupal-7

我知道 Drupal 7 jQuery 代码需要以一种允许其他使用**$**表示法的库工作的方式进行包装。我已经解释了这一点，如下面的代码所示：

```
(function($){
    alert('working');
    console.log('working');
    jQuery('#logo').hide();
    $('table#nodesequence_nodes').click(
        function(){
            console.log('still working');
        }
    );
})(jQuery); 
```

奇怪的是，我对**$**和**jQuery**的调用不起作用。例如，隐藏**#logo**的代码在表格点击代码中不起作用。它们不会产生错误……它们只是完全没有反应。

alert 和 console.log 代码示例确实有效。

我的 jQuery 和我的 JavaScript 文件都根据 firebug 成功加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:50:32.810

我认为这可能是因为尚未加载所有 HTML。您应该尝试使用 Drupal 规定的运行脚本的方式。转到此页面并向下滚动到标题为“行为”的部分：[drupal.org/node/756722](http://drupal.org/node/756722)

# c# - 实现 WCF IErrorHandler 仅用于日志记录

> ID：11022694
> 
> 赞同：7
> 
> 时间：2012-06-13T20:17:54.590
> 
> 标签：c#, .net, wcf, ierrorhandler

可能是微不足道的问题.. 我想实现自己的错误处理程序来记录错误并监视正在发生的事情。在这一点上，我不想向客户提供我自己的错误。我希望它是透明的——就像默认的 WCF 行为一样。我应该如何实施`ProvideFault`来实现这一目标？

```
namespace IDATT.Web.Services
{
    using System;
    using System.ServiceModel.Channels;
    using System.ServiceModel.Dispatcher;

    public class MyServiceErrorHandler : IErrorHandler 
    {
        public void ProvideFault(Exception error, MessageVersion version, ref Message fault)
        {
            // ????
        }

        public bool HandleError(Exception error)
        {
            return true;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T20:24:59.390

~~您可以将其留空。我这样做是为了毫无问题地将错误记录到 Elmah。~~

**编辑**

我完全错了。查看我的实现后，我执行以下操作。如您所见，`HandleError`该方法基本上是空的，并且日志记录发生在`ProvideFault`.

```
public class ElmahErrorHandler : IErrorHandler
{
    public bool HandleError(Exception error)
    {
        return false;
    }

    public void ProvideFault(Exception error, MessageVersion version, ref Message fault)
    {
        if (error == null)
        {
            return;
        }

        ErrorSignal.FromCurrentContext().Raise(error);
    }
} 
```

返回`true`会使`HandleError`WCF 认为没有发生错误。这意味着如果你只是记录错误，这应该总是返回`false`。如果错误未得到处理，`ProvideFault`则调用，这是您要进行日志记录的地方。您无需提供故障消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-07T01:05:16.433

从文档（[http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)）：

> 实现 HandleError 方法以确保与错误相关的行为，包括错误记录、确保快速失败、关闭应用程序等。

上面的链接还指出，在将响应发送回客户端*后，只会调用 HandleError 。*所以请善待您的客户（不要让他们在您登录时等待），将 ProvideFault 留空并在 HandleError 中执行日志记录操作。

# objective-c - Objective-C 中未声明的方法

> ID：11022696
> 
> 赞同：0
> 
> 时间：2012-06-13T20:17:59.487
> 
> 标签：objective-c, methods, private, setter, public

```
#import "PsychologistViewController.h"
#import "HappinessViewController.h"

@interface PsychologistViewController()
@property (nonatomic) int diagnosis;
@end

@implementation PsychologistViewController

@synthesize diagnosis = _diagnosis;

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender

{
       if ([segue.identifier isEqualToString:@"ShowDiagnosis"]) {
        [segue.destinationViewController setHappiness:self.diagnosis];
       } 
       else if ([segue.identifier isEqualToString:@"Celebrity"]) {
        [segue.destinationViewController setHappiness:100];
       } 
       else if ([segue.identifier isEqualToString:@"Serious"]) {
        [segue.destinationViewController setHappiness:20];
       } 
       else if ([segue.identifier isEqualToString:@"TV Kook"]) {
        [segue.destinationViewController setHappiness:50];
       }
}

****- (void)setAndShowDiagnosis:(int)diagnosis****
{
    self.diagnosis = diagnosis;
    [self performSegueWithIdentifier:@"ShowDiagnosis" sender:self];
}

-(IBAction)flying
{
    [self setAndShowDiagnosis:85];
}

-(IBAction)apple 
{    
[self setAndShowDiagnosis:100];
}

-(IBAction)dragons
{
    [self setAndShowDiagnosis:20];
}

-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}

@end 
```

我的问题与`- (void)setAndShowDiagnosis:(int)diagnosis`方法有关。此方法在任何 .h 文件中的任何地方都未声明为公共的，显然它也不是私有的。我的问题是为什么会这样？它只显示了它的 setter 实现，但实际的方法声明却没有出现。任何有助于澄清这一点的帮助表示赞赏。哦，这是来自在线讲座，一切都编译得很好并且可以运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:23:06.310

方法不需要公开、私下或以其他方式声明。在 .h 文件中声明方法可以让其他用户了解这些方法的类知识。通过不声明它，您将该方法隐藏在使用该类的程序的其余部分中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:26:51.070

如果您希望它们是私有的，则不必声明方法。在objective-c中没有私有方法之类的东西。

在头文件中声明方法和在实现文件顶部声明类扩展之间的区别在于，如果您没有在头文件中声明它，并且您使用另一个类的方法，那么编译器会警告您该方法可能不存在。但是只要您实现了该方法，应用程序就不会崩溃并且该方法将被调用。

你可以不在任何地方声明任何方法，但你会收到很多编译器警告，以后更难阅读，其他人也更难理解你的代码。并且由于您错过拼写方法名称或其他一些小错误而导致崩溃的可能性更大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:20:47.600

> 此方法在任何 .h 文件中的任何地方都未声明为公共的，显然它也不是私有的。

我想你回答了你自己的问题，它没有被宣布，因为它没有被宣布。除非我读错了？

# java - Eclipse 插件中的小程序

> ID：11022698
> 
> 赞同：0
> 
> 时间：2012-06-13T20:18:05.493
> 
> 标签：java, eclipse, eclipse-plugin, applet

我正在创建一个 Eclipse 插件。我有一个希望在 Eclipse 视图中运行的小程序。这可能吗？我知道我不能使用 Eclipse 的内部浏览器，因为它不会运行小程序。

# ruby - Nokogiri（在 Ubuntu 上）的稳健安装过程是什么？

> ID：11022701
> 
> 赞同：7
> 
> 时间：2012-06-13T20:18:27.483
> 
> 标签：ruby, ubuntu, nokogiri, ubuntu-12.04

我尝试在我的 Ubuntu 12.04 系统上安装 Nokogiri，并收到一条错误消息“ `libxslt is missing`”，但安装了`libxslt-dev`and `libxml2-dev`。

是否有稳健的安装过程？如何检查依赖库的链接？

我使用了 RVM，并且也安装了 RVM pkg。

```
ERROR:  Error installing nokogiri:
    ERROR: Failed to build gem native extension.

        /home/victor/.rvm/rubies/ruby-1.9.3-p125/bin/ruby extconf.rb
checking for libxml/parser.h... yes
checking for libxslt/xslt.h... yes
checking for libexslt/exslt.h... yes
checking for iconv_open() in iconv.h... yes
checking for xmlParseDoc() in -lxml2... yes
checking for xsltParseStylesheetDoc() in -lxslt... no
-----
libxslt is missing.  please visit http://nokogiri.org/tutorials/installing_nokogiri.html for help with installing dependencies.
-----
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/home/victor/.rvm/rubies/ruby-1.9.3-p125/bin/ruby
    --with-zlib-dir
    --without-zlib-dir
    --with-zlib-include
    --without-zlib-include=${zlib-dir}/include
    --with-zlib-lib
    --without-zlib-lib=${zlib-dir}/lib
    --with-iconv-dir
    --without-iconv-dir
    --with-iconv-include
    --without-iconv-include=${iconv-dir}/include
    --with-iconv-lib
    --without-iconv-lib=${iconv-dir}/lib
    --with-xml2-dir
    --without-xml2-dir
    --with-xml2-include
    --without-xml2-include=${xml2-dir}/include
    --with-xml2-lib
    --without-xml2-lib=${xml2-dir}/lib
    --with-xslt-dir
    --without-xslt-dir
    --with-xslt-include
    --without-xslt-include=${xslt-dir}/include
    --with-xslt-lib
    --without-xslt-lib=${xslt-dir}/lib
    --with-libxslt-config
    --without-libxslt-config
    --with-pkg-config
    --without-pkg-config
    --with-libxml-2.0-config
    --without-libxml-2.0-config
    --with-libiconv-config
    --without-libiconv-config
    --with-xml2lib
    --without-xml2lib
    --with-xsltlib
    --without-xsltlib

Gem files will remain installed in /home/victor/.rvm/gems/ruby-1.9.3-p125@dradis/gems/nokogiri-1.5.4 for inspection.
Results logged to /home/victor/.rvm/gems/ruby-1.9.3-p125@dradis/gems/nokogiri-1.5.4/ext/nokogiri/gem_make.out
    enter code here 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T14:06:20.013

我也遇到了与 rvm 相同的问题，即使我按照文档做了以下操作：

*   `sudo apt-get install libxslt-dev libxml2-dev`
*   `rvm pkg libxml2`和`rvm pkg libxslt`

经过长时间的调查，我可以解决这个问题的唯一方法是：

*   卸载红宝石安装：`rvm remove 1.9.3`
*   如果您之前已经完成，请删除所有`libxslt*`和`libxml2*`库`~/.rvm/usr/lib``rvm pkg ...`
*   重新安装红宝石：`rvm install 1.9.3`

在命令*之后*重新安装`apt-get`似乎是让它工作的唯一方法。此外，确保安装的库`rvm pkg`不会干扰也有帮助。

**当其他一切都失败时...**

如果一切都失败了并且你绝对需要安装 gem，你也可以`nokogiri`通过应用一个简单的补丁来重建——前提是你已经安装了所有的构建工具，并且需要注意的是这将安装最新的和可能不稳定的代码：

*   `git clone git://github.com/sparklemotion/nokogiri`
*   [从此要点](https://gist.github.com/3800001)获取补丁并将其保存`x86_64.patch`在`nokogiri`文件夹中。
*   应用补丁：`patch -p1 < x86_64.patch`
*   Rebuild: — 这应该在文件夹`rake native gem`中构建 gem`pkg/`
*   使用安装 gem`gem install pkg/nokogiri-<version>-x86_64-linux.gem`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T01:16:44.623

我对红宝石还很陌生，但这...

```
gem install nokogiri -v '1.5.2' -- --with-xml2-lib=/usr/lib/i386-linux-gnu --with-xml2-include=/usr/include/libxml2 --with-xslt-lib=/usr/lib/i386-linux-gnu --with-xslt-include=/usr/include/libxslt 
```

...在 Ubuntu 12.04 上为我工作。（或者，无论如何，它满足了 nokogiri 的依赖，让我离我真正想要完成的事情更近了一步。）我认为它可能搞砸了我的 RVM 魔法，但 nokogirl-1.5.2 肯定就在那里~ /.rvm/ruby-1.9.3-p194/gems，所以...也许一切都好？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-02T19:48:43.967

我在 Ubuntu 13.04 上遇到了这个问题。

我已经尝试了你在网上找到的所有东西。确保 Nokogiri 安装页面上列出的软件包存在，等等。

最终为我做的唯一一件事就是从源代码安装 libsxlt。之后，一切都完美无缺。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-26T02:57:38.390

我不得不使用 gem install nokogiri -- --with-iconv-dir=/usr/lib/ruby/1.9.1/x86_64-linux

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-13T20:46:22.040

```
sudo apt-get install ruby1.8-dev ruby1.8 ri1.8 rdoc1.8 irb1.8
sudo apt-get install libreadline-ruby1.8 libruby1.8 libopenssl-ruby
sudo apt-get install libxslt-dev libxml2-dev 
```

?

# facebook - Facebook.getLoginStatus 没有调用它的回调

> ID：11022703
> 
> 赞同：0
> 
> 时间：2012-06-13T20:18:32.140
> 
> 标签：facebook, actionscript-3, facebook-graph-api

```
 public function getLoginStatus(callback:Function) {
        Facebook.addJSEventListener("auth.sessionChange", callback)

        setTimeout(Facebook.getLoginStatus, 1200);
    } 
```

我尝试了延迟和不延迟

我的回调函数看起来像这样，

```
 public function getLoginStatusHandler(result:Object):void {
        trace('success');
    } 
```

并且调用该函数是

```
getLoginStatus(getLoginStatusHandler); 
```

应用程序已正确初始化

我相信对于我的 html 页面，我只需要这个就可以让 FB 正常工作。

```
<script type="text/javascript" src="https://connect.facebook.net/en_US/all.js"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:28:23.570

我对 ActionScript 不是很熟悉——但在 JavaScript 中，使用 setTimeout 调用 Facebook.getLoginStatus 方法会使其脱离实际上下文。您是否有理由不直接调用 Facebook.getLoginStatus ？

# html - phoneGap/Cordova 的技术限制是什么？

> ID：11022707
> 
> 赞同：5
> 
> 时间：2012-06-13T20:19:21.453
> 
> 标签：html, mobile, cordova

首先，感谢令人惊叹的 apache cordova 团队制作了一个独立于平台的类原生应用程序构建平台 - 很棒的东西。

但是我们知道 HTML5 仍处于草稿模式，我正在考虑将 Cordova 应用到那个方向，那么 Cordova 现在的技术限制是什么？

与 Sencha Touch 2 相比有什么优缺点，正如我在 Cordova 搜索期间看到的那样，ST2 出现了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:38:13.140

在您所想的意义上，Cordova 没有技术限制。

Cordova 提供了一种将 JS、HTML 和 CSS 打包到应用程序中的方法，该应用程序在本机 Web 视图中运行。您可能会听到一个论点，即任何添加到原生 SDK 的新功能都无法使用，因为您必须等待 Cordova 实现它。这是错误的，没有什么可以阻止任何人通过 JS 本地访问新功能。

技术限制实际上是在您的网络技术运行的浏览器上。

在iOS5之前没有position:fixed，所以对于想要支持iOS5的开发者来说这是一个限制<。他们被迫使用 iScroll 之类的东西，或者通过将 UINavigationBar 与 UIWebView 混合来实际采用混合方法。我已经做到了，这很困难。

另一个限制是点击事件需要 300 毫秒才能触发，因此响应性很差。不过，这已经解决了很多次，最近一次是由[谷歌解决的](https://developers.google.com/mobile/articles/fast_buttons?hl=de-DE)

还有很多其他问题，比如[过渡期间的闪烁](https://stackoverflow.com/questions/2946748/iphone-webkit-css-animations-cause-flicker)以及[Thomas Fuchs](http://mir.aculo.us/2010/06/04/making-an-ipad-html5-app-making-it-really-fast/)在博客中提到的问题。说真的，那家伙是个天才。

我曾经遇到过一个错误，它通过在应用了 css 转换的父 div 中显示和隐藏子 div 导致页面分辨率降低。真是奇怪的东西。

Sencha Touch 是一个很好的框架，您可以在 Web 应用程序中试用它，但它在功能层面上与 Cordova 无关

# c++ - 切换到 ITK 4 后出现 Qt 错误

> ID：11022708
> 
> 赞同：1
> 
> 时间：2012-06-13T20:19:26.150
> 
> 标签：c++, qt, cmake, itk

我们有一个使用 ITK 3.10.1 和 Qt 4.5 的 Windows7 VS2008 C++ 应用程序。我们运行 CMake 2.6-patch 4 来生成 ITK 和我们的应用程序 C++ 项目，一切运行正常。现在我切换到 ITK 4.1.0，为此我必须将 CMake 从 2.6 升级到 2.8，并使用这个 CMake 生成 ITK 4.5 和我们的应用程序。现在 ITK 编译正常，但应用程序没有。错误对话框显示“没有为平台 Win32 分配给此项目的 Qt 版本。请使用‘更改 Qt 版本’功能并为此平台选择有效的 Qt 版本。”。平台是 Win32，现在仍然是；电脑也是一样的，我没碰Qt。显然我没有做应该做的事或不应该做的事。

任何帮助将不胜感激。

问候。

麦克风

# android - 抛出未捕获的异常时未生成 Emma 代码覆盖率

> ID：11022709
> 
> 赞同：1
> 
> 时间：2012-06-13T20:19:50.127
> 
> 标签：android, code-coverage, emma, build.xml

在被测 Android Activity 中抛出未捕获的异常时，不会生成 Emma 代码覆盖率。但是，如果测试通过，则成功生成覆盖！我正在使用 SDK r15、Emma 1.6.x macosx 和默认的 build.xml。以下是`ant test`目标的输出：

```
[exec] com.stackoverflow.android.test.ActivityTest:INSTRUMENTATION_RESULT: shortMsg=java.lang.ArithmeticException
[exec] INSTRUMENTATION_RESULT: longMsg=java.lang.ArithmeticException: divide by zero
[exec] INSTRUMENTATION_CODE: 0
[echo] Downloading coverage file into project directory...
[exec] remote object '/data/data/com.stackoverflow.android/coverage.ec' does not exist 
```

这是正常的吗？我是 Emma 的新手，但我知道 JaCoCo 有时会这样做！请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T04:56:34.877

我刚刚遇到了这个不涉及 android sdk 或 mac os 的问题。我在 Windows 上使用 JUnit 测试覆盖标准 JDK 代码库。我也是艾玛的新手，但我发现这是正常的。:( 以下链接来自 EclEmma 自己的常见问题解答。

[为什么带有预期异常的 JUnit4 测试用例显示为未涵盖？](http://www.eclemma.org/faq.html#trouble05)

因此，如果有人知道解决此问题的方法，我很想听听。

# javascript - 将 createNSResolver 与 XML 中指定的多个命名空间一起使用

> ID：11022718
> 
> 赞同：2
> 
> 时间：2012-06-13T20:20:33.360
> 
> 标签：javascript, xml, xpath

我有一个这样的 xml 字符串：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Body>
    <ExecuteResponse xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">
      <ExecuteResult i:type="a:RetrieveEntityResponse" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        <a:ResponseName>RetrieveEntity</a:ResponseName>
        <a:Results xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">
          <a:KeyValuePairOfstringanyType>
            <b:key>Some Value</b:key>
          </a:KeyValuePairOfstringanyType>
        </a:Results>
      </ExecuteResult>
    </ExecuteResponse>
  </s:Body>
</s:Envelope> 
```

我正在尝试按照以下方式做一些事情：

```
var resolver = xmlDoc.createNSResolver(xmlDoc.documentElement);
return new XPathEvaluator().evaluate("//b:key", xmlDoc.documentElement, resolver, XPathResult.ANY_TYPE, null); 
```

没有找到关键节点，原因是我调用的时候

```
resolver.lookupNamespaceURI("b") 
```

直接返回null。但是，当我这样做时它确实返回了一些东西

```
resolver.lookupNamespaceURI("s") 
```

所以我最好的猜测是 createNSResolver 方法只在传入的 xml 文档的根节点中查找命名空间。有没有办法让它找到在 xml 中定义的所有命名空间，或者其他方式来构建文档中存在的所有命名空间的列表？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T09:46:57.580

在一般情况下，根据 XML 文档中的所有命名空间声明设置一致的命名空间解析是不可能的，因为您可能拥有例如

```
<root xmlns="http://example.com/n1">
  <foo xmlns="http://example.com/n2">
   <p1:bar xmlns:p1="http://example.com/n1">
    <p2:baz xmlns:p2="http://example.com/n1">...</p2:baz>
   </p1:bar>
  </foo>
</root> 
```

其中相同的命名空间与不同的前缀一起使用，当然你可以有示例，例如

```
<p:foo xmlns:p="http://example.com/n1">
  <p:bar xmlns:p="http://example.com/n2">...</p:bar>
</p:foo> 
```

其中相同的前缀绑定到不同元素上的不同命名空间 URI。

所以基本上你需要知道你正在寻找的元素节点的命名空间URI，然后你可以使用你的代码可以选择的任何前缀设置一个命名空间解析器，例如

```
return xmlDoc.evaluate("//pf:key", xmlDoc, function(prefix) { if (prefix === 'pf' return 'http://schemas.datacontract.org/2004/07/System.Collections.Generic'; else return null; }, XPathResult.ANY_TYPE, null); 
```

另一方面，对于那条简单的路径，我根本不会使用 XPath，`evaluate`而是选择`return xmlDoc.getElementsByTagNameNS('http://schemas.datacontract.org/2004/07/System.Collections.Generic', 'b');`.

至于在 DOM 树中查找名称空间声明以根据前缀自己构建名称空间解析器，XPath 可以通过查看名称空间轴来提供一些帮助，例如`//namespace::*`，但在浏览器内部，Mozilla/Firefox 从未认为有必要支持名称空间轴。然后是一些 DOM Level 3 方法[http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-lookupNamespacePrefix](http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-lookupNamespacePrefix)和[http://www.w3.org/TR/DOM- Level-3-Core/core.html#Node3-lookupNamespaceURI](http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-lookupNamespaceURI)这样您就可以编写自己的代码遍历 DOM 树并收集命名空间声明，但这在一般情况下无助于解决我在上面发布的两个示例示例中概述的问题.

# php - PHP - 将图像写入本地主机的权限问题

> ID：11022720
> 
> 赞同：2
> 
> 时间：2012-06-13T20:20:33.997
> 
> 标签：php

使用 curl 将图像下载到我的本地主机时出现错误。我已经确保权限很好并且目录存在。我不知道接下来要检查什么。这是我得到的错误

```
Warning: unlink(images/) [function.unlink]: Operation not permitted in /Applications/MAMP/htdocs/test/image/instapaper.php on line 47 
```

这是我的代码：

```
 $saveto = 'images/';

if ( !file_exists($saveto) ) {
 mkdir ($saveto, 0777, true);
}

    $url = 'http://img.ffffound.com/static-data/assets/6/4dea2e91338b67cd926140acde1962403c3bf4c2_m.jpg';

echo getcwd() . "\n";

$ch = curl_init ($url);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_BINARYTRANSFER,1);
$raw=curl_exec($ch);
curl_close ($ch);
if(file_exists($saveto) && is_writable($saveto)){
    unlink($saveto);
}
$fp = fopen($saveto,'x');

if(fwrite($fp, $raw)==false){
  echo 'no dice';
  return;
}
fclose($fp); 
```

**解决了

下面是工作代码。它基本上看起来像我试图将图像保存为我指定的目录位置。这已被清除，我已经提供了一个图像名称来保存文件。在最终脚本中，图像名称将从 url 中获取。

```
 $url = 'http://img.ffffound.com/static-data/assets/6/4dea2e91338b67cd926140acde1962403c3bf4c2_m.jpg';
$saveto = 'images/';
$image_name = 'image.jpg';
$full_path = $saveto .  $image_name;

if ( !file_exists($saveto) ) {
 mkdir ($saveto, 0777, true);
}

$ch = curl_init ($url);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_BINARYTRANSFER,1);
$raw=curl_exec($ch);
curl_close ($ch);
if(file_exists($full_path) && is_writable($full_path)){
    unlink($full_path);
}
$fp = fopen($full_path,'x');

if(fwrite($fp, $raw)==false){
  echo 'no dice';
  return;
}
fclose($fp); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:24:51.693

`$saveto`是一个目录 - 你不能`unlink()`，你必须`rmdir()`它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:24:22.770

警告是`unlink`，而不是 cURL。看起来您正在尝试对目录执行此操作，这是不允许的，并且根据文档，失败将产生警告。

您可以使用`rmdir($dirname)`删除目录，但除了适当的权限外，该目录必须为空才能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:25:13.220

对于初学者来说 unlink() 是删除文件， rmdir() 是删除目录。目录也必须为空。

当我看到这个警告时：“警告：unlink(images/)”看起来你正试图删除一个功能错误的文件夹。

# sql-server - 我想在我的系统中安装 SQL Server 数据库并将这个数据库添加到已经有 oracle 的 Informatica

> ID：11022721
> 
> 赞同：0
> 
> 时间：2012-06-13T20:20:42.020
> 
> 标签：sql-server, oracle, informatica

我的系统中有 Informatica 9 和 Oracle 数据库。现在我想在我的系统中安装一个 SQL Server 数据库并将这个数据库添加到 Informatica。

那可能吗 ？

目的：我需要使用 informatica 将一些表从 SQL Server 迁移到 Oracle 数据库。

谁能告诉我，安装 SQL Server 后，如何将此 SQL Server 数据库添加到 informatica 以创建映射？

谢谢斯里德哈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T10:28:43.910

在您的系统上安装 SQL Server 软件和让 informatica 与之对话是完全不同的事情。

1.  您可以肯定地在您的 Informatica 服务器系统上安装 SQL 服务器，直到您处理一些 Windows 的变体。Informatica 可以安装在 *nix 风格上，但不能安装在 SQL Server 上。如果您的 informatica 服务器不在 Windows 变体上，则需要有一个单独的 Windows 框来安装 sql 服务器。

2.  让 informatica 与 sql server 对话将取决于您为 Informatica 拥有的平台密钥。拥有驱动程序和一切都很好，但最后 informatica 允许基于平台密钥与操作系统/数据库进行交互，这些密钥通常是购买的，因此您要访问的每个额外的环境/数据库都有价格。

hth

# ms-access - 在访问表单中过滤

> ID：11022729
> 
> 赞同：4
> 
> 时间：2012-06-13T20:21:05.220
> 
> 标签：ms-access, vba

我有一个表单，我希望它在加载后立即被过滤。

单击表单后，它应该能够通过过滤特定数据来加载。我希望它按程序名称和年份过滤。

我尝试了以下代码，但我不断收到语法错误：

```
Private Sub Form_Load()
Combo5.Value = Form_0_Cover.Combo0
Combo7.Value = Form_0_Cover.Combo2

'Me.Filter = "[Program_Name]=" & Me.Combo7 & " AND [Budget_Year]='" & Me.Combo5 & ""

End Sub 
```

我不确定问题似乎是什么。我不断收到语法错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:23:48.530

尝试：

```
Me.Filter = "[Program_Name]='" & Me.Combo7 & "' AND [Budget_Year]=" & Me.Combo5 
```

我怀疑计划名称是文本，预算年份是数字。程序名称组合可能有一个 id 作为绑定列，在这种情况下，事情可能会变得更加困难，可能是：

```
Me.Filter = "[Program_ID]=" & Me.Combo7 & " AND [Budget_Year]=" & Me.Combo5 
```

# jquery - Opera Mobile 和 jQuery Mobile Select 菜单显示错误

> ID：11022735
> 
> 赞同：2
> 
> 时间：2012-06-13T20:21:30.397
> 
> 标签：jquery, css, jquery-mobile, select-menu, opera-mobile

带有 Opera Mobile 的 jQuery mobile 中存在一个错误，它显示默认选择而不是来自 jQuery Mobile 的自定义选择，请参见下面直接从 jQuery Mobile 网站截取的屏幕截图！

![Opera Mobile 和 jQuery Mobile Select 菜单显示错误](../Images/f04334bfbff8b27c1949979d435117f6.png)

这是 jQuery mobile 用来隐藏选择的代码：

```
.ui-select .ui-btn select {
    cursor: pointer;
    -webkit-appearance: button;
    left: 0;
    top: 0;
    width: 100%;
    min-height: 1.5em;
    min-height: 100%;
    height: 3em;
    max-height: 100%;
    opacity: 0;
    -ms-filter: "alpha(opacity=0)";
    filter: alpha(opacity=0);
    z-index: 2;
} 
```

有没有办法像在 iPhone 和 Android 默认浏览器上那样隐藏它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T14:10:21.490

我为 Opera 创建了一个单独的 CSS 文件，以下类覆盖对我有用：

```
.ui-select .ui-btn select {
  opacity: 0 !important;
} 
```

此外，需要从元素中删除`.ui-select-nativeonly`类。`.ui-select .ui-btn`我为此使用了 jQuery：

```
$(function() {
  /**
   * Opera selectors drawings
   */
  $('.ui-select .ui-btn').removeClass('ui-select-nativeonly');

}); 
```

# objective-c - 缓入缓出功能

> ID：11022740
> 
> 赞同：4
> 
> 时间：2012-06-13T20:22:05.507
> 
> 标签：objective-c, ios

我想要一个等效于 UIViewAnimationCurveEaseInOut 的缓动函数，但没有看到 Apple 将其作为函数公开。

我尝试[了此处发布的 easeInOutQuad 功能](https://stackoverflow.com/questions/8316882/what-is-an-easing-function)，但没有成功。我的那个函数的 Objective-C 版本是：

```
-(float) getEaseInOutValueWithElapsedMillis: (float) t startValue: (float) b endValue: (float) c andTotalMillis: (float) d {
   float   value =0.0f;

   if ((t/=d/2.0f) <1.0f)
      value =c/2.0f*t*t + b;
   else
      value =-c/2.0f * ((--t)*(t-2.0f) - 1.0f) + b;

   debug(@"t=%f b=%f c=%f d=%f value=%f", t, b, c, d, value);
   return value;
} 
```

记录的结果是：

当起始值小于结束值时：

```
t=0.066467 b=110.000000 c=225.000000 d=500.000000 value=110.497017
t=0.133133 b=110.000000 c=225.000000 d=500.000000 value=111.993996
t=0.199799 b=110.000000 c=225.000000 d=500.000000 value=114.490944
...
t=0.999786 b=110.000000 c=225.000000 d=500.000000 value=222.451935
t=0.066452 b=110.000000 c=225.000000 d=500.000000 value=236.954926
t=0.133118 b=110.000000 c=225.000000 d=500.000000 value=250.457932
... (note that value shot right past c)
t=0.866440 b=110.000000 c=225.000000 d=500.000000 value=332.993195
t=0.933105 b=110.000000 c=225.000000 d=500.000000 value=334.496582
t=0.999771 b=110.000000 c=225.000000 d=500.000000 value=335.000000 
```

并且 100% 的值最终为 b +c，而不是 c。

当起始值大于结束值时：

```
t=0.047389 b=225.000000 c=110.000000 d=700.000000 value=225.123520
t=0.095008 b=225.000000 c=110.000000 d=700.000000 value=225.496460
...
t=0.904504 b=225.000000 c=110.000000 d=700.000000 value=334.498413
t=0.952122 b=225.000000 c=110.000000 d=700.000000 value=334.873932
t=0.999740 b=225.000000 c=110.000000 d=700.000000 value=335.000000 
```

同样，100% 的值最终为 b + c，而不是 c。

也许我已经破坏了代码。如何实现适当的缓入缓出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-14T00:30:27.097

> 我想要一个等效于 UIViewAnimationCurveEaseInOut 的缓动函数，但没有看到 Apple 将其作为函数公开。

Apple 公开了您可以调用以获取控制点的`CAMediaTimingFunction`通路。您将了解到它是具有控制点 (0, 0)、(0.42, 0)、(0.58, 1)、(1, 1) 的三次贝塞尔曲线。`[CAMediaTimingFunction functionWithName: kCAMediaTimingFunctionEaseInEaseOut]``getControlPointAtIndex:values:`

这为您提供了一个 Bezier 函数`f(n)`，该函数绘制为`value`沿 y 对`time`沿 x 的 2d 图表。因此，要获得正确的值，只需求解`n`位置`x = time`并读取值。

具体来说，在这个函数中：

```
f.x(n) = (1-n)^3 * 0 + 3(1-n)^2 * n * 0.42 + 3(1-n) * n^2 * 0.58 + n^3 * 1
       = 3(1-n)^2 * n * 0.42 + 3(1-n) * n^2 * 0.58 + n^3
       = 1.26(1 - 2n + n^2) * n + 1.74 (1 - n) * n^2 + n^3
       = 1.26n - 2.52n^2 + 1.26n^3 + 1.74n^2 - 1.74n^3 + n^3
       = 1.26n - 0.78n^2 + 0.52n^3 
```

（免责声明：即兴写出；请检查）

要获得时间 0.5 的值，请求解 n：

```
0.5 = 1.26n - 0.78n^2 + 0.52n^3 
```

然后将其插入等效的`f.y(n)`. [有一个解决三次方的公式，](http://en.wikipedia.org/wiki/Cubic_function)但涉及到这个问题，所以（i）阅读维基百科文章并使用公式；或者 (ii) 编写一个数值求解器，例如通过二进制搜索。这个特殊的立方体表现得非常好，每次只有一个解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-14T00:05:01.753

有点晚了，但很快就到了。

在 Playgrounds 中像这样运行它：

```
import UIKit

var sValue: CGFloat = 0
var eValue: CGFloat = 100
var tDuration: CGFloat = 100
var eTime: CGFloat = 0

var currentValue: CGFloat = 0

func easeInOutQuad (percentComplete: CGFloat, elapsedTimeMs: CGFloat, startValue: CGFloat, endValue: CGFloat, totalDuration: CGFloat) -> CGFloat {
    var newElapsedTimeMs = elapsedTimeMs
    newElapsedTimeMs /= totalDuration/2

    if newElapsedTimeMs < 1 {
        return endValue/2*newElapsedTimeMs*newElapsedTimeMs + startValue
    }
    newElapsedTimeMs = newElapsedTimeMs - 1
    return -endValue/2 * ((newElapsedTimeMs)*(newElapsedTimeMs-2) - 1) + startValue
}

for i in eTime...tDuration {
    currentValue = easeInOutQuad(0, CGFloat(i), sValue, eValue, tDuration)
} 
```

# asp.net-mvc-3 - 如何在 MVC3 中为包含日期属性的视图模型强制执行正确的全球化行为

> ID：11022745
> 
> 赞同：2
> 
> 时间：2012-06-13T20:22:32.467
> 
> 标签：asp.net-mvc-3, validation, datetime, globalization, cultureinfo

我正在尝试将复杂的视图模型传递给控制器​​操作。传递的对象是 Goal 类型，其中包含一个日期时间属性 (Goal.moddate)。在我的情况下，日期的字符串表示遵循 es-MX。因此，2012 年 2 月 29 日表示为“29/02/2012”（我对其他日期也有同样的问题）。

控制器动作还使用 [CultureAwareAction] 属性进行注释 - 此属性根据用户偏好设置文化信息。在这种情况下（更新以使解决方案更清晰）

```
public class CultureAwareActionAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        base.OnActionExecuting(filterContext);    
        Thread.CurrentThread.CurrentCulture = new CultureInfo("es-MX");
        Thread.CurrentThread.CurrentUICulture = new CultureInfo("es-MX");
    }
} 
```

我处理该操作的首选方式如下：

```
 [HttpPost]
    [CultureAwareAction]
    [ValidateAntiForgeryToken]
    public ActionResult Edit(Goal goal)
    {
        try
        {
            if (ModelState.IsValid)
            {
                {
                    ...update logic ... 
                }
            }
        }
        catch (DataException)
        {
           ... error handling ....   
        }
        return View();
    } 
```

使用此方法 ModelState.IsValid 由于未解析日期字符串而返回 false。将控制器操作更改为以下我没有遇到错误：

```
 [HttpPost]
    [CultureAwareAction]
    [ValidateAntiForgeryToken]
    public ActionResult Edit(int id, FormCollection formcollection)
    {
        try
        {
            Goal goal = unitOfWork.GoalRepository.GetByID(id);

            if (TryUpdateModel(goal,formcollection))
            {
                {
                   ... update logic ....
                }
            }
        }
        catch (DataException)
        {
          ... error handling ...
        }
        return View();
    } 
```

我的目标是在第一种情况下强制执行适当的全球化行为，因为这种方法具有显着优势。除非在使用 [CultureAwareAction] 属性设置用户首选文化之前发生模型绑定，否则这似乎应该有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T05:50:56.710

模型绑定器使用`CurrentCulture`，而不是`CurrentUICulture`when 解析日期。此外，您还没有显示此代码，`CultureAwareAction`但很可能它在模型绑定**之后**执行，因此您设置文化为时已晚。

如果您想确保它在模型绑定**之前**执行，您可以实现[`IAuthorizationFilter`](http://msdn.microsoft.com/en-us/library/system.web.mvc.iauthorizationfilter.aspx)接口：

```
public class CultureAwareActionAttribute : ActionFilterAttribute, IAuthorizationFilter
{
    public void OnAuthorization(AuthorizationContext filterContext)
    {
        // That's for displaying in the UI, the model binder doesn't use it
        Thread.CurrentThread.CurrentUICulture = new CultureInfo("es-MX");

        // That's the important one for the model binder
        Thread.CurrentThread.CurrentCulture = new CultureInfo("es-MX");
    }
} 
```

# algorithm - 决定哪种排序算法效果最好的真实世界示例

> ID：11022756
> 
> 赞同：7
> 
> 时间：2012-06-13T20:23:41.980
> 
> 标签：algorithm, sorting, time-complexity, space-complexity

在我得到答案之前，我冒着这个问题被关闭的风险，但我真的很想知道答案。所以这里。

* * *

我目前正在尝试学习*算法*，并且我开始理解它，但无法与之相关。

我了解*时间复杂性*和*空间复杂性*。我也确实了解一些基于伪代码的排序算法

排序算法如

1.  冒泡排序
2.  插入排序
3.  选择排序
4.  快速排序
5.  合并排序
6.  堆排序（一些什么）

我也知道*最好的情况*和*最坏*的情况（平均情况不是很多）。

* * *

一些网上相关的参考资料

*   以图形方式显示以上所有内容的[好地方。](http://www.sorting-algorithms.com/)
*   [这](https://stackoverflow.com/questions/9798078/what-are-the-criteria-for-choosing-a-sorting-algorithm)也让我有了很好的理解。

* * *

但我的问题是 - 有人可以给我实现这些排序算法的**真实世界示例。**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T20:33:52.867

随着元素数量的增加，您将使用更复杂的排序算法。后来的排序技术具有更高的初始开销，因此您需要大量元素来排序以证明该成本是合理的。如果您只有 10 个元素，则冒泡排序或插入排序将比合并排序或堆排序快得多。

对于电视遥控器或手机等较小的嵌入式设备，空间复杂性很重要。您没有足够的空间在这些设备上执行诸如堆排序之类的操作。

数据库使用外部合并排序对太大而无法完全加载到内存中的数据集进行排序。这种类型的驱动因素是磁盘 I/O 数量的减少。

[好的冒泡排序讨论](https://stackoverflow.com/questions/276113/what-is-a-bubble-sort-good-for)，还有许多其他因素需要考虑，这些因素会导致时间和空间复杂性。

[排序算法.com](http://www.sorting-algorithms.com/ "排序算法.com")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:29:45.817

一个例子是 C++ STL 排序

正如[维基百科页面](http://en.wikipedia.org/wiki/Sort_%28C++%29)所说：

> 例如，GNU 标准 C++ 库使用混合排序算法：首先执行 introsort，最大深度由 2×log2 n 给出，其中 n 是元素的数量，然后对结果进行插入排序。[1](http://en.wikipedia.org/wiki/Sort_%28C++%29)无论采用何种实施方式，复杂度平均应为 O(n log n) 次比较。 [2]

# haskell - 是否有从 XSD 在 Haskell 中生成 XML picklers 的工具？

> ID：11022758
> 
> 赞同：5
> 
> 时间：2012-06-13T20:23:49.657
> 
> 标签：haskell, xsd, code-generation

我想为[XSD 文件生成](http://www.energysoft.org/Title24XML.xsd)[XML 选择](http://www.haskell.org/haskellwiki/HXT/Conversion_of_Haskell_data_from/to_XML#The_idea%3a_XML_pickler)器。这似乎是一个可能已经存在的有用工具。可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T20:48:35.767

`HaXml`确实有一个从 DTD 生成 Haskell 数据类型的工具和一个从 XSD 生成 Haskell 数据类型的工具：http: [//hackage.haskell.org/package/HaXml](http://hackage.haskell.org/package/HaXml)

可执行文件名为 XsdToHaskell 和 DtdToHaskell。

如果你在 Windows 上并且你有 Haskell 平台修改的 PATH，你需要这样调用它：`xsdtohaskell < path_to.xsd > path_to.hs`

生成的文件是一个不错的起点。

# ruby-on-rails - 如何更改 will_paginate 网址？

> ID：11022759
> 
> 赞同：7
> 
> 时间：2012-06-13T20:23:53.543
> 
> 标签：ruby-on-rails, routes, will-paginate

我正在尝试将`will_paginate`链接从格式更改`/list?page=1`为`/list/page/1`. 我为此设置了正确的路由，但是`will_paginate`在链接中使用查询字符串而不是我漂亮的 URL 样式。不然怎么说？

我正在使用 will_paginate **2.3.16**和 Rails **2.3.14**。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-15T23:38:43.340

will_paginate 使用`url_for`助手。如果您定义包含它使用的参数的路由，它应该会生成漂亮的 url。

```
map.connect '/lists/page/:page', :controller => 'lists', :action => 'index' 
```

请确保，您在任何也可以匹配您的控制器操作的路由*之上定义此路由。*更好的是：排除索引操作，如下所示：

```
map.resources :lists, :except => [:index] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T23:35:35.197

您在这里有几个选择：

第一个选项：monkey patch `WillPaginate::ActionView::LinkRenderer#url`，目前有以下 url 逻辑：

```
def url(page)
  @base_url_params ||= begin
    url_params = merge_get_params(default_url_params)
    merge_optional_params(url_params)
  end

  url_params = @base_url_params.dup
  add_current_page_param(url_params, page)

  @template.url_for(url_params)
end 
```

所以，我想你可以做类似的事情`"/list/page/#{page}"`。

另一种方法是完全实现渲染器（通过子类化`WillPaginate::ViewHelpers::LinkRenderer`），然后`:renderer => MyRendererClass`在调用 will_paginate 时提供它。

# apple-push-notifications - 使用 4D 服务器发送 APNs

> ID：11022763
> 
> 赞同：1
> 
> 时间：2012-06-13T20:24:08.137
> 
> 标签：apple-push-notifications, 4d-database

我希望从 4D 服务器发送推送通知。我一直在关注[Ray Wenderlich 的教程](http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12)，但在尝试使用 4D Server 进行“推送”时卡住了。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:09:31.410

感谢 4D 的技术支持团队为我指明了正确的方向，感谢 Ray Wenderlich 的优秀教程，其中包括连接到 Apple 所需的 PHP 脚本。

为了在 4D 服务器中使用 PHP，我在 4D 中使用了 PHP Execute 命令来运行我存储在数据库文件夹中的 PHP 脚本。simplepush.php 是我的脚本文件的名称。

```
C_TEXT($result)
C_BOOLEAN($isOK)
$isOK:=PHP Execute("simplepush.php";"";$result) 
```

[4D 语言手册中的 PHP EXECUTE 命令参考示例 5](http://doc.4d.com/4Dv15/4D/15.1/PHP-Execute.301-2685040.en.html#187950)还显示了如何通过字符搜索和替换从 4D 中修改 php 脚本文档。

确保将 php 脚本文档和 .pem 证书与 4D 服务器和数据文件保存在同一文件夹中。

# jquery - 来自ajax html表单的django getlist（）

> ID：11022771
> 
> 赞同：0
> 
> 时间：2012-06-13T20:24:40.827
> 
> 标签：jquery, python, html, django

我试图将我的序列化表单数据发送到 django，它应该作为列表“[视频，音频]”存储在“mylist”中。无论我在表单上检查什么框，views.py 每次都返回 0。

html表单

```
<form id="myform" method="POST">
<input type="checkbox" name="list" value="audio"/> Audio<br />
<input type="checkbox" name="list" value="video"/> Video<br />
<input type="submit" value="Get Custom Library!" /> 
</form> 
```

jQuery ajax

```
<script language="JavaScript">
$(document).ready(function() {
$("#myform").submit(function() {

        $.ajax({
        type: "POST",
        url: 'django/builder/buildit',
        data: $(this).serialize(),
        success: function(response){
            alert(response);
        }
    });
    return false;
});
});
</script> 
```

视图.py

```
from django.http import HttpResponse
def main(request):
  mylist = request.POST.getlist('list')
  message = 0
  for item in mylist:
    if item == 'video':
      message = 'vid'
    elif item == 'audio':
      message = 'aud'
  return HttpResponse(message) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:27:48.023

您没有为参数提供键值对`data`，但您甚至不必走那么远 - 您不必自己收集复选框值。你可以替换这个：

```
 var myCheckboxes = new Array();
    $("input:checked").each(function() {
       myCheckboxes.push($(this).val());
    });

    $.ajax({
        type: "POST",
        url: 'django/builder/buildit',
        data: myCheckboxes,
        success: function(response){
            alert(response);
        }
    }); 
```

有了这个，使用[serialize](http://api.jquery.com/serialize/)：

```
 $.ajax({
        type: "POST",
        url: 'django/builder/buildit',
        data: $('#myform').serialize(),
        success: function(response){
            alert(response);
        }
    }); 
```

# c++ - 在 QtCreator 中将 user32.lib 添加到 QtWidget 项目中

> ID：11022775
> 
> 赞同：6
> 
> 时间：2012-06-13T20:25:03.993
> 
> 标签：c++, qt, qt-creator, linker-errors

我是一个完整的 Qt 初学者。在测试场景中，出于某些原因，我需要调用 user32 函数。我的小应用程序编译，但由于缺少 user32.lib 而没有链接

解决这个问题似乎很简单，添加库如下所示。但我无法继续进行下一步，如屏幕截图所示。我几乎尝试了所有**库类型/设置组合**，但库路径总是显示为红色，我无法继续。我什至在驱动器根级别复制了 lib，以避免路径中出现任何空格。有什么提示吗？

评论：

1.  这个问题（[Linking to user32.lib in QTCreator](https://stackoverflow.com/questions/8900275/linking-to-user32-lib-in-qtcreator)）是在以这种方式添加库后的后续情况。这不是重复的。
2.  环境 QtCreator 2.4.1 Win7
3.  通过[下面](https://stackoverflow.com/a/11023079/356726)`LIBS +=`找到的解决方法，但为什么对话框允许我继续？

![在 QtCreator 中添加库](../Images/87011f87d0b1b65dd4f5e88c4f2e53c2.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T20:50:18.897

作为问题[如何通过 GUI 在 Qt Creator 项目中添加外部 .a 库？](https://stackoverflow.com/questions/8727340/how-to-add-an-external-a-library-in-qt-creator-project-via-gui)我找到了一个可行的解决方案（在 .pro 文件中添加）：

```
win32 {
  LIBS += "P:\Microsoft SDKs\Windows\v7.1\Lib\User32.Lib"
} 
```

但是，我仍然对**上述对话框做错了什么**感兴趣？

**备注**：似乎已修复，请参阅下面的 mlvljr 评论

# algorithm - 使用自己的确认对话框实现验证链？

> ID：11022779
> 
> 赞同：1
> 
> 时间：2012-06-13T20:25:21.493
> 
> 标签：algorithm, design-patterns, language-agnostic

我需要执行一系列验证，比如 ValidationA、ValidationB、ValidationC。

如果任何验证失败，则链无法立即验证。

只有在前一个验证条件通过后，才会执行每个后续验证。

如果验证条件失败，我需要向用户显示一个确认对话框，例如“你确定要这样做吗？” — 如果用户说“是”，那么我们应该继续进行链中的下一个验证。如果用户在确认对话框中说“否”，那么我们可以立即失败。

什么是实现这一点的好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:03:00.637

答案在 C# 中，但我希望它很清楚。这里最重要的是原始验证与 UI 分离。OverridableValidator 是一个“UI 人”，它在构造函数中获取“逻辑人”，以及要显示给用户的消息。

```
interface IValidator<T>
{
    bool IsValid(T subject);
}

class OverridableValidator<T> : IValidator<T>
{
    readonly IValidator<T> _validator;
    readonly string _confirmOverrideMessage;

    public OverridableValidator(IValidator<T> validator, string confirmOverrideMessage)
    {
        _validator = validator;
        _confirmOverrideMessage = confirmOverrideMessage;
    }

    public bool IsValid(T subject)
    {
        if (_validator.IsValid(subject))
        {
            return true;
        }
        return MessageBox.Show(_confirmOverrideMessage, "Confirmation required", MessageBoxIcon.Question, MessageBoxButtons.YesNo) == DialogResult.Yes;
    }
}

class Person
{
    public int Age {get;set;}
    public int HeightInCentimeters {get;set;}
}

class MaturityValidator : IValidator<Person>
{
    public bool IsValid(Person guy)
    {
        return guy.Age >= 18;
    }
}

class HeightValidator : IValidator<Person>
{
    public bool IsValid(Person guy)
    {
        return guy.HeightInCentimeters < 120;
    }
}

void Main()
{
    var ageValidator = new OverridableValidator<Person>(new MaturityValidator(), "Do you want to sell him cigarettes?");
    var heightValidator = new OverridableValidator<Person>(new HeightValidator(), "Do you want to invite such a short person to your basketball team?");

    var validatedPerson = new Person() { Age = 15, HeightInCentimeters = 140 };
    var validatorsList = new[] {ageValidator, heightValidator};
    foreach (var validator in validatorsList)
    {
        if (!validator.IsValid(validatedPerson))
        {
            return; //validaton failed
        }
    }
    Console.WriteLine("This guy can smoke and play in NBA");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:50:02.093

像这样实现它：

```
(ValidationA || UserConfirmationA) && (ValidationB || UserConfirmationB) && (ValidationC || UserConfirmationC) 
```

其中 Validation 和 UserComfirmation 是按照他们的名字所说的并返回布尔值的函数。

我假设`&&`并且`||`很懒，这在大多数语言中都是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T05:00:26.780

除了 dzendras 所说的之外，它可能有助于您查看允许您动态添加验证器[的责任链模式。](http://en.wikipedia.org/wiki/Chain-of-responsibility_pattern)

# json - 发送带有“\n”换行符的 JSON 字符串

> ID：11022780
> 
> 赞同：1
> 
> 时间：2012-06-13T20:25:23.657
> 
> 标签：json, delphi, datasnap, line-breaks

我有一个`Delphi XE2`Datasnap 服务器，我需要从数据库中接收一个带有换行符的字符串，并将其作为 a 重新发送`JSON String`到客户端应用程序。问题是我收到带有`#10#13`换行符的字符串，而我的客户期望`\n`换行符。这似乎是发送换行符的 JSON 默认方式，我希望转换是自动的，但似乎并非如此。

我正在考虑实施一种我自己的转换方法，但这将是最坏的情况，我想避免可能的*“重新发明轮子”的*情况。所以我的问题是，**有没有更好的选择？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T04:07:45.337

`#10` is a newline or line feed (LF) character, represented as `\n` in c-derived languages, and `#13` is a carriage return (CR) represented as `\r`. The usual order in Windows and some internet protocols (e.g. SMTP and HTTP) is `\r\n`.

Unfortunately, different operating systems uses different line breaks (see also [http://en.wikipedia.org/wiki/Newline](http://en.wikipedia.org/wiki/Newline))

Delphi (or the JSON framework you use) cannot guess your line break expectation. I am afraid you have to write extra code to make line breaks fit your client.

In reality, what is probably happening is that the strings are coming from a database or other source where they are stored with literal CR LF sequences. Delphi is just passing them on unchanged.

Before you do any work, make sure the client actually cares.

# javascript - javascript表单文本框发布js和html

> ID：11022781
> 
> 赞同：0
> 
> 时间：2012-06-13T20:25:25.287
> 
> 标签：javascript, html, forms

我有一个文本框，有点像主要的谷歌搜索文本框。当您开始输入时，javascript 会触发一个 php 脚本，该脚本会提供您可以单击的建议。那部分工作正常。但是，我也希望用户能够输入文本然后提交它——类似于拒绝 Google 的提示并在您自己的搜索词中输入。现在，我正在尝试在 html 中执行此操作，但它不起作用。这是我的代码：

```
<form action="mail.php" method="post"><input type="text" name="maddress" size="30" onkeyup="showResult(this.value)"><input type="submit" name="submit" value="Email"></form> 
```

基本上，onkeyup 中的 javascript 工作正常。但是，表单没有将文本框中的值“发布到 php 脚本。也许我有一些错字但我找不到它。或者可能是 onkeyup 阻止了表单发布......

将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:28:37.667

`showResult()`应该明确地返回`true`（或者在任何情况下，一些非虚假的）。`false`从事件处理程序返回（或虚假值）会阻止默认操作，在这种情况下，会发布表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:39:20.087

我不知道这是否是你要找的，但如果你使用这个概念：

```
<script type="text/javascript">
function insertText(val,e){
document.getElementById(e).innerHTML+=val;
}
</script>
<textarea id="textIns"></textarea><br />
<a href="javascript:insertText('Hello ','textIns');" onClick="void(0)">Insert 'Hello'</a><br /><a  href="javascript:insertText('GoodBye ','textIns');" onClick="void(0)">Insert 'GoodBye'</a> 
```

您可以使用 php 脚本中的 vars 或从哪里获取项目来更改“hello”和“goodbye”，它应该插入并允许您发布它。

因此，只需将其插入您的函数中，它就可以工作了。我通过将代码中的 textarea 添加到表单并将其回显到 php 中来测试它，我得到了 javascript 添加的确切内容......希望它有效。抱歉，如果它不是您要找的东西。这个问题不容易理解，因为我看不到你的其他来源。

# c# - 扩展打印机属性

> ID：11022782
> 
> 赞同：0
> 
> 时间：2012-06-13T20:25:27.113
> 
> 标签：c#, wpf, winforms, printing

我正在使用 WinForms 应用程序。我有一份 RDLC 报告，将在 11x17 上打印然后折叠（打印机支持折叠）。我正在渲染到 EMF 并绘制到 PrintDocument 的页面。除了折叠之外，这很好用。

我想做的是存储使打印机折叠的设置。用户将从下拉列表中选择一个预设，然后应用程序将选择打印机、纸张尺寸、托盘、是否双面打印以及是否折叠。存储 PrinterSettings 对象涵盖了大部分内容，但不保存折叠选项。

我首先尝试存储/检索我读到的名为 DEVMODE 的内容。供参考： http: [//nicholas.piasecki.name/blog/2008/11/programmatically-selecting-complex-printer-options-in-c-shar/](http://nicholas.piasecki.name/blog/2008/11/programmatically-selecting-complex-printer-options-in-c-shar/)。我发现即使我有特定于驱动程序的额外数据，所有字节都是 0，无论我更改了哪些特定于驱动程序的设置。我不确定我哪里出了问题，但我放弃了它并查看了 WPF 中的打印功能。

我发现我可以为我的设置配置一个 PrintTicket，存储它，然后再检索它。只是为了保存设置似乎有点令人费解，但我认为我可以正常工作。至少它似乎在 PrintDialog 中正确显示。但是，我现在一直在试图弄清楚如何打印我的报告。

据我了解，我无法从 WinForms 打印中获取 PrintDocument 并在 WPF 中使用它。我还阅读了 WPF 不支持 EMF 格式。我想我会将每个 EMF 渲染为位图，然后打印它们。但是我报告中的文字很模糊，我没有任何运气来清理它。

从一个包含 EMF 字节的流开始，我知道它会用 PrintDocument 清晰呈现，我测试尝试保存到文件。我提供的任何设置似乎都不会保存清晰的文本。

```
var pageImage = new Metafile(stream);
pageImage.Save(filename); 
```

所有这一切只是为了增加折叠的能力。我只是完全走错了路吗？我不明白这应该怎么这么难。我想我要么需要找到另一种方法来保存/恢复自定义打印机设置，要么我需要一种更好地呈现这些 EMF 文件的方法。

我还尝试将报告直接渲染为 BMP 格式，但质量也很差。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:49:07.290

我尝试了一些稍微不同的东西，它奏效了！我重用了原始 PrintDocument 代码并打印到 XPS 文件。然后我使用我的 PrintTicket 打印了 XPS 文件，它工作正常。

# php - 无法在 Magento 中创建自定义模块

> ID：11022784
> 
> 赞同：0
> 
> 时间：2012-06-13T20:25:28.877
> 
> 标签：php, xml, magento

我对 Magento 很陌生，我已经开始学习为前端开发自定义模块。我已经遵循了几个指南，但由于某种原因，它们都没有工作。似乎 loadLayout 和 renderLayout 正在引起问题。我不确定这是否是因为我的文件位于错误的位置，或者问题是什么。我已经尝试加载页面 magento.x/helloworld magento.x/helloworld/index magento.x/index.php/helloworld。我得到了默认站点的损坏版本。如果我用 echo 替换 lLayout 和 rLayout 就可以了。这就是我所拥有的：

应用程序/代码/本地/Wrapids/Helloworld/etc/config.xml

```
<config>
<modules>
    <Wrapids_Helloworld>
        <version>0.1.0</version>
    </Wrapids_Helloworld>
</modules>
<frontend>
    <routers>
        <helloworld>
            <use>standard</use>
            <args>
                <module>Wrapids_Helloworld</module>
                <frontName>helloworld</frontName>
            </args>
        </helloworld>
    </routers>
    <layout>
        <updates>
            <helloworld>
                <file>helloworld.xml</file>
            </helloworld>
        </updates>
    </layout>
</frontend>
</config> 
```

应用程序/代码/本地/Wrapids/Helloworld/controllers/IndexController.php

```
<?php 
class Wrapids_Helloworld_IndexController extends Mage_Core_Controller_Front_Action 
    {
     public function indexAction() 
     {
      $this->loadLayout();
      $this->renderLayout();
     }
    }
?> 
```

/app/design/frontend/default/default/template/helloworld/page.phtml

```
text 
```

应用程序/设计/前端/默认/默认/布局/helloworld.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<layout version="0.1.0">
    <default>
        <reference name="content">
            <block type="helloworld/helloworld" name="hello" template="helloworld/page.phtml">
        </reference>
    </default>
</layout> 
```

应用程序/代码/本地/Wrapids/Helloworld/Block/Helloworld.php

```
<?php
    class Wrapids_Helloworld_Block_Helloworld extends Mage_Core_Block_Template
    {
    }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T22:50:21.163

我不太了解您的目标，但您可以尝试一下：
app/design/frontend/default/default/layout/helloworld.xml

```
<layout version="0.1.0">
    <default>
        <reference name="root"> 
            <action method="setTemplate"><template>helloworld/page.phtml</template></action> 
        </reference>
    </default>
</layout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T22:44:25.377

将模板和布局文件移动到 [your_package]/default 或 [your_package]/[your_theme]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:26:43.140

您是否使用以下代码将 Wrapids_Helloworld.xml 文件添加到 app/etc/modules？这必须存在才能加载模块

```
<?xml version="1.0"?>
<config>
    <modules>
        <Wrapids_Helloworld>
            <active>true</active>
            <codePool>local</codePool>
        </Wrapids_Helloworld>
    </modules>
</config> 
```

# jquery - Jquery Ajax 返回 302 错误

> ID：11022791
> 
> 赞同：0
> 
> 时间：2012-06-13T20:26:04.290
> 
> 标签：jquery, .net, ajax, web-services

我知道错误 302 是因为我被重定向了......

这是我在 jquery 中的调用：

```
 $.ajax({
                    type: 'POST',
                    url: 'https://url/WebServices/SearchDocuments',
                    data:"{search: " + e.target.value + " }",

                    dataType: "JSON",

                    success: function(data) {
                        GetDocumentSuccess(data[0]);
                    }
                }); 
```

我看到我正在以某种方式退出网络服务。

但是当我使用这个时：

```
 var request = WebRequest.Create(url);
        request.Method = "POST";

        ServicePointManager.ServerCertificateValidationCallback = delegate { return true; };

        using (var s = request.GetRequestStream())
        {
            using (var sw = new StreamWriter(s))
            {
                sw.Write(true); // Write anything. If the post is empty, the distant server throws an error.
            }
        } 
```

它正在工作，我认为问题来自没有这个：

```
ServicePointManager.ServerCertificateValidationCallback = delegate { return true; }; 
```

，当我直接从 jquery 调用它时

这是问题吗？

和

有人知道如何使用 jquery ajax 使其工作吗？

# csv - 在 Imagemagick 中使用 CSV 中的文本

> ID：11022792
> 
> 赞同：0
> 
> 时间：2012-06-13T20:26:16.723
> 
> 标签：csv, imagemagick

我有一个 CSV，其中包含与图像相关的信息，例如名称等，有没有办法可以使用 CSV 文件信息推送到 imagemagick（通过 Windows 上的 PHP）添加到图像中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:31:47.280

当然，请查看[http://php.net/manual/en/function.fgetcsv.php](http://php.net/manual/en/function.fgetcsv.php)以将 CSV 信息放入脚本中，然后我假设您使用的是 PHP ImageMagick 扩展，因此只需针对给定图像，或从文件中的某个变量中读取图像。如果你没有在 PHP 中使用扩展，你可以尝试通过 exec PHP 方法运行它：http: [//php.net/manual/en/function.exec.php](http://php.net/manual/en/function.exec.php)

# jquery - 如何使用水平滚动视口制作内联 li 100% 宽度的窗口

> ID：11022794
> 
> 赞同：0
> 
> 时间：2012-06-13T20:26:26.157
> 
> 标签：jquery, html, css

最后，这将是一个简单的响应式滑块。问题是 li 不会水平堆叠。我如何保持当前窗口宽度为 100% 的 li 和溢出的 ul 水平滚动而不是垂直滚动？是否有可能只在css中加点他的？

*[这是一个活生生](http://jsfiddle.net/9WGZN/20/)*的 JSFIDDLES 示例**

 ***html**

```
 <article id="viewport">
  <ul id="slideshow">
    <li class="slide">
      <section id="towing">
        <div class="caption">
          <header>
            <h1>towing service</h1>
          </header>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum et nisi quam, eget cursus augue. Sed id felis non urna tristique lacinia vel quis neque. Vivamus nisl nibh, lacinia sed egestas et, euismod mollis sem. Maecenas non orci erat, a tincidunt magna.</p>
        </div>
      </section>
    </li>
    <li class="slide">
      <section id="scraping">
        <div class="caption">
          <header>
            <h1>metal scraping service</h1>
          </header>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum et nisi quam, eget cursus augue. Sed id felis non urna tristique lacinia vel quis neque. Vivamus nisl nibh, lacinia sed egestas et, euismod mollis sem. Maecenas non orci erat, a tincidunt magna.</p>
        </div>
      </section>
    </li>
    <li class="slide">
      <section>
        <div class="caption">
          <header>
            <h1>trade-in service</h1>
          </header>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum et nisi quam, eget cursus augue. Sed id felis non urna tristique lacinia vel quis neque. Vivamus nisl nibh, lacinia sed egestas et, euismod mollis sem. Maecenas non orci erat, a tincidunt magna.</p>
        </div>
      </section>
    </li>
  </ul>
</article> 
```

CSS（.less 语义对不起）

```
 div#service{
    position:relative;
    height:800px;
    width: 100%;
    background:pink;}

article#viewport{
    position:relative;
    height:600px;
    width:100%;
    top:100px;
    background:@yellow;
    overflow:hidden; }
ul#slideshow{
    position:relative;
    overflow:auto;
    height:100%;
    display:inline-block; }

li.slide{
    position:relative;
    height:600px;
    width: 100%;
    zoom: 1;
    display:inline-block;
    background:#ccc;
}
div.caption{width:300px; background:#555;text-align:right;float:right;} 
```

​</p>

附言。为什么当我将 .captions 设置为绝对位置时；它打破了整个互动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:45:22.110

不确定我是否完全理解，但您似乎只是错过`width: 100%`了#slideshow 上的内容。一旦设置好，您的 .captions 也可以与 .captions 一起正常工作`position: absolute`。

[http://jsfiddle.net/ZsuVy/1/](http://jsfiddle.net/ZsuVy/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T21:01:15.560

这是关于您的“幻灯片”的事情 -`ul`将默认为`width: auto`，这意味着它会扩展到其父级的宽度（因为它是一个块元素）。它不会随其内容扩展其宽度，就像它会随其高度一样。

因此，您需要的是一个视口 div - 一个带有`width: 100%`和的 div `overflow: auto`。这将允许滚动和隐藏额外的幻灯片。然后，您需要一个 div ，其中是您拥有`width`的幻灯片数量。这将允许水平放置幻灯片所需的所有空间。`(x * 100)%``x`

此外，您的幻灯片需要`width`等于`(100 / x)%`（向下舍入），其中`x`再次是您拥有的幻灯片数量。这似乎违反直觉，但是如果您考虑一下，它们将成为窗口大小乘以 100% 的 1`x`分`x`之一——这意味着它们将是窗口大小的 100%。

最后，您需要使用`float: left;`而不是`display: inline-block`. 我不确定这是为什么，但这是我让它工作的唯一方法。这对我来说没关系，因为我有点讨厌`inline-block`。

[这是一个工作小提琴](http://jsfiddle.net/4ZzVg/1/)

我不相信有办法用纯 CSS 来做到这一点，而且事先不知道有多少幻灯片。*

# ruby - Ruby if vs end if 行为不同？

> ID：11022800
> 
> 赞同：17
> 
> 时间：2012-06-13T20:27:12.147
> 
> 标签：ruby

为什么这段代码不起作用？

```
b if b = true 
```

错误：`undefined local variable or method `b'`

但这确实：

```
if b = true
    b
end 
```

他们不应该是一样的吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-13T20:39:44.977

这个问题问得好。它与 Ruby 中变量的作用域有关。

这是[Matz 在 Ruby 错误跟踪器上发表的](http://bugs.ruby-lang.org/issues/1141)一篇关于此的帖子：

> 局部变量范围从上到下、从左到右确定。所以在if修饰符的条件下首先赋值的局部变量在左侧if体中是无效的。这是一个规范。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T20:37:59.553

在第一个版本中，一旦`k`被击中，解析器就会呕吐，因为它还没有被看到。

在第二个版本中，`k`它是赋值表达式的一部分，并且被不同地解析。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T20:38:53.143

我不知道原因，但解释器`k`在评估条件之前尝试查找变量的问题。

如果你这样写，就不会出现任何错误，并且可以按预期工作：

```
k = nil
h = {k: 1}
v = k if k = h.delete(:k) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T21:17:16.603

*因为 Ruby 解释器在看到赋值时会创建一个局部变量*

在第二种情况下，它还没有看到赋值，所以在解析表达式时变量不存在。

更准确地说，一个方法首先被解析成一个内部表示，然后，也许代码最终会被调用并实际执行。

局部变量是在该解析过程中*创建的。*这是一个声明的问题，它只是意味着解释器会意识到它们。在有人调用周围的方法之前，它们不会在被赋予空间或值的意义上被创建。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-17T09:29:40.877

你只放了一个'='

尝试使用'=='

然后你会得到错误

在第二个示例中，您将“true”分配给 b。

# java - 生成一个空的 zip 文件 java

> ID：11022801
> 
> 赞同：4
> 
> 时间：2012-06-13T20:27:13.633
> 
> 标签：java, zip

我目前正在编写一个函数，它将创建一个 zip 文件，该文件将用于其他功能。下面是我的函数代码：

```
public void createZip(){

        try{
            String outfile = this.filename + ".zip";
            //input file
            FileInputStream input = new FileInputStream(this.filename);
            //output file
            ZipOutputStream zip = new ZipOutputStream(new FileOutputStream(outfile));
            //name the file inside the zip file
            System.out.println(this.filename);
            zip.putNextEntry(new ZipEntry(this.filename));

            byte[] buffer = new byte[this.BUFFER];
            int len;
            //copy the file to the zip
            while((len= input.read(buffer)) > 0){
                System.out.println(len);
                zip.write(buffer, 0, len);
            }
            zip.closeEntry();
            zip.flush();
            input.close();
            zip.close();
            this.filename += ".zip";
        }
        catch(IOException e){
            e.printStackTrace();
        }

    } 
```

我试图调试，但我找不到这个问题的根源。该函数运行没有任何进一步的问题，但产生它的 zip 文件是一个空的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-13T20:36:02.547

您必须在关闭输出流之前使用[ZipOutputStream#closeEntry()](http://docs.oracle.com/javase/7/docs/api/java/util/zip/ZipOutputStream.html#closeEntry%28%29)关闭条目，否则永远不会确认条目已被完全写入。

此外，ZipEntry 的名称不能是整个路径；即，它应该`dog.png`代替`C:\Users\Admin\Documents\dog.png`. 这个问题会毫无例外地过去，并且会导致文件中的数据被直接压缩到 zip 中，而不是作为压缩文件进入 zip 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-03T07:40:33.813

```
final static byte[] EmptyZip={80,75,05,06,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00};
public static void createEmptyZip(String path){
    try{
        FileOutputStream fos=new FileOutputStream(new File(path));
        fos.write(EmptyZip, 0, 22);
        fos.flush();
        fos.close();
    }catch (FileNotFoundException e){
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T20:37:02.170

好吧，只是想知道如果您不在代码中使用文件名作为参数，为什么要传递它。因为您总是使用this.filename。这让我认为您正在尝试使用您设置为对象状态的名称来命名一个 zip 文件，并且由于您在 ZipEntry 中也使用相同的名称，因此它试图在其中添加相同的 zipper 文件.. 因为 ZipEntry 必须指向一个现有文件，这就是它出现空的原因。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T11:20:38.343

简单的解决方案。`ZipEntry`在没有文件分隔符的情况下创建一个手动目录。

```
zip.putNextEntry(new ZipEntry("LOG" + fileName)); 
```

代替

```
zip.putNextEntry(new ZipEntry(fileName)); 
```

这里`fileName = file.getAbsoluteFile();`

这将首先在 zip 文件中创建 LOG 目录，然后是带有目录路径的文件名。这避免了在 zip 文件中创建初始空目录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T20:30:53.617

尝试在关闭之前使用 zip.flush() 刷新缓冲区，尽管 close 应该刷新缓冲区。

还要验证 this.filename。您有一个同名的局部变量。从不使用局部变量文件名。zip 文件可能被写入到与您预期不同的位置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-13T21:18:11.503

@phillipe 请试试这个

```
 public void createZip(String filename) {
    try {
        //input file
        FileInputStream input = new FileInputStream(filename);
        //output file
        ZipOutputStream zip = new ZipOutputStream(new FileOutputStream(filename + ".zip"));
        //name the file inside the zip file
        zip.putNextEntry(new ZipEntry(filename));

        byte[] buffer = new byte[1024];
        int len;
        //copy the file to the zip
        while((len = input.read(buffer)) > 0) {
            System.out.println();
            zip.write(buffer, 0 , len);
        }
        zip.closeEntry();
        zip.flush();
        zip.close();
        input.close();
        filename += ".zip";
    } catch(IOException e) {
        e.printStackTrace();
    }
} 
```

这些代码创建了一个 zip 文件，这对我来说也很有效。:)

# agile - 什么是障碍，如何处理它们以及 Scrum 的内部改进？

> ID：11022803
> 
> 赞同：1
> 
> 时间：2012-06-13T20:27:42.600
> 
> 标签：agile, scrum

您将什么定义为障碍？我知道 Scrum 会这么说，而障碍会阻止团队发挥其所能做到的最好。所以基本上它可以是一切？但是它变成的神奇路线和内部改进在哪里呢？

例如。我们希望在我们的数据库中拥有更真实的测试数据，这是内部改进还是障碍？作为一个团队，我们可以尝试在 sprint 中直接与其他故事一起解决它，或者我们可以说这是一个内部改进，需要成为一个故事并进入产品 backlog。

在我看来，我们有三个选择： 1\. 将所有内部改进作为待办事项中的故事处理，并让 PO 优先考虑它们。2\. 在 sprint 中与他们一起完成常规故事。3\. 大事以故事和小事的形式出现，我们可以直接在 sprint 中完成，而不会对速度产生太大影响。

你怎么处理这个？我们需要关于如何做到这一点的提示和想法:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T12:28:44.153

**什么是障碍** 障碍是阻碍团队前进的任何事物。这是一个非常开放的类别，可以包括以下内容：

*   物理硬件限制
*   缺少或糟糕的工具
*   个人冲突
*   团队缺少技能
*   缺少个人技能
*   缺乏影响力或权威
*   疾病
*   知识缺失

我们经常关注显而易见的东西：工具和权威，但*更多*时候是阻碍团队前进的无形资产。比如团队凝聚力、知识和经验。

**更真实的测试数据** 不要将改进归类为内部与障碍。我们的目标是将改进嵌入到自然交付过程中。出于这个原因，我的第一个倾向是说所有的障碍和改进都应该在交付的背景下完成。您希望改进反映在交付能力上。我们希望我们的结果能够反映现实。有时，改进工作意味着我们以未来增长的名义暂时降低速度。有时我们甚至以质量的名义永久降低速度。

我建议你找到渐进的方法来达到你提出的最终状态，并在每次接触该区域、每次冲刺和/或每次准备另一次测试运行时实施一点点（假设它需要准备时间——如果没有的话- 极好的！）。

**积压工作的改进** 这是您的选择，您应该与您的 PO 讨论。请理解，虽然 PO 希望从 sprint 中获得高质量和改进的输出，但 backlog 的目的是从*用户的*角度代表有价值的功能/要求，而不是您的。出于这个原因，我会犹豫是否将改进项目放在待办事项上。您应该始终对每个积压项目进行改进。您的 PO 也可能不愿用他们认为应该作为正常交付的一部分完成的事情来填补积压工作。将其视为一个信号，即这些东西对用户没有直接价值，而是以可持续的速度提供高质量价值的成本。

# php - 在工作服务器上添加了反斜杠，但在本地没有

> ID：11022806
> 
> 赞同：-1
> 
> 时间：2012-06-13T20:27:46.760
> 
> 标签：php

> **可能重复：**
> [为什么我的 ' 字符在 POST 到我的服务器时变成了 \'？](https://stackoverflow.com/questions/10837148/why-are-my-characters-turned-into-when-posted-to-my-server)

只需将我的网站上线即可。由于某些原因，添加了反斜杠 ' 符号，即使我只是在插入到 db. 这只发生在工作服务器上，而不是我的本地服务器上。我应该去哪里看？我不认为这是脚本问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:29:25.427

试着看看这个： http: [//php.net/manual/en/security.magicquotes.php](http://php.net/manual/en/security.magicquotes.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T20:29:39.717

确保您[关闭了魔术引号](http://php.net/manual/en/security.magicquotes.php)。

签出：**[禁用魔术行情](http://www.php.net/manual/en/security.magicquotes.disabling.php)**

# hadoop - Hadoop：没有这样的方法异常

> ID：11022812
> 
> 赞同：9
> 
> 时间：2012-06-13T20:28:22.957
> 
> 标签：hadoop, mapreduce

我写了一个 MapReduce 程序，代码如下：

```
import java.io.IOException;
import java.util.Iterator;
import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.*;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.conf.*;
import org.apache.hadoop.io.*;
import org.apache.hadoop.mapred.Reporter;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.input.TextInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
import org.apache.hadoop.mapreduce.lib.output.TextOutputFormat;

public class MaxTemperature {

public class MaxTemperatureMapper extends Mapper <LongWritable, Text, Text, IntWritable>{
    private static final int MISSING = 9999;

    public void map(LongWritable key, Text Value, Context context, Reporter reporter) throws IOException, InterruptedException{
        String line = Value.toString();
        String year = line.substring(15,19);
        int airTemperature;
        if(line.charAt(87)=='+')
            airTemperature = Integer.parseInt(line.substring(88,92));
        else
            airTemperature = Integer.parseInt(line.substring(87,91));
        String quality = line.substring(92,93);
        if(airTemperature!=MISSING && quality.matches("[01459]"))
            context.write(new Text(year), new IntWritable(airTemperature));
    }
}

public class MaxTemperatureReducer extends Reducer<Text, IntWritable, Text, IntWritable>{
    public void reduce (Text Key, Iterator<IntWritable> Values, Context context, Reporter reporter) throws IOException, InterruptedException{

        int maxValue = Integer.MIN_VALUE;
        while(Values.hasNext())
            maxValue = Math.max(maxValue, Values.next().get());
        context.write(Key, new IntWritable(maxValue));

    }
}

public static void main(String[] args) throws Exception {
    if(args.length!=2){
        System.err.println("Usage: WeatherTemperature  <input path> <output path>");
        System.exit(-1);
    }
    Configuration conf = new Configuration();
    Job job = new Job(conf, "Maximum Temperature Calculator");
    job.setJarByClass(MaxTemperature.class);

    job.setOutputKeyClass(Text.class);
    job.setOutputValueClass(IntWritable.class);

    job.setMapperClass(MaxTemperatureMapper.class);
    job.setReducerClass(MaxTemperatureReducer.class);

//  job.setInputFormatClass(TextInputFormat.class);
    //job.setOutputFormatClass(TextOutputFormat.class);
    FileInputFormat.addInputPath(job, new Path(args[0]));
    FileOutputFormat.setOutputPath(job, new Path(args[1]));
    job.waitForCompletion(true);
    }
} 
```

我使用以下命令运行该程序的 .jar：

```
hadoop jar weather.jar MaxTemperature input output 
```

我收到以下错误：

```
12/06/13 00:52:05 INFO mapred.JobClient: Task Id :     attempt_201206121354_0007_m_000000_0, Status : FAILED
java.lang.RuntimeException: java.lang.NoSuchMethodException:      MaxTemperature$MaxTemperatureMapper.<init>()
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:115)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:602)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:323)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:270)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1177)
    at org.apache.hadoop.mapred.Child.main(Child.java:264)
Caused by: java.lang.NoSuchMethodException: MaxTemperature$MaxTemperatureMapper.<init>()
    at java.lang.Class.getConstructor0(Class.java:2706)
    at java.lang.Class.getDeclaredConstructor(Class.java:1985)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:109)
    ... 7 more 
```

这个错误是什么意思？我做错了什么，我该如何纠正？谢谢！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-06-13T20:39:48.667

您的 mapper 和 reducer 类需要定义为静态的，否则编译会创建一个带有单个参数（父`MaxTemperature`类）的构造函数。因此，现在没有默认构造函数。

```
public static class MaxTemperatureMapper extends Mapper<....

public static class MaxTemperatureReducer extends Reducer<.... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:32:42.490

我猜它`Mapper`没有默认构造函数，但这是您`MaxTemperatureMapper`拥有的唯一构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-12T06:40:06.057

我在自定义for中`scala`使用默认构造函数修复了类似错误`KEY``Mapper``Reducer`

## 问题

```
15/05/12 01:07:57 WARN mapred.LocalJobRunner: job_local1713686765_0001
java.lang.Exception: java.io.IOException: Initialization of all the collectors failed. Error in last collector was :java.lang.NoSuchMethodException: IntPair.<init>()
    at org.apache.hadoop.mapred.LocalJobRunner$Job.runTasks(LocalJobRunner.java:462)
    at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:522)
Caused by: java.io.IOException: Initialization of all the collectors failed. Error in last collector was :java.lang.NoSuchMethodException: IntPair.<init>()
    at org.apache.hadoop.mapred.MapTask.createSortingCollector(MapTask.java:414)
    at org.apache.hadoop.mapred.MapTask.access$100(MapTask.java:81)
    at org.apache.hadoop.mapred.MapTask$NewOutputCollector.<init>(MapTask.java:698)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:770)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:341)
    at org.apache.hadoop.mapred.LocalJobRunner$Job$MapTaskRunnable.run(LocalJobRunner.java:243)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

## 解决方案 - 默认构造函数

```
class IntPair (first : IntWritable, second : IntWritable) extends WritableComparable[IntPair] {

      def this() = this(first = new IntWritable(), second = new IntWritable())

     def getFirst () : IntWritable = {
         first
     }

     def getSecond () : IntWritable = {
         second
     }

} 
```

# php - 在 PHP 中引用数组值

> ID：11022816
> 
> 赞同：-5
> 
> 时间：2012-06-13T20:28:50.217
> 
> 标签：php

我想在drupal中编程，但这基本上是一个php问题：如果我有以下数组结构：

```
$node = 'field_slot_11_1' => 
array (
0 => 
array (
  'value' => 'sdaad',
),
), 
```

我如何引用该值？我试过 $node->field_slot_11_1[0]['value'] 但它不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T20:30:39.053

改用这个：

```
$node = array(
    'field_slot_11_1' => array(
        0 => array(
            'value' => 'sdaad',
        ),
    ),
)
...
$node['field_slot_11_1'][0]['value'] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T20:31:16.447

你的语法有点不对劲。对此进行更正：

```
<?php
  $node = array( 'field_slot_11_1' => array ( 0 => array ( 'value' => 'sdaad' ) ) );
  echo $node[ 'field_slot_11_1' ][ 0 ][ 'value' ];
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:33:15.917

您的 $node 变量格式错误。它既不是正确的对象，也不是正确的数组。如果你把它做成这样的数组：

```
$node = array('field_slot_11_1' => 
    array (0 => 
        array ('value' => 'sdaad',
        ),
    ),
); 
```

然后你可以像这样引用它：

```
$node['field_slot_11_1'][0]['value']; 
```

# jquery-mobile - 如何使复选框成为 jquery-mobile split-con 列表的列表项的一部分

> ID：11022820
> 
> 赞同：1
> 
> 时间：2012-06-13T20:29:01.777
> 
> 标签：jquery-mobile

我正在尝试构建一个具有复选框和图标的列表，因此我决定使用拆分按钮列表。现在我对列表有 2 个问题：

1.  复选框出现在列表项中的一个框中，我希望它是“扁平的”，即周围没有框
2.  单击会导致整个框变成蓝色，我只想勾选复选框

你能帮我解决这个问题吗？

我在这里发布了一些示例代码：http: [//jsfiddle.net/JY6EV/2/](http://jsfiddle.net/JY6EV/2/)

//edit 2012/06/14 似乎在列表项上有一个复选框总是嵌套一个按钮。作为一种工作方法，我可以添加一个图标（data-icon="check"），但这也不起作用..有什么建议吗？

PS：我想模仿 iPad/iPhone 上的 gmail 列表： ![iOS 上的 Google 邮件列表](../Images/76e782983057e8c6cb2fb2fd60b81530.png) 使用我的（伪造的）jquery 移动列表：![gmail的jquery模仿](../Images/a650a29c5256fa38978480951d48aff5.png)

到目前为止我尝试了什么：http: [//jsfiddle.net/JY6EV/8/](http://jsfiddle.net/JY6EV/8/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-23T19:05:39.833

我知道这是一个旧线程，但我最近不得不这样做。由于不存在第二张图像的解决方案，因此我自己制作了它。

清单项目：

```
<li>
    <a href="#" class="custom">
        <input type="checkbox" name="cb1" id="cb1" />
        <label for="cb1">checkbox 1</label>
    </a>
    <a href="#"></a>
</li> 
```

的CSS：

```
.custom {
     padding: 0;
}

.custom > div {
    margin: 0;
}

.custom > div > label {
    border-radius: 0;
    border: 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T03:45:32.753

这行得通吗？

*   [http://jsfiddle.net/JY6EV/10/](http://jsfiddle.net/JY6EV/10/)

使用 Gris 布局进行定位，但您仍需要调整外观

# msys - 如何从 MSYS 执行 linux 二进制文件

> ID：11022821
> 
> 赞同：1
> 
> 时间：2012-06-13T20:29:03.397
> 
> 标签：msys

我想尝试在 Windows 上为 *nux 的源代码分发的程序。这是一个简单的程序，有几个 C 源文件和头文件

1.  我有 Mingw/Msys，首先我尝试通过运行在那里编译它`make`，但不幸的是，根据谷歌搜索，我得到了一个模糊的错误`(.text+0x175): undefined reference to 'strsep'`，这可能表明 autotools 或类似的问题，但这就是我能得到的全部

2.  正如我提到它是一个简单的程序，我也尝试用 VS2008 编译它，直到我发现它使用 unix 头文件来解析命令行参数，所以我也无能为力

3.  我启动了我的 Ubuntu 笔记本电脑并在第二次编译了该程序，并对其进行了很好的测试，然后我将二进制文件复制到了我的 Windows Msys 文件夹中。再次没有运气，因为文件无法被执行（当然在 Msys 提示下） - 它没有执行标志，并且`chmod`Msys 有一个“功能”，使得`chmod +x`不可用

* * *

**更新：**

这是我在尝试编译时从 msys 提示符得到的错误：

```
f77_diagram.c: In function 'handle_goto':
f77_diagram.c:57:4: warning: implicit declaration of function 'strsep' [-Wimplicit-function-declaration]
[...]
gcc  -o f77_diagram block.o do_loop.o f77_diagram.o if.o label.o \
                                  links.o parse_fortran.o
f77_diagram.o:f77_diagram.c:(.text+0x175): undefined reference to `strsep'
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:35:21.943

这意味着函数/变量 strsep 未正确初始化。很可能是链接错误。这可能意味着您没有安装依赖项。您需要发布有关该错误的更多信息。

顺便说一句，你不能在 Windows 上运行 linux 二进制文件。

根据您的错误判断，您的编译器似乎不支持 strsep 函数。要解决这个问题，您可能必须编写自己的代码，如下所示：

```
char *strsep(char **from, const char *delim) {
    char *s, *dp, *ret;

    if ((s = *from) == NULL)
        return NULL;

    ret = s;
    while (*s != '\0') {
        /* loop until the end of s, checking against each delimiting character,
         * if we find a delimiter set **s to '\0' and return our previous token
         * to the user. */
        dp = (char *)delim;
        while (*dp != '\0') {
            if (*s == *dp) {
                *s = '\0';
                *from = s + 1;
                return ret;
            }
            dp++;
        }
        s++;
    }
    /* end of string case */
    *from = NULL;
    return ret;
} 
```

这是您必须经历的过程：

1- 在 src 目录中找到文件 f77_diagram.c。

`#include`2- 在语句之后复制并粘贴上面的代码。

3- 返回到主 make 目录中的命令 shell。

4-重新运行`./configure`

5-重新运行`make`

如果这不起作用，您可以尝试其他一些方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-09T19:03:23.993

MSYS 为 Windows 提供了一个类似 Linux 的构建环境。但是，Linux 二进制文件使用 ELF 或 A.OUT 格式，而不是 EXE 格式。由于 Windows 没有像 WINE 这样的东西，因此必须为 Windows 重新编译 Linux 二进制文件。

# xml - QNetworkAccessManager 和 XML 回复

> ID：11022822
> 
> 赞同：0
> 
> 时间：2012-06-13T20:29:05.893
> 
> 标签：xml, qt, qnetworkaccessmanager

我试图使用 QNetworkAccessmanager 向 localhost/conductor/api/provider_accounts.xml 发送请求，但问题是当我用浏览器打开它时，我得到了适当的输出，但是当我对 QNetworkAccessmanager 做同样的事情时，我什么也没有得到一点也不。这是我的代码

```
 void ServiceProvider::replyFinished(QNetworkReply * reply)
 {
 qDebug()<<reply->readAll();
 QString data=(QString)reply->readAll();
 qDebug()<<data;
 QXmlStreamReader xml(data);
 QXmlStreamAttributes attrib;
    while(!xml.atEnd()){
        xml.readNextStartElement();
        if(xml.name()=="name" && !xml.isEndElement()){
            attrib=xml.attributes();
            QString name=attrib.value("name").toString();
            qDebug()<<name;
            }
    }
}

void ServiceProvider::pushImage()
{
manager = new QNetworkAccessManager(this);
manager->get(QNetworkRequest(QUrl("https://localhost/conductor   
/api/provider_accounts.xml")));
connect(manager, SIGNAL(finished(QNetworkReply*)),
this, SLOT(replyFinished(QNetworkReply*)));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T15:10:45.260

您无法阅读两次回复：

```
qDebug()<<reply->readAll();
QString data=(QString)reply->readAll(); 
```

上面的`qDebug()`行将消耗所有数据。您必须进行的第二次调用`readAll()`也是不正确的，因为它返回一个`QByteArray`. 您不能`QString`像上面那样简单地将其转换为并期望它起作用。您需要检查回复的编码并使用适当的转换函数，例如`QString::fromUtf8(reply->readAll())`.

# javascript - 淘汰赛：未捕获的类型错误：对象# has no method 'newCommentText' I have code like this in my view model: function ChatListViewModel(chats) { var self = this; self.newCommentText = ko.observable(); self.addComment = f 问问题 问问题 2012-06-13T20:29:32.223 5425 次 This question shows research effort; it is useful and clear 4 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have code like this in my view model: function ChatListViewModel(chats) { var self = this; self.newCommentText = ko.observable(); self.addComment = function(chat) { var newComment = { CourseItemDescription: this.newCommentText() }; chat.CommentList.push(newComment); self.newCommentText(""); }; } ko.applyBindings(new ChatListViewModel(initialData)); but I get this error when I try to add a new comment: any Ideas what I'm doing wrong? I looked at some knockout samples on the knockoutjs.com webpage and this is how they were doing it. Try this. self.addComment = function(chat) { var newComment = { CourseItemDescription: self.newCommentText() }; chat.CommentList.push(newComment); self.newCommentText(""); }; Your this variable is not what you expect. Hope this helps. javascriptknockout.js 4 1 回答 1 This answer is useful 5 尝试这个。 self.addComment = function(chat) { var newComment = { CourseItemDescription: self.newCommentText() }; chat.CommentList.push(newComment); self.newCommentText(""); }; 您的 this 变量不是您所期望的。 希望这可以帮助。 于 2012-06-13T20:50:07.317 回答 Related 1 java - 在 Java 应用程序中引用 JAXB 生成的类 1 objective-c - 以前工作的代码仅在 iOS5 中作为具有 EXC_BAD_ACCESS 代码 = 1 的静态库崩溃 1 javascript - 使用 perl 执行所有 JavaScript 页面 1 c# - ObjectQuery 上的通用包含实际上不包含任何内容 2 sql - SQL - 检查一个表中的所有列是否也存在于另一个表中 2 vba - 从列表或数组中找出不包括某些元素的最小值 2 html - CSS Flex 项之间的静态填充 2 android - 位置有时有时不 1 facebook - 如何阻止其他人对我的帖子发表评论和“喜欢”我的帖子？ 2 c++ - 为最终的未来自定义内存分配器做准备 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：11022829
> 
> 赞同：4
> 
> 时间：
> 
> 标签：javascript, knockout.js

I have code like this in my view model:

```
function ChatListViewModel(chats) {
    var self = this;

    self.newCommentText = ko.observable();

    self.addComment = function(chat) {
      var newComment = { CourseItemDescription: this.newCommentText() };
      chat.CommentList.push(newComment);
      self.newCommentText("");       
    };

}

ko.applyBindings(new ChatListViewModel(initialData)); 
```

but I get this error when I try to add a new comment:

![enter image description here](../Images/e093a52017b21fa311c5e70ef8beb13a.png)

any Ideas what I'm doing wrong? I looked at some knockout samples on the knockoutjs.com webpage and this is how they were doing it.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T20:50:07.317

尝试这个。

```
self.addComment = function(chat) {
   var newComment = { CourseItemDescription: self.newCommentText() };
   chat.CommentList.push(newComment);
   self.newCommentText("");       
}; 
```

您的 this 变量不是您所期望的。

希望这可以帮助。

# tfs - TFS 分支推荐

> ID：11022832
> 
> 赞同：7
> 
> 时间：2012-06-13T20:29:35.347
> 
> 标签：tfs, branching-and-merging

我有一个名为“框架”的解决方案，它是用于我的业务逻辑和数据事务的 C# 程序集。

我有 4 个使用框架的应用程序、1 个网站、1 个控制台应用程序和 3 个其他类型的应用程序。

```
$/TeamProject
    /Framework
        /Dev
        /Main
        /Release
    /WebApp
        /Dev
        /Main
        /Release
    /WCFApp
        /Dev
        /Main
        /Release 
```

我将所有这些都放在一个团队项目中，每个程序集/应用程序都在其自己的文件夹下。

我想为共享框架程序集的每个应用程序使用分支功能，但我不知道将应用程序与框架一起分支的最佳方式是什么？

有什么建议么？

我知道分支和合并是如何工作的，但所有示例仅演示分支包含在 1 个文件夹中的所有内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T20:53:13.497

根据代表您的源代码控制目录的图片，我将做出以下假设：

```
$/团队项目
   /框架
   /安慰
   /网络
   /ETC。

```

您首先需要做的是创建一个名为`Main`in的文件夹`$/TeamProject`（这将是您的 Main - aka trunk - 分支）并将所有顶级文件夹移动到其中。

那么我们有：

```
$/团队项目
   /主要的
     /框架
     /安慰
     /网络
     /ETC。

```

现在您需要转换`Main`为分支，您可以通过右键单击`Main`文件夹并选择“转换为分支”来执行此操作。TFS 现在将允许您分支`$/TeamProject/Main`到`$/TeamProject/ConsoleV2`（例如）并处理控制台 V2 的功能。如果需要，您可以在此分支中修改控制台应用程序和框架。当这项工作完成后，您可以将更改反向集成（合并）回`Main`.

请记住从您的功能分支继续执行前向集成合并（向下合并）`Main`并解决任何冲突以保持代码库同步。

通过采用这种方法，您可以在单个原子签入中修改任何产品的任何部分，例如，您更改框架上的 API 添加新的强制参数到方法，您可以在所有应用程序中更改它同时，当你 RI 合并到时，`Main`一切都会更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T22:37:36.993

据我了解，您的主要问题是“对依赖于框架的应用程序进行分支的最佳分支结构是什么？” 如果您总是一起构建和版本/发布它们，那么像 DaveShaw 所描述的那样将它们全部分支在一起会更简单且成本更低；但是，如果它们中的每一个都是由不同的团队开发的，有不同的发布时间表，有不同的版本等等……那么您将希望在每个分支下创建一个 MAIN 分支。在这种情况下，还应该清楚谁拥有对框架的更改。控制签入访问权限通常是一个好主意，只有那些需要共享项目（如 Framework）的人才能访问。

如果后一种情况属实，那么我认为您当前的图形处理得很好，但我会做一个改变；在层次结构中将您的版本与 MAIN 分支保持在同一级别，以便相对路径保持相同以进行引用；这将简化您的工作区映射：

```
$/TeamProject
    /Framework
        /Dev
        /Main
        /Release1
        /Release2
        /Release3
        ...
    /WebApp
        /Dev
        /Main
        /Release
            /Release1
            /Release2
            /Release3
            ...
    /WCFApp
    ... 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-13T20:39:13.177

如果您想对单个项目进行分支和合并，在 TFS 下实现这一目标的唯一方法是为解决方案中的每个项目创建一个单独的 TFS 项目。希望这是有道理的。一旦你这样做了，你就可以将每个项目的代码分支到你的工作目录中。

不久前，我们将代码从 VSS 迁移到了 TFS。那时，我们不得不决定将所有代码放入 1 个 TFS 项目中，或者将它们拆分出来。因此，我们有一个网站、一个业务库（由网站和其他应用程序使用）、一个数据层。我们为库、网站和数据层项目创建了一个单独的 TFS 项目。每个项目都会有一个主干分支。每个需要最新版本的人都会从主干中分支他们自己的副本并合并回来。

希望有帮助。

# android - 根据Handler句柄消息启动一个intent

> ID：11022837
> 
> 赞同：1
> 
> 时间：2012-06-13T20:29:53.020
> 
> 标签：android, multithreading, android-activity, handler, message

我有一个登录到网络服务的应用程序。单击登录按钮时，我会启动一个新线程，并在设备与服务器通信时显示进度对话框。根据尝试的成功或失败，我向 1 - 成功和 -1 - 失败的处理程序发送消息。但是如何根据此消息创建和启动新意图？或者我应该如何处理这种情况。这是我的登录活动代码：

```
public class Login extends Activity implements OnClickListener {

private static final int DIALOG = 0;
private static String TAG="LoginActivity";
private ProgressDialog progressDialog;

private final Handler handler =  new Handler() {
    public void handleMessage(Message msg) {

        int state = msg.arg1;
        if (state != 0)
        {
            Log.i(TAG, "dialog dismissed, message received "+state);
            dismissDialog(DIALOG);
        }

    }
};

@Override
protected void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.login);

    View loginButton = findViewById(R.id.login_button);
    loginButton.setOnClickListener(this);

}

public void onClick(View v) {

    switch (v.getId()) {
    case R.id.login_button:
        Log.i(TAG,"login button");
        showDialog(DIALOG);

        Intent i = new Intent(this, PTVActivity.class);
        startActivity(i);
        break;

    }
}

protected Dialog onCreateDialog(int id)
{
    switch(id) {
    case DIALOG:
        progressDialog = new ProgressDialog(Login.this);
        progressDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
        progressDialog.setMessage(getString(R.string.login_progress));
        return progressDialog;
    default:
        return null;
    }
}

@Override
protected void onPrepareDialog(int id, Dialog dialog) {
    switch(id) {
    case DIALOG:

        EditText nameText=(EditText)findViewById(R.id.login_name);
        EditText pwText=(EditText)findViewById(R.id.password);
        String name = nameText.getText().toString();
        String pw = pwText.getText().toString();

        CommunicateServer communicate= new CommunicateServer(name,pw,handler);
        communicate.run();
    }

}

} 
```

这是我的 CommunicateServer 类的 run() 方法：

```
@Override
public void run() {

    Message msg = handler.obtainMessage();
    if (login()==true)msg.arg1 = 1;
    else msg.arg1 = -1;
    handler.sendMessage(msg);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:57:48.237

要创建一个新的 Intent 并开始一项活动，您必须执行以下操作：

```
Intent intent = new Intent(Login.this, anotherActivity.class);
startActivity(intent); 
```

* * *

处理此类工作的最简单方法是使用 AsyncTask [（示例）](https://stackoverflow.com/questions/9671546/asynctask-android-example)：

**在您的情况下，您必须在 AsyncTask 的onPreExecute()**方法中显示一个进度对话框。

在**doInBackground(..)**中，您将调用服务器进行身份验证。您必须从 doInBackground(..) 方法返回状态（1 或 -1）。

**最后，您将在onPostExecute(..)**方法中获得状态值（1 或 -1）作为参数。在这里，您将根据状态做出决定。如果它是 1，你将创建一个新的意图来打开一个 Activity。您还应该关闭此方法中的进度对话框。

# html - 将滚动添加到表中除第一行之外的所有行

> ID：11022838
> 
> 赞同：1
> 
> 时间：2012-06-13T20:30:11.787
> 
> 标签：html, css

我有一个页面： 1 - 标题。2 - 表。3 - 页脚。

该表有**第一行，就像每一列的标题**。之后，所有数据都按行和列排序。

我需要滚动除顶部第一行之外的所有行。我试了试，头疼。

这是开始位置：[Demo](http://www.centerwow.com/stackoverflow/a/temp.html)

这是我的尝试之一：[Demo1](http://www.centerwow.com/stackoverflow/temp.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T01:57:50.933

我可以想到一些解决方案..

一种是使用两个表格，将标题拉出并将表格的下部放在可以滚动的 div 中。

第二个可能是使用航点（http://imakewebthings.com/jquery-waypoints/）来锁定表头并用 tr:first-child 定位它

第三种可能是使用图像作为标题并在它自己的 div 标签中滚动内容。

（使用 position:fixed 将使某些内容锁定在页面上）

希望这些帮助:)

# ruby-on-rails - 将 Rspec 默认 GET 请求格式设置为 JSON

> ID：11022839
> 
> 赞同：52
> 
> 时间：2012-06-13T20:30:14.933
> 
> 标签：ruby-on-rails, rspec, functional-testing

我正在使用 Rspec 为我的控制器进行功能测试。我已将路由器中的默认响应格式设置为 JSON，因此每个没有后缀的请求都将返回 JSON。

现在在 rspec 中，当我尝试时出现错误（406）

```
get :index 
```

我需要去做

```
get :index, :format => :json 
```

现在因为我的 API 主要支持 JSON，所以必须为每个请求指定 JSON 格式是非常多余的。

我可以以某种方式将它设置为我所有的 GET 请求的默认值吗？（或所有请求）

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-05-05T08:02:49.640

```
before :each do
  request.env["HTTP_ACCEPT"] = 'application/json'
end 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-01-31T10:50:32.573

把这个放在`spec/support`：

```
require 'active_support/concern'

module DefaultParams
  extend ActiveSupport::Concern

  def process_with_default_params(action, parameters, session, flash, method)
    process_without_default_params(action, default_params.merge(parameters || {}), session, flash, method)
  end

  included do
    let(:default_params) { {} }
    alias_method_chain :process, :default_params
  end
end

RSpec.configure do |config|
  config.include(DefaultParams, :type => :controller)
end 
```

然后简单地覆盖`default_params`：

```
describe FooController do
    let(:default_params) { {format: :json} }
    ...
end 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-01-15T16:57:05.807

以下适用于我*rspec 3*：

```
before :each do
  request.headers["accept"] = 'application/json'
end 
```

这设置`HTTP_ACCEPT`.

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-09-08T19:57:11.803

这是一个解决方案

1.  适用于请求规格，
2.  适用于 Rails 5，以及
3.  不涉及 Rails 的私有 API（如`process`）。

这是 RSpec 配置：

```
module DefaultFormat
  extend ActiveSupport::Concern

  included do
    let(:default_format) { 'application/json' }
    prepend RequestHelpersCustomized
  end

  module RequestHelpersCustomized
    l = lambda do |path, **kwarg|
      kwarg[:headers] = {accept: default_format}.merge(kwarg[:headers] || {})
      super(path, **kwarg)
    end
    %w(get post patch put delete).each do |method|
      define_method(method, l)
    end
  end
end

RSpec.configure do |config|
  config.include DefaultFormat, type: :request
end 
```

已验证

```
describe 'the response format', type: :request do
  it 'can be overridden in request' do
    get some_path, headers: {accept: 'text/plain'}
    expect(response.content_type).to eq('text/plain')
  end

  context 'with default format set as HTML' do
    let(:default_format) { 'text/html' }

    it 'is HTML in the context' do
      get some_path
      expect(response.content_type).to eq('text/html')
    end
  end
end 
```

FWIW，可以放置 RSpec 配置：

1.  直接在`spec/spec_helper.rb`. 不建议这样做；即使在`lib/`.

2.  直接在`spec/rails_helper.rb`.

3.  （我最喜欢的）在`spec/support/default_format.rb`，并被明确`spec/rails_helper.rb`加载

    ```
    require 'support/default_format' 
    ```

4.  在`spec/support`, 并被加载

    ```
    Dir[Rails.root.join('spec/support/**/*.rb')].each { |f| require f } 
    ```

    它将所有文件加载到`spec/support`.

这个解决方案的灵感来自[knoopx's answer](https://stackoverflow.com/questions/11022839/set-rspec-default-get-request-format-to-json/#14623960)。他的解决方案不适用于请求规范，并且[`alias_method_chain`](http://api.rubyonrails.org/v5.0.0/classes/Module.html#method-i-alias_method_chain)已被弃用，取而代之的是[`Module#prepend`](http://ruby-doc.org/core-2.3.1/Module.html#method-i-prepend).

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-07-30T17:58:42.043

在 RSpec 3 中，您需要使 JSON 测试成为请求规范，以便呈现视图。这是我使用的：

```
# spec/requests/companies_spec.rb
require 'rails_helper'

RSpec.describe "Companies", :type => :request do
  let(:valid_session) { {} }

  describe "JSON" do
    it "serves multiple companies as JSON" do
      FactoryGirl.create_list(:company, 3)
      get 'companies', { :format => :json }, valid_session
      expect(response.status).to be(200)
      expect(JSON.parse(response.body).length).to eq(3) 
    end

    it "serves JSON with correct name field" do
      company = FactoryGirl.create(:company, name: "Jane Doe")
      get 'companies/' + company.to_param, { :format => :json }, valid_session
      expect(response.status).to be(200)
      expect(JSON.parse(response.body)['name']).to eq("Jane Doe")
    end
  end
end 
```

至于设置所有测试的格式，我喜欢这个其他答案的方法：[https ://stackoverflow.com/a/14623960/1935918](https://stackoverflow.com/a/14623960/1935918)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-10-31T14:29:35.953

也许您可以将第一个答案添加到 spec/spec_helper 或 spec/rails_helper 中：

```
config.before(:each) do
  request.env["HTTP_ACCEPT"] = 'application/json' if defined? request
end 
```

如果在模型测试中（或任何不存在的请求方法上下文），则此代码将忽略。它适用于 rspec 3.1.7 和 rails 4.1.0 一般而言，它应该适用于所有 rails 4 版本。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-02-12T21:49:56.240

运行 Rails 5 和 Rspec 3.5 我必须设置标题来完成此操作。

```
post '/users', {'body' => 'params'}, {'ACCEPT' => 'application/json'} 
```

Thi 与[文档](https://www.relishapp.com/rspec/rspec-rails/docs/request-specs/request-spec#requesting-a-json-response)中的示例相匹配：

```
require "rails_helper"

RSpec.describe "Widget management", :type => :request do
  it "creates a Widget" do
    headers = {
      "ACCEPT" => "application/json",     # This is what Rails 4 accepts
      "HTTP_ACCEPT" => "application/json" # This is what Rails 3 accepts
    }
    post "/widgets", { :widget => {:name => "My Widget"} }, headers

    expect(response.content_type).to eq("application/json")
    expect(response).to have_http_status(:created)
  end
end 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-08-19T19:50:39.620

根据[Rspec docs](https://relishapp.com/rspec/rspec-rails/docs/request-specs/request-spec#requesting-a-json-response)，支持的方法是通过标题：

```
require "rails_helper"

RSpec.describe "Widget management", :type => :request do

  it "creates a Widget" do
    headers = {
      "ACCEPT" => "application/json",      # This is what Rails 4 and 5 accepts
      "HTTP_ACCEPT" => "application/json", # This is what Rails 3 accepts
    }
    post "/widgets", :params => { :widget => {:name => "My Widget"} }, :headers => headers

    expect(response.content_type).to eq("application/json")
    expect(response).to have_http_status(:created)
  end

end 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-09-09T08:54:13.357

对于那些使用请求测试的人，我发现最简单的方法是覆盖`#process`方法`ActionDispatch::Integration::Session`并将默认`as`参数设置为`:json`如下所示：

```
module DefaultAsForProcess
  def process(method, path, params: nil, headers: nil, env: nil, xhr: false, as: :json)
    super
  end
end

ActionDispatch::Integration::Session.prepend(DefaultAsForProcess) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-17T17:35:15.223

不确定这是否适用于这种特定情况。但我特别需要的是能够将`params`哈希传递给该`post`方法。大多数解决方案似乎都是 for`rspec 3`和 up，并提到添加第三个参数，如下所示：

```
post '/post_path', params: params_hash, :format => 'json' 
```

（或类似的，`:format => 'json'`位有所不同）

**但这些都没有奏效。**控制器会收到一个类似于: 的散列`{params: => { ... }}`，带有不需要的`params:`密钥。

**有效的（使用 rails 3 和 rspec 2）是：**

```
post '/post_path', params_hash.merge({:format => 'json'}) 
```

另请查看此相关帖子，我从中获得了解决方案：[使用 Rspec，如何在 Rails 3.0.11 中测试我的控制器的 JSON 格式？](https://stackoverflow.com/questions/9576756/using-rspec-how-do-i-test-the-json-format-of-my-controller-in-rails-3-0-11)

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2012-07-20T17:06:57.477

[为什么 RSpec 的方法“get”、“post”、“put”、“delete”不能在 gem（或 Rails 外部）的控制器规范中工作？](https://stackoverflow.com/questions/2543885/why-dont-rspecs-methods-get-post-put-delete-work-in-a-controller-s)

[根据这个问题，您可以尝试从https://github.com/rails/rails/blob/32395899d7c97f69b508b7d7f9b7711f28586679/actionpack/lib/action_controller/test_case.rb](https://github.com/rails/rails/blob/32395899d7c97f69b508b7d7f9b7711f28586679/actionpack/lib/action_controller/test_case.rb)在 ActionController::TestCase 中重新定义 process() 。

这是我的解决方法。

```
describe FooController do
    let(:defaults) { {format: :json} }

    context 'GET index' do
        let(:params) { defaults }
        before :each do
            get :index, params
        end

        # ...
    end

    context 'POST create' do
        let(:params) { defaults.merge({ name: 'bar' }) }
        before :each do
            post :create, params
        end

        # ...
    end
end 
```

# database - 寻找使用 VB.net 查询远程 Access 数据库的更好解决方案

> ID：11022841
> 
> 赞同：0
> 
> 时间：2012-06-13T20:30:20.240
> 
> 标签：database, vb.net, networking, linked-server

请告诉我查询远程 Access 数据库有更好的解决方案！

我们目前正在使用它，因为到目前为止我们未能连接 sp_linkedserver。我觉得这是一个可怕的 hack，我想一劳永逸地完成整个网络映射业务！

```
 'This is for access 2007
    'DataBase on Local Machine
    '*************************************************************************************************
    'Before a conneciton is made this code sends the credentials to the remote path.
    Dim objNetwork As Object
    objNetwork = Microsoft.VisualBasic.CreateObject("WScript.Network")
    'this line below deletes the drive if there is one so that a correct mapped drive can be created
    'objNetwork.RemoveNetworkDrive("W:")
    Dim DriveLetter = "W:" ' *** This drive needs to be deleted after it is created see the end of this sub for deletion
    Dim RemotePath = "\\volume10\pickles\toads\rocks\sheepy\almostTodb\behindTheScenes"
    Dim UserID = "sysama01\starUser"
    Dim UserPWD = "secretPass"
    objNetwork.MapNetworkDrive(DriveLetter, RemotePath, False, UserID, UserPWD)
    'Syntax()
    '****.MapNetworkDrive(strLocalDrive, strRemoteShare, [persistent], [strUser], [strPassword])
    'Options:
    'strLocalDrive  : The drive letter (e.g. L:)
    'strRemoteShare : The UNC path to the remote drive \\MyServer\MyPrinter
    '(String value)
    'persistent     : True/False - store the mapping persistently in the users profile
    'default = false
    'strUser        :  The user name. (Optional)
    'strPassword    :  The password. (Optional)
    ' Location for code http://ss64.com/vb/drivemap.html
    '*************************************************************************************************
    'DataBase on Network Drive
    objConn = New OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=W:\SuperDeliciousFoodDB.accdb;Jet OLEDB:Database Password=databasePasswordHere")
    'DataBase on Network Drive
    objConn.Open()
    objCmd = New OleDbCommand("SELECT * from pancakeTable, objConn)

    objReader = objCmd.ExecuteReader
...
'Do more codestuffs here
objNetwork.RemoveNetworkDrive("W:") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T03:27:31.030

我建议将[数据迁移到 SQL Server 上](http://www.databasejournal.com/features/msaccess/migrating-access-databases-to-sql-server.html)。如果您使用链接表选项，您可以继续使用现有 Access 数据库中的表单、报表和查询，同时仍然能够从尽可能多的连接远程查询数据。

# xcode - CGpoint 到 NSMutableArray 中的 CCmenuItem

> ID：11022842
> 
> 赞同：0
> 
> 时间：2012-06-13T20:30:23.897
> 
> 标签：xcode

```
 brickorna = [NSMutableArray arrayWithCapacity:10];

    int chipSize = 100;
    gridPoints = [NSMutableArray arrayWithObjects:
                  [NSValue valueWithCGPoint:CGPointMake(chipSize, chipSize)],
                  [NSValue valueWithCGPoint:CGPointMake(chipSize*2, chipSize)],
                  [NSValue valueWithCGPoint:CGPointMake(chipSize*3, chipSize)],

                  [NSValue valueWithCGPoint:CGPointMake(chipSize, chipSize*2)],
                  [NSValue valueWithCGPoint:CGPointMake(chipSize*2, chipSize*2)],
                  [NSValue valueWithCGPoint:CGPointMake(chipSize*3, chipSize*2)],

                  [NSValue valueWithCGPoint:CGPointMake(chipSize, chipSize*3)],
                  [NSValue valueWithCGPoint:CGPointMake(chipSize*2, chipSize*3)],
                  [NSValue valueWithCGPoint:CGPointMake(chipSize*3, chipSize*3)],
                  nil];

    for (int i = 0; i <= 8; i++) { //createing chips and adding them to array
    CCMenuItemImage *bricka = [CCMenuItemImage itemFromNormalImage:@"Icon.png" selectedImage:nil];
        [brickorna addObject:bricka];
    }

    for (int a = 0; a <= 8; a++) { //adding the chips to scene

        CCMenuItemImage *tempB = [brickorna objectAtIndex:a];
        tempB.position = [[gridPoints objectAtIndex:a] CGPointValue];

        [self addChild:[brickorna objectAtIndex:a]];
    } 
```

我正在尝试制作瓷砖游戏，但被卡住了。请参阅“这是错误的”行。我试图将 CGPoint 坐标从 gridPointArray 传递到 BrickornaArray 中的 CCmenuItem(bricka)，但没有运气。我无法弄清楚它的语法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:35:35.470

CCMenuItemImage 没有名为“CGPointValue”的属性 - 它有一个CGPointValue*类型*的属性，名为`position`，这是您应该设置的。

就像是：

```
[brickorna objectAtIndex:a].position = [[gridPoints objectAtIndex:a] CGPointValue]; 
```

该`position`属性在 CCNode 中声明，CCMenuItem（和 CCMenuItemImage）从中继承。

# html - 添加没有 javascript 的悬停文本，就像我们悬停在用户的声誉上一样

> ID：11022843
> 
> 赞同：304
> 
> 时间：2012-06-13T20:30:27.930
> 
> 标签：html, hover

在 stackoverflow 中，当我们将鼠标悬停在用户的声誉上时，我们会看到一个文本。我在很多地方都看到过这个，源代码告诉我，它可以在没有 js 的情况下完成。我试过了，只得到了这个——

```
 <div="text">hover me</div> 
```

* * *

## 回答 #1

> 赞同：580
> 
> 时间：2012-06-13T20:32:04.280

使用`title`属性，例如：

```
<div title="them's hoverin' words">hover me</div>
```

或者：

```
<span title="them's hoverin' words">hover me</span>
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-05-03T08:23:35.900

title 属性也适用于其他 html 元素，例如链接...

```
<a title="hover text" ng-href="{{getUrl()}}"> download link
</a> 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2017-05-11T00:00:36.840

在这种情况下，我通常会使用缩写 html 标签。

`<abbr title="Hover">Text</abbr>`

[https://www.w3schools.com/tags/tag_abbr.asp](https://www.w3schools.com/tags/tag_abbr.asp)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-10-26T12:49:08.733

您正在寻找工具提示

对于基本工具提示，您需要：

```
<div title="This is my tooltip"> 
```

对于更高级的 javascript 版本，您可以查看：

[http://www.designer-daily.com/jquery-prototype-mootool-tooltips-12632](http://www.designer-daily.com/jquery-prototype-mootool-tooltips-12632)

上面的链接为您提供了 12 个工具提示选项。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-02-21T12:52:59.387

这也可以在 CSS 中完成，以获得更多的可定制性：

```
.hoverable {
  position: relative;
}

.hoverable>.hoverable__tooltip {
  display: none;
}

.hoverable:hover>.hoverable__tooltip {
  display: inline;
  position: absolute;
  top: 1em;
  left: 1em;
  background: #888;
  border: 1px solid black;
}
```

```
<div class="hoverable">
  <span class="hoverable__main">Main text</span>
  <span class="hoverable__tooltip">Hover text</span>
</div>
```

（显然，样式可以改进）

# python - Python 正则表达式问题

> ID：11022847
> 
> 赞同：1
> 
> 时间：2012-06-13T20:30:40.917
> 
> 标签：python, regex

我不确定为什么这不起作用：

```
import re
import csv

def check(q, s):
  match = re.search(r'%s' % q, s, re.IGNORECASE)
  if match:
    return True
  else:
    return False

tstr = []

# test strings
tstr.append('testthisisnotworking')
tstr.append('This is a TEsT')
tstr.append('This is a    TEST    mon!')

f = open('testwords.txt', 'rU')
reader = csv.reader(f)
for type, term, exp in reader:
  for i in range(2):
    if check(exp, tstr[i]):
      print exp + " hit on " + tstr[i]
    else:
      print exp + " did NOT hit on " + tstr[i]
f.close() 
```

testwords.txt 包含这一行：

```
blah, blah, test 
```

所以本质上“测试”是正则表达式模式。没什么复杂的，就是一个简单的词。这是输出：

```
test did NOT hit on testthisisnotworking
test hit on This is a TEsT
test hit on This is a    TEST    mon! 
```

为什么它没有击中第一个字符串？我也试过`\s*test\s*`没有运气。帮助？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T20:36:05.190

默认情况下，该`csv`模块在输入中的单词周围返回空格（可以通过使用不同的“方言”来更改）。所以`exp`包含`" test"`前导空格。

解决此问题的一种快速方法是添加：

```
exp = exp.strip() 
```

从 CSV 文件中读取后。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:37:47.840

在第一个循环的`print repr(exp)`顶部添加 a`for`表示，注意前导空格。`exp``' test'`

这并不奇怪，因为`csv.reader()`以逗号分隔，请尝试将您的代码更改为以下内容：

```
for type, term, exp in reader:
  exp = exp.strip()
  for s in tstr:
    if check(exp, s):
      print exp + " hit on " + s
    else:
      print exp + " did NOT hit on " + s 
```

请注意，除了`strip()`将删除前导尾随空格的调用之外，我还将您的第二个 for 循环更改为直接在字符串上循环`tstr`而不是在范围上循环。您当前的代码中实际上存在一个错误，因为`tstr`包含三个值，但您只检查了前两个，因为`for i in range(2)`只会给您`i=0`和`i=1`.

# android - 如何在 Grails 中接收 HTTPS Post 请求？

> ID：11022851
> 
> 赞同：1
> 
> 时间：2012-06-13T20:31:02.507
> 
> 标签：android, http, grails

我正在编写一个需要将数据传递给基于 Grails 的 Web 应用程序的 Android 应用程序。我想在客户端使用 Post 请求。我不确定在服务器端从哪里开始。我知道我可能应该使用看起来像这样的代码：request.getParams() 但我不确定这需要去哪里。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:53:57.310

在服务器端，无论请求是使用 HTTP 还是 HTTPS、GET 还是 POST，您的代码都是相同的。从控制器开始：

```
class TestController {
    def index() {
        // params is a map with all the request parameters
        println params

        // do your server side stuff here
    }
} 
```

对于开发，将您的 android 应用程序发布到`http://<devserver>:8080/<appname>/test`. 部署到生产环境时，更改 URL `https://<prodserver>/<appname>/test`。

如果你想在开发中使用 HTTPS，你可以运行开发服务器，`grails run-app -https`grails 将自动创建一个自签名 SSL 证书，并在端口 8443 上侦听 HTTPS 连接，以及在端口 8080 上侦听通常的 HTTP 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:46:24.407

您将需要创建一个[控制器](http://grails.org/doc/latest/guide/theWebLayer.html#controllers)。例如

```
FooController {
    def index = {
        if (request.status == 'POST')
            print request.params
        }
    }
} 
```

现在发一个帖子到`http://<url context>/foo/index`。

# ruby-on-rails-3 - 用于多对多自引用模型的 FactoryGirl 工厂

> ID：11022852
> 
> 赞同：3
> 
> 时间：2012-06-13T20:31:09.670
> 
> 标签：ruby-on-rails-3, factory-bot

我有一个自引用的用户模型：

```
class User < ActiveRecord::Base
    has_and_belongs_to_many :following,
                            :class_name               => "User",
                            :foreign_key              => 'follower_id',
                            :association_foreign_key  => 'following_id',
                            :join_table               => 'followers'
    has_and_belongs_to_many :followers,
                            :class_name               => "User",
                            :foreign_key              => 'following_id',
                            :association_foreign_key  => 'follower_id',
                            :join_table               => 'followers'
    ...
end 
```

我很难想出一个 FactoryGirl 工厂来测试这种行为。我尝试了一些变体

```
factory :user do
    ...
    factory :following do
        after(:create) do |user, evaluator|
            create_list(:user, evaluator.followers_count, follower: user)
        end
    end
end 
```

但没有运气。你会怎么做？感谢您的任何意见。

# wpf - 标签多选的wpf文本框行c#

> ID：11022856
> 
> 赞同：0
> 
> 时间：2012-06-13T20:31:23.067
> 
> 标签：wpf, c#-4.0, textbox

我遇到了 WPF 应用程序中的文本框控件的问题。问题是当用户选择多行文本然后单击选项卡时，选定的行将被删除而不是向右缩进。有没有办法解决这个问题？

感谢任何帮助。谢谢艾哈迈德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:38:34.517

遗憾的是，您必须实现该功能，因为在 TextBox 中没有为此设置 tab 键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T03:32:04.243

您需要在后面的代码中处理它，因为它不是文本框的默认操作。您可以通过多种方式处理它。您将需要覆盖 PreviewKeyDown 并且可以将 e.handled 设置为 true 以使文本不被覆盖。

```
 private void TextBox_PreviewKeyDown(object sender, System.Windows.Input.KeyEventArgs e)
    {
        TextBox tbx = sender as TextBox;
        if (e.Key == Key.Tab)
        {
            tbx.Text = tbx.Text.Insert(tbx.SelectionStart, "\t" + tbx.Text.Substring(tbx.SelectionStart));
            e.Handled = true;
        }
    } 
```

# facebook - 在没有身份验证的情况下检索 Facebook 用户 ID（或任何唯一的）？

> ID：11022861
> 
> 赞同：2
> 
> 时间：2012-06-13T20:32:00.863
> 
> 标签：facebook, facebook-javascript-sdk, facebook-php-sdk

无论如何都可以在不强制他们进行身份验证的情况下获取用户的 Facebook ID？我正在尝试创建一个应用页面，用户只能在其中添加一次投票的答案，因此我需要能够通过某种唯一标识符来识别查看者。

我的偏好是不强迫他们登录。我认为添加 2 个额外步骤是不好的用户体验，这样我就可以确保 Facebook 页面上的 facebook 用户是唯一的。我不需要他们的个人资料/等的任何权限。

顺便说一句，我已经看到了类似的问题，尽管对我来说没有任何最新或足够接近的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:35:19.620

如果您不让您的用户登录，则不可能，出于安全原因，用户必须知道您正在收集有关他的信息，这也是登录的原因。

使用 PHP SDK，在登录后获取 id：

```
$userId = $facebook->getUser(); 
```

# c++ - boost::python 不能包装的类

> ID：11022873
> 
> 赞同：1
> 
> 时间：2012-06-13T20:33:31.570
> 
> 标签：c++, templates, boost, boost-python

是否有某些类不能被 boost::python 包装？我正在尝试包装一个类，但是在使用它而不是一个虚拟类时遇到了错误。

以下不起作用...

```
#include <manu/manu.h>

void foo()
{
    // can call non-member Kernel(), which returns Kernel instance
    manu::Kernel* kernel = manu::Kernel(); 
}

BOOST_PYTHON_MODULE(mymodule)
{
    using namespace boost::python;
    class_<manu::Kernel>("Kernel", no_init) // doesn't like this
    ;
} 
```

我可以在函数中使用它，但是将它放在 class_ 模板中会出现以下错误：

```
manu_python.cpp:9: error: expected constructor, destructor, or type conversion before ‘*’ token
manu_python.cpp: In function ‘void init_module_manu()’:
manu_python.cpp:17: error: type/value mismatch at argument 1 in template parameter list for ‘template<class T, class X1, class X2, class X3> class boost::python::class_’
manu_python.cpp:17: error:   expected a type, got ‘manu::Kernel’ 
```

但使用虚拟类确实有效。

```
class Foo
{
};

BOOST_PYTHON_MODULE(mymodule)
{
    using namespace boost::python;
    class_<Foo>("Kernel", no_init)
    ;
} 
```

完整的类在 manu.h 中定义，但没有在此处完全声明。这个类不能暴露给python吗？

在 manu.h 中，有一个名为 Kernel 的类和一个名为 Kernel() 的非成员函数，它返回 Kernel 的一个实例。这个函数是否会影响 Kernel 类在模板中的使用？如果是这样，有没有办法告诉模板我指的是类而不是函数声明？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-10T13:29:26.420

我遇到了同样的问题，发现了这个网站：http: [//qiita.com/nishio/items/daff0e9be30f4b4d6fca](http://qiita.com/nishio/items/daff0e9be30f4b4d6fca)

几个可读的位为我解决了这个问题：

```
#include <boost/python/class.hpp> 
```

# sql-server - 将表的子集插入自身时如何获得新pk和旧pk？

> ID：11022874
> 
> 赞同：2
> 
> 时间：2012-06-13T20:33:41.947
> 
> 标签：sql-server, tsql

我将表的子集插入到同一个表中，并且为了在某些映射表中创建记录，需要捕获新创建的身份 PK 和匹配的旧 PK..

如果 SQL 支持它，例如：

```
Create table Test (pk identity, description varchar(10))

Declare @PKVALUES TABLE (NewPK int, OLdPk int)

INSERT INTO Test (description)
OUTPUT INSERTED.PK, Test.PK into @PKVALUES
Select description
From Test
Where ... 
```

但是，当然，SQL 不支持在 INSERT 操作期间从 FROM 表中输出值。

我遇到的唯一基于集合的替代方法需要锁定整个表，同时在临时表中创建新的 PK，然后使用身份插入将它们插入到测试表中。

有什么方法可以做到这一点（不必一次使用一条记录或锁定整个表）？

谢谢，伊尔玛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:07:28.917

我的偏好是添加一个列来存储旧的 pk，然后您可以从输出子句中返回它。但是，并非总是可以更改表格。

所以，我有一个鬼鬼祟祟的把戏，但它需要在你的数据库上做两倍的工作。您所做的是将旧 PK 放在初始插入的描述字段中。然后，通过将描述字段加入 PK，将描述更新为旧 PK 的值。

```
Create table Test (pk identity, description varchar(10))  

Declare @PKVALUES TABLE (NewPK int, OLdPk varchar(10)  

INSERT INTO Test (description) 
OUTPUT INSERTED.PK, INSERTED.Description into @PKVALUES
SELECT PK from Test where....

UPDATE tnew
SET description = told.description
FROM test told
JOIN test tnew ON CAST(told.PK AS varchar (10)) = t.description 
```

# android - Android 加载屏幕

> ID：11022875
> 
> 赞同：0
> 
> 时间：2012-06-13T20:33:43.117
> 
> 标签：android, optimization, startup, splash-screen

当我的应用程序启动一个通过 sdcard 递归迭代的文件**抓取器**时，就会启动。可以想象，这需要相当长的时间。在我的 epad 变压器上，它可能需要 30 到 40 秒才能快速通过 32gb 的存储空间。

此活动在两个片段中完成，这些片段位于主布局上，从主活动启动。

显然，在这样的加载时间下，我需要做一些事情来提醒用户。但是，根据我的阅读，我无法在加载屏幕后面的后台启动主要活动。我试图放下一个进度条，但也失败了。

那么，有什么建议吗？

编辑

我只是在阅读在片段中使用 aSyncTask 的内容。我很想在慢速列表片段中、启动屏幕上或主视图上方使用进度条

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:29:55.787

做这样的事情

```
LoadTask load;

public class LoadTask extends AsyncTask<Void, Integer, Boolean> {

        int prog = 0;

        @Override
        protected Boolean doInBackground(Void... params) {

            //All your loading code goes in here 

            publishProgress(prog++); //Use this to update the progress bar

            publishProgress(-1) //Use this to open other app
            return false;
        }

        protected void onProgressUpdate(Integer... progress) {
             if(progress[i] == -1)
                 //open other app here

             for(int i = 0; i < progress; i++){
                  //set progress here with progress[i];
             }
        }

} 
```

然后开始异步任务使用

```
load = new LoadTask();
load.execute(); 
```

# iphone - editingStyleForRowAtIndexPath 同时调用了 3 次。为什么？

> ID：11022876
> 
> 赞同：3
> 
> 时间：2012-06-13T20:33:49.300
> 
> 标签：iphone, ios, uitableview, uilabel

我有一个 TableView，每行有两个 UILabel。当用户在单元格上滑动时，我想减少单元格上第一个标签的框架，以解决此问题：

![错误图像](../Images/0bcc6006de6f11d5edc22bafc31d63dc.png)

这是我的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:NO] autorelease];
    }

    custom_cell = [[[UILabel alloc] initWithFrame:CGRectMake(10, 0, 200, 45)] autorelease];

    custom_cell.textColor = [UIColor blackColor];

    custom_cell.backgroundColor = [UIColor clearColor];

    [custom_cell setText:[[self.Notes objectAtIndex:indexPath.row ]objectForKey:@"Text"]];

    [cell.contentView addSubview:custom_cell];

    NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
    [dateFormat setDateFormat: @"dd MMM yy"];

    [dateFormat setLocale:[NSLocale currentLocale]];

    NSDate *dateTmp = [[self.Notes objectAtIndex:indexPath.row] objectForKey:@"CDate"];

    cell.detailTextLabel.text = [dateFormat stringFromDate: dateTmp];

    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

    [dateFormat release];

    return cell;

} 
```

然后，为了减少单元格上第一个标签的框架，我编写了以下代码：

```
- (UITableViewCellEditingStyle)tableView:(UITableView *)tableView editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath {

    NSLog(@"row=%d", indexPath.row);

    custom_cell.frame = CGRectMake(10, 0, 150, 45);

    return UITableViewCellEditingStyleDelete;
} 
```

结果部分正确。我的 tableView 的最后一个标签总是减少，而不是正确的。

控制台也会打印三倍的 NSLog 消息。为什么？

```
2012-06-13 22:07:34.809 myVoyager[1935:16103] row=0
2012-06-13 22:07:34.810 myVoyager[1935:16103] row=0
2012-06-13 22:07:34.813 myVoyager[1935:16103] row=0 
```

谢谢，来自比萨的亚历山德罗（对不起我的英语！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:52:03.873

我是比萨的瓦莱里奥！您应该在您的 editingStyleForRowAtIndexPath 方法中这样做：

```
UITableViewCell *myCell = [self.tableView cellForRowAtIndexPath:indexPath]; 
```

然后将框架设置为单元格。

# javascript - 在 Div 中垂直居中表格

> ID：11022877
> 
> 赞同：1
> 
> 时间：2012-06-13T20:33:49.540
> 
> 标签：javascript, jquery

我做了一些研究，发现在 div 中垂直居中表格的唯一方法（表格不跨越整个高度，高度随内容的变化而变化）是使用 javascript/jquery：

```
<script>
   var tableMarginTop = Math.round( (testHeight - tableHeight) / 2 );
   $('table').css('margin-top', tableMarginTop)
</script> 
```

现在我的代码如下所示： CSS：

```
.rightDiv{
    width: 300px
    height: 380px;
    background: url(http://myimage.com) no-repeat;
}

.rightDiv table{
    margin: auto; /*For centering horizontally*/
} 
```

HTML：

```
<div class="rightDiv">
  <table width="80%">
    <tr><td></td></tr>
  </table>
</div> 
```

我的问题：如何针对这种情况实现该代码？不知道如何在JS函数中为相关的div和table调用具体的div类和table类？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:44:57.840

希望我正确理解了你的问题——这个例子怎么样？[http://jsfiddle.net/9Zg8a/1/](http://jsfiddle.net/9Zg8a/1/)

```
<div style="height:200px; vertical-align:middle; display:table-cell; border:green 1px solid">
  <table style="border:red 1px solid">
    <tr>
      <td>test text
      </td>
    </tr>
  </table>
</div>​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:52:23.560

这个答案是针对这个问题的：

**我的问题：如何针对这种情况实现该代码？不知道如何在JS函数中为相关的div和table调用具体的div类和table类？**

您的示例中的“.rightDiv”和“.rightDiv 表”一无所获！让它更简单。

CSS

```
#rightDiv{
    width: 300px
    height: 380px;
    background: url(http://myimage.com) no-repeat;
}

#rightDivTable{
    margin: auto; /*For centering horizontally*/
} 
```

HTML

```
<div id="rightDiv">
  <table id="rightDivTable" width="80%">
    <tr><td></td></tr>
  </table>
</div> 
```

更新：添加了缺少的引号和请求的代码

这样，您将在 jquery 中为您的元素使用 $('#rightDiv') 和 $('#rightDivTable')。

JS

```
var 
    testHeight = $('#rightDiv').innerHeight(),
    tableHeight = $('#rightDivTable').outerHeight(),    
    tableMarginTop = Math.round( (testHeight - tableHeight) / 2 );
    $('#rightDivTable').css('margin-top', tableMarginTop); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:46:43.160

这个怎么样-

```
<div class="rightDiv">
  <center><table width="80%">
    <tr><td></td></tr>
  </table></center>
</div> 
```

`center`不建议使用，但使用它有什么问题。

**更新-**

我不能在没有尺寸的情况下为其分配中心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T21:29:48.690

可能还有其他垂直居中的方法，但如果你想坚持使用脚本，这里有一种方法 - [jsfiddle here](http://jsfiddle.net/Rkm6c/5/)：

```
var testHeight = $('.rightDiv').innerHeight();
var tableHeight = $('.rightDiv table').outerHeight();

var tableMarginTop = Math.round( (testHeight - tableHeight) / 2 );
$('table').css('margin-top', tableMarginTop) 
```

JQuery 允许您使用 CSS 样式的选择器来引用元素，因此您可以使用现有的类并以与 CSS 相同的方式引用它们。或者您可以分配 ID 并使用 $('#idgoeshere') 代替 - 并且可能更新 CSS 以使用基于 id 的选择器。

使用 ID 会更快，因为 JQuery 可以在内部优化选择器查询以使用 document.getElementById。（使用基于类的选择器的一个共同好处是，您可以一次性对一组匹配的元素进行操作 - 尽管如果表格具有不同的高度，这在您的特定情况下不起作用。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T20:38:23.983

这样您就可以在 div 中将表格居中。通过将 margin-left 和 margin-right 设置为 auto，您几乎可以将每个对象居中。

```
<div style="300px; height: 380px">
  <table style="margin-left:auto; margin-right:auto">
    <tr>
      <td>
        ...
      </td>
    </tr>
  </table>
</div> 
```

# jquery - 如何将 backingbean GSON 字符串带到 Highcharts

> ID：11022880
> 
> 赞同：0
> 
> 时间：2012-06-13T20:33:57.293
> 
> 标签：jquery, jsf, richfaces, highcharts, gson

我对 JS、jQuery 和 JSON 的东西还很陌生，所以非常感谢任何帮助。我有一个我正在尝试使用 Highcharts 的项目，即 JSF 2.2、RichFaces 4。我已经有了我的支持 bean，它从数据库中提取数据，并将存储放在一个集合中。然后我将集合转换为 GSON 字符串。来自 GSON 对象的打印输出的数据样本是

> {"矿池价格":[{"date":"Date.UTC(2012,5,4,1)","data":"1144.144"},{"date":"Date.UTC(2012,5, 4,2)","data":"1030.421"}], "RAPP":[{"date":"Date.UTC(2012,5,4,1)","data":"11.50"}, {"date":"Date.UTC(2012,5,4,2)","data":"10.87"}]}

说到页面，我从 HighCharts 示例页面的 JSFiddle 中设计了一个图表，并使用了一些硬编码值来获得正确的外观/设计。

我现在的问题是从支持 bean 获取数据到 highcharts。我的页面现在看起来像这样

```
<h:head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

    <script src="http://code.highcharts.com/stock/highstock.js"></script>

    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>
   <script type="text/javascript">
    $(document).ready(function() {
        function chartdata() {

           console.log("Grabbing chart data");
           var data = jQuery("#chartvalue").attr('value');

             }
         });
    </script>
</h:head>
<h:body>
    <h:form prependId="false" >

<a4j:commandButton value="LoadData" oncomplete="chartdata();" action="#{dailyReportBean.loadChartData}" id="chartvalue_btn" />
<h:inputHidden value="#{dailyReportBean.json}" id="chartvalue"  />

        <div id="container">
            <script src="DR_PoolPrice_Graph.js" type="text/javascript"></script>
        </div>
    </h:form>
</h:body> 
```

带有编码值的预设 JS 文件可以正常加载。所以问题只是将chartdata（）中的数据访问到highcharts文件，以及我如何引用它。

这是 highcharts 文件的样子

```
$(function() {
Highcharts.setOptions({
    colors: ['#FFFFCC','#799ECD',]
});

var chart = new Highcharts.StockChart({

    chart: {
        renderTo: 'container',
        backgroundColor: '#FCD5B5',
        borderColor: 'EBBA95',
        borderWidth: 2,
        borderRadius: 10,
        spacingLeft: 40,
        spacingRight: 20,
        zoomType: 'x',
        plotBorderColor: '#346691',
        plotBorderWidth: 1,
        plotBackgroundColor: {
            linearGradient: {
                x1: 0,
                y1: 0,
                x2: 0,
                y2: 1
            },
            stops: [
                [0, 'rgb(255, 255, 255)'],
                [1, 'rgb(200, 200, 255)']
                ]
        }
    },

    title: {
        text: 'Price'
    },

    rangeSelector: {
        enabled: false
    },

    yAxis: {
        labels: {
            x: -25
        }
    },

    legend: {
        enabled: true,
        floating: false,
        align: 'center',
        backgroundColor: '#FCFFC5',
        borderColor: 'black',
        borderWidth: 1,
        layout: 'horizontal',
        verticalAlign: 'bottom',
        y: 0,
        shadow: true
    },

    navigator: {
        enabled: false
    },

    scrollbar: {
        enabled: false
    },

    navigation: {
        buttonOptions: {
            align: 'right'
        }
    },

    series: [{
        name: 'RAPP',
        data: rapp,
        type: 'area'},
        {
        name: 'Pool Price',
        data: poolprice},
    ]
});
}); 
```

很抱歉，这是一个相当大的帖子，我只是想彻底，因为我已经尝试过多种不同的方式来查看它，但它只是不适合我。我敢肯定这很愚蠢。

感谢您提供的任何意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:32:20.593

您需要更新`<h:inputHidden>`ajax 请求，以便 jQuery 获取更新后的值。

```
<a4j:commandButton ... render="chartvalue" /> 
```

更简单的方法是将它作为参数传递给`oncomplete`：

```
<a4j:commandButton ... oncomplete="chartdata(#{dailyReportBean.json})" /> 
```

和

```
<script type="text/javascript">
    function chartdata(data) {
        console.log("Chart data already retrieved: " + data);
    }
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T06:37:16.780

```
/*Ajax call to get the Chart data in JSON Format */
function getJsonChartData(str ) 
           {

    var http_request = new XMLHttpRequest();
    http_request.open("GET", "drawChart.php?client_name="+str, true);

    http_request.onreadystatechange = function() {
        var done = 4, ok = 200;
        if(http_request.readyState == done && http_request.status == ok) {
            my_JSON_object = JSON.parse(http_request.responseText);  // JS json Object to capture the returning json text 
                chart.showLoading(); // show loading image on chart

            /***************** setting data to chart dynamically *************/

            chart.series[1].setData(my_JSON_object[5]); //should be 5

            chart.series[2].setData(my_JSON_object[4]);

            chart.series[3].setData(my_JSON_object[1]);

            chart.series[4].setData(my_JSON_object[0]);

            chart.series[5].setData(my_JSON_object[2]);

                chart.series[6].setData(my_JSON_object[3]);

            chart.xAxis[0].setCategories(my_JSON_object[6]); 

        }
    };
    http_request.send(null);

} 
```

我解决了你的问题，但没有得到你真正想要的，无论如何，如果你试图从 JS 文件动态加载 highchart 数据，最好的方法是进行 ajax 调用并将数据作为 JSON 对象获取，然后设置通过参考上面示例中的 highchart 图表对象手动获取的数据是我通过 php 文件使用它来设置数据的方式，希望这会有所帮助:)

# oracle - Oracle 触发器 UPDATE 而不是 INSERT

> ID：11022881
> 
> 赞同：2
> 
> 时间：2012-06-13T20:34:04.580
> 
> 标签：oracle, plsql, triggers, oracle11g

试图找到一种编写 Oracle 触发器的方法，该触发器将在插入之前检查是否在主列中找到匹配项，如果是，则更新行信息而不是插入新行。

我看过了`before insert`。有没有办法根据该块内的条件取消插入？

我也看过使用该`instead of`子句，但它需要处理视图。

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T20:36:48.200

使用 MERGE 语句而不是 INSERT。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-05T14:36:25.740

使用合并语句。

```
MERGE INTO <<your table>> t
   USING (<<your list of records - can be the result of a SELECT >>)
   ON ( <<join between table and list of records >>)
WHEN MATCHED THEN
  UPDATE SET << the rows you want to set>>
WHEN NOT MATCHED THEN
  INSERT (<<columns of table>>)
  VALUES (<<value>>) 
```

[https://oracle-base.com/articles/9i/merge-statement](https://oracle-base.com/articles/9i/merge-statement)

# actionscript-3 - 为什么 removeEventListener 不起作用？

> ID：11022882
> 
> 赞同：0
> 
> 时间：2012-06-13T20:34:06.713
> 
> 标签：actionscript-3, flash

谁能告诉我为什么`removeEventListener`电话打不通？

```
this.addEventListener(Event.ENTER_FRAME, eventCall, false, 0, true);

function eventCall(e:Event):void
{
    trace("event still attached");
    this.removeEventListener(Event.ENTER_FRAME, eventRemoved);
}

function eventRemoved():void
{
    trace("gone");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T20:36:59.090

您没有`removeEventListener()`使用与添加它时相同的回调进行调用。它应该是：

```
this.removeEventListener(Event.ENTER_FRAME, eventCall); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:36:45.710

您应该传递分配为侦听器的函数名称

```
this.removeEventListener(Event.ENTER_FRAME, eventCall); 
```

# c# - c#中的聚合异常不保存单个异常消息

> ID：11022887
> 
> 赞同：4
> 
> 时间：2012-06-13T20:34:33.333
> 
> 标签：c#, exception-handling

考虑以下代码片段：

```
foreach (var setting in RequiredSettings)
                {
                    try
                    {
                        if (!BankSettings.Contains(setting))
                        {
                            throw new Exception("Setting " + setting + " is required.");
                        }
                    }
                    catch (Exception e)
                    {
                        catExceptions.Add(e);
                    }
                }
            }
            if (catExceptions.Any())
            {
                throw new AggregateException(catExceptions);
            }
        }
        catch (Exception e)
        {
            BankSettingExceptions.Add(e);
        }

        if (BankSettingExceptions.Any())
        {
            throw new AggregateException(BankSettingExceptions);
        } 
```

catExceptions 是我添加到的异常列表。循环完成后，我会获取该列表并将它们添加到 AggregateException 然后抛出它。当我运行调试器时，每个字符串消息“需要设置 X”都会出现在 catExceptions 集合中。但是，当归结为 AggregateException 时，现在唯一的消息是“发生了一个或多个错误”。

有没有一种方法可以聚合，同时仍保留单个消息？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T20:38:20.897

> 有没有一种方法可以聚合，同时仍保留单个消息？

是的。[InnerExceptions](http://msdn.microsoft.com/en-us/library/system.aggregateexception.innerexceptions.aspx)属性将包括所有异常及其消息。

您可以根据需要显示这些。例如：

```
try
{
    SomethingBad();
}
catch(AggregateException ae)
{
    foreach(var e in ae.InnerExceptions)
       Console.WriteLine(e.Message);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:47:54.230

`.handle()`上面的海报给出了正确的答案，但是可以使用该方法，而不是使用 foreach 循环。

```
try
{
    SomethingBad();
}
catch(AggregateException ae)
{
    ae.handle(x => {
        Console.WriteLine(x.Message);
        return true;
    });
} 
```

# javascript - jquery加载更多内容onclick

> ID：11022888
> 
> 赞同：1
> 
> 时间：2012-06-13T20:34:39.107
> 
> 标签：javascript, jquery, ajax, json, load

这是我到目前为止所拥有的：

```
$(document).ready(function(){   
  $("#feed-page").load("feed.php #first-feed");

  $('.feed-load').click(function(){   
    $("#feed-page").load("feed.php #second-feed" ,  hideLoading);
    $(".feed-load .button-content").css( "display" , "none" );
    $('.feed-load-img').css( "display" , "block" );
  });

  function hideLoading() {  
    $(".feed-load .button-content").css( "display" , "block" );
    $(".feed-load .feed-load-img").css( "display" , "none" ); 
  }
}); // end document ready 
```

我的问题是，当我单击“加载更多”时，会发生内容被换出的情况。

这不是我想要发生的事情，我只是希望内容全部保留，这意味着页面加载时已经存在的内容我希望保留但是当我单击“加载更多”时我希望该内容保留但出于某种原因，最初存在的内容被我不希望发生的新内容换掉了。

可以在这里找到一个活生生的例子：[http ://www.cyberfanatic.com](http://www.cyberfanatic.com)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T22:49:54.643

当前代码的问题在于，在用户单击按钮后，您正在将新数据加载到现有数据之上。请参阅[jQuery .load()](http://api.jquery.com/load/)。

您需要[添加](http://api.jquery.com/append/)新数据，以保留现有数据：

```
// on click
$('.feed-load').click(function(){   

  // load the new data to an element
  $("<div>").load("feed.php #second-feed", function() {

    // all done, append the data to the '#feed-page'
    $("#feed-page").append($(this).find("#second-feed").html());

    // call your function
    hideLoading();
  });

  // continue the remaining of your code...
  $(".feed-load .button-content").css( "display" , "none" );
  $('.feed-load-img').css( "display" , "block" );
}); 
```

* * *

## 已编辑

按照评论的要求附加一些动画：

```
...
// all done, append the data to the '#feed-page'
var $html   = $(this).find("#second-feed").html(),
    $newEle = $('<div id="second-feed" />').attr("style", 'display:none;').html($html);

$("#feed-page").append($newEle);
$('#second-feed').slideToggle();
... 
```

请参阅此[小提琴示例](http://jsfiddle.net/zuul/V4QDF/)！

# iphone - 您可以提交的应用程序更新数量是否有限制？

> ID：11022889
> 
> 赞同：0
> 
> 时间：2012-06-13T20:34:42.897
> 
> 标签：iphone, ios

根据我公司的工作方式，我们会非常定期地发布更新。对于您可以为您的应用发送新的更新提交的次数是否有限制或规定？

我已经查看并搜索了与此问题相关的任何内容，但尚未找到任何内容。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T20:38:02.303

简单的回答。不，那里没有。您可以提交尽可能多的更新。当然，您将不得不等待接受提交下一个版本，而一个正在审查中。

# php - 如何按元素检查和取消设置/设置 SESSION？

> ID：11022894
> 
> 赞同：2
> 
> 时间：2012-06-13T20:35:04.127
> 
> 标签：php, session

我有一个购物车的会话变量，上面写着：'cart_b_1_1'。

字符串中的字母表示类别，整数表示用户 ID 和产品 ID。

如何检查已设置 SESSION var 的类别以查看它是否与新选择的类别匹配？

我试图确保如果一个项目被添加到 SESSION 数组并且已经存在一个具有相同类别字母的 var，那么它会被取消设置并有效地替换为新的选择。这是为了将按类别的选择限制为一个。

我在这里先向您的帮助表示感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:39:51.813

您应该考虑利用关联数组的强大功能：

```
$_SESSION['categories'][$mycat] = array($user_id, $product_id); 
```

这样，每当您设置一个新类别时，它都会覆盖最后一个类别。不知道为什么你需要`user_id`在那个级别，假设整个购物车属于一个用户，我的 Session 看起来像：

```
array(
    'user' => $user_id,
    'cart' => array('catid' => 'prodid', 'catid2', 'prodid2'))
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T20:40:31.753

您应该使用 3 个变量而不是 1 个。

```
$_SESSION['category'] = 'cart_b';
$_SESSION['user_id'] = 1;
$_SESSION['product_id'] = 1; 
```

但总的来说 - 您可以将字符串转换为带有 '_' 分隔符的数组。

```
$varArray = explode('_', $_SESSION['var']); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T20:41:35.497

使用 _ 分解会话变量并检查第一个元素以找到类别。

$myarray=explode("_",$_SESSION['yourvariablename']);

然后你 $myarray[1] 是类别，所以你可以比较和做其他事情。

这是你想要的吗？

# nsmutablearray - 对象不存储在 NSMutableArray

> ID：11022897
> 
> 赞同：0
> 
> 时间：2012-06-13T20:35:19.590
> 
> 标签：nsmutablearray

我有一个问题，存储 viewController 对象的实例。我希望每个用户都有自己的屏幕，上面有一些信息，然后能够进行模态切换用户。

“User”的类实例和数组“Users”在 .h 文件中定义，循环运行 5 次 - 但数组永远不会被填充：

```
- (void) chooseNumberOfUsers:(id)sender {
    numberOfUsers = [sender tag];
    NSLog(@"Number of users: %i", numberOfUsers);

    currentUser = 0; // Nul-indekseret

    // Herefter skal vi oprette spillerobjekter
    users = [[NSMutableArray alloc] init];
    for (int i=0; i<numberOfUsers; i++) {
        user = [[UserViewController alloc] init];
        user.userid = i+1;
        [users addObject:user];
    }
    [users addObject:nil]; // Is this necessary?

    // Debug: show info about the first user
    NSLog(@"%@", [users objectAtIndex:0]); } 
```

用户对象已创建，但如前所述，数组“用户”永远不会被填充。

当它运行 5 次时，它会抛出此错误：

> 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“ *** -[__NSArrayM insertObject:atIndex:]: object cannot be nil”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:42:58.590

以下行导致错误

```
[users addObject:nil]; // Is this necessary? 
```

正如异常所述，您不能将 nil 添加到 NSArray。如果您需要向 Cocoa 集合添加空值，[NSNull](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNull_Class/Reference/Reference.html)就是这样做的方法。

# windows - 从命令窗口执行并双击 bat 文件时，Windows .Bat 文件的行为有所不同

> ID：11022902
> 
> 赞同：0
> 
> 时间：2012-06-13T20:35:27.780
> 
> 标签：windows, batch-file

Windows .Bat 文件在从命令窗口执行和双击 bat 文件时表现不同。这是我的文件：

```
ECHO ON
del activity_ftp.log
cd D:\My_Test
IF EXIST united_ops*.csv (
for %%i in (united_ops*.csv) do (
set size=0
set /A size=%%~zi
echo %%i,%size%,397312,624640 > D:\My_Test\activity_ftp.log
)
) 
```

当我通过打开命令窗口并调用它来运行它时，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T20:49:30.040

您的代码中存在一些问题。
`cd d:\My_test`仅当您打开时才有效`D:`，您可以使用`cd /d`或`pushd`此处。

`echo ...%size%`不起作用，因为它在解析 for 块时扩展，而不是在执行时扩展。

`if exist`似乎是多余的，因为只有`for %%i in ( united_ops*.csv)`存在任何文件时才会扩展。

```
ECHO ON
setlocal EnableDelayedExpansion
del activity_ftp.log
pushd D:\My_Test
for %%i in (united_ops*.csv) do (
    set size=0
    set /A size=%%~zi         
    echo %%i,!size!,397312,624640 > D:\My_Test\activity_ftp.log
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:00:53.967

以杰布的回答为基础。

1）您的 FOR 循环可能会遍历许多与您的模式匹配的文件。但是您使用文件重定向的覆盖模式。每个找到的文件都会覆盖前一个文件的输出。您的最终输出文件永远不会超过一行。您可以使用 更改为附加模式`>>`，但有更好的方法。将整个循环括在括号中并在覆盖模式下使用`>`.

2）您将大小设置为0，然后将其设置为文件大小，然后在回显该行后不使用它。我怀疑你根本不需要这个变量，所以你不需要延迟扩展。

3）您在顶部删除的文件不包含路径信息，因此它可能没有从正确的文件夹中删除。即使是这样，也没有必要，因为无论如何您都是在覆盖模式下重定向。

4）您可以在 FOR 语句中包含路径，而不是更改当前目录。

```
ECHO ON
>"D:\My_Test\activity_ftp.log" (
  for %%i in ("d:\My_Test\united_ops*.csv") do (
    echo %%~nxi,%%~zi,397312,624640
  )
) 
```

# database - 数据库设计和扁平化复合主键

> ID：11022903
> 
> 赞同：1
> 
> 时间：2012-06-13T20:35:31.710
> 
> 标签：database, database-design, database-schema

![在此处输入图像描述](../Images/2a1734174e2522a128a297ad2105590a.png)

到目前为止，我正在使用上述模式构建一个索赔数据库。三个三部分的关键`tblPatient`在于唯一标识个人对某个问题的索赔X。只要入院/出院日期不同，`patientID`就会出现相同的情况。`tblPatient`

该数据库还关注（未显示）**与**问题X 无关的声明。这些声明将用另一个由 3 部分组成的键 , 来`patientID, claimsFromDate`标识`claimsThroughDate`。因此，`tblPatient.admissionDate`and`tblPatient.DischargeDate`不必等于`claimsFromDate`and `claimsThroughDate`，如果它们相等，那是偶然的。

由于`tblPatient.patientID`重复多次（对于那些访问不止一次的人），我不能简单地将其复制到另一个表而不破坏主键的唯一约束。我需要能够与`patientID`其余的索赔联系起来。我是否需要重新设计我`tblPatient`的只有一个字段作为主键，或者包括已经存在的三部分键并使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T21:05:09.773

首先：在一个完美、纯粹的数据库世界中，您可以将患者数据库分成两个 - 一个包含患者，另一个称为“PatientClaims”等。如果您不关心患者 ID 之外的患者特定数据，那么您至少应该重命名该表。

同样的纯粹方法也会告诉您主键被定义为“唯一标识行的唯一数据集” - 这可能是您的三个字段。（我可以假设您可以省略 DischargeDate，但前提是您确定这样做的逻辑是合理的）

但是，看到您必须使用： 1\. 一个由三部分组成的键，这永远不会令人愉快 2\. 在两个表中拥有该键组合，并且可能不得不加入它们

我建议使用您选择的数据库可用的任何自动增量功能简单地定义一个新键 - 例如“ClaimID”。

不相关的注释：你的整个州/县双表集看起来有点奇怪 - 但这可能只是我不明白你在建模什么。

# jsf-2 - 当我使用primefaces从日历中选择日期时如何呈现选定的日期？

> ID：11022916
> 
> 赞同：1
> 
> 时间：2012-06-13T20:36:51.113
> 
> 标签：jsf-2, primefaces

当我从 primefaces 的日历控件中选择日期时，所选日期应显示在 outputText 中。我为此编写了代码，但没有奏效。

```
<p:calendar mode="popup" showOn="both" mindate="15-06-2012" pattern="dd-MM-yyyy" effect="fadeIn">
       <p:ajax event="keyup" update="out1"/>
</p:calendar><br/><br/><hr/>
<h:outputText id="out1" value="#{sampleBean.selectedDate}"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-06T06:13:33.417

根据您的问题，我了解您想在输出中显示您选择的日期。

为此在你的

```
<p:calendar..... code 
```

添加声明

```
value="#{sampleBean.selectedDate}" update=":out1" 
```

这样，选定的值将保存在您的 sampleBean 的 selectedDate 属性中。

```
<h:outputText id="out1" value="#{sampleBean.selectedDate}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T06:26:03.743

好吧，我不确定您要完成什么，但是从日历返回的值会转到缺少的“值”标签，为什么您不能简单地使用类似的东西：

```
<p:calendar value="#{sampleBean.selectedDate}" id="calId"  mode="popup" showOn="both" mindate="15-06-2012" pattern="dd-MM-yyyy" effect="fadeIn" /> 
```

这应该（根据 docs 和[Showcase](http://www.primefaces.org/showcase/ui/calendarBasic.jsf;jsessionid=0C951B025110F26A32EA972969E1FE0A)）应该用日历渲染 n 输入就好了......

# jquery - Jquery：传递变量（获取）

> ID：11022922
> 
> 赞同：3
> 
> 时间：2012-06-13T20:37:10.663
> 
> 标签：jquery

我需要将变量类别作为 GET 传递，也就是说，我想在 url 中？category=category 但我不知道为什么它没有出现！

```
$(document).ready(function(e) {
    $("#sidebar li").click(function(e) {
        var category = $(this).html();
        $.ajax({
            type: 'GET',
            url: '/',
            data: {
                category: category
            },
            success: function(data) {}
        });
    });
});​ 
```

谢谢

编辑：我需要在我所在的同一页面中传递变量：index.php

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:47:36.183

应该出现在哪里？您提出了获取请求，但对返回不做任何事情。（在某些情况下可以）

```
$(document).ready(function(e) {
    $("#sidebar li").click(function(e) {
        var category = $(this).html();
        $.get('/?category='+category, function(data){
             alert('Return was: '+data);
        });
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:48:13.717

使用任何调试工具（如 firebug 或其他工具）查看请求，您将看到页面发送的请求以及为什么将其发送到 / 。您是否试图将其发布到毫无意义的同一页面上。否则尝试制作另一个文件并从那里接受获取请求。

# jquery - 在 MVC3 部分视图中动态加载内容，具有客户端验证和同名控件

> ID：11022923
> 
> 赞同：1
> 
> 时间：2012-06-13T20:37:21.257
> 
> 标签：jquery, asp.net-mvc-3, data-annotations, unobtrusive-validation, client-side-validation

我正在加载一个主视图，该视图最初使用具有必填字段的模型呈现部分视图。正如您所期望的那样，客户端验证在该初始 Partial 上工作，但是当我使用 AJAX 动态呈现相同的 Partial 视图时，客户端验证无法将动态添加的字段识别为唯一的。

我对此并不感到惊讶，因为毕竟它们具有相同的名称、id 和验证数据破折号属性，但是有没有办法让客户端验证消息分别识别每个字段，而无需在脚本中手动检查和应用客户端验证?

主要观点：

```
@{Html.EnableClientValidation(); }
@{using (Html.BeginForm()){
    @Html.Partial("_WorkItem")
    <div id="newItemHolder">

    </div>

    <div id="addItem">Add Item</div>
}}

<script type="text/javascript">
  $(document).ready(function () {
    $("#addItem").click(function () {
        $.ajax({
            type: "POST",
            data: {},
            url: "Controller/NewItem",
            success: function (data) {
                //inject partial views content to newItemHolder
                jQuery.validator.unobtrusive.parse($("#newItemHolder"));
            }
        });
    });
  });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:56:10.857

如果您不刷新包含表单，您可能还需要以下内容：

```
success: function (data) {
    var holder = $('#newItemHolder');
    // get the containing form
    var form = $(holder).closest('form');

    holder.html(data);
    form.removeData('validator');
    form.removeData('unobtrusiveValidation');
    jQuery.validator.unobtrusive.parse(form);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T20:26:17.137

我找到了解决此问题的方法，如果其他人遇到相同的情况/问题，我将包括我提出的解决方案。如果有人通过数据注释完成了使用客户端验证来验证每个部分的目标，我肯定也很想听听你是如何做到的！

我所做的是将每个部分放入一个表单中，这样验证在每个表单中的字段上都有唯一的名称，然后使用一些触发器，最终使用表单提交，我调用了以下内容。

```
$('form').each(function () {
    $(this).validate().form();
}); 
```

结果是每个必填字段都被自己验证，当为一个必填字段提供值时，它不会导致客户端验证对所有共享相同名称的控件成功。

# c - GetProcAddress 奇怪的返回地址

> ID：11022930
> 
> 赞同：0
> 
> 时间：2012-06-13T20:38:10.007
> 
> 标签：c, windows, loadlibrary, getprocaddress, pointer-address

有人解释了为什么下一个代码在 ntdll.dll 中返回一个指针？

```
GetProcAddress(LoadLibraryA("kernel32.dll"), "EncodePointer");
GetProcAddress(LoadLibraryA("kernel32.dll"), "DecodePointer"); 
```

PS：如果调用 kernel32 的导出表指向的函数，会抛出断点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T21:12:55.547

这是一个简单的*导出转发*案例，如 Matt Pietrek 的一篇出色的 MSDN 杂志文章[“深入了解 Win32 可移植可执行文件格式，第 2 部分”](http://msdn.microsoft.com/en-us/magazine/cc301808.aspx)中所述。

您可以使用 Dependency Walker 或 dumpbin 等工具自己验证这一点。

```
dumpbin /exports kernel32.dll | grep codePointer

    205   CC          DecodePointer (forwarded to NTDLL.RtlDecodePointer)
    240   EF          EncodePointer (forwarded to NTDLL.RtlEncodePointer) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-13T21:13:03.627

它被称为 DLL 转发/重定向或函数别名。出口条目的定义是：

```
entryname[=internalname] [@ordinal [NONAME]] [PRIVATE] [DATA] 
```

所以，entryname 可以定义

```
EncodePointer=ntdll.RtlEncodePointer 
```

去检查：

```
C:\>findaddress ntdll.dll RtlEncodePointer
ntdll.dll : 7C900000
RtlEncodePointer@ntdll.dll: 7C9132D9

C:\>findaddress kernel32.dll EncodePointer
kernel32.dll : 7C800000
EncodePointer@kernel32.dll: 7C9132D9 
```

*（findaddress 是我快速完成这项任务的个人工具）*

你可以在这里看到更多：http: [//msdn.microsoft.com/en-us/library/hyx1zcd3 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/hyx1zcd3(v=vs.80).aspx)

PS：我认为这是个好问题。如果您想编写小程序（甚至是恶意软件）用于研究目的，那并没有错！

# java - 获取“java.net.ProtocolException：服务器重定向太多次”错误

> ID：11022934
> 
> 赞同：36
> 
> 时间：2012-06-13T20:38:29.693
> 
> 标签：java, url, servlets, redirect, urlconnection

我正在使用如下代码发出一个简单的 URL 请求：

```
URL url = new URL(webpage);
URLConnection urlConnection = url.openConnection();
InputStream is = urlConnection.getInputStream(); 
```

但在最后一行，我得到“重定向太多次错误”。如果我的“网页”变量是 google.com，那么它可以正常工作，但是当我尝试使用我的 servlet 的 URL 时，它会失败。看来我可以调整它跟随重定向的次数（默认为 20）：

```
System.setProperty("http.maxRedirects", "100"); 
```

但是当我把它提高到 100 时，抛出错误肯定需要更长的时间，所以我知道它正在尝试。但是，我的 servlet 的 URL 在（任何）浏览器中都可以正常工作，并且在 firebug 中使用“persist”选项似乎只重定向一次。

关于我的 servlet 的更多信息......它在 tomcat 中运行，并由 apache 使用'mod-proxy-ajp'。另外值得注意的是，它使用表单身份验证，因此您输入的任何 URL 都应将您重定向到登录页面。正如我所说，这在所有浏览器中都能正常工作，但由于某种原因，重定向不适用于 Java 6 中的 URLConnection。

感谢阅读……想法？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-06-14T15:56:46.530

它显然是在无限循环中重定向，因为您不维护用户会话。会话通常由 cookie 支持。您需要`CookieManager`在使用之前创建一个`URLConnection`.

```
// First set the default cookie manager.
CookieHandler.setDefault(new CookieManager(null, CookiePolicy.ACCEPT_ALL));

// All the following subsequent URLConnections will use the same cookie manager.
URLConnection connection = new URL(url).openConnection();
// ...

connection = new URL(url).openConnection();
// ...

connection = new URL(url).openConnection();
// ... 
```

### 也可以看看：

*   [使用 java.net.URLConnection 触发和处理 HTTP 请求](https://stackoverflow.com/questions/2793150/how-to-use-java-net-urlconnection-to-fire-and-handle-http-requests)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-20T22:29:57.630

Duse，我添加了以下几行：

```
java.net.CookieManager cm = new java.net.CookieManager();
java.net.CookieHandler.setDefault(cm); 
```

看这个例子：

```
java.net.CookieManager cm = new java.net.CookieManager();
java.net.CookieHandler.setDefault(cm);
String buf="";
dk = new DAKABrowser(input.getText());
try {
    URL url = new URL(dk.toURL(input.getText()));
    DataInputStream dis = new DataInputStream(url.openStream());
    String inputLine;
    while ((inputLine = dis.readLine()) != null) {
        buf+=inputLine;
        output.append(inputLine+"\n");
    }
    dis.close();
} 
catch (MalformedURLException me) {
    System.out.println("MalformedURLException: " + me);
}
catch (IOException ioe) {
    System.out.println("IOException: " + ioe);
}
titulo.setText(dk.getTitle(buf)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-20T18:18:01.820

我在 unix 环境中的 Tomcat6 上使用 Jenkins 并得到了这个错误。出于某种原因，升级到 Java7 解决了它。我很想知道为什么会修复它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-10T13:05:58.647

我遇到了同样的问题，并且花了相当多的时间来理解这个问题。因此，总结问题在于标题不匹配。

考虑下面是我的资源

```
 @GET
  @Path("booksMasterData")
  @Produces(Array(core.MediaType.APPLICATION_JSON))
  def booksMasterData(@QueryParam("stockStatus") stockStatus : String): Response = {
 // some logic here to get the books and send it back
    } 
```

这是客户端代码，它试图连接到我的上述资源

```
ClientResponse clientResponse = restClient.resource("http://localhost:8080/booksService").path("rest").path("catalogue").path("booksMasterData").accept("application/boks-master-data+json").get(ClientResponse.class); 
```

并且错误正好在上面。

出了什么问题？

我的资源正在使用

> “应用程序/json”

在

> @Produces 注解

我的客户正在使用

> accept("application/boks-master-data+json") 这就是问题所在。

我花了很长时间才发现这一点，因为错误与此无关。突破是当我尝试使用邮递员访问我的资源时

> 接受->“应用程序/json”标头

它工作得很好，但是

> Accept-> "application/boks-master-data+json" 标头没有。

再一次，即使邮递员也没有给我正确的错误。这个错误太笼统了。请参阅下图以供参考。 [![通用错误消息](../Images/fe79bee5ae4087f78dfaf498c2fee45a.png)](https://i.stack.imgur.com/XJRVX.jpg)

# ffmpeg - Http直播流视频分割。非 Mac 方法

> ID：11022935
> 
> 赞同：2
> 
> 时间：2012-06-13T20:38:30.743
> 
> 标签：ffmpeg, h.264, http-live-streaming

有人知道在非 Mac 平台上使用 http 直播工具的好方法吗？你能至少告诉我是否有好的选择吗？我需要 mediafilesegmenter 和 mediastreamvalidator。

或者也许有人有源代码或类似的东西......

UPD：我尝试过不同的分段器，其中大部分都是基于[Carson 的开源分段器](https://github.com/carsonmcdonald/HTTP-Live-Video-Stream-Segmenter-and-Distributor)。现在苹果的 mediafilesegmenter 和这个的区别在于它只需要一个传输流，而不是任何视频。我需要分割 h264 视频。当我使用 ffmpeg 将 h26s 转换为 mpeg-ts 时，我最终会得到更大的文件。即使我尝试保留相同的音频编解码器（aac），它也会将视频编解码器从 avc 更改为 mpeg-ts。

该死的，我讨厌苹果。如果他们甚至不为其他平台提供解决方法，他们怎么能将这个东西作为标准提出来。

我仍然需要找到一种方法来分割 h264 视频，并将分割的文件保存在 avc 和 aac 编解码器中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T10:12:44.680

如果您没有指定视频编解码器并指定 mpeg2 传输流容器，则 FFmpeg 将默认为 MPEG2 视频编码。如果您已经有 MPEG4-AVC(h.264) 编码的视频和 AAC 音频，那么您可以指示 FFmpeg 不要使用以下选项重新编码视频和音频：`-vcodec copy -acodec copy`

你的最终命令应该是这样的：

> ffmpeg -i 输入文件 -vcodec 复制 -acodec 复制 -f mpegts outputfile.ts

然后，您可以使用其中一种分段器工具来分段和构建播放列表。值得一提的是，新版本的 FFmpeg 支持分段，但您仍然需要一个程序来创建播放列表文件。

# visual-studio-2010 - .csproj 文件中的重复项目引用条目

> ID：11022940
> 
> 赞同：2
> 
> 时间：2012-06-13T20:38:50.133
> 
> 标签：visual-studio-2010, reference, csproj

我最近签入了对 ac# 项目的更改，在签入期间，我不得不对 .csproj 文件进行手动合并。在进行合并时，我注意到项目中的所有项目引用都有重复的条目。

具体来说，在被合并的项目中引用的每个其他项目都复制了 ProjectReference 标记。像这样：

```
<ProjectReference Include="..\..\..\DataSourceInterfaces\DataSourceInterfaces.csproj">
  <Project>{335ED423-8DC5-4D56-86D6-9A1B0F7DB0B9}</Project>
  <Name>DataSourceInterfaces</Name>
</ProjectReference>
<ProjectReference Include="..\..\..\DataSourceInterfaces\DataSourceInterfaces.csproj">
  <Project>{335ED423-8DC5-4D56-86D6-9A1B0F7DB0B9}</Project>
  <Name>DataSourceInterfaces</Name>
</ProjectReference> 
```

如果我进入 Visual Studio UI 并删除对 DataSourceInterfaces 项目的引用，则只会删除一个标签，并且下次加载项目时，引用会显示在引用列表中，就好像它没有被删除一样.

这很容易通过手动删除重复的条目来解决，并且似乎不会导致任何问题，但我想知道是什么首先导致了问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:40:13.393

> 我想知道是什么首先导致了这个问题。

听起来您的合并工具在手动合并期间失败了，并添加了重复的项目引用。当您手动合并时，您需要注意不要发生这种类型的事情 - 所需要的只是缩进或空白更改等事情的细微差别，偶尔会弄乱一些合并工具（这在很大程度上取决于问题，虽然）。

# c# - 将数据附加到 使用 .NET 标记

> ID：11022946
> 
> 赞同：1
> 
> 时间：2012-06-13T20:39:16.357
> 
> 标签：c#, jquery, .net, html, append

所以我的html文件中有以下情况：

```
<div id = "imagePreview">
    <div id = "earlyDetectionPlots">
        <div id = "earlyDetectionScoreMetricsPlots">
        </div>
        <div id = "earlyDetectionVariableMetricsPlots">
        </div>
        <div id = "earlyDetectionPseudoStandardizedCoefficientPlots">
        </div>
    </div>
</div> 
```

我有一个jQuery函数如下：

```
 $(document).on('click', 'a[data-link]', function () {
        var $this = $(this);
        url = $this.data('link');
        $("#imagePreview").load("imageProcess.aspx?" + url);
    }); 
```

其中 url 具有类似等`GET`形式的参数。`m=2k01&type=EarlyDetection`

在我的`imageProcess.aspx`文件中，我使用正则表达式从文件夹中抓取一堆图像。

但是，上面的每个 div 中都将包含不同的数据。我知道如何决定哪些图像去哪里，但我不知道如何使用 c# 说类似的东西，`#earlyDetectionScoreMetricsPlots.append("image.png"),`因为我不想将图像直接附加到 imagePreview 而是附加到其中的`sub`div 中，就我而言知道，我不能在`imageProcess`文件中使用 jQuery。

（我认为可能有一种方法可以调用`imageProcess.aspx`文件中对应于不同的特定函数`<divs>`，但我不知道如何使用 jQuery 来做到这一点）。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:44:07.837

您要么需要更复杂的 jQuery，要么返回您想要的实际`#imagePreview`内容`imageProcess.aspx`

# ios - GHUnit 跳转到代码中的错误

> ID：11022956
> 
> 赞同：0
> 
> 时间：2012-06-13T20:39:46.310
> 
> 标签：ios, unit-testing, assertion, gh-unit

GHUnit (iOS) 是否支持跳转到导致测试失败的代码中的断言？

我正在评估 GHUnit 并认为我之前已经完成了这项工作，但现在它没有。那么是我记错了还是我的设置有问题？它在模拟器中完美运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:51:45.077

尝试在模块 libobjc.A.dylib 中为符号 objc_exception_throw 设置断点。

如果这没有帮助，请尝试 CoreFoundation 模块的符号 -[NSException raise]。

我只是不记得其中哪一个适用于 GHUnit ......

# java - 如何更改布局的内容？

> ID：11022960
> 
> 赞同：-1
> 
> 时间：2012-06-13T20:40:02.130
> 
> 标签：java, android

在我的 Android 应用程序中，我有一个跟踪器活动，在该活动中，我根据所选日期从 sqlite 数据库中检索锻炼信息（姓名、期间、燃烧的卡路里），并以线性布局显示这些信息，以及作为用户的我的问题选择新日期检索到的数据显示在另一个“新”布局中出现在旧布局上方，但实际上我想要做的是在同一布局上显示新检索到的数据“使用新检索到的数据更改布局内容”，我已尝试删除所有视图的方法，但由于数据出现几分钟然后出现显示，所以它不起作用

我怎么能做到这一点：当用户选择一个新日期时，在同一布局上显示的新检索数据“用新数据刷新旧数据”而不是在新布局中显示它们。我怎么能这样做？请帮我..

**爪哇代码**

```
public class Tracker extends BaseActivity
  {  
private Button date_btn;
private ImageButton  left_btn;
private ImageButton  right_btn;
private ImageView    nodata;
private TextView ex_name;
private TextView ex_BCals;

private LinearLayout  excercises_LL;
private LinearLayout content_LL ;
private LinearLayout  notes;
private LinearLayout  details;  
private int year,month,day;
private double  tot_excals_burned;
private Calendar  localCalendar; 
private static final int DATE_DIALOG_ID=0;
private  boolean  has_ex_details;
private boolean  has_meal_details=false;
private Cursor exercises_cursor;

public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.tracker);

    date_btn=(Button)findViewById(R.id.btn_date);
    date_btn.setText(FormatDate());
    date_btn.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            localCalendar = Calendar.getInstance(); 
            year = localCalendar.get(1);
            month= localCalendar.get(2);
            day  =  localCalendar.get(5);
            showDialog(DATE_DIALOG_ID);
        }
    });

    left_btn=(ImageButton)findViewById(R.id.btn_left);
    left_btn.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            localCalendar.add(5, -1);
            date_btn.setText(FormatDate(localCalendar,"EEEE, d/MMM/yyyy"));

            RefreshExercisesData();
            RefreshNoDataImage();
        }
    });

    right_btn=(ImageButton)findViewById(R.id.btn_right) ;
    right_btn.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            localCalendar.add(5, 1);
            date_btn.setText(FormatDate(localCalendar,"EEEE, d/MMM/yyyy"));

            RefreshExercisesData();
            RefreshNoDataImage();

        }
    });

    details=(LinearLayout)findViewById(R.id.ll_details);
    notes=(LinearLayout)findViewById(R.id.ll_notes);
    excercises_LL=(LinearLayout)findViewById(R.id.ll_exercises);
    nodata=(ImageView)findViewById(R.id.nodata_imgV);

    RefreshExercisesData();
    RefreshNoDataImage();

}

private String  FormatDate()
{   

    localCalendar = Calendar.getInstance();
    return new  SimpleDateFormat("EEEE, d/MMM/yyyy").format(localCalendar.getTime());

}

private String FormatDate(int year, int month, int day)
{   
    localCalendar = Calendar.getInstance();
    localCalendar.set(year, month, day);

    return new  SimpleDateFormat("EEEE, d/MMM/yyyy").format(localCalendar.getTime());
}

private String FormatDate(Calendar   calendar , String  format)
{

    return new  SimpleDateFormat(format).format(calendar.getTime());

}

private void RefreshExercisesData()
{   

    tot_excals_burned=0;

    DBAdapter db = new DBAdapter(this);
    db.open();
    String selected_date= date_btn.getText().toString();
    Log.e("date", selected_date);

    exercises_cursor = db.getExerciseInfo(selected_date);

    if(exercises_cursor.getCount() !=0 )
    {

        has_ex_details=true;

        details.setVisibility(0);
        nodata.setVisibility(8);
        notes.setVisibility(0);

        //excercises_LL.removeAllViews();
        excercises_LL.setWeightSum(1.0F);
        excercises_LL.setVisibility(0);

        excercises_LL.setOrientation(LinearLayout.VERTICAL);

        LayoutInflater exc_LayoutInflater = (LayoutInflater)getApplicationContext().getSystemService("layout_inflater");
        LinearLayout layout = (LinearLayout)exc_LayoutInflater.inflate(R.layout.tracker_header_item,null);
        TextView   tot_ex_cals_value=((TextView)(layout).findViewById(R.id.tv_tot_cals_value));
        TextView   exs_title=((TextView)(layout).findViewById(R.id.tv_item_title)) ;
        exs_title.setText("Exercises ");

        (layout).setPadding(0, 36, 0, 0);
        excercises_LL.addView((View)layout, 0);
        int i = 1;

        if (exercises_cursor.moveToFirst())
        {
            do 
            {
                content_LL=new LinearLayout(this);
                ex_name=new TextView(this);
                ex_name.setText( exercises_cursor.getFloat(1)+","  +exercises_cursor.getString(0) + "min ");
                ex_name.setTextColor(R.color.black);
                content_LL.addView(ex_name,0);

                ex_BCals=new TextView(this);
                ex_BCals.setText(Round(exercises_cursor.getFloat(2)) +" ");
                ex_BCals.setTextColor(R.color.color_black);
                content_LL.addView(ex_BCals,1);

                tot_excals_burned = tot_excals_burned+exercises_cursor.getFloat(2);

                excercises_LL.addView(content_LL, i);

                i++; 

            }
            while (exercises_cursor.moveToNext());

        }
        tot_ex_cals_value.setText(Round(tot_excals_burned) );

    }
    else if(exercises_cursor.getCount()==0 ||tot_excals_burned==0)
    {  

        has_ex_details=false;

        RefreshNoDataImage();

    }
    exercises_cursor.close();
    exercises_cursor.deactivate();
    db.close();

}

private void RefreshNoDataImage()
{    
    if(has_ex_details==false && has_meal_details==false)
    {       

        notes.setVisibility(8);
        excercises_LL.setVisibility(8);
        nodata.setImageResource(R.drawable.bg_nodata);
        nodata.setVisibility(View.VISIBLE);

    }

    else
        nodata.setVisibility(8);

}

protected Dialog onCreateDialog(int id)
{
    switch (id) {

    case DATE_DIALOG_ID:
        return new DatePickerDialog(this, mDateSetListener, this.year, this.month, this.day);
    }
    return null;
}

private DatePickerDialog.OnDateSetListener mDateSetListener = new DatePickerDialog.OnDateSetListener()
{
    public void onDateSet(DatePicker paramDatePicker, int year, int monthofYear, int dayofMonth)
    {
        Tracker.this.year=year;
        month=monthofYear;
        day=dayofMonth;
        date_btn.setText(FormatDate(year,month,day));
        RefreshExercisesData();
        RefreshNoDataImage();

    }

};

private  String Round(double num) {
    return String.format("%.1f%n", num);

}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:10:03.007

如果你有一个布局，例如这样的一个：

```
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">
    <TextView
        android:id="@+id/name_textview"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />
    <TextView
        android:id="@+id/calories_burned_textview"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />
</RelativeLayout> 
```

然后在您可以从 sqlite db 访问数据的活动中，您可以通过查找视图并使用 setText 方法来修改此布局中的现有文本视图。

```
// load new data occurs above, now want to set
TextView name = (TextView)findViewById(R.id.name_textview);
name.setText(newName);

TextView calsBurned = (TextView)findViewById(R.id.calories_burned_textview);
calsBurned.setText(newCalsBurned); 
```

从您的描述中听起来，有可能每次单击某个加载按钮时，您都通过代码将这些文本视图添加到 Activity 中。您可以这样做，只需保留对您添加的这些文本视图的引用，稍后在加载新条目时使用 setText() （但不要再次创建文本视图）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:55:07.473

如果您希望我们查看任何代码示例，您似乎需要编辑您的问题。

如果这只是练习的几个文本，那么在布局 xml 中提供这些视图 id 就足够了，以便可以在您的活动中引用它们。

然后，您可以在 OnCreate 中使用 findViewById 获取您的视图，当您收到新练习的数据时，您可以使用 TextView.setText() 等更新这些视图。

# php - 3 个表格 = 1 个列表

> ID：11022961
> 
> 赞同：1
> 
> 时间：2012-06-13T20:40:05.187
> 
> 标签：php, sql

我有三个表（个人、组和唱片公司），并希望使用它们之间的信息来列出唱片公司内的人员。示例：它应该找到 companyID 为 # 的个人和组并列出它们。如何在不重复结果的情况下正确创建它？

```
// Connect to database
include "mysqli_connect.php";

// Set variables
$url_num = $_GET['company_id'];
$company_num = "";
$company_members = "";
$company_members2 = "";

//Check for artist id pagination
if(is_numeric($url_num)){
    $company = intval($url_num);
}else{
    $company = 1;
}

// Construct our join query
$sqli = "SELECT DISTINCT * FROM recordlabels
INNER JOIN individuals ON individuals.companyID=recordlabels.companyID
INNER JOIN groups ON groups.companyID=recordlabels.companyID
WHERE recordlabels.companyID = '{$company}'";

// Create results
$result = mysqli_query($link, $sqli);

//Check for albums
$totalmembers = mysqli_num_rows($result);

// Checking if query is successful
if($result){

// Print out the contents of each row into a table 
while($row = mysqli_fetch_array($result, MYSQLI_BOTH)){

// Assign value of column if not empty, otherwise "DamJuNoImage" (Thanks to Jonathan Sampson from Stack Overflow)
    $companyen = empty( $row["companyen"] ) 
        ? "Unknown" 
        : $row["companyen"];
    $companyko = empty( $row["companyko"] ) 
        ? "Unknown" 
        : $row["companyko"];
    $companyType = empty( $row["companyType"] ) 
        ? "Unknown" 
        : $row["companyType"];
    $founded = empty( $row["established"] ) 
        ? "Unknown" 
        : $row["established"];
    $founder = empty( $row["companyFounder"] ) 
        ? "Unknown" 
        : $row["companyFounder"];
    $information = empty( $row["information"] ) 
        ? "Unknown" 
        : $row["information"];
    $location = empty( $row["companyLocation"] ) 
        ? "Unknown" 
        : $row["companyLocation"];
    $homepage = empty( $row["companyPage"] ) 
        ? "#" 
        : $row["homepage"];
    $solopic = empty( $row["solopic"] ) 
        ? "DamjuNoImage" 
        : $row["solopic"];
    $soloen = empty( $row["soloen"] )
        ? "Unknown"
        : $row["soloen"];
    $solokn = empty( $row["solokn"] )
        ? "Unknown"
        : $row["solokn"];
    $grouppic = empty( $row["grouppic"] ) 
        ? "DamjuNoImage" 
        : $row["grouppic"];
    $groupen = empty( $row["groupen"] )
        ? "Unknown"
        : $row["groupen"];
    $groupkn = empty( $row["groupkn"] )
        ? "Unknown"
        : $row["groupkn"];
    $company_members .= '<li><a href="#">
      <div class="image"><img src="pathhere/' . $solopic . '"></div>
      <p class="datatitle2">' . $soloen . '</p>
      <p class="data-info2">' . $solokn . '</p>
      </a></li>';
    $company_members2 .= '<li><a href="#">
      <div class="image"><img src="pathhere' . $grouppic . '"></div>
      <p class="datatitle2">' . $groupen . '</p>
      <p class="data-info2">' . $groupkn . '</p>
      </a></li>';
    $listofmembers = $company_members . $company_members2; 
} // End of while statement
}else{
    echo "No people under $companyen";
} // End of If statement 
```

提供（希望）更好的视觉效果。

*   鲍勃（个人）
*   丽莎（个人）
*   狂热（团体）

我在寻求帮助之前的测试给出了这个结果：

*   鲍勃（个人）
*   丽莎（个人）
*   狂热（团体）
*   狂热（团体）

那是因为我把个人和群体的产出放在了各自独立的价值中。然后我附和`$var1 . $var2`了我觉得会出错的地方。

更新：如果没有人能弄清楚，我将重做我的数据库和表。谢谢你们所有的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:43:27.643

问题很可能来自您的 SQL 代码。具体来说，您似乎有一些非规范化，在*and*`companyId`中都有，并且有一个外键。`individual` *`group``individual``groupId`*

 *鉴于这种关系，您很可能希望按照以下方式编写您的陈述：

```
SELECT companyEn, companyKo, companyType, established, companyFounder, 
       information, companyLocation, companyPage,
       soloPic, soloEn, soloKn, 
       groupPic, groupEn, groupKn
FROM recordLabels
JOIN groups 
ON groups.companyId = recordLabels.companyId
JOIN individuals
ON individuals.groupId = groups.groupId
WHERE recordLabels.companyId = $company 
```

其他次要注意事项：
据我所知，最佳实践通常给表格命名单*数*，而不是复数。和列
是怎么回事？在我看来，您可能正在进行一些国际化（英语和韩语？） - 如果是这样，您将希望从原始表中提取这些列，并开始翻译表。如果您以后需要添加对其他语言的支持，这将对您有**很大帮助。**`....En``...Ko`

 *** * *

# 编辑：

尽管有多种方法可以处理翻译表，但您可能希望每个需要翻译数据的表都有一个翻译表。您可能还需要一个标准语言表以供参考：

```
language
============
id  -- autoincrement - or possibly just use code
code  -- ISO 3-letter code, unique
shortCode  -- ISO 2-letter code, unique (I think?)
name  -- ISO standard name 
```

举`recordLabel`个例子：

1）创建翻译表，所有需要翻译的列：

```
recordLabelTranslation
=====================
companyId  -- fk to recordLabel.companyId, or whatever the primary key of that table is
languageId  -- fk to language.id
company  -- whatever 'companyEn' and 'companyKo' was (company name?  why translate?) 
```

2) 删除所有已翻译的列 ( `companyEn`, `companyKo`)

3）（可选）对视图进行编码，以便您轻松参考。有两种口味：

-> 语言的简单连接

```
CREATE VIEW Record_Label_Language as 
SELECT recordLabel.companyId, recordLabel.information, -- all current columns...
       recordLabelTranslation.languageId, recordLabelTranslation.company
FROM recordLabel
JOIN recordLabelTranslation
ON recordLabelTranslation.companyId = recordLabel.companyid 
```

-> 加入语言，默认为英语（或其他语言）

```
CREATE VIEW Record_Label_Language_Default as 
SELECT recordLabel.companyId, recordLabel.information, -- all current columns...
       COALESCE(recordLabelTranslation.languageId, language.languageId),
       COALESCE(recordLabelTranslation.company, dflt.company)
FROM recordLabel
JOIN recordLabelTranslation as dflt
ON dflt.companyId = recordLabel.companyid
AND dflt.languageId = [englishLanguageId]
CROSS JOIN language
LEFT JOIN recordLabelTranslation
ON recordLabelTranslation.companyId = recordLabel.companyId
AND recordLabelTranslation.languageId = language.id 
```***

# jquery - 在点击方法之前将输入的 VAL 分配给其他输入

> ID：11022963
> 
> 赞同：0
> 
> 时间：2012-06-13T20:40:17.377
> 
> 标签：jquery

我的网站上有 3 个日期范围表格。本质上，我想隐藏两个日期范围，只向用户显示一个。但是，我仍然需要将在一个日期范围内选择的值分发到其他日期范围。我尝试在单击之前将第一个日期范围的 VAL 应用于变量并将其应用于其他输入，但它似乎不起作用。

```
$('#edit-submit-calendar-full').click(function(){
                var startDate = $('#edit-fd-min-datepicker-popup-1').val();
                var endDate = $('#edit-fd-max-datepicker-popup-1').val();

                $('#edit-fw-min-datepicker-popup-1').val(startDate);
                $('#edit-fw-min-datepicker-popup-1').val(endDate);

                $('#edit-sd-min-datepicker-popup-1').val(startDate);
                $('#edit-sd-min-datepicker-popup-1').val(endDate);
            }); 
```

编辑：这似乎确实适用于这个基本示例，但是当它重定向到另一个页面时，输入永远不会被填写。做一些更多的测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T13:08:32.807

事实证明，我的选择器出错了。上面的代码可以正常工作。

# objective-c - “找不到接口声明 "

> ID：11022964
> 
> 赞同：5
> 
> 时间：2012-06-13T20:40:23.953
> 
> 标签：objective-c, objective-c-category

[截图](http://imgur.com/a/Jf7gY)

我很难在我制作的课程上设置类别。根据我的阅读，Objective-C 允许您在*任何*类上创建一个类别，而不仅仅是闭源类。（老实说，任何其他方式都没有任何意义。）

当然，我可以将类别消息添加到实际的类文件中，但我想将它们分开（因为类别是可以非常普遍使用的类的一种不常见的特殊用途）。我想分享课程，但保持类别私有......无论如何。

我已经剥离了类别，只显示手头的问题。我（目前）在第一类消息上收到四个错误。我在那条线上收到的错误数量与它被引用的次数成正比，但它并不是均匀上升的。有谁知道这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T21:21:58.837

由 ByteCollection.h 导入的 Resources.h 文件导入 ByteCollection+words.h。因此，当 ByteCollection+words.h 导入 ByteCollection.h 时，这会导致循环依赖†。打破循环依赖的最简单方法是将其中一个导入移动到实现文件而不是头文件。看起来这应该可以通过 Resources.h 实现。

† 您可能想知道，如果您有循环依赖，为什么会有问题？好吧，#import 指令实际上只是在文本上包含您指定的文件，就像您复制粘贴一样。它还智能地不包含两次文件，因为这会创建重复的代码。但这意味着当文件 A 说“我希望文件 B 在我之前”并且文件 B 说“我希望文件 A 在我之前”时，其中一个会感到失望，这会导致类似错误你来了。

# ios - 这条线的正确内存管理？(Cocos2D)

> ID：11022970
> 
> 赞同：0
> 
> 时间：2012-06-13T20:40:53.767
> 
> 标签：ios, memory-management, cocos2d-iphone, ccsprite

我得到以下行作为 Xcode 中的泄漏：

```
someSprite = [[CCSprite alloc] initWithFile:(NSString*)obj]; 
```

我知道我在那里分配它，但我认为 Cocos2D 处理了所有的内存管理。无论如何，我应该如何正确处理那条线以防止泄漏？

我应该简单地使用自动释放还是还有更多？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:56:12.230

Cocos2D 不会为您处理内存。但是，我认为您可以使用自动引用计数 (ARC) 来摆脱自己处理内存的麻烦。然后你可以使用 Cocos2d 作为静态库，因为 cocos2d 不支持 ARC。

如果你想在没有 ARC 的情况下解决你的问题，只需插入一个自动释放。如果它是实例变量，请改为在您的 dealloc 方法中释放它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:11:10.477

通常，最好使用返回自动释放对象的静态构造函数。对于您的情况，它将是

```
[CCSprite spriteWithFile:(NSString*)obj]; 
```

当您将其添加到任何父级时，它将被保留

# django - Django ajax 将变量传递给视图

> ID：11022972
> 
> 赞同：0
> 
> 时间：2012-06-13T20:41:30.460
> 
> 标签：django, django-views, django-ajax-selects

我是 Django + Ajax 的新手。我的问题是我无法从我的 ajax`POST`请求中获取值。我正在使用`jquery post`.

我的任务是对可拖动列表项进行排序。拖放不是问题。从`POST`请求中获取值是问题所在。它返回`MultiValueDictKeyError`

`"Key 'ages' not found in <QueryDict: {u'action': [u'updateRecords'], u'ages[]': [u'80', u'81', u'79', u'82', u'83', u'84', u'85', u'86']}>"`

这是我的ajax：

```
$(function() { 
    var url = ""; /* won't place it*/
    $("ul#ages").sortable({ opacity: 0.6, cursor: 'move', update: function() {
            var order = $(this).sortable("serialize") + '&action=updateRecords';
            $.post(url, order, function(theResponse){
                alert('success');
            });
        }
    });
}); 
```

这是意见：

```
if request.is_ajax():
        if request.POST['action'] == "updateRecords":
            update_record_array = request.POST['ages']

            order_counter = 1;

            for record_id in update_record_array:
                Age.objects.filter(id=record_id).update(order_id=order_counter)
                order_counter += 1 
```

谁能帮我吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:07:37.560

错误消息显示出了什么问题 - 您正在查找 key `ages`，但您正在发送`ages[]`带有一些额外方括号的内容。

如果您将这些括号放在字段名称中，则不需要它们 - 那是 PHP 主义。（这可能不是你的错：众所周知，jQuery 会自己添加它们。）在任何情况下，你都希望使用它`request.POST.getlist(fieldname)`来获取与该键关联的多个值的列表。

# wpf - 文本块文本换行不起作用

> ID：11022973
> 
> 赞同：2
> 
> 时间：2012-06-13T20:41:30.617
> 
> 标签：wpf, textblock, word-wrap, datagridtemplatecolumn

有人可以告诉我为什么包装在这些文本块中不起作用吗？我只是不知道为什么，我将所有堆栈面板都更改为网格以避免无限空间问题，但它仍然不起作用......

```
<Border x:Name="SummaryRightSideContainerBorder" Grid.Column="1"
        Margin="10,10,10,10" BorderBrush="Black"
        BorderThickness="1">
    <ContentControl x:Name="SummaryRightSideContainerContentControl" Content="{Binding SelectedItem, ElementName=SummaryTreeView}">
        <ContentControl.Resources>
            <DataTemplate DataType="{x:Type ViewModelsProject:ProjectViewModel}">
                <StackPanel>
                    <TextBlock Text="Displaying Project DataContract stuff..." />
                </StackPanel>
            </DataTemplate>
            <DataTemplate DataType="{x:Type ViewModelsProject:SequenceViewModel}">
                <StackPanel>
                    <TextBlock Text="Displaying Sequence DataContract stuff..." />
                </StackPanel>
            </DataTemplate>
            <DataTemplate DataType="{x:Type ViewModelsProject:GroupViewModel}">
                <StackPanel>

                    <DataGrid Margin="10" AutoGenerateColumns="False"
                                  Background="Transparent" BorderThickness="0"
                                  CanUserAddRows="False"
                                  CellStyle="{DynamicResource dgCellStyle}"
                                  ColumnHeaderStyle="{DynamicResource dgHeader}"
                                  DataContext="{Binding ElementName=SummaryTreeView,
                                                        Path=SelectedItem}"
                                  GridLinesVisibility="None"
                                  ItemsSource="{Binding Standards}"
                                  Padding="0" RowHeaderWidth="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <DataGrid.Resources>
                            <Style x:Key="dgHeader" TargetType="{x:Type DataGridColumnHeader}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type DataGridColumnHeader}">
                                            <TextBlock Width="{TemplateBinding Width}"
                                                           Padding="5"
                                                           Text="{TemplateBinding Content}"
                                                           TextAlignment="Left">
                                                    <TextBlock.Background>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                            <GradientStop Offset="0.0" Color="#373638" />
                                                            <GradientStop Offset="1.0" Color="#77797B" />
                                                        </LinearGradientBrush>
                                                    </TextBlock.Background>
                                            </TextBlock>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="OverridesDefaultStyle" Value="True" />
                                <Setter Property="Background" Value="Green" />
                                <Setter Property="Foreground" Value="White" />
                                <Setter Property="FontSize" Value="12" />
                                <Setter Property="Background">
                                    <Setter.Value>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                            <GradientStop Offset="0.0" Color="#373638" />
                                            <GradientStop Offset="1.0" Color="#77797B" />
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                            <Style x:Key="dgCellStyle" TargetType="{x:Type DataGridCell}">
                                <Style.Triggers>
                                    <Trigger Property="DataGridCell.IsSelected" Value="True">
                                        <Setter Property="Background" Value="White" />
                                        <Setter Property="Foreground" Value="Black" />
                                        <Setter Property="BorderThickness" Value="0" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="Standards">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>

                                        <Grid Margin="5">
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                            </Grid.RowDefinitions>
                                            <TextBlock Grid.Row="0" Text="{Binding Path=StepMaster.Description}" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                            <Grid Grid.Row="1">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Standard: " VerticalAlignment="Top"/>
                                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Path=Standard}" Margin="5,0,0,0" VerticalAlignment="Top" TextWrapping="Wrap"/>

                                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Details: " VerticalAlignment="Top"/>
                                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Path=Details}" Margin="5,0,0,0" VerticalAlignment="Top" TextWrapping="Wrap"/>

                                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Comments: " VerticalAlignment="Top"/>
                                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Path=Comments}" Margin="5,0,0,0" VerticalAlignment="Top" TextWrapping="Wrap"/>
                                            </Grid>
                                        </Grid>

                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                </StackPanel>
            </DataTemplate>
            <DataTemplate DataType="{x:Type ViewModelsProject:StepViewModel}">
                <UniformGrid Rows="3">
                    <TextBlock Margin="10" FontWeight="DemiBold"
                               Text="Standards" />
                    <TextBlock Margin="10" FontWeight="DemiBold"
                               Text="Standards Details" />
                    <StackPanel Orientation="Vertical">
                        <DataGrid Margin="10" AutoGenerateColumns="False"
                            <Another data grid is here />
                        </DataGrid>
                    </StackPanel>
                </UniformGrid>
            </DataTemplate>
        </ContentControl.Resources>
    </ContentControl>
</Border> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T14:47:20.107

原来使这项工作的唯一方法是直接在 DataGrid 中使用属性：

```
MaxWidth="{Binding ElementName=SummaryRightSideContainerBorder, Path=ActualWidth}" ColumnWidth="*" 
```

使用 MaxWidth 是为了使 Datagrid 本身不超过其容器边界，使用 ColumnWidth 是为了使列使用数据网格中可用空间的 100%。

Blam 的回答让我找到了解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T21:13:45.263

作为答案，您需要将第二列设置为

```
<ColumnDefinition Width="*"/> 
```

所以它受到约束。* 表示容器的大小。现在它正在容器（屏幕）之外生长

第一列自动是好的

# python - 如何打开金字塔内的文件进行阅读？

> ID：11022974
> 
> 赞同：2
> 
> 时间：2012-06-13T20:41:34.750
> 
> 标签：python, pyramid

我有一个典型的 Pyramid Web 应用程序设置。应用程序目录（我不知道这个目录在 Pyramid 中叫什么？）包含静态、模板和**ini** .py 文件。在这个目录中，我还创建了一个名为的目录`static_content`，用于存储一些特殊的报告模板。

在我的视图代码中，我使用这样的东西来读取目录子目录中的`static_content`文件：

```
f = open("/static_content/abc/report_template.tpt" , "r") 
```

然后在我的**init** .py 文件中添加了一行：

```
config.add_static_view("static_content", "static_content") 
```

我收到一个 IO 错误.....我该如何解决这个问题？

问候， 马克·黄

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:51:46.747

```
f = open("/static_content/abc/report_template.tpt" , "r") 
```

文件路径中的前导斜杠表示您正在为其提供完整路径（文件位于此确切位置）。如果你想要一个相对路径，去掉前导斜杠：

```
f = open("static_content/abc/report_template.tpt" , "r") 
```

*这告诉它从当前目录*遵循该路径。

您可能想查看[这个问题](https://stackoverflow.com/questions/4934806/python-how-to-find-scripts-directory)，以便从脚本文件构建相对路径。

# winforms - DateTimePicker：既不使用日历也不使用旋转按钮

> ID：11022977
> 
> 赞同：0
> 
> 时间：2012-06-13T20:41:50.677
> 
> 标签：winforms, .net-4.0, datetimepicker

我想利用`DateTimePicker`' 的日期验证，但日历对我们的客户来说设置日期似乎很麻烦（他们宁愿只使用键盘，在表单中按标签）。

因此，我仔细查看了[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.showupdown.aspx)，发现摆脱日历的一种方法是将`ShowUpDown`属性设置为 true。所以我得到了这个：

![在此处输入图像描述](../Images/89a17af9dc53fe681107002193d2cc9f.png)

但是，我们的客户现在说他们不想使用旋转按钮，因此他们不希望它可见/可访问。即他们想要这个：

![在此处输入图像描述](../Images/e76cf7abc7665691d31dbc339b5bd538.png)

但是，如果我设置`ShowUpDown`为 false，我将返回日历。还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T12:33:26.697

不得不推出我自己的自定义控件。幸运的是，团队中的其他人已经编写了自定义控件，所以我有示例代码可以开始。无论如何，如果我必须自己做这种事情，那么框架有什么用？希望他们在 .net 4.5 中解决了这个问题......

**编辑**：使用 MaskedTextBox`ValidatingType = typeof(System.Date)`是一个更好的解决方案。对不起.NET！

# php - 如何通过 PHP/MySQL 发送大量（10,000 多封）电子邮件？

> ID：11022979
> 
> 赞同：-5
> 
> 时间：2012-06-13T20:41:59.790
> 
> 标签：php

目前我有一个客户想要向他们的客户发送大量电子邮件（10,000+）。这怎么可能？任何帮助或建议将不胜感激..

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T20:53:31.233

我假设您的问题是脚本在一定时间后超时。你可以做几件事：

1.  查看[你的 php.ini 中的 max_execution_time](http://www.php.net/manual/en/info.configuration.php#ini.max-execution-time)并提升它。
2.  从 CLI 运行您的脚本，因为 CLI 脚本不受 max_execution_time 的影响
3.  按照 GeoPhoenix 的建议使用邮件队列。
4.  将集合拆分为批次并使用批次迭代器重新加载（或 ajax）页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T20:44:55.047

您可以创建一个邮件队列，查看 PEAR 包中的邮件队列，尽管邮件服务器限制每小时/分钟/天可以发送的邮件数量。

# mongodb - 与 10M 记录的 MySQL 相比，MongoDB 非常慢

> ID：11022980
> 
> 赞同：2
> 
> 时间：2012-06-13T20:42:02.977
> 
> 标签：mongodb, nosql

我有一个负载相当高的项目，在 MySQL 上运行大约 10M 记录，每秒大约有 500 个请求。数据非常独特，缓存命中率只有 3% 左右。每行有大约 10 个字段，其中 2 个被索引。我 99% 的查询使用两个索引字段进行请求。

我决定尝试使用 NoSQL，而 MongoDB 是明智之举。使用简单的自定义脚本移动数据非常容易。数据库模式保持完全相同，我复制了相同的两个索引字段，它们仍然负责 90% 的请求。然后我决定试一试，非常震惊：MongoDB 对查询的回答非常非常慢。响应率从每秒 5 到 10 个请求不等，而 mysql 则为 500 个。

任何想法为什么会发生这种情况？正常吗？我是否应该期望 MongoDb 在这种特殊情况下胜过 Mysql（10M 记录，大量具有低缓存命中率的独特请求）？我觉得我错过了一点。

**更新**一些规格

我正在测试的服务器是具有 4GB 内存的四核至强

MySQL表是（重命名的字段名）：

```
 CREATE TABLE `table` (
  `recordid` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `var1` varchar(200) DEFAULT NULL,
  `var2` char(32) DEFAULT NULL,
  `var3` bigint(20) unsigned DEFAULT NULL,
  `var4` smallint(5) unsigned DEFAULT NULL,
  `var5` datetime DEFAULT NULL,
  `var6` int(10) unsigned NOT NULL,
  `var7` int(10) unsigned NOT NULL,
  `var8` tinyint(1) DEFAULT NULL,
  PRIMARY KEY (`recordid`),
  UNIQUE KEY `recordid_UNIQUE` (`recordid`),
  KEY `keyvar7` (`var7`),
  KEY `keyvar6` (`var6`) 
```

典型的查询是：SELECT var2, var4, var5, var6 from table where var7=xxx and var6=yyy

通过比较使用索引字段和非索引字段的查询，我手动验证了 MongoDB 是否正确复制了相同的索引。

**UPDATE2** MongoDB .getIndexes() 回复

```
 > db.table.getIndexes();
[
    {
        "v" : 1,
        "key" : {
            "_id" : 1
        },
        "ns" : "table.table",
        "name" : "_id_"
    },
    {
        "v" : 1,
        "key" : {
            "var6" : 1
        },
        "ns" : "table.table",
        "name" : "var6_1"
    },
    {
        "v" : 1,
        "key" : {
            "var7" : 1
        },
        "ns" : "table.table",
        "name" : "var7_1"
    }
] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T20:47:19.413

MongoDB 不是一个神奇的查询加速器。您的网站不会因为您切换到 mongo 而承受 10 倍的负载。

从你的数字来看，我怀疑正在发生资源饱和。MySQL 当然可以做很多超过 500 QPS。

你知道你的瓶颈是什么吗？我敢打赌，您的 RAM 比所需的要少得多，必须从磁盘中获取数据并且磁盘已饱和。在这一点上，没有数据库技术可以帮助你，除非你得到更多的铁（或删除一些数据）。

至于 mongo 的性能较差，没有具体情况很难说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T22:10:59.050

如果您要查询示例中的两个元素，请在和上`SELECT var2, var4, var5, var6 from table where var7=xxx and var6=yyy`使用[复合索引](http://www.mongodb.org/display/DOCS/Indexes#Indexes-CompoundKeys)。`var7``var6`

如果你有一个固定的结构并使用与关系数据库相同的模式，我怀疑你是否能够获得很多。但你可能会让情况变得更糟;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:05:47.483

*   您是否正确设置了所有索引？包括复合索引？
*   并且这些集合实际上是否被索引？

    例如 Collectionname.indexes ；Collectionname.create_indexes

*   你可以分片你的数据或使用多个从站来分散负载吗？

*   你的系统有多少内存？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T20:57:50.547

考虑到许多大型网络项目都坚持使用 mysql，例如 Facebook 等。因此，只要新数据库已针对您的需求进行了测试，您就不应该这样做。我最喜欢做的是获取数据库的最新备份并移回 mysql，然后将**memcached** 系统调整到您的数据库，它确实可以处理大量流量。

但当然，您还没有指定项目的类型，无论是 Web 还是某个应用程序。MongoDB 比 mysql 慢得多。
向我们提供搬家详情，我们将能够为您提供帮助并提供更多信息。

# c# - 单元测试异步方法：无法解析远程主机名

> ID：11022982
> 
> 赞同：2
> 
> 时间：2012-06-13T20:42:13.863
> 
> 标签：c#, .net, unit-testing, .net-4.5, c#-5.0

我正在尝试测试一些涉及 HttpClient 的异步方法与 vs 2012 express 一起用于 win 8 及其测试框架。无论我如何尝试，我总是得到同样的例外。

例如这个测试代码：

```
[TestMethod]
public async Task Connect()
{
    HttpClient client = new HttpClient();
    string reply = await client.GetStringAsync("http://google.com");
    Assert.AreNotEqual(0, reply.Length);
} 
```

考虑到这一点，这应该可行：[http ://www.richard-banks.org/2012/03/how-to-unit-test-async-methods-with.html](http://www.richard-banks.org/2012/03/how-to-unit-test-async-methods-with.html)

投掷

```
System.Net.WebException: The remote name could not be resolved: 'google.com' 
```

当从实际程序（不是测试用例）调用时，相同的代码工作得很好。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T11:52:18.303

请参考我的评论，我可以将其作为对您问题的回答。

"*你在使用 Metro 风格的单元测试模板吗？如果是，你需要在应用程序清单文件中启用 Internet 客户端（我认为）-> 允许这种行为的能力？另外，因为你正在测试外部调用，所以这是不是单元测试。它更像是一个集成测试。* ”

我使用了与您完全相同的代码，并且得到了完全相同的错误。正如我所说，如果您只勾选 Package.appxmanifest -> Capabilities -> Internet (Client) 复选框，您的测试应该通过。

# c# - 在 XML 中存储文件名的正确方法是什么？

> ID：11022983
> 
> 赞同：5
> 
> 时间：2012-06-13T20:42:30.397
> 
> 标签：c#, xml, formatting, linq-to-xml

我`XDocument`用来缓存文件列表。

```
<file id="20" size="244318208">a file with an &amp;ersand.txt</file> 
```

在这个例子中，我使用`XText`了 , 并让它自动转义文件名中的字符，例如 & 和`&amp;`

```
<file id="20" size="244318208"><![CDATA[a file with an &ersand.txt]]></file> 
```

在这一个中，我曾经`XCData`让我使用文字字符串而不是转义字符串，因此它出现在 XML 中就像它在我的应用程序中一样。

我想知道在任何特定条件下它们中的任何一个是否都比另一个更好，或者这只是个人品味。此外，如果它意味着什么，文件名可能包含也可能不包含非法字符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T20:47:09.103

我不会*明确地*使用任何一个，`XText`或者`XCData`- 我只是提供一个字符串，让 LINQ to XML 做任何它想做的事情。

我确实认为非 CDATA 版本通常更清晰。是的，与号被转义了——而且`<`也会被转义——但这仍然比`CDATA`开始/结束部分少得多。

不要忘记，人类很少能看到 XML 表示本身——这个想法是，它是一种信息传输，*当您需要时，*它在该表示中是可以合理读取的。我不会太挂断它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T20:46:04.717

两者本质上是相同的，没有特定的“最佳实践”。

就个人而言，我保留`<![CDATA[]]>`大量需要大量转义的文本（例如代码或 HTML 标记）。

在这种特定情况下，我宁愿像您的第一个示例一样逃避`&`to 。`&amp;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T20:54:29.987

大多数文件名不包含 & 符号，或小于符号。所以选择 XText。将 XCData 保留用于需要大量此类字符的情况，例如在 XML 文档中嵌入和 HTML 片段时。

基本原理：序列化和解析文本的 CPU 利用率差异完全可以忽略不计。但在存储、带宽或内存需求方面存在（小）差异。在其他条件相同的情况下，使用占用空间最少的格式（即使差异很小）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T20:46:30.193

没关系。
它们都是有效的 XML，并且具有相同的含义。

# javascript - 根据计算计算小计

> ID：11022984
> 
> 赞同：0
> 
> 时间：2012-06-13T20:42:30.863
> 
> 标签：javascript

我正在尝试根据“total_full”+“total_half”计算“sub_total”字段。但是我尝试的 javascript 不起作用。sub_total 的结果显示为“0”。如何改进我的javascript“计算小计”以允许我将“total_full”和“total_half”加在一起？（然后，当我可以正确计算时，我还将实现 sub_total 计算以包括“total_single”、“total_double”和“total_projector”。

HTML

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Conference Form</title>

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jqueryui.js"></script>
<link href="style.css" rel="stylesheet" type="text/css"/>
<link href="css/jqueryui.css" rel="stylesheet" type="text/css" />

<body>

<div id="wrapper">
<div id="header"></div>

<table width="899" border="1" align="left" cellpadding="1">
  <form action="" method="get" name="myform">

  <tr>
    <td width="258"><label>Company Name</label></td>
    <td width="249"><input type="text" name="companyname" id="companyname" /></td>
    <td width="27">&nbsp;</td>
    <td width="186">Enquiry Date</td>
    <td width="145"><input type="text" name="enquiry_date" id="enquiry_date" class="datepicker" /></td>
  </tr>

  <tr>
    <td>Conference Date In</td>
    <td><input type="text" name="conference_date_in" id="conference_date_in" class="datepicker" /></td>
    <td>&nbsp;</td>
    <td>Conference Date Out</td>
    <td><input type="text" name="conference_date_out" id="conference_date_out" class="datepicker" /></td>
  </tr>
  <tr>
    <td>Total Days</td>
    <td><input type="text" name="total_days" id="total_days" /></td>
  </tr>
  <tr>
    <td>Number of Delegates</td>
    <td><input type="text" name="no_of_delegates" id="no_of_delegates" /></td>
    </tr>
   <tr>
    <td>Accommodation:</td>
    <tr>
    <td><p>Check in Date</p></td>
    <td><input type="text" name="check_in_date" id="check_in_date" class="datepicker" /></td>

    <td><p>Check out Date</p></td>
    <td><p>
      <input type="text" name="check_out_date" id="check_out_date" class="datepicker" />
        </p></td>
  </tr>
  <tr>
    <td>Total Days Accommodation</td>
    <td><input type="text" name="total_days_acc" id="total_days_acc" /></td>
  </tr>
  <tr>
    <td><strong>Contact Details</strong></td>
    </tr>
  <tr>
    <td>Contact Person</td>
    <td><input type="text" name="contact_person" id="contact_person" /></td>
    </tr>
  <tr>
    <td>Telephone Number</td>
    <td><input type="text" name="tel_no" id="tel_no" /></td>
    <td>&nbsp;</td>
    <td>Fax Number</td>
    <td><input type="text" name="fax_no" id="fax_no" /></td>
  </tr>
  <tr>
    <td>Cell Number</td>
    <td><input type="text" name="cell_no" id="cell_no" /></td>
    <td>&nbsp;</td>
    <td>Email</td>
    <td><input type="text" name="email" id="email" /></td>
  </tr>

  <tr>
    <td>Full Day Conference @ R260 p/p</td>
    <td><input type="text" name="full_day" id="full_day" />
    Full Days</td>
    <td>&nbsp;</td>
    <td>Total Cost Full Day</td>
    <td><input type="text" name="total_full" id="total_full" readonly="readonly" /></td>
  </tr>
  <tr>
    <td>Half Day Conference @ R240 p/p</td>
    <td><input type="text" name="half_day" id="half_day" />
    Half Days</td>
    <td>&nbsp;</td>
    <td>Total Cost Half Day</td>
    <td><input type="text" name="total_half" id="total_half" readonly="readonly" /></td>
  </tr>
  <tr>
    <td>Single Rooms @ R480 p/p</td>
    <td><input type="text" name="single_rooms" id="single_rooms" />
    Guests</td>
    <td>&nbsp;</td>
    <td>Total Cost Single Rooms</td>
    <td><input name="total_single" type="text" id="total_single" readonly="readonly" /></td>
  </tr>
  <tr>
    <td>Double / Twin Rooms @ R360 p/p/s</td>
    <td><input type="text" name="double_rooms" id="double_rooms" /> 
    Guests</td>
    <td>&nbsp;</td>
    <td>Total Cost Double / Twin</td>
    <td><input name="total_double" type="text" id="total_double" readonly="readonly" /></td>
  </tr>
  <tr>
    <td>Data Projector @ R400 rental p/day</td>
    <td><input type="text" name="data_projector" id="data_projector" /> 
      Days</td>
    <td>&nbsp;</td>
    <td>Total Cost Projector Rental</td>
    <td><input name="total_projector" type="text" id="total_projector" readonly="readonly" /></td>
  </tr>
   <tr>
    <td>Sub Total</td>
    <td><input name="sub_total" type="text" id="sub_total" readonly="readonly" /></td>
    </tr>
  <tr>
    <td height="23">&nbsp;</td>
    </tr>

  </form>
</table>

</div>

<div id="hideme">
Hello Hideme
</div>

</body>
</html> 
```

JAVASCRIPT

```
<script type="text/javascript">
//Datepicker
$(function() {
    $(".datepicker").datepicker({ minDate: -0, maxDate: "+100M +10D",dateFormat: 'dd-mm-yy'})
    ({
        changeMonth: true,
        changeYear: true,
    });
        });

//Datepicker Enquiry Date Set to Today
var enquiry_date = $.datepicker.formatDate('dd-mm-yy', new Date());
document.getElementById('enquiry_date').value = enquiry_date;

//Datepicker Conference in / out
var calcDate = function() {
    var start = $('#conference_date_in').datepicker('getDate');
    var end = $('#conference_date_out').datepicker('getDate');
    var days = (end - start) / 1000 / 60 / 60 / 24 + 1;

    if(days==0) {days=1
    }
    if( days >= 0 ) {
    document.getElementById('total_days').value = days;
    } 
        }

$('#conference_date_out').change(calcDate);
$('#conference_date_in').change(calcDate);

//Datepicker Check in  / Out Accommodation
var calcDateAcc = function() {
    var startacc = $('#check_in_date').datepicker('getDate');
    var endacc = $('#check_out_date').datepicker('getDate');
    var daysacc = (endacc - startacc) / 1000 / 60 / 60 / 24;

    if(daysacc==0) daysacc=1
    if( daysacc >= 0 ) {
    document.getElementById('total_days_acc').value = daysacc;
    } 
        }

$('#check_in_date').change(calcDateAcc);
$('#check_out_date').change(calcDateAcc);

//Calculate Total Cost FullDay Conference
function calculateFull()
{
    var fulldays = parseInt(document.getElementById("full_day").value);

    var no_of_delegates = parseInt(document.getElementById("no_of_delegates").value);

    var fullprice = 260;

    var resultfull =  fulldays * no_of_delegates * fullprice;

    document.getElementById("total_full").value = resultfull;
    }

    $('#full_day').change(calculateFull).keyup(calculateFull);

//Calculate Half Day conference total   

    function calculateHalf()
{
    var halfdays = parseInt(document.getElementById("half_day").value);

    var no_of_delegates = parseInt(document.getElementById("no_of_delegates").value);

    var halfprice = 240;

    var resulthalf =  halfdays * no_of_delegates * halfprice;

    document.getElementById("total_half").value = resulthalf;
    }

    $('#half_day').change(calculateHalf).keyup(calculateHalf);

//Calculate Total Cost Single Rooms
    function calculateSingle()
{
    var single_rooms = parseInt(document.getElementById("single_rooms").value);

    var total_days_acc = parseInt(document.getElementById("total_days_acc").value);

    var single_rooms_price = 480;

    var resultsingle =  single_rooms * total_days_acc * single_rooms_price;

    document.getElementById("total_single").value = isNaN(resultsingle) ? 0 : resultsingle;
    }

    $('#single_rooms').change(calculateSingle).keyup(calculateSingle);
    $('#check_in_date').change(calculateSingle);
    $('#check_out_date').change(calculateSingle);

//Calculate Total Cost Double / Twin Rooms
    function calculateDouble()
{
    var double_rooms = parseInt(document.getElementById("double_rooms").value);

    var total_days_acc = parseInt(document.getElementById("total_days_acc").value);

    var double_rooms_price = 360;

    var resultdouble =  double_rooms * total_days_acc * double_rooms_price;

    document.getElementById("total_double").value = isNaN(resultdouble) ? 0 : resultdouble;
    }

    $('#double_rooms').change(calculateDouble).keyup(calculateDouble);
    $('#check_in_date').change(calculateDouble);
    $('#check_out_date').change(calculateDouble);

//Calculate Total Cost Date Projector
    function calculateProjector()
{
    var data_projector = parseInt(document.getElementById("data_projector").value);

    var data_projector_price = 400;

    var resultdata =  data_projector *  data_projector_price;

    document.getElementById("total_projector").value = isNaN(resultdata) ? 0 : resultdata;
    }

    $('#data_projector').change(calculateProjector).keyup(calculateProjector);

//Calculate Sub Total
    function calculateSubTotal()
{

    var SubTotal =  total_full +  total_half;

    document.getElementById("sub_total").value = isNaN(SubTotal) ? 0 : SubTotal;
    }

    $('#data_projector').change(calculateSubTotal).keyup(calculateSubTotal);

//Hide me Testing   
$("#full_day").keyup(function(){

        if ($('#full_day').val() == "1") {   
            $("#hideme").show("fast"); //Slide Down Effect
        }
        else {
            $("#hideme").hide("fast");    //Slide Up Effect
        }
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:32:22.547

这是否符合您的要求：

```
//Calculate Sub Total
    function calculateSubTotal()
{

    var SubTotal =  +total_full.value +  +total_half.value;

    document.getElementById("sub_total").value = isNaN(SubTotal) ? 0 : SubTotal;
    }

document.getElementById("total_half").onchange = calculateSubTotal;
document.getElementById("total_half").onkeyup = calculateSubTotal; 
```

注意一元的使用，`+`以及`.value`在获取输入的值时`total_full`和total_half。还有事件处理程序的设置。

在这里试试：http: [//jsfiddle.net/jstoolsmith/ue62p/](http://jsfiddle.net/jstoolsmith/ue62p/)

# javascript - 用链接和截断值替换锚点

> ID：11022986
> 
> 赞同：0
> 
> 时间：2012-06-13T20:42:33.360
> 
> 标签：javascript, jquery, regex, dom, anchor

我有一个 javascript 函数，用于检测和替换带有锚 (html) 的链接。然而，问题是有些人粘贴了大量的链接，导致页面元素过低，这会破坏页面（通常）。

有谁知道将以下两个功能组合成一个提供锚标记的简单方法，其中包含链接的截断版本？

IE 转换

```
http://Superlonglink 
```

进入

```
<a href="http://Superlonglink">http://Super...</a> 
```

使用以下功能的组合：

**用锚点替换链接的功能：**

```
function replaceURLWithHTMLLinks(text) {
    var exp = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
    return text.replace(exp,"<a href='$1' target='_blank'>$1</a>");
} 
```

**截断字符串的函数：**

```
String.prototype.trunc = function(n){
      return this.substr(0,n-1)+(this.length>n?'':'');
}; 
```

我已经玩了一段时间了，但是我发现我对 javascript 正则表达式的理解有点有限

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:49:54.420

```
function replaceURLWithHTMLLinks(text, maxlen) {
    var exp = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
    return text.replace(exp, function( link ) {
        return '<a href="' + link + '" target="_blank">' +
            (link.length > maxlen ? link.substring( 0, maxlen ) + "..." : link) + '</a>'
    });
} 
```

演示：http: [//jsfiddle.net/84Le9/2/](http://jsfiddle.net/84Le9/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T20:50:50.643

在替换中使用一个函数，以便您可以操作它。

```
function replaceURLWithHTMLLinks(text) {
    var exp = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
    return text.replace(exp,
        function (href) {
            var partial = href.length<10 ? href : href.substring(0,10) + "...";
            return "<a href='" + href + "' target='_blank'>"+ partial + "</a>"});
}

replaceURLWithHTMLLinks("http://www.example.com/IAMAVERYLONGLINKWITHMORESTUFF"); 
```

[jsfiddle](http://jsfiddle.net/pu94C/)

# macos - 订阅 Spotify 活动

> ID：11022987
> 
> 赞同：1
> 
> 时间：2012-06-13T20:42:37.993
> 
> 标签：macos, cocoa, spotify

有谁知道在 Spotify 应用程序中订阅事件的方法？要订阅 iTunes 事件，您只需向通知中心添加一个观察者，如下所示：

`[[NSDistributedNotificationCenter defaultCenter] addObserver:self selector:@selector(changedTrack:) name:@"com.apple.iTunes.playerInfo" object:nil];`

因此，所有事件都将发送到`NSNotification`to `changedTrack:`。

我似乎无法为 Spotify 找到类似的（或任何方式）来执行此操作，但我知道有应用程序这样做，例如显示当前正在播放的歌曲的应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T06:22:30.710

Spotify 的`NSDistributedNotification`名称是`com.spotify.client.PlaybackStateChanged`.

使用该订阅，`NSDistributedNotificationCenter`您将收到与 iTunes 非常相似的通知。

# r - 计算两个日期之间每天的“营业时间”数

> ID：11022988
> 
> 赞同：4
> 
> 时间：2012-06-13T20:42:43.647
> 
> 标签：r, date

我有一个包含开始日期和结束日期的数据框，以及注册参加活动的人数。我想计算在特定时间范围内（例如，07:00 - 17:00）每一方在场的小时数

如果我使用以下示例 data.frame ...

```
d <- data.frame(startDate = c(as.POSIXct("2011-06-04 08:00:00"), as.POSIXct("2011-06-03 08:00:00"),
                          as.POSIXct("2011-09-12 10:00:00")),
            endDate = c(as.POSIXct("2011-06-06 11:00:00"), as.POSIXct("2011-06-04 11:00:00"),
                        as.POSIXct("2011-09-12 18:00:00")),
            partysize = c(124,442,323))
open <- "07:00"
close <- "17:00" 
```

我希望我的结果集看起来像这样：

```
day                     numhours  partysize
2011-06-04                     9        124
2011-06-05                    10        124
2011-06-06                     4        124
2011-06-03                     9        442
2011-06-04                     4        442
2011-09-12                     7        323 
```

*注意：numhours 是日期包含在开盘时间和收盘时间之间的小时数*

提前致谢，--JT

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T00:31:16.093

抱歉，它很乱，我用 7 和 17 代替了你的打开和关闭

```
app.days<-mapply(function(x,y){x+y*60*60*24},as.POSIXct(format(d$startDate,"%Y-%m-%d")),lapply(floor(-(d$startDate-d$endDate)/24),seq,from=0))
start.date<-mapply(function(x,y){pmax(x+7*60*60,y)},app.days,d$startDate)
end.date<-mapply(function(x,y){pmin(x+17*60*60,y)},app.days,d$endDate)
app.hours<-mapply(function(x,y){as.numeric(x-y)},end.date,start.date)
res<-mapply(function(x,y,z){data.frame(day=as.Date(x),numhours=y,partysize=z)},app.days,app.hours,as.list(d$partysize))
res1<-data.frame(day=as.Date(unlist(res[1,]),origin="1970-01-01"),numhours=unlist(res[2,]),partysize=unlist(res[3,]))

> res1
         day numhours partysize
1 2011-06-04        9       124
2 2011-06-05       10       124
3 2011-06-06        4       124
4 2011-06-03        9       442
5 2011-06-04        4       442
6 2011-09-12        7       323 
```

基本上，我们会确定每个派对人数的停留天数。对于给定的一天，我们会找到适用的开盘价和收盘价。然后我们从收盘中减去开盘。数据框最终形成，但它可能是在 res<- 步骤中创建的.....

# sql-server - 变更数据捕获和 SQL Server 分析服务

> ID：11022994
> 
> 赞同：0
> 
> 时间：2012-06-13T20:43:16.840
> 
> 标签：sql-server, sql-server-2008, ssas, cdc, change-data-capture

我正在设计一个数据库应用程序，其中数据会随着时间而变化。我想保留历史数据并允许我的用户使用 SQL Server Analysis Services 对其进行分析，但我正在努力想出一个允许这样做的数据库架构。我想出了一些可以跟踪更改的模式（包括依赖 CDC），但是我不知道如何将该模式转换为 SSAS 中的工作 BISM。我还能够创建一个可以很好地转换为 BISM 的模式，但是它没有我正在寻找的历史功能。是否有任何既定的最佳实践来做这种事情？

这是我正在尝试做的一个例子：

我有一个名为 Sales 的事实表，其中包含每月的销售数据。我还有一个名为“客户”的常规维度表，它允许用户查看按客户细分的销售数据。客户和销售代表之间存在多对多的关系，因此我可以创建一个称为责任的参考维度来引用客户维度，并创建一个销售代表参考维度来引用责任维度。我现在通过参考维度销售链链接到销售代表的销售事实 -> 客户 -> 责任 -> 销售代表，这使我可以查看按销售代表细分的销售数据。问题在于，销售事实并不是唯一会随着时间而改变的东西。我还希望能够保留在特定销售事实发生时哪个销售代表负责客户的历史记录。我还想知道销售代表的办公室在特定销售事实发生时的位置，这可能与他当前的位置不同。我还可能知道在特定销售事实时客户组织的规模，这也可能与当前不同。我不知道如何以对 BISM 友好的方式对此进行建模。特定销售事实时的组织，也可能与当前不同。我不知道如何以对 BISM 友好的方式对此进行建模。特定销售事实时的组织，也可能与当前不同。我不知道如何以对 BISM 友好的方式对此进行建模。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T01:44:42.760

您提到您目前有一个包含月度销售数据的事实表。所以每个客户每个月有一个记录。因此，该事实表中的每条记录实际上是相应维度在当月发生的单个销售“交易”的聚合。

因此，在给定的月份中，客户 123 可能有 5 笔单独的销售交易，每笔 10 美元......并且每笔单独的销售交易都可以由不同的销售代表（A、B、C、D、E）处理。在您描述的事实表中，客户 123 将有一条 50 美元的记录……但是我们如何为 SalesReps（ABCDE）建模？

根据你的目标...

*   能够保留**在特定销售事实发生时哪个销售代表对客户负责的历史记录**
*   了解销售代表办公室**在特定销售事实发生时的位置**
*   了解**特定销售事实时客户组织的规模**

...我认为以较低的粒度建模会更容易...特别是销售交易事实表，每个销售交易有 1 条记录。每个销售交易将有一个客户和一个销售代表。

```
FactSales
    DateKey (date of the sale)
    CustomerKey (customer involved in the sale)
    SalesRepKey (sales rep involved in the sale)
    SalesAmount (amount of the sale) 
```

现在对于历史更改跟踪...任何具有要跟踪其历史更改的属性的维度都需要建模为“缓慢变化的维度”，因此需要使用“代理键”。因此，例如，在您的客户维度中，客户 ID 不会是主键...而只是业务键...您将使用任意整数作为主键...此任意键被引用to 作为代理键。

这是我为您的维度建模数据的方式...

```
DimCustomer
    CustomerKey (surrogate key, probably generated via IDENTITY function)
    CustomerID (business key, what you will find in your source systems)
    CustomerName
    Location (attribute we wish to track historically)
    -- the following columns are necessary to keep track of history
    BeginDate
    EndDate
    CurrentRecord

DimSalesRep
    SalesRepKey (surrogate key)
    SalesRepID (business key)
    SalesRepName
    OfficeLocation (attribute we wish to track historically)
    -- the following columns are necessary to keep track of historical changes
    BeginDate
    EndDate
    CurrentRecord

FactSales
    DateKey (this is your link to a date dimension)
    CustomerKey (this is your link to DimCustomer)
    SalesRepKey (this is your link to DimSalesRep)
    SalesAmount 
```

这样做是允许您为同一客户拥有多条记录。前任。CustomerID 123 于 2012 年 3 月 5 日从 NC 移至 GA...

```
CustomerKey | CustomerID | CustomerName | Location | BeginDate | EndDate | CurrentRecord
1 | 123 | Ted Stevens | North Carolina | 01-01-1900 | 03-05-2012 | 0
2 | 123 | Ted Stevens | Georgia        | 03-05-2012 | 01-01-2999 | 1 
```

*这同样适用于 SalesReps 或您想要在其中跟踪某些属性的历史更改的任何其他维度。*

因此，当您按 CustomerID、CustomerName（或任何其他非历史跟踪属性）对销售交易事实表进行切片时，您应该看到一条记录，其中包含跨客户所有交易汇总的事实。如果您决定按 CustomerName 和 Location（历史跟踪的属性）分析销售交易，您将看到与客户在该位置时的销售额对应的客户位置的每个“版本”的单独记录。

顺便说一句，如果您有时间并且有兴趣了解更多信息，我强烈推荐 Kimball 圣经“数据仓库工具包”……它应该为维度建模场景提供坚实的基础。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T03:02:14.567

*做你想做的事***的既定最佳实践方法是一个具有缓慢变化维度的维度模型。***销售代表经常被用来描述 SCD 的有用性。例如，如果销售代表转移到新领域，奖金与其团队绩效挂钩的销售经理不希望他们的总数下降。SCD 非常适合跟踪此类事情（以及您描述的情况），并允许您查看历史上任何时候的情况。*

 *花一些时间在[Ralph Kimball 的网站](http://www.kimballgroup.com/html/articles.html)上开始。我建议您阅读的前 3 篇文章是*渐变维度*、*渐变维度第 2 部分*和*维度建模的 10 条基本规则*。

为了取得成功，需要注意以下几点：

1.  您不是在设计 3NF 事务数据库。适应非规范化。
2.  确保您了解粒度的含义并明确定义数据库的粒度。
3.  不要使用自然键作为键，也不要将任何智能添加到代理键中（时间键除外）。
4.  您的应用程序的目标应该是查询速度以及易于理解和导航。
5.  了解类型 1 和类型 2 渐变维度并知道在哪里使用它们。
6.  确保您在业务方面有一个有权“断绝关系”的赞助商。你会发现组织中不同的人对同一件事有不同的定义，你需要一个有权做出决定的执行者。要明白我的意思，请让您组织中的 5 个不同的人来定义“客户”或“毛利润”。你会很幸运让 2 人以相同的方式定义。
7.  不要试图挥舞它。阅读[数据仓库生命周期工具包](https://rads.stackoverflow.com/amzn/click/com/0470149779)并接受这些想法，即使它们起初看起来很奇怪。他们工作。
8.  OLAP 功能强大，如果实施得当，可以改变生活。如果不是这样，那将是一场绝对的噩梦。
9.  玩得开心！*

# android - facebook 本机 android 应用程序不接受我的密钥哈希

> ID：11022996
> 
> 赞同：1
> 
> 时间：2012-06-13T20:43:27.510
> 
> 标签：android, hash, key, native

我正在使用 Windows 7。尝试创建新的本机 android 应用程序。为了生成密钥哈希，我在 cmd C:\Program Files\Java\jre1.6.0_25\bin>keytool -exportcert -alias androiddebugkey -keystore C:\Users\Youske.android\debug.keystore | C:\openssl\bin\openssl sha1 -binary | C:\openssl\bin\openssl base64

我输入密码：android，我得到了我的密钥散列：0UzmruCvZLUgljxZvly3B34D7zA= 然后我启用为 Android SSO 配置：，然后我将此密钥复制到“android 密钥散列”texterea，单击保存更改，然后 facebook 为我生成下一个错误 ：

错误您已为您的应用启用原生 Android 应用集成，但尚未指定 Android 密钥哈希。出于安全原因，Facebook 应用程序不会与没有与相应密钥哈希匹配的签名的任何本机应用程序进行交互。

所以如果有人遇到这个问题，请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T16:26:29.863

我遇到了这个确切的问题，并通过简单地使用 Firefox 而不是 Google Chrome 来解决它。希望这可以帮助！