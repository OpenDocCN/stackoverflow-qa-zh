# StackOverflow 问答 11148000-11148999

# asp.net - 如何使用 IIS - Web.config 将来自某个 url 的流量重定向到另一个

> ID：11148002
> 
> 赞同：0
> 
> 时间：2012-06-21T22:57:14.247
> 
> 标签：asp.net, .net, .htaccess, redirect, web-config

这个 .htaccess 文件正是我需要的。

但是我正在运行 ASP.net，我需要 Web.Config 的确切代码

/ / / / / / / / .ht访问码 / / / / / / / / /

```
Options +FollowSymLinks
RewriteEngine on
RewriteCond %{HTTP_REFERER} referrerURL\.com/
RewriteRule ^$ http://www.redirectedURL.com [R=301,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T01:58:58.803

为什么不安装 [http://www.helicontech.com/isapi_rewrite/](http://www.helicontech.com/isapi_rewrite/)或[http://www.helicontech.com/download-ape.htm](http://www.helicontech.com/download-ape.htm)（取决于您的 IIS 版本）为您提供 .htaccess 功能？

# django - django gravatar 没有作为一个模块被选中 - 我做错了什么？

> ID：11148003
> 
> 赞同：0
> 
> 时间：2012-06-21T22:57:18.143
> 
> 标签：django, gravatar

所以这是我的问题 - 我的 django 项目中的 gravatar 应用程序（来自 google 项目 - 在这里！[http://code.google.com/p/django-gravatar/](http://code.google.com/p/django-gravatar/)）在启动时崩溃了一切。

我得到这个错误`Error: No module named gravatar`

这是我安装的应用程序：

```
INSTALLED_APPS = (
'django.contrib.auth',
'django.contrib.contenttypes',
'django.contrib.sessions',
'django.contrib.sites',
'django.contrib.messages',
'django.contrib.staticfiles',
'django.contrib.admin',
'dumpstown.dumpstownapp',
'bootstrap_toolkit',
'registration',
'gravatar'
) 
```

当我运行这个时，从控制台：

```
>> import sys
>> print sys.path
['', 'C:\\development\\python\\lib\\site-packages\\setuptools-0.6c11-py2.7.egg',
 'C:\\development\\python\\lib\\site-packages\\pip-1.1-py2.7.egg', 'C:\\developm
ent\\PycharmProjects\\lib\\gravatar', 'C:\\Windows\\system32\\python27.zip', 'C:
\\development\\python\\DLLs', 'C:\\development\\python\\lib', 'C:\\development\\
python\\lib\\plat-win', 'C:\\development\\python\\lib\\lib-tk', 'C:\\development
\\python', 'C:\\development\\python\\lib\\site-packages'] 
```

我在这里想念什么？

更新啊，奇怪。我检查了 gravatar 文件夹，我有

```
templatetags dir
__init__.py
models.py
views.py 
```

另外，如果我将已安装的应用程序部分更改为：

```
INSTALLED_APPS = (
'django.contrib.auth',
'django.contrib.contenttypes',
'django.contrib.sessions',
'django.contrib.sites',
'django.contrib.messages',
'django.contrib.staticfiles',
'django.contrib.admin',
'dumpstown.dumpstownapp',
'bootstrap_toolkit',
'registration',
'templatetags'
) 
```

然后服务器启动正常并运行。但是我……我现在很困惑！我是要导入模板标签吗？或者是其他东西？如果我正在导入模板标签，我如何引用 gravatar 的东西？

编辑：解决。

我只是不明白python是如何工作的，看起来！我完全在 pythonpath 中添加了错误的项目 - 我正在添加`C:\\development\\PycharmProjects\\lib\\gravatar`，我应该在其中添加`C:\\development\\PycharmProjects\\lib`

这解决了问题，现在我可以随心所欲地使用 gravatar。在我的第一个示例中，settings.py 条目如上（即，只是'gravatar'），我使用它的方式是我只是 {% load gravatar %}

欢呼！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:19:53.133

可能您检查了主干文件夹并具有类似 ..\gravatar\gravatar 的结构？setup.py 脚本应该将其安装在您的路径中，但您也可以尝试更改`C:\developm ent\PycharmProjects\lib\gravatar`为`C:\developm ent\PycharmProjects\lib\gravatar\gravatar`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T01:55:30.580

完全将错误的项目添加到 pythonpath - 我添加了 C:\development\PycharmProjects\lib\gravatar，我应该在其中添加 C:\development\PycharmProjects\lib

# php - 根据日期返回 rss 节点

> ID：11148005
> 
> 赞同：2
> 
> 时间：2012-06-21T22:57:23.823
> 
> 标签：php, xpath

我正在尝试仅根据今天的日期返回 Twitter 标题。我在下面制作了以下代码，但无论它是否是今天的日期，它都会返回每个标题。

```
$dom = new DOMDocument();
@$dom->loadHTMLFile('http://api.twitter.com/1/statuses/user_timeline.rss?screen_name=google');
$xml = simplexml_import_dom($dom);
$twitter = $xml->xpath("//item");

foreach ($twitter as $item) {
    $timezone = new DateTimeZone('America/Los_Angeles');
    $date = new DateTime($item->pubdate);
    $date->setTimeZone($timezone);
    $twitter_date = $date->format("F j Y");
    $todays_date = date("F j Y");

    if ($twitter_date == $todays_date) {
        foreach ($twitter as $item) {
            $text = $item->title;
            echo $text.'<br />';
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T22:59:51.247

您再次循环遍历语句中`$twitter`的每个。`if`尝试删除`foreach`里面的标签，只使用当前的`$item`：

```
if ($twitter_date == $todays_date) {
    $text = $item->title;
    echo $text.'<br />';
} 
```

# ruby - Sauce labs 使用有意义的名称进行测试

> ID：11148009
> 
> 赞同：3
> 
> 时间：2012-06-21T22:57:43.330
> 
> 标签：ruby, rspec, cucumber, watir, saucelabs

我正在使用 rspec 和 cucumber 在酱汁实验室进行 watir 测试。

我希望该测试名称（在酱实验室）与 rspec 描述块或黄瓜功能的名称相同。

所以，如果我有 rspec 文件：

```
describe "something" do
  # teh codez
end 
```

或黄瓜文件：

```
Feature: something
# teh codez 
```

我希望在酱汁实验室也将测试命名为`something`. 我知道如何向酱实验室说我希望如何命名测试，但我不知道如何在测试运行时获取 rspec 描述块名称或黄瓜特征名称。

更多上下文：我有几个 rspec 文件，并且它们都并行运行，我`parallel_tests`为此使用 gem。它提供了`TEST_ENV_NUMBER`变量，所以我用它来命名测试：

```
caps[:name] = "job #{ENV['TEST_ENV_NUMBER']}" 
```

所以工作被命名为：工作，工作1，工作2......但如果他们被命名，我会更好：用户，搜索，登录......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T17:15:07.827

您可以在 before 钩子中获取名称：

```
# rspec:

before do
  p [example.description, example.full_description]
end

# cucumber:

Before do |scenario|
 p [scenario.feature.name, scenario.name]
end 
```

# actionscript-3 - 在 Flex 中使用 getDefinitionByName 在运行时实例化一个 Fxg

> ID：11148010
> 
> 赞同：1
> 
> 时间：2012-06-21T22:57:45.607
> 
> 标签：actionscript-3, apache-flex

我对 getDefinitionByName 有一点问题。我的目的是在运行时在文档 mxml 中实例化一个 FXG 对象（Number10.fxg）。类的名称位于字符串变量中，getDefinitionByName 使用该变量返回要实例化的类的名称。即使不发送错误消息，该代码也不起作用。代码如下：

```
import assets.Number10;
import flash.utils.getDefinitionByName;
import mx.core.IVisualElement;

private function onClick(event:MouseEvent):void
{ 
  var value:String = "Number10";
  var ClassDefinition:Class = getDefinitionByName(value) as Class;
  var ten:IVisualElement = new ClassDefinition() as IVisualElement;
  this.contentGroup.addElement(ten);
} 
```

我也试过... var ten:IVisualElement = new ClassDefinition(); 但什么都没有。它不起作用！请帮我！

* * *

首先，我参考了涵盖该主题的 adobe 文档页面。这里是：

**选项**包括类 [...]

**说明**将一个或多个类链接到生成的应用程序 SWF 文件，无论这些类在编译时是否需要。要链接整个 SWC 文件而不是单个类，请使用 include-libraries 选项。

好的。在 Flash Builder 中，我转到只有此选项的附加编译器参数

```
-locale en_US 
```

所以我在这个下面添加我的选项

```
-includes class = assets.Number10 
```

**或者**

`-includes class assets.Number10`

**或者**

`-includes class Number10`

当应用程序运行时，我收到错误 #2032。

我认为选项声明是错误的。对于使用选项，我没有很好的参考。所以……帮帮我！

如何使用包含类选项将 Number10 类或资产包与其他 fxg 对象一起声明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T11:55:58.923

好的！我找到了解决方案......是在代码中的某处引用 Number10 类，例如：

```
import assets.Number10;
import flash.utils.getDefinitionByName;
import spark.core.SpriteVisualElement;

//case1
var myNumber:Number10;

//or

//case2
Number10;

private function onClick(event:MouseEvent):void
{ 
  var value:String = "assets.Number10";
  var ClassDefinition:Class = getDefinitionByName(value) as Class;
  var ten:SpriteVisualElement = new ClassDefinition() as SpriteVisualElement;
  this.contentGroup.addElement(ten);
} 
```

并且代码有效:-)

这是由 Flex 编译其代码的方式产生的问题。Flex 编译它的代码，因此如果一个类没有被使用，它会在最终编译的程序中保留这个类。但问题还没有结束！如果我有数百个可以实例化的 Fxg 对象，那么声明所有类就有点困难和乏味了。那么，**我怎样才能一次性声明一个包的所有类呢？**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T12:04:08.747

您可以使用 include 和 includeClasses 编译器选项将类添加到 SWC 和 SWF。使用这些，您不必引用代码中的类。请参阅文档以了解正确使用方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T01:36:31.777

请务必使用完全限定的类名。

此外，将 FXG 类转换为 IVisualElement 的方法对我来说是新的。我认为你必须在铸造和排序中使用真正的类。尝试使用 SpriteVisualElement。

```
private function onClick(event:MouseEvent):void
{ 
  var value:String = "assets.Number10";
  var ClassDefinition:Class = getDefinitionByName(value) as Class;
  var ten:IVisualElement = new ClassDefinition() as SpriteVisualElement.;
  this.contentGroup.addElement(ten);
} 
```

# php - 仅从 Mongo 光标中获取第一个对象

> ID：11148011
> 
> 赞同：12
> 
> 时间：2012-06-21T22:57:49.703
> 
> 标签：php, mongodb

我正在对 MongoDB 进行查询，我只想要第一个对象。我知道我可以使用`findOne`，但我仍然很困惑我哪里出错了。

这不起作用：

```
if ($cursor->count() > 0) {
    $image = $cursor->current();
    // neither does this work
    // $image = $cursor[0]; 
    return $image;
} else {
    return false;
}   

//echo $image->filename;
// Throws error: Trying to access property of non-object image 
```

这虽然有效：

```
if ($cursor->count() > 0) {
    $image = null;
    foreach($cursor as $obj)
        $image = $obj;
    return $image;
} else {
    return false;
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-21T23:01:33.033

这个怎么样：

```
if ($cursor->count() > 0) {
    $cursor->next();
    $image = $cursor->current();
    return $image;
} else {
    return false;
} 
```

[奖励：来自Doc 页面的](http://www.php.net/manual/en/mongocursor.current.php)报价

> **public array MongoCursor::current (void)**
> 在调用 MongoCursor::next() 之前返回 NULL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-07T08:39:30.677

raina77ow 提供的解决方案使用标记为 legacy 的[Mongo库。](http://nl1.php.net/manual/en/book.mongo.php)

目前只有一种方法可以从光标中获取第一个元素 - 使用[MongoDB\Driver\Cursor::toArray](http://nl1.php.net/manual/en/mongodb-driver-cursor.toarray.php)方法：

```
$cursor = $collection->find();
$firstDocument = $cursor->toArray()[0]; 
```

# actionscript-3 - How to use a switch?

> ID：11148012
> 
> 赞同：1
> 
> 时间：2012-06-21T22:57:50.770
> 
> 标签：actionscript-3

My question is, which one is better to use? How to properly use a switch statement. Should I use variables or not etc. I thank you in advance for your reply. "random text because I need a lot of explanation or else it won't let me post."

```
switch(level_id)
{
    case 1:
        stage.addChild(new lvl(50, 200, 100, level_id));
        break;
    case 2:
        stage.addChild(new lvl(50, 200, 100, level_id));
        break;
    case 3:
        stage.addChild(new lvl(50, 200, 100, level_id));
        break;
    case 4:
        stage.addChild(new lvl(50, 200, 100, level_id));
        break;
    case 5:
        stage.addChild(new lvl(50, 200, 100, level_id));
        break;
    case 6:
        stage.addChild(new lvl(50, 200, 100, level_id));
        break;
    case 7:
        stage.addChild(new lvl(50, 200, 100, level_id));
        break;
    default:
        break;
} 
```

or

```
switch(level_id)
{
    case 1:
        x = 50; y = 200; x = 100;
        break;
    case 2:
        x = 50; y = 200; x = 100;
        break;
    case 3:
        x = 50; y = 200; x = 100;
        break;
    case 4:
        x = 50; y = 200; x = 100;
        break;
    case 5:
        x = 50; y = 200; x = 100;
        break;
    case 6:
        x = 50; y = 200; x = 100;
        break;
    case 7:
        x = 50; y = 200; x = 100;
        break;
    default:
        break;
}
stage.addChild(new lvl(x, y, z, level_id)); 
```

* * *

What I finally did (edit)

Final result, thanks all

```
var config:Object = {
               "1":{ "paddWidth":50, "blockWidth":200, "blockHeight":100 },
               "2":{ "paddWidth":50, "blockWidth":200, "blockHeight":100 },
               "3":{ "paddWidth":50, "blockWidth":200, "blockHeight":100 },
               "4":{ "paddWidth":50, "blockWidth":200, "blockHeight":100 },
               "5":{ "paddWidth":50, "blockWidth":200, "blockHeight":100 },
               "6":{ "paddWidth":50, "blockWidth":200, "blockHeight":100 },
               "7":{ "paddWidth":50, "blockWidth":200, "blockHeight":100 },
               "8":{ "paddWidth":50, "blockWidth":200, "blockHeight":100 }
            };

            stage.addChild(new lvl( 
                        config[level_id].paddWidth,
                        config[level_id].blockWidth,
                        config[level_id].blockHeight,
                        level_id
                        )); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:30:26.620

You could also store all the values in some arrays. and access them via index.

```
var lvlx:Array = [50, 51, 52, 53, 54, 55, 56, 57];
var lvly:Array = [100, 101, 102, 103, 104, 105, 106, 107];
var lvlz:Array = [150, 151, 152, 153, 154, 155, 156, 157];

var lvlIndex:int = level_id - 1;
stage.addChild(new lvl(lvlx[lvlIndex], lvly[lvlIndex], lvlz[lvlIndex])); 
```

You could even make it a two dimensional array, but I thought an array for each x, y, and z was simple, and faster than storing objects in an array.

A really good (and fast) option, would be to use Vectors, with the quick notation:

```
var lvlx:Vector.<int> = new <int>[50, 51, 52, 53, 54, 55, 56, 57]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T23:42:22.867

Another option might be *(untested code)*:

```
var config:Object = {
   "1":{ "x":50, "y":100, "z":150 },
   "2":{ "x":51, "y":101, "z":151 },
   "3":{ "x":52, "y":102, "z":152 },
   "4":{ "x":53, "y":103, "z":153 },
   "5":{ "x":54, "y":104, "z":154 },
   "6":{ "x":55, "y":105, "z":155 },
   "7":{ "x":56, "y":106, "z":156 },
   "8":{ "x":57, "y":107, "z":157 }
};
x = config[level_id].x;
y = config[level_id].y;
z = config[level_id].z;
stage.addChild(new lvl(x, y, z)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T23:03:23.910

There's not much of a difference in your case, but I would go with the latter. There is less code duplication this way (i.e. what happens if you want to change the parent of the level, so instead of `stage.addChild` you have `someContainer.addChild`, with the first method you would have to replace every instance of stage with someContainer vs. the second method replacing in only place).

If you're worried about lines of code, you can store the variables on one line:

```
x = 57; y = 107; z = 157; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T23:14:42.127

As an entirely different approach, I would make a `Level` class that has the properties `x`, `y` and `z` and the method `load`.

Then I'd create instances of all the levels that are in the game with the appropriate values and load whichever one is relevant.

Sample:

```
public class Level
{
    public x:int;
    public y:int;
    public z:int;

    public function Level(x:int, y:int, z:int)
    {
        this.x = x;
        this.y = y;
        this.z = z;
    }

    public function load(stage:Stage):void
    {
        // This is where the Level will do resource consuming stuff, like get
        // added to the stage, create level elements, etc.
    }
} 
```

Then just create all your levels and store them in an Array:

```
var levels:Array = [
    new Level(50, 100, 120),
    new Level(65, 70, 12)
]; 
```

Which means it's easy to load whichever level you want now by just having something like this:

```
function loadLevel(lvl:int):Level
{
    var level:Level = levels[lvl];
    level.load();

    return level;
} 
```

# c - 读取 int 并将其存储在 C 中的 char * 缓冲区中

> ID：11148013
> 
> 赞同：0
> 
> 时间：2012-06-21T22:58:00.233
> 
> 标签：c, io

我有一个整数文件。我想将这些整数作为字符（它的 ascii 编号）写入缓冲区。因为它是一个更大项目的一部分，所以请不要发布不同的内容，但请帮助我。我特别需要的是将字符存储在 char * 类型的缓冲区中。

这些是我的声明。

```
FILE *in;
  long io_len = 1000;    
 char * buffer;
    in=fopen("input.txt","a+");

    buffer = malloc(io_len * sizeof(*buffer));
      if(buffer == NULL){
        perror("malloc");
        exit(EXIT_FAILURE);
        } 
```

我正在找出2个解决方案。

如果我写这个：

```
read_ret = read(in, buffer, io_len); 
```

它从文件中读取 io_len 个字节并将它们存储在缓冲区中。但它读取字符。因此，例如，如果我写 123，它将写入缓冲区 1、2、3，而不是 ascii 编号为 123 的字符。

所以我这样做了：

```
while((fscanf(in,"%d", &i))==1){
        printf(": %d\n", i);
    } 
```

它读取我想要的整数。现在我对如何将它们作为字符存储在缓冲区中有些困惑。我已经尝试过了，但它给我带来了分段错误。

```
while((fscanf(in,"%d", &i))==1){
        printf(": %d\n", i);
    buffer=(char) i;
    printf("Character in Buffer:%s\n",buffer);
    buffer++;
    } 
```

请记住，稍后在我的文件中，我将缓冲区写入其他地方，所以无论我做什么，我都希望指针位于我的 char 数组的开头（如果我所说的有意义的话）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:10:48.657

您的最终代码至少应该警告您将整数分配给 line 中的指针`buffer=(char) i;`。看起来你想取消引用指针。

当您看起来真的只想一次打印一个字符时，您也在打印一个字符串。

您的代码应该如下所示：

```
int character_index = 0;
while((fscanf(in,"%d", &i))==1){
        printf(": %d\n", i);
    buffer[character_index]=(char) i;
    printf("Character in Buffer:%c\n",buffer[character_index]);
    character_index++;
} 
```

# php - 单个仪表板上的 CakePHP 用户特定内容

> ID：11148016
> 
> 赞同：0
> 
> 时间：2012-06-21T22:58:32.257
> 
> 标签：php, cakephp, authentication

我在 CakePHP 中设置了身份验证，以使用此功能将所有用户重定向到仪表板：

```
function dashboard() {
    $group_name = $this->User->Group->field('name', array('id' => $this->Auth->User('group_id')));
    $action = $group_name . '/dashboard/';
    $this->redirect = array('controller' => 'users', 'action' => $action);
} 
```

我的问题是在此仪表板中管理特定于组和特定于用户的内容的最佳实践（或我可以查看的资源）是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:54:58.407

一种模型方法，它将在单个数组中获取您需要的所有数据，其键名为您要使用的视图变量，如果您需要获取不需要关联的不同内容，则将其从控制器设置到视图。

如果不是简单地返回数据并将其设置为如下视图变量：

```
public function dashboard() {
    $this->set('artist', $this->Artist->dashboard($this->Auth->user('id')));
} 
```

通过传递用户 ID，您可以通过关联获取模型中所需的任何内容。

# jquery - $(sel).bind("click", $(sel).click(, $(sel).live("click", $(sel).on("click") 之间有什么显着差异？

> ID：11148019
> 
> 赞同：3
> 
> 时间：2012-06-21T22:58:49.113
> 
> 标签：jquery, onclick, click, bind, mouseclick-event

我已经使用它们很长一段时间了，但大多数时候，我更喜欢较短的，但是，我只想真正深入了解细节。我可能一直在创建错误的代码，我不想在网络上贡献和传播懒惰的代码。

所以告诉我：

> 它们之间的显着优势/劣势是什么，或者就像冰淇淋一样，不同的口味但同样的“感觉良好”效果？

鼓励每个人就此事发表他们的专家意见。

提前谢谢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T23:03:32.757

`bind()`在1.0、1.3、1.4.2 和1.7 中`live()`添加。`delegate()``on()`

从 1.7 开始`on()`是首选用途，`live()`已弃用且根本不推荐使用。如果您使用的是 1.3，请使用1.4.2`bind()`代替和自 1.7 使用，而不是其他任何一个。`live()``delegate()``live()``on()`

关于`$("selector").click`. 取自`click()` [**文档**](http://api.jquery.com/click/)：

> 在前两个变体中，此方法是 .bind("click", handler) 的快捷方式，以及 jQuery 1.7 中的 .on("click", handler) 的快捷方式。在第三个变体中，当 .click() 不带参数调用时，它是 .trigger("click") 的快捷方式。

**为什么使用 on() 而不是其他的？**
`on()`是最新添加的，在 1.7 版中加入了 jQuery 库。`on()`具有多个方法签名，使其能够提供与以前版本相同的结果，但经过改进和优化。从[**文档**](http://api.jquery.com/on/)中引用：

> 从 jQuery 1.7 开始，.on() 方法提供了附加事件处理程序所需的所有功能。

基本上没有必要使用`bind()`或`delegate()`不再使用。当然它会起作用，并且使用这些方法应该没有害处，但我始终认为最新添加的内容已针对以前版本的任何缺点进行了优化和改进（除非文档中另有说明，因为在 的情况下`live()`） .
基于此，我建议`on()`改用。

`live()`不推荐句号的原因更多是与它的缺点有关。从`live()` [**文档**](http://api.jquery.com/live)中引用。

> 不再推荐使用 .live() 方法，因为更高版本的 jQuery 提供了没有缺点的更好方法。特别是，使用 .live() 会出现以下问题：
> 
> *   jQuery 在调用 .live() 方法之前尝试检索选择器指定的元素，这在大型文档上可能很耗时。
> *   不支持链接方法。例如， $("a").find(".offsite, .external").live( ... ); 无效且无法按预期工作。
> *   由于所有 .live() 事件都附加在文档元素上，因此事件在处理之前会采用最长和最慢的路径。
> *   在移动 iOS（iPhone、iPad 和 iPod Touch）上，大多数元素的 click 事件不会冒泡到文档正文，并且如果不应用以下解决方法之一，则不能与 .live() 一起使用：
>     1.  使用原生可点击元素，例如 a 或按钮，因为这两个元素都会冒泡到文档中。
>     2.  使用 .on() 或 .delegate() 附加到 document.body 级别以下的元素，因为移动 iOS 确实会在 body 中冒泡。
>     3.  将 CSS 样式 cursor:pointer 应用到需要冒泡点击的元素（或包含 document.documentElement 的父元素）。但是请注意，这将禁用元素上的复制\粘贴，并使其在触摸时突出显示。
> *   在事件处理程序中调用 event.stopPropagation() 无法停止附加在文档下方的事件处理程序；该事件已经传播到文档。
> *   .live() 方法以令人惊讶的方式与其他事件方法进行交互，例如，$(document).unbind("click") 删除了所有对 .live() 的调用附加的点击处理程序！

不过，文档中还有很多好东西。

**其他资源**
[**click()**](http://api.jquery.com/click/)
[**bind()**](http://api.jquery.com/bind)
[**live() (不要使用)**](http://api.jquery.com/live)
[**delegate()**](http://api.jquery.com/delegate/)
[**on()**](http://api.jquery.com/on/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T23:01:23.910

在这种特殊情况下，功能没有区别。然而，`.on`它比`.bind`jQuery 1.7 更受欢迎，而且对于`.click`- 它只是一个通用事件处理程序的简写。

# python - python解析文件

> ID：11148020
> 
> 赞同：2
> 
> 时间：2012-06-21T22:58:54.953
> 
> 标签：python, file, parsing, io, save

我有一个包含用户名和电子邮件的文件，格式如下：

```
pete,pbellyer@gmail.com 
```

我只想保留电子邮件，所以我考虑使用这样的正则表达式：

```
import re,sys

Mailfile = sys.argv[1]

file = open(Mailfile, "r")

for MAIL in file.readlines():
   tmp = re.split("\n+", MAIL)
   m = re.match( ',(.+)', MAIL)
   m.group(0) 
```

但是我不知道如何将结果存储在文件中。我总是得到新文件中的最后一个电子邮件地址。

将结果存储在文件中的最佳方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T23:36:24.050

```
import sys

infile, outfile = sys.argv[1], sys.argv[2]

with open(infile) as inf, open(outfile,"w") as outf:
    line_words = (line.split(',') for line in inf)
    outf.writelines(words[1].strip() + '\n' for words in line_words if len(words)>1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T23:04:28.197

您可以使用[csv](http://docs.python.org/library/csv.html)模块（因为您的数据看起来是逗号分隔的，至少在您的示例中）：

```
import sys
import csv
with open('mail_addresses.txt', 'w') as outfile:
    for row in csv.reader(open(sys.argv[1], 'rb')):
        outfile.write("%s\n" % row[1]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T23:14:51.123

尝试这样的事情：

```
import sys

Mailfile = sys.argv[1]
Outfile = sys.argv[2]

try:
    in_file = open(Mailfile, 'r')
    out_file = open(Outfile, 'a')

    for mail in in_file.readlines():
        address = mail.split(',')[1].strip()
        out_file.write(address+',') #if you want to use commas to seperate the files, else use something like \n to write a new line.
finally:
    in_file.close()
    out_file.close() 
```

# objective-c - C宏在objective-c中公开ivar的属性

> ID：11148032
> 
> 赞同：2
> 
> 时间：2012-06-21T23:00:17.520
> 
> 标签：objective-c, macros

在我的项目中，我通常有一个复合对象（GameObject），它需要将 ivar 的一些属性公开到 GameObject 的接口中。例如，一个游戏对象有一个带有“位置”属性的精灵，我想使用精灵的位置作为游戏对象的属性。这很容易：

```
// GameObject.h
@interface GameObject : NSObject
@property CGPoint position;
...
@end

// GameObject.m
@interface GameObject ()
@property Sprite* sprite;   // private property
@end 

@implementation
- (CGPoint)position { return sprite.position; };
- (void)setPosition:(CGPoint)p { sprite.position = p; };
... 
```

作为一个附带项目，我一直在研究使用 C 宏生成 getter/setter。理想情况下，我能够做到：

```
@implementation
EXPOSE_SUBCOMPONENT_PROPERTY(subcomponent,propertyName,propertyType);
... 
```

我最近失败的尝试是：

```
#define EXPOSE_SUBCOMPONENT_PROPERTY(sub,property,type) \
- (type)property { id x = sub; return x.##property;} \
- (void)setProperty:(type)set_val { id x = sub; x.##property = set_val; } \ 
```

那里有任何宏向导可以提供帮助吗？其次，有没有办法不需要向宏提供属性的类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:54:54.457

好吧，你要求它，但要振作起来，它会很快变得丑陋：

```
#import <objc/runtime.h>

#define EXPOSE_SUBCOMPONENT_PROPERTY(selfClass, sub, property) \

static typeof([[selfClass new] property]) ___get##property(id self, SEL _cmd)\
{\
return ((selfClass *)self)->sub.property;\
}\
static void ___set##property(id self, SEL _cmd, ...)\
{\
selfClass *selfCasted = (selfClass *) self; \
va_list args; va_start(args, _cmd); \
typeof(selfCasted.property) _val = va_arg(args, typeof (selfCasted.property));\
selfCasted->sub.property = _val;\
}\
__attribute__((constructor)) \
static void __init##__property() \
{\
Class cls = [selfClass class];\
class_addMethod(cls, @selector(property), (IMP) ___get##property, "");\
/* for capitalization */ \
char selAsStr[sizeof(#property) + 4] = "set";\
strcat(selAsStr, #property ":");\
selAsStr[3] = toupper(selAsStr[3]);\
class_addMethod(cls, sel_registerName(selAsStr), (IMP) ___set##property, "");\
}\ 
```

您不再需要获取返回类型，但您必须将类类型发送给方法。

必须为此使用 GCC，因为使用了广泛的扩展，或者，您可以使用 C++ 11，但我不推荐它。

我真的不推荐使用这个，但如果你想要一些很酷的东西，那就试试吧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:50:36.080

找到了更好的解决方案。诀窍是了解符号是如何拆分的，以正确使用“##”。此外，必须为属性声明添加一个宏来自定义 getter/setter 名称，从而解决属性名称大写的问题。对我来说没什么大不了的，帮助我记住它的特殊属性。我能想到的唯一缩减是由于自定义名称，它们将不符合 KVO。

我重命名了宏以使它们更容易记住（它们分别替换了@property 和@synthesize），并重新排列了参数顺序以反映属性。

```
#define PROPERTY_OF_IVAR(prop_type,ivar,prop_name) \
    @property (setter=set_##prop_name:, getter=get_##prop_name) prop_type prop_name \

#define SYNTHESIZE_IVAR_PROPERTY(prop_type,ivar,prop_name) \
    - (prop_type)get_##prop_name { return ivar.prop_name;} \
    - (void)set_##prop_name:(prop_type)set_val { ivar.prop_name = set_val; } \ 
```

另一个版本，使@property 声明更自然，并具有能够在任何深度的属性的额外好处（而不仅仅是 ivar 属性，您可以深入到 ivar.property.another_property.indefinitely）。您还可以将属性的名称设置为与其在组合对象中的名称不同。

```
// prop_type - type of property that will be exposed
// prop_name - name of property in composing object
#define PROPERTY_OF_IVAR(prop_type, prop_name) \
    (setter=set_##prop_name:, getter=get_##prop_name) prop_type prop_name \

// prop_type - type of property that will be exposed
// prop_path - path to the property you want
// prop_name - must match PROPERTY_OF_IVAR (above)
#define SYNTHESIZE_IVAR_PROPERTY(prop_type, prop_path,prop_name) \
    - (prop_type)get_##prop_name { return prop_path;} \
    - (void)set_##prop_name:(prop_type)set_val { prop_path = set_val; } \ 
```

示例使用：

```
// foo.h
@interface
@property PROPERTY_OF_IVAR(CGPoint, position);
...

// foo.m
@implementation
SYNTHESIZE_IVAR_PROPERTY(CGPoint, sprite.position, position);
... 
```

# lucene - 查找 Lucene 索引的术语列表

> ID：11148036
> 
> 赞同：10
> 
> 时间：2012-06-21T23:00:54.093
> 
> 标签：lucene

是否可以将 Lucene 索引中所有术语的列表提取为字符串列表？我在文档中找不到该功能。谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-19T20:21:03.923

在 Lucene 4（和 5）中：

```
 Terms terms = SlowCompositeReaderWrapper.wrap(directoryReader).terms("field"); 
```

编辑：

现在这似乎是“正确”的方式（Lucene 6 及更高版本）：

```
LuceneDictionary ld = new LuceneDictionary( indexReader, "field" );
BytesRefIterator iterator = ld.getWordsIterator();
BytesRef byteRef = null;
while ( ( byteRef = iterator.next() ) != null )
{
    String term = byteRef.utf8ToString();
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-21T23:21:26.213

Lucene 3：

*   C#：[C# Lucene 获取所有索引](https://stackoverflow.com/questions/2892494/c-sharp-lucene-get-all-the-index)

*   爪哇：

    ```
    IndexReader indexReader = IndexReader.open(path); 
    TermEnum termEnum = indexReader.terms(); 
    while (termEnum.next()) { 
        Term term = termEnum.term(); 
        System.out.println(term.text()); 
    }
    termEnum.close(); 
    indexReader.close(); 
    ```

*   Java（特定字段的所有术语）：[如何从 Lucene 的特定字段中获取唯一术语列表？](https://stackoverflow.com/questions/8910008/how-can-i-get-the-list-of-unique-terms-from-a-specific-field-in-lucene)

*   Python：[使用 Lucene (PyLucene) 查找单个字段术语](https://stackoverflow.com/questions/9091028/finding-a-single-fields-terms-with-lucene-pylucene)

# c# - 设置 Control.Capture = true 隐藏光标

> ID：11148040
> 
> 赞同：0
> 
> 时间：2012-06-21T23:01:38.893
> 
> 标签：c#, winforms, mouse

当我将控件的`Capture`属性设置为 true 时，我会收到预期的鼠标事件，但光标变得不可见。这是预期的行为吗？如果是这样，如何在捕获光标时显示光标？

示例代码：

这假设您有一个`Form`带有适当链接`TextBox`的`TextChanged`事件的 a。

现在，示例代码确实是`(Form).Capture`为了保持示例代码简短，但我已经对其进行了测试，它也会导致我的鼠标消失。

```
public partial class MyForm : Form
{
    public MyForm()
    {
        InitializeComponent();
    }

    private void TextBox_TextChanged(object sender, EventArgs e)
    {
        this.Capture = true;
    }
} 
```

在文本框中输入一些东西，鼠标就会消失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:29:04.713

鼠标捕获会中断包括设置光标在内的正常鼠标处理流程，因此您应该手动设置光标。

# javascript - 必应地图 - 在 PushPin 上调用点击事件

> ID：11148042
> 
> 赞同：4
> 
> 时间：2012-06-21T23:02:04.437
> 
> 标签：javascript, bing-maps

我有以下必应地图：[https ://www.bob-elliot.co.uk/locateV2.php](https://www.bob-elliot.co.uk/locateV2.php)

当在左侧列表中选择商店时，地图自动以该图钉为中心，我现在需要做的是调用该图钉的 click() 句柄（或显示相关的信息框）。

问题是，我将引脚推入`Microsoft.Maps.EntityCollection();`被调用`dataLayer`，所以我不能直接调用 map.entities.get() - 或者更确切地说 - 如果我尝试以这种方式调用它 get() 不会返回任何内容。

注意`zoomMap()`这个片段底部的函数，我已经注释掉了有问题的行。

如何调用点击事件？

```
var map = null;
var dataLayer = null;
var infoboxLayer = null;

function loadMap() {
    //#### Prep default location
    var defaultLocation = new Microsoft.Maps.Location(53.6880, -2.6646);

    //#### Prep Map Options
    var mapOptions = {
        credentials: 'KEY_REMOVED',
        center: defaultLocation,
        mapTypeId: Microsoft.Maps.MapTypeId.road,
        zoom: 7,
        enableClickableLogo: false,
        enableSearchLogo: false
    }

    //#### Initialise the primary map control
    map = new Microsoft.Maps.Map(document.getElementById('BobElliotMap'), mapOptions);

    //#### Add data layer
    dataLayer = new Microsoft.Maps.EntityCollection();
    map.entities.push(dataLayer);

    //#### Add infobox layer
    infoboxLayer = new Microsoft.Maps.EntityCollection();
    map.entities.push(infoboxLayer);

    //#### Prep InfoBox & add to infobox layer
    var infoboxOptions = {
        width: 300,
        height: 200,
        visible: false,
        offset: new Microsoft.Maps.Point(0, 20)
    };

    infobox = new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(0, 0), infoboxOptions);
    infoboxLayer.push(infobox);

    //#### Add Data to the map
    DrawPins();
}

function displayInfobox(e) {
    if (e.targetType == "pushpin") {
        infobox.setOptions({
            title: e.target.Title,
            description: e.target.Description,
            visible: true,
            offset: new Microsoft.Maps.Point(0, 25)
        });
        infobox.setLocation(e.target.getLocation());

        //#### A buffer limit to use to specify the infobox must be away from the edges of the map.
        var buffer = 30;
        var infoboxOffset = infobox.getOffset();
        var infoboxAnchor = infobox.getAnchor();
        var infoboxLocation = map.tryLocationToPixel(e.target.getLocation(), Microsoft.Maps.PixelReference.control);
        var dx = infoboxLocation.x + infoboxOffset.x - infoboxAnchor.x;
        var dy = infoboxLocation.y - 25 - infoboxAnchor.y;

        if (dy < buffer) { //Infobox overlaps with top of map.
            //#### Offset in opposite direction.
            dy *= -1;
            //#### add buffer from the top edge of the map.
            dy += buffer;
        } else {
            //#### If dy is greater than zero than it does not overlap.
            dy = 0;
        }

        if (dx < buffer) { //Check to see if overlapping with left side of map.
            //#### Offset in opposite direction.
            dx *= -1;
            //#### add a buffer from the left edge of the map.
            dx += buffer;
        } else { //Check to see if overlapping with right side of map.
            dx = map.getWidth() - infoboxLocation.x + infoboxAnchor.x - infobox.getWidth();
            //#### If dx is greater than zero then it does not overlap.
            if (dx > buffer) {
                dx = 0;
            } else {
                //#### add a buffer from the right edge of the map.
                dx -= buffer;
            }
        }

        //#### Adjust the map so infobox is in view
        if (dx != 0 || dy != 0) {
            map.setView({
                centerOffset: new Microsoft.Maps.Point(dx, dy),
                center: map.getCenter()
            });
        }
    }
}

function DrawPins() {
    var pin0 = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(53.1913, -2.51945));
    pin0.Title = "** CYCLONE CYCLES A/C CLOSED";
    pin0.Description = "74 WEAVER STREET<br />WINSFORD<br />CHESHIRE<br />CW7 4AA<br /><br /><b>Tel:</b> +44606861992";
    Microsoft.Maps.Events.addHandler(pin0, 'click', displayInfobox);
    dataLayer.push(pin0);
    var pin1 = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(53.7485, -0.348162));
    pin1.Title = "**2 WHEELS CYCLES LIMITED - HULL";
    pin1.Description = "8 SPRING STREET<br />HULL<br />HU2 8RB<br /><br /><b>Tel:</b> +44482216170<br /><b>Fax:</b> +44828515<br /><b>Web:</b> <a href='http://www.2wheelscycles.co.uk' targer='_blank'>www.2wheelscycles.co.uk</a>";
    Microsoft.Maps.Events.addHandler(pin1, 'click', displayInfobox);
    dataLayer.push(pin1);
}

function zoomMap(PinID, Lat, Long) {
    var ZoomLocation = new Microsoft.Maps.Location(Lat, Long);
    map.setView({
        zoom: 13,
        center: ZoomLocation
    });

    //#### These are the lines that dont work, selectedPin remains undefined
    //var selectedPin = dataLayer.entities.get(PinID);
    //Microsoft.Maps.Events.invoke(selectedPin, 'click', '');
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T07:46:41.687

看起来由于某种原因 e.target 没有出现在 displayInfobox 函数中。

我已经在 2、3 个地方稍微修改了您的代码，以使您的目标接近您的预期点。请在下面检查：

```
var map = null;    
var dataLayer = null;    
var infoboxLayer = null;

function loadMap() {

    //Prep default location    
    var defaultLocation = new Microsoft.Maps.Location(53.6880, -2.6646);

    //Prep Map Options    
    var mapOptions = {
        //credentials: 'KEY_REMOVED',
        center: defaultLocation,
        mapTypeId: Microsoft.Maps.MapTypeId.road,
        zoom: 7,
        enableClickableLogo: false,
        enableSearchLogo: false
    }

    //Initialise the primary map control
    map = new Microsoft.Maps.Map(document.getElementById('BobElliotMap'), mapOptions);

    //Add data layer
    dataLayer = new Microsoft.Maps.EntityCollection();
    map.entities.push(dataLayer);

    // Add infobox layer
    infoboxLayer = new Microsoft.Maps.EntityCollection();
    map.entities.push(infoboxLayer);

    //Prep InfoBox & add to infobox layer
    var infoboxOptions = {
        width: 300,
        height: 200,
        visible: false,
        offset: new Microsoft.Maps.Point(0, 20)
    };

    infobox = new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(0, 0), infoboxOptions);

    infoboxLayer.push(infobox);

    //Add Data to the map
    DrawPins();

    setTimeout(function() {
        //Initial zoom for testing zoomMap function
        var pushpin = dataLayer.get(0);
        var indx = dataLayer.indexOf(pushpin);
        zoomMap(indx, pushpin.getLocation().latitude, pushpin.getLocation().longitude);
    },500);

}

function displayInfobox(e) {

    if ( this.target.id && this.target.id.indexOf("pin") != -1 ) {
        alert("click event fired on pushpin");

        infobox.setOptions({
            title: this.target.Title,
            description: this.target.Description,
            visible: true,
            offset: new Microsoft.Maps.Point(0, 25)
        });

        infobox.setLocation(this.target.getLocation());

        //A buffer limit to use to specify the infobox must be away from the edges of the map.

        var buffer = 30;
        var infoboxOffset = infobox.getOffset();
        var infoboxAnchor = infobox.getAnchor();
        var infoboxLocation = map.tryLocationToPixel(this.target.getLocation(), Microsoft.Maps.PixelReference.control);
        var dx = infoboxLocation.x + infoboxOffset.x - infoboxAnchor.x;
        var dy = infoboxLocation.y - 25 - infoboxAnchor.y;

        if (dy < buffer) { //Infobox overlaps with top of map.
            //#### Offset in opposite direction.
            dy *= -1;
            //#### add buffer from the top edge of the map.
            dy += buffer;
        } else {
            //#### If dy is greater than zero than it does not overlap.
            dy = 0;
        }

        if (dx < buffer) { //Check to see if overlapping with left side of map.
            //#### Offset in opposite direction.
            dx *= -1;
            //#### add a buffer from the left edge of the map.
            dx += buffer;
        } else { //Check to see if overlapping with right side of map.
            dx = map.getWidth() - infoboxLocation.x + infoboxAnchor.x - infobox.getWidth();
            //#### If dx is greater than zero then it does not overlap.
            if (dx > buffer) {
                dx = 0;
            } else {
                //#### add a buffer from the right edge of the map.
                dx -= buffer;
            }
        }

        //#### Adjust the map so infobox is in view
        if (dx != 0 || dy != 0) {
            map.setView({
                centerOffset: new Microsoft.Maps.Point(dx, dy),
                center: map.getCenter()
            });
        }
    }
}

function DrawPins() {

    var pin0 = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(53.1913, -2.51945));
    pin0.id = "pin_0";
    pin0.Title = "** CYCLONE CYCLES A/C CLOSED";
    pin0.Description = "74 WEAVER STREET<br />WINSFORD<br />CHESHIRE<br />CW7 4AA<br /><br /><b>Tel:</b> +44606861992";
    Microsoft.Maps.Events.addHandler(pin0, 'click', displayInfobox);
    dataLayer.push(pin0);
    var pin1 = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(53.7485, -0.348162));
    pin1.id = "pin_1";
    pin1.Title = "**2 WHEELS CYCLES LIMITED - HULL";
    pin1.Description = "8 SPRING STREET<br />HULL<br />HU2 8RB<br /><br /><b>Tel:</b> +44482216170<br /><b>Fax:</b> +44828515<br /><b>Web:</b> <a href='http://www.2wheelscycles.co.uk' targer='_blank'>www.2wheelscycles.co.uk</a>";
    Microsoft.Maps.Events.addHandler(pin1, 'click', displayInfobox);
    dataLayer.push(pin1);
}

function zoomMap(indx, Lat, Long) {

    var ZoomLocation = new Microsoft.Maps.Location(Lat, Long);

    map.setView({
        zoom: 13,
        center: ZoomLocation
    });

    //#### These are the lines that dont work, selectedPin remains undefined
    //var selectedPin = dataLayer.entities.get(PinID);
    //Microsoft.Maps.Events.invoke(selectedPin, 'click', '');

    var selectedPin = dataLayer.get(indx);
    Microsoft.Maps.Events.invoke(selectedPin, 'click');
} 
```

# filemaker - FileMaker 10 Pro 通过 Asp.Net 插入数据

> ID：11148046
> 
> 赞同：0
> 
> 时间：2012-06-21T23:02:54.450
> 
> 标签：filemaker

我试图在 FM 中插入数据，但没有运气得到解析错误 serached number of fourms。错误 [HY000] [DataDirect][ODBC SequeLink 驱动程序][ODBC 套接字][DataDirect][ODBC FileMaker 驱动程序][FileMaker]SQL 中的解析错误

```
enter code here 
```

StringBuilder sbAddBarcode = new StringBuilder(); sbAddBarcode.Append("插入条码 (PONumber,Description,Model,[Serial Number])"); sbAddBarcode.Append("值"); sbAddBarcode.Append(" ("+barcode.PONumber + ","); sbAddBarcode.Append(" '" + barcode.Description +"',"); sbAddBarcode.Append(" '" + barcode.ModelNumber +"') "); //sbAddBarcode.Append(" '" + barcode.SerialNumber +"')");

```
 fmCommand = new OdbcCommand(sbAddBarcode.ToString(), fmcon);
        fmCommand.CommandType = CommandType.Text;
        fmCommand.Connection = fmcon;
        try
        {
            fmcon.Open();
            fmCommand.ExecuteNonQuery();
        }
        catch (OdbcException oe)
        {
            throw new Exception(oe.Message);
        }
        catch (Exception ex)
        {
            throw new Exception(ex.Message);
        }
        finally
        {
            fmcon.Close();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T19:11:40.073

回显您的 sbAddBarcode 值。您正在构建的 SQL 看起来确实无效。

# jquery - 我如何获得 $(this) 两个级别的深度？

> ID：11148049
> 
> 赞同：1
> 
> 时间：2012-06-21T23:03:01.323
> 
> 标签：jquery

好吧，所以我正在尝试设置一个 keydown 调度程序，它将根据按下的键执行不同的操作。

它已添加到我的输入字段的 onkeyup

```
$(function() {
  $("#myInput").keyup(suggestion_dispatcher);
}); 
```

然后这是建议调度程序本身

```
function suggestion_dispatcher() {
    alert($(this).val());
    var code = event.which;

    if(code == 13) {
        // select
    } else if (code == 38) {
        // up
    } else if (code == 40) {
        // down
    } else {
        $.proxy(get_suggestion(), $(this));
    }
} 
```

即使使用 jQuery 代理，在我的 get_suggestion() 函数中，如果我查看`this`或者`$(this)`我看到它给了我窗口对象而不是正在输入的输入框。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T23:06:19.557

您可能想试试这个：`get_suggestion.apply(this);`或`get_suggestion.call(this);`。

这是一些有用的参考 - [http://odetocode.com/blogs/scott/archive/2007/07/05/function-apply-and-function-call-in-javascript.aspx](http://odetocode.com/blogs/scott/archive/2007/07/05/function-apply-and-function-call-in-javascript.aspx)

# objective-c - CGPath (AddCurveToPoint) - 第一个控制点的 x 和 y 与第二个控制点之间的差异

> ID：11148054
> 
> 赞同：3
> 
> 时间：2012-06-21T23:03:41.340
> 
> 标签：objective-c, quartz-graphics, cgpath

我对 Xcode 很陌生，所以我决定习惯 Quartz 绘图，虽然我慢慢习惯了，但我在绘制贝塞尔路径时遇到了麻烦。

特别是，从我的 Illustrator 设计中，我想绘制一个形状（一包扑克牌中的 Spade 标志）虽然 x 和 y 点都可以，但我想我混淆了哪个点是第一个控制点，哪个点是第一个控制点是第二个。

我一直把它想象成，如果你想象一张桌子并沿着它的顶部旋转形状的外部（所以形状总是在桌子上，而不是它下面），第一个控制点在左边，第二个是在右侧。

这是什么情况？

在此先感谢，亚当。

![这是一张描述我的意思的图片](../Images/92177bc88beddbcfdde2fa65b0439b21.png)

这是我的代码：

```
CGMutablePathRef spadePath = CGPathCreateMutable();

CGPathMoveToPoint(spadePath, NULL, 17.0f, 0.0f);

CGPathAddCurveToPoint(spadePath, NULL, 17.0f, 7.3f, 17.0f, 7.318f, 34.0f, 25.475f);
CGPathAddCurveToPoint(spadePath, NULL, 34.0f, 14.754f, 34.0f, 36.197f, 20.838f, 35.029f);
CGPathAddCurveToPoint(spadePath, NULL, 24.679f, 38.425f, 20.838f, 41.03f, 17.0f, 39.2f);
CGPathAddCurveToPoint(spadePath, NULL, 2.846f, 39.2f, 31.156f, 39.2f, 13.163f, 35.029f);
CGPathAddCurveToPoint(spadePath, NULL, 13.163f, 41.03f, 9.323f, 38.425f, 0.0f, 25.475f);
CGPathAddCurveToPoint(spadePath, NULL, 0.0f, 36.197f, 0.0f, 14.754f, 17.0f, 0.0f);

CGPathCloseSubpath(spadePath); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T02:23:17.440

我刚刚找到了我自己问题的答案，在绘制曲线时，你告诉它那个部分的基本坐标。

因此，在解析控制点 1 的 x 和 y 坐标时，您将基本控制点的控制点坐标提供给起点，最后一个点也是如此，最后一个点的位置也是如此。

例如，

![带控制点的扇形图](../Images/2579e50885be9c9fd98f19856a18c56c.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T01:40:21.093

您错误地转录了一些坐标。例如，这是您的第一条曲线：

```
CGPathAddCurveToPoint(spadePath, NULL, 17.0f, 7.3f, 17.0f, 7.318f, 34.0f, 25.475f); 
```

但根据你的图表，应该是这样的：

```
CGPathAddCurveToPoint(spadePath, NULL, 17.0f, 7.318f, 30.0f, 14.754f, 34.0f, 25.475f); 
```

但是，在 Illustrator 图表中，附加到点 2 的控制点看起来也标有错误的 X 坐标。它们被标记为 30，但可能应该被标记为 34。我没有检查所有标签。

# jquery - jQuery UI 自动搜索来搜索多个字符串

> ID：11148055
> 
> 赞同：2
> 
> 时间：2012-06-21T23:04:02.933
> 
> 标签：jquery, jquery-ui, jquery-autocomplete, jquery-ui-autocomplete

我需要向 jQuery UI 自动搜索功能添加一些功能。我要解决的问题是允许用户以任何顺序输入文本，以搜索术语列表并显示建议。例如，假设我有以下术语：

```
the brown cow jumped over the moon
the blue cow watched in horror
the red cow simply laughed 
the green cow got sick at such a sight
the yellow cow lost 5 bucks to the black cow
the black cow smiled at his fortune

If the user types in "the cow", I would expect the autocomplete feature to list all the results.
If I type in "brown moon", I would expect the first result to appear.
If I type in "fortune smiled", the last result would appear. 
```

基本上，这种行为允许用户以任何顺序输入任何字符串并获得搜索结果。

这就是我的想法。我需要在“打开”或“搜索”事件中添加一个回调函数并在那里操作结果。到目前为止，这是我的代码：

```
$(function ()
{
    var data =
    [
        "the brown cow jumped over the moon",
        "the blue cow watched in horror",
        "the red cow simply laughed ",
        "the green cow got sick at such a sight",
        "the yellow cow lost 5 bucks to the black cow",
        "the black cow smiled at his fortune"
    ];

    $(".text-search").autocomplete(
    {
        autoFocus: true,
        source: data,
        delay: 0,
        minLength: 2,
        open: function (e, ui)
        {
            debugger;
            // what should i do here?
        },
        search: function (e, ui)
        {
            debugger;
            // what should i do here?
        }
    });
});

<div class="ui-widget">
    <label for="autocomplete">Autocomplete: </label>
    <input class="text-search">
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:48:15.497

我会根据用户输入的文本创建您自己的正则表达式。然后，您可以使用此正则表达式来测试候选列表中的每个项目：

```
$(".text-search").autocomplete({
    autoFocus: true,
    source: function(request, response) {
        var regexStr = "\\b(" + $.map($.trim(request.term).split(" "), function(term) {
            return $.ui.autocomplete.escapeRegex($.trim(term))
        }).join("|") + ")\\b",
        matcher = new RegExp(regexStr);

        response($.grep(data, function(value) {
            return matcher.test(value.label || value.value || value);
        }));
    },
    delay: 0,
    minLength: 2
}); 
```

正则表达式部分看起来很神秘，但它只是使用交替 ( `|`) 生成一个表达式。例如，如果您输入`brown cow`,`\b(brown|cow)\b`将生成匹配任何带有“brown”或“cow”的字符串。

**示例：http:** [//jsfiddle.net/hTfj9/](http://jsfiddle.net/hTfj9/)

# android - Android 应用在模拟器上运行良好，但在设备上运行良好。使用互联网连接

> ID：11148056
> 
> 赞同：0
> 
> 时间：2012-06-21T23:04:08.893
> 
> 标签：android, httpresponse

我有一个尝试连接到 URL 并下载 JSON 文件的活动。此活动在模拟器上完美运行，但在设备上不断失败。

我曾经得到连接超时错误，在网上搜索后，我增加了超时时间。但现在我得到 UnknownHost 错误。

相同的 URL 在设备上的浏览器中工作正常。

我尝试了互联网上所有可用的程序，这些程序使用 http 连接来访问/下载东西，一切最终都在模拟器上正常工作。但在设备上失败。

我的设备上的 Internet 连接很好，因为示例 webkit 程序运行良好。

我还为我的应用启用了 Internet 权限。我还尝试了 HttpPost 和 HttpGet 方法。我还尝试在单独的线程中运行连接。我在模拟器中得到 http 响应代码为 200 并在设备中清空一个。

在设备中使用 http 连接时有什么遗漏吗？这是一个简单的示例：http: [//p-xr.com/android-tutorial-how-to-parse-read-json-data-into-a-android-listview/](http://p-xr.com/android-tutorial-how-to-parse-read-json-data-into-a-android-listview/)

提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T07:14:22.087

您可以尝试关闭防火墙。我做到了，它对我有用。希望这会帮助你。

# python - 模板继承时的UTF-8和Jinja

> ID：11148061
> 
> 赞同：0
> 
> 时间：2012-06-21T23:04:35.813
> 
> 标签：python, unicode, encoding, utf-8, jinja2

我正在使用 jinja 的模板继承。我的一些子模板具有 unicode 字符，当尝试在父模板中呈现时，出现以下错误：

```
UnicodeDecodeError: 'utf8' codec can't decode byte 0xf3 in position 292: invalid continuation byte 
```

如果我不使用模板继承，而只是在同一个文件上呈现所有内容，我不会收到任何错误。
有没有办法可以将子模板解码为 UTF-8，或者你会推荐什么解决方案？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T05:58:31.013

希望您已经找到了答案，但请尝试将以下内容添加到您的模板中。

```
<form method="POST" action="" enctype="multipart/form-data> 
```

# html - 调整窗口html大小

> ID：11148064
> 
> 赞同：0
> 
> 时间：2012-06-21T23:04:51.783
> 
> 标签：html, resize

我正在尝试构建一个简单的 html 页面，其中包含一些文本段落，在调整窗口大小期间，我希望文本显示在彼此下方，以免被窗口隐藏。例如，

文字是

啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊。

在调整窗口大小后，我希望它看起来像

AAAABBBBBCCC
CDDDDEEEEFFF
FGGGG。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:07:45.420

使用[自动换行](http://www.w3schools.com/cssref/css3_pr_word-wrap.asp)属性并将其设置为`break-word`. 前任，

```
<p style="word-wrap: break-word">AAAABBBBBCCCCDDDDEEEEFFFFGGGG</p> 
```

# javascript - removechild 循环在完成前退出

> ID：11148066
> 
> 赞同：4
> 
> 时间：2012-06-21T23:05:12.953
> 
> 标签：javascript, dom

我有以下代码，它在文档中找到类名 foo 的所有元素，然后将它们全部删除

```
 function(doc) {
            var items = doc.getElementsByClassName('foo');
            alert(items.length);
            if(items.length>0) {
                for(var i=0;i<items.length;i++) {
                    alert(i);
                    doc.body.removeChild(items[i]);
                }
        } 
```

例如，items.length 为 3，并且函数在运行一个循环后退出，当长度为 8 时，它在 3 处退出。任何帮助将不胜感激。此外，当我一次又一次地运行该函数时，它最终会删除所有元素。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-21T23:09:45.107

您的问题是`NodeList`返回的`getElementsByClassName()`内容是实时的。要么按照 Felix 的建议先将其转换为数组，要么向后迭代：

```
var items = doc.getElementsByClassName('foo');
var i = items.length;
while (i--) {
    items[i].parentNode.removeChild(items[i]);
} 
```

这是有效的，因为每次迭代从列表中删除的项目是列表中的最后一项，因此不会影响之前的项目。

为了更通用，我也更改`doc.body`为`items[i].parentNode`，以防您需要处理不是元素的直接子元素的`<body>`元素。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-21T23:09:00.143

问题在于它`items`是一个**live** `NodeList`，即每当您访问列表 ( `items.length`) 的属性时，都会重新评估列表（再次搜索元素）。
由于您同时删除了元素，因此列表变得更短，但您保留了索引。

您可以`NodeList`先将其转换为数组：

```
var items = [].slice.call(doc.getElementsByClassName('foo')); 
```

删除 DOM 元素时，数组大小不会改变。

# node.js - 用 Mocha 测试一个函数是否调用另一个函数

> ID：11148068
> 
> 赞同：5
> 
> 时间：2012-06-21T23:05:18.647
> 
> 标签：node.js, mocha.js

我有一个关于在 Mocha for Node.js 中测试特定情况的问题。假设我的应用程序中有以下代码......

```
function a() {
     //...
}

function b() {
    //...
}

function c() {
    if(condition) {
         a();
    } else {
         b();
    }
} 
```

如果我正在测试函数 c，我如何验证函数 a 或函数 b 是否被调用？有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T18:09:58.417

我找到了我想要做的事情的解决方案。[Sinon 间谍](http://sinonjs.org/docs/#spies)可以帮助确定某个函数是否被调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:05:46.563

这就是[代码覆盖](http://en.wikipedia.org/wiki/Code_coverage)的用途。幸运的是 mocha 支持利用[JSCoverage](http://siliconforks.com/jscoverage/)。我使用的 MakeFile 看起来像：

```
coverage:
    rm -rf lib-cov
    jscoverage --no-highlight lib lib-cov
    @MOCHA_COV=1 mocha --reporter html-cov > coverage.html
    google-chrome coverage.html 
```

1.  第一行删除了 Mocha 显示代码覆盖率所需的（以前的）检测 javascript 文件（文件夹）。
2.  第二行用于从原始文件夹`jscoverage`创建检测文件夹。`lib-cov``lib`
3.  第三行用于确保我的节点代码知道它需要运行检测代码。
4.  最后我查看`coverage.html`.`google-chrome`

在我的 mocha 测试文件中，我有一行如下所示：

```
var BASE_PATH   = process.env.MOCHA_COV ? './../lib-cov/' : './../lib/'; 
```

这样，当`MOCHA_COV=1`检测代码将被使用时。

* * *

关于代码覆盖率的一些更有趣的链接：

*   [http://tjholowaychuk.com/post/18175682663/mocha-test-coverage](http://tjholowaychuk.com/post/18175682663/mocha-test-coverage)
*   [http://www.seejohncode.com/2012/03/13/setting-up-mocha-jscoverage/](http://www.seejohncode.com/2012/03/13/setting-up-mocha-jscoverage/)

# jquery - PhoneGap/Cordova：JQuery 动画运行缓慢

> ID：11148069
> 
> 赞同：9
> 
> 时间：2012-06-21T23:05:21.917
> 
> 标签：jquery, cordova, slide

我在 PhoneGap/Cordova 中构建了一个应用程序，并将 JQuery 库用于一些简单的动画，如 slideUp 等。

它们在模拟器上运行良好，但是当我在实际设备上尝试时，动画运行起来非常笨拙且缓慢。

有没有办法加快这个速度？还是我应该使用不同的过渡框架？

如果后者是真的，任何人都可以建议一个好的版本让我尝试吗？

谢谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-21T23:57:37.997

jQuery 动画是在被动画化的 css 属性上使用 setInterval 完成的，它在移动设备上不是硬件加速的。

CSS 过渡在大多数现代设备上**都是**硬件加速的，因此是更好的选择。有一些库可以确保您的 jQuery 动画是使用 CSS 过渡而不是昂贵的 setInterval 动画完成的。

[http://playground.benbarnett.net/jquery-animate-enhanced/](http://playground.benbarnett.net/jquery-animate-enhanced/)

[http://ricostacruz.com/jquery.transit/](http://ricostacruz.com/jquery.transit/)

试试这些。

如果您没有使用[Zepto.js](http://zeptojs.com/)中缺少的任何功能，请考虑使用它，因为它比 jQuery 更小更轻，并且专为移动设备设计。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T23:45:40.627

您可以通过减少页面内容来加快此过程，但这可能不是您所要求的。一个好的解决方案可能是使用[css transitions](https://developer.mozilla.org/en/CSS/CSS_transitions/)。这样，旧浏览器不会显示动画，而它应该可以在新设备上流畅运行。优雅地降级。

# java - 在 Java 中修改对象引用值的最佳实践？

> ID：11148071
> 
> 赞同：2
> 
> 时间：2012-06-21T23:05:40.493
> 
> 标签：java

我对 Java 还很陌生，最近我正在阅读一些关于 Java 是按值传递的材料。在我自己运行测试之前，我已经阅读了[这个问题](https://stackoverflow.com/questions/498747/java-pass-by-value-reference-variables)和[这个博客。](http://javadude.com/articles/passbyvalue.htm)

现在，根据我的阅读和快速测试，我发现有两种方法可以更改对象引用中包含的变量。以下哪种方法是更好或更安全的方法？这两种方法有什么明显的问题吗？

这两个都打印出“iArr[0] = 45”。

**方法一：**

```
public static void main(String args[] ){
   int[] iArr = {1};
   method(iArr) ;
   System.out.println( "iArr[0] = " + iArr [0] ) ;
}
public static void method(int[] n ) { 
    n [0] = 45 ;
} 
```

**方法二：**

```
public static void main(String args[] )
{
   int[] iArr = {1};
   iArr = method(iArr) ;
   System.out.println( "iArr[0] = " + iArr [0] ) ;
}
public static int[] method(int[] n ) { 
    n [0] = 45 ;
    return n;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:17:11.357

第二种方法开辟了别名的可能性。

```
int[] n = {1};
int[] j;

j = method(n);
j[0] = 342;
System.out.println("iArr[0] = " + n[0]);
System.out.println("iArr[0] = " + j[0]); 
```

将打印出：

```
iArr[0] = 342
iArr[0] = 342 
```

因此，在这种情况下，我会选择第一种方法。您只想更改数组，无需返回引用。如果需要，也可以轻松创建自己的别名。从第二种方法中也不清楚您是否更改了实际参数值，我认为这是非常糟糕的做法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T23:22:12.480

我发现*这两种*方法都不理想，因为它们*都会引起相同的副作用*。

也就是说，**它们是相同**的，但是第二种方法*也*返回了*修改后的对象*：第二种方法*仍然*修改了传入的数组对象！`iArr`示例代码中 #2 的返回值的重新赋值对修改的对象*没有影响*！请记住，Java 使用[Call-By-Object-Sharing](http://en.wikipedia.org/wiki/Evaluation_strategy#Call_by_sharing)语义（对于引用类型）；返回值与此行为*无关。*

我实际上*真的不喜欢*方法#2，因为它“隐藏”了这个事实（我看着签名并想“哦，我得到了一个*新*的数组对象！”），而方法#1“它是脏活”，但我可以告诉从`void`返回类型很快。（在某些高级外壳中，“链接”可能很有用；这*不是*其中之一。）

这是一个*不会*引起副作用的简单版本：（我建议*尽量减少*副作用，因为它通常使代码更容易推理和调试。）

```
public static void main(String args[] )
{
   int[] iArr = {1};
   int[] newArr = method(iArr) ;
   System.out.println( "iArr[0] = " + iArr [0] ) ;
   // This is different here, but it would "be the same" in the 
   // 2nd-case example in the post.
   System.out.println( "newArr[0] = " + newArr [0] ) ;
}
public static int[] method(int[] n ) {
    // This is a silly stub method, n would be presumably used.
    int[] x = new int[1];
    x[0] = 45; // modifying a DIFFERENT object
    return x;  // returning the NEW object
} 
```

# magento - createBlock 需要什么

> ID：11148072
> 
> 赞同：1
> 
> 时间：2012-06-21T23:05:41.027
> 
> 标签：magento

我想创建一个块并将该块添加到我的模板中

```
$this->_addContent($this->getLayout()->createBlock("device/device")) 
```

现在，它没有显示任何内容。

要注意哪些点，以便我的块将被渲染（要注意哪些文件？）

笔记：

```
 COMPANY NAME: Abc
 MODULE NAME: Device 
```

此外，createBlock("device/device") 返回“false”

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T23:49:57.787

`device/device`传递给的字符串`createBlock`是类别名。类别名为 Magento 开发人员提供了一种在不使用实际类名的情况下引用类的方法。这种间接允许一个类被替换（或用 Magento 术语重写）另一个类，而无需更改任何实例化和使用该类的代码。

您首先在模块`config.xml`文件中定义类的前缀，如下所示（注意：将此代码添加到任何现有标签中，而不是将其放在底部`config.xml`）：

```
<config>
    <global>
        <blocks>
            <device>
                <class>Abc_Device_Block</class>
            </devicer>
        </blocks>
    </global>
</config> 
```

在为块构建类名时，xml 的部分是别名中 / 之前的部分，并在生成类名时替换标签的内容。然后将 / 替换为 _ 并将类别名的其余部分附加到类名中。因此，使用类别名`device/device`和上面的 XML，将构建以下类名`Abc_Device_Block_Device`，Magento 将期望在`Abc/Device/Block/Device.php`. 它将按照 include_path 中指定的顺序搜索文件夹，通常是`app/code/local`，然后`app/code/community`是`app/code/core`，最后是 `lib.

相同的基本逻辑也适用于模型和助手类。

[Alan Storm](https://stackoverflow.com/users/4668/alan-storm)不可或缺的[CommerceBug](http://store.pulsestorm.net/products/commerce-bug)扩展有一个很好的工具，可以测试模型/块/助手类别名在类名和文件位置方面映射到什么。

此方法的其他参数是可用于从布局 XML 文件中引用块（并修改它）的名称，以及可在布局 XML 中找到的其他属性的数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T00:46:39.937

这是一个很好的答案，吉姆。给它加一个点，优先级是

1.  当地的
2.  社区然后来了
3.  核心如果我没看错。

# javascript - 即使在 DOM 就绪时触发/模拟点击

> ID：11148073
> 
> 赞同：0
> 
> 时间：2012-06-21T23:05:43.127
> 
> 标签：javascript, jquery

我有这个在点击时调用的 jQuery，

```
$("#overflow-cntr img").click(function(){
            $this = $(this);
            $("#bigpic-cntr canvas").remove();  
            $("#bigpic-cntr #bigpic").css("display", "block");
            window.setTimeout(function(){
                EFFECTS[$this.attr("id")]();
                }, 30);
        }); 
```

我如何在 DOM 就绪而不是点击时触发它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T23:06:43.717

```
$(document).ready(function(){
    // bind the event and then trigger it immediately
    $("#overflow-cntr img").click(function(){
        $this = $(this);
        $("#bigpic-cntr canvas").remove();  
        $("#bigpic-cntr #bigpic").css("display", "block");
        window.setTimeout(function(){
            EFFECTS[$this.attr("id")]();
            }, 30);
    }).trigger('click');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:08:00.027

将函数放在 $(document).ready() 中而不是 click() 中：

```
$(document).ready(function () {
    $this = $("#overflow-cntr img");
        $("#bigpic-cntr canvas").remove();  
        $("#bigpic-cntr #bigpic").css("display", "block");
        window.setTimeout(function(){
            EFFECTS[$this.attr("id")]();
            }, 30);
}); 
```

# haskell - Yesod 布局中的站点范围变量（django 上下文处理器模拟）

> ID：11148074
> 
> 赞同：4
> 
> 时间：2012-06-21T23:05:46.353
> 
> 标签：haskell, yesod

Yesod 是否有可能在站点范围内设置变量？假设，我有主菜单，哪些条目是从 DB 收集的，并在每个页面上呈现：我应该在每个处理程序中手动获取条目吗？

我试图在 Foundation.hs 的`instance Yesod App`声明中做到这一点`defaultLayout`：

```
 instance Yesod App where
    ...

    defaultLayout widget = do
      ...
      entries <- runDB $ selectList [RubricOnTop ==. True] []
      ... 
```

但这无法编译：我的类型`Entity`与`RubricGeneric`.

**解决方案**

```
 $forall rubric <- map entityVal rubrics
      ... 
```

在 default-layout-wrapper.hamlet 中。尚未在 defaultLayout 函数中找到执行此操作的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T04:41:19.160

您显示的代码很好，但是在使用类型时需要记住`entries`，类型是`Entity Rubric`，而不是`Rubric`。

# c# - 如何确保在当前行完成之前不执行下一行代码

> ID：11148075
> 
> 赞同：-3
> 
> 时间：2012-06-21T23:05:55.287
> 
> 标签：c#, wait

```
DirectoryInfo di = new DirectoryInfo(lPath); 
DirectoryInfo dest = new DirectoryInfo(lPath9);
if (!dest.Exists) dest.Create(di.GetAccessControl());
string mapDirName = di.FullName;
di.Delete(true);
Thread.Sleep(20);  // let the process wait a bit       
dest.MoveTo(mapDirName);           
Thread.Sleep(20);  // let the process wait a bit 
```

上面的代码大部分时间都有效。但是，有时将 dest 重命名为 di 后会丢失一些子目录。

我认为这是因为在删除完成之前重命名已经开始。在重命名之前，我可以添加一个 while 循环来检查 di 是否存在。如，

```
int i=0;
While (di.Exists && i < 10) {
     Thread.Sleep(10000);
     i++;
} 
```

它仍然只会等待 10000*10 毫秒。如果不进入无限循环，就没有确定的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-02T11:11:28.553

我有类似的情况，我需要确保在继续之前删除所有内容。这就是我设法绕过它的方法。到目前为止似乎工作

```
var dir = new DirectoryInfo(location);
while (dir.Exists)
{
    dir.Delete(true);
    dir = new DirectoryInfo(location);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:26:21.163

与其在移动 dest 目录之前等待任意时间，不如遍历 di 目录中的文件？

```
foreach (FileInfo file in di.GetFiles())
{
    File.Delete( file );
}

dest.MoveTo( mapDirName ); 
```

# node.js - 使用 Node.JS 使用 Stream 创建

> ID：11148078
> 
> 赞同：0
> 
> 时间：2012-06-21T23:06:12.563
> 
> 标签：node.js, express

我有一个应用程序，它使用 Node.JS 流式传输 MP3。目前这是通过以下发布路线完成的......

```
app.post('/item/listen',routes.streamFile)
...
exports.streamFile = function(req, res){
  console.log("The name is "+ req.param('name'))
  playlistProvider.streamFile(res, req.param('name'))
}
...
PlaylistProvider.prototype.streamFile = function(res, filename){
  res.contentType("audio/mpeg3");
  var readstream = gfs.createReadStream(filename, {
      "content_type": "audio/mpeg3",
      "metadata":{
        "author": "Jackie"
       },
       "chunk_size": 1024*4 });
  console.log("!")
  readstream.pipe(res);
} 
```

有没有人可以帮助我在客户端阅读此内容？我想使用 JPlayer 或 HTML5，但我对其他选项持开放态度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:00:11.217

所以这里真正的问题是，我们正在“请求一个文件”，所以这作为 GET 请求会更好。为了做到这一点，我使用了明确的“RESTful”语法'/item/listen/:name'。然后，您可以按照上一张海报提供的链接中指定的方式使用 JPlayer。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-21T23:13:41.243

我假设您没有费心访问[他们的网站](http://jplayer.org/)，因为如果您这样做了，您会看到几个如何使用 HTML5/JPlayer 实现此目的的示例。以下是其在线开发人员文档提供的基本示例：

`<html> <head> <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script> <script type="text/javascript" src="/js/jquery.jplayer.min.js"></script> <script type="text/javascript"> $(document).ready(function(){ $("#jquery_jplayer_1").jPlayer({ ready: function() { $(this).jPlayer("setMedia", { mp3: "http://www.jplayer.org/audio/mp3/Miaow-snip-Stirring-of-a-fool.mp3" }).jPlayer("play"); var click = document.ontouchstart === undefined ? 'click' : 'touchstart'; var kickoff = function () { $("#jquery_jplayer_1").jPlayer("play"); document.documentElement.removeEventListener(click, kickoff, true); }; document.documentElement.addEventListener(click, kickoff, true); }, loop: true, swfPath: "/js" }); }); </script> </head> <body> <div id="jquery_jplayer_1"></div> </body> </html>`

# objective-c - 在基于视图的 NSTableView 中，如何通过单击使控件成为第一响应者？

> ID：11148085
> 
> 赞同：7
> 
> 时间：2012-06-21T23:06:41.990
> 
> 标签：objective-c, macos, cocoa, nstableview, nscontrol

基于视图的 NSTableView 似乎只是标准行为，其中，为了使表格内的文本字段成为第一响应者，用户必须双击或单击并“保持冷静”。

然而，鉴于基于视图的 NSTableViews 提供的灵活性，这种行为并不总是可取的，因为现在有许多不同和复杂的应用程序可能不仅仅是做一个“老派”表。

**如何通过单击轻松使基于视图的 NSTableView 中的控件（可能与其他控件一起位于单元格中）成为第一响应者？**

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-25T17:00:05.913

为了解决这个问题，在 NSTableView 上重写这个方法：

```
@interface NSResponder (NSControlEditingSupport)

/* This is a responder chain method to allow controls to determine when they should become first responder or not. Some controls, such as NSTextField, should only become first responder when the enclosing NSTableView/NSBrowser indicates that the view can begin editing. It is up to the particular control that wants to be validated to call this method in its -mouseDown: (or other time) to determine if it should attempt to become the first responder or not. The default implementation returns YES when there is no -nextResponder, otherwise, it is forwarded up the responder chain. NSTableView/NSBrowser implements this to only allow first responder status if the responder is a view in a selected row. It also delays the first responder assignment if a doubleAction needs to (possibly) be sent. 'event' may be nil if there is no applicable event.
*/
- (BOOL)validateProposedFirstResponder:(NSResponder *)responder forEvent:(NSEvent *)event NS_AVAILABLE_MAC(10_7);

@end 
```

并立即返回 YES，以便快速做出 firstResponder。如果文本字段被击中，表格会“延迟”做出第一响应者，并且除非首先选择该行，否则不允许做出它。

# node.js - 超出 Node.js maxFieldSize

> ID：11148086
> 
> 赞同：2
> 
> 时间：2012-06-21T23:06:43.627
> 
> 标签：node.js, stream, express, multipart

我正在将一组图像上传到我的 node.js express 服务器，但出现错误 - “错误：超出 maxFieldsSize”。看起来默认的 maxFieldsSize 是 2MB。我需要能够上传多达 15MB 的数据。如何增加 MultipartParser 的 maxFiedsSize？

编辑：

```
exports.perform = function(req, res) {
incomingForm.maxFieldsSize = 20 * 1024 * 1024; // increase fields size?
var json = req.body;
var nodemailer = require('../node_modules/nodemailer');
var fs = require('fs');
var exec = require('child_process').exec;
var events = require('events');
var mustache = require('../html/mustache');

// build html
var buildHtml = function(error) {

    console.log("building html");       

    var html = fs.open('./temp.html', 'w');
    var strTemplate;
    if (json.user_language == 'de')
        strTemplate = fs.readFileSync('./email/RM01_CLAIM_FORM_DE.html').toString();
    else
        strTemplate = fs.readFileSync('./email/RM01_CLAIM_FORM_EN.html').toString();

    // get data
    var data = {
        passenger_name : json.first_name + ' ' + json.last_name,
        passenger_address : json.passenger_address,
        passenger_telephone : json.passenger_telephone,
        passenger_email : json.passenger_email,
        flight_info : json.flight_info,
        ticket_number : json.ticket_number,
        complaint_reason : json.complaint_reason,
        extraordinary_circumstances : json.extraordinary_circumstances,
        legal_insurance : json.legal_insurance,
        comments : json.comments,
        language : json.user_language,
        media : json.media_attachments
    }

... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T04:26:49.397

你试过了吗：

```
 app.use(express.limit('15mb')); 
```

# c# - 文件格式问题（明文）

> ID：11148090
> 
> 赞同：0
> 
> 时间：2012-06-21T23:07:02.407
> 
> 标签：c#, encryption, winzip

我收到了一封带有附件的电子邮件，该附件是一个 zip 文件。由于某种原因，电子邮件客户端没有将其作为单独的文件附加，而只是将其呈现为电子邮件中的文本。该 zip 文件没有其他副本。我正在尝试恢复它，但不知道是否可能。电子邮件以文本形式显示这样的文件；

```
>Content-Type: application/x-zip-compressed; name="me.zip";
>
>Content-Disposition: attachment; filename="me.zip"
>
>Content-Transfer-Encoding: base64
>
>
>
>UEsDBBQAAQAIANeV9y5y6d5oG..... etc. 
```

它只是用随机字母延续了很长时间。有谁知道是否有可能恢复这样的文件？

感谢您的任何指示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:11:23.307

它是一个 base64 编码的文件，您可以简单地对 base64 编码的字符进行解码并将结果输出到一个文件中（这将是二进制数据，因为它是加密的，所以看起来会更奇怪）。

线索在`Content-Transfer-Encoding`标题中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-22T12:54:45.623

我使用此处的代码来解决此问题。在线 base64 解码器不工作，但它通过这个代码片段工作。只需复制和粘贴，无需修改；

[http://msdn.microsoft.com/en-us/library/system.convert.frombase64string%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string%28v=vs.110%29.aspx)

```
public void DecodeWithString() {
   System.IO.StreamReader inFile;    
   string base64String;

   try {
      char[] base64CharArray;
      inFile = new System.IO.StreamReader(inputFileName,
                              System.Text.Encoding.ASCII);
      base64CharArray = new char[inFile.BaseStream.Length];
      inFile.Read(base64CharArray, 0, (int)inFile.BaseStream.Length);
      base64String = new string(base64CharArray);
   }
   catch (System.Exception exp) {
      // Error creating stream or reading from it.
      System.Console.WriteLine("{0}", exp.Message);
      return;
   }

   // Convert the Base64 UUEncoded input into binary output. 
   byte[] binaryData;
   try {
      binaryData = 
         System.Convert.FromBase64String(base64String);
   }
   catch (System.ArgumentNullException) {
      System.Console.WriteLine("Base 64 string is null.");
      return;
   }
   catch (System.FormatException) {
      System.Console.WriteLine("Base 64 string length is not " +
         "4 or is not an even multiple of 4." );
      return;
   }

   // Write out the decoded data.
   System.IO.FileStream outFile;
   try {
      outFile = new System.IO.FileStream(outputFileName,
                                 System.IO.FileMode.Create,
                                 System.IO.FileAccess.Write);
      outFile.Write(binaryData, 0, binaryData.Length);
      outFile.Close();
   }
   catch (System.Exception exp) {
      // Error creating stream or writing to it.
      System.Console.WriteLine("{0}", exp.Message);
   }
} 
```

# iphone - 在后台线程中运行操作并有一个完成块？

> ID：11148096
> 
> 赞同：1
> 
> 时间：2012-06-21T23:07:59.883
> 
> 标签：iphone, objective-c, ios, ipad

我有一个从磁盘读取的任务，可能需要相当长的时间，所以不想在主线程中执行它。我想要的是在从磁盘读取后调用函数 X。在 iOS 中执行此操作的最佳方法是什么？

到目前为止，这是我尝试过的：

```
 NSInvocationOperation *processDataOperation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(readDisk:) object:nil];
                [processDataOperation setQueuePriority:NSOperationQueuePriorityVeryHigh];
                [processDataOperation setCompletionBlock:^(void){
                     NSMutableArray *feedItemsArray = [self generateFeedItemsFromDictionary:streamDiskData];
                     [self postFetchCompletedNotificationForDict:queryStringDict withFeedItems:feedItemsArray isFresh:NO];
                }]; 
```

基本上我使用的是 NSInvocationOperation 然后设置它的完成块，但是问题是在我的完成块中我需要在 readDisk 中生成的结果。如何在完成块中访问它？这几乎是不可能的吧？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T00:40:04.453

使用 NSInvocations 是可能的，但比必要的复杂得多，在主线程之外实现微不足道的工作量。

GCD 和 NSOperations 都可以用来实现广泛的并发策略。从面向对象的角度来看，NSOperations 比 CGD 块更抽象，这使得它们 (imo) 更易于“设计”，并且可能在我实现它们的范围之外进行优化。GCD 是较低级别的：这使得与它的交互看起来稍微复杂一些（实际上并非如此），但是从事这种工作的人会告诉你它“更高效”并且“开销更少”。

我个人的方法是在我的应用程序中有设计/编排的并发模式的场景中使用 NSOperations，并使用 GCD 进行琐碎的并发/后台操作。

如果我需要做的只是触发一些与设计无关但需要在后台完成的任意任务，我会使用 CGD。这就是我在这种情况下可能会使用的：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^{

    [self readDisk];
    NSMutableArray *feedItemsArray = [weakSelf generateFeedItemsFromDictionary:streamDiskData];

        dispatch_sync(dispatch_get_main_queue(), ^{

        //Call back to the main thread before performing/posting anything touching UIKit
        [self postFetchCompletedNotificationForDict:queryStringDict withFeedItems:feedItemsArray isFresh:NO];
        })
})]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:24:20.597

您总是可以使用大型中央调度在后台进行操作。

由于它是一个块，您可以正常调用该方法并存储结果。如果您需要更新任何 UI 或在完成后执行您需要做的任何事情，然后获取主队列。

```
dispatch_queue_t queue = dispatch_queue_create("read disc", NULL);
dispatch_async(queue, ^{
    result = [self readDisc];
    dispatch_async(dispatch_get_main_queue(), ^{
        //update UI or do whatever you need to do with the result of readDisc
    });
});
dispatch_release(queue); 
```

# jquery - 如何在 jquery ui 中停止拖动事件

> ID：11148101
> 
> 赞同：1
> 
> 时间：2012-06-21T23:08:32.540
> 
> 标签：jquery, jquery-ui, jquery-ui-draggable

我有一个 jquery ui，如下所示：

```
$('.draggable').draggable({
  drag: function(event, ui){
    if(this.offsetTop > 0 || this.offsetLeft > 0) return false;
  }
}) 
```

基本上我想要它，以便每次用户拖动时，我都想不断测试一个条件是否为真（在这种情况下，我希望可拖动的顶部和左侧粘在父级的一侧）。

我认为上面的代码只会取消那个特定的拖动事件，但它似乎完全停止了拖动。知道如何在满足条件时取消拖动事件吗？

非常感谢！

杰森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:27:29.530

为了让可拖动对象保持活力，请不要返回 false。从您所说的来看，您可能需要做一些事情来限制拖动（ui）元素的位置。

这是我为回答另一个 SE 问题而整理的小提琴。

[http://jsfiddle.net/XLrNF/](http://jsfiddle.net/XLrNF/)

# c# - 是否可以将单元测试合并到一个列表中？

> ID：11148104
> 
> 赞同：1
> 
> 时间：2012-06-21T23:09:16.900
> 
> 标签：c#

我有一堆单元测试（Test1、Test2 等），但不是让它们自动运行，我想做类似以下的事情：

```
List<Test> tests = {
    Test1,
    Test2,
    Test3,
    ...
} 
```

这样做的目的是能够轻松地注释掉/取消注释（启用/禁用）大量测试，以隔离我立即感兴趣的测试。

这可能吗，还是我坚持在每个测试标头中添加/删除 [禁用] 标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:22:56.760

Visual Studio 允许创建和运行测试列表。只需从菜单中选择**Test -> Create Test List...。**然后，您可以只运行您定义的任何特定列表中的测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:19:13.757

如果 NUnit 是一个选项，您可以使用[`TestCaseAttribute`](http://nunit.org/?p=testCase&r=2.5). ReSharper 确实将这一点与 Visual Studio 很好地结合在一起。

基于[这个答案](https://stackoverflow.com/a/1010710/4068)，MSTest 不支持这个。

# mysql - 我可以将 MySQL ifnull 与 select 语句一起使用吗？

> ID：11148106
> 
> 赞同：2
> 
> 时间：2012-06-21T23:09:30.943
> 
> 标签：mysql, select, ifnull

我正在尝试以下操作，但无法找出问题所在：

```
IF( IFNULL(
      SELECT * FROM vertreter AS ag 
      WHERE ag.iln = param_loginID 
      AND ag.verkaeufer = param_sellerILN
      ),
      UPDATE vertreter AS agUp
      SET agUp.vertreterkennzeichen
      WHERE agUp.iln = param_loginID AND agUp.verkaeufer = param_sellerILN
      ,
      INSERT INTO vertreter AS agIn
          ( agIn.iln, agIn.verkaeufer, agIn.vertreterkennzeichen, agIn.`status` )
      VALUES
          ( param_loginID, param_sellerILN, param_agentID, 'Angefragt' )
      ); 
```

**问题：**
这是否有可能检查 SELECT 是否返回 NULL 然后根据 A 或 B 执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:25:25.823

您需要创建唯一的复合索引`(iln + verkaeufer)`。

```
CREATE UNIQUE INDEX vertreter_iln_verkaeufer ON vertreter (iln, verkaeufer) 
```

[http://dev.mysql.com/doc/refman/5.0/en/create-index.html](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)

然后您可以在一个查询中执行此操作：

```
INSERT INTO vertreter
(agIn.iln, agIn.verkaeufer, agIn.vertreterkennzeichen, agIn.`status`)
VALUES (param_loginID, param_sellerILN, param_agentID, 'Angefragt')
ON DUPLICATE KEY UPDATE vertreterkennzeichen = param_agentID 
```

文档：[http ://dev.mysql.com/doc/refman/5.5/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.5/en/insert-on-duplicate.html)

# java - 使用 BufferedOutputStreams 时 ObjectInputStream 不会初始化

> ID：11148109
> 
> 赞同：0
> 
> 时间：2012-06-21T23:09:57.900
> 
> 标签：java, objectoutputstream, objectinputstream, bufferedoutputstream

我正在尝试通过套接字发送对象以进行游戏，但它们需要很长时间才能发送并且可能导致游戏挂起。我想使用 BufferedOutputStreams 和 BufferedInputStreams 来发送数据，但是当我在客户端使用 BufferedOutputStream 时，我的 ObjectInputStream 不会在服务器端初始化。奇怪的是没有抛出任何错误。

我只提供所涉及的代码，因为要花很长时间来解释发生了什么。每个游戏初始化两个客户端。

```
/*Server Code*/

ObjectOutputStream toClients;//stream to both players
ObjectInputStream fromClients;//stream from both players
Socket client1;//player one socket
Socket client2;//player two socket
public RunGame(Socket client1, Socket client2)throws IOException//constructor of a new thread
{
    this.client1=client1;
    this.client2=client2;
}
public void run()//for the thread
{
    try{
        this.createGame();
        /*
         rest of code for server when running game
         */
    }
    catch(IOException e){e.printStackTrace();}
    catch(ClassNotFoundException e){e.printStackTrace();}
}
public void createGame()
{
    try{
        System.out.println("about to create");//this prints out
        fromClients=new ObjectInputStream(client1.getInputStream());//first initialization

        System.out.println("created");//this doesn't
        String s1=(String)fromClients.readObject();

        fromClients=new ObjectInputStream(client2.getInputStream());//sets input to player 2
        String s2=(String)fromClients.readObject();
    }
    catch(IOException e){e.printStackTrace();}
    catch(ClassNotFoundException e){e.printStackTrace();}
}

/*Client Code*/
Socket sock;//created in the constructor of the thread
ObjectOutputStream toServer;
ObjectInputStream fromServer;
public void run()
{
    try{
    System.out.println("about to create");//this prints
    toServer=new ObjectOutputStream(new BufferedOutputStream(sock.getOutputStream(),8*1024));//bufferedoutputstream is here
    toServer.writeObject("String that is to be sent to server");
    System.out.println("written");//this also prints
    }
    catch(IOException e){e.printStackTrace();}
    catch(ClassNotFoundException e){e.printStackTrace();}
    /*
     rest of client code
     */
} 
```

我已经浏览了所有论坛，但找不到任何有用的东西，这让我认为我正在做一些非常新手的事情。谢谢你提供的所有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:19:46.730

您需要否则不会将其输出发送到套接字[`.flush()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/ObjectOutputStream.html#flush%28%29)。`ObjectOutputStream``BufferedOutputStream`

# android - MonoDroid ListView 选择问题

> ID：11148110
> 
> 赞同：0
> 
> 时间：2012-06-21T23:10:03.733
> 
> 标签：android, xamarin.android

我创建了一个 MonoDroid 应用程序，其中我有一个 ListView 填充了自定义行布局。

自定义行布局有 3 个 textview：lblA、lblB、lblC 和一个不可见的 imageview：img

到目前为止一切顺利，列表视图正确地填充了自身，并且一切正常并按预期显示。

但是，我目前在项目选择方面面临一个问题，我希望在选择项目时不可见的图像视图变得可见，并且在再次选择时不可见。问题是，如果我选择一个项目并继续滚动，该行似乎会重复自己并且无限地可见图像视图！

这是我正在尝试实现的自定义视觉选择，但它没有像我预期的那样工作。

这是项目选择的代码：

```
private void listView_ItemClick(object sender, AdapterView.ItemClickEventArgs e){
    ListView lv = (sender as ListView);
    View row = lv.GetChildAt(e.Position);
    var item = row.FindViewById(Resource.Id.img);

    item.Visibility = (item.Visibility == ViewStates.Invisible) ? ViewStates.Visible :
                                                                      ViewStates.Invisible;
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:19:00.680

我想通了，其实是我想太多了。

在我的数据列表中，我添加了一个“已选择”布尔值，然后修改了我的适配器以根据此布尔值切换可见性。

通过使用 my_list[e.Position] 直接访问数组，布尔值作为其值在项目单击时受到影响。

要改变那一刻的视觉效果，我只需从 e.View 访问视图。

# asp.net - 使用备用堆栈模拟带有键的 ASP.NET 会话

> ID：11148111
> 
> 赞同：2
> 
> 时间：2012-06-21T23:10:08.877
> 
> 标签：asp.net, session

## 更新 2

通过查看 .NET 源代码，我能够找到一些有用的信息，但最终似乎在截止日期之前进行逆向工程需要太长时间，所以我选择使用第一个选项，即只拥有一个网络服务为我生成 .ASPXAUTH cookie。我在下面找到了一些更有用的链接，以防有人想更多地从头开始生成自己的 cookie。感谢所有回复的人！

### 链接

*   [表单认证的代码项目说明](http://www.codeproject.com/Articles/16822/The-Anatomy-of-Forms-Authentication)
*   [表单身份验证票位图的图片](http://www.codeproject.com/KB/aspnet/Forms_Auth_Internals/image001.jpg)

## 更新 1

我能够从[.netlibrarysource](http://referencesource.microsoft.com/netframework.aspx)找到来源。看起来 setauthcookie 的源代码包含在此源代码中。我会看看我是否可以通过查看它来弄清楚如何生成 cookie。

## 原帖

我看到另一个线程 [1] 可能有类似的问题，但我无法从措辞中确切地看出张贴者想要什么，所以我正在写我自己的。

我有一个用 ASP.NET 编写的 Web 应用程序，并引入了另一种语言/堆栈（我们会说 RoR）来对网站的某些功能进行整容。由于 .NET 是第一个，所有会话优先级都围绕使用身份验证票证（cookie 中的 ASPXAUTH 字段）来验证用户是否经过身份验证。这个字段是在许多 ASP 站点中生成的，用于处理会话，我*不*使用它就无法解决。

这通常不会成为问题，但我希望用户能够使用 RoR 页面登录站点，并且无论他们访问的是 ASPX 页面还是 RoR 页面，都能够在整个站点中保留身份验证状态。所以，我觉得我有两个选择：

1.  创建一些 RoR 发出请求的 .NET Web 服务，以便使用 SetAuthCookie() 从机器密钥 [2] 生成适当的令牌（cookie 的 ASPXAUTH 数据），或者
2.  为 RoR 找到一种方法来模拟 .NET 用于生成令牌的任何方法，这样我就可以在 cookie 中设置值，而不必在用户访问 ASPX 页面时重新验证用户身份。

数字 2 更可取，但在谷歌上搜索 3-4 小时后我找不到任何关于如何做到这一点的信息，那么现在这里有人如何完成数字 2 吗？否则，我会做前者或尝试其他方法。提前感谢您提供我尚未考虑的建议、评论或替代选项。

[1][如何在 python 上创建 .ASPXAUTH cookie](https://stackoverflow.com/questions/3933419/how-to-create-aspxauth-cookie-on-python) [2] [http://msdn.microsoft.com/en-us/library/ff649308.aspx](http://msdn.microsoft.com/en-us/library/ff649308.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:29:38.277

ASP.NET 设置授权 cookie。您还可以创建自己的安全 cookie，您可以将其与 ASP.NET cookie 一起设置（只是劫持登录代码）。然后您可以访问此 cookie 以检查用户是否已登录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:31:10.830

这不是一个完整的答案，所以请不要太苛刻，但这也不是评论，所以这里是：

您如何托管 RoR 内容，您是在 IIS 下使用它还是以其他方式使用它？

如果两个内容都可以从 IIS 中的同一站点/虚拟目录运行并通过全局 ASP 处理程序使用身份验证，然后将查询传递给正确的处理程序，我将调查什么。

可以创建一个通用处理程序来捕获所有流量，并且您可以通过这种方式实现身份验证；其机制取决于您使用的 II 版本以及您的 RoR 内容的提供方式。

# c# - 如何从字符串中提取非数字文本

> ID：11148112
> 
> 赞同：3
> 
> 时间：2012-06-21T23:10:26.480
> 
> 标签：c#, string, substring

例如，我有这个字符串可以随时更改，我只想要其中的字母文本：

> 法拉利 5 10 15000 -5 0.2

因此，我想要“法拉利”。

有时“法拉利”和数字之间不会有空格。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T23:15:35.593

```
string str = "Ferrari 5 10 15000 -5 0.2";
string text = Regex.Match(str, @"[a-zA-Z\s]+").Value.Trim(); 
```

通过匹配空格然后修剪结果，它将匹配`"Some Car"`.`"Some Car 5 10 ..."`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T23:16:37.997

使用正则表达式，您可以像这样匹配首字母

```
string text = "Ferrari 5 10 15000 -5 0.2";
string pat = @"([a-z]+)";

// Instantiate the regular expression object.
Regex r = new Regex(pat, RegexOptions.IgnoreCase);

// Match the regular expression pattern against a text string.
Match m = r.Match(text); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T23:16:51.190

你可以使用

```
String s = Regex.Match(str, @"[a-zA-Z]+").Value; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T23:17:46.223

一种选择是转换为 char 数组并提取字母，然后转换回字符串：

```
string text = "Ferrari 5 10 15000 -5 0.2";
string alphas = string.Join( "", text.ToCharArray().Where( char.IsLetter ) ); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-21T23:20:45.763

这是正则表达式派上用场的时候之一：

```
Regex wordMatcher = new Regex("[a-zA-Z]+");
foreach(Match m in wordMatcher.Matches("Ferrari 55 100000 24 hello"))
    MessageBox.Show(m.Value); 
```

本质上，RegEx 所做的只是尝试匹配 az 之间的字母组，忽略大小写。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-21T23:39:59.683

如果它总是以 [digits, -, ., and spaces] 结尾，你可以使用`.TrimEnd`：

```
record.TrimEnd("0123456789 .-".ToCharArray()); 
```

...或者如果您关心的文本中没有空格，您可以阅读到第一个空格...

```
var whatINeed = new string(record.TakeWhile(c => c != ' ').ToArray()); 
```

...或者在空格上拆分时只取第一个项目...

```
var whatINeed = record.Split().First(); 
```

# java - 为什么不为所有 RPC 提供一个 ServiceImpl？

> ID：11148115
> 
> 赞同：1
> 
> 时间：2012-06-21T23:10:49.967
> 
> 标签：java, gwt, gwt-rpc

我正在开发一个足够大的 Java GWT-GAE 项目，并且我面临一些我以前没有一些 LOC 的问题。

我在 ServiceImpl 类中有几个方法，我需要直接从其他 ServiceImpl 类和 RPC 调用这些方法。我认为最好避免像 Service s = new ServiceImpl() 这样的声明，所以我想将方法​​体移动到适当的服务器端类中，让 ServiceImpl 类中的方法调用它们。这会是正确的解决方案还是有特定的模式可以遵循？如果是，那么只有一个 ServiceImpl 来包装所有的 RPC 方法不是更好吗？客户端变得有点慢，我认为这是因为我有几个这样的声明： public static final *ServiceAsync *Service = GWT.create(*Service.class);

我希望我已经清楚了。提前致谢。

安东尼奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T06:25:43.700

对于服务器端实现，请考虑使用[GWT-SL（服务器库）](http://code.google.com/p/gwt-sl/)，它允许您将 GWT 与 Spring 集成。您的 Service 实现类变成了简单的 Pojos，您不必担心创建它们，只需让 Spring 操心！

要在客户端创建 Service 实例，请使用此模式（在 *Service 接口内）以确保您只创建一次服务作为单例：

```
/**
 * Utility class for simplifying access to the instance of async service.
 */
public static class Util {
    private static UserServiceAsync instance;
    public static UserServiceAsync getInstance(){
        if (instance == null) {
            instance = GWT.create(UserService.class);
        }
        return instance;
    }
} 
```

在客户端创建服务：

```
private UserServiceAsync userService = UserService.Util.getInstance(); 
```

# ruby-on-rails - Ruby on Rails - 无法在函数中呈现变量

> ID：11148117
> 
> 赞同：0
> 
> 时间：2012-06-21T23:10:59.123
> 
> 标签：ruby-on-rails, ruby, haml

我有一些这样的 HAML 代码：

```
.clearfix
  =f.label t("labels.shortened_urls.fqdn_url")
  =f.url_field :fqdn_url, {:readonly => true}
.span1
  =link_to((t "links.shortened_urls.view"), f.object.fqdn_url(true), :target => :_blank)
  .clippy-container=clippy(fqdn_url,"#ffffff") 
```

由于最后一行，它不会渲染。如果我将最后一行更改为这样的简单字符串，它将起作用：

```
.clippy-container=clippy("test","#ffffff") 
```

但我不确定我需要使用的变量语法，我尝试了这个：

```
.clippy-container=clippy(fqdn_url,"#ffffff") 
```

或这个：

```
.clippy-container=clippy(:fqdn_url,"#ffffff") 
```

但它们都不起作用。知道如何使它与那个 fqdn_url 变量一起工作吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:14:54.483

你试过`fqdn_url.to_s`吗？

# java - 无法更改 Mac OS 外观中的 JProgressBar 颜色

> ID：11148120
> 
> 赞同：2
> 
> 时间：2012-06-21T23:11:10.207
> 
> 标签：java, swing, colors, look-and-feel, jprogressbar

我知道这个问题以前已经回答过，但它对我不起作用。我按照这里的说明进行操作：[如何更改 JProgressBar 颜色？](https://stackoverflow.com/questions/10773978/how-to-change-jprogressbar-color)

```
import javax.swing.*;
import java.awt.*;

public class ProgressBarTest extends JFrame {

    public static void main(String args[]) {
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        UIManager.put("ProgressBar.background", Color.orange);
        UIManager.put("ProgressBar.foreground", Color.black);
        UIManager.put("ProgressBar.selectionBackground", Color.red);
        UIManager.put("ProgressBar.selectionForeground", Color.green);
        JProgressBar progressBar = new JProgressBar(0,100);
        progressBar.setValue(50);
        f.add(progressBar, BorderLayout.PAGE_END);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

} 
```

我得到的只是相同的旧颜色。

![AquaProgressBarUI](../Images/1214520cf71435c014085c3907b24515.png)

我正在使用 Mac OS X 10.7.3 和 Java 1.6。我试过了`CrossPlatformLookAndFeel`，它适用于新颜色。但是，我希望它具有默认的外观和感觉。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T00:46:08.810

[要覆盖 Look & Feel 默认值，请在事件调度线程](http://download.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)上构建 GUI*之前*进行更改，如下所示。

在 上`com.apple.laf.AquaLookAndFeel`，进度条的 UI 委托是`com.apple.laf.AquaProgressBarUI`. 正如您所发现的，它忽略了许多支持本机组件的默认值。如果需要新颖的配色方案，请考虑提供您自己的 UI 委托，如此[处所示](https://stackoverflow.com/a/8886795/230513)。

`AquaProgressBarUI`：

![AquaProgressBarUI](../Images/bc66af5caf8a898491f74dbc29bf6203.png)

`CustomProgressUI:`

![CustomProgressUI](../Images/18a34474e049b8e6365455c4ed4b95de.png)

ProgressBar UI 默认值：

```
ProgressBar.background: com.apple.laf.AquaNativeResources$CColorPaintUIResource[r=238,g=238,b=238]
ProgressBar.border: javax.swing.plaf.BorderUIResource@47f08ed8
ProgressBar.cellLength: 1
ProgressBar.cellSpacing: 0
ProgressBar.cycleTime: 3000
ProgressBar.font: sun.swing.SwingLazyValue@6446d228
ProgressBar.foreground: javax.swing.plaf.ColorUIResource[r=0,g=0,b=0]
ProgressBar.horizo​​ntalSize: javax.swing.plaf.DimensionUIResource[width=146,height=12]
ProgressBar.repaintInterval：20
ProgressBar.selectionBackground: javax.swing.plaf.ColorUIResource[r=255,g=255,b=255]
ProgressBar.selectionForeground: javax.swing.plaf.ColorUIResource[r=0,g=0,b=0]
ProgressBar.verticalSize: javax.swing.plaf.DimensionUIResource[width=12,height=146]
ProgressBarUI：com.apple.laf.AquaProgressBarUI

```

SSCCE：

```
import java.awt.*;
import javax.swing.*;

public class ProgressBarTest extends JFrame {

    public static void main(String args[]) {
        UIManager.put("ProgressBar.repaintInterval", 100);
        UIManager.put("ProgressBar.border",
            BorderFactory.createLineBorder(Color.blue, 2));
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                JFrame f = new JFrame();
                f.setLayout(new GridLayout(0, 1, 5 , 5));
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                f.add(createBar());
                f.add(createBar());
                f.add(createBar());
                f.pack();
                f.setLocationRelativeTo(null);
                f.setVisible(true);
            }

            private JProgressBar createBar() {
                JProgressBar progressBar = new JProgressBar(0, 100);
                progressBar.setValue(50);
                return progressBar;
            }
        });
    }
} 
```

# r - 基于每日最大值求和

> ID：11148123
> 
> 赞同：-4
> 
> 时间：2012-06-21T23:11:33.717
> 
> 标签：r, dataframe, max, subset

我正在尝试编写一个 R 脚本，该脚本将通过我从 excel 电子表格导入的数据框（格式见下文），并找到每日值的总和，直到每日最大值（包括每日最大值）

数据看起来像这样：

```
5/1/2012  0:00  0         
5/1/2012  3:00  1
5/1/2012  6:00  2
5/1/2012  9:00  5
5/1/2012 12:00  3
5/1/2012 15:00  6
5/1/2012 18:00  2
5/1/2012 21:00  1
5/2/2012  0:00  2
5/2/2012  3:00  3
5/2/2012  6:00  6
5/2/2012  9:00  4
5/2/2012 12:00  6
5/2/2012 15:00  7
5/2/2012 18:00  9
5/2/2012 21:00  1 
```

所以我设想的功能将返回：

```
1 5/1/2012 15:00 17
2 5/2/2012 18:00 35 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:50:06.727

这是对@Thierry 在您上一个问题中给出的答案的一个非常小的调整

```
dat.str <- '5/1/2012  0:00  0 
5/1/2012  3:00  1
5/1/2012  6:00  2
5/1/2012  9:00  5
5/1/2012 12:00  3
5/1/2012 15:00  6
5/1/2012 18:00  2
5/1/2012 21:00  1
5/2/2012  0:00  2
5/2/2012  3:00  3
5/2/2012  6:00  6
5/2/2012  9:00  4
5/2/2012 12:00  6
5/2/2012 15:00  7
5/2/2012 18:00  9
5/2/2012 21:00  1
'

dat <- read.table(textConnection(dat.str))

library(plyr)
ddply(dat, .(V1), function(x){
   sum(x[1:(which.max(x$V3)), "V3"])
}) 
```

我还要说你没有表现出任何主动性或任何工作。编辑@John 是的，自从上一个问题已编辑以反映这一点以来，OP 略微更改了数据。

# php - 如何将特定变量从 PHP 返回到 Android

> ID：11148126
> 
> 赞同：1
> 
> 时间：2012-06-21T23:12:01.403
> 
> 标签：php, android, mysql, json

我按照他的流行教程将 Android 连接到 MySQL： [http ://www.helloandroid.com/tutorials/connecting-mysql-database](http://www.helloandroid.com/tutorials/connecting-mysql-database)

它非常擅长将数据编码回 JSON 并显示数据行。

我的问题：我只想返回一个值，一个从 PHP 到 Java 的变量，什么 id？

这是我的PHP：

```
$sql="SELECT AVG(rating) FROM ratings WHERE item_id = 1";
$result=mysql_query($sql);
$row=mysql_fetch_array($result);
echo $row[0]; 
```

我想根据上述教程的指导将最后一个“回声”发送回 Android，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:26:32.453

如果您使用的是 WebView，请尝试`addJavascriptInterface(new JavaScriptInterface(this), "Android")` [http://developer.android.com/guide/webapps/webview.html](http://developer.android.com/guide/webapps/webview.html)并调用

```
<script type="text/javascript">
  function showAndroidToast(avg_value) {
    Android.echo(avg_value);
  }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:32:14.747

$row 是一个数组，它的值应该是：

```
$row['AVG(rating)'] = <some value> 
```

您需要做的就是将`json_encode`函数扔到行周围并回显

```
print(json_encode($row)); 
```

This should get you the single value json encoded string that the java code can read.

# python - 在 R 中加载和处理 1000 多个文件

> ID：11148134
> 
> 赞同：0
> 
> 时间：2012-06-21T23:12:34.647
> 
> 标签：python, r, multicore

我对R有点陌生，所以请原谅这里的新手...

我正在用 R 编写代码以在脚本中加载 1000 个保存的数据帧（文件），该脚本对每个文件中的数据运行一个函数并将结果值存储在一个向量中。我必须用不同的功能一遍又一遍地做这件事，目前这需要很长时间。

我正在尝试使用多核 mclapply 并行化该过程，但不幸的是，从 2 到 8 个内核的任何东西似乎都比仅在一个内核上运行它需要更长的时间。

由于磁盘 I/O 限制，这个想法从根本上来说是不合理的吗？多核，甚至 R，不是正确的解决方案吗？以 Python 之类的方式打开文件然后在内容上运行 R 函数会是比 R 更好的路径吗？

对此的任何指导或想法将不胜感激 -

为清楚起见添加了代码：

```
 library(multicore)

    project.path = "/pathtodata/"

    #This function reads the file location and name, then loads it and runs a simple statistic
    running_station_stats <- function(nsrdb_stations)
    {
      varname <- "column_name"
      load(file = paste(project.path, "data/",data_set_list[1], sep = ""))
      tempobj <- as.data.frame(coredata(get(data_set_list[2])))
      mean(tempobj[[varname]],na.rm=TRUE)
    }

    options(cores = 2)

    #This file has a list of R data files data_set_list[1] and the names they were created with data_set_list[2]
    load(file = paste(project.path, "data/data_set_list.RData", sep = ""))

    thelist <- list()

    thelist[[1]] <- data_set_list[1:50,]

    thelist[[2]] <- data_set_list[51:100,]

    thelist[[3]] <- data_set_list[101:150,]

    thelist[[4]] <- data_set_list[151:200,]

    #All three of these are about the same speed to run regardless of the num of cores
    system.time(
    {
      apply(nsrdb_stations[which(nsrdb_stations$org_stations==TRUE),][1:200,],1,running_station_stats)
    })

    system.time(
      lapply(thelist, apply, 1, running_station_stats)
     )

    system.time(
      mclapply(thelist, apply, 1, running_station_stats)
    ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:45:22.290

Python 和 R 都将尝试使用多个核心来处理数字运算之类的事情。它对读取大量文件没有帮助。多线程也不是答案（re [python GIL](http://wiki.python.org/moin/GlobalInterpreterLock)）。

一些可能的解决方案（都不是简单的）是：

*   在可以（某些）文件io async的地方使用twisted之类的东西。硬编程，它不是很友好。
*   使用芹菜或其他一些自制的主从解决方案。很多滚动你自己的行动。
*   使用 Ipython (w/ [ipcluster](http://ipython.org/ipython-doc/dev/parallel/parallel_process.html) ) 生成多个进程，python 将为您重新组合 (BEST 解决方案 IMO)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T19:25:56.487

我会首先在 Python 中尝试良好的老式多处理。上面的选项也是可能的。这是使用多处理模块执行批处理作业的示例。

```
 import multiprocessing as mp
import time

def worker(x):
    time.sleep(0.2)
    print "x= %s, x squared = %s" % (x, x*x)
    return x*x

def apply_async():
    pool = mp.Pool()
    for i in range(100):
        pool.apply_async(worker, args = (i, ))
    pool.close()
    pool.join()

if **name** == '**main**':
    apply_async() 输出如下所示：

```
 x= 0, x squared = 0
x= 1, x squared = 1
x= 2, x squared = 4
x= 3, x squared = 9
x= 4, x squared = 16
x= 6, x squared = 36
x= 5, x squared = 25
x= 7, x squared = 49
x= 8, x squared = 64
x= 10, x squared = 100
x= 11, x squared = 121
x= 9, x squared = 81
x= 12, x squared = 144如您所见，这些数字不是按顺序排列的，因为它们是异步执行的。只需更改上面的 worker() 函数来进行处理，并可能使用 mp.Pool(10) 或 mp.Pool(15) 或其他方式更改并发进程的数量。像这样的事情应该是相对困难的。. .

```

```

# sql - 对有关系的书籍进行排名

> ID：11148137
> 
> 赞同：0
> 
> 时间：2012-06-21T23:12:58.037
> 
> 标签：sql, sql-server, tsql

到目前为止，我有以下查询，它非常适合根据我们的内部分数对书籍进行排名。

```
UPDATE CER
SET CER.book_rank = Ranker.ranc
FROM book_ranks CER
INNER JOIN
(SELECT Rank() over (Order by book_score desc, book_id) as ranc, book_id
FROM book_ranks
WHERE Category = 'Fiction'
GROUP BY book_id, book_score 
) Ranker
ON
CER.book_id = Ranker.book_id 
```

代码运行良好，但不考虑大小写。

输入：

```
bookName  book_score
--------  ----------
book2     45
book3     35
book5     35
book7     35
book9     30 
```

电流输出：

```
bookName  book_score  book_rank
--------  ----------  ---------
book2     45          1
book3     35          2
book5     35          3
book7     35          4
book9     30          5 
```

所需输出：

```
bookName  book_score  book_rank
--------  ----------  ---------
book2     45          1
book3     35          2
book5     35          2
book7     35          2
book9     30          5 
```

由于 book3、book5、book7 的分数相同，它们的排名应该相同，而 book9 的排名应该是 5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:23:10.747

尝试：

```
SELECT * FROM book_ranks CER
INNER JOIN
(SELECT Rank() over (Order by book_score desc  ) 
  -- only difference is here ----------------^^
  as ranc, book_id
  FROM book_ranks
  WHERE Category = 'Fiction'
GROUP BY book_id, book_score 
) Ranker
ON CER.book_id = Ranker.book_id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:25:38.663

代替

```
SELECT Rank() over (Order by book_score desc, book_id) 
```

你应该使用

```
SELECT Rank() over (Order by book_score desc) 
```

那会解决你的问题。

# objective-c - 多个 MainViewController 在实用程序应用程序中共享一个 FlipSideViewController

> ID：11148147
> 
> 赞同：0
> 
> 时间：2012-06-21T23:14:43.607
> 
> 标签：objective-c, ios

Utility App 有没有办法让多个 MainViewController 共享同一个 FlipSideViewController？我希望能够在 FlipSideViewController 中进行选择，然后让其他 ViewController 之一出现在另一面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:15:03.750

是的，这是可能的，只要确保在进行翻转转换时，将 FlipSideViewController 作为您希望 FlipSide 可见的所有视图控制器中的另一面传递...

这就是为什么您希望为每个视图有一个单独的 VC，以便您可以在多个位置重用它......

# php - 用于搜索的 Jquery 或 javascript

> ID：11148155
> 
> 赞同：0
> 
> 时间：2012-06-21T23:15:08.097
> 
> 标签：php, javascript, mysql, jquery

我一直在寻找可以使用的脚本或 API。为了能够从 mysql 中搜索数据.. 我设法创建了一个对话框并将 mysql 中的所有数据加载到其中..

我不能做的是有一个文本框，当你在那里输入用户名时，它会立即为他们搜索数据，并且能够在不刷新或关闭对话框的情况下执行此操作...

任何对如何做到这一点有任何想法的人或已经完成了它并且有代码或任何帮助的人都会受到极大的学徒和对这种东西的了解，我只知道非常基本的知识

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:21:56.953

[自动完成](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)插件是您的选择

# attributes - 在 Opencart 管理面板中按名称添加查找属性：目录 - 属性 - 属性

> ID：11148157
> 
> 赞同：0
> 
> 时间：2012-06-21T23:15:13.137
> 
> 标签：attributes, find, opencart

如何实现 Attribute 以在 Opencart 的管理区域中找到自己的名字：产品 - 属性 - 属性？是不是有一个单独的字段并且只需通过驱动进入该字段并显示属性的名称是一个属性，像往常一样在管理员中按名称搜索项目，但仅具有属性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:53:14.810

很难理解你在问什么，但如果你想为产品使用属性，那么你必须首先在目录>属性>属性中定义它们。

要在产品选项卡中列出属性，您需要编辑这些文件

```
admin>view>template>catalog>product_form.tpl
admin>controller>catalog>product.php 
```

如果您对 PHP 或 Opencart 的了解不是很深入，它将帮助您将数据从 attribute.php 控制器复制到 product.php 控制器。

至于搜索功能，这是我以前没有做过的，但是您可以尝试使用网站前面的搜索功能作为参考。

我建议您尽可能地解决这个问题，然后在遇到困难或遇到困难时提出更多问题。

***更新**

好的，既然 HTML 是你的强项，那么从那里开始是最聪明的。打开这些文件中的任何一个（具有您需要的数据的文件）。

```
admin>view>template>catalog>attribute_form.tpl
admin>view>template>catalog>attribute_group_form.tpl
admin>view>template>catalog>attribute_group_list.tpl
admin>view>template>catalog>attribute_list.tpl 
```

然后根据你所看到的向后工作。tpl 将显示看起来像 $attribute 的变量，将它们追溯到

```
admin>controller>catalog>attribute.php
admin>controller>catalog>attribute_group.php 
```

您将看到如何使用所有代码从模型中提取数据并在必要时对其进行格式化。

# php - 多组织 SaaS mySQL 设置？

> ID：11148158
> 
> 赞同：4
> 
> 时间：2012-06-21T23:15:15.447
> 
> 标签：php, mysql

我是一个团队的一员，目前正在为特定的组织群体开发专用的 SaaS 服务。我有 PHP 和 mySQL 方面的知识，所以我正在这些平台上开发它。将在云上部署它并在多个国家/地区发布。

我已经到了在数据库中分离组织/主要用户的地步，想看看你们的想法。

当 SaaS 管理发票和许多其他敏感信息时，在 mySQL 服务器上分发这些信息的最佳过程是什么？我想到了以下选项：

1) 将单个数据库中的所有信息放在单个表中，并由组织标识行分隔。- 当有几千个用户和 10,000 行时，是否看起来很安全并且可能很慢？

2) 拥有一个数据库，但使用用户 ID 分隔表，例如。'1000_invoices' - 同样可能更快但不安全。

3) 在每个组织注册和用于访问数据库的特定用户上创建单独的数据库，并且数据库名称存储在会话/cookie 中？每个组织用户。

无论如何，我想知道你们认为什么是最好的选择？如果不是以上那么你有什么建议？为什么？任何有关安全的事情都将不胜感激。以前没有使用过大型多组织应用程序。提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T23:28:02.540

我过去开发了许多 SaaS 应用程序，我们发现大型“公共”SaaS 服务（如 KashFlow，可能是 Salesforce？）使用的“单一应用程序部署、单一数据库”设置没有多大意义。原因如下：

*   第 1 点：拥有机密信息的客户公司将希望确保他们的数据更加“安全”，并且当他们的数据被划分到应用程序层之外时，更容易做出这些承诺。
*   不同的客户有时希望为他们定制他们的软件应用程序，例如他们自己的额外数据库字段、不同的登录屏幕视觉设计或不同（或自定义）系统“模块”——拥有不同的应用程序实例使这成为可能
*   它还使扩展更容易，至少在开始时是这样。通过将单个客户端的应用程序与其他应用程序分开配置到其自己的服务器，更容易实现负载平衡，而对于单个应用程序，这意味着您需要花费更长的时间来开发它以使其具有可扩展性。
*   数据库主键更容易使用。您的客户可能会开始提出问题，例如为什么他们的“CustomerID”值每次增加 500 而不是 1。
*   如果您的客户遍布世界各地，那么在另一个国家/地区进行部署（使用自己的本地服务器和数据库服务器）会更容易，而不是在国外部署大型应用程序或强迫用户使用洲际（即慢+滞后）连接到您位于数千英里外的服务器。

除了应用程序软件部署之外，还有一些缺点，例如管理数百甚至数千个数据库的额外管理负担，但它对程序代码所做的巨大、巨大的简化使其值得。此外，使用一堆 shell 脚本可以轻松实现自动配置和部署。

# objective-c - 使用 iPhone 的代码创建/显示界面对象 [Objective-C]

> ID：11148159
> 
> 赞同：-1
> 
> 时间：2012-06-21T23:15:32.027
> 
> 标签：objective-c, ios, object, dynamic, creation

我目前正在设计一个需要动态创建对象然后在 ViewController 中显示它们的应用程序。我的问题是浏览文档以尝试创建我需要的对象。我已经进行了一些搜索，甚至试图坐下来弄清楚，但是唉，我没有什么可以展示的。我已经知道如何动态创建 ViewController 但我似乎无法在其中获取任何对象。

有谁知道我如何在 XCode 中使用 Objective-C 动态创建对象（比如按钮和滑块）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:19:16.550

在代码中创建一个按钮很简单

```
- (void)addButton {

    // Create button
    UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];

    // Set the frame (location and size)
    [button setFrame:CGRectMake(0, 0, 40, 30)];

    // Set what happens when you touch the button
    [button addTarget:self action:@selector(buttonPressed) forControlEvents:UIControlEventTouchUpInside];

    // Set button text
    [button.titleLabel setText:@"Button"];

    // Add button to view
    [self.view addSubview:button];

} 
```

许多界面元素遵循类似的模式分配并初始化对象，设置框架并将其添加到视图中。

# php - php 为每个按类别排序的 joomla k2

> ID：11148163
> 
> 赞同：3
> 
> 时间：2012-06-21T23:15:46.413
> 
> 标签：php, joomla, foreach, joomla-extensions, joomla-k2

嗨，我有来自 joomla k2 模板的代码

```
<div id="itemListPrimary" class="clearfix">
<?php $thearray = $this->primary ;?>
<?php foreach($thearray as $key=>$item): ?>
    <div class="itemContainer">
    <?php
    $this->item=$item;
    echo $this->loadTemplate('item');
    ?>
    </div>
<?php endforeach; ?>
</div> 
```

现在它正在从主类别和子类别中获取项目并显示这样的项目。

```
item,
item,
item,
item, 
```

我需要它从主类别和子类别中获取项目并像这样显示它们：

```
category1
item
item

category2
item
item

category3
item
item 
```

等等。

我怎样才能做到这一点？

uptade：数组是这样构造的，或者至少有几行

```
Array ( [0] => stdClass Object ( [id] => 41 [title] => test2 [alias] => test2 [catid] => 8 [published] => 1 [introtext] =>
test2

[fulltext] => [video] => [gallery] => [extra_fields] => [] [extra_fields_search] => [created] => 2012-08-27 16:37:51 [created_by] => 62 [created_by_alias] => [checked_out] => 0 [checked_out_time] => 0000-00-00 00:00:00 [modified] => 0000-00-00 00:00:00 [modified_by] => 0 [publish_up] => 2012-08-27 16:37:51 [publish_down] => 0000-00-00 00:00:00 [trash] => 0 [access] 
```

底部的某处是其中的类别名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T12:20:16.857

只有一种方法。你必须重新排序你的数组

```
foreach($thearray as $key=>$item) {
    $items[$item->catid][] = $item;
}

foreach($items AS $catid => $cat_items) {
    echo '<h3>'.$catid.'</h3>';
    foreach($cat_items AS $item)
        echo $item->name.'<br>';
} 
```

像这样的东西。

# svn - SVN工作副本升级失败，有恢复的希望吗？

> ID：11148166
> 
> 赞同：0
> 
> 时间：2012-06-21T23:16:28.377
> 
> 标签：svn

在将我的工作副本从 1.6 升级到 1.7 的过程中，我遇到了电源故障。当我尝试返回完成升级时，我收到一个错误：svn:E200030: 表“存储库”已经存在。有没有希望恢复这个工作副本还是 FUBAR？

如果我可以恢复它，我应该遵循哪些步骤？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T17:39:40.473

SlikSVN 能够发现并修复 SmartSVN 失败的地方。不确定是什么或为什么。

# assemblies - Ninject 无法加载程序集

> ID：11148168
> 
> 赞同：0
> 
> 时间：2012-06-21T23:16:35.260
> 
> 标签：assemblies, ninject

我有一个使用 Ninject 并使用文件模式内核加载方法加载程序集的系统。这个设置一切正常。

该应用程序的一个新要求是将所有内容捆绑到一个 exe 中。为此，我们使用了[此处](http://www.digitallycreated.net/Blog/61/combining-multiple-assemblies-into-a-single-exe-for-a-wpf-application)描述的技术。因此，要向 Ninject 注册所有内容，我们需要加载程序集并为每个程序集调用内核加载。但是，这行不通。即使绑定已注册，Ninject 也总是会失败。我在调试器中看到它已注册，它在即时窗口中工作，但在代码中没有。

我们找到的唯一解决方案是手动注册每个 NinjectModule。

当程序集捆绑在另一个程序集内时，是否可以使用 Ninject？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T18:26:53.873

唯一的解决方案是手动传入对 NinjectModule 的引用。

# java - 我应该使用什么异常处理？

> ID：11148173
> 
> 赞同：0
> 
> 时间：2012-06-21T23:16:43.317
> 
> 标签：java, exception, exception-handling

我有一种方法可以在 VO 中设置一些属性。该方法如下所示：

```
public void methodToPopulateVO(MyVO vo)
{
    BackendClass bClass = new BackendClass();
    vo.setA(bClass.getA()); //Line 1
    vo.setB(bClass.getB()); //Line 2
    vo.setC(bClass.getC()); //Line 3
} 
```

这些方法`getA()`中`getB()`的任何`getC()`一个都可以抛出异常。我的要求是如果`getA()`在第 2 行和第 3 行抛出一些异常仍然代码应该执行。这适用于每一行（例如，如果第 2 行导致异常，第 3 行仍应执行）。我无法改变`BackendClass`. 由于性能是我们应用程序的一个衡量因素，我应该实施哪种异常处理技术对性能的影响较小？

请注意，实际系统有大约 20 个字段，而不仅仅是 3 个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T23:20:36.643

这是一种方法：

```
public void methodToPopulateVO(MyVO vo){
    BackendClass bClass = new BackendClass();
    try {
        vo.setA(bClass.getA()); //Line 1
    } catch (Exception e) {
        log(e);
    }
    // same for the next 2 method calls.
} 
```

现在，当`getA()`引发异常时，您记录事件并继续执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T14:30:36.360

是的，您应该使用异常处理，因为任何异常都可能引发您的方法，即

```
setA(bClass.getA()); 
setB(bClass.getB()); 
setC(bClass.getC()); 
```

您应该在 try 和 catch 中编写并使用适当的异常类来处理它或在 catch ... 中使用 Exception 类。

# hadoop - 最新的“apache mahout”库中是否有“clusterdump”的任何 seqFileDir 选项？

> ID：11148175
> 
> 赞同：6
> 
> 时间：2012-06-21T23:16:52.447
> 
> 标签：hadoop, amazon-ec2, cluster-analysis, mahout, k-means

我正在尝试对 mahout kmeans 聚类示例（synthetic_control 示例）的输出执行“clusterdump”。但我遇到以下错误：

```
> ~/MAHOUT/trunk/bin/mahout clusterdump --seqFileDir clusters-10-final --pointsDir clusteredPoints --output a1.txt

MAHOUT_LOCAL is not set; adding HADOOP_CONF_DIR to classpath.
Running on hadoop, using /usr/lib/hadoop/bin/hadoop and HADOOP_CONF_DIR=/usr/lib/hadoop/conf/
MAHOUT-JOB: /home/<username>/MAHOUT/trunk/examples/target/mahout-examples-0.8-SNAPSHOT-job.jar

12/06/21 22:43:18 WARN conf.Configuration: DEPRECATED: hadoop-site.xml found in the classpath. Usage of hadoop-site.xml is deprecated. Instead use core-site.xml, mapred-site.xml and hdfs-site.xml to override properties of core-default.xml, mapred-default.xml and hdfs-default.xml respectively

12/06/21 22:43:25 ERROR common.AbstractJob: Unexpected --seqFileDir while processing Job-Specific Options:
usage: <command> [Generic Options] [Job-Specific Options]
..... 
```

* * *

所以我猜clusterdump没有“seqFileDir”选项，但所有在线教程（例如[https://cwiki.apache.org/MAHOUT/cluster-dumper.html](https://cwiki.apache.org/MAHOUT/cluster-dumper.html)）都引用了这个选项。你能建议我补救办法还是我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T08:56:42.483

您是否尝试将其指定为`--input`选项？

# iphone - 页面控制导航符号？

> ID：11148183
> 
> 赞同：0
> 
> 时间：2012-06-21T23:17:59.503
> 
> 标签：iphone, ios, uinavigationcontroller, uipagecontrol

有人可以指出我如何让​​页面控制器显示这样的导航符号的正确方向吗？

![当前位置的页面控制](../Images/9367d5d3ab7acef340a2cda4d53ef3f1.png)

我无法很好地描述它，并且在互联网上找不到太多相关信息。任何事情都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:22:58.283

这很可能是一个自定义 UIPageController。

或者您可以在页面控件的左侧添加一个 UIImageView，当您尝试滑动时，将该图像视图设置为突出显示，您将获得相同的效果。

这是一个自定义页面控件，DDPageControl

[https://github.com/ddeville/DDPageControl](https://github.com/ddeville/DDPageControl)

# android - 带有图像的Android Out Of Memory错误

> ID：11148192
> 
> 赞同：1
> 
> 时间：2012-06-21T23:18:50.297
> 
> 标签：android, memory, bitmap

出于某种原因，我无法加载任何宽度或高度超过 200 像素的图像而不会出现 OOM 错误。为了解决这个问题，我降低了图像上的像素数量，但现在它们看起来都很模糊。有谁知道在不出现此错误的情况下加载更高质量图像的最佳方法。我也尝试过手动回收我的位图，但是这样做时，无论图像大小如何，它似乎只会给我内存不足错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T23:49:25.940

BitmapFactory.Options 类的 inSampleSize 可以解决您的问题，尝试查看官方的 android 文档[Loading Large Bitmaps Efficiently](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)，您将得到它的工作。

# c# - 如何从 DLL 本地调用此函数？

> ID：11148210
> 
> 赞同：0
> 
> 时间：2012-06-21T23:21:58.070
> 
> 标签：c#, visual-studio-2010, dllimport

我已经使用 DLL Export viewer 尝试查找此 DLL 中的函数，我找到了一个函数列表，它是：

```
public: int __thiscall CSTVdsDisk::GetPartitionCount(void); 
```

问题在 C# 中，我无法使用以下任何一种方法调用该函数：

```
[DllImport("Some.dll", 
           ExactSpelling = true,
           EntryPoint = "GetPartitionCount",
           CallingConvention = CallingConvention.StdCall,
           SetLastError = true)] 
```

或者：

```
[DllImport("Some.dll", 
           ExactSpelling = true,
           EntryPoint = "CSTVdsDisk::GetPartitionCount",
           CallingConvention = CallingConvention.StdCall,
           SetLastError = true)]
private static extern int GetPartitionSize(); 
```

他们都失败了。有什么我做错了吗？任何人都可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:47:13.787

您不能使用 P/Invoke 调用该函数。__thiscall[调用](http://msdn.microsoft.com/en-us/library/ek8tkfbw%28v=vs.100%29.aspx)引用意味着这个函数是一个类成员函数。它是`CSTVdsDisk`类的成员函数。

为了能够调用该函数，您必须创建`CSTVdsDisk`该类的一个实例并`GetPartitionCount`从该实例调用。

您必须在 C++ 或 C++/CLR 中执行此操作，因为您无法在 C# 中创建 C++ 类。另请参阅[在 c# 中创建非托管 c++ 对象](https://stackoverflow.com/questions/2636958/create-unmanaged-c-object-in-c-sharp)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T23:52:17.510

根据名称，这似乎是一个 C++ 类方法。这将使直接从 P/Invoke 调用该方法变得非常困难，原因有两个：

1.  你需要找到“真实”的名字；导出查看器显然显示了未修改的名称，但实际的 C++ 函数名称看起来更难看，类似`@0GetPartitionCount@CSTVdsDisk@@QPBAEXA`或类似。您可能需要使用较低级别的工具`dumpbin`来查找该名称。
2.  你需要伪造“thiscall”风格的调用；这意味着您需要将*C++ 类*的实例作为第一个参数传递。这只有在 C++ 类构造函数也从 DLL 中公开时才会起作用；在这种情况下，您可以调用类构造函数，将结果存储在 IntPtr 中，并将其传递给每个后续调用。（如果构造函数以 DLL 导出的形式公开，则其损坏的名称将以`??``??0CSTVdsDisk@@QAE@ABV0@@Z 开头

[这篇 CodeProject 文章](http://www.codeproject.com/Articles/14180/Using-Unmanaged-C-Libraries-DLLs-in-NET-Applicatio#Retrieve)向您展示了如何完成大部分工作，但它非常脆弱，所以预计会出现问题。我强烈建议你寻找一个做类似事情的非 C++ 库，或者至少一个设计为可从 C 代码中使用的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T23:32:26.477

在您的本机代码中，确保您正在导出该函数。默认情况下，您的函数不会列在 Exports 表中，因此您需要对其进行标记，以便编译器知道导出它。您还需要将该函数标记为 extern "C"，以便编译器不会破坏名称。

通常我定义以下宏：

```
#define DLLEXPORT extern "C" __declspec(dllexport) 
```

处理所有这些，然后简单地声明导出的函数，例如：

```
 DLLEXPORT __cdecl int Example(int x, int y) 
```

如果您发现名称仍然存在问题，请尝试在 dll 上使用免费的 PE 资源管理器程序并检查导出的函数表以获取正确的名称。

# hibernate - 如何在 Grails HQL 语句中排序

> ID：11148213
> 
> 赞同：1
> 
> 时间：2012-06-21T23:22:25.763
> 
> 标签：hibernate, grails, sql-order-by, hql

我有这样的关系：

```
class Foo {
    static hasMany = [bars: Bar, things: Thing]
}

class Bar {
    // Has nothing to tie it back to Foo or Thing
}

class Thing {
    // Has nothing to tie it back to Foo or Bar
} 
```

![在此处输入图像描述](../Images/038776e71b2d51dd72dec98c1dcab1fa.png)

我有以下带有以下参数的查询，其中大部分用于使用 flexigrid 进行分页。此查询获取与via`Thing`的特定实例相关联的所有实例。因此，如果我的is实例期望我的查询返回并且：`Bar``Foo``Bar``Bar1``Thing1``Thing2`

```
def obj = Bar.get( 1 ) // Get Bar1
def max = params.int( "max" ) ?: 100 // Default max returned results is 100 unless otherwise specified
def offset = params.int( "offset" ) ?: 0 // Default offset is 0 unless otherwise specified
def sortname = params.sortname ?: "id" // Default is id, but could be any member of Thing that is not a "hasMany"
def sortorder = params.sortorder ?: "ASC" // Default is ASC, but could be DESC

def namedParams = [ obj: obj, max: max, offset: offset ]

Thing.executeQuery( "SELECT DISTINCT f.things FROM Foo f INNER JOIN f.things things INNER JOIN f.bars bars WHERE bars =:obj ORDER BY ${sortname} ${sortorder}", namedParams ) 
```

Hibernate 不允许使用命名参数来指定`ORDER BY`子句，所以我只是插入了字符串。问题是结果没有按照我指定的顺序排列。使用`ORDER BY id`Grails 时告诉我`id`是模棱两可的。

**知道变量`sortname`将始终是 的成员`Thing`，我如何指定要排序的内容？**

我尝试过的一些事情：

```
ORDER BY Thing.id // Fail
ORDER BY f.things.id // Fail
ORDER BY things.id // FAIL! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T08:54:32.747

查询应该是：

```
SELECT DISTINCT thing FROM Foo f 
INNER JOIN f.things thing 
INNER JOIN f.bars bar 
WHERE bar = :obj 
ORDER BY thing.id 
```

即您应该在 select 子句中使用实体的别名而不是其路径，并在 order by 子句中使用相同的别名。

# javascript - toJSON 视图模型覆盖在 Knockout 取消映射后未反映

> ID：11148214
> 
> 赞同：0
> 
> 时间：2012-06-21T23:22:42.623
> 
> 标签：javascript, knockout.js, knockout-mapping-plugin

我有一个来自服务器的深层对象图，我用一个 Knockout 视图模型结构表示，它在每个级别省略了各种不必要的属性，但保留了基本层次结构。

我在两个方向都使用 Knockout 映射插件。在根以下的每个视图模型级别，当前视图模型的“构造器”接受其父视图模型作为参考，以及构建自身所需的原始数据部分。然后它会创建一组新的映射选项来创建自己的孩子。

我创建了一个非常简化的小提琴来说明这一点：

[http://jsfiddle.net/tqPtG/17/](http://jsfiddle.net/tqPtG/17/)

我在检索时需要从服务器获取大量的只读元数据，但是当我将图形作为 JSON 发布回时应该省略这些元数据。我一直在每个级别使用 toJSON 原型方法来剔除我不需要的东西，这在某个时候工作得很好，但现在已经停止工作。

在本地，似乎我的 toJSON 覆盖甚至没有触发（基于警报和控制台日志），但在这个小提琴中，它们确实触发了，但最终对象仍然包含已删除的属性“child”。我可以看到它已被 toJSON 方法删除，但在根取消映射后它仍然存在并显示在警报中。

所以，有两个问题 - 什么会导致我的 toJSON 覆盖不会在本地触发，我对简化小提琴中的取消映射逻辑的误解在哪里？

提前谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T02:10:09.027

这里发生了几件事：

*   您的`toJSON`函数被调用，但不是作为`ko.mapping.toJSON`调用的一部分。映射插件将字符串化作为确定对象键的一部分。
*   `ko.mapping.toJSON`创建对象的计划副本，此时它不再是`ParentViewModel`. 然后，当它对对象进行字符串化时，它将没有理由运行您的`toJSON`函数。

调用`ko.mapping.toJSON`确实支持选项的第二个参数。`{ ignore: ['child'] }`你可以像这样的参数传入：http: [//jsfiddle.net/rniemeyer/4kHC2/](http://jsfiddle.net/rniemeyer/4kHC2/)

# facebook-graph-api - Facebook PHP SDK抛出未经授权的源IP地址错误

> ID：11148220
> 
> 赞同：2
> 
> 时间：2012-06-21T23:23:44.727
> 
> 标签：facebook-graph-api, oauth, facebook-fql, facebook-php-sdk, facebook-oauth

我最近发现，当我们尝试通过 Graph API 发出 FQL 查询时，我们的一个生产服务器出现了致命错误。其他服务器上完全相同的代码可以完美运行。服务器位于具有单个 IP 地址的负载平衡器后面。

错误是：

```
 PHP Fatal error:  Uncaught OAuthException: (#5) Unauthorized source IP address
  thrown in /usr/local/home/faniq/php-lib/facebook/base_facebook.php on line 1039 
```

我已尝试将 IP 地址添加到我的 FB 应用程序的服务器白名单（空白）。当我尝试保存白名单时，它给了我这个错误：您的 IP 应该包含在服务器白名单中。

我什至尝试了一个IP地址范围，仍然拒绝保存。其他生产服务器和我们的开发环境都工作正常，所以我很茫然。任何想法为什么 Facebook 不会接受来自这台特定服务器的请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-08T15:17:38.573

除非您想限制来自特定服务器的 API 调用，否则您不需要在“高级设置”中输入 IP 地址。由于您的服务器位于负载均衡器后面，因此您应该为负载均衡器后面的每个服务器输入公共 IP，而不是负载均衡器 IP 地址。

服务器将直接从每个服务器调用 API，而不是通过负载均衡器。负载均衡器仅用于对您的服务器的传入请求，而不是像 API 调用那样传出。

# javascript - 从javascript中的搜索框获取价值

> ID：11148222
> 
> 赞同：1
> 
> 时间：2012-06-21T23:23:55.427
> 
> 标签：javascript, ruby

如何从 javascript 的搜索框中获取值？我想根据用户在搜索框中选择的内容将用户重定向到特定页面。例如，如果用户选择“纽约”然后点击是，他将被重定向到页面 /about/New York

这适用于静态页面，但由于某些原因，我无法从搜索框中获取值。在 Ruby 中，我会用 params[:query_name] 得到它

我正在使用 hidden_​​value 并标记“搜索”

```
var val = getElementsByTagName('search').value;
if (r) {
  location.href  = "/about/" + val";
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T04:48:38.983

您可能还需要指定此 == 文档并使用双引号，以防“搜索”是对对象的引用，以确保正确插入

```
 var val = document.getElementById("search").value; 
```

或使用 jQuery：

```
 var val = $("#search").val(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T23:25:58.907

你的意思是（因为我不认为有一个名为 html 的标签`search`）：

```
var val = getElementById('search').value;
if (r) {
  window.location.href  = "/about/" + val;
} 
```

所以上面的代码假设你的元素已经`id`设置为`id="search"`

* * *

顺便说一句，要使用 选择特定元素`getElementsByTagName`，您还需要指定，`index`因为它返回节点列表：

```
getElementsByTagName('tagName')[indexHERE].value 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T23:25:59.200

getElementsByTagName 根据标签名称返回一个包含许多对象的数组，例如 input、div、a 等。如果这是您的搜索栏的样子：

```
<input id="search" /> 
```

然后做：

```
getElementById('search').value; 
```

# javascript - TypeError：无法将未定义的属性“googleOAuth”设置为“”

> ID：11148224
> 
> 赞同：0
> 
> 时间：2012-06-21T23:24:14.800
> 
> 标签：javascript, oauth, google-apps-script

我看到有几篇关于“无法设置属性”的帖子，我仍在努力找出我在这里缺少的东西。我是 Javascript 和 GAS 的新手。我一直在写一本关于 GAS 的书，名为《GScript 企业应用程序要点》。这段代码来自这本书，我没有成功。它表示运行它两次，并且在某一时刻确实提示了授权，这只发生了一次，我在此之前和之后都看到过这个错误。任何人都可以建议一个资源或我可以咨询的东西来帮助解决它..或者更好地理解错误？谢谢！！

代码

```
/*
* Private for OAuth
* @ returns OAuth headers
*/
DOCS_LIST_API.googleOAuth = function() {
  var oAuthConfig = UrlFetchApp.addOAuthService("google");
oAuthConfig.setRequestTokenUrl("https://www.google.com/accounts/OAuthGetRequestToken? scope=https://docs.google.com/feeds/");
oAuthConfig.setAuthorizationUrl("https://www.google.com/accounts/OAuthAuthorizeToken");
oAuthConfig.setAccessTokenUrl("https://www.google.com/accounts/OAuthGetAccessToken");
oAuthConfig.setConsumerKey('anonymous');
oAuthConfig.setConsumerSecret('anonymous');
return {oAuthServiceName:'google', oAuthUseToken:"always"};
}

var DOCS_LIST_API = {};

/*
* @ args docID String the id for a Google Document
* @ args format String can be, "txt", "odt", "pdf", "html", "rtf", "doc", "png",
"zip"
* @ returns blob
*
*/
DOCS_LIST_API.GdocToFormat = function(docID, format){
var fetchArgs = DOCS_LIST_API.googleOAuth;
fetchArgs.headers = { "GData-Version": "3.0" };
fetchArgs.method = 'get';
var url = 'https://docs.google.com/feeds/download/documents/export/Export?id='+
   docID+'&exportFormat='+format+'&format='+format;
 return UrlFetchApp.fetch(url, fetchArgs);
 }

 // Run it twice
 function doOAuth(){
  try{
    DOCS_LIST_API.GdocToFormat();
     }catch(e){
   }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:40:11.743

`DOCS_LIST_API`您会收到错误消息，因为您在将其声明为变量之前尝试设置 的属性。

移动`var DOCS_LIST_API = {};`到顶部。

# ios - 弹出复杂导航路径到根的建议（路径包括多个嵌套的 UINavigationControllers 和模态覆盖）

> ID：11148227
> 
> 赞同：2
> 
> 时间：2012-06-21T23:24:31.487
> 
> 标签：ios, objective-c, uiviewcontroller, uinavigationcontroller

我正在开发一个应用程序，其中包括通过视图故事板的相对复杂的导航路径。场景是，我有一个带有多个控制器的 UINavigationController，每个控制器都可能呈现模态，这些模态本身具有 UINavigationCollers，它们有自己的一组控制器，可以呈现模态等等。我的问题是我需要一个基本上取消并一直弹出到根视图控制器的一般方法。

您会建议一种机械方法，通过混合使用 popToRootViewControllerAnimated 和 dismissViewControllerAnimated 调用来回溯视图控制器吗？或者，鉴于这条复杂的路径，是否有更简单的方法可以跳回我的根目录？

感觉这将是一个普遍的问题。我们欢迎所有的建议！

请注意，我已经看到了相关的问题 - 我已经知道如何在路径已知时执行必要的步骤来弹出控制器。我正在寻找的是一种以一般方式执行此操作的方法。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:29:56.533

如果您只是在您的主导航控制器子节点上调用 popToRootViewacontroller ，那么您应该只需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:50:44.480

您可以创建一个实现 UINavigationControllerDelegate 的类，并让所有 UINavigationController 将该类的单个实例设置为委托。然后，如果您知道要弹出的视图控制器，则可以使用

```
– (void)navigationController:(UINavigationController *)nc
      willShowViewController:(UIViewController *)vc
                    animated:(BOOL)animated; 
```

如果您还没有处于所需的视图控制器，请继续弹出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T18:43:16.287

我最终通过操作 UIWindow.rootViewController 属性解决了这个问题。这使我可以从任意视图控制器快速弹回根目录。来自文档：“如果窗口具有现有的视图层次结构，则在安装新视图之前删除旧视图。” 感谢回复的人。

```
- (void)popToRootViewControllerFromViewController:(UIViewController *)fromViewController
{
    UIStoryboard *mainStoryboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
    UIViewController *rootView = [mainStoryboard instantiateViewControllerWithIdentifier:@"RootViewController"];

    [fromViewController presentViewController:rootView animated:NO completion:^{
        self.window.rootViewController = rootView;
    }];
} 
```

# api - Twitter - 搜索很糟糕还是我做错了什么？

> ID：11148231
> 
> 赞同：0
> 
> 时间：2012-06-21T23:24:50.357
> 
> 标签：api, search, twitter

如何搜索我的一条旧推文，我知道它在推文文本中包含字符串：“API”？

我试图找到的推文是：

[https://twitter.com/stuartpowers/status/101507975751012352](https://twitter.com/stuartpowers/status/101507975751012352) [https://twitter.com/stuartpowers/status/115850250106834944](https://twitter.com/stuartpowers/status/115850250106834944)

通过各种搜索，例如[http://twitter.com/#!/search/realtime/API%20%20from%3Astuartpowers](http://twitter.com/#!/search/realtime/API%20%20from%3Astuartpowers)

值得庆幸的是，这对于 python 及其 API 来说非常简单：

```
stu@sente:~$ python
>>> from followers import *  #followers is a wrapper script I wrote on top of Tweepy
>>> api = authorize()
>>> pprint.pprint([(x.id_str,x.text) for x in list(tweepy.Cursor(api.user_timeline,'stuartpowers').items()) if 'API' in x.text])

[('115850250106834944',
  "I wish Google's gdata API was magically ported to using @kennethreitz 's #requests library."),
 ('101507975751012352',
  'http://t.co/FpCEVa7 looks damn nifty for anyone dealing with APIs: example:     http://t.co/G0Ror3z')] 
```

原来有两条包含“API”的推文，它们并不老，`2011-08-11 04:19:22`而且`2011-09-19 18:10:26`

我总共只有 242 条推文。

我希望非编码人员有办法找到他们的旧推文，不是这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T09:14:14.840

搜索 API 和 REST API 是两个独立的系统。搜索的历史和推文数量有限。REST 有更好的记录限制：您不能从一个用户那里获得超过 3200 条推文。

这两个 API 都不能信任历史数据 - 如果您要使用它，您需要定期收集它。

# c - Realloc 与 free 一起使用

> ID：11148232
> 
> 赞同：1
> 
> 时间：2012-06-21T23:24:54.360
> 
> 标签：c, dynamic-memory-allocation, realloc

我正在尝试使用 realloc 函数将输入字符存储在动态数组中。当我使用它而不调用 free 方法来释放使用后的内存时，一切都很好。但是当我将它与免费方法一起使用时，运行时错误就来了。这是我的代码片段。

```
int main(){  
char *message ;  
int len = 0 ;
char c ;  
while((c=getchar()) != '\n'){  
    message = realloc(message,(len+1)*sizeof(char)) ;  
    message[len++] = c ;  
}     
message = realloc(message, (len+1)* sizeof(char));  
message[len]='\0' ;  
printf("Message is %s\n",message);  
free(message) ;  
return 0 ;  
} 
```

任何人都可以弄清楚这一点。因为我需要同时使用这两种方法.. 谢谢！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:32:11.077

虽然它可能不会导致您看到的问题，但它`X = realloc(X, newsize);`是一颗等待爆炸的定时炸弹。`realloc`如果无法分配您要求的新块，则可以返回空指针并保持现有数据不变。当/如果这样做，这将用 NULL 覆盖现有指针，泄漏您之前分配的内存（并且无法分配更多内存）。

虽然它可能也不会导致问题，但我也（强烈）建议不要使用`realloc`一次增加一个字符的分配。这是非常低效的。我会从一个 32 或 64 个字符的块开始，每次空间不足时将分配增加某个因子（例如 1.5）。通过这种方式，您可以处理不同长度的输入，而无需大量调用 realloc。

编辑：看着它，真正的问题可能是您在初始调用之前没有正确初始化指针`realloc`。如果您传递的不是 NULL 指针，它期望您传递的内容是您从`malloc`/`calloc`或之前调用`realloc`.

```
int main(){  
char *message ;  
int len = 0 ;
char c ;  
while((c=getchar()) != '\n'){  
    message = realloc(message,(len+1)*sizeof(char)) ;  
    message[len++] = c ;  
}     
message = realloc(message, (len+1)* sizeof(char));  
message[len]='\0' ;  
printf("Message is %s\n",message);  
free(message) ;  
return 0 ;  
} 
```

至少对我来说，它运行时没有任何错误消息。

# javascript - 如何覆盖闭包内的函数？

> ID：11148233
> 
> 赞同：2
> 
> 时间：2012-06-21T23:24:57.273
> 
> 标签：javascript, jquery

鉴于：

```
(function() {
 function Foo() {
 }
 $.extend(Foo.prototype, {
  bar: 'hasBeer'
 });
}) 
```

是否可以从该闭包**外部**更改 bar 方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T23:33:15.810

如果您有权访问构造函数 ( `Foo`) 并且想要覆盖`bar`所有实例，则将新值分配给`Foo.prototype.bar`.

如果您有 的**实例**，`Foo`则只能覆盖`bar`该实例：

```
instance.bar = ...; 
```

或者对于所有实例，再次覆盖原型方法。为此，您必须首先获得原型，您可以使用[`Object.getPrototypeOf` *^([MDN])*](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/GetPrototypeOf)来完成：

```
Object.getPrototypeOf(instance).bar = ...; 
```

但请注意，这是一种 ES5 方法，不适用于 IE <= 8 或 Opera。

* * *

如果您既无权访问构造函数，也无权访问实例，则无法更改属性，只能修改源代码。

# cocoa - 如何捕捉窗户开始小型化的时刻？

> ID：11148236
> 
> 赞同：1
> 
> 时间：2012-06-21T23:25:13.977
> 
> 标签：cocoa, nswindow, nswindowcontroller

`NSWindowDelegate`协议有`windowDidDeminiaturize`回调，但没有`windowWillDeminiaturize`回调。在用户看到应用的更改之前，我需要捕捉窗口开始小型化并对其进行更改的时刻。

我无法进行更改，`windowDidMiniaturize`因为我需要显示另一个窗口；如果我在 中执行`windowDidMiniaturize`此操作，那么一旦第一个窗口小型化，就会出现另一个窗口。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:34:54.347

编辑：我在这里留下这个答案，但它完全不能可靠地工作，请参阅下面的评论。

您可以继承 NSWindow 并覆盖`deminiaturize:`.

```
@interface MyWindow : NSWindow
@end

@implementation MyWindow

- (void) deminiaturize:(id)sender
{
    NSLog( @"window about to deminiaturize!" );
    [super deminiaturize:sender];
}
@end 
```

可能您希望窗口委托在发生这种情况时采取一些行动，而不是窗口，因此您可以执行以下操作：

```
- (void) deminiaturize:(id)sender
{
    id<NSWindowDelegate> delegate = [self delegate];
    if( [delegate respondsToSelector:@selector(windowWillDeminiaturize)] ) {
        [delegate performSelector:@selector(windowWillDeminiaturize)];
    }

    [super deminiaturize:sender];
} 
```

# c# - 子字符串索引和长度必须引用字符串中的位置

> ID：11148238
> 
> 赞同：34
> 
> 时间：2012-06-21T23:25:16.343
> 
> 标签：c#, .net, string, exception, substring

我有一个看起来像的字符串

```
string url = "www.example.com/aaa/bbb.jpg"; 
```

“www.example.com/”的长度固定为 18。我想从这个字符串中获取“aaa/bbb”部分（实际的 url 不是示例也不是 aaa/bbb，长度可能会有所不同）

所以这就是我所做的：

```
string newString = url.Substring(18, url.Length - 4); 
```

然后我得到了例外：索引和长度必须引用字符串中的位置。我的代码有什么问题以及如何修复它？提前致谢。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-06-21T23:28:19.487

in 第二个参数[`Substring`](https://msdn.microsoft.com/en-us/library/aka44szs(v=vs.110).aspx)是子串的长度，不是结束索引。

您可能应该包括处理以检查它确实以您期望的方式开始，以您期望的方式结束，并且至少与您期望的一样长。然后，如果它不匹配，您可以执行其他操作或抛出一个有意义的错误。

下面是一些示例代码，用于验证 url 是否包含您的字符串，也对其进行了一些重构，以便更轻松地将前缀/后缀更改为剥离：

```
var prefix = "www.example.com/";
var suffix = ".jpg";
string url = "www.example.com/aaa/bbb.jpg";

if (url.StartsWith(prefix) && url.EndsWith(suffix) && url.Length >= (prefix.Length + suffix.Length))
{
    string newString = url.Substring(prefix.Length, url.Length - prefix.Length - suffix.Length);
    Console.WriteLine(newString);
}
else
    //handle invalid state 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-21T23:28:55.630

您的错误是 Substring 的参数。第一个参数应该是起始索引，第二个参数应该是起始索引的长度或偏移量。

```
string newString = url.Substring(18, 7); 
```

如果子字符串的长度可以变化，则需要计算长度。

`(url.Length - 18) - 4`（或`url.Length - 22`）方向的东西

最后它看起来像这样

```
string newString = url.Substring(18, url.Length - 22); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-21T23:51:06.547

像这样的东西怎么样：

```
string url = "http://www.example.com/aaa/bbb.jpg";
Uri uri = new Uri(url);
string path_Query = uri.PathAndQuery;
string extension =  Path.GetExtension(path_Query);

path_Query = path_Query.Replace(extension, string.Empty);// This will remove extension 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-21T23:39:00.247

您需要找到第一个的位置`/`，然后计算您想要的部分：

```
string url = "www.example.com/aaa/bbb.jpg";
int Idx = url.IndexOf("/");
string yourValue = url.Substring(Idx + 1, url.Length - Idx - 4); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-21T23:36:24.117

试试这个：

```
 int positionOfJPG=url.IndexOf(".jpg");
 string newString = url.Substring(18, url.Length - positionOfJPG); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-21T23:44:44.430

```
string newString = url.Substring(18, (url.LastIndexOf(".") - 18)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-21T23:47:52.710

这是另一个建议。如果您可以将 http:// 添加到您的 url 字符串，您可以这样做

```
 string path = "http://www.example.com/aaa/bbb.jpg";
  Uri uri = new Uri(path);            
  string expectedString = 
      uri.PathAndQuery.Remove(uri.PathAndQuery.LastIndexOf(".")); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-11T13:45:44.650

您需要像这样检查您的声明：

```
string url = "www.example.com/aaa/bbb.jpg";
string lenght = url.Lenght-4;
if(url.Lenght > 15)//eg 15
{
 string newString = url.Substring(18, lenght);
} 
```

# javascript - 我将如何模仿 CanvasRenderingContext2D 的 arc 方法？- Javascript

> ID：11148242
> 
> 赞同：0
> 
> 时间：2012-06-21T23:25:36.107
> 
> 标签：javascript, canvas, html5-canvas

我一直在尝试为 HTML5 的 canvas 元素模仿属于 CanvasRenderingContext2D 类的 arc 方法。我有一些工作，但我似乎无法围绕整个事情。

我做了一个[jsfiddle 测试环境](http://jsfiddle.net/sQpTC/2/)，让测试功能更快，所以请随意使用。

我正在尝试为我想要移植到[IvanK 库](http://lib.ivank.net/)的一些项目制作这个，它似乎不支持圆形笔划。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T02:08:31.367

可以使用[中点圆算法](http://en.wikipedia.org/wiki/Midpoint_circle_algorithm)逐像素画圆或圆段

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T07:51:09.633

所以我花了太多时间试图弄清楚这一点，我想我终于明白了。这是我最终想出的功能。

```
arcL = function( x, y, radius, startAngle, endAngle, anticlockwise )
{
    if ( anticlockwise )
    {
        var t = startAngle
        startAngle = endAngle
        endAngle = t
    }

    var d = Math.abs(endAngle - startAngle);
    if ( d >= Math.PI * 2 )
        endAngle = startAngle + Math.PI * 2;
    else
    {
        if ( endAngle < startAngle )
            endAngle += tau
        else
            endAngle = startAngle + d;
    }

    ctx.moveTo( x + radius * Math.cos( startAngle ), y + radius * Math.sin( startAngle) );
    for ( ; startAngle < endAngle; startAngle += 0.02 )
        ctx.lineTo( x + radius * Math.cos( startAngle ), y + radius * Math.sin( startAngle ) );
} 
```

[jsfiddle](http://jsfiddle.net/sQpTC/7/)

# php - php for 获取mysql数据的语句

> ID：11148250
> 
> 赞同：-3
> 
> 时间：2012-06-21T23:26:36.300
> 
> 标签：php, mysql

我将图像的名称和类型存储在我的数据库中。现在我想从该数据库中选择最新的图像并将它们显示给用户。我尝试使用以下代码，但我得到相同的图像名称和类型，但我想获得不同的图像。

```
$new_image_count = mysql_query("SELECT COUNT(id) FROM newest");
$result = mysql_result($new_image_count, 0);

    $select_images = mysql_query("SELECT * FROM newest");

        $fetch = mysql_fetch_assoc($select_images);
        for($result; $result > 0; $result--){

        $name = $fetch['image_name'];
        $type = $fetch['image_type'];
        $name_dot_type = $name.".".$type;
        echo '<img src="main_images/'.$name_dot_type.'" width="300">';
        } 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:29:21.097

删除查询以计算行数（您不需要它）

并将代码的主要部分更改为类似

```
$select_images = mysql_query("SELECT * FROM newest");
while ($fetch = mysql_fetch_assoc($select_images)) {
    // echo data from $fetch
} 
```

PS：你最近会收到关于使用 PDO 代替的评论`mysql_`

PPS：您会得到相同的结果，因为您只获取该行一次，然后在循环中输出相同的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:30:29.107

首先，你不应该再使用`mysql_*()`函数了，应该切换到 mysqli 或 PDO

其次，只需移动循环`$fetch = mysql_fetch_assoc($select_images);`内部：`for`

```
for($result; $result > 0; $result--){
    $fetch = mysql_fetch_assoc($select_images);
    $name = $fetch['image_name'];
    $type = $fetch['image_type'];
    $name_dot_type = $name.".".$type;
    echo '<img src="main_images/'.$name_dot_type.'" width="300">';
} 
```

# java - Java，Eclipse 不接受自定义异常

> ID：11148251
> 
> 赞同：0
> 
> 时间：2012-06-21T23:27:18.587
> 
> 标签：java

Eclipse 抱怨我`catch`在下面的陈述

```
public class NaturalLanguageMultiply
{
    public class WrongMultiplierException extends Exception
    {

    }

    private static int toInt( String number ) throws WrongMultiplierException 
    {
        // removed for clarity
                try
               {
                    String numberKey = scanner.next();
                    if ( numberMap.containsKey( numberKey ) )
                    {
                        multiplier += ( Integer ) numberMap.get( numberKey );
                    }
                    else
                    {
                        throw new WrongMultiplierException();
                    }
                } 
```

它抱怨以下捕获线：

```
Syntax error on tokens

                catch ( WrongMultiplierException );
                {

                }
            } 
```

另外，为什么 StackOverflow 一直在问：您的帖子没有太多上下文来解释代码部分；请更清楚地解释您的情况。我在常见问题解答或帮助中找不到答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T23:29:31.510

```
catch ( WrongMultiplierException );
{
} 
```

到

```
catch ( WrongMultiplierException wme)
{
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T23:29:23.457

你有一个 ; 在 catch 的右括号之后，这是一个语法错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T23:30:05.083

在这一行`catch ( WrongMultiplierException );`中，您必须添加异常引用名称并删除`;`。正确版本：`catch ( WrongMultiplierException ex)`

# asp.net-mvc - CQRS 读取模型中的访问规则

> ID：11148253
> 
> 赞同：3
> 
> 时间：2012-06-21T23:27:26.150
> 
> 标签：asp.net-mvc, entity-framework, cqrs

我正在使用 CQRS 模式的 ASP.NET MVC3 中开发一个应用程序。命令端是使用实体框架制作的，实体映射到 SQL Server 中的表。查询端建立在 SQL 视图之上（也使用 EF）。

我应该如何管理对数据的访问？例如有一个文档。文档可以用密码保护，任何知道它的人都可以访问，或者只能由给定的登录用户访问。

应该在哪里以及如何实现允许/拒绝访问的逻辑？DocumentViewModel 中应该包含哪些数据？它是否应该包含一个密码字段以将其与用户提供的密码进行比较，以便我可以检查访问并获取数据以在单个查询中显示？或者它应该只包含将在 UI 中显示的字段，因此一个单独的查询（或存储过程调用？）将负责检查访问？

如果访问规则比仅检查密码更复杂——可能包括所有白名单、黑名单、付款、转账限制、账户类型等，该怎么办？一般来说 - 事情很远

```
SELECT * FROM ReadModelTable WHERE id = @id 
```

这通常显示在“好”阅读场景的示例中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-27T06:44:16.943

[《Being the Worst》（播客）的第 28 集](http://beingtheworst.com/2013/episode-28-learning-lokad-cqrs)关于使用 CQRS 的系统的授权和身份验证有一些有趣的观点。在听取其他人的意见并提出理论系统架构之后，我经常将身份验证视为核心领域之外的一个问题。另一方面，授权可能包含核心域中的元素，但在许多系统中似乎也存在一些交叉问题。

在您的示例中，如果处理某种类型的文档聚合，其中每个都需要有一个单独的用户名和密码，那么您的建议将起作用，但听起来不像典型的实现。主要的失败点是凭证与文档一起存在，并且可能在用户之间共享，这是一个安全问题，并且使得将来撤销单个用户的访问权限成为问题。像一个秘密俱乐部一样思考，每个成员都需要知道秘密密码。如果密码永远不会更改，那么当有人被踢出俱乐部或不小心与意外的一方共享密码时，您就会遇到问题。

# javascript - 将 JSON 转换为数组

> ID：11148258
> 
> 赞同：2
> 
> 时间：2012-06-21T23:28:08.837
> 
> 标签：javascript, json

我有一个包含以下 JSON 字符串的变量：

```
{
    "0" : "Jun 20, 2012 03:02 PM",
    "1" : "Jun 20, 2012 03:26 PM",
    "2" : "Jun 21, 2012 01:12 PM",
    "3" : "Jun 21, 2012 01:25 PM",
    "4" : "Jun 21, 2012 02:42 PM",
    "5" : "Jun 21, 2012 02:43 PM",
    "6" : "NULL"
} 
```

我希望将此 JSON 转换为 javascript 中的数组，以便数组 [0] 具有“2012 年 6 月 20 日下午 3:02”数组 [1] 具有“2012 年 6 月 20 日下午 3:26”等等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T23:30:30.777

您必须先将 JSON 字符串解析为 javascript 对象。

**JavaScript**

```
var object = JSON.parse(JSONString); 
```

在不支持 JSON 的情况下填充浏览器：http: [//bestiejs.github.com/json3/](http://bestiejs.github.com/json3/)

* * *

然后，将该对象转换为数组：

**JavaScript**

```
var arr = [];
for(var i in object) {
    if(object.hasOwnProperty(i)) {
        arr.push(object[i]);
    }
} 
```

**jQuery**

```
var arr = $.map(obj,function(value){ return value; }); 
```

小提琴：http: [//jsfiddle.net/iambriansreed/MD3pF/](http://jsfiddle.net/iambriansreed/MD3pF/)

注意：由于原始海报没有提到 jQuery，因此值得一提的是，只为这些实例加载 jQuery 是不值得的，如果您还没有使用 jQuery，最好使用纯 JavaScript。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T23:35:04.260

或者，如果您的目标是 ES5 及更高版本：

```
// myObject = { '0': 'a', '1': 'b' };
var myArray = Object.keys(myObject).map(function(key) { return myObject[key]; });
// myArray = [ 'a', 'b' ]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T00:00:52.817

var currentVersion = {/literal} {$displayedVersion} {literal}; var jsonObj = eval('(' + {/literal}{$json}{literal} + ')');

# php - 使用 PHP 在 Windows 上更改文件创建日期

> ID：11148262
> 
> 赞同：9
> 
> 时间：2012-06-21T23:28:33.110
> 
> 标签：php, windows

在php中，我可以任意更改文件的*最后修改*和*访问时间*`touch()`

```
<?php
touch($filename,mktime(0,0,0,2010,1,10)); 
```

...但是如何更改**创建时间**？

*为什么我需要这个？*好吧，如果我将文件或目录 mtime 追溯至其创建日期*之前*`explorer.exe`，则会继续向我显示最近的创建日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:56:59.410

Mh，我发现的一种令人不满意但有效的方法是：使用[**nircmd**](http://www.nirsoft.net/utils/nircmd.html)。
Nircmd 是一个 37kb 的实用程序。（可再发行、**闭源**、免费软件）

如何进行：

```
<?php

$time=strftime('%d-%m-%Y %H:%M:%S',$time);
$cmd=".\\nircmdc.exe setfilefoldertime \"$filename\" \"$time\"";
system($cmd); 
```

笔记：

*   **nircmdc.exe**是 nircmd 的命令行版本（注意`c` 前面的附加`.exe`）
*   **setfilefoldertime**是一个 nircmd 子命令，[在此处记录](http://nircmd.nirsoft.net/setfilefoldertime.html)。

不过，我希望这次我找不到 COM 或 WMIC 解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-30T22:46:19.190

试试这个你可以更改文件创建时间和修改时间

> [Win32 控制台工具箱 1.1](http://www.stevemiller.net/apps/)

```
exec('touch.exe /c /t "file.html" '. date('H:i:s')); 
```

*nircmdc* -> 功能强大

# csh - 将文件复制到现有目录但说目录不退出

> ID：11148267
> 
> 赞同：0
> 
> 时间：2012-06-21T23:29:10.540
> 
> 标签：csh

我正在尝试将文件从我所在的一个目录复制到一个已经存在的目录，但终端给我一个错误，说它无法创建文件并且它不存在

```
cp networkset.dat /projects/segra/hallo/data/binet 
```

没有相应的文件和目录？这个目录存在，但为什么我不能将这个文件复制到我需要的目录中。我正在使用 c-shell 终端。我知道这是微不足道的，但我已经尝试了一切。我需要设置目录路径权限吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:44:34.223

目标路径看起来很可疑，好像它想离开您的主目录或当前目录，而不是从根目录。也就是说，也许它应该在开头有一个“~/”？

```
%if /projects is in your home dir
cp networkset.dat ~/projects/segra/hallo/data/binet 
```

或者

```
%if /projects is off of the current directory
cp networkset.dat ./projects/segra/hallo/data/binet 
```

# c++ - C++ 程序意外死机

> ID：11148268
> 
> 赞同：1
> 
> 时间：2012-06-21T23:29:17.443
> 
> 标签：c++, exception, ubuntu, exception-handling

我有一个 c++ 代码，由于某种原因，它似乎每天晚上大约从凌晨 2 点到早上 6 点都会死掉。我调查了日志文件，发现死亡不是由于数据库错误。也没有例外。我检查了系统日志，c++ 中没有任何内容。我正在使用 Ubuntu 服务器来运行 c++。我在这里添加我的代码，请帮我解决这个问题。

```
int main(int argc, char *argv[]) {
    try {
        int sockfd, portno, net_socket2, portno2;
        struct sockaddr_in serv_addr;
        struct sockaddr_in si_output2;
        struct hostent *server;
        int iof;

        int n, udp_size;

        unsigned char receivedMessage[256];
        unsigned char buffer[50];

        // register the signal (exception) handler
        signal(SIGINT, SIGINThandler);

        // Log on //////////////////////////////////////////////////////////////////////////////////////////////////////
        printf("Logging on\n");
        log("Logging on");
        portno = SERVER_PORT;
        sockfd = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
        if (sockfd < 0) {
            log("ERROR opening socket");
            error("ERROR opening socket");
        }
        printf("Socket opened \n");
        log("Socket opened");
        bzero((char *) &serv_addr, sizeof (serv_addr)); //clear the structure
        serv_addr.sin_family = AF_INET;
        if (inet_aton(SERVER_IP, &serv_addr.sin_addr) == 0) {
            printf("inet_aton() failed \n");
            log("inet_aton() failed ");
            return 0;
        }

        serv_addr.sin_port = htons(portno); //set the host port
        const struct sockaddr *to_cast = (struct sockaddr *) &serv_addr;
        printf("Connecting to %s %d on port %d \n", SERVER_IP, serv_addr.sin_addr.s_addr, portno);
        log("Connecting to port on the server");
        if (connect(sockfd, to_cast, sizeof (serv_addr)) < 0) {
            log("Error connecting");
            error("ERROR connecting\n");
        }

        if ((fcntl(sockfd, F_GETFL, 0)) != -1)
            fcntl(sockfd, F_SETFL, iof | O_NONBLOCK);
        //////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        // now open udp socket to receive messages from host /////////////////////////////////////////////////////////////
        int MESSAGE_PORT = 6001;
        if ((net_socket2 = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) == -1) {
            log("Message socket problem");
            perror("setsockopt");
            exit(1);
            printf("message socket problem \n");
            close(net_socket2);
            return 0;
        }
        memset((char*) &si_output2, sizeof (si_output2), 0);
        si_output2.sin_family = AF_INET;
        si_output2.sin_port = htons(MESSAGE_PORT);
        si_output2.sin_addr.s_addr = INADDR_ANY;

        //bind socket for incomming messages
        log("bind socket for incomming messages");
        if (bind(net_socket2, (struct sockaddr *) &si_output2, sizeof (struct sockaddr)) == -1) {
            log("Socket 2 bind failed");
            printf("socket 2 bind failed \n");
            close(net_socket2);
            return 0;
        }
        //set to non blocking
        if ((iof = fcntl(net_socket2, F_GETFL, 0)) != -1)
            fcntl(net_socket2, F_SETFL, iof | O_NONBLOCK);

        //In the above INADDR_ANY means the message could come from anywhere, you
        //would have to select a free port for MESSAGE_PORT
        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        // Send the logon message
        log("Send the logon message");
        unsigned char* logonMessage = msgLogon();
        //cout << "\nLogon Message Begin: ";
        displayByteArray(logonMessage, 38);
        //cout << "\nLogon Message End\n";
        n = write(sockfd, logonMessage, 38);
        if (n < 0) {
            log("ERROR writing to socket");
            error("ERROR writing to socket");
        }
        // Assume we are logged in now so start receiving messages ////////////////////////////////////////////////////////
        log("Assume we are logged in now so start receiving messages");
        while (true) {
            // Check for incomming message from etsl //
            bzero(receivedMessage, 256); //clear the received message
            n = read(sockfd, receivedMessage, 255);
            if (n > 0) {

                //cout << "\nReceived Message Begin: ";
                //displayByteArray(receivedMessage, n);
                //cout << "\nReceived Message End\n";

                MsgReply message = MsgReply(receivedMessage, n);

                messageHandler(message);

                if (message.getValue()) { //If we can get a reply message

                    unsigned char* replyMessage = message.getReplyMessage();

                    //int m = sizeof(replyMessage)/sizeof(replyMessage[0]);
                    int m = message.getReplyMessageLength();
                    //cout << "\nReply Message Length: m: " << m;
                    n = write(sockfd, replyMessage, m);
                    if (n < 0) {
                        log("ERROR writing to socket");
                        error("ERROR writing to socket");
                    }

                } else {
                    log("Did not reply to this message");
                    //cout << "\nDid not reply to this message\n";
                }
            }

            if (sendLogoff) {
                //cout << "\nreceived a control c";
                log("Send the logoff message");
                // Send the logon message
                unsigned char* logoffMessage = msgLogoff();
                //cout << "\nLogoff Message Begin: ";
                displayByteArray(logoffMessage, 38);
                //cout << "\nLogoff Message End\n";
                n = write(sockfd, logonMessage, 38);
                if (n < 0) {
                    log("ERROR writing to socket");
                    error("ERROR writing to socket");
                }
                sendLogoff = false;
            }           
        }

        log("Exit main block on success");
        return EXIT_SUCCESS;
    } catch (const std::exception& ex) {
        //cout<< ex.what();    
        log(ex.what());
    } catch (const std::string& ex) {
        //cout << ex;
        log(ex);
    } catch (...) {
        log("unknown exception");
    }
} 
```

这是消息处理程序代码

```
void messageHandler(MsgReply& message) {

string msgStr = byteArrayToHexString(message.getReceivedMessage(), 2 * message.getReceivedMessageLength());

int type = messageType(msgStr);

if ((type == 220) || (type == 221)) {

    string subMsg;
    string replyMsgStr;

    //message type
    replyMsgStr = "0230";

    //bit map
    subMsg = "323A00000A008000";
    replyMsgStr.append(subMsg);

    //processing code
    subMsg = msgStr.substr(24, 6);
    replyMsgStr.append(subMsg);

    //amount
    subMsg = msgStr.substr(30, 12);
    replyMsgStr.append(subMsg);

    //date/time
    subMsg = msgStr.substr(42, 10);
    replyMsgStr.append(subMsg);

    //trace number
    subMsg = msgStr.substr(52, 6);
    replyMsgStr.append(subMsg);

    //local time
    subMsg = msgStr.substr(58, 6);
    replyMsgStr.append(subMsg);

    //local date
    subMsg = msgStr.substr(64, 4);
    replyMsgStr.append(subMsg);

    //settelment date
    subMsg = msgStr.substr(72, 4);
    replyMsgStr.append(subMsg);

    //retrieval reference number
    subMsg = msgStr.substr(108, 24);
    replyMsgStr.append(subMsg);

    //responce code
    subMsg = msgStr.substr(144, 4);
    replyMsgStr.append(subMsg);

    //transaction currency code
    subMsg = "0554";
    replyMsgStr.append(subMsg);

    // Get message length
    int length = replyMsgStr.length();
    length = length / 2;
    string msgLength = intToHex(length);
    replyMsgStr = msgLength.append(replyMsgStr);

    message.setReplyMessage(replyMsgStr);

}

if (type == 100) {
    string subMsg;
    string replyMsgStr;

    string processing_code = msgStr.substr(24, 6); // The processing code
    string amount = msgStr.substr(30, 12); // The amount
    string transaction_number = msgStr.substr(52, 6); // The trace number
    string magnetic_number = msgStr.substr(106, 16); // The track2data
    string database = msgStr.substr(112, 2); // Which database we query
    string etsl_number = hexStringToAsciiString(msgStr.substr(130, 24), 12); // The retreival reference number
    string terminal_number = hexStringToAsciiString(msgStr.substr(170, 30), 15);
    ; // The card acceptor id code

    string return_string;
    string return_code;
    string return_value;

    string pinpadMessage;
    string terminalMessage;
    string receiptText1;
    string receiptText2;
    string tmLength;

    // Get response code
    bool rewardOnPurchase;
    stringstream ss;
    double numDouble;
    int numInt;
    ss << database;
    ss >> numInt;

    if (numInt == 10) {
        //cout << "\nProwze Database";

        replyMsgStr = "0110B23A4481AAE180000000000000000080";

        subMsg = msgStr.substr(24, 130);
        replyMsgStr = replyMsgStr.append(subMsg);

        // Get Processing Code and Reward Amount
        rewardOnPurchase = false;
        return_string = prowze_db(processing_code, amount, transaction_number, magnetic_number, etsl_number, terminal_number, rewardOnPurchase);
        //cout << "\nreturn_string: " << return_string << "\n\n";
        return_code = return_string.substr(0, 4);
        //return_code = "3035";
        return_value = return_string.substr(4, 8);
        // Convert return value to hex
        return_value = asciiStringToHexString(return_value, 8);

        //cout << "\nprocessing_code: " << processing_code;
        if (atoi(processing_code.c_str()) == 13000) {
            //cout << "\nReward Transaction";   

            if (atoi(return_code.c_str()) == 3030) {
                //cout << "\nAccepted Reward Transaction";

                //terminalMessage = "20202020414343455054454420202020";
                terminalMessage = terminalMessage.append("2052455741524420");
                terminalMessage = terminalMessage.append(return_value);
                terminalMessage = terminalMessage.append("20202020414343455054454420202020");
                terminalMessage = terminalMessage.append("594F55522052455741524420");
                terminalMessage = terminalMessage.append(return_value);
                terminalMessage = terminalMessage.append("50524F575A452052455741524453204341534821");
                string tmLength = "0072";
                terminalMessage = tmLength.append(terminalMessage);
            } else if (atoi(return_code.c_str()) == 3537) {
                //cout << "\nDeclined Reward Transaction: Card On Hold";

                terminalMessage = "202043415244204F4E20484F4C442020";
                terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
                terminalMessage = terminalMessage.append("2020202043415244204F4E20484F4C4420202020");
                terminalMessage = terminalMessage.append("50524F575A452052455741524453204341534821");
                tmLength = "0072";
                terminalMessage = tmLength.append(terminalMessage);
            } else {
                //cout << "\nDeclined Reward Transaction";

                terminalMessage = "202020204445434C494E454420202020";
                terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
                terminalMessage = terminalMessage.append("594F5552205245574152442024303030302E3030");
                terminalMessage = terminalMessage.append("50524F575A452052455741524453204341534821");
                tmLength = "0072";
                terminalMessage = tmLength.append(terminalMessage);
            }

        } else if (atoi(processing_code.c_str()) == 3000) {
            //cout << "\nPurchase Transaction";

            if (atoi(return_code.c_str()) == 3030) {
                //cout << "\nAccepted Purchase Transaction";

                // Perform Reward on Purchase
                rewardOnPurchase = true;
                return_string = prowze_db("013000", amount, transaction_number, magnetic_number, etsl_number, terminal_number, rewardOnPurchase);
                //cout << "\nreturn_string: ";
                //return_code = return_string.substr(0,4);
                return_value = return_string.substr(4, 8);
                // Convert return value to hex
                return_value = asciiStringToHexString(return_value, 8);

                terminalMessage = "41434345505420574954482053494720";
                terminalMessage = terminalMessage.append("41434345505420574954482053494720");
                terminalMessage = terminalMessage.append("2020414343455054205749544820534947202020");
                terminalMessage = terminalMessage.append("594F55522052455741524420");
                terminalMessage = terminalMessage.append(return_value);
                string tmLength = "0072";
                terminalMessage = tmLength.append(terminalMessage);
            } else if (atoi(return_code.c_str()) == 3537) {
                //cout << "\nDeclined Reward Transaction: Card On Hold";

                terminalMessage = "202043415244204F4E20484F4C442020";
                terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
                terminalMessage = terminalMessage.append("2020202043415244204F4E20484F4C4420202020");
                terminalMessage = terminalMessage.append("50524F575A452052455741524453204341534821");
                tmLength = "0072";
                terminalMessage = tmLength.append(terminalMessage);
            } else {
                //cout << "\nDeclined Purchase Transaction";

                terminalMessage = "202020204445434C494E454420202020";
                terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
                terminalMessage = terminalMessage.append("594F5552205245574152442024303030302E3030");
                terminalMessage = terminalMessage.append("50524F575A452052455741524453204341534821");
                tmLength = "0072";
                terminalMessage = tmLength.append(terminalMessage);

            }

        } else {
            //cout << "\nUnkown Transaction Type";

            // Return Code
            return_code = "3035";

            // Decline message
            terminalMessage = "202020204445434C494E454420202020";
            terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
            terminalMessage = terminalMessage.append("594F5552205245574152442024303030302E3030");
            terminalMessage = terminalMessage.append("50524F575A452052455741524453204341534821");
            tmLength = "0072";
            terminalMessage = tmLength.append(terminalMessage);
        }

        // Append Return Code
        replyMsgStr = replyMsgStr.append(return_code);

        //subMsg = msgStr.substr(154,166);
        //154 = 
        subMsg = msgStr.substr(154);
        replyMsgStr = replyMsgStr.append(subMsg);

        //Check to see if the message is a pre-auth
        //Not pre-auth bit map: 323A4481A8E18000
        //pre-auth bit map: 323A4481A8E18080
        //cout << "\nCheck bit 15 of bitmap to see if message is a pre-auth: " << msgStr.substr(22,1);
        if (!((msgStr.substr(22, 1)).compare("8"))) {
            //cout << ": Therefore pre-auth message";
            int aa = replyMsgStr.length();
            aa = aa - 10;
            replyMsgStr = replyMsgStr.substr(0, aa);
        } else //cout << ": Therefore non pre-auth message";

            // Append Terminal Message
            replyMsgStr = replyMsgStr.append(terminalMessage);

        // Get message length
        int length = replyMsgStr.length();
        length = length / 2;
        string msgLength = intToHex(length);
        replyMsgStr = msgLength.append(replyMsgStr);

        message.setReplyMessage(replyMsgStr);

    } else if (numInt == 20) {
        //cout << "\nBarter Database";

        replyMsgStr = "0110B23A4481AAE180000000000000000080";

        subMsg = msgStr.substr(24, 130);
        replyMsgStr = replyMsgStr.append(subMsg);

        // Get Return Code
        //cout << "\nprocessing_code: " << processing_code << "\n";
        if (atoi(processing_code.c_str()) == 3000) {
            return_code = barter_db(processing_code, amount, transaction_number, magnetic_number, etsl_number, terminal_number);
        } else {
            return_code = "3035";
        }
        //cout << "\nreturn_code: " << return_code;         

        if (atoi(processing_code.c_str()) == 3000) {
            //cout << "\nPurchase Transaction";

            if (atoi(return_code.c_str()) == 3030) {
                //cout << "\nAccepted Purchase Transaction";                    

                //terminalMessage = "20202020414343455054454420202020";     //ACCEPTED
                terminalMessage = "41434345505420574954482053494720"; //ACCEPT WITH SIG
                terminalMessage = terminalMessage.append("41434345505420574954482053494720"); //ACCEPT WITH SIG
                terminalMessage = terminalMessage.append("42415254455253504143452053484F5050494E47"); //BARTERSPACE SHOPPING
                terminalMessage = terminalMessage.append("2020202042415254455253504143452020202020"); //BARTERSPACE
                string tmLength = "0072";
                terminalMessage = tmLength.append(terminalMessage);
            } else if (atoi(return_code.c_str()) == 3537) {
                //cout << "\nDeclined Purchase Transaction: Card On Hold";

                terminalMessage = "202043415244204F4E20484F4C442020";
                terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
                terminalMessage = terminalMessage.append("42415254455253504143452053484F5050494E47");
                string tmLength = "0052";
                terminalMessage = tmLength.append(terminalMessage);
            } else {
                //cout << "\nDeclined Purchase Transaction";

                terminalMessage = "202020204445434C494E454420202020";
                terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
                terminalMessage = terminalMessage.append("42415254455253504143452053484F5050494E47");
                string tmLength = "0052";
                terminalMessage = tmLength.append(terminalMessage);

            }

        } else {
            //cout << "\nUnkown Transaction Type";

            // Return Code
            return_code = "3035";

            // Decline message
            terminalMessage = "202020204445434C494E454420202020";
            terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
            terminalMessage = terminalMessage.append("42415254455253504143452053484F5050494E47");
            string tmLength = "0052";
            terminalMessage = tmLength.append(terminalMessage);
        }

        // Append Return Code
        replyMsgStr = replyMsgStr.append(return_code);

        //subMsg = msgStr.substr(154,166);
        subMsg = msgStr.substr(154);
        replyMsgStr = replyMsgStr.append(subMsg);

        //Check to see if the message is a pre-auth
        //Not pre-auth bit map: 323A4481A8E18000
        //pre-auth bit map: 323A4481A8E18080
        //cout << "\nCheck bit 15 of bitmap to see if message is a pre-auth: " << msgStr.substr(22,1);
        if (!((msgStr.substr(22, 1)).compare("8"))) {
            //cout << ": Therefore pre-auth message";
            int aa = replyMsgStr.length();
            aa = aa - 10;
            replyMsgStr = replyMsgStr.substr(0, aa);
        } else //cout << ": Therefore non pre-auth message";

            // Append Terminal Message
            replyMsgStr = replyMsgStr.append(terminalMessage);

        // Get message length
        int length = replyMsgStr.length();
        length = length / 2;
        string msgLength = intToHex(length);
        replyMsgStr = msgLength.append(replyMsgStr);

        message.setReplyMessage(replyMsgStr);

    } else {
        //cout << "\nCould Not Find Database";

        //Message type and bit map
        replyMsgStr = "0110323A4481AAE18000";

        subMsg = msgStr.substr(24, 130);
        replyMsgStr = replyMsgStr.append(subMsg);

        // Return Code
        //subMsg = barter_db(processing_code, amount, transaction_number, magnetic_number, etsl_number, terminal_number);
        return_code = "3035";
        replyMsgStr = replyMsgStr.append(return_code);

        subMsg = msgStr.substr(154);
        replyMsgStr = replyMsgStr.append(subMsg);

        // Get message length
        int length = replyMsgStr.length();
        length = length / 2;
        string msgLength = intToHex(length);
        replyMsgStr = msgLength.append(replyMsgStr);

        message.setReplyMessage(replyMsgStr);
    }

    // Put in additional user information
    //replyMsgStr = replyMsgStr.append(terminalMessage);

    // Accept message reward
    /*      string terminalMessage = "20202020414343455054454420202020";
                    terminalMessage = terminalMessage.append("20202020414343455054454420202020");
                    terminalMessage = terminalMessage.append("594F5552205245574152442024303030302E3030");
                    terminalMessage = terminalMessage.append("50524F575A452052455741524453204341534821");
                    string tmLength = "0072";
                    terminalMessage = tmLength.append(terminalMessage);
                    replyMsgStr = replyMsgStr.append(terminalMessage);
     */
    // Decline message reward
    /*      terminalMessage = "202020204445434C494E454420202020";
                    terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
                    terminalMessage = terminalMessage.append("594F5552205245574152442024303030302E3030");
                    terminalMessage = terminalMessage.append("50524F575A452052455741524453204341534821");
                    tmLength = "0072";
                    terminalMessage = tmLength.append(terminalMessage);
                    replyMsgStr = replyMsgStr.append(terminalMessage);
     */
    // Accept message purchase
    /*      string terminalMessage = "20202020414343455054454420202020";
                    terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
                    terminalMessage = terminalMessage.append("594F5552205245574152442024303030302E3030");
                    terminalMessage = terminalMessage.append("50524F575A452052455741524453204341534821");
                    string tmLength = "0072";
                    terminalMessage = tmLength.append(terminalMessage);
                    replyMsgStr = replyMsgStr.append(terminalMessage);
     */
    // Decline message purchase
    /*      string terminalMessage = "202020204445434C494E454420202020";
                    terminalMessage = terminalMessage.append("202020204445434C494E454420202020");
                    terminalMessage = terminalMessage.append("594F5552205245574152442024393030302E3030");
                    terminalMessage = terminalMessage.append("50524F575A452052455741524453204341534821");
                    string tmLength = "0072";
                    terminalMessage = tmLength.append(terminalMessage);
                    replyMsgStr = replyMsgStr.append(terminalMessage);
     */

} else if (type == 800) {
    string subMsg;

    string replyMsgStr = "001E08108220000002000000";

    subMsg = "0400000000000000";
    replyMsgStr = replyMsgStr.append(subMsg);

    subMsg = msgStr.substr(40, 16);
    replyMsgStr = replyMsgStr.append(subMsg);

    replyMsgStr = replyMsgStr.append("3030");

    subMsg = msgStr.substr(56, 4);
    replyMsgStr = replyMsgStr.append(subMsg);

    message.setReplyMessage(replyMsgStr);
} else if ((type == 420) || (type == 421)) {
    string subMsg;
    string replyMsgStr = "";

    string processing_code = msgStr.substr(40, 6); // The processing code
    string amount = msgStr.substr(46, 12); // The amount
    string transaction_number = msgStr.substr(68, 6); // The trace number
    string magnetic_number = msgStr.substr(122, 16); // The track2data
    string database = msgStr.substr(128, 2); // Which database we query
    string etsl_number = hexStringToAsciiString(msgStr.substr(146, 24), 12); // The retreival reference number

    subMsg = "0430B23A00000A0080000000004000000000";
    replyMsgStr = replyMsgStr.append(subMsg);

    subMsg = msgStr.substr(40, 48);
    replyMsgStr = replyMsgStr.append(subMsg);

    subMsg = msgStr.substr(146, 24);
    ;
    replyMsgStr = replyMsgStr.append(subMsg);

    if (atoi(database.c_str()) == 10) {
        //cout << "\nChecking prowze database for reversal\n";
        subMsg = prowze_db_rev(processing_code, amount, transaction_number, magnetic_number, etsl_number);
        //cout << "\nreturnCode: " << subMsg << "\n";
    } else if (atoi(database.c_str()) == 20) {
        //cout << "\nChecking barter database for reversal\n";
        subMsg = barter_db_rev(processing_code, amount, transaction_number, magnetic_number, etsl_number);
        //cout << "\nreturnCode: " << subMsg << "\n";
    } else {
        subMsg = "3030";
    }
    replyMsgStr = replyMsgStr.append(subMsg);

    //subMsg = msgStr.substr(270,4);
    //replyMsgStr = replyMsgStr.append(subMsg);

    //subMsg = msgStr.substr(318,42);
    //replyMsgStr = replyMsgStr.append(subMsg);

    subMsg = msgStr.substr(316, 46); //changed from 336 to 316 due to the reversal issue,,,,not it should be fixed. 
    replyMsgStr = replyMsgStr.append(subMsg);

    // Get message length
    int length = replyMsgStr.length();
    length = length / 2;
    string msgLength = intToHex(length);
    replyMsgStr = msgLength.append(replyMsgStr);

    message.setReplyMessage(replyMsgStr);
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:39:11.650

在`if (sendLogoff)`代码中，您似乎创建了一个`logoffMessage`，但发送`logonMessage`。此外，如果消息是动态分配的，我看不到您试图在任何地方释放它。

我对`replyMessage`.

我不知道做什么`messageHandler`。

如果您写入不再连接到其对等方的套接字，程序将收到`SIGPIPE`. 如果您不实现信号处理程序来处理它，您的程序将终止。如果您要使用`send`而不是`write`，则可以传入`MSG_NOSIGNAL`标志来抑制`SIGPIPE`，并改为`send`返回`EPIPE`错误消息。

由于您将套接字设置为非阻塞，因此您应该注意 Loki Astari 关于短读取和写入的警告，以及他对处理它们的建议。

Since the command is launched from a `cron` job, I would recommend seeing if it e-mailed you with output from the program. If e-mail of output is disabled on your system, modify your `cron` job entry to redirect the output to a log file that you can examine. With bash, you can do this with `&>` redirection. E.g.,

```
$ command &> /tmp/command.log 
```

# ruby - 使 Ruby 字符串不可变

> ID：11148276
> 
> 赞同：4
> 
> 时间：2012-06-21T23:30:18.220
> 
> 标签：ruby, string

需要使我的程序中的某些 Ruby 字符串不可变。什么是最好的解决方案？在类上写一个包装器`String`？

该`freeze`方法对我不起作用。我看到这`freeze`不会让你解冻对象。

以下是我的情况：我有一个将字符串传递给回调的类。该字符串恰好是该类的一个实例变量，并且可能很大。我不希望回调修改它，但仍然允许类随意修改它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T23:57:03.430

> 以下是我的情况：我有一个将字符串传递给回调的类。

将字符串的副本传递给回调工作吗？

> 该字符串恰好是该类的一个实例变量，并且可能很大。我不希望回调修改它，但仍然允许类随意修改它。

如果您担心字符串的大小，那么使用 String#dup 会有所帮助。它将创建一个具有 distinct 的新对象，`object_id`但不会复制字符串的内容，除非新字符串（或原始字符串）被修改。这称为“写入时复制”，并在[Seeing double: how Ruby share string values](http://patshaughnessy.net/2012/1/18/seeing-double-how-ruby-shares-string-values)中进行了描述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T23:32:38.223

调用`#freeze`字符串。请参阅：[http ://ruby-doc.org/core-1.9.3/Object.html#method-i-freeze](http://ruby-doc.org/core-1.9.3/Object.html#method-i-freeze)

# c# - 在 C# 中，是否可以使用“尽可能多的参数”调用方法（具有默认参数）？

> ID：11148283
> 
> 赞同：5
> 
> 时间：2012-06-21T23:30:37.830
> 
> 标签：c#, .net, c#-4.0

也就是说，我有一个方法如下：

```
public static int CreateTaskGroup(string TaskGroupName, 
    string Market = "en-us", string Project = "MyProject", 
    string Team = "DefaultTeam", string SatelliteID="abc"); 
```

我想通过读取命令行参数的标准数组从命令行调用此方法。显而易见的方法如下：

```
 if (args.Length == 1) CreateTaskGroup(args[0]);
 if (args.Length == 2) CreateTaskGroup(args[0], args[1]);
 if (args.Length == 3) CreateTaskGroup(args[0], args[1], args[2]); 
```

是否有可能以更简洁的方式做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T23:40:05.783

这是一种替代方法，缺点是您必须重新声明默认值常量：

```
CreateTaskGroup(
    args[0],
    args.ElementAtOrDefault(1) ?? "en-us",
    args.ElementAtOrDefault(2) ?? "MyProject",
    args.ElementAtOrDefault(3) ?? "DefaultTeam",
    args.ElementAtOrDefault(4) ?? "abc"); 
```

您可以通过将字符串声明为 s 来减少此问题`const`，例如：

```
public const string MarketDefault = "en-us";
public static int CreateTaskGroup(string TaskGroupName,
    string Market = MarketDefault, ...)

static void Main(string[] args)
{
    CreateTaskGroup(
        args[0],
        args.ElementAtOrDefault(1) ?? MarketDefault,
        ...);
} 
```

但是编译器并不能保证，也不是很明显，也就是说`MarketDefault`，实际上仍然（将来可以重构代码）默认为`Market`.

编辑：这是使用反射的替代解决方案：

```
var argsForMethod = new List<string>(args);
var m = typeof(Program).GetMethod("CreateTaskGroup");
foreach (var p in m.GetParameters().Skip(args.Length))
    if (p.Attributes.HasFlag(ParameterAttributes.HasDefault))
        argsForMethod.Add((string)p.DefaultValue);
    else
        throw new NotImplementedException();
var result = (int)m.Invoke(null, argsForMethod.ToArray()); 
```

这可能有点难以阅读，并且不会太快，但是它可以满足您的要求，而无需使用重复的代码，也不会对参数的默认值有任何不确定性。您可能希望为太少或太多的参数添加一些错误处理。我更喜欢这个解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T23:40:48.047

在 CreateTaskGroup 中使用类似这样的参数怎么样

```
 public static int CreateTaskGroup(params string[] args) 
 {
    for ( int i = 0 ; i < args.Length ; i++ )
    {
      ............ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T23:50:34.583

这就是我将如何实现该类以保持事物清洁并将了解默认值的责任分配给 TaskGroupCreator。

```
public class TaskGroupCreator
{
    private string[] values;

    public TaskGroupCreator(string[] values)
    {
        this.values = values;
    }

    public string TaskGroupName
    {
        get { return values[0]; }
    }

    public string Market
    {
        get { return this.GetElement(1, "en-us"); }
    }

    public string Project 
    {
        get { return this.GetElement(2, "MyProject"); }
    }

    public string Team 
    {
        get { return this.GetElement(3, "DefaultTeam"); }
    }

    public string SatelliteID 
    {
        get { return this.GetElement(4, "abc"); }
    }

    public int CreateTaskGroup()
    {
        // Do stuff with your properties...
    }

    private string GetElement(int index, string defaultValue)
    {
        return this.values.ElementAtOrDefault(index) ?? defaultValue;
    }
} 
```

用法：

```
var taskGroup = new TaskGroupCreator(args).CreateTaskGroup(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T23:42:20.073

这可能是我想出的最好的：

```
public static int CreateTaskGroup(string[] arguments)
{
    // optional error handling here

    string TaskGroupName = arguments[0];
    string Market        = arguments.ElementAtOrDefault(1) ?? "en-us";
    string Project       = arguments.ElementAtOrDefault(2) ?? "MyProject";
    string Team          = arguments.ElementAtOrDefault(3) ?? "DefaultTeam";
    string SatelliteID   = arguments.ElementAtOrDefault(4) ?? "abc";

    // function body as it was 
```

这做同样的事情，但不太简洁：

```
public static int CreateTaskGroup(string[] arguments)
{
    string TaskGroupName, Market, Project, Team, SatelliteID;
    switch (arguments.Length)
    {
    case 5:
        string SatelliteID   = arguments[4] ?? "abc";
        goto case 4;
    case 4:
        string Team          = arguments[3] ?? "DefaultTeam";
        goto case 3;
    case 3:
        string Project       = arguments[2] ?? "MyProject";
        goto case 2;
    case 2:
        string Market        = arguments[1] ?? "en-us";
        goto case 1;
    case 1:
        string TaskGroupName = arguments[0];
        break;
    case 0:
        // error handling here;
    }

    // function body as it was 
```

你可以这样简洁地称呼它：

```
CreateTaskGroup(args); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T23:55:19.737

我会这样。。

```
CreateTaskGroup(args);

//.....

public static int CreateTaskGroup(params string[] args) {
    if (args.Length == 0) throw new Exception("nope!");
    args = args.Concat(Enumerable.Range(0, 5 - args.Length)
        .Select<int, string>(_ => null)).ToArray();
    string TaskGroupName = args[0];
    string Market = args[1] ?? "en-us";
    string Project = args[2] ?? "MyProject";
    string Team = args[3] ?? "DefaultTeam";
    string SatelliteID = args[4] ?? "abc";
    //......
} 
```

`params`关键字不是强制性的，但可能很方便......

# performance - iTextSharp PDFWriter 瓶颈

> ID：11148284
> 
> 赞同：4
> 
> 时间：2012-06-21T23:30:39.043
> 
> 标签：performance, pdf, itextsharp

因此，我将 10000 个 2 页 pdf 文件与 iTextSharp 合并为一个。

这是我正在做的一些松散的代码：

```
Document document = new Document();
using(PdfWriter writer = PdfWriter.GetInstance(document, new FileStream("merged.pdf", FileMode.Create)))
{  

    PdfContentByte cb = writer.DirectContent;
    PdfReader reader = null;
    foreach(string thisFile in files)
    {
       reader = new PdfReader(thisFile);
       var page1 = writer.GetImportedPage(reader, 1);
       var page2 = writer.GetImportedPage(reader, 2);
       cb.AddTemplate(page1, 1f, 0, 0, 1f, 0, 0);
       cb.AddTemplate(page2, 1f, 0, 0, 1f, 0, 0);
    }
} 
```

我试图了解瓶颈可能在两个地方。我进行了一些性能测试，最慢的进程自然是使用 PdfReader 读取每个文件以及保存文件的处置，它从 using PdfWriter 块中调用。

在这个过程中，我在所有 16 个内核上获得了大约 25% 的利用率。我尝试了固态驱动器而不是我的 SATA 7.2k rpm 驱动器，它的速度几乎完全相同。

我怎样才能加快这个过程？没有分配任务，因为计算机之间的读取速度会更慢。即使这意味着更改为另一种语言、库或编写这个较低级别的代码，我也需要比现在更快地完成这个过程。现在合并大约需要 10 分钟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T15:02:59.647

所以我终于解决了这个问题。以下是我使用以下获胜方法的代码的性能结果：我在所有三个测试中都使用了同一台机器

*   iTextSharp - 直接在 pdfwriter 上的内容生成器
    *   视窗 2008 64 位
    *   NTFS 分区
    *   在处理过程中每秒合并大约 30 页
    *   关闭 pdfwriter 时最后的显着开销
    *   **总共 25 页/秒**
*   iTextSharp - PDF复制
    *   视窗 2008 64 位
    *   NTFS 分区
    *   将输出写入磁盘而不是内存，因此最后没有开销
    *   **每秒 40 页**
*   iText (java) - PDFCopy（完全相同的代码，只是移植到 java）
    *   Ubuntu 12.04 64位服务器版
    *   EXT3 分区（即将尝试 ext4）
    *   在处理期间还将输出写入磁盘
    *   **每秒 250 页**

还没有试图弄清楚为什么相同的代码在 Ubuntu 上的 java 中运行得更快，但我会接受它。一般来说，我在这个函数之外定义了所有主要变量，因为在这个过程中它被调用了 36000 次。

```
public void addPage(String inputPdf, String barcodeText, String pageTitle)
{
    try
    {
        //read in the pdf
        reader = new PdfReader(inputPdf);

        //all pdfs must have 2 pages (front and back). 
        //set to throw an out of bounds error if not. caught up stream
        for (int i = 1; i <= Math.Min(reader.NumberOfPages,2); i++)
        {
            //import the page from source pdf
            copiedPage = copyPdf.GetImportedPage(reader, i);

            // add the page to the new document
            copyPdf.AddPage(copiedPage);
        }

        //cleanup this page, keeps a big memory leak away
        copyPdf.FreeReader(reader);
        copyPdf.Flush();

    }
    finally
    {
        reader.Close();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:31:29.477

试试 PdfSmartCopy。不确定它是否更快。

```
Document document = new Document();
using(PdfWriter writer = new PdfSmartCopy(document, new FileStream("merged.pdf", FileMode.Create)))
{  
    document.Open();
    PdfReader reader = null;
    foreach(string thisFile in files)
    {
       reader = new PdfReader(thisFile);
       ((PdfSmartCopy)writer).AddPage(writer.GetImportedPage(reader , 1));
       ((PdfSmartCopy)writer).AddPage(writer.GetImportedPage(reader , 2));
    }

    if(reader != null)
    {
       reader.Close();
    }
}
document.Close(); 
```

# python - 使用 flash 渲染 QWebView

> ID：11148287
> 
> 赞同：0
> 
> 时间：2012-06-21T23:30:54.473
> 
> 标签：python, pyqt, pyqt4, xvfb

我正在尝试获取包含 Flash 对象的网页的屏幕截图。我要渲染的页面是[http://www.swellinfo.com/surf-forecast/san-jose-guatemala.html](http://www.swellinfo.com/surf-forecast/san-jose-guatemala.html)，特别是膨胀闪光对象。我正在使用 Ghost.py 框架在 Xvfb 的 QWebView 中加载页面。有想法该怎么解决这个吗？

![Flash 渲染](../Images/5724bcfc19267ed8400eb0d635221710.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T20:34:34.083

许多屏幕截图都存在硬件加速窗口的问题，因此请尝试在捕获时[禁用硬件加速。](http://forums.adobe.com/thread/891337)

# c# - 远程服务器返回错误：(407) 需要代理身份验证

> ID：11148288
> 
> 赞同：4
> 
> 时间：2012-06-21T23:30:55.103
> 
> 标签：c#, httpwebrequest

我参考了几个网站，它们回答了这个问题“远程服务器返回错误：（407）需要代理身份验证。” ，但没有任何帮助。我写了一个示例代码来检查办公室的代理身份验证。代码抛出异常。

我的要求：-验证网站返回的内容。在办公室外，代码运行良好，但在办公室内，由于代理而引发异常。当我使用新的 NetworkCredential 对凭据进行硬编码时，它工作正常。

```
int ResponseCode;
string url = "http://www.msftncsi.com/ncsi.txt";
WebRequest request = WebRequest.Create(url);

request.Credentials = CredentialCache.DefaultCredentials;
using (WebResponse response = request.GetResponse())
 {

   Stream dataStream = response.GetResponseStream();
   StreamReader reader = new StreamReader(dataStream);
   responseFromServer = reader.ReadToEnd();
   ResponseCode = (int)((HttpWebResponse)response).StatusCode;
   reader.Close();
} 
```

我不想硬编码。[我在http://social.msdn.microsoft.com/Forums/is/csharpgeneral/thread/c06d3032-dceb-4a1a-bb6a-778fd13a938a](http://social.msdn.microsoft.com/Forums/is/csharpgeneral/thread/c06d3032-dceb-4a1a-bb6a-778fd13a938a)中提到了解决方案，但即使这样也没有帮助。我错过了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T07:28:51.070

我有同样的问题，这对我有用

request.Proxy.Credentials = CredentialCache.DefaultCredentials;

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T23:41:34.307

这里有很多东西。您可以尝试明确设置凭据

```
request.Credentials = new NetworkCredentials(username, password) 
```

您可能需要指定代理。默认情况下，它使用您的 IE 代理。你可能不想要那个

```
WebRequest webRequest = WebRequest.Create("http://stackoverflow.com/");
webRequest.Proxy = new WebProxy("http://proxyserver:80/",true); 
```

# r - 提示用户在 R 中输入多个输入文件

> ID：11148289
> 
> 赞同：1
> 
> 时间：2012-06-21T23:30:57.243
> 
> 标签：r, import, rbind

我正在尝试做一些我认为应该足够直截了当的事情，但到目前为止我一直无法弄清楚（毫不奇怪，我是一个菜鸟）......

我希望能够在 R 中提示用户输入文件。我已经成功地用于`file.choose()`获取单个文件，但我希望可以选择一次选择多个文件。

我正在尝试编写一个程序来吸收每日数据文件，具有相同的标题并将它们附加到一个大的月度文件中。我可以在控制台中单独导入文件，然后使用，`rbind(file1, file2,...)`但我需要一个脚本来自动化这个过程。要附加的文件数量在运行之间不一定是恒定的。

谢谢

更新：这是我提出的适用于我的代码，也许它对其他人也有帮助

```
library (tcltk)
File.names <- tk_choose.files()   #Prompts user for files to be combined
Num.Files <-NROW(File.names)      # Gets number of files selected by user

# Create one large file by combining all files
Combined.file <- read.delim(File.names [1], header=TRUE, skip=2) #read in first file of list selected by user
for(i in 2:Num.Files){
                      temp <- read.delim(File.names [i], header=TRUE, skip=2) #temporary file reads in next file
                      Combined.file <-rbind(Combined.file, temp)              #appends Combined file with the last file read in
                      i<-i+1
}
output.dir <- dirname(File.names [1])  #Finds directory of the files that were selected

setwd(output.dir)                      #Changes directory so output file is in same             directory as input files
output <-readline(prompt = "Output Filename: ")       #Prompts user for output file name
outfile.name <- paste(output, ".txt", sep="", collapse=NULL)
write.table(Combined.file, file= outfile.name, sep= "\t", col.names = TRUE, row.names=FALSE)` #write tab delimited text file in same dir that original files are in 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:41:49.307

你有没有尝试过`?choose.files`

```
Use a Windows file dialog to choose a list of zero or more files interactively. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:01:22.413

如果您愿意键入每个文件名，为什么不像这样遍历所有文件：

```
filenames <- c("file1", "file2", "file3")
filecontents <- lapply(filenames, function(fname) {<insert code for reading file here>})
bigfile <- do.call(rbind, filecontents) 
```

如果您的代码必须是交互式的，您可以`readline`在循环中使用该函数，该函数将在用户输入空行时停止请求更多文件：

```
getFilenames <- function() {
    filenames <- list()
    x <- readline("Filename: ")
    while (x != "") {
        filenames <- append(filenames, x)
        x <- readline("Filename: ")
    }
    filenames
} 
```

# ruby - ruby 中的排序程序

> ID：11148292
> 
> 赞同：-8
> 
> 时间：2012-06-21T23:31:02.360
> 
> 标签：ruby, arrays, sorting

基本上我试图在不使用*.sort*的情况下在 ruby​​ 中创建一个 BASIC 排序程序。到目前为止，这是我的代码：

```
def optsort
@@a = 0
@@aa= 1
@@b = unsorted.size
@@smallestnum
@@ssmallestnum

while b !=1
if unsorted[a] <= unsorted[b] then
@@smallestnum = unsorted[b]
else @@smallestnu = unsorted[a]
end

@@a = @@a + 
@@aa = @@a + 1
b = b - 1
end 
```

请帮我写代码。另外：我在运行它时收到这些错误消息：

```
(eval):465: (eval):465: compile error (SyntaxError)
(eval):465: syntax error, unexpected $end, expecting kEND 
```

该代码应该从最小到最大对数字进行排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:56:52.780

```
if unsorted[0] <<== unsorted[1] then numsmall = unsorted[a] 
               ^
(eval):51: syntax error, unexpected kTHEN, expecting kEND 
```

这一点`^`指向这里的第一个问题。 `<<==`不是 ruby​​ 中的合法运算符，因此出现语法错误。也许您的意思是“小于或等于” `<=`？

```
if unsorted[a] <= unsorted[b] 
```

此外，缩进将帮助您更好地理解流程，尝试像这样重写：

```
if unsorted[a] <= unsorted[b]
  numsmall == unsorted[a]
else
  numsmall = unsorted[b]
end 
```

# haskell - GHC违反了身份法？

> ID：11148294
> 
> 赞同：3
> 
> 时间：2012-06-21T23:31:41.490
> 
> 标签：haskell, ghc

> **可能重复：**
> [runST 和函数组合](https://stackoverflow.com/questions/9468963/runst-and-function-composition)

我遇到了一个奇怪的代码段，GHC 在使用`id`. 我很确定这是一个 GHC 错误，但我想先在这里检查一下，然后再向 GHC 开发人员提交错误报告。我将从工作代码开始：

```
import qualified Data.Vector as V
import qualified Data.Vector.Mutable as MV

v :: V.Vector Int
v = V.create $ MV.replicate 1 0 
```

这在 ST monad 中创建了一个新向量并且工作得很好：

```
>>> v
fromList [0] 
```

当我编写时会出现该`V.create`错误`id`：

```
import qualified Data.Vector as V
import qualified Data.Vector.Mutable as MV

v :: V.Vector Int
v = id . V.create $ MV.replicate 1 0 
```

...失败并出现以下错误：

```
Couldn't match expected type `forall s.
                              GHC.ST.ST s (MV.MVector s a0)'
            with actual type `m0 (MV.MVector
                                    (Control.Monad.Primitive.PrimState m0) a1)'
In the return type of a call of `MV.replicate'
In the second argument of `($)', namely `MV.replicate 1 0'
In the expression: id . V.create $ MV.replicate 1 0 
```

但是，如果我应用`id`而不是编写它，那么代码类型检查就好了：

```
import qualified Data.Vector as V
import qualified Data.Vector.Mutable as MV

v :: V.Vector Int
v = id $ V.create $ MV.replicate 1 0 
```

基于此，我猜测与组合有关的某些事情`id`会导致 GHC 意外泛化或专门化`V.create`，从而导致它触发与 . 的类型不匹配`MV.replicate`。但是，除此之外，我被卡住了，因为类型错误有点超出我的想象。

单态性限制也不是问题。即使我启用该`NoMonomorphismRestriction`标志，问题仍然存在。

这是一个非常奇怪的问题，因为我期望`id . f == f`. 此外，正确的身份法则也失败了，因为以下示例也无法进行类型检查：

```
import qualified Data.Vector as V
import qualified Data.Vector.Mutable as MV

v :: V.Vector Int
v = V.create . id $ MV.replicate 1 0 
```

这是使用 GHC 版本 7.4.1 和`vector-0.9.1`.

# c# - 将成员服务应用到远程 sql server

> ID：11148295
> 
> 赞同：2
> 
> 时间：2012-06-21T23:31:48.270
> 
> 标签：c#, asp.net, sql, ado.net

我创建了一个 Visual Studio 2010 ASP.NET Web 应用程序。我注意到如果你换行

```
 <add name="ApplicationServices" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient" /> 
```

要附加您选择的数据库（如果尚未创建），会员服务将为您创建它。例如，如果在该数据库文件不存在时将“aspnetdb.mdf”更改为“mynewdb.mdf”，它将被创建并生成表等。

如果我有一个远程 sql 服务器，我只知道服务器名称：ATLAS-SQL-07 并且我有访问数据库的用户名和密码。然后我如何获得会员服务以自动生成该数据库中的表和存储过程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:37:30.150

查看在 asp.net 上找到的教程[创建成员模式在 sql-server-cs中。](http://www.asp.net/web-forms/tutorials/security/membership/creating-the-membership-schema-in-sql-server-cs)

注意：在本教程中，当它询问服务器时，您会为其提供服务器的完全限定 Web 路径。此信息应在您的托管帐户门户网站中提供。

[来自msdn.microsoft.com](http://msdn.microsoft.com/en-us/library/ms229862%28v=vs.80%29.aspx)的这句话也可以让您更深入地了解您想要做什么。

> ASP.NET SQL Server 注册工具用于创建 Microsoft SQL Server 数据库以供 ASP.NET 中的 SQL Server 提供程序使用，或者在现有数据库中添加或删除选项。Aspnet_regsql.exe 文件位于 Web 服务器上的 [drive:]\%windir%\Microsoft.NET\Framework\version 文件夹中。
> 
> 您可以在没有任何命令行参数的情况下运行 Aspnet_regsql.exe 来运行向导，该向导将引导您为 SQL Server 安装指定连接信息，以及安装或删除用于成员资格、角色管理、配置文件、Web 部件个性化的数据库元素，和健康监测功能。

您的主机似乎不允许远程连接。[http://www.123-reg.co.uk/support/answers/Hosting/Databases/how-do-i-connect-remotely-to-my-database-778/](http://www.123-reg.co.uk/support/answers/Hosting/Databases/how-do-i-connect-remotely-to-my-database-778/)

但是，经过进一步研究，您应该能够将数据库导入。因此，您可以在本地正确创建数据库并使用主机提供的接口导入所有内容。[http://www.123-reg.co.uk/support/answers/Databases/Windows-MSSQL/how-do-i-import-export-a-mssql-database-793/](http://www.123-reg.co.uk/support/answers/Databases/Windows-MSSQL/how-do-i-import-export-a-mssql-database-793/)

# inheritance - 组合和多重继承

> ID：11148299
> 
> 赞同：-2
> 
> 时间：2012-06-21T23:32:19.700
> 
> 标签：inheritance, interface, go, composition

由于 Go 使用组合系统而不是（多重）继承，我只是想知道这 3 个代码片段。Go 说他们强迫程序员使用组合。

A) 应该是（几乎）正确的 Go-Code，B) 伪 C) 伪

恕我直言，所有三个代码的结果总是相同的，除此之外，B) 和 C) 可以用于更多的东西，而 A) 迫使你坚持组合？

即使您假设 B) 在类中没有排序方法，但是 - 可以说像 A) 这样的全局并没有真正的区别 oO

一）去代码：

```
interface Sort
    Len()
    Less(i, j int) bool
    Swap(i, j int)

func (qs *Sort) sort()
    doTheSorting

type MyData struct {
    var value int
}

func (s *MyData) Len() { ... }
func (s *MyData) Less(i, j int) bool { ... }
func (s *MyData) Swap(i, j int) { ... } 
```

B）根据编译器的工作方式，看起来像继承，但恕我直言可以被视为嵌入式。

```
class Sort

    public sort() { ... }

    abstract Len()
    abstract Less(i, j int) bool
    abstract Swap(i, j int) 
```

C）

```
interface SortInterface
    void Len()
    bool Less(i, j int)
    void Swap(i, j int)

class Sort implements SortInterface
    public sort() { ... } 
```

用法 B 和 C：

```
class MyClass **embed** Sort

    int value

    void Len() { ... }
    bool Less(i, j int) { ... }
    void Swap(i, j int) { ... } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T00:25:20.803

不，这不是 go 的工作方式。这是一个可以排序的类型的示例（从标准库中提取）。

```
type IntSlice []int

func (p IntSlice) Len() int           { return len(p) }
func (p IntSlice) Less(i, j int) bool { return p[i] < p[j] }
func (p IntSlice) Swap(i, j int)      { p[i], p[j] = p[j], p[i] } 
```

这实现了接口：

```
// Name of interface changed for clarity
type Sort interface {
    Len() int
    Less(i, j int) bool
    Swap(i, j int)
} 
```

实现`Sort`接口的类型不会获得新方法。您不能将方法分配给您的示例中的接口`func (qs *Sort) sort() {...}`。

但是，允许将其传递给需要类型变量的函数和方法`Sort`。正因为如此，我可以打电话`sort.Sort(myIntSlice)`，然后它会被排序。

这是一个示例函数，它采用实现`Sort`接口的任何参数：

```
func IsSorted(data Sort) bool {
    n := data.Len()
    for i := n - 1; i > 0; i-- {
        if data.Less(i, i-1) {
            return false
        }
    }
    return true
} 
```

在`IsSorted`中，该函数不知道真正的数据类型是什么。它可能是`IntSlice`或其他任何东西。它所知道的是，你给它的任何参数都会实现 Sort 接口中的方法。

但是，我似乎无法弄清楚您提出的问题。此外，伪代码很难理解。使用另一种语言（例如 java）会更好。

# javascript - 我如何让 OpenLayers 功能选择和 Javascript 拖放一起工作？

> ID：11148303
> 
> 赞同：12
> 
> 时间：2012-06-21T23:32:35.867
> 
> 标签：javascript, drag-and-drop, openlayers

我正在编写一个应用程序，它使用[OpenLayers](http://www.openlayers.org/)使用户能够将文件拖放到一组预定义的功能上，这些功能通过 AJAX 发送到服务器。这些文件本身是来自地球物理设备的原始数据，将由服务器呈现为栅格图层。

我对地图进行了拖放操作：

```
var mapelem = $id("map");
mapelem.addEventListener("dragover", FileDragHover, false);
mapelem.addEventListener("dragleave", FileDragHover, false);
mapelem.addEventListener("drop", FileSelectHandler, false); 
```

我在悬停使用此代码时突出显示：

```
var sf = new OpenLayers.Control.SelectFeature(boxes, {
    hover: true,
    multiple: false,
    highlightOnly: true
});
map.addControl(sf);
sf.activate(); 
```

其余代码大多只是[Boxes Example - Vector](http://www.openlayers.org/dev/examples/boxes-vector.html)。

问题是当将文件拖到地图画布上时，OpenLayers 悬停选择不再起作用，我希望它为用户提供反馈，以确保他们将文件拖放到他们期望的位置。

我可以得到光标在画布上的位置：

```
map.events.register("mousemove", map, function(e) { 
    lonlat = map.getLonLatFromPixel(e.xy);
}); 
```

因此，我也许可以在该功能中进行功能点测试，但能够使用现有功能会很好。

有什么方法可以将拖动消息传播到我的 OpenLayers 图层？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T08:44:16.797

来自 MDN 拖放文档 [1]：«注意，只有拖动事件被触发；鼠标事件，例如`mousemove`在拖动操作期间不会触发。»

因此，您将无法将拖动处理程序注册到地图 div。也许您可以尝试在每个功能上注册一个拖动处理程序。这里有一些半测试的代码（仅使用 SVG 渲染器）：

```
boxes.features.forEach(function(f){
    elem = $(f.geometry.id);
    elem.addEventListener("dragover", FileDragHover, false);
    elem.addEventListener("dragleave", FileDragHover, false);
    elem.addEventListener("drop", FileSelectHandler, false);
}) 
```

希望能有所帮助。

1 - [https://developer.mozilla.org/En/DragDrop/Drag_and_Drop](https://developer.mozilla.org/En/DragDrop/Drag_and_Drop)

# macos - Mac 上的 Subversion - 无法提交文件

> ID：11148305
> 
> 赞同：0
> 
> 时间：2012-06-21T23:32:38.457
> 
> 标签：macos, svn, chown

我最近在 Mac OS X 上设置了一个 svn 服务器。我可以签出文件，但不能提交，但出现以下错误：

```
Error     Can't open file '/usr/local/repo/db/txn-current-lock': Permission denied 
```

我知道这是一个所有权问题——但是，我尝试了从搜索中找到的各种解决方案，例如：

```
chown -R subversion:subversion /usr/local/repo 
```

但是我知道颠覆是一个无效的论点（可能是因为我的机器上没有具有这些名称的用户或组）。我的问题是——如何创建这些用户和一个组，以便与我的 svn 身份验证文件中指定的用户名和密码链接？

谢谢！安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:17:02.303

我认为这肯定是一个权限问题：

由于我不知道这里的用户和组，所以我建议使用：

```
sudo chown -R $(id -u):$(id -g) /path/to/repo #now new owner would be current user and the group wold become current usergroup.

chmod -R u+w /path/to/repo 
```

# android - 模拟器的时钟与主机系统时钟不匹配

> ID：11148309
> 
> 赞同：42
> 
> 时间：2012-06-21T23:33:07.157
> 
> 标签：android, android-emulator, clock, avd

为什么安卓模拟器的时钟与主机系统时钟不匹配？这**不是时区差异**——它总是相差几分钟。

除了手动设置模拟器的时间之外，还有其他方法可以同步它们吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2020-03-05T02:19:08.790

我遇到了同样的问题，只需使用模拟器电源按钮重新启动模拟器即可解决。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-06-22T00:05:05.097

我相信没有办法同步时间。模拟器的默认图像设置为 UTC/GMT (+00:00)。但是，您可以将其更改为您自己的。

这是有关如何执行此操作的图片：首先取消选中“自动时区”（红色箭头），然后单击“选定时区”（绿色箭头），最后选择您的时区，它应该与您的系统（黄色箭头）。 ![时区截图](../Images/1f1b38607e2c16b60bd438088866d461.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-22T01:03:19.973

如果 AVD 和主机时间之间存在一些差异，主要是在从快照重新启动之后，您可以`adb shell date`在启动模拟器后使用来检查和/或设置日期。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-01-22T21:42:39.130

因为我把它作为谷歌的顶级链接:)

在**Windows 上**，您可以通过发出正确的时间

```
adb shell date -s %date:~10,4%%date:~4,2%%date:~7,2%.%time:~0,2%%time:~3,2%%time:~6,2% 
```

`-s`值应采用以下格式：`YYYYMMDD.hhmmss`

在具有**不同时间格式**的系统上，带有 windows shell 参数的部分**会有所不同！**

您可以在以下位置进行测试`cmd.exe`：

```
> echo %date%
Thu 01/22/2015 
```

要输出 YYYY 部分，请使用：`%date:[position of char. 0-based],[length]%`

在**Linux**上：

```
adb shell date -s $(date +%Y%m%d.%H%M%S) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-10-26T02:46:19.680

`date`自从其他答案以来，该命令在较新的机器人中发生了变化。您必须具有 root 权限，`-s`无法识别并且设置的格式已更改。

我很幸运使用`adb shell su root date -u @$(date +%s.%N)`，它用于`@`使用具有纳秒精度的 UNIX 时间戳秒来设置它。`-u`如果您出于某种原因更改了时区，则需要，即使时间戳不应该有时区！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-01-13T07:55:43.430

在 AndroidTV API 28 模拟器上，这有效（GNU/Linux 和一些 Mac）：

`adb shell su root date $(date +%m%d%H%M%Y.%S)`

主机时区应与您的 AndroidTV 时区匹配。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-05-16T11:12:49.187

在 Windows 上，您需要在日期时间字符串周围加上引号，以避免在解析返回数字前的空格时出错。

完整的语法是：

```
adb shell date -s '%date:~10,4%%date:~4,2%%date:~7,2%.%time:~0,2%%time:~3,2%%time:~6,2%' 
```

# jquery-ui - datepicker 需要在多个页面上刷新

> ID：11148311
> 
> 赞同：0
> 
> 时间：2012-06-21T23:33:15.573
> 
> 标签：jquery-ui, datepicker, refresh

我在财务会计网站的每个页面上都有一个日期选择器表单。日期选择器旨在允许用户选择他们想要显示的数据的日期范围。

不幸的是，当用户从一个页面导航到另一个页面时，当文本字段具有焦点时显示日历的唯一方法是硬刷新 (Ctrl-R)。不是最优的。

这是表格：

```
<li data-data-theme='b' >
<label for="from">From</label>  
<input type="text" id="from" name="from"/>
</li>

<li data-data-theme='d'>
<label for="to">to</label>
<input type="text" id="to" name="to"/>
</li> 
```

这是jquery：

```
 $(function() {

        console.log("hello world 2");

        $( "#from" ).datepicker({
            defaultDate: "+1w",
            changeMonth: true,
            changeYear: true,
            numberOfMonths: 3,
            stepMonths: 3,
            showOtherMonths: true,
            showOptions: {direction: 'up'},
            showButtonPanel: true,
            yearRange: "2011:2019", 
            showAnim: "fold",
            dateFormat: "yy-mm-dd",
            onSelect: function( selectedDate ) {
                $( "#to" ).datepicker();
            }
        });
        $( "#to" ).datepicker({
            defaultDate: "+1w",
            changeMonth: true,
            changeYear: true,
            numberOfMonths: 3,
            stepMonths: 3,
            showOtherMonths: true,
            showOptions: {direction: 'up'},
            showButtonPanel: true,
            yearRange: "2011:2019", 
            showAnim: "fold",
            dateFormat: "yy-mm-dd",
            onSelect: function( selectedDate ) {
                $( "#from" ).datepicker();
            }
        });
    });

}

$(document).ready(function(){

    console.log("hello world");

    $(function() {

        console.log("hello world 2");

        $( "#from" ).datepicker({
            defaultDate: "+1w",
            changeMonth: true,
            changeYear: true,
            numberOfMonths: 3,
            stepMonths: 3,
            showOtherMonths: true,
            showOptions: {direction: 'up'},
            showButtonPanel: true,
            yearRange: "2011:2019", 
            showAnim: "fold",
            dateFormat: "yy-mm-dd",
            showOn: 'button', 
        buttonImage: 'images/datepicker_icon.png', 
        buttonImageOnly: true,

            onSelect: function( selectedDate ) {
                $( "#to" ).datepicker();
            }
        });
        $( "#to" ).datepicker({
            defaultDate: "+1w",
            changeMonth: true,
            changeYear: true,
            numberOfMonths: 3,
            stepMonths: 3,
            showOtherMonths: true,
            showOptions: {direction: 'up'},
            showButtonPanel: true,
            yearRange: "2011:2019", 
            showAnim: "fold",
            dateFormat: "yy-mm-dd",
            onSelect: function( selectedDate ) {
                $( "#from" ).datepicker();
            }
        });
    });

}); 
```

我尝试更改表单以包含对类的引用：例如：

```
<li data-data-theme='b' >
<label for="from">From</label>  
<input class='datepicker' type="text" id="from" name="from"/>
</li>

<li data-data-theme='d'>
<label for="to">to</label>
<input class='datepicker' type="text" id="to" name="to"/>
</li> 
```

然后在jquery函数中引用它：

```
 $(function() {

      console.log("hello world 2");

    $( ".datepicker" ).datepicker({

           ...

           onSelect: function( selectedDate ) {
        $( ".datepicker" ).datepicker();
                }
    });
       }); 
```

但一切都无济于事。

那么，问题来了：当用户导航到网站上的新页面时，如何显示日期选择器日历？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T05:38:28.687

您想默认打开日期选择器吗？当用户访问这些页面时。如果是，则必须配置 datepicker 的 display inline 属性，请参见示例[Example datepicker display inline](http://jqueryui.com/demos/datepicker/#inline)

```
$(function() {
      $('#datepicker').datepicker({altField: '#date1'});
}); 
```

# php - 用php在sql中搜索带空格的字符串

> ID：11148313
> 
> 赞同：0
> 
> 时间：2012-06-21T23:33:45.413
> 
> 标签：php, sql

我需要用 php 在 mysql 中搜索一个字符串。我收到与字符串中的空格相关的错误。我不熟悉正则表达式，我不确定这是我唯一的选择。例子：

```
$ex="This and That";

$sql = 'SELECT
some_ID
FROM ' . atable. ' WHERE ' . strings. ' LIKE ' . $ex. ' AND visable=' . '1'; 
```

执行后出现如下错误：

> “在第 x 行的‘那个 AND 可见 = 1’附近”

所以它可能没有拿起前两个词，有什么建议吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:36:20.153

您在字符串周围缺少引号。它们需要完全封装，查询才能正确执行。

改变这个：

```
LIKE ' . $ex. ' AND 
```

对此：

```
LIKE "' . $ex. '" AND 
```

附带说明一下，确保您保护自己免受 SQL 注入并确保您的查询被正确转义。

# ruby-on-rails - ActiveAdmin 如何对具有关联的列进行排序

> ID：11148316
> 
> 赞同：14
> 
> 时间：2012-06-21T23:34:10.780
> 
> 标签：ruby-on-rails, associations, activeadmin

我正在开发一个 ActiveAdmin 应用程序，我想按“类型”对一列企业进行排序。不幸的是，我的代码不起作用。我应该使用什么代码来完成此操作？这是我的代码...

`app/models/business.rb`

* * *

```
class Business < ActiveRecord::Base   
     belongs_to :type

     attr_accessible :description, :email, :facebook, :foursquare, :google, :manager,
    :mobile, :name, :phone, :type_id, :url, :yelp 
end 
```

`app/models/type.rb`

* * *

```
class Type < ActiveRecord::Base
  attr_accessible  :category
  has_many :businesses

  def to_s
    category
  end
end 
```

`app/admin/businesses.rb`

* * *

```
ActiveAdmin.register Business, { :sort_order => :name_asc } do
  scope :joined, :default => true do |businesses|
    businesses.includes [:type]
  end
  index do
    column :name
    column :type, :sortable => 'businesses.type'
    column :manager
    column :email
    default_actions
  end
end 
```

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-31T09:06:07.877

根据这个讨论：[https](https://github.com/gregbell/active_admin/pull/623) ://github.com/gregbell/active_admin/pull/623 ，如果你不想使用范围，你可以使用范围收集方法：

```
ActiveAdmin.register Business, { :sort_order => :name_asc } do
  scope :all, :default => true

  index do
    column :name
    column :type, :sortable => 'types.category'
    column :manager
    column :email
    default_actions
  end

  controller do
    def scoped_collection
      end_of_association_chain.includes(:type)
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-24T20:57:45.470

**固定的**

`column :type, :sortable => 'types.category'`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-15T02:47:44.063

是的，Evgenia 提供的 scoped_collection 效果很好。对于不止一列：

```
ActiveAdmin.register Foo do
  index do
    column :field_name_a, :sortable => 'association_a.field_name'
    column :field_name_b, :sortable => 'association_b.field_name'
  end
end

controller do
  def scoped_collection
    end_of_association_chain.includes([:association_a, :association_b])
  end
end 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-05-15T12:16:09.110

这是可以做到的。

在这里，我有一个名为 Star 的模型。一颗星属于一个人。我将把 Person.name 放在 Star 管理索引中，使其可排序，使其适用于范围，并添加过滤器。

首先，您必须将连接模型添加到每个范围。在这种情况下，我有 3 个范围：all、category_subscriptions 和 person_subscriptions。我正在声明范围并向它们添加连接模型：

```
ActiveAdmin.register Star do
  [ :all, :category_subscriptions, :person_subscriptions ].each do |sym|
    scope(sym, :default => (sym == :all) ) do |stars|
      stars.includes [:person]
    end
  end
end 
```

现在要将连接模型中的人名添加到我的星号索引中，我这样做：

```
index do
  id_column
  column("Name", nil, :sortable => :"people.name") {|star| star.person.name}
  column("Email", nil, :sortable => :"people.email") {|star| star.person.email}
  default_actions
end 
```

让我们剖析一下：

```
column("Name", nil, :sortable => :"people.name") {|star| star.person.name} 
```

*   第一个参数是列标题。
*   第二个是不需要的，因为我们覆盖了排序和值。
*   :sortable 告诉 Active Admin 如何对事物进行排序。这是表名，因为它要进入 SQL。
*   该块告诉 Active Admin 使用什么作为行值。

现在添加一些过滤器。这要容易得多：

```
filter :person_name, :as => :string
filter :person_email, :as => :string 
```

你完成了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-10-08T20:46:28.147

根据您的需要，这是我用于排序、默认索引和过滤的实现：

```
ActiveAdmin.register Business do
  index do
    column :name
    column :type, :sortable => 'businesses.type'
    column :manager
    column :email
    default_actions
  end

  controller do
    def scoped_collection
      super.includes(:businesses)
    end
  end
end 
```

以防万一您想知道当您拥有更多级别的关联时如何排序，这就是我处理的方式，例如：

```
class TechResult < ActiveRecord::Base
  belongs_to :user
end

class User < ActiveRecord::Base
  belongs_to :organization
end

class Organization < ActiveRecord::Base
  has_many :users
end 
```

然后在您的 tech_results 部分中，您要呈现一个组织字段，在我的情况下，`tech_result.user.organization.name`这是对它们进行排序的方法：

```
ActiveAdmin.register TechResult do
  config.batch_actions = false
  permit_params :user_id

  preserve_default_filters!

  index do
    column :id
    column 'user', sortable: 'users.name' do |tr|
      tr.user.name
    end
    column 'organization', nil, sortable: 'organizations.name' do |tr|
      tr.user.organization.name.titleize if tr.user.organization
    end

  end

  controller do
    def scoped_collection
      super.includes(user: [:organization])
    end
  end
end 
```

# java - 为 JFormattedTextField 分配一个浮点数

> ID：11148318
> 
> 赞同：0
> 
> 时间：2012-06-21T23:34:13.807
> 
> 标签：java, swing, jformattedtextfield

我正在使用 swing 编写一个带有 gui 的简单贷款计算器。我使用 DecimalFormat 确保以我的指定格式 ####.## 为我的 JFormattedTextField 捕获输入。

```
public static void main(String[] args) {
    JFormattedTextField loanAmountField = new JFormattedTextField(new DecimalFormat("####.##"));
    JFormattedTextField interestRateField = new JFormattedTextField(new DecimalFormat("####.##"));
    JFormattedTextField yearField = new JFormattedTextField(new DecimalFormat("####.##"));
    JFormattedTextField monthlyPaymentField = new JFormattedTextField(new DecimalFormat("####.##"));
} 
```

当用户按下我的“计算”按钮时，它会计算并显示monthlyPaymentField。

为了测试我的程序是否能正确显示它，我尝试为monthlyPaymentField 分配12.22 的值，但我收到一个错误，提示应该将monthlyPaymentField 声明为double。

```
class CalculateListener implements ActionListener {
public CalculateListener (JFormattedTextField loanAmountField, JFormattedTextField     monthlyPaymentField, JFormattedTextField interestRateField, JFormattedTextField yearField, int monthlyTest)
{
  this.interestRateField = interestRateField;   
  this.yearField = yearField;
  this.loanAmountField = loanAmountField;
  this.monthlyPaymentField = monthlyPaymentField;
  this.monthlyTest = monthlyTest;
}

public void actionPerformed(ActionEvent event){

   monthlyPaymentField = 12.22;

    }

} 
```

**我该如何解决这个问题，以便我仍然可以将我的 JFormattedTextField 与 DecimalFormat 一起使用，但仍然可以在我的monthlyPaymentField 上显示一个浮点数？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:39:05.287

您可以使用该[`setValue`](http://www.open.collab.net/nonav/community/cif_cee/pt/javadoc/tracker-ws/com/collabnet/tracker/ws/SetValue.html)方法；

```
monthlyPaymentField.setValue(new Double(12.22)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T23:40:20.260

使用[setValue](http://docs.oracle.com/javase/6/docs/api/javax/swing/JFormattedTextField.html#setValue%28java.lang.Object%29)，即：

```
monthlyPaymentField.setValue(new Double(12.22)); 
```

[How to Use Formatted Text Fields](http://docs.oracle.com/javase/tutorial/uiswing/components/formattedtextfield.html)教程有一个很好的双打示例。

# c# - 使用 Model First，我如何为快速、亚秒级的连接预加载连接表？

> ID：11148319
> 
> 赞同：0
> 
> 时间：2012-06-21T23:34:23.530
> 
> 标签：c#, linq, entity-framework, sql-server-ce, plinq

我想使用实体框架（模型优先）在几个表中进行快速、亚秒级的连接。简化的数据模型类似于以下内容：

*视频*：**ID**（主键）；**姓名**

*标签*：**ID**（主键）；**姓名**

*TaggedVideos* : **TagID** (FK); **视频 ID** (FK)

当表未在实体框架中建模或公开时，是否有预加载*TaggedVideos的方法？*在搜索具有特定标签的所有视频时，我试图避免数据库命中。理想情况下，所有三个表都将加载到集合中，然后我可以使用 PLINQ 加入。

*如果我向TaggedVideos*添加另一列，我可以做到这一点，但我更喜欢不会弄乱数据模型的优雅解决方案。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:54:37.763

缓存标签并确保对视频集合具有反向导航属性。

然后，您可以访问标签的缓存版本，并在不加入的情况下查找关联的视频。

如果您不想缓存整个视频，请在缓存代码中选择使用 Videos.Select(v=>v.Id) 之类的内容来仅选择 ID 并缓存它。

# mysql - MySQL 限制插入

> ID：11148320
> 
> 赞同：1
> 
> 时间：2012-06-21T23:34:24.720
> 
> 标签：mysql

如何在 MySQL 中执行等效语句？如果输入是某个值，我想要它，不要插入行。在 SQL SERVER 中，我只能说 ROLLBACK。MySQL中的等效命令是什么？谢谢你。

```
CREATE TRIGGER tr_some_trigger
ON some_table
FOR INSERT
AS 
BEGIN
  IF inserted.topic == 'test' THEN
    ROLLBACK
  ENDIF
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:50:40.783

从[这个文件](http://dev.mysql.com/doc/refman/5.1/en/trigger-syntax.html)：

> 触发器不能使用显式或隐式开始或结束事务的语句，例如 START TRANSACTION、COMMIT 或 ROLLBACK。

所以`ROLLBACK`不会在您的触发器中工作，但是如果触发器引发异常/错误，它将阻止插入成功，所以您可以做的是在满足您的条件时引发异常（一种方法是调用未定义的函数）。

例如：

```
DELIMITER $$

CREATE
    TRIGGER `db`.`before_insert` BEFORE INSERT
    ON `db`.`dummy_table`
    FOR EACH ROW BEGIN
    IF new.topic = 'test' THEN
        CALL func_1();
    END IF;

    END$$

DELIMITER ; 
```

假设 func_1 不存在，它将阻止您插入新记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T23:36:28.500

它也在 MySQL 中回滚。[在此处](http://dev.mysql.com/doc/refman/5.0/en/commit.html)查看文档。

# macos - 如何将 emacs 颜色从常规终端保留到 gnu 屏幕

> ID：11148321
> 
> 赞同：11
> 
> 时间：2012-06-21T23:34:29.720
> 
> 标签：macos, emacs, colors, terminal, gnu-screen

为了记录，我正在使用 OSX 雪豹。

当我直接从终端使用 emacs 时，我有一个我非常满意的颜色集（例如，用于 c/c++）——黑色上的绿色、红色注释、彩色关键字......等等。其中一些是在我的“终端首选项”中设置，有些在我的 ~/.emacs 文件中（见下文）。当我从屏幕运行 emacs 时，基本的配色方案是相同的（黑底绿），但颜色不同（例如注释字符是红色的，但不是整个注释）——而且真的很烦人。

任何帮助，将不胜感激！

在我的“.emacs”文件中（这在 gnu-screen emacs 中停止工作）：

```
(global-font-lock-mode t)
(custom-set-faces
 '(font-lock-comment-face
   ((((class color) (background light))
     :foreground "tomato")
    ))) 
```

在我的“.screenrc”文件中：

```
shell -$SHELL            # colors still don't work without this
#term xterm-256color    # using this doesn't fix the colors (suggested on some forums)

altscreen on
startup_message off 
```

我认为我的 .screenrc 文件中的命令 'shell -$SHELL' 使屏幕中的命令提示符与默认值相同 --- 它**确实**使我的命令行说 'computername:/DIR/username$' 而不仅仅是 ' bash-3.2$'

==================================================== ================

**解决方案**：感谢**Greg E。**

我需要在屏幕上设置我的终端模拟器以匹配我的普通 shell。为此，我添加了

```
export TERM='xterm-color' 
```

到 ~/.bash_profile

出于某种原因，“~/.screenrc”文件中的“term xterm-color”不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T01:09:22.493

我的怀疑是，虽然您的终端编译时可能支持超过标准的 16 色，但您的特定版本的 GNU 屏幕可能不支持。我对 OSX 不是很熟悉，但在 Linux 上，我会检查普通终端和一个正在运行的屏幕之间的输出是否不同（如果不可用`tput colors`，我希望有一些 OSX 等价物）。`tput`如果是这样，您可能需要安装（或手动编译）一个不同的屏幕版本，其中包括对其他颜色的支持（通常，最大值为 256，但也常见为 88，而默认最小值为 16）。

编辑：最终，正确的解决方案被证明是手动设置`$TERM`环境变量（见下面的评论）。

# java - 使用java解析csv然后保存在二维数组中

> ID：11148322
> 
> 赞同：1
> 
> 时间：2012-06-21T23:34:35.243
> 
> 标签：java, arrays, csv, multidimensional-array

好的，所以我正在开发基于 java 中的集换式卡牌游戏的游戏。我将所有游戏元素的“信息”抓取到一个 csv 文件中，其中每一行都是游戏元素，每一列都是该元素的一种属性。我花了几个小时用缓冲阅读器等编写代码，试图将我的 csv 文件中的信息提取到二维数组中，但无济于事。我的 csv 文件链接在这里：[http](http://dl.dropbox.com/u/3625527/MonstersFinal.csv) ://dl.dropbox.com/u/3625527/MonstersFinal.csv我有一年的计算机科学专业，但我仍然无法弄清楚如何做到这一点。

所以我的主要问题是如何将它放入二维数组中，这样我就可以保留行和列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:34:42.957

好吧，如前所述，你的一些字符串包含逗号，所以最初你从一个糟糕的地方开始，但我确实有一个解决方案，它是这样的：

1.  --------- 如果可能，重新抓取站点，但执行简单的编码操作。你会想要做一些你会注意到的事情，这些事情往往是在包含 HTML 的自动生成的 XML 文件中完成的；保留一个“控制字符”（一个可打印的字符在这里效果最好，出于调试和......好吧......理智的原因），一旦编码，就永远不会直接作为其自身的实例来读取。Ampersand 是我喜欢使用的，因为它不常见但仍然可以打印，但实际上你想使用什么字符取决于你。我要做的是编写程序，以便在“，”的每个实例中，在写入 CSV 之前，逗号将被替换为“&c”，并且在站点上实际与符号的每个实例中，“& " 将替换为 "&a"。

2.  -------- 假设您知道每行中有多少列，您可以使用 StringTokenizer 类（查找它 - 它很棒并且内置在 Java 中。查找信息的好地方是一如既往， Java 教程）以数组的形式自动为您提供所需的值。

    *   它的工作原理是您传入一个字符串和一个分隔符（在这种情况下，分隔符将是 ','），并且它会吐出由这些逗号分隔的所有子字符串。如果您从一开始就知道总共有多少块，您可以在开始时实例化一个 2D 数组，然后插入 StringTokenizer 提供给您的每一行。如果你不这样做，那也没关系，因为你可以使用 ArrayList。ArrayList 很好，因为它是一个更高级别的数组抽象，它会自动请求更多内存，这样您就可以继续添加它并且知道检索时间将始终保持不变。但是，如果您计划动态添加片段，并且比检索它们更频繁，您可能希望使用 LinkedList 代替，因为它具有线性检索时间，但在添加-删除时间方面比 ArrayList 的关系要好得多。或者，如果你很棒，你可以使用 SkipList 代替。我不知道它们是否在 Java 中默认实现，但它们很棒。不过，公平的警告；检索、删除和放置速度的成本伴随着内存开销的增加。跳过列表维护了很多指针。

    *   如果您知道每行中应该有相同数量的值，并且您希望它们按位置组织，但是无论出于何种原因，您的刮板都无法处理行中缺少值的情况，并且只是不放值，你有一些坏消息......重写刮板代码中处理缺少值的部分比编写一个解释可变长度数组并为每个数组实例化一个 Piece 对象的方法更容易大批。我对此的建议是再次使用控制字符并用 &n 填充空列（表示“null”），以便稍后解释，但是具体细节当然会区分你的代码和编码风格，所以我不该说.

编辑：我认为您应该关注的主要内容是学习 Java 中可用的不同标准库数据类型，并且可能学习自己实现其中的一些以进行练习。我记得实现了一个二叉搜索树——不是 AVL 树，但没关系。这很有趣，很好的编码实践，更重要的是，如果你想能够快速有效地做事，这是必要的。我不确切知道 Java 是如何实现数组的，因为定义是“内存的连续部分”，但是您可以在运行时使用变量在 Java 中为它们分配内存......但无论具体的 Java 实现如何，数组通常是不是最好的解决方案。此外，了解正则表达式会使一切*变得更加重要*更轻松。作为练习，我建议将它们放入您的 Java 程序中，或者，如果您不想每次都编译和 jar 东西，您的 bash 脚本（如果您使用 *nix）和/或批处理脚本（如果您'正在使用 Windows）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T03:50:15.863

我认为你抓取数据的方式使这个问题变得比它需要的更加困难。鉴于大多数值不一致地被引号包围，某些数据中已经包含逗号，并且并非每张卡都在自己的行中，因此您的抓取似乎不一致且难以处理。

尝试以更一致的格式重新抓取数据，例如：

```
R1C1|R1C2|R1C3|R1C4|R1C5|R1C6|R1C7|R1C8
R2C1|R2C2|R2C3|R2C4|R2C5|R2C6|R2C7|R3C8
R3C1|R3C2|R3C3|R3C4|R3C5|R3C6|R3C7|R3C8
R4C1|R4C2|R4C3|R4C4|R4C5|R4C6|R4C7|R4C8
A/D Changer|DREV-EN005|Effect Monster|Light|Warrior|100|100|You can remove from play this card in your Graveyard to select 1 monster on the field. Change its battle position. 
```

每行绝对是它自己的卡片（与您在奇数位置发布的带有新行的示例 CSV 不同），并且分隔符永远不会在数据字段中用作分隔符以外的东西。

一旦您将输入变为一致可读的状态，解析它就变得非常简单：

```
 BufferedReader br = new BufferedReader(new FileReader(new File("MonstersFinal.csv")));
    String line = "";

    ArrayList<String[]> cardList = new ArrayList<String[]>(); // Use an arraylist because we might not know how many cards we need to parse.

    while((line = br.readLine()) != null) { // Read a single line from the file until there are no more lines to read
        StringTokenizer st = new StringTokenizer(line, "|"); // "|" is the delimiter of our input file.
        String[] card = new String[8]; // Each card has 8 fields, so we need room for the 8 tokens.
        for(int i = 0; i < 8; i++) { // For each token in the line that we've read:
            String value = st.nextToken(); // Read the token
            card[i] = value; // Place the token into the ith "column"
        }
        cardList.add(card); // Add the card's info to the list of cards.
    }

    for(int i = 0; i < cardList.size(); i++) {
        for(int x = 0; x < cardList.get(i).length; x++) {
            System.out.printf("card[%d][%d]: ", i, x);
            System.out.println(cardList.get(i)[x]);
        }
    } 
```

这将为我给定的示例输入产生以下输出：

```
card[0][0]: R1C1
card[0][1]: R1C2
card[0][2]: R1C3
card[0][3]: R1C4
card[0][4]: R1C5
card[0][5]: R1C6
card[0][6]: R1C7
card[0][7]: R1C8
card[1][0]: R2C1
card[1][1]: R2C2
card[1][2]: R2C3
card[1][3]: R2C4
card[1][4]: R2C5
card[1][5]: R2C6
card[1][6]: R2C7
card[1][7]: R3C8
card[2][0]: R3C1
card[2][1]: R3C2
card[2][2]: R3C3
card[2][3]: R3C4
card[2][4]: R3C5
card[2][5]: R3C6
card[2][6]: R3C7
card[2][7]: R4C8
card[3][0]: R4C1
card[3][1]: R4C2
card[3][2]: R4C3
card[3][3]: R4C4
card[3][4]: R4C5
card[3][5]: R4C6
card[3][6]: R4C7
card[3][7]: R4C8
card[4][0]: A/D Changer
card[4][1]: DREV-EN005
card[4][2]: Effect Monster
card[4][3]: Light
card[4][4]: Warrior
card[4][5]: 100
card[4][6]: 100
card[4][7]: You can remove from play this card in your Graveyard to select 1 monster on the field. Change its battle position. 
```

我希望在这里重新抓取信息是一种选择，我希望我没有误解任何东西；祝你好运！

最后一点，一旦你把事情解决了，别忘了利用 OOP。一个`Card`类可以使处理数据更加简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T23:52:15.670

我正在研究用于机器学习的类似问题，所以让我分享一下我在该主题上能够做的事情。

1）如果您在开始解析该行之前就知道 - 它是否被硬编码到您的程序中，或者您的文件中是否有一些标题可以为您提供此信息（强烈推荐） - 每行会有多少个属性，你可以合理地用逗号分割它，例如第一个属性将是 RowString.substring(0, RowString.indexOf(','))，第二个属性将是从第一个逗号到下一个逗号的子字符串（编写一个函数找到逗号的第 n 个实例，或者只是在遍历它时切掉字符串的位，应该相当简单），最后一个属性将是 RowString.substring(RowString.lastIndexOf(','), RowString.长度（））。String 类的方法在这里是你的朋友。

2）如果您在区分用于分隔值的逗号和作为字符串格式属性的一部分的逗号时遇到问题，那么（如果文件小到可以手动重新格式化）执行 Java 所做的 - 用字符串中带有 '\,' 而不仅仅是 ',' 的特殊含义。这样您就可以搜索“，”而不是“\”的索引，这样您就可以通过某种方式来区分您的字符。

3) 作为 2) 的替代方案，CSV（在我看来）不适用于通常包含逗号的字符串。CSV 没有真正的通用格式，那么为什么不将它们设为冒号分隔值、破折号分隔值，甚至三连字符分隔值呢？用逗号分隔值的目的是为了便于区分它们，如果逗号不起作用，就没有理由保留它们。同样，这仅适用于您的文件小到可以手动编辑的情况。

4）查看您的文件不仅仅是格式，很明显您无法手动完成。此外，似乎有些字符串被三个双引号 ("""string""") 包围，而一些字符串被单双引号 ("string") 包围。如果我不得不猜测，我会说引号中包含的任何内容都是单个属性 - 例如，没有一对引号以一个属性开头并以另一个属性结尾。所以我想说你可以： 使用一种方法创建一个类，将字符串分成每个逗号分隔的字段。编写该方法，使其忽略前面有奇数个双引号的逗号（这样，如果引号对尚未关闭，它就知道它在字符串中并且逗号不是值分隔符）。这种策略，

# bash - 保存 bash 函数

> ID：11148323
> 
> 赞同：4
> 
> 时间：2012-06-21T23:34:37.803
> 
> 标签：bash, shell

首先，我想纠正一下我的词汇量。我假设终端为 bash 提供了一个环境，它是 shell 的一种类型/版本。这个对吗？

我正在尝试在我的开发过程中更多地利用 bash 和 shell 来加速部署。但是，我才刚刚开始了解我从小学到的命令之外的基础知识。

我已经开始在终端中制作函数来帮助自动化我的一些更重复的任务。在我退出终端之前，这一切都是发现和花花公子。

我假设 shell 在一个实例中运行，所以当我退出终端时该实例会丢失。我注意到 shell 留下了一个 .bash_history，也可以使用“历史”访问，在那里我可以从旧会话中看到我的旧函数。但是，当然，它们似乎不再执行。

我认识到我可以创建一个 shell 脚本，但这会引入编译问题，并且必须更加注意脚本的相对存储位置。

问题：当我使用 command(){} 创建 bash 脚本时，它们在关闭终端后不会持续存在。我可以让他们在新的终端会话上这样做吗？我可以访问我的旧功能而无需求助于 shell 脚本？

* * *

编辑：我还想提一下，我尝试使用传统方法广泛地找到这个问题，但是搜索词中的“保存”和“退出”通常会指向 shell 的其他方面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:37:50.310

你的第一个陈述是正确的。终端实例运行一种 shell（bash、sh、csh）

您可以将它们添加到您的 ~/.bashrc 文件中，或者将保存的脚本路径（无需编译）添加到您的 PATH 变量中。

您也可以将脚本复制到 /usr/local/bin 以便随时快速访问。您无需跟踪它们的相对位置。这非常方便，并使您的脚本可供其他用户使用（如果权限设置正确，则不能使用）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T01:16:30.317

请参阅Bash 参考手册的[交互式使用历史记录](http://tiswww.case.edu/php/chet/bash/bashref.html#SEC123)部分，了解如何从历史记录中执行命令。

例如，键入`!?foo`并按下`Enter`将执行包含“foo”的最新命令。我喜欢`shopt -s histverify histreedit`在我的`~/.bashrc`，所以我可以编辑和确认命令，如果需要，而不是立即执行它。

另请参阅[用于操作历史记录的命令](http://tiswww.case.edu/php/chet/bash/bashref.html#SEC110)部分，了解可用于搜索要调用和执行的历史记录条目的击键。

例如，按`Ctrl`-`r`并键入`foo`将调用包含“foo”的最新命令。您可以按`Ctrl`-`r`多次以继续反向搜索其他匹配命令。`Enter`当您准备好执行当前显示的操作时按- 或`Ctrl`-`g`中止搜索。

如果您添加`stty -ixon`到您的`~/.bashrc`，那么您可以使用`Ctrl`-`s`在您开始向后搜索后向前搜索历史。

当然，您可以通过编辑`~/.bashrc`和添加函数来保存函数。我更喜欢将我的函数保存在我创建的名为的文件中`~/bin/functions`，然后在该文件中添加一行`~/.bashrc`。线看起来像`. ~/bin/functions`。

我将较大的脚本保存在`/usr/local/bin`或中`~/bin`。前者应该已经在您的路径中，您可以通过编辑将后者添加到您的路径中`~/.bashrc`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T08:11:15.717

在命令行上输入函数后，您可以使用命令行编辑来调用它们（如@Dennis Williamson 所述），但有一种更简单的方法：`declare -f`. 此命令列出所有当前函数，您可以将它们重定向到文件：

```
home/user1> function myfunc {
> echo "Hollow world!"
> }

/home/user1> declare -f > myfuncs
/home/user1> more myfuncs
myfunc () 
{ 
    echo "Hollow world"
} 
```

请注意 Bash 如何将函数语法从 Korn shell 更改为 Bourne shell！幸运的是，两者在 Bash 中没有区别（与 ksh93 不同）。

当您需要加载函数时，这很简单：

```
/home/user1> source myfuncs
/home/user1> myfunc
Hollow world! 
```

顺便说一句，您不需要执行权限，只需读取。您可以（正如其他人所说）将其添加到您的一个启动文件中，例如`.bashrc`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-28T14:21:45.603

您可以创建一个包含所有功能的简单库。这基本上可以解决您存储功能的问题。

```
 yeshwantnaik$ cat my_functions.lib
function do_something(){
 #your code goes here
} 
```

将其保存在您想要的任何位置。最好放在您的 $HOME 目录中。

加载库。不要错过开头的那个点。

```
 yeshwantnaik$ . $HOME/my_functions.lib 
```

现在你可以直接运行你的函数了。

```
 yeshwantnaik$ do_something 
```

## 让 Linux 为你做事

您可以跳过手动加载库的步骤，让 Linux 在您自动登录时为您执行此操作。

运行以下命令

```
echo ". $HOME/my_functions.lib" >> ~/.bashrc
echo ". $HOME/my_functions.lib" >> ~/.bash_profile
source ~/.bashrc
source ~/.bash_profile 
```

而已。您可以直接从命令行执行您的函数，而无需执行任何操作。

# objective-c - Objective-C 天气 API

> ID：11148326
> 
> 赞同：1
> 
> 时间：2012-06-21T23:35:17.923
> 
> 标签：objective-c, api, weather, weather-api

如何使用 XCode 和 Objective-C 获取当前天气**温度**（基于 ZipCode）？是否有 API（框架/库）？我似乎无法使用谷歌找到一个。对于我现在正在进行的项目，我需要做的只是获取一个整数（例如，华氏度）。

**这适用于 Mac OS X，而不是 iOS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:23:39.260

您可以查看以下五种不同的方法。

[http://blog.programmableweb.com/2009/04/15/5-weather-apis-from-weatherbug-to-weather-channel/](http://blog.programmableweb.com/2009/04/15/5-weather-apis-from-weatherbug-to-weather-channel/)

有没有适合你的需求？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T01:39:36.777

我使用[世界天气在线](http://www.worldweatheronline.com/)。它是免费的，而且非常全面。当然，它会满足您的需求。[这](http://www.worldweatheronline.com/free-weather-feed.aspx)是本地天气 API，您可以在其中输入邮政编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-12T16:57:54.387

OpenWeatherMap 得到我的投票。我为它写了一个包装器，这样你就不必接触 JSON。如果有帮助，链接就在这里 - [http://jonathanfield.me/objective-c-openweathermap-api-wrapper/](http://jonathanfield.me/objective-c-openweathermap-api-wrapper/)

# ios - 在我的服务完成之前通知 connectionDidFinishLoading

> ID：11148328
> 
> 赞同：1
> 
> 时间：2012-06-21T23:35:40.940
> 
> 标签：ios, uitableview

我有从多次呈现给我的 UITableView 的服务返回的数据。我将填充我的表的代码放置在 connectionDidFinishLoading 委托中。这是该代码的正确位置吗？

我有一个 NSMutableData* receivedData; 在我的 .m 文件的顶部，我已经实现了正确的委托并覆盖了正确的方法。

我只想知道我在这里缺少什么，或者我可以做些什么来只在表格视图中查看我的 JSON 中的数据一次。

```
-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {    
[receivedData setLength:0];
NSLog(@"%@",response);}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
NSLog(@"Succeeded! Received %d bytes of data",[data length]);
receivedData = [[NSMutableData alloc] init];
[receivedData appendData:data];}

-(void) connectionDidFinishLoading:(NSURLConnection *)connection {
NSError *error = nil;
// Get the JSON data from the website
id result = [NSJSONSerialization JSONObjectWithData:receivedData options:kNilOptions error:&error];

if ([result isKindOfClass:[NSArray class]]) {

    for (NSArray *item in result) {
        NSArray *category = [item valueForKey:@"CategoryName"];
        [dataArray addObject:category];
    }
}
else {
    NSDictionary *jsonDictionary = (NSDictionary *)result;

    for(NSDictionary *item in jsonDictionary)
        NSLog(@"Item: %@", item);
}

[self.tableView reloadData];

NSLog(@"Finished");} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T04:10:14.587

我相信你有一条错误线

```
receivedData = [[NSMutableData alloc] init]; 
```

每次您收到数据时，您都会再次初始化您的对象。

我为您的 JSON 部分推荐此页面[http://nsscreencast.com/episodes/6-afnetworking](http://nsscreencast.com/episodes/6-afnetworking)。

# java - 如何更新 JTable 中 DefaultTableModel 的行？

> ID：11148339
> 
> 赞同：3
> 
> 时间：2012-06-21T23:37:27.507
> 
> 标签：java, swing, jtable, jframe

好的，我已将此表添加到添加到 JFrame 的 JPanel 中。

在 mousePressed 事件中，它设置了一个新类 tData 并调用一个方法，该方法将数据库中的数据作为包含在向量元素中的字符串返回。

我想要发生的事情，每次按下 btn 时都会更新表格，

会发生什么，每次按下 btn 时，它都会更新表，但会将相同的数据添加到表的末尾？

什么会导致这种情况发生？

```
 Object columnHeaders[] = {"Fname", "Mname", "Lname", "Age"};
    Object data[][] = {{}};
    final DefaultTableModel dtm = new DefaultTableModel(data, columnHeaders);

    JTable tb = new JTable(dtm);
    JScrollPane scrollPane = new JScrollPane(tb);

    tableWrap.add(scrollPane);

    btn.addMouseListener(new MouseAdapter() {

        @Override 
        public void mousePressed(MouseEvent arg0) {
            tData h = new tData(10));
            Vector<String> v = h.getInfo();
            for(int i = 0; i < v.size() ; i++) {
                dtm.insertRow(i, new Object[]{v.get(i).split(",")[0], v.get(i).split(",")[1], v.get(i).split(",")[2], v.get(i).split(",")[3]});
            }

            dtm.fireTableDataChanged();
            frame.repaint();
        }
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T08:35:08.957

这里有几个问题：

1.  每当按下该按钮时，您似乎都需要更新整个表格。您在这里有三个选项：使用 更新 DefaultTableModel `setDataVector`，从头开始重新创建新模型并将其设置在 JTable 上，基于并触发适当的 TableModel 事件`setModel`实现您自己的。您也可以使用and更新模型，但这将非常无效，因为它会触发许多事件。`TableModel``AbstractTableModel``addRow``removeRow`

2.  要侦听“按下按钮”事件，而不是用户`ActionListener`（并使用添加它`addActionListener`）或操作（并使用设置它`setAction`）。

3.  在 DefaultTableModel 中，当您修改结构时，不需要手动调用`fireTableDataChanged();`. 每当您修改基础数据时，它都会自动触发适当的 TableModel 事件。也不要打电话`frame.repaint()`，这没用而且很费时间。

4.  *不相关*：考虑遵循[Java 编码约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconvtoc-136057.html)（类名以大写字母开头）和有意义的变量名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:04:07.070

您在此处编写的代码存在很多问题。首先，让我们解决您在 mousePressed 方法中使用代码时遇到的问题：

您从提供代码的数据中获取向量，然后使用新数据设置表的第 0...n 行。这样做的方法是编写一个[AbstractTableModel 的自定义扩展，](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)当按下按钮时返回你需要的数据。

另一个问题是您处理按钮按下的方式。向按钮添加鼠标侦听器绝对不是正确的处理方法。您想向按钮添加一个 ActionListener。每当按下和释放按钮时，都会触发该侦听器。

# php - 在 URL 中编写语言 格式为：(lang).website.com（如维基百科）

> ID：11148347
> 
> 赞同：1
> 
> 时间：2012-06-21T23:38:46.820
> 
> 标签：php

我认为 Wikipedia 在其 URL 中使用了一种很好的语言编写方式：

```
http://en.wikipedia.org/wiki/Main_Page
http://de.wikipedia.org/wiki/Main_Page
http://fr.wikipedia.org/wiki/Main_Page 
```

（语言在网站名称之前）

有什么方法可以编写这样的语言，还是非常复杂，例如每种语言的页面？我真的很想把它作为一个参数传递，然后我可以用它来设置内容的语言。

我一直在研究一些 httpd 的东西，其中包括像维基百科那样的 AddLanguage，但我不明白它是如何工作的或它做了什么。

我对 httpd 和 PHP 都不是很有经验，所以可能有更好的方法来做到这一点。

我将不胜感激任何帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:46:47.240

我无法验证 Wikipedia 是否以这种方式处理它（我怀疑它在那里要复杂得多），但对于一个简单的站点，您可以使用 DNS 中的通配符域、简单的 URL 重写[`gettext()`](http://www.php.net/manual/en/function.gettext.php)或其他国际化方法来完成此操作。

您的通配符域将注册为`*.example.com`. 使用支持 URL 重写的 Web 服务器，匹配第一个子域组件，并将其作为查询字符串参数传递给 PHP。这是一个使用 Apache mod_rewrite 的示例：

```
# Example apache rewrite subdomain to lang parameter:
RewriteEngine On
# Capture the language subdomain in %1
RewriteCond %{HTTP_HOST} ^([a-z]+)\.example\.com$ [NC]
# And pass the language into PHP as the lang= querystring param
RewriteRule ^(.*)$ index.php?lang=%1 
```

在 PHP 中，检索语言`$_GET['lang']`并使用它在您的国际化方案中切换语言。

对于像维基百科这样的东西，他们很可能在他们的数据库中存储了多语言翻译的同一篇文章。如果您只是在 Web 应用程序上翻译字符串，则可以使用国际化函数来完成，例如`gettext()`或[`intl`](http://www.php.net/manual/en/book.intl.php)

如何处理内容的国际化完全取决于您。这里的重要部分是通配符子域可用于在语言之间切换。

# java - 设置文本颜色错误

> ID：11148348
> 
> 赞同：0
> 
> 时间：2012-06-21T23:38:48.213
> 
> 标签：java, text

我刚开始使用 eclipse 并且没有使用 java 的经验，但是我正在学习教程并且遇到了这个文本颜色问题。我得到的错误说 RED 无法解决或不是一个字段。这是代码，感谢所有帮助。

```
case R.id.myRadioButtonRed: myMessage.setTextColor(Color.RED); break; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:49:06.513

通过 R.id.myRadioButtonRed 看起来这是一个 Android 项目。在 Android SDK 中 java.awt.Color 不存在。你需要使用[android.graphics.Color](http://developer.android.com/reference/android/graphics/Color.html)

# java - 重置连接后自动重新连接同一端口的最简单方法是什么？- 爪哇

> ID：11148349
> 
> 赞同：1
> 
> 时间：2012-06-21T23:38:49.903
> 
> 标签：java

我正在阅读[来自 Oracle 的 Knock Knock Server and Client](http://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html)教程。我正在一台计算机上对其进行测试，并且我想在同一端口上添加将自动重新连接（理想情况下不会丢失笑话中的“进度”）的功能。

我有点糊涂，因为我一直在看到当我使用 TCPView 关闭连接时会发生什么（我认为这是在单台计算机上模拟客户端失去与服务器的连接的最简单方法），但 SocketException 似乎出现在 KnockKnockProtocol 类中。告诉程序尝试使用相同端口重新连接客户端的最基本方法是什么。我真的不知道如何制作比上面链接的 Oracle 示例更简单的 SSCCE。

我无法确定我应该在这里调查的内容。

# javascript - JavaScript 范围和执行上下文

> ID：11148353
> 
> 赞同：6
> 
> 时间：2012-06-21T23:39:07.710
> 
> 标签：javascript, scope, executioncontext

我正在尝试了解 JavaScript 范围规则。我在教科书和文档中读到的内容令人困惑。

在我看来，JavaScript 是一种静态（或词法）范围的语言 - 当试图将变量名绑定到变量（定义）时，会使用代码的词法结构。

执行上下文似乎类似于调用堆栈上的堆栈帧。每个执行上下文都有一个变量对象，所有局部变量（相关函数的）都在该变量对象上定义。这些变量对象链接在一起以提供从堆栈顶部的变量对象到堆栈底部的变量对象（窗口对象）的“范围链”。在将变量名称绑定到变量时，从上到下搜索此范围链。这与 C/C++/Java 等静态范围语言非常相似。

与 C/C++/Java 相比，似乎有一个重要的区别——可以访问在堆栈帧不再位于调用堆栈上的函数中定义的变量，如下例所示：

```
var color = "red";
var printColor;

function changeColor() {
    var color = "green";

    printColor = function(msg) {
        alert(msg + color);
    }
    printColor("in changeColor context, color = ");  // "green"
}

changeColor();

// stack frame for "changeColor" no longer on stack
// but we can access the value of the variable color defined in that function

printColor("in global context, color = ");  // "green" 
```

我做对了吗？还有其他我应该注意的问题吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T23:54:14.277

这确实是 C/C++ 和 JavaScript 之间的一个主要区别：JavaScript 是一种引用计数、垃圾收集的语言，这意味着当对象不再有任何对它们的引用时，它们可以被引擎回收。您分配给的函数`printColor`本身并不在堆栈上，就像在 C 或 C++ 中那样；它是动态分配的，然后分配给当前范围之外的变量。因此，当控制流从 中返回时 `changeColor`，匿名函数的引用计数仍然为**1** ，因为外部`printColor`引用了它，因此它可以在外部范围内使用。

因此，您的示例并不是一个范围界定问题——很明显， 您`printColor` *在*`changeColor`. 当您定义 `changeColor`时，它 会将 upvalue [关闭](http://en.wikipedia.org/wiki/Closure_%28computer_science%29)`printColor`到新函数范围内，使其可访问。就像 **Combat**所说的那样，如果您将 a 添加`var`到 的第二个内部定义中 `printColor`，它将遮盖 [*您*](http://en.wikipedia.org/wiki/Variable_shadowing)声明的第一个 定义，`printColor`并且在该功能块之外无法访问它。

至于其他需要注意的问题，是的，有很多，但是请参阅我对您原始帖子的评论以获得良好的开端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-18T09:01:49.203

它总是归结为词法作用域，即函数在定义时使用其作用域链执行，而不是在调用时。

匿名函数是在函数 changeColor 的局部范围内定义的，而不是在全局范围内。因此，当它再次执行时，它会打印出列在函数 changeColor 的本地范围内的绿色。

# c++ - 是在我们使用基指针新建派生类时调用的构造函数

> ID：11148354
> 
> 赞同：1
> 
> 时间：2012-06-21T23:39:09.367
> 
> 标签：c++, inheritance, constructor, destructor

```
Class Shape {
    virtual Shape() = 0;
    virtual ~Shape() = 0;
}

Class Circle : Public Shape {
    Circle();
    ~Circle();
    // Something ...
}

int main () {
Shape* s = new Circle();
delete s;
} 
```

是不是在调用 Circle 的构造函数？即使它是Shape的构造的不同名称？当你删除s时，你是在调用Circle的析构函数吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:25:05.943

在 C++ 中，构造函数不能是虚拟的。

您提供的代码不是有效的 c++。

这是更正后的代码，您可以在这里看到它运行：http: [//codepad.org/2fDc4S3e](http://codepad.org/2fDc4S3e) 程序的输出应该回答您所有的问题。我建议您使用代码来回答您可能遇到的任何其他问题。

```
class Shape {
public:
    virtual ~Shape() = 0;
};

Shape::~Shape() { std::cout << "Shape dtor called" << std::endl;} // Since you declared the destructor pure virtual you must define it

class Circle : public Shape {
public:
    Circle() { std::cout << "Circle ctor called." << std::endl; }
    ~Circle() { std::cout << "Circle dtor called." << std::endl; }
    // Something ...
};

int main () 
{
  Shape* s = new Circle(); // This will call the constructor of Circle
  delete s; // This will call the destructor of Circle and then the dtor Shape.
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T06:24:20.297

是的，Circle 的 dtor 将被称为：

*   因为 Shape 的 dtor 是虚拟的，所以任何从它继承的类都会有一个虚拟的 dtor。
*   这意味着 dtor 不是直接调用，而是通过 v-table 调用：当您“删除 s”时，它调用 s.dtor()，它调用 v-table 中的正确项目，即 Circle 的 dtor。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T06:29:15.540

构造函数不能是虚拟的。

```
class Shape {
    virtual ~Shape() = 0;
};

class Circle : public Shape {
    Circle() {};
    ~Circle() {};
};

int main() {
    Shape *s = new Circle();
    delete s;
} 
```

是的，`new Circle()`调用 Circle 的构造函数。这是因为表达式`new <type><optional initializer>`分配了足够的内存，然后通过调用适当的构造函数（或其他非类类型的初始化）对其进行初始化。这一点不需要是虚拟的，因为您已经明确声明了最派生的类型。

的结果`new Circle()`是一个指向圆的指针。将此类型分配给指向 Shape 类型指针的变量涉及隐式转换。转换的结果是指向 Circle 的基本 Shape 子对象的指针。同样，这一切都不是虚拟的，因为 Shape 不是虚拟基础，它只是一个常规基础对象，并且它在 Circle 内的位置是静态已知的。

`delete s`确实调用了 Circle 析构函数。这确实使用了虚拟调度。编译器知道它正在删除一个 Shape，并且 Shape 的析构函数是虚拟的，因此它会查找适当的析构函数 is`~Circle()`并调用它。如果 Shape 的析构函数不是虚拟的（并且实际上在某处有定义），则不会这样做，只有 Shape 对象会被破坏，而不是 Circle 对象，并且释放可能无法正确完成。行为将是未定义的。

# c++ - 迭代器和引用计数字符串

> ID：11148355
> 
> 赞同：7
> 
> 时间：2012-06-21T23:39:09.123
> 
> 标签：c++, stl, copy-on-write

如果我们考虑使用引用计数的 std::string 实现，请考虑以下场景：

```
int main()
{
  string english = "Hello";
  string german  = english; //refcnt = 2
  string german2 = german;

  /* L1 */ german[1] = 'a';
  /* L2 */ *(german2.begin() + 1) = 'A';

  cout << english << endl << german << endl << german2 << endl;
  return 0;
} 
```

L1 和 L2 会发生什么？引用计数是否中断并执行了深层复制？我是这么认为的，但我担心的是，如果发生这种情况，请执行以下简单操作：

```
cout << german[1] << endl; 
```

或者一个简单的：

```
cout << *(german.begin()) << endl; 
```

在非常量上下文中会执行不必​​要的深度复制。我对吗？实现如何处理这个细节？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T23:59:23.043

你是对的，在所有四个示例（L1、L2 和下面的两个）中都会制作一个副本，即使对于后两个是不必要的。

不幸的是，当调用 operator[] 的非常量版本或取消引用非常量迭代器时，实现无法判断生成的非常量引用是否将用于修改对象，因此它必须安全行事并制作副本。

C++11 向字符串和其他容器添加了函数`cbegin()`和`cend()`返回 const 迭代器，即使在非 const 对象上调用也是如此。这有助于缓解问题。我不知道 operator[] 的类似解决方案。

注意：正如其他一些回答者所建议的那样，让 operator[] 或迭代器的 operator*() 返回代理类型并不是真正的选择，因为它违反了容器要求，其中之一是这些函数返回实际引用。（这就是为什么现在每个人都同意这`vector<bool>`是一个错误的原因——它以这种方式使用代理）。

（当然，如果您正在编写自己的引用计数类，那么没有什么能阻止您使用代理类型来实现这一点。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T23:59:19.510

实现此目的的一种方法是通过代理类。因此，当您索引字符串而不是获取字符时，您会得到一个看起来和感觉都像字符的对象。当对其执行写入时，它会导致原始字符串的深层复制。

# version-control - PHP应用程序的FTP文件部署和管理

> ID：11148362
> 
> 赞同：0
> 
> 时间：2012-06-21T23:39:45.577
> 
> 标签：version-control, ftp, continuous-integration, dreamweaver, netbeans-7

所以几年来，我一直是一个单人团队的开发人员。我开始认识到将所有设计、html 和 css 工作交给更有天赋的人的好处，所以我创办了一家公司，由其他长期局限于静态网站的单人团队组成（看起来很漂亮）。你可以想象接下来会发生什么。

我们一直在使用 Zend Framework（用于大多数应用程序的 PHP 应用程序，它将大部分视图代码与业务和数据层分开，但有时设计师或前端人员之一必须修改模型或视图脚本，而我'我开始为谁在更新什么文件以及何时更新而产生协调噩梦，因此我们不会覆盖任何人在开发环境中的重要更改。（显然在生产部署之前等待稳定性）

我在本地使用 NetBeans，而其他人使用 Dreamweaver。我正在寻找的是一种可以管理开发服务器上的文件版本的工具，允许签入/签出，因此没有人同时处理同一个文件。（或者更好的是，合并更改）

关于一个好的工具有什么建议吗？CI 工具更好还是 VCS 工具更好？我能想到的唯一其他选择是直接在开发服务器上工作，部署到 simprod 环境，而不是在测试之后转移到 prod，但我喜欢能够在将某些东西放到互联网上之前在防火墙后面进行开发。任何建议都会有所帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:42:30.060

您正在寻找[git](http://git-scm.com/)。非常适合管理版本和分支，部署到开发或生产服务器，几乎任何你可以扔给它的东西。

# asp.net - Asp.net 编写服务器端文件

> ID：11148364
> 
> 赞同：0
> 
> 时间：2012-06-21T23:40:02.170
> 
> 标签：asp.net

需要编写一个服务器文本文件作为由 ASP.net 应用程序启动的业务流程的输出。文本文件编写代码位于使用标准流代码的库文件中

在 IDE 中一切正常。

发布并尝试写入文件时失败。IIS 不愿意写入文件系统。

到处翻找和拉头发终于找到了解决办法。它并不漂亮，仅适用于您可以控制 Web 服务器的情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:40:03.247

解决方案是：在网络服务器上创建一个物理目录，物理路径为：c:\inetpub\wwwroot\mywebapp\myOutputFileDirectory

创建一个指向该目录的虚拟目录。

使用 Windows 资源管理器将物理目录的写入权限授予 IIS_IUSRS。

在 Streamwriter 代码中使用 c:\inetpub\wwwroot\mywebapp\myOutputFileDirectory 的物理路径

如果您对安全性进行了分类，那么虚拟路径可能会指向 LAN 中更明智的地方，但我已经受够了以感激接受这个小小的面包屑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T23:52:39.153

刚看到你的回答。

它不需要在您的*inetpub*或*wwwroot*目录中，它可以在任何地方，只要为运行应用程序的用户正确设置了安全权限。

但这实际上是需要的。如果不只是想象允许在任何地方进行写访问的后果。

此外，不需要虚拟目录。您可以创建一个像 C:\ProcessOutput 这样的目录，并相应地授予权限，它应该可以正常工作。另一种选择是创建一个服务帐户，并仅在您需要编写该输出文件时在您的应用程序中模拟该用户。

# html - HTML5 文档类型并不神奇，对吧？

> ID：11148372
> 
> 赞同：1
> 
> 时间：2012-06-21T23:40:46.883
> 
> 标签：html, jquery-mobile, doctype

我们有一些承包商在做一个移动项目，他们一直坚持我们必须使用 HTML5 doctype 才能使用任何 HTML5 功能，比如 doctype 是一个很棒的大布尔开关。我不得不一直告诉他们 doctype 真的没那么重要。`application/xhtml+xml`您可以在具有 XHTML 1.1 Strict 文档类型的页面上使用 HTML5 输入类型和触摸事件，而浏览器可能不太关心。同样，您可以将`<center>`标签与 HTML5 文档类型一起使用，文本将居中。

显然，对于低版本的 IE 进入怪癖模式有一些警告，但这不是我们范围内的问题。我个人并不关心他们使用什么 doctype，但对他们对此完全缺乏了解感到困扰。至少，在我看到[jQuery Mobile 页面设置文档](http://jquerymobile.com/demos/1.1.0/docs/pages/page-anatomy.html)之前：

> 一个 jQuery Mobile 站点必须以 HTML5 'doctype' 开头，以充分利用该框架的所有功能。（使用不理解 HTML5 的浏览器的旧设备将安全地忽略“文档类型”和各种自定义属性。）

HTML5 是否有任何需要新文档类型的功能？该文档是错误的，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:08:26.340

就在台式机和笔记本电脑上运行的常见 Web 浏览器而言：浏览器不太关心 doctype - 即使您的 doctype 说不允许使用新功能，它也会使用它们。doctype 真的是为验证者准备的；除非您使用的文档类型允许您使用的功能，否则您的页面将无法验证。

我实际上不能代表移动设备，因为我几乎没有使用它们的经验，但看起来它们的工作方式相似，因为它们使用相同的浏览器渲染引擎并尝试访问相同的 Internet。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T08:54:52.823

除了将页面置于标准模式之外，浏览器不会做任何神奇的事情`<!DOCTYPE html>`，因此它等同于执行相同操作的任何其他文档类型。

然而，它在 JavaScript 中是一个可测试的对象，所以*可以想象*一段 JS 可以做一些愚蠢的事情，比如根据给定 doctype 的存在与否来切换它的行为。如果不逐行查看代码，就不可能知道 jQuery Mobile 页面设置文档中的陈述是否特别正确，或者只是一般建议，如果遵循将导致预期结果。

# sql - 用两个 Where 子句计算两列

> ID：11148374
> 
> 赞同：0
> 
> 时间：2012-06-21T23:40:54.933
> 
> 标签：sql, teradata

我知道现在已经很晚了，我的大脑只是油炸了....

使用 Teradata，我需要在过去六个月中`COUNT DISTINCT` `MEMBERS`没有过，以及他们历史上拥有的数量（在六个月之前）。我们可以假设截止日期为 01/01/2012。所有表都包含在一个表中。`TRANS``COUNT``TRANS`

例如：

> 会员 | 交易日期
> 
> 123 | 2011 年 1 月 1 日
> 
> 第789章 2011 年 6 月 1 日
> 
> 123 |2011 年 10 月 31 日
> 
> 第678章 2011 年 4 月 3 日
> 
> 第789章 2012 年 6 月 1 日

因此，2 个成员在 2012 年 1 月 1 日之前总共有 3 笔交易，而在 2012 年 1 月 1 日之后没有交易。

在这个例子中，我的结果是：

> 会员 | 反式
> 
> 2 | 3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:01:15.040

您不能在一条 SQL 语句中完成。使用子查询。这是 TSQL，因为我不熟悉 Teradata。

```
DECLARE @CUTOFF DATETIME = DATEADD(MO,-6,GETDATE()) --6MTHS AGO
SELECT COUNT(MEMBERID) AS MEMBERS, SUM(TRANSCOUNT) AS TRANS FROM (
SELECT DISTINCT 
  MEMBERID, 
  (SELECT COUNT(*) TRANSDATE WHERE TRANSDATA.MEMBERID = MEMBER.MEMBERIF) AS TRANSCOUNT
FROM MEMBER WHERE NOT EXISTS 
  (SELECT * FROM TRANSDATA, MEMBER WHERE 
     TRANSDATA.MEMBERID = MEMBER.MEMBERIF 
     AND TRANDATE > @CUTOFF)
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:05:30.850

试试这个解决方案：

```
SELECT
    COUNT(DISTINCT member_id) AS MEMBERS,
    COUNT(*) AS TRANS
FROM
    tbl
WHERE 
    member_id NOT IN
    (
        SELECT DISTINCT member_id
        FROM tbl
        WHERE trans_date > '2012-01-01'
    ) 
```

# python - SCAR 的 Python 等价物

> ID：11148378
> 
> 赞同：2
> 
> 时间：2012-06-21T23:41:30.563
> 
> 标签：python, macros

我目前使用一个名为“SCAR”的小程序来构建小宏，当我有重复的任务并且我感到很懒惰时。“SCAR”旨在在屏幕上查找颜色以执行任务。它的问题是我发现它的 Delfi/Pascal 复合语言使用起来很烦人，所以我希望可能有一个 python 等价物。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:01:46.427

你可能想看看这个：

[http://code.google.com/p/swapy/](http://code.google.com/p/swapy/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:40:59.397

您可能想看看[https://github.com/WarPie/MacPy](https://github.com/WarPie/MacPy) 这是一个使用 Python 2.7 的基于颜色（仅限 Windows）的可编写脚本的宏。没有 gui，但它很简单，但非常实用，只需看一下“test.py”示例，尝试运行它...

它没有记录，但您可能需要的每个功能都在文件中 -> MacPy/Inc/MacPy.py

# javascript - jQuery - 获取字符串的一部分

> ID：11148380
> 
> 赞同：0
> 
> 时间：2012-06-21T23:41:48.230
> 
> 标签：javascript, jquery

在 JS/jQuery 中，我需要剥离 YouTube 嵌入代码以仅显示 SRC 值。这怎么可能？

嵌入代码，例如：

```
string = "<iframe width="630" height="354" src="https://www.youtube.com/embed/NYjPglsyYZA?rel=0" frameborder="0" allowfullscreen></iframe>" 
```

我希望抓住 和 之间的`src="`一切`"`。我在想也许正则表达式会做到这一点，但不太确定......

任何建议都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T23:43:56.787

尝试 ：

```
var str='<iframe width="630" height="354" src="https://www.youtube.com/embed/NYjPglsyYZA?rel=0" frameborder="0" allowfullscreen></iframe>'; 
var src = $(str).attr("src"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T23:48:59.493

在 jQuery 中：

```
$('iframe:first').attr('src'); 
```

在纯 JavaScript 中：

```
document.getElementsByTagName('iframe')[0].src; 
```

* * *

**更新**

从字符串开始，使用 jQuery：

```
string = '<iframe width="630" height="354" src="https://www.youtube.com/embed/NYjPglsyYZA?rel=0" frameborder="0" allowfullscreen></iframe>';
var src = $(string).attr('src'); 
```

并且没有 jQuery：

```
string = '<iframe width="630" height="354" src="https://www.youtube.com/embed/NYjPglsyYZA?rel=0" frameborder="0" allowfullscreen></iframe>';
var div = document.createElement('div');
div.innerHTML = string;
var src = div.firstChild.src;

alert(src); 
```

​</p>

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-21T23:48:42.273

[http://www.w3schools.com/jsref/jsref_match.asp](http://www.w3schools.com/jsref/jsref_match.asp)

试试这个

```
var str='<iframe width="630" height="354" src="https://www.youtube.com/embed/NYjPglsyYZA?rel=0" frameborder="0" allowfullscreen></iframe>'; 
var n=str.match(/src="(.*)"/);
var result = n.substring(5,n.length()-1); 
```

# java - 如何使用 Spring-data-Redis 实现 Redis Multi-Exec

> ID：11148383
> 
> 赞同：13
> 
> 时间：2012-06-21T23:42:11.977
> 
> 标签：java, spring, redis, spring-data

所有 Spring 配置均已正确编写。非 Multi-Exec Redis 操作完美运行。

```
@Autowired
@Qualifier("stringRedisTemplate")
StringRedisTemplate template;

void test(){
  template.multi();
  template.boundValueOps("somevkey").increment(1);
  template.boundZSetOps("somezkey").add("zvalue", timestamp);
  template.exec();
} 
```

通过 Junit Test 运行上述代码后，抛出异常。

```
 org.springframework.data.redis.RedisSystemException: Unknown exception; nested exception is org.springframework.data.redis.RedisSystemException: Unknown jedis exception; nested exception is java.lang.NullPointerException
        at org.springframework.data.redis.connection.jedis.JedisUtils.convertJedisAccessException(JedisUtils.java:93)
        at org.springframework.data.redis.connection.jedis.JedisConnectionFactory.translateExceptionIfPossible(JedisConnectionFactory.java:155)
        at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:58)
        at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:213)
        at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:163)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
        at $Proxy66.appendUserStream(Unknown Source)
        at com.uniu.test.repository.StreamCacheRepositoryTest.testAppendUserStream(StreamCacheRepositoryTest.java:23)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
        at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
        at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
        at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
        at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
        at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
        at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
        at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
        at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
        at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
        at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
        at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
        at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:49)
        at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
    Caused by: org.springframework.data.redis.RedisSystemException: Unknown jedis exception; nested exception is java.lang.NullPointerException
        at org.springframework.data.redis.connection.jedis.JedisConnection.convertJedisAccessException(JedisConnection.java:119)
        at org.springframework.data.redis.connection.jedis.JedisConnection.exec(JedisConnection.java:523)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.springframework.data.redis.core.CloseSuppressingInvocationHandler.invoke(CloseSuppressingInvocationHandler.java:58)
        at $Proxy70.exec(Unknown Source)
        at org.springframework.data.redis.core.RedisTemplate$1.doInRedis(RedisTemplate.java:416)
        at org.springframework.data.redis.core.RedisTemplate$1.doInRedis(RedisTemplate.java:412)
        at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:162)
        at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:133)
        at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:121)
        at org.springframework.data.redis.core.RedisTemplate.exec(RedisTemplate.java:412)
        at com.uniu.repository.impl.StreamCacheRepositoryRedisImpl.appendUserStream(StreamCacheRepositoryRedisImpl.java:37)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
        at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:155)
        ... 33 more
    Caused by: java.lang.NullPointerException
        at redis.clients.jedis.BinaryTransaction.exec(BinaryTransaction.java:31)
        at org.springframework.data.redis.connection.jedis.JedisConnection.exec(JedisConnection.java:521)
        ... 54 more 
```

我查看了redis服务器，上面两条命令都执行过了，结果是正确的。所以问题出现在代码的最后一行（template.exec()）。当底层 JedisClient 尝试从 EXEC 获得多批量响应时，似乎抛出 NullPointerException

我使用 spring-data-redis 1.0.0.RELEASE 谢谢帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-01T15:26:25.687

异常的原因可能是 Spring 模板实现没有为`.multi()`和重用相同的连接`.exec()`。您可以尝试`execute()`通过回调使用：

```
private RedisTemplate template = ...;

template.execute(

  new RedisCallback() {

    @Override
    public Object doInRedis(RedisConnection connection)
      throws DataAccessException {

      connection.multi();

      //do whatever you need, like deleting and repopulating some keys

      connection.expire(CHANNEL_KEY.getBytes(), EXPIRE_SECS);
      connection.exec();
      return null;
    }

  }

); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-04-21T08:37:38.843

```
template.setEnableTransactionSupport(true); 
```

也许你可以用它来启用交易

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-10-17T20:09:06.147

彼得是对的。您需要将其放入 SessionCallback 中。

以下是使用 Spring Data Redis 进行事务的快速总结：

[https://github.com/eric-wu/dashboard/wiki/3.-Redis-Transactions-via-Spring-Data-Redis](https://github.com/eric-wu/dashboard/wiki/3.-Redis-Transactions-via-Spring-Data-Redis)

对于您的情况，向下滚动并查看“使用 WATCH、MULTI 和 EXEC 进行乐观锁定”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-06T18:05:46.913

看一下实现`org.springframework.data.redis.support.collections.CollectionUtils.rename(K, K, RedisOperations<K, ?>)`

[并在此处](https://redis.io/topics/transactions)阅读交易详情

```
static <K> void rename(final K key, final K newKey, RedisOperations<K, ?> operations) {
    operations.execute(new SessionCallback<Object>() {
        @SuppressWarnings("unchecked")
        public Object execute(RedisOperations operations) throws DataAccessException {
            do {
                operations.watch(key);

                if (operations.hasKey(key)) {
                    operations.multi();
                    operations.rename(key, newKey);
                } else {
                    operations.multi();
                }
            } while (operations.exec() == null);
            return null;
        }
    });
} 
```

**注意**：while循环很重要

# javascript - javascript没有得到正确的图像宽度和高度

> ID：11148384
> 
> 赞同：1
> 
> 时间：2012-06-21T23:42:19.357
> 
> 标签：javascript, html

我使用 HTML api 向我的网站添加了多个图像上传。我必须在上传时测试每张图片，无论它们是高（高>宽）还是长（高

```
<script type="text/JavaScript">
function filesProcess(files) 
{
  var shape=document.getElementById('shapeval').value;
  for( var i = 0; i < files.length; i++) 
    {
        file = files[i];
        if(!file.type.match(/image.*/)) 
            {

            alert('File name '+file.name+' is not allowed! Please try again!');

            window.location.reload(true);

                continue; //Jump forward to the next file...

                }
      else
        { 
                var iw=document.images[i].width;
            var ih=document.images[i].height;
            var n=document.images[i].name;
            if(shape="tall")
                {

                    alert("width:"+iw+" and height:"+ih);
                }
                else
                {

                    alert("width:"+iw+" and height:"+ih);
                }
            continue;
        }

    }

}
 </script> 
```

HTML

```
 <form action="upload.php/" method="post" enctype="multipart/form-data" name="uploadForm" onsubmit="return(validate());">
  <input type="file" id="files" name="files[]" multiple  onchange="filesProcess(this.files);" accept="image/*"/>
   <input type="hidden" name="shapeval" id="shapeval" value="tall" />
  </form> 
```

使用此代码显示宽度和高度，但它们的值不正确。大多数情况下，两种类型的图像都显示 182 和 51；所以我无法识别图像是高还是长？我哪里做错了？我错过了什么吗？有人知道吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T23:51:18.607

据我所知，您无法通过 Javascript 获取要上传的图像的高度或宽度。您需要将其上传到服务器，然后使用 PHP（或任何其他服务器端脚本语言）来获取有关图像的信息。试试 PHP 函数`getimagesize()`，它应该会给你你需要的信息。

如果您想内联处理图像并将信息回馈给用户，我建议您使用 AJAX 提交表单并使用响应数据。

# ios - 成功的 iOS SDK 照片上传不会显示在新闻提要上，但会显示在用户的墙上

> ID：11148389
> 
> 赞同：0
> 
> 时间：2012-06-21T23:42:50.260
> 
> 标签：ios, facebook-graph-api, upload, photo, feed

使用此标准代码：

```
NSMutableDictionary *params = [NSMutableDictionary dictionary];
[params setObject:image forKey:@"photo"];
[params setObject:text forKey:@"caption"];
[self.facebook requestWithGraphPath:@"me/photos"
                          andParams:params
                      andHttpMethod:@"POST"
                        andDelegate:self]; 
```

我能够成功地将照片发布到登录用户的时间线。不过，我还没有看到这张照片出现在关注该用户的人的新闻源中。对于我的图片上传应用程序，似乎应该在朋友的新闻提要中显示上传的照片。我可以做些什么来确保这张成功上传的照片被添加到用户的时间线**和**用户的朋友新闻源中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:52:20.943

我相信这是（故意）在 Facebook 的控制之下。您的照片可能会或可能不会出现在新闻提要中；它们也可能会出现，但会组合成一个项目。我认为没有任何方法可以强迫他们出现在新闻提要中。

# python - 支持python2.7.3的自制macvim不起作用

> ID：11148403
> 
> 赞同：5
> 
> 时间：2012-06-21T23:45:24.223
> 
> 标签：python, vim, macvim, homebrew

我用自制软件安装了 macvim，支持 python。我的咒语如下：

```
brew install macvim --override-system-vim 
```

现在，当我打开一个 python 文件时，如果我尝试导入任何东西，我会收到一系列错误。例如，如果`import re`我看到`ImportError: no module name re`.

安装后第一次打开macvim时，我进入`'import site' failed; use -v for traceback`了我打开macvim的终端。这是在运行我的第一个 python 命令之后。

这是什么意思，我该如何解决？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-02T20:04:23.323

我通过快速 hack 得到了这个，你可以暂时将系统 python 指向你喜欢的 python：

```
cd /System/Library/Frameworks/Python.framework/Versions
sudo mv Current Current-sys
sudo mv 2.7 2.7-sys
sudo ln -s /usr/local/Cellar/python/2.7.9/Frameworks/Python.framework/Versions/2.7 Current
sudo ln -s /usr/local/Cellar/python/2.7.9/Frameworks/Python.framework/Versions/2.7 2.7

brew rm macvim # optionall, only if you had it installed previously  
brew install macvim --override-system-vim

sudo mv Current-sys Current
sudo mv 2.7-sys 2.7 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T01:58:55.700

我的猜测是你应该像这样将 homebrew 安装文件夹添加到你的 .bash_profile 中：

```
export PATH=/usr/local/bin:/usr/local/sbin:usr/local/Cellar/python/2.7.3/bin:$PATH 
```

之后在shell“source .bash_profile”中写入，以便重新加载。还请检查输出

```
which python 
```

确保您使用的是自制 python

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T17:20:33.100

我最终放弃了自制选项并使用此处建议的答案：

[vim 使用错误的 python 版本编译（并且不使用所需的版本）](https://stackoverflow.com/questions/7294554/vim-compiles-with-wrong-python-version-and-not-working-with-needed-version/9566769#9566769)

很遗憾，这似乎无法通过 brew 完成。看起来有人需要修补 macvim 发行版本身。

# parsing - 很好的例子：英语解析/自然语言处理

> ID：11148405
> 
> 赞同：5
> 
> 时间：2012-06-21T23:45:32.717
> 
> 标签：parsing, nlp, stanford-nlp

我想制作一个日历应用程序，它比现有的更好地接受纯英文输入。我发现斯坦福的 NLP 看起来很酷，但我想知道它是否对这类任务有帮助。我找不到人们将它用于任何事情的例子。应用程序是否应该真正理解该语言？似乎存在的自然英文日历正在寻找关键字/模式并尝试以这种方式解析，但我认为应用程序可以做得更好。

我真正的问题：有人能告诉我如何找到人们使用 NLP 或不同（公开可用的）英语解析器来制作真正有用的应用程序的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T18:30:48.390

查看[NLTK](http://nltk.org/)。

> NLTK 是用于构建 Python 程序以处理人类语言数据的领先平台。它为超过 50 个语料库和词汇资源（如 WordNet）提供易于使用的接口，以及一套用于分类、标记化、词干提取、标记、解析和语义推理的文本处理库。

[使用 NLTK 解析的](http://nltk.googlecode.com/svn/trunk/doc/book/book.html#parsing-with-context-free-grammar)示例：

```
>>> import nltk
>>> rd_parser = nltk.RecursiveDescentParser(grammar)
>>> sent = 'Mary saw a dog'.split()
>>> for t in rd_parser.nbest_parse(sent):
...     print t
(S (NP Mary) (VP (V saw) (NP (Det a) (N dog)))) 
```

NLTK 提供了一本很棒的免费书籍，可在线获取：http: [//nltk.googlecode.com/svn/trunk/doc/book/book.html](http://nltk.googlecode.com/svn/trunk/doc/book/book.html)

IBM 的一个很好的概述：http: [//www.ibm.com/developerworks/linux/library/l-cpnltk/index.html](http://www.ibm.com/developerworks/linux/library/l-cpnltk/index.html)

PS：另一个与您类似的 SO 问题：[Using integers/dates as terminal in NLTK parser](https://stackoverflow.com/q/4148171/395857)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-26T00:56:07.383

几年后，围绕 NodeJS 的 NLP 出现了重要的新兴技术。有关情况的更多概述，请参见此处：[http ://www.quora.com/Are-there-any-JavaScript-natural-language-processing-projects](http://www.quora.com/Are-there-any-JavaScript-natural-language-processing-projects)

但是，这里是 +1 问题的示例，因为我也在寻找同样的问题……就在几年后。

NLP 的工作示例......在 JavaScript 中？

这是我的答案...

步骤 1 - 样板节点服务器：

```
install npm

npm install nodebootstrap

nodebootstrap naturalNode

cd naturalNode && npm install

node app 
```

//这应该会给你一个在 localhost:3000 运行的节点引导应用程序

有关简单节点服务器设置的完整信息，请访问此处：[https ://github.com/stonebk/nodeboilerplate](https://github.com/stonebk/nodeboilerplate)

第 2 步 - 包括自然图书馆：

前往 GitHub Natural Library 看看它可以做什么......

[https://github.com/NaturalNode/natural](https://github.com/NaturalNode/natural)

跑：

```
npm install natural 
```

（在名为 naturalNode 的引导服务器中）

第 3 步 - 运行示例：

将上面链接中的示例代码包含到 app.js 引导文件中。

```
var natural = require('natural'),
  tokenizer = new natural.WordTokenizer();
console.log(tokenizer.tokenize("your dog has fleas."));
// [ 'your', 'dog', 'has', 'fleas' ] 
```

现在，当您运行服务器时，您可以完全访问自然库，并能够使用前端接口对其进行扩展。

如果缺少任何说明，请告诉我...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-06-12T15:34:13.503

有许多有用的 NLP 库可用，例如 Spacy、NLTK 和 CoreNLP

以下是与 NodeJS 和 Javascript 一起使用的前 2 个 NLP 库以及示例：

# 1 NLP.js

Github：[https ://github.com/axa-group/nlp.js](https://github.com/axa-group/nlp.js)

NLP.js 由 AXA 集团开发。它是一个用于构建机器人的 NLP 库，具有实体提取、情感分析、自动语言识别等功能，支持 40 种语言。

这是一个基本代码片段，可帮助您了解设置它的难易程度。

常量 { NlpManager } = 要求（'node-nlp'）; const manager = new NlpManager({ 语言：['en'] });

// 添加 NLP 的话语和意图 manager.addDocument('en', 'goodbye for now', 'greetings.bye'); manager.addDocument('en', '再见了保重', 'greetings.bye');

// 也训练 NLG manager.addAnswer('en', 'greetings.bye', 'Till next time'); manager.addAnswer('en', 'greetings.bye', '再见！');

// 训练并保存模型。(async() => { await manager.train(); manager.save(); const response = await manager.process('en', '我现在该走了'); console.log(response); })( );

# 2 自然

Github：[https ://github.com/NaturalNode/natural](https://github.com/NaturalNode/natural)

Natural 是另一个著名的 Node.js NLP 库。“Natural”是 Node.js 的通用自然语言工具。它目前支持标记化、词干提取、分类、语音学、tf-idf、WordNet、字符串相似度和一些变形。

变种自然 = 要求（“自然”）；var tokenizer = new natural.WordTokenizer(); console.log(tokenizer.tokenize("你的狗有跳蚤。")); // ['你的'，'狗'，'有'，'跳蚤']

console.log(natural.HammingDistance("karolin", "kathrin", false)); console.log(natural.HammingDistance("karolin", "kerstin", false)); // 如果字符串长度不同，则返回 -1

此处提供更多库和示例代码： [https ://www.kommunicate.io/blog/nlp-libraries-node-javascript/](https://www.kommunicate.io/blog/nlp-libraries-node-javascript/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T15:48:02.150

由于您没有指定任何编程语言，我建议使用名为[Natty](http://natty.joestelmach.com/)的 Java 库。如果他知道的话，你可以向它的作者询问使用他的库的实际应用程序。

# azure - windows azure网站预览A记录专用IP

> ID：11148407
> 
> 赞同：1
> 
> 时间：2012-06-21T23:45:48.233
> 
> 标签：azure, dns, azure-web-app-service

所以我在 windows azure 网站预览上有一个保留实例。我想直接将我的域指向它，而不仅仅是我看到人们推荐的**www .mydomain.com CNAME 记录。**我在**www**上的 CNAME工作得很好。但是，当您访问“mydomain.com”而不是“www.mydomain.com”时，它不会访问我的 azure 网站。

有没有办法让 DNS“A”记录指向天蓝色的网站？我找不到任何可以为我提供 IP 地址的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T06:44:38.087

它现在在 Windows Azure 中受支持。如果您使用保留实例，则可以通过`Manage Domains`控制面板底部的按钮对其进行配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T01:33:44.157

据我所知，不，您无法获得 Windows Azure 网站的静态 IP 地址，因此您无法设置 A 记录。标准做法是让您的顶级域 (example.com) 重定向到您已经设置了 CNAME 的 www 子域 (www.example.com)。

# c# - Visual Studio 不允许我删除最大化/最小化按钮/图标等

> ID：11148409
> 
> 赞同：0
> 
> 时间：2012-06-21T23:46:21.420
> 
> 标签：c#, visual-studio-2010

我有 Form1.cs，我在属性中设置为无边界，没有图标，最大/最小按钮（并且更改在 Form1.cs 中直观地显示），但是当我调试/运行时，所有这些控件都保持不变和以前一样。然后在我的代码中的私有 void InitializeComponent() 下找到这些属性，因为 this.ShowIcon = false; 等等.. Form1.Designer.cs 总是空的，我是否搞砸了一些设置，以某种方式覆盖我的 form1.cs 选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T23:56:21.620

您是否尝试将表单 .MaximizeBox 和 .MinimizeBox 设置为 false ？

如果是这样，您能否发布该 InitializeComponent 方法的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:00:18.903

如果您将其设置为 False，则 Winform 在设计器上具有 MinimizeBox、MaximizeBox 和 ShowIcon 等属性。然后您将不需要私有 void InitializeComponent() 中的任何代码行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T00:00:47.983

设计视图仅显示 Form1.Design.cs 中设置的内容，而不是您的自定义代码（除了一些事件和属性，如调整大小...） 在运行 InitializeComponents 后，您是否覆盖了代码中的任何设计值？

最简单的方法是交叉引用 Form1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T00:13:32.260

如果您尝试删除整个标题栏，您需要将 FormBorderStyle 设置为 None。如果这不起作用，请尝试在表单加载后设置断点并检查值以确保它们是您认为应该的值。这不需要任何编码。

# php - 如何自动分类用户生成的内容

> ID：11148412
> 
> 赞同：1
> 
> 时间：2012-06-21T23:47:06.837
> 
> 标签：php, mysql, automation

我有一个用户发布帖子的系统，该帖子将包含标题，以及帖子内容本身，内容将在 20 - 3000 字之间，由纯文本组成。

我还有一组超过 700 个类别，一些是顶级类别，其余的是子类别。

当用户输入帖子的内容时，需要提示他们最多 5 个相关类别，这些类别会根据用户输入的内容自动选择。

最好的方法是什么，我正在使用 PHP 和 MySQL，任何库或代码示例的链接都会很有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:24:28.037

## 用户视角

您不能仅使用 php/mysql 在同一页面中的 1 步上执行此操作。您的问题主要有2个选项。

*   您还学习/使用一些客户端语言并实现它以在不更改页面的情况下进行搜索。我不太了解，所以我不能真正推荐任何具体的东西，但是[这个线程](https://stackoverflow.com/questions/3020751/can-javascript-connect-with-mysql)应该可以帮助你。

*   您使用中间页。也就是说，用户发布它的内容，然后在发送它之后解析它并提供类别供用户在新页面中选择。这有一个问题，许多用户可能会在评论中按“发送”后关闭窗口，因为他们希望它直接发送，好在它只使用 php/mysql。

## 解析文本

我再次不确定这是否是最有效的方法，但我会尝试并继续测试，直到达到预期的结果：

首先，为每个类别创建一个包含几个关键字的列表。4 或 5 应该可以解决问题，但这在很大程度上取决于类别、文本和许多其他因素。

然后，创建一个包含 10 个元素的数组。5 将是类别的 ID，5 将是每个类别的“分数”。例如，您可以为找到的每个关键字设置 1 分。请记住最初分配一些值，否则您将无法与之比较。

然后我会搜索文本中的每个类别关键字。如果您获得的分数高于之前获得的任何分数，请将最低分数替换为新类别。

回显脚本末尾剩余的 5 个类别。他们应该是5个更合适的。但请记住，还有更多方法可以解决这个解析问题。

# r - quantmod::chart_Series() 错误？

> ID：11148414
> 
> 赞同：5
> 
> 时间：2012-06-21T23:47:10.123
> 
> 标签：r, finance, xts, quantmod

我想使用 quantmod::chart_Series() 绘制 SPX 图表，并在下面绘制 GDP 变化和 GDP 变化的 12 个月 SMA。无论我如何尝试（我使用什么组合）都会发生错误或 quantmod::chart_Series() 仅显示部分图。

```
require(quantmod)

FRED.symbols <- c("GDPC96")

getSymbols(FRED.symbols, src="FRED")
SPX <- getSymbols("^GSPC", auto.assign=FALSE, from="1900-01-01")

subset="2000/"

chart_Series(SPX, subset=subset)
add_TA(GDPC96)
add_TA(ROC(GDPC96, type="discrete"))
add_TA(SMA(ROC(GDPC96, type="discrete"), n=4), on=3, col="blue") 
```

编辑：实际上，在我看来，这是使用季度数据时的 quantmod::chart_series() 问题：

```
subset <- "2000/"
chart_Series(to.quarterly(SPX, drop.time=TRUE), subset=subset)
add_TA(SMA(Cl(to.quarterly(SPX, drop.time=TRUE))))

> subset <- "2000/"
> chart_Series(to.quarterly(SPX, drop.time=TRUE), subset=subset)
> add_TA(SMA(Cl(to.quarterly(SPX, drop.time=TRUE))))
Error in xy.coords(x, y) : 'x' and 'y' lengths differ
In addition: Warning messages:
1: In as_numeric(H) : NAs introduced by coercion
2: In as_numeric(H) : NAs introduced by coercion
3: In as_numeric(H) : NAs introduced by coercion 
```

这确实会在主面板上产生 SPX 图，但会留下空白的第二个和第三个面板。然后我尝试在数据上使用相同的索引，相同的长度等。

```
chart_Series(head(to.quarterly(SPX, drop.time="TRUE"), -1), subset=subset)
add_TA(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE))
add_TA(ROC(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE), type="discrete"))
add_TA(SMA(ROC(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE), type="discrete"),    n=4), on=3, col="blue") 
```

结果到处都是错误：

```
> chart_Series(head(to.quarterly(SPX, drop.time="TRUE"), -1), subset=subset)
> add_TA(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE))
Error in xy.coords(x, y) : 'x' and 'y' lengths differ
In addition: Warning messages:
1: In as_numeric(H) : NAs introduced by coercion
2: In as_numeric(H) : NAs introduced by coercion
3: In as_numeric(H) : NAs introduced by coercion
> add_TA(ROC(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE), type="discrete"))
Error in xy.coords(x, y) : 'x' and 'y' lengths differ
In addition: Warning messages:
1: In as_numeric(H) : NAs introduced by coercion
2: In as_numeric(H) : NAs introduced by coercion
3: In as_numeric(H) : NAs introduced by coercion
> add_TA(SMA(ROC(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE), type="discrete"), n=4), on=3, col="blue")
Error in xy.coords(x, y) : 'x' and 'y' lengths differ
In addition: Warning messages:
1: In as_numeric(H) : NAs introduced by coercion
2: In as_numeric(H) : NAs introduced by coercion
3: In as_numeric(H) : NAs introduced by coercion 
```

使用

```
tail(to.quarterly(SPX, drop.time="TRUE"))
tail(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE))
tail(ROC(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE), type="discrete"))
tail(SMA(ROC(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE), type="discrete"), n=4))

dput(to.quarterly(SPX, drop.time="TRUE"))
dput(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE))
dput(ROC(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE), type="discrete"))
dput(SMA(ROC(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE), type="discrete"), n=4)) 
```

在我看来一切都很好。

我的会话信息（）：

```
> sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8          LC_NUMERIC=C                 
 [3] LC_TIME=en_US.UTF-8           LC_COLLATE=en_US.UTF-8       
 [5] LC_MONETARY=en_US.UTF-8       LC_MESSAGES=en_US.UTF-8      
 [7] LC_PAPER=en_US.UTF-8          LC_NAME=en_US.UTF-8          
 [9] LC_ADDRESS=en_US.UTF-8        LC_TELEPHONE=en_US.UTF-8     
[11] LC_MEASUREMENT=en_US.UTF-8    LC_IDENTIFICATION=en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] quantmod_0.3-18 TTR_0.21-0      xts_0.8-7       zoo_1.7-7      
[5] Defaults_1.1-1  rj_1.1.0-4     

loaded via a namespace (and not attached):
[1] grid_2.15.0    lattice_0.20-0 tools_2.15.0 
```

有什么想法可以解决这些问题吗？

编辑：这似乎是一个 quantmod::chart_Series() 错误。如果我这样做：

```
subset <- "1990/"
test <- cbind(head(to.quarterly(SPX, drop.time="TRUE"), -1)[subset],
            to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE)[subset],
            ROC(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE),     type="discrete")[subset],
            SMA(ROC(to.quarterly(GDPC96, drop.time="TRUE", OHLC=FALSE), type="discrete"), n=4)[subset])

test$test <- 1

subset <- "2000/"
chart_Series(OHLC(test), subset=subset)
add_TA(test$test)
add_TA(test$GDPC96)

> test$test <- 1
> subset <- "2000/"
> chart_Series(OHLC(test), subset=subset)
> add_TA(test$test)
Error in xy.coords(x, y) : 'x' and 'y' lengths differ
In addition: Warning messages:
1: In as_numeric(H) : NAs introduced by coercion
2: In as_numeric(H) : NAs introduced by coercion
3: In as_numeric(H) : NAs introduced by coercion
> add_TA(test$GDPC96)   
Error in xy.coords(x, y) : 'x' and 'y' lengths differ
In addition: Warning messages:
1: In as_numeric(H) : NAs introduced by coercion
2: In as_numeric(H) : NAs introduced by coercion
3: In as_numeric(H) : NAs introduced by coercion
> traceback()
14: stop("'x' and 'y' lengths differ") at chart_Series.R#510
13: xy.coords(x, y) at chart_Series.R#510
12: plot.xy(xy.coords(x, y), type = type, ...) at chart_Series.R#510
11: lines.default(ta.x, as.numeric(ta.y[, i]), col = col, ...) at chart_Series.R#510
10: lines(ta.x, as.numeric(ta.y[, i]), col = col, ...) at chart_Series.R#510
9: plot_ta(x = current.chob(), ta = get("x"), on = NA, taType = NULL, 
       col = 1) at replot.R#238
8: eval(expr, envir, enclos) at replot.R#238
7: eval(aob, env) at replot.R#238
6: FUN(X[[12L]], ...) at replot.R#230
5: lapply(x$Env$actions, function(aob) {
       if (attr(aob, "frame") > 0) {
           x$set_frame(attr(aob, "frame"), attr(aob, "clip"))
           env <- attr(aob, "env")
           if (is.list(env)) {
               env <- unlist(lapply(env, function(x) eapply(x, eval)), 
                   recursive = FALSE)
           }
           eval(aob, env)
       }
   }) at replot.R#230
4: plot.replot(x, ...)
3: plot(x, ...)
2: print.replot(<environment>)
1: print(<environment>) 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-24T05:04:38.117

几天前我遇到了类似的错误。我发现问题出在 add_TA 中：

```
ta.x <- as.numeric(na.approx(ta.adj[, 1])) 
```

na.approx 默认使用 rule = 1 的 approx，如果原始数据中的最后一个时间戳在 TA 数据中的最后一个时间戳之前，则在列表中留下尾随的 NA。更改该行以设置规则 = 2 解决了问题。

```
ta.x <- as.numeric(na.approx(ta.adj[, 1], rule=2)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-24T01:46:32.710

我刚刚写了一个很长的“答案”来确认您的问题，即使经过一些数据按摩，甚至使用了较旧的`chartSeries`功能。然后我意识到这`add_TA()`可能是错误的功能。这种方法有效：

```
par(mfrow=c(2,1))
chart_Series(SPX)
chart_Series(GDPC96) 
```

（请参阅[R/quantmod：使用相同 y 轴的多个图表，](https://stackoverflow.com/questions/8815697/r-quantmod-multiple-charts-all-using-the-same-y-axis)`layout`了解使用该命令的替代方法。）

或使用子集：

```
par(mfrow=c(2,1))
chart_Series(SPX,subset="2000/")
chart_Series(GDPC96,subset="2000/") 
```

（注意，这两个数据集在不同的地方结束，所以不要完全对齐。）

顺便说一句，chart_Series 中存在一个带有季度数据的明确错误：x 轴标签看起来像“%n%b%n2010”。

```
q.SPX=to.quarterly(SPX)
chart_Series(q.SPX) 
```

# selector - 如何在 UIGestureRecognizer initWithTarget 动作中将参数传递给动作

> ID：11148415
> 
> 赞同：10
> 
> 时间：2012-06-21T23:47:12.013
> 
> 标签：selector, uitapgesturerecognizer

我正在使用下面的代码

```
UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(processTap)];

- (void) processTap
{
//do something
} 
```

但我需要向 processTap 函数发送数据。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-28T06:30:25.060

**例子：**

```
UIImageView *myPhoto = [[UIImageView alloc] initWithImage: [UIImage imageNamed:@"tab-me-plese.png"]];
UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(processTap:)];

[myPhoto setTag:1]; //set tag value
[myPhoto addGestureRecognizer:tap];
[myPhoto setUserInteractionEnabled:YES];

- (void)processTap:(UIGestureRecognizer *)sender
{
    NSLog(@"tabbed!!");
    NSLog(@"%d", sender.view.tag);    
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-25T16:16:24.617

[在iOS - UITapGestureRecognizer - Selector with Arguments](https://stackoverflow.com/questions/9960512/ios-uitapgesturerecognizer-selector-with-arguments)有一个类似问题的很好的答案，但是如果你想传递你不想附加到视图的数据，我建议创建第二个函数来访问你需要的数据. 例如：

```
UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(passDataToProcessTap)];

- (void)passDataToProcessTap {
    [self processTapWithArgument:self.infoToPass];
    // Another option is to use a static variable,
    // Or if it's not dynamic data, you can just hard code it
}

- (void) processTapWithArgument:(id)argument {
    //do something
} 
```

# operating-system - 中期调度器

> ID：11148419
> 
> 赞同：2
> 
> 时间：2012-06-21T23:47:40.590
> 
> 标签：operating-system

我在**Galvin 操作系统书籍中**阅读了有关中期调度程序的内容。

有人写道：
有时，在进程未执行[等待 I/O 或等待 CPU] 时将其换出是有利的，以降低多道程序的程度。
此外，我们获得了更多的物理内存，通过减少页面错误的数量[因为我们有更多的内存]，这使得其他进程的执行速度更快。

因此，中期调度程序的工作是在部分执行的进程中进行交换和交换。

但我的问题是：**中期调度器的工作在我们有大量可用物理/主内存的情况下真的很重要吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T10:26:14.010

中期调度程序的使用是通过换出等待（需要 I/O）或低优先级进程并换入就绪队列中的其他进程来允许多个进程驻留在主内存中来改进多道程序设计。所以你可以看到，当我们的内存有限时，我们需要中期调度程序。当我们运行单个小程序并拥有大内存时，不会发生这种换入和换出操作。

同样，如果我们正在运行多个程序并且我们有非常大的内存（大于所有进程的大小加上其他需求的额外空间），则不需要中期调度程序。现代操作系统使用分页，因此它们不是交换进程，而是交换页面进出内存。这与具有非常大内存（无限）的系统相同，不会出现页面错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T12:46:07.933

中期调度是交换的一部分。它从内存中删除进程。它降低了多道程序的程度。中期调度器负责处理换出的进程。教程要点 简单易学 第28 页 正在运行的进程在发出I/O 请求时可能会暂停。暂停的进程无法在完成方面取得任何进展。在这种情况下，为了从内存中删除进程并为其他进程腾出空间，挂起的进程被移动到辅助存储。这个过程被称为交换，这个过程被称为被换出或转出。可能需要交换以改进工艺组合。

# matlab - 循环通过meshgrid matlab的元素

> ID：11148422
> 
> 赞同：0
> 
> 时间：2012-06-21T23:47:52.960
> 
> 标签：matlab

我正在尝试遍历网格以创建向量矩阵。如果我有：

```
[x,y] = meshgrid(1:2,1:2) 
```

有人可以解释循环遍历每个元素以获得等于的矩阵：

```
matrix =
 [x(1,1) y(1,1)] [x(1,2) y(1,2)]
 [x(2,1) y(2,1)] [x(2,2) y(2,2)] 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T02:27:43.923

如果您想要一个具有和交错`2x4`值的矩阵，这将起作用：`x``y`

```
matrix = zeros(2,4);
matrix(:,[1 3]) = x;
matrix(:,[2 4]) = y; 
```

相反，如果您想要一个带有堆叠的`2x2x2`矩阵`x`，请使用：`y``cat`

```
matrix = cat(3,x,y); 
```

这连接`x`并`y`沿第三维。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T06:01:39.993

也许您可以将每对坐标排列为一行：

```
[x,y] = meshgrid(1:2,1:2)
xy = [x(:) y(:)]; 
```

因此：

```
>> xy =
     1     1           %# xy(1,:) = [x(1,1),y(1,1)]
     1     2           %# xy(2,:) = [x(2,1),y(2,1)]
     2     1           %# xy(3,:) = [x(1,2),y(1,2)]
     2     2           %# xy(4,:) = [x(2,2),y(2,2)] 
```

# asp.net - ASP.NET MVC 应用程序中的“错误二进制签名”

> ID：11148423
> 
> 赞同：5
> 
> 时间：2012-06-21T23:48:03.613
> 
> 标签：asp.net, asp.net-mvc, 64-bit, aspnet-merge

我在这里遇到了同样的问题：[ASP.NET MVC 应用程序中的“Bad binary signature”](https://stackoverflow.com/questions/2101529/bad-binary-signature-in-asp-net-mvc-application)

ASP.Net MVC 站点在本地计算机上运行良好，但是当使用 aspnet_compiler、aspnet_merge 和 msdeploy 的组合进行部署时，加载任何页面都会失败并出现以下错误：

> System.BadImageFormatException 错误的二进制签名。（来自 HRESULT 的异常：0x80131192）

链接问题中接受的解决方案表明该问题是由使用错误版本的 aspnet_merge 引起的，并且我已验证从部署中删除 aspnet_merge 步骤可以解决该问题。

我的问题是使用正确的 aspnet_merge 版本似乎无法解决问题。

Web 应用程序的目标是 .Net 4.0 64 位。使用的 aspnet_merge 路径是：“C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools\aspnet_merge.exe”

**[编辑]**

本地开发是：

*   VS2010 SP1
*   卡西尼
*   x64
*   已安装 VS11 Beta 和 .Net 4.5

构建路径是：

*   C:\Windows\Microsoft.NET\Framework\v4.0.30319\
*   C:\Program 文件 (x86)\IIS\Microsoft Web 部署 V2\

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T11:37:28.730

我也遇到过类似的问题，使用 Web 部署项目在 VS2010 (.NET 4.0) 中预编译 ASP.NET 网站项目。

一切正常，直到我安装了 VS2012（它安装了 .NET 4.5 - 我认为这是相关的），它开始给我：

`System.BadImageFormatException: Bad binary signature. (Exception from HRESULT: 0x80131192)`

在一些调试和隔离测试用例之后，我将问题追溯到 .NET 4.0 网站和另一个 .NET 3.5 项目之间传递的 lambda。

3.5 项目中定义的方法有这样的签名：

```
public IEnumberable<T> ExecuteAsEnumerable(Func<IDataReader, T> func)
{
  //..
} 
```

它在 4.0 网站中的属性 getter 中使用，导致通过 aspnet_merge 合并时出现错误：

```
public IList<MyObject> MyListOfItems
{
  get
  { 
    return _myListOfItems ?? (_myListOfItems = new SomeQueryBuilder()
      //.build statement
      .ExecuteAsEnumerable(reader => new MyObject(reader))
      .ToArray());
  }
} 
```

在我的测试用例中，我`ExecuteAsEnumerable`在 4.0 网站内重新创建了一个不同的命名扩展方法，经过预编译，它可以工作。在检查了项目的“Target .NET Framework”并意识到它是3.5（我之前没有意识到）之后，我将所有东西都切换到了4.0，一切都恢复了。

.NET 4.5 更新中明显发生了一些变化（这是对 4.0 的就地升级）。就我而言，我可以重新编译有问题的项目——我不确定每个人都会有这种奢侈（这是正确的词吗？）。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-05T15:48:30.960

我也遇到了这个异常。据我所知，这也不是 aspnet_merge 版本问题，也不是目标框架的问题。然而，它是在一个最近更新到 MVC 5 的旧项目上。

我在 Razor 视图中有这段代码：

```
var companies = users.Select(u => u.Company).DistinctBy(c => c.Id)
                             .OrderBy(c => c.Id == CurrentUser.Company.Id ? 0 : 1)
                             .ThenBy(c => c.Name); 
```

它使用 Linq 和`DistinctBy`用于 MoreLinq 库。由于无论如何这都不应该出现在视图中，因此我将其移至控制器并且异常消失了。

# php - 奇怪的变量/Mysql 问题

> ID：11148425
> 
> 赞同：1
> 
> 时间：2012-06-21T23:48:06.453
> 
> 标签：php, mysql, database, variables

我只是不知道该怎么办，也不知道如何搜索这个奇怪的问题。这是：

页面上的所有连接都正常工作，以防万一：

我有这个代码来更新数据库上的电子邮件

```
$fUsername = mysql_real_escape_string($_GET['user']);
$fPassword = mysql_real_escape_string($_GET['senha']);
$fEmail = mysql_real_escape_string($_POST['fEmail']);

$sql = "UPDATE usuario SET email='$fEmail ' WHERE username = '$fUsername' and senha = '$fPassword'";
$result=mysql_query($sql); 
```

现在，问题：

此查询不更新 BD 上的“电子邮件”字段。它只是使该字段为空。

如果我回显 $sql var，我会得到： UPDATE usuario SET email='teste@gmail.com ' WHERE username = 'teste1' and senha = 'e10adc3949ba59abbe56e057f20f883e'

如果我在 mySQL 上手动运行此查询，它会像我想要的那样更新该字段。

如果我手动将值传递给 $fEmail var ( ***$fEmail = "teste@gmail.com"*** )。它工作得很好。

唯一不起作用的方法是当我从**Form**中获取值时。

有没有人有这个解决方案？丁：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T23:50:39.323

您正在使用`$_GET`用户名和密码以及`$_POST`电子邮件。检查您的`form`实际提交方法，并修复相关数据获取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T23:51:48.520

`$_GET['fEmail']`如果表单数据是通过 GET 发送的，则 应该使用。`$_POST['fEmail']`在这种情况下未定义，这将解释您所看到的行为。

# jquery - 如何使用jqueryui可拖动将图像拖动到框架内

> ID：11148428
> 
> 赞同：0
> 
> 时间：2012-06-21T23:48:35.797
> 
> 标签：jquery, jquery-ui, jquery-ui-draggable

我有以下页面：http: [//jsfiddle.net/DerNa/](http://jsfiddle.net/DerNa/)

我想要做的是将图像限制在框架内（这样当您将图像从边框移开时，它会阻止它）。最初我试过这个：http: [//jsfiddle.net/DerNa/1/](http://jsfiddle.net/DerNa/1/)

在它不起作用后，我尝试这样做：http: [//jsfiddle.net/DerNa/2/](http://jsfiddle.net/DerNa/2/)

但返回 false 只会出于某种原因取消拖动。我只是希望它取消那个特定的拖动动作。

有人有想法么？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:26:06.820

对 使用数组坐标值`containment`：

```
$('img').draggable({containment:[x1,y1,x2,y2]})​; 
```

在您的提琴手示例中，您可以使用：

```
$('img').draggable({containment:[-300,-300,0,0]})​; 
```

这是 jsfiddle 中的解决方案：http: [//jsfiddle.net/DerNa/3/](http://jsfiddle.net/DerNa/3/)

根据要求添加说明：

`x1, y1`是`left, top`您的元素可以拖动到的最小值是您的元素可以拖动到
`x2, y2`的最大值`left, top`

# r - R：将非对称列表转换为矩阵 - 每个子列表中的元素数量不同

> ID：11148429
> 
> 赞同：5
> 
> 时间：2012-06-21T23:48:36.727
> 
> 标签：r

我有一个不对称列表，即每个子列表中的元素数量不同。如何将列表转换为矩阵？

下面我从一个对称列表开始，并以两种不同的方式将其转换为矩阵。

```
# create a symmetric list

my.list1    <- list(c(1,2,3,4),c(5,6,7,8),c(9,10,11,12))
my.list1

# convert symmetric list to a matrix

mat.a1  <- matrix( unlist(my.list1), nrow=length(my.list1), byrow=T )
mat.a1

# alternative method to convert symmetric list to a matrix

mat.b1 <- do.call(rbind, my.list1)
mat.b1 
```

接下来我创建一个非对称列表：

```
# create an asymmetric list

my.list2   <- list(c(1,2,3,4),c(5,6,7,8,9),c(10,11,12,13))
my.list2 
```

这是所需的矩阵：

```
# desired result

#      [,1] [,2] [,3] [,4] [,5]
# [1,]    1    2    3    4   NA
# [2,]    5    6    7    8    9
# [3,]   10   11   12   13   NA 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-22T00:11:09.870

首先，用 NA 扩展列表中的每个向量以获得相同长度的向量。然后创建你的矩阵。例如：

```
max.len <- max(sapply(my.list2, length))
corrected.list <- lapply(my.list2, function(x) {c(x, rep(NA, max.len - length(x)))})
mat <- do.call(rbind, corrected.list) 
```

# android - SQLiteOpenHelper 类对 context 参数做了什么？

> ID：11148433
> 
> 赞同：6
> 
> 时间：2012-06-21T23:49:04.837
> 
> 标签：android, database, sqlite, constructor

我正在扩展`SQLiteOpenHelper`课程。我的构造函数是

```
public MyDatabaseHelper(Context context) {
    super(
        context,         // ???
        "MyDatabase.db", // Database name
        null,            // Cursor factory
        1                // database version
    );
} 
```

SQLiteOpenHelper 构造函数对上下文信息做了什么？

对于我的应用程序，无论程序状态（上下文）如何，构造函数的行为都相同。我可以在没有任何未来问题的情况下为上下文传递 null 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T01:49:21.847

如果您提供空值，它将创建一个内存数据库，但您还需要为数据库名称参数提供空值，以便正确处理。

这记录在上下文的构造函数文档中

> 用于打开或创建数据库文件的数据库名称的上下文，或 null 用于内存数据库

另外，如果你查看 SQLiteHelper 类本身的源代码，你会看到它使用 mName 值来决定是否使用 mContext。在此处在线查看源代码：

[http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.4_r1.2/android/database/sqlite/SQLiteOpenHelper.java#SQLiteOpenHelper.0mContext](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.4_r1.2/android/database/sqlite/SQLiteOpenHelper.java#SQLiteOpenHelper.0mContext)

# php - 24位int in php

> ID：11148440
> 
> 赞同：2
> 
> 时间：2012-06-21T23:49:48.777
> 
> 标签：php, pack, unpack, 24-bit

嘿，所以我遇到了一个问题，从 PHP 我必须从一个二进制文件中读取一些数据，其中 SPACE 是最重要的，所以他们在一些地方使用了 24 位整数。

现在对于我可以使用 unpack 读取的大部分数据，但是 pack/unpack 不支持 24 位 int 的：s

我想我也许可以简单地将数据（例如 000104）读取为 H* 并将其读入正确的 var 中。

```
// example binary data say I had the following 3 bytes in a binary file
// 0x00, 0x01, 0x04

$buffer = unpack("H*", $data);

// this should equate to 260 in base 10 however unpacking as H* will not get
// this value.

// now we can't unpack as N as it requires 0x4 bytes of data and n being a 16 bit int
// is too short. 
```

以前有人处理过这个吗？有什么解决办法吗？建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T04:37:14.083

如果文件只有上面的 3 个字节，最简单的方法是像@DaveRandom 所说的那样填充。但是如果它是一个长文件，这种方法就会变得低效。

在这种情况下，您可以将每个元素读取为 char 和 short，然后通过位运算符重新打包。

或者您可以将 12 个字节读取为 3 个长字节，然后使用位运算符将其分成 4 组 3 个字节。剩余的字节将通过上述 2 种方法提取。这将是大数据上最快的解决方案。

```
unsigned int i, j;
unsigned int dataOut[SIZE];

for (i = 0, j = 0; j < size; i += 4, j += 3)
{
    dataOut[i]     = dataIn[j] >> 8;
    dataOut[i + 1] = ((dataIn[j] & 0xff) << 16) | (dataIn[j + 1] >> 16);
    dataOut[i + 2] = ((dataIn[j + 1] & 0xffff) << 8) | (dataIn[j + 2] >> 24);
    dataOut[i + 3] = dataIn[j + 2] & 0xffffff;
} 
```

以下[问题](https://stackoverflow.com/a/11732142/995714)也有一个示例代码来解压缩一个 24/48 位的字符串

# java - 将多个 BufferedImage 层叠在一起？

> ID：11148453
> 
> 赞同：4
> 
> 时间：2012-06-21T23:51:16.487
> 
> 标签：java, bufferedimage

我有多个透明`BufferedImage`实例，我想将它们叠加在一起（又名 Photoshop 图层）并烘焙到一个`BufferedImage`输出中。我该怎么做呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-22T00:05:36.790

我会说最好的选择是获取缓冲图像，并创建一个额外的图像，以便有一个要附加的对象。然后只需使用 Graphics.drawImage() 将它们放在一起。

所以沿着这些思路：

```
BufferedImage a = ImageIO.read(new File(filePath, "a.png"));
BufferedImage b = ImageIO.read(new File(filePath, "b.png"));
BufferedImage c = new BufferedImage(a.getWidth(), a.getHeight(), BufferedImage.TYPE_INT_ARGB);

Graphics g = c.getGraphics();
g.drawImage(a, 0, 0, null);
g.drawImage(b, 0, 0, null); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T00:10:40.977

假设第一个 BufferedImage 命名为 bi1，第二个命名为 bi2，而您想要将它们分层的图像是目标。

```
BufferedImage target=new BufferedImage(width,height,BufferedImage.TYPE_INT_ARGB);
Graphics2D targetGraphics=target.createImage();
targetGraphics.drawImage(bi1,0,0,null);//draws the first image onto it

int[] pixels2=((DataBufferInt) bi2.getRaster().getDataBuffer()).getData();
int[] pixelsTgt=((DataBufferInt) target.getRaster().getDataBuffer()).getData();
for(int a=0;a<pixels2.length;a++)
{
     pixelsTgt[a]+=pixels2[a];//this adds the pixels together
} 
```

确保所有三个 BufferedImage 对象都是 TYPE_INT_ARGB 以便打开 alpha。如果两者加在一起大于最大整数，这可能无法为您提供您想要的确切结果，因此您可能需要添加一些东西来帮助解决这个问题。像素使用位移来添加颜色，其整数排序为 AARRGGBB。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-22T01:13:13.353

还要考虑[`AlphaComposite`](https://docs.oracle.com/javase/7/docs/api/java/awt/AlphaComposite.html)可用于图形上下文的模式，[此处](https://stackoverflow.com/questions/7823631/java-opaque-color/7824225#7824225)讨论。

[![图片](../Images/92ea0880875ef2fb573dc87532f7086f.png)](https://i.stack.imgur.com/bTkpR.png)

# javascript - 画布游戏 Json 功能仅适用于 Web 检查器

> ID：11148456
> 
> 赞同：0
> 
> 时间：2012-06-21T23:51:19.840
> 
> 标签：javascript, jquery, json, canvas

我正在制作一个 HTML5 游戏，我正在使用一个矩阵来存储地图。但是现在我正在使用 $getJson 通过 json 文件读取该值并且它可以工作，但问题是当通过网络检查器更改我的矩阵的值时，地图会更改但是当我直接在代码上调用该函数时我得到一个错误：

```
game.js:51TypeError: 'undefined' is not an object (evaluating 'levels.Level1') 
```

第 51 行： `mapa.loadMap(levels.Level1.board);`

为什么这只在 web 检查器上调用函数“mapa.loadMap(levels.Level1.board)”时才有效？

```
function map(){

    this.loadMap = function (l){
    var j= 0;
    for (var i = 0; i < l.length; i++) {
    var object = l[i];
    for (property in object) {
        var value = object[property];
        this.board[j][property] = value;
    }
    j++;
    }
    }

    this.width = 10;
    this.height = 8;
    this.image = new Image();
    this.image.src = "images/level1/tiles.png";

    this.board = [  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 2],
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            [8, 0, 0, 0, 33, 1, 1, 1, 1, 1],
            [8, 0, 0, 0, 0, 0, 0, 37, 0, 0],
            [25, 26, 0, 0, 0, 0, 0, 38, 0, 0],
            [27, 28, 5, 5, 6, 7, 0, 38, 0, 0],
            [1, 1, 1, 1, 1, 9, 5, 39, 5, 5],
                    ];

   (...) 
```

忘记那个XD

我的代码一团糟，因为它是一个草图，但我解决了：

```
$(document).ready(function(){
    init();

});

$(window).load(function () {
    console.log(levels.Level1.board);
    mapa = new map();  
    render();  
}); 
```

感谢您的帮助:) 对不起我的英语 XD

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T17:29:16.443

```
$(document).ready(function(){
    init();

});

$(window).load(function () {
    console.log(levels.Level1.board);
    mapa = new map();  
    render();  
}); 
```

# configuration - 如何：基于运行时参数的 StructureMap 和配置？

> ID：11148457
> 
> 赞同：2
> 
> 时间：2012-06-21T23:51:22.323
> 
> 标签：configuration, parameters, runtime, structuremap

简而言之 - 我希望能够根据运行时参数实例化对象。在这种特殊情况下，只有两个参数，但问题是我面临这些参数的不同排列并且变得混乱。

情况如下：我想获取特定于特定国家/地区的对象实例，然后是特定州/省。因此，考虑到美国，有 50 种可能的组合。实际上它比那个少，但这是最大值。这样想，我想知道在给定的国家/州吸大麻的惩罚是什么，我把这些信息传递进去，然后我得到实例化的对象告诉我它是什么。

代码（仅供参考）：

```
interface IState
{
    string Penalty { get; }
}

interface ICountry
{
    IState State { get; set; }
    string Name { get; }
}

class BasePenalty : IState
{
    virtual public string Penalty { get { return "Slap on a wrist"; } }
}

class USA : ICountry
{
    public USA(IState state)
    {
        State = state;
    }

    public IState State { get; set; }
    public string Name { get { return "USA"; } }
}

class Florida: BasePenalty
{
    public override string Penalty { get { return "Public beheading"; } }
}

// and so on ... I defined other states
// which have penalties other than the "Slap on a wrist" 
```

如何配置我的容器，当给定国家和州组合时，它将返回惩罚？我尝试了配置文件和上下文绑定的组合，但该配置与我创建的类的数量成正比。我已经经历了定义不同组合的麻烦。我想避免在容器配置期间做同样的事情。我想将状态注入国家。另外，如果未指定状态，我想返回 UsaBasePenalty 值。那可能吗？也许这些是设计的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T15:12:28.800

我通常使用工厂来解决这类问题。我将首先删除`IState`/`ICountry`接口并将它们替换为更具体的`IPenaltyCalculator`. 让工厂接受所有实例（`IEnumerable<IPenaltyCalculator>`在工厂的构造函数中）。然后，您通过将上下文信息（当前状态、国家/地区）作为参数传递来向工厂询问正确的实例。`IPenaltyCalculator`有一个额外的方法：`bool AppliesTo(string state, string country)`. 工厂循环遍历它们并返回第一个`true`从`AppliesTo`. 如果没有返回 true，则返回您的`DefaultPenaltyCalculator`.

# php - 通过脚本登录 Wordpress

> ID：11148459
> 
> 赞同：0
> 
> 时间：2012-06-21T23:51:36.273
> 
> 标签：php, wordpress

我试图组合一个 php 页面，该页面将登录用户/或创建用户并登录。我的用户正在创建，但是当我尝试转到页面时，WP 只是将我重定向到实际的登录页面。以下是我无法工作的部分。

```
if ( !username_exists( $user_login_name ) ) {
    $user_id = wp_create_user( $user_login_name, md5($user_login_name), "" );
    $creds = array();
    $creds['user_login'] = $user_login_name;
    $creds['user_password'] = md5($user_login_name);
    $user = wp_signon( $creds, false );
    wp_set_current_user($user_id);
    if ( is_wp_error($user) )   {
        echo $user->get_error_message();
    }
    wp_set_auth_cookie( $user_id );
} else  {
    $user = get_user_by('login', $user_login_name);
    $user_id = $user->ID;
    $creds = array();
    $creds['user_login'] = $user_login_name;
    $creds['user_password'] = md5($user_login_name);
    $user = wp_signon( $creds, false );
    wp_set_current_user($user_id);
    if ( is_wp_error($user) ){
        echo $user->get_error_message();            
    }
    wp_set_auth_cookie( $user_id ); 
```

}

谁能告诉我我做错了什么？我已经设置了 cookie、当前用户等。但仍然不行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T02:10:42.213

将“记住”添加到 $creds 数组：

```
$creds['remember'] = true; 
```

这应该让您保持登录状态，直到自然 WP 会话到期。

# ios - 在IOS上，你能让QLPreviewController把某些文件当作文本吗？

> ID：11148460
> 
> 赞同：0
> 
> 时间：2012-06-21T23:51:44.440
> 
> 标签：ios, text, quicklook, uti

我`QLPreviewController`用来显示文件，其中许多实际上是纯文本，但`QLPreviewController`似乎并不知道。`.m`（例如，无法显示带有扩展名的文件。）

有没有办法告诉`QLPreviewController`将文件视为文本？（我认为它决定它根本无法查看它们。）我正在研究 UTI，但我不确定这是否是正确的方向。（我会知道文件是否是文本，所以我不会猜测。）

还是我必须在幕后使用 .txt 扩展名保存它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:07:58.050

好吧，我在 API 中看不到一种方法来告诉 QLPreviewController 哪个 UTI 是适合文件的 UTI。但是因为 QLPreviewController 通过查看文件扩展名来确定 UTI，所以您可以复制文件，将“.txt”附加到它，然后打开这个文件。

在您的 QLPreviewControllerDatasource 实现中：

```
- (id <QLPreviewItem>) previewController: (QLPreviewController *) controller previewItemAtIndex: (NSInteger) index; {
    NSString *file = @"source.m"
    NSString *tmp = [file stringByAppendingPathExtension:@".txt"]
    [[NSFileManager defaultManager]copyItemAtPath:file toPath:tmp error:NULL];
    return [NSURL fileURLWithPath:tmp];
} 
```

# python - 使用 feedparser 访问 Gmail Atom 提要时出错

> ID：11148471
> 
> 赞同：0
> 
> 时间：2012-06-21T23:53:22.230
> 
> 标签：python, rss, feed, atom-feed, feedparser

我在使用 feedparser 模块访问我的 Gmail Atom 提要时遇到问题。例如，对于像博客这样的非密码保护费用，

```
import feedparser

d = feedparser.parse('http://karanjthakkar.wordpress.com/feed/')
print d.feed.title 
```

feedparser 模块返回的值是正确的。但是，当我使用它来访问我的 Gmail 提要时，

```
import urllib2, feedparser

def main():
 pwdmgr = urllib2.HTTPPasswordMgrWithDefaultRealm()
 pwdmgr.add_password("New mail feed", 'http://mail.google.com/', "karanjthakkar", "my-password")
 auth = urllib2.HTTPBasicAuthHandler(pwdmgr)
 opener = urllib2.build_opener(auth)
 data = opener.open('http://mail.google.com/mail/feed/atom')
 d = feedparser.parse(data)
 print d

if __name__ == '__main__'
 main() 
```

我在捕获的提要中收到错误 401。这是捕获的内容：

[![截屏](../Images/aa840fc46b0672bf026a0c15ab006380.png)](https://i.stack.imgur.com/lnyQm.jpg)

我错过了什么吗？我不是CS背景，所以我所知道的就是我读过的。我打算使用捕获的 Gmail 提要来检查未读邮件的数量并使用 Arduino 显示它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T00:29:53.570

我对 HTTPDigestAuthHandler 没有运气，但能够让它与 HTTPBasicAuthHandler 一起工作。

```
import urllib2, feedparser

pwdmgr = urllib2.HTTPPasswordMgrWithDefaultRealm()
pwdmgr.add_password("New mail feed", 'http://mail.google.com/', username, password)
auth = urllib2.HTTPBasicAuthHandler(pwdmgr)
opener = urllib2.build_opener(auth)
data = opener.open('http://mail.google.com/mail/feed/atom')
d = feedparser.parse(data)
print d 
```

# mysql - 归一化到 3nf 和函数依赖两个

> ID：11148472
> 
> 赞同：1
> 
> 时间：2012-06-21T23:53:48.580
> 
> 标签：mysql, sql, database-normalization

我需要识别功能依赖项并将下表规范化为 3NF。我仍然不清楚所有依赖项。

如果我有依赖项，我会将它们推送到其他表中吗？

音像店

**客户表**

```
customerNo | customername | address | phone | numberofbooking 
```

*   客户编号 – 与客户相关的唯一编号。 
*   客户名称 – 客户的名称。  
*   地址 - 客户地址。 
*   电话 - 客户的电话号码。 
*   租赁数量 – 客户当前的租赁数量。  

`customerno`是我的主键，除了`numberofbooking`依赖于`customerno`？

**视频表**

```
SerielNo | CopyNumber | title | yearmade | director | origen 
```

*   SerialCode – DVD 背面的唯一序列号。  
*   CopyNumber - 该视频的副本号。例如，一个视频可以在商店中有多个副本，这用于区分每个副本。 
*   标题 - 电影的名称。 
*   制作年份 – 电影出版的年份。  
*   导演——电影的导演。 
*   原产地——电影制作的国家。  

由于`serielno`我不是唯一的或副本号，因此我要`videoId`为每个视频添加一个唯一的序列号，因为序列号可以有多个副本。

**租金表**

```
title | customerName 
```

*   title - 已租用的视频名称。 
*   customername – 租借电影的客户的姓名。  

不知道在这里做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:03:59.647

根据您列出的内容，我会...

*   删除该`numberOfBooking`列（这可以`rentals`稍后使用表中的子查询干净地计算。）
*   `Director`可能应该是它自己的表，然后在`Video`需要该关系时创建一个外键引用。
*   `customerName`将rentals 表中的列替换为customers 表的外键引用。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:13:28.167

*   从客户表中删除 NumberOfBooking 字段。这是多余的，可以很容易地从租金表中计算出来。

*   考虑将视频表拆分为两个表，其中一个包含唯一视频的信息，另一个包含有关每个视频副本的信息。

*   考虑添加一个 id 来标识视频副本，这比序列号和视频副本号的组合更易于使用。

*   考虑添加一个导演表，因为一些导演会制作几个视频。

*   考虑添加一个国家/地区表，因为许多视频将来自同一个国家/地区。

*   使用出租表中的客户编号，而不是客户名称。客户名称可能不是唯一的。

*   在出租表中使用视频副本的标识，而不是视频标题。

# iphone - 在 iOS4 中，使用 NSRunLoop 运行 NSTimer 会禁用触摸/手势输入

> ID：11148479
> 
> 赞同：0
> 
> 时间：2012-06-21T23:54:56.387
> 
> 标签：iphone, objective-c, ios, ios5, ios4

这是对[上一个问题](https://stackoverflow.com/questions/11129632/erratic-behavior-with-nstimers-and-nsrunloops)的跟进（Michael Frederick 很好地解决了这个问题）。

我目前正在 iOS5 设备和 iOS4 设备之间进行调试。本质上，我有一个 UIImage 动画滑动以指示用户滑动以继续。动画代码如下：

```
[UIView animateWithDuration:1.0 animations:^ {
self.finger.alpha = 1.0; 
}completion:^(BOOL finished) {
CGAffineTransform originalTransform = self.finger.transform;
[UIView animateWithDuration:1.0 delay:0.0 options:UIViewAnimationCurveEaseInOut animations:^ {

    self.finger.transform = CGAffineTransformMakeTranslation(-200, 0);
    self.finger.alpha = 0.0;

    }completion:^(BOOL finished) {

        self.finger.transform = originalTransform;
        NSTimer *timer = [NSTimer timerWithTimeInterval:1.0 target:self selector:@selector(repeatSwipeAnimation1) userInfo:nil repeats:YES];
        self.swipeTimerForFinger1 = timer;
        NSRunLoop *runLoop = [NSRunLoop currentRunLoop];
        [runLoop addTimer:self.swipeTimerForFinger1 forMode:NSDefaultRunLoopMode];
        [self.swipeTimerForFinger1 fire];

        }];

    }]; 
```

和定时器选择器：

```
-(void)repeatSwipeAnimation1 {
    [UIView animateWithDuration:1.0 delay:0.0 options:UIViewAnimationCurveEaseIn animations:^ {
    self.finger.alpha = 1.0;
}completion:^(BOOL finished) {
    CGAffineTransform originalTransform = self.finger.transform;
    [UIView animateWithDuration:1.0 delay:0.0 options:UIViewAnimationCurveEaseInOut animations:^ {
        self.finger.transform = CGAffineTransformMakeTranslation(-200, 0);
        self.finger.alpha = 0.0;
    }completion:^(BOOL finished) {
        self.finger.transform = originalTransform;

    }];
}];
} 
```

这完全正常。然而，在 iOS4 上，滑动手势似乎被禁用了；我无法像在 iOS5 上那样滑动以继续。我唯一的理论是让计时器在主线程上运行会以某种方式禁用手势识别器（我认为它也在主线程上感应触摸）。我唯一的问题是我试图将这个动画放在后台，如下所示：

```
[UIView animateWithDuration:1.0 animations:^ {
            self.finger.alpha = 1.0; 
        }completion:^(BOOL finished) {
               CGAffineTransform originalTransform = self.finger.transform;
            [UIView animateWithDuration:1.0 delay:0.0 options:UIViewAnimationCurveEaseInOut animations:^ {

                self.finger.transform = CGAffineTransformMakeTranslation(-200, 0);
                self.finger.alpha = 0.0;

            }completion:^(BOOL finished) {

                self.finger.transform = originalTransform;

                 [NSThread detachNewThreadSelector:@selector(goToNewThread) toTarget:self withObject:nil];                    

            }];

        }]; 
```

和新的线程选择器：

```
-(void)goToNewThread {

     NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    NSTimer *timer = [NSTimer timerWithTimeInterval:1.0 target:self selector:@selector(repeatSwipeAnimation1) userInfo:nil repeats:YES];
    self.swipeTimerForFinger1 = timer;
    [[NSRunLoop currentRunLoop] addTimer:self.swipeTimerForFinger1 forMode:NSDefaultRunLoopMode];
    [[NSRunLoop currentRunLoop] run];
    [self.swipeTimerForFinger1 fire];

    [pool release];

} 
```

动画已经到位，但又一次，它似乎禁用了任何滑动手势识别。我仔细考虑了 SO、我的 O'Reilly 材料和 Apple 文档，但未能找到解决方案。感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T03:38:29.773

摆脱形式的束缚；您需要添加`UIViewAnimationOptionAllowUserInteraction`到动画块中的选项。

回答您的评论问题。是的，您可以轻松地使用多个动画选项。您通常使用按位或运算符“ `|`”，如下所示：

```
[UIView animateWithDuration:1.0 delay:0.0 options:UIViewAnimationCurveEaseInOut|UIViewAnimationOptionAllowUserInteraction animations... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T03:33:00.557

NJones 给出了正确的答案。我只需要在我的代码`UiViewAnimationOptionAllowUserInteraction`选项下添加。`[UIView animationWithDuration...]`

# php - Mac 上原生 PHP/Mysql 安装，激活 PDO 驱动

> ID：11148486
> 
> 赞同：4
> 
> 时间：2012-06-21T23:55:54.880
> 
> 标签：php, mysql, pdo, mysqli

我在 MacOSX Lion 上有一个自定义安装，包括以下内容：

1.  原生 PHP 升级到 5.4，就像一个魅力。
2.  安装的 MySQL，从 /usr/local/mysql-5.5.25-osx10.6-x86_64/bin/mysql 运行，就像一个魅力，Workbench 连接并可以执行操作。
3.  编辑 /etc/ 中的 php.ini 以激活以下内容：

    ```
    extension=php_mysqli.so
    extension=php_pdo_pgsql.so
    extension=php_pdo_mysql.so 
    ```

4.  phpinfo() 说明如下：

    PDO

    PDO 支持已启用 PDO 驱动程序 mysql、pgsql、sqlite

    pdo_mysql

    启用 MySQL 的 PDO 驱动程序客户端 API 版本 mysqlnd 5.0.10 - 20111026 - $Id: b0b3b15c693b7f6aeb3aa66b646fee339f175e39 $

    指令本地值主值 pdo_mysql.default_socket /var/mysql/mysql.sock /var/mysql/mysql.sock

这意味着它有效，是吗？

不过有两个问题：

*   没有 /var/mysql/mysql.sock 这样的文件，它在 /tmp/mysql.sock 中。但我使用 PDO 选项配置并构建了 php： --with-mysql=mysqlnd --with-mysqli=mysqlnd --without-pear --with-pdo-mysql=mysqlnd --with-mysql-sock=/var /mysql/mysql.sock。如果我将 ini 设置更改为 /tmp/mysql.sock 没有效果，它反映在 php.ini 中，但错误保持不变。

*   当我尝试在 PHP 中实例化 PDO 类时，会发生这种情况：未捕获的异常 'PDOException' 和消息'找不到驱动程序'

当我尝试以老式的 mysqli 方式从 PHP 访问 MySQL 时，我得到了这个：

无法连接到 MySQL：（2002）没有这样的文件或目录警告：main（）：无法在...中获取 mysqli

我还能尝试什么让我的 PHP 和我的 MySQL 玩得更好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T09:06:19.590

解决方案是执行以下操作：

1.  更改 php.ini 中的 .sock 路径以反映实际路径
2.  **重新启动您的计算机，**而不仅仅是 apache

似乎 php.ini 更改在执行时未加载

```
$ sudo apachectl restart 
```

并且需要在考虑到它们之前重新启动 Macbook。

# gdb - GDB命令打印分段错误的完整异常信息？

> ID：11148487
> 
> 赞同：4
> 
> 时间：2012-06-21T23:56:00.453
> 
> 标签：gdb, x86

我正在 GDB 下调试一个优化的 Linux 可执行文件。我们的程序因分段错误而崩溃。然而，错误指令似乎并没有真正访问无效指针；它基本上是一个`mov 0xf00(%ebx), eax`0xf00(%ebx) 是有效内存的操作。至少，当我们找到`x`它的地址时，它就会出现。

什么是 GDB 命令来查看当前捕获的异常的*所有*详细信息，包括错误操作码试图访问的确切内存地址？此信息应该在异常陷阱框架中，但我不知道如何通过 GDB 获取。

这适用于 Ubuntu 下的 x86。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T01:18:24.490

> 然而，错误指令似乎并没有真正访问无效指针；它基本上是一个 mov 0xf00(%ebx), eax op 其中 0xf00(%ebx) 是有效内存。至少，当我们 x 它的地址时它会出现。

我猜该地址实际上是无效的（`mmap`编辑`PROT_NONE`）。

GDB 可以检查它的原因是在 Linux 上`ptrace`（GDB 使用它来访问劣质内存）会很高兴地从这些地址中读取，而应用程序本身则不能。

> 查看当前捕获的异常的所有详细信息的 GDB 命令是什么

尝试`print $_siginfo`当 GDB 与信号停止时。文档[在这里](http://sourceware.org/gdb/onlinedocs/gdb/Convenience-Vars.html)。

# c++ - 正则表达式慢

> ID：11148488
> 
> 赞同：2
> 
> 时间：2012-06-21T23:56:03.837
> 
> 标签：c++, regex, visual-c++, c++11, visual-studio-2012

我正在尝试使用正则表达式解析构建日志文件以获取一些信息。我正在尝试使用正则表达式`("( {9}time)(.+)(c1xx\\.dll+)(.+)s")`来匹配一行`time(D:\Program Files\Microsoft Visual Studio 11.0\VC\bin\c1xx.dll)=0.047s`

在一个有 19,000 行的文件中，这大约需要 120 秒才能完成。其中一些相当大。基本问题是当我将行数减少到 19000 左右时，使用某些条件，它没有改变任何东西，实际上使情况变得更糟。我不明白，如果我完全删除正则表达式，只扫描文件大约需要6s。这意味着正则表达式是这里主要的耗时过程。那么为什么当我删除一半的行时，它至少不会降低一些。

另外，谁能告诉我哪种正则表达式更快、更通用或更具体。即，我也可以`time(D:\Program Files\Microsoft Visual Studio 11.0\VC\bin\c1xx.dll)=0.047s`使用此正则表达式在文件中匹配此行 uniquley - `("(.+)(c1xx.dll)(.+)")`。但这会使整个事情运行得更慢，但是当我使用类似`("( {9}time)(.+)(c1xx\\.dll+)(.+)")`It 的东西时，它会运行得稍微快一些。

我正在使用 c++ 11 正则表达式库，主要是 regex_match 函数。

```
regex c1xx("( {9}time)(.+)(c1xx\\.dll+)(.+)s");
auto start = system_clock::now();
int linecount = 0;
while (getline(inFile, currentLine))
{
    if (regex_match(currentLine.c_str(), cppFile))
    {
        linecount++;
        // Do something, just insert it into a vector
    }
}

auto end = system_clock::now();
auto elapsed = duration_cast<milliseconds>(end - start);
cout << "Time taken for parsing first log = " << elapsed.count() << " ms" << " lines = " << linecount << endl; 
```

输出：

> 解析第一个日志所需的时间 = 119416 毫秒行 = 19617

```
regex c1xx("( {9}time)(.+)(c1xx\\.dll+)(.+)s");
auto start = system_clock::now();
int linecount = 0;
while (getline(inFile, currentLine))
{
    if (currentLine.size() > 200)
    {
        continue;
    }

    if (regex_match(currentLine.c_str(), cppFile))
    {
        linecount++;
        // Do something, just insert it into a vector
    }
}

auto end = system_clock::now();
auto elapsed = duration_cast<milliseconds>(end - start);
cout << "Time taken for parsing first log = " << elapsed.count() << " ms" << " lines = " << linecount << endl; 
```

输出：

> 解析第一个日志所需的时间 = 131613 毫秒行 = 9216

为什么在第二种情况下需要更多时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T02:23:20.710

> 那么为什么当我删除一半的行时，它至少不会降低一些。
> 
> 为什么在第二种情况下需要更多时间？

可以想象，该`regex`库以某种方式能够比您的大小检查更有效地过滤掉行。在您的 while 循环中引入额外的分支也可能会混淆编译器的分支预测，因此您无法获得最佳的指令流水线/预取。

> 另外，谁能告诉我哪种正则表达式更快、更通用或更具体。

如果表达式`("(.+)(c1xx.dll)(.+)")`可以工作，我相信`(".+c1xx\\.dll.+")`也可以工作，并且正则表达式不会为您保存匹配位置。

# php - 选择在 PHP 数组中找到的具有 id 的行

> ID：11148492
> 
> 赞同：0
> 
> 时间：2012-06-21T23:56:40.513
> 
> 标签：php, mysql

我想知道如何找到与数组中的一个值具有相同 ID 的所有行。所以让我们说：

```
Array(1,2,5,6,99,467); 
```

现在我想查询该数组中具有 id 的所有行，我最初的想法是循环数组并在每个字段上使用 SELECT，但我想知道是否可以使用某种 in_array 方法跳过该过程来制作一个效率更高一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T23:58:04.260

```
SELECT * 
FROM table
WHERE id IN (' . implode(', ', $arr) . ') 
```

PS：如果数据来自外部并且可以包含非数字 - 它可能值得`array_map('intval', $arr)`之前执行

# android - 从服务到 UI 层的同步消息

> ID：11148496
> 
> 赞同：1
> 
> 时间：2012-06-21T23:57:10.353
> 
> 标签：android, android-intent, android-service

广播意图的顺序是否得到保证？也就是说，如果我这样做，

```
sendBroadcast(intent1);
sendBroadcast(intent2); 
```

接收者是否保证在意图 2 之前获得意图 1？我怀疑答案是否定的，但在这种情况下，我不太确定如何解决我的问题。

我正在尝试为我的应用程序创建一个“忙碌”指示器，当设备在网络上通话时显示忙碌，然后在网络通信完成时消失。所有网络通信都发生在意图服务中。

我的尝试是在服务中开始网络通信时发送 BUSY_START 意图，并在网络通信结束时发送 BUSY_STOP。这似乎主要工作，但我偶尔会发现我的停止和启动消息无序。

有没有更好的方法来解决这个问题？

我正在考虑为每个忙碌的意图添加一个 ID，以便它们可以配对。这样，如果我收到一个我已经收到停止的开始，我可以忽略它。或者，也许更简单，在每个广播中添加一个整数序列号。如果我收到一个广播，其当前意图的序列小于上次接收到的意图的序列，请忽略它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T01:00:08.217

您是否考虑过使用`Handler`对象从后台线程进行通信`IntentService`？处理程序优于该`BroadcastReciver`方法的优点是处理程序使用消息队列对消息对象进行排序。

（我假设您的 Service 与应用程序的主线程在同一进程中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T20:32:40.247

至少一种可行的意图替代方案是通过应用程序类执行消息传递，即

1.  创建监听接口
2.  管理应用程序中的侦听器对象集合/提供添加/删除侦听器的方法
3.  感兴趣的实体调用应用程序方法来添加/删除自己作为侦听器
4.  在应用程序中添加“通知”方法，在每个注册的侦听器上调用适当的侦听器接口方法
5.  服务调用应用程序的通知方法来

例如，

```
public class MyApplication extends Application {
  public interface MyListener {
    void onEvent();
  }

  private Set<MyListener> listeners = new HashSet<Listener>();

  public void addListener(MyListener l) {
    listeners.add(l);
  }

  public void removeListener(MyListener l) {
    listeners.remove(l);
  }

  public void sendEvent() {
    for (MyListener l: listeners) { l.onEvent(); }
  }
} 
```

现在，从您的活动（或片段）中，

```
public class MyActivity extends Activity implements MyListener {
    ...
    ...
    ...

    @Override
    public void onEvent() {
      // do something
    }

    @Override
    protected void onResume() {
        super.onResume();

        ((MyApplication)getApplication()).addListener(this);
    }

    @Override
    protected void onPause() {
        super.onPause();

        ((MyApplication)getApplication()).removeListener(this);
    }
} 
```

在您的服务中，

```
((MyApplication)getApplication()).sendEvent(); 
```

这提供了不使用意图或静态变量的同步消息传递。

# javascript - 正则表达式/替换匹配组合中的任何字符

> ID：11148501
> 
> 赞同：0
> 
> 时间：2012-06-21T23:57:46.907
> 
> 标签：javascript, jquery, regex, string, replace

例如

```
var string = 'width="300" height="650"' 
```

我想更新该字符串中的高度并得到类似的东西

```
string = string.replace(/height="..."/g, 'height="150"');
//... as any symbol 
```

如何制作不关心高度值的reg表达式，用新的替换它？

你可以在这里玩它，例如： [JsFiddle](http://jsfiddle.net/MTKRY/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T00:06:22.210

```
var string = 'width="300" height="650"';
string = string.replace(new RegExp(/height=\"[0-9]+\"/g), 'height="150"'); 
```

[**演示**](http://jsfiddle.net/w3Qd9/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T00:14:07.823

对于不区分大小写的使用：

> .replace(new RegExp(/height=\"[0-9]+\"/ **gi** ), 'height="150"');

# ios - 在移动网站上播放 YouTube 视频，无需重定向到 YouTube 应用

> ID：11148503
> 
> 赞同：6
> 
> 时间：2012-06-21T23:57:58.077
> 
> 标签：ios, youtube, mobile-safari, youtube-api, mobile-website

我正在创建一个移动网站，并希望显示一个小的（88 像素 x 50 像素）YouTube 缩略图，单击该缩略图时，会全屏播放视频并将其返回到网页。它应该适用于 iOS 和 Android。

我的第一种方法是使用`<a href="http://youtube.com/watch?v=oHg5SJYRHA0>...</a>`. 但是，在 iOS 上，用户被重定向到 YouTube 应用程序，他们必须手动导航回 Safari。

接下来，我尝试嵌入一个小型 iframe 播放器

```
<iframe id="ytplayer" type="text/html" src="http://www.youtube.com/embed/T0WepLbWyq0?autoplay=1&controls=0&modestbranding=1&showinfo=0&rel=0" frameborder="0" allowfullscreen width=88 height=50></iframe> 
```

这会在 iOS 上正确弹出带有“完成”按钮的全屏视频，将用户带回 Safari 页面。但是，生成的缩略图由一个[大的红色“播放”按钮](http://i.imgur.com/Gyecm.png)控制。

有没有办法隐藏嵌入式视频上的红色播放按钮？

或者有没有另一种方法可以在网页上嵌入一个小的 YouTube 缩略图，让用户在查看完毕后返回页面？

目前，我正在考虑 a) 尝试使用允许点击通过的叠加层隐藏丑陋的红色播放按钮，或 b) 尝试获取指向 YouTube 视频文件的直接链接，因为直接链接到视频文件允许用户完成后返回浏览器。然而，这些黑客似乎复杂而脆弱。有没有更好的办法？

谢谢！

# ocaml - 如何在 Ocaml 中从文件中读取一行？

> ID：11148507
> 
> 赞同：-3
> 
> 时间：2012-06-21T23:58:25.177
> 
> 标签：ocaml, readfile

我遇到了麻烦`OCaml`，因为我想从文本文件中读取行，并且我正在使用此代码来完成这项工作：

```
 let parse3ac() = 
    let lines = ref "" in
    let chan = open_in "3ac" in
    try
      while true do
        lines := input_line chan;
    print_string(!lines);
      done;
     with End_of_file -> close_in chan;print_string("End Of File");; 
```

但它只在控制台“文件结尾”中打印，但文件中的行不会出现。

这段代码有什么问题吗？

全部感谢4！

编辑：

实际上我已经找到了它不起作用的原因。很简单，上面的代码运行的很好，但是我之前使用的文件“3ac”`OCaml`没有正确关闭，然后就无法读取文件了。谢谢大家，就像我在代码工作之前所说的那样，每个人都可以使用它。

谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:07:27.997

此代码有效，我对其进行了测试，它写入了文件 3ac 的行（没有换行符，因为您不打印它们），然后是“文件结尾”。您确定文件 3ac 不为空吗？

# javascript - 将 var 从 true 切换为 false

> ID：11148511
> 
> 赞同：0
> 
> 时间：2012-06-21T23:58:46.593
> 
> 标签：javascript, jquery, html

这是应该发生的事情：

单击按钮时，表单的提交被禁用。然后运行文本交换。文本交换完成后，cancel 的 var 应切换为 false，然后提交表单。

但是，当 var cancel 无法切换为 false 时，就会出现问题。我不知道为什么它不会。

```
<script type="text/javascript">
var cancel = true;

$("#btn-submit").click(function(){
  if (cancel = true) {
    $('form').on('submit', function(ev) {
      ev.preventDefault();
      form = $(".submit-form");
      fp = $('#free-planner');
      fp.fadeOut(350, function () {
        fp.text('Check your email!');
      });
      fp.fadeIn(350, function() { 
        var cancel = false; 
      });
    });
  }
}); 
if (cancel = false) {
  form.submit();
}
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T00:00:23.227

```
if (cancel = false) { 
```

应该

```
if (cancel == false) { 
```

`cancel = false`是赋值并且总是错误的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T00:00:18.027

不是

```
if (cancel = true) {...
if (cancel = false) {... 
```

但

```
if (cancel == true) {...
if (cancel == false) {... 
```

或更好：

```
if (cancel === true) {...
if (cancel === false) {... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T00:02:05.837

您应该在 if 条件语句中使用比较而不是赋值。

这就是你所拥有的...

```
if (cancel = true) { 
```

这就是它的样子

```
if (cancel == true) { 
```

尽管您可以轻松地省略语句的右侧

```
if(cancel){ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T07:44:05.320

```
<script type="text/javascript">
var cancel = true;

$("#btn-submit").click(function(){
  if (cancel) {
    $('form').on('submit', function(ev) {
      ev.preventDefault();
      form = $(".submit-form");
      fp = $('#free-planner');
      fp.fadeOut(350, function () {
        fp.text('Check your email!');
      });
      fp.fadeIn(350, function() { 
        var cancel = false; 
      });
    });
  }
}); 
if (!cancel) {
  form.submit();
}
</script> 
```

# iphone - viewController 如何知道应用程序何时刚刚完成启动？

> ID：11148522
> 
> 赞同：1
> 
> 时间：2012-06-22T00:00:07.967
> 
> 标签：iphone, model-view-controller, uiview, uiviewcontroller, uiapplicationdelegate

我在 xcode 4.3.1 中制作了一个简单的单视图程序。我希望视图根据它是在应用程序第一次启动时加载还是在恢复时执行不同的操作。

谁能告诉我最好的方法来做到这一点？

appDelegate 没有对我的 viewController 的引用，所以我不确定我是否可以从我的 AppDelegate didFinishLaunchingWithOptions 方法中传递一个变量。

当 ViewController 似乎没有在任何地方实例化时，AppDelegate 如何与 ViewController 通信？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:49:27.200

可以使用 NSNotificationCenter 知道应用程序何时进入前台，然后可以注册个别 VC 来关心该事件。例如：

```
- (void)loadView {
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(applicationWillEnterForeground)
                                             name:UIApplicationWillEnterForegroundNotification
                                           object:nil];
} 
```

VC 在 loadView（或任何其他方法）期间注册。然后当app进入前台时，方法

```
- (void)applicationWillEnterForeground; 
```

叫做。只要记住在 dealloc 或 viewDidUnload 中取消注册。

```
- (void)dealloc {
[[NSNotificationCenter defaultCenter] removeObserver:self];
[super dealloc];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:10:21.780

您可以使用 [application:didFinishLaunchingWithOptions:] 来确定您是否刚刚开始。它仅在您启动时调用一次。您可以将其与设置一些标志和 [applicationWillEnterForeground:(UIApplication *)application] 相结合，以确定您是启动还是只是返回前台。

# c# - .NET 按钮是否仅在至少有一个订阅者时才会触发事件？

> ID：11148523
> 
> 赞同：0
> 
> 时间：2012-06-22T00:00:09.837
> 
> 标签：c#, .net, button

我正在设计一个客户端测试脚本生成应用程序。应用程序找到提供程序中的每个自动化元素，并在提供程序中的每个自动化元素上注册一个侦听器。每当用户与提供者的 UI 交互时，自动化元素都会触发记录在我的应用程序中的事件。现在，主窗体上的按钮触发事件，但子窗体中的按钮不触发事件。我意识到子表单按钮在提供者的代码中没有订阅者。所以我的问题是，.NET 按钮是否仅在至少有一个订阅者时才会触发事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T00:21:56.160

这有点像问“如果一棵树倒在森林里而没有人听到它，它会发出声音吗？” 如果你去那里一探究竟，*就会*有人听到它。

当处理程序附加到 .NET 事件时，将创建一个集合对象并向其中添加一个委托。当一个事件发生时，框架会检查这个集合是否存在。当存在时，它的元素会被枚举和调用，否则事件调度会提前终止。

“[D]o .NET 按钮只有在至少有一个订阅者的情况下才会触发事件？”

如果“触发事件”是指“调用委托来调用事件处理程序”，那么显然只有在有委托时才会发生这种*情况*。显然，如果没有，那么它们就不能被调用。在“框架是否在没有委托时*寻找*要调用的委托”的意义上，那么事件*确实*在没有处理程序的情况下触发。

# xml - XML 数据问题

> ID：11148528
> 
> 赞同：0
> 
> 时间：2012-06-22T00:00:20.737
> 
> 标签：xml, actionscript-3, actionscript

我当前用于制作 XML、添加数据并保存它的代码是：

```
import flash.events.MouseEvent;
import flash.net.FileReference;
import flash.events.Event;

stop();

btn_exit.addEventListener(MouseEvent.CLICK, exitConfirm);  //IGNORE THIS
btn_submit.addEventListener(MouseEvent.CLICK, submitData);   //Submit data event

//IGNORE THIS
function exitConfirm(e:MouseEvent):void {
    gotoAndPlay(5);
}

//On "CLICK", Submit data event
function submitData(e:MouseEvent):void {
    var loader:URLLoader = new URLLoader();
    loader.addEventListener(Event.COMPLETE, loadXML);
    loader.load(new URLRequest("events.xml"));

    function loadXML(e:Event):void {
        xml = new XML(e.target.data);
        trace(xml);
    }

    var file:FileReference = new FileReference;
    var app:XML = <app/>; 

    app.titles = comp_title.text;
    app.titles.category = comp_category.text;
    app.titles.place = comp_place.text;
    app.titles.dateDay = null;
    app.titles.dateMonth = null;
    app.titles.dateYear = null;
    app.titles.gear = null;

    file.save(app, "events.xml");
} 
```

我的问题是它只在 XML 文件中创建此代码。我已经尝试在其中添加更多代码以首先在现有 XML 上查找数据，然后获取该数据并添加新数据，但它似乎不起作用。我什至不确定它是否可能，所以这就是我来这里的原因。任何帮助都是好帮助！

PS AS3 对我来说还是相当新的。我对此并不可怕，但我也不好:)

干杯! :D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T02:01:32.327

在将更新的 XML 整体保存到文件系统之前，您需要加载现有的 XML 并添加新数据：

1.  [在 ActionScript 3.0 中加载 XML](http://www.leebrimelow.com/?p=242)
2.  [在 ActionScript 3.0 中使用 XML](http://willperone.net/Code/as3xml.php)

**编辑：**

以下应该工作。我已经包含评论来解释某些决定：

```
import flash.events.IOErrorEvent;
import flash.net.URLLoader;
import flash.net.FileReference;
import flash.events.MouseEvent;

btn_exit.addEventListener(MouseEvent.CLICK, exitConfirm);  //IGNORE THIS
btn_submit.addEventListener(MouseEvent.CLICK, submitData);   //Submit data event

// store path in a variable so we don't need to write it out each time we need it
var xmlPath:String = "events.xml";
var xml:XML;

var loader:URLLoader;

//IGNORE THIS
function exitConfirm(e:MouseEvent):void {
   gotoAndPlay(5);
}

loadXML();

// Best bet is to load the existing XML up-front because you can only trigger the 
// FileReference save method from a handler invoked directly from a user interaction. 
// See: http://stackoverflow.com/questions/3301839/flexs-filereference-save-can-only-be-called-in-a-user-event-handler-how-ca
function loadXML():void {
    loader = new URLLoader();
    loader.addEventListener(IOErrorEvent.IO_ERROR, xmlLoadErrorHandler);
    loader.addEventListener(Event.COMPLETE, xmlLoadHandler);
    loader.load(new URLRequest(xmlPath));
}

function xmlLoadHandler(e:Event):void {
    xml = new XML(e.target.data);
    removeListeners();
    trace("Loaded XML", xml);
}

// Handle the possibility of path not existing
function xmlLoadErrorHandler(e:IOErrorEvent):void {
    xml = <app></app>;
    removeListeners();
    trace("Error, XML did not exist, creating new empty XML");
}

// Process the data and save to file system
function submitData(e:MouseEvent):void {
    var file:FileReference = new FileReference();

    // Append the new title node to the existing XML. 
    // From now on, XML in memory matches exactly what is on file-system
    xml.appendChild(getTitle()); 

    file.save(xml, xmlPath);
}

// Returns a populated title node
function getTitle():XML {
    var xml:XML = <title></title>

    //replace hardcoded strings with your variables
    xml.category = "category"; 
    xml.place = "place";
    xml.dateDay = "day";
    xml.dateMonth = "month";
    xml.dateYear = "year";
    xml.gear = "gear";

    return xml;
}

// It's good practice to remove event listeners when you're finished with them
function removeListeners() {
    loader.removeEventListener(Event.COMPLETE, xmlLoadHandler);
    loader.removeEventListener(IOErrorEvent.IO_ERROR, xmlLoadErrorHandler);
} 
```

# c# - 关闭并清理 ViewModel 中的视图

> ID：11148532
> 
> 赞同：3
> 
> 时间：2012-06-22T00:00:43.163
> 
> 标签：c#, wpf, xaml, mvvm

我的应用程序使用著名的 IDialogService 的变体创建了许多子视图。我现在需要在发生特定事件或事件集时以编程方式关闭这些视图。

首先，我应该如何最好地公开 Views 的 Close 方法，请记住

1.  视图的 DataContext (ViewModel) 必须被处理和
2.  必须为每个正在关闭的视图调用 View.Dispatcher.InvokeShutdown。

到目前为止，我已经混合了附加行为来挂钩到 Closing 事件以处理清理和 ViewModel 上的操作，例如

```
vm.OnCloseAction = ()=> view.Close(); 
```

处理从 ViewModel 实际关闭视图。

不过，这对我来说并不是特别优雅。有没有人有任何其他想法或替代方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T01:59:02.187

一个想法是使用您正在使用的任何消息传递框架（例如我使用的 MVVM Light 中的 Messenger），设置关闭消息（或类似的东西）并在关闭注册时有任何需要做的事情对于那个结束消息。

# css - CSS 文本转换字符

> ID：11148533
> 
> 赞同：2
> 
> 时间：2012-06-22T00:00:44.253
> 
> 标签：css, character-encoding, lowercase

我正在使用`text-transform: lowercase;`代码来小写我的用户帖子。但是当我使用这个代码字符时，比如：“i,ş,ç,ü,ğ”会变成别的东西。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T07:50:01.287

似乎不会`text-transform`引起任何问题

[http://jsfiddle.net/m9fpX/](http://jsfiddle.net/m9fpX/)

你在设置吗

```
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T07:46:15.517

声明`text-transform: lowercase`保持小写字母不变。任何浏览器都不太可能有这个问题。如果您删除 CSS 声明，您很可能会将这些字母视为“其他东西”。

很可能问题出在其他地方，即用户输入到网页内容的传输中。由于字符编码问题，这里很容易出错。需要更多关于这种情况的信息（一个 URL 将是一个好的开始，“其他东西”的描述也是如此）来分析它们，并且该问题将属于不同的标题。

关于小写，通常应该在服务器端执行，而不是在 CSS 中。请注意，`text-transform: lowercase`无法正确处理土耳其语或阿塞拜疆语文本，因为它无条件地将“I”和“İ”映射到“i”，而不是“ı”和“i”。[Firefox 14](https://developer.mozilla.org/en/CSS/text-transform)已承诺对它们提供适当的支持，可能会在使用该`lang`属性适当定义内容语言时使用，但这种处理需要很长时间才能在浏览器中通用。在服务器端处理中，通常很容易将其作为特殊情况处理。

# c# - EF 4.3.1 如何使用每种类型的表映射子子类

> ID：11148534
> 
> 赞同：2
> 
> 时间：2012-06-22T00:00:47.700
> 
> 标签：c#, entity-framework-4.3

我有一个名为 Party 的抽象基类。有几个具体的子类（Company、Person、Department）。Party 有一个名为 PartyType 的属性，用作鉴别器。每种类型都在自己的表中，配置如下

```
Map<Person>(p => p.Requires("PartyType").HasValue("Person").ToTable("People"); 
```

一切正常。现在我想添加一个名为 Employee 的 Person 子类。我如何映射这个？我试过了

```
Map<Employee>(e => e.Requires("PartyType").HasValue("Employee")
   .ToTable("Employees"); 
```

但这会产生运行时错误

> (43,10)：错误 3032：从第 43、84 行开始映射片段时出现问题：EntityTypes WOL.EFData.Person、WOL.EFData.Employee 被映射到 People 表中的相同行。映射条件可用于区分这些类型映射到的行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:01:36.140

在每个类型映射的表中，EF 不期望有鉴别器配置。

```
modelBuilder.Entity<Person>().ToTable("People");
modelBuilder.Entity<Employee>().ToTable("Employees"); 
```

有关更多信息，请参阅[本文](http://weblogs.asp.net/manavi/archive/2010/12/28/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-2-table-per-type-tpt.aspx)。

# javascript - 可拖动 SVG 形状的代码上的 Javascript 错误

> ID：11148537
> 
> 赞同：0
> 
> 时间：2012-06-22T00:01:07.660
> 
> 标签：javascript, html, svg

我正在使用通过[**这篇文章**](https://stackoverflow.com/questions/11128785/set-an-html-input-value-by-draggable-svg-shape-or-canvas/11129028)提供的一些代码，由@Phrogz 提供。
我现在已经根据我的需要对其进行了调整和调整，因此我正在尝试将该 JS 插入我的测试页面。我在 Pastebin 上
扔[**了一份我的测试页。**](http://pastebin.com/MM90KxK5)

我收到此错误（由第 126 行提供）：
***Uncaught TypeError: Cannot call method 'addEventListener' of null***

到目前为止，我的尝试都围绕着*updateFromInput*函数是错误的核心这一猜测展开。我用我能想到的所有方式玩它，没有骰子:)
当然，虽然，我从成为 JS 大师开始，所以*......*

有人可以解释为什么错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:08:34.667

显然， input_1 为空。

~~问题可能出在 querySelector 上。您可以改为尝试 getElementsByClassName。~~

哦，您元素上的类是“input1”，但您选择的是“input_1”。容易出错:)

# javascript - 使用 javascript 库自定义形状的图形

> ID：11148550
> 
> 赞同：0
> 
> 时间：2012-06-22T00:02:48.847
> 
> 标签：javascript, css, graph, raphael, graphael

有没有办法我可以制作对话气泡的形状并在 raphael js 中显示对话气泡内的统计信息

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:51:30.097

Graphael 为文本气泡提供了一些默认方法：

```
Raphael.fn.g.tag(x,y,text,angle,r)
Raphael.fn.g.flag(x,y,text,angle)
Raphael.fn.g.label(x,y,text)
Raphael.fn.g.blob(x,y,text,angle,size)
Raphael.fn.g.popup(x,y,text,dir,size) 
```

所以，例如...

```
window.onload = function(){
     var r = Raphael('graph');
     var flag = r.flag(100,100,"Hello!",15);
} 
```

如果这些不能减少芥末，那么您将需要创建自己的 svg 路径。然后，您可能想查看 Dmitry 在此处提供的一些路径：[http ://raphaeljs.com/icons/](http://raphaeljs.com/icons/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T01:19:02.383

Rafael 语法似乎类似于 HTML5 画布。您应该能够只创建笔触坐标来绘制您希望气泡出现的形状。

# vpn - 响应未从 Tcp 侦听器发送

> ID：11148553
> 
> 赞同：2
> 
> 时间：2012-06-22T00:03:13.357
> 
> 标签：vpn, tcplistener, hl7

我创建了一个简单的 TCP 侦听器来处理 HL7 消息，我正在正确接收消息，并尝试发回 ACK 消息。另一端的服务器似乎没有收到响应，您是否发现此设置有任何问题？

我意识到它需要重构一点，现在我只是试图建立连接。

```
class Server
{
    private TcpListener tcpListener;
    private Thread listenThread;

    public Server()
    {
        this.tcpListener = new TcpListener(IPAddress.Parse("hidden"), 55555);
        this.listenThread = new Thread(new ThreadStart(ListenForClients));
        this.listenThread.Start();
    }

    private void ListenForClients()
    {
        this.tcpListener.Start();

        while (true)
        {
            TcpClient client = this.tcpListener.AcceptTcpClient();

            Thread clientThread = new Thread(new ParameterizedThreadStart(HandleClientComm));
            clientThread.Start(client);
        }
    }

    private void HandleClientComm(object client)
    {
        TcpClient tcpClient = (TcpClient)client;
        NetworkStream clientStream = tcpClient.GetStream();

        byte[] message = new byte[4096];
        int bytesRead;

        while (true)
        {
            bytesRead = 0;

            try
            {
                bytesRead = clientStream.Read(message, 0, 4096);
            }
            catch
            {
                break;
            }

            if (bytesRead == 0)
            {
                break;
            }

            ASCIIEncoding encoder = new ASCIIEncoding();
            string result = encoder.GetString(message, 0, bytesRead);

            string[] Lines = result.Split('\n');
            string id = "";
            foreach (string line in Lines)
            {
                string[] values = line.Split('|');
                if (values[0].Contains("MSH"))
                {
                    id = values[9];

                    byte[] buffer = encoder.GetBytes("\\vMSH|^~\\&|Rhapsody|JCL|EpicADT|JCL-EPIC-TEST|||ACK|A" + id + "|P|2.4|\\nMSA|AA|" + id + "|");

                    Console.WriteLine("MSH|^~\\&|Rhapsody|Test|EpicADT|TEST|||ACK|A" + id + "|P|2.4|\\nMSA|AA|" + id + "|");

                    clientStream.Write(buffer, 0, buffer.Length);
                    clientStream.Flush();
                }
            }
        }

        tcpClient.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-10-24T13:12:09.290

当您在套接字上读取消息和写入响应时，我没有看到[MLLP实现。](https://blog.interfaceware.com/common-hl7-transports/)

**通常**MLLP 是必需的，并且大多数应用程序都会验证 MLLP 块。如果没有 MLLP，客户端只会跳过您在套接字上写入的数据。

显然，如果没有 MLLP，您的应用程序没有任何问题。如果客户端未实现 MLLP，则此答案无效。

我已经在我的[另一个](https://stackoverflow.com/a/56250840/5779732)答案中更详细地解释了这一点。

# matlab - 将逗号分隔的文件转换为 matlab 矩阵

> ID：11148555
> 
> 赞同：0
> 
> 时间：2012-06-22T00:03:38.333
> 
> 标签：matlab, file-io, matrix

我有一个逗号分隔的文件，格式如下：

```
Col1Name,Col1Val1,Col1Val2,Col1Val3,...Col1ValN,Col2Name,Col2Val1,...Col2ValN,...,ColMName,ColMVal1,...,ColMValN 
```

我的问题是，如何将此文件转换为 Matlab 可以视为矩阵的东西，以及如何在文件中使用该矩阵？我想我可以使用一些脚本语言将文件格式化为 matlab 矩阵格式并复制它，但文件相当大（~7mb）。

谢谢！

抱歉编辑：

文件格式为：

```
Col1Name;Col2Name;Col3Name;...;ColNName
Col1Val1;Col2Val2;Col3Val3;...;ColNVal1
...
Col1ValM;Col2ValM;Col3ValM;...;VolNValM 
```

以下是一些实际数据：

```
Press;Temp.;CondF;Cond20;O2%;O2ppm;pH;NO3;Chl(a);PhycoEr;PhycoCy;PAR;DATE;TIME;excel.date;date.time
0.96;20.011;432.1;431.9;125.1;11.34;8.999;134;9.2;2.53;1.85;16.302;08.06.2011;12:01:52;40702;40702.0.5
1;20.011;433;432.8;125;11.34;9;133.7;8.19;3.32;2.02;17.06;08.06.2011;12:01:54;40702;40702.0.5
1.1;20.012;432.7;432.4;125.1;11.34;9;133.8;8.35;2.13;2.2;19.007;08.06.2011;12:01:55;40702;40702.0.5
1.2;20.012;432.8;432.5;125.2;11.35;9.001;133.8;8.45;2.95;1.95;21.054;08.06.2011;12:01:56;40702;40702.0.5
1.3;20.012;432.7;432.4;125.4;11.37;9.002;133.7;8.62;3.17;1.87;22.934;08.06.2011;12:01:57;40702;40702.0.5
1.4;20.007;432.1;431.9;125.2;11.35;9.003;133.7;9.48;4.17;1.6;24.828;08.06.2011;12:01:58;40702;40702.0.5
1.5;19.997;432.3;432.2;124.9;11.33;9.003;133.8;8.5;3.84;1.79;27.327;08.06.2011;12:01:59;40702;40702.0.5
1.6;20;432.8;432.6;124.5;11.29;9.003;133.6;8.57;3.22;1.86;30.259;08.06.2011;12:02:00;40702;40702.0.5
1.7;19.99;431.9;431.9;124.4;11.28;9.002;133.6;8.79;3.7;1.81;35.152;08.06.2011;12:02:02;40702;40702.0.5
1.8;19.994;432.1;432.1;124.4;11.28;9.002;133.6;8.58;3.41;1.84;39.098;08.06.2011;12:02:03;40702;40702.0.5
1.9;19.993;433;432.9;124.6;11.3;9.002;133.6;8.59;3.45;5.53;45.488;08.06.2011;12:02:04;40702;40702.0.5
2;19.994;433;432.9;124.8;11.32;9.002;133.5;8.6;2.76;1.99;50.646;08.06.2011;12:02:05;40702;40702.0.5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:33:53.433

如果您不知道前面的行数和列数，则不能使用以前的解决方案。改用这个。

7 Mb 不是很大，很小。这是21世纪。

要读入 matlab 矩阵：

```
 text = fileread('file.name'); % a string with the entire file contents in it.  7 Mb is no big deal.
    NAMES = {}; % we'll record column names here
    VALUES = []; % this will be the matrix of values

    while text(end) = ','
        text(end)=[]; % elimnate any trailing commas
    end

    commas = find(text==','); % Index all the commas
    commas = [0;commas(:);length(commas)+1] % put fake commas before and after text to simplify loop

    col = 0; % which column are we in

    I = 1;
    while I<length(commas) 
        txt = text(commas(I)+1:commas(I+1)-1);
        I = I+1;
        num = str2double(txt);
        if isnan(num) % this means it must be a column name
            NAMES{end+1,1} = txt;
            col = col+1; % can you believe Matlab doesn't support col++ ???
            row = 1; % back to the top at each new column
            continue % we have dealt with this txt, its not a num so ... next
        end

        % if we made it here we have a number
        VALUES(row,col) = num;
    end 
```

然后，您可以将您的 matlab 矩阵`VALUES`以及标题名称（如果您希望它们以 matlab 格式保存`NAMES`到 matlab 格式文件中）

```
 save('mymatrix.mat','VALUES','NAMES'); % saves matrix and column names to .mat file 
```

当您想要从文件中获取内容时，您可以通过以下方式将内容返回到 matlab：

```
 load mymatrix.mat; % loads VALUES and NAMES from .mat file 
```

* * *

一些限制：

您不能在列标题名称中使用逗号。

您不能“命名”一列，例如“898.2”或任何可以读取为双数的内容，它将被读取为一个数字。

如果您的列具有不同的长度，则较短的列将用零填充到最长列的长度。

这就是我能想到的。

# .net - WCF 数据服务 5.0 SDK 示例

> ID：11148557
> 
> 赞同：0
> 
> 时间：2012-06-22T00:03:42.483
> 
> 标签：.net, wcf-data-services

从以下位置下载并安装 WCF 数据服务 5.0

[适用于 OData V3 的 WCF 数据服务 5.0](http://www.microsoft.com/en-us/download/details.aspx?id=29306)

根据下面的链接，它应该包含一些代码示例。但我找不到代码示例。有谁知道是否真的有代码示例，如果有，在哪里？我正在寻找数据服务提供者的代码示例。

[www.odata.org/developers](http://www.odata.org/developers)

可能的情况是代码示例在以前的版本中。如果有人知道最新版本的数据服务提供程序代码示例，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T08:50:08.630

无类型自定义提供程序的示例是 OData 提供程序工具包的一部分：[http ://www.odata.org/ecosystem#samplecode](http://www.odata.org/ecosystem#samplecode)

# jenkins - 詹金斯上的xcodebuild

> ID：11148563
> 
> 赞同：0
> 
> 时间：2012-06-22T00:04:40.163
> 
> 标签：jenkins, xcodebuild

我对此感到沮丧，非常感谢任何帮助

我们在 Mac OSX 上为我们的 CI 环境设置了 jenkins，用于构建我们的 xcode 项目。使用 SVn 配置所有内容，以便在构建时同步所有内容

代码签名错误：默认钥匙串中没有有效的证书/私钥对

据我所知，Jenkins 正在守护进程下运行，并且我在该机器上以自己的身份登录，所以经过数小时的查找后，我也将 Iphone 开发人员证书从 login.keychain 复制到了 system.keychain，现在出现此错误。找不到与应用程序标识符“MZCZ .... Icacher”匹配的有效配置文件

所以我删了

正如有人建议的那样，我什至也按照此处的建议将会话创建设置为 info.plist [Missing certificate and keys in the keychain while using Jenkins/Hudson as Continuous Integration for iOS and Mac development](https://stackoverflow.com/questions/6827874/missing-certificates-and-keys-in-the-keychain-while-using-jenkins-hudson-as-cont/9482707#9482707)

这也做了

为了为 Jenkins/Hudson 保留一个分隔的钥匙串，我将 launchctl 项目从

/Library/LaunchDaemons/org.jenkins-ci.plist 到

/Users/Shared/Jenkins/Home/Library/LaunchAgents/org.jenkins-ci.plist

这就是我的启动守护进程 org.jenkins-ci.plist 的样子

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>EnvironmentVariables</key>
    <dict>
        <key>JENKINS_HOME</key>
        <string>/Users/Shared/Jenkins/Home</string>
    </dict>
    <key>GroupName</key>
    <string>daemon</string>
    <key>KeepAlive</key>
    <true/>
    <key>Label</key>
    <string>org.jenkins-ci</string>
    <key>ProgramArguments</key>
    <array>
                <string>/bin/bash</string>
        <string>/Library/Application Support/Jenkins/jenkins-runner.sh</string>
    </array>
    <key>RunAtLoad</key>
    <true/>
    <key>UserName</key>
    <string>daemon</string>
    <key>SessionCreate</key>
</dict>
</plist> 
```

请帮助我已经用完了选项

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:23:54.330

我们刚刚遇到了这个问题。您需要添加 SessionCreate 键，但在您的示例中，您忘记`<true/>`在它之后添加。

# javascript - Google 电子表格应用中的自定义自动完成功能

> ID：11148564
> 
> 赞同：1
> 
> 时间：2012-06-22T00:04:41.593
> 
> 标签：javascript, google-apps-script, google-apps

我的问题如下，当您开始在谷歌电子表格单元格上输入时，是否有任何教程说明如何做到这一点，属于自定义列表的字段包含（文本上的任何位置）输入的字符出现在下拉列表中。

我不太了解 Javascript，所以如果有任何书籍或参考资料可以找到类似的东西，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:30:34.603

我是新手，我不知道有什么方法可以根据用户开始输入的内容（进入单元格）来选择有效值。

我知道这不能在脚本中完成。所有脚本在用户进行所有更改（对单元格）后运行。

您可能已经知道使用定义范围的下拉验证列表。此过程会在框的右边缘附近放置一个小的向下箭头。它允许用户从预定义的列表中进行选择。它不会阻止最终用户输入无效值。如果它不同意列表中的条目之一，它只会将它们的值标记为无效。通过按下向下箭头，将显示有效值列表。用户可以通过单击来选择列表中的条目。

我从文档中了解了这个验证。如果这就是你所需要的，那么你可以在这里停下来。

* * *

对我来说，这种验证方法的有趣之处在于：

1.  您可以定义列表并为其命名。无效的错误消息将包含名称。您可以使用名称来指示验证错误的类型。

2.  该列表可以包含在不同的工作表上，而不是被引用。可以隐藏包含列表的工作表。

3.  如果您向列表区域添加的行不是底行，（插入下方）电子表格引擎将自动调整定义范围的大小。在列表中输入的新值出现在更新的下拉列表中（按照它们在范围定义中出现的顺序）。

我没有测试的是从脚本中扩展列表。如果更改来自脚本，我不知道电子表格引擎是否会执行相同的范围修改。我希望它会。

另外我不知道您是否从脚本中更改了隐藏的工作表，那么隐藏的工作表会保持隐藏状态。我知道当您从脚本执行“复制表”功能时，源表会暂时变为当前状态，因此不再隐藏。

希望这可以帮助。

# opengl - 渲染具有多个索引的网格

> ID：11148567
> 
> 赞同：61
> 
> 时间：2012-06-22T00:05:01.737
> 
> 标签：opengl, opengl-es, webgl, direct3d, vulkan

我有一些顶点数据。位置、法线、纹理坐标。我可能从 .obj 文件或其他格式加载它。也许我在画一个立方体。但是每条顶点数据都有自己的索引。我可以使用 OpenGL/Direct3D 渲染这个网格数据吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-06-22T00:05:02.203

在最一般的意义上，没有。OpenGL 和 Direct3D 只允许每个顶点有一个索引；索引从每个顶点数据流中获取。因此，每个唯一的组件组合都必须有自己的单独索引。

因此，如果您有一个立方体，其中每个面都有自己的法线，您将需要大量复制位置和法线数据。您将需要 24 个位置和 24 个法线，即使立方体只有 8个*唯一*位置和 6 个唯一法线。

您最好的选择是简单地接受您的数据会更大。许多模型格式将使用多个索引；您需要先修复此顶点数据，然后才能使用它进行渲染。许多网格加载工具，例如 Open Asset Importer，将为您执行此修复。

还应注意，大多数网格*不是立方体*。大多数网格在绝大多数顶点上都是平滑的，只是偶尔会有不同的法线/纹理坐标等。因此，虽然这通常出现在简单的几何形状中，但实际模型很少有大量的顶点重复。

## GL 3.x 和 D3D10

对于 D3D10/OpenGL 3.x 类硬件，可以避免执行修复并直接使用多个索引属性。但是，请注意，这可能会降低渲染性能。

以下讨论将使用 OpenGL 术语，但 Direct3D v10 及更高版本具有等效功能。

这个想法是从顶点着色器手动访问不同的顶点属性。不是直接发送顶点属性，而是传递的属性实际上是该特定顶点的索引。然后顶点着色器使用索引通过一个或多个[缓冲区纹理](http://www.opengl.org/wiki/Buffer_Texture)访问实际属性。

属性可以存储在多个缓冲区纹理中或全部存储在一个中。如果使用后者，那么着色器将需要一个偏移量来添加到每个索引，以便在缓冲区中找到相应属性的起始索引。

可以通过多种方式压缩常规顶点属性。缓冲区纹理的压缩方式较少，仅允许相对[有限数量的顶点格式（通过它们支持的图像格式）。](http://www.opengl.org/wiki/Buffer_Texture#Image_formats)

请再次注意，这些技术中的任何一种都可能降低整体顶点处理性能。因此，它应该只在内存最有限的情况下使用，在所有其他压缩或优化选项都已用尽之后。

OpenGL ES 3.0 也提供缓冲纹理。更高的 OpenGL 版本允许您通过[SSBO](https://www.khronos.org/opengl/wiki/Shader_Storage_Buffer_Object)而不是缓冲区纹理更直接地读取缓冲区对象，后者可能具有更好的性能特征。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-10-16T07:50:21.957

我找到了一种方法，可以让你减少这种与其他答案中的一些陈述有点相反的重复（但并不特别适合这里提出的问题）。然而，它确实解决[了我的问题](https://stackoverflow.com/questions/52361930/other-forms-of-indexing-for-gl-draw)，这个问题被认为是这个问题的重复。

我刚刚了解了[插值限定符](https://www.khronos.org/opengl/wiki/Type_Qualifier_%28GLSL%29#Interpolation_qualifiers)。特别是“平”。我的理解是，将 flat 限定符放在顶点着色器输出上只会导致[挑衅顶点](https://www.khronos.org/opengl/wiki/Provoking_Vertex#Provoking_vertex)将其值传递给片段着色器。

这意味着对于此引用中描述的情况：

> 因此，如果您有一个立方体，其中每个面都有自己的法线，您将需要大量复制位置和法线数据。您将需要 24 个位置和 24 个法线，即使立方体只有 8 个唯一位置和 6 个唯一法线。

您可以有 8 个顶点，其中 6 个包含唯一法线，而忽略 2 个法线值，只要您仔细排序基元索引，以便“激发顶点”包含您要应用于整个面部的法线数据。

编辑：我对其工作原理的理解：

[![在此处输入图像描述](../Images/66dde26cf4ed1e83818d51fb6133f5e2.png)](https://i.stack.imgur.com/oQ2fF.png)

[![在此处输入图像描述](../Images/0dfb400497dbc7dfb412976f1e831ff4.png)](https://i.stack.imgur.com/tRBuY.png)

[![在此处输入图像描述](../Images/2df39e647b2df0a81cecd066ce136982.png)](https://i.stack.imgur.com/sjbaH.png)

[![在此处输入图像描述](../Images/8782ef05ccc102626ebe6f4dd0c21c4e.png)](https://i.stack.imgur.com/QjJKn.png)

# c - 为什么像这样初始化二维数组会更糟 ？

> ID：11148575
> 
> 赞同：12
> 
> 时间：2012-06-22T00:06:05.597
> 
> 标签：c, arrays, assembly, multidimensional-array, localityofreference

```
for(int i = 0; i<100; i++)

    for(int j = 0; j<100; j++)

         array[j][i] = 0;
         // array[i][j] = 0; 
```

我的教授说，与第二种方式相比，以第一种方式初始化二维数组的成本要高得多。有人可以解释导致这种情况的引擎盖下发生了什么吗？或者，这两种初始化方式是否具有相同的性能？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-22T00:13:33.133

正如@dlev 提到的，这是由于*[参考的局部性，](http://en.wikipedia.org/wiki/Locality_of_reference)*并且与计算机中物理硬件的工作方式有关。

在计算机内部，有许多不同类型的内存。通常，只有某些内存位置（寄存器）才能对其执行实际操作；其余时间，如果您对数据执行操作，则必须将其从内存加载到寄存器中，执行一些计算，然后将其写回。

主存储器 (RAM) 比寄存器慢得多，通常要慢数百到数千倍。因此，应尽可能避免从内存中读取。为了解决这个问题，大多数计算机通常具有称为[缓存](http://en.wikipedia.org/wiki/CPU_cache)的特殊内存区域。缓存的工作是保存最近从内存中访问过的数据，这样如果再次访问相同的内存区域，则可以从缓存中（快速）而不是从主内存（慢）中提取值。通常，缓存的设计是这样的，如果从内存中读取一个值，则该值加上一大堆相邻的值被拉入缓存。这样，如果您遍历数组，则在读取第一个值之后，数组中的其余值将位于缓存中，并且可以更有效地访问。

您的代码比它需要的慢的原因是它没有按顺序访问数组元素。在 C 中，二维数组以[行优先顺序排列](http://en.wikipedia.org/wiki/Row-major_order)，这意味着内存排列为

```
A[0][0] A[0][4] A[0][5] ... A[1][0] A[1][6] A[1][7] ... A[2][0] A[2][8] A[2][9] ... 
```

因此，如果你使用这个 for 循环：

```
for (int i = 0; i < N; i++) {
    for (int j = 0; j < M; j++) {
        // Do something with A[i][j]
    }
} 
```

然后您将获得极好的局部性，因为您将按照数组元素在内存中出现的顺序访问它们。这使得主内存的读取次数非常少，因为所有内容通常都在缓存中并准备就绪。

但是，如果您像您所做的那样交换循环，您的访问会在内存中跳转并且不一定是连续的。这意味着您将有很多*缓存未命中*，其中您接下来读取的内存地址不在缓存中。这会增加缓存加载的数量，这会大大降低程序的速度。

编译器开始变得足够聪明，可以自动交换这样的循环，但我们距离忽略这些细节还有很长的路要走。作为一般规则，在为多维数组编写 C 或 C++ 代码时，请尝试以行优先顺序而不是列优先顺序进行迭代。您可以在程序中获得明显的加速。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-22T01:26:46.463

我可能会因此而被否决，但是如果您正在编写 C 语言，那么“最好的”很可能是：

memset（数组，0，sizeof（数组））；

然后，您可以将所有优化（您显然担心）的责任推迟到 memset 的实现上。任何特定的硬件优势都可以在那里实现。

[http://en.wikipedia.org/wiki/Sizeof#Using_sizeof_with_arrays/](http://en.wikipedia.org/wiki/Sizeof#Using_sizeof_with_arrays/)

[http://www.cplusplus.com/reference/clibrary/cstring/memset/](http://www.cplusplus.com/reference/clibrary/cstring/memset/)

另一个观察是，如果你初始化为零，问问自己为什么？如果您的数组是静态的（对于这么大的可能是哪个？），那么 cstartup 将为您初始化为零。同样，这可能会为您的硬件使用最有效的方式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-10T14:38:08.193

我参加聚会有点晚了，已经有一个很好的答案。但是，我认为我可以通过演示如何使用分析工具（在 Linux 上）通过实验回答这个问题来做出贡献。

我将使用[`perf`](https://perf.wiki.kernel.org/index.php/Main_Page)Ubuntu 10.10 软件包中的工具`linux-tools-common`。

这是我为回答这个问题而编写的小 C 程序：

```
// test.c
#define DIM 1024

int main()
{
    int v[DIM][DIM];
    unsigned i, j;

    for (i = 0; i < DIM; i++) {
        for (j = 0; j < DIM; j++) {
#ifdef ROW_MAJOR_ORDER
            v[i][j] = 0;
#else
            v[j][i] = 0;
#endif
        }
    }

    return 0;
} 
```

然后编译两个不同的版本：

```
$ gcc test.c -O0 -DROW_MAJOR_ORDER -o row-maj
$ gcc test.c -O0 -o row-min 
```

注意我已经禁用了优化，`-O0`所以 gcc 没有机会重新安排我们的循环以提高效率。

`perf`我们可以通过做列出可用的性能统计信息`perf list`。在这种情况下，我们对缓存未命中感兴趣，即事件`cache-misses`。

现在它就像多次运行程序的每个版本并取平均值一样简单：

```
$ perf stat -e cache-misses -r 100 ./row-min

 Performance counter stats for './row-min' (100 runs):

             286468  cache-misses               ( +-   0.810% )

        0.016588860  seconds time elapsed   ( +-   0.926% )

$ perf stat -e cache-misses -r 100 ./row-maj

 Performance counter stats for './row-maj' (100 runs):

               9594  cache-misses               ( +-   1.203% )

        0.006791615  seconds time elapsed   ( +-   0.840% ) 
```

现在我们已经通过实验验证，您确实看到“row-minor”版本的缓存未命中率增加了两个数量级。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-22T00:13:54.387

如果您查看每种技术访问的内存位置，第二个将访问连续字节，而第一个将跳跃 100 个字节。如果您采用第二种方式，内存缓存的工作效率会更高。

# git - 为什么排除的文件不断重新出现在我的 git sparse checkout 中？

> ID：11148579
> 
> 赞同：13
> 
> 时间：2012-06-22T00:06:58.217
> 
> 标签：git, sparse-checkout

我使用[GCC git 镜像](http://gcc.gnu.org/wiki/GitMirror)，因为我只使用 C 和 C++ 前端，所以我使用 git 的稀疏检出功能来排除数百个我不需要的文件：

```
$ git config core.sparseCheckout
true
$ cat .git/info/sparse-checkout 
/*
!gnattools/
!libada/
!libgfortran/
!libgo/
!libjava/
!libobjc/
!libquadmath/
!gcc/ada/
!gcc/fortran/
!gcc/go/
!gcc/java/
!gcc/objc/
!gcc/objcp/
!gcc/testsuite/ada/
!gcc/testsuite/gfortran.dg/
!gcc/testsuite/gfortran.fortran-torture/
!gcc/testsuite/gnat.dg/
!gcc/testsuite/go.dg/
!gcc/testsuite/go.go-torture/
!gcc/testsuite/go.test/
!gcc/testsuite/objc/
!gcc/testsuite/objc.dg/
!gcc/testsuite/obj-c++.dg/
!gcc/testsuite/objc-obj-c++-shared/ 
```

这工作了一段时间，但时不时地我注意到其中一些被排除的文件已经返回，有时*很多*：

```
$ ls gnattools/
ChangeLog  configure  configure.ac  Makefile.in
$ ls  gcc/fortran/ | wc -l 
86 
```

我不确定文件何时重新出现，我做了很多切换到不同的分支（远程跟踪和本地），这是一个非常繁忙的存储库，因此经常有新的更改需要拉取。

作为 git 的相对新手，我不知道如何“重置”我的工作树以再次摆脱这些文件。

作为一个实验，我尝试禁用稀疏签出和拉取，以为我可以在之后再次启用 sparseCheckout 以某种方式更新树，但这并没有很好地工作：

```
$ git config core.sparseCheckout false
$ git config core.sparseCheckout 
false
$ git pull
remote: Counting objects: 276, done.
remote: Compressing objects: 100% (115/115), done.
remote: Total 117 (delta 98), reused 0 (delta 0)
Receiving objects: 100% (117/117), 64.05 KiB, done.
Resolving deltas: 100% (98/98), completed with 64 local objects.
From git://gcc.gnu.org/git/gcc
   7618909..0984ea0  gcc-4_5-branch -> origin/gcc-4_5-branch
   b96fd63..bb95412  gcc-4_6-branch -> origin/gcc-4_6-branch
   d2cdd74..2e8ef12  gcc-4_7-branch -> origin/gcc-4_7-branch
   c62ec2b..fd9cb2c  master     -> origin/master
   2e2713b..29daec8  melt-branch -> origin/melt-branch
   c62ec2b..fd9cb2c  trunk      -> origin/trunk
Updating c62ec2b..fd9cb2c
error: Your local changes to the following files would be overwritten by merge:
        gcc/fortran/ChangeLog
        gcc/fortran/iresolve.c
        libgfortran/ChangeLog
        libgfortran/io/intrinsics.c
Please, commit your changes or stash them before you can merge.
Aborting 
```

所以显然我对我从未要求过的文件进行了本地修改，AFAIK 从未接触过！

但`git status`没有显示这些变化：

```
$ git st
# On branch master
# Your branch is behind 'origin/master' by 9 commits, and can be fast-forwarded.
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#       libstdc++-v3/53270.txt
#       libstdc++-v3/TODO 
```

我试过`git read-tree -m -u HEAD`了，但它什么也没做。

所以我的问题是：

*   为什么文件会重新出现？
*   如何让它们再次消失？
*   我如何防止他们回来？
*   这是否可能与我的`.git/info/exclude`文件包含对文件中应该排除（即命名为`!`）的目录中的文件的引用有关`sparse-checkout`？我按照说明[忽略了与 SVN 相同的文件](http://gcc.gnu.org/wiki/GitMirror#Commit_on_trunk)

    `$ git svn show-ignore >> .git/info/exclude`

所以我的`exclude`文件包括路径，如

```
# /gcc/fortran/
/gcc/fortran/TAGS
/gcc/fortran/TAGS.sub
/gcc/fortran/gfortran.info* 
```

这将在`sparse-checkout`文件中命名的目录之一之下：

```
!gcc/fortran/ 
```

我试图用一个测试仓库重现这个问题，我克隆了几个副本并编辑每个副本，创建/切换/删除分支并合并它们之间的更改，但在我的玩具测试用例中它永远不会出错。GCC 存储库有点大（超过 2GB），并且“失败”之间的时间（大约一两个星期）太长，无法期望人们尝试准确地重现问题。我*没有*`sparse-checkout`尝试过在and中使用相同的路径`exclude`，因为我今天才想到那里可能存在冲突。

几周前，我在 freenode 上的#git 上询问了这个问题，IIRC 基本上被告知“这可能是一个错误，没有人使用稀疏结帐”，但我希望得到更好的答案 ;-)

**更新：**

我最近一次看到问题实际上发生了（即文件不存在，然后在单个命令之后出现）是从上游源拉取：

```
 bac6f1f..6c760a6  master     -> origin/master 
```

显示的更改包括这些重命名：

```
 create mode 100644 libgo/go/crypto/x509/root.go
 rename libgo/go/crypto/{tls => x509}/root_darwin.go (90%)
 rename libgo/go/crypto/{tls => x509}/root_stub.go (51%)
 rename libgo/go/crypto/{tls => x509}/root_unix.go (76%)
 create mode 100644 libgo/go/crypto/x509/root_windows.go 
```

根据需要，在拉取目录之前，该`libgo`目录不存在。在拉出该目录并且这些文件（并且没有其他文件）在它下面之后：

```
$ ls libgo/go/crypto/x509/root_<TAB>
root_darwin.go  root_stub.go    root_unix.go 
```

我不知道重命名的文件是否丢失了`skip-worktree`位，我该如何检查？

我很确定在重命名时问题并不总是发生，因为`libgfortran/ChangeLog`例如上面示例中显示的文件不是新文件或最近重命名的文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T08:17:46.410

可以使用 修改 skip-worktree 位`git update-index --skip-worktree`。当您注意到存在的文件时，您可以检查`git ls-files -v |grep ^S`（S 是标有 skip-worktree 的文件）。

但正如#git 人所说，如果你看到奇怪的行为，那很可能是 git 中的错误。毕竟，这是一个相当深奥的功能。您可能应该将您的发现报告给 git 邮件列表。

**编辑**：另外，如果您使用的是 git 1.7.7.6，我强烈建议您升级。1.7.10 tree 遥遥领先，我认为它很有可能会解决你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-19T21:45:39.233

就我而言，我正在使用稀疏结帐对 repo 执行一些单元测试。我的一个测试用例创建了包含未包含在我的稀疏结帐子树列表中的文件的提交。

当我尝试时`git reset --hard 123456`，我收到以下错误：

```
error: Entry 'a.c' not uptodate. Cannot update sparse checkout.
fatal: Could not reset index file to revision '123456'. 
```

解决方案是通过重新应用稀疏签出规则来删除我的工作树中的文件：

```
git read-tree -mu HEAD 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-26T19:05:49.953

检查问题是否在最新的 Git 2.13（2017 年第二季度，5 年后）中仍然存在。
任何 skip-worktree 文件都不应在稀疏结帐期间被修改甚至查看，因为：

> [`preload-index`代码](https://github.com/git/git/blob/c7e234fc380747b7be979bcebd4eece7601f6bfe/preload-index.c)已被教导不要打扰索引条目，这些索引条目是未通过“稀疏签出”签出的路径。

请参阅[Jeff Hostetler (](https://github.com/jeffhostetler) [)的](https://github.com/jeffhostetler)[提交 e596acc](https://github.com/git/git/commit/e596acc23a8c92784349da613502626d758215b2)（2017 年 2 月 10 日） 。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 c7e234f](https://github.com/git/git/commit/c7e234fc380747b7be979bcebd4eece7601f6bfe))^(中，2017 年 2 月 27 日）)[`jeffhostetler`](https://github.com/jeffhostetler)
^([`gitster`](https://github.com/gitster))

> ## `preload-index``lstat`:避免`skip-worktree`物品

> 教导`preload-index`避免`lstat()`调用设置了跳过工作树位的索引条目。
> 这是性能优化。
> 
> 在稀疏签出期间，skip-worktree 位设置在未填充的项目上，因此不存在于工作树中。
> 每线程预加载索引循环对每个索引条目执行一系列测试，因为它尝试将工作树版本与索引进行比较并将它们标记为最新。
> 这个补丁捷径有效。
> 
> 在具有非常大的 repo（450MB 索引）和各种稀疏级别的 Windows 10 系统上，性能在这种`{preloadindex=true, fscache=false}`情况下提高了 80%，在`{preloadindex=true, fscache=true}`各种命令的情况下提高了 20%。

* * *

在 Git 2.27（2020 年第二季度）中，“ `sparse-checkout`”以不同的方式管理 skip-worktree。

请参阅[提交5644CA2](https://github.com/git/git/commit/5644ca28cded68972c74614fc06d6e0e1db1a7de)，[提交EBB5637](https://github.com/git/git/commit/681c637b4ae1c46c09edda62a1aed6eaa69a2649)，[提交22ab0b3](https://github.com/git/git/commit/ebb568b9e2539ce2dbb3853ff3d4869a5c690601)，[提交1AC83F4](https://github.com/git/git/commit/22ab0b37d85080d8932e992e183b2f86e67bff19)，[提交CD002C1](https://github.com/git/git/commit/6271d77cb1ccfb7e4124593b4463446fe1188cda)，[提交4EE5D50](https://github.com/git/git/commit/1ac83f42da6437d74098f162fcfa37474c94e223)，[提交](https://github.com/git/git/commit/cd002c15611a995a29b9e5881745bba402d63952)F56F31A ，[Commit](https://github.com/git/git/commit/4ee5d50fc39f8d41f67c3c9a936084fb914c9a50) [7AF7A25](https://github.com/git/git/commit/f56f31af0301f6446f8689ba1a997d74fb82f45f)，[Commit](https://github.com/git/git/commit/7af7a25853cb87f34d192ba1d813ca09ee15d9f4) [30E89C1](https://github.com/git/git/commit/30e89c12f0afc5c4382b531973a5e82b60d402bd)，[Commit 3CC7A25](https://github.com/git/git/commit/3cc7c50402ce1cbac9735da64844eb00bc096f46)，[提交B0A5A12](https://github.com/git/git/commit/b0a5a12a60393237f98ec4b0fcf2b7d3c3232a2a)，[提交72064E](https://github.com/git/git/commit/72064ee578a59d4511cab17496c5246af02397f3)，[提交](https://github.com/git/git/commit/d7dc1e1668fcbd5af019d0bc059b8dcb35743c86)[FA0BDE4](https://github.com/git/git/commit/fa0bde45cdebee8bac95e66e4bf5ba16c77fbdba)，提交[D61633A](https://github.com/git/git/commit/d61633ae186d26ab2c216108c917ec0ae7dd2782)，提交[d7dc1e1](https://github.com/git/git/commit/d7dc1e1668fcbd5af019d0bc059b8dcb35743c86)，[提交 031ba55](https://github.com/git/git/commit/031ba55b6b474559dd8db6df5479416964e0dc30)（2020 年 3 月 27 日），作者[Elijah Newren ( `newren`)](https://github.com/newren)。
^(（由[Junio C Hamano 合并 -- `gitster`--](https://github.com/gitster)在[提交 48eee46](https://github.com/git/git/commit/48eee46d6accbb6ef491f811fd9a9c72843d469b)中，2020 年 4 月 29 日）)

> ## [`unpack-trees`](https://github.com/git/git/commit/681c637b4ae1c46c09edda62a1aed6eaa69a2649): 未能设置`SKIP_WORKTREE`位总是只是一个警告
> 
> ^(审核人：Derrick Stolee)
> ^(签字人：Elijah Newren)

> 位的设置和清除`SKIP_WORKTREE`不仅在用户运行'sparse-checkout'时完成；其他命令（例如“checkout”）也会运行，`unpack_trees()`其中包含处理此特殊位的逻辑。因此，我们需要考虑他们如何处理特殊情况。
> 
> 几个比较点应该有助于解释更改`unpack_trees()`处理这些位的方式的基本原理：
> 
> *   暂时忽略稀疏检出，如果您正在切换分支并且有脏更改，则仅当脏文件恰好是具有不同内容的路径之一时，才会认为会阻止分支切换成功的错误。
>     
>     
> *   `SKIP_WORKTREE`一直被认为是建议性的；例如，如果 rebase 或 merge 需要甚至想要将路径具体化作为他们工作的一部分，那么无论`SKIP_WORKTREE`设置如何，他们总是被允许这样做。
>     这已用于未合并的路径，但它通常用于不需要的路径，因为它使代码更简单。
>     这是一个尽力而为的考虑，当它实现与`SKIP_WORKTREE`设置相反的路径时，甚至不需要打印警告消息。
>     
>     
> 
> 过去，如果您尝试运行例如“git checkout”并且：
> 
> 1.  你有一个具体化的路径并且有一些肮脏的变化
> 2.  路径列在 $GITDIR/info/sparse-checkout
> 3.  这条路径在当前分支和目标分支之间没有区别
> 
> 然后尽管有上述比较点，但无法设置`SKIP_WORKTREE`被视为会中止结帐操作的**硬错误。**
> 
> 这与其他地方的处理方式完全不一致`SKIP_WORKTREE`，并且对于用户来说相当烦人，因为将路径物化在工作副本中（带有一个简单的警告）应该完全没有问题。
> 
> 将任何错误从无法将该`SKIP_WORKTREE`位切换为警告并允许操作继续进行。

所以消息不再是：

> ```
> error: The following untracked working tree files would be overwritten by checkout: 
> ```

但：

> ```
> warning: The following paths were already present and thus not updated despite sparse patterns: 
> ```

* * *

在 Git 2.28（2020 年第三季度）中，“git clone --no-checkout”状态下“sparse-checkout”的行为在 2.27 中意外更改，已更正。

请参阅[Elijah Newren ( ) 的](https://github.com/newren)[提交 b5bfc08](https://github.com/git/git/commit/b5bfc08a972da3dba0ab19e3252b1cbbef90777b)（2020 年 6 月 5日[）](https://github.com/newren)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 a554228](https://github.com/git/git/commit/a554228ffb417b75c4ab586f084079ac98665c1a))^(中，2020 年 6 月 18 日）)[`newren`](https://github.com/newren)
^([`gitster`](https://github.com/gitster))

> ## [`sparse-checkout`](https://github.com/git/git/commit/b5bfc08a972da3dba0ab19e3252b1cbbef90777b): 避免暂存删除所有文件
> 
> ^(签字人：以利亚·纽伦)

> sparse-checkout 的目的是更新工作树以使其反映跟踪文件的子集。
> 
> 因此，它不应该切换分支、提交、下载或上传数据，或者暂存或取消暂存更改。
> 
> 除了更新工作树之外，sparse-checkout 唯一应该触及的是`SKIP_WORKTREE`索引的位。
> 
> 特别是，这设置了一个很好的不变量：运行 sparse-checkout 永远不会改变其中任何文件的状态`git status`（这反映了我们仅`SKIP_WORKTREE`在文件可以安全删除时设置该位的事实，即如果文件未修改）。
> 
> 传统上，我们在`_really`这个目标上做得很糟糕。
> 
> sparse-checkout 的前身涉及手动编辑 .git/info/sparse-checkout 和运行 .git/info/sparse-checkout `git read-tree -mu HEAD`。
> 
> 该命令将暂存和取消暂存更改，并覆盖工作树中的脏更改。
> 
> sparse-checkout 命令的初始实现也好不到哪里去；它只是`git read-tree -mu HEAD`作为一个子流程调用并且有相同的警告，尽管这个问题在审查评论中反复出现，并且在合并该功能之前就解决了这些问题 [1, 2, 3, 4, 5, 6; 尤其见 4 和 6]。
> 
> *   (1) [https://lore.kernel.org/git/CABPp-BFT9A5n=_bx5LsjCvbogqwSjiwgr5amcjgbU1iAk4KLJg@mail.gmail.com/](https://lore.kernel.org/git/CABPp-BFT9A5n=_bx5LsjCvbogqwSjiwgr5amcjgbU1iAk4KLJg@mail.gmail.com/)
> *   (2) [https://lore.kernel.org/git/CABPp-BEmwSwg4tgJg6nVG8a3Hpn_g-=ZjApZF4EiJO+qVgu4uw@mail.gmail.com/](https://lore.kernel.org/git/CABPp-BEmwSwg4tgJg6nVG8a3Hpn_g-=ZjApZF4EiJO+qVgu4uw@mail.gmail.com/)
> *   (3) [https://lore.kernel.org/git/CABPp-BFV7TA0qwZCQpHCqx9N+JifyRyuBQ-pZ_oGfe-NOgyh7A@mail.gmail.com/](https://lore.kernel.org/git/CABPp-BFV7TA0qwZCQpHCqx9N+JifyRyuBQ-pZ_oGfe-NOgyh7A@mail.gmail.com/)
> *   (4) [https://lore.kernel.org/git/CABPp-BHYCCD+Vx5fq35jH82eHc1-P53Lz_aGNpHJNcx9kg2K-A@mail.gmail.com/](https://lore.kernel.org/git/CABPp-BHYCCD+Vx5fq35jH82eHc1-P53Lz_aGNpHJNcx9kg2K-A@mail.gmail.com/)
> *   (5) [https://lore.kernel.org/git/CABPp-BF+JWYZfDqp2Tn4AEKVp4b0YMA=Mbz4Nz62D-gGgiduYQ@mail.gmail.com/](https://lore.kernel.org/git/CABPp-BF+JWYZfDqp2Tn4AEKVp4b0YMA=Mbz4Nz62D-gGgiduYQ@mail.gmail.com/)
> *   (6) [https://lore.kernel.org/git/20191121163706.GV23183@szeder.dev/](https://lore.kernel.org/git/20191121163706.GV23183@szeder.dev/)
> 
> 但是，这些变通方法除了在一些重要情况下禁用该功能外，还遗漏了一种特殊情况。
> 
> 我稍后再谈。
> 
> `git read-tree -mu HEAD`在 2.27.0 周期中，通过最终用我们想要的东西替换内部等效项来解除禁用该功能：新`update_sparsity()`函数[`unpack-trees.c`](https://github.com/git/git/blob/b5bfc08a972da3dba0ab19e3252b1cbbef90777b/unpack-trees.c)只更新`SKIP_WORKTREE`索引中的位并更新工作树以匹配。
> 
> 这个新函数处理所有对旧实现有问题的情况，除了它打破了相同的特殊情况，避免了旧实现的变通办法，但以不同的方式打破了它。
> 
> 所以...这给我们带来了特殊情况：a[`git clone`](https://git-scm.com/docs/git-clone)用 . 执行`--no-checkout`。
> 
> 根据标志的含义，`--no-checkout`不检查任何分支，这意味着您不在一个分支上，需要在克隆后切换到一个分支。
> 
> 在实现上， HEAD 仍然设置（所以在某种意义上你部分在一个分支上），但是：
> 
> *   索引是“未出生的”（不存在）
> *   工作树中没有文件（.git/ 除外）
> *   下次运行 git switch（或 git checkout）时，它将运行 unpack_trees，并将`initial_checkout`标志设置为 true。
> 
> 直到您运行，例如[`git switch <somebranch>`](https://git-scm.com/docs/git-switch)，才会写入索引并填充工作树中的文件。
> 
> 在这种特殊`--no-checkout`情况下，传统的`read-tree -mu HEAD`行为相当于结账——切换到默认分支 (HEAD)，写出与 HEAD 匹配的索引，并更新工作树以匹配。
> 
> 这种特殊情况跳过了原始 sparse-checkout 命令中的 Avoid-making-changes 检查，因此继续存在。
> 
> 在`update_sparsity()`被引入和使用之后（参见[commit f56f31af03](https://github.com/git/git/commit/f56f31af0301f6446f8689ba1a997d74fb82f45f) (" `sparse-checkout`: use new `update_sparsity()`function", 2020-03-27, Git v2.27.0-rc0 -- [merge](https://github.com/git/git/commit/48eee46d6accbb6ef491f811fd9a9c72843d469b)列在[第 #5 批](https://github.com/git/git/commit/d61d20c9b413225793f8a0b491bbbec61c184e26)中））， --no-checkout 案例的行为更改：由于 git 对空内存索引的自动激活（请参阅`do_read_index()`并注意这`must_exist`是错误的），并且由于 sparse-checkout 的`update_working_directory()`代码总是在完成后写出索引，我们遇到了一个新错误。
> 
> 这使得 sparse-checkout 将存储库从具有“未出生”索引的克隆切换（即仍然需要一个`initial_checkout),`具有记录索引但没有条目的存储库。
> 
> 因此，不是所有文件`git status`都被 git 视为尚未在分支上的特殊工件而被删除，而是我们对空索引的记录使 git 突然看起来好像它肯定在所有文件暂存的分支上删除！
> 随后的结帐或切换必须应对这样一个事实，即它不在一个`initial_checkout`但有一堆分阶段删除。
> 
> 确保 sparse-checkout 除了`SKIP_WORKTREE`位之外没有改变索引中的任何内容；特别是，当索引未诞生时，我们没有签出任何分支，因此无需进行稀疏化或去稀疏化工作。
> 
> `update_working_directory()`只需早点回来。

* * *

[`git reset`](https://github.com/git/git/blob/f0850875fd44a58cd1eae349244327b2eff29fa7/Documentation/git-reset.txt)在 Git 2.35 (Q1 2022) 中，" " ^(( [man](https://git-scm.com/docs/git-reset) ))的各种操作模式已更好地与稀疏索引一起工作。

请参见[Victoria Dye ( ) 的](https://github.com/vdye)[提交 f2a454e](https://github.com/git/git/commit/f2a454e0a5e26c0f7b840970f69d195c37b16565)、[提交 4d1cfc1](https://github.com/git/git/commit/4d1cfc1351ffec47bba1318e9cd1ed13c5182951)、[提交 20ec2d0](https://github.com/git/git/commit/20ec2d034cda1afef15a4dcc6e275d7a69413510)、[提交 c01b1cb](https://github.com/git/git/commit/c01b1cbd473c05e29fe0c1a31b8f6539e82c4559)、[提交 291d77e](https://github.com/git/git/commit/291d77eb3e28aee42821d500bf61211f09b4297a)（2021 年 11 月 29 日）、[提交 86609db](https://github.com/git/git/commit/86609db9dae77a385ea8c156ac4ca55f8454a3f7)、[提交 71471b2](https://github.com/git/git/commit/71471b2a7c72415a52e0c84182098e8856ceab7a)（2021 年 10 月 27 日）和[提交 1f86b7c](https://github.com/git/git/commit/1f86b7cb6396ea5f8cd612041938e7d3280e4002)（2021 年 10 月 7 日[）](https://github.com/vdye)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 f085087](https://github.com/git/git/commit/f0850875fd44a58cd1eae349244327b2eff29fa7))^(中，2021 年 12 月 10 日）)[`vdye`](https://github.com/vdye)
^([`gitster`](https://github.com/gitster))

> ## [`sparse-index`](https://github.com/git/git/commit/86609db9dae77a385ea8c156ac4ca55f8454a3f7): 更新展开/折叠测试的命令
> 
> ^(帮助者：Derrick Stolee)
> ^(签字者：Victoria Dye)

> 预期^( ^([man](https://git-scm.com/docs/git-reset#Documentation/git-reset.txt---hard)) ^)能够使用稀疏索引而不扩展它，请将命令替换为^( ^([man](https://git-scm.com/docs/git-reset#Documentation/git-reset.txt---no-recurse-submodules)) ^)。 该命令需要扩展索引才能正常工作，即使在将其余部分与稀疏索引集成后也是如此。[`git reset --hard`](https://github.com/git/git/blob/86609db9dae77a385ea8c156ac4ca55f8454a3f7/Documentation/git-reset.txt#L70)`sparse-index is expanded and converted back`[`git reset -- folder1/a`](https://github.com/git/git/blob/86609db9dae77a385ea8c156ac4ca55f8454a3f7/Documentation/git-reset.txt#L91)
> `reset`

# jquery - 使用 ckeditor 将外部页面加载到 div 中

> ID：11148580
> 
> 赞同：0
> 
> 时间：2012-06-22T00:07:04.050
> 
> 标签：jquery, prototypejs, ckeditor, external

这是我使用 ckeditor (in.php) 的外部页面的代码

```
<html>   
<head>   
<script type="text/javascript" src="ckeditor/ckeditor.js"></script>
</head>   
<body>       
<textarea name=ck ></textarea>
<script type="text/javascript">
CKEDITOR.replace( 'ck' );
</script>
</body> </html> 
```

这是我试图将此页面加载到的页面的代码（out.php）

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script type="text/javascript" src="ckeditor/ckeditor.js"></script>

<script>
$(document).ready( function () { $('#page').load('in.php');

});

</script>
</head>

<body>
<div id=page ></div>
</body>
</html> 
```

加载 out.php 没有任何显示，并且在 IE 对象中出现预期错误。另一方面， in.php 可以独立工作。

任何人都可以提出任何解决方案吗？我已经尝试过`getScript`，将函数放入其中并在 2 页上来回放置代码，但没有任何效果。如果有人可以提供原型解决方案，我也会很感兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:12:42.570

您正在使用 jQuery，所以不要忘记包含 jQuery 库：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
```

# c# - 为什么 Parallel.Foreach 会创建无限线程？

> ID：11148586
> 
> 赞同：1
> 
> 时间：2012-06-22T00:07:51.023
> 
> 标签：c#, .net, multithreading, task-parallel-library

下面的代码继续创建线程，即使队列为空..直到最终发生 OutOfMemory 异常。如果我用常规 foreach 替换 Parallel.ForEach，则不会发生这种情况。有人知道为什么会发生这种情况吗？

```
public delegate void DataChangedDelegate(DataItem obj);

public class Consumer
{
    public DataChangedDelegate OnCustomerChanged;
    public DataChangedDelegate OnOrdersChanged;

    private CancellationTokenSource cts;
    private CancellationToken ct;
    private BlockingCollection<DataItem> queue;

    public Consumer(BlockingCollection<DataItem> queue) {
        this.queue = queue;
        Start();
    }

    private void Start() {
        cts = new CancellationTokenSource();
        ct = cts.Token;
        Task.Factory.StartNew(() => DoWork(), ct);
    }

    private void DoWork() {

        Parallel.ForEach(queue.GetConsumingPartitioner(), item => {
            if (item.DataType == DataTypes.Customer) {
                OnCustomerChanged(item);
            } else if(item.DataType == DataTypes.Order) {
                OnOrdersChanged(item);
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T07:01:23.497

我认为`Parallel.ForEach()`主要用于处理有界集合。并且它不会期望像由返回的集合那样`GetConsumingPartitioner()`阻塞`MoveNext()`很长时间。

问题是它`Parallel.ForEach()`试图找到最好的并行度，所以它开始运行的次数`Task`与`TaskScheduler`允许运行的次数一样多。但是`TaskScheduler`看到有很多`Task`s 需要很长时间才能完成，并且他们没有做任何事情（他们阻止）所以它继续开始新的。

我认为最好的解决方案是设置`MaxDegreeOfParallelism`.

作为替代方案，您可以使用 TPL Dataflow 的`ActionBlock`. 这种情况下的主要区别在于，`ActionBlock`当没有要处理的项目时不会阻塞任何线程，因此线程数不会接近限制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-23T01:08:38.263

生产者/消费者模式主要用于只有一个生产者和一个消费者的情况。

但是，您想要实现的目标（多个消费者）更符合 Worklist 模式。以下代码取自犹他大学教授的并行编程课程中 unit2 幻灯片“2c - 共享内存模式”的幻灯片，可在[http://ppcp.codeplex.com/下载](http://ppcp.codeplex.com/)

```
BlockingCollection<Item> workList;
CancellationTokenSource cts;
int itemcount

public void Run()
{
  int num_workers = 4;

  //create worklist, filled with initial work
  worklist = new BlockingCollection<Item>(
    new ConcurrentQueue<Item>(GetInitialWork()));

  cts = new CancellationTokenSource();
  itemcount = worklist.Count();

  for( int i = 0; i < num_workers; i++)
    Task.Factory.StartNew( RunWorker );
}

IEnumberable<Item> GetInitialWork() { ... }

public void RunWorker() {
  try  {
    do {
      Item i = worklist.Take( cts.Token );
      //blocks until item available or cancelled
          Process(i);
      //exit loop if no more items left
    } while (Interlocked.Decrement( ref itemcount) > 0);
  } finally {
      if( ! cts.IsCancellationRequested )
        cts.Cancel();
    }
  }
}

public void AddWork( Item item) {
  Interlocked.Increment( ref itemcount );
  worklist.Add(item);
}

public void Process( Item i ) 
{
  //Do what you want to the work item here.
} 
```

前面的代码允许您将工作列表项添加到队列中，并允许您设置任意数量的工作人员（在本例中为四个）以将项目从队列中拉出并处理它们。

.Net 4.0 上的 Parallelism 的另一个重要资源是“使用 Microsoft .Net 进行并行编程”一书，可在以下网址免费获得：http: [//msdn.microsoft.com/en-us/library/ff963553](http://msdn.microsoft.com/en-us/library/ff963553)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T23:59:56.097

在任务并行库的内部，Parallel.For 和 Parallel.Foreach 遵循爬山算法来确定操作应该使用多少并行度。

或多或少，他们从在一项任务上运行主体开始，移动到两项，依此类推，直到达到断点，他们需要减少任务的数量。

这对于快速完成的方法体非常有效，但如果方法体需要很长时间才能运行，它可能需要很长时间才能意识到它需要减少并行度。在那之前，它会继续添加任务，并可能导致计算机崩溃。

我是在 Task Parallel Library 的一位开发人员的讲座中了解到以上内容的。

指定 MaxDegreeOfParallelism 可能是最简单的方法。

# ruby-on-rails - Rails 使用 Rubber Gem 部署到 Amazon EC2 时出错

> ID：11148588
> 
> 赞同：1
> 
> 时间：2012-06-22T00:08:02.280
> 
> 标签：ruby-on-rails, deployment, amazon-ec2, amazon

试图弄清楚如何克服这两个错误，想知道你是否能指出我正确的方向。大量的谷歌搜索没有任何效果。使用 rails 3.2.1 并尝试使用 Rubber 2.0.1 部署到 Amazon EC2。如果您需要任何其他信息，请告诉我，谢谢！：

```
Rubber[INFO]: Transformation executing post config command: function error_exit { exit 99; }; trap error_exit ERR

config : 'option forwardfor' ignored for proxy 'passenger_proxy_ssl' as it requires HTTP mode. 
```

这是我的 deploy.rb [http://pastebin.com/6CdCP7DY](http://pastebin.com/6CdCP7DY)

这是我的 Rubber.yml 文件 [http://pastebin.com/7tUcrMqF](http://pastebin.com/7tUcrMqF)

如果您需要任何其他信息，请告诉我...谢谢！

# javascript - JSON字符串化的问题？

> ID：11148591
> 
> 赞同：0
> 
> 时间：2012-06-22T00:08:47.813
> 
> 标签：javascript, jquery, json

```
/* Helper function to clean up any current data we have stored */
function insertSerializedData(ids, type) {
    // Get anything in the current field
    current_data = $('#changes').val();
    if (!current_data) {
        var data = new Array();
        data[type] = ids;
        $('#changes').val(JSON.stringify(data));
    } else {
        var data = JSON.parse($('#changes').val());
        data[type] = ids;
        $('#changes').val(JSON.stringify(data));
    }
    console.log($('#changes').val());
} 
```

我正在使用以下函数将数据添加到当前 JSON 对象或创建一个新的 JSON 对象，以便稍后在 PHP 中使用。stringify() 方法是否仅适用于 FF？我正在使用谷歌浏览器，并且在使用 conosole.log() 函数时得到一个空对象...

另外，如果您尝试使用相同的键存储两个值会发生什么？我假设它会覆盖......所以我应该在最后的数组中添加一个随机数学数字，以防止重复出现？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:14:55.353

这些行可能会导致问题：

```
var data = new Array();
data[type] = ids; 
```

... 因为 JavaScript 中的数组与 PHP 中的数组不太一样。我想你的意思是更好地表达...

```
var data = {};
data[type] = ids; 
```

此外，`current_data`似乎是这个函数的本地函数，因此它也应该用 . 声明为本地的`var`。没有看到任何其他问题......除了类似的功能已经在 jQuery [.data()](http://api.jquery.com/jQuery.data/)方法中实现。

更新：这里是[jsFiddle](http://jsfiddle.net/qaShL/)玩。) 从我的尝试看来，数组对象不匹配实际上是导致 Chrome 行为的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:26:18.093

我重新格式化了一下，但这似乎有效。它将`#changes`元素的“value”属性设置为 JSON 字符串。我假设`type`参数应该是您要分配的数组的索引？

```
function insertSerializedData(ids, type) {
  var changes = jQuery('#changes'), arr, val = changes.val();
  if (!val) {
    arr = [];
    arr[type] = ids;
    changes.val(JSON.stringify(arr));
  } else {
    arr = JSON.parse(val);
    arr[type] = ids;
    changes.val(JSON.stringify(arr));
  }
  console.log(changes);
} 
```

# c++ - 找到隐藏的无限循环

> ID：11148595
> 
> 赞同：2
> 
> 时间：2012-06-22T00:09:47.060
> 
> 标签：c++

我正在解决[这个问题](http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&problem=82)，我的解决方案似乎适用于我可以想象尝试的所有案例，并且在 3 秒的时间限制内完成，但是当我在线提交时它仍然超过 3 秒。我认为一定有一种情况导致这个while循环无限期地进行：

```
while (!equals(availableChars, testChars)){
        next = getNextAlphaString(high, next, availableChars, it);      
        fillCharSet(next, testChars);       
    } 
```

但我已经测试了我的功能，但我无法弄清楚它是什么......希望你们能看到一些东西。以下是辅助函数：

```
bool equals(multiset<char>& availableChars, multiset<char>& test){  
    multiset<char>::iterator it;
    for (it = availableChars.begin(); it != availableChars.end(); it++){
        if ((int)availableChars.count(*it) != (int)test.count(*it)) return false;
    }
    return true;
} 
```

*

```
string getNextAlphaString(char& high, string next, multiset<char>& availableChars, multiset<char>::iterator& it){   
for (int i=next.size()-1; i>=0; i--){

    if (next[i] != high){
        it = availableChars.find(next[i]); 
        while(*it == next[i]){
            it++;           
            if (it == availableChars.end()){it = availableChars.begin(); break;}
        }
        next[i] = *it;
        break;}
    else{
        it = availableChars.begin();
        next[i] = *it;
    }       
}
return next;
} 
```

*

```
void fillCharSet(string in, multiset<char>& chars){
    chars.clear();
    for (int i=0; i<in.size(); i++){chars.insert(in[i]);}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:30:10.697

这是一篇使用 GDB 检测无限循环的文章：

[http://www.unknownroad.com/rtfm/gdbtut/gdbinfloop.html](http://www.unknownroad.com/rtfm/gdbtut/gdbinfloop.html)

希望这可以帮助您解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:29:07.943

好吧……我来回答我自己的问题。我用 next_permutation 重写了它，它变得更加简单和高效。我仍然没有用其他解决方案解决实际的循环问题，但现在我不需要了。谢谢大家的提示:)

# asp.net - 无法让我的数据库播种 ASP.NET MVC 3

> ID：11148597
> 
> 赞同：0
> 
> 时间：2012-06-22T00:09:51.293
> 
> 标签：asp.net, asp.net-mvc-3

我在尝试让我的数据库首先使用实体​​框架/代码播种时遇到问题。我是 .NET 的初学者，我尝试了许多解决方案，但没有一个对我有用。

我究竟做错了什么？我正在发布最相关的代码......任何帮助将不胜感激。

样本数据.cs

```
 namespace seed2.Models
{
    public class SampleData : DropCreateDatabaseAlways<AirplaneDB>
    {
        protected override void Seed(AirplaneDB context)
        {
            var airplane = new List<Airplane>()
            {
                new Airplane { AirplaneId = 1, Make = "Great Planes"},
                new Airplane { AirplaneId = 2, Make = "Eflite"}
            };
            base.Seed(context);
        }

    }
} 
```

网络配置

```
<add name="AirplaneDB"
     connectionString="data source=|DataDirectory|Airplanes.sdf"
     providerName="System.Data.SqlServerCe.4.0"/> 
```

AirplaneDB.cs（上下文）

```
public class AirplaneDB : DbContext
{
    public DbSet<Airplane> Airplanes { get; set; }
} 
```

飞机.cs

```
public class Airplane
{
    public int AirplaneId { get; set; }
    public string Make { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:16:59.277

首先，将其添加到 Global.asax.cs 的 Application_Start() 方法中：

```
System.Data.Entity.Database.SetInitializer(new seed2.Models.SampleData()); 
```

确保您实际上是在浏览器中刷新视图。重新构建解决方案不会为数据库播种。

最后，您应该在种子方法中添加`airplane.ForEach(x => context.Airplanes.Add(x));`和删除`base.Seed(context)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:14:18.370

我看不到您保存更改，例如 context.SaveChanges() 请尝试在 base.Seed(context) 之后添加此行

# svn - 如何配置 TortoiseSVN 的外部合并行为？

> ID：11148598
> 
> 赞同：13
> 
> 时间：2012-06-22T00:09:53.223
> 
> 标签：svn, tortoisesvn, beyondcompare

与 TortoiseSVN 合并后，我在运行冲突解决时遇到了一些问题。

我试图让它将数据发送到 BeyondCompare 并使用它的 3 路合并功能。不幸的是，它发送文件的顺序与 BeyondCompare 所期望的顺序不同，因此合并完全错误。

如果我在资源管理器中右键单击并说 TortoiseSVN-> 设置，然后在外部程序-> 合并工具下我可以指定 BeyondCompare 的路径，但那里没有关于参数的任何内容。如何重新排序它发送到外部合并工具的参数，以便我可以在 BeyondCompare 中正确显示内容？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-22T00:35:29.967

您可以在对话框中控制`BComp.exe`TortoiseSVN发送到外部合并应用程序（在本例中）的参数。`TortoiseSVN->Settings->Merge Tools`

[BC 支持文档](http://www.scootersoftware.com/support.php?zz=kb_vcs#tortoisesvn)中有一个使用 BeyondCompare 进行双向和三向合并的示例：

```
3-way Merge (v3 Pro)

1\.    Select Settings from Explorer's TortoisSVN submenu.
2\.    Switch to the Merge Tool tab.
3\.    Change the radio buttons from TortoiseMerge to External.
4\.    In the path edits, enter:
5\.    "C:\Program Files\Beyond Compare 3\BComp.exe" %mine %theirs %base %merged /title1=%yname /title2=%tname /title3=%bname /title4=%mname 

2-way Merge (v3 Std, v2)

Use the same steps as above, but use the command line:

`"C:\Program Files\Beyond Compare 3\BComp.exe" %mine %theirs /savetarget=%merged` 
```

这在[Tortoise SVN 文档](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-settings.html)部分`4.30.5.2`（无子主题链接 - 搜索页面`Merge Tool`）中进行了介绍：

> 参数替换的使用方式与 Diff 程序相同。
> 
> `%base` - 没有您或其他人更改的原始文件
> 
> `%bname`- 基本文件的窗口标题
> 
> `%mine`- 您自己的文件，以及您的更改
> 
> `%yname`- 文件的窗口标题
> 
> `%theirs`- 存储库中的文件
> 
> `%tname`- 存储库中文件的窗口标题
> 
> `%merged`- 冲突文件，合并操作的结果
> 
> `%mname`- 合并文件的窗口标题
> 
> 例如，使用 Perforce 合并：
> 
> `C:\Path-To\P4Merge.exe %base %theirs %mine %merged`
> 
> 或使用 KDiff3：
> 
> `C:\Path-To\kdiff3.exe %base %mine %theirs -o %merged --L1 %bname --L2 %yname --L3 %tname`
> 
> 或使用 Araxis：
> 
> `C:\Path-To\compare.exe /max /wait /3 /title1:%tname /title2:%bname /title3:%yname %theirs %base %mine %merged /a2`
> 
> 或使用 WinMerge（2.8 或更高版本）： `C:\Path-To\WinMerge.exe %merged`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-05T10:07:48.677

上面的答案对我们不起作用，因为对参数的解释是有帮助但错误的（至少对我们来说）

对我们来说正确的顺序是： `[Path]\BCompare.exe %base %mine %theirs %merged`

这里的诀窍是交换 %theirs 和 %merged ，因为 Beyond Compare 将它们放错了位置。作为提示：本地文件必须始终显示在右手边。左边必须是 revBase 和中心 revHEAD。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-29T23:17:34.323

仅针对 DiffViewer：

Beyond Compare 3 和 TortioseSVN (TortoiseSVN 1.9.4)

设置-> 差异查看器。将单选按钮移动到外部并粘贴到〜

C:\Program Files (x86)\Beyond Compare 3\BCompare.exe %base %mine

# objective-c - 在被破坏的对象中调用的触摸处理程序

> ID：11148604
> 
> 赞同：0
> 
> 时间：2012-06-22T00:11:19.623
> 
> 标签：objective-c, ios, xcode, cocos2d-iphone

我发现自己对为什么我不能阻止我的触摸处理程序被调用感到困惑：

在 DungeonDisplay.m 中：

```
-(BOOL) ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event
{
    if (processing || animating) 
        return false;
    processing =  true;
    touchPoint = [self locationFromTouch:touch];
    [self schedule:@selector(keepMoving) interval:0.01];
    [self processTouchAtX:(touchPoint.x/32) AndY:(touchPoint.y/32)];
    return false;
}

-(void) processTouchAtX: (int)x AndY: (int)y
{
//    if (theDungeon.currentDungeonLevel)
         [theDungeon processTouchAtX:x AndY:y];
} 
```

现在，在 [theDungeon processTouchAtX:x AndY:y] 中，DungeonDisplay 实例被释放并且 DungeonDisplay:Dealloc 被正确调用，但是当我逐步执行函数 ccTouchBegan 时，就在最后一个“return false;”之后 下一个“步骤”返回到函数“if（处理 || 动画）”的顶部，下一步使程序崩溃。

我不清楚问题可能是什么。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T10:38:37.540

如果 DungeonDisplay 不是从 CCLayer 派生的，并且您使用 CCTouchDispatcher 注册了触摸，请确保在 cleanup 或 dealloc 方法中调用 CCTouchDispatcher 上的 removeDelegate。否则 CCTouchDispatcher 将继续向对象发送 ccTouch* 消息，即使它已被释放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:16:32.100

这里没有足够的代码。但这可能是由于您没有将指向接收触摸事件的委托的指针归零。如果您完成的某事是其他某事的代表，您必须确保您告诉那件事您不再是代表。在 iOS 中向 nil 发送消息是可以的。将消息发送到指向已释放对象的指针不是。

# facebook - 将分享按钮添加到页面应用程序，并链接回页面 tabx

> ID：11148607
> 
> 赞同：1
> 
> 时间：2012-06-22T00:11:28.713
> 
> 标签：facebook

我创建了一个用作页面选项卡的应用程序。我需要添加一个分享按钮，就像这个页面上的分享按钮：[https ://www.facebook.com/PixarMonstersUniversity/app_411774402198665](https://www.facebook.com/PixarMonstersUniversity/app_411774402198665)

这是否可以共享页面选项卡（应用程序）并将其链接回 Facebook 中的页面选项卡？

我真的不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:26:50.393

[https://www.facebook.com/PixarMonstersUniversity/app_411774402198665](https://www.facebook.com/PixarMonstersUniversity/app_411774402198665)

要创建此应用程序的分享按钮，您只需在 Facebook 页面中获取选项卡式应用程序的地址并将其放入分享按钮 HTML 中。

这里有一个例子：

```
<a name="fb_share" type="icon" share_url="YOUR_URL"> 
```

上面的链接将用于共享页面的应用程序。要仅共享页面，请删除“/app_xx”并共享应用程序只需放置应用程序 url。

# wolfram-mathematica - Mathematica -- 如何编译 BitShiftRight（或 Left）？

> ID：11148608
> 
> 赞同：7
> 
> 时间：2012-06-22T00:11:33.337
> 
> 标签：wolfram-mathematica, mathematical-optimization, mathematica-8

我想编译一个 Mathematica 模块，因为我追求速度。

```
 testC = Compile[{{inputInt, _Integer}},
      Module[{outputInt, bitShift = 5},
      outputInt = BitShiftRight[inputInt, bitShift]
      ]
      , CompilationTarget -> "C", RuntimeOptions -> "Speed"
      , CompilationOptions -> {"ExpressionOptimization" -> True, 
       "InlineCompiledFunctions" -> True, 
       "InlineExternalDefinitions" -> True}
    ]; 
```

我的真实函数较长，但结构非常简单，使用列表，只包含以下函数：Total、Table、BitAnd、If。所有编译和运行时选项在我的实际功能中都很有用（也许），而不是这一行摘录。

我已经设定

> SetSystemOptions["CompileOptions" -> "CompileReportExternal" -> True];

确保我能看到发生了什么，并且

> 编译打印[testC]

给出以下结果

```
 1 argument
    3 Integer registers
Underflow checking off
Overflow checking off
Integer overflow checking off
RuntimeAttributes -> {}

    I0 = A1
    I1 = 5
    Result = I2

    1   I2 = MainEvaluate[ Hold[BitShiftRight][ I0, I1]]
    2   Return 
```

正如该线程所预期/担心的那样[https://mathematica.stackexchange.com/a/1101/1403](https://mathematica.stackexchange.com/a/1101/1403) BitShiftRight 不可编译，并且对 MainEvaluate 的调用严重拖累了我的功能。我非常惊讶的是，这种非常低级的通用函数是不可编译的，而 BitAnd、BitNot、BitOr、BitXor 是！有人知道（快速）解决方法吗？我可以使用 MathLink 调用 C 语言函数，但我的目标是在 Manipulate[] 中使用此函数并将其部署为独立的 cdf 文件。而且我知道在这种情况下我不能使用 MathLink，对吗？顺便说一句，那里有一些易于处理的解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T02:24:59.410

如果除以 32，编译器可能会将其重写为移位。您还应该尝试在 Mathematica 中直接除以 32，确保您的数据是并且保持打包 (Developer`ToPackedArray[])。来回发送数据的开销可能不值得用 C 语言计算。

# xml - 如何在 xsd 中嵌套 complexType 元素？

> ID：11148609
> 
> 赞同：12
> 
> 时间：2012-06-22T00:11:44.180
> 
> 标签：xml, validation, xsd, complextype

我有一个正确验证的 xml 和 xsd 文件（在[http://xsdvalidation.utilities-online.info/](http://xsdvalidation.utilities-online.info/)测试）。

但是，xml 不会针对 xsd 进行验证。我认为这是因为与 xml 相比，我在 xsd 中错误地嵌套了 complexType 元素。的外部元素`people`似乎导致了问题......

这是xml：

```
<?xml version = "1.0"?>

<people>
    <person>
        <firstname>Joe</firstname>
        <lastname>Schmoe</lastname>
    </person>

    <person>
        <firstname>Cletus</firstname>
        <lastname>Jenkins</lastname>
    </person>
</people> 
```

...这是xsd：

```
<?xml version = "1.0"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

    <xs:element name = "people">
        <xs:complexType>
            <xs:sequence>

                <xs:element name = "person">
                    <xs:complexType>
                        <xs:sequence>

                            <xs:element name = "firstname" type = "xs:string" />
                            <xs:element name = "lastname" type = "xs:string" />

                        </xs:sequence>
                    </xs:complexType>
                </xs:element>

            </xs:sequence>
        </xs:complexType>
    </xs:element>

</xs:schema> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-22T00:23:08.483

添加`maxOccurs="unbounded"`到名为“person”的元素。它是一个或多个人员元素的序列。

注意：用 lowerCamelCase 写 maxOccurs 而不是小写

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-22T00:23:20.210

为您的 XSD 试试这个：

```
<?xml version = "1.0"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

    <xs:element name="people" type="people"/>

    <xs:complexType name="people">
        <xs:sequence>
            <xs:element name="person" type="person" maxOccurs="unbounded" minOccurs="0"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="person">
        <xs:sequence>
            <xs:element name="firstname" type="xs:string" maxOccurs="1" minOccurs="1"/>
            <xs:element name="lastname" type="xs:string" maxOccurs="1" minOccurs="1"/>
       </xs:sequence>
    </xs:complexType>

</xs:schema> 
```

# apache-flex - 我如何只全屏显示 Videodisplay 而不是整个应用程序？

> ID：11148610
> 
> 赞同：0
> 
> 时间：2012-06-22T00:11:55.270
> 
> 标签：apache-flex, actionscript, red5, videochat

我正在使用 Red5 在 Flex 中进行视频聊天。我正在使用以下代码：

```
 stage.fullScreenSourceRect = new Rectangle(vidDisp.x,vidDisp.y, vidDisp.width, vidDisp.height);
    stage.scaleMode = StageScaleMode.NO_SCALE;
    stage.displayState = StageDisplayState.FULL_SCREEN 
```

这段代码给了我一个奇怪的半切全屏。有人知道其他方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T15:19:52.393

@Siddharth 这是该实现中的 videoContainer：

```
<!--Video Player-->
<mx:Box id="videoContainer" width="100%" height="{Math.floor(this.width * 0.6)}">
    <mx:VideoDisplay id="player" width="100%" height="100%" autoPlay="false" autoRewind="false" bufferTime="4" playheadUpdateInterval="1000"  />
</mx:Box> 
```

# css - 对网络应用程序尺寸的百分比感到困惑

> ID：11148624
> 
> 赞同：2
> 
> 时间：2012-06-22T00:14:11.843
> 
> 标签：css, html, margins

这是我第一次使用 css 布局构建一个完全可扩展的应用程序，当用户调整窗口大小时，字段应该相应地缩小和增长。首先我想，很简单，对吧？但现在我真的对尺寸摸不着头脑，因为看起来边距不太正确......我想在所有单独的字段之间有一个类似边框的分隔符......

我的代码是这样的：

```
<div style='background-color:#000000;width:100%;height:100%;'>

    <div style='width:100%;height:66%;margin-bottom:1%;'>

        <div style='float:left; width:19%;height:100%;margin-right:1%;' class='app_14_concept_block'>keypartners</div>
        <div style='float:left; width:19%;height:100%;margin-right:1%;'>

            <div style='height:49%;margin-bottom:6%' class='app_14_concept_block'>key activities</div>

            <div style='height:49%;' class='app_14_concept_block'>key resources</div>

        </div>
        <div style='float:left; width:19%; height:100%;margin-right:1%;' class='app_14_concept_block'>value propositions</div>
        <div style='float:left; width:19%; height:100%;margin-right:1%;'>

            <div style='height:49%;margin-bottom:6%'  class='app_14_concept_block'>customer relationship</div>

            <div style='height:49%;' class='app_14_concept_block'>channels</div>

        </div>
        <div style='float:left; width:19%; height:100%;padding-right:1%' class='app_14_concept_block'>customer segments</div>
    </div>
    <div style='width:100%;height:33%;'>
        <div style='float:left; width:49%; height:100%;margin-right:1%;' class='app_14_concept_block'>cost</div>
        <div style='float:left; width:50%; height:100%;' class='app_14_concept_block'>revenue</div>
    </div>

</div> 
```

CSS是这样的：

```
.app_14_concept_block{
  background-color:#ffffff;
}
.app_14_concept_block:hover{
background-color:#eeeeee;
} 
```

这就是它目前的样子（蓝色的东西是我的应用程序查看器布局的一部分，可以打开评论） - 我主要关心的是在右侧添加的空白（黑色）空间，在行的末尾： ![我的应用程序查看器中我的应用程序的屏幕截图](../Images/dacc303dedfadce5b4000d9d37a98958.png)

jsfiddle在这里：http: [//jsfiddle.net/gbMZy/51/](http://jsfiddle.net/gbMZy/51/)

我还尝试将“客户细分”宽度设置为 20% - 遗憾的是无济于事：

截屏：![在此处输入图像描述](../Images/fb30b32d3ac988a7a37b6fd21e82262e.png)

jsfiddle：http: [//jsfiddle.net/gbMZy/52/](http://jsfiddle.net/gbMZy/52/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T23:08:28.993

也许这个解决方案[Footer Items Expanding with Viewport Evenly](https://stackoverflow.com/questions/11244089/footer-items-expanding-with-viewport-evenly/11244216#11244216)也适用于您的情况。

百分比宽度不能与边框或边距一起很好地发挥作用。一种可能的解决方法是让包装容器具有完整的 20% / 50% 宽度，然后**在**其中包含带有边框等的元素。这应该有助于避免闪烁和随机间距。

因此，在您的情况下，这可能类似于：http: [//jsfiddle.net/qC4JV/1/](http://jsfiddle.net/qC4JV/1/)

HTML：

```
<div class="top">
    <div class="cell">
        <div class="border right"></div>
        <div class="border bottom"></div>
        <p>value</p> 
    </div>
    <div class="cell">
        <div class="border right"></div>
        <div class="border bottom"></div>
        <p>value</p>          
    </div>
    <div class="cell">
        <div class="border right"></div>
        <div class="border bottom"></div>
        <p>value</p>           
    </div>
    <div class="cell">
        <div class="border right"></div>
        <div class="border bottom"></div>
        <p>value</p>          
    </div>
    <div class="cell">
        <div class="border bottom"></div>
        <p>value</p>           
    </div>
</div>

<div class="bottom">
    <div class="cell">
        <div class="border right"></div>
        <p>value</p>          
    </div>
    <div class="cell">
        <p>value</p>         
    </div>
</div>​ 
```

CSS：

```
body, html{
    height: 100%;
    background: #000;
}

.top{
    height: 60%;
}

.bottom{
    height: 40%;
}

.cell{
    float: left;
    height: 100%;
    background: #fff;
    position: relative;
}

.cell .border.right{
  position: absolute;
  right: 0;
  top: 0;
  width: 10px;
  height: 100%;
  background: #000;
}

.cell .border.bottom{
  position: absolute;
  left: 0;
  bottom: 0;
  width: 100%;
  height: 10px;
  background: #000;
}

.top .cell{
  width: 20%;
}

.bottom .cell{
  width: 50%;
} 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:58:15.293

在第一个 div 中明确设置字体大小，然后使用 'em' 调整行边距。

但我不确定是否会有可扩展性问题..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T23:32:41.707

当以这种方式使用百分比时，浏览器取整值以获得离散像素值的方式通常会产生余数。如果视口总宽度的 1% 不是精确的像素数，浏览器会向上或向下舍入，导致像素过多或过少，从而导致 div 抖动和边距不等。

即使是 Twitter 的 Bootstrap 框架，一个非常发达的系统，在使用其流体网格系统时也会遇到同样的问题。

我不想这么说，但如果你绝对必须创建这样的布局，并且不可靠的元素尺寸是不可接受的，那么使用表格可能是要走的路。

另一方面，如果您使用白色“边框”而不是黑色，则边距抖动将不太明显。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T23:55:05.803

你的 HTML 读起来很痛苦。您应该真正将样式分离到 CSS 中，而不是像那样内联编写所有内容，这样更难阅读/调试，并且很容易出错。

这是一个更好的解决方案：http: [//jsfiddle.net/gbMZy/51/](http://jsfiddle.net/gbMZy/51/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-03T13:47:15.327

百分比总是在浏览器上以整数方式计算，并根据 body 的总宽度或父元素的环绕区域/宽度进行调整。这些尺寸将在计算给子元素或填充样式的内部和外部像素宽度以及在具有指定像素大小的元素上给定的边框之后分配。

HTML：

```
<div class="top">
  <div class="cell">
    <div class="border right">
    </div>
    <div class="border bottom">
    </div>
    <p>
      Top Block-1
    </p>
  </div>
  <div class="cell">
    <div class="border right">
    </div>
    <div class="border bottom">
    </div>
    <p>
      Top Block-2
    </p>

  </div>
  <div class="cell">
    <div class="border right">
    </div>
    <div class="border bottom">
    </div>
    <p>
      Top Block-1
    </p>

  </div>
  <div class="cell">
    <div class="border right">
    </div>
    <div class="border bottom">
    </div>
    <p>
      Top Block-3
    </p>

  </div>
  <div class="cell">
    <div class="border bottom">
    </div>
    <p>
      Top Block-4
    </p>

  </div>
</div>

<div class="bottom">
  <div class="cell">
    <div class="border right">
    </div>
    <p>
      Bottom Block-1
    </p>

  </div>
  <div class="cell">
    <p>
      Bottom Block-2
    </p>

  </div>
</div> 
```

CSS 样式：

```
body, html{
  height: 100%;
  background: #3355A9;
}

.top{
  height: 60%;
}

.bottom{
  height: 40%;
}

.cell{
  float: left;
  height: 100%;
  background: #ffca77;
  position: relative;
  text-align:center;
  font-weight:bold;
}
.cell p{
  padding:10px;
}

.cell .border.right{
  position: absolute;
  right: 0;
  top: 0;
  width: 10px;
  height: 100%;
  background: #3355A9;
}

.cell .border.bottom{
  position: absolute;
  left: 0;
  bottom: 0;
  width: 100%;
  height: 10px;
  background: #3355A9;
}

.top .cell{
  width: 20%;
}

.bottom .cell{
  width: 50%;
} 
```

[在代码箱上尝试这个解决方案： http](http://codebins.com/codes/home/4ldqpbt) ://codebins.com/codes/home/4ldqpbt

因此，您可能会找到更好的解决方案，因为它具有更好的用户界面和清晰的视野，可以根据我们的需要显示准确的结果。

# emacs - Emacs ansi-term 的配置文件名是什么？

> ID：11148629
> 
> 赞同：2
> 
> 时间：2012-06-22T00:15:00.413
> 
> 标签：emacs

我试图创建一个 .emacs-bash 文件，它适用于`M-x shell`. 但是如果我使用 ansi-term，似乎 .emacs-bash 文件没有加载......我该如何解决这个问题？

我用`M-x ansi-term`然后`\bin\bash`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T00:31:48.107

( `~/.emacs_SHELLNAME`or `~/.emacs.d/init_SHELLNAME.sh`) 行为对于`shell`函数来说是特殊的（它自然知道你将要运行一个 shell）。

`ansi-term`是一个终端仿真器。它不知道您将使用它运行什么样的进程，因此它不会尝试应用任何自定义配置文件。

如果您在终端中运行 shell，该 shell 应该将其正常规则应用于配置文件，所以我会尝试`.bashrc`初学者。

如果做不到这一点，请阅读 bash 手册页以查看规则是什么。环境变量可能会发挥作用（您可以在 .bashrc 中测试环境变量以提供特定于 Emacs 的行为）。

# javascript - JavaScript 加权随机或时间百分比

> ID：11148632
> 
> 赞同：2
> 
> 时间：2012-06-22T00:15:08.013
> 
> 标签：javascript, node.js, random, weighted

我有一个每 100 毫秒运行一次的 Node.js 进程 (setInterval)。我有一些我想每隔 x 时间采取的行动。例如，2% 的时间做 X，10% 的时间做 Y，等等。

现在，我基本上是这样做的：

```
var rand = Math.floor(Math.random() * (1000 + 1));

if(rand > 900) {  // Do something }

if(rand > 950) {  // Do something } 
```

问题是它非常不一致。您可能希望`if(rand > 900)`至少接近 10% 的时间，但有时可能连续 10 倍或根本没有。

如果我们假设 100 毫秒间隔是固定的，那么任何人都会对更好的解决方案提出建议，该解决方案会更准确。

谢谢！

编辑：基于 Dr. Dredel 的评论：

```
var count = 0;
setInterval(function(){

    if(count++ % 4 == 0) {
       console.log('25% of the time');
    }

}, 100);​ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T00:17:26.873

如果您的间隔是固定的，我会将您的邮票四舍五入到最接近的一百，然后使用与您的需求相关的那些段...... 100 和 200 但不是 300-1000 来代表 2%。

如果您可以使用计数器，那么这是更明显的方法。

```
if(myCounter++ % 4 == 0)
    //this happens 25 percent of the time 
```

正如埃米尔指出的那样，概率在这里不是正确的方法，我不觉得你已经嫁给了它......听起来你正在使用它，因为你没有看到更好的挑衅方法某事发生在 x% 的时间里。如果我们对您有误解，您需要更详细地解释为什么在这里使用赔率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:17:39.603

介绍一个计数器和 BAM！现在你可以有*2* % 的时间！

说真的，引入某种状态是您执行“连续多次”策略的唯一方法。概率/随机性无法帮助您解决这个问题。随机事件不可能连续多次发生的信念是一个众所周知的神话。事实上，一个 2% 的可能性事件可能会连续发生数百万次，尽管这种可能性很小。

您将需要添加一个约束，例如“*我希望事件以 x% 的概率发生，但我总是希望它在每个事件之后至少进行 y 步*”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T03:39:42.647

如果你想保证你的操作发生在一个确切的时间百分比（而不是让机会发生），但你希望它们以随机顺序被选择，那么你可以做这样的事情，你创建一个数据结构在所有元素的一次迭代中，您想要的确切结果。然后，您随机选择其中一个结果，将其从数据结构中删除，随机选择另一个结果等等......

如果您使用每个结果的适当百分比为初始数据结构播种，那么您将根据该规则获得结果，并且对于每次完整迭代，您将获得每个结果的准确数量，但它们将以随机顺序选择并且每次的顺序都会不同。

如果您希望该过程一遍又一遍地重复，您可以在每次完成一个完整的迭代时重新开始它。

```
var playProbabilities = [
    {item: "A", chances: 3},
    {item: "B", chances: 2},
    {item: "C", chances: 1},
    {item: "D", chances: 2},
    {item: "E", chances: 1},
    {item: "F", chances: 1}
];

function startPlay(items) {
    var itemsRemaining = [];
    // cycle through the items list and populate itemsRemaining
    for (var i = 0; i < items.length; i++) {
        var obj = items[i];
        // for each item, start with the right number of chances
        for (var j = 0; j < obj.chances; j++) {
            itemsRemaining.push(obj.item);
        }
    }
    return(itemsRemaining);
}

function nextPlay(itemsRemaining) {
    if (!itemsRemaining.length) {
        return null;
    }
    // randomly pick one
    var rand = Math.floor(Math.random() * itemsRemaining.length);
    var result = itemsRemaining[rand];

    // remove the one we picked from the array
    itemsRemaining.splice(rand, 1);
    return(result);
}

$("#go").click(function() {
    var results = $("#results");
    var items = startPlay(playProbabilities);
    var next;
    while(next = nextPlay(items)) {
        results.append(next + "<br>");
    }
    results.append("-------------<br>");
}); 
```

在这里工作演示：http: [//jsfiddle.net/jfriend00/x2v63/](http://jsfiddle.net/jfriend00/x2v63/)

如果您运行该演示，您将看到每次运行都会准确生成每个结果的所需数量，但它们是按随机顺序选择的。

# objective-c - 在应用程序中禁用听写

> ID：11148635
> 
> 赞同：2
> 
> 时间：2012-06-22T00:15:34.923
> 
> 标签：objective-c, keyboard, siri, dictating

有什么办法可以禁用听写键？我真的不想为此创建自定义键盘。我以为它会像 UIResponder 一样，但这仅适用于 textview 的共享菜单；仅包含复制、剪切和粘贴等。

谢谢！

![在此处输入图像描述](../Images/cd4011196d4b99bcb908b7864aefda1b.png)

# iphone - 如何正确应用核心图像过滤器

> ID：11148636
> 
> 赞同：5
> 
> 时间：2012-06-22T00:15:46.393
> 
> 标签：iphone, objective-c, ios, ios5, core-image

我在使用 Core 图像时遇到问题。我正在做的是从 UIImageView 获取图像，然后使用我在教程中找到的一些代码（我是核心图像的新手），但是当我尝试时，我想将棕褐色图像放回同一个 UIImageView将新图像放入视图中它就消失了我已经测试过图像视图是否包含图像并且它确实包含但它不可见。关于做什么的任何建议？

编辑：好的，我让棕褐色过滤器工作，所以我尝试了色调分离，我遇到了同样的问题，图像就消失了。这是代码：

```
CIImage *beginImage = [CIImage imageWithCGImage:[image_view.image CGImage]];
context = [CIContext contextWithOptions:nil];
filter = [CIFilter filterWithName:@"CIColorPosterize" keysAndValues:kCIInputImageKey, beginImage,@"inputLevels",[NSNumber numberWithFloat:0.8], nil];
CIImage *outputImage = [filter outputImage];
CGImageRef cgimg = [context createCGImage:outputImage fromRect:[outputImage extent]];
UIImage *newImg = [UIImage imageWithCGImage:cgimg];
[image_view setImage:newImg];
CGImageRelease(cgimg); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-22T00:28:44.837

尝试这样的事情（假设你有一个 UIImageView *myImageView）

```
CIImage *beginImage = [CIImage imageWithCGImage:[myImageView.image CGImage]];
CIContext *context = [CIContext contextWithOptions:nil];

CIFilter *filter = [CIFilter filterWithName:@"CISepiaTone" keysAndValues: kCIInputImageKey, beginImage, @"inputIntensity", [NSNumber numberWithFloat:0.8], nil];
CIImage *outputImage = [filter outputImage];

CGImageRef cgimg = [context createCGImage:outputImage fromRect:[outputImage extent]];
UIImage *newImg = [UIImage imageWithCGImage:cgimg];

[myImageView setImage:newImg];

CGImageRelease(cgimg); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-16T09:47:03.620

Xcode 8.2 上的 Swift 3.0 中的相同代码（我在项目中的 imageView 是“@IBOutlet var photoImageView：UIImageView！”）在 iPhone 7Plus 设备 iOS 10 上成功检查

```
 guard let myImageView = self.photoImageView.image else
    {
        return
    }
    guard let cg = myImageView.cgImage else
    {
        return
    }
    let beginImage = CIImage(cgImage: cg)
    let context : CIContext = CIContext(options: nil)
    let inputParams : [String : Any]? = [kCIInputImageKey : beginImage,
                                        "inputIntensity" : NSNumber(value : 0.8)]
    let filter : CIFilter = CIFilter(name: "CISepiaTone", withInputParameters: inputParams)!
    let outputImage : CIImage? = filter.outputImage!

    if let outputImage = outputImage
    {
        let cgImage : CGImage? = context.createCGImage(outputImage, from: outputImage.extent)!

        if let cg = cgImage
        {
            let newImage : UIImage = UIImage(cgImage: cg)
            photoImageView.image = newImage
        }
    } 
```

# ruby-on-rails - 如何将包含与 activerecord 关联一起使用？

> ID：11148637
> 
> 赞同：0
> 
> 时间：2012-06-22T00:15:52.113
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

给定两个模型：

```
User
  has_many :group_members
  has_many :groups, :through => :group_members

GroupMember
  belongs_to :group
  belongs_to :user

Group
  has_many :group_members
  has_many :users, :through => :group_members
  has_many :group_invites

GroupInvite
  belongs_to :user 
```

感谢 Rails，我可以轻松获取所有用户组：

组 = current_user.groups

然后我获取这个组列表并遍历以创建一个 JSON 对象，如下所示：

```
groups.each do |group|
  ....
  group.group_members.count
  group.invites.first_code 
```

等等等等 问题是这会导致大量查询，因为我还没有找到一种方法来使用 include(:) 来查询所有 group_members 并通过一个查询而不是每个循环的查询来邀请所有组。关于如何使用的任何建议包括：

```
current_user.groups.includes(:group_members, :invites) ? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:34:54.427

试试这个：

```
GroupMember
  belongs_to :group
  belongs_to :user

Group
  has_many :group_members
  has_many :users, :through => :group_members
  has_many :invites, :
  has_many :invitees, :through => :invites, :source => :user

Invite
  belongs_to :group
  belongs_to :user 
```

现在你可以：

```
current_user.groups.includes(:invitees) 
```

# php - 循环 twitter 提要并返回一条消息

> ID：11148638
> 
> 赞同：0
> 
> 时间：2012-06-22T00:15:54.753
> 
> 标签：php, loops, foreach

我正在循环浏览 Twitter 提要，我的代码中的所有内容都运行良好，但我正在为一件事而苦苦挣扎。底部的 if 语句返回所有日期为今天的消息。然后基于此，我有一个正在尝试测试的正则表达式模式。如果找到，我说“找到它”，如果没有，我说“未找到”。我需要帮助的是未找到的部分。而不是为每条消息声明“未找到”，我该如何制作它以便循环遍历消息，如果找到状态“找到它”并停止一切，但如果未找到则传递消息，然后一旦所有循环完成完成状态“未找到”只有一次。

```
$dom = new DOMDocument();
@$dom->loadHTMLFile('http://api.twitter.com/1/statuses/user_timeline.rss?screen_name=google');
$xml = simplexml_import_dom($dom);
$twitter = $xml->xpath("//item");

foreach ($twitter as $item) {
    $timezone = new DateTimeZone('America/Los_Angeles');
    $date = new DateTime($item->pubdate);
    $date->setTimeZone($timezone);
    $twitter_date = $date->format("F j Y");
    $todays_date = date("F j Y");

    if ($twitter_date == $todays_date) {
        $text = $item->title;
        $pattern = '/\s\d\s\d/i';
        if (preg_match($pattern, $text, $codes)) {
            if (isset($codes[0])) {
                echo 'found it!';
            }
        } else {
            echo 'not found';
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:18:56.527

您可以保留一个标志变量`$found`来跟踪是否找到它，然后在找到`break`时退出循环。然后在你的`foreach`循环之后，检查`$found`.

```
$found = false;
foreach ($twitter as $item) {
    // ...
    if ($twitter_date == $todays_date) {
        $text = $item->title;
        $pattern = '/\s\d\s\d/i';
        if (preg_match($pattern, $text, $codes)) {
            if (isset($codes[0])) {
                $found = true;
                echo 'found it!';
                break;
            } 
        }
    }
}
if (!$found) {
    echo 'not found';
} 
```

# python - 有没有办法自动获取许多股票的一般信息，如市盈率、收益率等？

> ID：11148641
> 
> 赞同：8
> 
> 时间：2012-06-22T00:16:20.117
> 
> 标签：python, r, stocks

我知道一些在 R 或 python 中获取每日股票价格和交易量的方法，但只是想知道这些是否是一种方法（使用 R 或 python）来获取有关股票的更多信息，例如市盈率、公司网站、收益率等on，最好不仅是当前值，还有历史值。

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-22T00:23:00.543

历史将是困难的。R的[quantmod](http://cran.r-project.org/web/packages/quantmod/index.html)包具有`getQuote`获取`yahooQF`当前值所需的全部内容。

```
require("quantmod")
getQuote("GS", what = yahooQF(c("Market Capitalization", "Earnings/Share", 
         "P/E Ratio", "Book Value", "EBITDA", "52-week Range")))

            Trade Time Market Capitalization Earnings/Share P/E Ratio Book Value EBITDA  52-week Range
GS 2012-06-21 04:00:00               47.870B          6.764     14.27    134.476      0 84.27 - 139.25 
```

另外，试试

```
getQuote("GS", what=yahooQF()) 
```

这将为您提供要请求的字段的选择菜单。

您可以使用 Google 财经获取最近的财务报表`getFinancials`

还有一个[FinancialInstrument](https://r-forge.r-project.org/R/?group_id=316)包，它有几个`update_instruments.*`功能可以下载有关工具的元数据（在这种情况下是股票）。例如，这是雅虎的做法

```
require("FinancialInstrument")
stock("GS", currency("USD")) # define the stock
#[1] "GS"
update_instruments.yahoo("GS") #update with yahoo
#[1] "GS"
getInstrument("GS")
#primary_id          :"GS"
#currency            :"USD"
#multiplier          :1
#tick_size           :0.01
#identifiers         : list()
#type                :"stock"
#name                :"Goldman Sachs Gro"
#exchange            :"NYSE"
#market.cap          :"47.870B"
#avg.volume          :5480530
#EPS                 :6.76
#EPS.current.year.est:11.4
#EPS.next.year.est   :12.9
#book.value          :134
#EBITDA              :0
#range.52wk          :"84.27 - 139.25"
#defined.by          :"yahoo"
#updated             : POSIXct, format: "2012-06-21 19:31:11" 
```

如果您有一个 InteractiveBrokers 帐户，您可以使用出色的[IBrokers](http://code.google.com/p/ibrokers/source/checkout)软件包来获取有关大量工具的大量信息。另外，如果你有一个 IB 账户，你会想看看我的[twsInstrument](https://r-forge.r-project.org/R/?group_id=1113)包，它有很多方便的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T07:13:46.627

只是为了回答我问题的网站部分：

```
 str <- paste("http://investing.money.msn.com/investments/company-report?symbol=", ticker, sep = "")
  page <- paste(readLines(url(str, open = "rt")), collapse = "\n")
  match <- regexpr("<a href=\"http://www\\.(\\S+)\">Website</a>", page, perl = TRUE)

  if (attr(match, "match.length") > 0) {
    site <- substring(page, attr(match, "capture.start"), attr(match, "capture.start") + attr(match, "capture.length") - 1)    
    site <- strsplit(site, "/")[[1]][1]
  } 
```

# c# - 反序列化错误 - 值不能为空/未定义无参数构造函数

> ID：11148644
> 
> 赞同：2
> 
> 时间：2012-06-22T00:16:35.457
> 
> 标签：c#, javascript, asp.net, json, jquery

我有一个产品编辑页面，允许您添加“相关项目”。当访问该页面以编辑产品时，它会在服务器上序列化其初始相关项并存储在隐藏字段中。当您添加相关项目时，我使用`$.ajax()`. `$.ajax()`正在调用一个返回对象列表的服务器端方法，如下所示：

```
Fyodor.JSON.SearchResult r = new Fyodor.JSON.SearchResult();
DataSet ds = retrieveData();

foreach (DataRow row in ds.Tables[0].Rows)
{
    JSON.Product i = new JSON.Product();
    //set all Product data in `i`

    if (!string.IsNullOrEmpty(i.PartNumber))
    {
        r.Results.Add(i);
    }
}
//set r.TotalPageCount
return r; 
```

当我将这组项目返回到我的 javascript 中时，每个项目都给出了一个`__type`等于`JSON.Product`. 最初对项目进行序列化时，该`__type`成员不存在。我`JSON.stringify(my_arrar_of_items)`用来序列化新集合并存储回隐藏字段。
当我保存产品并检索隐藏字段的值并尝试使用反序列化时

```
JavaScriptSerializer s = new JavaScriptSerializer();
relatedItems = s.Deserialize<List<JSON.Product>>(hiddenField.Value); 
```

我收到一个错误：

> [ArgumentNullException：值不能为空。参数名称：type] System.Activator.CreateInstance(Type type, Boolean nonPublic) +9635174 System.Web.Script.Serialization.ObjectConverter.ConvertDictionaryToObject(IDictionary`2字典，Type type，JavaScriptSerializer序列化器，Boolean throwOnError, Object&convertedObject) +431 System.Web.Script.Serialization.ObjectConverter.ConvertObjectToTypeInternal(Object o, Type type, JavaScriptSerializer 序列化器, Boolean throwOnError, Object& convertObject) +71 System.Web.Script.Serialization.ObjectConverter.ConvertObjectToTypeMain(Object o, Type type, JavaScriptSerializer 序列化器,布尔 throwOnError，对象和转换对象）+147 System.Web.Script.Serialization.JavaScriptObjectDeserializer.DeserializeInternal（Int32 深度）+199 System.Web.Script。

我确定该错误是由该`__type`成员引起的。我怎样才能得到这个字符串反序列化？`$.ajax()`或者我怎样才能用而不是得到该死的成员来检索我的物品`__type`？

我尝试过但不起作用的东西：在我阅读的 SO 帖子中（我现在找不到它），它说要为您正在序列化的对象的构造函数提供访问级别，`protected internal`并且它不会添加`__type`成员。该类实际上没有构造函数或方法，因此我使用该访问级别制作了一个，并且确实该`__type`成员不存在。但是现在我遇到了一个新错误：

> [MissingMethodException：没有为“Shop.JSON.Product”类型定义无参数构造函数。] System.Web.Script.Serialization.ObjectConverter.ConvertDictionaryToObject（IDictionary`2 字典，类型类型，JavaScriptSerializer 序列化程序，布尔 throwOnError，Object&convertedObject）+582589 System.Web.Script.Serialization.ObjectConverter.ConvertObjectToTypeInternal(Object o, Type type, JavaScriptSerializer 序列化器, Boolean throwOnError, Object& convertObject) +71 System.Web.Script.Serialization.ObjectConverter.ConvertObjectToTypeMain(Object o, Type type, JavaScriptSerializer 序列化器, Boolean throwOnError, Object&convertedObject) +147 System.Web.Script.Serialization.ObjectConverter.AddItemToList(IList oldList, IList newList, Type elementType, JavaScriptSerializer 序列化器,Boolean throwOnError) +87 System.Web.Script.Serialization.ObjectConverter.ConvertListToObject(IList list, Type type, JavaScriptSerializer serializer, Boolean throwOnError, IList& convertList) +674 System.Web.Script.Serialization.ObjectConverter.ConvertObjectToTypeInternal(Object o, Type类型，JavaScriptSerializer 序列化程序，布尔 throwOnError，对象和转换对象）+112 System.Web.Script.Serialization.ObjectConverter.ConvertObjectToTypeMain（对象 o，类型类型，JavaScriptSerializer 序列化程序，布尔 throwOnError，对象和转换对象）+147 System.Web.Script.Serialization。 JavaScriptSerializer.Deserialize（JavaScriptSerializer 序列化器，字符串输入，类型类型，Int32 depthLimit）+66 System.Web.Script.Serialization.JavaScriptSerializer.Deserialize（字符串输入）+74 Shop.UI.Admin.Products.Detail。CreateObject(Product& item) in C:\Documents and Settings\path\UI\Admin\Products\Detail.cs:720 Shop.UI.Admin.Products.Detail.Save() 在 C:\Documents and Settings\path\UI \Admin\Products\Detail.cs:356 Shop.UI.Admin.Products.Detail.SaveClick(Object sender, EventArgs e) 在 C:\Documents and Settings\path\UI\Admin\Products\Detail.cs:121 System .Web.UI.WebControls.Button.OnClick(EventArgs e) +118 System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +112 System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler .RaisePostBackEvent(String eventArgument) +10 System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13 System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36 System.Web.UI.Page。ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +5563

我不明白，因为我创建的新构造函数*是*无参数的。我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T01:31:43.460

这条线是...

```
JSON.Product i = new JSON.Product(); 
```

在程序的与您创建的构造函数相同的部分中，还是在派生类中？如果不是，那么这就解释了为什么它找不到构造函数。

来自[DotNetPerls](http://www.dotnetperls.com/protected)：[受保护的内部] 意味着内部可访问性（该程序的所有部分都可以使用该成员）和受保护的可访问性（所有派生类都可以使用该成员）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T18:33:37.170

我找到了一个非常简单的解决方案。当我通过 将服务器中的项目检索回 javascript 时`$.ajax()`，我使用[delete 运算符](https://developer.mozilla.org/en/JavaScript/Reference/Operators/delete)从对象中删除`.__type`属性。

它工作得很好，我现在可以反序列化我的对象！如此简单的解决方案；希望我早点想到这一点。

# java - 到 JFormattedTextField 的 setValue 不显示在 GUI 上

> ID：11148648
> 
> 赞同：1
> 
> 时间：2012-06-22T00:17:00.587
> 
> 标签：java, swing, jformattedtextfield

我正在使用 swing 编写一个带有 gui 的简单贷款计算器。我正在使用 DecimalFormat 来确保使用 JFormattedTextField 正确格式化。

```
public static void main(String[] args) {
    JFormattedTextField loanAmountField = new JFormattedTextField(new DecimalFormat("####.##"));
    JFormattedTextField interestRateField = new JFormattedTextField(new DecimalFormat("####.##"));
    JFormattedTextField yearField = new JFormattedTextField(new DecimalFormat("####.##"));
    JFormattedTextField monthlyPaymentField = new JFormattedTextField(new DecimalFormat("####.##"));

   JButton calculateButton = new JButton("Calculate");

    //Calculations based on selection
    int monthlyTest;
    if (monthlyRadioButton.isSelected()){
        monthlyTest = 1;

        calculateButton.addActionListener(new CalculateListener(loanAmountField, interestRateField, yearField, monthlyPaymentField, monthlyTest));
    }
    else{
        monthlyTest = 0;
        calculateButton.addActionListener(new CalculateListener(loanAmountField, interestRateField, yearField, monthlyPaymentField, monthlyTest));

    }
} 
```

我遇到的问题是，当我尝试为loanAmountField 分配一个值时，它不会在我的GUI 的JFormattedTextField 上更新它。

```
class CalculateListener implements ActionListener {
public CalculateListener (JFormattedTextField loanAmountField, JFormattedTextField     monthlyPaymentField, JFormattedTextField interestRateField, JFormattedTextField yearField, int monthlyTest)
{
  this.interestRateField = interestRateField;   
  this.yearField = yearField;
  this.loanAmountField = loanAmountField;
  this.monthlyPaymentField = monthlyPaymentField;
  this.monthlyTest = monthlyTest;
}

public void actionPerformed(ActionEvent event){
      loanAmountField.setValue(new Double(12.22));
    }

} 
```

**如何在我的 GUI JFormattedTextField 上显示新值？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T00:43:20.393

通过[SSCCE](http://sscce.org)，我的意思是这样的：

```
import java.awt.event.*;
import java.text.NumberFormat;
import javax.swing.*;

public class TestCalculatorListener extends JPanel {
   private JFormattedTextField loanAmountField = new JFormattedTextField(
         NumberFormat.getCurrencyInstance());

   public TestCalculatorListener() {
      loanAmountField.setColumns(8);
      loanAmountField.setEditable(false);
      loanAmountField.setFocusable(false);
      add(loanAmountField);
      add(new JButton(new CalculateListener(loanAmountField)));
   }

   private static void createAndShowGui() {
      TestCalculatorListener mainPanel = new TestCalculatorListener();

      JFrame frame = new JFrame("TestCalculatorListener");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }

   private class CalculateListener extends AbstractAction {
      private JFormattedTextField loanAmountField;

      public CalculateListener(JFormattedTextField loanAmountField) {
         super("Calculate");
         putValue(MNEMONIC_KEY, KeyEvent.VK_C);
         this.loanAmountField = loanAmountField;
      }

      public void actionPerformed(ActionEvent event) {
         loanAmountField.setValue(new Double(12.22));
      }

   }
} 
```

这表明至少您发布的一些代码可以正常工作。

# php - 获取 Facebook 好友列表，同时排除一些好友

> ID：11148651
> 
> 赞同：0
> 
> 时间：2012-06-22T00:17:15.717
> 
> 标签：php, mysql, facebook, facebook-fql, facebook-php-sdk

我正在使用 PHP SDK 进行 FQL 调用以提取用户朋友的列表。它看起来像这样：

```
$all_friends = $facebook->api(array('method' => 'fql.query', 'query' => 'SELECT uid, name FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) ORDER BY name ASC')); 
```

这很好用，但现在我还想从列表中排除一些朋友。我已经尝试过我认为有效的方法，但它似乎不起作用（它返回一个空列表）。

作为我正在尝试做的一个例子：

```
$all_friends = $facebook->api(array('method' => 'fql.query', 'query' => 'SELECT uid, name FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) AND uid NOT IN (12345,54218,68151) ORDER BY name ASC')); 
```

有什么我想念的吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:54:40.087

“NOT IN”不是 FQL 支持的功能。[Graph API Explorer](https://developers.facebook.com/tools/explorer)引发异常：（#601）解析器错误：在位置 92 出现意外的“NOT” 。

您可以使用 IN 进行简单的选择

```
$all_friends = $facebook->api(array('method' => 'fql.query', 'query' => 'SELECT uid, name FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) ORDER BY name ASC')); 
```

并使用 PHP 使用 ids 进行过滤。据我所知，这是唯一的方法。

我找到了一个相关的帖子：链接[在这里](https://stackoverflow.com/questions/8308473/fql-select-query-with-in-not-keyword/8310831#8310831)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-04T12:22:00.360

这可以使用下一个 FQL 查询：

```
SELECT uid, name FROM user WHERE uid IN (
  SELECT uid2 FROM friend WHERE uid1 = me() 
) AND NOT ( uid IN ('13892588847', '10004291510061', '1000753466073'))
ORDER BY name ASC 
```

[在Graph API Explorer](https://developers.facebook.com/tools/explorer)上试一试。

# php - mysql访问被拒绝

> ID：11148657
> 
> 赞同：0
> 
> 时间：2012-06-22T00:17:52.647
> 
> 标签：php, mysql

好的，情况就是这样。由于预算削减，我刚刚不得不移动服务器，所以新服务器是 webfusion VPS。我现在在所有 mysql 查询上都收到拒绝访问错误。这是具体错误：

```
Access denied for user 'www-data'@'localhost' (using password: NO) 
```

我不知道是什么原因造成的。我有一个数据库，其中 mysql 用户名和密码存储在不同的 php 文件中。错误中显示的用户名与实际的用户名不同，我使用的是密码。据我了解，您可以将自己的 php.ini 文件放在 webfusions 根目录中，这样就可以了。有什么我错过的吗？我今天一直在喝咖啡，所以这可能就是原因。顺便说一句，mysql数据库位于同一台服务器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:23:06.393

这可能是几件事。我想让我们从正确的开始。

您的 MySQL 服务器地址是正确的，并且您的网络服务器能够连接到它。这应该是给定的，因为您的网络服务器和 MySQL 服务器似乎在同一台机器上。

您使用的用户名是 www-data。这是我要检查的第一件事。确保这是正确的用户名。

现在检查您的密码。看起来您正试图不必使用密码。很可能这是不正确的（如果它是正确的，你真的应该考虑改变它）。

除此之外，那里没有太多其他可能出错的地方。您是否打算连接到与您的网站在同一台机器上的 MySQL 服务器？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:22:54.470

迁移数据库后是否创建了适当的 MySQL 用户？进行数据库迁移时通常不会转移授予表和用户权限（除非您使用某些特定工具，例如 Percona 提供的工具等）

# asp.net - 不使用 Windows 身份验证在网站中维护用户会话

> ID：11148659
> 
> 赞同：1
> 
> 时间：2012-06-22T00:17:55.563
> 
> 标签：asp.net, session, authentication

我们有一个网站显示一些奇怪的行为。它刚刚从在 IIS6 上运行的 ASP.NET v2 更新到在 IIS7.5 上运行的 .Net v4。

它仅在 Intranet 中使用并使用 Windows 身份验证，但用户会话似乎没有像我预期的那样得到维护。

情况是这样的：A 人登录 - 一切正常。B 人登录 - 一切正常。人员 A 刷新了他们的页面，他们现在以人员 B 的身份登录。人员 C 登录，现在人员 A 和 B 都以人员 C 的身份登录。

我们通过以下方式获取当前登录用户 `System.Security.Principal.IIdentity winId = HttpContext.Current.User.Identity;`

我有点困惑这里出了什么问题。有没有人有任何想法？

# java - Socket编程PrintWriter不产生输出

> ID：11148661
> 
> 赞同：0
> 
> 时间：2012-06-22T00:18:01.877
> 
> 标签：java, sockets

我的服务器代码如下：

```
writer = new PrintWriter(s.getOutputStream());
writer.flush();
writer.print("HTTP/1.1 200 OK\r\n");                           
writer.print("Content-Length: " + len + "\r\n");
writer.print("Content-Type: "+"application/soap+xml;charset=utf-8"+"\r\n\r\n");
writer.print(response);
writer.close(); 
```

变量响应是 SOAP+XML。我正在添加发送它所需的 HTTP 标头，它在某些情况下可以工作，但在大多数情况下，我的客户端（SOAPUI）只是等待没有产生的响应。当我关闭客户端时，我在服务器端看不到任何错误。

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:22:47.087

从[Socket.getOutputStream()](http://docs.oracle.com/javase/6/docs/api/java/net/Socket.html#getOutputStream%28%29)：

“......关闭返回的 OutputStream 将关闭关联的套接字......”。

关闭 PrintWriter 将关闭 OutputStream 进而关闭套接字。只需刷新 PrintWriter，不要关闭它。

# c# - 使用自定义列名映射外键

> ID：11148662
> 
> 赞同：45
> 
> 时间：2012-06-22T00:18:31.093
> 
> 标签：c#, oracle, ef-code-first, entity-framework-4.3

我在 Oracle 中使用 Entity Framework 4.3 代码优先。我收到以下错误：

> System.InvalidOperationException：类型“WidgetDistributor.WidgetEntity”的属性“WidgetSequence”上的 ForeignKeyAttribute 无效。在依赖类型“WidgetDistributor.WidgetEntity”上找不到外键名称“WIDGETSEQUENCE_ID”。Name 值应该是逗号分隔的外键属性名称列表。

我的实体是这样的：

```
[Table("WIDGETENTITIES")]
public class WidgetEntity {

    [Column("WIDGETENTITY_ID")]
    public int Id { get; set; }

    [ForeignKey("WIDGETSEQUENCE_ID")]
    public WidgetSequence Sequence { get; set; }

    // and other properties that map correctly
}

[Table("WIDGETSEQUENCES")]
public class WidgetSequence { 

    [Column("WIDGETSEQUENCE_ID")]
    public int Id { get; set; }

    [Column("NUMBER")]
    public int Number { get; set; }
} 
```

我的代码似乎是正确的。我做错了什么，在这里？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-11-14T22:28:51.343

如果您不想使用流利的语法，还有其他三种使用数据注释实现引用的方法（我个人更喜欢数据注释，因为它们看起来更容易阅读并且写在它们影响的属性之上）：

1.1) 使用 ForeignKey (带有相关属性) - 版本 1

```
[Table("WIDGETENTITIES")]
public class WidgetEntity {

    [Column("WIDGETENTITY_ID")]
    public int Id { get; set; }

    [Column("WIDGETSEQUENCE_ID")]
    public int WidgetSequenceId { get; set; }

    [ForeignKey("WidgetSequenceId")] //Has to be a property name, not table column name
    public WidgetSequence Sequence { get; set; }

    // and other properties that map correctly
}

[Table("WIDGETSEQUENCES")]
public class WidgetSequence { 

    [Column("WIDGETSEQUENCE_ID")]
    public int Id { get; set; }

    [Column("NUMBER")]
    public int Number { get; set; }
} 
```

1.2) 使用 ForeignKey (带有相关属性) - 版本 2

```
[Table("WIDGETENTITIES")]
public class WidgetEntity {

    [Column("WIDGETENTITY_ID")]
    public int Id { get; set; }

    [ForeignKey("Sequence")] //Has to be a property name, not table column name
    [Column("WIDGETSEQUENCE_ID")]
    public int WidgetSequenceId { get; set; }

    public WidgetSequence Sequence { get; set; }

    // and other properties that map correctly
}

[Table("WIDGETSEQUENCES")]
public class WidgetSequence { 

    [Column("WIDGETSEQUENCE_ID")]
    public int Id { get; set; }

    [Column("NUMBER")]
    public int Number { get; set; }
} 
```

2) 您也可以使用 InversePropertyAttribute。

```
[Table("WIDGETENTITIES")]
public class WidgetEntity {

    [Column("WIDGETENTITY_ID")]
    public int Id { get; set; }

    [InverseProperty("WidgetEntities")]
    public WidgetSequence Sequence { get; set; }

    // and other properties that map correctly
}

[Table("WIDGETSEQUENCES")]
public class WidgetSequence { 

    [Column("WIDGETSEQUENCE_ID")]
    public int Id { get; set; }

    [Column("NUMBER")]
    public int Number { get; set; }

    public virtual List<WidgetEntity> WidgetEntities { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-06-22T00:44:48.653

`ForeignKey`attibute 需要您的类中的属性名称作为参数，但您给出了列名称。使用流畅的映射。

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{

    modelBuilder.Entity<WidgetEntity>()
     .HasRequired(w => w.Sequence)
     .WithMany()
     .Map(m => m.MapKey("WIDGETSEQUENCE_ID"));
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-11-07T16:17:11.173

有一个名为 Users 的表，它有一个名为 UserID 的主键。

还有一个名为 Directory 的表，它有一个名为 UserID 的列，它被定义为 Users 表的外键。

我可以使用 ForeignKey 注释来映射外键，如下所示：

```
[ForeignKey("xyzzy")]
public int? UserID { get; set; }  // This is a column in the table
public virtual User xyzzy { get; set; } // This is my instance of User 
```

# asp.net-mvc - 如何将经典的 asp 请求映射到 mvc 控制器和操作

> ID：11148668
> 
> 赞同：1
> 
> 时间：2012-06-22T00:19:11.977
> 
> 标签：asp.net-mvc, asp-classic

说路由不是我的强项是轻描淡写，所以请多多包涵。

我的一个页面中有这个链接，我需要我的 MVC 路由来获取它并将其映射到

“MyArea”区域“MessagesController”控制器“Inbox”方法

```
http://localhost/MyArea/messages/list.asp?pjid=&box=in&sf=mesibox 
```

到目前为止我想出的并没有削减它。

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

routes.IgnoreRoute("favicon.ico");

routes.MapRoute(
    "Messages", 
    "messages/list.asp", 
    new
        {
            controller = "Messages", 
            action = "Inbox"
        });

routes.MapRoute(
    "Default",
    "{controller}/{action}/{id}",
    new
        {
            controller = "Account",
            action = "LogOn",
            id = UrlParameter.Optional
        }
    ); 
```

任何帮助，将不胜感激。

谢谢你，斯蒂芬

更新：达林在这里回答了一个类似的问题[How to route legacy QueryString parameters in ASP.Net MVC 3?](https://stackoverflow.com/questions/5278917/how-to-route-legacy-querystring-parameters-in-asp-net-mvc-3/5278949#5278949) 这样就可以处理查询字符串参数。现在要弄清楚主要部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T06:00:42.420

您似乎已经定义了一个区域，因此您可以尝试在该区域的路由配置中添加该路由，而不是在 global.asax 中：

```
public override void RegisterArea(AreaRegistrationContext context)
{
    context.MapRoute(
        "MyArea_default",
        "MyArea/messages/list.asp",
        new { controller = "messages", action = "inbox" }
    );

    context.MapRoute(
        "MyArea_default",
        "MyArea/{controller}/{action}/{id}",
        new { action = "Index", id = UrlParameter.Optional }
    );
} 
```

# c# - 取消表单加载

> ID：11148671
> 
> 赞同：5
> 
> 时间：2012-06-22T00:19:39.977
> 
> 标签：c#, winforms, forms

我有以下代码：

这称为第二种形式

```
private void updateToolStripMenuItem_Click(object sender, EventArgs e)
        {
            Update fm = new Update();
            fm.ShowDialog();
        } 
```

这是构造函数

```
 public Update()
    {
        InitializeComponent();
    } 
```

这是负载

```
 private void Update_Load(object sender, EventArgs e)
    {
        String ver = checkver();
        if (ver == "update")
        {
            if (RemoteFileExists(dlUrl) == true)
            {
                WebClient webClient = new WebClient();
                webClient.DownloadFileCompleted += new AsyncCompletedEventHandler(Completed);
                webClient.DownloadProgressChanged += new DownloadProgressChangedEventHandler(ProgressChanged);
                webClient.DownloadFileAsync(new Uri(dlUrl), "");
            }
            else
                MessageBox.Show("An error occurred. Please try later.");
        }
        else if (ver == "newest")
        {
            MessageBox.Show("You are currently using the newest version.");
            this.Close();
        }
        else
        {
            this.Close();
        }
    } 
```

我的问题是，当函数结果为 2 或 3 时，表单会显示毫秒然后关闭（闪烁）。我希望表格不闪烁。可能吗？

我尝试使用**this.Hide()**，**this.Visible = False**但没有任何帮助。

编辑：我把原来的代码 EDIT2：把更多的代码

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-22T00:38:10.370

您可以在加载之前隐藏表单，然后在您的`if else`条件下将其设置为可见。例如：

```
 MyForm myForm = new MyForm();
            myForm.Opacity = 0;
            myForm.Show(); 
```

接着：

```
if (ver == "update")
        {
            if (RemoteFileExists(dlUrl) == true)
            {
               myForm.Opacity = 100;
               ...

            }
            else
                MessageBox.Show("An error occurred. Please try later.");
        }
        else if (ver == "newest")
        {
            MessageBox.Show("You are currently using the newest version.");
            this.Close();
        }
        else
        {
            this.Close();
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T00:28:32.747

在您选择首先打开表单之前，您可能应该执行您正在执行的任何检查。

所以像：

```
if(funct() == "1")
{
    var form = new Form();
    form.ShowDialog();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-22T08:44:39.460

最好的方法：

```
private void Form_Load(object sender, EventArgs e) 
{ 
   switch(funct())
   {
      case 2:
         this.BeginInvoke(new MethodInvoker(this.Close));
          break;
      case 3:
         this.BeginInvoke(new MethodInvoker(this.Close));
           break; 
     default:
           MessageBox.Show("Something");
   }   
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-22T00:34:01.443

我假设`Update_Load`是你的`FormLoad`处理程序？这是在您的表单显示**后调用的。**如果你不想显示它，那就太晚了。将您更改`updateToolStripMenuItem_Click`为：

```
String ver = checkver();
if (ver == "update")
{
    if (RemoteFileExists(dlUrl))
    {
        Update fm = new Update();
        fm.ShowDialog();
    }
    else
        MessageBox.Show("An error occurred. Please try later.");
}
else if (ver == "newest")
{
    MessageBox.Show("You are currently using the newest version.");
} 
```

并将您的更改`Update_Load`为：

```
WebClient webClient = new WebClient();
webClient.DownloadFileCompleted += new AsyncCompletedEventHandler(Completed);
webClient.DownloadProgressChanged += new DownloadProgressChangedEventHandler(ProgressChanged);
webClient.DownloadFileAsync(new Uri(dlUrl), ""); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T00:32:48.837

尝试这个

```
private void Form_Load(object sender, EventArgs e) 
{ 
   switch(funct())
   {
      case 2:
         this.Close();
          break;
      case 3:
          this.Close();
           break; 
     default:
           MessageBox.Show("Something");
   }   
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T00:22:06.090

也许先隐藏它，然后仅在 funct() == "1" 时显示它：

```
private void Form_Load(object sender, EventArgs e)
{
    this.Close();

    if (funct() == "1")
        MessageBox.Show("Something");
} 
```

# php - 方法可以在类之外定义吗？

> ID：11148674
> 
> 赞同：2
> 
> 时间：2012-06-22T00:20:06.903
> 
> 标签：php

我刚刚开始在 php 中使用类，并且来自 C++ 背景。从字面上看，我看到的每个示例都显示了在类定义中定义的方法，我想知道是否可以在类定义之外定义我的类方法以提高可读性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T00:22:38.283

有点。PHP 5.4 引入了[特性](http://www.php.net/manual/en/language.oop5.traits.php)，这与你将得到的差不多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-22T00:25:09.550

是的，你可以在 PHP 中。类方法的函数体可以完全放入外部文件中：

```
class foo
{
    function bar() {
        include('import_method_body.php');
    }
} 
```

这自古以来就有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T00:23:49.110

简而言之，不，你不能那样做；在 php 中，每个方法都应该在类中。这就是为什么我见过的一些开发人员不认为 php 是完全 OOP 语言的原因。

# codeigniter - 解决从视图调用函数的不可预见的视图问题

> ID：11148676
> 
> 赞同：0
> 
> 时间：2012-06-22T00:20:28.017
> 
> 标签：codeigniter, codeigniter-2

我有一些真正难以解决的问题。基本上我会搜索一个房间，然后我会显示一个符合条件的房间列表（包括分页）。现在，当我尝试调用房间的图像时，问题就出现了。第一张图片将显示，但其余的不会，我收到错误：

> 遇到 PHP 错误 严重性：通知
> 
> 消息：未定义的偏移量：0
> 
> 文件名：views/search_view.php
> 
> 行号：27
> 
> 遇到 PHP 错误 严重性：通知
> 
> 消息：试图获取非对象的属性
> 
> 文件名：views/search_view.php
> 
> 行号：27

这是我到目前为止所做的

我的模型：

```
function get_room_image($rid)
{
    $q = $this->db
        ->where('room_id',$rid)
        ->limit(1)
        ->get('room_image');

    return $q->result();

}

function search_rooms() 
{
    $q = $this->db
        ->where('features', $this->input->post('features'))
        ->get('rooms');

    $room['results'] = $q->result();

    return $room['results'];
} 
```

我的控制器：

```
function search()
{
    $data['main_content'] = 'search_view';
    $data['page_title'] = 'Search';

    $data['results'] = $this->site_model->search_rooms();

    $this->load->view('includes/template',$data);
} 
```

我的观点：

```
...    
<?php foreach ($results['results'] as $room) { 

    $room_images = $this->site_model->get_room_image($room->id); ?>
        <div class="col2 bot">

            <div class="col_head"></div>
                <div class="col_info">
                <table border="0" cellpadding="5" cellspacing="5">
                <tr><td> 
                <img src="<?php echo base_url() . 'room/' . $room_images[0]->image_name; ?>" border="0" class="imgbox" />
                </td> 
... 
```

第 27 行实际上是上面带有 img 标签的行

当我按要求执行 var_dump 时，我得到以下信息：

```
array(1) {
  [0]=>
  object(stdClass)#27 (3) {
    ["id"]=>
    string(1) "1"
    ["room_id"]=>
    string(1) "1"
    ["image_name"]=>
    string(36) "1614d828817ac5b396660621048b167a.jpg"
  }
}

array(0) {}
array(0) {}
array(0) {}
... 
```

所以它似乎没有在每次迭代中正确执行 get_room_image 函数

任何建议都是最受欢迎的。

问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T06:00:21.043

首先，我认为您不应该从视图中调用模型。您应该从控制器中调用模型并将其传递给您的视图。另一个谈论这个的SO帖子：[https ://stackoverflow.com/a/1733309/1260593](https://stackoverflow.com/a/1733309/1260593)

您应该尝试对模型中的表执行连接。

模型：

```
function search_rooms() 
{
$q =  $this->db
 ->select('*')
 ->from('rooms')
 ->where('features', $this->input->post('features'))
 ->join('room_image', 'rooms.id = room_image.room_id');

return $q;
} 
```

控制器：

```
$data['main_content'] = 'search_view';
$data['page_title'] = 'Search';

$data['results'] = $this->site_model->search_rooms();

$this->load->view('includes/template',$data); 
```

看法：

```
<?php foreach ($results->result() as $room) { 

   $image = $room->image_name;
    <div class="col2 bot">

        <div class="col_head"></div>
            <div class="col_info">
            <table border="0" cellpadding="5" cellspacing="5">
            <tr><td> 
            <img src="<?php echo base_url() . 'room/' . $image; ?>" border="0" class="imgbox" />
            </td> 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T12:39:36.167

问题已解决，因为我忘记添加“;” 到我的数据库查询字符串中的一行

# iphone - 在 SQLite 中插入/替换数据

> ID：11148677
> 
> 赞同：0
> 
> 时间：2012-06-22T00:21:01.357
> 
> 标签：iphone, sqlite, insert, replace

为什么我不能将数据更新到 SQLite，即使它打印“是的”，请帮忙，这是我的代码，它是从 viewdidload 调用的：

```
 -(void)updateData{

    CryptTestAppDelegate *delegate=(CryptTestAppDelegate *)[[UIApplication sharedApplication] delegate];

    sqlite3_stmt *stmt=nil;

    NSString *dd = @"testing";

    const char *sql = "Update ProvPuzz set desc2=?";

    sqlite3_prepare_v2(delegate.db, sql, 1, &stmt, NULL);
    sqlite3_bind_text(stmt, 1, [dd UTF8String], -1, SQLITE_TRANSIENT);

    if(sqlite3_step(stmt)){

        NSLog(@"yes yes");
    }else{
        NSLog(@"no  no");
    }

    sqlite3_finalize(stmt);
    sqlite3_close(delegate.db);  

} 
```

它似乎通过了每一步，但我的数据根本没有改变。请提供任何帮助...我应该如何调用/编码才能在 SQLite 中插入/替换这些记录？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-22T05:14:10.990

```
NSString *UpdateSql = [NSString stringWithFormat:@"Update ProvPuzz set desc2 = something"];
const char *sqlStatement = [UpdateSql UTF8String];  
sqlite3_stmt *compiledStatement;
if(sqlite3_prepare_v2(filesDB, sqlStatement, -1, &compiledStatement, NULL) == SQLITE_OK) {

        if(sqlite3_step(compiledStatement) == SQLITE_DONE) 
        {
            sqlite3_reset(compiledStatement);   

        }
    }
    // Release the compiled statement from memory
    sqlite3_reset(compiledStatement);   
    sqlite3_finalize(compiledStatement);
    sqlite3_close(filesDB); 
```

并检查您的数据库连接是否正确打开

# ruby-on-rails - 使用 Postgresql 在 OS X Lion 上安装 Sphinx

> ID：11148680
> 
> 赞同：1
> 
> 时间：2012-06-22T00:21:09.487
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, sphinx, thinking-sphinx

所以我安装了 postgresql 和 thinking-sphinx gem。我 cd 进入我的 sphinx 下载文件夹并尝试运行 ./configure --with-postgresql

我收到以下消息：

#

错误：找不到 MySQL 包含文件。

检查您是否安装了 MySQL 包含文件。包名通常是“mysql-devel”。

如果您的系统上安装了包含文件，但您仍然收到此消息，您应该执行以下操作之一：

1) 使用 --with-mysql-includes 明确指定包含位置；2) 或使用 --with-mysql 明确指定 MySQL 安装根目录；3) 或确保 'mysql_config' 程序的路径列在您的 PATH 环境变量中。

要禁用 MySQL 支持，请使用 --without-mysql 选项。

#

我应该怎么办？我也尝试过使用 brew 安装 sphinx，但这也没有奏效。我很绝望。我只花了三个小时尝试配置它，但我一无所获。

我的 sphinx.yml 看起来像这样，我不确定它是否正确：

```
development:
  port: 9310
  bin_path: "/usr/bin"
  searchd_binary_name: searchd
  indexer_binary_name: indexer

test:
  port: 9310
  bin_path: "/usr/bin"
  searchd_binary_name: searchd
  indexer_binary_name: indexer

production:
  version: '1.10-beta' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-24T04:49:14.407

I used homebrew. According to the docs at thinking-sphinx, you need the mysql extension even if you are using postgres.

I mucked around with a few configurations but sphinx kept looking to connect to MySQL.

This worked for me:

```
brew install sphinx --mysql --pgsql 
```

Which configured:

```
./configure --with-mysql --with-pgsql 
```

Then it seemed to work.

See: [https://github.com/pat/thinking-sphinx](https://github.com/pat/thinking-sphinx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T13:53:43.677

我同意塔斯社的观点。`--without-mysql`您将使用&运行 Sphinx 的配置脚本`--with-pgsql`。我已经安装了 PostgreSQL `/usr/local`；因此，我的配置选项是：

```
shell~> ./configure --without-mysql --with-pgsql=/usr/local 
```

# php - PHP 闭包需要传递参数

> ID：11148681
> 
> 赞同：0
> 
> 时间：2012-06-22T00:21:25.437
> 
> 标签：php, closures

试图弄清楚为什么 php 匿名函数只有在函数头中给出参数时才起作用。

例如

```
$f = function(){
    echo "hello world";
};
$f;
$f(); 
```

不会工作。但

```
$f = function($argument){
    echo $argument;
}
$f('hello world'); 
```

工作得很好。

为什么它需要参数，是否有任何解决方法？

**编辑**

这应该是版本问题。我在 5.3.18 上，我的第一个例子肯定行不通。对于那些不相信的人，它会抛出：

```
Parse error: syntax error, unexpected T_FUNCTION in index.php(192) : 
  eval()'d code on line 1 
```

**编辑**

看了 DaveRandom 的回答后，我又回到了不知道发生了什么的状态。也就是说，如果他们是正确的，它可以在 5.3.10 中工作......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T00:25:57.443

这是[完全有效](http://codepad.viper-7.com/8Jd7lZ)的语法和输出`hello world`：

```
$f = function(){
    echo "hello world";
};
$f(); 
```

该行`$f;`什么也不做，相当于声明任何其他变量，然后写下新的变量名和分号。

匿名函数不需要参数，有关它们的更多详细信息，请参阅[手册](http://php.net/manual/en/functions.anonymous.php)。

您会收到这些语法错误，因为[您运行的是 PHP 版本 < 5.3](http://3v4l.org/9KiH2)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-22T00:27:06.953

这不会调用闭包：

```
$f; 
```

但是这个可以：

```
$f(); 
```

函数调用需要解析器识别括号。如果您只是提到变量`$f;`，那么这是一个空表达式。包含在其中的闭包对象`$f`被分配给一个临时的 zval（变量占位符），然后被丢弃。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-22T00:26:15.627

如果删除无意义的行，第一个代码[可以正常工作。](http://codepad.viper-7.com/ILLISn)`$f;`

*编辑*实际上，即使您保留该行，它[仍然有效。在](http://codepad.viper-7.com/HH0gUg)[5.3.10](http://codepad.viper-7.com/p4O1UX)中也是如此。

# xcode - 查找部署目标之外的 sdk 使用实例

> ID：11148682
> 
> 赞同：1
> 
> 时间：2012-06-22T00:21:43.177
> 
> 标签：xcode, macos, sdk, deployment-target

我正在尝试构建一个自动化测试来检查在当前部署目标之外调用的方法是否得到正确处理。这是一个具体的例子：

我的应用程序设置为使用 Mac OS X 10.8 sdk，部署目标设置为 10.6。

我经常使用 setTimingFunciton: 方法。它是在 10.7 中引入的。

[[NSAnimationContext currentContext] setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn]];

在大多数情况下，我通过检查正确地限制了这个方法调用，以确保该方法存在或者操作系统是正确的版本或更高版本。但我错过了一个。而且它在一个很少执行的代码路径中，所以即使是 beta 测试也没有注意到它。它只是在很久以后才回来咬我。

我想构建一种自动化的方法来测试可以部署在集成服务器或其他此类脚本回归测试上的此类事物。似乎必须有一种方法可以自动检查。

不幸的是，使用 10.6 sdk 重新编译会导致许多错误，主要是由于“现代 obj-c”。当然，这些并不是使用 10.8 sdk 时的错误。小心，我可以挑出错误并找到方法调用——但这过于复杂和手动。

有谁知道一种静态检查这类事情的方法，而无需人工挑选数百行错误错误？

PS我读过这个： [如果部署目标<基本sdk，如何检查是否使用了不可用的方法？](https://stackoverflow.com/questions/4437510/how-to-check-if-not-available-methods-are-used-if-deployment-target-base-sdk) 这建议使用另一个手动流程来挖掘它们。问题是，人类的方法让我失望了。我错过了一个。我想要一些更确定的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T13:38:34.190

这是一个想法。undef 并重新定义可用性宏，以便它们包含 Clang 将反对但不会影响程序流程的内容。运行 Clang。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T14:01:49.787

我已经使用了[这个答案](https://stackoverflow.com/a/8993138/1313863)中的技术，并且效果很好。完全自动，不会遗漏任何东西。

# scala - Scala println 不适用于 App 特征

> ID：11148683
> 
> 赞同：9
> 
> 时间：2012-06-22T00:21:45.187
> 
> 标签：scala, scripting, println

当我使用 scala [App](http://www.scala-lang.org/api/current/scala/App.html)特征时，我无法让 println 工作。

这个简单的示例按预期打印，

```
object HelloWorld {
  def main(args: Array[String]) {
    println("Hello, world!")
  }
} 
```

但是一旦我介绍了它没有的特征，

```
object HelloWorld extends App {
  println("Hello, world!")
} 
```

我没有收到任何错误，但没有任何内容打印到控制台。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-22T00:33:59.260

您是否先编译它（运行 scalac HelloWorld.scala）？看到这个评论：[http ://www.scala-lang.org/node/9483#comment-40627](http://www.scala-lang.org/node/9483#comment-40627)

编辑添加更多解释：第一个版本实际上是编译的。没有显式 main 方法的 Scala 文件未编译为脚本运行。这意味着对于您的第二个版本，文件中的命令按顺序运行，就好像它们已被输入到解释器中一样——因此，对象 HelloWorld 被创建，但没有对其调用任何方法。这里有更多关于 Scala 作为脚本语言的信息（滚动到第 5 步）：[http ://www.artima.com/scalazine/articles/steps.html](http://www.artima.com/scalazine/articles/steps.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-23T17:04:42.110

添加一行

```
object HelloWorld extends App {
  /* code */
}

HelloWorld.main(args) 
```

在文件的末尾。

该类定义了方法，但也需要调用它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-22T01:06:02.133

根据 [http://www.scala-lang.org/api/current/scala/App.html](http://www.scala-lang.org/api/current/scala/App.html)

你想做

```
object Main extends App {
 Console.println("Hello World: " + (args mkString ", "))
} 
```

# ruby-on-rails - Ruby on Rails - Omniauth Facebook 或 Twitter - AuthServicesController

> ID：11148689
> 
> 赞同：0
> 
> 时间：2012-06-22T00:22:23.607
> 
> 标签：ruby-on-rails, devise, omniauth

我是 Ruby on Rails 的新手，我想建立一个带有 facebook 和 twitter 的omniauth-devise 系统，作为我应用程序的一种登录方式。现在我几乎（我认为）即将让它运行起来。但是，我收到以下错误：

路由错误

未初始化的常量 AuthServicesController

尝试运行 rake 路线以获取有关可用路线的更多信息。

而且我无法继续登录。

我一直在网上做很多研究，但我找不到任何有相同或相似问题的人。

有人知道我是什么吗？我马上就完全迷路了。

非常感谢！

顺便说一句，我在 Services_controller.rb 中得到的所有代码如下：

此链接以漂亮的术语将您带到源代码[http://www.sourcepod.com/ubfirz26-7741](http://www.sourcepod.com/ubfirz26-7741)

```
 class ServicesController < ApplicationController
  before_filter :authenticate_user!, :except => [:create]

def index
  # get all authentication services assigned to the current user
  @services = current_user.services.all
end

def destroy
  # remove an authentication service linked to the current user
  @service = current_user.services.find(params[:id])
  @service.destroy

  redirect_to services_path
end

def create
  # get the service parameter from the Rails router
  params[:service] ? service_route = params[:service] : service_route = 'no service (invalid callback)'

  # get the full hash from omniauth
  omniauth = request.env['omniauth.auth']

  # continue only if hash and parameter exist
  if omniauth and params[:service]

    # map the returned hashes to our variables first - the hashes differ for every service
    # omniauth['extra']['raw_info'] o omniauth['extra']['raw_info'] . Aquest últim és el més modern
    if service_route == 'facebook'
      omniauth['extra']['raw_info']['email'] ? email =  omniauth['extra']['raw_info']['email'] : email = ''
      omniauth['extra']['raw_info']['name'] ? name =  omniauth['extra']['raw_info']['name'] : name = ''
      omniauth['extra']['raw_info']['id'] ?  uid =  omniauth['extra']['raw_info']['id'] : uid = ''
      omniauth['provider'] ? provider =  omniauth['provider'] : provider = ''
    elsif service_route == 'github'
      omniauth['user_info']['email'] ? email =  omniauth['user_info']['email'] : email = ''
      omniauth['user_info']['name'] ? name =  omniauth['user_info']['name'] : name = ''
      omniauth['extra']['raw_info']['id'] ?  uid =  omniauth['extra']['raw_info']['id'] : uid = ''
      omniauth['provider'] ? provider =  omniauth['provider'] : provider = ''
    elsif service_route == 'twitter'
      email = ''    # Twitter API never returns the email address
      #omniauth['user_info']['name'] ? name =  omniauth['user_info']['name'] : name = ''
      omniauth['info']['name'] ? name =  omniauth['info']['name'] : name = ''
      omniauth['uid'] ?  uid =  omniauth['uid'] : uid = ''
      omniauth['provider'] ? provider =  omniauth['provider'] : provider = ''
    #elsif service_route == 'google'
    #   omniauth['user_info']['email'] ? email =  omniauth['user_info']['email'] : email = ''
   #    omniauth['user_info']['name'] ? name =  omniauth['user_info']['name'] : name = ''
    #   omniauth['uid'] ? uid =  omniauth['uid'] : uid = ''
   #    omniauth['provider'] ? provider =  omniauth['provider'] : provider = ''
    else

      # we have an unrecognized service, just output the hash that has been returned
      render :text => omniauth.to_yaml
      #render :text => uid.to_s + " - " + name + " - " + email + " - " + provider
      return
    end

    # continue only if provider and uid exist
    if uid != '' and provider != ''
      # nobody can sign in twice, nobody can sign up while being signed in (this saves a lot of trouble)
      if !user_signed_in?
        # check if user has already signed in using this service provider and continue with sign in process if yes
        auth = Service.find_by_provider_and_uid(provider, uid)
        if auth
          flash[:notice] = 'Signed in successfully via ' + provider.capitalize + '.'
          sign_in_and_redirect(:user, auth.user)
        else
          # check if this user is already registered with this email address; get out if no email has been provided
          if email != ''
            # search for a user with this email address
            existinguser = User.find_by_email(email)
            if existinguser
              # map this new login method via a service provider to an existing account if the email address is the same
              existinguser.services.create(:provider => provider, :uid => uid, :uname => name, :uemail => email)
              flash[:notice] = 'Sign in via ' + provider.capitalize + ' has been added to your account ' + existinguser.email + '. Signed in successfully!'
              sign_in_and_redirect(:user, existinguser)
            else
              # let's create a new user: register this user and add this authentication method for this user
              name = name[0, 39] if name.length > 39             # otherwise our user validation will hit us

              # new user, set email, a random password and take the name from the authentication service
              #user = User.new :email => email, :password => SecureRandom.hex(10), :fullname => name
              user = User.new :email => email, :password => SecureRandom.hex(10), :name => name, :haslocalpw => false
              # add this authentication service to our new user
             # user.services.build(:provider => provider, :uid => uid, :uname => name, :uemail => email)
              user.services.build(:provider => provider, :uid => uid, :uname => name, :uemail => email)

              # do not send confirmation email, we directly save and confirm the new record
              user.skip_confirmation!
              user.save!
              user.confirm!

              # flash and sign in
              flash[:myinfo] = 'Your account on CommunityGuides has been created via ' + provider.capitalize + '. In your profile you can change your personal information and add a local password.'
              sign_in_and_redirect(:user, user)
            end
          else
            flash[:error] =  service_route.capitalize + ' can not be used to sign-up on CommunityGuides as no valid email address has been provided. Please use another authentication provider or use local sign-up. If you already have an account, please sign-in and add ' + service_route.capitalize + ' from your profile.'
            redirect_to new_user_session_path
          end
        end
      else
        # the user is currently signed in

        # check if this service is already linked to his/her account, if not, add it
        auth = Service.find_by_provider_and_uid(provider, uid)
        if !auth
          current_user.services.create(:provider => provider, :uid => uid, :uname => name, :uemail => email)
          flash[:notice] = 'Sign in via ' + provider.capitalize + ' has been added to your account.'
          redirect_to services_path
        else
          flash[:notice] = service_route.capitalize + ' is already linked to your account.'
          redirect_to services_path
        end  
      end  
    else
      flash[:error] =  service_route.capitalize + ' returned invalid data for the user id.'
      redirect_to new_user_session_path
    end
  else
    flash[:error] = 'Error while authenticating via ' + service_route.capitalize + '.'
    redirect_to new_user_session_path
  end
end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T15:27:33.480

Your class is declared as:

```
class ServicesController < ApplicationController 
```

And you are getting this error:

```
uninitialized constant AuthServicesController 
```

Look at the difference between ServicesController and AuthServicesController and I believe you have find the solution to your problem. In other words, I believe you should declare your class as:

```
class AuthServicesController < ApplicationController 
```

# php - 根据过滤器变量构造查询

> ID：11148700
> 
> 赞同：0
> 
> 时间：2012-06-22T00:23:24.390
> 
> 标签：php, mysql, codeigniter

基本上我需要从几个不同的表中获取一堆数据并显示它，这取决于过滤器的值（下拉框、滑块和标签）

这是我目前的查询：

```
$query_string = 'SELECT DISTINCT * FROM users
                        JOIN user_subjects ON users.id = user_subjects.user_id
                        JOIN user_notifications ON users.id = user_notifications.user_id
                        ';

if ($subjects != 'false') {
        if (count($subjects) > 1)
        {
            // If there is more than 1 subject tag
            $query_string .= ' WHERE user_subjects.subject_id = '.$subjects[0];

            foreach ($subjects as $subject) {
                $query_string .= ' OR user_subjects.subject_id = '.$subject;
            }
        }   
        else if (count($subjects) == 1) 
        {
            // If there's only 1 subject tag, select it only
            $query_string .= " WHERE user_subjects.subject_id = ".$subjects[0];
        }
}

    if ($subscription != 'All Subscriptions')
    {
        $query_string .= ' AND users.user_plan = "'.$subscription.'"';
    } 
```

所以查询的那部分大部分都在工作，但我还需要从另一个表中选择数据，具体取决于过滤器。

额外表（名为“user_notifications”）中的数据如下： - user_id - action - entity_id - exp_rewarded - timestamp

所以基本上我需要将此表与用户信息链接起来并获得我需要的一切。对不起，如果这不是特别清楚。我仍在尝试自己弄清楚。如果不是，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T01:03:47.907

我的猜测是由于 OR AND 问题，查询不起作用。使用括号。

```
if (count($subjects) > 1)
        {
            // If there is more than 1 subject tag
            $query_string .= ' WHERE (user_subjects.subject_id = '.$subjects[0];

            foreach ($subjects as $subject) {
                $query_string .= ' OR user_subjects.subject_id = '.$subject;
            }
             $query_string .= ')';
        } 
```

# regex - PHP - 正则表达式在“”处停止

> ID：11148715
> 
> 赞同：0
> 
> 时间：2012-06-22T00:26:15.477
> 
> 标签：regex

我正在使用正则表达式将 HTML 转换为 BBCODE。但是，使用来自农民所见即所得编辑器（TinyMce）的代码，我遇到了问题。这是一个非常奇怪的案例：

有一些典型的空白段落，`<p>&nbsp;</p>`但我无法以任何方式匹配它们。以下正则表达式都没有工作：

```
str_replace("<p>&nbsp;</p>",........)
str_replace("<p> </p>".........)
preg_replace("#<p>.?</p>#"....) 
```

**这确实有效，但是如果“空格”在其他地方怎么办，我怎么能匹配它们？**：

```
preg_replace("#<p>.{1,6}</p>#"....) 
```

`&nbsp;`即使它们没有被写入（在 BD 中，存储原始字符串的地方，`&nbsp;`没有写入，只有块），我怎样才能让它匹配所有的`<p> </p>`）这很奇怪......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T00:41:20.413

我建议您阅读**[Unicode Regular Expressions](http://www.regular-expressions.info/unicode.html)**和**[Wikipedia: Unicode Whitespace character](http://en.wikipedia.org/wiki/Whitespace_character#Unicode)**。

*脚本：*

```
$string = '123<p>  &nbsp;  &nbsp;  </p>abc';
$pattern = '/<p>(&nbsp;|[\s\p{Z}\p{C}\x85\xA0\x{0085}\x{00A0}\x{FFFD}]+)*<\/p>/iu'; 
$replacement = ''; 
echo preg_replace($pattern, $replacement, $string); 
```

*输出：*

```
123abc 
```

* * *

注意：要匹配任何单个 unicode 字形使用模式`\P{M}\p{M}*+`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-03T09:23:34.003

使用此正则表达式时，我遇到了类似的问题（**PHP process stop ）：**

`([\r\n\t ]|\xC2\xA0|&nbsp;)+`

匹配空格（*我的目的：用 single 替换任何类型的空格`' '`*）。我测试的字符串包含丰富的 HTML 标签。

这是我的解决方案：

`$text = str_replace( array( '\xC2\xA0', '&nbsp;' ), ' ', $text ); $text = preg_replace( "/[\n\r\t ]+/", ' ', $text );`

希望它可以帮助某人。

# codeigniter - Codeigniter 购物车：多次将商品添加到购物车替换

> ID：11148728
> 
> 赞同：3
> 
> 时间：2012-06-22T00:28:10.137
> 
> 标签：codeigniter, shopping-cart

使用 CI 2.1.1 和本机 Cart 库

如果我多次插入一个项目（具有相同的产品 ID、相同的选项），它会替换而不是增加数量。

这可能是一个错误，我是否遗漏了什么，或者我自己添加此功能的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T00:47:16.877

所以这是我的解决方案，在第 1 行更改 System/libraries/Cart.php。233 至 244

可能有更好的方法可以做到这一点，但它确实有效。我不明白为什么这个功能还没有

```
 // EDIT:    added check if idential rowid/item already in cart, then just increase qty
    //          without this addition, it would not increase qty but simply replace the item
    if (array_key_exists($rowid, $this->_cart_contents)) 
    {  
       $this->_cart_contents[$rowid]['qty'] += $items['qty'];    
    } 
    else 
    {
        // let's unset this first, just to make sure our index contains only the data from this submission
        unset($this->_cart_contents[$rowid]);     

        // Create a new index with our new row ID
        $this->_cart_contents[$rowid]['rowid'] = $rowid;

        // And add the new items to the cart array
        foreach ($items as $key => $val)
        {
            $this->_cart_contents[$rowid][$key] = $val;
        }                       
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T08:30:45.323

这不是一个错误。这样看：你告诉 CI 你想要 1 个 productX 在你的购物车中。如果它已经在那里，它就会保持这种状态。`rowid`确实得到更新。

编辑核心库**不是**一个好主意。这使您的应用程序依赖于您所做的更改，并且当您更新 CI 并忘记再次更改核心时，它可能会破坏它。

如果您真的希望能够增加`qty`用户每次点击 Add 的次数，那么我建议您做一些与您所做的类似的事情，但在 you 中`model`。检查产品是否已经在购物车中，获取`qty`并将现有产品添加`qty`到新产品中。这有意义吗？

# c# - 创建支持层次结构的自定义内容控件

> ID：11148735
> 
> 赞同：0
> 
> 时间：2012-06-22T00:28:52.907
> 
> 标签：c#, wpf

我正在使用*ContentControl*创建一些自定义对象，并将它们添加到工具箱中，允许用户将它们拖放到页面上。现在，我面临着其中一些控件有孩子的情况。如果它只有一个没有子项的项目，我会在 Tag 属性中检索每个对象的 ID，但是，对于第二个类别，情况并非如此，因为我需要存储和检索 ID 的层次结构集。经过几次搜索后，我遇到了[MSDN 论坛](http://social.msdn.microsoft.com/Forums/en/wpf/thread/3f149b06-7dce-47c1-bab7-c70a760353c0) ，它几乎接近我需要做的事情，但我想知道有更好、更优化的实现方法。

任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:33:12.353

如果一个对象*可以*有多个孩子，则使用 an`ItemsControl`而不是 a `ContentControl`。一个`ItemsControl`包含`ItemsControls`是一个层次结构。

# jquery - jQuery 移动 event.preventDefault()

> ID：11148737
> 
> 赞同：0
> 
> 时间：2012-06-22T00:29:39.127
> 
> 标签：jquery, jquery-mobile, transition, jquery-deferred, preventdefault

我四处搜索并尝试了一些解决方案，但我无法让 event.preventDefault() 处理简单的页面转换绑定：

```
$("#trainingmodus").bind('pagebeforeshow', function(event, data) {
  event.preventDefault();
  console.log("trainingmodus going off screen ");
  app.canvasGeneralHide(function(){
     //data.deferred.resolve( data.absUrl, data.options);
  });
}); 
```

我想要完成的是在其他一些转换完成后延迟页面转换。但是， event.preventDefault() 似乎不起作用。

在[文档](http://jquerymobile.com/branches/popup-widget/docs/api/events.html)中没有明确说明每个函数是否以及如何使用回调，但我认为它会，就像 pagebeforeload 监听器一样？

我看过其他几个问题，比如这个：[e.preventdefault(); 不工作](https://stackoverflow.com/questions/3362481/e-preventdefault-not-working)

我也尝试过使用

```
event.stopImmediatePropagation(); 
```

或者

```
event.stopPropagation(); 
```

唉，这两者都没有效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T22:09:13.493

我认为阻止默认值将在转换事件中，而不是在转换之前我不认为之前转换有默认事件，例如单击 a 标签的默认值是转到 href 属性中的地址。Preventdefault 会阻止这种情况发生。beforepagetransition 的默认行为是什么？我认为它没有必须明确定义的默认行为。

我认为你想阻止实际转换的默认值，直到你等待的任何事情都完成

# c# - 在我无法控制的主机中干净地关闭 DLL 的静态事件

> ID：11148742
> 
> 赞同：0
> 
> 时间：2012-06-22T00:30:20.250
> 
> 标签：c#, static, constructor, garbage-collection, finalizer

当我的 DLL 由我不控制的代码托管时，以下伪代码是否实现了我自己清理的目标？

*   更具体地说，如何清理在静态构造函数中创建的对象？

*   我需要在 Disposable 中抑制 Finalize 吗？

*   即使主机没有，我是否保证编译器或其他东西会调用 IDisposable ？

伪代码：

```
public class MyDLL  : SomeHostICantControl, IDisposable
{
    public SpinLock MyDictionarySpinlock = new Spinlock; // approximate syntax
    public static Dictionary<string, string> MyDictionary = null;
    public static Timer MyCleanUpTimer = null;

    public static MyDLL()
    {
        // Set up Cache Here ... how do I dispose of it?
        MyDictionary = new Dictionary<string, string>();

       // remove old data from the dictionary, use spinlock to sync writes
       // or use concurrent dictionary in .NET 4
       MyCleanUpTimer = new Timer(); // run every hour
    }

    // many instances will be created and disposed of.  I have no control when or how often
    public void MyDll()
    {
       this.MyHostEvent += New Event Handler....
    }

    //.. some event handler code here

    public void Dispose()
    {
       this.MyHostEvent -= Event Handler.;
       // Do I need to suppressFinalize here?
    }

    //~MyDll()
   //{
   // Is this the right place to clean up after my constuctor?
   //}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:04:32.730

按顺序回答您的问题：

静态字段存在于应用程序的整个生命周期中，因此它们会因应用程序退出而被“清理”（回收内存、关闭文件等）。您似乎没有做任何可能需要采取明确行动来清理的事情（例如，将 StreamWriter 中的缓冲数据刷新到文件中），但您的代码片段中可能缺少详细信息。

`Dispose()`如果您的类有终结器（您的似乎没有，因为它已被注释掉），或者如果有人可以从您的类派生并且可能引入可能需要清理的非托管资源，则您需要在您的方法中禁止终结。后者在这里适用，因为你的类没有被标记`sealed`，所以你*应该*禁止 finalize in `Dispose()`。

运行时不会调用`Dispose()`，但是如果存在，它将调用终结器。但是请注意，由于您的类实例似乎没有使用任何非托管资源，因此不需要终结器。

# solr - Solr 的架构及其工作原理

> ID：11148746
> 
> 赞同：0
> 
> 时间：2012-06-22T00:31:06.240
> 
> 标签：solr, lucene, indexing, schema, nutch

嘿，所以我开始研究 Solr 并对 Solr 的工作原理有几个问题。我知道架构定义了 Solr 应用程序中存储和索引的内容。但我很困惑 Solr 如何知道“内容”是网站的内容或 url 是 url？

我的主要目标是尝试从网站中提取电话号码，并且我希望 Solr 能够很好地吐出 1234567890。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T12:30:20.973

您需要在 Solr schema.xml 中通过声明所有字段及其字段类型来定义它。然后，您可以查询 Solr 以查找要搜索的任何字段。

请参考：[http ://wiki.apache.org/solr/SchemaXml](http://wiki.apache.org/solr/SchemaXml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T13:44:12.337

Solr 不会自动索引网站的内容。您需要告诉它如何索引您的内容。Solr 只知道您告诉它知道的内容。提取电话号码听起来很简单，因此编写更新脚本或在线查找应该不是问题。祝你好运！

# javascript - JavaScript 挑战：使用递归创建平均计算函数？

> ID：11148752
> 
> 赞同：1
> 
> 时间：2012-06-22T00:32:59.587
> 
> 标签：javascript

我在编写这段代码时遇到了麻烦。我应该创建一个函数，它可以采用一个数字数组或参数数组，并在不使用`for`or`while`循环的情况下计算平均值。它说我必须使用递归。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:54:44.540

感谢你们的建议，我能够自己完成它。在阅读你们发布的内容之前，我对如何进行实际的平均计算感到困惑。如果此代码可以改进，请告诉！谢谢！

```
function mean( list, more ) {

    if ( more ) {

        list = [].slice.call( arguments );

    } else if ( !list || list[0] === undefined ) return;

    var a = list,
        b = list.length;

    return (function execute() {

        if ( !a.length ) return 0;

        return ( a.pop() / b ) + execute();

    })();

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:37:24.453

我假设您熟悉递归。

只需实现一个带有索引参数的递归函数来跟踪您的位置，并将数字添加到同一个变量中。然后最后，除以数组的大小。

编辑：正如 Kranklin 在评论中指出的那样，使用 pop 你甚至不需要 index 参数。（您需要在迭代之前存储数组的大小）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T00:47:53.850

在这里，但是通过查看它，您同意**理解它**：

[http://jsfiddle.net/sparebyte/kGg9Y/1/](http://jsfiddle.net/sparebyte/kGg9Y/1/)

```
function calcAverage(nums, total, count) {
    if(isNaN(count)) {
        // First iteration: Init Params
        return calcAverage(nums, 0, nums.length);
    }
    if(nums.length) {
        // Middle itrations: Get a total
        total = nums.pop() + total;
        return calcAverage(nums, total, count)
    } else {
        // Last iteration: Find the total average
        return total / count     
    }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T00:47:47.007

```
function average(set, memo, total) {
  memo || (memo = 0);
  total || (total = set.length);
  if (set.length === 0) return memo / total;
  return average(set.slice(1, set.length), (memo + set[0]), total);
} 
```

你这样称呼它：

```
average([1,2,3,4]); // 2.5 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T01:30:37.603

这是我想出的：

```
function av(nums, i, t) {
   if (!Array.isArray(nums))
       return av([].slice.call(arguments));
   if (t === void 0){
       if (nums.length === 0)
          return;
       return av(nums, nums.length-1, 0);
   }
   t += nums[i];   
   if (i > 0)
       return av(nums, i-1, t);
   return t / nums.length;
} 
```

接受数字数组，或者如果第一个参数不是数组，则假定所有参数都是数字。（对像 . 这样的非数字数据不进行错误检查`av('a','x')`。）`undefined`如果数组为空或未提供参数，则返回。

```
alert( av([1,2,3,4]) );   // 2.5
alert( av(1,2,3,4,5) );   // 3 
```

假设`Array.isArray()`（或[适当的垫片](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/isArray#Compatibility)）可用。

# git-svn - 如何将本地 git 存储库导入 svn？

> ID：11148755
> 
> 赞同：15
> 
> 时间：2012-06-22T00:33:39.440
> 
> 标签：git-svn

我正在处理本地 git 存储库，我需要将本地 git 推送到*现有的*svn 存储库中。我的 git 存储库是纯本地 git 存储库，它***不是***使用`git svn clone`.

如何将此本地 git repo 导入 svn？

最好我希望将 git 历史记录导入 SVN。

目前 SVN 存储库的结构如下：

```
https://svnrepohost
           /branches
           /tags
           /trunk
                  /projectA
                  /projectB
                  /newProject 
```

我需要的是将我的 git 存储库导入到`https://svnrepohost/trunk/newProject`上面，假设`newProject`文件夹是空的。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-03T23:58:35.683

我终于通过以下步骤解决了这个问题：

1.  在要导入的 svn 中设置适当的项目文件夹，例如`http://svnrepo/svn/trunk/newProject`

2.  创建一个新的 git-svn 存储库

    > git svn 克隆`http://svnrepo/svn/trunk/newProject`

3.  将我们要作为***远程***导入的 git 存储库添加到*新*的git-svn 存储库

    > git remote add origin ../original-git-repo

4.  从 original-git-repo 中提取所有数据

    > git pull origin master --allow-unrelated-histories

5.  针对 svn 重新定位本地存储库

    > git svn 变基

6.  将更改提交到 svn

    > git svn dcommit

7.  清理遥控器

    > git远程删除原点

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T14:20:45.810

最简单的方法是只`svn import`使用 Git 目录。然而，这会丢失你的 Git 提交历史。

首先，通过在 Subversion 配置文件中`.git`设置来确保目录不会被导入。`global-ignores`打开你的文件（在 Windows 上`~/.subversion/config`会这样），找到开始部分，然后在下面添加一行，如下所示：`C:\Users\username\.subversion\config``[miscellany]`

```
global-ignores = .git 
```

（如果您已经有一行前面`global-ignores =`没有 a `#`，那么只需添加`.git`到该行的末尾。）

接下来，运行以下命令：

```
svn import <path-to-local-git-repository> https://svnrepohost/trunk/newProject 
```

这应该将本地 Git 存储库的内容复制到您想要的服务器上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T10:43:30.047

您可以使用[SubGit](http://subgit.com)。

```
$ svnadmin create repo.svn
$ subgit configure repo.svn                                                                                                                                                              

...                                                                                                                                                                           

            CONFIGURATION SUCCESSFUL                                                                                                                                                                                   

            Adjust '/tmp/repo.svn/conf/subgit.conf' file                                                                                                                                                               
            and then run                                                                                                                                                                                               
                subgit install "repo.svn"                                                                                                                                                                              
            to complete SubGit installation.
$ nano repo.svn/conf/subgit.conf #edit to set git.default.repository=path/to/your/bare/git/repository
$ subgit install repo.svn 
```

我还建议您创建 Git 存储库的裸克隆并指定它的路径（在 git.default.repository 中）而不是原始存储库。IE

```
$ git clone --bare path/to/your/original/repository path/to/your/bare/git/repository 
```

在“subgit install”命令之后，存储库（repo.svn 和 repo.git）将持续同步（由 Git 中的 pre-receive 钩子触发 [从推送到裸存储库开始] 并在 SVN 中预先提交）。要停止同步，您可以运行

```
$ subgit uninstall repo.svn 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-27T01:41:31.397

*   git svn 克隆[http://svnrepo/svn/trunk/newProject](http://svnrepo/svn/trunk/newProject)
*   git remote add origin ../original-git-repo
*   git 获取原点
*   git checkout -b lmaster remotes/origin/master
*   git rebase 大师
*   git svn 变基
*   git svn dcommit

# java - 仅当 EditText 为空时显示警报对话框。

> ID：11148757
> 
> 赞同：0
> 
> 时间：2012-06-22T00:33:57.393
> 
> 标签：java, android

所有-我有一个应用程序，用户在其中将值输入到多个编辑文本字段中，然后用户点击一个按钮来计算所有输入到公式中的数字并输出答案。我的问题是，当其中一个 edittect 字段留空时，当点击计算按钮时应用程序强制关闭。我知道我可以通过在点击计算按钮并且有一个或多个空的编辑文本字段时弹出一个警告对话框来解决此问题。我不知道如何将警报对话框放在“if”语句中。例如“如果任何一个编辑文本字段为空 .show() 这个警报对话框”。有人可以给我一些示例代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:43:09.323

如果您有（或创建）所有字段的数组/列表`EditText`，您可以像这样运行它们

```
for(EditText e : editTextList)
{
    if(e.getText().toString().length() == 0)
    {
        //Show dialog 
        break;
    }
} 
```

您可以像这样创建一个`EditText`s 列表：

```
List<EditText> editTextList = new ArrayList<EditText>(); 
```

然后添加

```
editTextList.add(myEditText); 
```

# php - 延迟加载相关域对象：在哪里/如何存储密钥？

> ID：11148763
> 
> 赞同：0
> 
> 时间：2012-06-22T00:34:54.907
> 
> 标签：php, oop, lazy-loading

一旦我从数据库中加载了一个域对象，我就拥有了它的一些相关对象的密钥。例如，当我加载“组织”时，我知道相关“所有者”的 ID。

我希望延迟加载 Owner 属性，因为不能保证我会在请求或会话期间使用它。

因此，在我看来，组织对象可以：

1.  拥有 OwnerId 属性和 Owner 属性。Owner 属性只会按需填充（使用 OwnerId 进行查找）。在这种情况下，唯一的（小）挑战是保持两个属性同步；或者
2.  仅拥有 Owner 属性。这最初将包含查找所有者的密钥（整数）。如果调用 Owner，则该值将被 Owner 对象替换。在这种情况下，（小）挑战将是避免类型转换问题。

哪种方法最好？有什么理由吗？还是有其他方法？我还缺少什么？

我正在使用 PHP，带有域、映射器和服务层。非常感谢您的想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T00:39:46.447

我正在使用选项 1（见上文）并且效果很好。

# php - 通过文件上传恢复 1.6mb sql (Mysql)

> ID：11148764
> 
> 赞同：0
> 
> 时间：2012-06-22T00:35:12.530
> 
> 标签：php, mysql

phpMyAdmin 可以成功恢复一个包含 LONGBLOG 数据的 1.6MB 转储文件。我正在尝试复制此功能，但我的功能似乎不起作用。我收到一个分段错误错误，它似乎永远不会执行任何备份文件的代码。（但它确实删除了表）

我相信段错误是在进行 preg_split 时。

这是恢复的例程：（这对没有 LONGBLOB DATA 的小文件非常有效）

```
function do_restore()
{
    $password=$this->input->post('password');
    if(!$this->Employee->authentication_check($password))
    {
        echo json_encode(array('success'=>false,'message'=>"failure"));
        exit();
    }
    else
    {
        $sq=file_get_contents($_FILES["file"]["tmp_name"]);
        $this->db->trans_start();
        $this->db->query('SET foreign_key_checks = 0');
        $tables = $this->db->list_tables();

        foreach ($tables as $table)
        {           
            $this->db->query('drop table '.$table);
        }

        $this->db->query('SET foreign_key_checks = 1');
        $queries = preg_split("/;+(?=([^'|^\\\']*['|\\\'][^'|^\\\']*['|\\\'])*[^'|^\\\']*[^'|^\\\']$)/", $sq); 
        foreach ($queries as $query) 
        {
            if($query) 
            {
                $this->db->query($query);
            } 
        }

        $this->db->trans_complete();
        echo json_encode(array('success'=>true,'message'=>"success"));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:54:35.273

看起来您需要添加一些代码以确保您拥有有效的文件内容。`$sq`在调用`preg_split`.

# html - 如何阻止文本框将输入的信息解释为 HTML

> ID：11148771
> 
> 赞同：1
> 
> 时间：2012-06-22T00:36:14.483
> 
> 标签：html, database, text

我对 html 和 php 相当陌生，并且有一个问题，我可以在我的文本框中键入 html，如果我从数据库中回显信息，它将实际运行代码。我的意思是...

在我的网站上有一个文本框，他们可以在文本框中输入 br 或 href 等，代码将像实际的 html 一样运行。

那么有没有办法防止这种情况呢？CKEditor 还是什么？非常感谢所有支持！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:43:28.627

[`htmlspecialchars`](http://php.net/htmlspecialchars)将是一个很好的起点。然后在您成为可怕的编码实践和安全问题的另一个受害者之前了解您在做什么。

# iphone - 当从垂直到水平播放时，iPhone 视频会显示在右下角

> ID：11148773
> 
> 赞同：0
> 
> 时间：2012-06-22T00:36:34.837
> 
> 标签：iphone

当我的应用程序运行时，视频和手机被评为横向模式，然后我的视频在右下角播放，有没有办法让视频在用户旋转时位于屏幕中间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T04:39:00.417

我不确定您是如何运行视频的，但请尝试这样做（在导入 MediaPlayer/MediaPlayer.h 之后）：

```
NSBundle *bundle = [NSBundle mainBundle];
NSString *moviePath = [bundle pathForResource:@"ExampleVideo" ofType:@"m4v"];
NSURL *movieURL = [NSURL fileURLWithPath:moviePath];
MPMoviePlayerController *testMovie = [[MPMoviePlayerController alloc] initWithContentURL:movieURL];
testMovie.scalingMode = MPMovieScalingModeAspectFit;
[testMovie play];
MPMoviePlayerViewController *moviePlayer = [[MPMoviePlayerViewController alloc] initWithContentURL:movieURL];
[self presentMoviePlayerViewControllerAnimated:moviePlayer]; 
```

当我播放电影时，我称之为它，它适用于旋转。

# jquery-mobile - 带有 Backbone.js 错误的 Underscore.js 模板

> ID：11148775
> 
> 赞同：0
> 
> 时间：2012-06-22T00:37:04.670
> 
> 标签：jquery-mobile, backbone.js, underscore.js

下面的行完全失败了。

```
template: _.template($('#test').html()), 
```

尝试按照[https://github.com/ccoenraets/backbone-jquerymobile](https://github.com/ccoenraets/backbone-jquerymobile)中的一个简单示例将 jQuery mobile 与 Backbone.js 一起使用。我在网络检查器中遇到的错误是：TypeError: 'null' is not an object (evalating 'str.replace') 位于 underscore.js 的第 913 行。以这种方式使用 is _.template：

```
template: _.template("<h1>To Do</h1>"), 
```

有效，但为了合并 jQuery 移动样式，这种方式行不通。

todo.js

```
TodoBb.Views.ComCentersTodo = Backbone.View.extend({

template: _.template($('#test').html()),

render: function() {
    $(this.el).html(this.template());
    return this;
}
}); 
```

main.html

```
<script type = 'text/template' id = 'test'> <h1>To Do</h1> </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:14:13.300

解析视图时 DOM 尚未准备好：

```
TodoBb.Views.ComCentersTodo = Backbone.View.extend({
    template: _.template($('#test').html()),
    //...
}); 
```

`$('#test').html()`也是如此`null`，您实际上正在这样做：

```
TodoBb.Views.ComCentersTodo = Backbone.View.extend({
    template: _.template(null),
    //...
}); 
```

将模板转换为 JavaScript 函数时[`_.template`](http://documentcloud.github.com/underscore/#template)使用的内部结构。[`replace`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace)

你有几个选择：

1.  将`TodoBd.Views.ComCentersTodo`定义放在`$(document).ready()`处理程序中：

    ```
    $(function() {
        TodoBb.Views.ComCentersTodo = Backbone.View.extend({
            template: _.template($('#test').html()),
            //...
        });
    }); 
    ```

2.  在需要之前不要编译模板：

    ```
    TodoBb.Views.ComCentersTodo = Backbone.View.extend({
        //... no template in here
        render: function() {
            var html = _.template($('#test').html(), this.model.toJSON());
            this.$el.html(html);
            return this;
        },
        //...
    }); 
    ```

作为**2**的变体，您可以在某处缓存已编译的模板函数，并且仅`_.template($('#test').html())`在您第一次使用它时调用。

# jquery - jQuery | 键入时显示 div

> ID：11148776
> 
> 赞同：1
> 
> 时间：2012-06-22T00:37:08.380
> 
> 标签：jquery, jquery-ui

你能帮我完成我当前的代码吗？首先，我设法显示、淡入和淡出 div，但由于某种原因，它一直来来去去！一旦我开始打字，我就会得到我想要的东西，但不管我做什么，它都会重复淡入淡出。

其次，我想让 div 显示在我的文本区域旁边，并具有不错的 css 格式。

这是我的脚本：

```
$(function() {
var moveLeft = -200;
var moveDown = -210;
  $("#quickSMScustomMessage").keyup(
function(){

  $('div#pop-up').fadeIn(200).show().delay(2000).fadeOut(1000);
  //.css('top', e.pageY + moveDown)
  //.css('left', e.pageX + moveLeft)
  //.appendTo('body');

});

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:57:52.337

只需添加停止以停止所有以前的动画......否则他们将排队

```
$('div#pop-up').stop().fadeIn()... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T07:01:49.150

这是另一个建议......使用超时来做到这一点......

```
 var timer;    
    $('#type').keyup(function(){
        clearTimeout(timer);
        $('#typeHelper').stop().fadeIn(200);
        timer = setTimeout(function(){
            $('#typeHelper').fadeOut(1000)            
        },2000)
    }) 
```

[试用演示](http://jsfiddle.net/qLxVh/)

# c - C 正则表达式性能

> ID：11148786
> 
> 赞同：3
> 
> 时间：2012-06-22T00:38:09.977
> 
> 标签：c, regex, performance, benchmarking

我正在用 C 编写代码以在 enwik8 和 enwik9 中执行一些正则表达式。我还在其他语言中创建相同的算法以用于基准测试。问题是我的 C 代码有问题，因为它需要 40 秒，而 python 和其他代码只需要 10 秒。

我忘记了什么？

```
#include <stdio.h>
#include <regex.h>

#define size 1024

int main(int argc, char **argv){
    FILE *fp;
    char line[size];
    regex_t re;
    int x;
    const char *filename = "enwik8";
    const char *strings[] = {"\bhome\b", "\bdear\b", "\bhouse\b", "\bdog\b", "\bcat\b", "\bblue\b", "\bred\b", "\bgreen\b", "\bbox\b", "\bwoman\b", "\bman\b", "\bwomen\b", "\bfull\b", "\bempty\b", "\bleft\b", "\bright\b", "\btop\b", "\bhelp\b", "\bneed\b", "\bwrite\b", "\bread\b", "\btalk\b", "\bgo\b", "\bstay\b", "\bupper\b", "\blower\b", "\bI\b", "\byou\b", "\bhe\b", "\bshe\b", "\bwe\b", "\bthey\b"};   

    for(x = 0; x < 33; x++){
        if(regcomp(&re, strings[x], REG_EXTENDED) != 0){
            printf("Failed to compile regex '%s'\n", strings[x]);

            return -1;
        }

        fp = fopen(filename, "r");

        if(fp == 0){
            printf("Failed to open file %s\n", filename);

            return -1;
        }

        while((fgets(line, size, fp)) != NULL){
            regexec(&re, line, 0, NULL, 0);
        } 
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T02:20:48.137

文件访问和编译正则表达式可能是罪魁祸首。

*   编译一次你的正则表达式并将它们存储在一个数组中
*   打开文件
*   读一行
*   在它上面运行每个编译的正则表达式
*   关闭文件。

# php - 在 DOMXpath 查询中使用双引号而不是单引号失败

> ID：11148789
> 
> 赞同：2
> 
> 时间：2012-06-22T00:38:35.233
> 
> 标签：php, dom

这可能只是 php 语法的问题，但为什么会这样：

```
$b = new DOMXPath($z);
$b = $x->query('//div[contains(@class,"xxx")]'); 
```

但是使用带有单引号的双引号不会：

```
$b = $x->query("//div[contains(@class,'xxx')]//a"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T11:12:14.420

也许它与字符串中的单引号有关。

尝试这个：

```
$b = $x->query("//div[contains(@class,\"xxx\")]//a"); 
```

否则我会坚持使用单引号版本。到底有什么大不了的？

# android - 移动后glulookat“重置”（使用android）

> ID：11148793
> 
> 赞同：0
> 
> 时间：2012-06-22T00:39:06.600
> 
> 标签：android, rotation, touch-event, ontouchlistener, glulookat

这是我的问题：我正在用 android 制作台球游戏，我想让相机围绕桌子的中心自由旋转。问题是，当我停止移动时，glulookat 似乎会自行重置，因为我只能一遍又一遍地看到相同的东西。如果有人知道如何解决这个问题或另一种方法来做我想做的事情，我将不胜感激

这是我的渲染器类：

```
public void onDrawFrame(GL10 gl) {

    // Redraw background color
    gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);

    // Set GL_MODELVIEW transformation mode
    gl.glMatrixMode(GL10.GL_MODELVIEW);

    gl.glLoadIdentity();   // reset the matrix to its default state

    // Screen position to angle conversion
    theta = (float) ((360.0/screenHeight)*mMoveY*3.0);    //3.0 rotations possible
    phi = (float) ((360.0/screenWidth)*mMoveX*3.0);

    // Spherical to Cartesian conversion.  
    // Degrees to radians conversion factor 0.0174532
    eyeX = (float) (r * Math.sin(theta/**0.0174532*/) * Math.sin(phi/**0.0174532*/));
    eyeY = (float) (r * Math.cos(theta/**0.0174532*/));
    eyeZ = (float) (r * Math.sin(theta/**0.0174532*/) * Math.cos(phi/**0.0174532*/));

    // Reduce theta slightly to obtain another point on the same longitude line on the sphere.

    eyeXtemp = (float) (r * Math.sin(theta/**0.0174532*/-dt) * Math.sin(phi/**0.0174532*/));
    eyeYtemp = (float) (r * Math.cos(theta/**0.0174532*/-dt));
    eyeZtemp = (float) (r * Math.sin(theta/**0.0174532*/-dt) * Math.cos(phi/**0.0174532*/));

    // Connect these two points to obtain the camera's up vector.
    upX=eyeXtemp-eyeX;
    upY=eyeYtemp-eyeY;
    upZ=eyeZtemp-eyeZ;

    // Set the view point
    GLU.gluLookAt(gl,       eyeX, eyeY, eyeZ,       0,0,0,      upX, upY, upZ); 
```

这是我的活动类中的 onTouch 方法：

```
 public boolean onTouchEvent(MotionEvent e) {

    float x = e.getX();
    float y = e.getY();

    switch (e.getAction()) {
    case MotionEvent.ACTION_MOVE:

        float dx = x - mPreviousX;
        float dy = y - mPreviousY;

        // reverse direction of rotation above the mid-line
        /*if (y > getHeight() / 2) {
            dx = dx * -1 ;
        }

        // reverse direction of rotation to left of the mid-line
        if (x < getWidth() / 2) {
            dy = dy * -1 ;
        }*/

        mRenderer.mMoveX = dx * TOUCH_SCALE_FACTOR/100;
        mRenderer.mMoveY = dy * TOUCH_SCALE_FACTOR/100;

        requestRender();
    }

    mPreviousX = x;
    mPreviousY = y;
    return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T04:12:55.737

当您进行数学运算时，您正在使用`mMoveX`and `mMoveY`。看起来您应该将它们*添加*到其他更持久的 x/y 变量中。

就像是：

```
mCamX += mMoveX;
mCamY += mMoveY;
theta = (float) ((360.0/screenHeight)*mCamY*3.0);    //3.0 rotations possible
phi = (float) ((360.0/screenWidth)*mCamX*3.0); 
```

# python - Python Tkinter：只要线程运行，我如何使我的 GUI 响应？

> ID：11148795
> 
> 赞同：3
> 
> 时间：2012-06-22T00:39:08.690
> 
> 标签：python, user-interface, tkinter, nonblocking

例如：

```
import threading
import time
import Tkinter

class MyThread(threading.Thread):

    def __init__(self):
        threading.Thread.__init__(self)

    def run(self):
        print "Step Two"
        time.sleep(20)

class MyApp(Tkinter.Tk):

    def __init__(self):
        Tkinter.Tk.__init__(self)

        self.my_widgets()

    def my_widgets(self):
        self.grid()

        self.my_button = Tkinter.Button(self, text="Start my function",
                                          command=self.my_function)
        self.my_button.grid(row=0, column=0)

    def my_function(self):
        print "Step One" 

        mt = MyThread()
        mt.start()

        while mt.isAlive():
            self.update()

        print "Step Three"

        print "end"

def main():
    my_app = MyApp()
    my_app.mainloop()

if __name__ == "__main__":
    main() 
```

好吧，如果我开始我的示例，它会按预期工作。我单击一个按钮，my_function 启动并且 GUI 响应。但我读过我应该避免使用 update()。所以，如果有人能解释为什么以及如何正确地等待线程，那就太好了？第二步是在一个线程中，因为它比第一步和第三步花费的时间要长得多，否则它会阻塞 GUI。

我是 Python 新手，我正在尝试编写我的第一个“程序”。也许我的想法不对，因为我不是很有经验......

问候，大卫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T02:11:05.203

你需要记住你有一个事件循环正在运行，所以你需要做的就是在每次事件循环进行迭代时检查线程。好吧，不是*每次*，而是定期。

例如：

```
def check_thread(self):
    # Still alive? Check again in half a second
    if self.mt.isAlive():
        self.after(500, self.check_thread)
    else:
        print "Step Three"

def my_function(self):
    self.mt = MyThread()
    self.mt.start()
    self.check_thread() 
```

# c - 从 lex 中的 while 循环中分离出来

> ID：11148797
> 
> 赞同：0
> 
> 时间：2012-06-22T00:39:09.727
> 
> 标签：c, lex

所以我在linux中使用了lex工具，陷入了尴尬的境地，我无法摆脱while循环。

例如：我写了；

```
while(1)
{
 int x = yylex();
 switch(x):
  case(ID):printf("ID");
  case(NUM):printf("NUM");

} 
```

现在我正在使用 yyin 从文件中读取；问题是 while 循环在读取整个文件后并没有失败，并且一直在终端要求更多输入。因此，在调用 while 循环后我无法调用其他函数。我知道我缺少一些基本的东西，如果有人能提供对这个问题的洞察力，那就太好了。

PS#谢谢大家的回答；作业提交日期前的紧张和睡眠不足；顺便说一句-我已经想出了我的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T02:15:53.293

我发现 C 代码存在一些问题，与`yylex()`函数内部发生的情况无关。您将代码引用为：

```
while(1)
{
  int x = yylex();
  switch(x):
  case(ID):printf("ID");
  case(NUM):printf("NUM");
} 
```

这显然不是您编译的源代码，因为它不能作为 C 语言接受。您需要将第一个冒号（之后`switch(x)`）替换为左大括号`{`，并且最后需要另一个右大括号`}`，以产生：

```
while(1)
{   
    int x = yylex();
    switch(x)
    {   
    case(ID):printf("ID");
    case(NUM):printf("NUM");
    }   
} 
```

这是语法上有效的 C 代码，但仍然存在问题：

1.  `break;`每个之后可能应该有一个`case`。
2.  可能应该有一个`default:`子句，它可能用于终止循环（但您不能`break`在 switch 范围内使用它来执行此操作）。
3.  语句应该打印一个换行符，`printf()`以便显示数据。

由于`yylex()`到达末尾时返回 0，因此您可能应该修改代码，使其更像：

```
void function(void)
{
    int x;
    while ((x = yylex()) != 0)
    {   
        switch (x)
        {   
        case ID: 
            printf("ID\n");
            break;
        case NUM:
            printf("NUM\n");
            break;
        default:
            printf("Other: %d\n", x); 
            break;
        }   
    }   
} 
```

这至少会向您展示发生了什么，并且没有无限循环，除非您编写了`lex`分析器以使其无法正确终止。我选择不让默认情况终止循环，因为循环以`yylex()`返回 0 为界。

当您编写 时`while (1)`，您正在编写一个无限循环。您有责任考虑循环是否真的是无限的。如果不是，那么您的目标应该是能够在循环顶部进行测试，以控制循环是否存在另一个循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T02:16:15.400

yylex() 在输入的逻辑末尾返回 0。尝试这个：

```
int x = -1;
while(!(x == 0))
{
    x = yylex();
    switch(x):
    {
        case(0): printf("that's all, folks!"); break;
        case(ID): printf("ID"); break;
        case(NUM): printf("NUM"); break;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T00:58:41.433

好吧，虽然我承认我不熟悉 lex 是什么，但我确实对 linux 环境和终端了解不少，所以...

尝试在终端中同时输入“Ctrl”和“c”。如果这不起作用，请使用“Ctrl”+“z”。如果您不介意让进程在后台停止，直到计算机关闭并完全消失，在 Ctrl + Z 之后，您无需执行任何其他操作。如果 Ctrl + C 有效，那么程序就结束了，你很好。

如果无论出于何种原因都不起作用，如果您知道您编写的程序的名称，您可以在终端中输入：

```
pkill -9 [insert name of program here] 
```

...这将向进程发送一个不可忽视的终止信号，并将其所有内存（RAM-它不会撤消对磁盘所做的更改）返回给父进程。

如果您不知道该程序的名称，但您认为您可能能够识别它，您可以尝试：

```
top 
```

这将在终端中显示所有当前正在运行的进程。找到仍在运行的程序的名称后，按 q 退出 top，然后使用您在 top 中识别的名称键入上面的 kill 命令。如果您不知道程序的名称，并且 Ctrl + Z 有效，但您不希望停止的作业一直占用其内存，直到您关闭计算机，您可以键入：

```
ps -a 
```

在您运行（和停止）程序的终端会话中，显示标记为“停止”的作业很可能是您的。同样，使用上面的 pkill 命令将杀死它。如果，出于某种原因，您知道进程 ID 但不知道名称（我不知道您为什么会知道，但您去...），您可以使用命令 'kill' 而不是 'pkill' （说明这些命令的使用方法网上都有，这里就不提了。他们也有帮助手册页，可以通过以下方式访问：

```
man [the name of the program you want help with; 'pkill' or 'kill', in this case.] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T03:35:02.390

为了补充大卫的答案，这里有一个不同的版本：

```
do
{
    int x = yylex();

    if (!x)
        break;

    switch(x):
    {
        case(ID): printf("ID"); break;
        case(NUM): printf("NUM"); break;
    }
} while(1); 
```

这只是为了表明您可以摆脱一段时间（1）。您将 x 保持在本地范围内，并且不会评估第一次传递或不必要的切换。当然，很可能有人会拿出“它不那么可读”的王牌……

# matlab - 计算/转换共终端角以仅显示正数

> ID：11148798
> 
> 赞同：0
> 
> 时间：2012-06-22T00:39:11.757
> 
> 标签：matlab, octave, trigonometry, angle

我需要一点帮助来计算/转换共端角以仅显示我正在使用 octave/matlab 的正角。

示例：60、-300 和 780 度都是共端角（它们共享一个端边） 共端 [示例](http://www.mathwords.com/c/coterminal.htm)

我想要得到的是当我做一个`mod(-370,-360)`答案是`-10`正确的但我试图让答案作为一个**肯定**的答案/角度出现，无论输入的数字是负数还是正数，所以我想要的答案是`350`. 有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:41:19.990

为什么不使用正除数：`mod(-370, 360)`？

# matlab - matlab图中的子图标签

> ID：11148799
> 
> 赞同：3
> 
> 时间：2012-06-22T00:39:18.867
> 
> 标签：matlab, plot, label, matlab-figure, subplot

我想给我做一个简单标签的子图。不幸的是，我的行为很丑陋。考虑以下函数：

```
function h = set_label1(label)
tlh = get(gca, 'Title');
if strcmp(get(tlh, 'String'), '')
    title(' ');
end
ylh = get(gca, 'YLabel');
if strcmp(get(ylh, 'String'), '')
    ylabel(' ');
end

ylp = get(ylh, 'Position');
x = ylp(1);

tlp = get(tlh, 'Position');
y = tlp(2);

h = text('String', label, ...
        'HorizontalAlignment', 'right',...
        'VerticalAlignment', 'Baseline', ...
        'FontUnits', 'pixels', ...
        'FontSize', 16, ...
        'FontWeight', 'bold', ...
        'FontName', 'Arial', ...
        'Position', [x y 0]);
end 
```

这是一个简单的测试运行：

```
figure;
h1 = axes('OuterPosition', [0,0,.5 1]);
set(h1,'LooseInset',get(h1,'TightInset'));
h2 = axes('OuterPosition', [.5,0,.5 1]);
set(h2,'LooseInset',get(h2,'TightInset'));

axes(h1);
plot([0 1], [4 5]);
set_label1('A');  

axes(h2);
plot([0 1], [4 5]);
set_label1('B'); 
```

我得到的图片是：

![在此处输入图像描述](../Images/315ec701356070926446b8547eff757c.png)

如果您调整图形的大小，标签将不再位于正确的位置。这很好，我预料到了（如果你知道如何把它们放回它们所属的地方并且你告诉我们那会让我很高兴）。

我面临的问题是我不想以“数据”单位指定标签的位置。相反，我想使用标准化单位。所以我使用了修改后的函数形式。现在让我们使用它：

```
function h = set_label2(label)
tlh = get(gca, 'Title');
if strcmp(get(tlh, 'String'), '')
    title(' ');
end
ylh = get(gca, 'YLabel');
if strcmp(get(ylh, 'String'), '')
    ylabel(' ');
end

oldUnits = replace_prop(ylh, 'Units', 'normalized');
ylp = get(ylh, 'Position');
x = ylp(1);
set(ylh, 'Units', oldUnits);

oldUnits = replace_prop(tlh, 'Units', 'normalized');
tlp = get(tlh, 'Position');
y = tlp(2);
set(ylh, 'Units', oldUnits);

h = text('String', label, ...
        'HorizontalAlignment', 'right',...
        'VerticalAlignment', 'Baseline', ...
        'FontUnits', 'pixels', ...
        'FontSize', 16, ...
        'FontWeight', 'bold', ...
        'FontName', 'Arial', ...
        'Units', 'normalized',...
        'Position', [x y 0]);
end

function oldvalue = replace_prop(handle, propName, newvalue)
oldvalue = get(handle, propName);
set(handle, propName, newvalue);
end 
```

运行相同的测试：

```
figure;
h1 = axes('OuterPosition', [0,0,.5 1]);
set(h1,'LooseInset',get(h1,'TightInset'));
h2 = axes('OuterPosition', [.5,0,.5 1]);
set(h2,'LooseInset',get(h2,'TightInset'));

axes(h1);
plot([0 1], [4 5]);
set_label2('A');  

axes(h2);
plot([0 1], [4 5]);
set_label2('B'); 
```

我们得到与以前完全相同的图片。唯一的问题是，当我们现在调整它的大小时，会发生一些不好的事情：

![在此处输入图像描述](../Images/ef3f6c8d19d69f0d8022d411d4224f1a.png)

标签实际上是在正确的位置。但似乎我使用的`'LooseInset'`and`'TightInset'`属性使轴的行为就像没有标签一样。有什么解决办法吗？实际上，我所做的只是在标准化单元中获取标题和 ylabel 的位置，而不是在数据单元中，这似乎把它搞砸了。

我需要以标准化单位获取它的原因是，当我们获得 3D 图时，我可以相对于标题和 zlabel 定位标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T01:56:37.313

为了后代的缘故，这是我决定使用的版本。它做了我期望它做的事情，但现在我遇到了一个我不知道如何解决的问题。好的，首先是好消息，这里是调用的函数`axes_label`。

```
function c = axes_label(varargin)

if isa(varargin{1}, 'char')
    axesHandle = gca;
else
    axesHandle = get(varargin{1}{1}, 'Parent');
end

if strcmp(get(get(axesHandle, 'Title'), 'String'), '')
    title(axesHandle, ' ');
end
if strcmp(get(get(axesHandle, 'YLabel'), 'String'), '')
    ylabel(axesHandle, ' ');
end
if strcmp(get(get(axesHandle, 'ZLabel'), 'String'), '')
    zlabel(axesHandle, ' ');
end

if isa(varargin{1}, 'char')    
    label = varargin{1};
    if nargin >=2
        dx = varargin{2};
        if nargin >= 3
            dy = varargin{3};
        else
            dy = 0;
        end
    else
        dx = 3;
        dy = 3;
    end
    h = text('String', label, ...
        'HorizontalAlignment', 'left',...
        'VerticalAlignment', 'top', ...
        'FontUnits', 'pixels', ...
        'FontSize', 16, ...
        'FontWeight', 'bold', ...
        'FontName', 'Arial', ...
        'Units', 'normalized');
    el = addlistener(axesHandle, 'Position', 'PostSet', @(o, e) posChanged(o, e, h, dx, dy));
    c = {h, el};
else
    h = varargin{1}{1};
    delete(varargin{1}{2});
    if nargin >= 2    
        if isa(varargin{2}, 'char')
            set(h, 'String', varargin{2});
            if nargin >=3
                dx = varargin{3};
                dy = varargin{4};
            else
                dx = 3;
                dy = 3;
            end
        else
            dx = varargin{2};
            dy = varargin{3};
        end
    else
       error('Needs more arguments. Type help axes_label'); 
    end
    el = addlistener(axesHandle, 'Position', 'PostSet', @(o, e) posChanged(o, e, h, dx, dy));
    c = {h, el};
end
posChanged(0, 0, h, dx, dy);
end

function posChanged(~, ~, h, dx, dy)
    axh = get(h, 'Parent');
    p = get(axh, 'Position');
    o = get(axh, 'OuterPosition');
    xp = (o(1)-p(1))/p(3);
    yp = (o(2)-p(2)+o(4))/p(4);
    set(h, 'Units', get(axh, 'Units'),'Position', [xp yp]);
    set(h, 'Units', 'pixels');
    p = get(h, 'Position');
    set(h, 'Position', [p(1)+dx, p(2)+5-dy]);
    set(h, 'Units', 'normalized');
end 
```

好的，那么我们如何使用这个糟糕的功能呢？我这样做是为了我们可以有这些用途：

```
%   c = axes_label('label')
%      Places the text object with the string 'label' on the upper-left 
%      corner of the current axes and returns a cell containing the handle
%      of the text and an event listener.
%
%   c = axes_label('label', dx, dy)
%      Places the text object dx pixels from the left side of the axes
%      and dy pixels from the top. These values are set to 3 by default.
%
%   c = axes_label(c, ...)
%      Peforms the operations mentioned above on cell c containing the
%      handle of the text and the event listener.
%
%   c = axes_label(c, dx, dy)
%      Adjusts the current label to the specifed distance from the
%      upper-left corner of the current axes. 
```

如果我们执行与之前相同的测试：

```
figure;
h1 = axes('OuterPosition', [0,0,.5 1]);
set(h1,'LooseInset',get(h1,'TightInset'));
h2 = axes('OuterPosition', [.5,0,.5 1]);
set(h2,'LooseInset',get(h2,'TightInset'));

axes(h1);
plot([0 1], [4 5]);
axes_label('A');  

axes(h2);
plot([0 1], [4 5]);
axes_label('B', 250, 250); 
```

现在我们得到了我想要的。标签“A”设置在坐标区外框的左上角。并且标签 BI 明确地将其设置为距其左上角 250 像素。这是一个情节：

![在此处输入图像描述](../Images/6c17f6981c7d89f1627463ee3979e431.png)

我喜欢这个函数的地方是，如果我要存储从它返回的单元格，然后我放回去，我可以改变位置。例如，如果`label = axes_label('A');`然后在命令提示符下我可以做`label = axes_label(label, 10, 20);`，我会看到我的标签移动。

我现在面临的问题与功能有关[`export_fig`](http://www.mathworks.com/matlabcentral/fileexchange/23629)

如果我尝试使用这个：

```
export_fig('testing.png', '-nocrop', '-painters'); 
```

然后这是我得到的数字。

![在此处输入图像描述](../Images/1088dfe8ff2af09c54d5677a8ddda620.png)

这就是我夸大标签 B 的原因。在我添加事件侦听器之前，export_fig 在打印我放置它们的标签时会做得很好。但不知何故，现在 export_fig 并没有像它声称的那样做。主要导出图像

> 在屏幕上显示的图形/轴再现

相反，如果我们删除该选项`-painters`，那么我们会得到：

![在此处输入图像描述](../Images/c321ff464fc2a07b544bc7531c5f7a57.png)

由于我对听众没有经验，因此代码中可能存在错误，因此如果有人可以修复此行为和/或可以改进此代码，请随时这样做并将其作为答案分享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T21:56:58.433

首先，我喜欢你使用标题/y-label 将文本定位在左上角的想法，聪明:)

现在，不再使用标准化单位，而是继续使用数据单位，并为标题或 y 标签更改其位置时创建事件侦听器，并使用它们的新值重新调整创建的文本。

因此，将以下内容添加到`set_label1`函数的末尾：

```
addlistener(ylh, 'Position', 'PostSet', @(o,e) posChanged(o,e,h,1))
addlistener(tlh, 'Position', 'PostSet', @(o,e) posChanged(o,e,h,2)) 
```

这是用于这两种情况的回调函数（我们使用最后一个参数`idx`来控制是否设置 x 或 y 坐标）：

```
function posChanged(src,evt,hTxt,idx)
    posLabel = evt.NewValue;          %# new position of either title/y-label
    posText = get(hTxt, 'Position');  %# current text position
    posText(idx) = posLabel(idx);     %# update x or y position (based on idx)
    set(hTxt, 'Position',posText)     %# adjust the text position
end 
```

# shell - 如何在shell中使用expect

> ID：11148800
> 
> 赞同：0
> 
> 时间：2012-06-22T00:39:28.170
> 
> 标签：shell

这是我的shell脚本：

```
cd /home/debian/goagent  
python ./server/uploader.zip   

expect -c "  
set timeout 5   

expect {   
timeout exit   
\"APPID:\"   
}   
send \"haha\r\" 
```

为什么我的脚本没有运行？“哈哈”（我的APPID）没有输入APPID，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T01:50:26.450

如果你从 [https://code.google.com/p/goagent/](https://code.google.com/p/goagent/)下载 goagent， 你可以看到如何使用 goagent。我想自动输入一些东西来运行我的脚本。

人们使用 goagent 来查看更多内容，我只想让我的脚本自动运行

# git - 如何制作这个 git 别名？

> ID：11148804
> 
> 赞同：2
> 
> 时间：2012-06-22T00:39:55.690
> 
> 标签：git, alias

我使用此命令导出指定提交中的所有文件

```
git archive --output=export.zip --format=zip HEAD $(git diff --name-only COMMIT1 COMMIT2) 
```

我想创建一个别名，所以我不需要每次都输入这个长命令。

我试过了：

```
git config --global alias.he "archive --output=\"$1\" --format=zip HEAD \$(git diff --name-only \"$2\" \"$3\") 
```

但是，当我运行时`git he 1.zip COMMIT1 COMMIT2`，它会提示

```
error: unknown option `name-only' 
```

有人可以帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:26:16.147

别名通常不采用位置参数。更好的方法是编写一个简短的脚本 - 假设您想使用您提到的语法 ( `git he 1.zip COMMIT1 COMMIT2`)，命名脚本`git-he`并将其放在您的路径中的某个位置（例如`${HOME}/bin`，如果您是唯一的预期用户，或者`/usr/local/bin`为了更广泛的可访问性):

```
#!/bin/sh
git archive --output="$1" --format=zip HEAD $(git diff --name-only "$2" "$3") 
```

对于它无法识别的子命令，`git`将在您的路径中搜索名为`git-<command>`. 最好对参数进行一些健全性检查，并确保`chmod +x <path>/<to>/git-he`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T00:45:47.703

我建议为此使用 shell 别名。我在我的 bash 配置文件中定义了几个别名。

```
alias gs='git status '
alias ga='git add '
alias gb='git branch '
alias gc='git commit'
alias gd='git diff'
alias go='git checkout ' 
```

我大多只是使用`gs`而不是`git status`. 但这应该给你一个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:08:41.730

只需打开终端并输入

```
pico ~/.gitconfig 
```

并将其粘贴在您的凭据下

```
[alias]
    ci = commit
    cm = commit -am
    br = branch
    newbr = checkout -b
    delbr = branch -d
    showbr = for k in `git branch|sed s/^..//`;do echo -e `git log -1 --pretty=format:"%Cgreen%ci %Cblue%cr%Creset" "$k" --`\\t"$k";done|sort
    co = checkout
    df = diff
    dfc = diff --staged
    changes=diff --name-status -r
    diffstat=diff --stat -r
    lg = log --graph --oneline --pretty=format:'%Cred%h%Creset - %C(yellow)%s%Creset %C(green)<%an<%Creset' --abbrev-commit
    new = !sh -c 'git log $1@{1}..$1@{0} "$@"'
    llog = log --date=local
    fork = remote add -f 
```

当您想添加或删除别名时，只需编辑它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T05:56:27.517

将命令本身的双引号更改为单引号，如下所示：

```
git config --global alias.he "archive --output='$1' --format=zip HEAD \$(git diff --name-only '$2' '$3') 
```

无需在双引号内转义单引号。

# iphone - 要在地图上显示一个点，我需要验证连接吗？

> ID：11148805
> 
> 赞同：0
> 
> 时间：2012-06-22T00:40:04.390
> 
> 标签：iphone, objective-c, map, connection

我刚刚完成我的第一个应用程序并将其提交到 Apple Store。在应用程序中，我在地图上显示了一个点，但总是带有纬度和经度。问题是：我需要验证用户连接吗？如果我不这样做，我的应用程序将被拒绝？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T04:56:20.757

如果您的意思是您是否需要检查活动的互联网连接，您可以实施它以确保安全。这是一个详细说明检查的线程：

[如何在 iOS 或 OSX 上检查活动的 Internet 连接？](https://stackoverflow.com/questions/1083701/how-to-check-for-an-active-internet-connection-on-iphone-sdk)

# opencv - 如何在opencv中将此c代码转换为c++

> ID：11148807
> 
> 赞同：5
> 
> 时间：2012-06-22T00:40:05.897
> 
> 标签：opencv

我是opencv的初学者，学习Opencv是用C编写的代码。我需要转换为C++。

```
IplImage *imgY = cvCreateImage(imageSize, IPL_DEPTH_8U, 1);  
IplImage *imgCr = cvCreateImage(imageSize, IPL_DEPTH_8U, 1);  
IplImage *imgCb = cvCreateImage(imageSize, IPL_DEPTH_8U, 1);  
IplImage *imgYCrCb = cvCreateImage(imageSize, img->depth, img->nChannels); 

cvCvtColor(img,imgYCrCb,CV_BGR2YCrCb);  
cvSplit(imgYCrCb, imgY, imgCr, imgCb, 0);  

unsigned char *pY, *pCr, *pCb, *pMask;
pY = (unsigned char *)imgY->imageData;  
pCr = (unsigned char *)imgCr->imageData;  
pCb = (unsigned char *)imgCb->imageData;
pMask = (unsigned char *)mask->imageData; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-22T00:43:56.407

参考：

*   [http://opencv.willowgarage.com/documentation/cpp/c++_cheatsheet.html](http://opencv.willowgarage.com/documentation/cpp/c++_cheatsheet.html)
*   和[http://opencv.willowgarage.com/wiki/Welcome?action=AttachFile&do=get&target=opencv_cheatsheet.pdf](http://opencv.willowgarage.com/wiki/Welcome?action=AttachFile&do=get&target=opencv_cheatsheet.pdf)

例如，

```
IplImage *imgY = cvCreateImage(imageSize, IPL_DEPTH_8U, 1); 
```

变成

```
cv::Mat imgY = cv::Mat(imageSize, CV_8UC1); 
```

和

```
cvCvtColor(img,imgYCrCb,CV_BGR2YCrCb); 
```

变成

```
cv::cvtColor(img, imgYCrCb, CV_BGR2YCrCb); 
```

等等 ...

编辑 ：

回答您的评论：OpenCV 2 消除了手动管理内存的需要。

因此，代码可以重写为：

```
cv::Mat imgYCrCb;
std::vector<cv::mat> yCrCb_channels;

cv::cvtColor(img,imgYCrCb,CV_BGR2YCrCb);   
cv::split(imgYCrCb, yCrCb_channels);
unsigned char * pY = (uchar *) yCrCn_channels[1].data; 
```

建议：阅读[http://www.amazon.com/dp/1849513244/?tag=stackoverfl08-20](https://rads.stackoverflow.com/amzn/click/com/1849513244 "OpenCV 2 计算机视觉应用程序编程食谱")，它涵盖了 C++ opencv 接口。

# iphone - 苹果阻止标签栏上的标签在满足条件之前被点击

> ID：11148811
> 
> 赞同：0
> 
> 时间：2012-06-22T00:41:17.657
> 
> 标签：iphone, objective-c, app-store

苹果对阻止选项卡可点击的感觉如何，直到例如当用户单击另一个选项卡上的 uitableview 行时？

有时您可能不希望在满足特定条件之前访问另一个选项卡的内容。

例子：

**播放列表搜索播放设置**

在这种情况下，我不希望用户在“播放列表”选项卡中选择播放列表之前单击“搜索”选项卡。

这足以让应用在应用商店不被批准吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:20:57.810

您应该执行类似于音乐应用程序的操作，显示一个空选项卡，并解释为什么此选项卡为空。像这样：

![在此处输入图像描述](../Images/7e33075a8c969f1abdf6171b7a1f4358.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T02:33:59.410

您可以更改 UITabBarController 中可用的视图控制器。当用户选择某一行（如您所建议的）时，调用

```
– (void)setViewControllers:(NSArray *)controllers
                  animated:(BOOL)animated; 
```

因此，正如您所建议的，在他们选择播放列表之前不要添加搜索视图控制器。

# drupal - 安排 drupal 7 人/用户管理页面

> ID：11148819
> 
> 赞同：0
> 
> 时间：2012-06-22T00:41:44.140
> 
> 标签：drupal, views

我想安排我的 drupal 7 管理页面的人员部分。现在，人员/用户根据用户名、状态、角色、成员...等进行排列。我想让它看起来像姓氏，名字，员工ID，......等（这些是自定义配置文件字段。）最后我想根据他们的姓氏按字母顺序排列。我曾尝试使用视图，但最终遇到以下两个问题：1\. 我找不到名字、姓氏等自定义配置文件字段，以及 2\. 我必须创建页面或阻止访问视图页面的结果（我想在人员页面中制作所有内容。）非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:59:29.173

如果您指的是 /admin/people，您可以创建一个页面并在您的视图中使用该路径，它将覆盖默认的 /admin/people 页面。这是视图模块的一个显式特性。

请记住，您必须从管理员/人员页面模仿您想要保留的所有现有功能（例如公开的过滤器和排序），并确保您在视图上设置访问权限以确保只有管理员用户可以访问。

至于无法查看自定义配置文件字段，您的意思是它们没有显示在要选择的字段列表中吗？我不知道为什么会这样......如果您基于用户创建了一个视图，那么这些字段将显示在“用户”类别下（用户：名字，用户：姓氏 &c）。我检查了自己的安装，一切正常。更多信息？

# php - 基于动态哈希 url 的带有 strpos 的 PHP 变量

> ID：11148820
> 
> 赞同：1
> 
> 时间：2012-06-22T00:41:47.463
> 
> 标签：php, variables, strpos

我正在向 url 动态添加哈希 - 获取该 strpos 并尝试基于该变量显示某个页脚，我知道我可以只翻译整个页面，但我需要为客户端执行此操作，为什么它不起作用我想是问题吗？

网址看起来像[http://www.example.com/#/sp/](http://www.example.com/#/sp/)

这是我的标题：

```
<?php 
    $page = $_SERVER['REQUEST_URI'];
    $isSpanish = strpos($page, '/sp/'); 
    $isSpanishDynamic = strpos('#/sp/', $page); 
```

这是我的页脚：

```
 <?php if($isSpanishDynamic !== FALSE || $isSpanish !== FALSE) { ?>
                    <li><a href="/">PÁGINA DE INICIO</a></li>
                    <li><a href="/sp/our-story">HISTORIA</a></li>
                    <li><a href="/sp/menu">MENÚ</a></li>
                    <li><a href="/sp/contact">CONTACTO US</a></li>
                    <li><a href="/sp/order-online">ORDENE POR INTERNET</a></li>
    <?php } else { ?>
                    <li><a href="/">Home</a></li>
                    <li><a href="/en/our-story">Our Story</a></li>
                    <li><a href="/en/our-menu">Our Menu</a></li>
                    <li><a href="/en/contact">Contact Us</a></li>
                    <li><a href="/en/order">Order Online</a></li>
    <?php } ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:49:03.740

在类似的 url`http://example.com/#/sp/`中，哈希`#/sp/`永远不会发送到服务器，因此除非您以某种方式与服务器交互，否则您无法在 PHP 中做任何事情。

参见[维基百科](http://en.wikipedia.org/wiki/Fragment_identifier)：

> 片段标识符的功能与 URI 的其余部分不同：即，它的处理**完全是客户端的，没有服务器的参与**。当代理（例如 Web 浏览器）向 Web 服务器请求资源时，代理将 URI 发送到服务器，但不发送片段。相反，代理等待服务器发送资源，然后代理根据分片值处理资源。在最常见的情况下，代理将网页向下滚动到具有等于片段值的属性字符串的锚元素。其他客户端行为是可能的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:53:24.893

正如 artlung 指出的那样，哈希永远不会发送到服务器。还有其他一些方法可以做到这一点，查询字符串可能是您实现的下一个最简单的方法。代替`/#/sp/`，您可以添加一个查询参数`/?lang=sp`（完整 url：[http](http://example.com/?lang=sp) ://example.com/?lang=sp ）。

然后在您的 PHP 脚本中，您可以使用以下代码对其进行检查：

```
if ( isset($_GET['lang']) && $_GET['lang'] == 'sp' ) 
```

# php - 存储有关已存储在数据库中的数据的数据的方法？

> ID：11148821
> 
> 赞同：0
> 
> 时间：2012-06-22T00:41:53.827
> 
> 标签：php, mysql

我正在我的网站上创建一个收藏夹部分，用户可以简单地将某些项目存储在他们的收藏夹部分中以便于访问。每个项目都已经明确定义并具有多个属性。所以我的问题是假设我有 10,000 个用户，并且我想实现一个“收藏夹”系统，那么跟踪每个用户添加的收藏项目的最佳方法是什么？

我正在考虑通过以下方式实现这一点：将每个收藏项 id 链接到用户名，然后运行查询是否具有特定用户名的用户已登录，而不是通过该用户名检索所有收藏项。

我很感激任何帮助找出一个好的方法来做到这一点。我的目标是以一种以后易于检索和使用数据的方式存储，并最大限度地减少冗余信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:46:37.517

这很简单，您需要创建一个包含 3 个字段的新表：

```
id
favoriteID
userID 
```

每次用户添加新的收藏夹时，它都会在此表中添加一条新记录，存储收藏夹的 ID 和用户的 ID。没有多余的信息，并且很容易通过执行`join`查询来检索收藏夹或用户的详细信息。这就是关系数据库的用途。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:51:55.397

在 RDBMS 中，您可能会有一个带有用户 ID 和文章 ID 的多对多表。您不需要独立的 id 列：

创建表`favourites`（user_id int，art​​icle_id int）；

这些当然会引用您的用户表和文章表。（或者任何你有代替文章的东西。）

然后，当您想要显示该用户的收藏夹时，您需要检索该用户的所有行。您可能还想在列上创建一个组合唯一索引以防止重复。

您可能会使用 cassandra 之类的东西获得更快的响应，您可以在其中简单地根据 user_id 的键检索并在一个简单的位置获取他们所有的收藏夹。但是，您正在处理多个系统。

我听说，但还没有机会研究，MySQL 现在可以支持类似于 Cassandra 的键值系统，这可能是你最好的选择。

# shell - Shell脚本成功telnet登录，之后如何发出命令？

> ID：11148832
> 
> 赞同：3
> 
> 时间：2012-06-22T00:44:27.387
> 
> 标签：shell, telnet, expect

```
#!/usr/bin/expect -f
spawn telnet 10.21.0.17
expect -re "login"
send "admin\n"
expect -re "Password"
send "supersecurepassword\n"
interact 
```

按预期工作。运行脚本后，我登录到我在该行中使用的任何远程 IP`spawn telnet 10.21.0.17`

然后它把我丢到 AP 的外壳上

> WAP->

如何发出进一步的命令？我想发出`reboot`然后也许是`sleep 20`最后`exit`。

我试过使用`echo`但`expect`没有成功。我也试过删除`interact`没有成功。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T02:39:59.470

只需在`sleep`之前添加 a 即可解决此问题`expect`，当然[不包括`interact`](https://stackoverflow.com/questions/7789710/expect-script-to-automate-telnet-login#comment14621039_7789710)，以下效果很好：

```
#!/usr/bin/expect -f
spawn telnet 10.21.0.17
expect -re "login"
send "admin\n"
expect -re "Password"
send "supersecurepassword\n"
sleep 5
expect "WAP"
send "reboot\n"
send "exit\n" 
```

作为参考，这用于自动重启 D-Link DAP-2590 无线接入点。既然我知道了这一点，我可能会将它用于其他事情：更改密码等。希望它在未来对其他人有所帮助。

# c - 如何使用 __m128i 执行逐元素左移？

> ID：11148833
> 
> 赞同：4
> 
> 时间：2012-06-22T00:44:34.897
> 
> 标签：c, sse, avx

我发现的 SSE 移位指令只能在所有元素上移位相同的量：

*   `_mm_sll_epi32()`
*   `_mm_slli_epi32()`

[这些移动所有元素，但移动量相同。](http://software.intel.com/sites/products/documentation/studio/composer/en-us/2011/compiler_c/intref_cls/common/intref_sse2_int_shift.htm)

有没有办法对不同的元素应用不同的转变？像这样的东西：

```
__m128i a,  __m128i b;  

r0:=    a0  <<  b0;
r1:=    a1  <<  b1;
r2:=    a2  <<  b2;
r3:=    a3  <<  b3; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T00:55:59.310

存在`_mm_shl_epi32()`确实做到这一点的内在因素。

[http://msdn.microsoft.com/en-us/library/gg445138.aspx](http://msdn.microsoft.com/en-us/library/gg445138.aspx)

**但是，它需要[XOP 指令集](http://en.wikipedia.org/wiki/XOP_instruction_set)**。只有 AMD Bulldozer 和 Interlagos 处理器或更高版本有此指令。它不适用于任何英特尔处理器。

如果您想在没有 XOP 指令的情况下执行此操作，则需要以艰难的方式进行操作：将它们拉出来并一个接一个地执行。

如果没有 XOP 指令，您可以使用以下内在函数对 SSE4.1 执行此操作：

*   `_mm_insert_epi32()`
*   `_mm_extract_epi32()`

[http://software.intel.com/sites/products/documentation/studio/composer/en-us/2011/compiler_c/intref_cls/common/intref_sse41_reg_ins_ext.htm](http://software.intel.com/sites/products/documentation/studio/composer/en-us/2011/compiler_c/intref_cls/common/intref_sse41_reg_ins_ext.htm)

这些将允许您将 128 位寄存器的一部分提取到常规寄存器中以进行移位并将它们放回原处。

如果你采用后一种方法，它的效率会非常低。这就是为什么`_mm_shl_epi32()`首先存在的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T04:28:53.863

如果没有 XOP，您的选择就会受到限制。如果您可以控制移位计数参数的格式，则可以使用，`_mm_mullo_pi16`因为乘以 2 的幂与乘以该幂的移位相同。

例如，如果您想将 SSE 寄存器中的 8 个 16 位元素移位，`<0, 1, 2, 3, 4, 5, 6, 7>`您可以乘以 2 的移位计数幂，即`<0, 2, 4, 8, 16, 32, 64, 128>`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-04T16:11:29.877

在某些情况下，这可以替代`_mm_shl_epi32(a, b)`：

```
_mm_mullo_ps(a, 1 << b); 
```

一般来说，这需要`b`有一个常数值——我不知道`(1 << b)`使用旧 SSE 指令计算的有效方法。

# css - 将元素的底部边缘定位在容器内

> ID：11148836
> 
> 赞同：0
> 
> 时间：2012-06-22T00:45:00.467
> 
> 标签：css

我有一个顶部填充为 400 像素的容器 div（红色）。（蓝色）内的内容可以是任意高度。我还有另一个元素（绿色），宽度固定但高度可变，具体取决于内容。

![例子](../Images/dc1b30a99c7bdb098daa7f6d06e5b336.png)

我希望能够将绿色元素的底部边缘定位在蓝色内容的顶部（即距离红色容器顶部 400 像素）。

示例标记

```
<div class="red-container">

    <div class="green-thingy">Some text here</div>

    <div class="blue-content">
        <p>blah blah blah...</p>
        <p>blah blah blah...</p>
    </div>
</div> 
```

任何人都知道任何可以让我这样做的 CSS 技巧吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T00:58:12.607

您不能相对于父元素的顶部定位元素的底部。

添加另一个高度为 400 的元素位于容器的顶部，并将绿色 div 放入其中位于底部的位置。

# eclipse - 使用 GHC 6.12 在 Galileo 上设置 EclipseFP

> ID：11148838
> 
> 赞同：0
> 
> 时间：2012-06-22T00:45:17.577
> 
> 标签：eclipse, haskell, cabal

我已经在 Eclipse 上安装了 EclipseFP，当它启动时它提到我需要安装`buildwrapper`和`scion-browser`. 我更新了 cabal 并尝试安装每个，但我从以下位置收到此错误`sudo cabal install buildwrapper`：

```
david@mycomputer:~$ sudo cabal install buildwrapper
Resolving dependencies...
cabal: internal error: could not construct a valid install plan.
The proposed (invalid) plan contained the following problems:
The following packages are involved in a dependency cycle buildwrapper-0.5.2 
```

我收到这条消息是因为`sudo cabal install scion-browser`我需要指定不同的基础库（相关问题：我如何告诉 cabal 使用不同的基础库？）

```
david@mycomputer:~$ sudo cabal install scion-browser
Resolving dependencies...
cabal: cannot configure conduit-0.4.2\. It requires base >=4.3 && <5
For the dependency on base >=4.3 && <5 there are these packages: base-4.3.0.0,
base-4.3.1.0, base-4.4.0.0, base-4.4.1.0, base-4.5.0.0 and base-4.5.1.0.
However none of them are available.
base-4.3.0.0 was excluded because unix-2.4.0.0 requires base ==4.2.0.0
base-4.3.0.0 was excluded because template-haskell-2.4.0.0 requires base
==4.2.0.0
base-4.3.0.0 was excluded because process-1.0.1.2 requires base ==4.2.0.0
base-4.3.0.0 was excluded because pretty-1.0.1.1 requires base ==4.2.0.0
base-4.3.0.0 was excluded because old-time-1.0.0.3 requires base ==4.2.0.0
base-4.3.0.0 was excluded because old-locale-1.0.0.2 requires base ==4.2.0.0
base-4.3.0.0 was excluded because hpc-0.5.0.4 requires base ==4.2.0.0
base-4.3.0.0 was excluded because ghc-binary-0.5.0.2 requires base ==4.2.0.0
base-4.3.0.0 was excluded because filepath-1.1.0.3 requires base ==4.2.0.0
base-4.3.0.0 was excluded because directory-1.0.1.0 requires base ==4.2.0.0
base-4.3.0.0 was excluded because containers-0.3.0.0 requires base ==4.2.0.0
base-4.3.0.0 was excluded because bytestring-0.9.1.5 requires base ==4.2.0.0
base-4.3.0.0 was excluded because bin-package-db-0.0.0.0 requires base
==4.2.0.0
base-4.3.0.0 was excluded because array-0.3.0.0 requires base ==4.2.0.0
base-4.3.0.0 was excluded because Cabal-1.8.0.2 requires base ==4.2.0.0
base-4.3.0.0 was excluded because ghc-6.12.1 requires base ==4.2.0.0
base-4.3.0.0 was excluded because of the top level dependency base -any
base-4.3.1.0 was excluded because unix-2.4.0.0 requires base ==4.2.0.0
base-4.3.1.0 was excluded because template-haskell-2.4.0.0 requires base
==4.2.0.0
base-4.3.1.0 was excluded because process-1.0.1.2 requires base ==4.2.0.0
base-4.3.1.0 was excluded because pretty-1.0.1.1 requires base ==4.2.0.0
base-4.3.1.0 was excluded because old-time-1.0.0.3 requires base ==4.2.0.0
base-4.3.1.0 was excluded because old-locale-1.0.0.2 requires base ==4.2.0.0
base-4.3.1.0 was excluded because hpc-0.5.0.4 requires base ==4.2.0.0
base-4.3.1.0 was excluded because ghc-binary-0.5.0.2 requires base ==4.2.0.0
base-4.3.1.0 was excluded because filepath-1.1.0.3 requires base ==4.2.0.0
base-4.3.1.0 was excluded because directory-1.0.1.0 requires base ==4.2.0.0
base-4.3.1.0 was excluded because containers-0.3.0.0 requires base ==4.2.0.0
base-4.3.1.0 was excluded because bytestring-0.9.1.5 requires base ==4.2.0.0
base-4.3.1.0 was excluded because bin-package-db-0.0.0.0 requires base
==4.2.0.0
base-4.3.1.0 was excluded because array-0.3.0.0 requires base ==4.2.0.0
base-4.3.1.0 was excluded because Cabal-1.8.0.2 requires base ==4.2.0.0
base-4.3.1.0 was excluded because ghc-6.12.1 requires base ==4.2.0.0
base-4.3.1.0 was excluded because of the top level dependency base -any
base-4.4.0.0 was excluded because uniplate-1.6.7 requires base >=4 && <4.4
base-4.4.0.0 was excluded because unix-2.4.0.0 requires base ==4.2.0.0
base-4.4.0.0 was excluded because template-haskell-2.4.0.0 requires base
==4.2.0.0
base-4.4.0.0 was excluded because process-1.0.1.2 requires base ==4.2.0.0
base-4.4.0.0 was excluded because pretty-1.0.1.1 requires base ==4.2.0.0
base-4.4.0.0 was excluded because old-time-1.0.0.3 requires base ==4.2.0.0
base-4.4.0.0 was excluded because old-locale-1.0.0.2 requires base ==4.2.0.0
base-4.4.0.0 was excluded because hpc-0.5.0.4 requires base ==4.2.0.0
base-4.4.0.0 was excluded because ghc-binary-0.5.0.2 requires base ==4.2.0.0
base-4.4.0.0 was excluded because filepath-1.1.0.3 requires base ==4.2.0.0
base-4.4.0.0 was excluded because directory-1.0.1.0 requires base ==4.2.0.0
base-4.4.0.0 was excluded because containers-0.3.0.0 requires base ==4.2.0.0
base-4.4.0.0 was excluded because bytestring-0.9.1.5 requires base ==4.2.0.0
base-4.4.0.0 was excluded because bin-package-db-0.0.0.0 requires base
==4.2.0.0
base-4.4.0.0 was excluded because array-0.3.0.0 requires base ==4.2.0.0
base-4.4.0.0 was excluded because Cabal-1.8.0.2 requires base ==4.2.0.0
base-4.4.0.0 was excluded because ghc-6.12.1 requires base ==4.2.0.0
base-4.4.0.0 was excluded because of the top level dependency base -any
base-4.4.1.0 was excluded because uniplate-1.6.7 requires base >=4 && <4.4
base-4.4.1.0 was excluded because unix-2.4.0.0 requires base ==4.2.0.0
base-4.4.1.0 was excluded because template-haskell-2.4.0.0 requires base
==4.2.0.0
base-4.4.1.0 was excluded because process-1.0.1.2 requires base ==4.2.0.0
base-4.4.1.0 was excluded because pretty-1.0.1.1 requires base ==4.2.0.0
base-4.4.1.0 was excluded because old-time-1.0.0.3 requires base ==4.2.0.0
base-4.4.1.0 was excluded because old-locale-1.0.0.2 requires base ==4.2.0.0
base-4.4.1.0 was excluded because hpc-0.5.0.4 requires base ==4.2.0.0
base-4.4.1.0 was excluded because ghc-binary-0.5.0.2 requires base ==4.2.0.0
base-4.4.1.0 was excluded because filepath-1.1.0.3 requires base ==4.2.0.0
base-4.4.1.0 was excluded because directory-1.0.1.0 requires base ==4.2.0.0
base-4.4.1.0 was excluded because containers-0.3.0.0 requires base ==4.2.0.0
base-4.4.1.0 was excluded because bytestring-0.9.1.5 requires base ==4.2.0.0
base-4.4.1.0 was excluded because bin-package-db-0.0.0.0 requires base
==4.2.0.0
base-4.4.1.0 was excluded because array-0.3.0.0 requires base ==4.2.0.0
base-4.4.1.0 was excluded because Cabal-1.8.0.2 requires base ==4.2.0.0
base-4.4.1.0 was excluded because ghc-6.12.1 requires base ==4.2.0.0
base-4.4.1.0 was excluded because of the top level dependency base -any
base-4.5.0.0 was excluded because uniplate-1.6.7 requires base >=4 && <4.4
base-4.5.0.0 was excluded because unix-2.4.0.0 requires base ==4.2.0.0
base-4.5.0.0 was excluded because template-haskell-2.4.0.0 requires base
==4.2.0.0
base-4.5.0.0 was excluded because process-1.0.1.2 requires base ==4.2.0.0
base-4.5.0.0 was excluded because pretty-1.0.1.1 requires base ==4.2.0.0
base-4.5.0.0 was excluded because old-time-1.0.0.3 requires base ==4.2.0.0
base-4.5.0.0 was excluded because old-locale-1.0.0.2 requires base ==4.2.0.0
base-4.5.0.0 was excluded because hpc-0.5.0.4 requires base ==4.2.0.0
base-4.5.0.0 was excluded because ghc-binary-0.5.0.2 requires base ==4.2.0.0
base-4.5.0.0 was excluded because filepath-1.1.0.3 requires base ==4.2.0.0
base-4.5.0.0 was excluded because directory-1.0.1.0 requires base ==4.2.0.0
base-4.5.0.0 was excluded because containers-0.3.0.0 requires base ==4.2.0.0
base-4.5.0.0 was excluded because bytestring-0.9.1.5 requires base ==4.2.0.0
base-4.5.0.0 was excluded because bin-package-db-0.0.0.0 requires base
==4.2.0.0
base-4.5.0.0 was excluded because array-0.3.0.0 requires base ==4.2.0.0
base-4.5.0.0 was excluded because Cabal-1.8.0.2 requires base ==4.2.0.0
base-4.5.0.0 was excluded because ghc-6.12.1 requires base ==4.2.0.0
base-4.5.0.0 was excluded because of the top level dependency base -any
base-4.5.1.0 was excluded because uniplate-1.6.7 requires base >=4 && <4.4
base-4.5.1.0 was excluded because unix-2.4.0.0 requires base ==4.2.0.0
base-4.5.1.0 was excluded because template-haskell-2.4.0.0 requires base
==4.2.0.0
base-4.5.1.0 was excluded because process-1.0.1.2 requires base ==4.2.0.0
base-4.5.1.0 was excluded because pretty-1.0.1.1 requires base ==4.2.0.0
base-4.5.1.0 was excluded because old-time-1.0.0.3 requires base ==4.2.0.0
base-4.5.1.0 was excluded because old-locale-1.0.0.2 requires base ==4.2.0.0
base-4.5.1.0 was excluded because hpc-0.5.0.4 requires base ==4.2.0.0
base-4.5.1.0 was excluded because ghc-binary-0.5.0.2 requires base ==4.2.0.0
base-4.5.1.0 was excluded because filepath-1.1.0.3 requires base ==4.2.0.0
base-4.5.1.0 was excluded because directory-1.0.1.0 requires base ==4.2.0.0
base-4.5.1.0 was excluded because containers-0.3.0.0 requires base ==4.2.0.0
base-4.5.1.0 was excluded because bytestring-0.9.1.5 requires base ==4.2.0.0
base-4.5.1.0 was excluded because bin-package-db-0.0.0.0 requires base
==4.2.0.0
base-4.5.1.0 was excluded because array-0.3.0.0 requires base ==4.2.0.0
base-4.5.1.0 was excluded because Cabal-1.8.0.2 requires base ==4.2.0.0
base-4.5.1.0 was excluded because ghc-6.12.1 requires base ==4.2.0.0
base-4.5.1.0 was excluded because of the top level dependency base -any 
```

有谁知道如何安装这些库以便我可以使用 EclipseFP？在 Eclipse 启动时的弹出窗口中，它会安装这些库，但按下它不会做任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T03:55:04.487

您可以通过升级 GHC 获得更新的基础。我推荐这个：GHC 6.12 现在已经 2.5 年了，在那段时间发生了很多事情。

猜测一下，循环依赖来自使用旧版本的 cabal(-install)。较新版本的 cabal 允许单个包同时提供库和可执行文件（可能取决于库）；对于旧版本，这可能看起来像一个单包循环依赖。

# python - f2py 给出“'foo'的重新定义......以前的定义在这里”

> ID：11148841
> 
> 赞同：3
> 
> 时间：2012-06-22T00:46:07.390
> 
> 标签：python, fortran, f2py

这是我的第一个问题，所以对我好一点。

我正在使用 numpy 1.6.1 中的 f2py。我有一个包含几个子例程的 fortran 模块，这些子例程可以很好地编译（和工作）。但是，其中之一使用 erf(x) 函数，它是 GNU 扩展。对于我的目的来说它不够准确，所以我正在尝试使用外部 erf 实现。

我正在尝试使用 fortran 77 中的 Numerical Recipes 中的一个 - 我已将所有相关函数复制到一个名为“erf.f”的文件中，该文件与我的模块位于同一文件夹中。我`include 'erf.f'`在模块文件的顶部使用。我将 erf 函数的实际名称更改为“derf”，因此它不会与 gfortran erf 扩展名发生冲突。

但是，当我尝试通过 f2py 编译时，`foo`'erf.f' 中的每个函数都会出现错误

> 错误：“foo”的重新定义错误：“foo”的先前定义在这里

当我查看提到包含重新定义和先前定义的 c 文件时，似乎该函数确实存在两次。我只是不知道为什么？

有人知道如何解决这个问题吗？干杯。

编辑：我没有提到（因为我认为这是不必要的额外信息）numpy distutils 正在使用 f2py 来创建扩展。我现在提到它的原因是我发现我可以使用 很好地创建扩展`f2py -c my_module.f90 -m mod`，但是在运行时`python setup.py install`我得到了上面详述的错误。那么 f2py 在通过 distutils 运行时有什么不同呢？

编辑#2：如果我将外部 erf 函数文件的所有内容放入与我的模块相同的文件中，那么一切正常。我真的不想这样做，因为展望未来，我将拥有一个巨大的文件，但它现在可以工作，直到我得到这个问题的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T17:48:42.520

一种解决方案是创建一个模块并使用（或任何名称）`erf.f90`将其导入您的主代码中。`use erf`

我在`f2py`导入以`.f`扩展名命名的模块时遇到了一些奇怪的问题，您可以通过重命名`erf.f`并`erf.f90`指定`-ffixed-form`何时使用`gfortran`.

**编辑：**

如果使用 导入模块`use`，则不需要同时使用`include`. `include`基本上是在你的主代码的源代码中包含实际的代码（尽管你注意到，它的行为与直接输入主文件`erf.f`的行为并不完全相同），同时告诉编译器寻找一个预编译的模块。`erf.f``use`

我发现`use`在使用模块和`f2py`. （我的代码基本上是固定形式的 Fortran 90）。假设有一个 main 文件`main.f`和一个模块`subs.f90`（确保有`module...end module`in `subs.f90`，我将使用以下序列进行编译：

```
gfortran -ffixed-form -c subs.f90
f2py.py -c -m main -I/path/to/subs /path/to/subs/subs.f90 main.f 
```

请注意，您可能需要`f2py`根据您的系统指定其他选项。对我来说，在 Windows 上使用 MinGW，我需要`--compiler=mingw32`，因为`f2py`否则似乎无法找到 C 编译器。

# c++ - 类模板特化中模板参数的默认值

> ID：11148845
> 
> 赞同：3
> 
> 时间：2012-06-22T00:46:20.230
> 
> 标签：c++, templates, visual-c++, template-specialization

考虑以下代码：

```
template <class x1, class x2 = int*>
struct CoreTemplate { };

template <class x1, class x2>
struct CoreTemplate<x1*, x2*> { int spec; CoreTemplate() { spec = 1; } };

template <class x>
struct CoreTemplate<x*> { int spec; CoreTemplate() { spec = 3; } };

int main(int argc, char* argv[])
{
    CoreTemplate<int*, int*> qq1;
    printf("var=%d.\r\n", qq1.spec);

    CoreTemplate<int*> qq2;
    printf("var=%d.\r\n", qq2.spec);
} 
```

MSVC 很好地编译了这段代码，并在这两种情况下都选择了第二个特化。对我来说，这些专业是相同的。第一手的第二专业有多合法？

只是好奇，对此有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T00:53:18.983

第二个部分专业化是合法的，并且与第一个不同。

第二个部分特化没有在其模板实参列表中列出第二个模板形参的实参，因此使用 的默认实参`int*`，因此它等价于：

```
template <class x>
struct CoreTemplate<x*, int*> { ... }; 
```

对于第一个模板参数是指针类型而第二个模板参数是`int*`.

这比第一个部分特化更特化，当第一个模板参数是指针类型并且第二个模板参数是*除* `int*`.

在您的程序中，两者都`qq1`用作`qq2`第二`int*`个模板参数（显式或使用默认参数），因此两者都选择第二个实例化。

# zend-framework - 在 Zend Framework 中将默认的 .phtml 扩展名更改为 .php？

> ID：11148849
> 
> 赞同：1
> 
> 时间：2012-06-22T00:46:57.423
> 
> 标签：zend-framework

我使用 Microsoft WebMatrix 作为 HTML 编辑器。不幸的是，默认情况下它不能识别 Zend Framework 中使用的 .phtml 文件。如何将项目中所有文件的默认文件扩展名更改为 .php？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T03:46:45.290

放一些类似的东西：

```
$view = new Zend_View();
$viewRenderer = Zend_Controller_Action_HelperBroker::getStaticHelper('viewRenderer');
$viewRenderer->setView($view)
             ->setViewSuffix('php'); 
```

在您的引导程序中。但是必须有一种方法可以告诉您的编辑器使用 phtml，但为了适应编辑器而不得不更改内容，这很可悲。

ps：未在编辑器附近进行测试，但它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T07:49:03.590

Netbeans for php 是一个不错的选择。完全支持 .phtml。自过去 2-3 年以来，我一直在将 netbeans 用于我的 ZF 应用程序。奇迹般有效！！

检查此页面[https://netbeans.org/features/php/](https://netbeans.org/features/php/)

# jquery - 禁用默认箭头键滚动行为以删除 jQuery.scrollTo() 抖动

> ID：11148858
> 
> 赞同：0
> 
> 时间：2012-06-22T00:47:47.157
> 
> 标签：jquery, jquery-plugins, scrollto, smooth-scrolling

我正在尝试使用该`jQuery`插件`.scrollTo()`，以便使用箭头键平滑滚动到网页的特定部分。即当按下时，浏览器将平滑滚动到`div`列表中的下一个`divs`。但是，由于箭头键通常与 Web 浏览器中的滚动功能绑定，因此当按下箭头键触发该功能时会产生**抖动效果。**`.scrollTo()`

看起来，当按下箭头键时，浏览器首先会很快尝试正常滚动而不平滑，然后很快就会通过该`scrollTo()`功能开始平滑滚动。

我通常会想象一个人可能能够简单地`return false`为 keydown 事件`jQuery`以防止发生任何滚动，但这也可以防止`.scrollTo()`被箭头键按下触发。

是否有一种**简单的方法可以在浏览器中禁用默认箭头键触发的滚动行为**，以允许箭头键仅触发`.scrollTo()`事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T01:38:20.320

`.preventDefault()`在触发之前添加`.scrollTo()`通过阻止通常由箭头键触发的默认滚动行为来解决问题。

# optimization - 如何有效地从 CUDA 中的线程收集数据？

> ID：11148860
> 
> 赞同：6
> 
> 时间：2012-06-22T00:47:48.890
> 
> 标签：optimization, cuda, gpu, gpgpu

我有一个在 CUDA 中求解方程组的应用程序，我确信每个线程最多可以找到 4 个解，但是如何将其复制回主机？

我将一个具有足够空间的巨大数组传递给所有线程存储 4 个解决方案（每个解决方案 4 个双倍），另一个具有每个线程的解决方案数量，但是这是一个天真的解决方案，并且是我内核的当前瓶颈。

我真的很喜欢优化这个。主要问题是在单个数组中连接每个线程的可变数量的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T02:01:55.160

您正在寻找的功能称为流压缩。

您可能确实需要提供一个数组，其中每个线程包含 4 个解决方案的空间，因为尝试以紧凑的形式直接存储结果可能会在线程之间创建如此多的依赖关系，以至于能够将更少的数据复制回所获得的性能主机因内核执行时间较长而丢失。例外情况是，如果几乎所有线程都找不到解决方案。在这种情况下，您也许可以使用原子操作来维护数组的索引。因此，对于找到的每个解决方案，您将其存储在索引处的数组中，然后使用原子操作来增加索引。我认为为此使用 atomicAdd() 是安全的。在存储结果之前，线程将使用 atomicAdd() 将索引增加一。atomicAdd() 返回旧值，

但是，考虑到更常见的情况，即有相当数量的结果，最好的解决方案是将压缩操作作为单独的步骤执行。一种方法是使用`thrust::copy_if`. 有关更多背景信息，请参阅[此问题。](https://stackoverflow.com/q/8388125/442006)

# php - 阿贾克斯不刷新

> ID：11148862
> 
> 赞同：0
> 
> 时间：2012-06-22T00:48:07.547
> 
> 标签：php, jquery, html, ajax

我正在尝试设置一个注册框来创建新帐户。我正在尝试通过 ajax 加载 html 表单并将数据传递给 php 文件。

我想让包含表单的 div 每次点击“注册”按钮以从 php 脚本中获取结果并将其显示出来时重新加载。但是，我的代码似乎无法正常工作（处理 ajax 的 div 不会加载表单）。以下是我的代码：

注册.php：

```
<?php

            session_start();
            $email = $_POST['email'];
            $email = mysql_real_escape_string($email);
            $pwd = $_POST['pwd'];
            $repwd = $_POST['repwd'];
            $lname = $_POST['lname'];
            $fname = $_POST['fname'];

            $isValidEmail = 1;
            if (substr_count($email, '@') != 1){
                    $isValidEmail = 0;
            }

            if($pwd != $repwd){ //check if password and re-entered passwords are the same

                $_SESSION['error']      = 1;
                $_SESSION['message']    = 'Password and Re-entered Password are different.';

            } else if( strlen($pwd) < 6 || strlen($pwd) > 64 ) { //check if password is 6 - 64 characters
                $_SESSION['error']    = 1;
                $_SESSION['message']  = 'Password must be 6 - 64 characters.';

            } else if( strlen($email) > 255) { //check if the email is too long

                $_SESSION['error']      = 1;
                $_SESSION['message']    = 'Email exceeded maximum length.';

            } else if ($isValidEmail != 1){

                $_SESSION['error']     = 1;
                $_SESSION['message']   = 'Invalid Email.';

            } else if (ctype_space($lname) || ctype_space($fname)){
               $_SESSION['error']     = 1;
               $_SESSION['message']   = 'Please enter your name.';

            } else {    
                if ($mysqli = new mysqli("localhost", "root", "", "my_db")){

                    $stmt = $mysqli->prepare("SELECT email FROM users WHERE email = ?");
                    $stmt->bind_param('s',$email);
                    $stmt->execute();
                    $stmt->bind_result($result);
                    $stmt->fetch();
                    $stmt->close();

                    if ($result == $email) { //check if the input email exists in the database, duplicated user
                        $_SESSION['error']    = 1;
                        $_SESSION['message']  = 'Email '.$email.' is already used.';

                    } else {  

                        $hash = hash('sha256', $pwd);

                        function createSalt()
                        {
                            $string = md5(uniqid(rand(), true));
                            return substr($string, 0, 3);
                        }

                        $salt = createSalt();
                        $hash = hash('sha256', $salt . $hash);

                        $stmt = $mysqli->prepare("INSERT INTO users ( email, lastName, firstName, password, salt )
                                VALUES ( ? , ?, ?, ? ,? )");
                        $stmt->bind_param('sssss', $email, $lname, $fname, $hash, $salt);
                        if ($stmt->execute()){
                            $_SESSION['message']  = 'Registered.';

                        } else { 
                            $_SESSION['error']   = 1;
                            $_SESSION['message'] = 'Database query error occured.';

                        }
                        $stmt->close();

                    }
                } else {
                    $_SESSION['error']   = 1;
                    $_SESSION['message'] = 'Error connecting to the database.';

                }
            }
            header("Location: Home.php");   
            $mysqli->close();
        ?> 
```

ajax.js：

```
$(document).ready(function() {  

                $('#submit_register').click(function(){
                    $('#register_form').submit( function(){
                        $.ajax({
                            type:       'POST',
                            url :       'Register.php',
                            data:       $('#register_form').serialize(),
                            success:    function () {
                                            var myURL = "Register_form.php#register_div";
                                            $('#ajaxHandle').load(myURL);
                                            return false; 
                                        },
                        });
                    });
                });
}); 
```

注册表格.php：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <?php session_start(); ?>
        <meta charset="utf-8" />
        <title></title>
    </head>
    <body>
        <div class="span-23 prepand-top last" id="register_div" style="background:gray;">
            <div id="wrapper_register" class="span-21 last" style="padding-top: 20px; padding-left:20px; padding-bottom:20px;">
                <form id="register_form" action="register.php" method="post">

                        <legend class="large">Register</legend>
                                <?php

                                    if ($_SESSION['message']){
                                            $class = "";
                                            if ($_SESSION['error']){
                                               $class = "error";
                                            } else {
                                               $class = "success";
                                            }
                                            echo "<div class=\"$class span-4 last\">";
                                            echo $_SESSION['message'];
                                            echo "</div>";

                                            unset ($_SESSION['error']);
                                            unset ($_SESSION['message']); 
                                    }
                                ?>
                        <div class="span-23 prepand-top last">
                        <p>E-mail address: <br>
                        <input type="text" name="email" maxlength="255" /></p><br>
                        <p>Last Name: <br><input type="text" name="lname" maxlength="255" /></p><br>
                        <p>First Name: <br>
                        <input type="text" name="fname" maxlength="255" /></p><br>
                        <p>Password: <br>
                        <input type="password" name="pwd" /><p class="quiet">6 - 64 characters</p><br>
                        <p>Re-enter Password: <br><input type="password" name="repwd" /></p><br>
                        <input id="submit_register" type="submit" value="Register" /><br>
                        </div>

                </form>
            </div>
        </div>
    </body>
</html> 
```

我做错了什么？任何建议将被认真考虑。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T10:29:49.350

我想我想通了。我把刷新的 jquery 代码放在了错误的地方。当我把它放在 .submit 范围内时它起作用了：

```
 $(document).ready(function() {   
        $('#submit_register').click(function(){
            $('#register_form').submit( function(){
                $.post(
                    'Register.php', 
                    $(this).serialize()
                );
                var myURL = "Register_form.php#register_div";
                $('#ajaxHandle').load(myURL);
                return false;
            });
        });
    }); 
```

# objective-c - 如何告诉 iOS 应该打开 Speak Selection

> ID：11148866
> 
> 赞同：0
> 
> 时间：2012-06-22T00:49:11.737
> 
> 标签：objective-c, settings, accessibility, ios5.1

有没有办法告诉iOS应该打开辅助功能Speak Selection？我认为可能有一种类似于定位服务的方式，一旦你开始使用它，iOS 就会要求用户打开它。

我知道 Speak Selection 是以更“被动”的方式使用的，但也许有人知道诀窍，尤其是现在你无法使用“prefs:root ...”打开设置应用程序，因为 iOS 5.1

# php - 远程创建 Google 日历

> ID：11148867
> 
> 赞同：0
> 
> 时间：2012-06-22T00:49:17.797
> 
> 标签：php, google-api, google-calendar-api

过去几周我一直在研究这个问题，但没有成功尝试通过 OAuth1 OR 2 连接到 Google。

我有一个客户需要为他们正在建造的每个房屋提供单独的日历。在数据库中创建新家时，我想创建一个日历并保存创建的日历的 ID。

我有什么选择可以做到这一点？

似乎唯一的方法是将用户重定向到谷歌并登录以添加日历......我想使用静态谷歌帐户并以这种方式简单地创建日历，而不会出现烦人的“登录谷歌”屏幕.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T09:59:33.350

Google api 让您可以使用他们提供的库对日历做任何您需要的事情。我们来看看：[谷歌开发者：实例化谷歌日历](https://developers.google.com/google-apps/calendar/instantiate)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T09:59:02.493

这个 SO 帖子讨论了这一点。特别注意接受的答案中提到添加新日历的过程类似于添加事件的行。

[SO：Google Calendar API 选择和创建日历](https://stackoverflow.com/questions/1534373/google-calendar-api-selecting-creating-calendars)

我还遇到了本教程，它可能对创建日历后的其他操作有所帮助。

[IBM Developer Works：将您的 PHP 应用程序与 Google 日历集成](http://www.ibm.com/developerworks/library/x-googleclndr/)

# r - 如何在 R 中生成具有累积频率和相对频率的频率表

> ID：11148868
> 
> 赞同：34
> 
> 时间：2012-06-22T00:49:30.410
> 
> 标签：r, histogram, frequency, cumulative-frequency

我是 R 新手。我需要生成一个简单的频率表（如书中），其中包含累积频率和相对频率。

所以我想从一些简单的数据中生成，比如

```
> x
[1] 17 17 17 17 17 17 17 17 16 16 16 16 16 18 18 18 10 12 17 17 17 17 17 17 17 17 16 16 16 16 16 18 18 18 10
[36] 12 15 19 20 22 20 19 19 19 
```

像这样的表：

```
 frequency  cumulative   relative
(9.99,11.7]    2            2       0.04545455
(11.7,13.4]    2            4       0.04545455
(13.4,15.1]    1            5       0.02272727
(15.1,16.9]   10           15       0.22727273
(16.9,18.6]   22           37       0.50000000
(18.6,20.3]    6           43       0.13636364
(20.3,22]      1           44       0.02272727 
```

我知道它应该很简单，但我不知道如何。

我使用这段代码得到了一些结果：

```
factorx <- factor(cut(x, breaks=nclass.Sturges(x)))
as.matrix(table(factorx)) 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-22T01:07:06.640

你很近！有一些功能可以让您轻松完成此操作，即`cumsum()`和`prop.table()`。这就是我可能把它放在一起的方式。我做了一些随机数据，但要点是一样的：

```
#Fake data
x <- sample(10:20, 44, TRUE)
#Your code
factorx <- factor(cut(x, breaks=nclass.Sturges(x)))
#Tabulate and turn into data.frame
xout <- as.data.frame(table(factorx))
#Add cumFreq and proportions
xout <- transform(xout, cumFreq = cumsum(Freq), relative = prop.table(Freq))
#-----
      factorx Freq cumFreq   relative
1 (9.99,11.4]   11      11 0.25000000
2 (11.4,12.9]    3      14 0.06818182
3 (12.9,14.3]   11      25 0.25000000
4 (14.3,15.7]    2      27 0.04545455
5 (15.7,17.1]    6      33 0.13636364
6 (17.1,18.6]    3      36 0.06818182
7   (18.6,20]    8      44 0.18181818 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-06-22T01:44:14.763

基本功能`table`，`cumsum`应该`prop.table`可以帮助您：

```
 cbind( Freq=table(x), Cumul=cumsum(table(x)), relative=prop.table(table(x)))
   Freq Cumul   relative
10    2     2 0.04545455
12    2     4 0.04545455
15    1     5 0.02272727
16   10    15 0.22727273
17   16    31 0.36363636
18    6    37 0.13636364
19    4    41 0.09090909
20    2    43 0.04545455
22    1    44 0.02272727 
```

使用 cbind 并根据您的喜好命名列，这对您将来来说应该很容易。表函数的输出是一个矩阵，所以这个结果也是一个矩阵。如果这是在某件大事上完成的，这样做会更有效率：

```
tbl <- table(x)
cbind( Freq=tbl, Cumul=cumsum(tbl), relative=prop.table(tbl)) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-06-22T02:20:28.397

如果您正在寻找预先包装好的东西，请考虑包装中的`freq()`功能`descr`。

```
library(descr)
x = c(sample(10:20, 44, TRUE))
freq(x, plot = FALSE) 
```

或者要获得累积百分比，请使用`ordered()`函数

```
freq(ordered(x), plot = FALSE) 
```

添加“累积频率”列：

```
tab = as.data.frame(freq(ordered(x), plot = FALSE))
CumFreq = cumsum(tab[-dim(tab)[1],]$Frequency)
tab$CumFreq = c(CumFreq, NA)
tab 
```

如果您的数据有缺失值，则会将有效百分比列添加到表中。

```
x = c(sample(10:20, 44, TRUE), NA, NA)
freq(ordered(x), plot = FALSE) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-15T02:38:47.040

还有一种可能：

```
 library(SciencesPo)
    x = c(sample(10:20, 50, TRUE))
    freq(x) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-10-15T15:56:11.010

我的建议是检查*agricolae*包...检查一下：

```
library(agricolae)

weight<-c( 68, 53, 69.5, 55, 71, 63, 76.5, 65.5, 69, 75, 76, 57, 70.5,
+ 71.5, 56, 81.5, 69, 59, 67.5, 61, 68, 59.5, 56.5, 73,
+ 61, 72.5, 71.5, 59.5, 74.5, 63)

h1<- graph.freq(weight,col="yellow",frequency=1,las=2,xlab="h1")

print(summary(h1),row.names=FALSE) 
```

# python - Pygame / python鼠标按钮按下问题

> ID：11148872
> 
> 赞同：-2
> 
> 时间：2012-06-22T00:50:24.337
> 
> 标签：python, mouseevent, pygame, mouseclick-event, mouse-coordinates

我试图通过检查鼠标是否与对象 rect 碰撞并检查鼠标按钮是否按下来移动对象。

这是我的代码：

```
class Unit(pygame.sprite.Sprite):
    def __init__(self, display,):
    pygame.sprite.Sprite.__init__(self,)

    self.master_image = pygame.Surface((50, 100))
    self.master_image.fill((000,255,000))
    self.image = self.master_image
    self.rect = self.image.get_rect()
    self.rect.centerx = 500
    self.rect.centery = 500

def move(self):
    mouse = pygame.Surface((5, 5))
    mouse_rect = mouse.get_rect()
    (mouseX, mouseY) = pygame.mouse.get_pos()
    mouse_rect.centerx = mouseX
    mouse_rect.centery = mouseY

    for event in pygame.event.get():
        if event.type == pygame.MOUSEBUTTONDOWN:
            if mouse_rect.colliderect(self.rect):
                self.rect.centerx = mouseX
                self.rect.centery = mouseY
                print "move"

def update(self,):
    self.move() 
```

这可行，但我必须向鼠标上的每个按钮发送垃圾邮件，最终 pygame 将拾取鼠标事件，并且对象将按预期移动，但仅在一瞬间然后它就会停止。

我的目标只是单击鼠标上的按钮，如果鼠标与框碰撞，则框将在鼠标按钮按下鼠标 x 和 y 时移动。

我希望我很清楚。

谢谢你的帮助

和平！

这是我如何让它工作的：

```
#unit sprite class
class Unit(pygame.sprite.Sprite):
   def __init__(self, display,):
      pygame.sprite.Sprite.__init__(self,)

      self.master_image = pygame.Surface((50, 100))
      self.master_image.fill((000,255,000))
      self.image = self.master_image
      self.rect = self.image.get_rect()
      self.rect.centerx = 500
      self.rect.centery = 500

      #mouse stuff
      self.mouse = pygame.Surface((5, 5))
      self.mouse_rect = self.mouse.get_rect()
      (self.mouse_rect.centerx , self.mouse_rect.centery) = pygame.mouse.get_pos()

  def move(self):
      if pygame.MOUSEBUTTONDOWN:#check for mouse button down
          (button1, button2, button3,) = pygame.mouse.get_pressed()#get button pressed

          if button1 and self.mouse_rect.colliderect(self.rect):#check for collision between object and mouse
              (self.rect.centerx, self.rect.centery) = pygame.mouse.get_pos()#set object POS to mouse POS

  def update(self,):
      (self.mouse_rect.centerx , self.mouse_rect.centery) = pygame.mouse.get_pos()#update mouse RECT
      self.move()#check movement 
```

谢谢您的帮助！

和平！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:59:19.280

当它第一次被按下时你会得到一个 MOUSEBUTTONDOWN 事件，但当它被按下时不会。要确定用户何时停止按下它，您需要检查 MOUSEBUTTONUP 事件。

或者，您可以使用 pygame.mouse.get_pressed() 来查询鼠标按钮的当前状态。鼠标功能文档在[这里](http://www.pygame.org/docs/ref/mouse.html)。

# rhomobile - Rhomobile 的启动控制器？

> ID：11148874
> 
> 赞同：1
> 
> 时间：2012-06-22T00:50:36.503
> 
> 标签：rhomobile, rhodes

我的 Rhodes 移动应用程序的起点是什么，我的理解是 Rhodes 是一个基于 MVC 的框架，让我们假设当我启动应用程序时，我需要先进行一些验证，然后再决定要显示哪个视图，例如，如果用户是管理员，那么我将需要显示管理员视图。

我找不到主控制器来做这样的事情，我只能看到 index.erb，但我试图找到的是主控制器来决定我是否要使用 index.erb 或任何其他观点。

我确信必须有解决办法来做到这一点，请注意我对 Rhomobile 很陌生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T09:07:42.857

请检查如何使用 rhoconfig.txt 以便您可以设置应用程序启动时要调用的控制器。

[http://docs.rhomobile.com/rhodes/configuration#run-time-configuration](http://docs.rhomobile.com/rhodes/configuration#run-time-configuration)

然后，您可以编写自己的逻辑来处理用户。

您还可以指向 app/Settings/login 以便您可以处理 do_login 方法中的逻辑

# opencv - 从与 Kinect 和 OpenCV 的对应关系中查找平移/旋转参数

> ID：11148875
> 
> 赞同：1
> 
> 时间：2012-06-22T00:50:41.930
> 
> 标签：opencv, rotation, translation, kinect, correspondence

假设我有一个对象，我从一个角度的 kinect 获得了 RGB 数据和深度数据。然后我稍微移动了 kinect，这样我就可以从不同的角度拍摄第二张物体的照片。我试图找出最好的方法来确定 kinect 相机根据两个图像的对应关系从其原始位置平移和旋转了多少。

我将 OpenCV 用于某些图像处理任务，并且研究了 SURF 算法，该算法似乎从两个 2D 图像中找到了很好的对应关系。但是它没有考虑深度数据，而且我认为它对多张图片效果不佳。另外，我不知道如何从通信中获取翻译/旋转数据。也许我看错了方向？

注意：我的长期目标是“合并”多个图像以从所有数据中形成 3D 模型。目前，如果我指定 kinect 所在的角度，它有些工作，但我认为通过查找对应关系而不是手动指定参数来减少所涉及的“错误”（即点从它们应该在的位置略微偏移）要好得多

# php - 什么算法用于此？

> ID：11148876
> 
> 赞同：3
> 
> 时间：2012-06-22T00:50:41.970
> 
> 标签：php, vb.net, algorithm

我正在为游戏文本扭曲做研究项目，文本将自动从字典中搜索单词并打乱，并使用与此站点[http://grecni.com/texttwist 相同的概念处理要自动找到的单词。 php](http://grecni.com/texttwist.php)，我还需要提供一个算法，我将用于我的项目，我计划在这个网站[http://grecni.com/texttwist.php](http://grecni.com/texttwist.php)中包含这个词 unscrambler但我不知道什么算法可能用于在我发布的网站上执行操作。有没有人知道使用什么类型，或者你所说的算法，或者可以使用会给出相同结果的算法，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:06:59.917

您想要的数据结构称为有向无[环字图（dawg）](http://en.wikipedia.org/wiki/Directed_acyclic_word_graph)

关于这个问题已经回答了：

[获取所有子串（拼字游戏）的字谜的所有单词列表的算法？](https://stackoverflow.com/questions/880559/algorithm-to-get-a-list-of-all-words-that-are-anagrams-of-all-substrings-scrabb)

[写一个拼字游戏的算法](https://stackoverflow.com/questions/2497986/writing-an-algorithm-for-scrabble)

您也许还可以实现[levenshtein 算法](http://en.wikipedia.org/wiki/Levenshtein_distance)，该算法将完成几乎相同的结果： [MySQL - 我应该为此使用哪个哈希算法？](https://stackoverflow.com/questions/10803864/mysql-which-hash-algo-should-i-use-for-this/10804695#10804695)

## 更新：

在给自己一个挑战来创建一个示例来演示我想出的算法之后，因为它来自为我的 cms 构建的插件，它包含在一个类中，但你知道有一个演示 @ [http://cherone.co .uk/scrabble_suggest](http://cherone.co.uk/scrabble_suggest)

首先，我创建了一个带有 id、word、sorted 的表（word = 实际单词，sorted = 单词按字母顺序排序，例如：aardvark sorted will be aaadkrrv）我刚刚在互联网上找到了一个英文单词表。

表单发布字符串，然后按字母顺序对字符串进行排序，以 1:1 匹配已排序的列，然后将字符串拆分为每个字符，然后按顺序查询直到最后一个字符。感兴趣的功能`str_sort,permute,swap`可能是它的一些兴趣..

```
<?php 
/**
 * Scrabble solver Plugin this file is "inline" included within the frontController class
 */
Class plugin{

    function __construct($core) {
        $this->core = $core;
        $this->plugin_path = SITE_ROOT.'/core/plugins/'.$this->core->router->action.'/';
        $this->request = explode('/',$this->core->router->request);
        //Assign Page meta tags ect
        $this->core->template->meta_keywords    = 'Text,Twist,Text Twist,word,letter,scrabble,unscrambler,unscramble,word finder,puzzle,anagram,scrabble,cheat,cheater,help,helper,solve,solver,free,php';
        $this->core->template->meta_description = 'Scrabble and Anagram like word solver tool to help unscramble letters and words and cheat at your favorite word puzzle';
        $this->core->template->page_title       = $this->core->template->site_name." - Scrabble and Anagram like word solver";
        $route = (isset($this->request[2])?$this->request[2]:null);
    }

    function load(){
        set_time_limit(0);
        $data=array('var'=>$this,'result'=>'','word'=>'','word_sort'=>'');

        switch($this->core->router->subaction){
            case "index":
                $string='';
                if($_SERVER['REQUEST_METHOD']=='POST'){
                    $string = substr(preg_replace('/[^a-zA-Z]/s', '', trim(strtolower($_POST['letters']))),0,8);
                    $data['word'] = $string;
                    $string = $this->str_sort($string);
                    $data['word_sort'] = $string;
                }
                $stringLen = strlen($string);

                $result = array();
                for($i=2;$i<=$stringLen;$i++){
                    $seq = substr($data['word_sort'],0,$i);

                    $rounds = explode('|',$this->permute($seq,0,strlen($seq)));
                    $r=$i;
                    foreach($rounds as $round){
                        $result[$r] = $this->get_words($round,strlen($seq));
                        $r++;
                    }
                }

                $data['result'] = $result;

                $this->core->template->content_center = $this->core->template->loadContentView(get_class(),$this->core->router->subaction,$data);
                $this->core->template->content_left   = '';
                $this->core->template->content_right  = '';
                break;

            case "update":
                $this->insert_word_lists();
                header('Location: '.SITE_URL.'/'.$this->core->router->action);
                die;
                break;

            case "api":
                header('Content-Type: application/json');
                echo 'No api for this plugin, perhaps one comming soon. ;p';
                break;

            default:
                header('Location: '.SITE_URL.'/'.$this->core->router->action);
                die;
                break;
        }
    }

    //Query Method to search for sequenced alphabetically sorted words.
    private function get_words($word,$stringLen){
        $chars = str_split($word,1);
        $sql = "SELECT DISTINCT `word` FROM `plugin_scrabble_words` WHERE ";
        foreach($chars as $char){
            $sql .=' `sorted` LIKE "%'.$char.'%" AND';
        }
        $sql = trim($sql,'AND');
        $sql .= ' AND LENGTH(sorted) = '.$stringLen;

        $statement = $this->core->db->prepare($sql);
        $statement->execute();

        $result = $statement->fetchAll(PDO::FETCH_ASSOC);

        return $result;
    }

    //A Model method for updating the database word list.
    private function insert_word_lists(){
        set_time_limit(0);
        $lists = glob($this->plugin_path."wordlists/*.txt");
        foreach ($lists as $list){
            $words = file($list);
            foreach($words as $word){
                $word = strtolower(preg_replace('/[^a-zA-Z]/s', '', $word));
                if($this->sql_check_word($word)===false){
                    $this->sql_put_word($word);
                }
            }
        }
    }

    //A Model method for checking the database specific word.
    private function sql_check_word($word){
        $sql = "SELECT `word` FROM `plugin_scrabble_words` WHERE `word` = :word";
        $statement = $this->core->db->prepare($sql);
        $statement->bindParam(':word', $word, PDO::PARAM_STR);
        $statement->execute();
        $result = $statement->fetchAll(PDO::FETCH_ASSOC);

        if(!empty($result)){
            return true;
        }else{
            return false;
        }
    }

    //A Model method for adding the word to the database.
    private function sql_put_word($word){
        $sql = "INSERT into `plugin_scrabble_words` (word,sorted) VALUES (:word,:sorted)";
        $statement = $this->core->db->prepare($sql);
        $sorted = $this->str_sort($word);
        $statement->bindParam(':word', $word, PDO::PARAM_STR);
        $statement->bindParam(':sorted', $sorted, PDO::PARAM_STR);
        $statement->execute();
    }

    //Sort Method that will sort a sring in alphabetical order
    private function str_sort($string) {
        $tmp = str_split($string);
        sort($tmp);
        return implode('',$tmp);
    }

    //Method to generate and return all permutations of the string with | delimiter.
    private function permute($str,$i,$n) {
        if ($i == $n){
            return $str.'|';
        } else {
            for ($j = $i; $j < $n; $j++) {
                $this->swap($str,$i,$j);
                $this->permute($str, $i+1, $n);
                $this->swap($str,$i,$j);
            }
        }
    }

    //Method to swap the char at pos $i and $j of $str.
    private function swap(&$str,$i,$j) {
        $temp = $str[$i];
        $str[$i] = $str[$j];
        $str[$j] = $temp;
    }
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T01:06:16.550

一种方法是生成所有可能的字母排列并将它们与字典进行匹配。对于`N`字母字符序列，`O(N!)`如果您将字典保存在集合数据结构中，这将需要时间。

对于较短的序列（大约 10 个字符），这是一个非常好的策略。

对于更长的序列，你应该做相反的事情。您可以遍历字典并确定您的字符序列是否具有组成单词的字符。对于`M`字典元素，这将花费或多或少的`O(M)`时间。有多种方法可以加速这种技术，例如预先计算每个字典条目中每个字母的数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T01:07:35.817

编辑：我下面的那位先生对这个主题给出了更严格和更彻底的算法处理，所以我会引导你去他的解释（它采用了我的大 O 符号......令人尴尬地没有）。

实际上，尽管 VanDang 称其为“幼稚方法”，但测试给定的有限字符集的所有可能组合并没有错。只要阻止一个人提供任意数量的字符，就最多有 !n 个字母组合（其中 n = 字母的数量，假设没有重复），并且由于英语单词不得到那么长，测试每个组合不会那么糟糕。

毕竟，穷举法实际上是一种在生成硬件描述时优化大型布尔表达式的公认方法。

# javascript - javascript数组为空

> ID：11148877
> 
> 赞同：1
> 
> 时间：2012-06-22T00:50:47.857
> 
> 标签：javascript, jquery

我有以下代码。我不确定为什么 myData 数组在 console.log 中为空，因为 inputValue 和 inputName 不为空，我可以在日志中看到它们

```
var myData = new Array();

        $("#myelement :input").each(function(){

             var inputValue = $(this).val();             
            var inputName = $(this).attr('id');
             console.log(inputValue, inputName);
             myData.push=inputName;
             myData.push=inputValue;
             console.log(myData);
        }); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-22T00:52:55.250

这是不对的：

```
myData.push=inputName;
myData.push=inputValue 
```

基本上，您将`push`数组的属性设置为一个值。但是`push`数组的属性已经设置了一些东西，即向数组添加项目的函数。

您想改为调用该`push`方法，而不是替换它：

```
myData.push(inputName);
myData.push(inputValue); 
```

# delphi - Delphi 7 QuickReport 预览错误

> ID：11148878
> 
> 赞同：0
> 
> 时间：2012-06-22T00:51:07.290
> 
> 标签：delphi, delphi-7

我正在使用 Delphi7 和 QuickReport 3。我是 Delphi 和 QuickReport 的新手。

当我调试我的应用程序时，我在 TQRPreview.UpdateZoom 过程中遇到错误；

```
if assigned(FQRPrinter) 
```

例外是访问冲突

在我的表格中，我正在调用 QuickRep.Prepare 和 QuickRep.Preview。

当我调用 QuickRep.Preview 时，我收到了错误消息。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-11T09:02:18.813

当您使用该 QReport 创建某个表单时，请仔细检查您的代码。您在不再需要它后将其释放。

`Application.Processmessages;`其次，在完成任何打印后尝试添加。

# javascript - Javascript\jQuery：是否可以使用 x 和 y 坐标覆盖元素？

> ID：11148879
> 
> 赞同：1
> 
> 时间：2012-06-22T00:51:11.837
> 
> 标签：javascript, jquery, html, css, coordinates

通过搜索，找到父元素然后添加到它们，而不是绝对定位（我必须这样做，不要问为什么）元素在其他元素上，是否可以通过坐标找到某些元素的位置，然后简单地调整窗口大小时重新计算替换的坐标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:03:15.340

你可以通过减去你的利润来做到这一点。

如果要将子项附加到已包含子项的容器中，只需从新子项的边距中减去与现有子项相同的高度。

注意下面的 margin-top:-100px

```
 <div id="parentContainer" style="width:100px;height:100px;float:left">

        <div id="child1" style="width:100px;height:100px;float:left;background-color:red">

        </div>

        <div id="child2" style="width:100px;height:100px;float:left;background-color:blue;
                                margin-top:-100px">
        </div>

  </div> 
```

如果你预先做一个 margin-bottom:-100px

# c++ - OSX10.7.4 中的 C++ 未定义符号错误

> ID：11148880
> 
> 赞同：0
> 
> 时间：2012-06-22T00:51:15.970
> 
> 标签：c++, macos, linker, clang

来自命令行的以下调用`clang++ vcfaltcount.cpp -o vcfac`，产生以下错误/警告

```
>In file included from vcfaltcount.cpp:1:
./Variant.h:86:5: warning: control may reach end of non-void function [-Wreturn-type]
}

>Undefined symbols for architecture x86_64:
  "split(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&,                    std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)", referenced           from:
  _main in ccGOdUhH.o
  vcf::VariantCallFile::open(std::basic_string<char, std::char_traits<char>,     std::allocator<char> >&)in ccGOdUhH.o
 "vcf::VariantCallFile::getNextVariant(vcf::Variant&)", referenced from:
  _main in ccGOdUhH.o
  "vcf::VariantCallFile::parseHeader()", referenced from:
  vcf::VariantCallFile::openFile(std::basic_string<char, std::char_traits<char>,       std::allocator<char> >&)in ccGOdUhH.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

还有许多其他关于“此类架构的未定义符号”的帖子，我试图使用这些建议来成功编译。

我认为问题可能来自头文件variant.h。在提供源代码的 API 中，有一个对应的 variant.cpp 文件定义了函数，这些函数仅在 variant.h 中声明。我将这些定义移到了 variant.h 中。关于我可能遗漏的任何想法？如果需要，我可以提供标题，但它很长。谢谢。

# node.js - 连接到 node.js socket.io 服务器：客户端不连接 - 服务器报告“破坏非 socket.io 升级”

> ID：11148882
> 
> 赞同：1
> 
> 时间：2012-06-22T00:51:40.587
> 
> 标签：node.js, socket.io

我认为 socket.io 可以让我实现一个 websocket 服务器。我有这个非常简单的代码：

```
// Require HTTP module (to start server) and Socket.IO
var http = require('http'), io = require('socket.io');

// start at port 8888
var server = http.createServer(function(req, res) {
    res.writeHead(200,{'Content-Type': 'text\html'});
    res.end('<h1>Welcome to the Notification Server</h1>'); 
});
server.listen(8888);

// Create Socket.io obj/pass to server
var socket = io.listen(server);

socket.on('connection', function(client) {
    console.log('Successful Websocket connection!');

    client.on('message', function(event) {
        console.log("Received message from client", event);     
    });

    client.on('disconnect', function() {
        console.log('Client has disconnected');
    });
}); 
```

我尝试了几个不同的测试客户端，所有这些客户端都在服务器上生成此消息： **debug - destroying non-socket.io upgrade**

一个这样的客户端尝试有一些这样的代码：

```
<html>
<script type="text/javascript">
<!---
window.WebSocket = window.WebSocket || window.MozWebSocket;

var ws = new WebSocket("ws://dev.ourserver.com:8888");

ws.onopen = function() {
    alert("Connected");
}

ws.onerror = function(error) {
    alert("Error:"+error);
}

// -->
</script>
<body>
</body>
</html> 
```

一旦我们加载页面，我就会在服务器上收到调试消息。

我认为这个库的重点是支持 websocket 协议，任何支持 websockets 的客户端都可以连接。

如果我从字面上解释该消息，它似乎表明 server.io 已检测到它正在连接到“非 socket.io”客户端。这是否意味着我无法在客户端不使用 socket.io 的情况下连接到该服务器？

# java - Janino ExpressionEvaluator 没有猜测所有参数？

> ID：11148888
> 
> 赞同：3
> 
> 时间：2012-06-22T00:52:11.470
> 
> 标签：java, dynamic, expression-evaluation, janino

考虑库的`ExpressionEvaluator`类的一个简单用例`Janino`，即当使用它来猜测表达式的参数时，如下所示：

```
public static String[] getParameters(String expression) { // Suppress exceptions
    try {
        return ExpressionEvaluator.guessParameterNames(
                new Scanner(null, new StringReader(expression)));
    } catch (Exception e) {
    }

    return null;
} 
```

虽然以上对于我使用过的任何类型的表达式（包括一些非常晦涩的表达式）都非常有效（100%），但如果任何参数以大写字母开头，则将其省略。

例如，表达式

```
aVar + Another 
```

`aVar`如果传递给上述方法，将只产生 1 个参数 ( )，而`Another`忽略另一个参数 ( )。

对这种行为有什么解释（例如，以大写字母开头的变量是否假定为类名）？

最重要的是，是否可以绕过所描述的行为（例如，通过某些配置选项）？

* * *

## **更新**

显然，限制更普遍，影响所有以大写字母开头的参数。这是一个已知的 Janino 限制（或功能），如[JANINO-151](http://jira.codehaus.org/browse/JANINO-151)中所述并在[相关讨论](https://groups.google.com/forum/?fromgroups#!topic/cascading-user/ZDAXd6BcXwg)中提到。

[事实上， Janino ExpressionEvaluator 类](http://svn.codehaus.org/janino/trunk/janino/src/org/codehaus/janino/ExpressionEvaluator.java)`guessParameterNames()`的方法的源代码证实了这一点。

# java - 如何打印斯坦福 JavaNLP 的解析树

> ID：11148890
> 
> 赞同：0
> 
> 时间：2012-06-22T00:52:34.550
> 
> 标签：java, nlp, stanford-nlp

我正在尝试使用该`edu.stanford.nlp.*`包获取所有名词短语。我得到了标签值“NP”的所有子树，但我无法获得正常的原始`String`格式（不是 Penn 树格式）。

例如，`subtree.toString()`给予，`(NP (ND all)(NSS times)))`但我想要字符串“所有时间”。谁能帮帮我吗。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T02:33:18.547

我相信你想要的是这样的：

```
final StringBuilder sb = new StringBuilder();

for ( final Tree t : tree.getLeaves() ) {
     sb.append(t.toString()).append(" ");
} 
```

虽然我不能 100% 确定，但我似乎记得这是我几年前工作的某些软件所使用的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-14T19:32:37.253

这可以使用子树的 yield() 方法来完成，而不是创建单独的 StringBuilder objext。

```
if (subtree.label().value().equals("NP")) {
    out.println(subtree);       //print subtree
    out.println(Sentence.listToString(subtree.yield()));    //print phrase  
    break;
} 
```

# html - 是否可以在使用 GET 的表单中隐藏输入？

> ID：11148891
> 
> 赞同：1
> 
> 时间：2012-06-22T00:52:55.100
> 
> 标签：html, forms, input, hidden

是否有可能做到这一点？

```
<form action="/process_form" method="get">
<input type="hidden" name="some_value" value="top_secret" />' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T00:53:57.813

当然可以，但是在提交表单时，该值将在您请求的 URL 中可见。我希望你的价值实际上不是最高机密。实际上，该值在任何情况下对客户端都是可见的，因此最好不要保密。

# ruby - TypeError：无法将路径名转换为字符串

> ID：11148893
> 
> 赞同：1
> 
> 时间：2012-06-22T00:53:17.813
> 
> 标签：ruby, sinatra

`TypeError: can't convert Pathname to String`在应用程序中需要 r18n 文件后，我得到了。

我的应用程序.rb

```
require 'sinatra/r18n' 
```

这是我的 Gemfile：

```
gem 'sinatra-r18n' 
```

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T08:03:08.127

更新 sinatra-r18n，这是老问题。

# haskell - Haskell前奏曲，如何：编辑后自动加载？

> ID：11148896
> 
> 赞同：2
> 
> 时间：2012-06-22T00:53:42.100
> 
> 标签：haskell

在前奏曲中，

```
> :load foo.hs
> -- before edit 
> :edit foo.hs
... Edit and save file
> -- But before edit
> :load foo.hs
> -- Then after edit 
```

编辑后如何自动加载并保存？或者这是不好的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T01:23:48.443

升级到 GHC 7.4.2，在编辑后自动重新加载 ( [Trac #5343](http://hackage.haskell.org/trac/ghc/ticket/5343) )。

顺便说一句：您可以使用`:r`.

# javascript - Rally SDK 2 tagpicker 是否有必填字段？对象没有方法“getContextPath”

> ID：11148898
> 
> 赞同：1
> 
> 时间：2012-06-22T00:54:09.313
> 
> 标签：javascript, rally

在 Rally SDK 2 中，我制作了一个标签选择器，然后将其添加到容器中。它呈现正常，但是当用户点击下拉箭头时，控制台报告错误（Uncaught TypeError: Object # has no method 'getContextPath'）并且标签选择器不允许用户选择标签（每隔一次，但是，它们已列出）。

```
 this.tag_picker = Ext.create('Rally.ui.picker.TagPicker', {
            width: 275,
            fieldLabel: "Tags: ",
            allowBlank: true,
            minHeight: 100,
            autoExpand: true
        });
        this.down('#big_box').add( this.tag_picker ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T19:33:19.530

查询首选项键以确定是否应显示工具提示并尝试使用 Rally.getContextPath() 构建请求 URL 时存在错误。作为一种解决方法，您可以将 toolTipPreferenceKey 设置为 undefined (toolTipPreferenceKey: undefined) 以避免看到此错误。

# sql-server - 本地 SQL Server 到托管服务器的复制建议

> ID：11148902
> 
> 赞同：1
> 
> 时间：2012-06-22T00:54:40.757
> 
> 标签：sql-server, hosting, replication, odata

我们即将将旧版 MS Access 应用程序迁移到 SQL Server，以用于我们的内部仓库管理系统。我们的客户经常要求我们访问数据以进行电子商务集成和一般报告。迁移完成后，我想通过 Web 服务和 odata 提供对数据的开放访问。但是我不想托管这些服务，因为我们的 ADSL 连接速度较慢，无法应对流量。

我的问题是，我可以复制（单向）到由 Hostgator 等共享托管公司托管的远程数据库吗？我看到他们已经与无限的 MS SQL 数据库共享 Windows 托管。托管端有什么特殊要求吗？例如，我是否需要在托管数据库上显式设置复制，还是在客户端进行管理？

如果这是可能的，那么我可能能够在主机的服务器上运行我们所有的 Web 服务和报告应用程序，并且只有复制的数据需要通过 WAN 传输。对复制有什么样的控制？例如带宽限制、复制周期等？例如，复制发生的时间和频率是多少？

总的来说，我是 SQL Server 的新手，其中一些主题有点让人不知所措。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T02:31:10.427

您可以尝试通过与您身边的分销商一起[推送订阅](http://msdn.microsoft.com/en-us/library/ms152566.aspx)来设置事务复制。相关位是分发代理如何连接到订户。distrib.exe 支持受信任和 SQL 身份验证，因此无论哪种方式都可以。

# python - 在python中格式化日期戳

> ID：11148903
> 
> 赞同：1
> 
> 时间：2012-06-22T00:54:42.850
> 
> 标签：python, datetime, date, format, timestamp

在 python 中使用`import datetime`，是否可以采用格式化的时间/日期字符串，例如：

```
2012-06-21 20:36:11 
```

并将其转换为一个对象，然后我可以使用该对象来生成一个新格式化的字符串，例如：

```
21st June 2012 20:36 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T01:00:26.770

```
import time

s = '2012-06-21 20:36:11'

t = time.strptime(s, '%Y-%m-%d %H:%M:%S')
print time.strftime('%d %B %Y %H:%M', t) 
```

返回

```
21 June 2012 20:36 
```

* * *

如果你真的想要'st'，

```
def nth(n):
    return str(n) + nth.ext[int(n)%10]
nth.ext = ['th', 'st', 'nd', 'rd'] + ['th']*6

print nth(t.tm_mday) + time.strftime(' %B %Y %H:%M', t) 
```

得到你

```
21st June 2012 20:36 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T00:56:35.503

您想要`datetime.strptime`，它将文本解析为日期时间：

```
>>> d = "2012-06-21 20:36:11"
>>> datetime.datetime.strptime(d, "%Y-%m-%d %H:%M:%S")
datetime.datetime(2012, 6, 21, 20, 36, 11) 
```

以您想要的方式格式化日期几乎是可行的：

```
>>> datetime.datetime.strftime(t, "%d %B %Y %H:%m")
'21 June 2012 20:06' 
```

# asp.net-mvc-3 - mvc 3：多个查询

> ID：11148908
> 
> 赞同：0
> 
> 时间：2012-06-22T00:56:22.363
> 
> 标签：asp.net-mvc-3

关于答案[MVC 3: Passing multiple queries to a view](https://stackoverflow.com/questions/5824264/mvc-3-passing-multiple-queries-to-a-view)我意识到这种方式可以保持 mysql 服务器连接打开。

我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T02:54:20.347

这不会使您的连接保持打开状态。完成后处理你的上下文。*调用 .ToList() 会在那时*强制执行查询，因此上下文将管理连接的生命周期，因此只需在调用 .ToList() 后在控制器中完成时将其处理掉，就像两个查询一样

# javascript - 如何从快速呈现的 ejs 网页调用 node.js 函数

> ID：11148912
> 
> 赞同：0
> 
> 时间：2012-06-22T00:57:01.960
> 
> 标签：javascript, ajax, node.js, webserver, express

我有一个快速服务器，它有一个按钮，它发出一个 POST，它激活我的 node.js 服务器中的一个功能。

我不想发送帖子，而是想做类似 AJAX 的事情，因为我不想加载新页面。如果我使用 Javascript 按钮，有没有办法可以直接调用 node.js 服务器中定义的函数，而不必发送帖子？

我注意到 JSON 值可以在呈现时传递到 .ejs 网页，但我无法让它用于函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:03:26.440

您可以使用 Socket.io 从浏览器发出事件，然后在服务器上侦听该事件以对其进行操作。

Socket.io 与 express [http://socket.io/#how-to-use完美配合](http://socket.io/#how-to-use)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T01:04:06.040

看看[nowjs](http://nowjs.com/)。它使您可以非常轻松地从客户端调用服务器上的函数，反之亦然：

从网站：

> *   NowJS 创建了一个神奇的命名空间“now”，服务器和客户端都可以访问
> *   现在添加的函数和变量会实时自动同步
> *   从服务器调用客户端函数，从客户端调用服务器函数

# mef - MEF 是服务定位器吗？

> ID：11148913
> 
> 赞同：0
> 
> 时间：2012-06-22T00:57:11.520
> 
> 标签：mef, anti-patterns, service-locator

我正在尝试使用 Caliburn Micro 和 nHibernate 为新的 LOB MVVM 项目设计架构，现在正在研究 DI 和 IOC。

许多引导 Caliburn Micro 的示例使用 MEF 作为 DI\IOC 机制。

我正在苦苦挣扎的是，MEF 似乎相当受欢迎，但 Mef [Imports] 注释的想法在我看来就像是另一种服务定位器？

我是否遗漏了有关 MEF 的某些内容，几乎所有我见过的示例都没有正确使用它，或者我完全不了解它的使用方式，从而绕过了整个服务定位器问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T01:16:30.247

MEF 本身不是服务定位器。它可以用来实现服务定位器（ Silverlight 版本中的[CompositionInitializer](http://msdn.microsoft.com/en-us/library/system.componentmodel.composition.compositioninitializer%28v=vs.95%29.aspx)实际上是 MEF 中内置的服务定位器），但它也可以直接进行依赖注入。

虽然这些属性可能对您有“味道”，但它们本身并不会导致它成为服务定位器，因为您可以`[ImportingConstructor]`在创建时使用它来注入数据。

请注意，这些属性实际上并不是使用 MEF 的唯一方法——它也可以通过[直接注册](http://mindinthewater.blogspot.com/2011/03/mef-attribute-less-registration.html)或[基于约定的注册](http://blogs.msdn.com/b/bclteam/archive/2011/11/01/getting-started-with-convention-based-part-registration-in-mef-version-2.aspx)来工作（CodePlex drop 和 .NET 4.5 支持）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T01:24:01.043

我想如果您只`new`使用具有属性导入的部分并尝试使用它们，那么您可能会遇到此处描述的一些相同问题：[Service Locator is an Anti-Pattern](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)

但在实践中，您从容器中获取零件，如果您在`[Import]`没有附加`allowDefault`属性的情况下使用，那么该零件是必需的，如果您要求进行导入的零件，容器会炸毁您。它会在运行时爆炸，是的，但与磨房服务定位器的运行不同，使用测试框架对 MEF 容器进行静态分析相当简单。[我已经在这里](http://ihadthisideaonce.wordpress.com/2012/01/31/stop-guessing-about-mef-composition-and-start-testing/)和[这里](http://ihadthisideaonce.wordpress.com/2012/06/12/mef-composition-tests-redux/)写过几次了。

在实践中这对我来说不是问题，原因有几个：

1.  我从容器中取出零件。
2.  我使用作文测试。
3.  我正在编写应用程序，而不是框架代码。

# c# - C#需要关于实现对象之间拖放的想法

> ID：11148921
> 
> 赞同：0
> 
> 时间：2012-06-22T00:58:15.060
> 
> 标签：c#, winforms, drag-and-drop, richtextbox

我有一个表单，其中有一个 RichTextBox 停靠在左侧，DataGridView 停靠在右侧。RTB 设置为只读。我正在尝试实现一个特殊的拖放功能，如果用户将鼠标按住特殊关键字，它会在关键字顶部创建一个文本框，用户可以将其拖到 DGV 以删除文本框。当文本框成功放到 DGV 上时，DGV 会加载一些关于键盘的信息。

虽然我可以很容易地在表单本身上捕获 mousedown 和 mousemove 事件来实现上述功能，但我觉得使用 mousemove 事件来持续更新文本框的位置是解决这个问题的一种非常低效的方法，并且会导致效果不佳表现。我想听听有关处理上述问题的任何更好的想法。比。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:10:19.480

是的，你的权利，你需要使用 DoDragDrop，搜索它会用相关的东西填充你的谷歌搜索。

# php - Zend 权限错误

> ID：11148924
> 
> 赞同：3
> 
> 时间：2012-06-22T00:58:58.707
> 
> 标签：php, zend-framework

我在日志中收到此错误....

我能做些什么来解决这个问题？

```
2012-06-22T10:53:13+10:00 ERR (3): Zend_Session::start() - /home/commstrat2_web/webrepos/zend/library/Zend/Session.php(Line:469): Error #2 session_start() [<a href='function.session-start'>function.session-start</a>]: open(/var/lib/php/session/sess_ta9eajdp2oirutoitjuk3vss10, O_RDWR) failed: Permission denied (13) Array
/home/commstrat2_web/webrepos/zend/library/Zend/Session.php(Line:479): Error #2 session_write_close() [<a href='function.session-write-close'>function.session-write-close</a>]: open(/var/lib/php/session/sess_ta9eajdp2oirutoitjuk3vss10, O_RDWR) failed: Permission denied (13) Array
/home/commstrat2_web/webrepos/zend/library/Zend/Session.php(Line:479): Error #2 session_write_close() [<a href='function.session-write-close'>function.session-write-close</a>]: Failed to write session data (files). Please verify that the current setting of session.save_path is correct (/var/lib/php/session) Array - Thrown by: /home/commstrat2_web/webrepos/zend/library/Zend/Session.php on line 482 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T01:03:12.827

使您的 resources.session.save_path 可写。

你可以做 ：

```
 chmod 775 /path/to/data/session
    In Zend Framework Bootstrap yourProject/application/configs/application.ini:
    resources.session.save_path = APPLICATION_PATH "/../data/session" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-07T16:35:02.127

如果您使用的是 selinux，请添加 selinux 规则：

```
semanage fcontext -a -t httpd_sys_rw_content_t '/path/to/session'

restorecon -v '/path/to/session' 
```

# php - 如何阻止这些 .htaccess 规则清除我的 $_POST 变量？

> ID：11148926
> 
> 赞同：0
> 
> 时间：2012-06-22T00:59:12.840
> 
> 标签：php, apache, .htaccess, mod-rewrite, post

感谢您前几天在此处对我一直遇到的一些 htaccess 问题的查询提供的帮助-它使我朝着正确的方向前进，以便能够找出导致问题的原因，只是我无法解决如何修复它。

我网站的 htaccess 文件是...

```
<IfModule mod_rewrite.c>

RewriteEngine on
RewriteCond %{HTTP_HOST} !^www\.example.org
RewriteCond %{HTTP_HOST} ^(.+).example.org/^(.+)
RewriteRule ^([^/]*)$ http://example.org [P,L]

ErrorDocument 404 /index.php

RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php [L]

</IfModule> 
```

第一点允许我为我的客户拥有虚拟子域 - 它们都包含来自我的主域的相同文件，但使用不同的布局，并且我的脚本根据子域从数据库中获取不同的数据。然而，这段代码似乎正在破坏任何 $_POST 变量......当我在主域上提交表单时，脚本会获取变量，而对于任何使用完全相同的表单和完全相同的脚本的子域，$_POST 变量是空白的。

如何修复该部分代码或添加其他代码以允许传递 $_POST 变量？Get 似乎在使用最后一部分的站点上工作，因为 /logout/?logmeout 被识别它只是 Post 丢失了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:01:21.377

如果您已经设置了允许此类子域使用所需的通配符虚拟主机，则不需要重定向到主域。只需让您的 PHP 脚本检查`$_SERVER['HTTP_HOST']`以查看正在访问的子域。

# richfaces - Richfaces4 页面的模板

> ID：11148934
> 
> 赞同：0
> 
> 时间：2012-06-22T00:59:51.317
> 
> 标签：richfaces, demo

我正在tomcat7中尝试一些richfaces4的样本。[如果我将http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=panel&skin=emeraldTown](http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=panel&skin=emeraldTown)的“查看源代码”中的代码复制到 test.xhtml 文件中。如果我去`http://localhost/jsf-blank/test.jsf`。我只会看到一个带有纯文本的网页，而不是演示中显示的面板......

我找到了 2 种方法让它像演示页面一样。

第一种方法是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">
<h:head>
</h:head>
<h:body>
    <--!!!insert rich:panel tags here!!!-->
</h:body>
</html> 
```

第二种方式是：

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
 xmlns:h="http://java.sun.com/jsf/html"
 xmlns:f="http://java.sun.com/jsf/core"
 xmlns:ui="http://java.sun.com/jsf/facelets"
 xmlns:a4j="http://richfaces.org/a4j"
 xmlns:rich="http://richfaces.org/rich">

 <f:view>
 <h:head></h:head>
 <h:body>
    <--!!!insert rich:panel tags here!!!-->   
 </h:body>
 </f:view>

</ui:composition> 
```

**问题：** 有人可以更深入地解释一下为什么上述两段代码可以工作，但直接来自演示的代码不能工作？？？ **看起来标签是渲染组件的关键。**有人在这里问了类似的问题[RichFaces4 不渲染组件](https://stackoverflow.com/questions/5758434/richfaces4-dont-render-the-components) 谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T07:16:54.160

您可能会在“使用 Facelets 模板”部分的 Java EE 6 教程中找到答案：http: [//docs.oracle.com/javaee/6/tutorial/doc/giqxp.html](http://docs.oracle.com/javaee/6/tutorial/doc/giqxp.html)

当您单击“查看源代码”链接时，您看到的是客户端页面的代码，因此您还需要一个模板。

# android - 安装apk文件后在android文件系统中找不到我的phonegap应用

> ID：11148935
> 
> 赞同：1
> 
> 时间：2012-06-22T01:00:01.520
> 
> 标签：android, cordova

我目前正在通过 android 上的 phonegap 构建应用程序。

在开始全面开发之前，我准备了一个“恶搞应用程序”，测试了我想尝试的一些功能。

我构建了我的应用程序并对其进行了签名，因此我可以使用 apk 将其安装在我的手机上。

问题是，我的应用程序运行良好，但在我测试应用程序的任何设备上都找不到应用程序的文件系统。我想检索 SQLite 数据库或我创建的文件，但我不能，因为我无法在设备中找到应用程序的文件系统。

插入USB时，除了root设备以在手机文件系统中查看我的应用程序之外，还有其他方法吗？

或者有什么方法可以轻松检索我的应用在手机上创建的数据库？

编辑：我的设备没有 SDCARDS，也不支持 SDCARDS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:21:13.250

问题解决了

因为我发现我必须root手机或平板电脑才能访问文件系统，所以我查看了我的应用程序功能，我发现我可以使用phonegap在手机上创建一个文件夹，但我仍然看不到它。然后我在 Eclipse 中打开 DDMS 透视图并查看文件系统，发现我在手机中看到的文件夹位于 sdcard 目录中的 mnt 文件夹中。(mnt/sdcard)

然后我使用phonegap的文件系统访问在我的手机上创建一个目录。

```
 fileSystem.root.getDirectory("**/mnt/sdcard/com.seventest.com**",{create:true, exclusive: false},gotDir,fails); 
```

所以现在我可以访问一个目录并在其中推送我需要访问的任何内容以供我的应用程序使用。

# java - Dojo 1.7 构建：内存不足错误

> ID：11148947
> 
> 赞同：4
> 
> 时间：2012-06-22T01:02:49.600
> 
> 标签：java, javascript, ant, build, dojo

升级到 Dojo 1.7.3 后，我们在以前版本的 Dojo 上运行多年的 ant 构建由于内存不足错误现在完全无法运行：

```
[java] starting writing resources...
[java] java.lang.OutOfMemoryError: GC overhead limit exceeded
[java]     at org.mozilla.javascript.Interpreter.getArgsArray(Interpreter.java:4623)
[java]     at org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:3335)
[java]     at org.mozilla.javascript.Interpreter.interpret(Interpreter.java:2484)
[java]     at org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:162)
[java]     at org.mozilla.javascript.NativeArray.iterativeMethod(NativeArray.java:1565)
[java]     at org.mozilla.javascript.NativeArray.execIdCall(NativeArray.java:313)
[java]     at org.mozilla.javascript.IdFunctionObject.call(IdFunctionObject.java:127)
[java]     at org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:3335)
[java]     at org.mozilla.javascript.Interpreter.interpret(Interpreter.java:2484)
[java]     at org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:162)
[java]     at org.mozilla.javascript.ScriptRuntime.applyOrCall(ScriptRuntime.java:2347)
[java]     at org.mozilla.javascript.BaseFunction.execIdCall(BaseFunction.java:272)
[java]     at org.mozilla.javascript.IdFunctionObject.call(IdFunctionObject.java:127)
[java]     at org.mozilla.javascript.optimizer.OptRuntime.call2(OptRuntime.java:76)
[java]     at org.mozilla.javascript.gen.c1._c62(Unknown Source)
[java]     at org.mozilla.javascript.gen.c1.call(Unknown Source)
[java]     at org.mozilla.javascript.optimizer.OptRuntime.callName(OptRuntime.java:97)
[java]     at org.mozilla.javascript.gen.c1._c69(Unknown Source)
[java]     at org.mozilla.javascript.gen.c1.call(Unknown Source)
[java]     at org.mozilla.javascript.optimizer.OptRuntime.callName(OptRuntime.java:97)
[java]     at org.mozilla.javascript.gen.c1._c40(Unknown Source)
[java]     at org.mozilla.javascript.gen.c1.call(Unknown Source)
[java]     at org.mozilla.javascript.optimizer.OptRuntime.callName(OptRuntime.java:97)
[java]     at org.mozilla.javascript.gen.c1._c42(Unknown Source)
[java]     at org.mozilla.javascript.gen.c1.call(Unknown Source)
[java]     at org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:3335)
[java]     at org.mozilla.javascript.Interpreter.interpret(Interpreter.java:2484)
[java]     at org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:162)
[java]     at org.mozilla.javascript.ScriptRuntime.applyOrCall(ScriptRuntime.java:2347)
[java]     at org.mozilla.javascript.BaseFunction.execIdCall(BaseFunction.java:272)
[java]     at org.mozilla.javascript.IdFunctionObject.call(IdFunctionObject.java:127)
[java]     at org.mozilla.javascript.optimizer.OptRuntime.call2(OptRuntime.java:76)
[java] js: exception from uncaught JavaScript throw: java.lang.OutOfMemoryError: GC overhead limit exceeded 
```

我在[这里](http://dojo-toolkit.33424.n3.nabble.com/Build-fail-in-1-7-upgrade-td3986632.html)广泛记录了我们的麻烦。

特别是，我注意到：

> 如果我直接从 CL 作为 Java 命令运行我的构建，使用“--optimize shrinksafe”开关，它会失败，但没有成功。（单独使用 internStrings 运行它似乎会导致其他错误）。
> 
> 不知道该怎么做，因为我相信优化默认为shrinksafe，但我已经确定了以下内容：
> 
> 作品：
> 
> c:\temp\dojo-release-1.7.3rc1-src\util\buildscripts>java -Xms256m -Xmx256m -cp ../shrinksafe/js.jar;../closureCompiler/compiler.jar;../shrinksafe/shrinksafe .jar org.mozilla.javascript.tools.shell.Main ../../dojo/dojo.js baseUrl=../../dojo load=build -p C:\company\builds\head\build\generated \general\complete.profile.js --action release --releaseDir C:\company\builds\head\build\generated\general\htdocs\company\javascript\1420
> 
> BROKEN（内存不足错误）：
> 
> c:\temp\dojo-release-1.7.3rc1-src\util\buildscripts>java -Xms256m -Xmx256m -cp ../shrinksafe/js.jar;../closureCompiler/compiler.jar;../shrinksafe/shrinksafe .jar org.mozilla.javascript.tools.shell.Main ../../dojo/dojo.js baseUrl=../../dojo load=build -p C:\company\builds\head\build\generated \general\complete.profile.js --action release --releaseDir C:\company\builds\head\build\generated\general\htdocs\company\javascript\1420 --optimize shrinksafe --internStrings true
> 
> 不幸的是，以下 ant 脚本目标继续失败并出现内存错误：
> 
> 构建编号：${buildNum}
> 
> ```
>  <path id="js.path">             <pathelement location="${basedir}"/>
>   </path>
> 
>   <pathconvert targetos="unix" property="js.path.unix" refid="js.path" 
> ```
> 
> /> js.path.unix: ${js.path.unix}
> 
> ```
>  <!-- clean unpack and output dirs -->       <delete 
> ```
> 
> dir="${outputDir}/htdocs/company/javascript/src/" />
> 
> ```
>  <copy file="${externalDir}/dojo/companyComplete.profile.js" 
> ```
> 
> tofile="${outputDir}/companyComplete.profile.js" 过滤="yes" overwrite="yes">
> 
> ```
>  <java fork="true"
>       dir="${outputDir}/htdocs/company/javascript/src/util/buildscripts"
>       classname="org.mozilla.javascript.tools.shell.Main" 
> ```
> 
> failonerror="true"> --> --> --> -->

* * *

**更新 1**

我也尝试过：

```
<jvmarg value="-Xms5120m"/>
<jvmarg value="-Xmx5120m"/> 
```

并且还使用了`maxmemory`ant java 任务本身的设置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-24T22:29:52.697

终于找到问题了，releaseDir开关值里面既有windows文件分隔符又有unix文件分隔符。过去在 Dojo < 1.6 中可以正常工作，通常 Java 对此没有任何问题。出于某种原因，Dojo 1.7 构建系统在这种情况下遇到了内存问题。

releaseDir 在解决问题中的 ant 标记后，混合了 unix 和 windows 文件分隔符：

```
<arg value="releaseDir=${output.dir}/path/foo/bar" /> 
-> Became -> 
releaseDir=blah\blah\blah/path/foo/bar 
```

这足以导致构建锁定在“写入资源”，然后因“堆空间不足”而崩溃。（这是 Java 通常可以毫无问题地处理的事情）。

修复很简单：

```
<path id="dojo.output.tmp">
    <pathelement location=" ${output.dir}/path/foo/bar "/>
</path>

<pathconvert targetos="unix" property="dojo.output.dir" refid="dojo.output.tmp" />
...
<arg value="releaseDir=${dojo.output.dir}" /> 
```

# java - 如何检测 JFrame 窗口最小化和最大化事件？

> ID：11148950
> 
> 赞同：8
> 
> 时间：2012-06-22T01:03:10.237
> 
> 标签：java, swing, jframe, awt, windowlistener

有没有办法让 JFrame 对象的事件侦听器检测用户何时单击窗口最大化或最小化按钮？

我使用 JFrame 对象如下：

`JFrame frame = new JFrame("Frame");`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-22T01:13:50.837

您可以使用[WindowStateListener](http://docs.oracle.com/javase/6/docs/api/java/awt/event/WindowStateListener.html)。[如何编写窗口侦听器](http://docs.oracle.com/javase/tutorial/uiswing/events/windowlistener.html)教程演示了如何创建与窗口相关的事件处理程序。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-22T06:53:22.460

是的，您可以通过实现`WindowListener`方法来做到这一点，即`windowIconified(WindowEvent e)`by `windowDeiconified(WindowEvent e)`。

有关更多详细信息，请访问[此](http://docs.oracle.com/javase/6/docs/api/java/awt/event/WindowListener.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-19T09:28:35.363

1.  创建一个框架并添加一个监听器：

```
JFrame frame = new JFrame();
frame.addWindowStateListener(new WindowStateListener() {
   public void windowStateChanged(WindowEvent arg0) {
      frame__windowStateChanged(arg0);
   }
});
```

2.  实现监听器：

```
public void frame__windowStateChanged(WindowEvent e){
   // minimized
   if ((e.getNewState() & Frame.ICONIFIED) == Frame.ICONIFIED){
      _print("minimized");
   }
   // maximized
   else if ((e.getNewState() & Frame.MAXIMIZED_BOTH) == Frame.MAXIMIZED_BOTH){
      _print("maximized");
   }
}
```

# c# - 如何将字符串转换为格式化文本C#

> ID：11148952
> 
> 赞同：-6
> 
> 时间：2012-06-22T01:03:15.293
> 
> 标签：c#, wpf

我想在 WPF 应用程序中将字符串转换为 C# 中的格式化文本，该怎么做？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:06:27.163

您始终可以使用普通的 C# 工具来执行此操作。

但是，如果整个目的是为绑定制作一个漂亮的字符串，您可以直接使用绑定的[StringFormat](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingbase.stringformat.aspx)。

例如，您可以拥有这样的 TextBlock：

```
<TextBlock>
    <TextBlock.Text>
      <MultiBinding  StringFormat="{}{0} at distance of {1}m.">
        <Binding Path="User"/>
        <Binding Path="Distance"/>
      </MultiBinding>
    </TextBlock.Text>
</TextBlock> 
```

这将根据“用户”和“距离”绑定值格式化文本。

# python - 如何从文件中删除特定行但保持其他行不变？

> ID：11148956
> 
> 赞同：2
> 
> 时间：2012-06-22T01:03:34.130
> 
> 标签：python, strip

我想学习 Python，所以我开始编写我的第一个程序，它是一个电话簿目录。它具有添加姓名和电话号码、删除号码以及搜索它们的选项。我已经卡在删除部分大约 2 天了，只是无法使其正常工作。我一直在 Python IRC 和一切，但一直无法弄清楚。基本上，我的程序将数字存储到文件中的列表中。我无法弄清楚如何删除文件中的特定行，但保持文件的其余部分完好无损。有人可以帮我吗？

有些人建议，如果我创建一个临时文件，删除该行，然后将剩余的行从原始文件复制到临时文件，这会更容易。然后用临时文件覆盖原始文件。所以我一直在尝试这个...

```
if ui == 'remove':  
    coname = raw_input('What company do you want to remove? ') # company name
    f = open('codilist.txt', 'r') # original phone number listing        
    f1 = open('codilist.tmp', 'a') # open a tmp file

    for line in f:  
        if line.strip() != coname.strip():    
            for line in f: 
                f1.write(line)                             
            break         # WILL LATER OVERWRITE THE codilist.txt WITH THE TMP FILE
        else:
            f1.write(line)
    else:
        print 'Error: That company is not listed.'    
    f1.close()
    f.close()
    continue 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T13:12:48.383

我假设您的文件在每一行都包含类似 < *name* >< *whitespace* >< *number > 的内容？*如果是这种情况，您可以在 if 语句中使用类似的内容（不包括错误处理！）：

```
name, num = line.strip().split()
if name != coname.strip():
    # write to file 
```

**建议：**

除非有特定原因让您使用自定义格式，否则 json 文件格式非常适合此类任务。还要注意这些示例中使用了“with”语句，这样您就不必显式关闭文件。

要写入信息：

```
import json

# Somehow build a dict of {coname: num,...}
info = {'companyA': '0123456789', 'companyB': '0987654321'}

with open('codilist.txt', 'w') as f:
    json.dump(info, f, indent=4) # Using indent for prettier files 
```

要读取/修改文件：

```
import json

with open('codilist.txt', 'r+') as f:

    info = json.load(f)

    # Remove coname
    if coname in info:
        info.pop(coname)
    else:
        print 'No record exists for ' + coname

    # Add 'companyC'
    info['companyC'] = '0112233445'

    # Write back to file
    json.dump(info, f, indent=4) 
```

这些示例需要 python2.6 或更高版本。如果您使用的是 2.5，则需要这些导入：

```
import simplejson as json
from __future__ import with_statement 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T14:02:03.603

这是一个相当广泛的重写版本：

*   所有电话数据都包装在电话簿类中；数据保存在内存中（而不是每次调用都保存和重新加载）

*   它使用 csv 模块来加载和保存数据

*   单个动作被转换成简短的函数或方法（而不是一大块代码）

*   命令被抽象为函数调度字典（而不是 if/then 测试的级联）

这应该更容易理解和维护。

```
import csv

def show_help():
    print('\n'.join([
        "Commands:",
        "    help                   shows this screen",
        "    load [file]            loads the phonebook (file name is optional)",
        "    save [file]            saves the phonebook (file name is optional)",
        "    add {name} {number}    adds an entry to the phonebook",
        "    remove {name}          removes an entry from the phonebook",
        "    search {name}          displays matching entries",
        "    list                   show all entries",
        "    quit                   exits the program"
    ]))

def getparam(val, prompt):
    if val is None:
        return raw_input(prompt).strip()
    else:
        return val

class Phonebook(object):
    def __init__(self, fname):
        self.fname = fname
        self.data = []
        self.load()

    def load(self, fname=None):
        if fname is None:
            fname = self.fname
        try:
            with open(fname, 'rb') as inf:
                self.data = list(csv.reader(inf))
                print("Phonebook loaded")
        except IOError:
            print("Couldn't open '{}'".format(fname))

    def save(self, fname=None):
        if fname is None:
            fname = self.fname
        with open(fname, 'wb') as outf:
            csv.writer(outf).writerows(self.data)
            print("Phonebook saved")

    def add(self, name=None, number=None):
        name   = getparam(name,   'Company name? ')
        number = getparam(number, 'Company number? ')
        self.data.append([name,number])
        print("Company added")

    def remove(self, name=None):
        name = getparam(name, 'Company name? ')
        before = len(self.data)
        self.data = [d for d in self.data if d[0] != name]
        after = len(self.data)
        print("Deleted {} entries".format(before-after))

    def search(self, name=None):
        name = getparam(name, 'Company name? ')
        found = 0
        for c,n in self.data:
            if c.startswith(name):
                found += 1
                print("{:<20} {:<15}".format(c,n))
        print("Found {} entries".format(found))

    def list(self):
        for c,n in self.data:
            print("{:<20} {:<15}".format(c,n))
        print("Listed {} entries".format(len(self.data)))

def main():
    pb = Phonebook('phonebook.csv')
    commands = {
        'help':   show_help,
        'load':   pb.load,
        'save':   pb.save,
        'add':    pb.add,
        'remove': pb.remove,
        'search': pb.search,
        'list':   pb.list
    }
    goodbyes = set(['quit','bye','exit'])

    while True:
        # get user input
        inp = raw_input("#> ").split()

        # if something was typed in
        if inp:
            # first word entered is the command; anything after that is a parameter
            cmd,args = inp[0],inp[1:]

            if cmd in goodbyes:
                # exit the program (can't be delegated to a function)
                print 'Goodbye.' 
                break
            elif cmd in commands:
                # "I know how to do this..."
                try:
                    # call the appropriate function, and pass any parameters
                    commands[cmd](*args)
                except TypeError:
                    print("Wrong number of arguments (type 'help' for commands)")
            else:
                print("I didn't understand that (type 'help' for commands)")

if __name__=="__main__":
    main() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T01:08:03.097

像这样简单的东西会读取所有的`f`，并写出所有不匹配的行：

```
for line in f:
    if line.strip() != coname.strip():
        f1.write(line) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-24T03:41:45.223

我得到了这个工作...

```
if ui == 'remove':  
    coname = raw_input('What company do you want to remove? ') # company name
    f = open('codilist.txt')
    tmpfile = open('codilist.tmp', 'w')
    for line in f:
        if coname in line:
            print coname + ' has been removed.'
        else:
           tmpfile.write(line)
    f.close()
    tmpfile.close()
    os.rename('codilist.tmp', 'codilist.txt')
    continue 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T02:22:21.157

内德的回答看起来应该可行。如果您还没有尝试过，您可以在相关行上方设置 python 的交互式调试器。然后你可以打印出 和 的值`line.strip()`来`coname.strip()`验证你正在比较苹果和苹果。

```
for line in f:
    import pdb
    pdb.set_trace()
    if line.strip() != coname.strip():
        f1.write(line) 
```

[这是 pdb 命令的列表](http://docs.python.org/library/pdb.html#debugger-commands)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T08:21:43.753

您可能不想以附加（'a'）模式打开临时文件：

```
f1 = open('codilist.tmp', 'a') # open a tmp file 
```

另外，请注意

```
for line in f:
    ...
    f1.write(line) 
```

将所有内容都写入文件而无需换行符。

你想要的基本结构是：

```
for line in myfile:
    if not <line-matches-company>:
        tmpfile.write(line + '\n')   # or print >>tmpfile, line 
```

你必须实施`<line-matches-company>`（问题中没有足够的信息来知道它应该是什么 - 也许如果你从你的数据文件中显示了几行......？）

# php - 我将如何在 php 中传递字符串名称？

> ID：11148957
> 
> 赞同：-3
> 
> 时间：2012-06-22T01:03:41.163
> 
> 标签：php, jquery, css

您好这里有一个问题我如何在 php 中传递字符串名称？这是我的代码

我想使用`$_GET`或将数据传递给输入类型`$_POST`

```
if(isset($_POST['pickup']) == NULL){
    echo "-";
}
else{
    echo $_POST['pickup'];
} 
```

我想将数据传递给输入类型我将如何获得？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T01:05:27.383

我想这就是你要找的：

```
<input type='text' name='pickup' value='<?=$_POST['pickup'];?>'> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T01:13:26.280

尝试这个，

```
if(isset($_POST['pickup']) == NULL){
    $input = "-";
}
else{
    $input = $_POST['pickup'];
}
<input type='text' name='pickup' value='<? echo $input;?>'> 
```

# javascript - 未找到 Javascript 原型方法覆盖

> ID：11148960
> 
> 赞同：0
> 
> 时间：2012-06-22T01:04:23.087
> 
> 标签：javascript, overriding, prototype-programming

我有这个基本类型：

```
typeA = function () {

};

typeA.prototype = {
  do = function() { alert ("do something"); },
  doMore = function() { this.do(); }
} 
```

和一个继承的类型 typeB：

```
typeB = function () {

};
typeB .prototype = new typeA();
typeB.prototype.do = function() { alert ("do something else"); }; 
```

当我创建 typeB 的实例并调用 doMore 时，我收到一个错误，指出 this.do 不是函数。我可以在 Javascript 中做这种事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:17:43.483

这个例子是你要找的吗？

```
typeA = function () { };

typeA.prototype = {
  do : function() { alert ("do something"); }, //use : instead of = here
  doMore : function() { this.do(); }
}

typeB = function () { };

typeB.prototype = new typeA();
typeB.prototype.do = function() { alert ("do something else"); };

var instance = new typeB();
instance.doMore(); 
```

您`:`在声明对象的属性和`=`为变量赋值时使用。:D

**补充说明：**

这就是有趣的事情发生的地方：

typeB.prototype = new typeA();

当您使用 访问对象的函数或变量时`.`，浏览器首先会在对象本身中查看该变量是否已在其中定义。这就是为什么你可以做这样的事情：

```
var foo = function() {};
foo.prototype.bar = 3

instance = new foo();
alert( instance.bar ); //alerts 3
instance["bar"] = 55;  //add a variable to the instance object itself
alert( instance.bar ); //alerts 55, instance variable masks prototype variable 
```

这表明有两种方式可以使某物“在”一个对象中。它可以在对象本身中（也可以通过添加`this.bar = 55`到构造函数中），也可以在对象的原型中。

因此，当您说`typeB.prototype = new typeA();`您将所有内容放入该实例时`typeA`into `typeB'prototype`。你基本上说的是“嘿浏览器，如果你在 typeB 的实例中找不到东西，看看它是否在 typeA 的这个实例中！”

*事实证明，在那个实例*中实际上没有任何东西，只有当浏览器在*该*对象本身中找不到该名称的变量时，它的原型中的东西最终会被使用。当您调用`instance.doMore()`时，浏览器在 中找不到它`instance`，因此它会在 中查找`typeB.prototype`，您只需将其设置为`typeA`. 因为它找不到`doMore`在*那个*实例中调用的任何东西，它查看*它的*原型，最后找到一个定义`doMore`并愉快地调用它。

一件有趣的事情是，您仍然可以处理实际在`typeA`您设置为原型的那个实例中的东西：

```
//earlier code the same

foo = new typeA();
typeB.prototype = foo;
foo.do = function() { alert ("do something else"); };
//^^ same as `typeB.prototype.do = function() { alert ("do something else"); };`

var instance = new typeB();
instance.doMore(); 
```

虽然当您了解发生了什么事情时，这很酷，但额外的间接层（在查看 typeA.prototype 之前检查是否在 typeA 的实例中定义了东西）可能不是最好的主意，而且您的代码会如果你这么说可能会更清楚：

```
typeB.prototype = typeA.prototype; 
```

（对不起，如果你已经知道我刚刚告诉你的一切，但我想我会描述一下事情是如何运作的；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T01:08:25.397

你不能使用这个词`do`，因为它是一个保留关键字（在 do while 循环中使用）。但是，您可以尝试以下操作：

```
typeA.prototype = {
    "do": function() { ... }
    ...
};

typeA["do"](); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T01:30:47.573

使用原型时最好使用构造函数。

你需要做的是在你设置它的typeA原型之后实例化对象。您正在做的是在创建 typeB 之后动态添加 .do() 的新功能。这是你能做到的唯一方法。

```
function typeA() { };
typeA.prototype = {
    'do': function () { alert("do something"); },
    doMore: function () { this.do(); }
}
function typeB() { };
typeB.prototype = new typeA();
typeB.prototype['do'] = function () { alert('doing from typeB'); };
var b = new typeB();
//
b.do(); 
```

# ruby-on-rails - 使用 ActiveRecord 将 SUM 放入属性中

> ID：11148963
> 
> 赞同：0
> 
> 时间：2012-06-22T01:04:38.593
> 
> 标签：ruby-on-rails, activerecord

我的问题很简单：

我有一个`Lot`带有列的表：`(id, product_id, quantity)`

我想创建一个范围，按 product_id 对所有寄存器进行分组并计算`sum` 数量列并返回批次对象数组的结果。

我需要这个：

```
lots = Lot.sum_lots
lots.each do |lot|
  puts lot.product.name + " : " + lot.quantity.to_s
end 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T01:25:24.773

试试这个：

```
Lot.sum(:quantity, :group => :product_id) # will return a hash: {1 => 22, 2 => 11} 
```

结果是一个带有`product_id`as 键和总和的哈希`quantity`值。

# html - 褪色背景

> ID：11148967
> 
> 赞同：0
> 
> 时间：2012-06-22T01:05:28.510
> 
> 标签：html, css, fade

每当我单击链接时，我都希望打开一个面板。我希望整个页面淡出并且只显示该面板。

我怎样才能做到这一点？

谢谢库沙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T01:26:39.040

您可以有一个`div`与页面的内容，另一个与面板的内容。您可能希望将面板放置在页面上的绝对或固定位置。之后，您可以将 JavaScript/jQuery 中的函数附加到您想要触发淡入淡出的任何事件，以更改页面内容和面板的不透明度或显示。下面是一个例子。

**HTML：**

```
<div id="A">
    <div id="B">
        <p id="1">Click Me!</p>
    </div>
</div>

<div id="C"><p id="2">Click Me!</p></div> 
```

**CSS：**

```
p {
    cursor: pointer;
}
#A {
    height: 400px;
    width: 300px;
    background: grey;
}
#B {
    height: 200px;
    width: 300px;
    background: red;
}
#C {
    height: 100px;
    width: 200px;
    background: blue;
    position: absolute;
    top: 50px;
    left: 50px;
    display: none;
} 
```

**jQuery：**

```
$('#1').click(function(){
    $('#A').fadeOut('slow');
    $('#C').fadeIn('slow');
});

$('#2').click(function() {
    $('#C').fadeOut('slow');
    $('#A').fadeIn('slow');
}); 
```

[演示](http://jsfiddle.net/fZu8m/1/)

在此示例中，“A”`div`将是您的内容，“C”`div`将是您的面板。`p`上面写着“点击我！”的文字 是你的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T01:21:07.303

据我所知，您可以通过两种方式获得这种效果1。对于第一种方式，您需要将内容和面板分开，例如-

```
<div id="container">
    <div id="content">
        <!-- your content goes here -->
        <a href="" id="link">link</a>
    </div>
    <div id="panel">
        <!-- your panel code goes here-->
    </div>
</div> 
```

并将您的面板放置在绝对尊重容器的位置，并使用一些 jQuery 将内容淡出`div`，例如-

```
$(document).ready(function(){
     $('#link').on('click',function(){
          $('#panel').show();
          $('#content').hide();
     });
}); 
```

1.  如果您需要将面板代码保留在链接旁边，则可以降低内容的不透明度，例如-

    ```
    <div id="container">
        <div id="content">
            <!-- your content goes here -->
            <a href="" id="link">Link</a>
        </div>
        <div id="panel">
            <!-- your panel code goes here-->
        </div>
    </div> 
    ```

和 jQuery-

```
 $(document).ready(function(){
         $('#link').on('click',function(){
              $('#panel').show();
              $('#content').css('opacity','0');
         });
    }); 
```

这是一个粗略的代码，我省略了很多东西。我希望你有这个想法时会弄清楚。谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T01:14:59.140

您可以设置一个 div，其位置固定在左上角，高度和宽度为 100%，z-indexed 高于一切，CSS 过渡或 jQuery 将 div 动画化到视图中。使用不透明的背景，使父页面不可见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T01:17:27.930

你必须准备两件事：

1.  覆盖整个页面的 div
2.  您要淡入的面板

单击链接后，“淡入” div 使其覆盖整个页面并淡入面板。您可能需要指定该 div 和面板的 z-index 以确保它们位于顶部。

# ios - 用字典格式编写 plist

> ID：11148971
> 
> 赞同：0
> 
> 时间：2012-06-22T01:05:42.510
> 
> 标签：ios, objective-c, xcode, dictionary, plist

我正在将信息写入文档文件夹中的 plist 文件，并且我已经完成了大约 90% 的路径（我认为）。我只需要一些帮助格式化我正确编写的信息。

我需要以这种格式写入数据：

```
<plist version="1.0">
<array>
<dict>
    <key>Level</key>
    <string>0</string>
    <key>Top</key>
    <string>0</string>
    <key>Needed</key>
    <string>0</string>
    <key>Passed</key>
    <string>0</string>
</dict>
<dict>
    <key>Level</key>
    <string>1</string>
    <key>Top</key>
    <string>5300</string>
    <key>Needed</key>
    <string>4000</string>
    <key>Passed</key>
    <string>Yes</string>
</dict>
</array>
</plist> 
```

我正在使用此代码写入文件：

```
NSMutableDictionary *array = [[NSMutableDictionary alloc]init]; 
[array setObject:field1.text forKey:@"Top"];
[array writeToFile:[self dataFilePath] atomically:YES]; 
```

它设置键并输入值。但是有人可以帮我把它正确格式化，看起来像上面的 plist。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T02:22:59.207

这是一个示例代码：

```
 NSMutableArray *plistArray = [[ NSMutableArray alloc] initWithContentsOfFile:[self dataFilePath]];
  NSLog(@"plistArray before additon: %@", plistArray);
  for (NSMutableDictionary *dict in plistArray)
  {
    //if you want to search for a record only otherwise remove the if statement
    if ([[dict objectForKey:@"Top"] isEqualToString:@"0"])  //this just an example, modify this per your needed
      [dict setObject:field1.text forKey:@"Top"];  //select which dictionary record to set the Top key
  }
  NSLog(@"plistArray after additon : %@", plistArray);
  [plistArray writeToFile:[self dataFilePath] atomically:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T01:27:29.400

如果您右键单击 plist 文件，您应该能够在文本编辑器中打开它。如果这样做，您可以复制并粘贴您的格式吗？或者你的意思是你有太多的数据要手写，而你正试图用脚本来写？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T01:56:50.150

您的代码很混乱...您有一个名为 的变量`array`，但它被声明为字典。从您的属性列表示例中，您似乎想要一个外部级别的数组，因此您的代码应该使用`NSArray`or `NSMutableArray`。

# c# - 需要 C# 正则表达式来替换字符串内的空格

> ID：11148974
> 
> 赞同：3
> 
> 时间：2012-06-22T01:06:08.783
> 
> 标签：c#, regex

使用 C#，我需要一些代码来使用正则表达式用管道字符 (|) 替换引号内的空格。问题是字符串可能包含多个带引号的表达式，***我只想要引号内的空格***。

我尝试了一些事情，但我正在努力处理如何处理可能在引号内的可变数量的单词，等等。

以下是一些可能输入的示例以及所需的输出：

"word1 word2"
-> "word1|word2"

“word1 word2” word3 “word4 word5”
-> “word1|word2” word3 “word4|word5”

word1 "word2 word3"
-> word1 "word2|word3"

非常感谢任何帮助，希望我能了解正则表达式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-22T01:11:30.243

使用正则表达式查找引号，并使用普通 Replace 替换空格：

```
str = Regex.Replace(str, @"""[^""]+""", m => m.Value.Replace(' ', '|')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T01:17:05.177

有一个有用的网站可以测试这样的东西，它叫做 reFiddle

[http://refiddle.com](http://refiddle.com)

我要做的是使用这个

[http://refiddle.com/288](http://refiddle.com/288)

`/["][^"]+["]/g`

要获取引号内的字符串，只需对这些返回的字符串进行替换，您就应该是金色的。

# django - Django 自定义管理器添加属性

> ID：11148975
> 
> 赞同：1
> 
> 时间：2012-06-22T01:06:09.983
> 
> 标签：django, django-custom-manager

我有一个看起来像这样的 Django 模型：

```
class MyModel(models.Model):
    field1 = models.IntegerField()
    field2 = models.IntegerField()
    nonDbField = SomeObject()
    objects = MyCustomManager() 
```

field1 实际上是 SomeObject 抽象类的 PK。

我想要一个自定义管理器，它对任何函数（all、filter、get 等）返回的每个值执行以下操作：

```
 value.nonDbField = SomeObject.objects.get(pk=value.field1) 
```

我已经测试过我可以像这样手动覆盖get：

```
class MyCustomManager(models.Manager):
    def get(self, *args, **kwargs):
        value = super(MyCustomManager, self).get(*args, **kwargs)
        value.nonDbField = SomeObject.objects.get(listid=value.itemListID)
        return value 
```

但想知道是否有一种更简单的方法可以在所有功能中做到这一点。

会有很多人会说，“你为什么要这样做？”。它与遗留但仍处于活动状态的数据库的模型继承有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T02:49:12.043

如果您需要 nonDbField 的值与 field1（或模型中的任何其他字段）相关，您可以尝试以下操作：

```
Class MyModel(models.Model):

    # your fields here...

    def _nonDbField(self):
        return SomeObject.objects.get(pk=self.field1)
    nonDbField = property(_nonDbField) 
```

这使您可以执行以下操作：

```
MyModel.objects.get(pk=1).nonDbField 
```

请记住，您每次访问时都会进行数据库查询`nonDbField`（这可能会或可能不会损害您的数据库性能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-12T09:43:38.520

您可以将`property`其用于计算字段

MyModel 类（models.Model）：

```
# your fields here...
first_name = models.CharField()
last_name = models.CharField()

@property
def fullname(self):
    return f"{self.first_name} {self.last_name}" 
```

这使您可以执行以下操作：

```
obj = MyModel.objects.get(pk=1)
print(obj.fullname) 
```

# java - 拥有一个需要可执行的 Java 应用程序 (JAR)。（内置在 Eclipse 中）

> ID：11148976
> 
> 赞同：1
> 
> 时间：2012-06-22T01:06:09.743
> 
> 标签：java, eclipse

我在 Eclipse 上用 Java 构建了这个小应用程序 (JAR)，它需要编译成可执行文件，人们只需双击它即可运行。理想情况下，这将是一个 exe 文件类型。我不太熟悉 java 和需求是什么，但我希望可以编译它来运行一台可能没有安装 java 的计算机。

你有什么建议或方向可以指点我，这样我就可以解决这个问题？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:19:24.917

试试这个应用程序：exe4j：[http ://www.ej-technologies.com/products/exe4j/overview.html](http://www.ej-technologies.com/products/exe4j/overview.html)

它在各种平台上运行以制作 EXE 文件 :))

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T01:15:08.303

> 理想情况下，这将是一个 exe 文件类型。

不，理想情况下这将是一个 Jar 文件。只需将其保留为 jar 文件即可。如果您将平台设置为正确响应双击，它将正常工作。是的，计算机需要安装 Java——这不是一项繁重的要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T01:15:20.770

您将无法使其在未安装 Java 的 PC 上运行。

有很多关于如何制作可执行 jar 以在安装了 Java 的计算机上运行的指南：选择：[java 可执行 jar 创建](https://stackoverflow.com/q/6148111/857132)、 [将 JAR 制作为独立的可执行文件](https://stackoverflow.com/q/5066291/857132)等等......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T01:23:25.710

您可以尝试[http://www.excelsior-usa.com/jet.html](http://www.excelsior-usa.com/jet.html)。它可免费用于非商业用途。

# objective-c - SMJobBless 和朋友们

> ID：11148979
> 
> 赞同：0
> 
> 时间：2012-06-22T01:06:42.150
> 
> 标签：objective-c, macos, launchd, launch-daemon

我制作了一个提交到 Mac AppStore 的应用程序。由于某些原因，他们拒绝了它，因为它正在使用 SMJobBless API 安装帮助工具。

由于该帮助工具对于大多数应用程序的功能来说不是必需的，因此我已将其删除，并且我的应用程序已被接受。

所以现在，我正在为可以在互联网上下载的帮助工具打包一个独立的安装程序。

但是，在我将文件安装到位后，帮助工具拒绝运行......帮助工具只有一个进入 /Library/LaunchDaemons 的 plist 和一个进入 /Library/PrivilegedHelperTools 的二进制文件。

现在我想知道，除了将文件移动到位之外，SMJobBless 究竟做了什么？它是在用 launchctl 注册我的工具吗？我尝试了各种方法，手动将其添加到launchctl，但没有成功：帮助工具在请求它的签入请求后才退出。

辅助工具只包含：

```
@autoreleasepool {
    launch_data_t       req             = launch_data_new_string(LAUNCH_KEY_CHECKIN);
    launch_data_t       resp            = launch_msg(req); // AT THIS POINT, RESP IS NULL. Why?
    launch_data_t       machData        = launch_data_dict_lookup(resp, LAUNCH_JOBKEY_MACHSERVICES);
    launch_data_t       machPData       = launch_data_dict_lookup(machData, [kHelperBundleName UTF8String]);
    mach_port_t         mp              = launch_data_get_machport(machPData);
    launch_data_free                    (resp);
    launch_data_free                    (req);
    // Prepare connexion.
    NSMachPort          *rp             = [[NSMachPort alloc] initWithMachPort:mp];
    PrivilegedHelperProxy
                        *phProxy        = [[[PrivilegedHelperProxy alloc] init] autorelease];
    NSConnection        *con            = [NSConnection connectionWithReceivePort:rp sendPort:nil];
    [rp release];
    [con setRootObject:phProxy];
    [[NSRunLoop currentRunLoop] run];
}
return                                  EXIT_SUCCESS; 
```

通过 SMJobBless API 安装时，该服务运行完美，并且可以从我的 APP 中访问根代理...

那么我的安装程序需要哪些步骤才能让这个帮助工具正常工作，就像调用 SMJobBless API 一样？

谢谢，皮埃尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T02:58:44.327

解决了。辅助工具的 PList 条目不包括任何 ProgramArguments（这似乎不是 SMJobBless API 的问题）。将这些添加到 PList 后，帮助工具可以正确运行，并且安装程序会正确注册它。

无论如何谢谢！皮埃尔。

# mysql - 为什么行会匹配但不会用 mysql update 语句更改？

> ID：11148980
> 
> 赞同：5
> 
> 时间：2012-06-22T01:06:45.937
> 
> 标签：mysql

我习惯了 MSSQL，而不是 Mysql，很抱歉这个可能很愚蠢的问题。我正在尝试通过运行以下查询来更新我正在设置的备份数据库的密码：

```
update users set password = md5('pass') where username = 'admin' 
```

当我运行它时，它说

> 查询正常，0 行受影响（0.01 秒）匹配行：1 更改：0 警告：0

为什么行匹配但不改变？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-22T01:08:03.493

这意味着该值没有改变。它可能没有更改，因为该列已经等于 .md5 的哈希值`pass`。

# wordpress - 使用 tax_query 在 $wp_query->request 中创建 0 = 1

> ID：11148983
> 
> 赞同：3
> 
> 时间：2012-06-22T01:07:26.747
> 
> 标签：wordpress

`pre_get_posts`这是我第一次尝试使用操作/过滤器修改主查询

这是当前与它挂钩的功能：

```
function advanced_product_search_filter($query)
{
  if(!is_admin() &&
     is_main_query() && 
     is_search() && $query->query_vars['post_type'] == 'product')
  {
    $keyword = $_GET['s'];

    if($_GET['exactly'])
      $keyword = $_GET['s'] . ' "'. $_GET['exactly'] . '"';

    if($_GET['without'])
    {
      $excluded = exclude_product_keyword_search($_GET['without'], 
                    $_GET['pname'],
                    $_GET['pcode']
                  );
      $query->set('post__not_in', $excluded);
    }

    if($_GET['pname'])
      $query->set('s', $keyword);
    else
      $query->set('s', '');

    if($_GET['pcode'])
    {
      $tax_queries = $query->get('tax_query');
      $tax_queries[] = array(
        array(
          'taxonomy' => 'pa_ordering-code',
          'field' => 'name',
          'terms' => array($keyword),
          'operator' => 'LIKE'
        )
      );
      $query->set('tax_query', $tax_queries);
    }
  }
} 
```

这是一个建立在安装之上的插件`WooCommerce`。所以基本上这个函数*试图*支持`WooCommerce`通过标准搜索（标题和内容）或在表中调用`Ordering Code`的自定义属性上的属性搜索来搜索产品`pa_ordering-code``term_taxonomy`

代码的其他部分工作正常，我可以修改`s`and `post__not_in`vars 没有任何问题，但如果我尝试使用`tax_query`它，查询似乎会崩溃。

为了给你一个想法，当我尝试这个时：

```
?s=foo&post_type=product&pname=1&pcode=1&without=non&exactly=foo+bar 
```

转储`WHERE`子句，我看到了：

```
AND wp_posts.ID NOT IN (219) 
AND 0 = 1 
AND 
(
  (
    (wp_posts.post_title LIKE '%foo%') OR 
    (wp_posts.post_content LIKE '%foo%')
  ) AND (
    (wp_posts.post_title LIKE '%foo bar%') OR 
    (wp_posts.post_content LIKE '%foo bar%')
  )
) 
AND wp_posts.post_type = 'product' 
AND (wp_posts.post_status = 'publish' OR wp_posts.post_status = 'private') 
AND
( 
  (
    wp_postmeta.meta_key = '_visibility' AND
    CAST(wp_postmeta.meta_value AS CHAR) IN ('visible','search')
  ) 
) 
```

注意`AND 0 = 1`? 当我转储`JOIN`子句时，我确信`tax_query`参数没有被正确解释，因为我只看到`postmeta`那里的表格。否`terms`, `term_relationships`, 或`term_taxonomy`表。

`tax_query`而且我还尝试通过这样做简单地覆盖现有的（如果有的话）：

```
$args = array(
  array(
    'taxonomy' => 'pa_ordering-code',
    'field' => 'name',
    'terms' => array($keyword),
    'operator' => 'LIKE'
  )
);
$query->set('tax_query', $args); 
```

但我仍然无法让它工作。关于我可能做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T06:28:28.013

将**include_children**参数设置为**false**解决了我的问题：

```
$args = array(
  array(
    'taxonomy' => 'taxonomy-name',
    'field' => 'id',
    'terms' => array(1, 2, 3, 4),
    'include_children' => false,
    'operator' => 'AND'
  )
); 
```

当 tax_query 中存在嵌套术语时（例如 2 是 1 的子项），似乎会发生错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-18T08:47:39.310

当您搜索的此类分类或分类参数不存在时，通常会发生这种情况。例如分类名称有拼写错误，或者如果您按 slug 搜索，则为 slug 名称。在这种情况下很难说，因为您重写了分类查询。

# php - PHP 内存管理和数组

> ID：11148985
> 
> 赞同：1
> 
> 时间：2012-06-22T01:07:52.617
> 
> 标签：php, memory-management

我需要担心 PHP 的内存泄漏吗？特别是，我有以下从浏览器调用的代码。调用完成后，是否所有内容都已正确清理，或者我是否需要清除由创建的第一个数组创建的内存？

```
class SomeClass
{
  var $someArray = array();

  function someMethod()
  {
     $this->someArray[1] = "Some Value 1";
     $this->someArray[2] = "Some Value 2";
     $this->someArray[3] = "Some Value 3";
     $this->someArray = array();
     $this->someArray[1] = "Some other Value";
     $this->someArray[2] = "Some other Value";
     $this->someArray[3] = "Some other Value";
  }
}

someMethod(); 
```

谢谢，斯科特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T01:13:02.487

> 我需要担心 PHP 的内存泄漏吗？

It's possible to have a cyclic reference in PHP where the `refcount` of the `zval` never drops to `0`. This will cause a memory leak (GC won't clean up objects that have a reference to them). This has been fixed in >= PHP 5.3.

> In particular, I have the following code that is being called from a browser. When the call finishes, is everything cleaned up properly, or, do I need to clear the memory created by the first array that was created?

PHP scripts have a *request* lifecycle (run application, return response, close application), so it shouldn't be a worry. All memory used by your application should be marked as free'd when your application finishes, ready to be overwritten on the next request.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T01:09:47.843

如果你是超级偏执狂，你总是可以`unset`的，但是，PHP 是一种垃圾收集语言，这意味着除非核心或扩展中存在错误，否则永远不会发生内存泄漏。

[更多信息](http://php.net/manual/en/features.gc.php)

* * *

附带说明一下，您应该使用较新的 PHP 5 OOP 语法。而且， someMethod 将是一个错误。它需要是 $obj->someMethod() 其中 $obj 是该类的一个实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T01:59:20.290

There actually do exist memory problems if you run mod_php through Apache with the [mpm_prefork](https://httpd.apache.org/docs/2.2/mod/prefork.html) behavior. The problem is that memory consumed by PHP is not released back to the operating system. The same Apache process can reuse the memory for subsequent requests, but it can't be used by other programs (not even other Apache processes).

One solution is to restart the processes from time to time, for example by setting the [MaxRequestsPerChild](https://httpd.apache.org/docs/2.2/mod/mpm_common.html#maxrequestsperchild) setting to something rather low (100 or so, maybe lower for lightly loaded servers). The best solution is to not use mod_php at all but instead run PHP through FastCGI.

This is a sysadmin issue though, not a programmer issue.

# html - Div 和输入字段并排

> ID：11148987
> 
> 赞同：0
> 
> 时间：2012-06-22T01:07:56.143
> 
> 标签：html

此 HTML 应显示 div，然后在其旁边显示输入，但不显示。它在不同的行上显示它们。怎么了？

`<div style="display: inline; float: left;">Title </div><input id="event_title" name="event_title" style="float:right; display: inline; width: 441px;" onclick="clear_field_color(this);"/>`

应该是这样的：

```
Title  [_____________________________________________] 
```

但看起来像这样：

```
Title 
       [_____________________________________________] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T01:27:55.250

您可以尝试调整 的`line-height`，`div`就像[这样](http://jsfiddle.net/Ddwuf/)，但我会说在语义上标签比 div 更有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T01:29:06.173

你会对 float:right 感到惊讶，只需交换元素的顺序，它就会按需要工作！输入第一，div第二

```
<input id="event_title" name="event_title" style="float:right; display: inline; width: 441px;" onclick="clear_field_color(this);"/><div style="display: inline; float: left;">Title </div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T01:14:05.767

如果您正在谈论标题和文本框之间的差距，那么只需摆脱`float:right`

也许在标题后加一个填充，例如：

```
<div style="display: inline; float: left; padding-right:5px;">Title </div>
<input id="event_title" name="event_title" style=" display: inline; width: 441px;" onclick="clear_field_color(this);"/>​ 
```

# android - 状态栏中的通知图标而不接管状态栏几秒钟？

> ID：11148991
> 
> 赞同：0
> 
> 时间：2012-06-22T01:08:04.240
> 
> 标签：android, android-notifications, android-notification-bar

我知道如何向状态栏发送通知，但是当它第一次启动时，它会占据整个状态栏，除了你的图标之外你什么也看不到。有什么方法可以在不占用整个状态栏几秒钟的情况下显示您的图标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T01:15:56.120

听起来你正在使用一个空的`tickerText`. 只需将其设置为`null`，系统将不会尝试显示它。

# c++ - 读取 Matroska (MKV) 元数据并提取流

> ID：11148995
> 
> 赞同：1
> 
> 时间：2012-06-22T01:08:14.393
> 
> 标签：c++, video

我正在尝试用 C++ 编写一个程序，该程序需要显示 MKV 文件中的元数据并从文件中提取流。

我查看了 libmatroska，发现它很难使用，因为它的级别非常低。除了 mkvtoolnix 之外，也没有使用示例，由于必须引入大部分 mkvinfo 和 mkvextract，因此难以使用。libmediainfo 涵盖了我需要的大部分内容，但如果可能的话，更灵活一些会更好。

此外，我没有发现不使用 mkvextract 将视频流写入临时文件的简单方法。

任何意见，将不胜感激

# javascript - window.variableName

> ID：11148997
> 
> 赞同：61
> 
> 时间：2012-06-22T01:08:40.187
> 
> 标签：javascript

我正在浏览一些代码，并且在我们拥有的脚本的开头`var emailID = email`。稍后，代码通过 go 引用 emailID `window.emailID`。我想知道允许您通过 window.variableName 引用变量的规则是什么？

我不能在网上发布我的剧本，因为它与我的工作直接相关并且会违反我的合同。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-06-22T01:14:11.423

`window.variableName`表示该变量是在全局范围内声明的。这意味着任何 JS 代码都可以访问这个变量。using`window.`不是必需的，但经常用作表示变量是全局变量的约定。

通常要避免使用全局变量。您应该在函数范围内定义变量。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-06-22T01:14:27.830

JavaScript 中的全局变量附加到“全局对象”，在浏览器环境中它被`window`称为对象 - 这就是为什么您可以将全局变量称为`variableName`或`window.variableName`。

还值得一提的是，在 JavaScript 中使用全局变量并不被认为是好的编码习惯。

这是一个[很好且非常详细的解释](https://stackoverflow.com/a/4862268)。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-06-22T01:24:26.283

`window.myVar`或者`window["myVar"]`是引用全局变量的显式方式。

如果变量是在函数外部声明的（带有或不带有“var”），或者如果它在函数内部声明而不使用“var”，或者如果它被声明为`window.myVar`or ，则它是全局变量`window["myVar"]`。

变量是通过给它赋值或使用关键字来声明的`var`。

引用全局变量很有用的一种情况`window.myVar`是，如果您在一个具有名为 的局部变量的函数中`myvar`。在这种情况下，`myVar`指的是局部变量，而`window.myVar`指的是全局变量。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-06-04T12:47:25.380

JavaScript 中的全局变量

```
var no =10;
function getNo()
   alert(no); // 10
}
getNo(); 
```

当一个全局变量被设置时，它被添加到窗口对象中！

```
var no =10;
function getNo()
   alert(window.no); // 10
}
getNo(); 
```

我们可以直接设置窗口变量。

```
function setNo(){
  window.no=100;
}
function getNo()
   alert(window.no); // 100
}
setNo();
getNo(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-11T22:34:14.507

对于纯理论解释（因为我自己遇到了这个“问题”）和易于消化的信息，你可以这样看待问题：

var myName = "Bob" 等于 - globalObject(Window) = { myName: "Bob" }

因此，当您声明一个变量时，该变量名将作为属性传递给窗口对象，并将其值作为属性值。这就是为什么您基本上可以将变量作为窗口对象的对象方法来调用的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-06T06:06:41.830

它用于在 JavaScript 中定义全局变量。

```
globalVar = "Hello World";
function function1(){
    alert(window.globalVar);
} 
function1(); 
```

这将在弹出窗口中打印“Hello World”。

```
 function function1(){ 
        globalVar = "Hello World";
        alert(window.globalVar);
    }function function2(){
        alert(window.globalVar);
    } 
    function1(); 
    function2(); 
```

这将创建两个值为“Hello World”的弹出窗口，一个来自 function1()，另一个来自 function2()。

因此，通过使用 window，我们可以从 javascript 中的任何范围调用变量。