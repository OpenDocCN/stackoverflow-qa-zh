# StackOverflow 问答 10194000-10194999

# c++ - 将字符串拆分为多个原始类型

> ID：10194000
> 
> 赞同：3
> 
> 时间：2012-04-17T15:16:47.417
> 
> 标签：c++, string, split

我正在编写一个程序，它从用户那里读取一个字符串并使用它来处理一个请求。发出提示后，我可以期待以下三种可能的响应之一：

1.  字符串字符串
2.  字符串整数
3.  细绳

根据用户给出的命令类型，程序将执行不同的任务。我在尝试处理用户输入时遇到了困难。为了清楚起见，用户将键入命令作为单个字符串，因此用户执行选项 2 的示例可能会在提示后输入“age 8”。在此示例中，我希望程序将“年龄”存储为字符串，将“8”存储为整数。什么是解决这个问题的好方法？

根据我在这里收集的信息，使用 strtok() 或 boost 可能是一种解决方案。但是，我都尝试过，但都没有成功，如果有人可以帮助使事情变得更清楚，那将非常有帮助。提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T15:26:13.510

使用获取一行输入后`std::getline`，您可以使用 a`std::istringstream`回收文本以进行进一步处理。

```
// get exactly one line of input
std::string input_line;
getline( std::cin, input_line );

// go back and see what input was
std::istringstream parse_input( input_line );

std::string op_token;
parse_input >> op_token;

if ( op_token == "age" ) {
    // conditionally extract and handle the individual pieces
    int age;
    parse_input >> age;
} 
```

# postgresql - 在 PostgreSQL 中对 CASE 查询进行故障排除

> ID：10194006
> 
> 赞同：1
> 
> 时间：2012-04-17T15:17:01.377
> 
> 标签：postgresql, case

我在 PostgreSQL 中有一个 CASE 查询的情况。

我的表（“statut_existenta_pf”）看起来像这里的图片[http://cl.ly/0L1Q2f3v3L0s3V1p3P3X](http://cl.ly/0L1Q2f3v3L0s3V1p3P3X)

我编写了以下查询，它应该与该表的结果相匹配：

```
SELECT p.*, se.se_id_statut, ne.ne_denumire
  FROM persoane_fizice p,
       statut_existenta_pf se,
       nom_statut_existenta ne
  WHERE p.pf_id = :id_pf
    AND se.se_id_pf = p.pf_id
    AND se.se_id_statut IN 
        (CASE 
           WHEN se_data_inceput IS NULL THEN
             (SELECT se_id_statut FROM statut_existenta_pf
                WHERE se_id_pf = :id_pf
                ORDER BY se_id DESC LIMIT 1)
           WHEN se_data_inceput IS NOT NULL AND se_data_sfarsit IS NULL THEN
             (SELECT se_id_statut FROM statut_existenta_pf
                WHERE se_id_pf = :id_pf
                ORDER BY se_id DESC LIMIT 1)
           ELSE
             (SELECT se_id_statut FROM statut_existenta_pf
                WHERE se_id_pf = :id_pf
                  AND CURRENT_DATE BETWEEN se_data_inceput AND se_data_sfarsit)
        END) 
    AND se.se_id_statut = ne.ne_id 
```

问题是我得到 0 个结果，我应该返回一个结果，即“se_data_inceput”为“2010-03-31”且“se_data_sfarsit”为空的结果。

有任何想法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T20:03:56.213

看起来您在`statut_existenta_pf`表中保留了基于时间的对象实例。

我使用了以下测试平台：

```
CREATE TABLE statut_existenta_pf (
    se_id                   int4,
    se_id_pf                int4,
    se_id_statut            int2,
    se_data_inceput         date,
    se_data_sfarsit         date
); -- the rest fields are irrelevant for this example
CREATE TABLE nom_statut_existenta (
    id           int2,
    ne_denumire  varchar(30)
); -- my wild guess bout this table
CREATE TABLE persoane_fizice (
    pf_id           int4,
    pf_name         varchar(60)
); --- same here, irrelevant for the example 
```

使用以下测试数据：

```
INSERT INTO nom_statut_existenta VALUES
    (1, 'Status: Vive'), (2, 'Status: Morto');
INSERT INTO persoane_fizice VALUES (3489, 'Giuseppe Garibaldi');
INSERT INTO statut_existenta_pf VALUES
    (4275, 3489, 2, '2012-04-18', '2012-05-18'),
    (3669, 3489, 1, '2010-03-31', NULL); 
```

现在，您正在此基于时间的系列中搜索*当前*对象。您的逻辑似乎如下：

1.  如果`se_data_inceput`是`NULL`（我将此列视为`instance_start_date`），则获取给定的最新修订的值`persoane_fizice`；
2.  如果`se_data_sfarsit`是`NULL`（`instance_end_date`我相信）那么再次获取最新修订的值；
3.  如果两列都是`NOT NULL`，则获取这些日期之间的修订值。

您没有提到设置中的约束，但我认为拥有多个日期范围重叠的条目是非法的。

以下是我如何重写您的初始查询，产生正确的结果：

```
WITH max_se_id AS (
SELECT se_id_pf, max(se_id) se_id_max FROM statut_existenta_pf
 GROUP BY se_id_pf
)
SELECT p.*, se.se_id_statut, ne.ne_denumire
  FROM persoane_fizice p
  JOIN statut_existenta_pf se ON se.se_id_pf = p.pf_id
  JOIN nom_statut_existenta ne ON ne.id = se.se_id_statut
  JOIN max_se_id mse ON se.se_id_pf = mse.se_id_pf
 WHERE p.pf_id = :id_pf
   AND se.se_id_statut IN 
    (CASE 
       WHEN se_data_inceput IS NULL THEN mse.se_id_max
       WHEN se_data_inceput IS NOT NULL AND se_data_sfarsit IS NULL THEN mse.se_id_max
       ELSE se_id_statut
    END) ; 
```

但是这个查询会产生不正确的结果，对于给定的测试平台，它会返回最高的修订版本`se_id`，尽管它的开始时间在未来。

我正在使用相同的方法来保留数据库中对象的历史记录，我建议改用这样的查询：

```
SELECT p.*, se.se_id_statut, ne.ne_denumire
  FROM persoane_fizice p
  JOIN statut_existenta_pf se ON se.se_id_pf = p.pf_id
  JOIN nom_statut_existenta ne ON ne.id = se.se_id_statut
 WHERE p.pf_id = :id_pf
   AND statement_timestamp() BETWEEN coalesce(se.se_data_inceput, now())
       AND coalesce(se.se_data_sfarsit, clock_timestamp()); 
```

如果`se_data_inceput`+`se_data_sfarsit`列中有不重叠的日期，则此查询将产生当前活动的行。

我在用着：

*   `now()`作为 的默认值`se_data_inceput`，这会产生当前事务的开始时间；
*   `statement_timestamp()`作为*当前*时间点和
*   `clock_timestamp()`作为`se_data_sfarsit`.

使用这种组合，您总是可以期望您的查询从历史表中返回*当前对象实例。*

我希望我的假设是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:59:43.107

我不确定是否`CASE`可以返回一个列表，您正在获得该列表，`ELSE`也许其他人可以启发我们。同时，我认为您可以将`se.se_id_statut IN`部分放入`CASE`：

```
AND 
    (CASE 
       WHEN se_data_inceput IS NULL THEN
         se.se_id_statut IN (SELECT se_id_statut FROM statut_existenta_pf
            WHERE se_id_pf = :id_pf
            ORDER BY se_id DESC LIMIT 1)
       WHEN se_data_inceput IS NOT NULL AND se_data_sfarsit IS NULL THEN
         se.se_id_statut IN (SELECT se_id_statut FROM statut_existenta_pf
            WHERE se_id_pf = :id_pf
            ORDER BY se_id DESC LIMIT 1)
       ELSE
         se.se_id_statut IN  (SELECT se_id_statut FROM statut_existenta_pf
            WHERE se_id_pf = :id_pf
              AND CURRENT_DATE BETWEEN se_data_inceput AND se_data_sfarsit)
    END) 
```

# connection - 根据主机名/端口和用户名限制 Netty 连接

> ID：10194008
> 
> 赞同：1
> 
> 时间：2012-04-17T15:17:07.503
> 
> 标签：connection, port, limit, netty, hostname

我需要根据登录名和客户端连接的主机名/端口对连接数进行严格限制。

关于方法的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:59:34.120

我认为您可以使用 ChannelGroup 来跟踪连接。根据 channelGroup 的内容，做出限制连接的决定。请参阅下面的代码片段。添加到 channelGroup 中的所有通道在关闭时会自动删除。

```
class YourHandler extends SimpleChannelHandler {

ChannelGroup  channelGroup = new DefaultChannelGroup();

 @Override
public void channelOpen(ChannelHandlerContext ctx, ChannelStateEvent e) 
{
    // make a decision if you want to accept connection
    // if not just close it using ctc.getChannel().close()
}

@Override
public void channelConnected(ChannelHandlerContext ctx, ChannelStateEvent e) 
{
    channelGroup.add(ctx.getChannel());
}

} 
```

# php - 删除字符串中的最后一组括号

> ID：10194009
> 
> 赞同：0
> 
> 时间：2012-04-17T15:17:07.660
> 
> 标签：php

我有一个文本区域，我正在输入数据以将其转换为我需要的格式。我输入的数据如下所示：

POTTERTON PUMA 80 E（坐姿/霍尼韦尔）（此型号的所有部件）
POTTERTON PUMA 80 E（坐姿/霍尼韦尔）（框架 - 管道）
POTTERTON TATTLER KINGFISHER RS 46（此型号的所有部件）
POTTERTON PUMA 100 E（坐姿/霍尼韦尔） （此型号的所有部件）
POTTERTON PUMA 100 E（坐姿/霍尼韦尔（框架 - 管道）

有时有两组括号，有时有一组，有时有一组未闭合的括号，然后另一组在末尾。因此，一旦处理完数据，它应该如下所示：

POTTERTON PUMA 80 E (SIT/霍尼韦尔),POTTERTON TATTLER KINGFISHER RS 46,POTTERTON PUMA 100 E (SIT/霍尼韦尔)

所以我基本上希望删除重复出现并删除最后一个括号。我编写的代码可以处理大部分数据，但删除了所有括号。

这是我的代码：

```
<?php
if ($_SERVER['REQUEST_METHOD'] != 'POST') {
?>
<form action="<?php the_permalink(); ?>" method="post">
    <textarea style="width:1000px;height:350px;" name="like"></textarea>
    <button>Submit</button>
</form>
<?php
} else {
    $fits = $_POST['like'];
    $fits = str_replace(" (","(",$fits);
    $fits = preg_replace("/\([^\)]+\)/","", $fits);
    $fits = explode("\n", str_replace("\r", "", $fits));
    $fits = array_unique($fits);
    $comma_separated = implode(', ', $fits);
    echo $comma_separated;
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:38:59.673

换行：

```
$fits = preg_replace("/\([^\)]+\)/","", $fits); 
```

至

```
$fits = preg_replace("/\([^\)]+\)(\R|$)/","$1", $fits); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:29:23.800

您可以使用基于正则表达式的搜索和替换来做到这一点：

```
$line = preg_replace(
    array('~(*ANYCRLF)^(.*)\s+\([^\(\)]+\)$~m', '~(*ANYCRLF)\R~'), 
    array('$1',                                 ','), 
    $block
); 
```

# c# - 在图像中创建可点击区域？

> ID：10194017
> 
> 赞同：7
> 
> 时间：2012-04-17T15:17:25.433
> 
> 标签：c#, winforms, image

我必须实施一个解决方案，因为我不太了解这种语言（C#），所以我不确定如何进行。

让我解释一下：目标是让用户从一个项目中选择一个区域（它有一个圆形）。所以这个想法是在区域上放一个带有数字的图像（所以最后它看起来像一个时钟），并从用户点击的数字中获取区域。

所以我的问题是：是否可以在图像中创建可点击区域？（或者，如果您对此功能有其他解决方案，我很开放）

提前致谢 ！

编辑 >> 这是一个 WinForm 应用程序，而不是一个网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T18:08:04.910

你为什么不直接实现这样的东西？

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;

public class Zone
{
    public Region Region { get; private set; }
    public Action<MouseEventArgs> Click { get; private set; }

    public Zone(Region zoneRegion, Action<MouseEventArgs> click)
    {
        this.Region = zoneRegion;
        this.Click = click;
    }
}

public class PictureBoxWithClickableZones : PictureBox
{
    private readonly List<Zone> zones = new List<Zone>();

    public void AddZone(Zone zone)
    {
        if (zone == null)
            throw new ArgumentNullException("zone");

        this.zones.Add(zone);
    }

    protected override void OnMouseClick(MouseEventArgs e)
    {
        base.OnMouseClick(e);

        foreach (var zone in this.zones.Where(zone => zone.Region.IsVisible(e.Location)))
            zone.Click(e);
    }
} 
```

如果您有足够的时间，您甚至可以在 Visual Studio 的 WinForms 设计器中制作并使用适当的组件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-30T13:02:46.010

谢谢大家的回答，里面有有趣的东西。

不幸的是，由于我必须非常快速地开发这个，我刚刚创建了一个图像，我将在该图像上捕获 onclick 事件，然后使用 Cursor.Position 捕获用户单击的区域，如下所示：

```
int X = pictureBox.PointToClient(Cursor.Position).X;
int Y = pictureBox.PointToClient(Cursor.Position).Y; 
```

也许不是“更清洁”的方式，但它有效！不管怎么说，还是要谢谢你 ！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T15:20:07.760

尽管它不再那么流行，但[您可以使用`<map>`标签](http://www.w3schools.com/tags/tag_map.asp)来执行此操作。

```
<img src="planets.gif" width="145" height="126" alt="Planets" usemap="#planetmap" />

<map name="planetmap">
  <area shape="rect" coords="0,0,82,126" href="sun.htm" alt="Sun" />
  <area shape="circle" coords="90,58,3" href="mercur.htm" alt="Mercury" />
  <area shape="circle" coords="124,58,8" href="venus.htm" alt="Venus" />
</map> 
```

**编辑：**

由于这需要 WinForms 解决方案，也许本文可以帮助您。

[C# Windows 窗体 ImageMap 控件](http://www.codeproject.com/Articles/2820/C-Windows-Forms-ImageMap-Control)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T15:19:05.183

研究 Html 图像映射。

将花费您大约 5 分钟的时间来学习如何使用 is。

在标签中，您可以应用和映射属性，而不是定义您的地图区域和链接

这是一个快速的谷歌响应 [http://www.javascriptkit.com/howto/imagemap.shtml](http://www.javascriptkit.com/howto/imagemap.shtml)

# macos - 核心数据 iCloud 同步中的关系完整性和验证

> ID：10194023
> 
> 赞同：6
> 
> 时间：2012-04-17T15:17:42.277
> 
> 标签：macos, cocoa, core-data, sync, icloud

考虑以下简单的实体模型：实体 A 与实体 B 具有一对一的关系，称为*b*。*实体 B 具有称为a*的逆一对一关系。这两种关系都不是可选的。

```
A            B
b  < ----- > a 
```

假设我们有两个设备 (1) 和 (2) 开始完全同步。每个都有一个 A 类对象和一个 B 类对象，它们相互关联。在设备 1 上，我们有对象 A1 和 B1，在设备 B 上，我们有相同的逻辑对象 A1 和 B1。

现在假设在每个设备上进行了模拟更改：

> 在设备 1 上，我们删除 B1，插入 B2，并将 A1 与 B2 关联。然后保存更改。
> 在设备 2 上，我们删除 B1，插入 B3，并将 A1 与 B3 关联。然后保存更改。

设备 1 现在尝试从设备 2 导入事务日志。将插入 B3，并且 A1 将与 B3 关联。到目前为止一切顺利，但 B2 现在留下的关系*a*等于*nil*。*a*关系是非可选的，因此会发生验证错误。

在设备 2 上也会发生类似的情况，因为有两个 B 对象，并且只有一个 A 对象要关联。因此，必须始终存在验证错误，因为 B 对象之一必须将*a*关系设置为*nil*。

更糟糕的是，任何未来的更改都会留下一个错误的 B 对象，因此验证失败。实际上，用户不能通过重置关系自己解决问题。它永久损坏。

问题是，如何解决这样的验证错误？这一切都发生在`NSPersistentStoreDidImportUbiquitousContentChangesNotification`通知被触发之前。这不是您的应用程序 main`NSManagedObjectContext`中的验证错误，而是在将事务日志初始导入持久存储期间发生的验证错误。

我能想到的唯一选择可能是尝试在自定义设置器`setA:`（`validateA:error:`. 但是我不确定是否允许这样的副作用，当我尝试它时，它似乎确实会导致令人讨厌的日志消息。

有谁知道处理这个问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T23:51:38.467

在 Apple 的开发者论坛上查看此线程：

[https://devforums.apple.com/message/641930#641930](https://devforums.apple.com/message/641930#641930)

有苹果员工的回应。简而言之：

1) 这是当前 iOS (5.1) 和 OS X (10.7.3) 版本下 Core Data iCloud 同步中的一个已知错误。

2) 如果关系对于验证谓词是非可选的，则同步将完全停止。因此，您需要暂时删除验证以保持流畅。但是，这样做会使设备的数据不匹配。

3）没有官方的解决方法。一种混乱的方法是维护一个单独的属性来跟踪关系。然后，您需要扫描通过 iCloud 更改的所有对象，如果它为 nil，则修复关系。

我也被这个虫子咬了。与遇到麻烦的客户打交道非常令人沮丧。希望Apple的修复程序很快就会出来......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T10:25:38.177

如果这对其他人有帮助，我在 iCloud 中解决此错误方面取得了更多进展。我所做的是在初始事务日志导入期间禁用验证，并在我的 MOC 保存到我的主商店时再次启用它。当然，我仍然会遇到验证错误，但它们发生在我的 MOC 保存方法中，而不是在核心数据框架的深处，因此我可以修复错误（例如删除无效对象）。

如何“禁用”验证？我这样做的方式是覆盖我的 NSManagedObject 子类中的 KVC 验证方法，我已将其用作所有 Core Data 实体类的根类。

```
-(BOOL)validateValue:(__autoreleasing id *)value forKey:(NSString *)key error:(NSError *__autoreleasing *)error 
{
    if ( ![self.managedObjectContext isKindOfClass:[MCManagedObjectContext class]] ) {
        return YES;
    }
    else {
        return [super validateValue:value forKey:key error:error];
    }
} 
```

在覆盖中，我检查托管对象上下文的类，如果它是我的自定义类，我通常通过链接到超级方法来进行验证。如果它不是我的自定义子类，我返回 YES 以指示有效性。

当然，您可以使这更加细微，但希望您能明白：您尝试确定这是您的应用程序的标准保存之一还是 iCloud 导入保存，并相应地进行分支。

# indexing - 符号链接，我错过了什么吗？

> ID：10194026
> 
> 赞同：0
> 
> 时间：2012-04-17T15:17:47.943
> 
> 标签：indexing, directory, symlink, public

我正在尝试将我`public`的文件夹与其中的`index.php`文件符号链接到`httpdocs`也放置公用文件夹的文件夹。

当我尝试对公用文件夹进行符号链接时，我收到一条错误消息，提醒我`public`文件夹名称已被占用。我也尝试过对`index.php`文件本身进行符号链接，该文件本身有效，但破坏了网站的功能。

这是我在对`public`文件夹进行符号链接时使用的命令。

```
ln -s /var/www/vhosts/mysite.co.uk/httpdocs/public /var/www/vhosts/mysite.co.uk/httpdocs 
```

这是我在符号链接`index.php`文件时使用的命令。

```
ln -s /var/www/vhosts/mysite.co.uk/httpdocs/public/index.php /var/www/vhosts/mysite.co.uk/httpdocs 
```

tldr：当用户访问我的网站时，我想将`index.php`公用文件夹中的文件用作`index.php`文件，而不必使用`mysite.co.uk/public/index.php`. 该`index.php`文件必须保留在`public`文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:22:37.213

如果我理解正确，您想从 访问`index.php`，`httpdocs/public`并且该文件夹已经存在（如第一种情况下的错误所示）。您可以将文件链接到该（现有）文件夹：

```
ln -s /var/www/vhosts/mysite.co.uk/httpdocs/index.php /var/www/vhosts/mysite.co.uk/httpdocs/public/index.php 
```

注意需要指定要链接的文件itlsef

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T09:03:59.663

我已经设法让它工作了！我在文件夹中使用了软符号链接`public/index.php`在`httpdocs`文件夹中创建了一个`index.php`文件`httpdocs`。

```
ln -s /var/www/vhosts/mysite.co.uk/httpdocs/public/index.php /var/www/vhosts/mysite.co.uk/httpdocs/ 
```

然后，我使用以下内容将文件添加到`.htaccess`文件`httpdocs`夹中...

```
Options +FollowSymLinks
<IfModule mod_rewrite.c>
        RewriteEngine on

        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d

        RewriteRule . index.php [L]
</IfModule> 
```

感谢@Attila 支持我并提供帮助！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-17T15:32:19.067

**解决**方案（*如果*`…/public`和`…/httpdocs`.

*   将您的数据`/var/www/vhosts/mysite.co.uk/httpdocs/public`从`/var/www/vhosts/mysite.co.uk/httpdocs`
*   符号链接`/var/www/vhosts/mysite.co.uk/httpdocs`到`…/public`

命令：`ln -s /var/www/vhosts/mysite.co.uk/httpdocs /var/www/vhosts/mysite.co.uk/httpdocs/public`

缺点：

*   无限递归，例如`/var/www/vhosts/mysite.co.uk/httpdocs/public/public/public/public/`

* * *

无法访问`symlink`现有文件/目录。如果可能的话，你会破坏你的树结构。实际上，您正在尝试将目录链接到其父目录。您的系统应该如何解决被覆盖的路径？

例子：

您有一个文件 /a/b/c ，可以执行以下操作：

`ln -s /a/b /a`

系统应该如何解决现在无法访问的文件`/a/b/c`？

将您的数据移动到所需的目录中，而不是尝试破坏您的文件树。

可以将数据挂载到现有目录（原始数据在卸载之前将无法访问），但这对您的情况没有帮助。

# java - tomcat webapp - 我在哪里存储永久文件

> ID：10194027
> 
> 赞同：1
> 
> 时间：2012-04-17T15:17:47.947
> 
> 标签：java, tomcat

我正在开发一个在 Tomcat 上运行的旧 Java Web 应用程序。我知道通常您从使用 Tomcat 的默认服务器配置 (server.xml) 的 webapps 目录运行 Web 应用程序。这个特定的应用程序使用自定义 server.xml 部署到不同的目录，因此每个应用程序需要 1 个 tomcat 实例。我相信最初以这种方式设置的原因是因为每个 Web 应用程序都会生成必须在应用程序重新部署之间保存的文件。

我的问题是 - 有没有办法使用 webapps 目录，但也可以保存某些文件在重新部署应用程序期间不被清除？

这是我们当前的tomcat的布局

```
tomcat/
  servers/
    ourapp/
      output/   # heres where the files go that we save
      ourapp/   # this is the actual webapp (exploded WAR file)
        WEB-INF/
        ... 
```

我想要类似的东西

```
tomcat/
  webapps/
    ourapp/
      output/  # but this is saved between redeploys
      WEB-INF/
    ... 
```

我的最终目标是摆脱自定义 server.xml，因此我们在一个 tomcat 实例上部署多个应用程序。以防万一——我们在 Tomcat 6 上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:21:03.307

`webapps/`如果您希望它们持久存在，我建议不要尝试将这些文件存储在其中。该目录非常不稳定。此外，维护系统的其他开发人员可能没有意识到您已经在那里存储了持久数据，并且可能只是不小心擦除了它。

我`/var/lib`可能会去寻找一个地点`/var/lib/ourapp/...`。或者，`$HOME/.ourapp`如果这对您的服务器环境及其管理方式有意义，您可以将其存储在其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:31:01.490

我建议您将文件保存在`Tomcat`（可能是 outside 或 inside `webapps`）而不是文件系统中的随机目录中。
这样，它以某种方式与您的网络应用程序“捆绑”

# json - 从 Sencha touch 中的列表创建另一个列表

> ID：10194029
> 
> 赞同：1
> 
> 时间：2012-04-17T15:18:03.577
> 
> 标签：json, jsonp, sencha-touch-2

我被困在看似简单的事情上，

我是整个 Sencha 触摸环境的新手，仍然需要了解很多事情。

这是我面临的问题，

我已经从 Sencha 主页构建了 gettingStarted 应用程序，这个应用程序很简单，它从 JSON 数据加载列表并单击列表中的项目，它显示所选项目的 HTML 内容

我想做的是创建另一个列表，以便

1- 列表一在启动时加载 2- 单击列表 1 中的项目时，它会加载另一个列表 2 3- 在单击列表 2 时，它会加载 HTML 内容。

我已经编写了 web 服务来以 JSON 形式返回数据，我想在此基础上构建第二个列表。

我在 itemTap 上调用了一个函数“showPost”，它看起来像这样：

```
 showPost: function(list, index, element, record){
    Ext.Ajax.request({
        url: 'http://localhost/mobig/ws/search.php?cat='+record.get('category'),            
        success: function(response){
            var text = response.responseText;
            var responses = Ext.JSON.decode(response.responseText);

            alert(responses.posts[0].title);
        }
    }); 
```

我也有，这个：

```
 this.getBlog().setData({
        xtype:'panel',
        title:record.get('category'),
        html:'<img src='+record.get('imageURL')+'/>',
        scrollable:true,
        styleHTMLContent:true
    });
} 
```

它从列表 1 加载 HTML 内容。

提前感谢您的帮助，抱歉英语不好，

如果你能给我一些例子，这将是一个学习的好地方。

谢谢！莫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:10:05.003

节省时间最方便的方法是使用**Ext.NestedList**，但我不推荐它，因为目前 Sencha Touch 2 中的嵌套列表性能仍然很糟糕（滚动、事件捕获等），如果你更关心的话性能，您应该使用**2 个单独的 Ext.List**，例如。list_one 与 store_one 和 list_two 与 store_two，当 list_one 触发`itemtap`事件时，捕获`record`参数并处理它（可能通过读取 a `TreeStore`，或编写您自己的 API，例如[http://yourdomain/api=get_list_two&record_from_list_one=record](http://yourdomain/api=get_list_two&record_from_list_one=record)）

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:26:37.343

听起来您想设置一个嵌套列表。 [这是嵌套列表教程](http://docs.sencha.com/touch/2-0/#!/guide/nested_list)，它应该为您指明正确的方向。

# jquery - Jquery 1.7.1 导致萤火虫错误

> ID：10194030
> 
> 赞同：0
> 
> 时间：2012-04-17T15:18:03.870
> 
> 标签：jquery, firebug

我正在使用 jquery 1.7.1（缩小版）。我在萤火虫中不断收到错误：语法错误，

```
unrecognized expression: > /Scripts/jquery-1.7.1.min.js  Line 3. 
```

我尝试使用 CDN 并收到相同的错误。

当我尝试未缩小的版本时，我也收到一个错误：语法错误，

```
unrecognized expression: > /Scripts/jquery-1.7.1.js Line 4179. 
```

知道为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:36:14.763

只是一个猜测，尝试包含正确的顺序。首先包含 jquery 库，然后包含所有其他 js 文件。我希望是这样的:)

# opencv - 带有 2 个摄像头 VC++ 的 OpenCV

> ID：10194033
> 
> 赞同：3
> 
> 时间：2012-04-17T15:18:12.817
> 
> 标签：opencv, webcam

我正在导入立体视觉的源代码。作者的下一个代码有效。它需要两个摄像机源。我目前有两个不同的相机，我收到图像。两者都有效。它在 capture2 崩溃。有趣的是，如果我更改网络摄像头的顺序（拔下它们并颠倒顺序），第一个摄像头将是第二个摄像头。我们这行不通？我还使用 Windows XP sp3 和 Windows 7 X64 进行了测试。同样的问题。

```
//---------Starting WebCam----------
    capture1= cvCaptureFromCAM(1);
    assert(capture1!=NULL); cvWaitKey(100);
    capture2= cvCaptureFromCAM(2);
    assert(capture2!=NULL); 
```

此外，如果我使用 -1 作为参数，只需给我第一个（一直）。

或使用函数 cvCaptureFrom 捕获两个摄像头的任何方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T16:00:11.557

某些主板无法与某些 USB 2.0 相机配合使用。一台 USB 2.0 相机占用 40-60% 的 USB 控制器。解决方案是从 pci2usb 控制器连接第二个 USB 2.0 摄像头

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T15:54:42.020

首先，相机通常从 0 开始编号 - 这只是问题所在吗？

其次，directshow 和多个 USB 网络摄像头在 Windows 中是出了名的糟糕。有时它适用于两个相同的相机，有时只有它们不同。

您还可以尝试在初始化相机之间延迟，有时一个会锁定捕获流，直到它发送数据，防止另一个被检测到。

驱动程序通常认为他们是唯一的摄像头，并做出错误的调用来锁定整个捕获图。在 Windows 中编写正确的驱动程序 + fdirectshow 过滤器非常复杂，这无济于事

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T13:09:02.720

获得 2 个 PS3 Eyes，每个大约 10 欧元，以及免费的 codelaboratories.com SDK，这使您可以支持多达 2 个使用 C、C#、Java 和 AS3 的摄像头，包括。示例等。您还可以获得高达 75 fps @ 640*480 的 FIXED 帧速率。他们的免费驱动程序版本 5.1.1.0177 提供了不错的 DirectShow 组件，但仅适用于单个相机。

其余评论：多机位 DirectShow 驱动程序应该是任何制造商的默认设置，不提供这是直接失败将 USB 的非常基本的 PORPUSE 和功能实现为接口。与为特定传感器/芯片组实现驱动程序本身相比，它也非常容易实现。

确认可以成对工作的替代方案（通过 DirectShow）：

*   Microsoft Lifecam HD Cinema（如果可以，请使用通用 UVC 驱动程序，fps 限制较少）
*   Logitech Webcam Pro 9000（不要与 QuickCam Pro 9000 混淆，后者不起作用）
*   创意VF0220
*   创意VF0330
*   峡谷 WCAMN-1N

如果您对自己的工作很认真，请购买一对机器视觉相机以获得性能。市场上最便宜的，具有德国工程质量、CCD、CMOS、单色、彩色、GigE（以太网）、USB、FireWire，以及一系列优秀的专用驱动程序：

[http://www.theimagingsource.com](http://www.theimagingsource.com)

# active-directory - 属性“attributeMapFailedPasswordAnswerLockoutTime”无法映射到架构属性“lockoutTime”，因为该属性已在使用中

> ID：10194034
> 
> 赞同：0
> 
> 时间：2012-04-17T15:18:18.540
> 
> 标签：active-directory, adam, activedirectorymembership

我正在尝试使用 ADMembershipProvider 连接到本地 ADAM 服务器，但标题中出现错误。如果我删除启用密码重置及其依赖的属性，我就可以连接。

我试图用谷歌搜索它，但没有任何结果。以下是我的提供商配置。任何建议将不胜感激。

```
<providers>
    <add name="AspNetActiveDirectoryMembershipProvider"
      type="System.Web.Security.ActiveDirectoryMembershipProvider, System.Web, Version=3.5.0.0,               Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
      connectionStringName="ADService"
      connectionUsername="[username]"
      connectionPassword="[password]"
      connectionProtection="Secure"
      enableSearchMethods="true"
      enablePasswordReset="true"
      requiresQuestionAndAnswer="true"
      applicationName="/"
      description="Default AD connection"
      requiresUniqueEmail="true"
      clientSearchTimeout="30"
      serverSearchTimeout="30"
      attributeMapPasswordQuestion="department"
      attributeMapPasswordAnswer="division"
      attributeMapFailedPasswordAnswerCount="badPwdCount"
      attributeMapFailedPasswordAnswerTime="badPasswordTime"
      attributeMapFailedPasswordAnswerLockoutTime="lockoutTime"
      attributeMapEmail = "mail"
      attributeMapUsername = "userPrincipalName"
      maxInvalidPasswordAttempts = "5"
      passwordAttemptWindow = "10"
      passwordAnswerAttemptLockoutDuration = "30"
      minRequiredPasswordLength="7"
      minRequiredNonalphanumericCharacters="1"/>
  </providers> 
```

仅供参考...与类似结果最接近的是有人在类似属性上遇到此错误，他刚刚重新启动了机器。那对我不起作用。我确实也找到了这篇文章[http://blogs.msdn.com/b/dansellers/archive/2005/10/20/483272.aspx](http://blogs.msdn.com/b/dansellers/archive/2005/10/20/483272.aspx)，但我正在努力让 LDAP 管理员进行此更改。特别是因为我们已经拥有这些属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T21:38:50.673

我终于让 LDAP 管理员执行以下链接中的步骤，我们已经启动并运行。

[http://blogs.msdn.com/b/dansellers/archive/2005/10/20/483272.aspx](http://blogs.msdn.com/b/dansellers/archive/2005/10/20/483272.aspx)

# java - 将对象与反序列化对象进行比较

> ID：10194036
> 
> 赞同：0
> 
> 时间：2012-04-17T15:18:18.720
> 
> 标签：java, object, serialization, equals

我有一个带有 JList 的 Swing 应用程序，它与自定义列表模型一起使用。

该模型有一个 ArrayList 来存储使用的对象。情况如下：

关闭应用程序后，listmodel 中的所有对象都被序列化（默认情况下，该类只实现`Serializable`），并通过`ObjectOutputStream`. 当应用程序启动时，从文件中读取所有对象并`ListModel`再次存储在我的自定义中。

我正在尝试添加一项功能，让用户也可以从他指定的文件中导入对象。另一个类中的静态方法从文件中读取所有对象，并以`ArrayList`. 然后，我在我的`MainForm`类中使用 for-each 循环将每个对象从返回`ArrayList`的`ListModel`. 在循环中，我想检查是否`ListModel`已经包含某个对象，**但这不起作用**。

在代码中，我正在执行以下操作：

```
for(MyObject o: readObjects) {
    if(!myListModel.contains(o)) //listmodel just calls contains() on its ArrayList
        myListModel.addElement(o);
} 
```

但是，即使对象已经在 ArrayList 中（我一直从同一个文件中导入对象），它们**仍然会被添加。**

问题是，**反序列化时为什么对象不再相等，有没有办法比较它们？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:43:18.977

这是一个简单的java对象

```
public class MyObject {

private String firstname;
private String lastname;
private String email;

public String getFirstname() {
    return firstname;
}
public void setFirstname(String firstname) {
    this.firstname = firstname;
}
public String getLastname() {
    return lastname;
}
public void setLastname(String lastname) {
    this.lastname = lastname;
}
public String getEmail() {
    return email;
}
public void setEmail(String email) {
    this.email = email;
}

@Override
public int hashCode() {
    final int prime = 31;
    int result = 1;
    result = prime * result
            + ((firstname == null) ? 0 : firstname.hashCode());
    result = prime * result
            + ((lastname == null) ? 0 : lastname.hashCode());
    return result;
}
@Override
public boolean equals(Object obj) {
    if (this == obj)
        return true;
    if (obj == null)
        return false;
    if (getClass() != obj.getClass())
        return false;
    MyObject other = (MyObject) obj;
    if (firstname == null) {
        if (other.firstname != null)
            return false;
    } else if (!firstname.equals(other.firstname))
        return false;
    if (lastname == null) {
        if (other.lastname != null)
            return false;
    } else if (!lastname.equals(other.lastname))
        return false;
    return true;
}
} 
```

（由eclipse自动生成的hashcode和equals）

如果您查看 equals() 方法，您将看到在字段 firstname 和 lastname 上比较了 2 个对象，并且只有这 2 个。这意味着如果您在列表中插入这种类型的对象，您将能够使用`contains(Object o)`和如果一个对象包含相同的名字和姓氏，你会找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:38:56.177

您需要覆盖对象的 equals 和 hashcode 方法（SO 上有许多示例，例如[这里](https://stackoverflow.com/questions/27581/overriding-equals-and-hashcode-in-java).

完成此操作后，`contains`List 的方法将按您预期的方式运行。您的问题似乎与序列化无关。换句话说，下面的代码：

```
List<MyObject> list = new ArrayList<MyObject>();
list.add(new MyObject());
System.out.println(list.contains(new MyObject())); 
```

如果您不覆盖 equals & hashcode，将打印 false，而如果您这样做，它可能会打印 true（取决于您的 equals 方法是否认为这两个`new MyObject()`相等）。您的 IDE 应该有一种方法可以为您自动生成代码。

一旦您对该`contains`方法在您的对象上按预期工作感到满意，序列化/反序列化应该按预期工作。

# java - web.xml 中的 Java 错误页面不适用于所有请求

> ID：10194039
> 
> 赞同：0
> 
> 时间：2012-04-17T15:18:38.337
> 
> 标签：java, spring, error-handling, web

是否可以设置错误页面，但不应该为所有 URI 触发，但例如使用 /custom-path 触发，并且对于使用 URI 的 /main-path 的请求不处理错误？

在 web.xml 中，我想只能将错误页面与某些异常类型匹配。

问题是我们只有一个单一的war 文件，里面有rest api 和html 管理UI。因此，如果错误来自rest api，则应按原样呈现，并且不应显示错误页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T22:13:51.117

我遇到了同样的问题，我通过在 HttpServletResponse 上调用 setStatus() 而不是抛出异常或调用 sendError() 来解决它。

我的 Spring MVC 控制器示例：

```
@RequestMapping(value = "/{ean}", method = RequestMethod.GET)
@ResponseBody
public User getUser(@PathVariable("id" Long id, HttpServletResponse response) {

    // response.sendError(HttpServletResponse.SC_NOT_FOUND)
    response.setStatus(HttpServletResponse.SC_NOT_FOUND)
} 
```

这样我的 RESTful API 控制器就不会呈现错误页面。

# java - 强制更新 JList

> ID：10194042
> 
> 赞同：0
> 
> 时间：2012-04-17T15:18:48.040
> 
> 标签：java, swing, jlist

当我编辑列表中对象的数量并且 toString 发生更改时，如何使用新的 toString 更新列表？

例如，当我更改 JTree 中的节点时，我使用 nodeChanged(node) 更改列表项时该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T15:23:43.883

[`AbstractListModel#fireContentsChanged`](http://docs.oracle.com/javase/7/docs/api/javax/swing/AbstractListModel.html#fireContentsChanged%28java.lang.Object,%20int,%20int%29)如果你从`AbstractListModel`.

这与您上一个问题的原理相同`JTree`。`AbstractListModel`不知道您的对象的某些内部属性何时更改。因此，当您进行更改时，您必须调用指示对象已更改的特定方法。列表模型将触发 接收到的正确事件，该事件`JList`将更新/重绘（无论您想如何称呼它）。

就我个人而言，我更喜欢创建`ListModel`自包含的 s，例如，如果您在更改时使用触发事件的对象`ListModel`可以侦听这些更改并触发适当的事件本身，而不必在外部调用此方法。

*编辑*

刚刚注意到该特定方法受到保护，因此您需要按照我的建议创建模型，并且您不能在外部调用该方法（这是一件好事）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:22:20.943

List.updateUI() 会这样做，尽管有人告诉我这有一些开销。

# java - 在 kannel 中发送阿拉伯语短信

> ID：10194047
> 
> 赞同：3
> 
> 时间：2012-04-17T15:19:06.443
> 
> 标签：java, grails, character-encoding, sms, kannel

我正在尝试从 kannel 发送阿拉伯语短信（或法语短信），但在对 bearebox、smsbox 和smsc 我发现编码错误发生在我的 Bearbox 和 smsbox 之间。

我已经`charset=utf-8&coding=2`在我的 http 请求中使用了发送短信，但出现了同样的问题

有没有人知道问题是什么或更好的解决方案？

这是我用来发送短信的代码

```
StringBuffer param = new StringBuffer()
       param.append("http://localhost:1025/cgi-bin/sendsms?")
       param.append(URLEncoder.encode("username","UTF-8")).append("=").append(URLEncoder.encode("xxx","UTF-8"))
       param.append("&").append(URLEncoder.encode("password","UTF-8")).append("=").append(URLEncoder.encode("xxxx","UTF-8"))
       param.append("&").append(URLEncoder.encode("to","UTF-8")).append("=").append(URLEncoder.encode(numTel,"UTF-8"));
       param.append("&").append(URLEncoder.encode("charset","UTF-8")).append("=").append(URLEncoder.encode("utf-8","UTF-8"))

       param.append("&").append(URLEncoder.encode("coding","UTF-8")).append("=").append(URLEncoder.encode("2","UTF-8"))
       param.append("&").append(URLEncoder.encode("text","UTF-8")).append("=").append(URLEncoder.encode(text,"UTF-8"))
       param.append("&").append(URLEncoder.encode("priority","UTF-8")).append("=").append(URLEncoder.encode(""+priority,"UTF-8"))
       param.append("&").append(URLEncoder.encode("dlr-mask","UTF-8")).append("=").append(URLEncoder.encode("31","UTF-8"))
       param.append("&").append(URLEncoder.encode("dlr-url","UTF-8")).append("=").append(URLEncoder.encode(urlString,"UTF-8"))
       try{
           URL url = new URL(param.toString())
           System.out.println("INFO : Opening connection ")
           HttpURLConnection urlconnection = (HttpURLConnection) url.openConnection()
           System.out.println("INFO : Connection openned")
           BufferedReader input = new BufferedReader( new InputStreamReader(urlconnection.getInputStream()))
           String inputLine

           while ((inputLine = input.readLine()) != null)
               aResult.append(inputLine)
           input.close()
       }catch(Exception e){
           e.printStackTrace()
           return false
       }

       System.out.println("response : "+aResult.toString())
       System.out.println("INFO : all sent disconnect.")
' 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T12:19:07.110

我已经能够使用这个 http 请求示例发送阿拉伯语/法语短信：

```
StringBuffer param = new StringBuffer()
       param.append("http://localhost:1025/cgi-bin/sendsms?")
       param.append(URLEncoder.encode("username","UTF-8")).append("=").append(URLEncoder.encode("xxx","UTF-8"))
       param.append("&").append(URLEncoder.encode("password","UTF-8")).append("=").append(URLEncoder.encode("xxxx","UTF-8"))
       param.append("&").append(URLEncoder.encode("to","UTF-8")).append("=").append(URLEncoder.encode(numTel,"UTF-8"));

       param.append("&").append(URLEncoder.encode("coding","UTF-8")).append("=").append(URLEncoder.encode("2","UTF-8"))
       param.append("&").append(URLEncoder.encode("text","UTF-8")).append("=").append(URLEncoder.encode(text,"UTF-8"))
       param.append("&").append(URLEncoder.encode("priority","UTF-8")).append("=").append(URLEncoder.encode(""+priority,"UTF-8"))
       param.append("&").append(URLEncoder.encode("dlr-mask","UTF-8")).append("=").append(URLEncoder.encode("31","UTF-8"))
       param.append("&").append(URLEncoder.encode("dlr-url","UTF-8")).append("=").append(URLEncoder.encode(urlString,"UTF-8"))
       try{
           URL url = new URL(param.toString())
           System.out.println("INFO : Opening connection ")
           HttpURLConnection urlconnection = (HttpURLConnection) url.openConnection()
           System.out.println("INFO : Connection openned")
           BufferedReader input = new BufferedReader( new InputStreamReader(urlconnection.getInputStream()))
           String inputLine

           while ((inputLine = input.readLine()) != null)
               aResult.append(inputLine)
           input.close()
       }catch(Exception e){
           e.printStackTrace()
           return false
       }

       System.out.println("response : "+aResult.toString())
       System.out.println("INFO : all sent disconnect.") 
```

我不在我的请求中发送“charset”参数我只发送编码参数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:02:52.307

我做了一些研究，我相信如果您指定`coding=2`Kannel 期望消息正文编码为 UTF-16，至少如果我正确理解[这个讨论](http://www.kannel.org/pipermail/users/2011-March/015113.html)的话。
你也应该看看这个[文件](http://www.linkas.it/docs/kannel/Characters,%20Kannel%20&%20MT%20SMS.docx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-01T01:43:09.320

您所要做的就是以下（kannel 版本 1.5）： 1- 在您的 kannel 配置中的 smsc 组下添加 alt-charset="UTF-8" 2- 例如，当发送短信 مرحبا 时，您必须在你的 sendms 命令： text=مرحبا&charset=UTF-8&coding=1

使用 mysql 命令检查您的数据库，因为像 webmin 这样的数据库管理工具可能无法识别阿拉伯字母

# java - 转义 XML 字符的最佳实践？

> ID：10194049
> 
> 赞同：1
> 
> 时间：2012-04-17T15:19:12.323
> 
> 标签：java, xml, jakarta-ee, escaping, dom4j

我有要转换为 Dom4J 文档的 html 数据。

我遇到了一个错误：

```
org.dom4j.DocumentException: Error on line 1 of document  : Reference is not allowed in prolog. Nested exception: Reference is not allowed in prolog.
    at org.dom4j.io.SAXReader.read(SAXReader.java:482)
    at org.dom4j.DocumentHelper.parseText(DocumentHelper.java:278)
    at MonTest.main(MonTest.java:21)
Nested exception: 
    org.xml.sax.SAXParseException: Reference is not allowed in prolog. 
```

这是一个字符“&”，我需要转义到 & amp; 为了构建文档。

在 XML 中，似乎我们需要转义 5 个字符：(gt, lt, quot, amp, apos)

然而，我怎样才能逃脱它，而不将它转义到“节点”元素中：

```
<div id="test" class='toto'>A&A<A"A</div> 
```

应该给：

```
<div id="test" class='toto'>A&amp;A&lt;A&quot;A</div> 
```

并不是

```
&lt;div id=&quot;test&quot; class=&apos;toto&apos;&gt;A&amp;A&lt;A&quot;A&lt;/div&gt; 
```

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T13:01:34.253

在添加到 XML 文档之前转义字符串。使用来自 Apache Commons Lang 的 StringEscapeUtils.escapeXml 方法。使用一些库来构建 XML，例如[http://code.google.com/p/joox/](http://code.google.com/p/joox/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T09:03:54.190

我会看看使用宽松的 HTML XMLReader 而不是默认的 XMLReader 实现。像[tag soup](http://ccil.org/~cowan/XML/tagsoup/)或[html tidy](http://tidy.sourceforge.net/)这样的东西。

# php - 如何查看php中加解密函数的源码？

> ID：10194050
> 
> 赞同：0
> 
> 时间：2012-04-17T15:19:12.487
> 
> 标签：php, xampp, mcrypt

我想查看PHP使用的各种加解密函数的源码。我该怎么做？我使用 Xampp。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:20:25.083

您从 PHP 站点下载[源代码](http://php.net/downloads.php#v5)并进行检查。

它也可以在线搜索和索引：http: [//lxr.php.net/](http://lxr.php.net/)

# php - mysqli_multi_query 未插入 mysql 数据库

> ID：10194058
> 
> 赞同：2
> 
> 时间：2012-04-17T15:19:40.060
> 
> 标签：php, mysql, mysqli, mysqli-multi-query

我已经使用了教程、示例并查看了有关我的问题的许多其他问题，但我仍然无法让它工作，我对 PHP 比较陌生，对 PDO 没有任何了解。我已将我的代码更改为 mysqli 而不是 mysql，以摆脱我的大学给我的贬值代码，但在这种情况下它们的帮助不大。

如果有人能为我阐明这个问题，我将不胜感激。以下是我的代码示例：

```
<?php /*connect to the db */
   $link=mysqli_connect("dbhost","user","pass");
   mysqli_select_db("db",$link);

   /*checking connection*/
      if ($link->connect_errno) 
        throw new exception(sprintf("Could not connect: %s", $link->connect_error));

session_start();

        $insert_query="
        INSERT INTO testone_tbl (age,hours,flexibility,fastpaced,retailexp,
        workedus,conviction,permit,education)
        VALUES ('$age','$hours','$flexibility','$fastpaced','$retailexp','$workedus',
        '$conviction','$permit','$education'); 
        INSERT INTO testtwo_tbl 
        (contribute,insales,initiative,success,alternatives,targets,
        newthings,custfeed,incdevelop,standards,confident,stretch,
        opportunities,polite,ideas,deadline,supported,duties)
        VALUES ('$contribute','$insales','$initiative',
        '$success','$alternatives','$targets','$newthings',
        '$custfeed','$incdevelop','$standards','$confident','$stretch',
        '$opportunities','$polite','$ideas','$deadline','$supported','$duties')";

    /*execute multi_query*/

mysqli_multi_query ($link, $insert_query);/*error1*/
/*close connection*/
if(!$link>connect_errno) $link->close(); /*error2*/

?> 
```

数据既来自写入的表单（最后一个表单），也来自先前表单的会话。但是，我也收到此错误：警告：mysqli_multi_query() 期望参数 1 为 mysqli，`Warning: mysqli_close() expects parameter 1 to be mysqli`而过去几天我一直坚持这一点！先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T15:22:59.390

您应该首先检查您的网络主机是否启用了多 SQL 查询。

一些 Web 主机只允许单 SQL 查询以帮助防止注入攻击。

但是，如果你想多次插入同一个表，你可以这样做：

```
INSERT INTO tbl_name (col1, col2)
     VALUES ('?', '?'),
            ('?', '?'),
            ('?', '?'); # inserts 3 records to the same table in one query 
```

此外，如果您确实有可用的 PDO，请使用它！

使用 PDO 对象，您的查询将通过使用准备好的语句更安全。例子：

```
$db = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);

$data = array($col1, $col2, $col3);
$sql = "INSERT INTO tbl_name (col1, col2, col3) VALUES ('?', '?', '?');";
$query = $db->prepare($sql); # prepares the sql statement
$query->execute($data); #binds the array of data to the ?
                        #question mark parameters, and executes. 
```

如果创建数据库抽象层，则可以更改数据库连接模式，而无需重写执行查询的代码。

另外，你有理由不循环和查询吗？例子：

```
$sql_array = array("INSERT INTO tbl_one(col1) VALUES '?';",
             "INSERT INTO tbl_two(col3) VALUES '?';");

function performAll($sql_array) {
    # execute all of the queries
} 
```

我突然想到您可能正在使用某些功能来访问您的数据库连接。现在这不是问题，除非您实际上尝试从函数内访问数据库连接（以防您没有告诉我们）。例子：

```
$db = new PDO("...", $user, $pass);

$query = $db->prepare($sql); # works fine

function executeQuery($sql) {
    $query = $db->prepare($sql); # error: $db is not defined
                                 # within the scope of this function
    ...
} 
```

要解决这个问题，请使用`global`PHP 中的关键字。例子：

```
$db = new PDO("...", $user, $pass);

function executeQuery($sql) {
    global $db; # use $db in the global scope
    $query = $db->prepare($sql); # works fine
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:29:01.130

从警告中可以清楚地看出这`$link`不是 mysqli 对象。要么你没有连接，要么在某个时候你重新分配`$link`给了别的东西。

您还需要在连接后立即检查您的连接。链接上的中间操作（在本例中为`mysqli_select_db`）将清除已设置的所有错误。

您也不应该混合和匹配 mysqli 的面向对象和过程样式接口。面向对象的风格要清晰得多，但是如果更改现有代码太困难，那就坚持程序风格。

像这样连接：

```
$link = mysqli_connect("dbhost","user","pass", "db"); // no need for an extra db select
if (mysqli_connect_errno()) {
    throw new Exception("Could not connect: ".mysqli_connect_error());
} 
```

另外，我希望这不是您的真实代码，因为它对 mysql 注入攻击很开放。考虑完全放弃使用多查询并使用带有占位符的准备好的语句。

# asp.net-mvc - mvc3 从控制器中的视图获取表单数据

> ID：10194059
> 
> 赞同：1
> 
> 时间：2012-04-17T15:19:42.407
> 
> 标签：asp.net-mvc, asp.net-mvc-3

MVC3，查看我有一个标签

```
 <label id="test"></label> 
```

在 jquery 中，我在 .blur 上设置了值。一切正常，但是当我单击提交按钮转到控制器并且我想获取标签中显示的数据时，它显示为空。

我检索数据的方式是使用 FormCollection 类，例如

```
public ActionResult Create(FormCollection collection)
collection["test"] 
```

我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T15:23:52.113

标签不会随表单发布一起提交。

如果您要更新标签的值，您可能还想包含一个隐藏的输入并在那里存储相同的值。然后访问 FormCollection 中的输入。

# javascript - html表单javascript被忽略

> ID：10194061
> 
> 赞同：-1
> 
> 时间：2012-04-17T15:19:46.270
> 
> 标签：javascript, html, validation

我很难将 JavaScript 实现到我的 html 表单中。我在整个过程中都使用了很多 PHP。我即将发布的代码包含在用户访问的单独页面中。这是一个php页面。

该表单当前不包含 action=，它会将其提交到 formposts.php。我把它拿出来看看我的 JavaScript 是否被忽略了，并且表单是在检查 JavaScript 之前发送的。但即使不采取行动，我的表单也不会响应 JavaScript。

在深入细节之前，我使用了简单形式的 JS，只是为了检查它是否有效。我真的需要一些关于如何使这项工作的帮助，我不知道问题出在哪里！

我在打开表单和关闭时包含了脚本调用。onsubmit // onclick 我也尝试过包含一个标签来显示文本。JS 在代码的末尾。你可以忽略一些文本/脚本。我猜是表单的开启，前三种输入类型，表单的关闭和JS都包括在内。我已经取出了一些，因为它是一个长表格。

```
 <p><?php echo $session->getText("profileInfo",$language); ?></p>

<table width="530" border="0">
  <tr>
    <th scope="col" width="40%"><form enctype="multipart/form-data" method="POST" onsubmit="return checkForm()" name="registration">
                                <img src="<?php echo $userDetails['picUrl']; ?>" border="none"> ;</th>
    <th scope="col" width="60%"><h3><?php echo $session->getText("profileMenuPersonal",$language); ?></h3></th>
  </tr>
  <tr>
    <td><h4><?php echo $session->getText("regPic",$language); ?></h4></td>
    <td><input type="file" name="uploaded" id="uploaded" onblur="checkType()"  /> <label id="picMSG"></label> </td>
  </tr>
  <tr>
    <td><h4><?php echo $session->getText("regFname",$language); ?></h4></td>
    <td><input type="text" id="firstName" name="firstName" value="<?php echo $userDetails['firstName']; ?>" /></td>
  </tr>
  <tr>
    <td><h4><?php echo $session->getText("regLname",$language); ?></h4></td>
    <td><input type="text" id="lastName" name="lastName" value="<?php echo $userDetails['lastName']; ?>" /></td>
  </tr>
<tr>   <!--  I have taken some code out for readability of this post -->
    <td><input type="hidden" id="reqtype" name="reqtype" value="personalDetails"  />
        <input type="hidden" id="realUserId" name="realUserId" value="<?php echo $realUserId; ?>" /></td>            
    <td><input type="submit" name="submit" value="update / save" class="button" onclick="return checkForm()" />
        </form>
    </td>
  </tr>
</table>

<script type="text/javascript">

    function checkForm()
    {
        var picture = document.getElementById('uploaded').value;
        var firstName = document.getElementById('firstName').value;
        var lastName = document.getElementById('lastName').value;
        var email = document.getElementById('email').value;
        var address1 = document.getElementById('address1').value;
        var address2 = document.getElementById('address2').value;
        var postCode = document.getElementById('postCode').value;
        var email = document.getElementById('email').value;
        //      files types that r not allowed
        //      And are considered harming - 
        //      someone purposfully trying to harm the system
        var str1 = ".php"; 
        var str2 = ".js";
        var str3 = ".html"; 
        if(!document.registration.firstName.value)
        {
            alert('please enter name');
            return false;
        }
        if(picture.indexOf(str1) != -1 || picture.indexOf(str2) != -1 || picture.indexOf(str3) != -1)
        { 
            alert("You have tried to upload content that may harm our system. The admin has been contacted and your account flagged. You may be deleted."); 
            return false;
        }
        // allowed file types
        var str1 = ".jpeg"; 
        var str2 = ".gif";
        var str3 = ".png";
        if(picture.indexOf(str1) != -1 || picture.indexOf(str1) != -1 || picture.indexOf(str1) != -1 )
        {
            return true;
        }else{
                alert("We only allow jpeg, gif and png files to be uploaded."); 
                return false;
        }

    }
    function checkType()
    {
        var picture = document.getElementById('uploaded').value;
        var element = document.getElementById('picMSG').value
        //      files types that r not allowed
        //      And are considered harming - 
        //      someone purposfully trying to harm the system
        var str1 = ".php"; 
        var str2 = ".js";
        var str3 = ".html"; 
        if(picture.indexOf(str1) != -1 || picture.indexOf(str2) != -1 || picture.indexOf(str3) != -1)
        { 
            element.innerHTML = "invalid type";
            element.style.color = "red";
        }
        // allowed file types
        var str1 = ".jpeg"; 
        var str2 = ".gif";
        var str3 = ".png";
        if(picture.indexOf(str1) != -1 || picture.indexOf(str1) != -1 || picture.indexOf(str1) != -1 )
        {
            return true;
        }else{

        }
    }
</script> 
```

有谁知道为什么我的“简单” JS 被忽略了？

我是 PHP 和 JS 的新手。但我会认为这是一项简单的任务。我在做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:54:05.507

这是我的疯狂猜测...在我将您的代码剥离后... [http://jsfiddle.net/VVYR3/15/](http://jsfiddle.net/VVYR3/15/)

将您的提交按钮更改为：

`onclick="checkForm()"`而不是`onsubmit="return checkForm()"`（一旦你开始工作，你可以进一步试验）

最**重要**的是你的脚本不应该在你的表单之后，而是把它放在`<HEAD>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:39:12.960

由于您删除了部分代码，因此很难为您调试它，但我还是尝试了，并且在提交时调用了 checkForm。它失败了

```
var email = document.getElementById('email').value; 
```

因为没有 ID 为“email”的元素可用于查找值。

不过，您的验证有点草率，那么一个名为 jpg.exe 的文件呢。它会像现在的代码一样通过。

您是否考虑过不重新发明轮子而使用经过测试的框架？那里有很多，它们甚至还有漂亮的 ajax 功能。像这样：http: [//valums.com/ajax-upload/](http://valums.com/ajax-upload/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:45:26.627

我假设你必须这样做

`<input type="submit" name="submit" value="update / save" class="button" onclick="checkForm()" />`

代替

`<input type="submit" name="submit" value="update / save" class="button" onclick="return checkForm()" />`

* * *

尝试改变

`if(!document.registration.firstName.value)`

进入 `if(firstName == "")`

和（每个）

`picture.indexOf(str1) != -1`

进入 `picture.search(str1) == -1`

并检查它是否有效>。>

# mysql - 如何查询一个表（该表具有与单个实体相关的多行）并返回 GROUPED 结果，但仅在满足所有条件的情况下返回？

> ID：10194067
> 
> 赞同：2
> 
> 时间：2012-04-17T15:19:56.777
> 
> 标签：mysql

首先，请原谅这个非常模糊/冗长的问题，我真的不确定如何在没有完整解释的情况下总结我的查询。

好的，我有一个 MySQL 表，格式如下

**一些表**

*   用户身份
*   some_key
*   一些值

如果您想象，对于每个用户，有多个行，例如：

```
1   |  skill   |   html
1   |  skill   |   php
1   |  foo     |   bar
2   |  skill   |   html
3   |  skill   |   php
4   |  foo     |   bar 
```

如果我想找到所有将 HTML 列为技能的用户，我可以简单地执行以下操作：

```
SELECT user_id
FROM some_table
WHERE some_key = 'skill' AND some_value='html'
GROUP BY user_id 
```

很容易。这会给我用户 ID 的 1 和 2。

如果我想找到所有将 HTML*或*PHP 列为技能的用户，那么我可以这样做：

```
SELECT user_id
FROM some_table
WHERE (some_key = 'skill' AND some_value='html') OR (some_key = 'skill' AND some_value='php')
GROUP BY user_id 
```

这会给我使用 ID 的 1、2 和 3。

现在，我正在努力解决的是如何查询同一个表，但这次说“给我所有将 HTML**和**PHP 列为技能的用户”，即：只有用户 ID 1。

非常感谢任何建议、指导或文档链接。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:33:01.943

这是一种方法：

```
SELECT user_id
FROM some_table
WHERE user_id IN (SELECT user_id FROM some_table where (some_key = 'skill' AND some_value='html'))
AND user_id IN (SELECT user_id FROM some_table where (some_key = 'skill' AND some_value='php')) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:31:48.480

我不知道这是否对mysql有效，但应该是（适用于其他数据库引擎）：

```
 SELECT php.user_id 
 FROM some_table php, some_table html 
 WHERE php.user_id = html.user_id 
   AND php.some_key = 'skill' 
   AND html.some_key = 'skill' 
   AND php.some_value = 'php' 
   AND html.some_value = 'html'; 
```

或者，通过使用 HAVING 语句：

```
SELECT user_id, count(*) 
FROM some_table 
WHERE some_key = 'skill' 
  AND some_value in ('php','html') 
GROUP BY user_id 
HAVING count(*) = 2; 
```

第三种选择是使用内部选择。大卫方法的一种替代方法：

```
SELECT user_id FROM some_table
WHERE 
   some_key = 'skill' AND
   some_value = 'html' AND
   user_id IN (
       SELECT user_id FROM some_table 
       WHERE 
           some_key = 'skill' AND
           some_value = 'php' AND 
           user_id IN (
               SELECT user_id FROM some_table 
               WHERE 
                   some_key = 'skill' AND
                   some_value = 'js' -- AND user_id IN ... for next level, etc.
           )
    ); 
```

...想法是您可以“管道”内部选择。对于每个新属性，您都可以将新的内部选择添加到最内部的属性中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T16:05:14.137

您需要使用嵌套查询（或自连接，这是不同的）

我设置了下表。

```
+-------+----------+------+-----+---------+-------+
| Field | Type     | Null | Key | Default | Extra |
+-------+----------+------+-----+---------+-------+
| id    | int(11)  | YES  |     | NULL    |       |
| type  | char(10) | YES  |     | NULL    |       |
| value | char(10) | YES  |     | NULL    |       |
+-------+----------+------+-----+---------+-------+ 
```

插入以下值

```
+------+-------+-------+
| id   | type  | value |
+------+-------+-------+
|    1 | skill | html  |
|    1 | skill | php   |
|    2 | skill | html  |
|    3 | skill | php   |
|    2 | skill | php   |
+------+-------+-------+ 
```

运行此查询

```
select id 
from test 
where type = 'skill' 
and value = 'html' 
and id in (
select id 
from test 
where type = 'skill' 
and value = 'php'); 
```

并得到

```
+------+
| id   |
+------+
|    1 |
|    2 |
+------+ 
```

自加入如下

```
select e1.id
from test e1, test e2
where e1.id = e2.id
and e2.type = 'skill'
and e2.value = 'html'
and e1.type = 'skill'
and e1.value = 'php'
; 
```

并产生相同的结果。

所以你有两种方法可以在你的代码中尝试它。

# android - 自定义复选框

> ID：10194070
> 
> 赞同：0
> 
> 时间：2012-04-17T15:20:08.127
> 
> 标签：android, checkbox

这是我用过的复选框：

![在此处输入图像描述](../Images/0b2af015e14ec44c21897482ee0b055a.png)

这是我用来获取此复选框的内容：

```
<CheckBox
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_centerVertical="true" >
        </CheckBox> 
```

我想自定义我的复选框，使它们变成蓝色，如下所示： ![在此处输入图像描述](../Images/f1c136be125074bab2d6c0a80702536e.png)

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:26:02.263

您想[为您的复选框定义自定义样式](http://www.anddev.org/tutorial_change_look_of_checkbox-t4553.html)。

# c# - 我可以使用 parallel.ForEach 来调用不同的函数吗？

> ID：10194071
> 
> 赞同：4
> 
> 时间：2012-04-17T15:20:15.130
> 
> 标签：c#, asp.net, .net, multithreading, parallel-processing

我有一个运行的 foreach 循环。我正在研究并行函数。是否可以将以下代码转换为使用并行编程？

```
int result ;
int counter;
foreach(DataRow dr in ds.Tables[0].Rows) {
    switch(dr["Gender"].ToString()) {
        case "Male":
            result = functionMale(dr["Gender"].ToString());
            counter += result;
            break;
        case "Female":
            result = functionFemale(dr["Gender"].ToString());
            counter += result;
            break;
        default:
            result = functionUnkown(dr["Gender"].ToString());
            counter += result;
            break;
    }
} 
```

根据我的调查，到目前为止，我只有以下内容。

```
Parallel.ForEach(ds.Tables[0].AsEnumerable(), dr => {
    var result = functionMale(dr["Gender"].ToString();
}); 
```

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T15:27:41.677

你可以使用`AsParallel`and `Sum`：

```
Func<string, int> calculateGender =
    gender =>
    {
        // nb: I don't know why you pass the gender to the method, but
        // I've left your intent as-is
        switch (gender)
        {
            case "Male":   return functionMale(gender);
            case "Female": return functionFemale(gender);
            default:       return functionUnknown(gender);
        }
    };

int counter = ds.Tables[0].AsEnumerable()
                          .AsParallel()
                          .Sum(dr => calculateGender(dr["Gender"].ToString())); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T15:26:58.010

你可以尝试这样的事情，以更实用的风格：

```
var counter = 
    ds.Tables[0].AsEnumerable()
    .AsParallel()
    .Select( dr => {
        var gender = dr["Gender"].ToString();

        switch(gender) 
        {
            case "Male":
                return functionMale(gender);
            case "Female":
                return functionFemale(gender);
            default:
                return functionUnkown(gender);
        }
    })
    .Sum(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:04:02.727

PLINQ 方法要容易得多，但为了完善答案，您将如何使用`Parallel.ForEach`.

```
int counter = 0;
Parallel.ForEach(ds.Tables[0].AsEnumerable(),
  () => /* subtotal initializer */
  {
    return 0; 
  },
  (dr, state, subtotal) => /* loop body */
  {
    switch(dr["Gender"].ToString()) 
    { 
        case "Male": 
            subtotal += functionMale(dr["Gender"].ToString()); 
            break; 
        case "Female": 
            subtotal += functionFemale(dr["Gender"].ToString()); 
            break; 
        default: 
            subtotal += functionUnkown(dr["Gender"].ToString()); 
            break; 
    }
  },
  subtotal => /* subtotal accumulator */
  {
    Interlocked.Add(ref counter, subtotal);
  }); 
```

这是它的工作原理。第一个 lambda 表达式为 TPL 分配的每个工人初始化本地小计箱。第二个 lambda 表达式对集合中的每个项目执行一次，并更新本地小计 bin。第三个 lambda 表达式将局部小计箱合并到最终总数中。

`Parallel.ForEach`使用和使用聚合之间的一个有趣区别在于`AsParallel`小计累积到最终值的方式。`Parallel.ForEach`在工作线程上执行此操作，因此需要线程安全操作`Interlocked.Add`。`AsParallel`使用相同的分区策略，但在调用者线程上累积小计。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T15:24:02.273

当然，这完全有可能。Parallel.ForEach 在这个实例中没有做任何特定的魔法（除了线程），所以它看起来像这样：

```
ds.Tables[0].Rows.AsEnumerable().AsParallel().Sum(x =>
  {
       DataRow dr = x as DataRow;

       switch(dr["Gender"].ToString())
       {
           case "Male":
             // Stuff
           case "Female";
             // Stuff
           default:
             // Stuff
       }

       return counter;
  }); 
```

这应该聚合函数的所有值，因为加法是可交换的。

# android - 添加具有透明背景的图像按钮

> ID：10194072
> 
> 赞同：6
> 
> 时间：2012-04-17T15:20:21.153
> 
> 标签：android, eclipse, background, transparent, imagebutton

我想在我的主应用程序屏幕上添加具有透明背景的图像按钮。我已经在 GIMP 中创建了图像，并将它们保存为 png 格式的透明背景，但是当我在 Eclipse 中将它们添加到我的 android 应用程序时，它们显示为白色背景。如何在我的代码中删除它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T15:22:35.927

尝试使用 null 作为 xml 布局中图像按钮的背景。

```
android:background="@null" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:24:55.677

透明背景通常在 Photoshop 中使用时有效，如果不是，则必须设置图像边框周围像素的 alpha 位

使用**alpha-masking**（alpha blending 的子集，谷歌他们了解更多）。

**一点理论：** 根据位图中每个像素的 alpha 位（半透明位），确定该像素与覆盖像素的混合程度。考虑到极端情况，如果 alpha 为 255，则使用覆盖像素而不是覆盖像素（通常情况下为**完全不透明**）；如果 alpha 为 0，则覆盖像素将被忽略（**透明**）。对于介于两者之间的其他 alpha：有混合。

在您的情况下，您*必须*使边框的 alpha**为零**，以实现完全混合。概述所有步骤：。

1.  要使用的**可绘制对象不能**是 JPEG（JPEG 不存储每个像素的 alpha 值）。去PNG

    2.您**需要**事先以这种方式创建并保持您的位图可绘制（使用 google 进行 alpha 混合 PNG），以使边框的 alpha 值为零（例如使用 Paint.NET 等软件）。

2.  如果图像是动态创建的，则需要使用混合方程（有关详细信息，请阅读 Porter 和 Duff 的材料）。

    例如，这是具有透明像素的 PNG 图像，其 alpha 0 不同于字母本身
    。 ![带有 alpha 混合的原始 PNG](../Images/49b4193b0d2ed723133aa66ab58f6456.png)

![aplha 在彩色背景上混合了 PNG](../Images/36b8e20f5e438cdd20f933eeb66b543a.png)

以上是 Activity 彩色背景上的 alpha 混合 PNG。我希望这是您真正想要实现的目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:22:09.187

你可以设置

```
android:background="@null" 
```

在 XML

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-15T15:26:35.657

我在我的 .aspx 页面上遇到了同样的问题 - 添加一个可以添加到收藏夹功能和从中删除的功能。我知道该图像是具有透明背景的 .gif 图像格式 - 但正如这里提到的，它在 IE9 和 Chrome 的浏览器中显示为白色方形背景。

我添加了这个，它解决了这个问题 - 但你必须确保 .gif 或图像确实也有透明背景：

```
<asp:ImageButton runat="server" ID="lnkFavorite" BackColor="Transparent" AlternateText="Add Favorite" CommandName="Favorite"
ImageUrl="Images/MakeFavorite_30.png" ToolTip="Click to add to the My Favorite Threads grid."
    CommandArgument='<%# DataBinder.Eval(Container, "RowIndex") + ";" + Eval("FavoriteUserID")%>' /> 
```

**BackColor="Transparent"**属性为我做到了！我希望这也有帮助！

拉斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-10T14:36:50.713

5年后在这里回答与Android L +的兼容性。

为了在 ImageButton 上使用 PNG（透明）图像作为背景，您应该使用属性`background`而不是`src`

```
 <ImageButton
        android:id="@+id/imageProg"
        android:layout_width="80dp"
        android:layout_height="80dp"
        android:onClick="doStuff"
        android:background="@drawable/ic_stuff" 
```

# javascript - 淘汰foreach循环迭代相同的数据元素

> ID：10194081
> 
> 赞同：3
> 
> 时间：2012-04-17T15:21:22.500
> 
> 标签：javascript, asp.net-mvc-3, knockout.js

我有一个包含 4 个元素的数组，并通过绑定到 foreach 循环来传递。

```
 <ul data-bind="foreach: relatives">
        <li>
            <span data-bind="text: First"></span>
            <span data-bind="text: Last"></span>
            <span>
                <a href="#" class="tag-edit">Edit</a> 
                <a href="#" class="tag-delete">Delete</a>
            </span>
        </li>
    </ul> 
```

出于某种原因，我的输出在我的调试中给了我一个相对的四次我在我的数据数组中只有四个亲戚，我可以观察到。我的 html 显示了多余的条目。很明显，我的数组没有出错，它显然有 4 个元素，但 foreach 循环表现得很奇怪。

使用 Knockout 的 Javascript：

```
var data = [
    { Id: 1, First: "John", Last: "Doe", Address: "76 Hero Ave" },
    { Id: 2, First: "Bill", Last: "Doe", Address: "467 Nantucket Rd" },
    { Id: 3, First: "Sue", Last: "Doe", Address: "467 Nantucket Rd" },
    { Id: 4, First: "Jane", Last: "Doe", Address: "76 Hero Ave" },
];

var viewModel = {
    // data
    relatives: ko.observableArray(data),
    firstNameToAdd: ko.observable(""),
    lastNameToAdd: ko.observable(""),

    // behaviors
    addRelative: function () {
        this.relatives.push({ First: this.firstNameToAdd(), Last: this.lastNameToAdd()        });
        this.firstNameToAdd("");
        this.lastNameToAdd("");
    }
};

$(document).on("click", ".tag-delete", function () {
    var itemToRemove = ko.dataFor(this);
    viewModel.relatives.remove(itemToRemove);
});

ko.applyBindings(viewModel); 
```

从添加的 viewModel 代码块中添加单击删除后，我的列表将不再显示任何内容。我的调试显示我也没有数据，也没有出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:55:00.890

试试这个：

看法

```
<ul data-bind="foreach: relatives">
    <li>
        <span data-bind="text: First"></span>
        <span data-bind="text: Last"></span>
        <span>
            <a href="#" class="tag-edit">Edit</a> 
            <a href="#" data-bind="click: $parent.remove">Delete</a>
        </span>
    </li>
</ul> 
```

Javascript

```
var data = [
    { Id: 1, First: "John", Last: "Doe", Address: "76 Hero Ave" },
    { Id: 2, First: "Bill", Last: "Doe", Address: "467 Nantucket Rd" },
    { Id: 3, First: "Sue", Last: "Doe", Address: "467 Nantucket Rd" },
    { Id: 4, First: "Jane", Last: "Doe", Address: "76 Hero Ave" },
];

​var viewModel = {
    // data
    relatives: ko.observableArray(data),
    firstNameToAdd: ko.observable(""),
    lastNameToAdd: ko.observable(""),

    // behaviors
    addRelative: function() {
        this.relatives.push({
            First: this.firstNameToAdd(),
            Last: this.lastNameToAdd()
        });
        this.firstNameToAdd("");
        this.lastNameToAdd("");

    },

    remove: function(item) {
        viewModel.relatives.remove(item);
    },
};

ko.applyBindings(viewModel);​ 
```

# c# - 将背景颜色设置为 DotNet.Highcharts

> ID：10194084
> 
> 赞同：2
> 
> 时间：2012-04-17T15:21:28.290
> 
> 标签：c#, asp.net-mvc, highcharts

我正在使用 DotNet.HighCharts，我想让我的图表透明。

我在 Javascript 中找到了一个示例，可以通过将 backgroundColor 设置为 null 来实现。

有谁知道 DotNet.HighCharts 中是否有类似的选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:16:55.363

尝试将`backgroundColor`选项设置为`none`：

```
chart: {
            renderTo: 'container',
            backgroundColor: 'none',
            ...
        }, 
```

例如看这个[小提琴](http://jsfiddle.net/quMJc/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T12:35:08.677

在 DotNet.Highcharts 中使用此选项所需的实际代码如下所示：

```
Highcharts chart = new Highcharts("chart")
    .InitChart(new Chart 
        { 
            DefaultSeriesType = ChartTypes.Spline,
            BackgroundColor = null
        }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-29T06:42:09.590

我有点老了，但我遇到了这个问题，我有一个很好的答案。

要在 中设置透明`HighCharts`，这是正确的方法。当然，任何颜色都可以选择`System.Drawing.Color`

**创建一个颜色对象！**然后将其分配给`InitChart`

```
var bgColor = new DotNet.Highcharts.Helpers.BackColorOrGradient(System.Drawing.Color.Transparent);

DotNet.Highcharts.Highcharts chart = new DotNet.Highcharts.Highcharts("chart")            
.InitChart(new Chart { 
                DefaultSeriesType = ChartTypes.Line,
                BackgroundColor = bgColor
            }) 
```

# vb.net - LINQ - 如果父计数 = 1，则查询子对象

> ID：10194085
> 
> 赞同：2
> 
> 时间：2012-04-17T15:21:29.467
> 
> 标签：vb.net, linq

我有以下类结构。

```
Company > List(of Departments) > List(of Employees) 
```

我想查询一家公司，看看它是否有一个具有以下名称的部门以及该部门中具有以下 ID 的员工！

我怎么能查询到这个。我拥有它期望返回一个部门的代码的方式，所以我有它做

```
If Company.Where(function(d) d.Name = 'ABC').First.Where(function(e) e.EmployeeId = 1).Count > 0 
```

但这将错误 `if d.Name = 'ABC'`返回 0 条记录（我希望它返回 1 或 0 条记录！）

`linq`是否有可能在一个声明中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:47:34.353

assuming that a company has multiple departments and a department has multiple employees-- then you could do this.. sorry I'm not using vb syntax:

```
DB.Departments.Where(d=>d.Name=="ABC").SelectMany(d=>d.Employees).Any(e=>e.EmployeeId == 7) 
```

this would tell you if a specific employee was in a specific department name at any of the companies.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T15:59:36.640

```
var employeeExists = (from company in companies
   where company.Name = expectedCompanyName
   from department in company.Departments
   from employee in department.Employees
   where employee.Id == expectedEmployeeId
   select employee.Id).Any() 
```

# zsh - zsh prompt - 检查是否有任何后台作业

> ID：10194094
> 
> 赞同：15
> 
> 时间：2012-04-17T15:22:21.643
> 
> 标签：zsh, background-process, prompt

我正在自定义我的 zsh 提示并发现以下内容来检查是否有任何后台作业：

```
if [[ $(jobs | wc -l) -gt 0 ]]; then # has background job(s)
    number_jobs='J:${cyan}%j${no_color}'
else # no background job(s)
    number_jobs=""
fi 
```

我面临的问题是，代码似乎只在我打开一个新会话时才被评估，而不是在每个命令之后才被评估，这使得它变得毫无用处。如何`number_jobs`在每个命令后重新评估？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-17T15:28:04.730

zsh 有一个特殊的提示序列，比如 C 三元运算符。下面的结构意味着如果有一个或多个作业，则打印它们的编号或不打印：

```
 %(1j.%j.) 
```

# android - 使用 Spinner 启动一个新 Activity

> ID：10194095
> 
> 赞同：1
> 
> 时间：2012-04-17T15:22:22.043
> 
> 标签：android, android-activity, spinner, new-operator, status

我想知道是否有人知道如何开始一项新活动，当您更改微调器的值而无需按下按钮时。
我已经在网上搜索了几个小时，但我找不到任何可以引导我朝着正确方向前进的东西。所以我希望这里有人可以帮助我。

这只是我的标准微调器代码：

```
protected void onCreate(Bundle savedInstanceState) {

    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.share);

    Button view = (Button) findViewById(R.id.button1);
    view.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            startActivity(new Intent("net.thinkbin.TUTORIAL1"));
            overridePendingTransition(0, 0);
            finish();
        }
    });

    Button menu = (Button) findViewById(R.id.buttonhome);
    menu.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            // custom dialog
            final Dialog dialog = new Dialog(context);
            dialog.setContentView(R.layout.custom);

            // set the custom dialog components - text, image and button
            TextView text = (TextView) dialog.findViewById(R.id.text);
            text.setText("Loading...");
            ImageView image = (ImageView) dialog.findViewById(R.id.image);
            image.setImageResource(R.drawable.hourglass);

            dialog.show();
            Thread th = new Thread(new Runnable() {
                public void run() {

                    startActivity(new Intent("net.thinkbin.MENU"));
                    overridePendingTransition(0, 0);
                    dialog.dismiss();
                    finish();

                }
            });
            th.start();
        }
    });

    ArrayAdapter<CharSequence> adapter = ArrayAdapter
            .createFromResource(this, R.array.spinnerfood,
                    android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

    Spinner s = (Spinner) findViewById(R.id.spinner1);
    s.setAdapter(adapter); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:26:30.443

Set `setOnItemSelectedListener`,,,, if select something`onItemSelected`被调用，else`onNothingSelected`被调用

```
 s.setOnItemSelectedListener(new OnItemSelectedListener() {

            @Override
            public void onItemSelected(AdapterView<?> arg0, View arg1,
                    int arg2, long arg3) {
                 String str = (String) arg0.getSelectedItem();

                             //here print selected value...
                 System.out.println("String is :: " + str);

                             //And StartActivity here...

                    Intent intent = new Intent(YourActivity.this,SecondActivity.class);
                    startActivity(intent);

            }

            @Override
            public void onNothingSelected(AdapterView<?> arg0) {
                // TODO Auto-generated method stub

            }
        }); 
```

# r - 提取 RGTK2 中的复选框值

> ID：10194101
> 
> 赞同：0
> 
> 时间：2012-04-17T15:22:45.820
> 
> 标签：r, gtk2

我使用下面的代码为用户创建一个复选框以选中/取消选中它。

```
input.form1.015.checkbox <- gtkCheckButton("15_check") 
```

我想知道如何提取复选框的值（即是否选中）

目前我使用以下内容：

```
gSignalConnect(input.form1.015.checkbox,"clicked",function(widget)print("Hello world1!")) 
```

但我认为这不是很好，因为我需要先获得复选框的初始值。

任何人都可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:32:10.230

该`active`属性保持此值。您可以通过`$`and直接访问它`$<-`，如 in`input.form1.015.checkbox$active <- TRUE`或方法`getActive`and `setActive`。

# sharepoint - Sharepoint - 通过 Chrome 访问 PDF 链接

> ID：10194103
> 
> 赞同：0
> 
> 时间：2012-04-17T15:22:57.627
> 
> 标签：sharepoint, pdf, cross-browser

首先让我声明我对 Sharepoint 的经验为零，所以这可能是一个非常愚蠢的问题。

我昨天开始了一份新工作，入职的一部分是通过他们的 Sharepoint 门户查看公司文献。我注意到，每当我尝试通过 Chrome 访问嵌入的 PDF 链接时，它似乎是一个损坏的链接，并且似乎是在进行谷歌搜索。然而，当我使用 IE 尝试完全相同的步骤时，一切都按预期工作。

如果这会让我看起来有点愚蠢，我不想和老板提起这个！PDF链接是否存在跨浏览器问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T20:07:10.207

Darren，请尝试在 Chrome 中刷新缓存，如有必要，请注销并重新登录您的计算机。我们在 Chrome 上遇到了同样的问题，而谷歌似乎并没有解决这个问题（尽管他们可能会将矛头指向微软）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T12:50:23.080

是的，我对 Chrome 和 Firefox 也有同样的问题 Sharepoint 针对 IE 进行了优化，反之亦然

您也无法使用“签入和签出”功能打开文件，因为只有 IE 才能从 Sharepoint 执行此操作（其他浏览器只会下载文件）

您可以尝试使用诸如 IE-Tab 之类的插件（只需使用 FF 中的 IE 算法和特定站点的 Chrome）但最好将 Sharepoint 与 IE 一起使用

# zend-framework - 这个方法在zend框架中属于哪里？

> ID：10194106
> 
> 赞同：3
> 
> 时间：2012-04-17T15:23:09.763
> 
> 标签：zend-framework

我有一些可重用的函数，我想在控制器中使用它们来操作控制器中的 ajax 数据。因为控制器没有视图（因为它是 AJAX）。我想知道下面的方法在 Zend 框架中的正确位置

```
function blockUnblock($value, $id) {
    $image = ($value == 0) ? 'tick.png' : 'tock.png';
    $alt = ($value == 0) ? 'Yes' : 'No';
    $src = '<a class="toggle" href="#toggle">';
    $src .= '<img src = "/css/images/'.$image.'" alt = "'.$alt.'" data-id = "'.$id.'" data-block = "'.$value.'"/>';
    $src .= '</a>';
    return $src;
} 
```

我需要在各种控制器和操作中重用此方法。

它属于哪个辅助方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:45:57.203

Since your function is formatting html, it belongs to a View Helper in my opinion. I assume you're using AjaxContext with a json format (this would be the reason why you don't need a viewscript for this action). However, you can call any view helper from your controller anyway using:

```
$imageLink = $this->view->blockUnblock($value, $id);
$this->view->imageLink = $imageLink; 
```

And your view helper would look like this:

```
// .../views/helpers/BlockUnblock.php
class Zend_View_Helper_BlockUnblock extends Zend_View_Helper_Abstract
{

    public function blockUnblock($value, $id)
    {
        $image = ($value == 0) ? 'tick.png' : 'tock.png';
        $alt = ($value == 0) ? 'Yes' : 'No';
        $src = '<a class="toggle" href="#toggle">';
        $src .= '<img src = "/css/images/'.$image.'" alt = "'.$alt.'" data-id = "'.$id.'" data-block = "'.$value.'"/>';
        $src .= '</a>';
        return $src;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T16:00:22.827

（至少）有两种方法可以解决这个问题。

首先是创建一个自定义控制器并从中扩展所有其他控制器。这样所有控制器/操作都可以访问此功能。

第二个是创建一个动作视图助手。这将允许在您有权访问视图对象的任何地方调用函数（或类，在这种情况下）。

# java - 单元测试中的请求范围 bean 管理

> ID：10194107
> 
> 赞同：1
> 
> 时间：2012-04-17T15:23:10.640
> 
> 标签：java, spring, unit-testing, junit, scope

在单元测试中有很多关于请求范围管理的问题，主要的答案是不要测试范围管理，因为它是一个 Spring Framework 任务，应该注意它是否正常工作。例如，建议将请求范围替换为 XML 配置文件中的线程或原型类型范围。

对于大多数测试来说已经足够了，没有关于未注册“请求”范围的抱怨，并且测试运行良好。但我确实有一个案例是不够的。

考虑以下情况：

```
@Component
@Scope("request")
public class MyService {

    @Autowired
    private MyComponent component;

    public void doSomething(String param) {
        component.doTheThing(param);
    }
}

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({"classpath:my-scope-tweaks.xml"})
public class MyServiceTest {

    @Autowired
    private MyService service;

    @Autowired
    private MyComponent component;

    @Test
    public void test1() {
        service.doSomething("aaa");

        assertEquals("AAA", component.getTheThing());
    }

    @Test
    public void test1() {
        service.doSomething("bbb");

        assertEquals("BBB", component.getTheThing());
    }

} 
```

我想测试请求范围内的 MyService。`MyComponent`也是请求范围。

# 变体 A

如果我将请求范围替换为`SimpleThreadScope`，那么在两个测试中，我将收到相同的`MyService`and实例`MyComponent`，因此例如`test2()`可能会收到错误的结果，`MyComponent`因为它可能在内部包含之前的一些内部“垃圾”`test1()`

# 变体 B

如果我用原型范围替换请求范围 - 我会遇到我的测试方法正在接收不同实例的`MyComponent`情况`MyService`- 所以我不能对它们执行任何断言。

所以我需要的是一种与测试方法相关的请求范围，其中所有请求范围的 bean 仅在`test1()`方法期间保留，然后被销毁，因此接下来`test2()`将再次创建它们。

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:20:04.237

这可能不是您想要的，但您为什么首先使用 Spring 来管理您的测试类？这对我来说似乎有点矫枉过正。对于单元测试，您不需要 DI 容器。只需模拟依赖项并专注于您正在测试的组件或服务的封装功能。

但是，在使用字段注入时，您将无法做到这一点。您需要转换为构造函数或方法注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-08T16:54:32.770

通过使用`@DirtiesContext`. 这允许您在应用程序上下文中为一个单元测试操作 bean，而不会影响其他单元测试。

[文档](http://docs.spring.io/spring/docs/3.1.4.RELEASE/javadoc-api/org/springframework/test/annotation/DirtiesContext.html)

您的示例注释为`@DirtiesContext`：

```
@Component
@Scope("request")
public class MyService {

    @Autowired
    private MyComponent component;

    public void doSomething(String param) {
        component.doTheThing(param);
    }
}

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({"classpath:my-scope-tweaks.xml"})
public class MyServiceTest {

    @Autowired
    private MyService service;

    @Autowired
    private MyComponent component;

    @Test
    @DirtiesContext
    public void test1() {
        service.doSomething("aaa");

        assertEquals("AAA", component.getTheThing());
    }

    @Test
    @DirtiesContext
    public void test2() {
        service.doSomething("bbb");

        assertEquals("BBB", component.getTheThing());
    }

} 
```

如果你的类中的所有测试方法都需要一个新的上下文，你也可以只注释类，如下所示：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({"classpath:my-scope-tweaks.xml"})
@DirtiesContext(classMode = ClassMode.AFTER_EACH_TEST_METHOD)
public class MyServiceTest {
   //Tests Here...
} 
```

# ruby-on-rails - OAuth 2.0 的 Wordpress 策略

> ID：10194108
> 
> 赞同：4
> 
> 时间：2012-04-17T15:23:14.733
> 
> 标签：ruby-on-rails, ruby-on-rails-3, wordpress, gem, omniauth

我正在开发一个应用程序，该应用程序允许用户使用 Devise 和 Omniauth 进行身份验证，然后将他的社交网络帐户连接到该应用程序。我想添加 Wordpress 集成（他们的网站声明他们支持 OAuth 2.0 身份验证和 REST API 访问）。

不幸的是，该提供商没有 Omniauth 策略。我研究了一些其他的宝石并决定自己写 - 它看起来并不那么复杂。[源代码可以在这里找到](https://github.com/elrosa/omniauth-wordpress)。

我已经添加了所有必需的信息（根据[Wordpress 文档](http://developer.wordpress.com/docs/oauth2/)），然后我已经注册了一个应用 ID 和密码。我在这里遇到了第一个问题——Wordpress 需要一个*实时的公共域作为重定向 URI*。我不想使用一个 - 我想先在开发模式下进行测试，所以 localhost 对我来说很好。我输入了一个虚拟地址，然后将其更改回 localhost（令人惊讶！他们没有在更新时验证它，只是在创建时）。

我已将凭据添加到我的初始化程序（config/initializers/devise.rb）：

```
config.omniauth :wordpress, "my_app_id", "my_app_secret" 
```

它似乎有效 - 我得到了我期望的身份验证对话框，它提到了我的应用程序。但是，当我单击“授权”并被重定向到我的应用程序时，我收到一条错误消息，提示*无效凭据*。

我检查了凭据，但它们是正确的（没有拼写错误，顺序正确）。我已经重置了应用程序机密 - 不走运。我已经创建了另外两个应用程序，但仍然没有。

我已经没有想法了。什么会导致这样的错误？可能是因为redirect_uri中的本地地址吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T12:52:05.317

我怀疑这很容易错过，而且确实如此。Wordpress 的服务器以 JSON 字符串响应，但响应没有被解析为一个。因此 Omniauth gem 在其中找不到访问令牌并引发了*无效凭据*错误。设置正确的内容类型就像一个魅力。

# c# - 如果在 asp.net 向导中验证失败，则取消步骤

> ID：10194110
> 
> 赞同：4
> 
> 时间：2012-04-17T15:23:21.057
> 
> 标签：c#, asp.net

我在我的项目中使用 asp.net 向导，这对我来说是新的。我在向导中的一个步骤中进行了验证。如果验证失败，我不应该允许用户进行下一步。我正在使用一个 asp.net 按钮，它在向导中的步骤之间导航。如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T15:36:50.927

您可以尝试取消向导的 SideBarButtonClick 和 NextButtonClick 事件：

```
 protected void Wizard1_SideBarButtonClick(object sender, WizardNavigationEventArgs e)
  {
    e.Cancel = !ValidateWizardStep(e.NextStepIndex);
  }

  protected void Wizard1_NextButtonClick(object sender, WizardNavigationEventArgs e)
  {
    e.Cancel = !ValidateWizardStep(e.NextStepIndex);
  } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T12:56:58.983

我稍微调整了 Ulises 发送的代码并使其工作。

1.  我`onNextButtonClick`为向导添加了属性

    ```
    <asp:Wizard ID="wizClaimInfo" runat="server" CssClass="wizard" DisplayCancelButton="True" ActiveStepIndex="0" OnNextButtonClick="wizClaimInfo_NextButtonClick"> 
    ```

2.  在代码隐藏中添加了以下事件

    ```
    protected void wizClaimInfo_NextButtonClick(object sender, WizardNavigationEventArgs e) {

            if (!IsValid)
            {
                e.Cancel = true;
            }

        return;
    } 
    ```

并遵循以下链接中的说明。

[http://forums.asp.net/t/1014412.aspx/2/10](http://forums.asp.net/t/1014412.aspx/2/10)

我希望这对将来的某人有所帮助，因为我花了将近 2 天的时间试图弄清楚。特别感谢 Ulises 先生。

# postgresql - 将二进制内容附加到 PostgreSQL 数据库中的 bytea 列

> ID：10194117
> 
> 赞同：1
> 
> 时间：2012-04-17T15:24:03.397
> 
> 标签：postgresql, aggregate-functions, plpgsql

我的情况：

我有一些二进制数据，它们被分成了很多部分。特殊表`FileParts`包含`fileId`、`partNo`和`data`。

我需要把所有部分一起放到另一张桌子上`MyFilesStorage`。

现在我在两种实现之间进行选择：

```
DO $CODE$
declare
  r record;
begin
  UPDATE public.MyFilesStorage SET mainFileData = E''::bytea WHERE id = 'e14a26c0-db4b-47e1-8b66-e091fb3ba199'::uuid;

  for r in ( select data 
             from public.FileParts 
             where fileId = '89cb8598-436b-49b3-bb1c-34534c6d068e'::uuid
             order by partNo ) loop
    UPDATE public.MyFilesStorage SET mainFileData = mainFileData || r.data WHERE id = 'e14a26c0-db4b-47e1-8b66-e091fb3ba199'::uuid;
  end loop;

end;
$CODE$ 
```

我将数据设置为空，然后逐个读取部分并将每个部分附加到主表中。

另一种变体：

```
DO $CODE$
declare
  r record;
  p_result bytea;
begin
  p_result = E''::bytea;

  for r in ( select data 
             from public.FileParts 
             where fileId = '89cb8598-436b-49b3-bb1c-34534c6d068e'::uuid
             order by partNo ) loop
    p_result = p_result || r.data;
  end loop;

  UPDATE public.MyFilesStorage SET mainFileData = p_result WHERE id = 'e14a26c0-db4b-47e1-8b66-e091fb3ba199'::uuid;
end;
$CODE$ 
```

在这里我使用临时变量。第二个更快，但我不知道会占用更多内存吗？首先我需要内存来将所有文件加载到 RAM，那么首先呢？postgre 会在此处加载所有内容：`mainFileData = mainFileData || r.data`？

也许还有另一种方法可以做到这一点，因为这两种变体都**非常慢**？在 oracle 中，我`DBMS_LOB.APPEND`用于此操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:09:13.600

您的方法看起来正确，请在此处查看 PostgreSQL[手册](http://www.postgresql.org/docs/current/interactive/functions-binarystring.html)。

您还可以[定义自己的聚合](http://www.postgresql.org/docs/current/interactive/functions-binarystring.html)来为您完成这项工作：

```
CREATE AGGREGATE bytea_add(bytea)
(
    sfunc = byteacat,
    stype = bytea,
    initcond = E''
); 
```

并且使用一个普通的 SQL，像这样：

```
UPDATE public.MyFIlesStorage SET mainFileData = (
    SELECT bytea_add(data) FROM public.FileParts
     WHERE fileId = '89cb8598-436b-49b3-bb1c-34534c6d068e'::uuid
     -- ORDER BY partNo -- ORDER BY partNo will not work
 )
 WHERE id = 'e14a26c0-db4b-47e1-8b66-e091fb3ba199'::uuid; 
```

**编辑：**

```
UPDATE public.MyFilesStorage mfs SET mainFileData = fp.all_data
  FROM (
    SELECT bytea_add(data) OVER (ORDER BY partNo) AS all_data,
           rank() OVER (ORDER BY partNo DeSC) AS pos
      FROM public.FileParts
     WHERE fileId = '89cb8598-436b-49b3-bb1c-34534c6d068e'::uuid
 ) AS fp
 WHERE fp.pos = 1
   AND mfs.id = 'e14a26c0-db4b-47e1-8b66-e091fb3ba199'::uuid; 
```

您可以单独检查内部 SQL 的输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T19:44:33.717

第一个版本较慢，因为 PostgreSQL 不在存储级别进行就地更新，它为每个 UPDATE 创建一个新版本的行。因此，对于以 10Mb 为增量从 0Mb 到 100MB 的行，真正写入磁盘的不是 10x10Mb 而是： 10Mb+20Mb+30Mb+...+90Mb+100Mb = **550Mb**。另一方面，内存消耗将保持低水平，一次分配的内存不超过 10Mb。

第二个版本更快，只有 100Mb 可写入，但需要在内存中分配 100Mb。

The structure of the `FileParts` table with ordered chunks is generally easier to manage for large contents, why bother to convert it into the monolithic other structure?

# ios - 使用 Sencha touch 2 在 UIWebView 中选项卡切换太慢

> ID：10194119
> 
> 赞同：0
> 
> 时间：2012-04-17T15:24:13.343
> 
> 标签：ios, uiwebview, sencha-touch-2

我在我的 ios 应用程序中使用 sencha touch 2。但是选项卡面板太慢了，有一个选项卡包含很多内容，但是所有选项卡都很慢（在选项卡高亮和页面转换之间存在延迟，切换大约需要 1 秒）。

我尝试了`deferredRender`参数，但没有帮助。

我应该如何编写我的 tabPanel 以使其更快？

注意：同一页面在 android 上切换选项卡的速度更快，尽管在其他所有方面 android webview 都较慢

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:01:10.997

这个问题和你的很相似：

[PhoneGap 1.4 包装 Sencha Touch 2.X - 性能如何？](https://stackoverflow.com/questions/10085637/phonegap-1-4-wrapping-sencha-touch-2-x-what-about-performance/10085756#10085756)

正如我在该主题中所说，通常 Android 在视图之间的转换更快，但其他效果（尤其是滚动）比 iOS 慢得多。

现在我知道的唯一解决方案是**保持你的 DOM 轻量级**。不要尝试创建所有可能出现在您的应用程序中的视图并稍后通过**setActiveItem()**调用它们，因为它会极大地扩大您的 DOM。当您切换到新选项卡时，我建议您应该销毁所有其他选项卡的子组件（并且只保留一些变量，如果您想在切换回来时恢复它们的状态）。

# android - Android 应用内计费错误：无法购买此项目。（错误代码：IAB-DPTL）

> ID：10194120
> 
> 赞同：6
> 
> 时间：2012-04-17T15:24:14.093
> 
> 标签：android, google-play, in-app-billing, error-code

我刚刚开始使用安卓应用内计费系统。我测试了地下城应用程序示例，没有任何问题。

所以我试图将应用内集成到我自己的应用程序中，但是当我使用声明的 productId 或静态测试 id 时，我得到了同样的错误：

```
无法购买此项目。（错误代码：IAB-DPTL）

```

该应用程序已经上市。我上传了一个签名版本，我也在手机上推送了（所以两边的版本都是一样的）。我添加了在手机上使用的电子邮件作为测试帐户。我应该激活我的应用程序吗？（有删除当前发布的应用程序的风险？）

我看不到我缺少什么，也无法在网络上找到有关此错误代码的任何信息。

我做错了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-18T16:11:54.083

好的，我找到了解决方案！

该错误是由我在购买请求期间与 productId 关联的“payloadContent”直接引起的。

我曾经将我的可购买项目转换为 JSON 并将其作为开发人员有效负载内容。（认为​​对恢复阶段有用......）

我测试了删除这个payloadContent，然后我没有更多问题了。

我认为在不同事务中使用的数据格式是 JSON，因此 JSON 有效负载内容字段应该会干扰一些等待的字段..（例如“标题”或“链接”）

更新：

正如 Nikolay Elenkov 所说，错误很可能是由有效载荷的长度引起的，而 JSON 似乎可以工作。所以开发者有效载荷大小有一个限制：256 个字符。

我们认为错误代码：“IAB-DPTL”直接表示：“In App Billing - Developer Payload Too Long”

谢谢尼古拉！

# java - 同一包中的类

> ID：10194121
> 
> 赞同：8
> 
> 时间：2012-04-17T15:24:18.483
> 
> 标签：java, intellij-idea

我喜欢 Intellij IDEA，但我一直被 Java 导入的一个小问题所困扰。例如，有一个名为“example”的包和两个不同的类：A.java 和 B.java。

我想在没有进口的情况下从“B”类访问“A”类。像这样：

A类：

```
package example;

public class A{ ... some stuff here ...} 
```

B类：

```
package example;

public class B{
    public static void main(String[] args){
        A myVar = new A();
    }
} 
```

这段代码可能不起作用，但没关系。只是 IDE 及其导入类的机制存在问题。

所以，问题是我看不到 B 的 A 类。Idea 说“无法解析符号”，但我实际上知道包中存在 A 类。下一个奇怪的是编译器工作正常，没有例外。只是IDEA看不到同一个包中的类。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-17T15:29:16.657

如果它们在同一个包中，则无需导入即可访问 B 类中的 A：

```
package example;

public class B{
    public static void main(String[] args){
        A myA = new A();
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-10T21:33:38.307

也许这会帮助你，或者其他使用 IntelliJ 的人收到“无法解析符号”错误但仍然可以编译他们的代码。

假设您有[buymypies](https://stackoverflow.com/questions/10194121/classes-in-same-package/10194378#10194378)编写的两个文件，标准 Java 约定是这两个文件将存在于源代码区域的示例目录中，例如`/myprojectpath/src/Example`. 但从技术上讲，在源目录结构中反映包结构并不是必需的，只是一种最佳实践。

因此，如果您不模仿包结构，而这两个文件只是在 . `/myprojectpath/src`，IntelliJ 会给您“无法解析符号”错误，因为它希望源代码结构反映包结构，但它会编译好。

我不确定这是否是您的问题，但我确实使用 IntelliJ 并且已经看到了这一点，因此值得一看。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-03-20T11:57:18.100

我有同样的问题：同一个包中有两个类，但是当一个类尝试调用另一个类时，Intellij 用红色下划线并说无法解析符号“类名”，例如无法解析符号“LocalPreferencesStore”。

然后它想在原地添加完全限定的名称——所以它清楚地知道路径——那么为什么它不能只访问类呢？

该模块仍在编译和运行，所以它只是 IDE 的行为奇怪 - 所有红色都非常分散注意力，因为它实际上不是一个错误，它只是 IDEA 抛出了一个奇怪的摇摆不定。

这也是最近的。两周前我根本没有这个问题，现在突然启动了。当然，它可能很快就会自行消失，但这真的很烦人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-02T02:43:52.767

同样的问题，我刚刚修复了它。

我不知道你的文件夹结构。但是，如果您`package example`是手动添加的。那就是问题所在。该包应该与您的文件夹结构相同，这意味着如果您希望将类文件存储在其中`package example`，您必须将您的 java 文件存储在 src 的名为 example 的子文件夹中。

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2012-04-17T15:39:53.743

我认为您需要学习有关 Java 的基础知识。

这是我认为您正在尝试的基本示例：

```
package Example;

public class A
{
    String myVar;

    public String getMyVar()
    {
        return myVar;
    }

    public void setMyVar(String myVar)
    {
        this.myVar = myVar;
    }
} 
```

您需要创建一个 A 的实例。

```
package Example;

public class B
{

    /**
     * @param args
     */
    public static void main(String[] args)
    {
        // TODO Auto-generated method stub
        A myA = new A();

        myA.setMyVar("Hello World!");

        System.out.println(myA.getMyVar);
    }

} 
```

查找 java 'getters' 和 'setters'。

# matlab - 向量化 for 和 if 循环

> ID：10194122
> 
> 赞同：1
> 
> 时间：2012-04-17T15:24:47.657
> 
> 标签：matlab, if-statement, for-loop, vectorization

我知道矢量化代码比使用循环更快，所以我一直在尝试使用此代码。我希望有人能告诉我如何改进这些`for`和`if`循环。该程序旨在计算房屋的电力负荷曲线，同时考虑不同的电器在一天、一个月和一年的不同时间是打开还是关闭。

、等是概率矩阵`ProbFanSummerWd`，`ProbCellChargerSummerWd`用于根据先前的随机“选择”来决定电器是打开还是关闭；`TotalLoad`是合成功率曲线。这个函数在一个较大的程序中会重复很多次，并且会消耗很多时间。

我该如何改进这些`for`和`if`循环？如何用矢量化替换它们？

我希望有人能帮助我。非常感谢。

```
HourCount = 0;
for DayYear = 1:size(Season,2)                              %LOOP - ONE YEAR

    if Season(DayYear) == 1                                 %LOOP - SUMMER SEASON

        if WeekDay(DayYear)>=1 && WeekDay(DayYear)<=5       %SUMMER WEEKDAY

            for Hour = 1:24                                 %LOOP - ONE DAY
                HourCount = HourCount+1;

                for h = 1:NumHouse                          %LOOP - HOUSE

                    Choose = rand(1);                   %CellCharger
                    if Choose <= ProbCellChargerSummerWd(Hour)
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ PowCellCharger;
                    else
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ StandByCellCharger;
                    end
                    Choose = rand(1);                       %Fan
                    if Choose <= ProbFanSummerWd(Hour)
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ PowFan;
                    else
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ StandByFan;
                    end
                    Choose = rand(1);                       %Fridge
                    if Choose <= ProbFridgeSummerWd(Hour)
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ PowFridge;
                    else
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ StandByFridge;
                    end
                    Choose = rand(1);                       %Heater
                    if Choose <= ProbHeaterSummerWd(Hour)
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ PowHeater;
                    else
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ StandByHeater;
                    end
                    Choose = rand(1);                       %Iron
                    if Choose <= ProbIronSummerWd(Hour)
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ PowIron;
                    else
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ StandByIron;
                    end
                    Choose = rand(1);                       %LampKitchen
                    if Choose <= ProbLampKitchenSummerWd(Hour)
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ PowLampKitchen;
                    else
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ StandByLampKitchen;
                    end
                    Choose = rand(1);                       %LampRoom
                    if Choose <= ProbLampRoomSummerWd(Hour)
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ PowLampRoom;
                    else
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ StandByLampRoom;
                    end
                    Choose = rand(1);                       %Radio
                    if Choose <= ProbRadioSummerWd(Hour)
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ PowRadio;
                    else
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ StandByRadio;
                    end
                    Choose = rand(1);                       %TV20
                    if Choose <= ProbTvSummerWd(Hour)
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ PowTv;
                    else
                        TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ StandByTv;
                    end
                end
            end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:44:31.600

在对代码进行矢量化时，分步进行是很有帮助的。例如，在此代码中，您应该首先尝试仅对最内层循环中的一个 if 语句进行向量化。

举个例子：

```
for h = 1:NumHouse                          %LOOP - HOUSE
  Choose = rand(1);                   %CellCharger
  if Choose <= ProbCellChargerSummerWd(Hour)
    TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ PowCellCharger;
  else
    TotalLoad(1,HourCount) = TotalLoad(1,HourCount)+ StandByCellCharger;
  end
end 
```

如果您在代码中使用迭代器，我想我的目标是将所有对“h”（迭代器）的引用替换为“：”（迭代器的矢量化版本）。

如果在代码中不使用迭代器，那就更简单了。例如，上面的代码没有使用迭代器，所以我们可以简单地将其重写为向量化形式，如下：

```
Choose = rand(1, NumHouse);                   %CellCharger
ChooseIdx = (Choose <= ProbCellChargerSummerWd(Hour));
TotalLoad(1,HourCount) = TotalLoad(1,HourCount) + ...
                         ChooseIdx .* PowCellCharger + ...
                         ~ChooseIdx .* StandByCellCharger; 
```

而已！无需循环！

[此处提供了](http://wiki.accelereyes.com/wiki/index.php/Code_Vectorization_Examples)一些其他有用的矢量化技巧。[一旦你有矢量化代码，你可以使用 GPU](http://accelereyes.com/jacket_tour)让它更快:)

# java - 在 Processing 中绘制 3D 文本

> ID：10194126
> 
> 赞同：2
> 
> 时间：2012-04-17T15:24:56.750
> 
> 标签：java, 3d, processing

我正在使用处理 API 处理 Java 中的 3D 场景。这是一种强制导向的图形布局算法（尽管这不是太重要）。我已经完成了所有的图形绘制——节点、边、布局等看起来不错。不过，图表上的每个节点都有一个标签，我希望能够将所述标签显示为节点旁边的文本。我试过使用 text() 函数，但到目前为止，我的代码似乎不起作用。我在场景中的任何地方都看不到任何文字。

我的代码如下所示：

```
pushMatrix();
translate(width/2, height/2, 0); // put 0,0,0 at the center of the screen
text("foo!", 20, 20, 20);
popMatrix(); 
```

我什么也没看到。只是图表。那么我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-22T20:40:16.923

填充颜​​色控制文本颜色，默认为白色。因此，如果您在白色背景上绘制白色文本，它将不会显示。添加填充（0）；在绘制文本之前。

另请记住，将文本发送到屏幕后绘制的形状可能会覆盖您的文本。draw 中的最后一个“隐藏”语句是绘制屏幕。

这是一个绘制一系列垂直线（二维）的示例，顶部有一排标签：

```
 int startX;

   void setup() {
      size(400,400);
      textSize(12);
      startX = width/10; 
    }

    void draw() {
      background(255);
      int curX = startX;
      fill(0);            // Set the text color
      while (curX < width)
      {
        line(curX, 30, curX, height-10);
        text(curX, curX-(curX/20), 20);
        curX += width/10;
      }
    } // end draw 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T08:20:40.383

您显示的一小段代码一切都很好。[您可以在此处](http://studio.sketchpad.cc/sp/pad/view/ro.93TJgfWqxYsbU/rev.116)看到修改后的版本：

```
void setup() {
    size(400,400,P3D);    
    textSize(20);
} 

void draw() {  
    background(0);
    translate(width * .5, height*.5,0);
    rotateY(map(mouseX,0,width,-PI,PI));
    rotateX(map(mouseY,0,height,-PI,PI));
    pushMatrix();
    text("foo!", -20, 0, 20);
    popMatrix();
} 
```

一路上可能还有其他事情。愿意分享更多信息吗？

# asp.net - 同一个虚拟服务器中的多个 Asp.Net WebApplication Project

> ID：10194127
> 
> 赞同：0
> 
> 时间：2012-04-17T15:24:56.940
> 
> 标签：asp.net

我见过一个应用程序，它有多个 Asp.Net web 应用程序项目。看起来开发应用程序的人不知道他们可以拥有一个 Asp.Net Web 应用程序项目和其他项目，如 BusinessLogic、DataLogic 可以创建为 C# 类库项目。将所有层都作为 Web 应用程序项目意味着什么？会不会有性能问题？每个 Web 应用程序都有自己的 AppDomain 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:46:52.373

Multiple projects in VS shouldn't affect performance in the application. When you build your project your references in your main website will "retrieve" the latest copy of the compiled projects. If anything this could actually improve performance on the target server since these libraries will not need to be compiled again.

# c# - 如何将查询/其他密集逻辑放在单独的工作线程 BackGroundWorker

> ID：10194131
> 
> 赞同：0
> 
> 时间：2012-04-17T15:25:02.387
> 
> 标签：c#, wpf, multithreading, backgroundworker

为了提高性能，我必须用 BackGroundWorker 替换 DispatcherTimer 来处理使用线程计时器每 5 秒运行一次的密集查询。

实现以下代码时，我不再得到任何结果，大多数时候我的应用程序也会关闭。

```
 public void CaculateTimeBetweenWegingen()
    {          
        if (listWegingen.Count > 1)
            msStilstand = (DateTime.Now - listWegingen[listWegingen.Count - 1]).TotalSeconds;

        if(msStilstand >= minKorteStilstand) 
        {
            stopWatch.Start(); 

            if (msStilstand >= minGroteStilstand)
            {
                FillDuurStilstandRegistrationBtn();

                if (zelfdeStilstand == false)
                {
                    CreateRegistrationButton();                       
                    zelfdeStilstand = true;
                }

                if (msStilstand <= maxGroteStilstand){
                    //....
                }
            }
        }
        else //new weging
        {
            if (stopWatch.IsRunning == true)
            {
                timerStilstand.Stop();

                stopWatch.Stop();

                //huidige registrationBtn
                if (GlobalObservableCol.regBtns.Count > 1)
                {
                    GlobalObservableCol.regBtns[GlobalObservableCol.regBtns.Count - 1].StopWatchActive = false;

                    GlobalObservableCol.regBtns[GlobalObservableCol.regBtns.Count - 1].DuurStilstand =
                        String.Format("{0:D2}:{1:D2}:{2:D2}", stopWatch.Elapsed.Hours, stopWatch.Elapsed.Minutes, stopWatch.Elapsed.Seconds);
                }

            }
            zelfdeStilstand = false;
        }
    }/*CaculateTimeBetweenWegingen*/

public void CreateRegistrationButton()
    {
        InitializeDispatcherTimerStilstand();

        RegistrationButton btn = new RegistrationButton(GlobalObservableCol.regBtns.Count.ToString());
        btn.RegistrationCount = GlobalObservableCol.regBtnCount;
        btn.Title = "btnRegistration" + GlobalObservableCol.regBtnCount;
        btn.BeginStilstand = btn.Time;

        GlobalObservableCol.regBtns.Add(btn);
        GlobalObservableCol.regBtnCount++;

        btn.DuurStilstand = String.Format("{0:D2}:{1:D2}:{2:D2}", 0, 0, 0);         
    }

public void InitializeDispatcherTimerWeging()
    {
        worker = new BackgroundWorker();
        worker.DoWork += new DoWorkEventHandler(Worker_DoWork);
        worker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(worker_RunWorkerCompleted);
        worker.RunWorkerAsync();
    }

    void Worker_DoWork(object sender, DoWorkEventArgs e)
    {
        TimerCallback callback = MyTimerCallBack;
        timerWegingen = new Timer(callback);

        timerWegingen.Change(0, 5000);
    }

public void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            worker.RunWorkerAsync();
        }

    private void MyTimerCallBack(object state)
    {
        DisplayWegingInfo();
        CaculateTimeBetweenWegingen();
    } 
```

*该按钮通过另一个计时器每 1 秒重新填充一次新值。“DuurStilstand”是一个依赖属性*

```
 private void FillDuurStilstandRegistrationBtn()
    {
        TimeSpan tsSec = TimeSpan.FromSeconds(stopWatch.Elapsed.Seconds);
        TimeSpan tsMin = TimeSpan.FromMinutes(stopWatch.Elapsed.Minutes);
        TimeSpan tsHour = TimeSpan.FromMinutes(stopWatch.Elapsed.Hours);

        if (GlobalObservableCol.regBtns.Count >= 1
                    && GlobalObservableCol.regBtns[GlobalObservableCol.regBtns.Count - 1].StopWatchActive == true)
        {
            GlobalObservableCol.regBtns[GlobalObservableCol.regBtns.Count - 1].DuurStilstand =
                            String.Format("{0:D2}:{1:D2}:{2:D2}", tsHour.Hours, tsMin.Minutes, tsSec.Seconds);
        }
    } 
```

上面所有的代码都写在一个单独的 c# 类中。

我究竟如何使此代码与 BackGroundWorker 一起使用，以及如何/在何处使用 Dispatcher/Invoke 更新 GUI。尝试了很长时间，我似乎无法解决这个问题。

我还看到 BackGroundWorker 的 Complete 方法可用于更新 GUI，但不确定具体如何。按钮被创建并保存在 ObservableCollection 中。

```
 public static ObservableCollection<RegistrationButton> regBtns = new ObservableCollection<RegistrationButton>(); 
```

一些例子将是最有用的。因为我或多或少知道要做什么，但不完全确定如何实施。

最好的问候，杰克兹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T20:59:27.857

我不明白您的应用程序的含义，但您可以像这样更新 UI

```
public void worker_RunWorkerCompleted(object sender, System.ComponentModel.RunWorkerCompletedEventArgs e)
    {
        Application.Current.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.ApplicationIdle, new Action(() =>
        {
            //do your stuff
        }));
    } 
```

也许渲染事件应该可以帮助您处理 UIThread。

```
CompositionTarget.Rendering += (s, args) =>
        {
            //do your stuff
        }; 
```

希望有帮助

# c# - 在android中序列化对象列表并在WCF中反序列化

> ID：10194134
> 
> 赞同：0
> 
> 时间：2012-04-17T15:25:11.613
> 
> 标签：c#, java, android, vb.net, wcf

我在android中有一个ArrayList，我试图将其转换为Base64字符串，然后通过JSON将其传递给wcf服务，wcf服务将字符串插入数据库。然后我需要能够从数据库中读取它并在 .NET 应用程序中对其进行反序列化。

这就是我在android中序列化ArrayList的方式：

```
 private String convertByteArrayToSave(byte[] b){
    if(b != null){
        return Base64.encodeToString(b,0,b.length,Base64.DEFAULT);
    }else{
        return "";
    }
}

private String convertListToStringToSave(ArrayList<myClasses.Shape> myList){
    ByteArrayOutputStream b = new ByteArrayOutputStream();
    ObjectOutputStream out;
    try {
        out = new ObjectOutputStream (b);
        out.writeObject(myList);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return convertByteArrayToSave(b.toByteArray());
} 
```

然后在 WCF 服务中，我尝试获取 Base64 字符串并将其反序列化为 List(Of Shape) 并将其序列化以将其插入数据库。

```
 Private Function ConvertAndroidByteToDotNet(ByVal s As String) As Byte()
    Dim result As Byte() = Nothing
    Dim b As Byte() = CType(System.Convert.FromBase64String(s), Byte())
    Dim msTest As New MemoryStream(b)
    msTest.Seek(0, SeekOrigin.Begin)
    msTest.Position = 0
    Dim formatter As New Runtime.Serialization.Formatters.Binary.BinaryFormatter()
    formatter.AssemblyFormat = Runtime.Serialization.Formatters.FormatterAssemblyStyle.Simple
    formatter.Binder = New BindChanger()
    Dim shapelist As List(Of ColbyDataTypes.Shape) = DirectCast(formatter.Deserialize(msTest), List(Of ColbyDataTypes.Shape))
    msTest.Close()

    Dim bin As New Runtime.Serialization.Formatters.Binary.BinaryFormatter()
    bin.AssemblyFormat = Runtime.Serialization.Formatters.FormatterAssemblyStyle.Simple
    bin.Serialize(msTest, shapelist)

    result = msTest.ToArray()

    Return result
End Function 
```

最终目标是能够在 .NET 应用程序或 android 应用程序中创建这些形状的列表，并且能够读取 .NET 应用程序和 android 应用程序中的列表，无论它是从哪里创建的。当您从 .NET 创建 Shape 并使用 WCF 将其读入 android 时，我能够做到这一点，但在 android 中创建它是我卡住的地方。我真的很感激任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:28:49.733

我会选择[JSON](http://www.json.org/)数据格式和[GSON](http://code.google.com/p/google-gson/)来解析 android 端的对象。它使用起来非常简单轻便。使用 JSON或此[JSON 解析](http://www.javacodegeeks.com/2011/01/android-json-parsing-gson-tutorial.html)从 android检查此[消费网络服务](http://www.josecgomez.com/2010/04/30/android-accessing-restfull-web-services-using-json/)，希望对您有所帮助。

# iphone - 异步进程给我带来麻烦

> ID：10194135
> 
> 赞同：0
> 
> 时间：2012-04-17T15:25:12.267
> 
> 标签：iphone, objective-c, ios, multithreading, grand-central-dispatch

我想从游戏中心服务器的回合制游戏中返回信息，这很好，但我想要使用异步方法获取的玩家别名：

```
[GKPlayer loadPlayersForIdentifiers:singleOpponentArray withCompletionHandler:^(NSArray *players, NSError *error) {

                GKPlayer *returnedPlayer = [players objectAtIndex:0];

                NSString *aliasToAdd = [NSString stringWithString:returnedPlayer.alias];
                NSString *idToAdd = [NSString stringWithString:returnedPlayer.playerID];
                NSDictionary *dictionaryToAddToAliasArray = [NSDictionary dictionaryWithObjects:[NSArray arrayWithObjects:aliasToAdd, idToAdd, nil] forKeys:[NSArray arrayWithObjects:@"alias", @"id", nil]];

                [self.aliasArray addObject:dictionaryToAddToAliasArray];

            }]; 
```

但是 UI 使用了这些信息并且它没有及时到达。如何使该方法在主线程上同步执行？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:33:35.170

任何与 UI 相关的代码都必须在主线程上执行。

如果您的应用必须等待异步调用返回，则首先禁用 UI。例如，设置`userInteractionEnabled = NO`在您的`UIView`.

然后，当异步方法返回时，重新启用`UIView`.

同时，显示某种活动指示器，例如`UIActivityIndicatorView`。

当然，只有在您无法在后台执行任务的情况下才执行上述操作。永远不要不必要地阻塞 UI。我相信您当然已经知道这一点，但对于可能正在阅读本文的平台新手来说，值得重申。

要在主线程上调用，请使用`NSObject`'`performSelectorOnMainThread`方法的变体之一。`dispatch_get_main_queue`或者，或者，通过调用函数，使用主队列在 gcd 上排队。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:53:50.123

您可以使用 GCD 函数执行此操作：

```
// Show an UILoadingView, etc

[GKPlayer loadPlayersForIdentifiers:singleOpponentArray
              withCompletionHandler:^(NSArray *players, NSError *error) {

    // Define a block that will do your thing
    void (^doTheThing)(void) = ^(void){
        // this block will be run in the main thread....
        // Stop the UILoadingView and do your thing here
    };

    // Check the queue this block is called in          
    dispatch_queue_t main_q = dispatch_get_main_queue();
    dispatch_queue_t cur_q = dispatch_get_current_queue();
    if (main_q != cur_q) {
        // If current block is not called in the main queue change to it and then do your thing
        dispatch_async(main_q, doTheThing);
    } else {
        // If current block is called in the main queue, simply do your thing
        doTheThing();
    }
}]; 
```

# .net - 温莎城堡。构建数据库配置和内核

> ID：10194139
> 
> 赞同：1
> 
> 时间：2012-04-17T15:25:35.757
> 
> 标签：.net, nhibernate, kernel, castle-windsor

再会！
我指导了一些使用 CastleWindsor 的手册。[本手册在这里。](http://stw.castleproject.org/Windsor.Windsor-Tutorial-Part-Six-Persistence-Layer.ashx)但我不明白，如何使用（或在哪里使用）这个：

```
var config = BuildDatabaseConfiguration();

Kernel.Register(
    Component.For<ISessionFactory>()
        .UsingFactoryMethod(_ => config.BuildSessionFactory()),
    Component.For<ISession>()
        .UsingFactoryMethod(k => k.Resolve<ISessionFactory>().OpenSession())); 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:59:48.543

这是您使用 NHibernate 时需要的配置，但您可以在手册中阅读。

您显示的代码来自`PersistenceFacility`您可以在此处看到的类：[https ://github.com/kkozmic/ToBeSeen/blob/master/src/ToBeSeen/Plumbing/PersistenceFacility.cs](https://github.com/kkozmic/ToBeSeen/blob/master/src/ToBeSeen/Plumbing/PersistenceFacility.cs)

`PersistenceFacility`类是在 Windsor 安装程序中配置的：[https ://github.com/kkozmic/ToBeSeen/blob/master/src/ToBeSeen/Installers/PersistenceInstaller.cs](https://github.com/kkozmic/ToBeSeen/blob/master/src/ToBeSeen/Installers/PersistenceInstaller.cs)

在这里查看整个项目：[https ://github.com/kkozmic/ToBeSeen](https://github.com/kkozmic/ToBeSeen)

# php - 如何从字符串中删除标签？

> ID：10194140
> 
> 赞同：0
> 
> 时间：2012-04-17T15:25:36.573
> 
> 标签：php, regex, replace

考虑以下：

```
$string = "A string with {LABELS} and {more|232} {lbls} and some other stuff";
echo str_replace('/(\{.*?\})/', '', $string); 
```

我正在尝试删除所有标签（标签是 之间的任何文本`{brackets}`）。预期的输出是：

```
A string with and and some other stuff 
```

但我得到的是原始字符串：

```
A string with {LABELS} and {more|232} {lbls} and some other stuff 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T15:28:49.793

str_replace 不适用于正则表达式，请改用 preg_replace：

[http://php.net/manual/en/function.preg-replace.php](http://php.net/manual/en/function.preg-replace.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T15:29:29.590

您将需要`preg_replace`改用：

```
$string = "A string with {LABELS} and {more|232} {lbls} and some other stuff";
echo preg_replace( '/\{.*?\}/', '', $string ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:29:33.927

尝试：

```
echo preg_replace('/\{.*?\}/', '', $string); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T15:33:13.317

```
preg_replace('/\{.*?\}/','',$str) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T15:35:32.847

请务必使用 preg_replace，但您*还*需要稍微不同的正则表达式来过滤掉空格并确保正确匹配大括号

```
$string = "A string with {LABELS} and {more|232} {lbls} and some other stuff";
echo preg_replace('/\s*\{[^}]*\}/', '', $string); 
```

Gives：一个带有 and 和其他东西的字符串

# powershell - PowerShell 中的 catch 问题

> ID：10194141
> 
> 赞同：8
> 
> 时间：2012-04-17T13:52:15.763
> 
> 标签：powershell

我对 catch 命令有疑问。我有以下要处理的脚本：

```
Try
{
    Add-Computer -DomainName "MyDomain.Dom" -Credential $DomainCred -PassThru -ErrorAction Stop
}

Catch [System.InvalidOperationException]
{
    "Your computer is unable to contact the domain"
} 
```

每次我运行它时，我都没有在 catch 块中得到任何东西。这是我从脚本中得到的错误报告：

```
PSMessageDetails      :
Exception             : System.InvalidOperationException: This command cannot be executed on target computer('') due to following error: The specified domain either does not exist or could not
                        be contacted.
TargetObject          :
CategoryInfo          : InvalidOperation: (MYPC:String) [Add-Computer], InvalidOperationException
FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.AddComputerCommand
ErrorDetails          :
InvocationInfo        : System.Management.Automation.InvocationInfo
PipelineIterationInfo : {0, 1} 
```

有任何想法吗？

* * *

一个可行的解决方案（感谢 PK 和 Patrick 的共同贡献）：

```
Try
{
    Add-Computer -DomainName "MyDomain.Dom" -Credential $DomainCred -PassThru -ErrorAction Stop
}

Catch [System.Management.Automation.RuntimeException]
{
    "Your computer is unable to contact the domain"
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:26:57.203

尝试捕捉`System.Management.Automation.RuntimeException`而不是`System.InvalidOperationException`.

```
Try
{
    Add-Computer -DomainName "MyDomain.Dom" -Credential $DomainCred
}

Catch [System.Management.Automation.RuntimeException]
{
    'Error: {0}' -f $_.Exception.Message
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T15:49:35.600

将“-ErrorActionPreference Stop”添加到您的 cmdlet。

例如，

```
Add-Computer -DomainName "MyDomain.Dom" -Credential $DomainCred -EA Stop 
```

不同 cmdlet 处理错误的方式似乎确实存在一些不一致之处，尤其是那些像 Active Directory 一样的“附加”cmdlet。但是，我认为基本思想是 PowerShell catch 仅捕获终止错误，默认情况下您上面的异常不是。因此，通过使用`-EA Stop`，您将强制它成为终止错误，从而触发 catch 块。

这是 Ed Wilson 的主题：*[编写接受流水线输入的 PowerShell 函数](http://blogs.technet.com/b/heyscriptingguy/archive/2010/03/11/hey-scripting-guy-march-11-2010.aspx)*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T15:47:06.567

I was able to get this to work:

```
Try
{
    Add-Computer -DomainName "MyDomain.Dom" -Credential $DomainCred -PassThru -ErrorAction Stop
}

Catch
{
    "Your computer is unable to contact the domain"
} 
```

`-PassThru` on the `Add-Computer` command returns the results of the command to the shell.

`-ErrorAction Stop` tells PowerShell to stop when it encounters an error; this suppresses the error output you were seeing.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T17:05:04.880

把`-Passthru`它放在上面可以让它捕捉到错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T15:38:29.430

```
 FullName                                                                                                                                                                   
--------                                                                                                                                                                   
System.Management.Automation.RuntimeException                                                                                                                              
The object of type "Microsoft.PowerShell.Commands.Internal.Format.FormatStartData" is not valid or not in the correct sequence. This is likely caused by a user-specified "f
ormat-list" command which is conflicting with the default formatting.
    + CategoryInfo          : InvalidData: (:) [out-lineoutput], InvalidOperationException
    + FullyQualifiedErrorId : ConsoleLineOutputOutOfSequencePacket,Microsoft.PowerShell.Commands.OutLineOutputCommand 
```

# android - 通过 Android 应用程序持久化对象的好方法是什么？

> ID：10194144
> 
> 赞同：0
> 
> 时间：2012-04-17T15:25:58.200
> 
> 标签：android, sql, caching, persistence

我正在尝试在整个 Android 应用程序中保留数据对象。我希望能够访问一个活动中的对象，修改它，保存它，导航到一个新活动，并使用更新的值访问同一个对象。

我本质上说的是缓存，但我的数据对象很复杂。例如，ObjectA 包含 ObjectB，ObjectB 又包含 ObjectC。有谁知道是否有在 Sql 中持久化复杂对象的好方法、工具或框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:58:42.197

将静态字段放在子类应用程序中。同样在您的清单中，放置：

`android:name="MyApp"`在您的应用程序标签内。

也可以从其他文件访问，只需使用：

```
MyApp myApp = (MyApp)getApplicationContext(); 
```

请参阅此处[如何在 Android 中声明全局变量？](https://stackoverflow.com/questions/708012/android-how-to-declare-global-variables)：

```
class MyApp extends Application {

  private String myState;

  public String getState(){
    return myState;
  }
  public void setState(String s){
    myState = s;
  }
}

class Blah extends Activity {

  @Override
  public void onCreate(Bundle b){
    ...
    MyApp appState = ((MyApp)getApplicationContext());
    String state = appState.getState();
    ...
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:39:36.020

为什么不使用 JSON 序列化机制？

与对对象的静态访问相关联，您可以轻松构建具有一些基本功能的轻量级数据库：

*   loadObjectsFromCache
*   saveObjectsInCache
*   获取对象

您还可以将对象存储在不同的文件中，并使用像这样的流式 json 解析器：[http ://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)

这个是一样的：http: [//developer.android.com/reference/android/util/JsonReader.html](http://developer.android.com/reference/android/util/JsonReader.html) 但即使你的应用程序api级别低于11也可以使用。

它比基本的 DOM 解析器使用更少的内存：http: [//developer.android.com/reference/org/json/JSONObject.html](http://developer.android.com/reference/org/json/JSONObject.html)，但速度相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:43:43.350

*   您可以使用 ORM 框架，如[OrmLite](http://ormlite.com/sqlite_java_android_orm.shtml)将对象映射到 sql，但对于您的情况来说，这可能是一种矫枉过正。

*   您还可以使这些共享对象[Parcelable](http://developer.android.com/reference/android/os/Parcelable.html)并通过 Intent 在活动之间传递它们。

*   您还可以将这些对象保存到 SharedPreferences 中，这样每个 Activity 都可以在需要时访问它们，并且这些对象也以这种方式持久化。不过，这可能意味着更多的 IO 访问，因此也要考虑到这一点。为此，您可以使用例如 Gson 更轻松地序列化对象。

这些是我会考虑的解决方案。但是无论你做什么，都不要把这个通用对象放入某种“标准”的全局静态变量中，比如使用自定义的应用程序类、静态字段或任何单例模式的实现，这些都是 Android 上非常脆弱的构造。

# c# - 如何从 SOAP 响应中提取多部分附件

> ID：10194147
> 
> 赞同：1
> 
> 时间：2012-04-17T15:26:00.370
> 
> 标签：c#, soap, multipart

我正在尝试提取 SOAP 响应的多部分附件部分。

我有一个使用 Web Reference 与 3rd 方 Web 服务对话的项目。我能够成功地发出请求并从服务中获得有效的响应，但我不明白附件数据的去向。查看 Web Reference 自动生成的代码，没有任何对象与实际附件数据相匹配。

在最初使用第 3 方 WSDL 时，是否需要设置任何类型的选项才能使其正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T01:56:29.807

我曾希望已经有一个 .NET 多部分边界解析器，但找不到，所以我自己编写了一个。

我通过将原始 HTTP 响应获取为字符串并在部分边界上拆分来做到这一点`------=_Part_*`。然后为每个部分寻找`Content-Transfer-Encoding: base64`，然后提取 base 64 区域并使用`Convert.FromBase64String`将其转换为字节数组，最后将其保存为文件。

# java - JComponent 的 setBounds 到字符串的像素宽度

> ID：10194149
> 
> 赞同：-1
> 
> 时间：2012-04-17T15:26:05.950
> 
> 标签：java, swing, paintcomponent, jcomponent, absolutelayout

我有这个内部类：

```
private class Plats extends JComponent{
    private String namn;
    Plats(int x, int y, String n){
        namn=n;
        setBounds(x-10, y-10, 150, 40);
        setPreferredSize(new Dimension(20, 20));
        setMinimumSize(new Dimension(20, 20));
        setMaximumSize(new Dimension(20, 20));
    }
    protected void paintComponent(Graphics g){
        super.paintComponent(g);
        g.setColor(Color.BLUE);
        g.fillOval(0, 0, 20, 20);
        g.setColor(Color.BLACK);
        g.setFont(font);
        g.drawString(namn, 0, 34);
    }
    public boolean contains(int x, int y){
        return x<20 && x>0 && y<20 && y>0;
    }
} 
```

我想将组件的边界设置为构造函数获取的字符串的宽度，但是如果我在paintComponent方法中执行它，我只能让它工作，因为我需要图形对象。在paintComponent 方法中这样做感觉不对，因为每次必须重新绘制组件时，它都会再次设置边界，而我只想在创建它时执行一次。

建议我如何解决这个问题？还是我应该在paintComponent中做它？，它可以工作，但我觉得不是一个好的解决方案:(？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:38:15.717

请不要使用`AbsoluteLayout`，只有在有非常重要的原因时，才能正确使用`LayoutManager`，

例如，您`JComponent`应该返回（所有标准或自定义 LayoutManager 不接受`PreferredSize`通知）到其父级或容器`PreferredSize`

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.event.ComponentEvent;
import javax.swing.JComponent;
import javax.swing.JFrame;

public class CustomComponent extends JFrame {

    private static final long serialVersionUID = 1L;

    public CustomComponent() {
        setTitle("Custom Component Graphics2D");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }

    public void display() {
        CustomComponents cc = new CustomComponents();
        /*cc.addComponentListener(new java.awt.event.ComponentAdapter() {

            @Override
            public void componentResized(ComponentEvent event) {
                setSize(Math.min(getPreferredSize().width, getWidth()),
                        Math.min(getPreferredSize().height, getHeight()));
            }
        });*/
        add(cc, BorderLayout.CENTER);

        CustomComponents cc1 = new CustomComponents();
        add(cc1, BorderLayout.EAST);

        pack();
        // enforces the minimum size of both frame and component
        setMinimumSize(getSize());
        //setMaximumSize(getMaximumSize());
        setVisible(true);

    }

    public static void main(String[] args) {
        CustomComponent main = new CustomComponent();
        main.display();
    }
}

class CustomComponents extends JComponent {

    private static final long serialVersionUID = 1L;

    @Override
    public Dimension getMinimumSize() {
        return new Dimension(100, 100);
    }

    @Override
    public Dimension getPreferredSize() {
        return new Dimension(400, 300);
    }

    @Override
    public Dimension getMaximumSize() {
        return new Dimension(800, 600);
    }

    @Override
    public void paintComponent(Graphics g) {
        int margin = 10;
        Dimension dim = getSize();
        super.paintComponent(g);
        g.setColor(Color.red);
        g.fillRect(margin, margin, dim.width - margin * 2, dim.height - margin * 2);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T19:42:38.377

即使没有图形上下文，您也可以使用`TextLayout`或`FontRenderContext`来查找边界；两者在[这里](https://stackoverflow.com/a/5998117/230513)进行比较。因为您扩展了`JComponent`，所以您的组件*应该*覆盖这些`getXxxSize()`方法，如 mKorbel 的[回答](https://stackoverflow.com/a/10194351/230513)中所示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:39:36.130

您可以使用 Font#getStringBounds(String str, FontRenderContext frc) 以所述字体的形式获取字符串的边界矩形。从那里您可以返回宽度和高度。

[字体 Java 1.6 API](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Font.html)

# asp.net - 如何通过 ELMAH-LogAnalyzer 保护 ELMAH 以供外部访问？

> ID：10194150
> 
> 赞同：2
> 
> 时间：2012-04-17T15:26:10.900
> 
> 标签：asp.net, security, elmah

我在 ASP.NET 站点上设置了 ELMAH，我想远程使用[elmah-loganalyzer](http://code.google.com/p/elmah-loganalyzer/)，同时仍然保持 ELMAH 的安全，不被窥探。基本上，我希望能够在紧急情况下在家中搜索日志，而不会破坏工作笔记本电脑并使用超慢速 VPN。

我知道我可以通过 web.config 使用表单身份验证和/或 IP 地址来保护 ELMAH，如其他地方所述。问题是 elmah-loganalyzer 无法使用表单身份验证（我知道）登录，我想从动态 IP 地址检查它，所以这些选项不可用。elmah-loganalyzer 可以作为 Windows 用户登录，但该网站没有使用这种形式的身份验证。

有谁知道 loganalyzer 可以使用的另一种保护 ELMAH 的方法，或者使用 Windows 身份验证来保护站点的这一部分的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T20:24:38.537

只需使用它直接连接到数据库。表单和 Windows 身份验证用于保护基于 Web 的处理程序，但日志分析器可以直接连接到数据库（显然使用适当的凭据）。

# ruby - Ruby rails - 在视图中从许多表单中呈现一个表单的优雅方式

> ID：10194154
> 
> 赞同：1
> 
> 时间：2012-04-17T15:26:26.627
> 
> 标签：ruby, ruby-on-rails-3

我有大约 20 种不同的可能形式，我希望根据用户的选择只显示一种形式。我对此的解决方案是相当低级的，使用 javascript 来隐藏除所选内容之外的所有内容。另外，我必须根据用户的选择使用 javascript 动态修改一些表单值。这不是渲染/管理它们的好方法，而且我希望它能够灵活地用于未来的修改。现在很乱，看着就恶心。有人对此有更好的想法吗？

这就是我一直在做的 -

```
<a class="font12" href="#" onclick="document.getElementById('form1').style.display='block';
document.getElementById('form2').style.display='none';
document.getElementById('form3').style.display='none'; return false;">form1</a> 
```

# php - FQL using ASP.NET - 将 PHP 示例转换为 .NET

> ID：10194162
> 
> 赞同：1
> 
> 时间：2012-04-17T15:27:13.893
> 
> 标签：php, asp.net, facebook

有人知道 VB 或 C# .NET 的等效代码是什么吗？

下面的代码是在 PHP 中运行 fql 查询的示例，但需要 C# 或 VB 中 .NET 的示例或等效代码。

任何帮助表示赞赏。

```
<?php
  $app_id = 'YOUR_APP_ID';
  $app_secret = 'YOUR_APP_SECRET';
  $my_url = 'POST_AUTH_URL';

  $code = $_REQUEST["code"];

 //auth user
 if(empty($code)) {
    $dialog_url = 'https://www.facebook.com/dialog/oauth?client_id=' 
    . $app_id . '&redirect_uri=' . urlencode($my_url) ;
    echo("<script>top.location.href='" . $dialog_url . "'</script>");
  }

  //get user access_token
  $token_url = 'https://graph.facebook.com/oauth/access_token?client_id='
    . $app_id . '&redirect_uri=' . urlencode($my_url) 
    . '&client_secret=' . $app_secret 
    . '&code=' . $code;
  $access_token = file_get_contents($token_url);

  // Run fql query
  $fql_query_url = 'https://graph.facebook.com/'
    . '/fql?q=SELECT+uid2+FROM+friend+WHERE+uid1=me()'
    . '&' . $access_token;
  $fql_query_result = file_get_contents($fql_query_url);
  $fql_query_obj = json_decode($fql_query_result, true);

  //display results of fql query
  echo '<pre>';
  print_r("query results:");
  print_r($fql_query_obj);
  echo '</pre>';

  // Run fql multiquery
  $fql_multiquery_url = 'https://graph.facebook.com/'
    . 'fql?q={"all+friends":"SELECT+uid2+FROM+friend+WHERE+uid1=me()",'
    . '"my+name":"SELECT+name+FROM+user+WHERE+uid=me()"}'
    . '&' . $access_token;
  $fql_multiquery_result = file_get_contents($fql_multiquery_url);
  $fql_multiquery_obj = json_decode($fql_multiquery_result, true);

  //display results of fql multiquery
  echo '<pre>';
  print_r("multi query results:");
  print_r($fql_multiquery_obj);
  echo '</pre>';
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:02:52.933

我将您提供的 php 代码转换为 c#，但由于 api 的可用性而未进行测试。希望这会帮助你。

```
private string TestApp()
{
    StringBuilder str = new StringBuilder();
    string app_id = "YOUR_APP_ID";
    string app_secrete = "YOUR_APP_SECRET";
    string my_url = "POST_AUTH_URL";

    string code="";
    if(Request.Params["code"]!=null)
        code = Request.Params["code"].ToString();

    string dialog_url = "";
    if(code !="")
    {
        dialog_url = "https://www.facebook.com/dialog/oauth?client_id=" + app_id + "&redirect_uri=" + Server.UrlEncode(my_url);
        str.Append("<script>top.location.href=" + dialog_url + "'</script>");
    }

    string token_url = "https://graph.facebook.com/oauth/access_token?client_id=" + app_id + "&redirect_uri=" + Server.UrlEncode(my_url) + "&client_secret=" + app_secrete + "&code=" + code;
    string access_token = file_get_contents(token_url);

    string fql_query_url = "https://graph.facebook.com/fql?q=SELECT+uid2+FROM+friend+WHERE+uid1=me()&" + access_token;

    string fql_query_result = file_get_contents(fql_query_url);

    string fql_query_obj = Newtonsoft.Json.JsonConvert.SerializeObject(fql_query_result, Newtonsoft.Json.Formatting.Indented);

    str.Append("<pre>\n");
    str.Append("Query Results: " + fql_query_obj);
    str.Append("</pre>\n");

    string fql_multiquery_url = "https://graph.facebook.com/fql?q={\"all+friends\":\"SELECT+uid2+FROM+friend+WHERE+uid1=me()\",my+name\":\"SELECT+name+FROM+user+WHERE+uid=me()\"}&" + access_token;
    string fql_multiquery_result = file_get_contents(fql_multiquery_url);
    string fql_multiquery_obj = Newtonsoft.Json.JsonConvert.SerializeObject(fql_multiquery_result, Newtonsoft.Json.Formatting.Indented);

    str.Append("<pre>\n");
    str.Append("multi query results: " + fql_multiquery_obj);
    str.Append("</pre>\n");

    return str.ToString();
}

protected string file_get_contents(string fileName)
{
    string sContents = string.Empty;
    string me = string.Empty;

    try
    {
        if (fileName.ToLower().IndexOf("http:") > -1)
        { // URL 
            System.Net.WebClient wc = new System.Net.WebClient();
            byte[] response = wc.DownloadData(fileName);
            sContents = System.Text.Encoding.ASCII.GetString(response);

        }
        else
        {   // Regular Filename 
            System.IO.StreamReader sr = new System.IO.StreamReader(fileName);
            sContents = sr.ReadToEnd();
            sr.Close();
        }
    }
    catch { sContents = "unable to connect to server "; }

    return sContents;
} 
```

# c++ - Qt 秒到 DD HH SS

> ID：10194164
> 
> 赞同：2
> 
> 时间：2012-04-17T15:27:32.607
> 
> 标签：c++, qt4, intervals, datetime-format, duration

使用 Qt 4.8 如何以 DD HH SS 格式打印时间？我有几秒钟，我想取回该格式的字符串。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T15:56:29.487

```
QDateTime::fromTime_t(seconds).toString("ss hh DD"); 
```

见[http://qt-project.org/doc/qt-5.0/qdatetime.html#toString](http://qt-project.org/doc/qt-5.0/qdatetime.html#toString)

如果您想要持续时间（您的问题真的不清楚），请尝试以下操作：

```
QString seconds_to_DHMS(quint32 duration)
{
  QString res;
  int seconds = (int) (duration % 60);
  duration /= 60;
  int minutes = (int) (duration % 60);
  duration /= 60;
  int hours = (int) (duration % 24);
  int days = (int) (duration / 24);
  if((hours == 0)&&(days == 0))
      return res.sprintf("%02d:%02d", minutes, seconds);
  if (days == 0)
      return res.sprintf("%02d:%02d:%02d", hours, minutes, seconds);
  return res.sprintf("%dd%02d:%02d:%02d", days, hours, minutes, seconds);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-01T15:20:29.970

由于您的服务器正常运行时间为秒，因此您可以使用`QDateTime`该类。

```
QDateTime::fromTime_t(duration).toUTC().toString("dd hh ss"); 
```

请注意`toUTC`，将开始时间设置为 0。由于您只会获取日期、小时和秒，因此如果秒不是自该日期起并不重要，因为不会显示年份。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:46:06.703

您可以使用[QDateTime::fromTime_t](http://doc.qt.nokia.com/4.7/qdatetime.html#fromTime_t)：

> 返回一个日期时间，其日期和时间是自协调世界时 (Qt::UTC) 1970-01-01T00:00:00 以来经过的秒数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T16:28:58.333

您要打印的是一段时间......而不是时钟时间的“时刻”。除了计算[secsTo](http://harmattan-dev.nokia.com/docs/library/html/qt4/qdatetime.html#secsTo)（和[daysTo](http://harmattan-dev.nokia.com/docs/library/html/qt4/qdatetime.html#daysTo)）之外，QDateTime 对持续时间的作用不大，而且您几乎必须自己打印。

好消息是数学并不难：

[将秒转换为天、分和秒](https://stackoverflow.com/questions/2419562/convert-seconds-to-days-minutes-and-seconds)

尽管您对诸如*秒*/*天*/*年*之类的词的国际化可能会令人讨厌。:(

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-06T19:31:40.597

数学非常难。天不是 24 小时，它们通常是 24 小时，但有时是 23 或 25（夏令时更改）或 24 小时和一两秒（闰秒）。同样的问题会持续数月（显然，因为不同大小的月份很常见）年（闰日），实际上任何通过以天（周）定义来继承当天问题的东西。

# c# - 正则表达式匹配字符串

> ID：10194166
> 
> 赞同：3
> 
> 时间：2012-04-17T15:27:40.863
> 
> 标签：c#, .net, regex

我有一个与 c# 中的正则表达式有关的问题。

我想在 " 字符之间查找文本。示例：

```
 Enum resultado = SPDialogBox.Instance.show<ACTION_ENUMs.TORNEO_SORTEAR>("Esto es una prueba"); 
```

火柴：`Esto es una prueba`

但是，在这个例子中

```
Enum resultado = SPDialogBox.Instance.show<ACTION_ENUMs.TORNEO_SORTEAR>("Esto es una prueba");
pKR_MESAPUESTOASIGNACION.CONFIGTORNEO_ID = Valid.GetInt(dr.Cells["CONFIGTORNEO_ID"].Value); 
```

匹配：`Esto es una prueba`但不能匹配`CONFIGTORNEO_ID`，因为它写在方括号 ( `[]`)之间

简而言之，我想匹配双引号 ( `"`) 字符之间的字符串，但该字符串不能写在方括号 ( `[]`) 之间。

这是我的代码：

```
var pattern = "\"(.*?)\"";
var matches = Regex.Matches(fullCode, pattern, RegexOptions.Multiline);

foreach (Match m in matches)
{
    Console.WriteLine(m.Groups[1]);
} 
```

该模式匹配字符之间的所有字符串`"`，但是如何修改模式以排除写在方括号之间的那些字符串？

- 编辑 - -

这是另一个例子：

```
List<String> IdSorteados = new List<String>();
int TablesToSort = 0;
foreach (UltraGridRow dr in fg.hfg_Rows)
{
    if (dr.Cells["MESA_ID"].Value == DBNull.Value && dr.Cells["Puesto"].Value == DBNull.Value && !Valid.GetBoolean(dr.Cells["BELIMINADO"].Value) && (Valid.GetBoolean(dr.Cells["Seleccionado"].Value) || SortearTodo))
        TablesToSort++;
    } 
```

表达式不得匹配`MESA_ID`(found within `Cells["MESA_ID"].Value`) 或`Puesto`(found within `Cells["Puesto"].Value`)。它也不能匹配`].Value == DBNull.Value && dr.Cells[`（在 中找到`["MESA_ID"].Value == DBNull.Value && dr.Cells["Puesto"]`）

我希望我已经表达了我的意图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:32:25.883

简单地使用消极的后视：

```
(?<!\[) 
```

基本上，仅在前面没有 a 时才匹配字符串`[`。[示例here](http://ideone.com/IYBjL)，代码如下：

```
String fullCode = "Enum resultado = SPDialogBox.Instance.show<ACTION_ENUMs.TORNEO_SORTEAR>(\"Esto es una prueba\");\r\n"
                + "pKR_MESAPUESTOASIGNACION.CONFIGTORNEO_ID = Valid.GetInt(dr.Cells[\"CONFIGTORNEO_ID\"].Value);";
String pattern = @"(?<!\[)\x22(.*?)\x22";
var matches = Regex.Matches(fullCode, pattern, RegexOptions.Multiline);
foreach (Match m in matches)
{
    Console.WriteLine(m.Groups[1]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:38:00.557

为避免匹配嵌套在方括号内的引用，您需要检查以下其中一项是否为真：

*   开始双引号之前的最后一个非空白字符*不是*`[`, 或
*   结束双引号后的第一个非空白字符*不是*`]`

这可以使用这个正则表达式来完成：

```
(?<!\[\s*)\"[^"]*\"(?!\s*\]) 
```

它使用 .NET 正则表达式引擎的[*环视*](http://www.regular-expressions.info/lookaround.html)功能。

请注意此表达式如何通过使用而不是 来避免`?`引用字符串中的不情愿限定符。`[^"]*``.*?`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:37:30.593

我认为是这样的：

```
^[^\"]*\"([^\"]*)\".*$ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-10T09:41:17.470

很多时候我必须解析源代码文件（php|cpp|java|js|css|etc）并进行一些正则表达式替换。为了避免替换某些字符串/消息，我在替换之前屏蔽了所有字符串，因此我必须捕获所有可能的字符串并屏蔽它们。

这就是我捕获所有字符串的方式：`/(['"])(\\\1|.)*?\1/gm` 这意味着：

*   捕获以单|双引号开头的所有内容：`['"]`
*   如果它前面有正斜杠（转义运算符），则它可能后跟零个或多个字符，即使是相同的引号符号（不被视为字符串的结尾`\`）：`(\\\1|.)*`
*   确保上述模式在第一次出现时停止，而不是在最后一次匹配时停止（即不要贪心）：`?`
*   最后，我们的字符串在它后面跟着相同的起始单|双引号时结束：`\1`

我希望在全局（以捕获所有可能的匹配项）和多行（字符串可能不会在由 CRLF 分隔的新行上继续进行，对吗？）

也许您不仅有兴趣找到这些字符串组，而且还想捕获这些字符串组，因此请确保将其放入组分隔符中，`(\\\1|.)*?`这给出了最终模式：

> `([\'"])((\\\1|.)*?)\1`

捕获的字符串示例：

```
defined ( 'WP_DEBUG' ) || define( '\WP_DEBUG', true );
echo 'class="input-text card-number" type="text" maxlength="20"';
echo 'How are you? I\'m fine, thank you'; 
```

[在在线正则表达式测试器中检查我的模式](https://regex101.com/?regex=%28%5B%5C%27%22%5D%29%28%28%5C%5C%5C1%7C.%29%2A%3F%29%5C1&options=gm&text=defined+%28+%27WP_DEBUG%27+%29+||+define%28+%27%5CWP_DEBUG%27%2C+true+%29%3B%0Aecho+%27class%3D%22input-text+card-number%22+type%3D%22text%22+maxlength%3D%2220%22%27%3B%0Aecho+%27How+are+you%3F+I%5C%27m+fine%2C+thank+you%27%3B)。

# android - android 2.2 中的 Android 应用缓存

> ID：10194169
> 
> 赞同：1
> 
> 时间：2012-04-17T15:27:45.000
> 
> 标签：android, mobile, html5-appcache

我正在编写一个使用 WebViews、外部托管的 js 文件和一个清单文件来控制 appcache 的 android 应用程序。在 android 4 中一切似乎都可以正常工作，但在 2.2 中，缓存似乎不起作用。

流程如下：

1.  Android 应用程序加载本地 html 文件并将其加载到 webview 中。

2.  本地 html 文件有一些 javascript 可以将窗口位置切换到远程“引导”文件的位置。

3.  引导文件包括一些用于下载 javascript 应用程序和支持 CSS 的 javascript（通过将脚本/链接标签写入 dom），以及到远程清单文件的链接（绝对 URL，与引导文件和应用程序文件在同一位置提供） ）。

4.  应用程序被下载，并呈现到屏幕上。

清单文件如下所示：

```
CACHE MANIFEST
#2012-04-12

CACHE:
mobile-css.css
app-mobile.js
app.js
bootstrap.html 
```

我遇到的问题是，在 android 2.2 (HTC hopeHD) 中，当我更改清单文件时，应用程序只重新下载引导 html 文件，并忽略 app-mobile.js 和 css 文件，并始终使用缓存中的。这适用于我在 android 4 中的预期（更改清单文件会重新下载所有指定的资源）。

我已经在模拟器和设备中运行了这个，结果是一样的。

谁能看到我做错了什么？

提前致谢。

# c# - ComboBox.SelectedText 没有给我 SelectedText

> ID：10194171
> 
> 赞同：64
> 
> 时间：2012-04-17T15:27:53.597
> 
> 标签：c#, winforms, string, combobox

我正在构建一个字符串，代码看起来像

```
String status = "The status of my combobox is " + comboBoxTest.SelectedText 
```

我在 VS2010 中使用 WinForm

结果看起来像

> “我的组合框的状态是”

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-04-17T15:31:51.160

我想你想用

```
String status = "The status of my combobox is " + comboBoxTest.Text 
```

[MSDN](http://msdn.microsoft.com/it-it/library/system.windows.forms.combobox.selectedtext.aspx)中的 SelectedText 属性

> 获取或设置在 ComboBox 的可编辑部分中选择的文本。

[而来自MSDN](http://msdn.microsoft.com/it-it/library/system.windows.forms.combobox.text.aspx)的 Text 属性

> 获取或设置与此控件关联的文本。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-04-17T15:33:19.010

从[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectedtext.aspx)中：

> 您可以使用 SelectedText 属性来检索或更改 ComboBox 控件中当前选定的文本。但是，您应该知道，由于用户交互，选择可能会自动更改。例如，如果您在按钮 Click 事件处理程序中检索 SelectedText 值，则该值将是一个空字符串。这是因为当输入焦点从组合框移动到按钮时，选择会自动清除。
> 
> 当组合框失去焦点时，选择点会移动到文本的开头，并且任何选定的文本都将变为未选中状态。在这种情况下，获取 SelectedText 属性会检索一个空字符串，并设置 SelectedText 属性会将指定的值添加到文本的开头。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-01-01T14:47:32.813

我在 5 分钟前遇到了这个问题。

我认为一个解决方案（使用visual studio 2005）是：

```
myString = comboBoxTest.GetItemText(comboBoxTest.SelectedItem); 
```

如果我错了，请原谅我。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-04-17T15:31:35.733

我认为你不需要`SelectedText`，但你可能需要

```
String status = "The status of my combobox is " + comboBoxTest.Text; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-05-14T12:13:30.673

尝试这个：

`String status = "The status of my combobox is " + comboBoxTest.text;`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-04-17T16:22:29.600

要获得选定的项目，您必须使用组合框的 SELECTEDITEM 属性。由于这是一个对象，如果你想将它分配给一个字符串，你必须使用 ToString() 方法将它转换为字符串：

```
string myItem = comboBox1.SelectedItem.ToString(); //this does the trick 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-04-17T15:49:25.577

假设您想更改例如标签的文本，这就是我将如何解决这个问题

```
 private void comboBoxtest_SelectedIndexChanged(object sender, EventArgs e)
    {
        var combotext = comboBoxtest.Text;
        var status = "The status of my combo box is" + combotext;
        label1.Text = status;
    } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-28T13:53:10.433

如果将 Combobox 绑定到 KeyValuePair 之类的东西，构造函数中的属性如下...：

```
 DataSource = dataSource,
 DisplayMember = "Value",
 ValueMember = "Key" 
```

`dataSource`KeyValuePair 类型也是如此...

你最终不得不这样做......

```
 string v = ((KeyValuePair)((ComboBox)c).SelectedItem).Value; 
```

（我有一个动态表单 -`c`类型在哪里`Control`- 所以必须将它转换为 ComboBox）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-02-17T22:03:10.313

之前的所有答案都解释了 OP“应该”做什么。我正在解释`.SelectedText`属性是什么。

该`.SelectedText`属性不是`combobox`. 它是突出显示的文本。`.SelectedText`它与a 的属性相同`textbox`。

下图显示该`.SelectedText`属性将等于“ort”。

[![在此处输入图像描述](../Images/a61b5fb009c793918031c1c9978f7b48.png)](https://i.stack.imgur.com/vmzZ3.jpg)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-07-30T00:20:10.410

如果您只想知道`ComboBox`带有可编辑文本框（或`ComboBoxStyle.DropDown`样式）的文本，可以使用：

```
string str = comboBox.SelectedItem != null ?
                      comboBox.GetItemText(comboBox.SelectedItem) : comboBox.Text; 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2012-04-17T15:37:28.103

或试试这个代码

```
 String status = "The status of my combobox is " + comboBoxTest.SelectedItem.ToString(); 
```

# xslt - EXSLT 字符串：替换

> ID：10194173
> 
> 赞同：0
> 
> 时间：2012-04-17T15:27:55.487
> 
> 标签：xslt, exslt

我在让我的 XML 使用 EXSLT str:replace 模板正确转换时遇到问题。

这是我的 XML：

```
<XML>
<Item>
    <Field>
        <Name>ID</Name>
        <Value>98765</Value>
    </Field>
    <Field>
        <Name>ParentID</Name>
        <Value>10002</Value>
    </Field>
    <Field>
        <Name>Type</Name>
        <Value>content</Value>
    </Field>
    <Field>
        <Name>Name</Name>
        <Value>TestAPI Course</Value>
    </Field>
    <Field>
        <Name>URL</Name>
        <Value></Value>
    </Field>
    <Field>
        <Name>Description</Name>
        <Value>a description</Value>
    </Field>
    <Field>
        <Name>DateBegin</Name>
        <Value>2012-04-04T00:00:00.000-07:00</Value>
    </Field>
    <Field>
        <Name>DateEnd</Name>
        <Value>2012-04-04T00:00:00.000-08:00</Value>
    </Field>
    <Field>
        <Name>DateCreated</Name>
        <Value>2012-04-03T00:00:00.000-07:00</Value>
    </Field>
    <Field>
        <Name>DateModified</Name>
        <Value>2012-04-04T00:00:00.000-06:00</Value>
    </Field>
</Item> 
```

这是我的 XSL：

```
<?xml version="1.0" encoding="utf-16"?>
    <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:str="http://exslt.org/strings" extension-element-prefixes="str" version="1.0">
        <xsl:import href="C:\inetpub\wwwroot\LMSConnector\LMS\XSL\str.xsl"/>
        <xsl:template match="/Items">
            <xsl:call-template name="str:replace">
                <xsl:with-param name="string" select="Field/Name"/>
                <xsl:with-param name="search" select="ID"/>
                <xsl:with-param name="replace" select="sco-id"/>
            </xsl:call-template>
        </xsl:template>
    </xsl:stylesheet> 
```

我的问题是我只得到一个 XML 文档标题，没有别的，但没有别的？我认为我离一个可行的解决方案还差得很远，问题可能在于我为模板上的“匹配”参数设置的值，以及带有参数节点的调用模板中的选择参数。

任何帮助，将不胜感激。

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:52:50.750

您正在尝试匹配`<xsl:template match="/Items">`，但是您的 XML 包含`<Item>`元素，而不是`<Items>`.

# 编辑

* * *

这是你想要做的吗？

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:str="http://exslt.org/strings" extension-element-prefixes="str">
    <xsl:import href="http://delicious-library-export.googlecode.com/svn/trunk/str/str.xsl"/>
    <xsl:output method="xml" encoding="utf-8" indent="no"/>

    <xsl:template match="/Item/Field/Name/text()">
        <xsl:call-template name="str:replace">
          <xsl:with-param name="string" select="."/>
          <xsl:with-param name="search" select="'ID'"/>
          <xsl:with-param name="replace" select="'sco-id'"/>
        </xsl:call-template>
    </xsl:template>

    <xsl:template match="*">      
      <xsl:copy>
        <xsl:apply-templates/>
      </xsl:copy>      
    </xsl:template>

    </xsl:stylesheet> 
```

结果：

```
<?xml version="1.0" encoding="utf-8"?>
<Item>
    <Field>
        <Name>sco-id</Name>
        <Value>98765</Value>
    </Field>
    <Field>
        <Name>Parentsco-id</Name>
        <Value>10002</Value>
    </Field>
    <Field>
        <Name>Type</Name>
        <Value>content</Value>
    </Field>
    <Field>
        <Name>Name</Name>
        <Value>TestAPI Course</Value>
    </Field>
    <Field>
        <Name>URL</Name>
        <Value/>
    </Field>
    <Field>
        <Name>Description</Name>
        <Value>a description</Value>
    </Field>
    <Field>
        <Name>DateBegin</Name>
        <Value>2012-04-04T00:00:00.000-07:00</Value>
    </Field>
    <Field>
        <Name>DateEnd</Name>
        <Value>2012-04-04T00:00:00.000-08:00</Value>
    </Field>
    <Field>
        <Name>DateCreated</Name>
        <Value>2012-04-03T00:00:00.000-07:00</Value>
    </Field>
    <Field>
        <Name>DateModified</Name>
        <Value>2012-04-04T00:00:00.000-06:00</Value>
    </Field>
</Item> 
```

# xml - XML xpath？根据不在列表中的属性过滤 xml 标签

> ID：10194176
> 
> 赞同：-1
> 
> 时间：2012-04-17T15:28:21.393
> 
> 标签：xml, xpath

尝试根据列表过滤 xml 标签。

列表示例：文件名 list.txt

1
2
3
4
5
6

示例 XML

<id=1 />
<id=4 />
<id=11 />
<id=3 />
<id=23 />

使用 XPath？是否可以编写一个 xpath 查询来过滤 xml 标签，只留下 list.txt 中没有的内容？

输出
<id=11 />
<id=23 />

这可能在 xpath 语句中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T15:07:12.110

感谢所有提供反馈和建议的人。我已经弄清楚了我自己的问题。请提供有关我的解决方案的反馈，看看是否可以做得更好。谢谢..

我的问题与 Nessus 有关。它的报道太可怕了。我能够查看 .nessus 文件 ver2 并将我需要的标签中的信息拼凑起来。我会把它放在这里，供其他可能使用类似报告的 Nessus 用户使用。

我需要一种方法来过滤掉报告中不重要的插件信息。我决定最好的方法是使用 xslt 过滤插件，我也使用它来将 xml 文件格式化为电子表格应用程序的有用表格格式。我决定使用单独的 xml 文件来存储包含不需要的 Nessus 插件的标签。xml文件的结构是这样的：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<exclude>
  <nessusPlugin>19506</nessusPlugin>
  <nessusPlugin>45590</nessusPlugin>
</exclude> 
```

我遵循了关于查看“文档”功能的建议，最终想出了这个 xslt：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:variable name="excludedplugins" select="document('nessusExcludePluginList.xml')/exclude/nessusPlugin"/>

<xsl:template match="/">
  <html>
  <body>
    <h2>
      Nessus Report, Targets: <xsl:value-of select="count(NessusClientData_v2/Report/ReportHost)"/> 
    </h2>
    <br/>High Risk Count: <xsl:value-of select="count(NessusClientData_v2/Report/ReportHost/ReportItem[risk_factor='High'])"/>
    <br/>Medium Risk Count: <xsl:value-of select="count(NessusClientData_v2/Report/ReportHost/ReportItem[risk_factor='Medium'])"/>
    <br/>Low Risk Count: <xsl:value-of select="count(NessusClientData_v2/Report/ReportHost/ReportItem[risk_factor='Low'])"/>
    <br/>Irrelavant Risk (Severity &lt; 2) Count: <xsl:value-of select="count(NessusClientData_v2/Report/ReportHost/ReportItem[@severity&lt;2])"/>
    <table border="1">    
      <tr bgcolor="#9acd32">
        <th>DNS Name</th>
        <th>NetBios Name</th>
        <th>IP Address</th>
        <th>MAC Address</th>
        <th>Operating System</th>
        <th>Port</th>
        <th>Protocol</th>
        <th>Service Name</th>
        <th>n Plugin ID</th>
        <th>n Severity</th>
        <th>n Risk_Factor</th>
        <th>n Plugin Name</th>
        <th>n Plugin Family</th>        
        <th>Description</th>
        <th>Plugin Output</th>
        <th>Synopsis</th>
      </tr>
      <xsl:for-each select="NessusClientData_v2/Report/ReportHost">
        <xsl:for-each select="ReportItem">
          <xsl:choose>
            <xsl:when test="not(@pluginID=$excludedplugins)">
              <tr>
                <td><xsl:value-of select="../@name"/></td>
                <td><xsl:value-of select="../HostProperties/tag[@name='netbios-name']"/></td>
                <td><xsl:value-of select="../HostProperties/tag[@name='host-ip']"/></td>
                <td><xsl:value-of select="../HostProperties/tag[@name='mac-address']"/></td>
                <td><xsl:value-of select="../HostProperties/tag[@name='operating-system']"/></td>
                <td><xsl:value-of select="@port"/></td>
                <td><xsl:value-of select="@protocol"/></td>
                <td><xsl:value-of select="@svc_name"/></td>
                <td><xsl:value-of select="@pluginID"/></td>
                <td><xsl:value-of select="@severity"/></td>
                <td><xsl:value-of select="risk_factor"/></td>            
                <td><xsl:value-of select="@pluginName"/></td>
                <td><xsl:value-of select="@pluginFamily"/></td>
                <td><xsl:value-of select="description"/></td>            
                <td><xsl:value-of select="plugin_output"/></td>            
                <td><xsl:value-of select="synopsis"/></td>            
              </tr>
            </xsl:when>
            <xsl:otherwise>              
            </xsl:otherwise>
          </xsl:choose>
        </xsl:for-each>
      </xsl:for-each>
    </table>
  </body>
  </html>
</xsl:template>
</xsl:stylesheet> 
```

我一起破解了这个并想出了这些解决方案： 1\. 添加带有不需要的插件列表的 xml 文件：

```
<xsl:variable name="excludedplugins" select="document('nessusExcludePluginList.xml')/exclude/nessusPlugin"/> 
```

1.  要与排除的插件进行比较：

在我尝试之前不确定是否可以进行比较。事实证明，这适用于节点中的所有项目。多么划算！我还没有弄清楚为什么这不起作用：

```
<xsl:when test="@pluginID!=$excludedplugins"> 
```

= 运算符将检查所有节点，但 != 似乎根本不起作用。好在“不”功能存在。

为了使它更好，我想做的是看看是否有办法用插件编号的直接列表而不是 xml 文件向它提供不需要的插件列表，如下所示：58181 34252 34220 11219 10335 22964

我还认为可能有一个更优雅的解决方案，它不使用“for each”。无论如何，谢谢大家的帮助。

# android - 无法将 android sdk 工具更新到 rev19

> ID：10194177
> 
> 赞同：1
> 
> 时间：2012-04-17T15:28:22.663
> 
> 标签：android, eclipse-indigo

我已经下载了 GoogleAPI，它说我必须更新 android sdk 工具。我在 sdk 管理器中执行此操作，但出现此错误：

```
Failed to rename directory C:\Users\Me\android-sdks\platform-tools to C:\Users\Me\android-sdks\temp\PlatformToolPackage.old01.
Skipping 'Android SDK Tools, revision 19'; it depends on 'Android SDK Platform-tools, revision 11' which was not installed. 
```

有什么建议吗？

我正在使用日食靛蓝。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:25:53.593

我们最近在几台计算机上看到了这一点。您可能会碰巧弄乱文件夹或重新启动...但最好卸载/重新安装始终有效的 Android SDK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:27:52.500

我很久以前就遇到过这个问题，SDKManager 会调用 tools/android.bat。这意味着它不可能移动文件。荒谬到最大，但复制粘贴工具目录并使用不同的名称并从那里运行它。为我工作

失败，请查看[无法升级 Android SDK 工具的链接](https://stackoverflow.com/questions/8559682/cant-upgrade-android-sdk-tools)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T18:25:23.897

每次更新我都有同样的问题。我在网络安全模式下重新启动，然后它没有任何问题。希望能帮助到你。乙

# git - 如何使用 Mercurial 为文件“替换为最新的头部”？

> ID：10194179
> 
> 赞同：3
> 
> 时间：2012-04-17T15:28:35.360
> 
> 标签：git, version-control, mercurial, replace

在 CVS 中，有时我会“用最新的从头替换”以放弃对文件的本地更改，因为本地更改可能会被搞砸，并且希望从该文件重新开始，同时保留对其他文件所做的任何未提交的本地更改. 如何在 Mercurial 和 Git 中做同样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T15:30:14.423

对于 Mercurial，请使用`hg revert`. 见`hg help revert`。

**编辑**

为了澄清，`hg revert`将*文件*更改为以前的版本。 `hg update`将*父变更集更改*为不同的修订。在这两种情况下，除非使用，否则未提交的更改将被保留`-C`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T15:33:18.917

在 GIT 中，如果您进行了尚未提交的本地更改，则：

```
git reset --hard 
```

将做两件事：1）从“索引”中删除内容（您已准备提交的内容）和 2）删除工作目录中的内容（您尚未准备提交的内容）。除了“--hard”还有其他选项，因此请使用“git help reset”检查文档 - 但是，根据您的问题，“--hard”将是选项。

如果您要撤消单个文件，那么

```
git checkout -- /path/to/file 
```

会成功的。[参见 'git status' 的输出，它描述了如何撤消一些更改]。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T00:11:16.987

对于 Mercurial： `hg revert fileName`将把该文件恢复到您所在的版本。

这将生成一个 fileName.orig 文件，因此您可以保留要还原的更改以防万一。如果要还原文件并且没有 .orig 文件，可以添加`-C`选项： `hg revert fileName -C`

# java - 如何使用 Avaya 实施 TAPI 解决方案

> ID：10194182
> 
> 赞同：3
> 
> 时间：2012-04-17T15:28:37.733
> 
> 标签：java, tapi, avaya, jtapi

我目前在我们的业务中对三星手机系统进行了有效的 CTI 集成。我们的桌面客户端正在运行定制的 Java 客户端，这些客户端从连接到三星 DCS 系统的定制服务器应用程序接收消息。

我们正在短期内获得一个新的 Avaya 电话系统，我想让它与我们现有的桌面客户端系统一起工作。因此，我不想在桌面客户端上安装任何新东西。我想编写一个连接到 Avaya 的替代服务器应用程序，然后使用从服务器到客户端的当前消息流程。

有人可以让我知道我应该看什么 API 来编写这个基于服务器的应用程序。它必须是基于 Java 的。

需要的两个关键是；1\. 必须通知服务器所有电话上的所有号码，以便向相关客户端发送消息。2\. 服务器必须能够代表客户端电话拨打外部号码。

任何正确方向的指针将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T21:34:55.213

你需要的API是JTAPI；您可以在 Avaya DevConnect 网站上找到它的文档：http: [//devconnect.avaya.com](http://devconnect.avaya.com)。您需要在那里注册，但它是免费的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T19:07:37.480

您还可以使用 Avaya 设备、媒体和呼叫控制 SDK (DMCC)，它是一种更新的、功能齐全的 API，涵盖了媒体、监控和高级呼叫控制操作。有关详细信息，请参阅[https://devconnect.avaya.com/public/dyn/d_dyn.jsp?fn=353](https://devconnect.avaya.com/public/dyn/d_dyn.jsp?fn=353)。

此 API 托管在与 Avaya Communication Manager 一起部署的 Avaya Aura AE 服务器 (AES) 之外。AES 托管许多不同的 API，包括 TSAPI 和 Web 服务。调查这个平台，看看它是否满足您的需求。

# java - 在声明中分配还是在构造函数中分配？

> ID：10194183
> 
> 赞同：2
> 
> 时间：2012-04-17T15:28:39.840
> 
> 标签：java, constructor

这之间有区别吗：

```
public class A {
    B b;
    A() {
        b=new B();
    }
} 
```

和这个 ：

```
public class A {
    B b=new B();
    A() {
    }
} 
```

如果有，那是什么？什么是更好的做法？如果没有，有什么推荐的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:33:06.013

据我所知，只要您只有一个构造函数，就没有区别。如果您有多个构造函数，则需要确保在所有构造函数中都分配了它。出于这个原因，我会推荐第二种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:38:34.603

构造函数在实例变量初始化之后运行，所以有区别。在一个小例子中并不重要，但对于更复杂的代码来说可能很重要。（注意，代码的顺序无关紧要。如果初始化在构造函数中，它会在第二个运行。）

第二种方法更方便，所以我倾向于从它开始。第一种方法可能更有用（对于控制反转和多态性），因此它经常用于“真实”代码中。

```
class B {
    B() {
        System.out.println("B constructor");
    }
}

public class A {
    B b=new B();

    A() {
        System.out.println("A constructor");
    }
    public static void main(String[] args) {
        new A();
    }

} 
```

输出：

```
B constructor
A constructor 
```

……

```
class B {
    B() {
        System.out.println("B constructor");
    }
}

public class A {
    B b;
    A() {
        System.out.println("A constructor");
        b=new B();
    }

    public static void main(String[] args) {
        new A();
    }
} 
```

输出：

```
A constructor
B constructor 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:38:17.190

他们之间的巨大差异。

在第一个选项中，B 类仅在调用不带参数的构造函数时实例化。如果您放置并调用任何参数化构造函数，B 类将不会实例化。

但是在第二个选项的情况下，无论任何构造函数调用如何，B 类都将始终实例化。

# android - 在 EditText 内填充提示文本

> ID：10194187
> 
> 赞同：13
> 
> 时间：2012-04-17T15:28:50.270
> 
> 标签：android, android-edittext, padding

我希望能够向 EditText 内显示的文本添加填充，使用

```
android:hint="some text" 
```

如果我只定期为 EditText 添加填充，它会为整个视图添加填充。我希望它用于为用户提供提示的文本，需要输入的内容。如果有人知道如何做到这一点，请给我反馈。

![在此处输入图像描述](../Images/1378186f851b12d7af07d67e9e3fdc00.png)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-02-21T23:50:30.683

您可能会在此答案中找到您的解决方案： [EditText set text start 10dp from left border](https://stackoverflow.com/questions/7751145/edittext-set-text-start-10dp-from-left-border)

它帮助我实现了用户名字段中的提示填充：

```
<EditText
 android:id="@+id/txtUsername"
 android:layout_width="match_parent"
 android:layout_height="30dp"
 android:layout_alignParentLeft="true"
 android:background="@drawable/bkg_login_txt_usuario"
 android:hint="@string/hint_username"
 android:paddingLeft="10dp"
 android:singleLine="true" >
 <requestFocus />
</EditText> 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-28T18:26:25.367

您可以使用`android:drawablePadding`which 表示可绘制文本和提示文本之间的填充。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-17T15:42:49.483

使用 TextChangedListener 和[TextWatcher](http://developer.android.com/reference/android/text/TextWatcher.html)来监视 EditText 中的文本。使用 TextWatcher 检查 EditText 是否为空并设置填充，否则删除填充。

# c# - 正则表达式电话号码和电话分机

> ID：10194190
> 
> 赞同：3
> 
> 时间：2012-04-17T15:29:01.653
> 
> 标签：c#, regex

我有一个正则表达式可以清理电话号码并将它们转换为有效的电话号码：+1 123-1223。

正则表达式：

```
Regex.Replace(phone, @"^\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*$", "+1 $1$2$3-$4$5$6-$7$8$9$10"); 
```

但我想添加它，所以超过 12 个数字的任何数字都会添加剩余的数字作为扩展名。因此，如果号码是 810.232.122323，它将变为 +1 810-232-1223 x23。

这可以通过更改正则表达式来实现吗？有没有好的方法来做到这一点？我不太了解正则表达式。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:34:49.290

只需将其添加到末尾，它将是您的第 11 组（除非它实际上有 2 位数或更多位数，否则它不会接听分机

```
(\d{2,}) 
```

代码将是：

```
Regex.Replace(phone, 
    @"^\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d{2,})$", 
    "+1 $1$2$3-$4$5$6-$7$8$9$10 Ext $11"); 
```

如果这是可选的，请执行以下操作：

```
(\d{2,})? 
```

它仍然会匹配您的电话号码，但不会像上面那样强制分机

要使这个可选也不使用分机，那么你需要使用`MatchEvaluator`

像这样的东西（但我面前没有编译器，所以它可能会偏离一点，应该进行测试）

```
Regex.Replace(phone, 
    @"^\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d)\D*(\d{2,})$", 
    "+1 $1$2$3-$4$5$6-$7$8$9$10 Ext $11");
     match =>
     {
         var returnVal = "+1 ";
         for(int i = 1; i <= 3; i++)
         {
             returnVal += match.Groups[i].Value;
             if(i == 3 || i == 6)
                 returnVal += "-";
         }
         returnVal += match.Groups[11].Success ? " Ext " + match.Groups[11] : "" )
         return returnVal;
     }
) 
```

# python - 数组中值比较的pythonic方法？

> ID：10194191
> 
> 赞同：1
> 
> 时间：2012-04-17T15:29:02.020
> 
> 标签：python, arrays, csv, rows

问题：

1.  输入是一个制表符分隔的文件。行是变量，列是样本。变量可以采用三个值 (00,01,11)，并按照需要维护的顺序 (v1->vN) 列出。行数多，列数多，所以需要分块读取输入文件。

    输入如下所示：

    ```
     s1 s2 s3 s4
    v1 00 00 11 01
    v2 00 00 00 00
    v3 01 11 00 00
    v4 00 00 00 00
    (...) 
    ```

2.  我想要做的是将输入分成几行的片段，其中片段足够大，样本每个都是唯一的。在上面的例子中，从 v1 开始，第一个块应该在 v3 结束，因为在那个点有足够的信息，样本是唯一的。下一个块将从 v4 开始并重复该过程。到达最后一行时任务结束。块应打印在输出文件中。

* * *

我的尝试：

我试图做的是使用 csv 模块生成一个由列表组成的数组，每个列表包含所有样本的单个变量 (00,01,00) 的状态。或者，通过旋转输入，为每个变量创建包含样本状态的列表。我在问工作是否应该集中在列或行上，*即*是否更好地使用 v1=['00','00','11','01'] 或 s1=['00',' 00','01','00',...]

以下代码是指我试图将列问题更改为行问题的旋转操作。（对不起笨拙的python语法，这是我能做的最好的）

```
my_infilename='my_file.txt'
csv_infile=csv.reader(open(my_infilename,'r'), delimiter='\t')
out=open('transposed_'+my_infilename, 'w')
csv_infile=zip(*csv_infile)
line_n=0
for line in csv_infile:
line_n+=1
    if line_n==1:    #headers
        continue
    else:
        line=(','.join(line)+'\n')  #just to make it readable to me
        out.write(line)
out.close() 
```

解决这个问题的最佳方法是什么？旋转有什么帮助吗？有没有我可以依赖的内置功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:59:23.517

假设您将 csv 数据导入为长度相同的列表列表，这对您有什么作用...

```
def get_block(data_rows):
    samples = []

    for cell in data_rows[0]:
        samples.append('')

    # add one row at a time to each sample and see if all are unique
    for row_index, row in enumerate(data_rows):
        for cell_index, cell in enumerate(row):
            samples[cell_index] = '%s%s' % (samples[cell_index], cell)

        are_all_unique = True
        sample_dict = {} # use dictionary keys to find repeats
        for sample in samples:
            if sample_dict.get(sample):
                # already there, so another row needed
                are_all_unique = False
                break
            sample_dict[sample] = True # add the key to the dictionary
        if are_all_unique:
            return True, row_index

    return False, None

def get_all_blocks(all_rows):
    remaining_rows = all_rows[:] # make a copy    
    blocks = []

    while True:
        found_block, block_end_index = get_block(remaining_rows)
        if found_block:
            blocks.append(remaining_rows[:block_end_index+1])
            remaining_rows = remaining_rows[block_end_index+1:]
            if not remaining_rows:
                break
        else:
            blocks.append(remaining_rows[:])
            break

    return blocks

if __name__ == "__main__":
    v1 = ['00', '00', '11', '01']
    v2 = ['00', '00', '00', '00']
    v3 = ['01', '11', '00', '00']
    v4 = ['00', '00', '00', '00']

    all_rows = [v1, v2, v3, v4]

    blocks = get_all_blocks(all_rows)

    for index, block in enumerate(blocks):
        print "This is block %s." % index
        for row in block:
            print row
        print 
```

==================

这是块 0。

['00', '00', '11', '01']

['00', '00', '00', '00']

['01', '11', '00', '00']

这是块 1。

['00', '00', '00', '00']

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:21:54.690

我根本不理解您的问题（“协调变量”？“明确地确定样本”？），但我知道您错误地使用了 csv 模块并且您的缩进也不正确。

我不确切知道您输入的文件是什么样的，但假设它是制表符分隔的，下面的（未经测试的）脚本显示了一种从输入文件中获取块、转动它们并重写到输出文件的方法。

```
import csv

# this is not strictly necessary, but you can define a custom dialect for input and output

class SampleDialect (csv.Dialect):
    delimiter = "\t"
    quoting = csv.QUOTE_NONE    

sampledialect = SampleDialect()

ifn = 'my_file.txt'
ofn = 'transposed_'+ifn

ifp = open(ifn, 'rb')
ofp = open(ofn, 'wb')

incsv = csv.reader(ifp, dialect=sampledialect)
outcsv = csv.writer(ofp, dialect=sampledialect)

header = None
block = []
for lineno, samples in enumerate(incsv):
    if lineno==0: #header
        header = samples
        continue
    block.append(samples)
    if lineno%3:
        # end of block
        # do something with block
        # then write it out
        outcsv.writerows(block)
        block = []

ifp.close()
ofp.close() 
```

# android - 如何在android的应用程序启动中检查互联网是否可用？

> ID：10194192
> 
> 赞同：7
> 
> 时间：2012-04-17T15:29:03.707
> 
> 标签：android, connectivity

我的应用程序首先从互联网加载数据（我正在使用网络服务）我想在应用程序启动时检查互联网访问。

1.  我想检查一下 3G 或 WIFI 或 GPRS 或任何其他形式的互联网是否可用。
2.  如果不可用，请向用户发送“**您需要访问互联网**”之类的消息并退出应用程序。（目前，如果无法访问互联网，我的应用程序中会出现强制关闭错误）
3.  如果可用，请正常启动我的应用程序。
4.  此外，我的应用程序在不同阶段从 web 服务获取数据，在每个阶段或操作之前，我想首先检查互联网访问。

我该怎么做呢 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T04:54:01.987

你可以使用我的方法：

```
public static boolean isNetworkAvailable(Context context) 
{
    ConnectivityManager connectivity = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);

    if (connectivity != null) 
    {
        NetworkInfo[] info = connectivity.getAllNetworkInfo();

        if (info != null) 
        {
            for (int i = 0; i < info.length; i++) 
            {
                Log.i("Class", info[i].getState().toString());
                if (info[i].getState() == NetworkInfo.State.CONNECTED) 
                {
                    return true;
                }
            }
        }
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T15:54:16.447

您可以使用`ConnectivityManager`. 所有需要的信息都在这里

[http://developer.android.com/reference/android/net/ConnectivityManager.html](http://developer.android.com/reference/android/net/ConnectivityManager.html)

您可能希望在`onStart()`初始活动的方法中加入这样的内容（取决于代码中连接的启动位置和数据的下载位置）

```
ConnectivityManager cm =  (ConnectivityManager) Context.getSystemService(Context.CONNECTIVITY_SERVICE);

if (cm.getAllNetworkInfo().isConnected()) {
 //proceed with loading 
} else { 
//showErrorDialog 
} 
```

我还没有测试过代码，所以剪切和粘贴可能不是一个好主意，但这应该会给你一个很好的起点。如果您查看文档，还有很多其他信息。

此外，通过更改代码来处理缺乏连接可能是一个想法，这样如果没有连接它就不会崩溃，可能会显示默认加载屏幕？此外，即使有可用的连接，您的应用也可能无法获取数据，因此您也需要处理这种情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T05:58:16.920

```
NetworkInfo i = conMgr.getActiveNetworkInfo();
  if (i == null)
    return false;
  if (!i.isConnected())
    return false;
  if (!i.isAvailable())
    return false;
  return true; 
```

# c - 带有源列表的 MPI_Recv

> ID：10194197
> 
> 赞同：1
> 
> 时间：2012-04-17T15:29:26.857
> 
> 标签：c, fortran, mpi

是否可以将源列表传递给 MPI_Recv（或等效）调用？目前，我的代码看起来像：

```
do i=nod1,nod2
    call mpi_recv(tmp,n,MPI_REAL,MPI_ANY_SOURCE,tag,MPI_COMM_WORLD,status,ierr)
    ... do stuff with tmp here
    call mpi_send(tmp,n,MPI_REAL,status(MPI_SOURCE),tag,MPI_COMM_WORLD,ierr)
enddo 
```

当然，这并不能保证它会做我想要的。（如果 nod1 在 nod2 可以发送一条消息之前在这里发送了两条消息，那么在此迭代期间不会收到 nod2 的消息，这会很糟糕。）在我的应用程序中，这不会发生，因为 nod1 和 nod2 有其他约束迫使他们彼此同步（足够）......但这让我想知道是否有办法指定允许接收的proc列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:38:22.577

不是这样的。但是，您可以使用`MPI_Probe()`with `MPI_ANY_SOURCE`，然后将对象的`MPI_SOURCE`字段与`status`您希望从中接收的进程列表进行比较。如果有匹配项，您可以通过常规阻塞接收继续从该源接收。

# spring - JUnit测试：空指针异常

> ID：10194204
> 
> 赞同：0
> 
> 时间：2012-04-17T15:29:44.860
> 
> 标签：spring, hibernate, spring-mvc, extjs, junit

我正在使用带有 EXT JS 的 Spring 和 hibernate 在使用 tomcat 的网页上填充 EXT JS 表单...我使用访问数据库并返回我的 HQL 语句的方法填充表

现在我正在尝试执行一个简单的 JUnit 测试来计算返回的记录数，但是当我调用填充 EXT JS 表单的 JUint 测试中的方法时，它返回这个异常......我不知道为什么

JUnit 测试类

```
package com.fexco.helloworld.web;

import static org.junit.Assert.assertEquals;

import java.util.List;

import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;

import com.fexco.helloworld.web.dao.CustomerDaoImpl;
import com.fexco.helloworld.web.model.Customer;

/**
* Unit test for simple App.
*   /
public class CustomerServiceTest {

@Autowired
private CustomerDaoImpl customerDaoImpl;

@Test
public void findAllCustomersTest() {        
    List<Customer> list = customerDaoImpl.findAllCustomers();
    int numberInDatabase = list.size();
    assertEquals(5, numberInDatabase);
}

} 
```

我访问数据库的方法

```
public List<Customer> findAllCustomers(){
    List<Customer> list = getHibernateTemplate().find("from Customer");
    return list;
} 
```

和我的方法调用访问数据库的方法

```
public List<Customer> returnAllCustomers(){
    List<Customer> list = customerDaoImpl.findAllCustomers();
    return list;
} 
```

您可以在此处看到该表单使用与 junit(findAllCustomers()) 中相同的方法填充了数据库中的项目

![在此处输入图像描述](../Images/fe5680546ce85879e79377480087147f.png)

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T15:41:46.440

在 CustomerServiceTest 类之前添加以下行

```
@RunWith(SpringJUnit4ClassRunner.class)  
@ContextConfiguration(locations = { "file:src/main/resources/app-context.xml" })
 public class CustomerServiceTest {.... 
```

其中 src/main/resources/app-context.xml - 是应用程序上下文的路径。很好，为测试创建单独的上下文。

**编辑**

您还需要`spring-test.jar`在类路径中。对maven的依赖：

```
 <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <version>${spring-version}</version>
        </dependency> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:38:15.253

您没有在单元测试中加载 Spring 上下文。

您可以在这里查看 Spring 文档：http: [//static.springsource.org/spring/docs/3.0.5.RELEASE/reference/testing.html](http://static.springsource.org/spring/docs/3.0.5.RELEASE/reference/testing.html)

还有一个例子：[Spring：JUnit-Test：applicationContext 未加载](https://stackoverflow.com/questions/1356312/spring-junit-test-applicationcontext-is-not-loaded)

# mysql - 我想创建一个数据库，目标是用通过 shell 脚本获得的全面库存信息填充这个数据库

> ID：10194205
> 
> 赞同：-1
> 
> 时间：2012-04-17T15:30:02.590
> 
> 标签：mysql, database, bash, postgresql

我想创建一个数据库，其目标是使用通过每个客户端计算机的 shell 脚本获得的全面库存信息填充该数据库。我的 shell 脚本当前通过 ssh 连接将此信息写入位于服务器上的单个 csv 文件。当然，如果这个脚本要同时在多台机器上运行，它可能会导致问题，因为每个客户端都可能会尝试同时写入 csv。

一开始，库存就是我所追求的；然而，经过更多的思考，我开始思考在我收集到这些信息之后是否还有更多可能。如果我将这些信息包含在数据库中，我可能能够利用这些信息根据特定机器或“类似”机器组的信息来初始化其他进程。需要注意的是，我目前已经通过识别特定的机器信息来管理多个进程。但是，在匹配唯一标识符（在我看来）之后从数据库中提取该信息可以大大提高效率。还允许更多的服务器端方法减少大多数客户端脚本。

我对 SQL 完全陌生，不确定它是否 100% 必要。有必要吗？现在我决定在不同的 Mac 上下载并安装 PostgreSQL 和 MySQL 进行测试。我对 stackoverflow 也很陌生，如果这是一个不恰当的问题或问题风格，我会提前道歉。包括重定向在内的任何帮助将不胜感激。

我不希望以任何方式一步一步地回答，而只是希望有一个通用的“继续......”“这确实可以完成......”或“不要打扰有一个更简单的解决方案”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:41:15.673

由于我来自 PostgreSQL 世界，我强烈推荐使用它，因为它具有强大的企业级功能和高标准合规性。

我总是喜欢为我正在做的每个项目建立一个数据库，以获得以下好处：

1.  标准化数据更易于处理和构建报告；

2.  由于数据库引擎完成的缓存、数据索引、优化的查询路径，数据库查询的性能会更好；

3.  使用 可以大大提高机器数据处理能力[`SQL/MED`](http://wiki.postgresql.org/wiki/SQL/MED)，可以直接从数据库中查询外部数据源。您可以查看 [Multicorn 项目](http://multicorn.org/)及其提供的示例。

4.  如果需要向您的管理层提供任何类型的报告，DB 将是您的朋友，而在 DB 之外执行此操作将过于复杂。

很快——去数据库！

# resize - 有没有办法调整 MdiTab 的大小以适应您新更新的文本？（基础设施）

> ID：10194206
> 
> 赞同：0
> 
> 时间：2012-04-17T15:30:09.493
> 
> 标签：resize, infragistics, mdi, autoresize, fontmetrics

我正在重置 UltraWinTabbedMdi 中 MdiTab 的文本。我将它重置为粗体和更长，但选项卡不会调整大小，因此文本被截断。现在，我只是将选项卡的大小重置为我发现在我的计算机上看起来不错的某个幻数，但我不知道它是否可以在其他地方工作。我希望能够获得新文本的尺寸并每次添加相同的大小或调用一些自动调整大小的方法。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:44:34.090

您可以使用 Graphics 类的 MeasureString。

```
// Set up string.
string measureString = "YourText";
// The font name and size used to draw the string (from your MdiTab)
Font stringFont = new Font("Arial", 16);

// Measure string.
SizeF stringSize = new SizeF();
stringSize = this.Graphics.MeasureString(measureString, stringFont);

// now you have a stringSize.Width and stringSize.Height to use 
```

# java - 为什么scanner.hasNextLine() 挂起？

> ID：10194211
> 
> 赞同：0
> 
> 时间：2012-04-17T15:30:21.513
> 
> 标签：java, java.util.scanner

当我尝试在我的程序上使用scanner.hasNextLine() 时，它只是坐在那里挂起。我想知道是否有任何方法可以解决此问题或我可以使用的任何替代方法。编辑：这背后的原因是我可以从扫描仪中删除所有内容（扫描仪中只有一行）。因此，如果有办法从扫描仪中删除所有内容，那就更容易了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T15:42:01.257

这回答了你的问题了吗？ [StackOverFlow：为什么-does-hasnextline-never-end](https://stackoverflow.com/questions/5653338/why-does-hasnextline-never-end)

如果没有，请在此处放置您的代码示例，以获得关于您的问题的更具描述性的答案。您很可能正在阅读永无止境的内容。如果您有文件或字符串，则应该没有问题，但是如果您正在读取恒定的数据流，则它可能会挂起，具体取决于您的代码的编写方式以及您读入扫描仪的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:36:09.337

查看 api `java.util.scanner`（因为我假设这是您正在使用的类。

[http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)

注意`hasNextLine`文档：

如果此扫描仪的输入中有另一行，则返回 true。**此方法可能会在等待输入时阻塞。**扫描仪不会超过任何输入。

（强调我的）

因此，如果您有一个未关闭的打开流，它将阻塞直到另一行进入，或者流被关闭。

# html - HTML 页面上的在线文档编辑工具

> ID：10194216
> 
> 赞同：0
> 
> 时间：2012-04-17T15:30:40.697
> 
> 标签：html, document, editing

我有一个 html 页面，我希望用户来编辑/添加文本到页面的特定区域。有没有我可以嵌入的工具，以便用户可以添加内容，点击保存并完成。

如果没有嵌入，是否有我可以使用的工具并向用户提供链接，以便他们可以去那里然后添加内容并点击保存，他们就完成了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:34:28.803

看看[http://www.tinymce.com/](http://www.tinymce.com/)

# php - PDO和缓存，如何在数据库类中实现？

> ID：10194223
> 
> 赞同：3
> 
> 时间：2012-04-17T15:31:08.573
> 
> 标签：php, mysql, database, caching, pdo

使用 PDO 和 MySQL 时，缓存我知道我将在同一页面上多次使用的结果有什么好处吗？或者 PDO / MySQL 会自动处理这种事情吗？

如果我应该自己做，我应该存储查询的实际结果，还是我可以将 PDOStatements 存储在缓存中并重用它们？

当然，我可以将我知道要在一个页面上多次使用的任何结果存储在一个变量中，但是让我的数据库类透明地处理这类事情似乎更干净。例如，我希望能够调用 $DB->get_username_by_id($id) 而不必担心它是直接来自数据库还是来自缓存。

或者，也许我会放弃创建自己的数据库类的想法，如果你们中的任何人能指出我的超轻量级、易于使用、有效、多功能的，它可以在共享主机上与 PDO 和 MySQL 一起使用。 .

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:37:46.113

这可以帮助你[PHP PDO 缓存](https://stackoverflow.com/questions/1884576/php-pdo-caching)

如果你使用 PDO，那么 PDO::Prepare 就是你的朋友：

调用 PDO::prepare() 和 PDOStatement::execute() 为将使用不同参数值多次发出的语句通过允许驱动程序协商查询计划的客户端和/或服务器端缓存来优化应用程序的性能和元信息，并通过消除手动引用参数的需要来帮助防止 SQL 注入攻击。

[http://php.net/manual/en/pdo.prepare.php](http://php.net/manual/en/pdo.prepare.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:37:25.073

Well id 总是建议使用现有的库而不是自定义的东西，除非你有一个很好的借口不这样做。在这种情况下，id 说[Doctrine DBAL，](http://www.doctrine-project.org/projects/dbal.html)因为您似乎没有使用对象来保存您的数据。如果您想使用完整的 OOP 路线并将数据映射到特定对象，那么请使用完整的[Doctrine ORM](http://www.doctrine-project.org/projects/orm.html)。

# parsing - BIson解析函数和参数顺序错误

> ID：10194225
> 
> 赞同：1
> 
> 时间：2012-04-17T15:31:10.220
> 
> 标签：parsing, bison

我正在编写一个带有 flex 和 bison 的解析器，到目前为止，这些标记用于 flex：

```
[ \t\n] ;
(x[0-9]+)   {
    yylval.var = strdup(yytext);
    return VARIABLE;
}
~(x[0-9]+)  {
    yylval.var = strdup(yytext);
    return NEG_VARIABLE;
}
[a-zA-Z0-9]+ {
                yylval.name = strdup(yytext);
                return NAME;
            }
~[a-zA-Z0-9]+ {
                    yylval.name = strdup(yytext);
                    return NEG_NAME;
                }
[\{\},\(\)] { return yytext[0];}
. ; 
```

野牛的这些解析规则是：

```
fol:
        clauses {cout << "Done with file"<<endl;}
        ;
clauses:
        clauses clause
        | clause
        ;
clause:
        startc terms endc
        ;
startc:
        '{' {cout << "Bison found start of clause" << endl;}
        ;
endc:
        '}' {cout << "Bison found end of clause" << endl;}
        ;
function:
        NAME startfun endfun {cout << "Bison found a function " << $1 << endl;}
        |NEG_NAME startfun endfun {cout << "Bison found a negative function " << $1 << endl;}
        ;
startfun:
        '(' {cout << "Bison found start of params" << endl;}
        ;
endfun:
        terms ')' {cout << "Bison found a function end" << endl;}
        ;
terms:
        terms ',' term
        | term
        ;
term:
        VARIABLE {cout << "Bison found a variable "<< $1 << endl;}
        | NEG_VARIABLE {cout << "Bison found a negative variable " << $1 << endl;}
        | NAME {cout << "Bison found a constant " << $1 << endl;}
        |function
        ; 
```

现在一切都很好，除了当它解析一个函数时，它首先解析参数和括号，然后在最后给我函数名。我可以解决这个问题，但这让我的生活变得更加困难，因为我将函数存储为不相交的集合，并且我需要保留参数列表，直到我可以获得函数的名称来创建根，然后将它们联合起来直接创建它。

谁能告诉我如何让 Bison 在参数之前给我函数名？我已经尝试了一个多小时没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:06:51.553

“在参数之前给我函数名”是什么意思？`endfun`目前，在看到和 reduce 函数规则（在各种参数规则之后）之前，您不会打印函数名称。通常的技术是让术语规则生成一个可以在函数规则中使用的事物列表：

```
terms:  terms ',' term { $$ = append_list($1, $3); }
     |  term { $$ = create_singleton_list($1); }
     ;

term:   VARIABLE { $$ = new VariableTerm($1); } 
```

...

或者，如果您只想打印出来，您可以在看到函数名称后立即减少规则：

```
function: funcname startfun endfun {cout << "Bison ending a function " << $1 << endl;}
        ;

funcname: NAME { cout << "Starting a function " << ($$ = $1) << endl; }
        | NEGNAME { cout << "Starting a negative function " << ($$ = $1) << endl; }
        ; 
```

# c# - 在中继器控件的项目模板内对齐控件？

> ID：10194227
> 
> 赞同：0
> 
> 时间：2012-04-17T15:31:30.710
> 
> 标签：c#, asp.net, css

我有一个带有图像的转发器控件和一个位于另一个下方的超链接。每次我添加多行文本时，文本都会将 imahe 控件向上推。如果有超过一行的文本，我希望图像的顶部水平对齐并且文本继续向下。请指教。

![对齐错误](../Images/05b3f95693ec059e2d2adbc98146dd40.png)

这是我使用的 ascx 代码：

```
<asp:MultiView ID="MultiView1" runat="server" ActiveViewIndex="0"> 
<asp:View ID="View1" runat="server"> 

<asp:UpdatePanel ID="UpdatePanelAnnouncements" runat="server"  UpdateMode="Conditional">
<ContentTemplate>

<table>
<tr>
    <asp:Repeater ID="repAnnouncements" runat="server">
        <ItemTemplate>
            <td style="padding-right:19px; padding-top:1px; padding-left:7px;">
                <asp:HiddenField ID="ItemID" Value='<%#Eval("ID") %>' runat="server" />
                <asp:HyperLink ID="hypImageEditLink" runat="server">

                <div class="ImageStyle" >
                <asp:Image ID="imgLink" Height="110px" Width="150px" runat="server" ImageUrl='<%#Eval("Images")%>' CssClass ="magnify"/>
                </div>

                </asp:HyperLink>
                <br/><br/>
                <div id="div3" class="Div3"><asp:HyperLink ID="hypTextEditLink" runat="server" Text='<%#Eval("Title")%>' CssClass="TitleStyle"/></div>
            </td>
        </ItemTemplate>
    </asp:Repeater>
 </tr>
</table>

</ContentTemplate>
</asp:UpdatePanel>
</asp:View> 
```

这是样式表：

```
.div3
{
  width: 150px !important; 
  display:inline !important;  
  /*display: -moz-inline-box !important; 
  display: inline-block !important; */
  float:left !important;
}

 .ImageStyle
 {
   margin-left:8px;
   /* Width:150px !important; Height:110px !important;
   box-shadow: 0px 0.5px 35px 15px #888888;*/
   border-collapse: separate !important;
   box-shadow: 0px 0.5px 11px 4px #888888;
  /*box-shadow:  0px 0.5px 11px 4px rgb(150,150,150);*/
 }

  .ImageStyle:hover
    {
      opacity:0.5 !important;
      filter: alpha(opacity=50) !important;
      border-color:blue !important;
      border-width:thick !important;

     } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T15:41:08.230

据我了解您的问题，当图片下方有很多文字时，它会导致其余图片在其单元格中间垂直对齐。要解决此问题，请将您的 TD 标签更改为以下内容：

```
<td style="vertical-align: top; padding-right:19px; padding-top:1px; padding-left:7px;"> 
```

# vb.net - 替换第 n 次出现的字符串

> ID：10194228
> 
> 赞同：0
> 
> 时间：2012-04-17T15:31:34.783
> 
> 标签：vb.net

这应该很简单，但我正经历着这样的一天。谁能告诉我如何替换字符串中第一次和第三次出现的字符？我已经查看了替换，但由于字符串可能具有不同的长度，因此无法正常工作。我要做的就是替换第一次和第三次出现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T15:59:46.703

[IndexOf](http://msdn.microsoft.com/en-us/library/5xkyx09y.aspx)方法有一个重载，它将起始位置作为参数。使用循环，您将能够找到第一次和第三次出现的位置。然后您可以使用[Remove](http://msdn.microsoft.com/en-us/library/d8d7z2kk.aspx)和[Insert](http://msdn.microsoft.com/en-us/library/system.string.insert.aspx)方法的组合来进行替换。

您还可以使用[StringBuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder%28v=vs.100%29.aspx)进行替换。有`StringBuilder`一个[Replace](http://msdn.microsoft.com/en-us/library/ms149403.aspx)方法，您可以为其指定起始索引和受影响的字符数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:39:13.650

有抱负的程序员，

也许这样的东西可能对你有用（与 Meta-Knight 所说的 <+1> 一致）

```
Dim str As String = "this is a test this is a test this is a test"
Dim first As Integer
Dim third As Integer
Dim base As Integer = 0 
Dim i As Integer
While str.length > 0 
    If i = 0 Then
        first = str.IndexOf("test")
    else if i = 2 Then
        third = base + str.IndexOf("test")
    end if
base = base + str.IndexOf("test")
str = str.Remove(0, str.IndexOf("test") + "test".length -1 )
i++
End While 
```

它可能在某处出现一次性错误......但这至少应该让你开始。

# sql-server - 从数据库的所有表中删除所有行

> ID：10194231
> 
> 赞同：0
> 
> 时间：2012-04-17T15:31:46.280
> 
> 标签：sql-server, sql-server-2008, tsql, sql-server-2005

一定有人已经编写了一个脚本来删除数据库所有表中的所有行。使用 DELETE 命令不是一个选项，因为它在大型表上可能需要很长时间。当然，stackoverflow 和其他地方有很多示例，但它们不适用于使用外键的表。

基本上，脚本应该这样做：

*   将所有外键定义存储在临时表中
*   删除所有外键
*   截断所有表
*   恢复外键

我想我有它：

```
IF OBJECT_ID('tempdb..#ForeignKeys') IS NOT NULL
    DROP TABLE #ForeignKeys;

WITH ForeignKeys AS (
SELECT
    QUOTENAME(SCHEMA_NAME(t.schema_id)) + '.' + QUOTENAME(t.name) AS ParentTable
    , QUOTENAME(SCHEMA_NAME(rt.schema_id)) + '.' + QUOTENAME(rt.name) AS ReferenceTable
    , QUOTENAME(f.name) AS ConstraintName
    , STUFF(Parent.Cols, 1, 1, '') AS ParentColumns
    , STUFF(Reference.Cols, 1, 1, '') AS ReferenceColumns
    , REPLACE(f.update_referential_action_desc, '_', ' ') AS UpdateAction
    , REPLACE(f.delete_referential_action_desc, '_', ' ') AS DeleteAction
FROM
    sys.tables AS t
    LEFT JOIN sys.foreign_keys AS f
        ON f.parent_object_id = t.object_id
        AND f.type = 'F'
    LEFT JOIN sys.tables AS rt
        ON f.referenced_object_id = rt.object_id
    CROSS APPLY
    (
        SELECT
            ',' + QUOTENAME(COL_NAME(fc.parent_object_id, fc.parent_column_id))AS [text()]
        FROM
            sys.foreign_key_columns AS fc
        WHERE
            fc.constraint_object_id = f.object_id
        ORDER BY
            fc.constraint_column_id
        FOR XML PATH('')
    ) Parent(Cols)
    CROSS APPLY
    (
        SELECT
            ',' + QUOTENAME(COL_NAME(fc.referenced_object_id, fc.referenced_column_id)) AS [text()]
        FROM
            sys.foreign_key_columns AS fc
        WHERE
            fc.constraint_object_id = f.object_id
        ORDER BY
            fc.constraint_column_id
        FOR XML PATH('')
    ) Reference(Cols)
)
SELECT
    ParentTable AS TableName
    , 'ALTER TABLE ' + ParentTable + ' DROP CONSTRAINT ' + ConstraintName  AS DropCmd
    , 'TRUNCATE TABLE ' + ParentTable AS TruncateCmd
    , 'ALTER TABLE ' + ParentTable + ' ADD CONSTRAINT ' + ConstraintName + ' FOREIGN KEY('
        +  ParentColumns + ') REFERENCES ' + ReferenceTable + ' (' + ReferenceColumns 
        + ') ON UPDATE ' + UpdateAction 
        + ' ON DELETE ' + DeleteAction  COLLATE SQL_Latin1_General_CP1_CI_AS AS CreateCmd
INTO
    #ForeignKeys
FROM
    ForeignKeys
ORDER BY
 1;

-- SELECT * FROM #ForeignKeys

DECLARE @TableName SYSNAME
DECLARE @Sql NVARCHAR(MAX)

-- Drop all constraints
DECLARE FkCursor CURSOR FOR 
SELECT
    TableName
    , DropCmd
FROM
    #ForeignKeys
WHERE
    DropCmd IS NOT NULL     

OPEN FkCursor  
FETCH NEXT FROM FkCursor INTO @TableName, @Sql
WHILE @@FETCH_STATUS = 0  
BEGIN  
    PRINT @TableName + ' : ' + @sql
    EXEC sp_executesql @Sql
    FETCH NEXT FROM FkCursor INTO @TableName, @Sql
END
CLOSE FkCursor
DEALLOCATE FkCursor

-- Truncate all tables
DECLARE FkCursor CURSOR FOR 
SELECT
    TableName
    , TruncateCmd
FROM
    #ForeignKeys     

OPEN FkCursor  

FETCH NEXT FROM FkCursor INTO @TableName, @Sql
WHILE @@FETCH_STATUS = 0  
BEGIN  
    PRINT @TableName + ' : ' + @sql
    EXEC sp_executesql @Sql
    FETCH NEXT FROM FkCursor INTO @TableName, @Sql
END
CLOSE FkCursor
DEALLOCATE FkCursor

-- Create all foreign keys
DECLARE FkCursor CURSOR FOR 
SELECT
    TableName
    , CreateCmd
FROM
    #ForeignKeys
WHERE
    CreateCmd IS NOT NULL      

OPEN FkCursor  
FETCH NEXT FROM FkCursor INTO @TableName, @Sql
WHILE @@FETCH_STATUS = 0  
BEGIN  
    PRINT @TableName + ' : ' + @sql
    EXEC sp_executesql @Sql
    FETCH NEXT FROM FkCursor INTO @TableName, @Sql
END
CLOSE FkCursor
DEALLOCATE FkCursor

DROP TABLE #ForeignKeys; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T17:03:06.533

```
DECLARE @drop     nvarchar(max) = N'', 
        @truncate nvarchar(max) = N'', 
        @create   nvarchar(max) = N'';

;WITH x AS
(
    SELECT id = f.[object_id],
      cname = QUOTENAME(f.name),
      ctable = QUOTENAME(OBJECT_SCHEMA_NAME(f.parent_object_id)) 
        + N'.' + QUOTENAME(OBJECT_NAME(f.parent_object_id)),
      ccol = QUOTENAME(COL_NAME(fc.parent_object_id,fc.parent_column_id)),
      rtable = QUOTENAME(OBJECT_SCHEMA_NAME(f.referenced_object_id))
        + N'.' + QUOTENAME(OBJECT_NAME(f.referenced_object_id)),
      rcol = QUOTENAME(COL_NAME(fc.referenced_object_id,fc.referenced_column_id)),
      ou = f.update_referential_action_desc COLLATE SQL_Latin1_General_CP1_CI_AS,
      od = f.delete_referential_action_desc COLLATE SQL_Latin1_General_CP1_CI_AS
    FROM sys.foreign_keys AS f
    INNER JOIN sys.foreign_key_columns AS fc
    ON f.[object_id] = fc.constraint_object_id
    -- where clause to leave out certain tables here
),
y AS
(
  SELECT 
    d = CHAR(13) + CHAR(10) + N'ALTER TABLE ' + ctable + N' DROP CONSTRAINT ' + cname + ';',
    c = CHAR(13) + CHAR(10) + N'ALTER TABLE ' + ctable + N' ADD CONSTRAINT ' + cname 
      + ' FOREIGN KEY (' + STUFF((SELECT N',' + ccol FROM x AS x2 
        WHERE x2.id = x.id FOR XML PATH(''),
        TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 1, N'')
      + N') REFERENCES ' + rtable + N'(' + STUFF((SELECT N',' + rcol FROM x AS x3 
        WHERE x3.id = x.id FOR XML PATH(''),
        TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 1, '') + N')'
    + CASE WHEN od <> N'NO_ACTION' THEN 
      ' ON DELETE ' + REPLACE(od, N'SET_', N'SET ') ELSE N'' END
    + CASE WHEN ou <> N'NO_ACTION' THEN 
      ' ON UPDATE ' + REPLACE(ou, N'SET_', N'SET ') ELSE N'' END
  FROM x
)
SELECT 
  @drop = @drop + d, 
  @create = @create + c
FROM y GROUP BY d,c;

SELECT @truncate = @truncate + CHAR(13) + CHAR(10) + N'TRUNCATE TABLE ' 
  + QUOTENAME(SCHEMA_NAME(schema_id)) + N'.' + QUOTENAME(name) + N';'
  FROM sys.tables
  -- where clause to leave out certain tables here
;

-- use results to text. Note that for 200 tables you won't be able to
-- manually inspect the entire script in Management Studio because it
-- will only show a certain number of characters depending on settings.

SELECT @drop;
SELECT @truncate;
SELECT @create;

-- when you are happy, uncomment these:

--EXEC sys.sp_executesql @drop;
--EXEC sys.sp_executesql @truncate;
--EXEC sys.sp_executesql @create; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:34:52.047

右键单击对象（在对象资源管理器中），然后单击 Script as--> drop to。使用相同的方法和 Script as--> Create to。这应该为您提供删除脚本以及在数据库中创建所有对象。按照您喜欢的顺序运行它们。

或者，如果您有很多表和对象，您可以右键单击数据库--> 转到任务并单击生成脚本。![在此处输入图像描述](../Images/6bc37c84fb19b36a39823cb2dc80726a.png)

# django - 在 DJANGO 管理员上将图像保存为 [self.id].jpg

> ID：10194235
> 
> 赞同：2
> 
> 时间：2012-04-17T15:31:52.990
> 
> 标签：django, django-models, django-admin

我需要一个 django 管理员才能上传应保存为 /path/{self.id}.jpg 的图像

到目前为止，我有一个带有 id、status、title 字段的数据库和一个带有 id、status、title、THUMB 字段的模型：

```
class MEL(models.Model):
    id = models.AutoField(primary_key=True, editable=False)
    status = models.IntegerField(choices=( (0, 'inactive'), (1, 'active') ), default=1)
    title = models.TextField(verbose_name='Título')
    thumb = models.ImageField(upload_to=upload_path)

    class Meta:
        db_table = u'MEL' 
```

问题是图像之前上传到正在保存的模型中，所以我现在无法将它保存到“self.id”。我想我可以将它保存到 /tmp/{uuid} 然后在保存后重命名它，可能类似于：

```
def upload_path(self, filename):
    self.file_uuid = uuid.uuid4()
    return '/tmp/' + self.file_uuid 
```

然后是重命名它并从 /tmp/ 中删除它的后保存

或者我可以尝试覆盖这个模型的 save() 方法，首先调用 super().save()，然后处理图像上传（在 ImageFieldFile 对象中）并将其重命名为 self.id

建议？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-17T18:28:18.363

您应该能够使用upload_to 更改文件名。我这样说是因为我在项目中做过，django 文档是这样说的： [https ://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.FileField.upload_to](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.FileField.upload_to)

该链接的第三段说：“这也可能是可调用的，例如函数，将调用该函数以获取上传路径，**包括文件名**。” [强调补充]。我不是要讽刺我只是在表明这是并且应该是可能的，所以必须有其他事情发生。

尝试这样的事情。问题可能是您离开了扩展：

```
def upload_path(self, filename):
    basename, extension = os.path.splitext(filename)
    return '/'.join(["path",("%s%s" % (self.id, extension))]) 
```

# mysql - 需要一些关于 MySQL 排名查询的解释

> ID：10194239
> 
> 赞同：1
> 
> 时间：2012-04-17T15:32:14.740
> 
> 标签：mysql, sql

我希望对我遇到的排名查询有一些解释。我有一个类似的设置，我有一个我想要订购的点字段，但我无法理解这个查询：[http ://www.artfulsoftware.com/infotree/queries.php#460](http://www.artfulsoftware.com/infotree/queries.php#460)

我不明白 join 实际上在做什么，以及为什么如果我不包含 group by 语句，我只会得到一个完全混乱且不正确的记录。我总是将 Group By 语句视为限制结果的数量，但此查询似乎将它们添加到最终结果集中（因为没有 group by，您会返回一行）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:45:35.790

查询本质上是这样做的：

对于原始投票表中的每一行，计算有多少行（在同一个表中）对该行的投票 <=。计数与等级相同。

需要 JOIN 将投票表链接到投票表中的每一行。

当您的选择列表中有 COUNT() 时，需要 GROUP BY。对于每个人，查询正在计算它找到的每个人的投票 <= 的行数。带有 COUNT 的 GROUP BY 限制了 JOIN 结果的结果数量，这是原始投票表的乘积。

# computer-science - 在 Milner 的 Pi 演算中，当多个进程从同一个通道读取时，评估语义是什么？

> ID：10194245
> 
> 赞同：1
> 
> 时间：2012-04-17T15:32:22.740
> 
> 标签：computer-science, computation-theory, pi-calculus

在 Milner 的 Pi 演算中，当多个进程从同一个通道读取时，评估语义是什么？

规则说

`!x(a). P | ?x(b) Q ~> P | Q[a/b]`

但是像这样的情况呢

`!x(a). P | ?x(b) Q | ?x(c) R`

?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T21:42:59.497

我知道这个问题有点老了，但为了下一个人来寻找答案，我会尝试一个。

答案是：**它是不确定的**。Pi演算过程：

```
?x(b).Q | ?x(c).R 
```

说“要么接受 x 上的输入然后作为 Q 继续，要么接受 x 上的输入并作为 R 继续”。两种执行对于这个过程都是有效的。您可以考虑与这些流程相关的标记转换系统 --- 正如您所期望的那样，它将是分支的。

正是这种不确定性使过程演算（如 Pi 演算和朋友）变得“特别”，并且与 lambda 演算之类的东西不同，在 lambda 演算中，你评估事物的顺序并不重要（你会得到相同的结果）。Pi 演算精确地具有所有这些机制，例如双模拟和转换系统语义，因此它可以捕获这些情况并使其易于分析。

# android - Android使用sdk属性

> ID：10194252
> 
> 赞同：0
> 
> 时间：2012-04-17T15:32:47.677
> 
> 标签：android, sdk, version

我有一个关于 android sdk 的问题。我希望该应用程序可用于 android 1.6 到 android 4.03。我最近一直在使用 1.6 sdk，但我需要阻止 xlarge 屏幕，所以我想使用更高的 sdk。我可以使用最新的 sdk 并使用 with

```
<uses-sdk android:targetSdkVersion="15" android:minSdkVersion="4 " android:maxSdkVersion="15" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:58:49.550

> 我最近一直在使用 1.6 sdk，但我需要阻止 xlarge 屏幕，所以我想使用更高的 sdk。

不，您需要使用更高的构建目标，因此您可以使用`<compatible-screens>`清单中的元素进行编译。这与`<uses-sdk>`.

> 我可以使用最新的 sdk 并使用 with

[正如文档](http://developer.android.com/guide/topics/manifest/uses-sdk-element.html#max)`android:maxSdkVersion`中所解释的那样，使用它不是一个好主意。否则，这个元素很好，尽管它与“阻止 xlarge 屏幕”无关。`<uses-sdk>`

# c++ - 如何初始化对 std::ofstream 的静态引用？

> ID：10194253
> 
> 赞同：1
> 
> 时间：2012-04-17T15:32:55.033
> 
> 标签：c++, reference, static, ofstream

我有一个公共成员的班级 Cl

`static std::ofstream &_rout;`

在主文件中

```
ofstream out("output.txt");
ofstream& Cl::_rout(out); 
```

但是我有一个编译错误：非法定义或重新定义。我该如何纠正？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2020-10-05T03:31:05.223

尝试这个。

> 记录器.h

```
#include <string>
#include <fstream>
#include <iostream>

using namespace std;

class Logger{

    public:
            static void open( const string & logFile);
            static void close();
            // write message
            static void write( const string & message);

    private:
          Logger();
          ofstream fileStream;
          //Logger instance (singleton)
          static Logger instance;
}; 
```

> 记录器.cpp

```
#include "Logger.h"

Logger Logger::instance;

Logger::Logger(){}

void Logger::open( const string& logFile){
   instance.fileStream.open(logFile.c_str());
}
void Logger::close(){
    instance.fileStream.close();

} 
void Logger::write(const string& message){
    ostream& stream =  instance.fileStream ;
    stream << message<< endl;
} 
```

> 主文件

```
#include "Salida/Logger.h"
int main(){
    Logger::open(path);
    Logger::write("text");
    Logger::close();
    return 0; 
```

}

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T15:39:57.500

您只能在静态/全局范围内设置引用

```
#include<CL.h>
ofstream& Cl::_rout(out);
int main() {
  // ...
} 
```

在声明（和初始化）后无法重新设置引用。您可以通过使用指针而不是引用来实现您的目标：

```
class Cl {
  static std::ofstream* _rout;
};
std::ofstream* CL::_rout = NULL;

int main() {
  ofstream out("output.txt");   
  Cl::_rout = &out;   
} 
```

请注意，指针仅`out`在超出范围之前才有效。如果这是一个问题，请动态分配内存：

```
 ofstream* out = new ofstream("output.txt");   
  Cl::_rout = out; 
```

`delete`当您不再需要对象时不要忘记它以避免内存泄漏

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:40:52.057

好吧，您可以使用以下方法：

```
#include <fstream>

class CI
{
public:
  static std::ofstream &_rout;
};

static std::ofstream out("output.txt");

std::ofstream& CI::_rout = out;

int main()
{
} 
```

然而，问题在于输出文件的名称是固定的（硬编码到程序中）。

我建议您使用指针而不是引用：

```
#include <cstddef>
#include <fstream>

class CI
{
public:
  static std::ofstream *_rout;
};

std::ofstream* CI::_rout = NULL;

int main()
{
  const char *output_file = "output.txt";
  std::ofstream out(output_file);
  CI::_rout = &out;
} 
```

# java - Java Servlet getInputStream 错误

> ID：10194256
> 
> 赞同：1
> 
> 时间：2012-04-17T15:33:02.350
> 
> 标签：java, servlets

我正在学习 Java Servlets，我正在使用的书有一个关于文件上传的示例，当我这样做时，我收到以下错误

> HttpServletResponse 类型的方法 getInputStream() 未定义

当我尝试使用

```
ServletInputStream sis =  response.getInputStream(); 
```

eclipse提供的解决方案之一是

```
ServletInputStream sis =  ((ServletRequest) response).getInputStream(); 
```

并使用它导致以下结果

> java.lang.ClassCastException: org.apache.catalina.connector.ResponseFacade 不能被强制转换
> 
> > 到 javax.servlet.ServletRequest ShowForm.doPost(ShowForm.java:37) javax.servlet.http.HttpServlet.service(HttpServlet.java:641) javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

**这是我的完整代码：**

```
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.ServletInputStream;
import javax.servlet.ServletRequest;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class ShowForm
 */
@WebServlet("/ShowForm")
public class ShowForm extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * @see HttpServlet#HttpServlet()
     */
    public ShowForm() {
        super();
        // TODO Auto-generated constructor stub
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

            doPost(request,response);
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        response.setContentType("text/plain");
        PrintWriter out = response.getWriter();

        ServletInputStream sis =  response.getInputStream();
        for (int i = sis.read();i != -1; i = sis.read())
            {

                out.print((char)i);

            }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:35:45.997

听听原来的错误：

> HttpServletResponse 类型的方法 getInputStream() 未定义

这是在告诉你问题所在。 `HttpServletResponse`没有`getInputStream()`方法——它没有任何意义。

`getInputStream()`开启`HttpServletRequest`。

当谈到自动修复建议时，Eclipse 可能有点傻。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T15:36:17.427

那是因为`ServletResponse`/`HttpServletResponse`没有`getInputStream()`. 您可能实际上想要使用`getInputStream`from `HttpServletRequest`。

```
request.getInputStream() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:36:48.993

您可以从 HttpServletRequest 获取 InputStream。相反，您可以从 HttpServletOutputStream 获取 OutputStream。这是有道理的，因为通常你想阅读传入的请求，并相应地写一个回复。

# java - 由于错误 c00ce56e 无法完成操作

> ID：10194257
> 
> 赞同：11
> 
> 时间：2012-04-17T15:33:05.147
> 
> 标签：java, ajax, jsf-2, richfaces, internet-explorer-9

我已经从 Rich faces 3.3 升级到 rich faces 4.2，因为 ajax 不适用于 IE9。现在它仍然无法正常工作。

收到响应后，IE 收到一个 JS 错误*“SCRIPT58734: Der Vorgang konnte aufgrund des folgenden Fehlers nicht fortgesetzt werden: c00ce56e。”* 在尝试的同时

```
data.responseText=request.responseText 
```

在 jsf.js.html?ln=javax.faces&conversationContext=2，第 1 行第 21747 行

我认为这是因为 HTTP 标头不正确

```
Content-Type: text/xml;charset=UTF8 
```

应该

```
Content-Type: text/xml;charset=UTF-8 
```

这里是服务器的原始响应

```
HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
X-Powered-By: JSF/2.0
Cache-Control: no-cache
Content-Type: text/xml;charset=UTF8
Content-Length: 293
Date: Tue, 17 Apr 2012 15:25:22 GMT

<?xml version='1.0' encoding='UTF8'?>
<partial-response><changes><update id="outtest"><![CDATA[<span id="outtest"><span     class="outhello">Hello !</span></span>]]></update><update id="javax.faces.ViewState"><![CDATA[2809980525147413088:295565165947012503]]></update></changes></partial-response> 
```

我正在使用

```
javaee-web-api 6
myfaces-orchestra-core 1.4
Hibernate  4.1
Spring 3.1.1
Richfaces 4.2.0
Primefaces 3.2
jsf-api+impl 2.1.7 
```

jstl 1.2

并在tomcat 7上运行

编辑：现在我确定它的标题。我在 charles-proxy 中设置了一个断点并手动编辑了响应头，编辑后的 ​​http 头 IE9 显示了正确的结果，没有任何错误

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-17T16:45:47.477

你的分析是正确的。标头中的`charset`属性`Content-Type`是错误的，IE9 因错误而窒息`c00ce56e`。

JSF 默认使用从[`ServletRequest#getCharacterEncoding()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getCharacterEncoding%28%29). 这通常默认为客户指定的，或者`null`如果没有（通常是这种情况）。这通常可以被一些调用[`request.setCharacterEncoding()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#setCharacterEncoding%28java.lang.String%29).

鉴于不正确的字符集，这只能意味着您的 Web 应用程序在某处调用[`request.setCharacterEncoding()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#setCharacterEncoding%28java.lang.String%29)而`"UTF8"`不是`"UTF-8"`.

我会开始检查所有过滤器及其配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-06T15:52:44.153

我遇到了类似的错误，但问题出在响应标头内容长度上。我们在请求标头上有 24kb 的数据，我们必须将其减半。这解决了这个问题。我希望这可以帮助别人。

# java - jQuery UI 选项卡中未捕获的异常：片段标识符不匹配

> ID：10194259
> 
> 赞同：3
> 
> 时间：2012-04-17T15:33:06.420
> 
> 标签：java, javascript, jquery, html, jsf

我有这个带有 JQuery 和 AJAX 的 JSF 选项卡。但是有一个我找不到的错误。这是 JSF 页面：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"    
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <title>DX-57 History Center</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="shortcut icon" type="image/x-icon" href="resources/css/themes/nvidia.com/images/favicon.ico" />
        <link href="resources/css/helper.css" media="screen" rel="stylesheet" type="text/css" />
        <link href="resources/css/dropdown.css" media="screen" rel="stylesheet" type="text/css" />
        <link href="resources/css/default.advanced.css" media="screen" rel="stylesheet" type="text/css" />

        <script type="text/javascript" src="resources/js/jquery-1.7.2.min.js"></script>
        <script type="text/javascript" src="resources/js/jquery-ui-1.8.18.custom.min.js"></script>
        <link href="resources/css/jquery-ui-1.8.18.custom.css" media="screen" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="resources/js/mytabs.js"></script>
    </h:head>
    <h:body>

        <h1><img src="resources/css/images/icon.png" alt="NVIDIA.com" /> History Center</h1>
        <!-- layer for black background of the buttons -->
        <div id="toolbar" style="margin: 0 auto; width:1180px; height:30px; position:relative;  background-color:black">
            <!-- Include page Navigation -->
            <ui:insert name="Navigation">           
                <ui:include src="Navigation.xhtml"/>         
            </ui:insert>

        </div>  

        <div id="greenBand" style="position:relative; top:35px; left:0px;"> 
            <h:graphicImage alt="Dashboard"  style="position:relative; top:-20px; left:9px;"  value="resources/images/logo_application.png" />
        </div>
        <div id="main" style="margin: 0 auto; width:1190px; height:700px; position:absolute;  background-color:transparent; top:105px">

            <div id="mainpage" style="margin: 0 auto; width:1190px; height:500px; position:absolute;  background-color:transparent; top:80px">

                <div id="settingsHashMap" style="width:650px; height:400px; position:absolute;  background-color:r; top:20px; left:1px">

                        <h:form prependId="false">
                            <h:panelGroup id="tabs" layout="block">
                                <ul>
                                    <c:forEach items="#{ApplicationController.tabs}" var="tab">
                                        <li><a href="##{tab.tabid}" onclick="$('#button_#{tab.tabid}').click()">#{tab.tabid}</a></li>
                                        <h:commandButton id="button_#{tab.tabid}" value="TabClick" action="#{ApplicationController.switchPages(tab.tabid)}" style="display:none">
                                            <f:ajax render="tabs"></f:ajax>
                                        </h:commandButton>  
                                    </c:forEach>
                                </ul>

                                <c:forEach items="#{ApplicationController.tabs}" var="tab">
                                    <h:panelGroup id="#{tab.tabid}" layout="block" rendered="#{tab.tabid eq ApplicationController.selectedTab}">
                                        <ui:include src="#{tab.tabfilename}"></ui:include>
                                    </h:panelGroup>
                                </c:forEach>
                            </h:panelGroup>
                        </h:form>

                </div>   

                <div id="settingsdivb" style="width:350px; height:400px; position:absolute;  background-color:transparent; top:20px; left:800px">

                </div>   

            </div>  
        </div>

    </h:body>
</html> 
```

这是托管 bean 的代码：

```
import java.io.Serializable;
import javax.enterprise.context.SessionScoped;
// or import javax.faces.bean.SessionScoped;
import javax.inject.Named;
/* include SQL Packages */
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import javax.annotation.PostConstruct;
import javax.sql.DataSource;
import javax.annotation.Resource;
import javax.faces.context.FacesContext;
import javax.inject.Inject;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;
// or import javax.faces.bean.ManagedBean;   

import org.glassfish.osgicdi.OSGiService;

@Named("ApplicationController")
@SessionScoped
public class Application implements Serializable {

    public Application() {
    }
    /* Call the Oracle JDBC Connection driver */
    @Resource(name = "jdbc/Oracle")
    private DataSource ds;

    @PostConstruct
    public void init() {
        tabs = new ArrayList<MyTabObject>();
        tabs.add(new MyTabObject("ApplicationTabMain.xhtml", "Main"));
        tabs.add(new MyTabObject("ApplicationTabModel.xhtml", "Model"));
        tabs.add(new MyTabObject("ApplicationTabSettings.xhtml", "Settings"));

    }
    String selectedTab = "Main";

    public String getSelectedTab() {
        return selectedTab;
    }

    public void setSelectedTab(String selectedTab) {
        this.selectedTab = selectedTab;
    }

    public String switchPages(String selTab) {
        selectedTab = selTab;
        return "Application.xhtml";
    }
    List<MyTabObject> tabs;

    public List<MyTabObject> getTabs() {
        return tabs;
    }

    public void setTabs(List<MyTabObject> tabs) {
        this.tabs = tabs;
    }

    ////
    public class MyTabObject {

        String tabfilename;
        String tabid;

        public String getTabfilename() {
            return tabfilename;
        }

        public void setTabfilename(String tabfilename) {
            this.tabfilename = tabfilename;
        }

        public String getTabid() {
            return tabid;
        }

        public void setTabid(String tabid) {
            this.tabid = tabid;
        }

        public MyTabObject(String tabfilename, String tabid) {
            super();
            this.tabfilename = tabfilename;
            this.tabid = tabid;
        }
    }
} 
```

JSF 页面具有以下选项卡：

ApplicationTabMain.xhtml

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"    
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>

    </h:head>
    <h:body>
        <ui:composition>
            <h:panelGroup>
                <h:form>
                    Main
                </h:form>
            </h:panelGroup>
        </ui:composition>
    </h:body>
</html> 
```

ApplicationTabModel.xhtml

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"    
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>

    </h:head>
    <h:body>
        <ui:composition>
            <h:panelGroup>
                <h:form>
                    Model
                </h:form>
            </h:panelGroup>
        </ui:composition>
    </h:body>
</html> 
```

ApplicationTabSettings.xhtml

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"    
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>

    </h:head>
    <h:body>
        <ui:composition>
            <h:panelGroup>
                <h:form>
                    Settings
                </h:form>
            </h:panelGroup>
        </ui:composition>
    </h:body>
</html> 
```

现在我只有普通的 JSF 选项卡，没有任何 Java 代码。这就是问题：

![在此处输入图像描述](../Images/351d9d518700a7818cb6359474691b3d.png)

![在此处输入图像描述](../Images/c9ed2c3489a133284195bc837cae4246.png)

![在此处输入图像描述](../Images/84cc61ed24e18541f37e9536e417b2b5.png)

不显示选项卡的内容。在萤火虫我得到这个错误：

```
uncaught exception: jQuery UI Tabs: Mismatching fragment identifier. 
```

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T16:06:12.263

有迹象表明您可能会根据此使用不兼容的 jquery/jqueryui 版本：http: [//forum.jquery.com/topic/uncaught-exception-jquery-ui-tabs-mismatching-fragment-identifier-5-2-2010](http://forum.jquery.com/topic/uncaught-exception-jquery-ui-tabs-mismatching-fragment-identifier-5-2-2010)

如果您还没有，请尝试切换回 jquery 1.3.2。

# android - 自动强制关闭？

> ID：10194260
> 
> 赞同：0
> 
> 时间：2012-04-17T15:33:12.503
> 
> 标签：android

我在这里遇到了一些问题，因为当我在某处看到计算器代码并以某种方式使用它时，当我开始输入数字时，该应用程序总是强制关闭。帮助？

```
public void onClickListener8(View v)
{
    vibrator.vibrate(30);
    if(press=='=')
    {
        onClickListenerReset(buttonClear);
    }
    eight=(String)button8.getText();
    sum=sum+eight;
    editText.setText(sum);
}

04-17 15:38:23.110: E/AndroidRuntime(678): FATAL EXCEPTION: main
04-17 15:38:23.110: E/AndroidRuntime(678): java.lang.IllegalStateException: Could not     execute method of the activity
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.view.View$1.onClick(View.java:2144)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.view.View.performClick(View.java:2485)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.view.View$PerformClick.run(View.java:9080)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.os.Handler.handleCallback(Handler.java:587)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.os.Handler.dispatchMessage(Handler.java:92)
04-17 15:38:23.110: E/AndroidRuntime(678):  at android.os.Looper.loop(Looper.java:123)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.app.ActivityThread.main(ActivityThread.java:3683)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     java.lang.reflect.Method.invokeNative(Native Method)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     java.lang.reflect.Method.invoke(Method.java:507)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-17 15:38:23.110: E/AndroidRuntime(678):  at dalvik.system.NativeStart.main(Native     Method)
04-17 15:38:23.110: E/AndroidRuntime(678): Caused by:     java.lang.reflect.InvocationTargetException
04-17 15:38:23.110: E/AndroidRuntime(678):  at     java.lang.reflect.Method.invokeNative(Native Method)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     java.lang.reflect.Method.invoke(Method.java:507)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.view.View$1.onClick(View.java:2139)
04-17 15:38:23.110: E/AndroidRuntime(678):  ... 11 more
04-17 15:38:23.110: E/AndroidRuntime(678): Caused by: java.lang.SecurityException:     Requires VIBRATE permission
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.os.Parcel.readException(Parcel.java:1322)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.os.Parcel.readException(Parcel.java:1276)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.os.IVibratorService$Stub$Proxy.vibrate(IVibratorService.java:106)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     android.os.Vibrator.vibrate(Vibrator.java:52)
04-17 15:38:23.110: E/AndroidRuntime(678):  at     com.mypackage.Calculator.onClickListener8(Calculator.java:232)
04-17 15:38:23.110: E/AndroidRuntime(678):  ... 14 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:47:12.997

Make sure your app has the Vibrate permission. The following line should be there in the manifest:

```
<uses-permission android:name="android.permission.VIBRATE"/> 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-04-17T15:35:45.513

我认为您必须使用模拟器。只需注释掉振动；不知何故，这就是问题的原因。

# ant - 在 olio 设置中使用 ant 构建战争文件时出错

> ID：10194264
> 
> 赞同：1
> 
> 时间：2012-04-17T15:33:20.960
> 
> 标签：ant, glassfish-3

我目前正在使用 olio_java_setup 安装 olio： [https ://svn.apache.org/repos/asf/incubator/olio/docs/java_setup.html](https://svn.apache.org/repos/asf/incubator/olio/docs/java_setup.html)

我在安装程序中安装了 JDK 1.7、ANT 1.8.3、FABAN 1.0.1 和 Glassfish v3。我完成了之前的所有设置步骤，但我陷入了构建 Web 应用程序的第 7 步。当我在终端中输入“ant”命令时，构建失败并显示以下输出：

```
foo@ubuntu:~/olio/webapp/java/trunk/ws/apps/webapp$ ant
Buildfile: /home/foo/olio/webapp/java/trunk/ws/apps/webapp/build.xml

default-ear:

init:

-pre-compile:

bpp-actual-compilation:
     [echo] Compiling webapp
    [javac] /home/foo/olio/webapp/java/trunk/ws/bp-project/command-line-ant-tasks.xml:96: warning: 'includeantruntime' was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds
    [javac] Compiling 9 source files to /home/foo/olio/webapp/java/trunk/ws/apps/webapp/build/classes

BUILD FAILED
/home/foo/olio/webapp/java/trunk/ws/bp-project/command-line-ant-tasks.xml:96: /home/foo/olio/webapp/java/trunk/ws/apps/webapp/${javaee.lib.dir} does not exist. 
```

有人可以告诉我我的错误在哪里，我该如何解决？

亲切的问候，金

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:41:03.140

在前面的步骤中设置属性时，您可能错过了一些步骤。您收到的消息表明找不到路径，但该路径中有一个未分配的属性 ${javaee.lib.dir}。当您在 ant 输出中看到这一点时，这意味着有一个名为 javaee.lib.dir 的属性正试图用作尚未分配值的路径的一部分。您必须通过在 .properties 文件或 build.xml 之一中查找该变量来找出未为其分配值的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T04:04:27.807

Olio 还不支持 JDK 1.7，请在[此处查看 Olio 开发人员的回复](https://github.com/shanti/olio/issues/3#issuecomment-16132805)

# actionscript-3 - Flash Sockets，同一域中的安全错误？

> ID：10194266
> 
> 赞同：0
> 
> 时间：2012-04-17T15:33:24.950
> 
> 标签：actionscript-3, sockets, flash-cs5

我正在尝试将 Flash 套接字客户端连接到 C++ 套接字服务器（使用 boost::asio ）。我总是在侦听端口 7171 的远程服务器上运行服务器应用程序。

如果我在本地机器（直接在 CS5.5 内部）上运行 flash 套接字客户端，则连接工作正常。在这个成功的测试之后，我决定将我的 swf 上传到与套接字服务器相同的机器上，以允许多个用户通过 HTTP 连接它（然后我假设 flash 客户端和 c++ 服务器在同一个域内），但在这种情况下，我总是得到一个 SecurityError 2048。

我会错过什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:03:23.130

当您在本地测试时，您在沙箱中，这将忽略安全问题，这就是为什么上传时（在沙箱之外）它不起作用的原因。

在您的 ActionScript 中，您需要包含此内容。

```
// host is something like dev.mydomain.com
Security.allowDomain( host );
Security.loadPolicyFile( "xmlsocket://" host + ":" port ); 
```

在您需要监听此请求的端口上

```
<policy-file-request/> 
```

当您收到策略请求时，您需要使用此节点返回跨域策略。

```
<allow-access-from domain="*" to-ports="*"  /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:42:04.927

Flash 需要在主机上运行策略服务器才能访问任何套接字：

[http://www.adobe.com/devnet/flashplayer/articles/socket_policy_files.html](http://www.adobe.com/devnet/flashplayer/articles/socket_policy_files.html)

这是与跨域文件不同的要求——它需要在端口 843 上运行的实际策略服务器应用程序。

可能是 CS5 中的 Flash 忽略了策略要求，因为它知道它处于开发环境中。

# jquery - 如果 Select 包含带有特定文本的选项，则更改 div 文本

> ID：10194270
> 
> 赞同：0
> 
> 时间：2012-04-17T15:33:30.493
> 
> 标签：jquery

我有一个多人管理的 CMS。我们根据一年中的时间启用/禁用我们的一些运输方式。如果有人启用“文本预订。取件”运输选项，我想设置我们的结帐页面以在我们的取件信息 TD 中显示不同的消息，但如果没有，则将其保留为默认值。

如果选择了一个选项，我发现了很多示例来更改 div 或其他内容，但我只想查看一个选项是否在列表中，然后根据该选项更改 TD 的内容。我已经尝试修改这些示例，看看它是否适用于我的情况，但没有让它起作用。

我已经有了更改 TD 的代码，但不知道如何首先检查 select 是否包含某个选项。这是我必须更改 TD 的文本和输入按钮的代码：

```
// Change description from "To pick up at the bookstore" on Step 2 of checkout to Reserve Your Textbooks
$('td[id$=PickupAtStoreColumn] div.multipleship').each(function() { $(this).html($(this).html().replace("To pick up at the bookstore","Reserve Your Textbooks")); });

// Change "Pick Up At Store" button text on Step 2 of checkout to Reservation Pickup
$('td[id$=PickupAtStoreColumn] input[id$=btnPickupAtStore]').attr('value','Reservation Pick-up'); 
```

如何检查 select[id$=drpShipType] 是否首先启用了“Text Reserv. Pick-up”作为选项？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:46:19.853

If your select element's options have values specified, you can detect whether the option exists via:

```
$('#drpShipType option[value="Text Reserv. Pick-up"]').length > 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:36:02.673

您可以使用以下`is`方法：

```
 $('someSelector').is(':selected') 
```

这将返回一个布尔值 true / false 来告诉您它是否被选中。但是，在您的情况下，您是在询问是否选择了特定选项。我认为有效的唯一方法是获取所选的特定选项，然后检查其值。例如：

```
<option value="4" class="specificGuy">Text Reserv. Pick-up</option>

$('.specificGuy').is(':selected') 
```

# jsf - 如何在 JSF 中隐藏元素？

> ID：10194274
> 
> 赞同：10
> 
> 时间：2012-04-17T15:33:47.997
> 
> 标签：jsf

是否可以根据条件隐藏`div`etc（就像您在使用 EL 渲染属性中所做的那样），而不必将其包装在`<h:panelGrid ...>`带有渲染属性的 etc 中？它破坏了我的布局。我只需要它的逻辑，而不是布局。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-17T20:45:29.890

首先，你不应该用它来包装你的元素，`h:gridPanel`这会导致 html`table`

相反，您应该用`h:panelGroup`which 结果包装`span`成 html 代码，您还可以添加`layout="block"`to`h:panelGroup`以使其呈现为`div`

其次，您在隐藏时不使用jstl，`div`而是执行类似的操作

```
<div style="display:#{(myBean.hideSomeDiv)?'none':'block'}">My Div Content</div> 
```

或者

```
<h:panelGroup styleClass="#{(myBean.hideSomeDiv)?'hide':''">My Span Content</h:panelGroup> 
```

在css文件中添加这个：

```
.hide { 
    display: none;
} 
```

**INMO**你总是最好隐藏在 JSF 中`rendered="#{myBean.renderCondition}"`

在这里看看 BalusC[有条件地显示 JSF 组件](https://stackoverflow.com/a/4870557/617373)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T15:40:48.110

你可以这样做：

```
<div style="display:#{yourBean.property}"></div> 
```

yourBean.property 将返回“none”以隐藏 div 的位置

# git - 在终端中显示分支名称 - 意外输出

> ID：10194281
> 
> 赞同：0
> 
> 时间：2012-04-17T15:34:26.013
> 
> 标签：git

我最近使用了我在网上找到的一个脚本来显示我所在的当前分支。工作起来就像一个魅力。我通常在多个项目中创建一个功能分支，就像我重构依赖项并且还需要更新客户端一样。无论如何，我今天早上在四个不同的 git 存储库中创建了一个分支，一切正常，除了一个在终端中显示的存储库：

```
@user folder (master|REBASE-i) 
```

而不是分支名称。其他 repos 中的正常显示类似于：

```
@user folder (branch name) 
```

知道这意味着什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:36:18.980

这意味着您正处于[交互式 rebase](http://book.git-scm.com/4_interactive_rebasing.html)的中间，这意味着当前正在重写历史以重写或重新排序提交。

如果您想消除此行为，请运行`git rebase --abort`

# python - 如何公开 PyAMF 服务？

> ID：10194284
> 
> 赞同：1
> 
> 时间：2012-04-17T15:34:31.397
> 
> 标签：python, pyamf

我创建了一个名为“timesTwo”的服务，并将文件放在正确的目录中。但是，当我尝试从客户端代码调用它时，它告诉我该服务不存在。创建服务器端代码后，如何公开服务？我错过了哪些步骤？

服务器端代码：

```
from pyamf.remoting.gateway.wsgi import WSGIGateway

def timesTwo(data):
    return data * 2

services = {
    'timesTwo': timesTwo,
    # Add other exposed functions here
}

gateway = WSGIGateway(services) 
```

我很难找到在线文档。谢谢您的帮助！

旁注：是否有一些资源（网站、书籍、任何东西）比您推荐的 pyamf.org 上的内容更全面？！

# java - SQS 消息未删除

> ID：10194293
> 
> 赞同：15
> 
> 时间：2012-04-17T15:35:07.090
> 
> 标签：java, amazon-web-services, message-queue, amazon-sqs

我在 SQS 队列中有一小部分消息，即使发送到 AWS 端点的删除请求返回 200 响应，这些消息也不会被删除。我的应用程序很好地处理了这些消息，并且也很好地发送了删除请求。

我正在使用 Java AWS SDK 1.3.6。

有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-18T10:21:45.843

糟糕 - 队列被意外设置为`defaultVisibilityTimeout=0`. 将其更改为正值可以解决问题。

不过，这仍然提出了一些问题：

1.  为什么这只影响某些消息？也许有些需要更长的时间来处理？
2.  当消息没有被删除时，为什么亚马逊会返回 200 来删除？
3.  删除失败是因为它落在了 0 秒窗口之外（在这种情况下，为什么*任何*删除请求都会成功？），还是因为在收到删除请求时另一个消费者已经拿起它们而失败？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-01T10:28:02.413

官方文档（1.9.13版）

> 重要提示：即使您已将其删除，您也可能会收到一条消息。如果在您请求删除邮件时存储邮件副本的服务器之一不可用，这种情况可能会发生。该副本保留在服务器上，并且可能会在后续接收请求时再次返回给您。您应该将系统创建为幂等的，以便多次接收特定消息不是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-20T19:27:48.043

如果您传递了您的异常，则很有可能您实际上并没有删除您的 sqs 消息，因此它被卡在“飞行中”，因为您的处理过程中可能存在错误。尝试将您的 sqs 轮询包装起来，除了这样，看看您是否有任何异常：

```
import traceback
import sys

try:
    pollsqshere()
except Exception:
    print(traceback.format_exc())
    # or
    print(sys.exc_info()[2]) 
```

# android - 滑动 1 个搜索栏导致两个搜索栏都改变拇指

> ID：10194296
> 
> 赞同：1
> 
> 时间：2012-04-17T15:35:12.583
> 
> 标签：android, seekbar

这是一个奇怪的问题。我有 2 个搜索栏，并且我已经为两者建立了一个监听器。但是，当我为一个搜索栏滑动拇指栏时 - 它会更新该搜索栏并且它还会移动第二个搜索栏的拇指。

如果我在第二个搜索栏上移动拇指 - 它只会更改第二个搜索栏而不是第一个搜索栏。

如果我删除第一个搜索栏的侦听器 - 我会遇到同样的问题。

我已将代码附加到搜索栏侦听器。mSeekBarA 是第一个。mSeekBarB 是第二个。

```
 mSeekBarA.setOnSeekBarChangeListener(new OnSeekBarChangeListener()
      { 

           @Override 
           public void onStopTrackingTouch(SeekBar seekBar)
           { 

           } 

           @Override 
           public void onStartTrackingTouch(SeekBar seekBar)
           { 
            // TODO Auto-generated method stub 

           } 

           @Override 
           public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser)
           { 
           On_SFX_Volume_Change(progress);

           } 
      }); 

      mSeekBarB.setOnSeekBarChangeListener(new OnSeekBarChangeListener()
      { 

           @Override 
           public void onStopTrackingTouch(SeekBar seekBar)
           { 

           } 

           @Override 
           public void onStartTrackingTouch(SeekBar seekBar)
           { 
            // TODO Auto-generated method stub 

           } 

           @Override 
           public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser)
           { 
               On_MUS_Volume_Change(progress);

           } 
      }); 
```

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:51:24.517

你是如何实例化这些滑块的？我敢打赌，他们实际上指的是同一个实例。可能您在布局中添加了相同的滑块，而不是单独添加每个滑块。

# ios - XCWorkspace 太小（60k），而它指的是一个 7 兆的项目

> ID：10194297
> 
> 赞同：0
> 
> 时间：2012-04-17T15:35:14.333
> 
> 标签：ios, github, backup

我在从备份中丢失数据时遇到了很多问题，因此我以不同的名称保存（例如版本 501、502、...）。

但是，我做了一个“另存为”并创建了一个只有 60k 的文件：myAppVersion507.xcworkspace

之前它是一个完整的文件（没有扩展名）和 7 兆：

myAppVersion505

这里有什么建议吗？

我是否必须重新输入从 505 到 507 的更改，这可能并不难，因为我将结果“推送”到 GitHub，并进行了文件提交，并进行了“文件创建快照”。

# jquery - 淡出第一个 div 然后淡入第二个 div

> ID：10194305
> 
> 赞同：2
> 
> 时间：2012-04-17T15:35:48.577
> 
> 标签：jquery, settimeout, fadein, fadeout

遇到问题，我需要做一些类似褪色横幅的事情 - 一个 div 淡出然后第二个 div 淡入，这是代码：

```
$(document).ready(function() {
    setTimeout(function() {
        $('#zeus').fadeOut(1000);
     }, 5000);
    $('#zeuss').hide();
    setTimeout(function(){
        $('#zeuss').fadeIn(1000);
    }, 6000);
}); 
```

它可以工作，但是在`#zeuss`淡入之后它就停留在这里。我需要反复这样做。并且请不要提供使用 .delay() 因为我在 jquery 1.3.2 上

**编辑。** 默认情况下`#zeus`显示在页面上，我想将其淡出然后淡入`#zeuss`，然后再次淡入`#zeus`然后淡出`#zeus`和淡入`#zeuss`等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T16:09:28.930

**通常情况下，通用且可扩展的解决方案更简单：**

*更新：接受 jfriend00 的建议，并从多个计时器转移到完成功能，以防止随着时间的推移累积错误。*

```
/**
 * Fade-cycles elements with class 'banner'
 */
$(document).ready(function() {

    var delay = 3000, fade = 1000; // tweak-able
    var banners = $('.banner');
    var len = banners.length;
    var i = 0;

    setTimeout(cycle, delay); // <-- start

    function cycle() {
        $(banners[i%len]).fadeOut(fade, function() {
            $(banners[++i%len]).fadeIn(fade, function() { // mod ftw
                setTimeout(cycle, delay);
            });
        });
    }

}); 
```

*   [](http://jsfiddle.net/paislee/pdsu7/5/)**使用 jQuery 1.3.2 的[**演示**](http://jsfiddle.net/paislee/pdsu7/5/)**

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T15:48:08.300

我认为您想在无限滚动中淡入和淡出 2 个不同的 div。试试下面的代码，让我知道，

[**演示**](http://jsfiddle.net/skram/TtPFc/)

```
$(document).ready(function() {
    var isZeuss = false;
    var $zeus = $('#zeus');
    var $zeuss = $('#zeuss');

    $zeuss.hide();

    setTimeout(function () {//<-- Not sure if you want this 5 sec delay in starting the animation
       setInterval(function() {
         var $fadeOutBanner = (isZeuss)?$zeuss:$zeus;
         var $fadeInBanner = (isZeuss)?$zeus:$zeuss;

         $fadeOutBanner.fadeOut(1000, function () {
             $fadeInBanner.fadeIn(1000);
             isZeuss = !isZeuss;
         });
       }, 2000);
     }, 5000); //<-- Not sure if you want this         
}); 
```

**编辑：**您可以增加`fadeIn/fadeOut`计时器或`setInterval`用于较慢过渡的计时器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T15:44:36.293

好的，不使用`.delay()`并将一个动画的开始链接到前一个动画的精确完成（不依赖于计时器和动画的同步）并使用此重复序列实现动画：

*   宙斯可见，宙斯不可见
*   暂停 5 秒
*   淡出宙斯
*   淡入宙斯
*   淡出宙斯
*   淡入宙斯
*   重复

你可以这样做：

```
$(document).ready(function() {
    var z1 = $('#zeus');
    var z2 = $('#zeuss').hide();

    function cycle() {
        setTimeout(function() {
            z1.fadeOut(1000, function() {
                z2.fadeIn(1000).fadeOut(1000, function() {
                    z1.fadeIn(1000, cycle)
                });
            });
        }, 5000);
    }
    cycle();
}); 
```

如果您只想在第一个周期之前暂停 5 秒而不是在接下来的周期中（在您的问题中我并不完全清楚），它可以是这样的：

```
$(document).ready(function() {
    var z1 = $('#zeus');
    var z2 = $('#zeuss').hide();

    function cycle() {
        z1.fadeOut(1000, function() {
            z2.fadeIn(1000).fadeOut(1000, function() {
                z1.fadeIn(1000, cycle)
            });
        });
    }
    // start the fadeIn/fadeOut cycling after 5 seconds
    setTimeout(cycle, 5000);
}); 
```

仅供参考，名称的选择`zeus`非常`zeuss`令人困惑。很容易让他们混淆，并且很容易在代码中出错。

如果你有一个可以使用的更现代的 jQuery 版本`.delay()`，那么它会更简单一点：

```
$(document).ready(function() {
    var z1 = $('#zeus');
    var z2 = $('#zeuss').hide();

    function cycle() {
       z1.delay(5000).fadeOut(1000, function() {
           z2.fadeIn(1000).fadeOut(1000, function() {
               z1.fadeIn(1000, cycle)
           });
       });
    }
    cycle();
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T15:51:36.927

这个从一个可见的横幅开始，然后它开始淡出、淡入、延迟等...... [http://jsfiddle.net/TtPFc/1/](http://jsfiddle.net/TtPFc/1/)

```
#zeus { background-color: blue; color: white; display:none}
#zeuss { background-color: red; color: white; }

<div id="zeus">Zeus Banner</div>
<div id="zeuss">Zeuss Banner</div>
​

$(document).ready(function() {
    var zeus    =  $('#zeus'), 
        zeuss   =  $('#zeuss'),
        forward = true;

    setInterval(function() {
        if (forward) {
           zeus.fadeOut(1000, function() { zeuss.fadeIn(1000); });
        }
        else { 
           zeuss.fadeOut(1000, function() { zeus.fadeIn(1000); });
        }

        forward = !forward;

     }, 5000);
});​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T15:47:06.937

如果你做一个 zeusfadeIn 和 zeusfadeOut 怎么办？zeusfadeIn 淡入并调用 zeusfadeOut zeusfadeOut 淡出并调用 zeusfadeIn**

# mysql - MySQL多对多连接有AND查询不起作用

> ID：10194311
> 
> 赞同：0
> 
> 时间：2012-04-17T15:36:07.523
> 
> 标签：mysql, join, where, having

我有以下五个表：

```
 company        type    branch      company_type       company_branch
 -------        ----    ------     -------------       --------------
  c_id          t_id     b_id       c_id | t_id         c_id | b_id     
  ----          ---      ----       -----------        --------------
   1             1        1            1  1              1     1
   2             2        2            1  2              1     2
                 3        3            2  1              2     1
                                       2  3              2     3 
```

以下两个查询工作正常：

```
SELECT DISTINCT `co`.`c_id`
FROM (`company` co)
JOIN `company_type` t ON `t`.`c_id` = `co`.`c_id`
WHERE `co`.`status` = 1
GROUP BY `co`.`c_id`
HAVING sum(if(`t`.`t_id` in (1,2),1,0)) = 2       (---> returns 1 ) Correct !

SELECT DISTINCT `co`.`c_id`
FROM (`company` co)
JOIN `company_branch` b ON `b`.`c_id` = `co`.`id`
WHERE `co`.`status` = 1
GROUP BY `co`.`id`
HAVING sum(if(`b`.`b_id` in (1,2),1,0)) = 2        (---> returns 1 ) Correct ! 
```

但是当我尝试像下面这样组合它们时，它给了我一个空的结果：

```
SELECT DISTINCT `co`.`c_id`
FROM (`company` co)
JOIN `company_branch` b ON `b`.`c_id` = `co`.`id`
JOIN `company_type` t ON `t`.`c_id` = `co`.`id`
WHERE `co`.`status` = 1
GROUP BY `co`.`id`
HAVING sum(if(`b`.`b_id` in (1,2),1,0)) = 2 AND sum(if(`t`.`t_id` in (1,2),1,0)) = 2 
```

我的猜测是这两个条件之间的 AND 是罪魁祸首！有人有线索吗？？或解决方法？

预期结果：1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:45:06.983

可能是因为您无意中获得了笛卡尔连接，从而导致了 4 条记录。每个分支和类型两个。我的猜测是您的计数是每个 4... 可以肯定的是，尝试

```
SELECT `co`.`c_id`,
       sum(if(`b`.`b_id` in (1,2),1,0)) as BranchCount,
       sum(if(`t`.`t_id` in (1,2),1,0)) as TypeCount
   FROM (`company` co)
      JOIN `company_branch` b ON `b`.`c_id` = `co`.`id`
      JOIN `company_type` t ON `t`.`c_id` = `co`.`id`
   WHERE `co`.`status` = 1
   GROUP BY `co`.`id` 
```

要修复它，我会进行如下调整：

```
select co.C_ID
   from
      company co
         join company_branch b 
            on co.id = b.c_id
           and b.b_id in ( 1, 2 )
         join company_type t 
            on co.id  = t.c_id
           and t.t_id in ( 1, 2 )
   where
      co.status = 1
   GROUP BY 
      co.id
   HAVING
           count( distinct b.b_id ) = 2
       AND count( distinct t.t_id ) = 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:51:14.857

此查询应该满足您的要求。不是在 HAVING 子句中指定过滤条件，而是首先计算每个 co_id 的总和，然后使用子查询对其应用 WHERE 子句过滤条件。这应该可以工作。

```
SELECT Z.* FROM
(
SELECT `co`.`c_id`,
       sum(if(`b`.`b_id` in (1,2),1,0)) as BranchCount,
       sum(if(`t`.`t_id` in (1,2),1,0)) as TypeCount
   FROM (`company` co)
      JOIN `company_branch` b ON `b`.`c_id` = `co`.`id`
      JOIN `company_type` t ON `t`.`c_id` = `co`.`id`
   WHERE `co`.`status` = 1
   GROUP BY `co`.`id`
) Z
WHERE Z.BranchCount=2 AND Z.TypeCount=2; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:57:12.480

顺便说一句，您发布的查询有一些错误，所以我正在尝试发布正确的查询，以便如果有人想尝试，他们可以做到。第一个： SELECT DISTINCT `co`。`c_id` FROM ( `company`co) 加入`company_type`t ON `t`。`c_id`= `co`。`c_id` 分组依据`co`。`c_id` HAVING sum(if( `t`. `t_id`in (1,2),1,0)) = 2 第二个：

```
SELECT DISTINCT `co`.`c_id`
FROM (`company` co)
JOIN `company_branch` b ON `b`.`c_id` = `co`.`c_id`
GROUP BY `co`.`c_id`
HAVING sum(if(`b`.`b_id` in (1,2),1,0)) = 2 
```

我已经排除了状态列，因为我没有在我的表结构中使用它。

现在我不确定您的业务逻辑是什么，但我正在提出您的最终 SQL，如下所示：

```
SELECT DISTINCT `co`.`c_id`,sum(if(`cb`.`b_id` in (1,2),1,0)) cb_sum,sum(if(`ct`.`t_id` in (1,2),1,0)) ct_sum
FROM (`company` co)
LEFT JOIN `company_branch` cb ON `cb`.`b_id` = `co`.`c_id`
LEFT JOIN `company_type` ct ON `ct`.`t_id` = `co`.`c_id`
GROUP BY `co`.`c_id`
HAVING sum(if(`cb`.`b_id` in (1,2),1,0)) = 2 AND sum(if(`ct`.`t_id` in (1,2),1,0)) = 2 
```

现在，如果您运行没有 HAVING 子句的 SQL，您应该会看到如下输出：

```
c_id      cb_sum       ct_sum
1         4            4
2         1            1 
```

因此，如果您将条件更改为“> 2”而不是“= 2”，您应该得到您想要的，但另一个选项是您使用 UNION 组合您的结果集，如下所示：

```
SELECT DISTINCT `co`.`c_id`
FROM (`company` co)
JOIN `company_type` t ON `t`.`c_id` = `co`.`c_id`
GROUP BY `co`.`c_id`
HAVING sum(if(`t`.`t_id` in (1,2),1,0)) = 2
UNION
SELECT DISTINCT `co`.`c_id`
FROM (`company` co)
JOIN `company_branch` b ON `b`.`c_id` = `co`.`c_id`
GROUP BY `co`.`c_id`
HAVING sum(if(`b`.`b_id` in (1,2),1,0)) = 2 
```

# java - 检查java中arraylist值的值

> ID：10194315
> 
> 赞同：-1
> 
> 时间：2012-04-17T15:36:15.187
> 
> 标签：java, arraylist

我正在尝试编写一种方法来检查所有天气中的所有天气都`Objects`具有`ArrayList`相同的值。例如，在下面的代码中`list1`应该返回`true`，并且`list2`应该返回`false`...

```
list1=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]
list2=[1,3,4,2,4,1,3,4,5,6,2,1,5,2,4,1] 
```

编写此方法的最佳方法是什么？有什么快速的方法可以做到这一点，还是我需要手动循环这些值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:45:56.577

So, you need to check if all the values in a list are the same?

```
boolean checkList(List<Integer> list) {
  if (list.isEmpty())
    return false;

  int value = list.get(0);
  for (int i = 1; i < list.size(); ++i) {
    if (list.get(i) != value)
      return false;
  }

  return true;
} 
```

but I'd be careful about `null` values in the list, too...

# model-view-controller - 带有独立控制器的 ExtJS4 模块化？

> ID：10194316
> 
> 赞同：2
> 
> 时间：2012-04-17T15:36:15.903
> 
> 标签：model-view-controller, extjs, extjs-mvc

我正在尝试将 ExtJS4 应用程序拆分为模块。

```
 - app
  - store
  - controller
  - model
  - view
  - module
     - m1
         - model
         - view
         - controller
     - m2
         - model
         - ... 
```

问题是，当我启动应用程序并启动其中一个 m1 控制器时，控制器没有 this.control() 函数。

- 编辑 -

我在控制器文件夹中定义了一个类。

```
Ext.define( 'App.module.ping.controller.Ping', {
  extend: 'Ext.app.Controller',

  requires: [
     'App.module.ping.view.PingPanel'
  ],

  init: function() {
     this.control( {
        '#app.module.ping': {
           render: this.onPanelRendered
        }
     } );
  },

  onPanelRendered: function() {
     ...
  } 
```

});

后来我打电话

```
Ext.create('App.module.ping.controller.Ping').init(); 
```

但我收到此错误：

```
Uncaught TypeError: Cannot call method 'control' of undefined
Ext.define.control./lib/extjs-4.1.0/src/app/Controller.js:414
Ext.define.init./app/module/ping/app/controller/Ping.js:11
Ext.define.init./app/module/ping/app/Module.js:11
(anonymous function)app.js:17
(anonymous function)app.js:35 
```

Module.js 是带有 create() 调用的文件 Ping.js 是带有 define() 调用的文件

-- 编辑2 --

病理例子：

输入：

```
Ext.define( 'MyController', { 
  extend: 'Ext.app.Controller', 
  init: function() { console.log('initialized'); } 
}); 
```

输出：

```
function constructor() {
  return this.constructor.apply(this, arguments);
} 
```

输入：

```
Ext.create('MyController'); 
```

输出：

```
constructor 
```

输入：

```
MyController.create(); 
```

输出：

```
constructor 
```

-- 编辑3 --

控制器在创建时需要配置对象中的应用程序对象。应用程序对象将自己添加到所有控制器中，这些控制器*不是*使用 create 手动创建的。它调用这样的东西：

```
Ext.create('App.controller.Users', { application: this, ... } ); 
```

稍后它使用应用程序对象将控制调用重定向到它。

```
control: function ( config ) { this.application.control( config ) }; 
```

所以我可能会实现一些机制，当我创建它们时，它会自动将应用程序添加到这些控制器中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:45:19.550

你有没有尝试过

```
var pingController = Application.getController('App.module.ping.controller.Ping');
pingController.init(); //or pingController.init(Application); 
```

其中 Application 是对 Ext.application.launch 期间创建的对象的引用 - 例如

```
var Application = {};
Ext.application({
    //all of your settings,
    launch:function(){
         Application = this;
         //other launch code
    }
}
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-25T16:25:06.120

对于其他来这里寻找解决方案的人：

```
Uncaught TypeError: Cannot call method 'control' of undefined 
```

除了一整天的挫败感之外，上面的答案并没有解决我的问题，而是引导我尝试以下方法，这确实解决了问题：

```
// app.js
Ext.application({
    ...

    launch: function(){
        var me = this;
        ...

        me.getController('ControllerName');
    }
});

// inside controller/ControllerName.js
init: function(app){
    var me = this;

    app.control({
        '#editButton': {
            click: function(){
                me.someFunction();
            }
        }
    });
}, 
```

该应用程序变量与为问题选择的答案中的“var Application = {}”相同——这意味着我不需要全局添加它（或根本不需要）。我一定尝试过一百万种不同的东西，但这最终奏效了。希望它能拯救别人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T10:19:08.340

不需要`init(`手动调用 )。只要调用`Ext.create`，构造函数就会被自动调用。

# java - Spring MVC 3 验证器不显示错误消息

> ID：10194319
> 
> 赞同：0
> 
> 时间：2012-04-17T15:36:23.490
> 
> 标签：java, forms, jsp, spring-mvc, tiles

我在 Spring Application 中显示错误消息时遇到问题。我正在使用 Spring MVC 3 和 Apache Tiles。当我在表单中出现错误时，它不会显示错误消息。请帮我听听是一段代码。

Web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>SpringExample</display-name>
  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.htm</welcome-file>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>default.html</welcome-file>
    <welcome-file>default.htm</welcome-file>
    <welcome-file>default.jsp</welcome-file>
  </welcome-file-list>
  <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>
            org.springframework.web.servlet.DispatcherServlet
        </servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>
                /WEB-INF/spring/dispatcher-servlet.xml
            </param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>  

</web-app> 
```

调度程序-Servlet.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <context:component-scan base-package="com.examples.spring" />

    <bean id="viewResolver"
        class="org.springframework.web.servlet.view.UrlBasedViewResolver">
        <property name="viewClass">
            <value>
                org.springframework.web.servlet.view.tiles2.TilesView
            </value>
        </property>
    </bean>

    <bean id="tilesConfigurer"
        class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
        <property name="definitions">
            <list>
                <value>/WEB-INF/tiles.xml</value>
            </list>
        </property>
    </bean>

</beans> 
```

瓷砖.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE tiles-definitions PUBLIC
       "-//Apache Software Foundation//DTD Tiles Configuration 2.0//EN"
       "http://tiles.apache.org/dtds/tiles-config_2_0.dtd">
<tiles-definitions>

    <definition name="create_account_success" template="/WEB-INF/jsp/account/SuccessJSP.jsp">
    </definition>

    <definition name="account_create" template="/WEB-INF/jsp/account/testForm.jsp">

    </definition>

</tiles-definitions> 
```

testForm.jsp

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
    <%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
    <form:form id="form" modelAttribute="formCreate" method="post">
    <table>
        <tr>
            <td>Name :</td>
            <td><form:input path="name"/>
                <form:errors path="name"/>
            </td>
        </tr>
        <tr>
            <td>Password :</td>
            <td><form:input path="password"/>
                <form:errors path="password"/>
            </td>
        </tr>
        <tr>
            <td colspan="2"><input type="submit" /></td>
        </tr>
    </table>
    </form:form>
</body>
</html> 
```

AccountRegistrationController.java

```
package com.examples.spring.controller;

import org.springframework.stereotype.Controller;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.servlet.ModelAndView;

import com.examples.spring.dto.AccountDTO;
import com.examples.spring.validator.AccountValidator;

@Controller
public class AccountRegistrationController {

    public static final String BASE_URL = "/account";

    @RequestMapping(value = BASE_URL + "/create" ,method = RequestMethod.GET)
    public ModelAndView accountCreate(){
        ModelAndView view = new ModelAndView();
        view.addObject("formCreate", new AccountDTO());
        view.setViewName("account_create");
        return view;
    }

    @RequestMapping(value = BASE_URL + "/create" ,method = RequestMethod.POST)
    public ModelAndView accountRegistration(@ModelAttribute AccountDTO accountDTO,BindingResult result ){

        ModelAndView view = new ModelAndView();

        AccountValidator validator = new AccountValidator();
        validator.validate(accountDTO, result);
        if (result.hasErrors()) {
            view.setViewName("account_create");
            view.addObject("formCreate", accountDTO);
            return view;
        }
        view.setViewName("create_account_success");
        return view;
    }

    @RequestMapping(value = BASE_URL + "/login" ,method = RequestMethod.GET)
    public ModelAndView accountLogin(){
        ModelAndView view = new ModelAndView();
        view.setViewName("account_login");
        return view;
    }
} 
```

AccountValidator.java

```
package com.examples.spring.validator;

import org.springframework.validation.Errors;
import org.springframework.validation.ValidationUtils;
import org.springframework.validation.Validator;

import com.examples.spring.dto.AccountDTO;

public class AccountValidator implements Validator {

    @Override
    public boolean supports(Class<?> clazz) {
        return AccountDTO.class.isAssignableFrom(clazz);
    }

    @Override
    public void validate(Object result, Errors error) {
        AccountDTO accountDTO = (AccountDTO) result;

        ValidationUtils.rejectIfEmpty(error, "name", "require.name", "Name Requires.");
        ValidationUtils.rejectIfEmpty(error, "password", "require.password", "Password Requires.");
    }

} 
```

AccountDTO.java

```
package com.examples.spring.dto;

public class AccountDTO {

    private String name;
    private String password;

    public AccountDTO() {
        // TODO Auto-generated constructor stub
    }

    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getPassword() {
        return password;
    }
    public void setPassword(String password) {
        this.password = password;
    }

} 
```

我的代码运行良好，但在`<form:errors />`.

请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:26:06.297

ValidationUtils.rejectIfEmpty 的第三个参数是错误代码。它应该是资源包中实际消息的关键。如果找不到值，我不知道它的行为如何。您应该将其更改为使用密钥，并可选择设置默认消息。请参阅[api](http://javasourcecode.org/html/open-source/spring/spring-3.0.5/org/springframework/validation/ValidationUtils.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:15:32.037

您需要在要使用它的控制器上注册您的验证器。见：[http ://static.springsource.org/spring/docs/3.0.0.RC3/reference/html/ch05s07.html#validation.mvc](http://static.springsource.org/spring/docs/3.0.0.RC3/reference/html/ch05s07.html#validation.mvc)

# android - 在 Android 版 Facebook SDK 上更改语言

> ID：10194322
> 
> 赞同：1
> 
> 时间：2012-04-17T15:36:34.030
> 
> 标签：android, facebook, sdk

我目前正在使用适用于 Android 的 Facebook SDK 从我的移动应用程序中将消息发布到您的 Facebook 墙上。现在，所有 Facebook 视图都默认以法语显示，但我希望它们使用荷兰语。我认为这是因为 Facebook 检测到我住在比利时，并且错误地将语言设置为法语。然而，我的 Dalvik VM 上的语言设置是荷兰语。

谁能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T07:31:44.580

我找到了解决方案。我的 DALVIK VM 语言设置设置为“荷兰语（比利时）”，但将其设置为“荷兰语（荷兰）”解决了这个问题。这是一个肮脏但显然有效的解决方案。

# ios - iOS 5.1 中的 SVG 滞后与 @2x PNG

> ID：10194324
> 
> 赞同：1
> 
> 时间：2012-04-17T15:36:40.490
> 
> 标签：ios, webkit, svg, png, retina-display

我有一个 SVG 精灵，我正在加载到我的常规网站和移动网站中。SVG 为 74kb。在 New iPad(v3) iOS 5.1(9B176) 上的正常站点中加载时，滚动和缩放问题为零。有 24 个实例显示了精灵的一部分。

当我在 iPhone 4 iOS 5.1(9B176) 上将相同的 SVG 加载到移动网站时，当我抬起手指时，我在上下滚动时会出现明显的延迟。如果我将手指放在屏幕上，则不会出现滚动问题。只有 16 个实例显示了部分精灵。如果我用@2x PNG (152kb) 替换 SVG，我没有滚动问题。在移动站点上没有缩放，因为视口设置为 user-scalable=0。

我想知道问题可能是什么以及为什么会发生这种情况。任何见解将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T14:31:11.507

一旦我添加 CSS 变换或 blackface-visibility，它就会在重绘时开始闪烁并在缩放/滚动结束时滞后。因此，请尝试删除页面上的所有 CSS 动画，看看它是否有任何影响。

# c# - 在 ABC pdf 中呈现 pdf 之前让 Javascript 完成

> ID：10194325
> 
> 赞同：2
> 
> 时间：2012-04-17T15:36:40.740
> 
> 标签：c#, javascript, google-maps, abcpdf

我正在尝试制作在 Google 地图上显示位置的网页的 pdf。唯一的问题是，在 ABCpdf 呈现 pdf 时，Javascript 还没有完全完成。它不完整。如何让 ABDpdf 等到 javascript 100% 完成后再呈现 pdf。这是我到目前为止所尝试的。

```
Doc theDoc = new Doc();
            string theURL = url;
            // Set HTML options
            theDoc.HtmlOptions.AddLinks = true;
            theDoc.HtmlOptions.UseScript = true;
            theDoc.HtmlOptions.PageCacheEnabled = false;
            //theDoc.HtmlOptions.Engine = EngineType.Gecko;
            // JavaScript is used to extract all links from the page

            theDoc.HtmlOptions.OnLoadScript = "var hrefCollection = document.all.tags(\"a\");" +
              "var allLinks = \"\";" +
              "for(i = 0; i < hrefCollection.length; ++i) {" +
              "if (i > 0)" +
              "  allLinks += \",\";" +
              "allLinks += hrefCollection.item(i).href;" +
              "};" +
              "document.documentElement.abcpdf = allLinks;";
            // Array of links - start with base URL
            theDoc.HtmlOptions.OnLoadScript = "(function(){window.ABCpdf_go = false; setTimeout(function(){window.ABCpdf_go = true;}, 1000);})();";
            ArrayList links = new ArrayList();
            links.Add(theURL);
            for (int i = 0; i < links.Count; i++)
            {
                // Stop if we render more than 20 pages
                if (theDoc.PageCount > 20)
                    break;
                // Add page
                theDoc.Page = theDoc.AddPage();
                int theID = theDoc.AddImageUrl(links[i] as string);
                // Links from the rendered page
                string allLinks = theDoc.HtmlOptions.GetScriptReturn(theID);
                string[] newLinks = allLinks.Split(new char[] { ',' });
                foreach (string link in newLinks)
                {
                    // Check to see if we allready rendered this page
                    if (links.BinarySearch(link) < 0)
                    {
                        // Skip links inside the page
                        int pos = link.IndexOf("#");
                        if (!(pos > 0 && links.BinarySearch(link.Substring(0, pos)) >= 0))
                        {
                            if (link.StartsWith(theURL))
                            {
                                links.Add(link);
                            }
                        }
                    }
                }
                // Add other pages
                while (true)
                {
                    theDoc.FrameRect();
                    if (!theDoc.Chainable(theID))
                        break;
                    theDoc.Page = theDoc.AddPage();
                    theID = theDoc.AddImageToChain(theID);
                }
            }
            // Link pages together
            theDoc.HtmlOptions.LinkPages();
            // Flatten all pages
            for (int i = 1; i <= theDoc.PageCount; i++)
            {
                theDoc.PageNumber = i;
                theDoc.Flatten();
            }

            byte[] theData = theDoc.GetData();

            Response.Buffer = false; //new
            Response.Clear();
            //Response.ContentEncoding = Encoding.Default;
            Response.ClearContent(); //new
            Response.ClearHeaders(); //new
            Response.ContentType = "application/pdf"; //new
            Response.AddHeader("Content-Disposition", "attachment; filename=farts");

            Response.AddHeader("content-length", theData.Length.ToString());
            //Response.ContentType = "application/pdf";
            Response.BinaryWrite(theData);
            Response.End();

            theDoc.Clear(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T06:11:08.833

我有一个非常相似的问题（将 Google 可视化呈现为 PDF），这是我用来部分解决它的技巧：

首先，你的 JavaScript 需要被执行`DOMContentLoaded`而不是被执行`load`（你马上就会明白为什么）。接下来创建一个空页面，该页面将通过计时器提供内容（您可以使用`System.Threading.Thread.Sleep`让页面“等待”一段时间）。

然后在要呈现为 PDF 的页面上放置一个隐藏图像，其中包含需要在生成 PDF 之前执行的 JavaScript。图像的“src”属性必须有一个指向您的计时器页面的 URL（在以下示例中，我通过查询字符串指定延迟以毫秒为单位）：

```
<img src="Timer.aspx?Delay=1000" style="width: 1px; height: 1px; visibility: hidden" /> 
```

请注意，我使用`visibility: hidden`而不是`display: none`隐藏图像。原因是某些浏览器在图像可见之前可能不会开始加载图像。

现在将会发生的是 ABCpdf 将等到图像被加载，而您的 JavaScript 已经在执行（因为在它`DOMContentLoaded`之前被触发`load`，直到所有图像都被加载）。

当然，您无法准确预测执行 JavaScript 需要多少时间。另一件事是，如果 ABCpdf 无法在 15 秒内加载页面（默认值，但我认为您可以更改它），它将引发异常，因此在选择延迟时要小心。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-16T12:46:03.867

在我的例子中，我们将 v8 升级到 v9 并生成网页的缩略图，这也需要大量的 javascript CSS 操作来进行对象定位。当我们切换到 v9 时，我们注意到对象被复制了（显示在它们的原始位置和它们应该位于 js 之后的位置）。

The workaround that I applied was using the RenderDelay and OneStageRender properties to change how the page rendering is handled to PDF. The 500 is ms, so 1/2 second. The bigger culprit seemed to be the OneStageRender. That had to be disabled in order for rendering to handle properly.

```
doc.SetInfo(0, "RenderDelay", "500")
doc.SetInfo(0, "OneStageRender", 0) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-17T15:42:23.747

`document.ready()`尝试将您的脚本块变成一个 javascript 函数，然后从文件顶部的函数中调用该函数。我假设您正在使用 jQuery。该`ready()`函数将确保所有页面元素在调用其主体中的任何函数之前都已稳定。

# c# - 在 iPad 和 PC 上保存屏幕截图并通过电子邮件发送 (Unity C#)

> ID：10194327
> 
> 赞同：0
> 
> 时间：2012-04-17T15:36:47.210
> 
> 标签：c#, ipad, screenshot, unity3d, email-attachments

我正在开发一款游戏。当用户完成时，游戏应该将屏幕截图发送到预先注册的电子邮件地址。该游戏可在 iPad 和独立 PC 上运行。对于 PC，我发现了如何截取屏幕截图，但它似乎不适用于 iPad。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T18:58:26.667

我们为此使用 Prime31 etcera 插件。实施简单快捷。而且我不是 Prime31 的！

# java - 为什么我的 SharedPreferences 条目在重新安装时没有被清除？

> ID：10194332
> 
> 赞同：1
> 
> 时间：2012-04-17T15:37:00.490
> 
> 标签：java, android, android-emulator, sharedpreferences

重新安装我的应用程序后，我的 if 语句中的代码正在被访问，尽管我的 SharedPreferences 条目尚未创建。我正在使用带有 Eclipse 的模拟器，是否需要以其他方式清除数据而不是重新安装？谢谢

```
prefs = getSharedPreferences("appData", 0);
        Gson gson = new Gson();
        String gsonStr = prefs.getString("playerString", null);

        if(gsonStr != null)
        {
            //This code is being accessed on the apps first onCreate() call prior to being reinstalled 
            Player[] tempArray = gson.fromJson(gsonStr, Player[].class);
            Log.d("First Player", "" + tempArray[0]);
        }

protected void onPause() 
{
    super.onPause();
    if(savedPlayers != null)
    {
        Gson gson = new Gson();
        String gsonStr = gson.toJson(savedPlayers.toArray());

        prefs = getSharedPreferences("appData", 0);
        SharedPreferences.Editor editor = prefs.edit();
        //editor().clear();
        Log.d("GSONString",gson.toString());
        editor.putString("playerString", gsonStr);
        editor.putInt("ArraySize", savedPlayers.size());
        editor.commit();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T15:40:59.350

很可能只是重新安装了该应用程序。为了清除数据，实际上必须先卸载应用程序。重新安装实际上不会清除数据。模拟器实际上允许运行时选项，当您运行模拟器时将擦除所有用户数据，但我不相信它会在您每次运行应用程序时运行。如果您使用的是 eclipse，您可以在应用程序的运行配置中设置此选项。

要从模拟器内部执行此操作，请转到设置->应用程序->管理应用程序->您的应用程序->清除数据

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T15:41:41.453

重新安装时不会删除共享首选项和 sqlite db。要删除它们，请转到**设置->应用程序->管理应用程序->单击您的应用程序->单击**模拟器上的“清除数据”。这将清除存储的数据。

# magento - 如何自定义 magento 单页结帐表单

> ID：10194341
> 
> 赞同：8
> 
> 时间：2012-04-17T15:37:42.823
> 
> 标签：magento, checkout

我正在使用 Magento 1.5.1.0，我想在单页结帐表单中自定义地址块。我想删除“传真”输入字段并将“地区”下拉菜单放在国家“下拉菜单”下方。这个表格是在哪里定义的？

亲切的问候，伯蒂

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-17T21:25:05.587

导航到您的主题文件夹。默认文件位于：

```
app\design\frontend\base\default\template\checkout\onepage\shipping.phtml 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-10-25T23:41:58.800

您可能需要更改多个文件：

如上：

```
app\design\frontend\base\default\template\checkout\onepage\shipping.phtml 
```

但是也...

```
app\design\frontend\base\default\template\checkout\onepage\billing.phtml 
```

并且...

```
app\design\frontend\base\default\template\persistent\checkout\onepage\billing.phtml 
```

多田！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-22T14:58:07.183

哦，别忘了`app\design\frontend\base\default\template\customer\address\edit.phtml`

# php - 带有 PHP 代码的 Bash 脚本

> ID：10194355
> 
> 赞同：2
> 
> 时间：2012-04-17T15:38:23.020
> 
> 标签：php, bash, urldecode

我有一个 bash 脚本，它有一个 urlencoded 字符串作为变量，我想对其进行解码。我知道这可以用 bash 完成，但我想我不妨调用一个 PHP 函数 urldecode() 并完成它。

我本来希望在 bash 代码中运行 php 函数，但我选择编写一个非常简单的脚本

```
<?php
   echo urldecode($argv);
?> 
```

并在 bash 脚本中调用此脚本

```
#!/bin/bash
...#$MYURL is an encoded url
...
$MYURL="php myurldecodescript.php -- $MYURL" 
```

不幸的是，这不起作用。如何最好地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:42:04.287

尝试：

```
MYURL=$(php myurldecodescript.php -- "$MYURL") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T16:04:05.433

您可以使用 PHP 执行此操作，而无需创建`myurldecodescript.php`文件。如果您`-r`为 PHP 提供一个选项，它将运行您在命令行中指定的代码。所以你可以这样做：

```
MYURL=`php -r "echo urldecode('$MYURL');"` 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T15:41:42.303

尝试

```
$MYURL="php myurldecodescript.php $MYURL" 
```

不确定是否`--`会起作用（我不是 bash 专家！！）....并且在 PHP 中

```
echo urldecode($argv[1]); 
```

[`$argv`是一个数组](http://php.net/manual/en/reserved.variables.argv.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T15:44:28.577

干得好：

```
echo $MYURL | sed -e's/%\([0-9A-F][0-9A-F]\)/\\\\\x\1/g' | xargs echo -e 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T16:32:26.423

怎么样

```
MYURL=$(php -r 'echo urldecode($argv[1]);' "$MYURL") 
```

# iphone - 更快的 if 语句

> ID：10194356
> 
> 赞同：0
> 
> 时间：2012-04-17T15:38:24.883
> 
> 标签：iphone, objective-c, ios, xcode, if-statement

我正在尝试创建一个 iOS 应用程序，其中涉及一个主要的 if 语句来检查文本框是否包含某些文本。我想检查某个单词的多个实例，但我不想执行多个 if 语句，因为这会大大降低应用程序的性能。

如何检查单词是否与 NSArray 中的单词匹配，如果匹配，则在另一个文本框中返回与该单词关联的 NSString？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:46:07.950

您可以创建一个`NSDictionary`您正在检查的单词映射到`NSString`您想要在输入该单词时返回的单词：

```
NSDictionary *words = [[NSDictionary alloc] initWithObjectsAndKeys:
    @"word1", @"result1",
    @"word2", @"result2",
    /*etc*/
    nil];

NSString *wordFromTextBox = ...;
NSString *result = [words objectForKey:keyword];
if (result != nil)
{
    // use result
}
else
{
    // word wasn't something we expected
}

// Some time later
[words release]; 
```

编辑：要遍历列表以便您可以测试*关键字*是否包含在文本框中，您可以执行以下操作（假设`words`并`wordFromTextBox`像以前一样设置）：

```
NSEnumerator *enumerator = [words keyEnumerator];
while ((NSString *keyword = [enumerator nextObject]) != nil)
{
    if ([wordFromTextBox rangeOfString:keyword].location != NSNotFound)
    {
        NSLog(@"The text box contains keyword '%@'", keyword);
        NSString *result = [words objectForKey:wordFromTextBox];
        // Use the result somehow
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:46:53.843

我会使用 NSMutableDictionary/NSDictionary。字典键将是您要查找的单词。这些值将是您希望返回的单词。一旦你有了字典设置，只需调用`[dict valueForKey:textbox.text]`. 如果条目不在那里，dict 将返回 nil，因此您可以测试该条件。总而言之，我认为这可能是最快的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T15:50:00.920

对于数组，你可以从这段代码中得到一个想法：

```
NSArray* myArray = [[NSArray alloc] initWithObjects:@"one",@"two",@"three",@"four", nil];
NSString* stringToSearch = @"four";
NSUInteger indexPositionInArray = [myArray indexOfObject:stringToSearch];
NSLog(@"position in array: %i", indexPositionInArray);
if (indexPositionInArray !=  NSNotFound) {
    NSLog(@"String found in array: %@", [myArray objectAtIndex:indexPositionInArray]);
}

NSString* stringToSearch2 = @"fourrrr";
NSUInteger indexPositionInArray2 = [myArray indexOfObject:stringToSearch2];
NSLog(@"position in array: %i", indexPositionInArray2);
if (indexPositionInArray2 !=  NSNotFound) {
    NSLog(@"String found in array: %@", [myArray objectAtIndex:indexPositionInArray]);
} 
```

# visual-studio-2010 - 在 .cs 文件中搜索字符串

> ID：10194363
> 
> 赞同：1
> 
> 时间：2012-04-17T15:38:44.210
> 
> 标签：visual-studio-2010, full-text-search

在我的 Visual Studio 2010 中，我确实搜索了一个字符串并显示了查找结果窗口。这很好，但是，我需要在目标搜索的上方显示 3 行，在下方显示 3 行。可以吗？

或者，你知道有什么工具可以做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:44:08.463

使用 Visual Studio 搜索确实无法做到这一点。它只会显示匹配发生的实际行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:45:45.223

我喜欢[Windows Grep](http://www.wingrep.com/)来解决这样的问题。

更新：

Windows Grep 可以在不对搜索字符串应用正则表达式匹配的“快速”模式下运行。它还提供有限的字符串替换功能。

# linux - 即使权限设置正确，也无法在 Ubuntu 11.10 中创建文件/目录

> ID：10194364
> 
> 赞同：2
> 
> 时间：2012-04-17T15:38:49.757
> 
> 标签：linux, ubuntu-11.10, user-management

我对 ubuntu 11.10 中的某些东西感到害怕。我正在尝试将写入权限授予特定文件夹中的当前用户。因此，首先，我要求所有者在默认文件夹 (/var/www) 上将权限授予我的 apache 用户。

```
sudo chown -R apache:apache /var/www 
```

然后，我将我当前的使用添加到组 apache 中。

```
sudo usermod -a -G apache ollie314 
```

我检查 ollie314 是否拥有正确的权限：

```
groups ollie314
> ollie314 apache 
```

好的 ！现在我检查我是谁。

```
whoami
> ollie314 
```

听起来不错 ...

```
cd /var/www
mkdir test
> mkdir: cannot create directory `test': Permission denied 
```

嗯...我做错了什么，但我不知道在哪里。我怀疑是通过 parent forlder 问题，但它在我的 debian 挤压上运行良好。有人可以帮助我吗？提前致谢 ！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T15:50:34.960

像这样的组更改在您下次登录时才会生效。注销然后重新登录。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-17T15:43:11.680

尝试 ：

```
sudo mkdir test 
```

尽管问题中未指定您是否有权访问超级用户..

# java - 如何让 Ivy 从 Nexus repo 下载资源

> ID：10194367
> 
> 赞同：6
> 
> 时间：2012-04-17T15:39:03.177
> 
> 标签：java, maven, ivy, nexus, ivyde

我一直在寻找解决问题的方法，但我遇到的所有其他帖子要么不起作用，要么不符合我的情况，所以希望有人能给我一些见解。

我有一个用 ant 构建的库，它输出 2 个 jar 文件，一个正常包含库的编译版本，另一个只包含源文件。

这个库被上传到我们的 Nexus 存储库，打包设置为 jar。对于实际的 jar 文件，我将扩展名设置为 jar 并将分类器留空。对于源 jar，我将分类器设置为源，并将扩展名设置为 jar。

无论我用 ivy.xml 文件做什么，我都无法下载源 jar。根据我在其他地方阅读的帖子，我尝试添加：

```
conf="*->default,sources" 
```

我的依赖，但后来我得到一个错误：

```
configuration not found in org#name;version: 'sources' 
```

所以这基本上是期望我的库将源定义为某处的配置？我认为它只会发现一个事实，即分类器设置为存储库中的源的另一个人工制品。

任何人都可以就我将库发布到 Nexus 的方式或我在 Ivy 文件中设置依赖项声明的方式给我可能做错的其他建议。

这是基本的 Ivy.xml 文件，我在其中定义了我对放在 Nexus 中的库的依赖关系。

```
<ivy-module version="2.0">

    <info organisation="${ivy.organisation}" module="moduleName" />

    <configurations>
        <conf name="pda" description="moduleName for PDA"/>
        <conf name="server" description="moduleName for server"/>
    </configurations>

    <dependencies>
        <!-- Internal -->
        <dependency name="utility" org="${ivy.organisation}" rev="latest.integration" conf="${ivy.configuration}"/>
        <dependency name="myLib" org="my.org" rev="0.0.+"/>
    </dependencies>

</ivy-module> 
```

作为对以下评论的回应，ivy.configuration 属性在我的 Ant 的 build.properties 中设置为 pda。对于 Eclipse，我创建了一个属性文件并将 ivy.configuration 设置为 pda（然后在 Eclipse 中的 Ivy 设置中引用此属性文件）。

我得到的错误信息是：

```
Some projects fail to be resolved
    Impossible to resolve dependencies of ${ivy.organisation}#moduleName;working@host
        unresolved dependency: my.org#myLib;0.0.+: configuration not found in my.org#myLib;0.0.0: 'sources'. It was required from ${ivy.organisation}#moduleName;working@host pda 
```

**更新** 这是已解决的 ivy.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<ivy-module version="2.0">
    <info organisation="my.org"
        module="myLib"
        revision="0.0.0"
        status="release"
        publication="20120419131909"
        default="true"
    />
    <configurations>
        <conf name="default" visibility="public"/>
    </configurations>
    <publications>
        <artifact name="myLib" type="jar" ext="jar" conf="default"/>
    </publications>
</ivy-module> 
```

这显然解释了为什么它无法找到“来源”conf。但我的印象是应该自动添加源 conf，因为我已将源添加到 Nexus。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T15:11:29.063

您应该在发布工件时告诉 Ivy 配置。例如：

```
<ivy-module version="2.0">
    <info organisation="apache" module="commons-lang" revision="2.5" status="release"/>
    <configurations>
        <conf name="binary" description="provide only binary files"/>
        <conf name="development" extends="binary" description="provide binary files with javadoc and sources"/>
    </configurations>
    <publications>
        <artifact name="commons-lang" ext="jar" conf="binary" type="jar"/>
        <artifact name="commons-lang-javadoc" ext="jar" conf="development" type="javadoc"/>
        <artifact name="commons-lang-sources" ext="jar" conf="development" type="source"/>
    </publications>
</ivy-module> 
```

如您所见，commons-lang.jar 在二进制配置下发布。但是 commons-lang-sources 和 commons-lang-javadoc 在开发配置下发布。

当您检索依赖项时，您应该使用以下 ivy.xml：

```
<ivy-module version="2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ant.apache.org/ivy/schemas/ivy.xsd">
    <info organisation="bitrete" module="strongpoint" status="development"/>
    <configurations>
        <conf name="binary" description="provide only binary files"/>
        <conf name="development" extends="binary" description="provide binary files with javadoc and sources"/>
    </configurations>
    <publications>
        <artifact name="strongpoint" ext="jar" type="jar"/>
    </publications>
    <dependencies>
        <dependency org="apache" name="commons-lang" rev="2.5"/>
    </dependencies>
</ivy-module> 
```

并在使用 Ant 解析时提供所需的配置：

```
<property name="ivy.conf" value="binary"/>
...
<property name="ivy.conf" value="development"/>
...
<ivy:resolve conf="${ivy.conf}"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-23T09:56:35.973

所以在玩了很多之后，我似乎终于找到了解决方案。如果我通过以下方式声明我的依赖项：

```
<dependency name="myLib" org="my.org" rev="0.0.+">
    <artifact type="jar"/>
    <artifact type="source" m:classifier="sources" conf="pdaDev->sources"/>
</dependency> 
```

然后我可以添加一个新配置（例如上面的 pdaDev），它链接到依赖项的源配置。使用 Eclipse 时，我可以告诉它使用 pdaDev 配置，它也会拉入源 jar（如果存在）。

Nexus 似乎没有在解析的 Ivy 文件中包含源配置似乎很奇怪，除非像我上面所做的那样明确要求它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T00:45:07.887

在您的 ivy 文件中创建两个配置。一个用于应该在类路径上的二进制文件，另一个用于源 jar。

其次，在依赖上创建两个配置映射：

```
<ivy-module version="2.0">
    <info organisation="org.demo" module="demo"/>
    <configurations>
        <conf name="compile" description="jars used for compilation classpath"/>
        <conf name="sources" description="Source jars"/>
    </configurations>
    <dependencies>
        <dependency org="org.slf4j" name="slf4j-simple" rev="1.6.4" conf="compile->default;sources->sources"/>
    </dependencies>
</ivy-module> 
```

笔记：

*   Maven 模块由 ivy 翻译成具有一组标准配置。有关更多详细信息，请参阅[Maven 范围如何通过 ivy 映射到 ivy 配置](https://stackoverflow.com/questions/7104364/how-are-maven-scopes-mapped-to-ivy-configurations-by-ivy/7116577#7116577)

在您的 ANT 构建中，您可以使用如下配置：

```
<target name="init">
    <ivy:resolve/>

    <!-- Populate a compile classpath for use with javac task -->
    <ivy:cachepath pathid="compile.path" conf="compile"/>

    <!-- Put source jars in the src directory -->
    <ivy:retrieve pattern="src/[artifact]-[revision](-[classifier]).[ext]" conf="sources"/>

</target> 
```

# asp.net-mvc-3 - 如何为不同的模型创建通用视图

> ID：10194370
> 
> 赞同：1
> 
> 时间：2012-04-17T15:39:24.237
> 
> 标签：asp.net-mvc-3

我想知道是否有人可以帮助我解决以下问题。我仔细浏览了论坛，没有找到任何适合我需要的安静的东西。我是泛型的新手，也是 MVC 的新手，所以请放轻松:-)。

基本上，我希望能够将一个通用列表模型传递给我的通用视图，然后调用一个呈现列表的通用 html 助手。

我有 2 个视图模型，它们都继承自同一个抽象类……</p>

```
public abstract class DisplayableViewModel
{
    [HiddenInput(DisplayValue = false)]
    [Key]
    public int ID { get; set; }
}

public class ContactListViewModel : DisplayableViewModel
{
    public string FullName { get; set; }
    public string ContactLandline { get; set; }
    public string ContactEmail { get; set; }
}

public class ProductListViewModel : DisplayableViewModel
{
    public string ProductCompany { get; set; }
    public string ProductDesc { get; set; }
    public decimal ProductPrice { get; set; }
    public string ProductCategory { get; set; }
} 
```

然后我的控制器创建了一个 SearchViewModel 对象，它是……</p>

```
public class SearchViewModel<T>
{
    public IEnumerable<T> Entity { get; set; }
    public PagingInfo PagingInfo { get; set; }
} 
```

这填充了视图模型之一的对象（在我提供的示例中，它是 ContactListViewModel，但它也可能是 ProductListViewModel）、一些用于分页的信息，并将其返回到我的视图。

```
 public ViewResult List(int page = 1)
    {
        ContactListViewModel[] e = Mapper.Map<Contact[], ContactListViewModel[]>(repository.Contact.ToArray());

        SearchViewModel<DisplayableViewModel> viewModel = new SearchViewModel<DisplayableViewModel>
        {
            Entity = e,
            PagingInfo = new PagingInfo
            {
                CurrentPage = page,
                ItemsPerPage = PageSize,
                TotalItems = e.Count()
            }
        };
        return View(viewModel);
    } 
```

视图执行以下操作……</p>

```
@using AppForProducts.WebUI.Models
@model AppForProducts.WebUI.Models.SearchViewModel<DisplayableViewModel>
@{
    ViewBag.Title = "List";
}

@(Html.DataGrid<DisplayableViewModel>(Model.Entity))
<div class="pager">
   @Html.PageLinks(Model.PagingInfo, x => Url.Action("List", new {page = x}))
</div> 
```

html.DataGrid 是我发现的一个助手，它只是呈现某种类型的记录列表，因此可以有 1 列或更多列（如果你想看看它在这里...... [http://stephenwalther.com/ blog/archive/2009/03/03/chapter-6-understanding-html-helpers.aspx](http://stephenwalther.com/blog/archive/2009/03/03/chapter-6-understanding-html-helpers.aspx) - 我知道已经添加到 MVC 中的功能可以做到这一点，但我这样做是作为训练练习）。

我遇到的问题是它只呈现 ID 列表，因为 DisplayableViewModel 是视图的类型参数。如果我使用 ContactListViewModel 作为 Type 参数调用 html.DataGrid，它可以工作，但是我无法使用相同的视图呈现另一个模型，例如 ProductListViewModel。此外，如果我省略 Type 参数，编译器会说必须明确说明类型，因为它无法推断。

有没有办法可以通用？我真的希望能够在视图中指定一些类型 T，它被定义为 ContactListViewModel 或 ProductListViewModel，具体取决于从控制器传递给它的内容。

感谢大家，

吉姆

# windows-7 - wow64 进程中的 x64 模块？

> ID：10194371
> 
> 赞同：4
> 
> 时间：2012-04-17T15:39:25.693
> 
> 标签：windows-7, module, x86, 64-bit, wow64

我有一个在 win7 x64 上调试的小型 32 位进程，我看到它按预期加载了 "C:\windows\sysWow64\ntdll.dll" ，但也加载了 "C:\windows\system32\ntdll.dll" 。
我知道 x64 模块和 x86 模块不能混用，但他们在这里……混用……
怎么可能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T15:45:15.667

这是 WOW64 的一个特殊“功能”，请参阅MSDN 上的[这篇文章](http://msdn.microsoft.com/en-us/library/aa384274%28v=vs.85%29.aspx)。相关部分是：

> WOW64 模拟器在用户模式下运行。它提供了 32 位版本的 Ntdll.dll 和处理器内核之间的接口，并拦截内核调用。WOW64 模拟器由以下 DLL 组成：
> 
> *   Wow64.dll 为 Ntoskrnl.exe 入口点函数提供核心仿真基础结构和 thunk。
>     
>     
> *   Wow64Win.dll 为 Win32k.sys 入口点函数提供 thunk。
>     
>     
> *   Wow64Cpu.dll 是一个抽象主处理器特性的接口库。（仅限英特尔安腾）
>     
>     
> *   IA32Exec.bin 包含 x86 软件模拟器。（仅限英特尔安腾）
>     
>     
> *   Wowia32x.dll 提供了 IA32Exec.bin 和 WOW64 之间的接口。
>     
>     
> 
> **这些 DLL 以及 64 位版本的 Ntdll.dll 是唯一可以加载到 32 位进程中的 64 位二进制文​​件。**

# css - 定位背景图片

> ID：10194372
> 
> 赞同：1
> 
> 时间：2012-04-17T15:39:27.420
> 
> 标签：css

我可能会问一些非常简单的问题，但我在这里挣扎。

我有垂直切成两块的图片。中间部分是 div 的背景，它应该始终位于页面的中心。另一块中间是透明的，两边都有图形。我希望侧面的图形根据屏幕分辨率隐藏/显示更多/更少，但始终位于中心，因此它始终与图案的中间部分相匹配。

这是我的基本CSS：

```
* { padding: 0; margin: 0; }

body {
 font-family: Arial, Helvetica, sans-serif;
 font-size: 13px;
 background: url(img/outerpic.png) no-repeat;
}
#wrapper { 
 margin: 0 auto;
 width: 1090px;
}
#content { 
 width: 1090px;
 background: url(img/innerpic.png) no-repeat;

} 
```

我已经用流体固定流体 css 和 3 张图片完成了 1 个版本，但我对此并不完全满意（无法将其居中）。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:46:56.727

不看任何 HTML 示例，我的建议是使用背景位置 CSS 属性。

[http://www.w3schools.com/cssref/pr_background-position.asp](http://www.w3schools.com/cssref/pr_background-position.asp)

# php - Symfony2 角色/组 - is_granted 没有检测到用户拥有的角色

> ID：10194373
> 
> 赞同：11
> 
> 时间：2012-04-17T15:39:28.597
> 
> 标签：php, symfony, twig

我遵循了 Symfony2 烹饪书 (http://symfony.com/doc/current/cookbook/security/entity_provider.html) 中的“如何从数据库（实体提供程序）加载安全用户”配方，除了我是不使用自定义实体提供程序 - 这意味着我的 User 类正在为角色使用延迟加载。

安全中的防火墙/访问控制一切正常。我有一些只有 ROLE_ADMIN 用户可以访问的路由和一些 ROLE_USER 用户可以访问的路由 - 这些工作正常。

问题是在我的基本模板中，我有一个显示如下的栏：

```
<p>Logged in as: {{ app.user.username }} {% if is_granted('ROLE_ADMIN') %}| <a href="{{ path('bassettprovidentia_skeleton_admindashboard') }}">Admin area</a> {% endif %}| <a href="#">Settings</a> | <a href="{{ path('bassettprovidentia_skeleton_logout') }}">Log out</a></p> 
```

即使我的用户在数据库中具有 ROLE_ADMIN 角色（并且可以访问仅限于该角色的 URL），“管理区域”链接也不会显示！

以同样的形式，我有这个：

```
<p>Roles: {% for role in app.user.roles %}{{ role.name }} [{{ role.role }}]{% if not loop.last %}, {% endif %}{% endfor %}</p> 
```

它工作正常！显示用户拥有的所有角色！

我究竟做错了什么？

延迟加载是罪魁祸首吗？

它不会在其他地方引起问题。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-18T06:14:31.320

好的 - 我找到了答案。我无法相信它是如此明显。

`app.user`当我请求它们时，从对象（即第二个片段）中获取的用户角色显然是从数据库中获取的。

该`is_granted()`调用显然使用会话来查看用户具有哪些角色。我一直在玩耍和更换角色，同时忘记注销并再次登录 - 难怪某些角色没有出现。

登录和退出并扮演不同的角色后，我可以确认一切正常。

如果我今天早上没有休息一下然后回来，我可能已经在圈子里追了几个小时了；那里有一个教训。

# templates - Sencha Touch：itemTpl循环？

> ID：10194381
> 
> 赞同：0
> 
> 时间：2012-04-17T15:40:01.893
> 
> 标签：templates, sencha-touch, sencha-touch-2

假设输入数据是 json，例如：

```
{   "facet_fields":{
        "cat":[
            "electronics",3,
            "card",2,
            "graphics",2,
            "music",1
        ]}} 
```

数组“cat”已恢复，应使用 for 循环显示。我被困在这一点上:)

到目前为止的代码：

```
Ext.define('Sandbox.view.FacetList', {
    extend: 'Ext.List',
    xtype: 'facet-list',

    config: {
        baseCls: 'article-list',
        itemTpl: '' +
            '<div class="article">' +
                '<tpl for="categories">' +
                      '<div>Item {#}</div>' +
                 '</tpl>' +
            '</div>'
    }

}); 
```

这输出：`Item 1 Item 2 Item 3 Item 4`

我想看到以下输出： `electronics (3), card (2), graphics (2), music (1)`

找不到正确的方法。谢谢你的时间:-) J。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T21:24:39.757

我假设您正在为您的数据使用模型和存储？如果是这样，我建议您使用字段中可用的[转换方法。](http://docs.sencha.com/touch/2-0/#!/api/Ext.data.Field-cfg-convert)它将允许您将该字段转换为可以理解`cat`的更好的数据。`tpl`

```
Ext.define('MyModel', {
    extend: 'Ext.data.Model',

    config: {
        fields: [
            {
                name: 'cat',
                convert: function(values, record) {
                    var data = [],
                        ln = values.length,
                        i, name, value;

                    // loop through each of the array values
                    for (i = 0; i < ln; i++) {
                        // if it is a name, save it
                        if (i % 2 == 0) {
                            name = values[i];
                        }

                        // if it is a value, save the value and push 
                        // to the data array
                        if (i % 2 == 1) {
                            value = values[i];

                            data.push({
                                name: name,
                                value: value
                            });
                        }
                    }

                    // return the data array for this field
                    return data;
                }
            },
            ...
        ]
    }
}); 
```

然后你可以`tpl`像这样使用它：

```
tpl: [
    '<tpl for="cat">',
        '{name}: {value}, '
    '</tpl>'
].join() 
```

# sql - 复杂的 SQL 连接

> ID：10194382
> 
> 赞同：5
> 
> 时间：2012-04-17T15:40:08.813
> 
> 标签：sql, sql-server, join

我正在尝试将两个表连接在一起，但有一个奇怪的要求。

通常我会加入该客户的记录并且代码匹配的位置

```
SELECT * 
    FROM DataTable d
    JOIN LookupTable l
        ON d.LookupCode = l.LookupCode
        AND d.Customer = l.Customer 
```

但是，我需要做的是加入查找表中的三行。匹配的 ID，以及基于另一列 (Order) 中的排序顺序的前后行（如果存在）。然后我需要对结果进行排序，首先匹配的记录，然后是之前的查找记录，然后是匹配记录之后的查找记录。

关于实现这一目标的最佳方法的任何想法？

例子：

```
Lookup:
Customer Code   Order
12345    A      1
12345    B      2
12345    C      3
12345    D      4
12345    E      5
22222    A      1
22222    B      2
22222    D      4
22222    E      5

Data:
Customer    Code
12345       B
12345       D
22222       B
22222       D

Result I need
Customer    Code
12345       B
12345       A
12345       C
12345       D
12345       C
12345       E
22222       B
22222       A
22222       D
22222       D
22222       B
22222       E 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:19:13.940

不是最有效或最优雅的，但它有效！

数据设置：

```
CREATE TABLE LookupTable (Customer int, Code nvarchar(1), OrderCol int)
CREATE TABLE DataTable (Customer int, Code nvarchar(1))

insert LookupTable  values (12345,'A',1),(12345,'B',2),(12345,'C',3),(12345,'D',4),(12345,'E',5),(22222,'A',1),(22222,'B',2),(22222,'D',4),(22222,'E',5)
insert DataTable values (12345,'B'),(12345,'D'),(22222,'B'),(22222,'D')

select * from LookupTable 
select * from DataTable 
```

查询：

```
;with LookupCte as (
    SELECT  *    
        ,   ROW_NUMBER() OVER (PARTITION BY Customer ORDER BY OrderCol ASC) AS LookUpOrder
    FROM    LookupTable
)
, DataCTE as (
    SELECT  dt.Customer
        ,   dt.Code
        ,   lu.LookUpOrder
        ,   (lu.LookUpOrder - 1) AS OrderColNVe
        ,   (lu.LookUpOrder + 1) AS OrderColPVe
        ,   ROW_NUMBER() OVER (PARTITION BY dt.Customer ORDER BY dt.Code ASC) AS DataCteRowNumber
    FROM    DataTable dt
    INNER JOIN LookupCte lu
        ON lu.Customer = dt.Customer
        AND lu.Code = dt.Code

)
, UnionCTE As (

    SELECT  d.Customer
        ,   d.Code
        ,   d.DataCteRowNumber
        ,   1 AS [CustomOrder]
    FROM  DataCTE d

    UNION ALL 

    SELECT  lt.Customer
        ,   lt.Code
        ,   d.DataCteRowNumber
        ,   2 AS [CustomOrder]
    FROM    DataCTE d 
    INNER JOIN LookupCte lt on lt.Customer = d.Customer
        AND lt.LookUpOrder = d.OrderColNVe

    UNION ALL

    SELECT  lt.Customer
        ,   lt.Code
        ,   d.DataCteRowNumber
        ,   3 AS [CustomOrder]
    FROM    DataCTE d 
    INNER JOIN LookupCte lt on lt.Customer = d.Customer
        AND lt.LookUpOrder = d.OrderColPVe
)
SELECT  u.Customer
    ,   u.Code
FROM    UnionCTE u
ORDER BY u.Customer, u.DataCteRowNumber, u.CustomOrder 
```

给出：

```
Customer    Code
----------- ----
12345       B
12345       A
12345       C
12345       D
12345       C
12345       E
22222       B
22222       A
22222       D
22222       D
22222       B
22222       E

(12 row(s) affected) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:21:28.257

编辑：如果订单字段中存在空白，请使用[row_Number()创建一个新列](http://msdn.microsoft.com/en-us/library/ms186734.aspx)

```
;with c as (
    Select d.Customer
       , d.code
       , l.order
    from Data as d
    inner join Lookup as l
    on d.customer = l.Customer
       and d.Code = l.Code
    )
    select
        c.Customer
          ,  C.Code 
    from c
    union all
    Select 
      , c.Customer
      , l.code
    from c
    inner join lookup as l
    on c.Customer = l.Customer
      and c.Order = l.Order + 1
    Select 
      , c.Customer
      , l.code
    from c
    inner join lookup as l
    on c.Customer = l.Customer
      and c.Order = l.Order - 1 
```

# c# - 使用RequiredFieldValidator quickfix 验证复选框列表

> ID：10194384
> 
> 赞同：0
> 
> 时间：2012-04-17T15:40:11.713
> 
> 标签：c#, .net, validation

我目前需要验证复选框列表是否是必填字段以及页面上的许多文本框。I am using the .net RequireFieldValidator to do so but when choosing control to validate the checkbox list is not in the list of available controls. 我没有大量的研究来纠正这个问题，而且我一直看到我需要将验证类扩展到自定义验证器控件。由于即将进行的网站重写，我正在从事的项目是丢弃工作。是否有更快的方法来进行相同的验证，仍然使用RequiredFieldValidator。

我目前正在更新一个边框为 0 且前景色设置为白色的文本框，因此它基本上是隐藏的而不会被隐藏，因为一旦隐藏文本框，验证器就不再适用于我的复选框列表的 SelectedIndex.ToString() 然后根据需要验证该文本框而不是复选框字符串。

这似乎是一种非常全面的方法，并且每次选中或取消选中复选框时都会导致回发，坦率地说，这是让它工作的完整技巧。

任何帮助都会很棒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:49:57.977

而不是将验证类扩展为自定义验证器控件。您可以使用 asp.net 自定义验证器控件 (asp:CustomValidator)。这个[链接](http://www.jensbits.com/2011/04/26/required-field-validator-for-checkbox-in-asp-net/)也许可以帮助你。

# php - substr() 到 EOL？

> ID：10194390
> 
> 赞同：0
> 
> 时间：2012-04-17T15:40:32.140
> 
> 标签：php, substr, eol

如何获取一行的全部内容？我有一个怀疑`substr()`不是答案。

```
Authors: Mr. Foo, Mr. Bar
Date: Jan 1, 1970
etc... 
```

在我的`$file_text`字符串中，我有类似于上面的内容。我正在寻找这样的东西：

```
$author_line = substr($file_text, 0, EOL); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:43:30.143

如果有帮助，获取文件内容[`file()`](http://php.net/file)会自动为您分割成几行。

否则，请尝试[`strstr($file_text,PHP_EOL,true)`](http://php.net/strstr)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T15:45:14.840

抓住每一行：

```
$eachLine = explode( PHP_EOL, $file_text ); 
```

然后你的正常子字符串将抓住一切。如果它像您的示例一样全部用冒号分隔，那么您可以展开以提取字符串中所有数据的 key => value 数组

```
// Grab each Line
$eachLine = explode( PHP_EOL, $file_text );
$data= array();

foreach($eachLine as $line) {

    $line = explode($line, ':');

    $data[trim($line[0])] = trim($line[1]);

} 
```

这将为您提供一个 key => value 数组中的所有数据`$data`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:43:58.777

尝试 ：

```
$lines = explode( PHP_EOL, $line_text ); 
```

然后循环遍历每一行：

```
foreach( $lines as $line ) 
{
    //do something
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T15:44:48.240

获取第一行（用您的选择替换行尾分隔符）：

```
$author_line = strtok($file_text, "\n"); 
```

选择：

```
list($author_line) = explode("\n", $file_text, 1); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T15:44:52.993

```
$author_line = substr($file_text, 0, strpos("\n")); 
```

这将抓取第一行的所有内容，不包括行尾。您必须考虑 Windows 上的 \r\n 与 Unix 上的 \n。

更正确的编码为：

```
$author_line = substr($file_text, 0, strpos(PHP_EOL)); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-17T15:45:17.260

```
$author_line = explode("\n", $file_text ); 
```

# compass-sass - 指南针找不到 Sprite 文件夹

> ID：10194396
> 
> 赞同：3
> 
> 时间：2012-04-17T15:41:00.717
> 
> 标签：compass-sass

出于某种原因，指南针找不到我为精灵设置的这个文件夹。这就是我的目录的样子。

```
Project
   media
      compass
         sass
            modules
               _module.scss
            style.scss
         config.rb
      images
         sprites
             button_hover.jpg
             button_active.jpg
             button.jpg 
```

在我的 config.rb 文件中，我将 images_dir 设置为 ../images。当我尝试 import ( `@import '../images/sprites/button*.jpg'`) _module.scss 中的文件时，我得到的错误主要是这样的：

```
File to import not found or unreadable: images/sprites/button*.jpg. 
```

不知道发生了什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-27T16:10:31.717

指南针精灵仅为 PNG。没有JPG afaik。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T11:21:03.080

好吧，如果**styles.scss**在*media/compass/sass*中并且**图像**在*media/*中，那么您需要做`../../`而不是`../`no ？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-31T02:03:04.353

*我在使用 png 文件*的 Windows 中遇到了 compass 0.12.2 这个问题，并通过编辑解决了这个问题`C:\Ruby193\lib\ruby\gems\1.9.1\gems\compass-0.12.2\lib\compass\sprite_importer.rb`

更改第 19 行：

```
-      Dir.glob(File.join(path, "**", glob))
+      Sass::Util.glob(File.join(path, "**", glob)) 
```

第 78 行：

```
-        files = Dir[File.join(folder, uri)].sort
+        files = Sass::Util.glob(File.join(folder, uri)).sort 
```

所有根据此来源： [https ://github.com/chriseppstein/compass/commit/58babac01b56eddf63bac737f7f781d98f00f6b9](https://github.com/chriseppstein/compass/commit/58babac01b56eddf63bac737f7f781d98f00f6b9)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-08T12:02:45.650

配置你的 config.rb。然后指南针会知道在哪里可以找到您的图像；）

罗盘似乎只适用于png。

# birt - 如何在Birt中将报表参数从一个报表传递到另一个报表

> ID：10194407
> 
> 赞同：0
> 
> 时间：2012-04-17T15:41:43.920
> 
> 标签：birt

我对 Birt 工具非常陌生，需要了解如何将报告参数从一个报告传递到另一个报告。在这种特殊情况下，我想传递“from date”和“to date”参数。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T19:45:33.963

在要使其可单击的字段或图表元素上创建一个超链接，作为对辅助报表的钻取。从那里您可以将超链接设置为“钻取”类型，并使用当前可用数据集上的数据或某些静态值设置任何参数。当您配置超链接的属性时，将自动读入目标报告支持的参数。

祝你好运！

# ruby - 红宝石::机械化::cookie_jar

> ID：10194416
> 
> 赞同：2
> 
> 时间：2012-04-17T15:42:20.667
> 
> 标签：ruby, cookies, mechanize, mechanize-ruby

我有一个网站可以进行四种不同的重定向，并且似乎并不总是传递 cookie。

因此，我在这里进行了研究并尝试了一些解决方案，例如：

创建一个临时 cookie_jar 并每次分配它。我还尝试像这样手动传递 cookie：

```
cookie = Mechanize::Cookie.new("TLSID",bot.cookie_jar.jar['.manageyourloans.com']    
["/"]["TLSID"].value)
cookie.domain = ".manageyourloans.com"
cookie.path = "/"
bot.cookie_jar.add(bot.history.last.uri,cookie)

cookie = Mechanize::Cookie.new("TLHID",bot.cookie_jar.jar['.manageyourloans.com']
["/"]["TLHID"].value)
cookie.domain = ".manageyourloans.com"
cookie.path = "/"
bot.cookie_jar.add(bot.history.last.uri,cookie) 
```

上面的问题是，如果它不需要通过，我会得到一个错误。
是否可以执行以下操作。似乎通过了 10-12 个不同的 cookie 值，每个页面都有一些（重定向）或其中一些。如何执行上述操作并手动传递 cookie，但如果该值不存在，则只需传递 null？

还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T01:04:18.540

过去，当 cookie 域看起来像：.domain.com 并且请求是针对 domain.com 时，我注意到某个版本的 mechanize 存在问题，cookie 不会被设置。

这可能不是处理它的最佳方法，但我当时的解决方案是猴子补丁机械化以去除 cookie 的域部分：

```
class Mechanize::Cookie
  class << self; alias_method :old_parse, :parse end
  def self.parse(uri, str, log = Mechanize.log, &block)
    str.gsub!(/domain[^;]*;/,'')
    old_parse(uri, str, log, &block)
  end
end 
```

# wordpress - 如何在 WordPress 中禁用小部件的缓存

> ID：10194418
> 
> 赞同：2
> 
> 时间：2012-04-17T15:42:24.060
> 
> 标签：wordpress, caching, widget

我有一个用于 WordPress 3.3.1 的自定义小部件，它加载了一些动态数据，但它被缓存并且更新不会显示在主站点上。

如何禁用小部件的缓存？

# visual-studio-2010 - 自动选择正确的 CodeAnalysis 规则集

> ID：10194419
> 
> 赞同：3
> 
> 时间：2012-04-17T15:42:31.807
> 
> 标签：visual-studio-2010, projects-and-solutions, code-analysis, tfsbuild, fxcop

我们有许多大型解决方案，并且有许多基于不同项目类型的规则集文件。例如我们有：

*   一个 Sharepoint 规则集，包含：

    *   微软所有规则
    *   MSOCAF 规则
    *   SPDisposeChecker 规则
    *   一些自定义规则
*   测试项目规则集

    *   微软所有规则
    *   禁用了一些命名准则规则（例如使用下划线）
    *   一些类似于 TypeMock TestLint 的测试特定规则
    *   一些自定义规则
*   标准规则集

    *   微软所有规则
    *   一些自定义规则

如果代码分析能够根据项目类型自动选择正确的集合，我会很高兴。

我还没有找到理想的方法来做到这一点。我会考虑的事情：

*   在构建服务器的 msbuild 文件夹中放置一个目标文件，该文件根据特定构建目标 (yuk) 的存在派生项目类型
*   在每个项目类型的每个目标文件中指定 CodeAnalayis 规则文件 (yuk)
*   创建一个自定义目标文件并将其包含在每个项目中，在每个项目中设置一个属性以选择正确的项目类型。（呸）
*   更改规则本身以了解它们是否在正确的上下文中（自定义规则可能，默认规则不可行）。

我们目前在做什么：

*   为每个项目手动指定规则集。

我很想听听更好的解决方案的想法......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:02:26.247

另一种方法是将代码分析目标文件或构建任务替换为允许您进行推理的版本。就我个人而言，我不会喜欢这个，因为拦截点对我的口味来说有点太隐蔽了，但是 ymmv ......

如果这是针对将由单个团队长期维护的产品，我可能会选择与您的第三个选项类似的东西。另一方面，如果这是一个代码库最终会转移到另一个团队（无论是内部还是外部）的项目，我会选择可以通过 Visual Studio UI 完成的事情。不幸的是，这意味着项目特定的规则集选择。唯一的好消息是，有一个 UI 允许对给定解决方案中的所有项目进行管理（可从分析...为解决方案配置代码分析菜单访问）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-22T15:08:59.717

我找到了适用于大多数项目类型的解决方案。Microsoft 提供的许多默认 Msbuild 目标都包含一个选项，可通过将相关目标放置在 Msbuild 文件夹结构中的特定文件夹中来加载 BeforeTargets 和 Aftertargets。

我将目标文件放入这些文件夹中（根据项目类型对它们的期望方式命名，这些往往因项目类型而异），我在其中指定默认 CodeAnalaysis.rules 文件。项目仍然可以覆盖这些，但如果没有，则使用默认值。

例如，Sharepoint 会查找此文件：

`$(MSBuildExtensionsPath)\Microsoft\VisualStudio\v10.0\SharePointTools\Custom.After.Microsoft.VisualStudio.SharePoint.targets`

这些引用存储在 msbuild 属性中，例如`$(CustomAfterSharePointTargets)`您可以根据需要扩展或覆盖这些属性。

我的解决方案是建立[在这个特性](http://my.safaribooksonline.com/9780735659827/solution_import_files?reader=html&imagepage=)和[这个特性](https://stackoverflow.com/questions/3924404/msbuild-custom-after-microsoft-common-targets-for-native-c-projects-in-vs2010)之上的。

I put in a request to standardize this more in Visual Studio 11\. [Please vote for it](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2793283-standardize-msbuild-wildcard-imports-for-before-af).

# java - 为什么同一个程序在Java中执行多次后响应时间变短了？

> ID：10194421
> 
> 赞同：0
> 
> 时间：2012-04-17T15:42:32.010
> 
> 标签：java, response-time

Java程序的响应时间在重复多次后会减少。原因是什么？下面的解释正确吗？：

> 总执行时间包括代码生成时间+垃圾收集时间+执行时间。同一个程序重复多次后，代码生成时间就不再是一个因素。

你能推荐一些关于它的参考资料给我吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:18:21.907

> 另一个问题是程序应该重复多少次？

在 HotSpot / OpenJDK 上默认为 10,000 次，请参阅`-XX:CompileThreshold=`选项

[http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html)

# php - 运行 PHP 文件时的 Cron 作业错误

> ID：10194424
> 
> 赞同：2
> 
> 时间：2012-04-17T15:42:41.993
> 
> 标签：php, cron, crontab

我正在尝试通过 cron 作业运行一个 php 文件，当我手动运行它时该文件工作正常，但是当我在 cron 作业中运行它时，我收到此错误：

```
Warning: include(classes/EmailAddressValidator.php): failed to open stream: No such file or directory in /var/www/onecent_dev/classes/MiscFunctions.php on line 3

Warning: include(): Failed opening 'classes/EmailAddressValidator.php' for inclusion (include_path='.:/usr/share/php:/usr/share/pear') in /var/www/onecent_dev/classes/MiscFunctions.php on line 3 
```

MiscFunctions.php 和 EmailAddressValidator.php 都是现有文件并且位于正确的位置，有什么用？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T15:46:36.347

看起来您的 include_path 正在解析。到任何 cron 碰巧将当前目录设置为，而不是脚本所在的目录。尝试先将您的 crontab 编辑为 cd：

```
0 * * * * cd /path/to/script && php script.php 
```

或明确提供 include_path：

```
0 * * * * php -d include_path=/path/to/script script.php 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:46:30.040

看到这个问题：[PHP：要求路径不适用于 cron 作业？](https://stackoverflow.com/questions/3118699/php-require-path-does-not-work-for-cron-job)

您的 include_path 不包含您正在执行的脚本的路径。

# phpexcel - PhpExcel 错误 - 在 Excel 中打开时内容不可读

> ID：10194431
> 
> 赞同：2
> 
> 时间：2012-04-17T15:43:13.257
> 
> 标签：phpexcel

我正在使用 FreeBSD 上的 PHPExcel 创建一个包含 UTF-8 编码数据的 Excel 报告。当我尝试在 Excel 中打开它时，出现以下错误：

“Excel 在 '' 中发现无法读取的内容，是否要恢复工作簿的内容？

当我单击“是”时，我得到以下恢复日志：

修复部分：/xl/styles.xml 部分带有 XML 错误。（样式）加载错误。第 2 行，第 467 列。已删除功能：/xl/styles.xml 部分（样式）中的字体已修复记录：/xl/styles.xml 部分（样式）中的格式

并且 Excel 工作表没有粗体显示。

任何帮助/参考将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T14:15:14.723

如果有人一直在努力解决这个问题，就像我过去 2 天那样，并且在这个或其他论坛中找不到任何线索，这就是我的问题所在。

这条线引起了所有的恶作剧：

```
$objPHPExcelNew->getActiveSheet()->getStyle('B4:H4')->getNumberFormat()->setFormatCode('#,#0_'); 
```

将其更改为：

```
$objPHPExcelNew->getActiveSheet()->getStyle('B4:H4')->getNumberFormat()->setFormatCode('#,#0_-'); 
```

注意到最后缺少的“减号”符号了吗？我没有。

# facebook - 您如何根据外部 Web 应用程序中的应用程序权限对用户进行身份验证？

> ID：10194433
> 
> 赞同：2
> 
> 时间：2012-04-17T15:43:16.680
> 
> 标签：facebook, oauth, authorization

我有一个应用程序允许您在 Facebook 中共享某些数据。您可以在我的应用程序中创建数据，然后使用我在 Facebook 应用程序中创建的 Facebook 自定义对象共享一些信息的“日志”。

当朋友点击我用户时间轴中的链接时，我会将他们重定向到显示日记的站点。该站点创建所有相关的 og 元标记等等。然后它根据从 Facebook 传回的 ID 从我的数据库中获取数据，并显示日记条目。只有那些在用户为我的应用程序定义的授权组内的人才能执行此操作。

我遇到的问题是 Facebook 身份验证是通过 JavaScript 在客户端处理的，而数据收集是在服务器端处理的。我意识到我可以从服务器调用身份验证，或者通过 AJAX 将令牌发送到服务器，但这两种方法看起来都有些 hacky。我正在寻找这种事情的模式，认为其他人以前做过。

# c# - 在最终提交之前显示表单数据（确认视图）

> ID：10194434
> 
> 赞同：-4
> 
> 时间：2012-04-17T15:43:18.797
> 
> 标签：c#, jquery, asp.net-mvc, asp.net-mvc-3

在提交数据之前，我需要让用户有机会查看他输入的内容并进行验证。当用户单击提交表单时，我想将表单中输入的所有数据显示到单独的页面中。当用户在该页面上单击验证时，数据将返回到最终提交数据的控制器。

我认为主要问题是如何将所有表单数据从一页移动到另一页。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:50:34.850

一种方法是创建一个新的控制器动作，例如“VerifySubmission”。提交表单应该发布到 YourController.VerifiySubmission()。VerifySubmission 视图显示数据以便用户查看，并将字段写为隐藏的表单字段。这个“验证”页面上有一个提交按钮，当用户单击它时，它会将隐藏的表单字段发布到您最终的“FormSubmit”控制器操作（无论您将其命名为什么），然后将其保存到数据库中。

编辑：另外，请更新你的问题的标题，这样它就可以说明你在问什么问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:59:55.767

您想要的是将表单发布到控制器。例如，如果您使用`Index`页面进行提交，您的控制器代码将如下所示

```
public ActionResult Index() 
{
    return View();
}

[HttpPost]
public ActionResult Verify(FormCollection form)
{
    ViewBag.FormItems = form;
    return View();
}

[HttpPost]
public ActionResult Accept(FormCollection form)
{
    // Do whatever you need to do to store the data
    return View();
} 
```

现在，如果您的用户正在提交模型中的信息，您将希望实际使用该模型代替`FormCollection`，并将您`View`的 s 设置为针对该模型进行强类型化（将其处理为强类型模型）。

诚然，将 设置`ViewBag`为仅存储`FormCollection`是一种懒惰的做事方式，但是在不知道您真正想要做什么的情况下，它可以工作。正如我所说，对输入数据使用模型会简化事情并使其更加健壮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T16:10:18.850

在输入数据-确认-最终提交页面之间传输数据的另一种方法是使用[TempData](http://msdn.microsoft.com/en-us/library/dd394711.aspx)，它允许您在 2 个请求之间保存状态（通常在 SessionState 中）。

# c# - 是否可以以这种方式重载方法？

> ID：10194436
> 
> 赞同：0
> 
> 时间：2012-04-17T15:43:23.233
> 
> 标签：c#, asp.net

我试图让人们使用他们的用户 ID（int）或他们的用户名（字符串）登录。我考虑这样做的方式是创建两个单独的方法，一个接受字符串，一个接受 int。但我无法让它工作，似乎可能有更好的解决方案。

```
public static string ForgotPassword ( string username )
{
    using ( var conn = new SqlConnection( GetConnectionString() ) )
    using ( var cmd = conn.CreateCommand() )
    {
        conn.Open();
        cmd.CommandText =
        @"SELECT 
             Password 
         FROM 
             Distributor
         WHERE 
             Username = @username";
        cmd.Parameters.AddWithValue( "@username", (string)username );
        using ( var reader = cmd.ExecuteReader() )
        {
            if ( !reader.Read() )
            {
                // no results found
                return null;
            }
            return reader.GetString( reader.GetOrdinal( "Password" ) );
        }
    }
}

public static string ForgotPassword ( int username )
{
    using ( var conn = new SqlConnection( GetConnectionString() ) )
    using ( var cmd = conn.CreateCommand() )
    {
        conn.Open();
        cmd.CommandText =
        @"SELECT 
             Password 
         FROM 
             Distributor
         WHERE 
             DistributorID= @username";
        cmd.Parameters.AddWithValue( "@username", (int)username );
        using ( var reader = cmd.ExecuteReader() )
        {
            if ( !reader.Read() )
            {
                // no results found
                return null;
            }
            return reader.GetString( reader.GetOrdinal( "Password" ) );
        }
    }
} 
```

允许他们使用 user_id 或用户名登录的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:45:48.660

在您的第一种方法中，我会从该用户名中获取 userId，然后将其传递给第二种方法。

如果用户名与 UserID 不匹配，则以与 UserID 不存在时相同的方式返回错误。

```
public static string ForgotPassword ( string username )
{
    int userid = //Get userid from username
    return ForgotPassword(userid);
}

public static string ForgotPassword ( int username )
{
    using ( var conn = new SqlConnection( GetConnectionString() ) )
    using ( var cmd = conn.CreateCommand() )
    {
        conn.Open();
        cmd.CommandText =
        @"SELECT 
             Password 
         FROM 
             Distributor
         WHERE 
             DistributorID= @username";
        cmd.Parameters.AddWithValue( "@username", (int)username );
        using ( var reader = cmd.ExecuteReader() )
        {
            if ( !reader.Read() )
            {
                // no results found
                return null;
            }
            return reader.GetString( reader.GetOrdinal( "Password" ) );
        }
    }
} 
```

# jquery - jQuery 和 JSONP 问题

> ID：10194439
> 
> 赞同：0
> 
> 时间：2012-04-17T15:43:42.650
> 
> 标签：jquery, jsonp

我正在尝试发出以下 jQuery AJAX JSONP 请求：

```
$.ajax({
    type: "GET",
    url: apiUrl + currentType + "/" + $(this).val() + "/" + nextType + ".json?jsoncallback=?",
    dataType: "jsonp",
    success: function (data) {
        console.log(jQuery.parseJSON(data))
    },
    error: function (reqObj, textStatus, error) {
        console.log(textStatus, error)
    }
}); 
```

成功函数永远不会运行，这是该`error`函数记录的数据：

```
parsererror, message: "jQuery17205679343591909856_1334681898332 was not called" 
```

我不知道为什么这不起作用...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:15:24.107

因此，经过一些配置更改（在 API 端），我能够找出我的问题。

首先，为了在 API 端快速生成 JSON 响应，我使用了 Rails 的 RABL gem。我在应用程序的初始化程序中包含了配置示例（https://github.com/nesquena/rabl）。*来自 Github：*

> 如果 include_json_root 被禁用，则删除输出中每个子节点的根节点，如果传入请求具有“回调”参数，则 enable_json_callbacks 启用对“jsonp”样式回调输出的支持。

然后，这是我的 jQuery（在客户端消费者端）：

```
$.ajax({
            url: apiUrl + currentType + "/" + $(this).val() + "/" + nextType + ".json",
            dataType: 'jsonp',
            type: "GET",
            success: function(data) {
                console.log(data);
                console.log('Success!');
            }
        }); 
```

# java - Java 查找数组中的元素

> ID：10194441
> 
> 赞同：0
> 
> 时间：2012-04-17T15:43:45.160
> 
> 标签：java

我有五个数组来存储传入的 int 数字，例如：

```
int array1 = {1,6,..}
int array2 = {2,7,..}
.
.
int array5 = {5,10,..} 
```

现在，我要做的是在另一个数组中搜索下一个数字。

像，

```
for(i = 0, i < array1.size ; i++){

int element = array1[0] ;

//here array2, array3, ..., array5 can have different size
search for array2 to find element+1
search for array3 to find element+2
.
.
search for array5 to find element+5
} 
```

我现在正在做的是：

```
Run for loop for 0 to array2 size, to find element+1 (so for others) 
```

但是，它很慢。谁能给我一些想法，如何让它更快（我也可以将数组更改为任何其他数据结构）。

对不起，我在问的时候犯了两个错误，我应该提一下：

```
1) Arrays are sorted (incremental elements always).
2) Array elements are very few (2-3) so Binary Search will be expensive.
3) I have to perform the search for thousand times means when channel input pause, I have to perform search, then again channel start and I have to perform search ... so on. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:47:03.503

如果数组已排序，请使用二进制搜索来查找元素，而不是为每个元素循环遍历它。

# php - mysqli_query() 总是返回 true

> ID：10194442
> 
> 赞同：3
> 
> 时间：2012-04-17T15:43:51.487
> 
> 标签：php, mysql, mysqli

这是我的表格：

```
<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <form action="register_ajax.php" method="get">
    <input type="text" name="email">
    <input type="submit" value="test">
    </form>
  </body>
</html> 
```

这是我的 php 代码：

```
<?php
    $dbc = mysqli_connect("localhost","root","*******","continental_tourism") OR die(mysqli_connect_error());
    $email = $_GET['email'];
    $query = "SELECT email FROM customer_info WHERE email = '$email' ";
    $r = mysqli_query($dbc, $query) OR die(mysqli_error($dbc));
    if($r)
        echo "Email address exists!";
    else
        echo "sss";
?> 
```

如果我输入正确的（数据库上的现有电子邮件）`$r`为真。但如果我输入不存在的电子邮件，那么也是`$r`如此。这是为什么？基本上我想检测空集。我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-17T15:45:17.963

`$r`只有在出现 SQL 错误时才会为假。否则它将始终返回一个对象，即使您的 SELECT 语句没有返回任何行。

用于[`mysqli_num_rows()`](http://us.php.net/manual/en/mysqli-result.num-rows.php)计算返回的行数。零表示没有人使用该电子邮件地址。

```
if(mysqli_num_rows($r))
    echo "Email address exists!";
else
    echo "sss"; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T15:47:17.457

`mysqli_query()`*如果查询成功*，将始终返回 MySQLi 结果资源。`TRUE`当作为布尔值测试时，资源将始终评估为。

成功的查询不一定是返回结果的查询，它只是一个没有失败的查询。当出现错误时，查询被视为失败，例如 MySQL 服务器中的语法错误或处理错误 - 在这种情况下，它们将返回`FALSE`. 但是没有找到结果的查询仍然是一个成功的查询。

您需要使用[`mysqli_num_rows()`](http://php.net/manual/en/mysqli-result.num-rows.php)来确定查询是否找到任何结果：

```
<?php
    $dbc = mysqli_connect("localhost","root","longhorn","continental_tourism") OR die(mysqli_connect_error());

    $email = $_GET['email'];

    $query = "SELECT email FROM customer_info WHERE email = '$email' ";

    $r = mysqli_query($dbc, $query) OR die(mysqli_error($dbc));

    if(mysqli_num_rows($r) > 0)
        echo "Email address exists!";
    else
        echo "sss"; 
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:48:54.953

[`mysqli_query`](http://php.net/manual/en/mysqli.query.php)`false`将在成功和失败时返回结果对象。未选择任何行不被视为失败。您可以使用[`mysqli_num_rows`](http://php.net/manual/en/mysqli-result.num-rows.php)来检查返回的行数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-08T10:47:56.647

需要测试是否`$r`为真，以及行数是否大于 0。

以下作品：

```
if ($r and mysqli_num_rows($r) > 0) {

  echo "rows exist"; } else {

echo "rows don't exist";  } 
```

# python - 如何在 python 中创建空的 c 类型数组（或只有一个 NULL 值）？

> ID：10194446
> 
> 赞同：2
> 
> 时间：2012-04-17T15:44:01.937
> 
> 标签：python, c, opengl

我想知道是否（以及如何）可以在 python 中创建空的 c 类型数组。如果我想用零初始化一个数组，以下代码可以正常工作：

```
from ctypes import *
data = [0 for i in xrange(10)]
a = ((c_float *10))(*data) 
```

但是，如果数据是`None`值列表，我会收到一条错误消息：

```
data = [None for i in xrange(10)]
a = ((c_float *10))(*data)

TypeError:  float expected instead of NoneType instance 
```

有没有办法用 NONE 或 NULL 初始化和排列？

**编辑 1：** 我想要一个带有 None / Null 的数组的原因是我想将此数组上传到 GPU。如果我用零初始化我的数组，那么将呈现零。但是，如果我将其初始化为 NULL（如 c 中所定义），则不会呈现任何内容。

**编辑2：** 使用的原因`c_float`是我需要将我的数据转换`c_float`为它才能与opengl兼容。

**编辑 3：** 如果`data`由零组成，那么以下代码将在位置 0 / 0 处为我呈现一堆点。我希望将`NULL`值发送到 GPU 不会导致任何点被呈现。

```
glBindBuffer(GL_ARRAY_BUFFER, vbo)    
glBufferSubData(GL_ARRAY_BUFFER, 0, sizeof(data), data)
glVertexPointer(n_COORDINATES_PER_VERTEX, GL_FLOAT, 0, 0)
glDrawArrays(GL_LINE_STRIP, 0, len(data)) 
```

**编辑 4：** 您可能想`NULL`在 python 中使用的另一个用例：根据[opengl 网站](http://www.opengl.org/wiki/Vertex_Buffer_Object)，以下是如何在 GPU 上分配内存：

```
glBufferData(GL_ARRAY_BUFFER, SizeInBytes, NULL, GL_STATIC_DRAW) 
```

如果我在我的 python 代码中执行此操作，我会收到以下错误：`NameError: global name 'NULL' is not defined`

但必须有办法在 python 中做到这一点，对吧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:49:54.283

A`c_float`没有等效的“无”值，因此您不能存储`None`在 a 中`c_float`。

请参阅[python`ctypes`文档](http://docs.python.org/library/ctypes.html#fundamental-data-types)中的表格- 有一些类型支持`None`- 但没有一个支持浮点数和`None`.

您将不得不使用替代数据类型，`None`以某种方式分别记录值，或者找到一种表示`None`为适用于您的应用程序的浮点数的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:50:59.640

c_float 有空值是什么意思？在 C 中 null 为零，所以基本上你想要一个零数组，你可以通过转换无数组来做到这一点，例如

```
from ctypes import *
data = [None for i in xrange(10)]
# convert to zeroes
data = [i or 0 for i in data]
a = ((c_float *10))(*data) 
```

编辑：如果值为None，看起来你不想绘制任何东西，在这种情况下，没有办法让c_floats'nothing'因为NULL是0，最好的方法是将数组设置为NULL而不使用绘制任何东西`if`（健康）状况

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T03:33:50.820

你想通过 ctypes 传递一个 NULL 数组指针吗？用于`None`NULL。你不能有一个 NULL 浮点值，但你可以有一个 NULL 浮点数组指针。

就像@Anurag 说的那样，如果您不想绘制任何东西，请不要调用该函数进行绘制。

# email - PDF 附件正在更改为无法使用的 DAT 文件

> ID：10194447
> 
> 赞同：7
> 
> 时间：2012-04-17T15:44:08.303
> 
> 标签：email, pdf

我有一个系统，它是一个内部解决方案，试图通过电子邮件将发票发送给客户。这个系统工作得很好，除了一个客户得到 .dat 文件，而不是其他人得到的生成良好的 .pdf 文件。

我已经研究过这个问题，很多事情都指向 Outlook 发送电子邮件（不使用 Outlook）和拆分文件的问题，因为它太大了（不是，我们可以手动发送电子邮件。）

这些文件被重命名为“=_utf-8_B_Q29uc29saWRhdGVkIEludm9pY2VzIGZv.dat”而不是“1180426.pdf”。

在两个文件的标题之后只是对我没有任何意义的字符行。

.dat 文件的标题：file1

```
 =?utf-8?B?Y2lCQmJIQm9ZU0JKYm5OMWJHRjBhVzl1Pz0NCiA9P3V0Zi04P0I/SUNZ?=\
\

 =?utf-8?B?Z1YyRjBaWEp3Y205dlptbHVaeUF0SUVGc2NHaGhJRWx1YzNWc1lYUnBi?=\
\

 =?utf-8?B?MjRnSmlCWFlYUmw/PQ0KID0/dXRmLTg/Qj9jbkJ5YjI5bWFXNW5JT0tB?=\
\

 =?utf-8?B?a3lCVmJtbDJaWEp6WVd3Z1EybDBlU3dnS0RJd01USXRNRFF0TVRNcD89?=\
\
 =?utf-8?B?DQogPT91dGYtOD9CP0xuQmtaZz09Pz0=?="
Content-Transfer-Encoding: base64
Content-Disposition: attachment 
```

文件2

```
 =?utf-8?B?YUdFZ1NXNXpkV3hoZEdsdmJpQW1JRmRoPz0NCiA9P3V0Zi04P0I/ZEdW?=\
\

 =?utf-8?B?eWNISnZiMlpwYm1jZ0xTQkJiSEJvWVNCSmJuTjFiR0YwYVc5dUlDWWdW?=\
\

 =?utf-8?B?MkYwWlhKd2NtOXY/PQ0KID0/dXRmLTg/Qj9abWx1WnlEaWdKTWdWVzVw?=\
\

 =?utf-8?B?ZG1WeWMyRnNJRU5wZEhrc0lDZ3lNREV5TFRBMExURXpLUzV3WkdZPT89?=\
\
 =?utf-8?B??="
Content-Transfer-Encoding: base64
Content-Disposition: attachment 
```

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T17:53:32.300

从评论：

在文件名中打印了一个奇怪的 Unicode 字符而不是连字符：“...防水 - 环球城，...”。可能是某人的邮件服务器对非 ASCII 字符敏感，因此将其编码为 base64。将其更改为常规的 ASCII 连字符，应该没问题。

* * *

我是如何找到它的：

首先，这是我使用的在线 base64 解码器：[http ://www.opinionatedgeek.com/dotnet/tools/base64decode/](http://www.opinionatedgeek.com/dotnet/tools/base64decode/)

其次，我首先从标头连接所有 base64 字符串。它分为多个段：对于第一个标头，有 5 个段。段是问号之间的长部分。把它们放在一起，你会得到：

```
Y2lCQmJIQm9ZU0JKYm5OMWJHRjBhVzl1Pz0NCiA9P3V0Zi04P0I/SUNZ
Z1YyRjBaWEp3Y205dlptbHVaeUF0SUVGc2NHaGhJRWx1YzNWc1lYUnBi
MjRnSmlCWFlYUmw/PQ0KID0/dXRmLTg/Qj9jbkJ5YjI5bWFXNW5JT0tB
a3lCVmJtbDJaWEp6WVd3Z1EybDBlU3dnS0RJd01USXRNRFF0TVRNcD89
DQogPT91dGYtOD9CP0xuQmtaZz09Pz0= 
```

将其放入解码器会给出：

```
ciBBbHBoYSBJbnN1bGF0aW9u?=
=?utf-8?B?ICYgV2F0ZXJwcm9vZmluZyAtIEFscGhhIEluc3VsYXRpb24gJiBXYXRl?=
=?utf-8?B?cnByb29maW5nIOKAkyBVbml2ZXJzYWwgQ2l0eSwgKDIwMTItMDQtMTMp?=
=?utf-8?B?LnBkZg==?= 
```

另一组 base64 段。第一段看起来像是被切断了，所以我假设文件名中的内容实际上是它的一部分。所以我在前面加上它并得到：

```
Q29uc29saWRhdGVkIEludm9pY2VzIGZvciBBbHBoYSBJbnN1bGF0aW9u
ICYgV2F0ZXJwcm9vZmluZyAtIEFscGhhIEluc3VsYXRpb24gJiBXYXRl
cnByb29maW5nIOKAkyBVbml2ZXJzYWwgQ2l0eSwgKDIwMTItMDQtMTMp
LnBkZg== 
```

由于非ASCII字符，将*其*放入解码器将使其吐出一个 .bin 文件。bin 文件包含 PDF 的完整文件名。

在十六进制编辑器中打开 bin 文件：

```
43 6F 6E 73 6F 6C 69 64 61 74 65 64 20 49 6E 76   Consolidated Inv
6F 69 63 65 73 20 66 6F 72 20 41 6C 70 68 61 20   oices for **** 
49 6E 73 75 6C 61 74 69 6F 6E 20 26 20 57 61 74   ********** & ***
65 72 70 72 6F 6F 66 69 6E 67 20 2D 20 41 6C 70   ********** - ***
68 61 20 49 6E 73 75 6C 61 74 69 6F 6E 20 26 20   ** ********** & 
57 61 74 65 72 70 72 6F 6F 66 69 6E 67 20 E2 80   ************* â€
93 20 55 6E 69 76 65 72 73 61 6C 20 43 69 74 79   “ ********* ****
2C 20 28 32 30 31 32 2D 30 34 2D 31 33 29 2E 70   , (2012-04-13).p
64 66                                             df 
```

破折号像拇指一样突出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T08:42:28.747

我认为@Jeff E 做对了：文件名中有一个非 ASCII 字符，这会导致一端或另一端出现问题。当您手动通过电子邮件发送文件时，我的猜测是邮件客户端将 em-dash 替换为常规连字符或其他字符（例如_）。如果您将“防水 - 环球城”中的破折号更改为“-”，我认为这应该可以。

（如果是这样，代表应该去找 Jeff，因为他发现了 unicode。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T21:04:07.353

当您的系统将 PDF 附加到电子邮件消息时，您是否设置了 MIME 类型？如果是这样，你在用什么？这是在黑暗中的一个镜头，但您的系统可能没有正确使用应用程序/pdf，并且所涉及的邮件服务器和客户端的某些组合变得混乱并通过将其更改为 .dat 来响应。

# save - 如何保存特征然后通过文件中的数据绘制它们？开放层

> ID：10194450
> 
> 赞同：1
> 
> 时间：2012-04-17T15:44:11.947
> 
> 标签：save, draw, openlayers

我需要将绘制的特征保存到文件中，然后通过组合或其他方式让用户加载这些特定特征。

到目前为止，我从我的功能中获得了以下代码，例如：

```
 {"type":"Feature","id":"OpenLayers.Feature.Vector_250","properties":{},"geometry": 
    {"type":"Polygon","coordinates":[[[99200,105250],[99800,99750],[103050,102600],[99200,105250]]]},"crs":
    {"type":"EPSG","properties":{"code":221951}}}

    {"type":"Feature","id":"OpenLayers.Feature.Vector_256","properties":{},"geometry":
    {"type":"Point","coordinates":[97500,102100]},"crs":{"type":"EPSG","properties":{"code":221951}}}

    {"type":"Feature","id":"OpenLayers.Feature.Vector_278","properties":{},"geometry":
    {"type":"LineString","coordinates":[[97900,104350],[98450,100550]]},"crs":{"type":"EPSG","properties":
    {"code":221951}}} 
```

这些是多边形，点和线。现在我想根据这些数据，在用户想要的任何时候重绘它们。文件管理不是问题，我只需要知道如何让这些人再次出现在地图上。

我看到这个人做了类似的事情，[http](http://thinkwhere.wordpress.com/2011/06/26/geocommons-geojson-in-openlayers/) ://thinkwhere.wordpress.com/2011/06/26/geocommons-geojson-in-openlayers/ ，但他使用了一个功能集......这可能是一种可能性。 ..

任何帮助将不胜感激！谢谢！

# iphone - SegmentedControl 的 setEnabled 调用 iOS 4 中的其他方法

> ID：10194452
> 
> 赞同：0
> 
> 时间：2012-04-17T15:44:21.477
> 
> 标签：iphone, ios4, uisegmentedcontrol

我正在准备我的应用程序与 iOS 4 兼容并遇到问题，由于某种奇怪的原因，启用我的 segmentedControl 的 0 索引会导致代码调用 openDatabase 方法和 closeDatabase 方法。我一直在调试整个代码，发现只要启用了segmentedControl，就会调用这两个方法。

这里是日志的摘录：

```
> 2012-04-17 17:20:59.294 Abiliator[27897:11003] viewWillAppear - before database open
2012-04-17 17:20:59.296 Abiliator[27897:11003] OpenDatabase
2012-04-17 17:20:59.297 Abiliator[27897:11003] viewWillAppear - loadAppSettings
2012-04-17 17:20:59.311 Abiliator[27897:11003] viewWillAppear - getCurrentLearningSubject
2012-04-17 17:20:59.340 Abiliator[27897:11003] viewWillAppear - switchLearningBoxControl
2012-04-17 17:20:59.341 Abiliator[27897:11003] Inside switchLearningBoxControl
**2012-04-17 17:20:59.394 Abiliator[27897:11003] OpenDatabase
2012-04-17 17:21:00.566 Abiliator[27897:11003] CloseDatabase**
2012-04-17 17:21:00.567 Abiliator[27897:11003] Method abiliatorViewController - Function switchLearningBoxControl: Error preparing the statement 'library routine called out of sequence'.
2012-04-17 17:21:00.568 Abiliator[27897:11003] Method abiliatorViewController - Function switchLearningBoxControl: Error preparing the statement 'library routine called out of sequence'.
2012-04-17 17:21:00.569 Abiliator[27897:11003] Method abiliatorViewController - Function switchLearningBoxControl: Error preparing the statement 'library routine called out of sequence'.
2012-04-17 17:21:00.570 Abiliator[27897:11003] Method abiliatorViewController - Function switchLearningBoxControl: Error preparing the statement 'library routine called out of sequence'.
2012-04-17 17:21:00.570 Abiliator[27897:11003] Finished switchLearningBoxControl
2012-04-17 17:21:00.571 Abiliator[27897:11003] viewWillAppear - getQuestionFromDB
2012-04-17 17:21:00.572 Abiliator[27897:11003] CloseDatabase
2012-04-17 17:21:00.572 Abiliator[27897:11003] Failed to close the database with message 'library routine called out of sequence'. 
```

您会看到两个后续的打开和关闭数据库方法调用。然而，我的代码没有明确调用这些，但是一些“幽灵”进程正在执行那部分代码。

相同的代码在 iOS 5 上运行得很好，完全没有问题，无论是在模拟器中还是在设备上。

任何想法，可能是什么问题？谢谢。

```
- (void) switchLearningBoxControl:(NSString *) mySubjectID {
const char *sql = "select count (*) from ABILIATOR_CARD where learningbox = ? and subject_id = ?";
for (NSInteger mySegment=0;mySegment < 5;mySegment++) {
    sqlite3_stmt *selectstmt;

    if(sqlite3_prepare_v2(database, sql, -1, &selectstmt, NULL) == SQLITE_OK) {
        sqlite3_bind_int(selectstmt, 1, mySegment+1);
        sqlite3_bind_text(selectstmt, 2, [mySubjectID UTF8String], -1, SQLITE_TRANSIENT);
        if (sqlite3_step(selectstmt) == SQLITE_ROW) {
            int count = sqlite3_column_int(selectstmt, 0);
            if (count < 1) {
                [self.learningBoxControl setEnabled:NO forSegmentAtIndex:mySegment];
            }
            else {
                [self.learningBoxControl setEnabled:YES forSegmentAtIndex:mySegment];
            }
        }
        else {
            [self.learningBoxControl setEnabled:NO forSegmentAtIndex:mySegment];
        }

    }
    else {
        NSLog(@"Method abiliatorViewController - Function switchLearningBoxControl: Error preparing the statement '%s'.", sqlite3_errmsg(database));
    }
    sqlite3_finalize(selectstmt);   
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T10:01:57.127

在 iOS 4 setEnabled 调用 IBAction，iOS 5 没有。我在那个 IBAction 中有另一个打开，这当然会使应用程序感到困惑 :-) 不知道这种变化，因为我已经阅读了文档并且没有看到 4 到 5 之间的任何此类变化。

# r - R 使用 ifelse 更改因子值

> ID：10194454
> 
> 赞同：3
> 
> 时间：2012-04-17T15:44:23.887
> 
> 标签：r, if-statement

我有一列是因子变量。我需要更改因子是某个很少出现的水平的所有单元格的值。我正在使用以下代码，但它似乎不起作用：

```
test2$timeFactor <- ifelse(test2$timeFactor == '94', '-1000', test2$timeFactor) 
```

我也试过：

```
test2$timeFactor <- factor(ifelse(test2$timeFactor == '94', '-1000', test2$timeFactor)) 
```

但似乎都不起作用。我在这里遗漏了什么明显的东西吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-17T15:52:41.653

你最好改变`levels`：

```
set.seed(1)
x <- factor(sample(letters[1:3],10,replace=T))
x
 [1] a b b c a c c b b a
Levels: a b c

levels(x)[which(levels(x)=="c")] <- "z"
x
 [1] a b b z a z z b b a
Levels: a b z 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:48:00.470

这行得通吗？

```
test2 <- transform(test2,  timeFactor = ifelse(timeFactor == '94', '-1000', timeFactor) ) 
```

# sql - 从一个数据库表中获取数据到另一个数据库表

> ID：10194455
> 
> 赞同：3
> 
> 时间：2012-04-17T15:44:27.453
> 
> 标签：sql, sql-server-2008, sql-server-2008-express

我使用导入/导出向导将数据从 MS-Access 导入 SQL 数据库。现在，我有一个名为

TestDatabase - 有一个名为 AccessTable 的表 - 它有 10 列。

在同一个 SQL Server 上，我有另一个名为 SampleDatabase 的数据库和一个名为 SampleTable 的表

我想将 [TESTDATABASE].[dbo].[AccessTable] 复制到 [SampleDatabase].[dbo].[SampleTable]

该表的结构略有不同。前两列不匹配，但其余列匹配，我只想复制那些匹配的列。

如何做到这一点？

简而言之：我希望将第一个数据库中的 1000 行插入到第二个数据库表中。

我暂时使用的是 SQL Server 2008 express。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T15:49:45.367

您可以运行此查询：

```
INSERT INTO [SampleDatabase].[dbo].[SampleTable] (
    field1, field2, field3, field4
)
SELECT field1, field2, field3, field4
FROM [TESTDATABASE].[dbo].[AccessTable]; 
```

# javascript - JavaScript 循环等待某个函数返回然后执行下一个循环

> ID：10194460
> 
> 赞同：1
> 
> 时间：2012-04-17T15:44:35.097
> 
> 标签：javascript, loops, asynchronous, callback

我使用下面的代码等待，然后执行下一个循环：

```
function loop()
{
    setTimeout(function()
    {
        process_number(a[i]);
        i++;
        if (i < a.length)
            loop();
        else
        {
            alert("done!");
        }
    }, 5000);
} 
```

我想更改为在 get complete 时执行的 jQuery $.get 回调函数。

```
$.get("test.cgi", { name: "John", time: "2pm" },
  function(data){
  alert("Data Loaded: " + data);
});

function loop()
{
    //where process_number executed complete, do next loop
    //process_number(a[i]);
    i++;
    if (i < a.length)
        loop();
    else
    {
        alert("done!");
    }
} 
```

函数 process_number 执行时间不确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:51:52.980

您可以向 loop() 函数添加回调参数并在需要时执行它：

```
function loop(callback)
{
    //where process_number executed complete, do next loop
    //process_number(a[i]);

    if (callback) {
        callback();
    }
}

loop(function () {
    alert("continuing...");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:53:45.710

基本上，您可以将函数名称作为参数传递，然后通过参数名称调用它，这与匿名函数一样有效：

```
function foo(x,callback)
{
    callback(x);
}

foo("hello",alert)
foo("hello",function(x){alert(x);}); 
```

# java - 使用泛型实现类

> ID：10194462
> 
> 赞同：0
> 
> 时间：2012-04-17T15:44:36.447
> 
> 标签：java, generics

我对我正在处理的实现有点困惑。这是我想调用的方法

`<I, O, T> T post(String url, I data, ContentBuilder<I, HttpEntity> contentBuilder, ResponseHandler<? extends T> responseHandler);`

现在我必须编写几个用于 ContentBuilder 和 responsehandler 的类。需要注意的是返回类型*T*。

我写了一个抽象类`WSResponse`，然后扩展它`MyWSResponse`，使我的响应处理程序看起来像

`ResponseHandler <WSResponse> rh = new MyWSResponse();`

调用此**post**方法的方法具有此签名

```
public interface GPCl{
   public <T> T callPost (String data)
} 
```

...

```
public <T> T callPost(String data){
    HttpWebServiceClient client = getHttpWSClient();
    ContentBuilder<String, HttpEntity> contentBuilder = new MyXMLBuilder();
    ResponseHandler<WSResponse> rh= new MyWSResponse();

    WSResponse wsResponse = client.post("", data, contentBuilder, rh);
    return (T)wsResponse;
} 
```

现在我对这个方法的**返回**类型感到困惑。它会保持**T**还是其他？如果我将它从 T 更改为 WSRespons，我会收到一个我尚未实现方法的错误`callPost`。

该方法`callPost`被称为

```
GPClient cl = new GPClient(myhttpParams);
cl.callPost(d) 
```

PS：这是我第一次处理泛型

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:17:30.627

这种类型的方法`<T> T method(things that don't mention T)`——几乎从来都不是你想要做的，而且非常危险，因为它们不可避免地涉及到可能不起作用的强制转换——但在运行时失败之前你不会被警告。我*怀疑*这个方法的返回类型应该只是`WSResponse`，但你的问题不够清楚，我无法确定。

# javascript - Javascript dd/mm/yyyy 日期检查？

> ID：10194464
> 
> 赞同：5
> 
> 时间：2012-04-17T15:44:39.253
> 
> 标签：javascript, html, validation

我有一个 html 表单字段，人们可以在其中输入这样编码的日期：

```
input type="text" name="dateofbirth" placeholder="dd/mm/yyyy" 
```

我正在尝试找到一个 JavaScript 来检查日期是否以`dd/mm/yyyy`格式输入（所以 10 个字符，2/2/4）

任何意见将不胜感激。只是第一次做 javascript 并且一直做得很好，直到这次打嗝。

编辑：代码（表单名称为“注册”）

```
// JavaScript Document
function validateForm(signup) {
  {
    var x = document.forms["signup"]["dateofbirth"].value;
    var reg = /(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d/;
    if (x.match(reg)) {
      return true;
    }
    else {
      alert("Please enter dd/mm/yyyy");
      return false;
    }           
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T15:57:50.860

您可以使用正则表达式通过 javascript 以您提供的格式验证日期。示例代码如下所示。

```
function(input){
  var reg = /(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d/;
  if (input.match(reg)) {
    alert("Input matched");
  else {
    alert("Please enter dd/mm/yyyy");
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:53:16.893

你看过 Moment.js 的 JavaScript 库吗？

[http://momentjs.com/](http://momentjs.com/)

我没有使用它，但我计划将我的 Javascript 代码迁移到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T16:17:13.850

我发现的最好的 JavaScript 日期库是[http://code.google.com/p/datejs/上的 date.js](http://code.google.com/p/datejs/)

它也具有文化意识，因此要验证您的 dd/mm/yyyy 日期（我假设您不在美国），请使用 Date.parse 如下

```
var d1 = Date.parse("01/12/2004"); // returns a valid JavaScript date
var d2 = Date.parse("30/02/2004"); // returns null 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T15:49:35.367

查看[正则表达式的 MDN 指南](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)。您将需要有关与数字匹配的字符类的信息 - 搜索“匹配数字字符”短语；以及一种指定精确匹配长度的方法 - 在本指南中搜索“匹配前一个字符的 n 次出现”短语。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T16:24:42.987

您是否查看了 Web 浏览器的错误控制台以确保没有引发 JS 语法或运行时错误？您附加到问题的 JavaScript 代码~~并不~~令人惊讶（您有一个额外的`{`并`}`包装了您的函数体）。

提示：当使用正则表达式来测试字符串的有效性时，您应该使用`if (regex.test(str))`而不是`if (str.match(regex))`为了简单、性能和自文档。

鉴于您的要求，我会这样做：

```
function isDDMMYYYY(str){
  return /^\d{2}/\d{2}/\d{4}$/.test(str);
} 
```

但是，我个人会更改要求以允许用户输入一位数的日期和月份：

```
return /^\d{1,2}/\d{1,2}/\d{4}$/.test(str); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-14T20:48:47.657

验证日期包括所有角色，例如 2 月 28 日和 leep 年 29 日

```
function leapYear(year) {
    return ((year % 4 == 0) && (year % 100 != 0)) || (year % 400 == 0);
}

function validateDayMonth(day, month, year) {
        var months = ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"];
        var days = ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31"];
        if (months.indexOf(month) != -1 && days.indexOf(day) != -1) {
            if ((month == '02' && day == '29' && leapYear(year) == false) || (month == '02' && day == '30') || (month == '02' && day == '31') || (month == '04' && day == '31') || (month == '06' && day == '31') || (month == '09' && day == '31') || (month == '11' && day == '31')) {
                return false;
            } else {
                var GivenDate = year + '-' + month + '-' + day;
                var CurrentDate = new Date();
                GivenDate = new Date(GivenDate);
                if (GivenDate > CurrentDate) {
                    return false;
                } else {
                    return true;
                }
            }
        } else {
            return false;
        }

    } 
```

# objective-c - Xcode iOS 界面生成器

> ID：10194470
> 
> 赞同：1
> 
> 时间：2012-04-17T15:44:52.133
> 
> 标签：objective-c, ios, xcode, ipad

为什么我在 iPad 故事板中缩小时无法编辑视图，但我可以在 iPhone 故事板中这样做？此默认设置是否有原因，是否可以更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T20:48:10.870

我无法在 iPad 或 iPhone 故事板中编辑视图天气的内容，我认为这不能很容易地改变。我认为这背后的想法是，您可以移动视图（缩小时）并编辑它们（放大时）。

编辑：您不仅可以移动它们，..您还可以连接视图，编辑它们的类，usw ..但是您不能选择视图上的特定对象。

# java - 如何从泛型类型中获取 Class 对象？

> ID：10194475
> 
> 赞同：-1
> 
> 时间：2012-04-17T15:45:04.447
> 
> 标签：java, class, generics

> **可能重复：**
> [获取泛型类](https://stackoverflow.com/questions/5433170/get-class-of-generic)

我正在尝试这样做：

```
public static<T extends Object> T perform(){
    Class<T> classObject = T.class;
    Class<T> classObjectAgain = T.getClass();
    //...
} 
```

我认为“扩展对象”可以让我访问 .class 和 getClass()...但是这不会编译：“非法类乱码”

你知道我怎么能做这样的手术吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:16:19.560

Java 泛型是通过类型擦除实现的（因为它们只出现在 Java 5 中，所以选择这种类型的实现是为了支持遗留代码）。

这意味着在运行时，所有泛型类型实际上都是 Object 类型。因此，您不能在运行时使用反射来获取有关参数化对象的信息。

# sql - 重新使用 Excel 文档中的单元格作为自定义查询的参数

> ID：10194478
> 
> 赞同：1
> 
> 时间：2012-04-17T15:45:06.960
> 
> 标签：sql, excel

我正在使用自定义 Excel 查询从数据库中获取结果。

我的目标是让数据库中的 Excel 用户更容易运行自定义查询。为此，我投入了一堆过滤器。

当我有超过 12 个“？”时，问题就来了 参数。

我是否可以指定确切的单元格，或者重用一个参数（
例如，这里是我的意思的 sql 示例：

```
SELECT * From table
WHERE table.start_date > ?
      AND table.end_date < ? 
```

**两个**？标记指的是存储在“A1”单元格中的同一日期。

就像现在一样，当我保存时，我必须指定 2 个不同的参数并将它们指向该单元格。

我想要告诉 Excel 它是同一个参数，只需要指定一次。

任何帮助表示赞赏

# android - android中的gif图像

> ID：10194480
> 
> 赞同：0
> 
> 时间：2012-04-17T15:45:08.863
> 
> 标签：android, animation, gif

我正在研究 ApiDemos 代码示例，并看到了一个为 gif 图像设置动画的示例。它工作正常。当我用我自己的 gif 图像替换该 gif 图像（即 R.drawable.animated_gif）时，它会挤压/扭曲 gif 图像并且无法正常工作。任何想法？这是 MyView 类的 onDraw() 方法：

```
@Override protected void onDraw(Canvas canvas) {
            canvas.drawColor(0xFFCCCCCC);                           
            long now = android.os.SystemClock.uptimeMillis();
            if (mMovieStart == 0) {
                mMovieStart = now;
            }
            if (mMovie != null) {

                int dur = Math.max(mMovie.duration(), 1);
                int pos = (int)(now % dur);
                mMovie.setTime(pos);
                mMovie.draw(canvas, getWidth() - mMovie.width(),
                            getHeight() - mMovie.height());
                invalidate();
            }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:49:34.993

由于您没有证明任何代码，因此很难提供帮助，但是，您是否尝试过：

```
android:scaledType="centerInside" 
```

或者

```
android:scaledType="centerCrop" 
```

你的 ImageView 里面的这些属性？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:11:04.117

检查你的第二个 gif 名称。你不应该有空格和 -,+... 我之前有同样的问题，发现图像的名称导致错误

# debugging - Mdbg：无法从进程中分离

> ID：10194481
> 
> 赞同：0
> 
> 时间：2012-04-17T15:45:09.730
> 
> 标签：debugging, clr, mdbg

我们正在使用 MDBG 附加到 IIS 工作进程。

执行堆栈快照后，我们使用 MDBgProcess.Detach() 进行分离。

虽然这个调用通常需要 10-80 毫秒，但有时它会挂起很长时间，同时也会冻结进程。

这是不可接受的，因为该过程是一个生产程序。

这是我们的完整代码：

```
try
{
    proc.AsyncStop();
}
finally
{
    // Make sure we are able to detach
    try
    {
        // delete all breakpoints
        proc.Breakpoints.DeleteAll();
    }
    catch (Exception e){}
    finally
    {
        // detach and wait
        var waitHandle = proc.Detach();
        if (proc.CanExecute())
        {
            waitHandle.WaitOne();
        }
    }
} 
```

任何想法为什么会发生这种情况，以及我们能做些什么？

最好的，迈克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:53:38.677

我不知道它为什么会挂断，但我认为您可能存在竞争条件 - 在我的程序中，我会阻塞直到使用 Stop() 上的 WaitOne() 停止进程...

```
proc.AsyncStop().WaitOne();
m_Debugger.Processes.Active.Breakpoints.DeleteAll();
proc.CorProcess.Detach(); // I don't wait here because this is where my prog ends 
```

# python - 自定义 matplotlib 绘图：象棋棋盘一样的带有彩色单元格的表格

> ID：10194482
> 
> 赞同：13
> 
> 时间：2012-04-17T15:45:10.940
> 
> 标签：python, matplotlib, pandas

当我学习 python 和这个有趣的绘图库时，我开始使用 matplotlib 渲染绘图。对于我正在处理的问题，我需要自定义绘图的帮助。可能已经为此提供了内置功能。

问题：我正在尝试将表格（矩形）绘制为具有 96 个单独单元格（8 行 X 12 列）的图。用特定颜色为每个替代单元格着色（如棋盘：我将使用其他颜色组合而不是黑色/白色），并从 pandas 数据框或 python 字典中为每个单元格插入值。在侧面显示列和行标签。

样本数据： http: [//pastebin.com/N4A7gWuH](http://pastebin.com/N4A7gWuH)

我希望情节看起来像这样，用 numpy/pandas ds 替换单元格中的值。

示例图： http: [//picpaste.com/sample-E0DZaoXk.png](http://picpaste.com/sample-E0DZaoXk.png)

感谢您的意见。

PS：确实在 mathplotlib 的邮件列表上发布了相同的内容

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-17T16:38:52.260

基本上，您可以使用`imshow`or `matshow`。

但是，我不太清楚你的意思。

如果您想要一个棋盘，其中每个“白色”单元格都由其他向量着色，您可以执行以下操作：

```
import matplotlib.pyplot as plt
import numpy as np

# Make a 9x9 grid...
nrows, ncols = 9,9
image = np.zeros(nrows*ncols)

# Set every other cell to a random number (this would be your data)
image[::2] = np.random.random(nrows*ncols //2 + 1)

# Reshape things into a 9x9 grid.
image = image.reshape((nrows, ncols))

row_labels = range(nrows)
col_labels = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I']
plt.matshow(image)
plt.xticks(range(ncols), col_labels)
plt.yticks(range(nrows), row_labels)
plt.show() 
```

![在此处输入图像描述](../Images/8fc54846bbf4df80967d1d78622bdeea.png)

显然，这仅适用于具有奇数行和列的事物。您可以遍历具有偶数行和列的数据集的每一行。

例如：

```
for i, (image_row, data_row) in enumerate(zip(image, data)):
    image_row[i%2::2] = data_row 
```

但是，每行中的“数据”单元格的数量会有所不同，这就是我对您的问题定义感到困惑的地方。

~~根据定义，棋盘图案在每行中具有不同数量的“白色”单元格。~~
您的数据大概（？）在每行中具有相同数量的值。你需要定义你想要做什么。您可以截断数据，或添加额外的列。

编辑：我刚刚意识到这仅适用于奇数列数。

无论如何，我仍然对你的问题感到困惑。

您是否想要有一个“完整”的数据网格，并且想要将*数据网格*中的值的“棋盘”模式设置为不同的颜色，或者您想要用绘制的“棋盘”模式的值“散布”数据作为一些恒定的颜色？

## 更新

听起来您想要更像电子表格的东西？Matplotlib 不适合这个，但你可以做到。

理想情况下，您只需使用`plt.table`，但在这种情况下，直接使用更容易`matplotlib.table.Table`：

```
import matplotlib.pyplot as plt
import numpy as np
import pandas

from matplotlib.table import Table

def main():
    data = pandas.DataFrame(np.random.random((12,8)), 
                columns=['A','B','C','D','E','F','G','H'])
    checkerboard_table(data)
    plt.show()

def checkerboard_table(data, fmt='{:.2f}', bkg_colors=['yellow', 'white']):
    fig, ax = plt.subplots()
    ax.set_axis_off()
    tb = Table(ax, bbox=[0,0,1,1])

    nrows, ncols = data.shape
    width, height = 1.0 / ncols, 1.0 / nrows

    # Add cells
    for (i,j), val in np.ndenumerate(data):
        # Index either the first or second item of bkg_colors based on
        # a checker board pattern
        idx = [j % 2, (j + 1) % 2][i % 2]
        color = bkg_colors[idx]

        tb.add_cell(i, j, width, height, text=fmt.format(val), 
                    loc='center', facecolor=color)

    # Row Labels...
    for i, label in enumerate(data.index):
        tb.add_cell(i, -1, width, height, text=label, loc='right', 
                    edgecolor='none', facecolor='none')
    # Column Labels...
    for j, label in enumerate(data.columns):
        tb.add_cell(-1, j, width, height/2, text=label, loc='center', 
                           edgecolor='none', facecolor='none')
    ax.add_table(tb)
    return fig

if __name__ == '__main__':
    main() 
```

![在此处输入图像描述](../Images/9df0a08e40d8fba0ef36c25cb1e3a85e.png)

# javascript - 需要通过 Google Analytics 跟踪推荐人

> ID：10194483
> 
> 赞同：2
> 
> 时间：2012-04-17T15:45:13.100
> 
> 标签：javascript, google-analytics-api, http-referer, referer

当有人进来时，我需要跟踪引荐网站，包括如果我可以通过引荐来源获取关键字。我需要在 Javascript 中使用 Google Analytics 来执行此操作，以便将其存储在该 GA 报告中，但随后我还想将其传递到我的 MySQL 数据库以将其与完整的表单一起存储。（该网站由 PHP 组成。）

我听说谷歌最近出于隐私原因更改了引用者，但我不知道这是否影响了 Google Analytics API。是否可以使用 GA API 来获取完整的引用，包括谷歌搜索引擎上使用的关键字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:51:22.580

Google 最近更改为登录用户默认使用 SSL。这意味着任何登录的人都将显示为来自“https://google.com/”的引用。

谷歌分析足够聪明，能够分辨出它的自然流量，但不——你不会得到关键词。

将其存储在本地 - 为什么？您可以将其从 GA 中导出，如果您尝试跟踪事件，Google Analytics（分析）具有此功能，因此您可以细分完成表单的访问：[http ://code.google.com/apis/analytics/docs/跟踪/eventTrackerGuide.html](http://code.google.com/apis/analytics/docs/tracking/eventTrackerGuide.html)

# xml - 如何在启用数据绑定的scala中加载xml文件

> ID：10194490
> 
> 赞同：1
> 
> 时间：2012-04-17T15:45:33.270
> 
> 标签：xml, scala

假设我有这样的内容的 xml 文件：

```
<example name={name}/> 
```

是否可以从 Scala 加载此文件并将 {name} 替换为范围内的名称值？

所以像 XML.loadFile 这样的东西，但它以与 Scala 的 XML 文字相同的方式进行数据绑定。

请注意，更复杂的示例也应该起作用，例如

```
<example name={name}>
   {for (hobby <- hobbies) yield <hobby>{hobby}</hobby>}
</example> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T22:44:50.293

这足够了吗？

```
import scala.collection.mutable
import scala.util.matching.Regex.Groups
import scala.xml.XML

type Data = mutable.Map[Symbol, Any]

object Data {
  def empty = mutable.Map.empty[Symbol, Any]
}

class Assignment(identifier: Symbol, data: Data) {
  def :=(value: Any) {
    data(identifier) = value
  }
}

implicit def symbol2assignment(id: Symbol)(implicit data: Data) =
  new Assignment(id, data)

def bind(template: String)(implicit data: Data) = {
  val attributes = """=\{([^{}]+)}""".r
    .replaceAllIn((_: String), _ match {
      case Groups(identifier) =>
        "=\"%s\"".format(data(Symbol(identifier)))
    })
  val rest = """\{([^{}]+)}""".r
    .replaceAllIn((_: String), _ match {
      case Groups(identifier) =>
        data(Symbol(identifier)).toString
    })
  (attributes andThen rest andThen XML.loadString)(template)
}

implicit val data = Data.empty

'name := "bob"
'text := "hi there"

val bound = bind("<ex name={name}>{text}</ex>")
assert(bound == <ex name="bob">hi there</ex>) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:42:18.807

```
object XmlBinder {

  // "twitter" at "http://maven.twttr.com"
  // "com.twitter" %% "util-eval" % "3.0.0"
  import com.twitter.util.Eval
  import scala.xml.Elem

  private val template =
    """|<example name={name}>
       |  {for (hobby <- hobbies) yield <hobby>{hobby}</hobby>}
       |</example>""".stripMargin

  val name = "name"
  val hobbies = List("hobby 1", "hobby 2")

  def bind(): Elem = new Eval()("import XmlBinder._\n" + template)
} 
```

# android - 如何将 JSON lat/long 放在地图上

> ID：10194492
> 
> 赞同：0
> 
> 时间：2012-04-17T15:45:36.960
> 
> 标签：android, json, google-maps

我一直在尝试在地图上显示 JSON API 的纬度和经度，现在我已经解析了 json 值并使用 android book 创建了逐项叠加。然而，这两件事没有联系，我不确定如何将解析纬度/经度放在地图上。谁能给我一个解决方案

我正在尝试将值解析为数组并将它们显示在地图上。

我怎样才能做到这一点？

任何解决方案将不胜感激。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.mapview);

    mapView = (MapView) findViewById(R.id.mapview);
    mapView.setBuiltInZoomControls(true);
   // mapView.setStreetView(true);
   // mapView.isStreetView();
   // mapView.isSatellite();

    JSONArray properties = null;
    JSONParser jParser = new JSONParser();
    JSONObject json = jParser.getJSONFromUrl(url);
    try {
        // Getting Array of Contacts
        properties = json.getJSONArray(TAG_PROPERTY);

        // looping through All Contacts
        for (int i = 0; i < properties.length(); i++) {
            JSONObject c = 
                            properties.getJSONObject(i);                
            String lat = c.getString(TAG_LATITUDE);
            String longi = c.getString(TAG_LONGITUDE);
            System.out.println(lat);

        }
    } catch (Exception e) {
    }//getting JSOn values

    Drawable marker=getResources().getDrawable(R.drawable.mapmarker); 
    marker.setBounds((int)(-marker.getIntrinsicWidth()/2),
            -marker.getIntrinsicHeight(),
            (int) (marker.getIntrinsicWidth()/2), 
            0);

    InterestingLocations funPlaces = new InterestingLocations(marker);
    mapView.getOverlays().add(funPlaces);

    GeoPoint pt = funPlaces.getCenterPt();
    double latSpan = funPlaces.getLatSpanE6();
    double lonSpan = funPlaces.getLonSpanE6();
    Log.v("Overlays", "Lat span is " + latSpan);
    Log.v("Overlays", "Lon span is " + lonSpan);

    MapController mc = mapView.getController();
    mc.setCenter(pt);
    mc.zoomToSpan((int)(latSpan*1.5), (int)(lonSpan*1.5));
}

@Override
protected boolean isLocationDisplayed() {
    return false;
}

@Override
protected boolean isRouteDisplayed() {
    return false;
}

class InterestingLocations extends ItemizedOverlay {
    private ArrayList<OverlayItem> locations = new ArrayList<OverlayItem>();
    private GeoPoint center = null; 
```

我需要使用对象数组替换以下代码

```
 public InterestingLocations(Drawable marker)
    {
        super(marker);

        // create locations of interest
        GeoPoint Maddox = new 
            GeoPoint((int)(51.513292002080306*1000000),(int)(-0.1420965932139256*1000000));

        GeoPoint WoburnPlace = new 
            GeoPoint((int)(51.52457273349151*1000000),(int)(-0.12765430497584865*1000000));

        GeoPoint Capstansquare = new 
                GeoPoint((int)(51.49858590609855*1000000),(int)(-0.007696115597470304*1000000));

        GeoPoint Devonshire = new 
                GeoPoint((int)(51.52222533547292*1000000),(int)(-0.1440394063396748*1000000));

        GeoPoint Bolsover = new 
                GeoPoint((int)(51.52266783118477*1000000),(int)(-0.14358896505772278*1000000));

        GeoPoint Haymarket = new 
                GeoPoint((int)(51.51000027761305*1000000),(int)(-0.13300746016819762*1000000));

        locations.add(new OverlayItem(Haymarket, 
                "Seven Seas Lagoon", "Seven Seas Lagoon"));

        locations.add(new OverlayItem(Bolsover, 
                "Seven Seas Lagoon", "Seven Seas Lagoon"));

        locations.add(new OverlayItem(Devonshire, 
                "Seven Seas Lagoon", "Seven Seas Lagoon"));

        locations.add(new OverlayItem(Capstansquare, 
                "Seven Seas Lagoon", "Seven Seas Lagoon"));

       locations.add(new OverlayItem(WoburnPlace, 
               "Seven Seas Lagoon", "Seven Seas Lagoon"));

        locations.add(new OverlayItem(Maddox, 
               "Magic Kingdom", "Magic Kingdom"));

        populate();
    }

    //  We added this method to find the middle point of the cluster
    //  Start each edge on its opposite side and move across with each point.
    //  The top of the world is +90, the bottom -90,
    //  the west edge is -180, the east +180
    public GeoPoint getCenterPt() {
        if(center == null) {
            int northEdge = -90000000;   // i.e., -90E6 microdegrees
            int southEdge = 90000000;
            int eastEdge = -180000000;
            int westEdge = 180000000;
            Iterator<OverlayItem> iter = locations.iterator();
            while(iter.hasNext()) {
                GeoPoint pt = iter.next().getPoint();
                if(pt.getLatitudeE6() > northEdge) northEdge = pt.getLatitudeE6();
                if(pt.getLatitudeE6() < southEdge) southEdge = pt.getLatitudeE6();
                if(pt.getLongitudeE6() > eastEdge) eastEdge = pt.getLongitudeE6();
                if(pt.getLongitudeE6() < westEdge) westEdge = pt.getLongitudeE6();
            }
            center = new GeoPoint((int)((northEdge + southEdge)/2),
                    (int)((westEdge + eastEdge)/2));
        }
        return center;
    }

    @Override
    public void draw(Canvas canvas, MapView mapview, boolean shadow) {
        // Here is where we can eliminate shadows by setting to false
        super.draw(canvas, mapview, shadow);
    }

    @Override
    protected OverlayItem createItem(int i) {
        return locations.get(i);
    }

    @Override
    public int size() {
        return locations.size();
    }
} 
```

我需要实现这样的[目标](https://developers.google.com/maps/articles/android_v3)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:53:45.340

[http://www.codeproject.com/Articles/349646/Dynamic-JSON-parser](http://www.codeproject.com/Articles/349646/Dynamic-JSON-parser)

这是你想要的？这将让您解析 JSON，现在如何将它们放在地图上，我不确定，我只使用了 bingMaps Rest 服务。如果您对这个 JSON Parser 不满意，请查看一下 google。

编辑：另外，为什么要在列表中使用数组？列表非常有用，尤其是当您的数组中有未知数量的输入时。列出我的纬度 = List(); 这是一种非常有用的方法，以至于我在编写 Web 应用程序时几乎从不使用数组。

向地图添加地理点的答案：

```
GeoPoint point2 = new GeoPoint(35410000, 139460000);
OverlayItem overlayitem2 = new OverlayItem(point2, "Sekai, konichiwa!", "I'm in Japan!"); 
```

有关叠加如何工作的更多信息，请查看此链接下的第 2 部分：http: [//developer.android.com/resources/tutorials/views/hello-mapview.html](http://developer.android.com/resources/tutorials/views/hello-mapview.html) 这里有很多关于如何使用 Android 地图视图的有用示例。祝你好运！

# c# - 关于 MembershipDataContext 命名空间/参考

> ID：10194494
> 
> 赞同：0
> 
> 时间：2012-04-17T15:45:40.680
> 
> 标签：c#, asp.net, asp.net-membership

我正在使用[MembershipDataContext](https://stackoverflow.com/a/2153340/635634)中的代码在我的 Web 表单代码后面的 aspnet_user 表中更改用户名。但它不起作用，因为找不到 MembershipDataContext 命名空间。谷歌搜索但没有结果。

谢谢

更新：

```
public bool ChangeUserName(Guid userId, string newUserName)
{
    bool success = false;
    newUserName = newUserName.Trim();

    // Make sure there is no user with the new username
    if (Membership.GetUser(newUserName) == null)
    {
        MembershipUser u = Membership.GetUser(userId);
        string oldUsername = u.UserName;
        // get current application

        MembershipDataContext context = new MembershipDataContext ();
        aspnet_User userToChange = (from user in context.aspnet_Users
                                    where user.UserId == userId
                                    select user).FirstOrDefault();

        if (userToChange != null)
        {
            userToChange.UserName = newUserName;
            userToChange.LoweredUserName = newUserName.ToLower();

            context.SubmitChanges();

            // ASP.NET Issues a cookie with the user name. 
            // When a request is made with the specified cookie, 
            // ASP.NET creates a row in aspnet_users table.
            // To prevent this sign out the user and then sign it in

            string cookieName = FormsAuthentication.FormsCookieName;
            HttpCookie authCookie = 
              HttpContext.Current.Request.Cookies[cookieName];

            FormsAuthenticationTicket authTicket = null;

            try
            {
                authTicket = 
                    FormsAuthentication.Decrypt(authCookie.Value);

                FormsIdentity formsIdentity = 
                    new FormsIdentity(
                        new FormsAuthenticationTicket(
                            authTicket.Version, 
                            newUserName, 
                            authTicket.IssueDate, 
                            authTicket.Expiration, 
                            authTicket.IsPersistent, 
                            authTicket.UserData));

                string y = HttpContext.Current.User.Identity.Name;
                string[] roles = 
                    authTicket.UserData.Split(new char[] { '|' });
                System.Security.Principal.GenericPrincipal genericPrincipal = 
                    new System.Security.Principal.GenericPrincipal(
                                                        formsIdentity, 
                                                        roles);

                HttpContext.Current.User = genericPrincipal;
            }
            catch (ArgumentException ex)
            {
                // Handle exceptions
            }
            catch( NullReferenceException ex)
            {
                // Handle exceptions
            }

            FormsAuthentication.SignOut();
            HttpContext.Current.Session.Abandon();
            FormsAuthentication.SetAuthCookie(newUserName, false);
            success = true;
        }
    }

    return success;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:10:18.337

您提到的问题中的代码定义了一个名为的 Linq to SQL 实体数据上下文`MembershipDataContext`（这使其成为 的定义[`DataContext`](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.aspx)）。没有内置类型（我知道或可以找到）名为`MembershipDataContext`.

[这是另一个](http://code.google.com/p/rapidwebdev/source/browse/trunk/src/RapidWebDev.Platform/?r=346#RapidWebDev.Platform/Linq)做同样事情的项目示例（包括 dbml 定义）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:50:03.243

数据上下文通常是指 linq。你用的是linq吗？如果是这样，`DataContext`是[实际类](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CDcQFjAA&url=http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.aspx&ei=zJCNT8_-LZLdiAKA_4G7CA&usg=AFQjCNF1sVeeZFJ7IlaKQADa0G-0OE41AQ&sig2=6yN_ul49AvhbmFKZrGzFOg)，因为该`Member`部分是您从 DBML 文件中自定义生成的类。

我希望这有帮助。

# mysql - JOIN with MAX in WHERE

> ID：10194506
> 
> 赞同：0
> 
> 时间：2012-04-17T15:46:16.553
> 
> 标签：mysql, sql, database, join

There are 2 tables:

Table **temperature_now**:

```
machine_id | temperature
------------------------
    1      |     15
    2      |     20
    3      |     13 
```

Table **temperature_history**:

```
change_id | machine_id | temperature | controller
-------------------------------------------------
    1           1            6           Carl
    2           2            9           Steve
    3           1            7           John
    4           1            15          Peter
    5           2            20          Peter
    6           3            13          Martin 
```

temperature_now.machine_id = temperature_history.machine_id

change_id is auto_increment

**I need to get the last change of temperature at each machine**:

```
machine_id | temperature_now | temperature_before | controller
--------------------------------------------------------------
    1              15                   7              John
    2              20                   9              Steve 
```

Thanks for your help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:38:48.037

您可以使用 Common Table Expression as Bellow 来做到这一点。

**更新**

```
WITH History (MachineID, Temp, Controller)
AS
(
   SELECT machine_id, temperature, controller 
   FROM dbo.temperature_history
   WHERE change_id in ((SELECT MAX(change_id) FROM dbo.temperature_history AS TH
   INNER JOIN dbo.temperature_now AS TN
   ON TN.machine_id = TH.machine_id
   WHERE TN.temperature != TH.temperature 
   GROUP BY TH.machine_id))
)

SELECT N.machine_id, 
N.temperature, 
H.Temp as 'temperature_before',
H.Controller
FROM dbo.temperature_now AS N
INNER JOIN History AS H
ON H.MachineID = N.machine_id
ORDER BY N.machine_id; 
```

然后你会得到如下结果：

```
machine_id   temperature    temperature_before  Controller
1            15             7                   John
2            20             9                   Steve 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:50:46.503

```
select n.machine_id, n.temperature as temperature_now, 
    h.temperature as temperature_before, h.controller
from temperature_now n
left outer join (
    select th.machine_id, max(th.change_id) as MaxChangeID
    from temperature_history th
    Inner join temperature_now tn on th.machine_id = tn.machine_id and th.temperature <> tn.temperature
    group by th.machine_id
) hm on n.machine_id = hm.machine_id
left outer join temperature_history h on hm.machine_id = h.machine_id
    and hm.MaxChangeID = h.change_id
order by n.machine_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T05:03:45.707

这可能有效，但嵌套查询可能存在性能问题。如果我可以优化查询，我会发布它。

```
 SELECT DISTINCT TN.MACHINE_ID,
                TN.TEMPERATURE,
                (SELECT DISTINCT TH.TEMPERATURE
                   FROM TEMPERATURE_HISTORY TH
                  WHERE TH.CHANGE_ID =
                        (SELECT MAX(TH1.CHANGE_ID)
                           FROM TEMPERATURE_HISTORY TH1
                          WHERE TH1.MACHINE_ID = TN.MACHINE_ID
                            AND TH1.CHANGE_ID <
                                (SELECT MAX(TH2.CHANGE_ID)
                                   FROM TEMPERATURE_HISTORY TH2
                                  WHERE TH2.MACHINE_ID = TN.MACHINE_ID))) AS TEMPERATURE_BEFORE,
                (SELECT DISTINCT TH.CONTROLLER
                   FROM TEMPERATURE_HISTORY TH
                  WHERE TH.CHANGE_ID =
                        (SELECT MAX(TH1.CHANGE_ID)
                           FROM TEMPERATURE_HISTORY TH1
                          WHERE TH1.MACHINE_ID = TN.MACHINE_ID
                            AND TH1.CHANGE_ID <
                                (SELECT MAX(TH2.CHANGE_ID)
                                   FROM TEMPERATURE_HISTORY TH2
                                  WHERE TH2.MACHINE_ID = TN.MACHINE_ID))) AS CONTROLLER
  FROM TEMPERATURE_NOW TN 
```

希望能帮助到你

# asp.net - 报表查看器工具栏图标间距过大

> ID：10194510
> 
> 赞同：3
> 
> 时间：2012-04-17T15:46:26.083
> 
> 标签：asp.net, visual-studio-2010, reporting-services, report-viewer2010

第一次将报告服务报告添加到 ASP.NET 页面中，并且正在使用本地处理。有没有办法控制reportviewer工具栏（Visual Studio 10），使图标的间距不那么宽？我的跨越多行，我只能通过删除其中一些来将它们放在一行上。下面是图像以及页面代码。

```
<rsweb:ReportViewer ID="rptWireReport" runat="server" Font-Names="Verdana" 
    Font-Size="8pt" InteractiveDeviceInfos="(Collection)" 
    WaitMessageFont-Names="Verdana" WaitMessageFont-Size="14pt" 
    SizeToReportContent="true" ShowFindControls="False" 
    ShowZoomControl="False">
    <LocalReport ReportPath="reports\WireReport.rdlc">
    </LocalReport>
</rsweb:ReportViewer> 
```

![在此处输入图像描述](../Images/8950a2a8d369b6d7ccba08f815de809f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-14T22:01:31.073

因为reportviewer 工具栏图标使用表格单元格进行布局，所以应用于CSS 中任何表格标签的任何填充或间距都会影响工具栏的布局。在这种情况下，我可以简单地从 CSS 中删除不必要的 cellpadding 值，以便它们正确布局。

# mysql - CakePHP find all generates SQL that returns duplicate records (with same ID). Find list does not

> ID：10194512
> 
> 赞同：0
> 
> 时间：2012-04-17T15:46:28.347
> 
> 标签：mysql, cakephp

So, this code below:

```
 $friends = $this->find('all',
        array(
            'conditions' => array(
                'User.id' => 102
            ),
            'contain' => 'Profile'
        )
    ); 
```

Generates this SQL:

```
SELECT `User`.`id`, `User`.`sForceId`, `User`.`householdId`, 
`User`.`householdSForceId`, `User`.`username`, `User`.`primaryUser`, `User`.`password`, 
`User`.`firstName`, `User`.`lastName`, `User`.`dateOfBirth`, `User`.`email`,   
`User`.`preferredEmail`, `User`.`phone`, `User`.`preferredPhone`, `User`.`homePhone`,
`User`.`workPhone`, `User`.`mobilePhone`, `User`.`ethnicity`, `User`.`ethnicityOther`,
`User`.`religion`, `User`.`religionOther`, `User`.`active`, `User`.`adminStatus`, 
`User`.`group`, `User`.`created`, `User`.`modified`, `Profile`.`id`, 
`Profile`.`userId`, `Profile`.`aboutMe`, `Profile`.`picture`, `Profile`.`created`, 
`Profile`.`modified`, `Profile`.`lat`, `Profile`.`lng` FROM `users` AS `User` LEFT JOIN
`profiles` AS `Profile` ON (`Profile`.`userId` = `User`.`id`) WHERE `User`.`id` = (102) 
```

(apologies if reading that makes your brain hurt)

This SQL code selects the same record three times. I have no idea why. What's wrong with it? More importantly, how do I change my CakePHP code to select that record one time instead of three times?

In case it's helpful: User belongsTo Household and hasOne Profile.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:04:22.613

如果您最终以某种方式为该用户拥有多个配置文件，那么由于`LEFT JOIN`每个配置文件都返回一条记录，您最终将获得多条记录。

这适用于 hasOne 和 belongsTo 关系，因为它们是使用`LEFT JOIN`s 连接数据的关系。

您可以通过手动查看数据库来检查这一点：`SELECT * FROM profiles where profiles.userId = 102`

# javascript - 单击jstree节点，以该节点为根重建树

> ID：10194516
> 
> 赞同：3
> 
> 时间：2012-04-17T15:46:38.547
> 
> 标签：javascript, jquery, tree, jstree

我认为这个主题相当清楚。:)

我是一个 jstree 新手，并试图解析文档，但我对这个有点卡住了。我有以下代码：

```
$("#tree").jstree({
   "json_data" : {
       "data" : [
           tree.company
       ]
   },
   "themes" : {
       "theme" : "smb",
       "dots" : false,
       "icons" : true
   },
   "plugins" : [ "themes", "json_data", "ui" ]
}).bind("select_node.jstree", function (event, data) {
   $('#tree').jstree.refresh(data.inst.get_selected());  // FIXME
}); 
```

树加载并显示得很好，但是当我单击要成为*显示*树的新根的节点时，在标记为 FIXME 的行处出现错误。我已经尝试了各种没有快乐的事情，并且非常感谢一些帮助。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T19:51:35.460

我很确定您在该行收到错误的原因是因为您在该行中的语法有点偏离：

```
$('#tree').jstree.refresh(data.inst.get_selected()); 
```

试试这个：

```
$('#tree').jstree("refresh", data.inst.get_selected()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T23:35:42.087

如果需要刷新整个树，那么可以引用并刷新树的容器。

```
.bind("select_node.jstree", function (event, data) {
    $.jstree._reference(data.inst.get_container()).refresh(); //(data.inst.get_selected());  // FIXME
}).bind("refresh.jstree", function (event, data) {
    alert("Refreshed!");
}); 
```

如果只需要在select_node中引用节点：data.rslt.obj[0];

或另一轮获取它的方法（与上面相同的节点）： $.jstree._reference(data.inst.get_container()).get_selected();

您可能还需要销毁和重建树： $.jstree._reference("#tree").destroy(); 我知道这可能看起来很浪费，但无论如何你都在替换根节点。

# php - XPATH from visual web ripper to PHP

> ID：10194517
> 
> 赞同：0
> 
> 时间：2012-04-17T15:46:44.420
> 
> 标签：php, warnings, web-scraping, domdocument

I am using a software called Visual Web Ripper to select element i need from a webpage. But i do not use Visual Web Ripper to scrape the elements, I just want to get the XPATH from there of the elements I need and then use that in our own engine. But it does not seem to work. See screen shots below.

**Getting XPATH from Visual Web Ripper for the elements i want to scrape**

![enter image description here](../Images/ae8f83cf0916d13a054cac35b6f25700.png)

**The code I am using in PHP**

```
$curl = new curl();
$html = $curl->get_web_page('http://forums.fatakat.com/');

$doc = new DOMDocument();
$doc->loadHTML('<meta http-equiv="Content-Type" content="text/html; charset=windows-1256"/>'.$html);

$xpath = new DOMXpath($doc);

$elements = $xpath->query("//TABLE[@class='tborder']/TBODY/TR[@class='']/TD[2]/DIV[1]/A[1]/STRONG[1]");

////$elements = $xpath->query("//*[@id='f3']"); //works

if (!is_null($elements)) {
  foreach ($elements as $element) {
    echo "<br/>[". $element->nodeName. "]";

    $nodes = $element->childNodes;
    foreach ($nodes as $node) {
      echo $node->nodeValue. "\n";
    }
  }
} 
```

Thanking you

# c - assigning a char - segmentation fault

> ID：10194518
> 
> 赞同：1
> 
> 时间：2012-04-17T15:46:47.593
> 
> 标签：c

```
#include <stdio.h>

void main(){
    char *str[]={"aa","bb"};
    str[0][0]='h';
} 
```

I receive a segmentation fault when executing this code. Does anyone know the reason?

Thanks in advance.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:49:00.130

您正在分配一个由字符串常量占用的位置，这是一种未定义的行为。如果你知道你的字符串的最大长度，你可以这样做：

```
char ss[][3] = {"aa", "bb"}; 
```

这不是一个精确的等价物，但它应该可以工作。如果你不知道最大长度，或者不想在这里和那里浪费几个字节，你仍然可以通过更多的工作来完成它：

```
char aa[] = "aa";
char bbbb[] = "bbbb";
char *ss[] = {aa, bbbb}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T15:48:47.013

您正在尝试更新文字常量，这是不允许的。这将导致未定义的行为。

# android - Android - 无法接收 C2DM 注册意图

> ID：10194526
> 
> 赞同：3
> 
> 时间：2012-04-17T15:47:11.073
> 
> 标签：android, android-c2dm

我正在尝试向 C2DM 注册我的设备，但遇到了重大问题。我遵循了几个教程，所有这些教程都非常相似。我相信这个问题与它发送到 C2DM 服务器的注册意图有关。有没有人有什么建议。以下是相关代码：

清单：**权限**（在我的应用程序标签之外）：

```
<!-- Used for C2DM -->
<uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
<uses-permission android:name="com.companyname.parade.permission.C2D_MESSAGE" /> 
```

这是 Intent 注册（在我的应用程序标签内）：

```
<receiver
    android:name=".C2DMReceiver"
    android:permission="com.google.android.c2dm.permission.SEND" >
    <!-- Receive the actual message -->
    <intent-filter>
        <action android:name="com.google.android.c2dm.intent.RECEIVE" />

        <category android:name="com.companyname.parade" />
    </intent-filter>
    <!-- Receive the registration id -->
    <intent-filter>
        <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
        <category android:name="com.companyname.parade" />
    </intent-filter>
</receiver> 
```

以下是我将我的设备注册到 C2DM 服务器的调用（它启动了联系 C2DM 服务器的服务，该服务假设发送回带有我的 registartionID 的注册 Intent）。它位于一个名为**C2DMessaging**的文件中：

```
public static void register(Context context) {
    Intent registrationIntent = new Intent(REQUEST_REGISTRATION_INTENT);
    registrationIntent.putExtra(EXTRA_APPLICATION_PENDING_INTENT,
            PendingIntent.getBroadcast(context, 0, new Intent(), 0));
    registrationIntent.putExtra(EXTRA_SENDER, SENDER_ID);
    ComponentName name = context.startService(registrationIntent);
    if(name == null){
        // FAIL!
        Log.d(TAG, "FAIL");
    }else{
        // SUCCESS
        Log.d(TAG, "Success");
    }
} 
```

ComponentName 信息如下：

```
com.google.android.gsf/com.google.android.gsf.gtalkservice.PushMessagingRegistrar 
```

没有 logcat 输出。我的接收器（名为**C2DMReceiver**）如下：

```
@Override
public void onReceive(Context context, Intent intent) {
    String action = intent.getAction();
    if (C2DMessaging.INTENT_REGISTRATION_CALLBACK.equals(action)) {
        // Registration Intent
        Log.w(TAG, "Registration Receiver called");
        handleRegistration(context, intent);
    } else if (action.equals(C2DMessaging.INTENT_RECEIVED_MESSAGE_CALLBACK)) {
        Log.w(TAG, "Message Receiver called");
        handleMessage(context, intent);
    } else if (action.equals(C2DMessaging.INTENT_C2DM_RETRY)) {
        C2DMessaging.register(context);
    }
} 
```

这根本不会被调用。

**编辑**：这整件事对我来说是一个愚蠢的错误。我只是在阅读的教程中忘记了一个步骤。我需要将此添加到我的权限中：

```
<permission android:name="com.companyname.parade.permission.C2D_MESSAGE" android:protectionLevel="signature" /> 
```

感谢 MisterSquonk 的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:54:27.287

在 Google docs for C2DM for [Creating the Manifest](http://code.google.com/android/c2dm/index.html#manifest)中，清单需要一个条目`<permission>`来补充.`<uses-permission>``C2D_MESSAGE`

像这样的东西...

```
<permission android:name="com.companyname.parade.permission.C2D_MESSAGE" android:protectionLevel="signature" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:10:52.390

本教程帮助我加快速度： [http ://www.vogella.com/articles/AndroidCloudToDeviceMessaging/article.html](http://www.vogella.com/articles/AndroidCloudToDeviceMessaging/article.html)

我不确定你为什么有两个意图过滤器。我只需要一个 - com.google.android.c2dm.intent.REGISTRATION（有关完整示例清单，请参见上面的教程）

我会检查您的清单是否正确引用了接收器类 - 也许尝试对该类的完全限定引用。有一次我遇到了一个问题，我在项目结构中移动了接收器类并且所有消息都停止了。

我还要检查 C2DM 帐户是否设置正确，并使用正确的包名称。

我也会在另一台设备上尝试它，因为根据我的经验，一些 Android 设备会脱离 C2DM 并且在一段时间内不会收到消息。我发现有时切换到飞行模式并返回可以解决问题，但我发现在几种设备上进行测试对于排除特定设备的问题至关重要。

# php - php处理动态生成的表单

> ID：10194529
> 
> 赞同：0
> 
> 时间：2012-04-17T15:47:20.307
> 
> 标签：php, javascript, post, get

我正在使用 php 生成一个显示博客/线程项目的 html 页面，并且我正在使用 javascript 来显示/隐藏一些细节。问题是我正在为每组隐藏内容生成唯一 ID，其中包含处理输入的表单。在处理表单时，我需要知道编辑了哪个博客项目——我想使用 $_POST。我对javascript很陌生，我想可能有一个我可以在那里使用的解决方案。

我希望帖子将文本保存到 mysql 数据库（所以调用我正在工作的 php 函数之一）并告诉我文本是什么以及 threadId 是什么。

这是 php 代码片段，其中 $threadDetailItem 是一个数组，其中包含我的线程数据。

```
 foreach ($threadData as $threadDetailItem)
   {
    // display main line (a bunch of code here ...)

    // append button to edit or delete the post for admin
    if ( isset ($_SESSION['isAdmin']) && $_SESSION['isAdmin'] == 'Y'){
        // edit link opens content, and delete pops up a confirmation box
        $el = sprintf ("editThreadLink_%d", $threadDetailItem['blogThreadId']);
        $ec = sprintf ("editThreadContent_%d", $threadDetailItem['blogThreadId']);
        $link1 = sprintf ("<a id=\"%s\" href=\"javascript:toggle('%s', '%s');\">+</a>", $el, $ec, $el);
        $msg .= sprintf ("<li id=\"field6\">%s</li>\n", $link1);
    } 
    $msg .= "</ul>\n";
    echo $msg;

    // now that the row is printed, lets add the hidden content if admin so they can edit
    if ( isset ($_SESSION['isAdmin']) && $_SESSION['isAdmin'] == 'Y'){
        // hidden content to enable editing of the posting
        $msg = sprintf ("<div id=\"%s\" style=\"display: none\">\n", $ec);
        echo $msg;

        echo "<form name=\"form\" method=\"post\" action=\"\">\n";
        $msg = sprintf ("<textarea id=\"%s\" name=\"%s\">%s</textarea>\n", 
            $ec, $ec, $threadDetailItem['threadTitle']);
        echo $msg;
        $msg = sprintf ("<button type=\"submit\"> %s</button>\n", $lang->get('BLOG POST'));
        echo $msg;
        echo "</form>\n";
        echo "</div>";
    }
} 
```

非常感谢有关处理此事件的好方法的建议。提前致谢。

数据中的字段是：blogThreadId、threadTitle、username、createdOn、lastUpdated、displayed（未使用）和threadDetails（包含发布信息的数组）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T23:55:11.863

我能够在隐藏字段中使用带有 ID 的 $_POST 来使我的 php 脚本知道正在编辑哪个线程。这是工作

# php - 我有一个变量需要发送到 php 以写入文件

> ID：10194534
> 
> 赞同：1
> 
> 时间：2012-04-17T15:47:30.757
> 
> 标签：php, javascript, json

我有一个特定的数组，php 需要访问和写入文件。我还希望能够调用 php 来获取数组信息。我使用 JSON.strigify 将数组存储在字符串中，但我不知道如何使用 php 将其发送到服务器。我的php经验很少，我试过：

```
<script language="javascript">

var COMMENTS_FOR_DISPLAY = new Array('Have fun with this code: Chris');

// Adds a new comment, name pair to the Array feeding textualizer.
function add_comment() {
  // Retrieve values and add them to Array.
  var new_comment = $('#kwote').val();
  var new_name = $('#name').val();

   COMMENTS_FOR_DISPLAY.push(new_comment + ': ' + new_name);

  // Reset <input> fields.
  $('#kwote').val('');
  $('#name').val('');

  var arrayAsString = JSON.stringify(COMMENTS_FOR_DISPLAY);

}

$(document).ready(function() {
  var txt = $('#txtlzr');  // The container in which to render the list

  var options = {
    duration: 5,          // Time (ms) each blurb will remain on screen
    rearrangeDuration: 5, // Time a character takes to reach its position
    effect: 'random',     // Animation effect the characters use to appear
    centered: true        // Centers the text relative to its container
  }

  txt.textualizer(COMMENTS_FOR_DISPLAY); // textualize it!
  txt.textualizer('start'); // start
});
</script> 
```

在 main.php 我放：

```
<?php
$kwoteString = $_GET["arrayAsString"];
echo $kwoteString;
?> 
```

我使用 echo 来查看我是否得到任何输出，但我没有。这可能是一个非常简单的修复，也许我错过了一个标题或告诉我的 html 文档读取 main.php 的东西？任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:52:54.747

使用 jquery 和 $.post(url,params);

网络上有很多教程和堆栈溢出本身。

这里的文档： [http ://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:53:01.113

you can add a hiddenField and set the string to the hidden field. php code will read the value from hidden field.

# iphone - 使用 UINavigationController 和 Storyboard 返回两个级别

> ID：10194538
> 
> 赞同：3
> 
> 时间：2012-04-17T15:47:44.837
> 
> 标签：iphone, ios, uinavigationcontroller

我有一个包含三个视图 A、B 和 C（以及更多）的故事板。从视图 B，用户可以通过点击自动创建的左侧按钮栏项目返回视图 A。通过设置 A 的导航项的后退按钮属性，我已将其上的标签更改为“取消”。

C 应该有相同的取消按钮，但是返回视图 B 没有意义；相反，它应该跳回 A。我知道如何以编程方式执行此操作，但是我应该将代码放在哪里，以便在点击 C 的取消按钮时触发它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T07:48:36.263

我发现这种方式最简单，只需输入索引：

```
 [self.navigationController popToViewController:[self.navigationController.viewControllers objectAtIndex:1] animated:YES]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T18:13:20.827

我认为您不能覆盖后退按钮功能。在这些情况下，我所做的是创建一个左栏项目，并在它的功能上决定将用户发送到哪个 navigationController 视图。

我通过使用：

```
[self.navigationController viewControllers] objectAtIndex:1]; 
```

索引 1 将是根 viewController 之后的第一个视图，如果 A 是您的根视图，您也可以使用：

```
[self.navigationController popToRootViewControllerAnimated:YES]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T16:10:10.613

不要按 C，而是使用 segue 中的替换选项，以便它会自动为您执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T19:24:28.010

如果您想取消 B 或 C 的操作并返回 A，则以模态方式呈现视图控制器可能更有意义。

来自[iOS 人机界面指南：](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/UIElementGuidelines/UIElementGuidelines.html)

> 模态视图通常会显示一个完成任务并关闭视图的按钮，用户可以点击取消按钮来放弃任务。
> 
> 当您需要提供完成与应用程序主要功能相关的独立任务的能力时，请使用模式视图。模式视图特别适用于需要始终不属于主应用程序用户界面的 UI 元素的多步骤子任务。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-06T14:23:02.813

另一种选择：如果您将以下内容放入 B 中，当 C 出现时，它将从堆栈中删除它。然后堆栈看起来像`[A,C]`这样返回将直接进入 A。

```
override func viewWillDisappear(animated: Bool) {
    super.viewWillDisappear(animated)

    // remove this view controller from the stack
    if let nav = self.navigationController {
        let vcs = nav.viewControllers.filter {(vc) in
            return (vc as? MyViewController) == nil
        }

        self.navigationController?.setViewControllers(vcs, animated: false)
    }
} 
```

# html - 为什么我的自定义 CSS 标记在将其应用于某些文本时会放置引号

> ID：10194547
> 
> 赞同：0
> 
> 时间：2012-04-17T15:48:19.400
> 
> 标签：html, css

好的，所以我对 CSS 和 HTML 很陌生。基本上我有以下代码：

```
<html>
<head>
<style type="text/css">
p
{
    font-family:Calibri, Arial, Helvetica, sans-serif;
}

q
{
    color:#698B22;
}
</style>
</head>

<body>
<p>
Foo Bar Foo bar.
<br /><br />
Foo <a href="http://www.stackoverflow.com/">Bar</a> Foo Bar.
<br /><br />
Foo <a href="http://www.stackoverflow.com/">Bar <q>Foo</q> Bar</a> Foo Bar.
<br /><br />
</p>
</body>
</html> 
```

当我在浏览器中查看时，它看起来像这样：

![浏览器呈现的 HTML](../Images/b903dd0882d92d1f235efb0566e1d3fb.png)

我想知道的是，为什么在第三行，`Foo`链接内的单词周围有引号（在 Chrome 和 Firefox 的最新版本中，IE9 中没有）？另外，我如何获得报价？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T15:50:11.840

`q`不是自定义标签，它[已经存在](http://www.quackit.com/html/tags/html_q_tag.cfm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:50:51.443

在 IE9 中工作，所以我可能猜你没有声明 doctype

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T15:51:53.857

标签告诉浏览器在单词 Foo 周围加上引号

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T15:51:15.367

您已将 HTML 短引号标记添加到您的链接。删除 q 部分，引号将消失。 [http://www.w3schools.com/tags/tag_q.asp](http://www.w3schools.com/tags/tag_q.asp)

如果你想在 CSS 中做你正在做的事情： `Foo <a href="http://www.stackoverflow.com/">Bar <span class="q">Foo</span> Bar</a> Foo Bar.`

并将您的 CSS 更改为： `.q { color:#698B22; }`

请注意，您不能在 CSS 中创建新的 HTML 元素 - 您可以覆盖默认设置或创建新的类或 ID。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T15:52:09.233

由于`<q>`Tag 的意思是*引号*，一些浏览器会自动在内容周围加上*引号*。
在这种特殊情况下，我建议您使用另一个标签，例如：`<em>`代替。

**更多**：[http ://www.w3.org/wiki/HTML/Elements/q](http://www.w3.org/wiki/HTML/Elements/q)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T15:52:53.883

浏览器有默认样式表，您使用的可能会添加它们，但您可以覆盖它，

```
q {
   quotes: none;
}
q:before, q:after {
  content: "";
  content: none;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-17T15:55:46.173

使用`<span>Foo</span>`一个词来赋予它特定的 CSS 样式。

# random - choosing row m from two matrices at random

> ID：10194548
> 
> 赞同：0
> 
> 时间：2012-04-17T15:48:19.907
> 
> 标签：random, matrix, subset

I have two m*n matrices, A and P. I want to randomly choose *the same* 3 rows from both matrices, e.g. rows m, m+1, m+2 are picked from both matrices. I want to be able to make the calculation U=A-P on the selected subset (i.e. Usub-Psub), rather than before the selection. So far I have only been able to select rows from one matrix, without being able to match it to the other. The code I use for this is:

 ``A=[0,1,1,3,2,4,4,5;0,2,1,1,3,3,5,5;0,3,1,1,4,4,2,5;0,1,1,1,2,2,5,5]

P=[0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0]

U=A-P

k = randperm(size(U,1));

Usub = U(k(1:3),:);`  `* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:31:41.943

我将首先创建一个函数，该函数返回一个只有三行的子矩阵，它将一个整数作为三行中的第一行。然后我会做这样的事情：

```
m = number of rows;
randomRow = rand() % m;
U = A.sub(randomRow) - P.sub(randomRow); 
`````

# c# - C# Powerpoint 2007 Copy Slides with Formatting

> ID：10194549
> 
> 赞同：1
> 
> 时间：2012-04-17T15:48:21.030
> 
> 标签：c#, vsto, powerpoint, powerpoint-2007

So I have been able to get slides copied over from PPT 2010 with the `ExecuteMso("PasteSourceFormatting");` command just fine, sadly this does not work for 2007\. I have been able to open up the Source Presentation slides and copy and paste all the content into the Destination Presentation just fine. But the formatting is just off on certain things, color, text size, images resizing. I've also noticed that if the Destination Presentation that I'm attempting to paste into has a Master slide that it is now applied to the newly created slides from the copy/paste Source Presentation. I have yet to find a way that I am able to copy over the master slide from the Source Presentation to the Destination on and tell it to use the new master slides for the slides being pasted it. The closest I can get to it is to copy over the Layout, ColorScheme, and Design. But they still are not formatted correctly do to the missing master slide.

How do I copy over the PPT slides and keep the source format (using source master slide) in PPT 2007?

# python - python 诅咒终端设置已更改

> ID：10194555
> 
> 赞同：2
> 
> 时间：2012-04-17T15:48:37.957
> 
> 标签：python, python-2.7, curses

我对 curses 很陌生，但我写了一个工作的小诅咒应用程序。但过了一会儿，我注意到我的默认终端设置在会话期间发生了更改。背景颜色是纯黑色，但我配置了透明终端。而且颜色看起来更像白色而不是灰色。

我的代码，但我确定它与问题无关。我在 python 2.7.2 中使用 debian wheezy

```
#!/usr/bin/env python

import curses

class Monitor:
    def __init__(self, screen):
        self.screen = screen
        self.height, self.width = self.screen.getmaxyx()
        self.screen.nodelay(1)

    def redraw(self):
        self.screen.clear()
        self.screen.addstr(1, 1, 'hai')
        self.screen.refresh()

    def main(self):
        while 1:
            key = self.screen.getch()
            if key == ord('q'): break
            self.redraw()

def main(stdscr):
    mon = Monitor(stdscr)
    mon.main()

if __name__ == '__main__':
    try:
        curses.wrapper(main)
    except KeyboardInterrupt:
        pass 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T15:05:33.560

我想我应该回答这个问题，因为我之前一直在寻找这个。

中`main()`，您需要添加

`curses.use_default_colors()`

这将使用终端的颜色而不是诅咒覆盖它们。这意味着如果没有设置背景颜色，背景颜色将是透明的。

如果，稍后，您想创建一个具有透明背景的颜色对，而不是例如

`curses.init_pair(1, curses.COLOR_WHITE, curses.COLOR_BLACK)`

采用

`curses.init_pair(1, curses.WHITE, -1)`

这将使用默认背景，即透明。

# autocomplete - zsh 在第三个参数上自动完成

> ID：10194558
> 
> 赞同：4
> 
> 时间：2012-04-17T15:48:54.997
> 
> 标签：autocomplete, zsh

我有一个shell脚本，它的用法是：

```
foo.sh <name> <type> <*.tar.gz> 
```

我只想设置一个完整的第三个参数。如果我按下第一个参数，只显示用法。

我可以使用 zsh 的 zshcomp 来完成这项工作吗？

例如：

```
foo.sh <tab>  # display usage
foo.sh a b <tab> # show files match with *.tar.gz 
```

我可以遵循类似的脚本吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T15:04:31.253

### 要读的东西。

这是一篇讨论[Z-Shell 完成系统](http://bewatermyfriend.org/p/2012/003/)的博文。

如需更深入的讨论，请阅读[此 unix.stackexchange](https://unix.stackexchange.com/questions/33255/how-to-define-and-load-your-own-shell-function-in-zsh)答案。

和往常一样，[阅读手册页！](http://linux.die.net/man/1/zshcompsys).

编辑：忘记添加：`echo $fpath`将向您显示`zsh`使用的函数路径。在 OSX 上，我有：`/usr/local/share/zsh/4.3.17/functions`，（位置可能因您而异），其中包含**所有 ZSH 完成功能**。看看`_ssh`,`_ls`等`_tar`- 它们都在那里，而且它们都有*许多*可以学习的漂亮特性。

* * *

### 解决问题：你应该走的方向。

不过，您要问的是可以实现的。有几个步骤。

1.  您需要编写一个 z-shell 补全函数。它需要位于`fpath`; `zsh`用于完成系统功能的功能路径。（如果是小函数，放入`~/.zshrc`也可以，但不推荐）。

2.  您希望在第三个参数上完成。为此，您的函数将如下所示：

    ```
    _arguments "3:<MENU>:<COMPLETION>" 
    ```

    `<MENU>`是*菜单描述*，如果您启用了菜单描述，您将看到它。（这是使用`zstyle`; 阅读手册页或链接页面以获取更多信息）。 `<COMPLETION>`是你可以完成的事情。例如，如果您使用：

    ```
    _arguments "3::(Foo Bar)" 
    ```

    当您运行脚本并按下`<TAB>`时，您可以选择`Foo`或`Bar`。[注意：`<MENU>`该示例中没有。如果您不需要菜单描述符，则可以省略它，如图所示]。

3.  您希望完成`*.tar`文件。你可以打电话`_files`来做到这一点：

    ```
    _files -g \*.tar 
    ```

4.  显示第一个参数的用法：那将是一个没有参数的完成（即参数 1）。我不确定你为什么只希望完成第三个选项而不是前两个（典型的使用说明），所以我不知道如何回答这个问题。如果你的脚本应该像这样使用: `script foo bar FILE.tar`，你不想完成`foo`and`bar`参数吗？
    当脚本在没有参数的情况下运行时，也许更好的解决方案是显示使用情况。

完整的脚本如下所示：

```
 #compdef myscript

_arguments "3:tar files:_files -g \*.tar" 
```

# ruby-on-rails - 将 before_filter 更改为不需要密码来编辑配置文件

> ID：10194561
> 
> 赞同：1
> 
> 时间：2012-04-17T15:49:00.583
> 
> 标签：ruby-on-rails

如果我想让登录的用户在他们的编辑页面上更改个人资料信息，但不必输入他们的密码，就像他们目前所做的那样，我如何在 UsersController 中有效地更改它？

用户控制器：

```
 before_filter :authenticate, :except => [:show, :new, :create]
    before_filter :authenticate, :only => [:index, :edit, :update, :destroy]
    before_filter :correct_user, :only => [:edit, :update]
    before_filter :admin_user,   :only => :destroy

    def edit
       @title = "Edit user"
    end

    def update
       @user = User.find(params[:id])
        if @user.update_attributes(params[:user])
          flash[:success] = "Profile updated."
          redirect_to @user
      else
      @title = "Edit user"
      render 'edit'
   end
 end 
```

编辑页面

```
 </div>
     <h1> Confirm Password</h1><br /><br />
      <div class="field">
        <%= f.label :password, "Enter Password" %>&nbsp;&nbsp;&nbsp;&nbsp;
        <%= f.password_field :password %>
    </div>
    <div class="field">
       <%= f.label :password_confirmation, "Confirm Password" %>&nbsp;&nbsp;&nbsp;
       <%= f.password_field :password_confirmation %>
   </div>
   <div class="actions">
      <%= f.submit "Submit" %>
   </div>
   <% end %>
   </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:00:54.677

如果您使用的是设计 gem，请将其放入您的用户模型中：

```
def update_with_password(params={})
  if current_user && self.password.blank?
    false
    if params[:password].blank?
      params.delete(:password)
      params.delete(:password_confirmation) if params[:password_confirmation].blank?
    end
  else
    super
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:25:44.980

以下是我在我现在正在工作的项目中的做法：

**用户型号**：

```
validates :password, :length => { :minimum => 8, :maximum => 20}, :unless => Proc.new { |u| u.password_optional? or u.password.blank? }
  validates :password, :confirmation => true, :unless => Proc.new { |u| u.password_optional? } 
```

此方法将取决于您拥有的密码逻辑......但我的看起来像这样：

```
def password_optional?
    optional = (encrypted_password.present? && password.blank? && password_changing.blank?)
    optional
  end 
```

**用户控制器** 在您希望密码为可选的任何操作中，请执行以下操作：（假设您有一个 @user 对象...）

```
@user.password_optional = true 
```

我认为这将在您的**更新**操作中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:54:13.353

我不明白你的问题。如果您在登录时验证他们的用户名和密码，他们不应该重新输入密码来编辑他们的个人资料页面。登录后，它应该持续存在。您是否使用任何身份验证宝石？

# html - mid 无法解析为变量

> ID：10194562
> 
> 赞同：0
> 
> 时间：2012-04-17T15:49:02.677
> 
> 标签：html, jsp

因此，我再次陷入困境，这是我的 .JSP 页面代码，我在其中尝试单击艺术家姓名，它将显示他们出现的电影。我在第一个查询中一切正常，但是当我到达在 queryMovies 中，我尝试将电影的标题链接回电影 ID，这应该带我到另一个页面，我得到错误 mid cannot be resolve to a variable。我究竟做错了什么？谢谢。

```
 <html>
<head>
<%@ include file="header.htm" %>
<%@ page import="java.sql.*" %>
<%
    Class.forName("com.mysql.jdbc.Driver").newInstance();
    String cs="jdbc:mysql://localhost:3306/hunters?user=root&password=password";
    Connection cxn = DriverManager.getConnection(cs);
    Statement stm = cxn.createStatement();

int oscar = 0;

String fname = request.getParameter("fname");
String lname = "", dob = "", nation = "", imdb = "", url = "", newaid = "", title = "", studio = "", role = "", rlsdate = "";
String queryArtist = "SELECT * FROM artist WHERE aid = '" + request.getParameter("selectedName") + "';";

ResultSet rsArtist = stm.executeQuery(queryArtist);

    rsArtist.next();
    fname = rsArtist.getString("fname"); 
    lname = rsArtist.getString("lname");
    dob = rsArtist.getString("dob").substring(0,4);
    nation = rsArtist.getString("nation");
    imdb = rsArtist.getString("imdb");
    url = rsArtist.getString("url");
%>
    <title><%= fname %> <%= lname %></title>

<h2><FONT COLOR="B22222"><%= fname%> <%= lname%></FONT></h2>

<p>Born in: <%= dob%></p> 
<p>Nationality: <%= nation%></p>
<p>IMDB Bio: <a href="http://www.imdb.com/name/<%= imdb%>/"  target="_blank">http://www.imdb.com/name/<%= imdb%>/</a></p>
<%
if (url == null)
{
out.println("<br />");
}
else 
{
out.println("Website: <a href=" + url + "target=_blank>" + url + "</a><br>");
}
%>
<hr />
<h3><FONT COLOR="B22222">Filmography</FONT></h3>
<%
newaid = request.getParameter("selectedName");

String queryMovies = "SELECT * FROM artist, movies, artistmovie WHERE artistmovie.mid = movies.mid AND artist.aid = artistmovie.aid AND artist.aid = '"; 
    queryMovies += request.getParameter("selectedName") + "';";

ResultSet rsMovies = stm.executeQuery(queryMovies);

while(rsMovies.next())
{
    title = rsMovies.getString("title");
    studio = rsMovies.getString("studio");
    rlsdate = rsMovies.getString("rlsdate");
    role = rsMovies.getString("role");
    oscar = rsMovies.getInt("oscar");
    mid = rsMovies.getInt("mid");

    out.println("<tr><td>&nbsp;</td><td><a href= artistmovie.jsp?SelectedTitle=" + mid + ">" + title + " <a/></td>");
    out.println("<td>&nbsp;&nbsp;&nbsp;</td><td>(" + studio + "</a></td>"); 
    out.println("<td></td><td>" + rlsdate + ")</td>");  
    out.println("<td>&nbsp;&nbsp;</td><td>" + role + "</td></br></br>");

}
if (oscar == 0)
{
    out.println("<td>&nbsp;</td><td><br /></td>");
}
else
{
    out.println("<td>&nbsp;</td><td>Won oscar</td></tr>");
}
%>
<%@ include file="footer.htm" %>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:27:50.470

改变

```
out.println("<tr><td>&nbsp;</td><td><a href= artistmovie.jsp?SelectedTitle=" + mid + ">" + title + " <a/></td>"); 
```

到

```
out.println("<tr><td>&nbsp;</td><td><a href=\"artistmovie.jsp?SelectedTitle="+ mid +"\">" + title + " <a/></td>"); 
```

应该管用。

除了这个

```
out.println("<td>&nbsp;&nbsp;&nbsp;</td><td>(" + studio + "</a></td>"); 
```

你在哪里开始“ `<a>`”标签，它在“”附近结束`<td>`。

# ruby-on-rails - 匹配数组中的路由 - Rails Routing

> ID：10194563
> 
> 赞同：1
> 
> 时间：2012-04-17T15:49:12.103
> 
> 标签：ruby-on-rails, routes, match

我正在寻找实现适合某种格式的链接（seo 目的）。

这是一个例子：

```
match '/activities-Palmdale-California', :to => 'explores#activity_by_city', :location=>'Palmdale-California' 
```

每个城市+州的位置发生变化。

有没有办法在路线文件中动态循环遍历一系列城市和州（预定义），而无需创建其他模型等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:07:38.867

您可以在路线中包含参数，因此应该可以使用以下内容：

```
match "/activities-:location", :to => 'explores#activity_by_city' 
```

并且`location`应该发送到你的控制器动作`params[:location]`。如果您想将应用程序接受的 url 限制为预定义数组中的位置（我们称之为`ValidLocations`），您可以使用以下`:constraints`选项在路由中执行此操作：

```
match "/activities-:location", :to => 'explores#activity_by_city', :constraints => proc { |req| ValidLocations.include?(req.params[:location]) } 
```

或在控制器中：

```
def activity_by_city
  ...
  unless ValidLocations.include?(params[:location])
    flash[:error] = "Invalid location."
    redirect_to ...
    return
  end
  ...
end 
```

# xslt - xsl:choose 检查所有 xsl:when 条件

> ID：10194564
> 
> 赞同：4
> 
> 时间：2012-04-17T15:49:11.990
> 
> 标签：xslt, xslt-2.0

有没有办法`<choose>`在第一`<when>`场比赛后不离开但继续检查其他条件？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-17T16:01:18.083

我相信这是一个不。正如规范所说：

> 第一个且只有第一个 xsl:when 元素的内容被实例化，其测试为真。如果没有 xsl:when 为真，则实例化 xsl:otherwise 元素的内容。如果没有 xsl:when 元素为真，并且没有 xsl:otherwise 元素存在，则不会创建任何内容。

来自：[http ://www.w3.org/TR/xslt#section-Conditional-Processing-with-xsl:choose](http://www.w3.org/TR/xslt#section-Conditional-Processing-with-xsl:choose)

你不能让它通过其他类似的条件。如果您需要跌倒，只需将其转换为一组`<xsl:if>`跟随

**更新**。[这是 O'Reilly 的 XSLT 书 ( http://docstore.mik.ua/orelly/xml/xslt/ch04_02.htm](http://docstore.mik.ua/orelly/xml/xslt/ch04_02.htm) )的引述：

> C、C++ 和 Java 的 switch 语句大致相当于元素。一个例外是过程语言倾向于使用贯穿处理。换句话说，如果 switch 语句的一个分支的计算结果为 true，则运行时会执行所有操作，直到遇到 break 语句，即使其中一些代码是其他分支的一部分。该元素不能那样工作。如果给定的评估结果为真，则仅评估内部的语句

# c# - 数据表连接或合并

> ID：10194566
> 
> 赞同：1
> 
> 时间：2012-04-17T15:49:24.297
> 
> 标签：c#, datatable, dataset

我有 3 个数据表，其中填充了数据集和表适配器/绑定源，我需要运行 Join 查询或找到另一种获取特定数据的方法。（数据集包含列出的每个表）

表：

产品表：

```
Prod_ID    Name    

1          tv
2          couch 
```

消费者表：

```
Con_Id    Name    City
----------------------
1         Gray    New York
2         Joe     Chicago
3         Steve   Madison 
```

交易表

```
Tran_Id   Con_ID    Prod_ID    Price
-------------------------------------
1         2         1          900
2         1         2          300 
```

给定一个产品名称，我需要用每个不同的城市以及该产品在该城市的售价填充一个表格（将该产品的所有价格添加到给定城市的任何消费者）

我真的很难过，找不到办法。（我试过很多）请帮忙，谢谢！

到目前为止，Nudiers 的方法是：

```
 DataRelation relation = null;
            DataColumn table1Column = null;
            DataColumn table2Column = null;
            DataColumn table3Column = null;

            table1Column = tlobergeDataSet.Tb_Product.Columns[0];
            table2Column = tlobergeDataSet.Tb_Transactions.Columns[3];
            table3Column = tlobergeDataSet.Tb_Consumer.Columns[0];

            relation = new DataRelation("relation", table1Column, table2Column);
            tlobergeDataSet.Relations.Add(relation); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T10:30:27.383

```
 public DataTable MergeTables(DataTable dtFirst, DataTable dtSecond, string CommonColumn)
    {
        DataTable dtResults = dtFirst.Clone();
        int count = 0;
        for (int i = 0; i < dtSecond.Columns.Count; i++)
        {
            if (!dtFirst.Columns.Contains(dtSecond.Columns[i].ColumnName))
            {
                dtResults.Columns.Add(dtSecond.Columns[i].ColumnName, dtSecond.Columns[i].DataType);
                count++;
            }
        }

        DataColumn[] columns = new DataColumn[count];
        int j = 0;
        for (int i = 0; i < dtSecond.Columns.Count; i++)
        {
            if (!dtFirst.Columns.Contains(dtSecond.Columns[i].ColumnName))
            {
                columns[j++] = new DataColumn(dtSecond.Columns[i].ColumnName, dtSecond.Columns[i].DataType);
            }
        }

        dtResults.BeginLoadData();
        foreach (DataRow dr in dtFirst.Rows)
        {
            dtResults.Rows.Add(dr.ItemArray);
        }
        foreach (DataRow dr in dtSecond.Rows)
        {
            foreach (DataRow dr1 in dtResults.Rows)
            {
                if (dr1[CommonColumn].ToString().Equals(dr[CommonColumn].ToString()))
                {
                    foreach (DataColumn c in columns)
                    {
                        dr1[c.ColumnName] = dr[c.ColumnName];
                    }
                }
            }
        }
        dtResults.EndLoadData();
        return dtResults;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:09:17.547

试试这个。

```
DataRelation relation = null;
DataColumn table1Column = null;
DataColumn table2Column = null;
//retrieve column
table1Column = ds.Tables("Table1").Columns(0);
table2Column = ds.Tables("table2").Columns(0);
//relating tables
relation = new DataRelation("relation", table1Column, table2Column);
//assign relation to dataset
ds.Relations.Add(relation); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T16:46:47.280

您只能在 DataRelation 对象中关联两个表，并且从数据集中访问数据很简单，因为数据已经关联。

```
 DataRelation relation = null;
        DataColumn table1Column = null;
        DataColumn table2Column = null;
        DataColumn table3Column = null;

        table1Column = tlobergeDataSet.Tb_Product.Columns[0];
        table2Column = tlobergeDataSet.Tb_Transactions.Columns[2];
        table2Column1 = tlobergeDataSet.Tb_Transactions.Columns[1];
        table3Column = tlobergeDataSet.Tb_Consumer.Columns[0];

        relation = new DataRelation("relation", table1Column, table2Column);
        tlobergeDataSet.Relations.Add(relation);

       relation = new DataRelation("relation1", table3Column , table2Column1);
       tlobergeDataSet.Relations.Add(relation); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T16:00:18.357

在 LINQ 中，您可以使用如下语法连接表以查找所需的数据：

```
from a in keyTable
join b in anotherTable on a.Key equals b.Key
join c in aThirdTable on a.Key equals c.Key
select new
{
    // Anonymous Object Properties using identifier a, b, and c to get data
}; 
```

您应该能够获取该片段并生成一个 linq 查询，该查询将生成一个包含您需要的特定数据表示的匿名对象。

# python - 如何在不使用 python 进行身份验证的情况下获取 HTTP 标头信息？

> ID：10194568
> 
> 赞同：0
> 
> 时间：2012-04-17T15:49:30.287
> 
> 标签：python, http, authentication, http-headers

我正在尝试编写一个仅显示网站标题信息的小程序。这是代码：

```
import urllib2

url = 'http://some.ip.add.ress/'

request = urllib2.Request(url)

try:
    html = urllib2.urlopen(request)
except urllib2.URLError, e:
    print e.code
else:
    print html.info() 
```

如果 'some.ip.add.ress' 是 google.com，则返回标头信息没有问题。但是，如果它是一个需要在访问之前进行基本身份验证的 IP 地址，那么它会返回 401。有没有办法在没有身份验证的情况下获取标头（或任何其他）信息？

* * *

**我已经解决了。**

由于未经授权的访问而尝试失败后，以下修改将打印标题信息：

```
print e.info() 
```

*代替：*

```
print e.code() 
```

谢谢你看:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:03:38.207

如果你只想要标题，而不是 using `urllib2`，你应该去更低的级别并使用[`httplib`](http://docs.python.org/library/httplib.html)

```
import httplib
conn = httplib.HTTPConnection(host)
conn.request("HEAD", path)
print conn.getresponse().getheaders() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:33:18.633

如果您想要的只是 HTTP 标头，那么您不应该提出`HEAD`请求`GET`。[您可以通过使用 urllib2 阅读 Python-HEAD 请求](https://stackoverflow.com/questions/4421170/)来了解如何执行此操作。

# solr - 在 SOLR 中查找部分单词的匹配项

> ID：10194569
> 
> 赞同：0
> 
> 时间：2012-04-17T15:49:30.173
> 
> 标签：solr, filter, lucene, stringtokenizer, solr-query-syntax

我有一个值为“holmes@sible.com”的字段，
如果我搜索“sible”，我想取回这个字段。
我使用 ngrams 过滤器，只有当字符串是“sible@holmes.com”时才会有帮助，
我应该为这样的事情使用哪些过滤器/标记器（几乎是 sql 中的 LIKE）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T18:06:19.527

EdgeNGramFilterFactory 仅当字符串为“sible@holmes.com”时才会有所帮助，但 NGramFilterFactory 也会通过“holmes@sible.com”获得您想要的。

# iphone - 如何在没有陀螺仪的设备上创建 CMRotationMatrix

> ID：10194570
> 
> 赞同：2
> 
> 时间：2012-04-17T15:49:31.787
> 
> 标签：iphone, math, accelerometer, augmented-reality, core-motion

我想在 iPhone 上创建一个增强现实视图。作为起点，我看了一下 Apple 的 park 演示项目。然而，deviceMotion 属性用于获取旋转矩阵以进行相机变换。但是由于 deviceMotion 使用陀螺仪（在 iPhone 4 和更新版本上可用）并且我也想支持 3GS（事实上，3GS 是我唯一的开发设备），我不能使用这种方法。所以我想使用加速度计和指南针提供的数据自己创建旋转矩阵。

不幸的是，我自己缺乏这样做的数学技能。环顾四周，在我看来，[这](http://rouel-projects.blogspot.de/p/calculations-with-iphones.html)是与我的问题最相关的动手指南，但在实施之后似乎并没有适应我的问题（POI 视图只是暂时出现，而且似乎更多是由于设备移动而不是它的标题；我在下面发布了我的 onDisplayLink 方法（唯一有重大变化的方法）。我试图阅读相关的数学知识，但在这一点上，我对它的了解还不够，无法自行找到方法或在我的代码中找到错误。请问有什么帮助吗？

*编辑：*我已经认识到传感器数据应该更好地存储在双精度中而不是整数中，并添加了一些平滑。现在我可以更清楚地看到在设备旋转时应该从侧面出现的 POI 是如何从上面下来的。也许这有助于指出问题所在。

```
CMAccelerometerData* orientation = motionManager.accelerometerData;
CMAcceleration acceleration = orientation.acceleration;

vec4f_t normalizedAccelerometer;
vec4f_t normalizedMagnetometer;

xG = (acceleration.x * kFilteringFactor) + (xG * (1.0 - kFilteringFactor));
yG = (acceleration.y * kFilteringFactor) + (yG * (1.0 - kFilteringFactor));
zG = (acceleration.z * kFilteringFactor) + (zG * (1.0 - kFilteringFactor));

xB = (heading.x * kFilteringFactor) + (xB * (1.0 - kFilteringFactor));
yB = (heading.y * kFilteringFactor) + (yB * (1.0 - kFilteringFactor));
zB = (heading.z * kFilteringFactor) + (zB * (1.0 - kFilteringFactor));

double accelerometerMagnitude = sqrt(pow(xG, 2) + pow(yG, 2) + pow(zG, 2));
double magnetometerMagnitude = sqrt(pow(xB, 2) + pow(yB, 2) + pow(zB, 2));

normalizedAccelerometer[0] = xG/accelerometerMagnitude;
normalizedAccelerometer[1] = yG/accelerometerMagnitude;
normalizedAccelerometer[2] = zG/accelerometerMagnitude;
normalizedAccelerometer[3] = 1.0f;

normalizedMagnetometer[0] = xB/magnetometerMagnitude;
normalizedMagnetometer[1] = yB/magnetometerMagnitude;
normalizedMagnetometer[2] = zB/magnetometerMagnitude;
normalizedMagnetometer[3] = 1.0f;

vec4f_t eastDirection;

eastDirection[0] = normalizedAccelerometer[1] * normalizedMagnetometer[2] - normalizedAccelerometer[2] * normalizedMagnetometer[1];
eastDirection[1] = normalizedAccelerometer[0] * normalizedMagnetometer[2] - normalizedAccelerometer[2] * normalizedMagnetometer[0];
eastDirection[2] = normalizedAccelerometer[0] * normalizedMagnetometer[1] - normalizedAccelerometer[1] * normalizedMagnetometer[0];
eastDirection[3] = 1.0f;

double eastDirectionMagnitude = sqrt(pow(eastDirection[0], 2) + pow(eastDirection[1], 2) + pow(eastDirection[2], 2));

vec4f_t normalizedEastDirection;

normalizedEastDirection[0] = eastDirection[0]/eastDirectionMagnitude;
normalizedEastDirection[1] = eastDirection[1]/eastDirectionMagnitude;
normalizedEastDirection[2] = eastDirection[2]/eastDirectionMagnitude;
normalizedEastDirection[3] = 1.0f;

vec4f_t northDirection;

northDirection[0] = (pow(normalizedAccelerometer[0], 2) + pow(normalizedAccelerometer[1],2) + pow(normalizedAccelerometer[2],2)) * xB - (normalizedAccelerometer[0] * xB + normalizedAccelerometer[1] * yB + normalizedAccelerometer[2] * zB)*normalizedAccelerometer[0];
northDirection[1] = (pow(normalizedAccelerometer[0], 2) + pow(normalizedAccelerometer[1],2) + pow(normalizedAccelerometer[2],2)) * yB - (normalizedAccelerometer[0] * xB + normalizedAccelerometer[1] * yB + normalizedAccelerometer[2] * zB)*normalizedAccelerometer[1];
northDirection[2] = (pow(normalizedAccelerometer[0], 2) + pow(normalizedAccelerometer[1],2) + pow(normalizedAccelerometer[2],2)) * zB - (normalizedAccelerometer[0] * xB + normalizedAccelerometer[1] * yB + normalizedAccelerometer[2] * zB)*normalizedAccelerometer[2];
northDirection[3] = 1.0f;

double northDirectionMagnitude;

northDirectionMagnitude = sqrt(pow(northDirection[0], 2) + pow(northDirection[1], 2) + pow(northDirection[2], 2));

vec4f_t normalizedNorthDirection;

normalizedNorthDirection[0] = northDirection[0]/northDirectionMagnitude;
normalizedNorthDirection[1] = northDirection[1]/northDirectionMagnitude;
normalizedNorthDirection[2] = northDirection[2]/northDirectionMagnitude;
normalizedNorthDirection[3] = 1.0f;

CMRotationMatrix r;
r.m11 = normalizedEastDirection[0];
r.m21 = normalizedEastDirection[1];
r.m31 = normalizedEastDirection[2];
r.m12 = normalizedNorthDirection[0];
r.m22 = normalizedNorthDirection[1];
r.m32 = normalizedNorthDirection[2];
r.m13 = normalizedAccelerometer[0];
r.m23 = normalizedAccelerometer[1];
r.m33 = normalizedAccelerometer[2];

transformFromCMRotationMatrix(cameraTransform, &r);

[self setNeedsDisplay]; 
```

当设备放在桌子上并且大致（使用 Compass.app）指向北方时，我会记录以下数据：

```
Accelerometer: x: -0.016692, y: 0.060852, z: -0.998007
Magnetometer: x: -0.016099, y: 0.256711, z: -0.966354
North Direction x: 0.011472, y: 8.561041, z:0.521807
Normalized North Direction x: 0.001338, y: 0.998147, z:0.060838
East Direction x: 0.197395, y: 0.000063, z:-0.003305
Normalized East Direction x: 0.999860, y: 0.000319, z:-0.016742 
```

这看起来很理智吗？

*编辑 2：*我已将 r 的分配更新为显然使我达到目标的一半：当设备直立时，我现在看到水平面附近的地标；但是，它们与预期位置相差约 90º。此外，Beta 建议的移动后的输出：

```
Accelerometer: x: 0.074289, y: -0.997192, z: -0.009475
Magnetometer: x: 0.031341, y: -0.986382, z: -0.161458
North Direction x: -1.428996, y: -0.057306, z:-5.172881
Normalized North Direction x: -0.266259, y: -0.010678, z:-0.963842
East Direction x: 0.151658, y: -0.011698, z:-0.042025
Normalized East Direction x: 0.961034, y: -0.074126, z:-0.266305 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T09:12:37.143

拿到 iPhone 4 后，我能够将上面代码生成的数据与 CoreMotion 姿态数据的输出进行比较。有了这个，我发现我应该以下列方式将值分配给我的旋转矩阵：

```
CMRotationMatrix r;
r.m11 = normalizedNorthDirection[0];
r.m21 = normalizedNorthDirection[1];
r.m31 = normalizedNorthDirection[2];
r.m12 = 0 - normalizedEastDirection[0];
r.m22 = normalizedEastDirection[1];
r.m32 = 0 - normalizedEastDirection[2];
r.m13 = 0 - normalizedAccelerometer[0];
r.m23 = 0 - normalizedAccelerometer[1];
r.m33 = 0 - normalizedAccelerometer[2]; 
```

这给出了大致相似的值，但 CoreMotion 使用陀螺仪生成的数据当然要好得多。无论如何，这是合理支持 3GS 的起点。也许可以通过某种过滤获得额外的质量，但我还没有决定这是否值得付出努力。

# javascript - 你把 ajax 回调脚本代码放在 rails 3.1 的什么地方？

> ID：10194577
> 
> 赞同：1
> 
> 时间：2012-04-17T15:49:45.880
> 
> 标签：javascript, ruby-on-rails, ajax

我很困惑，我必须在rails 3.1中放置ajax回调，触发事件beforSend，向用户显示字符串“请等一下”，并在成功发生时隐藏此字符串。

```
= javascript_tag "$('#form_remote').bind('ajax:beforSend', function() {$("#mess").show();});"
%div{:id => 'mess', :style=>"display:none;"} Wait,please
= form_tag filling_schedule_of_workings_path, :remote => true, :html=>{:id => 'form_remote'} do
  %p{:style=>"margin:0;width:100%"}
    = label_tag 'C '
    = text_field_tag 'date_begin',nil,:size => 10
    = label_tag 'по'
    = text_field_tag 'date_end',nil,:size => 10
  %br
  %p{:style=>"margin:0;width:100%"}
    = label_tag 'Schedule class'
    = select_tag 'classifier_schedule',@classifier_schedule,:style=>"width:200px;"
  %p{:style=>"margin:0;width:100%"}
    = label_tag 'Schedule number'
    = select_tag 'schedule_number',@schedule_number,:style=>"width:200px;"
  %div{:style=>"height:25px;border-top:1px solid #CCC;margin:5px 0;"}
    = submit_tag "Doing", :style => "float:right;" 
```

这是正常的吗？

请帮忙！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:55:35.493

我认为这不需要在您的 HAML 代码中，我通常解决此问题的方法是在主应用程序 JS 文件中注册这些事件。例如，如果您希望在 AJAX 事件开始时出现请等待操作，则可以执行以下操作：

```
 /* Display a scrim to prevent mouse clicks when an ajax event is occurring. */
$.ajaxPrefilter(function(options, originalOptions, jqXHR) {
    if (!$('#progressIndicator').is(":visible")) {
        $('#progressIndicator').show();
    }
});
$('head').ajaxStop(function() {
    $('#progressIndicator').hide();
});

$('head').ajaxComplete(function(event, request, settings) {
    $('#progressIndicator').hide();
}); 
```

# c# - 使用带有 C# .NET WinForms 和 WPF 应用程序的自定义格式字符串将财务数据（如“2,000”）格式化为“2M”

> ID：10194578
> 
> 赞同：0
> 
> 时间：2012-04-17T15:49:49.137
> 
> 标签：c#, .net, wpf, string, format

我们想知道是否有一种方法可以将诸如“2,000”和“2,000,000”之类的财务数据分别格式化为“2M”和“2MM”——本质上是用 M 代替 1000。

理想情况下，我们可以使用一个格式字符串，这样 2000.0.ToString("X") 会返回“2M”，反之亦然。这样的格式字符串存在吗？如果没有 - 是否可以创建一个？

请注意，这些格式字符串有效：

```
#,#,M – this will convert 2,000 to 2M (and back)
#,#,,MM – this will convert 2,000,00 to 2MM (and back)
#,#,,,B – this will convert 2,000,000,000 to 2B (and back) 
```

然而，我们需要一些更动态的东西——如果可能的话，它可以检测它是否是这些值中的任何一个，并且可以应用适当的格式字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T15:55:35.993

我不知道实现您想要的格式。但是，您可以使用接口实现自己的接口[`IFormatProvider`](http://msdn.microsoft.com/en-us/library/system.iformatprovider.aspx)并将[`ICustomFormatter`](http://msdn.microsoft.com/en-us/library/system.icustomformatter.aspx)其传递给`Format()`and`ToString()`调用。

# php - 数组的未定义索引

> ID：10194579
> 
> 赞同：-1
> 
> 时间：2012-04-17T15:49:54.370
> 
> 标签：php, undefined-index

我试图弄清楚为什么我在这一行的视图中得到一个未定义的索引：

```
<?php if ($allies[''] == 'No Wrestlers In Database') { 
```

控制器：

```
if (empty($rosterList)) {
        $allies[] = 'No Wrestlers In Database';
}
else
{
        $allies[] = 'Please Select An Option';
        foreach ($rosterList AS $ally)
        {
            $allies[$ally->id] = $ally->rosterName;
        }
} 
```

看法：

```
<?php if ($allies[''] == 'No Wrestlers In Database') {
    echo $allies[''];
}
else {
    echo form_dropdown( 'ally1', $allies, $alliesList->ally1ID);
} ?> 
```

**编辑 ：**

我试图弄清楚为什么我的第一个下拉列表没有显示正确的值。盟友列表 print_r

```
Array
(
[0] => stdClass Object
    (
        [id] => 1
        [rosterListID] => 1
        [ally1ID] => 2
        [ally2ID] => 3
        [ally3ID] => 2
        [ally4ID] => 3
        [ally5ID] => 2
    )

) 
```

盟友 print_r

```
Array
(
[0] => Please Select An Option
[1] => Kid Wonder
[3] => Oriel
[2] => Test Character
 ) 
```

编辑2：

这是我所做的，但在我的视图文件中出现错误，说试图获取非对象的属性。

```
//Get member's allies
    $alliesList = $this->bios->getRosterAlliesByRosterID($this->session->userdata('defaultRosterListID'));
    echo "<pre>";
    print_r($alliesList);
    echo "</pre>";
    // Get list of members
    $rosterList = $this->bios->getAllRoster();
    $allies = array();
    if (empty($rosterList)) {
        $allies[''] = 'No Wrestlers In Database';
    }
    else
    {
        $allies[''] = 'Please Select An Option';
        foreach ($rosterList AS $ally)
        {
            $allies[$ally->id] = $ally->rosterName;
        }
    }
    echo "<pre>";
    print_r($alliesList);
    echo "</pre>";  

<?php echo form_label( 'Ally 1', 'ally1'); ?>
<div>
    <?php if (in_array('No Wrestlers In Database', $allies)) {
         echo 'No Wrestlers In Database';
    }
    else {
         echo form_dropdown( 'ally1', $allies, $alliesList->ally1ID);
    } ?>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:51:32.830

因为在赋值时，赋值索引在数组中从0递增到n。所以，你需要这个：

```
 if ($allies[0] == 'No Wrestlers In Database') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T15:51:44.793

使用 $arr[] 不会为键 '' 创建值，而是在数组尾部推送元素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T16:09:52.393

您对数组声明有误解。

$allies[''] 不等于 $allies[]

**$allies[]**用于将对象附加到数组的末尾。键将自动递增。

**$allies['']**，这个， '' 是一个字符串，因此，您的值将保存到带有键 '' 的数组中

[您可以在此处](http://www.php.net/manual/en/language.types.array.php)阅读有关数组键的更多信息

> **键可以是整数或字符串**。该值可以是任何类型。
> 
> **包含有效整数的字符串**将被转换为整数类型。例如，键“8”实际上将存储在 8 下。另一方面，“08”不会被强制转换，因为它不是有效的十进制整数。
> 
> **Null**将被强制转换为空字符串，即键 null 将实际存储在 "" 下。

如果您真的希望它显示，您可以将控制器 **$allies[]**更改为**$allies['']**

如果您想查看“数据库中没有摔跤手”是否在您的数组中，您必须使用**in_array()**函数。

# javascript - add(1)(2)(3).total === 6 - 有没有其他人见过这样使用自返回函数？

> ID：10194592
> 
> 赞同：10
> 
> 时间：2012-04-17T15:50:30.290
> 
> 标签：javascript

以下代码有效，虽然我理解它为什么有效，但我在任何地方都没有看到它。我认为这是因为所有其他设计模式都好得多。

我仍然希望将这个例子视为一个警示故事，但我没有。

当然，这很糟糕，尤其是下面我选择的示例，因为它的作用很清楚，但是：

这种模式叫什么？

是常用的吗？

有没有使用这种模式的合法项目？

```
var add = function container (val) {

  addFunc = function f (val, undefined) {
  addFunc.total += val;
  return addFunc;
  };

addFunc.total = 0;

return addFunc(val);
};

alert(add(1)(2)(3).total);
alert(add(1)(2)(33).total); 
```

编辑：变量名称更改，以便代码在 IE 中工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T16:17:16.690

这是一个称为[currying](http://en.wikipedia.org/wiki/Currying)的函数式编程概念。

本质上，给定 a`function foo(a, b, c)`你创建一个`function bar(a)`返回`function bar2(b)`的返回`function bar3(c)`给出最终答案的返回。

从技术上讲，这不是真正的柯里化，因为它无限地进行并使用副作用（`total`属性）来打破无限循环。

但无论如何，这种模式可能会有一些有用的应用。它对于遍历树结构特别有用，在这种结构中，您要为树的每个叶子计算一些结果，结果取决于该叶子的祖先。您在根节点上运行 curried 函数，然后在每个子节点上运行返回的函数，然后对每个子节点等运行。如果运行的节点有子节点，纯 curried 函数将返回另一个函数，并且如果您到达叶子，将返回所需的值。

代码将是一个简单的递归函数，它向自身传递一个新的“根”节点和解析它的函数，它总是接受一个参数。

但是，这里使用它的方式看起来更像是一种学习练习，而不是有用的东西。

编辑：如果你想让它成为一个纯柯里化函数但仍然具有准无限递归，则输入数据需要提供停止信息（就像 C 字符串使用值`0x00`来定义一样`EOF`）：

```
var add = (function() {
    var total = 0;
    return function nextAdd(a) {
        if(a != null) {
            total += a;
            return nextAdd;
        } else {
            return total;
        }
    };
})(); 
```

然后，`add(1)(2)(3)(null) === 6`没有`.total`副作用参数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T15:54:37.143

从技术上讲，这可以被认为是链接或封装。

当您可以无限期地执行一组操作时，您可以链接原始功能。当您可以链接调用以设置原始选择器的属性和属性时，jQuery 使用这种形式。在这种情况下，创建者希望能够链接调用 add 而不必重新键入函数名称。不是最干净的想法，但有效。

此外，由于代码的实际主体从未暴露给调用者，因此这也可以视为封装，因为该`addFunc`方法没有暴露给外部范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T16:13:43.020

这被称为柯里化[^(维基百科)](http://en.wikipedia.org/wiki/Currying)。来自 Haskell Curry[^(维基百科)](http://en.wikipedia.org/wiki/Haskell_Curry)的名称（但最初由 Moses Ilyich Schönfinkel[^(维基百科)](http://en.wikipedia.org/wiki/Moses_Sch%C3%B6nfinkel)开发）。

> 一种转换具有多个参数（或参数的 n 元组）的函数的技术，使得它可以被称为一个函数链，每个函数都有一个参数（部分应用）。

来自2010 年[的 JavaScript 模式](https://rads.stackoverflow.com/amzn/click/com/0596806752)：

> 何时使用柯里化 - 当你发现自己调用相同的函数并传递大部分相同的参数时，那么该函数可能是柯里化的一个很好的候选者。您可以通过将一组参数部分应用于您的函数来动态创建一个新函数。新函数将保存重复的参数（因此您不必每次都传递它们）并将使用它们来预填充原始函数期望的完整参数列表。

来自达斯汀迪亚兹的另[一篇关于咖喱的文章。](http://www.dustindiaz.com/javascript-curry/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T15:54:51.060

你会变得更好：

```
function add() {
    var l = arguments.length, i, sum = 0;
    for( i=0; i<l; i++) sum += arguments[i];
    return sum;
}
alert(add(1,2,3)); // 6 
```

确实，您所询问的代码样式应该没有理由。我没有看到任何合法的使用，只有任意`arguments`长度。

# asp.net - 是否可以在 createuserwizard 中的创建用户向导步骤按钮（上一个、下一个、完成等）下方添加一些文本或一些标签？

> ID：10194593
> 
> 赞同：0
> 
> 时间：2012-04-17T15:50:32.370
> 
> 标签：asp.net, .net

```
enter code here`<asp:WizardStep ID="CreateUserWizardStep0" runat="server" StepType="Start">
              <h1>Bir Hesap Seçin</h1>
            <table>
              <tr>
                <td>
                  <asp:Label ID="AccountNameLabel" CssClass="grey" runat="server" AssociatedControlID="SearchAccount" > 
              Kullanıcı Adı:</asp:Label>
                </td>               
              </tr>
              <tr>
                <td>
                  <asp:TextBox ID="SearchAccount" CssClass="field" runat="server"></asp:TextBox>
                  <asp:RequiredFieldValidator Visible="true" ID="RequiredFieldValidator1" ControlToValidate="SearchAccount" Display="None" ValidationGroup="kayitFormu"  runat="server" ErrorMessage="Girmiş Olduğunuz Hesap Adı Kullanımdadır. Lütfen farklı bir hesap adı deneyiniz."></asp:RequiredFieldValidator>
                  </td>
              </tr>
              <tr>
                <td>
                  <asp:Label ID="SearchAccountMessage" style="width:400px;" runat="server" ForeColor="red" />
                </td>
              </tr>
            </table>

       </asp:WizardStep>` 
```

是否可以在 createuserwizard 中的创建用户向导步骤按钮（上一个、下一个、完成等）下方添加一些文本或一些标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:54:08.640

看看`StepNavigationTemplate`。这个[网站](http://weblogs.asp.net/grantbarrington/archive/2009/11/04/adding-changing-amp-finding-buttons-in-the-asp-net-wizard-control.aspx)应该有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:51:12.537

我不确定这是否是您要查找的内容，但您可以使用导航模板：

```
<StartNavigationTemplate>
    <asp:Button ID="btnStepNext" runat="server" Text="Next" Width="110" CommandName="MoveNext" CausesValidation="true" />                                                 
</StartNavigationTemplate>               
<StepNavigationTemplate>                   
    <asp:Button ID="btnStepPrevious" runat="server" Text="Previous" Width="110" CommandName="MovePrevious" CausesValidation="false" />
    <asp:Button ID="btnStepNext" runat="server" Text="Next" Width="110" CommandName="MoveNext" CausesValidation="true" />                                                                                                                                                                                                                                                         
</StepNavigationTemplate>
<FinishNavigationTemplate>                                                                          
    <asp:Button ID="btnStepPrevious" runat="server" Text="Previous" Width="110" CommandName="MovePrevious" CausesValidation="false" />
    <asp:Button ID="btnStepFinish" runat="server" Text="Finish" Width="120" CommandName="MoveComplete" CausesValidation="true" />                                                                           
</FinishNavigationTemplate> 
```

# .net - 在WPF中检测鼠标下的儿童控件

> ID：10194606
> 
> 赞同：2
> 
> 时间：2012-04-17T15:50:56.037
> 
> 标签：.net, wpf, vb.net, wpf-controls

我有一个 WPF`ParentUserControl`和一些`ChildUserControlA` `ChildUserControlB`等等（还有 WPF 控件）

s 是控件，其中`ChildUserControl`包含一些其他基本元素（文本框、标签等）

在主窗体的状态栏中，我需要显示当前鼠标悬停的*ChildUserControl*的名称。

因此，在*ParentUserControl*的 MouseMove 中，我获得了一个对象`myElement = Mouse.DirectlyOver`，因为我需要最上面的**ChildUserControl**，但我获得了一个 'System.Windows.Controls.TextBlock'（ChildUserControl 的一部分）......

如何解决？

当我将鼠标悬停在 MyChildControl 上时，我需要检测到 MyChildControl，而不是它的子元素。

按照这个顺序，我在 MyChildControl 上使用了以下内容：

```
Protected Overrides Function HitTestCore(
                    hitTestParameters As PointHitTestParameters) As HitTestResult

    Return New PointHitTestResult(Me, hitTestParameters.HitPoint)
End Function 
```

但无论如何我有时会得到文本块，有时会得到 ChildUserControl ......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:43:06.887

您需要实施[Hit-Testing](http://en.wikipedia.org/wiki/Hit-testing)。因此，如果您想获取区域内的所有元素，您可以使用[HitTestResultCallback](http://msdn.microsoft.com/en-us/library/system.windows.media.hittestresultcallback%28v=vs.90%29.aspx)。一个例子：

```
Dim Elements As New List(Of FrameworkElement)

Public Function GetVisuals(ByVal Region As Geometry) As List(Of FrameworkElement)

    If Region Is Nothing Then Return Nothing

    Dim Parameters As New GeometryHitTestParameters(Region)
    Elements.Clear()

    Dim Callback As New HitTestResultCallback(AddressOf Me.HitTestCallBack)
    VisualTreeHelper.HitTest(Me.ParentUserControl, Nothing, Callback, Parameters)

    Return Me.Elements

End Function

Private Function HitTestCallBack(ByVal Result As HitTestResult) As HitTestResultBehavior

    If Result IsNot Nothing Then

        Dim GeometryRes As GeometryHitTestResult = CType(Result, GeometryHitTestResult)
        Dim Element As FrameworkElement = TryCast(Result.VisualHit, FrameworkElement)

        If Element IsNot Nothing AndAlso GeometryRes.IntersectionDetail = IntersectionDetail.FullyContains Then
            Me.Elements.Add(Element)
        End If

    End If

    Return HitTestResultBehavior.Continue

End Function 
```

这样，Elements 列表包含了[GeometryHitTestResult.IntersectionDetail](http://msdn.microsoft.com/en-us/library/system.windows.media.geometryhittestresult.intersectiondetail%28v=vs.90%29.aspx)指定的所有元素，如果您想（例如）知道鼠标位置（MouseDown 事件）下的元素，只需这样做：

```
Dim Region As New RectangleGeometry(New Rect(e.GetPosition(Me.MyGrid), New Size(1, 1)))
Dim Elements As List(Of FrameworkElement) = Me.GetVisuals(Region) 
```

这就是我在评论中的意思：

```
Public Class DrawingCanvas
Inherits Panel

Public Function GetVisuals(ByVal Region As Geometry) As List(Of DrawingVisual)
End Function

Private Function HitTestCallBack(ByVal Result As HitTestResult) As HitTestResultBehavior
End Function

End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:53:44.650

另一个答案可能是这样的 - 定义您关心的对象的确切类型并处理视觉树，直到找到它们：

```
Private myTypes As New List(Of Type)()
Public Sub New()
    InitializeComponent()
    myTypes.Add(GetType(ComboBox))
    myTypes.Add(GetType(CheckBox))
    myTypes.Add(GetType(RadioButton))
    myTypes.Add(GetType(TabControl))
    myTypes.Add(GetType(Button))
    myTypes.Add(GetType(Label))
    myTypes.Add(GetType(GroupBox))
    myTypes.Add(GetType(Window))
End Sub

Private Sub Window_MouseMove(sender As Object, e As MouseEventArgs)
    Dim x As DependencyObject = _
      DirectCast(e.MouseDevice.DirectlyOver, DependencyObject)
    Dim t As Type = x.GetType
    While Not myTypes.Contains(t)
         x = VisualTreeHelper.GetParent(x)
         If x Is Nothing Then Exit While
         t = x.GetType
    End While

    If x IsNot Nothing Then
          Console.WriteLine(x.ToString())
    Else
          Console.WriteLine("Nothing")
    End If
End Sub 
```

# php - Team Foundation Server / TEE 签入到文件夹

> ID：10194609
> 
> 赞同：1
> 
> 时间：2012-04-17T15:51:01.170
> 
> 标签：php, eclipse, tfs, tfsbuild, team-explorer-everywhere

我利用 Eclipse 和 Team Explorer Everywhere 连接到 Team Foundation Server，其主要目的是充当我的 PHP 应用程序的存储库。

我不想在签入时运行构建，而是让 TFS 将文件的最新副本转储到指定的文件夹，而不进行构建。

这个动作可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T19:17:32.397

您可以修改构建模板\脚本以仅执行复制操作。

# asp.net - 从 ASP.net Web 服务返回大量数据时，有哪些好的做法？

> ID：10194610
> 
> 赞同：4
> 
> 时间：2012-04-17T15:51:13.290
> 
> 标签：asp.net, mysql, web-services

我目前正在为我们的客户开发一些网络服务。在我们将其提供给他们之前，我们希望优化数据库调用的性能，因为可能会返回非常大量的数据。（可能是数万个对象，可能是数百万个对象，每个对象包含大约 12 个其他对象列表）

我们不想给我们的服务器带来压力，也不想不必要地限制网络服务。

Web 服务方法之一返回指定日期范围内的所有数据，我在想如果返回的数据量大于设定的量，则返回一条消息，如下所示：

“数据太大，请缩小日期范围”

像这样限制用户的范围是个好主意吗？

我必须限制我们的客户一次可以检索的数据量，但仍然尽可能方便他们。我的意思是，他们也是程序员，所以它不必太简单，但足够简单易用。

通过 Web 服务返回大量数据有哪些好的做法？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T16:03:13.007

您可能能够适应在列表或网格中显示的分页数据的常用技术。对数据库的调用指定要返回的记录数和页码。

因此，例如，如果他们在一个页面上显示 10 条记录，则只会返回 10 条记录以供显示。第 1 页返回记录 1 - 10（或 0 - 9，如果您愿意），第 2 页返回 11 - 20，依此类推。

还经常返回可用记录的总数。

这样，用户可以继续滚动浏览大量记录，或者他们可以选择细化他们的搜索条件以产生更小的结果集。

您可以为您的 Web 服务考虑这种**分页或分块**方法。Web 服务调用提供要在每个块中发送的记录数，以及“页面”或“块”编号。Web 服务返回请求的记录以及可用记录的总数。

使用这种方法，使用 Web 服务的开发人员仍然可以控制。

调用代码可以放置在一个循环中，以便它继续请求块，如果该行为是可取的。如果有人真的想要一卡车的记录，他们可以将记录数参数设置为一个非常大的数字（或者您可以将其设为可选参数，如果它为空、零、空则返回所有内容）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T16:05:18.177

这真的取决于你的需求。对我来说，这似乎更像是一个设计问题而不是编码问题，但在我们的系统中，我们有两种方法。我将分享它们给你一些想法来考虑。

*   在第一个中，我们是提供数据的人。我们允许客户在他们的账户上下载交易数据，对于一些客户来说，这可能是相当大的数据量。我们将它们限制为 X 天的数据，他们对此很好。

*   在第二个中，我们使用来自已建立供应商的 Web 服务的数据，该供应商跟踪车辆位置数据，以及我们的调度员和管理人员感兴趣的其他数据。我们车队中的每辆卡车都会定期更新其地理位置以及其他数据（装载/卸载/司机休息等）

    *   在这些 Web 服务中，我们请求一个日期范围，并且该服务返回一组记录限制（每次调用 1000 条记录）。
    *   除了传入日期范围之外，我们还传入一个“位置”整数字段。在第一次调用时，“位置”设置为零。
    *   Web 服务返回“更多数据存在”布尔字段。
    *   如果“更多数据存在”=true，那么我们再次调用 Web 服务，并增加“位置”参数，并重复直到“更多数据存在”=false（这是我们代码中的一个简单的 while 循环）

我认为第一个对于程序员或最终用户来说都很棒。第二个在与程序员打交道时效果很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T16:02:44.877

这听起来像是 Web 服务的潜在大量数据。

但这里有一个来自 MSDN 的页面，它讨论了设置服务器以发送/接收“大量”数据：http: [//msdn.microsoft.com/en-us/library/aa528822.aspx](http://msdn.microsoft.com/en-us/library/aa528822.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T16:03:32.623

您可以每次给他们一大块数据，例如 (1000 obj) 他们必须指定他们想要的起始索引和数据量，您只需使用它来提取数据。在 SQL 中有 TAKE 和 Skip 可以很容易地做到这一点。

# javascript - 将 JS 代码注入文本区域

> ID：10194613
> 
> 赞同：0
> 
> 时间：2012-04-17T15:51:17.393
> 
> 标签：javascript

我正在尝试在 textarea 中显示一些 JS 代码。代码是用 JS 生成的，所以我用 JS 将它注入到 textarea 中。但是，使用`<script>`标签会导致脚本执行。我认为 using`&lt;`可以解决这个问题，但这只是显示`&lt;`而不是`<`.

有什么建议我该怎么做？

```
$('myTextarea').set('value', '<script>alert('do something');</script>'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:54:10.987

只需将脚本标签分成两部分。

```
$('myTextarea').val('<script>alert("do something");</scr'+'ipt>'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:58:21.190

`</script>`打开块之后的下一个`<script>`关闭脚本块；它是否包含在 JS 字符串中。

要修复，您可以`</script>`像这样拆分；

```
$('myTextarea').set('value', '<script>alert('do something');</scr' + 'ipt>'); 
```

或者像这样（不太常见，但有效，而且可能更*正确*）；

```
$('myTextarea').set('value', '<script>alert('do something');<\/script>'); 
```

此外，您还需要修正报价；

```
$('myTextarea').set('value', '<script>alert(\'do something\');<\/script>'); 
```

你可以在这里看到这个现在工作：http: [//jsfiddle.net/pK9SK/](http://jsfiddle.net/pK9SK/)

# java - Dom4j - 元素的行号

> ID：10194616
> 
> 赞同：1
> 
> 时间：2012-04-17T15:51:23.517
> 
> 标签：java, dom4j, line-numbers

有谁知道如何获取文档中元素的行号？

我很欣赏这些信息在解析后可能不会存储在元素上（我查看过），但是在解析过程中是否有某种方法可以捕获每个元素的行号？然后我可以稍后使用查找从元素-> 行号。

# wcf - 使用 .Net、PHP 和 Delphi 客户端进行 WCF 用户名身份验证

> ID：10194631
> 
> 赞同：0
> 
> 时间：2012-04-17T15:52:07.770
> 
> 标签：wcf, authentication

我有一个托管在 IIS 中的 WCF 服务，我想使用用户名身份验证。我的客户是 .Net、PHP 和 Delphi。

我不想使用 SSL 或任何认证。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T13:50:44.740

根据您的评论，如果您愿意在服务器端提供证书，那么您想要做的事情非常简单。由 WCF 实现的 WS-Security 标准应该可供任何实现类似 Web 服务的接口的客户端使用。

对于基本的、简洁的用户名身份验证，只需最少的代码，您只需设置属性配置选项，例如：http: [//msdn.microsoft.com/en-us/library/ms752233.aspx](http://msdn.microsoft.com/en-us/library/ms752233.aspx)

如果您不想使用 Windows 用户名（您的问题在某种程度上暗示并非每个人都会拥有 Windows 用户名和/或密码），您可以提供一个自定义用户名提供程序来执行您想要的任何操作。设置如下所示的服务行为配置：

```
<serviceCredentials>
  <serviceCertificate findValue="localhost" storeLocation="LocalMachine"
    x509FindType="FindBySubjectName" />
  <userNameAuthentication userNamePasswordValidationMode="Custom" 
    customUserNamePasswordValidatorType="MyService.Auth, MyService" />
</serviceCredentials> 
```

然后构建一个执行此操作的类：

```
public class Auth : UserNamePasswordValidator
{
    public override void Validate(string userName, string password)
    {
    }
} 
```

`FaultException`如果验证失败，你应该从那个方法中抛出某种东西；否则 WCF 将假定组合成功。

# spring - Spring Roo“披萨店”应用程序中的数据访问失败

> ID：10194633
> 
> 赞同：0
> 
> 时间：2012-04-17T15:52:14.257
> 
> 标签：spring, spring-mvc, spring-roo

我按照 web 上的 Pizzashop 教程创建了一个简单的 spring roo 应用程序。当我尝试进行交易时，发生异常并出现消息“数据访问失败”。

当我运行“mvn tomcat:run”命令时，出现一条错误消息，指出 org.hibernate.tool.hbm2ddl.SchemaExport : Unsuccessfull

我使用mysql作为数据库。有人可以告诉我这个错误的原因吗？

先感谢您。

# jquery - 动画在第一次点击时无法正常工作

> ID：10194635
> 
> 赞同：2
> 
> 时间：2012-04-17T15:52:19.437
> 
> 标签：jquery

我有一段文本嵌套在 div 标签中，当点击链接时，它应该展开并淡入文本。问题是，初始点击不会触发动画，它只是淡入作为回调函数的文本。

想不通这个 其他经历过这个问题的人谈论填充和 CSS，但这里不是这种情况。

[http://jsfiddle.net/XPs2w/1/](http://jsfiddle.net/XPs2w/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T15:57:15.697

问题是您的 div 的内容是`display: none`在第一次点击时。这意味着您的 div 基本上没有内容，这意味着它没有高度。所以你是从 0 高度到 0 高度的动画。动画第一次运行后，内容淡入。现在有了内容，动画高度实际上做了一些事情。

有可能给它一个静态高度：

[http://jsfiddle.net/XPs2w/2/](http://jsfiddle.net/XPs2w/2/)

# windows-phone-7 - 如何在 wp7 silverlight 中播放视频（wmv 文件）

> ID：10194637
> 
> 赞同：0
> 
> 时间：2012-04-17T15:52:23.123
> 
> 标签：windows-phone-7, video

我想在我的应用中播放视频。我环顾四周，但没有任何帮助。我问用户是否想听他的手机音乐。如果单击确定，则音乐继续播放，否则音乐停止。从现在开始没问题。现在，我的问题是：我创建了一个网格来使用它，例如具有宽度和高度等的弹出窗口。当这个弹出窗口出现时，音乐停止。这就是为什么无法在市场上认证我的应用程序的原因。这是一个小代码：我相信很容易理解......请帮助！

```
public void new_grid(int v)
        {
            Grid gr = new Grid();
            gr.Background = new SolidColorBrush(Colors.Cyan);
            gr.Opacity = 1.0;
            gr.Width = 400;
            gr.Height = 600;
            // Create a white border.
            Border border = new Border();
            border.BorderBrush = new SolidColorBrush(Colors.White);
            border.BorderThickness = new Thickness(7.0);

            MediaElement video_ship = new MediaElement();
            //video_ship.AutoPlay = false;

            video_ship.Width = 400;
            video_ship.Height = 600;
            video_ship.VerticalAlignment = VerticalAlignment.Top;
            video_ship.HorizontalAlignment = HorizontalAlignment.Left;
            if (v == 1)
            {
                video_ship.Source = new Uri("videos/Lost_Ship.wmv", UriKind.RelativeOrAbsolute);
                //video_ship.Play();
                gr.Children.Add(video_ship);
            }
            else if (v == 2)
            {
                //video_ship.Source = "videos/Lost_Ship.wmv";
                video_ship.Source = new Uri("videos/you_are_on_fire.wmv", UriKind.RelativeOrAbsolute);
                //video_ship.Name = "fire";
                //video_ship.Play();
                gr.Children.Add(video_ship);
            }
            else if (v == 3)
            {
                //video_ship.SourceName = "videos/Lost_Ship.wmv";
                video_ship.Source = new Uri("videos/EscapeShip.wmv", UriKind.RelativeOrAbsolute);
                //video_ship.Name = "escape";
                //video_ship.Play();
                gr.Children.Add(video_ship);
            } 
```

我发送一个变量 v 来选择我的一个视频..我将视频设置为构建动作内容

有什么想法该怎么做？或与此不同的东西？我只想播放视频..视频没有音乐..或音效..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:58:05.880

我测试了它并且它有效。您想在调用事件时弹出视频。所以你应该把网格放在文件 xaml 代码中，它是隐藏的。这是我的测试

在 xml 上

```
<Grid x:Name="LayoutRoot" Background="Transparent">  
        <Image Source="BackgroundMain3.jpg" Stretch="UniformToFill"/>
        <Grid Height="400" Width="600" x:Name="playvideo" Visibility="Collapsed">
            <MediaElement x:Name="element"/>
        </Grid>
        <Button Content="Button" Height="72" HorizontalAlignment="Left" Margin="129,684,0,0" Name="button1" VerticalAlignment="Top" Width="160" Click="button1_Click" />
</Grid> 
```

在 xaml.cs 上

```
private void button1_Click(object sender, RoutedEventArgs e)
        {
            poupup(3);
            playvideo.Visibility = Visibility.Visible;
            playvideo.Opacity = 0.8;
            element.MediaOpened += new RoutedEventHandler(element_MediaOpened);
        }

        void element_MediaOpened(object sender, RoutedEventArgs e)
        {
            element.Play();
        }

        public void poupup(int v)
        {
            if (v == 1)
            {
                element.Source = new Uri("videos/Lost_Ship.wmv", UriKind.RelativeOrAbsolute);
            }
            else if (v == 2)
            {

                element.Source = new Uri("videos/you_are_on_fire.wmv", UriKind.RelativeOrAbsolute);

            }
            else if (v == 3)
            {
                element.Source = new Uri("YouTube.mp4", UriKind.RelativeOrAbsolute);

            }

        } 
```

# .net - 为多线程应用程序添加和删除事件处理程序

> ID：10194640
> 
> 赞同：2
> 
> 时间：2012-04-17T15:52:28.720
> 
> 标签：.net, multithreading, event-handling, listener

我有一个问题，如何在多线程环境中为异步回调正确添加/删除事件处理程序。

我有 MyCore 类，它接收来自 ProxyDLL 的异步回调，它从非托管代码调度回调。我有订阅事件的表单（托管）。

附加/分离事件的正确方法是什么。我注意到 MulticastDelegate 有 _invocationcount。它能做什么？如果回调调用正在进行直到回调完成，事件的内部逻辑是否会阻止与事件分离？该 puprose 是否存在 _invocationcount？脱离事件（通常）是安全的吗？

```
class Form1
{
  EventHandler m_OnResponse;
  Int32 m_SomeValue;
  Form1()
  {
    m_OnResponse = new EventHandler(OnResponseImpl);
    m_MyCore.SetCallBackOnLogOn(m_OnResponse);
  }
  ~Form1()
  {
    m_MyCore.ReleaseCallBackOnLogOn(m_OnResponse);
  }
  private OnResponseImpl(object sender, EventArgs e)
  {
    Thread.Sleep(60*1000);

    m_SomeValue = 1;             // <<-- How to/Who guarantees that Form1 obj is still
                                 // alive. May be callback was invoked earlier and
                                 // we just slept too long

    if (!this.IsDisposed)
    {
        invokeOnFormThread(DoOnResponseImpl, sender, e);
    }
  }
}

class MyCore
{
  private event EventHandler OnLogOn;
  public void SetCallBackOnLogOn(EventHandler fn)
  {
    // lock (OnLogOn)
    {
        OnLogOn += fn;
    }
  }
  ReleaseCallBackOnLogOn(EventHandler fn)
  {
    // lock (OnLogOn)
    {
        OnLogOn -= fn;
    }
  }
  public void DoDispatchOnLogOn()
  {
    // lock (OnLogOn)
    {
      if (OnLogOn != null)
      {
        OnLogOn(this, null);
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T18:17:04.110

默认事件添加和删除操作[已经是线程安全的](https://stackoverflow.com/q/3522361/158779)。在大多数情况下，您不需要担心那部分。您需要担心的是多播委托的调用。

```
public void DoDispatchOnLogOn()
{
  EventHander local;
  lock (this)
  {
    local = OnLogOn;
  }
  if (local != null)
  {
    local(this, null);
  }
} 
```

我在这里所做的是创建一个保存`OnLogOn`委托链的局部变量。我在这里利用多播委托的不变性，以便我们可以对 null 和调用序列进行线程安全检查。`lock`仅用于确保“新鲜”阅读，如果`OnLogon`您不介意“陈旧”阅读，则它是严格可选的。

**更新：**

> 我需要确保在 ReleaseCallBackOnLogOn 结束取消订阅委托时不会调用回调。

在大多数情况下，我的代码不会尝试执行任何已取消订阅的事件处理程序。在删除事件处理程序和引发事件之间存在轻微的竞争，这可能导致事件处理程序被执行，即使它最近才被删除。

> 我需要确保我的类实例仍然存在，直到对回调的调用完全完成。

委托持有对包含目标方法的类实例的引用。这将使您的实例保持扎根，因此不符合垃圾收集的条件。您无需担心这一点。

我应该指出，`~Form1`终结器不是删除事件处理程序的好地方。请记住，委托持有对包含目标方法的实例的引用，因此在大多数情况下不会调用终结器并且不会从事件中删除事件处理程序。

# spring - Apache Camel：Weave 在拆分中不起作用。为什么？

> ID：10194643
> 
> 赞同：0
> 
> 时间：2012-04-17T15:52:46.340
> 
> 标签：spring, unit-testing, split, apache-camel

我在春天有以下 XML DSL 上下文定义：

```
<beans>
    <camelContext>
        <route>
            <from uri="direct:foo"/>
            <split parallelProcessing="true">
                <simple>${body}</simple>
                <to uri="direct:bar"/>
            </split>
        </route>
    </camelContext>
</beans> 
```

在我的测试中，我试图`direct:bar`像这样编织端点：

```
context.getRouteDefinitions().get(0).adviceWith(context, new AdviceWithRouteBuilder() {

    @Override
    public void configure() throws Exception {
        weaveByToString(".*direct:bar.*").replace().to("mock:bar");
    }
}); 
```

这成功地工作。但是当路由开始时，会抛出一个异常说`org.apache.camel.NoSuchBeanException: No bean could be found in the registry for: direct:bar`。

为什么？

可能是骆驼不支持编织里面分叉？

**注意：**使用以下 XML 一切正常：

```
<beans>
    <camelContext>
        <route>
            <from uri="direct:dummy"/>
            <to uri="direct:bar"/>
        </route>

        <route>
            <from uri="direct:foo"/>
            <split parallelProcessing="true">
                <simple>${body}</simple>
                <to uri="direct:dummy"/>
            </split>
        </route>
    </camelContext>
</beans> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T07:52:59.753

对于使用 Camel 2.7 描述的用例，我无法重现您的错误。这是我通过的测试：

```
@Test
public void test() throws Exception {

    context.getRouteDefinitions().get(0).adviceWith(context, new AdviceWithRouteBuilder() {

        @Override
        public void configure() throws Exception {
            weaveByToString(".*direct:bar.*").replace().to("mock:bar");
        }
    });

    MockEndpoint mock = getMockEndpoint("mock:bar");
    mock.expectedMessageCount(1);

    template.sendBody("direct:foo", "this is a test");

    assertMockEndpointsSatisfied();
} 
```

使用也开始路线`camel:run`而不抛出`NoSuchBeanException`.

# javascript - 带有 HTML、CSS、Jquery 的滑动登录面板

> ID：10194655
> 
> 赞同：0
> 
> 时间：2012-04-17T15:53:44.250
> 
> 标签：javascript, jquery, html, css

使用 Html、CSS 和 jquery 以及一些插件在滑动登录面板上工作。

[http://24.125.42.135/](http://24.125.42.135/)

如您所见，该栏在激活时会向下推动内容（单击右上角的登录）。如果您在第一个屏幕上，那就太好了。但是，如果您在第二个屏幕上然后尝试按登录，则该栏不存在。

我在概念上很难在这里做什么，以便登录按钮像菜单的其余部分一样固定在顶部，但无论您在页面上的哪个位置，仍然会将内容向下推。

HTML

```
<!-- Panel -->
    <div id="toppanel">
        <div id="panel">
            <div class="content clearfix">
                <div class="left">
                    <!-- Login Form -->
                    <form class="clearfix" action="#" method="post">
                        <h1>Sign In</h1>
                        <label class="grey" for="log">Username:</label>
                        <input class="field" type="text" name="log" id="log" value="" size="23" />
                        <label class="grey" for="pwd">Password:</label>
                        <input class="field" type="password" name="pwd" id="pwd" size="23" />
                        <label><input name="rememberme" id="rememberme" type="checkbox" checked="checked" value="forever" /> &nbsp;Remember me</label>
                        <div class="clear"></div>
                        <input type="submit" name="submit" value="Login" class="bt_login" />
                        <a class="lost-pwd" href="#">Lost your password?</a>
                    </form>
                </div>
                <div class="left right">            
                    <!-- Register Form -->
                    <form action="#" method="post">
                        <h1>Not a member yet? Sign Up!</h1>             
                        <label class="grey" for="signup">Username:</label>
                        <input class="field" type="text" name="signup" id="signup" value="" size="23" />
                        <label class="grey" for="email">Email:</label>
                        <input class="field" type="text" name="email" id="email" size="23" />
                        <label>A password will be e-mailed to you.</label>
                        <input type="submit" name="submit" value="Register" class="bt_register" />
                    </form>
                </div>
            </div>
        </div> <!-- /login -->  

        <!-- The tab on top --> 
        <div class="tab">
            <ul class="login">
                <li class="left">&nbsp;</li>
                <li id="toggle">
                    <a id="open" class="open" href="#?signin">Log In | Register</a>
                    <a id="close" style="display: none;" class="close" href="#">Close Panel</a>         
                </li>
                <li class="right">&nbsp;</li>
            </ul> 
        </div> <!-- / top -->

    </div> <!--panel --> 
```

CSS

```
/* sliding panel */
#toppanel {
    position: relative;   /*Panel will overlap  content */
    /*position: relative;*/   /*Panel will "push" the content down */
    top: 0;
    width: 100%;
    z-index: 999;
    text-align: center;
    margin-left: auto;
    margin-right: auto;
} 
```

Javascript

```
$(document).ready(function() {

// Expand Panel
$("#open").click(function(){
    $("div#panel").slideDown("slow");   
});

// Collapse Panel
$("#close").click(function(){
    $("div#panel").slideUp("slow");
}); 

// Switch buttons from "Log In | Register" to "Close Panel" on click
$("#toggle a").click(function () {
    $("#toggle a").toggle();
}); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:00:39.667

我建议将其余内容放在可以滚动的固定 div 中。

这样你就永远不会移动你的 div，除非你切换登录 div。但它仍然提供与现在相同的效果。

# zend-framework - 将请求重定向到公共目录 zend

> ID：10194661
> 
> 赞同：0
> 
> 时间：2012-04-17T15:53:57.073
> 
> 标签：zend-framework, .htaccess, web-deployment

我有一个子域，我已经部署了我的 zend 应用程序，问题是它指向目录说`abc`，我无法将它更改为指向`public`目录有没有办法可以将`.htaccess`文件放在根目录上，该文件将重定向到目录`public`？可以吗？有没有其他方法可以完成它

我在公共目录中的 index.php

```
<?php

// Define path to application directory
defined('APPLICATION_PATH')
    || define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../application'));

// Define application environment
defined('APPLICATION_ENV')
    || define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV') : 'production'));

// Ensure library/ is on include_path
set_include_path(implode(PATH_SEPARATOR, array(
    realpath(APPLICATION_PATH . '/../library'),
    get_include_path(),
)));

/** Zend_Application */
require_once 'Zend/Application.php';

// Create application, bootstrap, and run
$application = new Zend_Application(
    APPLICATION_ENV,
    APPLICATION_PATH . '/configs/application.ini'
);
$application->bootstrap()
            ->run(); 
```

我的`.htaccess`内部公共目录

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

目前目录结构看起来像

```
/myroot
 -.settings
 -application
 -docs
 -library
 -public
 -tests
 -.buildpath
 -.proect
 -.zfproject.xml 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-10T21:42:52.927

```
RewriteEngine On
RewriteRule ^\.htaccess$ - [F]
RewriteCond %{REQUEST_URI} =""
RewriteRule ^.*$ /public/index.php [NC,L]
RewriteCond %{REQUEST_URI} !^/public/.*$
RewriteRule ^(.*)$ /public/$1
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^.*$ - [NC,L]
RewriteRule ^public/.*$ /public/index.php [NC,L] 
```

没有错误也没有问题..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:08:50.947

我希望我能正确设置您的域。如果你有这个设置

```
sub.domain.net --> /myroot 
```

您将需要在该 (/myroot) 文件夹中有一个 .htaccess，因为它是您的 http 请求的基础。它应该看起来像这样

```
RewriteEngine On  
RewriteBase /public  
RewriteCond %{REQUEST_FILENAME} -s [OR]  
RewriteCond %{REQUEST_FILENAME} -l [OR]  
RewriteCond %{REQUEST_FILENAME} -d  
RewriteRule ^.*$ - [NC,L]  
RewriteRule ^.*$ public/index.php [NC,L] 
```

RewriteBase 指令应该在 RewriteCond 中找到所有请求，并且主要应用于第一个 RewriteRule。它基本上设置（重写）所有 HTTP 路径请求的相对根。第二个 RewriteRule 最终触发你的应用程序，它是一个本地路径。（我希望我对最后一条规则没有错。如果这不起作用，请在没有公众的情况下尝试。我无法测试它，但几年前我有一个应用程序可以像这样工作。）

# firefox-addon - Firefox 扩展中未显示工具栏图标

> ID：10194664
> 
> 赞同：1
> 
> 时间：2012-04-17T15:54:08.833
> 
> 标签：firefox-addon, xul

我正在编写一个简单的 Firefox 扩展，它在工具栏中有一个图标。我无法使用 XUL 添加工具栏图标。我正在使用的文件结构和代码如下：

延期：

```
-chrome.manifest
-install.rdf
-chrome
    -content
        -toolbarButton.js
        -toolbarButton.xul
    -locale
    -skin
        -toolbarButton.css
        -icon.png 
```

chrome.manifest：

```
content myext chrome/content/
skin    myext   classic/1.0 chrome/skin/
locale    myext  en-US       chrome/locale/en-US/

overlay chrome://browser/content/browser.xul  chrome://myext/content/toolbarButton.xul

style chrome://global/content/customizeToolbar.xul chrome://myext/skin/toolbarButton.css
style chrome://global/content/browser.xul chrome://myext/skin/toolbarButton.css 
```

XUL 代码：

```
<toolbarpalette id="BrowserToolbarPalette">
    <toolbarbutton id="toolbar-clipper-button"
      label="Some label"
      tooltiptext="Does something"
      oncommand="showMessage(event)" >
    </toolbarbutton>
</toolbarpalette> 
```

CSS 代码：

```
#toolbar-clipper-button {
    list-style-image: url("chrome://myext/skin/toolbar-icon.png");
} 
```

请帮助我找出问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T12:46:46.663

在 Mozilla 社区的好人的帮助下，我能够解决这个问题。是的，我没有在自定义工具栏表中看到工具栏图标。问题在于包装。在我的情况下，所有文件都没有被复制。代码现在工作正常......

# android - Android - 按选项卡时隐藏RelativeLayout

> ID：10194668
> 
> 赞同：0
> 
> 时间：2012-04-17T15:54:12.187
> 
> 标签：android, android-tabhost, data-hiding

我有一个带有 2 个选项卡、详细信息和附件的 tabHost。我想要做的是，当我按下附件选项卡时，我想隐藏相对布局中的信息。我知道我必须 setVisibility(View.VISIBLE) 但如何将此方法与该 Tab 关联？

我有这个代码来创建我的标签：

```
intent = new Intent();
    intent.putExtras(bundle);
    spec = tabHost.newTabSpec("Attachments")
             .setIndicator("Attachments")  
                .setContent(intent
                  .addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP));
    tabHost.addTab(spec); 
```

谁能帮帮我？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:45:18.430

您可以通过广播意图发送消息。

1.  在将接收消息的活动上设置广播接收器
2.  在需要时发送广播意图。

这是代码片段。

```
@Override
protected void onResume() {
  super.onResume();
  if( listener != null) {
    registerReceiver(listener, new  IntentFilter( "hide_me"));
  }
}

@Override
protected void onPause() {
  super.onPause();
  if( listener != null) {
    unregisterReceiver(listener);
  }
}

@Override
protected void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  listener = new BroadcastReceiver() { //put your code here 
  }
} 
```

并发送这样的消息：

```
Intent i = new Intent();
i.setAction("hide_me");
sendBroadcast(i); 
```

# java - 实现通用链表添加方法java

> ID：10194671
> 
> 赞同：1
> 
> 时间：2012-04-17T15:54:31.237
> 
> 标签：java, data-structures, linked-list

我正在尝试为 linkedlist 实现 add 方法，它应该采用任何数据类型，但我有点迷路并且无法正常工作，我们将不胜感激。

```
 public class LinkedList <T>extends AbstractList  {

 private class Node {

    T data;
    Node next;

    Node(T data, Node next) {
        this.data = data;
        this.next = next;
    }

    Node(T data) {
        this(data, null);
    }
}
Node first;
Node last;

public LinkedList() {
    first = null;
    last = null;
}

@Override
public boolean add(T item) {

    Node newNode = new Node((T)item);

    if (isEmpty()) {
        first = newNode;
        last = first;
        return true;
    }

    last.next = newNode;
    last = null;
    return true;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:58:17.727

你没有告诉我们你的具体问题，所以我们无法解决它，只能猜测。

我看到的一个问题是您将其扩展`AbstractList`为原始（非泛型）类型 - 您的声明应该改为

```
public class LinkedList<T> extends AbstractList<T>  { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:20:24.563

你需要：

```
last.next = newNode;
last = newNode; 
```

小心你明白为什么。

在添加新节点之前，`last`是对列表中最后一个条目的引用。

您要做的是将**其** `next`引用指向这个新节点。

然后第二行`last`也更新以引用这个新行。

# arrays - 在 Matlab 中创建数组

> ID：10194676
> 
> 赞同：1
> 
> 时间：2012-04-17T15:55:05.513
> 
> 标签：arrays, matlab

我想将用户输入存储在一个数组中，但是当一个人输入一个新数字时，之前的输入会被替换。如何在 Matlab 中创建这样一个数组，以便我可以存储所有输入而无需替换？我是初学者，所以请耐心等待

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:02:22.480

您只需将输入缓冲区的内容复制到不会被覆盖的数据结构中。

元胞数组对此很有用（请参阅`userInputs`下面的变量）。如果没有更好地了解您的代码，我猜测用户输入存储在一个名为`buffer`. 这是我的做法：

```
% a new buffer comes in
userInputs{iInput} = buffer;
iInput = iInput + 1;
% keep looking for more inputs 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:06:37.040

如果你想要一个数字矩阵，这里是一个例子：

```
n = 2; %# number of rows
m = 3; %# number of columns
out = zeros(n,m); %# the output
k = 1; %# counter
while k <= n*m
    x = input('Enter a number or Enter to stop: ');
    if isempty(x)
        break
    else
        out(k)=x;
    end
    k=k+1;
end
disp(xx) 
```

# javascript - jquery ajax 获取返回值

> ID：10194684
> 
> 赞同：3
> 
> 时间：2012-04-17T15:55:27.817
> 
> 标签：javascript, jquery, ajax

我想获得 html 页面的“打印值”。

我尝试了以下查询，但 showGetResult() 只返回“空值”

但是当我尝试这段代码时，我打印了我的 apache 服务器日志，我访问了 index.php。

（index.php 只打印 helloworld）

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"><\script>
<script type="text/javascript">
function showGetResult( name )
{
     var result = null;
     jQuery.ajax({
        url: 'http://localhost/index.php',
        type: 'get',
        dataType: 'text/html',
        success:function(data)
        {
            alert(data);
            result = data;
        } 
     });
     return result;
}

document.write(showGetResult('test'));
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T15:58:07.613

这就是 AJAX 的工作方式（异步，顾名思义）。该`showGetResult`函数在 AJAX 调用完成之前返回。`showGetResult`因此将简单地返回`null`，因为这是您分配给`result`.

`success`在回调中移动任何依赖于 AJAX 调用结果的代码。或者，您可以使调用同步，但这通常不是您想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T16:00:32.780

我想你想做的是这个。

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"><\script>
<script type="text/javascript">
function showGetResult( name )
{
     jQuery.ajax({
        url: 'http://localhost/index.php',
        type: 'get',
        dataType: 'text/html',
        success:function(data)
        {
            alert(data);
            document.write(data);
        } 
     });
}

showGetResult('test');
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:57:53.370

AJAX 请求默认是异步的；你不能在函数中返回他们的结果，你需要使用回调。实现您想要的最简单的方法是将处理数据的代码放在`success`处理程序中：

```
 success:function(data)
    {
        alert(data);
        result = data;
        document.write(showGetResult('test'));
    } 
```

另外，不要使用`document.write`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T15:58:41.327

[根据jQuery.ajax](http://api.jquery.com/jQuery.ajax/)`dataType`的文档，您有错误：

> “html”：以纯文本形式返回 HTML；包含的脚本标签在插入 DOM 时进行评估。

所以你想使用`html`：

```
...
dataType: 'html',
... 
```

* * *

另外，正如其他人所说，ajax请求是异步的。所以你需要重构你的代码。例如：

```
function showGetResult( name )
{
 var result = null;
 jQuery.ajax({
    url: 'http://localhost/index.php',
    type: 'get',
    dataType: 'html',
    success:function(data)
    {
        alert(data);
        result = data;
        document.write(result);
    } 
 });
}

showGetResult('test'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T16:01:31.033

你在这里错过了一个基本点。当您调用 showGetResult 时，该`success`方法不会运行。它是[异步](http://en.wikipedia.org/wiki/Asynchrony)运行的。

在你说它的时候`return result;`它仍然是空的（因为`success`还没有被调用）。

您需要做的是在调用成功后执行 document.write 。要么像这样：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"><\script>
<script type="text/javascript">
function showGetResult( name )
{
     var result = null;
     jQuery.ajax({
        url: 'http://localhost/index.php',
        type: 'get',
        dataType: 'text/html',
        success:function(data)
        {
            alert(data);
            document.write(data);
        } 
     });
     return result;
}

//document.write(showGetResult('test'));
showGetResult('test');
</script> 
```

或使用回调：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"><\script>
<script type="text/javascript">
function showGetResult( name )
{
     var result = null;
     jQuery.ajax({
        url: 'http://localhost/index.php',
        type: 'get',
        dataType: 'text/html',
        success:function(data)
        {
            alert(data);
            writeToDocument(data);
        } 
     });
}

function writeToDocument(data) {
   document.write(data);
}

showGetResult('test');
</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T16:02:01.283

成功回调可以为您处理好这些，而不是使用`document.write`您期望函数返回的内容，如下所示：

```
success:function(data) {
    document.write(data);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-29T03:49:08.390

```
jQuery.ajax({
async: false, //add async false
        url: 'http://localhost/index.php',
        type: 'get',
        dataType: 'text/html',
        success:function(data)
        {
            alert(data);
            result = data;
        } 
     }); 
```

# ruby-on-rails-3 - ActionMailer.deliveries 邮件队列是否在每个测试实例上都被清除，还是我必须自己清空它？

> ID：10194685
> 
> 赞同：0
> 
> 时间：2012-04-17T15:55:29.920
> 
> 标签：ruby-on-rails-3, unit-testing, actionmailer

```
assert !ActionMailer::Base.deliveries.empty?, "Queue is empty" 
```

如果我有两个发送邮件的单元测试，并且我想检查每个队列是否为空，我是否必须在第二个测试中重置队列（以清除第一个测试中可能存在的任何内容）？

导轨 3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T22:53:43.613

您必须自己清空它，因为`ActionMailer::Base.deliveries`它将在测试之间持续存在（它是一个单例）。您应该始终在任何测试运行之前清除交付数组以确保它为空。

# sql-server-2008 - SQL在where子句中为2个不同的列指定2个不同的条件，两者都必须为真

> ID：10194689
> 
> 赞同：0
> 
> 时间：2012-04-17T15:55:40.090
> 
> 标签：sql-server-2008, tsql, where-clause

如何编写 sql 查询以仅返回表中的行

例如，列 A 不为空且列 B 不为 0

我写它的方式是：

```
where A is not null AND B !=0 
```

但问题是查询结果也消除了只有一个条件为真的行，例如列 a 为空，但列 b 不是 0，反之亦然

我需要查询仅消除（不返回）满足 where 子句的两个条件的行。

我只希望我从查询中获得的结果是表中的行，其中列 A 不是 NULL，列 B 不是 = 0，但我需要满足两个条件，而不仅仅是其中一个

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:59:37.257

如果我理解正确，您正在寻找：

```
where A is not null AND B <> 0 
```

如果您的 where 子句实际上更复杂（例如，其中也有一个`OR`），则在上面加上括号，例如：

```
where (A is not null AND B <> 0) OR ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:25:51.427

> 我需要查询...*不*返回满足我的 where 子句的两个条件的行。

听起来您想否定 WHERE 子句。像这样：

```
WHERE NOT (A IS NOT NULL AND B !=0) 
```

这可以在没有双重否定的情况下重写：

```
WHERE (A IS NULL OR B = 0 OR B IS NULL) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T14:38:08.633

有人在此处发布了此答案，但随后他们将其删除（不知道为什么？），但他们的答案确实有效。

```
WHERE NOT(A is null AND B=0) 
```

我尝试使用

```
where A is not null AND B <> 0 
```

和

```
where (A is not null AND B <> 0) 
```

但是即使只满足其中一个条件，也会触发 where 子句，并且我需要仅在满足两个条件时才触发它。

再说一次，我的问题的答案是使用下面的代码。

```
WHERE NOT(A is null AND B=0) 
```

谢谢！

# html - 在电子邮件活动中使用 html 元素有什么意义吗？

> ID：10194691
> 
> 赞同：0
> 
> 时间：2012-04-17T15:55:42.633
> 
> 标签：html, email

我的部分工作涉及将 psd 设计转换为 html，以便通过电子邮件发送出去用于电子邮件活动。过去，我总是尽可能地将所有内容转换为合适的 html 元素，但我现在质疑这是否有任何意义？

只使用一张巨大的图像可以吗？我只是问，因为似乎使用 html 元素只有在以下情况下才真正重要这一切都通过电子邮件进行。

如果我非常确信我要邮寄的客户*不会*阻止图像，那么是否可以将整个电子邮件正文视为`<img />`?

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:00:20.237

我想应该没问题，但我不会推荐它。以下是几个原因：

1.  读者将无法选择和复制电子邮件中的任何内容，我认为这真的很烦人。
2.  您将无法在电子邮件中包含链接，唯一可以链接的是整个图像。
3.  如果他们确实禁用了图像（我认为这很常见），那么如果不下载图像就不会看到任何东西。
4.  由于大图像而增加了电子邮件的大小，这对于移动设备来说是一种痛苦。
5.  图像不会适应窗口/显示尺寸。如果内容不合适，基于文本/HTML 的邮件至少可以换行，以使其更具可读性。

而这样的例子不胜枚举。其他答案也指出了许多其他原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:04:40.790

我不知道这个问题有什么明确的答案，但这是我的看法：

*   我认为将某些元素转换为文本以便可以复制或操作它们是一个好主意。如果您有电话号码，您可能希望它是可读的，以便任何拥有自动拨号器的人都可以单击并完成通话。某些电子邮件程序可能会自动将地址转换为指向地图的链接。如果这些元素中的任何一个被展平到 jpg 中，这些功能将不起作用。
*   对于那些不会在屏幕上呈现图像的移动电子邮件客户端（因为它只是显示预览或尚未下载内容），在查看完整图像之前查看一些替代文本（和正文内容）很有用.
*   我知道您说过您确定您的客户不会阻止图像，但您不能真正依赖它。对防火墙进行更改的善意管理员可能会意外阻止整个域的所有传入图像，您的电子邮件将一文不值。
*   最后，带有一行代码来加载图像的 HTML 电子邮件很可能被标记为垃圾邮件。

我希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T16:03:24.583

对于在移动设备上查看您的电子邮件的用户来说，带宽问题如何？如果是大图，你想炸掉他们的数据上限吗？

或者为视障人士使用辅助技术的用户。例如屏幕阅读器（文本到语音）。真实的文本对于这样的场景很有帮助。

# forms - Symfony2 Form：选择一个实体或添加一个新实体

> ID：10194693
> 
> 赞同：26
> 
> 时间：2012-04-17T15:55:57.360
> 
> 标签：forms, symfony

我有一个`order`和一个`client`实体。

我想知道是否可以使用实际的 Symfony2 表单系统创建一个订单表单，该表单允许：

1.  从下拉列表中选择多个客户端（混合`collection`和`entity`表单类型）
2.  `collection`如果不在下拉列表中，则动态创建新客户端（该类型的默认方式）。

我已经看到了通过在同一页面中创建多个表单来实现它的某种方法，但这不是我想要实现它的方式。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-08-25T13:25:59.210

我有一个类似的问题，可能会导致您的解决：

我有一个类别和项目关系（多对一），我想选择一个现有项目或创建一个新项目。

在我的表单类中：

```
 $builder->add('item', 'entity', array(
        'label' => 'Item',
        'class' => 'ExampleItemBundle:Item',
    ));

    $builder->add('itemNew', new EmbedItemForm(), array(
        'required' => FALSE,
        'mapped' => FALSE,
        'property_path' => 'item',
    ));

    $builder->addEventListener(FormEvents::PRE_SUBMIT, function(FormEvent $event) {
        $data = $event->getData();
        $form = $event->getForm();

        if (!empty($data['itemNew']['name'])) {
            $form->remove('item');

            $form->add('itemNew', new EmbedItemForm(), array(
                'required' => TRUE,
                'mapped' => TRUE,
                'property_path' => 'item',
            ));
        }
    }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-07T12:43:21.077

`property_path`您可以使用该选项将表单中的两个字段映射到同一属性。然后，使用表单事件，使用提交的数据做出决定并修改表单，以便只有一个字段有一个`mapped`选项，即`true`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T08:41:25.050

就我而言，我遇到了同样的问题，我通过在我的`formType`;中创建 2 个属性来解决它。

例如，对您来说，它将是：

```
customer->entity
new_customer-> collection 
```

在您的订单实体文件中，您必须添加 3 个方法（getter、setter 和 remover）getter 和 remover 不做任何事情，但 setter 应该调用`setCustomer(c)`

我不确定这是否是最好的方法，但这是我弄清楚的唯一方法！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-03T07:49:14.790

如果我理解的话，您现在想在“动态”表单中创建和存储新客户。我认为您必须使用 JavaScript 执行此操作并在控制器中设置其他操作。

1.  *JS* -> 捕获事件以将新客户端添加到您的数据库（即“添加新”按钮单击事件）
2.  *JS* -> 在此事件中，使用新客户端的值通过 AJAX 调用您的控制器。（使用[FOSJsRoutingBundle](https://github.com/FriendsOfSymfony/FOSJsRoutingBundle/)很容易做到）
3.  *Symfony2* -> 在您的新操作中，将新客户端存储在您的数据库中。
4.  *JS* -> OnSuccess 事件，在您的 AJAX 调用中，将新客户端添加到您的 DropDownBox (ddb.append(new element tag)

只需这样做，您就可以将新客户端存储在数据库中并添加到您的下拉框中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T16:14:55.937

`collection`Form 类型允许使用和属性动态添加和`allow_add`删除`allow_delete`。

通过以下 2 个链接了解更多信息：

*   [官方集合表单字段类型参考](http://symfony.com/doc/current/reference/forms/types/collection.html)
*   [关于使用集合类型动态添加和删除的食谱](http://symfony.com/doc/current/cookbook/form/form_collections.html#cookbook-form-collections-new-prototype)

如果您不喜欢在同一页面上获得补充表单，您可以将它们集成到对话框中...但是您肯定需要一个表单来创建新项目...

# c# - 如何增加命名管道的 MaxStringContentLength？

> ID：10194694
> 
> 赞同：2
> 
> 时间：2012-04-17T15:56:01.733
> 
> 标签：c#, wcf, named-pipes

我正在使用 WCF 将数据从一个应用程序传递到另一个应用程序。在执行期间，我收到`System.ServiceModel.Dispatcher.NetDispatcherFaultException`. 在其中，.NET 声称应该增加 MaxStringContentLength（默认值为 8192）。

如何增加命名管道的 MaxStringContentLength？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:17:09.570

这是您绑定配置下的设置

```
<bindings>
 <netNamedPipeBinding>
   <binding name="binding1" ...>
     <readerQuotas
        maxDepth="2147483647"
        maxStringContentLength="2147483646"
        maxArrayLength="2147483647"
        maxBytesPerRead="2147483647"
        maxNameTableCharCount="2147483647"/>
   </binding> 
```

# android - Android：视图的默认 ID 是什么？

> ID：10194695
> 
> 赞同：4
> 
> 时间：2012-04-17T15:56:04.100
> 
> 标签：android, view

我问这个是因为我有报告中的例外（来自市场的用户），提到我有重复的 id 为 0x2（或 0x3）的视图。

由于我生成的所有 id 都非常大，我认为具有重复 id 的视图是没有明确定义 id 的视图。

我的问题是视图的 id 是什么，开发人员没有明确地为它们分配 id。

提前致谢， 达尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T15:58:23.677

AAPT 不断更新您的 R 文件，为您自己的每个 ID 生成唯一的十六进制值。就您创建的 ID 而言，它们只需要在父视图组中是唯一的。一如既往，请发布您的堆栈跟踪。

根据源代码，您尚未为其设置 ID 的 View 的 ID 为 -1。

```
public static final int NO_ID = -1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:59:56.673

如果您没有为视图指定 id，我会说不会创建任何 id。尝试创建一个非常简单的应用程序并创建没有 id 的组件，您会注意到 R.java 文件中没有创建任何 id。

# java - onFling 和多点触控 - 多个 MotionEvent 指针

> ID：10194698
> 
> 赞同：4
> 
> 时间：2012-04-17T15:56:27.510
> 
> 标签：java, android

我想在 SimpleGestureDetector 的 onFling() 中使用 MotionEvent.getPointerCount() 来实现一些逻辑，但是没有 MotionEvent 被传递到包含任何指针信息的 onFling 中。最重要的是，当涉及多个触摸指针时，甚至不会调用 onFling。我该怎么办？有变通办法吗？帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T18:02:45.840

据我所知android系统提供的简单[OnGestureListener](http://developer.android.com/reference/android/view/GestureDetector.OnGestureListener.html)不支持多点触控事件。您必须通过实现[OnTouchListener自己检测它](http://developer.android.com/reference/android/view/View.OnTouchListener.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-03T07:31:34.700

可以强制 GestureListener 忽略多点触摸指针，并让它考虑第一个向下触摸指针以在内部操作手势。

您只需要通过以下方式实例化手势检测器

```
GestureDetector detector = new GestureDetector(getActivity(), new MyGestureDetector(), null, 
false); 
```

代替

```
GestureDetector detector = new GestureDetector(getActivity(), new MyGestureDetector()); 
```

享受.. ：）

# c# - 为异步方法创建和关闭 WCF 客户端的最佳实践

> ID：10194699
> 
> 赞同：3
> 
> 时间：2012-04-17T15:56:27.970
> 
> 标签：c#, .net, wcf, asynchronous

我熟悉创建 WCF 客户端、调用标准方法、然后在完成后关闭或中止客户端的最佳实践，但我想知道客户端的异步方法。

我有一个管理器类，它有一些传递事件供消费类附加，以便检索异步调用的结果。例如：

```
internal sealed class CommController
{
    public event GetClientIdEventHandler ClientIdReceived;

    private readonly LocalCommSvcClient _localCommSvcClient = new LocalCommSvcClient();

    public CommController()
    {
        _localCommSvcClient.GetClientIdCompleted += (o, e) => ClientIdReceived(o, e);
    }

    public void GetClientIdAsync()
    {
        _localCommSvcClient.GetClientIdAsync();             
    }
} 
```

但我看不到客户在哪里关闭和/或处置。我真的找不到太多关闭 WCF 客户端的最佳实践，因为它与异步使用有关。我应该把 .Close() 和/或 .Abort() 调用放在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T15:16:59.257

您需要先 Open() 一个客户端，然后才能像使用同步客户端一样发送消息。不再需要通信后（至少在您收到响应时），您应该关闭（）它以释放资源。详细信息取决于服务的绑定和行为配置。参见例如[http://msdn.microsoft.com/en-us/library/system.servicemodel.servicebehaviorattribute.instancecontextmode.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicebehaviorattribute.instancecontextmode.aspx)

# sql-server - 使 SQL Server 数据库联机

> ID：10194702
> 
> 赞同：10
> 
> 时间：2012-04-17T15:56:35.380
> 
> 标签：sql-server, sql-server-2008-r2

我执行`Take offline`了 SQL Server 2008 R2 数据库的任务。

我不能把它带到网上！

我试过了

```
USE master;
GO

ALTER DATABASE [DBNAME] SET ONLINE 
```

我得到一个错误。

> 用户无权更改数据库“DBNAME”，数据库不存在，或数据库未处于允许访问检查的状态。

我也尝试使用该任务`Bring online`，但我得到了完全相同的错误。

谁能尽快帮助我？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T17:21:35.203

我认为您将需要使用 SA 帐户或其他具有系统管理员权限的帐户登录，然后运行您的代码以使其重新联机。当您在那里时，也将系统管理员添加到您的帐户中。如果您不拥有该数据库，则可能需要与其他人交谈以获取 SA 密码，或者请他们为您完成。除非您没有 SA 密码，或者出于安全原因它已被隐藏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:01:10.673

您的错误太笼统而无法使用。您实际上是否有权更改数据库（如果您设法使其脱机，我想您会这样做）？您可以访问 SQL 日志（可通过管理 > SQL Server 日志在树中访问）吗？您确定执行脚本的用户是您期望的用户吗？

此外，您可以尝试以下任何操作 * 重新启动服务然后重试 * 使用鼠标 GUI 使其联机（右键单击数据库、任务、联机）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-12T07:43:45.390

有同样的问题，同样的错误。甚至以 SA 身份登录并返回相同的错误。在这两个问题数据库上，所有者都不是 SA。

通过附加数据库解决。这使您有机会重命名数据库并分配所有者。指定所有者为 SA。

分离失败的数据库将新附加的数据库重命名为原始名称。始终赋予 SA 新数据库所有权的教训。

# c++ - C++：比较 if 语句中的十进制值

> ID：10194705
> 
> 赞同：2
> 
> 时间：2012-04-17T15:56:44.193
> 
> 标签：c++, pixel

我正在打印 .bmp 文件中的像素值。我的问题是，如果像素不是 255 255 255（白色），那么我希望它是 0 0 0（黑色）。

这是完整的代码：（是的，这是从[从 24bpp 位图中获取每个像素的 RGB 值，以便在 C 中转换为 GBA 格式](https://stackoverflow.com/questions/1531268/getting-rgb-values-for-each-pixel-from-a-24bpp-bitmap-in-c)）这适用于 24 位 .bmp

```
#include <stdio.h>
#include <stdlib.h>
#pragma pack(2)

typedef struct
{
    char signature[2];
    unsigned int fileSize;
    unsigned int reserved;
    unsigned int offset;
} BmpHeader;

typedef struct
{
    unsigned int headerSize;
    unsigned int width;
    unsigned int height;
    unsigned short planeCount;
    unsigned short bitDepth;
    unsigned int compression;
    unsigned int compressedImageSize;
    unsigned int horizontalResolution;
    unsigned int verticalResolution;
    unsigned int numColors;
    unsigned int importantColors;

} BmpImageInfo;

typedef struct
{
    unsigned char blue;
    unsigned char green;
    unsigned char red;
    //unsigned char reserved; Removed for convenience in fread; info.bitDepth/8 doesn't seem to work for some reason
} Rgb;

int main( int argc, char **argv ) {

        FILE *inFile;
        BmpHeader header;
        BmpImageInfo info;
        Rgb *palette;
        int i = 0;

        printf( "Opening file %s for reading.\n", argv[1] );

        inFile = fopen( argv[1], "rb" );
        if( !inFile ) {
                printf( "Error opening file %s.\n", argv[1] );
            return -1;
        }

        if( fread(&header, 1, sizeof(BmpHeader), inFile) != sizeof(BmpHeader) ) {
                printf( "Error reading bmp header.\n" );
            return -1;
        }

        if( fread(&info, 1, sizeof(BmpImageInfo), inFile) != sizeof(BmpImageInfo) ) {
                printf( "Error reading image info.\n" );
            return -1;
        }

        if( info.numColors > 0 ) {
                printf( "Reading palette.\n" );
                palette = (Rgb*)malloc(sizeof(Rgb) * info.numColors);
                if( fread(palette, sizeof(Rgb), info.numColors, inFile) != (info.numColors * sizeof(Rgb)) ) {
                        printf( "Error reading palette.\n" );
                return -1; // error
                }
        }

        printf( "Opening file %s for writing.\n", argv[2] );
        FILE *outFile = fopen( argv[2], "wb" );
        if( !outFile ) {
                printf( "Error opening outputfile.\n" );
                return -1;
        }
        Rgb *pixel = (Rgb*) malloc( sizeof(Rgb) );
        int read, j;
        for( j=0; j<info.height; j++ ) {
                printf( "------ Row %d\n", j+1 );
                read = 0;
                for( i=0; i<info.width; i++ ) {
                        if( fread(pixel, 1, sizeof(Rgb), inFile) != sizeof(Rgb) ) {
                                printf( "Error reading pixel!\n" );
                                return -1;
                        }
                        read += sizeof(Rgb);
                        if (pixel->red != 255 || pixel->green != 255 || pixel->blue != 255)
                            printf( "Pixel %d: 0 0 0\n", i+1, );
                        else
                            printf( "Pixel %d: %3d %3d %3d\n", i+1, pixel->red, pixel->green, pixel->blue );
                        /*if (pixel->red != 255 || pixel->green != 255 || pixel->blue != 255)
                            printf ("Pixel %d: 0 0 0\n", i+1);
                        else
                            printf( "Pixel %d: 255 255 255\n", i+1);*/

                }
                if( read % 4 != 0 ) {
                        read = 4 - (read%4);
                        printf( "Padding: %d bytes\n", read );
                        fread( pixel, read, 1, inFile );
                }
        }

        printf( "Done.\n" );
        fclose(inFile);
        fclose(outFile);

        printf( "\nBMP-Info:\n" );
        printf( "Width x Height: %i x %i\n", info.width, info.height );
        printf( "Depth: %i\n", (int)info.bitDepth );

        return 0;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T15:58:46.427

您像素的 RGB 值可能是整数，而不是字符串：

```
if (pixel->red != 255 || pixel->green != 255 || pixel->blue != 255)
    printf ("Pixel %d: 0 0 0\n", i+1);
else
    printf( "Pixel %d: %3d %3d %3d\n", i+1, pixel->red, pixel->green, pixel->blue ); 
```

如果像素为白色，则要打印“255 255 255”，否则要打印“0 0 0”，这样做更简单：

```
if (pixel->red != 255 || pixel->green != 255 || pixel->blue != 255)
    printf ("Pixel %d: 0 0 0\n", i+1);
else
    printf( "Pixel %d: 255 255 255\n", i+1); 
```

# python - 在python中按值对defaultdict进行排序

> ID：10194713
> 
> 赞同：28
> 
> 时间：2012-04-17T15:57:36.597
> 
> 标签：python, sorting, dictionary, defaultdict

我有一个类似这样的数据结构：

三个城市不同年份的人口如下。

```
Name  1990 2000 2010
A     10   20   30
B     20   30   10
C     30   10   20 
```

我正在使用 a`defaultdict`来存储数据。

```
from collections import defaultdict
cityPopulation=defaultdict(list)
cityPopulation['A']=[10,20,30]
cityPopulation['B']=[20,30,10]
cityPopulation['C']=[30,10,20] 
```

我想`defaultdict`根据列表的特定列（年份）进行排序。比如说，1990 年的排序应该给出`C,B,A`，而 2010 年的排序应该给出`A,C,B`。

另外，这是存储数据的最佳方式吗？当我改变人口值时，我希望它是可变的。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-04-17T16:13:04.857

```
>>> sorted(cityPopulation.iteritems(),key=lambda (k,v): v[0],reverse=True) #1990
[('C', [30, 10, 20]), ('B', [20, 30, 10]), ('A', [10, 20, 30])]
>>> sorted(cityPopulation.iteritems(),key=lambda (k,v): v[2],reverse=True) #2010
[('A', [10, 20, 30]), ('C', [30, 10, 20]), ('B', [20, 30, 10])] 
```

请注意，在 python 3 中，您不能自动解压缩 lambda 参数，因此您必须更改代码

```
sorted(cityPopulation.items(), key=lambda k_v: k_v[1][2], reverse=True) #2010 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2016-12-02T12:24:08.910

如果要根据值而不是键进行排序，请使用`data.items()`并设置键，`lambda kv: kv[1]`以便它选择值。

* * *

看一个例子`defaultdict`：

```
>>> from collections import defaultdict
>>> data = defaultdict(int)
>>> data['ciao'] = 17
>>> data['bye'] = 14
>>> data['hello'] = 23

>>> data
defaultdict(<type 'int'>, {'ciao': 17, 'bye': 14, 'hello': 23}) 
```

现在，让我们按值排序：

```
>>> sorted(data.items(), lambda kv: kv[1])
[('bye', 14), ('ciao', 17), ('hello', 23)] 
```

最后`reverse=True`，如果您希望更大的数字排在第一位，请使用：

```
>>> sorted(data.items(), lambda kv: kv[1], reverse=True)
[('hello', 23), ('ciao', 17), ('bye', 14)] 
```

请注意，这`key=lambda(k,v): v`是一种更清晰（对我而言）的说法`key=lambda(v): v[1]`，只是后者是 Python 3 允许它的唯一方式，因为[lambda 中的自动元组解包不可用](https://stackoverflow.com/q/21892989/1983854)。

在 Python 2 中，你可以说：

```
>>> sorted(d.items(), key=lambda(k,v): v)
[('bye', 14), ('ciao', 17), ('hello', 23)] 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-17T16:00:47.837

A`defaultdict`没有秩序。您可能需要使用[`OrderedDict`](http://docs.python.org/library/collections.html), 或每次将键排序为列表。

例如：

```
 from operator import itemgetter
  sorted_city_pop = OrderedDict(sorted(cityPopulation.items())) 
```

编辑：如果您只想打印订单，只需使用`sorted`内置：

```
for key, value in sorted(cityPopulation.items()):
    print(key, value) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-06-17T00:21:45.333

迟到的答案，而不是问题的直接答案，但如果你最终从“***在 python 中按值排序 defaultdict*** ”谷歌搜索，这就是我*的排序方式*（普通的 python 字典不能排序，但它们可以是打印排序） a`defaultdict`按其值：

```
orders = {
    'cappuccino': 54,
    'latte': 56,
    'espresso': 72,
    'americano': 48,
    'cortado': 41
}

sort_orders = sorted(orders.items(), key=lambda x: x[1], reverse=True)

for i in sort_orders:
    print(i[0], i[1]) 
```

# wpf - 在 XAML 中引用静态资源

> ID：10194715
> 
> 赞同：1
> 
> 时间：2012-04-17T15:57:48.430
> 
> 标签：wpf, xaml, staticresource, viewmodellocator

我有一个 UserControl，它引用了一个 StaticResource，它通常会在 app.xaml 中被引用并且很好……但我的程序集是一个库项目，所以没有 app.xaml。我现在如何引用这个 StaticResource？

这是我试图引用它的 UserControl

```
<UserControl 
   d:DataContext="{Binding Source={x:Type main:IViewModel}, 
   Converter={StaticResource viewModelLocator}}"> 
```

这是它通常在 app.xaml 中的位置

```
<Application xmlns:t="http://schemas.t.com/wpf" xmlns:app="clr-namespace:T.UI">
<Application.Resources>
    <t:ViewModelLocator 
       x:Key="viewModelLocator" 
       Container="{x:Static app:ConfigurationPlugin.Container}" />
</Application.Resources> 
```

我只是收到错误消息“无法解析 viewModelLocator”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:01:05.820

将资源添加到 UserControl 的资源本身应该可以解决问题；事实上，几乎每个 Wpf 元素都有一个`Resources`属性。

```
<UserControl.Resources> 
  <t:ViewModelLocator x:Key="viewModelLocator"  
       Container="{x:Static app:ConfigurationPlugin.Container}" /> 
</UserControl.Resources> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:01:44.760

```
<UserControl.Resources>
   .... 
```

除非我不明白你的问题。

# spell-checking - 如何删除某些 Aspell 词典？

> ID：10194717
> 
> 赞同：1
> 
> 时间：2012-04-17T15:57:52.710
> 
> 标签：spell-checking, aspell

如果我运行**aspell dump dicts**，我会列出以下字典。如果我只想保留 en_GB 和 en_US，我该如何摆脱其他人？我已经阅读了[此处](http://aspell.net/man-html/Working-With-Dictionaries.html#Working-With-Dictionaries)的文档，但不知道如何执行此操作。（如果相关，这在 Linux 和 Windows 上都适用。）

```
en
en_CA
en_CA-w-accents
en_GB
en_GB-w-accents
en_US
en_US-w-accents
es
fr-40
fr-60
fr
fr-80
fr_CH-40
fr_CH
fr_CH-60
fr_CH-80
fr_FR-40
fr_FR-60
fr_FR
fr_FR-80 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T06:51:58.383

**忽略答案，如果我理解错误的问题！**或者告诉我更多关于你的意思。

**在 Windows 上：**

如果您只想要已安装字典的列表，您可以使用 ..

```
aspell dicts | findstr /I en_ 
```

仅显示 "en_" 包含的 dicts 的名称

在linux上看“grep”

**如果你想隐藏听写**

搜索 fr_*.multi 并将所有这些文件移出 Aspell dict 文件夹。

# android - 从 PUSH 通知中打开 android 应用

> ID：10194718
> 
> 赞同：9
> 
> 时间：2012-04-17T15:57:53.147
> 
> 标签：android, push-notification, android-pendingintent, urbanairship.com

有个小问题一直困扰着我。。

我已经将我的应用程序设置为接收来自 Urban Airship 的 PUSH 通知，并且一切正常，但是当我在通知中心点击通知时，什么也没有发生。

我希望我的应用程序在用户点击推送通知时打开 - 我可以做些什么来实现这一点？

一如既往地非常感谢任何帮助。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-17T16:14:17.507

创建一个挂起的 Intent 以启动 Activity 并使用 setLatestEventInfo 在通知中设置它。

例子：

```
 Context context = getApplicationContext();
CharSequence contentTitle = "My notification";
CharSequence contentText = "Hello World!";
Intent notificationIntent = new Intent(this, MyClass.class);
PendingIntent contentIntent = PendingIntent.getActivity(this, 0, notificationIntent, 0);
notification.setLatestEventInfo(context, contentTitle, contentText, contentIntent); 
```

更多信息可以在[这里找到](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:11:56.717

您需要使用自定义通知构建器并将您的一项活动用作 PendingIntent。

[https://docs.urbanairship.com/android-lib/reference/com/urbanairship/push/CustomPushNotificationBuilder.html](https://docs.urbanairship.com/android-lib/reference/com/urbanairship/push/CustomPushNotificationBuilder.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-23T14:24:02.560

按照他们的示例项目之一（[https://github.com/urbanairship/android-samples/tree/master/app/src/main/java/com/urbanairship/sample](https://github.com/urbanairship/android-samples/tree/master/app/src/main/java/com/urbanairship/sample)），您可以扩展 AirshipReceiver 类，然后覆盖onReceive 方法。这对我有用：

```
@Override
public void onReceive(Context context, Intent intent) {
    super.onReceive(context, intent);

    String action = intent.getAction();
    if (action.equals(PushManager.ACTION_NOTIFICATION_OPENED)) {
        Intent launch = new Intent(Intent.ACTION_MAIN);
        launch.setClass(UAirship.shared().getApplicationContext(), MyHome.class);
        launch.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        launch.putExtra("doWhatever",true);
        UAirship.shared().getApplicationContext().startActivity(launch);
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-14T10:23:37.833

您必须在调用 .setAutoCancel(true) 之前调用 pendingIntent；

看看我的建设者：

```
 NotificationCompat.Builder builder = new NotificationCompat.Builder(getApplicationContext(),channel_id).setSmallIcon(R.drawable.logo).setSound(uri).setVibrate(new long[]{1000,1000,1000,1000,1000})
            .setOnlyAlertOnce(true).setContentIntent(pendingIntent).setAutoCancel(true); 
```

# php - 学习getjson

> ID：10194720
> 
> 赞同：1
> 
> 时间：2012-04-17T15:57:53.357
> 
> 标签：php, jquery

我试图掌握如何使用`$.getJSON`PHP 中的数组。

这是一个简单的示例，我要做的就是输出请求的信息。应该`alert(data)`返回数组对象吗？我没有提醒任何事情。

PHP 文件（account.php）：

```
$arr = array('items' => 5,'others' => 6); 
echo $arr = json_encode($arr) 
```

HTML 文件：

```
$("#unsubscribe").click(function() {
    $.getJSON("account.php?", function(data) { 
        alert(data);    
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:01:09.090

首先，如果您尝试`account.php`在浏览器中加载，这可能是一个好主意。您应该期望看到：

```
{"items":5,"others":6} 
```

但是，您不会看到这一点。相反，您将看到 Parse Error, expected `;`。因为你忘了就`echo`行了。

这就是你看到 no 的原因`alert`。PHP 错误显然不是有效的 JSON，查看浏览器的错误控制台会告诉您这一点；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:15:03.217

在我的项目中，我使用转储函数来查看 json 返回的数组。这里是：

```
function dump(arr,level) {
var dumped_text = "";
if(!level) level = 0;

//The padding given at the beginning of the line.
var level_padding = "";
for(var j=0;j<level+1;j++) level_padding += "    ";

if(typeof(arr) == 'object') { //Array/Hashes/Objects 
    for(var item in arr) {
        var value = arr[item];

        if(typeof(value) == 'object') { //If it is an array,
            dumped_text += level_padding + "'" + item + "'"+"\\n";
            if (level < 0)
                dumped_text += dump(value,level+1);
        } else {
            dumped_text += level_padding + "'" + item + "' => '" + value + "'"+"\\n";
        }
    }
} else { //Stings/Chars/Numbers etc.
    dumped_text = "===>"+arr+"<===("+typeof(arr)+")";
}
return dumped_text;
} 
```

# octal - 将八进制转换为其他数字系统的单一算法

> ID：10194722
> 
> 赞同：-2
> 
> 时间：2012-04-17T15:57:55.020
> 
> 标签：octal

我遇到了一种非常简洁的算法，可以将十进制数转换为其他数字系统。程序要求两个输入：要转换的数字和基数。输出是所需的基数。我想知道是否有可能将八进制数转换为选择的基数的单一算法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:05:19.820

当然这是可能的。任何基数中的任何数字都可以写成任何其他基数。例如，将基数 ​​8 转换为基数 2 非常容易，只需从后面一个接一个地使用长度 3 将每个数字写入基数 2（这是因为 8 = 2^3），例如

```
 0o1234 
    1 > 001
    2 >    010
    3 >       011
    4 >          100
      0b001010011100 
```

我敢打赌，您用于从基数 10 转换为其他基数的算法可以轻松修改为基数 8。

# c# - 如何让服务在特定时间运行？

> ID：10194723
> 
> 赞同：1
> 
> 时间：2012-04-17T15:57:55.180
> 
> 标签：c#, web-services, timer

我有一项服务，目前我认为它每 10 分钟运行一次，但我希望它每天晚上 7 点运行，我需要更改什么？……

```
 private Timer _timer;
    private DateTime _lastRun = DateTime.Now;

    protected override void OnStart(string[] args)
    {
        _timer = new Timer(10 * 60 * 1000); // every 10 minutes??
        _timer.Elapsed += new System.Timers.ElapsedEventHandler(timer_Elapsed);
    }

    private void timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
    {

        if (_lastRun.Date < DateTime.Now.Date)
        {
            // stop the timer 
            _timer.Stop();               

            try
            {
                SmartImportService.WebService.WebServiceSoapClient test = new WebService.WebServiceSoapClient();
                test.Import();
            }
            catch (Exception ex) { }

            _lastRun = DateTime.Now;
            _timer.Start();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:02:48.700

更换：

```
if (_lastRun.Date < DateTime.Now.Date)
{
} 
```

和：

```
DateTime startAt = DateTime.Today.AddHours(19);
if (_lastRun < startAt && DateTime.Now >= startAt)
{
} 
```

可能会成功。但我更喜欢使用已经建议的计划任务

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:02:30.967

Windows 服务是一个持续运行的任务。如果您正在寻找需要在指定时间运行的东西，请编写[计划任务](http://windows.microsoft.com/en-US/windows7/schedule-a-task)， [其他好链接](https://stackoverflow.com/questions/767490/windows-service-or-scheduled-task-which-one-do-we-prefer)。

# animation - iOS5将CGAffineTransform与animationImages结合起来？

> ID：10194724
> 
> 赞同：2
> 
> 时间：2012-04-17T15:58:03.057
> 
> 标签：animation, ios5, uiimageview, uiimage, cgaffinetransform

我对 iOS 动画很陌生，我想知道是否可以使用 CGAffineTransform 将两个图像之间的过渡与 UIImageView 的翻译动画结合起来？

换句话说，我有两个想要在它们之间制作动画的图像，然后我想应用同步翻译，以便整个东西在页面上移动，同时在两个图像之间来回移动。

我知道我可以应用[CGAffineTransformConcat](http://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGAffineTransform/Reference/reference.html)来组合两个 CGAffineTransforms，例如[CGAffineTransformTranslate](http://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGAffineTransform/Reference/reference.html)和其他东西。但我没有看到允许我转换到另一个 UIImage 的 CGAffineTransform。

我知道在图像之间制作动画的唯一方法是使用 UIImageView [animationImages](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIImageView_Class/Reference/Reference.html)数组和 startAnimating。但是，我不知道如何将它与这样的翻译结合起来：

```
UIImageView* textView = [[UIImageView alloc] initWithFrame:bunnyImage.frame]; 

textView.animationImages = [NSArray arrayWithObjects:    
                            [UIImage imageNamed:@"bunnyclose.png"],
                            [UIImage imageNamed:@"bunnytalk.png"],
                            nil];

textView.animationDuration = 1.0;
textView.animationRepeatCount = 8;
[textView startAnimating];

[self.view addSubview:textView]; 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T15:36:59.253

在回答我自己的问题时，[“创建视图之间的动画过渡”](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/AnimatingViews/AnimatingViews.html)中讨论的块动画函数[transitionFromView:toView:duration:options:completion](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/clm/UIView/transitionFromView%3atoView%3aduration%3aoptions%3acompletion%3a)是我想出的最佳解决方案。我使用它在图像之间制作动画，这可以与块动画[animateWithDuration:delay:options:animations:completion:](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/clm/UIView/transitionFromView%3atoView%3aduration%3aoptions%3acompletion%3a)结合使用 CGAffineTransformTranslate 或简单地更改UIImageView的[中心，如](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instp/UIView/center)[Animations](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/AnimatingViews/AnimatingViews.html)中所述。

修改我的原始代码块并添加我的翻译看起来像这样：

```
UIImageView* bunny2View = [[UIImageView alloc] initWithFrame:bunny2Image.frame]; 

[UIView 
 transitionFromView:bunny2Image 
 toView:bunny2View 
 duration:10.0 
 options:UIViewAnimationOptionShowHideTransitionViews 
 completion:^(BOOL finished) {
     [UIView 
      animateWithDuration:dur 
      animations:^(void) {
          CGPoint center = bunny2Image.center;
          center.y += deltay;
          bunny2Image.center = center;
          bunny2View.center = center;
      }
      completion:^(BOOL finished) {

          [UIView 
           transitionFromView:bunny2View 
           toView:bunny2Image 
           duration:10.0 
           options:UIViewAnimationOptionShowHideTransitionViews 
           completion:nil];
      }];
 }]; 
```

仍在进行中，但这是我迄今为止提出的！

# jquery - JQuery点击事件只工作一次

> ID：10194728
> 
> 赞同：28
> 
> 时间：2012-04-17T15:58:17.470
> 
> 标签：jquery

这是我已经拥有的：

```
<html>
    <head>
    <link rel="stylesheet" type="text/css" href="reset.css" />
    <script src="jquery.js"></script>
    <script>
        $(function () {
            // Page Load
            //// Set default size of canvas
            var canvas_height = 124;
            var canvas_width = 124;
            //// Set starting point and first option point
            $('#canvas div:first-child').addClass('start');
            $('#canvas div:nth-child(2)').addClass('option');
            GenerateIDs();

            $('#btnID').click(function(){
                GenerateIDs();
            });

            // Generates IDs dynamically
            function GenerateIDs(){
                var row = 0;
                var col = 0;
                var lastdivposition = 0;
                $('#canvas div').each(function(){
                    if ($(this).position().top > lastdivposition)
                    {
                        row += 1;
                        col = 1;
                    }
                    else
                        col += 1;
                    $(this).attr('id', row + '-' + col);
                    lastdivposition = $(this).position().top
                });
            }

            $('.option').click(function(){
                if($(this).attr('id').split('-')[0] != $(this).next().attr('id').split('-')[0])
                {
                    $('.option').each(function(){
                        $(this).removeClass('option');
                    });
                    AddDivs('c')
                    GenerateIDs();
                    $(this).removeClass('option').removeClass('blank').addClass('object');
                    //$(this).next().addClass('option');
                    $('.object').each(function(){            
                        if($('#' + $(this).attr('id').split('-')[0] + '-' + (parseInt($(this).attr('id').split('-')[1]) + 1)).hasClass('blank'))
                            $('#' + $(this).attr('id').split('-')[0] + '-' + (parseInt($(this).attr('id').split('-')[1]) + 1)).removeClass('blank').addClass('option');
                        if($('#' + (parseInt($(this).attr('id').split('-')[0]) + 1) + '-' + $(this).attr('id').split('-')[1]).hasClass('blank'))
                            $('#' + (parseInt($(this).attr('id').split('-')[0]) + 1) + '-' + $(this).attr('id').split('-')[1]).removeClass('blank').addClass('option');
                    });
                }
            });

            // Adds row if type = r, column if type = c
            function AddDivs(type){
                if(type == 'r')
                {
                    canvas_height += 62;
                    $('#canvas').children('div').each(function(){
                        if($(this).position().top == $('#canvas div:first-child').position().top)
                            $('#canvas').append('<div class="blank"></div>');
                    });
                    $('#canvas').css('height', canvas_height + 'px');
                }
                if(type == 'c')
                {
                    canvas_width += 62;
                    $('#canvas').children('div').each(function(){
                        if($(this).position().left == $('#canvas div:first-child').position().left)
                            $('#canvas').append('<div class="blank"></div>');
                    });
                    $('#canvas').css('width', canvas_width + 'px');
                }                    
            }
        });
    </script>
    <style>
        #canvas, #toolbox {float:left; height:124px; margin:25px; padding:5px; width:124px;}
        .blank {background-color:gray;}
        .start {background-color:green;}
        .object {background-color:blue;}
        .option {background-color:yellow;}
        body div {border:1px solid black;}
        body div div {float:left; height:50px; margin:5px; width:50px;}
    </style>
</head>

<body>
    <div id="toolbox">
        <div></div>
        <div></div>
        <div></div>
        <div></div>        
    </div>
    <div id="canvas">
        <div class="start"></div>
        <div class="option"></div>
        <div class="blank"></div>
        <div class="blank"></div>
    </div>
    <br /><br />
    <div style="background-color:#AAAAAA; clear:left;">
        <input id="btnID" type="button" value="Generate IDs" />
        <input id="btnAddRow" type="button" value="Add Row" />
        <input id="btnAddCol" type="button" value="Add Col" />
         - LEGEND:
        <span style="color:green; font-size:20px; font-weight:bold;">START</span>
        <span style="color:yellow; font-size:20px; font-weight:bold;">OPTION</span>
        <span style="color:blue; font-size:20px; font-weight:bold;">OBJECT</span>
    </div>
</body>
</html>​ 
```

（这里有一个运行中的 jsFiddle；[http://jsfiddle.net/DUCY3/1/](http://jsfiddle.net/DUCY3/1/)）

基本上从长远来看，当您单击黄色时，它应该继续添加列/行。但它甚至没有第二次感应到点击事件。不知道为什么。谢谢。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-04-17T16:04:17.013

您需要更改此行：

```
$('.option').click(function() {  //etc 
```

到

```
$('.option').live('click', function(){  //etc 
```

这将确保所有“选项”框都将获得 onclick 事件。请注意，在 jQuery 的更高版本中，live 方法已被替换为“on”。见[http://api.jquery.com/on/](http://api.jquery.com/on/)

编辑：使用“on”使用委托事件 - 像这样：

```
$('#canvas').on('click', '.option', function() { 
    //event handler...
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-04-17T16:53:42.783

我会使用委托功能，（以防万一您选择更新到较新版本的 jquery），

```
$(document).delegate('.option', 'click', function(){
    //etc
}); 
```

**2017 年编辑：**委托功能已被弃用，现在正确的用法是

```
$(document).on('click', '.option', function(){
    //etc
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-02T11:49:49.823

```
this.destroy();
location.reload(); 
```

只需在 js 函数的末尾添加这些行。

# scala - @specialized 在特征中的用法

> ID：10194730
> 
> 赞同：6
> 
> 时间：2012-04-17T15:58:20.407
> 
> 标签：scala, specialization, autoboxing

我有一个特征和一个实现，如下所示：

```
trait Foo[A] {
  def bar[B >: A: Ordering]: Foo[B]
}
class FooImpl[A]( val a: A, val values: List[Foo[A]] ) extends Foo[A] {
  def bar[B >: A] = { /* concrete implementation */}
} 
```

我想使用`@specialized`注释`A`并`B`避免自动装箱。我需要在 trait 和 implementation 中使用它，仅在 implementation 中，还是仅在 trait 中使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T09:12:54.637

REPL 为我们提供了正确的答案，还有 javap，它将显示反汇编的 java 代码。如果你将 tools.jar 添加到你的 REPL 类路径中，你将能够做如下很酷的事情：

```
scala>  trait Foo[@specialized(Int) A] { def doSomething(a:A)}
defined trait Foo

scala>  :javap -p Foo
Compiled from "<console>"
public interface Foo{
    public abstract void doSomething(java.lang.Object);
    public abstract void doSomething$mcI$sp(int);
}

scala> class Hello extends Foo[Int] { def doSomething(a:Int)=println(a)}
defined class Hello

scala>  :javap -p Hello
Compiled from "<console>"
public class Hello extends java.lang.Object implements Foo$mcI$sp,scala.ScalaObject{
    public void doSomething(int);
    public void doSomething$mcI$sp(int);
    public void doSomething(java.lang.Object);
    public Hello();
} 
```

因此，现在您应该清楚，仅在 trait 级别提供 @specialized 就足够了：在 Foo 接口中，您显然有两个方法声明。然而，在我看来，那里正在发生一个诡计：

```
scala>  new Hello
res0: Hello = Hello@7a80747

scala>  res0.doSomething("test")
<console>:11: error: type mismatch;
 found   : java.lang.String("test")
 required: Int 
```

虽然我可以回答你的问题，但有些问题我无法回答：

*   为什么这些方法在特征中被定义为公共抽象？
*   为什么反汇编的类中有方法doSomething(java.lang.Object)，但不能调用？

# jenkins - Jenkins 在远程机器上构建

> ID：10194734
> 
> 赞同：0
> 
> 时间：2012-04-17T15:58:23.400
> 
> 标签：jenkins, gerrit

我只能在 FreeBSD 5 机器上构建我的系统。我正在寻找 gerrit 和 Jenkins 并将其引入我的团队。我现在已经在 Debian 机器上设置了运行 gerrit 和 Jenkins 的服务器。处理在远程服务器上构建 Jenkins 的标准方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T10:19:36.830

标准方法是在远程服务器上安装 Jenkins Slave。见[https://wiki.jenkins-ci.org/display/JENKINS/Distributed+builds](https://wiki.jenkins-ci.org/display/JENKINS/Distributed+builds)

然后，您将必须在 FreeBSD 5 机器上构建的作业设置为仅在该从机/节点上运行。这可以在作业配置中通过按名称指定 FreeBSD 机器来实现。

如果您不希望其他 Jenkins 作业在该 FreeBSD 机器上运行，您可以将 slave 配置为仅运行与其绑定的作业。[请参阅JENKINS 分步指南](https://wiki.jenkins-ci.org/display/JENKINS/Step+by+step+guide+to+set+up+master+and+slave+machines)中的第 4步，为您需要执行此操作的配置页面设置主机和从机。

# android - 为什么actionbar sherlock在2.1中没有出现？

> ID：10194736
> 
> 赞同：1
> 
> 时间：2012-04-17T15:58:38.893
> 
> 标签：android, actionbarsherlock, android-actionbar

我将 Sherlock 库添加到我的项目中，并将所需的类和代码添加到我的项目中。当我测试它时，动作栏只出现在 android 4 模拟器中。当我在 2.1 模拟器中尝试时，Actionbar 没有出现。你能给我一些建议我该如何解决它？我为 sherlock 库和我的项目设置了目标 15。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:11:55.730

您需要执行以下操作：

适当设置最低和目标 SDK 级别

```
<uses-sdk android:minSdkVersion="7" android:targetSdkVersion="15" /> 
```

`Activity`将您的 's更改为`SherlockActivity`'s，并将`Fragment`'s 更改为`SherlockFragment`'s

将您的主题设置为您自己的主题之一，或者是直接主题`Theme.Sherlock`或其子主题之一，例如`Theme.Sherlock.Light`

最后; ABS 样式反映了本机操作栏的样式，因此您需要定义每个样式元素两次。例如：

```
<style name="Widget.Styled.ActionBar" parent="Widget.Sherlock.Light.ActionBar.Solid.Inverse">
    <item name="background">@drawable/blue_gradient</item>
    <item name="android:background">@drawable/blue_gradient</item>

    <item name="displayOptions">useLogo|showHome</item>
    <item name="android:displayOptions">useLogo|showHome</item>

    <item name="icon">@drawable/actionbar_logo</item>
    <item name="android:icon">@drawable/actionbar_logo</item>       

    <item name="backgroundSplit">@drawable/bg_striped_split</item>
    <item name="android:backgroundSplit">@drawable/bg_striped_split</item>
</style> 
```

编辑：我也做了一个入门视频教程：[http ://www.youtube.com/watch?v=4GJ6yY1lNNY](http://www.youtube.com/watch?v=4GJ6yY1lNNY)

# php - 链接到 codeigniter 中分页中的特定项目

> ID：10194739
> 
> 赞同：0
> 
> 时间：2012-04-17T15:58:44.087
> 
> 标签：php, codeigniter, pagination

这是我想要做的..

我正在为我的一位艺术家朋友制作一个“画廊”网站，她想要的是她在屏幕上显示的所有照片，但是一旦你点击一张照片，她希望它只转到那张照片并有一个“下一张”和“返回”箭头转到下一张图片。她不想使用灯箱等。我知道如何使分页工作，但是，我想做的是如果他们从“显示所有图片（缩略图）”屏幕中选择一张特定的图片，它将产生“ next" 和 "prev" 并选择分页已经存在的顺序。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T05:56:30.040

您可以分配页码。我的意思是假设用户在第一页。以某种方式将所有缩略图附加 1 以进行识别。然后当用户点击缩略图时，获取数字并将其作为页码放入分页代码中，以便查询以获取结果。这不会影响其他事情，一切都会顺利进行。

# silverlight - 是否应该将复杂的 Silverlight 页面拆分为控件，即使它们不会被重用

> ID：10194743
> 
> 赞同：0
> 
> 时间：2012-04-17T15:59:00.903
> 
> 标签：silverlight, mvvm

## 背景

我正在处理一个已经变得相当复杂的 Silverlight 页面。它有 650 行，包含它有四个网格视图、一个选项卡控件等。还要注意我们遵循 MVVM 模式。这是silverlight 5，如果这很重要的话。

该页面似乎适合拆分为具有四个控件的主页。我怀疑这些控件是否会在其他页面中重复使用。

一个好处是，使用所有缩进，使用 xaml 有点尴尬。第二个好处是我相信，如果控件分开，它会更容易理解/理解。

## 问题

如果我将 xaml 拆分为单独的控件，是否还应该拆分 ViewModel？出于同样的原因，它会使视图模型不那么复杂，并且在它所使用的控件的上下文中更容易理解。

拆分控件是否有任何潜在问题？如果由于某种原因一个控件上的复选框应该影响另一个控件的行为，可能会出现绑定问题？但这可以通过让各种视图模型相互引用来解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:17:41.827

我会说是的，您应该将页面拆分为单独的控件，是的，**如果**这样做的成本低于当前模型所造成的维护困难的成本，您应该拆分视图模型。

这带来的大多数挑战可以通过拥有一个包含对所有子视图模型的引用并管理它们之间的关系的主视图模型来解决。

# javascript - 想要扩展原型方法

> ID：10194744
> 
> 赞同：0
> 
> 时间：2012-04-17T15:59:10.997
> 
> 标签：javascript, jquery

我有以下代码：

```
 var defaults = {
        test: function () {
            alert('Test');
        }
    };

    function Foo(options) {
        o = $.extend({}, defaults, options);
        Foo.prototype.test = o.test;
    }
    Foo.prototype.test = defaults; 
```

我希望测试方法应该是可扩展的，并且我希望它被用作：

```
 var f = new Foo({
        test: function() {
            alert('Test2');
        }
    });

    var f1 = new Foo({
        test: function () {
            alert('Test3');
        }
    });

    f.test();//alert(test2) should be called
    f1.test(); //alert(test3) should be called 
```

编辑：我没有得到我在评论中写的内容作为输出。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T16:03:40.970

你在那里混合了隐喻。三个选项供您选择：

*   功能性
*   简单的构造函数，覆盖每个实例（你想要做什么）
*   可重用的原型继承

## 功能性

听起来你喜欢 Douglas Crockford 喜欢的*函数继承*形式，它摒弃了原型，取而代之的是他所谓的“制造者”函数：

```
var f = makeFoo({
    test: function() {
        alert('Test2');
    }
});

var f1 = makeFoo({
    test: function () {
        alert('Test3');
    }
});

f.test();
f1.test(); 
```

...在哪里`makeFoo`：

```
function makeFoo(options) {
    return $.extend({}, makeFoo.defaults, options);
}
makeFoo.defaults = {
    test: function() {
        alert("Default test");
    }
}; 
```

[实例](http://jsbin.com/inufaq)| [来源](http://jsbin.com/inufaq/edit)

我自己不是它的忠实粉丝，但有很多人喜欢而且肯定喜欢大多数东西，它有优点也有缺点。优点之一是它非常简单。

## 简单的构造函数，覆盖每个实例

但是您可以使用构造函数来做到这一点，就像您尝试过的那样；您将选项应用于`this`而不是创建自己的单独对象：

```
function Foo(options) {
    $.extend(this, options);
}
Foo.prototype.test = function() {
    alert("Default test");
};

var f = new Foo({
    test: function() {
        alert("Test2");
    }
});

var f2 = new Foo({
    test: function() {
        alert("Test3");
    }
});

f.test();
f2.test(); 
```

[实例](http://jsbin.com/igonam)| [来源](http://jsbin.com/igonam/edit)

## 可重用的原型继承

如果您想更进一步并基于原型继承拥有适当的层次结构（因此您可以创建多个具有特定覆盖`test`功能的对象），则需要做更多的工作，但您的优势在于调用“超级"的函数版本可以非常简单。管道非常复杂，我为此使用了一个库，在我的例子中，我自己的库名为[`Lineage`](http://code.google.com/p/lineagejs/)，但 Prototype 有类似的名称[`Class`](http://api.prototypejs.org/language/Class/)，还有其他几个。

在进行原型继承时，您有构造函数，然后用它们构造实例。上面可能看起来像这样`Lineage`：

```
var ParentFoo = Lineage.define(function(p) {
    p.test = function() {
      alert("Default test");
    };
});

var FooChild1 = Lineage.define(ParentFoo, function(p) {
    p.test = function() {
      alert("Test2");
    };
});

var FooChild2 = Lineage.define(ParentFoo, function(p) {
    p.test = function() {
      alert("Test3");
    };
}); 
```

[实例](http://jsbin.com/ojebuh)| [来源](http://jsbin.com/ojebuh/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:03:08.403

你就不能这样做吗？

```
function Foo(options) {
    o = $.extend({}, defaults, options);
    this.test = o.test;
} 
```

# java - 覆盖 CXF 错误处理

> ID：10194748
> 
> 赞同：11
> 
> 时间：2012-04-17T15:59:38.503
> 
> 标签：java, soap, cxf

我正在开发一些基于 Web 服务的应用程序，并且我有一个关于 Apache CXF 解组的问题。在我们的项目中，我们使用 CXF 2.4.1 版本。

当某些 SOAP 请求不正确（例如，某些字段是文本而不是数字）时，CXF 会抛出标准 SOAPFaultException 并且 SOAP 响应是使用标准字段构建的，例如：

```
<soap:Fault>
    <faultcode>soap:Client</faultcode>
    <faultstring>Unmarshalling Error: some field missing</faultstring>
</soap:Fault> 
```

项目要求表明，如果出现任何故障系统需要以其他格式响应，例如：

```
<soap:body>
    <ResponseState>
        <ErrorCode>2732</ErrorCode>
        <ErrorMessage>Unmarshalling Error: some field missing</ErrorMessage>
        <ErrorDetails> some details </ErrorDetails>
        <some other fields>
        ...
    </ResponseState>
</soap:body> 
```

所以问题是：我怎样才能以某种方式覆盖这个错误处理并以我的格式而不是默认格式响应？

提前致谢。

PS 我试图研究一些 ValidationEventHandler 主体，但它在 CXF 2.0 及更高版本中以其他方式工作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-19T12:06:36.273

好的，经过大量研究，我发现了一些 CXF 错误处理的方法。

*。ValidationEventHandler 使您可以抛出自己的异常而不是标准异常。但是您无法更改响应行为，也无法更改 SOAP 响应格式。

*。另一种改变错误处理的方法是创建自己的拦截器。CXF 工作流建立在拦截器链上。有 4 种类型的拦截器：inInterceptor、outInterceptor、inFaultInterceptor 和 outFaultInterceptor。

使用一些聪明的技巧，您可以通过创建自己的拦截器（将其添加到链中）来更改工作流程，并从链中删除标准拦截器（如果您知道它的类名）。所以你实际上可以做任何你需要的事情。

但就所有这些拦截器手动编组响应（xmlWriter.writeStartElement() 等）而言，为每个流程阶段编写自己的拦截器可能是一个巨大的挑战。这可能是一大堆工作。

不幸的是，我还没有找到关于 CXF 拦截器的好的参考资料。

另一件事 - 如果您需要返回常规响应而不是 SOAPFaultException，您可能需要其他信息，例如：返回此响应的实际服务、请求中传递的服务参数等。我没有在拦截器的可访问参数中找到此信息。而且，当然，这样做你欺骗了将返回 OK 而不是真正异常的客户端代码。

*。将所有参数作为文本设计您的 wsdl 可能不是很好的解决方案：

一个。如果 wsdl 中没有数据类型和验证规则，您的服务的使用者可能会感到非常困惑。

湾。您需要“重新发明轮子”进行验证。我的意思是您需要编写自己的验证器，这对于一些复杂的规则可能非常困难。同时，XSD 实现了所有这些验证并经过了良好的测试。

最后是关于我的情况：我们与需求经理讨论过，并决定在请求中违反 XML 模式要求时允许 CXF 抛出它自己的标准异常。这是一个很好的解决方案，因为现在我们正在使用 XSD 验证的所有功能，并且不会将时间浪费在复杂和无用的工作上。

非常感谢@ericacm 的回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T22:19:35.103

您当然可以生成比默认使用`ValidationEventHandler`和抛出符合 JAX-WS 故障规范的故障更好的错误响应。但它只允许您进行如此多的自定义 - 会有一些您无法控制的元素。例如，这是来自我的一个应用程序的 ValidationEventHandler 响应：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <soap:Fault>
         <faultcode>soap:Client</faultcode>
         <faultstring>Errors in request</faultstring>
         <detail>
            <ns2:ValidationFault xmlns:ns2="http://notification.ws.foo.com/">
               <errors>
                  <error>
                     <inputElement>topicId</inputElement>
                     <errorMessage>java.lang.NumberFormatException: For input string: "" [line:6]</errorMessage>
                  </error>
               </errors>
            </ns2:ValidationFault>
         </detail>
      </soap:Fault>
   </soap:Body>
</soap:Envelope> 
```

你不能对`<soap:Fault>, <faultcode> and <faultstring>`元素做任何事情。但一切都是`<ValidationFault>`习惯`</ValidationFault>`。

如果您需要对响应进行更详细的控制，则应将字段类型从数字更改为字符串，然后在代码中进行验证，而不是让解组器捕获错误。

是的，我同意，强迫它成为一个字符串会很糟糕，但如果响应必须完全符合您在上面指定的内容，那么如果不深入 CXF 而不是 JAX-WS 层（例如使用拦截器），就不可能.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-04T10:06:47.360

另一种选择是使用[CXF 变换](http://cxf.apache.org/docs/transformationfeature.html#TransformationFeature-Replacingtextcontent)功能

`<entry key="Fault" value="ResponseState=..."/>`

这会将来自服务器的原始故障映射到任何其他故障，以便您的客户端可以接受它。

# multithreading - Xpages 中的多个线程

> ID：10194751
> 
> 赞同：0
> 
> 时间：2012-04-17T15:59:53.260
> 
> 标签：multithreading, xpages

我有问题，希望有人能帮助我

我正在尝试从 XAgent 启动多个线程（未呈现 XPage）

```
public class ImportThread extends NotesThread {

Session currentSession;

public ImportThread(String maildb, String Server)
{

try{
   currentSession =DominoAccess.getCurrentSession();
   this.maildb = currentSession.getDatabase(Server, maildb);
}catch (Exception e) {
e.printStackTrace();
}

}

public void runNotes()
{
   View v = maildb.getView("$Calendar");
} 
```

在这个版本中，我无法访问视图我只得到“null”返回我尝试了一个 Java 线程版本并没有更好。

我在 Openntf [http://www.openntf.org/internal/home.nsf/project.xsp?action=openDocument&name=Threads%20and%20Jobs上找到了一些东西](http://www.openntf.org/internal/home.nsf/project.xsp?action=openDocument&name=Threads%20and%20Jobs)

但我得到了一个“访问控制异常”

我没有更多的想法，我希望有人知道如何创建具有多线程的 XAgent

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T06:59:22.060

As Egor wrote you need the change the Java policy file if you run the Java code from an NSF. You don't have to do this if you deploy your Java code as OSGi plugin. See the documentation of that OpenNTF project.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T00:59:54.907

Afaik NotesObjects 不应在线程之间共享。因此，您应该使用 String mailDBName 并在它们自己的线程中实例化所有 NotesObjects，而不是使用数据库 mailDB。您还需要注意运行时间：如果您的 XAgent 等待踏板结束，您应该没问题，但如果它是一种“即发即弃”的方法，您需要从更持久的东西（如托管 bean）启动它会话范围。希望有帮助

# linux - CPU如何从磁盘读取数据？

> ID：10194762
> 
> 赞同：7
> 
> 时间：2012-04-17T16:00:30.103
> 
> 标签：linux, architecture, io, cpu, block

我对 IO 的整个概念有点困惑；我想知道 CPU 如何从磁盘（例如 SATA 磁盘）读取数据？

当具有 read()/write() 的程序符合对特定文件的引用并且 CPU 遇到此引用时，它是否直接从磁盘读取（通过内存映射的 IO 端口）？还是先写入 RAM，然后再写入磁盘？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:18:24.923

我建议阅读： http: [//www.makelinux.net/books/ulk3/understandlk-CHP-13-SECT-1](http://www.makelinux.net/books/ulk3/understandlk-CHP-13-SECT-1) 补充： [http ://en.wikipedia.org/wiki/Direct_memory_access](http://en.wikipedia.org/wiki/Direct_memory_access)

关于 RAM 中的缓冲：大多数编程语言和操作系统将至少部分 I/O 操作（读取和写入）缓冲到内存中。这通常是异步完成的：即创建、填充、然后处理缓冲区。对于读取，CPU 将（与磁盘控制器一起工作）创建 IO 指令以获取数据并在内存中放置一个位置，填充该空间，然后将其内容呈现给发出请求的程序。对于写请求，这将是对写操作及其相关数据进行排队，然后将它们发送到 IO 控制器并最终发送到要执行的磁盘。缓冲可以发生在多个地方：CPU 的缓存、RAM、（有时）磁盘控制器或硬盘本身。做了多少缓冲，以及我的抽象操作序列到底如何

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T16:24:37.487

> **主存是处理器可以直接访问的唯一大型存储区域（数百万到数十亿字节）。**

《操作系统概念》说。

所以如果你想运行一个程序或操作一些数据，它们（程序和数据）必须在主存中。

# node.js - Node.js 和 Google Pagespeed API

> ID：10194763
> 
> 赞同：4
> 
> 时间：2012-04-17T16:00:31.077
> 
> 标签：node.js, curl, https, pagespeed

我正在尝试在 Node 中构建一个小的 Google Pagespeed 客户端，但我正在努力使用 https 客户端。请求总是返回 302 响应，但完全相同的 url 在 curl 和浏览器中完美运行

```
options = {
    host: 'https://www.googleapis.com'
    , path: '/pagespeedonline/v1/runPagespeed?url=' + program.uri + '/&prettyprint=false&strategy=' + program.strategy + '&key=' + program.key
}

https.get(options, function(res) {
    console.log("statusCode: ", res.statusCode);
    console.log("headers: ", res.headers);
    res.on('data', function(d) {
        process.stdout.write(d);
    });
}).on('error', function(e) {
    console.error(e);
}); 
```

我错过了什么吗？尝试发送一些不同的标头，但没有太大区别

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:18:30.523

删除`https://`主机中的前缀，你应该很高兴。请参阅[此处的文档](http://nodejs.org/api/http.html#http_http_request_options_callback)。

这是一个工作示例，只需替换您自己的 URL 和 API 密钥：

```
var https = 要求（'https'），
    键='键'，
    url = '网址',
    策略 = '桌面';

https.get({
    主机：'www.googleapis.com',
    路径：'/pagespeedonline/v1/runPagespeed?url=' + encodeURIComponent(url) +
          '&key='+key+'&策略='+策略
    }，函数（分辨率）{
      console.log("statusCode:", res.statusCode);
      console.log("标题：", res.headers);

      res.on（'数据'，函数（d）{
        process.stdout.write(d);
      });
}).on('错误', function(e) {
  控制台.错误（e）；
});

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T20:13:20.153

您可以将 Google 的节点客户端库用于其 API。

```
var googleapis = require('googleapis');
googleapis.load('pagespeedonline', 'v1', function(err, client) {
  // set your api key
  client = client.withApiKey('...');
  var params = { url: '...', strategy: '...' };
  var request = client.pagespeedonline.pagespeedapi.runpagespeed(params);
  request.execute(function (err, result) {
    console.log(err, result);
  });
}); 
```

客户端库还支持在您的情况下可能有用的批处理请求。进一步的文档是[https://github.com/google/google-api-nodejs-client](https://github.com/google/google-api-nodejs-client)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-13T10:14:27.280

[google-api-nodejs-client](https://github.com/google/google-api-nodejs-client)是 Google 官方支持的用于访问 Google API 的 node.js 客户端库。

```
npm install googleapis 
```

对于 PageSpeed Insights API，它现在是这样的：

```
require('googleapis')
    .discover('pagespeedonline', 'v1')
    .execute(function (err, psclient) {
        var params = { url: URLHERE }; // others params https://developers.google.com/speed/docs/insights/v1/getting_started
        var request = psclient.pagespeedonline.pagespeedapi.runpagespeed(params).withApiKey(YOUR_API_KEY);;
        request.execute(function (err, result) {
            //do something
        });
    }); 
```

# javascript - 在 Twitter 小部件中显示随机用户配置文件

> ID：10194765
> 
> 赞同：0
> 
> 时间：2012-04-17T16:00:31.757
> 
> 标签：javascript, dynamic, twitter, widget, render

我有六个 Twitter 用户名，我想在我的页面上显示它们。我不想一次显示所有六个，而是随机选择一个并一次显示一个。

但是，在页面加载后我无法更新 twitter 小部件。小部件的最后一行调用函数 setUser()，如下所示：

```
}).render().setUser(document.getElementById("TWITTER_PROFILE_HERE").value).start(); 
```

如何将 TWITTER_PROFILE_HERE 更改为我随机选择的特定名称？

提前致谢。

仅供参考，这里是创建小部件页面的链接：http: [//twitter.com/about/resources/widgets/widget_profile](http://twitter.com/about/resources/widgets/widget_profile)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:12:46.180

只需确保将 var 用户名更改为您想要的任何内容。

```
<script>

var username = "WHATEVER_USERNAME"; // Add this line in to determine which username you want.

new TWTR.Widget({
  ...
}).render().setUser(username).start();
</script> 
```

或者，如果您想从所有姓名中随机选择一个姓名。

```
<script>

    var usernames = ['user_1', 'user_2', 'user_3', 'user_4'];

    var username = usernames[Math.floor(Math.random()*usernames.length)];    

    new TWTR.Widget({
      ...
    }).render().setUser(username).start();

</script> 
```

# asp.net-mvc-3 - MVC3 Web 应用程序/教程不会在 IIS7 网络服务器上使用 ASPNETDB.mdf “登录”

> ID：10194773
> 
> 赞同：0
> 
> 时间：2012-04-17T16:01:01.453
> 
> 标签：asp.net-mvc-3, sql-server-2008-express, visual-web-developer-2010, aspnetdb

我刚刚将我的 MVC3 ASP.net Web 应用程序上传到我的服务器 2008 R2 IIS 7.5 Express 网络服务器。

Web 应用程序加载正常，但是当单击登录链接并尝试注册用户帐户或登录现有用户帐户时，我收到以下错误：

"*抱歉，处理您的请求时出错。* "

如果我浏览我的网络服务器上的网络应用程序（从 IIS7.5 中）并尝试登录链接，我会收到以下 ASP 错误：

"*建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。找不到服务器或无法访问该服务器。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者： SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）* “

"*描述：在执行当前 Web 请求期间发生了未处理的异常。请查看堆栈跟踪以获取有关该错误及其源自代码的位置的更多信息。* "

*“异常详细信息：System.Data.SqlClient.SqlException：建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。未找到或无法访问服务器。验证实例名称是否正确以及 SQL服务器配置为允许远程连接。（提供程序：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）“*

*“**源错误**：在执行当前 Web 请求期间生成了未处理的异常。有关异常来源和位置的信息可以使用下面的异常堆栈跟踪来识别。”*

有人介意帮我解决问题吗？

我在我的 Web.Config 中配置了两个数据库：

```
<connectionStrings>
    <add name="DatabaseDBContext" connectionString="data source=|DataDirectory|Content_Database.sdf" providerName="System.Data.SqlServerCe.4.0"/>
    <add name="ApplicationServices" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient"/>
  </connectionStrings> 
```

SQL Compact (Content_Database.sdf) 数据库工作正常。我只在尝试访问 aspnetdb.mdf 数据库时收到错误消息。

ASPNETDB.mdf 数据库实际上与从 Visual Web Developer Express 2010 加载 Microsoft MVC3 Razor 模板/教程时获得的状态相同。

我尝试在我的网络服务器上安装 SQL Express 2008，以防万一这是问题，没有任何区别。

整个 Web 应用程序在我的 Visual Web Developer 2010 Express 开发服务器上完美运行（我可以创建用户并成功登录和注销）。一旦上传到网络服务器，它就会失败。

帮助表示赞赏 - 非常感谢:-)

完整的 Web.Config：

```
 <?xml version="1.0"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=152368
  -->

<configuration>
  <connectionStrings>
      <add name="DatabaseDBContext" connectionString="data source=|DataDirectory|\Content_Database.sdf" />
      <add name="ApplicationServices" connectionString="data source=|DataDirectory|\aspnetdb.sdf" />

      <!--<add name="ApplicationServices"
         connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true"
         providerName="System.Data.SqlClient" />-->
  </connectionStrings>

  <appSettings>
    <add key="webpages:Version" value="1.0.0.0"/>
    <add key="ClientValidationEnabled" value="true"/>
    <add key="UnobtrusiveJavaScriptEnabled" value="true"/>
  </appSettings>

  <system.web>
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      </assemblies>
    </compilation>

    <authentication mode="Forms">
      <forms loginUrl="~/Admin/LogOn" timeout="2880" />
    </authentication>

    <membership>
      <providers>
        <clear/>
            <add name="SqlCeMembershipProvider" type="Project1.Domain.SqlCeMembershipProvider" connectionStringName="ApplicationServices" applicationName="/"
         enablePasswordRetrieval="false" requiresQuestionAndAnswer="false" requiresUniqueEmail="true" passwordFormat="Hashed" writeExceptionsToEventLog="false" />
            <!--<add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices"
             enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
             maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
             applicationName="/" />-->
      </providers>
    </membership>

    <profile>
      <providers>
        <clear/>
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/" />
      </providers>
    </profile>

    <roleManager defaultProvider="SqlCeRoleProvider"
             enabled="true"
             cacheRolesInCookie="true"
             cookieName=".ASPROLES"
             cookieTimeout="30"
             cookiePath="/"
             cookieRequireSSL="false"
             cookieSlidingExpiration="true"
             cookieProtection="All">
      <providers>
        <clear/>
          <add name="SqlCeRoleProvider" type="System.Web.Security.SqlCeRoleProvider" connectionStringName="ApplicationServices" applicationName="/" writeExceptionsToEventLog="true" />
        <!--<add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />-->
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager>

    <pages>
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages"/>
      </namespaces>
    </pages>
  </system.web>

  <system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration 
```

>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:02:33.680

*如果是 Sql Compact*数据库，它看起来像您的 DatabaseDBContext/SDF 。从管理员的角度来看，这个引擎是非常不同的。基本上，设置和开始工作非常简单。

您的 ApplicationServices/mdf 文件不是*紧凑型*数据库，它使用*普通*的sql（express、dev、workgroup、standard、enterprise 等）引擎。这确实需要一些调整才能开始工作。您的`data source=`选择是将 SqlClient 配置为使用安装在本地计算机上的特定引擎来打开数据库（这需要将 sql 作为实例安装安装在本地计算机上，名称为*SqlExpress*）并正确配置为允许连接（可能是远程）。正在将SqlClient 配置为以[AppPool](http://learn.iis.net/page.aspx/624/application-pool-identities/)`Integrated Security`中配置的用户身份连接到服务器连接到数据库，这要求用户有权访问存储数据库的文件、数据库本身（内部作为安全性）以及 SSPI 的所有其他安全性要求（我强烈建议您保留）。

**更新**

我有一些项目专门在 Compact Framework 上运行（因为对于小型项目，维护/管理要容易得多）。

要使用 SQL Server Compact 4，您需要安装[Visual Studio Tools for SQL Server Compact 4](http://erikej.blogspot.com/2010/12/visual-studio-tools-for-sql-server.html)。我为 asp.net 使用 erikej [SQL Compact Providers](http://sqlcemembership.codeplex.com/) (Membership and Role) 并且没有遇到任何问题。提供程序的好处在于，您针对当前提供程序编写的大部分代码都不会更改，您只是替换了提供程序和数据库。

无论哪种方式，快乐的编码！

**更新 2**

我的 web.config 有以下条目：

```
<connectionStrings>
 <add name="membershipDatabase" 
      connectionString="data source=|DataDirectory|\Membership.sdf" />
</connectionStrings>

<membership defaultProvider="SqlCeMembershipProvider">
  <providers>
    <clear />
    <add name="SqlCeMembershipProvider" 
         type="Project1.Domain.SqlCeMembershipProvider"           
         connectionStringName="membershipDatabase" 
         applicationName="/" 
         enablePasswordRetrieval="false" 
         requiresQuestionAndAnswer="false" 
         requiresUniqueEmail="true" 
         passwordFormat="Hashed"  
         writeExceptionsToEventLog="false" />
  </providers>
</membership>
<roleManager defaultProvider="SqlCeRoleProvider" 
             enabled="true" 
             cacheRolesInCookie="true" 
             cookieName=".ASPROLES" 
             cookieTimeout="30" 
             cookiePath="/" 
             cookieRequireSSL="false" 
             cookieSlidingExpiration="true" 
             cookieProtection="All">
  <providers>
    <clear />
    <add name="SqlCeRoleProvider" 
         type="Project1.Domain.SqlCeRoleProvider" 
         connectionStringName="membershipDatabase" 
         applicationName="/" 
         writeExceptionsToEventLog="true" />
  </providers>
</roleManager> 
```

# objective-c - 如何使用 MPMoviePlayerController 播放视频

> ID：10194776
> 
> 赞同：1
> 
> 时间：2012-04-17T16:01:06.290
> 
> 标签：objective-c, ios, streaming, mpmovieplayercontroller

我正在使用此代码播放来自苹果网站的视频流

```
- (IBAction)playMovie:(UIButton *)sender {
    NSLog(@"start playing");
    //NSURL *url = [NSURL URLWithString:@"http://spatie.be/test.mov"];
    NSURL *url = [NSURL URLWithString:@"http://stream.qtv.apple.com/events/mar/123pibhargjknawdconwecown/12oihbqeorvfhbpiubqnfv3_650_ref.mov"];
    moviePlayer =  [[MPMoviePlayerController alloc]
                    initWithContentURL:url];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(moviePlayBackDidFinish:)
                                                 name:MPMoviePlayerPlaybackDidFinishNotification
                                               object:moviePlayer];

    moviePlayer.controlStyle = MPMovieControlStyleDefault;
    moviePlayer.shouldAutoplay = YES;
    moviePlayer.movieSourceType = MPMovieSourceTypeStreaming;
    [self.view addSubview:moviePlayer.view];
    [moviePlayer setFullscreen:YES animated:YES];    
}
- (void) moviePlayBackDidFinish:(NSNotification*)notification {

    NSError *error = [[notification userInfo] objectForKey:@"error"];
    if (error) {
        NSLog(@"Did finish with error: %@", error);
    }    

    MPMoviePlayerController *player = [notification object];
    [[NSNotificationCenter defaultCenter] 
     removeObserver:self
     name:MPMoviePlayerPlaybackDidFinishNotification
     object:player];

    if ([player
         respondsToSelector:@selector(setFullscreen:animated:)])
    {
        [player.view removeFromSuperview];
    }

} 
```

调用 playMovie 时，`moviePlayBackDidFinish`立即调用并记录错误消息：

> 完成但出现错误：错误域=MediaPlayerErrorDomain Code=-11800“操作无法完成” UserInfo=0x78d25d0 {NSLocalizedDescription=操作无法完成}

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:43:02.783

您没有将其标记为 iOS，但 MPMoviePlayer 仅适用于 iOS。这应该适用于将在 iOS 上播放的视频。不幸的是，您尝试播放的视频与 iOS 不兼容。试试这个网址：

```
http://stream.qtv.apple.com/events/mar/123pibhargjknawdconwecown/12oihbqeorvfhbpiubqnfv3_ipad_vod_ref.mov 
```

# css - 无论内容如何， 表格中的相同宽度/高度列，动态调整大小

> ID：10194780
> 
> 赞同：0
> 
> 时间：2012-04-17T16:01:10.183
> 
> 标签：css, css-tables

是否所有行和列都可以具有相同的高度，无论它们在哪里包含图像？

这是一个[例子](http://tinkerbin.com/QczmwBuD)，它应该显示为

```
[]    []  

  [] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T17:15:10.370

~~我无法获得外观完美的 JSfiddle [http://jsfiddle.net/Qdzrs/7/](http://jsfiddle.net/Qdzrs/7/)，但是当我在本地计算机中将其作为独立文件尝试时，它确实对我有用。~~

[我在这里http://jsfiddle.net/Qdzrs/8/](http://jsfiddle.net/Qdzrs/8/)找到了一个在 JSFiddle 中工作的 JQuery 插件，它被称为 waitForImages。

1.  在 JSFiddle 中看到的图像下方的空白在独立文件中消失了。
2.  你可能会得到大块的空白，但那是因为图像的纵横比与单元格的纵横比不匹配。我不知道你是否想要拉伸图像，所以我没有研究过。

# c# - 外部应用程序 - 网格内的鼠标单击事件

> ID：10194783
> 
> 赞同：0
> 
> 时间：2012-04-17T16:01:16.063
> 
> 标签：c#, .net, winforms, pinvoke

我有一个外部 Windows 应用程序（无源代码），其中有一个网格。这作为一个单独的进程运行。当用户通过鼠标单击在网格中选择一个单元格时，我需要能够读取该单元格中的值。任何人都可以就我需要使用哪些 API 来捕获和监听事件提供一些指导吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:03:43.097

您最好的选择是[UI 自动化概述](http://msdn.microsoft.com/en-us/library/ms747327.aspx)或可访问性作为旧技术。

您还可以查看此[Pinvoke SetFocus 以了解如何在另一个进程上调用事物的特定控件](https://stackoverflow.com/questions/9503027/pinvoke-setfocus-to-a-particular-control/9547099#9547099)（与自动化几乎无关，自动化工作没有那个）

UI 自动化是这项工作的最佳工具，**但**缺点是并非每个应用程序都支持它 - 所以这在很大程度上取决于您的目标应用程序。有些只支持遗留的可访问性（IAccessible、IAccessible2 等），通常有一种“组合”方法。较旧的技术不再工作得很好，但您可以尝试在目标窗口中遍历窗口、子窗口（对于那个方向，您可能迟早需要上述技术）并希望您可以从标准控件、窗口中获得它文本，通过消息等

# file-upload - JAX RS 文件上传

> ID：10194784
> 
> 赞同：2
> 
> 时间：2012-04-17T16:01:17.703
> 
> 标签：file-upload, jersey, jax-rs

我正在尝试使用 JAX RS 设置文件上传示例。当客户端是 JSP 页面并且没有问题时，我可以设置项目。但我想让客户端作为一个 java 类，它向服务发送 post 请求。我的服务器端代码如下所示。

```
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import javax.ws.rs.Consumes;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

import com.sun.jersey.core.header.FormDataContentDisposition;
import com.sun.jersey.multipart.FormDataParam;

@Path("/file")
public class UploadFileService {

@POST
@Path("/upload")
@Consumes(MediaType.MULTIPART_FORM_DATA)
public Response uploadFile(
        @FormDataParam("file") InputStream uploadedInputStream,
        @FormDataParam("file") FormDataContentDisposition fileDetail) {

    String uploadedFileLocation = "d://uploaded/"
            + fileDetail.getFileName();

    writeToFile(uploadedInputStream, uploadedFileLocation);

    String output = "File uploaded to : " + uploadedFileLocation;

    return Response.status(200).entity(output).build();

}

private void writeToFile(InputStream uploadedInputStream,
        String uploadedFileLocation) {

    try {
        OutputStream out = new FileOutputStream(new File(
                uploadedFileLocation));
        int read = 0;
        byte[] bytes = new byte[1024];

        out = new FileOutputStream(new File(uploadedFileLocation));
        while ((read = uploadedInputStream.read(bytes)) != -1) {
            out.write(bytes, 0, read);
        }
        out.flush();
        out.close();
    } catch (IOException e) {

        e.printStackTrace();
    }

}

} 
```

客户端作为 JSP 页面如下图所示。

```
<html>
<body>
<h1>File Upload with Jersey</h1>

<form action="http://localhost:9090/RESTfulExample/rest/file/upload" method="post" enctype="multipart/form-data">

   <p>
    Select a file : <input type="file" name="file" size="45" />
   </p>

   <input type="submit" value="Upload It" />
</form>

</body>
</html> 
```

有人可以帮助我作为客户的类文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T23:48:18.337

您可以使用 Apache 的 httpclient 和 httpmime 来完成此操作：

```
import java.io.File;
import java.io.IOException;

import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.mime.MultipartEntity;
import org.apache.http.entity.mime.content.FileBody;
import org.apache.http.impl.client.DefaultHttpClient;

public class Uploader {

  public void uploadFile(String endpoint, File file) throws ClientProtocolException, IOException {
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httpPost = new HttpPost(endpoint);
    FileBody uploadFilePart = new FileBody(file);
    MultipartEntity reqEntity = new MultipartEntity();
    reqEntity.addPart("file", uploadFilePart);
    httpPost.setEntity(reqEntity);
    HttpResponse response = httpclient.execute(httpPost);
    //Check response for success
  }

} 
```

这适用于您的示例服务器代码。也看到[这个问题](https://stackoverflow.com/questions/1378920/how-can-i-make-a-multipart-form-data-post-request-using-java)。

# regex - 解析 HTML/XML 文档是如何工作的？

> ID：10194789
> 
> 赞同：7
> 
> 时间：2012-04-17T16:01:24.900
> 
> 标签：regex, dom

我经常被告知并看到其他人被告知：不要使用正则表达式来解析（或“解析”）以 HTML、XML 等语言编写的文档。命名的原因各不相同，在这里并不重要。

当被问到要做什么时，通常会参考一个库来解析这样的文档——一个 PHP 扩展、一个 JS 框架等。大多数时候它们似乎依赖于文档对象模型。

我的问题不是如何在程序或脚本中做到这一点。在实际情况下，我不会尝试再次发明轮子，而只是使用其中一个可用的框架。

我想知道的是——这些框架是如何做到的？*或者如果没有*框架（假设）我该怎么做？我不是在谈论任何特定的语言，我对从文档中提取信息背后的理论感兴趣。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T23:54:53.127

解析 XML 需要一种能够识别称为“上下文无关语言”的工具。正则表达式识别正则语言，它们是上下文无关语言的子集。

**识别常规语言**

常规语言由确定性有限自动机 (DFA) 识别。DFA 是一组状态，状态之间有过渡边，还有一个输入缓冲区（您正在解析的字符串）。DFA 以其起始状态开始。DFA 在输入缓冲区的开头读取字符，告诉它要进行哪个转换。这会将 DFA 移动到下一个状态，并在此重复该过程。如果 DFA 遇到一个它没有转换的输入字符，它就会结束（输入未被识别）。如果 DFA 达到指定的结束状态，则输入已被识别

要记住的最重要的事情是，DFA 不记得他们去过什么州——只是他们现在在哪里，以及下一步要去哪里。这使得 DFA 无法识别某些类型的语言，例如匹配的 XML 标记。

正则表达式实现（如 PCRE）为方便起见有一些扩展（例如，'+'、'?' 和字符类），以及改变正则表达式功能的其他扩展（如前瞻和后向引用）。这些正则表达式比 DFA 更强大，但是仅使用这些扩展的正则表达式构建 XML 解析器是困难的或不可能的。

**识别上下文无关语言**

下推自动机识别上下文无关语言。这些工作就像 DFA，但增加了一个堆栈。下推自动机使用输入的第一个字符*和*堆栈顶部的值选择转换。在每一步中，机器消耗一个输入字符，并且可以将一个值压入堆栈，弹出一个值，或者对堆栈不做任何事情。

下推自动机可以使用堆栈来记住它们所在的位置，这使得它们适合解析 XML 等语言（或大多数编程语言，有一些特殊例外）。

**解析 XML**

解析器不是通过设计下推自动机来构建的，就像通过设计 DFA 无法识别常规语言一样。上下文无关语法是描述上下文无关语言的更好方法。它们通常以 Backus-Naur 形式 (BNF) 写下来。下面是 XML 子集的简单 BNF 语法：

```
Tags ::= Tag Tags | <nothing>

Tag ::= "<" /[a-zA-Z]+/ Attributes ">" Document "</" /[a-zA-Z]+/ ">"

Attributes ::= Attribute Attributes | <nothing>

Attribute ::= /[a-zA-Z]+/ "=" "\"" /[a-zA-Z0-9 ]+/ "\"" 
```

该语法由非终结符（“Tags”、“Tag”、“Attributes”和“Attribute”）组成。在规则右侧出现非终结符的任何地方，它都可以被任何可能的定义替换（由 | 分隔）。引号和正则表达式中的文本是终端，必须与输入完全匹配。

Tag 非终结符识别开始和结束标记，它们之间有一个非终结符标签。每当解析器识别出一个开始标签时，它就希望在另一边找到结束标签。标签将识别一个标签，然后再次识别标签。这个递归定义允许解析器识别无限数量的标签。

解析器生成器是将上下文无关语法转换为下推自动机以识别输入语言的工具。尽管在准确指定语法方面存在很多挑战，但这大大降低了构建解析器的复杂性。

**其他解析方法**

您可以编写解析器，而无需手动构建状态机，也可以编写上下文无关语法。通常，这可以通过递归下降解析器或手工制作的解析器来完成，该解析器使用正则表达式以及关于被解析语言的一些特殊知识。递归下降解析器看起来很像上下文无关文法，但有一些严重的性能问题和功能限制。还有解析表达式语法 (PEG)，其工作方式类似于正则表达式和 BNF 语法的混合体。Wikipedia 上有关于所有这些技术的精彩文章，以及许多可用于构建各种解析器的工具。

# java - java中equals方法的正确用法是什么？

> ID：10194790
> 
> 赞同：2
> 
> 时间：2012-04-17T16:01:27.093
> 
> 标签：java

简单的问题是正确的使用方法`equals`，也提供答案背后的推理。

```
"Delta".equals(type) 
```

或者

```
type.equals("Delta") 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T16:02:22.920

一般来说

```
"Delta".equals(type) 
```

受到青睐，因为不可能抛出`NullPointerException`. 也就是说，另一种方式并非“不正确”，因为它与 Java 语言规范没有错误；*但是，如果* `(type == null)`为真，它很容易失败。

术语“最佳实践”用于区分更好的选择和正确但较差的选择。在这种情况下`"Delta".equals(type)`是一种最佳实践，以避免处理空指针引用所需的不必要的保护代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:03:17.850

两者都是正确的。第一个在绝对非空的字符串上调用 compare 方法，所以它不会抛出 NullPointerException，第二个可能 if`type`为 null

第一个版本“更安全”，第二个“阅读”更自然

# python - 有人可以解释一下这个 Twisted 单元测试吗？

> ID：10194793
> 
> 赞同：2
> 
> 时间：2012-04-17T16:01:35.790
> 
> 标签：python, twisted.web

我只是继承了一些围绕 Twisted Python 的单元测试，如下所示。

虽然测试有效，但我从概念上不理解它。

鉴于下面的例子，有人可以解释一下下面的事情吗？

*   为什么这个单元测试“返回页面”？
*   为什么没有任何对 reactor.start() 的调用？
*   关于这种方法的优点/缺点的任何评论，也许还有其他我可以考虑的？

* * *

```
def setUp(self):
    self.listening_port = reactor.listenTCP(8118, server.Site(buildSite()))        

def tearDown(self):
    self.listening_port.stopListening()

def getUrl(self, extension=''):
    return 'http://localhost:%s/%s' % (self.listening_port.getHost().port, extension)

 def test(self):
     url = self.getUrl('foo')        
     def printResult(result):
         print result        
     page = getPage(url, method='POST').addCallback(printResult)
     return page 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T16:37:23.683

> *为什么这个单元测试“返回页面”？*

嗯，不是很干净。Twisted 的 Trial 单元测试期望延迟作为结果，断言作为回调。这里的回调是`printResult`，因此对于任何非空字符串，它将被评估为 true。我认为更恰当的应该是：

```
page = getPage(url, method='POST').addCallback(self.assertTrue) 
```

或者

```
page = getPage(url, method='POST').addCallback(self.assertIsNotNone) 
```

> *为什么没有任何对 reactor.start() 的调用？*

因为`TestCase`班级会照顾到这一点。而且它也没有使用标准反应器。

> 由于单元测试避免了真正的 I/O 和实时，它们通常可以避免使用真正的反应器。唯一的例外是针对真实反应器实现的单元测试。协议实现或其他应用程序代码的单元测试不应使用反应器。真实反应器实现的单元测试不应使用全局反应器，而应使用 twisted.internet.test.reactormixins.ReactorBuilder 以便它们可以自动应用于所有反应器实现。在任何情况下，新的单元测试都不应该使用全局反应器。

# javascript - 打开时JQuery Flyup效果

> ID：10194802
> 
> 赞同：0
> 
> 时间：2012-04-17T16:02:11.513
> 
> 标签：javascript, jquery

我正在尝试为悬停时的块创建一个flyup，类似于以下链接中的那个...

[http://p2power.com/](http://p2power.com/)

它就在幻灯片的下方...如何使用 jquery 创建确切的效果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:08:14.717

这是一个非常基本的例子。你现在可以用 CSS3 来做这一切，但这里是 jQuery 的方式。

HTML：

```
<div class="box">
    <div class="inner">
        <p>Content</p>
    </div>
</div> 
```

CSS：

```
.box {
    position: absolute;
    bottom: 0;
    width: 200px;
    height: 0;
    overflow: hidden;
}

.inner {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
} 
```

jQuery：

```
$('.box').hover(function(){
    $(this).animate({
        height: 200
    });
},function(){
    $(this).animate({
        height: 0
    });        
}); 
```

[您可以在此处](http://jsfiddle.net/effu/qW4DY/)测试代码。

应该这样做！

希望有帮助:)

# java - 在 HashMap 中覆盖之前检索先前的键映射值

> ID：10194804
> 
> 赞同：-1
> 
> 时间：2012-04-17T16:02:16.550
> 
> 标签：java, hashmap

我`HashMap`根据我的代码创建了一个...

```
HashMap map=new HashMap();//HashMap key random order.
map.put("Amit","Java");
map.put("Saral","J2EE");
map.put("Saral","Andriod");//same key but different value 
map.put("Nitin","PHP");
map.put("hj","Spring1");
System.out.println("There are "+map.size()+" elements in the map.");
System.out.println("Content of Map are...");
Set s=map.entrySet();

Iterator itr=s.iterator();
while(itr.hasNext()){
    Map.Entry m=(Map.Entry)itr.next();
    System.out.println(m.getKey()+"\t"+m.getValue()+"\t"+ m.hashCode());
    } 
```

当我执行此代码时，`key=Saral`值为`Android`. 有什么方法可以获取此键的先前值，即`J2EE`?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T16:05:28.223

不，你不能用标准来做到这一点`HashMap`。最简单的解决方案是将 a`List`作为值存储在地图中，然后您可以将多个项目添加到列表中（顺便说一句，您也应该使用通用集合）。为简化起见，您可以使用如下辅助方法：

```
void addToMap(Map<String, List<String>> map, String key, String value) {
  List<String> list = map.get(key);

  if (list == null) {
    list = new ArrayList<String>();
    map.put(key, list);
  }
  list.add(value);
}

Map<String, List<String>> map = new HashMap<String, List<String>>();
addToMap(map, "Amit", "Java");
addToMap(map, "Saral", "J2EE");
addToMap(map, "Saral", "Andriod");//same key but different value 
addToMap(map, "Nitin", "PHP");
addToMap(map, "hj", "Spring1");
... 
```

这里的辅助方法只是一个说明——一个完整的、健壮的实现可能需要包括例如检查重复值，这取决于您是否允许它们。如果没有，您可能更喜欢使用 a`Set`而不是`List`.

### 更新

要打印此映射的内容，您需要使用嵌入式循环来遍历每个映射条目的值列表（顺便说一句，您可以使用 foreach 循环而不是迭代器）：

```
for (Map.Entry<String, List<String>> m : map.entrySet())
{
  for (String v : m.getValue())
  {
    System.out.println(m.getKey()+"\t"+v+"\t"+ m.hashCode());
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:07:05.247

A`Map`每个键最多可以包含一个条目，因此当您调用 时`map.put("Saral","Andriod")`，旧`"J2EE"`值将被删除。要支持每个键的多个值，您需要维护一个`Map<String, List<String>>`或多个映射实现，例如 Guava 的[`Multimap`](http://guava-libraries.googlecode.com/svn/tags/release03/javadoc/com/google/common/collect/Multimap.html).

作为旁注，我建议您在编译时开始使用泛型，例如`Map<String, String>`,`Iterator<String>`等以确保类型安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T16:05:23.863

旧值被覆盖（替换）。一个唯一键将只有一个映射（条目）。因此它不再存在，因此您无法检索它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T16:07:26.580

您无法使用`Map`Java 提供的标准实现来做到这一点。但是有 MultiMap 的实现（这基本上就是你所追求的）。

一个例子是来自谷歌的这个：http: [//google-collections.googlecode.com/svn/trunk/javadoc/index.html ?com/google/common/collect/Multimap.html](http://google-collections.googlecode.com/svn/trunk/javadoc/index.html?com/google/common/collect/Multimap.html)

请注意，您将无法仅获得这一个接口，您还需要一些类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T16:12:56.843

正如其他人所说，这不适用于标准地图。但是，Google 的[Guava](http://code.google.com/p/guava-libraries/)提供了[MultiMap](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Multimap.html)接口，您可以使用该接口通过单个键存储多个值。

使用示例：

```
Multimap<String,String> multiMap = ArrayListMultimap.create();
multiMap.put("color", "red");
multiMap.put("color", "blue");
System.out.println(multiMap.get("color")); //returns a ["red', "blue"] list 
```

# c++ - 在基于 C++11 范围的“for”循环中获取对 STL 容器元素的引用

> ID：10194816
> 
> 赞同：5
> 
> 时间：2012-04-17T16:02:50.670
> 
> 标签：c++, stl, reference, for-loop, iterator

```
for (Something something : setOfSomething)          // OK
for (Something const& something : setOfSomething)   // OK
for (Something& something : setOfSomething)         // ERROR

error: invalid initialization of reference of type 'Something&'
from expression of type 'const Something' 
```

从什么时候迭代器返回`const Something`？它应该返回`Something&`或`Something const&`。而且由于基于范围的“for”循环被解释为这样[，](http://en.cppreference.com/w/cpp/language/range-for)我对正在发生的事情没有合理的解释。

**编辑：**我说的是，`unordered_set`而不是`set`，对这种混乱感到抱歉。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-17T16:05:08.323

您不能改变 a 的成员，`set`因为这可能违反`set`不变量。所以编译器限制你获取 const 引用或复制回来。

# java - JPA Hibernate DBCP Tomcat OutOfMemory

> ID：10194818
> 
> 赞同：8
> 
> 时间：2012-04-17T16:03:04.190
> 
> 标签：java, spring, hibernate, tomcat, jpa

我的应用程序的新版本中每天都会出现 OutOfMemory 错误。我们为 Tomcat 分配了 1.5 GB 的堆。

使用 Eclipse 内存分析器（[http://www.eclipse.org/mat/](http://www.eclipse.org/mat/)）我在最短累积路径下得到以下信息

```
org.apache.tomcat.dbcp.pool.impl.CursorableLinkedList$Listable @ 0xa1566cc8  
    _head org.apache.tomcat.dbcp.pool.impl.CursorableLinkedList @ 0xa1566ca8  
      _pool org.apache.tomcat.dbcp.dbcp.AbandonedObjectPool @ 0xa1566c38 
         connectionPool org.apache.tomcat.dbcp.dbcp.BasicDataSource @ 0xa1566980 
             dataSource org.springframework.orm.jpa.JpaTransactionManager @ 0xa0b01760 
                   <Java Local> java.lang.Thread @ 0xa4005900 ajp-8141-5 Thread 
```

对此的进一步检查显示了许多重复的字符串，它们是 Hibernate 查询。在我的应用程序主屏幕上，我加载了一个文档列表。该查询的副本在堆转储中存在 8,241 次。

我还注意到 org.apache.tomcat.dbcp.dbcp.AbandonedObjectPool 中包含 1 GB 的堆。此文档查询正在加载文档二进制数据。它正在加载的文档大约为 1MB。这让我怀疑垃圾收集器没有清理列表。我们将从查询中删除不必要的数据，但我仍然担心对象仍然存在。

我正在使用 JPA、Hibernate 和 Spring。我正在使用 `@Transactional(readOnly=true)`获取文档列表的方法。这是我的数据源的 Spring 配置：

```
<jee:jndi-lookup jndi-name="jdbc/MyDB" id="myDataSource"/>

    <bean id="myEmf" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">

        <property name="dataSource" ref="myDataSource"/>
        <property name="persistenceUnitName" value="WebPU"/>
        <property name="persistenceProvider">
            <bean class="org.hibernate.ejb.HibernatePersistence" />
        </property>
        <property name="jpaVendorAdapter">
            <bean
                class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
                <property name="database" value="SQL_SERVER" />
                <property name="showSql" value="false" />
                <property name="generateDdl" value="false" />
            </bean>
        </property>

    </bean>

     <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
        <property name="entityManagerFactory" ref="myEmf" />
    </bean> 
```

我正在使用 Tomcat 来提供连接池。这是我的配置：

```
<Resource auth="Container" driverClassName="com.microsoft.sqlserver.jdbc.SQLServerDriver" initialSize="20"
  logAbandoned="true" maxActive="100" maxIdle="30" maxWait="10000" name="jdbc/MyDB" password="pass" poolPreparedStatements="true" removeAbandoned="true" removeAbandonedTimeout="30" 
  type="javax.sql.DataSource" 
  url="jdbc:sqlserver://devmssql;databaseName=MY_DEV;responseBuffering=adaptive;port=1444" 
  username="user"/> 
```

服务层有@Transactional。我的 JPA 查询如下所示：

```
public List<Document> getDocs(int cId, int lId, int ldId) { 
        CriteriaBuilder queryBuilder = getEntityManager().getCriteriaBuilder();
        CriteriaQuery<Document> select = queryBuilder.createQuery(Document.class);

        Root<Document> from = select.from(Document.class);

        select.where(
                queryBuilder.and(queryBuilder.equal(from.get(Document_.cId), cId),
                queryBuilder.equal(from.get(Document_.lId), lId),
                queryBuilder.equal(from.get(Document_.ldId), ldId)));

        TypedQuery<Document> tq = getEntityManager().createQuery(select);

        final List<Document> rl = tq.getResultList();

        return rl;
    } 
```

我应该寻找什么来帮助确定内存泄漏的根本原因？是否有任何可能导致此问题的 DBCP、Hibernate 或 Spring 设置？您在 JPA 查询代码中是否注意到任何可能有贡献的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T17:23:33.607

我强烈建议使用[VisualVM](http://visualvm.java.net/)或[jProfiler](http://www.ej-technologies.com/products/jprofiler/overview.html)来识别泄漏。恕我直言，这是最简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T19:36:20.933

在从方法返回之前尝试清除 EntityManager 缓存。首先调用 EntityManager.flush() 方法，然后调用 clean()。如果您的 EntityManager “寿命”很长并且它被许多数据库操作使用，这可能会有所帮助。

如果您使用 Spring，您可以在有问题的情况下放弃使用 Hibernate，而使用普通的 JDBC。Spring 为我们提供了 JDBCTemplate 以轻松处理查询，并提供通用事务管理接口，因此您可以将 Hibernate 操作与 JDBC 查询混合使用。

# hibernate - 使用休眠时，运行模式和调试模式的区别

> ID：10194828
> 
> 赞同：0
> 
> 时间：2012-04-17T16:03:24.470
> 
> 标签：hibernate, struts2

我发现休眠模式在调试模式下会调用延迟加载，而在运行模式下不会。为什么？

在 Struts 中，url 包含 '.action' 是为了什么？

# sql - 构造复杂的sql语句

> ID：10194831
> 
> 赞同：0
> 
> 时间：2012-04-17T16:03:37.903
> 
> 标签：sql, sql-server-2005

我需要选择并更新一个从其他表中查找值的表。这个想法是从 order 中选择一些细节，但使用 id 获取外键值的名称

对于我尝试的选择：

```
SELECT [Order].order_date, 
       [Order].total_price, 
       [Order].order_details,
       vehicle.reg_no,
       Staff.name,
       stock.name 
FROM 
       Order,
       vehicle,
       staff,
       stock
WHERE
      order.id = @order_id 
  AND vehicle.id = Order.vehicle_id 
  AND staff.id = Order.staff_id 
  AND stock.id = Order.product_id 
```

对于我尝试的更新

```
UPDATE order 
SET 
    total_price = @total_price, 
    order_detail = @order_detail,
    product_id = (select is from stock where name = @product_name), 
    customer_id = (select id  from customer where name = @customer_name), 
    vehicle_regno = (select reg_no  from vehicle where name = @name)
WHERE (id = @id) 
```

两者都不返回任何东西。我希望足够清楚以获得一些帮助，但如果不是，我会提供更多信息。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:08:37.287

您正在与 进行比较`stock.id`，`Order.product_id`这可能是问题吗？
否则为什么它不返回任何我们需要知道表格内容的行，也许你需要 a`left join`而不是其中的`inner join`一些？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:19:08.650

您可能想尝试将您的 INNER JOIN 转换为 LEFT JOIN 用于 SELECT 语句。

```
SELECT [Order].order_date, 
       [Order].total_price, 
       [Order].order_details,
       vehicle.reg_no,
       Staff.name,
       stock.name 
FROM 
       [Order] 
       LEFT JOIN vehicle
       ON vehicle.id = [Order].vehicle_id 
       LEFT JOIN staff
       ON staff.id = [Order].staff_id
       LEFT JOIN stock
       ON stock.id = [Order].product_id
WHERE
      [order].id = @order_id 
```

这会产生影响的原因是，如果 a) 您在 fk 字段中允许空值，或者 b) 您没有 fk 约束，这可能表明您的设计存在问题。

如果 ORDER 表中存在@id 的值，您的更新语句应该更新一些行，但正如 [@Danny Varod 已经评论](https://stackoverflow.com/questions/10194831/constructing-complex-sql-statement/10195075#comment13088334_10194831)的那样，您不会只取回受影响的行数

# php - setcookie 不删除 cookie

> ID：10194833
> 
> 赞同：3
> 
> 时间：2012-04-17T16:03:38.870
> 
> 标签：php, cookies

我真的不知道这里有什么问题。

我有一个名为“login.php”的脚本可以完美运行。它使用 AJAX 调用，如果返回成功，则页面刷新并用户登录。在该页面上设置 cookie

```
setcookie("main", $row[0], time() + 3600, "/") 
```

然后我有一个名为“logout.php”的脚本。它的调用方式相同（AJAX 然后页面刷新）。它只有两行：

```
<?php
    setcookie("main", "", time() - 3600, "/");
    echo "Done";
?> 
```

从页面调用它不起作用，所以我只是在浏览器中加载了 logout.php。输出是“完成”，但在 Chrome 中检查我的 cookie 显示 cookie 仍设置为“1”（即 $row[0]）并在 login.php 中设置的时间到期。

login.php 和 logout.php 都在同一个文件夹中，即根目录，与其他所有文件夹相同。

早些时候，这是可行的，但我所做的唯一更改是使网站上的标题栏成为自己的文件（仍在根目录中）并为注销按钮采用 JavaScript 功能，这只是一个 AJAX 调用和一些 jQuery 悬停效果，并使其成为自己的脚本文件，该文件位于 _js 文件夹中。但是我根本没有更改 logout.php，所以当我直接导航到它时它应该仍然可以工作，对吧？我的 setcookie 命令是否有问题，或者可能是什么其他问题导致的？

编辑：我尝试将其设置为在 100 秒内到期而不是 -3600，然后尝试更改其名称，以便我可以将其识别为完全独立的 cookie。他们都没有让它出现。cookie 根本没有设置。

编辑 2：我恢复到最后一次提交，一切都恢复正常了。我不知道为什么通过创建一些新文件（logout.php 根本没有更改）来重组我的站点会使某个脚本无法创建 cookie。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:07:02.263

必须在任何内容到达客户端之前设置 Cookie。确保在调用 setcookie 之前没有向客户端发送任何内容，因为它实际上是`Set-Cookie`通过请求返回的标头。

包含文件中只有一个空格的东西可能会破坏这一点。（您说您处理过其他文件，请检查所包含的内容是否包含任何内容，例如`<?php ... ?>`括号外的调试回显或空格）

作为一般经验法则，如果我有一个完全是 PHP 代码的文件，我只包含开始标记 ( `<?php`) 并排除最后一个。PHP 仍将解析和运行，但这避免了文件末尾的任何可能成为问题的空格。例如

**我的代码文件.php**

```
<?php

  define('...', ...);

  function ...(){ } 
```

另外，您提到使用 chrome。`ctrl`在 chrome ( ++ `shft`)中打开您的调试器，`i`然后单击**网络**选项卡。然后找到您的注销调用并选择它，然后单击**标题**并验证您的 cookie 是否已被清除。（同样，您可以单击**资源**并在**Cookies**下查看任何集合。

# linq-to-xml - 使用 System.Linq.Xml 选择多个节点时出现 Windows Phone 问题

> ID：10194836
> 
> 赞同：2
> 
> 时间：2012-04-17T16:03:54.263
> 
> 标签：linq-to-xml, windows-phone-7.1

昨晚我在使用 WP7.1 进行原型设计时遇到了这个问题。

我有一个类库，用作所有数据访问的存储库。在这个类库中，我正在进行 REST 调用并获取 XML。到目前为止，一切都在工作。从返回的流中，我将其变成了 XElement。然后当我做类似的事情`XElement.Elements()`或者`XElement.Descendents()`当我查看`System.Collections.IEnumerator.Current`成员时收到以下异常。（我不确定它为什么这么说，但这就是我在展开对象时看到的）

`'System.Collections.Generic.IEnumerable<System.Xml.Linq.XElement>' does not contain a definition for 'System' and no extension method 'System' accepting a first argument of type 'System.Collections.Generic.IEnumerable<System.Xml.Linq.XElement>' could be found (are you missing a using directive or an assembly reference?)`

在这一点上，我对自己认为这是一个命名空间问题，所以我编写了以下代码并收到相同的异常。

```
var f = new XElement("Foo", new XElement("Bar", 1));
var b = f.Elements("Bar"); 
```

![错误...](../Images/9585bd1e40318ea05d9442f75356bfef.png)

非常感谢您对此问题的任何帮助。我真的很想使用 linq-to-xml 而不是一堆循环来构造我的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:37:23.887

我想这在延迟执行中按预期工作。

`ToList`当我在集合上调用 a或类似的东西时，我得到了预期的结果。我想当我尝试在断点期间评估表达式时（上述异常），在这种情况下一定存在错误或某些东西。我想我太相信调试器了:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T06:01:44.087

当您执行 linq 操作并将其分配给“var”变量时，真正发生的是查询指令存储在其中。不是实际的数据集存储在上面。当您尝试从中访问数据时，该指令将被执行，您将获得数据。这就是为什么您在断点上看不到任何数据的原因。

# bash - bash 脚本中的并发日志记录

> ID：10194837
> 
> 赞同：4
> 
> 时间：2012-04-17T16:04:01.840
> 
> 标签：bash, concurrency, signals, bash-trap

我目前正试图弄清楚为什么 shell 脚本每隔一段时间就会在并发日志记录时失败。

我有一个如下的shell函数：

```
log()
{
   local l_text=$1
   local l_file="/path/to/logs/$(date +%Y%m%d)_script.log"

   local l_line="$(date +'%Y-%m-%d %H:%M:%S') $(hostname -s) ${l_text}"

   echo ${l_line} >> ${l_file}
} 
```

现在每隔一段时间就会失败并出现语法错误：

```
/path/to/script.sh: command substitution: line 163: syntax error near unexpected token `)'
/path/to/script.sh: command substitution: line 163: `hostname -s) ${l_text}' 
```

问题是，我有多个子进程，每个子进程都想记录并发送陷阱（在此期间也执行记录）。我已经调试了问题并发现，当同时输入该函数三次时会发生这种情况。首先`main`进程进入，然后`child`. 在执行完`date`部分之后`l_text`，`main`get 被 a 中断，`trap`这是由`child`and in this引起的，它`trap`试图记录一些东西。The`child`和 the`trap`很好地完成了他们的日志记录，但随后`main`在陷阱之后恢复并尝试执行该`hostname`部分（假定）并失败并出现此错误。

因此，它似乎`main`不喜欢在生成`$(date +'%Y-%m-%d %H:%M:%S') $(hostname -s) ${l_text}`部分日志语句时进入睡眠状态并且不能很好地恢复。我假设这应该可以正常工作，因为我只是使用局部变量和线程安全的输出方法。

这是我在这里遇到的一般并发问题吗？还是这对于 bash 脚本中的陷阱机制非常具体？我知道 C 中 SIGNAL 处理的商品，所以我知道在 SIGNAL 处理程序中只允许某些操作。但是，我不知道在 bash 脚本中处理信号时是否也适用相同的预防措施。我试图找到这方面的文档，但我能找到的所有文档都没有表明脚本中的信号处理存在任何问题。

**编辑**：

这是一个可用于复制问题的实际简单脚本：

```
#!/bin/bash

log() {
  local text="$(date +'%Y-%m-%d %H:%M:%S') $(hostname -s) $1"
  echo $text >> /dev/null
}

sub_process() {
  while true; do
    log "Thread is running"
    kill -ALRM $$
    sleep 1
  done
}

trap "log 'received ALRM'" ALRM 

sub_process &
sub_process_pid=$!
trap "kill ${sub_process_pid}; exit 0" INT TERM

while true; do
  log "Main is running"
  sleep 1
done 
```

每隔一段时间，这个脚本就会因为第 5 行的语法错误而被杀死。第 5 行是`echo $text >> /dev/null`，但是由于语法错误还提到了 hostname 命令，类似于我上面发布的那个，我假设有一个 -也有一个错误，实际错误在第 4 行，即`local text="$(date +'%Y-%m-%d %H:%M:%S') $(hostname -s) $1"`.

有人知道如何处理上面的脚本来纠正它吗？我已经尝试将字符串的构造移到一些临时变量中：

```
log() {
  local thedate=$(date +'%Y-%m-%d %H:%M:%S')
  local thehostname=$(hostname -s)
  local text="${thedate} ${thehostname} $1"
  echo $text >> /dev/null
} 
```

这样，错误出现的频率就会降低，但它仍然存在，因此这不是真正的修复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T13:15:57.853

我会说这绝对是 bash 中的一个错误，我鼓励您将它报告给 bash 开发人员。至少，对于语法正确的代码，您永远不会遇到语法错误。

作为记录，我得到与你相同的结果`GNU bash, version 4.2.10(1)-release (x86_64-pc-linux-gnu)`。

我发现您可以通过不在陷阱处理程序中调用函数来解决此问题。例如更换

```
trap "log 'received ALRM'" ALRM 
```

和

```
trap "echo $(date +'%Y-%m-%d %H:%M:%S') $(hostname -s) received ALRM" ALRM 
```

使脚本对我稳定。

> 我知道 C 中 SIGNAL 处理的商品，所以我知道在 SIGNAL 处理程序中只允许某些操作。但是，我不知道在 bash 脚本中处理信号时是否也适用相同的预防措施。

我想你不应该采取特殊的预防措施，但显然在实践中你这样做了。鉴于如果没有函数调用，问题似乎就消失了，我猜测 bash 中的某些东西要么不能重入它应该在的地方，要么失败首先阻止重新进入。

# gnu - 安装 gnu smalltalk 的问题

> ID：10194839
> 
> 赞同：1
> 
> 时间：2012-04-17T16:04:05.530
> 
> 标签：gnu, smalltalk, gnu-smalltalk

我试图在 ubuntu 上安装 gnu smalltalk，我从[ftp://ftp.gnu.org/gnu/smalltalk](ftp://ftp.gnu.org/gnu/smalltalk)下载了 smalltalk，并在桌面上提取了文件夹。当我进入 smalltalk 文件夹并且我写“./configure”并且一切似乎都很好时，控制台显示“现在请输入'make'进行编译。祝你好运。”但是当我输入“make”时，下一个对于计算机的一点工作，终端会显示下一条消息：

```
（多行）
     .
     .
     .
libtool：链接：找不到“/home/reikoo/Escritorio/smalltalk-3.2/libc.la”的链接库名称
make[2]: *** [gst] 错误 1
make[2]: se sale del directorio «/home/reikoo/Escritorio/smalltalk-3.2»
make[1]: *** [all-recursive] 错误 1
make[1]: se sale del directorio «/home/reikoo/Escritorio/smalltalk-3.2»
make: *** [全部] 错误 2
reikoo@reikoo-desktop:~/Escritorio/smalltalk-3.2$

```

我不知道怎么了

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T16:41:26.450

您是否尝试过删除文件`libc.la`并再次调用`make`？[（如此](http://lists.gnu.org/archive/html/help-smalltalk/2011-04/msg00160.html)处所建议）

您是否安装了所有[依赖项](http://smalltalk.gnu.org/blog/zuluuuuuu/installing-gnu-smalltalk-ubuntu-10-10)？

# c# - 截取当前网页的屏幕截图，然后使用 ABCpdf 将其转换为 pdf

> ID：10194840
> 
> 赞同：1
> 
> 时间：2012-04-17T16:04:12.770
> 
> 标签：c#, abcpdf

是否可以截取用户所在的当前网页的屏幕截图，然后使用 ABCpdf 将该屏幕截图转换为 pdf？如果有怎么办？我尝试将屏幕截图作为位图，然后用 ABCpdf 进行转换，但是这个编译器说你“不能将位图转换为 ABCpdf8.XImage”有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:37:18.483

考虑创建一个小项目来学习如何从图像创建 PDF，可能有一种图像类型（ipg/png？）可以工作。

接下来学习如何将 BMP 转换为这种类型（[Image.Save](http://msdn.microsoft.com/en-us/library/ms142147.aspx)能够保存为多种格式）。

在这一点上，你有大部分的碎片，应该能够把它们串在一起。

如果您的解决方案是 ASP.Net，则附加步骤：确定您是否要在客户端（需要在客户端运行自定义可执行文件或 ActiveX 控件）或服务器上截屏，以防 ASP.Net 解决方案（需要找到一种渲染方式）服务器上的当前页面 - 这个网站上有很多问题）。

# selenium - 2个版本的webdriverbackedselenium有什么区别

> ID：10194849
> 
> 赞同：0
> 
> 时间：2012-04-17T16:04:51.420
> 
> 标签：selenium

这是版本 1。它是 webdriver-selenium 项目的一部分。 [http://grepcode.com/file/repo1.maven.org/maven2/org.seleniumhq.webdriver/webdriver-selenium/0.9.7376/org/openqa/selenium/WebDriverBackedSelenium.java#WebDriverBackedSelenium](http://grepcode.com/file/repo1.maven.org/maven2/org.seleniumhq.webdriver/webdriver-selenium/0.9.7376/org/openqa/selenium/WebDriverBackedSelenium.java#WebDriverBackedSelenium)

这是第 2 版。它是 selenium-java 的一部分。 [http://grepcode.com/file/repo1.maven.org/maven2/org.seleniumhq.selenium/selenium-java/2.20.0/org/openqa/selenium/WebDriverBackedSelenium.java#WebDriverBackedSelenium](http://grepcode.com/file/repo1.maven.org/maven2/org.seleniumhq.selenium/selenium-java/2.20.0/org/openqa/selenium/WebDriverBackedSelenium.java#WebDriverBackedSelenium)

这2个版本有什么区别？我正在尝试移植一些遗留测试，并想知道我们使用一个或另一个是否会有所不同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:52:25.450

我强烈建议您从他们的网站上获取最新的硒：[http](http://code.google.com/p/selenium/downloads/list) ://code.google.com/p/selenium/downloads/list 。甚至不要尝试使用 0.9.7，因为它已经有一年多了，可能在 webdriverbackedselenium 领域已经修复了数百个错误。我还强烈建议在使用任何 selenium 1 功能时冻结代码，只使用 webdriverbackedselenium 让 sel 1 测试在 sel 2 中运行。这样做有很多好处，但这不是主题。

# wpf - 如何对组合框的 Observable 集合进行排序

> ID：10194850
> 
> 赞同：2
> 
> 时间：2012-04-17T16:04:52.647
> 
> 标签：wpf, mvvm

我有查看源

```
<view:ValidationBaseView x:Class="test.View.test"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:res="clr-namespace:test.Resources"
    xmlns:local="clr-namespace:test"
    xmlns:view="clr-namespace:test.View"
    xmlns:viewModel="clr-namespace:test.ViewModel"
    Height="Auto" Width="Auto">

    <UserControl.DataContext>
        <viewModel:testviewmodelx:Name="testview"/>
    </UserControl.DataContext> 
```

然后我有我的 UI 元素，我将 Combobox 与 ObservableCollection 绑定。但我知道我需要在组合中排序值。

```
<ComboBox Grid.Column="0" 
          Grid.Row="3" 
          x:Name="combo1" 
          Margin ="0" 
          ItemsSource="{Binding Path=test}" 
          DisplayMemberPath="testpath"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:11:17.180

使用`ICollectionView`. 像这样的东西：

```
// this is your existing collection of items
var items = ...;

var cv = new ListCollectionView(items);

// this will sort by the Foo property of each item
cv.SortDescriptions.Add(new SortDescription("Foo")); 
```

在您的视图中，绑定到集合视图而不是原始项目。

# xpages - 如何使用扩展库大纲中的多米诺视图条目树节点

> ID：10194854
> 
> 赞同：0
> 
> 时间：2012-04-17T16:05:09.000
> 
> 标签：xpages

我已经设置`var = ViewEntries2 viewName = ApplicationProfiles`

`= Xpage`如果我尝试设置我的第一列的名称`labelcolumn = myview.Xpage`并且我得到一个错误。如果我使用`labelColumn="1"`我会得到空节点。我似乎找不到太多文档。

```
<xe:basicContainerNode
label="Créer nouvelle requête">
 <xe:this.children>
 <xe:dominoViewEntriesTreeNode
 var="ViewEntries2" viewName="ApplicationProfiles" labelColumn="1" loaded="true" 
  rendered="true">
 </xe:dominoViewEntriesTreeNode>
</xe:this.children></xe:basicContainerNode> 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:00:38.283

尝试将 labelColumn 设置为视图列的编程名称（可以是诸如 $1 之类的数字，也可以是名称 - 检查视图列属性的高级选项卡）。

# java - Java 映射，键 = 类，值 = 该类的实例

> ID：10194855
> 
> 赞同：26
> 
> 时间：2012-04-17T16:05:12.850
> 
> 标签：java, parameterized

我不确定我想做什么是可能的，但如果是的话，我想知道怎么做。基本上，我想创建一个 Map，其中键是一个类 ( `java.lang.Class`)，该条目的值是该类的一个实例。目前我有

```
private Map<Class<?>, Object> myMap = new HashMap<Class<?>, Object>(); 
```

但是，这意味着任何对象都可以放置在地图中。如果可能的话，我想做，所以只有key中的类的一个实例可以放在map中。有什么方法可以使用吗？对类进行参数化以确保这一点？

此外，我发现在执行此类操作时[可能存在内存泄漏](https://stackoverflow.com/questions/2625546/is-using-the-class-instance-as-a-map-key-a-best-practice)。我不确定我是否完全理解这是如何发生的。我只会将单例对象粘贴到地图中，所以还会担心内存泄漏吗？如果是这样，我该如何预防？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-17T16:07:32.830

Java 的类型系统根本不足以强制执行您直接描述的类型约束，并且您需要执行一些不安全的强制转换才能使其工作 - 或者将其包装`Map`在其他一些强制类型安全的 API 中。 [Guava](http://guava-libraries.googlecode.com) [`ClassToInstanceMap`](https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/ClassToInstanceMap.java)正是针对这个用例做到了这一点，它提供了一个外部安全的 API，对`Map`接口施加了额外的限制以使其工作。（披露：我为 Guava 做出了贡献。）

唯一可能导致内存泄漏的情况是，如果您在这里使用的某些类不会在应用程序的生命周期内保留。这不是很多用户关心的问题，特别是如果您正在编写一个不太关心卸载未使用的类的“服务器端”应用程序。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-17T16:24:53.470

您使用的是**[异构容器](https://stackoverflow.com/questions/6139325/heterogeneous-container-to-store-genericly-typed-objects-in-java)**。这些**可以**通过使用类型标记（就像你已经做的那样）和`Class.cast()`正确的应用程序逻辑使它们成为类型安全的：所以在 内部有一个未经检查的 suppressWarning `Class.cast()`，但应用程序逻辑保证了正确性。

我建议您阅读 Josh Bloch 的 Effective Java Item 29：考虑类型安全的异构容器。他的例子是：

```
// Typesafe heterogeneous container pattern - implementation
public class Favorites {
  private Map<Class<?>, Object> favorites =
    new HashMap<Class<?>, Object>();

  public <T> void putFavorite(Class<T> type, T instance) {
    if (type == null)
      throw new NullPointerException("Type is null");
    favorites.put(type, instance);
  }

  public <T> T getFavorite(Class<T> type) {
    return type.cast(favorites.get(type));
  }
} 
```

* * *

如果您拥有实际上不再需要的任意许多不同类型，我只会看到**内存泄漏**的可能性。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-17T16:13:20.830

您可以隐藏集合，只允许通过访问器方法访问它。

```
private final Map<Class, Object> myMap = new HashMap<Class, Object>();

public <T> void putMap(Class<T> tClass, T t) {
     myMap.put(tClass, t);
}

@SuppressWarnings("unchecked")
public <T> T getMap(Class<T> tClass) {
    return (T) myMap.get(tClass);
} 
```

可以忽略该警告，因为您知道最后一个方法中的强制转换是安全的，即使编译器不这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T16:09:25.060

由于类型擦除，这是不可能的。

但是，您可以子类`HashMap`化并将一些逻辑写入`put`将为您执行此操作的方法：

```
public void put(K key, V value) {

    if  ( // value is an instance of key using .getClass()) { 
        super.put(key, value)
    }
    throw new Exception();
} 
```

（代码仅用于说明目的）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-26T13:48:54.330

我有同样的要求。我使用以下代码解决了它：

```
interface Service { }

class ServiceCache {
private HashMap<Class<? extends Service>, Service> services;

public ServiceCache() {
    services = new HashMap<>();
}

public <T extends Service> T getService(Class<T> service) {
    if (services.containsKey(service))
        return (T) services.get(service);
    return null;
}

public <T extends Service> void addService(T service, Class<? extends Service> serviceInterface) {
    services.put(serviceInterface, service);
 }
} 
```

# bash - bash, zsh : 声明 [*] (天哪)

> ID：10194861
> 
> 赞同：4
> 
> 时间：2012-04-17T16:05:22.270
> 
> 标签：bash, zsh

我正在使用具有以下语法的 bash 脚本

```
$ declare -a THIS[*] 
```

这在 zsh 中似乎是非法的（我收到“找不到匹配项：THIS[*]”错误）。谁能帮我把它翻译成zsh？

另外 -`[*]`语法是什么意思？（我知道我们正在声明一个数组，但为什么是 [*]？）

*更新*

为了提供一个使用代码的示例，并解释它是如何有效的 - 我从 Eric Engstrom 的关于[无密码 ssh的帖子中复制了几行](http://www.mtu.net/~engstrom/ssh-agent.php)

```
declare -a SSSHA_KEYS[*]

# --- PARSE ARGS --- #
sssha_parse_args() {
  local OPTIND=1
  while getopts "xe:k:t:" OPT; do
    #echo "$OPT $OPTARG $OPTIND"
    case $OPT in
      t) SSSHA_ARGS="-t $OPTARG" ;;
      e) SSSHA_ENV="$OPTARG" ;;
      k) [ -f "${OPTARG}" ] && SSSHA_KEYS[${#SSSHA_KEYS[*]}]="$OPTARG" ;;
      x) SSSHA_STOP_ON_EXIT=$OPT
    esac
  done
  shift $(($OPTIND - 1))

  # set default key, if none specified
  if [ -z "${SSSHA_KEYS[*]}" ]; then
    for key in $HOME/.ssh/id_[rd]sa; do
      [ -f "$key" ] && SSSHA_KEYS[${#SSSHA_KEYS[*]}]="$key"
    done
  fi
} 
```

我相信`[*]`它被用作某种动态迭代器（因为我们不知道它以后会有多少项目）。我只想知道zsh中的等效声明！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:31:49.877

只有 Bash 有`declare`。kshes 和 zsh 有`typeset`. 该代码在所有代码中都是无意义的，并且由于 shell 不同意解析*声明命令*的参数，例如`declare`and `typeset`（特别是 Bash，`-a`以特定方式改变解析），它将在每个。

具体来说，Bash 是如何解释这一点的——来自手册页：

> declare -a name[subscript] 也被接受；下标被忽略。

因此，由于它没有被引用——如果当前目录中有一个名为的文件，`THIS*`那么由于路径名扩展，Bash 会抛出一个非法名称错误。否则它只会创建一个名为“THIS”的空数组。

什么`[*]`意思取决于上下文。在普通命令评估上下文中未引用，它是一个仅匹配文字星号的字符类。如果在数组名称后面的参数扩展中使用，它将数组的所有元素扩展为由 IFS 的第一个字符分隔的单个单词。

`declare`在 bash 中声明变量、返回它们的值、设置属性并影响函数范围。见：[http ://wiki.bash-hackers.org/commands/builtin/declare](http://wiki.bash-hackers.org/commands/builtin/declare)

**编辑**：鉴于现在问题中的示例，在 bash 中，行为如上所述。`[*]`应该从`declare`. 该代码还有许多其他问题，例如尝试将参数放入字符串、使用全大写变量名以及在显然不打算在最小 POSIX sh 上运行的脚本中使用`[`而不是。`[[`

# .net - .net 计时器之间的区别

> ID：10194865
> 
> 赞同：1
> 
> 时间：2012-04-17T16:05:39.313
> 
> 标签：.net, windows

.NET 下有几个**定时器。**

有人可以解释清楚它们之间的主要区别是什么以及我们何时必须使用它吗？（包括`DispatcherTimer`）

谢谢！！

# android - 如何首先在imageview中加载模糊图像，然后使其清晰，以增强android的用户体验？

> ID：10194866
> 
> 赞同：2
> 
> 时间：2012-04-17T16:05:56.583
> 
> 标签：android, image-processing

我正在开发一个需要下载大量图像的应用程序。图像将以全屏模式显示。因此，我想知道如何快速加载图像，以使应用程序更具响应性并增强用户体验。我想，至少，先显示一个模糊的图像，然后让它变得清晰。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T16:10:59.490

使用[BitmapFactory.Options.inSamleSize](http://developer.android.com/reference/android/graphics/BitmapFactory.Options.html#inSampleSize)加载图像的下采样版本。然后加载更大的图像并使用[TransitionDrawable进行淡入淡出过渡](http://developer.android.com/reference/android/graphics/drawable/TransitionDrawable.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T16:18:19.923

您正在寻找“渐进式图像渲染”，它可以以各种不同的图像格式完成，包括 png、jpeg、gif 等。下次您要将图像保存在一个好的图形程序中时，选择其中一种格式并查看您的保存选项。您应该可以选择保存“隔行扫描”图像。

Coding Horror 的 Jeff Atwood 在这里写得很好：http: [//www.codinghorror.com/blog/2005/12/progressive-image-rendering.html](http://www.codinghorror.com/blog/2005/12/progressive-image-rendering.html)

# asp.net-mvc - 存储库验证

> ID：10194867
> 
> 赞同：2
> 
> 时间：2012-04-17T16:06:03.613
> 
> 标签：asp.net-mvc, design-patterns, repository-pattern

将 mvc 与存储库一起使用时验证模型的最佳方法是什么？我寻找例子，但我没有找到任何正是我需要的。

假设我有一个具有 5 个属性的模型……其中 3 个带有数据注释……并且我有一些验证，我需要在插入之前检查数据库。

我需要像“User.IsValidToInsert”这样的东西来检查它是否有效。但我也想使用“ModelState.IsValid”，因为我不想手动检查“IsValidToInsert”中带有数据注释的所有属性。

我怎样才能做到这一点？我应该在“IsValidToInsert”中设置访问数据库的验证吗？我应该将“用户”和“模型状态”之类的参数传递给存储库类吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:44:35.100

您应该使用特定于视图的视图模型。如果您有`Create`创建 的操作`Product`，请创建一个`ProductCreate`视图模型。您可以放置​​特定于创建产品的数据注释（或 Fluent Validation 等）。这将是您的视图/控制器的模型。如果您有一个编辑页面，则创建一个`ProductEdit`视图模型。

现在，如果您有其他逻辑（例如验证用户是否已经存在，那么您应该将其放在服务层中。您的控制器应该尽可能简单。您发布您的视图模型，将其转换为域模型并传递它必要时到服务层。

```
[HttpPost]
public ActionResult Create(ProductCreate model)
{
    // simple validations
    if( !ModelState.IsValid )
    {
        return View(model);
    }

    // Domain Model / Entity
    Product product = // create a product from your model here

    // service layer
    ProductService.Add(product);

    return RedirectToAction("Index");
} 
```

# jms - 使用 JMS (ApacheMQ) 和 Camel 更新多个 GUI/可视化

> ID：10194868
> 
> 赞同：0
> 
> 时间：2012-04-17T16:06:06.030
> 
> 标签：jms, apache-camel

我需要在 Java 中创建一个绘图应用程序，其中用户在主应用程序上绘制线条和颜色等，并且许多客户端查看器相应地更新他们的视图。每个客户端查看器可以不同地可视化接收到的数据（例如，给定在主应用程序中绘制的一条线，查看器 1 可能会执行相同的操作，而查看器 2 可能会应用一些过滤以显示不同。）。

对于这样的应用程序，Java 消息服务方法是一个不错的选择吗？主应用程序将发送消息中的更改，客户端将异步更新他们的视图。稍后我可能需要区分发出的数据类型，因此考虑使用 CAMEL 为不同的客户端设置不同的主题。如果这些都不是一个好的选择，那么有什么适合的技术呢？

如果稍后设计发生变化，以便每个客户端也发送更新并需要相应地更新，它们仍然是一个不错的选择吗？

如果主应用程序中的更新率/数量很大，这种方法会扩展吗？（例如，1024x768 像素或更高像素的更新速度为 60 帧/秒。-我可能可以计算帧差并仅发送更改。）

感谢您抽出宝贵时间，并对许多问题感到抱歉。如果我的任何假设也是错误的，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T07:32:02.543

While it is do-able, I doubt JMS and Camel would be the best fit for this type of distributed application.

JMS/Camel are good for enterprise integration scenarios where you want some level of decoupling between services and consumers. The decoupling usually comes with maintenance and performance overheads.

For the type of app you describe, it sounds like decoupling us not important so you might be better off looking at some distributed application environment where the clients and servers are implemented in the same language and you have rpc calls between them.

Depending on your language choice, distributed technologies you could consider are: distributed Java, distributed Ruby, Celluloid, HTML5+Websockets (e.g. check out meteor.com).

# javascript - 如何在javascript中将数据添加到文件中？

> ID：10194871
> 
> 赞同：0
> 
> 时间：2012-04-17T16:06:24.297
> 
> 标签：javascript, overriding, using, activexobject

我想制作注册表并使用 ActiveXObject 将数据写入 data.txt。我写的是

```
<script type="text/javascript">
    function WriteFile()
    {
       var fso  = new ActiveXObject("Scripting.FileSystemObject");
       var fh = fso.CreateTextFile("E:\\Test.txt", true);
       x=document.getElementById("name").value;
       y=document.getElementById("password").value;
       fh.WriteLine(x+"#"+y);
       fh.Close();
    }
</script>
<BODY>
<form>
    <input type="text" id="name"/>
    <input type="text" id="password"/>
    <input type="button" value="Sign Up" id="write" onclick="WriteFile()"/>
</form>
</BODY> 
```

当我尝试这种方式时，每次单击“注册”按钮时，新数据都会覆盖以前的数据。我尝试使用`fh.AppendLine(x + "#" + y)`但没有用。

谁能帮助我如何添加数据，而不是覆盖数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:13:06.823

我很久以前做过这样的事情......（当我使用Windows时）我认为这是因为你用新文件替换文件`CreateTextFile`所以如果文件已经存在你需要这样做：

```
function AppendLine()
{
   var fso  = new ActiveXObject("Scripting.FileSystemObject");
   var fh = fso.OpenTextFile("E:\\Training Asslab\\Advance\\Write to File\\Test.txt", 8, True);
   x=document.getElementById("name").value;
   y=document.getElementById("password").value;
   fh.WriteLine(x+"#"+y);
   fh.Close();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:13:36.050

我认为 CreateTextFile 会覆盖当前文件。在创建它之前，您应该使用 FileExists 来检查它的存在。如果确实存在，您可以使用 OpenTextFile。

这是相关[文档](http://msdn.microsoft.com/en-us/library/z9ty6h50%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T16:14:07.270

**免责声明**您不应该使用这些功能。他们只在 IE 中工作，而且很糟糕。

我认为您的问题源于使用`CreateTextFile`. 您应该[`OpenTextFile`](http://msdn.microsoft.com/en-us/library/314cz14s%28v=vs.84%29.aspx)将第二个参数设置为`8`. 这将允许追加。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T16:17:44.360

使用带有创建标志和 ForAppending 模式的[OpenTextFile](http://msdn.microsoft.com/en-us/library/314cz14s%28v=vs.85%29.aspx)方法，而不是`CreateTextFile`.

但是，请理解，您不仅将自己限制在非常旧的 IE 版本和受信任区域内，而且还将文件留在用户的本地驱动器上，而不是在您的服务器上。因此，您无法使用此“注册数据”做任何事情。

# php - 如何在此 PHP 代码中捕获文本框值并将其附加到 URL？

> ID：10194877
> 
> 赞同：0
> 
> 时间：2012-04-17T16:06:46.730
> 
> 标签：php, javascript, html

我设法让我的 API 歌词代码正常工作。我面临的只是一个小问题：当用户在文本框中输入歌曲名称并单击提交按钮时，我通过 getElementById 捕获该值，然后如何将其附加到下面的 URL 中？

这是我的代码：

```
<?php
     //Catches the value of the Submit button: 
     $submit = isset($_POST['submit']);
     if($submit) {
?>
     <script type="text/javascript">
         var val1 = document.getElementById('val').value;
     </script>
<?php
    /* The below $res contains the URL where I wanna append the caught value. 
       Eg: http://webservices.lyrdb.com/lookup.php?q=Nothing Else Matters(Or 
       what the user searches for)&for=trackname&agent=agent
    */
      $res = file_get_contents("http://webservices.lyrdb.com/lookup.php?q='+val1+' &for=trackname&agent=agent");
?>
<html>
   <form method="post" action="">
      Enter value: <input type="text" name="value" id="val" /><br/>
      <input type="submit" value="Submit" name="submit" />
   </form>
</html> 
```

你能否纠正我在这段代码中的错误，非常感谢这个论坛的所有帮助！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:14:51.640

据我了解您的问题，您需要做的是：

```
<?php
     //Catches the value of the Submit button: 
     $submit = isset($_POST['submit']);
     if($submit) {
     $val1 = $_POST['val'];    // TO store form passed value in "PHP" variable.
    /* The below $res contains the URL where I wanna append the caught value. 
       Eg: http://webservices.lyrdb.com/lookup.php?q=Nothing Else Matters(Or 
       what the user searches for)&for=trackname&agent=agent
    */
      $res = file_get_contents("http://webservices.lyrdb.com/lookup.php?q=' . urlencode($val1) . ' &for=trackname&agent=agent");
   }   // This is to end the "if" statement
?> 
```

然后将表单输入字段更改为：

```
 Enter value: <input type="text" name="val" id="val" /><br/> 
```

我不确定 POST 是否`id`也接受值！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-17T16:16:10.257

删除 javascript 这是不必要的。*PHP 在**服务器上***运行。***客户端****的 Javascript***。**

 **然后将您的 PHP 代码更改为：

```
if(isset($_POST['value'])) {
    $res = file_get_contents("http://webservices.lyrdb.com/lookup.php?q=". $_POST['value'] ." &for=trackname&agent=agent");
} 
```**

# c# - LINQ OrderBy/ThenBy ChildrenCollection.SortOrder

> ID：10194878
> 
> 赞同：1
> 
> 时间：2012-04-17T16:06:52.240
> 
> 标签：c#, linq, entity-framework, linq-to-entities

编辑：

此示例中的两个查询都不是按位置排序顺序排序的。有人对如何做到这一点有任何建议吗？

我需要一些帮助来按子实体列对组的实体集合进行排序。我有从组到位置的一对多关系。

我需要按组名排序，然后按位置排序顺序。

由于子实体是一个集合，我遇到了麻烦。

这是我正在使用但返回重复项的代码：

```
 var groups = db.GetNavigationGroups()
    .Where(g => selectedLocation > 0 ? g.NavigationGroupLocations.Any(l => l.Location == selectedLocation) : true)
    .SelectMany(g => g.NavigationGroupLocations, (g, l) => new { g, l })
    .OrderBy(x => x.g.Name)
    .ThenBy(x => x.l.SortOrder)
    .Select(x => x.g); 
```

然后我使用 FirstOrDefault() 尝试了这种方法：

```
 List<NavigationGroup> groups = db.DataModel.NavigationGroups
    .Where(g => selectedLocation > 0 ? g.NavigationGroupLocations.Any(l => l.Location == selectedLocation) : true)
    .OrderBy(g => g.Name)
    .ThenBy(g => g.NavigationGroupLocations.Where(l => l.Location == selectedLocation && l.GroupID == g.ID).OrderBy(l => l.SortOrder).FirstOrDefault())
    .ToList(); 
```

问题是我似乎无法根据位置 SortOrder 列按我需要它们的顺序获取组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:59:56.617

您的第二个查询看起来像是在尝试按 NavigationGroupLocations 对象而不是按其字段进行排序。你有没有尝试过：

```
List<NavigationGroup> groups = db.DataModel.NavigationGroups
.Where(g => selectedLocation > 0 ? g.NavigationGroupLocations.Any(l => l.Location == selectedLocation) : true)
.OrderBy(g => g.Name)
.ThenBy(g => g.NavigationGroupLocations.Where(l => l.Location == selectedLocation && l.GroupID == g.ID).OrderBy(l => l.SortOrder).FirstOrDefault().SortOrder)
.ToList(); 
```

您可能还想将您的 selectedLocation 条件添加到 order 子句中。

```
List<NavigationGroup> groups = db.DataModel.NavigationGroups
.Where(g => selectedLocation > 0 ? g.NavigationGroupLocations.Any(l => l.Location == selectedLocation) : true)
.OrderBy(g => g.Name)
.ThenBy(g => g.NavigationGroupLocations.Where(l => selectedLocation > 0 ? l.Location == selectedLocation : true && l.GroupID == g.ID).OrderBy(l => l.SortOrder).FirstOrDefault().SortOrder)
.ToList(); 
```

# actionscript-3 - AS3 AIR 安全插座 (X509Certificate)

> ID：10194879
> 
> 赞同：0
> 
> 时间：2012-04-17T16:06:54.780
> 
> 标签：actionscript-3, sockets, air

我使用套接字通过 AS3/AIR 连接到 IRC 没有问题，但是当我使用 SecureSocket 版本时，我收到如下错误：

```
Error #2031: Socket Error. URL: irc.link-net.org, untrustedSigners
[IOErrorEvent type="ioError" bubbles=false cancelable=false eventPhase=2 text="Error #2031: Socket Error. URL: irc.link-net.org" errorID=2031] 
```

尝试使用另一个 SSL IRC 服务器并获得：

```
Error #2031: Socket Error. URL: irc.choopa.ca, unknown
[IOErrorEvent type="ioError" bubbles=false cancelable=false eventPhase=2 text="Error #2031: Socket Error. URL: irc.choopa.ca" errorID=2031] 
```

我阅读了有关 x.509 证书的信息，但我不知道如何使用它们。

> X509Certificate 类表示 X.509 证书。此类定义 RFC2459 中指定的 X.509 属性。成功调用 SecureSocket.connect() 后，服务器的证书数据将作为 X509Certificate 实例存储在 SecureSocket.serverCertificate 属性中。

有谁知道如何实施证书？它应该在服务器端（IRC）吗？

编辑：我已经安装了 UnrealIRCD 并让它在我的本地网络上的端口 +7000 上运行良好，当我使用 SSL 使用 Mirc 连接到它时，我有自签名证书警报，我接受它并且我已登录。我现在想弄清楚这是否是 X509 证书？

```
Error #2031: Socket Error. URL: 127.0.0.1, invalid
[IOErrorEvent type="ioError" bubbles=false cancelable=false eventPhase=2 text="Error #2031: Socket Error. URL: 127.0.0.1" errorID=2031] 
```

# graph - 无向图的 Delaunay 三角剖分等价

> ID：10194880
> 
> 赞同：0
> 
> 时间：2012-04-17T16:06:55.837
> 
> 标签：graph, triangulation, traveling-salesman, delaunay

我正在研究一种相当于旅行商问题的路径规划算法。我不知道我可能有多少个节点，所以我愿意牺牲准确性来换取速度。我的问题可以建模为一个完全连接的图，节点之间的转换成本不仅仅与节点之间的距离有关。我想将我的搜索空间限制为位于 delaunay 三角剖分上的连接（我读过的研究指出，TSP 解决方案中 95-100% 的连接位于 delaunay 三角剖分上）但由于我的图表无法表达作为 2D 甚至 3D 几何，我不能直接在我的表示中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:02:44.030

对于 n 维，您可以尝试格雷码。

# snmp - 从零开始的 MIB 设计

> ID：10194885
> 
> 赞同：0
> 
> 时间：2012-04-17T16:07:12.857
> 
> 标签：snmp, mib

我需要从头开始为 SNMP 分析设计 MIB。我的意思是，我们在树 2.25 上为我们的企业获得了一个 OID，现在是时候编写代码了。

但是，我无法举一个例子。在我们的 Linux 机器上查看 /usr/share/snmp/mibs 目录时，会看到很多文件（例如：HOST-RESOURCES-MIB.txt、IF-MIB.txt 等）。我知道这些文件遵循 MIB 格式，但我只是不明白，因为它们导入了一些对我来说完全陌生的东西。

例如：

```
IMPORTS
    MODULE-IDENTITY, OBJECT-TYPE, Counter32, Gauge32, Counter64,
    Integer32, TimeTicks, mib-2,
    NOTIFICATION-TYPE                        FROM SNMPv2-SMI
    TEXTUAL-CONVENTION, DisplayString,
    PhysAddress, TruthValue, RowStatus,
    TimeStamp, AutonomousType, TestAndIncr   FROM SNMPv2-TC
    MODULE-COMPLIANCE, OBJECT-GROUP,
    NOTIFICATION-GROUP                       FROM SNMPv2-CONF
    snmpTraps                                FROM SNMPv2-MIB
    IANAifType                               FROM IANAifType-MIB; 
```

然后，在每个导入文件中，我看到更多的导入和更多的导入。有人可以告诉我什么是最重要的文件，或者指出我的任何方向常见问题或其他什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T05:59:39.810

你应该回到它的 IETF RFC 文档，

[http://www.rfc-editor.org/rfc/rfc2578.txt](http://www.rfc-editor.org/rfc/rfc2578.txt)

# java - 无法在 Google Web 应用程序项目中获取 cookie

> ID：10194890
> 
> 赞同：0
> 
> 时间：2012-04-17T16:07:28.420
> 
> 标签：java, web-services, google-app-engine

我正在尝试在我创建的 Google Web 应用程序项目中通过 Java 访问 Web 服务。

该代码应该命中端点 URL 并通过用户名/密码对用户进行身份验证，并获取服务器在 cookie 中提供的 jsessionID。身份验证工作正常，但我无法从 cookie 中提取 JsessionID。

以下是我正在使用的代码：-

```
private static String getCookieFromHeaders(HttpURLConnection wsConnection) {

    String headerName;
    String headerValue = "FAIL";
    for (int i = 0;; i++) {
        headerName = wsConnection.getHeaderFieldKey(i);
        if (headerName != null && headerName.equals("Set-Cookie")) {
            headerValue = wsConnection.getHeaderField(i);
            break;
        }
    }
    // return the header value (FAIL string for not found)
    return headerValue;
} 
```

变量 headerName 只是在无限循环中给出“null”。

请告知，这里是一个完整的 Java 菜鸟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:18:45.950

为什么不直接使用 HttpServletRequest.getCookies()？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T17:54:09.193

实际上正在接收cookie，标头是“set-cookie”而不是“Set-Cookie”。只是因为愚蠢的无限循环而无法发现它！

# assembly - ARM 程序集，比较有符号值

> ID：10194892
> 
> 赞同：1
> 
> 时间：2012-04-17T16:07:58.173
> 
> 标签：assembly, arm, arm7

我有一个非常简单的问题，但它把我逼到了墙角，你能帮帮我吗？

这是一个问题：如何比较 ARM 汇编中的两个有符号字节值？这是我尝试过的：

```
ldrsb r1, [r0], #1
ldrsb r2, [r0]
cmp r1, r2 
```

r0 加载了字节值列表的地址，例如 10、-1、123。加载负数时，ldrsb 是否应该不 sig 扩展？我搞不清楚了

**编辑：**

好吧，我们应该编写一个对有符号字节值列表进行排序的程序（使用冒泡排序）。我可以弄清楚如何做到这一点，只是我不了解实际的比较（或其结果）。到目前为止，这是我的代码：

```
.global main

.section .data
  myNumbers: .byte 183, 374, -113, -1, 10, 101, -3, -54, 9, 7
  myNumbersEnd:

.section .text
  main:

  loop:
    mov r4, #0
    ldr r0, =myNumbers
    ldr r3, =myNumbersEnd

inner_loop:
    ldrsb r1, [r0], #1  
    ldrsb r2, [r0]  
    cmp r1, r2

    strgtb r1, [r0]
    strgtb r2, [r0, #-1]
    movgt r4, #1 @ r4 = swapped = true

    cmp r0, r3
    bne inner_loop

    cmp r4, #1
    beq loop @ keep going
exit:
    b exit
.end 
```

也许我应该补充一点，我不是在实际的 ARM 硬件上运行此代码，而是在 ARMSim#（ARM7TDMI 处理器的模拟器）上运行此代码：http: [//armsim.cs.uvic.ca/index.html](http://armsim.cs.uvic.ca/index.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T19:46:40.963

好的，我会尝试打破它。

1.  `r4`包含“我们交换了任何东西吗？”
2.  `r0`并`r3`包含输入数据的开始和结束

    ```
    loop:
      mov r4, #0
      ldr r0, =myNumbers
      ldr r3, =myNumbersEnd 
    ```

3.  `r1`用 指向的字节加载和签名扩展`r0`，更新`r0`为`r0+1`

4.  还`r2`从更新的加载和签名扩展`r0`
5.  比较两个值，这基本上`r1-r2`取决于结果标志的更新。

    ```
    inner_loop:
        ldrsb r1, [r0], #1  
        ldrsb r2, [r0]  
        cmp r1, r2 
    ```

6.  如果 r1 大于 r2，则以交换顺序存储值

7.  同时设置交换标志（r4）

    ```
     strgtb r1, [r0]
        strgtb r2, [r0, #-1]
        movgt r4, #1 @ r4 = swapped = true 
    ```

8.  将我们当前的指针 in`r0`与 in 的结束指针进行比较`r3`

9.  除非它们相等，否则下一个字节

    ```
     cmp r0, r3
        bne inner_loop 
    ```

10.  检查我们是否交换了任何东西，如果我们交换了，则重新开始。

    ```
     cmp r4, #1
        beq loop @ keep going 
    ```

这里的重点是比较。如前所述， cmp 执行 op1-op2 会丢弃结果，但会根据结果设置标志，这些标志是： N = tempresult[31] （表示设置了 MSB，对于带符号的值意味着结果是有符号的. Z = tempresult == 0 （当两个值相等时为 1） C = tempresult[31] != op1[31] （用于无符号比较，表示 op1 < op2） V = op1[31] != op2[ 31] && op1[31] != tempresult[31] （类似于有符号值的进位）

接下来，您的 strgtb 首先使用标志来查看它是否真的需要执行，条件`gt`转换为：

```
Z == 0 && N == V 
```

如果条件为真，该指令将被执行，接下来的两条指令相同。

仅供参考，您的数据集包含无效数据

```
 myNumbers: .byte 183, 374, -113, -1, 10, 101, -3, -54, 9, 7 
```

183 和 374 可能会引起混淆。有效的 SIGNED 8 位值介于 -128 和 127 之间。您的代码会将 183 评估为有符号值。

# objective-c - 在 Tableview 上删除警报确认

> ID：10194896
> 
> 赞同：0
> 
> 时间：2012-04-17T16:08:16.070
> 
> 标签：objective-c, ios, uitableview

当我滑动并单击表格视图上的删除按钮时，我想要一个警报确认。基本上我想在发送数据之前显示一个带有“确定”和“取消”按钮的警报弹出窗口：

```
[[ConnectionSingleton getInstance] sendData:[NSString stringWithFormat:@"modifOrderFoodState::%@::%@::%@", [cellOrder objectForKey:@"orderFoodRelId"], state, [ConnectionSingleton getInstance].restaurantId] ]; 
```

如果客户端点击取消按钮，则中止发送数据功能。

这是我的代码：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {

NSMutableDictionary *cellOrder = [orders objectAtIndex:indexPath.row];
NSString *state = @"4";

if (editingStyle == UITableViewCellEditingStyleDelete) {

    [[ConnectionSingleton getInstance] sendData:[NSString stringWithFormat:@"modifOrderFoodState::%@::%@::%@",
                                                 [cellOrder objectForKey:@"orderFoodRelId"],
                                                 state,
                                                 [ConnectionSingleton getInstance].restaurantId] ];
  }    
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:21:44.793

使此类成为 UIAlertViewDelegate。删除样式时创建 UIAlertView。将发送数据代码移动到 alertView:clickedButtonAtIndex: 方法中，如果用户单击 OK，则运行它。

# android - 单元测试安卓

> ID：10194897
> 
> 赞同：2
> 
> 时间：2012-04-17T16:08:16.680
> 
> 标签：android, unit-testing

对 android 应用程序进行单元测试通常比预期的要困难，因为有些类没有公共构造函数（如 NotificationManager）和具有无法覆盖的方法的类，如 Context.getText。

对于 NotificationManager，我使用了委托人。我会对上下文做同样的事情，但这意味着在所有使用上下文（很多）的类中，我需要使用我自己的上下文，甚至不能从上下文派生。然后，每当我需要将上下文传递给 Android API 时，我都需要从我的包装器中获取真正的上下文。

它是否正确？还有另一种方法吗？将这些方法声明为 final 的理由是什么？是否有人真正为 Android 的大型应用程序编写过单元测试？

**编辑**

我找到了将 getText 方法定义为 final 的原因：它是一个模板方法。所以重写被调用的非最终方法就足够了

我也发现[这](https://stackoverflow.com/questions/5827139/android-junit-define-a-different-application-subclass)行得通，但有点奇怪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T23:58:37.783

问题有点模糊，所以我要写一个长答案。

> 有些类没有公共构造函数（如 NotificationManager）

因为有一些系统范围的资源/组件（例如 NotificationManager）Android 不喜欢应用程序按需构建/实例化，而是这些资源由系统集中和管理，应用程序应始终使用系统提供的 API 来获取它们.

> 以及具有无法覆盖的方法的类，例如 Context.getText

通常在 Java 中，标记为 final 的方法意味着它们受 API 保护，API 开发人员不希望应用程序开发人员覆盖默认行为。特别是对于 Context.getText() 这个方法，它实际上使用了模板方法模式，查看下面 herschel 的评论和[源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/android/content/Context.java?av=f#271)以获取更多详细信息。

## 那么问题是我们如何正确测试使用这些基于android上下文的资源/组件编写的代码？

Android SDK 给出的答案是测试项目（通过 InstrumentationTestRunner）。一般在使用 InstrumentationTestRunner 时，sense 背后，系统会同时安装 test.apk（从测试项目构建）和 app.apk（从应用项目构建），并使用 test.apk 操作 app.apk 进行测试。**无论您使用 AndroidTestCase API（下图中称为 JUnit）还是​​ InstrumentationTestCase API（下图中称为 Instrumentation），都会发生这种情况**相应的基于android上下文的可测试资源/组件（即Activity、NotificationManager或TextView）都是从实际运行的app.apk实例中获取的。如果您在测试项目中创建/使用自己的 MockContext，您可以从图中看到模拟对象被 InstrumentationTestRunner 注入到正在运行的应用程序中。

![在此处输入图像描述](../Images/81d95a69627ee2adf9186a6e79bf33b0.png)

使用仪器测试的缺点在于效率，它进入了完整的运行生命周期（启动模拟器 -> 安装并启动 test.apk 和 app.apk 并触发 InstrumentationTestRunner），即使您只需要从单个方法测试单个方法类（正如你在评论中提到的）。我同意奥利的观点，这是一个敌对的设计。

这就是[Robolectric](http://pivotal.github.com/robolectric/index.html)发挥作用的地方，从他们的网站上引述：*Robolectric 是一个单元测试框架，它去除了 Android SDK jar 的齿，因此您可以测试驱动您的 Android 应用程序的开发。测试在几秒钟内在您的工作站上的 JVM 中运行。*

根据我自己的经验，我有一个应用程序包含大约 10 个活动和几个服务以及一些其他自定义视图/小部件，主要与远程服务器进行 http 通信，并使用仪器测试（通过测试项目）和 Robolectic 测试基于 Android 上下文的代码。只要时间允许，我几乎可以测试我的应用程序的几乎每一个类/公共方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:20:26.750

Android 在很多方面都非常反对测试。

您可能想看看 Roboelectric [http://pivotal.github.com/robolectric/](http://pivotal.github.com/robolectric/)

我假设你已经阅读了这些：

[http://developer.android.com/guide/topics/testing/index.html](http://developer.android.com/guide/topics/testing/index.html)

[http://developer.android.com/resources/tutorials/testing/helloandroid_test.html](http://developer.android.com/resources/tutorials/testing/helloandroid_test.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T16:21:59.220

Android 为您提供的 *TestCase 类应该能够解决您遇到的测试问题。在大多数情况下，它会为您生成一个上下文，您可以根据需要覆盖该上下文。我建议从那里开始，或者询问有关如何测试一件事或另一件事的更具体的问题。

# wordpress - 导出日历以换取 ICS 文件以供 wordpress

> ID：10194898
> 
> 赞同：0
> 
> 时间：2012-04-17T16:08:16.613
> 
> 标签：wordpress, outlook, exchange-server

我正在尝试在 Wordpress 中显示源自交换服务器的日历事件。Wordpress 接受 ICS 文件。

如何从 MS Exchange 电子邮件服务器获取 ICS 文件？

注意：它不一定是 ics 文件管理器，只要有一种方法可以导入到 wordpress 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T23:03:55.107

如果您使用一些自定义代码与 Exchange Web 服务 (EWS) 连接，您可以获得约会详细信息并将其格式化为 ICS 文件以推送到 WordPress。

# c# - 如何在 post 方法中获取实际控制器

> ID：10194900
> 
> 赞同：1
> 
> 时间：2012-04-17T16:08:21.727
> 
> 标签：c#, jquery, json, asp.net-mvc-3

我有两个控制器 Project 和 Tag，它们都有一个创建视图和获取发布方法。

从项目创建视图中，我可以选择添加一个标签，该标签打开一个带有标签创建视图的对话框。

当我添加标签时，它会进入标签控制器创建发布方法，此时我希望能够获得将它发送到那里的控制器操作（在本例中为项目）。我看过 UrlReferer 类，有没有比这更好的方法来获取控制器？

我需要这个的原因是我希望能够做类似的事情

```
 if (Request.IsAjaxRequest())
            {
                if (REFERER CONTROLLER != Tag Controller)
                {
                       return Json(new { Item = item, Success = true });
                }
                else 
                {
                    return RedirectToAction("Index");
                }
             } 
```

所以基本上如果对话框在另一个控制器中，则返回新值的 json，否则返回索引操作

**编辑**最终再次使用了这个想法。去了

```
if (Url.IsLocalUrl(Request.UrlReferrer.AbsoluteUri) && !String.Equals(Request.UrlReferrer.LocalPath.TrimEnd('/'), Url.Action("Index"), StringComparison.OrdinalIgnoreCase))
{
    return Json(new { Item = item, Success = true, Field = String.Format("#Selected{0}s", ControllerName) });
}
return Json(new { Success = true, Field = "#mainContent", Url = Url.Action("Index") }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T16:11:50.473

你有几个选择：

1.  您可以查看引用 URL（除非您需要访问类中的某种方法或属性，否则获取引用 URL 字符串、解析控制器名称然后创建控制器类的实例是没有意义的；我只想看字符串）。
2.  您可以包含一个包含控制器名称的隐藏输入。
3.  您可以在 session 中存储一个值（这看起来有点过分；记住，将为此创建一个 cookie）来记住用户来自哪个页面。

在您的服务器接收到值之前，选项 1 和 2*可能会*被篡改。

# timestamp - Esper：将开始/结束时间戳与 POJO 或运行时定义的事件类型一起使用

> ID：10194901
> 
> 赞同：0
> 
> 时间：2012-04-17T16:08:23.033
> 
> 标签：timestamp, esper, complex-event-processing

我正在尝试直接对事件类型使用[时间间隔代数方法](http://esper.codehaus.org/esper-4.5.0/doc/reference/en/html/datetimereference.html#datetime-method-intervalref)，根据文档，这应该是可能的。我首先尝试使用`create schema`语法定义一些事件类型，如下所示：

```
create schema BaseEvent as (time long, name String) starttimestamp time
create schema ExtendedEvent as (moreInfo String) inherits BaseEvent 
```

如果我写这样的查询

```
select *
    from BaseEvent.std:lastevent() as a, ExtendedEvent.std:lastevent() as b
    where a.after(b) 
```

它实际上编译没有错误。但是如果我尝试使用模式而不是连接，就像这样

```
select *
    from pattern [ every (a = BaseEvent and b = ExtendedEvent) ]
    where a.after(b) 
```

它给了我一个错误：

```
Date-time enumeration method 'after' requires either a Calendar,
Date or long value as input or events of an event type that
declares a timestamp property 
```

当我尝试使用派生自基本事件类型的 POJO 时出现相同的错误，该基本事件类型具有[文档中描述](http://esper.codehaus.org/esper-4.5.0/doc/reference/en/html/configuration.html#config-java-startendtimestamp)的时间戳属性。虽然它在我实际使用基类型时有效，但在这种情况下，Esper 不使用继承的时间属性似乎很奇怪，而在其他情况下它确实使用了有关继承它的信息。

难道我做错了什么？这是一个错误吗？或者也许它只是按预期工作......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T00:14:56.157

它实际上是一种错误或“缺失”功能：

实际上有两个问题我在这里感到困惑。首先是Esper 中的继承不能以这种方式工作，即派生类型不会自动继承时间戳属性。另一个问题是，由模式产生的事件是所谓的片段，它不受日期时间方法的支持。

好消息是，随着即将发布的 Esper 版本 4.6.0，两个“问题”都将得到修复：[ESPER-659](https://jira.codehaus.org/browse/ESPER-659)和[ESPER-660](https://jira.codehaus.org/browse/ESPER-660)。

# visual-studio-2010 - 我可以安全地重命名我的 Subversion 项目吗？

> ID：10194902
> 
> 赞同：1
> 
> 时间：2012-04-17T16:08:23.653
> 
> 标签：visual-studio-2010, svn, tortoisesvn

我最终遇到了一些 Tortoise 和/或 Subversion 故障，并且不知何故最终得到了同一个项目的多个版本：

```
...\Projects\
    MyProject
    MyProject(1)
    MyProject(2) 
```

MyProject(2) 是“真正”的那个，因此是我想要保留的那个。

我将 MyProject 和 MyProject(1) 剪切并粘贴到“暂存罐”中以供最终删除，因此我现在拥有：

```
...\Projects\
    MyProject(2) 
```

现在我想将名称 MyProject(2) 更改为 MyProject，但我害怕 - Tortoise/Subversion 对一切都非常挑剔（IOW，它按预期工作），我担心如果我更改名称，一切将得到所有冲洗。

我是不是过于偏执了？我应该继续重命名它，还是 Tortoise/SVN 有一些“重构”能力，可以使它成为一个安全的操作，或者......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:21:37.980

您并不是真正的偏执狂，一旦您提交，您将永远拥有该提交，花时间确保您的提交是正确的是值得的。否则，您仍然需要花费相同的时间来执行“修复”提交。

您可能通过 gui 多次“保存”了一组项目，并且“窗口管理器”具有不通过添加`(1)`等方式覆盖文件的选项。如果是这样，很有可能只有一个分支实际上处于修订控制之下。做一个

```
svn status 
```

在几个目录中，以确定这些子目录是否仅被复制到您的系统上，是否已复制并添加到您的系统中，或者是否已复制、添加并提交到存储库。

如果它们只是原地复制，找出哪个“副本”最好，然后将该副本的内容移动到“正确”位置，并删除其他的。然后`svn add`无论什么是必要的并提交。

如果它们已被复制和添加，请发现哪个“副本”是最好的，`svn revert`所有您不打算提交的内容，将“最佳”副本的内容移动到正确的位置，并删除不需要的文件。然后`svn add`无论什么是必要的并提交。

如果它们已被复制、添加和提交，那么`svn delete`“挡道”的东西`svn commit`，，`svn move`正确的东西到它的正确位置，，`svn commit`其他`svn delete`不需要的文件，和`svn commit`.

关于如何解决这个问题还有许多其他变体（有些比我演示的要好得多），但希望上述示例能让您沿着正确的路径思考。我的示例涉及更多步骤，以保持简单。

# javascript - requireJS - 几个问题

> ID：10194903
> 
> 赞同：5
> 
> 时间：2012-04-17T16:08:25.123
> 
> 标签：javascript, module, requirejs

很抱歉有点懒惰，没有自己尝试，但我认为 Stackoverflow 上的一个不错的答案也可能对其他一些人有所帮助。我正在考虑是否要使用`requireJS`来加载我的模块。目前我正在自己做这件事，所以我对requireJS有一些疑问。

*   requireJS 如何处理多个引用（是否缓存文件/模块）？

更准确地说，如果你有调用 like`require(["some/module", "a.js", "b.js"], function...});`并且你再次引用`a.js`or`b.js`在稍后`.require`or`.define`调用中，**requireJS 如何处理这些？我的猜测是，它会完全忽略那些额外的引用，对吗？如果是这样，是否可以强制 requireJS*重新加载*脚本？**

*   requireJS 是否总是通过网络*传输*文件，或者您可以静态加载模块？

我通常做的是连接我所有的 js 文件（包括模块），除了那些需要根据运行时条件加载的文件。据我阅读 requireJS 文档，您可以为模块定义自己的*名称*。所以我的问题是，**你能*加载*一个已经存在于脚本中的模块，而不是通过网络传输它吗？** 据我了解文档，名称是自动为模块创建的，基于它们的路径位置和文件名，所以这对我的要求没有意义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-26T21:20:11.410

`requirejs.undef()`应该做的伎俩

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T17:20:27.007

通常，一个模块只会被 require.js 加载一次。require.js 将始终解决依赖关系并以正确的顺序加载模块，这样您就不必关心这些了。`require`对同一模块的后续调用将立即产生它。

**无法**重新加载模块。如果您确实需要多次加载同一个模块（不幸的是，这表明您的模块设计存在问题），您可以查看[Multiversion 支持。](http://requirejs.org/docs/api.html#multiversion)

我不确定我是否理解“静态加载模块”的意思。但是，如果我猜对了，您想将多个模块作为一个模块加载并单独使用它们。这是可能的：通常在您的模块中，您将执行以下操作：

```
define(['moduleA', 'moduleB', 'moduleC'], function (a, b, c) {
    ...
    return exports;
}); 
```

where`exports`或多或少可以是任何东西，一个函数，一个对象，等等。因此，您还可以执行以下操作：

```
define(['moduleA', 'moduleB', 'moduleC'], function (a, b, c) {
    ...
    return {moduleA: a, moduleB: b, moduleC: c};
}); 
```

一起导出它们。

但是请注意，您*应该*真正了解一下[优化工具](http://requirejs.org/docs/optimization.html)。它可以将相关模块组合在一起。

最后，自动命名是一种误解，您*可以*明确地对模块的名称进行命名。

# asp.net - FoxPro 数据库和 asp.net

> ID：10194904
> 
> 赞同：1
> 
> 时间：2012-04-17T16:08:31.840
> 
> 标签：asp.net, sql-server-2008, data-migration, foxpro

我有一个使用 asp.net 3.5 和 Sql server 2008 作为后端数据存储的网站。现在我们想在我们的网站上添加一个新页面。但是我们想要在此页面中共享的数据已经由 FoxPro 软件创建并保存在我们的一个本地系统中。

我没有 FoxPro 的经验。有什么方法可以在我们的网站上使用这些数据？特别是不必在服务器中创建新数据库并重新导入或写入所有记录？在这种情况下最好的方法是什么？

顺便问一下，是否可以更改 FoxPro 数据库的扩展名？类似 Database.customExt 的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:17:41.770

您可以使用ADO.NET 中的[OLEDB 数据源](http://msdn.microsoft.com/en-us/library/aa977092%28v=vs.71%29.aspx)连接到 FoxPro 数据库。是否需要将数据导入 SQL Server 或直接在 FoxPro 中访问数据取决于您。这将取决于您是否要在查询中将数据与 SQL Server 数据连接起来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T18:31:05.220

除了你已经得到的答案。您可能有兴趣使用[LINQ to VFP](http://linqtovfp.codeplex.com/)或[VFP Entity Framwork Provider](http://vfpefprovider.codeplex.com/)通过使用 LINQ 使数据访问更加容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T16:56:04.543

您可以创建一个链接到此 Foxpro 数据库的服务器。

此外，Foxpro 表可以有任何扩展名。但是，您必须在使用表或数据库时指定扩展名。例如：

```
OPEN DATABASE MyFoxProDatabase.customExt
USE mytable.custonExt 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T17:07:30.260

您有几个选项可用于构建对 FoxPro 的数据访问。您可以将 ADO.NET 数据访问代码放在代码隐藏中，在它自己的 c# 库中，或使用 objectdatasource 进行 2 路绑定。

```
private void LoadData(string parameter)
{
    string sql = "SELECT a.myfield FROM mytable.customExt a WHERE a.whereField=?";
    using(OleDbConnection conn = new OleDbConnection(myConnectionString))
    {
        using (OleDbCommand command = new OleDbCommand(sql, conn))
        {
            command.Parameters.AddWithValue("@Parameter", parameter);

            try
            {
                conn.Open();
                using(OleDbDataReader dr = command.ExecuteReader(CommandBehavior.CloseConnection))
                {
                    myGridView.DataSource = dr;
                    myGridView.DataBind();
                }
            }
            catch (Exception ex)
            {
                throw;
            }
        }
    }
} 
```

这是在 web.config 中使用的示例连接字符串：

```
<add name="myData" connectionString="Provider=VFPOLEDB.1;Data Source=C:\MyFiles\" providerName="System.Data.OleDb"/> 
```

我相信您可以对 FoxPro 表和数据库使用自定义扩展。然后，您的所有 SQL 语句都需要显式使用该扩展。

```
SELECT t.MyField FROM MyTable.customExt t 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-17T20:35:05.453

虽然您可以更改 Visual FoxPro 表的扩展名，但这只会影响 DBF 文件。如果表有任何备注字段，则有一个关联的 FPT 文件，您无法更改其扩展名。同样，如果表有关联的索引文件，则它必须具有 CDX 扩展名。

因此，如果您要更改扩展名的原因是允许多个表具有相同的文件干，请不要。这是一个真正把事情搞砸的好方法。

# sql-server-2008 - 使用 Windows 身份验证从经典 ASP 连接到 SQL Server 数据库

> ID：10194907
> 
> 赞同：2
> 
> 时间：2012-04-17T16:08:39.367
> 
> 标签：sql-server-2008, asp-classic, localhost, windows-authentication

我通常是一名 .NET 开发人员，因此对经典 ASP 没有经验。

客户要求我看看他们的经典 ASP 站点。我正在尝试在我的本地计算机上重新创建他们的站点，以便可以玩，但很难连接到我的数据库副本。该数据库已使用 Windows 身份验证在 SQL Server 2008 上重新创建，但我在连接字符串方面遇到了困难。

这是我到目前为止所拥有的：

```
Provider=SQLOLEDB;Data Source=MY-PC\SQLExpress;Initial Catalog=testdb;Integrated Security=SSPI;Persist Security Info=False; 
```

一直说

> 登录失败。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:39:17.307

将本地站点使用的匿名用户帐户详细信息修改为您自己的登录帐户。

问题是 ASP 脚本总是使用与经过身份验证的连接关联的用户或匿名用户帐户的模拟运行。匿名用户通常是受限制的 IUSR 帐户。

您可以关闭匿名访问并打开 Windows 集成，但我发现它最适合本地开发目的，只是更改匿名用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:14:04.233

您需要在 SQL Server 中为运行应用程序的应用程序池的标识创建一个登录名/用户。

# sql-server-2008 - 跟踪数据库字段更改 - sql server

> ID：10194913
> 
> 赞同：0
> 
> 时间：2012-04-17T16:09:11.317
> 
> 标签：sql-server-2008, entity-framework, c#-4.0

在我的数据库中，我有几列要跟踪其更改。让我们有 A、B 和 C 列。用户和管理员可以更改这些列中的值。如果管理员更改了单元格值（列，行），用户应该无法更改它。

为了解决这个问题，我正在考虑使用字段维护单元格更改的日志表 - 行 ID、列 ID、用户更改。

注意：我使用的是 Sql Server 2008，C#。

请评论我的想法。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:18:22.140

SQL Server 不维护有关谁最后更改列的信息。因此，您需要自己使用 INSTEAD OF 或 AFTER 触发器来跟踪此信息。如果用户尝试更新 A 列和 B 列，但管理员只更新了 A 列，您还需要决定您想要做什么 - 您是要允许用户更新 B 列，还是他们的整个更新失败?

您可以在表中添加一列，指示每列的 ChangedByAdmin：

```
ALTER TABLE dbo.MyTable ADD A_ChangedByAdmin BIT NOT NULL DEFAULT 0;
ALTER TABLE dbo.MyTable ADD B_ChangedByAdmin BIT NOT NULL DEFAULT 0;
ALTER TABLE dbo.MyTable ADD C_ChangedByAdmin BIT NOT NULL DEFAULT 0; 
```

（除非您想保留历史记录，否则使用单独的表似乎过大了。）

现在您可以拥有一个遵循您的规则的 INSTEAD OF 触发器。只是一个粗略的想法：

```
CREATE TRIGGER dbo.Update_MyTable
FOR dbo.MyTable
INSTEAD OF UPDATE
AS
BEGIN
  SET NOCOUNT ON;

  DECLARE @a BIT = CASE USER_NAME() WHEN 'Administrator' THEN 1 ELSE 0 END;

  IF UPDATE(A)
  BEGIN
    UPDATE t
      SET A = i.A, A_ChangedByAdmin = @a
      FROM dbo.MyTable AS t
      INNER JOIN inserted AS i
      ON t.key = i.key
      INNER JOIN deleted AS d
      ON i.key = d.key
      AND i.A <> d.A -- why bother if the value is the same
      WHERE (@a = 1 OR d.A_ChangedByAdmin = 0);
  END
  -- repeat for B and C

  -- then update the unrestricted columns:
  UPDATE t SET D = i.D, E = i.E --, etc.
    FROM dbo.MyTable AS t
    INNER JOIN inserted AS i
    ON t.key = i.key;
END
GO 
```

# javascript - 选择正确的 UI 模板工具 -dust.js？

> ID：10194921
> 
> 赞同：36
> 
> 时间：2012-04-17T16:09:29.787
> 
> 标签：javascript, templates, backbone.js, dust.js

我在一个大型的基于 Java 的 Web 应用程序上工作，它是在过去 5 年左右的时间里建立起来的——UI 需要大修/大量重写。我们正在研究可用的 UI 工具/库/框架来使用，并且发现[dust.js](http://akdubya.github.com/dustjs/)作为模板的一个选项。

**问题：** 我很想听听[dust.js](http://akdubya.github.com/dustjs/)的用户对它的看法：

1.  它成功了吗？
2.  这个容易用吗？
3.  是否有充分的记录？
4.  社区支持好吗？（ST 上只有 6 个问题[标记为“dust.js”](https://stackoverflow.com/questions/tagged/dust.js)！）
5.  [与Underscore](http://documentcloud.github.com/underscore/)的模板、[Google Closure Templates](https://developers.google.com/closure/templates/)、[Handlebars](http://handlebarsjs.com/)和[Mustache](http://mustache.github.com/)等其他模板工具相比，有哪些优缺点。
6.  将它与 MV* 结构框架一起使用是否有任何问题，例如[Backbone.js](http://documentcloud.github.com/backbone/)（[在线书籍](http://addyosmani.github.com/backbone-fundamentals/)）？

**一些背景：**

*   *为什么我们对dust.js感兴趣：*以下[LinkedIn](http://www.linkedin.com/)博客文章首先引起了我们的注意：

    *   [将 JSP 抛诸脑后：将 LinkedIn 移至dust.js 客户端模板](http://engineering.linkedin.com/frontend/leaving-jsps-dust-moving-linkedin-dustjs-client-side-templates)
    *   [客户端模板弃用：mustache、handlebars、dust.js 等](http://engineering.linkedin.com/frontend/client-side-templating-throwdown-mustache-handlebars-dustjs-and-more)

        两篇文章中的第二篇很好地回答了问题 5，但除了 LinkedIn，Google 的结果很少详细说明模板系统或暗示它是一个受欢迎的选择。此外，帖子中提到他们已经扩展了功能，并希望有一天能够为原始项目做出贡献。我担心在他们这样做之前，我们可能还需要扩展功能。

        话虽如此，LinkedIn对模板系统的原始要求与我们的非常接近（见下文），他们在选择之前显然做了一些非常彻底的调查。

*   *我们的要求：*

    1.  [DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)：理想情况下，我们希望在服务器（基于 Java）和客户端使用模板系统，或者如果我们选择 LinkedIn 的完整方法，则仅在客户端使用；*`Instead of using a JSP, GSP, or ERB to assemble a page server side and send back HTML, we have the server send back just the dynamic data as JSON and have the page assembled in the browser using a static client-side template served from a CDN"`*
    2.  完全国际化
    3.  良好的社区支持
    4.  足够容易使用/拿起
    5.  [与jQuery](http://jquery.com/)和[Backbone.js](http://documentcloud.github.com/backbone/)一起愉快地工作
    6.  有据可查

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-17T16:25:14.937

Dust.js 是一个不错的选择。它比其他一些模板框架更好，因为它不限制数据应该在文件中，或者在字符串中等。

它也在积极维护[https://github.com/linkedin/dustjs](https://github.com/linkedin/dustjs)。

1.  它成功了吗？

    是的，我知道至少 LinkedIn 正在使用它，并且还贡献了改进/补丁等。

2.  这个容易用吗？

    我尝试过使用它，它就像 Mustache 或 Handlebars.js 一样简单。

3.  是否有充分的记录？

    是的[http://akdubya.github.com/dustjs](http://akdubya.github.com/dustjs)。

4.  社区支持好吗？（ST 上只有 6 个问题标记为“dust.js”！）

    如果您比较 Mustache 或 Handlebars.js，dust.js 的用户并不多，但我相信如果您有问题并将其发布在 LinkedIn 存储库上，他们肯定会做出回应。我也会，因为我正在看它:-)

5.  与 Underscore 的模板、Google Closure Templates、Handlebars 和 Mustache 等其他模板工具相比，有哪些优缺点。

    至于专业人士，您可以在这里查看何时应该考虑使用dust.js [https://github.com/linkedin/dustjs#readme](https://github.com/linkedin/dustjs#readme)。

    至于缺点，与 Mustache 或 Handlebars.js 等流行的用户相比，dust.js 的用户不足。也就是说，像 Google Closure 这样的其他库也遇到了同样的问题。

    但就像我之前提到的，dust.js 与其他框架恕我直言相比设计得非常好。

6.  将它与 MV* 结构框架一起使用是否有任何问题，例如 Backbone.js（在线书籍）？

    我没有将它与其他 MVC 框架一起使用，但我认为它根本不应该是一个问题。

希望有帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-03T10:09:02.170

1.  我现在正在为一家相当大的成熟的利基 IT 公司做一个自由项目，他们选择了dust.js 作为他们的 HTML5 移动应用程序框架。是的，LinkedIn 是一家成功的大公司。

2.  有点。没什么难的，但我需要习惯它。我在 Java 上使用 Freemarker - 由于许多内置的强大功能，Freemarker 似乎更容易使用。然而，很多人可能会觉得dust.js 不错——它有清晰的逻辑，非常轻量级的语法——dust.js 中有很多东西让很多人真正喜欢。

3.  Freemarker for Java 的文档记录要好得多。dust.js 的 GitHub 页面对于初学者来说非常好，但是，例如，我在那里找不到所有dust.js 过滤器的描述，需要在 Google 上搜索它 - 但是，该搜索很容易为我提供了我的信息需要。

4.  没有看到太多的社区支持，但该库非常轻巧且清晰 - 我只需要几次 Google 搜索就可以收集所有必要的信息。

5.  没有使用其他 JS 模板工具。

6.  我在第一个问题的答案中提到的公司已经使用dust.js 以及jQuery 和Backbone.js 构建了一个轻量级的HTML5 框架。我正在使用该框架为他们做这个项目，并且一直在利用 jQuery 和 Backbone.js 的功能——没有什么可抱怨的。dust.js 有点像 Backbone.js - 轻量级并且不会对您的编码风格或您使用的其他库施加太多限制。使用它，您会看到有一些更可取的 JS 对象形式用于向其提供数据，但它很容易习惯（我的意思是，如果您需要在视图中列出某些内容，最好使用列表来提供dust.js而不是 JS 对象哈希，它同时在描述单独的实体时很自然）。

关于性能的一件事 - 您可以使用“完整”版本开发您的应用程序，然后编译您的模板以用于生产（例如使用 node.js +dust.js npm 模块 - grunt 在这里很有用）以与“核心”版本一起使用. 在这种情况下，您可以大大提高实际性能 - 将所有模板放在一起并缩小它们将使客户端浏览器无需在每次需要时从服务器获取模板。“完整”和“核心”不是关于商业/免费的——核心版本只是没有模板编译器，而是与预编译的模板一起使用。

# iphone - iOS5 BAD_EXCESS 仅在设备上

> ID：10194923
> 
> 赞同：2
> 
> 时间：2012-04-17T16:09:32.097
> 
> 标签：iphone, objective-c, ios, ipad

我正在运行一个后台线程以从 Web 服务获取数据。

要获取创建 URL 所需的设置，我使用此方法：

```
+(Settings *)getSettings
{
    Settings *settings = [[Settings alloc] init];
    NSString *path = [NSString stringWithFormat:@"Documents/Settings"];
    NSString *settingsPath = [NSHomeDirectory() stringByAppendingPathComponent:path];
    NSFileManager *fileMgr = [NSFileManager defaultManager];
    if ([fileMgr fileExistsAtPath:settingsPath]) {
        NSDictionary *settingsDictionary = [NSDictionary dictionaryWithContentsOfFile:settingsPath];
        settings.username = [settingsDictionary objectForKey:@"username"];
        settings.module = [settingsDictionary objectForKey:@"module"];
        settings.websiteUrl = [settingsDictionary objectForKey:@"websiteUrl"];

    }else
    {
        settings.username =  @"";
        settings.module =  @"";
        settings.websiteUrl =  @"";
    }
    NSLog(@"Settings = u:%@ m:%@ w:%@",settings.username,settings.module,settings.websiteUrl);
    return settings;
} 
```

这在调试器中运行良好，但是当我在设备上运行它时，我在 NSLog 或任何尝试使用带有警告的数据的类上得到 BAD_EXCESS：

警告：尝试使用不在框架中的块创建 USE_BLOCK_IN_FRAME 变量。

如果我单步执行代码，这就是代码在设备上可以正常工作。

有任何想法吗？

编辑：回溯-

```
#0  0x37a97eda in objc_retain ()
#1  0x37aa4be4 in objc_retainAutoreleasedReturnValue ()
#2  0x0000f84a in +[SettingData getSettings] (self=0x175e4, _cmd=0x11af9) at /Users/Jono/Dropbox/Uni/iOS5/Feedback At Tees/Feedback At Tees/SettingData.m:49
#3  0x0000fa86 in -[DataManager init] (self=0x3509e0, _cmd=0x30fd9f96) at /Users/Jono/Dropbox/Uni/iOS5/Feedback At Tees/Feedback At Tees/DataManager.m:19
#4  0x00003b46 in __35-[MasterViewController viewDidLoad]_block_invoke_0 (.block_descriptor=0x185f40) at /Users/Jono/Dropbox/Uni/iOS5/Feedback At Tees/Feedback At Tees/MasterViewController.m:70
#5  0x30b08d54 in _dispatch_call_block_and_release ()
#6  0x30b0b896 in _dispatch_worker_thread2 ()
#7  0x37a0e1ce in _pthread_wqthread ()
#8  0x37a0e0a4 in start_wqthread () 
```

我尝试将以下内容添加到设置的 init 方法中，如果我单步执行它是可以的

```
-(id)init
{
    if ((self=[super init]))
    {
        NSString *path = [NSString stringWithFormat:@"Documents/Settings"];
        NSString *settingsPath = [NSHomeDirectory() stringByAppendingPathComponent:path];
        NSFileManager *fileMgr = [NSFileManager defaultManager];
        if ([fileMgr fileExistsAtPath:settingsPath]) 
        {
            NSDictionary *settingsDictionary = [NSDictionary dictionaryWithContentsOfFile:settingsPath];
            self.username = [settingsDictionary objectForKey:@"username"];
            self.module = [settingsDictionary objectForKey:@"module"];
            self.websiteUrl = [settingsDictionary objectForKey:@"websiteUrl"];
            NSLog(@"Settings = u:%@ m:%@ w:%@",self.username,self.module,self.websiteUrl);
        }
        else
        {
            self.username =  @"";
            self.module =  @"";
            self.websiteUrl =  @"";
        }
    }
    NSLog(@"Settings = u:%@ m:%@ w:%@",self.username,self.module,self.websiteUrl);
    return self;
} 
```

截图： http: [//postimage.org/image/4vw6uq7pp/](http://postimage.org/image/4vw6uq7pp/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:38:24.787

首先，方法应该是`retrieveSettings`or`downloadSettings`或，只是，，`settings`但不`getSettings`作为`get`前缀对于方法的论证（通过引用传递）具有非常特殊的含义。

其次，该代码没有明显的错误~~（除了 的泄漏`settings`，但这不会导致这种崩溃）~~。（我看到 ARC 已启用）。

最后，如果您*遇到崩溃*，请**发布 backtrace**。您看到的错误消息（“USE_BLOCK_IN_FRAME”）表明您发布的代码与崩溃无关。

* * *

奇怪的崩溃，那个。好的——警告来自调试器，与实际错误没有任何关系。

范围边界通常是编译器将发出`release`和/或排出自动释放池的位置。

这就引出了下一个问题；怎样

> 如果我单步执行代码，这就是代码在设备上可以正常工作。

好的——所以，当你全速运行时它不起作用，而在逐步运行时它起作用。闻起来像并发崩溃。你能发布实际崩溃的截图吗？即，您确定特定的回溯是崩溃的回溯，而不是调试器在崩溃时发生的位置吗？

（是的，稍微抓住稻草——这种崩溃与所显示的证据无关。我喜欢谜题。）

* * *

好的——现在我们到了某个地方。有点。在 if 的范围内成功记录相同的内容后，它*在if 的范围**外*崩溃。

 *`username`和如何`module`定义`websiteURL`？它们是声明`strong`，还是最恰当的`copy` `@property`声明？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:52:39.053

当我看到`EXC_BAD_ACCESS`我认为是时候使用**NSZombieEnabled**（或仪器中的 Zombies 功能，如果你可以在模拟器上重新生成它的话。

[这个线程](https://stackoverflow.com/questions/2190227/how-do-i-setup-nszombieenabled-in-xcode-4)有关于如何完成任务的说明。*

# objective-c - Objective C委托的头文件

> ID：10194924
> 
> 赞同：2
> 
> 时间：2012-04-17T16:09:36.293
> 
> 标签：objective-c, cocoa

我刚刚完成了用作`NSXMLParser`委托的 Objective C 类。它包含几个应该实现的`parser:`方法，`NSXMLParserDelegate`还有我自己的`parserOutput`属性和一个名为`initWithEncryptedFile:`.

现在，我是否也需要在我的文件中包含这些`parser:`方法？`.h`还是将`NSXMLParserDelegate`的文档中未描述的内容放在那里就足够了？

这样写就够了吗`.h`：

```
#import <Foundation/Foundation.h>

@interface DataFileParser : NSXMLParser <NSXMLParserDelegate>

@property (strong, nonatomic) NSMutableOrderedSet *parserOutput;

- (id) initWithEncryptedFile:(NSString *)path;

@end 
```

或者我应该提到所有`parser:`这样的方法：

```
#import <Foundation/Foundation.h>

@interface DataFileParser : NSXMLParser <NSXMLParserDelegate>

@property (strong, nonatomic) NSMutableOrderedSet *parserOutput;

- (id) initWithEncryptedFile:(NSString *)path;
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict;
- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)elementValue;
- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName;

@end 
```

两个版本都有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:10:55.730

第一个版本很好，因为您声明`DataFileParser`符合该协议。

# jquery - 如何在彩盒图像中添加推文和 Facebook

> ID：10194928
> 
> 赞同：1
> 
> 时间：2012-04-17T16:10:00.223
> 
> 标签：jquery, colorbox

我已经开始使用 Colorbox 插件（[链接在这里](http://www.jacklmoore.com/colorbox)）来创建一个图片库。如演示 4，弹性过渡（[此处链接](http://www.jacklmoore.com/colorbox/example4/)）所示，我想在每个帧的底部为每个图像添加一个 tweet 和 facebook like 按钮。目的是让用户喜欢/发推每张图片，而不是画廊集。这怎么可能？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:25:06.817

对于 Facebook 按钮，[请在此处访问此页面](http://developers.facebook.com/docs/reference/plugins/like/)。您需要添加以实现它的所有代码都在那里提供了很多帮助！:)

就 Twitter 而言，我还没有使用它！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-01T06:58:22.433

我知道已经四年了，但我今天碰巧想这样做！我最终做的是使用回调“cbox_complete”然后将 HTML 注入 DOM（我选择替换 #cboxCurrent 但您可以替换/附加任何内容）。我遇到的问题是推文要求图像在自己的页面上；我不知道如何将图像添加到推文中。Facebook 会显示图像的预览，但仅在第二次单击时才会显示。所以我不确定向 Colorbox 添加共享按钮会有多大用处。

# javascript - 使用 knockoutjs 进行加载绑定？

> ID：10194929
> 
> 赞同：2
> 
> 时间：2012-04-17T16:10:01.823
> 
> 标签：javascript, data-binding, binding, knockout.js

我想在页面加载时执行一个功能，但不知道该怎么做。因为我有一个列表，但他的数据来自加载中的另一个地方。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T02:24:27.523

听起来您正在通过 AJAX 调用刷新页面内容，并且您希望在添加页面加载时进行 AJAX 调用以将其绑定到事件。

假设是这种情况，在 ModelViewModel 声明的末尾，只需调用该函数。例如：

```
function SearchResultsViewModel(){
    this.updateResults=function(){
      //Some AJAX Call and action.   
    }
    this.updateResults();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T16:49:08.597

您将淘汰视图模型正常绑定到视图，然后使用

```
window.onload = function ()
{
     //data from to another place in the load
} 
```

或在 jQuery 中

```
$(document).ready(function(){
     //data from to another place in the load
)}; 
```

由于敲除是绑定到视图的，当你添加项目时，视图会自动更新。

# android - 从使用自定义程序对话框的异步任务更新 TextView

> ID：10194931
> 
> 赞同：5
> 
> 时间：2012-04-17T16:10:05.560
> 
> 标签：android, android-asynctask, textview

在我的一个应用程序中，我有一个需要执行一些后台任务的场景。为此，我正在使用异步任务。我也在使用自定义进度对话框。下面是自定义进度对话框的布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layout_root"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_gravity="center_vertical|center_horizontal"
    android:orientation="vertical" >

    <ProgressBar
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:indeterminateDrawable="@drawable/progressloader" 
        android:layout_gravity="center"/>

    <TextView
        android:id="@+id/progressMessage"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="@color/black"
        android:textSize="18sp"
        android:text="Please wait...." />

</LinearLayout> 
```

一切正常，但是当我尝试将文本设置为 TextView 时，我得到了 java NullPointerException。

异步任务代码

```
private class InitialSetup extends AsyncTask<String, Integer, Long> {

        ProgressDialog dialog = new ProgressDialog(getParent(),R.style.progressdialog);

        @Override
        protected void onPreExecute() {
            dialog.show();
            dialog.setContentView(R.layout.progressbar);

        }

        @Override
        protected Long doInBackground(String... urls) {
                    //    txtView.setText("Testing");    here I am getting the error
            fetchDetails();

            return 0;
        }

        @Override
        protected void onPostExecute(Long result) {

            if (this.dialog.isShowing()) {
                this.dialog.dismiss();
            }

            populateUI(getApplicationContext());
        }
    } 
```

主要活动

```
public class SummaryActivity extends Activity {

final TextView txtView = (TextView)findbyid(R.id.progressMessage);
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.accountsummary);

              new InitialSetup().execute("");

    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-17T18:16:02.087

如果我理解正确，您`TextView`要设置的文本可以在 xml 文件 progressbar.xml （即`R.layout.progressbar`）中找到。这`TextView`可以在设置内容视图后获得（使用`setContentView()`）。在您的代码中，您在此调用之前设置了它，而 mussharapp 的代码，他提前调用了它。即，他在`setContentView(R.layout.accountsummary)`不包含`TextView`. 因此，该变量`txtView`将为 NULL，您将获得一个`NullPointerException`.

你应该做的是：

*   `onPreExecute`在调用之后设置变量 txtView `setContentView`。
*   根据 Paresh Mayani 的[解释](https://stackoverflow.com/a/10196528/1327789)：使用 runOnUiThread 方法。

对于代码，请看下面：

```
private class InitialSetup extends AsyncTask<String, Integer, Long> {

        ProgressDialog dialog = new ProgressDialog(getParent(),R.style.progressdialog);
        // The variable is moved here, we only need it here while displaying the
        // progress dialog.
        TextView txtView;

        @Override
        protected void onPreExecute() {
            dialog.show();
            dialog.setContentView(R.layout.progressbar);
            // Set the variable txtView here, after setContentView on the dialog
            // has been called! use dialog.findViewById().
            txtView = dialog.findViewById(R.id.progressMessage); 
        }

        @Override
        protected Long doInBackground(String... urls) {
            // Already suggested by Paresh Mayani:
            // Use the runOnUiThread method.
            // See his explanation.
            runOnUiThread(new Runnable() {
               @Override
               public void run() {
                  txtView.setText("Testing");       
               }
            });

            fetchDetails();
            return 0;
        }

        @Override
        protected void onPostExecute(Long result) {

            if (this.dialog.isShowing()) {
                this.dialog.dismiss();
            }

            populateUI(getApplicationContext());
        }
    } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-17T18:02:57.550

是的，因为您试图在 doInBackground() 方法中设置 TextView，这是不允许的，

为什么不允许？因为只有一个线程在运行，即 UI 主线程，并且不允许从线程进程更新 UI。在此处阅读更多信息：[无痛穿线](http://developer.android.com/resources/articles/painless-threading.html)

所以有一个解决方案，如果你想在doInBackground()方法里面设置TextView，在runOnUiThread方法里面做UI更新[**操作**](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)。

**否则，**建议在 onPostExecute() 方法中执行所有 UI 显示/更新相关操作，而不是 AsyncTask 类的 doInBackground() 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T16:28:50.620

```
(TextView)findViewByid(R.id.progressMessage); 
```

只能在命令 setContentView() 之后执行。

```
TextView txtView;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.accountsummary);
    **txtView = (TextView)findbyid(R.id.progressMessage);**

    new InitialSetup().execute("");

} 
```

此外，您只能在主 UI 线程中更改 UI 元素。doInBackground() 不在主 UI 线程中。在 onPostExecute 中进行 UI 更改

```
public class InitialSetup extends AsyncTask<String, Integer, Long> {

        private Activity activity;
        ProgressDialog progressDialog;

        public InitialSetup(Activity activity) {
            this.activity = activity;
        }

        @Override
        protected void onPreExecute() {
            progressDialog = new ProgressDialog(activity);
            progressDialog.setMessage("Starting task....");
            progressDialog.show();    
        }

        @Override
        protected Long doInBackground(String... urls) {
            // do something

            //        

            return 0;
        }

        @Override
        protected void onPostExecute(Long result) {
            progressDialog.dismiss();
             //Perform all UI changes here
            **textView.setText("Text#2");**
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-30T11:07:52.543

解释是正确的：除了创建 UI 的线程之外，您不得在任何线程中进行 UI 更改。但是 AsyncTask 有一个方法叫做

```
onProgressUpdate() 
```

它总是会在 UI 线程中运行。因此，根据 dennisg 的修改，您的代码应如下所示：

```
private class InitialSetup extends AsyncTask<String, String, Long> {

    ProgressDialog dialog = new ProgressDialog(getParent(),R.style.progressdialog);
    // The variable is moved here, we only need it here while displaying the
    // progress dialog.
    TextView txtView;

    @Override
    protected void onPreExecute() {
        dialog.show();
        dialog.setContentView(R.layout.progressbar);
        // Set the variable txtView here, after setContentView on the dialog
        // has been called! use dialog.findViewById().
        txtView = dialog.findViewById(R.id.progressMessage); 
    }

    @Override
    protected Long doInBackground(String... urls) {
        publishProgress("Testing");

        fetchDetails();

        return 0;
    }

    @Override
    protected void onPostExecute(Long result) {

        if (this.dialog.isShowing()) {
            this.dialog.dismiss();
        }

        populateUI(getApplicationContext());
    }

    @Override
    protected void onProgressUpdate(String... update) {
        if (update.length > 0)
            txtView.setText(update[0]); 
    }
} 
```

注意onProgressUpdate的参数类型是AsyncTask中给出的第二种类型！

**额外：**为了使您的代码更健壮，您应该在设置文本之前检查进度对话框是否仍然存在。

# xsd - XSD 开头的 DOCTYPE 标头的目的是什么

> ID：10194933
> 
> 赞同：2
> 
> 时间：2012-04-17T16:10:10.223
> 
> 标签：xsd

我发现我在应用程序中使用的 xmldsig-core-schema.xsd 文件有一个标头，该标头在编组器实例化期间导致对 w3.org 的 HTTP 请求，我删除了此标头，现在我想知道它是否可以有任何在验证 XML 文档中的作用。我熟悉在 HTML 或 XML 文档上使用 DOCTYPES，但它在 XSD 文件上的用途是什么？

xsd 位于：http: [//www.w3.org/TR/xmldsig-core/xmldsig-core-schema.xsd](http://www.w3.org/TR/xmldsig-core/xmldsig-core-schema.xsd)

有问题的片段是：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE schema PUBLIC "-//W3C//DTD XMLSchema 200102//EN" "http://www.w3.org/2001/XMLSchema.dtd" [
   <!ATTLIST schema 
     xmlns:ds CDATA #FIXED "http://www.w3.org/2000/09/xmldsig#">
   <!ENTITY dsig 'http://www.w3.org/2000/09/xmldsig#'>
   <!ENTITY % p ''>
   <!ENTITY % s ''>
  ]>
<!-- Schema for XML Signatures ...
-->
<schema... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T20:15:31.387

XSD 文件只是另一个 XML 文件。因此，它的作用与您提到的您熟悉的其他实例相同。

继续阅读，它期望：

*   具有定义的 xmlns:ds 属性的架构元素，具有固定值
*   用户定义的实体 dsig，应替换为[http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)
*   两个参数实体，%p 和 %s，在遇到的地方被替换为空字符串。对于这两个，您必须查看 XMLSchema.dtd，并注意使用 %p 和 %s 实体，将命名空间前缀定义为 xs: in schema document; 在 dsig 案例中，作者更喜欢不使用前缀。

# android - Android 2.3.3 中的拆分视图

> ID：10194935
> 
> 赞同：2
> 
> 时间：2012-04-17T16:10:11.023
> 
> 标签：android, android-layout, android-intent

我正在编写一个 Android 应用程序（我是 Android 新手），它显示了一个项目列表，您可以从中选择并深入选择，直到您最终获得详细视图。现在，如果这是 iOS，我将实现一个 SplitViewController，并将左侧的主控制器作为导航控制器，右侧的细节。如何在 Android 上实现这一点？

我已经设置了一个新布局，`layout-large-land`其中在左侧显示列表并在右侧显示详细信息，但我不确定如何在视图中从一个视图移动`Activity`到另一个视图。这甚至可能吗？我怎么能模拟它？

谢谢。

# sql-server - 从登录日志中获取最新的 IP 地址

> ID：10194938
> 
> 赞同：0
> 
> 时间：2012-04-17T16:10:26.760
> 
> 标签：sql-server, tsql

我在网站上有一个活动日志表。每次登录都有日期/时间、用户 ID 和 IP 地址列。

我想检索唯一用户名列表和他们登录的最新 IP 地址。

在 SQL Server 上使用 t-sql 从表中检索它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:12:26.510

一种可移植的方法是：

```
select l.userID, l.Date, l.IpAddress
from (
    select userID, max(Date) as MaxDate
    from Log
    group by userID
) lm
inner join Log l on lm.userID = l.userID
    and lm.MaxDate = l.Date 
```

如果您有 SQL Server 2005+，您还可以执行以下操作：

```
select * from
(
    select userID, Date, IpAddress,  
        Rank() over (Partition BY userID order by Date DESC) as Rank
    from Log
) tmp
where Rank = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:15:44.933

我在这里猜测一些列/表名，并且我假设用户名来自一个表（并且您不会每次都将用户名存储在日志中）：

```
;WITH x AS
(
  SELECT userID, IPaddress, rn = ROW_NUMBER() OVER
  (PARTITION BY UserID ORDER BY datetimecolumn DESC)
  FROM dbo.LogTable
)
SELECT u.username, x.IPAddress
FROM x INNER JOIN dbo.Users AS u
ON u.userID = x.userID
WHERE x.rn = 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T16:18:32.403

```
select distinct(user_name), (select top 1 IP_address from log_table where user_name=LOG.user_name order by log_date desc)
from log_table LOG 
```

# svn - 在SVN中导入项目的正确方法？

> ID：10194948
> 
> 赞同：2
> 
> 时间：2012-04-17T16:11:07.353
> 
> 标签：svn

我有一个关于如何将项目导入 Subversion 存储库的问题。我通过谷歌搜索找到了很多答案，但我无法理解其背后的逻辑。

我理解的步骤是：

1.  创建一个包含三个子目录的项目目录：branchs、tags 和trunk。

2.  将所有代码放在主干下。

3.  运行命令：

    `svn import project_dir file:///repository_name/project -m "First Import"`

    其中 project_dir 包含三个子目录。

在此之后，我需要再次将我的代码检出到另一个目录：

1.  `svn checkout file:///repository_name/project/trunk new_project_dir`

2.  继续处理 new_project_dir。

在我看来，我们创建 project_dir 只使用一次并忽略它。

我的问题是：

1.  在我将代码签入 new_project_dir 后，旧的 project_dir 是否仍然有用？还是只是简单地给 SVN 布局？

2.  我们是否需要自己处理另外两个子目录：分支和标签（例如检查其中的内容）？还是只是供SVN内部使用？如果是给SVN内部使用，为什么SVN不能自动为我们创建呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T16:24:39.370

如果需要，可以直接在 SVN 中创建布局；在您的问题中使用步骤 3) 会更容易，因为它允许一次性完成。如果您遵循它，则导入后不需要该初始文件夹。事实上，您从中进行导入的文件夹并未置于版本控制之下，因此在那里所做的更改不会将其返回到存储库

至于布局：这是习惯性的，但 SVN 并没有强加限制：您可以按照您想要的方式组织您的项目。传统的逻辑是：

*   `trunk`表示最新的已知工作副本
*   `branches`有表示各种开发工作的子文件夹（可能由不同的人）——例如，用于特定的错误修复。您在不受主干或其他分支更改影响的情况下工作，然后在准备好时将更改合并到主干。
*   标签是主干的标记版本，用于表示主干在特定时间/阶段的状态——这是为了便于定位属于同一版本的内容，例如，而不必记住多个版本号

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:19:20.720

旧的 project_dir 只是为了给 SVN 布局。代码被复制到存储库中，但 SVN 只读取这个目录和文件，而不是接触它们。因此，它不是“工作副本”。

结帐到新位置后，它包含代码和 svn 元数据，这使魔术发生。

AFAIK 主干、标签和分支只是一个命名约定。SVN 不需要它们，您将来可能需要它们。如果您不打算进行分支或标记，则可以将文件直接导入根目录。

# c# - 引入 FOREIGN KEY 约束错误问题

> ID：10194950
> 
> 赞同：1
> 
> 时间：2012-04-17T16:11:17.500
> 
> 标签：c#, ef-code-first, entity-framework-4.3

我对为什么会收到此错误感到有些困惑：

```
Introducing FOREIGN KEY constraint 'FK_QuestionTerms_Terms_TermId' 
on table 'QuestionTerms' may cause cycles or multiple cascade paths. 
Specify ON DELETE NO ACTION or ON UPDATE NO ACTION, or modify other 
FOREIGN KEY constraints. Could not create constraint. See previous errors. 
```

我有一个类问题和一个类术语，问题可能有任意数量的术语与之相关联，而术语可能有任意数量的问题与之相关联。所以我试图在两者之间建立多对多的关系。首先，我尝试使用约定，并允许 EntityFramework 创建数据库。这是问题类

```
public class Question
{
    public Guid Id { get; set; }
    public int QuestionNumber { get; set; }
    public string StatementHtml { get; set; }
    public string AnswerHeaderHtml { get; set; }
    public string NotesHtml { get; set; }
    public Guid CategoryId { get; set; }
    public Guid CourseId { get; set; }
    public Guid QuestionTypeId { get; set; }
    public Guid? SimulationId { get; set; }
    public Guid? SimulationTabId { get; set; }

    public ICollection<Term> Terms { get; set; }
    public ICollection<ReferenceItem> ReferenceItems { get; set; }

} 
```

这是术语类

```
public class Term
{
   public Guid Id { get; set; }
   public string Name { get; set; }
   public string StatementHtml { get; set; }
   public string Authority { get; set; }
   public Guid ProductId { get; set; }

   public Product Product { get; set; }
   public ICollection<Question> Questions { get; set; }
} 
```

我还尝试按如下方式覆盖 OnModelCreating，两个过程结果都是完全相同的错误代码。

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Question>()
        .HasMany(q => q.Terms)
        .WithMany(t => t.Questions)
        .Map(x =>
            {
                x.MapLeftKey("QuestionId");
                x.MapRightKey("TermId");
                x.ToTable("QuestionTerms");
            });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:47:07.453

问题是级联删除会在表之间来回移动。

例如，首先删除术语 A，这将删除问题 1,2 和 3。问题 1 也用于术语 B，因此必须删除术语 B .....

因此，它会阻止您创建此类约束。

这里有一个很好的解决方法：[Entity Framework 4.1 InverseProperty Attribute and ForeignKey](https://stackoverflow.com/questions/5828394/entity-framework-4-1-inverseproperty-attribute-and-foreignkey)

**编辑**

这可能是其他问题的副作用。你应该从一个更简单的模型开始，然后逐渐建立它。

例如：

*   为什么你同时拥有 ProductId 和 product
*   为什么是 CategoryId 而不是 Category ...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T16:40:21.633

尝试将其添加到您的 OnModelCreating() 方法中

```
 modelBuilder.Entity<Question>().HasRequired(oo => oo.Term).WithMany(oo => oo.Questions).WillCascadeOnDelete(false); 
```

# java - 在 AspectJ 中禁用/避免建议执行

> ID：10194951
> 
> 赞同：9
> 
> 时间：2012-04-17T16:11:26.073
> 
> 标签：java, aop, aspectj

假设我有一个方面

```
public aspect Hack {

pointcut authHack(String user, String pass): call(* Authenticator.authenticate(String,String)) && args(user,pass);

boolean around(String user, String pass): authHack(user,pass) {
    out("$$$ " + user + ":" + pass + " $$$");
    return false;
}

} 
```

`Authenticator.authenticate`方法很重要。hack 拦截对此方法的调用。

**是否可以编写第二个方面来取消/禁用`authHack`Hack 方面的建议？**

我可以捕捉到`around authHack`建议的执行，但是如果我想继续身份验证，我需要`Authenticator.authenticate`再次调用，这会创建一个无限循环..

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-19T09:25:31.613

为了模拟您的情况，我编写了以下身份验证器代码：

```
public class Authenticator {

    public boolean authenticate(String user, String pass) {
        System.out.println("User: '" + user + "', pass: '" + pass + "'");
        return true;
    }

} 
```

这是我的主要课程：

```
public class Main {

    public static void main(String[] args) {

        Authenticator authenticator = new Authenticator();

        boolean status = authenticator.authenticate("Yaneeve", "12345");
        System.out.println("Status: '" + status + "'");
    }

} 
```

输出是：

```
User: 'Yaneeve', pass: '12345'
Status: 'true' 
```

我添加了您的 Hack 方面：

```
public aspect Hack {

    pointcut authHack(String user, String pass): call(* Authenticator.authenticate(String,String)) && args(user,pass);

    boolean around(String user, String pass): authHack(user,pass) {
        System.out.println("$$$ " + user + ":" + pass + " $$$");
        return false;
    }
} 
```

现在输出是：

```
$$$ Yaneeve:12345 $$$
Status: 'false' 
```

**现在解决方案：**

我创建了以下 HackTheHack 方面：

```
public aspect HackTheHack {

    declare precedence: "HackTheHack", "Hack";

    pointcut authHack(String user, String pass): call(* Authenticator.authenticate(String,String)) && args(user,pass);

    boolean around(String user, String pass): authHack(user,pass) {
        boolean status = false;
        try {
            Class<?> klass = Class.forName("Authenticator");
            Object newInstance = klass.newInstance();
            Method authMethod = klass.getDeclaredMethod("authenticate", String.class, String.class);
            status = (Boolean) authMethod.invoke(newInstance, user, pass);
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        } catch (SecurityException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        } catch (InstantiationException e) {
            e.printStackTrace();
        }
        return status;
    }
} 
```

输出又是：

```
User: 'Yaneeve', pass: '12345'
Status: 'true' 
```

*这仅在 Hack 方面的原始切入点是“调用”而不是“执行”时才有效，因为执行实际上捕获了反射。*

解释：

我使用 Aspect 优先级在 Hack 之前调用 HackTheHack：

```
declare precedence: "HackTheHack", "Hack"; 
```

然后我使用反射（注意可以并且应该优化以减少方法的重复查找）来简单地调用原始方法，而无需 Hack around 建议。由于两件事，这成为可能：

1.  authHack 切入点：`pointcut authHack(String user, String pass): call(* Authenticator.authenticate(String,String)) && args(user,pass);`使用（在两个方面）`call()`而不是`execution()`
2.  我没有打电话给`proceed()`HackTheHack

我想向您[推荐 Manning 的 AspectJ in Action，第二版](http://www.manning.com/laddad2)，它使我走上了正轨：

> 6.3.1 建议的排序
> 
> 正如您刚刚看到的，由于系统中存在多个方面，不同方面的建议通常可以应用于单个连接点。发生这种情况时，AspectJ 使用以下优先规则来确定应用建议的顺序。稍后，您将看到如何控制优先级：
> 
> 1 具有较高优先级的方面在具有较低优先级的方面之前的连接点上执行其之前的建议。
> 
> 2 具有较高优先级的方面在具有较低优先级的方面之后的连接点上执行其后通知。
> 
> 3 高优先级方面的环绕通知包含低优先级方面的环绕通知。这种安排允许高优先级方面通过控制对proceed()的调用来控制低优先级通知是否将运行。如果高优先级切面没有在其通知正文中调用proceed()，则不仅低优先级切面不会执行，而且建议的连接点也不会执行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-05T10:51:22.860

实际上用户@Yaneeve 提出了一个很好的解决方案，但它有一些缺点，例如

*   仅适用于`call()`，不适用于`execution()`,
*   需要反思，
*   需要`declare precedence`，
*   需要事先知道黑客的类和包名（好的，可以通过使用`*`优先声明来规避）。

我有一个更稳定的解决方案给你。我已将源代码修改为更真实一点：

**身份验证器：**

身份验证器有一个用户数据库（为简单起见硬编码）并实际比较用户和密码。

```
package de.scrum_master.app;

import java.util.HashMap;
import java.util.Map;

public class Authenticator {
    private static final Map<String, String> userDB = new HashMap<>();

    static {
        userDB.put("alice", "aaa");
        userDB.put("bob", "bbb");
        userDB.put("dave", "ddd");
        userDB.put("erin", "eee");
    }

    public boolean authenticate(String user, String pass) {
        return userDB.containsKey(user) && userDB.get(user).equals(pass);
    }
} 
```

**应用：**

该应用程序有一个入口点并尝试验证一些用户，并打印结果：

```
package de.scrum_master.app;

public class Application {
    public static void main(String[] args) {
        Authenticator authenticator = new Authenticator();
        System.out.println("Status: " + authenticator.authenticate("alice",  "aaa"));
        System.out.println("Status: " + authenticator.authenticate("bob",    "xxx"));
        System.out.println("Status: " + authenticator.authenticate("dave",   "ddd"));
        System.out.println("Status: " + authenticator.authenticate("erin",   "xxx"));
        System.out.println("Status: " + authenticator.authenticate("hacker", "xxx"));
    }
} 
```

应用程序的输出如下：

```
Status: true
Status: false
Status: true
Status: false
Status: false 
```

**身份验证记录器方面：**

我想添加一个关于身份验证方法的建议的*法律*方面`around()`，就像稍后的黑客方面一样。

```
package de.scrum_master.aspect;

import de.scrum_master.app.Authenticator;

public aspect AuthenticationLogger {
    pointcut authentication(String user) :
        execution(boolean Authenticator.authenticate(String, String)) && args(user, *);

    boolean around(String user): authentication(user) {
        boolean result = proceed(user);
        System.out.println("[INFO] Authentication result for '" + user + "' = " + result);
        return result;
    }
} 
```

输出变为：

```
[INFO] Authentication result for 'alice' = true
Status: true
[INFO] Authentication result for 'bob' = false
Status: false
[INFO] Authentication result for 'dave' = true
Status: true
[INFO] Authentication result for 'erin' = false
Status: false
[INFO] Authentication result for 'hacker' = false
Status: false 
```

如您所见，只要系统没有被黑客入侵，“状态”和“认证结果”是相同的。这里没有惊喜。

**黑客方面：**

现在让我们破解系统。我们可以始终返回 true（肯定的身份验证结果）或始终为某个用户返回 true - 无论我们喜欢什么。`proceed()`如果我们想获得它的副作用，我们甚至可以返回原始调用，但我们仍然可以始终返回 true，这就是我们在这个示例中所做的：

```
package de.scrum_master.hack;

import de.scrum_master.app.Authenticator;

public aspect Hack {
    declare precedence : *, Hack;
    pointcut authentication() :
        execution(boolean Authenticator.authenticate(String, String));

    boolean around(): authentication() {
        System.out.println("Hack is active!");
        proceed();
        return true;
    }
} 
```

输出变为：

```
Hack is active!
[INFO] Authentication result for 'alice' = true
Status: true
Hack is active!
[INFO] Authentication result for 'bob' = true
Status: true
Hack is active!
[INFO] Authentication result for 'dave' = true
Status: true
Hack is active!
[INFO] Authentication result for 'erin' = true
Status: true
Hack is active!
[INFO] Authentication result for 'hacker' = true
Status: true 
```

因为黑客方面声明自己是通知优先级中的最后一个（即在同一连接点上的一系列嵌套`proceed()`调用中的最内层外壳，它的返回值将通过调用链向上传播到记录器方面，这就是为什么记录器在从内部方面接收到已操作的身份验证结果*后*打印它。

如果我们把声明改成`declare precedence : Hack, *;`输出如下：

```
Hack is active!
[INFO] Authentication result for 'alice' = true
Status: true
Hack is active!
[INFO] Authentication result for 'bob' = false
Status: true
Hack is active!
[INFO] Authentication result for 'dave' = true
Status: true
Hack is active!
[INFO] Authentication result for 'erin' = false
Status: true
Hack is active!
[INFO] Authentication result for 'hacker' = false
Status: true 
```

即记录器现在记录原始结果并将其沿调用链传播到黑客方面，黑客方面可以在最后操纵它，因为它是优先的，因此可以控制整个调用链。拥有最终决定权是黑客通常想要的，但在这种情况下，它会显示记录的内容（一些身份验证为真，一些为假）与应用程序的实际行为方式（始终为真，因为它被黑客入侵）之间的不匹配。

**反黑客方面：**

现在，最后但并非最不重要的一点是，我们要拦截建议执行并确定它们是否可能来自可能的黑客方面。好消息是：AspectJ 有一个称为`adviceexecution()`- nomen est omen 的切入点。:-)

建议执行连接点具有可以通过确定的参数`thisJoinPoint.getArgs()`。不幸的是，AspectJ 无法通过 将它们绑定到参数`args()`。如果截获的通知是`around()`类型的，则第一个`adviceexecution()`参数将是一个`AroundClosure`对象。如果您`run()`在此闭包对象上调用该方法并指定正确的参数（可以通过 确定`getState()`），则效果是不会执行实际的通知主体，而只会隐式`proceed()`调用。这有效地禁用了拦截的建议！

```
package de.scrum_master.aspect;

import org.aspectj.lang.SoftException;
import org.aspectj.runtime.internal.AroundClosure;

public aspect AntiHack {
    pointcut catchHack() :
        adviceexecution() && ! within(AntiHack) && !within(AuthenticationLogger);

    Object around() : catchHack() {
        Object[] adviceArgs = thisJoinPoint.getArgs();
        if (adviceArgs[0] instanceof AroundClosure) {
            AroundClosure aroundClosure = (AroundClosure) adviceArgs[0];
            Object[] closureState = aroundClosure.getState();
            System.out.println("[WARN] Disabling probable authentication hack: " + thisJoinPointStaticPart);
            try {
                return aroundClosure.run(closureState);
            } catch (Throwable t) {
                throw new SoftException(t);
            }
        }
        return proceed();
    }
} 
```

结果输出是：

```
[WARN] Disabling probable authentication hack: adviceexecution(boolean de.scrum_master.hack.Hack.around(AroundClosure))
[INFO] Authentication result for 'alice' = true
Status: true
[WARN] Disabling probable authentication hack: adviceexecution(boolean de.scrum_master.hack.Hack.around(AroundClosure))
[INFO] Authentication result for 'bob' = false
Status: false
[WARN] Disabling probable authentication hack: adviceexecution(boolean de.scrum_master.hack.Hack.around(AroundClosure))
[INFO] Authentication result for 'dave' = true
Status: true
[WARN] Disabling probable authentication hack: adviceexecution(boolean de.scrum_master.hack.Hack.around(AroundClosure))
[INFO] Authentication result for 'erin' = false
Status: false
[WARN] Disabling probable authentication hack: adviceexecution(boolean de.scrum_master.hack.Hack.around(AroundClosure))
[INFO] Authentication result for 'hacker' = false
Status: false 
```

如你看到的，

*   结果现在与没有黑客方面相同，即我们有效地禁用了它，
*   不必知道黑客方面的类或包名称，但在我们的切入点中，我们指定了一个*不应*`catchHack()`禁用的已知方面的白名单，即运行不变，
**   我们只针对建议，`around()`因为建议的签名没有s。`before()``after()``AroundClosure`*

 ***具有目标方法启发式的反黑客建议：**

不幸的是，我发现无法确定周围闭包所针对的方法，因此没有确切的方法将反黑客建议的范围限制为专门针对我们想要防止黑客攻击的方法的建议。在此示例中，我们可以通过启发式检查返回的数组的内容来缩小范围，`AroundClosure.getState()`其中包含

*   通知的目标对象作为第一个参数（我们需要检查它是否是一个`Authenticator`实例），
*   目标方法调用的参数（因为`Authenticator.authenticate()`必须有两个`String`）。

我通过反复试验发现了这些知识是无证的（就像建议执行参数的内容一样）。无论如何，此修改启用启发式：

```
package de.scrum_master.aspect;

import org.aspectj.lang.SoftException;
import org.aspectj.runtime.internal.AroundClosure;

import de.scrum_master.app.Authenticator;

public aspect AntiHack {
    pointcut catchHack() :
        adviceexecution() && ! within(AntiHack) && !within(AuthenticationLogger);

    Object around() : catchHack() {
        Object[] adviceArgs = thisJoinPoint.getArgs();
        if (adviceArgs[0] instanceof AroundClosure) {
            AroundClosure aroundClosure = (AroundClosure) adviceArgs[0];
            Object[] closureState = aroundClosure.getState();
            if (closureState.length == 3
                    && closureState[0] instanceof Authenticator
                    && closureState[1] instanceof String
                    && closureState[2] instanceof String
            ) {
                System.out.println("[WARN] Disabling probable authentication hack: " + thisJoinPointStaticPart);
                try {
                    return aroundClosure.run(closureState);
                } catch (Throwable t) {
                    throw new SoftException(t);
                }
            }
        }
        return proceed();
    }
} 
```

输出与上面相同，但如果在黑客方面甚至多个黑客方面有多个建议，您会看到差异。这个版本正在缩小范围。如果你想要这个取决于你。我建议你使用更简单的版本。在这种情况下，您只需要小心更新切入点以始终拥有最新的白名单。

很抱歉这个冗长的答案，但我发现这个问题很有趣，并试图尽可能好地解释我的解决方案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-18T00:05:01.877

我认为你错过了proceed() 调用。你可能想要的是这样的：

```
public aspect Hack {

    pointcut authHack(String user, String pass): call(* Authenticator.authenticate(String,String)) && args(user,pass);

    boolean around(String user, String pass): authHack(user,pass) {
        out("$$$ " + user + ":" + pass + " $$$");
        boolean result = proceed(user,pass);
        return result;
    }

} 
```*

# php - 反转一个mysql资源

> ID：10194953
> 
> 赞同：1
> 
> 时间：2012-04-17T16:11:33.020
> 
> 标签：php, mysql, resources, reverse

```
//get the messages from the database
$messagesID_query = mysql_query("SELECT
                                   messageID,
                                   posterID,
                                   messageTime,
                                   message
                                 FROM
                                   chat_messages
                                 ORDER BY
                                   messageTime DESC
                                 LIMIT
                                   20"); 
```

上面的 mysql_query 从表中返回最新的 20 个条目。但是，理想情况下，我需要在获取行之前反转资源。

目前，我运行 2 个循环： 1 - 一个用于获取 php 数组中的所有结果 2 - 然后另一个用于处理数组以在反转后打印。

我正在尝试优化它的工作方式...是否可以在我开始获取行之前反转 mysql 资源，这样我就不必反转 php 中的数组？

或者，有没有一种方法可以让我重写查询以以相反的顺序返回所述行..但仍然像上面那样获得最新的 20 个结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T16:14:23.960

这最好在查询中完成。将整个事情包装在一个子查询中，并将其重新排序为升序`messageTime`。这可以节省数据库服务器上相当多的 CPU 资源，而不是循环一堆调用以`mysql_data_seek()`在比 20 更大的行集上向后获取行。

```
SELECT * FROM 
(
  SELECT
    messageID,
    posterID,
    messageTime,
    message
  FROM
  chat_messages
  /* Subquery is used to get the most recent 20 by messageTime */
  ORDER BY messageTime DESC
  LIMIT 20
) subq
/* Reorder the result of the subquery to put them back into ascending order */
ORDER BY messageTime ASC 
```

# .net - 重定向依赖属性

> ID：10194960
> 
> 赞同：0
> 
> 时间：2012-04-17T16:11:56.933
> 
> 标签：.net, wpf, data-binding, dependency-properties

我有`MyForm`一个`UserControlA`在其中我有另一个`UserControlB`。
*UserControlB*有一个（依赖）属性`FooB`。
每次*FooB*更改时，我都需要更改`MyForm.FormTextBox1.Text`.

*我应该如何将FooB*更改“传输”到*MyForm*？

通过*UserControlA*中的另一个 DependencyProperty ？

# c++ - 如何在 Mac OS X 上构建和使用动态库？

> ID：10194961
> 
> 赞同：0
> 
> 时间：2012-04-17T16:12:06.387
> 
> 标签：c++, macos, dynamic, dylib

我有一个非常简单的问题，过去 6 个小时左右我一直在尝试解决这个问题。我想简单地在 Mac OS X 上构建一个动态库，然后使用该库构建一个应用程序。我已经创建了 .dylib 并用它编译了测试应用程序，但是当我运行应用程序时，我得到：

Joes-Mac-Pro：Desktop Joe$ ./test dyld：库未加载：./lib/simple_library.dylib 引用自：/Users/Joe/Desktop/./test 原因：找不到图像 Trace/BPT 陷阱：5

我尝试在可执行目录中创建一个 lib 文件夹并将 dylib 放入其中，同样的错误。我尝试将 dylib 放在可执行路径本身中，同样的错误。我尝试使用 install_name_tool 更改可执行文件中 dylib 的路径，没有任何变化，同样的错误。我尝试使用 -headerpad_max_install_names 构建测试应用程序，然后使用 install_name_tool 更改路径。仍然没有任何变化。同样的错误。

我试图用 Mac 操作系统做的事情是不可能的吗？我是这个平台的新手，并且习惯于在 Windows 和 GNU/Linux 上顺利工作。另外，我正在尝试使用命令行来完成所有这些操作。我非常希望避免使用 XCode。

编辑：哎呀，我发疯了。原来我在 install_name_tool 参数中打错了字。现在工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:23:48.793

install_name_tool 是正确的工具。尝试`otool your_binary`查看缺少哪些 dylib。还要确保您的二进制文件和链接库是为相同的架构构建的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:20:21.810

您需要确保 DYLD_LIBRARY_PATH 包含您的库所在的目录。

```
 DYLD_LIBRARY_PATH
          This is a colon separated list of directories that contain libraries. The dynamic linker searches these directo-
          ries before it searches the default locations for libraries. It allows you to  test  new  versions  of  existing
          libraries.

          For  each library that a program uses, the dynamic linker looks for it in each directory in DYLD_LIBRARY_PATH in
          turn. If it still  can't  find  the  library,  it  then  searches  DYLD_FALLBACK_FRAMEWORK_PATH  and  DYLD_FALL-
          BACK_LIBRARY_PATH in turn.

          Use  the  -L  option to otool(1).  to discover the frameworks and shared libraries that the executable is linked
          against. 
```

dyld 手册页中记录了动态链接的各种细节。

# actionscript-3 - 如何在flex的组合框中设置项目的索引？

> ID：10194962
> 
> 赞同：0
> 
> 时间：2012-04-17T16:12:13.780
> 
> 标签：actionscript-3, apache-flex, air, flash-builder

我想设置数组集合中的项目顺序并与组合框绑定。

这是我的代码

```
[Bindable]private var langList:ArrayCollection = new ArrayCollection([{label:"Englis"},{label:"Urdu"},{label:"Arabic"},{label:"Spanish"}]);

protected function cbm_creationCompleteHandler(event:FlexEvent):void
            {
                for(var i:int =0; i< langList.length; i++)
                {

                    if(langList[i].label == 'Urdu')
                    {
                        cbm.setChildIndex(cbm.getChildAt(i), 0);
                        break;
                    }
                }

            }
<s:ComboBox  id="cbm" x="258" y="113" dataProvider="{langList}" creationComplete="cbm_creationCompleteHandler(event)"/> 
```

当我尝试运行它时，编译器会抛出以下异常

RangeError：错误 #2006：提供的索引超出范围。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:19:23.363

小心，`ComboBox::getChildAt`不会返回列表项，你不应该访问 Flex 组件的子组件，这是一个皮肤问题。

如果要更改元素的顺序，则必须在 dataProvider 中进行，这是数据问题。

```
for(var i:int =0; i< langList.length; i++)
{
    var item:Object = langList[i];
    if(item.label == 'Urdu')
    {
        langList.removeItemAt(i);
        langList.addItemAt(item, 0);
        break;
    }
} 
```

由于您的`langList`is `Bindable`，组合框将自动更新。

# c++ - 如何使用 boost 程序选项获取默认参数值？

> ID：10194963
> 
> 赞同：22
> 
> 时间：2012-04-17T16:12:24.683
> 
> 标签：c++, boost, boost-program-options

我想为我的一些命令行参数使用默认值。我如何知道`program_options`默认选项是什么，如果用户不提供参数，*我如何告诉我的程序使用默认值*？

假设我想要一个参数来指定要发送的机器人数量，默认值为 3。

`robotkill --robots 5`会产生`5 robots have begun the silicon revolution`，而 `robotkill`（没有提供参数）会产生`3 robots have begun the silicon revolution`.

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-17T16:15:17.037

`program_options`当用户不提供这些选项时，自动为选项分配默认值。您甚至不需要检查用户是否提供了给定选项，只需在任何一种情况下使用相同的分配即可。

```
#include <iostream>
#include <boost/program_options.hpp>

namespace po = boost::program_options;

int main  (int argc, char* argv[]) {

  po::options_description desc("Usage");
  desc.add_options()
    ("robots", po::value<int>()->default_value(3), 
     "How many robots do you want to send on a murderous rampage?");

  po::variables_map opts;
  po::store(po::parse_command_line(argc, argv, desc), opts);

  try {
    po::notify(opts);
  } catch (std::exception& e) {
    std::cerr << "Error: " << e.what() << "\n";
    return 1;
  }

  int nRobots = opts["robots"].as<int>(); 
  // automatically assigns default when option not supplied by user!!

  std::cout << nRobots << " robots have begun the silicon revolution" 
        << std::endl;
  return 0;
} 
```

# c# - c#上的斜角或凹陷效果算法

> ID：10194964
> 
> 赞同：4
> 
> 时间：2012-04-17T16:12:26.057
> 
> 标签：c#, algorithm, image-processing, graphics, gdi

我正在寻找为一组随机闭合贝塞尔形状生成斜角/浮雕效果的方法。我遇到了以下似乎符合我要求的帖子。

[https://dsp.stackexchange.com/questions/530/bitmap-alpha-bevel-algorithm](https://dsp.stackexchange.com/questions/530/bitmap-alpha-bevel-algorithm)

我如何将此移植到 C# ？我可以使用任何可用的算法吗？或者是否有任何 .NET 成像库可供使用或一些代码片段让我开始？

我需要在服务器上运行此代码以生成具有透明度的动态形状。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-21T11:20:00.403

1.  从封闭的多边形/折线/路径创建“网格”
    *   底座通过斜角/凹陷宽度扩大了基本形状
    *   上面或下面是你的形状
    *   通过围绕中心缩放基本对称形状来完成放大
    *   或通过垂直移位+线/曲线放大/相交切割加入
    *   第二种选择编码复杂，但形状总是正确的
2.  创建法线
    *   与光源**RED**正常（通常光在左上角）
    *   **和“网格”绿色**上的表面法线（对于每个边缘、区域或像素）
    *   对于方向光（远光源，如太阳光），整个区域的光法线可以是恒定的
    *   或为点光源的每个点计算（关闭光源）
    *   **所有法线都必须是单位 3D 向量！**
3.  用光渲染“网格”（简单的普通照明就足够了）

    ```
    lighted color = base color * dot_product(light normal,surface normal) 
    ```

    *   点积是这样的标量向量乘法

        ```
        (A.B) 
        = dot_product(A(x1,y1,z1),B(x2,y2,z2))
        = (x1*x2)+(y1*y2)+(z1*z2) 
        ```

    *   当 A,B 是单位向量时，结果为 <-1,+1>

    *   0 表示 A,B 垂直
    *   +/- 1 表示它们是平行的
    *   -1 表示方向相反

看图片更清楚

![在此处输入图像描述](../Images/aaa12f3734d8b8efdb77b5a4ccf97559.png)

PS。**“网格”仍然可以是 2D**，只有**法线必须是 3D**

# java - 有没有更快的方法将数据转换为字节，然后再转换回其原始形式？

> ID：10194966
> 
> 赞同：3
> 
> 时间：2012-04-17T16:12:31.397
> 
> 标签：java

我正在使用仅将消息作为字节的队列服务，因此我需要将我的数据快速转换为格式，然后在我从队列接收工作时将其恢复为原始格式。我的数据格式是 INT、DOUBLE 和 INT[]，这就是我最初的做法

```
//to convert to string
String[] message = { Integer.toString(number), String.valueOf(double), Arrays.toString(my_list) };
message.asString;
//to convert back
String message_without_brackets = message.replace("[", "" ).replace("]", "");
String[] temp_message = message_without_brackets.split(","); 

int interger = Integer.valueOf(temp_message[0]);
double double = Double.valueOf(temp_message[1]);
int[] my_list = new int[temp_message.length-2]; //-2 because the first two entries are other data

for (int i = 2; i < temp_message.length; i++) {
    my_list[i-2] = Integer.parseInt(temp_message[i].replace(" ",""));
} 
```

这是超级丑陋的，它让我很恼火，几周后（或一个晚上的大量饮酒）我可能无法很快弄清楚这一点。就性能而言，代码并不算太差，我认为`replace`是代码中最重的部分（如果我记得它大约占整体执行的 15%）。

我四处打听，发现[Gson](http://code.google.com/p/google-gson/)能够做到这一点更清洁，但性能现在超过了我循环的 40%（它的 Gson 本身就是这样做的）：

```
 Gson gson = new Gson();
    int[] sub = { 0, 59, 16 };
    Object[] values = { 0, 43.0, sub };
    String output = gson.toJson(values); // => [0, 43.0,[0,59,16]]

    Object[] deserialized = gson.fromJson(output, Object[].class);
    System.out.println(deserialized[0]);
    System.out.println(deserialized[1]);
    System.out.println(deserialized[2]); 
```

所以我想知道是否有更快的方法来获得相同的结果？我正在尝试这个[问题](https://stackoverflow.com/questions/338586/a-better-java-json-library)中的一些建议，但是有没有更快的方法来做到这一点而不依赖于任何外部库，因为我的需求非常简单（如果不是，那么有没有快速的）？因为有人建议使用 Gson，所以我查看了 Json 解析器，但这是我应该寻找的还是有其他类型的库可以做到这一点？

编辑：我将其转换为字符串，因为我认为我需要这样做才能将其发送为`getBytes()`，是否有任何其他格式可以更快地使用`getBytes()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:26:34.633

您可以使用 DataOutputStream 之类的

```
ByteArrayOutputStream baos = new ByteArrayOutputStream();
DataOutputStream dos = new DataOutputStream(baos);

int i = 0;
double d = 43.0;
int[] sub = { 0, 59, 16 };

dos.writeInt(i);
dos.writeDouble(d);
dos.write(sub.length);
for (int j : sub)
    dos.writeInt(j);

byte[] bytes = baos.toByteArray(); 
```

如果您想变得更极端，您可以使用回收的 ByteBuffers 甚至直接 ByteBuffers 并使用本机字节排序。等等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:40:58.907

你看过番石榴吗？我一直用它来处理字节流

[http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/ByteStreams.html#toByteArray(java.io.InputStream](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/ByteStreams.html#toByteArray(java.io.InputStream) )

该库对于 toByteArray() 来说是值得的

# javascript - jQuery UI 日历显示事件 onLoad

> ID：10194968
> 
> 赞同：0
> 
> 时间：2012-04-17T16:12:35.137
> 
> 标签：javascript, jquery-ui, datepicker

我有一个 jQuery UI DatePicker 日历，`alerts`当单击具有事件的日期时。 [http://jsfiddle.net/helpinspireme/DuwZL/](http://jsfiddle.net/helpinspireme/DuwZL/) 我想添加的是加载中，如果今天有事件，我希望在加载日历时显示警报。任何帮助将不胜感激。谢谢你。

```
var events = [ 
{ Title: "Meeting with boss", Date: new Date("04/13/2012") },
{ Title: "Meeting with manager", Date: new Date("04/13/2012") },
{ Title: "Five K for charity", Date: new Date("04/17/2012") }, 
{ Title: "Dinner", Date: new Date("04/25/2012") }
];

$("div").datepicker({
beforeShowDay: function(date) {
    var result = [true, '', null];
    var matching = $.grep(events, function(event) {
        return event.Date.valueOf() === date.valueOf();
    });

    if (matching.length) {
        result = [true, 'highlight', null];
    }
    return result;
},
onSelect: function(dateText) {
    var date,
        selectedDate = new Date(dateText),
        i = 0,
        event = null;

    while (i < events.length) {
        date = events[i].Date;

        if (selectedDate.valueOf() === date.valueOf()) {
            event = events[i];
            alert(event.Title);
        }
        i++;
    }
}
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:35:45.167

当然，添加这个：

```
$('.ui-datepicker-today').trigger('click'); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/DuwZL/4/)**。

# javascript - 访问/写入 Chrome 应用程序 localStorage

> ID：10194969
> 
> 赞同：0
> 
> 时间：2012-04-17T16:12:40.863
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在为 Chrome 编写一个打包的应用程序。使用后台页面（而不是应用程序的主 HTML 页面）来读取/写入 localStorage 值是否有优势？

目前，用户似乎正在以我无法复制的方式丢失数据。现在，该应用程序在主 HTML 页面的 JavaScript 中读取和写入 localStorage。将应用程序更改为使用后台页面的 JavaScript 可以解决此问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T13:52:51.170

问题可能出在 localStorage 容器的上下文中。从后台脚本运行时，您将保存扩展的 localStorage。从内容脚本运行时，您保存到本地存储是针对该特定网站的。由 google.com 页面上的内容脚本编写的 localStorage.setItem( 'xx', 'yyy' ) 无法被 yahoo.com 上的内容脚本调用 localStore.getItem( 'xx' ) 读取

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T11:45:53.163

无论设置权限如何，LocalStorage 都限制为 5 MB。

当用户检查 chrome://settings/clearBrowserData 上的“删除 cookie 和其他网站和插件数据”时，我相信站点特定和扩展本地存储文件都被删除。也许这就是您的用户“丢失”数据的方式。

使用后台页面读取/写入 localstorage**可以防止**其他扩展程序损坏您的数据，这可能发生在站点域 localstorage 文件中，因为只有您的后台页面可以访问该文件。
虽然其他扩展确实可以调用您的后台页面，但它们仍然必须使用您的保存/加载功能来访问您的扩展本地存储文件。

# php - Symfony 1.4：创建自定义过滤器。具有不同过滤器的外键和重复键（推进）

> ID：10194974
> 
> 赞同：1
> 
> 时间：2012-04-17T16:13:00.083
> 
> 标签：php, symfony-1.4, propel

我有一个表**TableModule**，有 2 个外键，比如说**fk1**和**fk2**。

*   **fk1**到表**1中的****pk1**

***   **fk2**到表**2中的****pk2**** 

 ****我创建了一个模块。假设**Module**，它使用**TableModule**（带有**fk's 的**那个）

我想为这些**fk**创建 4 个过滤器：2 个输入文本和 2 个下拉菜单。特别是，我想为**每个 fk创建****两个**过滤器。这是：

 **```
For fk1 I would get:
  -InputText
  -Dropdown (choice in propel) 
For fk2 I would get:
  -InputText
  -Dropdown (choice in propel) 
```

当然，这将显示**Table1**和**Table2**的结果。

现在，在我的**config.yml**中，我得到了：

```
 ...
    filter:
      display: [fk1, fk1TextFilter, fk2, fk2TextFilter]
    ... 
```

这是：**fk1**和**fk2**将作为下拉列表过滤，必须自定义部分 fk1TextFilter 和 fk2TextFilter 以使用文本*输入* **进行**过滤**。**

为什么我创建了这些*部分*？因为**我不能复制 config.yml 中的 fk ！！**

在`lib/filter/table1/ModuleFormFilter`我做了（注意在**table1**中）：

```
 public function configure()
 {
  $this->setWidgets(array(
  'fk1'                => new sfWidgetFormPropelChoice(array('model' => 'table1',  'add_empty' => true,)),
  'fk1TextFilter'      => new sfWidgetFormInput(),
  'fk2'                => new sfWidgetFormPropelChoice(array('model' => 'table2',  'add_empty' => true,)),
  'fk2TextFilter'      => new sfWidgetFormInput(),
  ));

$this->setValidators(array(
  'fk1TextFilter'      => new sfValidatorPropelChoice(array('model' => 'table1', 'column' => 'id', 'required' => false)),
  'fk1'                => new sfValidatorPropelChoice(array('model' => 'table1', 'column' => 'id', 'required' => false)),
  'fk2TextFilter'      => new sfValidatorPropelChoice(array('model' => 'table2', 'column' => 'id', 'required' => false)),
  'fk2'                => new sfValidatorPropelChoice(array('model' => 'table2', 'column' => 'id', 'required' => false)),
));

$this->validatorSchema->setPostValidator(
  new sfValidatorPropelUnique(array('model' => 'table2', 'column' => array('fk2')))
);

$this->widgetSchema->setNameFormat('model[%s]');

$this->errorSchema = new sfValidatorErrorSchema($this->validatorSchema); 
```

}

这是：如前所述，创建了 2 个 textInput 和 2 个下拉菜单。

如果我使用 - 可能是输入文本或下拉列表 - 只是**fk**这将正常工作。问题是**我无法复制 fk 的**. 我不能这样做：

```
 $this->setWidgets(array(
  'fk1'   => new sfWidgetFormPropelChoice(array('model' => 'table1',  'add_empty' => true,)),
  'fk1'   => new sfWidgetFormInput(),
  'fk2'   => new sfWidgetFormPropelChoice(array('model' => 'table2',  'add_empty' => true,)),
  'fk2'   => new sfWidgetFormInput(),
  )); 
```

如果我运行我得到的页面：

```
You must define a "filterByfk1TextFilter" method in the ModelQuery class to be able to filter with the "fk1TextFilter" field. 
```

我找到了一些链接（[1](https://stackoverflow.com/questions/5461703/symfony-admin-filter-with-join)、[2](https://stackoverflow.com/questions/8502824/symfony-filter-not-working)），但对我不起作用。我在 symfony 文档中没有具体的例子。

**我必须创建什么以及如何创建？**

到目前为止，我有同样的`lib/filter/table1/ModuleFormFilter`：

```
 public function getFields()
 {
  $fields = parent::getFields();
  $fields['fk1TextFilter'] = 'fk1TextFilter';
  $fields['fk2TextFilter'] = 'fk2TextFilter';
  return $fields;
 }

public function addModelfk1TextFilterQuery($query, $field, $value)
{
 //add your filter query!
 //for example in your case
 $rootAlias = $query->getRootAlias();
 $query =  ModelQuery::create()
  ->filterByfk1TextFilter()
  ->find();

 //remember to return the $query!
 return $query;
} 
```

不适合我。请问你能帮帮我吗？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T06:13:40.013

对于那些使用 Doctrine 的人，这是我的“用户配置文件”模型上的一个简单扩展，允许通过 sfDoctrineGuardPlugin 中的 sfGuardUser 模型上的字段进行过滤。

我的“个人资料”类被称为成员，并通过 user_id 列通过用户关系引用 sfGuardUser。

希望有人觉得它有用！

```
class MemberFormFilter extends BaseMemberFormFilter {

  public function configure() {
    $this->setWidget('first_name', new sfWidgetFormInputText());
    $this->setWidget('last_name', new sfWidgetFormInputText());
    $this->setWidget('email_address', new sfWidgetFormInputText());

    $this->setValidator('first_name', new sfValidatorString(array('required' => false)));
    $this->setValidator('last_name', new sfValidatorString(array('required' => false)));
    $this->setValidator('email_address', new sfValidatorString(array('required' => false)));
  }

  public function getFields() {
    return array_merge(parent::getFields(), array(
      'first_name' => 'Text',
      'last_name' => 'Text',
      'email_address' => 'Text'
    ));
  }

  public function addFirstNameColumnQuery(Doctrine_Query $query, $field, $value) {
    $rootAlias = $query->getRootAlias();
    return $query->leftJoin($rootAlias.'.User u')
      ->where('u.first_name LIKE ?', "%$value%");
  }

  public function addLastNameColumnQuery(Doctrine_Query $query, $field, $value) {
    $rootAlias = $query->getRootAlias();
    return $query->leftJoin($rootAlias.'.User u')
      ->where('u.last_name LIKE ?', "%$value%");
  }

  public function addEmailAddressColumnQuery(Doctrine_Query $query, $field, $value) {
    $rootAlias = $query->getRootAlias();
    return $query->leftJoin($rootAlias.'.User u')
      ->where('u.email_address LIKE ?', "%$value%");
  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T14:37:50.737

黑魔法：

有很多不同的方法。没有一个对我有用，至少我发布的链接中的那些。

不过，使用：**add[VirtualColumnName]ColumnCriteria**允许您自定义过滤器。

在这种情况下，在我编写的所有代码之后（并更改**addModelfk1TextFilterQuery()**）只需添加：

```
public function addfk1TextFilterColumnCriteria($query, $field, $value)
{
  //Here just put a query in propel, for ex:

  $query = $query->useTableModel()
                 ->filterByName("*$value*")
               ->endUse()
               ->find();
 return $query;
} 
```

希望这对其他人有所帮助！

**迷你编辑**：做一些**回应**和澄清`$field``$values`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-09T21:23:21.850

我认为将**addWhere**而不是**where**放在每个“addXColumnQuery 函数上会更好，因为这种方式将保留和组合其他过滤器集。******

# python - 如何向 Celery (celerybeat) 动态添加/删除周期性任务

> ID：10194975
> 
> 赞同：54
> 
> 时间：2012-04-17T16:13:04.317
> 
> 标签：python, celery, celerybeat

如果我有一个定义如下的函数：

```
def add(x,y):
  return x+y 
```

有没有办法将此函数动态添加为 celery PeriodicTask 并在运行时启动它？我希望能够做类似（伪代码）的事情：

```
some_unique_task_id = celery.beat.schedule_task(add, run_every=crontab(minute="*/30"))
celery.beat.start(some_unique_task_id) 
```

我还想使用（伪代码）之类的东西动态停止或删除该任务：

```
celery.beat.remove_task(some_unique_task_id) 
```

或者

```
celery.beat.stop(some_unique_task_id) 
```

仅供参考，我没有使用 djcelery，它可以让您通过 django 管理员管理定期任务。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-07-08T10:55:52.077

这个问题在[google groups](https://groups.google.com/forum/#!msg/celery-users/CZXCh8sCK5Q/ihZgMV2HWWYJ)上得到了回答。

我不是作者，所有功劳归功于让·马克

> 这是一个适当的解决方案。确认工作，在我的场景中，我将定期任务分类并从中创建一个模型，因为我可以根据需要向模型添加其他字段，也可以添加“终止”方法。您必须将定期任务的启用属性设置为 False 并在删除之前将其保存。整个子类化不是必须的， schedule_every 方法才是真正起作用的方法。当您准备好终止您的任务时（如果您没有将其子类化），您可以使用 PeriodicTask.objects.filter(name=...) 来搜索您的任务，禁用它，然后删除它。
> 
> 希望这可以帮助！
> 
> ```
> from djcelery.models import PeriodicTask, IntervalSchedule
> from datetime import datetime
> 
> class TaskScheduler(models.Model):
> 
>     periodic_task = models.ForeignKey(PeriodicTask)
> 
>     @staticmethod
>     def schedule_every(task_name, period, every, args=None, kwargs=None):
>     """ schedules a task by name every "every" "period". So an example call would be:
>          TaskScheduler('mycustomtask', 'seconds', 30, [1,2,3]) 
>          that would schedule your custom task to run every 30 seconds with the arguments 1,2 and 3 passed to the actual task. 
>     """
>         permissible_periods = ['days', 'hours', 'minutes', 'seconds']
>         if period not in permissible_periods:
>             raise Exception('Invalid period specified')
>         # create the periodic task and the interval
>         ptask_name = "%s_%s" % (task_name, datetime.datetime.now()) # create some name for the period task
>         interval_schedules = IntervalSchedule.objects.filter(period=period, every=every)
>         if interval_schedules: # just check if interval schedules exist like that already and reuse em
>             interval_schedule = interval_schedules[0]
>         else: # create a brand new interval schedule
>             interval_schedule = IntervalSchedule()
>             interval_schedule.every = every # should check to make sure this is a positive int
>             interval_schedule.period = period 
>             interval_schedule.save()
>         ptask = PeriodicTask(name=ptask_name, task=task_name, interval=interval_schedule)
>         if args:
>             ptask.args = args
>         if kwargs:
>             ptask.kwargs = kwargs
>         ptask.save()
>         return TaskScheduler.objects.create(periodic_task=ptask)
> 
>     def stop(self):
>         """pauses the task"""
>         ptask = self.periodic_task
>         ptask.enabled = False
>         ptask.save()
> 
>     def start(self):
>         """starts the task"""
>         ptask = self.periodic_task
>         ptask.enabled = True
>         ptask.save()
> 
>     def terminate(self):
>         self.stop()
>         ptask = self.periodic_task
>         self.delete()
>         ptask.delete() 
> ```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2019-04-10T00:36:19.337

celery v4.1.0 中包含[的修复程序](https://github.com/celery/celery/pull/3958)最终使这成为可能。现在，您只需要更改数据库后端中的日程表条目，celery-beat 就会根据新的日程表进行操作。

文档[模糊地描述](https://docs.celeryproject.org/en/latest/userguide/periodic-tasks.html#starting-the-scheduler)了这是如何工作的。celery-beat 的默认调度程序`PersistentScheduler`使用[搁置文件](https://docs.python.org/dev/library/shelve.html#module-shelve)作为其调度数据库。`beat_schedule`实例中字典的任何更改`PersistentScheduler`都会与此数据库同步（默认情况下，每 3 分钟一次），反之亦然。文档描述[了如何向 using 中添加](https://docs.celeryproject.org/en/latest/userguide/periodic-tasks.html#entries)新`beat_schedule`条目`app.add_periodic_task`。要修改现有条目，只需添加一个具有相同`name`. 像从字典中一样删除条目：`del app.conf.beat_schedule['name']`.

假设您想使用外部应用程序监控和修改您的 celery beat 时间表。然后你有几个选择：

1.  您可以`open`搁置数据库文件并像字典一样读取其内容。写回这个文件进行修改。
2.  您可以运行 Celery 应用程序的另一个实例，并使用该实例来修改搁置文件，如上所述。
3.  您可以[使用 django-celery-beat](http://docs.celeryproject.org/en/latest/userguide/periodic-tasks.html#using-custom-scheduler-classes)中的自定义调度程序类将调度存储在 django 管理的数据库中，并访问那里的条目。
4.  您可以使用[celerybeat-mongo](https://github.com/zmap/celerybeat-mongo)中的调度程序将调度存储在 MongoDB 后端，并访问那里的条目。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-04-19T10:00:53.870

不，对不起，常规的 celerybeat 无法做到这一点。

但它很容易扩展，做你想做的事，例如 django-celery 调度器只是一个子类，读取和写入数据库的调度（顶部有一些优化）。

即使是非 Django 项目，您也可以使用 django-celery 调度程序。

像这样的东西：

*   安装 django + django-celery：

    $ pip install -U django django-celery

*   将以下设置添加到您的 celeryconfig 中：

    ```
    DATABASES = {
        'default': {
            'NAME': 'celerybeat.db',
            'ENGINE': 'django.db.backends.sqlite3',
        },
    }
    INSTALLED_APPS = ('djcelery', ) 
    ```

*   创建数据库表：

    ```
    $ PYTHONPATH=. django-admin.py syncdb --settings=celeryconfig 
    ```

*   使用数据库调度程序启动 celerybeat：

    ```
    $ PYTHONPATH=. django-admin.py celerybeat --settings=celeryconfig \
        -S djcelery.schedulers.DatabaseScheduler 
    ```

还有一个`djcelerymon`命令可用于非 Django 项目在同一进程中启动 celerycam 和 Django Admin 网络服务器，您还可以使用它在一个漂亮的网络界面中编辑您的定期任务：

```
 $ djcelerymon 
```

（注意由于某些原因 djcelerymon 不能使用 Ctrl+C 停止，你必须使用 Ctrl+Z + kill %1）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-05-03T06:15:58.333

有一个名为 django-celery-beat 的库，它提供了人们需要的模型。要使其动态加载新的周期性任务，必须创建自己的调度程序。

```
from django_celery_beat.schedulers import DatabaseScheduler

class AutoUpdateScheduler(DatabaseScheduler):

    def tick(self, *args, **kwargs):
        if self.schedule_changed():
            print('resetting heap')
            self.sync()
            self._heap = None
            new_schedule = self.all_as_schedule()

            if new_schedule:
                to_add = new_schedule.keys() - self.schedule.keys()
                to_remove = self.schedule.keys() - new_schedule.keys()
                for key in to_add:
                    self.schedule[key] = new_schedule[key]
                for key in to_remove:
                    del self.schedule[key]

        super(AutoUpdateScheduler, self).tick(*args, **kwargs)

    @property
    def schedule(self):
        if not self._initial_read and not self._schedule:
            self._initial_read = True
            self._schedule = self.all_as_schedule()

        return self._schedule 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-11-16T20:41:37.727

您可以查看这个[flask-djcelery](https://github.com/waqasjaved160/flask-djcelery)，它配置了 flask 和 djcelery，还提供了可浏览的 rest api

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-08-20T07:32:58.600

@asksol 的答案是在 Django 应用程序中需要什么。

对于非 django 应用程序，您可以使用类似于[Django 的 django-celery-beat](https://github.com/celery/django-celery-beat)`celery-sqlalchemy-scheduler`建模，因为它也使用 database 而不是 file 。`celerybeat-schedule`

*   [https://pypi.org/project/celery-sqlalchemy-scheduler/](https://pypi.org/project/celery-sqlalchemy-scheduler/)
*   [https://github.com/AngelLiang/celery-sqlalchemy-scheduler](https://github.com/AngelLiang/celery-sqlalchemy-scheduler)

这是一个运行时添加新任务的示例。

**任务.py**

```
from celery import Celery

celery = Celery('tasks')

beat_dburi = 'sqlite:///schedule.db'

celery.conf.update(
    {'beat_dburi': beat_dburi}
)

@celery.task
def my_task(arg1, arg2, be_careful):
    print(f"{arg1} {arg2} be_careful {be_careful}") 
```

**日志（生产者）**

```
$ celery --app=tasks beat --scheduler=celery_sqlalchemy_scheduler.schedulers:DatabaseScheduler --loglevel=INFO
celery beat v5.1.2 (sun-harmonics) is starting.
[2021-08-20 15:20:20,927: INFO/MainProcess] beat: Starting... 
```

**日志（消费者）**

```
$ celery --app=tasks worker --queues=celery --loglevel=INFO
-------------- celery@ubuntu20 v5.1.2 (sun-harmonics)
[2021-08-20 15:20:02,287: INFO/MainProcess] Connected to amqp://guest:**@127.0.0.1:5672// 
```

**数据库计划**

```
$ sqlite3 schedule.db 
sqlite> .databases
main: /home/nponcian/Documents/Program/1/db/schedule.db
sqlite> .tables
celery_crontab_schedule       celery_periodic_task_changed
celery_interval_schedule      celery_solar_schedule       
celery_periodic_task        
sqlite> select * from celery_periodic_task;
1|celery.backend_cleanup|celery.backend_cleanup||1||[]|{}|||||2021-08-20 19:20:20.955246|0||1||0|2021-08-20 07:20:20| 
```

现在，当这些工作人员已经在运行时，让我们通过添加一个新的计划任务来更新计划。请注意，这是在运行时，无需重新启动工作人员。

```
$ python3
>>> # Setup the session.
>>> from celery_sqlalchemy_scheduler.models import PeriodicTask, IntervalSchedule
>>> from celery_sqlalchemy_scheduler.session import SessionManager
>>> from tasks import beat_dburi
>>> session_manager = SessionManager()
>>> engine, Session = session_manager.create_session(beat_dburi)
>>> session = Session()
>>> 
>>> # Setup the schedule (executes every 10 seconds).
>>> schedule = session.query(IntervalSchedule).filter_by(every=10, period=IntervalSchedule.SECONDS).first()
>>> if not schedule:
...     schedule = IntervalSchedule(every=10, period=IntervalSchedule.SECONDS)
...     session.add(schedule)
...     session.commit()
... 
>>> 
>>> # Create the periodic task
>>> import json
>>> periodic_task = PeriodicTask(
...     interval=schedule,                  # we created this above.
...     name='My task',                     # simply describes this periodic task.
...     task='tasks.my_task',               # name of task.
...     args=json.dumps(['arg1', 'arg2']),
...     kwargs=json.dumps({
...        'be_careful': True,
...     }),
... )
>>> session.add(periodic_task)
>>> session.commit() 
```

**数据库计划（更新）**

*   我们现在可以看到，新添加的时间表已反映到由 celery beat 调度程序持续读取的数据库中。因此，如果 args 或 kwargs 的值有任何更新，我们可以轻松地对数据库执行 SQL 更新，并且它应该与正在运行的工作人员实时反映（无需重新启动）。

```
sqlite> select * from celery_periodic_task;
1|celery.backend_cleanup|celery.backend_cleanup||1||[]|{}|||||2021-08-20 19:20:20.955246|0||1||0|2021-08-20 07:20:20|
2|My task|tasks.my_task|1|||["arg1", "arg2"]|{"be_careful": true}||||||0||1||0|2021-08-20 07:26:49| 
```

**日志（生产者）**

*   现在，新任务每 10 秒排队一次

```
[2021-08-20 15:26:51,768: INFO/MainProcess] DatabaseScheduler: Schedule changed.
[2021-08-20 15:26:51,768: INFO/MainProcess] Writing entries...
[2021-08-20 15:27:01,789: INFO/MainProcess] Scheduler: Sending due task My task (tasks.my_task)
[2021-08-20 15:27:11,776: INFO/MainProcess] Scheduler: Sending due task My task (tasks.my_task)
[2021-08-20 15:27:21,791: INFO/MainProcess] Scheduler: Sending due task My task (tasks.my_task) 
```

**日志（消费者）**

*   新添加的任务每 10 秒按时正确执行一次

```
[2021-08-20 15:27:01,797: INFO/MainProcess] Task tasks.my_task[04dcb40c-0a77-437b-a129-57eb52850a51] received
[2021-08-20 15:27:01,798: WARNING/ForkPoolWorker-4] arg1 arg2 be_careful True
[2021-08-20 15:27:01,799: WARNING/ForkPoolWorker-4] 

[2021-08-20 15:27:01,799: INFO/ForkPoolWorker-4] Task tasks.my_task[04dcb40c-0a77-437b-a129-57eb52850a51] succeeded in 0.000763321000704309s: None
[2021-08-20 15:27:11,783: INFO/MainProcess] Task tasks.my_task[e8370a6b-085f-4bd5-b7ad-8f85f4b61908] received
[2021-08-20 15:27:11,786: WARNING/ForkPoolWorker-4] arg1 arg2 be_careful True
[2021-08-20 15:27:11,786: WARNING/ForkPoolWorker-4] 

[2021-08-20 15:27:11,787: INFO/ForkPoolWorker-4] Task tasks.my_task[e8370a6b-085f-4bd5-b7ad-8f85f4b61908] succeeded in 0.0006725780003762338s: None
[2021-08-20 15:27:21,797: INFO/MainProcess] Task tasks.my_task[c14d875d-7f6c-45c2-a76b-4e9483273185] received
[2021-08-20 15:27:21,799: WARNING/ForkPoolWorker-4] arg1 arg2 be_careful True
[2021-08-20 15:27:21,799: WARNING/ForkPoolWorker-4] 

[2021-08-20 15:27:21,800: INFO/ForkPoolWorker-4] Task tasks.my_task[c14d875d-7f6c-45c2-a76b-4e9483273185] succeeded in 0.0006371149993356084s: None 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-03-09T05:25:25.823

我一直在为 Celery + Redis 寻找可以灵活添加/删除的相同解决方案。看看这个[redbeat](https://github.com/sibson/redbeat)，来自 Heroku 的同一个人，甚至他们也使用了 Redis + Sentinel。

希望有帮助:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-20T06:21:00.823

Celery 可以通过数据库和自身调用实现动态周期性任务。

但是 APSchule 更好。

因为动态周期性任务总是意味着长倒计时或 eta。太多这些周期性任务会占用大量内存，使得重新启动和执行非延迟任务非常耗时。

任务.py

```
import sqlite3
from celery import Celery
from celery.utils.log import get_task_logger

logger = get_task_logger(__name__)

app = Celery(
    'tasks',
    broker='redis://localhost:6379/0',
    backend='redis://localhost:6379/1',
    imports=['tasks'],
)

conn = sqlite3.connect('database.db', check_same_thread=False)
c = conn.cursor()
sql = '''
CREATE TABLE IF NOT EXISTS `tasks` 
(
   `id` INTEGER UNIQUE PRIMARY KEY AUTOINCREMENT,
   `name` TEXT,
   `countdown` INTEGER
);
'''
c.execute(sql)

def create(name='job', countdown=5):
    sql = 'INSERT INTO `tasks` (`name`, `countdown`) VALUES (?, ?)'
    c.execute(sql, (name, countdown))
    conn.commit()
    return c.lastrowid

def read(id=None, verbose=False):
    sql = 'SELECT * FROM `tasks` '
    if id:
        sql = 'SELECT * FROM `tasks` WHERE `id`={}'.format(id)
    all_rows = c.execute(sql).fetchall()
    if verbose:
        print(all_rows)
    return all_rows

def update(id, countdown):
    sql = 'UPDATE `tasks` SET `countdown`=? WHERE `id`=?'
    c.execute(sql, (countdown, id))
    conn.commit()

def delete(id, verbose=False):
    sql = 'DELETE FROM `tasks` WHERE `id`=?'
    affected_rows = c.execute(sql, (id,)).rowcount
    if verbose:
        print('deleted {} rows'.format(affected_rows))
    conn.commit()

@app.task
def job(id):
    id = read(id)
    if id:
        id, name, countdown = id[0]
    else:
        logger.info('stop')
        return

    logger.warning('id={}'.format(id))
    logger.warning('name={}'.format(name))
    logger.warning('countdown={}'.format(countdown))

    job.apply_async(args=(id,), countdown=countdown) 
```

主文件

```
from tasks import *

id = create(name='job', countdown=5)
job(id)
# job.apply_async((id,), countdown=5)  # wait 5s

print(read())

input('enter to update')
update(id, countdown=1)

input('enter to delete')
delete(id, verbose=True) 
```

# search - 递增和递减数字

> ID：10194978
> 
> 赞同：2
> 
> 时间：2012-04-17T16:13:08.880
> 
> 标签：search, vim, numbers, increment, decrement

我有这个带数字的文本：

```
My numbers are 04, and 0005
My numbers are 05, and 0006
My numbers are 06, and 0035
My numbers are 07, and 0007
My numbers are 08, and 0009 
```

这是我一直用来增加或减少选择/块选择/列中数字的代码： pe 将上述文本中的最后 4 个数字增加 8：

```
 '<,'>s/\%V\<\d\{4}\>/\=submatch(0)+8/g 
```

但我今天注意到它做了一些奇怪的事情。这是输出：

```
My numbers are 04, and 13
My numbers are 05, and 14
My numbers are 06, and 37 <---
My numbers are 07, and 15
My numbers are 08, and 17 
```

*   它删除了前导零（如果有前导零，我想保留它们，如果没有前导零，我想不添加它们）
*   除了 37 之外的所有数字都加了 8，它加了 2。（为什么？）

谁能帮我***找到一个正则表达式来从选择（或块选择）中添加/减去数字而不会丢失前导零***？

注意：
我注意到 Control A + Control x 保留前导零并按照我的意愿进行工作，但是：
- 我已经看到它不能用于替代命令 ('<,'>s/)
- 我不知道如何将 pe 200 添加到数字列表中（200 x ？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T16:36:38.590

前导零生成数字`8-based`。

```
(0035)8 == (29)10 
```

你可以在 vim 中测试：

```
:echo 0035 == 29 
```

它会打印`1`（真）。

* * *

尝试这个：

```
:%s/\(\<[0-9]\{4}\>\)\@=0*\([0-9]*\)/\=submatch(2)+8/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T16:52:02.710

这个？

```
:%s/\v[0-9]{4}/\=printf("%04d", substitute(submatch(0), '^0\+', '', 0)+8)/ 
```

**编辑**

@Remonn，您应该在问题中提供正确的示例输入。上面的行适用于您的示例。

对于您的新要求，请查看以下行：

输入：

```
40
20
120
0500
230
0000000020
00000000000005000 
```

vim命令：

```
:%!awk '{if($0~/^0/){f="\%"length($0)"d";$0+=8; s=sprintf(f,$0); gsub(/ /,"0",s);}else s=$0+8;print s}' 
```

将文件更改为：

```
48
28
128
0508
238
0000000028
00000000000005008 
```

在我的 cmd 中，我使用了 '%'，您可以选择 (v) 您想要使用的数字，然后尝试使用我的 cmd。

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T04:59:27.337

默认情况下，Vim`0`将以八进制开头的数字处理。

出于这个原因，我的 .vimrc 中有这个：

```
set   nrformats-=octal  " Don't bother with octal, I never use it 
```

# magento - 如何在 Magento 中创建自定义注册表单和审批流程？

> ID：10194980
> 
> 赞同：0
> 
> 时间：2012-04-17T16:13:15.620
> 
> 标签：magento

我们正在建立一个新的 Magento 网站，让服装设计师能够在我们的商店中销售他们的产品。我们已经为设计师创建了一个具有适当权限的单独用户组。但是，我们需要创建一个供他们使用的自定义注册表单，以及一个随附的审批工作流程。有人可以提供创建此类自定义表单和工作流程的指南链接吗？是否建议为每个设计师创建一个单独的商店，或者创建用户定义的属性以将设计师分配给他们在主商店目录中的产品？此外，鉴于我们将为每个设计师提供单独且不断变化的佣金百分比，必须使用哪些自定义模块逻辑来正确应用这些佣金？具体来说，必须利用哪些 Magento 对象来产生这样的佣金流程？

非常感谢您的帮助和指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T18:43:28.053

以下是 2 个应该有所帮助的示例：

*   [Magento – 带有通知系统的自定义电子邮件联系表](http://inchoo.net/ecommerce/magento/magento-email/magento-custom-email-contact-form-with-notification-system/)
*   [Magento 中的联系表](http://inchoo.net/ecommerce/magento/contact-form-in-magento/)

# python - 用 Python 编写代码的更好方法

> ID：10194982
> 
> 赞同：0
> 
> 时间：2012-04-17T16:13:35.510
> 
> 标签：python, urllib2

我是 python 的新手，仍在学习过程中...

我有一个网络服务器，其中包含要加载到被测设备（DUT）上的图像列表......

要求是：

如果图像已经存在于服务器上，则继续将图像加载到 DUT。

如果服务器上不存在映像，则继续下载映像，然后升级 DUT。

我已经编写了以下代码，但我对编写此代码的方式非常不满意，因为我觉得使用其他方法可以做得更好

请建议我可以做得更好的领域以及这样做的技术..

感谢您抽出宝贵时间阅读此电子邮件并提出宝贵建议。

```
import urllib2

url = 'http://localhost/test'
filename = 'Image60.txt'   # image to Verify

def Image_Upgrade():
    print 'proceeding with Image upgrade !!!'

def Image_Download():
    print 'Proceeding with Image Download !!!'

resp = urllib2.urlopen(url)
flag = False
list_of_files = []
for contents in resp.readlines():
    if 'Image' in contents:
        c=(((contents.split('href='))[-1]).split('>')[0]).strip('"')  # The content output would have html tags. so removing the tags to pick only image name
        if c != filename:
            list_of_files.append(c)
        else:
            Image_Upgrade()
            flag = True
if flag==False:
    Image_Download() 
```

谢谢，维杰·斯瓦米纳坦

# javascript - HTML5 视频 - 播放事件未触发

> ID：10194984
> 
> 赞同：3
> 
> 时间：2012-04-17T16:13:42.750
> 
> 标签：javascript, html, video, safari, dom-events

我目前在 Safari 中遇到 HTML5 视频事件问题。我正在我的页面上播放一个视频。视频加载并正确播放。但是，播放事件并不总是触发。如果用户：

1.  点击播放
2.  观看视频到最后（结束事件触发）
3.  点击再次播放

播放事件不会在第二次单击时触发。如果我当时暂停/播放电影，则会触发正确的事件。

如果视频已经完成并且用户再次按下播放，我如何才能让视频标签的播放事件触发？

**drawVidPlayer 使用视频索引作为页面渲染的一部分调用**

```
function drawVidPlayer(vindex){
    var turl=vidList[vindex]['thumbUrl'];
    var vurl=vidList[vindex]['url'];
    var valias=vidList[vindex]['type'];
    destroyVidPlayer(); 
    $('#mediaspot').css('backgroundColor', '#000000');
    $('#mediaspot').show();
    $('#mediaspot').html('<video controls="controls" id="twnvideo" poster="'+turl+'" style="height:225px; width:460px;"><source src="'+vurl+'" type="video/ogg" /><source src="'+vurl+'" type="video/mp4" /><source src="'+vurl+'" type="video/webm" />Your browser does not support the video tag.</video>').appendTo('#wrap_media_vod');
    var velem=document.getElementsByTagName('video')[0];    
    velem.addEventListener('play', initVidTimer, false);
    velem.addEventListener('pause', killVidTimer, false);
    velem.addEventListener('ended', killVidTimer, false);
}    
function destroyVidPlayer(){
    var velem=document.getElementsByTagName('video')[0];
    if(velem!=undefined){
        velem.removeEventListener('play', initVidTimer);
        velem.removeEventListener('pause', killVidTimer);
        velem.removeEventListener('ended', killVidTimer);
    }
    $('#mediaspot').empty();
    $('#mediaspot').html('');
}
function initVidTimer(){
    if(activityTimer==null){
        external.OnUserActivity(19);
        activityTimer=setInterval(function(){
            external.WriteLog('activity timer running');
            external.OnUserActivity(19);
        }, 5000);
    }
}
function killVidTimer(){
    clearInterval(activityTimer);       
    activityTimer=null; // Kill keepAlive timer
    var velem=document.getElementsByTagName('video')[0];
    external.WriteLog(velem.ended);     
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-31T06:43:58.340

我有同样的问题，我用一点 jquery 解决了：

```
function videoend(){
     var duration = $("video").get(0).duration;
     var current = $("video").get(0).currentTime;

    if(current==duration){
        //Whatever you wanna do when video ends
    };
}

$(document).ready(function(){
    setInterval("videoend()", 200); //or any other time you wanna use
}); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T18:57:18.000

[HTML5](http://dev.w3.org/html5/spec/single-page.html#playing-the-media-resource)现在指定浏览器*必须*在播放位置到达媒体文件末尾时抛出`timeupdate`、 `paused`和`ended`事件，但规范并不总是那么清楚。因此，这种行为在浏览器之间是不一致的。有些文件结束时不会设置`paused=true`或触发事件。`paused`

在您的 Safari 问题中，`paused`仍然等于`false`视频第二次开始播放的时间 - 因此浏览器没有理由`play`再次触发事件。

这在 Safari 6 中可能不再是问题，但在 IE 9 中仍然存在问题。请查看longtailvideo.com[图表中的“](http://www.longtailvideo.com/html5/playback)*结束事件*”列- 他们很好地概述了不一致之处。

用几行代码很容易规范这个问题 - 就像这样：

```
$("video").on("ended", function () {
    if (!this.paused) this.pause();
}); 
```

这会将视频置于暂停状态 on `ended`，因此它将`play`在重播时正确抛出事件。

您可以在 IE 9 中尝试这个工作示例，或者看看我在这个 jsfiddle 上的意思：http: [//jsfiddle.net/PWnUb/](http://jsfiddle.net/PWnUb/)

# c# - 编译可与预处理器指令一起使用的可移植类库时是否有任何符号

> ID：10194988
> 
> 赞同：1
> 
> 时间：2012-04-17T16:14:03.197
> 
> 标签：c#, portable-class-library

我在我的解决方案中添加了一个可移植类库，其中有一个链接到所有项目的全局文件。此全局文件包含程序集级别属性，例如版本、文化和 Com 可见性。我要解决的问题是某些属性（例如 ComVisible）在 PCL 的上下文中无效，那么是否有任何符号与 #if 一起使用以防止在构建时包含该属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:16:38.623

您可以在构建属性中配置自己的预处理器符号。我不知道*默认情况下*是否有任何特定的可移植类库，但在您的项目的每个配置中指定一个并不难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:36:16.140

我通过将存根/虚拟属性类添加到一个模仿 FCL 对应项的紧凑框架项目中克服了这个问题：

```
// Shared source file
[ComVisible(true)]
public class Foo
{
}

// Dummy class in portable project -- exists only to facilitate compilation of the shared source file
namespace System
{
    [AttributeUsage(AttributeTarget.Class)]
    public class ComVisibleAttribute : Attribute
    {
        public ComVisibleAttribue(bool visible)
        {
            // Dummy implementation
        }
    }
} 
```

现在共享源代码文件将在两个项目中编译，无需对代码进行任何修改，也无需任何预处理器指令。

# rspec2 - 没有 Spork，Rspec 应该没有工作

> ID：10194997
> 
> 赞同：0
> 
> 时间：2012-04-17T16:14:28.817
> 
> 标签：rspec2, spork

我们将 Spork 与 Rspec 一起使用，如果我们运行 Spork，我们的测试通过，但如果我们不启动 spork 并使用以下命令运行测试：

```
bundle exec rspec spec 
```

发生了几次失败，所有这些都是使用 should.have 语法的失败，例如：

```
inactive_user.received_messages.should have(1).message

1) Message introduction messages to active users should be created as messages to both users
 Failure/Error: initiator.sent_messages.should have(1).message
   expected 1 message, got 6 
```

这个数字的有趣之处在于数据库中共有多少条消息，所以：

```
initiator.sent_messages.should have(1) == Message.count 
```

如果没有 Spork，如果我像这样修改测试：

```
inactive_user.received_messages.count.should == 1 
```

一切正常。所以看起来匹配方法正在查看错误的计数。知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T20:37:21.293

我也有同样的问题。我正在使用 shoulda gem 来测试关系。我有很多 WeeklyStatistics 的 Instance 类，并且我第一次运行：

```
should have_many(:weekly_statistics) 
```

用 spork 测试是红色的，表明我应该将外键 instance_id 设置为每周统计信息，但是在我完成之后，测试仍然失败并出现相同的错误 - 缺少关联。然后我停止了 spork，测试结果是绿色的。