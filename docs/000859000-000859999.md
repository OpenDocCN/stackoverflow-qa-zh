# StackOverflow 问答 000859000-000859999

# javascript - 网页不透明？

> ID：859000
> 
> 赞同：5
> 
> 时间：2009-05-13T16:33:18.997
> 
> 标签：javascript, opacity

我一直在网站上看到 60-80% 的不透明度。他们看起来真的很酷，但我不确定他们为什么要这样做。是 Javascript，还是图像？如何更改表格的不透明度？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-13T16:36:58.787

你可以在 CSS 中做到这一点，但它需要一点黑客才能让它跨浏览器工作。

```
selector {
    filter: alpha(opacity=50); /* internet explorer */
    opacity: 0.5;           /* fx, safari, opera, chrome */
    -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=50)"; /*IE8*/
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T16:38:14.807

IE 使用语法 filter:alpha(opacity=80)，较低的值使元素更透明，而 Mozilla 使用 -moz-opacity:0.8，较低的值对透明度具有相同的效果。CSS3 有效语法 opacity:0.8; 也是如此。

这就是你需要的三个 CSS 属性。

> 过滤器：alpha（不透明度=80）；//IE
> 
> 不透明度：0.8；//CSS3
> 
> -moz-不透明度：0.8；//Mozilla

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T16:48:22.277

您还可以创建一个 1x1 像素的 32 位 PNG 图像，例如具有您需要的不透明度的黑色正方形。然后在你的CSS中你可以做......

```
element
{
    background: url(/Images/Transparent.png) repeat;
} 
```

这样你就可以避免所有不同的黑客攻击。您可能在 IE6 中遇到 Alpha 透明度问题，但也有解决此问题的方法

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T16:36:15.870

不透明度可以在 CSS 中指定，但并非所有浏览器都支持（特别是较旧的 IE）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-28T05:32:40.350

如果您想要一个广泛的“跨浏览器”解决方案，除了 IE6（完全弃用），这将始终有效：

```
div {
    background-image: url('opacity.png');
} 
```

“opacity.png”是 1px x 1px 透明 PNG24

它确实会向您的服务器生成一个额外的请求，但在大多数情况下，它完全可以负担​​得起。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T08:02:18.973

它可以通过两种方式完成，我更喜欢 alpha 透明 png 文件作为背景。在桌子上做一个 alpha 使实际内容也是半透明的。请参阅 css 值的其他答案。

# jsp - struts：在会话范围内传递对象

> ID：859001
> 
> 赞同：0
> 
> 时间：2009-05-13T16:33:26.407
> 
> 标签：jsp

我想在会话范围内传递一个对象。我想在 struts 动作类中设置它。我使用 request.setAttribute("obj",objval) 在请求范围内传递值。我如何传递会话范围我需要在 struts-config 文件中做任何事情吗？struts-action 文件中有一些参数范围。与它有什么关系吗？struts 中是否有任何内置的东西可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T20:34:12.463

在会话范围内传递对象：

request.getSession().setAttribute("obj",objVal);

struts 将通过使用 struts-action 文件中的参数属性自动将对象放入请求或会话中。然后，如果您使用 struts:html 标记库，使用此标记库的表单将自行填充。有关详细信息，请参阅 ActionForm 的 struts 类。

但是要自己将对象直接放入会话中，可以使用上面的代码。

# php - 在生成的 php 文件中包含动态 PHP

> ID：859002
> 
> 赞同：1
> 
> 时间：2009-05-13T16:33:46.450
> 
> 标签：php

我正在尝试生成“包含”模板 html 文件的 php 文件，如下所示：

```
$page = htmlspecialchars("Hello! <?php include("template.html"); ?>"); 
```

但是，当我运行它时，我得到：

解析错误：语法错误，第 15 行 /home/oliver/web/postmanapp.com/public/core.php 中的意外 T_STRING

我很确定我需要转义 PHP 代码，只是不确定如何。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T16:37:11.873

您必须转义在双引号中声明的字符串中的任何双引号。所以这应该工作：

```
$code = "Hello! <?php include(\"template.html\"); ?>"; 
```

请参阅[有关字符串的 PHP 手册](http://docs.php.net/manual/en/language.types.string.php)。

如果您想将该代码放入文件中，您可以使用以下[`file_put_contents`函数](http://docs.php.net/file_put_contents)：

```
file_put_contents('myscript.php', $code); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T16:55:03.937

答案是其他一些建议的组合，但它们都不能解决问题，甚至组合！

**问题 1\. 未转义的双引号**

```
"Hello! <?php include("template.html"); ?>" 
```

在这里，您有一个看起来像单个字符串的东西。PHP 看到开头的引号，然后它到达单词模板之前的引号，它说：哦，字符串现在完成了。然后它看到模板，它认为它是一个变量。然后它看到一个点并认为它是一个新的连接运算符。然后它看到后面的引号`html`并认为它是一个新字符串，在这样的变量之后是不允许的。

因此，您需要：

```
'Hello! <?php include("template.html"); ?>' 
```

（这是我推荐的。PHP 中的单引号字符串运行得稍微快一些，因为它不必在字符串内部查找变量。）

或者，正如其他人建议的那样，对双引号使用转义字符：

```
"Hello! <?php include(\"template.html\"); ?>" 
```

**问题 2\. htmlspecialchars() 的位置错误**

但是，你还有另一个更糟糕的问题。htmlspecialchars 基本上将所有 HTML 字符转换为它们的 HTML 字符实体。

换句话说，**`<`**变成**`&lt;`**。

因此，您要输出到 PHP 文件中的内容将是：

```
Hello! &lt;?php include("template.html"); ?&gt; 
```

当您运行该文件时，PHP 不会执行，因为没有有效的打开标记。

**问题 3\. 这不是一个很好的使用 include**

我敢打赌，有一种比使用 PHP 编写包含另一个文件的 PHP 包含标签更好的方法来解决您的问题。

较早的用户是对的... file_put_contents() 或 file_get_contents() 可能更接近您想要的。但实际上，无论何时您使用 PHP 向 PHP 写入另一个文件，都可能有更好的方法。我几乎可以保证。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-05-13T16:39:39.687

问题在于 ?> 总是在 php 中结束一个代码块，导致一个未终止的字符串。您需要做的就是将结束标记拆分为两个可以连接的单独字符串：

```
$page = htmlspecialchars("Hello! <?php include("template.html"); ?" . ">"); 
```

而且，正如前面的答案所述，您还需要转义字符串内的双引号，或使用单引号：

```
$page = htmlspecialchars("Hello! <?php include('template.html'); ?" . ">"); 
```

每当您不使用隐式变量替换时，我还建议养成使用单引号的习惯。我似乎记得读过它稍微快一点，因为字符串不需要解析变量名。

# c# - C# 中的字符串比较性能

> ID：859005
> 
> 赞同：22
> 
> 时间：2009-05-13T16:33:54.250
> 
> 标签：c#, .net, linq, performance, string-comparison

有多种方法可以比较字符串。以一种方式胜过另一种方式是否会提高性能？

我一直选择像这样比较字符串：

```
string name = "Bob Wazowski";
if (name.CompareTo("Jill Yearsley") == 0) {
    // whatever...
} 
```

但是我发现很少有人这样做，如果有的话，我看到更多的人只是直接进行 == 比较，据我所知，这是比较字符串的最糟糕的方法。我错了吗？

此外，在 LINQ 查询中比较字符串的方式是否有所不同？例如，我喜欢执行以下操作：

```
var results = from names in ctx.Names
              where names.FirstName.CompareTo("Bob Wazowski") == 0
              select names; 
```

但同样，我看到很少有人在他们的 LINQ 查询中进行这样的字符串比较。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-13T17:45:50.407

根据反射器

```
"Hello" == "World" 
```

是相同的

```
String.Equals("Hello", "World"); 
```

它基本上确定它们是否是同一个引用对象，如果它们中的任何一个为空，如果一个为空而另一个不是，则自动为假，然后在不安全的循环中比较每个字符。所以它根本不关心文化规则，这通常没什么大不了的。

和

```
"Hello".CompareTo("World") == 0 
```

是相同的

```
CultureInfo.CurrentCulture.CompareInfo.Compare("Hello", "World", CompareOptions.None); 
```

就功能而言，这基本上是相反的。它考虑了文化、编码以及与字符串相关的所有其他内容。

所以我想**String.CompareTo 比相等运算符慢几个数量级**。

至于您的 LINQ，您是否使用 LINQ-to-SQL 并不重要，因为两者都会生成相同的 SQL

```
var results = from names in ctx.Names
          where names.FirstName.CompareTo("Bob Wazowski") == 0
          select names; 
```

的

```
SELECT [name fields]
FROM [Names] AS [t0]
WHERE [t0].FirstName = @p0 
```

所以除了更难阅读代码和可能更多地解析表达式之外，你真的没有为 LINQ-to-SQL 获得任何东西。如果您只是将 LINQ 用于标准数组内容，那么我上面列出的规则适用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-13T16:48:24.697

在我看来，您应该始终使用最清晰的方法，即使用`==`!

这可以直接理解为：当“Hello”等于“World”时再做点什么。

```
if ("Hello" == "World")
    // ... 
```

在内部，`String::Equals`为此目的明确存在的被调用 - 比较两个字符串是否相等。（这与指针和引用等无关）

这里不是很清楚——为什么要与零比较？

```
if ("Hello".CompareTo("World") == 0) 
```

.CompareTo 不仅仅用于检查相等性（你有 == 为此） - 它比较两个字符串。您在排序中使用 .CompareTo 来确定一个字符串是否比另一个字符串“更大”。您**可以**检查相等性，因为它对相等的字符串产生零，但这不是它的概念。

因此，有不同的方法和接口用于检查相等性（IEquatable，运算符 ==）和比较（IComparable）

Linq 在这里的行为与常规 C# 没有什么不同。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-13T16:50:10.683

阅读 Jeff 的[**The Best Code is No Code at All**](http://www.codinghorror.com/blog/archives/000878.html)。`foo.CompareTo(bar) == 0`: 可怕的视觉混乱。占用大量空间，并没有传达有趣的含义。事实上，它强调了许多无关紧要的东西，从而将注意力从真正的问题上转移开。

如果没有明确的理由使用这个更长的变体，不要。

至于性能：对于这个简单的案例来说根本不重要。如果相等运算符的`==`性能确实比 差`CompareTo`，请随时向 Microsoft 提交错误报告。这决不能发生。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-14T06:55:01.867

那么 MSDN 声明您应该根据需要执行的任务使用比较功能：

> CompareTo 方法主要设计用于排序或字母排序操作。当方法调用的主要目的是确定两个字符串是否等价时，不应使用它。要确定两个字符串是否等价，请调用 Equals 方法。

因此，如果它不是关于排序并且重新运行值不重要，我会说应该使用：

`first.Equals(second)` 或者如果比较是特定于文化的，例如在德语等语言中：

`String.Equals(first, second, StringComparison.CurrentCulture)`

看看这些链接：

[如何：比较字符串（C# 编程指南）](http://msdn.microsoft.com/en-us/library/cc165449.aspx)

[String.CompareTo 方法（对象）](http://msdn.microsoft.com/en-us/library/fkw3h78a.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T16:41:23.897

最近有一个非常相似的问题，关于修剪字符串的最快方法，但它基本上是对比较它们的不同方法进行基准测试。

您可以查看[这篇文章](https://stackoverflow.com/questions/810442/whats-the-most-efficient-way-to-determine-whether-an-untrimmed-string-is-empty-i/810473#810473)的基准。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T16:58:09.033

有一篇不错的文章[Comparing Values for Equality in .NET：Identity and Equivalence](http://www.codeproject.com/KB/dotnet/DotNetEquality.aspx)，它比单纯的字符串比较更通用，但非常有趣。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T17:19:19.373

如果相等运算符的实际性能比`CompareTo`- 微软不会实现相等运算符调用`CompareTo`吗？

只需使用相等运算符来测试相等性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-07-23T06:35:00.793

[这](http://msdn.microsoft.com/en-us/library/dd465121(v=vs.110).aspx)是我找到的关于字符串比较的最完整和最有用的 MSDN 指南。

> 使用与 StringComparison.Ordinal 或 StringComparison.OrdinalIgnoreCase 进行比较以获得更好的性能。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-13T17:28:46.190

我通常将 String.Compare 与采用 StringComparison 参数的重载一起使用，因为这样我就可以绝对明确地确定比较是否区分大小写和区域性。这需要 .NET 2.0 或更高版本。

对于不区分区域性的比较，最快的是 StringComparison.Ordinal（或 StringComparison.OrdinalIgnoreCase，如果不区分大小写）。

使用 == 的问题在于，作者是否考虑了大小写和文化敏感性尚不清楚。

[这里](http://msdn.microsoft.com/en-us/library/ms973919.aspx)有一篇关于这个主题的很好的 MSDN 文章。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-13T17:47:55.097

在 C# 中比较**`string`**'s 的最佳方法是使用**`a.Equals(b)`**where **a**和**b**是字符串。这是比较字符串的最佳方式，因为它比较对象**a**和**b**的值，并且不依赖于对象的引用。

如果要使用**“ `==`”**符号，如果两个对象具有相同的引用，则结果将相等，但是当它们具有不同的引用并具有相同的值时，您将遇到问题。

**`compareTo`**如果您测试另一个字符串是否在另一个字符串之前、之后或出现在另一个字符串的相同位置，其中它将分别返回负值、正值或零值，则该方法是最好的方法。如果参数是，它也会返回正值`null`

# jquery - IE6 上的 jQuery UI 可排序问题

> ID：859007
> 
> 赞同：4
> 
> 时间：2009-05-13T16:34:05.640
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable

我的第一个问题。

我们有一个用户自定义页面，让他们可以将不同的模块 () 重新定位到三个不同的内容块中。有两个空间内容，一个四个空间内容，然后是一个未使用的模块池。

我正在使用 Sortables 将这些模块拖放到位（来回三个内容 div）。如果项目的数量或组合宽度超过内容可用的插槽/宽度，我什至有逻辑从内容中删除项目。

所有这些在 FF3、IE7、Safari 中都可以正常工作……但是，这个库在 IE6 上是否存在已知问题？我的意思是，项目变得不可见，拖动时移动到一边，将助手放在错误的位置..我的客户专门要求让它在 IE6 上工作。在使用这个库之前有没有人经历过这种行为？

提前谢谢。

（我会粘贴代码，但所有引用和变量都是西班牙语......如果需要我会翻译它们）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-05T04:28:34.767

没有你的 html 和 css 就不可能给你一个完整的答案。但我确实知道，在实现 jQuery UI 的可排序/可拖动功能时，我的许多 IE6 问题都是通过确保元素在 IE6 中具有“布局”来解决的。[这是一篇关于 IE 中布局问题的好文章](http://www.satzansatz.de/cssd/onhavinglayout.html)。

出于我的目的，我最终为 IE6 添加了一个条件 css 脚本，并将以下 css 应用于我的可排序列表：

```
/* Gives layout to elements in IE6, similar to zoom: 1; in IE7 */
#fields, #fields li {
    height: 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-20T11:42:16.040

这是因为您的页面正在以 Quirks 模式呈现。只需将 css zoom:1 属性添加到元素。那应该可以解决问题。

HTML：

```
 <ul class="mysortable">
    <li><input type="checkbox" />Sort list 1</li>
    <li><input type="checkbox" />Sort list 2
        <ul class="mysortable">
           <li><input type="checkbox" />Sort list 1</li>
           <li><input type="checkbox" />Sort list 2</li>
           <li><input type="checkbox" />Sort list 3</li>
        </ul></li>
    <li><input type="checkbox" />Sort list 3</li>
    </ul> 
```

CSS：把它放在 IE 条件破解中

```
ul.mysortable,
ul.mysortable ul,
ul.mysortable li{
   zoom:1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T10:16:34.793

对不起，伙计们..没有时间进一步解释，因为我们已经接近死胡同了。这是我正在使用的：

有三个 div 应用了 '.groupWrapper' 类，#listaUno #listaDos #listaInicial。有两种 div 模块，都是向左浮动的，宽度基本不同，167x159 和 342x159，容器 #listaUno 设置宽度为 346px（可以容纳两个小模块或一个大模块），而 #listaDos 有 690px（最多四个小模块）。

使用 jQuery-UI 中的 Sortables ..

```
$(document).ready(function(){    
    //change png to gif for IE as its very jumpy
    if ($.browser.msie) {
        $("img.iconico").attr("src", function() { 
            valor = this.src.replace(".png",".gif");
            return valor;
        });
    }
    //all three groupWrapper div elements are now draggable
    $(".groupWrapper").sortable({
        connectWith: '.groupWrapper',
        items: 'div',
        scroll: true, 
        opacity: 0.6, 
        receive: function(event, ui) { hemosCambiado(); }
    });
    $(".groupWrapper").disableSelection();  
});

function init() {
    $(".groupWrapper").sortable({
        connectWith: '.groupWrapper',
        items: 'div',
        scroll: true, 
        opacity: 0.6, 
        receive: function(event, ui) { hemosCambiado(); }
    });
    $(".groupWrapper").disableSelection();
};

function hemosCambiado() {  
    var obj;
    elemListaUno = $('#listaUno div').size(); //num elements in listaUno
    elemListaDos = $('#listaDos div').size(); //num elements in listaDos
    elemListaInicial = $('#listaInicial div').size(); //num elements in listaInicial
    anchoLista1 = $('#izquierda').width(); //should be 346px;
    anchoLista2 = $('#caja-modulos2').width(); //should be 690px;

    //listaUno should have 2 or less elements, less than given width
    anchoElems1 = 0;
    $('#listaUno div').each( function(i,elem) {
        anchoElems1 += $(elem).width();
    }); 
    if((elemListaUno>2) || (anchoElems1>anchoLista1)){
        //surplus elements are sent back to listaInicial
        $('#listaInicial').append($('#listaUno div:last-child'));
    }

    //listaUno should have 4 or less elements, less than given width
    anchoElems2 = 0;
    $('#listaDos div').each( function(i,elem) {
        anchoElems2 += $(elem).width();
    }); 
    if((elemListaDos>4) || (anchoElems2>anchoLista2)){
        //surplus elements are sent back to listaInicial
        $('#listaInicial').append($('#listaDos div:last-child'));
    }

    $(".groupWrapper").sortable( 'refresh' );
    init(); //for some reason, elements appended aren't included as dragable again in IE versions, so the need to be initialized again.
} 
```

这在 FireFox、IE7、Safari 等上运行良好……但在 IE6 上，被拖动的元素，在其他页面元素下做一些跳跃的东西，或者链接到鼠标但距离它 500 像素，以及不同的其他混乱的东西..

# html - ASP.NET MVC 等价于 Response.Redirect 点击事件

> ID：859009
> 
> 赞同：1
> 
> 时间：2009-05-13T16:34:38.057
> 
> 标签：html, asp.net-mvc, model-view-controller, forms, reset

我的视图中有一个 html 表单，需要不时重置。问题是，字段根据输入启用/禁用。因此，真正重置表单的唯一方法是重新加载视图（我希望重新加载整个页面）。由于几种情况，简单的刷新是行不通的。我需要等效于 Response.Redirect() 并将视图重定向到自身...尚未找到好的解决方案。

我努力了：

- 在控制器中添加一个 ActionResult

```
 public ActionResult ResetNoteReport()
    {
        return RedirectToAction("NoteReport");
    } 
```

- 在按钮本身上设置一个点击事件

```
onclick="window.location.href('<%= Url.Action("NoteReport")%>');" 
```

- 通过 JQuery 删除输入并将值设置为 null 或 "" ...

在许多其他刺中......任何帮助都会非常感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:22:09.110

很抱歉浪费你的时间。出于某种原因，我之前尝试使用 window.location.href() 时出现了错误，并且不会重新加载页面。当我回到它时，我尝试了你的建议，但最终回到了 window.location.href()。最终结果，我不知道之前有什么问题，但以下工作非常好：

```
<script type="text/javascript">
    function reload() {
        window.location.href = "<%=Url.Action("NoteReport") %>";
    };
</script>

<%= Html.Button("reset", "Reset", HtmlButtonType.Button, "reload()") %> 
```

再次感谢您的快速回复！我喜欢这个网站！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T11:01:08.560

```
<%= Html.Button("reset", "Reset", HtmlButtonType.Button, "window.location.reload()") %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:25:21.007

只是一个问题，而不是更改页面，您能否不使用其中一个 jquery 表单实用程序来清除表单？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T19:26:55.827

> 问题是，字段根据输入启用/禁用。

这正是 MVC 不适合使用的一种情况。WebForms 在这种情况下表现得更好。

# java - 在 Java Swing 中构建简单日历的方法

> ID：859012
> 
> 赞同：0
> 
> 时间：2009-05-13T16:35:19.523
> 
> 标签：java, swing, calendar

我需要一种简单的方法来在 java 中实现日历（类似于谷歌日历）。日历必须在顶部显示星期一 - 星期日，并且每个小时连续显示。

```
 Monday | Tuesday | Wednesday
08:00
09:00
10:00
11:00 
```

如何在 Swing 中创建这样的日历？我正在使用 Netbeans IDE。每列应该能够容纳一些文本。

我可以在摇摆中使用表格组件吗？如果是这样，我可以修改它以满足我的需要吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T16:50:19.343

您可能会考虑使用`JTable`. 您可以使用 an`AbstractTableModel`来定义表格的尺寸以及其他一些属性，然后您可以使用所需的值填充顶行和第一列。如果您希望能够将数据输入到日历中，您还可以设置用户可编辑的表格的某些部分。

有关更多信息，请查看[JTable 文档](http://java.sun.com/javase/6/docs/api/javax/swing/JTable.html)。

# .net - 在项目开始很久之后开始单元测试？

> ID：859013
> 
> 赞同：3
> 
> 时间：2009-05-13T16:35:55.760
> 
> 标签：.net, asp.net, vb.net, unit-testing

我接手了一个已经进行了几个月的项目。我还没有做过单元测试，并认为这将是一个不错的开始时间。然而，通常单元测试是在你进行的时候编写的，并且你在开始项目时就为它们做好了计划。我现在开始合理吗？是否有任何体面的资源可以在不启动全新解决方案的情况下设置单元测试（该项目已经在进行中）。在 VS2005 中使用 vb.net

提前致谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T16:45:48.007

任何时候都是开始单元测试的好时机，尽管随着项目的深入，你会发现事情变得紧密耦合而没有考虑可测试性，这会变得越来越难。

最好的起点是您希望开发的任何新内容或当前有很多问题的关键部分。如果您发现自己有空闲时间，请尝试重构代码并向其中添加测试。

您应该在解决方案中为您的单元测试使用一个单独的项目，这样您就不必将它与您的应用程序一起分发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T16:44:27.153

为您现在正在接触的代码编写测试。当您有时间（是的，对）时，您可以涵盖程序的其他部分。

另外，在重构之前编写测试；这样，您可以确保旧版本与新版本执行相同的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T16:45:29.427

将单元测试添加到现有的大型代码库比从头开始更难。无论如何，我会鼓励你这样做，因为从长远来看它会有所回报。

我做过同样的练习，我的看法是：每当你想更改现有功能时，至少创建单元测试来验证更改后的代码是否按预期工作。您还应该努力测试直接依赖于您更改的代码的其他代码。这样你就有了一些保险，你的改变不会破坏很多。

当然，无论何时创建新代码，都应该完全由单元测试支持。

这样你将逐渐建立一个坚实的单元测试基础。

单元测试项目只是您添加到解决方案中的库项目。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T05:35:41.167

您面临的基本问题是 Michael Feathers 在[有效地使用遗留代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)作为遗留代码困境（也称为重构困境）中提到的问题：

*   当我们重构时，我们应该有测试。
*   为了进行测试，我们经常需要重构。

作为摆脱困境的一种方式，本书描述了一套打破依赖关系的技术。这些是撬开依赖关系以隔离代码并使其进行单元测试的相对安全的方法。本书的示例使用 Java、C++、C 和 C# 编写。我对 vb.net 的了解还不够，无法说出有多少技术可以应用。

在 c2 wiki 上也有一些一般性的讨论/鼓励[。](http://c2.com/cgi/wiki?UnitTestingLegacyCode)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T16:49:24.663

我接下来要做的是：

1.  为我实现的功能编写测试。
2.  为我修复的任何错误编写测试。
3.  在任何重构工作之前编写测试。

这将为您提供一种公平的方式来获得一些测试覆盖率，而无需将整个团队切换到只为一两个 sprint 编写测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T17:01:04.520

我会说应该进行单元测试的功能需要很小，以便它们不会发生太多的状态变化。事实上，如果您在开发之前编写单元测试，那么您将始终将您的功能设计为模块化。

请查看[http://msdn.microsoft.com/en-us/library/ms364064.aspx](http://msdn.microsoft.com/en-us/library/ms364064.aspx)

干杯

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T17:01:53.690

这么晚才开始编写单元测试意味着你现在还有很多东西要写。不过，IMO 花时间是值得的，但不幸的是，有时时间/预算不允许这样做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T16:46:39.583

只要您可以完全覆盖特定区域，那么它就是值得的。

如果你不能，那么单元测试就会开始失去它们的价值，因为它们会给人一种错误的印象，即某个特定的区域已经过正确的测试。

如果写得正确，我仍然会说它们是有益的。但是，您确实需要注意，它们最初会减慢开发速度，理想情况下，您的团队中从事同一代码领域工作的其他成员需要保持最新状态。

# debugging - 调试器断点如何有效实现？

> ID：859023
> 
> 赞同：6
> 
> 时间：2009-05-13T16:37:37.600
> 
> 标签：debugging, implementation

有时我会在代码的不同位置积累大量来自不同调试会话的断点。调试器如何有效地知道何时停止断点？它不可能在每一行都停下来检查行号和源文件名与可能很长的断点列表，可以吗？

这是 Eclipse 中的 Java 调试器，但我认为这个问题适用于任何调试器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T16:42:38.543

许多调试器（我不了解 Eclipse）中使用的策略是在断点处将补丁放入代码中，这本质上是子程序调用或系统调用。跳转到的代码有断点信息，做任何打印或接受用户命令，也有被补丁覆盖的代码，这样可以执行代码，使执行与原始代码匹配，没有断点

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T16:55:04.390

添加到纳德雷克的好答案：

[这里](http://www.nynaeve.net/?p=80)有一篇文章，其中包含更多细节，包括一些更奇特的东西（x86 上的特定操作码；硬件断点）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-01T19:33:50.337

调试器在硬件或软件中实现断点。后者需要保存原始指令，插入生成异常的特殊代码，当引发异常时，重新插入原始指令并让用户知道断点已被命中。阅读[我的文章](http://mohit.io/blog/software-breakpoints/)，了解有关软件断点的详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-01T14:11:33.560

您可以在下面的链接中获取 Eclipse 调试器的完整详细信息以及如何 [编写一个 Eclipse 调试器](http://www.eclipse.org/articles/Article-Debugger/how-to.html)

# jquery - 如何在 Greasemonkey 中使用 jQuery？

> ID：859024
> 
> 赞同：243
> 
> 时间：2009-05-13T16:37:44.900
> 
> 标签：jquery, greasemonkey

我试着把这条线，但它不工作：

```
// @require       http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.js 
```

jQuery 在 Greasemonkey 中根本不起作用。还有其他方法可以在 Greasemonkey 中使用 jQuery 吗？

--

对于所有有同样问题的人，您必须将文件上传到greasespot，然后从那里安装。

创建新脚本选项不起作用！

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2009-05-13T16:50:52.977

也许您没有足够新的 Greasemonkey 版本。是 0.8 版添加了`@require`.

```
// @require https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js 
```

如果您没有 0.8，则使用 Joan Piedra 描述的技术[手动向`script`页面添加元素](https://github.com/greasemonkey/greasemonkey/issues/1148)。

在版本 0.8 和 0.9 之间，`@require`仅**在首次安装脚本时处理。**如果更改所需脚本列表，则需要卸载脚本并重新安装；Greasemonkey 在安装时下载一次所需的脚本，然后使用缓存的副本。

从 0.9 开始，Greasemonkey 的行为已经改变（以解决[一个切线相关的问题](http://joanpiedra.com/jquery/greasemonkey/)），现在它在每次编辑后加载所需的脚本；不再需要重新安装脚本。

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2010-11-23T22:51:14.240

如果您想在已经包含 jQuery 的网站上使用 jQuery，那么可以这样做（受 BrunoLM 启发）：

```
var $ = unsafeWindow.jQuery; 
```

我知道这不是问题的初衷，但它正日益成为一种常见情况，您没有明确排除这种情况。;)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-13T17:04:14.920

在 Greasemonkey 脚本中包含整个 jQuery 绝对没有错。只需获取源代码，并将其放在用户脚本的顶部即可。无需创建脚本标签，因为您已经在执行 JavaScript！

无论如何，用户只下载一次脚本，所以脚本的大小不是一个大问题。此外，如果您希望您的 Greasemonkey 脚本在非 GM 环境中工作（例如 Opera 的 GM-esque 用户脚本，或 Safari 上的 Greasekit），那么不使用 GM-unique 构造（例如 @require）会有所帮助。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-03-24T00:00:17.167

Rob 的解决方案是正确的——`@require`与 jQuery 库一起使用，并确保重新安装脚本，以便处理指令。

我认为值得添加的一件事是，一旦将 jQuery 包含在脚本中，您就可以正常使用它，**AJAX 方法除外**。默认情况下，jQuery 查找 XMLHttpRequest，它在 Greasemonkey 上下文中不存在。我写了[一个解决方法](http://ryangreenberg.com/archives/2010/03/greasemonkey_jquery.php)，您可以为 GM_xmlhttpRequest（XHR 的 Greasemonkey 版本）创建一个包装器，并使用 jQuery`ajaxSetup()`将您的包装版本指定为默认值。完成此操作后，您可以像往常一样使用`$.get`和。`$.post`

您可能还会遇到 jQuery 的问题，`$.getJSON`因为它使用`<script>`标签加载 JSONP。这会导致错误，因为 jQuery 在 Greasemonkey 窗口范围内定义了回调函数，而加载的脚本在主窗口范围内查找回调。您最好的选择是`$.get`改用`JSON.parse()`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-05-30T06:02:06.233

如果您使用的是 chrome，则必须选择替代方案，因为 Chromium 不支持`@require`.

来源：[Chromium 项目 - 用户脚本](http://www.chromium.org/developers/design-documents/user-scripts)

[有关如何在 Google Chrome 的 Greasemonkey 脚本中使用 jQuery 的](https://stackoverflow.com/questions/2246901/how-can-i-use-jquery-in-greasemonkey-scripts-in-google-chrome)更多详细信息和替代方法？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-12-23T12:02:14.987

您可以使用 Greasemonkey 中的新用户脚本创建新脚本，但您必须编辑 gm_scripts 文件夹中的 config.xml 文件。

您的**config.xml**文件应具有与此类似的语法：

```
<Script filename="jquery_test.user.js" name="jQuery Test" namespace="http://www.example.com/jQueryPlay/" description="Just a test" enabled="true" basedir="jquery_test">
        <Include>http://*</Include>
        <Require filename="jquery.js"/>
</Script> 
```

注意`<Require>`标签。

在您的脚本中，您可以使用直接的 jQuery 语法。确保 Greasemonkey 标头中有 require 标记。这是一个 Hello World 示例：

```
// ==UserScript==
// @name           Test jQuery
// @namespace      http://www.example.com/jQueryPlay/
// @description    Just a test
// @include        http://*
// @require       http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.js
// ==/UserScript==

$(document).ready(function() {  
        alert("Hello world!");
}); 
```

请记住，修改**config.xml**后，您必须重新启动浏览器才能让 Greasemonkey 重新加载设置。

另请注意，您需要将 jquery.js 文件复制到脚本目录文件夹才能使其正常工作。我对此进行了测试，只有在您实际手动复制文件时它才有效。

快乐的 jQuerying！

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-04-11T17:32:18.713

**更新**：正如下面的评论所说，这个答案已经过时了。

正如其他人所说，@require 仅在脚本安装后运行。但是，您还应该注意，当前 jQuery 1.4.* 不适用于greasemonkey。您可以在此处查看详细信息：http: [//forum.jquery.com/topic/importing-jquery-1-4-1-into-greasemonkey-scripts-generates-an-error](http://forum.jquery.com/topic/importing-jquery-1-4-1-into-greasemonkey-scripts-generates-an-error)

在事情发生变化之前，您将不得不使用 jQuery 1.3.2。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-09-04T01:29:56.480

`Component unavailable`如果您直接导入 jQuery 脚本，您可能会得到。

也许这就是@Conley 所说的......

您可以使用

```
@require        http://userscripts.org/scripts/source/85365.user.js 
```

这是在 Greasemonkey 上工作的修改版本，然后获取 jQuery 对象

```
var $ = unsafeWindow.jQuery;
$("div").css("display", "none"); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-07-13T18:43:39.747

当您想使用 jQuery 取消绑定网页上的事件时，@require 元不起作用，您必须使用网页中包含的 jQuery 库，然后使用`var $ = unsafeWindow.jQuery;` [如何在 Greasemonkey 中取消绑定 jquery 事件处理程序在 Greasemonkey 中获取它？](https://stackoverflow.com/questions/5436874/how-do-i-unbind-jquery-event-handlers-in-greasemonkey)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-14T17:19:50.060

`@require`**不仅**在首次安装脚本时处理！根据我的观察，它是在第一次执行时处理的！所以你**可以**通过 Greasemonkey 的命令安装一个脚本来创建一个全新的脚本。您唯一需要注意的是，在添加`@require`部件之前不会触发页面重新加载。（并保存新脚本...）

# c# - c# WPF中的语法高亮

> ID：859028
> 
> 赞同：3
> 
> 时间：2009-05-13T16:38:43.057
> 
> 标签：c#, wpf

我找到了一个在 RichEdits for WPF 中进行语法高亮的教程：

[http://blogs.microsoft.co.il/blogs/tamir/archive/2006/12/14/RichTextBox-syntax-highlighting.aspx](http://blogs.microsoft.co.il/blogs/tamir/archive/2006/12/14/RichTextBox-syntax-highlighting.aspx)

但是如果我从一个文件中打开我的命令列表，Editbox 会变得非常非常慢......也许有太多的词要突出显示。

我读到像 RichEdit 这样的 WPF 元素比 WinForms 元素慢得多。

如何使我的 WPF RichEdit 更快或将 Winforms RichEdit 包含到我的 WPF 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T18:35:31.993

我在 .NET 1.1 中写了一个类似的语法荧光笔，性能很糟糕。我已经很多年没有重新审视这个问题了，但在我看来，一定有更好的方法。

我相信答案可能在[RTF 文档](http://www.microsoft.com/downloads/details.aspx?FamilyId=DD422B8D-FF06-4207-B476-6B5396A18A2B&displaylang=en#filelist)中。您可以定义颜色表和/或样式，然后使用它们来包装匹配的单词。查看第 130 页“字体（字符）格式属性”，cf N*和*cs *N。*诀窍是尽快找到匹配项并插入控制字符。我是 RegEx 将是最快的扫描方法。

您还可以尝试将突出显示限制在可见空间周围的合理区域，甚至考虑将突出显示操作线程化到另一个进程。

我肯定有兴趣为这个问题找到一个好的解决方案。

# java - EasyMock：无效方法

> ID：859031
> 
> 赞同：68
> 
> 时间：2009-05-13T16:39:12.807
> 
> 标签：java, unit-testing, mocking, void, easymock

我有一个方法在一个类中返回 void，该类是我要测试的类的依赖项。

这个类很大，我只使用它的这个单一方法。我需要为测试替换此方法的实现，因为我希望它做一些不同的事情，并且我需要能够访问此方法接收的参数。

[我在EasyMock](http://easymock.org/)中找不到这样做的方法。我想我知道如何使用 Mockito 来做到这一点，[但](http://site.mockito.org/)[`doAnswer`](https://static.javadoc.io/org.mockito/mockito-core/2.7.5/org/mockito/Mockito.html#doAnswer(org.mockito.stubbing.Answer))除非绝对必要，否则我不想添加另一个库。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-05-13T17:20:25.703

如果我理解您想要正确执行的操作，您应该可以使用`andAnswer()`：

```
mockObject.someMethod(eq(param1), eq(param2));
expectLastCall().andAnswer(new IAnswer() {
    public Object answer() {
        //supply your mock implementation here...
        SomeClass arg1 = (SomeClass) getCurrentArguments()[0];
        AnotherClass arg2 = (AnotherClass) getCurrentArguments()[1];
        arg1.doSomething(blah);
        //return the value to be returned by the method (null for void)
        return null;
    }
}); 
```

[EasyMock 用户指南](http://easymock.org/user-guide.html)解释：

> ### 创建返回值或异常
> 
> 有时我们希望我们的模拟对象返回一个值或抛出一个在实际调用时创建的异常。从 EasyMock 2.2 开始，对象返回[`expectLastCall()`](http://easymock.org/api/org/easymock/EasyMock.html#expectLastCall--)并[`expect(T value)`](http://easymock.org/api/org/easymock/EasyMock.html#expect-T-)提供[`andAnswer(IAnswer answer)`](http://easymock.org/api/org/easymock/IExpectationSetters.html#andAnswer-org.easymock.IAnswer-)允许 [您] 指定[`IAnswer`](http://easymock.org/api/org/easymock/IAnswer.html)用于创建返回值或异常的接口的实现的方法。
> 
> 在[`IAnswer`](http://easymock.org/api/org/easymock/IAnswer.html)回调中，传递给模拟调用的参数可以通过[`EasyMock.getCurrentArguments()`](http://easymock.org/api/org/easymock/EasyMock.html#getCurrentArguments--). 如果你使用这些，像重新排序参数这样的重构可能会破坏你的测试。你被警告了。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-13T18:01:20.460

如果您只是在每次期望调用 void 方法时调用它，然后在调用`EasyMock.expectLastCall()`之前调用`replay()`，Easymock 将“记住”每次调用。

因此，我认为您不需要显式调用`expect()`（除了`lastCall`），因为除了调用之外，您对 void 方法没有任何期望。

谢谢克里斯！

[StackOverflow 用户](http://burtbeckwith.com/blog/?p=43)[Burt Beckwith](https://stackoverflow.com/users/160313/burt-beckwith)的“Fun With EasyMock”</a>是一篇很好的博文，提供了更多详细信息。值得注意的摘录：

> 基本上我倾向于使用的流程是：
> 
> 1.  创建一个模拟
> 2.  呼叫`expect(mock.[method call]).andReturn([result])`每个预期呼叫
> 3.  call `mock.[method call]`，然后`EasyMock.expectLastCall()`对于每个预期的 void 调用
> 4.  调用`replay(mock)`从“录制”模式切换到“回放”模式
> 5.  根据需要注入模拟
> 6.  调用测试方法
> 7.  打电话`verify(mock)`以确保所有预期的电话都发生了

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-01-10T18:52:41.173

如果您只想稍后访问参数，您可能还会喜欢EasyMock 2.4 新增的[Captures类。](http://easymock.org/api/easymock/2.4/org/easymock/Capture.html)

您可以使用“Capture”类的实例代替匹配器。当您的模拟方法被调用时，Capture 实例将存储调用它的参数。

```
Capture<ChartPanel> captured = new Capture<ChartPanel>();
// setChartPanel is going to be called during execution;
// we want to verify some things about the ChartPanel
// instance it's invoked with
chartMock.setChartPanel(capture(captured));
replay(chartMock);

ufdm.setChartAnnotater(chartMock);
// afterPropertiesSet triggers the setChartPanel call...
ufdm.afterPropertiesSet();
verify(chartMock);

// verify some things about the ChartPanel parameter our
// mock object was invoked with
assertSame(plot, captured.getValue().getChart().getPlot()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-31T19:34:08.283

您可能想查看 PowerMock。EasyMock 基于代理反射 API，这意味着一切都是代理，您只能测试接口，因此只能测试非最终方法和类。这可能对某些人有用，但如果你正在测试构建的世界，你将需要更多的力量。

使用 PowerMock，Java 5 检测 API 消除了这些限制。无需编写要测试的对象的模拟对象实现（只是丑陋的 IMO）。将 PowerMock 与 Mockito（或 JMockit）结合使用，您将真正参加比赛。

当然，还有另一个方向是重写代码以便更容易测试，如果可能的话，这通常也是一个好主意。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-13T16:44:02.753

在这种情况下，我发现在我的单元测试类中创建一个嵌套类并以这种方式覆盖具有特殊要求的方法是最好的方法。因此，如果您正在测试`ClassA`哪个方法具有您需要访问的参数，您可以执行以下操作：

```
class MockClassA extends ClassA {
    @Override
    void specialMethod(String param1, String param2) {
        // do logging or manipulation of some sort
        super.specialMethod(param1,param2); // if you need to
    }
} 
```

在我的单元测试代码中，然后我只使用这个实例。只需将其视为任何其他模拟对象即可。比混合库容易得多，我同意这可能不是一个好主意。

# javascript - JSONPath 或其他用于 JSON/Javascript 的类似 XPath 的实用程序；或 Jquery JSON

> ID：859033
> 
> 赞同：15
> 
> 时间：2009-05-13T16:39:16.660
> 
> 标签：javascript, jquery, json, jsonpath

我一直在研究 JSONPath，虽然它看起来做得很好，但我想知道是否有人使用过它并可以评论它的可用性，或者可以推荐替代方案？如果有一个用于 JQuery 的插件来做这样的事情，那将是*非常巧妙的。*我一直在搜索插件并空手而归。无论如何，在我花时间了解 JSONPath（它有一些我不喜欢的方面）之前，或者在我重新发明轮子之前，我想我会看看是否有人对此有看法......

为了让您了解我的意思，想象一下这个 Javascript 对象：

```
var Characters=[
        {
            id: "CuriousGeorge",
            species:"Monkey",
            mood: "curious",
            appendage: [
                { 
                    type: "hand",
                    side: "left",
                    holding: [ 
                        { id: "Banana" } 
                    ]
                },
                { 
                    type: "hand",
                    side: "right",
                    holding: []
                }, 
                { 
                    type: "foot",
                    side: "left",
                    holding: []
                },
                { 
                    type: "foot",
                    side: "right",
                    holding: [ 
                        { id: "YellowHat" },
                        { id: "Keys" }
                    ]
                }
            ]
        },
        {
            id: "ManInYellowHat",
            species: "Human",
            mood: "angry",
            //...ok, you get it...
        }
    ] 
```

通过 Jquery 选择器之类的东西来获取一些更深层次的对象不是很好吗？

```
var banana=SomeUtility("Characters holding #Banana").get(0);
var leftHands=SomeUtility("Characters appendage[type=hand][side=left]").get(); 
```

（这可能有资格成为世界上最老套的代码示例，但是，嘿，我的孩子们刚刚看了这个。而且由于 NDA，我不能使用真实的示例......）

......而且，为了让它更有趣，如果我要创造这样的东西，会有人使用它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-12-13T15:13:17.620

查看[JSON Select](https://github.com/lloyd/JSONSelect) - JSON 的类似 CSS 的选择器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T15:09:47.270

好的，我为此创建了一个原型，可在此处找到： [http ://code.google.com/p/jfunk/](http://code.google.com/p/jfunk/)

它已经被证明对我很有用，所以我可能会慢慢改进并将它重构为更好的东西。但如果我得到好的反馈，我可以更快地行动。我也欢迎帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T12:26:28.420

绝对是一个有用的实用程序。

我的观点是，解决此问题的最佳方法是尽可能与 CSS 选择器保持相似，正如您所指出的。我建议深入了解[jquery](http://jquery.com)的选择器实现。

我会建议像

```
var banana = object.function(jsonObect, "holding #Banana");
var leftHands = object.function(jsonObject, "appendage[type=hand][side=left]"); 
```

而不是您的使用示例。

我不确定即将到来的[本机 json 支持](https://developer.mozilla.org/En/Using_JSON_in_Firefox)将如何影响这一点......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-27T19:13:34.027

尝试使用 JSPath - [https://github.com/dfilatov/jspath](https://github.com/dfilatov/jspath)。

JSPath 是一种特定于域的语言 (DSL)，它使您能够在 JSON 文档中导航和查找数据。使用 JSPath，您可以选择 JSON 项目以检索它们包含的数据。

JSON 的 JSPath 类似于 XML 的 XPath。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T15:48:31.523

Dojo's dojo.getObject has a facility that works **loosely** like this, where you can provide a path like "a.b.c" to the property you want to fetch.

Check it out:

[http://api.dojotoolkit.org/jsdoc/1.3/dojo.getObject](http://api.dojotoolkit.org/jsdoc/1.3/dojo.getObject)

I don't think it understands arrays quite that well and I think it is missing a full-featured selector language like the one you are suggesting.

As for usage, I've coded a selector language like the one you are suggesting, but for a client, and array addressing is very proprietary to their particular object structure.

I would *definitely* use a system like this if you were to make it, and perhaps even contribute if I saw an area I could help with.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-01-02T11:23:37.387

我刚刚编写了一个客户端 JS-lib 来执行此操作 - 它可以使用 XPath 查询 JSON 结构。

@jlarson - 使用“defiant.js”，您可以像这样查询您的 JSON 结构（这个库扩展了全局 JSON 对象）：

```
JSON.search( Characters, '//*[id="Banana"]' ); 
```

此调用将返回一个具有匹配节点的数组，并且这些匹配项不会与您的原始 JSON 对象分离（与使用 XML + XPath 时的行为相同）。为了说明我的意思，这里有一些伪（-ish）代码：

```
var store = {
    "book": [
        {
            "id": 1,
            "price": 8.95,
            "title": "Sayings of the Century",
            "category": "reference",
            "author": "Nigel Rees"
        },
        {
            "id": 2,
            "price": 22.99,
            "title": "The Lord of the Rings",
            "category": "fiction",
            "author": "J. R. R. Tolkien",
            "isbn": "0-395-19395-8"
         }
    ]
};

var b1 = JSON.search( store, '//book[1]' );
b1[0].isbn = '12345';

console.log( store.book[0].isbn );
// 12345 
```

到目前为止，该库适用于浏览器和客户端，但我计划最终为 NodeJS 重新编写它。在此处查看 Xpath 评估器；演示功能。还有预先编写的 Xpath 表达式：

[http://defiantjs.com/#xpath_evaluator](http://defiantjs.com/#xpath_evaluator)

您可以在 Github 上找到该库：
[https ://github.com/hbi99/defiant.js](https://github.com/hbi99/defiant.js)

最后，“defiant.js”中还有更多功能，如果您有兴趣，希望您可以在那里阅读它（[http://defiant.com](http://defiant.com)）

我希望你会发现它有用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-08-19T14:53:03.877

看起来有一个新选项： [jQuery-JSONPath](https://github.com/wilhelm-murdoch/jQuery-JSONPath)。似乎正是你所要求的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-17T06:34:06.447

不完全是您要查找的内容，但请查看[object-scan](https://github.com/blackflux/object-scan)。它有点冗长，但功能更强大，支持更多（复杂）用例。这是一个如何使用它的示例

```
// const objectScan = require('object-scan');

const Characters = [{ id: 'CuriousGeorge', species: 'Monkey', mood: 'curious', appendage: [{ type: 'hand', side: 'left', holding: [{ id: 'Banana' }] }, { type: 'hand', side: 'right', holding: [] }, { type: 'foot', side: 'left', holding: [] }, { type: 'foot', side: 'right', holding: [{ id: 'YellowHat' }, { id: 'Keys' }] }] }, { id: 'ManInYellowHat', species: 'Human', mood: 'angry' }];

console.log(objectScan(['**.holding.id'], {
  useArraySelector: false,
  abort: true,
  rtn: 'parent',
  filterFn: ({ value }) => value === 'Banana'
})(Characters));
// => { id: 'Banana' }

console.log(objectScan(['**.appendage[*]'], {
  rtn: 'value',
  filterFn: ({ value }) => value.type === 'hand' && value.side === 'left'
})(Characters));
// => [ { type: 'hand', side: 'left', holding: [ { id: 'Banana' } ] } ]
```

```
.as-console-wrapper {max-height: 100% !important; top: 0}
```

```
<script src="https://bundle.run/object-scan@13.7.1"></script>
```

*免责声明*：我是[对象扫描的作者](https://www.npmjs.com/package/object-scan)

请务必查看自述文件。里面有很多例子。

# sql - oracle编译查看sql

> ID：859039
> 
> 赞同：1
> 
> 时间：2009-05-13T16:39:49.093
> 
> 标签：sql, oracle, compiler-construction, ant

作为基于 ANT 的部署的一部分，我们针对 Oracle 数据库运行一些 sql。

`sql`如果发生任何错误，部署将设置为失败。（我们`WHENEVER SQLERROR EXIT FAILURE ROLLBACK`在我们的 SQL 文件中使用 ant`exec`命令`failonerror=true`来运行 sql）。

我们想在我们的部署 sql 文件中添加一些 sql，这些 sql 将编译（或重新编译）某些视图并在编译失败时部署失败。任何人都知道允许我们这样做的 sql（或其他）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T16:55:49.690

您需要做的不仅仅是“ALTER VIEW xxx COMPILE”吗？

# jquery - jQuery not working on Windows Server 2008, IIS 7

> ID：859059
> 
> 赞同：2
> 
> 时间：2009-05-13T16:44:55.200
> 
> 标签：jquery, asp.net-mvc

I am deploying an ASP.NET MVC to Windows Server 2008\. I have installed ASP.NET MVC 1, but jQuery is not working on any of the pages. Anyone had this problem?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T16:53:13.423

I suspect a problem with the path being used to load the scripts. Is your web site at the root or in a subdirectory on the server? See this question and see if the answers there don't help.

[jQuery library location wants to be referenced differently on server](https://stackoverflow.com/questions/730336/jquery-library-location-wants-to-be-referenced-differently-on-server)

# architecture - 通过扩展桌面 web-dev 应用程序创建专门的 CMS。选项？

> ID：859066
> 
> 赞同：1
> 
> 时间：2009-05-13T16:46:07.913
> 
> 标签：architecture, content-management-system, desktop, wysiwyg

## 背景

我们需要开发一个专门的 CMS（仅供内部使用）来支持技术写作团队为 Web 制作专门的长篇内容（即带有图片的文本、交互功能）。为了保护作者免受 Web 开发的细节影响（并提高输出的一致性），我们希望使用参数化占位符来增强常规的 WSIWYG html 编辑器，以用于更专业的内容（例如交互式页面元素）。占位符将通过单独的预发布过程扩展为 html/js/css/flash/etc。

内容生成是业务存在的理由，作者的生产力至关重要。如果我们使用基于网络的 CMS，作者会叛变，我敢肯定。

## 愿望清单

*   基本的 Web 开发设计表面
*   跨平台（mac/windows）
*   源代码控制集成
*   使用 GUI 添加/编辑占位符的能力
*   在设计图面上指示占位符的能力
*   能够将我们自己的报告构建到 UI 中（例如拼写检查）
*   离线编辑（例如在飞机上，在展会上）

## 到目前为止的选项

开箱即用的东西不太可能足够灵活。因此，我们很可能不得不扩展现有产品。为了获得离线功能和坚如磐石的编辑，我们正在考虑扩展桌面应用程序。到目前为止，这是我们的选择：

*   Dreameaver CS4（优点：熟悉，跨平台。缺点：[有限的扩展 api](http://help.adobe.com/en_US/Dreamweaver/10.0_Extending/WS5b3ccc516d4fbf351e63e3d117f53d5f9f-7ffe.html)）
*   Visual Studio（优点：良好的可扩展性。缺点：恐吓作家，Mac 用户将需要 VM）

请告诉我，我有比这更多的选择！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T09:43:37.960

您需要的是一个工具（不是 CMS，天哪！），它可以完成您愿望清单中的所有项目。我遇到了一个具有绝对可扩展性的优秀写作工具：

[Windows Live 作家](http://download.live.com/writer)

它适合您的物品愿望清单：

*   基本的 Web 开发界面
*   离线编辑

使用扩展点可以轻松添加愿望清单中的其他项目：

*   使用 GUI 添加/编辑占位符的能力（使用 SmartContentSource）
*   在设计图面上指示占位符的能力（如果您使用 SmartContentSource，应用程序支持此功能）
*   构建我们自己的报告的能力（如果不需要交互，请使用 ContentSource）

没有源代码控制集成，但该工具将每次写入保存到一个单独的文件中，然后可以由您最喜欢的源代码控制工具管理。

您的愿望清单中唯一没有的是 Mac 支持（当然，这可以通过使用虚拟化轻松“修复”）。

我有多年使用该工具的经验（据我所知，它是第一个测试版），相信我，这是您一直在寻找的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T23:44:25.517

Dreamweaver 或 Visual Studio 都不是 CMS。它们是工具。

您需要像[EPiServer](http://www.episerver.com) (.NET)、[AxCMS.net](http://www.axcms.net) (免费)、[Drupal](http://drupal.org) (php) 或[Wordpress](http://www.wordpress.org) (php)这样的 CMS

自定义 CMS 以满足您的需求是很正常的。CMS 只是一个框架。您将必须制作您需要的模板，并根据您的需要对其进行自定义。例如添加用于附加文档、flsah 文件或其他类型文件的字段。

所有 CMS 都有一个所见即所得的编辑器。许多人使用[tinyMCE](http://tinymce.moxiecode.com/)，这是一个非常好的编辑器。

我上面提到的所有 CMS 都可以满足您的愿望清单。

如果您想要快速简单的东西，请使用 Wordpress。我正在将那个用于我自己的网站[挪威时尚](http://www.norwegianfashion.no)。所有模板都是定制的。易于使用、易于设置且易于理解。

Drupal 是一个非常好的（而且免费的）CMS，但学习起来非常困难。

如果您熟悉 Microsoft 构建其模板系统的方式，那么我会使用由 MS 开发的 AxCMS，它是免费的。

EpiServer 是一个非常好的CMS。但是您必须为许可证支付至少 10.000 美元。

但是，当沃尔沃可以带您到达那里时，为什么要购买保时捷 :)

希望这对您有所帮助。祝您选择顺利。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T09:12:27.980

[Plone](http://plone.org)是非常可定制且易于使用的网络 CMS。它使用所见即所得的编辑器，但您也可以直接编辑 HTML，或者您可以使用 DreamWeaver 或 Emacs/Vi 等外部编辑器来编辑内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T14:25:47.570

我将这个问题解释为他想要一个独立的编辑器，作者可以在他们的工作站上运行，而不必使用 Web 界面来编写内容。

我对这个领域不太了解，但我使用过 Contribute（Adobe，是 Macromedia）。在 Mac 上并不完全稳定，但从未丢失任何数据 IIRC。我认为它可以做一些你想做的事情，包括离线工作，然后稍后上传到网站。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-23T11:52:01.913

这个问题放在 stackoverflow 上有点不公平，因为它与我们的特定需求密切相关（在我的辩护中，我想许多大型网络出版机构都面临着类似的决定）。

最后，我们采用了与 IDE 无关的设计，使用 xhtml 作为我们的交换格式，并使用频繁（n 分钟）的计划任务将创作的输入“构建”到可发布的输出中。

# mysql - Mysql Connections 在几秒钟内达到顶峰

> ID：859072
> 
> 赞同：1
> 
> 时间：2009-05-13T16:46:55.447
> 
> 标签：mysql, crash, load, performance

我有一个刚刚开始发生的奇怪问题。

我有一个小型集群（一个 web 和一个 db）设置，并且我托管了一个相当流行的 4 -5 个站点组，这些站点允许用户自动动态创建自己的移动聊天社区。每个站点都会自动创建和填充自己的 mysql 数据库。

这一切都很好，

但是在过去的 24 小时里，奇怪的事情开始发生了，以前我将 sql max_connections 设置为 500，这对于需求来说是完全合适的，但现在即使我将连接设置为 4000+，它们都会在 5-10 分钟内被最大化， mysql processlist 显示数千个处于登录状态的未经身份验证的用户连接，

我浏览了这些网站，他们所有的 mysql 配置都很好，所以我看不出问题出在哪里。

服务器规格如下

数据库服务器：

*   双 AMD 皓龙 246
*   8GB 内存
*   120gb 高清（64gb 免费）
*   33gb 交换（很少使用，但用于紧急情况）
*   centos 5 64位。
*   将 100mbit 局域网直接连接到网络服务器

只运行 mysql、ssh 和 webmin，没有安装其他应用程序

网络服务器：

*   AMD速龙64 3800+
*   plesk 9.2.1
*   4GB内存
*   2x120gb 高清

Web 服务器上的 apache 状态仅显示 120 个 http 连接，但 sql 不断攀升

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T17:14:03.140

如果绝对没有其他任何变化，也许有人正试图攻击您的网站？

看看您是否可以找到虚假连接来自哪些 IP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T10:24:07.177

发现了问题，由于某种原因mysql决定开始尝试dodns查找连接，不知道为什么，但是在将skip-name-resolve添加到my.cnf之后现在似乎已经解决了

# c# - LIKE 查询中使用的包含“'”（撇号）的参数的设置值

> ID：859080
> 
> 赞同：2
> 
> 时间：2009-05-13T16:49:13.790
> 
> 标签：c#, asp.net, sql-server

我在 ASP.NET/C# 代码中有以下查询，它无法使用参数返回任何值...

```
select * from MyTable where MyTable.name LIKE @search 
```

我尝试了以下查询替代方法来在 SQL 命令中设置此参数...

```
select * from MyTable where MyTable.name LIKE  %@search%
select * from MyTable where MyTable.name LIKE '%' + @search + '%'
select * from MyTable where MyTable.name LIKE '%@search%' 
```

并通过api...

```
myCmd.Parameters.AddWithValue("@search", search);
myCmd.Parameters.AddWithValue("@search", "%" + search + "%");
myCmd.Parameters.AddWithValue("@search", "%'" + search + "'%"); 
```

这些都不起作用。

我使用的搜索参数在其文本中包含单引号，我认为这让事情变得更加尴尬。我相信我正确地转义了参数，因为如果我构造一个直接使用该值的查询，而不是像这样通过参数...

```
select * from MyTable where MyTable.name LIKE '%MyValue''ToSearchForWith''Quotes%' 
```

这样可行。从我所看到的情况来看，在查询中使用单引号所需要做的就是将它们加倍。我没有看到任何错误，所以我假设我已经正确了。所以最坏的情况我有一个解决方案，但我想通过 api 设置搜索值，因为我相信这是更好的做法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T16:57:46.897

`search`我认为问题在于当 SQL 参数为您执行此操作时，您正在转义参数中的引号。

百分号应*在*SQL 参数值内；您的查询只是简单地引用了参数。SQL 应如下所示：

```
select * from MyTable where MyTable.name LIKE @search 
```

代码应如下所示：

```
string search = "MyValue'ToSearchForWith'Quotes";
myCmd.Parameters.AddWithValue("@search", "%" + search + "%"); 
```

请注意，这`search`是*原始*值，而不是转义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T16:57:52.090

在 SQL 方面，这是正确的：

```
select * from MyTable where MyTable.name LIKE '%' + @search + '%' 
```

如果参数是从外部传入的，则它是否包含单引号无关紧要。

在 API 方面，这应该是正确的：

```
myCmd.Parameters.AddWithValue("@search", "%" + search + "%"); 
```

AddWithValue() 方法为您完成所有必要的转义，无需干预。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T16:54:44.483

在 t-sql 中，您使用两个转义 '：''

@query='这不会导致问题'

# demoscene - 如何学习 4K 解码的疯狂艺术？

> ID：859082
> 
> 赞同：28
> 
> 时间：2009-05-13T16:49:40.093
> 
> 标签：demoscene

我非常喜欢演示场景，尤其是那些小的 4K exefiles。除了已经在 Windows 中找到的文件之外，它们没有任何依赖关系，它们展示了编程的强大功能：3D 图形 + 声音，全部为 4K。

这怎么可能？他们使用的是什么语言？贸易工具、最佳实践和重要网站有哪些？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-13T17:08:05.007

与此同时，我发现了一个处理 4K 编码的好网站：

## [IN4K](http://wikiindex.org/IN4K)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-13T16:59:50.043

压缩算法显然具有重要意义，索引大量数据的简短机制和对目标系统上可用库的深入了解也是如此。（那些东西可以链接进去。）

如果我是你，我会先对你最喜欢的 4k 演示进行逆向工程；也许从 7 到 10 年前的那些开始，并随着它的进步而努力追随最先进的技术。分析编译器的输出也是一个很好的起点，尽管它们倾向于优化速度而不是空间。

鉴于嵌入式编程技术经常受到限制，它们也可能会有所帮助。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-15T16:07:41.593

[Inigo Quilez](http://iquilezles.org/www/material/isystem1k4k/isystem1k4k.htm)有一些 1K 和 4K 介绍的例子。你可以从他们身上学到很多东西。也看看他的其他文章。

Alexander Sotirov关于[Tiny PE的文章也很有趣。](http://www.phreedom.org/research/tinype/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-13T17:01:39.963

可能不是您正在寻找的东西，但本着同样的精神：有几个 Java 4k 竞赛。目标是创建一个完全适合最大 4096 字节的单个 JAR 的 Java 演示甚至游戏（！）。

参见例如

[http://www.mojang.com/notch/j4k/l4kd/](http://www.mojang.com/notch/j4k/l4kd/)

或者

[http://javaunlimited.net/contests/java4k.php](http://javaunlimited.net/contests/java4k.php)

有人可能会争辩说 Java 让它变得更容易（因为您可以使用整个运行时），但它仍然令人印象深刻（而且您是跨平台的，不需要学习汇编程序；））。

# screen - 如何获取浏览器的内容，包括窗口的菜单栏、框架/边框和首屏内容？

> ID：859094
> 
> 赞同：-2
> 
> 时间：2009-05-13T16:51:14.537
> 
> 标签：screen, capture, dump

我记得在网络的早期，有书籍包括整个浏览器窗口的标题栏、菜单栏，甚至浏览器的边框，以及其中的内容——不仅仅是窗口中的当前内容，但即使向下滚动也会显示所有内容）。

我也希望能够做到这一点......有没有一种简单的方法可以编写 Win32 或 Mac 应用程序来做到这一点，或者作为 Firefox 扩展（附加组件）？

（浏览器菜单栏和书签栏可以是真的也可以是假的——不需要在书签栏上显示我的个人书签）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T19:15:13.303

您可以使用 Firefox 的[FireShot](https://addons.mozilla.org/en-US/firefox/addon/5648)扩展，然后使用 Microsoft 的 Paint 和 Alt-PrtScr 添加周围的 chrome。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T19:27:20.053

您可以使用Cocoa的[Webkit 框架](http://developer.apple.com/documentation/Cocoa/Conceptual/DisplayWebContent/index.html)在 OS X 端编写这样的应用程序。

Windows 上的 .NET 有它自己的[WebBrowser 和 WebBrowserBase 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)，它提供了一个可编程的浏览器，比如小部件。查看 WebBrowserBase 类的[DrawToBitmap](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowserbase_methods.aspx)方法。

还有几个应用程序已经这样做了。

对于 Mac OS X，有[Paparazzi](http://derailer.org/paparazzi/)和[Little Snapper](http://www.realmacsoftware.com/littlesnapper/)可以做你想做的事。

对于 Windows，请检查[SiteShoter](http://www.nirsoft.net/utils/web_site_screenshot.html)和[Webshot](http://www.websitescreenshots.com/)。

# javascript - 有没有办法确定点击了哪个 Google Map Marker？

> ID：859099
> 
> 赞同：5
> 
> 时间：2009-05-13T16:52:17.810
> 
> 标签：javascript, google-maps, google-maps-markers

以下代码循环遍历 json 对象以在谷歌地图上放置标记。哪个工作正常。

```
function displayMarkers(data){
    for(var i = 0; i < data.Lat.length; i++){
        var point = new GLatLng(data.Lat[i],data.Lng[i]);
        marker = new GMarker(point);
        map.addOverlay(marker);

            // here's the problem
        GEvent.addListener(marker, "click", function(){
            alert(data.Name[i]);
        });
    }
} 
```

问题是，每个标记总是以“i”的最后一个值响应。我一直在试图找出一种方法来识别已单击的标记，以便以某种方式从数据对象中获取正确的信息。

我正在考虑在创建时创建一组标记以根据标记位置循环，但这对我来说效率很低。

任何帮助，一如既往，非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T17:17:26.847

地图的[点击事件](http://code.google.com/apis/maps/documentation/reference.html#GMap2.click)传递了三个不同的元素。

```
GEvent.addListener(map, "click", function(overlay, latlng, overlaylatlng) {
  // overlay = GOverlay or null
  // latlng = GLatLng
  // overlaylatlng = GLatLng or null
}); 
```

如果用户没有点击覆盖，'overlay' 和 'overlaylatlng' 将为空。

**更新：**如果您想从中获得 GOverlay，则必须将侦听器添加到地图（而不是标记）。[GMarker](http://code.google.com/apis/maps/documentation/reference.html#GMarker.click)的单击事件仅返回 GLatLng。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-21T17:16:50.197

Map 支持 onTap 事件，它传递被选中的标记的索引，请参考[这个](http://www.androidguys.com/2008/09/09/maps-itemizedoverlay-and-you/)例子：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T12:40:35.943

似乎上述解决方案仅返回标记的坐标，这并不能解决我的问题。也许我做错了什么。

但是，我解决它的方法是像这样简单地向标记添加一个属性

 ~~~~```
function createMarker(latlng,name) {
      var marker = new GMarker(latlng);

      // HERE WE GO
      marker.value = name;

      GEvent.addListener(marker,"click", function() {
        addToList(this.value);
      });
      return marker;
} 
```~~ 

~~**更新：以上方法解决了它，但更简单的方法是将事件附加到地图上，如评论中所述**~~

 ~~```
GEvent.addListener(map, "click", function(marker, point){
    alert(marker);
}); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-13T17:05:32.623

像馅饼一样简单。

```
 GEvent.addListener(marker, "click", function(o){
            alert(o);
    }); 
```

# iphone - iPhone OS 中的标签栏有多高？

> ID：859105
> 
> 赞同：5
> 
> 时间：2009-05-13T16:53:58.900
> 
> 标签：iphone, cocoa-touch, uikit

我试图获取该信息，但谷歌对此一无所获。有人确切地知道吗？我记得大约 40 个单位的值，但我不确定。UICatalog.xcodeproj 的 Constants.h 没有提及。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-13T17:25:06.367

如果您的意思是高度，那么它是**49 px**。

为了找到这个，我进入 Interface Builder，创建了一个空白视图，然后设置 Simulated Metrics -> Bottom Bar -> Tab Bar 并记下视图的新尺寸（320x431）。

480 - 431 = 49 像素

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-20T14:16:17.287

你也可以放下一个

```
 NSLog(@"Tab Bar dimensions : %@", NSStringFromCGRect(yourTabBarController.tabBar.frame)); 
```

要在分配 UITabBarController 的任何位置查看包含 {{x, y}, {width, height}} 的字符串。不过你会得到 49，也许这是矫枉过正。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-29T20:53:39.383

如果你和我一样，不喜欢硬编码这些东西，试试：

```
UITabBarController *tabBar = [[UITabBarController alloc] init];
tabBarHeight = tabBar.tabBar.frame.size.height; 
```

我将第一行放在实用程序类中（在应用程序启动时初始化），然后访问 tabBarHeight。

# java - 如何在特定连接上使用不同的证书？

> ID：859111
> 
> 赞同：170
> 
> 时间：2009-05-13T16:54:44.687
> 
> 标签：java, ssl, keystore, truststore, jsse

我要添加到我们的大型 Java 应用程序中的一个模块必须与另一家公司的 SSL 安全网站进行对话。问题是该站点使用自签名证书。我有一份证书副本以验证我没有遇到中间人攻击，我需要将此证书合并到我们的代码中，以便与服务器的连接成功。

这是基本代码：

```
void sendRequest(String dataPacket) {
  String urlStr = "https://host.example.com/";
  URL url = new URL(urlStr);
  HttpURLConnection conn = (HttpURLConnection)url.openConnection();
  conn.setMethod("POST");
  conn.setRequestProperty("Content-Length", data.length());
  conn.setDoOutput(true);
  OutputStreamWriter o = new OutputStreamWriter(conn.getOutputStream());
  o.write(data);
  o.flush();
} 
```

如果没有对自签名证书进行任何额外的处理，这将在 conn.getOutputStream() 处死掉，但有以下例外：

```
Exception in thread "main" javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
....
Caused by: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
....
Caused by: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target 
```

理想情况下，我的代码需要教 Java 接受这个自签名证书，用于应用程序中的这一点，而不是其他任何地方。

我知道我可以将证书导入 JRE 的证书颁发机构存储区，这将允许 Java 接受它。如果我能提供帮助，那不是我想采取的方法。在我们所有客户的机器上为他们可能不使用的一个模块进行操作似乎非常具有侵入性；它会影响使用相同 JRE 的所有其他 Java 应用程序，即使任何其他 Java 应用程序访问该站点的可能性为零，我也不喜欢这样。这也不是一个简单的操作：在 UNIX 上，我必须获得访问权限才能以这种方式修改 JRE。

我还看到我可以创建一个 TrustManager 实例来进行一些自定义检查。看起来我什至可以创建一个 TrustManager，它在除此证书之外的所有实例中都委托给真正的 TrustManager。但是看起来 TrustManager 是全局安装的，我想这会影响我们应用程序的所有其他连接，这对我来说也不太合适。

设置 Java 应用程序以接受自签名证书的首选、标准或最佳方式是什么？我能完成上面提到的所有目标，还是不得不妥协？是否有涉及文件和目录以及配置设置以及几乎没有代码的选项？

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2009-05-13T17:22:48.710

自己创建一个`SSLSocket`工厂，并`HttpsURLConnection`在连接之前设置它。

```
...
HttpsURLConnection conn = (HttpsURLConnection)url.openConnection();
conn.setSSLSocketFactory(sslFactory);
conn.setMethod("POST");
... 
```

你会想要创建一个`SSLSocketFactory`并保留它。这是如何初始化它的草图：

```
/* Load the keyStore that includes self-signed cert as a "trusted" entry. */
KeyStore keyStore = ... 
TrustManagerFactory tmf = 
  TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
tmf.init(keyStore);
SSLContext ctx = SSLContext.getInstance("TLS");
ctx.init(null, tmf.getTrustManagers(), null);
sslFactory = ctx.getSocketFactory(); 
```

如果您在创建密钥库时需要帮助，请发表评论。

* * *

这是加载密钥库的示例：

```
KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());
keyStore.load(trustStore, trustStorePassword);
trustStore.close(); 
```

要使用 PEM 格式证书创建密钥库，您可以使用 编写自己的代码`CertificateFactory`，或者只是`keytool`从 JDK 导入它（keytool*不适*用于“密钥条目”，但适用于“受信任条目” ）。

```
keytool -import -file selfsigned.pem -alias server -keystore server.jks 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-12-30T16:57:41.990

我在网上阅读了很多地方来解决这个问题。这是我为使其工作而编写的代码：

```
ByteArrayInputStream derInputStream = new ByteArrayInputStream(app.certificateString.getBytes());
CertificateFactory certificateFactory = CertificateFactory.getInstance("X.509");
X509Certificate cert = (X509Certificate) certificateFactory.generateCertificate(derInputStream);
String alias = "alias";//cert.getSubjectX500Principal().getName();

KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
trustStore.load(null);
trustStore.setCertificateEntry(alias, cert);
KeyManagerFactory kmf = KeyManagerFactory.getInstance("SunX509");
kmf.init(trustStore, null);
KeyManager[] keyManagers = kmf.getKeyManagers();

TrustManagerFactory tmf = TrustManagerFactory.getInstance("X509");
tmf.init(trustStore);
TrustManager[] trustManagers = tmf.getTrustManagers();

SSLContext sslContext = SSLContext.getInstance("TLS");
sslContext.init(keyManagers, trustManagers, null);
URL url = new URL(someURL);
conn = (HttpsURLConnection) url.openConnection();
conn.setSSLSocketFactory(sslContext.getSocketFactory()); 
```

app.certificateString 是一个包含证书的字符串，例如：

```
static public String certificateString=
        "-----BEGIN CERTIFICATE-----\n" +
        "MIIGQTCCBSmgAwIBAgIHBcg1dAivUzANBgkqhkiG9w0BAQsFADCBjDELMAkGA1UE" +
        "BhMCSUwxFjAUBgNVBAoTDVN0YXJ0Q29tIEx0ZC4xKzApBgNVBAsTIlNlY3VyZSBE" +
        ... a bunch of characters...
        "5126sfeEJMRV4Fl2E5W1gDHoOd6V==\n" +
        "-----END CERTIFICATE-----"; 
```

我已经测试过你可以在证书字符串中放入任何字符，如果它是自签名的，只要你保持上面的确切结构。我使用笔记本电脑的终端命令行获得了证书字符串。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-11-02T10:06:24.790

如果创建 a`SSLSocketFactory`不是一个选项，只需将密钥导入 JVM

1.  检索公钥： `$openssl s_client -connect dev-server:443`，然后创建一个文件*dev-server.pem*，看起来像

    ```
    -----BEGIN CERTIFICATE----- 
    lklkkkllklklklklllkllklkl
    lklkkkllklklklklllkllklkl
    lklkkkllklk....
    -----END CERTIFICATE----- 
    ```

2.  导入密钥：`#keytool -import -alias dev-server -keystore $JAVA_HOME/jre/lib/security/cacerts -file dev-server.pem`. 密码：*changeit*

3.  重启 JVM

资料来源：[如何解决 javax.net.ssl.SSLHandshakeException？](http://wsigrid.blogspot.jp/2008/12/how-to-solve-javaxnetsslsslhandshakeexc.html)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-13T17:17:23.697

我们复制 JRE 的信任库并将我们的自定义证书添加到该信任库，然后告诉应用程序使用具有系统属性的自定义信任库。这样我们就可以单独保留默认的 JRE 信任库。

缺点是当您更新 JRE 时，您的新信任库不会自动与您的自定义信任库合并。

您可以通过安装程序或启动例程来验证信任库/jdk 并检查不匹配或自动更新信任库来处理这种情况。我不知道如果您在应用程序运行时更新信任库会发生什么。

该解决方案不是 100% 优雅或万无一失，但它简单、有效且不需要代码。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-05-13T17:25:22.593

当使用 commons-httpclient 访问带有自签名证书的内部 https 服务器时，我不得不做这样的事情。是的，我们的解决方案是创建一个简单地传递所有内容的自定义 TrustManager（记录调试消息）。

这归结为拥有我们自己的 SSLSocketFactory，它从我们的本地 SSLContext 创建 SSL 套接字，它被设置为只有我们的本地 TrustManager 与之关联。您根本不需要靠近密钥库/证书库。

所以这是在我们的 LocalSSLSocketFactory 中：

```
static {
    try {
        SSL_CONTEXT = SSLContext.getInstance("SSL");
        SSL_CONTEXT.init(null, new TrustManager[] { new LocalSSLTrustManager() }, null);
    } catch (NoSuchAlgorithmException e) {
        throw new RuntimeException("Unable to initialise SSL context", e);
    } catch (KeyManagementException e) {
        throw new RuntimeException("Unable to initialise SSL context", e);
    }
}

public Socket createSocket(String host, int port) throws IOException, UnknownHostException {
    LOG.trace("createSocket(host => {}, port => {})", new Object[] { host, new Integer(port) });

    return SSL_CONTEXT.getSocketFactory().createSocket(host, port);
} 
```

连同其他实现 SecureProtocolSocketFactory 的方法。LocalSSLTrustManager 是前面提到的虚拟信任管理器实现。

# wcf - 将多个文件发送到 WCF 服务的最佳方式是什么？

> ID：859112
> 
> 赞同：8
> 
> 时间：2009-05-13T16:54:50.927
> 
> 标签：wcf, web-services

我们正在创建一个 WCF 服务，该服务需要 2-4 个图像文件（每个大约 2k-5k 小）作为输入参数发送给它，以及大约 6 个文本字段参数。发回的数据仅包含几个文本值。

我知道可以将单个文件作为流发送，但不确定如何发送多个文件。

在这种情况下，客户将是第 3 方，我们希望尽可能简单地与我们的 WCF 服务进行交互。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-13T23:05:05.157

可能有很多方法可以做到这一点，但这是我的想法。*请注意，我只是包含了任意数量的字符串，您可以根据需要添加/删除。*

首先，您需要某种“输入”对象，该对象将传递给您的 WCF 服务，其中包含您的图像和字符串值。注意 Images 属性是一个字节数组；这样您就可以包含多个图像。

```
[DataContract]
public class InputObject
{
    [DataMember]
    public byte[][] Images { get; set; }

    [DataMember]
    public string FirstValue { get; set; }

    [DataMember]
    public string SecondValue { get; set; }
} 
```

接下来，您需要一个 WCF 服务将返回的对象...

```
[DataContract]
public class ReturnObject
{
    [DataMember]
    public string FirstValue { get; set; }

    [DataMember]
    public string SecondValue { get; set; }
} 
```

您的 ServiceContract 将如下所示。

```
[ServiceContract]
public interface IService1
{
    [OperationContract]
    ReturnObject UploadData ( InputObject input );
} 
```

你的服务类是这样的。

```
public class Service1 : IService1
{
    public ReturnObject UploadData ( InputObject input )
    {
        // Do your thing with InputObject data

        ReturnObject returnObject = new ReturnObject
                                        {
                                            FirstValue = "MyFirstValue" ,
                                            SecondValue = "MySecondValue"
                                        };

        return returnObject;
    }
} 
```

您需要确保您的服务绑定适用于发送图像数据，因此增加一些默认限制是合适的。这是我的服务配置中的示例绑定。

```
<wsHttpBinding>
  <binding name="Service1Binding" maxReceivedMessageSize="1000000">
    <readerQuotas maxArrayLength="1000000"
                  maxBytesPerRead="1000000"
                  maxDepth="1000000"
                  maxNameTableCharCount="1000000"
                  maxStringContentLength="1000000"/>
  </binding>
</wsHttpBinding> 
```

确保将其指定为服务的 bindingConfiguration。

```
<endpoint address="" 
          binding="wsHttpBinding" 
          contract="WcfService5.IService1" 
          bindingConfiguration="Service1Binding"> 
```

现在您需要做的就是从您的客户的服务中引用它并调用它。

```
var images = new byte[2][];
images[0] = System.IO.File.ReadAllBytes( @"D:\Development\TestImage.bmp" );
images[1] = System.IO.File.ReadAllBytes( @"D:\Development\TestImage.jpg" );

var input = new InputObject
                {
                    Images = images ,
                    FirstValue = "MyFirstValue" ,
                    SecondValue = "MySecondValue"
                };

var client = new Service1Client();
client.UploadData( input ); 
```

希望这可以帮助你...

# content-management-system - 打击乐内容管理系统是否可定制（以编程方式）？

> ID：859115
> 
> 赞同：1
> 
> 时间：2009-05-13T16:55:08.977
> 
> 标签：content-management-system

只是想知道是否有人最近有在 Percussion CMS 环境中编程的经验。它是否非常“锁定”，或者当您发现默认管理设置无法帮助实现某种类型的功能时，您是否可以访问源代码文件和/或数据库并真正让它做您想做的事情？有 API 吗？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T03:09:12.940

Percussion CMS (Percussion CM) 提供 Web 服务/SOAP 端点 ( [http://goo.gl/NdDvi](http://goo.gl/NdDvi) )，您可以调用这些端点来执行通常通过提供的用户界面执行的所有功能。除了 Web 服务之外，开发人员还可以创建 Java 和 JavaScript 扩展，允许内容项、内容项字段、发布运行时和模板在出厂默认值之外得到增强 ( [http://goo.gl/Rda5u](http://goo.gl/Rda5u) )。

请通读帮助网站[http://help.percussion.com/cmsystem/index](http://help.percussion.com/cmsystem/index)以全面了解 Percussion CMS 如何作为解耦的内容管理系统运行。

另请注意，有一个 Percussion CM1 不提供相同的可扩展性。

# syntax - F# 语句的语义

> ID：859117
> 
> 赞同：1
> 
> 时间：2009-05-13T16:55:29.270
> 
> 标签：syntax, f#, function, semantics, currying

有人可以向我描述这个 F# 表达式吗？

```
val augment: GameGrid -> points -> unit 
```

`val`关键字是什么意思？

**`type -> type`**通常表示返回指定类型的函数是真的吗？那么是否**`type -> type -> type`**表示一个函数返回一个返回指定类型的函数呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T17:01:42.757

（“val”位不是表达式；我认为它可以出现在三种不同的上下文中：

*   FSI（F# 交互式 REPL）的输出，描述推断的绑定类型
*   在签名 (.fsi) 文件中，描述让绑定模块值的类型
*   在结构/类定义（“显式”语法）中，定义实例变量

这些都不是技术上的表达上下文。）

至于类型，确实

```
A1 -> A2 -> R 
```

表示一个接受 A1 并返回一个接受 A2 并返回 R 的函数的函数。参数是 curried 的，你可以好好阅读一下，例如

[F# 函数类型：元组和柯里化的乐趣](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!169.entry)

其中更详细地描述了柯里化和部分应用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T17:02:49.120

你是怎么得到这个输出的？在 FSI？

Val 只是表示一个值的定义。

例如，如果您在 C# 中编写了以下内容

```
private void Foo(int i); 
```

你会用 F# 写这个

```
val Foo : int -> unit 
```

关于`type -> type -> type`：这是一个有两个参数（类型）返回“类型”的函数

例如

```
let plus a b = a + b 
```

有签名`int -> int -> int`。

您对返回函数的函数的想法实际上是正确的。这是许多函数式语言中一种非常有趣的技术，称为[柯里化](http://en.wikibooks.org/wiki/F_Sharp_Programming/Higher_Order_Functions#Currying_and_Partial_Functions)

# asp.net-mvc - 书呆子晚餐控制器

> ID：859119
> 
> 赞同：0
> 
> 时间：2009-05-13T16:55:31.017
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, nerddinner

在本页面：

[http://nerddinnerbook.s3.amazonaws.com/Part4.htm](http://nerddinnerbook.s3.amazonaws.com/Part4.htm)

添加控制器后，我可以浏览`http://localhost:xxxx/dinners`并按预期工作。我的问题是它怎么知道使用“晚餐”？“晚餐”在哪里？我的控制器被命名为 DinnersController，所以 Dinners 这个词是如何变得有意义的。我在我的 Linq to SQL 或其他任何地方都没有看到它。我确定我忽略了一些明显的东西。

这是代码：

> ```
>  //
>         // HTTP-GET: /Dinners/
> 
>         public void Index()
>         {
>             Response.Write("<h1>Coming Soon: 
> ```
> 
> 晚餐"); }
> 
> ```
>  //
>         // HTTP-GET: /Dinners/Details/2
> 
>         public void Details(int id)
>         {
>             Response.Write("<h1>Details DinnerID: 
> ```
> 
> " + id + ""); }

“晚饭”从何而来？

感谢您的任何帮助。

编辑：在发布并看到 global.asax 之前，我在文章中进一步阅读，但我不明白它是如何映射到晚餐的：

```
 public class MvcApplication : System.Web.HttpApplication
    {
        public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            routes.MapRoute(
                "Default",                                              // Route name
                "{controller}/{action}/{id}",                           // URL with parameters
                new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
            );

        }

        protected void Application_Start()
        {
            RegisterRoutes(RouteTable.Routes);
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T16:57:26.147

ASP.NET MVC 倾向于约定优于配置。这意味着它将查找带有 Controller 后缀的控制器，并且不将其包含在 URL 中，并且仅包含 Controller 的前缀。因此，如果你有 HomeController，你可以访问 /Home/，就像 DinnersController 的意思是 /Dinners/。这是 ASP.NET MVC 框架本身的一部分。

如果您查看 Global.asax 中的默认路由，您会发现它使用的 URL 格式看起来像......

```
"{controller}/{action}/{id}" 
```

这意味着获取控制器的名称和操作的名称并将请求指向该方法。

所以对于 DinnersController Index 操作方法，它看起来像 /Dinners/Index。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T16:58:42.153

我面前没有示例，但我怀疑路由（请参阅 参考资料`Global.asax`）设置为`Dinners`用作默认控制器名称；负责的具体线路看起来像

```
new { controller = "Dinners", action = "Index", id = "" } 
```

**编辑：**重新阅读问题，这并不能完全回答它；您感到困惑的问题是`/dinners`已解决`DinnersController`；不是任何默认行为。对于这种情况，乍得的回答是正确的，正如你所说 - 框架基本上切断了`Controller`部分并计算出要映射的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T17:01:25.267

这是 MVC 通过其默认路由为您提供的“隐式配置”（约定与配置）的一部分。

当您转到“www.mysite.com/dinners”时，MVC 将自动在 URL 中看到“dinners”，并会查找名为“DinnersController”的控制器并调用“Index”方法。如果您访问“www.mysite.com/dinners/details”，MVC 将查找“DinnersController”并调用“Details”方法。

如果您查看 ruby​​ on rails，它的行为方式大致相同（几乎可以肯定，这就是 Microsoft 的来源）。

# subsonic - 如何在 SubSonic 中执行表 UNION

> ID：859126
> 
> 赞同：1
> 
> 时间：2009-05-13T16:56:41.390
> 
> 标签：subsonic

我有一个在两个表之间执行 UNION 的查询。我正在尝试用 SubSonic 实现相同的功能。我有两个相关的问题：

*   执行联合的 SubSonic 语法是什么。
*   如何重命名列。假设 UNION 将需要匹配两个表之间的列名

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T17:32:43.063

SubSonic 中没有 UNION 语法。[您可以使用此处](https://web.archive.org/web/20090321074429/http://forums.subsonicproject.com/forums/t/3684.aspx)讨论的内联查询，例如

```
MyTableCollection MyTable = new InlineQuery().ExecuteAsCollection<MyTableCollection>(
    “SELECT Col1,Col2 FROM TableA Union SELECT Col1,Col2 FROM TableB"); 
```

我发现的最佳解决方案是在视图中实现 UNION，然后让 SubSonic 为该视图生成模型。

# mysql - 连接池struts2+hibernate+mysql+tomcat+eclipse

> ID：859132
> 
> 赞同：0
> 
> 时间：2009-05-13T16:57:01.123
> 
> 标签：mysql, hibernate, connection, struts2, pooling

我一直难以掌握连接池的技术实现细节。我已经阅读了很多相关文章，例如[这篇](http://dev.mysql.com/tech-resources/articles/connection_pooling_with_connectorj.html) 和[这篇](http://tomcat.apache.org/tomcat-6.0-doc/jndi-datasource-examples-howto.html#Database%20Connection%20Pool%20(DBCP)%20Configurations)，但仍然不是 100% 清楚。连接池是否与 tomcat、mysql 或其他开发框架（struts2、spring、hibernate）相关联？我的意思是这些框架中的每一个都需要特殊处理才能与 cp 一起使用，还是我只实现一次就可以使用我想要的任何框架？

是否有一个简单的示例涉及与上述所有框架的连接池？

先感谢您。

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T17:07:31.373

长期以来，连接池的趋势是大多数需要/使用它的框架倾向于直接开箱即用，或者至少它通常包含在基本设置指南中。每个框架都不需要做连接池，例如我不相信 struts2 做任何事情，而 spring-core 没有。我当然相信 spring dataaccess-stuff 确实如此，如果您通过 spring 进行数据访问，它可能记录在基本设置指南中。

# html - 哪个 CSS 属性（如果有）会控制这个？

> ID：859134
> 
> 赞同：1
> 
> 时间：2009-05-13T16:57:03.480
> 
> 标签：html, css

我有以下列表：

[替代文字 http://img210.imageshack.us/img210/2912/12922833.jpg](http://img210.imageshack.us/img210/2912/12922833.jpg)

如何让第四个项目的文本环绕，但缩进与列表的其余部分相同？是否有一些 CSS 属性可以控制这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T16:59:01.340

尝试[`list-style-position`](http://www.htmlhelp.com/reference/css/classification/list-style-position.html)：

```
li {
  list-style-position: outside;
} 
```

正如[ricebowl](https://stackoverflow.com/users/82548/ricebowl)记得评论的那样，您可能需要增加左边距或填充以使项目符号点“保持原样”，因为项目符号点不是在内部`<li>`，而是放在外部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T17:02:19.930

如果它是一个真实的列表，那应该是默认值，但无论如何都要按照 Henrik 所说的去做。

如果它不是一个真实的清单，而你只是在其中贴上子弹的图像......那么......那会稍微难一些。理想情况下，您会使用适当的列表 ( `<ul><li>list item</li></ul>`)

如果它是子弹的图像，您可以使用填充和绝对定位。如果它是一个用于子弹的 HTML 字符，那你就完蛋了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T17:03:20.833

不知道你在问什么，我假设你希望它看起来像你上面有它。因为默认情况下它不应该是那样的。

下面的代码示例将使它看起来像您的图像：

```
<style type="text/css">
    ul {
        width: 200px;
        padding: 0px;
        margin: 0px;
    }
    ul li {
        padding-left: 5px;
        text-indent: 20px;
    }
</style>

<ul>
    <li>text</li>
    <li>text text text text text text text text text text text text text text text text text text </li>
    <li>text </li>
</ul> 
```

这段代码将使它看起来像您的要求：

```
<style type="text/css">
    ul {
        width: 200px;
    }
</style>

<ul>
    <li>text</li>
    <li>text text text text text text text text text text text text text text text text text text </li>
    <li>text</li>
</ul> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-13T17:01:26.377

```
 ul li { padding-left: 25px; } 
```

# sql - 高级 SQL GROUP BY 查询

> ID：859142
> 
> 赞同：3
> 
> 时间：2009-05-13T16:58:07.347
> 
> 标签：sql, sql-server

我的项目表“Category”、“Category2”中有两列，这两列包含基本相同的信息。如果我设计了数据库，我会为类别创建一个单独的表，并根据该表将项目添加到类别中，不幸的是我没有创建数据库，我现在无法更改它，但我认为仍然存在做我想做的事的方法。

该表的示例如下所示

```
Category             Category2
------------------   -----------------
truck                full size - pickup
full size - pickup   truck
Sedan                Import - Sedan
Convertible          Domestic - Coupe 
```

我想运行一个查询来计算卡车、轿车、全尺寸皮卡等的总数。我尝试了下面的查询，但它分别将两列分组

```
SELECT Category, Count(*) as Count
FROM Items
GROUP BY Category, Category2 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-13T17:04:27.807

只需在分组之前将两个类别都转储到一个列中。

```
SELECT Category, Count(*) as TheCount
FROM
(
  SELECT Category1 as Category
  FROM Items
  UNION ALL
  SELECT Category2
  FROM Items
) sub
GROUP BY Category 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-13T17:05:27.303

想象一下，可以将带有“category, category2”的一行转换为两行（一行带有“category”，一行带有“category2”）以获得您想要的。你会这样做：

```
SELECT items.category /* , other columns... */
FROM items
UNION ALL
SELECT items.category2 /* , other columns... */
FROM items 
```

因此，您需要做的就是汇总这些：

```
SELECT category, count(*) FROM (
    SELECT items.category FROM items
    UNION ALL
    SELECT items.category2 FROM items
    ) expanded
GROUP BY category 
```

如果您的数据库支持，您也可以像这样分阶段进行聚合：

```
with subcounts as (
  select items.category, items.category2, count(*) as subcount
  from items
  group by category, category2)
select category, sum(subagg) as finalcount from (
  select subcounts.category, sum(subcount) as subagg from subcounts group by category
  union all
  select subcounts.category2, sum(subcount) as subagg from subcounts group by category2
) combination
group by category 
```

这将限制为仅对主要项目表进行一次扫描，如果您只有少量类别则很好。您可以使用不支持“WITH ...”的数据库中的临时表来模拟相同的事情

编辑：

我确信必须有另一种方法来做到这一点，而无需两次扫描项目，而且确实存在。好吧，这是 PostgreSQL 版本：

```
SELECT category, count(*) FROM (
  SELECT CASE selector WHEN 1 THEN category WHEN 2 THEN category2 END AS category
  FROM Items, generate_series(1,2) selector
) items_fixed GROUP BY category 
```

这里唯一特定于 postgresql 的位是“generate_series(1,2)”，它产生一个包含两行的“表”——一个带有“1”，一个带有“2”。恕我直言，这是 postgresql 中最方便的功能之一。当然，您也可以在 SQL Server 中实现类似的东西。或者你可以说“（select 1 as selector union all select 2）”。另一种选择是“(values(1),(2)) series(selector)”，尽管有多少语法是标准的，多少是 postgres 特定的，我不确定。这两种方法都有一个优点，就是让规划者知道只有两行。

交叉连接这个系列表项目允许我们为项目的每一行生成两个输出行。您甚至可以采用“items_fixed”子查询并将其设为视图——顺便说一句，这与我倾向于尝试解决此类问题的过程相反。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T17:05:47.443

尝试

```
select category,sum(CategoryCount)
from(
select Category1 as category, count(Category1) as CategoryCount
from Table
group by Category1
union all
select Category2 as category, count(Category2) as CategoryCount
from Table
group by Category2) x
group by category 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T17:03:16.420

我确定有更好的方法可以做到这一点，但是你去吧

```
declare @group1 (Category1, Count int)
declare @group2 (Category2, Count int)

insert into @group1 (Category1, Count1)
select Category1, count(Category1)
from Table
group by Category1

insert into @group2 (Category2, Count2)
select Category2, count(Category2)
from Table
group by Category2

select 
coalesce(Category1, Category2) as Category,
coalesce(Count1,0) + coalesce(Count2,0) as CountAll
from @group1 a
    full outer join @group2 b
        on a.Category1=b.Category2 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T17:09:58.203

试试这个

从表中选择类型为 1，计数（*）作为计数，其中类别如 '%full size - Pickup%'

联盟

select type as 2,count(*) as count from table where category like '%truck%'

联盟

选择类型为 3，计数（*）作为表中的计数，其中类别如 '%sedan%'
等等......

类型 1 将是您的全尺寸计数类型 2 您的卡车数量等等....

希望这可以帮助

# iphone - 在 iPhone 上将 .caf 转换为 .mp3

> ID：859151
> 
> 赞同：3
> 
> 时间：2009-05-13T16:59:26.223
> 
> 标签：iphone, audio, mp3, core-audio

有没有办法使用 iPhone SDK / Core Audio 将我录制的 .caf 文件转换为 .mp3 ？

我已经四处寻找了一段时间，但我发现的只是一个命令行实用程序（不允许在 iPhone 上运行）。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T17:03:35.577

由于 iPhone 不应该真正用于处理器密集型的事情，例如音频转换，您是否考虑过将这些文件传输到您的计算机并使用您提到的命令行工具在那里运行转换？我相信你可以很容易地自动化它。

# html - 如何使用 Zlib 将 char 数组压缩为压缩的 html 页面

> ID：859155
> 
> 赞同：0
> 
> 时间：2009-05-13T17:00:42.867
> 
> 标签：html, gzip, zlib, deflate, http-compression

我在 C 中有一个 CGI 应用程序，它通过将 char* 保存为 html 页面来创建 html 页面：

```
void saveTextFile(const char *filename, const char *str){.......} 
```

称为

```
saveTextFile("..\\index.html",outputFile); 
```

如何使用 zlib 将“outputFile”字符数组作为**输入**并输出带有适当标题的压缩 html 页面？

是否会在这里使用[gzopen](http://zlib.net/manual.html#gzopen)而不是我的 saveTextFile 函数？

任何建议表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T16:06:35.067

知道了 -

```
//****************************************************************************************
    //ZIP file: Take the char string "outputFile" as input to gzip. Create a zipped html file
    file = gzopen("..\\index.html.gz", "wb"); //create a zipped file
    if (file == NULL) {
        printf("Can't open zipped file");
        exit(1);
    }
    len   = strlen(outputFile); //need to know length of string
    compd = gzwrite(file, outputFile, (unsigned)len); //compress data into .gz file
    cls   = gzclose (file); //close .gz file
    //End zip*********************************************************************************** 
```

# c# - ASP、Server.CreateObject、MTS 和 C# 对象池——重用问题？

> ID：859165
> 
> 赞同：2
> 
> 时间：2009-05-13T17:02:08.637
> 
> 标签：c#, .net, asp-classic, com+, mts

我正在尝试调试“偶尔”问题。我们有一个需要发送电子邮件的经典 ASP 应用程序。无论出于何种原因，它都使用通过 COM 公开的 C# 对象来执行此发送；c# 对象是 MailMessage 和 SMTPClient 的简单包装器，使用 SendAsync 进行发送。在 ASP 方面，在发送每封邮件之前，该对象是 Server.CreateObject()，但邮件消息是在一个紧密的循环中发送的。这*应该*会为每条消息生成一个新的 COM 对象（因此也是一个新的 c# 对象）。但是，我们看到消息被丢弃并且消息被发送到多个收件人，就好像该对象正在被重用一样。

在对 MTS 进行了一些研究（从没想过我会再去那里！）我记得/发现 Server.CreateObject 通过 MTS 并且 MTS 将汇集 COM 对象以“帮助”我。我们更改了 ASP 代码，改为创建一个新的 ActiveXObject，我认为它没有通过 MTS，但我们遇到了同样的问题。

假设 .net 中的 ServicedComponent 接口是 ObjectControl 接口的 .net/com+ 版本，我是否正确？如果我从 ServicedComponent 继承，那么该对象是否会被设置为允许 pooling = false？我宁愿在 ASP 中进行更改，但如果这不可能，那么我也可以进行 c# 更改。

想法？

编辑：页面语言也是 JScript，而不是“普通”的 VBScript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T07:45:24.263

在这种情况下，Server.CreateObject 和 new ActiveXObject 都将指向同一事物。

COM+ 不会将未明确表明它可以被池化的对象池化。

我倾向于做的是调查这里使用 .NET 组件的原因是什么，为什么不使用 CDO.Message？SendAsync 的使用尤其令人困惑。如果你有一个紧密的循环只是发送电子邮件，那么 SendAsync 对你的作用很小。

我想不出在这种情况下避免使用 CDO.Message 的充分理由，但当然这可能是因为我们缺少其他因素。

# asp.net - 当 SSIS 在另一台服务器上时如何导入文件

> ID：859171
> 
> 赞同：0
> 
> 时间：2009-05-13T17:03:03.783
> 
> 标签：asp.net, sql-server, ssis

我希望用户通过我们的网站 (ASP.NET) 上传文件，然后使用 SSIS 将其导入 SQL Server 2005。我们的 Web 应用程序分为 Web 服务器 (IIS) 和数据库服务器 (SQL Server)。

问题是文件上传到网络服务器后，不能直接从 ASP.NET 代码调用 SSIS 包，因为 SSIS 包只能在安装了 SQL Server 的服务器上运行。

我已经考虑过各种各样的事情，比如将文件通过 FTP 传输到数据库服务器，然后让文件观察程序等待它。或者远程调用 SSIS 包，然后从 Web 服务器获取文件。但我还没有尝试任何东西。

我真的很想听听是否有人解决了这个问题以及他们是如何解决的。我们计划做很多这样的事情（即通过网站上传文件，然后导入数据库），所以我正在追求一个可以一遍又一遍地重复的坚如磐石的过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T17:22:58.367

只要包具有文件的可解析路径*并且*SQL Server 进程具有必要的权限，则文件不必与 SQL Server 位于同一位置。

我们为我们的主要应用程序执行此操作，尽管它不是基于 Web 的。任何可用的指定机器都可以包含传入的文件，然后我们的 SSIS 包从数据库中查找文件位置信息。包可以在调用时将其作为参数接收——我们对此进行了测试。

我个人不知道在这种情况下使用您的网络服务器作为文件主机的可行性（我所有的工作都在内部托管的应用程序上）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T11:41:24.353

它可能不适合您的部署，但可以在您的 Web 服务器上独立于 SQL Server 服务安装 SSIS 服务。我相信独立的 SSIS 安装需要自己的 SQL 许可证。

或者，虽然它没有直接反映您的情况，[但这个线程](http://social.msdn.microsoft.com/forums/en-US/sqlintegrationservices/thread/5408d5a8-8a3a-4648-8362-61e11022ee5d/)看起来可能有一些相关的建议。

# sql-server - SQL Server VLDB 的大小是多少

> ID：859175
> 
> 赞同：0
> 
> 时间：2009-05-13T17:03:54.297
> 
> 标签：sql-server, vldb

是最小 1TB 还是 2？

我当前的客户有低于 1 TB 的容量，我想知道我是否写他们由于其大小而处于重新分类的边缘，他们应该考虑这些问题。

:)

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T19:21:13.947

在我看来，这是经典的答案，这取决于。我不会专注于固定大小，而是关注应用程序现在的执行情况以及它是否保证了额外的复杂性。然后选择那些解决您遇到的问题的技术。

基本上它是旧的补充，不要过早地优化你的解决方案。

# javascript - 提交按钮在悬停时消失，然后重新出现

> ID：859180
> 
> 赞同：4
> 
> 时间：2009-05-13T17:04:31.533
> 
> 标签：javascript, html, css, button

所以我使用 CSS :hover 来替换提交按钮背景。当我将鼠标悬停在按钮上时，旧的背景图像会消失一会儿（所以看起来什么都没有），然后以新的背景重新出现。我想也许按钮图像文件太大，但它只有 1.4kb。有没有办法防止这种情况，缓存或预加载，或者类似的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T17:08:32.977

这仅在初始页面显示/悬停上吗？

这是因为图像文件仅在请求时加载 - 即悬停动作。

为了避免这种情况，两个按钮状态都应该存储在一个文件中。然后，您只需要调整 background-position 属性以显示正确的一半图像以适应其当前状态。

这是一个粗略的示例（请注意，button.png 包含两种图像状态并且是 40 像素高）：

```
button {
background-image: url(button.png);
width: 60px;
height: 20px;
background-position: 0 0;
}

button:hover {
background-position: 0 -20px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T17:31:30.727

您也许可以使用与上述 Bryn 的回答类似的技术*，*尽管不是*执行。*

```
.button {background-image: url(img/for/hover-state.png)
         background-position: top left;
         background-repeat: repeat-x;
         background-color: #fff;
         height: 1.5em;
         width: 5em;
}

.button span
        {background-image: url(img/for/non-hover-state.png);
         background-position: top left;
         background-repeat: repeat-x;
         background-color: #000;
         height: 1.5em;
         width: 5em;
}

.button:hover span
        {background-color: transparent;
         background-image: none;
} 
```

我提到的相似之处是让两个图像都出现在文档上，以避免悬停闪烁。在按钮悬停时，跨度的背景图像将消失，并显示悬停状态，而不必按需加载。

好处是，尽管我在上面指定了`height`/ ，但`width`这种技术将适用于动态调整大小，而不依赖于图像的固定宽度大小（或者它就像您的设计允许的那样流畅）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-13T17:28:31.777

这是因为“悬停”图像在显示之前下载需要一些时间。为了防止这种情况，您可以使用精灵图像技术。

示例：[使用带有 INPUT 的 Sprite 图像实现悬停效果](http://blog.josh420.com/archives/2008/07/using-sprite-images-with-input-typeimage-for-hover-effect.aspx)

# winapi - 任何快速简便的方法来捕获屏幕的一部分？getPixel 很慢，GetDIBits 开始时似乎有点复杂

> ID：859181
> 
> 赞同：0
> 
> 时间：2009-05-13T17:04:40.440
> 
> 标签：winapi, macos, screen, capture, getpixel

我正在尝试一些代码在 Windows 上使用 getPixel 捕获部分屏幕，设备上下文为空（捕获屏幕而不是窗口），但它真的很慢。貌似GetDIBits()可以很快，但是好像有点复杂……不知道有没有库可以把整个区域放到一个数组中，pixel[x][y]会返回24位颜色像素代码？

或者 Mac 上是否存在这样的库？或者，如果 Ruby 或 Python 已经有这样的库可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-05T16:07:50.387

我从来没有这样做过，但我会尝试：

1.  使用 CreateCompatibleDC 创建一个内存设备上下文 (DC)，并将其传递给桌面的设备上下文 (GetDC(NULL))。

2.  创建与您捕获的区域大小相同的位图（使用 CreateCompatibleBitmap）。

3.  将位图选择到您创建的 DC 中（使用 SelectObject）。

4.  从桌面 DC 到您创建的 DC 执行 BitBlt（使用 SRCCOPY 标志）。

如果您以错误的顺序执行操作，使用设备上下文可能会导致 GDI 泄漏，因此请确保您阅读了有关您使用的所有 GDI 函数（例如 SelectObject、GetDC 等）的文档。

# c# - 为什么 C# 是静态类型的？

> ID：859186
> 
> 赞同：32
> 
> 时间：2009-05-13T17:05:27.740
> 
> 标签：c#, static-typing

我是一名尝试学习 C# 的 PHP Web 程序员。

我想知道为什么 C# 要求我在创建变量时指定数据类型。

```
Class classInstance = new Class(); 
```

为什么我们需要在类实例之前知道数据类型？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-05-13T17:12:04.673

正如其他人所说，C# 是静态/强类型的。但我认为你的问题更多的是“你为什么*希望*C# 像这样静态/强类型？这比动态语言有什么优势？”

考虑到这一点，有很多充分的理由：

*   **稳定性**某些类型的错误现在由编译器自动捕获，在代码接近生产之前。
*   **可读性/可维护性**您现在正在向阅读它的未来开发人员提供有关代码应该如何工作的更多信息。您添加特定变量旨在保存某种值的信息，这有助于程序员推断该变量的目的是什么。

    这可能就是为什么，例如，Microsoft 的风格指南建议 VB6 程序员在变量名中放置类型前缀，而 VB.Net 程序员却不这样做。

*   **性能**这是最弱的原因，但是后期绑定/鸭子类型可能会更慢。最后，变量指的是以某种特定方式构造的内存。如果没有强类型，程序将不得不在运行时在后台进行额外的类型验证或转换，因为您使用的内存在物理上以一种方式构造，就好像它在逻辑上以另一种方式构造一样。

    我犹豫是否要包括这一点，因为最终您通常还必须使用强类型语言进行这些转换。只是强类型语言将转换的确切时间和范围留给了程序员，除非需要做，否则不会做额外的工作。它还允许程序员强制使用更有利的数据类型。但这些确实是*程序员*的属性，而不是平台的属性。

    这本身就是一个忽略这一点的弱理由，除了一个好的动态语言通常会比程序员做出更好的选择。这意味着动态语言可以帮助许多程序员编写更快的程序。尽管如此，对于*优秀的*程序员来说，强类型语言有*可能*更快。

*   **更好的开发工具**如果您的 IDE 知道变量的预期类型，它可以为您提供有关该变量可以做什么类型的额外帮助。如果 IDE 必须为您推断类型，这对 IDE 来说要困难得多。而且，如果您从 IDE 中获得有关 API 细节的更多帮助，那么作为开发人员，您将能够了解更大、更丰富的 API，并更快地到达那里。

或者您可能只是想知道为什么必须在同一行中为同一个变量指定两次类名？答案有两个：

1.  通常你不会。在 C# 3.0 及更高版本中，您可以`var`在许多情况下使用关键字而不是类型名称。以这种方式创建的变量仍然是静态类型的，但现在编译器会为您*推断类型。*
2.  由于继承和接口，有时左侧的类型与右侧的类型不匹配。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-13T17:07:43.480

这就是语言的设计方式。C# 是一种 C 风格的语言，遵循左侧类型的模式。

在 C# 3.0 及更高版本中，在许多情况下，您可以通过本地类型推断来解决这个问题。

```
var variable = new SomeClass(); 
```

但同时你也可以争辩说你仍然在 LHS 上声明一个类型。只是您希望编译器为您选择它。

**编辑**

请在用户原始问题的上下文中阅读此内容

> 为什么我们需要 [class name] 在变量名之前？

我想评论这个线程中的其他几个答案。很多人给出“C# 是静态类型”作为答案。虽然该陈述是正确的（C# 是静态类型的），但它几乎与问题完全无关。静态类型不需要类型名称位于变量名称的左侧。当然它可以提供帮助，但这是语言设计者的选择，而不是静态类型语言的必要特性。

通过考虑其他静态类型语言（例如 F#），这些很容易证明。F# 中的类型出现在变量名的右侧，并且通常可以完全省略。还有几个反例。例如，PowerShell 是非常动态的，它会将其所有类型（如果包含）放在左侧。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-13T17:10:34.020

主要原因之一是您可以指定不同的类型，只要赋值左侧的类型是左侧类型的父类型（或在该类型上实现的接口）。

例如给定以下类型：

```
class Foo { }
class Bar : Foo { }
interface IBaz { }
class Baz : IBaz { } 
```

C# 允许您这样做：

```
Foo f = new Bar();
IBaz b = new Baz(); 
```

是的，在大多数情况下，编译器*可以*从赋值中推断出变量的类型（比如使用**`var`**关键字），但这不是因为我上面展示的原因。

**编辑：**作为一个顺序 - 虽然 C#*是*强类型的，但重要的区别（就本讨论而言）是它实际上也是一种***静态类型的***语言。换句话说，C# 编译器在编译时进行静态类型检查。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-05-13T17:07:05.057

C# 是一种[静态类型](http://en.wikipedia.org/wiki/Statically_typed_language#Static_typing)的[强类型](http://en.wikipedia.org/wiki/Strongly-typed_programming_language)语言，如 C 或 C++。在这些语言中，所有变量都必须声明为特定类型。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-13T19:41:33.337

最终因为安德斯·海尔斯伯格是这么说的……

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-13T17:07:43.447

你需要 [class name] 在前面，因为在很多情况下第一个 [class name] 与第二个不同，例如：

```
 IMyCoolInterface obj = new MyInterfaceImplementer();
 MyBaseType obj2 = new MySubTypeOfBaseType(); 
```

等等。如果您不想明确指定类型，也可以使用“var”一词。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-07-12T12:25:14.670

> 为什么我们需要 在类实例**之前知道数据类型？**

你没有！**从右到左阅读。**您创建变量，然后将其存储在类型安全的变量中，这样您就知道该变量的类型以供以后使用。

考虑以下代码段，如果您在运行时才收到错误，那么调试将是一场噩梦。

```
 void FunctionCalledVeryUnfrequently()
 {
   ClassA a = new ClassA();
   ClassB b = new ClassB();
   ClassA a2 = new ClassB(); //COMPILER ERROR(thank god)

   //100 lines of code

   DoStuffWithA(a);
   DoStuffWithA(b);      //COMPILER ERROR(thank god)
   DoStuffWithA(a2);
 } 
```

当您考虑可以用数字或字符串替换**new Class()**时，语法会更有意义。下面的例子可能有点冗长，但可能有助于理解为什么它是这样设计的。

```
 string s = "abc";
   string s2 = new string(new char[]{'a', 'b', 'c'});
   //Does exactly the same thing

   DoStuffWithAString("abc");
   DoStuffWithAString(new string(new char[]{'a', 'b', 'c'}));
   //Does exactly the same thing 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-13T17:11:51.070

正如其他人所指出的，C# 是一种强静态类型的语言。

通过预先说明您打算创建的类型是什么，当您尝试分配非法值时，您将收到编译时警告。通过预先说明您在方法中接受的参数类型，当您不小心将废话传递给不期望它的方法时，您会收到相同的编译时警告。它代表您消除了一些偏执的开销。

最后，相当不错的是，C#（和许多其他语言）没有 PHP 所做的那种可笑的“将任何东西转换为任何东西，即使它没有意义”的心态，坦率地说，这会让你更多次比它有帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-13T17:07:40.437

c# 是一种强类型语言，如 c++ 或 java。因此它需要知道变量的类型。您可以通过 var 关键字在 c# 3.0 中稍加修改。这让编译器可以推断类型。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-13T17:07:42.387

这就是强类型语言和弱类型语言之间的区别。C#（以及 C、C++、Java，最强大的语言）是强类型的，因此您必须声明变量类型。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-13T17:08:16.083

当我们定义变量来保存数据时，我们必须指定这些变量将保存的数据类型。然后编译器检查我们对数据所做的事情是否有意义，即遵循规则。例如，我们不能将文本存储在数字中——编译器不允许这样做。

```
int a = "fred"; // Not allowed. Cannot implicitly convert 'string' to 'int' 
```

变量 a 是 int 类型，并且将值“fred”分配给它是一个文本字符串，这违反了规则——编译器无法对该字符串进行任何类型的转换。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-13T17:10:03.490

在 C# 3.0 中，您可以使用 'var' 关键字 - 这使用静态类型推断来计算编译时变量的类型

```
var foo = new ClassName(); 
```

从那时起，变量 'foo' 的类型将是 'ClassName'。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-13T19:07:47.947

没有提到的一件事是 C# 是一种符合 CLS（通用语言规范）的语言。这是 .NET 语言必须遵守的一组规则，才能与其他 .NET 语言互操作。

所以真的 C# 只是遵守这些规则。引用[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/12a7a7h3(VS.71).aspx)：

> CLS 通过定义一组开发人员可以依赖以提供多种语言的功能来帮助增强和确保语言互操作性。CLS 还制定了 CLS 合规性要求；这些可帮助您确定您的托管代码是否符合 CLS，以及给定工具在多大程度上支持使用 CLS 功能的托管代码的开发。
> 
> 如果您的组件仅使用它向其他代码（包括派生类）公开的 API 中的 CLS 功能，则保证可以从任何支持 CLS 的编程语言访问该组件。遵守 CLS 规则并仅使用 CLS 中包含的功能的组件称为符合 CLS 的组件

CLS 的一部分是 CTS[通用类型系统](http://en.wikipedia.org/wiki/Common_Type_System)。

如果这对您来说还不够首字母缩略词，那么 .NET 中还有更多的缩略词，例如 CLI、ILasm/MSIL、CLR、BCL、FCL、

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-13T17:07:01.217

因为 C# 是一种强类型语言

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-12-29T18:12:50.167

静态类型还允许编译器进行更好的优化，并跳过某些步骤。以重载为例，你有多个同名的方法或运算符，只是它们的参数不同。对于动态语言，运行时需要对每个版本进行评分，以确定哪个是最佳匹配。使用像这样的静态语言，最终代码只是直接指向适当的重载。

静态类型还有助于代码维护和重构。我最喜欢的例子是许多高端 IDE 的重命名功能。由于静态类型，IDE 可以确定地找到代码中标识符的每次出现，并保持不相关的具有相同名称的标识符完好无损。

我没有注意到它是否被提及，但是 C# 4.0 引入了动态检查 VIA`dynamic`关键字。尽管我确定您会在不需要时避免使用它。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-06-14T18:16:42.670

> 为什么 C# 要求我在创建变量时指定数据类型。
> 
> 为什么我们需要在类实例之前知道数据类型？

我认为大多数答案没有提到的一件事是，C#*最初*的意思和设计是“托管”、“安全”语言等，其中许多目标是通过静态/编译时可验证性实现的。明确地知道变量数据类型使这个问题更容易解决。这意味着可以对可能的错误/不良行为进行多次自动评估（C# 编译器，而不是 JIT），而无需允许执行。

作为副作用的可验证性还为您提供了更好的可读性、开发工具、稳定性等，因为如果自动化算法可以更好地理解代码在实际运行时会做什么，那么您也可以:)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-05-07T08:15:56.977

静态类型意味着编译器可以在编译时而不是在运行时执行某种检查。在静态类型中，每个变量都是特定类型或强类型。C# 绝对是强类型的。

# version-control - 维护一个项目的多个版本有哪些最佳实践？

> ID：859188
> 
> 赞同：7
> 
> 时间：2009-05-13T17:05:34.590
> 
> 标签：version-control

我有一个项目，我们正在推出 v1，并开始开发 v2。恐怕在接下来的几个月里，我们会看到 v1 的错误修复和小功能更改，其中一些我们需要进入 v2，其中一些我们需要保留分离。（我们需要维护 v1 的主要功能集，但要修复发现的任何错误。）

我们目前正在使用 SVN。我考虑过切换到 Git，但我有点不愿意改变工具。除了这种可能性之外，还有哪些一般策略和最佳实践可以使管理这种情况尽可能容易？

更新：每个人都建议我在 Subversion 中分支代码。这对我来说是如此明显，以至于我认为“我们正在使用 SVN”声明暗示了这一点。显然不是。:) 不过，我将研究 Mercurial 和 Bazaar 以及 Git。还要别的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T17:08:47.253

使用 SVN，您能做的最好的事情就是分支您的存储库：

*   在后备箱中，保留最新版本 - 不一定是稳定版本。
*   每当您需要从那里分离一个新的主要版本时，分支到 2.0，您可以将最新版本和稳定版本保存在同一个 repo 中。
*   如果发现分支 2.0 中的更改需要合并到主干中，则可以无缝进行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T19:18:45.840

我们正在使用 TFS，但对于您的具体问题，解决方案将非常相似：创建一个新分支。
[取决于您使用的应用程序环境，显然不是 Microsoft]
我们从 TFS 中受益，因为：

1.  您可以在分支之间进行合并 [基础合并]
2.  您可以使用工作项，[用于错误跟踪]
3.  借助共享点支持，您可能拥有文档，测试脚本可以在一个门户中愉快地生活在一起。
4.  使用 powershell 脚本，您可以进行夜间自动合并

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T17:21:59.510

对于不同的版本，最佳做法是将命名版本存储在“tags”子文件夹中。（SVN 文档建议您为每个项目创建一个主干、标签和分支文件夹）。

每当您发布版本时，将主干复制到标签文件夹并为其命名。该版本可以继续存在，并且可以单独对其进行错误修复并来回合并。

关于存储库布局的 SVN 文档：

[http://svnbook.red-bean.com/en/1.2/svn.branchmerge.maint.html](http://svnbook.red-bean.com/en/1.2/svn.branchmerge.maint.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T17:09:07.907

您应该使用 SVN 标记 v1 代码。这样，您可以创建一个单独的代码分支来支持对该代码库的修复。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T17:09:33.680

一旦 v1 分支被冻结，您是否考虑过分支您的主干并在第二个分支上进行 v2 开发？如果您修复了影响 v1 的 v2 分支上的错误，并且您想发布 v1 的更新/补丁，只需将这些特定更改从 v2 分支合并回 v1 分支。

所有这些在 SVN 中都是完全可行的，但使用 Mercurial 或 Git 等工具进行分支管理要容易得多。由于我不了解您的公司或代码库，因此我无法告诉您是否绝对值得切换，但是如果您可以预见这种情况在将来发布更多版本时会反复出现，这是需要考虑的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-09T14:54:53.783

使用*git*，您可以使用以下方法：

您的 git 存储库可能具有以下分支。每个修补程序分支都包含一个必须维护的功能版本。

```
master                  - version: 3.0.0 (latest release)
  \ 
  dev                   - version: 4.0.0 (next release)
  |\
  | hotfix-1.x          - version: 1.0.1 (current hotfix 1.x)
  \
  | hotfix-2.x          - version: 2.0.1 (current hotfix 2.x)
  \
    hotfix-3.x          - version: 3.0.1 (current hotfix 3.x) 
```

**修复：**

错误修复在 hotfix-1.x 中进行，并“向上”合并到 hotfix-2.x 并从那里合并到 hotfix-3.x。

> hotfix-1.x -> hotfix-2.x -> hotfix-3.x ...

也可以使用 git the cherry-pick 命令将错误修复从 hotfix-3.x 反向移植到 hotfix-1.x（如果需要）。使用 cherry-pick 命令，可以选择一个提交并将其应用于不同的分支。Git 还将检测移动和重命名的文件，并且仍然正确应用更改。

您还可以将发布分支并行添加到修补程序分支，以便在这些分支中准备发布（本示例省略）。当您不想阻止新提交的修补程序分支时，这很有用。如果您想了解更多关于 hotfix 和 release 分支的详细信息，请查看[gitflow 。](http://nvie.com/posts/a-successful-git-branching-model/)

**功能发布：**

新功能基于 dev 分支，并在完成后合并回 dev 分支。为每个新功能版本创建一个新的修补程序分支。

脚步：

*   将当前修补程序分支的更改合并到**dev**
*   将功能分支合并回**dev**
*   **从dev**创建新的修补程序分支
***   **从新的修补程序**分支发布*   合并回master**

 ****笔记：**

我认为当您决定保留修补程序分支时，主分支不再很重要。我相信常见的 gitflow 方案的工作方式是在完成后丢弃修补程序分支并释放分支。您的发布都应该被标记，因此可以访问。

# c# - Any video tutorials for Named Pipes?

> ID：859191
> 
> 赞同：0
> 
> 时间：2009-05-13T17:06:24.137
> 
> 标签：c#, .net-3.5, named-pipes

Can someone point me to a video that teaches how to use named pipes in C# (.Net framework 3.5)?

Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T17:16:21.890

I am not sure what's the context you are using NamedPipes communication for. But because you are using .Net 3.5 already, I would suggest using a WCF service to set up this communication, expose operation contracts that do the job and set the bindings to **netNamedPipesBinding** in the config.

Important thing is you can expose multiple endpoints with different types of bindings that use the same service methods.

You could host the service in a Windows Service service host, and it works really well.

Links:

*   [Creating a basic WCF service - Screencast](http://channel9.msdn.com/posts/cliff.simpkins/Endpoint-Screencasts-Creating-Your-First-WCF-Service/)
*   [Excellent Video on WCF - getting the basics right - DNR TV Screencast](http://www.dnrtv.com/default.aspx?showNum=122)
*   [If you don't want to create a WCF service, then this article is for you](http://www.dijksterhuis.org/using-named-pipes-in-c-windows/) - No video

# python - 1 个 django 应用程序中约有 20 个模型

> ID：859192
> 
> 赞同：39
> 
> 时间：2009-05-13T17:06:36.273
> 
> 标签：python, django, django-models

我已经开始为自己开发一个通过浏览器运行的本地应用程序。最近浏览了 django 教程，我认为使用 django 可能比使用纯 python 更好。

有一个问题：我至少有 20 个模型，每个模型都有很多功能。很简单，它将创建一个巨大的模型文件，并且可能还会创建巨大的视图。我该如何拆分它们？

这些[模型都是相关](http://woarl.com/images/entity%20chart.png)的，所以我不能简单地将它们变成单独的应用程序，可以吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-13T17:10:40.807

这是一个非常普遍的需求......我无法想象要通过一个 10,000 行长的 models.py 文件:-)

您可以将`models.py`文件（以及views.py）拆分成一个包。在这种情况下，您的项目树将如下所示：

```
/my_proj
    /myapp
        /models
            __init__.py
            person.py 
```

该`__init__.py`文件使文件夹成为一个包。唯一的问题是确保为`Meta`模型定义一个内部类，指示模型的 app_label，否则 Django 将无法构建您的模式：

```
class Person(models.Model):
    name = models.CharField(max_length=128)

    class Meta:
        app_label = 'myapp' 
```

完成后，将模型导入`__init__.py`文件中，以便 Django 和 sync db 找到它：

```
from person import Person 
```

这样你仍然可以做`from myapp.models import Person`

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-05-13T18:00:12.380

“我至少有 20 个模型”——这可能不仅仅是一个 Django“应用程序”，更像是一个带有几个小“应用程序”的 Django“项目”

我喜欢围绕具有几个（1 到 5 个）模型的主题或主题领域进行划分。这变成了一个 Django “应用程序”——并且是可重用的有用单元。

整个“项目”是一组应用程序，它们呈现由独立部分组成的集成事物。

这也有助于项目管理，因为每个“应用程序”都可以成为一个最终发布的 sprint。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-05-13T17:58:37.420

> 这些模型都是相关的，所以我不能简单地将它们变成单独的应用程序，可以吗？

您**可以**将它们分成单独的应用程序。要在一个应用程序中从另一个应用程序使用模型，您只需以与导入 django.contrib 应用程序相同的方式导入它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-01-14T02:47:14.997

在一个应用程序中拥有 20 个模型可能表明您应该将其分解为较小的模型。

Django 应用程序的目的是拥有一小段单一用途的代码，它们可以很好地组合在一起。

因此，如果您有一个电子商务网站，您可能有一个 shopping_cart 应用程序、一个计费应用程序等等。

请记住，相互依赖的应用程序确实没有问题（尽管可以将它们解耦总是更好），但是您不应该让应用程序做两件截然不同的事情。

文章[Django 提示：布局应用程序](http://www.b-list.org/weblog/2006/sep/10/django-tips-laying-out-application/)可能会对您有所帮助。与往常一样，对您阅读的所有内容持保留态度（包括此答案）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T17:09:20.107

您可以将模型分解为多个文件。这也适用于视图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T17:10:15.503

您*可以*将它们拆分为单独的文件，并在您的主要 models.py 字段顶部简单地导入。

你是否真的*想要*是另一个问题。

# php - 查找大量文本数据的趋势

> ID：859197
> 
> 赞同：2
> 
> 时间：2009-05-13T17:07:31.047
> 
> 标签：php, mysql

我有一张大桌子，想至少找到重复次数最多的作品，这样我就可以有一个趋势关键字列表。

数据库是mysql，我正在运行php5。

除了在php端爆炸数据和搜索重复之外，还有其他方法吗？

组合 2/3 个词的关键词趋势怎么样？

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T17:45:50.110

好吧...因为我没有得到任何答案，所以我找到了一种使用 php 的方法：

```
$wordfrequency = array_count_values( str_word_count( $string, 1) ); 
```

希望它可以帮助某人:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T03:36:36.447

听起来您几乎是在谈论实现[马尔可夫链式](http://en.wikipedia.org/wiki/Markov_chain)算法。但是，如果不完全处理数据，我想不出任何方法可以单独使用 SQL 来进行这种趋势分析。

# .net - iText pdf 无法在浏览器中打开

> ID：859204
> 
> 赞同：-1
> 
> 时间：2009-05-13T17:08:07.097
> 
> 标签：.net, pdf, itext

使用 iText 创建的 Pdf 在安装了 Adob​​e Pro 的机器上无法在 IE 中打开。在其他情况下效果很好。浏览器设置？提前致谢。

相关代码：Response.ContentType = "Application/pdf";

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-02T17:11:56.197

乔恩的问题暗示了这一点，但让我把它拼出来。

我看到一个类似的问题，因为我无法直接在 IE 中打开*任何PDF。*这就是为什么：

*   我安装了 Acrobat Pro（目前为 9.4），而 Adob​​e 仅提供 32 位版本。
*   我有 Windows 7 64 位，它只允许我安装 IE 64 位。
*   具有不同位宽的应用程序/DLL 可能不共享一个进程。

    *   所以 64 位的 IE 不能与 32 位的 Acrobat 对话。
    *   因此 IE 64 位浏览器中没有 PDF。

我不确定我是否应该因为这个而对 MS 或 Adob​​e 感到恼火，所以我将使用我妻子最喜欢的购物策略（哎呀）并选择“两者！”

* * *

任何给定的 PDF 都没有什么特别之处可以阻止它在浏览器中打开。如果打开一个 PDF，则应打开*所有**有效**的pdf 。*它们可能没有“针对 Web 视图进行优化”（也称为“线性化”，设置为渐进式下载），但它们仍应打开。

我突然想到，如果您的 PDF 特别大（或者您的连接特别慢），您可能希望第一页会立即弹出，就像您进入线性化 PDF 一样，并决定它不工作，因为您必须等待下载整个文件，然后才能查看其中的任何内容。

iText 不支持线性化，至少从 5.0.5 开始不支持。如果我们曾经添加对它的支持，它可能会开始作为您必须在现有 PDF 上进行的额外通行证，如果人们抱怨足够多，最终会迁移到更有效的实现中。

*   PS：线性化大型表单并不能很好地工作，因为必须先下载文件的整个表单部分（以及任何文档级脚本），然后才能显示第一页。

*   PPS：我很确定线性化一页 PDF 没有意义。线性化的整个目标是对 PDF 进行排序，以便第一页所需的所有内容都位于文件的前面，因此您首先下载该部分。当您只有一页要显示时，我相信这一切都只是额外的开销。

# mysql - 我可以使用 GUI 工具 SSH 到 MySQL 吗？

> ID：859218
> 
> 赞同：11
> 
> 时间：2009-05-13T17:10:24.300
> 
> 标签：mysql, linux, ubuntu, ssh, firewall

我有一个 ubuntu 服务器，我只锁定了 HTTP、HTTPS 和 SSH（端口 30000）。在这个盒子上，我有一个 MySQL 服务器，99.9% 的时间只在本地使用。时不时我想用 GUI 工具连接到 MySQL 实例，但不接触防火墙。

因此，可以进行设置以便我可以通过 SSH 连接连接到 MySQL 机器吗？我可以做任何类型的端口转发魔术吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-13T17:18:27.067

```
ssh -L localport:127.0.0.1:remoteport user@remotehost 
```

where`localport`是本地系统上的未绑定端口，`remoteport`是 MySQL 侦听的端口，`127.0.0.1`是远程系统上的环回地址，`user`是您的用户名，`remotehost`是远程系统的地址。

然后将您的 MySQL 客户端指向`127.0.0.1:localport`. 连接将通过 SSH 隧道转发到远程端口。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T17:13:04.017

如果您在本地机器上使用 Windows 或 Unix，PuTTY 是一个很好的工具。这是一个关于端口转发的教程：

[http://www.cs.uu.nl/technical/services/ssh/putty/puttyfw.html](http://www.cs.uu.nl/technical/services/ssh/putty/puttyfw.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T17:14:15.887

使用 SSH 客户端设置隧道，通过隧道将本地端口映射到远程计算机上的端口，然后使用客户端连接到本地端口。

`man ssh`会有血淋淋的细节，但你最好在网上搜索一些更容易阅读的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-04T15:35:34.240

如果您使用的是 Windows，我建议您使用[HeidiSQL 。](http://www.heidisql.com/)它自己处理 SSH 隧道（您只需要下载 plink.exe 实用程序）。

在我看来，它是目前最好的 MySQL 工具（而且它是免费和开源的）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T02:18:11.787

有两种方法可以在远程 MYSQL 机器上使用 GUI mysql 工具。

我假设远程机器正在运行linux。

选项1。

SSH 端口转发。

ssh -L 3306:proxy:3306 用户名@remotehost

基本上，您将本地计算机上的端口 3306 转发到远程计算机上的 3306，然后您告诉图形 MYSQl 工具连接到 localhost:3306 并假设您的远程计算机正在侦听标准端口 3306

[http://magazine.redhat.com/2007/11/06/ssh-port-forwarding/](http://magazine.redhat.com/2007/11/06/ssh-port-forwarding/)

ssh -D 3306 username@remotehost 也应该类似

选项 2。

如果您在远程机器上运行 xserver 并在远程机器上安装了 GUI 工具，您可以通过 SSH 连接隧道化您的 GUI。

ssh -X username@remotehost 然后从命令行在远程机器上启动你的 GUI 工具。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-02T04:40:13.870

SQLyog 中的 SSH/HTTP 隧道很好。有公钥/私钥身份验证，增加了额外的安全层。

![在此处输入图像描述](https://i.stack.imgur.com/oohLx.png)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-14T08:50:15.613

我建议寻找[phpMyAdmin 一个基于 web 的工具来管理 MySQL](http://www.phpmyadmin.net/)，并且非常好（需要 PHP）。它可以通过普通的 Ubuntu 方法安装（例如 Synaptic）

或者如上所述使用 SSH 进行 X 隧道传输。

# sql-server - SQL 2008 中的 Wide 表和 Nonwide 表有什么区别？

> ID：859219
> 
> 赞同：12
> 
> 时间：2009-05-13T17:10:25.003
> 
> 标签：sql-server, sql-server-2008

我在 MSDN 上查看此页面：

[SQL Server 2008 的最大容量规格](http://msdn.microsoft.com/en-us/library/ms143432.aspx)

它说：

> 每个“非宽”表的最大列数：1,024
> 每个“宽”表的最大列数：30,000

但是，我找不到有关 SQL 2008 中“宽”表和“非宽”表之间区别的任何信息。如果我想定义一个“宽”表，我该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T17:14:50.970

[特殊表类型](http://msdn.microsoft.com/en-us/library/ms186986.aspx)

您需要的所有信息都在这篇 MSDN 文章中。

宽表只是具有稀疏列的表。要使表格变宽，您只需在其定义中添加一个列集。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T17:15:11.393

我会说差异大约是 28,976 列。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T19:34:11.213

请务必注意，您的总固定长度和可变长度数据仍然限制为总共 8019 字节。只有在大多数数据为空的稀疏表中才支持能够执行这种疯狂的超大量列。否则，您仍然会得到超过 8019 字节的行，并最终得到不适合的行数据，或者溢出到扩展的行数据中（与普通数据页相比，维护成本非常高）。

Karen Delaney 有一本非常好的书，其中有大量的 SQL Server 内部特性和限制，名为[SQL Server 2008 Internals](https://rads.stackoverflow.com/amzn/click/com/0735626243)。如果您真的了解低级别限制以及 SQL Server 中的工作方式，那么这是一本很棒的读物。在某些情况下，它将增加您对 SQL Server 如何在字节级别对磁盘执行其底层操作的知识深度。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-23T16:10:35.917

另一个区别是宽表不适用于事务或合并复制。请参阅此处的“支持稀疏列的 SQL Server 技术”部分：http: [//msdn.microsoft.com/en-us/library/cc280604 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/cc280604(v=sql.105).aspx)

# mysql - := 是什么意思？

> ID：859220
> 
> 赞同：3
> 
> 时间：2009-05-13T17:10:29.060
> 
> 标签：mysql

在回答 stackoverflow 上的另一个问题（[如何从 mysql 中选择每 n 行](https://stackoverflow.com/questions/858746/how-do-you-select-every-n-th-row-from-mysql)）时，有人提供了这个答案：

```
SELECT * FROM ( SELECT @row := @row +1 AS rownum, [column name]
FROM ( SELECT @row :=0) r, [table name] ) ranked WHERE rownum % [n] = 1 
```

有人可以在此处提供或指出有关语法用法的更多信息。我不熟悉`:=`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T17:18:19.670

`a = b`在 MySQL 中，如果它们相等则比较`a`并返回，`b`否则。，另一方面，*将*的值设置为。`true``false``@a := b`*`@a``b`*

 *基本上，`=`是比较运算符（“等于”），并且`:=`是赋值运算符（“设置等于”）。

**编辑：**我刚刚发现您可以`=`在语句中用作赋值运算符`SET`，因为其中没有比较之类的东西。在`SELECT`语句中，您必须使用`:=`for 赋值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T17:21:17.577

从[http://dev.mysql.com/doc/refman/5.0/en/user-variables.html](http://dev.mysql.com/doc/refman/5.0/en/user-variables.html)：

“对于 SET，= 或 := 都可以用作赋值运算符。

您还可以在 SET 以外的语句中为用户变量赋值。在这种情况下，赋值运算符必须是 := 而不是 =，因为 = 在非 SET 语句中被视为比较运算符：

```
mysql> SET @t1=0, @t2=0, @t3=0;
mysql> SELECT @t1:=(@t2:=1)+@t3:=4,@t1,@t2,@t3;
+----------------------+------+------+------+
| @t1:=(@t2:=1)+@t3:=4 | @t1  | @t2  | @t3  |
+----------------------+------+------+------+
|                    5 |    5 |    1 |    4 |
+----------------------+------+------+------+ 
```

"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T17:13:58.400

对我来说，它看起来与 = 完全相同。

# c# - 从代理服务器后面调用 Web 服务

> ID：859224
> 
> 赞同：9
> 
> 时间：2009-05-13T17:11:22.303
> 
> 标签：c#, .net, web-services, soap

我需要在将使用 Web 服务（XML SOAP 服务）的应用程序（C#）中添加一个功能。

现在，此应用程序可以（并且大部分）用于具有代理服务器的公司环境中。

我了解 SOAP 服务使用 HTTP 协议，因此应该使用端口 80，该端口通常保持打开状态。应用程序可以在没有任何特殊编码的情况下使用 Web 服务是否正确，或者我需要编写特殊代码来检测代理设置或您看到的其他一些问题？

编辑：Webservice 是 Internet 上的公开可用服务。它不在同一个网络上。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T17:28:25.737

默认情况下它将使用端口 80，您不必进行任何进一步的编码。

如果您确实需要通过某种代理，您只需将以下内容添加到您的 web.config 中：

```
 <system.net>
    <defaultProxy>
      <proxy  proxyaddress="http://yourproxyserver:80" />
    </defaultProxy>
  </system.net> 
```

您也可以使用以下代码通过代码来做到这一点：

```
WebRequest.DefaultWebProxy = new WebProxy("http://yourproxyserver:80/",true); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-16T12:14:19.873

您可以使用本地机器的默认设置：

```
System.Net.ServicePointManager.Expect100Continue = false; 
wsclient.Proxy=  System.Net.HttpWebRequest.GetSystemWebProxy();
wsclient.Proxy.Credentials = CredentialCache.DefaultCredentials; 
```

并在 app.config 添加此配置：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.net>
    <settings>
      <servicePointManager expect100Continue="false" />
    </settings>
  </system.net>
</configuration> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-15T11:59:01.080

好的。所以我做了一些实验，结果发现我们确实需要编写一些代码来让它在代理服务器后面工作。（虽然我更喜欢更好的解决方案）

因此，它实际上深入询问用户代理服务器的详细信息，然后为代理服务器配置服务代理类，如下所示：

```
var networkCredentials = new NetworkCredential（“用户名”、“密码”、“域”）；
WebProxy myProxy = new WebProxy ("WXYZ:NN", true) {Credentials = networkCredentials};
var service = new iptocountry { Proxy = myProxy };
字符串结果 = service.FindCountryAsString ("ABCD");

```

我编写了一个测试类，它使用[IP To Country](http://www.xmethods.net/ve2/index.po)免费网络服务。

使用上面的代码，我可以成功使用 Web 服务。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-13T20:01:13.617

内置代码（WebClient、WCF、HttpWebRequest 等）都使用 WinHTTP 配置来获取代理配置。因此，您需要做的就是配置 WinHTTP 以了解代理！

在 XP 中，这是：

```
proxycfg -u 
```

它从用户的 IE 代理设置 (WinInet) 导入设置。

在 Vista / etc 上，您使用

```
netsh winhttp 
```

（还有一些像“import”这样的子命令）

未经测试，但尝试：

```
netsh winhttp import proxy source=ie 
```

之后，您的 .NET 代码应该全部通过用户可能已经配置的代理工作，以便使用 IE 等。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-13T17:14:09.177

如果您的 web 服务与调用 web 服务的客户端位于同一内部网络上，那么它不应该通过代理。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-13T17:20:24.097

只要允许通过网络流量（端口 80），您就不需要做任何特别的事情。从路由器/代理服务器的角度来看，Web 服务调用与任何其他 HTTP 流量相同。

# wpf - 寻找带有复选框的 WPF ComboBox

> ID：859227
> 
> 赞同：36
> 
> 时间：2009-05-13T17:12:31.130
> 
> 标签：wpf, combobox, checkedlistbox

我的谷歌技能让我失望。任何人都听说过类似 WPF 的控件。我试图让它看起来像这样（winforms screenshot）。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-13T17:29:35.830

您可以通过设置组合框的 DataTemplate 自己完成此操作。[本文](http://blah.winsmarts.com/2007-3-WPF__The_DataTemplate,_choosing_how_your_data_will_look_like.aspx)向您展示了如何 - 对于列表框，但原理是相同的。

* * *

[这里](http://geeks.netindonesia.net/blogs/mahara/archive/2008/12/10/a-simple-multicolumn-combo-box-in-wpf.aspx)的另一篇文章可能更适合您尝试做的事情，只需将项目模板的第一列设置为复选框并将其绑定到业务对象上的布尔值。

```
<ComboBox.ItemTemplate>
    <DataTemplate>
        <StackPanel Orientation="Horizontal">
            <CheckBox IsChecked="{Binding IsSelected}"
                       Width="20" />
            <TextBlock Text="{Binding DayOfWeek}"
                       Width="100" />
        </StackPanel>
    </DataTemplate>
</ComboBox.ItemTemplate> 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-07-07T06:28:08.640

有我的组合框。我使用此链接中的 Martin Harris 代码和代码[Can a WPF ComboBox 在其选择为空时显示替代文本？](https://stackoverflow.com/questions/2901536/can-a-wpf-combobox-display-alternative-text-when-its-selection-is-null)

```
<ComboBox Name="cbObjects" Grid.Column="1" Grid.Row="1" VerticalAlignment="Center" Margin="2,2,6,0" SelectionChanged="OnCbObjectsSelectionChanged" >
    <ComboBox.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <CheckBox IsChecked="{Binding IsSelected}" Width="20" VerticalAlignment="Center" Checked="OnCbObjectCheckBoxChecked" Unchecked="OnCbObjectCheckBoxChecked" />
                <TextBlock Text="{Binding ObjectData}" VerticalAlignment="Center" />
            </StackPanel>
        </DataTemplate>
    </ComboBox.ItemTemplate>
</ComboBox>
<TextBlock IsHitTestVisible="False" Name="tbObjects" Text="Выберите объекты..." Grid.Column="1" Grid.Row="1" VerticalAlignment="Center" Margin="6,2,6,0" /> 
```

数据源小类：

```
public class SelectableObject <T> {
    public bool IsSelected { get; set; }
    public T ObjectData { get; set; }

    public SelectableObject(T objectData) {
        ObjectData = objectData;
    }

    public SelectableObject(T objectData, bool isSelected) {
        IsSelected = isSelected;
        ObjectData = objectData;
    }
} 
```

并且有两个处理程序 - 一个用于处理单击的 CheckBox，一个用于为 ComboBox 形成文本。

```
private void OnCbObjectCheckBoxChecked(object sender, RoutedEventArgs e) {
    StringBuilder sb = new StringBuilder();
    foreach (SelectableObject<tblObject> cbObject in cbObjects.Items) 
    {
        if (cbObject.IsSelected)
            sb.AppendFormat("{0}, ", cbObject.ObjectData.Description);
    }
    tbObjects.Text = sb.ToString().Trim().TrimEnd(',');
}

private void OnCbObjectsSelectionChanged(object sender, SelectionChangedEventArgs e) {
    ComboBox comboBox = (ComboBox)sender;
    comboBox.SelectedItem = null;
} 
```

对于 ComboBox.ItemsSource 我使用

```
ObservableCollection<SelectableObject<tblObject>> 
```

其中 tblObject 是我的对象的类型，我想在 ComboBox 中显示它的列表。

我希望这段代码对某人有用！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-03-05T05:44:33.570

尝试使用Extended [WPF Toolkit中的](https://github.com/xceedsoftware/wpftoolkit)[CheckComboBox](https://github.com/xceedsoftware/wpftoolkit/wiki/CheckComboBox)。对我来说主要优势是有两个绑定列表：

*   所有可供选择的项目
*   刚刚选择的项目

我觉得这种方法更实用。此外，您可以指定要绑定的集合`value`的`display`成员。

如果你不想带一堆其他的控件`CheckComboBox`，你可以获取它的[源代码](https://github.com/xceedsoftware/wpftoolkit/blob/master/ExtendedWPFToolkitSolution/Src/Xceed.Wpf.Toolkit/CheckComboBox/Implementation/CheckComboBox.cs)，它非常简单（需要带[Selector 类](https://github.com/xceedsoftware/wpftoolkit/blob/master/ExtendedWPFToolkitSolution/Src/Xceed.Wpf.Toolkit/Primitives/Selector.cs)）。

# .net - Typed Datasets: a Good choice or Bad - 为什么应该在他们的应用程序中使用或不使用类型化数据集？

> ID：859232
> 
> 赞同：5
> 
> 时间：2009-05-13T17:13:22.393
> 
> 标签：.net, database, strongly-typed-dataset

自从 .net 2.0 发布以来，这个问题已经被讨论过很多次。许多开发人员不赞成 Typed 数据集，并且很少有人实际使用它们。

该问题的目的是确定**一个人应该在其应用程序中使用或不使用 Typed 数据集的原因。**

就我而言，我个人长期以来一直使用它们。我不将它们用作仅独立的数据访问选项，而是将它们用作可以抽象地存储所有 SQL 查询的数据模型。

所以对我来说，使用类型化数据集的主要原因是..

1.) 与传统数据集不同，完全类型化的数据模型。

2.) 从代码中提取所有查询。

> 您可能喜欢或不使用 Typed Datasets 的原因是什么？到目前为止，专家们根据他们的经验对这个话题有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T17:25:07.583

我倾向于不使用它们有几个原因：

它们引入了另一个要管理的状态级别。

系统的关系模型并不总是直接映射到对象模型。保持它们解耦让我可以独立于对象模型优化关系模型。

我可以在整个代码中散布 sql 查询，尽管我可能是少数。SQL 非常简单，在大多数语言中都有很好的绑定，并且通常以编程方式构造（我不是在说 sql 注入，我总是在可以使用它们的地方使用绑定变量）。

我认为数据集主要是为了在表单设计器中支持拖放数据访问。我喜欢表设计器和查询设计器，但发现数据集的额外开销但不值得付出努力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T17:25:30.797

就个人而言，我大部分时间都避开数据集，只是因为我喜欢尽快将数据从数据库中取出并放入强类型*对象*中。只是为了我使用数据读取器的速度，尽管这不是重点。它摆脱了[对象关系阻抗](http://en.wikipedia.org/wiki/Object-Relational_impedance_mismatch)的泥潭，这是很重要的一部分。

# sql-server - 替代索引视图

> ID：859242
> 
> 赞同：0
> 
> 时间：2009-05-13T17:15:26.010
> 
> 标签：sql-server, views, indexed-view

sql server中索引视图的替代方法是什么？

谢谢，萨尔曼·谢巴兹。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T17:19:17.377

将视图内容转储到汇总表并在这些表上放置索引。

索引视图为您提供您想尝试并通过替代方法实现的好处是什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T18:08:33.707

创建一个选择存储过程，然后在需要时执行该存储过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T18:34:34.727

我将假设您想要索引具有外部或自连接（[或其他限制之一](http://msdn.microsoft.com/en-us/library/ms191432(SQL.90).aspx)）的视图。

如果要在 FROM 子句中使用普通视图或内联表函数，请使用它。

但是，请记住这一点：在具有索引视图的查询中，优化器可能会取消嵌套（扩展）视图并在认为合适的情况下使用基表。也可以嵌套使用未索引视图或内联表函数的替代查询。

在这里查看我的答案：[查询计划优化器是否适用于连接/过滤的表值函数](https://stackoverflow.com/questions/311026/does-query-plan-optimizer-works-well-with-joined-filtered-table-valued-functions/311163#311163) 和[托尼罗杰森](http://sqlblogcasts.com/blogs/tonyrogerson/archive/2008/01/03/views-they-offer-no-optimisation-benefits-they-are-simply-inline-macros-use-sparingly.aspx)

否则，您能否添加更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T08:11:34.333

替代方法包括在常规 VIEW 上使用 INSTEAD OF 触发器并在基表上使用常规触发器。

# debugging - Windows Batch file debugger?

> ID：859245
> 
> 赞同：5
> 
> 时间：2009-05-13T17:16:29.580
> 
> 标签：debugging, command-line, batch-file

Is there a program like Visual Studio that allows you to debug (dos) batch files? What techniques could I use to debug? Martin Brown answered a batch file question with a nice for / each loop. I would love to see the values of the variables as they loop.

`for /R A %i IN (*.jpg) DO xcopy %i B /M`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T20:01:59.043

To print the values of the variables as they loop you could try:

```
for /l %A in (1,1,10) do (
    @echo %A
) 
```

If you want to stop and examine each line as it is executed try:

```
for /l %A in (1,1,10) do (
    @echo %A
    pause
) 
```

which will halt the script at each iteration.

Your example looks like a backup script for images;

```
for /R %i in (*.jpg) do (
    @echo %i
    xcopy %i %DESTINATION% /M
) 
```

If you make a script of this you can pipe all the output to a log file, just don't forget to use %%i instead of %i if you're not typing this at the shell.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T17:47:36.783

you mean besides just doing an echo HERE I AM type of thing? i don't know of any. i just debug my batch files by remming out the actions and adding echo's until i know its working correctly. i also wrote my own one line "outputdebugstring" application that sends anything on its command line to the debugger, but that probably isn't necessary for most batches where you can just watch the screen. inserting "pause"'s can help slow things down too.

best regards don

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T08:15:21.447

Well i found one it name is **[Running Steps](http://www.steppingsoftware.com/ssportal/Downloads/tabid/58/Default.aspx)**. You can read more about it at its [Homepage](http://www.steppingsoftware.com/ssportal/) . Anyway it supports breakpoints, step in step over and stuff like that :)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-17T04:09:10.987

**Running Steps** is like the IDE. You get an 'Analyzer' which is the equivalent of a compiler. It shows you errors and warnings in your code. It has an integrated environment that allows you to step over, into, etc. It even unrolls for loops which I find awesome. Check it out at [http://www.steppingsoftware.com](http://www.steppingsoftware.com). It's helped me a lot.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T17:27:20.653

Like VS ? Not that I know of.

As far as variable values go, you can always print them out.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T17:36:06.723

I use Notepad++ to at least give me colour coding when I'm writing/modifying.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-12T14:55:35.433

As mentioned by other users you can use **Running Steps** software. You can download it from [here](https://web.archive.org/web/20120421211043/http://www.steppingsoftware.com/ssportal/Downloads/tabid/58/Default.aspx)

# tsql - TSQL - 选择休假日期在发票范围内的数据的最佳方法

> ID：859250
> 
> 赞同：1
> 
> 时间：2009-05-13T17:17:54.680
> 
> 标签：tsql

背景：我有一个工资系统，其中只有在支付的发票范围内才支付休假。因此，如果发票涵盖了过去 2 周，那么只有在过去 2 周内的假期才会被支付。

我想写一个sql查询来选择请假。

假设一个名为的表`DailyLeaveLedger`，其中有一个`LeaveDate`和`Paid`标志。假设一个名为`Invoice`它的表是一个`WeekEnding`字段和一个`NumberWeeksCovered`字段。

现在假设周结束日期 15/05/09 和`NumberWeeksCovered`= 2 和`LeaveDate`11/05/09。

这是我希望如何编写的示例。实际查询非常复杂，但我希望`LeaveDate`检查是 In 子查询。

```
SELECT * 
FROM DailyLeaveLedger 
WHERE Paid = 0 AND
      LeaveDate IN (SELECT etc...What should this be to do this) 
```

不确定它是否可能像我提到的那样？

马尔科姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T17:51:10.553

那么对于某些发票，LeaveDate 应该介于 (WeekEnding-NoOfWeeksCovered) 和 (WeekEnding) 之间吗？

如果我理解正确，您也许可以使用 EXISTS() 子查询，如下所示：

```
SELECT * 
FROM DailyLeaveLedger dl
WHERE Paid = 0 AND
      EXISTS (SELECT *
              FROM Invoice i
              WHERE DateAdd(week,-i.NumberOfWeeksCovered,i.WeekEnding) < dl.LeaveDate 
              AND i.WeekEnding > dl.LeaveDate
              /* and an extra clause in here to make sure
              the invoice is for the same person as the dailyleaveledger row */
              ) 
```

# algorithm - 为什么这个简单的洗牌算法会产生有偏差的结果？什么是简单的原因？

> ID：859253
> 
> 赞同：22
> 
> 时间：2009-05-13T17:18:26.473
> 
> 标签：algorithm, math, shuffle

似乎这个简单的洗牌算法会产生有偏差的结果：

```
# suppose $arr is filled with 1 to 52

for ($i < 0; $i < 52; $i++) { 
  $j = rand(0, 51);

  # swap the items

  $tmp = $arr[j];
  $arr[j] = $arr[i];
  $arr[i] = $tmp;
} 
```

你可以试试...而不是使用 52，使用 3（假设只使用 3 张卡），然后运行 ​​10,000 次并统计结果，您会发现结果偏向某些模式...

问题是......它会发生的简单解释是什么？

正确的解决方案是使用类似的东西

```
for ($i < 0; $i < 51; $i++) {  # last card need not swap 
  $j = rand($i, 51);        # don't touch the cards that already "settled"

  # swap the items

  $tmp = $arr[j];
  $arr[j] = $arr[i];
  $arr[i] = $tmp;
} 
```

但问题是......为什么第一种方法，看似也是完全随机的，会使结果有偏差？

**更新 1：**感谢这里的人们指出它需要 rand($i, 51) 才能正确洗牌。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-13T17:21:00.213

看到这个：
[天真的危险（编码恐怖）](https://blog.codinghorror.com/the-danger-of-naivete/)

让我们以您的三张牌为例。使用 3 张牌的牌组，洗牌后牌组只有 6 种可能的顺序： `123, 132, 213, 231, 312, 321.`

使用您的第一个算法，代码有 27 种可能的路径（结果），具体取决于`rand()`函数在不同点的结果。这些结果中的每一个都同样可能（无偏见）。这些结果中的每一个都将映射到上面 6 个可能的“真实”随机播放结果列表中的相同单个结果。我们现在有 27 个项目和 6 个桶来放入它们。由于 27 不能被 6 整除，因此这 6 个组合中的某些组合*必须*被过度表示。

使用第二种算法，有 6 种可能的结果精确地映射到 6 种可能的“真实”洗牌结果，并且它们都应该随着时间的推移被平等地表示。

这很重要，因为在第一个算法中过度表示的桶不是随机的。为偏差选择的桶是可重复和*可预测的。* 因此，如果您正在构建一个在线扑克游戏并使用第一种算法，那么黑客可能会发现您使用的是幼稚排序，并由此得出某些牌组安排比其他牌组更有可能发生。然后他们可以相应地下注。他们会失去一些，但他们会赢得比失去更多的东西，并很快让你破产。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-13T20:18:27.660

这是这些替换的完整概率树。

让我们假设您从序列 123 开始，然后我们将列举所有使用相关代码产生随机结果的各种方法。

```
123
 +- 123          - swap 1 and 1 (these are positions,
 |   +- 213      - swap 2 and 1  not numbers)
 |   |   +- 312  - swap 3 and 1
 |   |   +- 231  - swap 3 and 2
 |   |   +- 213  - swap 3 and 3
 |   +- 123      - swap 2 and 2
 |   |   +- 321  - swap 3 and 1
 |   |   +- 132  - swap 3 and 2
 |   |   +- 123  - swap 3 and 3
 |   +- 132      - swap 2 and 3
 |       +- 231  - swap 3 and 1
 |       +- 123  - swap 3 and 2
 |       +- 132  - swap 3 and 3
 +- 213          - swap 1 and 2
 |   +- 123      - swap 2 and 1
 |   |   +- 321  - swap 3 and 1
 |   |   +- 132  - swap 3 and 2
 |   |   +- 123  - swap 3 and 3
 |   +- 213      - swap 2 and 2
 |   |   +- 312  - swap 3 and 1
 |   |   +- 231  - swap 3 and 2
 |   |   +- 213  - swap 3 and 3
 |   +- 231      - swap 2 and 3
 |       +- 132  - swap 3 and 1
 |       +- 213  - swap 3 and 2
 |       +- 231  - swap 3 and 3
 +- 321          - swap 1 and 3
     +- 231      - swap 2 and 1
     |   +- 132  - swap 3 and 1
     |   +- 213  - swap 3 and 2
     |   +- 231  - swap 3 and 3
     +- 321      - swap 2 and 2
     |   +- 123  - swap 3 and 1
     |   +- 312  - swap 3 and 2
     |   +- 321  - swap 3 and 3
     +- 312      - swap 2 and 3
         +- 213  - swap 3 and 1
         +- 321  - swap 3 and 2
         +- 312  - swap 3 and 3 
```

现在，第四列数字，即交换信息之前的那一列，包含最终结果，有 27 个可能的结果。

让我们计算每个模式出现的次数：

```
123 - 4 times
132 - 5 times
213 - 5 times
231 - 5 times
312 - 4 times
321 - 4 times
=============
     27 times total 
```

如果您运行无限次随机交换的代码，模式 132、213 和 231 将比模式 123、312 和 321 更频繁地出现，这仅仅是因为代码交换的方式使得这种情况更有可能发生.

现在，当然，你可以说如果你运行代码 30 次 (27 + 3)，你最终可能会得到所有模式出现 5 次，但是在处理统计数据时，你必须着眼于长期趋势。

这是探索每种可能模式之一的随机性的 C# 代码：

```
class Program
{
    static void Main(string[] args)
    {
        Dictionary<String, Int32> occurances = new Dictionary<String, Int32>
        {
            { "123", 0 },
            { "132", 0 },
            { "213", 0 },
            { "231", 0 },
            { "312", 0 },
            { "321", 0 }
        };

        Char[] digits = new[] { '1', '2', '3' };
        Func<Char[], Int32, Int32, Char[]> swap = delegate(Char[] input, Int32 pos1, Int32 pos2)
        {
            Char[] result = new Char[] { input[0], input[1], input[2] };
            Char temp = result[pos1];
            result[pos1] = result[pos2];
            result[pos2] = temp;
            return result;
        };

        for (Int32 index1 = 0; index1 < 3; index1++)
        {
            Char[] level1 = swap(digits, 0, index1);
            for (Int32 index2 = 0; index2 < 3; index2++)
            {
                Char[] level2 = swap(level1, 1, index2);
                for (Int32 index3 = 0; index3 < 3; index3++)
                {
                    Char[] level3 = swap(level2, 2, index3);
                    String output = new String(level3);
                    occurances[output]++;
                }
            }
        }

        foreach (var kvp in occurances)
        {
            Console.Out.WriteLine(kvp.Key + ": " + kvp.Value);
        }
    }
} 
```

这输出：

```
123: 4
132: 5
213: 5
231: 5
312: 4
321: 4 
```

所以虽然这个答案确实很重要，但它不是一个纯粹的数学答案，你只需要评估随机函数可以走的所有可能方式，并查看最终输出。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-05-13T20:52:10.693

从您对其他答案的评论来看，您似乎不仅在寻找关于为什么分布不是均匀分布的解释**（**为此，可分性答案很简单），而且还在寻找对它为什么的“直观”解释其实**离制服**还差得很远。

这是看待它的一种方式。假设您从初始数组`[1, 2, ..., n]`（其中 n 可能是 3、52 或其他）开始并应用这两种算法之一。如果所有排列都是一致可能的，那么 1 保持在第一个位置的概率应该是`1/n`。事实上，在第二个（正确的）算法中，它*是* `1/n`，当且仅当它没有被第一次交换时，1 停留在它的位置，即当且仅当初始调用`rand(0,n-1)`返回 0。
但是，在第一个（错误的）算法中, 1 只有在第一次*和任何其他时间**都没有*交换时才保持不变- 即，只有第一次返回 0 并且其他任何时候*都没有**`rand`*`rand`s 返回 0，其概率是 (1/n) * (1-1/n)^(n-1) ≈ 1/(ne) ≈ 0.37/n，而不是 1/n。**

 ****这就是“直观”的解释：在您的第一个算法中，较早的项目比后来的项目更容易被交换，因此您得到的排列偏向于早期项目*不在*其原始位置的模式。**

（比这更微妙一些，例如 1 可以被交换到后面的位置，但最终仍会通过一系列复杂的交换被交换回原位，但这些概率相对不那么重要。）

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-05-13T17:21:53.440

我看到的关于这种效果的最佳解释来自 Jeff Atwood 在他的*CodingHorror*博客（天真[的危险](https://blog.codinghorror.com/the-danger-of-naivete/)）中。

使用此代码模拟 3 张牌随机洗牌...

```
for (int i = 0; i < cards.Length; i++)
{
    int n = rand.Next(cards.Length);
    Swap(ref cards[i], ref cards[n]);
} 
```

...你得到这个分布。

![3张牌洗牌分配](https://codinghorror.typepad.com/.a/6a0120a85dcdae970b0120a86da1f3970b-pi)

洗牌代码（上图）产生 3^3 (27) 种可能的牌组组合。但数学告诉我们，真的只有 3 个！或 3 张牌组的 6 种可能组合。所以一些组合被过度代表了。

您需要使用[Fisher-Yates 洗牌](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)来正确（随机）洗牌。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-13T20:48:32.730

这是另一种直觉：除非至少已经存在 2 向对称性，否则单次 shuffle 交换不能在占据位置的概率上创建对称性。调用三个位置 A、B 和 C。现在让 a 是卡片 2 在位置 A 的概率，b 是卡片 2 在位置 B 的概率，c 是它在位置 C 的概率，先验交换动作。假设没有两个概率是相同的：a!=b、b!=c、c!=a。现在计算卡片在交换后位于这三个位置的概率 a'、b' 和 c'。假设这个交换动作包括随机交换位置 C 与三个位置之一。然后：

```
a' = a*2/3 + c*1/3
b' = b*2/3 + c*1/3
c' = 1/3. 
```

也就是说，牌在位置 A 结束的概率是它已经在那里的概率乘以位置 A 不参与交换的时间的 2/3，再加上它在位置 C 的概率乘以 1 /3 C 与 A 交换的概率，等等。现在减去前两个方程，我们得到：

```
a' - b' = (a - b)*2/3 
```

这意味着因为我们假设 a!=b，所以 a'!=b'（尽管随着时间的推移，如果有足够的交换，差异将接近 0）。但是由于a'+b'+c'=1，如果a'!=b'，那么两者都不等于c'，也就是1/3。因此，如果这三个概率在交换之前开始都不同，那么它们在交换之后也会不同。无论交换哪个位置，这都会成立——我们只是交换了上面变量的角色。

现在第一次交换开始于将位置 A 的卡 1 与其他卡交换。在这种情况下，在交换之前有两种对称性，因为卡片 1 在位置 B 的概率 = 卡片 1 在位置 C = 0 的概率。所以事实上，卡片 1 可以以对称概率结束，它确实会结束在三个位置中的每一个位置都具有相等的概率。对于所有后续掉期，这仍然适用。但是卡片 2 在第一次交换后以概率 (1/3, 2/3, 0) 出现在三个位置，同样，卡片 3 以概率 (1/3, 0, 2/3) 出现在三个位置. 因此，无论我们随后进行多少次交换，我们都不会以卡 2 或 3 占据所有三个位置的概率完全相同。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T17:34:56.693

请参阅编码恐怖文章[“天真的危险”](https://blog.codinghorror.com/the-danger-of-naivete/)。

基本上（假设 3 张牌）：

> 天真的洗牌会产生 33 (27) 种可能的牌组组合。这很奇怪，因为数学告诉我们实际上只有 3 个！或 3 张牌组的 6 种可能组合。在 KFY 洗牌中，我们从初始顺序开始，从第三个位置与三张牌中的任何一张交换，然后从第二个位置再次与剩余的两张牌交换。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T01:40:42.427

简单的答案是该算法有 52^52 种可能的运行方式，但只有 52 种！52张卡片的可能排列。为了使算法公平，它需要以同样的可能性产生这些排列中的每一个。52^52 不是 52 的整数倍！因此，某些安排必须比其他安排更有可能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-18T09:12:49.100

一个说明性的方法可能是这样的：

1) 只考虑 3 张牌。

2) 为了让算法给出均匀分布的结果，“1”最终成为 a[0] 的机会必须是 1/3，“2”最终成为 a[1] 的机会也必须是 1/3 ，等等。

3）所以如果我们看第二种算法：

> "1" 以 a[0] 结尾的概率：当 0 是生成的随机数时，因此 (0,1,2) 中的 1 个案例是 3 个中的 1 个 = 1/3
> 
> “2”以 a[1] 结尾的概率：第一次没有交换到 a[0]，第二次没有交换到 a[2]：2/3 * 1 /2 = 1/3
> 
> “3”以 a[2] 结尾的概率：第一次没有交换到 a[0]，第二次没有交换到 a[1] 时：2/3 * 1 /2 = 1/3
> 
> 它们都是完美的 1/3，我们在这里看不到任何错误。

4）如果我们尝试计算“1”在第一个算法中以 a[0] 结尾的概率，计算会有点长，但正如 lassevk 答案中的插图所示，它是 9/27 = 1 /3，但以 a[1] 结尾的“2”有 8/27 的机会，而以 a[2] 结尾的“3”有 9/27 = 1/3 的机会。

结果，“2”最终作为 a[1] 不是 1/3，因此该算法将产生相当倾斜的结果（大约 3.7% 的错误，而不是任何可忽略的情况，例如 3/10000000000000 = 0.00000000003%）

5) Joel Coehoorn 所拥有的证明，实际上可以证明某些情况会被过度代表。我认为为什么是n^n的解释是这样的：在每次迭代中，随机数有n个可能，所以在n次迭代之后，可以有n^n个案例= 27。这个数字不除在 n = 3 的情况下，排列的数量（n！= 3！= 6）均匀，因此某些结果被过度表示。他们被过度代表的方式不是出现 4 次，而是出现 5 次，所以如果你从最初的 1 到 52 顺序洗牌数百万次，过度代表的案例将出现 500 万次而不是 400 万次，这是相当大的差异。

6）我认为显示了过度代表，但是“为什么”会发生过度代表？

7) 对算法正确性的最终测试是任何数字都有 1/n 的概率最终出现在任何插槽中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-13T23:50:01.277

[这是对洗牌马尔可夫链](http://projecteuclid.org/DPubS?service=UI&version=1.0&verb=Display&handle=euclid.aoap/1075828054)的一个很好的分析。哦，等等，这都是数学。对不起。:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-18T16:43:33.823

Naive 算法选择 n 的值，如下所示：

n = 兰德(3)

n = 兰德(3)

n = 兰德(3)

3^3 种可能的 n 组合

1,1,1, 1,1,2....3,3,2 3,3,3（27 种组合）lassevk 的答案显示了这些组合的牌之间的分布情况。

更好的算法：

n = 兰德(3)

n = 兰德(2)

嗯！n 的可能组合

1,1, 1,2, 2,1 2,2 3,1 3,2（6种组合，所有组合都给出不同的结果）

如其他答案中所述，如果您尝试 27 次获得 6 个结果，则不可能获得均匀分布的 6 个结果，因为 27 不能被 6 整除。将 27 个弹珠放入 6 个桶中，无论您做什么，有些水桶会比其他水桶有更多的弹珠，你能做的最好的是 4,4,4,5,5,5 弹珠用于水桶 1 到 6。

幼稚洗牌的根本问题是交换太多次，要完全洗牌 3 张牌，你只需要交换 2 次，第二次交换只需在前两张牌之间，因为第三张牌已经有 1/3被交换的机会。继续交换卡片将赋予给定卡片被交换的更多机会，如果您的总交换组合可被 6 整除，这些机会只会平均为 1/3、1/3、1/3。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-31T13:26:13.567

并不是说需要另一个答案，但我发现尝试弄清楚为什么 Fisher-Yates*是*统一的是值得的。

如果我们谈论的是一个有 N 个项目的套牌，那么这个问题是：我们如何证明

```
Pr(Item i ends up in slot j) = 1/N? 
```

用条件概率分解它，`Pr(item i ends up at slot j)`等于

```
Pr(item i ends up at slot j | item i was not chosen in the first j-1 draws)
* Pr(item i was not chosen in the first j-1 draws). 
```

并从那里递归地扩展回第一次抽奖。

`i`现在，第一次抽奖时未绘制元素的概率为`N-1 / N`。并且它在第二次抽签中没有被抽到的概率取决于它在第一次抽签时*没有抽到的事实，*`N-2 / N-1`依此类推。

因此，我们得到元素`i`在第一次抽签中未绘制的概率`j-1`：

```
(N-1 / N) * (N-2 / N-1) * ... * (N-j / N-j+1) 
```

当然，我们知道，`j` *在没有早先被抽出的条件下*，它在回合中被抽出的概率是`1 / N-j`.

请注意，在第一项中，分子都取消了后续的分母（即`N-1`取消，`N-2`取消，一直`N-j+1`取消，只留下`N-j / N`）。

所以元素`i`出现在槽中的总体概率`j`为：

```
[(N-1 / N) * (N-2 / N-1) * ... * (N-j / N-j+1)] * (1 / N-j)
= 1/N 
```

正如预期的那样。

为了更全面地了解“简单洗牌”，它缺少的特定属性称为[可交换](http://en.wikipedia.org/wiki/Exchangeable_random_variables)性。由于创建 shuffle 的方式的“路径依赖性”（即遵循 27 条路径中的哪一条来创建输出），您无法将不同的组件随机变量视为可以以任何顺序出现. 事实上，这也许是为什么可交换性在随机抽样中很重要*的一个*激励例子。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-06-27T21:39:45.830

The clearest answer to show the first algorithm fails is to view the algorithm in question as a Markov chain of n steps on the graph of n! vertices of all the permutation of n natural numbers. The algorithm hops from one vertex to another with a transition probability. The first algorithm gives the transition probability of `1/n` for each hop. There are n^n paths the probability of each of which is `1/n^n`. Suppose the final probability of landing on each vertex is `1/n!` which is a reduced fraction. To achieve that there must be m paths with the same final vertex such that `m/n^n=1/n!` or `n^n = mn!` for some natural number `m`, or that `n^n` is divisible by `n!`. But that is impossible. Otherwise, n has to be divisible by `n-1` which is only possible when `n=2`. We have contradiction.

# sql - 防止 Oracle 减号语句删除重复项

> ID：859255
> 
> 赞同：8
> 
> 时间：2009-05-13T17:18:30.903
> 
> 标签：sql, oracle

鉴于这两个表：

```
CREATE TABLE TEST1 (TEST  VARCHAR2(1 BYTE))
CREATE TABLE TEST2 (TEST  VARCHAR2(1 BYTE)) 
```

其中 TEST1 有两行的值为“A”，而 TEST2 的一行的值为“B”。

当我运行这个命令时：

```
SELECT TEST FROM TEST1
MINUS
SELECT TEST FROM TEST2 
```

我得到输出：

```
Test
-----
A 
```

MINUS 似乎删除了重复项（因为 TEST1 中有两个“A”行）。

如何让 MINUS 查询包含重复值（返回两个“A”行）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T19:05:14.020

另外一个选项：

```
SELECT TEST, row_number() OVER (PARTITION BY TEST ORDER BY TEST) FROM TEST1
MINUS
SELECT TEST, row_number() OVER (PARTITION BY TEST ORDER BY TEST) FROM TEST2 
```

这将是 MINUS，每个重复项都被视为一个不同的条目。请注意，在下面的示例中，如果 TEST1 有两个“C”值，而 TEST2 只有一个，则您会在输出中得到一个。

```
dev> select * from test1;

T
-
A
A
B
C
C

dev> select * from test2;

T
-
B
C

dev>     SELECT TEST, row_number() OVER (PARTITION BY TEST ORDER BY TEST) FROM TEST1
  2      MINUS
  3      SELECT TEST, row_number() OVER (PARTITION BY TEST ORDER BY TEST) FROM TEST2
  4  /

T ROW_NUMBER()OVER(PARTITIONBYTESTORDERBYTEST)
- --------------------------------------------
A                                            1
A                                            2
C                                            2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T17:32:08.650

```
SELECT field1 FROM table1 WHERE field1 NOT IN (SELECT field2 FROM table2) 
```

只要 field2 不能包含 NULL，就可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T02:26:54.943

“NOT IN”的答案都是正确的。在某些情况下可能更容易的替代方法是“NOT EXISTS”运算符：

```
SELECT TEST FROM TEST1
WHERE NOT EXISTS
(SELECT null FROM TEST2 WHERE TEST2.TEST = TEST1.TEST); 
```

（注意：select子句中的“null”在这里没有意义）

我个人使用这两种方法，但我经常喜欢 NOT EXISTS，因为它更灵活 - 例如，它不需要比较处于相等条件。

最新版本的优化器通常会将 NOT IN 转换为 NOT EXISTS，反之亦然；但是，如果您使用的是旧版本（例如，我认为是 8i 甚至 9i），您可能会看到在这两种方法之间切换带来的性能优势。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T17:28:34.070

ALL 修饰符使 UNION 返回所有行（例如，UNION ALL），也许它可以应用于 MINUS？如在

```
select field1 from table1
minus all
select field2 from table2 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T17:31:35.420

减号的部分作用是删除重复项。考虑使用 NOT IN 以避免删除重复项。

```
SELECT TEST FROM TEST1 WHERE TEST NOT IN(SELECT TEST FROM TEST2) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T08:18:15.707

Oracle 在 IN 语句中支持多列，所以可以这样写：

```
SELECT a, b, c
FROM table1
WHERE (a,b,c) not in (
    select a,b,c from table2
) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-19T19:40:56.260

```
SELECT TEST FROM TEST1 WHERE TEST IN(
SELECT TEST FROM TEST1
MINUS
SELECT TEST FROM TEST2); 
```

# mysql - 哪些工具可用于记录遗留数据库架构（PDF、DOC、HTML、RTF）

> ID：859259
> 
> 赞同：6
> 
> 时间：2009-05-13T17:19:17.767
> 
> 标签：mysql, database, documentation-generation, data-dictionary

我需要为新员工记录遗留数据库架构，并且由于没有设计文档，我想从现有架构生成一个。由于这些表是 MyISAM，因此外键关系不会产生漂亮的图表。我有兴趣制作一份显示重要表格、它们的列、类型和备注的文档。

是否有任何工具可用于从数据库模式元数据生成漂亮的文档（PDF、DOC、HTML 或 RTF）？还是我最好编写一个实用程序来自己导出它（我想将它转储到 XML，然后使用 XSLT 转换它）？该模式在 MySQL 5 上运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T11:07:51.140

经过一些研究并查看了可用的选项后，我决定使用非常想要的[模式间谍。](http://schemaspy.sourceforge.net/)

它以合理的格式生成结果，但还提供了元数据的 XML 转储，我可以使用它来编写 XSLT 转换以匹配我最初想要的。

提示来自对[问题 1869](https://stackoverflow.com/questions/1869/6317#6317)的回答。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T17:49:54.127

你可以使用[MySQL Workbench](https://dev.mysql.com/downloads/workbench/)或者他的祖先[DBdesigner 4](http://fabforce.net/dbdesigner4/index.php)（开源）：

1.  使用“逆向工程”工具以图形方式捕获所有数据库图。
2.  调整和评论您需要的任何内容。
3.  使用插件菜单中包含的 HTML 报告插件。

完毕！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T19:56:52.187

DeZign for Databases 可以为您做到这一点。导入数据库后完成自动布局。您最终可以重新排列图表中的对象，然后从您的数据库中生成一个 html（或 pdf）报告，包括一个可点击的图表。 [数据库设计](http://www.datanamic.com/dezign/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T17:29:17.127

如果您使用的是 PHPmyAdmin，则可以切换到 Designer 选项卡以获取可视模式。如果您只想显示表关系，则可以打印/截屏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T17:35:38.380

Sybase Powerdesigner，是对数据库进行逆向工程的最佳工具之一，可以生成漂亮的图表和漂亮的导出。

# asp.net - VS2008 Web 部署项目部分替换为 Elmah

> ID：859266
> 
> 赞同：11
> 
> 时间：2009-05-13T17:21:17.967
> 
> 标签：asp.net, visual-studio-2008, elmah, web-deployment-project

我正在使用一个 Web 部署项目，并希望用 emlah/errorMail 部分替换一些部分。我不想在调试构建模式下发送电子邮件。

我创建了自定义部分并将其放入 errorMail.config 中。在替换下的 web 部署项目的属性中，我有 elmah/errorMail=errorMail.config。

我得到的错误是为 elmah/errorMail 创建配置节处理程序时发生错误：无法加载文件或程序集“Elmah”或其依赖项之一。该系统找不到指定的文件。

我猜这是因为 Elmah 不在 GAC 中，或者它不是我的项目之一。Elmah.dll 文件确实可以复制到 output\bin 文件夹中。

有没有办法让部分替换与第 3 方 dll 一起使用？

[编辑]

我发现如果我将有问题的 dll 放入 Web 部署项目的项目文件夹中，它会正常工作。这不是最佳的。

所以现在我的问题是，我怎样才能让它工作而不必将 dll 放入 GAC 或将 dll 复制到 Web 部署项目文件夹中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T20:28:59.857

如果您从 web 项目中添加对 elmah dll 的引用，那么它会在您构建时自动将 dll 复制到输出文件夹。

这些是仅有的 2 个选项：将 dll 复制到输出目录或将其放入 GAC

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-13T21:45:00.837

[此处提出](http://forums.asp.net/t/997581.aspx)的一种技术在 Web 部署构建过程中动态加载程序集，因此它不必在 GAC 中。我试过了，但无法让它工作。

# c++ - 将 += 与字符串一起使用时的 Stange 段错误

> ID：859267
> 
> 赞同：1
> 
> 时间：2009-05-13T17:21:20.383
> 
> 标签：c++, std

必须有一些明显的东西我没有意识到这个关于 C++ 的东西。

```
load(string & filename){

 string command;
 char delimiter = '/';
 size_t delimiterPos = filename.rfind(delimiter);
 string directory = string(filename.c_str(),delimiterPos);
 command = "import path ";

  //want to add directory to end of command
  string temp = command + "hello!"; // This works
  command.append(directory); //This works!
  command += directory;  //This seg faults!
  ...
} 
```

在 GDB 中，当我在函数开头“打印”文件名时，我得到： (const string &) @0x9505f08: {static npos = 4294967295, _M_dataplus = {> = {<__gnu_cxx::new_allocator> = {}, }, _M_p = 0x950a8e4 "../config/pythonFile.py"}}

到底是什么，文件名的格式如何不正确，这样 .append() 有效而 += 无效？！C++ 中的重载函数 += 有什么奇怪的吗？

g++ 版本 3.4.6

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T17:48:51.757

也许这与您在这里构建“目录”的方式有关

```
 size_t delimiterPos = filename.rfind(delimiter);
 string directory = string(filename.c_str(),delimiterPos); 
```

rfind 是否以某种方式失败？如果 rfind 失败，它将返回[此处](http://msdn.microsoft.com/en-us/library/d994he8y(VS.80).aspx)指定的 std::npos 。如果您将 npos 传递给字符串构造函数，我不确定会发生什么行为。它可能取决于平台。

这不能回答为什么“附加”会起作用而“+=”会崩溃。您可能还存在某种堆损坏（可能是由传递给上面构造函数的 npos 和 C 字符串引起的），并且可能在调用 += 时需要分配新内存。出于任何原因追加可能不需要分配新内存。

无论如何，添加对 npos 的检查是明智的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T17:42:46.823

我无法重现您的问题。下面的文件在这里与 g++ 一起工作：

```
#include <string>
#include <iostream>

using namespace std;

int main(int, char**)
{
 string filename("a/b/c/d");

 string command;
 char delimiter = '/';
 size_t delimiterPos = filename.rfind(delimiter);
 string directory = string(filename.c_str(),delimiterPos);
 command = "import path ";

  //want to add directory to end of command
  string temp = command + "hello!"; // This works
  command.append(directory); //This works!
  cout << command << endl;

  command += directory;  //This seg faults!
  cout << command << endl;

} 
```

输出：

```
$ g++ -o t t.cpp
$ ./t
import path a/b/c
import path a/b/ca/b/c 
```

# algorithm - 以 10 为底的数字显示算法 - 每次刷新的最小更改

> ID：859270
> 
> 赞同：1
> 
> 时间：2009-05-13T17:22:16.530
> 
> 标签：algorithm, signal-processing, signal-handling

**快速总结：**

我正在寻找一种算法来显示四位数的速度信号，这样每次显示更新时都会更改（十进制）的最小位数。

例如：

```
Filtered
 Signal      Display
--------------------
  0000        0000
  2345        2000
  2345        2300
  2345        2340
  0190        0340
  0190        0190
  0190        0190 
```

* * *

**细节：**

我正在做一个项目，我需要在四位 LCD 显示器上显示速度信号（0 到 3000 RPM 之间）。理想的显示解决方案是模拟仪表，但我坚持使用数字显示。显示器将由机器操作员阅读，我希望阅读起来尽可能愉快。

操作员并不真正关心信号的确切值。他会想知道这个值是多少（精确到 10 RPM），并且他会想看到它随着机器运行的变化而上下波动。他*不想*看到它到处乱跳。

这是我到目前为止所做的：

*   将数字四舍五入到最接近的 10 RPM，以便最后一位始终为 0
*   过滤信号，使电噪声和正常的传感器波动不会导致读数一次跳跃超过 10 RPM。
*   为信号添加了一个 +/-10 RPM 滞后，以避免在相同值上摆动的情况（例如：990 - 1000）

当信号稳定时（大约 75% 的时间），这已经很好地清理了事情，但是**当信号从一个稳定状态移动到另一个稳定状态时，我仍然看到很多不必要的变化**。当信号从 100 RPM 变为 1000 RPM（例如）时，它会一路经过很多数字。由于实际阅读和理解数字需要一点时间，因此达到所有这些中间状态似乎没有什么意义。我尝试简单地降低显示器的更新率，但这并没有产生令人满意的结果。它同时让显示器“感觉”迟缓和跳跃。在数字发生变化之前会有明显的延迟，然后它们会大幅跃升（100、340、620、980、1000）。

* * *

**提议：**

我希望显示器的行为如示例所示：

1.  显示每秒更新两次
2.  从一种稳态过渡到另一种稳态的时间不应超过 2 秒。
3.  如果输入信号高于当前显示值，则显示信号应增加，但绝不应高于输入信号值。
4.  如果输入信号低于当前显示值，则显示信号应减小，但决不能低于输入信号值。
5.  每次更新应更改的最小位数（最好只有一位）
6.  应先改变高位数字，使显示信号与输入信号的差异尽快减小

**你能想出，或者你知道根据上述规则输出“正确”的 4 位十进制数的算法吗？**

伪代码中的函数原型看起来像这样：

```
int GetDisplayValue(int currentDisplayValue, int inputSignal)
{
    //..
} 
```

对不起，文字墙。我想记录我迄今为止的进展，以便任何回答这个问题的人都避免覆盖我已经经历过的基础。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T20:36:21.783

如果您不需要第4位表示的数据，并且严格绑定到4位显示，您是否考虑过使用第4位作为增减指标？以 2Hz* 闪烁零的顶部或底部的某些部分，以指示仪表的下一个变化将是增加或减少。

我认为你也可以很好地为你的设备的响应建立一个很好的模型，不管它是什么，调整，并使用该模型根据两秒稳定过程的前半秒推断目标数字。

*这假设您每秒有两次更新。大多数 4 位显示器都是多路复用的，因此您可以通过稍微调整驱动程序以更高的频率闪烁它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T20:36:32.077

我认为您一次更改一位数字的建议很奇怪，因为它实际上为用户提供了错误信息……我会考虑实际上是添加更多的状态更改，并实施它，以便每当信号更改时，他们仪表以 1 为增量向新值移动。这将提供模拟量表般的体验和变化的“动画”；操作员很快就会下意识地认出数字按顺序旋转 0,1,2... 表示速度增加，而 9,8,7,... 速度减少。

例如：

```
Filtered signal      Display
0000                 0000
2345                 0001
                     0002
                     ...
                     2345 
```

您实施的滞后当然对稳定状态非常有利。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T15:22:57.277

这将或多或少缓慢地将传感器值合并到显示值中：

```
display = ( K * sensor + (256 - K) * display ) >> 8 
```

在 0（显示从不更新）和 256（显示始终等于传感器）之间选择 K。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T15:14:42.867

这是一个微妙的问题，我的回答不涉及算法方面。

我相信您在发帖开始时在表格中表示的行为是一个非常糟糕的主意。为了用户体验，第 2 行和第 5 行显示了数据中存在和从未存在的数据点，即错误数据。这在机器操作领域可能是一个糟糕的选择。

较低的更新率可能“感觉迟缓”，但定义明确（只有“真实”数据，最多 n 毫秒）。较快的更新速率将显示许多中间值，但最高有效位不应快速更改。两者都比任何非常错误的值生成更容易测试。

# java - 多个 Swing 事件调度线程

> ID：859274
> 
> 赞同：2
> 
> 时间：2009-05-13T17:23:09.180
> 
> 标签：java, multithreading, swing, modal-dialog, ui-thread

我想在 Swing 中创建一个新的事件调度线程，但我在网上找不到任何关于如何执行此操作的参考资料。我通过创建一个新线程并调用 Application.run(...) 在 .NET 中完成了这项工作。有人做过吗？在 Swing 中可以吗？

仅供参考，我尝试这样做的原因是因为我正在编写一个 Eclipse 插件，并且我想弹出对 IDE 来说不是模态但对我的 UI 逻辑来说是模态（阻塞）的对话框。我可以使用非模态对话框和回调来完成此操作，但这需要使我的代码成为多线程的开销。如果前者是不可能的，我会恢复到那个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-12T11:16:51.327

是的，这是可能的。我已经在 Swing 中完成了这样的多个 EDT 调度线程逻辑。然而，最终结果是它不能可靠地工作。

(a) 所有 JVM 都不能很好地与多个 EDT 线程一起工作（本机代码中的图形渲染逻辑中的同步问题等，IBM JVM 因多个 EDT 线程而失败，Sun JVM 和 Apple JVM 确实有效）

(b) Swing 渲染逻辑很少有导致随机渲染错误发生的错误（例如，[http://bugs.sun.com/bugdatabase/view_bug.do](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6727829) ?bug_id=6727829 ）。

无论如何，这样做基本上需要建立两个 AppContext，每个都有自己的 EDT 线程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T17:35:12.887

我对你的问题有点困惑，因为你提到了 Swing，但又说你正在编写一个 Eclipse 插件。由于问题被标记为 Swing，我将给出 Swing 答案（但发布为 CW）。

有一个事件调度线程。总是有一个事件调度线程，除非根本没有。您不能创建另一个。

但是，您可以更改[`ModalityType`](http://java.sun.com/javase/6/docs/api/java/awt/Dialog.ModalityType.html)对话框的名称，或更改[`ModalExclusionType`](http://java.sun.com/javase/6/docs/api/java/awt/Dialog.ModalExclusionType.html)窗口的名称。在这种情况下，如果您自己编写这一切，您可以将顶层窗口设置`ModalExclusionType`为[`APPLICATION_EXCLUDE`](http://java.sun.com/javase/6/docs/api/java/awt/Dialog.ModalExclusionType.html#APPLICATION_EXCLUDE).

但同样，我看不出这对您有什么帮助，因为 Eclipse 使用 SWT 而不是 Swing。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T17:59:16.467

我将放弃我的最后一个答案并重新开始。

在 SWT 中，您可以通过在创建期间传递 SWT.PRIMARY_MODAL 样式标志来创建仅对父模式模式的[`Shell`](http://help.eclipse.org/stable/nftopic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/Shell.html)s（窗口）或自定义s。[`Dialog`](http://help.eclipse.org/stable/nftopic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/Dialog.html)

请注意，这`Dialog`是一个抽象类，因此您必须创建自己的类。它可能更容易使用`Shell`。

编辑：

为什么选择 SWT？因为那是 Eclipse 使用的。有关更多详细信息，请参阅：[Eclipse 平台插件开发人员指南](http://archive.eclipse.org/eclipse/downloads/drops/R-3.1-200506271435/org.eclipse.platform.doc.isv.3.1.pdf.zip)（压缩 PDF）。最新版本可在 Eclipse 的帮助系统中找到（帮助 > 帮助内容 > 插件开发环境指南。）

# sql - SQL Server 相当于 MySQL 的 USING

> ID：859277
> 
> 赞同：5
> 
> 时间：2009-05-13T17:24:52.717
> 
> 标签：sql, mysql, sql-server, join, using

在 MySQL 中，当您连接来自不同表的具有相同名称的列时，您可以在连接中使用关键字 USING。例如，这些查询产生相同的结果：

```
SELECT * FROM user INNER JOIN perm USING (uid)
SELECT * FROM user INNER JOIN perm ON user.uid = perm.uid 
```

SQL Server 中是否有等效的快捷方式？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-13T17:26:16.147

不，必须使用：

```
SELECT * FROM user INNER JOIN perm ON user.uid = perm.uid 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T17:38:15.363

不，SQL Server 不支持这种快捷方式。

我想指出，即使确实如此，像这样的捷径也不是一个好主意。我最近在开发一个数据库，开发人员认为使用`*= and =*`RIGHT JOIN 和 LEFT JOIN 的快捷方式是个好主意。好主意，直​​到有人将 SQL 兼容性级别升级到 90。然后它变成了一个非常糟糕的主意。

所以，向我们学习。捷径很糟糕。一点额外的打字永远不会杀死任何人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T17:47:24.490

另外，我会在您的选择语句中添加不要使用通配符“*” - 明确指定列名。

# python - 在 python 中获取 pdb 风格的调用者信息

> ID：859280
> 
> 赞同：1
> 
> 时间：2009-05-13T17:25:11.080
> 
> 标签：python, stack, pdb

假设我有以下方法（在类或模块中，我认为这不重要）：

```
def someMethod():
    pass 
```

我想在调用此方法时访问调用者的状态。

`traceback.extract_stack`只是给了我一些关于调用堆栈的字符串。

我想要这样的东西`pdb`，我可以在其中设置一个断点，`someMethod()`然后键入“u”以向上调用堆栈，然后检查系统的状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T18:13:30.843

我想到了：

```
import inspect

def callMe():
    tag = ''
    frame = inspect.currentframe()
    try:
        tag = frame.f_back.f_locals['self']._tag
    finally:
        del frame

    return tag 
```

# iphone - 如何将表视图连接到可排序数据源

> ID：859286
> 
> 赞同：0
> 
> 时间：2009-05-13T17:27:13.353
> 
> 标签：iphone, cocoa-touch

我有一个显示消息列表的表视图控制器。我希望用户能够为他们的消息选择不同的排序选项。一些可能的排序选项可能是最新的、已读/未读、发件人等。

我在自己的脑海中争论的是管理底层消息列表的正确方法。这是我目前的计划：

我有一个自定义 MessageList 模型对象。我将添加一个*sortedBy*属性，以便任何控制器都可以检查当前的排序方法并在需要时重新排序列表。MessageList 必须负责根据已选择的当前排序方法正确插入新消息。

我喜欢这种方法，因为我不必制作 MessageList 的排序副本。它还使控制器 (indexPath.row == indexOfMessageInList) 的事情变得简单。

有没有人遇到过类似的情况并发现了更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T17:36:33.353

计划似乎很可靠，我要做的是为 sortedBy 实现一个自定义设置器，并且每当它被调用时，`[tableView reloadData]`只要有实际变化就调用它。像这样的东西：

```
- (void) setSortedBy:(SEL)someSortMethod {
  # check if the sort method is new or not
  # perform operations on list to sort it
  sortedBy = someSortMethod;

  [self.tableView reloadData];
} 
```

# asp.net - 管理软件更新

> ID：859294
> 
> 赞同：0
> 
> 时间：2009-05-13T17:28:50.933
> 
> 标签：asp.net

我正在研究处理跨许多不同客户端更新 ASP.NET 应用程序的不同方法，并从您以前的经验中寻找建议。

*   我们需要客户端应用程序检查它们是否有任何可用的更新。
*   一种自动更新的方法（如果可能，类似于 chromes 但适用于 webapp）。
*   某种方式来检查我们是否是发送更新的人。（我猜是某种校验和）
*   任何其他提示/建议

谢谢

编辑：在一夜之间考虑了更多之后，我不得不同意自动更新可能不是最好的。然而，也许更符合 wordpress 如何做到这一点。Wordpress 将显示有可用更新，然后单击将自动更新系统。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T17:32:44.827

我绝对不会让您的应用程序在客户端上自动更新（假设您的意思是客户端是您组织外部的实体）服务器。我们将立即停止使用会“打电话回家”并自行更新的产品。客户端需要能够选择何时以及如何在其服务器上进行更新。

如果您要这样做，最简单的方法是设置系统可以每天 ping 一次的 URI 等，然后查看是否有可用的更新。如果是这样，应用程序会将其从主机系统中拉下来并自行更新。如果您使用 SSL 执行此操作，则证书将验证被命中的 URI 是您的公司。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T17:35:56.443

很难弄清楚您实际上是在谈论 Web 应用程序还是桌面应用程序。如果您正在尝试做类似于 Chrome 的事情......我猜是桌面应用程序。如果是这种情况...查看 ClickOnce 部署。

它提供了您提到的前三个要点：

1.  每次有人运行该应用程序时，它都会检查更新。
2.  如果找到更新，用户可以选择是否安装它们（比强制用户更新更好的用户体验）。
3.  该应用程序始终检查安装该应用程序的 URL……在您的情况下，该 URL 将是您的服务器。

# youtube - YouTube JS API：检测“嵌入已被禁用”

> ID：859296
> 
> 赞同：4
> 
> 时间：2009-05-13T17:29:28.747
> 
> 标签：youtube, youtube-api

使用 youtube javascript api ( [http://code.google.com/apis/youtube/js_api_reference.html](http://code.google.com/apis/youtube/js_api_reference.html) )，我试图允许用户将视频嵌入到他在我的应用程序中创建的一些内容中。除了能够检测和处理视频不允许嵌入的情况外，我已经完成了所有工作。

目前，播放器会加载并显示不允许播放的视频的缩略图，并且只有在用户尝试播放时才会出现错误。这很糟糕，因为用户在保存/发送他的内容之前可能不会播放视频。我想先发制人地检测到不允许嵌入视频，并向用户显示有用的消息。

我能看到的唯一解决方案是实际播放它（以编程方式）并处理此时引发的错误。

现有的解决方法：

1.  嵌入播放器 (embedSWF)
2.  onYouTubePlayerReady()：添加 onError onStateChange 事件监听器。
3.  onStateChange(newState)：当视频加载完毕后，尝试播放。
    例如 if (newState == 5 /* CUED */) { player.mute(); 播放器.playVideo(); 播放器.stopVideo(); 播放器.unMute(); }
4.  onError(error)：如果视频在 onStateChange 中播放失败，将在此处收到错误消息。

有没有更好的办法？

谢谢！
-抢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T04:50:23.777

您可以在嵌入之前获取该视频条目的 JSON 提要，并查看“yt$format”:5 是否存在，即嵌入的 SWF。如果嵌入被禁用，它将不存在。

[http://gdata.youtube.com/feeds/api/videos/video_id?v=2&alt=json-in-script](http://gdata.youtube.com/feeds/api/videos/video_id?v=2&alt=json-in-script)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-13T11:58:03.810

我认为您可能正在寻找`videoSyndicated`or`videoEmbeddable`参数。API 文档说：

# 视频可嵌入

> videoEmbeddable 参数允许您将搜索限制为仅可嵌入网页的视频。如果为此参数指定值，则还必须将 type 参数的值设置为 video。

参考：[https ://developers.google.com/youtube/v3/docs/search/list#videoEmbeddable](https://developers.google.com/youtube/v3/docs/search/list#videoEmbeddable)

# 视频辛迪加

> videoSyndicated 参数可让您将搜索限制为仅可在 youtube.com 之外播放的视频。如果为此参数指定值，则还必须将 type 参数的值设置为 video。

参考：[https ://developers.google.com/youtube/v3/docs/search/list#videoSyndicated](https://developers.google.com/youtube/v3/docs/search/list#videoSyndicated)

# 示例调用

既：

```
GET https://www.googleapis.com/youtube/v3/search?&part=snippet,statistics&videoSyndicated=true&videoEmbeddable=true&key=${yourKey} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-29T16:11:46.497

我知道这不是直接的问题，但万一使用 PHP 的人偶然发现了这个问题，`getNoEmbed()`在`Zend_Gdata_YouTube_VideoEntry`.

取自文档：

> 如果返回值为 的实例`Zend_Gdata_YouTube_Extension_NoEmbed`，则无法嵌入此视频。

# java - 使用 JPA 查询语言的表大小

> ID：859300
> 
> 赞同：13
> 
> 时间：2009-05-13T17:30:39.323
> 
> 标签：java, hibernate, jpa, jakarta-ee

使用 JPA 查询语言，如何确定实体（表）中的大小（行数）？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-13T17:44:11.907

使用计数聚合函数：

```
EntityManager em = ...
Query q = em.createQuery ("SELECT count(x) FROM Magazine x");
Number result = (Number) q.getSingleResult (); 
```

# c# - 与命名管道和远程处理相比，WCF 是否存在性能问题？

> ID：859301
> 
> 赞同：2
> 
> 时间：2009-05-13T17:30:44.673
> 
> 标签：c#, wcf, performance

我刚刚开始 WCF ......但是与旧的远程处理、Tcp 套接字或命名管道相比，这会进一步减慢进程间通信吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T00:56:06.627

不，性能不会慢。WCF 具有基于 TCP 和[命名管道](http://msdn.microsoft.com/en-us/library/system.servicemodel.netnamedpipebinding.aspx)的传输。换句话说，编程模型 (WCF) 独立于传输。这是 WCF 的基本原则之一。

WCF 可以并且将会使用最优的数据传输机制，并且您将获得良好的性能。*您应该对您的方案进行基准测试，但在大多数情况下，与传输后*的操作成本相比，数据传输的成本很小。

此外，[这里是一份比较 WCF 与替代品的性能的文档](http://msdn.microsoft.com/en-us/library/bb310550.aspx)，这是由 Microsoft 制作的分析。

# c++ - 将 CString 转换为 const char*

> ID：859304
> 
> 赞同：58
> 
> 时间：2009-05-13T17:31:34.937
> 
> 标签：c++, visual-studio, visual-c++, unicode, mfc

如何在我的 Unicode MFC 应用程序中从`CString`to转换？`const char*`

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-05-13T19:13:40.137

要将`TCHAR`CString 转换为 ASCII，请使用`CT2A`宏 - 这还允许您将字符串转换为 UTF8（或任何其他 Windows 代码页）：

```
// Convert using the local code page
CString str(_T("Hello, world!"));
CT2A ascii(str);
TRACE(_T("ASCII: %S\n"), ascii.m_psz);

// Convert to UTF8
CString str(_T("Some Unicode goodness"));
CT2A ascii(str, CP_UTF8);
TRACE(_T("UTF8: %S\n"), ascii.m_psz);

// Convert to Thai code page
CString str(_T("Some Thai text"));
CT2A ascii(str, 874);
TRACE(_T("Thai: %S\n"), ascii.m_psz); 
```

还有一个宏可以从 ASCII -> Unicode ( `CA2T`) 转换，只要你有 VS2003 或更高版本，你就可以在 ATL/WTL 应用程序中使用它们。

有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/87zae4a3(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-13T17:37:58.373

如果您的 CString 是 Unicode，则需要转换为多字节字符。幸运的是，有一个版本的 CString 可以自动执行此操作。

```
CString unicodestr = _T("Testing");
CStringA charstr(unicodestr);
DoMyStuff((const char *) charstr); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-13T17:35:03.963

*注意：这个答案早于 Unicode 要求；见评论。*

只需投射它：

```
CString s;
const TCHAR* x = (LPCTSTR) s; 
```

它之所以有效，是因为 CString 有一个强制转换运算符来执行此操作。

使用 TCHAR 使您的代码独立于 Unicode；如果您不关心 Unicode，您可以简单地使用`char`而不是`TCHAR`.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-13T17:36:33.447

CString 有一个明确的转换为 LPCTSTR，所以你可以这样做（如果没有指定 unicode）：

```
CString str;
// ....
const char* cstr = (LPCTSTR)str; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-09-22T19:38:19.673

我有一个类似的问题。我有一个`char*`带有 .so 名称的缓冲区。
我无法将`char*`变量转换为`LPCTSTR`. 这就是我如何解决它...

```
char *fNam;
...
LPCSTR nam = fNam;
dll = LoadLibraryA(nam); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-12T09:46:51.793

我建议你使用来自 ConvUnicode.h 的 TtoC

```
const CString word= "hello";
const char* myFile = TtoC(path.GetString()); 
```

它是一个宏，用于按 Unicode 进行转换

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-17T05:43:43.737

通用转换宏（TN059 其他注意事项部分很重要）：

```
A2CW     (LPCSTR)  -> (LPCWSTR)  
A2W      (LPCSTR)  -> (LPWSTR)  
W2CA     (LPCWSTR) -> (LPCSTR)  
W2A      (LPCWSTR) -> (LPSTR) 
```

*   [TN059：使用 MFC MBCS/Unicode 转换宏](https://msdn.microsoft.com/en-us/library/805c56f8.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-24T06:35:47.950

我使用了这个转换：

```
CString cs = "TEST";
char* c = cs.GetBuffer(m_ncs me.GetLength()) 
```

我希望这很有用。

# javascript - 创建 cookie onunload（即使在删除浏览器缓存之后）

> ID：859306
> 
> 赞同：2
> 
> 时间：2009-05-13T17:31:42.630
> 
> 标签：javascript, cookies, privacy

在用户完全删除他/她的浏览器缓存 (+cookies) 后是否可以创建 cookie？

例如加载到内存中的预定义变量

```
var userID = 1337;
var IP = 222.222.222.222;
var trackingUID = 'LaughingAtDancingFooBars'; 
```

如果上述存储数据的方法不起作用，则可能将数据存储在文档中。在表单输入元素内 - 然后读取？

```
<input type="hidden" value="1337" id="userID "/>
<input type="hidden" value="222.222.222.222" id="IP"/>
<input type="hidden" value="LaughingAtDancingFooBars" id="trackingUID"/>

<body onunload="makeCookies(userID, IP, TrackingUID)">

makeCookies(){
document.cookie=tracking = userID, ip etc...
} 
```

只是快速观察一下.. 当用户离开页面时，Javascript 仍然可以读取内存中的内容，如果没有，则读取文档中的内容。有了这个我们可以再次写入cookie吗？- 即使用户已清除浏览器缓存。

真正的问题是，这不会成为某种隐私问题吗？- 如果它有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T19:34:14.363

这是我对您的问题的理解：如果用户在您的页面上并决定删除他们的所有缓存，包括他们的 cookie，您可以在离开页面时重新创建 cookie（即`onunload`）吗？如果是这样，安全问题是什么？

如果我理解你的问题是正确的，那么答案是肯定的，你可以。但是，关注安全的用户始终可以将其`about:blank`作为浏览器中的唯一选项卡，**然后**删除他们的缓存，从而确保您的 cookie 被删除并且不会被重新创建。

大多数用户会这样做吗？可能不是。但希望这将有助于回答您的问题。

# delphi - Delphi：TOleControl 将 ActiveControl 置于错误状态？

> ID：859307
> 
> 赞同：2
> 
> 时间：2009-05-13T17:32:02.317
> 
> 标签：delphi, focus, ole, delphi-xe6, twebbrowser

在 Mike Lischke 的[Virtual Treeview 中](http://www.delphi-gems.com/VirtualTreeview/)，添加了解决方法代码以修复在同一窗体上使用**TWebBrowser控件时出现的错误。**

问题在于，如果用户尝试与**TOleControl**（**TWebBrowser 从中**下降）进行交互，第一次鼠标点击就会被吃掉。然后他们必须再次单击以赋予控制焦点。**然后**他们可以与控件交互。

他有评论要解释：

> 派生自的每个控件`TOleControl`都有潜在的焦点问题。
> 
> 为了避免包含允许测试类的**OleCtrls**单元（其中将包含**Variants** ），该接口用于测试，这是一个很好的指标。`TOleControl``IOleClientSite``TOleControl`

从完整的片段：

```
procedure TBaseVirtualTree.WMKillFocus(var Msg: TWMKillFocus);
var
  Form: TCustomForm;
  Control: TWinControl;
  Pos: TSmallPoint;
  Unknown: IUnknown;
begin
  inherited;

  [snip]

  {
    Workaround for wrapped non-VCL controls (like TWebBrowser), 
    which do not use VCL mechanisms and 
    leave the ActiveControl property in the wrong state, 
    which causes trouble when the control is refocused.
  }
  Form := GetParentForm(Self);
  if Assigned(Form) and (Form.ActiveControl = Self) then
  begin
    Cardinal(Pos) := GetMessagePos;
    Control := FindVCLWindow(SmallPointToPoint(Pos));
    {
      Every control derived from TOleControl has potentially 
      the focus problem. In order to avoid including 
      the OleCtrls unit (which will, among others, include Variants),  
      which would allow to test for the TOleControl
      class, the IOleClientSite interface is used for the test, 
      which is supported by TOleControl and a good indicator.
    }
    if Assigned(Control) and Control.GetInterface(IOleClientSite, Unknown) then
      Form.ActiveControl := nil;

    // For other classes the active control should not be modified. Otherwise you need two clicks to select it.
  end;
end; 
```

问题是解决方法不再对我有用。老实说，我不知道问题到底是什么，以及他的解决方案是如何解决的。

有没有人知道他的评论理解他在说什么，可以解释问题是什么，以及他应该如何解决问题？

> 包装的非 VCL 控件（如 TWebBrowser）的解决方法，这些控件不使用 VCL 机制，并使 ActiveControl 属性处于错误状态，这会在控件重新聚焦时引起问题。从 TOleControl 派生的每个控件都有潜在的焦点问题。

代码达到预期

```
Form.ActiveControl := nil; 
```

声明，但它只是没有做的伎俩。

我会修复它，但我不知道他是如何找到它的，也不知道**TOleControl**不“*使用 VCL 机制并让 ActiveControl 属性处于错误状态*”的原因。

* * *

# 奖金阅读

[我最初在 2008 年](https://groups.google.com/forum/#!topic/borland.public.delphi.nativeapi.win32/AZpYwJuttIM)[在](https://groups.google.com/forum/#!topic/borland.public.delphi.nativeapi.win32/AZpYwJuttIM) 新闻组上问过这个问题[`borland.public.delphi.nativeapi.win32`](https://groups.google.com/forum/#!topic/borland.public.delphi.nativeapi.win32/AZpYwJuttIM)

[Soft-Gems 论坛上的问题](http://support.soft-gems.net/forums/viewtopic.php?t=2259)

**Bump 20110515**（12 个月后）

**Bump 20150401**（7 年后）：在 XE6 中仍然不起作用

**凹凸20210309**（11年后）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T05:53:12.357

我通过使用 TEmbeddedWB（比标准的 TWebBrowser 好得多）克服了这个问题，然后我不得不添加这个 OnShowUI 事件：

```
function THtmlFrame.webBrowserShowUI(const dwID: Cardinal;
  const pActiveObject: IOleInPlaceActiveObject;
  const pCommandTarget: IOleCommandTarget; const pFrame: IOleInPlaceFrame;
  const pDoc: IOleInPlaceUIWindow): HRESULT;
begin
  try
    if WebBrowser.CanFocus then
      WebBrowser.SetFocus; // tell the VCL that the web-browser is focused
  except
    on E: EInvalidOperation do
      ; // ignore "Cannot focus inactive or invisible control"
  end;
  Result := S_FALSE;
end; 
```

但是如果你必须使用 TWebBrowser 你需要编写更多的代码：

```
type
  IDocHostUIHandler = interface(IUnknown)
    ['{bd3f23c0-d43e-11cf-893b-00aa00bdce1a}']
    function ShowContextMenu(const dwID: DWORD; const ppt: PPOINT;
      const CommandTarget: IUnknown; const Context: IDispatch): HRESULT; stdcall;
    function GetHostInfo(var pInfo: TDOCHOSTUIINFO): HRESULT; stdcall;
    function ShowUI(const dwID: DWORD; const pActiveObject: IOleInPlaceActiveObject;
      const pCommandTarget: IOleCommandTarget; const pFrame: IOleInPlaceFrame;
      const pDoc: IOleInPlaceUIWindow): HRESULT; stdcall;
    function HideUI: HRESULT; stdcall;
    function UpdateUI: HRESULT; stdcall;
    function EnableModeless(const fEnable: BOOL): HRESULT; stdcall;
    function OnDocWindowActivate(const fActivate: BOOL): HRESULT; stdcall;
    function OnFrameWindowActivate(const fActivate: BOOL): HRESULT; stdcall;
    function ResizeBorder(const prcBorder: PRECT; const pUIWindow: IOleInPlaceUIWindow; const fRameWindow: BOOL): HRESULT; stdcall;
    function TranslateAccelerator(const lpMsg: PMSG; const pguidCmdGroup: PGUID; const nCmdID: DWORD): HRESULT; stdcall;
    function GetOptionKeyPath(out pchKey: POLESTR; const dw: DWORD): HRESULT; stdcall;
    function GetDropTarget(const pDropTarget: IDropTarget; out ppDropTarget: IDropTarget): HRESULT; stdcall;
    function GetExternal(out ppDispatch: IDispatch): HRESULT; stdcall;
    function TranslateUrl(const dwTranslate: DWORD; const pchURLIn: POLESTR; out ppchURLOut: POLESTR): HRESULT; stdcall;
    function FilterDataObject(const pDO: IDataObject; out ppDORet: IDataObject): HRESULT; stdcall;
  end; // IDocHostUIHandler

  ICustomDoc = interface(IUnknown)
    ['{3050f3f0-98b5-11cf-bb82-00aa00bdce0b}']
    function SetUIHandler(const pUIHandler: IDocHostUIHandler): HResult; stdcall;
  end;

  TDocHostUIHandler = class(TInterfacedObject, IDocHostUIHandler)
  private
    FWebBrowser: TWebBrowser;
  protected
    function EnableModeless(const fEnable: BOOL): HResult; stdcall;
    function FilterDataObject(const pDO: IDataObject; out ppDORet: IDataObject): HResult; stdcall;
    function GetDropTarget(const pDropTarget: IDropTarget; out ppDropTarget: IDropTarget): HResult; stdcall;
    function GetExternal(out ppDispatch: IDispatch): HResult; stdcall;
    function GetHostInfo(var pInfo: TDocHostUIInfo): HResult; stdcall;
    function GetOptionKeyPath(var pchKey: POLESTR; const dw: DWORD): HResult; stdcall;
    function HideUI: HResult; stdcall;
    function OnDocWindowActivate(const fActivate: BOOL): HResult; stdcall;
    function OnFrameWindowActivate(const fActivate: BOOL): HResult; stdcall;
    function ResizeBorder(const prcBorder: PRECT; const pUIWindow: IOleInPlaceUIWindow;
      const fFrameWindow: BOOL): HResult; stdcall;
    function ShowContextMenu(const dwID: DWORD; const ppt: PPOINT;
      const pcmdtReserved: IInterface; const pdispReserved: IDispatch): HResult; stdcall;
    function ShowUI(const dwID: DWORD; const pActiveObject: IOleInPlaceActiveObject;
      const pCommandTarget: IOleCommandTarget; const pFrame: IOleInPlaceFrame;
      const pDoc: IOleInPlaceUIWindow): HResult; stdcall;
    function TranslateAccelerator(const lpMsg: PMSG; const pguidCmdGroup: PGUID; const nCmdID: DWORD): HResult; stdcall;
    function TranslateUrl(const dwTranslate: DWORD; const pchURLIn: POLESTR; var ppchURLOut: POLESTR): HResult; stdcall;
    function UpdateUI: HResult; stdcall;
  public
    constructor Create(AWebBrowser: TWebBrowser);
    property WebBrowser: TWebBrowser read FWebBrowser;
  end;

{ TDocHostUIHandler }

function TDocHostUIHandler.EnableModeless(const fEnable: BOOL): HResult;
begin
  Result := S_OK;
end;

function TDocHostUIHandler.FilterDataObject(const pDO: IDataObject; out ppDORet: IDataObject): HResult;
begin
  ppDORet := nil;
  Result := S_FALSE;
end;

function TDocHostUIHandler.GetDropTarget(const pDropTarget: IDropTarget; out ppDropTarget: IDropTarget): HResult;
begin
  ppDropTarget := nil;
  Result := E_FAIL;
end;

function TDocHostUIHandler.GetExternal(out ppDispatch: IDispatch): HResult;
begin
  ppDispatch := nil;
  Result := E_FAIL;
end;

function TDocHostUIHandler.GetHostInfo(var pInfo: TDocHostUIInfo): HResult;
begin
  Result := S_OK;
end;

function TDocHostUIHandler.GetOptionKeyPath(var pchKey: POLESTR; const dw: DWORD): HResult;
begin
  Result := E_FAIL;
end;

function TDocHostUIHandler.HideUI: HResult;
begin
  Result := S_OK;
end;

function TDocHostUIHandler.OnDocWindowActivate(const fActivate: BOOL): HResult;
begin
  Result := S_OK;
end;

function TDocHostUIHandler.OnFrameWindowActivate(const fActivate: BOOL): HResult;
begin
  Result := S_OK;
end;

function TDocHostUIHandler.ResizeBorder(const prcBorder: PRECT; const pUIWindow: IOleInPlaceUIWindow; const fFrameWindow: BOOL): HResult;
begin
  Result := S_FALSE;
end;

function TDocHostUIHandler.ShowContextMenu(const dwID: DWORD; const ppt: PPOINT; const pcmdtReserved: IInterface; const pdispReserved: IDispatch): HResult;
begin
  Result := S_FALSE
end;

function TDocHostUIHandler.TranslateAccelerator(const lpMsg: PMSG; const pguidCmdGroup: PGUID; const nCmdID: DWORD): HResult;
begin
  Result := S_FALSE;
end;

function TDocHostUIHandler.TranslateUrl(const dwTranslate: DWORD; const pchURLIn: POLESTR; var ppchURLOut: POLESTR): HResult;
begin
  Result := E_FAIL;
end;

function TDocHostUIHandler.UpdateUI: HResult;
begin
  Result := S_OK;
end;

function TDocHostUIHandler.ShowUI(const dwID: DWORD; const pActiveObject: IOleInPlaceActiveObject; const pCommandTarget: IOleCommandTarget;
  const pFrame: IOleInPlaceFrame; const pDoc: IOleInPlaceUIWindow): HResult;
begin
  try
    if WebBrowser.CanFocus then
      WebBrowser.SetFocus; // tell the VCL that the web-browser is focused
  except
    on E: EInvalidOperation do
      ; // ignore "Cannot focus inactive or invisible control"
  end;
  Result := S_OK;
end;

// install the DocHostUIHandler into the WebBrowser
var
  CustomDoc: ICustomDoc;
begin
  if WebBrowser1.Document.QueryInterface(ICustomDoc, CustomDoc) = S_OK then
    CustomDoc.SetUIHandler(TDocHostUIHandler.Create(WebBrowser1));
end; 
```

# .net - ASP.net MVC 中的会话结束

> ID：859309
> 
> 赞同：10
> 
> 时间：2009-05-13T17:32:18.727
> 
> 标签：.net, asp.net-mvc

我将用户数据放在会话中，然后将其传递给 viewdata 以在页面上查看。现在，当我的用户离开他的计算机一段时间后，会话结束并且他输入的数据丢失了。（没关系）问题是当他返回时，他刷新了我的页面仍然显示的屏幕，但所有数据都是走了。所以，

当会话到期时，我如何将用户重定向到登录屏幕（所以他看不到空白页面），或者我想将他重定向到显示“您因不活动而退出”的页面。

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-13T17:41:00.617

我在我的 MasterPage 中使用一些 Javascript 将用户（在提示更新会话之后）重定向到注销操作。当用户单击对话框中的按钮以扩展会话时，它使用返回应用程序主页的 AJAX 请求来刷新服务器端会话窗口。对话框依赖于 jQuery 和 jQuery UI。

```
 <% if (this.Request.IsAuthenticated)
    {
        int sessionDialogWait = 2 * 60 * 1000 - 60 * 500; // ms = 1.5 minutes
        int sessionTimeout = 28 * 60 * 1000; // ms = 28 minutes
        if (ViewData["sessionTimeout"] != null)
        {
            sessionTimeout = ((int)ViewData["sessionTimeout"] * 60 - 120) * 1000;
        }
%>  
<script type="text/javascript">
    var logoutTimer = null;
    var sessionTimer = null;
    var sessionTimeout = Number('<%= sessionTimeout %>');
    var sessionDialogWait = Number('<%= sessionDialogWait %>');

    $(document).ready( function() {
        $('#sessionEndDialog').dialog( {
            autoOpen: false,
            bgiframe: true,
            modal: true,
            buttons: {
                OK: function() {
                    $(this).dialog('close');
                    $.get( '<%= Url.Action( "About", "Home" ) %>', scheduleSessionPrompt, 'html' );
                },
                Logout: logoutOnSessionExpires
            }
        }).ajaxStart( function() { scheduleSessionPrompt(); } );
        scheduleSessionPrompt();
    });

    function scheduleSessionPrompt()
    {
        if (logoutTimer) clearTimeout(logoutTimer);
        if (sessionTimer) clearTimeout(sessionTimer);

        sessionTimer = setTimeout( sessionExpiring, sessionTimeout  );
    }

    function sessionExpiring()
    {
         logoutTimer = setTimeout( logoutOnSessionExpires, sessionDialogWait );
         $('#sessionEndDialog').dialog('open');
    }

    function logoutOnSessionExpires()
    {
        window.location.href = '<%= Url.Action( "Logout", "Account" ) %>';
    }       

    </script>
<% } %>

<div id="sessionEndDialog" title="Session Expiring" style="display: none;">
    <p>Your session is about to expire.  Click OK to renew your session or Logout to logout of the application.</p>
</div> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-13T20:30:58.077

我对旧的 ASP.net 应用程序也有同样的问题。会话到期，但用户仍然通过身份验证，因为会话和身份验证 cookie 不同，不一定同时到期。我当时所做的是使用 global.asax Session_Start 来检查用户是否经过身份验证并将他注销。

```
 protected void Session_Start(Object sender, EventArgs e)
    {
        if (User.Identity.IsAuthenticated)
        {
            FormsAuthentication.SignOut();
            Response.Redirect("~/SessionEnd.aspx");
        }
    } 
```

这会强制启动会话的用户再次登录。您还可以使用此事件从数据库中恢复会话信息，或者将他重定向到另一个页面但保持他的凭据有效。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-13T17:41:37.480

我假设您正在以某种方式对用户进行身份验证，但是您使用的是表单身份验证吗？：

[ASP.Net MVC 框架 - 使用表单身份验证](http://weblogs.asp.net/fredriknormen/archive/2008/02/07/asp-net-mvc-framework-using-forms-authentication.aspx)

如果您已经在使用表单身份验证，则需要确保身份验证 cookie 的过期时间比您的会话超时时间短一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T18:13:03.967

数据可能仍在页面上，因为浏览器正在缓存它。

试着把它扔进去，看看会话结束后数据是否仍然存在：

```
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE"> 
```

# mysql - 将 SQL 转储导入 MySQL 时出错：未知数据库/无法创建数据库

> ID：859313
> 
> 赞同：87
> 
> 时间：2009-05-13T17:33:31.847
> 
> 标签：mysql, sql, mysqldump, mysql-error-1049, mysql-error-1007

我很困惑如何导入 SQL 转储文件。如果不先在 MySQL 中创建数据库，我似乎无法导入数据库。

这是`database_name`尚未创建时显示的错误：

`username`= 有权访问原始服务器上的数据库的用户名。
`database_name`= 来自原始服务器的数据库名称

```
$ mysql -u username -p -h localhost database_name < dumpfile.sql   
Enter password:  
ERROR 1049 (42000): Unknown database 'database_name' 
```

如果我以 root 身份登录 MySQL 并创建数据库，`database_name`

```
mysql -u root  
create database database_name;  
create user username;# same username as the user from the database I got the dump from.  
grant all privileges on database_name.* to username@"localhost" identified by 'password';  
exit mysql 
```

然后尝试再次导入 sql 转储：

```
$ mysql -u username -p database_name < dumpfile.sql  
Enter password:  
ERROR 1007 (HY000) at line 21: Can't create database 'database_name'; database exists 
```

我应该如何导入 SQL 转储文件？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2010-06-13T23:55:46.710

这是 MySQL 的一个**已知错误**。

[错误 42996](http://bugs.mysql.com/bug.php?id=42996)
[错误40477](http://bugs.mysql.com/bug.php?id=40477)

如您所见，这自 2008 年以来一直是一个已知问题，但他们还没有修复它！！！

**解决**
方法 您首先需要创建要导入的数据库。它不需要任何桌子。然后你可以导入你的数据库。

1.  首先启动您的 MySQL 命令行（如果需要，请应用用户名和密码）
    `C:\>mysql -u user -p`

2.  创建数据库并退出

    ```
    mysql> DROP DATABASE database;  
    mysql> CREATE DATABASE database;  
    mysql> Exit 
    ```

3.  从转储文件导入您选择的数据库
    `C:\>mysql -u user -p -h localhost -D database -o < dumpfile.sql`

您可以将 localhost 替换为要导入的任何 MySQL 服务器的 IP 或域。在 mysql 提示符中使用 DROP 命令的原因是确保我们从一个空且干净的数据库开始。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-05-13T17:37:17.517

打开 sql 文件并注释掉试图创建现有数据库的行。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-13T17:43:59.910

听起来您的数据库转储包含用于创建数据库的信息。所以不要给 MySQL 命令行一个数据库名称。它将创建新数据库并切换到它进行导入。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-30T13:31:50.543

如果您在直接 admin 或 cpanel 中创建数据库，则必须使用 notepad 或 notepad++ 编辑 sql 并将`CREATE DATABASE`命令更改为`CREATE DATABASE IF NOT EXISTS`line22

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-12T09:52:30.947

我使用命令行自己创建数据库。然后尝试再次导入，它可以工作。

# io - 接受用户输入

> ID：859314
> 
> 赞同：31
> 
> 时间：2009-05-13T17:33:43.780
> 
> 标签：io, user-input, malbolge

我目前正在 Malbolge 写一个文字冒险类型的游戏。

谁能告诉我如何在 Malbolge 中接受用户输入？我能够将文本输出到屏幕上，但是，我似乎无法弄清楚如何接受输入。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-13T17:42:05.153

```
GHJUYGHJKLKUJHM;&MJ:6AG9F5D8V)A8%]>75Q;6EE85U955%-245!/3DU,2TI)
M2$=&141#0D% /SX]/#LZ.3@W-C4T,S(Q,"\N+2PK*BDH)R8E)",B(7Y]?'MZ
M>7AW=G5T<W)Q<&]N;6QK:FEH9V9E9&-B86!?7EU<6UI96%=655134E%03TY- 
```

未经测试，但应该可以工作。

# eclipse - Eclipse 在哪里存储 SSL 密钥？

> ID：859318
> 
> 赞同：1
> 
> 时间：2009-05-13T17:34:18.223
> 
> 标签：eclipse, jira

我正在尝试使用 tigris.org 的 JIRA 仪表板插件连接到我们的内部 JIRA 服务器，该服务器具有无效的 SSL 证书。我想将证书导入此插件使用的密钥库，无论是 Eclipse 密钥库（在哪里？）还是它自己的。

如果有帮助，这是错误消息：

> sun.security.validator.ValidatorException：PKIX 路径构建失败：sun.security.provider.certpath.SunCertPathBuilderException：无法找到请求目标的有效证书路径

我怎样才能找到密钥库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T21:40:46.403

事实证明，Eclipse 不存储密钥，它使用 JVM 提供的 jssecacerts 密钥库

# python - 在 django 模板中获取模板名称

> ID：859319
> 
> 赞同：7
> 
> 时间：2009-05-13T17:34:35.540
> 
> 标签：python, django

出于调试目的，我想在我的所有模板中都有一个变量来保存正在呈现的模板的路径。例如，如果视图呈现 templates/account/logout.html，我希望 {{ template_name }} 包含字符串 templates/account/logout.html。

我不想去更改任何视图（特别是因为我正在重用很多应用程序），所以要走的路似乎是一个内省的上下文处理器。问题是要自省什么。

或者也许这是内置的，我不知道？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T20:34:22.440

**简单的方法：**

下载并使用[django 调试工具栏](http://github.com/robhudson/django-debug-toolbar/tree/master)。你会得到你所追求的近似值和更多。

**不太简单的方法：**

替换`Template.render`为`django.test.utils.instrumented_test_render`，监听`django.test.signals.template_rendered`信号，并将模板的名称添加到上下文中。请注意，`TEMPLATE_DEBUG`在您的设置文件中必须为真，否则将无法获取名称。

```
if settings.DEBUG and settings.TEMPLATE_DEBUG

    from django.test.utils import instrumented_test_render
    from django.test.signals import template_rendered

    def add_template_name_to_context(self, sender, **kwargs)
        template = kwargs['template']
        if template.origin and template.origin.name
            kwargs['context']['template_name'] = template.origin.name

    Template.render = instrumented_test_render

    template_rendered.connect(add_template_name_to_context) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T19:32:32.010

模板只是字符串而不是文件名。可能您最好的选择是猴子补丁`render_to_response`和/或`direct_to_template`将文件名 arg 复制到上下文中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-31T07:25:25.880

来自[Django 1.5 发行说明](https://django-doc-test1.readthedocs.io/en/stable-1.5.x/releases/1.5.html#new-view-variable-in-class-based-views-context)：

> **基于类的视图上下文中的新视图变量**
> 
> 在所有通用的基于类的视图（或任何继承自 的基于类的视图`ContextMixin`）中，上下文字典包含一个`view`指向`View`实例的变量。

因此，如果您使用基于类的视图，您可以使用

```
{{ view.template_name }} 
```

如果`template_name`在视图上显式设置为属性，则此方法有效。

否则，您可以使用

```
{{ view.get_template_names }} 
```

获取模板列表，例如`['catalog/book_detail.html']`.

# spring - 是否可以在 Spring 绑定之前在 @RequestMapping 方法中手动设置命令对象？

> ID：859324
> 
> 赞同：2
> 
> 时间：2009-05-13T17:35:17.070
> 
> 标签：spring, jsp, spring-mvc, dwr

我有一个 JSP，其中有一个 Spring 表单。在呈现 JSP 之前，将表单的命令对象添加到控制器中。Spring 将 JSP 中的表单绑定到这个命令对象，并在提交 NEW 实例时正确处理它。

但是，我想通过 DWR 保留命令对象（也可以正常工作），然后将表单提交给控制器。在表单提交给控制器的那一刻，命令对象不再是一个新对象，而是一个需要更新的持久化对象。这是我希望表单元素自动绑定到命令对象并通过绑定进行更新的地方，但它们没有被绑定。

简单示例：我将向 中添加一个新`Task`的`ModelMap`，以便 Spring 表单将绑定到该命令对象。但是，我不会提交新的，而是通过 DWR`Task`持久化新`Task`的，这将返回 ID，然后在将表单提交到控制器之前继续编辑任务。

**控制器类**

```
@Controller
public class ProjectController {

    /**
     * This adds the "task" command object to the session attributes and loads
     * the initial form.
     */
    @RequestMapping(value="/project", method=RequestMethod.GET)
    public String setupForm(@RequestParam(value="id", required=true) String id,
                            HttpServletRequest request, ModelMap modelMap) {

        modelMap.addAttribute("project", projectRepo.get(id));
        modelMap.addAttribute("task", new Task());

        return "/project/task";
    }

    /**
     * This processes the form submit, and should update the Task.
     */
    @RequestMapping(value="/project/task/update", method=RequestMethod.POST)
    public String updateTask(@ModelAttribute(value="task") Task task,
                             @RequestParam(value="taskId") String taskId,
                             HttpServletRequest request, ModelMap modelMap) {

        // BEFORE binding the parameters to the command object (task), 
        // I want to assign the command object as the one already persisted.
        task = taskRepo.get(taskId);

        // NOW, I want the request parameters to be bound to the task command object.
        // HOW ?????????

        // Persist the changes.
        taskRepo.merge(task);

        // BACK to the setupForm method/form view
        return "/project?id=" + task.getProject().getId();
    }
} 
```

**弹簧形式**

```
<form:form commandName="task" method="post" action="/project/task/update" id="taskForm">
    <form:hidden path="id" id="task.id"/>
    <form:input path="name" id="task.name"/>
    <!-- DWR will save the task (save and continue), then will return the id. -->
    <!-- After saved, the user can still change the name, 
         then submit the form for processing by the controller -->
</form:form> 
```

可以在任何提交后绑定发生之前将 Spring 绑定命令对象设置为持久对象吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T13:37:01.580

实际上有一个更好的方法可以使用注解来做到这一点。

**创建一个 ModelAttribute 方法，该方法从存储库中返回您想要的命令对象。**

```
@ModelAttribute("task")
public Task task(@RequestParam(value = "id", required = true) String id) {
    return taskRepo.get(taskId);
} 
```

**然后，只需将 ModelAttribute 添加到您的表单提交方法中。**

```
@RequestMapping(value="/project/task/update", method=RequestMethod.POST)
public String updateTask(@ModelAttribute(value="task") Task task,
                         HttpServletRequest request, ModelMap modelMap) {

    taskRepo.merge(task);
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T14:49:32.793

似乎在使用`@ModelAttribute`访问命令对象时，绑定发生在您访问命令对象之前。为了在从表单绑定请求参数之前将该命令对象设置为您想要的，只需传入属性的 id 并从数据库中获取它，然后绑定 WebRequest 参数。

**在 POST 方法中**

```
@RequestMapping(value="/project/task/update", method=RequestMethod.POST)
public String updateTask(@ModelAttribute(value="task") Task task,
                         @RequestParam(value="taskId") String taskId,
                         HttpServletRequest request, ModelMap modelMap) {

    // BEFORE binding the parameters to the command object (task), 
    // I want to assign the command object as the one already persisted.
    task = taskRepo.get(taskId);

    // NOW, I want the request parameters to be bound to the task command object.
    WebRequestDataBinder binder = new WebRequestDataBinder(task);
    ServletWebRequest webRequest = new ServletWebRequest(request);
    binder.bind(webRequest);

    // Persist the changes.
    taskRepo.merge(task);

    // BACK to the setupForm method/form view
    return "/project?id=" + task.getProject().getId();
} 
```

您可以在[Spring 2.5.x 文档中`WebRequestDataBinder`](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/web/bind/support/WebRequestDataBinder.html)找到[Juergen Hoeller](http://blog.springsource.com/author/juergenh/)针对此类应用程序的“手动数据绑定”示例。

```
MyBean myBean = new MyBean();
// apply binder to custom target object
WebRequestDataBinder binder = new WebRequestDataBinder(myBean);
// register custom editors, if desired
binder.registerCustomEditor(...);
// trigger actual binding of request parameters
binder.bind(request);
// optionally evaluate binding errors
Errors errors = binder.getErrors();
... 
```

# wpf - Visual Studio 2008 Xaml 编辑器不工作/消失

> ID：859335
> 
> 赞同：7
> 
> 时间：2009-05-13T17:36:55.443
> 
> 标签：wpf, visual-studio-2008, silverlight, xaml

当我启动 VS 2008 来处理 WPF / Silverlight 应用程序并打开 XAML 或 XML 文件时，XAML / XML 编辑器不再工作。设计师没有出现，智能感知不可用。它基本上看起来像一个文本文件已经打开。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-13T17:40:11.383

尝试运行以下命令。

> "%ProgramFiles%\Microsoft Visual Studio 9.0\Common7\ide\devenv" /resetSkipPkgs

如果这不起作用，请尝试修复 Visual Studio 安装

*   开始 -> 控制面板
*   添加删除程序
*   选择VS
*   选择维修

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T17:40:48.777

XAML 的设计器很糟糕。帮自己一个忙，将 XAML 文件设置为在代码查看器中打开；它们会加载得更快，您不必处理设计师的脆弱性。

但是，要修复智能感知，只需使用 regsvr32 重新注册 TextMgrP.dll，如此处[所示](http://support.microsoft.com/kb/953196)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T17:48:15.707

我以前见过这个问题，运行[这个命令](http://msdn.microsoft.com/en-us/library/ms241276.aspx)应该可以解决它：

```
Devenv.exe /ResetSkipPkgs 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T17:39:46.110

如果您右键单击该文件，选择“打开方式”，然后选择“Windows Presentation Foundation Designer”，这样可以吗？如果是这样，很可能 .xaml 文件的默认编辑器已更改。当您在“打开方式”对话框的列表中选择所需的设计器时，您可以通过按“设置为默认值”将其重置回设计器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T17:41:45.373

看起来有一个以前未加载的 XML 包，请参阅此处的其他问题； [Visual Studio 2008 XML 编辑器消失](https://stackoverflow.com/questions/541548/visual-studio-2008-xml-editor-disappeared)

此外，[Silverlight 论坛上有一个答案，该答案](http://silverlight.net/forums/t/45298.aspx)描述了使用 (VS2008InstallationDirectory)\IDE 中的“devenv /setup”命令。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-15T18:57:23.430

啊啊啊啊啊啊啊啊！！！！！！终于成功了！！！！！！仅仅在拔掉我的头发一周后。我有多个问题。

1.  Xaml 编辑器和添加数据源向导和其他东西不适用于 VS 2008。
2.  尝试安装 SP1。它不会让我这样做，因为 Office Suite 2007 正处于 SP1 更新的中间并且不会完成。
3.  卸载 Microsoft Office 并重新安装和服务打包。
4.  尝试 devenv /setp & devenv /resetskippkgs 无济于事。
5.  最后服务打包VS2008。
6.  重试了 devenv /setp & devenv /resetskippkgs 两次，瞧！有效。

谢谢一堆。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-10T05:36:41.603

当我在现有的 VS2008 Express 版本上安装 VS2008 Professional 时，我遇到了类似的问题。突然我的 XAML 设计器停止了工作。我无法加载 XAML dll 错误。所以我只是卸载了所有 VS Express 的东西，然后安装了 VS 2008 SP1 修复了所有的东西。

尝试下面的 VS 2008 SP1 链接。

[http://www.microsoft.com/downloads/details.aspx?FamilyId=27673C47-B3B5-4C67-BD99-84E525B5CE61&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=27673C47-B3B5-4C67-BD99-84E525B5CE61&displaylang=en)

# video - 视频文件上传

> ID：859342
> 
> 赞同：0
> 
> 时间：2009-05-13T17:38:55.893
> 
> 标签：video, file-upload

允许用户上传视频时使用的文件大小限制是多少。我不担心带宽我只是不希望用户尝试上传文件并收到服务器超时错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T17:42:46.620

当然，这取决于您的软件，但通常只要服务器正在接收数据，它就不会超时。超时通常发生在数据停止进入时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-09T06:01:32.060

但是当上传文件大小超过最大允许文件大小并显示超时错误时，PHP 会停止执行。

# php - PHP 邮件未显示在 Gmail 中，但显示在 Hotmail 和其他第 3 方/ISP 帐户中

> ID：859345
> 
> 赞同：8
> 
> 时间：2009-05-13T17:39:33.473
> 
> 标签：php, email, gmail

我有 2 个站点，其中邮件被发送到两个虚荣 gmail 帐户。我正在使用 PHP 来处理邮件，但邮件没有显示在 gmail 中（不是垃圾邮件/垃圾邮件，只是没有显示）。如果我切换 PHP 以发送到我的个人 hotmail 帐户，邮件就会显示出来。通过我的 ISP 的个人电子邮件帐户也是如此。

邮件过去常常出现在这 2 个虚荣的 gmail 帐户中，知道为什么他们会停下来吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T17:51:41.410

有可能您没有设置正确的标题数据，这些电子邮件甚至在到达垃圾邮件文件夹之前就被阻止了。

尝试添加如下内容：

```
$headers = 'From: your@email.com' . "\r\n" .
'Reply-To: some@email.com'; 
```

这是 mail() 函数的第四个参数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T03:30:33.713

过去我遇到过某些免费电子邮件提供商无法从我的服务器收到任何电子邮件的问题。

我发现除了在实际消息中放置正确的标题之外，还有一些事情可能是罪魁祸首：

*   确保您的服务器配置为[反向 dns 查找](http://www.saas.nsw.edu.au/solutions/dns.html)
*   确保您没有运行开放的[smtp 中继](http://www.abuse.net/relay.html)
*   确保你的服务器没有出现在任何[电子邮件黑名单](http://www.spamhaus.org/xbl/)中（如果你有一个开放的中继，你可能会被列入黑名单。

很有可能，PHP 可以正常发送电子邮件，但 Google 服务器拒绝来自您的服务器的任何消息。

您可以通过快速测试：

```
mail -s Test you@gmail.com < /dev/null 
```

如果你的服务器没问题，你会在你的 gmail 中收到一条消息，如果你没有，PHP 不是问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T17:04:04.023

我发现为您的域设置适当的 SPF 记录确实很有帮助

[http://www.openspf.org/SPF_Record_Syntax](http://www.openspf.org/SPF_Record_Syntax)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T17:16:56.257

似乎更有可能这是服务器配置问题而不是 PHP 问题。

附带说明一下，我发现 gmail 比我们的本地系统更宽容，所以我能够将消息发送到我的 gmail 帐户，但不是我在托管域上的帐户。

我不认为谷歌使用第三方黑名单，但他们确实关心服务器配置（它是否正确识别自己，是否有匹配的 SPF 和 RDNS 记录，正确响应命令）。您可以尝试一些类似[this](http://www.mxtoolbox.com/diagnostic.aspx)或[this](http://www.abuse.net/relay.html)的测试服务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-21T09:44:57.347

我认为为时已晚，但是...以下代码适用于 gmail。

```
<html>
Mail Responder:<br><br>
<?php 
$to = $_REQUEST['MyEmail'] ; 
$subject = $_REQUEST['subject'] ; 
$greeting = $_REQUEST['greeting'] ; 
$realname = $_REQUEST['realname'] ;
$HisEmail = $_REQUEST['HisEmail'] ; 
$message = $_REQUEST['message'] ;
$headers = 'From: '.$HisEmail;  
//$headers = 'From: $HisEmail' . "\r\n" .
//'Reply-To: some@email.com';

$send = mail($to, $subject, $greeting."\n"."\n".$realname."\n"."\n".$HisEmail."\n"."\n".$message, $headers );
if ($send)
$mailReturns = "Mail sent successfully.";
else
$mailReturns = "Mail sent failed.";

?>
<?php echo $mailReturns; ?>
</html> 
```

# ip - 如何编写程序报告本地IP地址如192.168.1.102？

> ID：859356
> 
> 赞同：0
> 
> 时间：2009-05-13T17:41:47.777
> 
> 标签：ip, local, gethostbyname, ifconfig, ipconfig

由于我的 Linksys 路由器没有为计算机（PC、Mac 和 Linux）分配固定的本地 IP，我想编写一个脚本，以便每分钟，计算机将相互更新，以便

[http://localhost/list.html](http://localhost/list.html)

每台机器上将包含所有 PC 和 Mac 的名称列表以及指向其 apache 服务器的链接（指向[http://192.168.1.102](http://192.168.1.102)等）

它看起来像是一种找出本地 IP 地址的方法是在 PC 上通过 ipconfig，在 Mac 和 Linux 上通过 ifconfig，并且以编程方式进行，它将是 gethostbyname()。

但我试过 Ruby，那个

```
irb(main):001:0> require 'socket'
=> true

irb(main):002:0> p Socket::gethostbyname("localhost")
["Core2Duo", [], 2, "\177\000\000\001"]

irb(main):005:0> p Socket::gethostbyname("core2duo")
["Core2Duo", [], 2, "\300\250\001g"]
=> nil 
```

和 ipconfig 实际上显示

```
IPv4 Address. . . . . . . . . . . : 192.168.1.103 
```

那么这是正确的方法吗？我可以通过在 Ruby 中执行“ipconfig”来破解它，并使用正则表达式来获取结果，但使用更标准的方式会很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T17:54:14.963

[**`Socket::getaddrinfo`**](http://www.ruby-doc.org/stdlib/libdoc/socket/rdoc/classes/Socket.html#M004242)可能是您正在寻找的更多内容：

```
Socket::getaddrinfo('localhost', 'http')
[["AF_INET", 80, "localhost", "127.0.0.1", ...]]

Socket::getaddrinfo('core2duo', 'http')
[["AF_INET", 80, "Core2Duo", "192.168.1.103", ...]] 
```

或者，您可以尝试：

```
Socket::getaddrinfo('core2duo', 'http')[0][3]
"192.168.1.103" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T17:50:01.490

您可以使用以下方法在 Java 中执行此操作：

```
Socket s = new Socket();
s.getLocalSocketAddress(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T18:03:25.243

如果您在 Windows 系统上运行 Bonjour 并在 Linux 系统上运行 avahi，则无需确定每个系统的 IP 地址。然后，您可以使用“ `hostname.local`”简单地寻址每个系统。更多信息[在这里](http://en.wikipedia.org/wiki/.local)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T18:17:26.080

为什么不直接为这些机器关闭 DHCP 并为其分配固定 IP 地址？

编辑回应评论：至少三年前（我上次购买路由器），Linksys路由器允许您为内置DHCP服务器设置底部IP地址。然后，您进入各个机器的网络设置，禁用 DHCP，并分配物理地址。例如，在我的家庭网络上，路由器是 192.168.1.1，Terastation 是 1.2，打印机是 1.3，我的 Linux 机器是 1.99，路由器配置为 1.100 及以上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T17:55:43.510

Ruby 脚本中的问题可能是您的网络上没有 DNS 名称解析，如果您通常在具有 SMB/CIFS 的计算机之间共享内容，这通常是隐藏的，因为它有自己的名称发现协议。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T18:36:30.010

如果您要广播带有名称/IP 信息的数据报，那么您实际上并不需要 PC 知道它自己的 IP 地址。只需发送包含其名称的数据报，然后使用**recvfrom()** - 或等效项 - 在其他 PC 上捕获它。这样，接收者可以直接通过**recvfrom()**函数提取发送者的 IP 地址。

作为奖励，这应该适用于发送 PC 具有多个网络适配器的情况。

# agile - 从事敏捷工作的团队通常会拒绝雇用没有从事敏捷工作的人吗？

> ID：859358
> 
> 赞同：20
> 
> 时间：2009-05-13T17:42:10.583
> 
> 标签：agile

作为一个从未专门从事过敏捷工作的开发人员（但曾在 TDD 商店工作过），我看到经营敏捷商店的雇主拒绝雇用没有从事过敏捷工作的人。在过去的几年里，我遇到过几次这种情况。**这真的是哲学变革的根本吗？**在 TDD 工作之后，我几乎可以提出不雇用从未做过 TDD 的人的论点（在繁重的 TDD 环境中工作时）。也许我不了解敏捷以及它与 TDD 之间的区别。

我实际上很想从事敏捷工作，但这似乎是你必须有经验才能获得经验的时代之一。当然，你可以自己做，但如果你问我，那不符合条件。作为雇主，我不会真的称之为适用。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-13T18:23:31.093

敏捷不是严格意义上的工程哲学——TDD、对等编程等是敏捷使用的工程实践——而是敏捷是一种管理方法。因此，更重要的是有人对敏捷所要求的心态持开放态度，而不是他们之前实际上曾在敏捷商店工作过。是的，这确实是一种不同的软件开发理念和方法。在敏捷环境中，那些期望一切都提前并被告知他们需要做什么的人将非常格格不入。

当我采访人们时，我确实会问他们是否有任何敏捷经验或知识，但我真正寻找的是以下一些：

*   灵活的心态
*   允许自我授权的信心（在任何敏捷环境中都至关重要）
*   自我分配任务的能力
*   沟通技巧（前 3 项最重要）
*   好的，指示模糊，能够自学

这些是我认为有资格在敏捷环境中工作的一些品质。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-13T17:57:01.993

了解敏捷的核心原则对于理解敏捷很重要。TDD 只是敏捷的一小部分，更具体地说是 XP（极限编程）。

首先，我将看一下敏捷宣言：

> **个人和交互**超过流程和工具
> 
> **工作软件**优于综合文档
> 
> **合同谈判中的**客户协作****
> 
>  ****响应变化**而不是遵循计划
> 
> 也就是说，虽然右边的项目有价值，但我们更重视左边的项目。**

 **然后我会看一下 SCRUM 流程（它也是敏捷的一小部分），看看其中涉及什么。

当我采访开发人员时，我希望看到他们对敏捷及其含义有所了解，以便我可以确定敏捷环境/心态是否是他们喜欢工作的一种。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-27T09:22:43.083

我已经多次聘请开发人员加入敏捷团队。我一点也不抗拒聘请没有敏捷经验的开发人员——他们会稍微便宜一些 ;-)

然而，我会向这样的候选人提出一些问题，并且某些回答会引发警钟 - 让我知道这个人将需要太多的工作来重新培训。

例如，重视他们的代码和设计——这肯定表明他们将成为 scrums 和代码审查中的“母马”。

敏捷是一种极端的民主——每个人都是平等的，但这并不适合每个人。一些开发人员似乎更喜欢独裁（告诉我该做什么以及如何去做）、君主制（中层管理层）或官僚制（死记硬背的规范和开发）——这些人只是不从事敏捷工作。

一些开发人员对敏捷想法更满意，无论他们是否有过敏捷，这些人都可以被录用。

我不会担心不知道所有流程细节——优秀的开发人员会阅读并了解他们使用的技术，而不是流程方法。由于每家公司无论如何都会定制他们的敏捷模型（如果他们不这样做，他们就做错了），他们从哪个变体开始并不重要。你应该知道一些术语，但这最多需要在面试前一天阅读。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T03:11:10.713

我们使用的敏捷品牌由 SCRUM 定义的项目管理实践和 XP 定义的工程实践组成。如果我们要组建一个新团队，我们将寻找关键角色作为团队的嵌入式教练（迭代经理/ Scrum Master 教练、分析师教练、技术教练和测试教练）。对于现有的团队，考虑到我们使用结对，我们对与他人合作良好的开发人员更感兴趣，而不是超级程序员。

因为我们使用配对，新开发人员将在一个月内通过敏捷工程实践以及业务和应用程序领域变得富有成效。如果一个强大的程序员加入团队但不能有效地结对，它给团队带来的价值很小。

当我们面试时，我们要求候选人与几位团队成员配对。通过结对，我们可以了解开发人员是否与结对的其他人合作良好。此外，我们深入了解开发人员的技术技能。因为候选人是多对工作的，所以我们得到了许多团队成员的观点。

我们所有的敏捷团队都非常有效，他们的项目也很成功。我们培训的团队成员比我们雇用的经验丰富的敏捷人员更多地使用敏捷。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T17:47:06.940

我认为这是过度坚持特定技能的典型案例。就像雇主在将 BEA 用于他们的应用程序服务器时不希望有人知道 JBoss。

一个好的雇主会认识到某人是否适应敏捷方法。现在，如果他们面前有两个平等的候选人，那可能会有点不同。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T17:53:46.117

这无疑是一种方便的方法，无需解释可能在决策中发挥更重要作用的其他原因。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T18:23:46.990

我理解您的沮丧，但事实是，如果您从未在敏捷环境中工作过，那么您很可能会以反敏捷的方式行事（可以这么说），您甚至可能不明白自己做错了什么。

由于敏捷与工作哲学息息相关，它不仅仅是通过阅读一本书就能学到的东西，因此您需要深入了解非敏捷公司的运作方式、这会导致什么问题、敏捷如何改变这种情况以及如何应对熵（外部世界试图引入非敏捷性）。

我的建议是你首先阅读更多关于敏捷的内容，然后开始从敏捷/非敏捷的角度分析你自己的行为和你目前工作的任何公司的行为。一旦你能够辨别这些模式，你就可以开始尝试从内部改变你的公司。当你失败时，去敏捷公司，他们会雇用你，我保证。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-15T13:44:53.947

任何通过实践而不是最适合当前项目/情况来决定 SDLC 的公司或机会已经显示出其局限性的迹象，并且您可能会更好地继续求职。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-01-27T14:27:54.957

绝对**是的**

在敏捷，特别是在极限编程方面，有很多团队合作和信任你的同行。你需要知道其他人正在编写体面的测试，而不是破坏你的代码。优秀的 XP 开发人员不希望团队中的人会使他们的工作变得更加困难。

作为初学者或团队的新人并没有错 - 但是**有一个建立信任的元素，就像你在开源中获得提交者权利一样**。

这些天来，每个人都说他们很敏捷，如果你提供足够的钱，几乎每个有一点技术技能的人都会申请这份工作......所以**期待人们让你通过结对编程面试**。

通常我们需要知道：

*   你真的可以结对程序吗？
*   你真的知道怎么做TDD吗？
*   你只是在说这些事情，还是你能证明你做了这些事情？
*   你是要主动还是在等待一个老派的“项目经理”型来告诉你该怎么做？

可以帮助您在敏捷商店中受雇的东西：

*   即使您没有得到支持，您也**尝试在某个地方引入测试驱动开发。**（它对我有用......）
*   你有你编写的示例代码——或者一个开源项目，**你可以在上面展示测试驱动的开发**、自动构建......
*   您会发现**自己曾在发布周期较短的团队中工作**……

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-14T18:25:49.723

在你目前的工作中，你能否实施某种形式的敏捷开发来表明你有兴趣，已经研究过它并且实际上有一些经验？您也许可以找到一些非开发人员与您合作。在一些编码过程中，高级用户可以和你坐在一起。我确信没有人会妨碍使用一些敏捷文档（冲刺日志、刻录图）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-14T23:21:47.673

我可能会提出这个问题：在你的职业生涯中，到目前为止，你一直在使用哪些开发方法？它们中的任何一个都包含敏捷理想的精神吗？

如果你是一个喜欢通过 Waterfall 进行开发的人，并且认为它绝对适合你的开发世界，那么采用敏捷就像从驾驶汽车到驾驶飞机或船只一样。这是根本的区别，因为您不一定知道自己要去哪里，并且处理变化的方式与瀑布式风格截然不同，瀑布式风格中每个阶段都按顺序进行，并且没有任何重新确定优先级而不危及整个过程。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-16T16:45:58.293

当一家公司在招聘中使用“敏捷”这一概括性术语但没有更具体（例如，通过要求 XP 或 Scrum 经验）时，它通常是他们正在寻找的其他东西的占位符。他们可能想要“将结对编程的开发人员”或“在开始之前不会因为没有需求和设计文档而深究的开发人员”或“不会连续数周陷入黑暗角落的开发人员” ”。诀窍是弄清楚它们的含义。

从狭隘的硅谷招聘角度来看，熟悉敏捷实践（例如，知道 XP 是什么）的候选人已经完成了其中的一些实践（例如，结对编程和 TDD），并且希望在敏捷环境中工作的候选人通过了那个障碍。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-24T00:03:56.170

雇主最有可能坚持雇用了解敏捷的人，而不是不了解敏捷的人，因为敏捷方法要求几乎每个团队成员都了解每种敏捷方法（SCRUM、Crystal、XP）所需的流程。例如，SCRUM 要求所有团队成员，包括管理层，都理解并遵循自组织的概念。他们需要明白，他们不会受制于他们当前的表现：他们需要公开解决他们的问题（或日常 SCRUM 中通常发生的事情）。如果你让一个不了解敏捷的人加入团队，他们可能会立即认为，由于这种方法的文档很少，他们可以运行并编写代码并修复来构建项目。然而，敏捷方法是过程繁重的，而不是文档繁重的。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-05-13T18:23:10.377

也许他们采取了 Mos Eisley 小酒馆酒保的心态（意译）：

> 我们不想要你的那种。

# perl - Perl+Postgresql：如果存在 RAISE NOTICE，则函数不返回值

> ID：859359
> 
> 赞同：3
> 
> 时间：2009-05-13T17:42:18.430
> 
> 标签：perl, postgresql, dbi

我注意到，当我使用 DBI 从 Perl 脚本调用 PL/PgSQL 或 PL/Perl 函数时，如果函数中使用了 RAISE NOTICE 或 elog(NOTICE)，它不会返回值。为了显示：

一个简单的表：

```
CREATE TABLE "public"."table1" (
  "fld" INTEGER
) WITHOUT OIDS; 
```

一个简单的功能：

```
CREATE OR REPLACE FUNCTION "public"."function1" () RETURNS integer AS
$body$
DECLARE
  myvar INTEGER;
BEGIN
  SELECT INTO myvar fld FROM table1 LIMIT 1;
  RETURN myvar;
END;
$body$
LANGUAGE 'plpgsql' 
```

一段 Perl 脚本：

```
use DBI;
...
my $ref = $dbh->selectcol_arrayref('SELECT function1()');
print $$ref[0]; 
```

实际上，它会打印表中的值。

但是如果我添加 RAISE NOTICE 如下所示，我不会得到任何结果：

```
SELECT INTO myvar fld FROM table1 LIMIT 1;
RAISE NOTICE 'Testing';
RETURN myvar; 
```

我是否遗漏了某些东西或这种行为是设计使然？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T04:04:43.850

检查[`client_min_messages`](http://www.postgresql.org/docs/8.3/static/runtime-config-logging.html#GUC-CLIENT-MIN-MESSAGES)数据库服务器`postgresql.conf`文件中的设置。来自 PostgreSQL 8.3 文档：

> `client_min_messages`（细绳）
> 
> > 控制将哪些消息级别发送到客户端。有效值为`DEBUG5`, `DEBUG4`, `DEBUG3`, `DEBUG2`, `DEBUG1`, `LOG`, `NOTICE`, `WARNING`, `ERROR`, `FATAL`, 和 PANIC。每个级别包括其后的所有级别。级别越高，发送的消息就越少。默认值为`NOTICE`. 请注意，`LOG`此处的排名与 中的不同`log_min_messages`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T23:18:20.237

我无法重现这一点，使用 Debian 的 Perl 5.10、DBI 1.605 和 DBD::Pg 2.8.7 对 PostgreSQL 8.3.7。我按预期打印了通知。

```
steve@steve@[local] =# create or replace function public.function1() returns integer language 'plpgsql' as $$ declare myvar integer; begin select into myvar fld from table1 limit 1; raise notice 'Testing'; return myvar; end; $$;
CREATE FUNCTION
steve@steve@[local] =#
[1]+  Stopped                 psql --cluster 8.3/steve
steve@arise:~$ DBI_TRACE=1 perl -MData::Dumper -MDBI -e '$dbh = DBI->connect(qw|dbi:Pg:dbname=steve;port=5433;host=/tmp steve steve|, {RaiseError=>1,PrintError=>0}); print Data::Dumper->new([$dbh->selectcol_arrayref("SELECT function1()")], [qw|result|])->Dump'
    DBI 1.605-ithread default trace level set to 0x0/1 (pid 5739) at DBI.pm line 273 via -e line 0
    Note: perl is running without the recommended perl -w option
    -> DBI->connect(dbi:Pg:dbname=steve;port=5433;host=/tmp, steve, ****, HASH(0x1c9ddf0))
    -> DBI->install_driver(Pg) for linux perl=5.010000 pid=5739 ruid=1000 euid=1000
       install_driver: DBD::Pg version 2.8.7 loaded from /usr/lib/perl5/DBD/Pg.pm
    <- install_driver= DBI::dr=HASH(0x1e06a68)
    !! warn: 0 CLEARED by call to connect method
    <- connect('dbname=steve;port=5433;host=/tmp', 'steve', ...)= DBI::db=HASH(0x1fd8e08) at DBI.pm line 638
    <- STORE('RaiseError', 1)= 1 at DBI.pm line 690
    <- STORE('PrintError', 0)= 1 at DBI.pm line 690
    <- STORE('AutoCommit', 1)= 1 at DBI.pm line 690
    <- STORE('Username', 'steve')= 1 at DBI.pm line 693
    <> FETCH('Username')= 'steve' ('Username' from cache) at DBI.pm line 693
    <- connected('dbi:Pg:dbname=steve;port=5433;host=/tmp', 'steve', ...)= undef at DBI.pm line 699
    <- connect= DBI::db=HASH(0x1fd8e08)
    <- STORE('dbi_connect_closure', CODE(0x1da2280))= 1 at DBI.pm line 708
NOTICE:  Testing
    <- selectcol_arrayref('SELECT function1()')= ( [ '2' ] ) [1 items] at -e line 1
$result = [
            '2'
          ]; 
```

我建议将您的问题隔离到一个小脚本（如上）并以`DBI_TRACE`相当高的设置运行它，看看您看到了什么差异。也许还可以查看 DBD::Pg 的发行说明，看看他们是否提到过它可能在过去被这些混淆了。`DBI_TRACE=10`我看到了这个：

```
PQexec
Begin pg_warn (message: NOTICE:  Testing
 DBIc_WARN: 1 PrintWarn: 1)
NOTICE:  Testing
End pg_warn
Begin _sqlstate 
```

所以你应该在你自己的输出中寻找类似的东西。

# naming - 需要的建议：我应该给代表现实生活中的“事件”的类命名什么？

> ID：859363
> 
> 赞同：7
> 
> 时间：2009-05-13T17:43:32.233
> 
> 标签：naming

我需要定义一个代表真实事件的类——比如“电影首映式”、“派对”等。我将创建一组数据库对象来存储每个事件的数据并定义与其他数据的关系我们有（例如场地、人员等）。

“事件”一词在软件上下文中具有不同的含义，因此我想将类命名为“事件”以外的名称。

关于另一个名字的任何想法？

This [related post](http://www.stackoverflow.com/questions/752040/)提出了一个类似的问题，但我认为所有建议都缺乏创造力——基本上`@event`，区分大小写的名称`Event`或使用老式命名约定`CEvent`。技术上很好的解决方案，但是在与同行讨论数据对象时它们没有帮助（我的演讲和听力能力不区分大小写）并且没有传达任何关于类如何不是传统使用术语的事件的信息.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T17:45:34.370

一种选择是`CalendarEvent`，以明确表明这是与给定日期相关的真实事件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T17:52:15.717

**发生**或**场合**怎么样？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T17:50:26.590

活动浮现在脑海。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-13T18:02:40.673

你可以称之为“约会”。你也可以只造一个词。如果这是您域中的一个关键概念，您可以缩写其他建议的名称之一。像：

*   `CalenderEvent`变成`Calvent`
*   `SocialEvent`变成`Socent`
*   `RealWorldEvent`变成`Revent`
*   `HumanActivity`变成`HAct`

那些简单的例子可能是糟糕的例子，但它们很短，不会与语言或库名称冲突，如果你经常使用它们，它们很快就会成为你和你的同事真正有意义的词。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-13T17:46:15.600

通常我会推荐函数，但它在软件的上下文中也有特定的含义。;)

场合可能是一个很好的同义词。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-13T17:47:42.417

同义词库将以下内容列为单词*event*的同义词：

> 事故, 行动, 行动, 来临, 冒险, 事务, 出现, 商业, 灾难, 案件, 灾难, 庆典, 仪式, 机会, 情况, 巧合, 危机, 契约, 发展, 紧急情况, 情节, 经验, 剥削, 事实,功能, 假日, 事件, 关口, 奇迹, 事情, 里程碑, 奇迹, 不幸, 不幸, 错误, 场合, 发生, 通过, 阶段, 现象, 困境, 进行, 转变, 情况, 故事, 事情*, 潮汐, 交易, 胜利, 转身, 想知道

当然，其中一个就足够了……如果没有，您可以预先或包装单词 event 以使其成为非关键字。虽然像@event 或 [event] 这样的东西，我不得不说我个人并不喜欢这种做法，即使它在语法上是允许的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-13T17:46:20.203

也许是“Affair”或“Advent”——你也可以查看词库：

[http://thesaurus.reference.com/browse/event](http://thesaurus.reference.com/browse/event)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-13T17:49:15.127

Entry 或 EventEntry 可能是我会选择的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-13T17:49:18.123

我可以理解您希望避免与编程意义上的事件混淆，但我的看法是，也许您应该使用最明显的名称；程序到您的域，并且事情保持可读性并且更易于设计和维护。

# jquery - 使用 bind( type, [data], fn ) 和非内联函数

> ID：859364
> 
> 赞同：1
> 
> 时间：2009-05-13T17:43:48.693
> 
> 标签：jquery

```
$("p").bind("click", function(event){
       // code goes here
}); 
```

这是完全可以理解的。但是使用非内联函数并将事件作为参数传递的方法是什么？那是：

```
$("p").bind("click", myFunction(event));

 function myFunction(event) {
       // code goes here
 } 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T17:46:54.787

开始：

```
$("p").bind("click", myFunction);

function myFunction(event) {
    // code goes here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T17:51:13.737

你的问题是你给它一个参数，导致函数被执行，返回值被替换为绑定的参数。您要做的只是提供对该函数的引用作为绑定的参数。通过省略括号（和论点）来做到这一点。bind 提供给回调的参数只需要包含在函数定义中。

```
$("p").bind("click", myFunction);

function myFunction(event) {
    // code goes here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-28T00:00:21.343

所以当你做类似的事情时

```
$('p').bind('click', myFunction(event);

function myFunction(event){
//code
} 
```

就像您正在创建自己的“事件对象”而不是在用户操作发生时使用由 jQuery 创建的对象？

# c# - C#：更改 DataGridView 中的插入符号位置

> ID：859369
> 
> 赞同：1
> 
> 时间：2009-05-13T17:45:03.947
> 
> 标签：c#, datagridview, caret

在 TextBox 中，我可以使用`textBox1.SelectionStart = 4`. 如何在 DataGridView 中执行此操作？

编辑澄清：假设一个特定的单元格已被选中并处于编辑模式。如果我按下右箭头键，插入符号会在该单元格中的任何文本上向右移动一个位置。我希望创建一个做同样事情的按钮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T17:48:31.510

您可能应该澄清一下。您是要更改 DataGridView 中的选定行，还是 DataGridView 中是否有要移动插入符号的文本框？

如果您要修改选定的行，请尝试 SelectedIndex 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-10T11:30:31.380

```
private void RadGridView1_SelectionChanged(object sender, Telerik.Windows.Controls.SelectionChangeEventArgs e)
{
    RadGridView1.CurrentItem = RadGridView1.SelectedItem;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T17:52:47.680

您需要通过 DataGridView 的 EditingControlShowing 事件获取 TextBox。

将此存储为一个成员变量，并在需要时访问 textBox 成员并设置 SelectionStart，如您上面所写。

就像是;

```
dataGrid.EditingControlShowing += this.dataGrid_EditingControlShowing; 
```

和

```
void dataGrid_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
        {
            if(this.dataGrid.CurrentCell != null && e.Control is TextBox)
            {
                this.currentTextBox = (TextBox)e.Control;
            }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T01:51:03.953

每当用户单击您的按钮时，DataGridView 中的单元格将失去焦点，因此它将删除编辑框、验证值并将格式化的值放入单元格中。

我想知道您让按钮移动插入符号的原因是什么？

# vim - 如何在vimdiff创建的拆分下方打开一个新窗口？

> ID：859383
> 
> 赞同：26
> 
> 时间：2009-05-13T17:47:23.693
> 
> 标签：vim, split, text-editor, vimdiff

如果在命令提示符下，我运行

```
vimdiff file1 file2 
```

我得到一个 vim 实例，它有两个并排打开的文件，如下所示：

```
╔═══════╤═══════╗
║       │       ║
║       │       ║
║ file1 │ file2 ║
║       │       ║
║       │       ║
╚═══════╧═══════╝ 
```

这很好，但有时我想打开第三个文件来查看。我不想创建另一个垂直拆分，因为否则这些行会很短，我会一直水平滚动来阅读它们。但是在屏幕底部占据几行不会有什么坏处。那么，我怎样才能从上面转到以下内容：

```
╔═══════╤═══════╗
║       │       ║
║ file1 │ file2 ║
║       │       ║
╟───────┴───────╢
║     file3     ║
╚═══════════════╝ 
```

我尝试过使用`:sp file3`，但我最终得到了这个（假设我在光标位于 file1 时运行了命令）：

```
╔═══════╤═══════╗
║ file3 │       ║
║       │       ║
╟───────┤ file2 ║
║ file1 │       ║
║       │       ║
╚═══════╧═══════╝ 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-13T18:02:23.717

采用

```
:botright split 
```

并在里面打开一个新文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T18:31:18.523

要扩展@fgm 的答案，如果您键入此命令，您可以像正常一样自动完成要编辑的文件名`:edit`：

```
:bot split +edit thirdfile.cpp 
```

但为了避免输入所有内容，您可以创建一个*“用户定义的命令”* ，如下所示：

```
:command -complete=file -nargs=* Third bot split +edit <args> 
```

现在您只需键入`:Third`以在屏幕底部创建第三个窗口，其中包含您要编辑的文件，例如：

```
:Third mythirdfile.cpp 
```

请注意，您可以像使用普通`:edit`.

当然，如果您不喜欢`:Third`，可以将命令的名称更改为其他名称，请记住它必须以大写字母开头。

欲了解更多信息类型`:help user-commands`和`:help 40.2`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T18:14:05.883

如果您已经`:sp file3`像上一个示例中那样打开了，`^WJ`则会将现有窗口移动到您想要的位置。

# php - 提取 Zip 内的目录

> ID：859396
> 
> 赞同：3
> 
> 时间：2009-05-13T17:49:42.397
> 
> 标签：php, directory, zip, extract, archive

我正在编写一个脚本，将 zip 存档中的文件提取到脚本所在的目录中。

这是我的代码：

```
$zip = new ZipArchive;
if ($zip->open('latest.zip') === TRUE) {
    $zip->extractTo('.');
    $zip->close();
    unlink('installer.php');
    echo 'it works!';
} else {
    echo 'failed';
} 
```

这工作正常，但有一个问题。拉链包含一个额外的层。(zip/directory/files) 像这个目录/文件一样提取，而不仅仅是文件。

有没有办法去除这个额外的层？

谢谢你的帮助！

乔尔·德雷珀

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T18:29:23.703

为了防止任何文件被覆盖，您可能需要先将 zip 文件解压缩到一个目录中。我会创建一个具有随机名称的目录，将 zip 解压缩到该目录中，然后检查是否有任何子目录：

```
<?php

// Generate random unzip directory to prevent overwriting
// This will generate something like "./unzip<RANDOM SEQUENCE>"
$pathname = './unzip'.time().'/';

if (mkdir($pathname) === TRUE) {

  $zip = new ZipArchive;

  if ($zip->open('latest.zip') === TRUE) {

    $zip->extractTo($pathname);

    // Get subdirectories
    $directories = glob($pathname.'*', GLOB_ONLYDIR);

    if ($directories !== FALSE) {

      foreach($directories as $directory) {

        $dir_handle = opendir($directory);

        while(($filename = readdir($dir_handle)) !== FALSE) {

          // Move all subdirectory contents to "./unzip<RANDOM SEQUENCE>/"
          if (rename($filename, $pathname.basename($filename)) === FALSE) {
            print "Error moving file ($filename) \n";
          }
        }
      }
    }

    // Do whatever you like here, for example:
    unlink($pathname.'installer.php');

  }

  // Clean up your mess by deleting "./unzip<RANDOM SEQUENCE>/"
} 
```

我尚未测试此代码，因此，使用风险自负，而且它可能无法在 Windows 系统上按预期工作。此外，请查看我使用的所有功能的文档：

*   [时间（）](http://php.net/time)
*   [全局（）](http://php.net/glob)
*   [打开目录（）](http://php.net/opendir)
*   [读取目录（）](http://php.net/readdir)
*   [改名（）](http://php.net/rename)

# sql - 如何使 T-SQL 游标更快？

> ID：859407
> 
> 赞同：8
> 
> 时间：2009-05-13T17:52:08.867
> 
> 标签：sql, sql-server, database-cursor

我在 SQL Server 2000 下的存储过程中有一个游标（现在无法更新），它更新了所有表，但通常需要几分钟才能完成。我需要让它更快。

而 GDEPO:Entry depot,CDEPO:Exit depot,Adet:quantity,E_CIKAN 使用的数量。

记录解释：

1.  20 单元进入 01 仓库，
2.  10 单位离开 01。
3.  5 单位离开 01 (E_CIKAN 的第 1 条记录现在是 15)
4.  还有 10 个单位进入 01 号仓库。
5.  3 个单位从第 1 条记录中留下 01。注意现在第一条记录的 E_CIKAN 设置为 18。
6.  这就是问题所在：3 个单元需要离开 01 号仓库。它需要从第 1 个记录中取出 2 个单元，从第 5 个记录中取出 1 个单元。如图所示，我的 SP 可以很好地处理这个问题，但它真的很慢。

这是翻译成英文的存储过程；

```
CREATE PROC [dbo].[UpdateProductDetails]
as
UPDATE PRODUCTDETAILS SET E_CIKAN=0;
DECLARE @ID int
DECLARE @SK varchar(50),@DP varchar(50)  --SK = STOKKODU = PRODUCTID, DP = DEPOT
DECLARE @DEMAND float     --Demand=Quantity, We'll decrease it record by record
DECLARE @SUBID int
DECLARE @SUBQTY float,@SUBCK float,@REMAINS float
DECLARE SH CURSOR FAST_FORWARD FOR
SELECT [ID],PRODUCTID,QTY,EXITDEPOT FROM PRODUCTDETAILS  WHERE (EXITDEPOT IS NOT NULL) ORDER BY [DATE] ASC
OPEN SH
FETCH NEXT FROM SH INTO @ID, @SK,@DEMAND,@DP

WHILE (@@FETCH_STATUS = 0)
BEGIN
   DECLARE SA CURSOR FAST_FORWARD FOR
   SELECT [ID],QTY,E_CIKAN FROM PRODUCTDETAILS  WHERE (QTY>E_CIKAN) AND (PRODUCTID=@SK) AND (ENTRYDEPOT=@DP) ORDER BY [DATE] ASC
   OPEN SA
   FETCH NEXT FROM SA INTO @SUBID, @SUBQTY,@SUBCK
   WHILE (@@FETCH_STATUS = 0) AND (@DEMAND>0)
   BEGIN
      SET @REMAINS=@SUBQTY-@SUBCK
      IF @DEMAND>@REMAINS  --current record isnt sufficient, use it and move on
      BEGIN
         UPDATE PRODUCTDETAILS SET E_CIKAN=QTY WHERE ID=@SUBID;
         SET @DEMAND=@DEMAND-@REMAINS
      END
      ELSE
      BEGIN
         UPDATE PRODUCTDETAILS SET E_CIKAN=E_CIKAN+@DEMAND WHERE ID=@SUBID;
         SET @DEMAND=0
      END
      FETCH NEXT FROM SA INTO @SUBID, @SUBAD,@SUBCK
   END
   CLOSE SA
   DEALLOCATE SA
   FETCH NEXT FROM SH INTO @ID, @SK,@DEMAND,@DP
END
CLOSE SH
DEALLOCATE SH 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-13T20:35:43.500

根据我们在我对这个问题的其他回答中的对话，我想我已经找到了一种方法来加快你的日常生活。

您有两个嵌套游标：

*   第一个是选择指定了 exitdepot 的每一行。它需要产品、depo 和数量，然后：
*   内部游标循环遍历指定了 entrydepot 的该产品/仓库的行。它为每个产品添加到 E_CIKAN，直到它分配了所有产品。

因此，对于您拥有的每个 exitdepot 行，内部游标循环至少运行一次。但是，您的系统并不真正关心哪些物品与哪个交易一起出现 - 您只是试图计算最终的 E_CIKAN 值。

所以 ...

您的外循环只需要获取每个产品/仓库组合的**总出货量。**因此，您可以将外部光标定义更改为：

```
DECLARE SH CURSOR FAST_FORWARD FOR
    SELECT PRODUCTID,EXITDEPOT, Sum(Qty) as TOTALQTY
    FROM PRODUCTDETAILS  
    WHERE (EXITDEPOT IS NOT NULL) 
    GROUP BY PRODUCTID, EXITDEPOT
OPEN SH
FETCH NEXT FROM SH INTO @SK,@DP,@DEMAND 
```

（然后在代码末尾将匹配的 FETCH 从 SH 更改为匹配，显然）

这意味着您的外部光标将有更少的行来循环，而您的内部光标将具有大致相同数量的行来循环。

所以这应该更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T18:08:11.960

在使用 T-SQL 时，游标必须是解决任何问题的最差解决方案。

根据您真正想要完成的任务的复杂性，您有两种选择：

1.  尝试重写整个代码集以使用集合操作。这将是最快的执行方法......但有时您无法使用集合操作来做到这一点。

2.  将光标替换为表变量（带有标识列）、计数器和 while 循环的组合。然后，您可以遍历表变量的每一行。比光标执行得更好......即使它看起来不像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T18:03:54.900

删除游标并将其重写为 UPDATE FROM 加入游标的查询，如果需要，您可以使 IF 成为案例。今天太忙了，没时间给你写更新……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T18:04:50.127

移除光标并进行批量更新。我还没有找到不能批量完成的更新。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T18:17:59.790

首先，如果您必须使用游标，并且要更新内容，则使用 FOR UPDATE 子句声明游标。（请参见下面的示例。请注意，该示例根本不是基于您的代码。）

话虽如此，有无数种方法可以使用游标以外的东西，通常是利用临时表。我会调查那条路线来代替游标。

```
DECLARE LoopingCursor CURSOR LOCAL DYNAMIC
FOR
    select sortorder from customfielddefinition
    where context=@targetContext
FOR UPDATE OF sortorder 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T19:47:43.950

我可以看到您要解决的问题非常复杂：

*   当存在指定 GDEPO 的行时，它表示库存进入仓库，您希望使用该*行*的 E_CIKAN来跟踪以后使用了多少库存。E_CIKAN 将从 0 开始，然后在库存耗尽时添加，直到达到 ADET。

*   因此，当有指定 CDEPO 的后续行时，它表示缺货，您想返回 GDEPO 行的 E_CIKAN 并通过添加缺货量来调整 E_CIKAN。

*   当有两个单独的行进入库存时（指定 GDEPO），有时当一行的 E_CIKAN 达到最大值（ADET）时会出现溢出，然后您想将剩余部分添加到下一行。

这是一个相当棘手的计算，因为您必须比较不同的行并返回并更改可能一或两行中的值以跟踪每个股票交易。

*正如其他人所建议的那样，可能*有一种方法可以在没有光标的情况下做到这一点。但是我认为，如果您可以重新排列表格并以不同的方式存储数据，则可能会使问题变得更容易。

例如，不是在记录库存交易的同一个表中跟踪库存，您是否可以有一个单独的表，其中包含“Product_id，Depo_id，amount”列，一次跟踪每个仓库中每种产品的总量?

诸如此类的数据库设计更改可以使事情变得更容易。

或者...而不是使用 E_CIKAN 来跟踪使用的内容*，*而是使用它来跟踪*剩余的内容*。并在每一行中保留一个 E_CIKAN 值。*因此，每当库存进出仓库时，请在该时间点*重新计算 E_CIKAN并将其存储在该事务行中（而不是尝试返回到原始的“入库”行并在那里更新它）。然后要找出当前库存，您只需查看该产品/仓库的最新交易。

总而言之，我的意思是，您的计算缓慢而繁琐，因为您以一种奇怪的方式存储数据。从长远来看，可能值得更改您的数据库设计以使编程更容易。

# java - EJB 仍然有用吗？Spring Framework 有哪些替代 EJB 的方法？

> ID：859413
> 
> 赞同：7
> 
> 时间：2009-05-13T17:52:47.757
> 
> 标签：java, spring, jakarta-ee, ejb

我已经读过一段时间了，EJB 既没用也不麻烦。但是还有哪些其他方法可以实现业务委托模式呢？

EJB 与 Spring 推荐的方法有何不同？

此外，EJB 的最新进展如何改变了您的看法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T21:53:21.127

如果您的目标是发动一场激烈的战争，请将“EJB”替换为“Java”，将“Spring Framework”替换为“Ruby on Rails”。

如果没有，请查看[Rod Johnson 2004 年的书](http://books.google.com/books?id=Dlz3p_IwseUC&printsec=toc&dq=spring+replace+ejb&source=gbs_summary_s&cad=0)，详细解释为什么 EJB 声名狼藉，以及 Spring 旨在解决哪些 Java 开发问题。

虽然这本书已有 5 年的历史并且早于 EJB3，但您需要过滤掉主观和轶事；牢记小事。从 EJB 迁移到 Spring 的示例很容易在 Google 上搜索，几乎不可能找到 Spring 到 EJB3 迁移的故事。我不认为这是偶然的。

# java - JMX 定义

> ID：859414
> 
> 赞同：30
> 
> 时间：2009-05-13T17:52:56.120
> 
> 标签：java, jakarta-ee, jmx

我在寻找：

*   JMX 是什么。
*   我可以在哪里找到一些好的 JMX 教程。
*   作为一名 Java EE 程序员，JMX 可以为我提供什么。
*   还有什么我应该知道的。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-13T19:46:28.697

JMX 是一种查看和操作应用程序运行时状态的方法。如果有帮助的话，它在概念上与 SNMP 有点相似。IMO，它对于监视和理解除了写入日志文件之外可能没有任何其他用户界面的服务器类型应用程序是必不可少的。

基本方法是为您要监控的事物创建一个接口，然后让一个类实现该接口，然后使用“MBeanServer”注册该类的一个实例（这实际上使接口中定义的东西可用于 JMX 监控jconsole 等应用程序）。

这是一个微不足道但有效的示例：

（我假设 Java 5 或更好）

## 测试服务器MBean.java

```
public interface TestServerMBean
{
    public long getUptimeMillis();
    public long getFooCount();
    public void setFooCount(long val);
    public void printStuff(String stuff);
} 
```

## 测试服务器.java：

```
import java.lang.management.ManagementFactory;
import java.util.concurrent.atomic.AtomicLong;

import javax.management.ObjectName;

// If jconsole doesn't see this app automatically, invoke the application with the following java flags, and connect
// 'remotely' via jconsole.
//
// -Dcom.sun.management.jmxremote
// -Dcom.sun.management.jmxremote.port=2222 (or whatever)
// -Dcom.sun.management.jmxremote.authenticate=false
// -Dcom.sun.management.jmxremote.ssl=false
public class TestServer implements TestServerMBean
{
    private final AtomicLong m_counter = new AtomicLong(0L);
    private final long m_startTimeMillis = System.currentTimeMillis();

    public void run() throws InterruptedException {
        while (true) {
            m_counter.incrementAndGet();
            Thread.sleep(5000);
        }
    }

    public long getFooCount() {
        return m_counter.get();
    }

    public void setFooCount(long val) {
        m_counter.set(val);
    }

    public long getUptimeMillis() {
        return System.currentTimeMillis() - m_startTimeMillis;
    }

    public void printStuff(String stuff) {
        System.out.println(stuff);
    }

    public static void main(String[] args) throws Exception {
        TestServer ts = new TestServer();
        ManagementFactory.getPlatformMBeanServer().registerMBean(ts, new ObjectName("myapp:service=MyServer"));
        ts.run();
    }
} 
```

像往常一样编译并运行 TestServer.class，启动`jconsole`，连接到 TestServer（它会自动显示，否则请参阅上面代码中的注释），然后查看“MBeans”选项卡，您将看到我们的实例名为`myapp:service=MyServer`. 您可以查看当前的“正常运行时间”，并查看`FooCounter`每 5 秒的增量。您还可以将 FooCounter 设置为您想要的任何（长）值，并`printStuff`使用任何 String 参数调用该方法。

显然这是一个荒谬的“服务器”，但希望有一个简单的工作示例将有助于说明整体概念：能够窥视和操作正在运行的应用程序。

有很多额外的特性和不同类型的 MBean，但只是上面显示的 vanilla JMX 有很长的路要走，IMO。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-13T18:54:47.377

简而言之，JMX 允许您从正在运行的 JVM 内部远程调用方法或查看公开的数据。许多应用程序使用 JMX 将远程仪表板附加到它们正在运行的 JVM 上，以提供远程管理。

例如，如果您在机器上运行了一个应用服务器，那么使用 JMX 就可以远程查看有关该服务器的公开信息。也可以编写您自己的 JMX MBean，它可以在您的应用程序中公开任何变量或方法。然后可以远程“轮询”暴露的变量以测试您想了解的某些条件。

JMX 的另一个有用之处是您可以即时远程更改变量。例如，如果您设置了某种具有最大总量的池，则可以远程更改此最大数量，而无需重新启动或更改应用程序服务器上的任何配置文件。

`jconsole`由 Sun 与 Java 一起提供，以便能够轻松地远程查看您的 MBean，而无需编写您自己的客户端解决方案。您还可以使用可以为您提供出色灵活性的自定义解决方案来使用 MBean。

此外，已经有一些内置 JMX MBean 监控的监控软件。Zenoss 和 Applications Manager 8 做到了这一点，仅举几例。

**添加：**

已经有很多软件利用了 JMX。Tomcat 公开可通过 jconsole 访问的信息，JBoss Application Server 也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T17:29:57.613

也许 JSR 262 在这里也值得一提。

“JSR 262 为 JMX Remote API 定义了一个连接器，它使用 Web 服务使 JMX 工具远程可用。客户端不必是 Java 应用程序，但可以是。”

JSR 262 很可能会成为下一个 Java 版本（Java 7）的一部分。

[JMX WS 连接器](https://ws-jmx-connector.dev.java.net/)有一个 java.net 项目，它依赖于[WiseMan 项目](http://wiseman.dev.java.net/)。Wiseman 是 WS-Management 标准的开源 Java 实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-09T19:32:36.967

以下是一些不错的网络资源：

*   [Oracle JMX 教程](http://docs.oracle.com/javase/1.5.0/docs/guide/jmx/tutorial/tutorialTOC.html)
*   [Java 监控和管理概述](http://docs.oracle.com/javase/1.5.0/docs/guide/management/overview.html)
*   [JMX in Action（以电子书形式提供）](http://www.manning.com/sullins/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T18:00:39.507

这是我第一次阅读 JMX 时读到的两个。

太阳教程：http: [//java.sun.com/docs/books/tutorial/jmx/index.html](http://java.sun.com/docs/books/tutorial/jmx/index.html)

Spring 2.5/JMX：[http ://static.springframework.org/spring/docs/2.5.x/reference/jmx.html](http://static.springframework.org/spring/docs/2.5.x/reference/jmx.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T09:51:05.870

或者您可以在 StackOverflow 上查看[JMX 标签 wiki](https://stackoverflow.com/tags/jmx/info)，我几天前对其进行了更新，列出了您所要求的内容，并提供了一些附加信息：

[https://stackoverflow.com/tags/jmx/info](https://stackoverflow.com/tags/jmx/info)

# c# - 从 Hashtable 复制 nk/v 对

> ID：859418
> 
> 赞同：1
> 
> 时间：2009-05-13T17:54:06.210
> 
> 标签：c#, hashtable, enumerator

我有一个包含 n 条记录的哈希表。我需要复制 x 和 y 之间的记录并遍历它们。

我该怎么做？

例子：

HT1.Count = 500;

HT2 = HT1[0] - HT1[100]；

- 编辑 -

请注意，这样做的原因是我正在从 .MSG 文件生成 PDF。最终用户出现的问题是，当他们获得 12GB PDF 时会导致问题：P

我需要将 PDF 分解为 250 条消息，然后开始一个新的 PDF。所以顺序并不重要，每次返回相同的记录也不重要，因为它只会执行一次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T18:00:36.590

我敢打赌会做一个这样的自定义功能：

```
public IEnumerable<object> GetRange(Hashtable ht, int min, int max) {
    int i = 0;
    foreach (var key in ht.Keys) {
        i++;
        if (i > max) {
            yield break;
        }
        if (i >= min) {
            yield return ht[key];
        } else continue;
    }
} 
```

但是，考虑到键的顺序是不能保证的，所以这可以有一个无序的对象序列

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T18:16:35.583

正如其他人所说，您不能以您想要的方式迭代哈希表。另一方面，如果您想要的是键在该范围内的结果，您可以执行以下操作：

```
 public IDictionary<int, T> GetRange<T>(
        IDictionary<int, T> source, int min, int max)
    {
        // add error checking for min,max, null, etc...
        int capacity = Math.Max(0, max - min);
        Dictionary<int, T> target = new Dictionary<int, T>(capacity);
        for (int key = min; key < max; key++)
        {
            if (source.ContainsKey(key))
            {
                target.Add(key, source[key]);
            }
        }
        return target;
    } 
```

请注意，我使用的是通用版本 ( `Dictionary`) 而不是旧版本`Hashtable`，但想法是相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T17:56:00.280

我建议您查阅有关哈希表的参考资料。哈希表通常是无序的，所以你的问题毫无意义。

# c# - 如何枚举 MEF 中 AggregateCatalog 或 DirectoryCatalog 中的程序集？

> ID：859423
> 
> 赞同：5
> 
> 时间：2009-05-13T17:55:19.970
> 
> 标签：c#, mef

我有一个 MEF（Microsoft 扩展框架）应用程序，它从文件夹中加载一些程序集。我需要枚举为我的应用程序生成任何导出的程序集。

一种方法是枚举导入调用`GetExportedObject().GetType().Assembly`。但是在没有导入实例的情况下这样做会更干净。有没有办法从目录或其他任何东西中获取加载的程序集？

我需要程序集来获取它们的属性，如版权、版本、名称等。我的文件夹可以包含带导出和不带导出的程序集，但我只需要满足应用程序中任何导入的程序集。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-06-10T18:14:55.490

这是一种方法，在 Caliburn.Micro 中使用：

```
var aggregateCatalog = new AggregateCatalog(...);
var assemblies = aggregateCatalog.Parts
    .Select(part => ReflectionModelServices.GetPartType(part).Value.Assembly)
    .Distinct()
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T18:51:47.147

AssemblyCatalog 有一个 Assembly 属性。AggregateCatalog 无法直接获取此信息 - 无法保证内部目录甚至从装配中加载其零件。DirectoryCatalog 没有此功能，但如果有充分的理由可以添加它。

为什么要获取程序集列表？您最好不要使用目录目录，而是自己扫描并加载目录中的程序集，然后为每个程序集创建一个 AssemblyCatalog 并将其添加到 AggregateCatalog。

编辑：MEF 没有办法获取在合成中“使用”的所有导出列表。您可能会编写自己的目录，该目录将返回作为默认部件定义外壳的部件定义，并跟踪哪些部件调用了 GetExportedObject。您可以使用 ReflectionModelServices 中的 API 来确定哪种类型对应于默认目录中的给定部件定义。请注意，编写这样的目录可能不是一项简单的工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-15T20:25:16.247

这是我当前运行良好的解决方案：

1.  不要使用 DirectoryCatalog，直接加载程序集并从中创建 AssemblyCatalog。
2.  使用 AssemblyCatalog.Parts 找出哪些组件具有导出，让用户对其进行授权。
3.  仅将授权的 AssemblyCatalog 添加到组合中的 AggregateCatalog。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-31T17:59:38.960

如果您可以访问这些程序集的源代码，那么我可以使用另一种解决方案来逐个添加程序集。您可以创建一个名为 IModule 的接口，并将其作为所有程序集导出的要求。然后你可以将它们全部导入你的引导程序：

```
[ImportMany]
public List<IModule> Modules { get; set; } 
```

此列表将包含所有 Module 类的列表，您可以通过这些类访问程序集：

```
var module1 = Logic.Instance.Modules[0];
var fullename = module1.GetType().Assembly.FullName; 
```

# c++ - 由于 C 和 C++ 中的序列点，您遇到过哪些问题？

> ID：859433
> 
> 赞同：4
> 
> 时间：2009-05-13T17:58:21.727
> 
> 标签：c++, c, sequence-points

以下是由于序列点规则而导致未定义行为的两个常见问题：

```
a[i] = i++; //has a read and write between sequence points
i = i++;   //2 writes between sequence points 
```

关于序列点，您还遇到过哪些其他事情？

当编译器无法警告我们时，很难找出这些问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T18:21:19.647

达里奥的例子的一个变体是这样的：

```
void Foo(shared_ptr<Bar> a, shared_ptr<Bar> b){ ... }

int main() {
  Foo(shared_ptr<Bar>(new Bar), shared_ptr<Bar>(new Bar));
} 
```

这可能会泄漏内存。两个参数的求值之间没有顺序点，因此不仅第二个参数可以在第一个参数之前求值，而且两个 Bar 对象也可以在任何`shared_ptr`'s之前创建

也就是说，而不是被评估为

```
Bar* b0 = new Bar();
arg0 = shared_ptr<Bar>(b0);
Bar* b1 = new Bar();
arg1 = shared_ptr<Bar>(b1);
Foo(arg0, arg1); 
```

（这将是安全的，因为如果`b0`成功分配，它会立即包裹在 a 中`shared_ptr`），它可以被评估为：

```
Bar* b0 = new Bar();
Bar* b1 = new Bar();
arg0 = shared_ptr<Bar>(b0);
arg1 = shared_ptr<Bar>(b1);
Foo(arg0, arg1); 
```

这意味着如果`b0`成功分配并`b1`抛出异常，则`b0`永远不会被删除。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T18:09:47.027

有一些关于参数列表或添加的执行顺序的模棱两可的情况。

```
#include <iostream>

using namespace std;

int a() {
    cout << "Eval a" << endl;
    return 1;
}

int b() { 
    cout << "Eval b" << endl;
    return 2;
}

int plus(int x, int y) {
    return x + y;
}

int main() {

    int x = a() + b();
    int res = plus(a(), b());

    return 0;
} 
```

a() 还是 b() 先执行？;-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T16:56:56.130

这是 Bjarne Stroustup 使用 c++ 的编程原则和实践中的一个简单规则

> “如果您在表达式中更改变量的值。不要在同一个表达式中读取或写入两次”

```
a[i] = i++; //i's value is changed once but read twice
i = i++;   //i's value is changed once but written twice 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T18:47:19.197

一个类似于达里奥的例子，我也看到人们陷入：

```
printf("%s %s\n", inet_ntoa(&addr1), inet_ntoa(&addr2)); 
```

这不仅会打印“ `addr1 addr1`”或“ `addr2 addr2`”（因为`inet_ntoa`返回指向被进一步调用覆盖的静态缓冲区的指针），而且还没有定义哪种情况会出现（因为 C 没有在参数中指定评估顺序列表）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T17:37:51.977

以下是适用于大多数 C 编译器的两个很好的表达式，但由于序列点而含糊不清：

```
x ^= y ^= x ^= y; // in-place swap of two variables 
```

并且

```
int i=0;
printf("%d %d %d", ++i, ++i, ++i);  // usually prints out 3 2 1... but not for all compilers! 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T18:30:34.393

我最近看到的一个是由于程序员希望节省类格式化时间，完全错了：

```
 class A
{
public:

    ...

    const char* Format( const string& f ) const
    {
        fmt = Print( f, value );
        return fmt.c_str();
    }

    operator const char* () const { return fmt.c_str(); }

private:

    struct timeval value;
    mutable string fmt;
};

A a( ... );
printf( "%s %s\n", a.Format( x ), a.Format( y ); 

```

最后一行要么总是为两种格式打印相同的值（要么使程序崩溃，因为内部字符串会释放返回的内存）。

另一个来自我很久以前的一次采访：

```
 void func( int x, int y, int z )
{
    printf( "%d %d %d\n", x, y, z );
}

...
int i = 0;
func( i, ++i, i++ ); /* don't do this in real software :) */ 
```

# wpf - WPF/XAML 中可访问性的好方法？

> ID：859438
> 
> 赞同：7
> 
> 时间：2009-05-13T17:59:00.930
> 
> 标签：wpf, accessibility, screen-readers

我正在构建一个 WPF 应用程序，并且我很想找到有关如何使屏幕阅读器可以访问它的信息或演练。我浏览了 MSDN 并找到了一些关于 UI 自动化 (UIA) 的文章。基本上我发现了很多“好的，这是 UIA！它用于测试，也用于可访问性”，但没有“这就是你在 WPF 中使用它的方式”之类的。

任何输入都会很棒。谢谢

# algorithm - 使用相同字符查找最接近字符串的算法

> ID：859441
> 
> 赞同：4
> 
> 时间：2009-05-13T18:00:01.957
> 
> 标签：algorithm, string, permutation

给定一个包含 n 个字符串的列表 L 和一个输入字符串 S，找到 L 中包含 S 中存在的最多字符的字符串的有效方法是什么？我们想在 L 中找到最接近由 S 中包含的字母组成的字符串。

显而易见的答案是遍历所有n个字符串，并检查当前字符串中有多少个字符存在于S中。但是，该算法会频繁运行，并且将n个字符串的列表L存储在数据库中......手动循环遍历所有 n 个字符串需要类似于 n*m^2 的 big-Oh，其中 n 是 L 中的字符串数，m 是 L 中任何字符串的最大长度，以及 S 的最大长度...在这种情况下，m 实际上是一个常数 150。

有没有比简单循环更好的方法？是否有可以将 n 个字符串加载到其中的数据结构，可以让我快速搜索？是否有一种算法使用预先计算的关于 n 个字符串中的每一个的元数据，其性能会比循环更好？

我知道有很多极客都在研究算法。所以请帮忙！

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T18:20:13.813

如果您追求子字符串，[Trie](http://en.wikipedia.org/wiki/Trie)或 Patrica trie 可能是一个很好的起点。

如果您不关心顺序，只关心每个符号或字母的数量，我会计算所有字符串的直方图，然后将它们与输入的直方图进行比较。

```
 ABCDEFGHIJKLMNOPQRSTUVWXYZ
Hello World => ...11..1...3..2..1....1... 
```

`O(26 * m + n)`如果您只考虑不区分大小写的拉丁字母，这将降低一次预处理的成本。

如果 m 是常数，您可以通过对其进行归一化将直方图解释为 26 维单位球体上的 26 维向量。然后你可以计算两个向量的[点积](http://en.wikipedia.org/wiki/Dot_product)，得到两个向量之间夹角的余弦值，这个值应该与字符串的相似度成正比。

假设只有`m = 3`一个大小为 3 的字母表`A = { 'U', 'V', 'W' }`和以下字符串列表。

```
L = { "UUU", "UVW", "WUU" } 
```

直方图如下。

```
H = { (3, 0, 0), (1, 1, 1), (2, 0, 1) } 
```

直方图使用直方图的欧几里得范数`h = (x, y, z)`归一化- 即。`h' = (x/r, y/r, z/r)``r``h``r = sqrt(x² + y² + z²)`

```
H' = { (1.000, 0.000, 0.000), (0.577, 0.577, 0.577), (0.894, 0.000, 0.447) } 
```

输入`S = "VVW"`具有直方图`hs = (0, 2, 1)`和归一化直方图`hs' = (0.000, 0.894, 0.447)`。

现在我们可以计算两个直方图的相似度，以及两个直方图`h1 = (a, b, c)`的`h2 = (x, y, z)`欧几里得距离。

```
d(h1, h2) = sqrt((a - x)² + (b - y)² + (c - z)²) 
```

对于我们得到的例子。

```
d((3, 0, 0), (0, 2, 1)) = 3.742
d((1, 1, 1), (0, 2, 1)) = 1.414
d((2, 0, 1), (0, 2, 1)) = 2.828 
```

因此“UVW”最接近“VVW”（数字越小表示相似度越高）。

使用归一化直方图`h1' = (a', b', c')`，`h2' = (x', y', z')`我们可以将距离计算为两个直方图的点积。

```
d'(h1', h2') = a'x' + b'y' + c'z' 
```

对于我们得到的例子。

```
d'((1.000, 0.000, 0.000), (0.000, 0.894, 0.447)) = 0.000
d'((0.577, 0.577, 0.577), (0.000, 0.894, 0.447)) = 0.774
d'((0.894, 0.000, 0.447), (0.000, 0.894, 0.447)) = 0.200 
```

再次确定“UVW”最接近“VVW”（数字越大表示相似度越高）。

两个版本产生不同的数字，但结果总是相同的。也可以使用其他范数——例如曼哈顿距离（L1 范数）——但这只会改变数字，因为有限维向量空间中的范数都是等价的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T18:08:20.993

听起来你需要[尝试](http://en.wikipedia.org/wiki/Trie)一下。尝试用于搜索类似于拼写检查器工作方式的单词。因此，如果字符串 S 的字符顺序与 L 中的字符串相同，那么这可能对您有用。

但是，如果 S 中的字符顺序不相关——比如一组拼字游戏，而你想搜索最长的单词——那么这不是你的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T23:18:13.157

你想要的是[BK-Tree](http://blog.notdot.net/2007/4/Damn-Cool-Algorithms-Part-1-BK-Trees)。这有点不直观，但非常酷 - 它可以在 O(log n) 时间内搜索 levenshtein（编辑）距离阈值内的元素。

如果您关心输入字符串的顺序，请按原样使用它们。如果不这样做，您可以在将单个字符插入 BK-Tree（或使用它们进行查询）之前对它们进行排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T19:02:04.807

我相信你在找什么可以在这里找到：[基于模糊逻辑的搜索技术](http://publications.drdo.gov.in/gsdl/collect/dbit/index/assoc/HASH5495.dir/dbit2406003.pdf)

它很重，但你所要求的也是如此。它谈论单词相似性和字符错位。

```
i.e:

L I N E A R T R N A S F O R M
L I N A E R T R A N S F O R M
L E N E A R T R A N S F R M 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T20:42:43.143

在我看来，字符的顺序在您的问题中并不重要，但您正在搜索单词 S 的“近字谜”。

如果是这样，那么您可以将集合 L 中的每个单词表示为 26 个整数的数组（假设您的字母表有 26 个字母）。您可以将 S 类似地表示为 26 个整数的数组；现在要找到最佳匹配，您只需在集合 L 中运行一次并计算 S 向量和当前 L 向量之间的距离度量，但是您想定义距离度量（例如欧几里得 / 平方和或曼哈顿/ 绝对差之和）。这是 O(n) 算法，因为向量具有恒定长度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-27T06:05:38.657

这是一个对我来说非常有用的 T-SQL 函数，它为您提供了编辑距离：

例子：

```
 SELECT TOP 1 [StringValue] , edit_distance([StringValue, 'Input Value')
    FROM [SomeTable]
ORDER BY edit_distance([StringValue, 'Input Value') 
```

功能：

```
CREATE FUNCTION edit_distance(@s1 nvarchar(3999), @s2 nvarchar(3999))
RETURNS int
AS
BEGIN
  DECLARE @s1_len int, @s2_len int, @i int, @j int, @s1_char nchar, @c int, @c_temp int,
    @cv0 varbinary(8000), @cv1 varbinary(8000)
  SELECT @s1_len = LEN(@s1), @s2_len = LEN(@s2), @cv1 = 0x0000, @j = 1, @i = 1, @c = 0
  WHILE @j <= @s2_len
    SELECT @cv1 = @cv1 + CAST(@j AS binary(2)), @j = @j + 1
  WHILE @i <= @s1_len
  BEGIN
    SELECT @s1_char = SUBSTRING(@s1, @i, 1), @c = @i, @cv0 = CAST(@i AS binary(2)), @j = 1
    WHILE @j <= @s2_len
    BEGIN
      SET @c = @c + 1
      SET @c_temp = CAST(SUBSTRING(@cv1, @j+@j-1, 2) AS int) +
        CASE WHEN @s1_char = SUBSTRING(@s2, @j, 1) THEN 0 ELSE 1 END
      IF @c > @c_temp SET @c = @c_temp
      SET @c_temp = CAST(SUBSTRING(@cv1, @j+@j+1, 2) AS int)+1
      IF @c > @c_temp SET @c = @c_temp
      SELECT @cv0 = @cv0 + CAST(@c AS binary(2)), @j = @j + 1
    END
    SELECT @cv1 = @cv0, @i = @i + 1
  END
  RETURN @c
END 
```

# rest - 如何在 REST 中实现资源的复制粘贴？

> ID：859445
> 
> 赞同：3
> 
> 时间：2009-05-13T18:00:36.717
> 
> 标签：rest, copy-paste

您将如何以 RESTful 方式实现复制粘贴支持？

假设我有书店资源。每家商店都有书

```
http://mydomain.com/rest/book-stores/1
http://mydomain.com/rest/book-stores/1/books/12 
```

我需要客户端能够调用将一本书复制粘贴到另一家商店。

实施以下内容：

```
PUT http://mydomain.com/rest/books/1/copy-paste 
```

看起来很像RPC。您有什么建议如何以 RESTful 方式建模此操作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T18:15:57.610

复制 = 获取[http://mydomain.com/book/1](http://mydomain.com/book/1)

粘贴 = PUT [http://mydomain.com/book/2](http://mydomain.com/book/2) 或 POST [http://mydomain.com/book](http://mydomain.com/book)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T14:24:08.123

如果您的资源被组织成模仿分层系统，这只是一个问题。就像一个文件系统。

我更喜欢非分层资源。文件的“路径”只是文件的属性。要复制粘贴，有两种选择。

1.  如果您真的只是想要另一个“路径”引用，请为“路径”属性添加另一个条目。相同的确切文件“在”两个“文件夹”中。

2.  如果您需要新版本的文件，然后有效地分叉更改，请创建具有不同“路径”属性的新资源（不同的 URI）。

3.  要移动，只需更改“路径”属性。

如果您必须坚持分层，只需模仿文件系统复制粘贴和移动的方式。

副本很简单。要复制的资源的 GET。

粘贴一个 POST，因为您正在创建一个新资源，一个新 URI。

如果您需要移动，您可能需要删除旧资源。

如果您愿意，您可以在删除请求中指定一个位置，从而允许服务器重定向在其旧位置寻找移动资源的用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T18:07:19.480

我会拥有它，以便用户执行 PUT 命令来执行操作。

因此，表单数据中的变量之类的内容包含要执行的正确操作。

# java - 如何处理 J2ME 上最常见的类缺失

> ID：859449
> 
> 赞同：13
> 
> 时间：2009-05-13T18:01:09.477
> 
> 标签：java, java-me, cross-platform, portability, midp

我正在尝试编写一个运行不同 Java 平台（如 J2SE、J2ME、Android 等）的应用程序。我已经知道我必须为每个平台重写大部分 UI，但希望重用核心逻辑。

保持这个核心的可移植性涉及我知道的三个缺点：

1.  保持旧的**Java 1.4 语法**，不使用 Java 5.0 的任何优秀语言特性
2.  仅使用已知可在这些平台上工作的**外部库**（即：不要使用 JNI 并且不依赖于违反此规则的其他库）
3.  仅使用所有这些平台上**存在的类**

我知道克服**(1)**的方法：以 5.0 样式编写代码并自动将其转换为 1.4（*retroweaver* - 尚未尝试过，但似乎还可以）。

我认为**（2）**是一个我必须接受的问题。

现在我想知道**(3)**的最佳工作方法是什么，尤其是我最想念的集合类。我能想到那些：

*   我认识的大多数程序员只是不使用`Set`, `Map`,`List`等，而是回退到`Vector`普通数组。我认为这首先使代码变得丑陋。但我也知道`TreeSet/Hashset`or之间的正确选择`LinkedList/ArrayList`对性能至关重要，并且总是使用`Vector`and 数组是不对的。
*   我可以编写我自己的这些类的实现。这似乎是在重新发明轮子，我认为我不能像其他人那样做得好。
*   由于 Java 是开源的，因此在为 J2ME 构建时，我可以获取 J2SE Collections 框架的源代码并将其包含到我的应用程序中。不过，我不知道这是否是个好主意。也许有充分的理由不这样做。
*   也许已经有一些库，它们重建了集合框架最重要的特性，但针对低端系统进行了优化，也许是通过不实现不经常使用的功能。你知道任何？

感谢您的回答和意见！

**编辑：**我终于找到了一个（复杂但很好的）解决方案，我想通过提供我自己的答案并接受它，该解决方案将在顶部可见。但相反，我的答案仍然处于最底层。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-15T16:34:23.040

J2ME 是残酷的，你将不得不放弃自己去做没有其他平台的一些细节。习惯 Hashtable 和 Vector，并在它们之上编写自己的包装器。此外，也不要错误地认为 J2ME 是标准的，因为每个制造商的 JVM 可以以截然不同的方式做事。最初我不会太担心性能，因为仅仅在 J2ME 上获得正确性就足够了。可以编写一个跨 J2ME、J2SE 和 Android 运行的应用程序，正如我所做的那样，但这需要大量工作。我的一个建议是，您编写应用程序逻辑的核心并严格遵守 java.lang、java.util 和 java.io。任何你将要做可能与平台交互的事情的地方，例如文件系统或网络，您可以创建一个与您的核心应用程序代码交互的接口，您可以为不同的环境提供不同的实现。例如，您可以拥有一个封装 HTTP 内容的接口，并在 J2ME 和 Android 上使用 javax.microedition.io.HttpConnection 和 java.net.HttpURLConnection。这很痛苦，但如果你想维护一个在所有这三个环境中运行的应用程序，它可以让你到达那里。祝你好运。但是，如果您想维护在所有这三个环境中运行的应用程序，它可以帮助您实现目标。祝你好运。但是，如果您想维护在所有这三个环境中运行的应用程序，它可以帮助您实现目标。祝你好运。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-07-04T18:47:37.107

自从我问这个问题以来已经有一段时间了，自从我找到了一个很好的、有效的解决方案以来，我已经忘记了告诉你。

我的主要关注点是 Java 集合框架，它是`java.util`包的一部分。

我终于拿到了 Suns Java 6.0 的源代码，并将属于 Collections 框架的所有类复制到我自己的项目中。这是一个 Java 6.0 项目，但我使用 J2ME 中的 jar 作为类路径。我复制的大多数类都依赖于其他 J2SE 类，因此存在损坏的依赖关系。无论如何，通过省略所有处理序列化（这对我来说不是优先事项）和一些小的调整来减少这些依赖是很容易的。

我用 Java 6 编译器编译了整个东西，然后使用逆向翻译器将生成的字节码移植回 Java 1.2。

下一个问题是包名，因为您不能`java.util`使用 J2ME 应用程序传递类并加载它们 - 引导类加载器不会查看应用程序 jar 文件，其他引导加载器不允许使用该包加载某些内容名称，并且在 J2ME 上您不能定义自定义类加载器。Retrotranslator 不仅可以转换字节码，还可以帮助更改现有字节码中的名称引用。我不得不移动并重命名项目中的所有类，例如`java.util.TreeMap`成为`my.company.backport.java.util.TreeMap_`.

我能够在第二个 Java 6.0 项目中编写实际的 J2ME 应用程序，该项目引用了通常的`java.util.TreeMap`.，使用通用语法创建类型安全的集合，将该应用程序编译为 Java 6.0 字节代码，并通过逆向翻译器运行它以创建 Java 1.2 代码现在引用`my.company.backport.java.util.TreeMap_`. 请注意，这`TreeMap`只是一个示例，它实际上适用于整个集合框架，甚至适用于引用该框架的 3rd 方 J2SE Jars。

生成的应用程序可以打包为 jar 和 jad 文件，并且可以在 J2ME 模拟器和实际设备上正常运行（在索尼爱立信 W880i 上测试）。

整个过程看起来相当复杂，但由于我使用 Ant 进行构建自动化，而且无论如何我都需要重新翻译器，因此设置集合框架反向移植只需要一次性开销。

如上所述，我在将近一年前就完成了这项工作，并且大部分时间都是从头顶写的，所以我希望其中没有错误。如果您对更多细节感兴趣，请给我留言。我有几页关于该过程的德语文档，如果有任何需求，我可以提供。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T01:02:05.793

[我们在开发zxing](http://code.google.com/p/zxing)时就遇到了这种情况。如果 J2ME 在您的目标列表中，那么到目前为止这是您的限制因素。我们针对 MIDP 2.0 / CLDC 1.1。如果你有类似的需求，你需要坚持 Java 1.2。Java 1.4 语言特性绝对不存在（如断言），并且通常在 J2ME 1.2 之后您将找不到任何东西。

我们没有使用外部库，但是，您可以轻松地将它们打包到部署的 .jar 文件中。它会使生成的 .jar 更大，这可能是一个问题。（然后你可以尝试像 ProGuard 这样的优化器/收缩器来缓解这种情况。）

我最终确实重新实现了诸如 Collections.sort() 和 Comparator 之类的东西，因为我们需要它们并且它们不在 J2ME 中。所以是的，您可能会考虑在某些情况下这样做，尽管仅在必要时。

我们使用了 Vector 和 Hashtable 以及数组，因为在 J2ME 中确实没有其他选择。除非您有理由不使用它们，否则我只会使用它们，我猜这将是性能。理论上，JVM 制造商已经在优化他们的实现，但这并不意味着你不能做出更好的实现......我想如果在绝大多数情况下它是值得的，我会感到惊讶。在付出努力之前，请确保您确实需要这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T11:23:24.873

要回答您的部分问题，另一个集合库将是[Javolution](http://www.javolution.org/)，它可以为 j2me 构建。

# sql-server - 将 oracle 复制到 sqlserver 2005 jdbc

> ID：859452
> 
> 赞同：0
> 
> 时间：2009-05-13T18:01:46.060
> 
> 标签：sql-server, sql-server-2005, oracle, jdbc

有没有办法将数据库从 oracle 复制到 sqlserver 2005？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T18:21:57.350

您可以使用 Microsoft 的[SQL Server 迁移助手](http://www.microsoft.com/sqlserver/2005/en/us/migration-oracle.aspx)从 Oracle 迁移到 SQL Server 。它适用于 SQL Server 2005 和 2008。

如果您有很多（复杂的）存储过程等，迁移可能会有点乏味。我只有使用简单过程的数据库的经验，并且可以重写它们并将数据复制到 SQL Server 中的空表，并使用 Oracle 连接器使用导入功能（如果您已将 Oracle 客户端工具安装到 SQL Server 机器，则可以从 SQL Server 使用） . 这样我什至不需要使用迁移助手工具。

# sharepoint - OnQuickLaunch 被忽略

> ID：859453
> 
> 赞同：2
> 
> 时间：2009-05-13T18:01:51.660
> 
> 标签：sharepoint

我有一个将 OnQuickLaunch 属性设置为 true 的列表模板。列表的默认视图设置为运行一些自定义代码的虚拟页面，然后将列表的默认视图设置为“真实”默认值，然后将其自身删除。

当我（通过 UI）创建列表时，忽略 OnQuickLaunch 属性。我可以做些什么来让 SharePoint 遵守该设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-12-27T18:50:39.333

检查列表模板中的属性是否为大写 (TRUE)，这些配置文件中的某些属性不区分大小写。

# wpf - WPF 设计器和绑定到依赖属性问题

> ID：859454
> 
> 赞同：4
> 
> 时间：2009-05-13T18:02:22.033
> 
> 标签：wpf, dependency-properties

绑定到自定义依赖项属性时，我在更新 WPF 设计器时遇到问题。

在下面的示例中，我创建了一个简单的 Ellipse，我想用我的自定义 MyAwesomeFill 属性来填充它。MyAwesomeFill 的默认值为 Yellow SolidColor 画笔。

问题是在设计器的控件表单中，我看不到椭圆的默认填充（黄色），而是用 SolidColor（#00000000）填充椭圆。但是，当我运行应用程序时，一切正常。

你有什么想法为什么会发生这种情况？

谢谢。

这是我使用的代码：

XAML：

```
<UserControl x:Class="TestApplication.MyEllipse"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300">
    <Grid>
        <Ellipse Stroke="Black" StrokeThickness="5" Fill="{Binding MyAwesomeFill}"></Ellipse>
    </Grid>
</UserControl> 
```

C＃：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace TestApplication
{
    public partial class MyEllipse : UserControl
    {
        #region Dependency property MyAwesomeFill
        //Define and register dependency property
        public static readonly DependencyProperty MyAwesomeFillProperty = DependencyProperty.Register(
            "MyAwesomeFill",
            typeof(Brush),
            typeof(MyEllipse),
            new PropertyMetadata(new SolidColorBrush(Colors.Yellow), new PropertyChangedCallback(OnMyAwesomeFillChanged))
        );

        //property wrapper
        public Brush MyAwesomeFill
        {
            get { return (Brush)GetValue(MyAwesomeFillProperty); }
            set { SetValue(MyAwesomeFillProperty, value); }
        }

        //callback
        private static void OnMyAwesomeFillChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
        {
            MyEllipse m = (MyEllipse)obj;
            m.OnMyAwesomeFillChanged(e);
        }
        #endregion

        //callback
        protected virtual void OnMyAwesomeFillChanged(DependencyPropertyChangedEventArgs e)
        {
        }

        public MyEllipse()
        {
            InitializeComponent();

            DataContext = this;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T19:13:59.420

不保证设计者可以运行后面的代码。如果您将 MyEllipse 控件添加到窗口，它将运行（窗口中的椭圆有黄色背景），但当您直接查看控件时不会运行。这意味着它将适用于您控制的用户，这很重要。

要在设计器中打开 MyEllipse 时修复它以使其看起来不错，请添加一个后备值。

```
<Ellipse 
    Stroke="Black" 
    StrokeThickness="5" 
    Fill="{Binding MyAwesomeFill, FallbackValue=Yellow}">
</Ellipse> 
```

# c# - 非 DataTable 数据源的 DataGrid MappingName 是什么？

> ID：859464
> 
> 赞同：5
> 
> 时间：2009-05-13T18:04:05.697
> 
> 标签：c#, .net, windows-mobile, compact-framework

我能够将 .NET 3.5 CF 中的 DataGrid 绑定到 List() 但我无法通过指定列的宽度来格式化列。下面是看起来应该可以工作但没有工作的代码。我很确定我没有正确设置 MappingName，因为所有教程都告诉您将其设置为 DataTable 的名称，但我没有绑定到 DataTable，所以我不确定该怎么做。

```
 grdBatch.DataSource = InventoryItems;

        DataGridTableStyle tableStyle = new DataGridTableStyle();
        tableStyle.MappingName = InventoryItems.ToString();
        DataGridTextBoxColumn tbcName = new DataGridTextBoxColumn();
        tbcName.Width = 400;
        tbcName.MappingName = "SERIAL_ID";
        tbcName.HeaderText = "SERIAL_ID";
        tableStyle.GridColumnStyles.Add(tbcName);
        grdBatch.TableStyles.Clear();
        grdBatch.TableStyles.Add(tableStyle); 
```

grdBatch 是一个 DataGrid，InventoryItems 是一个 POCOS 列表（普通的旧 C# 对象）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-14T23:13:18.537

改变：

```
 tableStyle.MappingName = InventoryItems.ToString(); 
```

到

```
tableStyle.MappingName = InventoryItems.GetType().Name; 
```

# javascript - 对象/哈希中的 Javascript 函数

> ID：859466
> 
> 赞同：4
> 
> 时间：2009-05-13T18:04:39.220
> 
> 标签：javascript, function

我可以像这样直接调用一个函数（我将`alert`用作示例）

```
alert("Hello World!");  // pops up an alert window 
```

但是，当我将函数放入对象中时，调用它不再起作用：

```
d = {func: alert};
d.func("Hello World!");    // doesn't do anything
d["func"]("Hello World!"); // also doesn't do anything 
```

我想也许我需要明确地传入一个空白`this`参数，所以我尝试了

```
d.func(null, "Hello World!") // still nothing 
```

但无济于事。有趣的是，这确实有效

```
d.func.apply(null, ["Hello World!"]);  // success! 
```

但这太无缘无故地冗长了，以至于我的牙齿受伤了（引用JWZ的话）。有没有更简洁，不那么丑陋的方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T18:12:14.513

JavaScript 中的函数是按值传递的。该`alert()`函数是本机实现的，这意味着它没有 JavaScript 值。根据您的浏览器，本机包装器的意义（请原谅我）会有所不同。您的代码实际上可以在 Google Chrome 中运行，但不能在 Firefox 中运行，而且我会说它在 Internet Explorer 中也不起作用，这通常对修改本机对象不友好，并且职能。您可以改用以下内容：

```
d = {
    func: function (message) {
        alert(message);
    }
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T18:09:03.363

如果你试试这个：

```
function test(x) {
    alert(x);
}
var x = {func: test}
x.func('Hi!'); 
```

它可以按您的预期工作。当我尝试`alert`直接执行此操作时，Firebug 给了我以下错误消息：

```
[Exception... "Cannot modify properties of a WrappedNative"
nsresult: "0x80570034 (NS_ERROR_XPC_CANT_MODIFY_PROP_ON_WN)"
location: "JS frame :: http://stackoverflow.com/questions/859466/javascript-function-in-an-object-hash :: anonymous :: line 72" data: no] 
```

所以我猜这是一个安全问题，或者与它作为一个原生函数有关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T18:09:50.290

我一直这样做：

```
var d = Object;

d.hello = function(msg) {
                    alert(msg)
                    };

d.hello('hello'); 
```

* * *

当然，你也可以使用[PrototypeJS](http://www.prototypejs.org)来实现所有面向对象：

```
var Message = Class.create( {
              display:  function(msg) {
                  alert(msg);
               }
           });

var msg = new Message();

msg.display('hello'); 
```

# wpf - wpf：可以在网格之外使用网格拆分器吗？

> ID：859468
> 
> 赞同：2
> 
> 时间：2009-05-13T18:04:51.780
> 
> 标签：wpf, layout, gridsplitter

我有一个`StackPanel`，它非常适合布置用户在运行时添加的列。但是我希望列可以调整大小，并且我正在阅读有关`GridSplitter`控件的信息。这就是我想知道的：`GridSplitter`WinForms 拆分器的 wpf 替代品吗？换句话说，这是允许用户调整窗口区域大小的事实上的方式吗？它只能在 a 内部工作`Grid`吗？如果我在堆栈面板或停靠面板中有项目，我仍然可以像在 WinForms 中使用拆分器一样使用网格拆分器吗？如果我必须使用 a `Grid`，我怎样才能让它表现得像 a `StackPanel`？（希望不会这样）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T18:33:32.653

GridSplitter 仅在 Grid 中工作，是允许用户调整控件大小的最简单方法。你想让你的网格（带有gridsplitters）表现得像一个堆栈面板是什么意思？stackpanel 将完全适合其每个子项，而带有 gridsplitters 的网格将由用户决定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T16:09:12.847

下面是一个用户控件，它允许将项目添加为列。列之间是网格拆分器。用户可以单击删除按钮删除添加的列，并且可以使用后面的代码添加列。让我知道这是否是你要找的。

用户控制 SmartGrid XAML：

```
<UserControl x:Class="SmartGridDemo.SmartGrid"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid Name="_grid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
    </Grid>
</UserControl> 
```

用户控制 SmartGrid 背后的代码：

```
using System;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;

namespace SmartGridDemo
{
    public partial class SmartGrid : UserControl
    {
        public SmartGrid()
        {
            InitializeComponent();
        }

        public void Add(UIElement child)
        {
            int columnIndex = _grid.ColumnDefinitions.Count();

            _grid.ColumnDefinitions.Add(
                new ColumnDefinition() 
                {
                    Width = new GridLength(columnIndex == 0 ? 0 :5)
                });

            GridSplitter gridSplitter =
                new GridSplitter()
                {
                    HorizontalAlignment = HorizontalAlignment.Stretch,
                    VerticalAlignment = VerticalAlignment.Stretch,
                    ResizeDirection = GridResizeDirection.Columns,
                    Background = Brushes.Black
                };

            _grid.Children.Add(gridSplitter);
            Grid.SetColumn(gridSplitter, columnIndex);
            Grid.SetRow(gridSplitter, 0);
            Grid.SetRowSpan(gridSplitter, 2);

            columnIndex++;

            _grid.ColumnDefinitions.Add(new ColumnDefinition() { Width = GridLength.Auto });

            Button button = new Button();
            button.Content = "Delete";
            button.Tag = new TagTuple() {Child = child, GridSplitter = gridSplitter};
            button.Click += new RoutedEventHandler(DeleteButton_Click);

            _grid.Children.Add(button);
            Grid.SetColumn(button, columnIndex);
            Grid.SetRow(button, 0);

            _grid.Children.Add(child);
            Grid.SetColumn(child, columnIndex);
            Grid.SetRow(child, 1);
        }

        private void DeleteButton_Click(object sender, RoutedEventArgs e)
        {
            Button button = sender as Button;
            int columnIndex = Grid.GetColumn(button);
            TagTuple tagTuple = button.Tag as TagTuple;
            _grid.Children.Remove(tagTuple.GridSplitter);
            _grid.Children.Remove(tagTuple.Child);
            _grid.Children.Remove(button as UIElement);

            _grid.ColumnDefinitions.RemoveAt(_grid.ColumnDefinitions.Count() - 1);
            _grid.ColumnDefinitions.RemoveAt(_grid.ColumnDefinitions.Count() - 1);

            foreach (UIElement child in _grid.Children)
            { 
                int columnIndexForChild = Grid.GetColumn(child);
                if (columnIndexForChild > columnIndex)
                {
                    Grid.SetColumn(child, columnIndexForChild - 2);
                }
            }
        }

        private class TagTuple
        {
            public GridSplitter GridSplitter { get; set; }
            public UIElement Child { get; set; }
        }
    }
} 
```

演示代码，在 TextBox 中添加一些文本，然后点击 Add 按钮添加新列，XAML：

```
<Window x:Class="SmartGridDemo.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:SmartGridDemo"    
    Title="SmartGridDemo" Height="300" Width="300">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <TextBox Name="_texBox" Grid.Row="0" Grid.Column="0" />
        <Button Content="Add" Click="AddButton_Click" Grid.Row="0" Grid.Column="1" />
        <local:SmartGrid x:Name="_smartGrid" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" />
    </Grid>
</Window> 
```

演示，后面的代码：

```
using System;
using System.Windows;
using System.Windows.Controls;

namespace SmartGridDemo
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            _smartGrid.Add(new TextBlock() { Text = "AAA" });
            _smartGrid.Add(new TextBlock() { Text = "BBB" });
            _smartGrid.Add(new TextBlock() { Text = "CCC" });
            _smartGrid.Add(new TextBlock() { Text = "DDD" });
            _smartGrid.Add(new TextBlock() { Text = "EEE" });
            _smartGrid.Add(new TextBlock() { Text = "FFF" });
        }

        private void AddButton_Click(object sender, RoutedEventArgs e)
        {
            _smartGrid.Add(new TextBlock() { Text = _texBox.Text });
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-11T23:03:19.080

这是一个开源 WPF SplitContainer：[ [http://wpfsplitcontainer.codeplex.com/]](http://wpfsplitcontainer.codeplex.com/])

# javascript - 根据浏览器语言切换 div 标签的可见性

> ID：859473
> 
> 赞同：0
> 
> 时间：2009-05-13T18:07:33.193
> 
> 标签：javascript, html, localization

首先，我是一名产品经理，开发团队已经生我的气了。所以我想试一试，为下面的问题创建解决方案。

我们有一个静态维护模式 html 页面，以 24 种语言显示“请稍后再回来查看”。现在我们一次显示所有 24 个翻译，页面非常难看。

我已经将每个翻译包装到它自己的 div 标签中，如下所示：

```
<div id="en">
  <p>Please check back soon</p>
</div>
<div id="es">
  <p>Compruebe por favor más adelante</p>
</div>
... 
```

我正在寻找使用 javascript 来检测浏览器语言并设置可见性：可见；对应于浏览器语言的 div。并将所有其他 div 标签设置为 visibility:hidden;

寻求有关检测浏览器语言和去除语言环境（如果提供）的帮助，因此我有一个 2 个字符的值可用于复杂的开关。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T18:16:13.943

我的解决方案是在 HTTP 请求中使用 Accept-Language 标头来查找用户的首选语言，然后以正确的语言返回一个 div。这样您就不必担心隐藏 div。此外，如果您隐藏 div，它们最初都会显示，然后仅在 Javascript 执行后才设置为隐藏，因此用户体验不会那么好。

请参阅：[http ://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T18:21:08.833

首先，这似乎是服务器端解决方案，而不是客户端解决方案。但是，快速搜索确实出现了这个片段：

```
var userLang = (navigator.language) ? navigator.language : navigator.userLanguage;
alert ("The language is: " + userLang); 
```

在[这个页面上](http://answers.yahoo.com/question/index?qid=20080418104516AAssAjm)。

因此，如果您真的必须在客户端上执行此操作，那么这可能会有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T18:29:23.500

首先，你不应该用 a 包裹`div`，你应该直接把属性放在标签上。其次，如果您在 HTML 中，您可以使用 lang 属性，如果您在 XHTML 中，您可以使用该`xml:lang`属性……这比`id`. 最后，如果可以的话，最好在服务器端进行处理，使用`Accept-Language`.

# crystal-reports - Crystal Reports 查询帮助 if-then-else

> ID：859477
> 
> 赞同：1
> 
> 时间：2009-05-13T18:08:07.233
> 
> 标签：crystal-reports

基本上，我的表中有一个名为 sex 的字段，它是一个布尔值。男为真，女为假。如何以这种方式显示它而不是 0、1？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T18:12:55.463

您想要创建一个公式字段并将公式字段而不是性别字段添加到报表中。像这样的东西应该可以工作（我的语法可能略有偏差）

```
if {MyTable.sex} = 1 
then 
  "male" 
else 
  "female" 
```

如果您不熟悉公式字段，它们只是您可以在报告中使用和显示的表达式。在 Crystal Reports 的“字段资源管理器”侧栏中，您可以看到所有数据库字段等的列表。只需右键单击公式字段并添加一个新字段。创建公式字段后，您可以将其拖到报表布局中，就像任何其他普通字段一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T18:16:04.070

使用公式字段。例如，将@Sex 放入您的报告中，然后将其编辑为：

```
//may need tweaked....
If {database.table.sex} then
    male
else
    female; 
```

我的 Crystal 公式语法真的很生疏，所以写的可能不正确。它*可能*需要：

```
//may need tweaked....
Stringvar displaySex;
If {database.table.sex} then
    displaySex = "male"
else
    displaySex = "female";
displaySex 
```

并且行尾 (";") 格式可能不正确....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:48:08.100

如果您右键单击原始数据库字段并选择“格式化字段...”，则可以使用上述公式之一在“通用”选项卡上设置“显示字符串”，而不是创建单独的公式来进行计算。

# forms - 在 asp 登录表单中添加“记住我”框

> ID：859485
> 
> 赞同：2
> 
> 时间：2009-05-13T18:09:40.867
> 
> 标签：forms, authentication, cookies, asp-classic

谁能指出我为简单登录页面添加记住我复选框的正确方向？它基本上只使用密码，而不是用户名。这可能吗？

这是登录 asp 页面未受保护部分的代码：

```
'****************** Begin UNprotected content ****************************
'
'   Enter the content you want the user to see prior to loggin in here.
'   Be sure the content is between the < % Else % > and < % End If % > asp
'   tags here. 

%>
<p>Welcome to our Members Only area. Please enter the password we supplied you to Log
In.</p>
<form action="<%= strPage %>" method="post" name="frmMembers" id="frmMembers">
<table id="n3-LogInTable">
    <caption><%= strCaption %></caption>
    <col class="colOne" />
    <col />

    <tr>
        <td nowrap="nowrap">Password</td>
        <td><input name="txtPassword" type="password" class="n3-textField" id="txtPassword" size="30" maxlength="50" /></td>
    </tr>
    <tr>
        <td colspan="2" nowrap="nowrap"><input name="btnLogIn" type="image" id="btnLogIn" src="login/n3_stuff/btn_login.gif" /></td>
    </tr>
    <tr></tr>
</table>
</form>
<% '****************** End UNprotected content **************************** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T18:12:17.477

使用 cookie [http://bytes.com/groups/net-asp/442519-remember-me-cookie-asp-net](http://bytes.com/groups/net-asp/442519-remember-me-cookie-asp-net)

# python - 如何对字段值的每个给定增量进行 GROUP BY？

> ID：859489
> 
> 赞同：1
> 
> 时间：2009-05-13T18:10:20.180
> 
> 标签：python, sql, sqlite, iteration, increment

我有一个 Python 应用程序。它有一个 SQLite 数据库，里面充满了关于发生的事情的数据，由网络爬虫从网络上检索。该数据在为它们保留的列中包括时间-日期组，作为 Unix 时间戳。我想检索做某事的组织的名称并计算他们做这些事情的频率，但要每周（即 604,800 秒）执行此操作，我有数据。

伪代码：

```
for each 604800-second increment in time:
 select count(time), org from table group by org 
```

本质上，我要做的是像在时间列上排序的列表一样遍历数据库，步长值为 604800。目的是分析总体中不同组织的分布如何随时间变化。

如果可能的话，我想避免从数据库中提取所有行并在 Python 中处理它们，因为这似乎 a）效率低下，并且 b）考虑到数据在数据库中，这可能毫无意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T18:30:03.080

创建一个表，列出自纪元以来的所有周，并将`JOIN`其添加到您的事件表中。

```
CREATE TABLE Weeks (
  week INTEGER PRIMARY KEY
);

INSERT INTO Weeks (week) VALUES (200919); -- e.g. this week

SELECT w.week, e.org, COUNT(*)
FROM Events e JOIN Weeks w ON (w.week = strftime('%Y%W', e.time))
GROUP BY w.week, e.org; 
```

每年只有 52-53 周。即使您将 Weeks 表填充 100 年，它仍然是一张小表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T18:36:16.407

要以基于集合的方式（这是 SQL 擅长的方式）执行此操作，您将需要基于集合的时间增量表示。这可以是临时表、永久表或派生表（即子查询）。我对 SQLite 不太熟悉，自从我使用 UNIX 以来已经有一段时间了。UNIX 中的时间戳距离某个设置的日期/时间仅 # 秒？使用标准日历表（在数据库中很有用）...

```
SELECT
     C1.start_time,
     C2.end_time,
     T.org,
     COUNT(time)
FROM
     Calendar C1
INNER JOIN Calendar C2 ON
     C2.start_time = DATEADD(dy, 6, C1.start_time)
INNER JOIN My_Table T ON
     T.time BETWEEN C1.start_time AND C2.end_time  -- You'll need to convert to timestamp here
WHERE
     DATEPART(dw, C1.start_time) = 1 AND    -- Basically, only get dates that are a Sunday or whatever other day starts your intervals
     C1.start_time BETWEEN @start_range_date AND @end_range_date  -- Period for which you're running the report
GROUP BY
     C1.start_time,
     C2.end_time,
     T.org 
```

Calendar 表可以采用您想要的任何形式，因此您可以在其中使用 UNIX 时间戳作为 start_time 和 end_time。您只需使用您可能想要使用的任何可能范围内的所有日期预先填充它。即使从 1900-01-01 到 9999-12-31 也不会是一张非常大的桌子。对于许多报告类型的查询，它可以派上用场。

最后，此代码是 T-SQL，因此您可能需要将 DATEPART 和 DATEADD 转换为 SQLite 中的任何等效项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T20:14:00.163

不熟悉 SQLite 我认为这种方法应该适用于大多数数据库，因为它会找到周数并减去偏移量

```
SELECT org, ROUND(time/604800) - week_offset, COUNT(*)
FROM table
GROUP BY org, ROUND(time/604800) - week_offset 
```

在 Oracle 中，如果时间是日期列，我将使用以下内容：

```
SELECT org, TO_CHAR(time, 'YYYY-IW'), COUNT(*)
FROM table
GROUP BY org, TO_CHAR(time, 'YYYY-IW') 
```

SQLite 可能具有类似的功能，允许这种看起来更容易的 SELECT。

# oracle - 如何从远程客户端连接到 Oracle 10g？

> ID：859491
> 
> 赞同：0
> 
> 时间：2009-05-13T18:10:46.513
> 
> 标签：oracle, delphi, dbexpress, ora-12514

使用标准的 Delphi dbexpress dbexpora.dll + oci.dll (10g)（安装了 oracle 即时客户端）。

当直接在 Oracle 数据库上时，我们可以很好地运行 dbexpress 应用程序。在这种情况下使用的本地 dbxconnections.ini 别名只是将我们的数据库服务名称 ORCL 指定为“数据库”参数。

我们正在尝试从客户端计算机连接到同一个数据库并收到一系列错误。

自然，我们在数据库参数中尝试各种字符串。使用像 MOHAWK2:1521:ORCL 这样的字符串，我们至少可以得到一个监听器错误：

连接失败：ORA-12514 TNS：监听器当前不知道连接描述符中请求的服务。

我想有一些工具可以测试命名可用性......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T18:55:21.353

在服务器上使用 TNSPING 来查看它是如何解析服务名称的。各种配置选项和文件可以将一个简单的名称映射到一个完整的服务器/端口/服务。

C:>TNSPING ORCL

使用 TNSNAMES 适配器解析别名尝试联系 (DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = 127.0.0.1)(PORT = 1521)) (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = XE))) OK (0 毫秒)

提取服务器/端口/服务并以您使用的组件或连接方法所需的任何格式构造连接字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T19:47:18.273

侦听器是否在 oracle 服务器上设置并运行？它是否接受您要连接的数据库的实例/服务的连接？你检查过 lsnrctl 状态吗？您是否尝试打开 sqlnet 日志记录和侦听器日志记录，以查看您是否甚至从远程站点连接到数据库，以及在 listner 日志中记录了哪些错误以说明其拒绝服务的原因？监听器是接受 tcp 连接还是监听器只接受 IPC 连接？如果不监听 tcp 连接，它将不接受远程连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T19:48:46.057

首先使用 tnsping 检查连接性。如果正常，请尝试使用 sqlplus 连接。如果 tnsping 失败，您使用的服务名称不正确，或者您没有正确配置客户端。如果您依赖本地配置，则要编辑的文件是 ORAHOME\NETWORK\ADMIN 中的 tnsnames.ora，需要配置设置才能定位服务器，其中包括主机、端口和服务名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T14:15:07.783

抱歉，关于 CAPS，这对我来说是全新的。我没有任何声誉，我所做的现在已经被降低到这个问题标题是大写的。我不知道如何对所有回答的人发表评论......因为它不会让我......我没有足够的声誉。我想我需要移动到另一个论坛....

反正，

解决了！

我设置了一个新的 vmware 克隆——在一个目录中安装了 oracle 客户端和我们的几个 dll 和 exe，它可以工作。

所以我删除了我正在使用的盒子和宾果游戏中所有无关的东西。

我认为那台机器上已经存在来自delphi 2007的干扰......尽管试图绕过它周围的一切。

# database-design - 完全可审计的数据模型的最佳实现？

> ID：859492
> 
> 赞同：5
> 
> 时间：2009-05-13T18:11:00.897
> 
> 标签：database-design, data-modeling

我的要求是为每个对象的每个属性的更改保留完整的审计跟踪的数据模型。对象定义也是流动的：新属性会随着时间的推移出现或消失。此审计跟踪将与原始数据库分开存在，因此基于触发器的审计模型将不起作用。

在关系数据库中，我可以使用一个大型 ATTRIBUTE_HISTORY 表来实现这一点，该表记录每个属性的每个单独更改，并带有适当的时间戳和责任字段。

我的问题：是否有任何较新的存储模型（BigTable、HBase、CouchDB、RDF 存储等）优于 RDBMS？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T15:44:45.853

如何存储数据的问题取决于将如何使用它以及其他问题。我建议使用你现在理解的简单的东西，测试你是否知道你期望的可能负载。然后在将来根据需要进行改进。

关于您对基于触发器的审计系统的问题，因为听起来您已经准备好在数据库级别完成工作，所以我有一个建议。使用触发器记录对数据库中表的更改，然后在一夜之间（或无论多么频繁地）处理表的内容，并在存储它的任何位置创建审计跟踪，并清空数据库中的表内容。通过这种方式，您可以在数据库级别捕获更改，但仍然可以满足您将实际审计跟踪存储在其他位置的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T21:34:19.967

我看不出为什么触发器不能引用不同的数据库。但是，如果该数据库不可用，所有更改都将失败，如果审计数据库在另一台服务器上并且连接已关闭，这可能是一个问题。但是我们的审计是通过触发器进行的，我们有一个单独的审计数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T15:40:18.980

您还可以在应用程序代码中创建日志记录系统。记录对修改数据库并导致成功提交的每个函数的调用。

回答您的问题：不，只需使用 RDBMS。在日志上运行查询会更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T08:56:04.533

性能将是此类审计跟踪的一个问题。我会选择缓存（非常容错）并在计数达到某个阈值（例如 1000 条记录）时保留缓存内容。理想情况下，这将是批量更新。

我觉得具有持久性选项（如 H2 ）的内存数据库也应该这样做。但我自己没有用过。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T03:49:07.840

我不认为一个特定的数据库范式可以被认为优于任何其他的审计日志。这与其说是数据模型问题，不如说是日志记录问题，并且可以被认为与数据存储有些正交。

话虽如此，CouchDB 可以配置为从不删除旧版本的文档。通过为每个文档添加时间戳和可能的用户字段，您可以使用该功能自动保存曾经存储在数据库中的所有对象的完整历史记录。这可能是您可以在数据库中获得的最简单的审计日志设置。

至于其他人，我不知道他们可能对此有什么类型的支持。

注意事项：

（您还必须对数据库中的对象遵循永不删除策略，而只需将对象标记为已删除）

（对于 RDBMS，最简单的解决方案可能是一个简单的表，该表将数据库上运行的每个插入、更新或删除语句记录在带有时间戳和用户字段的文本字段中。我在 postgres 数据库上做过一次，它工作得很好保留历史）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-04T18:05:11.547

创建一个包含您要审计的表的名称的表（例如：AuditTable）；最小列应该是：TableName (varchar)、RandomValue (float)。在 AuditTable 上添加一个触发器，该触发器将在 RandomValue 更改时触发 - 此触发器的工作是为 AuditTable 中列出的每个表 (TableName) 动态删除重新创建审计触发器。审计触发器（针对每个表）应插入到 AuditRecord 表中，该表捕获：表名、主键 ID、操作类型（INSERT/UPDATE/DELETE）、原始字段值和更新的字段值。如果表结构发生变化，简单更新 AuditTable 中的 RandomValue 将导致重新生成触发器。您将需要编写为给定表自动生成触发器的代码；

# java - 使用 Validate 或 Revalidate 移除 Swing 组件

> ID：859493
> 
> 赞同：8
> 
> 时间：2009-05-13T18:11:02.143
> 
> 标签：java, swing

每当我从说 JPanel 中删除和添加摆动组件时，我应该执行调用验证还是重新验证？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T20:36:56.867

**revalidate()**会更好。revalidate() 将所有容器标记为不正确或无效。然后它在顶层调用 validate()。父级的 validate() 方法检查是否至少有一个直接子级发出无效或不正确的信号。它调用父级的验证。所以调用 revalidate()**自动意味着**调用 validate()。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T17:28:28.520

`revalidate()`基本上是 a`invalidate()`后跟 a `validate()`。

查看 Sun 的 Java 源代码。

你想打电话`revalidate()`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-28T15:27:32.723

至少在 Java 7 中，`revalidate()`不一定要从屏幕上“擦除”已删除的组件。我相信当边界框缩小时会发生这种情况。对于这些情况，请`repaint()`在`revalidate()`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-13T20:12:02.070

我认为 revalidate() 是你想要的。在调用 revalidate() 之后，将自动为您调用 validate() 方法。 [请参阅 JComponent.revalidate() 的 Java API](https://docs.oracle.com/javase/8/docs/api/javax/swing/JComponent.html#revalidate--)。

# java - 为什么 String.indexOf 不使用异常但在未找到子字符串时返回 -1？

> ID：859494
> 
> 赞同：15
> 
> 时间：2009-05-13T18:11:12.440
> 
> 标签：java, exception-handling

为什么 String.indexOf 不使用异常但在未找到子字符串时返回 -1？

这个问题的目的是：当我们开始自定义异常时。

我相信避免返回特殊错误代码是正确的设计路径。

你怎么看？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-13T18:23:27.880

根据经验，如果方法的目的是检查某事，那么缺少该某事不应该是例外。如果该方法假设某事是真实的，那么缺少该某事将是一个例外。因此“File.exists()”不会抛出 FileNotFoundException，但“File.open()”会。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-13T18:13:31.420

例外情况是例外情况，当字符串不包含字母时，这几乎不是例外，除非您将它用于某些极端情况。如果这就是你正在做的事情，你总是可以选择抛出你自己的异常。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-13T18:23:24.260

最后我听说是...

> “当您的方法无法实现其承诺时，您会抛出异常” - Jeff Richter CVC 第二版

*   IndexOf() 承诺您返回第一次出现的字符/字符串的索引。如果由于某种原因无法完成工作，它会抛出异常。它完成了它的工作，但没有找到字符串，因此返回 -1 以传达未找到的结果。
*   File.Open() 将为不存在的文件路径抛出 FileNotException，因为它无法做到它所承诺的......即打开指定的文件。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-13T18:44:49.920

返回 -1 几乎和抛出异常一样可怕。如果语言更好地支持它，正确的方法是使用选项类型。在有结果的正常情况下，您将结果包装在对象中并返回。否则，您将返回一个表示“非结果”情况的对象。

在呼叫站点中，您必须检查是哪一个；由于它们的超类型，您不能只使用返回值，它们必须通过模式匹配进行检查。

在伪语法中：

```
class Option[a] = Some[a] | None, 
```

其中 a 是泛型类型参数， Some 表示有值的结果， None 表示没有值的非结果。

在 indexOf 情况下，您将拥有：

```
Option[Integer] indexOf(char c) = {
   if(found) return Some(index)
   else return None
} 
```

你用这种方式：

```
result = "uncle".indexOf('c')
result match {
  Some(i) => System.out.println("index was: " + i);
  None => System.out.println("no value");
} 
```

如果您在匹配中省略了 Some 或 None （这是一种通用开关），编译器会给您一个警告。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-13T18:14:18.487

还因为异常在性能方面很昂贵

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-13T18:36:22.757

这里有很多很好的答案。这是一个实用主义优先于遵循“规则”的设计问题。在这种情况下，有一些相互矛盾的“规则”：

*   避免使用特殊值作为返回数据（不是自记录，需要开发人员以与其他代码不同的方式处理特殊值）

对比

*   不要在代码的例行执行过程中抛出异常，只有在发生意外情况时才抛出异常

我同意这个设计决定。但是，如果您不这样做，则始终可以编写自己的代码来检查字符串是否存在，然后再检查其索引。不要成为你语言的囚徒，让它听从你的意愿。语言是用来折磨的！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-13T18:13:33.637

处理检查 -1 比捕获异常要容易得多。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-13T18:24:10.873

除了一般反对异常的论点之外，我还要补充一点，-1 可以是 indexOf 和 lastIndexOf 的有用结果，而不仅仅是一个特殊值。例如，要从可能包含或不包含路径的字符串中解析文件名：

```
String filename = arg.substring(arg.lastIndexOf('/') + 1); 
```

虽然这可能是一个人为的例子，但如果有例外，这会有点麻烦。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-13T18:14:59.983

**我认为当发生意外**情况时必须抛出异常。也就是说，在 String 中找不到的子字符串并不是那么意外，可能会发生，这是一个合理的结果。

我同意你的观点，应该尽量避免返回错误代码，但在这种情况下，我们只有两个选择，找到字符串或找不到字符串。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-11-07T19:52:28.983

直到 Java 的作者`string.indexOf`告诉我们真实的历史......

假设我们必须从头开始设计它，这个问题有一些明显的设计约束：

1.  `indexOf`必须返回一个数值，以便找到匹配项时，您知道它在哪里
2.  有效索引保证始终为整数
3.  数组（和字符串）索引在 Java 中从零开始
4.  Java 是强类型的
5.  整数数字类型在 Java 中签名

鉴于这些基本约束，函数返回类型的一些可能选择将是整数（理想情况下是足够大以表示最大可能字符串中的最后一个索引的类型），或者... `Object`（并且可能返回 null 表示未找到）。但实际上返回`Object`既不高效也不友好，因为需要在使用找到的案例之前检查其有效性和强制转换 - 所以它不是一个真正可行的选择！

所以让我们用一个整数。如果找不到，我们要抛出异常吗？抛出异常有其自身的多个问题——创建异常对象和跳转到异常处理程序可能非常低效，并且围绕`indexOf`调用编写 try/catch 块也没有乐趣！

所以假设我们已经缩小了范围：它必须返回一个（有符号的）整数类型，并且*不*抛出异常。现在应该返回哪个整数值来表示未找到？

为了允许在尽可能大的字符串中进行搜索，我们应该保留所有正整数以用作成功找到的含义。相反，不需要负数来表示“找到”索引，因此所有负数都可能用作表示“未找到”的返回码。

如果我们可以选择任何负数来表示未找到，或者只是说“所有负返回值都意味着未找到”，那么它就可以完成这项工作......但它会是最好的设计吗？

使用 -1 而不是其他负数的一些原因是什么？我最喜欢的原因很简单，“-1 对每个人来说都很容易记住，你可以对其进行精确的相等性测试”。（而不是被迫使用不等式并考虑诸如是否要小于或小于或等于，以及要与什么值进行比较，零或负值等逐一问题）

我有时也很佩服 Chris 的理由，即（释义）“它与 ' 配合得很好`substring(foundIndex + 1)`”。

# javascript - jQuery：我有一个类，我正在迭代它。结果每回合都不一样。如何使用 this 并访问该值？

> ID：859496
> 
> 赞同：1
> 
> 时间：2009-05-13T18:11:33.000
> 
> 标签：javascript, jquery

我是初学者，这是我第一次遇到这样的问题。

我正在使用 jQuery 提供的 each 方法迭代一个类。该页面有许多具有相同名称的类。所以我们可以预期它可能是 15 次迭代。

每次迭代都有不同的值。

```
$(".book").each(function(n) {
    var result = $(this 
```

我必须得到最后一个带有值 List 的 TD。所以我的选择是使用

```
$(".book tbody tr:last") 
```

但我认为这个东西在每个环境中都不起作用，因为它不知道它当前正在处理哪个上下文。

$(this tbody tr:last) 也不起作用。我如何设计一个可以工作的选择器？

```
<div class = "book">
    <p class = "chapter">
        <table>
            <tbody>
                <tr>
                    <td>General</td>
                    <td>
                        <b>Buck</b>
                    </td>
                </tr>

                <tr>
                    <td>General</td>
                    <td>List</td>
                </tr>
            </tbody>
        </table>
    </p>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T18:20:47.867

假设您在其中发布的 HTML 是一本书，并且还有许多其他的书与它完全一样，并且您希望访问`<tr>`其中每一本书的最后一本书，这应该可行：

```
$('div.book tbody tr:last-child').each(function() {
    var value = $(this).find('td').eq(1).text();
}); 
```

`value`然后将是上面 HTML 的“列表”，如果你有几个`<div>`s，它会像你期望的那样迭代`<tr>`它们中的最后一个。

这里的关键是我们使用[`last-child`](http://docs.jquery.com/Selectors/lastChild)而不是简单地使用[`last`](http://docs.jquery.com/Selectors/last). `last`文档说它将匹配最后一个选择的元素；我们不希望这样。相反，我们想要的是`last-child`描述：匹配作为其父级最后一个子级的所有元素。这种区别在这种特殊情况下很重要，因为我们只想要我们当前所在的特定表的最后一个孩子，而不想要整体上的最后一个结果。

如果您想要`<td>`每个 last 中的最后一个`<tr>`，我们甚至可以这样做：

```
$('div.book tbody tr:last-child td:last-child').each(function() {
    var value = $(this).text();
}); 
```

此选择器将选择每个最后一个孩子`<tr>`并选择其适当的 last-child `<td>`。如果您不在乎第一个的价值是什么，这将是最好的`<td>`。如果你这样做，那么你想使用第一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T18:36:02.943

如果您只是循环遍历`tr:last`元素，那么[Paolo 的答案](https://stackoverflow.com/questions/859496/jquery-i-have-a-class-im-iterating-it-with-each-the-result-is-different-each/859541#859541)应该适合您。但是，如果您需要对每个 运行多个查询`div.book`，请尝试以下操作：

```
$("div.book").each(function() {
    $("tbody tr:last", this).doStuff();
    $("p.chapter", this).doOtherStuff();
} 
```

Dollar 函数的第二个参数是“上下文节点”，默认为`document`（即它“搜索”整个 DOM）。

# asp.net - 一页上有多个 ASP.NET 页面

> ID：859499
> 
> 赞同：2
> 
> 时间：2009-05-13T18:12:26.993
> 
> 标签：asp.net

我想使用 asp.net 在一个页面上显示多个页面。目的是这些页面显示它们的更新（我有一个更新页面的计时器控件），但我作为用户不应该能够与它们交互。当我单击其中一个页面时，它会将我带到该页面，然后我作为用户将能够与该页面进行交互。

这怎么可能？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T18:36:01.743

我相信您可以使用一对 iframe 来完成第一部分，这些 iframe 可以加载您想要的两个 ASP 页面。

对于第二部分，我知道有一个图像托管服务（不记得是哪一个）将一个清晰的像素图像放在您正在查看的图像之上。它在整个图像上拉伸，因此当您右键单击并保存时，您保存的是单个清晰像素，而不是您正在查看的图像。这是一种蹩脚的安全形式，可能在这里有应用。

除此之外，您可以让 iframe 指向没有任何交互性的 ASP 页面的“虚拟”版本，并在每个 iframe 上方提供一个链接，将您带到真实版本。也许您可以编写一个过滤器，从任何页面中删除所有交互以避免更新异常（也就是您更新真实页面，然后您必须更新虚拟页面）。

有了这个，我可以自信地说完。也许每个 ASP 页面 iframe 的另一个 iframe overtop（你能做到吗？）它是指向实际页面的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T17:54:42.380

谢谢您的帮助。我想出了答案：

.one { 宽度：100%; 高度：100%；缩放：55%；} .opacitycss1 { 过滤器：alpha(opacity=0); 位置：绝对；左：0px；顶部：0px；宽度：600px；高度：350px；背景颜色：黑色；} .opacitycss2 { 过滤器：alpha(opacity=0); 位置：绝对；左：610px；顶部：0px；宽度：600px；高度：350px；背景颜色：黑色；} .opacitycss3 { 过滤器：alpha(opacity=0); 位置：绝对；左：0px；顶部：360 像素；宽度：600px；高度：350px；背景颜色：黑色；} .opacitycss4 { 过滤器：alpha(opacity=0); 位置：绝对；左：610px；顶部：360 像素；宽度：600px；高度：350px；背景颜色：黑色；}

# c++ - 在 Ubuntu 中学习 OpenGL

> ID：859501
> 
> 赞同：48
> 
> 时间：2009-05-13T18:13:00.580
> 
> 标签：c++, linux, opengl, ubuntu

我正在尝试通过[Nehe 指南学习](http://nehe.gamedev.net/)[OpenGL](http://en.wikipedia.org/wiki/OpenGL)并提高我的 C++ 技能，但所有示例都适用于 Windows，而我目前使用的是 Linux。我真的不知道如何让事情在 Linux 下运行，并且网站上为 Linux 移植的代码中有更多没有解释的代码（到目前为止，我得到的唯一一个工作是[SDL](http://en.wikipedia.org/wiki/Simple_DirectMedia_Layer)示例： http: [//nehe.gamedev.net/data/lessons/linuxsdl/lesson01.tar.gz](http://nehe.gamedev.net/data/lessons/linuxsdl/lesson01.tar.gz)）。是否有任何其他资源更具体地针对 Linux 下的 OpenGL？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2010-01-01T14:08:42.057

首先要做的是安装 OpenGL 库。我建议：

```
自由过剩3
freeglut3-dev
libglew1.5
libglew1.5-dev
libglu1-台面
libglu1-台面开发
libgl1-台面-glx
libgl1-台面开发

```

安装它们后，在编译时链接到它们：

```
g++ -lglut -lGL -lGLU -lGLEW example.cpp -o example 
```

在 example.cpp 中，包括 OpenGL 库，如下所示：

```
#include <GL/glew.h>
#include <GL/glut.h>
#include <GL/gl.h>
#include <GL/glu.h>
#include <GL/glext.h> 
```

然后，要启用更高级的 opengl 选项（如着色器），请将其放在 glutCreateWindow 调用之后：

```
GLenum err = glewInit();
if (GLEW_OK != err)
{
    fprintf(stderr, "Error %s\n", glewGetErrorString(err));
    exit(1);
}
fprintf(stdout, "Status: Using GLEW %s\n", glewGetString(GLEW_VERSION));

if (GLEW_ARB_vertex_program)
    fprintf(stdout, "Status: ARB vertex programs available.\n");

if (glewGetExtension("GL_ARB_fragment_program"))
    fprintf(stdout, "Status: ARB fragment programs available.\n");

if (glewIsSupported("GL_VERSION_1_4  GL_ARB_point_sprite"))
    fprintf(stdout, "Status: ARB point sprites available.\n");
```

这应该启用所有 OpenGL 功能，如果没有，那么它应该告诉你问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-11-13T05:28:55.333

我猜最初最大的不同是编译过程。这是一个有用的**Makefile**，用于在 Ubuntu 上编译简单的 OpenGL 应用程序。

```
INCLUDE = -I/usr/X11R6/include/
LIBDIR  = -L/usr/X11R6/lib

FLAGS = -Wall
CC = g++                                  # change to gcc if using C
CFLAGS = $(FLAGS) $(INCLUDE)
LIBS =  -lglut -lGL -lGLU -lGLEW -lm

All: your_app                             # change your_app.

your_app: your_app.o
    $(CC) $(CFLAGS) -o $@ $(LIBDIR) $< $(LIBS) # The initial white space is a tab 
```

将此保存到名为*Makefile*的文件中，该文件应位于同一目录中。通过从终端编写*make 或*从 Vim 编写 :make 进行编译。

祝你好运

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-07T11:17:08.080

makefile 的一些更新，因为我从@Millthorn 找到了这个旧答案，但它没有用：你不需要定义包含路径，因为它在标准库中[https://stackoverflow.com/a/2459788/1059828](https://stackoverflow.com/a/2459788/1059828)

用于编译 open GL 的最小 makefile 可能如下所示：

```
LDFLAGS=-lglut -lGL -lGLU -lGLEW -lm
all: your_app 
```

[http://surflab.cise.ufl.edu/wiki/Getting_Started_with_OpenGL_in_Ubuntu](http://surflab.cise.ufl.edu/wiki/Getting_Started_with_OpenGL_in_Ubuntu)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T22:21:55.150

也许您想使用 Qt 来绘制窗口和小部件。

[这](http://www.digitalfanatics.org/projects/qt_tutorial/chapter14.html)是一个基于 Nehe 指南的教程，向您展示如何使用 Qt 创建 OpenGL 图像。

要学习 OpenGL，[Op​​enGL 红皮书](http://www.opengl.org/documentation/red_book/)是必读的。有一个在线版本。它有很好的解释和例子。

# visual-studio - VS 2008 标准值得吗？

> ID：859503
> 
> 赞同：0
> 
> 时间：2009-05-13T18:13:09.597
> 
> 标签：visual-studio

我的开发环境现在包括：

*   vc# express / v web dev express
*   单元
*   颠覆乌龟
*   用于 MySql 的 SqlYog
*   自定义自动复制/粘贴部署

我想使用：

*   TestDriven.NET（也查看了 pex，看起来很有趣）
*   VisualSVN 或 AnkhSVN
*   不确定VS是否会集成控制mysql。
*   部署项目

只是为了让自己的事情变得更快、更容易……但是为 VS 许可证支付 250 美元是否值得（注意：我的雇主正在为此买单，但尽量不要让这改变你的判断太多）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T18:53:21.107

Visual Studio 2008 Standard 拥有传统开发人员所需的一切。

我在工作中使用专业版，在家里使用标准版（我使用 Expression Studio 包购买的 - 非常划算）。除非你想要多进程的东西，否则 Std 就足够了。我有我的使用 Silverlight 工具，它与 Blend 和 VisualSVN（比 AnkhSVN 好得多）“对话”非常好。它适用于数据库服务器（但不调试 MS-SQL），我想你必须让这个元素工作的 MySQL 提供程序 - 如果你在 MySQL 上工作，我想你无论如何都需要它。网。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T19:29:27.320

由于您的雇主正在为此付费，我认为这是出于商业目的。因此，问题是您对他来说是 VS 2008 标准还是 250 美元更有价值？

假设您花费大量时间进行开发，答案几乎肯定是肯定的。如果你一年赚 50,000 美元，把一半的时间花在开发上，标准版的效率提高了 1%，那就是一年的收支平衡。（实际上比这更好；如果你每年赚 5 万美元，你的雇主会花费更多的 7 万到 10 万美元，具体取决于具体情况和会计。）

为您的员工购买好的工具几乎总是值得的，而且与其他行业的软件工具相比，软件开发工具通常非常便宜。

如果您在家里进行开发，这将是一个更困难和更主观的问题，但由于您正在编程为某人创造收入，这是一个美元问题，而美元压倒性地支持花钱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T18:28:08.777

请记住，您可以购买 VS 的“升级”版本并从 Express 版本（甚至 Eclipse）升级。所以你看到的标价是 199 美元，实际价格更像是 160 美元。

鉴于这是价格与功能的权衡，这可能很有用。

如果您想为自己或其他人赚钱，我个人的建议是不要乱用玩具免费赠品版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T18:39:39.677

这取决于您将创建的应用程序。Express 版不会让您将不同类型的不同项目组合在一个解决方案中。使用 Visual Studio Professional，您将能够使用 Web 应用程序中的另一个项目从 C# 类调试程序集。

如果您的项目只需要使用一种语言，那么 express 就可以了。

但我同意，如果你想赚钱，许可证是必经之路。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T18:54:44.957

是的。至少没有 VS Standard，您将无法使用所有使 Visual Studio 如此强大的酷插件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T18:56:40.540

Express 版本也不允许您创建 Windows 服务 - 我更改为专业版，现在我可以这样做了。您仍然可以快速完成，但是，您必须手动设置项目并了解更多关于您正在做什么的信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T19:10:26.663

我建议你等到 VS 2010 出来，因为有很多新的改进，比如上下文相关的帮助……完全改版了。坚持住！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T19:46:21.957

我建议走购买 VS 许可证的路线，然后出去从 jetbrains.com 获得重塑器

Reshaper 内置了单元测试、重构、代码完成、模板……

除此之外，您还可以使用 AnkhSVN，因为它是免费的，我个人认为 Visual SVN 不值 50 美元的成本。

# c++ - STL map 存储搜索到的键

> ID：859511
> 
> 赞同：3
> 
> 时间：2009-05-13T18:14:25.553
> 
> 标签：c++, stl

我刚刚发现，当我搜索如下地图时：

```
 std::map<std::string, int> aMap; 
```

我搜索的键开始成为地图的一部分。在上述情况下，这些值存储为零。如果是指针，它将值存储为 0 值指针

我正在使用 [] 运算符进行搜索，例如：

```
 int a = aMap["some key"]; 
```

你能证实这一点吗？我想我误解了 [] 运算符。是在做任务吗？！

我在哪里可以找到这类“特性”的 STL 文档？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T18:16:36.987

您是否使用 [] 运算符搜索它？如果是这样，那么是的，这是定义的行为。

如果你不想要这种行为，你应该使用 'find' 方法。

STL 的一个很好的参考是 Nicolai Josuttis 的书。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T18:18:27.920

如果您使用 [] 运算符查看地图，那么，是的，您将生成默认对象。另一方面，如果您使用“查找”，则不会。这是因为 [] 运算符必须返回对映射中对象的引用，因此它别无选择，只能在不存在时生成一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T18:39:22.613

这背后的原因是： [] 定义为

```
T& operator[](KEY k) 
```

引用永远不能为 NULL，因此必须返回一些值。STL 通过插入一个默认的初始化元素来解决这个问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T18:43:26.770

```
int a = aMap["some key"]; 
```

这里 map 检查键“some key”是否已经存在于 map 中：

*   如果是，则返回与“某个键”对应的值的引用。
*   如果映射中不存在“某些键”，则将键“某些键”插入映射中并使用默认值。将返回新插入值的引用。

测试一个键是否存在于 map 中（不添加键到 map）的正确方法是：

```
std::map<key,value>::iterator iter = myMap.find("Some Key");
if( iter != myMap.end())
{
 //key exists
}
else
{
 //no key
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T18:17:09.293

你怎么搜索？？？

```
if(!aMap[key]) // not found 
```

这是不正确的，一旦您通过 operator[] 访问地图，就会创建适当的位置并返回参考。

你需要使用

```
if(aMao.find(key)==aMap.end()) // not found 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T18:18:16.780

听起来您正在使用括号运算符，即

```
if (aMap["string"] == something) 
```

不要那样做。相反，使用 map::find。

如果键不存在，括号运算符将自动将键插入到映射中，使用值部分的默认值。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T18:19:01.617

如果通过搜索您的意思是使用运算符 []，如下所示：

```
if ( m["foo"] == 42 ) {
  // found
}
else {
  // not
} 
```

那么是的，如果它尚不存在，它将为“foo”创建一个条目。因此，您通常应避免将 operator[] 用于映射，而应使用命名函数 sfind() 和 insert()。

至于在哪里可以找到有关此行为的信息，关于标准库的最佳书籍是[Nicolai Josuttis 的 The C++ Standard Library](http://www.josuttis.com/libbook/)。

# ruby-on-rails - 您是否使用 Heroku 编写 Ruby on Rails 应用程序？

> ID：859516
> 
> 赞同：1
> 
> 时间：2009-05-13T18:15:45.210
> 
> 标签：ruby-on-rails, hosting, heroku

您是否使用 Heroku 编写 Ruby on Rails 应用程序？我从 O'Reilly 的Learning Rails 一书中读到，然后今天发现[http://heroku.com/myapps](http://heroku.com/myapps)页面上没有“创建应用程序”，这样我就可以再在线编辑代码了。他们只允许付费用户这样做吗？如果您是非付费客户，他们似乎也只允许您一次有一个 Web 请求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T18:36:10.277

Heroku 已转向付费平台（没有基于 Web 的编辑器）。我猜你使用 heroku gem 通过终端控制它。

但是，所有旧的 heroku 功能都可以在[http://herokugarden.com上使用](http://herokugarden.com)

如果您在 herokugarden 之前有一个 heroku 帐户，那么您的所有应用程序都应该已经迁移到那里。您应该可以使用旧 ID 登录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-21T23:13:02.267

Heroku 有两个产品。
Heroku Garden - [http://herokugarden.com](http://herokugarden.com) - 是第一个产品。它包括一个在线 IDE，以及部署您的应用程序的能力。

一月份，Heroku 推出了一个名为“Heroku”的新平台。它放弃了 IDE，并作为交换提供了显着的稳定性和性能增强。

Heroku 提供免费产品。随着您的应用程序扩展或需要额外资源，您可以购买所需的资源。免费版本实际上可以让你走得更远——一个单独的测功机正在运行我的个人网站（[http://zednine.com](http://zednine.com)），没有任何问题。

--我是heroku的员工

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T16:14:47.950

如果您只是在开发模式下运行，则没有特别的区别。这两个站点仍由同一家公司运营。Heroku 是他们的商业产品，提供付费托管计划等。如果您愿意，Herokugarden 是人们在升级到付费计划之前玩 Rails 并学习框架的游乐场。

# c++ - OSX 相当于 ShellExecute？

> ID：859517
> 
> 赞同：10
> 
> 时间：2009-05-13T18:15:52.603
> 
> 标签：c++, macos, shellexecute

我有一个要从 Win32 移植到 OSX 的 C++ 应用程序。我希望能够像用户打开它们一样启动任意文件。这在使用 ShellExecute 的 Windows 上很容易。我如何在 Mac 上完成同样的事情？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-13T18:18:04.957

您可以调用`system();`任何 C++ 应用程序。在 OSX 上，您可以使用[open](http://developer.apple.com/documentation/Darwin/Reference/Manpages/man1/open.1.html)命令来启动事物，就好像它们被单击一样。

从打开的文档中：

> open 命令打开一个文件（或目录或 URL），就像您双击文件的图标一样。如果未指定应用程序名称，则使用通过 LaunchServices 确定的默认应用程序来打开指定的文件。

总之，它看起来像：

```
string command = "open " + filePath;
system(command.c_str()); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-13T18:32:30.300

如果你正在使用可可，另一个建议是：

```
[[NSWorkspace sharedWorkspace] openFile:@"pathToFile"]; 
```

中还有其他类似的方法`NSWorkspace`。例如打开应用程序或 URL：

```
[[NSWorkspace sharedWorkspace] launchApplication:@"pathToApplication"];
[[NSWorkspace sharedWorkspace] openURL:[NSURL URLWithString:@"URL"]]; 
```

与标准 C调用相比，通过工作`[NSWorkspace sharedWorkspace]`可以为您提供更多控制。`system()`

*编辑：*请注意，您可以使用[Objective-C++](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/ObjectiveC/Articles/ocCPlusPlus.html "如何混合使用 Objective-C 和 C++")将 C++ 代码与 Objective-C 代码混合，从而调用可可方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-18T18:27:49.593

您可以简单地使用 system(); 功能。例如，假设您想将扩展坞放在屏幕的一角。

你可以简单地说：

```
system(defaults write com.apple.dock pinning -string end);
sleep(1f);
system(killall Dock); 
```

就这么容易。希望我有所帮助:)

# .net - 在 .NET 中设计松散耦合的组件 - 提供者模式

> ID：859523
> 
> 赞同：8
> 
> 时间：2009-05-13T18:17:06.563
> 
> 标签：.net, design-patterns

有人告诉我，[提供者模式](http://en.wikipedia.org/wiki/Provider_model)是一种设计松散耦合组件的方法。我正在设计一个 API。您能否指出解释提供者模式的链接。我在[这里](http://weblogs.asp.net/adilakhter/archive/2008/11/02/ProviderDesignPattern.aspx)找到了一个，还有没有更多描述使用.net作为框架的提供者模式

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-13T18:49:03.250

在 Juval Lowy 的 WCF 书中，他称这种模式为[Bridge 模式](http://en.wikipedia.org/wiki/Bridge_pattern)。[dofactory](http://www.dofactory.com/Patterns/PatternBridge.aspx)也有一些好东西。

我最近一直在为我正在学习的 MS 考试 (70-568) 收集有关提供者模式的一些链接。这是列表 - 比您需要了解的提供者模型更多：

*   [提供者模型设计模式和规范，第 1 部分](http://msdn.microsoft.com/en-us/library/ms972319.aspx)（旧但详细）。
*   [ASP.NET 2.0 提供者模型](http://download.microsoft.com/download/2/a/e/2aeabd28-3171-4b95-9363-22150625a6a5/ASP.NET%20Provider%20Model.pdf)。136 页——提供者模型信息的坟墓。
*   [ProviderBase](http://msdn.microsoft.com/en-us/library/system.configuration.provider.providerbase.aspx) - 所有提供者实现的基类。
*   [添加提供者时不要忘记添加`<clear/>`。](http://weblogs.asp.net/scottgu/archive/2006/11/20/common-gotcha-don-t-forget-to-clear-when-adding-providers.aspx)
*   [配置提供者](http://www.developer.com/net/asp/article.php/3569166)。
*   [在基于 Windows 的应用程序中使用 ASP.NET 提供程序功能](http://msdn.microsoft.com/en-us/library/bb384297.aspx)。
*   [实施会员提供者](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx)。
*   [实现角色提供者](http://msdn.microsoft.com/en-us/library/8fw7xh74.aspx)。
*   [创建自定义站点地图提供程序](http://aspnet.4guysfromrolla.com/articles/020106-1.aspx)。
*   [实现配置文件提供程序](http://msdn.microsoft.com/en-us/library/0580x1f5.aspx)。
*   [创建自定义数据库配置文件提供程序](http://www.theserverside.net/tt/articles/content/CreatingProfileProvider/CreatingProfileProvider.html)。
*   [会话状态提供者](http://msdn.microsoft.com/en-us/library/aa478952.aspx)。
*   [实现 Session-State Store Provider](http://msdn.microsoft.com/en-us/library/ms178587.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T18:20:35.433

[这是来自MSDN](http://msdn.microsoft.com/en-us/library/ms972319.aspx)的白皮书（链接到第 1 部分）

这是来自 C-Sharp Corner[的 ASP.NET 2.0](http://www.c-sharpcorner.com/UploadFile/webmaster3/ProviderPattern12242007184126PM/ProviderPattern.aspx)中提供程序设计模式的另一个来源

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T18:57:45.593

实现松散耦合的最优雅的解决方案是 DI 和 IoC。

看看这里：

*   [设计模式 IoC 和 DI](http://www.codeproject.com/KB/aspnet/IOCandDI.aspx)
*   [控制反转和依赖注入：使用 Windsor 容器](http://msdn.microsoft.com/en-us/library/aa973811.aspx)

玩得开心 ：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T18:26:24.893

MSDN 提供了[ASP.NET 提供程序模式的演练](http://msdn.microsoft.com/en-us/library/ms972319.aspx)

# flash - Flash ProgressEvent 未显示总大小

> ID：859526
> 
> 赞同：4
> 
> 时间：2009-05-13T18:17:14.410
> 
> 标签：flash, actionscript-3, file, size, progress

我在 Flash 中使用 ProgressEvent 来确定下载内容需要多长时间。我有这个：

```
 progress = event.target.bytesLoaded/event.target.bytesTotal; 
```

设置百分比。

在摸了摸头之后，我对这两个值进行了跟踪——结果发现“event.target.bytesTotal”总是等于零。

我在 Flex/AS3/Flash API 中找不到任何提及。关于如何让 bytesTotal 工作的任何提示？

（我目前正在从网络服务器上的 PHP 文件中读取）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-07T09:37:43.797

我们通过禁用某些文件类型的压缩在我们的服务器上解决了这个问题。

对于正在压缩的文件，bytesTotal 为 0。这种压缩是即时发生的，这就是服务器无法提供文件大小的原因（因为它还不知道）。删除压缩解决了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T18:25:25.503

你有没有尝试过：

```
 progress = event.bytesLoaded/event.bytesTotal; 
```

bytesTotal / bytesLoaded 应该是进度事件的属性。

另外......我昨天遇到了这个问题，直到我想检查我正在加载的文件，它最终被损坏和 0 字节 - 所以仔细检查一下：）

# ms-access - 用于 MS Access 查询的 Application.LoadFromText 的替代方案

> ID：859530
> 
> 赞同：2
> 
> 时间：2009-05-13T18:18:15.377
> 
> 标签：ms-access, vba, vbscript

我正在尝试使用 VBScript 从文本文件中加载查询到 MS Access 查询集合中。我正在使用这样的东西：代码来自[Here](https://stackoverflow.com/questions/187506/how-do-you-use-version-control-with-access-development)。

```
 for each myFile in folder.Files
    objecttype = fso.GetExtensionName(myFile.Name)
    objectname = fso.GetBaseName(myFile.Name)
    WScript.Echo "  " & objectname & " (" & objecttype & ")"

    if (objecttype = "form") then
        oApplication.LoadFromText acForm, objectname, myFile.Path
    elseif (objecttype = "bas") then
        oApplication.LoadFromText acModule, objectname, myFile.Path
    elseif (objecttype = "mac") then
        oApplication.LoadFromText acMacro, objectname, myFile.Path
    elseif (objecttype = "report") then
        oApplication.LoadFromText acReport, objectname, myFile.Path
    elseif (objecttype = "sql") then
        'oApplication.LoadFromText acQuery, objectname, myFile.Path
        ' Add create querydef code here
    end if

 next 
```

但我不确定如何使用 VBScript 创建查询定义。

有任何想法吗？

注意：我最初使用以下内容导出到文件：

```
For Each myObj In oApplication.CurrentDb.QueryDefs 
   Set f = fso.CreateTextFile(sExportpath & "\" & myObj.Name & ".sql", True) 
   f.WriteLine(myObj.SQL) 
   f.Close 
Next 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T19:14:50.510

这保存了查询定义

```
For i = 0 To db.QueryDefs.Count - 1
    Application.SaveAsText acQuery, db.QueryDefs(i).Name, sExportpath & "\" & db.QueryDefs(i).Name & ".sql"
Next i 
```

然后 LoadFromText 应该工作

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T20:19:07.923

为了完整起见，我想添加我的解决方案。

```
if (objecttype = "form") then
    oApplication.LoadFromText acForm, objectname, myFile.Path
elseif (objecttype = "bas") then
    oApplication.LoadFromText acModule, objectname, myFile.Path
elseif (objecttype = "mac") then
    oApplication.LoadFromText acMacro, objectname, myFile.Path
elseif (objecttype = "report") then
    oApplication.LoadFromText acReport, objectname, myFile.Path
elseif (objecttype = "sql") then
    oApplication.LoadFromText acQuery, objectname, myFile.Path
end if 
```

显然，所有需要添加的是：

```
 Const acQuery = 1 
```

感谢 DJ

# c++ - 如何将大端结构转换为小端结构？

> ID：859535
> 
> 赞同：19
> 
> 时间：2009-05-13T18:19:47.043
> 
> 标签：c++, struct, endianness

我有一个在 Unix 机器上创建的二进制文件。只是一堆又一张的记录而已。记录定义如下：

```
struct RECORD {
  UINT32 foo;
  UINT32 bar;
  CHAR fooword[11];
  CHAR barword[11];
  UNIT16 baz;
} 
```

我试图弄清楚如何在 Windows 机器上读取和解释这些数据。我有这样的事情：

```
fstream f;
f.open("file.bin", ios::in | ios::binary);

RECORD r;

f.read((char*)&detail, sizeof(RECORD));

cout << "fooword = " << r.fooword << endl; 
```

我得到了一堆数据，但这不是我期望的数据。我怀疑我的问题与机器的字节序差异有关，所以我来问这个问题。

我知道多个字节将存储在 windows 上的 little-endian 和 unix 环境中的 big-endian 中，我明白了。对于两个字节，Windows 上的 0x1234 将是 unix 系统上的 0x3412。

字节序会影响整个结构的字节顺序，还是影响结构中每个单独成员的字节顺序？我将采取什么方法将在 unix 系统上创建的结构转换为在 Windows 系统上具有相同数据的结构？任何比几个字节的字节顺序更深入的链接也会很棒！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-13T18:27:52.693

除了字节序，您还需要注意两个平台之间的填充差异。特别是如果您有奇数长度的 char 数组和 16 位值，您可能会发现某些元素之间的填充字节数不同。

编辑：如果结构是在没有包装的情况下写出来的，那么它应该相当简单。像这样（未经测试）的代码应该可以完成这项工作：

```
// Functions to swap the endian of 16 and 32 bit values

inline void SwapEndian(UINT16 &val)
{
    val = (val<<8) | (val>>8);
}

inline void SwapEndian(UINT32 &val)
{
    val = (val<<24) | ((val<<8) & 0x00ff0000) |
          ((val>>8) & 0x0000ff00) | (val>>24);
} 
```

然后，一旦你加载了结构，只需交换每个元素：

```
SwapEndian(r.foo);
SwapEndian(r.bar);
SwapEndian(r.baz); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-13T18:22:20.457

实际上，字节顺序是底层硬件的属性，而不是操作系统的属性。

最好的解决方案是在写入数据时转换为标准——谷歌的“网络字节顺序”，你应该找到这样做的方法。

编辑：这是链接：[http ://www.gnu.org/software/hello/manual/libc/Byte-Order.html](http://www.gnu.org/software/hello/manual/libc/Byte-Order.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-29T13:38:11.763

不要直接从文件中读入结构！打包可能会有所不同，您必须摆弄 pragma pack 或类似的编译器特定结构。太不靠谱了。许多程序员侥幸逃脱，因为他们的代码没有在大量架构和系统中编译，但这并不意味着可以这样做！

一个很好的替代方法是将标头读取到缓冲区中并从三个中解析，以避免原子操作中的 I/O 开销，例如读取无符号 32 位整数！

```
char buffer[32];
char* temp = buffer;  

f.read(buffer, 32);  

RECORD rec;
rec.foo = parse_uint32(temp); temp += 4;
rec.bar = parse_uint32(temp); temp += 4;
memcpy(&rec.fooword, temp, 11); temp += 11;
memcpy(%red.barword, temp, 11); temp += 11;
rec.baz = parse_uint16(temp); temp += 2; 
```

parse_uint32 的声明如下所示：

```
uint32 parse_uint32(char* buffer)
{
  uint32 x;
  // ...
  return x;
} 
```

这是一个非常简单的抽象，实际上更新指针也不需要任何额外费用：

```
uint32 parse_uint32(char*& buffer)
{
  uint32 x;
  // ...
  buffer += 4;
  return x;
} 
```

后一种形式允许使用更简洁的代码来解析缓冲区；当您从输入中解析时，指针会自动更新。

同样，memcpy 可以有一个助手，例如：

```
void parse_copy(void* dest, char*& buffer, size_t size)
{
  memcpy(dest, buffer, size);
  buffer += size;
} 
```

这种安排的美妙之处在于你可以有命名空间“little_endian”和“big_endian”，然后你可以在你的代码中这样做：

```
using little_endian;
// do your parsing for little_endian input stream here.. 
```

很容易为相同的代码切换字节顺序，但是，很少需要的功能.. 文件格式通常具有固定的字节顺序。

不要使用虚拟方法将其抽象到类中；只会增加开销，但如果愿意，请随意：

```
little_endian_reader reader(data, size);
uint32 x = reader.read_uint32();
uint32 y = reader.read_uint32(); 
```

阅读器对象显然只是指针周围的薄包装。size 参数将用于错误检查（如果有）。对于接口本身来说并不是强制性的。

注意这里的字节序选择是如何在编译时完成的（因为我们创建了 little_endian_reader 对象），所以我们调用虚方法开销没有特别好的理由，所以我不会采用这种方法。;-)

在这个阶段，没有真正的理由保持“文件格式结构”保持原样，您可以根据自己的喜好组织数据，而不必将其读入任何特定的结构；毕竟，这只是数据。当您读取图像之类的文件时，您实际上并不需要标题。您应该拥有对所有文件类型都相同的图像容器，因此读取特定格式的代码应该只读取文件，解释并重新格式化数据并存储有效载荷。=)

我的意思是，这看起来很复杂吗？

```
uint32 xsize = buffer.read<uint32>();
uint32 ysize = buffer.read<uint32>();
float aspect = buffer.read<float>(); 
```

代码看起来不错，而且开销非常低！如果编译代码的文件和体系结构的字节序相同，则内部循环可能如下所示：

```
uint32 value = *reinterpret_cast<uint32*>)(ptr); ptr += 4;
return value; 
```

这在某些架构上可能是非法的，因此优化可能是一个坏主意，并使用更慢但更健壮的方法：

```
uint32 value = ptr[0] | (static_cast<uint32>(ptr[1]) << 8) | ...; ptr += 4;
return value; 
```

在可以编译为 bswap 或 mov 的 x86 上，如果方法是内联的，则开销相当低；编译器会将“移动”节点插入中间代码，仅此而已，这是相当有效的。如果对齐是一个问题，则可能会生成完整的读取移位或序列，但仍然不会太破旧。如果测试地址 LSB 并查看是否可以使用快速或慢速版本的解析，比较分支可以允许优化。但这意味着每次读取都会受到测试的惩罚。可能不值得努力。

哦，对了，我们正在阅读 HEADERS 之类的东西，我认为这不是太多应用程序的瓶颈。如果某些编解码器正在执行一些非常紧密的内部循环，那么再次读取临时缓冲区并从那里解码是明智的。相同的原理.. 在处理大量数据时，没有人从文件中读取一个字节。好吧，实际上，我经常看到这种代码，通常对“你为什么这样做”的回答是文件系统会阻塞读取，并且字节无论如何都来自内存，没错，但它们经过了一个很深的调用堆栈这是获取几个字节的高开销！

尽管如此，编写一次解析器代码并使用无数次 -> 史诗般的胜利。

从文件中直接读取结构：不要这样做！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-13T18:21:53.420

它独立影响每个成员，而不是整体`struct`。此外，它不会影响数组之类的东西。例如，它只是使`int`s 中的字节以相反的顺序存储。

PS。也就是说，可能有一台机器具有奇怪的字节序。我刚才所说的适用于大多数使用的机器（x86、ARM、PowerPC、SPARC）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T18:27:45.843

您必须单独更正超过一个字节的每个成员的字节序。字符串不需要转换（fooword 和 barword），因为它们可以被视为字节序列。

但是，您必须注意另一个问题：结构中成员的对齐。基本上，您必须检查 unix 和 windows 代码上的 sizeof(RECORD) 是否相同。编译器通常提供编译指示来定义您想要的对齐方式（例如，#pragma pack）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T18:31:42.267

您还必须考虑两个编译器之间的对齐差异。每个编译器都可以在最适合架构的结构中的成员之间插入填充。所以你真的需要知道：

*   UNIX prog 如何写入文件
*   如果它是对象的二进制副本，则结构的确切布局。
*   如果它是二进制副本，源架构的字节序是什么。

这就是为什么大多数程序（我见过的（需要与平台无关的））将数据序列化为标准 iostream 可以轻松读取的文本流的原因。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T19:02:01.607

我喜欢为需要交换的每种数据类型实现一个 SwapBytes 方法，如下所示：

```
inline u_int ByteSwap(u_int in)
{
    u_int out;
    char *indata = (char *)&in;
    char *outdata = (char *)&out;
    outdata[0] = indata[3] ;
    outdata[3] = indata[0] ;

    outdata[1] = indata[2] ;
    outdata[2] = indata[1] ;
    return out;
}

inline u_short ByteSwap(u_short in)
{
    u_short out;
    char *indata = (char *)&in;
    char *outdata = (char *)&out;
    outdata[0] = indata[1] ;
    outdata[1] = indata[0] ;
    return out;
} 
```

然后我在需要交换的结构中添加一个函数，如下所示：

```
struct RECORD {
  UINT32 foo;
  UINT32 bar;
  CHAR fooword[11];
  CHAR barword[11];
  UNIT16 baz;
  void SwapBytes()
  {
    foo = ByteSwap(foo);
    bar = ByteSwap(bar);
    baz = ByteSwap(baz);
  }
} 
```

然后，您可以修改读取（或写入）结构的代码，如下所示：

```
fstream f;
f.open("file.bin", ios::in | ios::binary);

RECORD r;

f.read((char*)&detail, sizeof(RECORD));
r.SwapBytes();

cout << "fooword = " << r.fooword << endl; 
```

要支持不同的平台，您只需要对每个 ByteSwap 重载都有一个特定于平台的实现。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T18:35:07.267

像这样的东西应该工作：

```
#include <algorithm>

struct RECORD {
    UINT32 foo;
    UINT32 bar;
    CHAR fooword[11];
    CHAR barword[11];
    UINT16 baz;
}

void ReverseBytes( void *start, int size )
{
    char *beg = start;
    char *end = beg + size;

    std::reverse( beg, end );
}

int main() {
    fstream f;
    f.open( "file.bin", ios::in | ios::binary );

    // for each entry {
    RECORD r;
    f.read( (char *)&r, sizeof( RECORD ) );
    ReverseBytes( r.foo, sizeof( UINT32 ) );
    ReverseBytes( r.bar, sizeof( UINT32 ) );
    ReverseBytes( r.baz, sizeof( UINT16 )
    // }

    return 0;
} 
```

# algorithm - 排序列表差异

> ID：859536
> 
> 赞同：8
> 
> 时间：2009-05-13T18:19:52.270
> 
> 标签：algorithm, language-agnostic, comparison

我有以下问题。

我有一组元素，可以通过某种算法 A 进行排序。排序很好，但是很贵。

还有一种算法 B 可以逼近 A​​ 的结果，速度快很多，但是排序不会完全一样。

将 A 的输出作为“黄金标准”，我需要对在相同数据上使用 B 所导致的误差进行有意义的估计。

任何人都可以建议我可以查看的任何资源来解决我的问题吗？提前致谢！

编辑 ：

根据要求：添加一个示例来说明案例：如果数据是字母表的前 10 个字母，

A 输出：a,b,c,d,e,f,g,h,i,j

B 输出：a,b,d,c,e,g,h,f,j,i

产生错误的可能措施是什么，这将允许我调整算法 B 的内部参数以使结果更接近 A 的输出？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T19:24:49.637

## 斯皮尔曼的 rho

我认为您想要的是[Spearman 的等级相关系数](http://en.wikipedia.org/wiki/Spearman's_rank_correlation_coefficient)。使用两个排序（完美`A`和近似`B`）的索引 [rank] 向量，您可以计算`rho`从 -1（完全不同）到 1（完全相同）的等级相关性：

![斯皮尔曼的 rho](https://upload.wikimedia.org/math/5/a/a/5aa69d11142e11a759432e16f7d21970.png)

其中 d(i) 是 A 和 B 之间每个字符的等级差异

您可以将您的误差度量定义为距离`D := (1-rho)/2`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T18:46:00.090

我会确定最大的正确排序的子集。

```
 +-------------> I
                               |   +--------->
                               |   |
A -> B -> D ----->  E  -> G -> H --|--> J
     |             ^ |             |    ^
     |             | |             |    |
     +------> C ---+ +-----------> F ---+ 
```

在您的示例中，10 分中有 7 分，因此算法得分 0.7。其他集合的长度为 6。正确排序得分 1.0，反向排序得分 1/n。

我认为这与反转的数量有关。x + y 表示 x <= y（正确顺序），x - y 表示 x > y（错误顺序）。

A + B + D - C + E + G + H - F + J - 我

我们得到了几乎相同的结果——9 个中有 6 个是正确的，得分为 0.667。再次正确排序分数 1.0 和反向排序分数 0.0，这可能更容易计算。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T18:24:06.693

您是否正在寻找一些算法来计算基于以 A 排序的数组和以 B 排序的数组作为输入的差异？或者您是否正在寻找一种通用方法来确定使用 B 排序时数组的平均偏差？

如果是第一个，那么我建议一些简单的东西，比如每个项目与它应该在的位置的距离（平均值比总和更好，以删除数组长度作为一个问题）

如果是第二个，那么我想我需要更多地了解这些算法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T18:40:41.940

计算[**RMS 误差**](http://en.wikipedia.org/wiki/Root_mean_square)可能是许多可能的方法之一。这是小的python代码。

```
def calc_error(out_A,out_B):
        # in    <= input
        # out_A <= output of algorithm A
        # out_B <= output of algorithm B

        rms_error = 0

        for i in range(len(out_A)):
            # Take square of differences and add
            rms_error +=  (out_A[i]-out_B[i])**2 

        return rms_error**0.5   # Take square root

>>> calc_error([1,2,3,4,5,6],[1,2,3,4,5,6])
0.0
>>> calc_error([1,2,3,4,5,6],[1,2,4,3,5,6]) # 4,3 swapped
1.414
>>> calc_error([1,2,3,4,5,6],[1,2,4,6,3,5]) # 3,4,5,6 randomized
2.44 
```

注意：取平方根不是必需的，但取平方是因为差值之和可能为零。我认为 calc_error 函数给出了错误放置对的近似数量，但我没有任何方便的编程工具，所以:(。

看看**[这个问题。](https://stackoverflow.com/questions/378204/how-can-you-compare-to-what-extent-two-lists-are-in-the-same-order)**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T19:29:30.893

很难给出一个好的通用答案，因为适合您的解决方案将取决于您的应用程序。

我最喜欢的选项之一就是有序元素对的数量除以对的总数。这是一个很好、简单、易于计算的指标，它只是告诉你有多少错误。但它没有尝试量化这些错误的严重程度。

```
double sortQuality = 1;
if (array.length > 1) {
   int inOrderPairCount = 0;
   for (int i = 1; i < array.length; i++) {
      if (array[i] >= array[i - 1]) ++inOrderPairCount;
   }
   sortQuality = (double) inOrderPairCount / (array.length - 1);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T18:21:22.190

你可以尝试一些涉及[汉明距离的东西](http://en.wikipedia.org/wiki/Hamming_distance)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-11T16:17:57.737

如果有人使用 R 语言，我已经实现了一个函数，该函数使用@bubake 上面描述的方法计算“spearman 秩相关系数”：

```
get_spearman_coef <- function(objectA, objectB) {
  #getting the spearman rho rank test 
  spearman_data <- data.frame(listA = objectA, listB = objectB)
  spearman_data$rankA <- 1:nrow(spearman_data) 
  rankB <- c()

  for (index_valueA in 1:nrow(spearman_data)) {
    for (index_valueB in 1:nrow(spearman_data)) {

      if (spearman_data$listA[index_valueA] == spearman_data$listB[index_valueB]) {
        rankB <- append(rankB, index_valueB)
      }

    }
  }
  spearman_data$rankB <- rankB
  spearman_data$distance <-(spearman_data$rankA - spearman_data$rankB)**2

  spearman <- 1 - ( (6 * sum(spearman_data$distance)) / (nrow(spearman_data) * ( nrow(spearman_data)**2 -1) ) )
  print(paste("spearman's rank correlation coefficient"))
  return( spearman)  
} 
```

结果 ：

> get_spearman_coef(c("a","b","c","d","e"), c("a","b","c","d","e"))
> 
> > 斯皮尔曼等级相关系数：1

> get_spearman_coef(c("a","b","c","d","e"), c("b","a","d","c","e"))
> 
> > 斯皮尔曼等级相关系数：0.9

# regex - 正则表达式分组问题

> ID：859537
> 
> 赞同：0
> 
> 时间：2009-05-13T18:20:05.000
> 
> 标签：regex

我有一些这种格式的文本数据：

```
MI
00
3

MD
1
0.0000
MD
2
0.0000
MD
3
0.0000 
```

此块可以重复，并且 MD 的数量是可变的（但始终 >= 1），并且需要为每个获取以下数值。

我有一个匹配每个 MI 的每个 MD 的正则表达式，但它只会捕获最后一个 MD。是否可以在事先不知道有多少的情况下捕获每个 MD？

**编辑**：根据请求...正则表达式如下；我的问题的重要部分仍然是“我可以捕获每个 MD 集吗？”

```
MI\r\d\d\r(\d)\r[\s\w]{6}\r(MD\r[\s\d]{2}\r[\s\d\.\-]*\r)+ 
```

我选择的语言是 C#，但我会用任何语言回答，因为它至少会给我一个开始。

MD 是 90 年代初硫检测器的数据点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T19:33:45.753

每个 Match 都有一个 Groups 集合。在您的情况下 Matches[0].Groups[1] 将匹配 MD 记录，例如“MD\n1\n0.0000MD\n2\n0.0000MD\n3\n0.0000”。

每个 Group 都有一个[Captures 集合](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.group.captures.aspx)，您可以对其进行迭代以查找所有 MD 实例。这将为每个 MD 提供一个字符串，因此 Matches[0].Groups[1].Captures[0] 将为“MD\n1\n0.0000”。

编辑：虽然您已经接受了答案，但这是一种一次性解析所有内容的方法：

```
string pat = @"MI[\r\n]*(?<MI1>\d\d)[\r\n]*(?<MI2>\d+)[\r\n]*" +
    @"(MD[\r\n]*(?<MD1>\d+)*[\r\n]*(?<MD2>[\d\.\-]+)+[\r\n]*)*";

var r = new Regex(pat);
foreach (Match match in r.Matches(text))
{
    Console.WriteLine("MI v1:{0} v2:{1}", 
         match.Groups["MI1"], match.Groups["MI2"]);

    if (match.Groups.Count > 2)
        for (var i = 0; i < match.Groups["MD1"].Captures.Count; i++)
            Console.WriteLine("  MD v1:{0} v2:{1}", 
                match.Groups["MD1"].Captures[i], 
                match.Groups["MD2"].Captures[i]);
} 
```

这是我使用的测试文本：

```
MI
00
3

MD
1
0.1000
MD
2
0.2000
MD
3
0.3000

MI
12
5

MI
24
5

MD
1
0.1000 
```

输出是：

```
MI v1:00 v2:3
  MD v1:1 v2:0.1000
  MD v1:2 v2:0.2000
  MD v1:3 v2:0.3000
MI v1:12 v2:5
MI v1:24 v2:5
  MD v1:1 v2:0.1000 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T18:33:02.513

这是可能的，但需要不止一次传递数据。一个正则表达式组每次匹配只能保存一大块信息。所以，你可以有一个 MD 组并找到你所有的 MD 匹配或一个包含 MD 组的 MI 组，它会找到你所有的 MI 匹配......但 MD 组不会被分离出来。

一种解决方案是嵌套的正则表达式调用，第一个查找每个 MI 组，第二个查找 MI 组中的每个 MD 组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T18:39:51.097

我认为这会做到。至少它适用于使用 Perl 的 RegexBuddy。

```
MD[^MI]* 
```

数据只是从上面重复。

编辑：这似乎在自己的小块中捕获了所有 MD 和初始 MI。

```
MI([^MI]*(MD[^MI]*)*) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T18:51:45.773

我不是 C# 方面的专家，但在 Java 中，您可能希望将 (MD...)+ 更改为 ((MD...)+)。这样，您可以使用外圆括号来捕获所有 MD。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T19:06:39.277

我建议您为此任务实现一个[状态机..](http://en.wikipedia.org/wiki/State_machine)

但这是一个我认为也可以工作的正则表达式：

```
MI\r\d\d\r(\d)\r\r(MD\r\d\r[0-9\.]+\r?)* 
```

# postgresql - 有没有办法知道 PL/PgSQL 中调用函数的名称？

> ID：859539
> 
> 赞同：0
> 
> 时间：2009-05-13T18:20:25.437
> 
> 标签：postgresql, plpgsql

当我从另一个此类函数调用 PL/PgSQL 函数（不是触发器）时，是否可以知道调用函数的名称或某种 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T20:37:53.993

这与您将得到的一样接近，并且在嵌套调用中不起作用。

```
SELECT current_query(); 
```

您可能想通过电子邮件向 pgsql-hackers@postgresql.org 发送功能请求，包括您想要了解此信息的用例。

# java - 在Java中递归反转字符串的最佳方法是什么？

> ID：859562
> 
> 赞同：24
> 
> 时间：2009-05-13T18:23:50.890
> 
> 标签：java, recursion, string

我今天一直在搞递归。通常是一种未被充分使用的编程技术。

我开始递归地反转一个字符串。这是我想出的：

```
//A method to reverse a string using recursion
    public String reverseString(String s){
        char c = s.charAt(s.length()-1);
        if(s.length() == 1) return Character.toString(c);   

        return c + reverseString(s.substring(0,s.length()-1));
    } 
```

我的问题：Java中有更好的方法吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-13T18:25:40.480

最好的方法是不使用递归。这些东西通常用于教授学生递归概念，而不是实际的最佳实践。所以你这样做的方式很好。只是不要在 Java 中将递归用于现实世界应用程序中的这类东西；）

PS。除了我刚才所说的，我会选择`""`作为我的递归函数的基本情况：

```
public String reverseString(String s){
    if (s.length() == 0) 
         return s;

    return reverseString(s.substring(1)) + s.charAt(0);
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-13T18:48:27.777

如果你要这样做，你想对一个字符数组进行操作，因为字符串是不可变的，如果你这样做，你将在整个地方复制字符串。

这是未经测试的，完全是意识流。它可能在某处有一个OB1。而且非常不是Java。

```
public String reverseString(String s)
  {
  char[] cstr = s.getChars();
  reverseCStr(cstr, 0, s.length - 1);

  return new String(cstr);
  }

/**
 * Reverse a character array in place.
 */
private void reverseCStr(char[] a, int s, int e)
  {
  // This is the middle of the array; we're done.
  if (e - s <= 0)
    return;

  char t = a[s];
  a[s] = a[e];
  a[e] = t;
  reverseCStr(a, s + 1, e - 1);
  } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-13T18:36:44.300

你不想嵌套太深。分而治之是要走的路。还减少了临时字符串的总大小，并且可以并行化。

```
public static String reverseString(String str) {
    int len = str.length();
    return len<=1 ? str : (
        reverseString(str.substring(len/2))+
        reverseString(str.substring(0, len/2))
    );
} 
```

（未测试 - 这是stackoverflow。）

`String.concat`而不是`+`会以牺牲清晰度为代价来提高性能。

编辑：只是为了好玩，朴素算法的尾递归友好版本。

```
public static String reverseString(String str) {
    return reverseString("", str);
}
private static String reverseString(String reversed, String forward) {
    return forward.equals("") ? reversed : (
         reverseString(reversed+forward.charAt(0), forward.substring(1)) 
    );
} 
```

代理对的正确处理留给感兴趣的读者。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-26T10:28:25.240

这是我工作正常的递归反向函数

```
public static String rev(String instr){
    if(instr.length()<=1){
        return instr;
    } else {
       return (instr.charAt(instr.length()-1)+rev(instr.substring(0,instr.length()-1)) );
    }       
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T18:36:56.843

只是为了它，这里有一个尾递归方法使用`StringBuilder`（通常建议在操作`String`s 上）。

```
public String reverseString(String s_) {
    StringBuilder r = new StringBuilder();
    StringBuilder s = new StringBuilder(s_);
    r = reverseStringHelper(r, s);
    return r.toString();
}
private StringBuilder reverseStringHelper(StringBuilder r, StringBuilder s) {
    if (s.length() == 0)
        return r;
    else
        return reverseStringHelper(r.append(s.charAt(0)), s.deleteCharAt(0));
} 
```

未经测试，我已经很多年没有处理过 Java，但这应该是正确的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-14T04:55:53.277

如果您正在编写真正的代码（不是学习递归），请使用 StringBuilder 的 reverse() 方法。[Java 教程](http://java.sun.com/docs/books/tutorial/java/data/buffers.html)给出了这个例子：

```
String palindrome = "Dot saw I was Tod";   
StringBuilder sb = new StringBuilder(palindrome);
sb.reverse();  // reverse it
System.out.println(sb); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T18:42:25.120

这取决于您对“更好”的定义。:-) 说真的，不过；您的解决方案本质上使用了最大递归深度；如果堆栈大小与您对“更好”的定义有关，那么您最好使用以下内容：

```
public String reverseString(String s) {
   if (s.length() == 1) return s;
   return reverseString(s.substring(s.length() / 2, s.length() -1) + reverseString(0, s.length() / 2);
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-04-07T02:59:41.953

这就是我发现的工作和使用递归。您可以`str.length()`作为 strLength 参数传递

```
private static String reverse(String str, int strLength) {
    String result = "";
    if(strLength > 0)
        result = str.charAt(strLength - 1) + reverse(str, strLength - 1);
    return result;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-07-02T21:55:03.823

在 Java 中，由于 String 是不可变的，因此 String 连接会比看起来更复杂。

对于每个连接，它都会创建一个复制原始字符串内容的新字符串，从而导致线性复杂度**O(n)**其中**n**是字符串的长度，因此对于 m 这样的操作，它是**O(m*n)**，我们可以说它具有二次复杂度**O(n^2)**。

我们可以使用一个 StringBuilder ，它对每个追加都具有**O(1)复杂度。**下面是使用 StringBuilder 的递归程序。这仅使用 n/2 堆栈帧，因此它的空间复杂度低于正常的递归调用，就像`s.charAt(s.length-1) + reverse(s.subString(0, s.length-2);`

```
public class StringReverseRecursive {
    public static void main(String[] args) {
        String s = "lasrever gnirts fo noitatnemelpmi evisrucer a si sihT";
        StringBuilder sb = new StringBuilder(s);
        reverse(s, sb, 0, sb.length() - 1);
        System.out.println(sb.toString());
    }

    public static void reverse(String s, StringBuilder sb, int low, int high) {
        if (low > high)
            return;
        sb.setCharAt(low, s.charAt(high));
        sb.setCharAt(high, s.charAt(low));
        reverse(s, sb, ++low, --high);
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-13T18:27:18.623

这绝对是我递归反转字符串的方式（尽管在你的情况下将它扩展到空字符串的情况可能会很好。）我认为没有任何根本上更好的方法。

编辑：对字符数组进行操作并在递归链中传递“截止”长度可能更有效，如果你明白我的意思，而不是制作子字符串。然而，这并不值得吹毛求疵，因为它首先不是一个非常有效的技术。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-13T18:31:26.807

正如[Mehrdad](https://stackoverflow.com/questions/859562/whats-the-best-way-to-recursively-reverse-a-string-in-java/859572#859572)所说，最好不要使用递归。但是，如果您确实使用它，您不妨保留每次调用的第一个和最后一个字符，从而将递归调用的数量减半。那是，

```
public String reverseString(String s){
    int len = s.length();

    if (len <= 1) {
        return s;
    }

    char fst = s.charAt(0);
    char lst = s.charAt(len - 1);

    return lst + reverseString(s.substring(1, len - 2)) + fst;
} 
```

这也处理空字符串的情况。也许传递具有适当容量的 StringBuilder 会加快速度，但这留给读者作为练习；）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-13T18:35:53.583

您捕获了基本思想，但提取最后一个字符并不能提高清晰度。我更喜欢以下内容，其他人可能不会：

```
public class Foo
{
    public static void main(String[] argv) throws Exception
    {
        System.out.println(reverse("a"));
        System.out.println(reverse("ab"));
        System.out.println(reverse("abc"));
    }

    public final static String reverse(String s)
    {
        // oft-repeated call, so reduce clutter with var
        int length = s.length();

        if (length <= 1)
            return s;
        else
            return s.substring(length - 1) + reverse(s.substring(0, length - 1));
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-04-29T05:25:22.877

您可以尝试使用外部变量，并将所有字符 1 加 1：

```
 public static String back="";

public static String reverseString(String str){

    if(str.length()==0){

        return back;

    }else {

        back+=str.charAt(str.length()-1);

        lees(str.substring(0,str.length()-1));

        return back;

    } 
```

}

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-01-14T17:29:13.420

[这](https://gist.github.com/1612155)是我的不可变版本：

```
 String reverse(String str) {
    if(str.length()<2) return str;
    return  reverse(str.substring(1)) +str.charAt(0);
} 
```

和尾递归版本：

```
 String reverseTail(String str) {
    if(str.length()<2) return str;
    return str.charAt(str.length()-1)+ reverseTail(str.substring(0,str.length()-1)); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-04-06T17:34:27.870

在这种情况下，这是完全没有必要的，但是如果您制作自己的堆栈，您可以模拟递归并避免递归深度问题。

您可以迭代实现递归，这在您拥有本质上是递归的算法时可能是必要的，但也需要针对大问题运行它们。

```
String recIterReverse (String word){

    Stack <String> stack = new Stack <String> ();
    stack.push(word);
    String result = "";

    while (!stack.isEmpty()){
        String temp = stack.pop();
        result = temp.charAt(0) + result;

        if (temp.length() > 1){
        stack.push(temp.substring(1));
        }
    }

    return result;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-01-02T06:55:35.880

函数调用：

```
 //str:string to be reversed,i=0,j=str.length-1

    public void reverseString(String str,int i,int j)
    {

     if(i==j)
        {
         System.out.println(str);
         return;
        }

     char x=str.charAt(i);
     str=str.replace(str.charAt(i),str.charAt(j));
     str=str.replace(str.charAt(j),x);
     i++;j--;
     reverseString(str,i,j);
    } 
```

这个方法也行。。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-01-22T11:28:26.330

尝试以下操作：

```
public class reverse2
{
    public static void main(String name)
    {
    String revname=new StringBuffer(name).reverse().toString();
    System.out.println("original string " + name + " and the reverse of it is " + revname);
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-02-12T06:36:10.620

```
public static String rev(String name){
    if(name.length()>=1){
    System.out.print(name.charAt(name.length()-1)); 
    return rev(name.substring(0,name.length()-1));
    }
    else{
        return ""+name.substring(0);
    }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-09-02T16:33:19.640

```
String rev="";

public String reverseString(String s){
        if (s.length()==0) return "";
        return rev+s.substring(s.length()-1,s.length())+reverseString(s.substring(0, s.length()-1));
    } 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-04-23T06:05:55.160

```
public String reverseString (String s) {

    if (s != null && s.length () > 0 ) {
        rev = rev + s.substring (s.length () - 1);
        reverseString (s.substring (0, s.length () - 1));
    }
    return rev;

} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-04-29T12:17:44.530

```
public class StringUtility {

public static void main(String[] args) {
    StringUtility stringUtility = new StringUtility();

    String input = "santosh123";
    int middle = input.length() / 2;
    middle = middle - 1;
    System.out.println(stringUtility.stringReverse(input, middle));
}

public String stringReverse(String input, int middle) {

    if (middle == -1) {

        System.out.println("if");
        return input;

    } else {

        System.out.println("else");
        input = swapChar(input, middle);
        middle = middle - 1;
        return stringReverse(input, middle);

    }

}

private String swapChar(String input, int middle) {
    StringBuilder str = new StringBuilder(input);
    char begin = str.charAt(middle);
    int endIndex = input.length() - middle - 1;
    char end = str.charAt(endIndex);
    str.setCharAt(middle, end);
    str.setCharAt(endIndex, begin);
    System.out.println(str + "  " + middle + "  " + endIndex);
    return str.toString();
}

} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-07-17T10:26:17.323

如果您认为更少的代码是好的，那么......

```
static String reverse(String str){
    return str.length()>=2 ? str.charAt(str.length()-1) + reverse(str.substring(0,str.length()-1)) : str ;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-01-19T01:20:42.237

已经有大约 20 个答案，但我也会加入我的递归算法。它可能有点冗长，但至少是可读的。

```
public static String reverseString(String str) {
   return reverseString("", str);
}

private static String reverseString(String result, String original) {
   if (original.length() == 0) {
      return result;
   } else {
      int length = original.length();
      String lastLetter = original.substring(length - 1, length);
      original = original.substring(0, length - 1);
      return reverseString(result + lastLetter, original);
   }
} 
```

代码基本上递归地获取字符串的结尾并将其移到前面。例如，如果我们要反转的字符串是“jam”，那么每次调用辅助方法时，结果和原始字符串如下：

```
// result:  original:
// ""       jam
// m        ja
// ma       j
// maj      "" 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-08-12T04:44:48.273

使用递归方法调用反转字符串。

> 示例代码

```
public static String reverseString(String s) {
    if (s.length() == 0) {
        return s;
    }
    else {
        return s.charAt(s.length() - 1) + reverseString(s.substring(0, s.length() - 1));
    }
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-10-15T16:29:32.567

这是我的解决方案，我在上面的许多解决方案中看到我们正在获取字符串长度，但理想情况下我们不需要它。Zen 是使用递归，只需将字符串的第一个字符切掉，然后将其余的传递给递归方法。耶！！我们得到了解决方案。

```
private static void printReverse(String str) {
            if (!str.isEmpty()) {
                String firstChar = str.substring(0, 1); //Get first char of String
                String newstr = str.substring(0, 0) + str.substring(1); // Get remaining string
                printReverse(newstr); // Recursion magic
                System.out.print(firstChar); //Output
            }
        } 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2014-09-11T13:45:49.197

```
public static String reverse(String s){

    int n = s.length()-1;

    if(n >=0)
    return  s.substring(s.length()-1)+ReverseString(s.substring(0,n--));
    else return "";
} 
```

# java - Java Enums 和 Switch 语句 - 默认情况？

> ID：859563
> 
> 赞同：57
> 
> 时间：2009-05-13T18:23:52.013
> 
> 标签：java, enums

对于建议抛出异常的人：
抛出异常不会给我一个编译时错误，它会给我一个运行时错误。我知道我可以抛出异常，我宁愿在编译期间死，也不愿在运行时死。

首先，我使用的是 eclipse 3.4。

我有一个数据模型，它的模式属性是枚举。

```
enum Mode {on(...), off(...), standby(...); ...} 
```

我目前正在编写此模型的视图并且我有代码

```
...
switch(model.getMode()) {
case on:
   return getOnColor();
case off:
   return getOffColor();
case standby:
   return getStandbyColor();
}
... 
```

我收到错误“此方法必须返回 java.awt.Color 类型的结果”，因为我没有默认情况，并且在函数末尾没有返回 xxx。 **在有人向枚举添加另一种类型（例如关闭）的情况下，我*想要*一个编译错误，所以我不想放置一个引发 AssertionError 的默认情况，因为这将使用修改后的模式进行编译，而不是被视为错误直到运行时。**

我的问题是：
为什么 EclipseBuilder（和 javac）不承认这个开关涵盖了所有可能性（或者它是否涵盖了它们？）并停止警告我需要返回类型。有没有一种方法可以在不向模式添加方法的情况下做我想做的事情？

如果做不到这一点，是否有一个选项可以在不涵盖 Enum 的所有可能值的 switch 语句上发出警告/错误？

编辑： Rob：这是一个编译*错误*。我刚刚尝试用 javac 编译它，我得到一个针对该方法的最后一个 } 的“缺少返回语句”错误。Eclispe 只是将错误放在方法的顶部。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-05-13T18:55:36.080

您总是可以使用带有访问者模式的枚举：

```
enum Mode {
  on {
      public <E> E accept( ModeVisitor<E> visitor ) {
         return visitor.visitOn();
      }
  },
  off {
      public <E> E accept( ModeVisitor<E> visitor ) {
         return visitor.visitOff();
      }
  },
  standby {
      public <E> E accept( ModeVisitor<E> visitor ) {
         return visitor.visitStandby();
      }
  }

  public abstract <E> E accept( ModeVisitor<E> visitor );

  public interface ModeVisitor<E> {
      E visitOn();
      E visitOff();
      E visitStandby();
  }
} 
```

然后，您将实现以下内容：

```
public final class ModeColorVisitor implements ModeVisitor<Color> {
    public Color visitOn() {
       return getOnColor();
    }

    public Color visitOff() {
       return getOffColor();
    }

    public Color visitStandby() {
       return getStandbyColor();
    }

} 
```

您可以按如下方式使用它：

```
return model.getMode().accept( new ModeColorVisitor() ); 
```

这要冗长得多，但是如果声明了新的枚举，您将立即收到编译错误。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-05-13T18:54:31.400

您必须在 Eclipse（窗口 -> 首选项）设置“Enum type constant notcovered in switch”中启用错误级别。

在方法结束时抛出异常，但不要使用默认大小写。

```
public String method(Foo foo)
  switch(foo) {
  case x: return "x";
  case y: return "y";
  }

  throw new IllegalArgumentException();
} 
```

现在，如果有人稍后添加新案例，Eclipse 会让他知道他缺少一个案例。因此，除非您有充分的理由这样做，否则永远不要使用默认值。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-13T18:49:23.920

我不知道您为什么会收到此错误，但这里有一个建议，您为什么不在枚举本身中定义颜色？然后你就不会不小心忘记定义新颜色了。

例如：

```
import java.awt.Color;

public class Test {

    enum Mode 
    {
        on (Color.BLACK), 
        off (Color.RED),
        standby (Color.GREEN);

        private final Color color; 
        Mode (Color aColor) { color = aColor; }
        Color getColor() { return color; }
    }

    class Model
    {
        private Mode mode;
        public Mode getMode () { return mode; }
    }

    private Model model;

    public Color getColor()
    {
        return model.getMode().getColor();
    }   
} 
```

顺便说一句，这里的比较是原始情况，编译器错误。

```
import java.awt.Color;
public class Test {

    enum Mode {on, off, standby;}

    class Model
    {
        private Mode mode;
        public Mode getMode () { return mode; }
    }

    private Model model;

    public Color getColor()
    {
        switch(model.getMode()) {
        case on:
           return Color.BLACK;
        case off:
           return Color.RED;
        case standby:
           return Color.GREEN;
        }
    }   
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-13T18:30:01.583

我会说这可能是因为 model.GetMode()**可能**返回 null。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T18:26:07.640

创建一个引发异常的默认情况：

```
throw new RuntimeExeption("this code should never be hit unless someone updated the enum") 
```

...这几乎描述了 Eclipse 抱怨的原因：虽然您的开关今天可能涵盖所有枚举案例，但有人可能会添加一个案例而不是明天重新编译。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T18:27:28.090

> 为什么 EclipseBuilder 无法识别此开关涵盖了所有可能性（或者它是否涵盖了它们？）并停止警告我需要返回类型。有没有一种方法可以在不向模式添加方法的情况下做我想做的事情？

这不是 Eclipse 中的问题，而是编译器的问题，`javac`. 所有人都看到，在*没有*`javac`匹配的情况下，你没有返回值（*你*知道你匹配所有情况的事实是无关紧要的）。您必须在默认情况下返回*某些*内容（或抛出异常）。

 ***就个人而言，我只是抛出某种异常。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-13T18:48:53.983

您的问题是您试图使用 switch 语句作为您的枚举被锁定的指示器。

事实是“switch”语句和 java 编译器无法识别您不想在枚举中允许其他选项。您只需要枚举中的三个选项这一事实与您对 switch 语句的设计完全分开，正如其他人所指出的那样，它应该始终具有默认语句。（在你的情况下，它应该抛出一个异常，因为它是一个未处理的场景。）

您应该在枚举中随意添加注释，以便每个人都知道不要触摸它，并且您应该修复您的 switch 语句以在无法识别的情况下抛出错误。这样你就覆盖了所有的基础。

**编辑**

关于抛出编译器错误的问题。这没有严格意义上的意义。您有一个带有三个选项的枚举和一个带有三个选项的开关。如果有人向枚举添加值，您希望它引发编译器错误。除了枚举可以是任何大小，因此如果有人更改它，抛出编译器错误是没有意义的。此外，您正在根据可能位于完全不同的类中的 switch 语句定义枚举的大小。

Enum 和 Switch 的内部工作是完全独立的，应该保持解耦。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-15T11:56:28.687

一个很好的方法是添加默认情况以返回一些错误值或抛出异常，并使用 jUnit 的自动化测试，例如：

```
@Test
public void testEnum() {
  for(Mode m : Mode.values() {
    m.foobar(); // The switch is separated to a method
    // If you want to check the return value, do it (or if there's an exception in the 
    // default part, that's enough)
  }
} 
```

当您进行自动化测试时，这将负责为所有枚举定义 foobar。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-13T18:41:30.953

既然不能评论...

1.  总是，总是，总是有一个默认情况。你会惊讶于它被击中的“频率”（在 Java 中比在 C 中少，但仍然如此）。

2.  话虽如此，如果我只想在我的情况下处理开/关怎么办。javac 的语义处理会将其标记为问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-12-28T15:50:09.213

如今（这个答案是在原始问题之后几年写的），eclipse 允许在 Window -> Preferences -> Java -> Compiler -> Error/warnings -> 潜在的编程问题处进行以下配置：

> 不完整的开关盒
> 
> > 即使存在默认情况也发出信号

# ubuntu - Ubuntu 9.04 的正确 Putty 配置

> ID：859565
> 
> 赞同：21
> 
> 时间：2009-05-13T18:24:08.363
> 
> 标签：ubuntu, putty

我经常使用腻子（[http://www.chiark.greenend.org.uk/~sgtatham/putty/](http://www.chiark.greenend.org.uk/~sgtatham/putty/)）连接到 Ubuntu 盒子（现在是 9.04）。它运行良好，但我无法在 Ubuntu 端弄清楚 Putty 字体、字符编码、字符翻译和终端配置的正确组合，以便终端正确显示所有内容。在运行诸如“screen-profiles”或“w3m”之类的 ncurses 程序时，问题最为明显。方框图字符搞砸了。

有没有人对这种组合感到满意？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2011-08-10T10:45:29.083

尝试导出以下环境变量

`export NCURSES_NO_UTF8_ACS=1`

这会阻止 ncurses 在 UTF-8 语言环境中使用 VT100“备用字符集”线条绘图字符，并改为使用 Unicode 方框绘图字符。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-13T20:19:38.050

我能想到的最好的方法是将 Window/Translation 中的 putty 配置更改为 UTF-8，并将 Window/Appearance 中的字体更改为 Lucida Console。

它使大多数字符正确。在“aptitude”中，菜单以线条绘制字符正确勾勒出来，但不是“您确定要退出”弹出对话框。运行像“man ls”这样的命令现在可以正确显示大部分字符，但连字符的单词最终会以一个框代替连字符。

无论如何，这对于在 Emacs 中编程来说已经足够好了。更好的解决方案表示赞赏。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-01-19T02:16:00.483

例如，在“UTF-8”中，Putty（或增强的 fork Kitty）都不会尊重切换到 VT100 样式线条绘制模式的请求`aptitude`- 这是设计使然（[http://www.chiark.greenend.org .uk/~sgtatham/putty/wishlist/utf8-plus-vt100.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/wishlist/utf8-plus-vt100.html)）。

但是，如果我们将“连接 > 数据 > 终端类型字符串”设置为“putty”而不是默认的“xterm”，它可以解决问题，因为服务器会调整渲染字符。

我相信这个解决方案比`export NCURSES_NO_UTF8_ACS=1`我自己迄今为止使用的更好。

![修复腻子画线问题](https://i.stack.imgur.com/b1SsA.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-16T07:15:23.187

就我而言，它不是 ncurses，也不是腻子。这是语言环境，未设置为 UTF-8 ......

所以`locale`调用产生了下面的结果。

```
$ locale
LANG=en_US 
```

但是，需要的是

```
$ locale
LANG=en_US.UTF-8 
```

我能够通过

```
$ sudo locale-gen en_US.UTF-8
$ sudo update-locale LANG=en_US.UTF-8 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-25T18:01:38.060

不要挖掘旧帖子，但[KiTTY](http://kitty.9bis.net/)（PuTTY fork）提供了一个复选框以“允许 ACS 以 UTF 绘制线条”（新/当前会话设置-> 窗口-> 翻译），这似乎适用于 aptitude 等应用程序。我刚刚下载了最新版本的 PuTTY，这个复选框不存在，所以它必须是特定于 KiTTY 的。

关于手头的问题，其他答案没有错；这只是附加环境变量或更改广告终端类型的替代方法。（如果您使用的是 screen/tmux 以及 termcap 是如何参与的，另请参阅[https://stackoverflow.com/a/8485457/1011365](https://stackoverflow.com/a/8485457/1011365)了解更多信息，尽管仅供参考，我使用的是最新的 tmux 并且仍然需要选中 KiTTY 中的复选框以允许字符正确显示）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-12-20T04:38:35.737

我主要使用 Putty 与我的 Ubuntu vm-boxen 进行交互，所以我确实花了一些时间让视觉配置正确。基本上，我将字体设置为 MS Gothic、9pt（用于等宽和日文）、UTF-8 用于接收数据，并将终端类型字符串设置为`xterm-256color`. 我不理会大多数终端设置，因为默认设置似乎运行良好。

在 Ubuntu 方面，我设置了`LANG=en_US.UTF-8`,`aptitude install ncurses-term`附加条款。[我通过一个不错的脚本](http://www.frexx.de/xterm-256-notes/)检查终端颜色，并在`GNU Screen`会话和`GNU Emacs`( `M-x list-colors-display`) 中仔细检查。`GNU Screen`没有用 256 色选项编译，所以我重新编译它。我通过使用`Emacs`( `M-x view-hello-file`) 以及`tig`一个`git`包含 i18n utf-8 日志提交的目录来检查语言。

不幸的是，我仍然得到奇怪的“lqqqqk”东西`aptitude`（线条艺术缺失？）但间距仍然正确。按下退格键也会`aptitude`插入一个字符，我还没有征服。我还在我的系统上测试了你的命令行 w3m，它看起来不错。我宁愿使用 emacs 中的 w3m。:-)

说实话，我用的是[日本的腻子叉，叫做 Gottani（腻子ごった煮版）](http://yebisuya.dip.jp/Software/PuTTY/)，它对日语的帮助更大，但我认为它非常接近普通的腻子。

另外：我还设置了终端 > 功能 > 禁用远程控制终端调整大小，因为“GNU 屏幕”覆盖了我的窗口大小设置。

以上所有内容均在 Ubuntu 8.04 LTS "Hardy Heron" 上进行了测试。

# html - 在 IE中将元素定位在 a 的右上角

> ID：859573
> 
> 赞同：0
> 
> 时间：2009-05-13T18:25:57.563
> 
> 标签：html, css

我无法将（div）元素定位在跨度的右上角。它适用于 FF3，但不适用于 IE7：

```
<html>
<head>
<style>
body
{
    font-size: 24px;
}

.tag
{
    padding: 3px;
    background-color: lightblue;
    position: relative;
}

.x
{
    position: absolute;
    top: 0px;
    right: 0px;
    width: 10px;
    height: 10px;
    background-color: orange;
}
</style>
</head>
<body>
text <span class="tag">tag<div class="x"></div></span> text 
</body>
</html> 
```

在 FF3 中，在浅蓝色框的右上角渲染了一个 10x10 的橙色框。我无法让它在 IE7 中工作。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T18:43:51.263

首先，为您的页面获取正确的文档类型，以便它不会以怪癖模式呈现。

[W3C：推荐的 DTD 列表](http://www.w3.org/QA/2002/04/valid-dtd-list.html)

其次，确保代码有效。您不能将块元素 (div) 放在内联元素 (span) 中。

[W3C 标记验证](http://validator.w3.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T18:53:36.207

以后在IE7中定位有问题也可以看这个[帖子](http://msdn.microsoft.com/en-us/library/ms533005.aspx)

# svn - 设置本地颠覆服务器的最简单方法是什么？

> ID：859577
> 
> 赞同：12
> 
> 时间：2009-05-13T18:26:19.123
> 
> 标签：svn, version-control

我真的不精通这些东西，我只想在我的计算机上本地设置一个svn服务器。如果可能的话，我还想设置它并将其直接集成到 Visual Studio 2008 中吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-13T18:27:58.417

我使用 TortoiseSVN，创建了一个目录 (C:\Repositories)，然后使用菜单命令“在此处创建存储库...”。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-13T18:27:34.177

只需创建一个本地 svn 存储库并为它们的源代码使用基于 file:// 的 url。应该不需要具体的。运行，服务器实例。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-13T18:34:15.693

我会第二个免费的 Visual SVN 服务器，它会让你在几分钟内启动并运行。然而，它通过 HTTP 连接 SVN，并且对于可能不需要的本地 Subversion 安装。

如果您宁愿只运行“手动”设置 Subversion，以下是该过程的演练，重点是 Visual Studio 的使用： [http ://www.west-wind.com/presentations/subversion/](http://www.west-wind.com/presentations/subversion/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-13T18:33:44.120

检查服务器的[http://www.visualsvn.com/](http://www.visualsvn.com/)和客户端的 TortoiseSVN。检查 AnkhSVN 是否与 Visual Studio 2008 集成。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-13T18:29:36.123

[http://www.visualsvn.com/](http://www.visualsvn.com/) 这应该有助于解决您的集成问题

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-13T18:52:05.557

里克斯特拉尔，FTW！

Coding Horror 的 Jeff Atwood 介绍了另一个使用 Windows 设置 SVN 的精彩演练：

[在 Windows 上设置 Subversion](https://blog.codinghorror.com/setting-up-subversion-on-windows/)

简而言之：

1.  下载/安装SVN，配置为windows服务
2.  安装 TortoiseSVN（或您选择的 SVN GUI）。我建议坚持使用 Tortoise，因为有使用与 VS 集成的 SVN 客户端的轶事恐怖故事
3.  创建存储库（通过 CLI 或 GUI 客户端

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-13T18:33:08.037

我建议使用[subversion](http://subversion.tigris.org/)作为文件的本地主机，使用 tortoise [tortoise](http://tortoisesvn.tigris.org/)进行浏览集成或/和[ankhsvn](http://ankhsvn.open.collab.net/)与 vs2008 集成。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-13T18:30:46.977

我会推荐 Toirtoise SVN，它相当容易设置和使用。

这是[文档](http://tortoisesvn.net/docs/release/TortoiseSVN_en/index.html)，它是必须的！

# jquery - jQuery 和 Ajax

> ID：859579
> 
> 赞同：1
> 
> 时间：2009-05-13T18:27:04.973
> 
> 标签：jquery, ajax

我正在努力在 jquery 对话框中添加异步表单提交。我正在使用 .ajax()。一切正常，但提交时间比我想要的要长。我是 jquery 的新手，不确定如何调试/优化它。如何确定延迟是在前端还是后端？

谢谢，

娜塔莎

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T18:29:52.097

尽管没有一些代码就无法真正了解您的特定情况，但除非您正在做一些显然会占用大量浏览器资源的事情（对大型表格进行排序、添加大量 HTML 等），否则 Javascript 不会出现任何延迟。 ) 如果您所做的只是获取数据、对其进行序列化并使用 AJAX 将其发送到服务器，并且响应时间很长，那么问题出在服务器端代码上。[您可以使用Firebug](http://www.getfirebug.com)之类的工具来验证这一点，该工具会向您显示请求何时被触发以及服务器响应后需要多长时间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T18:30:20.583

如果您有 firefox 使用 firebug，它会在控制台选项卡中显示请求/响应花费了多长时间，您还可以（如果您有访问权限）记录后端进程花费了多长时间，这有望给您一个合理的想法滞后在哪里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T18:34:09.797

除非后端有一些糟糕的代码，否则您的速度问题很可能是由网络问题引起的。JavaScript/Ajax 并没有阻碍您，或者至少直观地看起来不太可能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T18:50:56.383

要确定减速的位置，您可以使用 Date 对象获取当前的毫秒数（单击表单提交后立即），然后添加一个函数`beforeSend`，`jQuery.ajax({beforeSend: function() { ... });`将自开始以来的时间添加到页面某处的标记. 然后你可以用它`complete`来确定从多久开始。

jQuery.ajax 选项：[http ://docs.jquery.com/Ajax/jQuery.ajax#options](http://docs.jquery.com/Ajax/jQuery.ajax#options)

JS 日期对象：[http ://www.w3schools.com/jsref/jsref_obj_date.asp](http://www.w3schools.com/jsref/jsref_obj_date.asp)

# ajax - 这个会话/令牌认证系统对我的 web api 有意义吗？

> ID：859589
> 
> 赞同：2
> 
> 时间：2009-05-13T18:28:09.963
> 
> 标签：ajax, security, api, authentication

今天我为我的 web api（http get/post rpc 风格）实现了一个会话/令牌认证系统，遵循这个计划：

**图例**：动作（param1，param2）：returnvalue1，returnvalue2

*   登录（用户名，密码）：会话密钥，令牌
*   requestA（会话密钥，令牌，参数）：令牌
*   requestB (sessionkey, token, paramB) : 令牌
*   注销（会话密钥，令牌）：无效

登录操作通过 https 发送，以保护用户数据。您将获得一个会话/令牌组合，其中一个令牌仅对一个请求有效（您将始终在正常请求中收到一个新令牌）。我的想法是降低中间人攻击的风险，嗅探你的会话密钥：如果你“幸运”，嗅探到的令牌已经通过你自己的后续请求失效。

我的后端和它的单元测试非常好，但我想得还不够远——我最终遇到了异步 ajax 调用的问题，这破坏了这个一次性令牌的想法。

**增加的安全性是否值得不能处理异步请求？**

一个想法是在我的 ajax 应用程序中引入一个请求队列——**有人做过类似的事情吗，你会推荐它吗？**

恕我直言，一种可能不太安全但更方便的方法是不要为每个请求更新令牌 - 允许异步处理，但保留初始 https 身份验证并为会话添加严格的生命周期。我还应该将 IP 保存到会话服务器端。

**我错过了其他有价值的选择吗？**

我被绑定到现有的用户名/密码值，它们必须在不更改新 ajax 应用程序的情况下正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T19:06:41.797

在我看来，您设计的令牌机制实际上并不能保护您免受中间人攻击。想象一个中间人拦截来自客户端的每个（非 HTTPS）请求，并将其替换为不同的请求，然后发送到服务器。服务器返回给中间人的令牌然后可以简单地返回给客户端，客户端可能无法判断其请求从未到达服务器。

有没有一种方法可以简单地通过 https 完成所有请求？Https 提供了相当多的保护免受中间人攻击，前提是您使用正确的证书，并使用无效太长时间的高度随机会话密钥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T19:16:49.570

身份验证后以纯文本（读取 HTTP）发出的任何后续请求都应该被认为是不安全的，并且容易受到您可以想象的任何攻击。

如果您的目标是保护客户端和服务器之间的通信，则整个会话都必须使用 HTTPS。此外，您需要确保在客户端从 HTTP 移动到 HTTPS 后更改会话 cookie（如果原始请求是 HTTP，我假设您正在执行某种重定向）。这是使客户端容易受到会话窃取攻击的常见错误。

Rails 做的事情与您描述的机制类似。他们称他们的代币为真实性代币。但是我的理解是，主要目的是进行流量控制或双击保护，而不是实际保护通信。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T09:03:29.663

我认为 HTTPS 并将会话绑定到客户端 IP 并不时重新生成会话 ID（可能每 5 个请求）将保护您的 API。添加请求/令牌机制将提高安全性，但不再是必须的，恕我直言。

我看到的请求/令牌系统即将出现的一个问题是，如果请求失败或没有收到响应，客户端如何重新启动通信？它没有有效的请求令牌，如果您的 API 正常工作，它将拒绝以下任何请求:)

# python - 找不到我的 PYTHONPATH

> ID：859594
> 
> 赞同：12
> 
> 时间：2009-05-13T18:28:59.617
> 
> 标签：python, windows, path

我正在尝试更改我的 PYTHONPATH。我试图在“我的电脑”等中更改它，但那里不存在。我在某些地方的注册表中进行了搜索，甚至对“PYTHONPATH”一词进行了整个搜索，但无济于事。

但是，它 Python 我可以很容易地看到它的存在。那么它在哪里呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-13T18:32:31.500

在运行时，您可以使用以下方法更改它：

```
import sys
sys.path.append('...') 
```

在我的电脑中，右键单击属性（或按 Win-Break）、系统选项卡、环境变量、系统。如果它不存在，您可以添加它。

最后，在 CMD 提示符下：

```
set PYTHONPATH C:\Python25\Lib;C:\MyPythonLib 
```

或在`bash`：

```
PYTHONPATH=/usr/share/python/lib:/home/me/python
export PYTHONPATH 
```

或者，更简洁地说：

```
export PYTHONPATH=/home/me/python 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T18:32:29.177

Python 在启动时会预先做一些事情，可能还会在 Windows 中设置该路径。只需设置它，看看它是否在`sys.path`.

在 Python 文档中[设置环境变量说：](http://docs.python.org/using/windows.html#excursus-setting-environment-variables)

```
My Computer ‣ Properties ‣ Advanced ‣ Environment Variables 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T18:32:41.593

如果它不存在，您可以将其添加到“我的电脑”下。PYTHONPATH 只是添加到默认的 sys.path。

在 unix/linux/osx 上，您可以：

```
$ export PYTHONPATH=/to/my/python/libs 
```

您还可以使用 .pth 文件指向库：

[http://docs.python.org/library/site.html#module-site](http://docs.python.org/library/site.html#module-site)

而且当然：

```
import sys
sys.path.append('/path/to/libs/') 
```

此外，查看 virtualenv 以管理多个项目的库。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-13T18:41:04.917

这是我解决它的方法。

首先，获取当前路径。那里比我预期的要多得多。

```
import sys
print ';'.join(sys.path) 
```

将该结果复制到剪贴板。转到我的电脑并创建新的环境变量 PYTHONPATH，并从剪贴板粘贴值。根据需要进行修改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-20T11:09:30.697

MacOS 10.5.8、Python 2.6、Eclipse+Pydev 1.5.7

1.  Python 安装的站点包是，例如：

    ```
    /Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages
    ```

2.  在站点包中创建符号链接您的库，例如：

    ```
    cd /Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages
    ln -s /path/to/YOUR/LIBRARY/ YOUR_LIBRARY_NAME 
    ```

    现在您可以在命令行中使用：

    ```
     import YOUR_LIBRARY_NAME 
    ```

3.  使用 Pydev 运行 Eclipse，转到 Preferences->Pydev->Interpreter Python

4.  **删除**您的 Python 解释器记录（如果存在）；

5.  单击**新建**并添加 Python 2.6 解释器路径，例如：

    ```
    /Library/Frameworks/Python.framework/Versions/2.6/bin/python2.6 
    ```

6.  注意，Eclipse Pydev 显示 Python 系统库，接受

7.  在库部分单击**新建文件夹**并写入您的库的路径，例如：

    ```
    /path/to/YOUR/LIBRARY/
    ```

8.  点击**Apply——**这是必不可少的，因为Eclipse Pydev现在建立了他自己的“图书馆地图”，当这个操作完成时——点击[OK]

9.  关闭日食

10.  再次运行 Eclipse - 现在你应该在 Pydev 中使用：

    ```
     import YOUR_LIBRARY_NAME 
    ```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-19T04:57:21.033

而且，与生活中的所有美好事物一样，您可以在文档中找到它：http: [//docs.python.org/install/index.html#modifying-python-s-search-path](http://docs.python.org/install/index.html#modifying-python-s-search-path)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T18:32:45.417

它设置成什么？您是否尝试过创建 PYTHONPATH 环境变量？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T18:33:19.533

您需要修改环境变量。如何执行此操作取决于您拥有的 Windows 版本。

如果 PYTHONPATH 变量不存在，则必须创建它。如果您尚未创建它，它可能不存在。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-05-16T23:33:55.797

我遇到了同样的问题，oliver-zehentleitner 在 github 上的回答解决了我的问题。他说：也许你用 pip 为 python2 安装包并用 python3 运行，只需尝试用 pip3 安装或`python3 -m pip install python-binance`然后再次运行你的脚本。

我希望这也能解决你的问题。

# java - Java：是否有使代码（在第 3 方 JAR 中）向前兼容的工具（1.4 - 1.6）

> ID：859603
> 
> 赞同：1
> 
> 时间：2009-05-13T18:30:26.370
> 
> 标签：java, decompiling

我有一个使用 Java 1.4 编译的第 3 方 JAR 文件。有没有工具可以让jar文件兼容Java 1.6？（类似于'retrotranslator'，但它的反面是什么）。
我尝试反编译类文件并在 1.6 中重新编译它们，但它失败了。

* * *

这是问题所在：

我的项目使用 'rsadapter.jar' 为 5.1，我在 Eclipse 2.0 + JDK 1.4 中设置了我的项目，它曾经工作正常。现在，我已经迁移到 Java 1.6 和 Eclipse Ganymede（根据要求），并且同一个项目（完全相同的设置）开始抱怨“rsadapter.jar”中缺少的类文件。我也明确地将 JAR 放在类路径中，但它仍然无法加载类。然后我将 Java 编译器版本更改为 1.4 并开始工作。

问候，
-阿什什

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T18:33:19.923

JDK 1.4 编译的类应该可以在 Java 6 运行时中按原样使用。如果您确实遇到了问题，请描述它。

* * *

*更新：*我只能使用“默认”包中的类型（即，不在包中）来重现它。您尝试使用的类是否在默认包中？此外，无论用于编译的 JDK 版本如何，这都会发生在我身上。

* * *

*更新：*好的，经过一番研究，我意识到你永远不能从命名包中引用未命名包中的类型。有道理，但绝对不是你遇到的。

我可以在 JDK 1.4.2_19 下编译代码并在 Java 6 Eclipse 项目中很好地利用它。我认为这个问题是特定于您的环境的。在这种情况下，我会备份 Eclipse 并从头开始重新创建所有内容（JDK 安装、工作区、项目），看看我是否可以清理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T20:13:33.737

我对一些用 Java 1.4.x 编写的遗留代码有另一个问题：作者喜欢枚举并且喜欢将相应的变量命名为“枚举”。他们甚至用它来命名包名。这会阻止在 Java 1.5（或更高版本）下非常成功地编译代码。

自动更改**是**一个很大的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T20:11:45.143

可能您已经定义 Eclipse 在使用不推荐使用的方法或类时引发编译器错误？

# java - 如何获取Java堆的内存地址？

> ID：859604
> 
> 赞同：7
> 
> 时间：2009-05-13T18:30:31.830
> 
> 标签：java, matlab

如何确定在当前进程中运行的 JVM 的 Java 堆内存中的地址？也就是说，使用 Java、C 或其他调用，获取一个 void* 指针或等效于 JVM 为堆分配的连续内存区域？

Matlab 在其进程中嵌入了一个 JVM。JVM 分配的内存对于 Matlab 数组是不可用的，其中，堆很重要，因为它占用了很大的连续内存块并且永远不会缩小，而且 Matlab 还需要为其数组提供连续内存。如果在扩展期间重新分配堆，则可能导致碎片。

我想对我的进程进行检测，以检查 Java 堆和 Matlab 的内存视图之间的交互，并找出它何时因调整大小而移动，最好是在进程内。这需要堆的地址。从 java.lang.Runtime 中很容易找到堆大小，但不是它在内存中的地址。如何才能做到这一点？

我在 Windows XP 和 Server 2003 上的 Matlab R2008b 进程中运行 Sun 的 JRE 1.6.0_04。我意识到这可能需要成为特定于供应商的技术。该进程运行我们编写的代码，因此我们可以使用自定义 Java、Matlab、JNI 和 C/C++ 代码。JVM 中的 Java 方法调用或支持的钩子将比低级黑客更受欢迎。

编辑：这样做的目的是检查 JVM 的 GC 和 Matlab 的 GC 之间的交互。我不需要查看 Java 堆，也不会从该内存中读取任何内容；我只想看看它在 Matlab 的 GC 也试图将数据放入的整个虚拟内存空间的上下文中的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:26:42.940

退一步……你能用一个固定大小的Java堆吗？到那时，对重新分配和碎片的担忧就消失了。

在独立的 Java 调用中，涉及为 500Mb 堆指定类似 -Xmx500m 和 -Xms500m 的内容。你必须把它翻译成matlab想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-07T22:47:49.137

获取 JVM 的实际堆地址的一种快速且肮脏的方法是跳转到 WinDbg，附加到 JVM 并发出单个 !address 命令。0x2附近的某个地方？？？？？？（它在 jvm 版本之间有所不同，但该版本保持静态）将是一个标记为 PAGE_EXECUTE_READWRITE 的大型 VAD，这是进程内存中的 JVM 堆。

为了确认，您可以在 kernel32!VirtualAlloc 上设置断点，并在 JVM.DLL 模块中初始化 JVM 时，您将调用 VirtualAlloc，向您显示 jvm 分配的堆。如果您查看此调用周围的代码，您可以看到地址是如何计算的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T19:25:53.970

如果您只是想让 JVM 堆缩小，您可以尝试使用 gc 参数，例如 -XX:MaxHeapFreeRatio（请参阅[http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp)）

我认为您无法使用 JNI 获得指向 Java 堆的指针。但是，Java 堆只是 Windows 从进程堆之一分配给进程的内存。

您可以使用 GetProcessHeaps 函数 ( [http://msdn.microsoft.com/en-us/library/aa366571(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa366571(VS.85).aspx) ) 从 C++ 代码中获取进程堆，然后使用 HeapWalk 开始遍历它们功能。[在http://www.abstraction.net/content/articles/analyzing%20the%20heaps%20of%20a%20win32%20process.htm](http://www.abstraction.net/content/articles/analyzing%20the%20heaps%20of%20a%20win32%20process.htm)有一个很好的例子。您可能能够通过查找某些字节模式来发现 Java 堆使用了哪些分配的块（JVM 源代码可能会为您提供一些关于要查找的内容的线索，但祝您好运！）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T20:17:15.930

GC 可以随时移动数据以压缩内存。所以 Java Heap 中的对象没有固定的点。您可以使用 ByteBuffer.allocateDirect() 在“C”空间而不是堆中分配内存，并且它固定在内存中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T09:50:00.137

如果不使用定制的 JVM，我认为没有办法实现你想要的。理论上，您可以使用 OpenJDK 并对其进行修补或启用一些跟踪（不确定是否有一个适合您的需求）。我认为诸如[进程浏览器之](http://technet.microsoft.com/de-de/sysinternals/bb896653.aspx)类的外部监控工具 可以解决您的问题

# performance - 减慢计算机以调试间歇性缺陷

> ID：859623
> 
> 赞同：0
> 
> 时间：2009-05-13T18:33:47.753
> 
> 标签：performance, debugging, intermittent

有没有办法减慢我的开发计算机的速度，以尝试复制仅在慢速机器上间歇性发生的缺陷？

（对于它的价值，Ableton Live 有一个 CPU 使用模拟功能，但我从来没有见过这样的调试器。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T18:48:10.990

[该工具](http://www.playtool.com/pages/prime95/prime95.html)提供了不错的 CPU 压力能力。我想这就是你所说的“慢下来”。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T19:33:14.100

> 目前流行的稳定性测试程序有：
> 
> *   Prime95（本程序的拷问测试）
> *   3DMark2001
> *   CPU稳定性测试
> *   Sisoft 桑德拉
> *   雷神之锤和其他游戏
> *   折叠@首页
> *   Seti@home
> *   基因组@家

这是来自 Prime95 的压力测试文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-06T23:00:09.377

一个老问题，但我也建议使用 VMWare Workstation。您可以为虚拟机分配更多或更少的资源，并且可以记录/回放机器的执行情况，这样您就可以捕捉到行为中的错误，然后在闲暇时单步执行。

# c# - 是否可以初始化控件的列表 标记中的属性？

> ID：859625
> 
> 赞同：1
> 
> 时间：2009-05-13T18:33:51.887
> 
> 标签：c#, asp.net, webforms, properties, markup

假设我们有以下内容：

```
public enum RenderBehaviors
{
    A,
    B,
    C,
}

public class MyControl : Control
{
    public List<RenderBehaviors> Behaviors { get; set; }

    protected override void Render(HtmlTextWriter writer)
    {
        // output different markup based on behaviors that are set
    }
} 
```

是否可以在 ASPX/ASCX 标记中初始化 Behaviors 属性？IE：

```
<ns:MyControl runat="server" ID="ctl1" Behaviors="A,B,C" /> 
```

在这种情况下，子类化不是一个选项（行为的实际意图与此示例略有不同）。当我尝试以这种方式初始化属性时，WebForms 会生成解析器错误。相同的问题可以应用于其他列表类型（int、strings）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T21:41:25.433

在进一步研究之后，我发现如果 WebForms 可以找到它，它确实使用了 TypeConverter。类型或属性需要正确装饰，如[相关问题](https://stackoverflow.com/questions/116797/passing-int-array-as-parameter-in-web-user-control)中所述。

我最终实现了类似的东西：

```
public class MyControl : Control
{
    private readonly HashSet<RenderBehaviors> coll = new HashSet<RenderBehaviors>();

    public IEnumerable<RenderBehaviors> Behaviors { get { return coll; } }

    public string BehaviorsList
    {
        get { return string.Join(',', coll.Select(b => b.ToString()).ToArray()); }
        set
        {
            coll.Clear();
            foreach (var b in value.Split(',')
                .Select(s => (RenderBehvaior)Enum.Parse(typeof(RenderBehavior), s)))
            {
                coll.Add(b);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T18:43:07.690

使用标记时，您自己对字符串属性的建议是唯一的解决方案。

# sql-server-2005 - 如何获取 RedGate 数据比较以考虑排序顺序？

> ID：859626
> 
> 赞同：1
> 
> 时间：2009-05-13T18:34:03.963
> 
> 标签：sql-server-2005, sorting, redgate

我正在使用 SQL-Server 2005。

我有一个 dev 和 prod 数据库，其中包含基本相同的数据。当我与 RedGate SQL Data Compare 5 进行比较时，它说只有 4 条记录不同。但是，当我打开表格并查看它们时，它们的排序顺序完全不同。这两个表都没有索引或任何强制排序顺序的东西，我试图确保我的开发人员按照与产品相同的顺序进行排序。但 RedGate 不会告诉我何时关闭，因为它显然正在寻找匹配的记录，即使它们的排序顺序不同。我该如何覆盖它？

我想使用该工具来判断我何时确定了排序顺序，以确保我做对了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T19:47:31.483

不同的排序顺序只是意味着行以物理上不同的方式放置在数据文件中，但数据仍然完全匹配，因此 DC 仍然报告它们匹配。没有选项可以将其设置为“尊重物理磁盘顺序”（这本质上就是您要问的），因为即使它注意到了差异，也无法同步差异，因为 SQL Server 没有控制修改的方法磁盘顺序。

不应该依赖查询表时从磁盘中提取数据的顺序 - 如果您需要特定顺序，则应在查询中包含“ORDER BY”子句以强制特定排序顺序。如果出于某种原因不能使用 ORDER BY，则强制特定排序顺序的唯一其他选择是在要对表进行排序的字段上添加聚集索引。

如果您确实需要重新排序数据，那么您需要截断“错误”的表并使用“INSERT INTO [bad order table] SELECT * FROM [good order table]”填充它。即使那样，虽然它应该具有预期的效果，但不能保证。

我建议将 order by 条款作为您的最佳选择。如果有原因这些选项都不起作用，请告诉我，我可以尝试提出其他建议。

# java - java servlet：具有唯一索引'XAK1timItem'的对象中的重复键行

> ID：859631
> 
> 赞同：0
> 
> 时间：2009-05-13T18:34:55.613
> 
> 标签：java, sql-server, servlets

我已经编写了这个 java servlet，它将项目插入到表中，但是它失败了。我认为这可能是由于我的插入和删除使我遇到了一些麻烦。java servlet 在 sql server 中运行一个插入语句。在我的错误日志中，它说：

```
com.microsoft.sqlserver.jdbc.sqlserverexception: cannot insert duplicate key row in object 'dbo.timitem' with unique index 'XAK1timitem'. 
```

有任何想法吗？

更新：我发现有一个名为“XAK1timItem (Unique, Non-Clustered)”的索引，我不确定如何处理..希望这有助于解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T19:24:20.010

唯一索引将强制索引中包含的行组合的唯一性。因此，如果您在数据库中有一行，对于索引列，其值等于您尝试插入的值，您将从数据库中收到错误消息。

**AK**部分表示这是**一个**替代键，这可能意味着该表具有常规主键，并且不需要依赖 AK 来唯一标识行。

 **一些选项：

*   如果不需要，删除索引
*   将另一列添加到唯一索引
*   使索引不唯一，以便允许重复值
*   检查是否已经有一行与您要插入的行匹配并中止插入，但我想您不想这样做

# visual-studio-2008 - Visual Studio - <% %> 的快捷键或片段

> ID：859632
> 
> 赞同：0
> 
> 时间：2009-05-13T18:35:01.760
> 
> 标签：visual-studio-2008, keyboard-shortcuts, code-snippets

我的目标是能够快速输入：

```
<%= %> 
```

任何人都可以提出一种方法来更容易地在 Visual Studio 中插入 HTML 代码转义块。（我什至不确定这段代码的名称！）

我意识到`<%`在代码编辑器中输入会为我自动完成转义块，但也许有更简单的方法来输入这个块？

也许在 Visual Studio 中内置了一个片段或现有的组合键来完成此操作？

更进一步，这也很好：

```
<%= Html.Encode() %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:07:12.363

即使您创建了一个片段来执行此操作，鉴于 VS 会自动匹配，输入片段会比实际键入 3 个字符更多的击键吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T18:40:50.800

创建一个片段并使用 Ctrl-K、Ctrl-X(VS 2005)，这将让您选择片段！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T18:54:08.890

抱歉，似乎代码片段不适用于 ASP.Net 标记。

从这[个人](http://blog.einbu.no/2009/04/whats-so-cool-about-code-snippets/)

> 代码片段在 VS2008 中可用于 C#、XML 和 VB.NET 文件。在 VS2010 中，该支持也扩展到了 ASP.NET 标记。

# c - 指向数组/指针数组的C指针消歧

> ID：859634
> 
> 赞同：494
> 
> 时间：2009-05-13T18:35:12.650
> 
> 标签：c, arrays, pointers, variable-declaration

以下声明之间有什么区别：

```
int* arr1[8];
int (*arr2)[8];
int *(arr3[8]); 
```

理解更复杂的声明的一般规则是什么？

* * *

## 回答 #1

> 赞同：462
> 
> 时间：2009-05-13T18:37:30.057

```
int* arr[8]; // An array of int pointers.
int (*arr)[8]; // A pointer to an array of integers 
```

第三个和第一个一样。

一般规则是[运算符优先级](http://unixwiz.net/techtips/reading-cdecl.html)。随着函数指针的出现，它会变得更加复杂。

* * *

## 回答 #2

> 赞同：270
> 
> 时间：2009-05-13T18:44:59.733

按照 K&R 的建议，使用[cdecl](http://cdecl.org/)程序。

```
$ cdecl
Type `help' or `?' for help
cdecl> explain int* arr1[8];
declare arr1 as array 8 of pointer to int
cdecl> explain int (*arr2)[8]
declare arr2 as pointer to array 8 of int
cdecl> explain int *(arr3[8])
declare arr3 as array 8 of pointer to int
cdecl> 
```

它也以另一种方式工作。

```
cdecl> declare x as pointer to function(void) returning pointer to float
float *(*x)(void ) 
```

* * *

## 回答 #3

> 赞同：129
> 
> 时间：2009-05-13T18:41:48.613

我不知道它是否有正式名称，但我称它为 Right-Left Thingy(TM)。

从变量开始，然后向右、向左、向右……以此类推。

```
int* arr1[8]; 
```

*`arr1`是一个由 8 个指向整数的指针组成的数组。*

```
int (*arr2)[8]; 
```

*`arr2`是一个指向 8 个整数数组的指针（括号在左右两边）。*

```
int *(arr3[8]); 
```

*`arr3`是一个由 8 个指向整数的指针组成的数组。*

这应该可以帮助您完成复杂的声明。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2011-03-02T08:03:18.593

```
int *a[4]; // Array of 4 pointers to int

int (*a)[4]; //a is a pointer to an integer array of size 4

int (*a[8])[5]; //a is an array of pointers to integer array of size 5 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2010-03-30T09:40:55.997

最后两个的答案也可以从 C 中的黄金法则中推导出来：

> 声明遵循使用。

`int (*arr2)[8];`

如果取消引用会发生什么`arr2`？你得到一个由 8 个整数组成的数组。

`int *(arr3[8]);`

如果从 中获取元素会发生什么`arr3`？你得到一个指向整数的指针。

这在处理指向函数的指针时也很有帮助。以 sigjuice 为例：

`float *(*x)(void )`

当你取消引用时会发生什么`x`？你得到一个可以不带参数调用的函数。当你调用它时会发生什么？它将返回一个指向 a 的指针`float`。

不过，运算符优先级总是很棘手。但是，使用括号实际上也可能令人困惑，因为声明遵循使用。至少，对我来说，直观上`arr2`看起来像是一个由 8 个指向 int 的指针组成的数组，但实际上恰恰相反。只是需要一些时间来适应。如果你问我，有足够的理由总是对这些声明添加评论:)

**编辑：示例**

顺便说一句，我偶然发现了以下情况：一个具有静态矩阵并使用指针算术来查看行指针是否超出范围的函数。例子：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define NUM_ELEM(ar) (sizeof(ar) / sizeof((ar)[0]))

int *
put_off(const int newrow[2])
{
    static int mymatrix[3][2];
    static int (*rowp)[2] = mymatrix;
    int (* const border)[] = mymatrix + NUM_ELEM(mymatrix);

    memcpy(rowp, newrow, sizeof(*rowp));
    rowp += 1;
    if (rowp == border) {
        rowp = mymatrix;
    }

    return *rowp;
}

int
main(int argc, char *argv[])
{
    int i = 0;
    int row[2] = {0, 1};
    int *rout;

    for (i = 0; i &lt; 6; i++) {
        row[0] = i;
        row[1] += i;
        rout = put_off(row);
        printf("%d (%p): [%d, %d]\n", i, (void *) rout, rout[0], rout[1]);
    }

    return 0;
} 
```

输出：

```
0 (0x804a02c): [0, 0]
1 (0x804a034): [0, 0]
2 (0x804a024): [0, 1]
3 (0x804a02c): [1, 2]
4 (0x804a034): [2, 4]
5 (0x804a024): [3, 7] 
```

请注意，边框的值永远不会改变，因此编译器可以优化它。这与您最初可能想要使用的不同: `const int (*border)[3]`: 将边界声明为指向 3 个整数数组的指针，只要变量存在，该数组就不会改变值。但是，该指针可以随时指向任何其他此类数组。相反，我们希望参数具有这种行为（因为此函数不会更改任何这些整数）。声明遵循使用。

（ps：请随时改进此示例！）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-08-14T17:51:34.160

```
typedef int (*PointerToIntArray)[];
typedef int *ArrayOfIntPointers[]; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-09-19T13:34:06.017

根据经验，右一元运算符（如`[]`、`()`等）优先于左一元运算符。因此，`int *(*ptr)()[];`将是一个指向函数的指针，该函数返回指向 int 的指针数组（离开括号后尽快获取正确的运算符）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-07-09T15:04:34.017

我认为我们可以使用简单的规则..

```
example int * (*ptr)()[];
start from ptr 
```

“`ptr`是指向“向右移动..它的”）的指针现在向左移动它的一个“（”出来向右移动“（）”所以“指向一个不带参数的函数”向左“并返回一个指针”去向右“数组”向左“整数”

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-10-11T18:52:17.780

以下是我的解释：

```
int *something[n]; 
```

> 注意优先级：数组下标运算符 ( `[]`) 的优先级高于取消引用运算符 ( `*`)。

因此，在这里我们将应用`[]`before `*`，使语句等效于：

```
int *(something[i]); 
```

> 注意声明的意义：`int num`手段*`num`是一个`int`*，`int *ptr`或`int (*ptr)`手段，（价值在`ptr`）是一个`int`，它使`ptr`一个指针指向`int`。

这可以读作，（（某物的第 i 个索引处的值）的值）是一个整数。因此，（某事物的第 i 个索引处的值）是一个（整数指针），它使某事物成为整数指针数组。

在第二个中，

```
int (*something)[n]; 
```

为了理解这个陈述，你必须熟悉这个事实：

> 关于数组指针表示的注意事项：`somethingElse[i]`相当于`*(somethingElse + i)`

因此，替换`somethingElse`为`(*something)`，我们得到`*(*something + i)`，根据声明，它是一个整数。所以，`(*something)`给我们一个数组，它相当于*(pointer to an array)*。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-08-22T19:51:14.243

这是一个有趣的网站，它解释了如何在 C 中读取复杂类型： [http ://www.unixwiz.net/techtips/reading-cdecl.html](http://www.unixwiz.net/techtips/reading-cdecl.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-12T11:46:19.940

我想第二个声明让很多人感到困惑。这是一个简单的方法来理解它。

让我们有一个整数数组，即`int B[8]`.

让我们还有一个指向 B 的变量 A。现在，A 处的值是 B，即`(*A) == B`。因此 A 指向一个整数数组。在您的问题中， arr 类似于 A。

同样，在 中`int* (*C) [8]`，C 是指向整数指针数组的指针。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-05-31T03:17:14.210

```
int *arr1[5] 
```

在此声明中，`arr1`是一个由 5 个指向整数的指针组成的数组。原因：方括号的优先级高于 *（取消引用运算符）。在这种类型中，行数是固定的（这里是 5），但列数是可变的。

```
int (*arr2)[5] 
```

在此声明中，`arr2`是一个指向 5 个元素的整数数组的指针。原因：这里，() 括号的优先级高于 []。在这种类型中，行数是可变的，但列数是固定的（这里是 5）。

* * *

## 回答 #13

> 赞同：-9
> 
> 时间：2013-03-31T14:41:58.040

在指向整数的指针中，如果指针递增，则它进入下一个整数。

在指针数组中，如果指针递增，则跳转到下一个数组

# php - 使 MySQL 向后返回表

> ID：859642
> 
> 赞同：0
> 
> 时间：2009-05-13T18:36:15.863
> 
> 标签：php, mysql

我想使用 PHP 和 MySQL 制作一个简单的新闻系统，现在我有一个工作帖子和阅读系统，但只有一个问题，我希望它显示 10 个最新新闻，但它显示 10 个最旧的新闻。

我的问题是：有没有办法让 MySQL 从表的底部返回结果，还是我必须先获取帖子的数量，然后将其限制为最后 10 个？

这是插入（标题和文本被转义，时间是时间（），海报还没有完成）：

```
mysql_query("INSERT INTO news (title, poster, text, time) VALUES ('$newstitle', '1', '$newstext', '$time')") or die(mysql_error()); 
```

并检索它（addnews 回应它）：

```
$myqr = mysql_query('SELECT * FROM news LIMIT 10') or die("Error running news query: ". mysql_error());
while($myres = mysql_fetch_array($myqr))
{
addnews($myres['id'], $myres['title'], "admin", date('l jS F Y - H:i:s', $myres['time']), $myres['text']);
} 
```

所以，简而言之：我想向后读取数据库，有可能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-13T18:38:57.230

查看[ORDER BY](http://dev.mysql.com/doc/refman/5.0/en/sorting-rows.html)子句。它允许您按列按升序或降序对行进行排序。以下查询将返回 10 条新闻，按时间降序排列。

```
SELECT * FROM news ORDER BY time DESC LIMIT 10 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T18:38:44.437

很简单，只需在 SQL 中添加“ORDER BY”子句，例如

```
SELECT * FROM news ORDER BY time DESC LIMIT 10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T18:39:23.593

您需要修改查询以按创建日期排序。就像是

```
SELECT * FROM news  order by time DESC LIMIT 10 
```

应该为你工作。我认为值得注意的是，如果您不指定 Order by 子句，则无法保证返回结果的顺序。现在，您碰巧在它们按升序插入时对它们进行排序，但是您不能安全地假设情况总是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T18:39:25.513

假设 id 是主键：

```
SELECT * FROM new ORDER BY id DESC LIMIT 10 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T18:39:35.247

使用 ORDER BY 子句。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T18:39:39.647

你不能简单地在 LIMIT 10 之前按时间降序排序吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T18:42:13.323

采用

```
SELECT * FROM news ORDER BY time DESC LIMIT 10 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T18:48:04.797

你也可以使用

```
SELECT TOP 10 FROM news ORDER BY time DESC 
```

我相信。不过，不确定“top”子句是否仅适用于 SQL Server。

# whitespace - WML 预期的空白错误

> ID：859646
> 
> 赞同：0
> 
> 时间：2009-05-13T18:36:30.353
> 
> 标签：whitespace, wml

我正在使用 XSLT 将 XML 文件转换为 WML。一切都很好，直到我尝试在 M3Gate 中打开 WML。它给出了错误“错误的 WML 语法。'致命错误。Ln 1, Col 38 Expected whitespace'。”

这是有问题的代码。但是，我尝试过移动东西，它给出了同样的错误。

```
<?xml version="1.0" encoding="UTF-16"?> 

    <wml>

        <card id=...> 
```

这是我缺少的一些晦涩的问题吗？我已经将它与我之前制作的 WML 进行了比较，第一行完全相同。

它在 Opera Web 浏览器中完美运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T12:56:30.287

傻我。Opera 浏览器忽略了没有 DOCTYPE 声明的事实，但是 M3Gate 会生成这个模糊的错误消息。将以下内容添加到您的代码中，在 xsl:stylsheet 元素下方

```
<xsl:output method="xml" doctype-system="http://www.wapforum.org/DTD/wml_1.1.xml" 
doctype-public="-//WAPFORUM//DTD WML 1.1//EN"/> 
```

# security - 浏览器/POST 和浏览器/工件 SAML 配置文件的便捷应用程序

> ID：859652
> 
> 赞同：4
> 
> 时间：2009-05-13T18:37:49.977
> 
> 标签：security, weblogic, single-sign-on, saml

我提议使用 SAML 1.1 作为在客户环境中证明 Web SSO 的技术，他们问了我一些有趣的问题：

**哪个场景浏览器/POST 配置文件是合适的，哪些场景浏览器/SAML 的工件配置文件是合适的？**

事实上，[SAML 1.1 规范](http://saml.xml.org/saml-specifications)并没有谈论两种浏览器配置文件的最佳或最合适的方案。

也许每个人的安全威胁都可以用来挑选最好的。在我看来，到目前为止，两者都可以平等地应用于任何场景。

*注意：该解决方案使用 Weblogic Server 10.0 及其对 SAML 1.1 的支持。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T18:55:19.403

在我看来，这两个配置文件都提供了相似的安全级别。使用 POST 配置文件，用户必须明确启动 POST。这可能有助于阻止类似于 CSRF 攻击的某些事情，但我不知道任何实际的漏洞利用。Artifact 配置文件使用 GET 方法，可以为用户提供更无缝的体验。

对我来说，Artifact 配置文件的缺点是打开后通道的复杂性。我的应用程序服务器专门有一个线程来处理用户请求，如果该线程被阻塞（等待反向通道 IO 完成）很长时间，则应用程序服务器开始表现得很差。因此，必须非常小心地执行反向通道通信，以确保它在定义的时间段后超时。

即使这样，如果 IdP 出现故障，对我的用户来说，问题出在 IdP 上的情况并不明显。使用 POST 配置文件，如果 IdP 行为不端，用户不太可能责怪我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-10T18:04:07.620

在安全性方面，主要区别在于，使用 POST 配置文件，SAML 响应（包含断言）通过最终用户的浏览器传输，因此它必须至少经过签名，并且可能加密，如果有什么你不会希望最终用户能够看到。

借助工件配置文件，您可以使用 SSL 保护反向通道并发送未签名、未加密的断言，因为它直接从 IdP 传递到 SP。不过，您可能仍希望签署不可否认的断言。

然而，正如 Erickson 所提到的，建立从 SP 到 IdP 的出站“反向通道”连接也有其自身的挑战。由于这个原因，我见过的大多数 SAML 部署都使用 POST。

顺便说一句 - 您使用 SAML 1.1 而不是 2.0 的任何原因？

# svn - 组织一个包含数千个元素的 Subversion 存储库

> ID：859659
> 
> 赞同：2
> 
> 时间：2009-05-13T18:38:54.017
> 
> 标签：svn, code-organization, rcs, svn-organization

开始之前：我在许多论坛（包括 Stack Overflow - 是的，有很多关于组织 svn 的 SO 问题）、搜索 Google 和阅读文档（我拥有几本 Subversion 书籍）都花了很长时间。我还没有找到在 Subversion 中组织代码库的好方法。我们目前使用 RCS 作为我们的修订控制系统，*所有内容*都存储在 1 个 RCS 目录中 - 我知道这很丑 - 这就是为什么我正在努力实现更好的东西。我也经常使用 Subversion，所以我知道它的功能以及它是如何工作的。几个月来我一直在犹豫问这个问题，因为它不完全与编程相关，但由于我无法找到解决方案，还有什么更好的地方来问我的问题！

在我脑海中使事情复杂化的是颠覆术语“项目”。如果我想在 subversion 中管理一个 java 项目，这对我来说非常有意义：所有组合成一个 jar 文件的 java 文件都可以被认为是一个“项目”——它们都属于一起。但是，在我们的环境中，我看不到定义什么是“项目”的简单方法。我们有超过 4,000 个程序，而且它们几乎都是相互独立的。其中许多是 shell 脚本或 perl 脚本。我们的一些脚本使用通用的“实用程序”或“库”脚本，但在大多数情况下，所有代码对象都是独立的。

我们环境中的一个“项目”可能涉及程序 A、B 和 C，以及配置文件 AA。另一个项目可以使用程序 C、D 和 E，以及配置文件 BB。另一个项目可能只是更改配置文件 AA，或者可能是程序 B。没有办法对哪些程序或文件属于一个组进行分类。正因为如此——我不知道如何将我们的代码组织成颠覆。我可以将所有内容都放入主项目主干中，但检查工作副本意味着检查所有 4,000 多个元素。

给出一些上下文，这是针对数据仓库的。需要所有 4,000 多个代码元素才能使仓库发挥作用。也许某个业务需求需要更改在一些元素中访问的列，而另一个业务需求需要更改一些其他元素（可能与其他项目中的一些相同）。

也许 Subversion 不是最适合我们的，尽管我必须相信它可以工作。我们已经为我们的 Web 代码和 Java 程序提供了一个 Subversion 服务器，它工作得很好，因为有很容易定义的项目。我只是不知道如何组织我们的主要代码库。

希望其中一些有意义......提前感谢您的智慧！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:12:11.920

您可能会查看[externals](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.advanced.externals)属性。它允许您定义该属性附加到的目录的检出，还将存储库中的其他位置检出到该目录的子目录。

因此，您可以为每个组件创建“真实”目录，然后为每个项目创建单独的目录，该目录将使用外部组件来检出所需组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T18:59:08.943

在将文件转储到颠覆存储库之前，我会尝试组织文件的文件夹结构。

我认为您的问题主要在于现有文件的杂乱无章。如果您能找到一种方法将您的系统在逻辑上划分为多个部分，那么允许人们只检查文件块（将在逻辑分组中）会更容易。

Subversion 确实反映了一个文件系统，所以如果它在文件系统中看起来不漂亮，那么它在 subversion 中也不会看起来漂亮。

如果您想避免重新组织文件，也许您可​​以找到一个版本控制系统，它可以让您根据标签签入/签出内容，而不是它们在文件系统中的位置。

# windows-sbs - Windows Small Business Server 2008 - 本地管理员密码

> ID：859666
> 
> 赞同：1
> 
> 时间：2009-05-13T18:39:38.057
> 
> 标签：windows-sbs

我正在运行 Windows SBS2008，现在我需要更改本地管理员密码。与 Windows 2000-2003 服务器一样，在服务器管理中，我能够更改本地用户和组中的管理员密码。目前，该功能未列出。我在哪里可以找到该功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T18:57:28.027

有趣...在我的 Server 2008 中，我将它列在您说的位置（服务器管理器->配置->本地用户和组）...但是，有几种方法可以访问它，最好的方法是推荐是通过mmc。

一步步：

1.  赢+R
2.  输入“mmc”，回车
3.  文件->添加/删除管理单元...
4.  滚动到“可用的管理单元：”框中的本地用户和组。
5.  单击“添加>”按钮。
6.  选择本地计算机，然后单击“完成”按钮。
7.  单击“确定”按钮。
8.  照常使用。

如果您有任何问题，请告诉我。

PS 也许这是一个更适合[ServerFault](http://www.serverfault.com)的问题？

# c# - C# WinForm Controls > Forms 控件循环浏览记录？

> ID：859677
> 
> 赞同：0
> 
> 时间：2009-05-13T18:42:10.657
> 
> 标签：c#, winforms, controls

大家好。老实说，我不喜欢将 MS Access 作为关系数据库管理系统 (RDBMS)。除了在 Access 的表单视图部分中，它在右下角/左下角（分别）有前进/跳到结尾和后退/跳到开头按钮。

我希望用我的 XML 编辑表单在 C# 中模仿该功能。是否已经有执行此操作的表单控件（免费提供）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:24:18.310

我认为您正在寻找已包含的 BindingNavigator 控件。

你还没有说你正在运行什么版本的 Visual Studio。这个答案假设 VS2008。VS2K5 中有一个类似的控件，但这个名字现在让我忘记了，我不再在我的任何 PC 上运行 VS2K5。

# batch-file - 向从批处理文件开始的窗口/进程发出命令

> ID：859680
> 
> 赞同：0
> 
> 时间：2009-05-13T18:42:14.480
> 
> 标签：batch-file, cygwin

我想将命令传递给在批处理文件中启动的进程，特别是 Cygwin。例如，如果我使用以下内容启动 Cygwin：

```
start "window1" cmd.exe /c cygwin 
```

我如何在“window1”中执行“ls”，在我启动 Cygwin 的同一个批处理文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T20:40:39.713

我不得不问你为什么要从批处理文件中运行命令？您想根据命令的结果/输出采取不同的行动吗？

在任何一种情况下，您所要求的几乎都是不可能的。为什么不简单地在 bash 脚本中编写逻辑并运行

`start "window1" cmd.exe /c c:\cygwin\bin\bash.exe -c [script]`

其中 [script] 是 bash 脚本的路径。

有关 bash 脚本的文档可在[http://tldp.org/LDP/abs/html/获得](http://tldp.org/LDP/abs/html/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T19:01:15.493

如果您没有 cmd arg 到 cygwin 以在启动时执行命令（例如 cmd.exe /K 或 /C），您可以使用[AutoHotKey](http://www.autohotkey.com)之类的脚本自动执行此类操作。

# c - 当只有一个线程写入共享变量时，我需要锁吗？

> ID：859690
> 
> 赞同：11
> 
> 时间：2009-05-13T18:44:34.460
> 
> 标签：c, multithreading, locking, mutex

我有 2 个线程和一个共享的`float`全局线程。一个线程只写入变量，而另一个只读取变量，我是否需要锁定对该变量的访问？换句话说：

```
volatile float x;

void reader_thread() {
    while (1) {
        // Grab mutex here?
        float local_x = x;
        // Release mutex?
        do_stuff_with_value(local_x);
    }
}

void writer_thread() {
    while (1) {
        float local_x = get_new_value_from_somewhere();
        // Grab mutex here?
        x = local_x;
        // Release mutex?
    }
} 
```

我主要担心的是加载或存储不是原子的`float`，这样最终会得到一个虚假的、部分更新的值。`local_x``reader_thread`

1.  这是一个有效的担忧吗？
2.  有没有另一种方法来保证没有互斥锁的原子性？
3.  `sig_atomic_t`假设它有足够的位用于我的目的，是否可以用作共享变量？

有问题的语言是使用 pthreads 的 C。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-13T19:02:37.410

不同的架构有不同的规则，但总的来说，对齐的、`int`大小的对象的内存加载和存储是原子的。越来越小可能会有问题。因此，如果`sizeof(float) == sizeof(int)`您可能是安全的，但我仍然不会在可移植程序中依赖它。

此外， 的行为`volatile`也不是特别明确......规范使用它作为一种防止优化访问内存映射设备 I/O 的方法，但没有说明它在任何其他内存访问上的行为。

简而言之，即使加载和存储`float x`在`volatile`. 如果不保证加载和存储是原子的，您将*不得不*使用锁，这确实意味着内存屏障。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T19:09:40.580

根据 GNU C 库文档的第 24.4.7.2 节：

> 在实践中，您可以假设它`int`和其他整数类型不再`int`是原子的。你也可以假设指针类型是原子的；这很方便。这两个假设在 GNU C 库支持的所有机器和我们知道的所有 POSIX 系统上都是正确的。

`float`技术上不计入这些规则，尽管如果 a与架构上的 a`float`大小相同`int`，您可以做的是使您的全局变量 an `int`，然后在每次读取或写入时将其转换为带有联合的浮点数.

最安全的做法是使用某种形式的互斥锁来保护对共享变量的访问。由于关键部分非常小（读取/写入单个变量），因此您几乎可以肯定会从自旋锁等轻量级互斥锁中获得更好的性能，而不是使系统呼吁做它的工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T18:54:00.763

我会把它锁起来。我不确定`float`您的环境中有多大，但它可能不会在单个指令中读取/写入，因此您的读者可能会读取一半写入的值。请记住，这`volatile`并没有说明操作的原子性，它只是说明读取将来自*内存*，而不是缓存在寄存器或类似的东西中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-13T19:16:02.240

分配不是原子的，至少对于某些编译器而言，并且在某种意义上它需要一条指令来执行。以下代码由 Visual C++ 6.0 生成 - f1 和 f2 是浮点类型。

```
4:        f2 =  f1;
00401036   mov         eax,dword ptr [ebp-4]
00401039   mov         dword ptr [ebp-8],eax 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T19:03:51.213

~~我相信你应该使用互斥锁。有一天，您的代码可能会在没有真正浮点硬件并使用仿真的系统上运行，从而导致非原子浮点变量。例如，请查看 -msoft-float [here](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/ARM-Options.html)。~~

 ~~我的回答不是很有用。 `gcc -msoft-float`可能只是浮动的加载和存储不是原子的特定情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T18:48:42.660

由于它是内存中的一个单词，因此您正在更改您应该只使用 volatile 声明就可以了。

我认为您不能保证您在阅读时会获得最新的价值，除非您使用锁。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T19:16:37.310

很可能，没有。由于你没有写冲突的机会，唯一关心的是你是否可以在它写到一半的时候阅读它。如果您使用线程编写某些东西，那么您的代码极不可能在单个操作中不会发生写入浮点数的平台上运行。

然而，这是*可能*的，因为 C 中浮点数的定义并不要求底层硬件存储限于处理器的字长。您可能正在编译为机器代码，例如，符号和尾数是用两种不同的操作编写的。

我认为真正的问题是两个问题：“在这里使用互斥锁有什么缺点？” 和“如果我被垃圾读了会有什么影响？”

也许您应该编写一个断言而不是互斥锁来确定浮点数的存储大小是否小于或等于底层 CPU 的字大小。

# java - 一种快速确定是否在 JPanel 中找到组件的方法

> ID：859691
> 
> 赞同：8
> 
> 时间：2009-05-13T18:44:35.163
> 
> 标签：java, swing

我可以知道如何确定是否在 JPanel 中找到了组件吗？

```
boolean isThisComponentFoundInJPanel(Component c)
{
    Component[] components = jPanel.getComponents();
    for (Component component : components) {
        if (c== component) {
                return true;
        }
    }
    return false;
} 
```

使用循环效率不高。有没有更好的办法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-13T18:51:08.130

```
if (c.getParent() == jPanel) 
```

如果您不想要直接的父子关系（在精心设计的面板中可能就是这种情况），请递归调用。

...尽管在精心设计的面板中，为什么您需要知道面板中是否包含组件是非常值得怀疑的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-13T18:57:22.363

您可以使用

```
jPanel.isAncestorOf(component) 
```

用于递归搜索

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T18:52:28.237

此操作的性能极不可能成为瓶颈。

查看容器的内容可能表明设计不佳。告诉 GUI 做什么，不要询问它的状态。

编写代码的更好方法可能是使用现有例程。虽然有一些开销，但它们更有可能已经编译（因此可能更快）并且代码更少。

```
boolean isComponentInPanel(Component component) {
    return
        java.util.Arrays.asList(panel.getComponents())
            .contains(component);
} 
```

（或使用 kdgregory 的答案。）

# c# - 如何在单独的文件夹中添加资源？

> ID：859699
> 
> 赞同：9
> 
> 时间：2009-05-13T18:46:25.597
> 
> 标签：c#, visual-studio, visual-studio-express

当我尝试通过单击“添加现有项目”在资源设计器中添加资源时，该项目被放置在“资源”文件夹中。

问题是，如果我在 Resource 目录中创建一个新目录并将资源放在那里，我会收到一个编译器错误，即找不到文件。

我不能将所有资源放在一个文件夹中，因为我必须添加 2500 张图像，其中一些与它们的名称匹配。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T18:51:44.777

您不需要在 Resources 文件夹下添加图像。您可以将图像添加到您希望的任何文件夹，然后将图像的构建操作设置为“嵌入式资源”。这样，它们将作为资源编译到程序集中。我不知道当它是大量图像时是否会出现性能问题......

更新：更详细：

1.  将文件夹和图像文件作为项目项添加到项目中（以便您可以在解决方案资源管理器中查看每个文件夹和其中的图像）
2.  将每个图像文件的 Build Action 属性设置为“嵌入式资源”（您可以同时对多个文件执行此操作；只需在解决方案资源管理器中选择所有图像文件）。

这将导致图像文件作为资源编译到程序集中。每个文件都将按照以下模式分配一个资源名称：`<root namespace for the assembly>.<folder name>.<image file name>`. 您可以使用以下代码加载图像：

```
using(Stream stream = Assembly.GetExecutingAssembly().GetManifestResourceStream("<root namespace for the assembly>.<folder name>.<image file name>"))
{
    pictureBox1.Image = Image.FromStream(stream);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T19:06:58.447

创建一个新的资源文件（在下面的示例中，我在 resx 文件夹中将其命名为 Images01） 创建一个自定义资源管理器类并将其初始化为指向刚刚创建的该文件

```
ResourceManager rm = new ResourceManager("ROOTNAMESPACE.resx.Images01", 
                                     System.Reflection.Assembly.GetExecutingAssembly()); 
```

实现GetImage的方法

```
 public static Image GetImage(string fileName)
    {
        Stream stream = GetResourceStream(fileName);

        Image image = null;
        if (stream != null)
        {
            image = Image.FromStream(stream);
        }

        return image;
    } 
```

将图像添加到此 resx 文件

然后你可以在你的代码中使用它，如下所示

```
this.picProject.Image = Resources.GetImage("ImageName.png"); 
```

希望能帮助到你

# java - 在Android中响应本地http请求

> ID：859702
> 
> 赞同：2
> 
> 时间：2009-05-13T18:46:49.230
> 
> 标签：java, android, http-proxy

我有一个应用程序从服务器请求媒体流，但是请求需要包含 cookie，否则服务器会返回 500 错误。MediaPlayer 没有将 cookie 与 URI 请求一起发送的功能。

我的解决方法是让 Android 代理请求。我会让 MediaPlayer 向 localhost ( [http://localhost/?ID=1](http://localhost/?ID=1) ) 发出请求，然后我会让一个小型代理应用程序连同 cookie 一起发出请求并返回媒体流。

我的问题是我将如何制作代理端？如何让我的应用程序在 localhost 上为 http 请求设置一个侦听器？

我不需要写完整的代码来说明如何做到这一点，只需一些简单的类名和示例代码即可显示如何让 android 应用程序监听来自媒体播放器的请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T19:59:19.207

我是否能够创建自定义意图并将 URI 传递给该意图，即 (cookieplayer://songid1) 并让 MediaPlayer 播放返回的流？

# c# - 实体框架 - 分层设计 - 将连接字符串放在哪里？

> ID：859709
> 
> 赞同：8
> 
> 时间：2009-05-13T18:48:34.623
> 
> 标签：c#, entity-framework, data-access-layer, n-tier-architecture

我使用带有实体框架的分层架构作为我的数据层，顶部有一堆存储库，其中包含 Linq-To-Entities 查询。数据层是一个项目，接下来我有一个服务层和界面，它是一个网站。

我希望我的网站负责为我的实体模型指定连接字符串。我该怎么做呢？

我正在使用单例方法访问位于数据层内的实体存储库。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T19:20:38.567

您可以将在 DAL 程序集的 App.Config 中创建的连接字符串复制到 web.config 的 connectionStrings 部分。

您可以将连接字符串保留在程序集 dll 中，但不应将其与网站一起部署。

您将需要复制整个连接字符串。它应该如下所示：

```
<add name="DataEntities" connectionString="metadata=res://*/DataModel.csdl|res://*/DataModel.ssdl|res://*/DataModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=xxx;Initial Catalog=xxx;User Id=xxx;Password=xxx;MultipleActiveResultSets=True&quot;" providerName="System.Data.EntityClient" /> 
```

它应该包括有关映射文件所在位置的所有信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T19:02:46.473

就我而言，虽然我使用的是 L2S 而不是 L2E，但建议应该成立。我有一个从 XML 文件提供的通用配置库。当需要数据上下文时，每个数据对象都有如下方法。当然，如果您愿意，它可以很容易地被模板化。

```
private static string _conStr = null;
private static CalendarsAndListsDataContext GetDataContext()
{
    if (_conStr == null)
    {
        _conStr = ConfigurationLibrary.Config.Settings().GetConnectionString("liveConString");
    }

    return new CalendarsAndListsDataContext(_conStr);
} 
```

现在，最大的缺点是连接字符串更改需要重新启动应用程序，但就我而言，这不是问题。

# .net - System.Data.DataTable 是否有大小限制？

> ID：859710
> 
> 赞同：1
> 
> 时间：2009-05-13T18:48:35.560
> 
> 标签：.net, datatable

我正在向我的数据表中添加数据行，但数据表中的行数没有增加。似乎是表大小或数据行数的限制。

仅供参考，.net 2.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T18:53:14.617

[单击此处](http://msdn.microsoft.com/en-us/library/system.data.datatable(VS.80).aspx)查看数据表类型的限制。16,777,216 是最大记录数。

# moss - 如何删除标题中包含阿拉伯字符的共享点组？

> ID：859719
> 
> 赞同：2
> 
> 时间：2009-05-13T18:50:42.373
> 
> 标签：moss, wss, stsadm

我有一个标题中有阿拉伯字符的共享点组。该网站已被删除，我需要删除该组。当我使用 GUI 时，我收到以下错误消息：

> 错误代码：500 内部服务器错误。服务器拒绝了指定的统一资源定位符 (URL)。请联系服务器管理员。(12202)

当我使用时，`stsadm -o enumgroups`我将其作为组名：

```
<Name>Blah blah -- ????? ??????? ????????? Members</Name> 
```

`stsadm -o deletegroup -name "Blah blah -- ????? ??????? ????????? Members" -url http://myurl.com`返回：

> 找不到组。

我知道组 ID，我可以在我的删除请求中使用它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T18:55:18.000

我会使用控制台应用程序来探索该组，（查看其中是否有您需要保留的任何信息）然后将其删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T19:16:28.497

请记住，这也`deletegroup`需要站点 URL。在这种情况下，我认为您将不得不使用 OM - 您可以使用该`SPGroupCollection.RemoveByID()`方法来这样做。

# xslt - xslt apply-templates 选择所有剩余的文本节点

> ID：859726
> 
> 赞同：0
> 
> 时间：2009-05-13T18:51:59.563
> 
> 标签：xslt

我有这个简化的 xml：

```
<?xml version="1.0" encoding="UTF-8"?>

<a>
    <b>
        <c>
            <d>1</d>
            <e>2</e>
        </c>
    </b>
    <f>
        <g>3</g>
    </f>
</a> 
```

这是我尝试应用的 xslt：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:fn="http://www.w3.org/2005/xpath-functions">
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

    <xsl:template match="a">
        <xsl:apply-templates />
    </xsl:template>

    <xsl:template match="b">
        <xsl:apply-templates />
    </xsl:template>

    <xsl:template match="c">
        <xsl:apply-templates />
    </xsl:template>

    <xsl:template match="d">

    </xsl:template>

</xsl:stylesheet> 
```

当我应用这张表时，我得到输出 2 3，这是剩余的文本节点。我已经阅读了有关在找不到匹配模板时应用的内置模板，但在这种情况下，它应该找到一个模板吗？

到底是怎么回事？

**编辑：**

在这种情况下，我希望什么也看不到，因为模板是空的。但我得到了 2 3 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T19:22:31.853

当你这样做时`<xsl:template match="d">`，你告诉处理器忽略下面的所有节点`<d>`。

所有其他节点都使用默认规则进行处理，包括`text()`打印文本的规则。

这就是为什么你看到 23，而不是 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T18:53:39.657

从根开始：

```
<xsl:template match="/a"> 
```

并指定一个模式（这样默认模板就不会被调用，因为它*没有*找到`e`,`f`和的模板`g`）或者定义你自己的 * 模板，它在样式表的末尾什么都不做：

```
<xsl:template match="*"/> 
```

# php - 是否有 ZF 知道如何使用的主要 OpenID 提供程序 URI 列表？

> ID：859736
> 
> 赞同：0
> 
> 时间：2009-05-13T18:53:40.637
> 
> 标签：php, zend-framework, openid

是否有 ZF 知道如何使用的主要 OpenID 提供程序 URI 列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T22:13:36.710

由于 OpenID 是一个标准化的开放协议，因此 ZF 的 OpenID 消费者组件可以与任何 OpenID 提供者一起使用。

此外，ZF 实现了一个组件来创建您自己的提供程序。

具体来说，采埃孚[支持](http://framework.zend.com/manual/en/zend.openid.html#zend.openid.introduction.standards)以下 OpenID 标准：

*   OpenID 身份验证协议版本 1.1
*   OpenID Authentication 协议版本 2.0 草案 11
*   OpenID 简单注册扩展 1.0 版
*   OpenID 简单注册扩展版本 1.1 草案 1

因此，任何实现任何身份验证协议（以及可选的任何用于配置文件交换的 SRE）的提供者都可以与 ZF 一起使用。

# c# - 重复文本查找

> ID：859739
> 
> 赞同：4
> 
> 时间：2009-05-13T18:54:16.783
> 
> 标签：c#, c++, text, compression, duplicates

我的主要问题是试图找到一个合适的解决方案来自动转动它，例如：

```
d+c+d+f+d+c+d+f+d+c+d+f+d+c+d+f+ 
```

进入这个：

```
[d+c+d+f+]4 
```

即查找彼此相邻的重复项，然后从这些重复项中制作一个较短的“循环”。到目前为止，我还没有找到合适的解决方案，我期待着回应。PS 为了避免混淆，上述示例并不是唯一需要“循环”的东西，它因文件而异。哦，这适用于 C++ 或 C# 程序，两者都可以，尽管我也愿意接受任何其他建议。此外，主要思想是所有工作都将由程序本身完成，除了文件本身之外没有用户输入。这是完整的文件，供参考，我对拉伸页面表示歉意：#0 @16 v225 y10 w250 t76

l16 $ED $EF $A9 p20,20 >ecegb>d<bgbgecgec<g >d+<b>d+f+a+>c+<a+f+a+f+d+<b>f+d+<bf+ >c <a>cegbgegec<a>ec<ae > d+c+d+f+d+c+d+f+d+c+d+f+d+c+d+f+ r1^1

/ l8 r1r1r1r1 f+<a+>f+g+cg+r4 a+c+a+g+cg+r4f+<a+>f+g+cg+r4 a+c+a+g+cg+r4f+<a+>f +g+cg+r4 a+c+a+g+cg+r4 f+<a+>f+g+cg+r4 a+c+a+g+r4g+16f16c+ a+2^g+f+g+4 f+ff+4fd+f4 d+c+d+4c+c<a+2^4 >c4d+ <g+2^4r4^ a+>c+d+4g+4a+4 r1^2^4^a+ 2^g+f+g+4 f+ff+4fd+f4 d+c+d+4c+c<a+2^4 >c4d+ <g+2^4r4^a+>c+d+4g+4a+ 4 R1 ^ 2 ^ 4 ^ r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1

#4 @22 v250 y10

l8 o3 rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+rg+ / r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1

#2 @4 v155 y10

l8 $ED $F8 $8F o4 r1r1r1 d+4f4f+4g+4 a+4r1^4^2 / d+4^fr2 f+4^fr2d+4^fr2 f+4^fr2d+4^fr2 f+4 ^fr2d+4^fr2 f+4^fr2 > d+4^fr2 f+4^fr2d+4^fr2 f+4^fr2 < f+4^g+r2 f+4^fr2f+4^g+r2 f+4^fr2f+4^g+r2 f+4^fr2f+4^g+r2 f+4^fr2f+4^g+r2 f+4^fr2f+4^g+r2 f+4^fr2f+ 4^g+r2 f+4^fr2f+4^g+r2 f+4^fr2 > a+4^g+r2 f+1a+4^g+r2 f+1 f+4^fr2 d+1 f + 4 ^ FR2 d + 2 ^ d + 4 ^ r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1

#3 @10 v210 y10

R1 ^ 1 O3 c8r8d8r8 c8r8c8r8c8r8c8r8c8r8c8r8c8r8c8r8c8r8c8r8c8r8 C8 @ 10d16d16 @ 21 C8 @ 10d16d16 @ 21 C8 @ 10d16d16 @ 21 / C4 @ 10d8 @ 21c8 <B8> C8 @ 10d8 @ 21c8c4 @ 10d8 @ 21c8 <B8> C8 @ 10d8 @ 21c8c4 @ 10d8 @ 21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8< b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8> c8@10d8@21c8 c4@10d8@21c8<b8> @10d16d16d16d16d16r16 c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d @21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4 @10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@ 10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@ 21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@ 10d8@21c8<b8>c8@10d8@21c8 c4@10d8@21c8 @10b16b16>c16c16<b16b16a16a16c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8 c4@10d8@21c8 @10b16b16>c16c16 <b16b16a16a16c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8c4@10d8@21c8<b8>c8@10d8@21c8 c4@10d8@21c8 @10b16b16>c16c16 <b16b16a16a16

#7 @16 v230 y10

l16 $ED $EF $A9 cceeggbbggeeccee <bb>d+d+f+f+a+a+f+f+d+d+<bb>d+d+ <aa>cceeggeecc<aa>cc <g+g+bb > d + d + + FFD + d <BBG + G + BB / r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1

#5 @4 v155 y10

l8 $ED $F8 $8F o4 r1r1r1r1 d+4r1^2^4 / <a+4^>cr2 c+4^cr2<a+4^>cr2 c+4^cr2<a+4^>cr2 c+ 4^cr2<a+4^>cr2 c+4^cr2 a+4^>cr2 c+4^cr2 <a+4^>cr2 c+4^c r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1 r2 f+4^fr2 d+1f+4 ^ FR2 d + 1 C + 4 ^ CR2 <A + 1> C + 4 ^ CR2 <A + 2 ^一个+ 4 ^ r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1r1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:06:58.713

您可以使用 Smith-Waterman 算法进行局部对齐，将字符串与自身进行比较。

[http://en.wikipedia.org/wiki/Smith-Waterman_algorithm](http://en.wikipedia.org/wiki/Smith-Waterman_algorithm)

编辑：要使算法适应自对齐，您需要将对角线中的值强制为零 - 也就是说，惩罚将整个字符串与自身完全对齐的简单解决方案。然后会弹出“次佳”对齐方式。这将是最长的两个匹配子串。重复同样的事情来找到越来越短的匹配子字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T21:19:50.523

不确定这是否是您正在寻找的。

我将字符串“testtesttesttest4notaduped+c+d+f+d+c+d+f+d+c+d+f+d+c+d+f+testtesttest”转换为“[test]4 4notadupe[ d+c+d+f+]4 [测试]3 "

我相信有人会想出一个更好更有效的解决方案，因为在处理完整文件时它有点慢。我期待其他答案。

```
 string stringValue = "testtesttesttest4notaduped+c+d+f+d+c+d+f+d+c+d+f+d+c+d+f+testtesttest";

        for(int i = 0; i < stringValue.Length; i++)
        {
            for (int k = 1; (k*2) + i <= stringValue.Length; k++)
            {
                int count = 1;

                string compare1 = stringValue.Substring(i,k);
                string compare2 = stringValue.Substring(i + k, k);

                //Count if and how many duplicates
                while (compare1 == compare2) 
                {
                    count++;
                    k += compare1.Length;
                    if (i + k + compare1.Length > stringValue.Length)
                        break;

                    compare2 = stringValue.Substring(i + k, compare1.Length);
                } 

                if (count > 1)
                {
                    //New code.  Added a space to the end to avoid [test]4 
                    //turning using an invalid number ie: [test]44.
                    string addString = "[" + compare1 + "]" + count + " ";

                    //Only add code if we are saving space
                    if (addString.Length < compare1.Length * count)
                    {
                        stringValue = stringValue.Remove(i, count * compare1.Length);
                        stringValue = stringValue.Insert(i, addString);
                        i = i + addString.Length - 1;
                    }
                    break;
                }
            }
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T07:11:14.417

[LZW](http://en.wikipedia.org/wiki/Lempel-Ziv-Welch)可以提供帮助：它使用前缀字典来搜索重复模式，并将此类数据替换为对先前条目的引用。我认为根据您的需要调整它应该不难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T19:20:43.573

为什么不直接使用[System.IO.Compression](http://madskristensen.net/post/Compress-and-decompress-strings-in-C.aspx)？

# sql-server - SQL Server 的最佳处理器？

> ID：859746
> 
> 赞同：0
> 
> 时间：2009-05-13T18:54:56.940
> 
> 标签：sql-server, hardware

我们的网络应用程序的数据库服务器（运行 SQL Server 2008）开始受到重创，所以我想将它升级到更好的机器。我们可能仍然会使用托管解决方案。

我知道RAM越多越好，但是处理器呢？多核处理器更好还是更面向服务器的处理器更好，比如 Xeon 或 Opteron？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T19:02:42.247

是的，在标准处理器上使用 Xeon 处理器将有助于提高 SQL Server 的整体性能。更主要的问题是您的 RAM。高性能 RAM 也将提升 SQL Server 的性能。为了提高性能，您可能想要获得 15k rpm 的硬盘。

好的经验法则，技术（RAM、处理器和硬盘）越快越好！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T19:07:43.597

我知道这可能很明显，但还没有人提到它：如果可能，请选择 64 位操作系统。更多内存，速度更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T02:30:31.800

所有这些都在谈论更好的硬件，但没有人谈论性能调整你的数据库。尽管我必须同意大多数评论，尤其是 RAM 和 HD。更多和更快总是更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T19:03:08.237

就像你说的 - 内存越多越好。但下一个最重要的组件是 RAID 中的 HDD。可能“最好的”是 RAID 0+1，有时也称为 RAID 10。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T19:12:07.317

要考虑的另一件事是许可。Microsoft 按插槽收费，而不是按内核收费。我相信甲骨文会按每个核心的完整许可的百分比收取费用。无论哪种情况，您都可以通过使用更少的插槽来容纳更高核心数的 CPU 来节省相当多的钱。

# benchmarking - 为什么一个 CPU 内核会比其他内核运行得慢？

> ID：859747
> 
> 赞同：8
> 
> 时间：2009-05-13T18:55:09.623
> 
> 标签：benchmarking, multicore, affinity

我正在对一个大型科学应用程序进行基准测试，发现在相同的输入下它有时会慢 10%。经过大量搜索，我发现只有当它在我的四核 CPU 的核心 #2 上运行时才会出现减速（特别是运行在 2.4 GHz 的 Intel Q6600）。该应用程序是单线程的，大部分时间都花在 CPU 密集型矩阵数学例程中。

现在我知道一个内核比其他内核慢，我可以通过将处理器亲和性设置为所有运行的同一内核来获得准确的基准测试结果。但是，我仍然想知道为什么一个核心更慢。

我尝试了几个简单的测试用例来确定 CPU 的慢速部分，但测试用例的运行时间相同，即使在慢速核心 #2 上也是如此。只有复杂的应用程序表现出放缓。以下是我尝试过的测试用例：

*   浮点乘法和加法：

    ```
    accumulator = accumulator*1.000001 + 0.0001; 
    ```

*   三角函数：

    ```
    accumulator = sin(accumulator);
    accumulator = cos(accumulator); 
    ```

*   整数加法：

    ```
    accumulator = accumulator + 1; 
    ```

*   尝试使 L2 缓存未命中时的内存复制：

    ```
    int stride = 4*1024*1024 + 37;  // L2 cache size + small prime number
    for(long iter=0; iter<iterations; ++iter) {
        for(int offset=0; offset<stride; ++offset) {
            for(i=offset; i<array_size; i += stride) {
                array1[i] = array2[i];
            }
        }
    } 
    ```

**问题：**为什么一个 CPU 内核会比其他内核慢，以及 CPU 的哪一部分导致了速度变慢？

**编辑：**更多测试显示了一些[Heisenbug](http://en.wikipedia.org/wiki/Unusual_software_bug#Heisenbug)行为。当我明确设置处理器关联时，我的应用程序不会在核心 #2 上减慢速度。但是，如果它选择在没有明确设置处理器亲和性的情况下在核心 #2 上运行，则应用程序的运行速度会慢约 10%。这就解释了为什么我的简单测试用例没有表现出同样的减速，因为它们都明确地设置了处理器亲和性。因此，看起来有一些进程喜欢在核心#2 上运行，但如果设置了处理器亲和性，它就会不受干扰。

*底线：*如果您需要在多核机器上对单线程程序进行准确的基准测试，请确保设置处理器亲和性。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T19:03:29.217

您可能有选择连接到同一处理器的应用程序（CPU Affinity）。

操作系统通常希望在同一个处理器上运行，因为它们可以将所有数据缓存在同一个 L1 缓存上。如果您碰巧在操作系统正在执行大量工作的同一内核上运行您的进程，您可能会体验到 CPU 性能下降的影响。

听起来有些进程想要坚持使用同一个 cpu。我怀疑是硬件问题。

它不一定是你的操作系统在做这项工作，其他一些后台守护进程可能正在做这件事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T18:57:42.957

由于过热或省电功能，大多数现代 cpu 对每个 cpu 内核都有单独的节流。您可以尝试关闭节电或改善冷却。或者你的cpu坏了。在我的 i7 上，“传感器”中报告的 8 个核心的核心温度大约相差 2-3 度。满载时仍有变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T17:52:30.047

另一种可能性是进程在运行时从一个核心迁移到另一个核心。我建议将 CPU 亲和力设置为“慢”核心，看看它是否同样快。

几年前，在多核时代之前，我给自己买了一个双路 Athlon MP 用于“网络开发”。突然间，我的 Plone/Zope/Python 网络服务器慢了下来。谷歌搜索发现 CPython 解释器具有全局解释器锁，但 Python 线程由 OS 线程支持。操作系统线程平均分布在 CPU 之间，但每次只有一个 CPU 可以获取锁，因此所有其他[进程都必须等待](http://www.zope.org/Members/glpb/solaris/report_ps)。

将 Zope 的 CPU 亲和性设置为任何 CPU 都可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-28T09:40:47.627

我在我的 Haswel 笔记本电脑上观察到了类似的情况。系统很安静，没有 X 运行，只有终端。使用不同的选项执行相同的代码`numactl --physcpubin`在所有内核上给出完全相同的结果，除了一个。我将核心频率更改为 Turbo，更改为其他值，没有任何帮助。所有内核都以预期的速度运行，除了一个总是比其他内核运行得慢。这种效果在重新启动后仍然存在。

我重新启动计算机并在 BIOS 中关闭了超线程。当它重新上线时，它又好了。然后我打开了超线程，直到现在都很好。

离奇。不知道那可能是什么。

# c# - 从 WPF/XBAP 应用程序检测网络连接？

> ID：859753
> 
> 赞同：7
> 
> 时间：2009-05-13T18:56:46.750
> 
> 标签：c#, .net, wcf, xbap

有什么方法可以确定 XBAP（托管在浏览器中的 WPF）应用程序是否具有网络连接性？如果没有，用 C# 和 .NET 编写的传统 Windows 客户端如何确定它是否具有连接性？

基本上，该用例是在通过 WiFi 连接到 Intranet 的移动笔记本电脑上运行的 XBAP 应用程序。笔记本电脑将无法连接到 Internet。WiFi 连接可能存在也可能不存在，具体取决于用户当时所处的位置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T19:06:27.450

GateWayIPAddressInformation 应该可以工作： http: [//msdn.microsoft.com/en-us/library/system.net.networkinformation.gatewayipaddressinformation (loband).aspx](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.gatewayipaddressinformation(loband).aspx)

如果您获得网关 IP 地址，并且您可以 Ping ( [http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping(loband).aspx](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping(loband).aspx) )，那么您可能已连接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-12T14:11:02.363

在 InitializeComponent() 中执行此操作：

```
// Add EventHandler for NetworkAddressChanged event    
NetworkChange.NetworkAddressChanged += new NetworkAddressChangedEventHandler(AddressChangedCallback); 
```

这是该事件触发时调用的方法：

```
internal void AddressChangedCallback(object sender, EventArgs e)
{
    // Check for NetworkConnectivity
    _isInternetConnectionActive = new NetworkConnectivity().IsInternetConnected; 
} 
```

这是 NetworkConnectivity 类：

```
public class NetworkConnectivity
{
    private List<IPAddress> _ipAddresses = new List<IPAddress>();

    public NetworkConnectivity()
    {
        _ipAddresses = new List<IPAddress>();
    }

    #region Public Properties
    public int CountIPAddresses
    {
        get { return this.IPAddresses.Count; }
    }
    public List<IPAddress> IPAddresses
    {
        get
        {
            _ipAddresses.Clear();
            // Get a listing of all network adapters
            NetworkInterface[] adapters = NetworkInterface.GetAllNetworkInterfaces();
            foreach (NetworkInterface adapter in adapters)
            {
                IPInterfaceProperties adapterProperties = adapter.GetIPProperties();
                GatewayIPAddressInformationCollection addresses = adapterProperties.GatewayAddresses;
                // If this adapter has at least 1 IPAddress
                if (addresses.Count > 0)
                {
                    // Loop through all IP Addresses
                    foreach (GatewayIPAddressInformation address in addresses)
                    {
                        _ipAddresses.Add(address.Address);
                    }
                }
            } 
            return _ipAddresses;
        }
    }
    public bool IsInternetConnected
    {
        get
        {
            if (this.CountIPAddresses == 0)
            {
                return false;
            }
            else
            {
                //IPAddress[] ips = ResolveDNSAddress("google.com");
                //return PingIPAddressPool(ips);
                return PingIPAddress("72.14.204.104"); // Google IP
            }
        }
    }
    #endregion

    #region Public Methods
    public IPAddress[] ResolveDNSAddress(string UrlAddress)
    {
        IPHostEntry hostInfo = Dns.Resolve(UrlAddress);
        return hostInfo.AddressList;
    }
    public bool PingIPAddressPool(IPAddress[] ipAddresses)
    {
        foreach (IPAddress ip in ipAddresses)
        {
            if (PingIPAddress(ip.Address.ToString()))
            {
                return true;
            }
        }
        return false;
    }
    public bool PingIPAddress(string ip)
    {
        // Pinging
        IPAddress addr = IPAddress.Parse(ip);
        Ping pingSender = new Ping();
        PingOptions options = new PingOptions();

        // Use the default Ttl value which is 128,
        // but change the fragmentation behavior.
        options.DontFragment = true;

        // Create a buffer of 32 bytes of data to be transmitted.
        string data = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";
        byte[] buffer = Encoding.ASCII.GetBytes(data);
        int timeout = 15; // seconds to wait for response
        int attempts = 2; // ping attempts
        for (int i = 0; i < attempts; i++)
        {
            PingReply reply = pingSender.Send(addr, timeout, buffer, options); 
            if (reply.Status == IPStatus.Success)
            { return true; }
        }
        return false;
    }
    #endregion

} 
```

# sql - SQL 遍历列表以对每个项目调用 EXEC

> ID：859759
> 
> 赞同：5
> 
> 时间：2009-05-13T18:57:57.043
> 
> 标签：sql, stored-procedures, loops, iteration, exec

尝试概括我的问题...我想为 SELECT 语句返回的每个结果执行一个存储过程。

精神上我想尝试类似 EXEC myStoredProc (SELECT id FROM sometable WHERE cond = @param)

与我的具体案例相关的更多细节......我有一个 SaaS 应用程序。我想从系统中删除一个租户。在我可以删除租户之前，我必须删除与该租户关联的数据库中的所有记录。

租户拥有诸如包含许多不同类型字段的表单之类的项目。我已经有一个存储过程，可以删除表单及其所有关联项目（如字段）。出于维护原因（即不想重复确定记录和表单之间的依赖关系和关联的逻辑），我只想为属于租户的每个表单调用该 StoredProc。

我可以通过运行如下查询来检索表单列表... Select formId FROM Forms WHERE Tenant = @TenantId

我想要对该查询的结果执行的是执行我的 Delete_Form 存储过程。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T19:02:44.023

在您无法控制外键并且无法进行级联删除的情况下，您可以创建一个游标来循环并为每个外键执行存储的过程。

```
declare @formID int
declare FormsCursor cursor fast_forward for Select formId FROM Forms WHERE Tenant = @Tenant

open FormsCursor

fetch next from FormsCursor into @formID

while @@fetch_status = 0
begin

   exec Delete_Form @formID

   fetch next from FormsCursor into @formID

end

close FormsCursor
deallocate FormsCursor 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T19:00:49.910

您可以只打开级联删除，删除父记录将删除与其关联的所有子记录。

如果不是，则必须创建一个[游标](http://msdn.microsoft.com/en-us/library/ms180169.aspx)（该链接适用于 sql server，但我假设其他 RDBMS 的游标是相似的）并循环遍历每个结果，提取表单 ID 并为每个执行 [Delete_Field_Procedure]一。

# ruby - 高性能 Ruby 列表框

> ID：859760
> 
> 赞同：2
> 
> 时间：2009-05-13T18:58:40.350
> 
> 标签：ruby, user-interface, listbox

我需要在 Ruby 中创建一个小型应用程序，它将显示通过 TCP 接收到的日志行以不同的颜色。用于此类应用程序的推荐 GUI 框架是什么？

我应该在 Windows 和 Linux 上工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T20:24:45.390

[Shoes](http://shoooes.net/)是一个很棒的轻量级 GUI 框架，支持 mac、linux 和 windows。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T20:16:27.540

RuGUI 是一个旨在帮助构建桌面应用程序的框架：[http](http://rugui.org/) ://rugui.org/和[https://github.com/rugui/rugui](https://github.com/rugui/rugui)

# sql - 这是在 SQL 中进行布尔测试的正确方法吗？

> ID：859762
> 
> 赞同：89
> 
> 时间：2009-05-13T18:59:01.160
> 
> 标签：sql, boolean-expression

假设 active 是一个“布尔字段”（小整数，0 或 1）

```
# Find all active users
select * from users where active 

# Find all inactive users
select * from users where NOT active 
```

换句话说，“NOT”运算符可以直接应用于布尔字段吗？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-05-13T19:01:10.127

SQL 中的布尔值是一个位字段。这意味着 1 或 0。正确的语法是：

```
select * from users where active = 1 /* All Active Users */ 
```

或者

```
select * from users where active = 0 /* All Inactive Users */ 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-05-13T19:13:14.053

使用 Postgres，您可以使用

```
select * from users where active 
```

或者

```
select * from users where active = 't' 
```

如果要使用整数值，则必须将其视为字符串。您不能使用整数值。

```
select * from users where active = 1   -- Does not work

select * from users where active = '1' -- Works 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-13T19:08:05.187

MS SQL 2008 也可以使用字符串版本的真假...

```
select * from users where active = 'true'
-- or --
select * from users where active = 'false' 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-13T19:00:54.993

在 SQL Server 中，您通常会使用。我不知道其他数据库引擎。

```
select * from users where active = 0 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-13T19:30:52.793

对于没有布尔值的本机类型的数据库，我个人更喜欢使用值为“Y”和“N”的 char(1)。字母比数字更易于用户使用，数字假定阅读它的人现在会认为 1 对应于真，0 对应于假。

'Y' 和 'N' 在使用 (N)Hibernate 时也能很好地映射。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T01:44:03.267

PostgreSQL 支持布尔类型，因此您的 SQL 查询将在 PostgreSQL 中完美运行。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2017-03-01T03:09:08.360

如果您使用 SQLite3 请注意：

它只需要't'或'f'。不是 1 或 0。不是 TRUE 或 FALSE。

刚学会了艰难的方法。

# c - 取消引用指针的后增量？

> ID：859770
> 
> 赞同：67
> 
> 时间：2009-05-13T19:01:50.967
> 
> 标签：c, pointers, operator-precedence

试图理解 C 中指针的行为，我对以下内容有点惊讶（下面的示例代码）：

```
#include <stdio.h>

void add_one_v1(int *our_var_ptr)
{
    *our_var_ptr = *our_var_ptr +1;
}

void add_one_v2(int *our_var_ptr)
{
    *our_var_ptr++;
}

int main()
{
    int testvar;

    testvar = 63;
    add_one_v1(&(testvar));         /* Try first version of the function */
    printf("%d\n", testvar);        /* Prints out 64                     */
    printf("@ %p\n\n", &(testvar));

    testvar = 63;
    add_one_v2(&(testvar));         /* Try first version of the function */
    printf("%d\n", testvar);        /* Prints 63 ?                       */
    printf("@ %p\n", &(testvar));   /* Address remains identical         */
} 
```

输出：

```
64
@ 0xbf84c6b0

63
@ 0xbf84c6b0 
```

`*our_var_ptr++`第二个函数 ( ) 中的语句究竟做了什么`add_one_v2`，因为它显然与 不一样`*our_var_ptr = *our_var_ptr +1`？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-05-13T19:09:12.220

这是让 C 和 C++ 如此有趣的小问题之一。如果你想弯曲你的大脑，想出这个：

```
while (*dst++ = *src++) ; 
```

这是一个字符串副本。指针不断增加，直到复制了一个值为 0 的字符。一旦你知道这个技巧为什么有效，你就永远不会忘记 ++ 是如何在指针上工作的。

PS您总是可以用括号覆盖运算符顺序。以下将增加指向的值，而不是指针本身：

```
(*our_var_ptr)++; 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-05-13T19:05:39.840

由于运算符优先级规则和`++`作为后缀运算符的事实，`add_one_v2()`确实取消了对指针的引用，但`++`实际上是应用于*指针本身*。但是，请记住 C 始终使用按值传递：`add_one_v2()`递增其指针的*本地副本*，这对存储在该地址的值没有任何影响。

作为测试，`add_one_v2()`用这些代码替换，看看输出是如何受到影响的：

```
void add_one_v2(int *our_var_ptr)
{
    (*our_var_ptr)++;  // Now stores 64
}

void add_one_v2(int *our_var_ptr)
{
    *(our_var_ptr++);  // Increments the pointer, but this is a local
                       // copy of the pointer, so it doesn't do anything.
} 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-05-13T19:50:30.607

好的，

```
*our_var_ptr++; 
```

它是这样工作的：

1.  `our_var_ptr`取消引用首先发生，为您提供由（包含 63）指示的内存位置。
2.  然后对表达式求值，63的结果还是63。
3.  结果被丢弃（你没有对它做任何事情）。
4.  `our_var_ptr`然后在评估后递增。它正在改变指针指向的位置，而不是它指向的位置。

它实际上与执行此操作相同：

```
*our_var_ptr;
our_var_ptr = our_var_ptr + 1; 
```

有道理？Mark Ransom 的回答有一个很好的例子，除了他实际上使用了结果。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-13T20:13:59.727

这里有很多混乱，所以这是一个修改后的测试程序，以使发生的事情变得清晰（或至少清晰*er*）：

```
#include <stdio.h>

void add_one_v1(int *p){
  printf("v1: pre:   p = %p\n",p);
  printf("v1: pre:  *p = %d\n",*p);
    *p = *p + 1;
  printf("v1: post:  p = %p\n",p);
  printf("v1: post: *p = %d\n",*p);
}

void add_one_v2(int *p)
{
  printf("v2: pre:   p = %p\n",p);
  printf("v2: pre:  *p = %d\n",*p);
    int q = *p++;
  printf("v2: post:   p = %p\n",p);
  printf("v2: post:  *p = %d\n",*p);
  printf("v2: post:   q = %d\n",q);
}

int main()
{
  int ary[2] = {63, -63};
  int *ptr = ary;

    add_one_v1(ptr);         
    printf("@ %p\n", ptr);
    printf("%d\n", *(ptr));  
    printf("%d\n\n", *(ptr+1)); 

    add_one_v2(ptr);
    printf("@ %p\n", ptr);
    printf("%d\n", *ptr);
    printf("%d\n", *(ptr+1)); 
} 
```

结果输出：

```
v1: pre:   p = 0xbfffecb4
v1: pre:  *p = 63
v1: post:  p = 0xbfffecb4
v1: post: *p = 64
@ 0xbfffecb4
64
-63

v2: pre:   p = 0xbfffecb4
v2: pre:  *p = 64
v2: post:  p = 0xbfffecb8
v2: post: *p = -63
v2: post:  q = 64

@ 0xbfffecb4
64
-63 
```

需要注意的四点：

1.  对指针本地副本的更改*不会*反映在调用指针中。
2.  对本地指针目标的更改确实会影响调用指针的目标（至少在目标指针更新之前）
3.  in 指向的值`add_one_v2`不*递增*，后面的值也不递增，但指针是
4.  指针的增量`add_one_v2`发生*在*取消引用之后

## 为什么？

*   因为`++`绑定比`*`（作为取消引用或乘法）更紧密，所以增量`add_one_v2`适用于指针，而不是它指向的内容。
*   *后*增量发生*在*对术语的评估之后，因此取消引用获取数组中的第一个值（元素 0）。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-13T19:13:12.480

正如其他人指出的那样，运算符优先级导致 v2 函数中的表达式被视为`*(our_var_ptr++)`.

但是，由于这是一个后自增运算符，因此说它先递增指针然后取消引用它并不完全正确。如果这是真的，我认为您不会得到 63 作为输出，因为它将返回下一个内存位置中的值。实际上，我认为操作的逻辑顺序是：

1.  保存指针的当前值
2.  增加指针
3.  取消引用步骤 1 中保存的指针值

正如 htw 所解释的，您没有看到指针值的变化，因为它是按值传递给函数的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-11-04T15:52:51.943

如果您不使用括号来指定操作顺序，则前缀和后缀增量都优先于引用和取消引用。但是，前缀递增和后缀递增是不同的操作。在 ++x 中，运算符获取对变量的引用，将其加一并按值返回。在 x++ 中，运算符递增变量，但返回其旧值。它们的行为有点像这样（想象它们在你的类中被声明为方法）：

```
//prefix increment (++x)
auto operator++()
{
    (*this) = (*this) + 1;
    return (*this);
}

//postfix increment (x++)
auto operator++(int) //unfortunately, the "int" is how they differentiate
{
    auto temp = (*this);
    (*this) = (*this) + 1; //same as ++(*this);
    return temp;
} 
```

*（请注意，后缀增量中包含一个副本，因此效率较低。这就是为什么您应该在循环中更喜欢 ++i 而不是 i++ 的原因，即使现在大多数编译器都会自动为您执行此操作。）*

如您所见，后缀增量首先被处理，但是，由于它的行为方式，您将取消引用指针的先前值。

这是一个例子：

```
char * x = {'a', 'c'};
char   y = *x++; //same as *(x++);
char   z = *x; 
```

在第二行中，指针 x 将在取消引用之前递增，但取消引用将发生在 x 的旧值（这是后缀递增返回的**地址）上。**所以 y 将用“a”初始化，z 用“c”初始化。但如果你这样做：

```
char * x = {'a', 'c'};
char   y = (*x)++;
char   z = *x; 
```

在这里，x 将被取消引用，它所指向的**值**('a') 将递增（到 'b'）。由于后缀增量返回旧值，y 仍将使用 'a' 进行初始化。由于指针没有改变，z 将被初始化为新值'b'。

现在让我们检查前缀情况：

```
char * x = {'a', 'c'};
char   y = *++x; //same as *(++x)
char   z = *x; 
```

在这里，取消引用将发生在 x 的增量值上（由前缀增量运算符立即返回），因此 y 和 z 都将使用 'c' 进行初始化。要获得不同的行为，您可以更改运算符的顺序：

```
char * x = {'a', 'c'};
char   y = ++*x; //same as ++(*x)
char   z = *x; 
```

在这里，您确保您首先增加 x 的内容并且指针的值永远不会改变，因此 y 和 z 将被分配 'b'。在**strcpy**函数中（在其他答案中提到），增量也是首先完成的：

```
char * strcpy(char * dst, char * src)
{
    char * aux = dst;
    while(*dst++ = *src++);
    return aux;
} 
```

在每次迭代中，首先处理 src++，作为后缀增量，它返回 src 的旧值。然后， src 的旧值（它是一个指针）被取消引用以分配给赋值运算符左侧的任何内容。然后增加 dst 并取消引用它的旧值以成为左值并接收旧的 src 值。这就是为什么 dst[0] = src[0]、dst[1] = src[1] 等，直到 *dst 被赋值为 0，从而打破循环。

**附录：**

此答案中的所有代码均使用 C 语言进行了测试。在 C++ 中，您可能无法对指针进行列表初始化。因此，如果要在 C++ 中测试示例，则应先初始化一个数组，然后将其降级为指针：

```
char w[] = {'a', 'c'};
char * x = w;
char   y = *x++; //or the other cases
char   z = *x; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-13T19:13:36.190

our_var_ptr 是指向某个内存的指针。即它是存储数据的存储单元。（在这种情况下，4 个字节的二进制格式为 int）。

*our_var_ptr 是取消引用的指针——它指向指针“指向”的位置。

++ 增加一个值。

所以。`*our_var_ptr = *our_var_ptr+1`取消引用指针并将该位置的值加一。

现在添加运算符优先级 - 读取它`(*our_var_ptr) = (*our_var_ptr)+1`，您会看到取消引用首先发生，因此您获取该值并递增它。

在您的另一个示例中，++ 运算符的优先级低于 *，因此它获取您传入的指针，向其添加一个（因此它现在指向垃圾），然后返回。（记住值在 C 中总是按值传递的，所以当函数返回原始 testvar 指针时保持不变，您只更改了函数内部的指针）。

我的建议是，在使用取消引用（或其他任何方法）时，请使用括号来明确您的决定。不要试图记住优先规则，因为有一天你只会使用另一种语言，它们会略有不同，你会感到困惑。或者老了，最终忘记了哪个具有更高的优先级（就像我对 * 和 -> 所做的那样）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-05-02T13:01:52.803

我会尝试从一个不同的角度来回答这个问题... 第 1 步让我们看看运算符和操作数：在这种情况下它是操作数，并且您有两个运算符，在这种情况下 * 用于取消引用和 ++为增量。具有较高优先级的第 2 步 ++ 优先于 * 第 3 步 ++ 在哪里，它在右边，表示**POST**增量 在这种情况下，编译器会记下“心理笔记”来执行增量**AFTER**它是由所有其他运算符完成的......注意如果它是 *++p 那么它将在之前完成，所以在这种情况下，它相当于取两个处理器的寄存器，一个将保存取消引用的值*p 和另一个将保存递增的 p++ 的值，在这种情况下有两个的原因是 POST 活动......在这种情况下，这是棘手的地方，看起来很矛盾。人们会期望 ++ 优先于 *，它确实如此，只是 POST 意味着它将仅在所有其他操作数之后应用，在下一个 ';' 之前 令牌...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-11-02T06:37:45.523

来自 K&R，第 105 页：“*t++ 的值是 t 在 t 递增之前指向的字符”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-06-13T12:50:55.020

```
 uint32_t* test;
    test = &__STACK_TOP;

    for (i = 0; i < 10; i++) {
        *test++ = 0x5A5A5A5A;
    }

    //same as above

    for (i = 0; i < 10; i++) {
        *test = 0x5A5A5A5A;
        test++;
    } 
```

因为 test 是一个指针，所以 test++ （这是没有取消引用它）将增加指针（它增加 test 的值，它恰好是所指向的（目标）地址）。因为目标是 uint32_t 类型，test++ 将增加 4 个字节，如果目标是这种类型的数组，那么 test 现在将指向下一个元素。在进行此类操作时，有时您必须先转换指针才能获得所需的内存偏移量。

```
 ((unsigned char*) test)++; 
```

这只会将地址增加 1 个字节；）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-13T19:04:09.107

'++' 运算符的优先级高于 '*' 运算符，这意味着指针地址将在取消引用之前递增。

但是，“+”运算符的优先级低于“*”。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-07-08T01:39:08.450

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-08-17T14:41:55.510

因为指针是按值传递的，所以只有本地副本会增加。如果你真的想增加指针，你必须通过引用传递它，如下所示：

```
void inc_value_and_ptr(int **ptr)
{
   (**ptr)++;
   (*ptr)++;
} 
```

# batch-file - 使用批处理文件在 .txt 文件中搜索单词

> ID：859775
> 
> 赞同：0
> 
> 时间：2009-05-13T19:02:27.393
> 
> 标签：batch-file

我正在寻找一个批处理文件来搜索一个 txt 文件，如果它找到“失败”这个词，然后退出 1。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T19:14:45.300

这可能会让你开始......

```
type file.txt | find "Failed" 
```

如果返回任何内容，则将 ERRORLEVEL 变量设置为 1。

希望对哥们有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T19:22:26.193

这与 Garrett 所说的类似，但您可以将其作为后台进程运行，例如在 stdout 上显示一些其他信息：

```
@echo off
@start /wait FIND /C /I "SearchPhrase" path-to-your-file\filename.abc
IF ERRORLEVEL 1 (do-something) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:20:31.500

```
FindStr "Failed" YourFile.Txt >Nul:
If ErrorLevel 1  
  ... then it is NOT found (findstr returns 0 if found 
```

# java - 存储应用设置的最佳方式是什么？(MVC)

> ID：859780
> 
> 赞同：2
> 
> 时间：2009-05-13T19:02:53.087
> 
> 标签：java, model-view-controller, swing, config

我正在开发一个适合 MVC 模式的摇摆应用程序，我想知道存储设置（例如宽度/高度、xml 文件位置）的最佳位置......这些设置是否也只能通过模型​​获得？我应该使用全局静态类吗？单身狗？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T19:51:30.903

我建议。[`java.util.prefs`](http://java.sun.com/javase/6/docs/api/java/util/prefs/package-summary.html)`.`[`Preferences`](http://java.sun.com/javase/6/docs/api/java/util/prefs/Preferences.html)

那么你就不必发明任何东西了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T19:49:17.367

实际上，我在这里使用 NetBeans 中的[Swing 应用程序框架](http://www.netbeans.org/kb/60/java/gui-saf.html)取得了巨大成功，它以一种您不必过多担心设计模式的方式来处理它 :)

在此之前，我通常将窗口属性存储在属性文件中，并且我有一个单独的配置模型/服务，我将它注入到需要在重新创建窗口时检索属性的位置。

我不明白为什么它需要是一个单例。在这种情况下可能是反模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:53:36.250

这取决于您正在谈论的设置。

`Width``Height`听起来像是只与项目的视图部分相关的属性，因此*应该*存储在其中。`Xml file location`听起来更像是*模型*问题。

在 Java 中开发时（我很少这样做...），我倾向于设置一个名为的类`Settings`，在其中存储我需要的任何内容作为私有字段，并在需要的地方使用 getter 和/或 setter。在 MVC 模式中，我将在每个部分中有一个设置类，并且（如果有必要，但不是）一个“全局”设置类。但如果您关心模式一致性，请确保每个设置仅在需要时可用。

# hashtable - 哈希表的大 O 与二叉搜索树

> ID：859782
> 
> 赞同：7
> 
> 时间：2009-05-13T19:03:21.200
> 
> 标签：hashtable, binary-tree, big-o

哪个需要更长的时间？

按排序顺序打印存储在二叉搜索树中的所有项目或按排序顺序打印存储在哈希表中的所有项目。

将哈希表的项目按排序顺序打印出来需要更长的时间，因为哈希表永远不会正确排序？BST 是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-13T19:08:19.757

你是对的。哈希表是按一些哈希函数排序的，而不是按照它们的自然排序顺序，所以你必须提取所有条目 O(N) 并对它们进行排序 O(NlogN) 而你可以在 O( N)。

但是请注意，例如，在 Java 中，有一个 LinkedHashSet 和 LinkedHashMap 可以为您提供 Hash 的一些优点，但可以按照添加的顺序对其进行遍历，因此您可以对其进行排序并能够在其中遍历它排序顺序以及通过哈希提取项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T19:08:38.803

正确，哈希表没有按照您可能想要的方式“排序”。哈希表中的元素通常不是完全排序的，尽管排列通常在排序的附近。但是它们是根据散列函数排列的，对于相似的短语，散列函数通常有很大的不同。这不是人类会使用的任何度量标准。

如果您对收藏所做的主要事情是按排序顺序打印它，那么您最好使用某种类型的 BST。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T19:10:11.313

二叉搜索树的存储方式是，如果您进行深度优先遍历，您将按排序顺序找到项目（假设您具有一致的比较功能）。简单地返回树中已经存在的项目的大 O 将是遍历树的大 O。

您对哈希表是正确的，它们没有排序。事实上，为了枚举普通哈希表中的所有内容，您必须检查每个存储桶以查看其中的内容，将其拉出，然后对得到的内容进行排序。很多工作才能从中得到一个排序列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T19:11:12.293

正确，打印存储在哈希表中的排序数据会更慢，因为哈希表不是排序数据。它只是为您提供了一种快速查找特定项目的方法。在“[大 O 表示法](http://en.wikipedia.org/wiki/Big_o_notation)”中，据说可以在恒定时间内找到项目，即 O(1) 时间。

另一方面，您可以在“对数时间”（O（log n））的二叉搜索树中找到一个项目，因为数据已经为您排序。

因此，如果您的目标是打印排序列表，那么最好将数据以排序顺序（即二叉树）存储。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T20:15:53.017

这带来了几个有趣的问题。考虑到以下情况，搜索树是否仍然更快？

1.  包含哈希表和 BST 的设置时间？
2.  如果哈希算法产生一个排序的单词列表。从技术上讲，您可以创建一个使用算法的哈希表。在这种情况下，BST 与哈希表的速度将不得不归结为按排序顺序填充哈希表所需的时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T20:21:58.777

另请查看 Skip List vs. Binary Tree 的相关注意事项：[Skip List vs. Binary Tree](https://stackoverflow.com/questions/256511/skip-list-vs-binary-tree)

# visual-studio - Visual Studio 2003 中的“仅显示所选元素的源”

> ID：859792
> 
> 赞同：0
> 
> 时间：2009-05-13T19:04:44.410
> 
> 标签：visual-studio

Eclipse 中有一个功能（“仅显示所选元素的源”），它允许仅查看所选方法的代码。代码的所有其他部分都是不可见的。

我记得 Visual Studio 6.0 中也有类似的功能。我想知道这个功能在 Visual Studio 2003 及更高版本中是否可用？如果是，请指出在 IDE 中的哪里可以找到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-14T20:53:40.377

这在任何更高版本中均不可用。它在 VS 6 中被称为“过程视图”。改用大纲功能。

# c# - 更新对象内部/外部方法

> ID：859796
> 
> 赞同：1
> 
> 时间：2009-05-13T19:06:10.807
> 
> 标签：c#, object

好的，

也许这是 c# 的设计，或者我的做法是错误的。

请看我下面的代码。我将它复制并粘贴到控制台应用程序并运行它以查看我在说什么。

```
using System;

namespace ConsoleTest
{
    class Program
    {
        static void Main()
        {
            var o1 = new oObject
                             {
                                 Name = "Before Method"
                             };

            var o1b = new oObjectBad
            {
                Name = "Before Method"
            };

            Console.WriteLine("Object Bad 1 Before: " + o1b.Name);
            oObjectBad o2b = GetNewObjectBad(o1b);
            Console.WriteLine("Object Bad 1 After: " + o1b.Name);
            Console.WriteLine("Object Bad 2 After: " + o2b.Name);

            Console.WriteLine(string.Empty);

            Console.WriteLine("Object 1 Before: " + o1.Name);
            oObject o2 = GetNewObject(o1);
            Console.WriteLine("Object 1 After: " + o1.Name);
            Console.WriteLine("Object 2 After: " + o2.Name);

            Console.ReadLine();
        }

        public static oObject GetNewObject(oObject o)
        {
            oObject newObject = new oObject(o);

            newObject.Name = "Changed in Method";
            return newObject;
        }

        public static oObjectBad GetNewObjectBad(oObjectBad o)
        {
            o.Name = "Changed in Method";
            return o;
        }
    }

    class oObject
    {
        public oObject()
        {
        }

        public oObject(oObject o)
        {
            Name = o.Name;
        }

        public string Name { get; set; }
    }

    class oObjectBad
    {
        public string Name { get; set; }
    }
} 
```

现在，这是我不明白的。

当我将对象传递给方法并更新对象属性“名称”时。然后它更新方法之外的原始对象。

解决这个问题的方法是创建另一个对象（如代码所示）以克隆该对象，然后更新该克隆，然后返回该克隆。

所以问题是这样的：有没有一种更简单的方法来传递一个对象并更新该对象的属性，这样我就可以在不更新原始对象的情况下拥有这样的东西。

```
using System;

namespace ConsoleTest
{
    class Program
    {
        static void Main()
        {
            var o1 = new oObject
                             {
                                 Name = "Before Method"
                             };

            Console.WriteLine("Object 1 Before: " + o1.Name);
            oObject o2 = GetNewObjectBad(o1);
            Console.WriteLine("Object 1 After: " + o1.Name);
            Console.WriteLine("Object 2 (New Object) After: " + o2.Name);

            Console.ReadLine();
        }

        public static oObject GetNewObjectBad(oObject o)
        {
            o.Name = "Changed in Method";
            return o;
        }
    }

    class oObject
    {
        public string Name { get; set; }
    }
} 
```

如果这令人困惑，请告诉我，我会看看是否可以更好地解释。

编辑：我这样做的原因是我需要在数据库中克隆一个对象，并且克隆的对象需要更改几个属性。然后，我将使用原始对象的 ID 和新对象的 ID 进行其他数据处理。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:25:13.723

我会花一些时间研究按引用传递与按值传递，然后看看为什么需要在本地上下文中更改名称而不是在原始上下文中。我怀疑你可能有一些设计缺陷。我会重新审视这个问题，看看你是否可以用不同的方法开发一个解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T19:36:41.660

在 .NET 中，所有对象都是引用类型，除非它们来自 ValueType。通常，您无论如何都不想直接修改对象的实例变量。如果您将实例变量设为私有，然后添加操作私有数据的方法，您将拥有更多的控制权。

[http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx) ValueType 的死者名单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T19:41:51.637

为什么要更改方法中的对象而不让数据反映在调用方法中？您可以做的一件事是实现代码来跟踪更改，并为类提供一个方法，该方法返回带有原始数据的原始对象。

正如其他人所说，这是一个值类型与引用类型的问题。如果您真的不想更改对象，可以将类型更改为结构。我并不是说这就是答案，但我不知道您的班级结构以对此事发表明智的看法。

# asp.net - html正文中的Javascript遇到时会执行吗？

> ID：859806
> 
> 赞同：3
> 
> 时间：2009-05-13T19:07:10.633
> 
> 标签：asp.net, javascript, html

我继承了一个 ASP.net 代码库，但我的 ASP.net 技能非常有限。我正在努力理解为什么某些东西有效，以及为什么它只在 IE 中有效。

以下代码出现在页面中：-

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="map.aspx.cs" Inherits="Romtrac.auth_map" Culture="auto" UICulture="auto" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head id="Head1" runat="server">
    <title>
        <% = Resources.Resource.map %>
    </title>
</head>
<body>    
    <form id="adminlw_map_form" action="<%=geturl()%>" method="post"  >

    <% = Resources.Resource.loading %>...
    <textarea name="xml" id="xml" runat="server" style="display:none" cols="1" rows="1"></textarea>
    </form>
    <script language="javascript" type="text/javascript" >
      //submit main form immediately
        document.getElementById('adminlw_map_form').submit();
    </script>
</body>
</html> 
```

此代码在 ASP.net 中运行良好。表单会自动提交，返回的页面会在 Iframe 中正确呈现。我的问题是；

1）正文中的javascript是否在遇到时才被执行？这是良好的做法还是应该响应事件而执行？

2）为什么这在其他浏览器中不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T19:31:16.723

1.  是的
2.  在浏览器完全呈现页面之前，正在执行 javascript。在这种情况下，表单尚未呈现并且无法通过 DOM 访问。

执行需要在浏览器完全加载 DOM 之后发生，可以通过将调用封装在函数中并通过主体的 onload 事件调用该函数或使用 jquery 之类的 javascript 库挂钩到 load 事件来实现的页面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T19:11:44.697

1) 是的，不。jQuery 的 $(document).ready() 函数做得最好，但您应该等待页面完成加载，然后再运行 Javascript。

2）做＃1，你不需要担心这个。但是，我会向有更好答案的人开放。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T07:56:17.320

一些浏览器会阻止在页面加载时在没有用户交互的情况下提交表单9这是一个安全风险）。我过去曾多次遇到过这个问题。我会将页面的负载与 window.setTimeout 相结合，例如 100 毫秒。

```
<body onload="window.setTimeout( document.getElementById('adminlw_map_form').submit, 100)">
.... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T08:00:26.873

记住在使用 JavaScript 时要保持它不引人注目。仍然有人关闭了 JS，你的页面不应该真的在上面。它应该作为一种增强。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T19:17:50.647

与[迈克罗宾逊的答案](https://stackoverflow.com/questions/859806/does-javascript-in-the-html-body-execute-when-encountered/859829#859829)相同，但您肯定可以使用`<body onload="myfunction();">`?

# c# - 使用 ac# Setup 项目，如何将配置文件 (nlog.config) 放入安装项目的 msi？

> ID：859808
> 
> 赞同：2
> 
> 时间：2009-05-13T19:07:18.387
> 
> 标签：c#, deployment, installation

nlog.config 被放入我的项目的 bin/Debug 中。在安装项目中，我将项目 a 的主要输出和项目 a 的内容文件包含在 Application 文件夹中。但是，nlog.config 并没有针对 msi。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-20T11:31:54.623

手动添加文件意味着如果您更改源中的文件，则必须重做该步骤。

相反，请确保您的 NLog.Config 的构建操作设置为“内容”

然后，在您的安装项目中添加类型为“内容文件”的项目输出组：

![将内容文件添加到设置项目](https://i.stack.imgur.com/6kDhJ.png).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T15:40:21.760

我找到了解决方案。右键单击安装项目，然后选择添加，然后选择文件。只需从编译后放置的 bin 目录中选择 nlog.config 文件，它就可以完美运行。

# asp.net - 我应该在我的 MVC 应用程序中的哪里放置其他类

> ID：859811
> 
> 赞同：0
> 
> 时间：2009-05-13T19:08:01.100
> 
> 标签：asp.net, asp.net-mvc, class-library, s#arp-architecture, app-code

我有一个 ASP.NET MVC 应用程序，它使用放置在 Model 文件夹中的 Linq to SQL 类。

我想创建一些通常会放在我的 BLL 中的额外类，但我不确定如何使用 MVC 来处理它。

使用 WebForms，我可以将 DAL 作为类库。我的 BLL 作为引用我的 BLL 的类库。我的网站同时引用了 DAL 和 BLL。

我面临的问题是，如果我创建一个类库，这将需要引用我的 MVC 应用程序，因为它需要使用我的模型中包含的类型。

如果我然后添加（或尝试添加）对我的类库的引用，我将获得循环依赖。

在 Web 表单中。我的另一个选择是将类放在 App_Code 中。在 MVC 应用程序中是否有 App_Code 的等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:09:29.817

您可以将*所有*模型移动到类库中，不是吗？MVC 或 VS 都不介意。这将消除模型库对 Web 应用程序的依赖。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T19:20:58.723

您可以将其放在模型文件夹中。由于所有与业务相关的分类都放在该文件夹中

如需更好的实践，请参阅[scottgu](http://weblogs.asp.net/scottgu) the [nerddinner](http://nerddinner.codeplex.com/)示例。他在 nerdinner 应用程序中创建了呼吸类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T19:55:59.740

我同意**模型**文件夹。您可以根据自己的喜好组织它（BLL、DAL 等）。

除非您有令人信服的理由，否则我个人会避免进行单独的组装。作为那种一不小心就会使问题变得过于复杂的开发人员，我会尽可能地遵循 KISS（保持简单愚蠢）的做法，这往往会让我免于遇到一定的麻烦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T20:12:12.600

尝试查看 S#arp 架构。您可以使用他们提供的模板，也可以将其用作帮助您做出决定的参考。

[http://code.google.com/p/sharp-architecture/](http://code.google.com/p/sharp-architecture/)

# asp.net - Make PDF display inline instead of separate Acrobat Reader window

> ID：859815
> 
> 赞同：8
> 
> 时间：2009-05-13T19:08:30.490
> 
> 标签：asp.net, pdf, browser

I've got an ASP.NET ashx class that retrieves data from a database, creates a PDF file using iTextSharp, and streams the PDF to the browser. The browser (IE and Firefox at least) is launching Acrobat Reader as a separate window to open the file. I'd like for it to display inline within the browser.

Is that something I can completely control from the server side? I'm already setting the Content-Type header to application/pdf, and I've tried setting Content-Disposition and Content-Length. Nothing so far has worked.

Is there another header I'm missing? Is there something in the PDF itself that tells the browser how to display it? Any other ideas?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T20:10:35.287

Setting the content-disposition and content-type headers should do it, but you might also need to call `Response.ClearHeaders()` to clear other headers that have been set.

Also, try using [Fiddler](http://www.fiddler2.com/fiddler2/) to see the actual headers and content from the response and compare them to those from a site that works like you want.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T19:28:35.293

If you are using an ashx (web handler) try this:-

```
context.Response.AddHeader("content-disposition", "inline; filename=Something.pdf") 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T21:05:56.600

OK, turns out it was a stupid question, but I'm glad I asked it because I had never heard of Fiddler (which led me to the answer, which is why I'm accepting tspauld's answer). The PDF is generated by a web service that serves the file to a couple of different front-end sites. I was setting the content disposition to `inline` in the service, but that didn't matter, because the browser never got that header; it got the header from the front-end site (which was `attachment`). I changed it in the front-end site and that fixed it.

So the answer is that you have to have `Content-Type=application/pdf` and `Content-Disposition=inline; filename=Something.pdf`, as others have said.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T19:16:35.967

Try generating them into your page using html OBJECT.

```
<OBJECT WIDTH=640 HEIGHT=480>
    <PARAM NAME="SRC" VALUE="<%=filePath%>"> 
    <EMBED SRC=<%=filename.pdf%> WIDTH=1000 HEIGHT=680> 
        <NOEMBED> PDF should have displayed here!</NOEMBED> 
        </EMBED>
</OBJECT> 
```

If you need to stream the response with an ashx instead of being able to return an aspx, I think you may be out of luck.

Otherwise, I believe the settings to show in browser or not, is completely client driven and out of your hands.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T19:41:51.417

So, I have a sample in one of my works that is what you need:

```
<cc1:ShowPdf ID="ShowPdf1" runat="server" BorderStyle="None"  BorderWidth="0px"
        Height="750px" Style="z-index: 103; "
        Width="750px"/> 
```

and in server side :

```
 ShowPdf1.FilePath = String.Format("~/Handlers/Pdf.ashx?id={0}#view=FitH&page=1&pagemode=none&navpanes=1", myPublicationId); 
```

I place here also some code from my PDF Handler :

```
Response.ContentType = "application/pdf";
    byte[] bytes = YourBinaryContent;

    using (BinaryWriter writer = new BinaryWriter(context.Response.OutputStream))
    {
        writer.Write(bytes, 0, bytes.Length);
    } 
```

Anyway If my post doesn't seem clear to you, have a look at this sample [How to Display PDF documents with ASP.NET](http://www.beansoftware.com/ASP.NET-Tutorials/PDF-View-Custom-Control.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T19:20:04.107

I think this header will do what you want

```
Content-type: application/pdf 
```

Since you say that is not working, then I suspect it is a configuration setting on the client side.

Check your installed version of Adobe Acrobat. There is a setting in preferences for "Internet" and a checkbox that says "Display PDF in Browser".

--
bmb

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T19:22:04.257

Here is an article on using the embed tag to do it:[http://blogs.adobe.com/pdfdevjunkie/2007/08/using_the_html_embed_tag_to_di.html](http://blogs.adobe.com/pdfdevjunkie/2007/08/using_the_html_embed_tag_to_di.html)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-13T19:23:54.707

If you have the budget, my company sells a set of products that includes an [AJAX based image viewer](http://www.atalasoft.com/products/dotimage/thinclient/default.aspx) that will let you view the PDF pages in line without Acrobat at all. In its simplest form, it is just a viewer, but you can layer in interactivity as you need.

# c# - 集成到 IIS 7 处理管道中的 Http 模块

> ID：859822
> 
> 赞同：1
> 
> 时间：2009-05-13T19:10:22.920
> 
> 标签：c#, asp.net, iis, authentication, iis-7

Q1 -IIS7 默认自动注册*FormsAuthenticationModule*（在根*web.config*文件中定义），但术语“<em>Http 模块被集成到 IIS 7 处理管道中指的是”这个注册模块也被配置为的情况使用非 Asp.Net 应用程序？

在我看来，如果模块未配置为与非 Asp.Net 应用程序一起使用，即使它是由 IIS 7 自动注册的，那么我们也不能真正声称它已集成到 IIS 7 的处理管道中？！

第二季度

A) IIS7 自动注册一些在根*web.config*文件中定义的模块。如果我们配置（通过 IIS7 管理器） *UrlAuthorizationModule*（在根*web.config*中定义，并且 IIS 7 默认注册）也用于非 Asp.Net 应用程序，那么 IIS7 将以下条目放入应用程序的根*web.config*文件：

```
 <modules>
        <remove name="UrlAuthorization" />
        <add name="UrlAuthorization" type="System.Web.Security.UrlAuthorizationModule" preCondition="" /> 
```

但是为什么 IIS 7 还包含`<remove name="UrlAuthorization" />`元素呢？

B）我假设如果我们改变主意并决定仅将此模块用于 Asp.Net 应用程序，我们可以安全地删除以下元素：

```
<add name="UrlAuthorization" type="System.Web.Security.UrlAuthorizationModule" preCondition="" /> 
```

来自应用程序的根*web.config*文件，因为现在我们的应用程序可以使用根 web.config 中定义的*UrlAuthorizationModule*？！

第三季度

我实现 IIS7 默认注册在根*web.config文件中定义的**FormsAuthenticationModule*，但假设我们在 web.config 中注册另一个*FormsAuthenticationModule*，该*web.config*包含在某些 Web 应用程序的根目录中。

 ****   我假设收到网页请求时，将为该请求执行两个*FormsAuthenticationModule实例？*

谢谢

**编辑：**

A1。

> “集成”与“经典”处理管道是应用程序池的一个属性。可以将模块设置为仅在“集成”管道中运行是正确的。

我的问题是指集成模式下的 IIS 7。即，我的书使用术语“<em>Http 模块被集成到 IIS 7 处理管道中指代”来描述自定义 Http 处理程序已注册到 IIS 7（以集成模式运行）的情况。但是它没有说明该术语是否指的是当这个注册的处理程序被配置为也可以与非 asp.net 应用程序一起工作时，或者当注册的 Http 处理程序被配置为只与 Asp.Net 应用程序一起工作时我们是否也使用这个术语？

> A2。B. 是的，您可以删除“删除”以及“添加”行。如果您将其更改回继承设置，这就是 GUI 将执行的操作。

但在我的情况下，IIS 7 不会删除

```
<add name="UrlAuthorization" type="System.Web.Security.UrlAuthorizationModule" preCondition="" /> 
```

从应用程序的根*web.config*文件中，它只是将*preCondition*属性的值更改回 *“managedHandler”*

> A3。如果您尝试添加 2 个具有相同“名称”属性的模块，我认为您会收到错误消息。如果你真的想要它在那里两次然后更改第二个的“名称”。

抱歉，我应该更具体一些，但我的问题是指两个模块名称不同的情况。

那么在这种情况下会有两个*FormsAuthenticationModule*实例运行吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T19:35:20.180

A1。“集成”与“经典”处理管道是应用程序池的一个属性。可以将模块设置为仅在“集成”管道中运行是正确的。

A2。A. 为了更改“preCondition”属性，它必须删除第一个版本并重新添加。

A2。B. 是的，您可以删除“删除”以及“添加”行。如果您将其更改回继承设置，这就是 GUI 将执行的操作。

A3。如果您尝试添加 2 个具有相同“名称”属性的模块，我认为您会收到错误消息。如果你真的想要它在那里两次然后更改第二个的“名称”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T04:23:50.620

刚刚注意到您正在使用 Stackoverflow。请在 iis.net 上查看我的最新答案。

[http://forums.iis.net/t/1157580.aspx](http://forums.iis.net/t/1157580.aspx)

重要的是 applicationHost.config 和 root web.config 实际上仍然具有不同的含义，所以如果一个项目出现在两个文件中，请不要混淆。这实际上有不同的含义。

# user-interface - 如何设计线性 GUI 程序

> ID：859825
> 
> 赞同：0
> 
> 时间：2009-05-13T19:11:08.503
> 
> 标签：user-interface, qt

我正在制作一个简单的 Qt 应用程序。它有 4 个屏幕/页面：

1.  开始导入
2.  选择要导入图像的文件夹
3.  接受或拒绝文件夹中的每个图像，当没有图像时：
4.  “没有剩余图像”和确定按钮。

我想不出实现这一点的最佳方法。我从 QWidget 开始，但这很快就变得难以管理。

QWizard 是否过于受限？

编辑：QWizard 的部分问题是它似乎总是有“返回”和“下一步”按钮。我不希望这些作为该程序中的选项，因此这使我相信向导并不是我所追求的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T19:58:40.720

我认为 QWizardPage 是你最好的选择。

您可以通过在 QWizardPage 上使用来禁用“返回” `setCommitPage(True)`。

您还必须`nextId`在第 2 步和第 4 步之间覆盖您想要的“可变”数量的 QWizardPages。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T16:33:46.420

我不同意在`QWizard`这里使用 a 。这很容易做到，但在这种情况下，我认为使用 a`QStackedWidget`并根据您希望用户能够执行的操作交换显示的小部件可能会更容易。无论如何，这很可能是在内部完成`QWizard`的，没有运行按钮和来回移动的一些复杂性。您可能还想看看他们正在考虑添加的状态机内容，因为您的应用程序可以很容易地被拆分为状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T19:26:39.663

[这里](http://doc.trolltech.com/4.5/dialogs-trivialwizard.html)（基本）和[这里](http://doc.trolltech.com/4.5/dialogs-classwizard.html)是 QWizards 的例子。

您可以为您的屏幕制作 QWizardPages 并将它们添加到 QWizard。使用[registerField](http://doc.trolltech.com/4.5/qwizard.html#registering-and-using-fields) () 可以注册字段以在页面之间进行通信。

编辑：我没有对此进行测试，但我想您可以使用 [setButtonLayout控制 QWizard 的按钮布局](http://doc.trolltech.com/4.5/qwizard.html#setButtonLayout)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T13:57:11.493

创建一个顶部带有“开始导入”按钮的对话框。当用户点击这个：

填充一个[`QFormLayout`](http://doc.trolltech.com/4.5/qformlayout.html)：

布局应该有一个复选框，标签是要导入的图片的名称。我不确定您的要求，但您也可以显示图像的缩略图。

用户只需检查他想要的图像。

然后在底部有一个“保存...”按钮。当用户单击它时，会出现一个另存为对话框。您保存所有检查的图像，丢弃其他图像。

如果没有图像，请将“保存...”按钮文本更改为“确定”，并显示`QLabel`带有“没有图像”字符串的 a。`QLabel`您可以在和`QFormLayout`之间切换[`QStackedWidget`](http://doc.trolltech.com/4.5/qstackedwidget.html)。

查看这篇文章`QFormLayout`：[http ://doc.trolltech.com/qq/qq25-formlayout.html](http://doc.trolltech.com/qq/qq25-formlayout.html)

选项：去掉“开始导入”按钮。让应用程序在启动时自动填充 QFormLayout（如果速度足够快，可能在构造函数中）。

# .net - 当不同命名空间中有两个相似的类时，如何为类设置默认命名空间

> ID：859831
> 
> 赞同：2
> 
> 时间：2009-05-13T19:12:10.263
> 
> 标签：.net, visual-studio, namespaces, conflict

好的，既然进入 2.5 版 Nunit 给我带来了各种各样的问题，因为他们将静态类**Is**引入了 nunit.framework 命名空间。

**如果 Rhino.Mocks 和其他一些框架不使用Is**静态类，那就太好了。所以现在如果我升级到 2.5，我使用 rhino mocks 约束的大部分代码都不会编译。

有没有办法在项目级别配置 Visual Studio/C# 编译器以知道当我说**我**的意思是 Rhino Mocks 命名空间时？

PS。开源作者，我知道你喜欢流畅的界面，但是当它们与其他框架发生冲突时不要使用这些常用词！一些带有 lambdas 的闭包怎么样，你仍然可以做类似 myVar.Should(be=>be.True()) 的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T19:25:11.367

我不知道 NUmit 上下文，但也许别名机制可以帮助您：

```
namespace N1
{
  class C { }
}

namespace N2
{
    class C { }
}

namespace NamespaceDemos
{
    using C1 = N1.C;
    using C2 = N2.C;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-08T17:12:44.437

在文件顶部使用[using alias 指令](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/using-directive)`Is`来进行非限定引用以指向 Rhino 类型。

```
using Is = Rhino.Mocks.Constraints.Is; 
```

不幸的是，我认为在项目级别没有办法做到这一点。但这至少比搜索和替换所有参考文献要好。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-13T19:26:49.023

尝试使用该`using`指令。

# asp.net - IIS7 如何决定何时调用……？

> ID：859833
> 
> 赞同：2
> 
> 时间：2009-05-13T19:12:15.397
> 
> 标签：asp.net, iis, iis-7, httpmodule

Q1) 假设 Http 模块注册到 IIS7 以用于非 Asp.Net 应用程序（比如一些 Java 应用程序），那么在请求的生命周期中，IIS7 什么时候会调用这个模块？因此，IIS7 将如何决定何时调用它？

Q2) 为了向 IIS7 注册 Http 模块，我们需要将其放入 GAC。是否可以在不将其放入 GAC 的情况下注册 Http 模块或 Http 处理程序？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:26:02.020

A1。假设您使用的是集成管道，.Net 和非.Net 请求的请求生命周期是相同的。IIS7 的“失败的请求跟踪规则”功能将为您提供有关在请求生命周期内触发的事件的大量详细信息。我用它来调试 HttpModules，它有很大帮助。

A2。是的，您不需要在 GAC 中放置 HttpModule 来注册它。只要它在您应用程序的“bin”文件夹中，IIS7 就能找到它。

# php - 不遵守重写规则

> ID：859834
> 
> 赞同：0
> 
> 时间：2009-05-13T19:12:51.760
> 
> 标签：php, mod-rewrite

[http://localhost/allsides/.htaccess](http://localhost/allsides/.htaccess)

RewriteRule (.*) index.php?$1 [L]

[http://localhost/allsides/test](http://localhost/allsides/test)

allsides/ 后的一个或多个字符保存在 $1 中

$_GET 是 1 美元。

测试不是 $_GET！

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:14:20.760

当`…?test`被请求时，`$_GET`的第一个元素的键将是`test`一个没有值（等于`…?test=`）。

所以要么使用`current(array_keys($_GET))`获取第一个元素的键，`$_GET` 要么使用[`$_SERVER['QUERY_STRING']`](http://docs.php.net/manual/en/reserved.variables.server.php)获取完整查询。

# c# - 如何在不影响调试器的情况下捕获另一个线程上的异常

> ID：859844
> 
> 赞同：0
> 
> 时间：2009-05-13T19:14:00.700
> 
> 标签：c#, visual-studio, multithreading, debugging

我有一个 udp 服务，它正在侦听 udp 数据报的套接字：

```
int result = 0;
try
{
  result = m_ReceivingSocket.Receive(buffer);
}
catch (SocketException e)
{
  Log.Debug("Timed out with socket exception, so no result was found.", e);
} 
```

它每 1 毫秒在 Timer 上执行此操作，因为尽快收到 udp 消息很重要。大多数时候会抛出套接字异常，因为套接字会超时。这是因为套接字设置为超时：

```
receivingSocket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, 1000); 
```

不幸的是，当我运行它时，Visual Studio 调试器不允许我单步执行代码。它认为另一个线程继续运行并且不会让我继续。有人见过这个吗？任何人都知道从套接字接收而不处理异常的更好方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T19:32:17.033

您是否尝试过将超时更改为无限的调试条件？

```
#if (DEBUG)
receivingSocket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, 0);
#endif 
```

# asp.net - ASP 中的 HTML：字面意义上的头痛：它试图帮助太多

> ID：859852
> 
> 赞同：1
> 
> 时间：2009-05-13T19:15:52.910
> 
> 标签：asp.net

编辑：更新更清晰。

我有一个无序列表的项目，我需要本地化。而不是包装每个列表项的文本 - 在数百个 <li> 的过程中，这可能会杀死我 - 我决定将 <ul> 包装在文字中。这样，我可以将“文本”属性放入资源文件中以进行本地化。

但是，asp.net 认为我的代码中的每个换行符都应该替换为 <br />。除了用任何内容替换文本中的每个 \n 之外，是否有一个属性或一种方法可以解决这个问题？我尝试了 Mode="PassThrough" ，但这似乎没有什么不同。

我暂时将所有 <br />s 都放在了 <ul> 的 display:none 在我的 CSS 中，但感觉很hackish。我宁愿它根本不渲染 <br />s。

代码：

```
<asp:Literal id="literal" runat="server">
    <ul>
        <li>Item 1</li>
        <li>Item 2</li>
        ...
        <li>Item 50</li>
    </ul>
</asp:Literal> 
```

它给了我什么：

```
<ul>
<br />
    <li>Item 1</li>
    <br />
    <li>Item 2</li>
    <br />
    ...
    <br />
    <li>Item 50</li>
    <br />
</ul> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T19:23:07.143

<asp:Literal Mode="PassThrough"></asp:Literal>

来自 MSDN：

**PassThrough**：不修改控件的内容。

**编码**：控件的内容被转换为 HTML 编码的字符串。

**Transform**：不支持的标记语言元素从控件的内容中删除。如果在支持 HTML 或 XHTML 的浏览器上呈现 Literal 控件，则不会修改控件的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T19:21:55.100

相反，使用[`PlaceHolder`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.placeholder.aspx)控件怎么样？

您可以以编程方式将文本添加到`PlaceHolder`控件中，如下所示：

```
this.MyPlaceHolderControl.Controls.Add(new LiteralControl(GetLocalizedResource())); 
```

请注意，这使用[`LiteralControl`](http://msdn.microsoft.com/en-us/library/system.web.ui.literalcontrol.aspx), not [`Literal`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.literal.aspx)，它不应对您的内容采取任何行动。

那对你有用吗？

# html - 什么时候 CSS Sprite 太大了？

> ID：859857
> 
> 赞同：18
> 
> 时间：2009-05-13T19:16:34.657
> 
> 标签：html, css, sprite, css-sprites

sprites 的主要目的是减少向服务器发出的对页面上图形元素的 http 请求吗？或者您是否想尝试将尽可能多的元素添加到精灵中。

我想我要问的是：精灵什么时候太大了？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-13T19:18:36.447

当用户必须等待文件下载才能使用页面时，它太大了。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-24T20:21:27.117

如果您使用 PNG 作为 sprite 图像类型，请记住每一行通常独立于其他行进行压缩（放气）。

因此，为了帮助平衡精灵数量/图像大小，请尝试将相似的精灵水平而不是垂直放置彼此相邻 - 以利用压缩。

PNG 还支持“预测器”，它只存储预测值（基于同一行中的前面的行和前面的像素）和实际值之间的增量。

找到一个好的图像编辑器，它允许您设置不同的 PNG 预测器压缩设置（或自动优化）以找到最适合您的图像的设置。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-13T19:26:51.660

> sprites 的主要目的是减少向服务器发出的对页面上图形元素的 http 请求吗？

是的，您希望避免对小图像有很多请求。将它们组合成一个精灵可以在一个 http 请求中获取它们。

> 什么时候精灵太大了？

这实际上是您要查看的所有请求的总和。精灵太大的唯一方法是它的部分的总和（这正是精灵*的*样子）太大而无法开始。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-24T20:17:45.767

关于精灵，你也应该看看这篇博文下面关于内存使用的讨论：http: [//blog.mozilla.com/webdev/2009/03/27/css-spriting-tips/](http://blog.mozilla.com/webdev/2009/03/27/css-spriting-tips/)

我的建议：

*   只有精灵图标行、按钮和重复图像（例如圆角渐变框）。
*   别管其他一切
*   将图像保持在 500x500 或 100kb 以下，并尽可能少地留出未使用的空间。根据情况使用 .png 或 .gif

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-13T19:18:07.150

您可以将所有小的静态设计元素打包到一个主图像中，而不会出现大问题。

当然，如果您的网站上有 10 兆像素的照片，那么将它们打包在一起会很疯狂。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T19:29:12.687

当您只包含基本 UI 元素之外的任何内容时，CSS 精灵就太大了。这些是小的补充图像，例如图标和徽标，压缩不会对质量造成太大损害。由于所有这些图像本来都是独立加载的，因此您不会比单独请求它们更糟糕。如果加载时间过长，则问题不在于精灵，而在于正确压缩图像。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T19:21:57.083

是的，主要目的是减少请求（并因此减少加载时间）。另一个优点是您只需要担心正确缓存一个图像。提示：使用 PNG 图像，因为它们的压缩处理大的白色（“空白”）区域最好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T19:40:12.793

谷歌地图使用 [256x256] 像素图像。

# c++ - 与 Sunstudio 的静态链接

> ID：859867
> 
> 赞同：0
> 
> 时间：2009-05-13T19:19:46.570
> 
> 标签：c++, static-libraries, sunstudio

我正在尝试将我的图书馆 xxx 链接到图书馆 yyy。我想静态链接，这样我在交付xxx时就不需要将yyy和xxx一起打包。我有第三方提供的两个版本的 yyy：libyyy.so 和 libyyyln.a。所以在这里我去链接-lyyyln。

链接时我没有收到任何错误消息。当我执行“ldd libxxx.so”时，对 yyyln 的依赖不会出现。但是“ldd -r libxxx.so”显示来自 yyy 的符号没有被解析。“nm libxxx.so”显示来自 yyy 的这些符号是 UNDEF。

那我错过了什么？

**Edit1：我设法让它最终与“-l /fullpath/libyyyln.a”一起工作**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T22:45:53.020

你想把`-Bstatic`你想要静态链接的库放在前面。深入[了解 Solaris 链接器和库指南](http://docs.oracle.com/cd/E23823_01/html/817-1984/chapter2-88783.html#scrolltoc)以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T07:32:02.847

您可以在 Sun Studio 论坛上提出这个问题，并直接从 Sun Studio 编译器团队获得答案

[Sun Studio 论坛](https://forums.oracle.com/forums/category.jspa?categoryID=280)（用于 C、C++、Fortran 和工具）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:43:57.623

看看这是否有帮助： http: [//fortran-2000.com/ArnaudRecipes/sharedlib.html](http://fortran-2000.com/ArnaudRecipes/sharedlib.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T19:24:28.763

我假设你正在使用 gcc。默认情况下，如果可以，gcc 将使用共享库 (.so)，因此您必须使用 -static 选项强制它静态链接。

编辑：对不起，我以为 sunstudio 是您要链接的库的名称，我忘记了 Sun Studio 包含一个编译器。不过，sun studio 必须有类似的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T20:19:08.673

我设法让它最终与“-l /fullpath/libyyyln.a”一起工作

我玩弄 -Bstatic 和 -Bdynamic 没有成功。解决方案真的和上面写的一样简单。我早该想到的。

# php - 配置为在现有 CMS 中工作的最简单的 PHP 论坛？

> ID：859877
> 
> 赞同：2
> 
> 时间：2009-05-13T19:21:09.533
> 
> 标签：php, login, forum

我被分配在我们使用了一段时间的内部 CMS 中添加一个论坛。该系统有自己的登录/用户系统和已建立的用户数据库。理想情况下，我会寻找最简单的论坛软件来转换为与我们的系统一起使用，但如果需要可以重写和迁移用户数据库以使用论坛系统。

有没有人有任何将论坛软件滚动到他们自己的系统中的经验，或者推荐具有干净简洁的代码库且易于使用的论坛软件？在这一点上，任何建议都值得赞赏。

我一直在浏览[opensourcecms.com的](http://opensourcecms.com)[论坛部分](http://php.opensourcecms.com/scripts/show.php?catid=5&cat=Forums)，但可用的详细信息有限。此外，这将在 PHP5 上运行，因此使用 PHP5 的某些功能的程序将是理想的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T19:30:18.020

[phpBB](http://www.phpbb.com/)很棒，它很容易集成到几乎任何东西中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T19:31:09.547

[PHP论坛软件包的维基百科比较](http://en.wikipedia.org/wiki/Comparison_of_Internet_forum_software_(PHP))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T19:24:50.727

试试[Vanilla](http://getvanilla.com/)，免费的开源软件，其设计易于扩展且易于用作应用程序/cms 中的附加组件

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T20:13:07.310

我会推荐[punBB](http://punbb.informer.com/)。它非常简单，重点是安全性。标语是“因为少即是多”。

# django - Eclipse 中的 Django

> ID：859882
> 
> 赞同：1
> 
> 时间：2009-05-13T19:21:37.473
> 
> 标签：django, eclipse, eclipse-plugin

我一直在阅读的关于 Django 的书要求在安装 Python 和导入 Django 方面大量使用命令行。它详细说明了需要哪些命令行命令，无论是从命令行本身还是从 python shell，以便创建新项目、启动 Web 服务器、将模型同步到数据库等等。我也有用于 Ruby on Rails 的 Eclipse。它包含一个 PyDev 插件。是否有通过 Eclipse 的 GUI 方式，以便我不需要经常打开 DOS 窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T19:41:55.270

一些管理任务，如创建项目或同步数据库，最好从命令行完成。就个人而言，我喜欢定义一堆 shell 别名——比如这些： [http](http://ramin.firoozye.com/2008/03/03/django-bash-shell-shortcuts/) ://ramin.firoozye.com/2008/03/03/django-bash-shell-shortcuts/ 所以我不必记得输入所有这些东西。

但是您可以使用 PyDev 和 Eclipse 来启动服务器——这使得设置断点和单步执行代码变得很容易。配置完成后，您只需点击“调试器”按钮，它就会启动 Django 服务器并等待您点击它。

以下是有关如何配置 Pydev 以供 Django 使用的说明：

[http://pydev.blogspot.com/2006/09/configuring-pydev-to-work-with-django.html](http://pydev.blogspot.com/2006/09/configuring-pydev-to-work-with-django.html)

编辑：我错过了你在谈论 DOS。通过使用批处理文件和环境变量，您可以获得与 shell 别名相同的效果。或者使用 Cygwin 并获得一个 bash shell。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-14T17:17:18.973

您可以使用 Komodo Edit... 在这个 IDE 中您可以设置很多命令...

我在我的博客中发布了一个 tuto，但它是葡萄牙语的……如果你愿意，我可以给你发一个 .doc 文件。然后你可以使用谷歌翻译！

[http://chevitarese.wordpress.com.br](http://chevitarese.wordpress.com.br)

Fred Chevitarese - GNU/Linux

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T16:07:36.517

您可以在 Eclipse 中设置一个单独的脚本来使用 subprocess.popen 运行您需要然后等待输入以杀死子进程的命令吗？

# winapi - 批处理 (.bat) 文件的新窗口问题

> ID：859883
> 
> 赞同：3
> 
> 时间：2009-05-13T19:21:44.960
> 
> 标签：winapi, batch-file, cmd

我正在使用批处理文件打开几个新窗口。一旦他们完成了他们的流程，我就有了他们退出的 /c 设置。但是，我希望我的主要批处理过程在继续之前等待一个窗口完成，而不是一次做所有事情。

例如，如果我的主批处理文件有：

**@ECHO 关闭**

**启动 "Win1" cmd.exe /c scomp -out ........\tasks\JARs\MessageLog.jar MessageLog.xsd -compiler "C:\Program Files\Java\jdk1.5.0_18\bin\javac 。可执行程序”**

**启动 "Win2" cmd.exe /c scomp -out ........\tasks\JARs\OwnshipData.jar OwnshipData.xsd -compiler "C:\Program Files\Java\jdk1.5.0_18\bin\javac 。可执行程序”**

我希望 Win1 在文件移动到 Win2 之前完成其执行。但截至目前，它们同时执行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T19:22:52.290

启动/等待“Win1”等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T19:25:01.303

您想使用 /wait，请参阅下面的参考资料。

```
    开始

    在单独的窗口中启动指定的程序或命令。

    句法
          START "title" [/Dpath] [options] "command" [parameters]

    钥匙：
       title : CMD 窗口标题栏的文本（必填）
       路径：起始目录
       command ：要运行的命令、批处理文件或可执行程序
       parameters : 传递给命令的参数

    选项：
       /MIN ：最小化
       /MAX : 最大化
       /WAIT : 启动应用程序并等待它终止
       /LOW : 使用 IDLE 优先级
       /NORMAL : 使用 NORMAL 优先级
       /HIGH ：使用高优先级
       /REALTIME : 使用 REALTIME 优先级

       /B ：启动应用程序而不创建新窗口。在这种情况下
                    ^C 将被忽略 - 将 ^Break 作为唯一的方法
                    中断应用程序
       /I ：忽略对当前环境的任何更改。

       仅适用于 16 位 WINDOWS 程序的选项

       /SEPARATE 从单独的内存空间开始（更健壮）
       /SHARED 在共享内存空间中启动（默认）

```

# javascript - 将 cookie 复制到另一个域

> ID：859893
> 
> 赞同：0
> 
> 时间：2009-05-13T19:22:42.010
> 
> 标签：javascript, iframe, cookies

我在 example.com 上有用户偏好（颜色、区域设置），我想迁移到 example2.com

我想知道是否可以使用 AJAX 或隐藏的 iFrame 将 cookie 信息从 example.com 传递到 example2.com，然后它将在 example2.com 上设置另一个具有相同信息的 cookie。

我知道我可以通过 URL 字符串和重定向轻松地做到这一点，但如果可能的话，我想在后台实现这一点——没有重定向——并且需要在主要浏览器（IE6+、FF1.5+、Safari、歌剧）

关键是这个 cookie 信息不安全，所以没有风险。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:28:46.603

这取决于初学者的浏览器设置，如果浏览器配置为拒绝 3rd 方 cookie，那么你就不走运了。

假设您控制 example.com，并且 cookie 不是仅 HTTP cookie，您可以添加脚本。该脚本将写出一个指向 example2.com 上的脚本的 img 标签，并以 document.cookies 作为参数。在脚本中写出 1x1 透明 gif 并将示例中的 cookie 附加到响应中，解析参数字符串以提取 cookie 名称/值对。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T19:31:07.020

在 example.com 上设置一个路径，该路径生成一个包含传入 cookie 的 javascript 文件。假设它是 example.com/get_cookie.js

然后，您可以从 example2.com 到 example.com/get_cookie.js 进行 ajax 调用以获取这些 cookie，并将它们保存在 example2.com 下。

由于它是跨域的，因此您不能使用 XHR (XmlHttpRequest)，而是将 get_cookie.js 作为 javascript 节点附加，并且该 javascript 文件必须调用回调来向您传递数据。

所以 get_cookie.js 看起来像：

```
return_data( 'here is my example.com cookie info' ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:34:11.167

您需要发出服务器到服务器的 XMLHTTP 请求，并让第二台服务器重新创建 cookie。你不能“通过”它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T19:47:48.943

您是否考虑过使用 Flash Cookie 来存储这些偏好？所有主要浏览器的工作都包括 chrome。

[http://www.ghacks.net/2007/05/04/flash-cookies-explained/](http://www.ghacks.net/2007/05/04/flash-cookies-explained/)

# c# - C# 自定义 EventArgs 问题

> ID：859895
> 
> 赞同：2
> 
> 时间：2009-05-13T19:22:53.477
> 
> 标签：c#, asp.net, events, eventargs

我有一个要添加 ValidateItem 事件的自定义集合。每当在自定义集合中添加或更新项目时，都会调用此 ValidateItem 事件。

我希望允许派生类能够订阅事件并确定它们自己的逻辑来判断一个项目是否“有效”，如果它是“无效”的，则可能禁止将其添加到集合中。

但我试图弄清楚如何让事件的调用者知道发生了什么以及如何传递有关正在发生的事情的信息。

我的自定义 eventargs 继承自 CancelEventArgs，因此我能够使用它将 Cancel 位传递回调用者。但我从未见过以这种方式传回错误信息（错误代码、消息等）的任何情况，所以我想知道这是否不是最好的方法。

我是否应该添加任何我希望传递回自定义 eventargs 类的错误数据，是否有充分的理由支持或反对这一点？还是有其他更好的方法来实现这一点？

这是我的 eventargs 类：

```
public delegate void ItemValidationEventHandler(object sender, ItemValidationEventArgs e);

public class ItemValidationEventArgs : CancelEventArgs
{
    public ItemValidationEventArgs(object item, ObjectAction state, EventArgs e)
    {
        Item = item;
        State = state;
        EventArgs = e;
    }

    public ItemValidationEventArgs(object item, ObjectAction state) : this(item, state, new EventArgs())
    {
    }

    public ItemValidationEventArgs() : this(null, ObjectAction.None, new EventArgs())
    {
    }

    // is there a better way to pass this info?
    public string ErrorMessage {get; set;}
    public int ErrorNumber {get;set;}

    public object Item { get; private set; }
    public ObjectAction State { get; private set; }

    public EventArgs EventArgs { get; private set; }
} 
```

更新：我想另一个选择是使用这样的东西：

```
virtual bool Validate(object item, ObjectAction action, out string errorMessage) 
```

派生类中的方法。虽然我倾向于避免输出参数......

如果有人对每种方法的优缺点有任何想法，我很想听听！

谢谢，马克斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T21:58:28.607

为此使用事件可能不是最好的设计方法。

由于它是一个将覆盖此行为的继承类，因此该方法应标记为受保护的和虚拟的：

```
protected virtual bool Validate(object item); 
```

我也不喜欢使用`out`on 参数，所以按照你最初的直觉使用`EventArgs`，你应该创建一个类来封装你的验证结果。

例子：

```
class ValidationResult
{
     public string ResultMessage{get;set;}
     public bool IsValid {get;set;}
} 
```

您的方法将是：

```
protected virtual ValidationResult Validate(object item)
{
   ValidationResult result = new ValidationResult();

   // validate and set results values accordingly

   return result;
} 
```

使用此 over 事件的优点和缺点是，当您想要向多个订阅者发布操作或信息时使用事件。订阅者是你一无所知的类。你不关心他们是谁或他们做什么。他们也不应该真正将信息传递回通知类。他们应该只处理提供给他们的事件信息。

在您的实例中，您继承的类是您唯一的订阅者。最重要的是，您希望能够将有用的信息传递回父类。继承更适合这种期望的行为，并且还允许您轻松实现不同类型的验证类。对于事件，您必须一遍又一遍地输入代码来附加事件处理程序（非常丑陋的 IMO）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T19:41:12.183

我认为您所描述的内容并不真正适合您通常在事件中看到的观察者、可观察模式。

由于这些是派生类，我可能会考虑虚拟化对象的验证方法并让孩子提供特定的验证例程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:29:34.167

好吧，如果您创建自己的自定义验证事件以及自定义验证事件参数，我会假设您更愿意传回状态/错误代码，而不是在某些事情没有验证时抛出异常。

在这种情况下，如果您想要进行不会引发异常的验证，那么是的，我会将您需要的那些字段添加到您的自定义事件参数中 - 它们已经是自定义的，因此没有理由不扩展它们以适合您的需要:-)

马克

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T19:30:46.507

几个快速的想法：

我会将属性设为只读以符合 eventargs 类的“正常”模式。

也许与错误信息相关的属性应该一起包装到某个 ErrorInformation 类中（这样可以更容易地将该信息传递给其他方法）。

一个问题：您使用 EventArgs 属性做什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T19:33:14.897

自定义事件参数专门用于在事件处理程序之间传递信息，所以是的，它们是放置它们的好地方。

另一种选择是抛出异常 - 这是相当严厉的，但应该阻止其他事件处理程序为该事件执行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T19:40:19.377

EventArgs 和 CancelEventArgs 没有任何成员向订阅者传递信息。因此，您通常会从这些类之一继承并添加一个或多个成员来携带信息。您还可以使您的类成为通用类，这样当您有不同的数据要发送时，您就不必创建新的 EventArgs 类。

最后，您可以使用 ，而不是创建自己的 ItemValidationEventHandler 委托类型，`EventHandler<T>`其中 T 是 EventArgs 参数的类型。

此外，您不需要 EventArgs = e 成员。

# objective-c - 如何在 XCode 中为两种架构（模拟器、iphoneos）构建库

> ID：859909
> 
> 赞同：5
> 
> 时间：2009-05-13T19:25:29.057
> 
> 标签：objective-c, xcode, architecture

我为我想重新分发的 iPhone 制作了一个小库，但我找不到如何编译它以在模拟器和 iphoneos 上工作。我知道有一种方法可以为两种架构构建 lib.a，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-29T06:52:04.780

首先，您显然必须将代码放入框架中。这对于链接到存在于同一个项目中的应用程序来说很好，但正如您所注意到的那样，iPhone 不支持动态链接。

我在谷歌代码上可用的库之一有一个为 iPhone 和 iPhone 模拟器构建自定义 SDK 的脚本。我把脚本放在下面的[StackOverflow 答案](https://stackoverflow.com/questions/1033849/what-are-some-good-xcode-scripts-to-speed-up-development/1082325#1082325)中。这也有代码的链接，因此如果帖子不够，您可以下载并使用项目中的设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-30T21:02:15.550

您可以使用[lipo](http://developer.apple.com/mac/library/documentation/Darwin/Reference/ManPages/man1/lipo.1.html)工具创建包含模拟器、armv6 和 armv7 版本的通用二进制文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-15T09:42:19.053

将 Xcode 目标的“有效架构”设置设置为 i386 和 iPhone 之一（我不知道哪个是，也许有人会建议）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-01T09:50:08.443

这是一种批处理多次构建工作。因此脚本是合适且常规的解决方案。关键概念是混合命令`xcodebuild`和`lipo`.

请参考我对这个问题的回答： [Build fat static library (device + simulator) using Xcode and SDK 4+](https://stackoverflow.com/questions/3520977/build-fat-static-library-device-simulator-using-xcode-and-sdk-4/3616733#3616733)

# jquery - Jquery - 获取具有相同类的多个跨度的文本？

> ID：859910
> 
> 赞同：2
> 
> 时间：2009-05-13T19:25:30.773
> 
> 标签：jquery

我对 jquery 比较陌生，所以我希望这是一个简单的问题。我需要将多个跨度附加到无序列表中的行项目。
本质上，每个行项目都包含一个，我需要获取该跨度的内容并将其附加到它所包含的行项目的底部。这是我目前所拥有的：

**我的jQuery代码：**

```
$("ul").ready(function () {
    var Name = $(".name").text();
    var Content = $(".content").text();
    $("li").append("<span class=\"additional\"><a href=\"/addinfo.php\">" + Name + "'s additional info</a></span>");
}); 
```

**它需要修改的原始HTML：**

```
<ul>
    <li>
        <span class="name">John Doe</span><br />
        <span class="content">John is an excellent Swimmer</span><br />
    </li>
    <li>
        <span class="name">Jane Doe</span><br />
        <span class="content">Jane loves to play basketball</span><br />
    </li>
</ul> 
```

**这是我得到的输出：**

*   John Doe
    John 是一位出色的游泳运动员
    John DoeJane Doe 的附加信息

*   Jane Doe
    Jane 喜欢打篮球
    John DoeJane Doe 的附加信息

**这是期望的结果：**

*   John Doe
    John 是一位出色的游泳运动员
    John Doe 的附加信息

*   Jane Doe
    Jane 喜欢打篮球
    Jane Doe 的附加信息

如您所见，不是将所有“名称”变量放在一起，而是仅使用该行项目的“名称”变量。我确定它需要某种类型的 this、$(this) 或 .each 调用它，但我似乎无法在任何地方的文档中找到它。

有人可以帮忙吗？谢谢！特洛伊

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T19:32:35.847

试试这个

```
$("ul > li").each(function() {
    var Name = $(".name", this) .text();
    var Content = $(".content", this) .text();
    $(this).append("<span class=\"additional\"><a href=\"/addinfo.php\">"+ Name +"'s additional info</a></span>");
}); 
```

这将遍历 UL 列表中的每个 LI，并将它们视为单独的实体。你有两个主要问题。一是您没有限制 jQuery 选择的上下文，因此您获得了两个“.name”类并将它们组合在一起，这就是您获得两个名称的原因。然后您将值添加到所有 LI 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T19:34:44.517

它就在这里：[http ://docs.jquery.com/Core/each#callback](http://docs.jquery.com/Core/each#callback)

我会为所有 LI 元素分配一个类，然后

```
$(".li-class").each(function(){
    var Name = $(".name", this) .text();
    var Content = $(".content", this) .text();
    $(this) .append("<span class=\"additional\"><a href=\"/addinfo.php\">"+ Name +"'s additional info</a></span>");
}); 
```

# algorithm - 将巧克力棒分成等份的算法

> ID：859922
> 
> 赞同：12
> 
> 时间：2009-05-13T19:27:33.907
> 
> 标签：algorithm, geometry, 2d

一个随机的想法突然出现在我的脑海中（当然是在我分享巧克力棒的时候！）。我想知道是否有通用算法来解决这个问题。

问题是这样的：

**信息**

1\. 你有一块巧克力棒，上面有排列成矩形矩阵的小方块
2\. 房间里有 n 个人

**问题**编写一个算法，输出最优配置 (pxq)，其中在以下限制

条件下，条形可以在人们之间平均共享： 1\. 不能将小方块（单位方块）切割成更小的部分2\. 所有休息都必须是完全沿一个轴进行3\. 断裂的总数不能超过 n （这是为了阻止低效的解决方案，例如尝试将整个杆分成小块并将小块分成小块）4\. p 或 q 不能相等to 1\. yx 在其中一个答案中指出，如果一侧有 1 bar，则问题很容易解决。然而，这对于现实世界的情况来说并不是一个好的解决方案——这是解决这个问题的目的:)**示例**`n, n-1, n-2...., 2, 1`

 **对于 n = 4，最佳配置是 4 x 3。** 

 **```
 ~~~~ ~~~~ ~~~~ ~~~~
|    |    |    |    |
 ~~~~ ~~~~ ~~~~ ~~~~
|    |    |    |    |
 ~~~~ ~~~~ ~~~~ ~~~~
|    |    |    |    |
 ~~~~ ~~~~ ~~~~ ~~~~ 
```

这种配置可以分为：

4 人在沿垂直轴的
3 个休息时间 3 人在水平轴上有 2 个休息时间**2**
人在中间有 1 个休息时间

其他经验解决方案是栏的子集（如果适用）。为了更好地说明这一点，假设您有一个像这样的 2 x 2 巧克力棒：`(n, p, q) = (1, 1, 1); (2, 2, 1); (3, 3, 2); (4, 4, 3); (5, 5, 12); (6, 6, 10) OR (6, 5, 12)`

 **```
 ~~~~ ~~~~
|    |    |
 ~~~~ ~~~~
|    |    |
 ~~~~ ~~~~ 
```

传统观点认为，您需要进行 2 次中断（中间的垂直轴 - 向下和交叉）才能将此条分成 4 块。然而，在现实世界中（如果它是一块巧克力棒），你会先把它分成两半，然后再分别分开每一半。这使得总共 3 次休息 - 1 次休息在整个酒吧和 2 次休息在酒吧的 2 个不同的子组。

我在互联网上的任何地方都找不到解决方案 - 如果有人认为这不是与编程相关的问题或解决方案已经存在，请随时关闭问题 =)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T19:50:08.893

在我看来，您正在寻找可以被 1 和 n 之间的所有数字整除的数字。这称为 1, ..., n 的最小公倍数。根据定义，包含 1, ..., n 平方的最小公倍数的正方形可以均匀地分成大小为 1, ..., n 的块。您正在寻找最多 n 个拆分，这会增加问题的额外复杂性，这可能会也可能不会。

您的 n = 4 示例是 LCM(4,3,2,1)，即 12。LCM(5,4,3,2,1) 是 60。LCM(6,5,4,3,2,1 ) 也是 60。

它们总是可以被布置为 1xLCM(n,...,1) 矩形，并且总是可以分成 1,...,n 个甚至 n-1 个或更少分区的堆。

例如，当 n = 4 时，LCM(4,3,2,1) = 12。矩形为

```
############ 
```

并且可以分为以下几种：

```
1: ############     // 0 cuts
2: ###### ######    // 1 cut
3: #### #### ####   // 2 cuts
4: ### ### ### ###  // 3 cuts (3 being n-1) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T00:47:55.630

由于您不能一次切割多件，因此对于您想要的任意数量的件 m，其中 m 在集合 (1..n) 中，您将始终需要 m-1 切割。每次切割都会多制作一件，您从一件开始。

在之前的解决方案的基础上，我认为您正在直观地寻找以下算法：

```
A = LCM(n)
p = greatest divisor of A <= sqrt(A)
q = A/p 
```

这个算法应该是微不足道的，（例如，从 p = floor(sqrt(A)) 开始并倒计时直到 mod(A,p) == 0）。

您想要 sqrt 的原因是限制您检查的数字数量。毕竟，你总是有一个除数 <= sqrt(A) 和一个 >= sqrt(A)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T19:41:16.927

回答这个问题的一个好方法是使用广度优先搜索算法。该算法将尝试整个巧克力棒的所有可能断裂。然后对于每个可能的问题状态，尝试所有可能的中断，这将继续，同时跟踪碎片的均匀性。

我想补充一点，规则将强制巧克力棒的哪些休息是合法的，而那些不合法的可能状态会从算法中剔除。

# jquery - 如何强制 jQuery tablesorter 总是在一个方向上对列进行排序？

> ID：859925
> 
> 赞同：1
> 
> 时间：2009-05-13T19:28:31.237
> 
> 标签：jquery, sorting, tablesorter

我有一个体育赛事的排序结果表。当我单击标题时，我总是希望从最好到最差进行排序。当我再次单击时，我不希望它反转。在某些情况下，“最佳”是最短的时间，而在其他情况下，“最佳”是最大的量（即最大重量，最长距离）。到目前为止，我运气不佳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T21:39:01.210

以前从未使用过 tablesorter，但快速浏览一下，它似乎并没有按照您的意愿开箱即用。以下是我想出的几个（未经测试的）技巧：

一种方法（不修改插件源）是选择[这个示例](http://tablesorter.com/docs/example-trigger-sort.html "通过外部链接排序")，并在标题单元格中添加一个单击事件处理程序，以使用定义的顺序触发您的排序。您可能必须删除 tablesorter 插件添加的处理程序，或从处理程序返回 false，以避免排序两次。

或者，如果您不害怕更改插件源，看起来第 536 行是您想要的：

```
// get current column sort order
this.order = this.count++ % 2; 
```

替换`this.count++ % 2`为`0`升序，`1`降序。您还可以通过添加“强制顺序”作为选项来使其更健壮（参见第 94-114 行），甚至可以将其制成一个数组（如`sortList`）以指示哪些列应该强制执行顺序。

祝你好运！

# linq-to-sql - 在 linq 中插入额外数据到 sql 部分类

> ID：859930
> 
> 赞同：0
> 
> 时间：2009-05-13T19:29:21.890
> 
> 标签：linq-to-sql, partial

我有一个名为 Accounts 的 L2S 生成类，我有一个名为 UsersInAccounts 的 L2S 类 我需要添加一个函数调用 AddUserToAccount(accountid, userid) 应该/可以将此函数添加到我创建的部分 Accounts 类中，或者是用于的部分类获取数据而不是编辑数据

```
 public partial class Account
    {

        public void addUser(Guid userid)
        {
           // code
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T19:45:12.987

我不认为你在做什么是一个问题。在您的代码中，您可能有一个 Account 实例，您希望使用它来执行此操作：

```
Account theAccountIWant = GetTheAccount();
theAccountIWant.addUser(myUsersGUID); 
```

...看起来很直观。在 addUser 方法中进行一些错误捕获并传回某种成功状态可能是一个想法，但这是另一个讨论。

编辑：如建议的那样，如果您随后检索用户对象并希望使用 AccountUsers 属性将其附加到帐户，那么除非您传入 DataContext，否则这是没有用的。

# c# - 在 C# 中使用 Lambda 取消挂钩事件

> ID：859936
> 
> 赞同：5
> 
> 时间：2009-05-13T19:30:08.130
> 
> 标签：c#, events, lambda

我经常遇到想要订阅事件的情况，但我想使用 lambda 来执行此操作：

```
public class Observable
{
    public event EventHandler SomethingHappened;

    public void DoSomething()
    {
        // Do Something...
        OnSomethingHappened();
    }
}

// Somewhere else, I hook the event
observable.SomethingHappened += (sender, args) => Console.WriteLine("Something Happened"); 
```

我遇到的问题是我不知道如何取消事件。由于 lambda 在后台创建了一个匿名委托，所以我没有什么可调用`-=`的。

现在，我可以创建一个方法：

```
private void SomethingHappened(object sender, EventArgs args)
{
    Console.WriteLine("Something Happened");
} 
```

然后我可以随心所欲地钩/解钩：

```
observable.SomethingHappened += SomethingHappened;
observable.SomethingHappened -= SomethingHappened; 
```

但我真的，真的，真的很想用我的 lambda 代替。在一个更复杂的例子中，lambda 在这里非常方便。

我很确定我不走运......但我想知道是否有人想出办法做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T20:01:24.240

这个问题已经被问过了

*   [如何取消订阅使用 lambda 表达式的事件？](https://stackoverflow.com/questions/805829/how-to-unsubscribe-from-an-event-which-uses-a-lambda-expression)
*   [在 C# 中取消订阅匿名方法](https://stackoverflow.com/questions/183367/unsubscribe-anonymous-method-in-c)

答案是：将你的 lambda 放入一个变量中。

```
EventHandler handler = (sender, args) => Console.WriteLine("Something Happened");
observable.SomethingHappened +=  handler;
observable.SomethingHappened -=  handler; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-13T19:32:49.560

不幸的是，没有一个很好的方法来做到这一点。你真的被两种选择之一困住了

*   使用您描述的方法
*   将 lambda 分配给一个变量并使用该变量添加/删除事件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:37:49.490

好吧，如果您知道您的代码是唯一连接事件的代码，则将 null 分配给事件变量将删除所有委托（但如果您希望代码可扩展，则可能是非常糟糕的形式）。

否则，您应该将 lambda 保留在一个单独的变量中，并使用它来取消事件。

# .net - .NET：值类型的“==” op_Equality() 的默认实现在哪里？

> ID：859938
> 
> 赞同：0
> 
> 时间：2009-05-13T19:30:25.477
> 
> 标签：.net, operator-overloading

我在 .NET Reflector 中四处寻找，并注意到对于像“String”这样的引用类型，“==”运算符有一个显式重载：

```
typeof(string).GetMethod("op_Equality", BindingFlags.Static | BindingFlags.Public) 
```

返回：“==”运算符的 System.Reflection.MethodInfo。

由于其实施，您不能执行以下操作：

```
if("hi" == 3)  // compiler error, plus code would throw an exception even if it ran) 
```

然而，同样的事情也适用于值类型：

```
if((int)1 == (float)1.0)  // correctly returns true
if((int)1 == (float)1.2)  // correctly returns false 
```

我试图弄清楚 .NET 内部如何处理类型转换过程，所以我一直在寻找 .NET Reflector 中 op_Equality() 的实现，但“int”没有。

```
typeof(int).GetMethod("op_Equality", BindingFlags.Static | BindingFlags.Public) 
```

返回空值。

那么，值类型的“==”运算符的默认实现在哪里？我希望能够通过反射调用它：

```
public bool AreEqual(object x, object y)
{
    if(x.GetType().IsValueType && y.GetType().IsValueType)
        return x == y; // Incorrect, this calls the "object" equality override
    else
        ...
} 
```

* * *

编辑＃1：

我试过这个，但没有奏效：

```
(int)1 == (float)1;                          // returns true
System.ValueType.Equals( (int)1, (float)1 ); // returns false 
```

* * *

编辑#2：

也试过这个，但没有爱：

```
object x = (int)1;
object y = (float)1.0;

bool b1 = (x == y);                 // b1 = false
bool b2 = ((ValueType)x).Equals(y); // b2 = false 
```

由于这种类型检查（从 .NET Reflector 中提取），我相信 ValueType 上的这个 .Equals 运算符不起作用：

```
ValueType.Equals(object obj)
{
    ...

    RuntimeType type = (RuntimeType) base.GetType();
    RuntimeType type2 = (RuntimeType) obj.GetType();
    if (type2 != type)
    {
        return false;
    }

    ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:38:30.487

(int)1 == (float)1.0 的评估不依赖于任何特殊的 == 运算符，只依赖于转换规则。

编译器会将其转换为 (float)((int)1) == (float)1.0

编辑：规则[在 MSDN](http://msdn.microsoft.com/en-us/library/y5b434w4.aspx)上指定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T19:39:10.127

您正在寻找的是[ValueType.Equals](http://msdn.microsoft.com/en-us/library/2dts52z7.aspx)

在许多情况下，这只是对值进行一点一点的比较。在某些情况下，尽管它会使用反射来验证字段。

**编辑**

您对 C# 如何比较值类型以及 .Net 如何比较值类型感到困惑。ValueType.Equals 是 .Net 中用于比较具有相同类型的值类型对象的函数。C# 将发出最终调用该函数的代码。但它不会用“int”和“float”来称呼它。相反，它首先将它们都转换为不会丢失任何一个值（双精度）的类型，然后比较生成的双精度值。这就是您看到行为差异的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T23:17:53.120

> `==` `op_Equality`值类型的默认实现在哪里？

值类型没有默认`==`值。尝试编写自己的值类型

```
struct JustAnotherValueType
{
  public readonly int Field;
  public JustAnotherValueType(int f) { Field = f; }
} 
```

创建两个值`x`和`y`您的类型。试着`x == y`和他们说。它不会编译。你**可以**说

```
(object)x == (object)y 
```

但这将在`x`（我们称之为框 1）上执行装箱并在`y`（框 2）上进行装箱，然后对两个框执行参考比较。因此它总是返回 false。因此它是无用的，这就是为什么当你在两个之间`==(object x, object y)`使用时不会自动选择重载的原因。`==``JustAnotherValueType`

`int`那么和是怎么回事`float`？你可以和C#比较一下`==`，他们没有`op_Equality`方法？！解释是这些重载是由**[C# Language Specification](http://msdn.microsoft.com/en-us/library/ms228593.aspx)**定义的。请参阅*整数比较运算符*和*浮点比较运算符*部分。

所以事实是，虽然这些运算符不作为 .NET 结构的成员存在，但 C# 语言规范定义了它们，并且 C# 编译器必须生成一些有效的 IL 来模仿它们的行为。

顺便说一句，`System.Object`也没有`op_Equality`。它也仅由 C# 定义。请参阅*参考类型相等运算符*一节。请注意，它`System.Object`有一个`ReferenceEquals`编译器可能选择将此重载`==`转换为的方法。另请注意，规范的这一部分给出了限制，因此`x == y`永远不会在`x`或上执行装箱`y`。

C# 规范中未提及但合法使用的值类型（如`DateTime`、`TimeSpan`和）呢？答案是，这些**确实**有会员。`Guid``==`**`op_Equality`**

 **结论：C# 语言规范定义了许多`==`C# 实现必须具有的重载，其中一些重载涉及`int`and`float`和`object`。

备注：虚拟实例方法`Equals(object)`定义在所有值类型中`object`并被所有值类型继承。对于本身不覆盖此方法的结构，使用`override`in `System.ValueType`。它按值进行比较。所以`x`和`y`上面一样，`x.Equals(y)`会正常工作。`Equals`是一个虚拟实例方法。另一方面`==`是一种`static`“方法”，基于两个操作数的编译时类型执行重载决议（没有“虚拟分派”）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T19:36:34.530

我猜你正在寻找继承到你的结构的[ValueType.Equals(object obj) 。](http://msdn.microsoft.com/en-us/library/2dts52z7.aspx)它使用反射来比较所有字段。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T19:57:29.800

[我](https://stackoverflow.com/questions/384294/where-is-the-implementation-of-internalequalsobject-obja-object-objb/384296#384296)对另一个问题的回答提供了转子实现。实际代码在 CLR 中作为本机代码实现。

具体来说：

```
// Compare the contents (size - vtable - sink block index).
BOOL ret = memcmp(
    (void *) (pThisRef+1), 
    (void *) (pCompareRef+1), 
    pThisRef->GetMethodTable()->GetBaseSize() - sizeof(Object) - sizeof(int)) == 0; 
```

# c - 如何修复诸如“签名和未签名之间的比较”之类的警告？

> ID：859943
> 
> 赞同：16
> 
> 时间：2009-05-13T19:31:05.553
> 
> 标签：c

有人建议我对 GCC 使用以下选项，因为它有助于避免许多常见错误。它会打开一堆警告并将`-Werror`它们变成错误。

```
gcc -pedantic -W -Wall -Wextra -Wshadow -Wstrict-overflow=5 -Wwrite-strings -std=c99 -Werror 
```

给定以下测试代码：

```
#include <stdio.h>

int main(void)
{
    int arr[8]={0,10,20,30,40,50,60,70};
    int x;

    printf("sizeof(arr): %d\n", sizeof(arr));
    printf("sizeof(int): %d\n", sizeof(int));

    for(x = 0; x < sizeof(arr)/sizeof(int); x++)
    {
        printf("%d\n",arr[x]);
    }

    return 0;
} 
```

我明白了：

```
test.c:11: error: comparison between signed and unsigned 
```

我知道我可以解决此问题的一种方法是关闭警告，但它们并没有让我最终使用这些设置将它们关闭。

另一种方法是铸造这些东西，但有人告诉我铸造已被弃用。

另外，我可以将 x 变成`unsigned int`：

```
unsigned x; 
```

但是当我必须使用这些编译器选项将有符号值与无符号值进行比较时，它并不能解决一般问题。有没有比铸造更清洁的方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-13T19:37:05.153

代替

```
int x;
/* ... */
for(x=0;x<sizeof(arr) / sizeof(int);x++) 
```

经过

```
for(size_t x=0;x<sizeof(arr) / sizeof(int);x++) 
```

> 但是当我必须使用这些编译器选项将有符号值与无符号值进行比较时，它并不能解决一般问题。有没有更清洁的铸造方式？

在这种情况下，试着弄清楚有符号数是否可以有一个会导致溢出的值。如果没有，您可以忽略警告。否则，强制转换为无符号类型（如果它与有符号组件大小相同或更大）就足够了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-13T19:37:07.353

这实际上取决于数据类型。可以通过将值隐式转换为包含有符号和无符号类型中所有可用值的超集的类型来避免这种情况。例如，您可以使用 64 位有符号值来比较无符号 32 位和有符号 32 位值。

但是，这是一个极端情况，您需要执行诸如验证类型大小之类的操作。您最好的解决方案是对两个操作数使用相同的类型。

如果您必须强制转换，请考虑您可能会导致溢出，并考虑这对您的应用程序是否重要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T19:39:18.083

问题的症结在于比较有符号和无符号值会承认一些奇怪的情况。例如，考虑在无符号数组长度中发生的情况大于可以由有符号整数表示的最大值。有符号计数器溢出（剩余“小于”数组大小），您开始寻址您不打算的内存......

编译器会生成警告以确保您正在考虑它们。使用`-Werror`将该警告升级为错误并停止编译。

要么严格选择类型的签名，要么在确定它不适用时摆脱麻烦，或者摆脱`-Werror`并使其成为通过修复或解释来解决所有警告的策略......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-18T21:30:37.350

一种解决方法是在这种特殊情况下选择性地禁用该警告。GCC[已忽略编译指示诊断](https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html)“-Wsomething”

```
// Disable a warning for a block of code:
#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wmissing-prototypes"
// ... Some code where the specified warning should be suppressed ...
#pragma GCC diagnostic pop 
```

GCC 的最新版本（我实际上不确定从什么时候开始，但 4.8.x 应该支持它）显示相应的 -Wsomething 选项。这很重要，因为大多数警告选项都没有明确设置，而是与 -Wall 等选项一起设置。错误消息如下所示：

```
readers.c: In function ‘buffered_fullread’:
readers.c:864:11: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]
    if(got < sizeof(readbuf)) /* That naturally catches got == 0, too. */ 
```

[-Werror=sign-compare] 部分告诉您您可以对“Wsomething”使用“Wsign-compare”来抑制警告。

当然，您应该只在适当的地方这样做（它不太有助于提高可读性），例如，当需要编译器警告的行为时（或者，如果您可能不会在代码库中引入更大的更改）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-02T10:36:54.983

一种选择是附加标志“-Wno-sign-compare”:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T19:34:40.133

```
test.c:11: error: comparison between signed and unsigned 
```

您可以将 x 声明为无符号整数，因为 size_t 是无符号的

编辑：

如果您不想投射，并且不想将其声明为未签名，我认为没有什么可做的。

也许按位运算是解决它的一种方法，删除符号位。我不得不说，IMO 非常值得怀疑。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T19:42:03.320

我们在 Visual Studio 编译中禁止此警告，因为它经常发生并且几乎从不意味着任何重要的事情。当然，并非所有编码标准都允许这样做。

您可以使类型一致（例如，将变量声明为 size_t 或 unsigned int 而不是 int），或者您可以强制转换，或者您可以更改编译行。就是这样。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T19:51:17.580

不管铸造弃用困境如何，我仍然建议将逻辑从 for 循环中分离出来。

```
int range = (int)(sizeof(arr) / sizeof(int));
int x;

for(x = 0; x < range; x++)
{
    printf("%d\n", arr[x]);
} 
```

尽管这使用了您所说的已弃用的铸造，但它清除了铸造发生的位置。一般来说，我建议不要将大量逻辑塞进你的 for 循环声明中。特别是在您使用 size_t 除法的情况下，它（因为它是整数除法）可能会截断答案。for 循环声明应该是干净的，并且应该不会产生错误。您的转换发生在不同的位置，这意味着如果您想更改创建范围的方式，您不必为使 for 声明更长的时间而烦恼。

# .net - 导出到 Excel 格式

> ID：859948
> 
> 赞同：0
> 
> 时间：2009-05-13T19:31:57.860
> 
> 标签：.net, excel, datagrid

我已经建立了一个基本的 html 表格，每个单元格中都有一个阅读器（不要问），它导出到 excel，我也有一个导出到 excel 的数据网格。两者在实际创建电子表格方面都没有问题，但我对格式有疑问。每个单元格内都有一个名称列表，即：

Bob Smith Jim Bob John Miller Susie Q Jane Doe

当电子表格出现时，它将每个名称放在一个单独的“子单元格”中，而不是将它们全部放在一个单元格中。有没有办法让每个 html 表格单元格中的名称都在一个 Excel 单元格中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T19:35:16.343

您可以尝试用引号将它们括起来，例如“Bob Smith”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T05:58:56.817

这可能`<br>`是创建子细胞的原因。尝试使用 "& chr(13)" 或 "& vbCrLf" 甚至 "\r\n" 代替。

在格式化内容方面，Excel 是一个完整的废话。因此，我经常避免直接导出到 excel 并提供报告的视图，该视图可以复制并粘贴到 excel 中。

例如，我有一份报告，我的用户可以单击按钮以 3 种不同的方式查看：

1.  具有排序、列大小调整等功能的 YUI 增强 html 表（非常适合浏览器，但很难正确粘贴到 excel 中）
2.  一个简单的 HTML 表格，用户可以很容易地复制并粘贴到 Excel 中。使用 html 表格，每个表格`<TD>`对应一个单元格并且`<tr>`是一行。
3.  一个 CSV 视图，也可以粘贴到 Excel 或记事本中。

我所做的只是编写一个格式方法，我可以将标题前缀/后缀、行前缀/后缀、列前缀/后缀和表前缀/后缀作为参数传递。我会根据 GET 参数将适当的参数传递给格式方法。

# iphone - 是否允许在 iPhone 应用商店应用中包含 libCurl？有人做过吗？

> ID：859949
> 
> 赞同：4
> 
> 时间：2009-05-13T19:32:15.177
> 
> 标签：iphone, web-services, libcurl

我想在应用程序中使用 libCurl 与 Web 服务进行通信，不幸的是它不包含在 iPhone SDK 中。现在我已经弄清楚如何在我的应用程序中包含 Curl 作为静态库，但是，我想知道这是否会让我的应用程序被 Apple 拒绝。是否有人将 Curl 包含在应用程序中并获得了 Apple 的批准？

谢谢你。

编辑：我想我应该更清楚，我想知道是否有人真的这样做了，因为我不确定 Curl SDK 是否包含未记录的功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T20:21:10.387

从 curl 许可证 ( [http://curl.haxx.se/docs/copyright.html](http://curl.haxx.se/docs/copyright.html) ) 中可以看出，在 iPhone 应用程序中使用它是完全允许的，因为许可证中基本上没有规定任何限制。

关于 Apple 的分发限制是否禁止在您的应用程序中使用 GPL 软件存在一些争论，但 curl 未获得 GPL 许可。

我不是律师，您可能应该与一位律师确认一下。软件开发是不是很有趣！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T20:25:18.290

由于 libcurl 是[MIT 许可](http://curl.haxx.se/docs/copyright.html)的，因此我在静态链接时不会预见到任何许可问题。

编辑：如果您的应用程序是 GPL 许可的，则 libcurl 的某些配置无法[合法链接和分发](http://curl.haxx.se/legal/licmix.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T00:26:56.710

我使用 NSURLConnection 和相关的类来与我的应用程序中的 Web 服务通信。我已经阅读（但没有第一手经验），使用标准套接字接口的代码可能会出现问题，即当手机进入睡眠状态时套接字会消失，并且不会在唤醒时恢复。完全跳过使用 Curl 可能更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-12T07:44:45.747

我想你可以。如果您需要交叉编译 libcurl，请访问我的教程： [http ://sites.google.com/site/olipion/cross-compilation/libcurl](http://sites.google.com/site/olipion/cross-compilation/libcurl)

我展示了如何使用 libssh2 支持交叉编译它。

问候，奥利皮恩。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T22:43:10.590

我不相信 Apple 关心您在应用程序中使用的库，只要它们是静态链接的。我的意思是，如果您违反了他人知识产权的许可协议（我认为您不是），他们为什么会在意？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-02T15:45:31.247

I think its more an issue of what you do with it, since curl can be used to do a lot of things that may "toe the line" as far as legality (such as bots) some things done with curl are best not put into applications that are distributed / sold to 3rd parties, but if you're just doing stuff thats plainly allowed, such as connecting to an API, I don't see why it would be an issue, and I don't think Apple would get involved either way other than disapproving your app if they thought you stepped over the lines, but they wouldn't be directly affected by it so its unlikely they would do anything more than that.

# c++ - 什么| 运算符在函数调用中的意思？[C++]

> ID：859963
> 
> 赞同：2
> 
> 时间：2009-05-13T19:34:20.870
> 
> 标签：c++, winapi

我通常在查看 Win32 gui 代码时看到这一点。我的假设是它是标准的按位或，但我也偶尔会在 C# 中看到它，而且似乎会有更好（更高级别）的方式来做同样的事情。无论如何，这是一个例子：

```
MessageBox(NULL, "Window Creation Failed!", "Error!", MB_ICONEXCLAMATION | MB_OK); 
```

谢谢，

西莫

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-13T19:36:11.037

该| 是按位或。MB_OK 和 MB_ICONEXCLAMATION 是定义的常量，它们是 2 的幂（例如 32 或 128），因此按位或可以组合它们（128 | 32 将是 160，其中设置了两个位）。当这些位用作标志时，这是正常的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-13T19:37:10.397

它用于位掩码。让我们使用这个非常简单的例子。您有一个颜色的二进制值，具有以下值。

100 = 蓝色

010 = 红色

001 = 绿色

当你说 SomeFunction ( BLUE | RED | GREEN ); 您实际上传递了值 111，然后可以将其解码为表示蓝色、红色和绿色。

谷歌按位运算符了解更多详情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T19:34:55.390

就像其他地方一样，它是按位或运算符。基本上，当您要设置一些不互斥的属性时，会使用此技术。

该函数可以使用如下代码轻松检查它们：

```
if (arg & MB_ICONEXCLAMATION) { // Show an exclamation icon...

}

// ...

if (arg & MB_OK) { // Show an OK button

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T19:41:15.583

将 MB_ICONEXCLAMATION 和 MB_OK 视为“选项”，它们并不比整数更高级。您关心的是这些整数的位表示。

说：

```
//MessageBox.cs or whatever
public static int MB_ICONEXCLAMATION = 0x1 // 0001 in binary
public static int MB_OK = 0x2 // 0010 in binary 
```

当你将它们组合在一起时，你会得到二进制的 0011。因此，您只使用一个参数来请求 MessageBox 的两个选项，而不必有更多参数，一个用于您要指定的每个选项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T19:35:12.303

这是一个按位或。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T19:34:58.417

它执行按位或。

整数 x = 5 | 3；// x == 7 现在

# c# - Linq ExecuteCommand 不理解空值

> ID：859985
> 
> 赞同：22
> 
> 时间：2009-05-13T19:37:53.997
> 
> 标签：c#, linq-to-sql, null

使用 linq 将空值传递给 ExecuteCommand() 方法时遇到问题。我的代码类似于以下代码：

```
 public void InsertCostumer(string name, int age, string address)
    {
        List<object> myList = new List<object>();

        myList.Add(name);
        myList.Add(age);
        myList.Add(address);

        StringBuilder queryInsert = new StringBuilder();
        queryInsert.Append("insert into Customers(name, address) values ({0}, {1}, {2})");

        this.myDataContext.ExecuteCommand(queryInsert.ToString(), myList.ToArray());
    } 
```

但是，当参数为空（例如地址）时，我收到以下错误：“查询参数不能属于‘System.Object’类型。”

如果没有参数为空，则不会发生错误。我知道我的示例中的设计有点糟糕，我只是创建了一个简化的示例来关注这个问题。有什么建议么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-07-31T12:24:59.887

这是一个已知错误，Microsoft 不打算修复它...

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=305114&wa=wsignin1.0](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=305114&wa=wsignin1.0)

解决方法是：

1.  放入 ADO.NET 并直接执行 SQL 命令
2.  格式化您自己正在执行的字符串并使用空对象数组（新对象 [0]）调用 ExecuteCommand

第二个不是一个好主意，因为它使您容易受到 SQL 注入攻击，但它是一种快速破解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-19T21:56:28.677

[凯文是对的](https://stackoverflow.com/a/1212258/2055187)。

他在 LinqPad 中 #1 附近的工作示例。需要这个**（对象）s??DBNull.Value**

```
string s = null; 

//ExecuteCommand("insert into T(C1) values({0})", s); //Exception

SqlCommand cmd= new SqlCommand(){
    CommandText = "insert into T(C1) values(@P0)",
    Connection = new SqlConnection(this.Connection.ConnectionString),
};
//cmd.Parameters.AddWithValue("@P0", s); //SqlException
cmd.Parameters.AddWithValue("@P0", (Object)s??DBNull.Value);
cmd.Connection.Open();
cmd.ExecuteNonQuery();
cmd.Connection.Close();

Ts.OrderByDescending(t=>t.ID).Take(1).Dump(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:55:55.967

您是否尝试过为那些为空的赋值？含义（伪）：

如果地址为空，则地址 = "" 或如果年龄 < 0 则年龄 = 0

然后将其添加到 myList

或者你总是可以使用三元运算符：

```
name = name.Length < 1 ? "" : name;
age = age < 1 ? Int32.MinValue : age; 
```

然后将其添加到 myList

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-16T16:35:54.317

对我来说同样的问题。太愚蠢的MS不解决这个问题。这是我的解决方案，虽然我不支持所有参数类型，但你明白了。我把它卡在 DataContext 类中，所以它看起来像是内置到 Linq 中的 :) 。

```
 public int ExecuteCommandEx(string sCommand, params object[] parameters)
    {
        object[] newParams = new object[parameters.Length];

        for (int i = 0; i < parameters.Length; i++)
        {
            if (parameters[i] == null)
                newParams[i] = "NULL";
            else if (parameters[i] is System.Guid || parameters[i] is System.String || parameters[i] is System.DateTime)
                newParams[i] = string.Format("'{0}'", parameters[i]);
            else if (parameters[i] is System.Int32 || parameters[i] is System.Int16)
                newParams[i] = string.Format("{0}", parameters[i]);
            else
            {
                string sNotSupportedMsg = string.Format("Type of param {0} not currently supported.", parameters[i].GetType());
                System.Diagnostics.Debug.Assert(false, sNotSupportedMsg);
            }
        }

        return ExecuteCommand(string.Format(sCommand, newParams));
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T06:36:57.420

我使用这样的东西（注意我使用的是 SO“IDE”，所以我不能，保证这将编译或正常工作，但你会明白的）

```
 public void InsertCostumer(string name, int age, string address)
    {
        List<object> myList = new List<object>();

        myList.Add(name);
        myList.Add(age);
        myList.Add(address);

        StringBuilder queryInsert = new StringBuilder();
        queryInsert.Append("insert into Customers(name, age, address) values (");
        int i = 0;
        foreach (var param in myList.ToArray())
        {
            if (param == null)
            {
                queryInsert.Append("null, ");
                myList.RemoveAt(i);
            }
            else
            {
                queryInsert.Append("{" + i + "}, ");
                i++;
            }
        }

        queryInsert.Remove(queryInsert.Length - 2, 2);
        queryInsert.Append(")");

        this.myDataContext.ExecuteCommand(queryInsert.ToString(), myList.ToArray());
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-13T14:19:40.300

我创建了一个通用的 ParamArray 函数来传递我通常会传递给 ExecuteCommand 的参数。然后让它传回未解释的 SQL 参数和实际传入的对象列表。

```
Public Sub CommitRecords(ByVal InItems As List(Of Item)
    Dim db As New DataContext(ConnectionString)
    Try
        For Each oItem In InItems 
            With oItem
                Dim strParms As String = ""
                Dim collParms = BuildExecuteCommandParms(strParms, .MapValue1, .MapValue2, .MapValue3, .MapValue4, .MapValue5, .MapValue6)

                db.ExecuteCommand("Insert Into ItemTable (Value1, Value2, Value3, Value4, Value5, Value6)" & vbCrLf & _
                                    "Values (" & strParms & ")", _
                                    collParms.ToArray)
            End With
        Next

    Catch ex As Exception
        MessageBox.Show(ex.Message)
    End Try
End Sub

Public Function BuildExecuteCommandParms(ByRef strParms As String, ByVal ParamArray InParms As Object()) As List(Of Object)
    Dim i As Integer = 0
    Dim collOutParms As New List(Of Object)
    For Each oParm In InParms
        If i <> 0 Then strParms &= ", "
        If oParm Is Nothing Then
            strParms &= "NULL"
        Else
            strParms &= "{" & i & "}"
            collOutParms.Add(oParm)
        End If
        i += 1
    Next
    Return collOutParms
End Function 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-18T15:22:58.040

我通常使用这种东西，并不理想，但如果你被卡住了，它就可以完成

```
 if (myObject != null)
            {
                foreach (var p in ct.GetType().GetProperties())
                {
                    if (p.GetValue(myObject , null) == null)
                    {
                        if (p.PropertyType == typeof(string))
                        {
                            p.SetValue(myObject , "Empty", null);
                        }
                        if (p.PropertyType == typeof(int))
                        {
                            p.SetValue(myObject , 0, null);
                        }
                        if (p.PropertyType == typeof(int?))
                        {
                            p.SetValue(myObject , 0, null);
                        }

                    }
                }
            } 
```

这确保在您使用 ExecuteCommand 中的参数之前，对象中的每个值都有一个值。同样，并不理想，但它有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-29T21:08:23.863

我不喜欢使用 string.format，因为（正如该问题的当前选定答案所说）您正在向 SQL 注入敞开心扉。

所以我通过遍历参数解决了这个问题，如果参数为空，我将 NULL 作为字符串添加到命令文本中，如果它不为空，我添加一个占位符，它将被替换（类似于 string.format） ExecuteQuery（执行 SQL 注入检查）的值。

```
 private static T ExecuteSingle<T>(string connectionString, string sprocName, params object[] sprocParameters)
        where T : class
    {
        var commandText = sprocName;
        if (sprocParameters.Length > 0)
        {
            // http://stackoverflow.com/questions/859985/linq-executecommand-doesnt-understand-nulls
            int counter = 0;
            var nulledPlaceholders = sprocParameters
                .Select(x => x == null ? "NULL" : "{" + counter ++ + "}");

            commandText += " " + string.Join(",", nulledPlaceholders);
            sprocParameters = sprocParameters.Where(x => x != null).ToArray();
        }
        var connection = new SqlConnection(connectionString);
        var dc = new DataContext(connection);
        return dc.ExecuteQuery<T>(commandText, sprocParameters).SingleOrDefault();
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-06-27T18:28:05.227

```
internal static class DataContextExtensions
{
    public static int ExecuteCommandEx(this DataContext context, string command, params object[] parameters)
    {
        if (context == null)
            throw new ArgumentNullException("context");
        if (parameters != null && parameters.Length > 0)
            parameters = parameters.Select(p => p ?? "NULL").ToArray();
        return context.ExecuteCommand(command, parameters);
    }
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-07-13T00:22:15.603

为什么不使用可空值？

```
public void InsertCostumer(string? name, int? age, string? address)
{
    List<object> myList = new List<object>();

    myList.Add(name.GetValueOrDefault());
    myList.Add(age.GetValueOrDefault());
    myList.Add(address.GetValueOrDefault());

    StringBuilder queryInsert = new StringBuilder();
    queryInsert.Append("insert into Customers(name, address) values ({0}, {1}, {2})");

    this.myDataContext.ExecuteCommand(queryInsert.ToString(), myList.ToArray());
} 
```

* * *

## 回答 #11

> 赞同：-6
> 
> 时间：2009-07-13T00:39:34.407

在 .NET 中，null/nothing 字符串不会计算为空字符串，即“”。如果你想要“”，那么它必须是字符串的值，或者如果你想在 SQL 中表示 null/nothing，如果你的 .NET 字符串实际上是 null/nothing，则必须手动写出“NULL”。

执行命令所做的只是执行一个 SQL 查询，由您提供，作为一个字符串。就该 SQL 字符串而言，它没有做任何其他特别的事情。

因此，要使执行命令起作用，您必须传入一个有效的 SQL 字符串，您必须手动正确地构造该字符串。

# mysql - 幻影Joomla！记录

> ID：859988
> 
> 赞同：0
> 
> 时间：2009-05-13T19:38:34.887
> 
> 标签：mysql, joomla

我对 Joomla 有一个非常奇怪的问题。当我链接到或直接提取记录#571 时，显示的不是数据库中的内容。事实上，显示的内容根本不在数据库中。我已经在所有字段中搜索了与本文内容（过去创建）的任何相似之处，但我找不到任何对它的引用。我曾尝试使用 mysql CLI 和 Joomla 文章管理器来执行此操作，但没有证据表明可以在任何地方找到此记录。

有没有人经历过这样的事情？这到底是什么原因造成的，我的意思是，如果数据不在数据库中并且存在具有此 ID 的有效记录，那么这到底是如何显示的！？

——尼古拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T20:12:42.287

可能是您的记录是从另一个数据库加载的吗？这是新服务器上的全新安装吗？

检查您的 configuration.php 文件 arround line 30 - 35 for

```
var $dbtype = 'mysql';
var $host = 'localhost';
var $user = 'root';
var $db = 'joomla'; 
```

你永远不会知道...！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T22:24:51.480

问题出在我们的 MySQL 复制过程中，原因尚待确定，原因是记录未同步，因此删除记录（即使它在数据库中是正确的），重新创建并更新链接已解决问题。

——尼古拉斯

# wcf - 将原始类型传递给 WCF RESTful 服务

> ID：859998
> 
> 赞同：1
> 
> 时间：2009-05-13T19:41:10.653
> 
> 标签：wcf, json, rest, primitive-types

在过去的几个小时里，我一直在用头撞墙，这就是我们正在尝试做的事情：一个方法需要一个原始/简单类型作为请求主体。最初我们尝试使用布尔值，但这不起作用，所以我们尝试使用字符串和对象。一样。

这是服务器端代码

```
[OperationContract]
[WebInvoke(UriTemplate = "/foo/{foo_id}/bar", Method = "POST", ResponseFormat=WebMessageFormat.JSON)]
string G(string foo_id, string content); 
```

这是 Fiddler 中的请求：

标题：

```
User-Agent: Fiddler
Host: localhost
Content-Type: 'application/json',
Content-Length: 19 
```

身体：

```
"hello_world" 
```

我们尝试包装`"hello_world"`一个 json 对象，例如 {"content":"hello_world"} 但没有运气。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T21:04:36.227

对我来说很好，这是我的代码：

```
[OperationContract]
[WebInvoke(UriTemplate = "/foo/{foo_id}/bar", Method = "POST", ResponseFormat = WebMessageFormat.Json, RequestFormat = WebMessageFormat.Json)]
public string G(string foo_id, string content)
{
    return content + foo_id;
} 
```

您没有设置请求格式（我知道很痛苦:)）

这是我的提琴手请求：

```
User-Agent: Fiddler
Content-Type: application/json
Host: localhost:54287
Content-Length: 7
"Hello" 
```*********~~************~~~~