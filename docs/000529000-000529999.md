# StackOverflow 问答 000529000-000529999

# c# - 使用 System.Xml.Linq API 设置 XML 命名空间

> ID：529007
> 
> 赞同：3
> 
> 时间：2009-02-09T17:07:52.553
> 
> 标签：c#, xml, linq-to-xml, xnamespace

我无法按照以下方式生成 XML：

```
<Root xmlns:brk="http://somewhere">
<child1>
    <brk:node1>123456</brk:node1>
    <brk:node2>500000000</brk:node2>
</child1>
</Root> 
```

这段代码让我得到了大部分的帮助，但我无法在节点前面获得“brk”命名空间；

```
 var rootNode = new XElement("Root");
 rootNode.Add(new XAttribute(XNamespace.Xmlns + "brk", "http://somewhere"));

 var childNode = new XElement("child1");
 childNode.Add(new XElement("node1",123456));
 rootNode.Add(childNode); 
```

我试过这个：

```
XNamespace brk = "http://somewhere";
childNode.Add(new XElement(brk+"node1",123456)); 
```

和这个

```
XNamespace brk = "http://somewhere";
childNode.Add(new XElement("brk:node1",123456)); 
```

但两者都会导致异常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T17:27:12.227

您快到了，但您在第一个代码示例中犯了一个简单的错误。我相信这是您需要的：

```
XNamespace brk = "http://somewhere.com";
XElement root = new XElement("Root",
    new XAttribute(XNamespace.Xmlns + "brk", "http://somewhere.com"));

XElement childNode = new XElement("child1");
childNode.Add(new XElement(brk + "node1",123456));
root.Add(childNode); 
```

这里的主要区别是我添加`node1`如下`childNode`：

```
childNode.Add(new XElement(brk + "node1",123456)); 
```

这段代码，给定一个`XmlWriter`并`XDocument`给我输出：

```
<?xml version="1.0" encoding="utf-8"?>
<Root xmlns:brk="http://somewhere.com">
  <child1>
    <brk:node1>123456</brk:node1>
  </child1>
</Root> 
```

有关[使用](http://msdn.microsoft.com/en-us/library/system.xml.linq.xnamespace.aspx)[`XNamespace`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xnamespace.aspx). _

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T12:00:22.037

这是独奏并且工作正常。

```
 using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Windows.Forms;
    using System.Xml;
    using System.Xml.Linq;
    using System.Xml.XPath;
    using System.Xml.Serialization;

    namespace CreateSampleXML
    {
        public partial class Form1 : Form
        {
            public Form1()
            {
                InitializeComponent();            
                XNamespace xm = "http://somewhere.com";
                XElement rt= new XElement("Root", new XAttribute(XNamespace.Xmlns + "brk", "http://somewhere.com"));
                XElement cNode = new XElement("child1");
                cNode.Add(new XElement(xm + "node1", 123456));
                cNode.Add(new XElement(xm + "node2", 500000000));
                rt.Add(cNode);
                XDocument doc2 = new XDocument(rt);
                doc2.Save(@"C:\sample3.xml");
            }
        }       
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-26T14:36:03.030

我认为问题在于根元素也需要具有命名空间：

```
XElement root = new XElement("Root",
    new XAttribute(XNamespace.Xmlns + "brk", "http://somewhere.com")); 
```

需要是：

```
XElement root = new XElement(brk + "Root",
    new XAttribute(XNamespace.Xmlns + "brk", "http://somewhere.com")); 
```

# c# - Crystal Reports 导出的参数问题

> ID：529010
> 
> 赞同：1
> 
> 时间：2009-02-09T17:08:52.893
> 
> 标签：c#, pdf, crystal-reports

我正在尝试将水晶报告导出为 pdf，然后通过电子邮件发送，但每次我收到导出命令时，都会收到 ParameterFieldCurrentValue 异常。

我已经在 ReportDocument 中跟踪了 Parameter 集合的值，并且正在那里设置这些值。此外，所有四个参数都是字符串。第一个设置为允许多个值以及离散值或范围值。我调用的对话框为该参数的可选选项设置值。没有其他参数字段。但是，报告中有公式字段。

我的代码是：

```
SelectionDialog sd = new SelectionDialog(null, null, 
@"\\er1\common\bfi_apps\ReportMasterTwo\eds\custno.csv", true, false);
DialogResult dr = sd.ShowDialog();
string filename = @"c:\documents and settings\aap\desktop\salesanalysis.pdf";

if (dr == DialogResult.OK && sd.selectedVals != null)
{
    for (int i = 0; i < sd.selectedVals.Count; i++)
    {
        ar100SalesABC_edcustom1.Parameter_Customer_Number.CurrentValues.AddValue
    (sd.selectedVals[i]);
    }

    ar100SalesABC_edcustom1.Parameter_Fiscal_period.CurrentValues.AddValue("1");
    ar100SalesABC_edcustom1.Parameter_Fiscal_year.CurrentValues.AddValue("2007");
    ar100SalesABC_edcustom1.Parameter_Product_Type.CurrentValues.AddValue("F");

    ar100SalesABC_edcustom1.ExportToDisk
    (ExportFormatType.PortableDocFormat, filename); // ERROR HAPPENS HERE

    // .. emailing code and other stuff
} 
```

我究竟做错了什么？还有其他更好的方法吗？我已经尝试过导出选项，我已经尝试过 SetParameter，但我一直收到该错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T14:15:00.883

我最终使用 SetParameter 而不是当前值方法，并为多值参数使用值集合。

另外，我没有使用类型化的报告，而是使用了非类型化的报告文档。

我还从 Crystal Reports 复制了 sql 并用它来制作数据集。我认为数据集是我之前缺少的部分。

它现在可以工作了，尽管它看起来不像上面的代码。

# c# - sp_changeobjectowner

> ID：529032
> 
> 赞同：0
> 
> 时间：2009-02-09T17:14:43.410
> 
> 标签：c#, sql, sql-server

我从 C# 调用 SQL 的 sp_changeobjectowner。我想稍后检查它是否有效。如何检查表的所有者是否是我想要的人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T17:21:36.933

这将为您提供当前所有者名称

```
select user_name(uid)
from sysobjects
where name = 'myTableName' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T17:22:38.103

您可以使用 sp_changeobjectowner 的返回值。成功返回 0，否则返回 1。

# python - Python：长时间运行的进程通过还是休眠？

> ID：529034
> 
> 赞同：57
> 
> 时间：2009-02-09T17:15:42.113
> 
> 标签：python

我正在编写一个队列处理应用程序，它使用线程等待和响应要传递到应用程序的队列消息。对于应用程序的主要部分，它只需要保持活动状态。对于如下代码示例：

```
而真：
  经过

```

或者

```
而真：
  时间.sleep(1)

```

哪一个对系统的影响最小？什么都不做但保持 Python 应用程序运行的首选方法是什么？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-02-09T17:20:00.933

我想*time.sleep()*在系统上的开销会更少。使用*pass*将导致循环立即重新评估并锁定 CPU，而使用 time.sleep 将允许暂时暂停执行。

**编辑**：只是为了证明这一点，如果你启动 python 解释器并运行它：

```
>>> while True:
...     pass
... 
```

你可以看到 Python 立即开始消耗 90-100% 的 CPU，而不是：

```
>>> import time 
>>> while True:
...     time.sleep(1)
... 
```

它甚至几乎没有在活动监视器上注册（这里使用 OS X，但每个平台都应该是相同的）。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-02-09T18:41:46.867

为什么要睡觉？你不想睡觉，你想等待线程完成。

所以

```
# store the threads you start in a your_threads list, then
for a_thread in your_threads:
    a_thread.join() 
```

参见：[thread.join](http://www.python.org/doc/2.5.2/lib/thread-objects.html#l2h-3460)

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2018-02-05T21:34:03.227

如果您正在寻找一种短的、零 CPU 的方式来永远循环直到键盘中断，您可以使用：

```
from threading import Event

Event().wait() 
```

注意：由于[一个错误](https://bugs.python.org/issue8844)，这仅适用于 Python 3.2+。此外，它似乎不适用于 Windows。出于这个原因，`while True: sleep(1)`可能是更好的选择。

对于某些背景，`Event`对象通常用于等待长时间运行的进程完成：

```
def do_task():
    sleep(10)
    print('Task complete.')
    event.set()

event = Event()
Thread(do_task).start()
event.wait()

print('Continuing...') 
```

哪个打印：

```
Task complete.
Continuing... 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-12-11T13:49:29.693

`signal.pause()`是另一种解决方案，请参阅[https://docs.python.org/3/library/signal.html#signal.pause](https://docs.python.org/3/library/signal.html#signal.pause)

> 使进程休眠，直到收到信号；然后将调用适当的处理程序。什么都不返回。不在 Windows 上。（参见 Unix 手册页 signal(2)。）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-09T17:18:45.757

我一直看到/听说使用睡眠是更好的方法。使用 sleep 将使您的 Python 解释器的 CPU 使用率不会变得疯狂。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-09T17:27:08.653

您没有为您真正在做的事情提供太多背景信息，但也许[`Queue`](http://www.python.org/doc/2.5.2/lib/module-Queue.html)可以使用它来代替显式的忙等待循环？如果不是，我认为`sleep`会更可取，因为我相信它会消耗更少的 CPU（正如其他人已经指出的那样）。

[根据下面评论中的附加信息进行编辑。]

也许这很明显，但无论如何，在您从阻塞套接字读取信息的情况下，您*可以*做的是让一个线程从套接字读取并将适当格式的消息发布到 a`Queue`中，然后让其余的“工人”从该队列读取的线程；然后工作人员将阻止从队列中读取，而不需要既不需要`pass`，也不需要`sleep`。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-11-17T05:15:34.837

**在 Python 中将方法作为具有睡眠的后台线程运行**

```
 import threading
    import time

    class ThreadingExample(object):
        """ Threading example class
        The run() method will be started and it will run in the background
        until the application exits.
        """

        def __init__(self, interval=1):
            """ Constructor
            :type interval: int
            :param interval: Check interval, in seconds
            """
            self.interval = interval

            thread = threading.Thread(target=self.run, args=())
            thread.daemon = True                            # Daemonize thread
            thread.start()                                  # Start the execution

        def run(self):
            """ Method that runs forever """
            while True:
                # Do something
                print('Doing something imporant in the background')

                time.sleep(self.interval)

    example = ThreadingExample()
    time.sleep(3)
    print('Checkpoint')
    time.sleep(2)
    print('Bye') 
```

# sharepoint - 共享点日历 中的日期提醒

> ID：529045
> 
> 赞同：17
> 
> 时间：2009-02-09T17:16:58.053
> 
> 标签：sharepoint, calendar

我有一个部门维护，大约需要每 3 个月进行一次。维护本身不能自动化（它涉及物理交换网络硬件的主要和备用部分以验证备用部分是否仍然正常工作）。

我可以将其作为 Outlook 中的重复事件并给它一个两周的提醒窗口，但我不希望它与个人帐户相关联（如果我或我的一位同事离开公司，我仍然想要提醒去部门）。

我们正在努力实施 Sharepoint，我的小组有一个维护日历，这似乎是一个放置它的好地方。但是，似乎没有针对这些事件的过时通知。**如果事件发生变化**，您可以设置通知，您可以订阅日历并通过 Outlook 设置通知，但该通知仍然是每个用户的通知。

在这一点上，我可能只是要在 linux 服务器上编写一个通过电子邮件发送提醒的 cronjob，但我想我会问是否有办法使用我们正在实施的所有这些昂贵的协作工具来做到这一点。

那么，知道如何获取与个人用户无关的过时事件的通知吗？我也欢迎有人告诉我，只要它涉及一些好的替代方案，我对这个问题的全部看法都是错误的。谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-09T18:32:05.503

扩展安迪的答案（[http://www.andrewconnell.com/blog/articles/CreatingCustomSharePointTimerJobs.aspx](http://www.andrewconnell.com/blog/articles/CreatingCustomSharePointTimerJobs.aspx)），如果您只是在计时器作业的 Execute 方法中添加发送电子邮件的代码，那么除了 cron .

您可以做的是编写代码来遍历日历（实际上是一个事件列表），查找任何即将到期的事件并将电子邮件发送给“分配给”字段中的任何人。然后可以从 Timer Jobs Execute 方法或使用正常的计划任务调用它。这将比 cron 更容易管理更改，并且可以用于其他类型的任务。

帮助您入门的链接 -[遍历列表中的项目](https://web.archive.org/web/20160327144827/http://stevepietrek.com/2007/09/21/iterate-through-items-in-a-list/)

另一种选择是使用[Workflow 从日历中发送电子邮件](http://sharepointmagazine.net/technical/development/the-dog-ate-my-task-use-sharepoint-designer-to-email-daily-task-reminders)

编辑 - 由于 SharePoint SP2 这不再工作，因为工作流不能再开始自己（循环） -[解释和解决方法](https://docs.microsoft.com/en-us/archive/blogs/sharepointdesigner/service-pack-2-prevents-an-on-change-workflow-from-starting-itself)

这篇 CodeProject 文章展示了如何开发一个[功能来发送预定的提醒](https://www.codeproject.com/Articles/32753/Send-scheduled-Reminder-Alerts-by-email-in-SharePo)

另一种选择是使用执行此操作的第 3 方工具之一*（免责声明 - 我为第一家公司工作）*

*   [Pentalogic - SharePoint 提醒](http://www.pentalogic.net/sharepoint-products/reminder)
*   [竹子 - 警报加](https://web.archive.org/web/20200925192643/http://store.bamboosolutions.com/ps-34-5-alert-plus-web-part-available-early-oct-06.aspx)
*   [BoostSolutions - 警报提醒 Boost](http://www.boostsolutions.com/sharepoint-alert-reminder.html)

最后 - 无论您选择哪种方法（自定义代码/工作流程/第 3 方），您都可能会遇到重复事件的问题，因为 SharePoint 不提供获取所有事件的“扩展”列表的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T17:27:00.883

最好的方法是使用 Timer Job - 请参阅 Andrew Connell 的博客：[http ://www.andrewconnell.com/blog/articles/CreatingCustomSharePointTimerJobs.aspx](http://www.andrewconnell.com/blog/articles/CreatingCustomSharePointTimerJobs.aspx)

# bash - 如何在引用的表达式中转义扩展的路径名扩展模式？

> ID：529054
> 
> 赞同：4
> 
> 时间：2009-02-09T17:20:33.567
> 
> 标签：bash, escaping, design-patterns, expansion

除了基本`*`的`?`和`[...]`模式之外，Bash shell 还提供了扩展的模式匹配运算符，例如`!(pattern-list)`（“匹配除给定模式之一之外的所有模式”）。`extglob`需要设置 shell 选项才能使用它们。一个例子：

```
~$ mkdir test ; cd test ; touch file1 file2 file3
~/test$ echo *
file1 file2 file3
~/test$ shopt -s extglob  # make sure extglob is set
~/test$ echo !(file2)
file1 file3 
```

如果我将 shell 表达式传递给在子 shell 中执行它的程序，则运算符会导致错误。这是一个直接运行子外壳的测试（这里我从另一个目录执行以确保不会过早发生扩展）：

```
~/test$ cd ..
~$ bash -c "cd test ; echo *"
file1 file2 file3
~$ bash -c "cd test ; echo !(file2)"  # expected output: file1 file3
bash: -c: line 0: syntax error near unexpected token `('
bash: -c: line 0: `cd test ; echo !(file2)' 
```

我尝试了各种转义，但我想出的任何方法都没有正常工作。我也怀疑`extglob`没有设置在子shell中，但事实并非如此：

```
~$ bash -c "shopt -s extglob ; cd test ; echo !(file2)"
bash: -c: line 0: syntax error near unexpected token `('
bash: -c: line 0: `cd test ; echo !(file2)' 
```

任何解决方案表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-08-12T03:56:03.387

bash 在执行之前解析每一行，因此当 bash 验证通配模式语法时，“shopt -s extglob”不会生效。不能在同一行上启用该选项。这就是为什么“bash -O extglob -c 'xyz'”解决方案（来自 Randy Proctor）有效并且是必需的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T17:40:46.560

```
$ bash -O extglob -c 'echo !(file2)'
文件 1 文件 3

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-05T04:47:11.420

这是另一种方式，如果您想避免`eval`并且需要能够在子外壳中打开和关闭*extglob*。只需将您的模式放入变量中：

```
bash -c 'shopt -s extglob; cd test; patt="!(file2)"; echo $patt; shopt -u extglob; echo $patt' 
```

给出这个输出：

```
file1 file3
!(file2) 
```

证明*extglob*已设置和未设置。如果第一个`echo`在 周围有引号`$patt`，它只会像第二个一样吐出模式`echo`（可能应该有引号）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T17:34:03.597

*好吧，我对extglob*没有任何真正的经验，但我可以通过将它包装`echo`在一个中来让它工作`eval`：

```
$ bash -c 'shopt -s extglob ; cd  test ; eval "echo !(file2)"'
file1 file3 
```

# sharepoint - SharePoint：内容类型 ID 不同于附加到列表实例的内容类型 ID

> ID：529056
> 
> 赞同：2
> 
> 时间：2009-02-09T17:20:57.967
> 
> 标签：sharepoint, moss, content-type

我有一个关于内容类型及其 ID 以及如何将它们与对象模型一起使用的问题。

首先，我通过 CAML 定义了一些站点列、使用这些列的内容类型和使用此内容类型的列表定义。这三个组件中的每一个都被实现为一个特征。另一个功能创建此列表定义的列表实例。

因此，当我尝试使用我的内容类型向列表中添加新项目时，我使用以下代码。

```
 SPListItem listItem = list.Items.Add();
 SPContentType type = list.ContentTypes[new ContentTypeId("0x010044fb4458c2eb4800825910845a35554c")];
 listItem["ContentTypeId"] = type.Id;
 listItem["Title"] = "Titel";
 listItem.Update(); 
```

当我执行这段代码时，类型对象仍然为空，我也确定内容类型已附加到列表中。调试代码并检查列表的内容类型显示附加到列表的内容类型没有我在内容类型定义 (CAML) 中定义的 id。列表实例中的 id 不同，但从我在内容类型定义中定义的那个开始。 **0x010044FB4458C2EB4800825910845A35554C** 0077D683BDD9969F4E920A27C334463321

那么这种行为正常吗？我希望附加到列表的内容类型与定义中的 id 相同。

我的主要目标是避免使用内容类型的名称从列表的内容类型中检索它，而是使用唯一 ID。

再见弗洛

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T17:25:09.203

当您基于内容类型创建列表时，列表的每个实例实际上都是从父级继承的新内容类型。

看看这个...... [http://soerennielsen.wordpress.com/2007/09/11/propagate-site-content-types-to-list-content-types/](http://soerennielsen.wordpress.com/2007/09/11/propagate-site-content-types-to-list-content-types/)

更新-关于在不使用名称的情况下查找 List 的实例，还请查看 SPContentTypeUsage 类！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T19:55:31.043

不要过分强调将内容类型的名称编码为代码中的常量。虽然乍一看似乎可以更改内容类型的名称，但它应该被视为一个常量，因为更改内容类型名称的含义并不重要，足以要求完整构建和重新发布您的解决方案，允许更改编码常数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T03:39:50.630

列表上的 ContentTypeID 是 ContentTypeID + 列表 ID。

以下代码应该可以解决问题：

```
//i try and keep these in a string constants class to avoid 
//having to manage "magic strings" throughout my solution
SPContentTypeID ctid = new ContentTypeId("0x010044fb4458c2eb4800825910845a35554c");

//here's the magic
SPContentTypeID listCTID = list.ContentTypes.BestMatch(ctid);

//retrieve the ContentType with the appropriate ID
SPContentType type = list.ContentTypes[listCTID]; 

//do your thing    
SPListItem listItem = list.Items.Add(); 
listItem["ContentTypeId"] = type.Id; 
listItem["Title"] = "Titel"; 
listItem.Update(); 
```

# visual-studio-2008 - 注册表中的 Visual Studio 2008 产品密钥？

> ID：529064
> 
> 赞同：18
> 
> 时间：2009-02-09T17:23:17.837
> 
> 标签：visual-studio-2008, registry

我有一个朋友需要重装windows，但是找不到他的VS2008激活码/产品密钥。有没有办法查看他上次在注册表中安装 VS2008 时输入的产品密钥？也欢迎任何其他找到密钥的方法。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2010-12-29T05:09:47.203

## 对于 32 位 Windows：

视觉工作室 2003：

> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\7.0\Registration\PIDKEY

视觉工作室 2005：

> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\8.0\Registration\PIDKEY

视觉工作室 2008：

> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\9.0\Registration\PIDKEY

## 对于 64 位 Windows：

视觉工作室 2003：

> HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\VisualStudio\7.0\Registration\PIDKEY

视觉工作室 2005：

> HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\VisualStudio\8.0\Registration\PIDKEY

视觉工作室 2008：

> HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\VisualStudio\9.0\Registration\PIDKEY

## 笔记：

*   数据是没有破折号的 GUID。每 5 个字符后添加一个破折号 (-) 以转换为产品密钥。
*   如果 PIDKEY 值为空，请尝试查看子文件夹，例如

    > ...\注册\1000.0x0000\PIDKEY

    或者

    > ...\注册\2000.0x0000\PIDKEY

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T04:37:36.030

我在稍微不同的密钥下找到了 Visual Studio 2008 Professional 的产品密钥：

```
HKLM\SOFTWARE\Wow6432Node\Microsoft\MSDN\8.0\Registration\PIDKEY 
```

如上所述，它被列出时没有破折号。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-29T15:20:30.607

对于 Visual Studio 2005：

> 但是，如果您确实安装了 Visual Studio 2005，并且想找出您用来安装它的序列号，因为您不知道将那个闪亮的贴纸放在哪里，您可以。就像 Windows 中的大多数东西一样，它在注册表中。
> 
> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\8.0\Registration\PIDKEY
> 
> 为了将该键中的值转换为实际的序列号，您必须在代码的 5 个字符后添加一个破折号 (-)。

来自：[http ://www.gooli.org/blog/visual-studio-2005-serial-number/](http://www.gooli.org/blog/visual-studio-2005-serial-number/)

对于 Visual Studio 2008，它应该是：

> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\9.0\Registration\PIDKEY

但是我注意到 PIDKEY 的数据字段仅填充在`1000.0x000`上述路径的（或 2000.0x000）子文件夹中。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-08T18:25:41.763

只需删除密钥：

```
HKEY_CURRENT_USER/Software/Microsoft/VCExpress/9.0/Registration 
```

或者在命令行中运行：

```
reg delete HKCU\Software\Microsoft\VCExpress\9.0\Registration /f 
```

# ruby - 如何在 Sinatra 中使用带有斜线的参数？

> ID：529065
> 
> 赞同：9
> 
> 时间：2009-02-09T17:23:30.423
> 
> 标签：ruby, parameters, routing, routes, sinatra

玩[sinatra](http://www.sinatrarb.com/)时，我遇到了一个小问题：当我使用带有斜杠的参数时，它会混淆路由器引擎。那么有没有一种很好的方法来处理这种参数而无需对其进行编码？

代码看起来像

```
get 'add/:url' do
   #....
end 
```

我打算让 /add/ [http://sctackoverflow.com/ 之](http://sctackoverflow.com/)类的东西工作

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-09T17:58:06.690

您是否尝试使用 splat 参数？

就像是：

```
get '/add/*' do
  protocol = params[:splat].first
  address = params[:splat][1..-1].join('/')

  url = protocol + "//" + address
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T22:28:22.017

谢谢，我还没有听说过 splat 参数，它非常适合这种情况。事实上，我查看了文档，发现使用捕获参数和正则表达式更短：

```
get %r{/add/(.+)} do
  url = params[:captures]
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-29T14:58:12.607

或使用：

```
url = request.fullpath[5..-1] 
```

# ruby-on-rails - select_tag 正在排序（奇怪）[Rails]

> ID：529068
> 
> 赞同：2
> 
> 时间：2009-02-09T17:25:06.567
> 
> 标签：ruby-on-rails, html-select

我有一个看起来像这样的选择框（在 form_for 中）

```
 <%=f.select(:whatever_id, {"blah"=>0, "blah2"=>1, "blah3"=>2, "blah4"=>3}, {:include_blank => true}) %> 
```

并且输出很好，但很奇怪......像这样：

```
<select id="personal_information_whatever_id" name="personal_information[whatever_id]"><option value=""></option>
<option value="1">blah2</option>

<option value="2">blah3</option>
<option value="0">blah</option>
<option value="3">blah4</option></select> 
```

**但我希望它按顺序进行......**发生了什么，我该如何纠正它？

**编辑：**我觉得答案与此有关

> 您永远无法保证任何带有哈希的订单。您可以尝试 .sort() 按字母顺序对值进行排序。

除了哈希还有什么我可以使用的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T17:31:58.750

是的，您应该使用数组数组。您的示例最简单的方法是这样的：

```
<%=f.select(:whatever_id, [["blah", 0], ["blah2", 1], ["blah3", 2], ["blah4", 3]], {:include_blank => true}) %> 
```

这应该足够了。也可以查看[api.rubyonrails.com](http://api.rubyonrails.com)上的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-16T21:35:21.420

在您的模型中，定义您的哈希（在您的情况下，您的模型是“whatever”而您的哈希是“blahs”）：

`BLAHS = { "blah"=>0, "blah2"=>1, "blah3"=>2 }`

在放置哈希的选择标签中，键入

```
Whatever::BLAHS.sort {|a,b| a[1] <=> b[1]} 
```

这将创建一个数组，如其他答案中所述，按第二项（id/numbers）排序。

保存后，当您从数据库中拉出任何内容并希望显示字段 blah 时，请执行此操作

```
Whatever::BLAHS.index whatever.blah 
```

别人提到的数组数组是可行的，但是当你想展示一个Whatever时，你如何以一种不错的方式展示blah的值呢？我建议坚持使用哈希，因为它可以解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T17:30:02.483

问题是 options 参数是一个散列，并且散列没有保证顺序。

这应该适合你

```
 <%= f.select(:whatever_id, ([["blah",0],["blah2",1],["blah3",2]]), {:include_blank => true}) %> 
```

编辑以回应您的评论：有关收藏，请参阅[collection_select](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#M001593)

# c++ - XCode 自动停用断点

> ID：529071
> 
> 赞同：15
> 
> 时间：2009-02-09T17:26:31.727
> 
> 标签：c++, xcode, macos

我在 C++ 中使用 xcode。我正在尝试调试我的项目，但在随机的时间间隔内，它似乎忽略了我的断点。它做了三件事：

1）有时，当我运行时，它会自动切换到“停用断点”模式。（相关按钮亮起并显示“激活”）

2）有时当我运行时，我所有的断点都进入“找不到”模式，内部是黄色的。我需要在它们上单击两次才能使它们恢复为深蓝色（一次变为浅蓝色 = 不活动，一次变为深蓝色 = 活动）

3）有时，当我运行时，我的断点是深蓝色的，按钮显示“停用”，它仍然只是忽略我的断点，直接跑过它。

这使得调试我的程序变得非常困难......

我应该补充一点，我在 OSX 10.5.6 上使用 XCode 3.1 beta，以防万一。

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-09T17:45:58.670

尝试在**首选项**的**调试**面板中取消选中**加载符号延迟**

 ****[替代文字 http://img.skitch.com/20090209-gj947qk7dxdyms1wij4q5em2f2.jpg](http://img.skitch.com/20090209-gj947qk7dxdyms1wij4q5em2f2.jpg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-28T12:08:15.553

有同样的问题，但似乎只有重新启动 iPhone 模拟器才能解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-27T01:47:28.297

我现在面临同样的问题。我尝试了所有选项：启用 GCC、活动、基本目标以及重新启动和关闭 xcode，但没有解决。我终于重新启动了模拟器，一切都开始工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-03T21:00:36.050

我或多或少有同样的问题，不幸的是，这种懒惰加载符号的建议并没有为我解决。而且，我不是为iphone开发的，只是一个普通的应用程序。

具体来说，有时我无法即时禁用或启用断点 - 有时我的代码不会在我后来证明正在执行的断点处停止（使用打印语句），我无能为力让它停在那里 - 我看到那个带有橙色中心的非常烦人的调试符号，即使我只有一个项目处于活动状态。

退出和重新启动 XCode 偶尔会产生影响 - 令人讨厌的是，在极少数情况下退出并重新启动或从干净的​​固定难以诊断的编译/链接错误重新构建。不幸的是，我只是尝试了所有这些都没有效果。

（不相关，我的键盘快捷键也不可靠。我的 F2 快捷键继续为我工作了数周，停止工作很长时间，今天早上工作，现在不能在与以前工作的完全相同的断点处工作 - 但我的F1，跨过去，key已经完全可靠了……）

不得不对打印语句进行如此多的调试，我有点失望！

# visual-studio-2008 - 调试时防止解决方案资源管理器隐藏

> ID：529076
> 
> 赞同：17
> 
> 时间：2009-02-09T17:27:34.003
> 
> 标签：visual-studio-2008

当我在 Visual Studio 中调试时，解决方案资源管理器已关闭。

如何让它保持打开状态？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-09T17:28:40.507

如果您在调试会话期间打开解决方案资源管理器，它应该在您关闭 Visual Studio 时保存为首选项，确保在您下次调试时打开它。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-09T18:56:50.730

调试时转到查看 -> 解决方案资源管理器以查看解决方案资源管理器。只要您不关闭它，它就会在您下次调试时出现在您离开它的任何地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-26T11:10:38.637

转到工具->导入和导出设置向导->重置所有设置。重置所有更改设置

# asp.net - 使用绝对定位而不是浮点数来定位列

> ID：529079
> 
> 赞同：1
> 
> 时间：2009-02-09T17:29:10.130
> 
> 标签：asp.net, html, css

我已经阅读了几篇关于网站内容模板的文章。他们似乎都建议通过浮动将列放置在您的网站上。例子：

```
<div id="container" style="width: 1000px;">
    <div id="main_content" style="border: solid 1px Black; width: 798px; /* width = 800px -2px for border */ float: left; height: 400px;" ></div> 
    <div id="links_menu" style="border: solid 1px Black; width: 198px; float: right; height: 600px;"></div>      
</div> 
```

但是，每当我使用浮动时，我总是设法破坏我的内容。`<div syle="clear:both;" />`与实际设计网站的外观和感觉相比，我花更多的时间试图确定将我的 's 放在哪里。此外，每当我将我们的第三方[ComponentArt](http://www.componentart.com/)控件之一放置在浮动容器中时，它都会被破坏并要求我指定高度和宽度，这些直到运行时才确定。

此外，我发现当我使用绝对定位时，事情似乎对我来说更好。例子：

```
<div style="width: 1000px; height: 600px; position: relative;">
    <div style="border: solid 1px Black; width: 798px; position: absolute; top: 0; left: 0; height: 400px;"></div>
    <div style="border: solid 1px Black; width: 198px; position: absolute; top: 0; right: 0; height: 600px;"></div>
</div> 
```

无论如何，我对样式表和 HTML 还是比较陌生，所以我想把它扔给大家，看看你对这种内容放置替代方案的看法。您认为这种方法有什么负面影响吗？我在大多数浏览器中都试过了，它们似乎都能正确呈现，但我不知道未来会怎样......或者，也许有人可以推荐一种更好的方法来浮动我的容器，这样内部内容就不会像浮动一样好。我绝对愿意接受建议，并感谢您提供的任何反馈。

在此先感谢您的帮助！

CJAM

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T17:36:36.197

绝对定位容器的一个大问题是当您不提前知道它们的高度时，将内容放置在它们下方的页面上。在您的示例中，您已经定义了绝对定位元素的高度，所以这对您来说应该不是问题。如果它对您有用，请使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T18:02:05.060

用 css 实现某些东西真的没有对错。它更多的是关于有效性/灵活性。

对列布局使用绝对位置可以减少这种情况。插入、删除列将需要您重新计算所有定位。如果有多个相同样式列的实例怎么办？我们不能 100% 重复使用样式，因为它是绝对定位的。

列布局有很多方法。查看一些@ [listapart](http://www.alistapart.com/articles/multicolumnlayouts)， [positioniseverything](http://www.positioniseverything.net/articles/onetruelayout/anyorder)

# java - 如何在 Java 中创建一个泛型数组？

> ID：529085
> 
> 赞同：1188
> 
> 时间：2009-02-09T17:30:44.417
> 
> 标签：java, arrays, generics, reflection, instantiation

由于 Java 泛型的实现，你不能有这样的代码：

```
public class GenSet<E> {
    private E a[];

    public GenSet() {
        a = new E[INITIAL_ARRAY_LENGTH]; // error: generic array creation
    }
} 
```

如何在保持类型安全的同时实现这一点？

我在 Java 论坛上看到了这样的解决方案：

```
import java.lang.reflect.Array;

class Stack<T> {
    public Stack(Class<T> clazz, int capacity) {
        array = (T[])Array.newInstance(clazz, capacity);
    }

    private final T[] array;
} 
```

但我真的不明白发生了什么。

* * *

## 回答 #1

> 赞同：759
> 
> 时间：2009-02-09T22:19:31.197

作为回报，我必须问一个问题：您的`GenSet`“已检查”还是“未检查”？这意味着什么？

*   **检查**：*强类型*。`GenSet`明确知道它包含什么类型的对象（即，它的构造函数是用参数显式调用的`Class<E>`，并且当方法被传递的参数不是 type 时，它​​们将抛出异常`E`。请参阅[`Collections.checkedCollection`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#checkedCollection%28java.util.Collection,%20java.lang.Class%29)。

    -> 在这种情况下，你应该写：

    ```
    public class GenSet<E> {

        private E[] a;

        public GenSet(Class<E> c, int s) {
            // Use Array native method to create array
            // of a type only known at run time
            @SuppressWarnings("unchecked")
            final E[] a = (E[]) Array.newInstance(c, s);
            this.a = a;
        }

        E get(int i) {
            return a[i];
        }
    } 
    ```

*   **未选中**：*弱类型*。实际上没有对作为参数传递的任何对象进行类型检查。

    -> 在这种情况下，你应该写

    ```
    public class GenSet<E> {

        private Object[] a;

        public GenSet(int s) {
            a = new Object[s];
        }

        E get(int i) {
            @SuppressWarnings("unchecked")
            final E e = (E) a[i];
            return e;
        }
    } 
    ```

    注意数组的组件类型应该是类型参数的[*擦除：*](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)

    ```
    public class GenSet<E extends Foo> { // E has an upper bound of Foo

        private Foo[] a; // E erases to Foo, so use Foo[]

        public GenSet(int s) {
            a = new Foo[s];
        }

        ...
    } 
    ```

所有这一切都源于 Java 中一个已知且有意为之的泛型弱点：它是使用擦除实现的，因此“泛型”类不知道它们在运行时使用什么类型参数创建，因此无法提供类型-除非实现了某种明确的机制（类型检查），否则安全。

* * *

## 回答 #2

> 赞同：256
> 
> 时间：2010-05-27T20:00:45.727

你可以这样做：

```
E[] arr = (E[])new Object[INITIAL_ARRAY_LENGTH]; 
```

*这是在Effective Java*中实现泛型集合的建议方法之一；*第 26 项*。没有类型错误，无需重复转换数组。 *但是*，这会触发警告，因为它具有潜在危险，应谨慎使用。正如评论中所详述的，这`Object[]`现在伪装成我们的类型，如果使用不安全`E[]`，可能会导致意外错误或s。`ClassCastException`

根据经验，只要强制转换数组在内部使用（例如，支持数据结构），并且不返回或暴露给客户端代码，这种行为是安全的。如果您需要将泛型类型的数组返回给其他代码，那么`Array`您提到的反射类是正确的方法。

* * *

`List`值得一提的是，只要有可能，如果您使用泛型，使用 s 而不是使用数组时，您会更开心。当然，有时您别无选择，但使用集合框架要健壮得多。

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2010-11-19T03:30:15.870

以下是如何使用泛型来获取您正在寻找的类型的数组，同时保持类型安全（与其他答案相反，这将给您返回一个`Object`数组或在编译时导致警告）：

```
import java.lang.reflect.Array;  

public class GenSet<E> {  
    private E[] a;  

    public GenSet(Class<E[]> clazz, int length) {  
        a = clazz.cast(Array.newInstance(clazz.getComponentType(), length));  
    }  

    public static void main(String[] args) {  
        GenSet<String> foo = new GenSet<String>(String[].class, 1);  
        String[] bar = foo.a;  
        foo.a[0] = "xyzzy";  
        String baz = foo.a[0];  
    }  
} 
```

编译时不会出现警告，`main`正如`GenSet`您在并且数组中的值是正确的类型。`a``a`

它通过使用类文字作为运行时类型标记来工作，如[Java 教程](http://download.oracle.com/javase/tutorial/extra/generics/literals.html)中所述。编译器将类文字视为`java.lang.Class`. 要使用一个，只需在类的名称后面加上`.class`. 因此，`String.class`充当`Class`代表类的对象`String`。这也适用于接口、枚举、任意维数组（例如`String[].class`）、基元（例如`int.class`）和关键字`void`（即`void.class`）。

`Class`本身是泛型的（声明为`Class<T>`，其中`T`代表`Class`对象所代表的类型），这意味着 的类型`String.class`是`Class<String>`。

因此，无论何时调用 for 的构造函数，都会`GenSet`为第一个参数传入一个类文字，该参数表示实例声明类型的数组`GenSet`（例如`String[].class`for `GenSet<String>`）。请注意，您将无法获得基元数组，因为基元不能用于类型变量。

在构造函数内部，调用该方法`cast`会将传递的`Object`参数强制转换为调用该方法的`Class`对象所代表的类。调用静态方法返回一个数组`newInstance`，该数组的类型由作为第一个参数传递的对象表示，长度由作为第二个参数传递的对象指定。调用该方法返回一个对象，该对象表示由调用该方法的对象表示的数组的组件类型（例如，如果对象不表示数组）。`java.lang.reflect.Array``Object``Class``int``getComponentType``Class``Class``String.class``String[].class``null``Class`

最后一句话并不完全准确。调用`String[].class.getComponentType()`返回一个`Class`表示 class 的对象`String`，但它的类型是`Class<?>`， not `Class<String>`，这就是为什么您不能执行以下操作的原因。

```
String foo = String[].class.getComponentType().cast("bar"); // won't compile 
```

每个`Class`返回`Class`对象的方法也是如此。

关于 Joachim Sauer 对此[答案](https://stackoverflow.com/questions/529085/java-how-to-generic-array-creation/529094#529094)的评论（我自己没有足够的声誉来评论它），使用强制转换的示例`T[]`将导致警告，因为在这种情况下编译器无法保证类型安全。

* * *

编辑关于 Ingo 的评论：

```
public static <T> T[] newArray(Class<T[]> type, int size) {
   return type.cast(Array.newInstance(type.getComponentType(), size));
} 
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2011-11-08T15:28:17.957

这是唯一类型安全的答案

```
E[] a;

a = newArray(size);

@SafeVarargs
static <E> E[] newArray(int length, E... array)
{
    return Arrays.copyOf(array, length);
} 
```

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2013-08-15T13:47:19.580

要扩展到更多维度，只需将`[]`'s 和 dimension 参数添加到`newInstance()`（`T`是类型参数，`cls`是 a `Class<T>`，`d1`通过`d5`是整数）：

```
T[] array = (T[])Array.newInstance(cls, d1);
T[][] array = (T[][])Array.newInstance(cls, d1, d2);
T[][][] array = (T[][][])Array.newInstance(cls, d1, d2, d3);
T[][][][] array = (T[][][][])Array.newInstance(cls, d1, d2, d3, d4);
T[][][][][] array = (T[][][][][])Array.newInstance(cls, d1, d2, d3, d4, d5); 
```

详情请参阅[`Array.newInstance()`](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Array.html#newInstance%28java.lang.Class,%20int...%29)。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2014-03-05T14:14:02.287

在 Java 8 中，我们可以使用 lambda 或方法引用来创建一种通用数组。这类似于反射方法（通过 a `Class`），但这里我们不使用反射。

```
@FunctionalInterface
interface ArraySupplier<E> {
    E[] get(int length);
}

class GenericSet<E> {
    private final ArraySupplier<E> supplier;
    private E[] array;

    GenericSet(ArraySupplier<E> supplier) {
        this.supplier = supplier;
        this.array    = supplier.get(10);
    }

    public static void main(String[] args) {
        GenericSet<String> ofString =
            new GenericSet<>(String[]::new);
        GenericSet<Double> ofDouble =
            new GenericSet<>(Double[]::new);
    }
} 
```

例如，这由[`<A> A[] Stream.toArray(IntFunction<A[]>)`](http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#toArray-java.util.function.IntFunction-).

这*也*可以在 Java 8 之前使用匿名类完成，但更麻烦。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2009-02-09T18:50:42.883

[这在Effective Java, 2nd Edition](http://java.sun.com/docs/books/effective/)的第 5 章（泛型）第25 项中有所介绍...**优先使用列表而不是数组**

您的代码将起作用，尽管它会生成一个未经检查的警告（您可以使用以下注释来抑制它：

```
@SuppressWarnings({"unchecked"}) 
```

但是，使用列表而不是数组可能会更好。

[在 OpenJDK 项目站点](https://bugs.openjdk.java.net/browse/JDK-5105887)上有一个关于这个错误/功能的有趣讨论。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2017-07-11T21:53:55.897

您不需要将 Class 参数传递给构造函数。试试这个。

```
public class GenSet<T> {

    private final T[] array;

    @SafeVarargs
    public GenSet(int capacity, T... dummy) {
        if (dummy.length > 0)
            throw new IllegalArgumentException(
              "Do not provide values for dummy argument.");
        this.array = Arrays.copyOf(dummy, capacity);
    }

    @Override
    public String toString() {
        return "GenSet of " + array.getClass().getComponentType().getName()
            + "[" + array.length + "]";
    }
} 
```

和

```
GenSet<Integer> intSet = new GenSet<>(3);
System.out.println(intSet);
System.out.println(new GenSet<String>(2)); 
```

结果：

```
GenSet of java.lang.Integer[3]
GenSet of java.lang.String[2] 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-02-11T10:07:35.283

Java 泛型通过在编译时检查类型并插入适当的强制转换来工作，但会*删除*编译文件中的类型。这使得不理解泛型的代码可以使用泛型库（这是一个深思熟虑的设计决定），但这意味着您通常无法在运行时找出类型是什么。

公共`Stack(Class<T> clazz,int capacity)`构造函数要求您在运行时传递一个 Class 对象，这意味着类信息在运行*时*可用于需要它的代码。这种`Class<T>`形式意味着编译器将检查您传递的 Class 对象是否正是 T 类型的 Class 对象。不是 T 的子类，不是 T 的超类，而是 T。

这意味着您可以在构造函数中创建适当类型的数组对象，这意味着您存储在集合中的对象的类型将在将它们添加到集合时检查它们的类型。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2011-06-14T19:26:00.757

尽管线程已死，但我想提请您注意这一点。

泛型用于编译期间的类型检查。因此，目的是检查

*   进来的就是你需要的。
*   你返回的就是消费者需要的。

检查这个：

![在此处输入图像描述](https://i.stack.imgur.com/fCXXe.jpg)

编写泛型类时不要担心类型转换警告；使用时担心。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2016-02-21T01:28:56.793

这个解决方案怎么样？

```
@SafeVarargs
public static <T> T[] toGenericArray(T ... elems) {
    return elems;
} 
```

它有效，看起来太简单了，不可能是真的。有什么缺点吗？

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-02-09T17:33:58.310

该示例使用 Java 反射创建一个数组。通常不建议这样做，因为它不是类型安全的。相反，您应该做的只是使用内部列表，并完全避免使用数组。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2013-08-08T23:32:27.820

另请查看此代码：

```
public static <T> T[] toArray(final List<T> obj) {
    if (obj == null || obj.isEmpty()) {
        return null;
    }
    final T t = obj.get(0);
    final T[] res = (T[]) Array.newInstance(t.getClass(), obj.size());
    for (int i = 0; i < obj.size(); i++) {
        res[i] = obj.get(i);
    }
    return res;
} 
```

它将任何类型的对象列表转换为相同类型的数组。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2016-11-09T20:43:28.790

我找到了一种对我有用的快速简便的方法。请注意，我只在 Java JDK 8 上使用过它。我不知道它是否适用于以前的版本。

虽然我们不能实例化特定类型参数的泛型数组，但我们可以将已经创建的数组传递给泛型类构造函数。

```
class GenArray <T> {
    private T theArray[]; // reference array

    // ...

    GenArray(T[] arr) {
        theArray = arr;
    }

    // Do whatever with the array...
} 
```

现在主要我们可以像这样创建数组：

```
class GenArrayDemo {
    public static void main(String[] args) {
        int size = 10; // array size
        // Here we can instantiate the array of the type we want, say Character (no primitive types allowed in generics)
        Character[] ar = new Character[size];

        GenArray<Character> = new Character<>(ar); // create the generic Array

        // ...

    }
} 
```

为了让您的数组更加灵活，您可以使用链表，例如。Java.util.ArrayList 类中的 ArrayList 和其他方法。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2017-09-15T10:19:41.983

传递值列表...

```
public <T> T[] array(T... values) {
    return values;
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2012-08-31T10:39:28.523

我制作了这个代码片段来反射地实例化一个为简单的自动化测试实用程序传递的类。

```
Object attributeValue = null;
try {
    if(clazz.isArray()){
        Class<?> arrayType = clazz.getComponentType();
        attributeValue = Array.newInstance(arrayType, 0);
    }
    else if(!clazz.isInterface()){
        attributeValue = BeanUtils.instantiateClass(clazz);
    }
} catch (Exception e) {
    logger.debug("Cannot instanciate \"{}\"", new Object[]{clazz});
} 
```

请注意此部分：

```
 if(clazz.isArray()){
        Class<?> arrayType = clazz.getComponentType();
        attributeValue = Array.newInstance(arrayType, 0);
    } 
```

用于数组初始化 where **Array.newInstance(class of array, size of array)**。类既可以是原始（int.class）也可以是对象（Integer.class）。

BeanUtils 是 Spring 的一部分。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-09-14T21:26:33.447

其他人建议的强制施法对我不起作用，抛出非法施法的异常。

但是，这种隐式转换效果很好：

```
Item<K>[] array = new Item[SIZE]; 
```

其中 Item 是我定义的包含成员的类：

```
private K value; 
```

这样，您将获得 K 类型的数组（如果该项只有值）或您希望在 Item 类中定义的任何泛型类型。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-06-12T09:40:46.373

实际上，一种更简单的方法是创建一个对象数组并将其转换为您想要的类型，如下例所示：

```
T[] array = (T[])new Object[SIZE]; 
```

其中`SIZE`是一个常数，`T`是一个类型标识符

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-10-17T05:49:51.347

没有其他人回答您发布的示例中发生了什么的问题。

```
import java.lang.reflect.Array;

class Stack<T> {
    public Stack(Class<T> clazz, int capacity) {
        array = (T[])Array.newInstance(clazz, capacity);
    }

    private final T[] array;
} 
```

正如其他人所说，泛型在编译期间被“删除”。所以在运行时，一个泛型的实例不知道它的组件类型是什么。这样做的原因是历史原因，Sun 希望在不破坏现有接口（源代码和二进制文件）的情况下添加泛型。

另一方面，数组在运行时*确实*知道它们的组件类型。

这个例子通过让调用构造函数（它知道类型）的代码传递一个参数来告诉类所需的类型来解决这个问题。

所以应用程序会用类似的东西来构造这个类

```
Stack<foo> = new Stack<foo>(foo.class,50) 
```

并且构造函数现在（在运行时）知道组件类型是什么，并且可以使用该信息通过反射 API 构造数组。

```
Array.newInstance(clazz, capacity); 
```

最后我们有一个类型转换，因为编译器无法知道返回的数组`Array#newInstance()`是正确的类型（即使我们知道）。

这种风格有点难看，但它有时可能是创建在运行时出于任何原因（创建数组或创建其组件类型的实例等）确实需要知道其组件类型的泛型类型的最不坏的解决方案。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-10-19T01:04:54.463

我找到了一种解决这个问题的方法。

下面的行抛出通用数组创建错误

```
List<Person>[] personLists=new ArrayList<Person>()[10]; 
```

但是，如果我封装`List<Person>`在一个单独的类中，它就可以工作。

```
import java.util.ArrayList;
import java.util.List;

public class PersonList {

    List<Person> people;

    public PersonList()
    {
        people=new ArrayList<Person>();
    }
} 
```

您可以通过 getter 公开 PersonList 类中的人员。下面的行会给你一个数组，`List<Person>`每个元素都有一个。换句话说，数组`List<Person>`。

```
PersonList[] personLists=new PersonList[10]; 
```

在我正在处理的一些代码中，我需要这样的东西，这就是我为让它工作所做的。到目前为止没有问题。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2018-04-19T13:45:59.760

java中不允许创建通用数组，但您可以这样做

```
class Stack<T> {
private final T[] array;
public Stack(int capacity) {
    array = (T[]) new Object[capacity];
 }
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-09T17:46:55.343

您可以创建一个 Object 数组并将其转换为 E 无处不在。是的，这不是很干净的方法，但它至少应该有效。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2011-02-13T20:37:34.907

试试这个。

```
private int m = 0;
private int n = 0;
private Element<T>[][] elements = null;

public MatrixData(int m, int n)
{
    this.m = m;
    this.n = n;

    this.elements = new Element[m][n];
    for (int i = 0; i < m; i++)
    {
        for (int j = 0; j < n; j++)
        {
            this.elements[i][j] = new Element<T>();
        }
    }
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2012-04-05T00:10:45.893

一个简单但混乱的解决方法是在主类中嵌套第二个“持有者”类，并使用它来保存数据。

```
public class Whatever<Thing>{
    private class Holder<OtherThing>{
        OtherThing thing;
    }
    public Holder<Thing>[] arrayOfHolders = new Holder<Thing>[10]
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-08-21T16:11:35.523

也许与这个问题无关，但是当我得到“ `generic array creation`”错误使用时

```
Tuple<Long,String>[] tupleArray = new Tuple<Long,String>[10]; 
```

我发现了以下作品（并为我工作） `@SuppressWarnings({"unchecked"})`：

```
 Tuple<Long, String>[] tupleArray = new Tuple[10]; 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2014-07-09T13:36:35.787

我想知道这段代码是否会创建一个有效的泛型数组？

```
public T [] createArray(int desiredSize){
    ArrayList<T> builder = new ArrayList<T>();
    for(int x=0;x<desiredSize;x++){
        builder.add(null);
    }
    return builder.toArray(zeroArray());
}

//zeroArray should, in theory, create a zero-sized array of T
//when it is not given any parameters.

private T [] zeroArray(T... i){
    return i;
} 
```

编辑：也许创建这样一个数组的另一种方法是，如果您需要的大小已知且很小，那么只需将所需数量的“null”输入 zeroArray 命令？

虽然显然这不像使用 createArray 代码那样通用。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2014-09-15T17:23:32.283

您可以使用演员表：

```
public class GenSet<Item> {
    private Item[] a;

    public GenSet(int s) {
        a = (Item[]) new Object[s];
    }
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2017-06-28T19:59:53.103

我实际上找到了一个非常独特的解决方案来绕过无法启动通用数组。您需要做的是创建一个接收泛型变量 T 的类，如下所示：

```
class GenericInvoker <T> {
    T variable;
    public GenericInvoker(T variable){
        this.variable = variable;
    }
} 
```

然后在你的数组类中让它像这样开始：

```
GenericInvoker<T>[] array;
public MyArray(){
    array = new GenericInvoker[];
} 
```

启动 a`new Generic Invoker[]`将导致未经检查的问题，但实际上不应该有任何问题。

要从数组中获取，您应该像这样调用 array[i].variable：

```
public T get(int index){
    return array[index].variable;
} 
```

其余的，例如调整数组的大小可以使用 Arrays.copyOf() 来完成，如下所示：

```
public void resize(int newSize){
    array = Arrays.copyOf(array, newSize);
} 
```

add 函数可以像这样添加：

```
public boolean add(T element){
    // the variable size below is equal to how many times the add function has been called 
    // and is used to keep track of where to put the next variable in the array
    arrays[size] = new GenericInvoker(element);
    size++;
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2019-11-06T13:18:31.517

如果您真的想包装一个固定大小的通用数组，您将有一个方法来向该数组添加数据，因此您可以在那里正确初始化数组，执行如下操作：

```
import java.lang.reflect.Array;

class Stack<T> {
    private T[] array = null;
    private final int capacity = 10; // fixed or pass it in the constructor
    private int pos = 0;

    public void push(T value) {
        if (value == null)
            throw new IllegalArgumentException("Stack does not accept nulls");
        if (array == null)
            array = (T[]) Array.newInstance(value.getClass(), capacity);
        // put logic: e.g.
        if(pos == capacity)
             throw new IllegalStateException("push on full stack");
        array[pos++] = value;
    }

    public T pop() throws IllegalStateException {
        if (pos == 0)
            throw new IllegalStateException("pop on empty stack");
        return array[--pos];
    }
} 
```

在这种情况下，您使用 java.lang.reflect.Array.newInstance 创建数组，它不会是 Object[]，而是真正的 T[]。您不必担心它不是最终的，因为它是在您的班级内部管理的。请注意，您需要 push() 上的非 null 对象才能获取要使用的类型，因此我添加了对您推送的数据的检查并在那里引发异常。

这仍然有些毫无意义：您通过 push 存储数据，它是保证只有 T 元素会进入的方法的签名。因此，数组是 Object[] 还是 T[] 或多或少无关紧要。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2020-05-22T22:22:55.653

根据 vnportnoy 的语法

```
GenSet<Integer> intSet[] = new GenSet[3]; 
```

创建一个空引用数组，填充为

```
for (int i = 0; i < 3; i++)
{
   intSet[i] = new GenSet<Integer>();
} 
```

这是类型安全的。

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2015-06-03T05:52:51.570

```
private E a[];
private int size;

public GenSet(int elem)
{
    size = elem;
    a = (E[]) new E[size];
} 
```

# c# - C# 类型推断：在不应该的地方失败？

> ID：529088
> 
> 赞同：4
> 
> 时间：2009-02-09T17:31:30.810
> 
> 标签：c#, .net, generics, type-inference

请注意以下代码。违规行已被注释掉。

```
interface I<R> { }

class C : I<int> { }

class Program
{
    private static void function<T, R>(T t) where T : class, I<R>
    {
    }

    static void Main(string[] args)
    {
        // function(new C()); // wont compile
        function<C, int>(new C());
    }
} 
```

我相信类型推断应该找出类型，因为参数`T`提供了第一种类型，而`I<R>`提供了第二种类型。

有没有办法重新设计函数，以便调用者不必指定类型？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T17:36:40.830

如果您想保留所有约束，则不是。但是，这应该同样有效，除非您有特定的理由禁止值类型：

```
private static void function<R>(I<R> t) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T17:43:00.893

有多种方法可以添加额外的规则来进行类型推断——人类可以应用但编译器（遵守语言规范）不能应用的逻辑位。

在您建议确实应该更新语言以使类型推断更灵活地工作之前，我强烈建议您阅读现有规范。如果您可以很容易地理解这一点，您仍然认为值得将其变得*更加*复杂，请在[Connect](http://connect.microsoft.com)上发布功能请求- 但我个人认为它已经足够复杂了。我会说它比 C# 2.0 中的要好得多。

然而，提出相反的观点 - 几种语言（特别是功能性语言）具有更强大的类型推断机制。这里总是有利有弊 - 我相信当前 C# 推理系统的好处之一是它总是取得进展或停止，例如 - [Eric Lippert 的博客](http://blogs.msdn.com/ericlippert/archive/tags/Type+Inference/default.aspx)有更多关于此和许多其他类型推理问题的信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-09T17:45:22.027

```
class D : I<int>, I<string> { }
//
function<D, int>(new D());
function<D, string>(new D());
//is R int or string?
function(new D()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T17:39:48.187

不，C# 不支持这种推断。

直接使用接口，用get type..找到类型

```
private static void function<R>(I<R> t)
{
   Type typeofT = typeof(T);
} 
```

不能做得更好。

如果需要使用 T 调用另一个泛型方法，可以使用 typeofT 类型通过反射构建泛型调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T17:49:36.633

C# 不支持这种类型推断。考虑一下这种情况，它给问题增加了一些歧义。

```
class Other : I<int>, I<Student>{ ... }
void Example(){
  function(new D());
} 
```

在这种情况下，我应该被选为模棱两可。

如果您期待 C# 4.0，问题只会随着他们添加的新方差特性而增加。

# sql - 从Oracle中的表中删除重复行

> ID：529098
> 
> 赞同：182
> 
> 时间：2009-02-09T17:34:43.987
> 
> 标签：sql, oracle, duplicates, delete-row

我在 Oracle 中测试了一些东西，并用一些示例数据填充了一个表，但是在这个过程中我不小心加载了重复的记录，所以现在我无法使用某些列创建主键。

如何删除所有重复的行并只保留其中之一？

* * *

## 回答 #1

> 赞同：372
> 
> 时间：2009-02-09T17:41:15.110

使用`rowid`伪列。

```
DELETE FROM your_table
WHERE rowid not in
(SELECT MIN(rowid)
FROM your_table
GROUP BY column1, column2, column3); 
```

其中`column1`、`column2`和`column3`构成每条记录的识别键。您可能会列出所有列。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-03-18T06:11:43.427

从[问汤姆](http://asktom.oracle.com/pls/apex/f?p=100:11:0::::P11_QUESTION_ID:15258974323143)

```
delete from t
 where rowid IN ( select rid
                    from (select rowid rid, 
                                 row_number() over (partition by 
                         companyid, agentid, class , status, terminationdate
                                   order by rowid) rn
                            from t)
                   where rn <> 1); 
```

（修正了缺少的括号）

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-09T17:43:52.810

来自[DevX.com](http://www.devx.com/tips/Tip/14665)：

```
DELETE FROM our_table
WHERE rowid not in
(SELECT MIN(rowid)
FROM our_table
GROUP BY column1, column2, column3...) ; 
```

其中 column1、column2 等是您要使用的键。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-11-09T06:18:36.300

```
DELETE FROM tablename a
      WHERE a.ROWID > ANY (SELECT b.ROWID
                             FROM tablename b
                            WHERE a.fieldname = b.fieldname
                              AND a.fieldname2 = b.fieldname2) 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-12-31T10:32:44.897

# 解决方案1）

```
delete from emp
where rowid not in
(select max(rowid) from emp group by empno); 
```

# 解决方案2）

```
delete from emp where rowid in
               (
                 select rid from
                  (
                    select rowid rid,
                      row_number() over(partition by empno order by empno) rn
                      from emp
                  )
                where rn > 1
               ); 
```

# 解决方案 3)

```
delete from emp e1
         where rowid not in
          (select max(rowid) from emp e2
           where e1.empno = e2.empno ); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-01-11T17:01:33.353

创建表 t2 作为 select distinct * from t1;

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-09T17:44:14.883

您应该使用游标循环执行一个小的 pl/sql 块并删除您不想保留的行。例如：

```
declare
prev_var my_table.var1%TYPE;

begin

for t in (select var1 from my_table order by var 1) LOOP

-- if previous var equal current var, delete the row, else keep on going.
end loop;

end; 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-06-17T12:24:47.790

要选择重复项，查询格式可以是：

```
SELECT GroupFunction(column1), GroupFunction(column2),..., 
COUNT(column1), column1, column2...
FROM our_table
GROUP BY column1, column2, column3...
HAVING COUNT(column1) > 1 
```

因此，根据其他建议，正确的查询是：

```
DELETE FROM tablename a
      WHERE a.ROWID > ANY (SELECT b.ROWID
                             FROM tablename b
                            WHERE a.fieldname = b.fieldname
                              AND a.fieldname2 = b.fieldname2
                              AND ....so on.. to identify the duplicate rows....) 
```

此查询将保留数据库中最旧的记录，以符合`WHERE CLAUSE`.

Oracle 认证助理 (2008)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-07-03T10:55:31.040

```
create table abcd(id number(10),name varchar2(20))

insert into abcd values(1,'abc')

insert into abcd values(2,'pqr')

insert into abcd values(3,'xyz')

insert into abcd values(1,'abc')

insert into abcd values(2,'pqr')

insert into abcd values(3,'xyz')

select * from abcd
id  Name
1   abc
2   pqr
3   xyz
1   abc
2   pqr
3   xyz

Delete Duplicate record but keep Distinct Record in table 

DELETE 
FROM abcd a
WHERE ROWID > (SELECT MIN(ROWID) FROM abcd b
WHERE b.id=a.id
);

run the above query 3 rows delete 

select * from abcd

id  Name 
1   abc
2   pqr
3   xyz 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-05-30T01:07:46.577

真正大桌子的最快方式

1.  创建具有以下结构的异常表：exceptions_table

    ```
    ROW_ID ROWID
    OWNER VARCHAR2(30)
    TABLE_NAME VARCHAR2(30)
    CONSTRAINT VARCHAR2(30) 
    ```

2.  尝试创建将被重复项违反的唯一约束或主键。您将收到一条错误消息，因为您有重复项。例外表将包含重复行的 rowid。

    ```
    alter table add constraint
    unique --or primary key
    (dupfield1,dupfield2) exceptions into exceptions_table; 
    ```

3.  通过 rowid 使用 exceptions_table 加入您的表并删除 dups

    ```
    delete original_dups where rowid in (select ROW_ID from exceptions_table); 
    ```

4.  如果要删除的行数很大，则通过rowid创建一个新表（包含所有授权和索引）反连接异常表并将原表重​​命名为original_dups表并将new_table_with_no_dups重命名为原始表

    ```
    create table new_table_with_no_dups AS (
        select field1, field2 ........ 
        from original_dups t1
        where not exists ( select null from exceptions_table T2 where t1.rowid = t2.row_id )
    ) 
    ```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-12-28T14:12:14.433

使用 rowid-

```
delete from emp
 where rowid not in
 (select max(rowid) from emp group by empno); 
```

使用自连接-

```
delete from emp e1
 where rowid not in
 (select max(rowid) from emp e2
 where e1.empno = e2.empno ); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-12-31T12:28:26.067

# 解决方案4）

```
 delete from emp where rowid in
            (
             select rid from
                (
                  select rowid rid,
                  dense_rank() over(partition by empno order by rowid
                ) rn
             from emp
            )
 where rn > 1
); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-02-10T09:29:06.543

**1.解决方案**

```
delete from emp
    where rowid not in
    (select max(rowid) from emp group by empno); 
```

**2\. 斯洛伐克**

```
delete from emp where rowid in
               (
                 select rid from
                  (
                    select rowid rid,
                      row_number() over(partition by empno order by empno) rn
                      from emp
                  )
                where rn > 1
               ); 
```

**3.解决方案**

```
delete from emp e1
         where rowid not in
          (select max(rowid) from emp e2
           where e1.empno = e2.empno ); 
```

**4.解决方案**

```
 delete from emp where rowid in
            (
             select rid from
                (
                  select rowid rid,
                  dense_rank() over(partition by empno order by rowid
                ) rn
             from emp
            )
 where rn > 1
); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-02-10T10:03:19.130

**5.解决方案**

```
delete from emp where rowid in 
    (
      select  rid from
       (
         select rowid rid,rank() over (partition by emp_id order by rowid)rn from emp     
       )
     where rn > 1
    ); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-01-07T06:34:04.297

```
DELETE from table_name where rowid not in (select min(rowid) FROM table_name group by column_name); 
```

你也可以用另一种方式删除重复的记录

```
DELETE from table_name a where rowid > (select min(rowid) FROM table_name b where a.column=b.column); 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2021-06-07T13:28:29.270

[这篇博](https://blogs.oracle.com/sql/how-to-find-and-delete-duplicate-rows-with-sql)文对一般情况非常有帮助：

> 如果行完全重复（所有列中的所有值都可以有副本），则没有可使用的列！但是要保留一个，您仍然需要为每组中的每一行设置一个唯一标识符。幸运的是，Oracle 已经有了一些您可以使用的东西。行号。Oracle 中的所有行都有一个 rowid。这是一个物理定位器。也就是说，它说明了 Oracle 在磁盘上存储该行的位置。这对每一行都是唯一的。因此，您可以使用此值来识别和删除副本。为此，在不相关的删除中将 min() 替换为 min(rowid)：

```
delete films
where  rowid not in (
  select min(rowid)
  from   films
  group  by title, uk_release_date
) 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-01-12T05:32:10.793

```
DELETE FROM tableName  WHERE ROWID NOT IN (SELECT   MIN (ROWID) FROM table GROUP BY columnname); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-05-20T08:49:18.430

```
delete from dept
where rowid in (
     select rowid
     from dept
     minus
     select max(rowid)
     from dept
     group by DEPTNO, DNAME, LOC
); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-03-11T10:04:24.387

为了获得最佳性能，这是我写的：（
请参阅执行计划）

```
DELETE FROM your_table
WHERE rowid IN 
  (select t1.rowid from your_table  t1
      LEFT OUTER JOIN (
      SELECT MIN(rowid) as rowid, column1,column2, column3
      FROM your_table 
      GROUP BY column1, column2, column3
  )  co1 ON (t1.rowid = co1.rowid)
  WHERE co1.rowid IS NULL
); 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2017-09-14T09:13:19.447

检查以下脚本 -

1.

```
Create table test(id int,sal int); 
```

2.

```
 insert into test values(1,100);    
    insert into test values(1,100);    
    insert into test values(2,200);    
    insert into test values(2,200);    
    insert into test values(3,300);    
    insert into test values(3,300);    
    commit; 
```

3.

```
 select * from test; 
```

您将在这里看到 6 条记录。
4.运行以下查询 -

```
delete from 
   test
where rowid in
 (select rowid from 
   (select 
     rowid,
     row_number()
    over 
     (partition by id order by sal) dup
    from test)
  where dup > 1) 
```

5.  `select * from test;`

您将看到重复记录已被删除。
希望这能解决您的疑问。谢谢 ：）

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2017-11-01T23:35:06.773

我没有看到任何使用公用表表达式和窗口函数的答案。这是我发现最容易使用的。

```
DELETE FROM
 YourTable
WHERE
 ROWID IN
    (WITH Duplicates
          AS (SELECT
               ROWID RID, 
               ROW_NUMBER() 
               OVER(
               PARTITION BY First_Name, Last_Name, Birth_Date)
                  AS RN
               SUM(1)
               OVER(
               PARTITION BY First_Name, Last_Name, Birth_Date
               ORDER BY ROWID ROWS BETWEEN UNBOUNDED PRECEDING 
                                       AND UNBOUNDED FOLLOWING)
                   AS CNT
              FROM
               YourTable
              WHERE
               Load_Date IS NULL)
     SELECT
      RID
     FROM
      duplicates
     WHERE
      RN > 1); 
```

需要注意的事项：

1）我们只检查分区子句中的字段是否重复。

2）如果您有某种理由选择一个副本而不是其他副本，您可以使用 order by 子句使该行具有 row_number() = 1

3）您可以通过将最后的 where 子句更改为 N >= 1 的“Where RN > N”来更改保留的数字重复（我在想 N = 0 会删除所有有重复的行，但它只会删除所有行） .

4) 在 CTE 查询中添加 Sum 分区字段，该查询将用组中的行数标记每一行。因此，要选择包含重复项的行，包括第一项，请使用“WHERE cnt > 1”。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-06-28T11:58:52.913

解决方案 ：

```
delete from emp where rowid in
(
    select rid from
    (
        select rowid rid,
        row_number() over(partition by empno order by empno) rn
        from emp
    )
    where rn > 1
); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-11-26T09:04:20.413

```
create or replace procedure delete_duplicate_enq as
    cursor c1 is
    select *
    from enquiry;
begin
    for z in c1 loop
        delete enquiry
        where enquiry.enquiryno = z.enquiryno
        and rowid > any
        (select rowid
        from enquiry
        where enquiry.enquiryno = z.enquiryno);
    end loop;
 end delete_duplicate_enq; 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-11-24T03:54:29.927

这类似于最佳答案，但给了我一个更好的解释计划：

```
delete from your_table
 where rowid in (
        select max(rowid)
          from your_table
         group by column1, column2, column3
        having count(*) > 1
       ); 
```

# mysql - MySQL 中 GROUP_CONCAT 和 Longtext 的问题

> ID：529105
> 
> 赞同：4
> 
> 时间：2009-02-09T17:36:43.093
> 
> 标签：mysql, group-concat, truncated, longtext

SQL...

```
UPDATE Threads t 
SET t.Content = (
    SELECT GROUP_CONCAT(a.Content ORDER BY a.PageID SEPARATOR '<!-- pagebreak -->') 
    FROM MSarticlepages a
    WHERE a.ArticleID = t.MSthreadID GROUP BY a.ArticleID
) 
```

如您所见，它将文章的所有页面（每个页面作为长文本存储在单独的行中）并 GROUP_CONCAT 将它们放入单个长文本行中。问题是结果只有这么多字符，然后它被完全截断，丢失了大约 90% 的内容。CONCAT 不能很好地处理长文本还是我做错了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-09T17:43:25.463

根据[MySQL 手册](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)，最大长度`GROUP_CONCAT`由`group_concat_max_len`系统变量定义，默认为 1024。

可以使用以下命令增加此值：

```
SET group_concat_max_len = <int> 
```

然而，应该注意的是， 的值`group_concat_max_len`本身受另一个系统变量 的值的限制，`max_allowed_packet`默认为 1,048,576。

使用相同的语法，该值最多可以增加到 1,073,741,824：

```
SET max_allowed_packet = <int> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-12T05:46:39.703

这篇文章的标题是“CONCAT 和 Longtext 的问题”，这具有误导性，因为提出问题的人真的想了解 GROUP_CONCAT。我在 Google 中找到了这篇文章，因为我正在处理 MySQL 中 CONCAT 的限制。对于那些找到这篇文章并正在寻找如何增加 CONCAT 允许的最大长度的人来说，这里是如何做到的：

问题是调整 group_concat_max_len 不适用于 CONCAT，它仅适用于 GROUP_CONCAT，这意味着如果您遇到 CONCAT 的限制，您将不得不重新编写查询以使用 GROUP_CONCAT。

因此，假设您通过以下方式使用 CONCAT：

```
UPDATE some_table
SET some_field=CONCAT(some_field,'super long string to append to the end of the data in some_field')
WHERE some_criteria_field = 'match on this string'; 
```

但是您尝试在 some_field 内容末尾连接的数据被截断，或者只是将字段 some_field 设置为空/空。因此，为了减轻 CONCAT 的明显限制，查询必须采用以下方式：

```
SET @@session.group_concat_max_len = @@global.max_allowed_packet;
UPDATE some_table SET some_table.some_field=(
     SELECT GROUP_CONCAT( queue.append_to_end SEPARATOR '') as new_some_field
     FROM
     (
          SELECT append_to_end FROM some_table WHERE some_criteria_field = 'match on this string'
          UNION
          SELECT 'super long string to append to the end of the data in some_field' as append_to_end
     ) as queue
) WHERE some_criteria_field = 'match on this string' 
```

有关更深入的信息，请查看我在下面的链接中找到此答案的文章。资料来源：[http ://boulderapps.co/mysql-concat-limitation](http://boulderapps.co/mysql-concat-limitation)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T17:46:01.323

mysql 文档中的 GROUP_CONCAT：

> 结果被截断为由 group_concat_max_len 系统变量给出的最大长度，其默认值为 1024。该值可以设置得更高，尽管返回值的有效最大长度受 max_allowed_pa​​cket 值的限制。在运行时更改 group_concat_max_len 值的语法如下，其中 val 是无符号整数：

```
SET [GLOBAL | SESSION] group_concat_max_len = val; 
```

[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

希望这可以帮助。

# c# - 在 WPF 中创建复杂的源代码编辑控件

> ID：529107
> 
> 赞同：1
> 
> 时间：2009-02-09T17:37:16.600
> 
> 标签：c#, wpf

我想知道是否有人有任何基于 WPF 文本框创建新控件的经验，该文本框可以支持语法突出显示、行号等。

任何关于我如何开始创建这样的东西的链接或建议都会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T17:45:03.587

嘿。我没有任何个人经验来实现你所建议的东西，但我发现了一些可能对你有所帮助的链接。

*   [带有语法高亮的派生富文本框](http://pietschsoft.com/post/2005/05/VBNET-Syntax-Highlighting-in-a-RichTextBox-control.aspx)
*   [SharpDevelop](http://www.icsharpcode.net/Opensource/SD/)（它是开源的，您可能可以从他们的源代码中获取一些见解以突出显示语法）
*   [Coacoa 应用程序中的语法高亮显示](http://www.cocoadev.com/index.pl?ImplementSyntaxHighlighting)（也许可以从中收集一些方法）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T17:45:55.987

这应该可以帮助您[在 RichTextBox 中启动 WPF 语法突出显示](http://khason.net/blog/richtextbox-syntax-highlighting/)

# c - C - 传递已知大小的引用多维数组

> ID：529109
> 
> 赞同：3
> 
> 时间：2009-02-09T17:37:54.120
> 
> 标签：c, arrays, reference, multidimensional-array

主要：

```
char *myData[500][9]; //dynamic rows??
char **tableData[500]={NULL};         //dynamic rows??
int r;

newCallBack(db, &myData, &tableData, &r); 
```

并通过以下方式传递给函数：

```
void newCallBack(sqlite3 *db, char** mdat, char*** tdat, int* r )
{ 
```

好像不喜欢这个？有什么建议么？当你不知道尺寸时，网上有很多例子，现在就试试吧......

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T18:29:12.607

如果您要这样重写：

```
#define NUM_ROWS 500;
#define NUM_COLS 9;

char **myData  = NULL;
char  *tableData = NULL;
int    i;
int    r;

myData = malloc(sizeof(char *) * NUM_ROWS);
if (!myData)
    return; /*bad return from malloc*/

tableData = malloc(sizeof(char) * NUM_ROWS);
if (!tableData)
    return; /*bad return from malloc*/

for (i = 0; i < NUM_ROWS; i++)
{
    myData[i] = malloc(sizeof(char) * NUM_COLS);
    if (!myData[i])
        return;  /*bad return from malloc*/
} 
```

如果您只想访问数据（**myData**、**tableData**和**r** ），您可以像这样调用**newCallBack(** ) ：

 ******```
/*prototype*/
void newCallBack(sqlite3 *db, char** mdat, char* tdat, int r);

/*call*/
newCallBack(db, myData, tableData, r); 
```

或者，如果您希望能够修改变量**myData 和 tableData**指向的内容以及**r**的值：

```
/*prototype*/
void newCallBack(sqlite3 *db, char ***mdat, char **tdat, int *r);

/*call*/
newCallBack(db, &myData, &tableData, &r); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T17:43:50.813

首先，myData 的问题在于它的类型错误。char* [][] 在您调用的函数中需要一个原型 char***（字符串的二维数组）。如果您不介意限制字符串的大小，该函数需要一个字符串列表，即 char* [] 或 char[][]。

要获得完全动态的数组大小，您必须使用 malloc() 和 free() 手动分配（并释放！）内存，并将变量的类型更改为 char **myData 和 char ***tableData。

# mdx - MDX 查询/表达式不起作用

> ID：529115
> 
> 赞同：2
> 
> 时间：2009-02-09T17:40:52.613
> 
> 标签：mdx

我是 MDX 表达式和查询的新手，我目前正在寻找这样的东西 -

我在事实表中有两个日期“ `Date1`”和“ `Date2`”作为 DATE 维度的外键。我需要做一个`count of rows where Date1 < Date 2`，考虑到我不想计算 NULLS。我写了一个类似这样的表达式 -

```
WITH MEMBER [Measures].[RecordCount] AS
COUNT(FILTER([Measures].[RecordCount], IIF([Date1].[Date] <= [Date2].[Date],0,1)=1))
SELECT [Measures].[RecordCount] ON 0
FROM [MYCUBE] 
```

上述查询运行良好，但计数结果不正确。我在事实表中创建了 7 行，其中 Date1 小于 Date2，但我仍然收到计数为 0。

任何帮助表示赞赏。（任何参考网站都对未来有好处）

谢谢， Vineet vineet9860@gmail.com

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T22:59:53.907

在 MDX 中您不能真正轻松地做到这一点，[RecordCount] 度量将在您进行日期比较之前汇总，因此您永远不会得到有效值。

您最好在 DSV 中创建一个命名计算，其内容类似于

```
CASE WHEN Date1 < Date2 THEN 1 ELSE NULL END 
```

然后在你的多维数据集中创建一个度量来总结这个新列。

# java - 现有服务层首先使用 WSDL

> ID：529116
> 
> 赞同：0
> 
> 时间：2009-02-09T17:40:54.830
> 
> 标签：java, wsdl

我正在开发一个具有典型服务的现有 Java 项目 - 只有一个 web 应用程序可用的 dao 设置。我的工作是在服务层之上添加 web 服务，但是 web 服务有自己的功能分析和数据模型。课程的功能分析侧重于不同服务方法的可能性。

作为良好实践的要求，我们使用了 WSDL 优先策略并为 Web 服务生成了 JAXB 绑定的 Java 类和 SEI。在部分实现了 web 服务之后，我们注意到数据模型之间有 70% 的匹配度。这导致编写转换器，这些转换器采用 web 服务 JAXB 类并将它们与服务层类映射。

```
Customer customer = new Customer();
customer.setName(wsCustomer.getName());
customer.setFirstName(wsCustomer.getFirstName();
.. 
```

这是一个非常明显的例子，其他一些更复杂的映射。任何人都可以为这种情况提供他的最佳实践、经验和解决方案吗？

这些框架中的任何一个有用吗？ [http://transmorph.sourceforge.net/wiki/index.php/Main_Page](http://transmorph.sourceforge.net/wiki/index.php/Main_Page) [http://ezmorph.sourceforge.net/](http://ezmorph.sourceforge.net/)

请不要开始讨论 WSDL 优先与代码优先。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T14:12:18.533

我在我的项目中遇到了同样的问题。我为生成的对象创建了一个工厂并将其用于创建对象。

```
Customer customer = factory.createCustomer(wsCustomer); 
```

它隔离了构造代码，不改变生成的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T23:56:17.780

我认为真正的问题是......您将来想使用多少代码生成器，您能否让它们生成您现在正在做的事情。如果您不关心工具的代码生成功能，或者它们可以适应您的需求，那么将所有内容转换为您当前的数据模型是一个好主意。

# multithreading - 如何在不锁定的情况下将数据从一个线程输出到另一个线程？

> ID：529118
> 
> 赞同：0
> 
> 时间：2009-02-09T17:41:11.770
> 
> 标签：multithreading, message-queue, deadlock, directshow

我正在开发一个 DirectShow 应用程序。我遇到了一个死锁问题，这个问题似乎是由线程调用的回调函数中的获取锁引起的。这是我在 MSDN 论坛中提出的问题：

[http://social.msdn.microsoft.com/Forums/en-US/windowsdirectshowdevelopment/thread/f9430f17-6274-45fc-abd1-11ef14ef4c6a](http://social.msdn.microsoft.com/Forums/en-US/windowsdirectshowdevelopment/thread/f9430f17-6274-45fc-abd1-11ef14ef4c6a)

现在我必须避免在该线程中获取锁。但问题是，我必须将音频输出到另一个线程，我怎样才能将数据不加锁地放到另一个线程？

有人告诉我，我可以使用 win32 sdk 的 PostMessage 将数据发布到另一个线程。但是，为了得到消息，我必须运行一个 Windows 程序。我的程序是一个 Python C++ 扩展模块。添加循环来拉取消息可能非常困难。所以我认为另一种在线程之间传递数据而不锁定的方法。（其实……生产者线程不能被锁定，但是消费者线程可以做到。）

> 锁还是不锁，这是个问题。

那么问题来了怎么办？

谢谢。

- - - 编辑 - - -

我想我知道为什么会出现死锁，那可能不是 DirectShow 的问题。

主线程是Python自己的，调用stop，即持有GIL。并在线程返回中停止等待 DirectShow 的回调。但是回调获取 GIL。

看起来像这样

Main(Hold GIL) -> Stop(Wait callback) -> Callback(Wait GIL) -> GIL(Hold by Main thread)

该死的！这就是为什么我不太喜欢多线程的原因。不管怎样，谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T17:56:52.950

如果您在纯 Python 中执行此操作，我会使用一个[`Queue`](http://docs.python.org/library/queue.html)对象；这些缓冲写入但在读取时阻塞的数据，直到有东西可用，并在引擎盖下进行任何必要的锁定。

这是一种极其常见的数据类型，无论您当前使用何种语言或工具链，都应该始终提供一些等效的数据类型；例如，C++ 中有一个可用的 STL 队列，但标准没有指定线程安全特性（请参阅本地实现文档）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T17:58:42.977

好吧，如果您的两个线程都可以处理相同数据的重复副本，理论上可以避免锁定。在 MSDN 论坛中阅读您的问题后...

> “所以为了避免死锁，我不应该在抓取回调函数中获取任何锁？如果我想将音频输出到另一个线程怎么办？”

我认为您应该能够将音频数据存放在出列队列（STL 类）中，然后从另一个线程中获取这些数据。然后，这个其他线程可以处理您的音频数据。

我很高兴您的问题已经解决，因为我询问您的操作系统的原因是您提到的文档说您不应该因为 win16Mutexes 的一些问题而等待其他线程。Windows XP 上没有 win16mutexes（程序在 ntvdm/wow16 上运行时除外），因此您应该能够使用锁来同步这些线程。

# wpf - WPF：禁用列表框，但启用滚动

> ID：529121
> 
> 赞同：8
> 
> 时间：2009-02-09T17:42:06.993
> 
> 标签：wpf, listbox, scrollbar

整个早上都在敲我的头。

基本上，我有一个列表框，我想防止人们在长时间运行的过程中更改选择，但允许他们仍然滚动。

解决方案：

所有的答案都很好，我选择了吞下鼠标事件，因为那是最直接的。我将 PreviewMouseDown 和 PreviewMouseUp 连接到一个事件，该事件检查了我的 backgroundWorker.IsBusy，以及是否将事件 args 上的 IsHandled 属性设置为 true。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T18:19:41.617

如果查看ListBox的控件模板，里面有一个ScrollBar和ItemsPresenter。所以禁用 ItemsPresenter，你会很容易得到这个。在 ListBox 上使用波纹管样式，您就可以开始了。

```
 <Style x:Key="disabledListBoxWithScroll" TargetType="{x:Type ListBox}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBox}">
                    <Border x:Name="Bd" SnapsToDevicePixels="true" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="1">
                        <ScrollViewer Padding="{TemplateBinding Padding}" Focusable="false">
                            <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" IsEnabled="False" IsHitTestVisible="True"/>
                        </ScrollViewer>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
                        </Trigger>
                        <Trigger Property="IsGrouping" Value="true">
                            <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

在 ListBox 上使用 Style

```
<ListBox    Style="{DynamicResource disabledListBoxWithScroll}" ..... /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-14T01:15:30.773

抱歉已经快两年了，但我认为这个使用DataTrigger的解决方案更简单。[如何根据属性值禁用数据绑定的 ListBox 项？](https://stackoverflow.com/questions/1824543/disable-a-single-wpf-listbox-item/1824630#1824630)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-26T12:38:40.970

我发现将禁用的 ListBox 放入启用自动滚动的 ScrollViewer 会产生所需的效果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T17:49:56.897

虽然它适用于 Silverlight，但也许这篇博文会帮助您朝着正确的方向前进？[Silverlight 无选择列表框和视图框](http://blogs.msdn.com/mikeormond/archive/2008/12/14/silverlight-no-selection-listbox-and-viewbox.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T17:50:24.963

诀窍是不要真正禁用。禁用将锁定滚动框中的所有消息。

在长时间操作期间，使用其 .ForeColor 属性将列表框中的文本变灰并吞下所有鼠标单击。这将模拟禁用控件并允许滚动畅通无阻。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-09T11:50:46.003

我使用了这个解决方案，它真的很简单而且效果很好：

对于`SurfaceListBoxItem item`您放入的每一个`Listbox`，请执行以下操作：

```
item.IsHitTestVisible = false; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-04-04T18:27:01.993

这对我来说效果最好。这很容易，整个代码都在 XAML 中，这在 IMO 中非常简洁。

```
<ListBox ItemsSource="{Binding MySource}">
  <ListBox.ItemContainerStyle>
    <Style TargetType="ListBoxItem">
      <Style.Triggers>
        <DataTrigger Binding="{Binding IsEditing}" Value="True">
          <Setter Property="IsEnabled" Value="True"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding IsEditing}" Value="False">
          <Setter Property="IsEnabled" Value="False"/>
        </DataTrigger>
      </Style.Triggers>
    </Style>
  </ListBox.ItemContainerStyle>  
</ListBox> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-16T02:08:09.067

另一个值得考虑的选项是禁用 ListBoxItems。这可以通过设置 ItemContainerStyle 来完成，如下面的代码片段所示。

```
<ListBox ItemsSource="{Binding YourCollection}">
    <ListBox.ItemContainerStyle>
        <Style TargetType="ListBoxItem">
            <Setter Property="IsEnabled" Value="False" />
        </Style>
    </ListBox.ItemContainerStyle>
</ListBox> 
```

如果您不希望文本为灰色，您可以通过使用以下键向样式资源添加画笔来指定禁用的颜色：{x:Static SystemColors.GrayTextBrushKey}。另一种解决方案是覆盖 ListBoxItem 控件模板。

这个问题与这个问题几乎相同：[没有ListBox.SelectionMode =“None”，是否有另一种方法可以禁用列表框中的选择？](https://stackoverflow.com/questions/1398559/there-aint-listbox-selectionmode-none-is-there-another-way-to-disable-selecti/5011784#5011784)我的答案是一样的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-17T11:52:16.453

我找到了一个对我有用的非常简单直接的解决方案，我希望它也对你有用

```
<ListBox.ItemContainerStyle>
<Style TargetType="{x:Type ListBoxItem}">
     <Setter Property="Focusable" Value="False"/>
 </Style> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-03-08T13:39:16.607

使用[http://www.codeproject.com/Tips/60619/Scrollable-Disabled-ListBox-in-WPF的完整答案](http://www.codeproject.com/Tips/60619/Scrollable-Disabled-ListBox-in-WPF)

样式：

```
<Style TargetType="{x:Type local:CustomListBox}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type local:CustomListBox}">
                <Border SnapsToDevicePixels="true" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="1">
                    <ScrollViewer IsEnabled="True">
                        <ItemsPresenter IsEnabled="{Binding Path=IsEnabledWithScroll,  RelativeSource={RelativeSource TemplatedParent}}"  SnapsToDevicePixels="{TemplateBinding  UIElement.SnapsToDevicePixels}"/>
                    </ScrollViewer>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

班上

```
public class CustomListBox : ListBox
{
    public bool IsEnabledWithScroll
    {
        get { return (bool)GetValue(IsEnabledWithScrollProperty); }
        set { SetValue(IsEnabledWithScrollProperty, value); }
    }

    public static readonly DependencyProperty IsEnabledWithScrollProperty =
        DependencyProperty.Register("IsEnabledWithScroll", typeof(bool), typeof(CustomListBox), new UIPropertyMetadata(true));
} 
```

然后，不要在 ListBox 上设置 IsEnabled，而是使用 IsEnabledWithScroll。如果启用或禁用列表框，滚动将起作用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-10-05T18:18:23.740

似乎有很多方法可以给这只猫剥皮。我发现通过在 XAML 中设置，我得到了我需要`IsHitTestVisible`的东西：`ItemsContainerStyle`

```
<ListBox IsHitTestVisible="true" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.CanContentScroll="True">
    <ListBox.ItemContainerStyle>
        <Style TargetType="ListBoxItem">
            <Setter Property="IsHitTestVisible" Value="False" />
        </Style>
    </ListBox.ItemContainerStyle>
</ListBox> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-12-24T14:18:16.513

好吧，我找到了一种提供此功能的好方法。我所做的是，在 listBox 的 DataTemplate 中，我使用 Page 作为 Source 将父布局启用属性与布尔标志绑定在一起。

**第 1 步**- 为页面提供**x:Name**属性。如果您使用的页面是用基页扩展的，那么请确保基页不是抽象类并且具有不带任何参数的默认构造函数。

```
<Page x:Class="OPMS.Views.Registration"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    x:Name="MainPage"
    d:DesignWidth="1024"
    Title="Registration"
> 
```

**第 2 步**- 将页面用作 DataTemplate 父布局项 IsEnabled 属性的源

```
<ListBox Grid.Row="2"
    ItemsSource="{Binding TestGroups}"
    AlternationCount="2"
    Padding="0"
    Margin="10,5,10,10"
>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <CheckBox Content="{Binding Name}"
                IsChecked="{Binding IsSelected}"
                IsEnabled="{Binding Source={x:Reference MainPage}, Path=DataContext.BindingVariableHere}"
            />
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

# ruby - 使用 Ruby PDF::Writer 或 Ruport 显示数学能力？

> ID：529135
> 
> 赞同：1
> 
> 时间：2009-02-09T17:45:38.123
> 
> 标签：ruby, pdf, ruport

有没有一种简单的方法可以在使用 Ruby PDF::Writer 库生成的 PDF 中显示功能？我意识到我可以只打印比基数高一点的指数，但是我想也许有一些更简单的方法可以做到这一点......比如某种标记标签。

基本上，我想干净地显示 x**-2。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T19:00:49.473

我写了一个快速算法来做我需要做的事情。希望它也对你有用。唯一的要求是您使用 PDF::Writer。下面的方法是使用 PDF::Writer 和 Ruport。但是，如果您不使用 Ruport，您唯一需要更改的是“draw_text”方法。用 PDF::Writer "text" 方法替换它。

```
def draw_text_with_exponent(text, left, font_size)
    exponent_offset = 1
    font_size_reduction = 5

    words = text.split(" ")

    buffer = ""
    words.each() do |word|
        if (word.gsub("**", '') == word)
            buffer += word + " "
        else
            number = word.split("**")
            base = number[0]
            exponent = number[1]

            buffer += base
            draw_text(buffer, :left => left, :font_size => font_size)
            left += pdf_writer.text_line_width(buffer, font_size)

            pdf_writer.y+=exponent_offset
            draw_text(exponent, :left => left, :font_size => font_size - font_size_reduction)
            left += pdf_writer.text_line_width(exponent, font_size)
            buffer = ""
            pdf_writer.y-=exponent_offset
        end
    end

    if (buffer.length > 0)
        draw_text(buffer, :left => left, :font_size => font_size)
    end
end 
```

这是一个示例调用：

```
draw_text_with_exponent("The numbers are x**2 and y**3 ok?", 50, 11) 
```

如果您对这种方法有任何问题，或者您找到了我最初问题的答案，请告诉我。

-J.P

# c# - 用于 c# 对象数据源的 EDI x12 映射器

> ID：529139
> 
> 赞同：5
> 
> 时间：2009-02-09T17:46:07.873
> 
> 标签：c#, x12

有谁知道任何可以将 EDI x12 映射到 C# 对象的工具？我只是查看了 Altova MapForce，但它似乎不支持这一点。出于可移植性的原因，我不能使用数据库模式映射......如果可以的话，我宁愿避免使用 xml 或平面文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T19:47:27.520

实际上，MapForce 使用他们提供的插件包确实支持这一点（不确定它是否免费）。大约一年前，我出于这个目的评估了 MapForce（将 EDI x12 835i 和 835p 文件映射到数据库）。

这是 MapForce 的 EDI 映射页面的链接，其中特别提到了 ANSI x12 映射：[http ://www.altova.com/products/mapforce/edi-mapping.html](http://www.altova.com/products/mapforce/edi-mapping.html)

MapForce 实际上为一个完整的应用程序生成 C# 或 Java 代码，这些应用程序将执行您设置的映射；您可以在自己的代码中使用该应用程序中的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-27T18:09:57.370

您也可以使用 Symphonia：[http ://www.orionhealth.com/products/symphonia/](http://www.orionhealth.com/products/symphonia/)

-戴夫

# c# - 如何一次限制一个方法调用？

> ID：529141
> 
> 赞同：5
> 
> 时间：2009-02-09T17:47:07.637
> 
> 标签：c#, .net, windows-services

我想知道如何实现以下限制：在之前的调用完成之前，不应再次调用我的 Windows 服务中的一个方法。有问题的方法通过几个数据库表进行，并且在完成之前不会再次调用此过程非常重要。我有一个设置，它定义了我的服务激活的频率，并且在正常情况下，它在之前的调用完成之前永远不会激活（因为整个过程不应该超过几分钟，并且间隔设置为 10 分钟）但那不是果然。我猜。

如何实施？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-09T17:49:56.820

您可以使用[命名的 Mutex](http://msdn.microsoft.com/en-us/library/system.threading.mutex(VS.80).aspx)或[命名的 Semaphor](http://msdn.microsoft.com/en-us/library/system.threading.semaphore(VS.80).aspx) e 来确保一次只有一个 Mutex/Semaphore 的持有者正在执行。正如评论者指出的那样，请记住，您必须小心不要放弃互斥锁或不正确地获取/释放信号量。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-09T17:51:18.953

一种方法是使用锁定：

```
private readonly object myLock = new object();

private void MyMethod()
{
   lock(myLock)
   {
      //code goes here
   }
} 
```

这确保了此方法一次永远不会运行多次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T17:56:24.543

我支持 Mutex 的建议，但您可能还想看看事务。将您的整个代码包装在一个事务中（这需要一个`using System.Transactions`）：

```
using(TransactionScope scope = new TransactionScope())
{
    try 
    {
        /* ... your current code here */
        scope.Complete();
    }
    catch (Exception e)
    {
        /* Any appropriate error handling/logging here */
    }
    finally
    {
    }
} 
```

事务范围自动锁定所有相关表。您可以减少限制并允许其他进程读取，但不能写入您的进程正在接触的数据。为此，您可以将选项传递给 TransactionsScope 构造函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T17:50:13.607

好吧，如果所有代码都已本地化，您可以设置一个布尔值并在执行该方法之前检查该布尔值，否则您可以在执行之前进行 IPC 并请求状态。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T17:52:12.587

一些替代方案：

1.  您可以检查调用以检查某些标志或调用 Monitor.TryEnter 并返回错误/如果为负则不执行任何操作。
2.  您可以将调用排队（如果您需要此方法执行多次）并且仅在 Monitor 发出信号时调用。
3.  如果您不介意阻塞，并且该方法在单独的线程上，您可以加入您要等待的方法的线程。

我确定还有其他人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T17:54:31.550

这听起来像是一个连续的工作流程......您是否考虑过使用工作流程框架？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T18:22:37.600

如果您不介意一次将一个线程限制为整个对象，那么您可以使用：

[同步上下文](http://www.albahari.com/threading/part2.aspx#_Synchronization_Contexts)

1.  让你的类继承自**ContextBoundObject**
2.  将**[Synchronization]**属性应用于类。

CLR 一次只允许一个线程执行该类的每个实例的代码。其他人将阻塞，直到当前线程释放锁为止。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-26T11:04:29.433

如果你希望你的函数使用 await/async 运行

```
private static readonly SemaphoreSlim yourLock = new SemaphoreSlim(1, 1); //allow only 1 thread at time

...
private async Task<string> YourFunction() { 
await yourLock.WaitAsync();
            try
            {
                //your code go here
            }
            finally
            {
                yourLock.Release();
            }
} 
```

# sql-server-2005 - SQL Server 架构有什么好处？

> ID：529142
> 
> 赞同：197
> 
> 时间：2009-02-09T17:47:45.217
> 
> 标签：sql-server-2005, schema, theory

我不是使用 SQL 数据库的初学者，尤其是 SQL Server。但是，我主要是使用 SQL 2000 的人，并且一直对 2005 年及以后的模式感到困惑。是的，我知道架构的基本定义，但它们在典型的 SQL Server 部署中真正用于什么？

我一直只使用默认模式。为什么我要创建专门的模式？为什么我要分配任何内置模式？

编辑：澄清一下，我想我正在寻找模式的好处。如果您只打算将其用作安全方案，那么似乎数据库角色已经填补了那个.. er.. um.. 角色。并且使用它作为命名空间说明符似乎是您可以通过所有权完成的事情（dbo 与用户等）。

我想我的意思是，Schemas 做了哪些所有者和角色不能做的事情？它们的具体好处是什么？

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2009-02-09T17:50:02.343

模式在逻辑上将表、过程、视图组合在一起。架构中所有与员工相关的对象`employee`等。

您还可以仅授予一个模式的权限，以便用户只能看到他们有权访问的模式，而不能看到其他任何内容。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2010-09-06T08:28:16.147

就像 C# 代码的命名空间一样。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-02-09T17:54:00.867

它们还可以为插件数据提供一种命名冲突保护。例如，SQL Server 2008 中新的变更数据捕获功能将它使用的表放在单独的 cdc 架构中。这样，他们就不必担心 CDC 表和数据库中使用的真实表之间的命名冲突，并且可以故意隐藏真实表的名称。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2010-12-16T07:29:49.923

我知道这是一个旧线程，但我自己只是研究了模式，并认为以下可能是模式使用的另一个很好的候选者：

在数据仓库中，由于数据来自不同的来源，您可以为每个来源使用不同的模式，然后例如基于模式控制访问。还避免了各种来源之间可能的命名冲突，正如上面另一位发帖人所回答的那样。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-12-27T18:33:21.513

如果您保持架构离散，则可以通过将给定架构部署到新数据库服务器来扩展应用程序。（这假设您有一个足够大以具有不同功能的应用程序或系统）。

例如，考虑一个执行日志记录的系统。所有日志记录表和 SP 都在 [logging] 模式中。日志是一个很好的例子，因为系统中的其他功能很少（如果有的话）会与日志模式中的对象重叠（即加入）。

使用此技术的提示——在您的应用程序/系统中为每个模式使用不同的连接字符串。然后将架构元素部署到新服务器并在需要扩展时更改连接字符串。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-12-05T22:06:19.363

我倾向于同意布伦特的观点……请参阅此处的讨论。[http://www.brentozar.com/archive/2010/05/why-use-schemas/](http://www.brentozar.com/archive/2010/05/why-use-schemas/)

简而言之......除了非常特定的用例之外，模式并不是非常有用。让事情变得一团糟。如果您能提供帮助，请不要使用它们。并尝试遵守 K(eep) I(t) S(imple) S(tupid) 规则。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-10-22T22:01:06.807

我没有看到将与模式绑定的用户混叠的好处。这就是为什么....

大多数人最初通过角色将他们的用户帐户连接到数据库，一旦您以任何形式将用户分配给系统管理员或数据库角色 db_owner，该帐户要么别名为“dbo”用户帐户，要么具有完整的数据库的权限。一旦发生这种情况，无论您如何将自己分配给默认架构（与您的用户帐户同名）之外的方案，这些 dbo 权限都会分配给您在用户和架构下创建的那些对象。它有点毫无意义……只是一个命名空间，混淆了这些对象的真正所有权。如果你问我，它的设计很糟糕......无论是谁设计的。

他们应该做的是创建“组”，并丢弃模式和角色，只允许您以您喜欢的任何组合对组组进行分层，然后在每一层告诉系统权限是否被继承、拒绝或被自定义覆盖那些。这将更加直观，并允许 DBA 更好地控制这些对象的真正所有者。现在它在大多数情况下暗示 dbo 默认 SQL Server 用户拥有这些权限....而不是用户。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-11-02T18:47:01.627

在我工作多年的 ORACLE 商店，模式用于封装适用于不同前端应用程序的过程（和包）。每个应用程序使用不同的“API”模式通常是有意义的，因为用例、用户和系统要求完全不同。例如，一个“API”模式用于开发/配置应用程序，仅供开发人员使用。另一个“API”模式用于通过视图和过程（搜索）访问客户端数据。另一个“API”模式封装的代码用于将开发/配置和客户端数据与拥有自己数据库的应用程序同步。在幕后，其中一些“API”模式仍将彼此共享通用过程和功能（通过其他“COMMON”

我会说没有模式可能不是世界末日，尽管它可能非常有用。确实，SQL Server 中缺少包确实在我的脑海中产生了问题……但这是一个不同的话题。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-09T18:48:17.867

我认为模式就像很多新功能（无论是 SQL Server 还是任何其他软件工具）。您需要仔细评估将其添加到您的开发套件的好处是否可以抵消设计和实现中的简单性损失。

在我看来，模式大致相当于可选的命名空间。如果您处于对象名称冲突且权限粒度不够精细的情况，这里有一个工具。（我倾向于说可能存在应该首先在更基本的层面处理的设计问题。）

问题可能是，如果它存在，一些开发人员会开始随便使用它来获取短期利益；一旦它在那里，它就可以变成葛根。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-06-28T06:45:52.573

在 SQL Server 2000 中，创建的对象链接到该特定用户，例如，如果用户说 Sam 创建了一个对象，比如员工，则该表将显示为：Sam.Employees。如果 Sam 离开公司或搬到其他业务领域怎么办？删除用户 Sam 后，Sam.Employees 表会发生什么情况？可能，您必须首先将所有权从 Sam.Employees 更改为 dbo.Employess。Schema 提供了解决此问题的解决方案。Sam 可以在诸如 Emp_Schema 之类的模式中创建他的所有对象。现在，如果他在 Emp_Schema 中创建一个对象 Employees，那么该对象将被称为 Emp_Schema.Employees。即使需要删除用户帐户 Sam，架构也不会受到影响。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-09T17:53:44.017

开发 - 我们的每个开发人员都有自己的模式作为沙盒来玩。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-06-20T10:59:01.313

这是使用 SQL Server 架构的一个很好的实现示例。我们有几个 ms-access 应用程序。我们希望将它们转换为 ASP.NET 应用程序门户。每个 ms-access 应用程序都被编写为该门户的应用程序。每个 ms-access 应用程序都有自己的数据库表。其中一些是相关的，我们将它们放在 SQL Server 的公共 dbo 模式中。其余的都有自己的模式。这样，如果我们想知道哪些表属于 ASP.NET 应用程序门户上的某个应用程序，可以轻松导航、可视化和维护。

# terminal - AppleScript Terminal.app 如何复制屏幕上的当前文本？

> ID：529143
> 
> 赞同：2
> 
> 时间：2009-02-09T17:48:33.173
> 
> 标签：terminal, applescript

我在 AppleScript 字典中看到当前屏幕的文本价值和历史缓冲区可作为属性使用。

我将如何使用 AppleScript 将当前选定的 Terminal.app 选项卡的内容复制到粘贴缓冲区？

我可以在命令行上做吗？

整个历史记录呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T06:40:13.677

要从命令行复制当前选定的 Terminal.app 的内容：

```
osascript <<END
  tell application "Terminal"
    tell front window
      set the clipboard to contents of selected tab as text
    end
  end
END 
```

对于历史：

```
osascript <<END
  tell application "Terminal"
    tell front window
      set the clipboard to history of selected tab as text
    end
  end
END 
```

# sql-server - 在 SQL Sever 2005 中平均时间值

> ID：529144
> 
> 赞同：3
> 
> 时间：2009-02-09T17:48:35.433
> 
> 标签：sql-server, casting, aggregate

我在 SQL Sever 2005 中有一个 varchar 字段，它以“hh:mm”ss.mmmm 格式存储时间值。

我真正想做的是使用这些时间值的内置聚合函数取平均值。然而，这：

```
SELECT AVG(TimeField) FROM TableWithTimeValues 
```

不起作用，因为（当然）SQL 不会平均 varchars。然而，这

```
SELECT AVG(CAST(TimeField as datetime)) FROM TableWithTimeValues 
```

也不起作用。据我所知，SQL 不知道如何将只有时间且没有日期的值转换为日期时间字段。我已经尝试了各种各样的方法来让 SQL 将该字段转换为日期时间，但到目前为止，还没有运气。

任何人都可以提出更好的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-09T23:02:32.183

SQL Server 可以将日期时间值的仅时间部分从字符串转换为日期时间，但是在您的示例中，您的精度为 4 位小数。SQL Server 2005 只识别 3 个位置。因此，您需要截断最右边的字符：

```
create table #TableWithTimeValues
(
    TimeField varchar(13) not null
)

insert into #TableWithTimeValues
select '04:00:00.0000'
union all
select '05:00:00.0000'
union all
select '06:00:00.0000'

SELECT CAST(TimeField as datetime) FROM #TableWithTimeValues
--Msg 241, Level 16, State 1, Line 1
--Conversion failed when converting datetime from character string.

SELECT CAST(LEFT(TimeField, 12) as datetime) FROM #TableWithTimeValues
--Success! 
```

这会将有效值转换为从 1900-01-01 开始的 DATETIME。SQL Server 根据 1 天 = 1（整数）计算日期。天的部分是值 1 的部分（即中午是 0.5）。由于在转换中没有指定日期，SQL Server 分配了 0 天 (1900-01-01) 的值，这可以满足我们对时间部分进行平均的需要。

要对 DATETIME 执行 AVG 操作，您必须首先将 DATETIME 转换为十进制值，执行聚合，然后再回滚。例如

```
SELECT CAST(AVG(CAST(CAST(LEFT(TimeField, 12) as datetime) AS FLOAT)) AS DATETIME) FROM #TableWithTimeValues
--1900-01-01 05:00:00.000 
```

如果您需要使用额外的小数位存储它，您可以将 DATETIME 转换为仅包含时间部分的 VARCHAR，并将字符串填充回 13 个字符：

```
SELECT CONVERT(VARCHAR, CAST(AVG(CAST(CAST(LEFT(TimeField, 12) as datetime) AS FLOAT)) AS DATETIME), 114) + '0' FROM #TableWithTimeValues 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T17:55:55.590

试试这个

```
AVG(CAST(CAST('1900-01-01 ' + TimeField AS DateTime) AS Float)) 
```

无论如何，您确实应该将它们存储在日期时间列中。只需为该部分使用一致的日期（1/1/1900 很常见）。然后你可以只调用 AVG() 而不用担心它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T14:50:12.147

我使用 Cadaeic 的回复得到了我正在寻找的答案，所以我想我应该分享代码....

我正在寻找一个可以平均我所有时间的查询，并为我提供所有批准的总体周转时间。下面是一个嵌套语句，它为您提供单个 id 的 AVG TAT 以及嵌套时的整体 TAT

```
SELECT 
-- calculates overall TAT for ALL Approvals for specified period of time
-- depending on parameters of query
CONVERT(VARCHAR, CAST(AVG(CAST(CAST(LEFT(Tat_mins, 12) as datetime) AS FLOAT)) AS DATETIME), 108) + '0'

from 
(
-- tat is for individual approvals 
SELECT 
dbo.credit_application.decision_status,
dbo.credit_application.application_id,
cast(dbo.credit_application.data_entry_complete as date) as'Data Entry Date',
cast(dbo.credit_application.decision_date as DATE) as 'Decision Date',
avg(datediff(minute, dbo.credit_application.data_entry_complete, dbo.credit_application.decision_date)) as 'TAT Minutes',
convert (char(5), DateAdd(minute, Datediff(minute,dbo.credit_application.data_entry_complete, dbo.credit_application.decision_date),'00:00:00'),108) as 'TAT_Mins'
FROM  dbo.credit_application
where Decision_status not in ('P','N')

group by dbo.credit_application.decision_status,
dbo.credit_application.data_entry_complete,
dbo.credit_application.decision_date
--dbo.credit_application.application_id
)bb 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T17:59:40.430

您如何看待日期时间的平均？

我想您需要按某个时间段（小时？）分组，并显示计数（*）？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T11:15:00.233

SQL Server 将日期时间数据存储为 2 个 4 字节整数，因此一个日期时间需要 8 个字节。第一个是自基准日期以来的天数，第二个是自午夜以来的毫秒数。

您可以将日期时间值转换为整数并执行数学运算，但转换仅返回日期时间值的“天”部分，例如 select convert(int,getdate())。将“时间”部分作为整数返回更加困难。

您是否可以选择使用 SQL Server 2008？该版本具有新的[专用时间数据类型](http://msdn.microsoft.com/en-us/library/bb677243.aspx)。

谢谢，安迪。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T11:17:14.690

我会计算出所有日期和任意点（01/01/1900）之间的差异，将其平均，然后将其添加回任意点。

# asp.net-mvc - ASP.NET MVC - 每次处理 Site.Master 时执行代码

> ID：529153
> 
> 赞同：1
> 
> 时间：2009-02-09T17:51:10.373
> 
> 标签：asp.net-mvc

每次处理我的 Site.Master 视图时，我想在我的 css 链接的路径上添加一些可变性。这样做的正确方法是什么？我的代码目前在 Default.aspx 上中断，说我没有定义 cssLink。Site.Master 代码如下：

```
 <script runat="server">
        void Page_Load(object sender, EventArgs e)
        {

            string cssLoc = "../../Content/css/expect.css?t=" + DateTime.Now.Ticks.ToString();
            string cssLink = String.Format(@"<link rel=""stylesheet"" type=""text/css"" href=""{0}"" />", cssLoc);
        }
    </script>

    <!DOCTYPE html>
    <html>
    <head id="Head1" runat="server">   
        <asp:ContentPlaceHolder ID="head" runat="server">
        <title></title>
        </asp:ContentPlaceHolder>    
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <%= cssLink %>
        <script type="text/javascript" src="../../Scripts/jquery.js"></script>
    </head> 
```

另外，是否有解决“XHTML 过渡，标题出现次数太少”的消息？

**更新：**
请忽略范围问题。见理查德的回答。但是，我应该注意，解决此问题并不能解决问题。
我认为由于 Inherits="System.Web.Mvc.ViewMasterPage" 声明整个
`<script runat="server">`块没有得到处理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T17:55:18.070

只需像通常那样定义您的 css 链接并添加一些内联处理。您正在尝试在 MVC 视图中执行 Page_Load ，这不是一个可行的解决方案......

```
<link href="../../Content/css/expect.css?t=<%=DateTime.Now()%>" type="text/css" rel="Stylesheet" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T17:55:20.690

您已将 cssLink 声明为 Page_Load 中的局部变量。因此，您的页面将无法使用它。

这应该可以为您解决问题：

```
<script runat="server">
    private string cssLoc;
    private string cssLink;

    void Page_Load(object sender, EventArgs e)
    {

        cssLoc = "../../Content/css/expect.css?t=" + DateTime.Now.Ticks.ToString();
        cssLink = String.Format(@"<link rel=""stylesheet"" type=""text/css"" href=""{0}"" />", cssLoc);
    }
</script>

<!DOCTYPE html>
<html>
<head id="Head1" runat="server">   
    <asp:ContentPlaceHolder ID="head" runat="server">
    <title></title>
    </asp:ContentPlaceHolder>    
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <%= cssLink %>
    <script type="text/javascript" src="../../Scripts/jquery.js"></script>
</head> 
```

**编辑：**除了回答您的直接问题外，我建议您找到一个对 MVC 更友好的解决方案（而不是将代码放在您的母版页中）。例如，您可以将 css 位置包含为 ViewData["Stylesheet"] 或使用不同的机制来更新 css（我在 MVC 的 RC 上不是最新的）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T17:58:39.840

```
<head runat="server">
      <title>Some Title</title> -- WILL FIX YOUR ISSUE
      ...
      <%= Helper.CustomStyle() %>
      ...
</head> 
```

这个 Helper.CustomStyle 内部的逻辑会根据 DateTime.Now 调用而变化，如上所示。

可以在这里找到一个非常好的教程，可以帮助您理解自定义助手：[http ://www.asp.net/learn/mvc/tutorial-09-cs.aspx](http://www.asp.net/learn/mvc/tutorial-09-cs.aspx)

记住——ASP.NET MVC 取消了 Page_Load 类型调用。这是一个独特的设计模式！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-09T18:03:58.690

考虑编写一个帮助程序来链接该 CSS 文件。

```
public static string DatedStylesheet(this HtmlHelper Html, string url, DateTime date)
{
    UrlHelper Url = new UrlHelper(new RequestContext(Html.ViewContext.HttpContext, Html.ViewContext.RouteData));
    string html = "<link type=\"text/css\" rel=\"stylesheet\" href=\"{0}?t={1}\"/>";

    return string.Format(html, Url.Content(url), date.Ticks.ToString());
}

<%= Html.DatedStylesheet("~/Content/css/expect.css", DateTime.Now); 
```

在不相关的说明中，有没有人知道在视图页面之外使用 UrlHelper 的更清洁方法？

# c# - 有人可以解释为什么会在动态加载的 UC 中发生这种情况吗？

> ID：529159
> 
> 赞同：0
> 
> 时间：2009-02-09T17:53:44.690
> 
> 标签：c#, asp.net

我通过反复试验得到了这个工作，但非常感谢解释。

摘要：我正在从主机页面动态加载用户控件。

主机页面.aspx

OnInit 执行 LoadControl 并加载控件

```
User control .ascx

On Page_Load
-> First time load
    --> I set a value to a hidden input type variable
    --> I set a value to a ViewState object (using ViewState["test"] = "test")
-> Subsequent post backs
    --> Hidden var still persists
    --> ViewState is NULL !! (Why?)

If i move the code from Page_Load to Oninit:
-> Subsequent post backs
   --> Both hidden var and Viewstate is NULL! 
```

为什么？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T17:58:20.933

*Viewstate 在 Init 阶段之后*加载，因此在您的第二种情况下它当然是 null 。

这就是您需要在那里加载控件的原因：因为如果您等到加载视图状态之后，则不会为控件恢复状态 - 它已经通过了该阶段。

# c# - LINQ 中的等号

> ID：529173
> 
> 赞同：1
> 
> 时间：2009-02-09T17:58:10.933
> 
> 标签：c#, sql-server, linq, linq-to-sql

SQL 服务器执行基于 COLLATE 选项的查询，因此您可以定义如何执行比较（区分大小写或不区分大小写）。您可以在创建表或查询执行期间执行此操作。

如何在 LINQ to SQL 查询期间控制排序规则？当我进行`table.Column == stringValue`比较时，我的查询是否总是不区分大小写？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T19:33:11.190

我不太使用 COLLATE 选项，但会尽力解决这个问题。

根据这篇[文章](http://msdn.microsoft.com/en-us/library/bb399342.aspx)：

> LINQ to SQL 在转换查询时不考虑服务器设置。

如果 COLLATE 是数据库/表/列设置，它应该只在数据库中设置，并在您连接时准备好。

如果 COLLATE 是连接设置，您可以获取数据上下文的连接并运行命令进行设置。这样做的好地方可能在`partial void OnCreated`方法中。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-02-09T19:07:09.740

您必须记住 L2S 是一个对象关系映射系统，因此它试图比较对象并转换为 SQL。在 L2S 中，如果要比较两个字符串，则必须对它们都使用 ToLower() 进行比较。

对我来说是一个“陷阱”的另一件事是，在 L2S 中，如果您提供的比较值为空，则字符串比较将无法正确评估。因此，在您的示例中，如果 table.Column 为 null 并且 stringValue 也是，您的查询将不会返回正确的结果（我基于 stringValue 是您的代码中定义的变量的假设）。为了在 L2S 中将字符串与 null 进行比较，您必须将其显式地与 null 进行比较：table.Column == null。

看看这篇[文章](http://smsohan.blogspot.com/2008/08/comparing-with-null-in-where-clause-in.html)

# validation - 您如何将 Castle Validator 与 Subsonic 生成的类一起使用？

> ID：529182
> 
> 赞同：2
> 
> 时间：2009-02-09T18:00:55.640
> 
> 标签：validation, subsonic, castle

Castle Validator 使用属性来指定验证规则。您如何将这些与 Subsonic 生成的类（或任何您无法定义属性的类）连接起来？有没有办法在不使用属性方法的情况下以编程方式指定验证规则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T03:24:13.607

我认为最好的方法是使用`MetadataType`. 这是一个`DataAnnotations`让你的班级有一对或类似的东西。我不知道如何更好地解释它，让我们来看看样本：

您首先需要将此指令添加到您的代码中：

```
using System.ComponentModel.DataAnnotations; 
```

他们应该创建您生成的类的部分类，其属性指定该类具有`MetadataType`：

```
 [MetadataType(typeof(UserMetadata))] 
public partial class User
{
} 

```

然后使用城堡验证创建元数据类：

```
 public class UserMetadata
{
    [ValidateNonEmpty]
    [ValidateLength(6, 24)]
    public string Username { get; set; }

    [ValidateNonEmpty]
    [ValidateLength(6, 100)]
    [ValidateEmail]
    public string Email { get; set; }

    [ValidateNonEmpty]
    [ValidateLength(6, 24)]
    public string Password { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T22:12:34.467

有几种方法可以做到这一点 - 属性是摩擦最小的选项，但显然不能很好地处理生成的代码或在代码中更好地表达的多个属性的验证。

请查看以下链接以获取有关如何执行此博客文章的一些指示：[Castle Validator Enhancements](http://erichauser.net/2008/08/28/castle-validator-enhancements/)

如果您查看城堡源代码，这些是一些很好的起点：

*   [IValidationContributor 接口](http://svn.castleproject.org:8080/svn/castle/trunk/Components/Validator/Castle.Components.Validator/IValidationContributor.cs)
*   [DefaultValidationPerformer 类](http://svn.castleproject.org:8080/svn/castle/trunk/Components/Validator/Castle.Components.Validator/DefaultValidationPerformer.cs)

# statistics - 简单的多维曲线拟合

> ID：529184
> 
> 赞同：21
> 
> 时间：2009-02-09T18:01:36.200
> 
> 标签：statistics, regression, best-fit-curve

我有一堆数据，一般是a,b,c,...,y

其中 y = f(a, b, c...)

其中大多数是三四个变量，并且有 10k - 10M 记录。我的一般假设是它们本质上是代数的，例如：

y = P1 a^E1 + P2 b^E2 + P3 c^E3

不幸的是，我上一次统计分析课是在 20 年前。获得 f 的良好近似值的最简单方法是什么？具有极小学习曲线的开源工具（即我可以在一小时左右得到一个体面的近似值的工具）将是理想的。谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-09T19:13:57.820

如果它有用，这里有一个 Numpy/Scipy (Python) 模板来做你想做的事：

```
from numpy import array
from scipy.optimize import leastsq

def __residual(params, y, a, b, c):
    p0, e0, p1, e1, p2, e2 = params
    return p0 * a ** e0 + p1 * b ** e1 + p2 * c ** e2 - y

# load a, b, c
# guess initial values for p0, e0, p1, e1, p2, e2
p_opt = leastsq(__residual,  array([p0, e0, p1, e1, p2, e2]), args=(y, a, b, c))
print 'y = %f a^%f + %f b^%f %f c^%f' % map(float, p_opt) 
```

但是，如果您真的想了解正在发生的事情，您将不得不投入时间来扩展某些工具或编程环境的学习曲线——我真的不认为有任何解决办法。人们通常不会编写专门的工具来专门执行 3 项幂回归之类的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T18:03:56.613

数据拟合的基础包括假设解的一般形式，猜测常量的一些初始值，然后迭代以最小化猜测解的误差以找到特定解，通常在最小二乘意义上。

查看[R](http://www.r-project.org/)或[Octave](http://www.gnu.org/software/octave/)的开源工具。他们都能够进行最小二乘分析，几个教程只需谷歌搜索即可。

**编辑：**用于估计二阶多项式系数的八度代码

```
x = 0:0.1:10;
y = 5.*x.^2 + 4.*x + 3;

% Add noise to y data
y = y + randn(size(y))*0.1;

% Estimate coefficients of polynomial
p = polyfit(x,y,2) 
```

在我的机器上，我得到：

```
ans =

   5.0886   3.9050   2.9577 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T19:01:57.177

您知道要限制多项式的幂吗？

如果没有限制，那么您始终可以通过将其与具有 N 个系数的多项式进行匹配来获得 N 个点的精确匹配。为此，您将 N 个不同的点插入方程，产生 N 个方程和 N 个未知数（系数），然后您可以使用简单的高中代数或矩阵来求解未知数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-05-10T16:52:49.573

我花了一个多星期的时间试图做同样的事情。我尝试了一大堆优化方法来微调系数，但基本上没有成功，然后我发现有一个封闭形式的解决方案，而且效果很好。

免责声明：我试图以固定的最大数量级拟合数据。如果您的 E1、E2 等值没有限制，那么这对您不起作用。

既然我已经花时间学习了这些东西，我实际上发现如果我理解了一些答案，它们会给出很好的提示。距离我上一次统计和线性代数课也有一段时间了。

因此，如果还有其他人缺乏线性代数知识，这就是我所做的。

尽管这不是您要拟合的线性函数，但事实证明这仍然是线性回归问题。维基百科有一篇关于线性回归的非常好的文章。我建议慢慢阅读：[https](https://en.wikipedia.org/wiki/Linear_regression#:%7E:text=In%20statistics%2C%20linear%20regression%20is,as%20dependent%20and%20independent%20variables) ://en.wikipedia.org/wiki/Linear_regression#:~:text=In%20statistics%2C%20linear%20regression%20is,as%20dependent%20and%20independent%20variables ）。它还链接了许多其他好的相关文章。

如果您不知道如何使用矩阵来解决简单的（单变量）线性回归问题，请花一些时间来学习如何做到这一点。

一旦你学会了如何做简单的线性回归，然后尝试一些多变量线性回归。基本上，要进行多变量线性回归，您创建一个 X 矩阵，其中每个输入数据项都有一行，并且每一行包含该数据条目的所有变量值（加上最后一列中使用的 1对于多项式末尾的常数值（称为截距）。然后创建一个 Y 矩阵，它是一个单列，每个数据项都有一行。然后你解决 B = (X ^T X) ^(-1) X ^T Y。然后 B 成为你多项式的所有系数。

对于多变量多项式回归，它的想法是一样的，刚才你有一个巨大的多变量线性回归，其中每个回归量（你正在做回归的变量）是你的巨型多项式表达式的系数。

因此，如果您的输入数据如下所示：

| 输入 | 输出 |
| --- | --- |
| a1, b1, | y1 |
| a2, b2, | y2 |
| ... | ... |
| aN, bN, | yN |

并且您想拟合 y = c1 *a^2* b^2 + c2 *a^2* b + c3 *a^2 + c4* a *b^2 + c5* a *b + c6* a + c7 *b^2形式的二阶多项式+ c8* b + c9，那么您的 X 矩阵将如下所示：

|  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| a1^2*b1^2 | a1^2*b1 | a1^2 | a1*b1^2 | a1*b1 | a1 | b1^2 | b1 | 1 |
| a2^2*b2^2 | a2^2*b2 | a2^2 | a2*b1^2 | a2*b2 | a2 | b2^2 | b2 | 1 |
| ... | ... | ... | ... | ... | ... | ... | ... | ... |
| aN^2*bN^2 | aN^2*bN | 一个N^2 | aN*bN^2 | aN*bN | 一个 | bN^2 | 氮化硼 | 1 |

您的 Y 矩阵很简单：

|  |
| --- |
| y1 |
| y2 |
| ... |
| yN |

然后你做 B = (X ^T X) ^(-1) X ^T Y 然后 B 将等于

|  |
| --- |
| c1 |
| c2 |
| c3 |
| c4 |
| c5 |
| c6 |
| c7 |
| c8 |
| c9 |

请注意，系数的总数将是 (o + 1) ^V，其中 o 是多项式的阶，V 是变量的数量，因此它增长得非常快。

如果您使用的是好的矩阵代码，那么我相信运行时复杂度将为 O(((o+1) ^V ) ³ + ((o + 1) ^V ) ² N)，其中 V 是变量的数量，o 是多项式的阶数，N 是您拥有的数据输入数。最初这听起来很糟糕，但在大多数情况下，o 和 V 可能不会很高，所以这只是关于 N 的线性关系。

请注意，如果您正在编写自己的矩阵代码，那么确保您的反演代码使用类似于[LU 分解](https://en.wikipedia.org/wiki/LU_decomposition)的东西很重要。如果你使用一种朴素的反转方法（就像我一开始所做的那样），那么 ((o+1) ^V ) ³就会变成 ((o+1) ^V )!，这就更糟了。在我做出这个改变之前，我预测我的 5 阶 3 变量多项式将需要大约 400 谷歌千年才能完成。使用LU分解后，大约需要7秒。

# 另一个免责声明

这种方法要求 (X ^T X) 不是奇异矩阵（换句话说，它可以反转）。我的线性代数有点粗糙，所以我不知道会发生这种情况的所有情况，但我知道当输入变量之间存在完美的多重共线性时会发生这种情况。这意味着一个变量只是另一个因子乘以一个常数（例如，一个输入是完成一个项目的小时数，另一个是完成一个项目的美元，但美元只是基于小时费率乘以小时数）。

好消息是，当存在完美的多重共线性时，你会知道的。当你反转矩阵时，你最终会被零除或其他东西。

更大的问题是当你有不完美的多重共线性时。那时您有两个密切相关但不完全相关的变量（例如温度和高度，或速度和马赫数）。在这些情况下，这种方法在理论上仍然有效，但它变得非常敏感，以至于小的浮点错误可能会导致结果偏离。

然而，在我的观察中，结果要么非常好，要么非常糟糕，所以你可以为你的均方误差设置一些阈值，如果超过了这个阈值，那么就说“无法计算多项式”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T18:09:14.653

如果您猜测 f,[*] 的形式，您需要一个最小化器来找到最佳参数。[Scottie T 建议的工具](https://stackoverflow.com/questions/529184/simple-multidimensional-curve-fitting/529191#529191)以及[ROOT](http://root.cern.ch/)和许多其他工具都可以使用。

如果您不知道 f 可能采用哪种形式，那么您确实陷入了大麻烦。

* * *

[*] 也就是说，你知道

f = f(x,y,z,w,...;p1,p2,p3...)

其中`p`s 是参数，坐标是`x`, `y`...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T04:02:18.540

简短的回答：这不是那么简单。考虑一种关于数据子集的非参数方法。

您需要决定两个主要问题 (1) 您是否真的关心函数的参数，即您的 P1、E1、...，或者您是否可以只估计平均函数 (2)？真的需要估计所有数据的函数吗？

我要提到的第一件事是您指定的函数是非线性的（在要估计的参数中），所以普通的最小二乘法不起作用。假设您指定了一个线性函数。10M 值仍然存在问题。可以使用 QR 分解以有效的方式执行线性回归，但您仍然需要 O(p * n^2) 算法，其中 p 是您尝试估计的参数数量。如果你想估计非线性平均函数，它会变得更糟。

在如此大的数据集中估计任何东西的唯一方法是使用一个子集来执行估计。基本上，您随机选择一个子集并使用它来估计函数。

如果您不关心参数值，而只想估计平均函数，那么使用非参数估计技术可能会更好。

希望这会有所帮助。

莱夫

# asp.net-mvc - Visual Studio 2008：将项目结构与底层文件结构同步

> ID：529187
> 
> 赞同：0
> 
> 时间：2009-02-09T18:02:35.183
> 
> 标签：asp.net-mvc, visual-studio-2008

有没有办法让（ASP.NET MVC）项目结构以与处理 ASP.NET 网站项目相同的方式反映底层物理目录？- 因此您不必通过解决方案资源管理器显式添加已经存在的文件。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T10:05:09.550

[通过使用 Chris Pietschmann 的说明将 ASP.NET MVC 应用程序转换为网站项目](http://pietschsoft.com/post/2008/08/How-To-Use-ASPNET-MVC-in-Website-rather-than-Web-Application-Project.aspx)解决了该问题。

虽然看起来我会失去一些[对 ASP.NET MVC](http://weblogs.asp.net/scottgu/archive/2008/12/19/asp-net-mvc-design-gallery-and-upcoming-view-improvements-with-the-asp-net-mvc-release-candidate.aspx)内置到 Visual Studio 中的支持功能。

# linq - 对 Enumerable 中的所有元素执行特定操作

> ID：529188
> 
> 赞同：56
> 
> 时间：2009-02-09T18:02:37.897
> 
> 标签：linq, c#-3.0, enumerable

我有一个`Enumerable<T>`并且正在寻找一种方法，该方法允许我为每个元素执行一个动作，有点像`Select`但随后是副作用。就像是：

```
string[] Names = ...;
Names.each(s => Console.Writeline(s)); 
```

或者

```
Names.each(s => GenHTMLOutput(s));   
// (where GenHTMLOutput cannot for some reason receive the enumerable itself as a parameter) 
```

我确实尝试`Select(s=> { Console.WriteLine(s); return s; })`过，但它没有打印任何东西。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-02-09T18:17:03.883

一种快速简便的方法是：

```
Names.ToList().ForEach(e => ...); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-09T18:07:33.127

您正在寻找目前仅存在于 List 通用集合中的难以捉摸的 ForEach。网上有很多关于微软是否应该将其添加为 LINQ 方法的讨论。目前，您必须自己动手：

```
public static void ForEach<T>(this IEnumerable<T> value, Action<T> action)
{
  foreach (T item in value)
  {
    action(item);
  }
} 
```

虽然该`All()`方法提供了类似的功能，但它的用例是对每个项目而不是操作执行谓词测试。当然，可以说服它执行其他任务，但这会在一定程度上改变语义，并使其他人更难解释您的代码（即，这是`All()`用于谓词测试还是动作？）。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-02-09T18:07:22.347

*^(免责声明：这篇文章不再类似于我原来的答案，而是结合了我从那以后获得的大约七年的经验。我进行了编辑，因为这是一个备受关注的问题，并且现有的答案都没有真正涵盖所有角度。如果您想查看我的原始答案，可以在[此帖子的修订历史中找到](https://stackoverflow.com/posts/529197/revisions)。)*

* * *

首先要了解的是 C# linq 操作，如`Select()`、`All()`、`Where()`等，其根源在于[函数式编程](https://en.wikipedia.org/wiki/Functional_programming)。这个想法是将函数式编程的一些更有用和更容易理解的部分带到 .Net 世界。这很重要，因为函数式编程的一个关键原则是操作没有副作用。很难低估这一点。但是，在`ForEach()`/的情况下`each()`，副作用是操作的全部目的。添加`each()`or`ForEach()`不仅超出了其他 linq 运算符的函数式编程范围，而且**与它们直接相反。**

但我知道这感觉不令人满意。它可能有助于解释为什么`ForEach()`从框架中省略，但无法解决手头的真正问题。你有一个真正的问题需要解决。为什么所有这些象牙塔哲学都会妨碍一些可能真正有用的东西？

当时在 C# 设计团队工作的 Eric Lippert 可以在这里为我们提供帮助。[他建议使用传统的`foreach`循环：](https://blogs.msdn.microsoft.com/ericlippert/2009/05/18/foreach-vs-foreach/)

> [ForEach()] 为语言添加了零新的表示能力。这样做可以让你重写这个非常清晰的代码：
> 
> `foreach(Foo foo in foos){ statement involving foo; }`
> 
> 进入这段代码：
> 
> `foos.ForEach(foo=>{ statement involving foo; });`

他的观点是，当您仔细查看语法选项时，您不会从`ForEach()`扩展与传统`foreach`循环中获得任何新的东西。我部分不同意。想象一下你有这个：

```
 foreach(var item in Some.Long(and => possibly)
                         .Complicated(set => ofLINQ)
                         .Expression(to => evaluate))
 {
     // now do something
 } 
```

此代码混淆了含义，因为它将`foreach`关键字与循环中的操作分开。它还在定义循环操作顺序的操作*之前列出循环命令。*让这些操作先出现感觉更自然，然后在查询定义的*末尾使用循环命令。*此外，代码很丑陋。似乎能够这样写会更好：

```
Some.Long(and => possibly)
   .Complicated(set => ofLINQ)
   .Expression(to => evaluate)
   .ForEach(item => 
{
    // now do something
}); 
```

然而，即使在这里，我最终还是接受了 Eric 的观点。我意识到你在上面看到的代码正在调用一个额外的变量。如果您有一组复杂的 LINQ 表达式，您可以通过首先将 LINQ 表达式的结果分配给一个新变量来将有价值的信息添加到您的代码中：

```
var queryForSomeThing = Some.Long(and => possibly)
                        .Complicated(set => ofLINQ)
                        .Expressions(to => evaluate);
foreach(var item in queryForSomeThing)
{
    // now do something
} 
```

这段代码感觉更自然。它将`foreach`关键字放回循环的其余部分旁边，并在查询定义之后。最重要的是，变量名可以添加新信息，这将有助于未来的程序员试图理解 LINQ 查询的目的。同样，我们看到所需的`ForEach()`运算符确实没有为语言增加新的表达能力。

但是，我们仍然缺少假设`ForEach()`扩展方法的两个特征：

1.  它不是可组合的。如果不创建新语句，我无法在与其余代码内联的循环之后添加进一步的`.Where()`或`GroupBy()`或。`OrderBy()``foreach`
2.  这不是懒惰。这些操作立即发生。例如，它不允许我有一个表单，其中用户选择一个操作作为大屏幕中的一个字段，直到用户按下命令按钮才起作用。这种形式可能允许用户在执行命令之前改变主意。对于 LINQ 查询，这是完全正常的（甚至*很容易*`foreach`），但对于.

（FWIW，大多数幼稚`.ForEach()`的实现也有这些问题。但是没有它们也可以制作一个。）

当然，您可以制作自己的`ForEach()`扩展方法。其他几个答案已经实现了这种方法；这并不是那么复杂。不过，我觉得没必要。从语义和操作的角度来看，已经有一种适合我们想要做的现有方法。上述两个缺失的特性都可以通过使用现有`Select()`操作来解决。

`Select()`符合上述两个示例所描述的变换或投影类型。但请记住，我仍然会避免产生副作用。调用`Select()`应该从原始对象返回新对象或投影。这有时可以通过使用匿名类型或动态对象来帮助（如果且​​仅在必要时）。如果您需要将结果保存在原始列表变量中，您可以随时调用`.ToList()`并将其分配回原始变量。我将在这里补充一点，我更喜欢`IEnumerable<T>`尽可能多地使用变量而不是更具体的类型。

```
myList = myList.Select(item => new SomeType(item.value1, item.value2 *4)).ToList(); 
```

总之：

1.  `foreach`大部分时间都坚持。
2.  当真的不行时（这可能不像你想象的那么频繁），`foreach` *使用*`Select()`
3.  当您需要使用`Select()`时，您通常仍然可以避免（程序可见的）副作用，可能通过投影到匿名类型。
4.  避免打电话的拐杖`ToList()`。您并不像您想象的那样需要它，它可能会对性能和内存使用产生重大负面影响。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-09T18:08:43.263

不幸的是，在当前版本的 LINQ 中没有内置的方法可以做到这一点。框架团队忽略了添加 .ForEach 扩展方法。现在在下面的博客上有一个很好的讨论。

[http://blogs.msdn.com/kirillosenkov/archive/2009/01/31/foreach.aspx](http://blogs.msdn.com/kirillosenkov/archive/2009/01/31/foreach.aspx)

不过添加一个相当容易。

```
public static void ForEach<T>(this IEnumerable<T> enumerable, Action<T> action) {
  foreach ( var cur in enumerable ) {
    action(cur);
  }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-09T18:08:05.717

您不能立即使用 LINQ 和 IEnumerable 执行此操作 - 您需要实现自己的扩展方法，或者使用 LINQ 将枚举转换为数组，然后调用 Array.ForEach()：

```
Array.ForEach(MyCollection.ToArray(), x => x.YourMethod()); 
```

请注意，由于值类型和结构的工作方式，如果集合是值类型并且您以这种方式修改集合的元素，它将不会影响原始集合的元素。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-09T18:13:40.023

因为 LINQ 被设计为查询功能而不是更新功能，所以您不会找到在 IEnumerable<T> 上执行方法的扩展，因为这将允许您执行方法（可能会产生副作用）。在这种情况下，你不妨坚持

> foreach(Names 中的字符串名称)
> Console.WriteLine(name);

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-10-29T08:23:40.717

使用并行 Linq：

Names.AsParallel().ForAll(name => ...)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-05-21T18:47:35.890

好吧，您也可以使用标准`foreach`关键字，只需将其格式化为 oneliner：

```
foreach(var n in Names.Where(blahblah)) DoStuff(n); 
```

抱歉，我认为这个选项值得在这里 :)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-09T18:07:55.980

List 中有一个 ForEach 方法。您可以通过调用 .ToList() 方法将 Enumerable 转换为 List，然后调用 ForEach 方法。

或者，我听说有人从 IEnumerable 中定义了自己的 ForEach 方法。这可以通过本质上调用 ForEach 方法来完成，而是将其包装在扩展方法中：

```
public static class IEnumerableExtensions
{
    public static IEnumerable<T> ForEach<T>(this IEnumerable<T> _this, Action<T> del)
    {
        List<T> list = _this.ToList();
        list.ForEach(del);
        return list;
    }
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2020-10-05T21:21:43.880

如前所述，ForEach 扩展将进行修复。

**我**对当前问题的提示是如何执行迭代器

[我确实尝试过 Select(s=> { Console.WriteLine(s); return s; })，但它没有打印任何东西。]

检查这个

_= Names.Select(s=> { Console.WriteLine(s); return 0; }).Count();

Try it!

# nhibernate - NHibernate 单向、一对多、映射问题

> ID：529193
> 
> 赞同：2
> 
> 时间：2009-02-09T18:04:40.357
> 
> 标签：nhibernate, one-to-many

我在 NHibernate 中有一个场景，其中实体 Employee 和 EmployeeStatus 之间存在一对多的关系。

Employee 具有属性，例如：ID、Name 和 EmployeeStatus 的 IList，而 EmployeeStatus 就这个问题而言，只有它自己的 ID 和一些自由文本。

我不需要从 EmployeeStatus 中保存对 Employee 的引用，状态的管理将完全通过 Employee 实体完成 - 添加到 IList 属性。IE：我想很简单地做到以下几点；

```
Employee e = new Employee();
e.Name = "Tony";
e.StatusList.Add( new EmployeeStatus("Status A") );
e.StatusList.Add( new EmployeeStatus("Status B") );
session.Save(e); 
```

我尝试了各种方法，包括创建一个单向一对多映射，其中 inverse 为假，级联设置为 all-delete-orphan，这一切看起来都应该工作，但它会生成一个关于无法设置的异常EmployeeStatus 中的 EmployeeId。我被引导相信这是因为 NHibernate 想要使用 EmployeeId 作为 NULL 进行插入，然后将其更新为父级的 ID。

我想我在这里遗漏了一些东西，所以很简单 - 谁能告诉我我的映射文件应该是什么样子才能实现上述目标？

提前致谢

托尼

-- 编辑：这是所要求的类的粗略概念 --

```
public class Employee
{
  private IList<EmployeeStatus> _statusList;

  public Employee()
  {
    _statusList = new List<EmployeeStatus>();
  }

  public virtual int Id{ get; set; }

  public virtual string Name{ get; set; }

  public virtual IList<EmployeeStatus> StatusList
  {
    get
    {
      return _statusList;
    }
  }
}

public class EmployeeStatus
{
  public virtual int Id{ get; set; }
  public virtual string StatusText{ get; set; }

  public EmployeeStatus()
  {
  }

  public EmployeeStatus(string statusText)
  {
    StatusText = statusText;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-30T16:08:45.313

您描述的场景只是一个基本的一对多映射。这是 Fluent NHibernate 映射：

```
public class EmployeeMap : ClassMap<Employee>
{
    public EmployeeMap()
    {
        WithTable("Employee");
        HasMany(employee => employee.StatusList)
        .Cascade.All();
    }
} 
```

您不需要维护从 EmployeeStatus 到 Employee 的引用来实现此目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T18:37:46.067

我可能没有解释清楚，但员工身份不能与多个员工相关联。绝对是 1（员工）对许多（状态）

在物理数据库中，状态实体有一个不在域中的employeeID 字段 - IE：我没有从状态实体对员工的引用，但应该从集合的所有者推断物理字段 - 在事实上，如果我将状态表中的 EmployeeID 字段设置为可为空，它确实会执行此操作 - 它实际上执行 2 个 SQL 语句 - 一个插入，然后是一个更新，在更新中设置了 EmployeeID。

谢谢，

托尼

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T10:59:23.670

事实证明，我想做的事情是不可能的——你必须有一个双向关联，并且必须设置孩子的父母参考。我想这不是一个大问题，但不想在我的代码中直接保存我不需要的孩子的引用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-09T18:16:41.933

你可以发布课程的代码吗？

您是否要保留员工状态的历史记录？

-- 编辑 --
看起来您将需要多对多，因为关系中的子 (EmployeeStatus) 没有对父 (Employee) 的引用。

-- 编辑 2 --
如果您希望插入作为对 DB 的 1 次调用完成，您将需要向 EmployeeStatus 类添加一个 Employee 属性，并设置 Inverse=true。而且我很确定您将需要添加一些逻辑来设置对象中的双向关系。IE

```
public void AddStatus(EmployeeStatus status)
{
    this.StatusList.Add(status);
    status.Employee = this;
} 
```

# ruby-on-rails - 为什么此控制器对创建操作的测试失败？

> ID：529195
> 
> 赞同：0
> 
> 时间：2009-02-09T18:06:58.650
> 
> 标签：ruby-on-rails, ruby

我在这里遇到了一个失败的测试，我无法理解。我正在使用带有Shouda 增强功能的Test::Unit。`users_controller.rb`我正在尝试测试中的操作...

```
def create
  unless params[:user][:email] =~ / specific regex needed for this app /i

    # ...

    render :template => 'sessions/new'
  end
end 
```

测试...

```
context 'on CREATE to :user' do
  context 'with invalid email' do
    setup { post :create, { 'user[email]' => 'abc@abcd' } }
    should_respond_with :success
  end
  # ...
end 
```

失败，因为“响应为 <:success>，但为 <302>”。302怎么样？

将操作更改为...

```
def create
  render :template => 'sessions/new'
end 
```

测试仍然失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T19:06:08.463

@Ola：你错了： POST 连接到创建。PUT 通常连接更新。

A :forbidden 虽然很奇怪。这里有一些找到问题的建议（我从未使用过Shouda，但我认为这不是Shouda的问题。

1.  确保在*config/routes.rb*中定义了路由并检查*rake 路由*
2.  您是否有任何可能导致该行为的 before_filters（登录过滤器、acts_as_authenticated 等）？结帐日志/test.log。过滤器链中的一个停止显示在那里。
3.  打印出响应正文*puts response.body*以查看您返回的内容。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-09T18:15:43.060

如果您使用默认的 REST-ful URL，您可能应该使用 PUT，而不是 POST... 由于 PUT 连接到创建，POST 到该 URL 会给您一个未经授权的重定向。

# c# - C# LINQ Where 谓词类型参数

> ID：529196
> 
> 赞同：4
> 
> 时间：2009-02-09T18:07:17.747
> 
> 标签：c#, entity-framework, lambda, expression-trees

我有一个带有模拟数据值的 XElement。

我有一个查询 xml 的表达式：

```
Expression<Func<XElement, bool>> simpleXmlFunction = 
    b => int.Parse(b.Element("FooId").Value) == 12; 
```

用于：

```
var simpleXml = xml.Elements("Foo").Where(simpleXmlFunction).First(); 
```

设计时错误是：

无法从用法中推断方法“System.Linq.Enumerable.Where(System.Collections.Generic.IEnumerable, System.Func)”的类型参数。尝试明确指定类型参数'

提供给 Where 的委托应该接受一个 XElement 并返回一个布尔值，标记该项目是否与查询匹配，我不确定如何向委托或 where 子句添加更多内容以标记类型。

此外，针对实体框架的实际功能的并行方法不存在此问题。LINQ-to-XML 版本有什么不正确的地方？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-09T18:12:07.517

不要将 simpleXmlFunction 设为 Expression<Func<XElement, bool>>。使其成为 Func<XElement, bool>。这就是 .Where 的代表所期望的。

```
Func<XElement, bool> simpleXmlFunction =
     new Func<XElement, bool>(b => int.Parse(b.Element("FooId").Value) == 12); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T22:26:04.660

我认为完整的答案包括之前的答案、David Morton 的评论和更新的代码片段：

IQueryable 的 .Where 实现不同于 IEnumerable 的 .Where 实现。IEnumerable.Where 期望：

```
Func<XElement, bool> predicate 
```

您可以通过执行以下操作从您拥有的表达式编译函数：

```
Expression<Func<XElement, bool>> simpleXmlExpression = 
    b => int.Parse(b.Element("FooId").Value) == 12; 

Func<XElement, bool> simpleXmlFunction = simpleXmlExpression.Compile();

var simpleXml = xml.Elements("Foo").Where(simpleXmlFunction).First(); 
```

这将允许您查看生成的表达式树并使用已编译的表单来查询 xml 集合。

# c# - 在 C# 中处理共享 dll 的最佳方法是什么？

> ID：529199
> 
> 赞同：10
> 
> 时间：2009-02-09T18:07:41.520
> 
> 标签：c#, visual-studio, dll

在我的团队中，我们有数百个共享 dll，其中许多还引用了其他 dll，这些 dll 本身也引用了其他 dll，依此类推。我们已经开始为所有我们认为足够通用以在其他项目中使用的 dll 使用“共享”目录，例如数据库通信 dll。

问题是，如果在树中一路向下的 dll 之一被更改，那么引用它的所有内容都需要重新编译以避免版本控制问题（在运行时发生）。

为了避免这种情况，现在有人谈论将我们所有的“共享”dll 添加到一个大程序集中，任何创建新应用程序的人都只需引用它，并且仅此而已。

这显然会变得越来越大，我不确定这是否是最好的方法。请问有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T18:44:50.463

我们所做的是将共享 DLL 的维护本身视为一个项目，具有自己的源代码控制和一切。然后大约每年两次，我们向公众“发布”共享 DLL，并带有自己的版本号和所有内容。只要您始终将 DLL 用作“集合”（意味着您引用的所有 DLL 都来自同一版本），您就可以保证没有任何依赖问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T18:13:07.217

这绝对不是最好的方法。在我的工作中，我有一些类似的“共享”DLL。它们变得笨重且难以（阅读：不可能）进行有意义的更改，因为很难确保更改不会破坏下游应用程序，这似乎与您尝试做的完全相反。

听起来您真正需要做的是将您的关注点更好地分开。如果所有这些 DLL 都相互引用，那么它们可能耦合得太紧了。一个真正的“共享”DLL 应该能够独立存在，或者作为一个包含三个或四个的分组的一部分，作为一个组进行传输。如果您的依赖项实际上阻止您进行更改，那么您的耦合策略就大错特错了。

将所有内容放在一个大型 DLL 中肯定不会让任何事情变得更好。事实上，可能恰恰相反。一旦您将所有内容都放在一个 DLL 中，就会很想将其中的所有内容更紧密地耦合在一起，这将使得以后无法将它们分开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T23:08:17.240

您可以制作**一个包含所有连接项目的解决方案**。
当您需要发布时，只需构建此解决方案

* * *

更新。
正如你所说，解决方案是不能容纳这么多的 dll。
另一方面，您可以制作外部**[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)脚本** *或*使用 **[CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/What+is+CruiseControl.NET)**，它们有可能完成如此复杂的任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-05T22:31:49.163

引用 GoF 的书，**“编程到接口，而不是实现”。**这可能适用于您的一些图书馆。你已经意识到当你有紧密耦合时你的开发变得多么脆弱。现在需要解决的是如何给你喘息的空间。

*   您可以创建一个接口。这将提供一个契约，任何应用程序都可以使用该契约来指定可用的最小功能集。

*   您可以创建一个实现接口的服务。这将允许您提供被认为是插件或插件的内容。这使您可以根据您的工具将遵守的期望来设计合同版本。

*   您可以创建仅使用接口的服务。这将允许您的应用程序发送任何符合设计合同的具体实现。

开发编辑器和 Web 浏览器等产品使用这种方法使某些代码重用成为可能。谢谢你。再会。

[设计模式中的设计原则](http://www.artima.com/lejava/articles/designprinciples.html)

[插入](https://www.martinfowler.com/eaaCatalog/plugin.html)

# svn - 组织许多小项目的颠覆存储库的最佳方式

> ID：529207
> 
> 赞同：5
> 
> 时间：2009-02-09T18:09:44.823
> 
> 标签：svn, code-organization, infrastructure, svn-organization

首先，我查看了以下页面并没有完全得到我的答案： [how-would-you-organize-a-subversion-repository-for-in-house-software-projects](https://stackoverflow.com/questions/51217/how-would-you-organize-a-subversion-repository-for-in-house-software-projects)和 [how-do-you-组织你的版本控制存储库](https://stackoverflow.com/questions/222827/how-do-you-organize-your-version-control-repository)

我还查看了[使用 Subversion 的实用版本控制](http://www.pragprog.com/titles/svn/pragmatic-version-control-using-subversion)的第 8 章。

他们都有很好的建议，但我很难将其与我的需求联系起来。

基本上，我想为我们的 Web 服务器组织代码。我们有一个 $WEBROOT/htdocs 和 $WEBROOT/cgi-bin。在我们的 htdocs 目录下，我们有 $WEBROOT/htdocs/js 和 $WEBROOT/htdocs/css 用于 java 脚本和样式表。

我们的“项目”并不是真正的项目，而是一小段代码——可能是 Perl 脚本、java 脚本文件和样式表。我们可能有大约一百个这样的小“项目”，它们几乎相互独立，但都存在于同一个网络服务器上的同一个 $WEBROOT 下。

我们的代码还没有被颠覆，但我希望它是——我只是在有效地组织它时遇到了麻烦。如果需要，我们可以有多个 svn 存储库，但是如果每个存储库只有 3-10 个元素，那对我来说似乎是一种浪费。

我认为可以工作的是这样的：如果我编写一个脚本来计算网络服务器上正在运行的进程（为了一个例子）。假设我有一个 perl 脚本、一个 js 文件和一个 css 文件。我可以将“项目”命名为 webserver_processes，并将其签入到存储库中：

```
/svnrepo/webserver_processes/trunk 
```

在树干下，我可以拥有：

```
htdocs/html/webserver_processes
htdocs/js/webserver_processes
htdocs/css/webserver_processes
cgi-bin/webserver_processes 
```

我在这个“项目”中没有任何静态 html 文档，但如果我有，它们会进入“html”目录。

我在这种结构中看到的好处是我可以一次签出一个“项目”，而不会真正影响 Web 服务器上的任何其他内容。缺点（也许它不是真正的缺点）是部署。我必须一次从存储库部署 1 个项目。我看不出如何使用这种方法用我的 $WEBROOT/htdocs 和 $WEBROOT/cgi-bin 结构创建工作副本。

**另外一个选项：**

我可以像这样创建一个 svn 存储库：

```
/svnrepo/webcode/trunk 
```

在主干下将是我的网络服务器上的所有代码，在这两个目录中：

```
htdocs
cgi-bin 
```

最大的缺点是，对于 1 个元素的小代码更改，我必须检查我的 Web 环境中的每一段代码。好处（有点）是我可以在我们的 Web 服务器上执行“svn update”来获取提交给存储库的任何更改。

也许我只是让这变得比它应该的更复杂，但是有人对我如何有效地在颠覆中组织我的代码有任何建议吗？

提前谢谢了！

布赖恩

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T18:20:09.273

我认为您通过为您的许多项目保留一个存储库来做出正确的选择，所以我只会对您的部署过程进行更改：

您的 svn repo 看起来像（您的第一个选项。）

```
/svnrepo/project1/trunk
/svnrepo/project1/trunk/htdocs
/svnrepo/project1/trunk/css
...
/svnrepo/project1/branches/branch1
/svnrepo/project1/tags/blah
/svnrepo/project2/trunk
/svnrepo/project3/trunk 
```

当您要部署时，请使用脚本将文件复制到应该部署的位置。

这样，您就可以在项目之间建立一个人为的障碍（一个文件夹）来组织您的想法，而不仅仅是一堆乱七八糟的文件。

编辑：为清楚起见，意外保存并添加了其他目录

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T18:19:58.183

我认为您最好的选择是第二种选择：将所有代码放在带有 htdocs 和 cgi-bin 目录的单个 repo 下。确实，您必须检查所有代码，但您只需检查一次，其余的更改就会小得多。如果它是生产服务器，您显然需要检查所有代码是否已准备好生产：可以这么说，保持主干绿色。

将来它也可能有助于消除重复的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T18:25:01.727

由于您还没有致力于 Subversion，请考虑使用[Bazaar](http://bazaar-vcs.org/)。它特别适合许多小型项目的版本控制，因为它的设置开销非常小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T18:45:51.617

首先，使用单个存储库。有关单个存储库可扩展性的示例，请查看[Apache svn 存储库](http://svn.apache.org/repos/asf/)。 *一切*都是一个存储库。

如果您使用直接部署到网络服务器上的单个主干，那么您需要确保主干保持部署就绪。这意味着所有开发都应该首先发生在一个重新合并的分支上。您不希望最终出现一个项目半完成但在主干中并且另一个项目需要在主干中进行错误修复部署的情况。

我不会担心要求人们检查整个后备箱，但如果这是一个真正的问题，那么您可能会考虑采用混合方法：

```
/svnrepo/trunk/project1/...
/svnrepo/trunk/project2/...
/svnrepo/deploy/htdocs
/svnrepo/deploy/cgi-bin 
```

在这种情况下，开发人员必须`svn copy`从他们的项目中的主干到部署目录中的适当位置进行操作。然后，您可以自动释放`deploy`.

# date - 如何为日历报告执行运行年份？

> ID：529208
> 
> 赞同：0
> 
> 时间：2009-02-09T18:10:07.597
> 
> 标签：date

这是我正在使用的查询：

```
SELECT * FROM ra_ProjectCalendar 
WHERE MonthNumber between @Month and @Month + 12 and FullYear = @Year 
```

它在今年很有效，但是在今年 12 月停止。如何让它显示运行年份？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T18:16:29.190

您的日期是如何存储的？

从你的 sql 中，我猜你有一个月字段，一个字段，一个字段，一个字段。我建议改为使用一个日期时间字段，然后您可以使用[DateAdd()](http://doc.ddart.net/mssql/sql70/da-db_5.htm)方法添加 12 个月（或任何其他间隔）。

编辑：有人在评论中向我指出，你从中获得的一件事是性能——这或多或少取决于你的应用程序的规模，但总是很高兴知道。如果您在存储过程中运行此查询，您将执行以下操作：

```
DECLARE @oneYearAhead datetime;
SET @oneYearAhead = DateAdd(m, 12, @PassedDate)

SELECT * FROM ra_ProjectCalendar
 WHERE @PassedDate <= [Date] AND [Date] <= @oneYearAhead; 
```

使用上面的代码，您将获得您通过日期和提前一年之间的所有条目。（我不是 100% 确定声明和设置`@oneYearAhead`变量的语法，但你明白了......）。请注意，`[]`我在列名 Date 周围使用的 允许我在列名中使用保留字 - 我已经养成了习惯，而不是记住哪些字是保留的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T18:16:34.260

试试这个：

```
SELECT * FROM ra_ProjectCalendar 
WHERE 
  (MonthNumber > @Month AND FullYear = @Year)
  OR (MonthNumber < @Month AND FullYear = @Year + 1) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T18:14:29.943

像这样的东西可能会更好 - 但不清楚你的意图是什么：

```
select * 
 from ra_ProjectCalendar 
 where DATEDIFF ( month , @startdate , @enddate ) <=12 
```

编辑：这是 SQl 服务器语法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T18:16:15.383

实际上传入并存储日期而不是月份和年份，并使用 DateDiff 与当前日期进行比较：

```
WHERE DATEDIFF(m, @PassedDate, StoredDateColumn) < 12 
```

请注意，我使用了 12 个月，而不是 1 年，因为 DATEDIFF 计算越过边界的数量。所以在 12 月，使用带有年份 datepart 的 datediff 将在一个月后返回一个。你真的想要一个12个月的跨度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T18:21:23.360

根据您的信息的存储方式（从您的查询中很难分辨），DATEADD 或 DATEDIFF 可能对您有帮助。MSDN 上有一个可用[日期函数的列表。](http://msdn.microsoft.com/en-us/library/aa337153(SQL.90).aspx)

# c# - 更改 .net 部署的应用程序的 Properties.settings

> ID：529210
> 
> 赞同：0
> 
> 时间：2009-02-09T18:10:48.360
> 
> 标签：c#, .net, c++, ipc

**大家好，**

我有两个.net应用程序，这些应用程序想互相交谈，我在第一个项目中做了如下设置

```
[CompilerGeneratedAttribute()]
[GeneratedCodeAttribute("SettingsSingleFileGenerator", "9.0.0.0")]
public sealed partial class Settings :ApplicationSettingsBase 
{

        [UserScopedSettingAttribute()]
        [DebuggerNonUserCodeAttribute()]
        [DefaultSettingValueAttribute("False")]
        public bool BeginWorking {
            get {
                return ((bool)(this["BeginWorking"]));
            }
            set {
                this["BeginWorking"] = value;
            }
        }

        [global::System.Configuration.UserScopedSettingAttribute()]
        [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [global::System.Configuration.DefaultSettingValueAttribute("False")]
        public bool Result {
            get {
                return ((bool)(this["Result"]));
            }
            set {
                this["Result"] = value;
            }
        }
        [global::System.Configuration.UserScopedSettingAttribute()]
        [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [global::System.Configuration.DefaultSettingValueAttribute("False")]
        public bool Completed{
            get {
                return ((bool)(this["Completed"]));
            }
            set {
                this["Completed"] = value;
            }
        }

} 
```

第二个项目可能会为第一个项目设置 BeginWorking 设置以告诉它工作，并等待设置 Completed 设置并从 Result 设置中获取结果。

**这可能吗？如何？**

我觉得这可能不容易回答，但请原谅我无法思考更多。

谢谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T21:03:03.767

用户级应用设置隔离在 AppData 的子目录中。一个应用程序找不到另一个应用程序的设置。只需使用普通文件即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T22:12:50.293

我没有使用它，但 .NET Remoting 可能更适合您的需求，请参阅 MSDN[链接文本](http://msdn.microsoft.com/en-us/library/xws7132e(VS.71).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T19:30:06.080

设置被持久化到保存在磁盘上的配置文件中。据我所知，默认位置是在用户的应用程序目录 ( `%appdata%`) 中。由于这个文件被持久化到磁盘上，你的其他应用程序需要能够读取和写入同一个文件。

如果两个应用程序都在读取和写入同一个文件，那么您应该能够做您想做的事情。

# eclipse - jface tableviewer 单元格跨度

> ID：529211
> 
> 赞同：2
> 
> 时间：2009-02-09T18:11:06.083
> 
> 标签：eclipse, eclipse-rcp, jface, eclipse-pde

我正在努力在 a 中呈现一些层次结构数据`TableViewer`（这`TreeViewer`不太合适 - 相信我:-)。因此，我需要渲染具有行跨度 > 1 的父单元格。

`TableViewer`据我所知，目前使用常规的 JFace或下面的 SWT是不可能的`Table`。

谁能告诉我我错了？

M。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-27T21:09:07.667

您是否尝试过星云网格[http://www.eclipse.org/nebula/widgets/grid/grid.php](http://www.eclipse.org/nebula/widgets/grid/grid.php)。

![替代文字](https://www.eclipse.org/nebula/widgets/grid/grid.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T18:36:11.310

正确的。

您可以使用以“表格模式”显示的 TreeViewer，[如此类](http://javawiki.sowas.com/doku.php?id=swt-jface:treetableviewer)所示。

[替代文本 http://javawiki.sowas.com/lib/exe/fetch.php?w=&h=&cache=cache&media=swt-jface:jface-columntree.png](http://javawiki.sowas.com/lib/exe/fetch.php?w=&h=&cache=cache&media=swt-jface:jface-columntree.png)

但是，由于 TreeViewer 不适合您，您可以从[TableTree](http://www.java2s.com/Code/Java/SWT-JFace-Eclipse/DemonstratesTableTreeTableTree.htm)的代码中获取一些想法，即使它已[在 eclipse3.3 中被弃用](https://bugs.eclipse.org/bugs/show_bug.cgi?id=130608)。

[![替代文字](https://i.stack.imgur.com/zoyUK.png)](https://i.stack.imgur.com/zoyUK.png)
[（来源：[java2s.com](http://www.java2s.com/Code/JavaImages/TableTreeTest.PNG)）]

[TableTreeViewer](http://www.koders.com/java/fidE59BDDB5C3D65FC7B6AEA62AED6EDB9CA3A466C3.aspx)和[TableTree](http://www.koders.com/java/fid51495023BFCC9412DE393517380F2B975EA1F484.aspx?s=file%3aTableTree.java)都基于一个表。

# excel - EXCEL XOR 多位

> ID：529214
> 
> 赞同：11
> 
> 时间：2009-02-09T18:12:10.870
> 
> 标签：excel, xor

好的，我有两个单元格，其中包含一串位 0111010 和 0101011。我想将两者异或，以便生成的单元格为 0010001。

我知道您可以将其用于布尔值

```
=OR(AND(A1,NOT(A2)),AND(A2,NOT(A1))) 
```

但它不适用于一串位。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-09T18:26:06.000

您需要使用 VBA 来执行此操作。如果你打开VBA，新建一个Module，进入函数

```
Public Function BITXOR(x As Long, y As Long)
    BITXOR = x Xor y
End Function 
```

然后，您可以使用 DEC2BIN 和 BIN2DEC 将二进制转换为十进制以运行此函数。例如：

单元格 A1 = 0111010

单元格 A2 = 0101011

```
=DEC2BIN(BITXOR(BIN2DEC(A1),BIN2DEC(A2))) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T18:41:18.180

您可以使用 VBA 执行此操作：

```
Public Function XOR_binary(b1, b2) As String
    Dim len_b1
    Dim len_b2
    Dim len_diff
    Dim i
    Dim bit1
    Dim bit2

    ' see if the two string are the same length. If not, add 0's to
    ' the beginning of the shorter string

    len_b1 = Len(b1)
    len_b2 = Len(b2)
    len_diff = len_b1 - len_b2

    Select Case len_diff
        Case Is < 0
            ' b2 is longer
            b1 = String(Abs(len_diff), "0") & b1
        Case Is = 0
            ' they're the same length
        Case Is > 0
            ' b1 is longer
            b2 = String(len_diff, "0") & b2
    End Select

    XOR_binary = ""

    For i = Len(b2) To 1 Step -1
        bit1 = CInt(Mid(b1, i, 1))
        bit2 = CInt(Mid(b2, i, 1))

        XOR_binary = CInt(bit1 Xor bit2) & XOR_binary
    Next i

End Function 
```

可能不是最好的实现，但它确实有效。

使用您的示例，`A3`包含：

```
=XOR_Binary(A1,A2) 
```

生成的字符串将具有与您传入的最长字符串相同的位数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-29T15:56:06.640

这是一个**不使用 VBA**的解决方案：
`=TEXT(SUMPRODUCT(MOD(INT(MID(A1,{1,2,3,4,5,6,7},1))+INT(MID(A2,{1,2,3,4,5,6,7},1)),2),{1000000,100000,10000,1000,100,10,1}),"0000000")`

`XOR`这使用`SUMPRODUCT`and计算按位`TEXT`，将其转换为一串位。

*注意：*此公式要求两个输入值的长度都为 7（根据您自己的示例），输出的长度也为 7。为了允许不同的输入长度，只需实现必要的截断和/或填充。

* * *

您可以选择使用一些速记定义：

*   定义`BitPositions`为`={1,2,3,4,5,6,7}`（7位），
*   定义`BitStrings`为`={1000000,100000,10000,1000,100,10,1}`（7位），
*   定义`BitFormat`为`="0000000"`（7位），

那么你的公式可以变得更清晰/更短/更清晰：
`=TEXT(SUMPRODUCT(MOD(INT(MID(A1,BitPositions,1))+INT(MID(A2,BitPositions,1)),2),BitStrings),BitFormat)`

这也使得处理更大的位串变得更容易，例如：

*   定义`BitPositions`为`=ROW(INDIRECT("1:32"))`（32 位），
*   定义`BitStrings`为`=10^(32-ROW(INDIRECT("1:32")))`（32 位），
*   定义`BitFormat`为`=REPT("0",32)`（32 位）

如果您希望实施`NOT`/ `OR`/ `AND`/等。那么你可以从这些[小数对应的公式中](http://www.mcgimpsey.com/excel/bitwise.html)获得灵感；尽管它也使用十进制输入，但这里有[一些更深入的解释](http://www.excelhero.com/blog/2010/01/5-and-3-is-1.html)。`XOR``SUMPRODUCT`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T18:16:42.387

每个位 =1-(A1<>0)+(A2<>0)。

您可以使用以下公式将其拆分为上述公式的单独列： =MID(A1|7|1) =MID(A1|6|1) =MID(A1|5|1) =MID(A1|4|1) =MID(A1|3|1) =MID(A1|2|1) =MID(A1|1|1) ...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-18T20:06:06.330

' 这个 VBA 返回一个必须在工作表上格式化的双精度。

```
Option Explicit
Public Function MYXOR(r1 As Range, r2 As Range) As Double
'r1 and r2 are expected as HEX; for example, 
'DEC2HEX(CODE("B")) returns ASCII of "B" as HEX
On Error GoTo ErrHandler
  MYXOR = "&H" & r1.Value Xor "&H" & r2.Value
  GoTo CleanUp
ErrHandler:
  MYXOR = Err.Number
  Resume CleanUp
CleanUp:
' format the double being returned in MYXOR with TEXT(DEC2HEX(MYXOR(C9,F9)),"00000")
' number of leading zeroes according to the size of the HEX in r1 and r2
End Function 
```

# visual-studio-2003 - 如何在 VS2003 中给 .net 1.1 dll 起一个强名称

> ID：529224
> 
> 赞同：0
> 
> 时间：2009-02-09T18:15:37.583
> 
> 标签：visual-studio-2003, strongname

我有一个 .net 1.1 dll，需要对遗留项目进行数字签名。我创建了一个 .snk 文件。我必须在 Visual Studio 中采取哪些步骤来应用签名？

**编辑**：找到这个[http://www.robrich.org/archive/2006/11/29.aspx](http://www.robrich.org/archive/2006/11/29.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T18:22:04.823

也许这些链接会有所帮助：

[强名称 WinForms 1.1](http://bytes.com/groups/net-c/638136-strong-name)

[.NET Framework 1.1 安全指南 - 强名称](http://www.guidanceshare.com/wiki/.NET_Framework_1.1_Security_Guidelines_-_Strong_Names)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T07:57:02.550

准备一个密钥文件以提供强名称 **ex: sn.exe -k test.dll test.snk

# ms-access - 如何控制访问数据库的用户权限？

> ID：529225
> 
> 赞同：7
> 
> 时间：2009-02-09T18:15:37.647
> 
> 标签：ms-access, permissions

允许一个用户对本地网络上的 MS Access 数据库进行写访问和其他所有人只读访问的最简单方法是什么？

我信任我的用户，但不幸的是，一旦取消选择表的行，Access 就会保存对数据的更改。无需用户要求保存更改即可保存意外击键。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T01:34:11.400

关于控制 Jet 数据存储的用户权限的一些想法：

1.  如果你真的想锁定，你永远不会用 Jet 来管理它，因为它本质上是易受攻击的，因为用户必须对 MDB 文件具有 WRITE 访问权限。

2.  如果您对前端应用程序中数据的控制权感到满意，您可以提供不同的前端（一种用于 WRITE 用户，一种用于 READ-ONLY）。

3.  如果您不使用 ACCDB 格式，则可以使用 Jet 用户级安全性。如果您真的想锁定对数据的访问，这是一项令人惊讶的复杂技术——您必须严格遵守 Jet 安全白皮书中的所有说明，否则您的数据将向任何拥有标准 Jet 工作组文件的人开放。即使你完成了，它*也是可以*破解的（虽然不是不花钱买破解软件）。顺便说一句，Access 2007 之前的数据库密码完全没用，而且很容易被破解。Access 2007 通过提高数据加密级别来增强安全性，但是数据库密码会导致很多问题，并且不允许您拥有多个级别的访问权限（除非您提供两个不同的前端和不同的密码——参见。 #2）。

4.  如果您只是想使用 Jet ULS 来控制前端的访问，您可以将您的用户添加到组中，然后在您的前端 UI 对象（即表单）中检查组成员身份，并授予 WRITE 权限的用户属于提供该访问级别的用户组。最简单的方法是，假设您的只读用户多于具有 WRITE 权限的用户，则让只读用户以默认管理员用户身份登录（即，您对他们的设置不做任何操作），并拥有 WRITE用户以具有 WRITE 权限的组中的用户身份登录。换句话说，如果他们没有以用户“admin”的身份登录，他们就拥有完全的 WRITE 访问权限。

5.  另一种选择是使用 NTFS 安全组。[可以在Access Web](http://mvps.org/access)上找到它的 API 代码，但它确实需要 Windows 管理员为您实施。同样，您将限制前端应用程序中的访问，而不是实际限制后端 MDB 中的用户权限。

只有 Jet ULS 实际上允许您阻止只读用户（尚未破解您的工作组文件）编辑您的数据。所有用户都必须具有对您的后端 MDB 的网络访问权限，但是您可以让他们难以获得数据，即使在实施 Jet ULS 时不费吹灰之力。以下是执行此操作的一些步骤（是的，所有这些都是“默默无闻的安全性”的一种形式，只会减慢决心破解您的后端的只读用户）：

1.  右键单击后端中的每个表并打开 HIDDEN 属性。这也可以在代码中完成（请参阅帮助中的 SetHiddenAttribute）。自然，如果最终用户将他们的访问选项设置为显示隐藏的表格，这将无济于事。但大多数最终用户并不知道这一点，如果您的用户在运行时运行您的应用程序，他们将没有选择权。

2.  将后端数据库的启动属性更改为*不*显示数据库窗口并且*不*使用特殊键。您可以在“AllowBypassKey”的帮助主题中找到设置启动属性的代码。

3.  在您的后端，使用一个命令 Quit 创建一个名为 AutoExec 的宏。禁用特殊键后，无法阻止执行此宏，并且一旦用户尝试打开后端（即使他们按住 SHIFT 键，即绕过所有启动例程的标准击键） ，数据库（和 Access 的实例）将关闭。

现在，所有这些事情都可以由知道自己在做什么的人撤消。如果你给我一个实现了这些东西的后端，我会在大约 5 分钟内完成，只需在另一个 Access 数据库中运行代码来更改所有这些启动属性以授予我访问权限。

但是您的最终用户可能不具备该级别的专业知识。任何可能应该是 WRITE 用户的此类用户，不是吗？:)

是的，当然——任何知道如何破解的人都可以轻松破解所有这些东西。但是对于拥有正确工具的人来说，在几秒钟内闯入您的房子也很容易。这并不意味着你不锁门，即使它不是防盗的防弹保护。

另一个考虑因素是，如果您只为用户提供 Access 运行时而不是完整的 Access，他们将无法撤消后端 MDB 中的任何这些设置。

最后一个：

安全性不仅仅是一个技术问题——事实上，其中大部分是一个人的问题。为了让人们做他们的工作，你必须在一定程度上信任他们，让他们访问你的数据。例如，对于不值得信任的系统管理员的问题，没有技术解决方案，而完全保护您的数据的唯一方法是根本不给他们任何访问权限。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-09T18:21:54.980

最简单的方法是使用共享权限。授予对组的写入权限，并将必须写入数据库的用户放在该组中。将其他所有人放在阅读组中。当然，这假设您有一个 Windows 域。

[这](http://www.databasedev.co.uk/access_security.html)是一个站点，其中包含有关保护 Access 数据库的一些信息。它处理 Access 2000，对于较新的版本可能有更多选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T18:20:59.477

这是厚颜无耻的答案，但如果您需要更好的安全性，请认真考虑升级到更强大的 RDBMS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T13:16:34.637

我认为可以使用 ODBC 连接将 Access 用作几乎任何数据库的接口。例如，我已经成功配置了一个 SQL Server 2008 Express Edition 数据库，其中有 2 个用户，一个读/写，一个只读。通过打开 ODBC 数据源，我已经能够从 Access 连接到数据库。因此，用户可以拥有他们熟悉的基于 Office 的报表生成和邮件合并功能。但是对于您希望的任何数据库服务器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-26T21:12:19.187

这段对话可能有点老了，但由于某些原因，我最近遇到了同样的问题。它并不适合所有人，因为它不依赖于 M$ SQL Server，而是依赖于 MySQL。使用 MySQL ODBC 连接器（可在此处获得： http: [//dev.mysql.com/downloads/connector/odbc/](http://dev.mysql.com/downloads/connector/odbc/)），并将您的表存储在 MySQL 服务器上。Access 用户对表的权限将继承自 MySQL 用户的权限。很容易定制...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T18:25:46.967

事实上，**访问数据库没有功能安全性**。

下面的链接出售可以“恢复”您的访问数据库的软件，即使它有密码。

他们存在是件好事。当他们以前的程序员去世并且没有其他人知道密码时，他们的程序曾经保存了我的一个客户的屁股。多亏了这个程序，我们无法进入，也没有数据丢失。

[http://www.stellarinfo.com/access-recovery.htm](http://www.stellarinfo.com/access-recovery.htm)

甚至在你想到之前，不，我不为他们工作。

# asp.net - ASP.NET MVC 设计

> ID：529236
> 
> 赞同：2
> 
> 时间：2009-02-09T18:18:08.110
> 
> 标签：asp.net, asp.net-mvc, linq-to-sql

正如我之前所说的，我正在研究一个 digg 克隆，以自学 ASP.NET MVC 内外，但我遇到了一个似乎无法避免的道路颠簸。

我希望能够尽可能地优化这个应用程序，所以我有我的 DAL，它是一堆...Repository : Repository 的类。现在，为了帮助优化性能，我让我的基础存储库类返回我的 ViewData 对象，这样它们就可以选择所需的额外字段，而无需创建匿名类型。

故事有创建它们的用户，用户对故事有投票。非常简单的数据库布局。现在我处理自己的成员身份，因为默认的 ASP.NET 成员身份过于臃肿。在我看来，对于故事列表，我必须确定当前用户是否对正在呈现的故事进行了投票。现在，因为我认为视图中的数据访问不应该发生，它应该在我的控制器或我的 DAL 中。由于我已经从我的 DAL 返回 ViewData，我在 StoryViewData 类型上添加了另一个名为“UserVotedOn”的属性，如果用户对该故事进行了投票，则返回 true。

问题是我必须要么 A) 让 DAL 了解成员资格，要么 B) 将用户 ID 传递到 DAL 上的查询方法中。这些对我来说都不合适，我正在寻找一些好的解决方案。欢迎任何反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T10:45:30.490

在我的 MVC 应用程序中，我使用的是 Rob Conery 在他的 MVC Storefront 视频系列中展示的架构，它对我来说就像魅力一样。

存储库 => 服务 + 过滤器 => 控制器 => 视图

我试图模拟你想要实现的目标并像这样管理 todo

**Edit1**：在存储库和过滤器中将 IList 更改为 IQueryable

存储库

```
public interface IRepository
{
    IQueryable<Vote> GetVotes();
    IQueryable<Story> GetStories();
} 
```

得到你想要的服务

```
public class Service : IService
{
    private IRepository _repository;

    public Service(IRepository repository)
    {
        _repository = repository;
        if (_repository == null) throw new InvalidOperationException("Repository cannot be null");
    }
    public IList<Vote> GetUserVotes(int userID)
    {
        return _repository.GetVotes().WithUserID(userID).ToList();
    }
    public IList<Story> GetNotVotedStories(IList<Vote> votes)
    {
        return _repository.GetStories().WithoutVotes(votes).ToList();
    }
} 
```

过滤器来过滤您的故事和用户投票（这些基本上是扩展方法）。不是最好的实现，但您可以稍后重写

```
public static class Filters
{
    public static IQueryable<Vote> WithUserID(this IQueryable <Vote> qry, int userID)
    {
        return from c in qry
               where c.UserID == userID
               select c;
    }
    public static IQueryable<Story> WithoutVotes(this IQueryable <Story> qry, IList <Vote> votes)
    {
        return  from c in qry
                where votes.Where(x => x.StoryID == c.StoryID).ToList().Count > 0
                select c;
    }
} 
```

然后你可以在控制器中传递当前的用户 ID，而不是像以前那样在 DAL 或视图中传递

```
public class HomeController : Controller
{
    private readonly IRepository _repository;
    private readonly IService _service;

    public HomeController()
    {
        _repository = new Repository();
        _service = new Service.Service(_repository);
    }

    public ActionResult Index()
    {
        var userVotes = _service.GetUserVotes(CurrentUserID);
        var unvotedStories = _service.GetNotVotedStories(userVotes);

        return View(unvotedStories);
    }
} 
```

这使您可以避免将与用户相关的 UserVotedOn 属性添加到您的 Story 模型中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T18:36:45.537

看起来你错过了 BLL。

实际上，MVC 应用程序的正确架构是许多人仍在试图弄清楚的。

我个人认为 UserID 在某种程度上是一个translayer 概念。它将出现在 DAL 和 BLL 级别上。

基本上，您的控制器方法应该只对 BLL 进行一些非常基本的调用，仅用于确定如何对用户输入做出反应，是否返回视图或其他。

您的视图应该只处理模型对象。模型可能应该由业务逻辑填充。您可以在控制器方法中调用 BL 方法来初始化模型对象，然后将其传递给视图。

控制器不应直接与数据库通信。它也不应该处理包含您的域对象和模型的低级对象。

PS 我会尽量避免大量使用 ViewData。强类型模型类是一个更好的选择。您还可以将它们分组到层次结构中以继承一些公共属性。就像您的域模型类可以派生自定义了 UserID 属性的基类一样。

# asp.net - ASP.NET 客户端回发

> ID：529238
> 
> 赞同：0
> 
> 时间：2009-02-09T18:19:34.767
> 
> 标签：asp.net, postback

我有你的基本 asp.net 网络表单，其中包含一些客户端 JavaScript，它强制页面超时，然后在 5 分钟后重定向。主要是为了保护可能的敏感信息。

在超时时，我想强制服务器回发，允许我保存表单值以供将来编辑。

我玩过 ClientScript.GetPostBackClientHyperlink() 和 ClientScript.GetPostBackEventReference()。两者似乎都对我造成了 EventValidation 问题。是的，我可以关闭事件验证，但是否有不同或更好的工作方式？

理想情况下，我不想调用控件（必须显示），而只是使用某种类型的参数进行回发，我可以将服务器端识别为超时条件的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T18:29:29.953

这可能有点矫枉过正，但您可以设置一个 javascript 计时器来触发 Web 服务调用。.NET Web 服务可以接受表单数据并将其保存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T18:54:23.700

没有很好的解决方案，所以我自己构建。一个非常简单的自定义控件。欢迎评论。

```
using System;
using System.ComponentModel;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace BinaryOcean.Web.Library.WebControls
{
    [ToolboxData("<{0}:PostBackTimer runat=\"server\" />"), DefaultProperty("Seconds"), DefaultEvent("Timeout")]
    public class PostBackTimer : Control, IPostBackEventHandler
    {
        public PostBackTimer() { }

        public string CommandArgument
        {
            get { return (string)ViewState["CommandArgument"] ?? string.Empty; }
            set { ViewState["CommandArgument"] = value; }
        }

        public string CommandName
        {
            get { return (string)ViewState["CommandName"] ?? string.Empty; }
            set { ViewState["CommandName"] = value; }
        }

        public bool Enabled
        {
            get { return (bool)(ViewState["Enabled"] ?? true); }
            set { ViewState["Enabled"] = value; }
        }

        public int Seconds
        {
            get { return (int)(ViewState["Seconds"] ?? 0); }
            set { ViewState["Seconds"] = value; }
        }

        [Description("PostBackTimer_OnTimeout")]
        public event EventHandler Timeout = delegate { };

        [Description("PostBackTimer_OnCommand")]
        public event CommandEventHandler Command = delegate { };

        public void RaisePostBackEvent(string eventArgument)
        {
            Timeout(this, EventArgs.Empty);
            Command(this, new CommandEventArgs(CommandName, CommandArgument));
        }

        protected override void OnPreRender(EventArgs e)
        {
            if (Enabled && Seconds > 0)
            {
                var postback = Page.ClientScript.GetPostBackEventReference(this, null);
                var script = string.Format("setTimeout(\"{0}\",{1});", postback, Seconds * 1000);
                Page.ClientScript.RegisterStartupScript(GetType(), "PostBackTimer_" + UniqueID, script, true);
            }

            base.OnPreRender(e);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T18:30:51.307

您不能使用 javascript 计时器来“单击”提交按钮吗？听起来使用这个表格真的很烦人，如果它在你试图填写它的时候一直发回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T19:01:12.407

使用 javascript，调用`__doPostBack("clientIdOfSubmitButton", null)`. 这将触发回发，就像该按钮（或您想要的任何其他控件）已触发它一样。

# class - python 3 中的 types.ClassType 发生了什么？

> ID：529240
> 
> 赞同：16
> 
> 时间：2009-02-09T18:19:54.750
> 
> 标签：class, types, python-3.x

我有一个脚本，我在其中做一些神奇的事情来动态加载模块，并实例化模块中找到的第一个类。但是我不能`types.ClassType`在 Python 3 中使用了。现在正确的方法是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-09T18:38:20.183

我想到了。似乎类的类型是“类型”。这是一个如何在运行时区分类和其他对象的示例。

```
>>> class C: pass
... 
>>> type(C)
<class 'type'>
>>> isinstance(C, type)
True
>>> isinstance('string', type)
False 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-09T18:30:35.100

它被用于[经典课程](http://docs.python.org/release/2.5.2/ref/node33.html)。在 Python 3 中，它们消失了。我想你可以使用类似的东西：

```
issubclass(ClassName, object) 
```

# apache-flex - Flex 3 中组件的推荐前缀命名约定是什么？

> ID：529245
> 
> 赞同：4
> 
> 时间：2009-02-09T18:21:12.203
> 
> 标签：apache-flex, flex3, naming-conventions

我正在寻找一种标准方法来命名我的 Flex 应用程序中的组件。例如，所有TextField 在其ID 属性中都以“txt”开头（即“txtFirstName”）。有没有人熟悉我可以使用的前缀命名约定列表，而不是重新发明轮子？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T18:28:20.893

Adobe 不推荐使用前缀约定，因为它们在组件实例名称中使用组件的全名。

例如：usernameTextInput、userComboBox 等。

> 如果要将类型合并到名称中，请将其作为最后一个“单词”。不要使用连接缩写类型后缀（例如 _mc）的旧 ActionScript 1 约定来指示类型。例如，将边框形状命名为border、borderSkin 或borderShape，而不是border_mc。

更多信息： http: [//opensource.adobe.com/wiki/display/flexsdk/Coding+Conventions#CodingConventions-Naming](http://opensource.adobe.com/wiki/display/flexsdk/Coding+Conventions#CodingConventions-Naming)

如果你真的想使用前缀，你可能想使用 VB 前缀：[http ://www.rwc.uc.edu/cook/VBI_PREFIXES.HTM](http://www.rwc.uc.edu/cook/VBI_PREFIXES.HTM)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T18:24:23.523

查看 Adob​​e 的[Flex 编码约定](http://opensource.adobe.com/wiki/display/flexsdk/Coding+Conventions)文档。你看到的大多数弹性代码都非常符合这个编码标准。

# c# - C# 函数意识？

> ID：529249
> 
> 赞同：4
> 
> 时间：2009-02-09T18:22:14.653
> 
> 标签：c#, multithreading, function

在多线程应用程序中。有没有办法以编程方式让线程 B 检查 thead-A 当前所在的函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T18:25:46.297

您可以通过执行以下操作获取另一个线程的堆栈跟踪：

```
System.Diagnostics.StackTrace stackTrace = new System.Diagnostics.StackTrace(myThread); 
```

从这里你可以得到调用堆栈，以及它当前正在执行的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T07:41:08.967

这是应该内置到应用程序本身的东西，以避免线程之间可能的争用。

在我看来，一个线程不应该控制另一个线程的执行（例如，挂起/恢复），除了启动它。他们应该只建议其他线程控制*自己*（例如，使用互斥锁和事件）。这极大地简化了线程管理并减少了竞争条件的可能性。

如果您真的希望线程 B 知道线程 A 当前正在做什么，那么线程 A 应该将其传达给线程 B（或任何其他线程，例如下面的主线程），例如，使用带有函数的受互斥保护的字符串里面的名字。类似于（伪代码）的东西：

```
global string threadAFunc = ""
global mutex mutexA
global boolean stopA

function main:
    stopA = false
    init mutexA
    start threadA
    do until 20 minutes have passed:
        claim mutexA
        print "Thread A currently in " + threadAFunc
        release mutexA
    stopA = true
    join threadA
    return 
```

```
function threadA:
    string oldThreadAFunc = threadAFunc
    claim mutexA
    threadAFunc = "threadA"
    release mutexA

    while not stopA:
        threadASub

    claim mutexA
    threadAFunc = oldThreadAFunc
    release mutexA
    return

function threadASub:
    string oldThreadAFunc = threadAFunc
    claim mutexA
    threadAFunc = "threadASub"
    release mutexA

    // Do something here.

    claim mutexA
    threadAFunc = oldThreadAFunc
    release mutexA
    return 
```

此方法可用于*任何*支持线程的语言或环境，而不仅仅是 .Net 或 C#。线程 A 中的每个函数都有 prolog 和 epilog 代码来保存、设置和恢复其他线程中使用的值。

# memory - 如何在 MPLAB 中增加内存块的大小？

> ID：529252
> 
> 赞同：3
> 
> 时间：2009-02-09T18:22:41.220
> 
> 标签：memory, embedded, pic, microchip

Microchip PIC MPLAB (MCC18) 编译器将其内存分段为 256 个块 (0x100)。

如何创建大于 256 字节的数组？

```
char buffer[256]; 
```

为了达到 256，我需要用一个单独的段`#pragma`

```
#pragma udata segment_name
char buffer[256];
#pragma udata 
```

所以我可以强制 MCC18 分配更大的缓冲区吗？还是结合两个内存段？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T19:30:28.327

粘贴答案来自：

[http://forum.microchip.com/printable.aspx?m=39357](http://forum.microchip.com/printable.aspx?m=39357)

以防万一它消失。

> 在三个简单的步骤中第 1 步：将变量分配到源代码中的命名部分：
> 
> ```
> #pragma udata big_scn
> char big_array[0x180];
> #pragma udata 
> ```
> 
> 第 2 步：在链接描述文件中创建更大的区域： 之前：
> 
> ```
> DATABANK NAME=gpr3 START=0x300 END=0x3FF
> DATABANK NAME=gpr4 START=0x400 END=0x4FF 
> ```
> 
> 后：
> 
> ```
> DATABANK NAME=big_scn START=0x300 END=0x47F PROTECTED
> DATABANK NAME=gpr4    START=0x480 END=0x4FF
> SECTION  NAME=big_scn RAM=big_scn 
> ```
> 
> 第 3 步：仅通过指针引用：
> 
> ```
> char *big_array_ptr = &big_array[0];
> big_array_ptr[0x100] = 5;
> while( big_array_ptr[x] != 20 ) 
> ```

注意：我相信您仍然可以直接引用数组而不是使用指针。似乎对我有用。

可以在以下文档中找到相同的信息：

[MPLAB C18 C 编译器入门指南](http://ww1.microchip.com/downloads/en/DeviceDoc/MPLAB_C18_Getting_Started_51295f.pdf)

第 104 页。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T18:43:05.117

也许有更多知识的人会证明我错了，但我认为不可能做你想做的事。如果您的设备中的内存被划分为 256 字节的段，那么您不能有一个跨越它们的数组，AFAIK。如果你这样做了，它就必须跳过各种各样的循环才能让你将数组视为连续内存——它必须检查你用来确定它应该在哪个段中的每个索引，然后计算偏移量并访问它，或者如果您使用指针算法访问数组，它必须弄清楚您要访问的内容，这在编译时可能是不明显的甚至是未知的。我不认为它有一个单一的内存模型可以在所有情况下使用，因为一些内存位置在银行之间是通用的（我认为程序计数器就是这样一个位置），等等。我主要是从对典型 PIC 架构的了解和使用第三方 C 编译器的一些经验说的。我对 MPLAB 本身没有太多经验，所以我的回答持保留态度。

您可以通过分配一个指针数组然后将每个指针初始化为您想要存储在其中的任何数据类型的新实例来绕过限制（我假设一个结构或比指针更大的东西） ，因为这不需要内存是连续的。但是，PIC 上的动态内存分配很昂贵，因此这对您来说可能不是一个好选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-28T18:26:52.020

我有类似的问题！我打算使用这种方法： http: [//www.hobbytronics.co.uk/c18-large-data-arrays](http://www.hobbytronics.co.uk/c18-large-data-arrays)
但是当我添加链接器而不对项目进行任何更改并编译我得到的项目时此错误
// $Id: 18f2550.lkr,v 1.3 2005/03/24 04:17:19 craigfranklin Exp $
// 文件：18f2550.lkr
// PIC18F2550 处理器的链接描述文件示例

```
 LIBPATH .

    //CODEPAGE   NAME=vectors    START=0x0            END=0x29           PROTECTED
    CODEPAGE   NAME=page       START=0x0            END=0x6FFB
    CODEPAGE   NAME=boot       START=0x6FFC         END=0x7FFF         PROTECTED
    CODEPAGE   NAME=idlocs     START=0x200000       END=0x200007       PROTECTED
    CODEPAGE   NAME=config     START=0x300000       END=0x30000D       PROTECTED
    CODEPAGE   NAME=devid      START=0x3FFFFE       END=0x3FFFFF       PROTECTED
    CODEPAGE   NAME=eedata     START=0xF00000       END=0xF000FF       PROTECTED

    ACCESSBANK NAME=accessram  START=0x0            END=0x5F
    DATABANK   NAME=gpr0       START=0x60           END=0xFF
    DATABANK   NAME=gpr1       START=0x100          END=0x1FF
    DATABANK   NAME=gpr2       START=0x200          END=0x2FF
    DATABANK   NAME=gpr3       START=0x300          END=0x3FF
    DATABANK   NAME=usb4       START=0x400          END=0x4FF          PROTECTED
    DATABANK   NAME=usb5       START=0x500          END=0x5FF          PROTECTED
    DATABANK   NAME=usb6       START=0x600          END=0x6FF          PROTECTED
    DATABANK   NAME=usb7       START=0x700          END=0x7FF          PROTECTED
    ACCESSBANK NAME=accesssfr  START=0xF60          END=0xFFF          PROTECTED

    SECTION    NAME=CONFIG     ROM=config
    SECTION    NAME=bank1      RAM=gpr1
    SECTION    NAME=usbram4    RAM=usb4
    SECTION    NAME=usbram5    RAM=usb5
    SECTION    NAME=eeprom     ROM=eedata 
```

错误：
18f2550.lkr:5：警告：（374）缺少基本类型；int 假定为 18f2550.lkr:5：错误：（314）“；” 期待
why？一切都是真的！
我正在使用 mplabx v 2.0 和 Mplab xc8 v 1.31

# asp.net - 如何通过asp更改windows密码？

> ID：529253
> 
> 赞同：3
> 
> 时间：2009-02-09T18:22:44.963
> 
> 标签：asp.net, iis, authentication, windows-authentication

我有一个使用集成 Windows 身份验证来验证用户的 Web 应用程序。他们中的大多数都是远程的，无法访问工作站来更新他们的 AD 密码。

我不想自己手动管理密码，而是想编写一个脚本，以便他们自己更改密码。

我将如何通过 ASP 更新他们的 windows 密码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T18:31:29.233

System.DirectoryServices 命名空间中有一个似乎能够处理此问题的函数。您需要添加对它的引用才能使用它。

这是有关如何更改用户密码的文章：http: [//msdn.microsoft.com/en-us/library/ms817839.aspx](http://msdn.microsoft.com/en-us/library/ms817839.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T19:01:57.567

如果您要在网站上提供此功能，则应考虑安全隐患。自助式密码更改网站通常被认为存在重大安全风险，并不常见。

您提到您的用户是远程的。如果站点是公开的，他们将如何通过集成身份验证进行身份验证？我知道使这成为可能的唯一方法是通过 VPN。否则，他们将不得不使用基本身份验证来输入他们的用户名和密码。这是非常不安全的，即使在 SSL 上也是如此。

以下是一些建议：

*   使用客户端证书保护站点。如果这不可能，请至少使用 SSL。
*   我强烈建议您在安全的 Web 服务中实现实际的密码更改逻辑。ASP.NET 页面应调用 Web 服务来请求更改。
*   您应该存储密码更改的审计跟踪。不要存储密码，只存储用户、时间和 IP 地址的事件日志。
*   进行非常彻底的测试，以确保集成安全能够正确识别您的用户。确保用户不会意外更改其他用户的密码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T10:25:58.940

[http://support.microsoft.com/kb/555071](http://support.microsoft.com/kb/555071)

如果您可以像这样设置 IISADMPWD，您应该可以更改密码。这实际上是一个依赖于 COM 组件的 ASP 应用程序。

请注意，IISADMPWD 已过时且不随 IIS 7.0 提供。

# sql-server - SQL Server 中的表“继承”

> ID：529256
> 
> 赞同：13
> 
> 时间：2009-02-09T18:23:26.490
> 
> 标签：sql-server, database-design

我目前正在考虑重组我们的联系人管理数据库，我想听听人们对解决许多联系人类型具有共享属性的问题的意见。

基本上我们有 6 种联系方式，包括人员、公司和职位@公司。

在当前结构中，所有这些都有一个地址，但是在地址表中您必须存储它们的类型才能加入联系人。

一段时间后，这种加入联系人类型的一致要求令人沮丧。

今天我偶然发现了一篇讨论“表继承”的帖子（[http://www.sqlteam.com/article/implementing-table-inheritance-in-sql-server](http://www.sqlteam.com/article/implementing-table-inheritance-in-sql-server)）。

基本上你有一个父表和许多子表（在这种情况下是每个联系人类型）。从那里您可以强制执行完整性，以便子表必须具有定义其类型的主等效项。

在我看来，通过这种方法，我不再需要将类型存储在地址等表中，因为 id 在所有类型中都是唯一的。

我只是想知道是否有人对这种方法有任何感觉，这是否是一种好方法，或者可能是替代方法？

我正在使用 SQL Server 05 和 08 应该有什么不同。

谢谢

埃德

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T09:34:25.457

我设计了一个数据库，就像您提供的链接所暗示的那样。案例是为许多不同的技术报告存储数据。报告类型的数量未定义，可能会增长到大约 40 种不同的类型。

我创建了一个具有自动增量主键的主报告表。该表包含所有常见信息，如客户、测试站点、设备 ID、日期等。

然后，我为每种报告类型都有一个表格，其中包含与该报告类型相关的特定信息。该表与主表具有相同的主键，并且也引用了主表。

我将其拆分为具有 1:1 关系的不同表（通常是禁止的）的想法是避免获得一个包含大量列的单个表，这在您不断添加列时变得非常难以维护。

我的表继承设计为我提供了分段数据和可扩展性，而不会难以维护。我唯一要做的就是编写一个特殊的特殊保存方法来自动处理对两个表的写入。到目前为止，我对设计非常满意，并没有真正发现任何缺点，除了更复杂的保存方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T10:54:45.570

谷歌关于“gen-spec 关系建模”。您会发现很多文章都在讨论这种模式。其中一些专注于表格设计，而另一些则专注于面向对象的方法。

表继承在其中一些中弹出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T19:00:13.827

我将在这里冒险并建议您重新考虑您的规范化策略（因为您似乎很幸运能够从根本上重新考虑您的模式）。如果您通常为每个联系人存储一个地址，那么您的联系人表中应该包含地址字段。或者，如果地址是按公司存储的，则地址应存储在公司表中，并且您的联系人链接到该公司。

如果您的联系人只有一个地址，或者其他字段的一个（甚至 3 个，只是不是“很多”）实例，请考虑将它们合理化到一个表中。根据我的经验，拥有一些空字段比需要左连接到您不确定是否存在的数据要好得多。

幸运的是，对于任何强烈反对我的人，你确实征求了意见！:) 恕我直言，您应该仅在*真正*需要时进行标准化。在您重新考虑模式的地方，应抓住每一个机会考虑非规范化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T18:27:58.927

您仍然会遇到问题，如果您想要子类型字段并且您只有主联系人，您将必须知道要查看哪个表 - 或者加入所有这些表。但除此之外，这是一个常见问题的可行解决方案。

另一种可能性（结构上非常相似，但您的想法不同）是将所有联系人简单地放在一个表中。然后对于更具体的字段（`birthday`例如人员和`department`position@company）创建与该联系人关联的单独表。

```
    联系表
    --------------
    姓名
    电话号码

    地址表
    -------------
    街道/州等
    联系人 ID

    联系人生日表
    --------------
    生日
    联系人 ID

    部门表
    -----------------
    部门
    联系人 ID

```

但是，它需要一种不同的思维方式——而不是考虑人与公司，而是考虑手头任务的各种功能需求——如果你想发送生日贺卡，请获取所有与生日相关的联系人与他们等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T18:31:19.340

我知道这现在不会有太大帮助，但最初最好有一个实体表而不是 6 个不同的联系人类型。然后每个实体可以有尽可能多的地址，并且不需要在连接中输入。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T22:23:36.953

我将尝试这种方法。是的，当你有一个新类型时，你必须创建新表，但是由于这个表可能会有不同的列，如果你不使用这个方案，你最终还是会这样做。

如果继承主表的表彼此之间没有太大区别，我建议您尝试另一种方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T02:44:55.770

当您有第 7 种类型时，您必须创建另一个表。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-04-30T00:51:56.060

我可以建议我们只添加一个类型表。即一个人有一个地址、姓名等，然后学生、教师作为每个用例呈现它自己我们有一个 PersonType 表，其中包含从人员表到 n 种类型的条目，以及随后的新表教师、外星人、歌手作为系统进化...

# database - 数据库视图会影响查询性能吗？

> ID：529259
> 
> 赞同：24
> 
> 时间：2009-02-09T18:24:02.870
> 
> 标签：database, performance, views

数据库视图只是一种简化数据访问的方法，还是在访问视图时提供性能优势，而不是仅仅运行视图所基于的查询？我怀疑视图在功能上等同于将存储的视图查询添加到视图数据的每个查询中，这是正确的还是发生了其他细节和/或优化？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T18:51:28.123

尽管在视图内运行的特定查询和在视图外运行的相同查询应该执行相同的操作，但是当您需要将两个视图连接在一起时，事情会变得更加复杂。您可以轻松地将不需要的表带入查询中，或者冗余地引入表。数据库的优化器在创建良好的查询执行计划时可能会遇到更多麻烦。因此，虽然视图在允许更细粒度的安全性等方面可能非常好，但它们不一定有利于模块化。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-09T18:34:24.543

我一直认为视图就像一个只读的存储过程。您可以提前为数据库提供尽可能多的信息，以便它可以尽可能地进行预编译。

您还可以索引视图，从而允许您访问针对您正在运行的查询类型所追求的数据的优化视图。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-09T18:28:36.197

它取决于 RDBMS，但通常不会进行优化，这只是简化查询的一种便捷方式。然而，一些数据库系统使用“物化视图”，它们确实使用了缓存机制。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-09T18:33:40.677

通常，视图只是为定义您经常需要的结果集创建通用速记的一种方式。

但是，有一个缺点。诱惑是添加您认为可能需要的每一列，有时您可能希望使用该视图。所以 YAGNI 被违反了。不仅是列，有时还会在“以防万一”上添加额外的外部连接。因此覆盖索引可能不再覆盖，并且查询计划可能会增加复杂性（并降低效率）。

YAGNI 是 SQL 设计中的一个关键概念。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-09T18:38:11.867

一般来说，视图应该与直接在基础表上编写的查询等效。

但是：可能存在边缘情况，您应该测试您的代码。所有现代 RDBMS 系统都有可以让您查看查询计划和监控执行的工具。不要相信我（或任何其他人）的话，因为您可以随时获得明确的数据。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-04-03T04:46:20.397

我知道这是一个旧线程。讨论很好，但我确实想再考虑一下。性能还取决于您使用什么来提取数据。例如，如果您使用 Microsoft Access 之类的东西进行前端处理，那么您肯定可以通过使用视图来获得一些复杂查询的性能。这是因为 Access 并不总是像我们希望的那样从 SQL 服务器中拉取——在某些情况下，它会拉取整个表，然后尝试从那里进行本地处理！如果您使用视图，则不是这样。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-07-17T14:30:33.713

是的，在所有现代 RDBMS（2005 年之后的 MSSQL？等）中，视图的查询计划都被缓存，从而消除了规划查询的开销并提高了在线执行相同 SQL 的性能。在此之前（它也适用于参数化 SQL/Prepared 语句）人们正确地认为存储过程执行得更好。

许多人今天仍然坚持这一点，使其成为现代 DB 神话。自从 Views/PS 获得了 SP 的缓存查询计划以来，它们几乎是平衡的。

# java - Spring 和 Hibernate 的 Java 截屏视频

> ID：529262
> 
> 赞同：4
> 
> 时间：2009-02-09T18:24:40.183
> 
> 标签：java

我是一个对学习 OOP 和 Java 感兴趣的 SQL 人，但我阅读或遇到的大多数书籍都没有涉及数据库。

是否有任何可用的截屏视频可以直接教我 Spring 框架和 Hibernate 框架，而无需深入了解 Java？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-09T18:59:45.437

我认为在不熟悉 Java 的情况下尝试使用 Spring 或 Hibernate 是不可取的。

我能想到的最好的建议是[Spring MVC 一步一步的例子](http://static.springframework.org/docs/Spring-MVC-step-by-step/)。它不使用 Hibernate，但确实使用 JDBC 访问数据库。一旦你有信心，让它工作并修改它以使用 Hibernate。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-02-19T15:15:31.217

有非常有价值的 Hibernate 截屏视频，大约第 18 个视频：[http](http://www.youtube.com/user/patrickwashingtondc) ://www.youtube.com/user/patrickwashingtondc 这是一个很好的起点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T19:19:59.443

有些人可能喜欢也可能不喜欢这个建议，但由于 C# 和 Java 以及 Hibernate 和 NHibernate 之间的相似性，我可能会推荐 Stephen Bohlen 的优秀截屏系列 Summer of NHibernate。

[http://www.summerofnhibernate.com/](http://www.summerofnhibernate.com/)

# c# - 导入 Json 字符串

> ID：529265
> 
> 赞同：1
> 
> 时间：2009-02-09T18:25:45.313
> 
> 标签：c#, asp.net, json

我正在尝试使用以下方法导入 Json 字符串：

```
AreaField areaField = new AreaField();
areaField = (AreaField) JsonConvert.Import(typeof(AreaField), HdnData.Value); 
```

类定义如下：

```
public class AreaField 
{
    public List<AreaFieldItem> AreaFieldItem { get; set; }
}

public class AreaFieldItem 
{
    public string Name { get; set; }
    public bool Required { get; set; }
} 
```

我得到错误：

无法从 JSON 数组值导入 System.Collections.Generic.List`1[FieldItem]。

我猜 Import 的本机实现不处理列表？我自己反序列化了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T11:41:55.020

我不认为 Jayrock 支持通用列表。尝试改用 AreaFieldItem 数组：

```
public class AreaField
{
  public AreaFieldItem[] AreaFieldItem { set; get; }
} 
```

# ms-word - VSTO：更改现有的 Word 功能区选项卡

> ID：529276
> 
> 赞同：2
> 
> 时间：2009-02-09T18:28:34.667
> 
> 标签：ms-word, vsto, ribbon

使用 Visual Studio 2008 Pro，是否可以对现有的 Word 功能区项目进行更改？例如，我可以在“邮件”选项卡的“完成”组中添加一个额外的邮件合并选项吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-14T14:15:28.730

据我所知，您只能将组添加到内置选项卡中，而不能将控件添加到内置组中。如果要将组添加到内置选项卡：

可视化设计器：将选项卡的 ControlTypeId 设置为 Office，将 ControlId 设置为 TabMailings，然后您可以像在邮件选项卡一样向其中添加项目

功能区 XML：做这样的事情

```
<tabs>
   <tab idMso="TabMailings">
      <group id="MyGroup" label="My Group">
      </group>
   </tab>
</tabs> 
```

# external - 向外部程序添加 GUI 控件

> ID：529282
> 
> 赞同：-2
> 
> 时间：2009-02-09T18:29:27.380
> 
> 标签：external

是否可以向外部程序添加按钮或菜单项？例如，向记事本本身添加一个菜单项，该菜单项将显示一个消息框（单击它之后），其中包含记事本中的当前文本。如果是，是否有提供更多详细信息的网址？

期待您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T18:36:31.200

可以通过创建控件（通过 Windows API 或其他方式）然后将目标窗口的 HWND 分配为新控件的父级。作为参考，请查看 MSDN 上的 SetParent Win32 API 函数。

不确定这将如何与菜单一起使用，但这是将控件添加到窗口的正常方法。不过要小心。有很多陷阱（目标应用程序采用的命令、内存考虑等）。

# c++ - C/C++ AQtime 分析器问题

> ID：529284
> 
> 赞同：2
> 
> 时间：2009-02-09T18:29:32.480
> 
> 标签：c++, profiling, aqtime

我需要使用 AQ 分析我的控制台程序。它在一个大文件中（出于优化目的）。

```
void function1();
void function2()
// etc more declarations
int main{

    //alot of loops, and function uses
    function1();
    function1();
} 
```

对“已用时间”默认配置文件进行分析只是让我知道 main 正在使用 100% 并且需要 40 秒才能完成它的工作。没有关于在 main 中调用的函数花费了多少时间，只有调用了多少次，这什么也没说。

我在配置 AQtime 时是否遗漏了一些东西，因为我找不到它？想知道函数花了多少时间来完成它的工作..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T18:47:25.933

AQtime 只会分析您告诉它分析的例程。它的启动向导在帮助您正确配置方面非常有用；我建议非常小心地注意它，但一般程序是：

1.  创建一个区域。配置该区域以进行线路或例行分析。
2.  将源文件添加到该区域。在这种情况下，只有您的一个文件。
3.  现在简介。

一般规则是，如果您不告诉 AQtime 检测例程，它将不会被检测。应用程序中的所有代码都有一个默认区域，但它仅用于例程分析，而不是行分析。

# asp.net - 返回 null 时如何检索 HttpContext 属性？

> ID：529286
> 
> 赞同：22
> 
> 时间：2009-02-09T18:30:10.857
> 
> 标签：asp.net, httpcontext

我正在使用以下方法在单独的线程上进行一些异步工作：

```
ThreadPool.QueueUserWorkItem() 
```

在这个单独的线程中，我需要调用`HttpContext.Current`以便可以访问：

```
HttpContext.Current.Cache  
HttpContext.Current.Server  
HttpContext.Current.Request 
```

但是，`HttpContext.Current`当我创建这个单独的线程时为空。

### 问题

如何创建一个`HttpContext.Current`不为空的新线程？还是有其他方法可以访问 Cache、Server 和 Request 对象？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-09T18:37:37.470

即使没有 HttpContext，您也可以使用**HttpRuntime.Cache**访问 ASP.NET 缓存，但遗憾的是您无法访问 Server 或 Request。

如果您考虑一下，这是有道理的 - 您没有提供任何页面，因此您没有请求。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-09T18:50:46.237

我会尽量不保留对依赖于 ASP.NET 堆栈（如 HttpContext）的对象的引用。如果您需要在不同的线程中做一些工作，那是因为您不想在 ASP.NET 中等待任务完成。也许请求/上下文/会话被终止，而你的线程没有。

您应该传递一个包含线程所需数据的对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-11T08:26:49.137

`<system.serviceModel>`1-在 Web.config 文件中添加底部代码：

```
<serviceHostingEnvironment aspNetCompatibilityEnabled="true" /> 
```

2- 在 Web 服务文件中的 NameSpace 之后添加底部代码：

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)] 
```

3- 重建 Web 部件项目。完毕！

[参考](http://forums.silverlight.net/t/97983.aspx/1)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T00:11:03.033

对于 HttpContext.Server 服务，您可以使用 HttpServerUtility 类。对于缓存，您可以使用 HttpRuntime.Cache，正如上面所说。对于请求对象，您可以在创建请求时将数据从请求传递到线程。诸如 Request.QueryString 或 Request.Form... 之类的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-21T13:33:54.537

[这里](http://www.bearcanyon.com/dotnet/#threadpool)有一个线程池实现，提供调用线程的 HTTP 上下文的传播。我还没用过，但我打算用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T18:41:42.000

如果单独的线程试图访问这些对象，那么是的，它们将为空。这些对象的范围是线程级别的。如果您想在新线程中使用它们，您必须将它们传递到您需要它们的方法/类中。

通常 ASP.Net 不允许您生成新线程...这是有关该主题的[帖子](http://csharpfeeds.com/post/5415/Dont_use_the_ThreadPool_in_ASP.NET.aspx)。

[这是一篇来自 MSDN 的关于 ASP.NET](http://msdn.microsoft.com/en-us/magazine/cc164128.aspx)中的线程的很好的文章。

# excel - 在 Excel 中打开包含特殊字符的 .csv 文件

> ID：529287
> 
> 赞同：6
> 
> 时间：2009-02-09T18:30:17.300
> 
> 标签：excel, text

我有一个导出 .csv 文件的系统，其中一些行包含特殊的框字符，因此数据如下所示：

```
Please specify the primary type of opportunity which you’re proposing:
└─ Please specify what type of sport:
└─ What is this person’s vocation?
└── How long have they been in the industry? 
```

但是，当我在 excel 中打开文件时，Excel 会扭曲框字符，使其最终看起来像这样：

```
Please specify the primary type of opportunity which youâ€™re proposing:    
â””â”€ Please specify what type of sport:   
â””â”€ What is this personâ€™s vocation?    
â””â”€â”€ How long have they been in the industry? 
```

该文件正在以纯文本格式保存到用户的硬盘驱动器中，我可以在文本编辑器中打开它并查看字符是否正常，因此我知道 Excel 读取数据时会发生这种情况。

有什么想法吗？我怎样才能防止这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-08-30T13:29:18.123

In a PHP generated CSV I solved it with utf8_decode() for the concerning columns.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T06:26:15.097

导入您的 csv 文件，如下面的 Excel 2007 中的链接所示。选择适当的编码，结果将显示预期的数据，包括特殊字符。 [http://www.howtogeek.com/howto/microsoft-office/import-text-into-excel-2007/](http://www.howtogeek.com/howto/microsoft-office/import-text-into-excel-2007/)

问候， 库尔迪普·拉索德

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T18:35:59.830

excel 可能试图使用错误的编码打开文件；尝试从 Excel 中打开文件，并选择不同的文件编码；这些可能是 Unicode 字符，而 Excel 可能正在使用 iso-8859-15 导入。

如果可能，请选择 UTF

高温高压

# java - 开源 java XSLT 2.0 实现？

> ID：529309
> 
> 赞同：21
> 
> 时间：2009-02-09T18:37:39.543
> 
> 标签：java, xml, open-source, xslt-2.0, xslt

我目前正在研究使用 XSLT 2.0，但我找不到任何开源 Java 实现（[Saxon-B](http://en.wikipedia.org/wiki/Saxon_XSLT)似乎符合要求，但不支持模式）。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-07-14T15:36:42.833

是的，我正在回答我 2.5 年前的问题：

我还没有尝试过，但我只是偶然发现了[Eclipse PsychoPath](http://help.eclipse.org/helios/index.jsp?topic=/org.eclipse.wst.xml.xpath2.processor.doc.user/html/index.html)，它（根据文档）是一个 XPath 2.0 XML Schema Aware 处理器，它通过了 96% 的 XPath 2.0 测试套件（版本 1.1M1）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-10T01:44:04.420

唯一的一个是 Saxon-HE：

[撒克逊-HE](http://sourceforge.net/projects/saxon/files/Saxon-HE/)

W3C 托管它的在线版本进行测试：

[W3C Jigsaw XSLT 2.0 服务](http://www.w3.org/2005/08/online_xslt/)

还有类似 JSFiddle 的版本：

[xsltransform.net](http://xsltransform.net/)

Frameless 项目托管了它的 JavaScript 版本：

[XSLT 小提琴](http://fiddle.frameless.io/)

还有一个使用它的 App Engine 项目：

[XSLT App Engine 测试工具](https://xslttest.appspot.com/)

除此之外，还有一个不完整的 Xerces 扩展，它实现了 XPath 2.0：

[Xerces XPath 2.0 扩展](http://sourceforge.net/projects/xsltproc/)

一个实现 XPath 2.0 的 Eclipse 扩展：

[WTP XPath2.0 处理器](http://wiki.eclipse.org/PsychoPathXPathProcessor)

部分实现 XSLT 2.0 的不完整 Xalan-J 分支：

> 在 Xalan-J Interpretive 处理器中支持 XSLT 2.0 的一些原型工作在 2003 年继续进行，但随后就落后了。该原型工作仍可在 xslt20 分支 [http://svn.apache.org/repos/asf/xalan/java/branches/xslt20/](http://svn.apache.org/repos/asf/xalan/java/branches/xslt20/)上获得，但从那时起，nobdy 就开始着手进行最初的原型设计，而 Xalan PMC 尚未制定任何支持 XSLT 2.0 的计划。

以及可以在[Nashorn/Avatar.js上运行的](https://avatar-js.java.net/)[Saxon-CE](http://www.saxonica.com/ce/index.xml)的服务器端实现：

[xslty](https://www.npmjs.org/package/xslty)

**参考**

*   [在 Windows 上使用 Avatar.js 在 Java 8 Nashorn 上运行 Node.js“java.library.path 中没有 avatar-js”](https://stackoverflow.com/questions/23130587/running-node-js-on-java-8-nashorn-with-avatar-js-on-windows-no-avatar-js-in-jav)

*   [回复：Xalan-J XSLT 2.0 状态](http://mail-archives.apache.org/mod_mbox/xml-xalan-dev/200608.mbox/<OF9710600B.492097BF-ON852571D3.00577829-852571D3.0057BE5E@ca.ibm.com>)

*   [org.eclipse.wst.xml.xpath2.processor.sdk.feature](http://git.eclipse.org/c/sourceediting/webtools.sourceediting.xpath.git/tree/features/org.eclipse.wst.xml.xpath2.processor.sdk.feature/feature.properties)

*   [Nashorn - JDK 8 中 Java 和 JavaScript 的综合力量](http://www.infoq.com/articles/nashorn)

*   [Nodyn 完成 Node.js API](http://nodyn.io/compatibility.html)

*   [Saxonica 产品特性矩阵](http://www.saxonica.com/html/products/feature-matrix-9-6.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T19:11:20.113

对于存档，还有[AltovaXML](http://www.altova.com/altovaxml.html)，在 XMLSpy 等中使用的免费啤酒、模式感知 XSLT 2.0 引擎。

不幸的是，像 XMLSpy 一样，它仅适用于 Windows。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T21:40:57.483

你确定你*真的*需要一个模式感知处理器吗？它可能有助于更快地发现样式表中的错误，但成本可能超过收益（无论是在金钱方面还是在许可方面）。

Saxon-SA 是 Saxon B 的模式感知版本。它包含完整的开源 Saxon B（在 Mozilla 公共许可证下发布）。只有“模式感知”的东西是封闭源代码的，所以大部分仍然是自由软件（尽管只是在言论自由中......）。

# ruby - 如何获取方法的 Method 对象？

> ID：529315
> 
> 赞同：17
> 
> 时间：2009-02-09T18:40:13.877
> 
> 标签：ruby

我正在尝试按照以下方式扩展 Method 类：

```
irb(main):008:0> class A
irb(main):009:1> def a
irb(main):010:2> puts "blah"
irb(main):011:2> end
irb(main):012:1> end
=> nil
irb(main):013:0> class Method
irb(main):014:1> def aa
irb(main):015:2> p "hi"
irb(main):016:2> end
irb(main):017:1> end
=> nil
irb(main):018:0> f = A.new
=> #<A:0x54ed4>
irb(main):019:0> A.a
NoMethodError: undefined method `a' for A:Class
    from (irb):19
    from :0
irb(main):020:0> f.a
blah
=> nil
irb(main):027:0> f.a.aa
blah
NoMethodError: undefined method `aa' for nil:NilClass
    from (irb):27
    from :0 
```

正如预期的那样，当 I 时`f.a.aa`，`.aa`正在对 的返回值执行`f.a`。如何访问代表的 Method 对象`f.a`？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-09T18:42:39.970

用[`method`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-method)方法... =）

```
f.method(:a).aa 
```

# c - 从 C 访问网络数据包中未对齐数据的安全、高效方法

> ID：529327
> 
> 赞同：4
> 
> 时间：2009-02-09T18:42:49.923
> 
> 标签：c, networking, memory-alignment

我正在用 C 语言在 ARM9 处理器上为 Linux 编写程序。该程序将访问包含一系列标记数据的网络数据包，例如：

```
<fieldID><length><data><fieldID><length><data> ... 
```

fieldID 和长度字段都是 uint16_t。数据可以是 1 个或更多字节（如果使用全长，则最多 64k，但不是）。

只要`<data>`字节数是偶数，我看不出问题。但是如果我有一个 1 或 3 或 5 字节`<data>`的部分，那么下一个 16 位字段 ID 最终不会在 16 位边界上，并且我预计会出现对齐问题。自从我从头开始做这样的事情已经有一段时间了，所以我有点不确定细节。欢迎任何反馈。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T18:46:42.940

为避免在这种情况下出现对齐问题，请以`unsigned char *`. 所以：

```
unsigned char *p;
//...
uint16_t id = p[0] | (p[1] << 8);
p += 2; 
```

上面的示例假定“小端”数据布局，其中最低有效字节在多字节数中排在第一位。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T19:22:02.463

您应该有功能（如果您使用的语言支持这些功能，则内联和/或模板化）将读取可能未对齐的数据并返回您感兴趣的数据类型。例如：

```
uint16_t unaligned_uint16( void* p)
{
    // this assumes big-endian values in data stream
    //  (which is common, but not universal in network
    //  communications) - this may or may not be 
    //  appropriate in your case

    unsigned char* pByte = (unsigned char*) p;

    uint16_t val = (pByte[0] << 8) | pByte[1];

    return val;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-09T18:53:41.910

简单的方法是手动重建`uint16_t`s，以牺牲速度为代价：

```
uint8_t *packet = ...;
uint16_t fieldID = (packet[0] << 8) | packet[1];  // assumes big-endian host order
uint16_t length = (packet[2] << 8) | packet[2];
uint8_t *data = packet + 4;
packet += 4 + length; 
```

如果您的处理器支持它，您可以键入双关或使用联合（但要注意[*严格的别名*](http://cellperformance.beyond3d.com/articles/2006/06/understanding-strict-aliasing.html)）。

```
uint16_t fieldID = htons(*(uint16_t *)packet);
uint16_t length = htons(*(uint16_t *)(packet + 2)); 
```

请注意，未对齐的访问并不总是受支持（例如，它们可能会产生某种故障），并且在其他体系结构上，它们是受支持的，但会降低性能。

如果数据包未对齐，您始终可以将其复制到静态缓冲区中，然后读取它：

```
static char static_buffer[65540];
memcpy(static_buffer, packet, packet_size);  // make sure packet_size <= 65540
uint16_t fieldId = htons(*(uint16_t *)static_buffer);
uint16_t length = htons(*(uint16_t *)(static_buffer + 2)); 
```

就个人而言，我只会选择选项#1，因为它是最便携的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T18:47:25.667

如果您通过字节指针，对齐总是会很好，尽管可能不是超级有效。

撇开字节序问题不谈，您可以从“真实”字节指针中 memcpy 到正确对齐的任何您想要/需要的内容中，您会没事的。

（这是有效的，因为生成的代码会将数据加载/存储为字节，这是对齐安全的。当生成的程序集有指令以未对齐的方式加载和存储 16/32/64 位内存时，它就会崩溃）。

# apache - 如何将基于 www 的 URL 动态重定向到同一 VirtualHost 中具有多个域的非 www URL

> ID：529334
> 
> 赞同：8
> 
> 时间：2009-02-09T18:45:31.740
> 
> 标签：apache, mod-rewrite, url-rewriting

我有一个看起来像这样的虚拟主机：

```
<VirtualHost *:80>

  ServerName  domain1.com
  ServerAlias www.domain1.com domain2.com www.domain2.com

</VirtualHost> 
```

当有人访问 www.domain1.com/test 时，他们应该被重定向到：

```
domain1.com/test 
```

当有人访问 www.domain2.com/test 时，他们应该被重定向到：

```
domain2.com/test 
```

我目前的 RewriteRules 缺少。

编辑：这是我到目前为止所得到的：

```
# Rewrite www to non-www
RewriteEngine on
RewriteCond %{HTTP_HOST} www\.%{HTTP_HOST}$ [NC]
RewriteRule ^(.*)$ http://%{HTTP_HOST}/$1 [L,R=301] 
```

显然，这会产生一个无限重定向循环。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-09T18:58:24.113

无需重写。

```
<VirtualHost *:80>
    ServerName domain1.com
    ServerAlias domain2.com
    ... real vhost settings ...
</VirtualHost>

<VirtualHost *:80>
    ServerName www.domain1.com
    Redirect permanent / http://domain1.com/
</VirtualHost>
<VirtualHost *:80>
    ServerName www.domain2.com
    Redirect permanent / http://domain2.com/
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T08:43:32.803

您的 RewriteCond 有点不稳定。我很惊讶它什么都做，因为它似乎试图将主机`www.domain1.com`与模式匹配`www\.www.domain1.com`。这些指令对我有用：

```
# Redirect www to non-www
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1$1 [L,R=301] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T19:00:50.580

您可以在一个配置文件中拥有多个 VirtualHost，因此您应该将配置更改为：

```
<VirtualHost *:80>
    ServerName domain1.com
    ServerAlias www.domain1.com
</VirtualHost>

<VirtualHost *:80>
    ServerName domain2.com
    ServerAlias www.domain2.com
</VirtualHost> 
```

您可以为每个要执行的域添加另一个 VirtualHost。

# wget - wget 使用 root 以外的用户名

> ID：529342
> 
> 赞同：0
> 
> 时间：2009-02-09T18:47:17.087
> 
> 标签：wget

我正在尝试在此路径 /usr/test/ 下获取一个 jar 文件，但我只有 root 以外的用户 ID。所以在我发出 wget [ftp://mike:passw0rd@xyz.test.com:/usr/test/getme.txt](ftp://mike:passw0rd@xyz.test.com:/usr/test/getme.txt)

代码返回：TYPE I ...完成。==> CWD 'mike.'/usr/test/... 没有这样的目录 `usr/test/'。

我相信问题出在我以 mike 的身份 ftp 之后，默认情况下我在 mike 个人目录中......问题将是如何使用 wget 并完成这项任务。

请帮忙！！！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T18:49:04.493

您从中进行 ftping 的站点已将其设置为“chrooted”用户帐户，因此他们只能访问其主目录及以下目录。如果可以，您必须更改 FTP 服务器配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T18:57:18.467

有时 wget [ftp://mike:passw0rd@xyz.test.com:/../../../../usr/test/getme.txt](ftp://mike:passw0rd@xyz.test.com:/../../../../usr/test/getme.txt)有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T23:27:07.097

> wget [ftp://mike:passw0rd@xyz.test.com:/usr/test/getme.txt](ftp://mike:passw0rd@xyz.test.com:/usr/test/getme.txt)

这应该工作： wget [ftp://mike:passw0rd@xyz.test.com//usr/test/getme.txt](ftp://mike:passw0rd@xyz.test.com//usr/test/getme.txt)

（注意双//）

# shell - 在多个文件中进行查找/替换的最佳方法？

> ID：529345
> 
> 赞同：49
> 
> 时间：2009-02-09T18:48:06.803
> 
> 标签：shell, replace, find

最好的方法是什么？我不是命令行战士，但我在想可能有一种使用`grep`and的方法`cat`。

我只想替换文件夹和子文件夹中出现的字符串。最好的方法是什么？如果这很重要，我正在运行 ubuntu。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2016-06-09T16:13:41.753

我将为使用[`ag`Silver Searcher](https://github.com/ggreer/the_silver_searcher)对多个文件执行查找/替换操作的人们提供另一个示例。

完整示例：

```
ag -l "search string" | xargs sed -i '' -e 's/from/to/g' 
```

如果我们把它分解，我们得到的是：

```
# returns a list of files containing matching string
ag -l "search string" 
```

接下来，我们有：

```
# consume the list of piped files and prepare to run foregoing command
# for each file delimited by newline
xargs 
```

最后是字符串替换命令：

```
# -i '' means edit files in place and the '' means do not create a backup
# -e 's/from/to/g' specifies the command to run, in this case,
# global, search and replace

sed -i '' -e 's/from/to/g' 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-02-09T18:51:13.367

```
find . -type f -print0 | xargs -0 -n 1 sed -i -e 's/from/to/g' 
```

第一部分是查找命令，用于查找要更改的文件。您可能需要适当地修改它。该`xargs`命令获取找到的每个文件并将该`sed`命令应用于它。该命令获取*from*`sed`的每个实例并将其替换为*to*。这是一个标准的正则表达式，所以根据需要修改它。

 **如果您使用的是 svn，请注意。您的 .svn 目录也将被搜索和替换。你必须排除那些，例如，像这样：

```
find . ! -regex ".*[/]\.svn[/]?.*" -type f -print0 | xargs -0 -n 1 sed -i -e 's/from/to/g' 
```

或者

```
find . -name .svn -prune -o -type f -print0 | xargs -0 -n 1 sed -i -e 's/from/to/g' 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-02-09T19:02:24.320

正如 Paul 所说，您要先找到要编辑的文件，然后再对其进行编辑。使用 find 的替代方法是使用 GNU grep（Ubuntu 上的默认设置），例如：

```
grep -r -l from . | xargs -0 -n 1 sed -i -e 's/from/to/g' 
```

你也可以使用 ack-grep (sudo apt-get install ack-grep 或访问[http://petdance.com/ack/](http://petdance.com/ack/) )，如果你知道你只想要某种类型的文件，并且想忽略里面的东西版本控制目录。例如，如果您只想要文本文件，

```
ack -l --print0 --text from | xargs -0 -n 1 sed -i -e 's/from/to/g'
# `from` here is an arbitrary commonly occurring keyword 
```

使用 sed 的另一种方法是使用 perl，它可以为每个命令处理多个文件，例如，

```
grep -r -l from . | xargs perl -pi.bak -e 's/from/to/g' 
```

在这里，perl 被告知要就地编辑，首先制作一个 .bak 文件。

您可以根据自己的喜好将管道的任何左侧与右侧组合起来。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-17T08:48:58.250

一种替代方法`sed`是使用`rpl`（例如，可从[http://rpl.sourceforge.net/](http://rpl.sourceforge.net/)或您的 GNU/Linux 发行版获得），例如`rpl --recursive --verbose --whole-words 'F' 'A' grades/`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-05-28T08:33:40.130

典型的`(find|grep|ack|ag|rg)-xargs-sed`组合有几个问题：

*   难以记忆和正确。`xargs -r`例如，即使没有找到文件，忘记该选项也会运行命令，这可能会导致问题。
*   检索文件列表，实际替换使用不同的 CLI 工具，并且可以有不同的搜索行为。

这些问题对于递归搜索和替换这样的侵入性和危险操作来说已经足够大，以至于开始开发专用工具：[mo](https://crates.io/crates/molybdenum)。

早期的测试似乎表明它的性能介于[ag](https://github.com/ggreer/the_silver_searcher)和[rg](https://github.com/BurntSushi/ripgrep)之间，它解决了我遇到的以下问题：

*   一次调用可以过滤文件名*和*内容。以下命令在所有带有*v1*指示的源文件中搜索单词*bug ：*

     *`mo -f 'src/.*v1.*' -p bug -w`* 
**   一旦搜索结果正常，就可以添加实际*的*bug*替换*：

     *`mo -f 'src/.*v1.*' -p bug -w -r fix`** 

 *** * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-29T06:49:34.537

```
comment() { 
}
doc() { 
}
function agr { 
doc 'usage: from=sth to=another agr [ag-args]'
comment -l --files-with-matches

ag -0 -l "$from" "${@}" | pre-files "$from" "$to"
}
pre-files() {
doc 'stdin should be null-separated list of files that need replacement; $1 the string to replace, $2 the replacement.'
comment '-i backs up original input files with the supplied extension (leave empty for no backup; needed for in-place replacement.)(do not put whitespace between -i and its arg.)'
comment '-r, --no-run-if-empty
              If  the  standard input does not contain any nonblanks,
              do not run the command.  Normally, the command  is  run
              once  even  if there is no input.  This option is a GNU
              extension.'

AGR_FROM="$1" AGR_TO="$2" xargs -r0 perl -pi.pbak -e 's/$ENV{AGR_FROM}/$ENV{AGR_TO}/g'
} 
```

你可以像这样使用它：

```
from=str1 to=sth agr path1 path2 ... 
```

不提供路径以使其使用当前目录。请注意，需要在 PATH 上安装 ag、xargs 和 perl。

# c# - WPF 自定义文本框

> ID：529347
> 
> 赞同：2
> 
> 时间：2009-02-09T18:48:25.573
> 
> 标签：c#, wpf, textbox

嗨，我正在制作一个自定义文本框，我得到了一切工作，但是当文本框有焦点时，我如何更改闪烁的 I 的颜色？ps 文本位于具有属性 x:Name="PART_ContentHost" 的 ScrollViewer 内

Ps 这是我的第一个 wpf 应用程序，所以我还不太好...

[图片](http://tinypic.com/view.php?pic=xla6py&s=5)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T18:55:52.527

查看[此博客](http://blogs.msdn.com/llobo/archive/2007/02/08/changing-caret-color-in-textbox.aspx)以获得可能的答案。WPF 不容易支持更改插入符号光标

# .net - 您将如何强制 System.Net.Socket.Connect() 方法使用 socks 代理（代码注入与外部自定义代理）

> ID：529350
> 
> 赞同：1
> 
> 时间：2009-02-09T18:49:06.287
> 
> 标签：.net, proxy, extensibility, code-injection

我正在使用 WCF 的 netTcpBinding，它直接连接到一个端点，并且似乎对 socks 代理一无所知。

我需要使用代理，因为我的大多数客户端都不允许直接出站连接，并且始终强制使用 socks 代理。

*   我的第一个想法是配置 .net 框架来做到这一点，所以我编辑了 machine.config 文件如下，但它似乎只适用于 http 代理（不是袜子）

    ```
    <system.net>
    <defaultProxy enabled="true">
      <proxy usesystemdefault="False" proxyaddress="foo:1080" bypassonlocal="True"/>
      <module />
    </defaultProxy>
    </system.net> 
    ```

*   我的第二个选择是实现从 netTcpBinding 继承的自定义绑定，并且仅覆盖连接逻辑以添加代理代码。

    我已经分解了 System.ServiceModel 程序集，不幸的是，很多类都标记为内部类（包括 SocketConnectionInitiator、ConnectionPoolHelper、ClientFramingDuplexSessionChannel 和 FramingDuplexSessionChannel，可能还有其他类）

    这使得创建自定义 netTcpBinding 成为一项巨大的工作，而且在交付新版本的 .net 框架时可能会导致一些问题。

*   另一个想法是将一些代码直接注入到 Socket.Connect() 方法中。这很容易实现，但我对修改.net框架的内部代码不是很有信心。此外，虽然套接字类没有标记为密封，但我害怕破坏某些东西，尤其是在框架的后期版本中。

*   我现在的最后一个想法：我可以创建一个小代理工具，与我的软件在同一台计算机上运行，​​它会自动连接到公司的 socks 代理，并向真正的 socks 代理发出良好的“连接服务器”命令.

我认为后一种选择更好，但我很想听听其他人的意见。

你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-29T08:34:40.240

使用 SocksCap、WideCap 或其他东西，如果你可以将它安装到客户端机器上

或者实现/找到一些 Socks->HTTP 代理并使用它。

# asp.net - VB.NET 跟踪变量

> ID：529355
> 
> 赞同：3
> 
> 时间：2009-02-09T18:50:07.313
> 
> 标签：asp.net, vb.net, logging, trace

我正在研究一种方法来跟踪我公司的 VB.NET 项目的日志记录。.NET 框架具有非常通用的跟踪功能，我想使用 .NET 已经提供的功能。我的公司希望远离 3rd 方软件，所以 log4net 和诸如此类的东西是不可能的。

他们希望能够跟踪 Web 应用程序的流程，并且使用跟踪源、侦听器和开关将使这部分变得非常容易。但是，他们希望我跟踪整个程序中的变量何时发生变化，而不必在计算中每隔一行编写 Trace.Write("i = " & i) 。

那么，有什么有效的方法可以做到这一点吗？

感谢您的回答。提前致谢。

* * *

我决定去上课。我只是创建了一个具有 IntegerChanged 事件的 TraceVariable 类。这样，代码其他部分的开发人员将能够控制如何处理变量更改，如果他想做一些事情而不是跟踪它。

这是代码：

```
Public Class TraceVariable  
    Private mInteger As Integer  
    Public Event IntegerChanged(ByVal mInteger As Integer)  
    Public Property TraceInteger() As Integer
        Get
            TraceInteger = mInteger
        End Get
        Set(ByVal value As Integer)
            mInteger = value
            RaiseEvent IntegerChanged(mInteger)
        End Set
    End Property
End Class 
```

感谢您的回答！至于这很混乱，我们只会将它用于关键变量，所以不用担心。在我们的情况下进行追踪是必要的和安全的预防措施。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T18:58:39.807

跟踪每一个变量的变化很快就会变得混乱，并导致除了最微不足道的应用程序之外的任何应用程序的信息过载。

如果您想要跟踪特定变量的更改，请将它们包装在一个简单的自滚动 Traceable 类中，该类具有在您进行更新时写入 Trace 的访问器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T18:55:15.773

如果您谈论的是 int、double 等原始变量，那么这将很难，但是如果您需要跟踪对自定义类的访问，那么您需要做的就是在属性设置器和修改状态的方法中放置一些跟踪语句（突变体）。

现在，对于原始类型，我尝试使用某种 AOP 工具（如 postsharp）来修补这些原始类型的 IL 代码（突变器）以发出跟踪消息，就像您对用户定义的类所做的一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T18:56:00.623

跟踪变量何时变化似乎非常极端......它可能会很慢。

我不知道框架中内置的任何东西可以做到这一点。从本质上讲，它更接近于分析或调试而不是跟踪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T19:11:32.553

您可能想尝试以下方法（警告 => C#）：

```
 class Program
{
    static void Main(string[] args)
    {
        test(1, "one");
        test(2, "two");
        test(3, "three");
        Console.ReadLine();
    }

    private static void test(int x, string y)
    {
        DisplayParameterNameAndValue(() => x);
        DisplayParameterNameAndValue(() => y);
    }

    static void DisplayParameterNameAndValue(Expression<Func<object>> parameter)
    {
        var expressionBody = parameter.Body;
        MemberExpression memberExpression;
        if (expressionBody is UnaryExpression)
        {
            memberExpression = (MemberExpression)((UnaryExpression)expressionBody).Operand;
        }
        else if (expressionBody is MemberExpression)
        {
            memberExpression = (MemberExpression)expressionBody;
        }
        else
        {
            throw new ArgumentException("parameter");
        }
        string parameterName = memberExpression.Member.Name;
        object parameterValue = parameter.Compile().Invoke();
        Console.WriteLine("{0} => {1}", parameterName, parameterValue);
    }
} 
```

VB 中的等效代码为：

```
Module Module1

Sub Main()
    test(1, "one")
    test(2, "two")
    test(3, "three")
    Console.ReadLine()
End Sub
Private Sub test(ByVal x As Integer, ByVal y As String)
    DisplayParameterNameAndValue(Function() x)
    DisplayParameterNameAndValue(Function() y)
End Sub

Private Sub DisplayParameterNameAndValue(ByVal parameter As Expression(Of Func(Of Object)))
    Dim expressionBody = parameter.Body
    Dim memberExpression As MemberExpression
    If TypeOf expressionBody Is UnaryExpression Then
        memberExpression = DirectCast(DirectCast(expressionBody, UnaryExpression).Operand, MemberExpression)
    ElseIf TypeOf expressionBody Is MemberExpression Then
        memberExpression = DirectCast(expressionBody, MemberExpression)
    Else
        Throw New ArgumentException("parameter")
    End If
    Dim parameterName As String = memberExpression.Member.Name
    Dim parameterValue As Object = parameter.Compile().Invoke()
    Console.WriteLine("{0} => {1}", parameterName, parameterValue)
  End Sub
End Module 
```

我已经对其进行了测试，但它并没有给我与 c# 相同的结果，糟糕的 vb！

希望这可以帮助。

# c# - 在没有对最终输出进行 HTML 编码的情况下使用 XSL 进行转换的属性方式是什么？

> ID：529374
> 
> 赞同：4
> 
> 时间：2009-02-09T18:54:37.740
> 
> 标签：c#, asp.net, xml, xslt

所以，我正在使用.NET。我有一个 XSL 文件，C# 中的 XslTransform 对象读取 XSL 文件并将一段 XML 数据（内部制造）转换为 HTML。

我注意到我的最终输出有**<**和**>**自动编码为**<** 和**>** . 有什么方法可以防止这种情况发生吗？有时我需要将我的文本加粗或斜体，但它被无意清理了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T20:11:56.993

你的 xsl 文件应该有：

*   html的输出
*   省略所有在 xslt 中使用的命名空间

IE

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt"
    exclude-result-prefixes="xsl msxsl">

    <xsl:output method="html" indent="no" omit-xml-declaration="yes"/>

    <!-- lots -->
</xsl:stylesheet> 
```

理想情况下，您应该使用接受 a`TextWriter`或 a `Stream`(not `XmlWriter`) 的重载 - 即类似于：

```
StringBuilder sb = new StringBuilder();
using (XmlReader reader = XmlReader.Create(source)
using (TextWriter writer = new StringWriter(sb))
{
    XslCompiledTransform xslt = new XslCompiledTransform();
    xslt.Load("Foo.xslt"); // in reality, you'd want to cache this
    xslt.Transform(reader, options.XsltOptions, writer);
}
string html = sb.ToString(); 
```

在 xslt 中，如果你真的想要独立的`<`/ `>`（即你希望它由于某种原因格式不正确），那么你需要禁用输出转义：

```
<xsl:text disable-output-escaping="yes">
    Your malformed text here
</xsl:text> 
```

但是，通常对字符进行转义是*正确的。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T19:36:36.970

我过去曾使用它来将 XMl 文档转换为您需要的 HTML 字符串。

```
public static string TransformXMLDocFromFileHTMLString(string orgXML, string transformFilePath)
{
    System.Xml.XmlDocument orgDoc = new System.Xml.XmlDocument();
    orgDoc.LoadXml(orgXML);

    XmlNode transNode = orgDoc.SelectSingleNode("/");
    System.Text.StringBuilder sb = new System.Text.StringBuilder();
    XmlWriterSettings settings = new XmlWriterSettings();

    settings.ConformanceLevel = ConformanceLevel.Auto;
    XmlWriter writer = XmlWriter.Create(sb, settings);

    System.Xml.Xsl.XslCompiledTransform trans = new System.Xml.Xsl.XslCompiledTransform();
    trans.Load(transformFilePath);

    trans.Transform(transNode, writer);

    return sb.ToString();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T19:01:38.520

（根据 MSDN，不推荐使用 XslTransform。他们建议您切换到 XslCompiledTransform。）

你能发布一个输入/输出的例子吗？

# java - Eclipse - 编译和执行程序

> ID：529391
> 
> 赞同：1
> 
> 时间：2009-02-09T18:59:37.137
> 
> 标签：java, eclipse, compilation

过去，我使用 JCreator 开发我的 java 应用程序。我想尝试 Eclipse 并查看它的 IDE。

在 JCreator 上，我可以打开一个 java 文件并在命令提示符下运行它。在 Eclipse 上，如果不先创建项目、创建新的 java 类然后从文件中复制和粘贴代码，我无法找到如何编译和运行其他人编写的 java 文件。

我什至无法弄清楚如何将 java 文件导入项目。

所以我的问题是：
1\. 如何在不创建 java 项目的情况下打开、编译和运行 java 文件。
2\. 如何将 java 文件导入我已有的项目中。
3\. 我怎样才能在命令提示符下运行程序，而不是在 Eclipse 中的控制台上，（更新：更清楚）直接从 Eclipse 中运行。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T07:17:30.047

1/ 不要忘记[**剪贴簿页面**](http://www.eclipsezone.com/eclipse/forums/t61137.html)（也在[这里展示](http://veerasundar.com/blog/2009/10/eclipse-tip-how-to-use-scrapbook-pages-in-eclipse/)）

理论上，您可以在其中复制一个类，但由于该类实际上被封装到一个“主不可见”类中，作为一个内部类，它不支持其中的任何静态方法。

但是，对于一小段代码，它可以很好地解决问题。

![检查剪贴簿中的代码](https://i.stack.imgur.com/tOVMv.jpg)
（来自这个[Eclipse 教程](http://sourceforge.net/projects/eclipsetutorial/)）

3/由于您希望它直接从 Eclipse 运行，因此请[按照此线程](http://dev.eclipse.org/newslists/news.eclipse.newcomer/msg13643.html)中的说明使用**外部工具**

该外部工具将`C:\WINDOWS\system32\cmd.exe`与工作目录一起运行`${container_loc}`

[**本文“如何在我的控制台中打开 Windows 命令提示符？”中的**](http://www.avajava.com/tutorials/lessons/how-do-i-open-a-windows-command-prompt-in-my-console.html)更多详细信息 .

[![](https://i.stack.imgur.com/tNMCn.png)](https://i.stack.imgur.com/tNMCn.png)
[（来源：[avajava.com](http://www.avajava.com/tutorials/eclipse/how-do-i-open-a-windows-command-prompt-in-my-console/how-do-i-open-a-windows-command-prompt-in-my-console-03.gif)）]

这将给出：

[![](https://i.stack.imgur.com/nPZIN.png)](https://i.stack.imgur.com/nPZIN.png)
[（来源：[avajava.com](http://www.avajava.com/tutorials/eclipse/how-do-i-open-a-windows-command-prompt-in-my-console/how-do-i-open-a-windows-command-prompt-in-my-console-05.gif)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T19:29:22.773

1.  据我所知，你不能
2.  右键单击项目>导入
3.  关于您的平台，大致相当于：`java <classname>`. （确保 java 在你的路径中，否则使用它的绝对路径。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T15:11:21.357

从 3.4 版开始，Eclipse 提供了一个有用的特性：您可以将 Java 类的*文本*粘贴到 Java 项目中（复制类的内容，选择项目或源文件夹，粘贴）。这将在正确的包中创建一个适当命名的文件。这可能是导入单个类的最简单方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T19:28:42.807

2) 使用“导入”命令。确保 java 文件进入“src”目录。

3) 一种方法是将您的类导出到 JAR 文件，然后在命令提示符下运行 JAR 文件（例如 java -jar file.jar）

# python - Python 脚本：每次向 shell 打印新行而不是更新现有行

> ID：529395
> 
> 赞同：3
> 
> 时间：2009-02-09T19:00:14.000
> 
> 标签：python, shell

说到 python，我是个菜鸟。我有一个 python 脚本，它给我这样的输出：

```
[last] ZVZX-W3vo9I: Downloading video webpage
[last] ZVZX-W3vo9I: Extracting video information
[download] Destination: myvideo.flv
[download]   9.9% of 10.09M at    3.30M/s ETA 00:02 
```

最后一行不断更新新的进度值。我想改变这一点。我不想更新，而是希望每次都打印一个新行。我怎样才能做到这一点？我认为有关的部分是这一点：

```
def report_progress(self, percent_str, data_len_str, speed_str, eta_str):
    """Report download progress."""
    self.to_stdout(u'\r[download] %s of %s at %s ETA %s' %
        (percent_str, data_len_str, speed_str, eta_str), skip_eol=True) 
```

如果需要查看更多代码，请告诉我，以便我向您展示解决此问题所需的内容。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T19:03:10.433

如果我正确理解您的要求，您应该能够将该功能更改为：

```
def report_progress(self, percent_str, data_len_str, speed_str, eta_str):
    """Report download progress."""
    print u'[download] %s of %s at %s ETA %s' % (percent_str, data_len_str, speed_str, eta_str) 
```

这将每次在新行上打印输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T19:03:25.100

我想你可能只需要改变：

```
skip_eol=True 
```

到：

```
skip_eol=False 
```

并摆脱“ `\r`”，看看会发生什么。我想你会惊喜的:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T19:04:17.017

您可以取出\r，它会将光标移回行首，并可能取出skip_eol=True。也许：

```
 self.to_stdout(u'[download] %s of %s at %s ETA %s' %
        (percent_str, data_len_str, speed_str, eta_str)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T19:08:28.957

“更新”效果是通过'\r'来实现的。

在 Python (2.x) shell 中试试这个：

```
print "00000000\r1111" 
```

\r 只是将光标返回到行首。

# c# - 使用数据集的 Crystal Reports 子报表

> ID：529400
> 
> 赞同：2
> 
> 时间：2009-02-09T19:00:43.530
> 
> 标签：c#, crystal-reports, dataset, subreport, ondemand

我将 Crystal Reports XI 与 C# Visual Studio 2005 一起使用。我正在尝试从汇总数据集创建子报表。一个简单的示例是包含员工的公司列表。我加载公司数据集（使用 CompanyId）。我想创建一个由 CompanyId 链接的子报表，从而按需加载（显然）数据集。如果我将所有细节加载到一个怪物数据集中，我可以创建这个子报表，但在我的实际实现中，这将涉及加载数百万个细节行（不是一个选项）。

有没有办法可以捕获 SubReport 事件并从我的数据库连接加载数据集？我基本上想拦截子报表链接调用来自己构建数据集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-05-04T07:33:40.567

这是完全可能的。在您拥有的 xsd 数据集中创建 2 个数据表。根据公共 ID/键值获取这 2 个数据表的值。将一个数据集表复制到另一个像

```
ds2.Tables.Add(ds1.Tables[0].Copy()); 
```

然后，

```
rpt.Load(path + @"Report\Report1.rpt");
rpt.SetDataSource(ds2); //datasource is single
crystalReportViewer.ReportSource = FFrpt; 
```

当您添加子报表时，获取第二个表作为数据源及其值。将这些字段添加到您的子报表中，完成！

问候希亚姆

# javascript - javascript, css, z-index, div 堆叠

> ID：529407
> 
> 赞同：3
> 
> 时间：2009-02-09T19:01:40.157
> 
> 标签：javascript, css, html, z-index

我想创建一种仅作用于页面内单个 DIV 的轻/厚框。当我触发第一个 div(phantom_back) 时，我想要它，但第二个，phantom_top 在 phantom_back 之后设置它自己，而不管它的 z-index 和定位如何。

我究竟做错了什么？

这是我到目前为止所拥有的：

```
<html>
<head>
    <script type="text/javascript">
    <!--//
        function phantom_back(image)
        {
            document.getElementById('phantom_back').style.zIndex = 100;
            document.getElementById('phantom_back').style.height = '100%';
            document.getElementById('phantom_back').style.width = '100%';
            phantom_top();
        }

        function phantom_top(image)
        {
            document.getElementById('phantom_top').style.zIndex = 102;
            document.getElementById('phantom_top').style.height = 600;
            document.getElementById('phantom_top').style.width = 600;
            document.getElementById('phantom_top').style.top = 0;
            document.getElementById('phantom_top').style.left = 0;
        }
    //-->
    </script>
</head>
<body>
    <a href="#" onclick="phantom_back()">Change</a>

    <div style="height: 700px; width: 700px; border: 2px black solid; margin:0 auto; background-color: red;" id="overlord">
        <div style="height: 10px; width: 10px; position: relative; z-index: -1; background-color: #000000; filter:alpha(opacity=50); -moz-opacity:0.5; -khtml-opacity: 0.5; opacity: 0.5;" id="phantom_back"></div>

        <div style="height: 10px; width: 10px; position: relative; z-index: -3; margin: 0 auto; background-color: green;" id="phantom_top">asdf</div>
    </div>

</body>
</html> 
```

我在徘徊为什么我找不到的教程都提供这样的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T20:35:04.240

所以，我明白了。我在 phantom_back 上设置了一个绝对定位，而不是尝试重新堆叠它们，我只是设置了可见性。当我尝试设置 z-index 时，它会在我身上分崩离析。

```
<html>
<head>
    <script type="text/javascript">
    <!--//
        function phantom_back(image)
            {
                document.getElementById('phantom_back').style.height = 700;
                document.getElementById('phantom_back').style.width = 700;
                document.getElementById('phantom_back').style.zIndex = 50;
                phantom_top();
            }

        function phantom_top()
            {
                document.getElementById('phantom_top').style.height = 600;
                document.getElementById('phantom_top').style.width = 600;
                document.getElementById('phantom_top').style.visibility = "visible";
            }
    //-->
    </script>
</head>
<body>
    <a href="#" onclick="phantom_back()">Change</a>

    <div style="height: 700px; width: 700px; border: 2px black solid; margin:0 auto; background-color: red;" id="overlord">
        <div style="height: 10px; width: 10px; position: absolute; z-index: -1; background-color: #000000; filter:alpha(opacity=50); -moz-opacity:0.5; -khtml-opacity: 0.5; opacity: 0.5;" id="phantom_back"></div>

        <div style="margin: 0 auto; text-align: center; height: 10px; width: 10px;  position: relative; z-index: 102; top: 10px; background-color: white; visibility: hidden;" id="phantom_top"><br /><br /><img src="load.gif"></div>
    </div>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T19:19:05.310

phantom_top 设置为位置：相对而不是绝对，因此它当前不重叠 phantom_back。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-01T11:13:39.020

不要忘记为高度和宽度连接一个 px 字符串。z-index 不需要 px

```
document.getElementById('phantom_back').style.height = 700 + "px"; 
```

像那样。

# python - 在Python中以相反的顺序遍历列表

> ID：529424
> 
> 赞同：912
> 
> 时间：2009-02-09T19:04:58.527
> 
> 标签：python, loops, reverse

所以我可以从 开始`collection[len(collection)-1]`和结束`collection[0]`。

我还希望能够访问循环索引。

* * *

## 回答 #1

> 赞同：1526
> 
> 时间：2009-02-09T19:05:54.000

使用内置[`reversed()`](https://docs.python.org/library/functions.html#reversed)函数：

```
>>> a = ["foo", "bar", "baz"]
>>> for i in reversed(a):
...     print(i)
... 
baz
bar
foo 
```

要访问原始索引，[`enumerate()`](https://docs.python.org/library/functions.html#enumerate)请在列表中使用，然后将其传递给`reversed()`：

```
>>> for i, e in reversed(list(enumerate(a))):
...     print(i, e)
... 
2 baz
1 bar
0 foo 
```

由于`enumerate()`返回一个生成器并且生成器无法反转，因此您需要将其转换为`list`第一个。

* * *

## 回答 #2

> 赞同：215
> 
> 时间：2009-02-09T19:07:38.630

你可以做：

```
for item in my_list[::-1]:
    print item 
```

（或者你想在 for 循环中做的任何事情。）

切片反转 for 循环中的`[::-1]`列表（但实际上不会“永久”修改您的列表）。

* * *

## 回答 #3

> 赞同：94
> 
> 时间：2009-02-09T23:18:11.867

可以这样做：

```
for i in range(len(collection)-1, -1, -1):
    print collection[i]

    # print(collection[i]) for python 3\. + 
```

所以你的猜测非常接近:) 有点尴尬，但它基本上是在说：从小于 1 开始`len(collection)`，继续前进，直到你到达 -1 之前，以 -1 为步长。

仅供参考，该`help`功能非常有用，因为它可以让您从 Python 控制台查看文档，例如：

`help(range)`

* * *

## 回答 #4

> 赞同：73
> 
> 时间：2009-02-09T19:14:12.187

如果您需要循环索引，并且不想遍历整个列表两次，或者使用额外的内存，我会编写一个生成器。

```
def reverse_enum(L):
   for index in reversed(xrange(len(L))):
      yield index, L[index]

L = ['foo', 'bar', 'bas']
for index, item in reverse_enum(L):
   print index, item 
```

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2011-10-11T06:28:19.650

`reversed`内置函数很方便：

```
for item in reversed(sequence): 
```

reversed的[文档](http://docs.python.org/library/functions.html?highlight=reversed#reversed)解释了它的局限性。

对于我必须与索引一起反向遍历序列的情况（例如，对于更改序列长度的就地修改），我将这个函数定义为我的 codeutil 模块：

```
from six.moves import zip as izip, range as xrange

def reversed_enumerate(sequence):
    return izip(
        reversed(xrange(len(sequence))),
        reversed(sequence),
    ) 
```

这避免了创建序列的副本。显然，这些`reversed`限制仍然适用。

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2016-12-06T15:37:37.547

没有进口的方法：

```
for i in range(1,len(arr)+1):
    print(arr[-i]) 
```

或者，这种方法会在内存中创建一个新列表，所以要小心大列表

```
for i in arr[::-1]:
    print(i) 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2018-04-06T13:27:20.633

此外，您可以使用“范围”或“计数”函数。如下：

```
a = ["foo", "bar", "baz"]
for i in range(len(a)-1, -1, -1):
    print(i, a[i])

3 baz
2 bar
1 foo 
```

您还可以使用 itertools 中的“count”，如下所示：

```
a = ["foo", "bar", "baz"]
from itertools import count, takewhile

def larger_than_0(x):
    return x > 0

for x in takewhile(larger_than_0, count(3, -1)):
    print(x, a[x-1])

3 baz
2 bar
1 foo 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-02-15T05:04:53.750

如果不重新创建新列表，您可以通过索引来完成：

```
>>> foo = ['1a','2b','3c','4d']
>>> for i in range(len(foo)):
...     print foo[-(i+1)]
...
4d
3c
2b
1a
>>> 
```

或者

```
>>> length = len(foo)
>>> for i in range(length):
...     print foo[length-i-1]
...
4d
3c
2b
1a
>>> 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2015-09-11T06:51:03.593

```
>>> l = ["a","b","c","d"]
>>> l.reverse()
>>> l
['d', 'c', 'b', 'a'] 
```

或者

```
>>> print l[::-1]
['d', 'c', 'b', 'a'] 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2018-07-14T14:58:32.967

在 python 3 中， list 创建了一个副本，因此`reversed(list(enumerate(collection))`可能效率低下，生成另一个列表并没有被优化掉。

如果集合肯定是一个列表，那么最好将复杂性隐藏在迭代器后面

```
def reversed_enumerate(collection: list):
    for i in range(len(collection)-1, -1, -1):
        yield i, collection[i] 
```

所以，最干净的是：

```
for i, elem in reversed_enumerate(['foo', 'bar', 'baz']):
    print(i, elem) 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2014-08-17T18:50:25.510

我喜欢单线生成器方法：

```
((i, sequence[i]) for i in reversed(xrange(len(sequence)))) 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-02-09T19:07:13.530

像往常一样使用`list.reverse()`然后迭代。

[http://docs.python.org/tutorial/datastructures.html](http://docs.python.org/tutorial/datastructures.html)

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2017-02-27T17:18:28.487

对于任何值得的事情，您也可以这样做。非常简单。

```
a = [1, 2, 3, 4, 5, 6, 7]
for x in xrange(len(a)):
    x += 1
    print a[-x] 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2014-04-25T01:02:02.093

```
def reverse(spam):
    k = []
    for i in spam:
        k.insert(0,i)
    return "".join(k) 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2018-09-06T01:44:54.063

如果您需要索引并且您的列表很小，那么最易读的方法是`reversed(list(enumerate(your_list)))`按照公认的答案所说的那样做。但这会创建列表的副本，因此如果您的列表占用了大部分内存，则必须减去`enumerate(reversed())`from返回的索引`len()-1`。

如果您只需要执行一次：

```
a = ['b', 'd', 'c', 'a']

for index, value in enumerate(reversed(a)):
    index = len(a)-1 - index

    do_something(index, value) 
```

或者如果您需要多次执行此操作，则应使用生成器：

```
def enumerate_reversed(lyst):
    for index, value in enumerate(reversed(lyst)):
        index = len(lyst)-1 - index
        yield index, value

for index, value in enumerate_reversed(a):
    do_something(index, value) 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2019-06-03T09:53:02.350

我认为最优雅的方法是转换`enumerate`并`reversed`使用以下生成器

```
(-(ri+1), val) for ri, val in enumerate(reversed(foo)) 
```

生成`enumerate`迭代器的反向

例子：

```
foo = [1,2,3]
bar = [3,6,9]
[
    bar[i] - val
    for i, val in ((-(ri+1), val) for ri, val in enumerate(reversed(foo)))
] 
```

结果：

```
[6, 4, 2] 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-09T19:07:30.470

反向功能在这里派上用场：

```
myArray = [1,2,3,4]
myArray.reverse()
for x in myArray:
    print x 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2018-09-10T23:02:04.270

假设任务是在列表中找到满足某些条件的最后一个元素（即向后看时首先），我得到以下数字。

蟒蛇2：

```
>>> min(timeit.repeat('for i in xrange(len(xs)-1,-1,-1):\n    if 128 == xs[i]: break', setup='xs, n = range(256), 0', repeat=8))
4.6937971115112305
>>> min(timeit.repeat('for i in reversed(xrange(0, len(xs))):\n    if 128 == xs[i]: break', setup='xs, n = range(256), 0', repeat=8))
4.809093952178955
>>> min(timeit.repeat('for i, x in enumerate(reversed(xs), 1):\n    if 128 == x: break', setup='xs, n = range(256), 0', repeat=8))
4.931743860244751
>>> min(timeit.repeat('for i, x in enumerate(xs[::-1]):\n    if 128 == x: break', setup='xs, n = range(256), 0', repeat=8))
5.548468112945557
>>> min(timeit.repeat('for i in xrange(len(xs), 0, -1):\n    if 128 == xs[i - 1]: break', setup='xs, n = range(256), 0', repeat=8))
6.286104917526245
>>> min(timeit.repeat('i = len(xs)\nwhile 0 < i:\n    i -= 1\n    if 128 == xs[i]: break', setup='xs, n = range(256), 0', repeat=8))
8.384078979492188 
```

所以，最丑的选择`xrange(len(xs)-1,-1,-1)`是最快的。

Python 3（不同的机器）：

```
>>> timeit.timeit('for i in range(len(xs)-1,-1,-1):\n    if 128 == xs[i]: break', setup='xs, n = range(256), 0', number=400000)
4.48873088900001
>>> timeit.timeit('for i in reversed(range(0, len(xs))):\n    if 128 == xs[i]: break', setup='xs, n = range(256), 0', number=400000)
4.540959084000008
>>> timeit.timeit('for i, x in enumerate(reversed(xs), 1):\n    if 128 == x: break', setup='xs, n = range(256), 0', number=400000)
1.9069805409999958
>>> timeit.timeit('for i, x in enumerate(xs[::-1]):\n    if 128 == x: break', setup='xs, n = range(256), 0', number=400000)
2.960720073999994
>>> timeit.timeit('for i in range(len(xs), 0, -1):\n    if 128 == xs[i - 1]: break', setup='xs, n = range(256), 0', number=400000)
5.316207007999992
>>> timeit.timeit('i = len(xs)\nwhile 0 < i:\n    i -= 1\n    if 128 == xs[i]: break', setup='xs, n = range(256), 0', number=400000)
5.802550058999998 
```

这里，`enumerate(reversed(xs), 1)`是最快的。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-06-01T17:04:02.843

要使用负索引：从 -1 开始，每次迭代后退 -1。

```
>>> a = ["foo", "bar", "baz"]
>>> for i in range(-1, -1*(len(a)+1), -1):
...     print i, a[i]
... 
-1 baz
-2 bar
-3 foo 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-07-27T12:57:10.533

您还可以使用`while`循环：

```
i = len(collection)-1
while i>=0:
    value = collection[i]
    index = i
    i-=1 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2017-11-26T03:15:41.623

您可以在普通 for 循环中使用负索引：

```
>>> collection = ["ham", "spam", "eggs", "baked beans"]
>>> for i in range(1, len(collection) + 1):
...     print(collection[-i])
... 
baked beans
eggs
spam
ham 
```

要访问索引，就像您在集合的反向副本上向前迭代一样，请使用`i - 1`：

```
>>> for i in range(1, len(collection) + 1):
...     print(i-1, collection[-i])
... 
0 baked beans
1 eggs
2 spam
3 ham 
```

要访问原始的、未反转的索引，请使用`len(collection) - i`：

```
>>> for i in range(1, len(collection) + 1):
...     print(len(collection)-i, collection[-i])
... 
3 baked beans
2 eggs
1 spam
0 ham 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-02-21T22:10:08.290

如果您不介意索引为负数，则可以执行以下操作：

```
>>> a = ["foo", "bar", "baz"]
>>> for i in range(len(a)):
...     print(~i, a[~i]))
-1 baz
-2 bar
-3 foo 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2021-11-11T14:59:56.757

我很困惑为什么到目前为止没有出现明显的选择：

如果`reversed()`由于您有生成器（如`enumerate()`）而无法正常工作，请使用`sorted()`：

```
>>> l = list( 'abcdef' )
>>> sorted( enumerate(l), reverse=True )
[(5, 'f'), (4, 'e'), (3, 'd'), (2, 'c'), (1, 'b'), (0, 'a')] 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-07-27T15:17:43.157

其他答案很好，但如果你想做 **列表理解风格**

```
collection = ['a','b','c']
[item for item in reversed( collection ) ] 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-12-26T07:40:34.017

一个简单的方法：

```
n = int(input())
arr = list(map(int, input().split()))

for i in reversed(range(0, n)):
    print("%d %d" %(i, arr[i])) 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-07-22T07:09:28.223

```
input_list = ['foo','bar','baz']
for i in range(-1,-len(input_list)-1,-1)
    print(input_list[i]) 
```

我认为这也是一种简单的方法......从末尾读取并不断递减直到列表的长度，因为我们从不执行“结束”索引，因此也添加了-1

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2019-11-14T05:21:14.883

您可以使用生成器：

```
li = [1,2,3,4,5,6]
len_li = len(li)
gen = (len_li-1-i for i in range(len_li)) 
```

最后：

```
for i in gen:
    print(li[i]) 
```

希望这对你有帮助。

# python - Easy_install 缓存下载的文件

> ID：529425
> 
> 赞同：19
> 
> 时间：2009-02-09T19:05:40.147
> 
> 标签：python, easy-install, egg, python-wheel

有没有办法配置 easy_install 以避免在安装失败时再次下载文件？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-11T20:47:23.357

**13 年后更新**：`easy_install`2021 年 1 月从 Python 中移除。python 包管理器是`pip`，它缓存下载的包。

pip ( [http://pypi.python.org/pypi/pip/](http://pypi.python.org/pypi/pip/) ) 是 easy_install 工具的替代品，可以做到这一点。

只需运行`easy_install pip`并将环境变量设置`PIP_DOWNLOAD_CACHE`为您希望 pip 存储文件的路径。请注意，缓存不适用于从源代码存储库（如 svn/git/hg/bzr）签出的依赖项。

然后使用`pip install`代替`easy_install`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-08-29T20:51:17.323

这是我使用 pip 的解决方案，甚至可以管理二进制包的安装，并且可以在 Linux 和 Windows 上使用。并且根据要求，它将从 PyPi 的下载限制到最低限度，作为额外的奖励，在 Linux 上，它允许将通常需要编译的软件包的重复安装速度提高到几分之一秒。

设置只需几个步骤，但我认为，这是值得的。

# 创建 pip 配置文件

创建 pip 配置文件（在 linux 上：~/.pip/pip.conf，在 Windows %HOME%\pip\pip.ini 上）

我的有这个内容：

```
[global]
download-cache = /home/javl/.pip/cache
find-links = /home/javl/.pip/packages

[install]
use-wheel = yes

[wheel]
wheel-dir = /home/javl/.pip/packages 
```

# 填充`cache`目录 - 自动进行

该`cache`目录每次都会获取从pypi下载的数据的缓存版本，pip尝试从pypi获取一些包。很容易得到它（不需要特别注意），但请注意，从 pip 的角度来看，这些只是从 PyPi 下载的兑现数据，而不是包，所以如果你使用 option `--no-index`，它将不起作用。

# `pip download`填充`packages`目录

`packages`目录是放置真正的包文件的地方。例如，对于我最喜欢的包`plac`，我会这样做：

```
$ pip download --dest ~/.pip/packages plac 
```

并且 plac 包文件将出现在该目录中。您甚至可以使用`-r requirements.txt`文件一次为多个包执行此操作。

这些包甚至与`$ pip install --no-index <something>`.

# 防止在 Linux 上重复编译同一个包

例如`lxml`，包需要编译，下载和编译可能需要 45 秒到几分钟。使用车轮格式，您可以在这里节省很多。

安装`wheel`工具，如果您还没有：

```
$ pip install wheel 
```

创建轮子`lxml`（假设您`lxml`过去已成功安装 - 它需要安装系统中的一些库）：

```
$ pip wheel lxml 
```

这会下载、编译，但最终会导致 lxml`whl`文件位于`packages`目录中。

自那时候起

```
$ pip install lxml 
```

甚至更快

```
$ pip install --no-index lxml 
```

将花费几分之一秒，因为它使用轮格式包。

# 从Window setup exe包中准备wheel包

（注：Linux 机器上也可以准备，不需要编译，只是从 exe 文件重新打包成`whl`.）

1.  从 pypi 下载包的 exe 形式，例如：

    $ wget [https://pypi.python.org/packages/2.7/l/lxml/lxml-3.2.3.win32-py2.7.exe#md5=14ab978b7f0a3382719b65a1ca938d33](https://pypi.python.org/packages/2.7/l/lxml/lxml-3.2.3.win32-py2.7.exe#md5=14ab978b7f0a3382719b65a1ca938d33) $ dir lxml-3.2.3.win32-py2.7 。可执行程序

2.  将其转换为`whl`

    $ 轮子转换 lxml-3.2.3.win32-py2.7.exe $ dir lxml-3.2.3.win32-py2.7.exe lxml-3.2.3-cp27-none-win32.whl

3.  测试它：

    $点安装lxml

或者

```
$ pip install --no-index lxml 
```

应该很快。

请注意，这`wheel convert`可以对鸡蛋格式的包进行完全相同的转换。

# 让`easy_install`并重`setup.py install`用您的`packages`目录

`easy_install`并且`$ python setup.py install`似乎不提供下载缓存，但允许使用我们`packages`目录中的包。

为此，请编辑这两个工具的配置文件：

在 Linux 上：`$HOME/.pydistutils.cfg`

在 Windows 上：`%HOME%\pydistutils.cfg`

就我而言，我在这里`/home/javl/.pydistutils.cfg`：

```
[easy_install]
find_links = /home/javl/.pip/packages 
```

`pip install`当 pip 尝试安装一个包并声明对其他包的依赖时，这个配置甚至可能有助于某些调用情况。当它委派这个任务来`setup.py`调用时，如果没有`.pydistutils.cfg`配置，它会从 PyPi 下载文件。

不幸的是，在这种情况下不支持车轮格式（据我所知）。

# xml - 有没有一种简单的方法来抑制 Oracle 中集合的 XML 行标记？

> ID：529428
> 
> 赞同：0
> 
> 时间：2009-02-09T19:06:06.763
> 
> 标签：xml, oracle, plsql

我有一个查询，我正在使用 DBMS_XMLGEN 包从 Oracle 中生成 XML。

例如，我使用如下游标：

```
SELECT
   A.NAME primaryName,
   (CURSOR(SELECT B.NAME AS NAME FROM B WHERE B.ID=A.ID)) SYNONYMS
FROM
  A 
```

我有一个查询上下文 qtx，并将查询设置为上述上下文。来电：

```
result := DBMS_XMLGEN.getXML(qryCtx); 
```

从生成的 XML 的角度来看，我几乎可以到达我想去的地方：

```
<PRIMARYNAME>Main Name</PRIMARYNAME>
  <SYNONYMS>
   <SYNONYMS_ROW>
    <NAME>Synonym1</NAME>
   </SYNONYMS_ROW>
   <SYNONYMS_ROW>
    <NAME>Synonym2</NAME>
   </SYNONYMS_ROW>
  </SYNONYMS> 
```

我真正想做的是压制`SYNONYMS_ROW`标签。我也尝试过 (CAST(MULTISET( `<query>`) 并得到类似的结果。

我知道我可以进行 CLOB 搜索和替换，但似乎应该有一种更简单或更好的设计方法（即，我是否应该定义所需的 xsd 并以某种方式使用它？）。我也可以做一个完整的存储过程，并使用游标即时构建需要的标签，但最好有一个单独的 SQL 语句来代替。感谢您的任何建议

谢谢尼克 - 事实证明，解决我描述的问题的最简单方法是使用 XMLAGG 函数并稍微不同地生成我的 XML 结果。

```
select
   XMLELEMENT("primaryName",A.Name),
   xmlelement("synonyms",
       (SELECT XMLAGG(XMLELEMENT("name",b.name) ) from b
        where b.id=a.id and b.type='S') )
from
   A 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T19:19:27.277

您需要下拉到 PL/SQL，您可以在其中更好地控制 dbms_xmlgen 包。例如，您可以通过以下方式更改它设置的行标签的行为。

```
declare
qryctx DBMS_XMLGEN.ctxhandle;
results xmltype;
begin

  qryctx := dbms_xmlgen.newcontext('select foo from bar where id = my_id');
  dbms_xmlgen.SETBINDVALUE(qryctx,'my_id',id);
    dbms_xmlgen.setRowTag(qryCtx,NULL);
    dbms_xmlgen.setRowSetTag(qryCtx,NULL);
  results := dbms_xmlgen.getxmltype(qryctx);
  dbms_xmlgen.closecontext(qryctx);
  return results;
end; 
```

这个包不仅允许您更改行标签，还允许您更改所有行的标签。在上面的示例中，我通过将 NULL 作为第二个参数传递给 dbms_xmlgen.setRowTag 调用来抑制行标记。我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T16:13:52.527

请参阅我在问题末尾添加的评论，了解我最终决定如何去。

# java - Java：以百万为单位的格式数字

> ID：529432
> 
> 赞同：13
> 
> 时间：2009-02-09T19:06:23.937
> 
> 标签：java, formatting, numeric, numericupdown

有没有办法使用 DecimalFormat （或其他一些标准格式化程序）来格式化这样的数字：

> 1,000,000 => 1.00M
> 
> 1,234,567 => 1.23M
> 
> 1,234,567,890 => 1234.57M

基本上将某个数字除以 100 万，保留 2 个小数位，最后打一个“M”。我考虑过创建一个新的 NumberFormat 子类，但它看起来比我想象的要复杂。

我正在编写一个具有如下格式方法的 API：

```
public String format(double value, Unit unit); // Unit is an enum 
```

在内部，我将 Unit 对象映射到 NumberFormatters。实现是这样的：

```
public String format(double value, Unit unit)
{
    NumberFormatter formatter = formatters.get(unit);
    return formatter.format(value);
} 
```

请注意，正因为如此，我不能指望客户端除以 100 万，而且我不能只使用 String.format() 而不将其包装在 NumberFormatter 中。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-09T19:21:03.777

```
String.format("%.2fM", theNumber/ 1000000.0); 
```

有关更多信息，请参阅[String.format javadocs](http://java.sun.com/javase/6/docs/api/java/lang/String.html#format(java.lang.String,%20java.lang.Object...))。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T22:32:59.743

请注意，如果您有`BigDecimal`，则可以使用以下`movePointLeft`方法：

```
new DecimalFormat("#.00").format(value.movePointLeft(6)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T19:18:31.257

这是我创建的 NumberFormat 的一个子类。看起来它可以完成工作，但我不完全确定这是最好的方法：

```
private static final NumberFormat MILLIONS = new NumberFormat()
{
    private NumberFormat LOCAL_REAL = new DecimalFormat("#,##0.00M");

    public StringBuffer format(double number, StringBuffer toAppendTo, FieldPosition pos)
    {
        double millions = number / 1000000D;
        if(millions > 0.1) LOCAL_REAL.format(millions, toAppendTo, pos);

        return toAppendTo;
    }

    public StringBuffer format(long number, StringBuffer toAppendTo, FieldPosition pos)
    {
        return format((double) number, toAppendTo, pos);
    }

    public Number parse(String source, ParsePosition parsePosition)
    {
        throw new UnsupportedOperationException("Not implemented...");
    }
}; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-09T19:27:07.570

为什么不简单呢？

```
DecimalFormat df = new DecimalFormat("0.00M");
System.out.println(df.format(n / 1000000)); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-08-30T06:50:51.383

对于希望将给定数字转换为人类可读形式的人。

```
public static String getHumanReadablePriceFromNumber(long number){

    if(number >= 1000000000){
        return String.format("%.2fB", number/ 1000000000.0);
    }

    if(number >= 1000000){
        return String.format("%.2fM", number/ 1000000.0);
    }

    if(number >= 100000){
        return String.format("%.2fL", number/ 100000.0);
    }

    if(number >=1000){
        return String.format("%.2fK", number/ 1000.0);
    }
    return String.valueOf(number);

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T19:11:39.277

看看[ChoiseFormat](http://java.sun.com/j2se/1.5.0/docs/api/java/text/ChoiceFormat.html)。

更简单的方法是使用自动除以 1m 的包装器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-18T14:50:45.420

现在，您应该使用 ICU's [`CompactDecimalFormat`](http://icu-project.org/apiref/icu4j/com/ibm/icu/text/CompactDecimalFormat.html)，它将本地化​​非英语语言环境的格式化结果。其他语言环境可能不使用“百万”后缀。

[此功能将是 JDK 12 中的标准 Java，](https://bugs.openjdk.java.net/browse/JDK-8188147)带有`CompactNumberFormat`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-04T23:00:35.683

在 Kotlin 语言中，您可以进行扩展功能：

```
fun Long.formatToShortNumber(): String {
    return when {
        this >= 1000000000 -> String.format("%.2fB", this / 1000000000.0)
        this >= 1000000 -> String.format("%.2fM", this / 1000000.0)
        this >= 1000 -> String.format("%.2fK", this / 1000.0)
        else -> this.toString()
    }
} 
```

# automation - 无人值守处理 - 应用程序自动化

> ID：529442
> 
> 赞同：2
> 
> 时间：2009-02-09T19:07:33.450
> 
> 标签：automation, autoit, unattended-processing

我正在寻找自动化应用程序的信息 [我犹豫推断“最佳实践”]。我特别指的是用由用户安排并“自动”执行的东西来替换通过传统手动手段[人类操作 GUI] 可预测的可重复的东西。

我们在内部使用 AutoIT 来执行自动化测试，并考虑使用相同的方法为我们的应用程序提供无人值守处理，但我们不愿意，因为用户可能会“意外”与应用程序进行交互，*同时*执行预定的“自动化”，因此“打破”自动化。

羞于在我们自己的调度程序中构建具有已知事件和固定参数来控制一组预定义的操作，我应该评估/考虑哪些方法以及需要哪些工具？

附加信息：有些人将此功能称为应用程序上下文中的“批处理”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T19:33:27.117

一般来说，自动化 UI 是一种危险的做法。对于短期问题，这可能是一个有用的技巧：我发现自己在某些情况下使用 AutoHotKey 来运行一些乏味的任务……但前提是该任务不值得编写代码来实现更改（即一次， 15 分钟任务）。

否则，您可能会因某些屏幕响应迟缓、UI 不一致等而遭受运行不一致的困扰。大多数应用程序都有可用的 API，在 99% 的情况下，不使用它比获取和使用它要痛苦得多.

在没有 UI 并且您沦为屏幕抓取/操作的不幸但可能的情况下，执行自动化测试的工具可能与您将获得的一样好。它允许您*验证*应用程序的状态（在某种程度上），从而可以建立一些安全网。此外，我会专门为这项任务配备一个工作站......键盘和鼠标被锁定，远离好奇的用户。（远程桌面或 VNC 风格的连接非常适合：您可以启动进程并断开连接，使其能够防止篡改。）

但是，我认为这种方法只是一种绝望的最后手段。操作 API 远、远、远、远（我在那里获得了足够的“远距离”吗？）更可持续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T19:30:39.293

如果我理解正确，您想使用某些工具进行自动化*处理*，该工具将在给定的软件系统中执行预定义的操作列表。这与自动化*测试*不同。

我会敦促您避免使用用于测试的工具来执行处理。许多主要的软件系统都有公共 API，您可以使用这些 API 来执行操作，而无需直接的用户交互。这是一种更强大、更可靠的方式来安排自动化流程。联系您正在使用的软件的供应商，有时 API 可根据要求提供。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T14:42:44.627

Godeke 和 Dave 是绝对正确的，如果可用，API 是最好的途径。然而，实际上这有时是不可能的，你必须走 GUI 自动化路线。除了前面提到的运行自动化的专用工作站之外，我建议在一些审计跟踪中编码，以便在出现问题时更容易调试或回溯。您的批处理自动化应该详细记录处理了哪些记录、处理时间以及处理方式。您应该设置它，以便记录本身（在本机应用程序中）反映它是通过自动化更新/处理的。例如，如果每条记录都有一个可更新的注释/评论字段，则自动化应在此字段中添加文本，例如“由自动化用户处理，2009-02-25 10:05:11 AM，

# php - 通过php传递多个值以闪烁

> ID：529447
> 
> 赞同：0
> 
> 时间：2009-02-09T19:10:33.927
> 
> 标签：php, flash

这是代码

```
<php?  
$id1 =1;
$id2 = "module 1 loaded";
echo "$var1=$id1","$var2=$id2";
?> 
```

我知道这不是正确的方法我如何将这两个变量传递给 flash

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T19:43:44.410

```
<?php

echo http_build_query( array(
     'var1' => 1
    ,'var2' => 'module 1 loaded'
)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T19:22:36.223

如果你想创建一个脚本来输出可以用[LoadVariables](http://www.adobe.com/support/flash/action_scripts/actionscript_dictionary/actionscript_dictionary425.html)或[LoadVars](http://www.adobe.com/support/flash/action_scripts/actionscript_dictionary/actionscript_dictionary427.html)加载的数据，你需要这样的东西

```
//set up your values 
$vars=array();
$vars['foo']='bar';
$vars['xyz']='123';

//output     
header ("Content-Type: application/x-www-urlformencoded");
$sep="";
foreach($vars as $name=>$val)
{
    echo $sep.$name."=".urlencode($val);
    $sep="&";
} 
```

如果您的 PHP 版本支持它，[http_build_query](http://php.net/http_build_query)会更容易：

```
$vars=array();
$vars['foo']='bar';
$vars['xyz']='123';

header ("Content-Type: application/x-www-urlformencoded");
echo http_build_query($vars); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T19:35:22.853

Paul Dixon 的代码片段是您在 PHP 方面所需要的。这是闪光部分：

```
myVars = new LoadVars(); 
myVars.load("http://localhost/foo.php");

myVars.onLoad = function (success) {
     if (success) {
        for( var attr in this ) {
            trace (" key " + attr + " = " + this[attr]); 
        }
    } else {
        trace ("LoadVars Error"); 
    }
} 
```

请注意，您将希望用您的应用程序需要的任何内容替换循环逻辑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T19:24:14.473

它不应该只是查询字符串的形式吗：

```
echo $var1.'='.$id1.'&'.$var2.'='.$id2; 
```

确保键和值是 urlencoded。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-05T03:40:13.940

PHP代码：

```
<php?  
$id1 =1;
$id2 = "module 1 loaded";

print "&var1=$id1";
print "&var2=$id2";

?> 
```

我相信这会奏效...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-05T03:50:41.640

闪码：

```
btn.onPress = function(){

   testLoadVars = new LoadVars();

   testLoadVars.onLoad = function(success){

      if(success){
         trace(testLoadVars.var1);
         trace(testLoadVars.var2);
      }
      else
         trace("error");
   }
   testLoadVars.sendAndLoad("http://localhost/filename.php?uniqueID=" +  getTimer(),testLoadVars,"POST");

} 
```

仅此而已..遇到任何问题吗？

# .net - 在 NAnt 中，我可以创建 VS 项目中列出的文件的文件集吗？

> ID：529450
> 
> 赞同：3
> 
> 时间：2009-02-09T19:10:56.907
> 
> 标签：.net, build-process, build-automation, nant, nantcontrib

我正在重写我们的[NAnt](http://nant.sourceforge.net/)构建脚本，以使它们更简洁、更通用。

我们构建过程中的步骤之一是将某些文件打包成一个 zip 文件。在我们创建一个[`fileset`](http://nant.sourceforge.net/release/latest/help/types/zipfileset.html)包含大量文件类型的文件之前，试图捕捉项目中可能存在的所有内容。当我们想在项目中包含非标准文件类型时，这偶尔会导致问题。

我希望我能找到一种方法来创建[`fileset`](http://nant.sourceforge.net/release/latest/help/types/zipfileset.html)基于Visual Studio 项目文件 (.csproj) 中列出的文件（以及文件的*子集）的方法。*[`zip`](http://nant.sourceforge.net/release/latest/help/tasks/zip.html)然后我可以在任务中使用这个文件集。我还没有找到任何可以自动执行此操作的东西（尽管[NAntContrib](http://nantcontrib.sourceforge.net/)[`SLiNgshoT`](http://nantcontrib.sourceforge.net/release/latest/help/tasks/slingshot.html)中现已弃用的任务看起来有点有希望）。

我开始尝试手动执行此操作，但被卡住了。我有一个从解决方案中获取项目的目标（使用[`regex`](http://nant.sourceforge.net/release/latest/help/tasks/regex.html)），然后尝试使用[`xmlpeek`](http://nant.sourceforge.net/release/latest/help/tasks/xmlpeek.html)（使用 XPath 查询`/n:Project/n:ItemGroup/n:Content/@Include`）获取项目中的每个内容文件。这里的问题是它[`xmlpeek`](http://nant.sourceforge.net/release/latest/help/tasks/xmlpeek.html)不会返回每个值，只返回第一个值。而且，即使它确实返回了每个值，我也不确定如何[`fileset`](http://nant.sourceforge.net/release/latest/help/types/zipfileset.html)从这里把它变成 a 。

有没有办法挽救这种思维轨迹？我可以通过自定义 NAnt 任务完成我想要的吗（我不希望每个项目都依赖于自定义任务）？是否有一些我没有找到的内置方法来做到这一点？

如果我的目标或方法不清楚，请随时在评论中提问。

谢谢！

* * *

**更新：**澄清一下，我的观点是让整个过程更加无缝。虽然我可以轻松地将所有 .xml 文件添加到包中，但这通常会获得位于同一文件夹中但实际上并不是项目的一部分的 .xml 文件。当我已经有了项目使用的文件列表（甚至在内容和其他类型之间分开）时，不使用这些信息似乎很可惜。最终，任何人都不应该接触构建文件来更改包中包含的内容。对我来说，这似乎不是一个白日梦……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T21:18:35.973

请参阅[此相关问题](https://stackoverflow.com/questions/441614/how-to-query-msbuild-file-for-list-of-supported-targets)。microsoft.build.buildengine 界面应该可以让您更好地访问所需的信息，但不幸的是，我认为您必须构建自定义任务。

但是我认为解析一个项目文件以生成一个在其他地方使用的文件集是......将所有内容都放在构建脚本中有点多。而且由于您似乎想重用它，我认为依赖自定义任务并不比任何其他形式的重用更糟糕（即使您可以在现有的 Nant 任务中完成所有操作，您也会仍然需要让每个项目以某种方式继承该过程）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T21:49:28.410

至于阅读你的项目文件。我以前做过这样的事情。我最终只是编写了一个程序来读取项目文件并按项目构建文件构建一个自定义项目。

但是我试图编译我的代码库。看起来你只是想压缩它。

考虑到 Zip 任务将允许您在其中运行多个文件集，您可以创建一些通用文件集，然后轻松地为您的特定文件集进行更新。

所以你可以有这样的东西：

```
<fileset id="project.source.objects">
  <include name="**/*.cs"/>
  <include name="**/*.xml"/>
  <include name="**/*.resx"/>
</fileset>

<fileset id="project.misc.sources">
  <include name="MyFile1.someext"/>
</fileset> 
```

然后在您的 zip 目标中放入：

```
<zip zipfile="myzip.zip">
  <fileset refid="project.source.objects"/>
  <fileset refid="project.misc.sources"/>
</zip> 
```

现在，如果您想要项目细节。你还可以做另一件事。如果您使用的是 VS2005 或更高版本，请在 T4 上搜索。它是一个用于创建插件的模板框架，允许您在执行某些操作时生成额外的文件。有点像当你做一个类图或有一个 XSD（它得到它的代码隐藏文件，它是通过这种方式完成的）。

在我从事的大多数项目中，我们为每个项目维护一个构建文件并保持最新。由于我们有一个开始的通用文件集，所以我们只需要为晦涩的东西更新文件。

希望有帮助。如果您可以提供更多详细信息，我可能会提供进一步的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T22:13:37.983

我喜欢乔希想法的第一部分。

编写一个小型控制台应用程序以从 .csproj 中提取文件（因为它只是其中的 XML）并将列表写入文件。

代替 NAnt 的 zip 任务，我将使用[7-zip](http://www.7-zip.org/)来创建包含您在上一步中生成的列表的存档：

（我在这里创建一个自解压档案）

```
<target name="ZipBuild">
  <exec program="${SevenZip}" workingdir="${SolutionPath}/Installation/Build.Staging">
    <arg value="a" />
    <arg value="-sfx" />
    <arg value="ReferenceBuild-${build.number}.exe" />
    <arg value="@mycustomfilelist.txt" />
  </exec>
</target> 
```

希望有帮助，

-杰森

# java - Java矩阵数学库的性能？

> ID：529457
> 
> 赞同：153
> 
> 时间：2009-02-09T19:12:03.783
> 
> 标签：java, math, matrix, performance

我们正在计算一些运行时间受矩阵运算约束的东西。（如果有兴趣，下面的一些细节。）这次经历引发了以下问题：

人们对矩阵数学（例如，乘法、逆运算等）的 Java 库的性能有经验吗？例如：

*   [美国医学会杂志](http://math.nist.gov/javanumerics/jama/)
*   [小马](http://acs.lbl.gov/~hoschek/colt/)
*   [阿帕奇公共数学](http://commons.apache.org/math/)

我搜索并一无所获。

* * *

我们的速度比较的详细信息：

我们正在使用英特尔 FORTRAN (ifort (IFORT) 10.1 20070913)。我们使用 Apache commons math 1.2 矩阵运算在 Java (1.6) 中重新实现了它，并且它同意它的所有数字精度。（我们有理由在 Java 中使用它。）（Java doubles，Fortran real*8）。Fortran：6 分钟，Java 33 分钟，同一台机器。jvisualm 分析显示在 RealMatrixImpl.{getEntry,isValidCoordinate} 中花费了很多时间（这似乎在未发布的 Apache commons math 2.0 中消失了，但 2.0 并没有更快）。Fortran 正在使用 Atlas BLAS 例程（dpotrf 等）。

显然，这可能取决于我们在每种语言中的代码，但我们相信大部分时间都是在等效矩阵运算中。

在其他几个不涉及库的计算中，Java 并没有慢很多，有时甚至快得多。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2011-12-09T04:13:09.620

我是 Java Matrix Benchmark ( [JMatBench](http://lessthanoptimal.github.io/Java-Matrix-Benchmark/) ) 的作者，我将就此讨论发表我的看法。

Java 库之间存在显着差异，虽然在整个操作范围内没有明显的赢家，但从[最新的性能结果](http://lessthanoptimal.github.io/Java-Matrix-Benchmark/runtime/2013_10_Corei7v2600/)（2013 年 10 月）中可以看出，有一些明显的领先者。

如果您正在使用“大型”矩阵并且可以使用本机库，那么明显的赢家（大约快 3.5 倍）是具有[系统优化 netlib的](https://github.com/fommil/netlib-java/)[MTJ](https://github.com/fommil/matrix-toolkits-java/)。如果您需要纯 Java 解决方案，那么[MTJ](https://github.com/fommil/matrix-toolkits-java/)、[OjAlgo](http://ojalgo.org/)、[EJML](http://ejml.org/)和[Parallel Colt](https://sites.google.com/site/piotrwendykier/software/parallelcolt)是不错的选择。对于小型矩阵，EJML 显然是赢家。

我没有提到的库显示出严重的性能问题或缺少关键功能。

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2010-06-17T20:11:20.960

只是加我的 2 美分。我比较了其中一些库。我试图将一个 3000 x 3000 的双精度矩阵与自身矩阵相乘。结果如下。

使用带有 C/C++、Octave、Python 和 R 的多线程 ATLAS，所用时间约为 4 秒。

使用 Jama 和 Java，所用时间为 50 秒。

在 Java 中使用 Colt 和 Parallel Colt，耗时 150 秒！

将 JBLAS 与 Java 结合使用，由于 JBLAS 使用多线程 ATLAS，所花费的时间再次约为 4 秒。

所以对我来说，很明显 Java 库的性能不太好。但是，如果有人必须用 Java 编写代码，那么最好的选择是 JBLAS。Jama、Colt 和 Parallel Colt 并不快。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2010-01-31T22:10:30.647

我是 jblas 的主要作者，我想指出我在 2009 年 12 月下旬发布了 1.0 版。我在打包方面做了很多工作，这意味着您现在可以下载一个带有 ATLAS 和 JNI 库的“胖 jar”适用于 Windows、Linux、Mac OS X、32 位和 64 位（Windows 除外）。这样，您只需将 jar 文件添加到类路径即可获得本机性能。[在http://jblas.org](http://jblas.org)上查看！

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-02-05T07:48:01.413

我刚刚将 Apache Commons Math 与 jlapack 进行了比较。

测试：随机 1024x1024 矩阵的奇异值分解。

机器：Intel(R) Core(TM)2 Duo CPU E6750 @ 2.66GHz，linux x64

八度码：A=rand(1024)；tic;[U,S,V]=svd(A);toc

```
结果执行时间
-------------------------------------------------- --------
八度音阶 36.34 秒

JDK 1.7u2 64位
    jlapack dgesvd 37.78 秒
    apache commons 数学 SVD 42.24 秒

JDK 1.6u30 64位
    jlapack dgesvd 48.68 秒
    apache commons 数学 SVD 50.59 秒

本机例程
从 C 调用的 Lapack*：37.64 秒
英特尔 MKL 6.89 秒（！）

```

我的结论是，从 JDK 1.7 调用的 jlapack 非常接近 lapack 的本机二进制性能。我使用了 linux 发行版附带的 lapack 二进制库，并调用了 dgesvd 例程来获取 U、S 和 VT 矩阵。所有测试都是在每次运行完全相同的矩阵上使用双精度完成的（Octave 除外）。

免责声明 - 我不是线性代数方面的专家，不隶属于上述任何库，这不是一个严格的基准。这是一个“自制”测试，因为我有兴趣比较 JDK 1.7 到 1.6 的性能提升以及 commons math SVD 到 jlapack。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-09T20:45:21.437

我不能真正评论特定的库，但原则上没有理由让这些操作在 Java 中变慢。Hotspot 通常会做你期望编译器做的事情：它将 Java 变量的基本数学运算编译为相应的机器指令（它使用 SSE 指令，但每个操作只有一个）；如您所料，对数组元素的访问被编译为使用“原始” MOV 指令；它决定如何在可能的情况下将变量分配给寄存器；它重新排序指令以利用处理器架构......一个可能的例外是，正如我所提到的，Hotspot 将只执行每个 SSE 指令的一个操作；原则上，您可以拥有一个经过优化的矩阵库，每条指令执行多个操作，尽管我没有 不知道您的特定 FORTRAN 库是否这样做，或者是否存在这样的库。如果是这样，Java（或至少，Hotspot）目前没有办法与之竞争（尽管您当然可以编写自己的本机库并使用这些优化从 Java 调用）。

那么，这意味着什么？好：

*   原则上，值得四处寻找性能更好的库，但不幸的是我不能推荐一个
*   如果性能对您来说真的很重要，我会考虑只编写您自己的矩阵运算，因为这样您就可以执行某些库通常无法执行的优化，或者您使用的特定库不能执行的优化（如果您有多处理器机器，看看这个库是否真的是多线程的）

矩阵运算的一个障碍通常是当您需要逐行和逐列遍历时出现的数据局部性问题，例如在矩阵乘法中，因为您必须以优化其中一个或另一个的顺序存储数据。但是，如果您手动编写代码，您有时可以**组合操作以优化数据局部性**（例如，如果您将矩阵乘以其变换，如果您编写专用函数而不是组合，则可以将列遍历转换为行遍历两个库函数）。像往常一样，库会给你非最佳性能以换取更快的开发；您需要确定性能对您有多重要。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-10-04T06:28:25.640

杰根[https://github.com/hughperkins/jeigen](https://github.com/hughperkins/jeigen)

*   包装 Eigen C++ 库[http://eigen.tuxfamily.org](http://eigen.tuxfamily.org)，这是可用的最快的免费 C++ 库之一
*   相对简洁的语法，例如'mmul'、'sub'
*   处理密集和稀疏矩阵

快速测试，通过将两个密集矩阵相乘，即：

导入静态jeigen.MatrixUtil.*；

```
int K = 100;
int N = 100000;
DenseMatrix A = rand(N, K);
DenseMatrix B = rand(K, N);
Timer timer = new Timer();
DenseMatrix C = B.mmul(A);
timer.printTimeCheckMilliseconds(); 
```

结果：

```
Jama: 4090 ms
Jblas: 1594 ms
Ojalgo: 2381 ms (using two threads)
Jeigen: 2514 ms 
```

*   与 jama 相比，一切都更快：-P
*   与 jblas 相比，Jeigen 没有那么快，但它可以处理稀疏矩阵。
*   与 ojalgo 相比，Jeigen 所花费的时间大致相同，但只使用一个核心，因此 Jeigen 使用了总 CPU 的一半。Jeigen 的语法更简洁，即“mmul”与“multiplyRight”

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-10-03T06:18:22.860

对于一些不同的硬件配置， [http://code.google.com/p/java-matrix-benchmark/](http://code.google.com/p/java-matrix-benchmark/)上有java 中可用的各种矩阵包的基准测试 。但它不能替代做自己的基准测试。

性能会因您拥有的硬件类型（cpu、内核、内存、L1-3 缓存、总线速度）、矩阵大小和您打算使用的算法而异。不同的库对不同算法的并发性有不同的看法，因此没有单一的答案。您可能还会发现，转换为本地库所期望的形式的开销抵消了您的用例的性能优势（一些 Java 库在矩阵存储方面具有更灵活的选项，可用于进一步的性能优化）。

不过一般来说，JAMA、Jampack 和 COLT 都在变老，并不代表 Java 中线性代数当前可用的性能状态。更现代的库更有效地利用了多核和 cpu 缓存。JAMA 是一个参考实现，几乎实现了教科书算法，很少考虑性能。COLT 和 IBM Ninja 是第一个证明 java 性能是可能的 java 库，即使它们落后于本地库 50%。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-10-04T05:51:37.183

我是[la4j](http://la4j.org)（Java 的线性代数）库的作者，这是我的观点。我已经在 la4j 上工作了 3 年（最新版本是 0.4.0 [2013 年 6 月 1 日]），直到现在我才可以开始进行性能分析和优化，因为我刚刚介绍了所需的最低功能。所以，la4j 没有我想要的那么快，但我花了很多时间来改变它。

我目前正在将新版本的 la4j 移植到[JMatBench](http://code.google.com/p/java-matrix-benchmark/)平台。我希望新版本能显示出比前一个更好的性能，因为我在 la4j 中做了一些改进，例如更快的内部矩阵格式、不安全的访问器和矩阵乘法的快速阻塞算法。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-09T19:45:21.923

您看过[英特尔数学核心库](https://software.intel.com/en-us/intel-mkl?wapkw=intel%20math%20kernel%20library&wapkwg=featured)吗？它声称甚至优于[ATLAS](http://math-atlas.sourceforge.net/)。MKL 可以通过 JNI 包装器[在 Java中使用。](https://software.intel.com/en-us/articles/performance-tools-for-software-developers-how-do-i-use-intel-mkl-with-java)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-09T21:04:04.623

Linalg 代码严重依赖 Pentium 和更高版本的处理器的矢量计算能力（从 MMX 扩展开始，如 LAPACK 和现在的 Atlas BLAS）并不是“非常优化”，而只是行业标准。要在 Java 中复制这种性能，您将需要本机库。我遇到了与您描述的相同的性能问题（主要是为了能够计算 Choleski 分解）并且没有发现任何真正有效的东西：Jama 是纯 Java，因为它应该只是实现者遵循的模板和参考工具包。 ..这从未发生过。你知道 Apache 数学公用... 至于 COLT，我仍然需要对其进行测试，但它似乎严重依赖于 Ninja 的改进，其中大部分是通过构建一个临时 Java 编译器来实现的，所以我怀疑它是否会有所帮助。那时，我认为我们“

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-09T22:38:22.197

以 Varkhan 的帖子为基础，奔腾特定的本机代码会做得更好：

*   jBLAS：一个带有用于 Atlas 的 JNI 包装器的 alpha 阶段项目：[http](http://www.jblas.org) ://www.jblas.org 。

    *   作者的博文：http: [//mikiobraun.blogspot.com/2008/10/matrices-jni-directbuffers-and-number.html](http://mikiobraun.blogspot.com/2008/10/matrices-jni-directbuffers-and-number.html)。
*   MTJ：另一个这样的项目：[http ://code.google.com/p/matrix-toolkits-java/](http://code.google.com/p/matrix-toolkits-java/)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-12T15:55:31.990

我们已经使用 COLT 进行了一些相当大的严肃财务计算，并且对它非常满意。在我们的大量配置代码中，我们几乎从未用我们自己的实现替换 COLT 实现。

在他们自己的测试中（显然不是独立的），我认为他们声称是英特尔手动优化的汇编程序例程的 2 倍。使用它的诀窍是确保您了解他们的设计理念，并避免无关的对象分配。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-18T18:49:31.400

我发现，如果您正在创建大量高维矩阵，如果将 Jama 更改为使用一维数组而不是二维数组，您可以让 Jama 快 20%。这是因为 Java 不能有效地支持多维数组。IE。它创建一个数组数组。

Colt 已经这样做了，但我发现它比 Jama 更复杂、更强大，这可以解释为什么 Colt 的简单函数更慢。

答案真的取决于你在做什么。Jama 不支持 Colt 可以做的事情的一小部分，这些事情会产生更大的影响。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-07-20T05:32:28.797

您可能想查看[jblas](http://jblas.org/)项目。这是一个相对较新的 Java 库，它使用 BLAS、LAPACK 和 ATLAS 进行高性能矩阵运算。

开发人员已经发布了一些[基准](http://blog.mikiobraun.de/2009/04/some-benchmark-numbers-for-jblas.html)，其中 jblas 与 MTJ 和 Colt 相比有优势。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-02-24T02:43:59.983

对于 3d 图形应用程序，lwjgl.util 矢量实现的性能优于上述 jblas 约 3 倍。

我已经完成了 vec4 与 4x4 矩阵的 100 万次矩阵乘法。

lwjgl 大约 18ms 完成，jblas 大约需要 60ms。

（我认为，JNI 方法不太适合快速连续应用相对较小的乘法。因为转换/映射可能比实际执行乘法需要更多时间。）

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-07-20T05:48:39.437

还有[UJMP](http://www.ujmp.org/)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-18T12:11:46.477

有许多不同的免费可用的 java 线性代数库。[http://www.ujmp.org/java-matrix/benchmark/](http://www.ujmp.org/java-matrix/benchmark/) 不幸的是，该基准只为您提供有关矩阵乘法的信息（转置测试不允许不同的库利用它们各自的设计特性）。

你应该看看这些线性代数库在被要求计算各种矩阵分解时的表现。 [http://ojalgo.org/matrix_compare.html](http://ojalgo.org/matrix_compare.html)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-07-08T15:30:38.567

Matrix Tookits Java (MTJ) 之前已经提到过，但对于其他偶然发现该线程的人来说，也许值得再次提及。对于那些感兴趣的人，似乎还有人谈论让 MTJ 替换[apache commons math 2.0](http://www.nabble.com/commons-math%2C-matrix-toolkits-java-and-consolidation-to23537813.html#a23574199)中的 linalg 库，尽管我不确定最近进展如何。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-04-24T22:43:37.487

您应该将 Apache Mahout 添加到您的购物清单中。

# macos - 如何让 ctags 获取 .h 文件中的函数？

> ID：529460
> 
> 赞同：0
> 
> 时间：2009-02-09T19:12:53.907
> 
> 标签：macos, ctags

我正在使用 Exuberant Ctags 5.7。我正在尝试为 CGContext.h 构建一个标签数据库：

```
标签 /System/Library/Frameworks/ApplicationServices.framework/Frameworks/CoreGraphics.framework/Headers/CGContext.h

```

生成的标签文件中不包含任何功能。它只有 75 行类型和枚举。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T19:30:13.193

您需要添加--c-types=+p（现在是--c-kinds）。

# scheduled-tasks - 在 Vista 中安排任务 - 系统重启

> ID：529464
> 
> 赞同：1
> 
> 时间：2009-02-09T19:14:03.827
> 
> 标签：scheduled-tasks, windows-vista

我正在尝试为 Windows Vista 编写系统重启任务。我是一名网络开发人员，所以我在这里有点不适应。我已经进入我的操作系统并发现了任务计划程序。

到目前为止，我已经能够通过调用 *.exe 文件来设置一些不同的任务来运行小型 WPF 程序。我真正需要做的是在特定时间设置系统重启。以凌晨 1 点为例。

有没有办法编写一个简单的 shell 脚本来强制重启 Windows Vista 作为计划任务？

我担心的是，当您重新启动时，Vista 通常会要求关闭程序，所以我想确保它确实是自动的，需要零用户交互。

任何帮助或示例链接将不胜感激。

系统：Windows Vista 32bit

干杯，瑞恩

**答案：**将所选答案中的代码复制并粘贴到文本文件中。

```
shutdown -r -f -t 01 
```

将文件另存为 *.bat 文件。然后，您可以在任务计划程序的“操作”选项卡中选择它。奇迹般有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T19:21:50.017

执行

> 关机 -r -f -t 01

将在 1 秒内重新启动 Windows。

# java - 在 Oracle 中为 Java 存储过程设置类路径

> ID：529471
> 
> 赞同：7
> 
> 时间：2009-02-09T19:16:53.740
> 
> 标签：java, oracle, stored-procedures

我有一个 Oracle 10g 数据库，还有一个第三方 jar 文件。我希望能够在我的数据库中运行 SQL 选择查询，该查询最终在我的第三方库中运行代码以检索信息以包含在 SQL 结果集中。我看到很多关于“Java 存储过程”的教程，这些似乎是一种很有前途的方法，但似乎没有一个使用第三方库，而且我似乎无法弄清楚如何为我的 jar 指定类路径我在 Oracle 中运行时将识别的文件。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-09T19:55:05.677

您可以使用 loadjava 工具将 JAR 文件加载到数据库中。此工具还接受 .class、.java、.properties、.sqlj、.ser、.jar 或 .zip 文件。

有关详细信息，请参阅手册 ( [http://docs.oracle.com/cd/B19306_01/java.102/b14187/cheleven.htm#CACFHDJE](http://docs.oracle.com/cd/B19306_01/java.102/b14187/cheleven.htm#CACFHDJE) )。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T19:24:07.670

尝试将 jar 添加到 Windows/Unix CLASSPATH 系统变量。

# java - 无法从 java 运行 ksh 脚本：java.io.IOException: .: not found

> ID：529474
> 
> 赞同：1
> 
> 时间：2009-02-09T19:17:24.193
> 
> 标签：java, unix, shell

我试图从 java 代码运行 shell 脚本，但我遇到了问题。该脚本位于 batchstart.sh 文件中 -

```
#!/bin/ksh
export DISPLAY=:0.0 
```

现在脚本在命令行上运行一个点 -- 。批处理启动.sh

我如何从java运行它？我的java代码如下。它引发以下异常 -

```
java.io.IOException: .: 未找到
    在 java.lang.UNIXProcess.forkAndExec（本机方法）
    在 java.lang.UNIXProcess.<init>(UNIXProcess.java:102)
    在 java.lang.ProcessImpl.start(ProcessImpl.java:65)
    在 java.lang.ProcessBuilder.start(ProcessBuilder.java:451)
    在 java.lang.Runtime.exec(Runtime.java:591)
    在 java.lang.Runtime.exec(Runtime.java:429)
    在 SetDisplay.main(SetDisplay.java:12)

```

```
import java.io.*;

public class SetDisplay {

   public static void main(String[] args) {

       File wd = new File("/myhomedir/");
       System.out.println("Working Directory: " +wd);
       Process proc = null;

       try {
           proc = Runtime.getRuntime().exec(". batchstart.sh", null, wd);
       } catch (Exception e) {
           e.printStackTrace();
       }
   }
} 
```

如何使 shell 脚本运行？

我也尝试了以下代码，但这也不起作用。

```
File wd = new File("/bin"); 
System.out.println(wd); 
Process proc = null; 
try { 
  proc = Runtime.getRuntime().exec("/bin/bash", null, wd); 
} 
catch (IOException e) { 
  e.printStackTrace(); 
} 
if (proc != null) { 
  BufferedReader in = new BufferedReader(new InputStreamReader(proc.getInputStream())); 
  PrintWriter out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(proc.getOutputStream())), true); 
  out.println("cd /home/"); 
  out.println(". batchstart.sh"); 
  out.println("exit"); 
  try { 
    String line; 
    while ((line = in.readLine()) != null) { 
      System.out.println(line); 
    } 
    proc.waitFor(); 
    in.close(); 
    out.close(); 
    proc.destroy(); 
  } 
  catch (Exception e) { 
    e.printStackTrace(); 
  } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T19:24:31.927

源命令 (" `.`") 是一个内置的 shell。您必须显式运行`/bin/ksh`，将您的脚本名称作为参数传递（后跟任何脚本参数）。

如果您**需要**获取脚本，则会遇到更大的问题。这通常意味着环境更改发生在当前 shell 的上下文中，而不是子 shell 中。

这不适用于 Java，因为 Java 不是 shell。您需要弄清楚如何使用 Java 更改环境。

当然，如果我错了，并且该脚本还有更多仅设置 DISPLAY 的内容，它可能会按建议工作。

您将必须使用的方法取决于您要实现的目标（如“您是否使用 exec() 运行依赖于设置的 DISPLAY 的其他程序？”或“您的 Java 程序是否需要 DISPLAY放？”）。

如果，正如您在评论中所说，只有您的 Java 程序需要 DISPLAY 设置，只需在程序运行之前将其设置在外部。创建一个设置 DISPLAY 变量的 cmd（或 bash）文件，**然后**调用 JRE 来运行您的程序。

```
#/bin/ksh
export DISPLAY-:0.0
/usr/bin/jre/java your_program blah.blah.blah 
```

我还会修改您的`main()`内容以检查它是否设置为某些内容，如果没有则优雅地退出：

```
if (System.getenv ("DISPLAY") == null)
    // doesn't exist, exit gracefully. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T19:26:04.187

从命令行运行时，在脚本开头使用一个点表示该脚本应该在*当前*环境中运行，而不是生成新的子 shell 并使用当前环境的新*副本*。这允许您导出环境变量的新值，以供稍后从同一交互式 shell 运行的命令使用。

显然，这种技术只有在您`batchstart.sh`从实际的 shell 运行脚本时才有效。Java 不知道这种机制是如何工作的，因此点对它没有任何意义。脚本不能修改调用它的 Java 进程的环境。

如果您的目标是更改 Java 进程运行的其他命令的 DISPLAY 环境变量的值，请考虑使用[`ProcessBuilder`](http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html)该类为子进程指定新环境。Java 不包含在其自身环境中修改变量的内置方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T19:24:43.067

时期 ”。” 是一个内置的 shell，并“就地”执行脚本，类似于 C/C++ 中的#include。使用 ”。” 在 shell 脚本之外没有任何意义。

如果要从 Java**运行**脚本，则必须执行脚本解释器 (/bin/ksh)：

```
 Runtime.getRuntime().exec("/bin/ksh batchstart.sh", ...) 
```

但请注意，这在语义上并不等效，因为您将 batchstart.sh 作为子进程执行，而不是采购它。

# .net - Visual Xml 到 .net 对象映射器

> ID：529477
> 
> 赞同：2
> 
> 时间：2009-02-09T19:18:55.623
> 
> 标签：.net, xml, xml-serialization, xsd, mapping

大家好：我必须将我的数据，实际上是整个域模型结构导出到一个正式的 xml 文件中。有谁知道我可以用来将 xml 模式映射到我的 .NET 对象模型的可视化工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T19:08:05.423

将对象导出到 xml 的最简单方法是使用`<Serializalbe>`属性标记每个类。然后调用`XmlSerializer.Serialize()`。

您还可以使用 .xml 将 xml 重新导入到您的对象中`XmlSerializer.Deserialize()`。

如果您需要一个架构，那么您可以使用 xsd.exe 使用以下任一方式生成它：

1.  类库本身：`xsd.exe myClassLibrary.dll`
2.  调用 XmlSerializer.Deserialize() 生成的 xml 文件：`xsd.exe myFile.xml`

有关详细信息，请参阅[xsd.exe](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.80).aspx)和[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer(VS.71).aspx)的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T19:32:56.633

另一种方法很简单：您可以使用 xsd.exe 从 XSD 模式生成 .Net 数据绑定类模型。

但是在 .Net 中采用任意对象模型并将其序列化为 XML - 我什至不确定这是否可能。您的某些类型必然比您可以在 XML 中表示的类型更复杂。因此，从 XML 方面开始，似乎是必要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T16:28:26.733

其他人指出了 Visual Studio 中的 XSD 支持。这有一个视觉设计器，但它不会映射到您的类 - 它可以创建强类型对象。

XMLSerialization 在某些情况下非常有用：1）数据传输（Web 服务）2）节省原型时间。我强烈建议不要将对象的直接 XML 序列化作为持久性机制（永久存储）。当您需要更改架构时，这将是痛苦的。是的，有理论上的解决方案，我从未见过它们在实践中很容易工作。我在维护（和重新设计）快速序列化解决方案时感到很痛苦，对此我有强烈的感觉:)

问题是为什么要导出域模型？这只是一个导出功能吗？如果是这样，序列化可能很棒。您可能找不到执行此操作的可视化工具。但是，创建带有类属性的正式、甚至漂亮的 XML 通常很容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T02:18:51.107

我知道 .NET 框架中不支持这种情况。

我会开始研究反射，遍历所有类型及其成员，在 XML 中发出相应的描述。

# objective-c - Objective-C 指针？

> ID：529482
> 
> 赞同：12
> 
> 时间：2009-02-09T19:19:53.640
> 
> 标签：objective-c, oop, pointers

我是编码新手，并试图跟上 Objective-C 的速度。遇到一些我不明白的代码。我希望有人可以为我澄清。在下面的情况下，我不确定 *foo2 是如何工作的以及为什么它没有被释放？

```
ClassOne *pointer = [[ClassOne alloc]init];

ClassTwo *foo = [[ClassTwo alloc]init], *foo2; 

 foo2 = [foo add: pointer];
 [foo release]; 
 foo = foo2

[pointer release];

[foo release]; 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-09T20:30:30.617

使用 Objective-C Cocoa，我们正在使用半自动引用计数内存管理。为对象分配内存、保留对象或调用对象的`copy`方法时，保留计数（引用计数）加 1。调用`release`对象时，保留计数减 1。当调用`autorelease`一个对象时，`release`将在将来的某个时候调用该对象（在主运行循环期间，当您自己的代码都没有执行时，因此它不会像您一样从您下面拉出引用尝试使用它）。当保留计数达到 0 时，可以释放对象。

一般来说，如果你调用`retain`一个对象，你就是在发出你对它感兴趣的信号，并且你有责任在你不再对该对象感兴趣的某个时候发出`release`或调用。`autorelease`同样，如果您在对象上调用`alloc`或`copy`方法，则表明您对该对象感兴趣，并且必须将其与 a`release`或`autorelease`某处相匹配。

此链接几乎涵盖了 Apple 使用（并且您应该使用）内存管理的指南： [Simple rules for memory management in Cocoa](http://www.stepwise.com/Articles/Technical/2001-03-11.01.html "Cocoa 中内存管理的简单规则")

让我们逐行浏览代码：

> ```
> ClassOne *pointer = [[ClassOne alloc]init]; 
> ```

`pointer`指向一个新分配的 ClassOne 对象，保留计数为 1，因为我们在其上调用了 alloc。我们有责任在未来的某个时候打电话或打电话`release`。`autorelease``pointer`

> ```
> ClassTwo *foo = [[ClassTwo alloc]init], *foo2; 
> ```

`foo`指向一个新分配的 ClassTwo 对象，保留计数为 1，因为我们在其上调用了 alloc。我们有责任在未来的某个时候打电话或打电话`release`。`autorelease``foo`

`foo2`现在没有特别指出任何事情。使用起来不安全。

> ```
> foo2 = [foo add: pointer]; 
> ```

`pointer`已添加到`foo`（无论这意味着什么；我们不知道实现）。 `foo`可能已经调用`retain`来`pointer`表示它对它的兴趣，并将其添加为一个字段，或者它可能已经添加到一个集合中（在这种情况下，当一个对象被添加和一个对象被删除时`pointer`，集合有责任调用它）。无论如何，它不会影响我们的代码块，所以我们不关心引擎盖下发生了什么`retain``release`

此方法返回的引用可能是`pointer`它本身，也可能是 ; 的自动发布副本`pointer`。我们无权访问 API 或实现来告诉我们哪个。

`release`在任何一种情况下，调用这个对象都不是我们的责任。如果方法`copy`名称中有，或者如果我们调用`retain`了返回的引用（如`foo2 = [[foo add:pointer] retain];`），那么保留计数将增加 1，并且我们有责任调用`release`它`autorelease`。

> ```
> [foo release]; 
> ```

引用的对象`foo`已被释放，这意味着它的保留计数已减 1。对于此示例，这与`alloc`我们在第 2 行中进行的调用配对，因此保留计数将降至 0，从而`foo`有资格被释放。

不过，一般来说，我们并不关心对象是否已被释放。我们只需要确保将任何`alloc`, `copy`, or`retain`呼叫与相同数量的`release`or`autorelease`呼叫配对。如果我们在任何时候注册一个对象的兴趣，我们就有责任释放我们的兴趣，否则我们就会有内存泄漏。

> ```
>  foo = foo2; 
> ```

`foo`现在指向 . 引用的同一个对象`foo2`。请记住，当我们得到 时，我们没有调用`alloc`or`copy`方法`foo2`，也没有通过调用来注册对它的兴趣`retain`。既然我们没有召唤的责任`release`，`foo2`我们就没有召唤的`release`责任`foo`。

> ```
> [pointer release]; 
> ```

`pointer`的保留计数已减 1。这可能使其保留计数为 0，这取决于`foo`我们添加它时对它做了什么。不过，我们不在乎；我们已经完成了我们的责任`pointer`，呼吁`release`它与`alloc`我们一开始的呼吁相匹配。尽管`pointer`在这个调用之后可能仍然存在，但我们不能做出这样的假设，并且尝试对指针先前引用的对象做任何事情都是错误的（尽管我们可以`pointer`自由地更改为指向其他东西）。

> ```
> [foo release]; 
> ```

如果此代码的作者一直遵循 Apple 的内存管理约定，那么这是不必要的。我们没有责任调用`release`or `foo`（`foo2`它们指向同一个对象，记住）。这不会导致代码中断；在引用上调用任何内容`nil`本质上是无操作的。但是，它可能会导致任何查看代码的人感到困惑。

现在，这段代码的作者可能已经打破了内存管理约定。他可能在没有调用它的情况下让该`add`调用返回一个副本，在这种情况下，它使调用者负责调用它。这是一种非常糟糕的形式，如果您遇到违反内存管理约定的代码，请记录您使用它的位置以及它如何违反约定以避免将来混淆。`pointer``autorelease``release`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T19:37:06.250

```
ClassOne *pointer = [[ClassOne alloc]init]; 
```

该变量`pointer`是指向 ClassOne 类对象的指针。它分配了一个新创建的对象的值。

```
ClassTwo *foo = [[ClassTwo alloc]init], *foo2; 
```

`*foo`并且`*foo2`是 class 的对象`ClassTwo`。只`foo`分配了一个新创建的对象。`foo2`可能指向任何东西，所以在给它赋值之前使用它是不安全的。

```
 foo2 = [foo add: pointer]; 
```

`foo2`被赋值：我假设`add:`类的消息`ClassTwo`创建了一个对象（方法的签名应该是`-(ClassTwo*)add:(ClassOne*);`）

```
 [foo release]; 
```

`foo`不再需要指向的对象。

```
 foo = foo2; 
```

变量`foo`被赋值为`foo2`: 都指向同一个对象。

```
[pointer release]; 
```

`pointer`不再需要指向的对象。

```
[foo release]; 
```

不再需要`foo`（以及）指向的对象。`foo2`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T05:58:57.550

哇，谢谢大家的精彩回复！

我想我真正的意思是对对象的引用而不是指针。尽管如此，我猜测附加`, *foo2`的内容与 foo 位于同一内存中。foo2 也与 foo 同时从内存中释放。我还有很多东西要瘦，但一天一天！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T19:36:10.573

因为你还没有发布。您在这里释放引用，而不是释放指针。这不完全一样。当您第二次执行 [foo release] 时，您将释放您在将 foo2 分配给 foo 时创建的 foo 引用。

要释放 foo2 引用，您需要在该引用上实际调用 release，而不是引用的副本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T19:37:53.177

从您的简单示例中，很难说出发生了什么。通常 [class add:] 类型的方法返回 void，因此它们应该引发编译器警告“没有应忽略的 void 值”。

因此，如果没有更多信息，很难弄清楚。

要记住几件事：

*   您可以在 objc 中向“nil”发送命令。因此，如果 [foo add:pointer] 返回 nil，那么您可以整天调用 'release' 而不会产生任何影响。

*   retainCount 是你的朋友。您可以在任何 NSObject 上调用它，以查看有多少对象持有它。这也可以帮助您追踪问题。

*   最后，垃圾收集是否开启？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-09T19:38:29.883

这真的取决于做什么`[foo add:pointer];`。看起来它会返回并保留它的**副本**。`foo`这显然是一个糟糕的设计，因为如果返回的对象是副本/引用，那么从方法中应该很明显。带有命名的方法`add:`不应返回副本。

一步步：

```
// this somehow creates a retained copy of foo.
foo2 = [foo add:pointer];

 // foo is released and gets destroyed.
[foo release];

// makes foo point to the same object as foo2
// (`foo` has no connection to the former object anymore)
foo = foo2;

// foo (and foo2 as they point to the same object) are released
[foo release]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T19:55:15.287

您真正尝试关注的是指针的工作方式。我想你还没有理解指针和对象之间的区别。

[这是指向 wikipedia 上的指针的链接](http://en.wikipedia.org/wiki/Pointers)。

# .net - 是否有一个函数可以返回特殊字符的根字母？

> ID：529484
> 
> 赞同：3
> 
> 时间：2009-02-09T19:20:24.997
> 
> 标签：.net, .net-3.5

在 .NET 中有一个函数可以返回根字母（没有像 cedilla 这样的特殊属性的字母），有点：

```
Select Case c
  Case "á", "à", "ã", "â", "ä", "ª" : x = "a"
  Case "é", "è", "ê", "ë" : x = "e"
  Case "í", "ì", "î", "ï" : x = "i"
  Case "ó", "ò", "õ", "ô", "ö", "º" : x = "o"
  Case "ú", "ù", "û", "ü" : x = "u"

  Case "Á", "À", "Ã", "Â", "Ä" : x = "A"
  Case "É", "È", "Ê", "Ë" : x = "E"
  Case "Í", "Ì", "Î", "Ï" : x = "I"
  Case "Ó", "Ò", "Õ", "Ô", "Ö" : x = "O"
  Case "Ú", "Ù", "Û", "Ü" : x = "U"

  Case "ç" : x = "c"
  Case "Ç" : x = "C"

  Case Else
       x = c
End Select 
```

这段代码遗漏了一些字母，但这只是为了示例:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T19:24:34.847

看看这是否适合你：

[http://weblogs.asp.net/fmarguerie/archive/2006/10/30/removing-diacritics-accents-from-strings.aspx](http://weblogs.asp.net/fmarguerie/archive/2006/10/30/removing-diacritics-accents-from-strings.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T19:28:18.253

顺便说一句（与问题完全无关），您的代码对字符串进行操作。这不仅效率较低，而且实际上没有任何意义，因为您对单个**字符**而不是字符串感兴趣，而这些是 .NET 中不同的数据类型。

要获取单字符文字而不是字符串文字，请附加`c`到您的文字：

```
Select Case c
  Case "á"c, "à"c, "ã"c, "â"c, "ä"c, "ª"c : x = "a"c
  ' … and so on. '
End Select 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T19:48:39.763

取自 Chetan Sastry 的回复，在这里我给你 VB.NET 代码和从他的 GREAT answer 复制的 C# 代码：)

VB：

```
Imports System.Text
Imports System.Globalization

''' <summary>
''' Removes the special attributes of the letters passed in the word
''' </summary>
''' <param name="word">Word to be normalized</param>
Function RemoveDiacritics(ByRef word As String) As String
    Dim normalizedString As String = word.Normalize(NormalizationForm.FormD)
    Dim r As StringBuilder = New StringBuilder()
    Dim i As Integer
    Dim c As Char

    For i = 0 To i < normalizedString.Length
        c = normalizedString(i)
        If (CharUnicodeInfo.GetUnicodeCategory(c) <> UnicodeCategory.NonSpacingMark) Then
            r.Append(c)
        End If
    Next

    RemoveDiacritics = r.ToString
End Function 
```

C＃

```
using System.Text;
using System.Globalization;

/// <summary>
/// Removes the special attributes of the letters passed in the word
/// </summary>
/// <param name="word">Word to be normalized</param>
public String RemoveDiacritics(String word)
{
  String normalizedString = word.Normalize(NormalizationForm.FormD);
  StringBuilder stringBuilder = new StringBuilder();
  int i;
  Char c;

  for (i = 0; i < normalizedString.Length; i++)
  {
    c = normalizedString[i];
    if (CharUnicodeInfo.GetUnicodeCategory(c) != UnicodeCategory.NonSpacingMark)
  stringBuilder.Append(c);
  }

  return stringBuilder.ToString();
} 
```

我希望它可以帮助像我这样的人:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-29T23:22:46.497

.NET 中有一个简单的方法比较字符串

```
public static string NormalizeString(string value)
{
    string nameFormatted = value.Normalize(System.Text.NormalizationForm.FormKD);
    Regex reg = new Regex("[^a-zA-Z0-9 ]");
    return reg.Replace(nameFormatted, "");
} 
```

# c# - WCF 用户名身份验证：我可以在自定义 ServiceAuthorizationManager 中获取用户名吗？

> ID：529485
> 
> 赞同：4
> 
> 时间：2009-02-09T19:20:42.513
> 
> 标签：c#, .net, wcf, authorization

我有一个使用自定义的 WCF 服务`ServiceAuthorizationManager`。自定义身份验证管理器已设置为处理 Windows 和窗体身份验证。

但是，如果我连接一个设置为`UserName`身份验证的客户端，我似乎无法在任何地方找到用户名。

客户端代码如下所示：

```
this.ClientCredentials.UserName.UserName = "user";
this.ClientCredentials.UserName.Password = "pass";
this.Open();
this.MyMethod(); // my actual contract method
this.Close(); 
```

然后在服务器上，我有我的自定义身份验证管理器：

```
public sealed class AppAuthorizationManager : ServiceAuthorizationManager
{
    public override bool CheckAccess(OperationContext operationContext, ref Message message)
    {
        // would like to check user/pwd here...
    }
} 
```

这可能吗？

*   未`Thread.CurrentPrincipal`设置，
*   `operationContext.ServiceSecurityContext.PrimaryIdentity`未设置。
*   `operationContext.ServiceSecurityContext.AuthorizationContext.ClaimSets`是空的。

用户/密码是否应该在任何地方都可用？还是我也必须添加自定义`UsernamePasswordValidator`？

* * *

**更新：**所以我添加了一个自定义`UserNamePasswordValidator`和一个`IAuthorizationPolicy`. 我更新的 WCF 配置如下所示：

```
<behavior name="Server2ServerBehavior">
  <serviceMetadata httpGetEnabled="true" />
  <serviceDebug includeExceptionDetailInFaults="true" />
  <serviceAuthorization principalPermissionMode="Custom" serviceAuthorizationManagerType="MyApp.AuthManager, MyApp">
    <authorizationPolicies>
      <add policyType="MyApp.TokenAuthorizationPolicy, MyApp" />
    </authorizationPolicies>
  </serviceAuthorization>
  <serviceCredentials>
    <userNameAuthentication customUserNamePasswordValidatorType="MyApp.PFUserNameValidator, MyApp" />
  </serviceCredentials>
</behavior> 
```

如果我在所有 3 个类中设置断点，WCF 会抛出异常：

```
LogonUser failed for the 'username' user. Ensure that the user has a valid Windows account.
   at System.IdentityModel.Selectors.WindowsUserNameSecurityTokenAuthenticator.ValidateUserNamePasswordCore(String userName, String password) 
```

在它们中的任何一个运行之前。嗯……

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T19:58:14.483

这通常在[UsernamePasswordValidator](http://msdn.microsoft.com/en-us/library/aa354513.aspx)中处理- 这是您可以访问密码的唯一地方。但是，这不是您设置主体的地方 - 这将在`IAuthorizationPolicy`'`Evaluate`方法中，它可能看起来像：

```
bool IAuthorizationPolicy.Evaluate(
    EvaluationContext evaluationContext, ref object state)
{           
    IList<IIdentity> idents;
    object identsObject;
    if (evaluationContext.Properties.TryGetValue(
        "Identities", out identsObject) && (idents =
        identsObject as IList<IIdentity>) != null)
    {
        foreach (IIdentity ident in idents)
        {
            if (ident.IsAuthenticated &&
                ident.AuthenticationType == TrustedAuthType)
            {                           
                evaluationContext.Properties["Principal"]
                    = //TODO our principal
                return true;
            }
        }
    }
    if (!evaluationContext.Properties.ContainsKey("Principal"))
    {
        evaluationContext.Properties["Principal"] = //TODO anon
    }                
    return false;
} 
```

（`TrustedAuthType`我们的密码验证器的名称在哪里）

有了这个，线程的主体将被设置，我们可以识别自己（并使用基于角色的安全等）

# python - Python 的 GUI 生成器

> ID：529498
> 
> 赞同：11
> 
> 时间：2009-02-09T19:25:11.053
> 
> 标签：python

我正在寻找一个用于 python 的 GUI Builder

我知道它存在，可以在此图像背景中看到它

![图片](https://i.stack.imgur.com/cOzBl.gif)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T19:29:30.857

它是[Glade 3，一个用于](http://glade.gnome.org/)[GTK+](http://www.gtk.org)的 GUI 设计器。它会生成一个代表您的 GUI 的 XML 文件。您可以稍后使用[PyGTK](http://www.pygtk.org)加载此 GUI 。

具体来说，截图运行的[是 Glade 3 的 Mac OS X 端口](http://glade3.darwinports.com/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T19:28:23.340

很高兴，它实际上生成了 XML，可以与 python 中的 PyGTK 库一起使用

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-09T19:31:49.337

GUI 设计器不是“用于”python，而是用于[gtk+](http://gtk.org)和称为[pygtk](http://www.pygtk.org/)的相关语言绑定。

有两个可用的 gui 编辑器：

*   [http://glade.gnome.org/](http://glade.gnome.org/)
*   [http://www.mono-project.com/Stetic](http://www.mono-project.com/Stetic)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-09T19:47:35.710

我使用**PyQt**（[PyQt 主页](http://www.riverbankcomputing.co.uk/software/pyqt/intro/)）；它建立在 QT 工具包 ( [http://www.qtsoftware.com/](http://www.riverbankcomputing.co.uk/software/pyqt/intro/) ) 之上。

如果您要部署到 Windows，它可以很好地与 py2exe 模块 ( [py2exe](http://www.py2exe.org/) ) 配合使用。

它使用起来相当简单，特别是如果您已经有使用 QT 库的经验。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T11:15:41.680

屏幕截图中的一个是 Glade。

然而，有很多 Python 的 GUI-Builders，如[http://wiki.python.org/moin/GuiProgramming](http://wiki.python.org/moin/GuiProgramming)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-09T19:28:36.957

[Tkinter](http://wiki.python.org/moin/TkInter)是可用于 python 的众多 GUI 构建器之一。我更喜欢它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-09T20:21:41.480

[Gazpacho](http://gazpacho.sicem.biz/)几乎是 Glade 的克隆，但使用纯 PyGTK 编写。我们（[PIDA](http://pida.co.uk/)团队）目前正在对其进行翻新。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-05-10T14:49:55.957

python GUI builder 是[boa-constructor](http://boa-constructor.sourceforge.net/)，它使用 WxWidgets 工具包

# delphi - 什么是代码页 0？

> ID：529502
> 
> 赞同：6
> 
> 时间：2009-02-09T19:27:26.553
> 
> 标签：delphi, unicode, character-encoding, delphi-2009, codepages

我正在使用德尔福功能

```
StringCodePage 
```

我在 COM 函数返回的字符串上调用它（Acrobat Annotation getContents - 请参阅我的其他帖子），它返回 0。

什么是0？安西？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T19:48:03.417

代码页 0 是 CP_ACP，当前的 Windows ANSI 代码页。

从 Windows.pas：

```
{$EXTERNALSYM CP_ACP}
CP_ACP                   = 0;             { default to ANSI code page } 
```

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms776413.aspx "MultiByteToWideChar")：

> CP_ACP
> 
> 当前系统 Windows ANSI 代码页。这个值在不同的计算机上可能不同，即使在同一个网络上。它可以在同一台计算机上更改，从而导致存储的数据不可恢复地损坏。此值仅供临时使用，如果可能，应使用 UTF-16 或 UTF-8 进行永久存储。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-06T15:46:58.880

唯一`StringCodePage()`可以返回 0 的方法是传入一个空白，从而返回其编译时代码页亲和性，或者传入一个将代码页 0 分配给其有效负载`AnsiString`的非空白。`AnsiString`Delphi`WideString`用于 COM 字符串，`StringCodePage()`除了 plain 之外的任何字符串类型都不会返回 0 `AnsiString`。在 D2009 中，RTL 没有很好地将操作系统的实际运行时代码页存储到`AnsiString`有效负载中，因此它们通常包含 0 的编译时代码页亲和度。这在字符串转换方面是有用的，但不是很好明确的。这在后来的 Delphi 版本中得到了修复，因此`AnsiString`有效负载现在包含在运行时确定的实际操作系统代码页。

# content-management-system - 搜索引擎优化 - 开发人员指导？

> ID：529503
> 
> 赞同：8
> 
> 时间：2009-02-09T19:28:17.393
> 
> 标签：content-management-system, seo, e-commerce, search-engine

我刚刚拿到了一份合同，负责整理一个以前的“开发人员”留给我的一个客户的电子商务网站。其中大约有几十个使用自定义购物车和 CMS 系统，这些系统过于嵌入式而无法转储并且运行良好，但迫切需要清理、重构和错误修复，因此是一项相当大量的重新编码工作。

作为其中的一部分，我的客户迫切希望确保他能获得最佳的搜索引擎位置。像许多开发人员一样，我对这个想法有一点点了解，但没有真正的知识，而且加快速度似乎会有所帮助，这样我就可以适当地构建代码。

那么人们可以就有用的优质资源（书籍、网站、博客等）提供建议吗？我不想纠结于这方面的每一个细节（如果他决定把每一盎司都拿出来，他可以聘请专家——尽管我一直认为这比蛇油小贩好不了多少），但我想以有助于而不是阻碍放置的方式构建代码和重新配置模板。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T19:52:50.410

在关闭样式的情况下查看 Wikipedia。看看他们如何订购他们的内容？看看他们如何使用正确的标签来标记内容？这些是长期成功的关键。

最重要的 SEO 建议是创建一个语义、逻辑的网站。内容排在第一位，并按重要性排序。使用正确的标签，不要做表格。然后应用样式。然后应用脚本使其花哨。（就像托马斯说的）

了解内容（您的产品图片）和非内容（您的徽标平铺在背景上）之间的区别。基本上尽最大努力以好的方式呈现好的内容。你不能为了长期收益而玩弄系统。

这将为您提供长期安置。大多数搜索引擎优化公司只是做技巧或链接农场或担心关键字和元标签，所以它们充其量只是暂时的。我认为最好假设谷歌努力从它的索引中删除那些废话，就像 SEO 营销人员为包含它所做的那样。

根据谷歌的专利

1.  域的年龄。
2.  链接到您的重要网站。
3.  内容。让它真实而准确。

[http://appft1.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=/netahtml/PTO/search-bool.html&r=1&f=G&l=50&co1=AND&d=PG01&s1=20050071741&OS=20050071741&RS=20050071741](http://appft1.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=/netahtml/PTO/search-bool.html&r=1&f=G&l=50&co1=AND&d=PG01&s1=20050071741&OS=20050071741&RS=20050071741)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T19:38:24.330

考虑 SEO 时的一个主要问题应该*始终*是**可用性**。确保标记是语义化的，确保站点在没有 javascript、css 和图像的情况下工作 - 换句话说，确保“低级浏览器”能够读取您页面的内容。考虑为盲人和视障者的屏幕阅读器优化网站，您将自动覆盖搜索引擎，因为这正是它们的本质 - 盲人浏览器。

一个标准的禁忌是表格布局，主要是因为它不**按相关性对网站内容进行排序**。对于阅读您网站的人来说，向下看两英寸而不是在页面的最顶部是没有问题的，但是屏幕阅读器阅读的是*代码*，而不是*视觉视图*。

因此，您应该确保拥有重要的东西——高级标题（最好是`<h1>`or `<h2>`）、主菜单（在`<ul>`列表中）和`div`源顶部 s 中的内容，以及不太重要的内容（徽标, 横幅, 快捷菜单等并不是真正需要访问的) 进一步向下。您始终可以重新排序内容在您的 css 中实际显示的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-09T10:02:31.250

现在也可以使用名为 CANONICAL 的新标签，来自 Google，请单击[此处](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=139394)

# visual-studio-2008 - 用存储过程填充 tableadapter 比在 SQL 中运行存储过程花费的时间要长得多

> ID：529515
> 
> 赞同：0
> 
> 时间：2009-02-09T19:30:21.867
> 
> 标签：visual-studio-2008, ado.net, infragistics, dataset

我一直在尝试用数据填充我的超组合框，但这需要大量时间。但是，当我从 withing sql server 运行相同的存储过程时，它相对没有时间。程序挂断的代码行是：

```
SprocPatientsTableAdapter.Fill(Me.PatientsDataSet.sprocPatients, SelectedCustomerID) 
```

通过显着的时间差异，我的意思是在 sql server 中的差异小于 5 秒，而在程序中则超过三个小时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T19:33:43.483

尝试使用 SQL Server Profiler 来查看您的程序正在向数据库发送什么查询。您可能会看到传递的其他一些参数会影响查询并显着减慢查询速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T19:40:34.933

它返回的结果集有多大？如果您通过网络发送 2.5GB，将其存储在内存中并通过它旋转以填充集合，那么是的，它当然会很慢。

不过，我想最大的问题是：你真的在使用所有被交还的数据吗？请告诉我您没有抓取整个表格，然后过滤到七行并显示 ID 和用户名！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T20:23:26.983

对于这个特定的结果，数据库发送了 45,522 行（~9.08mb）

至于我们是否需要所有这些数据的大问题，不，我们不需要，我一直在争论，直到我越过蓝色进入我脸上极度深海军色的领域，但不知何故，我们得到了“关键任务”一切（不仅仅是在特定时刻需要的东西）。我们获得的第一个线索超出了我们的需要，那就是我们首先使用了一个多列组合框（为了获得那个控制而花费了超过 1k），抱歉咆哮了。

过程是：用户输入他们的用户名和 id --> 选择他们想要查看（并有权访问）的医院 --> 然后将该医院中使用我们服务的所有患者加载到 ultracombobox auto由帐号填写（隐藏）。超组合框（多列）绑定到其他几个文本框（姓氏、名字、中间名等……），因此可以编辑信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T16:24:43.427

我将感谢 RoadWarrior 指导我最终解决禁用数据集约束的问题。使用数据集的 UltraCombo 框仅显示数据而不对其进行操作，并且在禁用约束的情况下，我的 UltraCombo 框填充速度非常快

# google-app-engine - 使用 Google App Engine 进行网页抓取

> ID：529523
> 
> 赞同：7
> 
> 时间：2009-02-09T19:31:30.523
> 
> 标签：google-app-engine, web-applications

我正在尝试抓取一些网站并将数据重新发布为 RSS 提要。使用 Google App Engine 进行设置有多难？使用 GAE 的缺点和优点。非常感谢任何建议和指南！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T19:37:30.663

如果您真正想要做的只是将一些结构化数据重新发布为 RSS，那么 Google AppEngine 提供的功能（和复杂性）比您需要的要多得多。就个人而言，我会使用[雅虎管道之](http://pipes.yahoo.com)类的东西来完成这样的任务。

话虽这么说......如果你想/需要用 GAE 弄湿你的脚，去吧！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T19:55:59.573

使用 Google App Engine 非常简单。我建议您阅读[入门指南](http://code.google.com/appengine/docs/python/gettingstarted/)。它简短而简单，涉及基本的 GAE 主题。优点和缺点比我在这里列出的要多。

**优点：**
一般来说，App Engine 专为需要扩展的高流量 Web 应用程序而设计。此外，它是从程序员的角度设计的。许多可扩展性问题（数据库优化、服务器管理等）都由 Google 处理。话虽如此，我发现它是一个不错的平台。它仍在由 Google 工程师积极开发，任务调度（长期以来一直要求的功能）在当前的路线图中。

**缺点：**
也许现在最大的缺点是缺乏官方调度支持以及目前为免费帐户设置的配额限制。但是，如果它是免费的，你就不能抱怨太多。目前它只支持 Python 作为编程接口（尽管一种新语言 [Java 我预测] 即将推出）。此外，尚不支持 Python 2.6（以及 3.0）。此外，App Engine 并未正式支持 Django 1.0（尽管您可以[将 Django 1.0 与您的应用程序一起打包](http://code.google.com/appengine/articles/django10_zipimport.html)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T19:49:52.740

比大多数其他技术更难。

GAE 现在可以像*这样*执行预定的批处理操作，但它真的不适合这种类型的事情。为这个特定的任务选择几乎任何其他语言和平台，你会让你的生活变得更轻松。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T12:34:27.160

我认为[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)可以在 GAE 上运行，所以你所有的抓取需求都得到了处理：D 另外，GAE 有一个 geturl 东西。我认为您可能遇到的唯一问题是没有足够的时间获取数据（30 秒限制）。

我正在做同一个项目，我决定在另一台服务器上准备数据并将它们推送到 GAE 会更容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-22T15:10:19.633

您可能还想查看[Yahoo! 查询语言](http://developer.yahoo.com/yql/)(YQL)

# c# - 在 C# 中，策略模式和委托有什么区别？

> ID：529524
> 
> 赞同：7
> 
> 时间：2009-02-09T19:31:35.563
> 
> 标签：c#, delegates, strategy-pattern

我一直在查看策略模式实现示例，在我看来它们与 c# 委托非常相似。我看到的唯一区别是策略模式实现不需要显式声明委托。

但除此之外，它们似乎都指向需要特定签名的函数，并且它们都可以用来确定在运行时要执行什么。

我缺少更明显的区别吗？

我想一个相关的问题是，如果它们相似，那么使用一个比另一个有什么优势？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-09T19:34:26.367

简而言之，您可以使用委托来实现策略模式。

策略模式是一种模式。代表是一种语言特性。您使用语言特性来实现该模式。它们完全存在于两个不同的概念类别中，但在它们之间的相互作用中是相关的。

换句话说，策略模式是蓝图，C# 委托是砖块。没有任何一个，您都无法建造（战略模式）房屋。（您也可以使用其他类型的积木来构建它，但委托的语言特性中没有任何内容可以固有地描述策略模式）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T19:46:03.203

设计模式是与语言无关的、针对常见问题的高级解决方案。

委托可用于 .NET 策略模式的特定于平台的*实现*，但并不是实现此类解决方案的唯一方法。

另一种解决方案是定义一个接口，如：

```
public interface IStrategy
{
    void DoStuff(...)
} 
```

然后，策略将由实现此接口的类而不是委托来表示。

如果您希望您的策略非常简单，那么委托可能是一个不错的实现。对于任何相当复杂的事情，在跟踪状态、将事物组织成多个方法、在实现之间共享代码等方面，将策略实现为接口为您提供了更多选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T19:33:22.797

您将如何在 C# 中实现策略模式？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T19:34:33.527

模式是架构的问题。代表是一个执行问题。

在 C# 中，几乎总是使用委托来实现策略模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T19:34:35.757

策略模式是一种设计模式，允许您在执行时选择不同的函数，而委托是一种语言结构，允许您创建对函数的引用并将其用作变量。

使用多态而不是委托来更好地实现策略模式，因为多态调度往往更优雅。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-16T15:41:39.200

可以看到委托类似于 Java 中使用的函数式接口——本质上是一个只有一种方法的接口。

从 Java8 开始，您实际上可以以更加匿名/内联的方式为功能接口提供实现。

对于可以通过单一方法覆盖的行为，执行策略实施有点矫枉过正，而且过于冗长。

它们本质上解决了“在类中插入可交换行为”的相同目的

# php - PHP 未完全检索 Shell 输出！

> ID：529535
> 
> 赞同：4
> 
> 时间：2009-02-09T19:34:17.740
> 
> 标签：php, linux, shell, command-line

我有一个执行 shell 命令的 PHP 脚本：

```
$handle = popen('python last', 'r');
$read = fread($handle, 4096);
print_r($read);
pclose($handle); 
```

我回显了 shell 输出的输出。当我在命令中运行它时，我得到如下信息：

```
[root@localhost tester]# python last
[last] ZVZX-W3vo9I: Downloading video webpage
[last] ZVZX-W3vo9I: Extracting video information
[last] ZVZX-W3vo9I: URL: x
[download] Destination: here.flv
[download]   0.0% of 10.09M at     ---b/s ETA --:--
[download]   0.0% of 10.09M at   22.24k/s ETA 07:44
[download]   0.0% of 10.09M at   66.52k/s ETA 02:35
[download]   0.1% of 10.09M at  154.49k/s ETA 01:06
[download]   0.1% of 10.09M at  162.45k/s ETA 01:03 
```

但是，当我从 PHP 运行相同的命令时，会得到以下输出：

```
[last] ZVZX-W3vo9I: Downloading video webpage
[last] ZVZX-W3vo9I: Extracting video information
[last] ZVZX-W3vo9I: URL: x
[download] Destination: here.flv 
```

如您所见，底部的位丢失了，这是我需要的位！之前的问题是百分比在同一行上更新，但现在我更改了我的 Python 脚本，以便它创建一个新行。但这有所作为！:(

这个问题与[这个](https://stackoverflow.com/questions/524286/ajax-progress-reading-output-from-the-shell)有关。

感谢您的任何帮助。

## 更新

需要重定向输出“2>&1”。Arul 很幸运：P 因为我错过了选择属于 Pax 的一个真实答案的最后期限！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-09T19:49:46.640

您只从管道中读取了前 4,096 个字节，您需要将`fread`/ `print`_r 放在一个循环中并使用该`feof`函数检查文件结尾。

```
$handle = popen('python last', 'r');

while(!feof($handle))
{
    print_r(fread($handle, 4096));
} 

pclose($handle); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-16T05:43:19.873

第一步是查看输出的去向。我要做的第一件事是选择一个稍微小一点的文件，这样您就不会为每次测试等待七分钟。

第 1 步/查看在 shell 中写入的内容。执行命令`python last >/tmp/stdout 2>/tmp/stderr`然后查看这两个文件。理想情况下，所有内容都将写入标准输出，但情况可能并非如此。这为您提供了脚本的基线行为。

步骤 2/ 从 PHP 运行时使用`$handle = popen('python last >/tmp/stdout 2>/tmp/stderr', 'r');`. 在这种情况下，您的 PHP 脚本可能不会返回任何内容，但仍应填充文件。这将在非终端环境中运行时捕获任何更改的行为。

如果一些输出到stderr，那么解决方案应该很简单`$handle = popen('python last 2>&1', 'r');`

此外，PHP 的 doco 状态（我的粗体字）：

`Returns a file pointer identical to that returned by fopen(), except that it is unidirectional (may only be used for reading or writing) and must be closed with pclose(). This pointer may be used with **fgets()**, **fgetss()**, and **fwrite()**.`

因此，我不确定您是否应该使用`fread()`，尽管它已在其中一个示例中显示。尽管如此，我认为基于行的输入更多地映射到您想要实现的目标。

不管这一切，您应该循环读取输出，以确保您可以在超过 4K 时获得输出，例如：

```
$handle = popen ('python last 2>&1', 'r');
if ($handle) {
    while(! feof ($handle)) {
        $read = fgets ($handle);
        echo $read;
    } 
    pclose ($handle);
} 
```

需要注意的另一件事是，如果您的输出将发送到浏览器并且花费的时间太长，则浏览器本身可能会超时，因为它认为服务器端连接已经消失。如果您发现一个小文件有效，而您的 10M/1 分钟文件无效，则可能是这种情况。您可以尝试`flush()`，但并非所有浏览器都会尊重这一点。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-16T06:07:11.780

这样做要容易得多：

```
$output = `python last`;
var_dump($output); 
```

'ticks' (`) 将执行该行并捕获输出。这是一个测试示例：

文件 test.php：

```
<?php
echo "PHP Output Test 1\n";
echo "PHP Output Test 2\n";
echo "PHP Output Test 3\n";
echo "PHP Output Test 4\n";
echo "PHP Output Test 5\n";
?> 
```

文件捕获.php：

```
<?php
$output = `php test.php`;
var_dump($output);
?> 
```

**php capture.php**的输出：

```
string(80) "Test PHP Script
Test PHP Script
Test PHP Script
Test PHP Script
Test PHP Script
" 
```

然后，您可以根据换行符将输出拆分为数组：

```
$outputArray = explode('\n', $output); 
```

**或者**使用[proc_open() ，它比](http://php.net/proc_open)*popen*给你更多的控制，因为你可以指定你希望在哪里处理 stdin、stdout 和 stderr。

**或者**你可以 fopen`STDIN`或`php://stdin`然后管道到 php：

```
? python last | php script.php 
```

我会选择选项 1 并使用反引号，这是最简单的方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-17T06:37:08.660

当输出不发送到 tty 时，如果发现进度报告被省略，我不会感到惊讶。也就是说，PHP 正在捕获发送的所有内容，但没有发送进度报告。

根据输出的位置不同，命令的行为有很多先例 - 从好的旧`ls`命令开始。

当然，如果您编写了正在运行的 Python 脚本，那么这不太可能是导致问题的原因。

你如何验证这个假设是否有效？好吧，您可以从在命令行运行脚本开始，标准输出到一个文件，标准错误到另一个文件。如果您在其中一个文件中看到进度信息，您就会对正在发生的事情有更多的了解。如果您仍然在屏幕上看到进度信息，那么脚本可能正在将进度信息回显到`/dev/tty`，但是当 PHP 运行它时，`/dev/tty`该进程没有。如果您根本看不到进度信息（在屏幕上或文件中），那么我最初的假设可能已经得到验证。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-17T22:33:48.093

尝试在 $handle 上运行 stream_get_contents()。对于不知道要检索的确切大小的资源，这是一种更好的方法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-09T19:49:46.983

你可以在一个while循环中阅读而不是使用fread()吗？

```
while( !feof($handle) )
    echo fgets($handle); 
```

您可能还需要 flush() 。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-09T19:59:03.547

你看到了什么

```
python last | less 
```

?

也许你想要的输出是在 STDERR 上发出的。然后你必须以这种方式启动它：

```
$handle = popen('python last 2>&1', 'r'); 
```

将STDERR 引导到您正在使用[popen](http://www.php.net/manual/en/function.popen.php)`2>&1`捕获的 STDOUT 中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-17T06:54:20.240

如果您只是想在终端窗口中显示 python 命令的进度，那么我会推荐以下内容：

```
<?php
system("python last > `tty`"); 
```

然后您不需要捕获输出，用户甚至可以在不中止 PHP 脚本的情况下`Ctrl`+下载。`C`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-19T12:11:13.737

你错过了同花跟注。（在您的 python 应用程序中，也可能在您的 php 应用程序中）

这是因为当您交互地使用标准流标准输入/标准输出（来自 cmdline）时，它们处于行缓冲模式（简而言之，系统在每个新行上刷新），但是当您从程序中调用它时，流处于完全缓冲状态模式（直到系统缓冲区已满才输出）。

[在标准流中缓冲的](http://www.pixelbeat.org/programming/stdio_buffering/)更多信息

# mysql - Oracle 的 MySQL 等效会话变量

> ID：529537
> 
> 赞同：3
> 
> 时间：2009-02-09T19:34:23.590
> 
> 标签：mysql, oracle, plsql, session-variables

在 MySQL 中，我可以使用单个 @ 创建访问会话变量。初始化示例：

```
set @myVar = true; 
```

一些包含此代码的触发器：

```
if (@myVar is not true) then
  execute something 
```

Oracle 10g 中的等价物是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T19:47:33.480

```
SQL> EXEC DBMS_SESSION.SET_CONTEXT('CLIENTCONTEXT', 'myvar', 'myvalue');

PL/SQL procedure successfully completed

SQL> SELECT SYS_CONTEXT('CLIENTCONTEXT', 'myvar') FROM dual;

SYS_CONTEXT('CLIENTCONTEXT','M
--------------------------------------------------------------------------------
myvalue 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T19:47:25.383

包全局变量可能会做同样的事情。

```
CREATE OR REPLACE PACKAGE foo as
  myVar BOOLEAN;
END foo;

CREATE OR REPLACE PACKAGE BODY foo AS
  BEGIN
    MyVar := true;
END foo;

BEGIN
  If foo.myVar THEN 
    dbms_output.put_line ('MyVar is True');
  end if;
END; 
```

使用包而不是 SYS_CONTEXT 的一个优点是您可以获得一些封装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T05:37:33.233

为什么不只使用绑定变量？在 SQL Plus 中：

```
variable SOME_NUMBER number
exec :SOME_NUMBER := 10 
```

> PL/SQL 过程成功完成

```
if :SOME_NUMBER = 10 then
   do something;
end if;
/ 
```

适用于任何类型的 Oracle 数据类型。

# c# - 包括来自类库的服务引用

> ID：529550
> 
> 赞同：23
> 
> 时间：2009-02-09T19:35:23.837
> 
> 标签：c#, app-config, service-reference

我有一个 C# 类库和一个启动项目（一个控制台应用程序）。类库包括对 Web 服务的服务引用。当我尝试运行该项目时，我得到一个 InvalidOperationException，因为启动项目没有读取类库的 app.config，并且它忽略了服务引用。为了让它工作，我不得不向启动项目添加相同的服务引用。有什么办法可以避免这种情况吗？我可以让启动项目识别类库的服务引用和app.config，而不必将其复制到启动项目中吗？

我尝试从类库中添加指向 app.config 的链接，但这不起作用。如果类库需要使用它的任何人将该服务引用添加到启动项目，那么它的可移植性就不是很好。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-09T20:38:47.227

想想你想要做什么——你有两个正在构建的程序集：

```
Library
ConsoleApp 
```

这两个程序集都有配置文件——我想它们看起来像这样：

```
Library
    app.config
ConsoleApp
    ConsoleApp.exe.config 
```

当您运行`ConsoleApp`时，它无法读取或了解`app.config`您的`Library`程序集。它知道或关心的唯一配置文件是`ConsoleApp.exe.config`. 现在可以让配置文件相互引用，但这不是您尝试做的正确解决方案。

由于您的`Library`程序集没有入口点，因此它永远不会加载到 AppDomain 中。因为它永远不会被加载到 AppDomain 中，所以它的应用程序配置文件永远不会被使用。

您应该做的是通过项目引用进行引用`Library`。`ConsoleApp`然后将所有相关配置数据`app.config`移入`ConsoleApp.exe.config`，因为这是您的应用程序将使用的配置文件。

这将允许您在 Web 服务上调用方法所需的两件事

1.  其中的代码`Library`可以发送和接收 SOAP 消息。
2.  运行所需的配置元数据`Library`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-04-19T11:14:51.240

在类库中使用服务引用然后复制配置的替代方法是使用调用 svcutil.exe 的构建事件。我喜欢这一点的一点是，当服务更改时，您不必进行“更新服务参考”。它将自动更新。

在类库中，使用只生成代理代码的构建事件：

```
svcutil.exe net.tcp://localhost:3315/MyService/mex /noConfig 
```

在应用程序中，使用生成配置的构建事件。您可以使用 /mergeConfig 选项将其合并到现有的 app.config 中。

```
svcutil.exe net.tcp://localhost:3315/MyService/mex 
            /config:App.config /mergeConfig 
```

如果您不想在服务未运行时出现构建错误，请将其放入项目文件中，您将收到警告而不是错误：

```
<Target
    Name="PreBuildEvent"
    Condition="'$(PreBuildEvent)'!=''"
    DependsOnTargets="$(PreBuildEventDependsOn)">
  <Exec WorkingDirectory="$(OutDir)"
        Command="$(PreBuildEvent)"
        ContinueOnError="true" />
</Target> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T19:40:44.073

您只需将指向服务的配置键从类库配置文件复制到控制台应用程序的配置文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T19:41:22.527

您可以将 app.config 的相关部分从类库的配置复制到控制台应用程序的 app.config 中。

或者，如果您真的想使其真正可移植，则需要考虑另一种方法来从类库中引用特定服务引用的地址。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T19:40:54.917

如果您有多个配置文件在运行，我认为它会更加混乱。

如果一个库有可配置的项目，我完全希望必须将该配置放在我的配置文件中才能正确使用该库。

# c# - 如何使用 c# 从 asp.net 中的查询字符串中删除项目？

> ID：529551
> 
> 赞同：54
> 
> 时间：2009-02-09T19:35:38.033
> 
> 标签：c#, .net, asp.net, query-string

我想从我的网址中删除“语言”查询字符串。我怎样才能做到这一点？（使用 Asp.net 3.5，c#）

```
Default.aspx?Agent=10&Language=2 
```

我想删除“Language=2”，但语言将是第一个、中间或最后一个。所以我会有这个

```
Default.aspx?Agent=20 
```

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-02-09T19:51:36.950

如果它是 HttpRequest.QueryString ，那么您可以将集合复制到可写集合中并随心所欲地使用它。

```
NameValueCollection filtered = new NameValueCollection(request.QueryString);
filtered.Remove("Language"); 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2011-09-23T14:11:36.637

这是一个简单的方法。不需要反射器。

```
 public static string GetQueryStringWithOutParameter(string parameter)
    {
        var nameValueCollection = System.Web.HttpUtility.ParseQueryString(HttpContext.Current.Request.QueryString.ToString());
        nameValueCollection.Remove(parameter);
        string url = HttpContext.Current.Request.Path + "?" + nameValueCollection;

        return url;
    } 
```

这里`QueryString.ToString()`是必需的，因为`Request.QueryString`集合是只读的。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-02-09T21:35:24.360

最后，

hmemcpy 的答案完全适合我，并感谢其他回答的朋友。

我使用 Reflector 抓取 HttpValueCollection 并编写了以下代码

```
 var hebe = new HttpValueCollection();
        hebe.Add(HttpUtility.ParseQueryString(Request.Url.Query));

        if (!string.IsNullOrEmpty(hebe["Language"]))
            hebe.Remove("Language");

        Response.Redirect(Request.Url.AbsolutePath + "?" + hebe ); 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-10-08T08:45:16.580

我个人的偏好是重写查询或在较低的位置使用 namevaluecollection，但有时业务逻辑不会使这些都非常有用，有时反射确实是您需要的。在这种情况下，您可以像这样关闭 readonly 标志片刻：

```
// reflect to readonly property
PropertyInfo isreadonly = typeof(System.Collections.Specialized.NameValueCollection).GetProperty("IsReadOnly", BindingFlags.Instance | BindingFlags.NonPublic);

// make collection editable
isreadonly.SetValue(this.Request.QueryString, false, null);

// remove
this.Request.QueryString.Remove("foo");

// modify
this.Request.QueryString.Set("bar", "123");

// make collection readonly again
isreadonly.SetValue(this.Request.QueryString, true, null); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-09T19:59:44.027

不久前我回答了一个[类似的问题。](https://stackoverflow.com/questions/229925/outputing-a-manipulated-querystring-in-c/)基本上，最好的方法是使用`HttpValueCollection`该`QueryString`属性实际上是的 class ，不幸的是它在 .NET 框架中是内部的。您可以使用 Reflector 来抓取它（并将其放入您的 Utils 类中）。通过这种方式，您可以像 NameValueCollection 一样操作查询字符串，但所有 url 编码/解码问题都会为您处理好。

`HttpValueCollection`extends `NameValueCollection`，并具有一个构造函数，该构造函数采用编码的查询字符串（包括与号和问号），并且它覆盖了一个`ToString()`稍后从基础集合重建查询字符串的方法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-06-11T17:31:36.933

试试这个 ...

```
PropertyInfo isreadonly   =typeof(System.Collections.Specialized.NameValueCollection).GetProperty("IsReadOnly", BindingFlags.Instance | BindingFlags.NonPublic);    

isreadonly.SetValue(this.Request.QueryString, false, null);
this.Request.QueryString.Remove("foo"); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-09T19:44:57.573

您不清楚是否尝试修改 Request 对象中的 Querystring。由于该属性是只读的，我想我们会假设您只想弄乱字符串。

...在这种情况下，这是微不足道的。

*   从请求中获取查询字符串
*   .split() 它在 '&' 上
*   将其重新组合成一个新字符串，同时嗅探并丢弃以“语言”开头的任何内容

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-09T19:45:28.197

获取查询字符串集合，将其解析为 ( `name=value pair`) 字符串，不包括要删除的字符串，并将其命名为 newQueryString

然后调用`Response.Redirect(known_path?newqueryString)`；

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-02-29T23:33:07.190

1.  使用 收集您的查询字符串`HttpContext.Request.QueryString`。它默认为一种`NameValueCollection`类型。
2.  将其转换为字符串并用于`System.Web.HttpUtility.ParseQueryString()`解析查询字符串（`NameValueCollection`再次返回 a）。
3.  然后，您可以使用该`Remove()`函数删除特定参数（使用键来引用该参数以删除）。
4.  用例将查询参数转换为字符串，并用于`string.Join()`将查询字符串格式化为 URL 可读的有效查询参数。

请参阅下面的工作示例，`param_to_remove`您要删除的参数在哪里。

假设您的查询参数是`param1=1&param_to_remove=stuff&param2=2`. 运行以下行：

```
var queryParams = System.Web.HttpUtility.ParseQueryString(HttpContext.Request.QueryString.ToString());
queryParams.Remove("param_to_remove");
string queryString = string.Join("&", queryParams.Cast<string>().Select(e => e + "=" + queryParams[e])); 
```

现在您的查询字符串应该是`param1=1&param2=2`.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-09T19:42:38.250

您可能需要使用正则表达式来查找要从查询字符串中删除的参数，然后将其删除并将浏览器重定向到具有新查询字符串的同一文件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-09T19:42:48.500

是的，.NET 中没有内置类来编辑查询字符串。您必须使用正则表达式或其他更改字符串本身的方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-11-27T15:20:58.410

如果您已经将查询字符串作为字符串，您还可以使用简单的字符串操作：

```
int pos = queryString.ToLower().IndexOf("parameter=");
if (pos >= 0)
{
    int pos_end = queryString.IndexOf("&", pos);
    if (pos_end >= 0)   // there are additional parameters after this one
        queryString = queryString.Substring(0, pos) + queryString.Substring(pos_end + 1);
    else
        if (pos == 0) // this one is the only parameter
            queryString = "";
        else        // this one is the last parameter
            queryString=queryString.Substring(0, pos - 1);
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-02-03T09:06:13.860

好吧，我有一个简单的解决方案，但是涉及到一点 javascript。

假设查询字符串为“ok=1”

```
 string url = Request.Url.AbsoluteUri.Replace("&ok=1", "");
   url = Request.Url.AbsoluteUri.Replace("?ok=1", "");
  Response.Write("<script>window.location = '"+url+"';</script>"); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-12-20T13:05:16.780

```
string queryString = "Default.aspx?Agent=10&Language=2"; //Request.QueryString.ToString();
string parameterToRemove="Language";   //parameter which we want to remove
string regex=string.Format("(&{0}=[^&\s]+|{0}=[^&\s]+&?)",parameterToRemove);
string finalQS = Regex.Replace(queryString, regex, ""); 
```

[https://regexr.com/3i9vj](https://regexr.com/3i9vj)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-04-30T04:29:22.363

将 Querystring 解析为 NameValueCollection。删除一个项目。并使用 toString 将其转换回查询字符串。

```
using System.Collections.Specialized;

NameValueCollection filteredQueryString = System.Web.HttpUtility.ParseQueryString(Request.QueryString.ToString());
filteredQueryString.Remove("appKey");

var queryString = '?'+ filteredQueryString.ToString(); 
```

# xml - 如何在 XPath 中按属性命名空间查找元素

> ID：529556
> 
> 赞同：21
> 
> 时间：2009-02-09T19:37:10.963
> 
> 标签：xml, xpath, namespaces

我正在尝试使用 XPath 查找在给定名称空间中具有元素的所有元素。

例如，在以下文档中，我想找到`foo:bar`and`doodah`元素：

```
<?xml version="1.0" encoding="UTF-8"?>
<root xmlns:foo="http://foo.example.com">
  <foo:bar quux="value">Content</foo:bar>
  <widget>Content</widget>
  <doodah foo:quux="value">Content</doodah>
</root> 
```

我知道我可以使用以下 XPath 表达式从给定的命名空间加载所有属性：

```
"//@*[namespace-uri()='http://foo.example.com']" 
```

然而：

*   这并没有给我元素，只是属性。
*   如果元素包含来自该命名空间的多个属性，则此选择器将返回每个属性而不是每个元素的结果

是否有可能得到我想要的，还是我必须收集属性并计算它们对应的唯一元素集？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-09T20:12:10.643

采用：

```
//*[namespace-uri()='yourNamespaceURI-here'
   or
    @*[namespace-uri()='yourNamespaceURI-here']
   ] 
```

谓词两个条件用 XPath 运算符进行或`or`运算。

因此，XPath 表达式选择满足以下任一条件的任何元素：

*   属于指定的命名空间。
*   具有属于指定命名空间的属性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T19:49:31.977

我不确定这是否是您的意思，但是通过仅删除 XPath 中的一个字符，您可以获得某个命名空间中的所有元素：

```
//*[namespace-uri()='http://foo.example.com'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T19:50:15.237

你可以试试

```
//*[namespace-uri()='http://foo.example.com' or @*[namespace-uri()='http://foo.example.com']] 
```

它将为您提供元素 foo:bar 和元素 doodah（如果您在 XML 数据中更改`tal:quux`为）：`foo:quux`

```
<?xml version="1.0" encoding="UTF-8"?>
<root xmlns:foo="http://foo.example.com" xmlns:tal="xxx">
  <foo:bar quux="value">Content</foo:bar>
  <widget>Content</widget>
  <doodah foo:quux="value">Content</doodah>
</root> 
```

那是你要的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T19:53:12.513

您的 XPath 表达式几乎是完美的。而不是要求属性“@ *”要求元素“* ”，它应该工作：

```
"//*[namespace-uri()='http://foo.example.com']" 
```

# javascript - JavaScript 输出的死点

> ID：529570
> 
> 赞同：0
> 
> 时间：2009-02-09T19:39:01.800
> 
> 标签：javascript, html, center

我要为这个问题的基础性提前道歉，但这是我第一次在 HTML 中使用 JavaScript。

基本上，我有一个 JavaScript，每次用户加载页面时都会产生不同的随机文本。我想在 Helvetica 中格式化该文本，然后将其显示在页面中间。我正在尝试使用 CSS 执行此操作，如下所示，但它不适用于我。任何建议都非常感谢。

**HTML**

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <title>home</title>

    <link href="style.css" rel="stylesheet" type="text/css" />

</head>

<body>

    <div id="horizon">
    <div id="content">

    <script type="text/javascript" src="scripts.js"></script>

    </div>
    </div>

</body> 
```

**CSS**

```
#horizon {
  color: white;
  background-color: #ffffff;
  text-align: center;
  position: absolute;
  top: 50%;
  left: 0px;
  width: 100%;
  height: 1px;
  overflow: visible;
  visibility: visible;
  display: block
}

#content {
  font-family: Helvetica, Geneva, Arial, sans-serif;
  font-color: black;
  background-color: white;
  margin-left: -410px;
  position: absolute;
  top: -237px;
  left: 50%;
  width: 825px;
  height: 475px;
  visibility: visible
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T19:45:03.423

对于初学者来说，您缺少 HTML 标记。您需要在 HTML 标签之间包装您的 HTML 代码。

其次，您需要将文本设置为与背景颜色不同的颜色。在您的 CSS 中，您需要将 #horizo​​n 颜色更改为黑色或其他颜色。

除此之外，您的代码有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T19:50:37.107

尝试

```
#content 
{
    margin: auto;
    width: 200px; /* however wide it should be (required) */
}

...
<div id="content">
    stuff goes here from js / whatever
</div> 
```

对于垂直对齐，您正在查看 JS 而不是 CSS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T19:43:49.213

如何使用`text-align: center`？：

```
#content 
{
font-family: Helvetica, Geneva, Arial, sans-serif;
font-color: black;
background-color: white;
text-align: center;
} 
```

# java - ADF Custom Components

> ID：529573
> 
> 赞同：0
> 
> 时间：2009-02-09T19:40:33.387
> 
> 标签：java, oracle, jsf, jakarta-ee, oracle-adf

Where is the best place to find custom compnonents? Ideally a repository, as opposed to finding a few here and there. We are currently about to re-design our look and feel UI for about 200 forms and we were hoping to find a lot of custom components... We were told they were everywhere by the pre-sales architect but even a simple [google search](http://www.google.com/search?q=adf+custom+components&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a) returns nothing.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T19:48:57.377

If you use Oracle ADF 11i Faces, you have over 100 Components out of the box (According to the Oracle site even over a 150 Ajax-enabled JSF components). Try using these first (could be better than custom components).

# oop - 参数与成员变量

> ID：529590
> 
> 赞同：27
> 
> 时间：2009-02-09T19:44:20.540
> 
> 标签：oop, variables, private

我最近一直在使用其他人的代码，我意识到这个人在私有变量和方法参数方面的理念与我非常不同。我通常认为私有变量应该只在以下情况下使用：

1.  该变量需要存储以供以后调用。
2.  存储在变量中的数据在类中全局使用。
3.  当需要全局操作变量时（与每个类方法读取变量的需要明显不同）。
4.  什么时候它将使编程变得更加容易。（诚​​然含糊不清，但在许多情况下必须避免将自己逼入角落）。

（我承认，上述许多内容略有重复，但它们似乎都不同，足以值得这样处理......）

这似乎是防止意外更改变量的最有效方法。似乎遵循这些标准将允许最终操作外部引用（如果最终修改了类），从而为您在未来留下更多选择。这仅仅是一个风格问题（比如一个真正的括号或匈牙利命名约定），还是我有理由相信这种信念？在这种情况下实际上有最佳实践吗？

**编辑**
我认为这需要纠正。我在上面的实际意思中使用了“全局”，“通过实例方法全局”而不是“任何地方、任何地方都可以全局访问”。

**edit2**
要求提供一个示例：

```
class foo
{
    private $_my_private_variable;

    public function __constructor__()
    {
    }

    public function useFoo( $variable )
    {
        // This is the line I am wondering about,
        // there does not seem to be a need for storing it.
        $this->_my_private_variable = $variable; 
        $this->_doSometing();
    }

    private function _doSomething()
    {

        /*
          do something with $this->_my_private_variable.
        */
        // This is the only place _my_private_variable is used.
        echo $this->_my_private_variable;
    }
} 
```

这就是我会这样做的方式：

```
class foo
{

    public function __constructor__()
    {
    }

    public function useFoo( $variable )
    {
        $this->_doSometing( $variable );
    }

    private function _doSomething( $passed_variable )
    {
        /*
          do something with the parameter.
        */
        echo $passed_variable;
    }
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-09T20:11:05.873

一般来说，类成员应该代表类对象的*状态*。

它们不是方法参数的临时位置（这就是方法参数的用途）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-09T19:50:52.443

我声称这不是风格问题，而是可读性/可维护性问题。一个变量应该有一种用途，而且只有一种用途。仅仅因为它们碰巧需要相同的类型而为不同的目的“回收”变量是没有任何意义的。

从您的描述看来，您处理的其他人的代码似乎就是这样做的，因为您的列表基本上涵盖了所有其他用途。简而言之，它根据情况使用私有成员变量充当临时变量。我可以这样假设吗？如果是这样，代码是可怕的。

任何给定变量的词法范围和生命周期越小，错误使用的可能性就越小，资源处置就越好。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-09T19:55:11.277

拥有一个成员变量意味着它将保持需要在方法调用之间保持的状态。如果该值不需要在调用之间存在，则它没有理由存在于单个调用的范围之外，因此（如果它存在的话）应该是方法本身内的一个变量。

风格始终是一种艰难的风格，一旦你开发了一种风格，你可能会陷入一些陈规之中，并且很难理解为什么你所做的可能不是最好的方式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-09T19:50:01.103

您应该只在需要的时间和地点创建变量，并在完成后处理它们。如果类不需要类级变量来运行，那么它就不需要一个。在不需要的地方创建变量是非常糟糕的做法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-10-29T22:52:07.347

类成员应该是以下任何一种：

*   一个类的依赖
*   表示类状态的变量
*   类的一个方法

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-26T03:55:21.403

I think the answer is straightforward if you are familiar with C++ destructors. All member variables should be assigned a way to be destructed while function parameters are not. So that's why member variables are usually the states or dependicies of an object having some kind of relation regarding their lifecycle.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T19:55:26.410

我不确定是否有使用全局范围变量而不是始终作为方法参数传递的最佳实践。（通过“私有变量”，我假设您的意思是全局范围的变量。）

使用全局范围的变量是在 .NET 中实现属性的唯一方法（即使是自动属性最终也使用全局范围的变量，而不是您必须自己声明的变量）。

始终使用方法参数存在争议，因为它完全清楚值的来源。我不认为它真的有助于阻止该方法对基础值进行更改，而且在我看来，它有时会使事情变得更难阅读。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-09T19:55:53.990

我不同意实现它以实现全局访问或使编程更容易。通过在不进行任何过滤的情况下在全球范围内公开这些内容，使确定未来的访问变得更加困难。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-04-26T14:03:49.247

由于对象属性旨在保持状态，正如其他人所说，我的策略是默认情况下将它们全部设为私有，除非我有充分的理由公开它们。

如果必须的话，稍后将它们公开要容易得多，例如只需编写一个 getter 方法（我也不必在开始编写课程时就考虑到这一点）。但是稍后卷入公共财产可能需要重新编写大量代码。

我喜欢保持它的灵活性，而不必考虑超出需要的范围。

# java - 2 个输入字段显示相同的内容

> ID：529593
> 
> 赞同：2
> 
> 时间：2009-02-09T19:44:43.160
> 
> 标签：java, swing

有点奇怪。

我想要一个 JTextField，用户将在其中键入一个字符串。但是，在键入时，我希望该文本能够实时自动打印到另一个 JTextField。

我不确定这是否可能，因为我不记得看到任何应用程序这样做。

以前有人见过这样的东西吗？

实际上，现在我睁开眼睛，我看到 stackoverflow 做到了。

在 Java 中是否有任何已知的实现方式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T19:47:43.103

您也许可以为字段提供相同的文档实例。对于文档，您可以使用 swing 提供的类之一，也可以扩展自己的类。文档是文本字段的模型。

或者，您可以使用侦听器进行更新。您可以听很多东西，这取决于您的需要最适合的东西。可以监听文档，可以监听键盘鼠标事件，可以监听动作事件。（当按下回车键或失去焦点时，此类字段中会发生动作事件。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-09T20:52:52.980

“同一文件”方法是要走的路。

下面是 Groovy 中的一些示例代码（翻译成 Java 留给读者作为练习）：

```
import javax.swing.*
import java.awt.FlowLayout

f = new JFrame("foo")
t1 = new JTextField(10)
t2 = new JTextField(10)
t2.document = t1.document
f.contentPane.layout=new FlowLayout()
f.contentPane.add(t1)
f.contentPane.add(t2)
f.pack()
f.show() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T20:07:15.913

添加`ActionListener`, 因为这将响应任何更改文本的操作（不仅是按键，还包括鼠标驱动的剪切粘贴）。代码未测试...

```
// changing textField1 updates textField2
textField1.addActionListener(new ActionListener() 
{
    public void actionPerformed(ActionEvent e) 
    {
        textField2.setText(textField1.getText());
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T19:56:11.477

您可以为 jTextField 的键释放操作添加一个操作侦听器。例如：

```
 jTextField1.addKeyListener(new java.awt.event.KeyAdapter() 
    {
      public void keyReleased(java.awt.event.KeyEvent evt) 
      {
       jTextField1KeyReleased(evt);
      }
     });

  private void jTextField1KeyReleased(java.awt.event.KeyEvent evt) 
   {       
    jTextField2.setText(jTextField1.getText());
   } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T19:53:45.213

您可以使用该`KeyListener`界面，并在每个`keyTyped`事件中将文本复制到“重复”字段。

# vbscript - 动态创建 Office Open XML 文档：在打开时更新所有字段

> ID：529607
> 
> 赞同：3
> 
> 时间：2009-02-09T19:48:33.213
> 
> 标签：vbscript, openxml

我正在以编程方式生成 Office Open XML 文档（Word 2007 格式），并且希望在我生成的文档首次在 Word 中打开时更新所有字段。

当我前段时间对此进行研究时，唯一的方法是在文档打开时运行 VB 脚本。但是 VB Script 默认情况下不运行，为此用户必须授权脚本，这比要求用户执行“全选，F9”更复杂，因此这违背了目的。

有什么建议吗？

亚历克斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-08-26T19:32:04.937

有一种方法可以在没有 VB 脚本的情况下做到这一点。

您可以将字段设置为脏，并且在打开文档时它会更新。

```
<w:fldSimple w:instr="TOC" w:dirty="true" /> 
```

如果您有许多字段，您可以更新文档中的设置，以便在打开文档时更新所有字段

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<w:settings xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
    <w:updateFields w:val="true" />
</w:settings> 
```

但是，它们都有一个缺点，当打开文档时会出现一个确认对话框，上面写着“此文档包含可能引用其他文件的字段。您要更新此文档中的字段吗？”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T23:57:21.257

你的研究已经显示了正确的结果。使用 VBA 或任何其他形式的 Word 自动化是唯一的方法。Word 和 OpenXML 都可以选择在打开时自动更新字段。

# ruby-on-rails - 在多个应用程序中重用模型

> ID：529608
> 
> 赞同：0
> 
> 时间：2009-02-09T19:48:38.017
> 
> 标签：ruby-on-rails

由于托管限制，我将 ASP.NET MVC 移植到 Ruby On Rails。在我的 ASP.NET 应用程序中，我有 2 个 Web 应用程序。一个用于管理部分，一个用于公共部分。

两者都引用了一个包含我所有业务逻辑和数据的类库。

现在我想在 Ruby On Rails 中完成同样的事情。如何在两个应用程序中使用我的模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T19:55:12.137

第一枪：将业务逻辑和相关模型放入插件中。

第二枪：使用 SVN 外部或 Git 子模块在您的应用程序中复制确切的代码，例如在 APP_ROOT/lib/ 下，然后在您的环境中使用它。

最后......为什么不将管理和公共部分放在同一个应用程序中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T19:56:10.277

我会创建一个插件。叫它 IceheatSharedLogic 什么的。将模型和支持代码添加到插件并将其提交到其自己的源代码控制位置。通过 svn:externals 或等效于两个应用程序添加该插件。

但是考虑到您的用例，真的有必要拥有 2 个应用程序吗？如果您需要它们之间的任何交互（例如在页面上放置编辑链接，如果您以管理员身份登录），这似乎会使事情变得复杂。

# asp.net - 使用 IIS7 URL 重写模块将其他域重定向到主 .com 域

> ID：529616
> 
> 赞同：3
> 
> 时间：2009-02-09T19:50:04.003
> 
> 标签：asp.net, iis-7, url-rewriting, url-rewrite-module

我应该如何在 IIS7 中配置 URL 重写规则以将我的附加域（domain.net、domain.org、domain.info）重定向到主要的 .com 域？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T20:25:53.357

在 IIS7 中，您可以使用新命令“appcmd.exe”来启用重定向，如下所示：

```
%windir%\system32\inetsrv\appcmd set config "Default Web Site/" -section:system.webServer/httpRedirect -enabled:true -destination:"http://domain.com" 
```

这告诉 IIS 将发送到虚拟应用程序“/”的所有请求重定向到“<a href="http://domain.com" rel="nofollow noreferrer">http://domain.com”。实际结果是 appcmd.exe 在 web.config 文件中为“/”添加了以下部分：

您 domain.net 的 web.config

```
<system.webServer>

    <httpRedirect enabled="true" destination="http://domain.com" httpResponseStatus="Permanent"/>

</system.webServer> 
```

# wpf - WPF 编辑资源

> ID：529621
> 
> 赞同：2
> 
> 时间：2009-02-09T19:50:54.923
> 
> 标签：wpf, animation, binding, resources, brush

嗨，有什么方法可以从代码或通过某些绑定更改资源画笔？我想要做的是在单击按钮时更改“主”画笔的颜色。

非常感谢！

编辑：

它是一个 GradientBrush 我如何改变它的颜色？

```
myBrush.GradientStops[0].Color = Colors.Red; 
```

只是给了我一个例外......有没有办法让颜色变化产生动画效果，比如故事板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T20:38:39.363

要为更改设置动画，请尝试创建一个 Storyboard 并在其上调用 Begin。

（我会一起举一个例子）

编辑：看起来这是另一个 Silverlight ！= 我的 WPF 失败。我似乎无法让它在 WPF 中运行。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-09T20:17:14.080

如果您使用的是 Model-View-ViewModel (MVVM) 模式或类似的模式，您可以将画笔颜色（或整个画笔）设置为视图模型的属性并直接绑定到它。

在我（没有经验的）看来，资源不应该在运行时改变。如果要更改，请绑定它。

（edit2：从 Silverlight 样式的顶级 UserControl 更改为 WPF Window。正如 Ray Booysen 在评论中指出的那样，WPF 中的 UserControl 将通过 DependencyProperty 公开颜色，而不是将其绑定到 ViewModel。）

XAML：

```
<Grid x:Name="LayoutRoot">
    <Grid.Background>
        <SolidColorBrush Color="{Binding BackgroundColor}" />
    </Grid.Background>
    ... 
```

视图模型类：

```
public class MyViewModel : INotifyPropertyChanged
{
    public Color BackgroundColor
    {
        get { ... }
        set { ... } // fire PropertyChanged event
    }
    ... 
```

XAML.cs：

```
public partial class MyWindow : Window
{
     private MyViewModel m_viewmodel;

     public MyWindow()
     {
          InitializeComponent();
          viewmodel = new MyViewModel();
          this.LayoutRoot.DataContext = viewmodel;
     }

     private void ButtonClick(object sender, RoutedEventArgs e)
     {
         this.viewmodel.BackgroundColor = Color.Red;
     }
     ... 
```

# haskell - 是否可以更改内置 haskell 范围函数或文字的步长？

> ID：529625
> 
> 赞同：12
> 
> 时间：2009-02-09T19:52:18.023
> 
> 标签：haskell, functional-programming, range

默认

```
[1..5] 
```

给了这个

```
[1,2,3,4,5] 
```

也可以用范围函数来完成。是否可以更改点之间的步长，以便我可以得到类似下面的东西？

```
[1,1.5,2,2.5,3,3.5,4,4.5,5] 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-09T19:53:51.560

```
[1,1.5..5] 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-09T20:40:54.677

你必须小心浮点运算。它不能精确地代表 1.1，所以如果你尝试

```
Prelude> [0,0.1 .. 1]
[0.0,0.1,0.2,0.30000000000000004,0.4,0.5,0.6,0.7,0.7999999999999999,0.8999999999999999,0.9999999999999999] 
```

最好的方法更像是：

```
Prelude> map (/10) [0..10]
[0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-10T17:56:58.753

实际上，`[1..5]`是语法糖

```
enumFromTo 1 5 
```

并且`[1,1.5..5]`对于

```
enumFromThenTo 1 1.5 5 
```

有关详细信息，请参阅[http://en.wikibooks.org/wiki/Haskell/Syntactic_sugar](http://en.wikibooks.org/wiki/Haskell/Syntactic_sugar)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-13T08:12:35.040

我只是想详细说明上面的一些答案。正如@mattiast 正确提到的，

`[start, abs(start - stepSize) .. end]`实际上只是语法糖：

`enumFromThenTo start abs(start - stepSize) end`

但是，请注意中间值（在您的情况下，“1.5”**不是**步长，而是该*值应该是*从开始计算的大小。

因此，如果您想以0.2 的步长*递减*`[2,1.8..1]`，那么我们需要这样做`abs(2 - 1.8) == 0.2`

# javascript - 如何确定可打印字符上是否发生 keydown 事件？

> ID：529643
> 
> 赞同：4
> 
> 时间：2009-02-09T19:55:46.907
> 
> 标签：javascript, keydown

我们正试图阻止用户输入超出我们的数据库允许在我们的网络应用程序中的文本区域字段的最大字符。一旦它们达到文本区域中允许的最大长度，我们仍然希望允许它们按非打印键，例如：、、`Tab`+等。`backspace``ctrl``s`

我想知道是否有一种简单的方法来检测键码是否是可打印字符。我认为类似的东西`String.fromCharCode`可能会起作用并返回 false 如果它无法进行转换，但似乎不会那样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T19:58:20.927

您可以将文本框的长度设置为数据库允许的最大字符数

[W3学校](http://www.w3schools.com/TAGS/att_input_maxlength.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T20:03:04.770

试试这个：[http ://www.quirksmode.org/dom/maxlength.html](http://www.quirksmode.org/dom/maxlength.html)

Quirksmode 通过一种简单的方法来实现`maxlength`textareas 上的属性，这不是本机支持的。

并直接回答您的问题：

```
var character = String.fromCharCode(e.charCode); 
```

`e`事件的事件对象在哪里`keypress`。

# c# - 对于 DB ID，需要一个较小的 GUID 替代方案，但对于 URL 仍然是唯一且随机的

> ID：529647
> 
> 赞同：40
> 
> 时间：2009-02-09T19:56:04.473
> 
> 标签：c#, asp.net, database, url

我已经为此寻找了所有地方，但我似乎无法得到完整的答案。因此，如果 stackoverflow 上已经存在答案，那么我提前道歉。

我想要一个唯一且随机的 ID，以便我网站中的用户无法猜测下一个数字，而只是跳到其他人的信息。我计划坚持主键的递增 ID，但还要在数据库中为该行存储一个随机且唯一的 ID（某种哈希）并在其上放置一个索引。

从我的搜索中，我意识到我想避免冲突，并且我已经阅读了一些关于 SHA1 的内容。

我的基本要求是

*   比 GUID 更小的东西。（在 URL 中看起来很糟糕）
*   必须是唯一的
*   避免碰撞
*   不是一长串不可读的奇怪字符。

我正在寻找的一个例子是 www.somesite.com/page.aspx?id=AF78FEB

我不确定是否应该在数据库（我使用 SQL Server 2005）或代码（我使用 C# ASP.Net）中实现它

编辑：

从我所做的所有阅读中，我意识到这是通过默默无闻的安全性。我确实打算对这些页面进行适当的授权和身份验证。我将使用 .Net 的身份验证和授权框架。但是，一旦合法用户登录并访问一个合法（但动态创建的页面），该页面充满了属于他的项目的链接。例如，链接可能是 www.site.com/page.aspx?item_id=123。是什么阻止他点击该链接，然后将上面的 URL 更改为不属于他的 www.site.com/page.aspx?item_id=456？我知道一些像 Struts 之类的 Java 技术（我有待更正）将所有内容存储在会话中，并以某种方式从中解决，但我不知道这是如何完成的。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-09T20:09:44.533

[Raymond Chen](http://blogs.msdn.microsoft.com/oldnewthing/)有一篇关于为什么不应该使用“半个 guid”的好文章，并提供了一个合适的解决方案来生成您自己的“不太 guid 但足够好”的类型值：

> [GUID 是全局唯一的，但 GUID 的子字符串不是](https://blogs.msdn.microsoft.com/oldnewthing/20080627-00/?p=21823)

他的策略（没有具体实施）基于：

> *   四位编码计算机编号，
> *   时间戳为 56 位，以及
> *   四位作为唯一性。
> 
> 由于集群中的计算机数量是有界的，我们可以减少比特数以使计算机唯一，并且我们可以通过假设该程序在 200 年后不再使用来减少时间戳中的比特数。
> 
> 您可以通过假设时钟不会偏离偏差超过一个小时（例如）并且时钟不会每小时重置超过 16 次来摆脱四位唯一性。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-09T20:44:02.377

**更新（2017 年 2 月 4 日）：**
*[Walter Stabosz](https://stackoverflow.com/users/740639/walter-stabosz)在原始代码中发现了一个错误。经过调查，发现了进一步的错误，然而，我自己对代码进行了广泛的测试和修改，原作者 ( [CraigTP](https://stackoverflow.com/users/57477/craigtp) ) 现在已经修复了所有这些问题。我已在此处使用正确的工作版本更新了代码，您还可以[在此处下载 Visual Studio 2015 解决方案，](https://www.dropbox.com/s/j58gu10mwdowo1d/ShortCodes.zip?dl=0)其中包含“短代码”生成代码和相当全面的测试套件以证明正确性。*

我过去使用的一种有趣的机制是在内部只使用递增的整数/长整数，但将该整数“映射”到字母数字“代码”。

## 例子

```
Console.WriteLine($"1371 as a shortcode is: {ShortCodes.LongToShortCode(1371)}");
Console.WriteLine($"12345 as a shortcode is: {ShortCodes.LongToShortCode(12345)}");
Console.WriteLine($"7422822196733609484 as a shortcode is: {ShortCodes.LongToShortCode(7422822196733609484)}");

Console.WriteLine($"abc as a long is: {ShortCodes.ShortCodeToLong("abc")}");
Console.WriteLine($"ir6 as a long is: {ShortCodes.ShortCodeToLong("ir6")}");
Console.WriteLine($"atnhb4evqqcyx as a long is: {ShortCodes.ShortCodeToLong("atnhb4evqqcyx")}");    

// PLh7lX5fsEKqLgMrI9zCIA   
Console.WriteLine(GuidToShortGuid( Guid.Parse("957bb83c-5f7e-42b0-aa2e-032b23dcc220") ) ); 
```

# 代码

以下代码显示了一个简单的类，它将把 long 更改为“代码”（然后又变回来！）：

```
public static class ShortCodes
{
    // You may change the "shortcode_Keyspace" variable to contain as many or as few characters as you
    // please.  The more characters that are included in the "shortcode_Keyspace" constant, the shorter
    // the codes you can produce for a given long.
    private static string shortcodeKeyspace = "abcdefghijklmnopqrstuvwxyz0123456789";

    public static string LongToShortCode(long number)
    {
        // Guard clause.  If passed 0 as input
        // we always return empty string.
        if (number == 0)
        {
            return string.Empty;
        }

        var keyspaceLength = shortcodeKeyspace.Length;
        var shortcodeResult = "";
        var numberToEncode = number;
        var i = 0;
        do
        {
            i++;
            var characterValue = numberToEncode % keyspaceLength == 0 ? keyspaceLength : numberToEncode % keyspaceLength;
            var indexer = (int) characterValue - 1;
            shortcodeResult = shortcodeKeyspace[indexer] + shortcodeResult;
            numberToEncode = ((numberToEncode - characterValue) / keyspaceLength);
        }
        while (numberToEncode != 0);
        return shortcodeResult;
    }

    public static long ShortCodeToLong(string shortcode)
    {
        var keyspaceLength = shortcodeKeyspace.Length;
        long shortcodeResult = 0;
        var shortcodeLength = shortcode.Length;
        var codeToDecode = shortcode;
        foreach (var character in codeToDecode)
        {
            shortcodeLength--;
            var codeChar = character;
            var codeCharIndex = shortcodeKeyspace.IndexOf(codeChar);
            if (codeCharIndex < 0)
            {
                // The character is not part of the keyspace and so entire shortcode is invalid.
                return 0;
            }
            try
            {
                checked
                {
                    shortcodeResult += (codeCharIndex + 1) * (long) (Math.Pow(keyspaceLength, shortcodeLength));
                }
            }
            catch(OverflowException)
            {
                // We've overflowed the maximum size for a long (possibly the shortcode is invalid or too long).
                return 0;
            }
        }
        return shortcodeResult;
    }
} 
```

}

这本质上是您自己的 baseX 编号系统（其中 X 是 shortCode_Keyspace 常量中唯一字符的数量。

为了使事情变得不可预测，请从 1 或 0 以外的其他值开始您的内部递增编号（即从 184723 开始），并更改 shortCode_Keyspace 常量中字符的顺序（即使用字母 AZ 和数字 0-9，但会混淆它们在常量字符串中的顺序。这将有助于使每个代码有些不可预测。

如果您使用它来“保护”任何东西，这仍然是默默无闻的安全性，如果给定的用户可以观察到足够多的这些生成的代码，他们就可以预测给定时间的相关代码。其“安全性”（如果你可以这样称呼它）是 shortCode_Keyspace 常量被打乱，并且保持秘密。

编辑：如果您只想生成一个 GUID，并将其转换为仍然唯一但包含的字符较少的东西，那么这个小函数就可以解决问题：

```
public static string GuidToShortGuid(Guid gooid)
{
    string encoded = Convert.ToBase64String(gooid.ToByteArray());
    encoded = encoded.Replace("/", "_").Replace("+", "-");
    return encoded.Substring(0, 22);
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-09T20:02:23.693

如果您不希望其他用户看到人员信息，为什么不保护您正在使用该 ID 的页面？

如果你这样做了，那么使用递增的 ID 就没有关系了。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-09T20:42:58.573

[回应编辑]
您应该将查询字符串视为“邪恶输入”。您需要以编程方式检查是否允许经过身份验证的用户查看请求的项目。

```
if( !item456.BelongsTo(user123) )
{
  // Either show them one of their items or a show an error message.
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-09T20:04:07.527

您可以随机生成一个数字。检查此号码是否已在数据库中并使用它。如果您希望它显示为随机字符串，您可以将其转换为十六进制，这样您就可以像在示例中一样在其中获得 AF。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-09T20:29:14.440

GUID 是 128 位的。如果您使用这些位并且不使用仅包含 16 个字符的字符集来表示它们（16=2^4 和 128/4 = 32 个字符），而是使用具有 64 个字符的字符集（例如 Base 64） ，你最终只会有 22 个字符（64=2^6 和 128/6 = 21.333，所以 22 个字符）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-09T20:45:31.843

获取您的自动增量 ID，并使用只有您知道的秘密对其进行 HMAC-SHA1。这将生成一个看起来随机的 160 位，隐藏真正的增量 ID。然后，取一个长度的前缀，使您的应用程序不太可能发生冲突——比如 64 位，您可以将其编码为 8 个字符。使用它作为你的字符串。

HMAC 将保证没有人可以从显示的位映射回基础数字。通过散列自动增量 ID，您可以确定它是唯一的。因此，您的冲突风险来自 SHA1 中 64 位部分冲突的可能性。使用此方法，您可以通过预先生成此方法生成的所有随机字符串（例如，最多您期望的行数）并检查来预先确定是否会发生任何冲突。

当然，如果您愿意在数据库列上指定一个唯一条件，那么简单地生成一个完全随机的数字也可以。你只需要小心随机性的来源。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T20:17:18.197

多长时间才算过长？您可以将 GUID 转换为 Base 64，这最终会使其更短一些。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-09T20:30:58.523

当我想要你想要的东西时，你能做的就是我做的事情。

1.  创建您的 GUID。

2.  获取删除破折号，并获取您想要您的 ID 多长时间的子字符串

3.  检查该 ID 的数据库，如果它存在转到步骤 1。

4.  插入记录。

这是确保它是模糊的和独特的最简单的方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-09T20:52:05.243

我刚刚有了一个想法，我看到 Greg 也指出了这一点。我将用户存储在具有用户 ID 的会话中。当我创建查询时，我将使用该用户 ID 加入用户表，如果结果集为空，那么我们知道他正在破解 URL，我可以重定向到错误页面。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-02-24T00:52:35.260

**GUID 只是一个数字**

最新一代的 GUID（第 4 版）基本上是一个大随机数*

因为它是一个很大的随机数，所以碰撞的机会非常小。

您可以使用 GUID 制作的最大数字已经结束：

```
5,000,000,000,000,000,000,000,000,000,000,000,000 
```

因此，如果您生成两个 GUID，则第二个 GUID 与第一个 GUID 相同的机会是：

```
1 in 5,000,000,000,000,000,000,000,000,000,000,000,000 
```

**如果您生成 1000 亿个 GUID。**

**您的第1000 亿个**GUID 与其他 99,999,999,999个 GUID 发生冲突的可能性是：

```
1 in 50,000,000,000,000,000,000,000,000 
```

**为什么是 128 位？**

原因之一是计算机喜欢使用 8 位的倍数。

8、16、32、64、128等

另一个原因是提出 GUID 的人觉得 64 还不够，而 256 太多了。

**你需要128位吗？**

不，您需要多少位取决于您希望生成多少数字以及您希望它们不会发生冲突的程度。

**64 位示例**

那么您的第二个数字与第一个数字发生冲突的可能性是：

```
1 in 18,000,000,000,000,000,000 (64 bit) 
```

代替：

```
1 in 5,000,000,000,000,000,000,000,000,000,000,000,000 (128 bit) 
```

那么第**1000 亿**个数字呢？

您的第 1000 亿个数字与其他 99,999,999,999 发生冲突的可能性是：

```
1 in 180,000,000 (64 bit) 
```

代替：

```
1 in 50,000,000,000,000,000,000,000,000 (128 bit) 
```

那么你应该使用64位吗？

取决于您是否生成 1000 亿个数字？即使你当时是 180,000,000 会让你不舒服吗？

**有关 GUID 的更多详细信息**

我说的是第 4 版。

版本 4 实际上并没有将所有 128 位用于随机数部分，它使用 122 位。其他 6 位用于指示这是 GUID 标准的版本 4。

此答案中的数字基于 122 位。

是的，因为它只是一个随机数，您可以从中获取所需的位数。（只要确保你没有使用 6 个永远不会改变的版本控制位中的任何一个 - 见上文）。

尽管您可以使用与 GUID 相同的随机数生成器而不是从 GUID 中获取位，但您可以从中获取位。

它*可能*使用了操作系统附带的随机数生成器。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-01-20T15:44:51.117

聚会迟到了，但我发现这是在 C# 中生成 Base62 随机字符串的最可靠方法。

```
private static Random random = new Random();

void Main()
{
    var s = RandomString(7);
    Console.WriteLine(s);
}

public static string RandomString(int length)
{
    const string chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
    return new string(Enumerable.Repeat(chars, length)
        .Select(s => s[random.Next(s.Length)]).ToArray());
} 
```

# ruby-on-rails - 如何为我有点独立的 Ruby 脚本设置 Rails 环境？

> ID：529651
> 
> 赞同：8
> 
> 时间：2009-02-09T19:56:37.063
> 
> 标签：ruby-on-rails, ruby

我的 Rails 应用程序中有一个 Ruby 脚本，用于从 Twitter 加载一些数据。

将来我会将其设为自动后台进程，但现在我手动运行它，如下所示：

```
ruby /lib/twitter/twitterLoad.rb 
```

为了使用 Rails 模型类等，我将以下内容作为脚本的第一行：

```
require "#{File.dirname(__FILE__)}/../../config/environment.rb" 
```

默认情况下，使用开发环境。但是，我希望能够在某个时候选择生产环境。

**更新 #1**： RAILS_ENV 常量正在 environment.rb 文件中设置。因此，我能够将 ENV['RAILS_ENV'] = 'production' 放在最顶部（在 environment.rb 之前）行并在一定程度上解决了我的问题。所以，我的新问题是，可以通过命令行传入环境变量吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-09T20:50:52.017

如果你打算使用 rails 环境，最好的办法是把它做成一个 rake 脚本。为此，将*twitter.rake*文件放入*lib/tasks*并像这样开始和结束它：

```
task(:twitter_load => :environment) do
  # your code goes here
end 
```

那样的话，你是通过“遵循惯例”来做的，它没有与之相关的“可怕的气味”。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-09T20:14:27.847

我目前使用的是下面的方法，我知道环境没有rb扩展名，不需要。您也可以在运行之前设置它以覆盖`ENV["RAILS_ENV"]`.

```
#!/usr/bin/env 红宝石

# 在这里设置你的环境。
ENV["RAILS_ENV"] ||= "生产"

需要 File.dirname(__FILE__) + "/../../config/environment"

提出“导轨已加载！”

```

然后要更改环境，只需运行它：

```
rb /lib/tasks/file.rb RAILS_ENV=development
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-09T23:00:31.067

不要忘记[script/runner](http://daddy.platte.name/2007/07/hidden-in-plain-sight-scriptrunner.html)。

从命令行设置环境变量并

```
ruby script/runner your_script_here.rb 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-07T22:58:48.403

公认的使用答案`rake`很受欢迎，但您可能仍希望手动设置环境以测试实用程序类。

这是我用来在`/lib`. 对于这些，我倾向于使用 Ruby 约定，让我的类文件在从命令行运行时执行其测试。通过这种方式，我可以在 Rails 以 Web 为中心的测试工具之外进行 TDD，但仍然可以在内部使用该类，`rake`而不会影响它设置的环境。

这在顶部：

```
if (__FILE__ == $0)
  ENV['RAILS_ENV'] ||= 'test'
  require File.join(File.dirname(__FILE__),'../config/environment.rb')
end 
```

这在底部：

```
if (__FILE__ == $0)
  require 'test/unit/ui/console/testrunner'
  Test::Unit::UI::Console::TestRunner.run(MyClassTest)
end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T20:03:26.173

你也可以做

脚本/控制台开发 < path/to/your/script.rb

确实很麻烦 - 并且在评估脚本的每一行之后会吐出很多 irb 垃圾 - 但适用于快速，你不必记住该死的 require 行。

并且不要忘记，用做有用的事情的脚本来扩展你的应用程序的最优雅的方法可能是编写 Rake 任务！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T19:59:35.743

添加行： `RAILS_ENV = '<your environment of choice>'`

[http://wiki.rubyonrails.org/rails/pages/Environments#script](http://wiki.rubyonrails.org/rails/pages/Environments#script)

pantulis：这很酷，但对于快手我只使用 RAILS_ENV = `'<your environment of choice>' ruby path/to/script.rb`。这就是您在控制台中设置环境变量的方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-21T15:19:07.683

```
require 'bundler'
require 'bundler/setup'

ENV['RAILS_ENV'] ||= 'development'

RAILS_ROOT = Pathname.new(File.expand_path('~/path/to/root'))

puts "Loading Rails Environment from #{RAILS_ROOT}..."
require RAILS_ROOT.join('config/environment').to_s 
```

这有效，但前提是您的脚本的 Gemfile 包含您的 rails 应用程序的所有依赖项。您可能能够从另一个加载一个 Gemfile，例如只是`eval`它，以克服这种复制/粘贴。

# jquery - JQuery自动完成结果格式？

> ID：529652
> 
> 赞同：2
> 
> 时间：2009-02-09T19:56:37.513
> 
> 标签：jquery, asp.net-mvc, autocomplete

我有一串由空格分隔的值，我返回给 Jquery 调用，但它没有将单词分隔成行。数据应该以字符串、列表或其他形式返回吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T20:00:37.833

默认情况下，它希望结果由换行符分隔。如果您提供由空格分隔的值列表，您将需要提供一个解析函数，该函数将获取返回的数据并将其转换为数组。如果您改为提供值列表，情况也是如此。

这是我正在处理的一个项目的示例，它通过 JSON 从 MVC 操作返回字符串列表。

```
$('#eventName').autocomplete( '<%= Url.Action("SearchEvent", "Donor" ) %>', {
    dataType: "json",
    formatItem: function(data,i,max,value,term){
       return value;
    },
    parse: function(data){
        var array = new Array();
        for(var i=0;i<data.length;i++)
        {
            array[array.length] = { data: data[i], value: data[i], result: data[i] };
        }
        return array;
   }
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T19:59:34.683

如果您使用的是位于[此处](http://plugins.jquery.com/project/jq-autocomplete)的插件，那么我认为您会以 JSON 格式返回结果。这是[使用 ASP.Net MVV](http://blog.schuager.com/2008/09/jquery-autocomplete-json-apsnet-mvc.html)的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T17:39:27.127

还有另一个自动完成插件希望用“|”分隔字符串 像这样的角色：

项目 1 | 项目 2 |

您可能想查看您正在使用的文档！

# ruby-on-rails - 如何在 Rails 测试中指定 POST 参数？

> ID：529653
> 
> 赞同：23
> 
> 时间：2009-02-09T19:56:40.260
> 
> 标签：ruby-on-rails, ruby, testing, shoulda

使用 Test::Unit 和 Shoulda。试图测试`Users.create`。我的理解是 Rails 表单为这样的对象发送参数：

```
user[email] 
```

这在你的行动中变成了哈希，对吧？

```
params[:user][:email] 
```

好的，所以在我的测试中，我尝试过......

```
setup { post :create, :post => { 'user[email]' => 'invalid@abc' } } 
```

和

```
setup { post :create, :post => { :user => { :email => 'abc@abcd' } } } 
```

在这两种情况下，在我的行动中，`params[:user]`都是零。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-02-09T19:59:03.453

```
post :create, :user => { :email => 'foo@bar.com' } 
```

get、post、put、delete所有测试方法的通用形式如下：

```
def post(action_name, params_hash = {}, session_hash = {}) 
```

在测试中，params 哈希直接发送到`params`您的控制器操作中，无需任何类型的转换。即使进行集成测试，您也确实不需要测试此字符串以进行参数转换，因为 rails 框架测试很好地涵盖了它。另外，所有需要参数的测试方法都以这种方式接受哈希，而不会抱怨，这让您的事情变得容易。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-25T03:31:03.807

```
post :create, {:post => {}, :user => {:email => 'abc@abcd'} }
```

在这种情况下，params[:post] 是 {}，params[:user] 是 {:email => 'abc@abcd'}，params[:user][:email] 是 'abc@abcd'。

```
post :create, {:post => {:user => {:email => 'abc@abcd'} } }
```

在这种情况下 params[:post][:user][:email] 是 'abc@abcd'

# c# - 返回序列标量值的 PL/SQL 问题

> ID：529654
> 
> 赞同：2
> 
> 时间：2009-02-09T19:56:42.880
> 
> 标签：c#, oracle, stored-procedures, plsql

我正在尝试从存储在包中的 proc 将 sequence.nextval 返回到我的程序。当谈到 PL/SQL 时，我是相当绿色的，我对正在发生的事情有点茫然。实际返回的错误是

PLS-00306：对 PROCGET_BOOKMARKID 第 1 行、第 7 列语句的调用中的参数数量或类型错误。

这是我的包创建代码...

```
创建或替换
包 BOOKMARKS AUTHID DEFINER 是
  类型 t_Bookmark 是参考光标；

  过程 procGet_Bookmarked_Information(bookmarkId in NUMBER, 书签出 t_Bookmark);
  过程 procInsert_Bookmark（NUMBER 中的 bookmarkId，VARCHAR2 中的 currExtent，VARCHAR2 中的 selectedLayers）；
  过程 procGet_Bookmark_Id(bookmarkId out NUMBER);

结束书签；

```

get_bookmark_id 的过程看起来像这样（其他过程工作正常，所以我不打算发布它们）......

```
 procedure procGet_Bookmark_Id(bookmarkId out NUMBER)
  IS
  BEGIN
    SELECT seq_bookmarks.nextval INTO bookmarkId
      FROM dual;

  END procGet_Bookmark_Id; 
```

现在，我确定这不是我的顺序。如果我只是通过这样做直接从我的代码中查询数据库，我可以获得 nextval...

```
 string sql = string.Format(@"select {0}.seq_bookmarks.nextval from dual", ApplicationSchema); 
```

在这种情况下，应用程序模式只是我要连接的数据库。

因此，在我看来，问题完全出在我的 PL/SQL 中，这是有道理的，因为我几乎没有使用过它。有任何想法吗？

**编辑** 好的，这里是实际调用的代码。

```
 DataOperationResult result = DataAccess.GetBookmarkId();
DataRow currResult = result.DataTableResult.Rows[0]; 
```

其中 DataAccess 是一类查询，以下是该特定查询的代码。

```
 string sql = string.Format("{0}.bookmarks.procGet_Bookmark_Id", ApplicationSchema);
DataOperation operation = new DataOperation(DataOperationType.ExecuteScalar, ConnectionString, System.Data.CommandType.StoredProcedure, sql);
return operation.PerformOperation(); 
```

Application Schema 就是我们要查询的数据库。ExecuteScalar 有点啰嗦，我没有编写的代码应该被认为可以工作（假设关键字）。希望这足以让您了解正在发生的事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T20:27:24.227

我刚刚编译了你的包，`PL/SQL Developer`它工作正常。

问题似乎出在`C#`代码中的数据类型上。

根据我在描述中看到的，您没有绑定任何参数。您应该在代码中的某处绑定参数，例如

```
OracleParameter bid = new OracleParameter("bookmarkID", OracleDbType.Number);
bid.Direction = ParameterDirection.Output;
command.Parameters.Add(bid); 
```

如果您需要处理很多抽象，您可以将您的过程重新定义为一个函数：

```
FUNCTION procGet_Bookmark_Id RETURN INTEGER
IS
  res INTEGER;
BEGIN
  SELECT seq_bookmarks.nextval
  INTO res
  FROM dual;
  RETURN res;
END procGet_Bookmark_Id; 
```

`SELECT`并在查询中调用它：

```
SELECT bookmarks.procGet_Bookmark_id FROM dual; 
```

，您似乎可以做到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T20:41:53.507

错误：“调用 blah 时参数的数量或类型错误”是指调用代码中的错误，而不是被调用代码中的错误。

您应该检查以下内容：

*   您传递的参数是 NUMBER 或可以轻松从 NUMBER 转换的类型。
*   您传递的参数是一个变量，而不是文字或常量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T20:58:04.620

我相信您需要在 .net 代码中传入参数。您为参数指定的名称在 .net 代码和过程定义中必须相同。

-或者-

使用 PL/SQL 函数而不是过程。您根本不需要使用参数。

编辑：假设您使用的是 Microsoft Provider，您将需要一个返回参数。这是.net代码。

```
// proc is the procedure name, oraConn is the oracle connection
OracleCommand cmd = new OracleCommand(proc, oraConn);
cmd.CommandType = System.Data.CommandType.StoredProcedure;

OracleParameter ret = new OracleParameter();
ret.Direction = System.Data.ParameterDirection.ReturnValue;
ret.OracleType = OracleType.Number;
cmd.Parameters.Add(ret); 
```

# saml - SAML 身份验证请求中是否允许使用属性？

> ID：529655
> 
> 赞同：7
> 
> 时间：2009-02-09T19:56:44.830
> 
> 标签：saml

是否可以在 SAML 身份验证请求中发送属性？

```
<samlp:AuthnRequest
   xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol"
   xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"
   ID="aaf23196-1773-2113-474a-fe114412ab72"
   Version="2.0"
   IssueInstant="2004-12-05T09:21:59Z"
   AssertionConsumerServiceIndex="0"
   AttributeConsumingServiceIndex="0">
   <saml:Issuer>https://sp.example.com/SAML2</saml:Issuer>
   <samlp:NameIDPolicy
     AllowCreate="true"
     Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient"/>
 </samlp:AuthnRequest> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T07:36:51.840

从技术上讲，是的，这是可能的，因为 AuthnRequest 可以包含一个 Extensions 元素，该元素可以包含任何内容 - 请参阅[SAML“核心”规范](http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf)：AuthnRequest（第 3.4.1 节）派生自 RequestAbstractType（第 3.2.1 节），它有一个可选的扩展。发送者和接收者必须就以这种方式发送的数据的语法和语义达成一致。

我看不到更“传统”的方法来做到这一点，因为属性通常在断言中，而不是在 AuthnRequests 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T06:45:47.930

在某些情况下，属性将成为身份验证请求的一部分。这样我们就可以从请求中获取该属性名称以构造相同的响应断言。

因为服务提供商通过比较属性名称来验证响应。我们可以以 Salesforce 作为服务提供商为例，同样的情况也会发生。

# regex - 我如何编写一个在每一行上执行多次替换的正则表达式，除非该行以某个字符串开头？

> ID：529657
> 
> 赞同：3
> 
> 时间：2009-02-09T19:57:55.640
> 
> 标签：regex, perl

我正在尝试编写一个正则表达式，它用尖括号包围“http”URL，但以两个斜杠开头的行除外。我想出的最好的是：

`s#^(?!//)(.*?)([http://[](http://[)^\s]+)#$1<$2>#gm;`

这对这两个非常有用：

* * *

输入：`[http://a.com](http://a.com)`

输出：`<[http://a.com](http://a.com)>`

* * *

输入：`//[http://a.com](http://a.com)`

输出：`//[http://a.com](http://a.com)`

* * *

但是，它在这里失败了：

* * *

输入：`[http://a.com](http://a.com) [http://b.com](http://b.com)`

实际输出：`<[http://a.com](http://a.com)> [http://b.com](http://b.com)`

期望的输出：`<[http://a.com](http://a.com)> <[http://b.com](http://b.com)>`

* * *

为什么我的正则表达式不匹配？我使用 /g 错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T20:10:26.233

你真的应该使用两个正则表达式；一种用于识别“注释掉”的行，另一种用于修改常规行中的 http。

可能有一种非标准的方式来组合这两个正则表达式或替换所有多个 (http...)+ 匹配项，但我不会使用它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T20:10:49.117

对于无限数量的表达式，您不能真正做到这一点。试试这个：

```
s#(http://[^\s]+)#<$1>#g unless m#^//#; 
```

这将替换该行中的所有 URL，但前提是该行的前两个字符不是“//”。当然，它有点复杂，但它有效（我认为）。

编辑：我的答案与 aib 的相同，但我有代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T20:19:40.733

稍微改写一下……根据我的建议并使用空格修饰符，这样它实际上是可读的。:)

```
s{
    (?:^|\G)     # start of the last match, so you never backtrack and don't capture.
    (?!//)       # a section without //
    (.*?)        # followed by anything
    (
        http://  # with http://
        [^\s]+   # and non-spaces - you could also use \S
    )
 }
 {$1<$2>}xmg; 
```

在 perl 中尝试这个，我们得到：

```
sub test {
    my ($str, $expect) = @_;
    my $mod = $str;
    $mod =~ s{
            (?:^|\G)       # start of the last match, so you never backtrack.
            (?!//)       # a section without //
            (.*?)        # followed by anything
            (
                http://  # with http://
                [^\s]+   # and non-spaces - you could also use \S
            )
          }
          {$1<$2>}xmg;
    print "Expecting '$expect' got '$mod' - ";
    print $mod eq $expect ? "passed\n" : "failed\n";
}

test("http://foo.com",    "<http://foo.com>");
test("// http://foo.com", "// http://foo.com");
test("foo\nhttp://a.com","foo\n<http://a.com>");

# output is 
# Expecting '<http://foo.com>' got '<http://foo.com>' - passed
# Expecting '// http://foo.com' got '// http://foo.com' - passed
# Expecting 'foo
# <http://a.com>' got 'foo
# <http://a.com>' - passed 
```

编辑：几个更改：添加了 'm' 修饰符以确保它从行首匹配，并将 \G 更改为 (^|\G) 以确保它也开始查看行首。

# maven-2 - 在 pom.xml 中使用 Snowball 分析器和 Lucene 2.4.0 的正确依赖项是什么？

> ID：529663
> 
> 赞同：0
> 
> 时间：2009-02-09T19:58:45.153
> 
> 标签：maven-2, lucene, snowballanalyzer

我正在尝试在我的 Maven 2 项目中将[SnowballAnalyzer](http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/analysis/snowball/SnowballAnalyzer.html "Lucene 2.4.0 中 Snowball Analyzer 的 JavaDoc")换成[StandardAnalyzer 。](http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/analysis/standard/StandardAnalyzer.html "Lucene 2.4.0 中标准分析器的 JavaDoc")我目前正在使用

```
 <dependency>
        <groupId>org.apache.lucene</groupId>
        <artifactId>lucene-contrib</artifactId>
        <version>2.4.0</version>
        <scope>compile</scope>
    </dependency> 
```

但我不断收到以下错误：

```
Missing:
----------
1) org.apache.lucene:lucene-contrib:jar:2.4.0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T20:07:01.967

从回购看起来你应该包括这个：

```
<dependency>
   <groupId>org.apache.lucene</groupId>
   <artifactId>lucene-snowball</artifactId>
   <version>2.4.0</version>
</dependency> 
```

至少从我可以从[http://repo1.maven.org/maven2/](http://repo1.maven.org/maven2/)看到的看起来像正确的依赖项？

# ruby-on-rails - OpenID 委托似乎不适用于 Rails 的 OpenID 身份验证插件

> ID：529664
> 
> 赞同：0
> 
> 时间：2009-02-09T19:58:59.270
> 
> 标签：ruby-on-rails, openid

我刚刚安装了 OpenID 身份验证插件，因为我想将它用于我的项目，但是当我尝试使用我的博客 url 登录时，我收到了第一条错误消息：

“抱歉，找不到 OpenID 服务器”

插件是否支持委托？

如果是，我的博客有什么问题？（我使用 wp-openid 和 XRDS-Simple）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T20:06:22.453

是的，它确实支持这一点。适用于我的博客：beautifulpixel.com

它是否找到了该服务器的 OpenID 服务器？如果没有检查你的头部标签。

顺便说一句，[http](http://thewinespies.com/) ://thewinespies.com/ 为 OpenID 运行这个插件，所以如果你愿意，你可以在那里运行健全性检查。

# log4net - log4net 嵌套记录器 .config 示例

> ID：529667
> 
> 赞同：0
> 
> 时间：2009-02-09T19:59:06.667
> 
> 标签：log4net

我正在努力在多层应用程序中设置 log4net。我已根据需要设置了大部分日志记录，但现在我正试图以`<logger>`某种方式设置 .config 中的条目，以允许输出级别的最大灵活性。

我的记录器命名约定类似于：
ExecutableName.WorkerThreadName.[ExternalModuleName(s)].ClassName

我当前在 .config 文件中的记录器定义部分如下所示：

```
<root>
  <level value="DEBUG" />
  <appender-ref ref="MyAppender" />
</root>

<logger name = "ExecutableName">
  <level value="FATAL" />   
</logger>

<logger name = "ExecutableName.WorkerThreadName">
  <level value="OFF" />     
</logger>

<logger name = "ExecutableName.WorkerThreadName.ClassName">
  <level value="INFO" />        
</logger>
<!--repeat as necessary---> 
```

希望您能明白这一点……这似乎有可能爆发成一堆难以维护的条目（尤其是当应用程序达到支持阶段时）。
关于如何最好地管理嵌套记录器的级别定义的任何建议？
我已经尝试过实际嵌套 xml 语句，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T23:26:49.133

一般来说，我想捕获所有消息，至少是警告和严重级别。由于记录器从层次结构中较高的记录器以及最终从根记录器继承其级别，因此我仅将级别分配给顶级记录器。在您的情况下，这将是“ExecutableName”记录器。

对于那些我对查看除 FATAL 消息以外的信息不感兴趣的特殊情况记录器，我将添加一个特定的级别设置。但这通常不是一般情况，因此规模是可控的。

我发现在那些顶级记录器上设置例如 WARN 或 INFO 很有用，然后在各个级别上使用带有过滤器的附加程序。结果是潜在的大量消息根据级别被分组到不同的存储中。您甚至可以为每个顶级记录器设置单独的附加程序，以便对消息流进行更细粒度的控制。

# c# - 如何在 IntelliSense 中为 Visual Studio 中的功能添加注释？

> ID：529677
> 
> 赞同：147
> 
> 时间：2009-02-09T20:02:14.770
> 
> 标签：c#, vb.net, visual-studio, visual-studio-2008, xml-comments

在 Visual Studio 和 C# 中，当使用 ToString() 等内置函数时，IntelliSense 会显示一个黄色框来解释它的作用。

[![替代文字](https://i.stack.imgur.com/P7MxK.jpg)](https://i.stack.imgur.com/P7MxK.jpg) [![替代文字](https://i.stack.imgur.com/OKDcw.jpg)](https://i.stack.imgur.com/OKDcw.jpg)

**对于我编写的函数和属性，我怎样才能拥有它？**

* * *

## 回答 #1

> 赞同：235
> 
> 时间：2009-02-09T20:04:51.800

要生成一个区域，您可以在其中指定函数的描述和函数的每个参数，请在函数之前的行中键入以下内容并点击`Enter`：

*   **C＃：** `///`

*   **VB：** `'''`

有关可以包含在这些注释中的结构化内容的更多信息，请参阅[文档注释的推荐标签（C# 编程指南） 。](https://msdn.microsoft.com/en-us/library/5ast78ax.aspx)

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2009-02-09T20:08:19.093

您需要的是**xml 注释**- 基本上，它们遵循以下语法（正如 Solmead 模糊描述的那样）：

**C＃**

```
///<summary>
///This is a description of my function.
///</summary>
string myFunction() {
     return "blah";
} 
```

**VB**

```
'''<summary>
'''This is a description of my function.
'''</summary>
Function myFunction() As String
    Return "blah"
End Function 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2016-05-30T22:34:27.237

`<c>text</c>`- 您想表示为代码的文本。
< *c* > 标签为您提供了一种方法来指示描述中的文本应标记为代码。使用 < *code* > 将多行表示为代码。

`<code>content</code>`- 您想要标记为代码的文本。
< *code* > 标签为您提供了一种将多行指示为代码的方法。使用 < *c* > 表示描述中的文本应标记为代码。

`<example>description</example>`- 代码示例的描述。
< *example* > 标签让您指定如何使用方法或其他库成员的示例。这通常涉及使用 < *code* > 标签。

`<exception cref="member">description</exception>`- 异常的描述。
< *exception* > 标签让你指定可以抛出哪些异常。此标记可应用于方法、属性、事件和索引器的定义。

`<include file='filename' path='tagpath[@name="id"]' />`
< *include* > 标记允许您引用另一个文件中描述源代码中的类型和成员的注释。这是直接在源代码文件中放置文档注释的替代方法。通过将文档放在单独的文件中，您可以将源代码控制与源代码分开应用于文档。一个人可以签出源代码文件，其他人可以签出文档文件。< *include* > 标记使用 XML XPath 语法。请参阅 XPath 文档以了解自定义 < *include* > 使用的方法。

```
<list type="bullet" | "number" | "table">
    <listheader>
        <term>term</term>
        <description>description</description>
    </listheader>
    <item>
        <term>term</term>
        <description>description</description>
    </item>
</list> 
```

< *listheader* > 块用于定义表或定义列表的标题行。定义表格时，您只需在标题中提供术语条目。列表中的每个项目都使用 < *item* > 块指定。创建定义列表时，您需要指定术语和描述。但是，对于表格、项目符号列表或编号列表，您只需要提供一个条目进行描述。列表或表格可以根据需要包含任意数量的 < *item* > 块。

`<para>content</para>`
< *para* > 标签用于标签内部，例如< *summary* >、< *remarks* > 或< *returns* >，并允许您为文本添加结构。

`<param name="name">description</param>`
< *param* > 标签应该用在方法声明的注释中，以描述方法的参数之一。要记录多个参数，请使用多个 < *param* > 标签。*< param*
> 标记 的文本将显示在 IntelliSense、对象浏览器和代码注释 Web 报告中。

 *`<paramref name="name"/>`
< *paramref* > 标记为您提供了一种方法来指示代码注释中的单词，例如在 < *summary* > 或 < *remarks* > 块中引用参数。可以处理 XML 文件以以某种不同的方式格式化该单词，例如使用粗体或斜体字体。

< `permission cref="member">description</permission>`
< *permission* > 标签让您记录成员的访问权限。PermissionSet 类允许您指定对成员的访问权限。

`<remarks>description</remarks>`
< *remarks* > 标签用于添加关于类型的信息，补充 < *summary* > 指定的信息。此信息显示在对象浏览器中。

`<returns>description</returns>`
< *returns* > 标签应该用在方法声明的注释中来描述返回值。

`<see cref="member"/>`
< *see* > 标签允许您从文本中指定链接。使用 < *seealso* > 指示文本应放置在 See Also 部分中。使用 cref 属性为代码元素创建指向文档页面的内部超链接。

`<seealso cref="member"/>`
< *seealso* > 标记可让您指定可能希望出现在“另见”部分中的文本。使用 < *see* > 从文本中指定链接。

`<summary>description</summary>`
< *summary* > 标签应该用于描述类型或类型成员。使用 < *remarks* > 将补充信息添加到类型描述中。使用 cref 属性启用文档工具，例如 Sandcastle，以创建指向代码元素文档页面的内部超链接。*< summary* > 标记的文本是 IntelliSense 中类型信息的唯一来源，也显示在对象浏览器中。

`<typeparam name="name">description</typeparam>`
< *typeparam* > 标签应该用在泛型类型或方法声明的注释中来描述类型参数。为泛型类型或方法的每个类型参数添加一个标记。< *typeparam* > 标记的文本将显示在 IntelliSense（对象浏览器代码注释 Web 报告）中。

`<typeparamref name="name"/>`
使用此标签可以使文档文件的使用者以某种不同的方式格式化单词，例如斜体。

`<value>property-description</value>`
< *value* > 标签让你描述一个属性代表的值。请注意，当您在 Visual Studio .NET 开发环境中通过代码向导添加属性时，它将为新属性添加一个 < *summary* > 标记。然后，您应该手动添加一个 < *value* > 标记来描述该属性所代表的值。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-09T20:06:45.993

做 XML 注释，像这样

```
/// <summary>
/// This does something that is awesome
/// </summary>
public void doesSomethingAwesome() {} 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-02-09T20:07:00.233

使用 /// 开始评论的每一行，并让评论包含元数据阅读器的[适当 xml](http://msdn.microsoft.com/en-us/library/b2s063f7.aspx)。

```
///<summary>
/// this method says hello
///</summary>
public void SayHello(); 
```

尽管就我个人而言，我相信这些评论通常是被误导的，除非你正在开发代码不能被消费者阅读的类。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-09T20:09:53.630

这些被称为[XML 注释](http://msdn.microsoft.com/en-us/magazine/cc302121.aspx)。它们一直是 Visual Studio 的一部分。

您可以使用[GhostDoc 简化](http://www.roland-weigelt.de/ghostdoc/)文档过程，它是 Visual Studio 的免费插件，可为您生成 XML 文档注释。只需将插入符号放在要记录的方法/属性上，然后按 Ctrl-Shift-D。

[这是我的一篇文章中](https://stackoverflow.com/questions/461306/how-to-document-thrown-exceptions-in-c-net/461515#461515)的一个例子。

希望有帮助:)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-12-16T11:17:24.360

定义这样的方法，您将获得所需的帮助。

```
 /// <summary>
    /// Adds two numbers and returns the result
    /// </summary>
    /// <param name="first">first number to add</param>
    /// <param name="second">second number to </param>
    /// <returns></returns>
    private int Add(int first, int second)
    {
        return first + second;
    } 
```

[代码使用截图](https://i.stack.imgur.com/myB2T.png)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-12-11T22:19:00.020

在 CSharp 中，如果您使用 Parms 创建方法/函数大纲，那么当您添加三个正斜杠时，它将自动生成摘要和 parms 部分。

所以我输入：

```
public string myMethod(string sImput1, int iInput2)
{
} 
```

然后我把三个 /// 放在它前面，Visual Studio 给了我这个：

```
/// <summary>
/// 
/// </summary>
/// <param name="sImput1"></param>
/// <param name="iInput2"></param>
/// <returns></returns>
public string myMethod(string sImput1, int iInput2)
{
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-05-24T19:00:46.457

阅读[http://msdn.microsoft.com/en-us/library/3260k4x7.aspx](http://msdn.microsoft.com/en-us/library/3260k4x7.aspx)仅指定注释不会在智能感知中显示帮助注释。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-11-15T14:15:54.000

所有这些其他答案都是有道理的，但并不完整。Visual Studio 将处理 XML 注释，但您必须打开它们。以下是如何做到这一点：

Intellisense 将使用您在源代码中输入的 XML 注释，但您必须通过 Visual Studio 选项启用它们。转到`Tools`> `Options`> `Text Editor`。对于 Visual Basic，启用`Advanced`>`Generate XML documentation comments for '''`设置。对于 C#，启用`Advanced`>`Generate XML documentation comments for ///`设置。Intellisense 将在输入时使用摘要注释。编译引用的项目后，它们将在其他项目中可用。

要创建*外部*文档，您需要通过控制编译器选项的`Project Settings`>>路径生成 XML 文件`Build`。您将需要一个外部工具，它将 XML 文件作为输入并以您选择的输出格式生成文档。`XML documentation file:``/doc`

请注意，生成 XML 文件会显着增加编译时间。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-09T20:07:13.603

此外，Visual Studio 插件 Ghost 文档将尝试根据您的函数名称创建和填写标题注释。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-09T20:06:47.583

Solmead 有正确的答案。有关更多信息，您可以查看[XML 注释](http://msdn.microsoft.com/en-us/library/b2s063f7.aspx)。

# python - Python、ROOT 和 MINIT 集成？

> ID：529678
> 
> 赞同：3
> 
> 时间：2009-02-09T20:02:17.127
> 
> 标签：python, word-wrap, data-analysis, root-framework

我是高能粒子物理系的一名谦虚的研究生。由于对 C/C++ 毫无根据的厌恶和对 python 的热爱，到目前为止，我已经求助于 python 进行数据分析（只是简单的东西），并且即将尝试支持针对 ROOT 库的 python 脚本，特别是使用 MINUIT 进行一些参数最小化。

除了询问是否有人对这些安装和使用有任何提示之外，我想知道是否值得尝试一下，或者只是进入使用 C/C++ 的“规范”，或者像 pyminuit 这样的东西是否可用. 或者你认为我可以将整个 C/C++ 脚本包装成 python 代码，以利用我现有的自写分析方法（我还没有包装经验）。抱歉含糊不清；我正走向一个远远超过我目前经历的未知数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T21:16:03.983

您知道[pyROOT](http://wlav.web.cern.ch/wlav/pyroot/)，对吗？

我自己从未尝试过，所以我不知道它会如何满足您的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-12T08:36:12.543

可能值得[一试 rootpy](http://ndawe.github.com/rootpy/)。也许还没有完全成熟，但这是朝着正确方向迈出的一步。

是的，rootpy 建立在[PyROOT 之上](http://wlav.web.cern.ch/wlav/pyroot/)，但具有一些附加功能：

*   它强调了一个pythonic接口，并隐藏了ROOT的一些丑陋；
*   它与[matlibplot](http://matplotlib.sourceforge.net/)集成，后者拥有更大的开发社区，并且在 SO 上的存在更大，更不用说更好看的情节了；
*   它允许转换为[HDF5](http://www.hdfgroup.org/HDF5/)文件，这将允许您与无法花时间安装整体 ROOT 包的人共享数据。

不幸的是，只要您使用的是基于[CINT](http://root.cern.ch/drupal/content/cint)（即 PyROOT）构建的东西，您仍然必须处理[ROOT 最丑陋的部分之一](http://root.cern.ch/drupal/content/do-we-need-yet-another-custom-c-interpreter)。

* * *

如果您厌倦了 PyROOT，另一种选择是使用[将 ROOT 直接转换为 HDF5 的软件包之一](https://github.com/dguest/ttree2hdf5)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T06:59:47.000

不久前我写了一个 minuit 包装器（在我的 1 次体验示例中，ROOT 的 minuit 似乎比 pyminuit 更健壮，我更喜欢 ROOT Minuit 输出）

[https://github.com/piti118/RTMinuit](https://github.com/piti118/RTMinuit)

具有 numpy 根文件读取能力

[https://github.com/piti118/root_numpy](https://github.com/piti118/root_numpy)

并且基于 RTMinuit 和 numpy 的拟合库和玩具生成等没有那么完善

[https://github.com/piti118/dist_fit](https://github.com/piti118/dist_fit)

教程和帮助都在包中给出

# c++ - 第三方dll丢失，等待中怎么办？

> ID：529684
> 
> 赞同：1
> 
> 时间：2009-02-09T20:03:56.250
> 
> 标签：c++, methodology

我正在处理一个遗留的 C++ 项目并且缺少第三方 dll。有人告诉我，该 dll 将在两周内提供。我需要执行的工作是纯 UI。我真的不需要dll。但是，如果没有 dll，应用程序将无法运行。我应该注释掉所有调用 dll 的地方还是创建一个占位符 dll，无论哪种方式都有大量的 API 需要覆盖？没有人有更好的主意吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T20:07:36.317

我会创建一个什么都不做的存根 DLL（或者你需要它做的很少）。然后当你得到真正的，把它放在你的存根上，你就完成了。

如果您需要创建无数个函数，您也许可以使用 perl 或其他一些脚本语言来帮助将大量链接器错误转换为包含所需函数原型的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T14:06:56.450

如果您可以访问 EXE 的源代码（看起来是这样），并且您正在运行任何最新的 Visual Studio（6 或更高版本），一个简单的解决方案是使用 /DelayLoad 进行重建。这意味着链接器将设置 EXE 以调用 LoadLibrary 并在第一次调用时解析导入。这意味着，如果您实际上不*调用*DLL，它就永远不会加载，并且通过扩展，不会丢失。

这意味着您不必创建任何存根 DLL；这是一个 5 分钟的变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T15:17:31.007

`LoadLibrary`我通常通过和调用动态加载非必要的 DLL ，`GetProcAddress`这样我的应用程序就可以在没有它们的情况下运行。应用程序可以检查 DLL 是否已加载，如果没有，它不提供 DLL 提供的功能。我已经将它与拼写检查器、条形码库等一起使用。可能需要考虑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T20:41:09.153

编写单元测试。否则，听起来像是两周的拇指旋转是为了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T20:08:02.930

你不会走远的。有这么多的电话，除非你在监狱里什么的，否则写一个包装器是对时间的一种不好的利用。

您不能从正在运行的安装中获取 DLL 的副本吗？或者这是一个许可问题？

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-09T20:48:05.957

我，尽管存在许可和其他问题，我仍会尝试在此处复制 .DLL。除此之外，我认为找到另一个项目......

# c++ - 如何创建一个指向大小未知的多维数组的指针？

> ID：529697
> 
> 赞同：1
> 
> 时间：2009-02-09T20:06:54.480
> 
> 标签：c++, arrays, pointers, multidimensional-array

如何创建一个指向大小未知的多维数组的指针？我试过这个：

`int **triangles;`

`triangles = new int[numTriangles][3];`

但我得到这个错误：

`cannot convert 'int (*)[3]' to 'int**' in assignment`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T20:11:06.217

```
triangles = new int[numTriangles*3]; 
```

然后访问它：

```
triangles[numTriangles*triangleIndex+vertexIndex] = blah; 
```

但这很乏味且容易出错，所以我建议改用[boost.multi_array](http://www.boost.org/doc/libs/1_38_0/libs/multi_array/doc/index.html)，或者自己滚动（真的很简单）：

```
template<class T>
class Matrix {
public:
    Matrix(int _w, int _h) : data(_w*_h), w(_w), h(_h) {
    }

    T      & operator()(int x, int y)       { return data[y * w + x]; }
    T const& operator()(int x, int y) const { return data[y * w + x]; }

private:
    std::vector<T> data;
    int w, h;
};

// usage:
int main() {
    Matrix<float> triangles(numTriangles, 3);
    triangles(triangleIndex, vertexIndex) = blah;
} 
```

另一方面，如果您实际上想要一个三角形数组，而不是二维数组，只需使用一个`vector<Triangle>`where Triangle 是一个类 :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T20:15:50.493

好吧，错误消息说：) 如果您 'new 一个数组，则 new 返回一个指向其第一个元素的指针。

多维数组只是数组数组的另一个名称。您新添加了一个数组`int[3]`，其中包含 numTriangles 个元素。所以 new 所做的是返回一个指向`int[3]`. 您将结果分配给的变量必须具有该类型，它是指向 3 个整数数组的指针：

```
int (*triangles)[3];
triangles = new int[numTriangles][3];
triangles[triangleIndex][vertexIndex] = 42; 
```

当然，typedef 在这里也有帮助：

```
typedef int triangles_t[3];
triangles_t * triangles = new int[numTriangles][3]; 
```

由于 C++ 优先规则，需要括号。他们告诉编译器它不是创建一个由三个指向整数的指针组成的数组，而是一个指向一个由 3 个整数组成的数组的指针。这类似于函数指针 ( `"void (*funptr)()"`) 上更常见的用法......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-09T20:15:56.250

为此，您必须遍历一个维度并为另一个维度分配空间：

```
int** triangles;
triangles = new int*[NUMROWS];

for (int i = 0; i < NUMROWS; i++) {
   triangles[i] = new int[NUMCOLS];
} 
```

但是这样做时要小心，你必须这样做才能释放内存。

```
for (int i = 0; i < NUMROWS; i++) {
   delete [] triangles[i];
   triangles[i] = 0;
}
delete [] triangles;
triangles = 0; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T20:14:49.623

c++ 中的多维数组只是语法糖。

```
int a[n][m]; 
```

相当于

```
int a[n*m]; 
```

所以你只需要一个常规指针 - 即：

```
int *triangles;
triangles = new int[numTriangles*3]; 
```

# c++ - 使用带有 Boost::Spirit 语法的迭代器解析

> ID：529706
> 
> 赞同：3
> 
> 时间：2009-02-09T20:08:52.197
> 
> 标签：c++, boost, boost-spirit

当我尝试对 Spirit 语法使用迭代器形式的解析时，我得到一个参数，将转换错误从迭代器类型传递到 const char*。我该如何解决？

有一些限制。我在大输入上使用迭代器适配器，因此转换为 C 样式字符串对我来说是不可行的。

这是演示该问题的示例代码：

```
#include <boost/spirit/core.hpp>
#include <boost/spirit/iterator/file_iterator.hpp>
#include <vector>
#include <string>
using std;
using boost::spirit;
struct ex : public grammar<route_grammar> {
  template <typename ScannerT> struct defintion {
    definition(ex const& self) {
      expression = real_p; 
    }
    rule<ScannerT> expression;
    rule<ScannerT> const& start() const { return expression; }
};

int main() {
  file_iterator<char> first;
  file_iterator<char> last = first.make_end();
  ex ex_p;
  parse_info<file_iterator<char> > info = parse(first, last, ex_p, space_p);
  return 0;
} 
```

此代码中断：错误：无法转换`const boost::spirit::file_iterator<char_t, boost::spirit::fileiter_impl::mmap_file_iterator<char_t> >`为`const char*`参数传递

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T21:35:06.560

很难从发布的代码中分辨出来，因为它包含一些基本错误。更正这些后，它可以在我的机器上正常编译（使用 MSVC++7.1）：

```
#include <boost/spirit/core.hpp>
#include <vector>
#include <string>
using namespace std;
using namespace boost::spirit;
struct ex : public grammar<ex> {
template <typename ScannerT> 
struct definition {
    definition(ex const& self)
    {
    expression = real_p; 
    }
    rule<ScannerT> expression;
    rule<ScannerT> const& start() const { return expression; }
};
};

int main() {
vector<char> v;
v.push_back('3'); v.push_back('.'); v.push_back('2');
ex ex_p;
parse_info<vector<char>::iterator> info = parse(v.begin(), v.end(), ex_p, space_p);
return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T20:32:16.850

这是让 char * 指向与迭代器相同的元素的一种方法：

```
&v.front() // v.begin()
&v.back() + 1 // v.end() 
```

我不确定你是如何编译它的：

```
vector<char> v;
v.push_back("3.2"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T21:50:44.917

编译错误不在提供的示例中。在上面的语法中我没有语义动作，而在我简化的代码中我做了。

这些操作的回调使用 char* 而不是我使用的迭代器类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T22:51:39.527

您可以尝试确保您的语义操作在参数类型上是多态的。正是在代码中你想要这样的东西：

```
struct my_action {
  template <class ParamType>
  void operator()(ParamType const & parameter) const {
    // deal with parameter
  }
}; 
```

您将使用如下所示的一元语义操作：

```
real_p[my_action()] 
```

或者，如果您需要二进制语义操作，您可以执行以下操作：

```
struct binary_action {
  template <class ParamType>
  void operator()(ParamType const & param1, ParamType const & param2) const {
    // deal with either parameter
  }
};

(*char_p)[binary_action()] 
```

# ajaxpro - AjaxPro 在本地工作，但在服务器上我收到 .ashx 错误

> ID：529711
> 
> 赞同：6
> 
> 时间：2009-02-09T20:10:27.263
> 
> 标签：ajaxpro

在本地，我的应用程序使用 ajaxpro 可以正常工作，但在服务器上我似乎无法弄清楚它为什么不工作。

使用萤火虫我有以下错误：

GET prototype.ashx 404 未找到 GET core.ashx 404 未找到 GET ms.ashx 404 未找到

相同的代码在本地工作，所以它必须是 IIS7 设置？

**编辑，我的 web.config**

```
<httpHandlers>
            <add verb="POST,GET" path="ajaxpro/*.ashx" type="AjaxPro.AjaxHandlerFactory, AjaxPro"/>
        </httpHandlers> 
```

也有：

```
<location path="ajaxpro">
        <system.web>
            <httpHandlers>
                <add verb="POST,GET" path="*.ashx" type="AjaxPro.AjaxHandlerFactory, AjaxPro"/>
            </httpHandlers>
            <authorization>
                <allow users="*"/>
            </authorization>
        </system.web>
    </location> 
```

和：

```
<location path="ajaxpro/prototype.ashx">
        <system.web>
            <authorization>
                <allow users="*"/>
            </authorization>
        </system.web>
    </location>
    <location path="ajaxpro/core.ashx">
        <system.web>
            <authorization>
                <allow users="*"/>
            </authorization>
        </system.web>
    </location>
    <location path="ajaxpro/converter.ashx">
        <system.web>
            <authorization>
                <allow users="*"/>
            </authorization>
        </system.web>
    </location> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-10T06:20:02.777

要让 AjaxPro.dll 在 IIS7 中工作，您应该将应用程序池的 PipelinMode 设置为 Classical 而不是 Integrated。

我到处都想找到这个，但最后这救了我。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-28T12:10:47.537

要在 IIS7（即 Windows Vista）上以集成模式而不是经典模式运行 Ajax.NET，您必须检查两件事：

1.  首先检查 IIS_ISSRS 组是否有权访问您的网站文件夹。如果您使用 Visual Studio .NET 2005 的网站的默认文件夹，最简单的方法是在 C:\Users\Username\Documents\Visual Studio 2005\WebSites 中添加读取访问权限。
2.  运行以下命令以自动迁移您的 web.config 文件：%windir%\system32\inetsrv\Appcmd migrate config ""

Ajax.NET Professional 的重大变化是您必须将 httpHandler（和 httpModule，如果使用）移动到新的部分 system.webServer 并将 httpHandler 重命名为 handler；接下来，您必须为处理程序添加名称属性：

```
<configuration>

    <location path="ajaxpro">
        <system.webServer>
            <handlers>
                <add verb="*" path="*.ashx" name="AjaxPro" 
                     type="AjaxPro.AjaxHandlerFactory,AjaxPro.2" />
            </handlers>
        </system.webServer>
    </location>

</configuration> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T20:26:05.307

您确定在 web.config 文件中正确注册了处理程序吗？

您的 web.config 文件中应该有如下所示的内容。

```
<location path="ajaxpro">
    <system.web>
        <httpHandlers>
            <add verb="*" path="*.ashx"
                 type="AjaxPro.AjaxHandlerFactory,AjaxPro.2"/>
        </httpHandlers>
    </system.web>
</location> 
```

您还需要在 Bin 目录中拥有 AjaxPro dll（至少对于网站而言）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-12-06T05:44:04.877

几个小时以来，我一直在努力解决这个问题，我想我可能刚刚找到了解决方案……而且，更糟糕的是……令人沮丧。

在web.config、system.webServer/handlers中，可能有不止一项处理*.ashx

例如：

```
<add name="AjaxPro" verb="POST,GET,HEAD" path="ajaxpro/*.ashx" ...
<add name="SimpleHandlerFactory-Integrated" path="*.ashx" ...
<add name="SimpleHandlerFactory-ISAPI-2.0" path="*.ashx" ...
<add name="SimpleHandlerFactory-ISAPI-2.0-64" path="*.ashx" ... 
```

如果 ajaxpro 条目*低于*这些条目，则不会使用它，因为这些条目首先匹配。将条目移到其他`ajaxpro`条目之上可能会解决问题。

我不知道为什么卡西尼不介意，但 IIS7 确实...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-27T12:28:40.090

```
<configuration>

    <location path="ajaxpro">
        <system.webServer>
            <handlers>
                <add verb="*" path="*.ashx" name="AjaxPro"
                     type="AjaxPro.AjaxHandlerFactory,AjaxPro.2" />
            </handlers>
        </system.webServer>
    </location>

</configuration> 
```

默认情况下，Windows 2008 \ IIS 7 没有为使用 Ajax 设置 axd 处理程序映射，因此如果您想使用 Ajax 并且使用我们的 Windows 2008 托管计划之一，则需要将以下代码放入您的 web.config 文件中.

```
<system.webServer>
        <handlers>
            <add name="Ajax" path="*.axd" verb="*" modules="IsapiModule"
scriptProcessor="C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll"
resourceType="Unspecified"
preCondition="classicMode,runtimeVersionv2.0,bitness32" />
        </handlers>
</system.webServer> 
```

或将 .dll 复制到 bin 文件夹并尝试：

```
<httpHandlers>
<add verb="POST,GET" path="ajax/*.ashx" type="Ajax.PageHandlerFactory, Ajax"/>

</httpHandlers> in <system.web> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T14:43:41.170

我只是遇到了同样的错误，但可能与您的原因不同。我在一个新网站上得到它（在本地运行），因为该网站使用了一个不排除 .ashx 的自定义 url 重写模块！

所以我的解决方案是确保重写模块排除带有.ashx的路径......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-07T08:17:57.887

将我的网络表单迁移到 MVC 4 后，出现此错误（未找到 ajaxpro/core.ashx 404）

我解决了它添加这一行到我的 app_start/routeconfig

```
routes.IgnoreRoute("ajaxpro/{*pathInfo}"); 
```

我的 web.config 不需要额外的声明，但是这个

```
<httpHandlers>
        <add verb="POST,GET" path="ajaxpro/*.ashx" type="AjaxPro.AjaxHandlerFactory, AjaxPro"/>
    </httpHandlers> 
```

当然，还有对 ajaxpro.2.dll 的引用放在我的 bin 文件夹中

希望这有用！

# php - PHP定义包含文件的范围

> ID：529713
> 
> 赞同：5
> 
> 时间：2009-02-09T20:10:58.243
> 
> 标签：php, include, scope

我有很多 PHP 视图文件，我曾经使用简单的包含语句将它们包含在我的控制器中。它们都使用在视图类中声明的方法，它们就像 $view->method(); 但是，我最近决定，如果包含也由这个视图类完成会更好。但是，这会更改包含文件的范围，因此不再定义 $view。这是一个代码示例：

```
in someViewFile.php (BOTH siuations)
    <html>
    <head><title><?php echo $view->getAppTitle(); ?></title>
    etc.
OLD SITUATION in controller:
    $view = new view;
    include('someViewFile.php'); //$view is defined in someViewFile.php
NEW SITUATION in controller:
    $view = new view;
    $view->show('someViewFile'); //$view is not defined in someViewFile.php 
```

现在我在视图类中使用它解决了这个问题：

```
public function show($file){
    $view = &$this;
    include($file.".php");
} 
```

无论如何要声明包含文件的范围，还是这是解决问题的最佳方法？

这些例子是粗略的简化。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-09T20:58:29.487

这是一个简化但功能强大的视图类，我已经看到很多并使用了很多。
正如您在下面的代码中看到的：您使用模板文件的文件名实例化一个视图。
客户端代码（可能是控制器）可以将数据发送到视图中。此数据可以是您需要的任何类型，甚至可以是其他视图。
渲染父级时将自动渲染嵌套视图。
希望这可以帮助。

```
// simple view class
class View {
    protected $filename;
    protected $data;

    function __construct( $filename ) {
        $this->filename = $filename;
    }

    function escape( $str ) {
        return htmlspecialchars( $str ); //for example
    }

    function __get( $name ) {
        if( isset( $this->data[$name] ) {
            return $this->data[$name];
        }
        return false;
    }

    function __set( $name, $value ) {
        $this->data[$name] = $value;
    }

    function render( $print = true ) {
        ob_start();
        include( $this->filename );
        $rendered = ob_get_clean();
        if( $print ) {
            echo $rendered;
            return;
        }
        return $rendered;
    }

    function __toString() {
        return $this->render();
    }
} 
```

用法

```
// usage
$view = new View( 'template.phtml' );
$view->title = 'My Title';
$view->text = 'Some text';

$nav = new View( 'nav.phtml' );
$nav->links = array( 'http://www.google.com' => 'Google', 'http://www.yahoo.com' => 'Yahoo' );

$view->nav = $nav;

echo $view; 
```

模板

```
//template.phtml
<html>
    <head>
        <title><?php echo $this->title ?></title>
    </head>
    <body>
        <?php echo $this->nav ?>
        <?php echo $this->escape( $this->text ) ?>
    </body>
</html>

//nav.phtml
<?php foreach( $this->links as $url => $link ): ?>
    <a href="<?php echo $url ?>"><?php echo $link ?></a> 
<?php endforeach ?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T20:25:43.810

您无法更改 include() 范围，不，因此您的方法可能与您描述的情况一样好。虽然我自己会跳过丑陋的 PHP4 兼容 & 符号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-20T16:56:03.393

我做什么，（我不知道它有多好）很简单

```
extract($GLOBALS);
include $view.".php"; 
```

确实有效

干杯!

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-02T17:22:14.437

View 类的更简化版本：

```
Class View {

    protected $filename;

    function __construct($filename){
        $this->filename = $filename;
    }

    function display(){
        global $session; //put global variables here

        include Cfg::ROOT . '/views/' . $this->filename;    
    }

    function assign($key, $val){
        $this->$key = $val;
    }

} 
```

在控制器中：

```
$view = new View('homepage.php');
$view->assign('page_title',$page_title); //assign all needed variables from controller
$view->display(); 
```

在模板/视图文件中：

```
echo $this->page_title; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-15T09:25:01.063

也许这与我的 php-settings 或其他东西有关，但如果我在函数中包含一个文件，则包含的文件将只具有该函数变量的范围。

```
$a = 1; // This variable isn't visible for the included file

function render()
{
    $b = 2; // This variable is
    include('template.php');
}

// ----------------------------------------
// template.php

<html>
<body>
<?=$a?> // wont show
<?=$b?> // will show
</body>
</html> 
```

我想我会选择这样的东西：

```
function render($template, $variables)
{
    extract($variables);
    include($template);
} 
```

用法：

```
render('templates/mytemplate.php', array(a=>1, b=>2)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-15T17:24:16.723

扩展 Quano 所提供的功能：

更进一步，在全局执行范围内包含变量（否则必须在 include 的内部使用 global 调用）。这个想法是，您希望 include 像包含在您的主应用程序范围或定义的范围中一样工作。

考虑这个类：

```
class PHPInclude {
    private static $globalsList = array(
            'GLOBALS','_SERVER','_GET','_POST','_FILES',
            '_REQUEST','_SESSION','_ENV','_COOKIE'
        );
    public static function phpInclude($file,$variables=array()) {
        if ( file_exists($file) ) {
            $globs = array();
            foreach ( $GLOBALS as $key => $value ) {
                if ( !in_array($key,sefl::$globalsList) ) {
                    array_push($globs,$key);
                }
            }
            foreach ( $globs as $key ) {
                global $$key;
            }
            foreach ( $variables as $variable ) {
                global $$variable;
            }
            unset($globs,$key,$value);
            ob_start();
            include $file;
            return ob_get_clean();
        }
        return '';
    }
} 
```

按如下方式使用它：

```
$foo = 'bar';
function testScope() {
    $woo = 'sah';
    PHPInclude::phpInclude('file.phtml',array($woo));
} 
```

该示例将自动包含`$foo`，因为它在全局范围内，并且`$woo`由于它在本地范围内而被添加。

我没有`$this`作为任意变量进行测试，但我的蜘蛛感觉告诉我[它不起作用（警告）](http://php.net/manual/en/language.variables.variable.php)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-18T02:33:14.153

我找到了一个很好的解决方案。只需创建一个匿名函数并调用它。仅适用于 PHP 7+。

```
$arg1=1;
call_user_func(function()use($arg1,$arg2,...){
 $values=$arg1+$arg2;
 // $values is limited in scope inside this function
} 
```

例如：

```
$values='HEY!';

//included code
$arg1=1;
$arg2=2;
call_user_func(function()use($arg1,$arg2,...){
 $values=$arg1+$arg2;
 // $values is limited in scope inside this function
}

echo $values;
// echos HEY! 
```

# wpf - 如何将多个参数传递给 WPF MarkupExtension 中的 params 数组？

> ID：529722
> 
> 赞同：5
> 
> 时间：2009-02-09T20:15:37.033
> 
> 标签：wpf

我需要为我的 WPF 应用程序创建一个 MarkupExtension，它需要能够采用任意数量的参数，这些参数将用于国际化字符串中的令牌替换。我们的国际化代码使用 params 数组来获取这些参数。由于我希望这些参数可以从 XAML 传递，有没有办法指定这些参数而无需在 XAML 中显式创建 x:Array？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T15:27:04.813

我认为您必须使用 x:Array，我不知道任何其他方式（甚至想不出与标记扩展 {} 语法兼容的任何其他方式）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-02T08:45:06.430

有时它并不漂亮，但蛮力带来了一天......

来源：

```
[MarkupExtensionReturnType(typeof(PriorityBinding))]
public sealed class Priority:MarkupExtension {

readonly BindingBase[] bindings;

#region Constructors
public Priority(BindingBase b1) {
  bindings = new [] {b1};
}

public Priority(BindingBase b1, BindingBase b2) {
  bindings = new [] {b1, b2};
}

public Priority(BindingBase b1, BindingBase b2, BindingBase b3) {
  bindings = new [] {b1, b2, b3};
}

public Priority(BindingBase b1, BindingBase b2, BindingBase b3, 
                 BindingBase b4) {
  bindings = new [] {b1, b2, b3, b4};
}

public Priority(BindingBase b1, BindingBase b2, BindingBase b3,
                 BindingBase b4, BindingBase b5) {
  bindings = new [] {b1, b2, b3, b4, b5};
}

public Priority(BindingBase b1, BindingBase b2, BindingBase b3,
                 BindingBase b4, BindingBase b5, BindingBase b6) {
  bindings = new [] {b1, b2, b3, b4, b5, b6};
}

public Priority(BindingBase b1, BindingBase b2, BindingBase b3,
                 BindingBase b4, BindingBase b5, BindingBase b6, BindingBase b7) {
  bindings = new [] {b1, b2, b3, b4, b5, b6, b7};
}

public Priority(BindingBase b1, BindingBase b2, BindingBase b3,
                 BindingBase b4, BindingBase b5, BindingBase b6, BindingBase b7, BindingBase b8) {
  bindings = new [] {b1, b2, b3, b4, b5, b6, b7, b8};
}

#endregion

public override object ProvideValue(IServiceProvider serviceProvider) {
  var binding = new PriorityBinding();
  foreach (var item in bindings) {
    binding.Bindings.Add(item);
  }
  return binding;
} 
```

}

# sql - 使用映射表的 SQL 查询的“不同”结果

> ID：529726
> 
> 赞同：2
> 
> 时间：2009-02-09T20:16:11.367
> 
> 标签：sql, ms-access, join, mapping, distinct

我有两个表 tbl1 和 tbl2，都有两列，一列用于 id，一列用于产品。我想提取两者中的行，即 tbl1.id = tbl2.id 和 tbl1.product = tbl2.product 的行，并将 tbl1 和 tbl2 中的行合并为一行。

我想这会是这样的：

```
SELECT tbl1.\*, tbl2.\*
FROM tbl1, tbl2
WHERE tbl1.id = tbl2.id
  AND tbl1.product = tbl2.product 
```

或者

```
SELECT tbl1.\*, tbl2.\*
FROM tbl1
  INNER JOIN tbl2 
    ON tbl1.id = tbl2.id
       AND tbl1.product = tbl2.product 
```

?

我还有一个问题，即两个电子表格中的产品名称不同。

我添加了一个映射表，其中包含 tbl1 中的产品名称以及每行中对应的 tbl2 产品名称。

我怎么知道使用这个添加的表实现上述 SQL 查询的等效项（其中每个 id/product 组合都只输出一行）？

谢谢你的帮助。

（注意：我使用的是 MS Access）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T20:21:05.957

```
SELECT
     t1.id,
     t1.product,
     t2.product
FROM
     tbl1 t1
LEFT OUTER JOIN mapping_table map ON
     map.id = tbl1.id
INNER JOIN tbl2 t2 ON
     t2.id = t1.id AND
     (t2.product = t1.product OR t2.product = map.tbl2_product) 
```

如果 t1 和 t2 中的产品名称相同，您可能需要根据是否希望将行视为匹配项来调整此设置，但映射表中也存在匹配项。此外，如果您计划将所有产品都包含在映射表中，即使名称已经在两者之间匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T01:22:18.463

Just use one of the columns from the mapping table.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T20:20:27.597

```
SELECT 
     tbl1.*, tbl2.*
FROM tbl1, tbl2, tbl3
 WHERE
     tbl1.id = tbl2.id
 AND tbl1.product = tbl3.product1
 AND tbl2.product = tbl3.product2 
```

# java - 在 Java 中接收不同的内容

> ID：529729
> 
> 赞同：0
> 
> 时间：2009-02-09T20:17:04.580
> 
> 标签：java, persistence, collections, normalization

问题：

我需要从许多不同的来源接收不同类型的内容，将它们标准化，然后通过 JDO 使它们持久化。

天真的解决方案？：

为每种数据类型创建并侦听特定端口。

或者

做一堆复杂的解析

一个看似理想的解决方案：

具有自定义 URL 类型，即 FOO://myhost.tld、BAR://myhost.tld。然后，任何应用程序都可以发送到特定于自定义类型的 URL，并且主机将理想地使用 Java 的 URLConnection 和 URLStreamHandler 抽象类来创建一个将产生适当的规范化线程的工厂。或者，如果有其他方法可以检索连接 URL，我认为这就足够了

这可能吗？我查看了 API 和其他文档，无法确定是否可以将这些与 Java 服务器套接字一起使用。

我应该提一下，在某些（很多？大多数？）情况下，我不对客户端代码负责。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T21:05:13.997

[MIME](http://en.wikipedia.org/wiki/MIME)是一种相当标准的交流内容类型和处置的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T20:44:19.070

您所说的“URL 类型”是 URL 的协议部分，它所做的只是告诉客户端该 URL 上的服务器将期望它使用哪个协议。

它不是允许服务器找出调用它的 URL 的“元协议”的一部分，除非您使用包含此信息作为标头的协议——这种情况并不常见。另请注意，协议通常暗示默认端口，除非 URL 还指定了端口。

Java 的整个 URLConnection / URLStreamHandler API 是面向客户端使用的，而不是服务器，所以我不相信它可以按照你想要的方式使用。

您提出的前两个替代方案几乎是您的选择：或者为不同类型的输入使用不同的端口，或者让客户端发送一个标头来指定随后的输入类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-07T04:45:35.097

我最终采用的解决方案是使用 java nio lib 和一个线程池，其中包含一组 ServerSocketChannels 和附加的内容处理程序

# java - Windows下调试JVM崩溃

> ID：529732
> 
> 赞同：3
> 
> 时间：2009-02-09T20:18:34.153
> 
> 标签：java, windows, debugging, native

我用 Java 编写了一个软件，它使用硬件供应商提供的 DLL 与 USB 硬件进行通信。我使用[Java Native Access](http://jna.dev.java.net)库将包装器写入本机代码。有时当我运行它时，仅在与本机代码相关的函数上，JVM 崩溃，我找不到导致错误的原因，因为它发生在本机代码中，我没有源代码 (MSVCRT71.DLL)。

我大部分时间都是 Linux 开发人员，所以我不习惯这种情况。我可以做些什么来将调试器从外部（例如，Visual C++）附加到 JVM 进程并从中获得一些有意义的东西（即，不是汇编指令）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T20:26:23.153

MSVCRT71.DLL 是 Visual Studio 7.1 中包含的 c-runtime 库的 dll。

安装具有 crt 源的 Visual Studio 7.1。转到调试-> 进程，找到您正在运行的 java 实例，然后单击“附加”。

如果你无法掌握 VS7，试试这个

[ [http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx][1]](http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx][1])

确保您获得该版本 crt 的符号

# naming - 你如何命名你的项目？

> ID：529734
> 
> 赞同：6
> 
> 时间：2009-02-09T20:19:00.690
> 
> 标签：naming

在工作中，我们遇到了不同的人想要/建议新项目的不同名称的问题。在过去的 2 天中更改了 4 次。

人们在命名内部项目时会经历哪些流程？作为一个团队，您如何为项目名称得出结论？

为了更清楚一点，问题是你*如何*命名你的项目，而不是你给它们起*什么*名字。我更多的是关于一个过程，所以我们不会让 3/4 的经理参与在接下来的 4 周里每 4 小时更改一次项目的名称

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T20:21:41.090

我们以 asimov 字符命名它们。

二十一点的客户是哈里。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T20:22:51.210

为什么团队选择这个名字。你没有经理吗？这就是组织应该如何工作：如果一个级别无法及时实现目标，则将其升级到下一个级别。

多么浪费时间啊！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T20:20:44.150

让每个人都把他们的建议放在帽子里，然后随机抽取一个名字。真的有关系吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-09T21:41:49.040

1.  让团队提出许多建议。
2.  让管理层和法务部清除有问题的名称。
3.  让团队对剩下的名字进行投票。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T20:23:34.703

列出所有可能的名字，每个人只能提出一个名字建议。让每个人对名字进行投票。每个人只能投票一次，不能以自己的名义投票。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T20:21:29.357

这真的取决于你将如何背负一个名字。
例如，如果它是一个 .Net 项目，您将完全被您选择的名称所困扰，在这种情况下，即使站点有一个很好的命名，项目通常也会得到一个非常无聊的命名。

在代码没有“清单”的其他技术中，命名为项目，将代码移动到新文件夹名称是“项目”，那么诙谐的名称似乎很有趣。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T20:21:35.613

我所在的一家公司根据度假城市的名称来命名他们所有的项目。所以我们有巴黎、雅典等。我也用过希腊神和星座。它没有太多的过程，只是开发团队认为很酷的东西。虽然有一个例子，我们当时允许我们的测试版合作伙伴选择项目的名称——他们有一个完整的比赛和一切。

我参与的另一个项目有四个阶段：红色、绿色、蓝色和 4

一定会喜欢的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T20:23:22.020

使用字母表示产品的版本，并让团队成员对以字母开头的单词进行投票。

我们有一个名为 Ambition、Benevolence、Charisma 等的项目。

我喜欢为此使用[即时径流投票](http://en.wikipedia.org/wiki/Instant_runoff_voting)。

我还发现，让新的团队成员推荐姓名有助于他们对项目感到拥有所有权。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-09T20:24:27.540

对于我的个人项目，我将它们命名为独立战争的战斗（例如列克星敦、康科德、萨拉托加、提康德罗加）。我也喜欢使用希腊神话中的名字，因为我是这个名字的忠实粉丝：）

另一个个人项目被命名为 Rushmore（如 Mt. Rushmore）。IMO 这一切都取决于你喜欢什么以及项目名称是否会公开可见。如果不是，请随意命名（如果你问我，越神秘越好！）但如果它是公开的，那么选择听起来不荒谬或会让人们“嗯？”的东西。 `Project Fig Newton`或者`Project Twinkie`对一群开发人员来说可能听起来很有趣，但对客户来说听起来如何？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-09T20:25:56.337

当您将项目置于源代码控制之下时，以一种有助于开发人员了解项目名称的方式命名您的项目。在您当前的源代码控制之外，人们如何称呼它并不重要。

尝试选择一个保持不变的命名约定，这将有助于组织源代码管理中的内容，并尽量远离首字母和缩写，因为一旦该项目中的所有 DEV 离开，没有人会知道该项目是什么。

尝试使用以下名称：customerA Website customerB WinApp

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-09T20:27:09.220

我工作的一个地方使用山脉作为框架，使用滑雪胜地作为客户；另一个使用地铁站。在这两种情况下，它们都是没有固定版本号的内部名称（因为市场有改变它的习惯）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-09T20:36:53.407

我见过架构师的选择、CTO 的授权、开发团队的轮换，以及对一些任意竞争的奖励，但最终归结为一个人一票。你可以以任何你想要的方式民主化，但无论你做什么，只要确保它没有冒犯性并坚持下去。

Fwiw，我最喜欢的系统是选择 Dredd 法官角色的建筑师。:D

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-09T20:41:02.650

对于个人项目，我有时会使用大城市的名称，如纽约、柏林、东京等。这既方便，因为我觉得该项目不受特定技术或功能的约束，并且可以涉及任何可能的项目，而在同时，要记住是东京还是奥斯陆在做“那个”很酷的事情可能有点困难。

在工作中，我们有使用更简单和描述性名称的传统。例如，根据计划上传文件的应用程序称为 ScheduledFileUploader。然后是 FileOrganizer、MailSender、DiskSpaceMonitor 等。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-09T21:04:48.503

你的意思是代号？因为它只会留在内部员工的脑海中，所以我们通常首先想到的就是它，我们从不讨论它，一个我们认真命名的项目“面团”！:) 它就像魔术一样工作，任何事情都有效

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-09T21:29:00.817

我的大哥米凯尔在很晚的项目中被召唤去*救火……他选择了一些电影片名*

*   **Save Willy** -*一个臃肿的 java 项目*
*   **哈利波特**——*一个建筑灾难j​​ava项目*

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-09T22:09:13.327

*   女性名字（每个人都喜欢一个好听的名字，特别是如果它带来美好的回忆）
*   动物（每个人都喜欢动物）

我们通常很快就同意这一点，没有问题。在我们给某个东西命名后，例如“花栗鼠”，笑话和有趣的图片开始出现（每个人都喜欢编笑话 :)

但实际上，我不认为这有什么不同。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-09T22:13:28.340

[以星座](http://www.astro.wisc.edu/~dolan/constellations/constellation_list.html)命名您的项目。有很多可供选择，大多数听起来很酷。此外，当您进入 Aries 项目时，您可以告诉人们您正在[检查细胞结构并且细胞结构已被检查](http://en.wikipedia.org/wiki/Sleeper_(film))。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-09T22:41:30.630

非常小心和很多个人痛苦。坦率地说，我痴迷于我的个人项目名称。甚至到了我会花费数小时思考特定类型或 DLL 的名称的地步。

遗憾的是，这不是玩笑。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-02-09T22:48:18.147

没有项目名称，只有版本号。

每个人都知道，如果您发布了“MyBlaPro 4”，那么您正在开发“MyBlaPro 5”，它将在 1 到 2 年内发布（您的公司历史可以提供有关您的开发周期长度的提示）。最大的秘密不是你正在开发下一个版本，而是它什么时候发布。

代号不仅让外人感到困惑（想想 Avalon/WPF、Longhorn/XP/2000/Vista/7），而且让内部人感到困惑。你有时会听到这样的讨论：“不，我们在赤霞珠之前在津芬德尔添加了 X”“不，你错了，赤霞珠是 5，津芬德尔是 6，但在梅洛中添加了 X”

半局外人更添混乱。想想必须在版本之间重用记忆翻译的本地化公司（“对于 Rainier，我们应该使用来自 Shasta 还是来自 Whitney 的记忆？”）。

# jquery - jquery - 多个类操作

> ID：529737
> 
> 赞同：1
> 
> 时间：2009-02-09T20:19:51.810
> 
> 标签：jquery

当您将鼠标悬停在图像上时，我有一个简单的滑动框在图像上向上滑动以显示一些信息。这很好用，但我在同一页面上有多个图像，因此当您将鼠标悬停在任何图像上时，所有框都会向上滑动。

有没有一种简单的方法来排序，所以只有你悬停在上面的图像才会向上滑动？或者它基本上是为每个图像缩略图创建相同的代码来说明不同的 ID？

继承人 jquery - 随时纠正这个片段中的任何错误，因为我对它很陌生

```
$('#gallery-inner .thumb .gallery-inner-thumb').hide(); 
$("#gallery-inner .thumb").hover(function () {
    $("#gallery-inner .thumb .gallery-inner-thumb").show().animate({margin:'-36px 0 0'},'fast');
    }, function () { 
    $("#gallery-inner .thumb .gallery-inner-thumb").animate({margin:'1px 0 0'},'fast');
}); 
```

继承人的 html 块。

```
<div class="thumb clearfix">
    <div class="image">
        <a href="#" title="#"><img src="images/simg/pimg.jpg" alt="#"></a>

        <div class="gallery-inner-thumb clearfix">
            <div class="name"><a href="#">Image Name</a></div>
            <div class="comments"><a href="#">0</a></div>
        </div>

    </div>
</div> 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T20:23:06.437

jQuery 将目标元素作为`this`. 因此，您可以执行以下操作：

```
$("#gallery-inner .thumb").hover(function() // mouse over target
   {
      // select child of target .thumb with class .gallery-inner-thumb
      $(".gallery-inner-thumb", this)  
         .show().animate({margin:'-36px 0 0'},'fast');
   }, 
   function() // mouse off of target
   { 
      // select child of target .thumb with class .gallery-inner-thumb
      $(".gallery-inner-thumb", this)
      .animate({margin:'1px 0 0'},'fast');
   }); 
```

...并且它将单独适用于每个缩略图。`this`这里的关键是在选择要显示/动画的子项时为 jQuery 函数指定一个上下文（ - 事件目标）。

# shared-libraries - 您如何促进在您的组织中使用共享组件？

> ID：529739
> 
> 赞同：3
> 
> 时间：2009-02-09T20:20:37.550
> 
> 标签：shared-libraries, code-reuse

如果您的公司或项目强调（或至少赞赏）可在项目之间重用和共享的代码和组件的开发，那么您需要做哪些“社会工程”来促进重用编码？

根据我的经验，除非有人支持或宣传该代码，否则不会重复使用简单地称为“可重用”的代码或组件。否则，人们根本不会知道它。

**您如何确保共享组件或可重用代码在您的组织中工作？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T20:26:07.770

有几个想法浮现在脑海：

*   使它们得到很好的记录并且易于理解。这样，没有人会因为太混乱而放弃使用它们。
*   让它们变得非常有用，并确保它们能够处理那些令人讨厌的问题，以至于人们不得不疯狂地不使用它们。

另一个很好的策略是找出组织中其他人在他们的项目中拥有哪些代码，提供提取其中的一些功能（谈论它有多棒以及*你*真的想如何在你的项目中使用它）。将他们的代码添加到共享模块后，您通常会成为共享库的 +1 粉丝，并有一位布道者帮助您推销这个想法。请记住，人们通常只会在对他们有利的情况下做事——所以让他们看起来不错并且他们的代码看起来不错是对他们有利的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T20:24:18.120

在我的组织中，我们得到了管理层的帮助来促进共享图书馆的创建。我们还向新员工灌输使用它。

然后，我们放置*好的*代码，每个人都必须对其有用性和完整性进行审查。这就是团购发挥作用的地方。

此外，我们有一个非常健壮、记录在案的过程，用于分支共享库以在 Visual Studio 中使用。提示：我们使用 svn:external 属性来管理来自同一文件夹结构中不同存储库的签出。潜在的共享代码首先存在于分支中，然后才被提升到主干。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T20:27:07.877

我发现让人们想要使用您的可重用代码的最佳方法是向他们展示如何按照您的意图使用它。提供使用您的库的示例程序。就像任何其他项目一样，将其保存在源代码存储库中。当可重用库发生变化时，保持示例程序的文档和更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T21:09:59.023

几年前在研究生院的课堂上，我对一个基于 Web 的存储库进行了案例研究，程序员可以在其中存放他们的代码以供重用。这不是为了我的工作场所，而是为了一个拥有数千名科学家和工程师的实验室，那里没有任何其他集中的共享方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T20:36:04.783

就我个人而言，我尝试演示我认为有用的代码，并在使用它和不使用它之间进行比较，以尝试说明它为什么这么好。通常这发生在每周的开发会议期间。

我同意它确实需要有人传福音并推动采用新方法，我发现很多开发人员不擅长的事情之一就是推销自己或他们所做的事情，所以值得努力在这些技能上，并以身作则，推动其他人也这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T20:41:55.800

这可能有点以 java 为中心；但是在企业 Maven 存储库中发布二进制文件*和*源代码确实可以提高可见性。它使其他人乐于使用您的代码；）我们与许多开源项目合作，发现源代码可供阅读确实是一个关键特性，尤其是当它可以直接集成到 IDE 中时。我们真的希望内部项目也能做到这一点！我想知道在我们拥有 maven 之前我们是如何管理的？？（即使是蚂蚁现在也可以使用 maven repo）

# c# - C# 属性和 ref 参数，为什么不加糖？

> ID：529782
> 
> 赞同：72
> 
> 时间：2009-02-09T20:29:55.563
> 
> 标签：c#, properties, syntactic-sugar, reference-parameters

我在使用 C# 时遇到了这个错误消息

> 属性或索引器不能作为 out 或 ref 参数传递

我知道是什么原因造成的，并快速解决了创建正确类型的局部变量，使用它作为`out`/`ref`参数调用函数，然后将其分配回属性：

```
RefFn(ref obj.prop); 
```

变成

```
{
    var t = obj.prop;
    RefFn(ref t);
    obj.prop = t;
} 
```

显然，如果属性不支持在当前上下文中获取和设置，这将失败。

为什么 C# 不为我这样做？

* * *

我能想到这可能会导致问题的唯一情况是：

*   穿线
*   例外

对于线程，转换会影响写入发生的时间（在函数调用之后与函数调用中），但我宁愿怀疑任何依赖于此的代码在中断时都会得到很少的同情。

对于例外情况，关注点是；如果函数分配给几个`ref`参数之一而不是 throws 会发生什么？任何微不足道的解决方案都会导致分配所有参数或不分配参数，什么时候应该分配，有些不应该分配。同样，我不认为这会被支持使用该语言。

* * *

注意：我了解生成此错误消息的机制。我正在寻找的是为什么 C# 不会自动实现微不足道的解决方法的基本原理。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-09T20:34:47.407

因为您正在传递索引器的*结果*，这实际上是方法调用的结果。不能保证 indexer 属性也有一个 setter，当开发人员认为他的属性将在没有调用 setter 的情况下被设置时，通过 ref 传递它会导致开发人员的错误安全。

在更技术层面上， ref 和 out 传递传递给它们的对象的内存地址，并且要设置属性，您必须调用 setter，因此不能保证属性实际上会被更改，尤其是当属性类型为不可变的。ref 和 out 不只是在方法返回时*设置值，它们将实际的内存引用传递给对象本身。*

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-09T20:36:05.080

属性只不过是 Java 风格的 getX/setX 方法的语法糖。对于方法上的“ref”没有多大意义。在您的实例中，这是有道理的，因为您的属性只是存根字段。属性不必只是存根，因此框架不能允许在属性上“引用”。

**编辑**：嗯，简单的答案是，属性获取器或设置器可以包含的不仅仅是一个读/写字段，这使得它不受欢迎，更不用说可能出乎意料，允许你提出的那种糖。这并不是说我以前不需要这个功能，只是我理解他们为什么不想提供它。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-09T20:39:11.030

仅供参考，C# 4.0*将*有*类似*`ref`这种糖的东西，但仅在调用互操作方法时 - 部分原因是在这种情况下的纯粹倾向。我没有对它进行太多测试（在 CTP 中）；我们得看看结果如何……

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-09T20:33:57.563

`ref`您可以使用带有/的字段`out`，但不能使用属性。原因是属性实际上只是特殊方法的语法捷径。编译器实际上将 get/set 属性转换为相应的`get_X`和`set_X`方法，因为 CLR 没有立即支持属性。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-09T21:46:27.470

它不是线程安全的；如果两个线程同时创建自己的属性值副本并将它们作为 ref 参数传递给函数，则只有一个线程最终返回属性中。

```
class Program
{
  static int PropertyX { get; set; }

  static void Main()
  {
    PropertyX = 0;

    // Sugared from: 
    // WaitCallback w = (o) => WaitAndIncrement(500, ref PropertyX);
    WaitCallback w = (o) => {
      int x1 = PropertyX;
      WaitAndIncrement(500, ref x1);
      PropertyX = x1;
    };
    // end sugar

    ThreadPool.QueueUserWorkItem(w);

    // Sugared from: 
    // WaitAndIncrement(1000, ref PropertyX);
    int x2 = PropertyX;      
    WaitAndIncrement(1000, ref x2);
    PropertyX = x2;
    // end sugar

    Console.WriteLine(PropertyX);
  }

  static void WaitAndIncrement(int wait, ref int i)
  {
    Thread.Sleep(wait);
    i++;
  }
} 
```

PropertyX 最终为 1，而字段或局部变量为 2。

该代码示例还强调了在要求编译器执行含糖操作时，匿名方法等引入的困难。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-09T20:41:55.847

这样做的原因是 C# 不支持接受通过引用传递的参数的“参数化”属性。有趣的是，CLR 确实支持此功能，但 C# 不支持。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-09T20:35:23.803

当您传递 ref/out 前缀时，这意味着您正在传递存储在堆中的引用类型。

属性是包装方法，而不是变量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T20:40:10.093

如果您问为什么编译器不替换属性的 getter 返回的字段，那是因为 getter 可以返回 const 或 readonly 或文字或不应重新初始化或覆盖的其他内容。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-09T20:40:42.260

该站点似乎为您提供了解决方法。不过我还没有测试过，所以我不能保证它会起作用。该示例似乎使用反射来访问属性的 get 和 set 函数。这可能不是推荐的方法，但它可能会完成您的要求。

[http://www.codeproject.com/KB/cs/Passing_Properties_byref.aspx](http://www.codeproject.com/KB/cs/Passing_Properties_byref.aspx)

# javascript - 将函数从迭代更改为递归？

> ID：529785
> 
> 赞同：-5
> 
> 时间：2009-02-09T20:30:52.300
> 
> 标签：javascript, recursion

```
projectEuler3(600851475143);

var projectEuler3 = function (composite) {
    var result = 2;
    while(composite > 1)
    {
        if (composite % result)
        {
            result++
        } else {
            composite = composite / result;
            console.log(result);
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T22:15:34.033

[计算机程序的结构和解释](http://mitpress.mit.edu/sicp/)介绍了迭代算法和递归算法之间的区别，如何识别哪个是哪个（在某些语言中不是那么明显！），以及如何从一种转换到另一种。

除了是一本优秀的教科书。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T20:45:22.063

**编辑：原来这个问题被设计成如何将算法（通常）从迭代更改为递归......不像我假设的那样，如何获得特定问题的答案。**

这是为了欧拉计划！Project Euler 纯粹是为了您自己的利益……如果您要让其他人为您完成工作，您可能只需在 Google 上的某个地方查找答案并输入即可。

我只能猜测你已经确定你的程序是正确的，但是它太慢了，你希望加快它的速度。使您的函数递归无济于事。

该网站指出，如果您的程序不能快速解决问题，则有更好的方法……尝试不同的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T20:51:24.107

希望本着 Project Euler（边做边学）和 SO（边问边学习）的精神，这里有一个相当通用的模板，用于将循环变成尾调用递归：

```
var projectEuler3 = function(n) {
    var pE3_inner = function(n, i) {
        // magic happens here

        // if neither n nor i has changed, this is an
        // infinite recursion (and usually a stack overflow)
        pE3_inner(n, i);
    }

    pE3_inner(n, 2);
} 
```

# html - 有任何理由，之后有额外的回报吗？

> ID：529787
> 
> 赞同：4
> 
> 时间：2009-02-09T20:31:13.343
> 
> 标签：html

`</html>`是否有任何微观原因（除了迷信），在 (X)HTML 文档之后添加额外的返回？

有什么重要的理由不停止我的这个习惯吗？（对我来说，最后一行代码与最后一段代码相同，它看起来更干净，但我很想知道在保留或不保留额外回报之间是否存在任何已知的后果/可能的影响，例如作为最后一行没有被解释或类似的东西。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-09T20:34:09.903

这只是迷信。如果我没记错的话，如果那里没有额外的换行符，早期的 IE 版本（2 或 3）之一会引发错误，但我认为这在相当长的一段时间内都无关紧要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T21:33:24.847

一个原因是因为一些延迟编程的解析器被编程为使用换行或回车换行一次读取一行，如果数据流刚刚*结束*，那么它要么不会解析最后一行，要么只会失败。我体验过一些 C 编译器，如果最后一行不包含换行符，某些版本的 Make 会抱怨。显然这些不是 HTML，但原因是成立的。

出于这个原因，我总是出于习惯添加额外的换行符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T21:58:27.330

你用的是VCS吗？从历史上看，一些版本控制系统抱怨在文件末尾缺少行结尾。我相信这可能是由于 diff 和 patch （最初）对此有点挑剔。

不完全是迷信；也许我们可以将其归类为过时的都市传奇（很多都在这个行业）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-09T22:01:17.137

我总是用换行符结束我的文件。

有一次，我有一个自动工具，可以将一个目录中的所有 JavaScript 文件连接到一个文件中（以保存 HTTP 请求）。如果文件没有以换行符结尾并且也没有以分号结尾，这将中断。从那时起，我就用换行符结束文件。

此外，如果您使用 bash 之类的命令行 shell 和`cat`文件；新提示将出现在文件中的最后一个字符之后，因此如果是换行符，它看起来会好很多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T20:33:47.597

没有什么不同的

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-09T20:37:34.203

不，就像帕特里克说的那样没关系。如果需要，整个页面可以放在一行上。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-09T21:52:33.163

可以肯定的是，没有现代知名浏览器会在意。实际上，在 HTML 中，与 XHTML 不同，</html> 标签也是多余的。

然而，在你的第一句话中，你问的是微观原因，我有一个。一些编辑器（我认为记事本曾经是一个，我最近没有检查过）如果该行不为空，则会在保存时自动将 CR/LF 添加到文件的最后一行，可能是为了解决诸如 DevelopersDevelopersDevelopers 之类的问题描述。在编辑 DOS 批处理文件时，这曾经是一个真正的烦恼，因为额外的一行可能会对脚本终止的方式产生不利影响。

因此，如果您在一个不执行此操作的编辑器中创建 HTML，并且您没有手动添加最终的 CR/LF，那么稍后有人在一个编辑器中打开该文件，该编辑器不会更改任何内容并且保存时，您会在搜索实际更改或版本控制日志时出现错误的差异。

在您的第二句话中，您询问了重要的原因。这不是，IMO，一个重要的原因，我当然会为这样的边缘情况而烦恼。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T20:35:19.700

我不认为有什么好的理由。也许没有返回，传输的数据就会更少，这样您就可以节省流量。但我认为这根本不重要;-)

# .net - .NET WinForms 和企业库验证应用程序块

> ID：529788
> 
> 赞同：0
> 
> 时间：2009-02-09T20:31:15.543
> 
> 标签：.net, winforms, enterprise-library, validation-application-bl

我有一个 TextBox，其值在解析为 int 后传递给对象中的 int 属性。

当我使用 ValidationProvider 时，在验证时会忽略此转换步骤，并且我收到一条错误消息，告诉我无法将字符串保存到 int32。

我可以通过在我的对象中创建一个字符串属性来解决这个问题，该属性充当表单中的文本框值和我的业务对象中的 int 值之间的桥梁，但我不喜欢这种方法，因为它需要更改我的域对象以取悦验证层.

如何验证转换后将其值存储到 int 的文本框，而不在域对象中创建桥属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T22:46:44.237

我找到了解决方案。

字符串到 int 的转换是自动进行的，但如果文本框留空，它将失败。

我使用了 ValidationProvider 的 ValueConvert 处理程序来解决这个问题，但我确信这是某种错误。

**编辑：除非属性中有验证器，否则不会触发 ValueConvert 事件。当需要输入转换时，使用 [ObjectValidator] 作为虚拟对象来触发 ValueConvert 事件。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T18:08:06.853

另一个“更好”的解决方案是将 TypeConversionValidator 添加到我的属性中。

示例属性：[TypeConversionValidator(typeof(int))]

**编辑：忽略这一点。它不像我预期的那样工作。**

# .net - 在 Excel 中加载 CSS

> ID：529796
> 
> 赞同：0
> 
> 时间：2009-02-09T20:33:00.657
> 
> 标签：.net, excel

在 .net 中，我创建了一个 excel 报告，该报告采用数据网格的渲染输出并将其放入 excel 中。我遇到的问题是数据网格中使用的 CSS 类没有正确显示，因为 CSS 文件没有加载到 excel 文档上。有人可以推荐一种解决此问题的好方法，而不是使用硬编码样式值而不是使用类，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T20:37:05.933

很抱歉，我相信您将不得不使用内联 CSS（无类/选择器）来完成这项工作。

# sql-server - 带有存储过程的 SQL 游标与带有 UDF 的查询

> ID：529821
> 
> 赞同：1
> 
> 时间：2009-02-09T20:37:39.630
> 
> 标签：sql-server, stored-procedures, user-defined-functions, cursors

我正在尝试优化我正在维护的存储过程，并且想知道是否有人可以让我了解以下选项的性能优势/劣势。对于我的解决方案，我基本上需要对存储在表中的 IMAGE 列中的图像运行转换程序。转换过程位于外部 .EXE 文件中。这是我的选择：

1.  将目标表的结果拉到一个临时表中，然后使用游标遍历表中的每一行并在 IMAGE 列上运行存储过程。存储过程调用.EXE。

2.  创建一个调用 .EXE 文件的 UDF，并运行类似于“从 TargetTable 中选择 UDFNAME(Image_Col)”的 SQL 查询。

我想我正在寻找的是创建光标会增加多少开销的想法，而不是作为一个集合来做？

一些附加信息：

*   在这种情况下，集合的大小是最大值。1000
*   正如下面提到的答案，如果使用 UDF 作为一组完成，这是否意味着外部程序一次打开 1000 次？或者是否有针对此的优化？显然，在多处理器系统上，运行多个进程实例可能不是一件坏事，但 1000 个可能有点多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T20:58:39.800

在这种情况下定义集基？如果您有 100 行，这会一次打开应用程序 100 次吗？我会说测试，只是因为您可以从 UDF 调用扩展过程，我仍然会为此使用游标，因为在这种情况下 setbased 无关紧要，因为您没有直接操作表中的数据

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T16:40:49.997

我做了一些测试和试验，当在 UDF 中完成时，它确实一次处理每一行 - SQL 服务器不会为 100 行中的每一行运行 100 个进程（我认为它不会）。

但是，我仍然认为将其作为 UDF 而不是作为光标执行会更好，因为我的研究倾向于表明，必须在光标中提取数据的额外开销会减慢速度。它可能不会产生很大的不同，但与首先将所有数据拉到临时表中相比，它可能会节省时间。

# sql-server-2005 - 如何让 dbX.dbo.procA 在 dbY 的上下文中运行？

> ID：529822
> 
> 赞同：0
> 
> 时间：2009-02-09T20:37:42.487
> 
> 标签：sql-server-2005, stored-procedures

我想将一组特定的存储过程分离到一个单独的数据库中……有点像一个库。但是，当我从另一个数据库运行这些过程时，它们似乎从库数据库中调用对象。

这是一些演示问题的源代码

```
use mylibdb
go

create proc gettablecount
as
begin
    declare @cnt int;
    select  @cnt=count(*)
    from    sysobjects
    where   xtype='U';
    print   'Table count : ' + cast( @cnt as nvarchar);
end
go

use adventureworks
go

exec mylibdb.dbo.gettablecount;

print '';
select  count(*) as [table count]
from    sysobjects
where   xtype='U'; 
```

运行该代码将打印出

> 表数：0
> 
> 表数
> 
> * * *
> 
> 71
> 
> （1 行受影响）

注意 proc 查询的是 mylibdb.dbo.sysobjects 表，而不是 Adventureworks.dbo.sysobjects。

有谁知道没有动态sql我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T20:52:29.050

您可以将库视为代码而不是数据库对象，并在使用“库”的数据库模式中创建过程。我会通过将您的过程和其他共享数据库对象存储为您可以修改和版本的 CREATE 脚本来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T20:54:40.993

动态 sql 是您最安全的选择，您的另一个选择是在模型数据库中创建 proc，然后它将在您创建的每个数据库中都可用（但在当前数据库中不可用，因此您必须将 proc 添加到那些数据库中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-24T16:38:08.503

我已经确定这无法完成，所以我将脚本保存为脚本文件，而不是保存在 procs 中。

因此，我的 proc 将简化为这个匿名块：

```
begin
    declare @cnt int;
    select      @cnt=count(*)
    from        sysobjects
    where       xtype='U';
    print       'Table count : ' + cast( @cnt as nvarchar);
end 
```

PS-这只是一个“记录”类型的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-24T16:42:04.550

另一种方法是在 master 数据库中创建 sp_ 过程：

[http://www.mssqltips.com/tip.asp?tip=1612](http://www.mssqltips.com/tip.asp?tip=1612)

# oop - 是否有一个常用的 OO 模式来保存“常量变量”？

> ID：529823
> 
> 赞同：2
> 
> 时间：2009-02-09T20:38:03.250
> 
> 标签：oop, dependency-injection, inversion-of-control

我正在为一个爱好做一个小[弹球游戏项目，并且正在寻找一种封装常量变量的模式。](http://mirror.mit-ocw.sbu.ac.ir/OcwWeb/Electrical-Engineering-and-Computer-Science/6-170Fall-2005/Projects/index.htm)

我有一个模型，其中有一些值将在该模型的整个生命周期内保持不变，例如最大速度/最大重力等。在整个 GUI 和其他区域中，这些值是正确验证输入所必需的。目前，它们要么作为对 a 的引用`public static final`，要么只是简单的硬编码。我想将这些“常量变量”封装在一个可以注入模型中并由视图/控制器检索的对象中。

澄清一下，“常量变量”的值不一定是在编译时定义的，它们可能来自读取文件；用户输入等。在编译时已知的是需要*哪些*。一种可能更容易解释的方式是，无论这种封装是什么，它提供的值都是**不可变**的。

我正在寻找一种方法来实现这一点：

*   具有编译时类型安全性（即在运行时不将字符串映射到变量）
*   避免任何静态（包括不能扩展的枚举）

我知道我可以定义一个具有以下方法的接口：

```
 public int getMaximumSpeed();
 public int getMaximumGravity(); 
```

...并将其实例注入模型中，并以某种方式使其可访问。但是，这会导致大量样板代码，编写/测试等非常乏味（我这样做是为了好玩:-)）。

我正在寻找一种更好的方法来做到这一点，最好是具有成为共享词汇的一部分的好处，就像设计模式一样。

有一个更好的方法吗？

PS我对此进行了更多思考，我能找到的最好的权衡是拥有类似的东西：

```
public class Variables {
   enum Variable {
       MaxSpeed(100),
       MaxGravity(10)

       Variable(Object variableValue) {
          // assign value to field, provide getter etc.
       }
   }

   public Object getVariable(Variable v) { // look up enum and get member }

} // end of MyVariables 
```

然后我可以做类似的事情：

```
Model m = new Model(new Variables()); 
```

*优点*：必须成为枚举的成员才能编译变量的查找受到保护，可以用很少的额外代码添加变量
*缺点*：枚举不能扩展，脆弱（需要重新编译才能添加变量），变量值必须从 Object 强制转换（在本例中为 Integer），这同样不是类型安全的，尽管泛型可能是一种选择......不知何故

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T20:40:31.340

您在寻找[Singleton](http://en.wikipedia.org/wiki/Singleton_pattern)或变体[Monostate](http://c2.com/cgi/wiki?MonostatePattern)吗？如果不是，那么该模式如何满足您的需求？

当然，这是[任何全球都是邪恶](http://c2.com/cgi/wiki?SingletonsAreEvil)的强制性免责声明。

更新：我做了一些查找，因为我一直有类似的辩论/问题。我偶然发现了经典全局/范围解决方案的“替代方案”[列表。](http://peerbox.com:8668/space/Context)以为我会分享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T22:40:00.443

感谢你们花费所有时间试图破译什么是一个非常奇怪的问题。

我认为，就设计模式而言，最接近我所描述的是工厂模式，其中我有一个伪常量工厂。从技术上讲，它不是每次调用都创建一个实例，而是始终提供相同的实例（在 Guice 提供者的意义上）。但是我可以创建几个工厂，每个工厂都可以提供不同的伪常量，并将每个工厂注入不同的模型，因此模型的 UI 可以更灵活地验证输入。

如果有人感兴趣，我得出的结论是，为每个伪常量提供方法的接口是可行的方法：

```
public interface IVariableProvider {
    public int maxGravity();
    public int maxSpeed();
    // and everything else...
}

public class VariableProvider {
    private final int maxGravity, maxSpeed...;
    public VariableProvider(int maxGravity, int maxSpeed) {
        // assign final fields
    }
} 
```

然后我可以这样做：

```
Model firstModel = new Model(new VariableProvider(2, 10));  
Model secondModel = new Model(new VariableProvider(10, 100)); 
```

我认为只要接口不提供过多的变量获取器，它就会胜过一些参数化的查找（这在运行时很容易受到攻击，或者会禁止扩展/多态性）。

PS 我意识到有些人一直在质疑我的问题是静态最终值。我向一位同事发表声明（口无遮拦），任何静态的东西本质上都不是面向对象的。因此，在我的爱好中，我将其用作思考练习的基础，我尝试从项目中删除任何静态内容（接下来我将尝试删除所有“if”语句；-D）。如果我在最后期限内并且我对公共静态最终值不会妨碍测试感到满意，我会很快使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T20:51:38.443

如果您只是使用 java/IOC，为什么不直接依赖注入值呢？

例如 Spring 通过映射注入值，将对象指定为单例 -

```
<property name="values">
    <map>
        <entry> <key><value>a1</value></key><value>b1</value></entry>
        <entry> <key><value>a2</value></key><value>b3</value></entry>
    </map>
  </property> 
```

您的班级是一个单身人士，其中包含春季设置的地图的不可变副本-

```
private Map<String, String> m;

public String getValue(String s)
{
  return m.containsKey(s)?m.get(s):null;
}

public void setValues(Map m)
{
  this.m=Collections.unmodifiableMap(m):
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T21:34:28.370

据我所知，您可能不需要在这里实现模式——您只需要访问一组常量，而且在我看来，通过使用可公开访问的静态接口可以很好地处理这些常量。除非我错过了什么。:)

但是，如果您只是想“客观化”常量，则出于某种原因，可能会调用 Singleton 模式（如果有的话）；我知道您在评论中提到您不介意创建此包装器对象的多个实例，但作为回应，我会问，那么为什么还要引入可能因拥有多个实例而引起的混乱呢？您正在寻找什么实际的好处来满足以对象形式提供数据？

现在，如果这些值不是常量，那就不同了——在这种情况下，您可能确实想要一个 Singleton 或 Monostate。但如果它们真的是常量，只需将一组枚举或静态常量包装在一个类中即可！保持简单是一种很好的“模式”。

# c# - 在 RichTextBox 中格式化 rtf/unicode/utf-8 的最简单方法？

> ID：529825
> 
> 赞同：1
> 
> 时间：2009-02-09T20:38:23.497
> 
> 标签：c#, winforms, utf-8, richtextbox, rtf

我目前正在努力解决这个问题。但长话短说，我想将 2 UTF-8 '\u0002' 之间的字符串转换为粗体格式。这是针对我正在处理的 IRC 客户端的，所以我已经遇到了很多。我已经使用了正则表达式，发现在 rtf 上匹配为 ((\'02) 可以捕获它，但我不确定如何匹配最后一个字符并将其更改为 \bclear 或任何 rtf 格式 close 。

我无法准确粘贴我要解析的文本，因为字符会从帖子中过滤掉。但是当查看 char 值时，它的 int 为 2。

这是粘贴有问题的文本的尝试：

> [02:34] 测试测试

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T20:58:40.190

你可以使用

```
rtb.Rtf = Regex.Replace(rtb.Rtf, @"\\'02\s*(.*?)\s*\\'02", @"\b $1 \b0"); 
```

或者

```
rtb.Rtf = Regex.Replace(rtb.Rtf, @"\\'02\s*(.*?)\s*\\'02", @"\'02 \b $1 \b0 \'02"); 
```

取决于您是否要将 \u0002s 保留在其中。

\b 和 \b0 在 RTF 中打开和关闭粗体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-24T20:44:57.670

我没有测试用例，但您也可以将`Clipboard`类的[`GetText`方法](http://msdn.microsoft.com/en-us/library/944ft9kf.aspx)与[`Unicode`TextDataFormat](http://msdn.microsoft.com/en-us/library/system.windows.forms.textdataformat.aspx)一起使用。基本上，我认为您可以将输入放在剪贴板中并以不同的格式输出（适用于 RTF 等）。这是MS的演示代码（不直接适用，但演示了API）：

```
// Demonstrates SetText, ContainsText, and GetText. 
public String SwapClipboardHtmlText(String replacementHtmlText)
{
    String returnHtmlText = null;
    if (Clipboard.ContainsText(TextDataFormat.Html))
    {
        returnHtmlText = Clipboard.GetText(TextDataFormat.Html);
        Clipboard.SetText(replacementHtmlText, TextDataFormat.Html);
    }
    return returnHtmlText;
} 
```

当然，如果您这样做，您可能想要保存和恢复剪贴板中的内容，否则您可能会惹恼您的用户！

# python - Python 正则表达式是否支持 Perl 的 \G 之类的东西？

> ID：529830
> 
> 赞同：5
> 
> 时间：2009-02-09T20:39:31.420
> 
> 标签：python, regex, perl

我有一个包含 \G 元字符的 Perl 正则表达式（显示[在这里](https://stackoverflow.com/questions/529657/how-do-i-write-a-regex-that-performs-multiple-substitutions-on-each-line-except/529735#529735)，尽管希望不需要理解整个事情来回答这个问题）。我想把它翻译成 Python，但 Python 似乎不支持 \G。我能做些什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T01:03:42.207

Python does not have the /g modifier for their regexen, and so do not have the \G regex token. A pity, really.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T20:42:33.643

试试这些：

```
import re
re.sub()
re.findall()
re.finditer() 
```

例如：

```
# Finds all words of length 3 or 4
s = "the quick brown fox jumped over the lazy dogs."
print re.findall(r'\b\w{3,4}\b', s)

# prints ['the','fox','over','the','lazy','dogs'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T21:05:24.667

您可以使用`re.match`来匹配锚定模式。`re.match`只会在文本的开头（位置 0）或您指定的位置匹配。

```
def match_sequence(pattern,text,pos=0):
  pat = re.compile(pattern)
  match = pat.match(text,pos)
  while match:
    yield match
    if match.end() == pos:
      break # infinite loop otherwise
    pos = match.end()
    match = pat.match(text,pos) 
```

这只会匹配给定位置的模式，以及后面 0 个字符之后的任何匹配项。

```
>>> for match in match_sequence(r'[^\W\d]+|\d+',"he11o world!"):
...   print match.group()
...
he
11
o 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-27T01:21:03.887

我知道我有点晚了，但这里有一个替代`\G`方法：

```
import re

def replace(match):
    if match.group(0)[0] == '/': return match.group(0)
    else: return '<' + match.group(0) + '>'

source = '''http://a.com http://b.com
//http://etc.'''

pattern = re.compile(r'(?m)^//.*$|http://\S+')
result = re.sub(pattern, replace, source)
print(result) 
```

输出（通过[Ideone](http://ideone.com/tZ2Gm)）：

```
<http://a.com> <http://b.com>
//http://etc. 
```

这个想法是使用匹配两种字符串的正则表达式：URL 或注释行。然后你使用回调（委托、闭包、嵌入代码等）来找出你匹配的那个并返回适当的替换字符串。

事实上，即使在支持`\G`. 即使在 Java 中，我也必须编写一堆样板代码来实现回调。

（我不是 Python 人，所以如果代码非常不符合 Python 风格，请原谅我。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T06:13:33.007

不要试图将所有内容都放在一个表达式中，因为它变得非常难以阅读、翻译（如您自己所见）和维护。

```
import re
lines = [re.sub(r'http://[^\s]+', r'<\g<0>>', line) for line in text_block.splitlines() if not line.startedwith('//')]
print '\n'.join(lines) 
```

当您从 Perl 字面上翻译时，Python 通常不是最好的，它有自己的编程模式。

# c++ - 在 C++ Map 中返回严格小于给定键的最大键

> ID：529831
> 
> 赞同：33
> 
> 时间：2009-02-09T20:39:49.127
> 
> 标签：c++, stl

C++ STL Maps 有没有办法支持这一点，因为地图上的 lower_bound 和 upper_bound 严格返回大于传递值的值。

[下键](http://java.sun.com/javase/6/docs/api/java/util/NavigableMap.html#lowerKey(K))

用例我有一个以时间作为键的地图，所以在地图中

```
time t1   = value1
time t2   = value2
time t2.5 = value3 
```

在这种情况下，如果我传递给这个 MAP t2.3，那么它应该给我 value2。是否在地图上做一个 lower_bound 并返回一个等同于“返回最大键严格小于给定键”的元素，即

```
iterator = map.upper_bound(2.3)
and then 
iterator--; 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-09T20:57:14.593

是的，lower_bound 可以用于那个，我以前见过它并像那样使用它。

```
map_type::iterator it = map.lower_bound(2.3);
if(it != map.begin()) {
    --it;
    // it now points at the right element
} 
```

实际上会返回最大但更小的（如果它 != map.begin() 是真的）一个。如果它位于 .begin，则没有更小的键。`.end`评论中的好主意是如果没有更少的元素则返回并将这些东西打包到一个函数中：

```
template<typename Map> typename Map::const_iterator 
greatest_less(Map const& m, typename Map::key_type const& k) {
    typename Map::const_iterator it = m.lower_bound(k);
    if(it != m.begin()) {
        return --it;
    }
    return m.end();
}

template<typename Map> typename Map::iterator 
greatest_less(Map & m, typename Map::key_type const& k) {
    typename Map::iterator it = m.lower_bound(k);
    if(it != m.begin()) {
        return --it;
    }
    return m.end();
} 
```

该模板也应该适用`std::set`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-09T20:50:52.673

如果你不关心排序，你可以使用 map::upper_bound 来获取你想要的元素，但是你需要为特征参数定义带有 std::greater 的 map 类，以便排序是 high-to -低的。

```
typedef std::map<double,MyClass,std::greater<double> > MyMap;
MyMap myMap;
myMap[1.5] = value1;
myMap[2.0] = value2;
myMap[3.0] = value3;

MyMap::iterator elt = myMap.upper_bound(2.5); // should be pair(2.0,value2) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T20:58:26.057

您的方法将起作用，但您需要检查以确保您没有回到地图的开头。另外，您需要lower_bound，而不是upper_bound。

```
iterator = map.lower_bound(2.3)
if (iterator != map.begin())
    --iterator; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T20:54:51.853

我会将 std::find_if() 与反向迭代器一起使用，例如：

```
find_if( map.rbegin(), map.rend(), is_less_than ); 
```

您必须定义 is_less_than() 谓词函数。

（参见[http://www.cplusplus.com/reference/algorithm/find_if.html](http://www.cplusplus.com/reference/algorithm/find_if.html)）

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-07-25T13:04:47.160

我总是发现计算 floor(x) 和 ceil(x) 非常有用

```
floor(x) -> greatest element <=x 
ceil(x) -> smallest element >= x

floor_it = m.lower_bound(x); 
if (floor_it != m.end() && floor_it->first != x)
      --floor_it;

ceil_it = m.upper_bound(x);
if (ceil_it != m.end() && (ceil_it-1)->first == x)
    --ceil_it; 
```

# c# - LINQ 相关计算分配

> ID：529836
> 
> 赞同：4
> 
> 时间：2009-02-09T20:40:47.923
> 
> 标签：c#, linq, extension-methods, design-patterns

我在 C# 中使用以下模式：

```
IList<foo> x = y.Select(a => new foo
{
    b = Calc1(),
    c = Calc2()
}).ToList();

foreach(foo f in x)
{
    f.d = b / c;
} 
```

我想做的是：

```
IList<foo> x = y.Select(a => new foo
{
    b = Calc1(),
    c = Calc2()
    d = b / c;
}).ToList(); 
```

所以问题是：如何修改此模式以允许分配一个依赖于在分配期间计算的其他值的值？

（可能有人会指出 d 应该是一个进行计算并返回值的属性。这是一个人为的例子。假设 d 的值是使用除了 c 和 b 之外的其他值计算的，这些值以后不可用。 )

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T20:43:57.090

如果将其扩展为使用完整的 LINQ 语法：

```
IList<foo> x = (from a in y
                let bq = Calc1()
                let cq = Calc2()
                select new foo {
                    b = bq,
                    c = cq, 
                    d = bq / cq
                }).ToList(); 
```

这会让你得到你想要的。

有一个答案建议您重复您的方法调用（即 d = Calc1() / Calc2()） - 但我建议不要这样做，因为 Calc1() 和 Calc2() 可能是昂贵的操作，而且是不必要的执行两次可能会对性能产生影响。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T20:48:46.453

您不能在初始化程序中重用已初始化的属性。

我喜欢 Erik 的技术。如果查询表达式语法很麻烦，您可以使用完整的匿名方法。

```
 List<int> y = new List<int>() { 1, 2, 3, 4 };
        var x = y.Select(a =>
            {
                int b = a + 1;
                int c = a + 2;
                int d = b / c;
                return new { b = b, c = c, d = d };
            }); 
```

# sql - MDX 计算事件之间的时间

> ID：529850
> 
> 赞同：3
> 
> 时间：2009-02-09T20:43:55.577
> 
> 标签：sql, data-warehouse, mdx

我有一个多维数据集，它从 4 个事实/暗淡表中提取数据。

1.  `FactCaseEvents (EventID,CaseID,TimeID)`
2.  `DimEvents (EventID, EventName)`
3.  `DimCases (CaseID,StateID,ClientID)`
4.  `DimTime (TimeID,FullDate)`

事件将是：`CaseReceived,CaseOpened,CaseClientContacted,CaseClosed`

DimTime 每小时保存一个条目。

我想写一个 MDX 语句，它会给我 2 列：“ `CaseRecievedToCaseOpenedOver5`”和“ `CaseClientContactedToCaseClosedOver5`”

`CaseRecievedToCaseOpenedOver5``CaseReceived`将保存在和之间的时间差超过 5 小时的案例数`CaseOpened`。

我猜 " `CaseRecievedToCaseOpenedOver5`" 和 " `CaseClientContactedToCaseClosedOver5`" 将是计算成员，但我需要一些帮助来弄清楚如何创建它们。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T22:58:25.067

这看起来是一个使用累积快照类型事实表并计算在 ETL 过程中从管道的一个阶段移动到下一个阶段所花费的时间的好地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T22:01:36.230

AdventureWorks 的查询（DateDiff 在 MDX 中有效）：

```
WITH 
MEMBER Measures.NumDays AS 
'iif(ISEMPTY(([Delivery Date].[Date].CurrentMember
,[Ship Date].[Date].CurrentMember
,Measures.[Order Count]))
,null
, Datediff("d",[Ship Date].[Date].CurrentMember.Name
,[Delivery Date].[Date].CurrentMember.Name))'
SELECT
NON EMPTY {[Ship Date].[Date].&[63]
:[Ship Date].[Date].&[92]} ON COLUMNS,
NON EMPTY {[Delivery Date].[Date].&[63]
:[Delivery Date].[Date].&[92]} 
* {[Measures].[NumDays]
, [Measures].[Order Count]} ON ROWS
FROM [Adventure Works] 
```

取自：[http ://www.mombu.com/microsoft/sql-server-olap/t-can-i-have-datediff-in-mdx-265763.html](http://www.mombu.com/microsoft/sql-server-olap/t-can-i-have-datediff-in-mdx-265763.html)

如果您将经常使用此成员，请将其创建为多维数据集中的计算成员，如果我没记错的话，在“计算”选项卡上。

# asp.net - URLRewriter 查询字符串中的与号

> ID：529857
> 
> 赞同：3
> 
> 时间：2009-02-09T20:45:24.137
> 
> 标签：asp.net, query-string, url-encoding, urlrewriter

我有一个包含＆符号的查询字符串参数值。例如，参数的有效值可能是：

```
a & b 
```

当我生成包含参数的 URL 时，我正在使用 System.Web.HTTPUtility.UrlEncode() 使每个元素对 URL 友好。它（正确地）给了我一个像这样的 URL：

[http://example.com/foo?bar=a+%26b](http://example.com/foo?bar=a+%26b)

问题是 ASP.NET 的 Request 对象将（编码的）＆符号解释为查询字符串参数分隔符，因此将我的值分成两部分（第一个有“bar”作为参数名称；第二个有一个空名称）。

似乎 ASP.NET 是先对 URL 进行 URL 解码，然后在解析查询字符串时使用它。

解决此问题的最佳方法是什么？

* * *

**更新**：问题取决于[URLRewriter](http://urlrewriter.net/)（第三方插件）而不是 ASP.NET 本身。我已更改标题以反映这一点，但我将保留问题文本的其余部分，直到我找到有关该问题的更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T07:00:37.573

伙计，我和你在同一条船上，我花了好几个小时试图找出问题所在，正如你所说，这两者都是一个错误，因为普通链接包含奇怪的字符或 UTF-8 代码asp.net 可以很好地解析字符。

我认为我们必须切换到 MVC.routing

**更新**：你不会相信的，我发现问题很奇怪，它与 IIS 有关，尝试从 Visual Studio 开发服务器启动您的页面，Unicode 字符将被解析得很好，但是如果您从 IIS 启动页面7 它会给你的???? 人物。

希望一些身体会在这里遮住一些光

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-18T05:48:16.623

我会认为 %26 和 '&' 对 Web 服务器来说意味着完全相同的东西，所以它是预期的行为。Urlencode 用于编码 URL，而不是编码查询字符串。

...等等...尝试在谷歌搜索 abc&def，你会得到：

[http://www.google.com.au/search?q=abc%26def](http://www.google.com.au/search?q=abc%26def)

因此，您的查询字符串*是*正确的， %26 是文字和符号。嗯，你是对的，听起来像一个错误。您如何使用 & 而不是 %26 ？

有趣的阅​​读：

[http://www.stylusstudio.com/xsllist/200104/post11060.html](http://www.stylusstudio.com/xsllist/200104/post11060.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T22:55:31.483

切换到[UrlRewritingNet.UrlRewrite](http://www.urlrewriting.net/149/en/home.html)并**没有**帮助，因为它显然有同样的错误。我认为它可能与 ASP.NET 毕竟有关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-17T13:13:13.703

我认为 URLRewriter 有无名参数（空名称）的问题。
我有一个类似的问题。当我给我的无名参数一个（虚拟）名称时，一切都按预期工作。

# sql - 当涉及到数据库列时，您更喜欢冗长的命名吗？

> ID：529863
> 
> 赞同：6
> 
> 时间：2009-02-09T20:47:44.193
> 
> 标签：sql, database-design, naming-conventions, naming

你的偏好是哪一个？

假设我们有一个通用的 Product 表，它有一个 ID、一个名称和一个对类别的外键引用。您是否愿意将您的表命名为：

```
CREATE TABLE Products
(
    ProductID int NOT NULL IDENTITY(1,1) PRIMARY KEY,
    CategoryID int NOT NULL FOREIGN KEY REFERENCES Categories(CategoryID),
    ProductName varchar(200) NOT NULL
) 
```

对列使用显式命名（例如**产品**名称、**产品**ID），或类似：

```
CREATE TABLE Products
(
    ID int NOT NULL IDENTITY(1,1) PRIMARY KEY,
    CategoryID int NOT NULL FOREIGN KEY REFERENCES Categories(ID),
    Name varchar(200) NOT NULL
) 
```

据我所知，.NET 世界中的约定是明确的——示例倾向于使用第一个示例，而开源和 RoR 世界倾向于使用第二个示例。就我个人而言，我发现第一眼看上去更容易阅读和理解： `select p.ProductID, p.ProductName, c.CategoryName from Categories c inner join Products p on c.CategoryID = p.CategoryID`对我来说似乎比第一个更自然`select p.ID AS ProductID, p.Name AS ProductName, c.Name AS CategoryName from Categories c inner join Products p on c.ID = p.CategoryID`

我想鉴于我提供的基本示例，这没什么大不了的，但是当您处理大量数据和表格时呢？我仍然会发现第一个示例比第二个示例更好，尽管可能两者的某种组合可能值得研究（`<Table>ID`对于 ID，但只是`Name`对于名称？）。显然，在现有项目上，您应该遵循已经建立的约定，但是对于新开发呢？

你的偏好是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-09T20:56:16.140

表名已经给出了上下文。无需在列名前加上它。连接表时使用 table.column 语法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-09T21:06:58.327

我是选项3的粉丝：

```
CREATE TABLE Products
(
    ProductId int NOT NULL IDENTITY(1,1) PRIMARY KEY,
    CategoryId int NOT NULL FOREIGN KEY REFERENCES Categories(CategoryId),
    Name varchar(200) NOT NULL
) 
```

因此，主键是获得表名作为前缀的唯一列——恕我直言，它可以更容易地查看连接何时出错。再说一次，如果将来有可能不得不处理合并复制情况，我也喜欢将 GUID 用于主键......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T10:47:58.410

还要检查相关问题：[在表中使用缩写表名作为每个字段名的前缀是一种好习惯吗？](https://stackoverflow.com/questions/465136/is-prefixing-each-field-name-in-a-table-with-abbreviated-table-name-a-good-practi/465170#465170)

正如[我在回答中提到的那样](https://stackoverflow.com/questions/465136/is-prefixing-each-field-name-in-a-table-with-abbreviated-table-name-a-good-practi/465170#465170)；使用表名作为字段名前缀的概念来自旧系统的旧时代，当时整个数据库中的每个字段都需要是唯一的。现代系统不再需要这一点，因此它只是一个不再需要的约定。正如[在编码之前思考](https://stackoverflow.com/questions/529863/do-you-prefer-verbose-naming-when-it-comes-to-database-columns/529909#529909)“*表名已经给出了上下文。不需要在列名前面加上前缀*”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-09T21:34:00.447

我坚持尽可能短的名字。人们在每一列上加上表名的前缀让我很暴力。PERSON.first_name，而不是 PERSON.person_first_name。我们知道它是一个人，它在 person 表中......它还会是什么？

我唯一一次违反此规则是针对 id 列，例如：PERSON.personID。

规则是，向爱因斯坦道歉；尽可能冗长，但不再冗长。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T21:33:28.950

我通常给每个表一个唯一的前缀。所以你的例子就像

```
CREATE TABLE Products
(
    PROD_ID int NOT NULL IDENTITY(1,1) PRIMARY KEY,
    PROD_CAT_ID int NOT NULL FOREIGN KEY REFERENCES Categories(CAT_ID),
    PROD_NAME varchar(200) NOT NULL
) 
```

这使得加入和选择列更容易，因为您没有名称冲突。除非您多次引用同一个表，否则您甚至不需要表名别名（很可能）。

但是最近我开始认为（2）可能会更好，因为它更接近我在编写代码时使用的命名约定（在我的例子中是 C#）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-09T22:49:57.363

当您有很多连接时，ID 会非常混乱。我更喜欢明确的 id 名称与外键中的 id 名称相匹配。这样，您始终知道 customerid 将与 customerid 加入任何其他具有该列的表中。

永远不要使用名称作为字段名称。它是一个保留字，因此应避免使用。数据库以某种方式使用保留的关键字，将它们也用作字段名称只是不好的做法，并且比从一开始就使用正确的描述性名称会产生更多的错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T21:19:06.893

一种观点是列名应该代表整个数据库的单个域空间。例如，产品名称与公司名称完全不同。一个可能比另一个长，等等。在这方面，您应该使用第一种方法，因为它可以区分两者。

另一方面，我在某种程度上同意 Think Before Coding 的逻辑。我总是使用 table.column 语法，所以上下文应该很清楚。

使用更详细的列名通常可以避免与保留字的冲突。

再说一次，如果您的产品表中的每一列都是 ProductXxxx，这可能是非常多余的。

换句话说，我没有绝对的偏好，但我确实更倾向于冗长的命名约定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T21:26:09.343

我更喜欢坚持使用“ID”的简短版本。这是一个易于理解和遵循的约定，表的记录标识符将被称为“ID”，它将引用其“自己的”表而不是其他东西（尽管有时不需要“自己的”标识符）一些表，如映射）。

它给出的另一个结果是，每当您编写查询时，您都不需要考虑和记住确切的列名。您知道，只要表具有记录标识符就可以通过“ID”引用它。

它简化了事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-09T21:37:50.033

我更喜欢uid、gid、pid、wid、lid等。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-10T11:06:17.680

我认为如果列名在数据库中不是唯一的，则应在其前面加上表名。比如，ProductId，ProductName。对于与其他表中的列不冲突的列，不要为其添加前缀。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-10-26T14:03:17.823

选项 2 是最好的（当然对我来说 :)），
我是 PHP 程序员而不是 .NET 程序员。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-26T14:10:43.190

我更喜欢第二种选择，因为第一种选择对我来说似乎是不必要的重复。当然，我主要是一名 Ruby on Rails 程序员，所以我喜欢[DRY 原则](http://en.wikipedia.org/wiki/Don't_repeat_yourself)。:) 我发现 C# 编程很烦人，因为一切都使用第一个、明确但重复的版本。

# .net-3.5 - Google 和 Microsoft 在 AppData 文件夹中安装应用程序，为什么不是我？

> ID：529864
> 
> 赞同：2
> 
> 时间：2009-02-09T20:47:45.177
> 
> 标签：.net-3.5, windows-installer, uac, auto-update

**可以在 AppData 文件夹中安装应用程序吗？**Google Talk 和 Chrome 都没有安装在默认的 Program Files 文件夹中。它们安装在用户的 AppData 文件夹中。微软对 ClickOnce 做了同样的事情......

我想让我的应用程序进行自我更新，但是当安装在 Program Files 文件夹中时，它会失败。在 Windows Vista（2008 和 7）下，应用程序无法写入 Program Files 文件夹。我知道 UAC 是负责任的，但它会阻止我的应用程序自我更新。

如果我想在 AppData 文件夹中部署以解决安全问题，**我如何告诉我的 MSI 安装项目安装在 AppData 中**？任何想法？

谢谢！

**更新**：我不能使用 ClickOnce，因为它需要证书。我不想花 200 美元/年购买证书。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-03T14:14:08.557

从 VS 2008 开始，clickonce 部署可以取消签名

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T20:59:09.643

你误会了一个关键点：

> 我了解 UAC 是负责人

这不是真的。如果您以标准用户身份运行，则同样的规则适用于 XP，在许多公司环境中都是如此。阻止这种情况的不是 UAC：这是 Windows 设置文件夹权限的方式，这是设计使然。

你有点回答了你自己的问题：如果你想安装到 AppData 文件夹，只需使用 ClickOnce 安装程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-06T04:45:53.890

在 Windows 7 中，新的 MSI 5.0 支持真正的“每用户”安装，不需要 UAC 提升——现在有一个每用户 Program Files 目录。以下是 PDC 演讲以获取更多信息：

[http://channel9.msdn.com/pdc2008/PC42/](http://channel9.msdn.com/pdc2008/PC42/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T21:11:42.733

你用的是什么自我更新框架？

ClickOnce 的最初目标之一是成为一种无影响的安装方法。安装只是一个 XCOPY，几乎可以保证不会与系统的其余部分混淆。这是 MS 选择 AppData 而不是 Program Files 的部分原因。如果您只将文件写入 AppData，那么破坏整个系统的可能性要小得多。

如果您的自定义框架想要自我更新并且有一个用户，低影响安装，AppData 可能不是一个糟糕的选择。实际上，Users 目录下的任何内容都比 Program Files 更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-03T13:46:52.070

是的，但我在 Vista 上观察到一个非常奇怪的行为，我在我的 msi 中使用了 appdatafolder 属性，它需要管理员权限才能安装，现在当 uac 打开并且标准使用运行应用程序时，uac 显示登录框并询问管理员当我们提供相同的应用程序被安装但不在标准用户的应用程序数据文件夹中时，密码被安装在管理员应用程序数据文件夹中。

# c# - 如何使用下拉列表而不是按钮重定向？

> ID：529866
> 
> 赞同：2
> 
> 时间：2009-02-09T20:48:12.257
> 
> 标签：c#, .net, asp.net

我正在研究仅使用 ddl 来运行我的查询，而不是 ddl 和 Button_Click 函数。我还没有找到该怎么做。我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T20:52:10.487

在您的 as(p/c)x 中：

```
<asp:DropDownList runat="server" 
                  id="ddl"
                  OnSelectedIndexChanged="SelectionChanged"
                  AutoPostBack="true">
    <asp:ListItem Text="Page 1" Value="/page1.aspx" />
    <asp:ListItem Text="Page 2" Value="/page2.aspx" />
</asp:DropDownList> 
```

“AutoPostBack”属性告诉 ASP.NET 连接一个客户端 (javascript) 命令，该命令在下拉列表更改时立即提交表单，而不是等待按钮单击。

在您的代码隐藏中，我们在“OnSelectedIndexChanged”属性中引用的事件处理程序将被触发：

```
protected void SelectionChanged(object sender, EventArgs e)
{
    Response.Redirect(((DropDownList)sender).SelectedValue);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T20:50:25.247

将 AutoPostBack 属性设置为 true，然后挂钩到 OnSelectedIndexChanged 事件

```
<asp:DropDownList 
         id="dropDownList1" 
         runat="server" 
         AutoPostBack="true" 
         OnSelectedIndexChanged="dropDownList1_SelectedIndexChanged" /> 
```

服务器端

```
void dropDownList1_SelectedIndexChanged
                   (Object sender, EventArgs e) {

   //run your query

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T20:51:08.383

确保您的下拉列表将其“AutoPostback”属性设置为 true。当用户从下拉列表中选择一个项目时，这将导致页面回发。您可以在您想要的任何事件、Page_Load 或 DDL 自己的 OnSelectedIndexChanged 的​​代码隐藏中对此做出响应

# events - Application.ApplicationExit 事件是否可以在非 Winforms 应用程序中通知退出？

> ID：529867
> 
> 赞同：5
> 
> 时间：2009-02-09T20:48:31.977
> 
> 标签：events, .net-2.0, console-application, exit, exit-handler

当应用程序退出时，我们的代码库需要得到通知。所以我们订阅了 System.Window.Forms.Application.ApplicationExit 事件。这适用于 Winforms 应用程序，但它是否也适用于其他类型的应用程序，例如控制台应用程序、服务和 Web 应用程序（例如 ASP.NET）？命名空间会暗示它没有，并且它可能在`Application.Exit()`被调用（显式或隐式）时被引发，这对于这些其他情况可能不正确。

是否有其他事件在这些其他情况下会更好或更普遍（如果它也适用于 Winforms，那就太好了）？例如，是否有一个事件何时`Environment.Exit()`被调用（控制台应用程序）？

我在 System.Diagnostic.Process 中发现了一个 Exited 事件的提及，但这似乎是为了监视*另一个*进程的退出，并且它似乎没有被一个关于它自己的进程接收（例如，`Process.GetCurrentProcess().Exited += Process_Exited; Process.GetCurrentProcess().EnableRaisingEvents = true;`）。我认为它可能只有在进程实际退出后才会被提出，所以这是行不通的。

这尤其适用于 .NET 2.0 和 C#。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-07-20T18:49:31.243

我们终于找到了更多关于此的信息（但到那时我的机器已经重建并且在我未注册的个人资料中丢失了 cookie；希望它会让我们发布这个答案）。

进一步调查最终发现了一些我们认为有帮助的事件：

`System.Windows.Forms.Application.ThreadExit`- 在消息循环退出 `System.Windows.Forms.Application.ApplicationExit`时触发 - 在所有消息循环退出 `System.AppDomain.CurrentDomain.DomainUnload`时触发 - 在默认域以外的 域退出时`System.AppDomain.CurrentDomain.ProcessExit`触发 - 在默认应用程序域退出 `System.AppDomain.CurrentDomain.UnhandledException`时触发 - 在发生未捕获的异常时触发，结束应用程序。

对于给定的应用程序域，只有一个`DomainUnload`或`ProcessExit`事件是可能的，这取决于它是进程的默认（顶级）域还是被创建为子域（例如，在 Web 服务器上）。如果一个应用程序不知道它可能是哪个（如我们的例子），它需要订阅这两者，如果它想为自己捕获实际的卸载。此外，似乎`UnhandledException`（从 .NET2.0 开始总是致命的）可能会阻止其他两个事件，因此这可能是第三种需要处理的情况。这三个事件应该适用于任何 .NET 应用程序。

需要注意的是，执行时间`ProcessExit`是有限的（大约 4 秒？），因此可能无法在该事件处理程序中进行广泛的“最终”工作。它需要是可以快速完成的事情。

这些`Application`事件仅适用于 WinForms 应用程序（但我们怀疑它们可能不适用于纯 WPF 应用程序）。命名可能会产生误导，因为它们是根据具有某些假设的最基本的正常用法来命名的。 `ThreadExit`与 UI 线程的实际消息循环无关，`System.Threading.Thread`而是与消息循环 ( `Application.Run()`)) 相关，并且`ApplicationExit`类似地与一个或多个 UI 线程上的应用程序表单的集合有关。通常，一旦调用`Application.Run()`返回，从线程的入口方法调用，入口方法很快结束，然后线程本身结束。一旦所有 UI 线程都退出，WinForms 应用程序通常会全部完成并退出。

另一个值得注意的事件是`System.Windows.Forms.Application.ThreadException`事件。可以将 Windows 消息循环配置为捕获处理消息时发生的异常并发送此事件，而不是让它们成为未捕获（因此是致命的）异常。捕获这些异常允许消息循环（以及该 UI 线程）继续运行（在中止当前消息处理程序之后）。对于给定的线程，在任何时候都只能有一个订阅者（订阅会覆盖任何以前的订阅者），并且必须在创建和订阅任何表单之前配置它，然后再进入消息循环。`System.Windows.Forms.Applicaton.SetUnhandledExceptionMode()`有关此事件和更多信息，请参阅 MSDN 帮助。

# perl - Perl 的 Getopt::Long 可以解析我没有提前定义的参数吗？

> ID：529868
> 
> 赞同：4
> 
> 时间：2009-02-09T20:48:33.427
> 
> 标签：perl, getopt-long

我知道如何使用 Perl 的 Getopt::Long，但我不确定如何将其配置为接受*任何*尚未明确定义的“--key=value”对并将其粘贴在哈希中。换句话说，我不提前知道用户可能想要什么选项，所以我无法定义所有选项，但我希望能够解析所有选项。

建议？提前谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-09T21:28:02.397

该[`Getopt::Long`](http://search.cpan.org/perldoc?Getopt::Long)文档建议了一个可能有帮助的配置选项：

```
pass_through (default: disabled)
             Options that are unknown, ambiguous or supplied
             with an invalid option value are passed through
             in @ARGV instead of being flagged as errors.
             This makes it possible to write wrapper scripts
             that process only part of the user supplied
             command line arguments, and pass the remaining
             options to some other program. 
```

解析常规选项后，您可以使用诸如[runrig 提供的代码](https://stackoverflow.com/questions/529868/using-perls-getoptlong-with-arbitrary-arguments/529914#529914)来解析临时选项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T20:57:00.880

Getopt::Long 不会那样做。您可以自己解析选项...例如

```
my %opt;
my @OPTS = @ARGV;
for ( @OPTS ) {
  if ( /^--(\w+)=(\w+)$/ ) {
    $opt{$1} = $2;
    shift @ARGV;
  } elsif ( /^--$/ ) {
    shift @ARGV;
    last;
  }
} 
```

或者修改 Getopt::Long 来处理它（或者修改上面的代码来处理更多种类的选项，如果你需要的话）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T18:41:31.407

我有点偏心，但我过去曾使用 Getopt::Whatever 来解析未知参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-26T20:45:19.200

潜在地，您可以使用“[带有哈希值的选项](http://search.cpan.org/~jv/Getopt-Long-2.38/lib/Getopt/Long.pm#Options_with_hash_values)”功能。

例如，我希望允许用户在解析对象数组时设置任意过滤器。

```
GetOptions(my $options = {}, 'foo=s', 'filter=s%')

my $filters = $options->{filter}; 
```

然后像这样称呼它

```
perl ./script.pl --foo bar --filter baz=qux --filter hail=eris 
```

这会建立类似..

```
$options = {
          'filter' => {
                        'hail' => 'eris',
                        'baz' => 'qux'
                      },
          'foo' => 'bar'
        }; 
```

当然 $filters 将具有与 'filter' 关联的值

祝你好运！我希望有人觉得这很有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-21T19:53:13.607

从[文档](http://search.cpan.org/dist/Getopt-Long/lib/Getopt/Long.pm)中：

## [参数回调](http://search.cpan.org/dist/Getopt-Long/lib/Getopt/Long.pm#Argument_callback)

> 一个特殊的选项“名称”`<>`可以用来指定一个子程序来处理非选项参数。当`GetOptions()`遇到一个看起来不像选项的参数时，它会立即调用这个子例程并传递一个参数：参数名称。
> 
> 好吧，实际上它是一个字符串化参数名称的对象。
> 
> 例如：
> 
>  ````
>     my $width = 80;
>     sub process { ... }
>     GetOptions ('width=i' => \$width, '<>' => \&process);
> 
> ```` 
> 
> 当应用于以下命令行时：
> 
>  ````
>     arg1 --width=72 arg2 --width=60 arg3
> 
> ```` 
> 
> 这将调用`process("arg1")`while`$width`为 80、`process("arg2")`while`$width`为 72 和`process("arg3")`while`$width`为 60。
> 
> 此功能需要配置选项 permute，请参阅 [“配置 Getopt::Long”](http://search.cpan.org/dist/Getopt-Long/lib/Getopt/Long.pm#Configuring_Getopt::Long)部分。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-10T08:12:43.610

这是推出您自己的选项解析器的好时机。我在 CPAN 上看到的所有模块都没有提供这种类型的功能，您始终可以查看它们的实现以很好地了解如何处理解析的具体细节。

顺便说一句，这种类型的代码让我讨厌 Getopt 变体：

```
use Getopt::Long;
&GetOptions(
    'name' => \$value
); 
```

不一致的大小写是令人抓狂的，即使对于长期看过和使用这种代码风格的人来说也是如此。

# ruby-on-rails - Firefox 中的非工作 Rails 链接

> ID：529869
> 
> 赞同：0
> 
> 时间：2009-02-09T20:48:34.067
> 
> 标签：ruby-on-rails, ruby, ajax, firefox

我有以下 Rails 链接生成代码

（我已经删除了可能是“行业秘密”的东西，对于奇怪的名字很抱歉，但变量名和值的长度匹配）

```
<%= link_to_remote "FOUR", :method => "get", :url => {:action => "testing01_four_log_info", :fourth_name => "LA1", :testing01_num => "123"} %> 
```

此代码生成：

```
new Ajax.Request('/traffic/testing01_four_log_info?testing01_num=123&fourth_name=LA1', {asynchronous:true, evalScripts:true, method:'get'}); 
```

问题是在 IE 和 Safari 以及 Chrome 和 Opera 中单击时，该链接有效并返回值。它不是来自 Firefox（版本 3.0.6）。事实上，Firebug 控制台似乎表明没有发送任何内容。但是，当我单击链接时，`:before`代码（我在`link_to_remote`上面的代码中省略了）确实会被执行。

那么，我做错了什么？

编辑：好的，所以在解决这个问题之后，它是 Firefox 的问题以及它如何处理代码。我可以直接从 Firefox 中请求 URL，它会起作用。所以它要么是 Firefox 的错误，要么是我的代码的错误。呸！:) 作为旁注，我以前遇到过这个问题。在那种情况下，虽然是因为 URL 太长，并且在那种情况下 Apache 不高兴。在这种情况下，是 Firefox 对某事不满意。

使用 Wireshark 进行调试表明没有任何东西通过网络。其他链接将通过电线，但不是这个。仅来自 Firefox。

编辑：解决。Adblock Plus 是罪魁祸首。为我的网站禁用它解决了这个问题。谢谢堆栈溢出！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T05:19:16.647

当真正奇怪的事情发生时，是时候仔细检查显而易见的事情了。

*   您在 Firefox 中启用了 JavaScript 吗？
*   你有没有安装 NoScript 或类似的东西？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T09:28:06.923

由于 Firefox 缓存 XHR 响应，我遇到了类似的问题。我必须在响应中添加正确的 HTTP 标头（C 代码正在生成响应）。有些仅适用于 IE，有些适用于 Firefox。但是您说缓存不是这里的情况。仔细检查一下。

其他可能的情况。浏览器限制与服务器的并发打开连接数。同时只有两种可能。因此，如果您与 Web 服务器有一些未关闭的连接，那么 Firefox 将等待它们完成并暂停您的 XHR 请求。

有时防病毒/本地防火墙程序可能会导致类似的问题。但是，当您的请求直接从地址栏加载时，这种情况不太可能发生。

如果一切都失败了，那么您只需逐行跟踪 Prototype lib 代码并查看您的请求在哪里被阻止。您确定 Ajax 代码按预期执行吗？

# sql - SQL 图像 -> 字节数组

> ID：529870
> 
> 赞同：0
> 
> 时间：2009-02-09T20:48:36.343
> 
> 标签：sql, image, etl

所以我正在导入一些存储在 SQL 图像列中的图像，我需要将它们更改为字节数组，因为我将图像存储为 varbinary(max) 并重新创建它们。如果有一个程序可以做到这一点，或者一个非常简单的方法，我会喜欢它，因为我没有很多时间。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T20:56:02.207

Sql Server 中的图像数据类型是 varbinary 字段，在未来版本中将不再使用。

我敢打赌，像[bcp](http://msdn.microsoft.com/en-us/library/ms162802.aspx)这样的工具会自动处理“转换”。我使用引号是因为它是类型转换而不是格式转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T20:58:04.683

您是否考虑过在 PowerShell 中编写快速脚本？它可以访问完整的 .NET 框架，因此如果您使用这些技术，应该会有点简单。

当然，如果您必须学习 PowerShell 才能编写脚本，这并不简单，但学习总是好的 :)

# c# - 有选择地填充数据集

> ID：529874
> 
> 赞同：0
> 
> 时间：2009-02-09T20:49:31.130
> 
> 标签：c#, database, .net-3.5

我需要根据一些标志更改从数据库中抓取的行。我怎样才能做到这一点？我当前的代码是这样的：

```
this.tblTenantTableAdapter.Fill(this.rentalEaseDataSet.tblTenant); 
```

假设我只想要 id 大于 50 的行，我该怎么做？

**编辑：**

访问数据库的代码是很久以前由原始程序员通过 VisualStudio 自动生成的。我不知道如何从自动生成的代码中获得连接。如果我能做到，我知道如何使用 SqlDataAdapter

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T20:53:43.260

为什么不在`WHERE`SQL 查询中使用子句？

另外，我希望你不要将你的`ID`领域用于这样的事情。如果您只需要前 50 个选项，则可能需要使用`TOP 50`子句或类似的东西。

有关如何使用 TableAdapter 执行此操作的一些信息：http: [//www.shiningstar.net/ASPNet_Articles/DataSet/DataSetProject7.aspx](http://www.shiningstar.net/ASPNet_Articles/DataSet/DataSetProject7.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T20:57:12.970

在服务器端，您可以使用格子旧 SQL：

```
SELECT * FROM TBLTENANT WHERE id > 50 
```

在客户端：

```
rentalEaseDataSet.tblTenant.DefaultView.RowFilter = "id > 50"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T20:55:31.023

我想最简单的方法是使用 WHERE 子句更改在幕后运行的任何 SQL 查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T20:59:16.897

您的 TableAdapter 需要将 CommandText 指定给带有 WHERE 子句的 SQL 查询。

```
 private void InitCommandCollection() {
        this._commandCollection = new global::System.Data.SqlClient.SqlCommand[1];
        this._commandCollection[0] = new global::System.Data.SqlClient.SqlCommand();
        this._commandCollection[0].Connection = this.Connection;
        this._commandCollection[0].CommandText = @"SELECT * FROM MyTable WHERE ID >50;";
        this._commandCollection[0].CommandType = global::System.Data.CommandType.Text;
    } 
```

**注意：** 上述查询只是一个示例，并不意味着作为解决方案查询。上述代码的格式用于编辑生成的 Table Adapter 设计器类的 InitCommandCollection() 方法，以便您可以指定自己的 SQL。您的班级可能已经在这里有一些 SQL，在这种情况下您可以更改它。

# c++ - C ++通过引用传递动态分配的二维数组

> ID：529875
> 
> 赞同：3
> 
> 时间：2009-02-09T20:49:35.513
> 
> 标签：c++, arrays, reference, multidimensional-array

这个问题建立在先前提出的问题之上： [Pass by reference multidimensional array with known size](https://stackoverflow.com/questions/529109/c-pass-by-reference-multidimensional-array-with-known-size)

我一直在试图弄清楚如何让我的函数与 2d 数组引用很好地配合使用。我的代码的简化版本是：

```
 unsigned int ** initialize_BMP_array(int height, int width)
    {
       unsigned int ** bmparray;
       bmparray = (unsigned int **)malloc(height * sizeof(unsigned int *));
       for (int i = 0; i < height; i++)
       {
        bmparray[i] = (unsigned int *)malloc(width * sizeof(unsigned int));
       }
      for(int i = 0; i < height; i++)
        for(int j = 0; j < width; j++)
        {
             bmparray[i][j] = 0;
        }
    return bmparray;
    } 
```

我不知道如何重写此函数，以便它可以在我通过引用将 bmparray 作为空的 unsigned int ** 传入的地方工作，以便我可以在一个函数中为数组分配空间，并设置值在另一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T21:03:11.410

```
typedef array_type unsigned int **;
initialize_BMP_array(array_type& bmparray, int height, int width) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T21:12:38.627

使用一个类来包装它，然后通过引用传递对象

```
class BMP_array
{
public:
    BMP_array(int height, int width)
    : buffer(NULL)
    {
       buffer = (unsigned int **)malloc(height * sizeof(unsigned int *));
       for (int i = 0; i < height; i++)
       {
        buffer[i] = (unsigned int *)malloc(width * sizeof(unsigned int));
       }

    }

    ~BMP_array()
    {
        // TODO: free() each buffer
    }

    unsigned int ** data()
    {
        return buffer;
    }

private:
// TODO: Hide or implement copy constructor and operator=
unsigned int ** buffer
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T21:09:00.570

嗯......也许我不太理解你的问题，但在 C 中你可以通过传递另一个指针间接级别来传递“通过引用”。也就是说，指向双指针 bmparray 本身的指针：

```
unsigned int ** initialize_BMP_array(int height, int width, unsigned int *** bmparray)
{
   /* Note the first asterisk */
   *bmparray = (unsigned int **)malloc(height * sizeof(unsigned int *));

   ...

   the rest is the same but with a level of indirection

   return *bmparray;
} 
```

所以 bmparray 的内存被保留在函数内部（然后，通过引用传递）。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T21:06:43.150

要使用更安全、更现代的 C++ 习惯用法，您应该使用向量而不是动态分配的数组。

```
void initialize_BMP_array(vector<vector<unsigned int> > &bmparray, int height, int width); 
```

# python - Django - 如何预填充管理表单字段

> ID：529890
> 
> 赞同：29
> 
> 时间：2009-02-09T20:52:34.430
> 
> 标签：python, django, django-admin, django-forms

我知道您可以根据其他字段预填充管理表单字段。例如，我有一个基于标题字段自动填充的 slug 字段。

但是，我还想根据日期进行其他自动预填充。例如，我有一个 URL 字段，我希望它自动设置为[http://example.com/20090209.mp3](http://example.com/20090209.mp3)，其中 20090209 是 YYYYMMDD。

我还希望有一个文本字段自动以“你好，我的名字是作者”之类的内容开头，其中作者是当前用户的姓名。当然，我也希望该人能够编辑该字段。关键是让用户可以更轻松地填写管理表单，而不仅仅是拥有完全自动的字段。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2010-06-04T10:47:17.813

我知道你可以通过 GET 预填充一些值，它会是这样的

```
http://localhost:8000/admin/app/model/add/?model_field=hello 
```

我在日期字段方面遇到了一些问题，但也许这可以帮助你。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-01-14T16:41:46.717

我最近为此使用了 Django 的[ModelAdmin.get_form](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.get_form)方法。

```
class MyModelAdmin(admin.ModelAdmin):
    def get_form(self, request, obj=None, **kwargs):
        form = super(MyModelAdmin, self).get_form(request, obj, **kwargs)
        form.base_fields['my_field_name'].initial = 'abcd'
        return form 
```

当您直接操作 base_fields 时，您应该小心副作用。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-10T11:53:41.170

Django 的内置 prepopulated_fields 功能被硬编码为 slugify，它不能真正用于更一般的目的。

您需要编写自己的 Javascript 函数来进行预填充。将其包含在管理页面中的最佳方法是将其包含在自定义 Form 或[Widget的](http://docs.djangoproject.com/en/dev/ref/forms/widgets/)[内部 Media 类](http://docs.djangoproject.com/en/dev/topics/forms/media/#topics-forms-media)中。然后，您需要自定义您的[ModelAdmin 子类](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#modeladmin-objects)以使用自定义表单或小部件。最后，您需要与每个预填充字段一起呈现一些内联 Javascript 以注册 onchange 处理程序并告诉它要从哪个其他字段填充；我将通过自定义小部件呈现它。为了使它更好和声明性，您可以使用自定义 ModelAdmin 属性（类似于 prepopulated_fields），并覆盖 ModelAdmin.formfield_for_dbfield 来创建小部件并传入有关它应该从哪个字段预填充的信息。

这种管理员黑客几乎总是可能的，但是（正如您从这个复杂的摘要中可以看出的那样）很少简单，特别是如果您正在努力保持您的代码很好地封装。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-09T23:05:45.577

您可以通过将其替换为您选择的表单字段来覆盖默认的 django 管理字段。

检查此项： [向管理员添加自定义验证](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#adding-custom-validation-to-the-admin)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-09T22:45:34.190

> 我还希望有一个自动以“你好，我的名字是作者”之类的开头的文本字段。

查看文档：[http ://docs.djangoproject.com/en/dev/ref/models/fields/#default](http://docs.djangoproject.com/en/dev/ref/models/fields/#default)

您可以在模型中使用 CharField() 或 TextField()，并设置此选项，这将设置默认文本。'default' 也可以是可调用函数。

类似于：models.CharField(max_length=250, default="Default Text")

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-06-13T21:16:55.637

我尝试了其中一些答案，但都没有奏效。我只是想用相关模型中的另一个字段来预置一个字段。以[这个](https://stackoverflow.com/a/14322706/6245268)答案为起点，我终于尝试直接操作模型实例对象（此处`obj`），它对我有用。

```
class MyModelAdmin(models.ModelAdmin):

    def get_form(self, request, obj=None, **kwargs):
        form = super(MyModelAdmin, self).get_form(request, obj, **kwargs)
        if not obj.some_model_field:
            obj.some_model_field = obj.related_model.prepopulating_model_field

        return form 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-09T21:52:27.313

蛞蝓处理是用javascript完成的。

因此，您必须[覆盖](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#templates-which-may-be-overridden-per-app-or-model)管理员中的模板，然后使用 javascript 填充字段。日期的事情应该是微不足道的，但我不知道你应该如何将登录的用户名添加到脚本中（不是我想得很辛苦，但你明白了：）。

# java - 春天与休眠

> ID：529904
> 
> 赞同：40
> 
> 时间：2009-02-09T20:55:26.857
> 
> 标签：java, hibernate, spring

只是想了解一下 Spring 并弄清楚如何在 xml 配置文件中连接 Oracle 连接，现在发现我还需要另一个框架！- Hibernate，这太令人沮丧了，因为感觉就像我越来越深入越来越多的框架而没有真正完成我需要做的事情！

我查看了 Hibernate，它似乎做了与 Spring 类似的事情，记住我只想在 Oracle 中做一些 SQL 插入。

我很不情愿，也没有时间学习 2 个框架——我可以只采用 Hibernate 来完成我需要做的简单事情吗？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-02-09T20:59:17.987

> *...我可以只采用 Hibernate 来完成我需要做的简单事情吗？*

是的

Hibernate 用于 ORM（对象关系映射），即使您的对象持久化到 RDBMS。

春天走得更远。它也可以用作 AOP、依赖注入器、Web 应用程序和 ORM 等。

所以如果你只需要 ORM，就用 Hibernate。当你需要 Spring 的时候会到，然后你就会学会它。

这是 Spring 的架构视图：

![春天](https://i.stack.imgur.com/YYMtA.gif)

这是休眠：

![休眠](https://i.stack.imgur.com/2xfaZ.png)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-09T21:00:39.623

Spring 和 Hibernate 是针对不同问题的完全不同的框架。Spring 是一个具有许多特性的庞大框架，Hibernate 是一个 O/R 桥梁。

我建议在您的情况下使用普通的旧 JDBC（“只是 Oracle 中的一些 SQL 插入”）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-09T21:02:03.487

您可以只使用 spring 和[spring-JDBC integration](http://static.springframework.org/spring/docs/2.5.x/reference/jdbc.html)。根据您的数据访问需求的复杂性，它可能绰绰有余。如果您要进行大量数据访问，spring[对象关系映射也值得研究。](http://static.springframework.org/spring/docs/2.5.x/reference/orm.html)

Spring 的好处在于它是一个非常松散耦合的框架。因此，您可以阅读您使用的位，而忘记其余部分 - 即使在运行时也是如此。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-09T21:01:53.177

Spring 和 Hibernate 真的打算做两件不同的事情。Spring 首先是一个控制反转的容器和配置子系统，而 Hibernate 是一个数据库绑定和延迟加载引擎。如果您不想在代码中引入一堆新东西，请坚持使用 Spring 并滚动您自己的查询或使用[iBatis](http://ibatis.apache.org/)进行更简单的数据库绑定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-09T14:28:27.380

如果您只想为 oracle 插入 sql，我会坚持使用简单的 JDBC 库。您所需要的只是一个 Connection 和一些 ConnectionPool（可能是 c3po）。Hibernate 等太大/太复杂，IMO 较差。Hibernate 在底层集成了 JDBC，但在所有可衡量的方面都较差——更难使用，而不是更快，而且您必须编写的查询或不会更容易。这也证明了它们的劣势，因为 HQL 还提供了绕过路由，因此您可以直接输入 JDBC 查询。他们提供了这个（我怀疑），因为对于任何复杂的查询，您根本无法在 HQL 中很好地构造它。

# visual-studio - Visual Studio 解决方案中推荐的项目数

> ID：529907
> 
> 赞同：19
> 
> 时间：2009-02-09T20:56:00.210
> 
> 标签：visual-studio, solution, project-files

我们开始开发新的应用程序，其中将包括由大约十几个开发人员在 MS Visual Studio 中使用 C# 开发的 30-50 个项目。

我正在对应用程序模块进行组件化，以支持架构并启用并行工作。

我们争论过：我们应该有多少解决方案？

有人声称我们应该有 1-2 个解决方案，每个解决方案有 15-30 个项目。有人声称我们需要每个组件一个解决方案，这意味着大约 10-12 个解决方案，每个解决方案大约 3-6 个项目。

我很高兴听到每个方向（或其他方向）的优缺点和经验

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-08T05:43:11.457

我从事过两种极端的产品：一种在单个解决方案中包含约 100 个项目，另一种包含超过 20 个解决方案，每个解决方案有 4-5 个项目（测试、业务层、API 等）。

每种方法都有其优点和缺点。

单个解决方案在进行更改时非常有用——它更容易处理依赖关系，并允许重构工具正常工作。但是，它确实会导致更长的加载时间和更长的构建时间。

多种解决方案可以帮助实施关注点分离，并保持较低的构建/加载时间，并且可能非常适合拥有多个关注范围更窄且定义明确的服务边界的团队。然而，在重构方面，它们确实有一个很大的缺点，因为许多引用是文件引用，而不是项目引用。

也许混合方法有空间在大多数情况下使用较小的解决方案，但在需要更大规模更改的时候创建一个包含所有项目的单一解决方案。当然，你必须维护两个单独的解决方案......

最后，您的项目结构和依赖关系将对您如何组织解决方案产生一些影响。

请记住，从长远来看，RAM 比程序员的时间便宜……

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-09T21:07:10.137

解决方案确实适用于依赖管理，因此如果不止一件事依赖于它，您可以在多个解决方案中拥有项目。解决方案的数量实际上应该取决于您的依赖关系图。

编辑：这意味着您不应该将不相互依赖的项目粘贴到同一个解决方案中，因为它会产生依赖的错觉，这意味着当两个项目真正独立时，有人可以创建真正的依赖。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-09T21:08:52.847

我已经研究了一个包含近 200 个项目的解决方案。如果您有足够的 RAM，这没什么大不了的 :)。

要记住的一件重要事情是项目相互依赖（无论是依赖项还是引用），它们可能应该在同一个解决方案中。否则，当不同的项目在不同的解决方案中有不同的依赖关系时，你会得到奇怪的行为。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-09T21:06:50.200

您想要维护项目引用。如果您可以安全地将解决方案拆分为两个或多个相互依赖的离散项目集，那么就去做吧。如果你不能，那么他们都属于一起。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-09T21:11:41.110

我们有一个包含大约 130 个项目的解决方案。大约 3 年前，当我们使用 vs.net 2003 时，这是一个可怕的问题。有时解决方案和 VSS 会崩溃。

但是现在有了 VS.NET 2005 就可以了。只有加载需要很多时间。我的一些同事正在卸载他们不使用的项目。这是加快速度的另一种选择。

将构建类型更改为发布是另一个问题。但是我们现在有 MSBuild 脚本。我们不再使用 VS.NET 的发布版本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-09T21:06:05.867

我认为你不应该夸大你的项目/解决方案的数量。组件化可以
**和将被**重用的东西，否则不要组件化！它只会使事情变得不那么透明并增加构建时间。也可以使用文件夹或使用逻辑类结构在项目中进行分区。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-12-13T10:19:33.107

我正在使用一个目前有 405 个项目的解决方案。在非常快的机器上，这是可行的，但仅限于当前的 Visual Studio 2017 或 2012。其他版本经常崩溃。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-03-02T17:10:54.850

在决定您需要多少项目和解决方案时，您需要考虑一些问题：

*   应用程序的逻辑层；
*   项目之间的依赖关系；
*   项目是如何建造的；
*   谁与什么项目合作；

目前我们有 70 个项目的 1 个解决方案。为了我们的持续集成，我们创建了 5 个 msbuild 项目，因此 CI 不会构建我们的开发解决方案。

以前，我们在单独的 git 存储库中有单独的表示（Web 和相关项目）层的解决方案。该解决方案被外包和自由 Web 开发人员使用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-09T21:01:15.410

我认为解决方案的实际数量并不重要。更重要的是你按照功能线分解事物。作为一个愚蠢的、人为的例子，如果你有一堆库可以处理与外部 Web 服务的互操作，那将是一个解决方案；一个带有它需要工作的 DLL 的 EXE 将是另一个。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-09T21:07:10.887

一个解决方案中有这么多项目的唯一问题是引用和构建顺序开始变得混乱。

作为一般规则，我倾向于减少项目的数量（使项目更加通用）并让开发人员共享这些项目的源代码控制，但通过子命名空间将这些项目中的功能分开。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-09T21:10:05.793

你应该有尽可能多的。没有硬性限制或最佳实践。练习并阅读什么是项目和解决方案，然后根据您的需求做出正确的工程决策。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-09T21:39:56.017

在其他答案中已经说过，但是可能值得再说一次。

项目依赖关系很好，因为如果依赖关系发生变化，它们可以重建依赖项目。

如果您执行程序集文件依赖项，VS 或 MSBuild 将无法知道需要构建一串项目。将会发生的是，在第一次构建时，将重新构建已更改的项目。如果您已将依赖项放在构建输出上，那么至少在第二次构建时，依赖该项目的项目将构建。但是你有未知数量的构建需要到达链的末端。

使用项目依赖项，它将为您解决所有问题。

所以说有尽可能多（或少）的答案，以确保使用项目依赖项。

如果您的团队被分解为具有更正式发布机制而不是签入源代码的功能区域，那么将其拆分为这些行将是可行的方法，否则依赖关系图是您的朋友。

# sql-server-2005 - 带有外语重音的 SQL 查询

> ID：529911
> 
> 赞同：2
> 
> 时间：2009-02-09T20:56:26.060
> 
> 标签：sql-server-2005, internationalization, diacritics

我有一个简单的专栏，里面填满了很多来自外语的单词，

我需要根据“英文”字母查询，

ie E, e, é, è等应返回查询“E”

所以当我查询“E”时，应该返回 école 作为数据库中存在的结果

我真的找不到谷歌的方法，所以非常感谢帮助。

我正在使用 MSSQL 2005。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T20:59:38.127

将排序规则更改[为不区分重音](http://msdn.microsoft.com/en-us/library/ms143515(SQL.90).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T21:04:09.020

选择对重音字符不敏感的排序规则

例子

```
create table bla(Col nvarchar(30))

insert bla values (N'E')
insert bla values (N'e')
insert bla values (N'é')
insert bla values (N'è')
insert bla values (N'f')
insert bla values (N'k')

select * from bla where Col = 'e'  --won't work

select * from bla where Col = 'e' collate Latin1_General_CI_AI_WS 
```

# python - 组织大型 Django 项目的指南

> ID：529921
> 
> 赞同：32
> 
> 时间：2009-02-09T20:58:23.030
> 
> 标签：python, django, projects

任何人都可以推荐一篇很好的指南/教程/文章，其中包含有关如何组织和划分大型 Django 项目的提示/指南？

当您需要开始分解初始唯一文件（models.py、urls.py、views.py）并使用几十个实体时，我正在寻找有关如何做的建议。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-09T22:30:57.783

每个“应用程序”都应该很小——一个可重用的实体加上几个关联的表。每个应用程序模型大约有 5 个加/减 2 个表。我们的大多数应用程序都小于 5 个表。一个模型中有零个表。

每个应用程序都应该被设计成一个可重用的概念。在我们的例子中，每个应用程序都是整个站点的一部分；应用程序可以单独删除和替换。

确实，这就是我们的策略。随着我们的需求扩展和成熟，我们可以相互独立地删除和替换应用程序。

可以让应用程序相互依赖。但是，依赖必须限于“模型”和“表单”等明显的东西。此外，应用程序可以依赖于彼此 URL 中的名称。因此，您的命名 URL 必须具有类似“应用程序视图”的形式，以便`reverse`函数或`{% url %}`标签可以正确找到它们。

`django-admin`每个应用程序都应该包含它自己的批处理命令（通常通过脚本可以找到的正式命令。

最后，任何比共享的简单模型或表单更复杂的东西可能不属于任何一个应用程序，但需要是一个单独的共享库。例如，我们使用[XLRD](http://www.lexicon.net/sjmachin/xlrd.htm)，但将它的一部分包装在我们自己的类中，因此它更像是内置`csv`模块。这个 XLRD 的包装器不是任何应用程序的适当部分，因为它是一个单独的模块，在 Django 应用程序之外。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-09T22:39:50.523

我发现查看大型开源 Django 项目并记下该项目的工作方式会很有帮助。Django 的站点有一个很好的开源项目列表：

[http://code.djangoproject.com/wiki/DjangoResources#Open-SourceDjangoprojects](http://code.djangoproject.com/wiki/DjangoResources#Open-SourceDjangoprojects)

谷歌也是如此（尽管其中大多数是较小的插件模板标签和中间件：

[http://code.google.com/hosting/search?q=label:django](http://code.google.com/hosting/search?q=label:django)

当然，仅仅因为一个项目以一种方式进行并不意味着这种方式就是正确的方式（或错误的方式）。其中一些项目比其他项目更成功。

最后，真正了解什么有效和无效的唯一方法是自己尝试。除非您自己尝试，否则世界上所有的提示和提示都不会有帮助，但它们可能会帮助您朝着正确的方向开始。

# c# - 无需更改值即可选择 Enum 类型的默认值

> ID：529929
> 
> 赞同：221
> 
> 时间：2009-02-09T20:59:20.280
> 
> 标签：c#, .net, enums

在 C# 中，是否可以使用属性装饰 Enum 类型或执行其他操作来指定默认值应该是什么，而无需更改值？无论出于何种原因，所需的数字都可能是一成不变的，并且仍然可以控制默认值会很方便。

```
enum Orientation
{
    None = -1,
    North = 0,
    East = 1,
    South = 2,
    West = 3
}

Orientation o; // Is 'North' by default. 
```

* * *

## 回答 #1

> 赞同：375
> 
> 时间：2009-02-09T21:01:29.027

an （实际上，任何值类型）的默认`enum`值是 0 ——即使这不是 that 的有效值`enum`。它不能改变。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2010-03-09T14:26:29.703

任何枚举的默认值都是零。因此，如果要将一个枚举数设置为默认值，则将该枚举数设置为零，并将所有其他枚举数设置为非零（如果有多个枚举数，则第一个值为 0 的枚举数将是该枚举的默认值值为零）。

```
enum Orientation
{
    None = 0, //default value since it has the value '0'
    North = 1,
    East = 2,
    South = 3,
    West = 4
}

Orientation o; // initialized to 'None' 
```

如果您的枚举数不需要显式值，那么只需确保第一个枚举数是您希望成为默认枚举数的那个，因为“默认情况下，第一个枚举数的值为 0，并且每个后续枚举数的值增加1." （[C# 参考](http://msdn.microsoft.com/en-us/library/sbbt4032.aspx)）

```
enum Orientation
{
    None, //default value since it is the first enumerator
    North,
    East,
    South,
    West
}

Orientation o; // initialized to 'None' 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2011-12-05T17:05:23.027

如果零不能作为正确的默认值，您可以使用组件模型为枚举定义解决方法：

```
[DefaultValue(None)]
public enum Orientation
{
     None = -1,
     North = 0,
     East = 1,
     South = 2,
     West = 3
 }

public static class Utilities
{
    public static TEnum GetDefaultValue<TEnum>() where TEnum : struct
    {
        Type t = typeof(TEnum);
        DefaultValueAttribute[] attributes = (DefaultValueAttribute[])t.GetCustomAttributes(typeof(DefaultValueAttribute), false);
        if (attributes != null &&
            attributes.Length > 0)
        {
            return (TEnum)attributes[0].Value;
        }
        else
        {
            return default(TEnum);
        }
    }
} 
```

然后你可以打电话：

```
Orientation o = Utilities.GetDefaultValue<Orientation>();
System.Diagnostics.Debug.Print(o.ToString()); 
```

注意：您需要在文件顶部包含以下行：

```
using System.ComponentModel; 
```

这不会更改枚举的实际 C# 语言默认值，但提供了一种指示（和获取）所需默认值的方法。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-02-09T21:04:25.947

枚举的默认值是任何等于零的枚举。我不相信这是可以通过属性或其他方式改变的。

（MSDN 说：“枚举 E 的默认值是表达式 (E)0 产生的值。”）

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-03-22T09:26:51.973

另一种可能有用的方法 - 使用某种“别名”。例如：

```
public enum Status
{
    New = 10,
    Old = 20,
    Actual = 30,

    // Use Status.Default to specify default status in your code. 
    Default = New 
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-10-15T02:16:56.570

你不能，但如果你愿意，你可以做一些伎俩。:)

```
 public struct Orientation
    {
        ...
        public static Orientation None = -1;
        public static Orientation North = 0;
        public static Orientation East = 1;
        public static Orientation South = 2;
        public static Orientation West = 3;
    } 
```

将此结构用作简单枚举。
默认情况下，您可以在其中创建 pa == Orientation.East （或您想要的任何值）
以使用技巧本身，您需要通过代码从 int 转换。
那里的实施：

```
 #region ConvertingToEnum
        private int val;
        static Dictionary<int, string> dict = null;

        public Orientation(int val)
        {
            this.val = val;
        }

        public static implicit operator Orientation(int value)
        {
            return new Orientation(value - 1);
        }

        public static bool operator ==(Orientation a, Orientation b)
        {
            return a.val == b.val;
        }

        public static bool operator !=(Orientation a, Orientation b)
        {
            return a.val != b.val;
        }

        public override string ToString()
        {
            if (dict == null)
                InitializeDict();
            if (dict.ContainsKey(val))
                return dict[val];
            return val.ToString();
        }

        private void InitializeDict()
        {
            dict = new Dictionary<int, string>();
            foreach (var fields in GetType().GetFields(BindingFlags.Public | BindingFlags.Static))
            {
                dict.Add(((Orientation)fields.GetValue(null)).val, fields.Name);
            }
        } 
        #endregion 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-10-15T00:34:52.510

实际上 an`enum`的默认`enum`值是其值为的第一个元素`0`。

例如：

```
public enum Animals
{
    Cat,
    Dog,
    Pony = 0,
}
//its value will actually be Cat not Pony unless you assign a non zero value to Cat.
Animals animal; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-12-03T13:31:58.740

`The default value of enum is the enummember equal to 0 or the first element(if value is not specified)`...但是我在项目中使用枚举时遇到了严重问题，并通过以下操作克服了...我的需求与班级水平有什么关系...

```
 class CDDtype
    {
        public int Id { get; set; }
        public DDType DDType { get; set; }

        public CDDtype()
        {
            DDType = DDType.None;
        }
    }    

    [DefaultValue(None)]
    public enum DDType
    {       
        None = -1,       
        ON = 0,       
        FC = 1,       
        NC = 2,       
        CC = 3
    } 
```

并得到预期的结果

```
 CDDtype d1= new CDDtype();
    CDDtype d2 = new CDDtype { Id = 50 };

    Console.Write(d1.DDType);//None
    Console.Write(d2.DDType);//None 
```

现在，如果值来自 DB 怎么办……在这种情况下，好的……在下面的函数中传递值，它会将值转换为枚举……下面的函数处理了各种场景，它是通用的……相信我是非常快 ..... ：）

```
 public static T ToEnum<T>(this object value)
    {
        //Checking value is null or DBNull
        if (!value.IsNull())
        {
            return (T)Enum.Parse(typeof(T), value.ToStringX());
        }

        //Returanable object
        object ValueToReturn = null;

        //First checking whether any 'DefaultValueAttribute' is present or not
        var DefaultAtt = (from a in typeof(T).CustomAttributes
                          where a.AttributeType == typeof(DefaultValueAttribute)
                          select a).FirstOrNull();

        //If DefaultAttributeValue is present
        if ((!DefaultAtt.IsNull()) && (DefaultAtt.ConstructorArguments.Count == 1))
        {
            ValueToReturn = DefaultAtt.ConstructorArguments[0].Value;
        }

        //If still no value found
        if (ValueToReturn.IsNull())
        {
            //Trying to get the very first property of that enum
            Array Values = Enum.GetValues(typeof(T));

            //getting very first member of this enum
            if (Values.Length > 0)
            {
                ValueToReturn = Values.GetValue(0);
            }
        }

        //If any result found
        if (!ValueToReturn.IsNull())
        {
            return (T)Enum.Parse(typeof(T), ValueToReturn.ToStringX());
        }

        return default(T);
    } 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-05-15T14:13:09.377

枚举类型的默认值为 0：

*   "*默认情况下，第一个枚举数的值为 0，随后每个枚举数的值都增加 1。* "

*   "*值类型枚举具有表达式 (E)0 产生的值，其中 E 是枚举标识符。* "

您可以在此处查看 C# 枚举的文档，并在[此处](http://msdn.microsoft.com/en-us/library/sbbt4032.aspx)查看 C# 默认值表的[文档](http://msdn.microsoft.com/en-us/library/83fhsxwc.aspx)。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-09-28T08:36:12.140

如果将默认枚举定义为具有最小值的枚举，则可以使用：

```
public enum MyEnum { His = -1, Hers = -2, Mine = -4, Theirs = -3 }

var firstEnum = ((MyEnum[])Enum.GetValues(typeof(MyEnum)))[0];

firstEnum == Mine. 
```

这并不假定枚举的值为零。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-01-09T11:20:09.253

```
enum Orientations
{
    None, North, East, South, West
}
private Orientations? _orientation { get; set; }

public Orientations? Orientation
{
    get
    {
        return _orientation ?? Orientations.None;
    }
    set
    {
        _orientation = value;
    }
} 
```

如果您将该属性设置为 null，将在获取时返回 Orientations.None。默认情况下，属性 _orientation 为 null。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-09-28T11:34:52.693

默认值是定义中的第一个。例如：

```
public enum MyEnum{His,Hers,Mine,Theirs}

Enum.GetValues(typeOf(MyEnum)).GetValue(0); 
```

这将返回`His`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-08-09T07:45:35.547

在这种情况下，不要依赖枚举值。让`None`作为`0`默认值。

```
// Remove all the values from the enum
enum Orientation
{
    None, // = 0 Putting None as the first enum value will make it the default
    North, // = 1
    East, // = 2
    South, // = 3
    West // = 4
} 
```

然后使用一种方法来获取[Magic Number](https://en.wikipedia.org/wiki/Magic_number_(programming))。您可以引入[扩展方法](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/extension-methods)并像这样使用它：

```
// Extension Methods are added by adding a using to the namespace
using ProjectName.Extensions;

Orientation.North.ToMagicNumber(); 
```

这是代码：

```
namespace ProjectName.Extensions
{
    public static class OrientationExtensions 
    {
        public static int ToMagicNumber(this Orientation orientation) => oritentation switch
        {
            case None  => -1,
            case North => 0,
            case East  => 1,
            case South => 2,
            case West  => 3,
            _          => throw new ArgumentOutOfRangeException(nameof(orientation), $"Not expected orientation value: {orientation}")
        };
    }
} 
```

* * *

## 回答 #14

> 赞同：-5
> 
> 时间：2011-07-22T16:38:28.053

```
[DefaultValue(None)]
public enum Orientation
{
    None = -1,
    North = 0,
    East = 1,
    South = 2,
    West = 3
} 
```

然后在代码中你可以使用

```
public Orientation GetDefaultOrientation()
{
   return default(Orientation);
} 
```

# sql - WITH CHECK ADD CONSTRAINT 后跟 CHECK CONSTRAINT 与 ADD CONSTRAINT

> ID：529941
> 
> 赞同：155
> 
> 时间：2009-02-09T21:02:11.693
> 
> 标签：sql, sql-server, tsql, check-constraints

我正在查看 SQL Server 2008 的 AdventureWorks 示例数据库，我在他们的创建脚本中看到他们倾向于使用以下内容：

```
ALTER TABLE [Production].[ProductCostHistory] WITH CHECK ADD 
CONSTRAINT [FK_ProductCostHistory_Product_ProductID] FOREIGN KEY([ProductID])
  REFERENCES [Production].[Product] ([ProductID])
GO 
```

紧随其后的是：

```
ALTER TABLE [Production].[ProductCostHistory] CHECK CONSTRAINT     
[FK_ProductCostHistory_Product_ProductID]
GO 
```

我在外键（如这里）、唯一约束和常规`CHECK`约束中看到了这一点；`DEFAULT`约束使用我更熟悉的常规格式，例如：

```
ALTER TABLE [Production].[ProductCostHistory] ADD  CONSTRAINT  
[DF_ProductCostHistory_ModifiedDate]  DEFAULT (getdate()) FOR [ModifiedDate]
GO 
```

第一种方式与第二种方式之间有什么区别（如果有的话）？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-02-09T22:21:48.023

第一个语法是多余的 -`WITH CHECK`新约束的默认设置，并且默认情况下也打开约束。

此语法是由 SQL 管理工作室在生成 sql 脚本时生成的——我假设它是某种额外的冗余，可能是为了确保即使更改了表的默认约束行为也启用了约束。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2012-09-13T16:54:38.170

为了演示这是如何工作的——

```
CREATE TABLE T1 (ID INT NOT NULL, SomeVal CHAR(1));
ALTER TABLE T1 ADD CONSTRAINT [PK_ID] PRIMARY KEY CLUSTERED (ID);

CREATE TABLE T2 (FKID INT, SomeOtherVal CHAR(2));

INSERT T1 (ID, SomeVal) SELECT 1, 'A';
INSERT T1 (ID, SomeVal) SELECT 2, 'B';

INSERT T2 (FKID, SomeOtherVal) SELECT 1, 'A1';
INSERT T2 (FKID, SomeOtherVal) SELECT 1, 'A2';
INSERT T2 (FKID, SomeOtherVal) SELECT 2, 'B1';
INSERT T2 (FKID, SomeOtherVal) SELECT 2, 'B2';
INSERT T2 (FKID, SomeOtherVal) SELECT 3, 'C1';  --orphan
INSERT T2 (FKID, SomeOtherVal) SELECT 3, 'C2';  --orphan

--Add the FK CONSTRAINT will fail because of existing orphaned records
ALTER TABLE T2 ADD CONSTRAINT FK_T2_T1 FOREIGN KEY (FKID) REFERENCES T1 (ID);   --fails

--Same as ADD above, but explicitly states the intent to CHECK the FK values before creating the CONSTRAINT
ALTER TABLE T2 WITH CHECK ADD CONSTRAINT FK_T2_T1 FOREIGN KEY (FKID) REFERENCES T1 (ID);    --fails

--Add the CONSTRAINT without checking existing values
ALTER TABLE T2 WITH NOCHECK ADD CONSTRAINT FK_T2_T1 FOREIGN KEY (FKID) REFERENCES T1 (ID);  --succeeds
ALTER TABLE T2 CHECK CONSTRAINT FK_T2_T1;   --succeeds since the CONSTRAINT is attributed as NOCHECK

--Attempt to enable CONSTRAINT fails due to orphans
ALTER TABLE T2 WITH CHECK CHECK CONSTRAINT FK_T2_T1;    --fails

--Remove orphans
DELETE FROM T2 WHERE FKID NOT IN (SELECT ID FROM T1);

--Enabling the CONSTRAINT succeeds
ALTER TABLE T2 WITH CHECK CHECK CONSTRAINT FK_T2_T1;    --succeeds; orphans removed

--Clean up
DROP TABLE T2;
DROP TABLE T1; 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-03-11T00:50:57.310

除了上述关于可信约束的优秀评论：

```
select * from sys.foreign_keys where is_not_trusted = 1 ;
select * from sys.check_constraints where is_not_trusted = 1 ; 
```

一个不受信任的约束，正如它的名字所暗示的那样，不能被信任来准确地表示当前表中数据的状态。但是，它可以但可以信任以检查将来添加和修改的数据。

此外，查询优化器会忽略不受信任的约束。

启用检查约束和外键约束的代码非常糟糕，“检查”一词具有三种含义。

```
ALTER TABLE [Production].[ProductCostHistory] 
WITH CHECK -- This means "Check the existing data in the table".
CHECK CONSTRAINT -- This means "enable the check or foreign key constraint".
[FK_ProductCostHistory_Product_ProductID] -- The name of the check or foreign key constraint, or "ALL". 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2010-08-31T08:26:21.740

`WITH NOCHECK`当表中的现有数据不符合定义的约束并且您不希望它与您正在实施的新约束发生冲突时，也可以使用它...

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-02-10T08:57:52.863

`WITH CHECK`确实是默认行为，但是最好将其包含在您的编码中。

替代行为当然是使用`WITH NOCHECK`，因此最好明确定义您的意图。这通常在您玩/修改/切换内联分区时使用。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-10-14T15:27:05.740

外键和检查约束具有可信或不可信的概念，以及启用和禁用的概念。`ALTER TABLE`有关完整详细信息，请参阅 MSDN 页面。

`WITH CHECK`是添加新外键和检查约束`WITH NOCHECK`的默认值，是重新启用禁用外键和检查约束的默认值。意识到差异很重要。

话虽如此，实用程序生成的任何明显冗余的语句都是为了安全和/或易于编码而存在的。不要担心他们。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-09-14T23:40:06.047

这是我编写的一些代码，用于帮助我们识别和纠正数据库中不受信任的约束。它生成代码来解决每个问题。

```
 ;WITH Untrusted (ConstraintType, ConstraintName, ConstraintTable, ParentTable, IsDisabled, IsNotForReplication, IsNotTrusted, RowIndex) AS
(
    SELECT 
        'Untrusted FOREIGN KEY' AS FKType
        , fk.name AS FKName
        , OBJECT_NAME( fk.parent_object_id) AS FKTableName
        , OBJECT_NAME( fk.referenced_object_id) AS PKTableName 
        , fk.is_disabled
        , fk.is_not_for_replication
        , fk.is_not_trusted
        , ROW_NUMBER() OVER (ORDER BY OBJECT_NAME( fk.parent_object_id), OBJECT_NAME( fk.referenced_object_id), fk.name) AS RowIndex
    FROM 
        sys.foreign_keys fk 
    WHERE 
        is_ms_shipped = 0 
        AND fk.is_not_trusted = 1       

    UNION ALL

    SELECT 
        'Untrusted CHECK' AS KType
        , cc.name AS CKName
        , OBJECT_NAME( cc.parent_object_id) AS CKTableName
        , NULL AS ParentTable
        , cc.is_disabled
        , cc.is_not_for_replication
        , cc.is_not_trusted
        , ROW_NUMBER() OVER (ORDER BY OBJECT_NAME( cc.parent_object_id), cc.name) AS RowIndex
    FROM 
        sys.check_constraints cc 
    WHERE 
        cc.is_ms_shipped = 0
        AND cc.is_not_trusted = 1

)
SELECT 
    u.ConstraintType
    , u.ConstraintName
    , u.ConstraintTable
    , u.ParentTable
    , u.IsDisabled
    , u.IsNotForReplication
    , u.IsNotTrusted
    , u.RowIndex
    , 'RAISERROR( ''Now CHECKing {%i of %i)--> %s ON TABLE %s'', 0, 1' 
        + ', ' + CAST( u.RowIndex AS VARCHAR(64))
        + ', ' + CAST( x.CommandCount AS VARCHAR(64))
        + ', ' + '''' + QUOTENAME( u.ConstraintName) + '''' 
        + ', ' + '''' + QUOTENAME( u.ConstraintTable) + '''' 
        + ') WITH NOWAIT;'
    + 'ALTER TABLE ' + QUOTENAME( u.ConstraintTable) + ' WITH CHECK CHECK CONSTRAINT ' + QUOTENAME( u.ConstraintName) + ';' AS FIX_SQL
FROM Untrusted u
CROSS APPLY (SELECT COUNT(*) AS CommandCount FROM Untrusted WHERE ConstraintType = u.ConstraintType) x
ORDER BY ConstraintType, ConstraintTable, ParentTable; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-09T14:37:02.620

我敢说，感觉它可能是一个 SSMS（反转逻辑）错误；因为第二个（现有/重新启用的约束）语句需要显式包含/使用“WITH CHECK”，而不是第一个（默认的新/“with-check”）。

我想知道他们是否刚刚将“WITH CHECK”子句的生成应用于错误的 SQL 语句/第一个 T-SQL 语句而不是第二个 - 假设他们试图默认使用检查两种情况 - 对于新约束或（重新启用）现有约束。

（对我来说似乎很有意义，因为禁用检查约束的时间越长，理论上损坏/检查约束无效的数据可能同时潜入的可能性增加。）

# c# - 检查对象是否不是类型（！=等效于“IS”） - C#

> ID：529944
> 
> 赞同：82
> 
> 时间：2009-02-09T21:04:04.467
> 
> 标签：c#, asp.net, .net-2.0

这工作得很好：

```
 protected void txtTest_Load(object sender, EventArgs e)
    {
        if (sender is TextBox) {...}

    } 
```

有没有办法检查发件人是否不是文本框，某种等同于“是”的！=？

请不要建议将逻辑移至 ELSE{} :)

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2009-02-09T21:06:06.147

这是一种方式：

```
if (!(sender is TextBox)) {...} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2020-11-25T08:44:28.460

C# 9 允许使用[not](https://devblogs.microsoft.com/dotnet/welcome-to-c-9-0/#logical-patterns)运算符。你可以使用

```
if (sender is not TextBox) {...} 
```

代替

```
if (!(sender is TextBox)) {...} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-09T21:09:01.943

难道你不能在`is`关键字之前做更详细的“旧”方式：

```
if (sender.GetType() != typeof(TextBox)) { // ... } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-07-27T17:56:55.107

两种众所周知的方法是：

1) 使用 IS 运算符：

```
if (!(sender is TextBox)) {...} 
```

2) 使用 AS 运算符（如果您还需要使用 textBox 实例，则很有用）：

```
var textBox = sender as TextBox;  
if (sender == null) {...} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2017-07-27T11:17:56.043

如果您使用继承，例如：

```
public class BaseClass
{}
public class Foo : BaseClass
{}
public class Bar : BaseClass
{} 
```

... 耐空

```
if (obj?.GetType().BaseType != typeof(Bar)) { // ... } 
```

或者

```
if (!(sender is Foo)) { //... } 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2016-04-28T09:39:59.880

试试这个。

```
var cont= textboxobject as Control;
if(cont.GetType().Name=="TextBox")
{
   MessageBox.show("textboxobject is a textbox");
} 
```

# c++ - 处理 WinAPI CreateFile 中的泄漏？

> ID：529946
> 
> 赞同：2
> 
> 时间：2009-02-09T21:04:05.840
> 
> 标签：c++, winapi, cd-burning

CreateFile 分配 2(!!) 个句柄，而 CloseHandle 在尝试获得对 cd-rom 设备的低级访问时仅关闭一个句柄。操作系统 Windows XP SP3，7 台测试计算机中有 5 台运行相同。

当尝试访问硬盘驱动器号时，CreateFiles 工作正常并且只分配一个句柄。

这是示例代码：

HANDLE m_driveHandle = CreateFileW("\\\\.\\E", GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
关闭句柄（m_driveHandle）；

可能的原因是什么，或者它只是一个微软的错误？

更新。驱动器名称没有剪切和粘贴。正确的字符串是 L"\\.\E:"。错误仍然存​​在。

**更新2。问题解决了！请参阅下面的我（欧米茄）的答案。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T06:40:27.467

您的示例代码中似乎存在一些错误。如果它实际上是从您的程序中复制和粘贴的，那么肯定会有其他事情发生。

首先，您使用 MBCS 字符串调用 Unicode 函数：第一个参数应该`L`以`_T()`.

其次，也许更重要的是，`"\\\\.\\E"`它不是一个有效的名称。您缺少一个尾随冒号：要打开一个卷，它需要是 形式`\\.\X:`，或者在您的情况下是`"\\\\.\\E:"`。

在修复了这两个错误之后（第一个阻止编译，第二个需要获取除`INVALID_HANDLE_VALUE`返回之外的任何内容），一切似乎都按预期工作。我用[GetProcessHandleCount](http://msdn.microsoft.com/en-us/library/ms683214(VS.85).aspx)来统计打开句柄的个数，前后都一样：

```
HANDLE m_driveHandle = NULL;
HANDLE m_process = GetCurrentProcess();
DWORD handleCount;
GetProcessHandleCount(m_process, &handleCount);
cout << "Currently held handles: " << handleCount << endl;

for (int i = 0; i < 10; ++i)    {
    m_driveHandle = CreateFileW(L"\\\\.\\E:",
        GENERIC_READ | GENERIC_WRITE,
        FILE_SHARE_READ | FILE_SHARE_WRITE,
        NULL,
        OPEN_EXISTING,
        FILE_ATTRIBUTE_NORMAL,
        NULL
    );
    if (INVALID_HANDLE_VALUE == m_driveHandle)  {
        cout << "Invalid handle" << endl;
    }   else    {
        CloseHandle(m_driveHandle);
    }

    GetProcessHandleCount(m_process, &handleCount);
    cout << "Currently held handles: " << handleCount << endl;
} 
```

注释掉 CloseHandle 调用会导致 handleCount 按预期增加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T16:46:14.210

问题出在卡巴斯基反病毒软件中。KAV 6.0 安装在所有测试机器上。删除软件后，需要清除注册表中 cd-driver 的 UpperFilters 和 LowerFilters：

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class{4D36E965-E325-11CE-BFC1-08002BE10318}

只有在此步骤处理停止泄漏之后。最新版本的软件卡巴斯基安全软件也可以在不泄漏的情况下工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T14:02:43.120

您是否尝试过 SysInternals 的“Handle”工具？它可以显示程序打开的每个句柄，而不仅仅是计数。因此，您将知道哪个句柄保持打开状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T01:08:54.563

Suggestion:
Put log begin at call CreateFileW, this confirm how many times it is executed;

# .htaccess - 将所有 .php 流量重定向到 .php5 文件

> ID：529949
> 
> 赞同：1
> 
> 时间：2009-02-09T21:04:28.023
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

我有一个在共享主机上安装了 MediaWiki 的个人网站。Apache 配置使用 PHP 4 处理所有 .php 请求，使用 PHP5 处理所有 .php5 请求。

出于兼容性原因，我需要能够使用 .php 扩展名，但 MediaWiki 仅在 PHP5 上可用。我尝试使用 mod_rewrite 引擎，但我坚持使用规则。

这是当前文件：

```
DirectoryIndex index.php5

RewriteEngine on

# This rewrites URIs in the form /pages/Article_Name to /index.php5?title=Article_Name.
RewriteCond %{REQUEST_URI} !^/pages/index.php5.*$ [NC]
    RewriteRule ^pages/?(.*)$ /index.php5?title=$1 [L]

# This is the broken rule
RewriteCond %{REQUEST_URI} ^index\.php(([^5])(.*))?$ [NC]   
    RewriteRule ^index\.php(([^5])(.*))?$ /index.php5?$1 [L] 
```

该规则的想法是“将所有内容从 index.php（不跟 '5'）重定向到 index.php5”。

任何的想法？

* * *

编辑：

```
SetEnv PHP_VER 5 
```

有效，但我仍然对为什么没有考虑该规则感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T22:03:51.217

```
RewriteEngine On
RewriteBase /
RewriteRule ^(.*)\.php $1.php5 [R=301,L]
RewriteRule ^(.*)\.php $1.php5 [L] 
```

我在以下[网站上](http://www.webforgers.net/mod-rewrite/basic-tutorials-lesson-3.php)发现这可能有用，如果您愿意，您可以使其更具体并删除全部内容以仅更改一定数量的 .php 文件。

您还可以使用 RewriteBase 条件对其进行自定义以仅适合某个目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T21:14:22.367

我会更改主机，您不必让 php 应用程序在扩展后声明其版本。PHP3 是贫民区，php5 是非常贫民窟和不好的做法。

当然，这可能是一种不好的做法，您很可能永远不会看到围绕 php5 文件扩展名命名约定构建的 OSS 应用程序。

我会在你领先时退出并跳槽到一个糟糕的主机上 - 不要尝试改变像 mediawiki 这样的应用程序的构建方式。我见过的同时具有 php4 和 php5 的主机允许您选择要为该域运行的安装 - 而不是用文件扩展名指定它。那是贫民区。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T21:07:28.700

试试这个

```
AddType x-mapp-php .php5 
```

可能是相反的方式，但尝试一下，我无法自动取款：S

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T23:16:07.300

该`REQUEST_URI`值始终以斜杠开头，但您的模式不是。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-02T19:02:33.707

这似乎对我有用：

AddType application/x-httpd-php5 .php

# c# - 如何在调试时将 Visual Studio 异常消息语言更改为英语

> ID：529951
> 
> 赞同：72
> 
> 时间：2009-02-09T21:04:54.917
> 
> 标签：c#, visual-studio-2005

我正在使用安装了 XP Dutch 版本的机器。Visual Studio 2005 以英文安装。在调试所有 .NET Framework 异常消息以荷兰语出现时，我遇到了烦人的问题，这使得它们真的毫无价值。我试图通过将控制面板中的区域设置设置为美国英语，然后重新安装 .NET Framework 2.0（英文版）来将其更改为英语，但显然这并没有解决问题。有人有想法吗？

* * *

我认为我的问题被误解了，我不想改变线程的当前文化。我遇到的问题是，当您正在调试和单步执行代码时，突然出现其中一个异常窗口，其中包含异常消息。此异常消息以荷兰语显示，我希望它显示为英语。我希望这可以澄清这个问题。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-02-09T22:27:34.127

我做了一些更多的研究，显然不可能将 CurrentUICulture 默认更改为与已安装操作系统的本机语言不同的语言。只有在代码本身中执行以下操作时才能更改它：

```
Thread.CurrentThread.CurrentUICulture = new CultureInfo("en-us"); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-03-30T08:44:49.240

**解决了 ！**

没有一行代码。

转到开始 > 配置面板 > 语言和区域 > 管理 > 非 unicode 程序的语言 > 将其设置为英语。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-09T21:09:50.333

这个问题已经在[这里](https://stackoverflow.com/questions/209133/c-exception-messages-in-english)讨论过了。基本上您可以将当前线程的[CurrentCulture](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentculture.aspx)更改为 en-US。

# background - 网站上不间断的背景音乐

> ID：529952
> 
> 赞同：6
> 
> 时间：2009-02-09T21:04:59.707
> 
> 标签：background, audio-player

我正在为一个乐队制作一个网站，我想知道在网站上播放背景音乐而不中断音乐流（即使是一瞬间）的最佳方式。

目前，我正在考虑使用框架，但这不应该是一个好的做法。请有人告诉我我该怎么做。我更喜欢使用 HTML 对网站进行编码，因为我还没有掌握 Flash 编码。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-09T21:13:36.317

This might sound controversial, but here's an idea: Don't play music on your website. Seriously, don't. I think everyone knows how incredibly annoying that is, and asking a group of software developers to help you out with that is going to be like asking a group of sheep the best way to make a lambskin coat.

If you really have to do it, frames would be the simplest way, so I'd do that. But you're not going to do it anyway, right?

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T21:14:37.203

I can think of four ways:

*   Frames, as you said.
*   Make your entire website in Flash and have only one page. You need to know Flash to be able to do this, which could make this difficult.
*   Pop-out your music player. This is probably the easiest approach, but the downside is this could be annoying, and a lot of web browsers these days would block it.
*   Use AJAX and dynamically load all your site content within one page, like Gmail. Users will need to have newer browsers, and this will take quite a bit of coding on both the client and the server side.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T21:10:30.003

防止音乐停止的唯一方法是不要让您的音乐组件所在的页面重新加载。不幸的是，目前唯一的方法是使用框架。

The only alternative is to develop the whole site in Flash or another technology that doesn't rely on changing pages as navigation.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-09T21:14:18.497

It wouldn't be pretty but you could do it using AJAX. Have the master page with the header/footer/navigation controls with a big empty content div, and instead of regular links you have calls to AJAX functions that return HTML to be injected in the content div.

I tend to agree with the others who recommend frames. It may be considered "bad practice", but so is playing background music in the first place.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T21:15:28.650

As was said, to do that you have to prevent your website from relaoding.

An option to achieve this might be to use asynchronous requests to modify your website content without reloading the whole page, that's basically what Ajax is about.

That being said, I sort of agree with Alex here : dont' play music.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-09T21:14:03.210

This may be a topic for another post, but why would you cosnider IFrames to be good practice? you could out the content you want to change into an IFrame and have your code running your music player ouside it. When you load a page it woul load on the IFrame. Just a thought...

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2009-02-09T21:09:22.207

您很可能需要闪光灯或窗口外的新窗口（弹出窗口）。

不要使用框架。曾经。

编辑：对于所有对此进行修改和评论的人，没有一个人给出了你应该使用框架的正当理由。

只是为了澄清我的立场，请阅读任何关于可用性、网络和框架的文章。

对于那些仍在学习的人（以及那些愚蠢地更新的老人）

框架打破了网络的统一模型。

框架会给搜索引擎机器人带来问题。

框架使 URL 停止工作。

框架打破书签。

框架使打印更加困难。

框架会损害可访问性。

框架增加了技术复杂性。

以及不使用框架的第一大理由......

用户讨厌他们！

[http://www.456bereastreet.com/archive/200411/who_framed_the_web_frames_and_usability/](http://www.456bereastreet.com/archive/200411/who_framed_the_web_frames_and_usability/)

真的有这么多人在 2009 年建议框架是一个有效的解决方案吗？多么令人失望。

# php - 我怎样才能结合这些正则表达式规则？

> ID：529965
> 
> 赞同：-1
> 
> 时间：2009-02-09T21:07:22.850
> 
> 标签：php, regex, twitter

我正在使用正则表达式使用以下 PHP 代码在 Twitter 流中检测@replies。

```
$text = preg_replace('!^@([A-Za-z0-9_]+)!', '<a href="http://twitter.com/$1" target="_blank">@$1</a>', $text);
$text = preg_replace('! @([A-Za-z0-9_]+)!', ' <a href="http://twitter.com/$1" target="_blank">@$1</a>', $text); 
```

我怎样才能最好地结合这两个规则而不会错误地将 email@domain.com 标记为回复？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T21:17:30.173

好的，再想一想，不标记任何@email 意味着前一个元素必须是“非单词”项目，因为可以包含在单词中的任何其他元素都可以被标记为电子邮件，所以它会导致：

```
!(^|\W)@([A-Za-z0-9_]+)! 
```

但是你必须使用 $2 而不是 $1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T21:45:24.303

由于`^`不必位于 RE 的开头，因此您可以使用分组并`|`组合这些 RE。

如果您不想重新插入捕获的空白，则必须使用“正向后视”：

```
$text = preg_replace('/(?<=^|\s)@(\w+)/',
    '<a href="http://twitter.com/$1" target="_blank">@$1</a>', $text); 
```

或“消极回顾”：

```
$text = preg_replace('/(?<!\S)@(\w+)/',
    '<a href="http://twitter.com/$1" target="_blank">@$1</a>', $text); 
```

...无论您发现哪个更容易理解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T21:15:45.063

这就是我将如何进行组合

```
$text = preg_replace('!(^| )@([A-Za-z0-9_]+)!', '$1<a href="http://twitter.com/$2" target="_blank">@$2</a>', $text); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-09T21:26:31.980

```
preg_replace('%(?<!\S)@([A-Za-z0-9_]+)%', '<a href="http://twitter.com/$1" target="_blank">@$1</a>', $text); 
```

`(?<!\S)`被松散地翻译为“没有前面的非空白字符”。有点双重否定，但也适用于字符串/行的开头。

这不会使用任何前面的字符，不会使用任何捕获组，并且不会匹配字符串，例如`"foo-@host.com"`，它是一个有效的电子邮件地址。

测试：

```
Input = 'foo bar baz-@qux.com bee @def goo@doo @woo'
Output = 'foo bar baz-@qux.com bee <a href="http://twitter.com/def" target="_blank">@def</a> goo@doo <a href="http://twitter.com/woo" target="_blank">@woo</a>' 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-09T21:36:12.487

```
$text = preg_replace('/(^|\W)@(\w+)/', '<a href="http://twitter.com/$2" target="_blank">@$2</a>', $text); 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-09T21:24:32.780

我认为您可以使用交替，：所以寻找字符串或空格的开头

```
'!(?:^|\s)@([A-Za-z0-9_]+)!' 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-02-09T21:28:53.987

胡，伙计们，不要推得太远......这里是：

```
!^\s*@([A-Za-z0-9_]+)! 
```

# visual-studio-2008 - 关联 xsd 中不匹配的列？

> ID：529969
> 
> 赞同：2
> 
> 时间：2009-02-09T21:08:23.677
> 
> 标签：visual-studio-2008, reporting-services, join, dataset

我正在使用 VS 2008 并尝试为 ms sql 报告服务创建数据集。我有两个要关联的表。一个有一个 int 类型的列，另一个是 shortint。VS给我一个错误

> Parent 和 Child 列没有类型匹配的列。

有什么办法可以超越这个吗？在旧的 sql 报告服务中，我可以只使用一个查询来解决这个问题。我无法更改任一列的类型。

TIA

**编辑**
乔纳森，感谢您的回复，但我无法触及表格的结构。这可能有很多原因。我系统中的一些表是来自旧系统的提要。我无法控制某些系统。这对任何一家大公司来说都是一个巨大的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-18T23:27:01.820

Are you certain the mismatch will never be a problem? What about rows in the `int` table with values > `2^15 (32,768)`? These could not be related to the `shortint`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T20:17:47.430

DataSet 中的 DataColumns`int`和DataColumns的 DataTypes 是什么？`shortint`

如果`int`列是，`System.Int32`那么您可以将`shortint`列更改为相同吗？

这应该允许使用两列建立关系。

# ruby-on-rails - ActionMailer 问题 - 发送 PDF 附件的正确语法是什么

> ID：529970
> 
> 赞同：3
> 
> 时间：2009-02-09T21:08:26.937
> 
> 标签：ruby-on-rails, actionmailer

使用包含一些 PDF 文件附件的 actionmailer 发送电子邮件的正确语法是什么？我正在使用带有 TLS 插件的 Gmail 用于 SMTP。这是我到目前为止所拥有的（并且也尝试过这种变化）：

```
**lead_mailer.rb:**

  def auto_response(lead)
    recipients  lead.email
    subject     "Information"
    body        :recipient => lead.first_name
    from        "me@mydomain.com"
    attachment  "application/pdf" do |a|
                a.body = File.read(RAILS_ROOT + "/public/files/Datasheet.pdf")
    end
    attachment  "application/pdf" do |a|
                a.body = File.read(RAILS_ROOT + "/public/files/OtherSheet.pdf")                
    end
  end

**lead_observer.rb:**

class LeadObserver < ActiveRecord::Observer
  def after_save(lead)
    mail = LeadMailer.create_auto_response(lead)
    LeadMailer.deliver(mail)
  end
end 
```

问题是它发送了附件，但它们显示为“无名”，即使在打开它们时它们显示正确。但是，电子邮件的正文根本不会出现。我确定我在做一些简单的、错误的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T21:48:40.083

好的，我离开了一会儿，然后回来再用谷歌搜索了一下，得到了答案！

从 API：

如果任何附件或部分已添加到电子邮件中，则不会执行隐式模板呈现。这意味着您必须手动将每个部分添加到电子邮件中，并将电子邮件的内容类型设置为 multipart/alternative。

对于主要的邮件方法，我切换了正文并添加了这个显式渲染。注意-我跳过了 multipart/alternative 并且它起作用了，很可能是因为我正在发送纯文本电子邮件。

```
part        :body => render_message('auto_response', :recipient => lead.first_name) 
```

对于附件命名问题，这就是我所做的：

```
attachment  "application/pdf" do |a|
                a.body = File.read(RAILS_ROOT + "/public/files/OtherSheet.pdf") 
                a.filename = "Othersheet.pdf"  
end 
```

# asp.net - ASP.net 应用程序无法连接到 sql server 2005 数据库

> ID：529971
> 
> 赞同：1
> 
> 时间：2009-02-09T21:08:32.163
> 
> 标签：asp.net, sql-server-2005, security, iis, account

这是场景：

IIS 6 和 SQL Server 2005 在同一台机器上：

我刚刚在 IIS 的主网站内创建了一个新应用程序。

根网站有自己的数据库。我刚刚在根站点下创建的应用程序也有自己的数据库。

根站点中的 ASP.net 页面使用受信任的安全性连接到其数据库。该网站在使用 Windows 网络服务帐户的默认应用程序池中运行。

我刚刚创建的新应用程序正在使用同一个应用程序池。

我将网络服务帐户添加到新应用程序的数据库用户并授予 db_owner，就像设置根站点的数据库一样。当我尝试运行我的新应用程序时，我收到此错误：

用户 '' 登录失败。用户未与受信任的 SQL Server 连接关联。

当我切换新应用程序的连接字符串以使用 sql server sa 帐户时，它可以工作。我不想使用 SA 帐户。

我无法弄清楚这一点！请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T22:10:23.310

默认情况下，IIS 将尝试使用需要被授予访问 SQL Server 的 ASPNET 帐户。我没有设置来描述这一点，但以下链接提供了几个解决方案：

[bytes.com/groups/net-asp/290050-setting-up-integrated-security-sql-server](http://bytes.com/groups/net-asp/290050-setting-up-integrated-security-sql-server)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T21:10:45.497

听起来数据库需要 SQL 身份验证而不是 Windows 身份验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T21:12:26.083

在这种情况下，您必须将登录作为用户添加到您要使用的数据库中并给予适当的权限

# c - 如果超时为 0，poll() 会做什么？

> ID：529975
> 
> 赞同：12
> 
> 时间：2009-02-09T21:09:01.787
> 
> 标签：c, linux, sockets, epoll

我正在查看`poll()` [**手册页**](http://man7.org/linux/man-pages/man2/poll.2.html)，它告诉我`poll()`为 timeout 参数传入正值和负值时的行为。它并没有告诉我如果 timeout 是 会发生什么`0`。**有任何想法吗？**

查看`epoll_wait()` [手册页](http://man7.org/linux/man-pages/man2/epoll_wait.2.html)，它告诉我超时值为 时`0`，即使没有可用的事件，它也会立即返回。假设它`poll()` **的行为方式相同是否安全？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T21:14:30.353

它将立即返回：

> 如果 timeout 大于零，它指定等待任何文件描述符准备好的最大间隔（以毫秒为单位）。如果超时为零，`poll()`则将返回而不阻塞。如果 timeout 的值为`-1`，则`poll`无限期地阻塞。

, 自`Mac OS X 10.5`;

> 等待轮询完成的最大间隔，以毫秒为单位。如果此值为 0，`poll()`将立即返回。如果此值为`INFTIM (-1)`，`poll()`将无限期阻塞，直到找到条件。

， 作为`OpenBSD 3.8`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T21:37:59.657

在我看来，等待超时意味着“有”超时。这样，我希望 poll() 实际上*检查*文件描述符，然后等待如果没有人准备好超时 0 毫秒（根本不等待）。*但*情况是，如果 fd 可用，它只会发出信号。

我还检查了 linux 源代码，据我所知，这是它的工作方式：首先计算“未来”等待点，然后检查文件描述符，然后如果没有可用的文件描述符，则等待指定的超时时间。

问候，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T21:12:07.443

从 Ubuntu 手册页：

> timeout 参数指定 poll() 将阻塞的时间上限，以毫秒为单位。在 timeout 中指定负值意味着无限超时。

因为 0 没有特殊情况，所以我假设 poll() 将阻塞 0 毫秒。

# java - Java 脚本的安全性（JRuby、Jython、Groovy、BeanShell 等）

> ID：529997
> 
> 赞同：11
> 
> 时间：2009-02-09T21:13:02.930
> 
> 标签：java, security, groovy, jruby, jython

我希望运行一些未经验证的脚本（用尚未确定的语言编写，但需要基于 Java，因此 JRuby、Groovy、Jython、BeanShell 等都是候选者）。我希望这些脚本能够做一些事情并限制做其他事情。

通常，我会使用 Java 的 SecurityManager 并完成它。这非常简单，让我可以限制文件和网络访问、关闭 JVM 的能力等。这对于我想要阻止的高级内容非常有效。

但是我想允许一些东西，但只能通过我提供的自定义 API/库。例如，我不想允许直接网络访问打开到 yahoo.com 的 URLConnection，但如果使用 MyURLConnection 完成，我可以。那就是 - 有一组我想要允许的方法/类，然后是我想要禁止的所有其他内容。

我不相信这种类型的安全可以用标准的 Java 安全模型来完成，但也许可以。我对脚本语言本身的性能或灵活性没有特定要求（脚本将是对我的 API 的简单程序调用，具有基本的循环/分支）。因此，即使是对每个反射调用进行安全检查的“大”开销对我来说也是可以的。

建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T21:29:24.157

免责声明：我不是 Java 安全 API 方面的专家，因此可能有更好的方法来做到这一点。

我为基于 Java 的开源企业 CMS的[Alfresco工作，我们实现了与您描述的类似的东西。](http://www.alfresco.com)我们希望允许编写脚本，但只向脚本引擎公开我们的 Java API 子集。

我们为 JavaScript 脚本选择了 Rhino Engine。它允许您控制哪些 API 向 JavaScript 公开，这允许我们选择哪些类可用，哪些不可用。根据我们的工程师的说法，开销约为 10% - 还不错。

除此之外，这也可能与您相关，在 Java 方面，我们使用 Acegi（现在的 Spring Security），并使用 AOP 对特定用户可以调用的方法进行基于角色的控制。这对于授权非常有效。因此，实际上，通过 JavaScript 访问我们应用程序的用户首先有一个受限的 API 可供他使用，然后可以根据授权进一步限制该 API。因此，您可以使用 AOP 技术进一步限制可以调用的方法，从而允许在其他脚本语言中公开它，例如 Groovy 等。我们也在添加这些，相信我们的底层 Java API 保护用户免受未经授权的访问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T22:16:23.403

您可以使用自定义类加载器，在委托给其父级之前执行链接到类的审核。

您可以创建自己的权限，检查安全敏感 API 中的权限，然后`AccessController.doPrivileged`在调用底层 API 时使用它来恢复适当的权限。

您需要确保脚本引擎本身是安全的。Sun JDK 中的 Rhino 版本应该没问题，但不能保证。显然，您需要确保脚本可用的所有内容都是安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-12T10:19:29.107

在 Groovy 中，您可以完全按照您提到的方式进行操作。其实很容易。您可以轻松地限制在受信任环境中运行的不受信任脚本的权限，允许使用您自己的 api，这反过来又可以做不受信任的事情。

[http://www.chrismoos.com/2010/03/24/groovy-scripts-and-jvm-security/](http://www.chrismoos.com/2010/03/24/groovy-scripts-and-jvm-security/)

# performance - 从虚拟 VMware 迁移到物理服务器会对性能产生什么影响？

> ID：529998
> 
> 赞同：0
> 
> 时间：2009-02-09T21:13:12.090
> 
> 标签：performance

我想知道用物理服务器替换虚拟 VMWare 对 Web 应用程序性能的影响和可能的优势/劣势是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T21:17:33.233

不幸的是，几乎没有足够的信息对此提供任何建议。

如果您在高端硬件设备上安装了一台 VMware ESX 服务器，那么将其转换为物理服务器只会给您带来最小的性能优势。

但是这里有很多变量，由于许多 VMware 配置原因，您的应用程序可能会比在物理机上运行得慢。通常，在生产环境中正确配置的 VMware 基础架构不会比具有相同分配资源的物理等效架构慢很多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T21:30:18.817

您需要查看性能受到影响的位置 - 您是否受 CPU、内存、驱动器、网络限制？在你开始提出这样的问题之前，你需要了解是什么让你放慢了速度。

如果您受 CPU 限制，那么您可以在主机箱之间移动客户端以平衡负载。如果您受内存限制，那么您可以增加分配给绑定客户端的 RAM。驱动器绑定 - 然后您需要整理您的 SAN 吞吐量。如果您受网络限制，则向主机添加额外的网卡并添加额外的虚拟网络以分散负载会有所帮助。

# vb.net - 何时使用 StringBuilder？

> ID：529999
> 
> 赞同：19
> 
> 时间：2009-02-09T21:13:17.407
> 
> 标签：vb.net, string, stringbuilder

> **可能重复：**
> [String vs StringBuilder](https://stackoverflow.com/questions/73883/string-vs-stringbuilder)

我刚刚重温了一些我用来学习 VB.NET 的书籍。我不确定我脑子里有这个，了解 StringBuilder 是如何/是什么。

使用指南是什么？如果要连接 2 个字符串或 50 个字符串，最好使用它吗？

或者当总字符串长度大于 128 个字符时？

或者，当您使用它来添加字符串时，您会看到性能优势吗？

在哪种情况下使用 StringBuilder 实例来构建 SQL 语句比使用更好`string.format("Select * from x where y = {0}",1)`？

声明另一个变量并包含名称空间对小字符串连接没有好处，这总是让我感到震惊，但我现在不确定。

抱歉，很多文档告诉您使用什么，而不是最好的。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-09T21:16:38.617

我有[一篇关于这个主题](http://pobox.com/~skeet/csharp/stringbuilder.html)的文章。总结（从页面底部复制）：

*   当你在一个非平凡的循环中连接时，一定要使用 StringBuilder - 特别是如果你不确定（在编译时）你将通过循环进行多少次迭代。例如，一次读取文件一个字符，使用 += 运算符构建一个字符串可能会导致性能自杀。
*   当您可以（可读）指定需要在一个语句中连接的所有内容时，请务必使用连接运算符。（如果您有一系列要连接的东西，请考虑显式调用 String.Concat - 或 String.Join 如果您需要分隔符。）
*   不要害怕将文字分成几个连接的位 - 结果是一样的。例如，您可以通过将长文字分成几行来提高可读性，而不会损害性能。
*   如果您需要连接的中间结果而不是提供下一次连接迭代，StringBuilder 不会帮助您。例如，如果您从名字和姓氏构建一个全名，然后在末尾添加第三条信息（可能是昵称），那么只有在您不这样做的情况下，您才会从使用 StringBuilder 中受益需要 (first name + last name) 字符串用于其他目的（就像我们在创建 Person 对象的示例中所做的那样）。
*   如果您只需要进行一些串联，并且您真的想在单独的语句中执行它们，那么您走哪条路并不重要。哪种方式更有效将取决于所涉及的字符串大小的连接数量以及它们连接的顺序。如果您真的认为那段代码是性能瓶颈，请以两种方式对其进行分析或基准测试。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-09T21:14:48.777

这是我的经验法则：

> `StringBuilder`最好在编译时不知道串联的确切数量时使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T21:19:24.150

[Coding Horror](http://en.wikipedia.org/wiki/Jeff_Atwood)有一篇关于这个问题的好文章*[，微优化剧院的悲惨悲剧](http://www.codinghorror.com/blog/archives/001218.html)*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T21:17:31.813

就我个人而言，当我要连接的字符串不止一两个时，我会使用 StringBuilder。我不确定是否会获得真正的性能影响，但我一直阅读并被告知，每次使用多个字符串进行常规连接时都会创建一个额外的字符串副本，而使用 StringBuilder 会保留一个复制，直到你调用`ToString()`它的最终方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T21:18:44.663

有人通过实验发现临界数是 6。连续超过 6 个串联，你应该使用 StringBuilder。不记得我在哪里找到的。

但是，请注意，如果您只是将其写成一行：

```
"qwert" + "yuiop" + "asdf" + "gh" + "jkl;" + "zxcv" + "bnm" + ",." 
```

这被转换为一个函数调用（我不知道如何在 VB.net 中编写它）

```
String.Concat("qwert", "yuiop", "asdf", "gh", "jkl;", "zxcv", "bnm", ",."); 
```

因此，如果您在一行上进行所有连接，那么请不要使用 StringBuilder，因为 String.Concat 将有效地一次性完成所有连接。仅当您在循环中执行它们或连续连接它们时。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T21:19:38.500

我的规则 - 当您在 For 或 Foreach 循环中添加字符串时，请使用 StringBuilder。***************