# StackOverflow 问答 10896000-10896999

# java - 延迟初始化启用 CardLayout？

> ID：10896002
> 
> 赞同：0
> 
> 时间：2012-06-05T10:53:24.360
> 
> 标签：java, swing, lazy-initialization, cardlayout

我有一堆面板放在`CardLayout`其中第 n^个面板取决于第 (n - 1)^个面板中引起的状态变化。由于使用`CardLayout`，您必须事先*初始化并*添加所有面板。因此，它使管理状态变得比必要更难。

Java 或某些第三方开源库是否提供了一种变体，`CardLayout`可以懒惰地初始化其组成面板，即它们在它们即将可见之前被初始化？

**编辑：**

也许我没有清楚地说明问题。让我再尝试一次。

我*需要*预先设置面板`CardLayout`，但我不希望它初始化它们，直到它们变得可见。这是必要的，以便将先前阶段的状态更改透明地传播到下一个阶段。

在我当前的代码中，我有：

```
cardsPanel.add(ReadMePanel.create(this), ReadMePanel.ID);
cardsPanel.add(LicencePanel.create(this), LicencePanel.ID);
cardsPanel.add(InstallationPathPanel.create(this), InstallationPathPanel.ID);
cardsPanel.add(
  ExtractionProgressPanel.create(
    this,
    new NormalizedPath(appContext.getParameter("zipFilePath")),
    new NormalizedPath(appContext.getInstallationDirectory().toString())
  ), 
  ExtractionProgressPanel.ID
); 
```

此处`InstallationPathPanel`允许用户选择与默认安装目录不同的安装目录。`ExtractionProgressPanel`应该将某个 zip 文件提取到此目录。如果`ExtractionProgressPanel`被延迟初始化，用户选择的路径将被传播到它，而无需我做任何额外的事情。

希望问题现在很清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:38:09.840

`CardLayout`你可以在调用方法之前初始化并添加面板到右边`show`，这样就没有问题了。

*编辑*

所以在你现在打电话的地方`CardLayout#show`，你可以先做一个`add`然后`show`

看起来您正在尝试创建一个向导，[以下文章](http://java.sun.com/developer/technicalArticles/GUI/swing/wizard/)可能是一个不错的起点

# .net - Intellisense 不起作用 - 无论是使用摘要标签

> ID：10896006
> 
> 赞同：0
> 
> 时间：2012-06-05T10:53:38.170
> 
> 标签：.net, visual-studio-2010, intellisense, summary

我不知道发生了什么事。。

我为 EntityFramework 上下文做了一个存储库通用模式接口，我的接口只包含 5 个方法。

-Query -Insert -Delete -Synchronize -Dispose

我在摘要部分编写了文档，但是当我使用这个类时，智能感知不显示任何信息，所以我尝试将摘要移动到一个接口，这个类实现了该接口，但也不起作用。

这是类和接口

```
 public interface IRepositorySource : IDisposable
{
    /// <summary>
    ///     Allow Queries with LINQ to Entities throught IQueryable interface
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <returns>Teste</returns>
    IQueryable<T> Query<T>() where T : class;

    /// <summary>
    ///     Insert the e object in specific table.
    ///     The inserted object is only on database after Synchronize was called.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="e"></param>
    void Insert<T>(T e) where T : class;

    /// <summary>
    ///     Delete the e object from specific table.
    ///     The deleted object is only removed from database after Synchronize was called.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="e"></param>
    void Delete<T>(T e) where T : class;

    /// <summary>
    ///     Synchronize the database with all pending operations.
    /// </summary>
    void Synchronize();

    /// <summary>
    ///     Free all managed resources such the connection and ObjectContext associated with the repository
    /// </summary>
    void Dispose();
}

/// <summary>
///     By inherit from this class, you get the Repository Patter to query the datasource.
/// </summary>
public class RepositoryBase : IRepositorySource, IDisposable
{
    readonly ObjectContext m_context;

    public RepositoryBase(ObjectContext context) 
    {
        if ( context == null )
            throw new ArgumentNullException("context");

        m_context = context;
    }

    ObjectSet<T> Table<T>() where T : class {

        //
        // As the entity framework creates the properties with the same name of the Type we want to access,
        // it is really easy to map those types to properties throught reflection
        // Get the property of the context with the name of the type.
        //

        return (ObjectSet<T>) m_context.GetType().GetProperty(typeof(T).Name).GetValue(m_context, null);
    }

    public IQueryable<T> Query<T>() where T : class {
        return Table<T>();
    }

    public void Insert<T>(T e) where T : class {
        Table<T>().AddObject(e);
    }

    public void Delete<T>(T e) where T : class {
        Table<T>().DeleteObject(e);
    }

    public void Synchronize() {
        m_context.SaveChanges();
    }

    public void Dispose() {
        m_context.Dispose();
    }
} 
```

你知道可能发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T10:04:22.573

我找到的解决方案是通过 Visual Studio，单击类库项目，属性，构建，检查 XML 文档文件。

# awk - 使用 awk 从多个文本文件中提取列

> ID：10896009
> 
> 赞同：0
> 
> 时间：2012-06-05T10:53:40.110
> 
> 标签：awk

我正在尝试根据 column2 的值提取 column1。只有当 column2 ≤30 且大于 5 时，我才想打印 column1 的值。

我还需要根据输出打印 column1 的值的总数。如何使用来自多个文本文件的 awk 执行此操作？

文本文件示例如下所示。

```
col1   col2  

aa     25
bb     4
cc     6
dd     23
aa     30 
```

输出将是

```
aa
cc
dd
aa

Total number of aa is 2
Total number of cc is 1
Total number of dd is 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:13:47.387

像这样让你开始的东西：

```
{ if ($2 <= 30 && $2 > 5) {
    print $1
    tot[$1] += 1 }
}
END {

  for (i in tot) {
    print "Total number of", i, "is", tot[i]
  }
} 
```

输出：

```
$ awk -f i.awk input
aa
cc
dd
aa
Total number of aa is 2
Total number of cc is 1
Total number of dd is 1 
```

# xamarin.ios - Monotouch - 设置 UISearchBar 的 TintColor

> ID：10896010
> 
> 赞同：1
> 
> 时间：2012-06-05T10:53:45.280
> 
> 标签：xamarin.ios, uisearchbar, uisearchdisplaycontroller

我正在使用 UISearchDisplayController 并尝试设置 UISearchBar 的 TintColor。问题是颜色不正确。在界面生成器中，设置 tint 属性后搜索栏的颜色是正确的，但是当应用程序运行时，搜索栏将是相同的颜色，只是浅了很多。例如，如果我在界面生成器中将 TintColor 设置为黑色，它在设计器中看起来是正确的，但是当我运行应用程序时，颜色会变成中等灰色。

我也尝试在下面的代码中设置它，但没有运气。

```
SearchDisplayController.SearchBar.TintColor = UIColor.Black; 
```

有任何想法吗？我对这个有点迷茫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T13:50:29.913

这似乎是 iOS 5/6 中的一个错误。当我将搜索栏连接到搜索显示控制器时发生在我身上，但不是其他情况。

我如何（奇怪地）修复它：

将分段控制器添加到您的视图中，将其色调更改为您想要的颜色。现在，您也将在搜索栏上获得正确的颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:29:46.160

我没有在 Xcode 中尝试过，但是从 API 角度来说， a和 a`UISearchBar`都有，而且它们并不相同。您所描述的（变灰）是正常的，在使用时使用应该会给您一个纯色。`BackgroundColor``TintColor``TintColor``BackgroundColor`

# android - 如何将服务器响应绑定到 sencha touch 2.0 中的标签？

> ID：10896015
> 
> 赞同：0
> 
> 时间：2012-06-05T10:54:17.070
> 
> 标签：android, xml-parsing, sencha-touch-2

在我的应用程序中，我声明了一个标签：-

```
 {
     xtype: 'label',
     id: 'errLabel',
     margin: '15 0 0 0'
 }, 
```

我想显示服务器对上述标签的响应，为此我编写了一个模型和一个商店。现在在我看来，我编写以下代码将服务器数据添加到标签：-

```
 if(!this.strStore)
 {
      this.strStore = Ext.create('AGNSMS.store.logStore');
      console.log("strStore created");
 }

                   this.strStore.getProxy().setExtraParam({'UserId' : 
                  'XXXXXXX','Password' : 'XXXXXXX'});

                   var str = Ext.getCmp('errLabel');

                   str.setHtml('{MY_MODEL_FIELD}'); 
```

我知道这不是一个正确的方法。点击登录按钮标签后显示 {MY_MODEL_FIELD} 而不是真实的服务器数据。所以请建议我显示服务器对标签的响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:26:08.680

您需要在为代理设置新参数后加载商店，所以我建议您使用该`load()`函数加载您的商店，然后在回调函数中设置标签的文本：

```
this.strStore.getProxy().setExtraParam({'UserId' : 'XXXXXXX','Password' : 'XXXXXXX'});
one2one.stores.MeetingStore.load({
  scope   : this,
  callback: function(records, operation, success) {
    Ext.getCmp('errLabel').setHtml('SOME_TEXT');
  }
}); 
```

希望这可以帮助

# c++ - 将 fstream 数据写入磁盘时如何检测致命错误？

> ID：10896018
> 
> 赞同：2
> 
> 时间：2012-06-05T10:54:18.363
> 
> 标签：c++, error-handling, fstream

从 C++ fstream 对象刷新数据后，检查是否发生致命错误的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T10:58:09.613

作为 ios 的衍生产品，fstream 提供了一种检查 i/o 操作错误的方法。您可以[rdstate](http://www.cplusplus.com/reference/iostream/ios/rdstate/)或者您可以在流上检查[良好](http://www.cplusplus.com/reference/iostream/ios/good/)以查找错误。

# php - Cookie 不会设置为让我保持登录状态。PHP

> ID：10896020
> 
> 赞同：1
> 
> 时间：2012-06-05T10:54:26.553
> 
> 标签：php, cookies, login

尝试添加“让我保持登录”。不完全确定我做错了什么，但是在选中“让我登录”时的初始登录时，这将运行：

```
$email_and_password = array($email_from_html, $pass_from_html);
setcookie("StayLoggedZod", $email_and_password, time()+3600*24*30); 
```

$email_from_html 和 $pass_from_html 是存储在数组中的用户电子邮件和密码，并存储在 cookie 中。

现在，当您离开后返回站点时，初始页面会执行以下操作：

```
if (isset($_COOKIE['StayLoggedZod'])) 
{
$email_and_password = $_COOKIE['StayLoggedZod'];
$stored_email = $email_and_password[0];
$stored_password = $email_and_password[1];
//USES THE E-MAIL AND PASS STORED IN HERE TO LOG INTO WEBSITE VIA MySQL DB, I EXCLUDED THIS CODE BECAUSE I KNOW THIS PART WORKS.
}
else
{
header("location:login.php");
} 
```

它没有返回错误，我无法让它工作，所以我做了一个这样的快速测试页面：

```
$cookie_data = $_COOKIE['StayLoggedZod'];
$the_email = $cookie_data[0];
$the_pass = $cookie_data[1];
$display_string = "This is my email".$the_email.". This is my password".$the_pass;
echo $display_string; 
```

除了“这是我的电子邮件”等之外，没有显示任何数据。

这是我第一次保持登录状态，不知道我错过了什么，希望我的解释是彻底的。-麦克风

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T10:57:24.627

1) 您不应将密码等敏感信息存储在 cookie 中。Cookies 存储在客户端，可编辑和可见

2) 检查 setcookie [http://php.net/setcookie的手册页](http://php.net/setcookie)

您将看到第二个参数（您要存储的值）应该是一个字符串（因此，如果您要存储数组，请考虑一种将它们存储为字符串的方法，例如序列化或 json 编码）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T10:58:20.617

尝试这个：

```
setcookie("StayLoggedZod", serialize($email_and_password), time()+3600*24*30); 
```

并调用：

```
$email_and_password = unserialize($_COOKIE['StayLoggedZod']); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:11:46.840

持久登录 cookie 的第一条规则是：不要**将**密码存储在 cookie 中！

相反，使用用户名和随机令牌（从适当的大空间）生成一个 cookie，将此随机令牌存储在用户表中。

当 cookie 出现时，会查找用户名和令牌组合：

*   如果组合匹配，则用户已登录；生成并保存新令牌，更新 cookie
*   如果组合不匹配，则忽略 cookie

当用户会话因“记住我”cookie 而启动时，您应该在他们访问敏感信息（例如个人身份数据）时提示输入密码。

[此处](http://jaspan.com/improved_persistent_login_cookie_best_practice)概述了处理受损 cookie 的此过程的改进。

# iphone - iPhone 应用程序用户界面受到 ON CALL 通知的影响

> ID：10896023
> 
> 赞同：0
> 
> 时间：2012-06-05T10:54:40.640
> 
> 标签：iphone, ios, user-interface, push, localnotification

我正在开发 iPhone 应用程序，当我的设备上有呼叫时，我的应用程序用户界面会受到影响。

即通过参加通话，我也在使用我的应用程序，当时绿色框中的通话通知出现在屏幕顶部。

当此通知到来时，我的应用程序 UI 会以像素为单位受到影响。

如何克服这个问题？

问候， 巴鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:02:15.413

您可以在 UIView 类中使用 autoresizing 属性，并通过在模拟器上切换通话状态栏进行测试。

# node.js - 会话未存储在 Express for Node.js 中

> ID：10896025
> 
> 赞同：3
> 
> 时间：2012-06-05T10:54:45.370
> 
> 标签：node.js, express

我有以下路线，基本上从登录表单对帖子起作用。问题是当登录成功时（找到成员并且密码匹配），成员._id 没有存储在会话中。

我的路线：

```
app.post('/signin', function(req, res) {
    Member.findOne({username: req.body.username}, function(error, member) {
        var matchPassword = crypto.createHmac('sha1', member.salt).update(req.body.password).digest('hex');
        if(member.password == matchPassword) {
            req.session.member_id = member._id;
            res.redirect('/' + member.username);
        }
    });
    res.redirect('/');
}); 
```

触发此路由时，我在控制台中收到以下错误：

```
node.js:134
        throw e; // process.nextTick error, or 'error' event on first tick
        ^
Error: Can't set headers after they are sent.
    at ServerResponse.<anonymous> (http.js:527:11)
    at ServerResponse.setHeader (/Users/admin/Node Projects/sandboxProject/node_modules/express/node_modules/connect/lib/patch.js:62:20)
    at ServerResponse.header (/Users/admin/Node Projects/sandboxProject/node_modules/express/lib/response.js:280:8)
    at ServerResponse.redirect (/Users/admin/Node Projects/sandboxProject/node_modules/express/lib/response.js:413:10)
    at Promise.<anonymous> (/Users/admin/Node Projects/sandboxProject/app.js:109:8)
    at Promise.<anonymous> (/Users/admin/Node Projects/sandboxProject/node_modules/mongoose/lib/promise.js:120:8)
    at Promise.<anonymous> (events.js:64:17)
    at Promise.emit (/Users/admin/Node Projects/sandboxProject/node_modules/mongoose/lib/promise.js:59:38)
    at Promise.complete (/Users/admin/Node Projects/sandboxProject/node_modules/mongoose/lib/promise.js:70:20)
    at /Users/admin/Node Projects/sandboxProject/node_modules/mongoose/lib/query.js:1087:15 
```

它似乎不喜欢“res.redirect('/' + member.username);” 在“req.session.member_id = member._id;”之后。这是因为它所在的 Mongoose findOne 回调的异步特性吗？我尝试从回调中删除 res.redirect，但会话数据没有存储，当我把它留在那里时，我得到“标头已发送”错误。

我的配置：

```
app.configure(function(){
    app.set('views', __dirname + '/views');
    app.set('view engine', 'jade');
    app.use(express.cookieParser());
    app.use(express.session({ secret: "blahblah" }));
    app.use(express.bodyParser());
    app.use(express.methodOverride());
    app.use(app.router);
    app.use(express.static(__dirname + '/public'));
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T15:47:43.120

我有一个类似的问题。虽然我的问题是当我从会话中删除某些内容时，例如`delete req.session.user`，在重新加载和节点应用程序重新启动后它仍然存在。它只会在之后消失`req.session.destroy()`。

我查看了 Node 的会话[中间件文档](http://www.senchalabs.org/connect/middleware-session.html)，发现他们有一个`Session#save()`方法。所以我`req.session.save()`在会话对象操作之后做了，它确实解决了我的问题。试试看它是否能解决你的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T13:26:55.397

问题是这`Member.findOne`是异步的。到它的回调执行时，`res.redirect('/')`已经执行，它设置了适当的 HTTP 响应标头。您不能通过 HTTP 规则发送两次标头，因此会出现错误`Can't set headers after they are sent.`

您可能希望将 移至`redirect('/')`密码匹配的 else 块中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-21T03:02:07.920

我有一个类似的问题。但我当时的问题是：

request.session.user = 用户；

我通过debug发现，注释掉这一行的时候，没有出现这个错误：</p>

// request.session.user = 用户；

这是我的问题： [express 4.x session-mongoose Can't set headers after they are sent（已解决）](https://stackoverflow.com/questions/28058845/express-4-x-session-mongoose-cant-set-headers-after-they-are-sent)

# install4j - 在 Win 中在 64 位 JRE 上运行 install4j

> ID：10896026
> 
> 赞同：1
> 
> 时间：2012-06-05T10:54:49.073
> 
> 标签：install4j

当用户安装了 32 位或 64 位 JRE 时，是否可以通过 Install4J 创建一个可以在两种情况下运行的 Windows 媒体文件？

我有一个案例，我正在包装一个不需要 64 位操作系统功能的应用程序。所以我选择了一个 32bit (Install4J) 的可执行文件来生成。最终，当我们尝试在安装**了 64 位 JRE 的 64 位 Win7 上**安装时遇到了问题。安装程序抱怨缺少 32 位 JRE。

在 Install4J 的帮助指南中，我发现了以下内容：

> 在 Windows 上，本机可执行文件可以是 32 位或 64 位可执行文件。如果您的应用程序需要 64 位 JRE，您可以选择为媒体文件生成 64 位安装程序和启动程序。**请注意，无法创建同时使用 64 位和 32 位 JRE 的启动器**。由于启动器通过加载 JVM DLL 以 JNI 接口启动 JVM，因此架构必须相同。如果您同时针对 32 位和 64 位 JRE 和操作系统，则必须为它们生成不同的媒体文件。

当您确实需要特定的 64 位功能时，我希望粗体字指的是那些情况。

有什么帮助吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:40:03.803

不幸的是，目前这是不可能的。我建议使用 32 位 JRE 包。这适用于 32 位 Windows 和 64 位 Windows。已安装的 64 位 JRE 的情况可能并不那么重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T13:42:41.143

我设法找到了实际上是“黑客”的解决方案。

这个想法是将适当的 32 位 Java 打包为捆绑包，并指示 Install4J 不要使用用户的 Java 并且不要依赖它。作为输出，Install4J 将在安装应用程序本身的同一级别上创建“jre”文件夹。通过这样做，当用户没有在机器上安装 JRE 时，甚至可以同时运行安装程序和应用程序。

我创建此类 Install4J 配置的方式如下：

*   打开“Media”，然后打开“Windows”（如果您想为 Unix 或 Mac 捆绑 JRE，也可以打开任何其他）
*   选择“捆绑的 JRE”
*   选中“捆绑以下 JRE”，然后找到所需的 Java 版本
*   取消选中“安装为共享 JRE”和“仅在没有找到其他合适的 JRE 时安装”（这会将 JRE 放置在您安装应用程序的文件夹中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-31T13:19:41.187

较新版本的 install4j在媒体文件中有一个*32 / 64 位开关。*我认为从 install4j 4 开始。

您仍然需要在目标环境中有一个匹配的 JRE，或者在您编写捆绑它时。如果安装程序大小不是问题，捆绑是更安全的方式。

# c# - asp.net ListView SelectedIndex 事件

> ID：10896030
> 
> 赞同：0
> 
> 时间：2012-06-05T10:54:52.653
> 
> 标签：c#, events, listview, webforms

我有一个列表视图，我需要根据 OnSelectedIndexChanged 执行某些操作，这很好。

但现在我收到关于未定义的 OnSelectedIndexChanging 的错误。我不需要那个。奇怪的是，前几天它没有给出那个错误，而今天它给出了。即使我不使用它，我是否需要定义它？我宁愿不这样做，因为如果它只是在没有代码的情况下刷新页面（这意味着您必须按两次列表视图上的选择链接）

我还收到“未处理的引发事件 ItemDeleting”。当我单击前几天没有得到的删除链接时出错。

什么可能导致上述2个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-17T11:28:35.293

如果在 codebehind 将 listview 绑定到数据源，则必须在 SelectedIndexChanging 事件中编写一些代码。

所以代码将是：

```
 protected void ListView1_SelectedIndexChanging(object sender, ListViewSelectEventArgs e)
    {
        this.ListView1.SelectedIndex = e.NewSelectedIndex;
        //bind listview again here !
    } 
```

```
 onselectedindexchanging="ListView1_SelectedIndexChanging"> 
```

我希望这能解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:00:06.743

我认为你`OnSelectedIndexChanging`从`aspx.cs`页面中删除，但你不应该从你的页面中删除这个事件。`.aspx`所以它尝试调用和愤怒错误。同样的情况`ItemDeleting`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T06:48:21.373

问题是我手动绑定数据源，而不是在启动时。一旦我在启动时初始化数据源和列表视图，上述错误就消失了。

# css - 在固定大小的元素中垂直居中图像：在顶部偏移

> ID：10896031
> 
> 赞同：0
> 
> 时间：2012-06-05T10:54:56.740
> 
> 标签：css

我想在固定大小的方形容器中显示缩略图，水平和垂直居中缩略图。

使用`height`,`line-height`和`vertical-align`CSS 属性，我几乎可以实现它，但是顶部有一个小偏移（`2px`在我的示例中），**我想了解原因**。

作为一种解决方法，我可以为图像设置一个负的上边距，但如果可能的话，我想避免它（更容易跨越浏览器？）。我也很惊讶我需要一个`-4px`上边距来抵消`2px`偏移量。

有什么提示吗？

小提琴：http: [//jsfiddle.net/GlauberRocha/N6Rme/](http://jsfiddle.net/GlauberRocha/N6Rme/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:01:08.623

嘿，我想你想要这个

像这样在**ul**和**li**中删除`margin -minus`并添加**边框**

 ****现场演示[http://jsfiddle.net/N6Rme/5/](http://jsfiddle.net/N6Rme/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:02:48.830

我在你的标记中没有发现任何错误，我认为这是一些奇怪的排版和 css 问题，这就是为什么我建议你尝试一种新的垂直居中技术，这对你**有用**。

### [dabblet.com 上的](http://dabblet.com/gist/2874392)在线演示

![在此处输入图像描述](../Images/feda5525548b63f1b4d808f5e210a14d.png)

### 添加到CSS：

```
li {
    /* … */
    position: relative;
}

li img {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    margin: auto;
} 
```

这个演示的主要技巧是在元素的正常流动中从上到下，所以 margin-top: auto 设置为零。但是，对于绝对定位的元素，其自由空间分布相同，并且类似地可以在指定的顶部和底部垂直居中（不适用于`IE7`）。

这个技巧适用于任何大小的`img`.****

# java - DailyRollingFileAppender 可以在午夜而不是在下一条消息时滚动日志吗？

> ID：10896035
> 
> 赞同：0
> 
> 时间：2012-06-05T10:55:19.777
> 
> 标签：java, logging, log4j

我正在使用 log4j 进行日志记录。我有一个基于码头的模块。我需要每日记录，所以我使用了 DailyRollingFileAppender。问题是我需要日志文件在上午 12:00 滚动，目前它会在滚动之前等待新请求，有没有办法“强制”滚动过程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:08:58.933

我对此表示怀疑。日志服务将不得不产生一个等待一整天或依赖于某种计时器服务的线程。记录器非常努力地不产生依赖关系或消耗资源。您的应用程序可以每天记录一条消息以触发翻转吗？您确定要在几天内没有消息的零长度日志文件吗？否则，您可能需要子类化 appender。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-02T05:03:00.287

假设您指的是 Jetty 自己的日志，而不是您的 webapp 的日志：您可以使用`jetty.logs`系统属性覆盖基本​​日志目录。

根据您启动 Jetty 的方式，它可能就像将属性添加到命令行一样简单。例如：

```
java -jar -Djetty.logs=/var/log/search-service/jetty.system.log start.jar 
```

或者您可以使用 log4j.xml 文件，如下所示：

```
<appender name="file" class="org.apache.log4j.RollingFileAppender">
    <param name="append" value="true" />
    <param name="maxFileSize" value="10MB" />
    <param name="maxBackupIndex" value="10" />
    <rollingPolicy class="org.apache.log4j.rolling.TimeBasedRollingPolicy">
      <param name="fileNamePattern" value="${jetty.base}/logs/EZDataModeler_%d{yyyy-MM-dd}.log" />
    </rollingPolicy>
    <param name="file" value="${jetty.base}/logs/EZDataModeler_%d.log" />
    <param name="datePattern" value="'-'yyyy-MM-dd'.log'" />
    <layout class="org.apache.log4j.PatternLayout">
        <param name="ConversionPattern" 
          value="%d{yyyy-MMM-dd HH:mm:ss,SSS} [%t] %c %x%n  %-5p %m%n"/>
    </layout>
  </appender> 
```

# c# - C#从套接字到Windows中的邮件槽

> ID：10896037
> 
> 赞同：0
> 
> 时间：2012-06-05T10:55:32.497
> 
> 标签：c#, .net, winforms, visual-studio-2010, msdn

在此示例中，我必须做什么才能将此代码从套接字应用程序重写为邮槽互通：

```
// Server:

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net.Sockets;
using System.Net;

// Server

namespace OS
{
    public partial class Server : Form
    {
        Socket servsoc;
        byte[] buf = new byte[1024];
        public Server()
        {
            InitializeComponent();
        }

        private void Start_Click(object sender, EventArgs e)
        {
            servsoc.Receive(buf);
            Out1.Text = Encoding.ASCII.GetString(buf);
            Array.Clear(buf, 0, buf.Length);
        }

        private void Server_Load(object sender, EventArgs e)
        {
            CreateSocket(ref servsoc);
        }

        private void Server_Leave(object sender, EventArgs e)
        {
            servsoc.Close();
        }
    }
}

Client1:

using System.Windows.Input;
using System.Net.Sockets;
using System.Net;

namespace Client1
{
    public partial class Client1 : Form
    {
        Socket send;
        EndPoint endtarget;
        public Client1()
        {
            InitializeComponent();
        }

        private void Exit_Click(object sender, EventArgs e)
        {
            Application.Exit();
            send.Close();
        }

        private void Client1_Load(object sender, EventArgs e)
        {
            Out3.Text = InputLanguage.CurrentInputLanguage.Culture.EnglishName;
            Out1.Text = Convert.ToString(SystemColors.ActiveBorder.R)+ " " + Convert.ToString(
 SystemColors.ActiveBorder.G) + " " + Convert.ToString( SystemColors.ActiveBorder.B);
             Out2.Text = Convert.ToString(SystemColors.Desktop.R) + " " + Convert.ToString(SystemColors.Desktop.G) + " " + Convert.ToString(SystemColors.Desktop.B);
             CreateSocket(ref send, ref endtarget);
        }

        private void Send1_Click(object sender, EventArgs e)
        {
            send.SendTo(Encoding.ASCII.GetBytes(Out1.Text), endtarget);
        }

        private void Send2_Click(object sender, EventArgs e)
        {
            send.SendTo(Encoding.ASCII.GetBytes(Out2.Text), endtarget);
        }

        private void Send3_Click(object sender, EventArgs e)
        {
            send.SendTo(Encoding.ASCII.GetBytes(Out3.Text), endtarget);
        }
    }
} 
```

# cocos2d-iphone - 物体在加速度计中移动

> ID：10896039
> 
> 赞同：0
> 
> 时间：2012-06-05T10:55:38.133
> 
> 标签：cocos2d-iphone, accelerometer, ccsprite, acceleration

我想在 cocos2d 中创建一个游戏，其中一个对象正在运行。

我想根据设备加速度计左右移动这个对象。我正在获取加速度计的值并更新对象的位置。甚至我可以在 LOG 中看到新位置。但物体并没有从它的位置上移动。这是我在应用程序中编写的代码。

> ```
> - (void) accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration1 {
> 
> acceleration = acceleration1;
> CGPoint position = mainPlayer.position;
> 
> if(acceleration.y < -0.25) {  // tilting the device to the right
>     position.y -= 0.25;
> } else if (acceleration.y > 0.25) {  // tilting the device to the left
>     position.y += 0.25;
> } else {
> 
> } //    newPosition = position;
> 
> CCAction *action = [CCMoveTo actionWithDuration:0.01 position:position];
> [mainPlayer runAction:action]; 
> //    mainPlayer.position = ccp(position.x, position.y);
> } 
> ```

我通过直接设置位置和使用动作来尝试两种方式。

剂量任何人都知道为什么会发生此问题或加速度计工作需要任何设置。

请提供此类示例的任何链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:01:38.947

尝试使用 MoveBy 而不是 MoveTo：

```
 - (void) accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration1 {

    acceleration = acceleration1;
    CGPoint position = ccp(0,0);

    if(acceleration.y < -0.25) {  // tilting the device to the right
        position.y = 0.25;
    } else if (acceleration.y > 0.25) {  // tilting the device to the left
        position.y = 0.25;
    }

    CCAction *action = [CCMoveBy actionWithDuration:0.01 position:position];
    [mainPlayer runAction:action]; 
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:07:52.590

我建议不要从加速度计运行动作，因为这个方法在一秒钟内被调用 10 次（我不记得 cocos2d 是如何初始化加速度计的），这将导致该`runAction`方法每秒被调用 10 次并且可能会停止前一个动作这就是为什么你看不到它移动的原因。

显示有关如何创建主播放器以及如何将其添加到场景/图层的更多代码

# iphone - 出现 iAD 时，iOS 子视图不会调整大小

> ID：10896042
> 
> 赞同：0
> 
> 时间：2012-06-05T10:55:50.407
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我有一个具有 3 个视图（+ adView）的 viewController。bannerViewDidLoadAd 事件被正确触发，然后我想调整我的视图大小以使 iAd 可见。但是，视图不会调整大小，并且控制台会显示一条消息，告知 iAd 可能被遮挡。然后如何将其置于前面并调整视图大小？谢谢你。

```
- (void)bannerViewDidLoadAd:(ADBannerView *)banner {

    if (!self.bannerIsVisible) { //&& iniciBanner

        self.bannerIsVisible = YES;

        [self.view addSubview:adView];

        [UIView beginAnimations:@"animatedAdBannerOn" context:NULL];
        //adView.frame = CGRectOffset(adView.frame, 0, adView.frame.size.height);
        [UIView commitAnimations];

        self.view.frame = CGRectMake(0, adView.frame.size.height, self.view.frame.size.width, self.view.frame.size.height - adView.frame.size.height);

        self.vistaB.frame = CGRectMake(0, adView.frame.size.height, self.vistaB.frame.size.width, self.vistaB.frame.size.height - adView.frame.size.height);

        self.vistaSocial.frame = CGRectMake(0, adView.frame.size.height, self.vistaSocial.frame.size.width, self.vistaSocial.frame.size.height - adView.frame.size.height);

        [self.view bringSubviewToFront:adView];
    }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:22:36.583

从您的代码看来一切正常，所以我最好的猜测是您忘记将视图的 IBoutlets 与 Xib 的 UViews 连接起来。

# python - Python 中的 cvCalcEigenObjects 和 cvEigenDecomposite

> ID：10896043
> 
> 赞同：1
> 
> 时间：2012-06-05T10:56:05.600
> 
> 标签：python, image-processing, opencv

我正在尝试以此为基础在 python 中实现基于人脸的身份验证[系统](http://www.cognotics.com/opencv/servo_2007_series/part_5/page_3.html)。

在原来的cpp代码中，`cvCalcEigenObjects`都`cvEigenDecomposite`用到了。但我找不到这些的 python 等价物。我在网上搜索了可能要导入的模块，但找不到线索（除了使用 numpy 实现它们）。

我真的很感激任何关于等效函数或如何使用 numpy 实现这些函数的指针。我不会要求编码，但我认为它会在未来帮助其他人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:27:46.007

Philip Wagner 写了一篇关于人脸识别的两种方法的文章，其中一种是使用特征人脸。他还为 OpenCV 2.4 做出了贡献，现在可以在示例中使用。

在文章中，他在 numpy 的帮助下生成了特征面。您可以检查它并自己实施。

[http://www.bytefish.de/pdf/facerec_python.pdf](http://www.bytefish.de/pdf/facerec_python.pdf)

检查他的 github 帐户是否有 python 代码：[https ://github.com/bytefish/facerecognition_guide](https://github.com/bytefish/facerecognition_guide)

# performance - 如何计算udp数据包发送和接收的时间

> ID：10896044
> 
> 赞同：1
> 
> 时间：2012-06-05T10:56:06.170
> 
> 标签：performance, time, timer, udp

我已经实现了一个 udp 数据包发送方和接收方。我想计算交易时间，从发送者到接收者需要多少时间..

发件人代码：

```
void senderFunc() {
/*some other code */
if((s1 = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) == -1)
    error_handler("\nERROR: in Socket\n");
    memset((char *) &me, 0, sizeof(me));
    me.sin_family = AF_INET;
    me.sin_port = PORT;
    if (inet_aton(G_IP, &me.sin_addr)==0)
    {
        fprintf(stderr, "inet_aton() failed\n");
        exit(1);
    }
    printf("\Tick - %d : %s",cntr++,str);
    sprintf(b1, "%s",str);  // Some Information in b1 buffer to transfer 
    if(sendto(s1, b1, sizeof(b1),0,(struct sockaddr *) &me,n)==-1)
    error_handler("\nERROR: in sendto()\n");
    close (s1);
    return;
    }
} 
```

收货人代码：

```
int receiverFunc () {
    struct sockaddr_in other, me;
    int s2, n, i = 1;
    char b2[BUFLEN];//, b2[BUFLEN];
    s2 = socket(AF_INET, SOCK_DGRAM,0);
    me.sin_family = AF_INET;
    me.sin_port = PORT;
    me.sin_addr.s_addr = htonl(INADDR_ANY);
    bind(s2,(struct sockaddr *)&me, sizeof(me));
    n=sizeof(other);
    int incr = 0;
    while (i){
        recvfrom (s2,b2,BUFLEN,0,(struct sockaddr *) &other, &n);
        printf ("\nSubnet 2: Tick - %d : %s",incr++, b2);
    }
    return 0;
} 
```

谁能帮助我，假设我正在从发件人向收件人发送数据包，我该如何计算此交易之间的时间。那我怎么计算那个时间呢？

感谢这个论坛的最佳回复。我正在寻找您的另一个最佳回复。

谢谢

拉希。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:27:36.770

我认为你需要：

1）从同一时间服务器（ntp）同步您的客户端，服务器，以确保它们具有相同的时间。

在客户端：

2) 获取当前时间并使用 timestart 发送 udp 包

```
#include <sys/time.h>

struct timeval timestart;
gettimeofday(&timestart, NULL);

...
//put timestart to  your buffer
... 
```

在服务器端：

3）提取时间结构，并与当前时间比较：

```
#include <sys/time.h>

...
//get timestart from your buffer
...

struct timeval timeend;
gettimeofday(&timeend, NULL);

long diff_msec = (timestart.tv_sec  - timeend.tv_sec) / 1000 + (timestart.tv_usec  - timeend.tv_usec); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:59:47.643

为一个简单的回显请求/响应从一端计时并除以二。这不是一个严格的程序，因为它假设网络速度在两个方向上是相同的，但它给了你一个大概的数字。

# jquery - 将 JSONP 从 PHP 站点发送到多个站点

> ID：10896049
> 
> 赞同：1
> 
> 时间：2012-06-05T10:56:39.227
> 
> 标签：jquery, json, jsonp

我是 JSONP 的新手，所以我希望有人能从头开始帮助我。

基本上我的情况是：

我有一个带有 CMS 的服务器。我希望来自 CMS 的信息出现在其他几个网站上。

所以我在想（但不确定）我把我想要传输的信息放在一个 PHP 变量中。然后我用

```
echo json_encode($json); 
```

然后在我希望显示有关我使用 JQuery 的信息的网站上：

```
$.ajax({
  url: 'http://www.mycmssite.com/phppage.php?json',
  dataType: 'json',
  data: json,
  success: callback
});

var myvar = success;
document.write(myvar); 
```

现在这是我的初步理解，我知道它充满了漏洞。但是，如果有人能指出我正确的方向，那就太棒了！

多谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:09:57.133

确保您的 Ajax 请求`dataType: 'jsonp'`改为指定。这将允许调用绕过同源策略并添加 jQuery 生成的回调函数名称。

确保您的服务器脚本可以检测到传递了回调函数名称并将响应包装在该函数中的事实。

例如，当使用回调调用您的服务时：

```
http://www.mycmssite.com/phppage.php?json=1&callback= jQuery17109598642324563116 
```

您的回复将类似于：

```
jQuery17109598642324563116({json response here}) 
```

此外，success 属性应设置为现有函数，该函数将对接收到的 JSON 数据执行一些逻辑。

*   阅读[$.ajax 的文档以](http://api.jquery.com/jQuery.ajax/)获取有关其他属性（如数据）的详细信息，以确保您了解此处的预期内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:10:27.940

```
$.ajax({
    url: 'http://www.mycmssite.com/phppage.php?json',
    dataType: 'json',
    data: {Iwant:'theData', thisIs:'somejson'},
    success: function(msg) {
        console.log('server answered:', msg);
        // do something with received message
    }
}); 
```

CORS 标头更像

```
header("Access-Control-Allow-Origin", "*")
header("Access-Control-Request-Method", "GET")
header("content-type", "application/x-javascript") 
```

这些标头使 JSONP 的要求过时。

# java - Netbeans Java WebcamCapture 引发异常

> ID：10896050
> 
> 赞同：1
> 
> 时间：2012-06-05T10:56:41.240
> 
> 标签：java, swing, netbeans, webcam

使用 Netbeans，我正在尝试连接我的笔记本电脑摄像头或另一个 USB 摄像头并截屏。我的项目中有两个课程可以做到这一点：

1.  functiiwebcam.java（它包含连接设备和捕获图像的所有功能）

    这是代码：

    ```
    import java.util.logging.Level;
    import java.util.logging.Logger;
    import javax.media.*;
    import javax.media.cdm.CaptureDeviceManager;
    import java.io.*;
    import java.awt.*;
    import javax.media.control.FrameGrabbingControl;
    import javax.media.format.VideoFormat;
    import javax.media.util.BufferToImage;
    import javax.swing.JLabel;
    import javax.swing.JOptionPane;

    public class functiiwebcam {
        //pentru fereastra, implicit dispozitiv   
        String camera = "vfw:Microsoft WDM Image Capture (Win32):0";
        Player broadcast = null;

        public Component Componente() {
            Component componente_video;

            try {
                // Selectare dispozitiv
                CaptureDeviceInfo device = CaptureDeviceManager.getDevice(camera);
                //Sursa imaginilor capturate
                MediaLocator localizador = device.getLocator();
                //Locatia este de tipul "vfw://0" video para windows
                //Fereastra pentru afisarea imaginilor in aplicatie
                broadcast = Manager.createRealizedPlayer(localizador);
                //broadcast.start();
            } catch (IOException ex) {
               // Logger.getLogger(functiiwebcam.class.getName()).log(Level.SEVERE, null, ex);
                ex.printStackTrace();
            } catch (NoPlayerException ex) {
                Logger.getLogger(functiiwebcam.class.getName()).log(Level.SEVERE, null, ex);
            } catch (CannotRealizeException ex) {
                Logger.getLogger(functiiwebcam.class.getName()).log(Level.SEVERE, null, ex);
            }

            // Obtinerea imaginilor in player
            if ((componente_video = broadcast.getVisualComponent()) != null) {
                //dimensiunea ferestrei de broadcast
                componente_video.setSize(320, 240);
                return componente_video;
            } else {

                return null;
            }
        }

        // Metoda pentru captura imaginii
        Image img = null;
        public void capturareImagine() {
            FrameGrabbingControl ControlFG = (FrameGrabbingControl) broadcast.getControl("javax.media.control.FrameGrabbingControl");
            Buffer buffer = ControlFG.grabFrame();
            // creare image awt
            BufferToImage image = new BufferToImage((VideoFormat)buffer.getFormat());
            img = image.createImage(buffer);
        }

        public Image getImage() {
            return img;
        }

        public void setImage(JLabel lb) {
            capturareImagine();        
            lb.setIcon( new javax.swing.ImageIcon( img ) );
            System.out.println("ancho= " + img.getWidth(null));
            System.out.println("alto= " + img.getHeight(null));
        }
    } 
    ```

2.  Webcam.java（其中包含设计 SWING GUI -JFRAME FORM：按钮和面板等）

    在这里，我认为您不需要整个代码。它是我设计界面时由 Netbeans 生成的。我只会放这个类：

    ```
    import javax.swing.Icon;
    import javax.swing.ImageIcon;
    import javax.swing.JOptionPane;

    public class Webcam extends javax.swing.JFrame {
        functiiwebcam b = new functiiwebcam();
        /** Creates new form Webcam */
        public Webcam() {
            initComponents();
            this.setTitle("Webcam");
            // Centreaza ferestra
            this.setLocationRelativeTo(null);
            // Aplicare Layout de tip BOX panoului cu numele broadcast (cel in care se afiseaza imaginile de pe webcam)       
            broadcast.setLayout(new javax.swing.BoxLayout(broadcast, javax.swing.BoxLayout.LINE_AXIS));
            // Adaugarea componentei video
            broadcast.add(b.Componente());
        }

        // Button for webcam capture
        private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
            b.capturareImagine();

            Icon icon = new javax.swing.ImageIcon(b.getImage());
            captura.setIcon(icon); 
    ```

当我运行应用程序时，它会抛出这个异常。但奇怪的是有时它会起作用。我可以从出现的窗口中选择设备，我可以看到来自网络摄像头的图像，甚至可以捕捉它。怎么了？

```
java.io.IOException: Could not connect to capture device
java.io.IOException: Could not connect to capture device
Iun 05, 2012 1:48:54 PM functiiwebcam Componente
SEVERE: null
javax.media.NoPlayerException: Error instantiating class: com.sun.media.protocol.vfw.DataSource : java.io.IOException: Could not connect to capture device
    at javax.media.Manager.createPlayerForContent(Manager.java:1362)
    at javax.media.Manager.createPlayer(Manager.java:417)
    at javax.media.Manager.createRealizedPlayer(Manager.java:553)
    at functiiwebcam.Componente(functiiwebcam.java:37)
    at Webcam.<init>(Webcam.java:30)
    at MediaPlayer.jMenuItem1ActionPerformed(MediaPlayer.java:476)
    at MediaPlayer.access$900(MediaPlayer.java:17)
    at MediaPlayer$11.actionPerformed(MediaPlayer.java:325)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.AbstractButton.doClick(AbstractButton.java:376)
    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(BasicMenuItemUI.java:833)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(BasicMenuItemUI.java:877)
    at java.awt.Component.processMouseEvent(Component.java:6504)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
    at java.awt.Component.processEvent(Component.java:6269)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Component.dispatchEventImpl(Component.java:4860)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
    at java.awt.Container.dispatchEventImpl(Container.java:2273)
    at java.awt.Window.dispatchEventImpl(Window.java:2713)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:707)
    at java.awt.EventQueue.access$000(EventQueue.java:101)
    at java.awt.EventQueue$3.run(EventQueue.java:666)
    at java.awt.EventQueue$3.run(EventQueue.java:664)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:680)
    at java.awt.EventQueue$4.run(EventQueue.java:678)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:677)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:128)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:117)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:113)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:105)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:90)

Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at functiiwebcam.Componente(functiiwebcam.java:48)
    at Webcam.<init>(Webcam.java:30)
    at MediaPlayer.jMenuItem1ActionPerformed(MediaPlayer.java:476)
    at MediaPlayer.access$900(MediaPlayer.java:17)
    at MediaPlayer$11.actionPerformed(MediaPlayer.java:325)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.AbstractButton.doClick(AbstractButton.java:376)
    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(BasicMenuItemUI.java:833)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(BasicMenuItemUI.java:877)
    at java.awt.Component.processMouseEvent(Component.java:6504)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
    at java.awt.Component.processEvent(Component.java:6269)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Component.dispatchEventImpl(Component.java:4860)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
    at java.awt.Container.dispatchEventImpl(Container.java:2273)
    at java.awt.Window.dispatchEventImpl(Window.java:2713)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:707)
    at java.awt.EventQueue.access$000(EventQueue.java:101)
    at java.awt.EventQueue$3.run(EventQueue.java:666)
    at java.awt.EventQueue$3.run(EventQueue.java:664)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:680)
    at java.awt.EventQueue$4.run(EventQueue.java:678)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:677)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:128)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:117)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:113)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:105)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:90) 
```

# python - 使用 matplotlib 和 pyplot 的 2D 坐标的简单动画

> ID：10896054
> 
> 赞同：7
> 
> 时间：2012-06-05T10:56:52.407
> 
> 标签：python, animation, python-2.7, matplotlib

我是 matplotlib 的新手。我有一个 xy 坐标列表，我在 python 中更新并希望使用 matplotlib 的 pyplot 进行动画处理。我想提前指定 x 范围和 y 范围。以下是我当前的代码：

```
import matplotlib.pyplot as plt
x=[1,2,3,4]
y=[5,6,7,8]
for t in range(100):
    #lists x and y get updated here
    #...
plt.plot(x, y, marker='o', linestyle='None')
plt.show() 
```

如您所见，我*在迭代循环结束时*`plt.plot()`使用and仅绘制最终坐标。但我想把这一步*放在*循环中，并在每次迭代时绘制一个指定的暂停时间，以便在循环运行时有一个动画。`plt.show()`

 **只是在循环内移动该语句或对其进行调整是行不通的。我想保持它非常简单，并且不想使用`matplotlib.animation`. 有没有一些简单的方法而不使用更多的模块和库（只有类似的东西`plt.pause()`，也许只有更多），可以让我做我想做的事？

我在网上查看了很多地方，大多数方法遇到的问题是我在 Windows 上使用 python(x,y) （即 python 版本 2.7），并且使用过于复杂的模块和库的动画在这里崩溃。

但是，我可以在 matplotlib 站点上运行类似[这个示例](http://matplotlib.sourceforge.net/examples/animation/random_data.html)的简单内容，这与我想要的很接近，但并不完全。所以也许最好的办法是修改这个例子，适用于我的二维数据情况（这个例子是一维行）。但欢迎任何其他建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T11:42:30.020

这是改编自[动画演示](http://matplotlib.sourceforge.net/examples/pylab_examples/animation_demo.html)：

```
import matplotlib.pyplot as plt 
import numpy as np

fig, ax = plt.subplots()

x = [1, 2, 3, 4]
y = [5, 6, 7, 8]

for t in range(10):
    if t == 0:
        points, = ax.plot(x, y, marker='o', linestyle='None')
        ax.set_xlim(0, 10) 
        ax.set_ylim(0, 10) 
    else:
        new_x = np.random.randint(10, size=5)
        new_y = np.random.randint(10, size=5)
        points.set_data(new_x, new_y)
    plt.pause(0.5) 
```

虽然这很简单，但文档字符串说它很慢。**

# android - Eclipse中的Android应用程序

> ID：10896055
> 
> 赞同：1
> 
> 时间：2012-06-05T10:56:58.400
> 
> 标签：android, android-manifest

我在 Eclipse 中的 AndriodMenifest.xml 中遇到问题。错误在

```
<uses-sdk android:minSdkVersion="8" /> 
```

它说 `<uses-sdk>`标签应该指定一个目标API级别（最高验证版本；在更高版本上运行时，可能会启用兼容性行为）`android:targetSdkVersion="?"`

虽然android的API级别是8，但我得到了这个错误。如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T10:59:54.723

编辑您的 AndroidManifest.xml（使用源视图）并将 targetSdkVersion 设置为 8

（从技术上讲，它应该设置为您已验证您的应用程序在其上运行的最高版本的 android，它用于确定应该使用哪些向后兼容功能）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:01:50.527

只需将`android:targetSdkVersion="8"`属性添加到`uses-sdk`标签。如果您只是想摆脱警告，那就可以了。

但始终将其包括在内是一种好的做法`android:targetSdkVersion`

谷歌已经提供了很好的描述在这里[检查](http://developer.android.com/guide/topics/manifest/uses-sdk-element.html#target)

例如，如果您的最小 SDK 为 8，但您的目标 SDK 为 14，您是在告诉 android，虽然没有理由它不应该在版本 8 上运行，但您只在 14 上进行了测试。因此，如果有任何兼容性设置要在 8 级和 14 级之间启用，可以设置它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T11:02:37.730

**检查您是否在AndroidManifest.xml**中定义了 sdk

 **```
<uses-sdk android:minSdkVersion="8" /> 
```

还要检查你的**default.properties**文件

```
target=android-8 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T11:14:09.647

```
<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="9"/> 
```

您需要同时指定两者。**

# c++ - 不同类的 Qt 信号和槽

> ID：10896056
> 
> 赞同：6
> 
> 时间：2012-06-05T10:57:06.550
> 
> 标签：c++, qt, signals-slots

我有一个带插槽的 X 类和一个带信号的 Y 类。我正在从 X 类建立连接，并在 Y 类中创建了一个公共方法来从 X 类发出信号（我不确定这一步是否必要）。

然后，如果我从类 X 调用该方法，则会发出信号，并执行插槽。但是如果我从 Y 类发出信号，插槽永远不会执行，我不明白为什么。

我也可以在 Y 类建立连接吗？

这个伪代码试图解释我想要什么：

```
class X  : public QWidget {
    Q_OBJECT

X(){
    connect(Y::getInstance(), SIGNAL(updateSignal(int)), this, SLOT(updateStatus(int)));
    Y::getInstance().emitSignal(someValue); // Works
}

public slots:
    void updateStatus(int value);

}

class Y : public QObject {

Q_OBJECT

Y(){

}

public:
    Y getInstance();
    void emitSignal(int value) { 
        emit updateSignal(value);
    }

signal:
    void updateSignal(int value);
}

class Z : public Y {
Z(){

}

init(){
 emitSignal(someValue); // Doesn't work
}
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T12:09:15.250

请记住，连接不是在*类*之间，而是在*实例*之间。如果您发出一个信号并期望调用连接的插槽，则必须在建立连接的实例上发出它。那是你的问题。

假设 Y 是[单例](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)：

如果你这样做`connect( Y::getInstance(), ... )`

并且在某些时候`Y::getInstance()`确实如此，然后在建立连接**之前**`new Y()`调用 Y 的构造函数。像这样，信号将被发出，但插槽不会听它。

 **除此之外，最好执行以下操作之一，尽管您无法使用这些方法在 Y 的构造函数中发出信号：

*   使用知道 X 和 Y 的第三类 Z，并在那里进行连接
*   依赖注入。这意味着 X 在其构造函数中获得了 Y 的实例：

依赖注入构造函数的示例：

```
X::X( Y* const otherClass )
{
    connect( otherClass, SIGNAL( ... ), this, SLOT( ... )
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-04-28T07:15:58.763

这很简单。请看下面的例子。

如果你想在自己的类中编写信号和插槽，你需要满足两个条件......

> ```
> 1\. Your class must inherit from QObject class or any class derived from QObject. 
> ```
> 
> `2\. The Q_OBJECT macro must appear in a private section in your class.`

```
/* Sender.h */

#ifndef SENDER_H
#define SENDER_H

#include <QObject>

class Sender : public QObject
{
    Q_OBJECT
public:
    explicit Sender(QObject *parent = 0);    
    void fireSignal();

signals:
    void foo(const QString& arg);
};

#endif // SENDER_H

/* Sender.cpp*/

#include "Sender.h"

Sender::Sender(QObject *parent) :
    QObject(parent)
{
}

void Sender::fireSignal()
{
    emit foo("This a message sender is sending to receiver.");
} 
```

现在接收者的代码如下

```
/* Receiver.h */

#ifndef RECEIVER_H
#define RECEIVER_H

#include <QObject>

class Receiver : public QObject
{
    Q_OBJECT
public:
    explicit Receiver(QObject *parent = 0);

public slots:
    void bar(const QString& arg);

};

#endif // RECEIVER_H

/* Receiver.cpp */

#include "Receiver.h"
#include <iostream>

Receiver::Receiver(QObject *parent) :
    QObject(parent)
{
}

void Receiver::bar(const QString &arg)
{
    std::cout << arg.toStdString();
} 
```

现在 main.cpp 代码

```
#include <QtCore/QCoreApplication>
#include "Sender.h"
#include "Receiver.h"

int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);

    Sender sender;
    Receiver receiver;

    QObject::connect(&sender, SIGNAL(foo(QString)), &receiver, SLOT(bar(QString)));

    sender.fireSignal();

    return a.exec();
} 
```

就是这样。

最后，如果您想对连接方法使用另一种语法。请使用以下几行

```
QObject::connect(&sender,&Sender::foo,&receiver,&Receiver::bar); 
```

希望这对您有所帮助。谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T11:18:29.690

您正在从构造函数发出信号。当时`Y::getInstance()`没有任何意义根据这个代码片段。**

# performance - 性能 width="100%" 或 left="0" right="0" 哪个更好？

> ID：10896067
> 
> 赞同：2
> 
> 时间：2012-06-05T10:58:11.927
> 
> 标签：performance, apache-flex, mxml

在最新的 Adob​​e Flex sdk 4.6 中，从性能角度看什么更好？

```
<s:Group width="100%" height="100%"/> 
```

或者

```
<s:Group left="0" right="0" top="0" bottom="0"/> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T13:46:31.097

在`BasicLayout.updateDisplayList()`我发现这个（在每个子元素的循环中）：

```
if (!isNaN(percentWidth))
            {
                var availableWidth:Number = unscaledWidth;
                if (!isNaN(left))
                    availableWidth -= left;
                if (!isNaN(right))
                     availableWidth -= right;

                childWidth = Math.round(availableWidth * Math.min(percentWidth * 0.01, 1));
                elementMaxWidth = Math.min(layoutElement.getMaxBoundsWidth(),
                    maxSizeToFitIn(unscaledWidth, hCenter, left, right, layoutElement.getLayoutBoundsX()));
            }
            else if (!isNaN(left) && !isNaN(right))
            {
                childWidth = unscaledWidth - right - left;
            } 
```

身高也一样。

所以，看起来像：

1.  *percenWidth*比*top*和*left*具有更高的优先级（如果两者都设置了）
2.  ***top*****和*left*比*percenWidth***更容易计算（单次减法，函数调用和条件）
3.  *top*和*left*可以用作样式声明。

此外，大多数 Flex4 皮肤都是基于*顶部*和*左侧*的- 我认为也是出于性能原因。

# ajax - 的空值 里面 在 ajax 调用期间未设置为支持 bean

> ID：10896068
> 
> 赞同：1
> 
> 时间：2012-06-05T10:58:19.850
> 
> 标签：ajax, jsf-2, selectonemenu, uirepeat

ajax 调用期间 h:selectOneMenu 的空/空值未设置为支持 bean 中的属性，而如果我选择任何具有非空/非空值的下拉项，则将其设置为支持中的属性ajax 调用期间的 bean。仅当我在 ui:repeat 标记中使用 h:selectOneMenu 和 f:ajax 时，我才会注意到这种行为。而且，没有 ui:repeat 标记，值（空和非空）在 ajax 调用期间被正确设置为支持 bean 中的属性。

以下是上述场景的代码片段：

```
<h:panelGrid id="details">
<ui:repeat id="listId" value="#{new.List}" var="item" varStatus="itemStatus">
    <h:panelGrid id="idDoc">
    <ui:repeat id="docListId" value="#{item.docs}" var="docItem" varStatus="docStatus">
        <h:selectOneMenu id="type"  value="#{docItem.docType}" label="Type" style="" styleClass='' >

                <f:selectItems value="#{new.docSelections}"/>

                <f:ajax onevent="refreshDoc" event="valueChange" render="@this :form:listId:docListId:idDoc" execute=":form:listId:details" listener="#{new.save}"/>
            </h:selectOneMenu>
    </ui:repeat>
    </h:panelGrid>
</ui:repeat>
</h:panelGrid> 
```

我使用 ui:repeat,h:selectoneMenu 和 f:ajax 的方式有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T13:15:10.823

您似乎正在使用 Mojarra。它确实存在与（嵌套）`<ui:repeat>`和组件状态保存相关的几个问题。尝试将 Mojarra 升级到[最新版本](http://javaserverfaces.java.net)。

另一种方法是仅用 a 替换`<h:panelGrid><ui:repeat>`，`<h:dataTable>`因为它有效地生成相同的标记。`<h:dataTable>`不受这些问题的`<ui:repeat>`影响。

```
<h:dataTable id="details" value="#{new.List}" var="item" binding="#{itemStatus}">
  <h:column>
    <h:dataTable id="idDoc" value="#{item.docs}" var="docItem" binding="#{docStatus}">
      <h:column>
        <h:selectOneMenu id="type"  value="#{docItem.docType}" label="Type" style="" styleClass='' >
          <f:selectItems value="#{new.docSelections}"/>
          <f:ajax onevent="refreshDoc" event="valueChange" render="@this :form:listId:docListId:idDoc" execute=":form:listId:details" listener="#{new.save}"/>
        </h:selectOneMenu>
      </h:column>
    </h:dataTable>
  </h:column>
</h:dataTable> 
```

# iphone - 如何在 UILabel 中显示使用 MPMoviePlayer 播放的视频的当前进度？

> ID：10896072
> 
> 赞同：1
> 
> 时间：2012-06-05T10:58:28.183
> 
> 标签：iphone, video, uilabel, mpmovieplayercontroller

我需要在**UILabel中显示****使用 MPMoviePlayerController 播放的视频的当前进度**。我需要在 UILable 中显示视频的当前进度和总时长。它应该看起来像 1.25/5.00 ？我需要在播放视频时显示这个。我可以使用默认进度条直接显示它，但我需要禁用它。由于我无法禁用它，我计划在 UILabel 中显示视频的当前进度。有人可以提供任何建议吗？

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T22:59:26.973

设置进度和持续时间，你可以在播放视频后调用自我观察者，然后更新进度标签的值...

您将观察者设置为查看播放器何时开始播放，并在选择器中调用观察者，该观察者应如下所示；

```
-(void)watcher{
   urProgressLabel.text = [NSString stringWithFormat:@"%d",movieplayer.currentPlaybackTime];
   [self performSelector:@selector(watcher) withObject:nil afterDelay:0.5];//to update the value each 0.5 seconds 
} 
```

希望能帮助到你 ;）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T04:33:04.017

得到答案...

实例化视频播放器时...

```
self.moviePlayerController = [[MPMoviePlayerController alloc] initWithContentURL:fileURL]; 
```

//添加标签以显示视频的进度......

```
progressLabel = [[UILabel alloc]initWithFrame:CGRectMake(125,275,70,25)];
progressLabel.backgroundColor = [UIColor clearColor];
[progressLabel setTextColor:[UIColor whiteColor]];
[self.view addSubview:progressLabel]; 
```

//设置一个定时器..

```
[NSTimer scheduledTimerWithTimeInterval:1.0f 
                                 target:self 
                               selector:@selector(updatePlaybackTime:) 
                               userInfo:nil 
                                repeats:YES]; 
```

并在方法 updatePlaybackTime: ....

```
- (void)updatePlaybackTime:(NSTimer*)theTimer {
    progressLabel.text = [NSString stringWithFormat:@"%f",self.moviePlayerController.currentPlaybackTime];
} 
```

完成..U 将随着视频的进度更新标签...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T11:10:02.640

为了隐藏默认进度条结帐以下[帖子](https://stackoverflow.com/a/6518303/200272)。
为了在链接[1](https://stackoverflow.com/a/6197716/200272)、[2](http://blog.engage-encore.com/index.php/2010/11/08/video-player-ipad-iphone/)之后有一个自定义进度条结帐。**

# jquery - 如何确保动画在队列中执行

> ID：10896074
> 
> 赞同：0
> 
> 时间：2012-06-05T10:58:40.663
> 
> 标签：jquery, animation

我必须为 div 设置动画。我需要确保在单击按钮时*旧*的div 完全淡出，然后让*新*的div 淡入。

```
showNews: function() {
    var start = this.counter * this.displayatonce;
    var end = this.counter * this.displayatonce + (this.displayatonce - 1);

    for (i=start; i<=end; i++) {
        this.news.eq(i).fadeIn();
    }

},

hideAllNews: function() {
    this.news.fadeOut();
},

navigateNews: function() {
    this.hideAllNews();
    this.showNews();
}, 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T13:14:28.547

jQuery 的动画函数将回调函数作为参数。在其回调中的另一个动画之后启动要执行的动画。

例子：

```
elememtsToHide.fadeOut(function() {
  elementsToShow.fadeIn();
}); 
```

# c++ - Unix 多播套接字线程安全吗？

> ID：10896075
> 
> 赞同：0
> 
> 时间：2012-06-05T10:58:52.520
> 
> 标签：c++, sockets, unix

Unix 多播套接字线程安全吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:15:41.343

取决于你所说的线程安全是什么意思。似乎从不同的线程同时调用 send() 不会使您的程序崩溃，并且所有数据都将通过网络发送。

问题是，如果您的消息跨越多个数据包。数据包可能交错，这将由远程机器来整理两个交错的消息。

请参阅：[小心](http://www.almaden.ibm.com/cs/people/marksmith/sendmsg.html)我从中获得的 sendmsg() 系列函数[在同一个套接字上对 send/recv 的并行调用是否有效？](https://stackoverflow.com/questions/1981372/are-parallel-calls-to-send-recv-on-the-same-socket-valid).

# java - 如何使用休眠创建本机查询从 Oracle 编写“INSERT ALL INTO”？

> ID：10896076
> 
> 赞同：0
> 
> 时间：2012-06-05T10:58:54.937
> 
> 标签：java, performance, spring, hibernate, nativequery

我试图将主要任务旁边的大量信息作为线程插入到表中，但似乎还不够，不幸的是性能是个大问题。我一直在使用spring和hibernate，但仍然是新手。因为我一直在使用 em.persist。我从 Oracle 听说过 INSERT ALL，但它与 hibernate 配合得不好，或者它不支持，因为我找不到任何证据。或者您能否提出任何有助于提高插入性能的解决方案，我们将不胜感激。

这是一些代码，在 save() 方法中

```
List<Obj> listOfObj;

this.save(listOfObj);

public void save(listOfObj){
        for (int i = 0; i < listOfObj.size(); ++i) 
        {
           this.em.persist(listOfObj.get(i));
           if (i % 1000 == 0) 
           {
             this.em.flush();
             this.em.clear();
           }
} 
```

# android - 什么时候实现 android.widget.Adapter 比扩展 android.widget.BaseAdapter 更好？

> ID：10896082
> 
> 赞同：1
> 
> 时间：2012-06-05T10:59:17.747
> 
> 标签：android, android-adapter

我想知道什么时候实现`android.widget.Adapter`or`android.widget.ListAdapter`比扩展 android.widget.BaseAdapter 更合适。为了给它添加一些上下文，我有一个包含一个`BaseMessage`类的不同子类的列表，所以我想我需要覆盖`getItemViewTypeCount(int position)`and `getItemViewType(int position)`。

# c# - MOQ 返回动态类型作为对象问题

> ID：10896089
> 
> 赞同：4
> 
> 时间：2012-06-05T10:59:41.223
> 
> 标签：c#, mocking, return, moq, dynamic-typing

如果有人问过这个问题，请道歉，但我在任何地方都找不到答案。

我的问题是在使用 MOQ 模拟返回方法时，该方法返回动态类型。我正在使用使用动态时间的第三方库。MOQ 似乎将动态类型转换为对象。

```
Mock<IFacebookHelper> mockFbHelp = new Mock<IFacebookHelper>();
mockFbHelp.Setup(x => x.Get("me")).Returns(new { email = "test@test.com", id="9999" }); 
```

模拟助手中的方法。

```
public dynamic Get(string p)
{
    var client = new FacebookClient(AccessToken);
    return client.Get("me");
} 
```

使用模拟结果的控制器代码。

```
_facebookHelper.AccessToken = accessToken;
dynamic result = _facebookHelper.Get("me");
int facebookId = int.Parse(result.id);  //This errors as id doesn't exist. 
```

基本上 MOQ 已经返回了一种动态类型的对象，需要将其转换为某种东西。

有谁知道如何解决这个问题？我假设可能是因为 MOQ 未在 .NET 4 中编码，因此不支持动态类型？

**编辑**

实际上，我认为这不是最小起订量问题，因为我创建了自己的模拟类并且仍然遇到同样的问题。我是动态类型的新手，但不确定发生了什么。

**编辑 2 - 部分回答.. 问题毕竟与最小起订量无关**

实际上问题似乎是由于在不同的程序集中创建的动态类型。尽管我使用 JObject 类型解决了我最初的问题，但我仍然想弄清楚这一点。

```
namespace MyLib.Tools
{
    public interface IDynTest
    {
        dynamic GetData();
    }
} 
```

```
namespace MyLib.Tools
{
    public class DynTest : Effect.Tools.IDynTest
    {
        public dynamic GetData() {
            return new { DynamicProperty = "hello" };
        }
    }
} 
```

```
namespace Warrior.WebUI.Infrastructure
{
    public class UseDynTest
    {
        private readonly IDynTest dynTest;

        public UseDynTest(IDynTest dynTest)
        {
            this.dynTest = dynTest;
        }

        public string RetTest()
        {
            return dynTest.GetData().DynamicProperty;
        }
    }
} 
```

```
namespace Warrior.Tests
{
    [TestClass]
    public class TestDynTest
    {
        [TestMethod]
        public void TestMethod1()
        {
            //Mock<IDynTest> mockDynTest = new Mock<IDynTest>();
            //mockDynTest.Setup(x => x.GetData()).Returns(new { DynamicProperty = "From Unit Test" });

            DynTestProxy dynTestProxy = new DynTestProxy();

            UseDynTest useTest = new UseDynTest(dynTestProxy);

            string results = useTest.RetTest();

            Assert.AreEqual("From Unit Test", results);
        }
    }
} 
```

```
namespace Warrior.Tests
{
    public class DynTestProxy:IDynTest
    {
        public dynamic GetData()
        {
            return (dynamic) new { DynamicProperty = "From Unit Test" };
        }
    }
} 
```

Namespace MyLib、Warrior.WebUI 和 Warrior.Tests 指示了 3 个项目。
因为它是测试失败并出现错误..“对象”不包含在 RetTest() 上发生的“DynamicProperty”的定义

但是，如果我只是将 DynTestProxy 类移动到 Warrior.WebUI 项目中，一切正常。我猜在跨不同的程序集或其他东西发送动态类型时会出现问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T13:30:14.833

我做了一个快速测试：

```
namespace ConsoleApplication5
{
    public interface IFacebookHelper { dynamic Get(string p); }

    class Program
    {
        static void Main(string[] args)
        {
            Mock<IFacebookHelper> mockFbHelp = new Mock<IFacebookHelper>();
            mockFbHelp.Setup(x => x.Get("me")).Returns(new { email = "test@test.com", id = "9999" });

            dynamic result = mockFbHelp.Object.Get("me");
            int facebookId = int.Parse(result.id);
            string email = result.email;
        }
    }
} 
```

这工作正常。我认为这里没有问题。

你确定你没有混淆一些东西吗？

看你贴的方法：

```
public dynamic Get(string p)
{
    var client = new FacebookClient(AccessToken);
    return client.Get("me");
} 
```

也许应该是：

```
...
return client.Get(p);
... 
```

真的是`_facebookHelper`在使用`Mock`对象吗？在您的测试期间，它应该是类型`IFacebookHelperProxy`或类似的东西。

**编辑：**

问题是您尝试跨程序集边界公开匿名类型，因为您只能在创建它们的程序集中使用匿名类型。

所以而不是

```
public class DynTestProxy:IDynTest
{
    public dynamic GetData()
    {
        return (dynamic) new { DynamicProperty = "From Unit Test" };
    }
} 
```

你应该使用[ExpandoObject](http://msdn.microsoft.com/en-en/library/system.dynamic.expandoobject.aspx)：

```
public class DynTestProxy:IDynTest
{
    public dynamic GetData()
    {
        dynamic r = new ExpandoObject();
        r.DynamicProperty = "From Unit Test";
        return r;
    }
} 
```

或使用[InternalsVisibleTo](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)属性。请参阅[此处](http://www.heartysoft.com/anonymous-types-c-sharp-4-dynamic)了解更多信息。[这个](https://stackoverflow.com/questions/2993200/return-consume-dynamic-anonymous-type-across-assembly-boundaries)问题对你来说可能也很有趣。

# javascript - 来自数据库的 javascript 代码

> ID：10896099
> 
> 赞同：0
> 
> 时间：2012-06-05T11:00:27.093
> 
> 标签：javascript, asp.net-mvc, asp.net-mvc-3

我在数据库中有一个包含大型 javascript 代码的字段。如何添加此代码以查看？

```
 $(document).ready(function() {
   // javascript code from DB in a RaphaelObject property
   "@Model.RaphaelObject";
  }); 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T11:05:08.873

尝试`@Html.Raw(Model.RaphaelObject)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T11:07:26.523

删除引号：

```
$(document).ready(function() {
    // javascript code from DB in a RaphaelObject property
    @Model.RaphaelObject
}); 
```

可能是您对 js 代码字符串进行了编码。所以可能需要**HttpUtility.HtmlDecode(Model.RaphaelObject)**。

# scope - Seam - 了解 PAGE 范围和 CONVERSATION 范围

> ID：10896102
> 
> 赞同：2
> 
> 时间：2012-06-05T11:00:28.390
> 
> 标签：scope, seam2, conversation-scope

`PAGE`我仍然对和`CONVERSATION`(temp) 范围感到困惑。也许我在这里得到一些帮助。据我所知，`PAGE`只要用户只回发相同的页面，被输出到范围内的变量就会存在。相反，临时`CONVERSATION`范围甚至可以在重定向到下一页后幸存下来。这是一个小例子，有两个让我感到困惑的效果：

首先，组件和输出在`CONVERSATION`范围内，`tempUser`数据显示在 jsf 页面中。但是在从那个 jsf 页面调用的 save 方法中，注入`tempUser`的是 null。为什么？

其次，如果我做同样的事情，但将组件和@In/@Outs 范围更改为`PAGE`范围，则`tempUser`在回发时会正确注入 - 但无论出于何种原因都不会保存，尽管甚至调用了`super.update()`- 方法`userHome`。或者以这种方式使用 homeEntities 是否存在问题（仅将它们用作 DAO 包装器的想法）？

```
@Name("userAction")
@Scope(ScopeType.CONVERSATION)
public class UserAction implements Serializable {

    private static final long serialVersionUID = -4852371546895918692L; 

    @In(create = true)
    private UserHome userHome;

    @Out(scope = ScopeType.CONVERSATION)    
    @In(required = false,scope = ScopeType.CONVERSATION)
    User tempUser;

    @RequestParameter
    private Long userId;

    @Factory("tempUser")        
    public User getUser() {                     
        if (tempUser == null) {
            userHome.setUserId(userId);
            tempUser = userHome.getInstance();
            userHome.clearInstance();
        }
        return tempUser;        
    }

    public void save() {    
        userHome.setInstance(tempUser);     
        userHome.update();
    }
} 
```

xhtml 包含 aa:form 与

```
<a:commandButton
  id="update"
  styleClass="button admin" 
  action="#{userAction.save}" 
  value="#{messages['user.action.update']}"/> 
```

感谢您的回复。对不起，如果这是两个问题合二为一。

# django - 自定义 templatetag 模板中的 cms 标签不起作用

> ID：10896103
> 
> 赞同：0
> 
> 时间：2012-06-05T11:00:29.630
> 
> 标签：django, django-templates, django-cms

我正在尝试`show_menu`在自定义模板标签模板中调用。就像是：

```
base.html
xpto.html
    template that extends base.html and loads cms_tags and my_custom_tags

my_custom_tag_template.html loads cms_tags
    in this template I call {% show_menu %} and it doesn't work. 
```

有什么想法吗？

# jquery - 如何使用 jquery 在单击时循环元素 bg 颜色，并在单击另一个元素时重置

> ID：10896107
> 
> 赞同：1
> 
> 时间：2012-06-05T11:00:48.847
> 
> 标签：jquery, html, css

因此，我正在为客户设置一个背景更换器，以实现可访问性。我有一组具有所需 bg 颜色的 div，以及用于在单击时更改正文背景的 jQuery。

我想要的是被点击的元素在点击时变为白色（即重置选项）。

但是使用我的代码，如果你点击另一个，它也会变成白色，而不重置另一个，所以你最终会得到一大堆白色的 div。

这是我的代码：

```
<div class="bg_changer">
                <ul><li class="bg_1 bg_setter"><a >bg_one</a></li>
                <li class="bg_2 bg_setter" ><a >bg_two</a></li>
                <li class="bg_3 bg_setter"><a >bg_three</a></li>
                <li class="bg_4 bg_setter"><a >bg_four</a></li>
                <li class="bg_5 bg_setter"><a >bg_five</a></li>
                <li class="bg_6 bg_setter"><a >bg_six</a></li>

                </ul>

</div><!-- end of bg_changer --> 
```

css

```
.bg_1{
    background-color: rgba(204,204,204,1);
}
.bg_2{
    background-color: rgba(254,254,196,1);
}
.bg_3{
    background-color: rgba(253,190,130,1);
}
.bg_4{
    background-color: rgba(253,253,128,1);
}
.bg_5{
    background-color: rgba(158,208,253,1);
}
.bg_6{
    background-color: rgba(218,218,254,1);
} 
```

和 jQ

```
$(document).ready(function(){
    $(".bg_setter").click(function() {
      var bg_new =  $(this).css('background-color');
        $("body").css('background-color', bg_new);
        $(this).css('background-color', 'white');
    });

}); 
```

是否有人对如何实现此更改有任何想法，以便如果我切换 bg_one，然后切换 bg_two，我可以将 bg_one 重置为其原始背景颜色？

如果不存储大量变量，我想不出一种方法来做到这一点，肯定有更简单的东西......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:09:01.233

一种方法是设置一个全局变量来保存选定元素和选定元素的颜色。当您单击另一个时，它会使用这些变量设置先前选择的元素和颜色。

```
$(document).ready(function() {
    //global vars - nothing yet, no color has been selected
    var prev_element, prev_color;

    $(".bg_setter").click(function() {
        //if there has been a previously selected element - set it's color back
        if (prev_element) {
            prev_element.css('background-color', prev_color);
        }

        //Store this element and the current color
        prev_element = $(this);
        prev_color = $(this).css('background-color');

        //Update the body background color with the color selected
        $("body").css('background-color', prev_color);

        //set the selected element background color to white
        prev_element.css('background-color', 'white');
    });

});​ 
```

**演示：http:** [//jsfiddle.net/AY2B3/2/](http://jsfiddle.net/AY2B3/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:05:47.140

您可以在其数据中保存每个元素的默认背景颜色，然后在单击事件时恢复：

```
$(".bg_setter").click(function() {
    var bg_new = $(this).css("background-color");
    $("body").css("background-color", bg_new);

    $(this).css("background-color", "white");
    $(this).siblings(".bg_setter").css("background-color", function(i, value) {
        return $(this).data("color");
    });
}).each(function() {
    $(this).data("color", $(this).css("background-color"));
});​ 
```

**演示：http:** [//jsfiddle.net/GLMkd/](http://jsfiddle.net/GLMkd/)

# java - 来自 cygwin 的 Saxon 9.4 查询

> ID：10896108
> 
> 赞同：2
> 
> 时间：2012-06-05T11:00:53.143
> 
> 标签：java, cygwin, xquery, saxon

我在文件夹中：

`/cygdrive/d/ragsxq`我保留了一些简单的 X-Query stmts 以通过 Saxon X-Query 引擎执行...（Saxon 9.4 HE）

以下声明：

```
$ java -classpath /cygdrive/d/saxon/saxon9he.jar net.sf.saxon.Query -q:ragsXQuery.xq 
```

给出：

```
java.lang.NoClassDefFoundError: net/sf/saxon/Query Caused by: 
java.lang.ClassNotFoundException: net.sf.saxon.Query at
java.net.URLClassLoader$1.run(Unknown Source) at
java.security.AccessController.doPrivileged(Native Method) at
java.net.URLClassLoader.findClass(Unknown Source) at 
java.lang.ClassLoader.loadClass(Unknown Source) at
sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source) at
java.lang.ClassLoader.loadClass(Unknown Source) Could not find the main class:
net.sf.saxon.Query. Program will exit. Exception in thread "main" 
```

但下面的语句工作正常：

```
$ java -classpath ../saxon/saxon9he.jar net.sf.saxon.Query -q:ragsXQuery.xq 
```

？！？！

与类加载器有关..?? 权限..?? 赛格温？嗯……

* * *

非常感谢您指出这种 Cygwin 行为！

但奇怪的是，`java.lang.NoClassDefFoundError`当我尝试在 Mac OS Lion 上通过我的 Eclipse (Indigo) 运行 Xquery 时，我遇到了这个（与上面完全相同）......通过[XQDT 插件](http://www.xqdt.org/html/index "XQDT")，我必须在其中配置 XQuery通过提供 saxon9he.jar 的完整路径和主类即引擎，`net.sf.saxon.Query`

请注意，Windows-XP 上的类似设置工作正常。

这一次，我想这可能是一些 Classpath 问题或 Mac OS 的 Java 处理方式不同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T11:12:59.133

我想我以前遇到过这种情况。这可能是 Cygwin 的细微差别。试试看嘛

```
$ java -classpath `cygpath -m /cygdrive/d/saxon/saxon9he.jar` net.sf.saxon.Query -q:ragsXQuery.xq 
```

以下是关于原因的可能解释：

[http://cygwin.com/ml/cygwin/2008-01/msg00083.html](http://cygwin.com/ml/cygwin/2008-01/msg00083.html)

下面是我的 Cygwin 的可执行 JAR 文件的输出。我使用 Windows Vista 32 位（我知道，这很糟糕）。

```
adarshr$ java -jar /cygdrive/d/adarshr/data/cf.jar
Error: Unable to access jarfile /cygdrive/d/adarshr/data/cf.jar
adarshr$
adarshr$ java -jar `cygpath -m /cygdrive/d/adarshr/data/cf.jar`
Usage: java  -jar  cf.jar  SEARCH  [DIRECTORY]  [OPTIONS]...
Try -h or --help for more information 
```

如您所见，第二个命令有效并打印了帮助（如预期的那样）。

# java - 在多个类中共享 Java 中的常量字符串？

> ID：10896111
> 
> 赞同：61
> 
> 时间：2012-06-05T11:01:22.033
> 
> 标签：java, string

我想在一个地方有 Java 常量字符串，并在整个项目（许多类）中使用它们。

实现这一目标的推荐方法是什么？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-06-05T11:03:18.000

```
public static final String CONSTANT_STRING="CONSTANT_STRING"; 
```

常量应该是：

1.  public - 以便可以从任何地方访问它
2.  静态 - 无需创建实例
3.  final - 因为它的常量不应该被允许改变
4.  根据 Java 命名约定，应该大写以便易于阅读并在 Java 文档中脱颖而出。

在某些情况下，接口仅用于保留常量，但这被认为是一种不好的做法，因为接口应该[定义](https://docs.oracle.com/javase/tutorial/java/concepts/interface.html)类型的行为。

更好的方法是将其保留在更有意义的类中。

例如

`JFrame`具有`EXIT_ON_CLOSE`contant，任​​何子类都可以访问它的类，并且保留而不`JFrame`保留也是有意义的，因为并非所有组件都可以选择关闭。`JFrame``JComponent`

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-09-06T11:54:46.640

正如@mprabhat 之前回答的那样，常量应该是`public`, `static`, `final`, 并以大写字母输入。

将它们分组到一个班级可以帮助您：

1.  不需要知道你拥有的所有常量。许多 IDE（如 Eclipse）会向您显示一个类所具有的所有字段的列表。因此，您只需按下`CTRL+SPACE`并了解您可以使用哪些常量。

2.  在编译时使它们类型安全。如果你使用了`String`s，你可能会拼错`"DATABASE_EXCEPTION"`，`"DATABSE_EXSCEPTION"`并且只在执行期间注意（如果你很幸运并且注意到它）。您还可以从自动完成中获利。

3.  帮助您在执行过程中节省内存。您只需要 1 个常量实例的内存。IE：（一个真实的例子）如果您`String`在代码中的不同类中有 1000 次“DATABASE_EXCEPTION”，那么它们中的每一个都将是内存中的不同实例。

您可能还有其他一些注意事项：

1.  添加 javadoc 注释，让使用常量的程序员可以获得更多关于常量的语义信息。当您按下 时，它会显示为工具提示`CTRL+SPACE`。IE：

    ```
    /** Indicates an exception during data retrieving, not during connection. */
    public static final String DATABASE_EXCEPTION = "DATABASE_EXCEPTION";
    /** Indicates an exception during the connection to a database. */
    public static final String DATABASE_CONNECTION_EXCEPTION =" DATABASE_CONNECTION_EXCEPTION"; 
    ```

2.  为常量的标识符添加语义。如果您有常数`"Y"`，有时表示*yes*而其他时间表示*year*，请考虑使用 2 个不同的常数。

    ```
    public static final String Y = "Y"; // Bad
    public static final String YEAR = "Y";
    public static final String YES = "Y"; 
    ```

    如果将来决定更改常量的值，它将对您有所帮助。

    ```
    /** Year symbol, used for date formatters. */
    public static final String YEAR = "A"; // Year is Año, in Spanish.
    public static final String YES = "S"; // Yes is Sí, in Spanish. 
    ```

3.  您可能直到运行时才知道常量的值。IE：您可以从配置文件中读取它们。

    ```
    public class Constants
    {
      /** Message to be shown to the user if there's any SQL query problem. */
      public static final String DATABASE_EXCEPTION_MESSAGE; // Made with the 2 following ones.
      public static final String DATABASE_EXCEPTION = "DATABASE_EXCEPTION";
      public static final String MESSAGE = "MESSAGE";

      static {
        DATABASE_EXCEPTION_MESSAGE = DATABASE_EXCEPTION + MESSAGE; // It will be executed only once, during the class's [first] instantiation.
      } 
    ```

    }

4.  如果您的常量类太大，或者您认为它将来会增长太多，您可以将它划分为不同的类以获得不同的含义（再次，语义）：`ConstantDB`、、`ConstantNetwork`等等。

缺点：

1.  您团队的所有成员都必须使用相同的类和相同的常量命名法。在一个大型项目中，找到 2 个定义并不奇怪：

    ```
    public static final String DATABASE_EXCEPTION = "DATABASE_EXCEPTION";
    public static final String EXCEPTION_DATABASE = "DATABASE_EXCEPTION"; 
    ```

    分隔数百行或在不同的常量类中。甚至更糟：

    ```
    /** Indicates an exception during data retrieving, not during connection. */
    public static final String DATABASE_EXCEPTION = "DATABASE_EXCEPTION";
    /** Indicates an exception during data retrieving, not during connection. */
    public static final String EXCEPTION_DATABASE = "EXCEPTION_DATABASE"; 
    ```

    不同的标识符，用于不同的值，具有相同的含义（并用于相同的目的）。

2.  它可能会使可读性更差。为了做同样的事情，不得不写更多：

    ```
    if ("Y".equals(getOptionSelected()) { 
    ```

    对比

    ```
    if (ConstantsWebForm.YES.equals(getOptionSeleted()) { 
    ```

3.  类中的常量应该如何排序？按字母顺序？所有相关的常量在一起？为了创建/需要它们？谁应该对命令的正确性负责？任何（足够大的）常量重新排序都将被视为版本控制系统中的一团糟。

嗯，这比我预期的要长。欢迎任何帮助/批评。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-06-05T11:02:54.157

您应该创建一个常量类来存储所有常量。

像 ProjectNameConstants.java

它包含所有常量字符串静态，因为您可以通过类名访问它。

例如

```
classname :  MyAppConstants.java

public static final String MY_CONST="my const string val"; 
```

你可以访问它

```
MyAppConstants.MY_CONST 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-05T11:52:57.147

最佳实践是使用[Java Enum（Java 5 之后）](http://docs.oracle.com/javase/1.5.0/docs/guide/language/enums.html)

类方法的问题：

1.  不是类型安全的
2.  没有命名空间
3.  脆性

请检查 java 文档。

```
public enum Constants {

    CONSTANT_STRING1("CONSTANT_VALUE1"), 
    CONSTANT_STRING2("CONSTANT_VALUE2"), 
    CONSTANT_STRING3("CONSTANT_VALUE3");

    private String constants;

    private Constants(String cons) {
        this.constants = cons;
    }
} 
```

枚举可以用作常量。

**编辑：**你可以这样称呼`Constants.CONSTANT_STRING1`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-05T11:04:20.380

```
public class SomeClass {
    public static final String MY_CONST = "Some Value";
} 
```

如果它应该是一个纯常量类，那么也将构造函数设为私有。

```
public class Constants {
    public static final String CONST_1 = "Value 1";
    public static final int CONST_2 = 754;

    private Constants() {
    }
} 
```

那么就不可能实例化这个类。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-05T11:16:48.027

创建一个`Constants`在主包（即 com.yourcompany）的基础上调用的类，其中包含所有常量。还要将构造函数设为私有，这样就不会从此类创建对象：

```
public class Constants {

    private Constants() {
        // No need to create Constants objects
    }

    public static final String CONSTANT_ONE = "VALUE_CONSTANT_ONE";
    public static final String CONSTANT_TWO = "VALUE_CONSTANT_TWO";
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-05T11:11:55.803

您应该将常量分解为它们所属的组，例如最常使用它们的组，并将它们定义为这些类中的 public static final 。随着您的进行，拥有定义常量的接口似乎是合适的，但要抵制创建一个包含所有常量的单一接口的冲动。这不是好的设计。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-05-29T02:50:01.150

我想你正在寻找的正确答案是

```
import static com.package.YourConstantsClass.*; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-05T11:03:56.177

创建一个公共`class`并为每个常量字符串创建一个像这样的字段

`public static final String variableName = "string value";`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-06-29T15:17:12.977

```
public enum Constants {

CONSTANT_STRING1("CONSTANT_VALUE1"), 
CONSTANT_STRING2("CONSTANT_VALUE2"), 
CONSTANT_STRING3("CONSTANT_VALUE3");

private String constants;

private Constants(String cons) {
    this.constants = cons;
}
    @JsonValue
@Override
public String toString() {
    return constants;
} 
```

}

使用它 Constants.CONSTANT_STRING1.toString()

# data-structures - 表的数据结构？

> ID：10896119
> 
> 赞同：3
> 
> 时间：2012-06-05T11:02:15.353
> 
> 标签：data-structures, tabular

我需要创建一个多行多于两列的表。建议一个好的和快速的数据结构。我不会更新和删除该表中的一些条目。我将只使用查找函数。
例如，我有一张桌子：

```

   | 第 1 栏 | 第 2 栏 | 第 3 栏|
一个 | asd | 超频 | 亚足联 |
乙 | asgf | aasf | asgfc |

```

我有：

```
字符串 a = "第 1 列"
字符串 b = "b"
字符串 c = find(a,b);

```

最后 in 的值`c`应该是`asgf`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:06:04.260

您必须使用基于哈希表的关联数组（所谓的字典）。查找的平均时间复杂度——在最坏的情况下为 O(1 + n/k) 和 O(n)。您必须将表组织为列字典（以列名作为键）。并且 Column 必须是值的字典（以行名作为键）

更多信息：

[http://en.wikipedia.org/wiki/Dictionary_(data_structure](http://en.wikipedia.org/wiki/Dictionary_(data_structure) ) [http://en.wikipedia.org/wiki/Hash_table](http://en.wikipedia.org/wiki/Hash_table)

C# 中的示例：

```
using System;
using System.Collections;
using System.Collections.Generic;

namespace Test {
    public class Test
    {
        class Table {
            class Column {
                public Dictionary<string, string> cells;

                public Column() {
                    cells = new Dictionary<string, string>();
                }

                public string Find(string rowName) {
                    string resultValue;
                    if (cells.TryGetValue(rowName, out resultValue)) 
                        return resultValue;
                    else
                        throw new Exception("oops, no such cell");
                }
            }

            Dictionary<string, Column> columns;
            List<string> rowNames;

            public Table() {
                columns = new Dictionary<string, Column>();
                rowNames = new List<string>();
            }

            public void AddColumn(string columnName, params string[] values) {
                Column column = new Column();
                columns.Add(columnName, column);

                // fill new cells
                int counter = 0;
                foreach (string rowName in rowNames) {
                    if (counter < values.Length)
                        column.cells.Add(rowName, values[counter]);
                    else
                        column.cells.Add(rowName, "");
                    counter++;
                }
            }

            public void AddRow(string rowName, params string[] values) {
                rowNames.Add(rowName);

                // fill new cells
                int counter = 0;
                foreach (KeyValuePair<string, Column> columnPair in columns) {
                    Column column = columnPair.Value;
                    if (counter < values.Length)
                        column.cells.Add(rowName, values[counter]);
                    else
                        column.cells.Add(rowName, "");
                    counter++;
                }
            }

            public string Find(string columnName, string rowName) {
                Column resultColumn;
                if (columns.TryGetValue(columnName, out resultColumn))
                    return resultColumn.Find(rowName);
                else
                    throw new Exception("oops, no such cell");
            }
        }

        public static void Main()
        {
            Table table = new Table();
            table.AddRow("a");
            table.AddRow("b");
            table.AddColumn("column 1", "asd", "asgf");
            table.AddColumn("column 2", "awd", "aasf");
            table.AddColumn("column 3", "asfc", "asgfc");
            Console.WriteLine(table.Find("column 1", "b") );
        }
    }
} 
```

# javascript - jquery 检查是否单击了 div

> ID：10896121
> 
> 赞同：3
> 
> 时间：2012-06-05T11:02:27.353
> 
> 标签：javascript, jquery, click

我有以下html代码：

```
<div id="gridStage">
   <div id="point1" class="point rounded-corners">
   </div>
</div> 
```

#gridStage 是一个较大的 div，其中包含一个较小的 div #point。

**如果用户点击，我想调用一个正确的函数，如果用户点击任何地方而不是 on ，我想调用`#point`另一个错误的函数。`#gridStage``#point`**

**问题是当用户点击时`#point`，jQuery 也会检测到点击，`#gridStage`结果这两个函数都被调用，这不是必需的。**

目前我可以使用以下代码来做到这一点：

```
var pointClick=0;
$(".point").click(function() {
var pointClick=1;
    correct();
    setTimeout(function() {
       pointClick=0;
    },1000);
});
$("#gridStage").click(function() {
setTimeout(function() {
       if(pointClick===0) {
           wrong();
       }
    }, 500);
}); 
```

但我知道**这是一种低效的方式**，那么还有其他好的解决方案吗？

**注意：**我想要做的就是我有一个网格作为图像，然后我在它上面覆盖一个 div 并且我想检测用户是否点击了正确的点，为此我在正确的点上放置了一个 div覆盖网格的顶部，现在我必须检测他的点击是否在正确的点上。因此，如果您对此有更好的布局，除了我使用的上述布局，您可以自由提出建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T11:04:21.943

您需要停止传播。

```
$(".point").click(function(e) {
    correct();
    e.stopPropagation();
});
$("#gridStage").click(function() {
    wrong();
}); 
```

（注意`e`行上的参数`$(".point").click(function(e) {`和`e.stopPropagation();`）

# maven - 将 perf4J 与 maven 和 logback 集成

> ID：10896132
> 
> 赞同：1
> 
> 时间：2012-06-05T11:03:19.157
> 
> 标签：maven, aspectj, slf4j, logback, perf4j

我在现有的 Maven 应用程序中集成 perf4j 时遇到问题。
我尝试了几种方法，但似乎都没有奏效，所以我想知道是否有人对这是如何完成的有一些了解。
我想要做的是在某些方法上使用 perf4j 的 AOP 部分，并将它们记录到与用于应用程序日志记录的文件不同的文件中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T16:17:38.263

您可能遇到与另一个[perf4j/logback 相关问题中提到的相同的声明顺序问题](https://stackoverflow.com/questions/10850352/perf4j-settings-for-logback-xml)。简而言之，通过在元素中将属性设置为 true 来[启用 logback 的内部状态消息的打印总是一个好主意。](http://logback.qos.ch/manual/configuration.html#automaticStatusPrinting)也不要忘记[任何引用的附加程序必须事先声明](http://logback.qos.ch/codes.html#appender_order)。`debug``configuration`

# jquery - JQuery append 函数在按钮后追加按钮

> ID：10896136
> 
> 赞同：0
> 
> 时间：2012-06-05T11:03:36.413
> 
> 标签：jquery, jquery-ui, jquery-plugins

我在html中有一个按钮...

```
<div id=":ne" class="T-I J-J5-Ji ar7 nf T-I-ax7 L3" role="button" tabindex="0" aria-expanded="false" style="-webkit-user-select: none; " aria-haspopup="true"> <span class="Ykrj7b">More</span> </div> 
```

现在我想在这个按钮之后附加一个按钮。请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:05:08.123

```
var button = $("<button>Hi there</button>");

   $(button).insertAfter('#:ne'); 
```

或者

```
$('#:ne').after(button); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:08:03.293

尝试

```
$('#:ne').after('Your button code here'); 
```

# django - 将整数字段解析为整数值

> ID：10896138
> 
> 赞同：1
> 
> 时间：2012-06-05T11:03:40.550
> 
> 标签：django, django-models

我正在寻找一种方法来解析 integerFields 的值并返回该值。

```
scoreChans = models.IntegerField(0)
scoreChansSet = models.BooleanField(False)
scoreYatzy = models.IntegerField(0)
scoreYatzySet = models.BooleanField(False) 

scoreTotal = scoreChans + scoreYatzy 
```

但这给出了：TypeError：+ 不支持的操作数类型：'IntegerField' 和 'IntegerField'

有没有办法从这些字段中获取值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:06:55.610

您只能获取实例化模型上的值。

我假设你想要一个计算属性？就像是：

```
class MyModel(models.Model):
    score_a = models.IntegerField()
    score_b = models.IntegerField()

    @property
    def total_score(self):
        return self.score_a + self.score_b 
```

# ruby-on-rails-3 - 在 Rails 3.0.9 中访问嵌套资源中的父范围

> ID：10896139
> 
> 赞同：1
> 
> 时间：2012-06-05T11:03:45.757
> 
> 标签：ruby-on-rails-3

我有一个带有嵌套资源的机器模型，称为测试。直线加速器 has_many 测试。测试模型有一个名为“基线”的布尔属性。我还有一个名为 Baselines 的嵌套资源，它没有模型。它旨在汇总“基线”设置为“真”的那台机器的所有最新测试。

在我的机器模型中，我有一个名为 energy_x 的范围

```
class Machine < ActiveRecord::Base      
scope :energy_x, lambda { |x| where(:energy => x) } 
```

在我的基线控制器中，我可以成功访问这个命名范围：

```
 @energies.each do |energy|    
        @baseline_tests << machine.baseline_tests.energy_x(energy)
      end 
```

但是如果我尝试在视图中访问这个范围，

```
<%= render :partial => "baseline_test", :collection => @baseline_tests.energy_x(energy)  %> 
```

我得到一个未定义的方法错误：

```
 undefined method `energy_x' for #<Array:0x007f9da7686950> 
```

我听说无论如何我都不应该在视图中使用范围，但我需要一种方法来根据参数对集合 @baseline_tests 进行排序。这个参数的值有无限的选项，所以在控制器中创建一个名为@baseline_tests_1 和@baseline_tests_2 的实例变量是没有意义的。我认为它必须在视图中循环完成。

有什么建议么？

# c# - windows phone 7 中的自动完成功能

> ID：10896145
> 
> 赞同：0
> 
> 时间：2012-06-05T11:04:05.610
> 
> 标签：c#, windows-phone-7, xaml, autocomplete, silverlight-toolkit

我`Listbox`的 WP7 页面中有这样的

```
 <ListBox Name="lstSelectedNumber" Height="50" MaxHeight="120" VerticalAlignment="Top" Grid.Column="1" SelectionChanged="lstSelectedNumber_SelectionChanged">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="Padding" Value="-15" />
                                <Setter Property="Margin" Value="0"/>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <toolkit:WrapPanel>
                                </toolkit:WrapPanel>
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <toolkit:AutoCompleteBox x:Name="acBox" FilterMode="StartsWith" ValueMemberBinding="{Binding Name,Mode=TwoWay}">
                                    <toolkit:AutoCompleteBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="{Binding Image}" Stretch="None" Margin="0,0,5,5"/>
                                                <TextBlock Text="{Binding Name}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </toolkit:AutoCompleteBox.ItemTemplate>
                                </toolkit:AutoCompleteBox>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox> 
```

我`Listbox`的已附加到我的收藏`List<SampleData>`

喜欢`lstSelectedNumber.itemsource = List<SampleData>;`

对于我的自动完成框，我想将我的自动完成框绑定到其他集合列表，因此当用户在我的文本框中键入时，它会向用户显示建议，一旦用户选择任何项目，它就会将此项目添加到我的其他集合列表中我面临一个问题：如何将我的列表绑定到列表框中的自动完成框，以便我可以进行进一步的处理？

**更新**

我试图以这种方式找到我的列表框控件，但它总是为孩子们返回 0

```
 private void SearchVisualTree(DependencyObject targetElement)
        {
            var count = VisualTreeHelper.GetChildrenCount(targetElement);
            if (count == 0)
                return;

            for (int i = 0; i < count; i++)
            {
                var child = VisualTreeHelper.GetChild(targetElement, i);
                if (child is AutoCompleteBox)
                {
                    AutoCompleteBox myItems = (AutoCompleteBox)child;

                    if (myItems.Name == "acBox")
                    {
                       // My Logic
                        return;
                    }
                }
                else
                {
                    SearchVisualTree(child);
                }
            }
        } 
```

并以这种方式调用我的页面构造函数

```
SearchVisualTree(this.lstSelectedNumber); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:12:31.553

```
 List<WP7Phone> data = new List<WP7Phone>();

            foreach (lines l in result)
            {
                WP7Phone w7 = new WP7Phone();

                w7.Name = l.line.TrimStart();

                w7.Image = "images/thump.jpg";

                msg.Add(w7);
            }

            this.autoCompleteBox1.ItemsSource = data;

   public class WP7Phone
 {
    public string Name
  {
    get;
    set;
}
public string Image1
{
    get;
    set;
} 
```

}

# java - java.sql.SQLException 参数索引超出范围（1 > 参数个数，即 0）

> ID：10896151
> 
> 赞同：39
> 
> 时间：2012-06-05T11:04:20.090
> 
> 标签：java, mysql, jdbc

在验证了我选择的选择组合框后，我无法将其插入我的数据库中。Tomcat给出以下错误：

> java.sql.SQLException：参数索引超出范围（1 > 参数个数，即 0）。

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-06-05T13:59:42.600

当您调用 上的任何`setXxx()`方法时，您将收到此错误`PreparedStatement`，而 SQL 查询字符串没有任何占位符`?`。

例如这是*错误*的：

```
String sql = "INSERT INTO tablename (col1, col2, col3) VALUES (val1, val2, val3)";
// ...

preparedStatement = connection.prepareStatement(sql);
preparedStatement.setString(1, val1); // Fail.
preparedStatement.setString(2, val2);
preparedStatement.setString(3, val3); 
```

您需要相应地修复 SQL 查询字符串以指定占位符。

```
String sql = "INSERT INTO tablename (col1, col2, col3) VALUES (?, ?, ?)";
// ...

preparedStatement = connection.prepareStatement(sql);
preparedStatement.setString(1, val1);
preparedStatement.setString(2, val2);
preparedStatement.setString(3, val3); 
```

请注意参数索引以开头，`1`并且您不需要**像**这样引用这些占位符：

```
String sql = "INSERT INTO tablename (col1, col2, col3) VALUES ('?', '?', '?')"; 
```

否则，您仍然会得到相同的异常，因为 SQL 解析器会将它们解释为实际的字符串值，因此无法再找到占位符。

### 也可以看看：

*   [JDBC 教程 - 准备好的语句](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-19T06:21:27.477

这是 jdbc 驱动程序版本的问题。我在使用 mysql-connector-java-commercial-5.0.3-bin.jar 时遇到了这个问题，但是当我更改为更高的驱动程序版本 mysql-connector-java-5.1.22.jar 时，问题得到了解决。

# ruby-on-rails-3 - Formtastic 组输入

> ID：10896156
> 
> 赞同：0
> 
> 时间：2012-06-05T11:05:00.510
> 
> 标签：ruby-on-rails-3, formtastic

有没有办法将输入分组在一个标签下并内联显示？为了避免这样的事情：

```
.input.optional
  = form.label :price
  .input
    = form.text_field :price
    = form.select :currency 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T11:06:23.653

在 Formtastic 中没有任何内容，但是您可以通过一个接一个地使用两个标准 Formtastic 输入并将它们设置为“内联”来实现相同的视觉效果。这意味着您可能希望将它们包装在包含字段集中，使它们相互浮动，并在视觉上隐藏一个或两个标签。

# android - 在android xml中端到端添加两个textview

> ID：10896157
> 
> 赞同：2
> 
> 时间：2012-06-05T11:05:03.553
> 
> 标签：android, textview

我想在另一个文本视图的末尾添加一个文本视图，即不在下一行，而是在前一个文本视图结束的地方，在 xml 文件中。就像：

```
| <TextView1><TextView2>    |

| aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabbb    | 
```

我的 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" 
        android:ellipsize="none"/>

    <TextView
        android:id="@+id/date"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="bbb" />

</LinearLayout> 
```

但未显示文本“bbb”。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:09:20.233

这是因为您没有提供`android:ellipsize="none"`任何内容，并向 textView 提供了很长的文本。

只需提供`android:ellipsize="end"`，您将能够看到第二个 textView。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:09:52.537

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/textView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" 
    android:ellipsize="none"/>

<TextView
    android:id="@+id/date"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="bbb" />

 </LinearLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:47:45.533

使用RelativeLayout 并让您的“aaaa ...”文本视图与“bbb”文本视图的左侧对齐。如果您想要多行，您可以删除`maxLines`或将其设置为其他值。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_toLeftOf="@+id/date"
        android:ellipsize="none"
        android:maxLines="1"
        android:text="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" />

    <TextView
        android:id="@+id/date"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/textView"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:text="bbb" />

</RelativeLayout> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T11:07:15.360

使用重量总和......

我已经提供了 50% 的空间，您可以根据您的要求进行更改.......

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="horizontal" 
        android:weightSum="1">

        <TextView
            android:id="@+id/textView"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:text="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" 
            android:ellipsize="none"
            android:layout_weight=".5"/>

        <TextView
            android:id="@+id/date"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:text="bbb"
            android:layout_weight=".5" />

    </LinearLayout> 
```

根据要求......

```
<?xml version="1.0" encoding="utf-8"?>
<HorizontalScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" 
    >

    <TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" 
        android:ellipsize="none"
        />

    <TextView
        android:id="@+id/date"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="bbb"
        android:layout_alignRight="@id/textView"
         />

</LinearLayout>
</HorizontalScrollView> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T11:08:50.397

使用以下。

```
<?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="horizontal" >

        <TextView
            android:id="@+id/textView"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:ellipsize="none"
            android:text="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            />

        <TextView
            android:id="@+id/date"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="bbb" />

    </LinearLayout> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-07T23:08:51.370

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent" 
    android:gravity="fill">
    <TextView android:id="@+id/textView" 
        android:text="bbb"             
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"
        android:singleLine="true" 
        android:layout_alignParentRight="true" />
    <TextView android:id="@+id/date" 
        android:text="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"             
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@id/textView"
        android:singleLine="true" 
        android:ellipsize="none"  />   
</RelativeLayout> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-20T08:59:12.973

很简单，使用一个 textView 并在您的 cod 使用`append`方法中，并在您的第二个文本之前添加一些空格 :)

# jsf-2 - 如何用 JSF 2.0 替换 JSF 1.2

> ID：10896161
> 
> 赞同：0
> 
> 时间：2012-06-05T11:05:14.023
> 
> 标签：jsf-2, jsf-1.2

我有一个应用程序，在 JSF 1.2 上制作的完整应用程序。现在我们在其中添加模块。我可以用 JSF 2.0 替换 JSF 1.2 吗？意味着只有新模块使用 JSF 2.0，其余应用程序不受更改影响？意味着 JSF 2.0 与 JSF 1.2 完全兼容。就像我在 netbeans 中打开项目并在项目中添加 JSF 2.0 jar 并删除 JSF 1.2 jar？我可以这样做吗？或者我应该将 JSF 1.2 用于新模块，因为应用程序是在 JSF 1.2 上制作的？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:15:10.020

有[一个非常好的线程](https://stackoverflow.com/questions/4441713/migrating-from-jsf-1-2-to-jsf-2-0)，他们将基本设置解释为更高级的设置以从 JSF 1.2 迁移到 JSF 2.0

# scala - 使用惰性集合处理大型 Scala 数据的 Scala 函数式方法

> ID：10896165
> 
> 赞同：4
> 
> 时间：2012-06-05T11:05:28.797
> 
> 标签：scala, memory, collections, lazy-evaluation, fasta

我正在尝试找出使用 scala 中的字符串来处理大量数据的高效内存和功能方法。我读过很多关于惰性集合的东西，也看过很多代码示例。但是，我一次又一次地遇到“超出 GC 开销”或“Java 堆空间”问题。

通常问题是我尝试构建一个惰性集合，但是当我将每个新元素附加到不断增长的集合时评估它（我现在没有任何其他方式来增量这样做）。当然，我可以尝试先初始化一个初始惰性集合，然后通过使用 map 左右应用资源关键计算来生成包含所需值的集合，但通常我只是不知道最终集合的确切大小先验地初始化该惰性集合。

也许您可以通过给我提示或解释如何改进以下代码作为示例来帮助我，该代码根据奇数序列对属于一个文件和偶数序列对属于一个文件的规则将 FASTA（以下定义）格式的文件拆分为两个单独的文件到另一个（“股线分离”）。“最”直接的方法是通过循环遍历行并通过打开的文件流打印到相应的文件中的命令方式（这当然效果很好）。但是，我只是不喜欢重新分配给包含标题和序列的变量的风格，因此下面的示例代码使用（尾）递归，我希望找到一种方法来维护类似的设计而不会遇到资源问题！

该示例非常适用于小文件，但是对于大约 500mb 左右的文件，代码将在标准 JVM 设置中失败。我确实想处理“任意”大小的文件，比如 10-20gb 左右。

```
val fileName = args(0)
val in = io.Source.fromFile(fileName) getLines

type itType = Iterator[String]
type sType = Stream[(String, String)]

def getFullSeqs(ite: itType) = {
    //val metaChar = ">"
    val HeadPatt = "(^>)(.+)" r
    val SeqPatt  = "([\\w\\W]+)" r
    @annotation.tailrec
    def rec(it: itType, out: sType = Stream[(String, String)]()): sType = 
        if (it hasNext) it next match  {
            case HeadPatt(_,header) =>
                // introduce new header-sequence pair
                rec(it, (header, "") #:: out)
            case SeqPatt(seq) =>
                val oldVal = out head
                // concat subsequences
                val newStream = (oldVal._1, oldVal._2 + seq) #:: out.tail    
                rec(it, newStream)
            case _ =>
                println("something went wrong my friend, oh oh oh!"); Stream[(String, String)]()                
        } else out
    rec(ite)    
}

def printStrands(seqs: sType) {
   import java.io.PrintWriter
   import java.io.File
   def printStrand(seqse: sType, strand: Int) {
        // only use sequences of one strand 
        val indices =  List.tabulate(seqs.size/2)(_*2 + strand - 1).view
        val p = new PrintWriter(new File(fileName + "." + strand))
        indices foreach { i =>
              p.print(">" + seqse(i)._1 + "\n" + seqse(i)._2 + "\n")
        }; p.close
       println("Done bro!")
   }
   List(1,2).par foreach (s => printStrand(seqs, s))
}

printStrands(getFullSeqs(in)) 
```

我提出了三个问题：

A）假设需要维护一个大型数据结构，该结构是通过处理您`getLines`在我的`getFullSeqs`方法中获得的初始迭代器获得的（注意 的不同大小`in`和输出`getFullSeqs`），因为需要重复对整个（！）数据进行转换，因为人们不知道在任何步骤中都需要哪一部分数据。我的例子可能不是最好的，但是怎么做呢？有可能吗？

B）当所需的数据结构不是天生懒惰的时候，比如说想要将这些`(header -> sequence)`对存储到 a 中`Map()`怎么办？你会把它包装在一个惰性集合中吗？

C）我构建流的实现可能会颠倒输入行的顺序。调用 reverse 时，将评估所有元素（在我的代码中，它们已经是，所以这是实际问题）。有没有办法以懒惰的方式“从后面”进行后期处理？我知道`reverseIterator`，但这已经是解决方案了吗，或者这实际上也不会首先评估所有元素（因为我需要在列表中调用它）？可以用 构造流`newVal #:: rec(...)`，但那样我会失去尾递归，不是吗？

所以我基本上需要的是将元素添加到集合中，而不是通过添加过程来评估。所以`lazy val elem = "test"; elem :: lazyCollection`不是我要找的。

编辑：我也尝试在`rec`.

非常感谢您的关注和时间，我非常感谢您的帮助（再次:)）。

///////////////////////////////////////// ///////////////////////////////////////// ///////////////////////////////////////// ///////////////

FASTA 被定义为由单个标题行分隔的一组顺序序列。标题定义为以“>”开头的行。标题下方的每一行都称为与标题相关的序列的一部分。当出现新标头时，序列结束。每个标题都是唯一的。例子：

>HEADER1
abcdefg
>HEADER2
hijklmn
opqrstu
>HEADER3
vwxyz
>HEADER4
zyxwv

因此，序列 2 是 seq 1 的两倍。我的程序会将该文件拆分为一个文件 A，其中包含

>HEADER1
abcdefg
>HEADER3
vwxyz

和第二个文件 B 包含

>HEADER2
hijklmn
opqrstu
>HEADER4
zyxwv

假设输入文件由偶数个头序列对组成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T12:00:09.620

使用非常大的数据结构的关键是只在内存中保存对执行所需的任何操作至关重要的数据。所以，在你的情况下，那就是

*   你的输入文件
*   你的两个输出文件
*   当前行文本

*就是*这样。在某些情况下，您可能需要存储信息，例如序列的长度；在这种情况下，您在第一遍中构建数据结构并在第二遍中使用它们。例如，假设您决定要编写三个文件：一个用于偶数记录，一个用于奇数记录，一个用于总长度小于 300 个核苷酸的条目。你会做这样的事情（警告 - 它编译但我从未运行过它，所以它可能实际上不起作用）：

```
final def findSizes(
  data: Iterator[String], sz: Map[String,Long] = Map(),
  currentName: String = "", currentSize: Long = 0
): Map[String,Long] = {
  def currentMap = if (currentName != "") sz + (currentName->currentSize) else sz
  if (!data.hasNext) currentMap
  else {
    val s = data.next
    if (s(0) == '>') findSizes(data, currentMap, s, 0)
    else findSizes(data, sz, currentName, currentSize + s.length)
  }
} 
```

然后，为了处理，您使用该地图并再次通过：

```
import java.io._
final def writeFiles(
  source: Iterator[String], targets: Array[PrintWriter],
  sizes: Map[String,Long], count: Int = -1, which: Int = 0
) {
  if (!source.hasNext) targets.foreach(_.close)
  else {
    val s = source.next
    if (s(0) == '>') {
      val w = if (sizes.get(s).exists(_ < 300)) 2 else (count+1)%2
      targets(w).println(s)
      writeFiles(source, targets, sizes, count+1, w)
    }
    else {
      targets(which).println(s)
      writeFiles(source, targets, sizes, count, which)
    }
  }
} 
```

然后，您使用`Source.fromFile(f).getLines()`两次来创建迭代器，一切就绪。 *编辑：从某种意义上说，这是关键步骤，因为这是您的“懒惰”收藏。但是，这并不重要，因为它不会立即读取所有内存（“懒惰”），而是因为它也不存储任何先前的字符串！*

更一般地说，Scala 无法帮助您仔细考虑您需要在内存中拥有哪些信息以及您可以根据需要从磁盘中获取哪些信息。惰性求值有时会有所帮助，但没有神奇的公式，因为您可以轻松地表达将所有数据以惰性方式存储在内存中的要求。Scala*不能*将您访问内存的命令秘密地解释为从磁盘中获取内容的指令。（好吧，除非您编写一个库来缓存磁盘中的结果，否则不会这样做。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T17:12:18.750

> 可以使用 newVal #:: rec(...) 构造流，但那样我会失去尾递归，不是吗？

实际上，没有。

所以，事情就是这样……用你现在的尾递归，你用值填充*所有*的。`Stream`是的，`Stream`是懒惰的，但是你正在计算所有的元素，剥去它的任何懒惰。

现在说你做`newVal #:: rec(...)`。你会失去尾递归吗？没有为什么？因为你没有递归。怎么会？嗯，`Stream`是懒惰的，所以它不会评估`rec(...)`。

这就是它的美妙之处。一旦你这样做，在第一次交互时返回，并且只在请求`getFullSeqs`时计算“递归” 。`printStrands`不幸的是，这不会按原样工作......

问题是你一直在修改`Stream`——这不是你使用`Stream`. 使用`Stream`，您总是附加到它。不要一直“重写” `Stream`.

现在，我可以轻松识别出其他三个问题`printStrands`。首先，它调用`size`，`seqs`这将导致整体`Stream`被处理，失去惰性。永远不要调用`size`. `Stream`其次，您调用`apply`，`seqse`通过索引访问它。永远不要调用`apply`( `Stream`or `List`) - 这是非常低效的。它是`O(n)`，这使您的内部循环`O(n^2)`- 是的，是输入文件中标题数量的二次方！最后，在整个执行过程中`printStrands`保持对 的引用，防止处理元素被垃圾回收。`seqs``printStrand`

所以，这是第一个近似值：

```
def inputStreams(fileName: String): (Stream[String], Stream[String]) = {
  val in = (io.Source fromFile fileName).getLines.toStream
  val SeqPatt = "^[^>]".r
  def demultiplex(s: Stream[String], skip: Boolean): Stream[String] = {
    if (s.isEmpty) Stream.empty
    else if (skip) demultiplex(s.tail dropWhile (SeqPatt findFirstIn _ nonEmpty), skip = false)
         else s.head #:: (s.tail takeWhile (SeqPatt findFirstIn _ nonEmpty)) #::: demultiplex(s.tail dropWhile (SeqPatt findFirstIn _ nonEmpty), skip = true)
  }
  (demultiplex(in, skip = false), demultiplex(in, skip = true))
} 
```

上面的问题，我展示代码只是为了进一步指导懒惰问题，是你这样做的那一刻：

```
val (a, b) = inputStreams(fileName) 
```

您将保留对两个流的头部的引用，以防止垃圾收集它们。您无法保留对它们的引用，因此您必须在获得它们后立即使用它们，而无需将它们存储在“val”或“lazy val”中。“var”可能会，但处理起来会很棘手。所以让我们试试这个：

```
def inputStreams(fileName: String): Vector[Stream[String]] = {
  val in = (io.Source fromFile fileName).getLines.toStream
  val SeqPatt = "^[^>]".r
  def demultiplex(s: Stream[String], skip: Boolean): Stream[String] = {
    if (s.isEmpty) Stream.empty
    else if (skip) demultiplex(s.tail dropWhile (SeqPatt findFirstIn _ nonEmpty), skip = false)
         else s.head #:: (s.tail takeWhile (SeqPatt findFirstIn _ nonEmpty)) #::: demultiplex(s.tail dropWhile (SeqPatt findFirstIn _ nonEmpty), skip = true)
  }
  Vector(demultiplex(in, skip = false), demultiplex(in, skip = true))
}

inputStreams(fileName).zipWithIndex.par.foreach { 
  case (stream, strand) => 
    val p = new PrintWriter(new File("FASTA" + "." + strand))
    stream foreach p.println
    p.close
} 
```

这仍然行不通，因为`stream`inside`inputStreams`用作参考，即使在打印时也将整个流保留在内存中。

那么，再次失败，我有什么建议？把事情简单化。

```
def in = (scala.io.Source fromFile fileName).getLines.toStream
def inputStream(in: Stream[String], strand: Int = 1): Stream[(String, Int)] = {
  if (in.isEmpty) Stream.empty
  else if (in.head startsWith ">") (in.head, 1 - strand) #:: inputStream(in.tail, 1 - strand)
       else                        (in.head, strand) #:: inputStream(in.tail, strand)
}
val printers = Array.tabulate(2)(i => new PrintWriter(new File("FASTA" + "." + i)))
inputStream(in) foreach {
  case (line, strand) => printers(strand) println line
}
printers foreach (_.close) 
```

现在，这将不再保留在内存中而不是必要的。但是，我仍然认为它太复杂了。这可以像这样更容易地完成：

```
def in = (scala.io.Source fromFile fileName).getLines
val printers = Array.tabulate(2)(i => new PrintWriter(new File("FASTA" + "." + i)))
def printStrands(in: Iterator[String], strand: Int = 1) {
  if (in.hasNext) {
    val next = in.next
    if (next startsWith ">") { 
      printers(1 - strand).println(next)
      printStrands(in, 1 - strand)
    } else {
      printers(strand).println(next)
      printStrands(in, strand)
    }
  }
}
printStrands(in)
printers foreach (_.close) 
```

或者只是使用`while`循环而不是递归。

现在，对于其他问题：

B）在阅读时这样做可能很有意义，这样您就不必保留数据的*两个*副本： the`Map`和 a `Seq`。

C) 不要反转`Stream`a——你会失去它所有的懒惰。

# javascript - 如何在动态表中附加 CSS 值

> ID：10896166
> 
> 赞同：0
> 
> 时间：2012-06-05T11:05:29.497
> 
> 标签：javascript, gwt

我正在使用 GWT 表，它是动态生成的，有很多列，但没有水平滚动条，为了获得滚动条，我们需要在表周围具有固定宽度的包装器，但 GWT 确实创建了容器，但没有添加任何宽度。

为了解决这个问题，我正在计算屏幕的宽度并将其添加到表格包装器中，它正在向表格添加滚动条，但工作很奇怪。

1.  当我将鼠标移到桌子附近时，它会添加滚动条
2.  调整表格大小时不起作用

我正在使用`Live()`它，因为它适用于运行时对象，我也不能使用点击事件。

这是代码：

```
$(function() {
    var screenwidth = $(window).width();
    $('body').live("mouseover", function() {
        $('.scrollbar').css({
            'width' : (screenwidth) - 40
        });
        $("body").unbind("mouseover");
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:09:47.000

1.  使用 $('body').on("mouseover") 如果你得到滚动条，你可以通过将溢出设置为无来处理。如果您需要动态更改 css，您可以添加/删除类并将 css 与您的代码分开。这是一个很好的做法。

# node.js - Nowjs：在托管服务器上运行节点和 nowjs - 错误：超出最大调用堆栈大小

> ID：10896167
> 
> 赞同：0
> 
> 时间：2012-06-05T11:05:42.553
> 
> 标签：node.js, nowjs-sockets

你好堆垛机。

我正在我正在开发的网站上实现 node.js 和 nowjs。几周前，我开始在 localhost 上开发该网站，一切正常。几天前，我将文件传输到了 rackspace 托管的云服务器，操作系统为 Ubuntu 12.04 LTS（Precise Pangolin）。

现在我无法让 nowjs 主页上的简单聊天示例正常工作！当我尝试运行服务器端脚本时，我不断收到以下错误：

**[RangeError: 超出最大调用堆栈大小]**

我的代码中没有递归循环，我尝试在整个互联网上寻找我的问题的解决方案，但没有运气。

这是我的两个示例文件 - 来自 nowjs 官方网站上的 chat/helloworld 示例的 ac/p。（http://nowjs.com/doc/example）

**服务器.js**

```
var html = require('fs').readFileSync(__dirname+'/helloworld.html');
var server = require('http').createServer(function(req, res){
  res.end(html);
});
server.listen(8080);

var nowjs = require("now");
var everyone = nowjs.initialize(server);

everyone.now.distributeMessage = function(message){
  everyone.now.receiveMessage(this.now.name, message);
}; 
```

**helloworld.html**

```
<!DOCTYPE html>
<html lang="en">
<head>
<title>nowjs test</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="/nowjs/now.js"></script>

<script>
$(document).ready(function(){

  now.receiveMessage = function(name, message){
    $("#messages").append("<br>" + name + ": " + message);
  }

  $("#send-button").click(function(){
    now.distributeMessage($("#text-input").val());
    $("#text-input").val("");
  });

  now.name = prompt("What's your name?", "");

});
</script>
</head>

<body>
  <div id="messages"></div>
  <input type="text" id="text-input">
  <input type="button" value="Send" id="send-button">
</body>
</html> 
```

我的问题：

1.  有没有人在托管的 Web 服务器上运行 nowjs 时遇到同样的问题？
2.  在托管 Web 服务器上运行 nowjs 时，是否有任何我可能不知道的依赖项？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:29:28.950

我终于解决了这个问题。所需要的只是使用最新的稳定版本（v0.4.12）重新安装节点。

# jquery - 在 jQuery 对话框中将函数作为参数传递

> ID：10896170
> 
> 赞同：0
> 
> 时间：2012-06-05T11:05:49.840
> 
> 标签：jquery, dialog

我想通过调用函数在此对话框中创建一个带有按钮功能的对话框。但它不起作用。
我下面的代码//函数初始对话框

```
function inti_dlg(selector, autoOpen, height, width, modal, num_button, fn_apply, fn_cancel, fn_close)
    {
        if (num_button>1)
        {
            selector.dialog({
                autoOpen: autoOpen,
                height:height,
                width:width,
                modal:modal,
                buttons:{
                    Apply:function(){fn_apply},
                    Cancel:function(){fn_cancel}
                },
                close:function(){fn_close}
            });
        }
        else{
            selector.dialog({
                autoOpen: autoOpen,
                height:height,
                width:width,
                modal:modal,
                buttons:{
                    Apply:function(){fn_apply}
                },
                close:function(){fn_close}
            });
        }
    } 
```

//函数abc

```
function abc()
{
    alert("abc");
} 
```

// 调用初始对话框函数

```
$(function (){
    inti_dlg($('#cde'), false, 440, 480, true, 1, abc(), '', abc());
    $('#clickhere').click(function(){$('#cde').dialog('open');});
}); 
```

网页：

```
<div id="clickhere">Click here</div>
<div id="cde">
     <div>Test : pass argument as a function</div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:01:13.407

[http://devlicio.us/blogs/sergio_pereira/archive/2009/02/09/javascript-5-ways-to-call-a-function.aspx](http://devlicio.us/blogs/sergio_pereira/archive/2009/02/09/javascript-5-ways-to-call-a-function.aspx)

利用

`Function.apply()`

`Function.call()`

调用作为参数传递的函数。并且您不需要添加括号以及函数名称作为参数传递。只需传递函数名称。

```
function inti_dlg(selector, autoOpen, height, width, modal, num_button, fn_apply, fn_cancel, fn_close)
{
    if (num_button>1)
    {
        selector.dialog({
            autoOpen: autoOpen,
            height:height,
            width:width,
            modal:modal,
            buttons:{
                Apply:function(){fn_apply.apply()},
                Cancel:function(){fn_cancel.apply()}
            },
            close:function(){fn_close.apply()}
        });
    }
    else{
        selector.dialog({
            autoOpen: autoOpen,
            height:height,
            width:width,
            modal:modal,
            buttons:{
                Apply:function(){fn_apply.apply()}
            },
            close:function(){fn_close.apply()}
        });
    }
} 
```

并调用这个

```
$(function (){
inti_dlg($('#cde'), false, 440, 480, true, 1, abc, '', abc);
$('#clickhere').click(function(){$('#cde').dialog('open');});
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T05:39:59.977

您实际上是在执行该函数，而不是错误地传递它。为了传递函数并清楚地表明发生了什么，我建议执行以下操作：

```
var abc = function ()
{
    alert("abc");
}

$(function (){
    inti_dlg($('#cde'), false, 440, 480, true, 1, abc, '', abc);
    $('#clickhere').click(function(){$('#cde').dialog('open');});
}); 
```

然后，当您在“inti_dlg”内时，不要对“fn_apply、fn_cancel 或 fn_close”做任何事情。您想将未触及的函数传递到 jQuery 对话框中以便在那里执行。

一开始可能很难掌握，但为了有效地使用 JavaScript，您可能需要根据您习惯的语言调整您对“函数”的理解。由于 JavaScript 是一种函数式语言（或多或少），因此函数是一等公民，可以像任何其他变量（如字符串或 int）一样传递，然后通过将 () 附加到函数变量名（并传入函数的任何参数）

# python - SQLAlchemy + postgres：（InternalError）当前事务被中止，命令被忽略直到事务块结束

> ID：10896173
> 
> 赞同：1
> 
> 时间：2012-06-05T11:06:27.260
> 
> 标签：python, postgresql, sqlalchemy

我正在尝试保存一组父/子记录，并且我想将插入包装在事务中。我将 SQLAlchemy 与 postgresql 8.4 一起使用。

这是我的代码片段：

```
def insert_data(parent, child_rows):
    # Start a transaction
    conn = _get_connection()
    tran = conn.begin()

    try:
        sql = get_sql_from_parent(parent)
        res = conn.execute(sql)  # <- Code barfs at this line
        item = res.fetchone() if res else None
        parent_id = item['id'] if ((item) and ('id' in item)) else -1

        if parent_id == -1:
            raise Exception('Parent could not be saved in database')

        # Import children
        for child in child_rows:
            child_sql = get_child_sql(parent_id, child)                        
            conn.execute(child_sql)

        tran.commit()

    except IntegrityError:
        pass  # rollback?

    except Exception as e:
        tran.rollback()
        print "Exception in user code:"
        print '-'*60
        traceback.print_exc(file=sys.stdout)
        print '-'*60 
```

当我调用该函数时，我得到以下堆栈跟踪：

```
Traceback (most recent call last):
  File "import_data.py", line 125, in <module>
    res = conn.execute(sql)
  File "/usr/local/lib/python2.6/dist-packages/SQLAlchemy-0.7.4-py2.6-linux-x86_64.egg/sqlalchemy/engine/base.py", line 1405, in execute
    params)
  File "/usr/local/lib/python2.6/dist-packages/SQLAlchemy-0.7.4-py2.6-linux-x86_64.egg/sqlalchemy/engine/base.py", line 1582, in _execute_text
    statement, parameters
  File "/usr/local/lib/python2.6/dist-packages/SQLAlchemy-0.7.4-py2.6-linux-x86_64.egg/sqlalchemy/engine/base.py", line 1646, in _execute_context
    context)
  File "/usr/local/lib/python2.6/dist-packages/SQLAlchemy-0.7.4-py2.6-linux-x86_64.egg/sqlalchemy/engine/base.py", line 1639, in _execute_context
    context)
  File "/usr/local/lib/python2.6/dist-packages/SQLAlchemy-0.7.4-py2.6-linux-x86_64.egg/sqlalchemy/engine/default.py", line 330, in do_execute
    cursor.execute(statement, parameters)
InternalError: (InternalError) current transaction is aborted, commands ignored until end of transaction block
... 
```

有谁知道我为什么会收到这个神秘的错误 - 我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:53:32.527

您可以在 postgresql 上激活日志查询吗？（在 postgresql.conf 中将 min_duration 设置为 0 然后重新启动）。

然后查看您的 postgresql 日志以对其进行调试。

# proxy - 使用 HAProxy 对到 Tornado 应用程序的 WebSocket 连接进行负载平衡？

> ID：10896175
> 
> 赞同：4
> 
> 时间：2012-06-05T11:06:32.820
> 
> 标签：proxy, nginx, websocket, tornado, haproxy

我正在开发一个使用 websocket 处理程序的 Tornado 应用程序。我正在使用 Supervisord 运行该应用程序的多个实例，但在负载平衡 websocket 连接时遇到了问题。

我知道 nginx 不支持开箱即用的 websockets 处理，但我按照[http://www.letseehere.com/reverse-proxy-web-sockets](http://www.letseehere.com/reverse-proxy-web-sockets)此处的说明使用 nginx tcp_proxy 模块来反向代理 websocket 连接。但是，这不起作用，因为模块无法路由 websocket url（例如：ws://localhost:80/something）。所以它不适用于我在 Tornado 应用程序中定义的 URL 路由。

从我对网络的研究来看，HAProxy 似乎是对我的 websocket 连接进行负载平衡的方法。但是，我无法找到任何体面的指导来设置 HAProxy 以负载平衡 websocket 连接并且还能够处理 websocket URL 路由。

我真的很感激一些关于如何做到这一点的详细指导。我也对其他解决方案完全开放。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T21:49:11.820

在 haproxy 中实现 WebSocket 并不难，尽管我承认在这方面找到文档并不容易（希望这个响应会成为一个例子）。如果您使用的是 haproxy 1.4（我想您是），那么它就像任何其他 HTTP 请求一样工作，无需执行任何操作，因为 HTTP 升级已被 haproxy 识别。

如果您想将 WebSocket 流量定向到与 HTTP 的其余部分不同的场，那么您应该使用内容切换规则，简而言之：

```
前端 pub-srv
    绑定：80
    use_backend websocket if { hdr(Upgrade) -i WebSocket }
    default_backend http

 后端网络套接字
    服务器超时 600s
    服务器节点1 1.1.1.1:8080 检查
    服务器节点2 2.2.2.2:8080 检查

 后端http
    服务器超时 30s
    服务器 www1 1.1.1.1:80 检查
    服务器 www2 2.2.2.2:80 检查

```

如果您使用的是 1.5-dev，您甚至可以指定“超时隧道”以使 WS 连接的超时时间大于普通 HTTP 连接的超时时间，从而避免在客户端使用过长的超时时间。

您还可以结合 Upgrade: WebSocket + 一个特定的 URL ：

```
前端 pub-srv
    绑定：80
    acl is_websocket hdr(升级) -i WebSocket
    acl is_ws_url 路径 /something1 /something2 /something3
    use_backend websocket if is_websocket is_ws_url
    default_backend http

```

最后，请不要使用我们有时看到的愚蠢的 24 小时空闲超时，现在等待客户端 24 小时建立会话绝对没有意义。与 80 年代相比，网络移动性更强，连接也非常短暂。你最终会得到许多 FIN_WAIT 套接字。10 分钟对于当前的互联网来说已经相当长了。

希望这会有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T14:30:45.163

WebSockets 不能很好地遍历代理，因为**在**握手之后它们没有遵循正常的 HTTP 行为。

尝试使用 WebSocket (wss://) 协议（安全 WS）。这将使用 Proxy CONNECT API，它将隐藏 WebSocket 协议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T15:53:12.247

我使用[https://launchpad.net/txloadbalancer](https://launchpad.net/txloadbalancer)使用 Tornado websocket 处理程序进行负载平衡。这很简单而且效果很好（我认为）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-07T10:21:18.850

# http nginx（仅 nginx v1.3+）

```
upstream chatservice {
    #multi thread by tornado
    server 127.0.0.1:6661;
    server 127.0.0.1:6662;
    server 127.0.0.1:6663;
    server 127.0.0.1:6664;
}
map $http_upgrade $connection_upgrade {
    default upgrade;
    ''      close;
} 
```

# 虚拟主机

```
server {
    listen 80;
    server_name chat.domain.com;
    root /home/duchat/www;
    index index.html index.htm;

    location / {
            try_files $uri $uri/ @backend;
    }
    location @backend {
            proxy_pass_header Server;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header Host $host;
            proxy_pass http://chatservice;
            internal;
} 
```

# winforms - 如何使用 C# 从 excel 填充列表框

> ID：10896178
> 
> 赞同：1
> 
> 时间：2012-06-05T11:06:42.703
> 
> 标签：winforms, excel, import-from-excel

我有一个 Windows 应用程序。我浏览文件并使用 OpenFileDialog 控件选择 excel 文件。excel 文件在 A 列中包含电子邮件 ID。我想用 excel 文件列值填充列表框。我的机器上安装了 Office 2003。有人可以帮我吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:18:39.160

参考：[从 C# 读取 Excel 文件](https://stackoverflow.com/questions/15828/reading-excel-files-from-c-sharp)

要连接到 excel 文件，您需要适当的连接字符串：

```
string connString = @"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=<YourExcelPath>;
Extended Properties=\"Excel 12.0;HDR=YES;\""; 
```

使用 OleDb 类从文件中查询信息后：

```
string selectCmd = "SELECT * FROM <SheetName>";

using(OleDbConnection excelConn = new OleDbConnection(connString))
{
    excelConn.Open(); 
    OleDbCommand command = new OleDbCommand(selectCmd, excelConn);
    OleDbDataAdapter da = new OleDbDataAdapter(command);

    DataTable sheetInfo = new DataTable();
    dataAdapter.Fill(sheetInfo);

    //Do something with the data.
    Bind your control with this datatable here
} 
```

所以你需要用你的excel文件的路径替换“YourExcelPath”..

# jquery - jquery动画固定位置

> ID：10896182
> 
> 赞同：0
> 
> 时间：2012-06-05T11:06:53.177
> 
> 标签：jquery, animation

Bellow 是我的联系表单代码，当用户点击它时它会展开

```
$(document).bind('click',
            function() {
$('div#contactable_inner').animate({"marginLeft": "-=387px"}, "slow")
            }); 
```

每次点击，元素都会移动到 -387px。我希望它仅在第一次点击时移动 -387px。对于所有接下来的点击，它不应该动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:07:31.647

```
$(document).one('click',
            function() {
$('div#contactable_inner').animate({"marginLeft": "-=387px"}, "slow")
            }); 
```

`.one()`只触发一次。

阅读[`.one()`](http://api.jquery.com/one)

# html - 如何添加换行符

> ID：10896188
> 
> 赞同：0
> 
> 时间：2012-06-05T11:07:10.930
> 
> 标签：html, struts2

嗨，我正在使用 struts 2 UI。我想将行中的字符数限制为 16，并且我必须将最大长度限制为 32。我尝试了行和列属性。但它不起作用。我还必须限制 textarea 的大小调整。任何可能的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T13:49:10.317

也许你有错字？属性是“rows”和“cols”，而不是“row”和“column”。

以下应该有效：

```
<s:textarea key="yourDataField" cols="32" rows="16" resizable="false"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T14:00:55.000

这是一个很好的解释如何限制[文本区域的大小调整](http://css-tricks.com/textarea-tricks/)

```
<s:textarea cssStyle="resize: none;"></s:textarea> 
```

应该做的工作。

# ios - 选项卡式应用程序不会显示登录视图

> ID：10896191
> 
> 赞同：0
> 
> 时间：2012-06-05T11:07:20.730
> 
> 标签：ios, uitabbarcontroller

我在 Xcode 4.3 中有一个标签栏应用程序，我试图在显示标签栏之前插入一个登录屏幕。`presentModalViewController`如果有，该应用程序可以正常工作，`animated:YES`但如果没有动画，则视图不会显示。

```
@synthesize window = _window;

@synthesize tabBarController = _tabBarController;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    UIViewController *viewController1 = [[FirstViewController alloc] initWithNibName:@"FirstViewController" bundle:nil];
    UIViewController *viewController2 = [[SecondViewController alloc] initWithNibName:@"SecondViewController" bundle:nil];

    self.tabBarController = [[UITabBarController alloc] init];
    self.tabBarController.viewControllers = [NSArray arrayWithObjects:viewController1, viewController2, nil];
    self.window.rootViewController = self.tabBarController;

    LogInViewController *logViewController = [[LogInViewController alloc] initWithNibName:@"LogInViewController" bundle:nil];
    [self.window addSubview:_tabBarController.view];

    [self.tabBarController presentModalViewController:logViewController animated:YES];
    //This wont work
    //[self.tabBarController presentModalViewController:logViewController animated:NO];

    [self.window makeKeyAndVisible];
    return YES;

}

-(void)loginDone{

    NSLog(@"back to the app delegate");
   [self.tabBarController dismissModalViewControllerAnimated:YES];

} 
```

1.  这是正确的方法吗？
2.  为什么代码不能使用`animated:NO`？
3.  我也得到这个输出`Unbalanced calls to begin/end appearance transitions for <UITabBarController: 0x689d350>`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:36:05.577

首先，`[self.window makeKeyAndVisible];`在您的视图控制器设置之前移动。

此外，您应该在`viewWillAppear:`首先可见的视图控制器的方法中显示模态视图控制器，以确保您的应用程序视图层次结构在显示登录屏幕之前已完全初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:38:07.900

不要这样做：

```
[self.window addSubview:_tabBarController.view]; 
```

做这个：

```
self.window.rootViewController = _tabBarController; 
```

这将把 放在`tabBarController`屏幕上。但这并不是你想要的……我的建议是：

1）首先把`logViewController`上面`rootViewController`我展示给你的东西放在上面。

2）一旦你得到你想要的（登录成功），只需告诉 AppDelegate 切换`rootViewController`. 这可以通过委托或通知来完成。

此外，正如 Toastor 间接指出的那样，您应该从`UIViewController`实际启动它的人（而不是从 AppDelegate）启动 presentViewController。

# joomla - 如何从 joomla 的后端菜单中删除/隐藏某些组件？

> ID：10896196
> 
> 赞同：0
> 
> 时间：2012-06-05T11:07:43.623
> 
> 标签：joomla, components, hide, backend

我想为某些用户组在 Joomla 的后端隐藏一些组件。我想我应该从顶部菜单中删除它们。感谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T15:30:49.100

我***强烈***推荐[noixACL](http://extensions.joomla.org/extensions/access-a-security/site-access/backend-a-full-access-control/7010)。它在扩展/管理 Joomla 1.5 的 ACL 方面做得非常出色。我建议在推出之前彻底阅读安装和文档。我花了一点时间来“围绕它”，但它一直是我们拥有的所有 Joomla 网站最重要的补充之一。

# java - 如何将 JAXB 转换为 JSON？

> ID：10896199
> 
> 赞同：3
> 
> 时间：2012-06-05T11:07:55.153
> 
> 标签：java, json, web-services, rest, jaxb

我需要为返回 JAXB 对象的基于 XML 的 Web 服务创建 Web 服务前端。我的前端需要返回一个 RESTful 格式。有没有办法将其转换为 JSON？我的课程路径中有**jackson-mapper-asl**和**jackson-core-asl**。

作为一个简单的测试，我返回一个 Book 的 bean，它以 JSON 格式输出，但 JAXB 对象（交付计划）保持 XML 格式。

```
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;

@Controller
public class DSWLIClient {

    @Autowired
    private DeliveryScheduleWS wliService;
    private BookService bs;

    @RequestMapping(value = "/DSDetails/{ds-number}", method = RequestMethod.GET)
    public @ResponseBody
    DeliverySchedule getDSDetails(@PathVariable("ds-number") String dsNumber) {
        DeliveryScheduleResponse dsDetails = wliService.getDeliveryScheduleWSSoap().getDSDetails(dsNumber);
        DeliverySchedule deliverySchedule = dsDetails.getDeliverySchedule();
        return deliverySchedule;
    }

    @RequestMapping(value = "/BookDetails/{isbn-number}", method = RequestMethod.GET)
    public @ResponseBody
    Book getBookDetails(@PathVariable("isbn-number") String isbnNumber) {
        bs = new BookService();
        Book b = bs.getBookByIsbn(isbnNumber);
        System.out.println(b.getAuthor());
        return b;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T17:06:55.833

你能显示你的配置文件（XML 或类）吗？

我还将假设您使用的是 HttpMessageConverter ( [http://www.ibm.com/developerworks/web/library/wa-restful/](http://www.ibm.com/developerworks/web/library/wa-restful/) ) 类而不是 ContentNegotiatingViewResolver。

这很容易，大多数时候是因为我们忘记添加所需的配置“mvc:annotation-driven”

如果您使用内容协商视图，这个例子很棒[http://www.mkyong.com/spring-mvc/spring-3-mvc-contentnegotiatingviewresolver-example/](http://www.mkyong.com/spring-mvc/spring-3-mvc-contentnegotiatingviewresolver-example/)

# python - 在 Python 中阻塞子进程函数？

> ID：10896202
> 
> 赞同：1
> 
> 时间：2012-06-05T11:08:08.357
> 
> 标签：python, multiprocessing, blocking

我有一个异步函数被这样调用：

```
from multiprocessing import Process

def my_function(arg1, arg2):
    print 'Long process begins'

p = Process(target=my_function, args=(arg1, arg2,)).start() 
```

我怎样才能做到这一点？我需要在运行脚本的其余部分之前完成该过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:11:07.293

使用[p.join()](http://docs.python.org/library/multiprocessing.html#multiprocessing.Process.join)

> 阻塞调用线程，直到调用其 join() 方法的进程终止或直到发生可选超时。
> 
> 如果超时为无，则没有超时。
> 
> 一个进程可以多次加入。
> 
> 一个进程不能加入自己，因为这会导致死锁。在进程启动之前尝试加入进程是错误的。

# iphone - 将值从 UIViewController 传递给 UIView

> ID：10896206
> 
> 赞同：0
> 
> 时间：2012-06-05T11:08:12.160
> 
> 标签：iphone, ipad

我有以下 UIViewController 类：

文件：**ResultsDataViewController.h**

```
@interface ResultsDataViewController : UIViewController
@property (nonatomic, strong) NSString* name;
@end 
```

文件：**ResultsDataViewController.m**

```
#import "ResultsDataViewController.h"

@interface ResultsDataViewController ()
@end

@implementation ResultsDataViewController
@synthesize data; 
```

然后我有我的 UIView 类名 Plot.h/m

绘图.h：

```
@interface PlotGraph : UIView <CPTBarPlotDataSource, CPTBarPlotDelegate>
@property (nonatomic, strong) NSString* receivedName;
@end 
```

绘图.m：

```
#import "Plot.h"
@interface Plot()

@end

@implementation PlotGraph
@synthesize receivedName; 
```

...

=====

问题：

如何从我的 UIViewController 传递 name 的值并将其分配给我的 UIView 中的变量 receivedName？

UIView Plot 是我的 UIViewController DataViewController 中的一个视图

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:18:48.110

（注意：`@synthesize data;`在你的问题中可能是一个错字。我假设你的意思是`@synthesize name;`。另外，`@interface Plot()`应该是`@interface PlotGraph()`。）

首先，您需要引用一个`PlotGraph`对象作为您在代码中创建的东西或`IBOutlet`从您的 xib 文件或情节提要加载到变量中的东西。一旦你有了它，无论是在哪里创建它，还是在 中`viewDidLoad:`，它就像：

```
plotView.receivedName = self.name; 
```

# ios - 如何将 Nsdata 转换为无符号或有符号字节数组

> ID：10896207
> 
> 赞同：0
> 
> 时间：2012-06-05T11:08:18.997
> 
> 标签：ios

在我的应用程序中，我必须将字节数组（音频）上传到服务器。

但是现在我们正在获取 Nsdata。如何将此 Nsdata 转换为字节数组以将音频文件发布到服务器

谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:11:41.753

你可以使用[NSData](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSData_Class/Reference/Reference.html)`bytes`的方法；

```
NSUInteger len = [yourData length];
Byte *byteData = (Byte*)malloc(len);
memcpy(byteData, [yourData bytes], len); 
```

如果您的字节为空终止，您可以使用

```
NSString *content = [NSString stringWithUTF8String:[yourData bytes]]; 
```

如果不

```
NSString *content = [[NSString alloc]  initWithBytes:[yourData bytes]
          length:[yourData length] encoding: NSUTF8StringEncoding]; 
```

# php - 在线预订页面

> ID：10896209
> 
> 赞同：2
> 
> 时间：2012-06-05T11:08:20.803
> 
> 标签：php, javascript

我正在尝试为一个虚构的酒店创建一个网站，其中每个房间都有一个名称（“太阳房间”、“月亮房间”等）

我正在制作预订页面，但我应该如何使用以下代码从数据库中获取房间名称：

```
echo'<select id="roomname" name="roomname" size="1"> ';
{
    include("include/connect.php"); 
    $conn=mysql_connect($HOST, $USER, $PASSWORD);
    $db_ok=mysql_select_db($DB, $conn);
    $cam=mysql_query("select Name from room", $conn);
    $ncam=mysql_num_rows($cam);
    for ($i=0;$i<$ncam;$i++) {          
        $f=mysql_result($cam,$i,"Name");
        echo "<option>$f</option>";
    }
    mysql_close($conn);
}
echo '</select>'; 
```

选择房间后：预订页面必须向您显示表格的剩余部分，包括开始和结束日期（房间免费或出租的日期）以及有多少人入住该房间。

问题来了..在我选择房间后，我该如何管理以便网页向您显示其他选项，特别是加载可以占用房间的最大人数的“选择”？（有点像我用来加载房间名称的“选择”^^）

这里有一个例子：

```
echo'<select id="Npeople" name="Npeople" size="1"> ';
{
include("include/connect.php"); 
        $conn=mysql_connect($HOST, $USER, $PASSWORD);
        $db_ok=mysql_select_db($DB, $conn);
        $ris=mysql_query("select Nrmax from room where Name='<script type=text/javascript>document.booking.chamber.value</script>'", $conn);
        $ros=intval($ris);
        for ($o=0;$o<$ros;$o++) {    
        $u=mysql_result($ris,$o,"Nrmax"); 
    echo "<option>$u</option>";
        }
        mysql_close($conn);
}
echo '</select>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T06:23:19.323

我认为最好的方法是在您的 Select Statements 中订购房间。

SELECT * FROM `<tbl_rooms>`WHERE `<conditions here>`ORDER BY `<room_size>`DESC, `<room_price>`ASC

# python - Python：正确处理子命令的全局选项的参数解析器

> ID：10896211
> 
> 赞同：9
> 
> 时间：2012-06-05T11:08:26.120
> 
> 标签：python, parsing, command-line-arguments, argparse, subcommand

argparse 无法处理接收全局选项的子命令：

```
import argparse
p = argparse.ArgumentParser()
p.add_argument('--arg', action='store_true')
s = p.add_subparsers()
s.add_parser('test') 
```

将有`p.parse_args('--arg test'.split())`工作，
但在`p.parse_args('test --arg'.split())`.

有人知道python参数解析器可以正确处理子命令的全局选项吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-29T17:19:02.523

您可以轻松地将此参数添加到两个解析器（主解析器和子命令解析器）：

```
import argparse                                                                  

main = argparse.ArgumentParser()                                                    
subparser = main.add_subparsers().add_parser('test')                                        

for p in [main,subparser]:                                                                  
   p.add_argument('--arg', action='store_true')                                 

print main.parse_args('--arg test'.split()).arg                                     
print main.parse_args('test --arg'.split()).arg 
```

**编辑**：正如@hpaulj 在评论中指出的那样，还有一个`parents`参数可以传递给`ArgumentParser`构造函数或`add_parser`方法。您可以在此值解析器中列出作为新值解析器的基础。

```
import argparse

base = argparse.ArgumentParser(add_help=False)
base.add_argument('--arg', action='store_true')

main = argparse.ArgumentParser(parents=[base])
subparser = main.add_subparsers().add_parser('test', parents=[base])

print main.parse_args('--arg test'.split()).arg
print main.parse_args('test --arg'.split()).arg 
```

更多示例/文档：

[寻找在python中给出命令行参数的最佳方式，其中一些参数是某些选项的req，而一些参数是其他选项的req](https://stackoverflow.com/questions/18328557/looking-for-best-way-of-giving-command-line-arguments-in-python-where-some-para/18346152#18346152)

[Python argparse - 向多个子解析器添加参数](https://stackoverflow.com/questions/7498595/python-argparse-add-argument-to-multiple-subparsers)（我不确定这个问题是否与这个问题重叠太多）

[http://docs.python.org/dev/library/argparse.html#parents](http://docs.python.org/dev/library/argparse.html#parents)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T13:39:58.413

[试试 docopt](http://docopt.org)：

```
>>> from docopt import docopt

>>> usage = """
... usage: prog.py command [--test]
...        prog.py another [--test]
... 
... --test  Perform the test."""

>>> docopt(usage, argv='command --test')
{'--test': True,
 'another': False,
 'command': True}

>>> docopt(usage, argv='--test command')
{'--test': True,
 'another': False,
 'command': True} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-05T11:52:35.730

Python 世界中有大量的参数解析库。以下是我见过的一些，所有这些都应该能够解决您要解决的问题（基于我上次玩它们时对它们的模糊回忆）：

*   [opster](http://pypi.python.org/pypi/opster) —我认为这就是 mercurial 的用途，IIRC
*   [docopt——](http://www.docopt.org/en/latest/index.html)这个是新的，但使用了一种有趣的方法
*   [悬崖](http://readthedocs.org/docs/cliff/en/latest/)— 这是 Doug Hellmann（PSF 成员，virtualenvwrapper 作者，普通黑客非凡）的一个相对较新的项目，它不仅仅是一个参数解析器，而是从头开始设计用于处理多级命令
*   [clint](http://pypi.python.org/pypi/clint/) — 另一个旨在成为“参数解析和更多”的项目，这个项目是由 Kenneth Reitz （来自 Requests 名声）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-05T11:46:16.263

这是一个肮脏的解决方法-

```
import argparse
p = argparse.ArgumentParser()
p.add_argument('--arg', action='store_true')
s = p.add_subparsers()
s.add_parser('test')

def my_parse_args(ss):
    #parse the info the subparser knows about; don't issue an error on unknown stuff
    namespace,leftover=p.parse_known_args(ss) 
    #reparse the unknown as global options and add it to the namespace.
    if(leftover):
        s.add_parser('null',add_help=False)
        p.parse_args(leftover+['null'],namespace=namespace)

    return namespace

#print my_parse_args('-h'.split())  #This works too, but causes the script to stop.
print my_parse_args('--arg test'.split())
print my_parse_args('test --arg'.split()) 
```

这行得通——你可以很容易地修改它来使用`sys.argv`（只需删除拆分字符串“ `ss`”）。您甚至可以子类`argparse.ArgumentParser`化并替换该`parse_args`方法，`my_parse_args`然后您将永远不知道其中的区别-尽管子类化以替换单个方法对我来说似乎过大了。

但是，我认为这是使用子解析器的一种非标准方式。一般来说，全局选项应该出现在子解析器选项之前，而不是之后。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T11:47:52.540

解析器有一个特定的语法: `command <global options> subcommand <subcommand ptions>`，你试图给子命令提供一个选项，但你没有定义一个。

# iphone - 将组件添加到路径 - Objective C

> ID：10896214
> 
> 赞同：5
> 
> 时间：2012-06-05T11:08:37.020
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我有一个网址说：`www.gmail.com/index.php`。我也有三个不同的字符串说`aa`，`bb`和`cc`。我想将三个单独的字符串附加到 url，以便在 Objective C 中获得组合 url，即我想要`www.gmail.com/index.php/aa/bb/cc`的。有人可以帮我吗 ？？我是目标 C 的新手。谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-05T11:26:21.403

如果您尝试使用 URL 以供以后用于检索数据等，`NSURL`完成后您将需要一个对象。您当然可以通过将 @"/%@" 附加到下一个元素来创建 URL，但您应该考虑执行以下操作：

```
NSURL *originalURL = [NSURL URLWithString: @"http://www.gmail.com/"];
NSURL *aaNextURL = [originalURL URLByAppendingPathComponent: @"aa"];
NSURL *bbNextURL = [aaNextURL URLByAppendingPathComponent: @"bb"];
NSURL *ccNextURL = [bbNextURL URLByAppendingPathComponent: @"cc"]; 
```

如果您要添加静态路径元素，这有点冗长，但如果您要添加计算信息，它解决了确保有适当斜杠的问题，并允许您直接使用 URL 构造。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-05T11:11:56.327

利用`stringByAppendingPathComponent`

# android - 当我通过支持文件在 android 2.33 中使用 android 片段概念时出错

> ID：10896215
> 
> 赞同：0
> 
> 时间：2012-06-05T11:08:38.387
> 
> 标签：android, android-fragments

在我的项目中，我有两个类 1).FragmentTestActivty--------扩展 FragmentActivty 2).TestFragment ------------- -----扩展片段

**FragmentTestActivty.java**

```
 import android.support.v4.app.Fragment;
            import android.support.v4.app.FragmentActivity;
           import android.support.v4.app.FragmentTransaction;

          public class FragmentTestActivity extends FragmentActivity implements
    OnItemClickListener {

@Override
public void onCreate(Bundle savedInstanceState) {// first
    System.out.println("1");
    super.onCreate(savedInstanceState);
    setContentView(com.example.fragmenttest.R.layout.main);

            l = (ListView) findViewById(com.example.fragmenttest.R.id.number_list);

    l.setAdapter(new MyCustomAdapter());

    l.setOnItemClickListener(FragmentTestActivity.this);

        /** Called when a number gets clicked */
public void onItemClick(AdapterView<?> parent, View view, int position,
        long id) {
    number = position;
    System.out.println("clicking or not");
    name = option[number];
    Fragment f = new TestFragment(position + 1);
    FragmentTransaction ft = getSupportFragmentManager().beginTransaction();
    ft.replace(R.id.the_frag, f);
    ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN);
    ft.addToBackStack(null);
    ft.commit();

} 
```

}

**测试片段.java**

```
 import android.support.v4.app.Fragment;
              import android.view.LayoutInflater;
              import android.view.View;

                  public class TestFragment extends Fragment {

public TestFragment() {

}

/* Constructor for being created explicitly */
public TestFragment(int nAndroids) {
    this.nAndroids = nAndroids;

}

/* If we are being created with saved state, restore our state */

public void onCreate(Bundle saved) {
    super.onCreate(saved);

    if (null != saved) {
        nAndroids = saved.getInt("nAndroids");

    }
}

public void onSaveInstanceState(Bundle toSave) {
    toSave.putInt("nAndroids", nAndroids);

}

View v;

public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle saved) {

    c = getActivity().getApplicationContext();

    LayoutInflater in = getActivity().getLayoutInflater();
    v = in.inflate(R.layout.list, null);

    LinearLayout lf = (LinearLayout) v.findViewById(R.id.frgmentpart);

    System.out.println(nAndroids + "n android");
    ListView lv2 = (ListView) v.findViewById(R.id.listView2);

    if (nAndroids == 1) {
        lv2 = (ListView) v.findViewById(R.id.listView2);
        lv2.setAdapter(new listview2());
        ;
        System.out.println("inside");

    } else if (nAndroids > 1) {
        System.out.println("outside " + lf);
        lf.setVisibility(View.GONE);
        // v=in.inflate(R.layout.list2, null);
    }
    return v;

}

} 
```

**错误**

```
06-05 16:25:41.535: E/AndroidRuntime(335): FATAL EXCEPTION: main

06-05 16:25:41.535: E/AndroidRuntime(335): java.lang.RuntimeException: Unable to instantiate activity 
ComponentInfo{com.example.fragmenttest/com.example.fragmenttest.FragmentTestActivity}: java.lang.ClassNotFoundException: com.example.fragmenttest.FragmentTestActivity in loader dalvik.system.PathClassLoader[/data/app/com.example.fragmenttest-2.apk]

             06-05 16:25:41.535: E/AndroidRuntime(335):     at  android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569)
            06-05 16:25:41.535: E/AndroidRuntime(335):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
              06-05 16:25:41.535: E/AndroidRuntime(335):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
06-05 16:25:41.535: E/AndroidRuntime(335):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
06-05 16:25:41.535: E/AndroidRuntime(335):  at android.os.Handler.dispatchMessage(Handler.java:99)
06-05 16:25:41.535: E/AndroidRuntime(335):  at android.os.Looper.loop(Looper.java:123)
06-05 16:25:41.535: E/AndroidRuntime(335):  at android.app.ActivityThread.main(ActivityThread.java:3683)
06-05 16:25:41.535: E/AndroidRuntime(335):  at java.lang.reflect.Method.invokeNative(Native Method)
06-05 16:25:41.535: E/AndroidRuntime(335):  at java.lang.reflect.Method.invoke(Method.java:507)
06-05 16:25:41.535: E/AndroidRuntime(335):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
06-05 16:25:41.535: E/AndroidRuntime(335):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
06-05 16:25:41.535: E/AndroidRuntime(335):  at dalvik.system.NativeStart.main(Native Method)
06-05 16:25:41.535: E/AndroidRuntime(335): Caused by: java.lang.ClassNotFoundException: com.example.fragmenttest.FragmentTestActivity in loader dalvik.system.PathClassLoader[/data/app/com.example.fragmenttest-2.apk]
06-05 16:25:41.535: E/AndroidRuntime(335):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
06-05 16:25:41.535: E/AndroidRuntime(335):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
06-05 16:25:41.535: E/AndroidRuntime(335):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
06-05 16:25:41.535: E/AndroidRuntime(335):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
06-05 16:25:41.535: E/AndroidRuntime(335):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561)
06-05 16:25:41.535: E/AndroidRuntime(335):  ... 11 more 
```

**清单文件**

```
 ?xml version="1.0" encoding="utf-8"?>
       <manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.example.fragmenttest"
   >
<uses-sdk android:minSdkVersion="7"
    android:targetSdkVersion="10" />

<application 
android:icon="@drawable/icon" 
android:label="@string/app_name"
android:theme="@android:style/Theme.Black"

>
    <activity android:name=".FragmentTestActivity"
              android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

</application> 
```

**图片** |--------------------------| | | | | | | | | 片段 | |活动| | | |testfragment.java| | | | | | | |----- ---------| |

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:14:51.037

您需要做的就是在 Eclipse 中右键单击我的项目并选择 Android Tools-->Add Support Library...

# .net - 如何从我的计算机上完全卸载 ClickOnce 应用程序？

> ID：10896223
> 
> 赞同：43
> 
> 时间：2012-06-05T11:08:59.937
> 
> 标签：.net, installation, clickonce

在尝试尝试通过[ClickOnce发布我的应用程序的](http://en.wikipedia.org/wiki/ClickOnce)*Foo*和*Foo Beta*版本时，我设法破坏了现有且以前工作正常的*Foo* 1.0.0 安装（将其替换为*Foo Beta* 1.0.5，这不起作用）由于使用相同的[GUID](http://en.wikipedia.org/wiki/Globally_unique_identifier)、程序集名称、产品名称或其他内容。

 **好的，诚实的错误。为了恢复这一点，我随后使用 Windows 7 添加/删除程序卸载了*Foo Beta 。*

我的计算机现在处于Windows 7 添加/删除程序中没有出现*Foo实例的状态。*但是，*Foo Beta*仍显示为已安装。此外，我无法重新安装*Foo* 1.0.0，因为它认为我的计算机上已经存在更新版本的程序（*Foo Beta* 1.0.5） - 相反，我得到`无法安装，因为更新版本该产品已安装”的消息。

如何使我的计算机处于从未安装过*Foo*和*Foo Beta*的状态，以便我可以去重新安装*Foo*？

到目前为止，我已阅读 Stack Overflow 问题*[卸载 ClickOnce 客户端](https://stackoverflow.com/questions/1266858/uninstall-click-once-clients)*和*[如何从客户的计算机中删除 ClickOnce 应用程序的所有痕迹？](https://stackoverflow.com/questions/5584030)*并尝试：

1.  删除%USERPROFILE%/ 下所有相关的*foo .exe 目录*
2.  运行 mag.exe -cc
3.  编辑 HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Uninstall 并删除我的*Foo*程序的条目。

当我运行安装程序时，我仍然收到错误消息。它从哪里找到我的程序的痕迹？为了将来参考，这是在哪里记录的？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-06-06T13:29:11.197

您可以尝试使用此命令清除 ClickOnce 缓存：

```
rundll32 dfshim CleanOnlineAppCache 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2018-04-17T14:32:46.107

**用老方法做！:D**

使用“旧”控制面板删除 Click Once 应用程序并重新安装。**不要使用“新的”Windows Ten/2016 界面**

EG 这**很好**，将删除 Click Once：

```
Start => type
Control Panel\Programs\Programs and Features 
```

[![在此处输入图像描述](../Images/7756b41b3cb2ef4cfffc358a6ec15dc9.png)](https://i.stack.imgur.com/6ipBI.png)

EG 这很糟糕，如果你用它来删除 Click **Once**，会让你陷入循环地狱：

```
Start => Run =>
ms-settings: 
```

[![在此处输入图像描述](../Images/e559df99063b0a3f5d62e748f85b5ed7.png)](https://i.stack.imgur.com/kA4QC.png)

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2014-07-01T14:03:39.883

1) 运行`rundll32 %SystemRoot%\system32\dfshim.dll CleanOnlineAppCache`

2) 您可能必须手动删除 ClickOnce 部署文件夹，

*   在 Windows Vista 或更高版本上，这将是 %LocalAppData%\Apps\2.0 目录。
*   在 Windows XP 上，这将是 %USERPROFILE%\Local Settings\Apps\2.0 目录。

3）您可能还必须注销并重新登录

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-26T13:05:16.337

> 删除 %USERPROFILE%/ 下所有相关的 foo.exe 目录

您还应该查看清单文件夹**

# php - PHP从数据库中的字节[]获取图像

> ID：10896226
> 
> 赞同：1
> 
> 时间：2012-06-05T11:09:15.800
> 
> 标签：php, database, image

我想用 PHP 脚本显示图像。我从数据库中获取图像数据。数据是一个字节[]。有谁知道如何做到这一点？

我还试过这个：

```
function GetImage($imageDataArray)
{
   $base64String = "";
   for($i = 0; $i < count($imageDataArray); $i++)
   {
       $string = trim(strtr(base64_encode($imageDataArray[$i]), '+/', '-_'), '='); 
       $base64String .= $string;
   }

   return 'data:image/png;base64,' . $base64String ;
} 
```

并在这里调用它：

```
echo '<img src="'.$im->GetImage($imageDataArray).'" alt="Picture" />'; 
```

但我没有得到结果。图片未显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:33:27.657

这可能会帮助你[`Imagick::readImageBlob`](http://us.php.net/manual/en/imagick.readimageblob.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:03:51.283

摆脱`base64_encode() && use urlencode() || rawurlencode()`

# java - 关于jmock的一点指导

> ID：10896228
> 
> 赞同：1
> 
> 时间：2012-06-05T11:09:23.293
> 
> 标签：java, jmock

我已经尝试了 jmock 网站上的文档，但我只是迷路了。对于已经知道如何使用它的人来说，它似乎是一个很好的文档。我不是其中之一。我正在寻找其中之一。:)

我有一个服务层，我的应用程序的所有前端都与之通信。服务层使用 DAO 与数据库通信并返回我的模型对象。我想对这些 DAO 使用 Jmock，这样就不会访问数据库。

所以，我有实现 PersonService 的 PersonServiceImpl 和在休眠中实现 PersonDAO 的 PersonH​​ibernateDAO。示例人员服务如下。

```
public class PersonServiceImpl implements PersonService{
    public void changeName(int personId, String firstName, String lastName){
        person = getPersonDAO.getPerson(int personId);
        person.setFirstName(firstName);
        person.setLastName(lastName);
        getPersonDAO.update(person);
    }
} 
```

如何使用 jmock 对我的人员服务进行单元测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T12:07:03.533

我认为这是应该工作的。

```
public class MyTestClass{
   Mockery context = new Mockery();

   private PersonServiceImpl personService;
   private PersonDAO dao;
   private Person person;

   @Before
   public void setup(){
       person = new Person();

       // set up mock to return person object
       dao = context.mock(PersonDAO.class);
       oneOf (dao).getPerson(5); will(returnValue(person));

       // create class under test with mock
       personService = new PersonServiceImpl(dao);
   }

   @Test
   public void myTest(){

    // expectations
    context.checking(new Expectations() {{
        oneOf (dao).update(person);
    }});

      // test
      psersonService.changeName(....);

    // verify
    context.assertIsSatisfied();
   }
} 
```

就个人而言，我认为mockito更容易......

```
public class MyTestClass{

   private PersonServiceImpl personService;
   private PersonDAO dao;
   private Person person;
   private ArgumentCaptor<Person> argCaptor;

   @Before
   public void setup(){
       person = new Person();

       argCaptor = ArgumentCaptor.forClass(Person.class);

       // set up mock to return person object
       dao = Mockito.mock(PersonDAO.class);
       when(dao.getPerson(5).thenReturn(person);

       // create class under test with mock
       personService = new PersonServiceImpl(dao);
   }

   @Test
   public void myTest(){
      // test
      psersonService.changeName(....);

      // verify
      verify(dao).update(argCaptor.capture());
      Person passedPerson = argCaptor.getValue();
      assertThat(passedPerson.getFirstName(), equalTo(...));
   }
} 
```

# php - 如何使用 PHP 从视频 URL 中检索 YouTube 视频详细信息？

> ID：10896233
> 
> 赞同：31
> 
> 时间：2012-06-05T11:09:49.870
> 
> 标签：php, youtube-api

使用 PHP，我如何从 youtube 视频 URL 获取视频信息，如标题、描述、缩略图，例如

```
http://www.youtube.com/watch?v=B4CRkpBGQzU 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-06-05T11:32:00.250

您可以从 youtube oembed 界面以两种格式获取数据：XML 和 JSON

接口地址：[http ://www.youtube.com/oembed?url=youtubeurl&format=json](http://www.youtube.com/oembed?url=youtubeurl&format=json)

使用此 PHP 函数获取数据

```
 function get_youtube($url){

 $youtube = "http://www.youtube.com/oembed?url=". $url ."&format=json";

 $curl = curl_init($youtube);
 curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
 $return = curl_exec($curl);
 curl_close($curl);
 return json_decode($return, true);

 }

$url = // youtube video url 

// Display Data 
print_r(get_youtube($url)); 
```

不要忘记`extension=php_curl.dll` 在您的`php.ini`

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-06-05T11:17:14.353

这将返回有关视频的元数据：

`http://www.youtube.com/oembed?url={videoUrlHere}&format=json`

使用您的示例，调用：

`http://www.youtube.com/oembed?url=http://www.youtube.com/watch?v=B4CRkpBGQzU&format=json`

返回以下内容，您可以使用 PHP 对其进行消化和解析：

```
{
    "provider_url": "http:\/\/www.youtube.com\/",
    "thumbnail_url": "http:\/\/i3.ytimg.com\/vi\/B4CRkpBGQzU\/hqdefault.jpg",
    "title": "Joan Osborne - One Of Us",
    "html": "\u003ciframe width=\"459\" height=\"344\" src=\"http:\/\/www.youtube.com\/embed\/B4CRkpBGQzU?fs=1\u0026feature=oembed\" frameborder=\"0\" allowfullscreen\u003e\u003c\/iframe\u003e",
    "author_name": "jzsdhk",
    "height": 344,
    "thumbnail_width": 480,
    "width": 459,
    "version": "1.0",
    "author_url": "http:\/\/www.youtube.com\/user\/jzsdhk",
    "provider_name": "YouTube",
    "type": "video",
    "thumbnail_height": 360
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-08-17T21:57:25.320

另一个有用的 URL API 是：[https ://www.youtube.com/get_video_info?video_id=B4CRkpBGQzU](https://www.youtube.com/get_video_info?video_id=B4CRkpBGQzU)

video_id 是 YouTube 的“v”参数。结果是一个 URL 编码格式的字典 (key1=value1&key2=value2&...)

这是长期存在的无证 API，因此探索它取决于开发人员。我知道“状态”（正常/失败）、“错误代码”（在我的实践中为 100 和 150）、“原因”（错误的字符串描述）。我以这种方式获得持续时间（“length_seconds”），因为 oEmbed 不提供此信息（奇怪但真实），我几乎无法激励每个雇主从 YouTube 获取密钥以使用官方 API

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-16T16:14:19.717

要获取**youtube**视频`description`、不同大小`thumbnail`等`tags`，请使用更新的***v3*** **googleapis**

示例网址：[https ://www.googleapis.com/youtube/v3/videos?part=snippet&id=7wtfhZwyrcc&key=my_google_api_key](https://www.googleapis.com/youtube/v3/videos?part=snippet&id=7wtfhZwyrcc&key=my_google_api_key)

```
$google_api_key = 'google_api_key';
$video_id = 'youtube_video_id';
$api_url = 'https://www.googleapis.com/youtube/v3/videos?part=snippet&id='.$video_id.'&key='.$google_api_key;
$json = file_get_contents($api_url);
$obj = json_decode($json);
var_dump($obj); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T19:07:29.477

我写了这个类来在我们的网站上显示一个 Youtube 视频：

```
 <?php
    /*
     Copyright (c) 2013 ReFri Software / Internet Publication
 All rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following
 conditions are met:

    * Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright notice, this
      list of conditions and the following disclaimer in the documentation and/or
      other materials provided with the distribution.
    * Neither the name of ReFri Software / Internet Publicion nor the names of its contributors
      may be used to endorse or promote products derived from this software without
     specific prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
 EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL
 THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

 youtube.php
 Author : Cynthia Fridsma 
 http://www.heathernova.us

 Date  : February 4, 2013

 Version: 1.1
 Property's width and height are now private
 Added:  variable error message

*/
    class YouTube {

    public $video;
    private $width;
    private $height;
    public $error = "<b>Video not found, sorry</b>" ;

    function __construct ($width=640, $height=360){

        $this->width=$width;
        $this->height=$height;      

        if($this->width<220){
            // minimum width
            $this->width=220;
        }
        if($this->height<220){
            // minimum height
            $this->height=220;
        }

    }    

    function playVideo(){

        // Default video settings:
        #
        # youtube_list = false
        # youtube_video = false

        $youtube_list = false;    
        $youtube_video = false;    

        // always check contains youtube.com or youtube.be as a reference....

        if(stristr($this->video, "youtube.com")==true ||(stristr($this->video, "youtube.be") || (stristr($this->video, "youtu.be")))){

            // Test if the video contains a query..

            $test = (parse_url($this->video));

            if(isset($test['query'])){

                $testing = $test['query'];
                parse_str($testing);
                if(isset($v)&&(isset($list))){                    

                    // we're dealing with a play list and  a selected video.                    
                    $test = $list;
                    $youtube_list = true;                      
                }
                if(isset($list) &&(empty($v))){
                    // we're only dealing wih a play list.
                    $test = $list;

                    $youtube_list = true;      
                    $test = $list;

                }
                if(isset($v) &&(empty($list))){
                    // we're only dealing with a single video.

                    $test = $v;
                    $youtube_video = true;    
                }
                if(empty($v) &&(empty($list))){
                    // we're not dealing with a valid request.
                    $youtube_video = false;                        
                }

            } else {

                // Apperently we're dealing with a shared link.

                $testing =parse_url($this->video, PHP_URL_PATH);

                $test = stristr($testing, "/");
                $test = substr($test,1);
                $youtube_video = true;    
            }

            if($youtube_video==true){
                    // Display a single video                                        

                    $play ='<iframe width="'.$this->width.'" height="'.$this->height.'" src="http://www.youtube.com/embed/'.$test.'?rel=0" frameborder="0" allowfullscreen></iframe>';
            }

            if($youtube_list==true){
                // Display a video play list.

                $youtube_video = true;

                $play = '<iframe width="'.$this->width.'" height="'.$this->height.'" src="http://www.youtube.com/embed/videoseries?list='.$test.'" frameborder="0" allowfullscreen></iframe>';

            }

                if($youtube_video == false){

                // We are unable to determine the video.

                $play = $this->error;
            }
        } else {

            // This is not a valid youtube requeust

            $play = $this->error;
        }

        // Return the results        

        return $this->playVideo=$play;
          }

      } 
```

这就是您可以使用该类的方式：

```
 <?php
    include_once("youtube.php");
    $video = new YouTube(320,240);

    // playlist 
    $video->video = "http://www.youtube.com/playlist?list=PL6F5E9FD99326F98C";

    $youtube = $video->playVideo();
    echo $youtube . "<hr>";

    // 1 video
    $video->video="http://www.youtube.com/watch?v=uTA5bLxfvwo";

    $youtube = $video->playVideo();

    echo $youtube;

    // shared link
    echo "<hr>";
    $video = new YouTube(420,315);
    $video->video="http://youtu.be/VRl2XFJ_tg4";
    $youtube = $video->playVideo();
    echo $youtube;

    // invalid request
    $video->video = "http://wrongvideo.com?nothere";

    // Your own error message
    $video->error ="<br>Video not found :-(<br>" ;

    $youtube = $video->playVideo();

    echo $youtube;
    ?> 
```

演示页面： [http ://www.heathernova.us/youtube.php](http://www.heathernova.us/youtube.php)

TTFN 辛西娅·弗里兹玛

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-19T03:39:34.450

我知道这是一个老问题，但我为此目的写了一个包，我会把它放在这里也许有人需要这个。

`composer require smoqadam/youtube-video-info:dev-master`

```
$details = $video->getDetails();
echo $details->getVideoId();
echo $details->getTitle();
echo $details->getThumbnails();
echo $details->getViewCount();
echo $details->getRating(); 
```

更多信息在[这里](https://github.com/smoqadam/youtube-video-info)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-30T02:06:37.870

这是一个可以返回多条信息的方法：

```
<?php
extension_loaded('openssl') or die('openssl');
$http['method'] = 'POST';
$http['header'] = 'Content-Type: application/json';

$http['content'] = <<<eof
{
   "videoId": "lTGjFpjOIP8", "context": {
      "client": {"clientName": "WEB", "clientVersion": "1.19700101"}
   }
}
eof;

$con = stream_context_create(['http' => $http]);
$key = '?key=AIzaSyAO_FJ2SlqU8Q4STEHLGCilw_Y9_11qcW8';

echo file_get_contents(
   'https://www.youtube.com/youtubei/v1/player' . $key, context: $con
); 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2015-02-06T15:30:13.180

来自 oembed：

```
$video_url = 'https://www.youtube.com/watch?v=bHQqvYy5KYo';
$url = 'http://www.youtube.com/oembed?format=json&url=' . $video_url;

$json = json_decode(file_get_contents($url), true);
print_r($json); // it will return details of video 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2012-06-05T11:17:39.990

从视频网址获取视频ID的功能

```
function getYTid($ytURL) {

    $ytvIDlen = 11; // This is the length of YouTube's video IDs

    // The ID string starts after "v=", which is usually right after 
    // "youtube.com/watch?" in the URL
    $idStarts = strpos($ytURL, "?v=");

    // In case the "v=" is NOT right after the "?" (not likely, but I like to keep my 
    // bases covered), it will be after an "&":
    if($idStarts === FALSE)
        $idStarts = strpos($ytURL, "&v=");
    // If still FALSE, URL doesn't have a vid ID
    if($idStarts === FALSE)
        die("YouTube video ID not found. Please double-check your URL.");

    // Offset the start location to match the beginning of the ID string
    $idStarts +=3;

    // Get the ID string and return it
    $ytvID = substr($ytURL, $idStarts, $ytvIDlen);

    return $ytvID;

} 
```

进而

```
$video = getYTid($videourl);
$video_feed = file_get_contents("http://gdata.youtube.com/feeds/api/videos/$video");
            $sxml = new SimpleXmlElement($video_feed);

            //set up nodes
            $namespaces = $sxml->getNameSpaces(true);
            $media = $sxml->children($namespaces['media']);
            $yt = $media->children($namespaces['yt']);
            $yt_attrs = $yt->duration->attributes();

            //vars
             $video_title = $sxml->title;

             $video_description = $sxml->content;

             $video_keywords = $media->group->keywords;

             $video_length = $yt_attrs['seconds']; 
```

# java - 新的 Java 7 Path 类的正确用法是什么？

> ID：10896236
> 
> 赞同：4
> 
> 时间：2012-06-05T11:09:59.113
> 
> 标签：java

我目前使用这种方法在我的应用程序中加载文件：

```
Path path = Paths.get(ClassLoader.class.getResource(fileName).toURI()); 
```

其中文件名的结构为“/package1/package2/folder/file.lol”。

是否有更好、更简单或更正确的方法来获取 Path 对象？我也需要在 JAR 中工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T04:56:29.597

如果您想访问不在 jar 中的文件，那么有更好的解决方案。但是由于您似乎想访问它是 jar 的一部分，所以我会拒绝！

# android - 通话记录能否以编程方式关闭-android

> ID：10896238
> 
> 赞同：0
> 
> 时间：2012-06-05T11:10:06.237
> 
> 标签：android

我的应用程序以编程方式进行多次调用，但要做到这一点，它需要覆盖/隐藏/关闭在一次通话结束时显示的通话记录。这可能吗？可以使用 PhoneStateListener() 类型的功能使其工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:18:12.383

在 android 中拨打电话并在通话结束时返回 Base 活动

```
using PhoneCallListener 
```

看我的答案在[这里](https://stackoverflow.com/questions/10892066/android-showing-device-call-log-screen-after-call-gets-finished-end/10892903#10892903)

# javascript - 淘汰脏旗事件

> ID：10896244
> 
> 赞同：0
> 
> 时间：2012-06-05T11:10:29.793
> 
> 标签：javascript, knockout.js

我已经在此处使用 Dirty Flag 博客文章[Knockmeout](http://www.knockmeout.net/2011/05/creating-smart-dirty-flag-in-knockoutjs.html)在我的模型中实现了这样的标志，但我无法让它正常工作。不知何故，该标志从未设置为真。

另外，我希望每次将脏标志设置为 true 时触发我的订阅事件。（我会手动重置）。

这是一个显示我的问题的[小提琴。](http://jsfiddle.net/Mike1/xw76d/2/)

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T13:17:18.157

几件小事：

*   当您使用`span`标签时，它们不应该是自动关闭的（这样做`<span></span>`）。这会阻止显示您的最终绑定。
*   如果您在对象文字内创建视图模型，则`this`尚未引用视图模型，因此当您创建脏标志时，它没有正确跟踪您的过滤器对象。如果你想做一个对象文字，那么你会想在之后创建你的脏标志。
*   与选择一起使用时的值绑定将使用字符串填充您的模型值。所以，我把你的改成`1`了`'1'`，否则它会立即变脏。有一种方法可以使用可写的计算 observable 将其强制为数字。这是一种[技术](http://knockoutjs.com/documentation/extenders.html#live_example_1_forcing_input_to_be_numeric)。

这是一个更新的示例：http: [//jsfiddle.net/rniemeyer/xw76d/4/](http://jsfiddle.net/rniemeyer/xw76d/4/)

# perl - 将命令的输出读入 Perl 数组

> ID：10896246
> 
> 赞同：11
> 
> 时间：2012-06-05T11:10:30.823
> 
> 标签：perl, command

我想把命令的输出放到一个数组中——像这样：

```
my @output = `$cmd`; 
```

但似乎命令的输出没有进入`@output`数组。

知道它会去哪里吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-05T11:25:15.507

这个简单的脚本对我有用：

```
#!/usr/bin/env perl
use strict;
use warnings;

my $cmd = "ls";    
my @output = `$cmd`;    
chomp @output;

foreach my $line (@output)
{
    print "<<$line>>\n";
} 
```

它产生了输出（三个点除外）：

```
$ perl xx.pl
<<args>>
<<args.c>>
<<args.dSYM>>
<<atob.c>>
<<bp.pl>>
...
<<schwartz.pl>>
<<timer.c>>
<<timer.h>>
<<utf8reader.c>>
<<xx.pl>>
$ 
```

命令的输出在行边界上拆分（默认情况下，在列表上下文中）。删除数组元素中的`chomp`换行符。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-05T11:16:42.070

（标准）输出确实转到该数组：

```
david@cyberman:listing # cat > demo.pl
#!/usr/bin/perl
use strict;
use warnings;
use v5.14;
use Data::Dump qw/ddx/;

my @output = `ls -lh`;
ddx \@output;
david@cyberman:listing # touch a b c d
david@cyberman:listing # perl demo.pl
# demo.pl:8: [
#   "total 8\n",
#   "-rw-r--r--  1 david  staff     0B  5 Jun 12:15 a\n",
#   "-rw-r--r--  1 david  staff     0B  5 Jun 12:15 b\n",
#   "-rw-r--r--  1 david  staff     0B  5 Jun 12:15 c\n",
#   "-rw-r--r--  1 david  staff     0B  5 Jun 12:15 d\n",
#   "-rw-r--r--  1 david  staff   115B  5 Jun 12:15 demo.pl\n",
# ] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T11:15:53.230

启用自动错误检查：

```
require IPC::System::Simple;
use autodie qw(:all);
⋮
my @output = `$cmd`; 
```

# ruby - Ruby 警告：条件中的字符串文字

> ID：10896248
> 
> 赞同：3
> 
> 时间：2012-06-05T11:10:34.850
> 
> 标签：ruby, warnings

在第七行，我收到警告“条件中的字符串文字”。警告是什么意思，我该如何解决？

```
 print 'Continue to use calculator?   Y or N'
   userAgree = gets.chomp
   if userAgree == 'Y' or 'y'
        userAgree = true
   else
        userAgree = false
   end 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-05T11:14:07.073

改变

```
if userAgree == 'Y' or 'y' 
```

到

```
if userAgree == 'Y' or userAgree == 'y' 
```

或者，在我看来，更清晰更清晰：

```
if userAgree.upcase() == 'Y' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T11:13:48.250

您的`if`条件无效。这个有效。

```
print 'Continue to use calculator?   Y or N'
userAgree = gets.chomp
if userAgree == 'Y' or userAgree == 'y'
  userAgree = true
else
  userAgree = false
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-03T16:50:50.843

你可以这样做：

```
 puts 'Continue to use calculator?   Y or N'
    userAgree = gets.chomp
    userAgree.to_s.upcase!

    def Check (ans)

    if ["Y","N"].include?(ans)
        puts"true"
    else
        puts "false"
    end

end

Check userAgree 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-09-02T16:32:34.970

为什么不

```
if userAgree == ('Y' or 'y') 
```

语法对我来说更具表现力。

# javascript - 我想在 for 循环和 ASC 订单的帮助下使用 Jquery 或 Javascript 验证多个图像

> ID：10896250
> 
> 赞同：0
> 
> 时间：2012-06-05T11:11:05.593
> 
> 标签：javascript, jquery, image, forms, validation

我在使用 jQuery 或 JavaScript 进行图像验证时遇到问题。

当我尝试自己时，请参阅下面的代码。

## 简报

我想在 for 循环的帮助下验证多个图像。

## 问题（验证订购）

当我按下提交按钮时，此代码已按 DESC 顺序验证图像（*见下图*），我想要 ASC 顺序`1 field is required...`，然后`2 field is required`等

代码：

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>
function imageValidation(){
    return_var = 'true';

    for(var i=1; i<4; i++){
        if(($('#player-'+i).val()) == ''){
            return_var = i+' field is required';
        }
    }
    alert(return_var);
    return false;

}   
</script>

<form onsubmit="return imageValidation()">
1 <input type="file" id="player-1" name="players[]" /><br />
2 <input type="file" id="player-2" name="players[]" /><br />
3 <input type="file" id="player-3" name="players[]" /><br />
<input type="submit" />
</form> 
```

## 图片

![在此处输入图像描述](../Images/126a1c059e7fba0c41fc6d2410ad6ab5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:16:18.047

我添加了一行新代码，就`break;`在第一个条件匹配时。它会解决你的问题

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>
function imageValidation(){
    return_var = 'true';

    for(var i=1; i<4; i++){
        if(($('#player-'+i).val()) == ''){
            return_var = i+' field is required';
            break;// break immediately rather wait to complete the loop.
        }
    }
    alert(return_var);
    return false;

}   
</script>

<form onsubmit="return imageValidation()">
1 <input type="file" id="player-1" name="players[]" /><br />
2 <input type="file" id="player-2" name="players[]" /><br />
3 <input type="file" id="player-3" name="players[]" /><br />
<input type="submit" />
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:16:21.090

根据您的代码：

```
function imageValidation(){
    return_var = 'true';

    for(var i = 1; i < 4; i++){
        if(!$.trim( $('#player-'+i).val() )){
            return_var = i+' field is required';
            break;
        }
    }
    alert(return_var);
    return false;
} 
```

但是使用 jQuery

```
var return_var = 'true';
$('form input[id^=player]').each(function(index, el) {
  if(!$.trim( this.value)) {
    return_var += (index+1) + ' field is required'; // index is zero based
    break; // if you want to stop execution after invalid found
  }
}); 
```

所以你的功能看起来像

```
function imageValidation(){

   var return_var = 'true';
    $('form input[id^=player]').each(function(index, el) {
      if(!$.trim( this.value)) {
        return_var = (index+1) + ' field is required'; // index is zero based
        break; // if you want to stop execution after invalid found
      }
    });
    alert(return_var);
    return false;
} 
```

# php - 从字符串中检索 URL 文件夹名称

> ID：10896252
> 
> 赞同：1
> 
> 时间：2012-06-05T11:11:06.520
> 
> 标签：php, url

我有点麻烦。我想找到顶级文件夹并将其用作变量。

例如。

如果我有一个网址： http: [//www.someurl.com/foldername/hello.php](http://www.someurl.com/foldername/hello.php)

我想查看 URL 并回显“文件夹名”。

目前我的代码剥离了一些东西，以便它回显“hello.php”。

任何帮助将不胜感激。

```
<?php

// Get URL String // 
function curPageURL() {
$pageURL = 'http';
if ($_SERVER["HTTPS"] == "on") {$pageURL .= "s";}
$pageURL .= "://";
if ($_SERVER["SERVER_PORT"] != "80") {
$pageURL .= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
} else {
$pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
}
return $pageURL;
}

// Split String and get folder//

function curPageName() {
return substr($_SERVER["SCRIPT_NAME"],strrpos($_SERVER["SCRIPT_NAME"],"/"));
}

// Pass along Results //
$foldername = curPageName();

echo $foldername;

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:14:44.450

试试看

```
$parse = parse_url('http://www.someurl.com/foldername/hello.php')
echo dirname($parse['path']);
// Output: /foldername
// use trim() to strip of that leading slash 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:16:28.820

我们应该这样做吗？

我想这会做

```
function getFolderName($URL)
{
        $pieces  = explode("/",$URL);
    //    return $pieces[3];// -->do this if you  need folder after domain
    return $pieces[count($pieces)-2]; //-->do this if you need folder just before sourcefile
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:27:29.220

```
 <?php 

            $a = "http://www.someurl.com/foldername/hello.php";

            $b =  explode('/',$a);

            //var_dump($b); 

        // i got this result  array(5) { [0]=> string(5) "http:" [1]=> string(0) "" [2]=>                  string(15) "www.someurl.com" [3]=> string(10) "foldername" [4]=> string(9) "hello.php" } 
```

// 现在获取或回显文件夹名称将数组中的值存储在变量中

```
 $value = $b['3'];

        echo $value // will output foldername 
      ?> 
```

我也是新手

# objective-c - Objective C, NSDictionary 循环遍历每个对象

> ID：10896257
> 
> 赞同：-2
> 
> 时间：2012-06-05T11:11:44.707
> 
> 标签：objective-c, cocoa, facebook-graph-api, xcode4, nsdictionary

我是 Facebook 开发人员的新手。我想使用 Facebook API 创建 Mac OSX 应用程序。当我请求 FQL 并且它只返回 JSON 数据时，如下所示：

我的代码：

```
[self.result_text setString:[NSString stringWithFormat:@"%@",[result objectForKey: @"result"]]; 
```

它显示：

```
[{"name":"My Name","first_name":"My First Name","last_name":"My Last Name"}] 
```

我想阅读此词典中的对象。示例我只想显示“我的名字”字符串。但我不知道该怎么做。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:17:21.017

正如 Ashley Mills 所写，您应该查看文档。您可以像这样遍历所有字典键：

```
for ( NSString *key in [dictionary allKeys]) {
  //do what you want to do with items
  NSLog(@"%@", [dictionary objectForKey:key]);
} 
```

希望能帮助到你

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:15:18.317

您可以使用[JSONKit](https://github.com/johnezang/JSONKit)将 JSON 字符串转换为字典：

```
 NSDictionary *resultsDictionary = [resultString
      objectFromJSONStringWithParseOptions:JKParseOptionLooseUnicode|JKParseOptionValidFlags error:&err];

NSString* name = [resultDictionary objectForKey:@"name"]; 
```

JSONKit 使用简单，可以让您的应用程序在较旧的 SDK 版本上也能正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:15:42.500

您可以通过 Lion 的全新[NSJSONSerialization 类](http://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)（为您链接的文档）将来自服务器的 JSON 内容解析为 NSDictionary 对象。

例如

```
NSDictionary *jsonDictionary = [NSJSONSerialization JSONObjectWithData: [self.result_text dataUsingEncoding: NSUTF8StringEncoding] options: nil error: &error]; 
```

一旦你把它放在一个 NSDictionary 对象中，就很容易做类似的事情：

```
NSString * myLastNameContent = [jsonDictionary objectForKey: @"last_name"]; 
```

塞尔吉奥的回答（他一直在编辑，即使我输入 :-) 也非常好。给他+1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T11:14:18.157

您应该阅读`NSDictionary`此处的文档：

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsdictionary_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsdictionary_Class/Reference/Reference.html)

特别是标题为**访问键和值的部分**

# c# - gridview 中第一行的颜色没有改变

> ID：10896258
> 
> 赞同：1
> 
> 时间：2012-06-05T11:11:45.357
> 
> 标签：c#, gridview, colors, backcolor

我在 asp.net 网页中有一个 gridview，并且该行的背景颜色根据特定单元格中的数据进行更改，但网格的第一行没有更改。为什么是这样？这是我用来更改颜色的代码：

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
     if (e.Row.RowType == DataControlRowType.DataRow)
      {
        int StationStatus1 = Int32.Parse(GridView1.DataKeys[e.Row.RowIndex].Values[0].ToString());            
        foreach (GridViewRow row in GridView1.Rows)
        {
            switch (StationStatus1)
            {
                case 0:
                case 3:
                   e.Row.BackColor = System.Drawing.Color.Red;                        
                   break;                    
                case 12:                       
                    e.Row.BackColor = System.Drawing.Color.Blue;                        
                    break;
                default:
                    e.Row.BackColor = System.Drawing.Color.White;
                    break; 
```

任何帮助将不胜感激。谢谢

# c# - 将数据表存储在平面文件中

> ID：10896265
> 
> 赞同：2
> 
> 时间：2012-06-05T11:12:16.183
> 
> 标签：c#

这是我第一次对平面文件进行任何类型的工作。我需要这是一个纯 txt 文件而不是 XML。

我写了以下选择逗号分隔的格式。

```
 public static void DataTableToFile(string fileLoc, DataTable dt)
    {
        StringBuilder str = new StringBuilder();
        // get the column headers
        foreach (DataColumn c in dt.Columns)
        {
            str.Append(c.ColumnName.ToString() + ",");
        }
        str.Remove(str.Length-1, 1);
        str.AppendLine();
        // write the data here
        foreach (DataRow dr in dt.Rows)
        {
            foreach (var field in dr.ItemArray)
            {
                str.Append(field.ToString() + ",");
            }
            str.Remove(str.Length-1, 1);
            str.AppendLine();
        }
        try
        {
            Write(fileLoc, str.ToString());
        }
        catch (Exception ex)
        {
            //ToDO:Add error logging
        }
    } 
```

我的问题是：我可以做得更好或更快吗？`str.Remove(str.Length-1, 1);`是否可以删除最后一个，这`,`是我能想到的唯一方法。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:15:55.707

利用

```
public static void DataTableToFile(string fileLoc, DataTable dt)
{
    StringBuilder str = new StringBuilder();

    // get the column headers
    str.Append(String.Join(",", dt.Columns.Cast<DataColumn>()
                                      .Select(col => col.ColumnName)) + "\r\n");

    // write the data here
    dt.Rows.Cast<DataRow>().ToList()
           .ForEach(row => str.Append(string.Join(",", row.ItemArray) + "\r\n"));

    try
    {
        Write(fileLoc, str.ToString());
    }
    catch (Exception ex)
    {
        //ToDO:Add error logging
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T11:17:37.667

关键点是：没有必要在内存中使用`StringBuilder`- 你应该通过类似的东西写入文件`StreamWriter`，即通过`File.CreateText`。API 类似于`StringBuilder`，但您不应该尝试*删除*- 相反，**不要添加**- 即

```
bool first = true;
foreach(...blah...) {
    if(first) { first = false; }
    else { writer.Write(','); }
    ... write the data ...
} 
```

作为另一个考虑因素：CSV**不仅仅是**添加逗号的情况。您需要考虑引用文本（对于带有`,`in 的数据）和多行数据。除非数据非常非常简单。您可能还希望使格式更明确，而不仅仅是`.ToString()`对文化非常敏感。典型的例子是欧洲大部分地区使用`,`十进制字符，因此“CSV”通常使用不同的分隔符，以避免必须引用所有内容。如果可以选择，我*个人*将始终使用 TSV 而不是 CSV - 问题较少（理论上，尽管您仍然需要处理带有标签的数据）。

# javascript - 从 XML 生成的 JSON 中“@attributes”元素的来源

> ID：10896268
> 
> 赞同：2
> 
> 时间：2012-06-05T11:12:38.143
> 
> 标签：javascript, xml, json

在将 XML 转换为 JSON 时，如何和/或在哪些约定中将 XML 属性放入名为“@attributes”的对象中？此样式用于[此通用 XML 解析器](http://davidwalsh.name/convert-xml-json)：

```
obj["@attributes"] = {};
for (var j = 0; j < xml.attributes.length; j++) {
  var attribute = xml.attributes.item(j);
  obj["@attributes"][attribute.nodeName] = attribute.nodeValue;
} 
```

..像这样创建 JSON：

```
...
elem_array = [
  {
    "@attributes": {
      an-attribute: "",
      another-one: "mr.text"
    }
  }
]
... 
```

我不是在寻找关于以元素为中心与以属性为中心的 XML 设计的答案，除非这些事情与我的问题比我想象的更密切相关。;)

@attributes 符号从何而来，是否有理由使用它而不是使用您自己的符号？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:22:30.997

它可能是从 XPATH @attribute 语法演变而来的

[http://www.tizag.com/xmlTutorial/xpathattribute.php](http://www.tizag.com/xmlTutorial/xpathattribute.php)

使用 @ 可以让习惯 XPATH 的人识别它

示例：[XPath：获取子节点包含属性的节点](https://stackoverflow.com/questions/1457638/xpath-get-nodes-where-child-node-contains-an-attribute)

# php - Windows 主机中的杂货杂货

> ID：10896271
> 
> 赞同：0
> 
> 时间：2012-06-05T11:12:46.923
> 
> 标签：php, model-view-controller, codeigniter-2, grocery-crud

我已经在我的服务器上安装了 Codeigniter，并在上面安装了 Grocery crud。不幸的是，服务器是基于 Windows 的，不支持 url 重写，我被困在使用 Grocery crud 的情况下。

有人可以解释解决方案吗，因为我搜索杂货杂货论坛并一无所获。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T16:42:57.027

更改 CodeIgniter 中的配置文件并更改 $config['querystring'] = false

现在您可以访问 GroceryCrud 库函数，例如 www.example.com/index.php/ControllerClass/FunctionName

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T08:12:36.157

创建一个以`web.config`Web 根目录命名的文件并将以下内容放入文件中

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="Rewrite to index.php">
                    <match url="index.php|robots.txt|images|test.php" />
                    <action type="None" />
                </rule>
                <rule name="Rewrite CI Index">
                    <match url=".*" />
                    <conditions>
                        <add input="{REQUEST_FILENAME}" pattern="css|js|jpg|jpeg|png|gif|ico|htm|html" negate="true" />
                    </conditions>
                    <action type="Rewrite" url="index.php/{R:0}" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```

[以上是这里](http://codeigniter.com/forums/viewthread/91954)Codeigniter 论坛上使用的示例。

您可能还需要确保将`$config['uri_protocol']`其设置为`AUTO`

# javascript - 当我使用 Javascript 时，我的 HTML 内容不显示

> ID：10896272
> 
> 赞同：1
> 
> 时间：2012-06-05T11:12:49.573
> 
> 标签：javascript, jquery, ajax

当我使用脚本使用 ajax 从特定 url 获取内容时，不显示我的 HTML 内容，即不显示我的表格元素：我从特定 url 获取数据并将其显示在警报框中，并且还`document.write`用于在页面上写入来自我调用的 url 的数据：

```
<head>
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0a4/jquery.mobile-1.0a4.min.css" />
  <script src="http://code.jquery.com/jquery-1.5.2.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.0a4/jquery.mobile-1.0a4.min.js"></script>
  <script type="text/javascript">
  $(document).ready(function() {
    $.ajax({
      type:"POST",
      url:"http://your url",
      success: onSuccess,
      error:onError
    });
  });
  function onSuccess(data){
    var servertext=data;
    document.write(servertext);
    alert(servertext);
  }
  function onError(data){
    alert(data+'error');
  }
  </script>
</head>
<body>
  <p> hello</p>
  <table height="150px" weight="150px" border="1px">
  <tr>
    <td><img src="green.png" height="100px" width="100px" /></td>
  </tr>
</table> 
```

`enter code here`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T11:15:50.967

`document.write`页面完成加载后不应使用。如果你调用它，它会隐式调用`document.open`，这会使页面空白并创建一个新文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:17:57.100

如果你`servertext`是 html，那么试试这个：

```
<script type="text/javascript">
    $(document).ready(function() {
            $.ajax({
                type:"POST",
                url:"http://your url",
                success: onSuccess,        
                error:onError                   
            });          
    });
    function onSuccess(data){
        var servertext=data;

        $("div#ajaxContent").html(servertext);

        alert(servertext);
    }
    function onError(data){
    alert(data+'error');

    }       
</script>
</head>
<body>
<p> heloo</p>
     <table height="150px" weight="150px" border="1px">     
        <tr>
            <td> <img src="green.png" height="100px" width="100px" /></td>
        </tr>
    </table>
    <div id="ajaxContent"></div>
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T11:16:25.997

不要使用`document.write`，因为它不会起作用并且是错误的。

相反，向您的 HTML 添加一些占位符元素，然后分配响应：

```
document.getElementById("myplaceholder").innerHTML = servertext; 
```

这会将响应放入定义为的元素中：

```
<div id="myplaceholder"></div> 
```

另请注意，您只能将请求发送到与包含 AJAX 代码的页面位于同一域下的页面。（[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)）

# android - 如何从停止的地方开始播放视频

> ID：10896275
> 
> 赞同：4
> 
> 时间：2012-06-05T11:13:27.620
> 
> 标签：android, video

我正在使用 VideoView 播放视频。如果我退出应用程序，在返回应用程序时，即在 onResume() 中，它应该从停止的位置播放视频。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:20:41.573

要获得当前进度（在 onPause 中检查）：

```
long progress = mVideoView.getCurrentPosition(); 
```

恢复（在 onResume 中）：

```
mVideoView.seekTo(progress); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T11:31:01.373

在 onPause() 中，保存播放器的当前位置，例如在共享偏好中。在 onResume() 中，检索值，然后使用 MediaPlayer.seekTo() 定位。

[http://developer.android.com/reference/android/media/MediaPlayer.html#seekTo(int)](http://developer.android.com/reference/android/media/MediaPlayer.html#seekTo%28int%29)

```
@Override
protected void onPause() {

    Log.d(App.TAG, "onPause called");

    if(mMediaPlayer==null){
        Log.d(App.TAG, "Returning from onPause because the mediaplayer is null");
        super.onPause();
        return;
    }

    // the OS is pausing us, see onResume() for resume logic
    settings = getSharedPreferences(Dawdle.TAG, MODE_PRIVATE);
    SharedPreferences.Editor ed = settings.edit();
    mMediaPlayer.pause();
    ed.putInt("LAST_POSITION", mMediaPlayer.getCurrentPosition());  // remember where we are
    ed.putBoolean("PAUSED", true); 
    ed.commit();
    Log.d(App.TAG, "LAST_POSITION saved:" + mMediaPlayer.getCurrentPosition());

    super.onPause();
    releaseMediaPlayer();

}

@Override
public void onResume() {
    Log.d(App.TAG, "onResume called");

    try {

        if (mMediaPlayer==null){
            setupMediaPlayer();
        }

        // if we were paused (set in this.onPause) then resume from the last position
        settings = getSharedPreferences(Dawdle.TAG, MODE_PRIVATE);
        if (settings.getBoolean("PAUSED", false)) {
            // resume from the last position
            startPosition= settings.getInt("LAST_POSITION", 0);
            Log.d(App.TAG,"Seek to last position:" + startPosition);
        }

        mMediaPlayer.setDataSource(path);
        mMediaPlayer.setDisplay(holder);

        // this is key, the call will return immediately and notify this when the player is prepared through a callback to onPrepared
        // so we do not block on the UI thread - do not call any media playback methods before the onPrepared callback
        mMediaPlayer.prepareAsync();  

    } catch (IllegalArgumentException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IllegalStateException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

}

private void startVideoPlayback() {
    Log.v(App.TAG, "startVideoPlayback at position:" + startPosition);
    mMediaPlayer.seekTo(startPosition);
    mMediaPlayer.start();
} 
```

# nfc - 带平板电脑的 NFC 阅读器

> ID：10896280
> 
> 赞同：0
> 
> 时间：2012-06-05T11:13:53.900
> 
> 标签：nfc, android

> **可能重复：**
> [如何将外部 NFC 读卡器连接到平板电脑（Android 2.3.3）](https://stackoverflow.com/questions/9451411/how-to-connect-external-nfc-card-reader-to-tabletandroid-2-3-3)

这可能是这个的重复

[如何将外部 NFC 读卡器连接到平板电脑](https://stackoverflow.com/questions/9451411/how-to-connect-external-nfc-card-reader-to-tabletandroid-2-3-3/10895247#10895247)

我想连接[http://www.sensorid.it/en/products/stickid.html的 nfc USB 阅读器](http://www.sensorid.it/en/products/stickid.html)

使用运行 android OS 3.2 的平板电脑。我需要使用我的应用程序和上面提到的 NFC 阅读器读取 nfc 标签。

到目前为止，我无法得出任何结论。这可能吗？如果是，我的出发点应该是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T07:23:12.483

经过一些研究..我的结论是，如果没有制造商的帮助，我们无法与 NFC 阅读器交谈，因为他们知道如何与之通信..他们使用什么协议。

所以我的问题的解决方案是使用兼容 HID 的 NFC 阅读器。

就像我在[http://www.rsdm-systems.de/products/de/RFID-Systeme-LF-HF/RFID-Sticks/RFID-Stick-Mifare-Classic-USB.html找到的一样](http://www.rsdm-systems.de/products/de/RFID-Systeme-LF-HF/RFID-Sticks/RFID-Stick-Mifare-Classic-USB.html)

这解决了我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T08:48:08.007

您将无法直接使用它。

1.  3.2 支持主机功能，因此它会识别 USB 设备。
2.  我怀疑您的读者是否能够直接与操作系统对话，因为在读取和转换为操作系统可理解的值之前必须经过层之间的层。
3.  你应该和制造商谈谈，看看他们是否找到了办法。那么你应该继续购买它。

# debugging - 如何在 Google Chrome 中调试选项卡崩溃

> ID：10896281
> 
> 赞同：39
> 
> 时间：2012-06-05T11:13:54.267
> 
> 标签：debugging, google-chrome, crash

我们有一个单页应用程序会随机崩溃整个浏览器选项卡。我观察了一个多小时的记忆，但它并没有增加，一切看起来都很好。过了一段时间后，标签突然崩溃了。

我在中寻找崩溃转储

```
C:\Users\cburgdorf\AppData\Local\Google\CrashReports 
```

但是 Chrome-last.dmp 已经完全过时了。是否有任何地方可以查找有关崩溃的其他信息？更不用说它是一个难以复制的野兽。

*我想知道我是否可以在附加了windbg*的情况下启动 Chrome 并等待（2 小时左右）标签崩溃。那行得通吗？

**更新**

你们所有人都给出了很好的答案，并为寻找错误提供了有价值的建议。最后，我能够使用以下步骤重现该错误并获得清晰的故障转储：

```
1.) windbg.exe -o chrome.exe
2.) reproduce crash
3.) .dump /ma C:\Path\To\A\CrashDump\File.dmp (as Paul pointed out)
4.) end session and load the crash dum with windbg
5.) use !analyze -v to extract valuable information 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T09:41:31.913

一旦 WinDbg 进入，使用这个命令来创建一个完整的故障转储：

```
.dump /ma C:\Path\To\A\CrashDump\File.dmp 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T12:33:31.887

如果您只想分析特定选项卡，则应按照以下步骤操作。

*   打开 Chrome 的任务管理器（菜单中的查看背景页面选项）。
*   右键单击网格并激活进程 ID 列。
*   并将windbg附加到这个pid。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T21:12:25.153

按照[http://www.chromium.org/for-testers/bug-reporting-guidelines/reporting-crash-bug](http://www.chromium.org/for-testers/bug-reporting-guidelines/reporting-crash-bug)上的说明报告渲染器崩溃，以便 Chromium 开发人员可以对其进行调试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T11:26:09.953

您可以尝试在 chrome 中使用 firebug 并给我一个日志吗？ [http://getfirebug.com/wiki/index.php/Command_Line_API](http://getfirebug.com/wiki/index.php/Command_Line_API)

更新。您需要使用调试选项启动 chrome。

```
 --enable-logging --v=1 
```

# jboss7.x - 让您知道：JBoss 7.1.1 中每个部署的 webapp SLF4J 和 Logback

> ID：10896282
> 
> 赞同：4
> 
> 时间：2012-06-05T11:13:59.137
> 
> 标签：jboss7.x, slf4j, logback

在 JBoss 团队支持每个部署的 slf4j 日志记录之前，您可以为 webapps 执行此操作：

*   将 logback.xml 放在 src/main/resources/ （或 WEB-INF/classes/ 对于非 maven2 项目）：

    ```
    <configuration scan="true" scanPeriod="3 seconds" debug="true">
        <contextName>[webAppName]</contextName>
        <include file="/opt/jboss/includedConfig.xml"/>
    </configuration> 
    ```

    IncludedConfig.xml 现在可以在运行时进行修改，从而保存重新部署以记录更改

*   在 WEB-INF 中放一个 jboss-deployment-structure.xml：

    ```
    <jboss-deployment-structure>
        <deployment>
            <exclusions>
                <module name="org.apache.commons.logging"/>
                <module name="org.apache.log4j"/>
                <module name="org.jboss.logging"/>
                <module name="org.jboss.logging.jul-to-slf4j-stub"/>
                <module name="org.jboss.logmanager"/>
                <module name="org.jboss.logmanager.log4j"/>
                <module name="org.slf4j"/>
            </exclusions>
        </deployment>
    </jboss-deployment-structure> 
    ```

    仅当您包含 jcl-over-slf4j 和 log4j-over-slf4j 时，您才需要排除 commons-logging 和 log4j

# iphone - 带背景图片的 TableView

> ID：10896283
> 
> 赞同：0
> 
> 时间：2012-06-05T11:14:01.260
> 
> 标签：iphone, ios, uitableview, uiimage

我想在我的 tableview 后面有一个图像，我在后面添加了一个 UIImage 并将 tableview 背景设置为清除，在 IB 中它显示了 tableview 后面的图像但是当我运行它时我得到一个黑色背景，有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:25:26.903

取下图像并将此代码添加到您的 viewDidLoad：

```
UIView *patternView = [[UIView alloc] initWithFrame:self.tableView.frame];
patternView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"background.png"]];
patternView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
self.tableView.backgroundView = patternView; 
```

这是添加固定图像作为表格视图背景的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T20:01:17.737

或者你可以通过简单地在你的主控制器类中分配 tableview 的 backgroundView 属性来做到这一点而无需子类化......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T06:13:50.037

`-(void)viewDidLoad`在方法中尝试以下代码

```
self.tblView= [[UITableView alloc] initWithFrame:CGRectMake(17,110, 280.0, 265) style:UITableViewStyleGrouped];
    self.tblView.delegate=self;
    self.tblView.dataSource=self;
    //self.tblView.backgroundColor=[UIColor clearColor];
    self.tblView.backgroundView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"img3.png"]];
    [self.view addSubview:self.tblView]; 
```

# jquery - 在 jQuery UI 自动完成项之后附加分隔线，最后一项之后除外

> ID：10896284
> 
> 赞同：5
> 
> 时间：2012-06-05T11:14:05.763
> 
> 标签：jquery, jquery-ui, autocomplete, jquery-ui-autocomplete

我有一个 jQuery UI 自动完成绑定到一个输入元素和一个自定义显示自动完成框中的项目。每个项目都有多行，我想将项目彼此清楚地分开，例如使用一个`<hr />`元素。以下工作，但它也在`<hr />`最后一项之后呈现一个元素：

```
$(function () {
    $("#Customer").autocomplete({
        source: "/SomePath/SearchCustomers?term=ABC",
        select: function (event, ui) {
            $("#CustomerId").val(ui.item.customerId);
            return false;
        }
    })
    .data("autocomplete")._renderItem = function (ul, item) {
        var renderedItem = $("<li></li>")
            .data("item.autocomplete", item)
            .append("<a>" + item.customerId + ", " + item.name + "<br />"
                + item.addressLine1 + "<br />"
                + item.countryCode + ", " + item.city + "</a>");

        // if (IsNotTheLastItem(item))  <-- Is something like this possible?
            renderedItem = renderedItem.append("<hr />");

        renderedItem = renderedItem.appendTo(ul);

        return renderedItem;
    };
}); 
```

（代码源自此处的示例：http: [//jqueryui.com/demos/autocomplete/#custom-data](http://jqueryui.com/demos/autocomplete/#custom-data)（单击“查看源代码”）。）

是否可以确定我要渲染的项目是否是最后一个项目（如上面的注释行所示）？或者是否有一些替代方法可以在项目之间添加分隔符，但不是在最后一项之后？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T11:20:39.157

由于您显然`<hr>`仅将元素用于视觉目的，我认为您可以仅使用 CSS 轻松解决此问题：而不是通过 javascript`<hr>`在每个元素中生成一个元素，只需为除第一个元素之外的每个元素`<li>`分配一个边框顶部`<li>`

```
ul li:not(:first-child) { border-top: 1px #ccc solid; padding: 2em 0; } 
```

产生的效果将是除最后一个之外的每个列表项下的一行，您将避免通过 javascript 注入标记，并且 - 更重要的是 - 插入不必要的逻辑来检测您的最后一项

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T15:17:14.837

@F。Calderan 的答案是 99% 的解决方案。以下只是他答案的一个小附录：

我没有立即在他的回答中找到适合 css 样式的选择器。问题是 jQuery UI 将自动完成项的`ul`和`li`元素放在页面元素的底部`body`：

```
<body>
    <input id="Customer" name="Customer" />

    // more stuff

    // jQuery UI puts the rendered search result here at the end of the page body
    <ul>
        <li>...</li>
        <li>...</li>
        <li>...</li>
    </ul>
</body> 
```

这里没有可用于选择`ul/li`样式的类或 ID，我不想在`body`级别上定义此样式，因为该页面还有其他列表（如主菜单），不应应用此样式。

`body`但是将结果列表附加到元素只是默认设置。可以使用`appendTo`Autocomplete 小部件的选项覆盖它：

```
$("#Customer").autocomplete({
    appendTo: "#CustomerWrapper",
    //...
}) 
```

现在结果列表被附加到具有 id 的元素`CustomerWrapper`。我已将`input`元素包装成`div`具有该 ID 的元素并应用了额外的类样式`ui-autocomplete-multilineitems`，因为我只想要自动完成的分隔线，其中项目有多行：

```
<div id="CustomerWrapper" class="ui-autocomplete-multilineitems">
    <input id="Customer" name="Customer" />
</div> 
```

（该`input`元素不需要包裹在 . 中`div`。`div`可以放置在页面上的任何其他位置。）

现在渲染的结果是：

```
<div id="CustomerWrapper" class="ui-autocomplete-multilineitems">
    <input id="Customer" name="Customer" />

    <ul>
        <li>...</li>
        <li>...</li>
        <li>...</li>
    </ul>
</div> 
```

而且我只能为 css 文件中的那些列表元素定义样式：

```
.ui-autocomplete-multilineitems ul li {
    border-top: 1px #ccc solid;
    padding: 2em 0;
}

.ui-autocomplete-multilineitems ul li:first-child {
    border-top: none;
    padding-top: 0;
} 
```

# excel - 到excel中的条件

> ID：10896288
> 
> 赞同：0
> 
> 时间：2012-06-05T11:14:18.107
> 
> 标签：excel, graph, excel-formula

我正在尝试根据我的测试结果创建一个图表。

目前我有这样的事情。

```
=COUNTIF(E22:E36,I19) 
```

我想做类似的事情`=if=Test1(COUNTIF(E22:E36,I19))`

我有一些这样的结果

```
**Test name** 
-------
Test1
Test1
Test1
Test1

**Result**
-------
Pass
Pass
Pass
Fail
Fail

**Total**
-------
1
23
4
5
5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:45:32.837

您使用的是哪个版本的 Excel？在 Excel 2007 或更高版本中尝试使用“S”的 COUNTIFS，例如假设测试名称（Test1、Test2 等）在 D 列中尝试

`=COUNTIFS(E22:E36,I19,D22:D36,"Test1")`

或在早期版本的 excel 中尝试 SUMPRODUCT，即

`=SUMPRODUCT((E22:E36=I19)*(D22:D36="Test1"))`

# php - 当您向 CButtonColumn 添加多个按钮时，CGridView 筛选器不起作用

> ID：10896290
> 
> 赞同：1
> 
> 时间：2012-06-05T11:14:26.450
> 
> 标签：php, yii, cbuttoncolumn

我有一个 CGridView 如下，

```
<?php $this->widget('zii.widgets.grid.CGridView', array(
'id'=>'order-grid',
'dataProvider'=>$model->search(),
'filter'=>$model,
'columns'=>array(
    'order_id',
    //'ordered_datetime',
    'customer_id',
    'status',
    //'delivery_address',
    array(
        'class'=>'CButtonColumn',
        'template' => '{view} {rollback} {receive}{pack} {dispatch}{delivered}',
        'htmlOptions'=>array('width'=>'250px'),
        'buttons'=>array(
            'receive'=>array(
                'id'=>'receive',
                'name'=>'receive',
                'url'=>'$this->grid->controller->createUrl("/shop/order/admin&received=true", array("id"=>$data->order_id,"asDialog"=>1,"gridId"=>$this->grid->id))',
                'type'=>'submit',
                'imageUrl'=>'/mdg/images/Receive1.png',
                'visible'=>'($data->status=="pending")?true:false;'
             ),
                             'rollback'=>array(
                'id'=>'rollback',
                'name'=>'rollback',
                                     'click'=>''
                'url'=>'$this->grid->controller->createUrl("/shop/order/admin&rollback=true", array("id"=>$data->order_id,"asDialog"=>1,"gridId"=>$this->grid->id))',
                'imageUrl'=>'/mdg/images/rollback.jpg',
                'visible'=>'($data->status=="pending")?false:true;'
             ),

        ),
    ),
),
)); ?> 
```

当我向按钮数组添加一个按钮时，过滤器不起作用。任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T16:38:11.620

按钮的数组中有一个额外`click => '',`的。`recieve`

# php - PHPUnit 在运行第一个测试之前设置并在运行最后一个测试后拆除

> ID：10896293
> 
> 赞同：25
> 
> 时间：2012-06-05T11:14:31.300
> 
> 标签：php, phpunit

我正在尝试为使用 PHPUnit 的 php 应用程序实现类似 Django 的测试实用程序。像 Django 一样，我的意思是在运行第一个测试之前从主数据库创建一个单独的测试数据库，并在运行最后一个测试后删除它。即使一次运行许多测试用例，测试数据库也只需要创建一次。

为此，我采取了以下方法 -

我定义了一个自定义测试套件类，这样我就可以在它的 setup 和 teardown 方法中编写用于创建和删除数据库的代码，然后使用这个类来运行测试，如下所示

```
$ phpunit MyTestSuite 
```

MyTestSuite 定义了一个名为`suite`where I just use的静态方法`glob`，并将测试添加到测试套件，如下所示

```
public static function suite() {
    $suite = new MyTestSuite();

    foreach (glob('./tests/*Test.php') as $tc) {
        require_once $tc;
        $suite->addTestSuite(basename($tc, '.php'));
    }

    return $suite;
} 
```

所有测试用例类都从 的子类扩展而来`PHPUnit_Framework_TestCase`，该类的设置和拆卸方法负责从 json 夹具文件中加载和清除初始数据。

现在作为没有。测试的数量正在增加，我一次只需要运行一个选定的测试。但是由于我已经在使用测试套件加载测试，所以不能使用 --filter 选项。这让我觉得这种方法可能不是正确的方法。

所以我的问题是，无论 PHPUnit 如何找到它们，在运行第一个测试之前和运行最后一个测试之后做某事的正确方法是什么？

PS：我没有使用 PHPUnit_Extensions_Database_TestCase，而是我自己的创建、填充和删除数据库的实现。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-06-06T02:20:40.417

我最近遇到了一些我需要解决同样问题的东西。我用自定义类的方法尝试[了 Edorian 的答案](https://stackoverflow.com/a/10897030/390977)`__destruct`，但它似乎在每次测试结束时运行，而不是在*所有*测试结束时运行。

我没有在 bootstrap.php 文件中使用特殊的类，而是在[`register_shutdown_function`](http://php.net/manual/en/function.register-shutdown-function.php)所有测试结束后利用 PHP 的函数来处理数据库清理，而且它似乎工作得很好。

这是我在 bootstrap.php 文件中的示例

```
register_shutdown_function(function(){
   some_db_cleanup_methods();
}); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-06-05T12:07:44.937

我的两个不使用的自发想法`"Test Suites"`。一个在底部。

### 测试监听器

使用[**`PHPUnits test listeners`**](https://phpunit.de/manual/current/en/extending-phpunit.html#extending-phpunit.PHPUnit_Framework_TestListener)你可以做一个

```
 public function startTestSuite(PHPUnit_Framework_TestSuite $suite)
  {
       if($suite->getName() == "yourDBTests") { // set up db
  }

  public function endTestSuite(PHPUnit_Framework_TestSuite $suite)
  {
       if($suite->getName() == "yourDBTests") { // tear down db
  } 
```

您可以在 xml 配置文件中的测试套件中定义所有数据库测试，如下所示[**`in the docs`**](http://www.phpunit.de/manual/3.6/en/organizing-tests.html#organizing-tests.xml-configuration)

```
<phpunit>
  <testsuites>
    <testsuite name="db">
      <dir>/tests/db/</dir>
    </testsuite>
    <testsuite name="unit">
      <dir>/tests/unit/</dir>
    </testsuite>
  </testsuites>
</phpunit> 
```

### 引导程序

使用 phpunits 引导文件，您可以创建一个创建数据库的类，并`__destruct`在进程结束时以自己的方法将其删除。

将对对象的引用放在某个全局范围内将确保对象仅在所有测试结束时才被解构。（正如@beanland 指出的那样：使用 register_shutdown_function() 更有意义！）

* * *

## 使用测试套件：

[http://www.phpunit.de/manual/3.2/en/organizing-test-suites.html](http://www.phpunit.de/manual/3.2/en/organizing-test-suites.html)显示：

```
<?php

class MySuite extends PHPUnit_Framework_TestSuite
{
    public static function suite()
    {
        return new MySuite('MyTest');
    }

    protected function setUp()
    {
        print "\nMySuite::setUp()";
    }

    protected function tearDown()
    {
        print "\nMySuite::tearDown()";
    }
}

class MyTest extends PHPUnit_Framework_TestCase
{
    public function testWorks() {
        $this->assertTrue(true);
    }
} 
```

这在 PHPUnit 3.6 中运行良好，并将在 3.7 中运行。它不在当前文档中，因为“测试套件类”在某种程度上已被弃用/不鼓励，但它们将存在相当长的一段时间。

* * *

请注意，为每个测试用例拆除和设置整个数据库对于对抗测试间依赖关系非常有用，但如果您不在内存中运行测试（如 sqlite 内存），那么速度可能不值得。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-09-22T09:21:59.537

在 2020 年，@edorian 的方式已经被[弃用](https://github.com/sebastianbergmann/phpunit/issues/4039)：

```
/**
 * @throws Exception
 *
 * @deprecated see https://github.com/sebastianbergmann/phpunit/issues/4039
 */
public function testSuiteLoaderClass(): string
{
    ///
} 
```

[来源](https://github.com/sebastianbergmann/phpunit/blob/cfc60ae52929328b7e261334cb55976147af9493/src/TextUI/XmlConfiguration/PHPUnit/PHPUnit.php#L527)

## 新解决方案

现在我们需要通过[extensions使用](https://phpunit.readthedocs.io/en/9.3/configuration.html#the-extensions-element)[TestRunner](https://phpunit.readthedocs.io/en/9.3/extending-phpunit.html#extending-the-testrunner)。将此代码添加到：`phpunit.xml`

```
<extensions>
    <extension class="Tests\Extensions\Boot"/>
</extensions>
<testsuites>
  ...
</testsuites> 
```

`Tests/Extensions/Boot.php`：

```
<?php

namespace Tests\Extensions;

use PHPUnit\Runner\AfterLastTestHook;
use PHPUnit\Runner\BeforeFirstTestHook;

class Boot implements BeforeFirstTestHook, AfterLastTestHook
{
    public function executeBeforeFirstTest(): void
    {
        // phpunit --testsuite Unit
        echo sprintf("testsuite: %s\n", $this->getPhpUnitParam("testsuite"));

        // phpunit --filter CreateCompanyTest
        echo sprintf("filter: %s\n", $this->getPhpUnitParam("filter"));

        echo "TODO: Implement executeBeforeFirstTest() method.";
    }

    public function executeAfterLastTest(): void
    {
        // TODO: Implement executeAfterLastTest() method.
    }

    /**
     * @return string|null
     */
    protected function getPhpUnitParam(string $paramName): ?string
    {
        global $argv;
        $k = array_search("--$paramName", $argv);
        if (!$k) return null;
        return $argv[$k + 1];
    }
} 
```

### 执行

纯PHP：

```
phpunit --testsuite Unit --filter CreateCompanyTest 
```

拉拉维尔：

```
php artisan test --testsuite Unit --filter CreateCompanyTest 
```

输出：

```
PHPUnit 9.3.10 by Sebastian Bergmann and contributors.

testsuite: Unit
filter: CreateCompanyTest
TODO: Implement executeBeforeFirstTest() method. 
```

# salesforce - 尝试通过 apex 控制器类插入新用户时，我面临许可证限制超出异常

> ID：10896298
> 
> 赞同：1
> 
> 时间：2012-06-05T11:14:56.910
> 
> 标签：salesforce, apex-code, visualforce

我创建了一个用于创建新用户的 visualforce 页面，并通过控制器类尝试插入新创建的用户。

我正在开发一个开发人员组织，并拥有三个可用于 - Salesforce 平台 - 用户许可证的许可证。我在我的组织中创建了 4 个具有此许可证的用户，其中只有一个处于活动状态。

当我尝试使用此许可证插入新用户时，我仍然面临许可证限制超出异常。

任何人都可以为这个问题提出一个解决方案吗？

我正在使用的代码是 -

```
 newUser = new User();

    newUser.email = ApexPages.currentPage().getParameters().get('email');
    String[] name = ApexPages.currentPage().getParameters().get('name').split(' ',2);
    newUser.firstName = name[0];
    newUser.lastName = name[1];
    newUser.userName = newUser.email;

    UserRole usrRole = [select id, name from UserRole where name = 'Customer'];
    Profile prof = [select id, name from Profile where name = 'Customer Portal'];

    newUser.UserRoleId = usrRole.id;
    newUser.ProfileId = prof.id;
    newUser.isActive = true;
    try
    {            
        insert newUser;
        alertMsg = 'Successfully Created New User';                
    }
    catch(System.DMLException e)
    {                 
        alertMsg = e.getMessage();         
    } 
```

我公司信息的截图是——

![用户许可的公司信息](../Images/1aa682fe5e94ee3ae68f1292072ba481.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:54:02.650

选项 1：在开发者控制台中，运行此匿名 apex 代码片段以获取活动和非活动用户的计数：system.debug([select isactive, count(Id) from User group by isactive]);

上述 SQL 的结果应该是 3 个非活动用户和 1 个活动用户（根据您的问题陈述）。

选项 2：确保您的控制器类不会批量插入超出开放许可证数量的用户。

选项 3：确保您的代码没有尝试使用与已用完的许可证类型绑定的配置文件来创建用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T15:01:48.487

除了设置配置文件，您还需要设置 UserType（又名许可证类型），否则默认为 Salesforce 许可证，您没有备用许可证，您需要添加类似`newUser.userType = 'Platform'`（您需要使用 describeSObject 或一个模式查看器工具，用于查找要使用的确切选项列表值）

# php - 如何在 jQuery 游戏（ping 函数）中最小化 mysql 连接和 ajax 调用？

> ID：10896309
> 
> 赞同：0
> 
> 时间：2012-06-05T11:15:54.263
> 
> 标签：php, jquery, mysql, connection, ping

我正在编写一个基于浏览器的游戏。客户端使用 jQuery，服务器使用 PHP/MySQL。

这是一款回合制游戏，所以大部分客户端与服务器的通信都是通过调用-响应（jQuery-PHP）来实现的。每当用户单击按钮或任何其他活动元素时，都会发生该调用。在 JQuery 中调用后，PHP 控制器创建一些类，连接到数据库并返回响应。这种沟通对我来说非常好，不会导致连接数等问题（它类似于使用网站期间的标准流量）。

不幸的是，我还需要一些来自服务器端的“调用”。该示例是要加入的活动游戏列表。游戏列表更改时必须通知客户。最大延迟不超过 1 秒。

现在我通过从客户端（jQuery）和服务器发送“无”的“ping”调用来实现它，或者“game2 created”等。但是每个玩家每秒都会发送“ping”。对于它们中的每一个，服务器将创建类并连接到导致“数据库连接错误”的 mysql。

有什么方法可以最小化 mysql 连接和/或 ajax 调用？我使用标准的 www 服务器，没有 root 帐户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:29:59.603

从这个开始：

```
But that 'pings' will be send every second from each of the players 
```

而不是两个玩家都调用`every second`服务器（实际上是 2 个调用，每个连接的玩家的数量都会增加），您可以通过检查 ;`idle time`或经过的时间来优化它`doing nothing`。如果 2 次连续调用没有返回任何内容，则应将调用延迟增加到**2 秒**，然后再增加到**4 秒**等（只需使用[setInterval](http://www.w3schools.com/jsref/met_win_setinterval.asp)并使其连续运行）；这将允许您的应用程序**呼吸**（我有自己的游戏使用它）

接下来要做的是**调用策略**；不用在玩家的命令中调用服务器，您可以将玩家的命令存储在一个 js 数组中，每 X 秒发送一次该数组；如果没有命令，则没有 ajax 调用。是的，您会遇到延迟，但请考虑许多用户连接到可能较差的服务器...

如果您想进一步推动事情，您也可以使用[彗星技术。](http://en.wikipedia.org/wiki/Comet_%28programming%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:29:38.747

话虽如此，这可能是 eggyal 提到的可能重复..

关于 ping 和响应（客户端 ping 服务器场景）

1）您是否考虑过编写临时文件（即缓存时间为 X 的 Smarty 编译文件）？一旦玩家 Y 完成它的操作，删除文件（或在该文件中写入一些内容）。

每个玩家使用 game_id（或任何唯一的）执行 AJAX 请求，这将检查该编译文件的存在。这将为您节省许多 mysql 调用。如果文件的缓存时间已过期，您将调用 mysql。

2）丑陋->尝试mysql持久连接是否有帮助（我不确定）

# android - 如何从 .t xt 文件中读取

> ID：10896312
> 
> 赞同：0
> 
> 时间：2012-06-05T11:16:00.210
> 
> 标签：android, android-layout

我正在尝试从服务器上存在的文件中读取文本，该文件包含文本“hello world”，现在我想在 TextView 上写入此文本。我已经导入了所有必需的包。提前致谢

```
 public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        TextView tv = new TextView(this);

        try {
            URL updateURL = new URL("http://--------------------/foldername/hello.txt");                
            URLConnection conn = updateURL.openConnection(); 
            InputStream is = conn.getInputStream();
            BufferedInputStream bis = new BufferedInputStream(is);
            ByteArrayBuffer baf = new ByteArrayBuffer(50);

            int current = 0;
            while((current = bis.read()) != -1){
                 baf.append((byte)current);
            }

            final String s = new String(baf.toByteArray());     
            ((TextView)tv).setText(s); 

        } catch (Exception e) {
        }
    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:19:28.520

试试这个功能....

```
 public static String convertStreamToString(InputStream is) throws Exception {
        BufferedReader reader = new BufferedReader(new InputStreamReader(is));
        StringBuilder sb = new StringBuilder();
        String line = null;

        while ((line = reader.readLine()) != null) {
            sb.append(line);
        }

        is.close();

        return sb.toString();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:49:54.650

试试这个代码

```
 URL url = new URL(urlpath);
 BufferedInputStream bis = new BufferedInputStream((url.openStream()));
 DataInputStream dis = new DataInputStream(bis);
 String full = "";
 String line;
 while ((line=dis.readLine())!=null) {
     full +=line;               
  }      
bis.close();
dis.close();

((TextView)tv).setText(full); 
```

# java - ["abc", ["123", "cba"]] 的正则表达式

> ID：10896315
> 
> 赞同：1
> 
> 时间：2012-06-05T11:16:11.490
> 
> 标签：java, regex

我不擅长正则表达式，所以任何帮助将不胜感激。

我需要解析这样的字符串：

```
["text", "text", ["text",["text"]],"text"] 
```

输出应该是（4个字符串）：

```
text, text, ["text",["text"]], text 
```

我试过这种模式`(\\[[^\\[,^\\]]*\\])|(\"([^\"]*)\")`：

```
String data="\"aa\", \"aaa\", [\"bb\", [\"1\",\"2\"]], [cc]";
Pattern p=Pattern.compile("(\\[[^\\[,^\\]]*\\])|(\"([^\"]*)\")"); 
```

但是输出是（输出中的引号本身并不那么重要）：

```
"aa", "aaa", "bb", "1", "2", [cc] 
```

如何改进我的正则表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:52:42.257

我不确定正则表达式能够自己做那种事情。不过，这是一种方法：

```
// data string
String input = "\"aa\", \"a, aa\", [\"bb\", [\"1\", \"2\"]], [cc], [\"dd\", [\"5\"]]";
System.out.println(input);

// char that can't ever be within the data string
char tempReplacement = '#';
// escape strings containing commas, e.g "hello, world", ["x, y", 42]
while(input.matches(".*\"[^\"\\[\\]]+,[^\"\\[\\]]+\".*")) {
    input = input.replaceAll("(\"[^\"\\[\\]]+),([^\"\\[\\]]+\")", "$1" + tempReplacement + "$2");
}
// while there are "[*,*]" substrings
while(input.matches(".*\\[[^\\]]+,[^\\]]+\\].*")) {
    // replace the nested "," chars by the replacement char
    input = input.replaceAll("(\\[[^\\]]+),([^\\]]+\\])", "$1" + tempReplacement + "$2");
}

// split the string by the remaining "," (i.e. those non nested)
String[] split = input.split(",");

List<String> output = new LinkedList<String>();
for(String s : split) {
    // replace all the replacement chars by a ","
    s = s.replaceAll(tempReplacement + "", ",");
    s = s.trim();
    output.add(s);
}

// syso
System.out.println("SPLIT:");
for(String s : output) {
    System.out.println("\t" + s);
} 
```

输出：

```
"aa", "a, aa", ["bb", ["1", "2"]], [cc], ["dd", ["5"]]
SPLIT:
    "aa"
    "a, aa"
    ["bb", ["1","2"]]
    [cc]
    ["dd", ["5"]] 
```

PS：代码似乎很复杂，因为已注释。这是一个更简洁的版本：

```
public static List<String> split(String input, char tempReplacement) {
    while(input.matches(".*\"[^\"\\[\\]]+,[^\"\\[\\]]+\".*")) {
        input = input.replaceAll("(\"[^\"\\[\\]]+),([^\"\\[\\]]+\")", "$1" + tempReplacement + "$2");
    }
    while(input.matches(".*\\[[^\\]]+,[^\\]]+\\].*")) {
        input = input.replaceAll("(\\[[^\\]]+),([^\\]]+\\])", "$1" + tempReplacement + "$2");
    }
    String[] split = input.split(",");
    List<String> output = new LinkedList<String>();
    for(String s : split) {
        output.add(s.replaceAll(tempReplacement + "", ",").trim());
    }
    return output;
} 
```

称呼：

```
String input = "\"aa\", \"a, aa\", [\"bb\", [\"1\", \"2\"]], [cc], [\"dd\", [\"5\"]]";
List<String> output = split(input, '#'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T11:32:29.497

似乎您的输入中有递归，因此如果您有许多嵌套`[]`的正则表达式可能不是最好的解决方案。

为此，我认为使用简单算法更好/更容易使用`indexOf()`and `substring()`。它也更高效！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T11:34:15.043

不幸的是，我认为你不能用 Java 正则表达式来做到这一点。您在这里拥有的是递归表达式。这种类型的语言无法修改为基本的正则表达式（这`Pattern`实际上是java）。

但是为该语言编写一个小的递归下降解析器并不难。

您可以查看以下答案以获取灵感：[java method for parsing nested expressions](https://stackoverflow.com/questions/7251781/java-method-for-parsing-nested-expressions)

# flash - 在 ActionScript 3（AIR 应用程序）中，仅使用 stageDisplayState 来全屏并不会最大化整个舞台，只会最大化某些元素

> ID：10896317
> 
> 赞同：0
> 
> 时间：2012-06-05T11:16:14.087
> 
> 标签：flash, actionscript, air, fullscreen

我正在使用 Flash CS 5.5 为我的雇主构建一个 AIR 应用程序。该应用程序将安装在连接到纵向 (1080x1920) 平面触摸屏显示器的 Mac Mini 上。我希望能够在没有工具栏/标题栏可见的全屏模式下运行应用程序，但我遇到了这个问题：

在我的一个图层上，我有一个 flvPlayback 实例，它根据用户输入播放视频。当我使用`stage.displayState = StageDisplayState.FULL_SCREEN_INTERACTIVE`而不是使整个舞台全屏时，它使 flvPlayback 元素全屏并且舞台上的其他所有内容都消失了。

我曾尝试通过鼠标单击、计时器以及仅在应用程序启动时执行此命令，但每次都会遇到此问题。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:22:55.930

`FLVPlayback`有一个名为`fullScreenTakeOver`（默认为 true）的属性。

如果您将其设置为 false 它应该可以解决您的问题。

# mercurial - 将 Hg 配置为不在命令行上询问用户名和密码

> ID：10896319
> 
> 赞同：8
> 
> 时间：2012-06-05T11:16:14.850
> 
> 标签：mercurial

当我尝试克隆经过 https 身份验证的 Mercurial 存储库（例如来自 kiln）时，它会询问我的用户名

```
C:\temp\test>hg clone https://<my-login-name>.kilnhg.com/Code/Repositories/Group/test
http authorization required
realm: kiln
user: 
```

我们希望使用`hg clone`用户提供的任何 URL 从我们的 GUI 应用程序调用命令，并根据*需要*向用户询问用户名和密码（如果需要）。

如何配置 Mercurial 以调用返回用户名/密码的任意脚本，类似于在环境变量`GIT_ASKPASS`或`SSH_ASKPASS`Git 中定义路径的脚本？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-05T11:43:39.827

您可以在用户范围内配置您的凭据`hgrc`（`mercurial.ini`在 Windows 上的用户配置文件目录中）：

```
[auth]
foo.prefix = example.com/path
foo.username = user
foo.password = password 
```

之后，对该服务器的请求将静默使用`hgrc`文件中提供的凭据。

有关更多信息，请参阅[文档。`hgrc`](http://www.selenic.com/mercurial/hgrc.5.html#auth)

* * *

**更新：**在研究了 TortoiseHg 源代码之后（有问题的代码是[sync.py](https://bitbucket.org/tortoisehg/thg/src/default/tortoisehg/hgqt/sync.py)`SyncWidget.inclicked`中的和`SyncWidget.pullclicked`方法），我发现 TortoiseHg 正是您想要实现的目标，显然首先尝试了auth 请求，如果已给出，则要求用户输入登录名和密码，以重建完整的 URL（带有凭据）并将其提供给.`hg pull`

我想你也可以这样做。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-05T11:25:30.730

关于什么

```
hg clone https://user:password@host:port 
```

这样的解决方案不适合您吗？

# mysql - MySQL 从另一个表插入 2 个选项 WHERE 语句

> ID：10896327
> 
> 赞同：1
> 
> 时间：2012-06-05T11:16:42.067
> 
> 标签：mysql, sql

*我已经完成了我的研究，但无法弄清楚如何做到这一点。从另一个表插入非常简单，但我想包含 WHERE 语句。*

我想将表 A 中的单个列 column_Q 的值插入表 B 的 column_Q 中，表 A 的 column_W = '100' 并且表 B 中不存在 column_Q。

我试过：

```
INSERT INTO B (column_Q) select DISTINCT(column_Q) 
from A WHERE column_W = 100 AND b.column_Q<>a.column_Q; 
```

我在哪里做错了？

PS。两个表都已包含值。没有字段为空。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T11:20:16.827

```
INSERT
INTO    b (q)
SELECT  DISTINCT q
FROM    a
WHERE   a.w = 100
        AND a.q NOT IN
        (
        SELECT  q
        FROM    b
        ) 
```

如果您`b.q`在其上定义了`UNIQUE`约束，则只需使用：

```
INSERT
IGNORE
INTO    b (q)
SELECT  q
FROM    a
WHERE   w = 100 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:27:19.107

您不能参考“分配”的左侧，因为 B 中没有当前行可比较（那将是您要插入的行）您需要检查 B 中是否已经存在类似的行，例如：

```
INSERT INTO B (column_Q)
SELECT DISTINCT(A.column_Q) 
FROM A 
WHERE A.column_W = 100
AND NOT EXISTS (
    SELECT *
    FROM B
    WHERE B.column_Q = A.column_Q
    ); 
```

# javascript - 在同一个类上包装多个 div 元素

> ID：10896332
> 
> 赞同：7
> 
> 时间：2012-06-05T11:17:02.253
> 
> 标签：javascript, jquery, html, class, wrapall

我想使用 jQuery 将类元素集包装在 a`div`但找不到解决方案。

HTML：

```
<div class="view-content">

  <div class="first">content</div>
  <div class="first">content</div>
  <div class="second">content</div>
  <div class="third">content</div>
  <div class="third">content</div>

</div>
```

期望的结果：

```
<div class="view-content">

  <div class="column">
    <div class="first">content</div>
    <div class="first">content</div>
  </div>

  <div class="column">
    <div class="second">content</div>
  </div>

  <div class="column">
    <div class="third">content</div>
    <div class="third">content</div>
  </div>

</div>
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T11:26:38.030

**演示** [http://jsfiddle.net/kQz4Z/8/](http://jsfiddle.net/kQz4Z/8/)

接口：[http ://api.jquery.com/wrapAll/](http://api.jquery.com/wrapAll/)

添加了一个断线，以便您可以在这里看到不同之处:) [http://jsfiddle.net/kQz4Z/10/](http://jsfiddle.net/kQz4Z/10/)

**代码**

```
$(function() {

    $('.first').wrapAll('<div class="column" />')

    $('.second').wrapAll('<div class="column" />')

    $('.third').wrapAll('<div class="column" />')

    alert($('.view-content').html());
});​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T11:31:29.863

使用 wrapAll() 方法

```
$(function(){
    var classes = ['.first', '.second', '.third'];

    for (i = 0; i < classes.length; i++) {
        $(classes[i]).wrapAll('<div class="column">');
    }​

}); 
```

演示：http: [//jsfiddle.net/g9G85/](http://jsfiddle.net/g9G85/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T11:45:12.700

或者这是非常简短的动态解决方案：

```
​$(".view-content > div").each(function() {
    $(".view-content > ." + this.className).wrapAll("<div class='column' />");
});​ 
```

**演示：http:** [//jsfiddle.net/CqzWy/](http://jsfiddle.net/CqzWy/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T11:25:36.950

您可以使用`.wrap()`将某些内容包装在 a 中，`div`但如果您的内容未排序，它将变得一团糟，这是一个示例：

输入

```
<div class="view-content">
    <div class="first">content</div>
    <div class="second">content</div>
    <div class="first">content</div>
</div> 
```

输出

```
<div class="view-content">
    <div class="column">
        <div class="first">content</div>
        <div class="column">
            <div class="second">content</div>
        </div>
        <div class="first">content</div>
    </div>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T13:02:26.200

你可以试试这个：

```
var arr = $(".view-content div").map(function() { return $(this).attr('class'); }).get();
var results = $.unique(arr);
var i;

for(i = 0; i < results.length; i++){

    $('.out').append('<div class="columns"></div>');
    $('.'+results[i]).clone().appendTo('.columns:last');
}

alert($('.out').html()); 
```

这里有一个例子：

[JSFIDDLE](http://jsfiddle.net/V6Sq9/)

# php - 在 session_write 和 setcookie 之后重定向用户

> ID：10896333
> 
> 赞同：0
> 
> 时间：2012-06-05T11:17:02.330
> 
> 标签：php, mysql, redirect, login, header

我想在登录后将用户重定向到页面，但我总是收到“无法修改标题”错误。我知道在命令之前不应该有回声或其他东西，`header()`但它是如何以正常方式完成的。用户登录，设置 cookie（也设置了会话），用户收到通知，所有事情都按正确的方式进行，他将被重定向到另一个页面？

这是我的 php 文件：

```
<?php
$qry="SELECT * FROM user WHERE email='$email' AND password='".md5($_POST['password'])."'";
$result=mysql_query($qry);

if($result) {
    if(mysql_num_rows($result) == 1) {
        $member = mysql_fetch_assoc($result);
        $_SESSION['SESS_MEMBER_ID'] = $member['id'];
        $_SESSION['EMAIL'] = $member['email'];
        session_write_close();

        if($remember_me == 1) {
        setcookie("user",$email,time()+(3600*24*365));
        setcookie("pw",md5($_POST['password']),time()+(3600*24*365));
        }

        //header("location: logged.php");  <- doesn't work

                    echo 'you are now logged in';
    }

    else {

        echo 'something went wrong';
        }
}
else {
    die("Query failed");
}
}
?> 
```

提前致谢。最好的问候，约翰。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-05T11:43:28.200

在结果函数中应该是这样的

```
 header("location: logged.php");  

               exit; 
```

# c# - 删除任务栏跳转列表？

> ID：10896334
> 
> 赞同：0
> 
> 时间：2012-06-05T11:17:10.520
> 
> 标签：c#, jump-list, windows-api-code-pack

因此，我对 Microsoft .NET 的 Windows API 代码包中的 JumpLists 感到困惑，似乎发生了一个小问题。

在删除或编辑代码、引用和删除库本身之后，跳转列表仍然存在。![跳转列表代码](../Images/177991bbdf05ecb8e76f6a08fa36cd55.png)

我想知道的是，如何从我的程序中删除这个 JumpList？（图像显示了编辑后的代码和结果，即之前的代码）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:27:37.640

存储跳转列表的目录可以通过转到

```
%APPDATA%\Microsoft\Windows\Recent\AutomaticDestinations\ 
```

在此路径中，您可以选择和删除不再需要的跳转列表...

# android - 用于可扩展列表视图崩溃的自己的适配器无法将 hasmap 转换为列表

> ID：10896336
> 
> 赞同：0
> 
> 时间：2012-06-05T11:17:14.363
> 
> 标签：android, expandablelistview, classcastexception

我有我的 onw 适配器`expandiblelistview`，它显示父母很好，但是当我点击一个组来查看孩子时它崩溃了：

`java.lang.ClassCastException: java.util.HashMap cannot be cast to java.util.List`

这是我自己的适配器：

```
 public class adaptadorLista extends SimpleExpandableListAdapter {

     private Context mContext;
      private List<? extends List<? extends Map<String, ?>>> mChildData;
      private List<? extends Map<String, ?>> mParentData;
      private String[] mChildFrom;
      private int[] mChildTo;

      public adaptadorLista(Context contexto,
            List<? extends Map<String, ?>> creaListaDeGrupos,
            int lineaPadre,
            String[] strings,
            int[] is,
            List<? extends List<? extends Map<String, ?>>> creaListadeHijos,
            int lineaHija,
            String[] strings2,
            int[] is2) {

          super(contexto, creaListaDeGrupos, lineaPadre, strings, is, 
                  creaListadeHijos, lineaHija, strings2, is2); 

          mContext = contexto;
          mChildData = creaListadeHijos;
          mChildFrom = strings2;
          mChildTo = is2;             
    }

      @Override   
      public long getChildId(int groupPosition, int childPosition) {
        return 0;
      }
      public View getChildView(int groupPosition, int childPosition,boolean isLastChild, View convertView, ViewGroup parent) { 

      View v; 
      if (convertView == null) { 
              v = newChildView(isLastChild, parent); 
      } else { 
              v = convertView; 
      } 
      bindView(v, mChildData.get(groupPosition).get(childPosition), mChildFrom, mChildTo, groupPosition, childPosition); 
      return v; 
}
      // This method binds my data to the Views specified in the child xml 
                      private void bindView(View view, Map<String, ?> data,String[] from, int[] to, int groupPosition, int childPosition) { 
                              int len = to.length - 1; 
                              // Apply TextViews 
                              for (int i = 0; i < len; i++) { 
                                      TextView v = (TextView) view.findViewById(to[i]); 
                                      if (v != null) { 
                                              v.setText((String) data.get(from[i])); 
                                            } 
                                       }                      
                              } 

      @Override
      public boolean isChildSelectable(int groupPosition, int childPosition) {
        return true;
      }                      
} 
```

以及具有 2 种填充数据方法的构造函数：

```
adaptadorLista expListAdapter = new adaptadorLista(
                        contexto,
                        creaListaDeGrupos(),
                        R.layout.linea_padre,
                        new String[] { "numero_servicio","profesion","direccion","fecha_cad" },
                        new int[] { R.id.tvServicio,R.id.tvProfesion,R.id.tvDireccion,R.id.tvfecha},        
                        creaListadeHijos(), 
                        R.layout.linea_hija,    
                        new String[] { "tipo", "diasEnCurso","estado","fechaProCita" }, 
                        new int[] {R.id.tvTipo , R.id.tvDiasEnCurso, R.id.tvEstado,R.id.tvFechaProximaCita} 
                        );

                setListAdapter( expListAdapter);
registerForContextMenu(getExpandableListView());                    
    }

                private List<? extends List<? extends Map<String, ?>>> creaListadeHijos() {
                    ArrayList resultado_hijo = new ArrayList();
                    for(int i=0;i<ArrayServicios.size();i++){
                        HashMap hijo = new HashMap();
                        hijo.put("tipo", tipos.get(i));
                        hijo.put("diasEnCurso", diasEnCurso.get(i));
                        hijo.put("estado", estados.get(i));
                        hijo.put("fechaProCita", fechasProximasCitas.get(i));

                        resultado_hijo.add(hijo);
                    }

                    return (List)resultado_hijo;    }

                @SuppressWarnings({ "unchecked", "rawtypes" })
                private List<? extends Map<String, ?>> creaListaDeGrupos() {

                    ArrayList resultado_padre = new ArrayList();
                    for(int i=0;i<ArrayServicios.size();i++){
                        HashMap padre = new HashMap();
                        padre.put("numero_servicio", numerosServicios.get(i));
                        padre.put("profesion", profesiones.get(i));
                        padre.put("direccion", direcciones.get(i));
                        padre.put("fecha_cad", fechasCaduca.get(i));

                        resultado_padre.add(padre);
                    }

                    return (List)resultado_padre;
                } 
```

我找到了一个使用这个适配器的例子并且可以工作但不适合我..

**解决方案 ：**

```
/********Metodo que rellena la lista de hijos*********************/
private List<? extends List<? extends Map<String, ?>>> creaListadeHijos() {
                List<List<Map<String, String>>> resultado_hijo = new ArrayList<List<Map<String, String>>>(); 

                for(int i=0;i<ArrayServicios.size();i++){
                    List<Map<String, String>> hijo = new ArrayList<Map<String,String>>(); 
                    Map<String, String> curChildMap = new HashMap<String, String>(); 
                     curChildMap.put("tipo", tipos.get(i));
                     curChildMap.put("diasEnCurso", diasEnCurso.get(i));
                     curChildMap.put("estado", estados.get(i));
                     curChildMap.put("fechaProCita", fechasProximasCitas.get(i));
                     hijo.add(curChildMap);                     
                 resultado_hijo.add(hijo);
            }

            return resultado_hijo;
            }
/*********************************************************************/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:26:40.373

`ClassCastException`似乎在以下方法中：

```
private List<? extends List<? extends Map<String, ?>>> creaListadeHijos() {
    ArrayList resultado_hijo = new ArrayList();
    for(int i=0;i<ArrayServicios.size();i++){
        HashMap hijo = new HashMap();
        hijo.put("tipo", tipos.get(i));
        hijo.put("diasEnCurso", diasEnCurso.get(i));
        hijo.put("estado", estados.get(i));
        hijo.put("fechaProCita", fechasProximasCitas.get(i));

        resultado_hijo.add(hijo);
    }

    return (List)resultado_hijo; 
```

}

返回类型预计为：

`List<? extends List<? extends Map<String, ?>>>`

而您的返回变量`resultado_hijo`是类型

`ArrayList<HashMap<String, ?>`或`? extends List<? extends Map<String, ?>>`。

外层`List`不见了。

# java - 在 Apache Tomcat 中发送有关 MIME 类型响应的特定标头

> ID：10896339
> 
> 赞同：0
> 
> 时间：2012-06-05T11:17:23.300
> 
> 标签：java, jsp, tomcat, servlets

我有一个 Apache Tomcat 服务器正在运行。如果我有类似的东西：

```
webapp/
    image1.png 
```

然后，我可以使用以下方法简单地访问它：

```
example.com/image1.png 
```

这是完美的，除了我无法控制发送的标头。我希望`Expires`为某些 MIME 类型（例如 for `image/png`）发送特定的标头。这些标头将是静态的，所以我不介意是否必须在某些 XML 文件中指定它并且不能是动态的。

Apache Tomcat可以吗？另一种明显的方法是从文件中读取并使用适当的标题将其输出到浏览器，但我认为这可能是一种矫枉过正。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:22:21.313

使用 Tomcat 过滤器来应用此标头。

```
<web-app ...>
    ...
    <filter>
       <filter-name>ExpiresFilter</filter-name>
       <filter-class>org.apache.catalina.filters.ExpiresFilter</filter-class>
       <init-param>
          <param-name>ExpiresByType image</param-name>
          <param-value>access plus 10 minutes</param-value>
       </init-param>
       <init-param>
          <param-name>ExpiresByType text/css</param-name>
          <param-value>access plus 10 minutes</param-value>
       </init-param>
       <init-param>
          <param-name>ExpiresByType application/javascript</param-name>
          <param-value>access plus 10 minutes</param-value>
       </init-param>
    </filter>
    ...
    <filter-mapping>
       <filter-name>ExpiresFilter</filter-name>
       <url-pattern>/*</url-pattern>
       <dispatcher>REQUEST</dispatcher>
    </filter-mapping>
    ...
 </web-app> 
```

[Tomcat 过滤器文档](http://tomcat.apache.org/tomcat-7.0-doc/api/org/apache/catalina/filters/ExpiresFilter.html)中的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T22:02:09.407

您可能使用的不是 Tomcat 7，而是旧版本。在我的 Tomcat 7 安装中，我发现过滤器打包在 catalina.jar

# sqlite - sqlite3的速度

> ID：10896340
> 
> 赞同：0
> 
> 时间：2012-06-05T11:17:27.977
> 
> 标签：sqlite

我在 IOS 开发中使用 sqlite3。我发现了一个奇怪的问题。我的数据库是 1.1MB，它有大约 20000 条记录。当我使用 sqlite3_open 打开数据库时，我发现在 IPHONE4 中大约需要 2 秒，在 IPAD2 中只需 0.03 秒。我做错什么了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T01:26:46.590

我认为这可能是 A4 CPU 和 A5 CPU 之间的不同。我使用加载页面来处理这个问题。

# grails - Grails 最佳实践资源

> ID：10896341
> 
> 赞同：3
> 
> 时间：2012-06-05T11:17:31.743
> 
> 标签：grails, groovy

这个问题对于直接在 stackoverflow 中的答案来说太笼统了（请参阅[这个封闭的问题](https://stackoverflow.com/questions/6226759/best-practices-to-be-followed-while-developing-grails-application)）但是我认为社区将从高质量的外部文章的起点中受益，这些文章可以更详细地深入探讨该主题。

我希望看到基于以下标准的关于 Grails“最佳实践”的信息最丰富的文章：

*   如何在控制器/视图/服务/域对象之间拆分任务
*   测试
*   安全
*   何时使用插件
*   数据库设计注意事项
*   特定于 Groovy 或 Grails 的主题，不属于一般最佳实践指南的一部分

**请回答外部文章的链接，仅添加简短摘要。请不要过多评论**您认为个别想法/模式是否良好，否则此问题将因“征求辩论和讨论”而关闭

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:17:31.900

这篇[**关于 Grails 最佳实践的 InfoQ 文章**](http://www.infoq.com/articles/grails-best-practices)很好地列出了如何在控制器/视图/服务/域、测试、配置和其他 Grails 特定注意事项之间拆分逻辑。

这是一篇简短的文章，我会推荐给任何 Grails 开发人员

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:29:25.913

GrailsPodcast 网站刚刚举办了一个很好的“最佳实践”会议：[http](http://www.grailspodcast.com/blog/id/249) ://www.grailspodcast.com/blog/id/249 （目前离线）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T22:29:44.247

grails 持久性专家 Burt Beckwith 的演示文稿解释了在 GORM 中开箱即用地使用 hasMany/belongsTo 映射的潜在性能问题：

[http://burtbeckwith.com/blog/files/169/gorm%20grails%20meetup%20presentation.pdf](http://burtbeckwith.com/blog/files/169/gorm%20grails%20meetup%20presentation.pdf)

以下是如何应用 Burt 公开的一种情况的示例：

[https://mrpaulwoods.wordpress.com/2011/02/07/implementing-burt-beckwiths-gorm-performance-no-collections/](https://mrpaulwoods.wordpress.com/2011/02/07/implementing-burt-beckwiths-gorm-performance-no-collections/)

# java - 如何将 Hibernate JPA @SQLInsert 与具有默认值的数据库列一起使用

> ID：10896350
> 
> 赞同：0
> 
> 时间：2012-06-05T11:18:19.457
> 
> 标签：java, hibernate, default, sql-insert

我有一个包含四列的表“组”。数据库是 postgres，group_id 列是 Serial。所以实际上它是一个 Integer，默认获取下一个值。

我有一个需要使用@SQLInsert 的用例（不能使用普通的持久化方法），但我无法让它与默认值一起使用。这是我所拥有的：

```
@SQLInsert(sql="INSERT INTO groups (group_id, parent_id, group_name, version) VALUES (DEFAULT,?,?,?)") 
```

我将实体属性设置为 group_id 和 version 为 null 且其他两个已正确填充的值。group_id 在数据库中不可为空，版本可以为空。

我得到这个例外：

```
WARNING: SQL Error: 0, SQLState: 22023
SEVERE: The column index is out of range: 4, number of columns: 3.
SEVERE: Could not synchronize database state with session 
```

如果我直接在数据库上输入以下 DML，它可以工作：

```
INSERT INTO groups (group_id, parent_id, group_name, version) VALUES (DEFAULT, 3, 'abcd', null); 
```

有没有办法使用@SQLInsert 来实现同样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:33:04.173

如果您要保存的类成员不是引用类型，则它们不能保存空值。这可能是与数据库记录同步失败的原因。尝试使用 Integer 和 Double 等引用类型。并确保使用直接插入查询假定默认值。

错误消息中的另一件事。默认值可能超出了您在 Java 中为该列使用的类型的边界。检查默认值是否在范围内。如果为您的班级成员设置了超出范围的值，则无法同步。

编辑：对不起，在这种情况下，第二部分不正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:33:05.973

所以简短的回答是“不能这样做”。尽管我在很多地方都看到过这个问题，但 Hibernate 人员并没有提供这个用例。

我的解决方案是将 Postgres 序列与表分离。也就是说，我删除了从序列中选择 nextval 并填充两个主键字段之一的默认约束。

然后我使用本机查询手动获取 nextval（是的，强制取消抽象数据库），并使用该值手动填充主键字段。有用。它很笨拙，但我可能会更频繁地使用它。与使用纯 ORM 方法相比，发生的事情当然更容易理解。这可以在没有巫师帽的情况下进行调试。:)

```
public class...
@PersistenceContext(unitName = "persistence_unit")
private EntityManager em;

...
mymethod(){
...
Query q = em.createNativeQuery("SELECT nextval('groups_group_id_seq')");
BigInteger groupId = (BigInteger)q.getSingleResult();

BigInteger parentId = methodToGetParentId();

GroupsPK gpk = new GroupsPK(groupId, parentId);

Groups grps = new Groups(gpk, "other parameters");

...
} 
```

# java - 如何对齐文件系统 I/O？

> ID：10896351
> 
> 赞同：2
> 
> 时间：2012-06-05T11:18:20.177
> 
> 标签：java, c, performance, io, filesystems

一些基准测试（尤其是 SSD）对（4k-）对齐和非对齐读/写进行了区分。我理解为什么对齐可以更快，但我不明白如何在我的程序中确保读/写将与实际介质正确对齐。

我不认为它像确保不寻找不能被 4096 整除的文件中的任何地址一样简单？毕竟，系统不保证文件的开头会正确对齐（或者是吗？）

像 IOMeter 这样的程序如何对齐它们的 I/O？有没有办法在Java中做到这一点？（或者更一般地说，在 VM 中运行的程序）。

我的另一个问题是 IOMeter 如何只有一个线程/进程（以及我自己如何做到这一点）的队列深度> 1 - 但我不确定这是否与对齐的 I/O 相关，或者是否要就此提出一个新问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:58:55.080

我怀疑你绝对可以做到，但你可以大大增加你的机会。

*   确保文件系统与物理介质对齐。有关 Linux 中的注意事项（仅作为示例），请参见[此处](http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/newstorage-iolimits.html)。
*   如果您按顺序访问数据，请确保使用的缓冲区大小是块大小的整数倍。4096 或 8192 通常是安全的选择。
*   如果您正在寻找或进行随机访问，正如您所说，您需要寻找块大小的倍数并填充缓冲区。同样，您通常使用 4096 或 8192 都是安全的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:29:51.813

此链接可能很有用，但您说您对数据对齐有足够的了解。我认为Java不支持它。我认为你必须自己实现它。 [数据对齐](http://www.songho.ca/misc/alignment/dataalign.html)

# key - 如何在 Windows 服务器上正确注册注册表项？

> ID：10896358
> 
> 赞同：0
> 
> 时间：2012-06-05T11:18:39.957
> 
> 标签：key, windows-server-2008-r2, regedit, registrykey

你好，我会解释我的问题。在安装过程中，我尝试在以下路径中注册一个新的注册表项：

```
HKEY_LOCAL_MACHINE \ Software \ mykey 
```

但是一旦我分析结果，我的关键就在这里！

```
HKEY_LOCAL_MACHINE \ Wow6432Node \ Software \ mykey 
```

为什么？我不明白..提前谢谢你的回答^ ^

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:24:44.510

我个人见过的唯一情况是，它是从特定架构的应用程序构建中添加的。（例如32位，而操作系统是64位）

你是如何添加文件的？

[编辑]

有关此主题的一些信息的链接： [http ://www.typemock.com/blog/2008/07/31/registry-on-windows-64-bit-double-your-pleasure/](http://www.typemock.com/blog/2008/07/31/registry-on-windows-64-bit-double-your-pleasure/)

# asp.net-mvc - Ajax post throws 未提供所需的防伪令牌或无效

> ID：10896362
> 
> 赞同：1
> 
> 时间：2012-06-05T11:18:51.540
> 
> 标签：asp.net-mvc, antiforgerytoken

我正在尝试使用防伪机制来保护我的 ajax 帖子。

首先，我在视图中添加了 antiforgerytoken 辅助方法调用

```
@Html.AntiForgeryToken() 
```

然后调整了我的 jquery post call

```
var values = $(this).serialize() + "&__RequestVerificationToken=" + $("input[name='__RequestVerificationToken']").val();

$.post(url, values)
    .success(page.submitSuccess)
    .error(page.submitError)
    .complete(page.submitComplete); 
```

当然，我用 ValidateAntiForgeryToken 装饰了我的操作方法

```
[HttpPost]
[ValidateAntiForgeryToken]
public ActionResult Create(ProjectCreateCommand command)
{
    ....
} 
```

但在提交表单后，它会抛出*A required anti-forgery token was not provided or was invalid*错误。

我已经删除了令牌 cookie，并且我已经重新启动了浏览器。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:29:36.237

如果使用`$(form).serialize();`它将序列化所有输入标签，因此您可以通过 $.post jquery 方法来完成。尝试这样的事情：

```
$("#you_form").submit(function (e) {
    e.preventDefault();
    $.ajax({
       type: 'POST',
       url: $(this).attr("action"), // get url from action attribute, your route setted by the Html.BeginForm()
       data: $(this).serialize(), // serialize all input tags from this form
       success: page.submitSuccess; 
    });
}); 
```

使用没有问题`@Html.AntiForgeryToken()`，serialize方法会将这个加在一起。

看看这个链接：[http ://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

# ssis - SSIS：从大表加载数据时抛出 OutOfMemoryException

> ID：10896365
> 
> 赞同：0
> 
> 时间：2012-06-05T11:19:15.503
> 
> 标签：ssis, out-of-memory, large-data

我有一个非常大的表，我无法提取。由于我链接到 ADO.NET 源中的专有数据库 ODBC 驱动程序，可以提取此表。

源表有 90,000 行和 333 列。我只在提取和加载到 Oracle 数据库之间转换 3 列。

每次我运行包时，它都会在加载了 OutOfMemoryException 的 66,500 行后失败。我尝试将批量大小更改为非常低的值，例如 10 或 50，但它仍然失败。

我的数据流截图：

![在此处输入图像描述](../Images/f32bd2b4ce0e6888ff90db58cdc7646e.png)

注意：对于该数据库中的其他表，我不得不将批量大小降低到 300 以下，因为列的数量超过了生成的插入查询的可用参数数量，并导致包失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T14:10:53.253

因此，在发布此问题后，我终于想出了一个解决方案。我只是最终在此特定包的目的地上将 BatchSize 设置为 1 并且它起作用了。这是我遇到问题的唯一包。

# sql - sql server中nolock的实际用途是什么

> ID：10896368
> 
> 赞同：4
> 
> 时间：2012-06-05T11:19:48.560
> 
> 标签：sql, sql-server, sql-server-2008

我在 msdn 中浏览了一些文档，它说“没有发出共享锁来防止其他事务修改当前事务读取的数据”。

所以在外行术语（即我的）这会导致脏读的问题。哪个太危险了，如果是，那为什么要使用它？

有谁知道使用它的实际场景。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T12:17:31.917

在我们的案例（以前的工作）中，我们使用它来获取球场数字。因此，例如一个包含在给定日期发送的数百万封电子邮件的表格，如果我们想在 5:00 看到“我们在哪里”，我们可以说：

```
SELECT COUNT(*) FROM dbo.MessageTable WITH (NOLOCK)
  WHERE CampaignID = x AND CustomerID = y; 
```

很多人会建议`COUNT(*)`在没有`WHERE`子句的情况下使用这个。我认为，如果您愿意接受其中的一些不准确之处，`COUNT(*)`不妨这样做：

```
SELECT SUM(rows) FROM sys.partitions
  WHERE [object_id] = OBJECT_ID('dbo.tablename')
  AND index_id IN (0,1); 
```

由于进行中的事务，此数字同样不准确，但实际上不必扫描表，因此效率更高。对于我们的例子，我们甚至可以将它用于子集：使用过滤索引（用于其他目的）我们可以类似地查询`sys.partitions`，但使用`index_id`过滤索引的。

不过，在大多数情况下，使用`NOLOCK`起来可能感觉像是一个快速按钮，但它可能导致的不准确性很少值得。除非您的系统已经严重受 tempdb 限制，否则您应该考虑`READ_COMMITTED_SNAPSHOT`针对当前`NOLOCK`场景。查看[READ_COMMITTED_SNAPSHOT 的优缺点](https://stackoverflow.com/questions/10875586/pros-and-cons-of-read-committed-snapshot/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:58:55.940

我们有一个表，其中包含一个仅插入和更新的队列；什么都不会被删除。这些行具有不同的标志，指示相关进程正在发生什么。生产系统只使用行锁，但在不同的行上一次持有几十个，这样不同的进程就可以同时发生。

我们检查有多少项目仍在处理中，以避免系统过载。当用户启动一个新进程时，它会等待生成子进程，直到队列中当前正在处理的项目少于 10 个。

我们需要防止对可能需要它们更新自己状态的进程进行锁定，并且我们需要查看锁定项的状态。我们`with (nolock)` 用来防止等待查看队列中发生的事情，并计算有多少项目尚未标记为完成 - 逻辑保证仅在流程完成时发生。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:27:11.493

并非所有数据都是平等的。相当多的数据实际上并不重要，因此在某些情况下进行脏读是可以的。例如，批处理可以批量更新许多不同的表。您可能想要读取用户的已读消息数。您更喜欢数字超出 1 或 2，而不是用户必须等待几秒钟、几分钟或几小时才能使锁可用。

换句话说，当实际上不需要确切的数据时，您正在增加并发性，并且可以有一些（可能）无效数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T11:24:36.173

我通常使用它来查询我通常用于记录的相对繁忙的表。

`SELECT TOP 10 * FROM dbo.MessageLog (NOLOCK) WHERE AppCode = 'DesktopApp' ORDER BY MessageDate DESC`

表的记录主要写入一次，从不更新。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T11:24:38.163

如果您愿意接受某些记录可能已过期，则根据具体情况，它可以提供更快的访问。

例如：

```
SELECT COUNT(*) FROM mytable (nolock) 
```

将使用更少的资源，并且通常比在大表上更快

```
SELECT COUNT(*) FROM mytable 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-05T11:26:07.590

我们在有大量读取但很少写入的表上使用它。如果连接只是读取数据，那么进行脏读通常没有危险。这可以防止阻塞表，从而提高性能。

查看[https://stackoverflow.com/a/1453000/1038940](https://stackoverflow.com/a/1453000/1038940)了解有关 nolock 的更多信息以及何时可以是好/坏

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-05T11:37:48.930

对我们来说很容易 - 我们获取非财务（通常很少更改）数据（如客户地址或商品描述或各种配置选项），带有 nolock 提示，财务或定量数据（如价格或余额）带有“正常”锁定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-05T16:09:22.520

你显然是个天才。它不应该被使用。

NOLOCK 经常被用作加快数据库读取速度的神奇方式，但我尽量避免使用它。

结果集可以包含尚未提交的行，这些行通常稍后会回滚。

错误或结果集可以为空、缺少行或多次显示同一行。

这是因为在您读取数据的同时其他事务正在移动数据。

READ COMMITTED 增加了一个额外的问题，即多个用户同时更改同一单元格的单个列中的数据损坏。

还有其他副作用，这会导致牺牲您最初希望获得的速度提升。

现在你知道了，永远不要使用它。

# android - android edittext 有限选项可供选择

> ID：10896383
> 
> 赞同：0
> 
> 时间：2012-06-05T11:21:13.883
> 
> 标签：android, android-edittext

我是 android 开发的新手，我有一个编辑文本，我只想提供有限的选项可供选择。但我不知道这个方向。

任何示例代码都会非常有帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:30:40.637

我认为你需要一个 AutocompleTextView。看看这个样本：

[http://developer.android.com/resources/tutorials/views/hello-autocomplete.html](http://developer.android.com/resources/tutorials/views/hello-autocomplete.html)

# lotus-notes - 用户活动 API 类内存泄漏

> ID：10896387
> 
> 赞同：1
> 
> 时间：2012-06-05T11:21:31.310
> 
> 标签：lotus-notes, lotusscript

NotesUserActivity类似乎存在内存泄漏[。](http://www.agecom.com.au/useractivity)当我从多个数据库收集用户活动信息并调用该`GetNthUserActivityEntry`方法时，每次调用都会增加内存使用量。

我找到了一些关于这个问题的参考资料，但没有解决方案。我认为这个问题与这个电话有关：

```
' Load the User name for the Activity Structure
UsernameOffset = puActivity + puActivityEntry.UserNameOffset
spUsername = Space(MAXUSERNAME)
Call CopyMemoryString(spUsername, UsernameOffset,Lenb(spUsername))
sUserName = Left(spUsername, Instr(spUsername, Chr(0)) - 1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:21:31.590

通过读取 MAXUSERNAME 字节 (256) 从内存中获取用户名。用户名通常不是 256 字节长，所以我认为该函数访问了它不应该访问的内存。

我将代码更改为：

```
Call CopyMemoryString(spUsername, UsernameOffset, strlenLP(UsernameOffset))
Dim sUsername As String
sUserName = Trim(spUsername) 
```

该`strlenLP()`方法读取内存，直到它到达一个`\0`. 声明是：

```
Declare Private Function lstrlenLP Lib "kernel32" Alias "lstrlenA" (ByVal lpString As Long) As Long 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:12:56.483

这是在黑暗中拍摄，但根据我的经验，GetNth...Notes 中的方法非常低效。有没有办法像大多数 Notes 对象一样使用 GetFirst / GetNext 进行迭代？我会看看这是否有帮助。

# java - 如何禁用 android 在 keycode_button_... 事件上隐藏活动？

> ID：10896392
> 
> 赞同：0
> 
> 时间：2012-06-05T11:21:49.837
> 
> 标签：java, android

我在主机模式下使用带有 USB 端口的根表来读取 xbox-controller-joystick 的值（使用 onJoystickMotion）。

现在，我还想跟踪按钮`keycode_button_a`、`keycode_button_b`、`keycode_button_x`和。跟踪工作正常，但按下这些按钮将隐藏活动。`keycode_button_y``keycode_button_select`

有什么方法可以禁用 android 在这个`keycode_button`_... 事件上隐藏活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:37:36.257

```
@Override
public boolean dispatchKeyEvent(KeyEvent event) {
    InputDeviceState state = getInputDeviceState(event);
    if (state != null) {
        switch (event.getAction()) {
            case KeyEvent.ACTION_DOWN:
                if (state.onKeyDown(event)) {
                    //Do my thing
                }
                break;
            case KeyEvent.ACTION_UP:
                if (state.onKeyUp(event)) {
                    //Do my thing
                }
                break;
        }
        return true;
    }
    return super.dispatchKeyEvent(event);
} 
```

是的 :D

# python - 在搁置和 sqlite 之间选择非常大的字典（Python）

> ID：10896395
> 
> 赞同：13
> 
> 时间：2012-06-05T11:22:07.900
> 
> 标签：python, sqlite, dictionary, persistence, shelve

我有一个大型 Python 字典，其中包含无法加载到内存中的浮点数的向量（150k 向量，每个 10k 维），因此我必须使用两种方法之一将其存储在磁盘上并在适当时检索特定向量。向量将被创建和存储一次，但可能会被读取很多次（数千次）——因此高效读取非常重要。在使用搁置模块进行一些测试后，我倾向于认为 sqlite 将是此类任务的更好选择，但在我开始编写代码之前，我想听听更多关于此的意见......例如，还有其他的吗？除了我不知道的那两个选项？

现在，假设我们同意最好的选择是 sqlite，另一个问题与表格的确切形式有关。我正在考虑使用带有表格行的细粒度结构`vector_key, element_no, value`来帮助有效分页，而不是将向量的所有 10k 元素存储到同一记录中。我真的很感激关于这个问题的任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-05T11:32:34.087

您想要 sqlite3，然后如果您使用像[sqlalchemy](http://www.sqlalchemy.org/)这样的 ORM，那么您可以轻松地扩展和使用其他后端数据库。

Shelve 更像是一个“玩具”，而不是在生产代码中真正有用。

您正在谈论的另一点称为规范化，我个人从来没有非常擅长它，[这](http://en.wikipedia.org/wiki/Database_normalization)应该为您解释。

作为一个额外的说明，[这](http://eliang.blogspot.co.uk/2011/07/python-shelve-vs-sqlite3.html)显示了 shelve 与 sqlite3 的性能失败

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T11:36:52.670

在处理数字向量时，您可能会发现[PyTables](http://www.pytables.org/)是一个有趣的替代方案。

# iphone - 核心数据问题。插入新的 NSManagedObject

> ID：10896396
> 
> 赞同：1
> 
> 时间：2012-06-05T11:22:10.357
> 
> 标签：iphone, objective-c, core-data, memory-management, nsmanagedobject

我想在我的核心数据库中插入 200 条 5Mb 记录。但是当我保存 NSManagedObject 时，内存没有被释放（自动释放池没有帮助），在插入 30 条记录后，我收到了内存警告，应用程序崩溃了。这是我的代码

```
- (void)SaveItem
    {
        NSString *entityName = kEntityName;
        AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
        NSManagedObjectContext *context = appDelegate.managedObjectContext;
        NSEntityDescription *entityDesctiption = [NSEntityDescription 
                                                  entityForName: entityName
                                                  inManagedObjectContext:context];
        // check if town exists
        NSPredicate *predicate = [NSPredicate predicateWithFormat:@"id == %d", self.imageID];
        NSFetchRequest *requestToCheckExistense = [[NSFetchRequest alloc] init];
        [requestToCheckExistense setEntity:entityDesctiption];
        [requestToCheckExistense setPredicate:predicate];
        NSArray *objects = [context executeFetchRequest:requestToCheckExistense error:nil];
        [requestToCheckExistense release];
        if (objects == nil)
        {
            NSLog(@"there was an error");
        }
        NSManagedObject *object;
        if ([objects count] > 0)
        {
            // edit item
            object = [objects objectAtIndex:0];
        }
        else
        {
            // if object doesn't exist, find max id to imlement autoincrement
            NSFetchRequest *request = [[NSFetchRequest alloc] init];
            [request setEntity:entityDesctiption];
            request.propertiesToFetch = [NSArray arrayWithObjects: @"id", nil];
            NSArray *allobjects = [context executeFetchRequest:request error:nil];
            [request release];
            NSInteger newID = 1;
            if ([allobjects count] > 0)
            {
                NSNumber *maxID = [allobjects valueForKeyPath:@"@max.id"];
                newID = [maxID intValue] + 1;
            }

            // write item
            object = [NSEntityDescription insertNewObjectForEntityForName:entityName inManagedObjectContext:context]; 
            [object setValue:[NSNumber numberWithInt:newID] forKey:@"id"];
            self.imageID = newID;
        }
        // fill NSManagedObject
        // size of objNSData is about 5MB
        NSMutableData *objNSData = [[DatabaseManager sharedDatabaseManager] encryptedDataFromImage:bigImage];
        [object setValue:objNSData forKey:@"big"];

         [context save:nil];
     } 
```

当我评论

```
[object setValue:objNSData forKey:@"big"]; 
```

一切都很好。

我试图将代码添加到 @autoreleasepool 中，但这没有帮助。我知道，现在，当我将数据保存到数据库时，它仍在 iPhone RAM 中。如何从这个内存中释放它？当我从数据库中获取一组托管对象时，它们不在 RAM 中（我可以轻松获取 100 个对象，每个对象都有 5Mb 字段）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:45:54.697

```
 object =(tblEntity *) [NSEntityDescription insertNewObjectForEntityForName:entityName inManagedObjectContext:context]; 
```

尝试类型转换对象，这可能会解决问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T08:55:02.847

我已经解决了这个问题。在调用 [self SaveItem] 之后；我用了

```
[context save];
[context reset];
[context save]; 
```

上下文中的所有 NSManagedObjects 都将被释放。完成该操作后，我可以添加任意数量的大对象

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T12:28:50.880

因为您在创建 NSManagedObject 时并不拥有它，所以即使在释放它之后（使用循环内包含的自动释放池时），它也可能被核心数据堆栈保留。

这可能会有所帮助：

*   将 managedobjectContext 的撤消管理器设置为 nil：

    `[context setUndoManager:nil];`

*   确保该对象的任何属性都不会保留在任何地方，因为这样托管对象将不会在循环内按时释放。

*   确保在每个循环执行中添加一个自动释放池，而不是包装所有循环本身，类似于：

    ```
    for(i;i<n;i++) {
        NSAutoreleasePool* pool = [[NSAutoreleasePool alloc] init];
        [obj saveItem];
        [pool drain];
     } 
    ```

*   如果该对象属于 NSManagedObjects 的层次结构，那么您也需要释放该对象的所有者，以便从内存中释放该对象。

您可以在 CoreData 中查看[苹果](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdMemory.html)关于内存管理的文档。

警告：Apple 不建议将大对象（> 1MB）存储在 CoreData 中（[请查看其他问题/答案。](https://stackoverflow.com/a/2098401/1322377))）

# c# - jQuery 浏览器的区别

> ID：10896397
> 
> 赞同：3
> 
> 时间：2012-06-05T11:22:11.530
> 
> 标签：c#, javascript, jquery, browser

由于我刚刚开始在 IT 领域工作（实习大约在 2 个月前开始），我会尽力为您提供帮助我所需的所有信息。

我有一个 MVC4 应用程序，它使用 LongPolling 从服务器接收新数据（在我的情况下是消息）。根据消息的类型，它会在客户端以不同的方式处理它。

其中一种消息是系统消息：

我有两种看法。一个视图有一个按钮，另一个只有一些文本。
然后点击按钮

> 1.  在控制器中设置一些属性和
> 2.  强制在另一个视图上重新加载页面，从而产生新的内容（例如一些文本框）

现在，如果我在新窗口中打开这两个视图，它会正常工作（在 Firefox、IE 和 Chrome 中）。
但如果我在新标签页中打开它们，它只能在 IE 和 Chrome 中运行。Firefox 会收到消息，但不会调用回调方法。

```
$(document).ready(function () { 
    ReadChat();
}) 
```

这将初始化对 ReadChat() 的第一次调用。
正如我之前提到的，它在 IE 和 Chrome 的选项卡中运行良好，但仅在 Firefox 的新窗口中运行。
如果我检查 FireBug，来自服务器的响应会到达，我可以查看 JSON 内部。由于某种原因，它只是不调用回调。

我的第一个想法是尚未加载所有内容，因此我在第一次调用中添加了超时。

如果我这样写：

```
$(document).ready(function () { 
    setTimeout(ReadChat, 1000);
} 
```

它也适用于 Firefox，只要我不将其设置为低于 ~1000。

有没有人遇到过同样的问题？为什么 Firefox 在这里有所作为？

### 编辑：

```
function ReadChat() {
    $.fn.messaging({
        receiveURL: '@Url.Action("myAction", "myMethod")',
        myID: '@Model.myID',
        callback: function(data) {
            $.each(data.messages, function(k, v) {
                if(v.kind == 3) {
                    location.reload(true);
                }
            });
            ReadChat();
        }, timeout: 25000
    }, 'read');
} 
```

在 $.fn.messaging 中，将使用给定的参数调用 read 函数：

```
$.post(receiveURL, { id: myID }, function(response) {
    if($.isFunction(settings.callback) {
        settings.callback(response);
    }
} 
```

### 编辑2：

正如 Diesel337 所说，我现在正在使用

```
$(this).ready(function () {
    ReadChat();
}); 
```

在新标签中打开：进行此调整后，我对其进行了更多测试，乍一看它运行良好。然后我注意到，如果我点击视图，应该重新加载，在点击按钮之前，它不会工作。（消息已收到，但未调用回调函数）

另一方面，如果我忽略了应该重新加载的视图，并直接单击按钮，则页面将重新加载而没有问题。

这听起来很奇怪，我知道，但如果我在单击按钮之前不查看视图，它会起作用。

我还提交了一份关于 bugzilla 的新错误报告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T08:14:01.310

事实证明，导致此问题的不是 Firefox，而是 Firebug。
我今天再次尝试重现这个错误，幸运的是 Firebug 没有激活，所以它就像一个魅力。
再次打开它以获取有关原因的任何信息后，我得到了同样的错误。

注意：如果你正在开发一些需要在 $(document).ready() 上调用 AJAX 的东西，最好不要激活 Firebug，因为它会因为某种原因搞砸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T20:45:17.563

您是否尝试过使用 $(this) 而不是 $(document) ？

```
$(this).ready(function() {
   ReadChat();
}); 
```

或者

```
$(function() {
   ReadChat();
}); 
```

# php - PHP将裸码图像打印到php中的word文档中？

> ID：10896398
> 
> 赞同：-3
> 
> 时间：2012-06-05T11:22:13.507
> 
> 标签：php

我正在研究将生成 39 个条形码图像然后将其打印到 word 文档中的条形码系统，我如何将结果图像打印到 word 文件中？

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:28:45.470

[PHPWord](http://phpword.codeplex.com/)

如果您不需要可编辑的最终文档，请改用[Zend_PDF](http://framework.zend.com/manual/en/zend.pdf.html)。

只需查阅两者的 API 参考，两者都有图像嵌入的示例。

# android - TabWidget 不填写 Horizo ntalScrollView

> ID：10896409
> 
> 赞同：4
> 
> 时间：2012-06-05T11:23:16.740
> 
> 标签：android

我想显示标签宽度水平滚动条。我试图像这样[实现你如何设置标签视图滚动？](https://stackoverflow.com/questions/2492840/how-do-you-set-tab-view-to-scroll)

但是标签没有填满宽度。

**如何解决？**

```
<?xml version="1.0" encoding="utf-8"?>
<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">

        <HorizontalScrollView
            android:id="@+id/horizontalScrollView1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="match_parent"
                android:orientation="horizontal" >

                <TabWidget
                    android:id="@android:id/tabs"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content" >

                </TabWidget>

            </LinearLayout>
        </HorizontalScrollView>

        <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent">

        </FrameLayout>

    </LinearLayout>

    <ProgressBar
        android:id="@+id/destinationProgressBar"
        style="?android:attr/progressBarStyleLarge"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center" />

</TabHost> 
```

![在此处输入图像描述](../Images/42c7c4a46a6d02e7d68b88df6270fd8c.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T11:40:22.717

解决了！使用 android:fillViewport="true" 并删除 LinearLayout。

```
<?xml version="1.0" encoding="utf-8"?>
<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">

        <HorizontalScrollView
            android:id="@+id/horizontalScrollView1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" 
            android:fillViewport="true">

                <TabWidget
                    android:id="@android:id/tabs"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content" >

                </TabWidget>

        </HorizontalScrollView>

        <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent">

        </FrameLayout>

    </LinearLayout>

    <ProgressBar
        android:id="@+id/destinationProgressBar"
        style="?android:attr/progressBarStyleLarge"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center" />

</TabHost> 
```

# include - 在包含文件中发生编译错误时获取 Compiler:Error-Row

> ID：10896410
> 
> 赞同：1
> 
> 时间：2012-06-05T11:23:34.833
> 
> 标签：include, compiler-errors, progress-4gl, openedge

有谁知道当包含文件中发生错误时是否可以获得正在编译的文件的错误行？

例如，我正在编译一个文件，比如 abc.p，它在所有地方都使用了 def.i。在某些时候，我对 abc.p 进行了更改，导致其中一个包含出现编译错误，因此消息说错误发生在 def.i 的第 123 行，但我想知道 abc 中的哪一行。 p 即。换句话说，使用有问题的包含文件的行号。

即使“Compiler:Get-File-Name(n)”返回 def.i 并且“Compiler:File-Name”返回 abc.p，“Compiler:Get-Row(n)”和“Compiler:Error- Row" 返回 def.i 中的行号。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T11:28:14.033

我的猜测是保存编译器列表或调试文件并查看它。

除此之外，我认为现在没有办法做到这一点 - 您需要提交增强请求才能获得此功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-10T16:24:03.317

我跟踪这种错误的方法是

`compile source.p preprocess source.pp.`

在程序编辑器中打开 source.pp 并检查语法。这为您提供了扩展源中的错误位置。一旦找到不属于包含部分的代码，然后在原始源中搜索该代码。

# gcc - GCC 插件：pass.c 中的“内部编译器错误”

> ID：10896411
> 
> 赞同：1
> 
> 时间：2012-06-05T11:23:37.150
> 
> 标签：gcc, compiler-construction, gcc-plugins

我一直在编写一个 GCC 程序间插件，我必须在程序中的某些点插入 GIMPLE 语句。在此之后，我对整个程序进行数据流分析。当我完成分析后，我将删除那些新插入的 GIMPLE 语句。

我的分析已经完成，但在退出之前会生成以下消息：

> 内部编译器错误：在 execute_ipa_pass_list 中，在 pass.c:1817

这肯定是因为插入了 GIMPLE 语句，如果我不这样做，我将不会收到此错误消息。

谁能帮我解释一下问题是什么以及如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:40:50.130

这通常发生在 GCC 代码包含的断言结果是`false`.

第 1817 行`passes.c`（它是 GCC 源代码的一部分，位于 GCC`gcc`源代码树的子目录中）有一段代码，如下所示：

`gcc_assert (some_condition);`

在您的情况下，`some_condition`它是错误的，但编译器希望它始终是错误的`true`（这就是代码作者首先编写断言的原因）。

你在你的插件中做了一些事情`false`，你需要修复它。

你做错了什么？这真的取决于。打开`passes.c`并*找到*那条线，看看它在检查什么。在我的 GCC 副本中，相关功能如下：

```
void
execute_ipa_pass_list (struct opt_pass *pass)
{
  do
    {
      /* An assertion.  */
      gcc_assert (!current_function_decl);
      /* Another assertion.  */
      gcc_assert (!cfun);
      /* Another assertion.  */
      gcc_assert (pass->type == SIMPLE_IPA_PASS || pass->type == IPA_PASS);
      if (execute_one_pass (pass) && pass->sub)
        {
          if (pass->sub->type == GIMPLE_PASS)
            {
              invoke_plugin_callbacks (PLUGIN_EARLY_GIMPLE_PASSES_START, NULL);
              do_per_function_toporder ((void (*)(void *))execute_pass_list,
                                        pass->sub);
              invoke_plugin_callbacks (PLUGIN_EARLY_GIMPLE_PASSES_END, NULL);
            }
          else if (pass->sub->type == SIMPLE_IPA_PASS
                   || pass->sub->type == IPA_PASS)
            execute_ipa_pass_list (pass->sub);
          else
            gcc_unreachable ();
        }
      /* Another assertion.  */
      gcc_assert (!current_function_decl);
      cgraph_process_new_functions ();
      pass = pass->next;
    }
  while (pass);
} 
```

有四种`gcc_assert`说法。您的插件导致其中一个变为错误。即您弄乱了其中一个变量：

```
current_function_decl
cfun
pass->type 
```

这大概就是问题所在。

# c# - 围绕曲线绘制包络

> ID：10896414
> 
> 赞同：10
> 
> 时间：2012-06-05T11:24:05.493
> 
> 标签：c#, winforms, math

在我的 C# WinForms 应用程序中，我有一个包含 2 条曲线的图片框（由电压/电流测量结果）。X轴是电压，Y轴是电流。电压轴的范围是 -5 到 5，但电流轴的范围要小得多，范围是 -10 uA 到 10 uA。任务是查看第二条曲线是否在第一条曲线的 10% 以内。

对于目视检查，我试图在第一条曲线（蓝色曲线）周围画一个信封。曲线只是一个`PointF`数组。目前，由于我不知道如何在蓝色曲线周围绘制正确的包络线，所以我只绘制了另外两条曲线，它们是实际曲线的 X 点加减原始曲线的 10% 的结果。当然，这是一种不好的方法，但至少对于明显垂直的曲线部分，它是有效的。但是一旦曲线在其非垂直部分，这个技巧就不再起作用了，如下图所示：

![在此处输入图像描述](../Images/77359876dd6b41ee534d3ba67dbf4e1b.png)

这是我用来绘制信封的代码：

```
public Bitmap DrawEnvelope(double[,] pinData, float vLimit, float iLimit)
{
    g = Graphics.FromImage(box);
    g.SmoothingMode = SmoothingMode.AntiAlias;
    g.PixelOffsetMode = PixelOffsetMode.HighQuality;

    PointF[] u = new PointF[pinData.GetLength(0)]; //Up line
    PointF[] d = new PointF[pinData.GetLength(0)]; //Down Line
    List<PointF> joinedCurves = new List<PointF>();

    float posX = xMaxValue * (vLimit / 100);
    float minX = posX * -1;

    for (int i = 0; i < pinData.GetLength(0); i++)
    {
        u[i] = new PointF(400 * (1 + (((float)pinData[i, 0]) + minX) / (xMaxValue + vExpand)), 400 * (1 - ((float)pinData[i, 1] * GetInvers((yMaxValue + iExpand)))));
    }

    for (int i = 0; i < pinData.GetLength(0); i++)
    {
        d[i] = new PointF(400 * (1 + (((float)pinData[i, 0]) + posX) / (xMaxValue + vExpand)), 400 * (1 - ((float)pinData[i, 1] * GetInvers((yMaxValue + iExpand)))));
    }

    Pen pengraph = new Pen(Color.FromArgb(50, 0 ,0 ,200), 1F);
    pengraph.Alignment = PenAlignment.Center;

    joinedCurves.AddRange(u);
    joinedCurves.AddRange(d.Reverse());

    PointF[] fillPoints = joinedCurves.ToArray();
    SolidBrush fillBrush = new SolidBrush(Color.FromArgb(40, 0, 0, 250));
    FillMode newFillMode = FillMode.Alternate;

    g.FillClosedCurve(fillBrush, fillPoints, newFillMode, 0);

    g.Dispose();
    return box;
} 
```

绿色圆圈是我自己添加的，它们表示第二条曲线（红色曲线）可能与原始曲线有大于 10% 的差异的区域。

如果有人把我放在正确的方式会很好，我应该怎么看才能在原始曲线周围获得一个漂亮的包络？

**更新** 因为我太菜鸟了，直到现在我都找不到一种方法来实现对这个问题的答案，所以请赏金看看是否有人可以向我展示至少一种解决这个问题的编码方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:32:36.870

您可以尝试找到每对点之间的梯度，并计算通过中点的正交上任一侧的两个点。

然后，您将再定义两条线作为一组点，您可以使用它们来绘制信封。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:30:19.133

这完全取决于您希望信封大小的方式。

您可以通过计算到下一个点的斜率和到前一个点的斜率来计算/猜测每个点的曲线斜率，平均这些，然后计算斜率的垂直向量。

将此向量添加到曲线的点；这为您提供了信封的右侧边缘。

从曲线的点减去这个向量；这为您提供了信封的左侧边缘。

如果点相距太远或点出现非常突然的变化，此方法将失败。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T13:33:48.790

您最好的选择是迭代您的点数组并每次计算与两个连续点的垂直向量（有关实现线索，请参阅[计算二维向量的叉积）。](https://stackoverflow.com/questions/243945/calculating-a-2d-vectors-cross-product)沿这些垂直向量向任一方向投影，以生成包络的两个点阵列。

此函数使用段中点粗略地生成它们（只要点数很高并且您的偏移量不太小，绘制时应该看起来不错）：

```
private void GetEnvelope(PointF[] curve, out PointF[] left, out PointF[] right, float offset)
        {
            left = new PointF[curve.Length - 1];
            right = new PointF[curve.Length - 1];

            for (int i = 1; i < curve.Length; i++)
            {
                PointF normal = new PointF(curve[i].Y - curve[i - 1].Y, curve[i - 1].X - curve[i].X);
                float length = (float)Math.Sqrt(normal.X * normal.X + normal.Y * normal.Y);
                normal.X /= length;
                normal.Y /= length;

                PointF midpoint = new PointF((curve[i - 1].X + curve[i].X) / 2F, (curve[i - 1].Y + curve[i].Y) / 2F);
                left[i - 1] = new PointF(midpoint.X - (normal.X * offset), midpoint.Y - (normal.Y * offset));
                right[i - 1] = new PointF(midpoint.X + (normal.X * offset), midpoint.Y + (normal.Y * offset));
            }
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T05:11:38.523

这可能是一个愚蠢的建议。也许不是自己画信封，也许你可以让 winforms 为你做。尝试用宽度较大的笔将信封画成一条线。也许它可能会奏效。

如果您查看这个有关改变笔宽的 msdn 示例，您可能会明白我的意思。

[http://msdn.microsoft.com/en-us/library/3bssbs7z.aspx](http://msdn.microsoft.com/en-us/library/3bssbs7z.aspx)

# c++ - sizeof() 是递归的吗？

> ID：10896415
> 
> 赞同：3
> 
> 时间：2012-06-05T11:24:05.923
> 
> 标签：c++, struct, sizeof

答案应该很简单，但我想确定一下。

是`sizeof()`递归的吗？例如，

```
struct foo
{
   DWORD a;
   DWORD b;
};

struct bar
{
   DWORD c;
   foo d;
}; 
```

是否会`sizeof(bar)`包含 的大小`foo`，返回完整的 12 个字节（假设 DWORD 为 4 个字节）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T11:26:13.673

是的...`sizeof`给出类型中直接包含的所有成员的总数，包括`struct`/`class`数据成员、非虚拟基类、一些实现定义的跟踪虚拟基的链接/计数器、虚拟调度表指针、有助于对齐数据成员的填充对于 CPU 安全或高效的访问，理论上任何其他的实现都可能感觉像放在那里！（例如，用于运行时调试/错误检测、垃圾收集的非标准支持......）

当然，它不包括指向或引用对象的大小，但包括那些指针和引用的大小。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-05T11:25:33.317

是的，**[sizeof](http://msdn.microsoft.com/en-us/library/4s7x1k91%28v=vs.71%29.aspx)** 运算符为您提供结构的大小，包括其所有成员。

但请注意，编译器可能会添加自己的填充，因此实际大小*可能/可能不*等于结构成员大小的总和。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-05T11:28:29.780

是的。摘自 ISO/IEC 9899:TC3：

> 当应用于具有结构或联合类型的操作数时，结果是此类对象中*的总字节数*，包括内部和尾随填充。

（强调我的）

# ruby-on-rails - 如何限制仅通过 file_field 标签上传的图片？

> ID：10896416
> 
> 赞同：5
> 
> 时间：2012-06-05T11:24:11.343
> 
> 标签：ruby-on-rails, ruby, forms

```
<%= form_for @model_name, :url => {:controller => 'controller_name', :action => 'index'},:html => {:multipart => true},:validate => true do |f| %>

<%= file_field 'upload', 'datafile'%>

<% end %> 
```

我有这个表格。我想通过这个上传只上传图片。这个怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2016-01-27T05:18:31.327

HTML5

```
<%= f.file_field :file, multiple: true, accept:'image/*' %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:32:39.943

您可以使用[回形针](https://github.com/thoughtbot/paperclip)gem 来管理文件附件。它有`validates_attachment`验证器，这会很有帮助。

```
validates_attachment :avatar, :presence => true,
  :content_type => { :content_type => "image/jpg" },
  :size => { :in => 0..10.kilobytes } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:41:44.560

您仍然可以根据内容类型进行简单的验证：

```
class MyModels < ActiveRecord::Base

  validate :upload_is_image

  ...

  private

  def upload_is_image
    unless upload and upload.content_type =~ /^image\/(jpeg|pjpeg|gif|png|bmp)$/
      errors.add(:upload, "Not a valid image")
    end
  end

end 
```

显然，您可以根据要接受的图像类型来调整正则表达式。

# url - 是 "\;" 是 url 中分号的转义序列吗

> ID：10896420
> 
> 赞同：-4
> 
> 时间：2012-06-05T11:24:32.350
> 
> 标签：url

该组合`\;`是分号的转义序列，即`;`.

请原谅我之前的问题很简短，实际上我正在使用这个“\;” 逃避“;” 在 Linux 终端和 Windows 上。它用于分隔 URL 的不同参数查询字符串。仅使用“;” 适用于 Windows，但不适用于 Linux。但是使用“\;” 代替 ”;” 适用于 Linux 和 Windows。URL 被传递给某个命令以处理 URL 指向的资源。

我的查询很简单，Is '\;' ';' 的标准转义字符 在 linux 和 windows 控制台/shell 上？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T11:30:03.657

在 urls 中，转义符号`;`为`%3B`

有关详细信息，请参阅[http://www.december.com/html/spec/esccodes.html](http://www.december.com/html/spec/esccodes.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:28:45.190

**没有**。但是组合**\;** 会报错。我认为你必须尝试`\\;`而不是**\;** .

因为**；**在 Java 中不是转义字符。而使用 \ 你只能放置转义字符。如果你想要一些带有 \ 的非转义字符，那么你必须使用`\\`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:29:43.337

分号不需要在 url 中转义。

您可以在 javascript 控制台（对于 Chrome，或者可能是 FF 中的 Firebug）中自己测试它，方法是使用`encodeURI(';')`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T11:38:31.143

您的 url 读取通过了 arugumnets encodeURIComponent

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T11:28:25.923

不。在 URL 中，您通过 %XX 转义，其中 XX 是您想要的字符的十六进制代码。您可以使用`escape()`or`encodeURIComponent()`函数在 javascript 中轻松获取正确转义的字符串。

[有关更多信息，请参阅其他问题](https://stackoverflow.com/q/332872/51831)

# html - 显示图像的完美方式

> ID：10896423
> 
> 赞同：0
> 
> 时间：2012-06-05T11:24:39.650
> 
> 标签：html, css

我是 CSS 新手。我正在尝试以完美的方式显示我的图像

这是我的html代码：

```
<div id="photos">
            <h3>Photo title</h3>
            <P class="like"><a href="#">Like</a> </P>
            <p class="date">date </p>
            <div id="image">
                <img src="something.jpg" />
            </div>
            <p class="about">about image goes here</p>

        </div> 
```

现在我想像这样设计相同的样式：

[http://www.desolve.org/](http://www.desolve.org/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:35:21.947

**CSS**

```
 #photos{
margin:10px;
    border:solid 1px red;
    font-family:arial;
    font-size:12px;

}
#photos h3{
font-size:18px;
}

.date, .like{
text-align:right;
}

.about{
margin:10px;
}
#image img{
width:100%;
} 
```

**HTML**

```
<div id="photos">
            <h3>Photo title</h3>
            <P class="like"><a href="#">Like</a> </P>
            <p class="date">date </p>
            <div id="image">
                <img src="http://www.desolve.org/_images/chicago_banner.jpg" />
            </div>
            <p class="about">about image goes here</p>

        </div> 
```

现场演示[http://jsfiddle.net/46ESp/](http://jsfiddle.net/46ESp/)

现在根据**您的布局**设置为**边距****填充****带有**或**高度**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:35:40.427

我想你需要这样

[http://jsfiddle.net/VwPna/](http://jsfiddle.net/VwPna/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:37:01.690

从[http://www.w3schools.com/css/default.asp](http://www.w3schools.com/css/default.asp) 您可以轻松学习......您还可以在浏览器中查看来自 firebug 的其他网站 css。

下面的代码是您为横幅类提供的站点 css。

```
.banner {
    background: url("../_images/gallery_banner.jpg") no-repeat scroll 0 0 transparent;
    height: 350px;
    margin-bottom: 4em;
    overflow: hidden;
    padding-left: 3.9%;
    position: relative;
} 
```

同样的方式你可以给他们更多的风格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T11:41:46.957

这是在您提供的链接上制作的方式。

HTML：

```
<div class="banner">
  <h1>We love urban photography</h1>
  <p>
    We’re betting you do to. Welcome to our site, a growing collection of galleries taken by a  small group of passionate urban photographers. Visit our galleries, buy some of our prints, or drop us a line. While you’re at it, feel free to submit a gallery of your own.
    <strong>Welcome</strong>
    .
  </p>
</div> 
```

CSS：

```
.banner {
    background: url("../_images/gallery_banner.jpg") no-repeat scroll 0 0 transparent;
    height: 350px;
    margin-bottom: 4em;
    overflow: hidden;
    padding-left: 3.9%;
    position: relative;
}

.banner h1 {
    color: #FFFFFF;
    font-size: 2.2em;
    letter-spacing: 0.1em;
    padding-top: 290px;
}

.banner p {
    background: none repeat scroll 0 0 rgba(123, 121, 143, 0.8);
    color: #FFFFFF;
    font-size: 1em;
    height: 350px;
    padding: 1% 1% 0;
    position: absolute;
    right: 0;
    top: 0;
    width: 21%;
} 
```

你只需要把它翻译成你的 id、classes 和 form，然后你就拥有了

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T11:45:24.620

他们在参考网站上没有什么特别之处。他们将图像用作 div 的背景属性`class="preview"`。
这是**(x)HTML**：

```
<section class="chicago">
  <h2><a href="chicago.htm" title="Chicago gallery">Chicago</a></h2>
  <p class="pubdate">
    <time datetime="2011-04-24" pubdate="">April 2011</time>
  </p>
  <div class="preview"><a href="chicago.htm" title="Chicago gallery"></a></div>
  <p class="caption">Big wind, big shoulders. See a different side of Chicago.</p>
</section> 
```

以及对应的**CSS**

```
.chicago .preview {
background: url(../_images/sm_chicago_banner.jpg) no-repeat;
} 
```

您总是可以通过鼠标右键单击网站并选择“查看页面源”或类似的东西来偷看，具体取决于您的浏览器:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-05T11:49:31.223

如果你想让你的图像像那个墙贴一样，我在下面给出的小提琴链接中做到了。

[http://jsfiddle.net/zWS7c/1/](http://jsfiddle.net/zWS7c/1/)

# java - 如何抑制同一行代码的多个 FindBugs 警告

> ID：10896425
> 
> 赞同：20
> 
> 时间：2012-06-05T11:24:50.143
> 
> 标签：java, slf4j, findbugs

我最近发现了 FindBugs 的`@edu.umd.cs.findbugs.annotations.SuppressWarnings`注释，它非常酷，基本上可以让您告诉 FindBugs 忽略某些警告。

我已经按照他们的建议成功地实现了我自己的 SLF4J 绑定，`slf4j-simple`使用您自己的记录器和记录器工厂绑定来获取和修改它，我很高兴地说它就像一个魅力。

我刚刚在包含此 SLF4J 绑定的包上运行了查找错误，它抱怨`StaticLoggerBinder`原作者 (Ceki Gulku) 编写的某行代码：

```
// to avoid constant folding by the compiler, this field must *not* be final.
publicstatic String REQUESTED_API_VERSION = "1.6"; // !final 
```

FindBugs 抱怨这个字段“**不是最终的，但它应该是**”。但是，SLF4J 的（非常）聪明的人已经想到了这一点，并在上面提供了周围的评论。

所以，为了让 FindBugs 闭嘴，我按照我常用的抑制 FB 警告的方式修改了代码：

```
@edu.umd.cs.findbugs.annotations.SuppressWarnings("MS_SHOULD_BE_FINAL")
public static String REQUESTED_API_VERSION = "1.6"; 
```

当我清理我的项目并重新运行 FindBugs 时，我在同一行代码中收到*第二个警告，这一次抱怨：*

> 该字段永远不会被读取。该字段是公共的或受保护的，因此它可能旨在与不被视为分析一部分的类一起使用。如果没有，请考虑将其从课程中删除。

当我添加第二个警告抑制时：

```
@edu.umd.cs.findbugs.annotations.SuppressWarnings("MS_SHOULD_BE_FINAL")
@edu.umd.cs.findbugs.annotations.SuppressWarnings("URF_UNREAD_PUBLIC_OR_PROTECTED_FIELD")
public static String REQUESTED_API_VERSION = "1.6"; 
```

我从 Eclipse 收到编译器/语法错误：

> 重复注释@SuppressWarnings。

**如何在同一行代码中抑制多个 FindBugs 警告？**

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-05T11:27:51.130

只需在一个注释中列出数组中的所有警告标识符：

```
@edu.umd.cs.findbugs.annotations.SuppressWarnings({
        "MS_SHOULD_BE_FINAL", 
        "URF_UNREAD_PUBLIC_OR_PROTECTED_FIELD"})
public static String REQUESTED_API_VERSION = "1.6"; 
```

就像标准一样`java.lang.SuppressWarnings`，FindBugs 版本也[有一个参数类型`String[]`](http://findbugs.sourceforge.net/api/edu/umd/cs/findbugs/annotations/SuppressWarnings.html#value%28%29)。对于单个值，可以省略花括号以使生活更轻松。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-12-12T22:36:43.390

FindBugs 3+ 风格：

```
 @SuppressFBWarnings(
    value={"NP_NULL_ON_SOME_PATH_FROM_RETURN_VALUE","STCAL_INVOKE_ON_STATIC_DATE_FORMAT_INSTANCE"},
    justification="let me just make the build pass") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:29:03.330

试试这个：

```
@edu.umd.cs.findbugs.annotations.SuppressWarnings({"MS_SHOULD_BE_FINAL" , "URF_UNREAD_PUBLIC_OR_PROTECTED_FIELD"})
public static String REQUESTED_API_VERSION = "1.6"; 
```

# php - 控制器/方法覆盖的 CodeIgniter 路由

> ID：10896426
> 
> 赞同：2
> 
> 时间：2012-06-05T11:24:54.147
> 
> 标签：php, codeigniter, routes

我在我的`routes.php`：

```
$route['ctrller1/method1/video/(:num)'] = 'ctrller2/method2/$1'; 
```

我还有一个名为的控制器，`ctrller1`它有一个方法：

```
function method1 ($str = NULL) {
    // do something
} 
```

问题是我必须使用 controller2 因为我不能或不应该编辑 controller1。我想要的看似简单，但显然 CI 不想和我一起工作。

当
`domain.com/ctrller1/method1/edit`
调用 url: 时，我希望调用内部的方法`ctrller1`，如果`domain.com/ctrller1/method1/videos/1`
调用了我希望调用的方法`ctrller2`。

这对我来说似乎都是正确的，但它不会起作用。所以，我一定是错过了什么。我尝试将其添加到路由中：

```
$route['ctrller1/method1/(edit)'] = 'ctrller1/method1/($1)'; 
```

但这是不行的。有人看到这里有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T13:09:50.523

在您使用路由的任何时候，就像权限（防火墙等）一样，顺序很重要。通常，您希望按以下顺序组织您的路线：

1.  最明确的
2.  不太明确
3.  一般/后备

澄清一下，这意味着您的路线顺序应该是这样的：

```
$route['ctrller1/method1/videos/view/(:num)'] = 'ctrller2/method3/$1';
$route['ctrller1/method1/videos/(:num)'] = 'ctrller2/method2/$1';
$route['ctrller1/(:num)'] = 'ctrller2/method1/$1'; 
```

当 URL 被调用时，路由表会遍历并找到第一个最接近的匹配，否则它会遍历到下一个路由。

在这种情况下，您想要的是这样的：

> domain.com/ctrller1/method1/videos/1
> domain.com/ctrller1/method1/edit

原因是，视频的路线更具体，也是一种特殊情况，因为您将其路由到幕后的另一个控制器。

这是您的路线应该是什么样子（未经测试，但应该是这样）：

```
$route['ctrller1/method1/videos/(:num)'] = 'ctrller2/method2/$1';
$route['ctrller1/method1/edit'] = 'ctrller1/method1'; 
```

作为一个方面，请注意，我很好奇你为什么格式化它`ctrller1/method1/videos/`而不是像`ctrller1/videos/view/12355`or之类的东西`ctrller1/videos/edit/12355`，这`method1`似乎令人困惑。但同样，我在这里没有所有细节。

希望这对你有用，如果不发表评论，如果你再澄清一点，我会重新审视你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:37:41.817

那么你有`video`一个地方和`videos`另一个地方？

要么更改为

```
$route['ctrller1/method1/videos/(:num)'] = 'ctrller2/method2/$1'; 
```

或尝试网址：*domain.com/ctrller1/method1/video/1*

# c - C中的浮点和双舍入

> ID：10896444
> 
> 赞同：2
> 
> 时间：2012-06-05T11:25:55.253
> 
> 标签：c, casting, floating-point, double

我发生了一个非常奇怪的行为（对我来说）：

```
 int generate_scenario_one_pass(FILE *out, double freq_mhz) {
        unsigned int d_freq, d_freq_test;
        d_freq              = (int)(freq_mhz * 20);
        d_freq_test         = (int)(float)(freq_mhz * 20);
        printf("when freq_mhz = %.1f, d_freq = 0x%04X, d_freq_test = 0x%04X\n", freq_mhz, d_freq, d_freq_test);
    } 
```

整个代码不在这里，但它不相关。这个函数被多次调用，值递增，从 2110.0 开始，递增 0.1。

```
when freq_mhz = 2110.0, d_freq = 0xA4D8, d_freq_test = 0xA4D8
when freq_mhz = 2110.1, d_freq = 0xA4DA, d_freq_test = 0xA4DA
when freq_mhz = 2110.2, d_freq = 0xA4DC, d_freq_test = 0xA4DC
when freq_mhz = 2110.3, d_freq = 0xA4DD, d_freq_test = 0xA4DE 
```

在最后一次迭代中，`d_freq`是错误的！但`d_freq_test`具有正确的价值。所以我的问题是通过从 to 转换到 from to`double`来解决的。我想知道为什么。`float``float``int`

这是在 x86 CPU 上使用 MSVC++ 6.0 编译的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T11:32:08.173

有许多数字不能精确地表示为浮点数 - 其中 0.1 就是其中之一（它将四舍五入到*可以*表示的最接近的数字 - 类似于 0.0999999999999998）。使用时`double`，2110.3 恰好由一个略小于 2110.3 的数字表示，因此当您乘以 20 并`int`强制转换为（将向下舍入）时会给出“错误”结果，而作为浮点数的 2110.3 将由比 2110.3 略大的数字，因此给出了预期的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T11:39:10.383

实际上我的双重铸造不是解决方案。

```
#include <stdio.h>

int main(int argc, char **argv) {
    int d_freq, d_freq_test;
    double freq_mhz = 2110.0;
    double step = 0.1;

    while (freq_mhz < 2111.0) {
        d_freq = (int)(freq_mhz * 20.0);
        d_freq_test = (int)(float)(freq_mhz * 20.0);
        printf("freq: %.1f, d_freq: 0x%04X, d_freq_test: 0x%04X\n", freq_mhz, d_freq, d_freq_test);
        freq_mhz += step;
    }

    return 0;
} 
```

这产生（错误）：

```
freq: 2110.0, d_freq: 0xA4D8, d_freq_test: 0xA4D8
freq: 2110.1, d_freq: 0xA4DA, d_freq_test: 0xA4DA
freq: 2110.2, d_freq: 0xA4DC, d_freq_test: 0xA4DC
freq: 2110.3, d_freq: 0xA4DD, d_freq_test: 0xA4DD <-- :(
freq: 2110.4, d_freq: 0xA4DF, d_freq_test: 0xA4DF
freq: 2110.5, d_freq: 0xA4E1, d_freq_test: 0xA4E1
freq: 2110.6, d_freq: 0xA4E3, d_freq_test: 0xA4E3
freq: 2110.7, d_freq: 0xA4E5, d_freq_test: 0xA4E5
freq: 2110.8, d_freq: 0xA4E7, d_freq_test: 0xA4E7
freq: 2110.9, d_freq: 0xA4E9, d_freq_test: 0xA4E9
freq: 2111.0, d_freq: 0xA4EB, d_freq_test: 0xA4EB 
```

虽然这段代码：

```
#include <stdio.h>

int main(int argc, char **argv) {
    int d_freq, d_freq_test;
    double freq_mhz = 2110.0;
    double step = 0.1;

    while (freq_mhz < 2111.0) {
        d_freq = (int)(freq_mhz * 20.0);
        d_freq_test = (int)(float)(freq_mhz * 20.0 + 0.5);
        printf("freq: %.1f, d_freq: 0x%04X, d_freq_test: 0x%04X\n", freq_mhz, d_freq, d_freq_test);
        freq_mhz += step;
    }

    return 0;
} 
```

产生：

```
freq: 2110.0, d_freq: 0xA4D8, d_freq_test: 0xA4D8
freq: 2110.1, d_freq: 0xA4DA, d_freq_test: 0xA4DA
freq: 2110.2, d_freq: 0xA4DC, d_freq_test: 0xA4DC
freq: 2110.3, d_freq: 0xA4DD, d_freq_test: 0xA4DE <-- :)
freq: 2110.4, d_freq: 0xA4DF, d_freq_test: 0xA4E0
freq: 2110.5, d_freq: 0xA4E1, d_freq_test: 0xA4E2
freq: 2110.6, d_freq: 0xA4E3, d_freq_test: 0xA4E4
freq: 2110.7, d_freq: 0xA4E5, d_freq_test: 0xA4E6
freq: 2110.8, d_freq: 0xA4E7, d_freq_test: 0xA4E8
freq: 2110.9, d_freq: 0xA4E9, d_freq_test: 0xA4EA
freq: 2111.0, d_freq: 0xA4EB, d_freq_test: 0xA4EC 
```

哪个是对的。

所以这确实是舍入问题，一个精度问题，通过在 x20 乘法的结果上加上 0.5 来解决。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T11:47:47.073

当你从 double 转换为 int 时，你会得到截断。

`freq_mhz*20`at的值`2110.3`由`0x40E49BFFFFFFFFFF`- 表示，即 42207.9999999999927240423858166。当您将其截断为`int`.999999 时，您会得到 42207（或 0xA4DD - 为什么选择以十六进制表示这些？）

如果同时转换为浮点数，则会执行舍入操作。您真正想要做的是显式调用`round`该值，然后转换为`int`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T11:30:29.310

因为 0.1 不能用二进制浮点数精确表示。您所看到的是近似值，由于转换导致的截断和导致的舍入而加剧了这种情况`printf`。

解决此问题的一种方法是在转换为 int 时显式舍入而不是截断（您可以使用`round()`）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T11:40:43.577

十分之一不能用二进制表示。这就像十进制的 1/3。小数点后的位数越多，距离越近，但您无法到达那里。有各种各样的应对策略，但基本上如果你想要精确的表示，浮点格式就不行了。需要定点（十进制）格式。

# java - Blackberry Bold 9000 Internet Connection 工作正常，然后中断

> ID：10896445
> 
> 赞同：0
> 
> 时间：2012-06-05T11:25:55.757
> 
> 标签：java, blackberry, httpconnection

我在网上阅读了很多帖子，但我没有找到解决方案。

我开发了一个`HttpConnection`用于从服务器获取/设置数据的 BlackBerry App ( SDK 5 )。

我尝试通过无线和 G2/G3 连接进行连接。

在这两种情况下，应用程序都可以正常工作一段时间，然后突然互联网连接中断（有时在从服务器加载数据的中间）。在那之后，应用程序不起作用，我也无法访问任何网页（在 BB 浏览器中）。看起来BB禁用了互联网。

当我在 BB 浏览器中尝试时，我收到以下消息：

> 无法连接到互联网，请稍后再试。如果问题仍然存在，请联系您的服务提供商

恢复互联网的唯一方法是转到设置并禁用 WiFi，然后再次重新启用它。之后它起作用了，但又过了一段时间。

它永远不会在同一点中断。

这是我用来从服务器获取数据的代码：

```
String urlPath = "http://www.mysite.com/api/?debug=true";
//debug is my variable on the site, it's not necessary

if(DeviceInfo.isSimulator()){
    urlPath += ";deviceside=true";
} else {
    if (WLANInfo.getWLANState() == WLANInfo.WLAN_STATE_CONNECTED) {
        urlPath += ";interface=wifi";
    }else{
        urlPath += ";deviceside=true";
    }
}

HttpConnection httpConn = (HttpConnection) Connector.open( urlPath );

httpConn.setRequestMethod(HttpConnection.POST);
httpConn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
httpConn.setRequestProperty("User-Agent", "Profile/MIDP-2.0 Configuration/CLDC-1.0");
httpConn.setRequestProperty("Content-Language", "en-US");
httpConn.setRequestProperty("Connection", "close");

OutputStream os = httpConn.openOutputStream();

os.write(temp1.getBytes());
os.flush();
os.close();
StringBuffer sb = new StringBuffer();
DataInputStream is = httpConn.openDataInputStream();
int chr;
while ((chr = is.read()) != -1) {
    sb.append((char) chr);
}

String response = new String(sb.toString().getBytes(), "UTF-8"); 
```

我究竟做错了什么？

有没有办法解决这个问题并保持连接稳定和响应？

谢谢。

# javascript - JavaScript。这个表达式是什么意思：“var a = b === c && d;”

> ID：10896453
> 
> 赞同：4
> 
> 时间：2012-06-05T11:26:15.350
> 
> 标签：javascript

```
 // Define a walk_the_DOM function that visits every
    // node of the tree in HTML source order, starting
    // from some given node. It invokes a function,
    // passing it each node in turn. walk_the_DOM calls
    // itself to process each of the child nodes.
    var walk_the_DOM = function walk(node, func) {
        func(node);
        node = node.firstChild;
        while (node) {
            walk(node, func);
            node = node.nextSibling;
        }
    };

    // Define a getElementsByAttribute function. It
    // takes an attribute name string and an optional
    // matching value. It calls walk_the_DOM, passing it a
    // function that looks for an attribute name in the
    // node. The matching nodes are accumulated in a
    // results array.
    var getElementsByAttribute = function (att, value) {
        var results = [];
        walk_the_DOM(document.body, function (node) {
            var actual = node.nodeType === 1 && node.getAttribute(att);
            if (typeof actual === 'string' &&
                    (actual === value || typeof value !== 'string')) {
                    results.push(node);
                } });
        return results;
    }; 
```

我不明白这行代码是什么意思：

```
var actual = node.nodeType === 1 && node.getAttribute(att); 
```

如何解释这种表达方式？

```
a = b === xxx && yyy 
```

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T11:28:23.903

这是短路和 JavaScript 返回语句的最终值这一事实的结合。它与以下内容相同：

```
if (b === xxx) {
  a = yyy;
} else {
  a = false;
} 
```

在此处阅读更多信息：[http](http://en.wikipedia.org/wiki/Short-circuit_evaluation) ://en.wikipedia.org/wiki/Short-Circuit_evaluation和[https://developer.mozilla.org/en/JavaScript/Reference/Operators/Logical_Operators#Short-Circuit_Evaluation](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Logical_Operators#Short-Circuit_Evaluation)

# python - 如何使用python绘制图形

> ID：10896454
> 
> 赞同：-1
> 
> 时间：2012-06-05T11:26:19.433
> 
> 标签：python, wxpython

我有一个需要绘制的值列表。问题是有一个格式。我怎样才能用这种值绘制图表。我将 python 2.7 与 wxPython 一起使用。

[这是指向值的链接，我无法将其粘贴到此处，因为格式会更改](http://pastebin.com/9yHV1V7i)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T14:24:59.223

wxPython 项目有一个单独的演示包，您可以下载和安装。得到它并查看 PyPlot 演示。它可以最简单的情节就好了。如果您需要更强大的功能，请下载 matplotlib。他们的网站上有一个示例，用于将 matplotlib 与 wxPython 集成。wxPython wiki 上也有一两篇关于 matplotlib 的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T10:36:57.283

你可以使用 matplotlib 有很多例子如何在 wxpython 中嵌入 matplotlib 图形

# java - 使用 Bean Validation 对字段的可选多个相同约束

> ID：10896458
> 
> 赞同：0
> 
> 时间：2012-06-05T11:26:34.800
> 
> 标签：java, validation, jpa-2.0, hibernate-validator

我正在尝试使用 Hibernate 验证器在插入数据库之前验证 POJO。

bean 中有一个长度可以是 8 或 10 的字段。

我尝试使用内置约束`List`将它们放在一起，期望其中一个标准通过而不是验证通过。

```
@Length.List({@Length(min=8, max=8,message="Code is either 8 or 10 characters in length"),@Length(min=10, max=10,message="Code is either 8 or 10 characters in length")})
public String getCode() {
    return this.code;
} 
```

但是，结果显示列表中的所有条件都必须通过才能使其有效。所以我想知道是否有办法改为进行 OR 检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:52:52.593

我认为这个注释的工作方式是这样的：

```
@Length(min = 8, max = 10)  
public String getCode() {
   return code;
} 
```

换句话说`9`，也将被接受为有效，这不是你要找的。我不确定是否有办法在 Hibernate 注释中对它们进行两次验证和 OR 操作。

看起来您可以`@Pattern`为此使用验证：

```
@Pattern(regexp="(.{8}|.{10})", message="Should either be 8 or 10 characters")
public String getCode() {
   return code;
} 
```

# asp.net-mvc-3 - ASP.net MVC 中的全球化（每个视图与域的资源文件）

> ID：10896463
> 
> 赞同：3
> 
> 时间：2012-06-05T11:27:10.073
> 
> 标签：asp.net-mvc-3, globalization

在 ASP.net MVC 全球化方面，保留资源文件的最佳做法是什么？

例如，如果我们尝试保留域的资源文件，即 order.resx、customer.resx 等，我们就有订单处理系统

否则我们可以尝试保留每个视图的资源文件，即 OrderProcessingView.resx、CustomerView.resx 等

常用字符串如“添加”、“编辑”、“删除”可以使用 common.resx 文件处理。

或者有没有其他方法来保存资源文件？

**我们也在使用一些客户端渲染（Jquery 模板、Kendo 模板）。**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-06T16:13:04.263

可[本地化](http://msdn.microsoft.com/en-us/library/f5ttdeh6%28v=vs.71%29.aspx)的最佳实践之一是不在不同的上下文中重复使用翻译。那是因为您希望允许翻译人员在不同的上下文中对同一段英文文本使用不同的翻译。为什么？因为不同的语言有不同的规则（例如，根据性别，形容词可以采用不同的形式），也因为上下文特定的约束，例如空间限制（例如，翻译可能被迫缩短字符串以使其适合某个地方，但是不需要时不必这样做）。

出于这个原因，每个视图都有一个 .resx 是一种很好的做法。如果您只有一个大的 .resx，则很难确定字符串进入哪个视图（而且您也更倾向于在不同的上下文中重用字符串）。对于任何与视图无关的应用程序，您通常还需要一个全局 .resx，这种情况应该很少见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:30:43.590

我们只为每种语言创建 1 个大资源文件，仅此而已。更容易管理。

# javascript - getXDomainRequest 在 IE 上不起作用，但在其他任何地方都可以使用

> ID：10896467
> 
> 赞同：1
> 
> 时间：2012-06-05T11:27:18.237
> 
> 标签：javascript, internet-explorer, xdr

我有这个函数可以从国外网站返回一些 XML 数据：

```
function sendData()
{
        var dev_statut = jQuery("select[name='statut']").val();
        var dev_fdpaysid = jQuery("select[name='pays']").val();
        var dev_fddeffet = jQuery("input[name='date_effet']").val();
        var dev_fdnbadu = jQuery('select[name="nb_adultes"]').val();
        var dev_fdnbenf = jQuery('select[name="nb_enfants"]').val();

        var date_naiss_a_val = jQuery("input[name^=date_naissance_a]").map(function() {        
        var dev_date_naiss_a = 'dev_fadnaiss_';
        return dev_date_naiss_a + this.id + '=' + this.value; 
        }).get().join('&');

         var date_naiss_e_val = jQuery("input[name^=date_naissance_e]").map(function() { 
         var dev_date_naiss_e = 'dev_fadnaiss_';
         return dev_date_naiss_e + this.id + '=' + this.value; 
         }).get().join('&');

        var xdr = getXDomainRequest();
        xdr.onload = function() 
        {
                alert(xdr.responseXML);

                var xml = xdr.responseXML; 
                var prod = xml.documentElement.getElementsByTagName("produit");

                var proddata = [];

                proddata.push('<ul>');

                var len = prod.length;
                for (var i = 0; i < len; i++) {

                var nomprod = xml.getElementsByTagName('nomprod')[i].firstChild.nodeValue;
                var url = xml.getElementsByTagName('url')[i].firstChild.nodeValue;
                var desc = xml.getElementsByTagName('desc')[i].firstChild.nodeValue;
                var texte = xml.getElementsByTagName('texte')[i].firstChild.nodeValue;

                proddata.push("<li><div class='resultat_produit'>" + "<h1>" + nomprod + "</h1>" + "<p class='from_devis_desc'>" + desc + "</p>" + "<p class='form_devis_texte'>" + texte + "</p>" + "<a href='" + url + "'class='btn_url'>Faire un devis</a>" + "</div></li>");
                }

                proddata.push('</ul>');
                jQuery('#mydiv2').append(proddata.join("\n"));

                jQuery('.resultat_produit a').click(function(e)
                {
                        e.preventDefault();

                        var href = jQuery(this).attr('href');

                        jQuery('#myDiv').empty();
                        jQuery('#myDiv').append('<iframe src="'+ href +'" scrolling="auto" width="960" height="100%"></iframe>');
                });
        }
        xdr.open("GET", "http://www.MYURL.fr/page.php?dev_statut="+ dev_statut +"&dev_fdpaysid="+ dev_fdpaysid +"&dev_fddeffet="+ dev_fddeffet +"&dev_fdnbadu="+ dev_fdnbadu +"&dev_fdnbenf="+ dev_fdnbenf +"&"+ date_naiss_a_val +"&"+ date_naiss_e_val +"");
        xdr.send();
} 
```

它适用于任何主流浏览器（Chrome、FF 等），但不适用于... IE！我打开了控制台，它说：“DocumentElement is undefined ...”

我累了，无法解决，任何帮助都将非常感激！

# php - 如何从 wmd 编辑器将数据保存在数据库中

> ID：10896471
> 
> 赞同：0
> 
> 时间：2012-06-05T11:27:30.063
> 
> 标签：php, javascript, sql, wmd

我正在保存内容，`textarea`只是将其保存为数据库中的平面文本，不像预览中显示的那样如何存储预览中显示的数据

```
//in form;
<textarea id="wmd-input" class="wmd-panel" name="content" ></textarea>

//in database
$content =  $_POST["content"] ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:33:38.380

请看这个..

[将文本从 textarea 插入 MySQL 数据库而不丢失格式](https://stackoverflow.com/questions/5863320/inserting-text-from-textarea-into-mysql-database-without-losing-formatting)

它和你一样的问题。

如果满足您的需要，请尝试这个..

`$content = nl2br($_POST["content"]);`

如果要以 HTML 格式显示内容，请在保存到 DB 之前使用它，以便将所有换行符转换为`<br/>`. 如果您希望它再次显示在`textarea`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T13:25:50.077

您可以通过[markdown.php](http://daringfireball.net/projects/markdown/)执行此操作，您需要下载并包含 markdown.php 和

你只需要做

```
$my_html=  Markdown($content); 
```

现在将其存储`$my_html`到数据库中，现在它可以工作了

# java - 无法从 Jar 加载图像

> ID：10896475
> 
> 赞同：3
> 
> 时间：2012-06-05T11:27:44.900
> 
> 标签：java, image, jar, swt

我正在尝试从 Jar 文件加载图像。这是行：

```
Image imgTrayIcon = new Image(display, this.getClass().getResourceAsStream("icon.ico")); 
```

我见过很多使用这种方法的例子，但是当我尝试这样做时，我得到一个错误，说我的图像无效。这是堆栈跟踪：

```
 [java] Exception in thread "Thread-0" org.eclipse.swt.SWTException: Invalid image
 [java]     at org.eclipse.swt.SWT.error(SWT.java:4083)
 [java]     at org.eclipse.swt.SWT.error(SWT.java:3998)
 [java]     at org.eclipse.swt.SWT.error(SWT.java:3969)
 [java]     at org.eclipse.swt.internal.image.WinICOFileFormat.loadInfoHeader(WinICOFileFormat.java:200)
 [java]     at org.eclipse.swt.internal.image.WinICOFileFormat.loadIcon(WinICOFileFormat.java:127)
 [java]     at org.eclipse.swt.internal.image.WinICOFileFormat.loadFromByteStream(WinICOFileFormat.java:119)
 [java]     at org.eclipse.swt.internal.image.FileFormat.loadFromStream(FileFormat.java:48)
 [java]     at org.eclipse.swt.internal.image.FileFormat.load(FileFormat.java:84)
 [java]     at org.eclipse.swt.graphics.ImageLoader.load(ImageLoader.java:130)
 [java]     at org.eclipse.swt.graphics.ImageDataLoader.load(ImageDataLoader.java:22)
 [java]     at org.eclipse.swt.graphics.ImageData.<init>(ImageData.java:331)
 [java]     at org.eclipse.swt.graphics.Image.<init>(Image.java:545)
 [java]     at SysTray.run(Unknown Source) 
```

我使用的图标绝对有效。我已经使用图标工具检查了这一点。我还尝试将图标放在与我的代码相同的目录中（而不是 Jar-ing）并像这样使用它：

```
Image imgTrayIcon = new Image(display, "icon.ico"); 
```

这工作得很好，但是当我试图把它放在罐子里时，它没有。我似乎无法弄清楚为什么会这样。我已经解压缩了我的 Jar 以检查文件是否已添加到 Jar 中并且它似乎在那里。我的 jar 没有任何复杂的文件夹结构。所有文件和资源都在同一级别的树中。

关于这里有什么问题的任何想法？谢谢

* * *

这是一些复制问题的示例代码：

Example.java

```
import org.eclipse.swt.widgets.*;
import org.eclipse.swt.graphics.*;

class Example {

    public static void main(String[] args) {
        Display display = Display.getDefault();
        Image imgTrayIcon = new Image(display, Example.class.getClassLoader().getResourceAsStream("icon.ico"));
    }

} 
```

命令：

```
javac -cp "SWT.jar" Example.java
jar cf Example.jar *.class *.ico
java -cp "Example.jar;SWT.jar" Example 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T12:16:23.000

好像您正在开发多线程应用程序。从堆栈跟踪`Exception in thread "Thread-0" org.eclipse.swt.SWTException: Invalid image`看来，您正在将图像加载到非 ui 线程中并尝试在某些 UI 元素中使用它。[看到这个](http://www.coderanch.com/t/340970/GUI/java/swt-threads)。

在 UI 线程中，以下代码可以正常工作。（图标文件在里面`test package`）

```
package test;

import java.io.InputStream;

import org.eclipse.swt.graphics.Image;
import org.eclipse.swt.layout.FillLayout;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;

public class IconTest 
{
    public static void main(String[] args)
    {
        final Display display = new Display();

        Shell shell = new Shell(display);
        shell.setLayout(new FillLayout());
        shell.setSize(200, 200);
        shell.setLocation(20, 20);

        InputStream stream = IconTest.class.getResourceAsStream("/test/icon.ico"); 

        Image imgTrayIcon = new Image(display, stream);

        shell.setImage(imgTrayIcon);

        shell.open();
        while (!shell.isDisposed()) {
                if (!display.readAndDispatch())
                        display.sleep();
        }

        if(imgTrayIcon != null)
            imgTrayIcon.dispose();

        display.dispose();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:29:51.037

```
ImageIcon image = (new ImageIcon(getClass().getResource("yourpackage/mypackage/image.gif"))); 
```

通常，您可以通过以下方式检索 InputStream：

```
InputStream is = this.getClass().getClassLoader()    .getResourceAsStream("yourpackage/mypackage/myfile.xml"); 
```

它将在罐子内部或外部运行。

参考[http://www.jugpadova.it/articles/2006/02/05/accessing-a-resource-within-a-jar](http://www.jugpadova.it/articles/2006/02/05/accessing-a-resource-within-a-jar)

另请参阅[http://docs.oracle.com/javase/tutorial/uiswing/components/icon.html](http://docs.oracle.com/javase/tutorial/uiswing/components/icon.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T12:10:34.703

试试这些—— `this.getClass().getClassLoader().getResourceAsStream("icon.ico")` 或 `this.getClass().getClassLoader().getResourceAsStream("package_or_full_path_to_image/icon.ico" )` 或 `Name_of_THIS_CLASS.class.getClassLoader().getResourceAsStream("icon.ico")`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T13:53:40.287

1.  您是否尝试过将文件放在与类文件相同的目录中，而不使用 Jaring 并使用`getResourceAsStream()`来加载它？
2.  您是否尝试过在 Jar 内部和外部使用[java.security.DigestInputStream](http://docs.oracle.com/javase/6/docs/api/java/security/DigestInputStream.html)获取流的校验和，以查看两个环境之间的文件是否真的有任何不同？

# java - 设置 CSS 样式 Uibinder Gwt

> ID：10896480
> 
> 赞同：1
> 
> 时间：2012-06-05T11:27:54.093
> 
> 标签：java, xml, gwt, uibinder

我想在 onBlur 事件上使用 java 代码更改 ag:label 的颜色。我正在使用 Eclipse，UIBinder。

这就是我的想法，虽然它不起作用。

在我的 StandardDocumentDownload.ui.xml 文件中

```
<ui:style>     
   .testStyle {
   }
   .styleRequiredData
   {
        color:red;

    }
 </ui:style> 
```

这是我的 standardDocumentDownload.java 文件中的事件

```
@UiHandler("comboTitle")
void onComboTitleBlur(BlurEvent event) {
    int title = comboTitle.getSelectedIndex();

    if(title == 0)
    {
        labTitleReq.setText("Please enter a value");
        labTitle.addStyleName("styleRequiredData");
    }
    else
    {
        labTitleReq.setText("");
    }

} 
```

如何在事件触发时将红色添加到标签的现有样式中。

亲切的问候

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-05T11:57:56.063

请参阅[此处](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder#Programmatic_access)以编程方式访问内联样式

对你来说，它应该是这样的：

```
<ui:style type="com.yourapp.YourClass.MyStyle">     
    .testStyle {
    }
    .styleRequiredData
    {
        color:red;
    }
</ui:style>

public class YourClass extends Widget {
    interface MyStyle extends CssResource {
        String testStyle();
        String styleRequiredData();
    }

    @UiField MyStyle style;

    /* ... */

    @UiHandler("comboTitle")
    void onComboTitleBlur(BlurEvent event) {
        int title = comboTitle.getSelectedIndex();
        if(title == 0){
            labTitleReq.setText("Please enter a value");
            labTitle.getElement().addClassName(style.styleRequiredData);
        } else {
            labTitleReq.setText("");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T11:58:35.417

我花了一段时间才找到它，但文档；“[使用 UiBinder 进行声明式布局：以编程方式访问内联样式](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiBinder#Programmatic_access)”告诉您如何操作。这里的代码片段

绑定器：

```
 <ui:style type='com.my.app.MyFoo.MyStyle'>
    .redBox { background-color:pink; border: 1px solid red; }
    .enabled { color:black; }
    .disabled { color:gray; }
  </ui:style>

  <div class='{style.redBox} {style.enabled}'>I'm a red box widget.</div>

</ui:UiBinder> 
```

后面的代码：

```
public class MyFoo extends Widget {
  interface MyStyle extends CssResource {
    String enabled();
    String disabled();
  }

  @UiField MyStyle style;

  /* ... */

  void setEnabled(boolean enabled) {
    getElement().addClassName(enabled ? style.enabled() : style.disabled());
    getElement().removeClassName(enabled ? style.disabled() : style.enabled());
  }
} 
```

描述：

> 该元素有一个新属性 type='com.my.app.MyFoo.MyStyle'。这意味着它需要实现该接口（在上面的 MyFoo 小部件的 Java 源代码中定义）并提供它调用的两个 CSS 类，启用和禁用。
> 
> 现在看看@UiField MyStyle 样式；MyFoo.java 中的字段。这使代码可以访问为块生成的 CssResource。setEnabled 方法使用该字段在打开和关闭小部件时应用启用和禁用的样式。
> 
> 您可以在具有指定类型的样式块中自由定义任意数量的其他类，但您的代码将只能访问接口所需的那些。

# regex - 正则表达式 for 可能有空格

> ID：10896492
> 
> 赞同：1
> 
> 时间：2012-06-05T11:28:53.573
> 
> 标签：regex, grep

我正在尝试寻找可能有空间的常规表达方式。我正在寻找

```
word1word2 
```

和

```
word1 word2 
```

我尝试：

```
grep "word1[ +]word2" mylog.txt 
```

但这不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:33:47.030

尝试

```
grep -E "word1 ?word2" mylog.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:34:41.523

以下正则表达式应该可以解决问题：

```
x *y 
```

它将检查 x 和 y 之间的任意数量的空格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:49:08.407

尝试

```
grep "word1 \?word2" mylog.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T11:37:35.707

试试`"word1\s*word2"`。

*   通常表示“至少发生一次，但也发生多次”。
*   表示“任何数量的出现，即使是零” \s 是空白字符的占位符（也可以是制表符）。

如果您只想要零个或一个空格，您可以尝试`"word1\s{0,1}word2"`

顺便说一句：+ 或 * 将在括号之后：`[ ]+`

# ms-access - .RunSQL 遇到的问题

> ID：10896500
> 
> 赞同：0
> 
> 时间：2012-06-05T11:29:21.830
> 
> 标签：ms-access

我必须创建一个报告来比较不同年份的值。报表的记录源设置在查询中，该查询将返回用户在表单上选择的最近选定年份的每个公司的值。在其他年份，我创建了不同的查询来运行，并尝试将值分配给其他列。

首先，为什么我不能在 SELECT 查询上使用 RunSQL 命令？我不得不把它改成这个，但我认为这不是我需要的。

```
DoCmd.OpenQuery "AuditPTEChangesQuery1"
DoCmd.OpenQuery "AuditPTEChangesQuery2"
DoCmd.OpenQuery "AuditPTEChangesQuery3"
DoCmd.OpenQuery "AuditPTEChangesQuery4" 
```

其次，它不会让我将查询值分配给我的报告列（我收到 80020009 错误）

任何有关如何解决我的问题的建议都将受到极大的欢迎。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:39:09.510

RunSQL 用于操作查询。选择查询没有可运行的内容。如果您希望在报表中显示来自绑定记录集以外的表或查询的数据，您可以使用记录集和 VBA、子报表、域聚合函数，或者您可以参考打开的表单。

# netty - 如何提高服务器 SSL 性能

> ID：10896502
> 
> 赞同：6
> 
> 时间：2012-06-05T11:29:37.310
> 
> 标签：netty, sslengine

我在代理服务器上启用了 SSL，发现性能已经从每秒 17k 请求下降到每秒 5k 请求。我遵循了 Netty 的安全聊天示例中的代码，我认为我没有做任何不同的事情。

我写了一个虚拟服务器，看看我是否在代理上犯了一些错误。在正常 http 模式下运行虚拟 SSL 服务器每秒可以处理大约 50k 请求。当我在虚拟服务器上启用 SSL 时，每秒请求数下降到 28k。

有什么我做错了吗？有什么我想念的吗？

我正在使用 JDK 6 编译代码，在 JDK 7u4 上运行。我也在使用 Netty-3.5.0。我正在使用 zeusbench 运行测试。测试参数为：zeusbench -n 10000 -c 100 -k -C RC4_SHA "https:///"

资料来源： http: [//pastebin.com/iahqr3zT](http://pastebin.com/iahqr3zT)

**编辑 1：**我通过 JProfiler 运行了虚拟服务器。管道工厂中的 SSLContext.createSSLEngine 调用（平均）需要 55,005 微秒（该平均值是根据该方法的 540 次调用计算得出的）。

channelConnected 中的 SslHandler.handshake 调用（平均）需要 46,284 微秒（该平均值是根据该方法的 540 次调用计算得出的）。

我知道 Netty 对 createSSLEngine 的调用无能为力，但是 SslHandler.handshake 可以调整得更好吗？它所花费的时间几乎与发动机本身的生成时间一样长。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T15:47:32.117

使用 java 的加密/解密真的很慢。
您不应该使用带有 java 的 SSL 实现来提高性能。
有几种方法可以避免使用 Java 进行 SSL 连接：

1.  配置在您的 java 服务器前面提供 SSL 连接的代理服务器
2.  实现 ssl 握手库 w/openssl 使用 jni 的 netty 代码中的库

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-28T03:05:10.850

您可以尝试为现有连接重新使用 ssl 会话，这可以减少 ssl 握手，并且应该会给您带来普遍的提升。

# eclipse - FindBugs eclipse 属性视图不显示详细说明

> ID：10896510
> 
> 赞同：1
> 
> 时间：2012-06-05T11:30:02.360
> 
> 标签：eclipse, findbugs

我刚刚在 Eclipse Indigo 中安装了 FindBug 2.0.0。错误资源管理器工作正常，但我无法获得非常有用的错误详细信息视图。如果我在错误资源管理器中选择一个错误，所有相关信息都会显示在属性视图中，但我真正想看到的只是一个摘要——即不想深入研究整个属性数据结构. 特别是，我想查看详细描述（在属性视图中以 Data -> DetailHTML、Data -> DetailPlainText 和 Data -> DetailText 的形式提供）。DetailText 太长而无法完全显示，因此您必须剪切并粘贴它以了解有关该错误的更多信息。

我假设 Bug Info 视图旨在提供此信息，但是当我打开此视图并在 Bug Explorer 中选择一个 Bug 时，Bug Info 中没有显示任何内容。

顺便说一句 - 我对“问题”视图有同样的问题：如果不进行复制 + 粘贴，您如何查看长描述？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:46:33.900

我在 Bug Explorer 视图中右键单击错误并选择 Show Bug Info。这会在 Bug Info 视图中显示它。

此外，在 java 编辑器中，如果我单击左侧的错误图标，它也会将我带到错误信息视图。

这适用于 FindBugs 2.0.0 和 eclipse 3.7.1。

# java - 如何以编程方式使用 maven 下载 jar

> ID：10896515
> 
> 赞同：6
> 
> 时间：2012-06-05T11:30:30.590
> 
> 标签：java, maven, aether

我正在编写一个应用程序，该应用程序需要我下载一个 jar 给定的 maven groupid/artifactid/version。

我目前从

```
public Model pomToModel(String pomUrl) throws Exception {
URL url = new URL(pomUrl);
    InputStream stream = url.openStream();
    try {
        Model model = new MavenXpp3Reader().read(stream);
        return model;
    } finally {
        stream.close();
    }
} 
```

所以给定了 POM 的 url，我现在有了代表它的 maven 模型对象。这似乎运作良好。

我想知道的是两件事：

1.  在 maven 插件将使用的 maven 存储库中找到模型表示的 jar 工件的 url
2.  给定模型，在本地存储库中找到代表 jar 的文件

我已经有了质量较差的解决方案：我去 mvnrepository.com 手动编码 url，并使用 ~/.m2/repository 作为文件的前缀。我显然可以改进这个解决方案，但我最终会很差地复制经过良好测试并在 maven 代码库中使用良好的代码。

我真的很想知道如何使用 Maven 类来做到这一点。

我已经做了一些谷歌搜索，但是关于 maven 和 jars（甚至在 stackoverflow 上）的任何搜索的有趣之处在于，我找到了很多关于如何使用 maven 的解决方案，而不是如何使用 maven 类进行编码。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T18:41:12.463

# Option 1

Aether as recommended by khmarbaise.

It's the native library that ships with Maven 3.0

# Option 2

If you want a simple solution for downloading Maven modules from the command line or within a shell script, Apache ivy has a [standalone](http://ant.apache.org/ivy/history/latest-milestone/standalone.html) jar.

Example:

[using IVY dependencies manager programmatically](https://stackoverflow.com/questions/3955209/using-ivy-dependencies-manager-programmatically/3963721#3963721)

# Option 3

If you're just looking for a Maven jar and don't care about dependency management it's even simpler.

Here's how to retrieve the log4j jar direct from Maven Central:

```
curl -O http://search.maven.org/remotecontent?filepath=log4j/log4j/1.2.17/log4j-1.2.17.jar 
```

If you're using a Nexus repository manager it has a useful REST API

[Using the Nexus rest API to get latest artifact version for given groupid/artifactId](https://stackoverflow.com/questions/7911620/using-the-nexus-rest-api-to-get-latest-artifact-version-for-given-groupid-artfic/7922863#7922863)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T12:40:40.970

要从 Maven 存储库下载工件，它打算使用[Aether lib](https://docs.sonatype.org/display/AETHER/Home)。

另见[http://www.sonatype.com/people/category/aether/](http://www.sonatype.com/people/category/aether/)

此外，还有如何做事的[示例和 Aether lib 的完整源代码。](https://github.com/sonatype/sonatype-aether)很久以前，我[玩过](https://github.com/khmarbaise/pom-interpolator-test)Aether。

# android - getView 中的故障

> ID：10896517
> 
> 赞同：1
> 
> 时间：2012-06-05T11:30:34.980
> 
> 标签：android, android-listview, contacts, adapter

我正在显示联系人列表。除了该设备有 1620 个联系人之外，一切都很好，因此列表滚动非常缓慢，甚至有时会挂起。

请帮帮我。

我尝试使用检查 getView 方法，`ConvertView!=null`但它总是多次膨胀相同的视图。提前致谢..

我的 getView 方法代码：-

```
if(ConvertView==null)
        {   view= mInflater.inflate(R.layout.facebookfriend, null);
                TextView name=(TextView)view.findViewById(R.id.textView1);
                ImageView image=(ImageView)view.findViewById(R.id.imageView1);
            name.setText(mlist.get(position).get("name"));

                String Id=mlist.get(position).get("contactId");
                Log.e("Id",""+Id);
                CheckBox chkbox= (CheckBox)view.findViewById(R.id.checkBox1);
                chkbox.setOnCheckedChangeListener(new OnCheckedChangeListener() {
                    @Override
                    public void onCheckedChanged(
                            CompoundButton buttonView, boolean isChecked) {
                        isSelected.set(position, isChecked);
                    }
                });

                                String photoid=mlist.get(position).get("photoId");
            Log.e("photoid",""+photoid);
                if(mlist.get(position).get("photoId")!=null){
                    Log.e("photoid",""+"photoid");
                    image.setImageBitmap(loadContactPhoto(Id, mlist.get(position).get("photoId")));
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:38:24.307

用于`ViewHolder pattern`高效`ListView`。这是有关此的详细教程。尝试在您的应用程序中实现此功能，如果有帮助，请告诉我们。

[Android 中高效的 ListView：View Holder 模式](http://www.jmanzano.es/blog/?p=166&lang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:44:30.350

您可以根据要求使列表视图动态加载数据，请参阅此[SO 帖子](https://stackoverflow.com/questions/5764441/use-android-dynamicaly-load-more-items-to-the-listview-need-help)，您还应该使用[ViewHolder](https://stackoverflow.com/questions/4145602/how-to-implement-a-view-holder)使其更高效，请参阅[此](https://stackoverflow.com/questions/1320478/how-to-load-the-listview-smoothly-in-android)。

# iphone - 以原生 Sencha 运行构建时出错

> ID：10896518
> 
> 赞同：0
> 
> 时间：2012-06-05T11:30:37.930
> 
> 标签：iphone, ios, extjs, sencha-2

```
Mac-mini-2:sink eit$ sencha app build native

[INFO] Deploying your application to /path/to/www/sink/build/package
[INFO] Copied sdk/sencha-touch.js
[INFO] Copied app.js
[INFO] Copied resources/css/app.css
[INFO] Copied resources/images
[INFO] Copied resources/icons
[INFO] Copied resources/loading
[INFO] Resolving your application dependencies...
[INFO] Found 139 dependencies. Concatenating all into app.js...
[INFO] Processed sdk/sencha-touch.js
[INFO] Minifying sdk/sencha-touch.js
[INFO] Processed app.js
[INFO] Minifying app.js
[INFO] Minifying resources/css/app.css
[INFO] Minified sdk/sencha-touch.js
[INFO] Minified app.js
[INFO] Minified resources/css/app.css
[INFO] Generated app.json
[INFO] Embedded microloader into index.html
[INFO] Packaging your application as a native app...
[INFO] The application was successfully packaged
Failed to execute system command while signing application with error 256
Failed to package application
[ERROR] codesign_allocate: for architecture armv7 object: /path/to/www/sink/build/native//Sencha Touch 2 Packaging.app/stbuild_template malformed object (unknown load command 8)
/path/to/www/sink/build/native//Sencha Touch 2 Packaging.app: object file format invalid or unsuitable 
```

如何解决上述问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T21:43:51.787

当我在 certificatePath 中包含证书文件名并且没有包含“certificatePassword”指令时，我收到了这个错误。

我希望这会有所帮助，但我对这一切还很陌生，并且正在摸索我遇到的各种问题。

# android - Android：sqlite从一行中包含相似值的所有行返回信息

> ID：10896520
> 
> 赞同：0
> 
> 时间：2012-06-05T11:30:39.967
> 
> 标签：android, sqlite

我试图让用户选择一个值，然后在我的数据库中搜索该值，并从包含该值的所有行返回信息。

我尝试了以下操作，但我不确定如何将结果正确返回给用户要查看的其他活动。

```
Cursor c = ourDatabase.rawQuery("SELECT * FROM FavoriteTable WHERE " + KEY_FAVNAME + " = '" + favoriteWorkoutName + "'", null); 
```

我也试过这个，其中 int 行指定我想在查询时从中获取数据的 KEY_ROW。例如，用户输入最喜欢的锻炼的名称，然后在数据库中搜索包含该名称的所有行，然后返回 KEY_ROWS 1、2 和 3（对应于锻炼、代表等）。但是，这只从一行返回一个行值。

```
int row = 1;

    Cursor c = ourDatabase.rawQuery("SELECT * FROM FavoriteTable WHERE " + KEY_FAVNAME + " = '" + favoriteWorkoutName + "'", null);

    do{c.moveToNext();
    String data = c.getString(row);
    return data;
    }while (row <= 3); 
```

有什么建议么？

*** *编辑：

我的活动中已经有类似的东西了。这就是我所拥有的。但是，我收到一个错误，它要求我“将 listCursor 的类型更改为 Cursor”，它已经是......或者“将 'GetFavoriteData' 的返回类型更改为 Cursor”，这也已经是。

此外，当我确实没有错误时，我不确定如何使用返回的数据并将其插入到我的 TextView 中。它不允许我设置文本（listCursor）。

理想情况下，我需要从每个返回的行中获取信息作为单独的字符串，以便我可以在 TextViews 中以我需要的方式显示它们。

在我的活动中：

```
String favoriteWorkoutName = cfdName.getText().toString();

                ExerciseDatabase choosefavorite = new ExerciseDatabase(WorkMeOutActivity.this);
                try {
                    choosefavorite.open();
                } catch (SQLException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                Cursor listCursor = choosefavorite.GetFavoriteData(favoriteWorkoutName);    

                choosefavorite.close(); 
```

在我的 DBHelper 类中：

```
public Cursor GetFavoriteData(String favoriteWorkoutName){

    return ourDatabase.rawQuery("SELECT * FROM FavoriteTable WHERE " + KEY_FAVNAME + " = '" + favoriteWorkoutName + "'", null);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:26:53.470

你的问题不清楚...

如果您尝试在所有不同的列中搜索该值，您的查询应该看起来更像这样：

```
Cursor c = ourDatabase.rawQuery("SELECT * FROM FavoriteTable WHERE " + KEY_FAVNAME + 
    " LIKE '" + favoriteWorkoutName + "' OR " + COLUMN2 + " LIKE '" + favoriteWorkoutName + 
    "' OR " + COLUMN3 + " LIKE '" + favoriteWorkoutName + "'", null); 
```

这将搜索 KEY_FAVNAME、COLUMN2 和 COLUMN3 列，并返回包含 favoriteWorkoutName 内容的任何行。

如果您只想要特定列中的那些，那么您首先发布的内容是正确的。

**编辑**

重新阅读后，我对您的问题有了不同的了解。

您应该在要使用它的活动中调用光标。正常的方法是定义一个 DB 帮助类来创建 db 并包含与其相关的所有功能（添加、删除、更新信息、获取游标等）。然后你实例化那个类并使用它的方法来处理数据库。

一个例子是（在您想要访问数据的活动中使用）：

```
mDbHelper = new WorkoutDB(getActivity());  // instantiate your dbhelper class
mDbHelper.open();                          // use the dbhelper open method to open the db
Cursor listCursor = mDbHelper.fetchFavoriteWorkout(favoriteWorkoutName);  // use the fetchFavoriteWorkout method to get your cursor 
```

您的 dbhelper 类将包含一个方法（以及许多其他方法），如下所示：

```
public Cursor fetchFavoriteWorkout(String favoriteWorkoutName){
    return ourDatabase.rawQuery("SELECT * FROM FavoriteTable WHERE " + KEY_FAVNAME + " = '" +  favoriteWorkoutName + "'", null);                 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T15:50:14.153

我认为您误解了[getString()](http://developer.android.com/reference/android/database/Cursor.html#getString%28int%29)方法。看一看：

```
public abstract String getString (int columnIndex)
Since: API Level 1 
```

## 将请求列的值作为字符串返回。

```
The result and whether this method throws an exception when the column value is null or the column type is not a string type is implementation-defined.
Parameters
columnIndex     the zero-based index of the target column.
Returns

    the value of that column as a String. 
```

* * *

因此，如果您使用 c.getString(row) 在内部传递 1,2 或 3，它只会为您提供来自特定行的一列（索引为 1,2 或 3）的值。

* * *

`c.getString(c.getColumnIndex(column_name))`如果您不确定列的索引并希望从其名称中获取它，则可以使用。

* * *

现在我想你想从前几行匹配的行（比如 3 行）中检索一些列的值（比如一行的前 3 列值），如果是这样使用它们：

```
Cursor c = ourDatabase.rawQuery("SELECT * FROM FavoriteTable WHERE " + KEY_FAVNAME + " = '" + favoriteWorkoutName + "'", null);

String fcv="";
String scv="";
String tcv="";

if(c.getCount() == 0)
                    {
                     //no data found
                    }
                    else  {
                        int i=0;
                      c.moveToFirst();
                        do {

                              fcv  = fcv + c.getString(0)); //or use  fcv  = fcv + c.getString(c.getColumnIndex(name of first column)));
                              scv  = fcv + c.getString(1)); 
                              tcv  = fcv + c.getString(2));   
                              i++;
                          } while (c.moveToNext() && i<3);              

                  c.close(); 
```

* * *

根据需要使用字符串的值:)

# vb.net - 远程服务器返回错误：(400) 错误请求。同时通过qbxml在线连接到QB

> ID：10896524
> 
> 赞同：0
> 
> 时间：2012-06-05T11:30:44.023
> 
> 标签：vb.net, qbxml

我与在线 QB 的连接工作正常。它也适用于在线将客户添加到 QB。当我通过检查时，它会给出错误的请求错误。

下面是我的 qbxml。

```
string post = @"<?xml version=""1.0"" encoding=""utf-8"" ?>
            <?qbxml version=""10.0""?>
            <QBXML>
            <SignonMsgsRq>
            <SignonDesktopRq>
            <ClientDateTime>%%CLIENT_DATE_TIME%%</ClientDateTime>
            <ApplicationLogin>%%AppLogin%%</ApplicationLogin>
            <ConnectionTicket>%%ConnTicket%%</ConnectionTicket>
            <Language>English</Language>
            <AppID>%%AppID%%</AppID>
            <AppVer>1</AppVer>
            </SignonDesktopRq>
            </SignonMsgsRq>
            <QBXMLMsgsRq onError=""continueOnError"">
            <CheckAddRq>                            
            <CheckAdd> 
                <AccountRef>
                    <ListID>1</ListID> 
                    <FullName>Chase Checking</FullName>
                </AccountRef>
                <PayeeEntityRef> 
                    <ListID>IDTYPE</ListID>
                    <FullName>Test Vendor</FullName> 
                </PayeeEntityRef>
                  <RefNumber>11</RefNumber> 
                  <TxnDate>05/06/2012</TxnDate> 
                  <Memo>My first Memo</Memo> 
                  <Address> 
                      <Addr1>Ahmedabad</Addr1> 
                      <Addr2>Ahmedabad</Addr2> 
                      <Addr3>Ahmedabad</Addr3> 
                      <Addr4>Ahmedabad</Addr4> 
                      <Addr5>Ahmedabad</Addr5> 
                      <City>Ahmedabad</City> 
                      <State>Gujarat</State> 
                      <PostalCode>360015</PostalCode> 
                      <Country>India</Country> 
                      <Note>Note</Note>                          
                </Address>
                <IsToBePrinted>N</IsToBePrinted>
                <ExchangeRate></ExchangeRate>
                <ExternalGUID></ExternalGUID> 
                <ApplyCheckToTxnAdd> 
                    <TxnID>9054</TxnID> 
                    <Amount>1000</Amount> 
                </ApplyCheckToTxnAdd>
                <ExpenseLineAdd>
                    <AccountRef>
                        <ListID></ListID>
                        <FullName>PublisherPayment</FullName> 
                    </AccountRef>
                    <Amount>100</Amount> 
                    <Memo>Memo</Memo>                            
                </ExpenseLineAdd>                             
            </CheckAdd>
            <IncludeRetElement>STRTYPE</IncludeRetElement> 
            </CheckAddRq>
            </QBXMLMsgsRq>
            </QBXML>"; 
```

有人可以指导吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T10:55:40.957

```
As the qbxml version needs to be 6.0 (even though the IDN Unified On-Screen Reference shows 7.0)
I needed to include the onError="continueOnError" attribute.
Setting the WebRequestObject.ContentLength property is required.
Content Type needs to be "application/x-qbxml"
And finally I received many "The remote server returned an error: (400) Bad Request." exceptions which were not helpful at all but in the end I was able to trace them to something wrong with the xml. So if you get this exception look to your xml as the source of the problem. 
```

所以，最后我改变了我的xml如下。

```
 string post = @"<?xml version=""1.0"" encoding=""UTF-8""?>
<?qbxml version=""6.0""?>
<QBXML> 
                <SignonMsgsRq>
                <SignonDesktopRq>
                <ClientDateTime>%%CLIENT_DATE_TIME%%</ClientDateTime>
                <ApplicationLogin>%%AppLogin%%</ApplicationLogin>
                <ConnectionTicket>%%ConnTicket%%</ConnectionTicket>
                <Language>English</Language>
                <AppID>%%AppID%%</AppID>
                <AppVer>1</AppVer>
                </SignonDesktopRq>
                </SignonMsgsRq>
    <QBXMLMsgsRq onError=""stopOnError"">

        <CheckAddRq requestID=""1"">
            <CheckAdd>
                <AccountRef>
                    <FullName>Checking</FullName>
                </AccountRef>                
                <PayeeEntityRef>
                    <FullName>Departures Magazine</FullName>
                </PayeeEntityRef>
                <RefNumber>9999</RefNumber>
                <TxnDate>2012-06-06</TxnDate>
                <Memo>Injury Claims Payment</Memo>
                <Address>
                    <Addr1>Eli Manning</Addr1>
                    <Addr2>1234 S. Giant St</Addr2>
                    <City>New York</City>
                    <State>NY</State>
                    <PostalCode>40961</PostalCode>
                </Address>
                <IsToBePrinted>false</IsToBePrinted>
                <ExpenseLineAdd>
                    <AccountRef>
                        <FullName>Publisher Payment</FullName>
                    </AccountRef>
                    <Amount>200.00</Amount>
                </ExpenseLineAdd>
            </CheckAdd>
        </CheckAddRq>
    </QBXMLMsgsRq>
</QBXML>"; 
```

# ios - ALAsset 中缺少视频文件缩略图时间戳

> ID：10896527
> 
> 赞同：0
> 
> 时间：2012-06-05T11:30:58.303
> 
> 标签：ios, alassetslibrary, alasset

嗨，我正在从 ALAsset 库中获取所有照片和视频的缩略图。
我的代码工作正常我正在获取照片和视频缩略图。但在视频缩略图中缺少视频图标及其时间戳。

```
[assetImageView setImage:[UIImage imageWithCGImage:[self.asset thumbnail]]]; 
```

![在此处输入图像描述](../Images/9556808f8aab90f091d1bf921c174dbc.png)

**我越来越像上面了..我正在使用 ELCImagePickerDemp API**

![在此处输入图像描述](../Images/b83de6870f64d410785bb19998cfb986.png)

**我需要像这样我错过了右下角缩略图中的时间和图标。任何帮助将不胜感激... THX**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T07:59:34.043

您注意到的资产库缩略图不包括缩略图中的符号和时间信息。因此，您必须使用从 Alassetslibrary 获得的信息在缩略图上自己绘制这些（检查 ALAssetPropertyType 和 ALAseetPropertyDuration 以获取您自己绘制这些所需的信息）。

干杯，

亨德里克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T13:51:01.773

**在ELCAlbumPickerController.m**类的两个地方用“allAssets”替换代码形式“allPhotos”中的过滤器

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

                  // replace [g setAssetsFilter:[ALAssetsFilter allPhotos]];  as it filter only photo
                   [g setAssetsFilter:[ALAssetsFilter allAssets]];  //gives allassets
}

-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath { 

 // replace [picker.assetGroup setAssetsFilter:[ALAssetsFilter allPhotos]]; as it filer only photo 
    **[picker.assetGroup setAssetsFilter:[ALAssetsFilter allAsset]];** // gives allassets
} 
```

现在所有资产都将显示在库中。为了区分视频和图像缩略图，您现在必须在构造函数中添加一些代码**ELCAsset.m**类

```
-(id)initWithAsset:(ALAsset*)asset_ {
if ([self.asset valueForProperty:ALAssetPropertyType] == ALAssetTypeVideo ){
         // code for video thumbnail 
       // you can use this link to understand video thumbnail 
     //http://stackoverflow.com/questions/11688938/alasset-thumbnail-at-specific-timestamp
}

    if ([self.asset valueForProperty:ALAssetPropertyType] == ALAssetTypePhoto ){
             // code for Photo thumbnail 
    }

} 
```

# events - 捕获打开的word文件事件

> ID：10896528
> 
> 赞同：0
> 
> 时间：2012-06-05T11:30:59.190
> 
> 标签：events, file-io, ms-word

我想将应用程序作为一个单词加载项，在打开文件时更改文件。

所以我在 Visual Studio 中创建了一个 word 插件项目，这基本上是我拥有的代码：

```
namespace WordAddIn1
{
    public partial class ThisAddIn
    {
     private void Application_DocumentOpen(Microsoft.Office.Interop.Word.Document Doc)
    {
    MessageBox.Show("doc opened");
    // do my stuff
    }

    #region VSTO generated code

    /// <summary>
    /// Required method for Designer support - do not modify
    /// the contents of this method with the code editor.
    /// </summary>
    private void InternalStartup()
    {
        this.Application.DocumentOpen += new Word.ApplicationEvents4_DocumentOpenEventHandler(Application_DocumentOpen);
    }

    #endregion
}
} 
```

问题是，如果您启动一个空的 word 应用程序（双击 word.exe），然后打开一个文档，这很有效，但如果 word 应用程序与文档打开一起启动（双击一个 .doc 文件），则不会。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:59:53.200

这是执行 Abbey 建议的代码：

```
private void ThisAddIn_Startup(object sender, System.EventArgs a)
{
  try
  {
    Word.Document doc = this.Application.ActiveDocument;
    if (String.IsNullOrWhiteSpace(doc.Path))
    {
      logger.Debug(String.Format("Word initialized with new document: {0}.", doc.FullName));
      ProcessNewDocument(doc);
    }
    else
    {
      logger.Debug(String.Format("Word initialized with existing document: {0}.", doc.FullName));
      ProcessOpenedDocument(doc);
    }
  }
  catch (COMException e)
  {
    logger.Debug("No document loaded with word.");
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:19:41.250

如果您通过双击文档打开 Word，则 DocumentOpen 不会触发。

要解决此问题，您可以检查是否在 Word 中打开了文档，如果是，则将文档传递给 Application_DocumentOpen 方法。

顺便说一句 - 您似乎已经更改了 InternalStartup 方法中的代码。正如评论所指出的，您不应该这样做，而是使用 ThisAddIn_Startup。

# ios - 将 UIImage 转换为 NSString - 不使用编码和解码

> ID：10896535
> 
> 赞同：0
> 
> 时间：2012-06-05T11:31:43.400
> 
> 标签：ios

我想在不使用任何编码和解码方法的情况下将 UIImage 转换为 NSString。使用以下代码..请指导我..这里我使用了“编码：NSASCIIStringEncoding”。但是我不想用。我想直接使用二进制文件。可能吗 ？

```
 UIImage *image = [[UIImage alloc]initWithData:imageName];
  NSData *imageDataString = UIImagePNGRepresentation(image);
  NSString *content = [[NSString alloc]initWithBytes:[imageDataString bytes] length:[imageDataString length] encoding:NSASCIIStringEncoding]; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:35:23.883

如果你想把它保存为二进制文件，你为什么不直接使用 NSDatas`writeToURL:atomically:`方法呢？如果您不想保存文件 - 只需继续使用 NSData。它是一个围绕原始二进制数据的objective-c 包装器。

# c# - C#，System.Timers.Timer，每 15 分钟运行一次，与系统时钟同步

> ID：10896536
> 
> 赞同：1
> 
> 时间：2012-06-05T11:31:43.550
> 
> 标签：c#, timer, system, sync, clock

如何让 System.Timers.Timer 每 15 分钟触发一次 Elapsed 事件，与系统时钟同步？换句话说，我希望它恰好在 xx:00、xx:15、xx:30、xx:45 触发（其中 xx 表示任何时间）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:38:33.630

您可以让它每秒过去一次，并检查当前时间是 00、15、30 还是 45，然后才转发事件。

第一个想法是：

```
private static System.Timers.Timer aTimer;
private static System.DateTime _last;

public static void Main()
{
    aTimer = new System.Timers.Timer(10000);

    aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);

    aTimer.Interval = 1000;
    aTimer.Enabled = true;

    Console.WriteLine("Press the Enter key to exit the program.");
    Console.ReadLine();
}

private static void OnTimedEvent(object source, ElapsedEventArgs e)
{
    DateTime time = 
        new DateTime( 1,1,1, DateTime.Now.Hours, DateTime.Now.Minute );

    if( time.Minute==0 ||time.Minute==15 || time.Minute==30 || time.Minute==45 )
    {
        // Avoid multiple notifications for the same quarter.
        if ( _last==DateTime.MinValue || _last!=time )
        {
            _last = time;

            // Do further processing.
            doProcessing();
        }
    }
} 
```

（基于[此 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)的示例）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-13T16:11:45.900

使用 Quartz.net。然后您可以使用正则表达式来定义间隔。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T11:43:42.867

启动程序或更改将触发的事件时间时，将事件时间加载到内存中（以防止每秒从硬盘读取此数据。）然后设置一个计时器以每 1 秒触发一次。设置为每 1 秒触发一次的计时器对处理器的开销很小。设置一个并打开任务管理器，您甚至不会注意到处理器在运行，而不是在计时器运行之前。然后检查计时器事件以检查是否到了触发事件的时间。

# jquery - 在悬停文本上创建 Jquery 淡入和淡出

> ID：10896544
> 
> 赞同：0
> 
> 时间：2012-06-05T11:32:36.603
> 
> 标签：jquery, fadein, fadeout

[如何在此http://jsfiddle.net/b3FgY/](http://jsfiddle.net/b3FgY/)上创建淡入淡出效果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:35:07.213

```
$("li", "#list-gallery").hover(
    function() {
        $(this).find("h2").fadeIn();
    },
    function() {
        $(this).find("h2").fadeOut();        
    }
    ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:34:28.183

只需使用 fadeIn 和 FadeOut 而不是显示和隐藏。

干得好：

[http://jsfiddle.net/b3FgY/1/](http://jsfiddle.net/b3FgY/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T11:36:00.893

```
$("li", "#list-gallery").hover(
    function() {
        $(this).find("h2").fadeToggle();
    }); 
```

**[演示](http://jsfiddle.net/thecodeparadox/b3FgY/4/)**

# ruby - 使用 libnet4r 或类似 gem 进行 Ruby 网络编程

> ID：10896546
> 
> 赞同：0
> 
> 时间：2012-06-05T11:32:37.287
> 
> 标签：ruby, gem, libnet

请我需要特定的 gem 来控制我的数据包并允许我制作 tcp 数据包（构建和注入 tcp 数据包）。

实际上，**[libnet4r](http://rubydoc.info/gems/libnet4r)**正在做我所需要的，但似乎不再与 ruby​​ 1.9.x 一起使用，那么是否有任何更新它的新名称或类似的 gem 做这个 lib 的相同工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T15:06:23.100

对，它不再开发或维护！

您可以使用[**PacketFu**](http://rubydoc.info/gems/packetfu)代替 lbnet4r，它非常好用且易于使用。

这里也[有一张很棒的幻灯片](http://www.slideshare.net/keith55/manipulating-the-network-with-packet-fu)

[主页](http://www.packetfu.com/)

HTH，专门为黑客准备的；）谢谢家伙

# content-management-system - CMS 将数据公开为 RESTful API

> ID：10896549
> 
> 赞同：3
> 
> 时间：2012-06-05T11:33:02.370
> 
> 标签：content-management-system

您能否推荐一个通过某种 API（HTTP、XML-RPC、Web 服务）公开整个存储内容的 CMS？

我只想将它用于创建/编辑内容，然后将从另一个站点检索内容。

例如，Wordpress 具有我正在寻找的 API 类型，但不幸的是它缺少一些我需要的功能（分层组织的文章和媒体、文章和图像排序、图像库......）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T16:20:39.187

您应该使用 Export it 插件查看[http://osmek.com/](http://osmek.com/)或[http://expressionengine.com/ 。](http://expressionengine.com/)它允许使用 REST API 拉取通道。

我一直在努力将 CMS 与我所有项目的前端分开，我过去曾使用过 ExpressionEngine 并且真的很喜欢它。您可能喜欢 EE 的另一个插件是 Playa，它允许关系数据模型。

祝你好运

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-02T21:16:20.040

查看[prismic.io](http://prismic.io)、[contentful.com](http://www.contentful.com)和[osmek.com](http://osmek.com)

# iphone - 如果我没有从 SQLite 获得任何记录，我的应用程序就会崩溃

> ID：10896553
> 
> 赞同：0
> 
> 时间：2012-06-05T11:33:18.143
> 
> 标签：iphone, sqlite, select

我第一次使用 SQlite....我在数据库中查找折扣，一切正常，直到我选择“无”。如果金额 (adNumbers) 高于或低于数据库中指定的值，则会发生这种情况。

然后，当尝试从 DB 列中检索折扣值时，我收到错误并且应用程序崩溃。我试图进行 NULL 检查，但这似乎没有帮助/工作。

我试过用 `while( sqlite3_step(compiledStatement) == SQLITE_ROW){`

但我根本没有得到任何回报......

请指出正确的方向 - 我如何检查数据库是否返回任何记录（adNumbers 在数据库中的值之间）

这是我的方法。。

`-(NSString *) adDisq:(NSString *)strDISQ:(NSInteger)adNumbers{`

 ````
NSString *strDiscount;
strDiscount = @"00";

if(adSTMT == nil) {
    const char *sql = "SELECT ID, DISCOUNT_TYPE, DESCRIPTION, AD_FROM, AD_TO, AD_DISQ FROM DISCOUNT "
                      "WHERE (((DISCOUNT_TYPE)=?) AND ((?) Between AD_FROM And AD_TO))";

    if(sqlite3_prepare_v2(database, sql, -1, &adSTMT, NULL) != SQLITE_OK)
        NSAssert1(0, @"Error while creating detail view statement. '%s'", sqlite3_errmsg(database));
}

sqlite3_bind_text(adSTMT, 1, [strDISQ UTF8String], -1, SQLITE_STATIC);
sqlite3_bind_int(adSTMT, 2, adNumbers);   

if(SQLITE_DONE != sqlite3_step(adSTMT)) {
    NSLog(@"SELECT went OK, getting rows");
    const char *columnText = (const char *)sqlite3_column_text(adSTMT, 5);
    if(columnText != NULL){
        strDiscount = [NSString stringWithUTF8String:(char *)sqlite3_column_text(adSTMT, 5)];
        NSLog(@"Discount: %@", strDiscount);
    }
    else {
        strDiscount = @"00";
    }
}
else{
    NSAssert1(0, @"Error while getting the discount'%s'", sqlite3_errmsg(database));
}

//Reset the detail statement.
sqlite3_reset(adSTMT);
return strDiscount; 
```` 

`}`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T15:43:27.443

问题解决了

NSAssert1(0, @"获取折扣时出错'%s'", sqlite3_errmsg(database));

Was making the crash - as expected - doh !

# ios - UIBezierPath 未绘制平滑曲线

> ID：10896557
> 
> 赞同：3
> 
> 时间：2012-06-05T11:33:32.073
> 
> 标签：ios, ios5, core-graphics, uibezierpath

我正在使用 UIBezierPath 进行绘图，并且我已经编写了有关触摸事件的代码并且它工作正常，但是我的曲线并不平滑，当我移动手指并绘制一些曲线时，它们并不平滑。

```
- (void)drawRect:(CGRect)rect
{    
    [[UIColor redColor] setStroke];
    for (UIBezierPath *_path in pathArray) 
    [_path strokeWithBlendMode:kCGBlendModeNormal alpha:1.0];
}

#pragma mark - Touch Methods
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    myPath=[[UIBezierPath alloc]init];
    myPath.lineWidth=5;
    myPath.lineCapStyle = kCGLineCapRound;
    myPath.flatness = 0.0;   

    UITouch *mytouch=[[touches allObjects] objectAtIndex:0];
    [myPath moveToPoint:[mytouch locationInView:self]];
    [pathArray addObject:myPath];

}
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{   
    UITouch *mytouch=[[touches allObjects] objectAtIndex:0];
    [myPath addLineToPoint:[mytouch locationInView:self]];

    [self setNeedsDisplay];    
} 
```

这是图像

![在此处输入图像描述](../Images/7d943f6a40b444e01f2e38d35b5a0833.png)

在上图中，如果您看到字母 a 和 d，您会看到曲线并不平滑。我该怎么做才能获得平滑的曲线？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T12:17:32.590

好吧，您使用的`addLinePoint`很明显，您得到的是线条，而不是曲线。您会对其他为您提供平滑曲线的方法感兴趣：[addCurveToPoint](http://developer.apple.com/library/ios/documentation/uikit/reference/UIBezierPath_class/Reference/Reference.html#//apple_ref/occ/instm/UIBezierPath/addCurveToPoint:controlPoint1:controlPoint2:)或[addQuadCurveToPoint](http://developer.apple.com/library/ios/documentation/uikit/reference/UIBezierPath_class/Reference/Reference.html#//apple_ref/occ/instm/UIBezierPath/addQuadCurveToPoint:controlPoint:)。但正如您从 API 中看到的那样，除了您实际用手指绘制的点外，您还需要绘制时未附带的控制点。甚至 Photoshop 都要求您在进行曲率时移动它们。换句话说，让你的手绘“自动”平滑涉及到相当多的数学问题。谷歌“平滑手绘”，你至少会得到这几点开始

[平滑手绘的自由形状](https://stackoverflow.com/questions/6363568/smoothing-a-hand-drawn-free-shape)

[平滑手绘曲线](https://stackoverflow.com/questions/5525665/smoothing-a-hand-drawn-curve)

它实际上根本不是 iOS 特定的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T12:51:36.610

只需使用这条线。它会解决你的问题`myPath.miterLimit=-10;`。

如果您需要任何需要浮点值的东西，请更改该值

# java - 出现错误 java.lang.IllegalStateException：从第 0 行 col -1 获取字段槽失败

> ID：10896558
> 
> 赞同：0
> 
> 时间：2012-06-05T11:33:32.293
> 
> 标签：java, android, database, sqlite, cursor

![SQLite 数据库截图](../Images/54251af26bb5239cf9bdec3e93daf0c8.png)

助手类：

```
package com.deangrobler.myApp;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.*;

public class DataBaseHelper extends SQLiteOpenHelper{

//The Android's default system path of your application database.
private static String DB_PATH = "/data/data/com.deangrobler.chumperoo/databases/"; 
private static String DB_NAME = "ChumperooDB.db"; 
private SQLiteDatabase myDataBase; 

private final Context myContext;

/**
 * Constructor
 * Takes and keeps a reference of the passed context in order to access to the application assets and resources.
 * @param context
 */
public DataBaseHelper(Context context) {

    super(context, DB_NAME, null, 1);
    this.myContext = context;
}   

/**
 * Creates a empty database on the system and rewrites it with your own database.
 * */
public void createDataBase() throws IOException{

    boolean dbExist = checkDataBase();

    if(dbExist){
        //do nothing - database already exist
    }else{

        //By calling this method and empty database will be created into the default system path
           //of your application so we are gonna be able to overwrite that database with our database.
        this.getReadableDatabase();

        try {

            copyDataBase();

        } catch (IOException e) {

            throw new Error("Error copying database: " + e.getStackTrace());

        }
    }

}

/**
 * Check if the database already exist to avoid re-copying the file each time you open the application.
 * @return true if it exists, false if it doesn't
 */
private boolean checkDataBase(){

    SQLiteDatabase checkDB = null;

    try{
        String myPath = DB_PATH + DB_NAME;
        checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);

    }catch(SQLiteException e){

        //database does't exist yet.

    }

    if(checkDB != null){

        checkDB.close();

    }

    return checkDB != null ? true : false;
}

/**
 * Copies your database from your local assets-folder to the just created empty database in the
 * system folder, from where it can be accessed and handled.
 * This is done by transfering bytestream.
 * */
private void copyDataBase() throws IOException{

    //Open your local db as the input stream
    InputStream myInput = myContext.getAssets().open(DB_NAME);

    // Path to the just created empty db
    String outFileName = DB_PATH + DB_NAME;

    //Open the empty db as the output stream
    OutputStream myOutput = new FileOutputStream(outFileName);

    //transfer bytes from the inputfile to the outputfile
    byte[] buffer = new byte[1024];
    int length;
    while ((length = myInput.read(buffer))>0){
        myOutput.write(buffer, 0, length);
    }

    //Close the streams
    myOutput.flush();
    myOutput.close();
    myInput.close();

}

public void openDataBase() throws SQLException{

    //Open the database
    String myPath = DB_PATH + DB_NAME;
    myDataBase = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READWRITE);

}

@Override
public synchronized void close() {

        if(myDataBase != null)
            myDataBase.close();

        super.close();

}

@Override
public void onCreate(SQLiteDatabase db) {

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

}

//Queries the database
public Cursor queryDataBase(String table, String[] columns, String selection){

    return myDataBase.query(table, columns, selection, null, null, null, null);

}

} 
```

在我的 Main.java 中使用如下：

```
DataBaseHelper myDbHelper = new DataBaseHelper(this);

    try {
        myDbHelper.createDataBase();
    } catch (IOException ioe) {
        throw new Error("Unable to create database"); 
    }

    try {
        myDbHelper.openDataBase();
    }catch(SQLException sqle){
        throw sqle;
    }

    //Get cursor and print out data
    Cursor returnedCur = myDbHelper.queryDataBase("Expenses", new String[]{"Name","Amount"}, null);
    if (returnedCur.moveToFirst()){
        do{
            String data = returnedCur.getString(returnedCur.getColumnIndex("data"));
            System.out.println("Returned Data: "+data);

        }while(returnedCur.moveToNext());
    }
    returnedCur.close(); 
```

最后我的整个日志：

```
> 06-05 13:28:35.885: E/CursorWindow(733): Bad request for field slot 0,-1\. numRows = 1, numColumns = 2
06-05 13:28:35.885: D/AndroidRuntime(733): Shutting down VM
06-05 13:28:35.885: W/dalvikvm(733): threadid=1: thread exiting with uncaught exception (group=0x40015560)
06-05 13:28:35.904: E/AndroidRuntime(733): FATAL EXCEPTION: main
06-05 13:28:35.904: E/AndroidRuntime(733): **java.lang.RuntimeException: Unable to start activity ComponentInfo{com.deangrobler.chumperoo/com.deangrobler.chumperoo.Main}: java.lang.IllegalStateException: get field slot from row 0 col -1 failed**
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1622)
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1638)
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:928)
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.os.Handler.dispatchMessage(Handler.java:99)
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.os.Looper.loop(Looper.java:123)
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.app.ActivityThread.main(ActivityThread.java:3647)
06-05 13:28:35.904: E/AndroidRuntime(733):  at java.lang.reflect.Method.invokeNative(Native Method)
06-05 13:28:35.904: E/AndroidRuntime(733):  at java.lang.reflect.Method.invoke(Method.java:507)
06-05 13:28:35.904: E/AndroidRuntime(733):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
06-05 13:28:35.904: E/AndroidRuntime(733):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
06-05 13:28:35.904: E/AndroidRuntime(733):  at dalvik.system.NativeStart.main(Native Method)
06-05 13:28:35.904: E/AndroidRuntime(733): Caused by: java.lang.IllegalStateException: get field slot from row 0 col -1 failed
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.database.CursorWindow.getString_native(Native Method)
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.database.CursorWindow.getString(CursorWindow.java:329)
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:49)
06-05 13:28:35.904: E/AndroidRuntime(733):  at com.deangrobler.chumperoo.Main.onCreate(Main.java:55)
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
06-05 13:28:35.904: E/AndroidRuntime(733):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1586)
06-05 13:28:35.904: E/AndroidRuntime(733):  ... 11 more
06-05 13:28:53.264: I/Process(733): Sending signal. PID: 733 SIG: 9 
```

不知道为什么会这样，我已经用谷歌搜索了半天了，没有什么能帮助我解决这个问题:-(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:36:36.610

```
new String[]{"Name","Amount"} 
```

您正在询问“数据”字段，但我在您的数据库中找不到任何字段名称“数据”。你可以试试

```
String name = returnedCur.getString(returnedCur.getColumnIndex("Name")); 
```

# java - 获取 java.io.IOException：在 getInputStream 写入服务器时出错

> ID：10896568
> 
> 赞同：0
> 
> 时间：2012-06-05T11:34:25.957
> 
> 标签：java, json, url, servlets

如果临时字符串非常大，我会得到 java.io.IOException: Error writing to server at getInputStream

```
String tmp  = js.deepSerialize(taskEx);
URL url = new URL("http://"
                    + "localhost"
                    + ":"
                    + "8080"
                    + "/Myproject/TestServletUpdated?command=startTask&taskeId=" +taskId + "'&jsonInput={\"result\":"
                    + URLEncoder.encode(tmp) + "}"); 

                    URLConnection conn = url.openConnection();
                     InputStream is = conn.getInputStream(); 
```

这是为什么？此调用转到 URL 中提到的 servlet。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:39:44.567

使用 HTTP POST 方法而不是将所有数据放在 GET 方法的 URL 中。URL 的长度是有上限的，所以如果要发送任意长度的数据，需要使用 POST 方法。

您可能需要将 URL 修改为`http://localhost:8080/Myproject/TestServletUpdated`，然后将其余部分

```
command = "startTask&taskeId=" + taskId + "'&jsonInput={\"result\":" + URLEncoder.encode(tmp) + "}" 
```

在 POST 请求的正文中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T11:36:56.027

我认为您可能有一个“网址太长”，最大字符数为 2000（[有关更多信息，请参阅此 SO 帖子](https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url)）。不会发出 GET 请求来处理如此长的数据输入。

如果您也可以更改 servlet 代码，则可以将其更改为 POST 而不是 GET 请求（就像您今天一样）。客户端代码看起来很相似：

```
public static void main(String[] args) throws IOException {

    URL url = new URL("http", "localhost:8080", "/Myproject/TestServletUpdated");

    URLConnection conn = url.openConnection();
    conn.setDoOutput(true);

    OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
    wr.write("command=startTask" +
             "&taskeId=" +taskId +
             "&jsonInput={\"result\":" + URLEncoder.encode(tmp) + "}");
    wr.flush();

    .... handle the answer ...
} 
```

* * *

我没有先看到它，但您的请求字符串中似乎有一个单引号字符。

```
...sk&taskeId=" + taskId + "'&jso.....
                            ^ 
```

尝试删除它，它可能会帮助你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T11:44:11.077

这可能是因为请求被发送为`GET`具有很少字符限制的字符。当超出限制时，您将获得一个`IOException`. 将其转换为`POST`它应该可以工作。

为了`POST`

```
URLConnection conn = url.openConnection().
OutputStream writer = conn.getOutputSteam();
writer.write("yourString".toBytes()); 
```

从您传递的 url 中删除临时字符串。将“命令”字符串移动到`"yourString".toBytes()`上面代码中的部分

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T11:46:34.543

**getInputStream()**用于读取数据。使用**getOutputStream()**

# fortran - 将 FORTRAN READ 参数传递到字符串中

> ID：10896571
> 
> 赞同：0
> 
> 时间：2012-06-05T11:34:42.113
> 
> 标签：fortran

我有一个字符串，其中包含我要读取的变量的名称，我想将此字符串传递给 read 函数。这可以让我更改我读取的变量的名称，只需使用变量名称更改向量。一个例子可能是：

```
PROGRAM test
implicit none

  integer :: no, age
  character(len=20) :: myname, vars

vars='no, myname, age'
read(*, '(i4,a20,i4)') vars
print*, no, myname, age 

END PROGRAM test 
```

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:58:51.077

Fortran 是一种编译语言。该语句很难（甚至不可能）`READ`在运行时从字符串列表中提取变量地址。这就是为什么，正如 janneb 所指出的，Fortran 提供了`NAMELIST`自 Fortran 90 以来成为语言标准的一部分的运算符（一些 Fortran 77 也支持名称列表，但它是非标准的，并且编译器之间不能保证兼容性）。它是这样使用的：

```
...
NAMELIST /vars/ no, age, myname
...
READ(*, NML=vars)
... 
```

输入应该是这样的：

```
! Input can contain comments starting with exclamation marks

! And blank lines too
&vars
 no = 12,
 myname = 'sometext'/ 
```

但是，格式化输入/输出是不可能的`NAMELIST`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:43:48.460

您可以查看“NAMELIST”I/O，它可能会满足您的需求。通常，namelist IO 存在各种问题，而且人们经常求助于编写自己的自定义 IO 例程。但是，如果它足以满足您的需求，那么它很容易使用。例如

```
 program nmltest
  implicit none
  real :: x
  integer :: y
  namelist /mynml/ x, y
  x = 4711
  y = 42
  write(*, mynml)
end program nmltest 
```

# vb6 - 如何在 VB6 中进行区域 OCR？

> ID：10896574
> 
> 赞同：2
> 
> 时间：2012-06-05T11:34:47.427
> 
> 标签：vb6, ocr, scanning, modi

正如您在下面看到的那样，我制作了一个程序来扫描文档并可选择获取页面信息以及材料和尺寸信息以及日期信息。

![在此处输入图像描述](../Images/02139d03dc49d317d83577cba7599b41.png)

当我像这样使用 OCR 扫描时：

```
Dim Mdoc As MODI.Document
Dim Mlay As MODI.Layout
Dim fso As Scripting.FileSystemObject
Dim logfile As Object

Public Function ScanMan(ByVal Name As String, ByVal Path As String) As String
    Set Mdoc = New MODI.Document
    'Set Mdoc = CreateObject("MODI.Document")
    Set fso = New Scripting.FileSystemObject

    DoEvents
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    ''''''''''''''''''' Create OCRLog File '''''''''''''''''''
    OCRPath = App.Path & "\OCR Results Log\"
    OCRName = Str(DateTime.Date) & " OCRresults"
    If fso.FolderExists(OCRPath) = False Then
        fso.CreateFolder (OCRPath)
    End If
    If fso.FileExists(OCRPath & OCRName & ".txt") = False Then
        fso.CreateTextFile OCRPath & OCRName & ".txt"
    End If
    Set logfile = fso.OpenTextFile(OCRPath & OCRName & ".txt", ForAppending)
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

    On Error GoTo OCRErr
    DoEvents
    Mdoc.Create Path & "\" & Name
    Mdoc.Images(0).OCR miLANG_ENGLISH, True, True
    logfile.Write Mdoc.Images(0).Layout.Text

    ScanMan = Mlay.Text

    Mdoc.Close False

    Set Mlay = Nothing
    Set Mdoc = Nothing

    Exit Function

OCRErr:
    logfile.WriteLine "OCR given (" & Err.Number & ") numbered (" & Err.Description & ") error."
    logfile.Close
End Function 
```

这将获取整个页面，但我只想扫描这 3 个特定区域，那么我该如何实现呢？有什么功能吗？哪个只扫描 X,Y 坐标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T07:56:23.447

***vb6 片段***

```
Sub TestTextSelection()

  Dim miTextSel As MODI.IMiSelectableItem
  Dim miSelectRects As MODI.miSelectRects
  Dim miSelectRect As MODI.miSelectRect
  Dim strTextSelInfo As String

  Set miTextSel = MiDocView1.TextSelection
  Set miSelectRects = miTextSel.GetSelectRects
  strTextSelInfo = _
    "Bounding rectangle page & coordinates: " & vbCrLf
  For Each miSelectRect In miSelectRects
    With miSelectRect
      strTextSelInfo = strTextSelInfo & _
        .PageNumber & ", " & .Top & ", " & _
        .Left & ", " & .Bottom & ", " & _
        .Right & vbCrLf
    End With
  Next
  MsgBox strTextSelInfo, vbInformation + vbOKOnly, _
    "Text Selection Info"

  Set miSelectRect = Nothing
  Set miSelectRects = Nothing
  Set miTextSel = Nothing

End Sub 
```

***虽然问题被标记为`vb6`但答案来自`vb.Net 2010`。我希望`vb.NET`可以很容易地转换为`vb6`，唯一的问题就是多花一些时间。***

# 基本思想是从图像创建一个 xml 文件，然后对 xml 文件运行查询以获取由 ( `x1,y1`) 和 ( `x2,y2`) 包围的所需块的文本。

***`The core class`***

```
Imports System
Imports System.IO
Imports System.Xml
Imports System.Linq
Imports MODI

Public Class clsCore
    Public Sub New()
        'blah blah blah
    End Sub

    Public Function GetTextFromCoordinates(ByVal iPath$, ByVal x1&, ByVal y1&, ByVal x2&, ByVal y2&) As String
        Try
            Dim xDoc As XElement = Me.ConvertImage2XML(iPath)
            If IsNothing(xDoc) = False Then
                Dim result As New XElement(<text/>)
                Dim query = xDoc...<wd>.Where(Function(c) Val(CStr(c.@left)) >= x1 And Val(CStr(c.@right)) <= x2 And Val(CStr(c.@top)) >= y1 And Val(CStr(c.@bottom)) <= y2)
                For Each ele As XElement In query
                    result.Add(CStr(ele.Value) & " ")
                Next ele
                Return Trim(result.Value)
            Else
                Return ""
            End If
        Catch ex As Exception
            Console.WriteLine(ex.ToString)
            Return ex.ToString
        End Try
    End Function

    Private Function ConvertImage2XML(ByVal iPath$) As XElement
        Try
            If File.Exists(iPath) = True Then
                Dim miDoc As New MODI.Document
                Dim result As New XElement(<image path=<%= iPath %>/>)
                miDoc.Create(iPath)
                For Each miImg As MODI.Image In miDoc.Images
                    Dim page As New XElement(<page id=<%= result...<page>.Count + 1 %>/>)
                    miImg.OCR()
                    For Each miWord As MODI.Word In miImg.Layout.Words
                        Dim wd As New XElement(<wd block=<%= miWord.RegionId.ToString %>><%= miWord.Text %></wd>)
                        For Each miRect As MODI.MiRect In miWord.Rects
                            wd.Add(New XAttribute("left", miRect.Left))
                            wd.Add(New XAttribute("top", miRect.Top))
                            wd.Add(New XAttribute("right", miRect.Right))
                            wd.Add(New XAttribute("bottom", miRect.Bottom))
                        Next miRect
                        page.Add(wd)
                    Next miWord
                    result.Add(page)
                Next miImg
                Return result
            Else
                Return Nothing
            End If
        Catch ex As Exception
            Console.WriteLine(ex.ToString)
            Return Nothing
        End Try
    End Function
End Class 
```

***这`main module`***

```
Imports System
Imports System.IO
Imports System.Text.RegularExpressions

Module modMain

    Sub Main()
        Dim iPath$ = "", iPos$ = "150,825,1400,1200"
        Console.WriteLine("Enter path to file:")
        iPath = Console.ReadLine()
        Console.WriteLine("")
        Console.WriteLine("Enter co-ordinates(i.e., x1,y1,x2,y2 or 150,825,1400,1200):")
        iPos = Console.ReadLine()
        Dim tmp As String() = Regex.Split(iPos, "\D+")
        Dim outText$ = New clsCore().GetTextFromCoordinates(iPath, tmp(0), tmp(1), tmp(2), tmp(3))
        Console.WriteLine("")
        Console.WriteLine(String.Format("{0}[({1},{2})-({3},{4})]:{5}{5}{6}", Dir(iPath), tmp(0), tmp(1), tmp(2), tmp(3), vbCrLf, outText))
        Console.ReadLine()
    End Sub

End Module 
```

**更新**

*下面的示例报告查看器控件中用户图像选择周围的边界矩形的页码和坐标。并且可以稍后在图片框中使用。*

```
Sub TestImageSelection()

  Dim miImageSel As MODI.IMiSelectableImage
  Dim lngPageNo As Long
  Dim lngLeft As Long, lngTop As Long
  Dim lngRight As Long, lngBottom As Long
  Dim strImageSelInfo As String

  Set miImageSel = MiDocView1.ImageSelection
  miImageSel.GetBoundingRect lngPageNo, _
    lngLeft, lngTop, lngRight, lngBottom
  strImageSelInfo = _
    "Page number: " & lngPageNo & vbCrLf & _
    "Bounding rectangle coordinates: " & vbCrLf & _
    lngLeft & ", " & lngTop & ", " & _
    lngRight & ", " & lngBottom
  MsgBox strImageSelInfo, vbInformation + vbOKOnly, _
    "Image Selection Info"

  Set miImageSel = Nothing

End Sub 
```

* * *

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-27T07:56:45.343

我使用图像和图片框将图片裁剪和调整为高清像素和大小，以便包含在高清电影中。我使用滑块控件移动了图片（例如`PicSize.Value`） 图片框设置为 1900x1080 像素，使用`Visible=false`. 图像框大小`Stretch`设置为`true`大小并不重要，并显示最终裁剪图片的较小版本。

我将图片框保存为 bmp，因此它可以很好地与我在 Adob​​e 编辑器中的 AVCHD 视频集成，并且与视频的帧大小相同。

这是主要的子程序：

```
-Private Sub Convert()
'Creates a cropped and/or magnified fixed pixel 1900x1080 picture
Dim file_name As String, LeftPos As Long
Picture2.Picture = LoadPicture("")
DoEvents 
' Resize the picture.
LeftPos = 950 + HPos.Value - PicSize.Value / 2 + PicWidth.Value * 20
Picture2.PaintPicture Picture1.Picture, _
    LeftPos, VPos.Value, _
    PicSize.Value - (PicSize.Value * (PicWidth.Value / 50)), _
    PicSize.Value * (Aspect.Value / 100)
Picture2.Picture = Picture2.Image
TopValue.Caption = VPos.Value
HPosValue.Caption = HPos.Value
SizeValue.Caption = PicSize.Value
AspectValue.Caption = Aspect.Value - 75
StretchValue.Caption = PicWidth.Value
Image1.Picture = Picture2.Image 'preview it
End Sub 
```

# ios - IOS：CGRect是对的，但是UIImage翻转了

> ID：10896578
> 
> 赞同：2
> 
> 时间：2012-06-05T11:35:05.897
> 
> 标签：ios, drawing, cgcontext

我知道我必须在绘图时翻译坐标系。问题是当我使用：

```
CGContextTranslateCTM(_context, 0.0, _size.height);
CGContextScaleCTM(_context, 1.0, -1.0); 
```

我的图像的矩形被翻转，图像是“非翻转”的，如果我不使用上面的图像，我的图像被翻转，矩形是非翻转的。

这是我的代码：

```
CGRectMake(60, 100, image.size.width, image.size.height);
CGContextSaveGState(_context);
UIGraphicsBeginImageContext(image.size);
CGContextClearRect(_context, placeholderRect);
CGContextDrawImage(_context, placeholderRect, image.CGImage);
UIGraphicsEndImageContext();
CGContextRestoreGState(_context); 
```

当图像被翻转时，我如何保持我的矩形（非翻转）？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:34:05.227

而不是使用`CGContextDrawImage`使用`[image drawAtPoint:CGPointMake(0,0)];`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:41:44.707

诀窍可能在于这个 UIImage 方法

```
+ (UIImage *)imageWithCGImage:(CGImageRef)imageRef scale:(CGFloat)scale orientation:(UIImageOrientation)orientation 
```

其中方向是其中之一:)

```
typedef enum {
   UIImageOrientationUp,
   UIImageOrientationDown,   // 180 deg rotation
   UIImageOrientationLeft,   // 90 deg CCW
   UIImageOrientationRight,   // 90 deg CW
   UIImageOrientationUpMirrored,    // as above but image mirrored along other axis. horizontal flip
   UIImageOrientationDownMirrored,  // horizontal flip
   UIImageOrientationLeftMirrored,  // vertical flip
   UIImageOrientationRightMirrored, // vertical flip
} UIImageOrientation; 
```

**编辑：更新**

我刚刚在覆盖 drawrect 的 UIView 子类中做了这个简单的代码示例，它工作得很好。它不使用 UIImage 方法，但工作方式相同。

```
UIImage *image = [UIImage imageNamed:@"image.png"];

CGContextRef _context = UIGraphicsGetCurrentContext();

CGContextSaveGState(_context);

CGContextDrawImage(_context, CGRectMake(100, 20, image.size.width, image.size.height), image.CGImage);

CGContextScaleCTM(_context, -1.0f, 1.0f);

CGContextDrawImage(_context, CGRectMake(-300, 20, image.size.width, image.size.height), image.CGImage);

CGContextRestoreGState(_context); 
```

# php - 如何使 window.location.replace 在 IE 9 中工作？

> ID：10896584
> 
> 赞同：3
> 
> 时间：2012-06-05T11:35:23.333
> 
> 标签：php, javascript, jquery, internet-explorer

我有以下代码检查用户名和密码，如果成功则重定向到新页面。它在 Firefox 上运行得很好，但是当我在 IE 9 上尝试它时，它只是静止不动。我需要做什么才能在 IE 上进行这项工作？

```
username=$("#user_name").val();
password=$("#password").val();
$.ajax({
    type: "POST",
    url: "login.php",
    data: "name="+username+"&pwd="+password,
    success: function(html){
    console.log(html);
    if(html=='true') {
        window.location.replace("newpage.php");
    } else {
        $("#add_err").html("Wrong username or password.");   
    }
}, 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-05T11:53:16.923

首先关于其他答案：location.replace 与仅更改 location.href 不同，它对历史的反应不同，并且在许多情况下 location.replace 对用户体验更好，所以不要扔毛巾在 location.replace 这么快！

所以我刚刚在我的机器上测试了 IE9 中的 location.replace 并且它工作正常。

然后我在我的 IE9 上测试了 console.log 并且它卡住了（这显然只有在我正在阅读的某个开发人员面板或选项卡或其他东西打开时才有效，尽管我对 IE9 的开发工具没有太多经验可以肯定地说）。

*我打赌你的问题不在于 location.replace 函数，而实际上是它之前的 console.log 函数！*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-10T15:05:16.093

好吧，我一直在寻找如何在 IE 上更改 window.location ，这对我有用：

```
var targetlocation = "mylocation";

setTimeout(changeURL,0)

function changeURL()
{
    window.location = targetlocation;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-05T11:37:10.490

你不需要更换。

```
if(html=='true') {
        window.location = "newpage.php";
       // or
       window.location.href = "newpage.php";
    } else {
        $("#add_err").html("Wrong username or password.");   
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T11:39:02.680

尝试

`window.location.href = 'newpage.php'`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-05T11:39:23.197

```
window.location = "newpage.php"; 
```

或者

```
window.location.href = "newpage.php"; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-05T12:08:21.063

```
if(html) {
  window.location.href = "filename.php";
} else {
  $("#add_err").html("Wrong username or password.");
} 
```

# java - 通过许可证或密钥保护 Java 应用程序

> ID：10896596
> 
> 赞同：10
> 
> 时间：2012-06-05T11:36:20.323
> 
> 标签：java, security, licensing

我想制作一个只能在具有密钥或许可证的机器上运行的桌面应用程序。如何做到这一点？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-05T12:00:33.243

这完全取决于你想要让它有多安全......

Java的问题是你可以反向编译它。因此，如果有人愿意，他们可以下载您的软件，对其进行反向编译，然后删除您设置的任何安全性（然后如果他们愿意，可以重新分发）。

如果您计划进入大众市场并出售它，这只是一个问题，但盗版实际上是一个问题。

如果您不担心这一点，那么您可以在线或离线检查。

与我合作的公司使用在线方式；有几个步骤：

编辑：我已经改变了它的工作方式，因为旧的方式是维护的噩梦。

1.  许可证文件
    *   （这可以包含你在现实中想要的任何东西，它必须是每个用户唯一的。大多数人通常穿着一般的服装；
    *   `name`
    *   `company`
    *   `email`
    *   然后一个`key`. 即`JDU8-AJS9-88DF-SASF-ASF9`你经常看到的那种东西。
2.  该程序从许可证文件生成一个散列。
    1.  将许可证文件中的所有数据放入一个字符串中
    2.  将字符串传递给哈希函数，[此页面](https://stackoverflow.com/questions/415953/generate-md5-hash-in-java)可以向您展示如何。
3.  让程序在线检查（在您的服务器上）。数据在 HTML 请求中编码（post/get/json/whatever you want）并提交到您的许可证验证页面，然后验证数据。数据中包含一个随机生成的字符串，验证页面使用该字符串生成另一个密码。然后将其返回给程序，该程序也使用随机字符串生成自己的密码。如果两者匹配，则程序启动。

要生成密钥，只需使用相同的散列函数，然后将散列上传到您的服务器。

如果你想让它离线，你可以在我猜的代码中包含哈希值并在那里检查它们。

但是，我应该指出，无论如何我都不是安全专家，我只是作为博士的一部分为公司开发。这就是我的做法。

编辑：这张图片可能会有所帮助：

![在此处输入图像描述](../Images/9db3bed6af18dcf3ea2e44c142fc0b38.png)

第二次编辑：

我现在在这个过程中加入了“离线验证”。这不是真正的离线验证，它只是将用户用作代理——他们需要以另一种方式访问​​互联网。

它是这样工作的：

1.  未找到互联网连接：向用户提供 4 位代码
2.  用户进入离线验证页面（也针对移动使用进行了优化）
3.  用户从下拉列表中选择他们使用的软件
4.  用户输入他们的用户名（此字段记住条目）
5.  用户输入程序给他们的代码并提交
6.  网页提供了一个 4 位代码，然后他们将其输入到程序中，然后程序启动。
7.  程序将一些特殊数据添加到许可证文件中，这意味着下周/月/无论多长时间都不需要重复此过程。

每次程序成功在线验证时，它还会在许可证文件中添加一个离线访问密码，这意味着它可以抵抗临时的互联网停机时间，并且只有在互联网停机超过一周/一个月/无论多长时间时才会停止工作设置为工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:00:15.990

您可以使用 macIP 在线跟踪机器的许可。即使在 Windows 中，您也可以在注册表中写入没有 api，但您仍然可以这样做。在下面找到片段以读取注册表 -

```
public static final String readRegistry(String location, String key){
        try {
            // Run reg query, then read output with StreamReader (internal class)
            Process process = Runtime.getRuntime().exec("reg query " + 
                    '"'+ location + "\" /v " + key);

            StreamReader reader = new StreamReader(process.getInputStream());
            reader.start();
            process.waitFor();
            reader.join();
            String output = reader.getResult();

            // Output has the following format:
            // \n<Version information>\n\n<key>\t<registry type>\t<value>
            if( ! output.contains("\t")){
                    return null;
            }

            // Parse out the value
            String[] parsed = output.split("\t");
            return parsed[parsed.length-1];
        }
        catch (Exception e) {
            return null;
        }

    } 
```

如果你想混淆使用[proGuard](http://proguard.sourceforge.net/)在类级别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T11:43:24.693

这取决于您计划拥有多少客户以及分销模式。您可以使用许可证服务器，但这需要客户连接互联网。您还可以使用 USB 加密狗来管理许可。

没有完美的系统可以让您在简单、努力和价格之间做出折衷。

# error-handling - QTP，调用特定函数时出现未指定错误

> ID：10896603
> 
> 赞同：1
> 
> 时间：2012-06-05T11:36:59.927
> 
> 标签：error-handling, vbscript, runtime-error, qtp

我在使用 QTP 11（快速测试专业版）时遇到问题，尝试调用某些函数时出现问题，QTP 显示运行时错误（“常规运行错误”）弹出消息框。

我已经尝试了很多次来解决这个问题，但我不明白究竟是什么导致了这个错误。

当我从“函数库”调用函数时，会显示错误。除非我将此功能用于操作，否则该功能将起作用。

有没有人面临这样的问题？

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:29:16.827

有时，当我尝试调用函数并在函数调用中传递错误数量的参数时，我会收到“常规运行错误”错误。

你能再解释一下你的最后一段吗？当您通过 FL 运行该功能时，它可以工作吗？您不应该直接在 FL 中运行函数，而是在您的操作中运行。

这是一个例子：

**行动**

```
test_function("Hello", "42")
test_function(42, "Hello") 
```

**函数库**

```
Function test_function(sTextString, iIntNumber)
  iNewIntNumber = iIntNumber + 1
  MsgBox "String: " & sTextString & vbNewLine & "Int + 1: " & iNewIntNumber
End Function 
```

在我的函数库中，第二行（*iNewIntNumber = iNewIntNumber + 1*）可能会由于对变量的无效转换而在操作中引发“一般运行错误”。

# jsp - 将此 scriptlet 代码转换为 JSTL / EL？

> ID：10896613
> 
> 赞同：0
> 
> 时间：2012-06-05T11:37:47.153
> 
> 标签：jsp, servlets, jstl, el, scriptlet

我不知道如何将此 scriptlet 代码重新编码为 JSTL / EL taglib。这些语句非常简单，但它使用会话数据并生成我不知道如何在 JSTL / EL 中执行的新对象。是否可以将其重新编码为 JSTL / EL 或者我是否需要将其放入预处理 servlet？如果我需要预处理 servlet，那么我仍然不知道如何管理，因为该视图没有特定的请求处理程序，只有对将会话对象填充到我们的 jsp 页面的网页的访问。如何将其重写为 JSTL / EL？

```
<%
    final Logger logger = Logger.getLogger("arendeprocess_grunduppgifter_visa.jsp");
    ArendeProcessPageController apc = new ArendeProcessPageController(request);
    GrunduppgifterPageController pc = new GrunduppgifterPageController(request);
    String arendeTyp = apc.getArendeTyp();
    boolean showSearch = false;
    int vectr = 0; // får bara användas i errormessages.jspf
    IFormData ifData = PandoraManager.getSessionData(session).getFormData();

    AnsokanInfo ansokanInfo = apc.getAnsokanInfo();
    PersonInfo editPerson = new PersonInfo();
    if(ansokanInfo != null && ansokanInfo.hasEditPersonInfo()) {
        editPerson = ansokanInfo.getEditPersonInfo();
    } else {
        editPerson.setFornamn(apc.getNyregPerson().getFornamn());
        editPerson.setEfternamn(apc.getNyregPerson().getEfternamn());
        editPerson.setForetag(apc.getNyregPerson().getForetag());
        //editPerson.setOrgnr(apc.getNyregPerson().getOrgnr());
        editPerson.setLandKod(apc.getNyregPerson().getLandKod());
    }
    if(apc.getLatestAction().equals("Namnsokning") && apc.getLatestActionCommand().equals("search")) {
        showSearch = true;    
    }
    List<PersonInfo> sokandeList = ansokanInfo.getSokandeList();
    List<PersonInfo> uppfinnareList = ansokanInfo.getUppfinnareList();
    List<PersonInfo> ombudList = ansokanInfo.getOmbudList();
    List<Prioritet> prioriteter = ansokanInfo.getPrioriteter();
    List<Deposition> depositioner = ansokanInfo.getDepositioner();
    request.setAttribute("request", request);
    request.setAttribute("ansokanInfo", ansokanInfo); 
    request.setAttribute("editPerson", editPerson);
    request.setAttribute("apc", apc);
    request.setAttribute("sokandeList", sokandeList);
    request.setAttribute("uppfinnareList", uppfinnareList);
    request.setAttribute("ombudList", ombudList);
    request.setAttribute("GrunduppgifterConstants", new GrunduppgifterConstants());
%> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:56:14.013

是的，您可以在 scriptlet 中编写的任何内容都可以在`EL/Custom Tags`.

有两种方法：

*   将所有 Controller 类更改为 Use Beans 并使用 EL 编写上述代码。
*   将上述代码移至自定义标签并消除 scriptlet

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T13:50:07.957

JSTL 旨在控制 HTML 生成的流程。然而，这个*scriptlet*不会产生任何 HTML，所以用 JSTL 替换是完全没有问题的。

您确实需要一个预处理 servlet。我只是不明白你到底是什么意思

> *我仍然不知道如何管理，因为该视图没有特定的请求处理程序，只有对将会话对象填充到我们的 jsp 页面的网页的访问*

但这应该是将有问题的 JSP 文件移动到`/WEB-INF`文件夹中，以便永远无法直接访问它，并创建一个映射到所需 URL 模式的 servlet，并在`doGet()`方法中完成工作并最终转发到所需的 JSP。假设 JSP 文件是`/page.jsp`并且已经被重新定位到`/WEB-INF/page.jsp`，那么 servlet 将如下所示：

```
@WebServlet("/page.jsp")
public class PageServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // Put the original scriptlet code here.

        // Keep the following line untouched.
        request.getRequestDispatcher("/WEB-INF/page.jsp").forward(request, response);
    }

} 
```

# javascript - 使用 javascript 同步获取 CRM 2011 中的元数据

> ID：10896616
> 
> 赞同：3
> 
> 时间：2012-06-05T11:37:52.967
> 
> 标签：javascript, metadata, dynamics-crm-2011, synchronous

有没有办法使用 javascript 以同步方式从 CRM 2011 获取元数据？如果是的话，有人可以用SDK中的一些示例代码（我找不到）或者你自己的代码来找我吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T12:17:16.137

在 SDK 中，samplecode\js\soapforjscript\soapforjscript\scripts\sdk.metadata.js 文件中有 RetrieveAllEntitiesAsync、RetrieveEntityAsync 和 RetrieveAttributeAsync 示例。`req.open`要进行同步，请将语句的第三个参数更改为`false`. 然后您可以删除处理程序并在语句`onreadystatechange`之后立即处理响应。`req.send(request);`

# c# - HTML 编码 alpha、beta、gamma

> ID：10896617
> 
> 赞同：0
> 
> 时间：2012-06-05T11:37:53.270
> 
> 标签：c#, .net, html, unicode

我正在尝试对包含 alpha、beta 和 gamma 字符（α、β、γ）的字符串进行 HTML 编码。不幸的是，使用`System.Web.HttpUtility.HtmlEncode`不编码这些字符。.NET 库中是否还有其他一些函数可以将这些编码为 HTML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:57:34.820

不知道有任何内置工具，但您可以使用这个方便的功能：

```
public string ForceHtmlEncode(string input)
{
    return string.Concat(input.Select(c => "&#" + (int)c + ";"));
} 
```

这将简单地将字符串中的所有字符转换为 HTML 实体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:40:51.873

尝试将其用于 html 视觉 [http://www.w3schools.com/tags/ref_entities.asp](http://www.w3schools.com/tags/ref_entities.asp)

# c# - ADO 实体框架是否能够运行多个实例

> ID：10896619
> 
> 赞同：1
> 
> 时间：2012-06-05T11:38:02.993
> 
> 标签：c#, .net, entity-framework, ado.net

所以我们有这个使用自制数据访问框架的 Web 服务，我发现在当前状态下，该 Web 服务一次不能运行多个实例，因为这个框架会开始自己站起来，抱怨连接是已关闭/已打开并出现类似错误。

所以我实现了一个 SQL 锁/互斥锁，它对所有请求进行排队，从那时起，它一直非常顺利。

我最近为另一个使用 ADO 实体框架（在此之前我从未使用过）的项目工作，并发现它几乎可以完成这个自制框架的作用。

我的问题是，ADO 实体框架本身是否足够强大，所以我不再需要这个 SQL 互斥体实现了？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:44:43.103

如果您遵循“不要在线程之间共享 ObjectContext（代码中的 DbContext）实例”的规则，一切都会好起来的。

实体框架使用一些静态数据来提高性能（实体模型缓存），但大多数对象（实体连接、上下文、更改跟踪器等）不是线程安全的，不应在线程之间共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:49:04.790

是的，它足够健壮，因为您不在线程之间共享 dbcontexts，而您的自制层必须这样做。不是我会走的路。

# apache-flex - 流错误＃2032

> ID：10896620
> 
> 赞同：2
> 
> 时间：2012-06-05T11:38:04.533
> 
> 标签：apache-flex, rsl

我是 flex 新手，从星期一开始，我正在维护的 flex 应用程序出现问题。似乎 spark-component 尝试从 adobe-downloader-server 加载一些运行时共享库​​，这些库显然（不再？）存在（stream-error #2032）。在以下位置查找了其中一个丢失的文件： [http](http://fpdownload.adobe.com/pub/swz/flex/4.0.0.13495/osmf_flex.4.0.0.13495.swf) ://fpdownload.adobe.com/pub/swz/flex/4.0.0.13495/osmf_flex.4.0.0.13495.swf (iirc)

其他丢失的文件是：rpc_4.1.0.16076.swf、spark_4.1.0.16076.swf、sparkskins_4.1.0.16076.swf、textLayout_1.1.0.604.swf

我通过下载相关文件并在服务器上提供它们来避免这个问题，但想知道为什么其他人似乎没有这些问题。我的理论是，这些文件存在并且现在由于某些原因被删除，但我找不到任何信息。有谁知道发生了什么？如果我的理论是正确的并且这些文件被删除了，那么 Adob​​e 在哪里传达如此繁重的步骤？

谢谢

# c# - Winforms DataGridView 中的超链接单元格

> ID：10896623
> 
> 赞同：19
> 
> 时间：2012-06-05T11:38:10.763
> 
> 标签：c#, datagridview, hyperlink

我有一个包含以下数据的datagridview。

```
ContactType        |        Contact
------------------------------------
Phone              |       894356458
Email              |     xyz@abc.com 
```

在这里，我需要将数据“xyz@abc.com”显示为超链接，并带有工具提示“单击以发送电子邮件”。数字数据“894356458”不应有超链接。

有任何想法吗？？？

蒂亚！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-05T11:55:29.497

有`DataGridView`一个列类型，即[`DataGridViewLinkColumn`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewlinkcolumn.aspx).

您需要手动绑定此列类型，其中`DataPropertyName`设置要绑定到网格数据源中的列：

```
DataGridViewLinkColumn col = new DataGridViewLinkColumn();
col.DataPropertyName = "Contact";
col.Name = "Contact";       
dataGridView1.Columns.Add(col); 
```

您还需要隐藏来自网格的 Contact 属性的自动生成的文本列。

此外，与`DataGridViewButtonColumn`您需要通过响应`CellContentClick`事件来自己处理用户交互一样。

* * *

然后，要更改不是纯文本超链接的单元格值，您需要将链接单元格类型替换为文本框单元格。在下面的示例中，我在`DataBindingComplete`活动期间完成了此操作：

```
void dataGridView1_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
{
    foreach (DataGridViewRow r in dataGridView1.Rows)
    {
        if (!System.Uri.IsWellFormedUriString(r.Cells["Contact"].Value.ToString(), UriKind.Absolute))
        {
            r.Cells["Contact"] = new DataGridViewTextBoxCell();
        }
    }
} 
```

* * *

您也可以从另一个方向执行此操作，将 更改`DataGridViewTextBoxCell`为`DataGridViewLinkCell`我建议的第二个，因为您需要应用适用于每个单元格的所有链接的任何更改。

尽管您不需要隐藏自动生成的列，但这确实具有优势，因此可能最适合您。

```
void dataGridView1_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
{
    foreach (DataGridViewRow r in dataGridView1.Rows)
    {
        if (System.Uri.IsWellFormedUriString(r.Cells["Contact"].Value.ToString(), UriKind.Absolute))
        {
            r.Cells["Contact"] = new DataGridViewLinkCell();
            // Note that if I want a different link colour for example it must go here
            DataGridViewLinkCell c = r.Cells["Contact"] as DataGridViewLinkCell;
            c.LinkColor = Color.Green;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-30T00:33:10.033

您可以在 DataGridView 中更改整列的样式。这也是一种制作列链接列的方法。

```
DataGridViewCellStyle cellStyle = new DataGridViewCellStyle();
        cellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter;
        cellStyle.ForeColor = Color.LightBlue;
        cellStyle.SelectionForeColor = Color.Black;
        cellStyle.Font = new Font(FontFamily.GenericSansSerif, 10, FontStyle.Underline);
        dataGridView.Columns[1].DefaultCellStyle = cellStyle; 
```

# php - Memcached 消息错误

> ID：10896624
> 
> 赞同：0
> 
> 时间：2012-06-05T11:38:12.290
> 
> 标签：php, memcached, libmemcache

我首先对我的网站使用缓存方法：

阿帕奇配置：

```
Listen 127.0.0.1:11211 
```

php.ini 配置

```
extension=php_memcache.dll 
```

我认为一切都很好，但是在尝试这个简单的缓存代码时：

```
$cache=new Memcache();
$cache->connect('127.0.0.1',11211);
$cache->set('mykey','Hello world');

echo $cache->get('mykey'); 
```

它向我发送一条消息错误：

注意：Memcache::set() [memcache.set]: Server 127.0.0.1 (tcp 11211) failed with: Failed reading line from stream (0) on line 20 ,

请记住，第 20 行是 $cache->set('mykey','hello world')，这意味着：它已经通过端口 11211 成功连接。

如果这是 Memcache 库中的一个严重错误，那么我会提到我正在使用 windows server ，并且我希望“memcached”在 windows 平台上而不是 memcache 上工作。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:41:41.880

尝试使用

```
$cache->add('mykey','Hello world'); 
```

# c++ - 当对象引用作为参数传递时，为什么析构函数在函数范围结束后调用？

> ID：10896626
> 
> 赞同：1
> 
> 时间：2012-06-05T11:38:24.810
> 
> 标签：c++, pass-by-reference, destructor

当对象引用作为参数传递时，为什么在函数 (pass(sample const &ob1)) 范围结束后调用析构函数？为什么它在函数 pass() 中创建一个新对象，而我们正在传递一个对象引用？

帮帮我，我收到内存转储错误

```
#include<iostream>
using namespace std;

class sample
{
public:
    int *ptr;
    sample()    
    {
        cout<<"this is default constructor & addr  "<<this<<endl;
    }
    sample(int i)
    {
        cout<<"this is single parameter constructor & addr "<<this<<endl;
        ptr=new int[i];

    }
    void disp() 
    {
        cout<<"hello \n";
    }
    ~sample()
    {
        cout<<"destructor & addr "<<this;
        delete ptr;
    }

};

sample pass(sample const& ob1)
{

for(int i=0;i<5;i++)
    ob1.ptr[i]=10;
return ob1;

}

int main()
{   
sample obj(5);
sample copy;
cout<<"before calling \n";
obj.disp();
pass(obj);
copy.disp();
cout<<"after calling \n";
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:40:19.613

那是因为你按值返回：

```
sample pass(sample const& ob1)
{
   //...
   return ob1;  
} 
```

并且不能保证会发生 RVO。在这种情况下，我什至不确定它是否*会*发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:40:10.907

您正在`sample`按值返回；这涉及到 a 的构造和销毁`sample`（尽管在某些情况下它可以被[优化掉](http://en.wikipedia.org/wiki/Return_value_optimization)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-24T12:09:20.440

函数 pass() 正在创建一个新对象，因为该对象是按值返回的，而不是按引用返回的。按值返回对象将调用复制构造函数，并且将创建一个新对象（临时对象），该对象将在函数返回时立即销毁。

为避免创建临时对象，请尝试通过引用返回对象。此外，默认构造函数未初始化导致内存转储错误的整数指针。

```
sample const& pass(sample const &ob1)
{

for(int i=0;i<5;i++)
ob1.ptr[i]=10;
cout << "pass & addr " << &ob1 << endl ;

return ob1;

}
sample()    
{
    cout<<"this is default constructor & addr  "<<this<<endl;
    this->ptr = new (int);
} 
```

# android - 如何在android中使用adb shell知道服务是否正在运行

> ID：10896629
> 
> 赞同：55
> 
> 时间：2012-06-05T11:38:36.077
> 
> 标签：android, adb

我想知道媒体播放器服务（设备启动时向 media.player 注册）是否正在使用 adb shell 运行。是否可以？

我尝试运行 ps 命令但没有成功。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2016-12-20T06:23:44.983

如前所述，`adb shell service list`将仅列出系统服务。

正如[Android Emulator: How can I get a list of services that are running 中](https://stackoverflow.com/questions/12157442/android-emulator-how-can-i-get-a-list-of-services-that-are-running)解释的那样，您可以使用以下方法查找应用程序创建的服务

```
// List all services
adb shell dumpsys activity services

// List all services containing "myservice" in its name
adb shell dumpsys activity services myservice 
```

如果它返回某些内容，则表示该服务已安装。要了解服务当前是启动还是停止，请分别查找`app=ProcessRecord(...)`或`app=null` 。

你也可以用一个简单的 Linux 风格来做

```
ps | grep myservice 
```

在你的外壳里面。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2012-06-05T13:22:32.743

试试命令行

`adb shell service list`

我也得到了服务名称及其包名称的列表。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2014-06-13T15:29:31.893

要简单地检查特定服务是否正在运行，请使用：

```
adb shell service check <service> 
```

例如，如果它正在运行，则`adb shell service check media.player`给出，否则。`Service media.player: found``Service media.player: not found`

如果您需要更多详细信息，请尝试`dumpsys <service>`. 例如，`adb shell dumpsys media.player`返回有关`media.player`的客户端、打开的文件等的信息。

最后，如果您确实需要认真的调试细节，请尝试`adb shell dumpsys activity services`从`ActivityManager`'s 的角度显示正在发生的事情。这包括有关意图、创建时间、上次活动时间、绑定等的信息。如果要存储输出以供以后查看/搜索，可以重定向输出。它通常相当长。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-12-02T18:38:08.633

要了解应用程序进程是否正在运行（后台或前台）：

```
adb shell pidof <package.name> 
```

如果进程没有运行，它将返回空字符串，否则它的 pid。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-24T17:32:18.727

对于 Android 10，列出**所有当前正在运行的**服务：

```
adb shell dumpsys activity services | grep "ServiceRecord" | awk '{print $4}' | sed 's/.$//' | sort 
```

# java - 没有使用 ant 脚本创建 Jar 文件

> ID：10896630
> 
> 赞同：0
> 
> 时间：2012-06-05T11:38:41.853
> 
> 标签：java, ant, jar

我正在尝试执行一个将编译、创建 jar 并执行的 ant 脚本。我收到“构建成功”消息。但是 jar 文件没有被创建。

我的蚂蚁文件是：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="TestAnt" basedir="." default="compile">
    <description>simple example build file</description>
    <property name="src" location="src"/>
    <property name="output" location="bin"/>
    <property name="dist" location="."/>
    <target name="compile">
        <javac includeantruntime="false"  destdir="${output}">
            <src path="${src}"/>
    <!-- <classpath refid="java"/> -->
        </javac>
    </target>
    <target name="jar" depends="compile">
        <jar jarfile="${dist}/Test.jar" basedir="${output}">
            <manifest>
                <attribute name="Main-Class" value="Test"/>
            </manifest>
        </jar>
    </target>
    <target name="run">
        <java jar="${dist}/Test.jar" fork="true"/>
    </target>
</project> 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:02:40.603

将此行更改`<project name="TestAnt" basedir="." default="compile">`为`<project name="TestAnt" basedir="." default="jar">`. 这将编译和创建 jar - 因为编译目标依赖于 jar 任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:42:12.187

你怎么称呼你的蚂蚁脚本？如果你只是这样运行 ant：

```
ant 
```

它只会编译您的文件，因为这是默认目标。要构建 jar，您必须调用`jar`目标：

```
ant jar 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T11:43:05.673

你确定，你调用的是正确的目标吗？因为您的默认目标是`compile`, not `jar`，所以如果您不提供目标，则不会创建 jar 文件。

# python - Python ctypes：带有 LPCSTR [out] 参数的原型

> ID：10896633
> 
> 赞同：2
> 
> 时间：2012-06-05T11:38:52.193
> 
> 标签：python, winapi, prototype, ctypes, user32

我目前正在进入`ctypes`模块，我正在尝试使用我已经收到[`GetWindowText`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633520%28v=vs.85%29.aspx)的句柄调用 user32 函数。这一次虽然我想更进一步并使用函数原型而不是调用函数。尽管我在将争论声明为输出参数时遇到了问题。`HWND`[`FindWindow`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499%28v=vs.85%29.aspx)`ctypes.windll.user32.GetWindowText``lpString`

我的第一次尝试是这样的：

```
GetWindowText = cfunc("GetWindowTextA",windll.user32,c_int,
                  ("hWnd",HWND,1),
                  ("lpString",LPCSTR,2),
                  ("nMaxCount",c_int,1)
                  ) 
```

（`cfunc`是我在[这里](http://www.cs.unc.edu/~gb/blog/2007/02/11/ctypes-tricks/)找到的一个小包装）

这个原型一被调用就会产生以下异常：

```
 chars,name = user32.GetWindowText(handle,255)
TypeError: c_char_p 'out' parameter must be passed as default value 
```

我认为任何输出变量都必须是一种`POINTER(...)`类型，所以我将定义更改为：

```
GetWindowText = cfunc("GetWindowTextA",windll.user32,c_int,
                      ("hWnd",HWND,1),
                      ("lpString",POINTER(c_char),2),
                      ("nMaxCount",c_int,1)
                      ) 
```

但这也会产生一个例外：

```
 chars,name = user32.GetWindowText(handle,255)
ctypes.ArgumentError: argument 2: <type 'exceptions.TypeError'>: wrong type 
```

我希望有人知道如何使用原型`GetWindowText`正确调用该函数。`ctypes`

**编辑：**

通过进一步的研究，我可以让它发挥作用，至少以某种方式。我修复的第一个问题是使用`cfunc()`了错误的调用说明符。我定义了该函数的精确副本并将其命名`winfunc()`并替换`return CFUNCTYPE(result, *atypes)((name, dll), tuple(aflags))`为`return WINFUNCTYPE(result, *atypes)((name, dll), tuple(aflags))`.

然后我进一步检查了原型设计。看起来如果你传递有点像它会在调用`("someParameter",POINTER(aType),2)`时`WINFUNCTYPE`创建一个`aType`对象并将指向该对象的指针传递给函数。在返回的元组中，您可以访问该`aType`对象。这带来了另一个问题。cstring 是一个字符数组；所以需要告诉 ctypes 创建一个`c_char array`. 这意味着类似：

```
GetWindowText = winfunc("GetWindowTextA",windll.user32,c_int,
                  ("hWnd",HWND,1),
                  ("lpString",POINTER(c_char*255),2),
                  ("nMaxCount",c_int,1)
                  ) 
```

工作得很好。但不幸的是，ctypes 现在将传递一个指向 cstring 的指针，该指针总是 255 个字符长，忽略`nMaxCount`.

在我看来，我认为没有办法让该函数与定义为输出参数的动态大小的 cstring 一起工作。唯一的可能性似乎是简单地不使用输出参数功能并将 a 定义`LPCSTR`为输入参数。然后，被调用者需要自己创建一个缓冲区`ctypes.create_string_buffer()`并将其传递给函数（就像在 C 中一样）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:20:36.133

您必须为输出参数创建一个字符串缓冲区。您可以包装该函数以使其有点透明：

```
# python3
from ctypes import *

_GetWindowText = WinDLL('user32').GetWindowTextW
_GetWindowText.argtypes = [c_void_p,c_wchar_p,c_int]
_GetWindowText.restype = c_int

def GetWindowText(h):
    b = create_unicode_buffer(255)
    _GetWindowText(h,b,255)
    return b.value

FindWindow = WinDLL('user32').FindWindowW
FindWindow.argtypes = [c_wchar_p,c_wchar_p]
FindWindow.restype = c_void_p

h = FindWindow(None,'Untitled - Notepad')
print(GetWindowText(h)) 
```

或者在这种情况下，您可以只使用[pywin32](http://sourceforge.net/projects/pywin32/)：

```
import win32gui
h = win32gui.FindWindow(None,'Untitled - Notepad')
print(win32gui.GetWindowText(h)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:03:21.733

是的。您必须为每次调用创建缓冲区。如果让函数定义来做，以后如何访问缓冲区？

您似乎还必须告诉它期待一个`c_char`带有的指针`POINTER(c_char)`，而不是简单的`c_char_p`or `LPSTR`。不知道为什么会这样。

无论如何，这应该工作：

```
from ctypes import *
from ctypes.wintypes import *

# defs

FindWindowF = WINFUNCTYPE(HWND, LPSTR, LPSTR)
FindWindow = FindWindowF(windll.user32.FindWindowA)

GetWindowTextF = WINFUNCTYPE(c_int, HWND, POINTER(c_char), c_int)
GetWindowText = GetWindowTextF(windll.user32.GetWindowTextA)

# code

text = create_string_buffer(255)

hwnd = FindWindow(None, 'Untitled - Notepad')
GetWindowText(hwnd, text, sizeof(text))

print text.value 
```

# c++ - (C++/winsock) 结构的打包替代方案

> ID：10896635
> 
> 赞同：0
> 
> 时间：2012-06-05T11:39:06.847
> 
> 标签：c++, winsock, packet

我一直使用结构来打包和接收数据包，我会通过将它们转换为从主数据包类继承的类来获得什么吗？是否有另一种“c++ish”的包装方式以及由此带来的任何性能提升？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:50:45.150

## 数据建模

通常，您的 C++ 类应考虑它们建模的数据中的冗余。因此，如果数据包共享一些共同的布局，那么您可以创建一个类来模拟该数据及其上的操作。您可能会发现派生添加其他数据成员以反映可能的数据包数据布局层次结构的类很方便，但有时让不相关的类反映数据包各部分的不同布局可能同样方便（特别是如果长度或顺序的部分消息可能会有所不同）。

为了给出一个符合您想法的最简单案例的更清晰示例 - 如果您有一个标准数据包标头，其中包含一个记录 ID、以字节为单位的记录大小和序列 ID，您可以合理地将这些字段放入一个类中，并公开派生一个每个不同记录 id 的类。基类可能具有成员函数来读取这些值，同时从网络字节顺序转换为本地字节顺序，检查序列 ID 根据需要递增等 - 派生类及其用户都可以访问所有这些值。

## 运行时多态性

不过，您应该警惕虚拟成员 - 在几乎所有实现中，它们都会在您的对象中引入虚拟调度指针，这可能会阻止它们镜像网络数据包中的数据布局。如果有理由需要运行时多态性（并且很容易，尤其是在读取数据包时），您可能会发现拥有与非多态数据布局的层次结构具有 1:1 对应关系的类的多态层次结构很有用类，并且只包含一个指向内存中数据位置的指针。

## 表现

使用带有布局的类或结构故意镜像您的网络数据包，可能会让您就地并且非常方便地操作该内存，相信编译器会创建有效的代码来执行此操作。编译器通常很擅长这一点。

该访问的*效率*（速度）应该完全*不受*用于对数据建模的类层次结构的影响。涉及的数据偏移和对非虚拟函数的调用都将在编译时解决。

如果您引入虚函数，您可能会看到性能下降，因为它们可以防止内联并需要额外的指针间接，但您应该通过考虑如何在特定于布局的操作之间切换以及您需要的频率来将其放在上下文中支持（例如，`switch (record_id)`到处使用`if (record_id == X)`，或显式函数指针）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:45:39.290

它非常通用，并且可能有各种解决方案。这与序列化主题有关，您所说的是一个简单的序列化模型，其中数据包包含可以直接加载到内存中的结构，反之亦然。我认为 C 和 C++ 在这种情况下很棒，因为它们允许您直接编写类似 struct 的东西来流式传输并轻松读取它。在其他语言中，您可以实现字节对齐，或者您应该序列化对象以便能够将它们写入流。

在某些情况下，您需要读取 XML、SOAP 等字符串流。在某些应用程序中，您应该使用结构。在某些情况下，您需要将对象序列化为流。这取决于。但我认为使用结构和指针比使用对象序列化更先进。

在您的情况下，我认为每个实体都有 2 个结构。沿线或文件移动的结构和将实体实例保存在内存中的类。如果您对对象使用二进制序列化，则可以只使用一个类来发送、接收和保存实例。

# erlang - Erlang 原子和“..”

> ID：10896638
> 
> 赞同：5
> 
> 时间：2012-06-05T11:39:12.037
> 
> 标签：erlang

这是 erlang shell 的输出：

```
1> atom.
atom
2> next_atom.
next_atom
3> atom@erlang.
atom@erlang
4> 'atom in single quotes'.
'atom in single quotes'
5> atom = 'atom'.
atom
6> a.tom.
'a.tom'
7> a..tom.
* 1: syntax error before: '..' 
```

`.`当atom中只有一个点时（第 6 行），我没有收到任何错误。但是，当有 时`..`，我得到语法错误。在 Erlang 中是否`..`有一些特殊含义，或者为什么我在`.`正常工作时会出错？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-05T11:46:54.703

原子中不允许点，但两个原子之间的点：`'foo'.'bar'`, 是一个编译时运算符，将原子连接到`'foo.bar'`.

这是一个扩展，用于支持（仍未正式支持）类 Java 包系统。这就是为什么它没有记录在案。

# wcf - 通过名单 在 WCF Rest Post 方法中

> ID：10896643
> 
> 赞同：1
> 
> 时间：2012-06-05T11:39:28.753
> 
> 标签：wcf

我正在尝试将 WCF Post 调用中的 List 作为参数传递。下面是我的代码。

```
TrackingNumbers.cs

[KnownType(typeof(List<string>))]
[DataContract]
public class TrackingNumbers
{
    [DataMember]
    public List<object> TrackingNumberList { get; set; }
}

    IService.cs

    [OperationContract]
    [WebInvoke(Method = "POST",
        RequestFormat = WebMessageFormat.Xml,
        ResponseFormat = WebMessageFormat.Xml,
        BodyStyle = WebMessageBodyStyle.Bare,
        UriTemplate = "v1/xml/GetMultipleShipmentDetails/")]
    Shipments[] XMLMultipleData(TrackingNumbers trackingNumbers); 
```

现在，当我从提琴手传递以下 XML 时

```
<TrackingNumbers xmlns="http://schemas.datacontract.org/2004/07/Chhotu.Web.Partner.API">
<TrackingNumberList>10000008871</TrackingNumberList>
<TrackingNumberList>10000008864</TrackingNumberList>
<TrackingNumberList>10000008858</TrackingNumberList>
</TrackingNumbers> 
```

没有从调试器调用 XMLMultipleData 方法。请建议我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-22T12:15:07.103

我建议您尝试更改此行

```
Shipments[] XMLMultipleData(TrackingNumbers trackingNumbers); 
```

和

```
Shipments[] XMLMultipleData(TrackingNumbers[] trackingNumbers); 
```

而你的**[DataContract]**为

```
[DataContract]
public class TrackingNumbers
{
    [DataMember]
    public int TrackingNumber{ get; set; }
} 
```

还！尝试删除`KnownType(typeof(List<string>))]`

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:04:57.810

我发现我们的代码存在一些问题：

*   不需要 [KnownType(typeof(List))]，DataContractSerializer 已经知道这个类型。
*   列表 - 不是一个好方法。如果您使用数字，为什么不将其设为 int 呢？

你确定你附身了？您可以尝试使用 Debugger.Break(); 强制附加调试器；在您的代码中处于良好位置。

# mysql - 优化mysql查询以选择值

> ID：10896647
> 
> 赞同：1
> 
> 时间：2012-06-05T11:39:50.583
> 
> 标签：mysql, sql, group-by

我有一个具有以下列名称的表：audit_name、audit_choice 和“slno”作为自动增量主键，并且对输出数据没有用处。

audit_name 可以重复，并且 audit_choice 值仅限于某些值，例如“Passed”、“Failed”。

我的查询预期输出是，获取每个“Audit_name”的“通过”计数和“失败”计数。

这是我尝试过的查询，但执行大约 1,000 条记录大约需要 3-4 分钟。

```
SELECT audit_name,
  (SELECT COUNT(*) AS Passed FROM audit AS p1
     WHERE p1.audit_name=p2.audit_name AND p1.audit_choice="Passed") AS Passed,
  (SELECT COUNT(*) AS Failed FROM audit AS p3
     WHERE p3.audit_name=p2.audit_name AND p2.audit_choice="Failed") AS Failed
  FROM audit AS p2
  GROUP BY audit_name 
```

请建议我如何优化查询。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T11:43:28.547

```
SELECT  audit_name,
        SUM(audit_choice = 'Passed') AS passed,
        SUM(audit_choice = 'Failed') AS failed
FROM    audit
GROUP BY
        audit_name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T11:44:02.090

我还建议将诸如“Passed”和“Failed”之类的字符串值移出表，并改用整数标识符 - 它们的比较速度比字符串快得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:48:57.720

```
 SELECT  audit_name,
         SUM(if(audit_choice = 'Passed',1,0)) AS passed,
         SUM(if(audit_choice = 'Failed',1,0)) AS failed
    FROM    audit
    GROUP BY
    audit_name 
```

# matlab - 如何实现具有隐藏层的神经网络？

> ID：10896649
> 
> 赞同：1
> 
> 时间：2012-06-05T03:22:56.277
> 
> 标签：matlab, machine-learning

我正在尝试训练一个可以在 MATLAB 中对二次方程进行分类的 3 个输入、1 个输出的神经网络（具有一个输入层、一个隐藏层和一个输出层）。我正在尝试实现前馈阶段，$x_i^{out}=f(s_i)$, $s_i={\sum}_{\substack{j\\}} w_{ij}x_j^{in} $ 反向传播 ${\delta}_j^{in}=f'(s_i){\sum}_{\substack{j\\}} {\delta}_i^{out}w_{ij}$ 和更新$w_{ij}^{new}=w_{ij}^{old}-\epsilon {\delta}_i^{out}x_j^{in}$，其中 $x$ 是输入向量，$w$ 是权重，$\epsilon$ 是学习率。

我在编码隐藏层和添加激活函数 $f(s)=tanh(s)$ 时遇到了麻烦，因为网络输出中的错误似乎没有减少。有人可以指出我实施的错误吗？

输入是二次 $ax^2 + bx + c = 0$ 的实系数，如果二次有两个实根，则输出应该为正，如果没有，则输出应该为负。

```
nTrain = 100; % training set
nOutput = 1;
nSecondLayer = 7; % size of hidden layer (arbitrary)
trainExamples = rand(4,nTrain); % independent random set of examples
trainExamples(4,:) = ones(1,nTrain);  % set the dummy input to be 1

T = sign(trainExamples(2,:).^2-4*trainExamples(1,:).*trainExamples(3,:)); % The teacher provides this for every example
%The student neuron starts with random weights
w1 = rand(4,nSecondLayer);
w2 = rand(nSecondLayer,nOutput);
nepochs=0;
nwrong = 1;
S1(nSecondLayer,nTrain) = 0;
S2(nOutput,nTrain) = 0; 

while( nwrong>1e-2 )  % more then some small number close to zero
    for i=1:nTrain
        x = trainExamples(:,i);
        S2(:,i) = w2'*S1(:,i);
        deltak = tanh(S2(:,i)) - T(:,i); % back propagate
        deltaj = (1-tanh(S2(:,i)).^2).*(w2*deltak); % back propagate      
        w2 = w2 - tanh(S1(:,i))*deltak'; % updating
        w1 = w1- x*deltaj'; % updating  
    end
   output = tanh(w2'*tanh(w1'*trainExamples));
   dOutput = output-T;
   nwrong = sum(abs(dOutput));
   disp(nwrong)
   nepochs = nepochs+1          
end
nepochs 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T07:16:32.010

在把我的头撞到墙上几天后，我发现了一个小错字。以下是一个有效的解决方案：

```
clear
% Set up parameters
nInput = 4; % number of nodes in input
nOutput = 1; % number of nodes in output
nHiddenLayer = 7; % number of nodes in th hidden layer
nTrain = 1000; % size of training set
epsilon = 0.01; % learning rate

% Set up the inputs: random coefficients between -1 and 1
trainExamples = 2*rand(nInput,nTrain)-1;
trainExamples(nInput,:) = ones(1,nTrain);  %set the last input to be 1

% Set up the student neurons for both hidden and the output layers
S1(nHiddenLayer,nTrain) = 0;
S2(nOutput,nTrain) = 0;

% The student neuron starts with random weights from both input and the hidden layers
w1 = rand(nInput,nHiddenLayer);
w2 = rand(nHiddenLayer+1,nOutput);

% Calculate the teacher outputs according to the quadratic formula
T = sign(trainExamples(2,:).^2-4*trainExamples(1,:).*trainExamples(3,:));

% Initialise values for looping
nEpochs = 0;
nWrong = nTrain*0.01;
Wrong = [];
Epoch = [];

while(nWrong >= (nTrain*0.01)) % as long as more than 1% of outputs are wrong
    for i=1:nTrain
        x = trainExamples(:,i);
        S1(1:nHiddenLayer,i) = w1'*x;
        S2(:,i) = w2'*[tanh(S1(:,i));1];
        delta1 = tanh(S2(:,i)) - T(:,i); % back propagate
        delta2 = (1-tanh(S1(:,i)).^2).*(w2(1:nHiddenLayer,:)*delta1); % back propagate       
        w1 = w1 - epsilon*x*delta2'; % update
        w2 = w2 - epsilon*[tanh(S1(:,i));1]*delta1'; % update
    end

    outputNN = sign(tanh(S2));
    delta = outputNN - T; % difference between student and teacher
    nWrong = sum(abs(delta/2));
    nEpochs = nEpochs + 1;
    Wrong = [Wrong nWrong];
    Epoch = [Epoch nEpochs];
end
plot(Epoch,Wrong); 
```

# c# - SOA 问题：WCF + 依赖注入

> ID：10896651
> 
> 赞同：0
> 
> 时间：2012-06-05T11:40:16.017
> 
> 标签：c#, asp.net-mvc, wcf, dependency-injection, soa

我们有以下解决方案布局：

*   数据访问
*   商业逻辑
*   WCF 服务
*   MVC

我们选择有一个 WCF 服务层，因为将来会有其他应用程序使用相同的逻辑。这被认为是 SOA。

在 DA、BL 和 WCF 层之间，我倾向于使用依赖注入，因为我想对业务逻辑等进行单元测试。

但现在我的问题是：我是否也应该对 WCF 使用依赖注入？我的意思是，我应该从应用程序（消费者）通过 WCF 服务传递依赖关系吗？我个人觉得这很奇怪，因为它对我来说不再是 SOA 了？

谁能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:48:56.373

可能会吹毛求疵，但使用服务并不一定意味着 SOA。

既然如此，为什么需要从应用程序传递依赖项？您可以在主机上编写服务，如下[所示](https://stackoverflow.com/questions/2454850/how-do-i-pass-values-to-the-constructor-on-my-wcf-service)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:51:26.497

如果您想对业务逻辑进行单元测试，您甚至可以为它们声明不同的端点并在您的单元测试中使用，这是依赖注入的替代方案。如果你真的想使用依赖注入，那么总是建议在服务级别而不是在客户端上执行它，但如果你从客户端使用它仍然没有害处。如果我愿意选择，那么我会在服务类中完成它，并且从客户端我可以获得一个参数，该参数将表明您是使用它进行单元测试还是应用程序调用了您的 WCF 服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T12:03:35.283

> 我应该通过应用程序的 WCF 服务传递依赖项吗？

我猜你的应用程序是指 WCF 服务的消费者，对吧？我相信从应用程序（MVC）你正在通过代理与服务层交谈。您不应将依赖项从使用者应用程序注入到 WCF 服务，并且您不能这样做。

但是您可以在 WCF 中使用依赖注入来注入数据/日志记录组件，以便通过创建自定义服务主机工厂在服务端本身进行更好的单元测试。

[http://prideparrot.com/blog/archive/2012/2/dependency_injection_in_wcf_using_castle_windsor](http://prideparrot.com/blog/archive/2012/2/dependency_injection_in_wcf_using_castle_windsor)

# javascript - Jquery在背景位置上动画不起作用

> ID：10896652
> 
> 赞同：1
> 
> 时间：2012-06-05T11:40:19.173
> 
> 标签：javascript, jquery

谁能告诉我为什么这个 jquery 不起作用？

我有一个这样的列表：

```
 <div id="services">
            <h1>Services</h1>
            <ul>
                <li class="menu"><a href="#">menu item1</a></li>
                <li class="menu"><a href="#">menu item2</a></li>
                <li class="menu"><a href="#">menu item3</a></li>
                <li class="menu"><a href="#">menu item4</a></li>
            </ul>
        </div> 
```

我想在悬停时从左侧滑入背景图像，并在鼠标悬停时将其反转。

下面的 jquery 代码在 moueover 或 mouseout 上没有做任何事情。我在这里想念什么？

```
$(function(){       
    $('li.menu a').css( {backgroundPosition: "-416px 0"})
    .mouseover(function(){
        $(this).stop().animate({backgroundPosition:"(0px 0px)"}, 500)
    })
    .mouseout(function(){
        $(this).stop().animate({backgroundPosition:"(-416px 0)"}, 500)
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:41:09.880

### 您不能为背景位置设置动画，您可以执行以下操作：

```
$('li.menu a').css({
    opacity: 0.5,
    marginLeft: "-5px"
});

$('li.menu a').mouseover(function() {
    $(this).stop().animate({
        marginLeft: "0px",
        opacity: 1
    }, 500)
}).mouseout(function() {
    $(this).stop().animate({
        marginLeft: "-5px",
        opacity: 0.5
    }, 500)
}); 
```

**[只是一个演示](http://jsfiddle.net/thecodeparadox/QStkd/146/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:14:52.403

你很幸运:) 我昨天遇到了同样的问题。我看到你和我一样，只需要 X 轴上的动画。

因此，您需要做的就是将单个参数传递给 backgroundPosition，这是 X 轴的默认值。还传递 int，这是像素的默认值。

```
$('li.menu a').css({
     backgroundPosition: -416
}).mouseover(function(){
     $(this).stop().animate({backgroundPosition: 0}, 500)
}).mouseout(function(){
     $(this).stop().animate({backgroundPosition: -416}, 500)
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T11:53:30.520

看起来你不能没有[插件](http://www.protofunc.com/scripts/jquery/backgroundPosition/)来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T12:06:02.137

试试这个，

```
$('li.menu a').css({background-position-x:"-416px",background-position-y:"0"}); 

$('li.menu a').mouseover(function(){
    $(this).stop().animate({background-position-x:"0",background-position-y:"0"}, 500)
})
.mouseout(function(){
    $(this).stop().animate({background-position-x:"-416px",background-position-y:"0"}, 500)
}); 
```

# c# - 在 Windows 应用程序中创建序列消息文本

> ID：10896654
> 
> 赞同：1
> 
> 时间：2012-06-05T11:40:20.207
> 
> 标签：c#

我想在程序运行时使用文本框创建一系列消息。我正在创建一个 Windows 应用程序来从数据表中读取数据并存储到数据库表中。那时我使用多行文本框来显示连续消息。但我不能这样做。该过程结束时显示的消息完成..

请帮我这样做..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:42:10.440

您需要在后台线程上运行代码，以便 UI 能够更新。

使用`BackgroundWorker`类及其进度报告功能。

# ios - 单击注释视图时无法推送新视图

> ID：10896656
> 
> 赞同：0
> 
> 时间：2012-06-05T11:40:25.507
> 
> 标签：ios, mkmapview, mkannotation, mkmapviewdelegate

在我的 iphone 应用程序中，我有一个带有视图和 MKMapView 的控制器。
我在地图上显示了几个注释，但是当我单击注释视图时，“calloutAccessoryControlTapped”被触发，但我无法推送新视图。
self.navigationView 为空……最好的方法是什么？我是否需要在 MKMapView 之上创建一个导航控制器？

```
-(void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view calloutAccessoryControlTapped:(UIControl *)control
{
  NSLog(@"annotation clicked"); // => OK
  if ([control isKindOfClass:[UIButton class]]) {
    NSLog(@"annotation clicked 2"); // => OK

    // Get annotation as some stuff needs to be passed to the new view
    MyAnnotation *annotation = (MyAnnotation*)view.annotation;        

    ControlViewController *controlViewController = [[ControlViewController alloc] initWithNibName:@"ControlViewController" bundle:nil];
    controlViewController.thing = annotation.thing;

    NSLog(@"self.navigationController:%@", self.navigationController);  // => null

    // [self.navigationController pushViewController:controlViewController animated:YES];
    [controlViewController release];
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:42:09.950

是的，您的视图控制器需要位于`UINavigationController`. 检查[文档](https://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewControllerPGforiOSLegacy/NavigationControllers/NavigationControllers.html)以了解如何操作。

# c# - 程序几秒钟无响应

> ID：10896662
> 
> 赞同：0
> 
> 时间：2012-06-05T11:40:58.197
> 
> 标签：c#

我找到了一种`Print Screen`在 C# 中捕获按钮的方法。当按下`Alt + Print Screen`一个简单的消息框时，会弹出一个说按键已被按下的消息。**但**它在几秒钟后没有反应。我不知道为什么会这样。

这是我使用的代码：

```
static class Program
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        _hookID = SetHook(_proc);
        Application.Run(new Form1());
        UnhookWindowsHookEx(_hookID);  
    }

    /****************************************/
    private const int WH_KEYBOARD_LL = 13;
    //private const int WH_KEYBOARD_LL = 13;  
    private const int WM_KEYDOWN = 0x0100;
    private const int VK_F1 = 0x70;
    private static LowLevelKeyboardProc _proc = HookCallback;
    private static IntPtr _hookID = IntPtr.Zero;

    private static IntPtr SetHook(LowLevelKeyboardProc proc)
    {
        using (Process curProcess = Process.GetCurrentProcess())
        using (ProcessModule curModule = curProcess.MainModule)
        {
            return SetWindowsHookEx(WH_KEYBOARD_LL, proc,
                GetModuleHandle(curModule.ModuleName), 0);
        }
    }

    private delegate IntPtr LowLevelKeyboardProc(
        int nCode, IntPtr wParam, IntPtr lParam);

    private static IntPtr HookCallback(
        int nCode, IntPtr wParam, IntPtr lParam)
    {

        if (nCode >= 0)
        {
            Keys number = (Keys)Marshal.ReadInt32(lParam);
            if (number == Keys.PrintScreen)
            {
                if ((wParam == (IntPtr)260 && Keys.Alt == Control.ModifierKeys && number == Keys.PrintScreen))
                {
                    MessageBox.Show("You pressed alt+ print screen");
                }
            }

        }
        return CallNextHookEx(IntPtr.Zero, nCode, wParam, lParam);

    }

    [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr SetWindowsHookEx(int idHook,
        LowLevelKeyboardProc lpfn, IntPtr hMod, uint dwThreadId);

    [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool UnhookWindowsHookEx(IntPtr hhk);

    [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr CallNextHookEx(IntPtr hhk, int nCode,
        IntPtr wParam, IntPtr lParam);

    [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr GetModuleHandle(string lpModuleName); 
} 
```

有谁知道为什么它在消息框之后挂起？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:45:55.990

在钩子回调完成执行之前，Windows 无法发送下一个键盘消息。显然您*不想*使用 MessageBox.Show()，它会阻止回调。Windows 在宣布您的代码损坏并禁用挂钩之前会忍受几秒钟。

请改用 Debug.Print()。

# cuda - CUDA 内核仅由单个线程执行语句

> ID：10896669
> 
> 赞同：2
> 
> 时间：2012-06-05T11:41:15.047
> 
> 标签：cuda, gpgpu, gpu

如何在我的 CUDA 内核中编写由单线程执行的语句。例如，如果我有以下内核：

```
__global__ void Kernel(bool *d_over, bool *d_update_flag_threads, int no_nodes)
{
   int tid = blockIdx.x*blockDim.x + threadIdx.x;
   if( tid<no_nodes && d_update_flag_threads[tid])
   {
     ...
     *d_over=true; // writing a single memory location, only 1 thread should do?
     ...
   }
} 
```

在上面的内核中，“d_over”是一个布尔标志，而“d_update_flag_threads”是一个布尔数组。

我之前通常做的是使用线程块中的第一个线程，例如：

```
if(threadIdx.x==0) 
```

但在这种情况下它无法工作，因为我在这里有一个标志数组，只有带有关联标志“true”的线程才会执行 if 语句。该标志数组是由之前调用的另一个 CUDA 内核设置的，我事先对此一无所知。

简而言之，我需要类似于 OpenMP 中的“Single”构造的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T14:10:51.317

一种可能的方法是使用原子操作。如果每个块只需要一个线程来执行更新，则可以在共享内存中执行原子操作（计算能力 >= 1.2），这通常比在全局内存中执行要快得多。

说了这么多，思路如下：

```
int tid = blockIdx.x*blockDim.x + threadIdx.x;

__shared__ int sFlag;
// initialize flag
if (threadIdx.x == 0) sFlag = 0;
__syncthreads();

if( tid<no_nodes && d_update_flag_threads[tid])
{
  // safely update the flag
  int singleFlag = atomicAdd(&sFlag, 1);
  // custom single operation
  if ( singleFlag == 0) 
      *d_over=true; // writing a single memory location, only 1 thread will do it
       ...
} 
```

这只是一个想法。我没有测试过它，但它接近于由单个线程执行的操作，而不是块的第一个线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T23:47:13.023

您可以使用 atomicCAS(d_over, 0, 1) ，其中 d_over 被声明或类型转换为 int*。这将确保只有第一个看到 d_over 值为 0（假）的线程会更新它，而其他人不会。

# php - 具有 1 个字段输入验证的 PHP-MySQL 表单

> ID：10896671
> 
> 赞同：0
> 
> 时间：2012-06-05T11:41:16.920
> 
> 标签：php, mysql

在 PHP 中有一个简单的表单，其中包含 1 个字段，必须对其进行验证，并且从两侧剥离其字符串。从字符串中，我保留某些字符并希望匹配这个剥离的字符串是否在 mysql DB 中。如果它存在于数据库中，那么我将字符串输入数据库到另一个表，如果不存在，我将其丢弃。

问题是目前我输入的所有内容都由 if 语句验证为 true 并插入到数据库中。它只需要在 if 语句为真时插入，而不是每次都插入。我让它在没有剥离字符串的情况下工作，但是当我从垃圾中剥离字符串时，我无法让它再次工作......

**这是带有字符串条的代码，它验证所有内容为真**

```
 ...
    $txt=substr($_POST[ZZ_ID],12,-1);

    $test = mysql_query("SELECT ZZcode FROM ZZcodes WHERE ZZcode='$txt'");
    $row = mysql_fetch_array($test);

    if ($row['ZZcode']== $txt)         
    $sql="INSERT INTO Data
    VALUES
    ('$_POST[ZZ_ID]','$_POST[ID]', TIMESTAMP(8))";
    else
            echo "ZZ code error";
            echo "<br />";
            echo $txt;
     if (!mysql_query($sql,$con))
     {
      die('Error: ' . mysql_error());
              }
    mysql_close($con)
    ... 
```

**这是没有字符串条的代码块，它有效：**

```
 ...
    $test = mysql_query("SELECT ZZcode FROM ZZcodes WHERE ZZcode='$_POST[ZZ_ID]'");
    $row = mysql_fetch_array($test);

    if ($row['ZZcode']== $_POST[ZZ_ID])
    $sql="INSERT INTO Data
    VALUES
    ('$_POST[ZZ_ID]','$_POST[ID]', TIMESTAMP(8))";
    else
            echo "ZZ koodi ei saa sisestada";
            echo "<br />";
     if (!mysql_query($sql,$con))
     {
      die('Error: ' . mysql_error());
              }
    mysql_close($con)
    ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T13:17:26.827

就`var_dump($_POST[ZZ_ID])`在你设置之前`$txt=substr($_POST[ZZ_ID],12,-1);`

然后`var_dump($txt)`。

我认为该`substr()`功能是您的问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T13:38:04.763

如果您想比较字符串，我建议您使用字符串比较函数，例如 strcmp。要了解有关 strcmp 的更多信息，请访问[strcmp - PHP 手册](http://php.net/manual/en/function.strcmp.php)。

如果两个字符串相等，此函数将返回 0。此比较区分大小写。

# c# - 为什么绑定后DependencyProperty为空？

> ID：10896676
> 
> 赞同：1
> 
> 时间：2012-06-05T11:41:46.550
> 
> 标签：c#, wpf, binding, initialization, dependency-properties

绑定`ReportSettings`到之后，`SettingsProperty`我希望能够`ReportSettings`通过该`Settings`属性进行访问。当我尝试这样做时，我得到一个`NullReferenceException`. 有谁可以帮我离开这里吗？

`ReportSettings`是一个实现的类`INotifyPropertyChanged`。

```
public MyWindow() {
    InitializeComponent();
    // Load default template
    string defaultTemplateName = "default";
    foreach (var reportSettings in SettingsCache.Instance.AllReportSettings) {
        if (reportSettings.TemplateName.Equals(defaultTemplateName, StringComparison.CurrentCultureIgnoreCase)) {
            var binding = new Binding("SettingsProperty") { Source = reportSettings };
            SetBinding(SettingsProperty, binding);
            var testDirect = reportSettings.IsVisible; // OK
            var testDepProp = Settings.IsVisible; // NullReferenceException!!!
            //...
        }
    }
}

public ReportSettings Settings {
    get { return (ReportSettings)GetValue(SettingsProperty); }
    set { SetValue(SettingsProperty, value); }
}

public static readonly DependencyProperty SettingsProperty = DependencyProperty.Register(
        "Settings", typeof(ReportSettings), typeof(MyWindow),
        new PropertyMetadata(null, OnSettingsChanged)); 
```

更新：在这个例子中我可以只使用局部变量，但这个例子只是为了简单地说明问题。问题确实发生在构造之后，我访问了未初始化的“设置”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:16:12.003

这是因为数据绑定是在较低优先级的线程上异步执行的。因此，在您连接绑定之后，您的代码将在绑定实际更新值之前继续执行，因此它仍然是`null`.

您可以只使用本地`reportSettings`值（如您发现的那样），也可以`Dispatcher.Invoke()`使用`DispatcherPriority`低于`DispatcherPriority.DataBind`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T19:00:14.793

我的一个同事帮了我。这只是装订中的一个基本错误。这解决了这个问题：

`var binding = new Binding() { Source = reportSettings };`

# php - 用 PHP 拆分 stdclass

> ID：10896678
> 
> 赞同：1
> 
> 时间：2012-06-05T11:41:53.863
> 
> 标签：php, json, stdclass

我正在尝试访问具有属性 #text 的 StdClass 的一部分。PHP 使用“#”作为注释，所以我无法让 PHP 将其解析为注释。StdClass 的示例如下

`stdClass Object ( [artist] => stdClass Object ( [name] => John Denver [mbid] => 34e10b51-b5c6-4bc1-b70e-f05f141eda1e [url] => http://www.last.fm/music/John+Denver [image] => Array ( [0] => stdClass Object ( [#text] => http://userserve-ak.last.fm/serve/34/521025.jpg [size] => small`

我尝试通过以下方式访问它：

```
$json->artist->image[0]->#text 
```

但是我怎样才能逃避'#'或告诉php以不同的方式解释它。或者是否有另一种格式来查找 #text 属性。

我也试过：

```
$json['artist']['image'][0]['#text'] 
```

但我得到一个错误。我敢肯定这很简单，但此刻它真的让我着迷。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T11:44:23.953

您可以使用以下代码访问此类属性：

```
$object->{'#text'} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T22:28:31.290

引用另一个答案，您可以将密钥放入变量中并通过此变量访问它。

`$var='myvarwithstrangecharacters$asdfas#';`

`$object->$var;//do whatever you want`

来自： [如何访问具有美元符号的 PHP 对象属性？](https://stackoverflow.com/questions/2093169/how-do-i-access-a-php-object-attribute-having-a-dollar-sign)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T11:47:44.453

好像是json数据，所以解码的时候，也可以设置第二个参数为true：

```
$json = json_decode($input, true); 
```

现在您可以使用它：

```
$json['artist']['image'][0]['#text'] 
```

# c - 如何在共享对象库中共享变量

> ID：10896679
> 
> 赞同：5
> 
> 时间：2012-06-05T11:42:01.260
> 
> 标签：c, linux, gcc, shared-objects

我正在创建一个共享对象库，它将与我的程序一起进行 LD_PRELOAD。在那个共享库中，我还想使用我程序中的一些变量。声明这些变量的方式是什么。请注意，共享对象库是与我的程序分开编译的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T13:57:20.323

是的。您必须链接您的程序`--export-dynamic`以使打开的库可以访问程序的符号表。如果您希望准确控制哪些符号可用并`libtool`用于链接，您可以使用参数`-export-symbols-regex`来指定哪些可用。如果程序加载时库所需的符号不可用，它将因未定义的符号而失败。某些平台需要稍微不同的链接标志（尤其是 Windows）。`libtool`如果您还没有，请考虑使用它来简化此操作。

# php - PHP 中的 OpenFire 在线/离线用户

> ID：10896680
> 
> 赞同：3
> 
> 时间：2012-06-05T11:42:03.503
> 
> 标签：php, mysql, xmpp, openfire

我有一个 OpenFire 服务器正在运行（它使用 MySQL 作为它的数据库），我正在尝试使 PHP http 预绑定系统（使用 SASL）与我的 web 应用程序一起工作。

我必须在我的应用程序的一部分中选择一个尚未在线的随机用户名（对于来宾用户）。我正在考虑选择一些随机用户（在我创建的来宾组中）并使用 Presence Service 插件检查他们的在线状态，直到找到可用的用户（离线用户）。

有没有更好的方法来获取离线/在线用户列表？

服务器是否将用户的在线状态存储在数据库中？我一直在寻找 OpenFire 数据库，但我无法弄清楚。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T12:12:10.407

我为 Openfire 编写了一个小插件（借助其他一些非常简单的插件，我可以插入而无需深入研究 Openfire API 文档），它基本上会在线输出一个 JSON 编码的用户列表。然后我可以抓住它并运行 json_decode 并循环遍历数组。我目前找不到来源，但似乎其他人也这样做了：

[http://community.igniterealtime.org/thread/45107](http://community.igniterealtime.org/thread/45107)

编辑：

我注意到上面帖子中链接的 Github 项目现在已经消失了，但我会尝试联系他们，看看他们是否仍然拥有它。

另一个编辑：

链接到 Github 存储库：[https ://github.com/candy-chat/onlineUsersPlugin](https://github.com/candy-chat/onlineUsersPlugin)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:16:01.463

在用户名册中，您可以获取在线和离线用户。您还可以从名册中获取在线用户的状态消息。

但为此，您必须订阅该用户的存在。仅在名册中添加该用户是不够的，您必须订阅该用户的存在，然后您才能获得其他用户的存在。

# javascript - 如何在不使用 JSON.stringify 的情况下将 JSON 转换为字符串？

> ID：10896685
> 
> 赞同：0
> 
> 时间：2012-06-05T11:42:16.447
> 
> 标签：javascript, json, codemirror

我有一个 JSON 对象，我想在代码镜像中显示它。代码镜像只需要字符串。当我做 JSON.stringify 它搞砸了它是一个数组而不是字符串的值。

例如。这是 JSON.stringify 的输出

```
{
     "version": "1.1",
     "sid": "ManagementService",
     "svcVersion": "0.1",
     "oid": "getCurrentStatsForServiceTypes",
     "params": {
          "serviceTypes": "[\"rest\", \"wsdl\", \"database\", \"rss\"]"
     }
} 
```

我想要输出为...

```
{
  "version": "1.1",
    "sid": "ManagementService",
    "svcVersion": "0.1",
    "oid": "getCurrentStatsForServiceTypes",
    "params": {
      "serviceTypes":["rest", "wsdl", "database","rss"]
    }
} 
```

简而言之，我想在不影响值的情况下将 Type 从 Object 转换为 String。

更新：JSON 对象是

```
{
  "version": "1.1",
    "sid": "ManagementService",
    "svcVersion": "0.1",
    "oid": "getCurrentStatsForServiceTypes",
    "params": {
      "serviceTypes":["rest", "wsdl", "database","rss"]
    }
} 
```

我想要和字符串一样。像这样的东西应该工作。

```
'{
  "version": "1.1",
    "sid": "ManagementService",
    "svcVersion": "0.1",
    "oid": "getCurrentStatsForServiceTypes",
    "params": {
      "serviceTypes":["rest", "wsdl", "database","rss"]
    }
}' 
```

> 块引用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:49:00.040

如果您的`serviceTypes`参数是一个数组，它应该在您指示您希望它序列化时进行序列化。我有一种感觉，您在该属性中放置了一个字符串，而不是一个数组。

当我将您的对象文字字符串化时，我得到

```
"{"version":"1.1","sid":"ManagementService","svcVersion":"0.1","oid":"getCurrentStatsForServiceTypes","params":{"serviceTypes":["rest","wsdl","database","rss"]}}" 
```

数组没有转义，它是一个数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:52:55.483

看来您的 serviceTypes 不是数组，而是对象中的一个字符串。尝试这个：

```
obj.params.serviceTypes = JSON.parse(obj.params.serviceTypes);
return JSON.stringify(obj); 
```

# windows - 当我的角色 Azure VM 被回收时，其他一些 Azure 角色能否读取我的角色留下的未擦除磁盘数据？

> ID：10896686
> 
> 赞同：3
> 
> 时间：2012-06-05T11:42:21.533
> 
> 标签：windows, security, azure, cloud

假设我的 Azure 角色在 VM 本地磁盘上存储了一些数据，然后被终止。本地磁盘被映射到某个物理存储，因此存储在本地磁盘上的数据被写入该存储。当我的角色终止时，VM 被回收并且物理存储也被回收。

现在启动了一些其他角色，并且它的本地磁盘恰好映射到与我的角色使用的相同的物理存储上。我很清楚[新本地磁盘的逻辑结构已完全重建，我的角色可能留下的所有文件都将消失](https://stackoverflow.com/questions/6214350/is-azure-role-local-storage-guaranteed-to-be-inaccessible-to-an-application-that)。但是，新创建的逻辑磁盘下的物理存储恰好是相同的。

具体假设新角色创建一个空文件，然后调用[SetEndOfFile()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365531%28v=vs.85%29.aspx)来“扩展”该文件，然后打开它进行读取，并读取当前存储在逻辑磁盘上的数据。除非在 Azure 基础结构中采取特殊措施，否则我不确定这是否会导致文件扩展到我的角色存储的数据并读取该数据。

新角色在技术上是否可以读取我的角色写入的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:56:58.320

The short answer is no,

All I/O requests from the guest os are handled by the hypervisor, the hypervisor ensures that an insance can only access the assigned storage.

The only way to get access to data from old roles is to get physical access in the containers and grab it from there (if you ever succeed to get passed the datacenters physical security measures and into the sealed containers.) And even then it's not going to be easy as it's my understanding that logical disks do not map one-to-one to individual physical drives, but to clusters of drives, so physically your data will be dispersed across several disks as well.

Furthermore there are also offical disposal procedures in place that ensure that all data is removed from disks that are being disposed of.

Kind regards, Yves

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T04:17:05.107

+1 给@Yves，是的，答案是否定的。

我想添加更多关于如何在任何 Windows Azure VM 中创建和使用虚拟驱动器的信息。您可能已经知道，每个角色（Web 或 Worker）中至少有 3 个虚拟驱动器：

*   Drive E：是应用程序驱动器，1GB 固定大小，由 FC 使用用户更新的 Package 动态创建。此驱动器并非设计用于包含任何用户数据。此驱动器是按用户部署创建的，因此对于每个角色来说都是新的。此驱动器由 FC 提供给 Azure 虚拟机，并在预配期间附加到 VM。

*   驱动器 D：是附加到角色的操作系统/系统驱动器（大约 25GB 大小），并且与每个角色相同，取决​​于操作系统版本。这仅适用于 Web 角色，但启动任务和工作角色可以写入它。该驱动器是专用的操作系统驱动器，并认为用户不应将其任何内容放在其上。

*   驱动器 C：是用户数据所在的用户驱动器。当您的应用程序中有本地存储时，将在此处创建存储。此驱动器是根据角色 VM 大小虚拟创建的。
    *   在 Windows Azure 主机上，您可以创建小型 VM 或超大型 VM，因此取决于您的角色大小，您的 VM 将获得 ~250GB C 驱动器或 2TB C 驱动器，并且此存储是从主机获取的。
    *   在主机上，连接了一堆磁盘以提供大的逻辑空间来满足从小型到大型 VM 大小的本地存储需求。配置角色 VM 时，取决于在 Host 上创建什么样的角色 VM，从总逻辑空间创建一个虚拟 HDD，并作为用户驱动器附加到 VM。

当有任何来宾操作系统更新或 Azure 应用程序更新时：

*   更新发生在 Drive D: through Diff image
*   更新发生在 Drive E：通过 Diff Image
*   由于驱动器 C 是用户驱动器，并且“本地存储”不受来宾更新或角色更新的直接影响，但是如果设置了“本地存储 - 角色回收时清理”属性，则本地存储将在角色被回收时被清理。

那么，当您从 Azure 中删除应用程序时会发生什么：

*   OS Drive D:/Diff 驱动器被丢弃
*   Application Drive E:/Diff 驱动器也被丢弃
*   用户驱动器 C: 被移除并且空间被主机收回。
    *   现在，当在主机上创建一个新 VM 时，会创建一个新的用户驱动器 C：并从可用物理空间分配空间，它可以是从 ~250GB 到 ~2TB 的任何大小，具体取决于角色 VM 大小。
    *   即使下次在主机上配置超大客户 VM（需要最大大小为 2TB 的虚拟磁盘）时，VHD 也会重新从头开始重建。所以 XLarge VM 的背靠背 2TB 虚拟磁盘仍然不一样。
    *   因此，即使您使用上面问题中提到的文件系统 API，您的旧文件也不可能从以前的磁盘中恢复。

（抱歉写了大篇幅）

# memory-management - 内存泄漏对其他进程的影响

> ID：10896690
> 
> 赞同：1
> 
> 时间：2012-06-05T11:42:48.423
> 
> 标签：memory-management, memory-leaks

我有一个与内存泄漏有关的查询。

一个基于 32 位 Linux 的系统正在运行多个活动进程 A、B、C、D。所有进程都在从堆中分配/释放内存。现在，如果进程 A 持续泄漏大量内存，是否会在一定时间后进程 B 无法从堆中找到任何要分配的内存？

据我了解，每个进程都从操作系统提供了一个 2GB 的唯一 VM。但是在虚拟机和物理内存之间有一个映射猪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:01:07.423

是的，如果进程 A 耗尽了 VM 的总量（RAM + 交换空间），那么`malloc`任何其他进程都可能因此而失败。Linux 对其他进程隐藏进程的内存空间，但它不会神奇地在您的机器中创建额外的内存。[（尽管由于它的过度](http://opsmonkey.blogspot.nl/2007/01/linux-memory-overcommit.html)使用行为，它似乎会这样做。）

此外，当内存不足时，Linux 可能会使用其 OOM 杀手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:09:46.630

Linux 内核默认会过度使用内存。当进程使用 malloc() 请求内存段时，不会自动分配内存。您可能有 4 个进程 malloc() 每个 2gb 并且没有任何问题。当进程使用（初始化、bzero、复制）malloc()ed 内存时，就会出现问题。您甚至可以 malloc 比系统为您保留的内存更多，没有任何问题，而且 malloc() 甚至不返回 NULL！

# jquery - 在等高列中定位元素

> ID：10896692
> 
> 赞同：0
> 
> 时间：2012-06-05T11:42:58.180
> 
> 标签：jquery, css

这是 jsFinder 链接：http: [//jsfiddle.net/florian53/Wpwft/7/](http://jsfiddle.net/florian53/Wpwft/7/)

在这 3 列中，需要在所有 3 个图标上方包含 24 px 垂直填充，以便文本不会靠近图标顶部。你有什么想法如何使这成为可能，保持列的高度相等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:56:26.483

看到这个

[http://jsfiddle.net/Wpwft/8/](http://jsfiddle.net/Wpwft/8/)

```
.span3 {
    width: 156px;
    display:table-cell;
    border:1px solid red;
} 
```

只**`display:table-cell`** 在 span3 类中使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:32:17.853

看看[这里](http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks)简单而整洁的唯一 css 解决方案。然后，您需要做的就是将您的图标放置在容器的底部。

编辑：

我刚刚在上面提到的教程中发现了一个问题。如果我不`overflow:hidden`从文本中删除规则，`container3`则不会显示。我还在努力。

# c# - 如何使用 C# 在 xslt 转换中传递和获取基于字符串的 xml 数据？

> ID：10896696
> 
> 赞同：0
> 
> 时间：2012-06-05T11:43:18.610
> 
> 标签：c#, xml, c#-4.0

我想使用 xslt.here 将一个 xml 文件转换为另一个 xml 文件，我可以将输入文档传递给 XPathDocument，还可以通过将 outfile 传递给 XmlTextWriter 将输出文件保存在磁盘中。

但现在我的问题是......我的输入是字符串格式，我也希望输出为字符串。我不想传递输入文件的位置，而是传递包含 xml 数据的字符串。

所以我必须以某种方式将字符串对象传递给 xpathDoccument 并将生成的 xml 文件作为字符串获取。而不是将输出保存为文件，我希望输出为字符串。

```
 XPathDocument xpathDoc = new XPathDocument("C:\\InputXml.xml");
            XslCompiledTransform xslt = new XslCompiledTransform();

            string xsltFile = "C:\\conversion.xslt";
            xslt.Load(xsltFile);

            string outputFile = "C:\\myHtml.html";
            XmlTextWriter writer = new XmlTextWriter(outputFile, null);
            xslt.Transform(xpathDoc, null, writer);
            writer.Close(); 
```

请指导我摆脱这个问题......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:47:33.110

XPathDocument 接受`TextReader`. 您可以将流作为`new XPathDocument(new StringReader(xmlstring))`. 同样`XmlTextWriter`接受`TextWriter`。所以你可以通过一个`StringWriter`.

**- 编辑 -**

```
var sw = new StringWriter();
XmlTextWriter writer = new XmlTextWriter(sw);
xslt.Transform(xpathDoc, null, writer);
var str= sw.ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T11:49:34.273

尝试这个，

```
XslTransform  xTrans = new XslTransform();
xTrans.Load(nodeXsltPath);    //xsl file path
XmlDocument input= new XmlDocument();
XmlDocument output= new XmlDocument();
input.LoadXml(xmlString); /* Xml string to be loaaded */                        
output.Load(xTrans.Transform(input,null,new XmlUrlResolver()));
output.Save(filePathtoSave); 
```

# postgresql - PostgreSQL 中的 MongoDB Capped 集合等价物

> ID：10896699
> 
> 赞同：9
> 
> 时间：2012-06-05T11:43:25.503
> 
> 标签：postgresql, mongodb, database-replication

MongoDB capped collections 的基本原理是它们允许您设置表的最大大小，当达到大小限制时系统将清除旧数据。

有没有人在 PostgreSQL 中提出类似的设置并在生产中使用它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-11-03T21:26:07.153

这是一个简单的解决方案，例如数据大小不太大且性能要求不太苛刻的情况。

首先，让我们创建我们的表。我们将有一个 id 列和一个 data 列，但是您可以拥有您特定情况所需的任何列。

```
CREATE TABLE capped_collection (
  id integer NOT NULL,
  data text); 
```

现在，我们为我们的主键创建一个序列，将 设置`MAXVALUE`为我们的上限集合的所需大小，并使用该`CYCLE`选项，以便该序列将计数到`MAXVALUE`1，然后从 1 重新开始。

```
CREATE SEQUENCE capped_collection_id_seq
  START WITH 1
  INCREMENT BY 1
  MINVALUE 1
  MAXVALUE 10000
  CACHE 1
  CYCLE
  OWNED BY capped_collection.id; 
```

在下一步中（此处未显示），您应该使用`MAXVALUE`记录预先设置表。我们这样做是为了让每个 id 值都有一行，我们不必担心决定是执行 INSERT 还是 UPDATE 操作，只是为了保持简单和高性能。

现在我们的表已经设置好了，每当我们想要插入一个新行时，我们都会像这样执行 UPDATE

```
UPDATE capped_collection
SET data = 'your data here'
WHERE id = (SELECT nextval('capped_collection_id_seq')) 
```

该`nextval`命令为我们提供了下一个 id，并且因为我们指定`CYCLE`它一旦到达 就会回绕回 1 `MAXVALUE`。最终结果是您将永远只有`MAXVALUE`表中的行，最旧的条目被老化。

（来自[http://www.rigelgroupllc.com/blog/2014/10/14/capped-collections-in-postgres/](http://www.rigelgroupllc.com/blog/2014/10/14/capped-collections-in-postgres/)）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-10T15:14:02.827

没听说过这样的事。我想您可以使用以下方法模拟上限表大小或循环队列：

*   上插
*   和一个序列上的模运算符（有关 如何进行合并/更新插入的说明，请参阅[插入，关于 PostgreSQL 中的重复更新？ ）](https://stackoverflow.com/questions/1109061/insert-on-duplicate-update-postgresql)

特别有趣（从我的角度来看）是牛的反应（即看不被接受的答案）。

通过向表中引入一个列来表示“集合”的索引和列的序列，每个 upsert 可以基于条件：

```
where index = (sequence.nextval % max collection size) 
```

# linux - 如何恢复到make menuconfig的默认设置

> ID：10896707
> 
> 赞同：1
> 
> 时间：2012-06-05T11:44:04.353
> 
> 标签：linux, embedded

我正在使用 ridgerun sdk ..我通过命令“make menuconfig”在配置文件中进行了一些设置（但现在我不记得我做了什么设置）。现在我想取消配置文件中的那些设置并想要默认设置。但是 Ridgerun sdk 不支持命令“make mrproper”。请为此提出一些解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:39:59.837

之前的配置文件被重命名为`.config.old`Just copy it over the newer

```
cp .config.old .config 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:30:43.333

假设 RidgeRun SDK 使用 Linux 内核的 kbuild 的一些衍生版本，然后删除（当然，请务必先备份它！）构建系统根文件夹中的 .config 文件就可以解决问题。

# php - PHPExcel在一个单元格中使用两种颜色

> ID：10896710
> 
> 赞同：3
> 
> 时间：2012-06-05T11:44:12.993
> 
> 标签：php, phpexcel

我想在**PHPExcel**上的单元格中添加一种以上的颜色。

现在我用这个添加单元格：

```
$objPHPExcel->setActiveSheetIndex(0)->setCellValue("A1", $text); 
```

找到了这个，但不起作用：

```
$RichText = new PHPExcel_RichText(); 
```

可能很简单，只是我没找到。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T12:44:57.663

查看描述富文本的开发人员文档的第 4.6.37 节，以及 /Tests 中演示在单元格中使用富文本的 05featuredemo.inc.php 示例

```
$objRichText = new PHPExcel_RichText();
$run1 = $objRichText->createTextRun('RED ');
$run1->getFont()->setColor( new PHPExcel_Style_Color( PHPExcel_Style_Color::COLOR_RED ) );

$run2 = $objRichText->createTextRun('BLUE ');
$run2->getFont()->setColor( new PHPExcel_Style_Color( PHPExcel_Style_Color::COLOR_BLUE ) );

$objPHPExcel->setActiveSheetIndex(0)->setCellValue("A1", $objRichText); 
```

# javascript - 如何在异步函数中使用数组值

> ID：10896712
> 
> 赞同：0
> 
> 时间：2012-06-05T11:44:23.727
> 
> 标签：javascript, asynchronous, iteration

我有一个数组，我想将其值用作异步函数的输入。但是当我遍历我的数组并将它们发送到异步函数时，对异步函数的所有调用似乎都是由数组中的最后一个值完成的。

我以为这种问题是通过回调解决的，但该函数是我正在使用的一个库，它不提供任何回调。我应该怎么做才能让异步函数处理所有单独的数组值？

```
var libraryName = new Library("#div");

$.post("myfile.php", {somedata}, function(data){
    console.log(data); //prints all correct values
    for(i in data){
        libraryName.asynchronousFunction({
            name: data[i].name // <--this value only becomes the last value in the data-array for all calls
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:29:58.983

由于闭包，请尝试这样的事情：

```
$.post("myfile.php", {somedata}, function(data){
    console.log(data); //prints all correct values
    for(i in data){
        (function(elem) {
            libraryName.asynchronousFunction(
                {name: elem.name}
            );
        })(data[i]);
    }
}); 
```

# c# - 死锁 DbContext 并发事务

> ID：10896714
> 
> 赞同：0
> 
> 时间：2012-06-05T11:44:24.250
> 
> 标签：c#, sql-server-2008, entity-framework-4.1

![在此处输入图像描述](../Images/587f8f8952859b29b4414f2bad883150.png)

嗨，请参阅上图中的死锁图部分。我有两个事务更新同一个表，其中一个是更新该表（同一行）5 次的长事务，但另一个事务只更新该表一次并且很小两个数据库命中的事务。从死锁图中，这两个事务在不同的行上都有 X 锁并试图获得 U 锁，这在逻辑上是正确的。我不明白为什么较短的事务虽然还没有触发更新查询但会获得 X 锁（因为它是导致死锁的更新查询，这意味着它还没有被触发）。任何帮助都会非常明显。1）我正在使用隔离级别读取提交 2）我无法理解第二个/第一个事务如何获得 X 锁，而另一个事务已经在某行获得它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:04:02.483

> 我无法理解第二个/第一个事务如何获得 X 锁，而另一个事务已经在某行获得它。

这就是数据库及其性能背后的魔力。锁可以在不同的级别上发布，如果第二个事务不使用表扫描，它可以发布 X 锁而不会与第一个事务冲突。可能没有发生使用索引和表扫描搜索的更新记录，因此您的表中可能存在多个并发 X 锁。

> 我在更新查询中读到，首先应用 U 锁，然后针对该特定更新行升级到 X 锁。

不，更新应该直接在记录上使用 X 锁。读取要更新的数据的读取查询必须强制 U 锁定（这就是 @Marc 在他的评论中提到的）。如您所知，EF 不支持这一点，因为它不能使用提示。

# php - 使用uploadify重命名文件名

> ID：10896715
> 
> 赞同：1
> 
> 时间：2012-06-05T11:44:25.160
> 
> 标签：php, uploadify, codeigniter-2

我正在使用uploadify上传图像，问题是，在模型中我正在更改通过uploadify功能传递的文件名。现在我想要在uploadify的onUploadComplete属性中的模型中重命名的文件名。我提醒那个文件名但它显示实际上传的相同文件名。这是我的代码：-

```
 'buttonText'      : 'Select',
        'fileTypeDesc'    : 'Image Files',
        'fileTypeExts'    : '*.gif; *.jpg; *.png',
        'swf'             :'<?php echo base_url()?>resources/flash/uploadify.swf',
        'uploader'        :'<?php echo base_url().'user/upload_temp';?>',
        'width'           : 40,
        'multi'           :false,
        'onUploadComplete':function(file)
        {
            alert(file.name);
            $('.select_div').hide();
            $('.original').hide();
            $('#image1').attr('style','background-image:url("./resources/images/users/temp/'+file.name+'");background-size: 76px 76px;');
            $('.default').hide();
            $('#image2').attr('style','background-image:url("./resources/images/users/temp/'+file.name+'");background-size: 73px 66px;position:absolute; height:66px; width:73px; top:256px; left:220px;');
            $('#hidden_img_value1').attr('value',file.name)
        }
    }); 
```

在我这样做的模型中：- $targetFolder = FCPATH.'/resources/images/users/temp/'; // 相对于根 if (!empty($image)) { $time=strtotime("now"); $image['Filedata']['name']=$time.'.jpg'; $tempFile = $image['Filedata']['tmp_name']; $targetPath = $targetFolder.$image['Filedata']['name'];

```
 // Validate the file type
        $fileTypes = array('jpg','jpeg','gif','png'); // File extensions
        $fileParts = pathinfo($image['Filedata']['name']);

        if (in_array($fileParts['extension'],$fileTypes)) 
        {
            move_uploaded_file($tempFile,$targetPath);
            echo '1';
        } 
        else 
        {
            echo 'Invalid file type.';
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:59:43.450

```
 // Validate the file type
    $fileTypes = array('jpg','jpeg','gif','png'); // File extensions
    $fileParts = pathinfo($image['Filedata']['name']);

    if (in_array($fileParts['extension'],$fileTypes)) 
    {
        move_uploaded_file($tempFile,$targetPath);

      // Set new Name
      $new_name = rand(0,10000).'.'.$fileParts['extension'];
      $new_path = $fileParts['dirname'].'/'.$new_name;

      while(file_exists($new_path))
     {
      $new_name = rand(0,10000).'.'.$fileParts['extension'];
      $new_path = $fileParts['dirname'].'/'.$new_name;
     }

      rename($targetPath,$new_path);

    } 
    else 
    {
        echo 'Invalid file type.';
    }
} 
```

# android - 应用内结算 RESTORE_TRANSACTION 给 DEVELOPER_ERROR

> ID：10896720
> 
> 赞同：1
> 
> 时间：2012-06-05T11:44:55.653
> 
> 标签：android, in-app-billing

我正在我的应用中实施应用内计费。我刚刚实现了 REQUEST_PURCHASE、CONFIRM_NOTIFICATION 和 CHECK_BILLING，它们运行良好。

现在我正在尝试实现 REQUEST_TRANSACTIONS 方法，但是我遇到了一个问题，一旦我使用 sendBIllingRequest 发送请求，我就会收到带有 RESULT_DEVELOPER_ERROR (5) 的 RESPONSE_CODE 响应。

这就是我提出请求的方式：

```
 Log.d(TAG, "Action equals RESTORE_TRANSACTIONS");
Bundle request = makeRequestBundle("RESTORE_TRANSACTIONS");
request.putLong("NONCE", BillingSecurity.newNonce());
try {
    Bundle response = mService.sendBillingRequest(request);
    int response_code = response.getInt("RESPONSE_CODE", -1);
    Log.d(TAG, "RESPONSE Restore: " + response_code);
    restored=true;
} catch (RemoteException e) {
    e.printStackTrace();
} 
```

我阅读了其他问题，即禁用调试模式时需要启动 RESTORE_TRANSACTIONS。我从 Manifest 中禁用了它（我清除了该字段，因为如果我输入 false LogCat 没有显示任何调试打印），所以这是我的 Android Manifest：

```
<?xml version="1.0" encoding="utf-8"?><manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="resistorcalc.main"
  android:versionName="3.0" android:versionCode="9">
<uses-sdk android:minSdkVersion="8"></uses-sdk>

<uses-permission android:name="com.android.vending.BILLING" />

<application android:label="@string/app_name" android:name=".App" android:icon="@drawable/resistoricon">
    <activity android:name=".launchActivity"
              android:label="@string/app_name" android:screenOrientation="portrait" android:clearTaskOnLaunch="true" android:finishOnTaskLaunch="true">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:launchMode="standard" android:label="@string/app_name" android:name="SupportusActivity" android:finishOnTaskLaunch="true" android:clearTaskOnLaunch="true" android:screenOrientation="portrait"></activity>
    <activity android:launchMode="standard" android:label="@string/app_name" android:name="OhmLawActivity" android:finishOnTaskLaunch="true" android:clearTaskOnLaunch="true" android:screenOrientation="portrait"></activity>
    <activity android:launchMode="standard" android:label="@string/app_name" android:name="ResistorSumActivity" android:finishOnTaskLaunch="true" android:clearTaskOnLaunch="true" android:screenOrientation="portrait"></activity>               
    <activity android:name="com.google.ads.AdActivity"
          android:configChanges="keyboard|keyboardHidden|orientation" android:clearTaskOnLaunch="true" android:finishOnTaskLaunch="true"/>
    <service android:name=".billing.BillingService" />

    <receiver android:name=".billing.BillingReceiver">
        <intent-filter>
            <action android:name="com.android.vending.billing.IN_APP_NOTIFY" />
            <action android:name="com.android.vending.billing.RESPONSE_CODE" />
            <action android:name="com.android.vending.billing.PURCHASE_STATE_CHANGED" />
        </intent-filter>
    </receiver>               
</application>

<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/> 
```

现在我的问题是：

1.  我需要在清单上的 Debuggable 标志上设置 false 吗？或者我只需要运行应用程序。
2.  如果 debuggable 设置为 false，为什么 logcat 不显示任何 Log.* 消息？这是一种正常的行为（我在 Eclipse 中使用 logcat）
3.  如果我使用 android.test.purchased 之类的静态请求，可以使用 RESTOrE_TRANSACTIONS 检索它们吗？
4.  我是否需要在我的市场上上传草稿才能使该方法起作用？

谢谢，伊万

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T02:47:12.203

清单中的调试标志与此无关。您需要使用您的发布密钥签署您的应用程序并将草稿上传到 Play 商店。您可能需要等待一个小时左右才能激活它。不，RESTORE_TRANSACTIONS 不适用于测试项目，您需要使用自己发布的项目。所有这些都[在参考资料中进行了描述，](http://developer.android.com/guide/market/billing/billing_testing.html)如果您遵循它，您应该不会有任何问题。

# cruisecontrol.net - cc.net：从触发器名称设置主题电子邮件发布者

> ID：10896721
> 
> 赞同：0
> 
> 时间：2012-06-05T11:44:56.587
> 
> 标签：cruisecontrol.net

伙计们！我在 cc.net 有项目，这个项目不是从 3 种方式开始的

1.  强制（当用户点击网页中的“强制”按钮时
2.  按项目触发
3.  通过调度器触发器

构建服务器后将邮件发送到堆栈持有者。

现在，我想将触发器名称添加到邮件主题。例如 force_Project 名称 ...buikd 结果

我试过使用变量：

```
<projectTrigger project="Someproject">
    <triggerStatus>Success</triggerStatus>
<variable name="Trigger" value="commit" />          
</projectTrigger> 
```

和

```
<subjectSettings>    
<subject buildResult="Broken" value="{Trigger} is  broken" />
<subject buildResult="StillBroken" value="{Trigger} is still broken" />    
</subjectSettings> 
```

但这种方式没有积极的结果。

什么样的方式能帮到我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T17:17:12.230

你可以使用ccnet的fileLabeller。

```
 <tasks>
     build tasks...
     <fileLabeller> 
        <labelFilePath>c:\buildstuff\mybuild-label.txt</labelFilePath> 
        <allowDuplicateSubsequentLabels>false</allowDuplicateSubsequentLabels> 
     </fileLabeller> 
   </tasks> 
```

设置您的构建任务以写入 mybuild-label.txt 的内容。我写这样的东西。

[repo1 版本：99，repo2 版本：9999]

这将成为主题的一部分。

# java - 图像大小调整，Java

> ID：10896723
> 
> 赞同：1
> 
> 时间：2012-06-05T11:45:10.597
> 
> 标签：java, image, resize

有人可以解释为什么这行代码不起作用。没有给出错误。它根本不会调整图像的大小。

```
image = ImageIO.read(file);

image.getScaledInstance(ImageDisplayBox.getWidth(), ImageDisplayBox.getHeight());
ImageDisplayBox.setIcon(new ImageIcon(image)); 
```

我查看了 Stackoverflow 上的其他答案，并注意到很多人使用 .getScaledInstance 方法。

我（认为）这可能是因为我将它作为 .setIcon 使用 - 尽管我在 Java 方面不是最好的。

图像已打印，但由于尺寸原因仅显示图像的左上角。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T11:46:43.103

您忽略了返回的值。你要：

```
image = image.getScaledInstance(ImageDisplayBox.getWidth(),
                                ImageDisplayBox.getHeight(), 5); 
```

或者也许让事情更清楚：

```
Image scaled = image.getScaledInstance(ImageDisplayBox.getWidth(),
                                       ImageDisplayBox.getHeight(), 5);
ImageDisplayBox.setIcon(new ImageIcon(scaled)); 
```

从[文档](http://docs.oracle.com/javase/7/docs/api/java/awt/Image.html#getScaledInstance%28int,%20int,%20int%29)：

> 创建此图像的缩放版本。返回一个新的 Image 对象，它将默认以指定的宽度和高度呈现图像。即使原始源图像已经完全加载，新的 Image 对象也可以异步加载。

请注意，这并没有说明更改*现有*图像的任何内容。它只是创建一个给定大小的*新图像。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:00:30.053

是的

这应该工作

```
Image scaled =image.getScaledInstance(ImageDisplayBox.getWidth(),
                                      ImageDisplayBox.getHeight(), 5);
ImageDisplayBox.setIcon(new ImageIcon(scaled)); 
```

# grails - 容器重启后在 Grails 中保留 servlet 上下文

> ID：10896728
> 
> 赞同：1
> 
> 时间：2012-06-05T11:45:25.367
> 
> 标签：grails, servlets, reboot

重新启动我的 tomcat 实例后，servlet 上下文的所有属性都将丢失，尽管所有活动会话仍在周围，它们的属性仍处于活动状态。使 servlet 上下文属性在容器重新启动后仍然存在的最好的和最类似于 Grails 的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:24:42.510

ServletContext 不是持久的，并且是不可分发的。它没有实现可序列化。

[http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html)

Servlet 规范的第 4 章涉及 ServletContext，它确实描述了其中设置的属性将被持久化的任何期望。为此，通常使用某种数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T12:04:09.143

是的，序列化 servlet 上下文属性不是一个好主意。

后[Servlet 上下文可序列化属性持久性](https://stackoverflow.com/questions/3448557/servlet-context-serializable-attribute-persistence)正是在谈论这个......

> servlet 容器突然终止的可能性不为零，而您的 webapp 没有机会保留其属性。

您的 servlet 上下文中包含的属性应该与您的 Web 应用程序完全分开处理，因为它们不能在容器重新启动时得到保证（而您的应用程序的属性可以在您认为合适的情况下保留）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T14:04:18.370

AFAIK 没有真正的 Grails'ish 方法可以做到这一点。遵循标准 Servlet API，实现 a[`ServletContextListener`](http://docs.oracle.com/javaee/5/api/javax/servlet/ServletContextListener.html)并将其注册到 web.xml 直接或通过[webxml 插件](http://grails.org/plugin/webxml)。

该`ServletContextListener`实现应该使用普通的 java 反序列化。

# c# - c#中的葡萄牙语字符问题

> ID：10896729
> 
> 赞同：1
> 
> 时间：2012-06-05T11:45:27.943
> 
> 标签：c#, httpwebrequest, html-encode

我有葡萄牙语字符串：

```
Sábado das 9 às 15h 
```

在我做了一个 webrequest 并读取了字符串之后，字符 à 被转换为如下所示的内容：

```
S�bado das 9 �s 15h 
```

我做了HttpUtility.HtmlDecode。但这并没有帮助。还是同样的问题。

有什么想法吗？

# c# - 从项目列表中构建树

> ID：10896732
> 
> 赞同：0
> 
> 时间：2012-06-05T11:45:48.583
> 
> 标签：c#

我想就如何以有效的方式从项目列表中构建树获得一些建议

```
 public class Item
    {
        public Item(int id, int? parentId)
        {
            Id = id;
            ParentId = parentId;
        }

        public int Id { get; private set; }
        public int? ParentId { get; private set; }
        public List<Item> SubItems  { get; set; }
    }

    private Item BuildATree()
    {
        var items = new List<Item>()
                        {
                            new Item(1, null),
                            new Item(2, 1),
                            new Item(3, 1),
                            new Item(4, 1),
                            new Item(5, 2),
                            new Item(6, 2),
                            new Item(7, 4),
                            new Item(8, 7),
                            new Item(9, 1),
                        };

        //Build a tree out of list items
    } 
```

我期望的结果是每个项目都在其父项的 SubItems 列表中

不一定使用相同的 Item 类，因为 Ids 会是多余的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:49:50.927

我会使用 LINQ：

```
//Build a tree out of list items
foreach (Item item in items)
{
    item.SubItems = items.Where(i => i.ParentId.Value == item.Id).ToList();
} 
```

升级版：

为了简化从一个父项到另一个父项的移动，您需要在每个项中存储对父项的引用。就像是：

```
public class Item
{
    public Item(int id, int? parentId)
    {
        Id = id;
        ParentId = parentId;
    }

    public int Id { get; private set; }
    public int? ParentId { get; private set; }
    public List<Item> SubItems  { get; set; }

    private Item _parent;
    public Item Parent 
    {
        get { return _parent; }
        set
        {
            if (_parent != null)
                _parent.SubItems.Remove(this);
            _parent = value;
            if (_parent != null)
                _parent.SubItems.Add(this);
        }
    }
} 
```

如果您以这种方式实现，那么只需通过此属性设置新的父项就足以修改新旧父项的子项集合 - 但请注意，您还需要更复杂的列表初始化机制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T11:46:37.097

足够有效的解决方案

```
private void RecursiveBuilder(ref Item i, IEnumerable<Item> li)
{
    var item = i;
    i.SubItems = (from n in li where n.ParentId == item.Id select n).ToList();
    i.SubItems.ForEach(f => RecursiveBuilder(ref f, li));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T11:58:33.520

如果您不想要/拥有 Link ：

```
Dictionary<int,Item> dic = new Dictionary<int,Item>();
foreach(Item item in items)
{
    Item parent;
    if(item.ParentId!=null && dic.TryGetValue(item.ParentId, out parent))
        parent.SubItems.Add(item);
    else
        dic.Add(item.Id, item);
}
Item root = dic[1]; 
```

我认为总会有一个 id = 1 的 Item ，这就是树的根。

如果您想使用没有 id 的新类，请创建它们而不是简单地将它们添加到它们的父级。

# android - Android：使背景图像可变

> ID：10896734
> 
> 赞同：2
> 
> 时间：2012-06-05T11:46:01.483
> 
> 标签：android, android-layout

我有一个带有背景图像的 android 应用程序。我的目标是创建 3 或 4 个背景图像，并为用户提供更改背景的可能性。

实际上，我有 4 个名为 bg1.png、bg2.png、bg3.png 和 bg4.png 的图像。我已经考虑过在 Strings.xml 中用图像名称声明一个字符串值“背景”。背景图像的名称将始终取自背景字符串，当用户更改背景时，这将仅更改字符串背景的值。

这个想法好还是有更简单的方法？如何使用“背景”字符串的值在 xml 布局文件中设置布局的背景？我应该以编程方式执行此操作吗？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:51:42.457

我认为如果您想将背景更改为活动布局，您可以使用布局的 setBackground 方法来实现，例如：

```
activityLayout = (LinearLayout)findViewById(R.id.tableLayout1);
activityLayout.setBackgroundDrawable(getResources().getDrawable(R.id.somedrawable)) 
```

例如，您可以使用 SharedPreference 存储背景图像，然后在启动活动时读取包含背景的首选项。例如当用户选择背景时：

```
SharedPreferences myPrefs = this.getSharedPreferences("myPrefs", Context.MODE_PRIVATE);
SharedPreferences.Editor prefsEditor = myPrefs.edit();
prefEditor.putInt("backgroudResourceId", userchoice);
prefEditor.commit(); 
```

当一个活动开始时，你必须从 SharedPreference 中读取 resourceId：

```
SharedPreferences myPrefs = this.getSharedPreferences("myPrefs", Context.MODE_PRIVATE);
drawableid = myPrefs.getInt("backgroundResourceId", defaultvalue); 
yourlayout.setBackground(drawableid); 
```

其中 defaultvalue 是未设置首选项时的默认值。yourLayout 应该被初始化（以与活动布局相同的方式）。

# blackberry - 由于错误 907，无法在 BlackBerry 上安装应用程序

> ID：10896736
> 
> 赞同：0
> 
> 时间：2012-06-05T11:46:07.693
> 
> 标签：blackberry, cordova

我目前正在开发一个 PhoneGap 应用程序（针对 BlackBerry OS 6/7）。该应用程序在 Ripple Emulator 上运行良好，并且在 PhoneGap Build Service 上构建良好。

当我尝试在物理测试设备（BlackBerry Curve 9300）上通过 PhoneGap 构建无线安装时，我不断收到“907 错误”的变体 - 无效的 Jar / Invalid cod 等。我也尝试从安装我自己的服务器，具有我创建和验证的 JAD，并正确设置了 MIME 类型 - 结果相同。

当我尝试通过 BlackBerry Desktop 软件进行安装时，我得到“静默失败”，即 BB Desktop 只是简单地循环回到应用程序列表，而不安装软件。

我搜索了 BlackBerry 论坛和知识库，并尝试应用其中包含的建议。例如：

[关于 907 错误的 BlackBerry 论坛条目](http://supportforums.blackberry.com/t5/Testing-and-Deployment/907-Invalid-Jar-Error-when-installing-an-application-wirelessly/ta-p/445056)

[知识库文章](http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/800708/800646/Support_-_907_Invalid_Jar_Error_when_installing_an_application_wirelessly.html?nodeid=1017517&vernum=0)

物理测试设备有黑莓服务（推送电子邮件、黑莓应用世界等都在工作）。到目前为止，这个问题已经定义了我解决它的尝试（尽管我还没有放弃）。我应该考虑的任何指示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T06:52:16.253

我找到了这个 907 的原因。

我编译的应用程序有超过 127 个同级 COD。在“传统”黑莓（直到 Blackberry 7；我不确定这种行为是否扩展到 BB10 和 PlayBook）上，应用程序的同级 COD 不能超过 127 个。

还有绝对大小限制，这与每个 COD 的大小限制为 128kB（64kB 数据/64kB 代码）这一事实有关。因此，实际的绝对大小限制取决于您的应用程序的代码部分和数据部分（有严格的分隔）。

我目前最头疼的问题是如何将我的内容嵌入到应用程序中，尽管有这个限制。我已将其作为一个独立问题发布：

[我需要在 BlackBerry Webworks Application（对于 BlackBerry 6/7）中嵌入 > 4MB 的内容文件。我有哪些选择？](https://stackoverflow.com/questions/11078052/i-need-to-embed-a-4mb-content-file-in-a-blackberry-webworks-application-fror)

# php - PHP - 根据值构造多维数组

> ID：10896739
> 
> 赞同：0
> 
> 时间：2012-06-05T11:46:42.623
> 
> 标签：php, multidimensional-array, structure

我有一个数组：

```
$initialarray = array(
  0 = array(
    'unit' => 1,
    'class' => 1,
    'value' => 'string1'
  ),
  1 = array(
    'unit' => 1,
    'class' => 2,
    'value' => 'string2'
  ),
  2 = array(
    'unit' => 1,
    'class' => 2,
    'value' => 'string3'
  ),
  3 = array(
    'unit' => 2,
    'class' => 1,
    'value' => 'string4'
  )
  4 = array(
    'unit' => 2,
    'class' => 2,
    'value' => 'string5'
  )
); 
```

首先取决于“单位”字段的值，然后取决于“类”字段的值，构造它（对生成的子数组进行分组）的最佳方法是什么，如下所示：

```
$resultarray = array(
  // array of all the sub-arrays of 'unit' = 1
  $unit[1] = array(
    // array of all the sub-arrays of 'unit' = 1 and 'class' = 1
    $class[1] = array(
      0 = array(
        'unit' => 1,
        'class' => 1,
        'value' => 'string1'
      )
    )
    // array of all the sub-arrays of 'unit' = 1 and 'class' = 2
    $class[2] = array(
      0 = array(
        'unit' => 1,
        'class' => 2,
        'value' => 'string2'
      ),
      1 = array(
        'unit' => 1,
        'class' => 2,
        'value' => 'string3'
      )
    )
  )
  // array of all the sub-arrays of 'unit' = 2
  $unit[2] = array(
    // array of all the sub-arrays of 'unit' = 2 and 'class' = 1
    $class[1] = array(
      0 = array(
        'unit' => 2,
        'class' => 1,
        'value' => 'string4'
      )
    )
    // array of all the sub-arrays of 'unit' = 2 and 'class' = 2
    $class[2] = array(
      0 = array(
        'unit' => 2,
        'class' => 2,
        'value' => 'string5'
      )
    )
  )
) 
```

我在[这里](https://stackoverflow.com/questions/10790009/php-divide-a-multidimensional-array-depending-on-a-fields-value)问了一个类似的问题，并且只得到了一次迭代的有效答案，即仅通过其中一个字段来构造数组。但是我无法使相同的解决方案适用于多次迭代，即适用于多个领域。

另外，是否有一种解决方案可以根据两个以上的字段来构造多维数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T13:00:45.017

我认为这不是提问的方式。这很简单，你可以通过使用数组、键等来做到这一点。所以首先你应该努力解决这个问题。如果您在尝试过程中遇到任何问题，那么您可以在这里询问。我已经解决了你的问题，这里是完整的代码，但是下次请做一些工作，然后只发布问题。永远不要索要代码。

```
foreach ($initialarray as $key1=>$val1)
{
    foreach ($val1 as $key2=>$val2)
    {            

        if($key2=='unit')
        {
            $num=$val2;
            if($val2!=$num)
            $testarr['unit'.$val2]=array();
        }
        if($key2=='class')
        {
            $testarr['unit'.$num]['class'.$val2][]=$val1;
        }

    }
}

print_r($testarr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-26T13:50:58.087

我必须为您和未来的研究人员提供更好的方法...

`[]`您只需要一个循环，并且您只需要在使用将新数据“推送”到最深的子数组之前指定结果数组的键值。

*绝对不需要任何条件语句或第二个循环。

代码：（[演示](http://sandbox.onlinephpfunctions.com/code/ecb35cda4e939a90d75a1358d447240162cc0657)）

```
$initialarray = [
  ['unit' => 1, 'class' => 1, 'value' => 'string1'],
  ['unit' => 1, 'class' => 2, 'value' => 'string2'],
  ['unit' => 1, 'class' => 2, 'value' => 'string3'],
  ['unit' => 2, 'class' => 1, 'value' => 'string4'],
  ['unit' => 2, 'class' => 2, 'value' => 'string5']
];

foreach ($initialarray as $row) {
    $result[$row['unit']][$row['class']][] = $row;
}
var_export($result); 
```

输出：

```
array (
  1 => 
  array (
    1 => 
    array (
      0 => 
      array (
        'unit' => 1,
        'class' => 1,
        'value' => 'string1',
      ),
    ),
    2 => 
    array (
      0 => 
      array (
        'unit' => 1,
        'class' => 2,
        'value' => 'string2',
      ),
      1 => 
      array (
        'unit' => 1,
        'class' => 2,
        'value' => 'string3',
      ),
    ),
  ),
  2 => 
  array (
    1 => 
    array (
      0 => 
      array (
        'unit' => 2,
        'class' => 1,
        'value' => 'string4',
      ),
    ),
    2 => 
    array (
      0 => 
      array (
        'unit' => 2,
        'class' => 2,
        'value' => 'string5',
      ),
    ),
  ),
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T12:43:49.657

如果我可以用以下方式表达自己：我只看到你的问题的前端，对它的后端一无所知，例如“数据来自哪里？”，“它是如何收集和存储的”等.所以我的回答可能没有真正的帮助，但我仍然会给出我的“tuppence”。
如果您可以将所有数据存储在关系数据库中（以表的形式），那么从数据库中选择所需的数据而不是重新排列数组会更容易和更快（！），这将需要更多时间相比下。
举个例子，您可以选择（并将其存储到数组中）所有具有的项目`unit = '1'`和/或所有具有`class = '2'`. 恕我直言，这将使生活更容易，而不是将所有数据放在多维数组中，然后尝试对其进行排序/重新排列。特别是如果您基于多个属性执行此操作。

# android - android中的语音强度计算

> ID：10896741
> 
> 赞同：2
> 
> 时间：2012-06-05T11:46:44.340
> 
> 标签：android, audiorecord

我创建了一个示例应用程序，用于通过谷歌搜索等语音命令搜索网络中的任何内容。我用`import android.media.AudioRecord;`这个。当用户说我根据声音的强度在图标上显示动画时。为此，我做了一个从互联网上得到的数学计算。如果我在做这个计算，我会得到错误的命令。请帮我找出原因。

请看我的代码。

```
minBufferSizeInBytes = AudioRecord.getMinBufferSize( 8000,
                AudioFormat.CHANNEL_IN_MONO,AudioFormat.ENCODING_PCM_16BIT);
rec = new AudioRecord(MediaRecorder.AudioSource.DEFAULT, 8000,
                AudioFormat.CHANNEL_IN_MONO,
                AudioFormat.ENCODING_PCM_16BIT, 8192); 
```

//重新编码从这里开始

```
 public void run() {
        rec.startRecording();
        while (!done) {
            int nshorts = readBlock();
            if (nshorts <= 0)
                break;
        }
        rec.stop();
        rec.release();
    } 
```

// readBlock() 方法。计算在这里

```
 int readBlock() {
       short[] buf = new short[this.block_size];
       byte audioBuffer[]      = new  byte[this.minBufferSizeInBytes];
        float totalAbsValue = 0.0f;
           short sample = 0;
           int numberOfReadBytes = 0; 
           float tempFloatBuffer[] = new float[3];
           int tempIndex = 0;

       int nshorts = rec.read(buf, 0, buf.length);
       if (nshorts > 0) {
            q.add(buf);
       }
       numberOfReadBytes = rec.read( audioBuffer, 0,minBufferSizeInBytes );
        for( int i=0; i<numberOfReadBytes; i+=2 ) {
            sample = (short)( (audioBuffer[i]) | audioBuffer[i + 1] << 8 );
            if(sample!=0) {
                totalAbsValue += Math.abs( sample ) / (numberOfReadBytes/2);
            }
        }
        tempFloatBuffer[tempIndex%3] = totalAbsValue;
        temp = 0.0f;
        for( int i=0; i<3; ++i )
            temp += tempFloatBuffer[i];
        System.out.println("Temp: "+temp);
        mMyClass = MyClass.getInstance();
        mMyClass.handler.postDelayed(mMyClass.AnimateRunnable, 100);
        return nshorts;
 } 
```

# c# - 如何从 Visual Studio 插件中读取属性页

> ID：10896747
> 
> 赞同：2
> 
> 时间：2012-06-05T11:47:10.777
> 
> 标签：c#, visual-studio, properties, biztalk, add-in

我正在开发一个 Visual Studio 加载项，以使用外部对象调试 BizTalk 地图。我在读取 BizTalk 映射文件（.btm 属性）的现有属性页时遇到了障碍。我能够通过读取文件来读取文件配置。但是我不确定如何阅读属性页。我正在寻找 TestMap 输入实例和 TestMap 输出实例的值。我试过这个，但是 buildPropertyStorage 是空的。

```
ProjectItem projectItem = _applicationObject.SelectedItems.Item(1).ProjectItem;
string name = "Name";

IVsHierarchy hierarchy;

Microsoft.VisualStudio.OLE.Interop.IServiceProvider sp = (Microsoft.VisualStudio.OLE.Interop.IServiceProvider)_applicationObject;

IntPtr ip;
Guid id1, id2;
id1 = id2 = typeof(SVsSolution).GUID;
int hr = sp.QueryService(ref id1, ref id2, out ip);

IVsSolution solution = (IVsSolution)System.Runtime.InteropServices.Marshal.GetObjectForIUnknown(ip);

solution.GetProjectOfUniqueName(projectItem.ContainingProject.UniqueName, out hierarchy);
IVsBuildPropertyStorage buildPropertyStorage = hierarchy as IVsBuildPropertyStorage;

string value = null;
if (buildPropertyStorage != null)
{
       uint itemId;
       string fullPath = (string)projectItem.Properties.Item("FullPath").Value;
       hierarchy.ParseCanonicalName(fullPath, out itemId);

       buildPropertyStorage.GetItemAttribute(itemId, name, out value);
} 
```

# javascript - js奇怪的括号语法

> ID：10896748
> 
> 赞同：0
> 
> 时间：2012-06-05T11:47:14.873
> 
> 标签：javascript

我对 javascript 很陌生，但我通常了解我使用的大部分脚本。今天我想将一些 moment.js 移植到 haxe 。但我对这种语法感到非常失望：

```
var args = seconds < 45 && ['s', seconds] ||
            minutes === 1 && ['m'] ||
            minutes < 45 && ['mm', minutes] ||
            hours === 1 && ['h'] ||
            hours < 22 && ['hh', hours] ||
            days === 1 && ['d'] ||
            days <= 25 && ['dd', days] ||
            days <= 45 && ['M'] ||
            days < 345 && ['MM', round(days / 30)] ||
            years === 1 && ['y'] || ['yy', years]; 
```

您可以在此文件的第 529 行找到它[https://github.com/timrwood/moment/blob/master/moment.js#L532](https://github.com/timrwood/moment/blob/master/moment.js#L532)

什么`["s", seconds]`意思？它是一个数组，一个json模式吗？

谢谢回复

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T11:58:37.633

基本上`args`将是一个数组，其中包含一个或两个表示时间间隔的元素。根据时间长短，将以秒、分钟、小时等为单位进行测量。

> ["s", seconds] 是什么意思？它是一个数组，一个json模式吗？

它是一个数组定义。

# jquery - !function ($) { $(function(){ }) }(window.jQuery) 做什么？

> ID：10896749
> 
> 赞同：61
> 
> 时间：2012-06-05T11:47:19.247
> 
> 标签：jquery, jquery-tooltip

我正在使用 twitter bootstrap 创建一个站点并尝试初始化工具提示。除了添加以下内容：

```
$("[rel=tooltip]").tooltip()  
```

在 application.js 中，除非我保留引导文档中使用的以下代码，否则我的工具提示不会初始化。

```
!函数 ($) {

  $(函数(){  

  })

}（窗口.jQuery）

```

上面的代码是做什么的？

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2012-06-05T12:02:16.460

让我们通过分解代码来解释

```
function () {
}() 
```

或常写为

```
(function () {
})() 
```

是一个`self-invoking anonymous`函数，也称为**立即调用函数表达式 (IIFE)**。它立即内联执行匿名函数。

[在解释封装的匿名函数语法](https://stackoverflow.com/q/1634268/1048572)中阅读有关此内容的更多信息。

匿名函数是一项强大的功能，并且具有范围限定（“变量名称间距”）等优点，请参阅[What is the purpose of a self execution function in javascript?](https://stackoverflow.com/q/592396/1048572) .

* * *

现在他们正在使用

```
function ($) {

}(window.jQuery) 
```

让我们暂时跳过`!`。

所以他们将 ,`window.jQuery`作为参数传递给该函数并接受`$`.

它的作用是`$`为（原始 jQuery 对象）创建一个别名`window.jQuery`，从而确保无论其他库是否将 that( ) 带到外部，`$`都将始终引用`jQuery object`that 的内部。`closure``$`

因此，您在该闭包中编写的代码使用`$`将始终有效。

另一个好处是`$`作为匿名函数中的一个参数，这使它更接近于 ，`scope chain`因此 JS 解释器`$`在闭包内找到对象所需的时间比使用 global 时要少`$`。

* * *

```
$(function(){  

}) 
```

您可能已经知道，它是 jQuery 的文档就绪块，它确保此函数内的代码将在 时运行`dom is ready`，因此一切都`event binding's`将正常工作。

[在http://api.jquery.com/ready/](http://api.jquery.com/ready/)阅读更多内容

`!`在[这里](https://stackoverflow.com/questions/8611700/how-exactly-does-function-work/8611734#8611734)或在[函数前的感叹号做什么](https://stackoverflow.com/q/3755606/1048572)？

**简而言之：**

为了证明 的好处`!`，让我们考虑一个案例，

```
(function() {
    alert('first');
}())

(function() {
    alert('second');
}()) 
```

如果你把上面的代码粘贴进去`console`，你会得到两个警报，但是你会得到这个错误

```
TypeError: undefined is not a function 
```

为什么会发生这种情况？让我们模拟一下 JS 引擎是如何执行上述代码块的。它执行这个匿名函数`function() {alert('first');}()`会显示警报，并且当它返回时，不会`undefined`在`()`. 第二个功能也是如此。所以在这个块执行之后，它最终会得到类似的东西

```
(undefined)(undefined) 
```

因为它的语法就像一个`self-invoking anonymous`函数，它试图调用那个函数，但第一个`(undefined)`不是函数。所以你得到`undefined is not a function`错误。`!`修复此类或错误。会发生什么`!`。我引用了上述答案链接中的内容。

> 当您使用 ! 时，该函数将成为一元（逻辑）NOT 运算符的单个操作数。
> 
> 这会强制将函数作为表达式求值，从而允许立即内联调用它。

这解决了上面的问题，我们可以用`!`like重写上面的块

```
!(function() {
    alert('first');
}())

!(function() {
    alert('second');
}()) 
```

* * *

对于您的情况，您可以简单地将工具提示代码放在这样的文档就绪块中

```
$(function(){  
    $("[rel=tooltip]").tooltip();  
}); 
```

它会正常工作。

如果你只是`$("[rel=tooltip]").tooltip()`不使用 any `doc ready block`，那么当这段代码运行时，`rel=tooltip`DOM 中还没有任何元素。所以`$("[rel=tooltip]")`将返回一个空集并且`tooltip`不起作用。

一个示例标记，如果没有它就无法工作`doc ready block`，

```
.
.
.
<script type="text/javascript">
    $("[rel=tooltip]").tooltip();
</script>
.
.
.
.
<a href="#" rel="tooltip">Something</a>
<a href="#" rel="tooltip">Something</a>
<a href="#" rel="tooltip">Something</a> 
```

作为浏览器，按顺序解释标记，它会在面对它时立即执行 js 代码。而当它在这里执行 JS 块时，它还没有解析`a rel="tooltip"`标签，因为它出现在 JS 块之后，所以它们当时不在 DOM 中。

所以对于上述情况`$("[rel=tooltip]")`是空的，因此工具提示将不起作用。因此，将所有 JS 代码放在`document ready`块中总是安全的，例如

```
$(function){
    // put all your JS code here
}); 
```

希望这一切对你现在有意义。

# sonarqube - Sonar 可以在本地访问，但不能在其他地方访问

> ID：10896750
> 
> 赞同：0
> 
> 时间：2012-06-05T11:47:23.860
> 
> 标签：sonarqube

刚刚尝试在 Win XP 中安装独立的声纳 2.0.5。

```
Setting : 

IP   : 127.0.0.1
Port : 9000
WebContext : / 
```

它可以在本地访问。但是，当我尝试从其他计算机访问它时，它无法访问。所以我尝试将设置更改为端口 8080（我的 tomcat 端口）并关闭我的 tomcat。仍然无法访问。我的 Tomcat（端口 8080，如果正在运行）可通过网络访问。Windows 防火墙已关闭。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:01:49.397

您已将 Sonar 配置为绑定到本地环回地址。尝试将 IP 地址更改为“0.0.0.0”。

有关详细信息，请参阅以下内容：

*   [0.0.0.0 和 127.0.0.1 之间的差异](https://serverfault.com/questions/78048/whats-the-difference-between-ip-address-0-0-0-0-and-127-0-0-1)

# jquery - AJAX 调用后重新初始化 jQuery 插件

> ID：10896757
> 
> 赞同：0
> 
> 时间：2012-06-05T11:47:52.537
> 
> 标签：jquery, ajax, plugins, navigation

我正在使用无限 AJAX 滚动：[https ://github.com/webcreate/Infinite-Ajax-Scroll](https://github.com/webcreate/Infinite-Ajax-Scroll)

例如，用户可以按名称对结果进行排序或过滤结果。但是，当我这样做时，我必须更新导航链接。

该插件是通过（例如）启动的：

```
jQuery.ias({
  container     : ".listing",
  item      : ".post",
  pagination    : "#content .navigation",
  next      : ".next-posts a",
  loader    : "images/loader.gif"
}); 
```

如何在 AJAX 调用后重新初始化插件以获取新的导航链接以使用此插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:52:05.427

当 ajax 调用完成后，您只需要再次调用它：

```
$.ajax({
  url: "yoururl."
}).done(function() { 
  jQuery.ias({
        container     : ".listing",
        item      : ".post",
        pagination    : "#content .navigation",
        next      : ".next-posts a",
        loader    : "images/loader.gif"
  });
}); 
```

# google-app-engine - 将 PlayFramework 应用程序部署到 Google App Engine

> ID：10896759
> 
> 赞同：2
> 
> 时间：2012-06-05T11:47:56.577
> 
> 标签：google-app-engine, playframework

对于我的新项目，我计划使用 PlayFramework 和 Google App-Engine。我试图在 playframework 中创建一个示例应用程序并尝试将其部署到 app-engine。

它说应用程序部署成功，但是当我点击[我的应用程序的 url](http://playdeamon.appspot.com/)

它显示一条消息“您的应用程序已准备就绪”，但不显示我的应用程序的主页。

我正在使用 Play Framework 1.2 和 GAE-1.4 插件。我尝试使用插件部署应用程序并使用“appcfg”。

该应用程序在本地开发模式下运行良好，但一旦我将其部署到应用程序引擎，主页就会被“您的应用程序准备就绪”消息替换。

你们能告诉我我在播放框架的部署上是否做错了吗？我尝试搜索是否有人在谷歌和 SO 中都遇到过类似的问题，但找不到任何帮助。

另外，我读了一些帖子说 GAE 插件不适用于 Play-Framework 2.0（**注意：我在上面的示例中使用的是 Play 1.2）**。我想知道如何在 appengine 中部署 play2.0 应用程序。

非常感谢提前！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T13:19:21.493

Did you add application name and version number in appengine-web.xml before deploy?

# android - 调用 getDuration() 时音乐播放器抛出错误

> ID：10896760
> 
> 赞同：-4
> 
> 时间：2012-06-05T11:48:07.643
> 
> 标签：android

我正在创建一个应用程序，它具有媒体播放器控制器，例如播放、暂停等，带有 2 个标签，我可以在其中显示当前持续时间和总持续时间。我的应用程序强制在何时关闭并在我通过 检索总持续时间时引发错误`getDuration()`。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:59:27.983

确保您已初始化您的 MediaPlayer。如果您尝试调用`getDuration()`未初始化的 MediaPlayer 对象，那么它将使应用程序崩溃。

检查以下代码段供您参考。

```
 MediaPlayer player = new MediaPlayer();  <<<<<<<<<
        try {
            player.setDataSource("/sdcard/0.ogg");
            player.prepare();
            Log.v("duration", player.getDuration() + "");
            player.start();
        } catch (Exception e) {
            e.printStackTrace();
        } 
```

# javascript - 为什么 HTTP 删除需要 javascript 才能工作？

> ID：10896762
> 
> 赞同：2
> 
> 时间：2012-06-05T11:48:18.970
> 
> 标签：javascript, ruby-on-rails, authentication, devise, http-delete

我在 Rails 中使用 Devise，在设置**sign_out**函数时遇到了错误。我注意到，发生这种情况是因为具有 sign_out 链接的页面跳过了布局，因此 Javascript 处于非活动状态。通过启用javascript：`

```
<%= javascript_include_tag :defaults %> 
```

一切正常。

为什么它会这样工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T11:53:13.783

链接（通常）总是得到请求。为了让链接发送非获取请求，您需要一些 javascript 来修改链接的行为。

此外，浏览器通常只支持 GET/POST 请求，因此 rails 通过在帖子中添加 _method 字段来伪造其他方法（DELETE、PUT、...）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T12:28:31.277

以下是 的摘录`jquery_ujs.js`。它将阐明它是如何完成的：

```
// Handles "data-method" on links such as:
// <a href="/users/5" data-method="delete" rel="nofollow" data-confirm="Are you sure?">Delete</a>
handleMethod: function(link) {
  var href = link.attr('href'),
    method = link.data('method'),
    target = link.attr('target'),
    csrf_token = $('meta[name=csrf-token]').attr('content'),
    csrf_param = $('meta[name=csrf-param]').attr('content'),
    form = $('<form method="post" action="' + href + '"></form>'),
    metadata_input = '<input name="_method" value="' + method + '" type="hidden" />';

  if (csrf_param !== undefined && csrf_token !== undefined) {
    metadata_input += '<input name="' + csrf_param + '" value="' + csrf_token + '" type="hidden" />';
  }

  if (target) { form.attr('target', target); }

  form.hide().append(metadata_input).appendTo('body');
  form.submit();
}, 
```

因此，通过单击这样的链接，您基本上触发了隐藏表单（在单击期间创建）的发送，其中包含一些模拟`DELETE`HTTP 动词的参数。

# java - 制作@XmlTransient 注释只是为了序列化？

> ID：10896767
> 
> 赞同：3
> 
> 时间：2012-06-05T11:48:54.977
> 
> 标签：java, xml, serialization, cxf, deserialization

我将 Spring 和 Apache CXF 用于我的项目，该项目以第一代码样式实现 java Web 服务。

我有一个定义的变量：

```
@XmlTransient
public String word; 
```

因此该变量不会映射到 XML 中的属性。

但是，我希望在序列化而不是反序列化时映射 XML 元素时忽略它。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:13:45.760

我认为您无法通过`@XmlTransient`. 一种选择是使用[MOXy](http://wiki.eclipse.org/EclipseLink/Examples/MOXy/EclipseLink-OXM.XML)使用一种模式进行编组，并使用另一种模式进行解组。[你可以在这里](http://blog.bdoughan.com/2011/09/mapping-objects-to-multiple-xml-schemas.html)找到一个很好的例子。

一个简单但不太优雅的解决方法是这样的：

```
@XmlTransient
public String word;

public void setDeserializedWord(String word) {
   this.word = word;
}

@XmlElement(name="word")
public String getDeserializedWord() {
   return null;
} 
```

# xml - 如何在 OpenERP 的 POS 收据中添加公司标志？

> ID：10896771
> 
> 赞同：3
> 
> 时间：2012-06-05T11:49:00.960
> 
> 标签：xml, image, openerp

我想在 Openerp 6.1.1 中打印销售点收据时打印公司徽标。我在 pos.xml 文件中添加了以下代码：

```
<img width="60" height="30" border="0" src="http://localhost:8069/web/static/src/img/logo.png"></img> 
```

但如果我更改公司的标志，它不会影响收据标志。如何在 POS 收据中添加公司的动态标志？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T10:01:54.517

以下是在报告上打印徽标的 RML 标签。

```
 <image x="1.3cm" y="27.6cm" height="40.0" >[[ company.logo or removeParentNode('image') ]]</image> 
```

这里 company 是 repeatin 的变量，因此您可以找到相应的字段并将其映射到 [[ ]]

希望这有帮助，谢谢

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T11:53:26.953

将此标签写入 rml 文件的标头

```
<pagetemplate id="first"> 
  <frame id="first" x1="39.0" y1="20.0" width="770" height="450"/> 
  <pagegraphics> 
    <image x="5.5cm" y="17.0cm" height="90.0">[[company.logo]] </image>. 
  </pagegraphics> 
</pagetemplate> 
```

# c++ - 如何获取 ShellExecute 调用的 exe 的返回值

> ID：10896778
> 
> 赞同：16
> 
> 时间：2012-06-05T11:49:29.500
> 
> 标签：c++, c, api, winapi, shellexecute

如何获取由 shellexecute 函数调用的 exe 的返回值。

```
ShellExecute(NULL, NULL, TEXT ( ".\\dpinstx86.exe" ), NULL, NULL, SW_SHOWNORMAL); 
```

在上面的示例中，我想要“dpinstx86.exe”的返回值。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-05T11:54:19.427

改为使用[`ShellExecuteEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762154%28v=vs.85%29.aspx)来获取进程句柄，并[`GetExitCodeProcess`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683189%28v=vs.85%29.aspx)获取退出代码。

```
SHELLEXECUTEINFO ShExecInfo = {0};
ShExecInfo.cbSize = sizeof(SHELLEXECUTEINFO);
ShExecInfo.fMask = SEE_MASK_NOCLOSEPROCESS;
ShExecInfo.hwnd = NULL;
ShExecInfo.lpVerb = NULL;
ShExecInfo.lpFile = "c:\\MyProgram.exe";        
ShExecInfo.lpParameters = "";   
ShExecInfo.lpDirectory = NULL;
ShExecInfo.nShow = SW_SHOW;
ShExecInfo.hInstApp = NULL; 
ShellExecuteEx(&ShExecInfo);
WaitForSingleObject(ShExecInfo.hProcess,INFINITE); 
```

# javascript - 为什么我的匿名函数在这个例子中没有当前对象的上下文？

> ID：10896780
> 
> 赞同：1
> 
> 时间：2012-06-05T11:49:34.150
> 
> 标签：javascript

当我在 Google Chrome 中运行此示例代码时，预期的行为——在当前页面的占位符图像标签内加载图像——不会发生。我在调用 showPic() 时检查了 currPic 的值，它是“未定义的”。我知道如果我将 showPic 的参数从“anchors[i]”更改为“this”，那么它会起作用，但我试图理解为什么会这样。

```
function showPic(currPic) {
    var srcLoc = currPic.getAttribute("href");
    var placeHolder = document.getElementById("placeholder");
    placeHolder.setAttribute("src", srcLoc);
    var imgLabel = document.getElementById("imglabel");
    var currLinkTitle = currPic.getAttribute("title");
    imgLabel.firstChild.nodeValue = currLinkTitle;
}

function prepareGallery() {
    if(!(document.getElementsByTagName && document.getElementById)) return false;

    var imgGallery = document.getElementById("imagegallery");

    if(imgGallery) {
        var anchors = imgGallery.getElementsByTagName("a");
        var i;
        for(i = 0; i < anchors.length; i++) {
            anchors[i].onclick = function() {
                showPic(anchors[i]);
                return false;
        }  
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T11:53:32.927

在匿名函数内部，anchors[i] 提供了运行时引用。在点击发生时，`anchors[i]`不再存在。虽然它在分配时存在，但在单击时它超出了范围（因为它只是一个数组引用）。但是， using`this`提供了对单击时始终可用的直接对象的可靠引用。

更简洁地说，`anchors[i]`是对数组中某个位置的引用（一旦 for 循环退出，它就会离开作用域）。`this`是对 dom 元素本身的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:56:13.593

因为这也行得通：`showPic(document.getElementById(anchors[i].id));`- 你现在“明白”了吗（双关语非常有意）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T03:39:01.657

没有看到关于闭包如何工作的明显声明，所以这是我的看法。

```
var i;
for(i = 0; i < anchors.length; i++) {
    anchors[i].onclick = function() {
        showPic(anchors[i]);
        return false;
    }
} 
```

注意你是如何`i`在循环中引用变量的？在循环结束时，`i`equals的值`anchors.length`。

因此，当您执行*任何*`onclick`函数时，对`i`now 的引用指向 ; 的最后一个索引之后的一个位置`anchors`。这就是为什么你看到`currPic`的是`undefined`。

在其他答案中已经给出了这个问题的一个解决方案：用于`this`引用当前锚点并且不传递`anchors[i]`给`onclick`函数。

由于您可能会遇到类似情况，我将通过关闭`i`like 的值向您展示另一种解决方案：

```
var i;
for(i = 0; i < anchors.length; i++) {
    anchors[i].onclick = (function(i) {
        // inside this function, i is closed over and won't change anymore
        return function() {
            showPic(anchors[i]);
            return false;
        }
    }(i));
} 
```

# asp.net-mvc - 使用 IIS 托管 WCF 和 ASP.NET

> ID：10896784
> 
> 赞同：1
> 
> 时间：2012-06-05T11:49:51.717
> 
> 标签：asp.net-mvc, wcf, windows-server-2008

我想在 Windows Server 2008 R2 上使用 IIS 托管 WCF 服务和 ASP.NET MVC4 站点。

我必须安装哪些服务器角色才能使其正常工作？

![在此处输入图像描述](../Images/93ba57d9557e13510a845ce29c73fb9d.png)

编辑： **我已经安装了角色。我的虚拟机上有互联网连接。我可以从 vm ping 到 pc。我无法从 pc ping 到 vm... 我该如何解决这个问题？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T14:31:19.343

这些新技术的角色并未完全更新。

看看这个 WCF [http://msdn.microsoft.com/en-us/library/ms751527.aspx](http://msdn.microsoft.com/en-us/library/ms751527.aspx)

这对于 MVC [http://www.asp.net/mvc/tutorials/older-versions/deployment/using-asp-net-mvc-with-different-versions-of-iis-cs](http://www.asp.net/mvc/tutorials/older-versions/deployment/using-asp-net-mvc-with-different-versions-of-iis-cs)

将需要更多的手动安装。

# javascript - 在 json 字符串中查找值

> ID：10896785
> 
> 赞同：0
> 
> 时间：2012-06-05T11:49:53.440
> 
> 标签：javascript, json

下面是我所拥有的 JSON 字符串。

```
{
    "ID_A0001":{"areaID":"A0001","shopID":"SH004","quantity":14},
    "ROW_INFO":{"areaID":"VARCHAR","shopID":"VARCHAR","quantity":"INT"},
    "ID_A0002":{"areaID":"A0002","shopID":"SH008","quantity":18}
} 
```

我想要的是获得`JSONObject`ID 为`ID_A`ie `ID_A0001`&`ID_A0002`的。

我正在考虑使用`jsonObject.getString("ID_A")`，但这是不可能的。有人可以告诉我应该怎么做，这样我就会得到如下输出。

```
{
    "ID_A0001":{"areaID":"A0001","shopID":"SH004","quantity":14},
    "ID_A0002":{"areaID":"A0002","shopID":"SH008","quantity":18}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T11:53:40.367

假设您发布的对象存储在`obj`. 如果您实际上有 JSON*字符串*而不是对象，请使用`JSON.parse()`将字符串转换为 JavaScript 对象。

```
var obj2 = {};
for(var key in obj) {
    if(key.substr(0, 4) == 'ID_A') {
        obj2[key] = obj[key];
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T12:08:43.750

在您提到的 json 对象中，您可以按如下方式对其进行修改。

```
 var jsontest={
    ID_A0001:{"areaID":"A0001","shopID":"SH004","quantity":14},
    ROW_INFO:{"areaID":"VARCHAR","shopID":"VARCHAR","quantity":"INT"},
    ID_A0002:{"areaID":"A0002","shopID":"SH008","quantity":18}
        };

for(var key in jsontest) {
    if(key.substring(0,4)=='ID_A')
    alert('key: ' + key + '\n' + 'value: ' + jsontest[key].areaID);
} 
```

[http://jsfiddle.net/FBLvP/](http://jsfiddle.net/FBLvP/)

这是一个有用的链接，它向我们展示了如何从 json 对象 [http://encosia.com/using-jquery-1-6-to-find-an-array-of-an-objects-keys获取键列表/](http://encosia.com/using-jquery-1-6-to-find-an-array-of-an-objects-keys/) [1](http://encosia.com/using-jquery-1-6-to-find-an-array-of-an-objects-keys/)

# php - AJAX 表单在 Chrome 中工作，但不是 FF 的 IE

> ID：10896786
> 
> 赞同：1
> 
> 时间：2012-06-05T11:50:05.693
> 
> 标签：php, jquery, ajax, contact-form

嗨真的需要一些帮助...

首先，我对 jQuery / javascript 知之甚少，一个月前我在专业构建网站后学习了基本的 CSS，然后是基本的 HTML，几天前我想我会用 jQuery 试试运气，但我完全是新手，所以如果您回答，请记住我对这些事情几乎一无所知 - 谢谢！

我一直在尝试制作一个新的联系表格，我使用了来自整个网络的一些代码（所以我知道代码可能非常混乱）无论如何，生成的表格在 Chrome 中似乎可以正常工作，但在 IE、FF 或 Safari 中在提交时它返回“抱歉，此表单存在问题”警报并且没有任何反应，我猜 PHP 脚本正在返回“1”以实现这一点，但老实说，我在我头上！

下面是jquery....

```
$(function(){
//original field values
var field_values = {
        //id        :  value
        'firstname'  : 'first name',
        'lastname'  : 'last name',
        'email'  : 'email address',
        'phone'  : 'phone number',
};

//inputfocus
$('input#lastname').inputfocus({ value: field_values['lastname'] });
$('input#firstname').inputfocus({ value: field_values['firstname'] });
$('input#email').inputfocus({ value: field_values['email'] }); 
$('input#phone').inputfocus({ value: field_values['phone'] }); 

//reset progress bar
$('#progress').css('width','0');
$('#progress_text').html('0% Complete');

//second_step
$('form').submit(function(){ return false; });
$('#submit_second').click(function(){
    //remove classes
    $('#second_step input').removeClass('error').removeClass('valid');

    var emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;  
    var fields = $('#second_step input[type=text]');
    var error = 0;
    fields.each(function(){
        var value = $(this).val();
        if( value.length<1 || value==field_values[$(this).attr('id')] || ( $(this).attr('id')=='email' && !emailPattern.test(value) ) ) {
            $(this).addClass('error');
            $(this).effect("shake", { times:3 }, 50);

            error++;
        } else {
            $(this).addClass('valid');
        }
    });

    if(!error) {
            //update progress bar
            $('#progress_text').html('66% Complete');
            $('#progress').css('width','226px');

            //slide steps
            $('#second_step').slideUp();
            $('#third_step').slideDown();     
    } else return false;

});

$('#submit_third').click(function(){
    //update progress bar
    $('#progress_text').html('100% Complete');
    $('#progress').css('width','339px');

    //prepare the fourth step
    var fields = new Array(
        $('#firstname').val() + ' ' + $('#lastname').val(),
        $('#email').val(),
        $('#phone').val(),
        $('#service').val(),
        $('#location').val(),
        $('#mirror').val(),
        $('#from').val()                         
    );
    var tr = $('#fourth_step tr');
    tr.each(function(){
        //alert( fields[$(this).index()] )
        $(this).children('td:nth-child(2)').html(fields[$(this).index()]);
    });

    //slide steps
    $('#third_step').slideUp();
    $('#fourth_step').slideDown();            
});

$('#submit_fourth').click(function(){

//Get the data from all the fields
var firstname = $('input[name=firstname]');
var email = $('input[name=email]');
var lastname = $('input[name=lastname]');
var phone = $('input[name=phone]');

//organize the data properly
var data = 'firstname=' + firstname.val() + '&email=' + email.val() + '&lastname=' + lastname.val() + '&phone='  + phone.val() + '&service=' + $('select#service option:selected').val() + '&location=' + $('select#location option:selected').val() + '&mirror=' + $('select#mirror option:selected').val() + '&leadfrom=' + $('select#from option:selected').val();

//start the ajax
$.ajax({
    //this is the php file that processes the data and send mail
    url: "process.php", 

    //GET method is used
    type: "GET",

    //pass the data         
    data: data,     

    //Do not cache the page
    cache: false,

    //success
    success: function (html) {              
        //if process.php returned 1/true (send mail success)
        if (html==1) {                  
            //hide the form
            $('.summary').fadeOut('slow');                  

            //show the success message
            $('.success').fadeIn('slow');

            $('#submit_fourth').attr("disabled", true); 

            window.location = "http://www.stackoverflow.com"; 

        //if process.php returned 0/false (send mail failed)
        } else alert('Sorry, there has been a problem with this form. Thank you');              
    }       
});

//cancel the submit button default behaviours
return false;   
});
//back button

$('.back').click(function(){
    var container = $(this).parent('div'),
        previous  = container.prev();

switch(previous.attr('id')) {

    case 'first_step' : $('#progress_text').html('0% Complete');
                 $('#progress').css('width','0px');
                 break;

case 'second_step': $('#progress_text').html('33% Complete');
                     $('#progress').css('width','113px');
                         break;

    case 'third_step' : $('#progress_text').html('66% Complete');
                 $('#progress').css('width','226px');
                 break;
default: break;

}

$(container).slideUp();
$(previous).slideDown();
});
}); 
```

和HTML...

```
<div class="outer-formbody">
<div class="formbody">
    <a href="#" class="close">Close</a>
<div id="container">
    <form action="#" method="post">

        <!-- #second_step -->
        <div id="second_step">
            <h3>Book your appointment</h3>

            <div class="form">
                <input type="text" name="firstname" id="firstname" value="first name" />
                <label for="firstname">Your First Name.<span>*</span></label><!-- clearfix --><div class="clear"></div><!-- /clearfix -->
                <input type="text" name="lastname" id="lastname" value="last name" />
                <label for="lastname">Your Last Name.<span>*</span></label><!-- clearfix --><div class="clear"></div><!-- /clearfix -->
                <input type="text" name="email" id="email" value="email address" />
                <label for="email">Your email address (not shared).<span>*</span></label>   <!-- clearfix --><div class="clear"></div><!-- /clearfix -->   
                <input type="text" name="phone" id="phone" value="phone number" />
                <label for="email">Your contact number (not shared).<span>*</span></label>     
            </div>      <!-- clearfix --><div class="clear"></div><!-- /clearfix -->
            <input class="submit" type="submit" name="submit_second" id="submit_second" value="" />
            </div>        

        <!-- #third_step -->
        <div id="third_step">
            <h3>Book your appointment</h3>

            <div class="form">
                <select id="service" name="service" class="required">
                    <option value="">Please Select</option>
                    <option>Power of Attorney</option>
                    <option>Property Trust</option>
                    <option>Disabled Trust</option>
                    <option>Discretionary Trust</option>
                    <option>Other Trust</option>
                    <option>Protection / Insurance</option>
                    <option>Other Service</option>
                </select>
                <label for="service">Select the service you require.<span>*</span></label> <!-- clearfix --><div class="clear"></div><!-- /clearfix -->

                <select id="location" name="location" class="required">
                    <option value="">Please Select</option>
                    <option>Staffordshire</option>
                    <option>Shropshire</option>
                    <option>West Midlands</option>
                    <option>Shropshire</option>
                    <option>Leicestershire</option>
                    <option>Birmingham</option>
                    <option>Cheshire</option>
                    <option>Other</option>
                </select>
                <label for="location">Select your home county.<span>*</span></label> <!-- clearfix --><div class="clear"></div><!-- /clearfix -->

                <select id="mirror" name="mirror" class="required">
                    <option value="">Please Select</option>
                    <option>Single</option>
                    <option>Couple</option>
                </select>
                <label for="country">Single or two documents (for a couple).<span>*</span></label> <!-- clearfix --><div class="clear"></div><!-- /clearfix -->

                <select id="from" name="from" class="required">
                    <option value="">Please Select</option>
                    <option>NHS/School/Council</option>
                    <option>Friend/Family Member</option>
                    <option>Other Public Sector Employer</option>
                    <option>Private Sector Employer</option>
                    <option>Internet Advert</option>
                    <option>Google</option>
                    <option>Newspaper</option>
                    <option>NetMums</option>
                    <option>MumsNet</option>
                    <option>Other</option>
                </select>
                <label for="from">Where did you hear about us?<span>*</span></label> 
            </div><!-- clearfix --><div class="clear"></div><!-- /clearfix -->

            <input class="back" type="button" value="" />
            <input class="submit" type="submit" name="submit_third" id="submit_third" value="" />

            </div>       

        <!-- #fourth_step -->
        <div id="fourth_step">
            <h3>Book your appointment</h3>

            <div class="form">

                <div class="success">
                </br>
                </br>
                </br>
                </br>
                </br>
                <h3>Booking Submitted. <span>Please Wait . . .</span></h3>
               </div>
                <div class="summary">
                <h3>Summary</h3>
                <table class="table">
                    <tr><td>Name</td><td></td></tr>
                    <tr><td>Email</td><td></td></tr>
                    <tr><td>Phone</td><td></td></tr>
                    <tr><td>Service</td><td></td></tr>
                    <tr><td>Location</td><td></td></tr>
                    <tr><td>Single/Couple</td><td></td></tr>
                    <tr><td>From</td><td></td></tr>
                </table>
               </div>
            </div>      <!-- clearfix --><div class="clear"></div><!-- /clearfix -->

            <input class="back" type="button" value="" />
            <input class="send submit" type="submit" name="submit_fourth" id="submit_fourth"value="" />  

        </div>

    </form>
</div>
<div id="progress_bar">
    <div id="progress"></div>
    <div id="progress_text">0% Complete</div>
</div>
<div></div> 
</div></div>
</div> 
```

以及处理表单的 PHP 脚本....

```
<?php

//Retrieve form data. 
//GET - user submitted data using AJAX
//POST - in case user does not support javascript, we'll use POST instead
$firstname = ($_GET['firstname']) ? $_GET['firstname'] : $_POST['firstname'];
$email = ($_GET['email']) ?$_GET['email'] : $_POST['email'];
$lastname = ($_GET['lastname']) ?$_GET['lastname'] : $_POST['lastname'];
$phone = ($_GET['phone']) ?$_GET['phone'] : $_POST['phone'];
$service = ($_GET['service']) ?$_GET['service'] : $_POST['service'];
$location = ($_GET['location']) ?$_GET['location'] : $_POST['location'];
$mirror = ($_GET['mirror']) ?$_GET['mirror'] : $_POST['mirror'];
$leadfrom = ($_GET['leadfrom']) ?$_GET['leadfrom'] : $_POST['leadfrom'];

//flag to indicate which method it uses. If POST set it to 1
if ($_POST) $post=1;

//if the errors array is empty, send the mail
if (!$errors) {

//recipient
$to = 'Alex <clansey2004@yahoo.co.uk>'; 
//sender
$from = $firstname . ' <' . $email . '>';

//subject and the html message
$subject = 'Lead from ' . $firstname;   
$message = '
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head></head>
<body>
</Br>
<table>
    <tr><td>First Name</td><td>' . $firstname . '</td></tr>
    <tr><td>Lastname</td><td>' . $lastname . '</td></tr>
    <tr><td>Location</td><td>' . $location . '</td></tr>
    <tr><td>Email</td><td>' . $email . '</td></tr>
    <tr><td>Phone</td><td>' . $phone . '</td></tr>
    <tr><td>Service</td><td>' . $service . '</td></tr>
    <tr><td>Mirror</td><td>' . $mirror . '</td></tr>
    <tr><td>Lead From</td><td>' . $leadfrom . '</td></tr>
</table>
</body>
</html>';

//send the mail
$result = sendmail($to, $subject, $message, $from);

//if POST was used, display the message straight away
if ($_POST) {
    if ($result) echo 'Thank you! We have received your message.';
    else echo 'Sorry, unexpected error. Please try again later';

//else if GET was used, return the boolean value so that 
//ajax script can react accordingly
//1 means success, 0 means failed
} else {
    echo $result;   
}

//if the errors array has values
} else {
//display the errors message
for ($i=0; $i<count($errors); $i++) echo $errors[$i] . '<br/>';
echo '<a href="form.php">Back</a>';
exit;
}

//Simple mail function with HTML header
function sendmail($to, $subject, $message, $from) {
$headers = "MIME-Version: 1.0" . "\r\n";
$headers .= "Content-type:text/html;charset=iso-8859-1" . "\r\n";
$headers .= 'From: ' . $from . "\r\n";

$result = mail($to,$subject,$message,$headers);

if ($result) return 1;
else return 0;
}

?> 
```

我确信我犯了一个愚蠢的错误 - 任何帮助将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:03:26.510

我的猜测是您需要使用 encodeURIComponent() 对值进行 urlescape，尤其是那些内部带有斜线的值。

# php - 在 html 表格中显示 php 搜索结果

> ID：10896790
> 
> 赞同：0
> 
> 时间：2012-06-05T11:50:40.287
> 
> 标签：php

我正在运行这个 php 脚本并没有得到我想要的结果。目前它给了我这个输出

> 水肺气瓶
> 
> 麦克风
> 
> 0.00 450.00 5.00
> 
> 2012-06-04 18:50:22
> 
> 水肺气瓶
> 
> 利亚姆
> 
> 80.00 350.00 2.50
> 
> 2012-06-04 19:00:09
> 
> 显示 3 个结果
> 
> 水肺气瓶
> 
> 乔希
> 
> 410.00 0.00 5.00
> 
> 2012-06-04 19:00:09

它几乎是我想要的，除了显示 3 个结果的行应该显示在最后而不是在最后一个条目之前。我需要对我的脚本做些什么来解决这个问题？

```
<?php
    $host = "localhost";
    $user = "root";
    $pass = null;

    // ========================================
    $dbhost = @mysql_connect($host, $user, $pass) or die("Unable to connect to server");

    @mysql_select_db("divebay") or die("Unable to select database");

    $var = "scuba";
    $query = trim($var);

    if(!isset($query)){
        echo "Your search was invalid";
        exit;
    } //line 18

    $sql = "SELECT * FROM auction WHERE name LIKE '%" . $query . "%'";

    $result = mysql_query($sql);
    $numrows = mysql_num_rows($result);
    mysql_close($dbhost);

    if($numrows == 0){
        echo "Sorry, your search did not return any results";
    }

    $i = 0;

    while($i < $numrows){
        $row = mysql_fetch_array($result);

        $ID = $row['ID'];
        $name = $row['name'];
        $owner = $row['owner'];
        $holder = $row['holder'];
        $start = $row['sprice'];
        $current = $row['cprice'];
        $instant = $row['iprice'];
        $inc = $row['incprice'];
        $image = $row['img'];
        $time = $row['stime'];
        $length = $row['duration'];

        echo "
            <?xml version = '1.0' encoding = 'utf-8'?>
            <!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org    /TR/xhtml1/DTD/xhtml1-transitional.dtd'>
            <html xmlns='http://www.w3.org/1999/xhtml'>
            <head>
                <title>searchdbresults</title>
            </head>

            <body>  
                <table style='width = 800px;'>
                    <tr style ='height = 200px;'>
                        <td style ='width = 200px;'></td>

                        <td style ='width = 300px;'>
                            <div style ='180px'> $name </div>
                            <div> $owner </div>
                        </td>

                        <td style='width =200px'>
                            <div style='height = 100px'> $current </div>
                            <div style='height = 50px'> $instant </div>
                            <div> $inc </div>
                        </td>

                        <td> $time </td>
                    </tr>
        ";

        $i++;   
    }

    echo "
                <tr> Displaying $numrows results</tr>
            </table>
        </body>
        </html>
    ";
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:22:54.410

您的脚本正在生成“混乱”的 HTML。从我所见，您如此生成的 HTML 页面（在当前示例中）将具有 3 个 DOCTYPE 定义、3 个`head`以及 3 个开始`table`标记和只有一个结束标记`/table`。而且你不需要`echo`每个 html 实体，你可以在 php 文件中使用纯 html 尝试这样的事情：

```
<?xml version = '1.0' encoding = 'utf-8'?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>

<head>
<title>searchdbresults</title>
</head>
<body>
<?php

$host = "localhost";
$user = "root";
$pass = null;

// ========================================
$dbhost = @mysql_connect($host, $user, $pass) or die("Unable to connect to server");

@mysql_select_db("divebay") or die("Unable to select database");

$var = "scuba";
$query = trim($var);

if(!isset($query)){
    echo "Your search was invalid";
    exit;
} //line 18

$sql = "SELECT * FROM auction WHERE name LIKE '%" . $query . "%'";

$result = mysql_query($sql);
$numrows = mysql_num_rows($result);
mysql_close($dbhost);

if($numrows == 0){
    echo "Sorry, your search did not return any results";
}
else{
?>
<table style='width = 800px;'>
<?php 
    $i = 0;

    while($i < $numrows){
    $row = mysql_fetch_array($result);

    $ID = $row['ID'];
    $name = $row['name'];
    $owner = $row['owner'];
    $holder = $row['holder'];
    $start = $row['sprice'];
    $current = $row['cprice'];
    $instant = $row['iprice'];
    $inc = $row['incprice'];
    $image = $row['img'];
    $time = $row['stime'];
    $length = $row['duration'];
?>
<tr style ="height: 200px;">
<td style ="width: 200px;"></td>
<td style ="width: 300px;">
    <div style ="width: 180px"><?php echo $name; ?></div>
    <div><?php echo $owner; ?></div>
</td>
<td style="width: 200px;">
    <div style="height: 100px;"><?php echo $current; ?></div>
    <div style="height: 50px;"><?php echo $instant; ?></div>
    <div><?php echo $inc; ?></div>
</td>
<td><?php echo $time; ?></td>
</tr>
<?php
      i++;
    } //end of while
} //end of else
?>
<tr>
    <td colspan="4">Displaying <?php echo $numrows; ?> results</td>
</tr>
</table>
</html> 
```

并且还要考虑防止 SQL 注入：[http ://bobby-tables.com/](http://bobby-tables.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:02:12.643

我无法发表评论，但您的代码中有几个问题。

第一个样式必须双引号

```
<div style="width:100%;"> 
```

例如。

第二：此行的 tr 内必须有一个 td ：显示 $numrows 结果

我看到的最后一个是：你有这个：

```
<?xml version = '1.0' encoding = 'utf-8'?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org    /TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>

<head>
<title>searchdbresults</title>
</head>
<body> 
```

在您的 while 循环中，因此它在您的页面中多次出现，并且不能

您的 while 循环中也有表打开，但没有关闭。所以它开了好几次，但只开了一次。

编辑：您还需要在 sql 查询中添加保护

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T12:18:37.403

我认为如果你将你的 php 和 html 分成单独的文件，你会更好。你似乎忘记了你的开始“和结束”。如果你想要你的

```
<tr> Displaying $numrows results</tr> 
```

在页面底部，然后将其从表格中取出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T12:20:44.330

我建议稍微简化一下您的表格，也许将“显示 $numrows 结果”完全从表格中删除。

'<tr> Displaying $numrows results</tr>' 行不是有效的 HTML。<tr> 的意思是'定义一个新的表格行'，但它需要一个 <td> 在里面来包装内容。因为表格的大多数行都包含几个 TD 元素，而这一行只包含一条信息，所以您需要告诉该表格单元格[跨越多个列](http://www.ironspider.ca/tables/tablecells2.htm)。

调试此类事情的一个好方法是将生成的 HTML 提供给[http://validator.w3.org/](http://validator.w3.org/)，或者将 $variables 替换为示例数据并将模板代码提供给验证器。起初这通常有点令人沮丧（因为它会迫使您准确了解要使用的 HTML 版本等），但这是跟踪问题的好方法。如果您将以下 HTML 片段提供给 W3 验证器，它将为您提供一些有用的反馈：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head><title>A</title></head>
<body>

<table><tr><td>aaa</td><td>bbb</td></tr>
<tr><td>cccc</td><td>dddd</td></tr>
<tr>Test</tr>
</table>
</body>
</html> 
```

验证器告诉你： 第 7 行，第 5 列：此处不允许使用字符数据

```
<tr>Test</tr> 
```

换句话说，TR 元素不应该直接包含文本。

它还说：第 7 行，第 13 列：未完成的“tr”结束标记

```
<tr>Test</tr> 
```

“最有可能的是，您嵌套标签并以错误的顺序关闭它们......另一种可能性是您使用的元素需要您未包含的子元素。因此父元素“未完成”，不完整。对于例如，在 HTML 中，<head> 元素必须包含 <title> 子元素，列表需要适当的列表项（<ul> 和 <ol> 需要 <li> ...），等等。”

一旦您以您想要的方式查看和验证静态 HTML，您就可以重新添加 PHP 循环，但这次您可以将脚本输出与您的工作 HTML 示例进行比较。

# allegro - 快板，精灵离开踪迹

> ID：10896794
> 
> 赞同：0
> 
> 时间：2012-06-05T11:51:07.257
> 
> 标签：allegro, double-buffering

我遇到了问题，当我移动它们时，我的精灵会留下痕迹。尝试在每次刷新时绘制 BG，但随后开始闪烁。

这就是我所做的

```
// ...

int main(int argc, char *argv[])
{
    BITMAP *buffer = NULL;

    BITMAP *graphics = NULL; 
    buffer = create_bitmap(SCREEN_W, SCREEN_H);

    graphics = load_bitmap("my_graphics.bmp", NULL); 
        clear_to_color(screen, makecol(0, 0, 0));

    clear_to_color(buffer, makecol(0, 0, 0));

    while(!key[KEY_ESC]) 
    {

        // ...

        render_map(100,100);        

        // ...
    }
}

void render_map(int w, int h)

{
    // ...

    for(int i=0;i < w * h;i++)

    {
        masked_blit(graphics, buffer, 0, 0, pos_x, pos_y, 32, 32);  
    }

    // ...
        blit(buffer, screen, camera_x,camera_y,0,0,SCREEN_W, SCREEN_H);

    clear_to_color(buffer, makecol(0, 0, 0));

} 
```

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T03:46:16.447

您的代码有点难以阅读，并且您遗漏了大部分代码。所以很难确定，但这条线看起来很可疑：

```
blit(buffer, screen, camera_x,camera_y,0,0,SCREEN_W, SCREEN_H); 
```

使用缓冲区时，您通常会像这样调用它：

```
blit(buffer, screen, 0,0, 0,0, SCREEN_W,SCREEN_H); 
```

那是你*唯一*一次在屏幕上画画。所以步骤是：

1.  清除缓冲区（通过绘制背景图像、tileset、颜色等）
2.  将所有内容绘制到缓冲区
3.  将缓冲区复制到屏幕
4.  重复

# java - 如何查找特定 smtp.host 的 SMTP 端口？

> ID：10896797
> 
> 赞同：0
> 
> 时间：2012-06-05T11:51:23.860
> 
> 标签：java, smtp

如何找到特定 smtp 主机的 smtp 端口？

```
import java.util.Properties;

import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class SendMailTLS {

    public static void main(String[] args) {

        final String username = "anthony.savarimut@slingmedia.com";
        final String password = "test";

        Properties props = new Properties();
        props.put("mail.smtp.auth", "true");
        props.put("mail.smtp.starttls.enable", "true");
        props.put("mail.smtp.host", "mail.echostar.com");
        props.put("mail.smtp.port", "9000");

        Session session = Session.getInstance(props,
          new javax.mail.Authenticator() {
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(username, password);
            }
          });

        try {

            Message message = new MimeMessage(session);
            message.setFrom(new InternetAddress("AnthonyRajS@antony.com"));
            message.setRecipients(Message.RecipientType.TO,
                InternetAddress.parse("antoalphi@gmail.com"));
            message.setSubject("Testing Subject");
            message.setText("Dear Mail Crawler,"
                + "\n\n No spam to my email, please!");

            Transport.send(message);

            System.out.println("Done");

        } catch (MessagingException e) {
            throw new RuntimeException(e);
        }
    }
} 
```

是我的代码，但它抛出了这个异常，

```
Exception in thread "main" java.lang.RuntimeException: javax.mail.MessagingException: Exception reading response;
  nested exception is:
    java.net.SocketException: Connection reset
    at samples.SendMailTLS.main(SendMailTLS.java:47)
Caused by: javax.mail.MessagingException: Exception reading response;
  nested exception is:
    java.net.SocketException: Connection reset
    at com.sun.mail.smtp.SMTPTransport.readServerResponse(SMTPTransport.java:2153)
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1912)
    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:638)
    at javax.mail.Service.connect(Service.java:317)
    at javax.mail.Service.connect(Service.java:176)
    at javax.mail.Service.connect(Service.java:125)
    at javax.mail.Transport.send0(Transport.java:194)
    at javax.mail.Transport.send(Transport.java:124)
    at samples.SendMailTLS.main(SendMailTLS.java:42)
Caused by: java.net.SocketException: Connection reset
    at java.net.SocketInputStream.read(Unknown Source)
    at com.sun.mail.util.TraceInputStream.read(TraceInputStream.java:110)
    at java.io.BufferedInputStream.fill(Unknown Source)
    at java.io.BufferedInputStream.read(Unknown Source)
    at com.sun.mail.util.LineInputStream.readLine(LineInputStream.java:89)
    at com.sun.mail.smtp.SMTPTransport.readServerResponse(SMTPTransport.java:2131) 
```

我确信它会给端口带来问题。请帮我解决这个问题。

问候托尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:00:16.400

SMTP 的默认端口是 25：

[http://www.emailaddressmanager.com/tips/mail-servers.html](http://www.emailaddressmanager.com/tips/mail-servers.html)

我的建议是您联系邮件服务器的管理员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-17T11:57:24.387

向管理员询问端口号。在尝试了 25,443,587 并失败了很多次之后。我的管理员给了我 80 作为端口号。

# java - com.apple.eawt.Application 混淆后无法正常工作

> ID：10896799
> 
> 赞同：2
> 
> 时间：2012-06-05T11:51:37.640
> 
> 标签：java, windows, macos, obfuscation

我已经用 Java 为 Mac OSx 和 Windows 编写了一个应用程序，但我是在 Windows 上开发的。因此，我使用`java.lang.reflect.*`为了实现“关于”和“退出”处理程序而不接收异常。

我已将其导出为可执行 Jar，并且在两个操作系统上一切正常。但是，我想混淆应用程序，我正在使用 ProGaurd 来做到这一点。我已经指定了它在 Windows 上工作所需的库（rt.jar、jsse.jar、jce.jar），它在 Windows 上仍然可以正常工作，但是 ProGaurd 告诉我有两个未解析的对类的动态引用或接口，并且混淆的应用程序不再在 Mac 上正常工作（关于和退出处理程序不起作用）。

我在某处读到这`ui.jar`是必需的，所以我从我的 Mac 上复制了它并在 ProGaurd 中指定了它，但这似乎并没有解决问题！任何解决方案都表示赞赏......

提前致谢

**更新**

我现在使用 AppleJavaExtensions 来实现使用`com.apple.eawt.Application`而不是反射的处理程序。但是，我仍然遇到完全相同的问题！这是我目前正在使用的代码：

```
package ap;
import com.apple.eawt.AboutHandler;
import com.apple.eawt.AppEvent;
import com.apple.eawt.AppEvent.QuitEvent;
import com.apple.eawt.Application;
import com.apple.eawt.QuitHandler;
import com.apple.eawt.QuitResponse;
import com.gui.Tabs;

public class xa implements AboutHandler, QuitHandler {

    // Constructor to register/install the necessary handler's
    public xa(){
        Application.getApplication().setAboutHandler(this);
        Application.getApplication().setQuitHandler(this);
    }

    // Implemented method to catch the About menu item
    @Override
    public void handleAbout(AppEvent.AboutEvent e) {
        Tabs.switchAbout();

    }

    // Implemented method to catch the Quit menu item
    @Override
    public void handleQuitRequestWith(QuitEvent arg0, QuitResponse arg1) {
        Tabs.quit();        
    }
} 
```

而且我正在使用 ProGuard GUI 来混淆我的应用程序。在底部的 Obsfucation 'tab' 中，我添加了 class`ap.xa`并指定它 extends/implements `AboutHandler, QuitHandler`。我还添加了类`com.gui.Tabs`，但问题仍然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:01:29.523

也许你可以试试[Apple Java Extensions](http://developer.apple.com/library/mac/#samplecode/AppleJavaExtensions/Introduction/Intro.html)。

使用 Apple Java Extensions，您可以在不使用类的情况下在 Windows 上进行开发`java.lang.reflect.*`，而且 ProGuard 可能会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T11:38:22.043

如果您告诉 ProGuard 不要混淆实现 About 和 Quit 处理程序的类，会有所帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T11:45:48.267

试试这个`-dontoptimize`选项。某些方法在“无效”时会被删除。并在 Windows 上执行 ProGuard ... for Mac。或者一个愚蠢的选择：尝试在 Mac 上进行混淆并提供两个版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T20:06:34.700

**哎呀，我已经解决了这个问题......**我只是犯了一个愚蠢的错误

因为我使用的是 ProGuard GUI，所以我没有在添加屏幕中看到“类成员”部分。因此，虽然 ProGuard 没有混淆类本身，但它混淆了方法，因此侦听器无法正常工作。所以，我最终“保留”`ap.xa`了它的所有方法（包含实际侦听器的类）和`com.apple.**`（JavaAppleExtensions 包）

然而，还有一件事正在发生。当我从终端运行混淆的 JAR 文件时，我收到以下输出：

```
Andrews-MacBook-Pro:~ Andy$ java -jar /Users/Andy/Desktop/YLIT\ Final\ 2.jar
Jun  9 20:50:29 Andrews-MacBook-Pro.local java[959] <Error>: CGContextGetCTM: invalid context 0x0
Jun  9 20:50:29 Andrews-MacBook-Pro.local java[959] <Error>: CGContextSetBaseCTM: invalid context 0x0
Jun  9 20:50:29 Andrews-MacBook-Pro.local java[959] <Error>: CGContextGetCTM: invalid context 0x0
Jun  9 20:50:29 Andrews-MacBook-Pro.local java[959] <Error>: CGContextSetBaseCTM: invalid context 0x0 
```

# ruby-on-rails - Redis 未来 + Rails

> ID：10896805
> 
> 赞同：4
> 
> 时间：2012-06-05T11:51:54.387
> 
> 标签：ruby-on-rails, redis

我在我的一个 Rails 项目中使用 redis，我试图合并这些 redis 集，比如

```
$redis.smembers('set1') | $redis.smembers('set2') 
```

但它会抛出这样的错误

```
undefined method `|' for #<Redis::Future:0x000001306e5830> 
```

是什么`Redis::Future`？我正在使用 redis 和 redis-store gems

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T12:20:52.293

当在管道或事务中调用方法时，通常会返回未来对象。

仅当 EXEC 命令已应用于 Redis 服务器时，返回值才可用。使用 redis-rb，这意味着您应该先退出流水线或多块。

如果要选择/读取数据，请在 multi/exec 块之前执行，并且只在 multi/exec 块中写入。

顺便说一句，使用 $redis.sunion() 在服务器端生成结果会更有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T01:48:47.713

Didier 所说的，以及检查您的代码是否未在`multi`块内运行，如下所示：

```
$redis.multi do
  $set1 = $redis.smembers("set1")
end 
```

在这种情况下，`$set1`是一个“未来”，它指向一旦块存在就会得到的结果。

您可以通过调用来访问真实的底层价值`$set1.value`。

# c# - C#：是否有任何 C# 函数可以将主键从一个表插入另一个表

> ID：10896806
> 
> 赞同：0
> 
> 时间：2012-06-05T11:51:58.717
> 
> 标签：c#, sql-server-2005

我有 2 个表，我想在其中一个接一个地插入数据。第一个表的主键在第二个。是否有任何 C# 函数，以便我可以将第一个表的主键插入到另一个表中，而无需任何选择查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:04:35.197

您可以使用执行插入并将标识值返回给调用者的存储过程来完成它。

```
CREATE PROCEDURE procedure1
AS
BEGIN
    DECLARE @id int;

    INSERT INTO [table1] (col1) VALUES ('Foo');
    SET @id = SCOPE_IDENTITY();
    INSERT INTO [table2] (col1, col2) VALUES (@id, 'Bar');

    RETURN @id;
END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T14:39:00.380

您可能会考虑在插入语句中使用 OUTPUT 子句。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-05T11:55:39.003

不确定我是否理解您的问题，但我认为您想在不咨询服务器的情况下知道主键。

在这种情况下，您需要使用 guid 作为可以在 C# 中生成客户端的主键。标识列将不起作用，因为它们是由 sql server 生成的。

或者，您可以创建一个存储过程，在服务器上为您执行插入操作，并将客户端的身份留空。

**更新 1**

要从 sql server 获取最新生成的身份，您可以使用

```
SCOPE_IDENTITY 
```

（这相当于 mysql_insert_id() ）

还有一些其他选择，即

*   @@身份
*   SCOPE_IDENTITY()
*   IDENT_CURRENT

您可以在[http://blog.sqlauthority.com/2007/03/25/sql-server-identity-vs-scope_identity-vs-ident_current-retrieve-last-inserted-identity-of-record/阅读](http://blog.sqlauthority.com/2007/03/25/sql-server-identity-vs-scope_identity-vs-ident_current-retrieve-last-inserted-identity-of-record/)

# javascript - Javascript encodeURIComponent 不编码单引号

> ID：10896807
> 
> 赞同：33
> 
> 时间：2012-06-05T11:52:03.917
> 
> 标签：javascript

试试看：

```
encodeURIComponent("'@#$%^&"); 
```

如果你试试这个，你会看到除了单引号之外的所有特殊字符都被编码了。我可以使用什么函数对所有字符进行编码并使用 PHP 对其进行解码？

谢谢。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-06-05T12:07:53.527

我不确定您为什么要对它们进行编码。如果只想转义单引号，可以使用`.replace(/'/g, "%27")`. 但是，好的参考是：

*   [你什么时候应该使用转义而不是 encodeURI / encodeURIComponent？](https://stackoverflow.com/q/75980/1048572)
*   在 xkr.us[比较 escape()、encodeURI() 和 encodeURIComponent()](http://xkr.us/articles/javascript/encode-compare/)
*   [Javascript 疯狂：查询字符串解析](http://unixpapa.com/js/querystring.html)#Javascript 编码/解码函数

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-09-11T13:58:59.670

您可以使用：

```
function fixedEncodeURIComponent (str) {
  return encodeURIComponent(str).replace(/[!'()*]/g, escape);
}

fixedEncodeURIComponent("'@#$%^&"); 
```

检查参考： http: [//mdn.beonex.com/en/JavaScript/Reference/Global_Objects/encodeURIComponent.html](http://mdn.beonex.com/en/JavaScript/Reference/Global_Objects/encodeURIComponent.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-06-17T19:01:19.863

只是尝试`encodeURI()`和`encodeURIComponent()`你自己...

```
console.log(encodeURIComponent('@#$%^&*'));
```

输入：`@#$%^&*`。输出：`%40%23%24%25%5E%26*`。所以，等等，发生了什么事`*`？为什么没有转换？TLDR：您实际上想要[`fixedEncodeURIComponent()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent)和[`fixedEncodeURI()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURI)。很长的故事...

`encodeURIComponent()`:***不要使用。***使用，如[**MDN**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent)[**文档**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent)`fixedEncodeURIComponent()`所定义和解释的，强调我的...[**`encodeURIComponent()`**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent)

> 为了更严格地遵守***RFC 3986（保留 !、'、(、) 和 *）***，即使这些字符没有正式的 URI 分隔用途，也可以安全地使用以下内容：

> `function fixedEncodeURIComponent(str) { return encodeURIComponent(str).replace(/[!'()*]/g, function(c) { return '%' + c.charCodeAt(0).toString(16); }); }`

当我们讨论这个话题时，也不要使用`encodeURI()`. MDN 也有自己的重写，如[**MDN`encodeURI()`文档**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURI)所定义。引用他们的解释...

> 如果希望遵循更新的 RFC3986 的 URL，它保留了方括号（用于 IPv6），因此在形成可能是 URL 一部分的内容（例如主机）时不进行编码，以下代码片段可能会有所帮助：

> `function fixedEncodeURI(str) { return encodeURI(str).replace(/%5B/g, '[').replace(/%5D/g, ']'); }`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-03-03T07:06:33.320

您可以使用`btoa()`and `atob()`，这将编码和解码给定的字符串，包括单引号。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-26T12:44:44.857

我发现了一个从不错过任何字符的巧妙技巧。我告诉它替换一切，除了什么都没有。我这样做（URL编码）：

```
function encode(w){return w.replace(/[^]/g,function(w){return '%'+w.charCodeAt(0).toString(16)})} 
```

```
function encode(w){return w.replace(/[^]/g,function(w){return '%'+w.charCodeAt(0).toString(16)})}

loader.value = encode(document.body.innerHTML);
```

```
<textarea id=loader rows=11 cols=55>www.WHAK.com</textarea>
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-29T10:11:59.160

正如@Bergi 所写，您可以替换所有字符：

```
function encoePicture(pictureUrl)
{
 var map=
 {
          '&': '%26',
          '<': '%3c',
          '>': '%3e',
          '"': '%22',
          "'": '%27'
 };

 var encodedPic = encodeURI(pictureUrl);
 var result = encodedPic.replace(/[&<>"']/g, function(m) { return map[m];});
 return result;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-10T17:54:18.740

**最近的答案 (2021)**

使用 JavaScript 的[`URLSearchParams`](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams)：

```
console.log(new URLSearchParams({ encoded: "'@#$%^&" }).toString())
```

# javascript - JavaScript - 替换和创建变量

> ID：10896808
> 
> 赞同：0
> 
> 时间：2012-06-05T11:52:04.807
> 
> 标签：javascript, string, variables, replace

我有一个返回以下内容的 POST AJAX 命令：

```
`email{admin@stackoverflow.com} cid{215}` 
```

我想要做的是将 email{} 和 cid{} 替换为仅使用值作为 vars

```
var email = 'admin@stackoverflow.com'
var customer_id = 215; 
```

他们会像那样出现。有没有比以下更清洁的方法：

```
var result = "email{admin@stackoverflow.com} cid{215}"; 

// change to        admin@stackoverflow.com cid{215}
var replace1 = result.replace("email{");
var replace1a = replace1.replace("}");

// change to        admin@stackoverflow.com 215
var replace2 = result.replace("cid{");
var replace2a = replace1.replace("}");

// now we have an email, with a space and a number
// admin@stackoverflow.com 215 make before space string
// this would be email

// now make only the int a string called cid 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:55:02.953

首先使用正则表达式提取所需数据：

```
var response = "email{admin@stackoverflow.com} cid{215}";
var regex = /email\{(.*)\} cid\{(.*)\}/;
var data = response.match(regex); 
```

现在您可以轻松获得所需的值：

```
var email = data[1];
var customer_id = +data[2]; 
```

# android - 后退按钮不能正常工作？

> ID：10896810
> 
> 赞同：0
> 
> 时间：2012-06-05T11:52:09.543
> 
> 标签：android, button, cordova, back

我在 phoneGap Android 中开发了一个应用程序。
在我的应用程序中，后退按钮无法正常工作。

我使用此代码导航表单：

```
document.addEventListener("backbutton", handleBackButton, true);
function handleBackButton() 
{
    if (typeof(navigator) != 'undefined' && typeof(navigator.app) != 'undefined' && typeof(navigator.app.backHistory) == 'function')
    {
       history.go(-1);
       navigator.app.backHistory();
    }
   else
    {
     history.go(-1);
    //navigator.app.backHistory();
    }    
} 
```

它的工作如下：

例如我有三个页面，`a.html`我 正在从到导航到到`b.html``c.html`
`a.html``b.html``c.html`

**问题**

`c.html`当我点击后退按钮时，它从到导航`b.html`，
再次重复该过程，它不会去`a.html`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:30:33.037

如果 html 您只是想要“常规”的后退行为，请删除所有代码。如果您正在加载单独的 .html 文件，默认的历史堆栈将启动并在页面之间正确加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:01:27.890

通过您的解释，我得出一个结论，当您从 C.html 导航到 B.html 时，现在 C.html 的后屏（历史（-1））是 B.html，这将不断重复。我的观点是将 B.html 作为前一屏，将 A.html 作为前一屏的前一屏。

# linux - 通过 Tor 连接 GitHub 不起作用

> ID：10896811
> 
> 赞同：0
> 
> 时间：2012-06-05T11:52:11.797
> 
> 标签：linux, git, proxy, github, tor

我通过 Tor 使用 GitHub，因为 Git 端口在我的网络上被阻止。

我正在使用 Fedora 17 GNU Linux。今天突然无法通过 Tor 连接到 GitHub。有什么故障排除方法或建议吗？

这是我得到的错误：

```
fatal: unable to connect to github.com:
github.com[0: 207.97.227.239]: errno=Connection timed out 
```

Tor 工作正常。我可以连接其他应用程序，`127.0.0.1:9050`并且代理工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T10:52:31.483

如果您尚未设置 git 用户属性，您将收到此消息

检查你是否有 ~/.gitconfig

然后做：

```
git config --global user.name "your-user-name"
git config --global user.email your@email-address.com 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-05T14:22:46.147

我已经通过 GitHub 使用 assembla.com 设置了 Tor（不幸的是，它现在不可用，但你要做的是为 git 设置代理选项，并且在那些你必须指定 tor 代理的选项中）但发现我还没有更新我的`~/.bashrc`.

类似于本[教程](http://www.webupd8.org/2010/03/how-to-get-git-working-behind-firewall.html)的内容。

# javascript - 如何获取失败的ajax的错误消息

> ID：10896812
> 
> 赞同：4
> 
> 时间：2012-06-05T11:52:20.463
> 
> 标签：javascript, jquery, json

我想使用我从中获取 JSON 数据的 webService

```
 $.ajax({
    type: 'GET',
    contentType: 'application/json',
    dataType: 'JSON-P',
    //the url shows the correct JSON Data when I copy the URL in my browser
    url: 'http://url.com',
    success: function(data){
        console.log(data);
        alert(data);
    },
       error: function(xhr, testStatus, error){console.log("Error occured: "+error+" "+xhr+" "+testStatus)}
}) 
```

在 Firefox 中，它使用错误函数回调，但我不知道问题出在哪里，知道错误消息会很棒，但我的方法不起作用。提前致谢

编辑：在 Chrome 中我收到以下错误：

> Access-Control-Allow-Origin 不允许 Origin null。

编辑：解决了，问题确实是json不能跨站点工作，并且数据不是“jsonp-conform”（它必须设置一个函数（json data ...））围绕json数据。这可以通过更改末尾的 url "_&jsonp=successCallback 来完成。抱歉打扰您了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:18:47.517

我认为存在 JSON 对象语法错误。[使用jsonlint.com](http://jsonlint.com/)检查您的 JSON 对象语法错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:57:12.300

您是否在本地收到此错误？

在服务器上尝试，如果它不起作用：[XmlHttpRequest error: Origin null is not allowed by Access-Control-Allow-Origin](https://stackoverflow.com/questions/3595515/xmlhttprequest-error-origin-null-is-not-allowed-by-access-control-allow-origin)

# android - Froyo 上 GridView 中的 setChoiceMode()

> ID：10896820
> 
> 赞同：1
> 
> 时间：2012-06-05T11:52:55.487
> 
> 标签：android, gridview, android-2.2-froyo

我正在构建一个在 Froyo 上运行并以冰淇淋为目标的应用程序。

问题`choiceMode`出在`GridView`. 似乎 Froyo 没有实现`setChoiceMode`(implemented in `AbsListView`) 方法，我不知道如何解决这个问题。你能帮助我吗？

感谢托比亚·洛斯基亚沃

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T15:01:05.477

我正在使用此代码并且它正在工作：

```
 for (int i = 0; i < parent.getChildCount(); i++) {
        element = (CheckableFrameLayout) parent.getChildAt(i);
        if (position == i) {
            element.setChecked(true);
        } else {
            element.setChecked(false);
        }
    } 
```

父母是一个`AdapterView`

谢谢

# eclipse - 如何在常规 Java 项目中使用 Eclipse 插件？

> ID：10896833
> 
> 赞同：1
> 
> 时间：2012-06-05T11:53:54.247
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp

我有一个带有 Ecore 模型的 EMF 项目，并将其导出为 Eclipse 插件。现在我想在常规 Java 项目（使用 Eclipse）中重用这个插件（插件导出的 Java 包）。

我创建了一个 Java 项目，并尝试使用该选项`Build Path > Add Libraries > Plugin Dependencies`，但它显示一个空插件列表，我无法添加条目。

创建的Java项目没有`META-INF/MANIFEST.MF`，我还没有找到自动创建它的方法。

如何向导出的插件添加依赖项？我需要创建一种特殊的项目吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:24:34.850

您需要创建一个`Plugin Project`. 因此，您可以编辑您的`MANIFEST.MF`并将生成的插件添加为依赖项。

Lars Vogel 有一个[很好的教程](http://www.vogella.com/articles/EclipseEMF/article.html#javacode)，涵盖了如何在 EMF 上下文中进行操作。

# matlab - Matlab函数调用基本

> ID：10896837
> 
> 赞同：0
> 
> 时间：2012-06-05T11:54:22.853
> 
> 标签：matlab

我是 Matlab 新手，现在正在学习基本语法。

我已经编写了 GetBin.m 文件：

```
function res = GetBin(num_bin, bin, val)
if val >= bin(num_bin - 1)
    res = num_bin;
else
    for i = (num_bin - 1) : 1
        if val < bin(i)
            res = i;
        end
    end
end 
```

我称之为：

```
num_bin = 5;
bin = [48.4,96.8,145.2,193.6]; % bin stands for the intermediate borders, so there are 5 bins
fea_val = GetBin(num_bin,bin,fea(1,1)) % fea is a pre-defined 280x4096 matrix 
```

它返回错误：

```
Error in GetBin (line 2)
if val >= bin(num_bin - 1)

Output argument "res" (and maybe others) not assigned during call to
"/Users/mac/Documents/MATLAB/GetBin.m>GetBin". 
```

谁能告诉我这里有什么问题？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T11:56:22.563

您需要确保通过代码的每条可能路径都为`res`.

在您的情况下，情况似乎并非如此，因为您有一个循环：

```
for i = (num_bins-1) : 1
    ...
end 
```

该循环永远不会迭代（因此它永远不会为 赋值`res`）。您需要明确指定它是一个递减循环：

```
for i = (num_bins-1) : -1 : 1
    ...
end 
```

有关详细信息，请参阅有关[冒号运算符](http://www.mathworks.co.uk/help/techdoc/ref/colon.html)的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:57:08.410

```
for i = (num_bin - 1) : -1 : 1 
```

# android - 在 ScrollView 中的 EditText 内滚动

> ID：10896839
> 
> 赞同：11
> 
> 时间：2012-06-05T11:54:38.057
> 
> 标签：android, scroll

是否可以在 EditText 中滚动`ScrollView`？

```
<ScrollView 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">
<LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical">
<!-- scroll inside this EditText -->
            <EditText android:id="@+id/et_scrollhere"
                android:lines="6"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:hint="Voorbeeld"
                android:layout_margin="5dp"
                android:scrollbars="vertical"
                android:inputType="textMultiLine"/>
</LinearLayout>
</ScrollView> 
```

或者是否可以将 EditText 以纵向模式嵌入键盘？类似于 WhatsApp，EditText 是可滚动的。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-05-17T13:12:48.287

```
EditText dwEdit = (EditText) findViewById(R.id.DwEdit);       
dwEdit.setOnTouchListener(new OnTouchListener() {

                public boolean onTouch(View view, MotionEvent event) {
                    // TODO Auto-generated method stub
                    if (view.getId() ==R.id.DwEdit) {
                        view.getParent().requestDisallowInterceptTouchEvent(true);
                        switch (event.getAction()&MotionEvent.ACTION_MASK){
                        case MotionEvent.ACTION_UP:
                            view.getParent().requestDisallowInterceptTouchEvent(false);
                            break;
                        }
                    }
                    return false;
                }
            }); 
```

在你的 xml 文件中

```
 <EditText
        android:id="@+id/DwEdit"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:minLines="10"
        android:scrollbarStyle="insideInset"
        android:scrollbars="vertical" 
        android:overScrollMode="always"
        android:inputType="textCapSentences">
        </EditText> 
```

我希望它会帮助你..

# ios - 如何使用 pinchgesturerecognizer 在 UIView 上显示固定大小的文本？

> ID：10896840
> 
> 赞同：0
> 
> 时间：2012-06-05T11:54:38.953
> 
> 标签：ios, uiview, uilabel, uigesturerecognizer, xcode4.3

我有一个视图（myView），并且由于 myView 上的显示文本而在 myView 上创建了一些标签。我在 myView 上应用了 pinchgesturerecognizer。它工作得很好。我的问题是当我在 myView 上捏时，标签文本的大小将根据捏的增加或减少而改变。如果你捏（放大）myView，标签文本的大小非常小，所以我们看不到文本。如果你捏（缩小）myView，标签文本的大小很大。

因此，无论您放大或缩小 myView，我都想修复标签文本的大小。我试过了，但我没有得到答案。我也用过`setAutoresizingMask:UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleWidth`，但没看懂。我不知道如何使用它。请帮我。提前致谢。

我的代码是：

在`ViewController.m`,

```
 - (void)viewDidLoad
    {
        MyView *myView = [[MyView  alloc] initWithFrame:CGRectMake(0, 100, 200, 100)];
    [self.view addSubview:myView];
        [super viewDidLoad];
    UIPinchGestureRecognizer *pinchGesture = [[UIPinchGestureRecognizer alloc] initWithTarget:self action:@selector(scalePiece:)];
        [pinchGesture setDelegate:self];
        [myView addGestureRecognizer:pinchGesture];
        [pinchGesture release];
    }

- (void)scalePiece:(UIPinchGestureRecognizer *)gestureRecognizer
{

    if ([gestureRecognizer state] == UIGestureRecognizerStateBegan || [gestureRecognizer state] == UIGestureRecognizerStateChanged) {
        [gestureRecognizer view].transform = CGAffineTransformScale([[gestureRecognizer view] transform], [gestureRecognizer scale], [gestureRecognizer scale]);
           //[gestureRecognizer setScale:1];

    }
} 
```

在`MyView.m`,

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
label1 = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 35, 20)];
label1.font = [UIFont fontWithName:@"Helvetica-Bold" size:10];
label1.text = @"label1";
[self addSubview:label1];

label2 = [[UILabel alloc] initWithFrame:CGRectMake(40, 0, 35, 20)];
label2.font = [UIFont fontWithName:@"Helvetica-Bold" size:10];
label2.text = @"label2";
[self addSubview:label2];

label3 = [[UILabel alloc] initWithFrame:CGRectMake(0, 40, 35, 20)];
label3.font = [UIFont fontWithName:@"Helvetica-Bold" size:10];
label3.text = @"label1";
[self addSubview:label3];

label4 = [[UILabel alloc] initWithFrame:CGRectMake(40, 40, 35, 20)];
label4.font = [UIFont fontWithName:@"Helvetica-Bold" size:10];
label4.text = @"label4";
[self addSubview:label4];
    }
    return self;
} 
```

我想修复 label1、label2、label3、label4 的文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:13:13.723

听起来您正试图放大某些项目而不是其他项目。有两种方法可以解决这个问题。两者都不是很简单。您可以将标签拆分到它们自己的视图中，并在另一个视图上进行捏合手势后手动重新定位它们。或者，您可以将它们留在此视图中，并在捏紧后手动重新缩放和定位它们。无论哪种方式，您都必须做一些数学运算。

# python - 在图像上找到一个 3x3 的滑动窗口

> ID：10896841
> 
> 赞同：6
> 
> 时间：2012-06-05T11:54:44.960
> 
> 标签：python, image-processing, opencv

我有一个图像。

我想为图像中的每个像素获取一个 3x3 窗口（相邻像素）。

我有这个 Python 代码：

```
for x in range(2,r-1,1):
    for y in range(2,c-1,1):
        mask5=numpy.array([cv.Get2D(copy_img,x-1,y-1),cv.Get2D(copy_img,x-1,y),cv.Get2D(copy_img,x-1,y+1),cv.Get2D(copy_img,x,y-1),cv.Get2D(copy_img,x,y),cv.Get2D(copy_img,x,y+1),cv.Get2D(copy_img,x+1,y-1),cv.Get2D(copy_img,x+1,y),cv.Get2D(copy_img,x+1,y+1)])
        cent=[cv.Get2D(copy_img,x,y)] 
```

mask5 是 3x3 窗口。cent是中心像素。

有没有更有效的方法来做到这一点 - 即使用地图，迭代器 - 除了我使用的两个嵌套循环之外的任何东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T22:40:46.373

这可以更快地完成，通过重塑和交换轴，然后重复所有内核元素，如下所示：

```
im = np.arange(81).reshape(9,9)
print np.swapaxes(im.reshape(3,3,3,-1),1,2) 
```

这为您提供了一组 3*3 的瓷砖，它们在表面上镶嵌：

```
[[[[ 0  1  2]   [[ 3  4  5]   [[ 6  7  8]
   [ 9 10 11]    [12 13 14]    [15 16 17]
   [18 19 20]]   [21 22 23]]   [24 25 26]]]

 [[[27 28 29]   [[30 31 32]   [[33 34 35]
   [36 37 38]    [39 40 41]    [42 43 44]
   [45 46 47]]   [48 49 50]]   [51 52 53]]]

 [[[54 55 56]   [[57 58 59]   [[60 61 62]
   [63 64 65]    [66 67 68]    [69 70 71]
   [72 73 74]]   [75 76 77]]   [78 79 80]]]] 
```

要获得重叠的图块，我们需要再重复 8 次，但使用`vstack`和的组合“包装”数组`column_stack`。请注意，右侧和底部的瓦片阵列环绕（这可能是也可能不是您想要的，取决于您如何处理边缘条件）：

```
im =  np.vstack((im[1:],im[0]))
im =  np.column_stack((im[:,1:],im[:,0]))
print np.swapaxes(im.reshape(3,3,3,-1),1,2)

#Output:
[[[[10 11 12]   [[13 14 15]   [[16 17  9]
   [19 20 21]    [22 23 24]    [25 26 18]
   [28 29 30]]   [31 32 33]]   [34 35 27]]]

 [[[37 38 39]   [[40 41 42]   [[43 44 36]
   [46 47 48]    [49 50 51]    [52 53 45]
   [55 56 57]]   [58 59 60]]   [61 62 54]]]

 [[[64 65 66]   [[67 68 69]   [[70 71 63]
   [73 74 75]    [76 77 78]    [79 80 72]
   [ 1  2  3]]   [ 4  5  6]]   [ 7  8  0]]]] 
```

这样做你会得到 9 组数组，所以你需要将它们重新压缩在一起。这个，以及所有的重塑概括到这个（对于维度可被 3 整除的数组）：

```
def new(im):
    rows,cols = im.shape
    final = np.zeros((rows, cols, 3, 3))
    for x in (0,1,2):
        for y in (0,1,2):
            im1 = np.vstack((im[x:],im[:x]))
            im1 = np.column_stack((im1[:,y:],im1[:,:y]))
            final[x::3,y::3] = np.swapaxes(im1.reshape(rows/3,3,cols/3,-1),1,2)
    return final 
```

将此`new`函数与循环遍历所有切片（如下）进行比较`timeit`，对于 300*300 数组，使用 ，它的速度大约快 4 倍。

```
def old(im):
    rows,cols = im.shape
    s = []
    for x in xrange(1,rows):
        for y in xrange(1,cols):
            s.append(im[x-1:x+2,y-1:y+2])
    return s 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T15:15:44.603

我认为以下内容可以满足您的需求。循环仅超过 9 个元素。我确信有一种矢量化它的方法，但它可能不值得付出努力。

```
import numpy

im = numpy.random.randint(0,50,(5,7))

# idx_2d contains the indices of each position in the array
idx_2d = numpy.mgrid[0:im.shape[0],0:im.shape[1]]

# We break that into 2 sub arrays
x_idx = idx_2d[1]
y_idx = idx_2d[0]

# The mask is used to ignore the edge values (or indeed any values).
mask = numpy.ones(im.shape, dtype='bool')
mask[0, :] = False
mask[:, 0] = False
mask[im.shape[0] - 1, :] = False
mask[:, im.shape[1] - 1] = False

# We create and fill an array that contains the lookup for every
# possible 3x3 array.
idx_array = numpy.zeros((im[mask].size, 3, 3), dtype='int64')

# Compute the flattened indices for each position in the 3x3 grid
for n in range(0, 3):
    for m in range(0, 3):
        # Compute the flattened indices for each position in the 
        # 3x3 grid
        idx = (x_idx + (n-1)) + (y_idx  + (m-1)) * im.shape[1]

        # mask it, and write it to the big array
        idx_array[:, m, n] = idx[mask]

# sub_images contains every valid 3x3 sub image
sub_images = im.ravel()[idx_array]

# Finally, we can flatten and sort each sub array quickly
sorted_sub_images = numpy.sort(sub_images.reshape((idx[mask].size, 9))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T11:34:38.050

Try the following code as matlab function im2col(...)

```
import numpy as np

def im2col(Im, block, style='sliding'):
    """block = (patchsize, patchsize)
        first do sliding
    """
    bx, by = block
    Imx, Imy = Im.shape
    Imcol = []
    for j in range(0, Imy):
        for i in range(0, Imx):
            if (i+bx <= Imx) and (j+by <= Imy):
                Imcol.append(Im[i:i+bx, j:j+by].T.reshape(bx*by))
            else:
                break
    return np.asarray(Imcol).T

if __name__ == '__main__':
    Im = np.reshape(range(6*6), (6,6))
    patchsize = 3
    print Im
    out =  im2col(Im, (patchsize, patchsize))
    print out
    print out.shape
    print len(out) 
```

# asynchronous - 现有循环中的 Python 异步处理

> ID：10896842
> 
> 赞同：1
> 
> 时间：2012-06-05T11:54:48.640
> 
> 标签：asynchronous, python-2.6, openerp

我正在为 OpenERP 创建一个模块，我必须在其中启动一个正在进行的过程。

OpenERP 在一个连续的循环中运行。当我单击一个按钮时，我的进程必须启动，并且它必须继续运行，而不会阻止 OpenERP 的执行。

为了简化它，我有这个代码：

```
#!/usr/bin/python
import multiprocessing
import time

def f(name):
    while True:
        try:
            print 'hello', name
            time.sleep(1)
        except KeyboardInterrupt:
            return

if __name__ == "__main__":
    count = 0
    while True:
        count += 1
        print "Pass %d" % count
        pool = multiprocessing.Pool(1)
        result = pool.apply_async(f, args=['bob'])
        try:
            result.get()
        except KeyboardInterrupt:
            #pass
            print 'Interrupted'
        time.sleep(1) 
```

执行时，`Pass 1`打印一次，然后打印无穷无尽的系列`hello bob`直到`CTRL+C`被按下。然后`Pass 2`得到等等，如下图：

```
Pass 1
hello bob
hello bob
hello bob
^CInterrupted
Pass 2
hello bob
hello bob
hello bob
hello bob 
```

我希望通行证与`hello bob`'s 保持平行增加。

我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T10:17:17.427

在这里你可以做什么，你可以在服务器内存下创建 Python 的多线程实现，它将独立运行，然后是服务器执行线程。将使用这背后的技巧是我们将在您需要的单击时从服务器分叉一个线程，我们会将所有服务器变量单独副本分配给新线程，以便线程将独立执行，然后在进程结束时您必须提交事务为此进程将不是主服务器进程。这里是一个小例子，你可以如何做到这一点。

```
import pprint
import pooler
from threading import Thread
import datetime
import logging
pp = pprint.PrettyPrinter(indent=4)

class myThread(Thread):
    """
    """
    def __init__(self, obj, cr, uid, context=None):
        Thread.__init__(self)
        self.external_id_field = 'id'
        self.obj = obj
        self.cr = cr
        self.uid = uid
        self.context = context or {}
        self.logger = logging.getLogger(module_name)
        self.initialize()

    """
        Abstract Method to be implemented in the real instance
    """
    def initialize(self):
        """
            init before import
            usually for the login
        """
        pass

    def init_run(self):
        """
            call after intialize run in the thread, not in the main process
            TO use for long initialization operation
        """
        pass

    def run(self):
        """
            this is the Entry point to launch the process(Thread)
        """
        try:
            self.init_run()
            #Your Code Goes Here
            #TODO Add Business Logic
            self.cr.commit()
        except Exception, err:
            sh = StringIO.StringIO()
            traceback.print_exc(file=sh)
            error = sh.getvalue()
            print error
        self.cr.close() 
```

像这样，您可以在某些模块中添加一些代码，例如（6.1 或中继中的 import_base 模块）现在接下来您可以做的是扩展实现，然后创建服务实例，或者您可以直接开始分叉，如下所示代码：

```
 service = myServcie(self, cr, uid, context)
    service.start() 
```

现在我们启动运行速度更快的后台服务，让您可以自由使用 UI。

希望这对你有帮助 谢谢

# entity-framework - EF 代码优先：手动增加一个非自动增加的字段

> ID：10896843
> 
> 赞同：0
> 
> 时间：2012-06-05T11:54:50.580
> 
> 标签：entity-framework, entity-framework-4, ef-code-first

我正在使用我们 ERP 中的现有数据库。

在我所有的数据库表中，有一个名为“r_e_c_n_o_”的浮点字段，但该字段不是由数据库自动递增的，我无法更改它。

对于所有添加的实体，我想增加这个字段“r_e_c_n_o_”，我如何在 DbContext 的 SaveChanges() 方法中完成它？

使用 ADO.NET 我会做这样的事情：

```
 public static int GetNext(string tableName, string fieldName)
    {
        var cmd = _conn.CreateCommand(string.Format("SELECT MAX({0}) + 1 FROM {1}", fieldName, tableName));
        var result = (int)cmd.ExecuteScalar();
        return result;
    } 
```

更新：请查看下面的评论，这正是我解决问题所需要的：

```
 public override int SaveChanges()
    {
        var entries = this.ChangeTracker.Entries();
        Dictionary<string, int> lastRecnos = new Dictionary<string, int>();
        foreach (var entry in entries)
        {
            var typeName = entry.Entity.GetType().Name;

            if (lastRecnos.ContainsKey(typeName))
                lastRecnos[typeName]++;
            else
                lastRecnos[typeName] = 0;//How can i get the max here?

            int nextRecnoForThisEntity = lastRecnos[typeName];

            var entity = entry.Entity as EntityBase;
            entity.Recno = nextRecnoForThisEntity;

        }
        return base.SaveChanges();
    } 
```

Tks，威廉

# jquery - JSON Internet Explorer 问题

> ID：10896844
> 
> 赞同：1
> 
> 时间：2012-06-05T11:54:50.800
> 
> 标签：jquery, json, internet-explorer, parsing

我正在使用 GalleryCMS，它为图像标题等输出 JSON 提要。使用它作为单独的脚本来解析 JSON：

```
(function( $ ) {
  $.fn.gallerycms = function( options ) {

    var settings = $.extend({
      url : '',
      theme : '',
    }, options);

    var $this = $(this);

    return this.each(function() {

      if (settings.url.indexOf('/myfeed/') > -1) {
        alert('Only album feeds are supported by Galleria.')
      } else if (settings.url.indexOf('/feed/') > -1) {
        parseAlbum();
      }

    });

    function parseAlbum() {  
      $.getJSON(settings.url, 
                function(data) {
        $.each(data.images, function(key, image) {
          $($this).append('img src=<a href="' + image.url + '"><img data-title="' + image.caption + '" src="' + image.thumb + '" /></a>');
        });

        Galleria.loadTheme(settings.theme);
        Galleria.run($this);
      });
    }

  };
})( jQuery ); 
```

在 html 文档中，我使用它来设置脚本：

```
$(document).ready(function() {
      $('#galleria').gallerycms({
        url : 'http://www.paulgubaphoto.com/GalleryCMS/index.php/api/feed/json/e2b740b7-9ab1-11e1-ae3d-0022192d6244',
        theme : '/galleria/themes/twelve/galleria.twelve.min.js'
      }); 
```

所以与 Chrome、Firefox、Safari、Mozilla 完美配合，但不喜欢 Internet Explorer。你可以在这里找到它：www.paulgubaphoto.com/index-test.html。我是初学者，所以请慢慢清楚地输入。

保罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:11:07.427

在您的 document.ready 函数调用中初始化 gallerycms 您正在使用 Web 服务 URL `http://paulgubaphoto.com/GalleryCMS/index.php/api/feed/json/3e346db5-93b0-11e1-ae3d-0022192d6244`。但是请求来自`http://www.paulgubaphoto.com/index-test.html`. IE 将“www.paulgubaphoto.com”和“paulgubaphoto.com”视为 2 个不同的站点。这意味着（至少在 IE 中）您的 Web 服务请求受制于[相同的来源策略](http://en.wikipedia.org/wiki/Same_origin_policy)（请参阅来源确定规则）并且需要使用jsonp 如果你真的在浏览器地址栏中更改 URL 的域以匹配 Web 查询 URL 的域部分，那么一切正常（至少在我的 IE9 版本上）。

为了避免需要使用 jsonp，您应该尝试如下定义您的 gallerycms Web 服务 URL：

```
$(document).ready(function() {
      $('#galleria').gallerycms({
        url : 'http://' + document.domain + '/GalleryCMS/index.php/api/feed/json/3e346db5-93b0-11e1-ae3d-0022192d6244',
        theme : '/galleria/themes/twelve/galleria.twelve.min.js'
      }); 
```

这样您就不必担心此类问题。

# controls - OpenLayers：如何禁用 DrawFeature 的 shift 键或手绘模式

> ID：10896845
> 
> 赞同：5
> 
> 时间：2012-06-05T11:54:52.803
> 
> 标签：controls, gis, openlayers

我想禁用 DrawFeature 控件的 shift 键或手绘模式。典型的代码如下所示：

```
var drawOptions = {handlerOptions: {freehand: true}};
drawFeatureControl = new OpenLayers.Control.DrawFeature(lineLayer, OpenLayers.Handler.Path, drawOptions);
map.addControl(drawFeatureControl); 
```

可以选择徒手打开。但是没有什么可以完全停用它。每次我按 shift 时都会使用手绘模式。

在我的用例中，我想将 shift 键用于另一种行为。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T13:03:28.937

请参阅[http://dev.openlayers.org/docs/files/OpenLayers/Handler/Path-js.html#OpenLayers.Handler.Path.freehandToggle](http://dev.openlayers.org/docs/files/OpenLayers/Handler/Path-js.html#OpenLayers.Handler.Path.freehandToggle)

`drawFeatureControl.handler.freehandToggle = null;`成功了。`'shiftKey'`如果您想重新启用它，请将其重置为。

# entity-framework - 使用 SQL 删除对象并更新上下文

> ID：10896850
> 
> 赞同：0
> 
> 时间：2012-06-05T11:55:31.220
> 
> 标签：entity-framework, entity-framework-4

我正在使用 EF 并且有一个上下文，我通过上下文上的 ExecuteStoreCommand 函数使用简单的 SQL 调用删除了表中的一行（出于其他原因，我必须这样做）。它工作正常，但上下文不知道发生了什么。

当我尝试提交一些更改时使用相同的上下文时，我稍后会遇到问题，因为提交没有给出预期的受影响行数。

我的问题是，用我所做的更改（已删除的行）更新上下文的最佳方法是什么。

我已经尝试获取已删除的对象并在上下文刷新函数中使用它，但它并没有真正起作用，可能是因为它（正确地）在尝试获取已删除的对象时获得了一个空引用。

```
_ctx.Refresh(RefreshMode.StoreWins, _ctx.Employees.FirstOrDefault(s => s.EmployeeId == employeeId)); 
```

此外， using`ObjectStateManager.GetObjectStateEntries`对我也不起作用，因为它不知道哪些对象已被删除。

我不想：

*   重新创建上下文。
*   刷新比我需要的更多。
*   与延迟加载混为一谈。

我只想在删除后再次更新上下文。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:46:28.537

试试这个（你必须以某种方式识别已删除的实体 - 如果你不知道你是如何完成的并且解决方案只是一个新的上下文）：

```
var employee = ctx.ObjectStateManager.GetObjectStateEntries(~EntityState.Detached)
                                     .Where(e => !e.IsRelationship)
                                     .Select(e => e.Entity)
                                     .OfType<Employee>()
                                     .FirstOrDefault(e => e...);
if (employee != null) ctx.Detach(employee); 
```

顺便提一句。不要对附加实体使用直接 SQL 修改。这是你能做的最糟糕的手术。EF 没有预料到这一点，它无法处理它。在这种情况下，最好的解决方案是重新创建上下文。

# javascript - 无需任何服务器脚本的简单 HTML POST，可以使用 JS 完成

> ID：10896854
> 
> 赞同：1
> 
> 时间：2012-06-05T11:55:43.973
> 
> 标签：javascript, html, post

我想严格使用**POST**从一个html页面传递一些文本框值到另一个......如何在不使用任何服务器端语言（如asp.net或php）的情况下做到这一点

可以使用javascript完成吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T12:17:45.023

您无法在 javascript 上以任何方式读取 POST 数据，因此这是不可行的。

在这里您可以找到类似的问题：

[http://forums.devshed.com/javascript-development-115/read-post-data-in-javascript-1172.html](http://forums.devshed.com/javascript-development-115/read-post-data-in-javascript-1172.html)

[http://www.sitepoint.com/forums/showthread.php?454963-Getting-GET-or-POST-variables-using-JavaScript](http://www.sitepoint.com/forums/showthread.php?454963-Getting-GET-or-POST-variables-using-JavaScript)

这个阅读也很有趣：[http ://en.wikipedia.org/wiki/POST_%28HTTP%29](http://en.wikipedia.org/wiki/POST_%28HTTP%29)

这特别表明了为什么这个答案（维基百科是来源）：

> GET 请求指定资源的表示。使用 GET 的请求应该只检索数据并且应该没有其他效果。（其他一些 HTTP 方法也是如此。）[1] W3C 发布了关于这种区别的指导原则，称“Web 应用程序设计应遵循上述原则，但也应遵循相关限制。”[10]请参阅下面的安全方法。
> 
> POST 将要处理的数据（例如，从 HTML 表单）提交到标识的资源。数据包含在请求的正文中。这可能导致创建新资源或更新现有资源或两者兼而有之。

**POST**数据被添加到请求中。当您执行 GET 请求时，数据会添加到 url，这就是您可以通过 javascript 访问它的原因（这就是它不被解析而您必须手动执行的原因）。相反，POST 将数据直接发送到 http 请求中，html 页面以任何方式都看不到（这只是通过 http 请求发送的内容的一部分）。

也就是说，只有服务器端语言才能接收完整的 HTTP 请求，而且绝对可以通过 javascript 访问它。

我很抱歉，但这是真正的答案

# tsql - 递归更新管理器表树

> ID：10896859
> 
> 赞同：1
> 
> 时间：2012-06-05T11:56:13.833
> 
> 标签：tsql, recursion, sql-server-2008-r2, sum, with-statement

我有一张桌子（*见图*）员工（经理是另一个经理，依此类推），id、parentid、salary、**totalsalary**。最后一个需要更新，以便每个员工都有其后代工资的总和。我已经编写了脚本，它通过 id 获取总工资，而不是更新光标中的列，但它很重......还有其他方式吗？

```
DECLARE @id INT ;
DECLARE @s INT ;
DECLARE curs CURSOR FOR
SELECT personid FROM dbo.Employees
OPEN curs ;
FETCH NEXT FROM curs INTO @id ;
WHILE @@FETCH_STATUS = 0 
    BEGIN
        WITH    Xemps ( ID )
                  AS ( SELECT   PersonID AS ID
                       FROM     dbo.Employees
                       WHERE    PersonID = @id
                       UNION ALL
                       SELECT   e.PersonID AS ID
                       FROM     dbo.Employees AS e
                                INNER JOIN Xemps AS x ON e.ManagerID = x.ID
                     )
            SELECT  @s = SUM(Salary)
            FROM    dbo.Employees
            WHERE   PersonID IN ( SELECT    id
                                  FROM      Xemps )
        UPDATE  dbo.Employees
        SET     SalarySum = @s
        WHERE   PersonID = @id
        FETCH NEXT FROM curs INTO @id
    END
CLOSE curs ;
DEALLOCATE curs ; 
```

![这是我的员工测试表](../Images/a3471f1defab92166beae047c8184b32.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T12:26:27.750

游标不是必需的，这可以只使用递归公用表表达式来完成：

```
WITH Emp AS
(   SELECT  EmployeeID, Salary, ManagerID
    FROM    dbo.Employee
    UNION ALL
    SELECT  e.EmployeeID, e.Salary, Emp.ManagerID
    FROM    dbo.Employee e
            INNER JOIN Emp
                ON e.ManagerID = Emp.EmployeeID
)
UPDATE  dbo.Employee
SET     SalarySum = COALESCE(s.Salary, 0) + e.Salary
FROM    dbo.Employee e
        LEFT JOIN 
        (   SELECT  ManagerID, SUM(Salary) [Salary]
            FROM    Emp
            GROUP BY ManagerID
        ) s
            ON s.ManagerID = e.EmployeeID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:52:30.550

创建一个函数，对作为经理的每个员工执行求和：

```
create function dbo.fn_TotalSalary    
{
  @EmployeeId int
} 
returns float
as
begin

  declare @totalSalary float

  select @totalSalary = sum(salary)
  from dbo.employees 
  where employeeid = @employeeid or managerid = @employeeid

  return @totalSalary 
end 
```

然后更改Employees表，使用以下函数将TotalSalary列更改为计算列：

```
dbo.fn_TotalSalary(EmployeeId) 
```

随着员工收入的增加，计算列将自动更新。然后你可以简单地打电话

```
select * from Employees 
```

获取详细信息。这样做意味着您的数据始终是 100% 准确和最新的，而不是潜在地检索过时的数据。

# android - Android与其他手机

> ID：10896861
> 
> 赞同：-5
> 
> 时间：2012-06-05T11:56:20.050
> 
> 标签：android

1.如何在安卓手机上升级最新版本的安卓操作系统？

2\. 安卓应用可以上传到其他手机吗？

感谢您宝贵的时间！..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T11:59:14.237

1：您无法升级您的操作系统版本，除非您的移动公司为该手机型号提供升级版操作系统。

2：您不能将您的应用程序上传到其他手机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T11:59:49.227

*是否可以将android应用程序上传到其他手机？*

不，这是不可能的，因为 Android 应用程序会生成与其他操作系统不兼容的* *.apk文件。*

# php - 在 Cocoa 中压缩 NSString 并在 PHP 中解压缩

> ID：10896864
> 
> 赞同：0
> 
> 时间：2012-06-05T11:56:23.153
> 
> 标签：php, cocoa, nsstring, compression, bzip2

我想将大型 NSStrings 从 Cocoa 发送到 PHP。

我可以使用 bzlib 库即时压缩这些字符串（因此压缩在内存中，而不是从磁盘中），然后能够在 PHP 中解压缩它们吗？

如果是，任何可用的参考代码/功能？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T17:01:53.460

您可能不想将 NSString 对象从 Cocoa 发送到 PHP。我猜您只是想将对象中的有效负载字符串从 Cocoa 应用程序发送到服务器上的 PHP 脚本，并在传输过程中压缩字符串以最小化网络带宽。一个值得称赞的目标。

在 Cocoa 端，使用[bzip2 库和相关的编程手册](http://www.bzip.org/1.0.3/bzip2-manual-1.0.3.html)来实现压缩。好消息是您应该能够使用 BZ2_bzCompressInit、BZ2_bzCompress 和 BZ2_bzCompressEnd 完全在内存中进行压缩。此外，您提到了 Cocoa 与 Cocoa Touch，但如果您打算将其提交到 App Store，请[注意这篇文章的建议并静态链接 bzip2 库](https://stackoverflow.com/questions/5124298/how-to-use-bzip2-format-in-ios-apple-tell-me-bzbufftobuffdecompress-is-private)。

在 PHP 端，请[按照此文档解压缩文件](http://php.net/manual/en/book.bzip2.php)。这里的缺点是在解压缩之前显然需要将 bzip2 字符串保存到一个临时文件中。

# algorithm - 查找两个推特用户关系的算法

> ID：10896866
> 
> 赞同：6
> 
> 时间：2012-06-05T11:56:29.077
> 
> 标签：algorithm, twitter, relationship

我有一个 6 度的 Kevin Bacon 类型问题。假设我有 2 个 twitter 用户，我想通过朋友（我用朋友来表示你关注某人而不是他们关注你）和 Twitter 中的关注者来弄清楚他们之间的关系。我的数据库中有所有的 id。

例如：

乔尔和莎莉

乔尔跟随弗雷德，后者是跟随莎莉的史蒂夫的朋友。

可能有多种方法可以到达那里，但我想要最短的。

这似乎是一个众所周知的计算机科学问题（最短路径算法）。

今天我有一个名为“影响者”的表，其中存储了我所有的 twitter id，然后我有一个 follows 表，它是一个自引用表（一侧是关注者的 ID，另一侧是朋友的 ID。）

这是图论吗？如果是这样，有人可以向我指出任何有用的实用程序/库/方法。我使用 ruby​​，但可以解析大多数语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:23:29.293

正如您所说，这是一个众所周知的问题，您可以在[Wikipedia](http://en.wikipedia.org/wiki/Shortest_path_problem)中看到。

请注意，在您的情况下，所有边的权重都等于 1)，所以我认为 Djikstra 的算法对您不会很有用。

为了找到最小距离，我建议使用广度优先搜索。问题是 Twitter 网络可能是高度连接的，因此您可能会出现组合爆炸（想象每个人都连接到其他 20 个人 - 在第一级，您将访问 20 个个人资料，而在下一个您将访问 400 个，并且在接下来的 8000 中 - 如果你没有快速找到 Sally，你很快就会耗尽内存）。

还有一个线性规划公式，我不是 100% 熟悉。[这些笔记](http://pine.cs.yale.edu/pinewiki/LinearProgramming?action=AttachFile&do=get&target=lp.pdf)很适合线性规划，但不适用于最短路径问题，而[这些](http://www.princeton.edu/~rvdb/542/lectures/lec12.pdf)笔记似乎更侧重于应用程序。

网上有一个关于这个问题的[视频讲座，看起来很完整。](http://videolectures.net/mit6046jf05_demaine_lec18/)

我希望这些参考资料有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:38:36.790

这听起来像你需要 BFS [http://en.wikipedia.org/wiki/Breadth-first_search](http://en.wikipedia.org/wiki/Breadth-first_search)

~~**在线方法：**~~ ~~我认为它可能会很昂贵，具体取决于您要如何使用它。在最坏的情况下，您将迭代数据库中的所有数据：成本运行时`O(n)`（假设您有一个查找函数可以在运行时在图中找到用户`O(1)`）。~~

**离线方法** 您可以进行离线预定预计算并将距离存储为查找函数，但它需要一些额外的内存`O(n*n)`，其中 n 是用户数。查找功能的成本现在只是`O(1)`或`O(logn)`取决于您如何实现它 *（忽略我认为将在该区域内的离线运行`O(n)`时`O(n*n)`）*。

**策略** 您要遵循的策略可能取决于您可以预期的用户数量上限以及用户之间的连接程度。如果您的用户很少，在线方法可能会很好，如果您有数百万用户，那么您可能需要离线方法，但这会花费您一些内存。

**其他注意事项**

*   线上线下相结合
*   使用缓存策略
*   每当为用户更新新参考时，更新距离查找函数

* * *

***更新的答案***有 17 个 mio。用户，我们将需要离线方法。

我会关注离线版本。您应该避免`O(n*n)`我认为可能的运行时。

**数据库模型**

您应该考虑如何对数据库进行建模，因为这将是此实现中最昂贵的部分。

可能是这样的：为每个用户创建一个表（表名可以是 userId）。每个表都有每个用户的条目（记录键是 userId）。这将导致 17 mio。有 17 米奥的桌子。每个条目（这是`O(n*n)`成本）。

**离线**运行一次 BFS，同时跟踪您访问过的用户以及您在 BFS 迭代中处于哪个级别，并保存与数据库的距离。我还没有考虑过这部分，但我认为这个策略是可行的。请记住在每个节点上运行 BFS，即，直到您访问了所有用户。如果此策略不可行，那么您可以从运行时的每个节点运行 BFS `O(n*n)`。这意味着在最坏的情况下运行可能需要一个月的时间，即您的距离数据可能是旧的。运行速度取决于您的用户的连接程度。

或者，如果可能，您可以采用“每当为用户更新新参考时，更新距离查找功能”的方法。这将运行一次 BFS `O(n)`，即几秒钟。在第一次事件时调用 BFS(userId)，然后在参考更新时调用。

**在线**您使用 userId 按表名获取表，并通过另一个 userId 获取条目以获取距离。

# dom - 如何在 CKEditor 中创建文本节点

> ID：10896871
> 
> 赞同：0
> 
> 时间：2012-06-05T11:56:49.787
> 
> 标签：dom, ckeditor

我无法在 CKEditor 中创建文本节点。请帮帮我。我试过了

```
var textNode = editor.document.text('myText'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T09:34:22.723

在不知道你打算用一个做什么的情况下，我只能这么说

```
var ele = new CKEDITOR.dom.element("p", CKEDITOR.instances.editor1.document); 
```

来源：[文档](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.dom.element.html#constructor)

# cocos2d-iphone - 从另一个类中访问数组 - cocos2d

> ID：10896872
> 
> 赞同：0
> 
> 时间：2012-06-05T11:56:59.210
> 
> 标签：cocos2d-iphone, nsmutablearray, box2d-iphone

这听起来很简单。我在一个返回自身的类 (Sprites.mm) 中填充了一个带有 PhysicsSprites 的数组（我在 init 方法 HelloWorldLayer.mm 类中对其进行了初始化）。如何在 HelloWorldLayer.mm 的更新方法中访问数组（来自 Sprites.mm）？我想在更新方法中对精灵进行一些限制。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:55:44.350

First of all you need to share the same b2World in both the classes and then you can access the Sprites.mm world.

For more understanding I've created a demo which would work. I am adding the code of the Sprites.mm code which I called as Spritese.h & Spritese.mm

The below is the Spritese.h code

```
 @interface Spritese : CCLayer {
        NSMutableArray *arrSprite;
        b2World* world;
    }
    @property (nonatomic,retain) NSMutableArray *arrSprite;
    -(id)initWithArrayOfSprites : (b2World *)_world;
    @end 
```

The Below one for the .mm

```
 @implementation Spritese
    @synthesize arrSprite;

    #define PTM_RATIO 32
    #define kTagBatchNode 1 

    -(id)initWithArrayOfSprites :(b2World *)_world{
        if((self = [super init])){
        CGSize screenSize = [CCDirector sharedDirector].winSize;
    world = _world;

    //Set up sprite

    CCSpriteBatchNode *batch = [CCSpriteBatchNode batchNodeWithFile:@"blocks.png" capacity:150];
    [self addChild:batch z:0 tag:kTagBatchNode];

    for(int i=0; i<3; i++)//creating 3 objects
            [self addNewSpriteWithCoords:ccp(screenSize.width/2, screenSize.height/2)];

    }
    return self;
}
-(void) addNewSpriteWithCoords:(CGPoint)p
{
    CCLOG(@"Add sprite %0.2f x %02.f",p.x,p.y);
    CCSpriteBatchNode *batch = (CCSpriteBatchNode*) [self getChildByTag:kTagBatchNode];

    //We have a 64x64 sprite sheet with 4 different 32x32 images.  The following code is
    //just randomly picking one of the images
    int idx = (CCRANDOM_0_1() > .5 ? 0:1);
    int idy = (CCRANDOM_0_1() > .5 ? 0:1);
    CCSprite *sprite = [CCSprite spriteWithBatchNode:batch rect:CGRectMake(32 * idx,32 * idy,32,32)];
    [batch addChild:sprite];

    sprite.position = ccp( p.x, p.y);

    // Define the dynamic body.
    //Set up a 1m squared box in the physics world
    b2BodyDef bodyDef;
    bodyDef.type = b2_dynamicBody;

    bodyDef.position.Set(p.x/PTM_RATIO, p.y/PTM_RATIO);
    bodyDef.userData = sprite;
    b2Body *body = world->CreateBody(&bodyDef);

    // Define another box shape for our dynamic body.
    b2PolygonShape dynamicBox;
    dynamicBox.SetAsBox(.5f, .5f);//These are mid points for our 1m box

    // Define the dynamic body fixture.
    b2FixtureDef fixtureDef;
    fixtureDef.shape = &dynamicBox; 
    fixtureDef.density = 1.0f;
    fixtureDef.friction = 0.3f;
    body->CreateFixture(&fixtureDef);

    [arrSprite addObject:sprite];
}

@end 
```

In the HelloWorld.h file import the Class Spritese and add

```
@property(nonatomic,retain) Spritese *sprit; 
```

and synthesize it in .mm file

Now in the init method of the HelloWorld add this code

```
sprit = [[Spritese alloc] initWithArrayOfSprites:world];
[self addChild:sprit]; 
```

And finally in the tick OR update method you need to add

```
-(void) tick: (ccTime) dt
{

    int32 velocityIterations = 8;
    int32 positionIterations = 1;
    world->Step(dt, velocityIterations, positionIterations);

    for (b2Body* b = world->GetBodyList(); b; b = b->GetNext())
    {
        if (b->GetUserData() != NULL) {
            CCSprite *myActor = (CCSprite*)b->GetUserData();

            myActor.position = CGPointMake( b->GetPosition().x * PTM_RATIO, b->GetPosition().y * PTM_RATIO);
            myActor.rotation = -1 * CC_RADIANS_TO_DEGREES(b->GetAngle());

            Spritese *s = (Spritese *)b->GetUserData();
            for(int i=0; i < [sprit.arrSprite count]; i++){
                if(s == [sprit.arrSprite objectAtIndex:i]){
                    s.position = CGPointMake( b->GetPosition().x * PTM_RATIO, b->GetPosition().y * PTM_RATIO);
                    s.rotation = -1 * CC_RADIANS_TO_DEGREES(b->GetAngle());
                    NSLog(@"Process Sprite Here");
                }
            }
        }   
    }
} 
```

I hope the code example would work at your side.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:21:52.960

在 Sprites.h 文件中创建属性

```
@property (nonatomic, readonly) NSArray* physicSprites; 
```

然后在你的 .mm 文件中

```
@synthesize physicSprites = m_physicSprites; 
```

如果您的数组实例被称为 m_physicSprites；

那么你就可以像

```
[spritesInstance physicSprites]; 
```

或者

```
spriteInstance.physicSprites 
```

# alfresco - 在 amp 文件中添加自定义模型时出错

> ID：10896873
> 
> 赞同：0
> 
> 时间：2012-06-05T11:57:01.083
> 
> 标签：alfresco

我想在 AMP 文件中添加自定义模型，但出现以下错误 -

`org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'xyz.dictionaryBootstrap' defined in class path resource [alfresco/module/xyz/context/service-context.xml]: Invocation of init method failed; nested exception is org.alfresco.service.cmr.dictionary.DictionaryException: 05050000 Could not find bootstrap model config/alfresco/module/xyz/models/xyzContentModel.xml at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1420) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456) at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)`

错误表明`xyzContentModel.xml`在给定的路径中缺少`model-context.xml`，但我已经仔细检查并在 amp 文件中，`xyzContentModel.xml`在给定的路径。

我在 Windows X64 上使用 Alfresco 4.0d 版本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T06:58:51.097

感谢您的回复，

问题出在`model-context.xml`文件中，通过`config`从 xyzContentModel.xml 的路径中删除解决了问题

将 model-context.xml 中 xyzContentModel.xml 的路径从

`config/alfresco/module/com.diipl.percept.alfresco/models/PerceptContentModel.xml`

至

`alfresco/module/com.diipl.percept.alfresco/models/PerceptContentModel.xml`

# javascript - 高分辨率图像加载中的内存问题

> ID：10896876
> 
> 赞同：0
> 
> 时间：2012-06-05T11:57:12.890
> 
> 标签：javascript, asp.net, jquery, internet-explorer-8

我有一个图片库应用程序。当用户单击图库图像的缩略图时，它将显示实际的高分辨率图像（接近 2000x1500）。为了更快地查看，我添加了图像的预加载。此应用程序中注意到的主要问题是

在 ie8 中查看实际高分辨率图像时，内存利用率显着增加。我已经在 ie8 中测试了 jQuery 灯箱插件。仍然是灯箱的问题。如何解决这个问题？它是ie8的一般问题吗？如果有任何可用的解决方案，请与我分享！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:20:12.520

如果您的图像格式是 BMP 或 PNG，则转换为 jpg，因为 BMP 和 PNG 图像大小比 JPG 大得多。我建议使用 JPG 图片

# asp.net - 检测到 ASP.NET 网页版本冲突：指定版本为“1.0.0.0”，但 bin 中的版本为“2.0.0.0”

> ID：10896878
> 
> 赞同：49
> 
> 时间：2012-06-05T11:57:24.393
> 
> 标签：asp.net, asp.net-mvc, web-config, asp.net-webpages

在今天将 ASP.NET Web Helpers Library 更新到今天显然发布的 2.0 版后，会出现此错误。我错误地更新了，但是如果可能的话，现在想解决这个问题。

> 检测到 ASP.NET 网页版本冲突：指定版本为“1.0.0.0”，但 bin 中的版本为“2.0.0.0”。要继续，请从应用程序的 bin 目录中删除文件或删除 web.config 中的版本规范。

显然这是 web.config 中的问题：

```
<add key="webpages:Version" value="1.0.0.0" /> 
```

有没有人有任何关于这个 ASP.NET Web Helpers Library 包 2.0 的信息？我找不到发行说明。Nuget网站上没有任何内容。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2013-01-08T15:45:49.973

从[检测到的 ASP.NET 网页冲突版本](https://stackoverflow.com/questions/11033669/conflicting-versions-of-asp-net-web-pages-detected)：您需要设置网页：版本 appSettings 具有适当的值。在您的情况下，它必须是 2.0.0.0

```
<appSettings>
    <add key="webpages:Version" value="2.0.0.0"/>
</appSettings> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-06T22:24:27.670

这似乎与 2012 年 6 月 5 日发布的 Microsoft.Web.Helpers 的新版本 (v.2.0) 有关。

为了避免这个问题，我首先卸载了新版本（v.2.0）：

`PM> Uninstall-Package microsoft-web-helpers`

并采用以下命令安装稳定的旧版本：

`PM> Install-Package microsoft-web-helpers -Version 1.15`

我相信（并希望）这将很快得到纠正（或正式评论）......

**更新**

如果出于任何原因您需要较旧的**System.Web.WebPages.dll**（在我的情况下，它已被新版本覆盖并且未显示在“添加引用”框中），它位于：

`C:\Program Files (x86)\Microsoft ASP.NET\ASP.NET Web Pages\v1.0\Assemblies`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-13T15:50:36.567

你可以参考这个问题来获得帮助

[无法确定要使用的 ASP.NET 网页版本](https://stackoverflow.com/questions/26763552/could-not-determine-which-version-of-asp-net-web-pages-to-use?answertab=active#tab-top)

或者您可以阅读页面中的说明

[http://www.asp.net/mvc/overview/releases/how-to-upgrade-an-aspnet-mvc-4-and-web-api-project-to-aspnet-mvc-5-and-web- api-2](http://www.asp.net/mvc/overview/releases/how-to-upgrade-an-aspnet-mvc-4-and-web-api-project-to-aspnet-mvc-5-and-web-api-2)

# ios - iOS 5.1 从文本视图拖放到表格视图

> ID：10896882
> 
> 赞同：-1
> 
> 时间：2012-06-05T11:58:03.540
> 
> 标签：ios, uitableview, uitextview

我正在开发一个 ipad 应用程序，我一直想知道是否可以从文本视图中选择文本并通过拖放将其粘贴到 uitableview 中。如果是这样，有人可以告诉我一点，以便我可以开始工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:20:11.760

一种可能有效的方法是使用触摸事件并检测您何时拖动文本视图，如果是，则将文本视图内的文本放入私有属性中，然后检测拖动何时结束并查看您是否在表格视图区域（您需要知道表格视图（CGRect）的边界。如果您在该区域，则可以将文本添加到您拥有的填充该表格视图的任何数据源，然后重新加载表格视图。

这将需要大量的试验和错误来确保触摸位置是正确的。

# java - Hibernate：更新 OneToMany 关系

> ID：10896883
> 
> 赞同：2
> 
> 时间：2012-06-05T11:58:04.653
> 
> 标签：java, hibernate

我有一个父级映射了一个子级列表。

我可以知道在更新父级时如何更新子级列表吗

例子：

父母 P1 有孩子 AB C。

我决定删除 B 并添加 D

所以父 P1 在数据库中有子 ACD。

目前我只是删除所有属于父 P1 的孩子并再次重新填充 chid(ACD) ......我相信有一种更简单的方法。

我知道这个任务非常敏感，请让我知道我需要设置什么以确保正确插入和删除孩子。

新问题：

1）有没有办法懒惰更新/删除关系？我有一个 FetchType.Lazy 列表，当我更新数据时，我可能不希望加载关系或更新它。

2) 如果列表中有项目 ABC，我删除项目 C 并执行 dto.save()。C项会被删除吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T12:13:29.603

这是使用父级更新子级的映射 -

```
@Entity
@Table(name = "COMPANY")
@SequenceGenerator(name="CompanySeq", sequenceName="COMPANYseq", allocationSize=1)
public class Company implements Serializable {

    private static final long serialVersionUID = 1L;

    /*
     * Customer Company Details 
     */

    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "CompanySeq")
    @Column(name = "COMPANY_ID")
    private Integer id;

    @Column(name="COMPANY_NAME")
    private String name;

    @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    @JoinColumn(name = "COMPANY_ID",nullable=false)
    @OrderBy(clause = "PRODUCT_NAME" )
    @ForeignKey(name = "fk_company_product")     
    private List<Product> products = new ArrayList<Product>();    

 }

 @Entity
@Table(name = "PRODUCT")
@SequenceGenerator(name="CompanyProductSeq", sequenceName="COMPANY_PRODUCT",  allocationSize=1)
public class Product implements Serializable{

    /**
     * SerialVersion ID
     */
    private static final long serialVersionUID = 4073418246832063389L;

    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "CompanyProductSeq")
    @Column(name = "PRODUCT_ID")
    private Integer id;

    @ManyToOne(fetch=FetchType.LAZY)
    @JoinColumn(name = "COMPANY_ID", updatable = false, insertable = false, nullable=false)  
    private Company companyId;

        @Column(name = "PRODUCT_NAME")
    private String name;

    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T14:29:23.513

1+ for Promod，因为他提供了非常好的代码来理解它。您想要的功能就是`Hibernate Cascade`. 通过使用级联，您只需要更新父 bean 对象及其子对象的列表，其余的将由级联完成。

```
@OneToMany(cascade = CascadeType.ALL, fetch = FetchType.EAGER)
@JoinColumn(name = "COMPANY_ID",nullable=false)
@OrderBy(clause = "PRODUCT_NAME" )
@ForeignKey(name = "fk_company_product")     
private List<Product> products = new ArrayList<Product>(); 
```

在 Pramod 给出的上例中，公司将有关产品的所有数据保留为子数据。这里

```
@OneToMany(cascade = CascadeType.ALL, fetch = FetchType.EAGER) 
```

cascadeType.All 也会对子节点执行所有父操作，即公司上的插入/更新将对产品执行相同的操作，如果要更新公司的产品，您只需使用产品（*FetchType.EAGER*）获取加载的公司 bean , 在 bean 中修改或添加新产品并保存更新公司。它也会保存/更新公司及其产品。

# html - 使用 Internet Explorer 9 时 CSS 下拉子菜单消失

> ID：10896885
> 
> 赞同：0
> 
> 时间：2012-06-05T11:58:16.703
> 
> 标签：html, css, drop-down-menu

我在 IE9 中关注网站时遇到问题。您可能会注意到，当鼠标悬停时，子菜单会消失。

vinehousefarm-farmshop.co.uk

HTML：

[http://pastebin.com/JUWsGyFM](http://pastebin.com/JUWsGyFM)

CSS：

[http://pastebin.com/yEq8MCwM](http://pastebin.com/yEq8MCwM)

提前谢谢了！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:04:19.680

问题是你的 li 上的 margin-top:4px。它会导致光标失去对锚元素的关注。您最好在子菜单中的锚点上使用 padding-top。

# openfire - Openfire - 在哪里查看离线消息

> ID：10896887
> 
> 赞同：1
> 
> 时间：2012-06-05T11:58:34.233
> 
> 标签：openfire

我想知道是否有可能看到存储的开火服务器的离线消息。有没有办法或插件来查看它们？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:08:36.937

如果您在服务器配置中启用“消息审核策略”，这是可以实现的。另请查看[“聊天和消息登录”插件](http://community.igniterealtime.org/docs/DOC-1041)列表，以获得更舒适的操作方式。

# asp.net-mvc-4 - WebAPI RC 'System.Runtime.CompilerServices.ExtensionAttribute' 来自程序集'mscorlib，

> ID：10896894
> 
> 赞同：4
> 
> 时间：2012-06-05T11:58:59.380
> 
> 标签：asp.net-mvc-4, asp.net-web-api

我有一个运行 .net4 的 webapi 应用程序，我正试图在服务器上工作。该 api 在本地运行良好。

> 无法从程序集“mscorlib，版本=4.0.0.0，文化=中性，PublicKeyToken=b77a5c561934e089”加载类型“System.Runtime.CompilerServices.ExtensionAttribute”。

我需要改变什么才能让它在我的服务器上工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T15:53:19.303

您确定您是针对 .NET 4 而不是 .NET 4.5 进行编译的吗？我们在 .NET 4.5 中将 ExtensionAttribute 移至 mscorlib（因此我们可以将扩展方法放在 mscorlib 中）。如果您针对 .NET 4.5 编译某些内容并尝试在 .NET 4 上运行它，我预计会看到这样的错误。

编辑：实际上，如果您使用 ILMerge，则需要在 targetplatform 开关中使用 .NET 4.0 引用程序集的路径，而不是实现的路径，如本博文所述：[http://www.mattwrock .com/post/2012/02/29/What-you-should-know-about-running-ILMerge-on-Net-45-Beta-assemblies-targeting-Net-40.aspx](http://www.mattwrock.com/post/2012/02/29/What-you-should-know-about-running-ILMerge-on-Net-45-Beta-assemblies-targeting-Net-40.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T23:01:41.493

另一种可能的解决方案（其他有相同的例外）可能是您的构建服务器没有 .net 4.0 参考程序集，在安装 .net 4.5 后，您需要从您的开发框中复制它们。

这些通常是这样的：

C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0

有关更多详细信息，请参阅[Marc 的博客文章](http://marcgravell.blogspot.co.nz/2012/09/iterator-blocks-missing-methods-and-net.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-18T13:33:37.930

I had the same issue and fixed by creating a new application pool for my site after installing .NET Framework 4.5

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-19T17:02:56.153

我对 .NET 的经验很少，我对 .NET 也有同样的问题`System.Runtime.CompilerServices.ExtensionAttribute`。

**解决方案：**删除项目引用，对 Framework 4.5 的引用，因为在我的情况下，因为我没有安装这个框架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T20:02:38.427

还要检查您的项目所依赖的 DLL。我遇到了同样的问题，发现一个 DLL 导致了这个问题。此 DLL 是我的本地计算机上的旧版本（为 .NET 4.0 编译），站点通过 localhost 运行良好，但在站点失败的实时服务器上是较新的版本（为 .NET 4.5 编译）。

# python - 多个线程在单个 Grinder 脚本中执行不同的操作

> ID：10896895
> 
> 赞同：0
> 
> 时间：2012-06-05T11:59:08.050
> 
> 标签：python, jython, grinder

我想创建一个脚本，如果正在执行 http 请求，例如，我使用我的代码中定义的 http 操作 Play() 播放了语音文件。在播放文件的同时，我希望调用 Pause() 操作，它可以暂停正在播放的文件。

我面临的问题是，由于对 PLAY 的 HTTP 请求被命中，脚本仅在 PLAY() 执行成功/失败后才取回控制权，即当完成播放操作时，由于我的暂停操作返回失败，因为当前没有正在播放的文件。

我不能使用 2 个脚本，因为它们都使用相同的数据（Call-ID）

对此的任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T19:58:21.343

更多细节会有所帮助。线程在构造有效的暂停请求之前需要哪些信息？发送播放请求的线程能否将这些信息写入某个模块级数据结构？然后执行暂停的线程可以读取此信息并构建有效请求。

# python - python中的urllib.quote点字符（。）

> ID：10896896
> 
> 赞同：1
> 
> 时间：2012-06-05T11:59:10.550
> 
> 标签：python, urllib

我正在尝试在 python 中使用`urllib.quote`DOT 字符`(.)`，但没有得到我想要的输出。

```
>>> urllib.quote(".")
'.'
>>> urllib.quote_plus(".")
'.' 
```

但是当我取消引用时`%2E`，`urllib.unquote`我得到

```
>>> urllib.unquote("%2E")
'.' 
```

`%2E`所以，我的问题是为什么我在使用`quote or quote_plus`on时无法获得输出`.`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T12:00:02.157

点不需要转义。但是，`unquote`转换所有`%xx`字符，因为对任何字符进行编码都是完全有效的，无论是否必要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T12:19:50.947

参考链接是 [http://docs.python.org/library/urllib.html](http://docs.python.org/library/urllib.html) '_.-' 不需要引用。

# android - 没有 onLocationChanged 的 Android 位置信息

> ID：10896911
> 
> 赞同：0
> 
> 时间：2012-06-05T12:00:11.280
> 
> 标签：android, location

我正在编写一个简单的服务来监听位置变化。在我的 onStart 方法中，我有以下内容

```
 lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    locationListener = new MyLocationListener();
    lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationListener); 
```

然后在 onLocationChanged(Location loc) 方法中处理服务如何对更改做出反应。

但是我想在服务启动时获取初始位置。假设位置信息没有任何变化，我想在服务启动时至少使用一次位置信息，即使位置没有改变。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:04:12.347

在这里使用`getLastKnownLocation`。

以下代码段将为您提供帮助。

```
LocationManager lm = (LocationManager)act.getSystemService(Context.LOCATION_SERVICE);
Criteria crit = new Criteria();
crit.setAccuracy(Criteria.ACCURACY_FINE);
String provider = lm.getBestProvider(crit, true);
Location loc = lm.getLastKnownLocation(provider); 
```

# css - 如何使用 CSS3 制作这种类型的边框？

> ID：10896914
> 
> 赞同：3
> 
> 时间：2012-06-05T12:00:21.050
> 
> 标签：css

是否可以使用 CSS3 制作这种类型的边框？

![在此处输入图像描述](../Images/ca34baa439927251a17d8b1390d48dc7.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:46:17.087

有可能，您需要使用图像和边框图像属性。

[http://www.w3.org/TR/css3-background/#the-border-image](http://www.w3.org/TR/css3-background/#the-border-image)

[http://css-tricks.com/understanding-border-image/](http://css-tricks.com/understanding-border-image/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T13:54:05.420

我测试了一个 hack 来做这个，两个 div 第一个用背景线性渐变制作边框。第二个用于放置您的内容。

这是我的 CSS 片段：

```
div {
    background-color: gray;
    width: 200px;
    height: 200px;
}
.border {
    background-image: -webkit-linear-gradient(45deg, white 25%, transparent 25%, transparent 75%, white 75%, white ), 
    -webkit-linear-gradient(-45deg, white 25%, transparent 25%, transparent 75%, white 75%, white );
    background-size: 10px 10px;
    padding:5px;
} 
```

你可以看看我的小提琴：http: [//jsfiddle.net/DoubleYo/zSnDG/1/](http://jsfiddle.net/DoubleYo/zSnDG/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T04:24:10.860

这是关于border-image 属性的好读物。

[http://ejohn.org/blog/border-image-in-firefox/](http://ejohn.org/blog/border-image-in-firefox/)

# c++ - 内置素数检查功能

> ID：10896915
> 
> 赞同：11
> 
> 时间：2012-06-05T12:00:21.570
> 
> 标签：c++

C++ 是否有任何内置函数来检查数字是否为素数。如果是，那么在哪个图书馆？

下面是我的实现。但只是在寻找是否有任何内置功能。在 Google 上搜索只是提供基于用户的实现。

```
int isprime(int N){
    if(N<2 || (!(N&1) && N!=2))
        return 0;
    for(int i=3; i*i<=N; i+=2){
        if(!(N%i))
            return 0;
    }
    return 1;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T12:00:55.610

不，没有检查素数的内置函数。

您发布的解决方案可以改进：`i*i`如果您只计算一次的平方根，则可以避免`N`。

如果您知道要检查的数字范围，可以使用筛子和地图，以免重复计算 - [http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-05T12:01:28.047

简短的回答：不，没有这样的功能。

唯一一次在标准中使用“prime”一词是 26.5.3.2 中的脚注，这`mersenne_twister_engine`是描述类模板的地方。脚注说：

> 274）这个引擎的名称部分地指代它的周期属性：对于正确选择的参数值，周期与一个大的梅森素数密切相关。

如果存在这样的函数，则标准将包含该词的更多出现，因为它将使用它来描述该函数的行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T12:15:28.973

没有 C++“内置”功能，但您可以使用元编程以编译时效率解决这个问题。

```
template <int i>
struct D
{
    D(void *);
    operator int();
};

template <int p, int i>
struct is_prime
{
    enum { prim = (p%i) && is_prime<(i>2?p:0), i>::prim };
};

template <int i>
struct Prime_print
{
    Prime_print<i-1>    a;
    enum { prim = is_prime<i,i-1>::prim };
    void f() { D<i> d = prim; }
};

struct is_prime<0,0> { enum { prim = 1 }; };
struct is_prime<0,1> { enum { prim = 1 }; };
struct Prime_print<2>
{
    enum { prim = 1 };
    void f() { D<2> d = prim; }
};

void foo()
{
    Prime_print<10> a;
} 
```

希望能帮助到你

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-16T07:34:41.073

广泛可用的 GMP 库具有用于概率素数测试的快速功能，请参阅[https://gmplib.org/manual/Number-Theoretic-Functions.html](https://gmplib.org/manual/Number-Theoretic-Functions.html)

只需转换您的整数，示例代码：

```
bool is_prob_prime(long l)
{
    mpz_t bigint;
    mpz_init_set_si(bigint, l);
    bool ret = mpz_probab_prime_p(bigint, 25) > 0;
    mpz_clear(bigint);
    return ret;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-05T10:10:44.710

```
template <size_t upper_limit> class prime_table final {
public:
  static_assert(upper_limit >= 2, "upper_limit too tiny");
  prime_table() {
    table_.set();
    table_.reset(0);
    table_.reset(1);

    size_t root = size_t(std::sqrt(upper_limit)) + 1;
    for (size_t pos = 2; pos <= root; ++pos) {
      for (size_t multiplier = 2; pos * multiplier <= upper_limit;
           ++multiplier) {
        table_.reset(pos * multiplier);
      }
    }
  }

  inline bool is_prime(size_t value) { return table_.test(value); }

protected:
  std::bitset<upper_limit + 1> table_;
}; 
```

它会生成一个素数表，然后您可以使用 is_prime() 来测试范围 [0, upper_limit] 内的数字

# objective-c - 未知的崩溃，信息量不大的堆栈跟踪 (iOS)

> ID：10896916
> 
> 赞同：3
> 
> 时间：2012-06-05T12:00:22.120
> 
> 标签：objective-c, xcode

我们制作了一个崩溃日志系统，可以记录所有崩溃并让服务器存储它们。我们遇到了很多崩溃，但我们不知道是什么原因造成的。游戏已经运行了几个月，我们从未在游戏运行（调试、开发阶段等）时看到任何此类崩溃。

奇怪的是，我们得到了一堆这样的错误。我尝试在代码中查看它们，但似乎它们都还好。如果不是，它应该立即崩溃。

我们唯一得到的是一个信息量不大的堆栈跟踪。我们无法从堆栈跟踪中获得任何线索，因为它不包含我们的代码中的任何内容。

我想知道为什么会发生这种崩溃以及为什么它只给我这个堆栈跟踪。我在下面发布了崩溃日志。谢谢。

```
+++++++++++++++++++++++++++++++++++++++++++
#1 - Mutating method sent to immutable object (Dictionary)

-[__NSCFDictionary removeObjectForKey:]: mutating method sent to immutable object
(

    \4   libc++abi.dylib                     0x30e093c5 _ZL19safe_handler_callerPFvvE + 76\"
    \"5   libc++abi.dylib                     0x30e09451 _ZdlPv + 0\"
    \"6   libc++abi.dylib                     0x30e0a825 __cxa_current_exception_type + 0\"
    \"7   libobjc.A.dylib                     0x3687d2a9 objc_exception_rethrow + 12\"
    \"8   CoreFoundation                      0x353ac50d CFRunLoopRunSpecific + 404\"
};

+++++++++++++++++++++++++++++++++++++++++++
#2 - Inserting nil object in array

*** -[__NSArrayM insertObject:atIndex:]: object cannot be nil
(

    \4   libc++abi.dylib                     0x380eb3c5 _ZL19safe_handler_callerPFvvE + 76\"
    \"5   libc++abi.dylib                     0x353e5451 _ZdlPv + 0\"
    \"6   libc++abi.dylib                     0x353e6825 __cxa_current_exception_type + 0\"
    \"7   libobjc.A.dylib                     0x35d1b2a9 objc_exception_rethrow + 12\"
    \"8   CoreFoundation                      0x3776b50d CFRunLoopRunSpecific + 404\"
};

+++++++++++++++++++++++++++++++++++++++++++
#3 - Array out of bounds

*** -[__NSArrayI objectAtIndex:]: index 1 beyond bounds [0 .. 0]
(

    \4   libc++abi.dylib                     0x353e53c5 _ZL19safe_handler_callerPFvvE + 76\"
    \"5   libc++abi.dylib                     0x353e5451 _ZdlPv + 0\"
    \"6   libc++abi.dylib                     0x353e6825 __cxa_current_exception_type + 0\"
    \"7   libobjc.A.dylib                     0x35d1b2a9 objc_exception_rethrow + 12\"
    \"8   CoreFoundation                      0x3776b50d CFRunLoopRunSpecific + 404\"
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:21:31.243

它看起来像一个未经处理的 Objective-C 异常，它被运行循环重新抛出并最终调用`terminate`. 这会丢失堆栈回溯信息。

您如何记录应用程序崩溃？我假设您还没有使用[NSSetUncaughtExceptionHandler](http://developer.apple.com/library/mac/documentation/cocoa/reference/foundation/miscellaneous/foundation_functions/reference/reference.html#//apple_ref/c/func/NSSetUncaughtExceptionHandler)注册自己的异常处理程序？这将允许您检查堆栈以找到问题的真正原因。周围有符号化堆栈转储的脚本 - 请查看 Apple 文档以获取详细信息。

这是一个非常相似的问题：

*   [通过 HockeyApp 更新应用程序后启动时应用程序崩溃](https://stackoverflow.com/questions/7477345/app-crashes-when-launching-after-updating-app-via-hockeyapp)

# php - PHP mysql_query 嵌套循环或重复引用

> ID：10896928
> 
> 赞同：0
> 
> 时间：2012-06-05T12:01:02.173
> 
> 标签：php, mysql, if-statement, while-loop

我有一个相对简单的程序，它显示用户的信息和活动——由于程序的架构需要以不同的方式引用大量不同的数据。

例如，我有一个用户可以在不同或多个组中具有不同级别的状态，这些组可以有自己的状态。**我的问题是关于引用大量数据的最佳实践以及代码的速度/逻辑。**

*   选项 A - 在数据库中有多个实例数据，并使用简单的语句和查询在多个表上单独引用并更新它。
*   选项 B - 使用许多嵌套查询和 if 语句来检索多位数据

简单地说：**最好在循环和 if 语句中使用大量嵌套查询，还是在数据库中分解不同的数据集并单独引用它们？**我追求的是可靠性和速度，而不是技术魔法。

我知道这可能对我的程序非常具体，但我想知道那里的开发人员的一般意见和他们的经验，而不是深入研究示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:03:50.897

由于在操作过程中生成的临时表很重，连接可能会很昂贵。但在这种情况下，准确的数据提取可能更合乎逻辑。它非常依赖于您的数据模型、表、引用、插入率、更新率、表上的查询率。也许有些查询应该使用连接编写，也许其中一些最好使用过程编写。

# codeigniter - 如何在 codeigniter 2.1.0 中创建验证码

> ID：10896932
> 
> 赞同：1
> 
> 时间：2012-06-05T12:01:27.217
> 
> 标签：codeigniter, captcha, helper

如何在 codeigniter 2.1.0 加载帮助程序 codeigniter 中创建验证码？当我有模型 m_captcha 时：

```
 function __construct()
{
            parent::__construct();
}

    function setCaptcha()
    {
            $this->load->helper('captcha');
            $vals = array(
                'img_path'          => './asset/captcha',
                'img_url'           => base_url().'/asset/captcha',
                'expiration'        => 3600,// one hour
                'font_path'     => './system/fonts/georgia.ttf',
                'img_width'     => '140',
                'img_height'        => 30,
                'word'          => random_string('numeric', 6),
                );

            $cap = create_captcha($vals);
            if ($cap)
            {
                    $capdb = array(
                        'captcha_id'        => '',
                        'captcha_time'      => $cap['time'],
                        'ip_address'        => $this->CI->input->ip_address(),
                        'word'              => $cap['word']
                    );
                    $query = $this->db->insert_string('captcha', $capdb);
                    $this->db->query($query);
            }else {
                            return "Captcha not work" ;
                     }

                return $cap['image'] ;
} 
```

我有控制器 c_login ：

```
 function __construct()
{
    parent::__construct();
    $this->load->model('m_captcha');
}   

    public function index()
    {
          $this->load->helper('captcha');
          $data = $this->m_captcha->setCaptcha();                            
          $this->load->view('login/v_form',$data);                        
    } 
```

我有看法：

```
<?php echo form_open('c_login'); ?>
 <?php echo  $cap['image']; ?>
<?php echo form_error('captcha');?>
<?php echo form_close(); ?> 
```

为什么验证码无法显示？在 sms/asset/captcha 中定位文件夹和图像验证码。sms 是文件夹根 Codeigniter。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:27:14.097

`<?php echo $cap['image']; ?>`是问题所在。

让我们再次检查流程，您将返回`$cap['image']`from 模型。

之后，您`$data`在控制器中接受了它。

它必须是某种东西`$data['capcha']`，以便您可以使用`$capcha`in view 访问它。

非常简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T15:12:58.633

为什么不使用 reCaptcha 代替？[http://codeigniter.com/wiki/ReCAPTCHA](http://codeigniter.com/wiki/ReCAPTCHA) 很容易实现！

# javascript - 网络中的社区/集群检测算法 - 用 javascript 实现？

> ID：10896936
> 
> 赞同：6
> 
> 时间：2012-06-05T12:01:39.203
> 
> 标签：javascript, graph, social-networking, cluster-analysis

我正在寻找在 javascript 中实现社区检测算法。鲁汶算法，或任何其他都可以。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-02-12T13:55:57.290

最近在 JavaScript 中实现了[Louvain 社区检测](https://sites.google.com/site/findcommunities/)，在某种程度上它很容易与 D3.js 一起使用：

*   [https://github.com/upphiminn/jLouvain](https://github.com/upphiminn/jLouvain)

作为旁注，因为我没有意识到这一点，我为我的项目[TagOverflow](http://stared.github.io/tagoverflow/)编写了一个贪婪的模块化最大化（另见[一些描述](https://github.com/stared/tagoverflow#methods-and-tricks)）。它工作得很好（见下面的例子），但这`jLouvain`既是一个更好的算法，也是一个更好的实现。

![在此处输入图像描述](../Images/bf00bc25e02fecc8e75bdde5f49ed77c.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:31:06.867

你看过这个[吗](http://harthur.github.com/clusterfck/)？

clusterfck 是一个用于层次聚类的 JavaScript 库。聚类用于将相似的项目组合在一起。当需要项目的层次结构或事先不知道集群的数量时，尤其会使用层次聚类

# android - Android相机预览教程

> ID：10896940
> 
> 赞同：5
> 
> 时间：2012-06-05T12:01:54.693
> 
> 标签：android, camera, preview

我遵循的教程有一个小问题。我想制作一个带有相机预览的android应用程序，但直到现在我还没有找到任何好的教程来展示如何做到这一点。这是链接[教程](http://www.java2s.com/Code/Android/Hardware/CameraWithIntent.htm) 如果我可以使用“相机预览”的“有意图的相机”，我不太确定？我该怎么办。

谢谢 ：）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-05T12:06:52.800

下面的教程会帮助你。

[http://www.vogella.com/articles/AndroidCamera/article.html](http://www.vogella.com/articles/AndroidCamera/article.html)

[http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/graphics/CameraPreview.html](http://developer.android.com/resources/samples/ApiDemos/src/com/example/android/apis/graphics/CameraPreview.html)

调用内置相机意图以获取图片。

```
public class demo extends Activity {

Button ButtonClick;
int CAMERA_PIC_REQUEST = 1337; 

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    ButtonClick =(Button) findViewById(R.id.Camera);
    ButtonClick.setOnClickListener(new OnClickListener (){
        @Override
        public void onClick(View view)
        {
            Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
            // request code

            startActivityForResult(cameraIntent, CAMERA_PIC_REQUEST);

        }
    });

}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) 
{
    if( requestCode == 1337)
    {
    //  data.getExtras()
        Bitmap thumbnail = (Bitmap) data.getExtras().get("data");

          Now you have received the bitmap..you can pass that bitmap to other activity
          and play with it in this activity or pass this bitmap to other activity
          and then upload it to server.
    }
    else 
    {
        Toast.makeText(demo.this, "Picture NOt taken", Toast.LENGTH_LONG);
    }
    super.onActivityResult(requestCode, resultCode, data);
}
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-10T14:06:23.370

我目前正在开发[CameraPreviewSample](https://github.com/pikanji/CameraPreviewSample)项目的[一个分支。](https://github.com/hanscappelle/CameraPreviewSample)这个例子的好处是 github 源代码被标记为使相机预览工作所需的几个步骤。

因此，如果您正在研究在多个标签上运行（查看自述文件了解详细信息）可能是一个好主意。

另一个很好的资源是来自 Google 的培训文章。对于摄像头，最好[阅读有关摄像头控制的 Android 培训文章](http://developer.android.com/training/camera/index.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-04-29T06:47:33.770

## 不推荐直接使用`SurfaceView`or `TextureView`，而是使用PreviewView。

作为`PreviewView`CameraX Jetpack 库的一部分，通过在各种 Android 设备上提供对开发人员友好、一致且稳定的 API，开发人员可以更轻松地显示相机预览。

在 xml

```
<androidx.camera.view.PreviewView
android:layout_width="match_parent"
android:layout_height="match_parent"
app:scaleType="fitCenter" /> 
```

在您的代码中，

```
// Create a preview use case instance
val preview = Preview.Builder().build()

//camera selector
val cameraSelector : CameraSelector = CameraSelector.Builder()
      .requireLensFacing(CameraSelector.LENS_FACING_BACK)
      .build()

// Bind the preview use case and other needed user cases to a lifecycle
val camera = cameraProvider.bindToLifecycle(this as LifecycleOwner, cameraSelector, preview)

// Create a surfaceProvider using the bound camera's cameraInfo
val surfaceProvider = previewView.createSurfaceProvider(camera.cameraInfo)

// Attach the surfaceProvider to the preview use case to start preview
preview.setSurfaceProvider(surfaceProvider) 
```

[请参阅此处](https://developer.android.com/training/camerax/preview)的完整文档。

# internet-explorer - 提示时如何让用户取消 Chrome Frame 安装

> ID：10896942
> 
> 赞同：0
> 
> 时间：2012-06-05T12:01:56.207
> 
> 标签：internet-explorer, google-chrome-frame

我正在使用谷歌的默认 CFInstall 脚本（有一些小的改动）：

```
<style>
 .chromeFrameInstallDefaultStyle {
   width: 80%; /* default is 800px */
   border: 5px solid blue;
   position: absolute;
   left: 40%;
   z-index: 1000;
 }
</style>

<div id="prompt">
 <!-- if IE without GCF, prompt goes here -->
</div>

<script>
 // The conditional ensures that this code will only execute in IE,
 // Therefore we can use the IE-specific attachEvent without worry
 window.attachEvent("onload", function() {
   CFInstall.check({
     mode: "inline", // the default
     node: "prompt"
   });
 });
</script> 
```

这会提示 IE8 或更低版本的用户安装 Chrome Frame。但用户无法取消或关闭 iFrame。我怎样才能做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:11:18.993

好的，我明白了：我需要将模式设置为“叠加”：这有一个缺点：刷新页面后对话框不会重新出现。

```
<style>
 .chromeFrameInstallDefaultStyle {
   width: 80%; /* default is 800px */
   border: 5px solid blue;
   position: absolute;
   left: 40%;
   z-index: 1000;
 }
</style>

<div id="prompt">
 <!-- if IE without GCF, prompt goes here -->
</div>

<script>
 // The conditional ensures that this code will only execute in IE,
 // Therefore we can use the IE-specific attachEvent without worry
 window.attachEvent("onload", function() {
   CFInstall.check({
     mode: "overlay", // "inline" = the default
     node: "prompt"
   });
 });
</script> 
```

# matlab - 居中裁剪或填充框架内的图像

> ID：10896943
> 
> 赞同：4
> 
> 时间：2012-06-05T12:02:10.777
> 
> 标签：matlab, image-processing

我的问题是关于一个很容易解决的问题，但我有兴趣学习最佳实践。（名义上适用于 Matlab，但不是真正特定于语言的）。

我正在加载任意大小的图像，我需要使其适合（不进行任何缩放或更改纵横比）在预定义大小的黑色图像中（我们称之为框架）。加载的图像可以在任一维度或两个维度上小于、等于或大于预定义帧。

如果图像小于框架，我希望它用零填充（周围会有黑色边框），直到框架大小，并居中。如果它更大，我想以居中的方式裁剪它。

理想情况下，我不想对任一维度中像素数的奇偶性做出任何假设——也就是说，加载的图像和帧都可以在两个维度上具有奇数或偶数像素数。肯定会有一些四舍五入的事情要做。

我确信这个问题已经被研究、解决和用尽了，所以对于有一些图像处理经验的知识渊博的程序员来说，这应该不是一个很难的问题:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T14:37:34.037

这应该适用于比框架更小、相等和更大的灰度和彩色图像。试图保持它的可读性。

```
frameWidth = 800;
frameHeight = 600;
imagepath = 'smaller.jpg'; % 'equal.jpg', 'larger.jpg'

img = im2double(imread(imagepath));
[imgHeight, imgWidth, channels] = size(img);
frame = zeros(frameHeight, frameWidth, channels);

dImageWidth = round((frameWidth - imgWidth)/2);
dImageHeight = round((frameHeight - imgHeight)/2);

unEqualHeight = (imgHeight ~= frameHeight);
unEqualWidth = (imgWidth ~= frameWidth);

if imgHeight <= frameHeight
    frameVStart = max(1, dImageHeight);
    frameVEnd = min(frameHeight, frameHeight-dImageHeight-unEqualHeight);
    imgVStart = 1;
    imgVEnd = imgHeight;
else
    frameVStart = 1;
    frameVEnd = frameHeight; 
    imgVStart = max(1, -dImageHeight);
    imgVEnd = min(imgHeight, imgHeight+dImageHeight);
end

if imgWidth <= frameWidth
    frameHStart = max(1, dImageWidth);
    frameHEnd = min(frameWidth, frameWidth-dImageWidth-unEqualWidth);
    imgHStart = 1;
    imgHEnd = imgWidth;
else
    frameHStart = 1;
    frameHEnd = frameWidth; 
    imgHStart = max(1, -dImageWidth);
    imgHEnd = min(imgWidth, imgWidth+dImageWidth);
end

frame(frameVStart:frameVEnd, frameHStart:frameHEnd, :) = ...
    img(imgVStart:imgVEnd, imgHStart:imgHEnd, :);

imshow(frame); 
```

# c# - Excel工作簿输入的奇怪错误

> ID：10896947
> 
> 赞同：4
> 
> 时间：2012-06-05T12:02:17.590
> 
> 标签：c#, visual-studio-2010, excel, excel-interop

对于当前代码：

```
 String currentPath = Directory.GetCurrentDirectory();

        OpenFileDialog op = new OpenFileDialog();
        op.InitialDirectory = currentPath;
        if (op.ShowDialog() == DialogResult.OK)
            currentPath = op.FileName;
        else
        {
            toolStripStatusLabel1.Text = "Failed to Load Workbook";
            toolStripStatusLabel1.Visible = true;
        }

        Workbook wb = new Workbook(excel.Workbooks.Open(currentPath)); 
```

我收到错误：

System.Runtime.InteropServices.COMException 未处理消息=检索具有 CLSID {00020819-0000-0000-C000-000000000046} 的组件的 COM 类工厂失败，原因是以下错误：80040154 未注册类（来自 HRESULT 的异常：0x80040154（REGDB_E_CLASSNOTREG） ））。源=mscorlib 错误代码=-2147221164

我想要的只是一个预定义的工作簿来添加工作表

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-05T14:13:08.640

我想在您的代码中，Workbook 的全名是 Microsoft.Office.Interop.Excel.Workbook，而该 excel 是 Microsoft.Office.Interop.Excel.Application 的一个实例。

如果是这种情况，您的代码将无法工作，因为 Workbook 是一个接口，而接口没有构造函数。您必须要求 excel 应用程序为您创建工作簿，在您的情况下，您只需编写：

```
Workbook wb = excel.Workbooks.Open(currentPath); 
```

以类似的方式，如果要创建一个新的空工作簿，则应编写：

```
Workbook wb = excel.Workbooks.Add(System.Reflection.Missing.Value); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T12:06:04.230

我不知道你的错误，但我做了类似这样的事情：

```
 _app = new Excel.Application();
Excel.Workbook wb = _app.Workbooks.Open(currentPath); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-20T02:23:35.157

右键单击您的解决方案并将平台更改为 x86 重建您的解决方案...祝您好运！

# jquery - CSS & jQuery：幻灯片不...滑动

> ID：10896948
> 
> 赞同：0
> 
> 时间：2012-06-05T12:02:20.083
> 
> 标签：jquery, html, css

当我试图在 CSS 和 jQuery 的帮助下制作幻灯片时（实际上是从教程中撕下来的..），我意识到只有最后一张图片正在显示，而且幻灯片没有“旋转”
我有 css：

```
#home{
    color: #e3e3e3;
    margin: 0 auto;
    height: 30%;
    width: 30%;
    position: relative;
    top: 5%;
    opacity: 1;
    text-align: justify;}
#slideshow {
    margin: 0px auto;
    position: relative;
    top: 2%;
    width: 500px;
    height: 350px;
    padding: 5px;
    box-shadow: 0 0 20px rgba(0,0,0,0.4);}
#slideshow > div {
    position: absolute;
    top: 10px;
    left: 10px;
    right: 10px;
    bottom: 10px;} 
```

jQuery：

```
$(document).ready(function(){
  $("#slideshow > div:gt(0)").hide();
  setInterval(function() {
    $("#slideshow > div:first")
      .fadeOut(1000)
      .next()
      .fadeIn(1000)
      .end()
      .appendTo("#slideshow");
  },3000);
} 
```

和 html ：

```
<div id="home">
<div id="slideshow">
<div>
    <img src="./images/mulsanne.jpg" title="Black Mulsanne by ProTech" alt="Black Mulsanne" style="height:350px;width=500px"/>
</div>
<div>
    <img src="./images/murcielago.jpg" title="Orange Lamborghini Murcielago by ProTech" alt="Orange Murcielago" style="height:350px;width=500px"/>
</div>
<div>
    <img src="./images/BrabusK8.jpg" title="Black Brabus K8 by ProTech" alt="Black K8" style="height:350px;width=500px"/>
</div>
<div>
    <img src="./images/superleggera.jpg" title="Grey Lamborghini Superleggera by ProTech" alt="Grey Superleggera" style="height:350px;width=500px"/>
</div>
<div>
    <img src="./images/slr.jpg" title="Black Mercedes SLR by ProTech" alt="Black SLR" style="height:350px;width=500px"/>
</div>
</div>
<br>
Represented in more than XX countries, and exclusive distributor in Kazakhstan since 2009, ProTech's aim is to offer the best services in terms of car paint protection and windows enhancements, with exclusive Kevlar-coated films with various effects.<br>
Find more about us by clicking on the 2 buttons on the left side of this webpage !
</div> 
```

（最后几行文字在幻灯片下方，只是为了向您展示我有一个 div id'ed "#home" 的原因）

知道为什么这不起作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:20:52.333

您的代码似乎在这里工作正常[http://jsfiddle.net/yRJ2e/](http://jsfiddle.net/yRJ2e/)

您的图像标签样式中有语法错误 - 宽度使用“=”并且应该是“：”

```
 style="height:350px;width=500px" 
```

应该：

```
 style="height:350px;width:500px" 
```

# javascript - 使用 javascript 的可拖动 DIV

> ID：10896949
> 
> 赞同：3
> 
> 时间：2012-06-05T12:02:21.223
> 
> 标签：javascript, jquery

我想制作 Draggable div 我知道这可以使用 Jquery 插件来完成，但我不想使用，因为我只需要可拖动的功能。那么我怎样才能使我做到这一点的可拖动功能

```
$(document).ready(function(e){
                $("#eve").mousemove(function(e){
                    var p=$(this);
                    var offset = p.offset();
                    var ol=offset.left;
                    var ot=offset.top;
                    var l=e.pageX-ol;
                    var t=e.pageY-ot;
                    var eX=e.pageX;
                    var eY=e.pageY;
                    var htm="left:"+ol+" top:"+ot+"<br/>";
                    htm+="eX:"+eX+" eY:"+eY+"<br/>";
                    htm+="curX:"+l+" curY:"+t+"<br/>";
                    htm+="l:"+(ol-l)+" t:"+(ot-t);
                    p.html(htm);
                   p.css({left:((eX-3))+"px",top:((eY-3))+"px"});
                }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T12:16:43.573

这是我的快速即兴创作。也许这正是您正在寻找的。

```
$("div").on({
    mousemove: function(e) {
        var el = $(this);
        var data = el.data("down");
        if (data) {
            el.css({
                left: e.pageX - data.left,
                top: e.pageY - data.top
            });
        }
    },
    mousedown: function(e) {
        var el = $(this);
        var pos = el.offset();
        el.data("down", {
            left: e.pageX - pos.left,
            top: e.pageY - pos.top
        });
    },
    mouseup: function() {
        $(this).data("down", false);
    }
});​ 
```

**演示：http:** [//jsfiddle.net/UBKBb/](http://jsfiddle.net/UBKBb/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:06:09.897

您需要定义多个函数来处理`mousedown`开始拖动、`mouseup`停止拖动以及适当`mousemove`处理拖动时的运动的事件，检查我发现的这个要点[https://gist.github.com/1330150](https://gist.github.com/1330150)

# c# - 在 Windows 8 Metro 应用程序中禁用鼠标悬停焦点

> ID：10896955
> 
> 赞同：2
> 
> 时间：2012-06-05T12:02:53.090
> 
> 标签：c#, xaml, windows-8

我正在这个应用程序中处理window8 metro 应用程序我正在插入两个图像按钮，在模拟器中我是鼠标模式指针，这次输入了焦点。

我正在实现此代码...

```
 private void button_PointerEntered(object sender, Windows.UI.Xaml.Input.PointerEventArgs e)
 {
     System.Diagnostics.Debug.WriteLine("Pointer Entered");
     Button thisButton = (Button)sender;
     thisButton.Focus(FocusState.Unfocused);
 } 
```

如何禁用鼠标指针输入的焦点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:06:22.147

我还没有使用 Windows 8 Metro，但您可以尝试添加以下内容：

```
<Setter Property="FocusVisualStyle" Value="{x:Null}" /> 
```

这应该停止对鼠标悬停和诸如此类的任何可视化，但这是一个 WPF 答案，它应该适用于 Metro，但没有承诺！

# opencv - OpenCV DescriptorMatcher 函数的读写方法

> ID：10896956
> 
> 赞同：1
> 
> 时间：2012-06-05T12:02:53.340
> 
> 标签：opencv

openCV DescriptorMatcher 有两种读/写方法，我认为它们的作用并不完全清楚。我需要保存一个训练有素的 FlannBasedMatcher，这样我就不需要在每次程序启动时都对其进行训练。但是方法读/写似乎是匹配器的配置。那是对的吗？如果是这样，我如何存储训练有素的 Matcher？

最好的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T14:52:20.753

flann 的写入和读取方法只保存/读取搜索和索引参数，而不是学习的索引。FlannBasedMatcher 类的成员对象`flannIndex`具有保存功能。基本上，您需要保存和加载学习到的索引，而这一切都是 NN 算法匹配特征描述符所需要的。见`Index::load`和`Index::save`中`/opencv/modules/flann/src/miniflann.cpp`。

# c# - 如何根据参数动态更改 where 的条件

> ID：10896957
> 
> 赞同：1
> 
> 时间：2012-06-05T12:02:56.840
> 
> 标签：c#, linq

我需要用一个查询来编写它。取决于参数 regionid 必须满足条件之一，如果参数大于零 regionid 如果该参数参与请求，则如果不涉及。

```
 var myRegionId = 0;
                if (!string.IsNullOrEmpty(regionId))
                {
                    myRegionId = int.Parse(regionId);
                }

                IOrderedQueryable price;
                if (myRegionId>0)
                {
                     price = (from p in _db.PRICEs
                                  join good in _db.GOODs on p.good_id equals good.id
                                  join gname in _db.spr_goods_names on good.goods_name_id equals gname.id
                                  where ******p.region_id == myRegionId &&** gname.name.ToLower().Contains(filterText.ToLower())****
                                  group p by new{ p.good_id} into g
                                  select new
                                  {
                                      GoodId = g.Key.good_id,
                                      Promotion = g.Count(x => x.promotion != ""),
                                      MinPrice = g.Min(x => x.good_price),
                                      DistributorCount = g.Count(x => x.distributor_id != null)
                                  }
                            ).OrderByDescending(x => x.DistributorCount).Take(100).OrderBy(x => x.MinPrice);
                }else
                {
                    price = (from p in _db.PRICEs
                             join good in _db.GOODs on p.good_id equals good.id
                             join gname in _db.spr_goods_names on good.goods_name_id equals gname.id
                             **where gname.name.ToLower().Contains(filterText.ToLower())**
                             group p by new { p.good_id } into g
                             select new
                             {
                                 GoodId = g.Key.good_id,
                                 Promotion = g.Count(x => x.promotion != ""),
                                 MinPrice = g.Min(x => x.good_price),
                                 DistributorCount = g.Count(x => x.distributor_id != null)
                             }
                           ).OrderByDescending(x => x.DistributorCount).Take(100).OrderBy(x => x.MinPrice);
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:12:56.873

这个怎么样？

```
 price = (from p in _db.PRICEs
          join good in _db.GOODs on p.good_id equals good.id
          join gname in _db.spr_goods_names on good.goods_name_id equals gname.id
          where (myRegionId <= 0 || p.region_id == myRegionId) && gname.name.ToLower().Contains(filterText.ToLower())
          group p by new{ p.good_id} into g
          select new
          {
              GoodId = g.Key.good_id,
              Promotion = g.Count(x => x.promotion != ""),
              MinPrice = g.Min(x => x.good_price),
              DistributorCount = g.Count(x => x.distributor_id != null)
          }).OrderByDescending(x => x.DistributorCount).Take(100).OrderBy(x => x.MinPrice); 
```

如果`myRegionId <= 0`，则它评估为`true`并且`p.region_id == myRegionId`不评估，因此被忽略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:34:44.160

您也可以将其分成几部分，如下所示：

```
var query = from p in _db.PRICEs        
            join good in _db.GOODs on p.good_id equals good.id                                    
            join gname in _db.spr_goods_names on good.goods_name_id equals gname.id
            where gname.name.ToLower().Contains(filterText.ToLower())
            select p;

if (myRegionId>0)
{
   query = query.Where(p => p.region_id == myRegionId);
}

var price = from p in query
            group p by new{ p.good_id} into g
            select new
            {
               GoodId = g.Key.good_id,
               Promotion = g.Count(x => x.promotion != ""),
               MinPrice = g.Min(x => x.good_price),
               DistributorCount = g.Count(x => x.distributor_id != null)
            }).OrderByDescending(x => x.DistributorCount).Take(100).OrderBy(x => x.MinPrice); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T12:25:41.350

使用延迟加载功能，只要不需要数据，就可以操作查询构建。

```
var a = from p in _db.PRICEs
...

if (condition) a = a.where...
else a=a.where...

if (condition2) a = a.where...

var b = from a .... 
```

一旦你迭代 foreach 或调用 ToList 数据将被下载，并查询提示到 db。所以在提示之前你可以做你需要的。

PS：使用分析器检查发送到 BD 的查询以优化性能。有时 ORM 可以构建一些非常巨大的东西并损害性能。

# c# - 解压后无法删除 zip 文件

> ID：10896960
> 
> 赞同：1
> 
> 时间：2012-06-05T12:02:59.583
> 
> 标签：c#, zip, extract, dotnetzip

我有一种方法可以提取多个 zip 文件，但在应用程序关闭之前无法删除它们。我认为这是`DotNetZip version 1.9.1.5`图书馆的一个错误。

我的压缩文件：

```
Hezareh.z01
Hezareh.z02
Hezareh.z03
Hezareh.zip 
```

提取文件的代码：

```
 private void InstallUpdates()
        {
            string tempDir = Path.Combine(Environment.CurrentDirectory, MainViewModel.TemporaryDirectoryName);
            string mainZipFileName = Path.Combine(tempDir, 
                _updateConfig.ZipFiles.Single(f => f.IsFirstPart).PathOnClient); // i'm sure this is Hezareh.zip file
            string installPath = Path.Combine(Environment.CurrentDirectory, Properties.Settings.Default.InstallationDirectory);
            // i also tried: using (var zipFile = new ZipFile(mainZipFileName)) 
            using (var zipFile = ZipFile.Read(mainZipFileName))
            {
                // same problem for ExtractAll method.
                // zipFile.ExtractAll(installPath, ExtractExistingFileAction.OverwriteSilently);
                foreach (ZipEntry entiry in zipFile)
                {
                    entiry.Extract(installPath, ExtractExistingFileAction.OverwriteSilently);
                }
                // zipFile.Close() or any same method does not exists and zipFile.Dispose() is called
                // automatically but even when i call it manually still have same problem.
            }

            DeleteFiles();
        }
        private void DeleteFiles()
        {
            var files = Directory.GetFiles(Path.Combine(Environment.CurrentDirectory, MainViewModel.TemporaryDirectoryName));
            foreach (string file in files)
            {
                File.Delete(file); // exception occure here 
            }
        } 
```

[这个问题](https://stackoverflow.com/questions/6577476/c-sharp-deleting-a-zip-file-after-unzipping)对我没有用，我要烧了我的头。

例外：

```
 The process cannot access the file 'D:\Projects\...\App\bin\Debug\UpdaterTemp\Hezareh.z01' because it is being used by another process.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.File.Delete(String path)
   at Meshkat.Updater.App.ViewModels.InstallUpdatesViewModel.DeleteDownloadedUpdates() in D:\Projects\Meshkat.Updater\Meshkat.Updater.App\ViewModels\InstallUpdatesViewModel.cs:line 60
   at Meshkat.Updater.App.ViewModels.InstallUpdatesViewModel.Hide() in D:\Projects\Meshkat.Updater\Meshkat.Updater.App\ViewModels\InstallUpdatesViewModel.cs:line 129
   at Meshkat.Updater.App.RelayCommand.Execute(Object parameter) in D:\Projects\Meshkat.Updater\Meshkat.Updater.App\RelayCommand.cs:line 146
   at MS.Internal.Commands.CommandHelpers.CriticalExecuteCommandSource(ICommandSource commandSource, Boolean userInitiated)
   at System.Windows.Controls.Primitives.ButtonBase.OnClick()
   at System.Windows.Controls.Button.OnClick()
   at System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp(MouseButtonEventArgs e)
   at System.Windows.UIElement.OnMouseLeftButtonUpThunk(Object sender, MouseButtonEventArgs e)
   at System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)
   at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)
   at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)
   at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)
   at System.Windows.UIElement.ReRaiseEventAs(DependencyObject sender, RoutedEventArgs args, RoutedEvent newEvent)
   at System.Windows.UIElement.CrackMouseButtonEventAndReRaiseEvent(DependencyObject sender, MouseButtonEventArgs e)
   at System.Windows.UIElement.OnMouseUpThunk(Object sender, MouseButtonEventArgs e)
   at System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)
   at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)
   at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)
   at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)
   at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)
   at System.Windows.UIElement.RaiseEvent(RoutedEventArgs args, Boolean trusted)
   at System.Windows.Input.InputManager.ProcessStagingArea()
   at System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)
   at System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)
   at System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawMouseActions actions, Int32 x, Int32 y, Int32 wheel)
   at System.Windows.Interop.HwndMouseInputProvider.FilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)
   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)
   at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)
   at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)
   at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)
   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)
   at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg)
   at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)
   at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)
   at System.Windows.Threading.Dispatcher.Run()
   at System.Windows.Application.RunDispatcher(Object ignore)
   at System.Windows.Application.RunInternal(Window window)
   at System.Windows.Application.Run(Window window)
   at System.Windows.Application.Run()
   at Meshkat.Updater.App.App.Main() in D:\Projects\Meshkat.Updater\Meshkat.Updater.App\obj\x86\Debug\App.g.cs:line 0
   at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T12:15:11.513

v1.9.1.6 之前的版本有一个错误，您提取后无法删除文件。也许您需要升级？但是告诉我们你的版本。

有关更多信息，请参阅 CodePlex 上的此 WorkItem：http: [//dotnetzip.codeplex.com/workitem/12521](http://dotnetzip.codeplex.com/workitem/12521)

# facebook - 验证后登录重复，如果我尝试发送好友请求

> ID：10896962
> 
> 赞同：-1
> 
> 时间：2012-06-05T12:03:00.993
> 
> 标签：facebook, post, login, invite

我试图为我的应用程序构建一个“欢呼动作”。这是iPhone中的游戏，所以我想在用户墙中发布“欢迎信息”（我需要“public_stream”权限），然后邀请他的朋友访问我的网页。

这是我的问题..我使用以下方式对用户进行身份验证：

```
_url = "http://www.facebook.com/dialog/oauth/?client_id=" + app_id + "&redirect_uri=" + app_net_folder + auth_response_uri + "&state=" + session_id; 
```

我在我的 uri 中得到响应，然后我得到 access_token、user_id 等。然后我以这种方式在他的墙上发布一条消息：

```
_url = "https://www.facebook.com/dialog/apprequests?app_id=" + app_id;
_url += "&message=" + string_ToUrl(String_ToHTML(request_msg)); 
```

现在我想邀请他的朋友（使用多朋友列表对话框）。为此，我只能使用 JavaScript FB.ui。这样：

```
FB.init({appId  : app_id,   logging : false, frictionlessRequests: true, oauth : true});

FB.ui({method: 'apprequests', message: msg, title: title}, requestCallback); 
```

当我这样做时，会打开一个窗口，再次询问我用户的登录信息。但我的用户已经通过身份验证。所以我不知道如何用 JavaScript 对 FB 说我的用户已经通过身份验证了！（我什至有 access_token，但我不知道如何在 JavaScript 函数中使用它）。

有人知道我在做什么错吗？或者如何做这两个动作只要求用户登录一次？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:14:05.210

如果您已经登录，您可以使用以下代码获取登录用户 ID

```
var userId = FB.Facebook.apiClient.get_session().uid;
if(userId > 0 || userId != '')
{
  alert('user is already log in');
} 
```

希望对你有帮助

# android - 陀螺仪在不同的设备上给出不同的值

> ID：10896964
> 
> 赞同：1
> 
> 时间：2012-06-05T12:03:05.343
> 
> 标签：android

我有奇怪的陀螺仪行为：

我有`values[0]`陀螺仪传感器：绕 x 轴的角速度。在三星 Galaxy Nexus 上，此值从 -10 到 10。在三星 Galaxy Tab（旧）中 - 从 -100 到 100。

所以为什么？我无法理解。我编写使用陀螺仪的应用程序。在 Galaxy Nexus 上一切正常，但在 Galaxy Tab 上，由于价值更高，我遇到了问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:39:01.600

Android 的[SensorManager](http://developer.android.com/reference/android/hardware/SensorManager.html)返回的任何[传感器](http://developer.android.com/reference/android/hardware/Sensor.html)都将提供该传感器提供的值范围。您的计算应基于此，而不是硬编码值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:42:10.337

如果设备给出不同的值，我想到的唯一原因是它们在不同的范围/尺度上工作……这意味着您可能必须将值除以最大范围才能使值标准化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T13:29:39.047

旧的 7 英寸三星 Galaxy Tab 还提供以弧度/秒为单位的陀螺仪数据。这与比例或其他无关，该值要么完全错误，要么您没有正确获取。范围值会告知您可获得的最小值和最大值，这就是全部。

# asp-classic - 如何在经典asp中检查用户的文件夹权限

> ID：10896965
> 
> 赞同：0
> 
> 时间：2012-06-05T12:03:06.153
> 
> 标签：asp-classic

有没有办法检查特定的 Windows 用户是否有权访问网络共享上的特定目录？

或者有没有办法捕获当用户单击他们无权访问的目录时显示的 Windows“访问被拒绝”错误？

预先感谢任何人都可以分享的任何信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T14:04:34.597

如果您的 asp 经典代码试图在 IIS 用户帐户无权访问的文件夹中写入或修改文件，则会产生[500 页错误](http://msdn.microsoft.com/en-us/library/ms525983.aspx)。

您可以设置自定义错误页面来捕获 500 个错误。捕获后，您可以显示友好错误、记录操作等

# javascript - NodeList 原型中的对象

> ID：10896969
> 
> 赞同：0
> 
> 时间：2012-06-05T12:03:24.220
> 
> 标签：javascript, prototype

一些原生 javascript 对象的原型可以扩展为包含新函数（例如`NodeList.prototype.forEach`或`NodeList.prototype.addEventListener`），我使用这些新函数来允许与`NodeList`. 到目前为止一切都很好，但是我应该如何将对象添加到原型中，而原型又具有自己的功能（允许`NodeListVar.classList.remove("class")`）。`NodeListVar.classList().remove("class")`通过执行以下操作，我已经能够做到

```
NodeList.prototype.classList = function(){
    var _this = this;
    return {
        remove: function(class){
            _this.forEach(function(){
                this.classList.remove(class);
            });
        }
    }   
}; 
```

但是，我非常希望语法与 normal 相同`element`，因此更像：

```
NodeList.prototype.classList = {
    remove: function(class){
        //where *this* would be the nodeList and *not* the DOMWindow
        this.forEach(function(){
            this.classList.remove(class);
        });
    }
}; 
```

这可能并不难，但我已经无休止地搜索了谷歌并且已经查看了无数问题并且找不到任何有用的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T12:37:10.503

首先阅读：[扩展 DOM 有什么问题](http://perfectionkills.com/whats-wrong-with-extending-the-dom/)。

您不能在原型上设置对象。所有被调用的函数都将在该静态原型对象的上下文中执行，而不是 NodeList 本身。原型上的对象没有对当前 NodeList 的引用。

在 normal `Element`s 上，每个元素都有自己的`classList`属性，`DOMTokenList`绑定元素。你需要做同样的事情：给每个 NodeList 自己的 classLists 实例。由于您不能在不可用的构造函数中执行此操作，因此您必须使用 getter，如前所述。

我认为您不应该尝试在 NodeLists 上允许与 Elements 上相同的语法，因为它们非常不同。但是如果你想摆脱这些括号，你可以安装一个[原生的 getter 函数](https://stackoverflow.com/q/10592753/1048572)。

```
function ClassLists(nl) {
    ... // nl references the NodeList we're bound to
}
ClassLists.prototype = ...;

Object.defineProperty(NodeList.prototype, "classLists", {
    get: function() {
        return this.classLists = new ClassLists(this);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:48:24.053

只是为了补充@Bergi 的答案，这是一个跨浏览器的解决方案：

```
function ClassList() {
    this.nodeList;
}

ClassList.prototype = {
    constructor: ClassList,

    remove: function() {
        console.log( this );
    }
};

NodeList.prototype.classList = new ClassList();

nl.classList.remove(); // ClassList object with the `nodeList` property. 
```

它不能与相同的 API 一起使用，因为它不是 using `defineProperty`，但它是跨浏览器的。`defineProperty`仅在 IE9 中可用，在 IE7 中不可填充。

# c - C程序IPC消息

> ID：10896976
> 
> 赞同：-1
> 
> 时间：2012-06-05T12:03:43.627
> 
> 标签：c, ipc

我正在使用 IPC 进行 2 个程序通信。

**我的发件人代码片段：**

```
int msgflg = IPC_CREAT | 0666;  
key_t key_id;  
struct msgbuf sbuf;  
size_t buflen;  
key_id = 1235;  

sbuf.mtype = 1;  

if (msgsnd(msqid, &sbuf, buflen, IPC_NOWAIT) < 0)  
{               die("msgsnd");  

}  
else {
    mvprintw(8, 0, "%s", "                  ");
    mvprintw(8, 0, "%s", sbuf.mtext);           
} 
```

**接收端：**

```
if ((msqid = msgget(key_id, 0666)) < 0)  
   die("msgget()");         //break;

//Receive an answer of message type 1\.  

if (msgrcv(msqid, &rcvbuffer, MAXSIZE, 1, 0) < 0)  
    die("msgrcv");  
mvprintw(curr_row + 1, 0, "Cleaning process monitor: %s", rcvbuffer.mtext); 
```

通信工作正常，但接收方接收到的消息未完全接收。

如果我发送“Hello”它只接收“H”我的缓冲区大小是 200

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T12:38:36.933

您不能直接使用 mtext 大小 1 声明 struct msgbuf

```
struct msgbuf {
    long mtype;       /* message type, must be > 0 */
    char mtext[1];    /* message data */ 
}; 
```

您需要做的是在结构中声明一个长字符数组，然后将其转换为 void*

例如，

```
struct msgbuf {
    long type;
    char mtext[200];
};

struct msgbuf mybuf;
// set type, store data in mtext

msgsnd(msqid, (void*)&mybuf, sizeof(msgbuf)+1, IPC_NOWAIT) 
```

# c - C 数组元素初始化

> ID：10896977
> 
> 赞同：2
> 
> 时间：2012-06-05T12:03:45.810
> 
> 标签：c, arrays

如果您不初始化数组中的元素，您可以在调试时看到它们被分配了一个随机的大数。只是想知道这个数字是如何确定的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T12:05:19.180

这些只是那些已经存在于分配数组空间的内存中的值。所以，这里没有“决心”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T12:08:19.870

从技术上讲，读取未初始化的变量是未定义的行为。它们可以是任何东西，从剩余的内存垃圾到编译器预定义的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T12:16:17.973

当你声明一个数组时，堆栈指针将被添加，然后返回第一个元素的地址。就是这样，内存中的数据不会改变。

# objective-c - 检查 NSDictionaries 的两个 NSArray 之间的公共值

> ID：10896978
> 
> 赞同：0
> 
> 时间：2012-06-05T12:03:46.400
> 
> 标签：objective-c, ios5

我有两个 NSArray，notiCloud 和 notiLoc，都具有相同结构的 NSDictonary。我需要知道如何检查两个 NSArray 中有多少 NSDictionary，例如使用键 @"id"。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T12:49:38.140

```
// Create arrays of the IDs only
NSArray *notiCloudIDs = [notiCloud valueForKey:@"id"];
NSArray *notiLocIDs = [notiLoc valueForKey:@"id"];

// Turn the arrays into sets and intersect the two sets
NSMutableSet *notiCloudIDsSet = [NSMutableSet setWithArray:notiCloudIDs];
NSMutableSet *notiLocIDsSet = [NSMutableSet setWithArray:notiLocIDs];
[notiCloudIDsSet intersectSet:notiLocIDsSet];

// The IDs that are now in notiCloudIDsSet have been present in both arrays
NSLog(@"Duplicate IDs: %@", notiCloudIDsSet); 
```

# android - Android：部署测试项目

> ID：10896981
> 
> 赞同：0
> 
> 时间：2012-06-05T12:03:53.170
> 
> 标签：android, testing

我在 eclipse 中创建了一个测试项目来为我的一个 android 库运行一些测试。我可以在我的设备上的 eclipse 中毫无问题地运行它。是否可以在其他设备上运行这些测试而无需将它们连接到 Eclipse？我想将测试项目 apk 发送给其他人，以便他们可以在他们的设备上运行测试。

我想我需要一个运行测试并在设备本身上显示结果的测试运行器应用程序。有谁知道这样的应用程序？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:24:17.297

```
Is it possible to run these tests on other devices 
without having them connected to eclipse? 
```

是的！！

只需将经过测试的 .apk 文件发送到他们的手机，安装并使用应用程序。

不需要任何测试运行器应用程序，我已经检查过了。

# xaml - ListView 包含 GridViews 和 ListViews

> ID：10896984
> 
> 赞同：2
> 
> 时间：2012-06-05T12:04:04.387
> 
> 标签：xaml, listview, gridview, windows-8, semantic-zoom

我需要创建一个带有语义缩放的 xaml 页面，其中放大的视图包含 GridViews 和 ListViews。我从基本的网格应用程序模板开始。

为了尝试实现这一点，我让 Semantic Zoom 控件的放大视图显示了一个列表视图，并且列表视图包含我需要将数据实际显示为 ListViewItems 的 ListView 和 GridView 控件。这在一定程度上可行 - 问题是鼠标按下或点击动画发生在父 ListView 的整个子控件而不是子元素上。如果我不需要支持语义缩放，这种布局会很简单。

所以，我的问题是这是实现这种布局的最佳方式，还是我错过了什么。如果这是最好的方法，是否可以控制行为以使子项元素对选择具有正确的动画效果？

*附加信息*

GridView 或 ListView 的选择基于集合中项目的类型。在这个例子中，grp 1、3 和 4（显示在网格中）都是 type`NewsFull`的集合，其余的（显示在 Lists 中）是 type `HeadlineOnly`，这两种类型都继承自 NewsBase。

页面布局（放大）应该是这样的......

```
Title

grp 1         grp 2          grp 3            grp 4      grp 5
[g][g][g][g]  [_list item_]  [g][g][g][g][g]  [g][g][g]  [_list_item_]
[g][g][g][g]  [_list item_]  [g][g][g][g][g]  [g][g][g]  [_list_item_]
[g][g][g][g]  [_list item_]  [g][g][g][g]     [g][g]     [_list_item_]
[g][g][g]     [_list item_]  [g][g][g][g]     [g][g] 
```

其中`[g]`是网格视图项，[_list_item_] 是列表视图项。

缩小的视图是这样的...

```
Title

grp 1      grp 2      grp 3      grp 4      grp 5
[summary]  [summary]  [summary]  [summary]  [summary] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T13:53:23.113

也许您可以尝试使用 ItemContainerStyleSelector 根据项目类型或类似内容换出项目的容器？这样，您是否可以将一组设置为具有包装布局容器，而另一组可以只是一个堆栈面板？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T03:57:58.657

这个设计对我来说看起来很合理。您遇到的问题仅仅是“是否可以控制行为以使子项元素对选择具有正确的动画效果？”

这里的问题是您可能缺乏关于不同级别的 UI 对象的抽象。我假设您只使用一个 xaml 对象编写了这个大控件，然后弄乱了样式设置。在我看来，你需要将你的 UI 分解为这些级别的组件：

1.  ZoomPage // 本质上是一个列表
2.  GroupElement // 可以是 GRID 对象或列表对象，具体取决于 DATACONTEXT
3.  GroupElement // 它也有一个摘要状态。

您指定的绝对可以实现，在我看来只是样式没有正确部署，如果您的控件确实太复杂，请将其分解并单独测试。

希望这可以帮助

# iphone - 为什么 GKSession 在设备上运行时总是尝试使用蓝牙而不是在模拟器上？

> ID：10896987
> 
> 赞同：0
> 
> 时间：2012-06-05T12:04:13.563
> 
> 标签：iphone, wifi, p2p, gamekit, gksession

我正在尝试在不使用 GKPeerPickerController 的情况下实现 GameKit 连接。我需要的是建立 WiFi 连接，而不是蓝牙。

我就是这样做的

```
self.gameSession = [[GKSession alloc] initWithSessionID:@"test" displayName:nil sessionMode:GKSessionModePeer];
self.gameSession.available = YES;
self.gameSession.delegate = self;
self.gameSession.disconnectTimeout = 0;
[self.gameSession setDataReceiveHandler:self withContext:nil]; 
```

我的问题是设备总是尝试通过蓝牙连接。至少我是这么认为的，因为控制台中总是出现以下内容

> BTM：附加到 BTServer

即使我关闭蓝牙，它总是会尝试处理蓝牙，而不是 wifi。此外 - 如果蓝牙打开 - 如果我不使用 GKPeerPickerController，设备永远不会互相看到。此外，模拟器从不尝试寻找蓝牙，并且始终能够建立 wifi 连接并轻松找到任何设备。我如何让 GKSession 选择 WiFi 连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:23:31.233

可能是越狱设备出现的问题，

GKSession 和 GKSessionDelegate 实现适用于蓝牙和 WiFi。

这两个类检查wifi和蓝牙，并选择合适的传输介质。

如果您的 iPhone 是越狱的，那么在通过这些传输介质连接时，蓝牙或 wifi 可能会出现一些问题，并且可能会阻止正确使用 gamekit。

并尝试使用

```
picker.connectionTypesMask = GKPeerPickerConnectionTypeOnline 
```

检查委托方法中的条件

```
if (type == GKPeerPickerConnectionTypeOnline) {
} 
```

更新 ：

请参阅 Apple 的此示例代码。 [https://developer.apple.com/library/ios/#samplecode/GKTapper/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010283](https://developer.apple.com/library/ios/#samplecode/GKTapper/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010283)

# symfony - form_rest 命令显示先前渲染的集合字段

> ID：10896989
> 
> 赞同：4
> 
> 时间：2012-06-05T12:04:19.117
> 
> 标签：symfony, twig

我有一个带有集合类型字段的表单，如下所示：

```
<div id="beneficiosTab" class="opcional">
    Beneficios
    <ul class="beneficios" data-prototype="{{ form_widget(formAtendimento.beneficios.get('prototype')) | e }}">
        {% for beneficio in formAtendimento.beneficios %}
            <li>{{ form_row(beneficio.coTipoBeneficio) }}</li>
            <li>{{ form_row(beneficio.vrValor) }}</li>
            <li>{{ form_row(beneficio.boConcedido) }}</li>
        {% endfor %}
        <li><a href="#" id="addBeneficio">Add Beneficio</a></li>
    </ul>
</div>
<div style="clear:both"></div>
{{ form_rest(formAtendimento) }} 
```

表单的实体可以有多个集合项，也可以没有。

当实体有集合的项目时，它可以正常工作，但是当它没有时，twig 中的“for”不会发生，并且在 form_rest 中会生成一个“Beneficios”div。

有什么办法可以防止吗？提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-30T20:56:59.073

这似乎是表单渲染中的一个错误。通过在渲染集合元素之后添加以下代码，我设法禁用了 form_rest 函数中的额外表单渲染：

```
{% do form.uploads.setRendered() %} 
```

“上传”是我的收藏字段类型。不过，这对我来说似乎不是最佳做法。

所以整个渲染看起来是这样的：

```
 <div id="uploads" data-prototype="{{ form_widget(form.uploads.vars.prototype)|e }}">
        {% for upload in form.uploads %}
            {{ form_widget(upload) }}
        {% endfor %}
  </div>
  {% do form.uploads.setRendered() %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T12:25:13.847

form_rest 生成所有未渲染的表单。Symnfony2 中的每个输入都是表单，集合类型也是如此。

你从来没有打印出集合，所以 Symfony 为你制作。如果您想隐藏它，并且仍然使用 form_rest，只需将其打印到：

```
<div style="display: none" /> 
```

# ios - iOS WiFi 探测间隔

> ID：10896992
> 
> 赞同：22
> 
> 时间：2012-06-05T12:04:23.333
> 
> 标签：ios, wifi

我正在编写一个通过 WiFi 连接到专有设备的应用程序。专有设备充当 WiFi 接入点。

正如我所料，当设备断电时，WiFi 连接将终止。

iPhone 继续发送探测请求，寻找要连接的网络。它遵循用于发送探测的指数退避算法。

我的问题是最终 iPhone 发送的探测请求之间的间隔比我设备上的超时时间长，所以它们没有建立连接。

我正在使用可达性代码，它按我的预期工作。

似乎按下主页按钮将重置退避并立即发送探测请求。有谁知道让我的应用程序做类似事情的方法？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-11T00:04:04.803

不是每次都使用 Reachability ping 互联网，而是 ping 本地网络上的主机，例如 DNS 服务器或路由器 (192.168.1.1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-05T11:28:59.357

我怀疑如果您在应用程序中重新配置连接（重新设置 WiFi 配置），iPhone 将在没有退避的情况下重新开始扫描。因此，您的应用程序可以跟踪连接丢失后的时间，然后在适当的时间后重新配置链接。可能您必须重新配置为不同的 SSID，然后再切换回来，具体取决于 iOS 库的智能程度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-01T11:28:58.553

我不舒尔，如果我理解你的话。您想检查设备是否仍连接到接入点？

我已经构建了一个应用程序来通过 wifi 连接到扫描仪，扫描仪充当接入点。为此，我检查设备当前连接的 SSID 是否是扫描仪之一。要检查 CurrentSSID，您可以使用以下代码：

```
+(NSString*)currentSSID {
    CFArrayRef myArray = CNCopySupportedInterfaces();
    CFDictionaryRef myDict = CNCopyCurrentNetworkInfo(CFArrayGetValueAtIndex(myArray, 0));
    if (!myDict) {
        return nil;
    }
    NSDictionary *myDictionary = (__bridge_transfer NSDictionary*)myDict;
    return [myDictionary objectForKey:@"SSID"];    
} 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-21T13:59:42.123

恐怕没有办法在审核期间不被拒绝（您可以阅读如何访问`SBWifiManager`）。Apple 不启用任何方式从沙盒环境访问 wifi 管理器。我在将我的设备连接到各种接入点（使用探测请求进行定位）时遇到了类似的问题，到目前为止，在 iOS 7 中，探测请求是在很长的间隔（甚至 15 分钟）之间发送的。尝试修改您的接入点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-23T11:54:48.593

我以某种方式遇到了类似的情况，以检查设备是否连接在特定的 VPN 连接中。该方法是通过*标准 ping*或实现 ping Web 服务 ping 到本地网络中的机器。

如果您的本地网络中没有后端，那么最简单的方法就是 ping。您可以从 Apple 开发者网站查看以下代码示例：http: [//developer.apple.com/library/mac/#samplecode/SimplePing/Introduction/Intro.html](http://developer.apple.com/library/mac/#samplecode/SimplePing/Introduction/Intro.html)

# jquery - 如何让flash通知的DIV标签始终保持在视野中？

> ID：10896993
> 
> 赞同：1
> 
> 时间：2012-06-05T12:04:23.440
> 
> 标签：jquery, ruby-on-rails, jquery-ui

我在我的 ROR 网站中实现了 Flash 通知，其中通过 jQuery 显示通知。它将每 5 秒更改一次。另一个通知将向下滑动。

```
<div class="interactive_text">
    <%= flash[:notice] %>
</div> 
```

现在的问题是，由于 DIV 标签并非一直在视图中，当我向下滚动浏览器窗口或当此通知太靠近页脚时，此通知 DIV 每 5 秒向下滑动一次，将其下方的其余 DIV 标签向下拖动. 它损害了网站的用户体验。如何让这个 DIV 标签始终保持可见？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T12:09:00.803

尝试为 div 设置 Position:"fixed"

# php - 如何从位流中获取两个值之间的整数？

> ID：10896997
> 
> 赞同：3
> 
> 时间：2012-06-05T12:04:49.700
> 
> 标签：php

我有一个项目，它使用 php 的 mt_rand() 来生成不同的随机整数，但我最近获得了访问真正随机位流的权限。我无法弄清楚如何创建类似于 mt_rand() 的函数，我可以从我的位流中获取两个值之间的随机整数。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T07:41:01.280

我想出了一个方法，但不确定它是否是最有效的方法（代码未经测试，只是演示理论）：

```
function RandomInteger($min, $max)
{
    $range = ($max - $min) + 1;
    $bitsNeeded = ceil( log($range, 2) );
    $number = ReadBitsAndConvertToInteger($bitsNeeded);
    if ($number < $range)
        return $number + $min;
    else if ($number > $range)
        return RandomInteger($min, $max);
} 
```

如您所见，该功能可能会重复，这意味着将使用更多位，这就是为什么我不确定它是否是最有效的方式，就使用的位而言，这样做。

`Pr(repeat) = (2^bitsNeeded - range) / (2^bitsNeeded)`

`Therefore, 0 < Pr(repeat) < 0.5`

因此，在最坏的情况下，必须重复的机会几乎是 0.5，它开始变得不太可能需要重复超过 10 次左右，平均不到 2 次。显然，在不得不重复的机会较低的情况下，这些数字会越来越低。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T12:47:43.960

我只会读取`PHP_INT_SIZE * 8`位并将结果数字压缩在您需要的范围内：

```
function squash($nr, $min, $max)
{
    return $min + $nr % ($max - $min);
} 
```

另一种方式：

```
function squash($nr, $min, $max)
{
    return $min + round($nr / PHP_INT_MAX * ($max - $min));
} 
```

这只是我突然想到的，为什么不直接使用你的随机流并将其推送到`mt_srand()`：

```
function squash($nr, $min, $max)
{
    mt_srand($nr);
    return mt_rand($min, $max);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-15T16:47:46.413

让我谈谈在平均使用的随机位数方面“最佳”的随机整数生成算法。在这篇文章的其余部分，我们将假设我们有一个“真正的”随机生成器，它可以产生无偏且独立的随​​机位。

1976 年，DE Knuth 和 AC Yao 表明，任何仅使用随机位以给定概率生成随机整数的算法都可以表示为二叉树，其中随机位指示遍历树和每个叶子（端点）的方式对应一个结果。他们还给出了给定算法执行此任务所需的平均位数的下限。在这种情况下，均匀生成整数的*最佳*`[0, n)`算法平均需要最多`log2(n) + 2`位。在这个意义上，有很多*优化*算法的例子。其中一个是 J. Lumbroso (2013) 的[Fast Dice Roller](https://arxiv.org/abs/1304.1916)（在下面实现），另一个可能是[数学论坛中给出的算法](http://mathforum.org/library/drmath/view/65653.html)2004 年。另一方面，[M. O'Neill 调查的](https://www.pcg-random.org/posts/bounded-rands.html)所有算法都不是最优的，因为它们依赖于一次生成随机比特块。

然而，任何同样*无偏的**最优*整数生成器通常会在最坏的情况下永远运行，正如 Knuth 和 Yao 所展示的那样。回到二叉树，n 个结果标签中的每一个都留在二叉树中，因此 [0, n) 中的每个整数都可以以 1/n 的概率出现。但是如果 1/n 有一个非终止的二元展开式（如果 n 不是 2 的幂就是这种情况），这棵二叉树必然要么——</p>

**   具有“无限”深度，或*   在树的末端包括“拒绝”叶子，*

 *在任何一种情况下，算法都会在最坏的情况下永远运行，即使它平均使用很少的随机位。（另一方面，当 n 是 2 的幂时，最佳二叉树将具有有限深度且没有拒绝节点。）快速骰子滚轮是使用“拒绝”事件来确保其无偏的算法示例；请参阅下面代码中的注释。

因此，一般来说，**随机整数生成器可以*是*无偏的*或*恒定时间的（甚至两者都不是），但不能两者兼而有之。**特别是，没有办法在不引入偏差的情况下“修复”不确定运行时间的最坏情况。例如，模减少（例如，`mt_rand() % n`) 相当于一棵二叉树，其中拒绝叶被标记的结果替换——但由于可能的结果比拒绝叶多，因此只有一些结果可以代替拒绝叶，从而引入偏差。如果您在一定次数的迭代后停止拒绝，则会产生相同类型的二叉树 - 以及相同类型的偏差。（但是，根据应用程序，这种偏差可能可以忽略不计。随机整数生成也有安全方面的问题，在这个答案中讨论太复杂了。）

请注意，我们假设我们有一个随机位生成器。如果您的答案可以通过`ReadBitsAndConvertToInteger(1)`.

### 快速骰子滚子实施

以下是快速骰子滚轮的 JavaScript 实现。请注意，它使用拒绝事件和循环来确保它是公正的。 `ReadBitsAndConvertToInteger(1)`是一个随机位生成器（例如，在您的答案中使用）。

```
function randomInt(minInclusive, maxExclusive) {
  var maxInclusive = (maxExclusive - minInclusive) - 1
  var x = 1
  var y = 0
  while(true) {
    x = x * 2
    var randomBit = ReadBitsAndConvertToInteger(1)
    y = y * 2 + randomBit
    if(x > maxInclusive) {
      if (y <= maxInclusive) { return y + minInclusive }
      // Rejection
      x = x - maxInclusive - 1
      y = y - maxInclusive - 1
    }
  }
} 
```*