# StackOverflow 问答 10984000-10984999

# android - Android NDK - 未定义对 Android::Mutex、Android::AudioTrack 的引用

> ID：10984001
> 
> 赞同：2
> 
> 时间：2012-06-11T16:26:15.343
> 
> 标签：android, android-ndk

在我接手的项目使用的 Android::Mutex 和 Android::AudioTrack 的链接时，我收到了奇怪的未定义引用。

有没有人有任何想法？没有要包含的Android静态库吗？

共享库：******* *jni.so

```
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `__static_initialization_and_destruction_0':
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:29: undefined reference to `android::Mutex::Mutex()'
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:29: undefined reference to `android::Mutex::~Mutex()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `Autolock':
/Android/source/frameworks/base/include/utils/threads.h:232: undefined reference to `android::Mutex::lock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `~Autolock':
/Android/source/frameworks/base/include/utils/threads.h:234: undefined reference to `android::Mutex::unlock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `Autolock':
/Android/source/frameworks/base/include/utils/threads.h:232: undefined reference to `android::Mutex::lock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `android_mute':
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:263: undefined reference to `android::AudioTrack::mute(bool)'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `~Autolock':
/Android/source/frameworks/base/include/utils/threads.h:234: undefined reference to `android::Mutex::unlock()'
/Android/source/frameworks/base/include/utils/threads.h:234: undefined reference to `android::Mutex::unlock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `Autolock':
/Android/source/frameworks/base/include/utils/threads.h:232: undefined reference to `android::Mutex::lock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `android_resume':
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:255: undefined reference to `android::AudioTrack::start()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `~Autolock':
/Android/source/frameworks/base/include/utils/threads.h:234: undefined reference to `android::Mutex::unlock()'
/Android/source/frameworks/base/include/utils/threads.h:234: undefined reference to `android::Mutex::unlock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `Autolock':
/Android/source/frameworks/base/include/utils/threads.h:232: undefined reference to `android::Mutex::lock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `android_pause':
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:247: undefined reference to `android::AudioTrack::pause()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `~Autolock':
/Android/source/frameworks/base/include/utils/threads.h:234: undefined reference to `android::Mutex::unlock()'
/Android/source/frameworks/base/include/utils/threads.h:234: undefined reference to `android::Mutex::unlock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `android_get_delay':
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:237: undefined reference to `android::AudioTrack::latency() const'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `Autolock':
/Android/source/frameworks/base/include/utils/threads.h:232: undefined reference to `android::Mutex::lock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `android_uninit':
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:220: undefined reference to `android::AudioTrack::stop()'
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:228: undefined reference to `android::AudioTrack::~AudioTrack()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `~Autolock':
/Android/source/frameworks/base/include/utils/threads.h:234: undefined reference to `android::Mutex::unlock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `Autolock':
/Android/source/frameworks/base/include/utils/threads.h:232: undefined reference to `android::Mutex::lock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `android_start':
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:197: undefined reference to `android::AudioTrack::initCheck() const'
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:198: undefined reference to `android::AudioTrack::start()'
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:201: undefined reference to `android::AudioTrack::setVolume(float, float)'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `~Autolock':
/Android/source/frameworks/base/include/utils/threads.h:234: undefined reference to `android::Mutex::unlock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `android_start':
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:207: undefined reference to `android::AudioTrack::~AudioTrack()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `Autolock':
/Android/source/frameworks/base/include/utils/threads.h:232: undefined reference to `android::Mutex::lock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `android_init':
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:122: undefined reference to `android::AudioTrack::AudioTrack()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `~Autolock':
/Android/source/frameworks/base/include/utils/threads.h:234: undefined reference to `android::Mutex::unlock()'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `android_init':
/Users/kevin/Desktop/player2/videoplayer/LibPlayer/amadec/audio_out/android_out.cpp:139: undefined reference to `android::AudioTrack::set(int, unsigned int, int, int, int, unsigned int, void (*)(int, void*, void*), void*, int, android::sp<android::IMemory> const&, bool, int)'
/Users/kevin/Desktop/player2/videoplayer/videoplayer/obj/local/armeabi-v7a/libamadec.a(android_out.o): In function `~sp':
/Android/source/frameworks/base/include/utils/RefBase.h:378: undefined reference to `android::RefBase::decStrong(void const*) const'
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T20:50:00.707

这也困扰着我——但我最终通过与 Bionic 的标题 ( `bionic/libc/include`) 链接来解决它，并且 - 重要的部分 - `#define`'ing `HAVE_PTHREADS`(即 add `LOCAL_CFLAGS += HAVE_PTHREADS`)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T19:28:16.830

好吧，这些都是一些奇怪的错误...看起来每次您从 android::Mutex 或 android::AudioTrack 库中引用某些内容时，链接器都无法找到这些函数。我只能说，由于这些库不是 android 标准库的一部分，因此请确保将它们放在构建路径中，否则祝你好运。

# ios - 在块动画中为 UITableViewCell 的 backgroundColor 设置动画

> ID：10984002
> 
> 赞同：2
> 
> 时间：2012-06-11T16:26:17.933
> 
> 标签：ios, animation, uitableview, block, uibackgroundcolor

我正在尝试将两个表格单元格的背景颜色从红色变为原始颜色白色。

以下代码是我正在使用的。问题是它从不显示红色——它只是从（原始）白色动画到（动画到）白色。即，如果我更改动画块中的颜色，它将动画为该颜色。

```
[table cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]].backgroundColor = [UIColor redColor];
[table cellForRowAtIndexPath:[NSIndexPath indexPathForRow:1 inSection:0]].backgroundColor = [UIColor redColor];

[UIView animateWithDuration:0.8 delay:0.2 options:UIViewAnimationOptionCurveEaseInOut animations:^{
    [table cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]].backgroundColor = [UIColor whiteColor];
    [table cellForRowAtIndexPath:[NSIndexPath indexPathForRow:1 inSection:0]].backgroundColor = [UIColor whiteColor];
}
completion:^(BOOL finished) {

}]; 
```

以下代码对表格的背景按预期工作，但这不是我想要的：

```
table.backgroundColor = [UIColor redColor];

[UIView animateWithDuration:0.8 delay:0.2 options:UIViewAnimationOptionCurveEaseInOut animations:^{
    table.backgroundColor = [UIColor clearColor];
}
completion:^(BOOL finished) {

}]; 
```

那么，为什么当我的表格背景有动画时，我的单元格背景没有动画呢？

值得一提的是，在此之后，我在 table view 上执行了许多其他链接动画，但是在将这些动画注释掉之后，我仍然有这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:40:00.153

看起来@Jason Coco 是对的。我做不到（干净而快速）：

来自苹果：

> 注意：如果要更改单元格的背景颜色（通过 UIView 声明的 backgroundColor 属性设置单元格的背景颜色），您必须在委托的 tableView:willDisplayCell:forRowAtIndexPath: 方法中进行，而不是在 tableView :cellForRowAtIndexPath: 数据源的。更改组样式表视图中单元格的背景颜色在 iOS 3.0 中的效果与以前版本的操作系统不同。它现在影响圆角矩形内部的区域，而不是它外部的区域。 [参考](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableViewCell_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006938)

因此，如果我真的想要，我必须设置一些变量，然后调用`reloadData`table 或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:37:48.513

因为一个单元格包含其他视图。您必须检查 和的`cell.contentView`颜色。如果所有这些都是，你可以只是动画。`cell.accessoryView``cell.backgroundView``[UIColor clearColor]``cell.backgroundColor`

# sql - 从表变量中选择的数据与插入的顺序不同？

> ID：10984006
> 
> 赞同：0
> 
> 时间：2012-06-11T16:26:34.297
> 
> 标签：sql, sql-server

我有一个数据类型为 Varchar(MAX) 的表变量。

我首先插入值'header'，然后基于内部连接，我接下来将'Details'插入到同一个表变量中。最后，我要插入“预告片”。

我得到的输出顺序是：'header'，然后是'trailer'，最后是'details'。

我需要的输出是这样的：

```
Header 
Detail
Trailer 
```

但我收到了这个订单：

```
Header
Trailer
Detail 
```

注意：我无法在选择中使用 asc/desc。我按我需要的顺序插入。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T16:27:44.313

如果你没有在外部查询中包含 ORDER BY，不要指望 SQL Server 能读懂你的想法。不能保证 SQL Server 将按照插入的顺序返回数据。你应该在你的表变量中添加一个名为`[rank]`或其他东西的列。当您插入标题时，插入 1，为详细信息行插入 2，然后为尾部插入 3。现在您可以添加`ORDER BY [rank];`到查询的末尾，得到可预测的结果，每个人都很高兴。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T17:51:05.773

SQL 数据库实际上并不了解您将事物放入的顺序，或者以给定的顺序存储数据。您可能希望表中的第二列具有要使用的值，以便保留所需的任何顺序。

把它想象成把一些东西交给你的朋友拿着——她稍后会为你准备好所有的东西，但同时她会把它存放在某个地方。当你不想为其他东西腾出空间时，她可能会移动它，或者可能会按照你给她的相同顺序把它交还给她，但你没有告诉她保持秩序，所以她不会.

数据库需要能够在后台移动事物，因此它们的构建方式本质上并不知道任何顺序 - 当您将其提供给数据库时，您需要知道顺序，以便您可以将其放回稍后订购您想要的。order 子句允许 SQL 对数据强加一个顺序，但它不记得或自己有一个。

# java - 使用 Gdata (Java) 在 Google Drive 上编辑电子表格

> ID：10984010
> 
> 赞同：0
> 
> 时间：2012-06-11T16:26:58.010
> 
> 标签：java, gdata, google-sheets, google-drive-api

我正在尝试使用 Java 和 gdata api 在我的 google_drive 上编辑公共电子表格（密钥 = 0Av4aUydPYoNAdHV2MnRaSFhrY0NSZnNOS28yTlhRTVE），但没有成功。我将网址从[https://spreadsheets.google.com/feeds/worksheets/key/private/full](https://spreadsheets.google.com/feeds/worksheets/key/private/full)更改为[https://spreadsheets.google.com/feeds/worksheets/0Av4aUydPYoNAdHV2MnRaSFhrY0NSZnNOS28yTlhRTVE/private/full](https://spreadsheets.google.com/feeds/worksheets/0Av4aUydPYoNAdHV2MnRaSFhrY0NSZnNOS28yTlhRTVE/private/full)，但返回：

> 线程“主”com.google.gdata.util.InvalidEntryException 中的异常：错误请求

这是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:43:33.760

您使用的 URL 无效，正确的 URL 用`/private/`代替`/public/`，如：

[https://spreadsheets.google.com/feeds/worksheets/0Av4aUydPYoNAdHV2MnRaSFhrY0NSZnNOS28yTlhRTVE/private/full](https://spreadsheets.google.com/feeds/worksheets/0Av4aUydPYoNAdHV2MnRaSFhrY0NSZnNOS28yTlhRTVE/private/full)

# ruby-on-rails - Rails 3.2中的ActiveRecord connectionPool没有在正确的数据库中创建表

> ID：10984018
> 
> 赞同：0
> 
> 时间：2012-06-11T16:27:31.913
> 
> 标签：ruby-on-rails, activerecord, rails-migrations

我正在将我的项目从 rails 3.0.9 升级到 rails 3.2.5。我正在使用多个数据库，当在 rails 3.2.5 中运行迁移时，一切运行正常，但它是在默认数据库而不是相应数据库中创建的。

我认为这是连接池的问题，但连接池的错误已针对 rails 3.1.x 修复

这些是我的模型：

```
class Account < ActiveRecord::Base
  establish_connection :accounts
end

class Patient < ActiveRecord::Base
end 
```

:accounts 它是与其他数据库的连接，而其他类使用默认连接：

这是我的 database.yml（我正在使用外部文件，因此我可以在不更改代码的情况下修改数据库连接）。

```
development:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: <%= database_config_file['database_dev'] %>
  pool: 5
  username: <%= database_config_file['username'] %>
  password: <%= database_config_file['password'] %>
  socket: /var/lib/mysql/mysql.sock

accounts:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: <%= database_config_file['database_account'] %>
  pool: 5
  username: <%= database_config_file['username'] %>
  password: <%= database_config_file['password'] %>
  socket: /var/lib/mysql/mysql.sock 
```

这是我的课程迁移：

```
class CreateAccounts < ActiveRecord::Migration

  def self.connection
    Account.connection #Account model has a connection to the database I want
  end

  ...
end 
```

希望有人可以帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:57:40.040

您计划进行迁移的数据库必须在`development`key 下指定（除非您想创建新环境）和旧数据库 - 例如`old_db`在您的 yml 文件中。

然后我建议你`legacy_base.rb`在你的`models/`文件夹中创建以下内容：

```
class LegacyBase < ActiveRecord::Base
  self.abstract_class = true
  establish_connection :old_db # points to your legacy DB
end 
```

然后对于属于您的旧数据库的每个模型，您必须替换：

```
class SomeModel < ActiveRecord::Base 
```

和：

```
class SomeModel < LegacyBase 
```

这样，您的“遗产”将使用您的旧数据库，而新创建的模型/迁移将使用您的新数据库，而无需任何技巧。

我希望我能理解你的意图。

# meteor - Get Meteor collection by name

> ID：10984030
> 
> 赞同：24
> 
> 时间：2012-06-11T16:28:29.150
> 
> 标签：meteor

Suppose I write:

```
new Meteor.Collection("foos");
new Meteor.Collection("bars"); 
```

Is there an API for accessing those collections by name? Something like `Meteor.Collection.get(name)`, where `name` is `"foos"` or `"bars"`? I know I could write something like

```
var MyCollections = {
    foos: new Meteor.Collection("foos");
    bars: new Meteor.Collection("bars");
} 
```

and then use `MyCollections[name]`, but I'd prefer to use an existing API if one exists.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-12-26T13:48:53.863

Based on Shane Donelley's mongoinspector [https://github.com/shanedonnelly1/mongoinspector](https://github.com/shanedonnelly1/mongoinspector)

```
getCollection = function (string) {
for (var globalObject in window) {
    if (window[globalObject] instanceof Meteor.Collection) {
        if (globalObject === string) {
            return (window[globalObject]);
            break;
        };        
    }
}
return undefined; // if none of the collections match
}; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-11-17T10:20:31.833

I've just found that package : [https://github.com/dburles/mongo-collection-instances/](https://github.com/dburles/mongo-collection-instances/)

It allow you to

```
Foo1 = new Mongo.Collection('foo'); // local
Foo2 = new Mongo.Collection('foo', { connection: connection });

Mongo.Collection.get('foo') // returns instance of Foo1

Mongo.Collection.get('foo', { connection: connection }); 
// returns instance of Foo2 
```

Hope it will help

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-06-21T07:40:55.237

This feature was added to Meteor in Feb 2016: ["Provide a way to access collections from stores on the client"](https://github.com/meteor/meteor/pull/6160)

It works like this:

`Meteor.connection._stores['tasks']._getCollection();`

And I was using it as follows to test inserts using the javascript console:

`Meteor.connection._stores['tasks']._getCollection().insert({text:'test'});`

For the insert it required the `insecure` package to still be installed otherwise got an access denied message.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-11T22:57:02.973

As far as I can see in the `collection.js` source there currently is no way in the api to get an existing Collection by name, once it has already been initialized on the server. It probably wouldn't be hard to add that feature.

So, why not fork Meteor and submit a patch or create a smart package and share it I'm sure there are others out there who'd like the same feature.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-08-09T08:40:23.510

With [https://github.com/dburles/mongo-collection-instances](https://github.com/dburles/mongo-collection-instances) you can use `Mongo.Collection.get('collectionname')`

Note that the parameter you're inserting is the same one you use when creating the collection. So if you're using `const Products = new Mongo.Collection('products')` then you should use `get('products')` (lowercase).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-12T03:36:04.570

Note that they have a return value, so you can just do

```
var Patterns = new Meteor.Collection("patterns"); 
```

and use `Patterns` *everywhere*.

And when you need to subscribe to server updates, provide `"patterns"` to `Meteor.subscribe()`.

* * *

If you have the same code for multiple collections, the chance is high that you're doing something wrong from a software engineering viewpoint; why not use a single collection with a `type` field (or something else that differentiates the documents) and use that instead of using multiple collections?

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-11T21:28:13.683

Rather than looking, I've just been doing:

```
Foos = new Meteor.Collection("foos"); 
```

or possibly put it inside another object. I haven't really been making a Collections collection object.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-24T05:11:28.267

It seems there is no way to get at the wrapped Meteor.Collection object without saving it at creation time, as others have mentioned.

But there is at least a way to list all created collections, and actually access the corresponding Mongo LocalCollection object. They are available from any Meteor Collection object, so to keep it generalistic you can create a dummy collection just for this. Use a method as such (CoffeeScript):

```
dummy = new Meteor.Collection 'dummy'
getCollection = (name) ->
  dummy._driver.collections[name] 
```

These objects do have all the find, findOne, update et al methods, and even some that Meteor doesn't seem to expose, like pauseObservers and resumeObservers which seem interesting. But I haven't tried fiddling with this mongo LocalCollection reference directly to knowif it will update the server collection accordingly.

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-06-12T13:58:30.930

```
var bars = new Meteor.Collection("foos"); 
```

Judging by what the collection.js does, the line we use to instantiate the collection object opens a connection to the database and looks for the collection matching the name we give. So in this case a connection is made and the collection 'foos' is bound to the Meteor.Collection object 'bars'. See `collection.js` AND `remote_collection_driver.js` within the mongo-livedata package.

As is the way with MongoDB, whilst you can, you don't have to explicitly create collections. As stated in the MongoDB documentation:

> A collection is created when the first document is inserted.

So, I think what you're after is what you already have - unless I've totally misunderstood what you're intentions are.

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2013-12-18T15:06:12.477

You can always roll your own automatic collection getter.

Say you have a couple of collections called "Businesses" and "Clients". Put a reference each into some "collections" object and register a Handlebars helper to access those "collections" by collections["name"].

i.e. put something like this on the client-side `main.js`:

```
collections = collections || {};
collections.Businesses = Businesses;
collections.Clients = Clients;

Handlebars.registerHelper("getCollection", function(coll) {
  return  collections[coll].find();
}); 
```

Then in your HTML, just refer to the collection by name:

```
{{#each getCollection 'Businesses'}}
  <div> Business: {{_id}} </div>
{{/each}}

{{#each getCollection 'Clients'}}
  <div> Client: {{_id}} </div>
{{/each}} 
```

Look ma, no more generic "list all records" boilerplate js required!

# php - 显示属于用户的所有图像

> ID：10984031
> 
> 赞同：0
> 
> 时间：2012-06-11T16:28:36.653
> 
> 标签：php, mysql

我有四个表：分类、州、城市和 img。我想显示属于唯一 ID（用户）的所有图像。

例如：来自明尼阿波利斯（城市）明尼苏达州（州）的用户发布了一条关于销售有 5 张图片的汽车的广告。

我得到了这个查询的一切工作，除了结果是重复每个图像的用户信息。

```
<?php
$query  = mysql_query("SELECT * FROM classifieds 
    LEFT JOIN  img ON img.classified_id = classifieds.id     
    LEFT JOIN  state ON classifieds.state_id = state.id 
     LEFT JOIN  city ON classifieds.city_id = city.id WHERE id = '".$id."'  AND  

    authorized = '1' 

   ");
   while($row = mysql_fetch_array($query, MYSQL_ASSOC))
   {   
   ?>      

    <div align="center"><a href=' <?php echo $row['image_path']; ?>' rel='lightbox'  

    title='<?php echo $row['title']; ?>' style='text-decoration:none;'> <img 

   src='<?php echo $row['image_path']; ?>' width='150' border='0' />
     </a>
   </div>

   <div class="show_location" style="width:225px; hight:10px; padding-top:20px;"> 

    <span  class='style55'><?php echo $lang['D_STATE']; ?> <span style="color:#06F"> 

   <?php echo $row['statename']; ?></span> </div>

   <div style="width:225px; hight:10px; padding-top:20px;"> <?php echo 

   $lang['D_CITY']; ?><span style="color:#06F"> <?php echo $row['city']; ?></span> 

   </span> </div>

   <?php
   }
   ?> 
```

我在这个网站上查找了一些答案，并尝试分组，但它只返回第一张图片。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:43:30.317

您的“img”表具有相同“classified_id”的多条记录。因此，您的查询将为相同的分类 ID 生成多条记录。你在这里有两个选择

1.  而不是在主查询中加入 img 表，而是编写单独的查询以在 while 循环中获取图像。

2.  使用“group_concat”函数检索图像。但您必须将连接字符串拆分为图像名称。

试试这个（第一个选项）

```
<?php
$query  = mysql_query("SELECT * FROM classifieds 
LEFT JOIN  state ON classifieds.state_id = state.id 
LEFT JOIN  city ON classifieds.city_id = city.id WHERE classifieds.id = '" . $id . "'  AND authorized = '1'");

$row = mysql_fetch_array($query, MYSQL_ASSOC);

$get_images_query = "SELECT * FROM img WHERE classified_id = " . $row['id'];
$exec_get_images_query = mysql_query($get_images_query);
while($res_images = mysql_fetch_array($exec_get_images_query))
{   
    ?>
    <div align="center"><a href=' <?php echo $res_images['image_path']; ?>' rel='lightbox' title='<?php echo $row['title']; ?>' style='text-decoration:none;'> <img src='<?php echo $res_images['image_path']; ?>' width='150' border='0' /></a>
   </div>
   <?php
}
?>
<div class="show_location" style="width:225px; hight:10px; padding-top:20px;"><span  class='style55'><?php echo $lang['D_STATE']; ?> <span style="color:#06F"> <?php echo $row['statename']; ?></span></div>
<div style="width:225px; hight:10px; padding-top:20px;"><?php echo $lang['D_CITY']; ?><span style="color:#06F"> <?php echo $row['city']; ?></span></div> 
```

# c# - DateTimePicker 控件 - 未选择日期时显示“请选择日期”

> ID：10984032
> 
> 赞同：0
> 
> 时间：2012-06-11T16:28:38.730
> 
> 标签：c#, .net

未选择日期时如何向用户提供消息？我想在 DateTimePicker 顶部有一个标签 - “请选择一个日期”。当开始时没有选择日期时，标签将被激活。从日历中选择日期后，标签将设置为不可见。

有没有其他方法可以通过使用“ **DateTimePicker Messages** ”来完成我的任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:46:57.820

对于 DateTimePicker，您实际上有几个选项。

我使用了***AjaxControlToolkit 日历扩展器控件***，它与页面字段验证功能配合得很好。

还有[JQuery DatePicker](http://jqueryui.com/demos/datepicker)。

或者尝试使用 VS 中的验证控件。:)

# html - 页面中的css对齐

> ID：10984033
> 
> 赞同：0
> 
> 时间：2012-06-11T16:28:43.183
> 
> 标签：html, css

我试图将“讨论”“埋葬”与网站中的上述文本对齐，但徒劳无功 [http://pligg.marsgibson.info/story.php?title=latest-headling-mews-gossip-fun-entertainment-music -gala-and-so-on-for-for-you-only-for-the- purpose-of-entertainment-you](http://pligg.marsgibson.info/story.php?title=latest-headling-mews-gossip-fun-entertainment-music-gala-and-so-on-for-you-only-for-the-purpose-of-entertaining-you)

看截图

![在此处输入图像描述](../Images/02241af9b5020695951b045489884ae8.png)

我想像屏幕截图一样对齐

这如何实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:33:41.243

您需要将 span.linksummaryDiscuss 移动到带有 storycontent1 类的 div

或者只是将它包装在一个 div 中并设置它的样式（有点类似于 div.storycontent1）

```
.newdiv {
    padding: 0 80px;
    width: 580px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:33:43.167

**选项1**

删除左填充`.storycontent1`：

```
.storycontent1
{
    padding-left:0;
} 
```

然后将填充添加到`.storycontent`

```
.storycontent
{
    padding-left:80px;
} 
```

**选项 2**

添加此样式规则：

```
#linksummaryDiscuss {
    padding-left: 80px;
} 
```

此选项仅在`Discuss`跨度始终存在时才有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:37:04.473

移动样式：`padding: 0 80px;`从`.storycontent1`选择器到`.storycontent`.

# windows-8 - 无法在 Windows 8 中播放声音

> ID：10984038
> 
> 赞同：4
> 
> 时间：2012-06-11T16:28:51.520
> 
> 标签：windows-8

我想在 Windows 8 Metro 风格的应用程序中播放 mp3 文件中的声音。我尝试了两种方法来做到这一点：

方法 1：
这是使用[https://stackoverflow.com/a/10961201/147530](https://stackoverflow.com/a/10961201/147530)提供的代码。有用。

方法2：
在这里我只是新建一个`MediaElement`并设置它的`Source`属性，如下所示：

```
var x = new MediaElement { Source = new Uri("ms-appx:/Assets/MyMp3File.mp3") }; 
```

但是，当我做`x.Play()`任何事情时，什么都没有发生。没有抛出异常。

问题：我怎样才能使方法2起作用？

编辑：想要更新没有`MediaFailed, MediaOpened, MediaEnded`使用方法 2 调用任何事件处理程序。

```
sound = new MediaElement { Source = new Uri("ms-appx:/Assets/Clook.mp3") };
                    sound.MediaFailed += sound_MediaFailed;
                    sound.MediaOpened += sound_MediaOpened;
                    sound.MediaEnded += sound_MediaEnded;

static void sound_MediaEnded(object sender, RoutedEventArgs e)
        {
            Debugger.Break();
        }

        static void sound_MediaOpened(object sender, RoutedEventArgs e)
        {
            Debugger.Break();
        }

        static void sound_MediaFailed(object sender, ExceptionRoutedEventArgs e)
        {
            Debugger.Break();
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T20:30:21.203

有几件事要尝试。试试下面的代码

```
var music = new MediaElement()
{
  AudioCategory = AudioCategory.ForegroundOnlyMedia,
  Source = new Uri(this.BaseUri, "Assets/MyMp3File.mp3")
};

// This is really the only difference, adding it to the visual tree
// LayoutRoot is the root of the visual tree, in the case, a grid in my XAML
LayoutRoot.Children.Add(music);

music.Play(); 
```

将其添加到可视化树可能是关键。在此设置一个断点以确保您的 MediaElement 中有数据。

其次（实际上发生在我身上，这就是我提到它的原因），我在三星设备上开发 //Build 有一个扩展坞。当设备位于扩展坞中时，设备上的音频插孔和扬声器被禁用。您必须将耳机直接插入坞站或将其从坞站中取出才能听到任何声音。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T12:15:56.850

您必须先将 MediaElement 放在 visualTree 中才能播放任何媒体:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T13:41:34.567

使用`x.autoplay = true`. 使用自动播放，它将等到加载完毕。

# c# - Post 参数始终为空

> ID：10984040
> 
> 赞同：214
> 
> 时间：2012-06-11T16:29:19.670
> 
> 标签：c#, .net, asp.net-web-api, asp.net-web-api-routing

自从升级到 RC for WebAPI 后，我在我的 WebAPI 上调用 POST 时遇到了一些真正奇怪的问题。我什至回到了新项目生成的基本版本。所以：

```
public void Post(string value)
{
} 
```

并从 Fiddler 调用：

```
Header:
User-Agent: Fiddler
Host: localhost:60725
Content-Type: application/json
Content-Length: 29

Body:
{
    "value": "test"
} 
```

当我调试时，永远不会分配字符串“值”。它总是为NULL。有人有这个问题吗？

（我第一次看到更复杂类型的问题）

该问题不仅与 ASP.NET MVC 4 绑定，RC 安装后的全新 ASP.NET MVC 3 项目也会出现同样的问题

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2014-08-05T17:04:06.980

我今天一直在为此挠头。

我的解决方案是将 更改`[FromBody]`为`HttpRequestMessage`，本质上是向上移动 HTTP 堆栈。

在我的情况下，我通过压缩 json 的线路发送数据，然后是 base64'd。这一切都来自一个安卓应用程序。

我的 Web 端点的原始签名如下所示（使用`[FromBody]`）：

![我原来的端点](../Images/d9f2fc6577b73650705755b26212290f.png)

我对这个问题的解决方法是恢复使用 a`HttpRequestMessage`作为我的端点的签名。

![在此处输入图像描述](../Images/598df105f96d1685da89443d5d1df660.png)

然后，您可以使用以下代码行访问帖子数据：

![在此处输入图像描述](../Images/fb566c2739f95ad935a37e88dfa44a44.png)

这有效并允许您访问原始未触及的帖子数据。您不必弄乱提琴手在字符串的开头放置一个 = 符号或更改内容类型。

顺便说一句，我首先尝试遵循上述答案之一，即将内容类型更改为：“Content-Type: application/x-www-form-urlencoded”。对于原始数据，这是一个不好的建议，因为它会去掉 + 字符。

所以一个像这样开头的base64字符串：“MQ0AAB+LCAAAAAA”最终会像这样“MQ0AAB LCAAAAAA”！不是你想要的。

使用的另一个好处`HttpRequestMessage`是您可以从端点内访问所有 http 标头。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2012-06-11T19:05:37.163

由于您只有一个参数，您可以尝试使用`[FromBody]`属性来装饰它，或者更改方法以接受具有值作为属性的 DTO，正如我在这里建议的那样：[MVC4 RC WebApi parameter binding](https://stackoverflow.com/questions/10955629/mvc4-rc-webapi-parameter-binding/10956025)

更新：官方 ASP.NET 网站今天更新了一个很好的解释：[https ://docs.microsoft.com/en-us/aspnet/web-api/overview/advanced/sending-html-form-data-part- 1](https://docs.microsoft.com/en-us/aspnet/web-api/overview/advanced/sending-html-form-data-part-1)

简而言之，当在正文中发送单个简单类型时，只发送以等号 (=) 为前缀的值，例如正文：

`=test`

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2012-10-23T12:30:20.407

我刚刚使用 Fiddler 发生了这种情况。问题是我没有指定`Content-Type`.

尝试`Content-Type`在您的 POST 请求中包含一个标头。

```
Content-Type: application/x-www-form-urlencoded 
```

* * *

或者，根据下面的评论，您可能需要包含 JSON 标头

```
Content-Type: application/json 
```

* * *

## 回答 #4

> 赞同：60
> 
> 时间：2013-10-21T18:03:29.670

我也遇到了这个问题，这就是我解决问题的方法

网络API代码：

```
public void Post([FromBody] dynamic data)
{
    string value = data.value;
    /* do stuff */
} 
```

客户端代码：

```
$.post( "webapi/address", { value: "some value" } ); 
```

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2017-03-05T14:29:39.033

我正在使用`Postman`并且我做同样的错误..传递`value`as json 对象而不是字符串

```
{
    "value": "test"
} 
```

显然，当 api 参数是字符串类型时，上面的***错误。***

因此，只需在 api 正文中用双引号传递字符串：

```
"test" 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2012-07-05T07:15:56.733

尝试创建一个类作为数据模型，然后发送一个 JSON 对象，其属性与您的数据模型类的属性相匹配。（注意：我已经对此进行了测试，它适用于我今天刚刚下载的最新 MVC 4 RC 2012）。

```
public HttpResponseMessage Post(ValueModel model)
{
    return Request.CreateResponse<string>(HttpStatusCode.OK, "Value Recieved: " + model.Value);
}

public class ValueModel
{
    public string Value { get; set; }
} 
```

以下 JSON 对象在 HTTP-POST 正文中发送，内容类型为 application/json

```
{ "value": "In MVC4 Beta you could map to simple types like string, but testing with RC 2012 I have only been able to map to DataModels and only JSON (application/json) and url-encoded (application/x-www-form-urlencoded body formats have worked. XML is not working for some reason" } 
```

我相信您必须创建数据模型类的原因是因为假设简单值来自 url 参数，而假设单个复杂值来自正文。它们确实具有`[FromBody]`and`[FromUrl]`属性，但使用`[FromBody] string value`仍然对我不起作用。似乎他们仍在解决很多错误，所以我相信这在未来会改变。

**编辑：** 让 XML 在正文中工作。默认 XML 序列化程序已更改为 DataContractSerializer 而不是 XmlSerializer。将以下行放入我的 Global.asax 文件中解决了这个问题（[参考](http://www.asp.net/web-api/overview/formats-and-model-binding/json-and-xml-serialization)）

```
GlobalConfiguration.Configuration.Formatters.XmlFormatter.UseXmlSerializer = true; 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2017-12-24T11:28:24.060

经过一些尝试，我认为默认行为是正确的，没有什么可以破解的。

唯一的技巧是：如果您的 post 方法参数`string`如下所示，您应该在正文中发送**一个带有双引号的纯字符串**（使用 ajax 或 postman 时），例如，

```
//send "{\"a\":1}" in body to me, note the outer double quotes
[HttpPost("api1")]
public String PostMethod1([FromBody]string value)
{
    return "received " + value; //  "received {\"a\":1}"
} 
```

否则，如果您在帖子正文中发送一个**没有外部双引号**和转义内部引号的 json 字符串，那么它应该能够被解析为模型类（参数类型），例如，`{"a":1, "b":2}`

```
public class MyPoco{
    public int a;
    public int b;
}

//send {"a":1, "b":2} in body to me
[HttpPost("api2")]
public String PostMethod2([FromBody]MyPoco value)
{
    return "received " + value.ToString();  //"received your_namespace+MyPoco"
} 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2015-04-20T13:00:54.240

我一直在寻找这个问题的解决方案几分钟，所以我将分享我的解决方案。

如果您发布模型，您的模型需要有一个空/默认构造函数，否则显然无法创建模型。重构时要小心。;)

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2016-11-26T11:48:24.097

对于那些像我一样对**Swagger**或**Postman**有同样问题的人，如果您在帖子中将简单属性作为字符串传递，即使指定了“ContentType”，您仍然会得到一个空值。

只是通过：

我的价值

将作为 null 进入控制器。

但如果你通过：

**“我的价值”**

值会正确。

引用在这里有所作为。当然，这仅适用于 Swagger 和 Postman。例如，在使用 Angular 的前端应用程序中，这应该由框架自动解决。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2016-03-21T16:24:08.840

这对我有用：

1.  创建一个 C# DTO 类，为要从 jQuery/Ajax 传递的每个属性创建一个属性

    ```
    public class EntityData
    {
        public string Attr1 { get; set; }
        public string Attr2 { get; set; }
    } 
    ```

2.  定义 web api 方法：

    ```
    [HttpPost()]
    public JObject AddNewEntity([FromBody] EntityData entityData)
    { 
    ```

3.  像这样调用 web api：

    ```
    var entityData = {
        "attr1": "value1",
        "attr2": "value2"
    };

    $.ajax({
        type: "POST",
        url: "/api/YOURCONTROLLER/addnewentity",
        async: true,
        cache: false,
        data: JSON.stringify(entityData),
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (response) {
            ...
        }
    }); 
    ```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2013-07-12T15:23:53.953

我遇到了同样的问题，发现将内容类型更改为“application/json”时并没有解决问题。但是“application/json; charset=utf-8”起作用了。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-08-09T13:32:56.953

我有一个类似的问题，我的 Web API 方法的请求对象始终为空。我注意到由于控制器操作名称以“Get”为前缀，Web API 将其视为 HTTP GET 而不是 POST。重命名控制器操作后，它现在按预期工作。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2015-07-03T00:11:16.317

使用 Angular，我能够以这种格式传递数据：

```
 data: '=' + JSON.stringify({ u: $scope.usrname1, p: $scope.pwd1 }),
 headers: { 'Content-Type': 'application/x-www-form-urlencoded; charset=utf-8' } 
```

在 Web API 控制器中：

```
 [HttpPost]
    public Hashtable Post([FromBody]string jsonString)
    {
        IDictionary<string, string> data = JsonConvert.DeserializeObject<IDictionary<string, string>>(jsonString);
        string username = data["u"];
        string pwd = data["p"];
   ...... 
```

或者，我也可以像这样发布 JSON 数据：

```
 data: { PaintingId: 1, Title: "Animal show", Price: 10.50 } 
```

并且，在控制器中，接受这样的类类型：

```
 [HttpPost]
    public string POST(Models.PostModel pm)
    {

     ....
    } 
```

无论哪种方式都有效，如果您在 API 中有一个已建立的公共类，则发布 JSON，否则发布 '=' + JSON.stringify({..: ..., .. : ... })

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-02-14T09:52:37.793

在我的情况下，问题是参数是字符串而不是对象，我将参数更改为 Newsoft.Json 的 JObject 并且它可以工作。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2016-10-29T10:36:39.620

如果您确定您发送的 JSON，那么您必须仔细跟踪您的 API：

1.  安装`Microsoft.AspNet.WebApi.Tracing`包
2.  `config.EnableSystemDiagnosticsTracing();`在`WebApiConfig`类里面添加`Register`方法。

现在查看 Debug 输出，您可能会发现无效的`ModelState`日志条目。

如果`ModelState`无效，您可能会在其中找到真正的原因`Errors`：

甚至没有人能猜到这样一个例外：

```
Could not load file or assembly 'Newtonsoft.Json, Version=9.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040) 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2012-06-11T16:48:51.113

添加行

```
 ValueProviderFactories.Factories.Add(new JsonValueProviderFactory()); 
```

到 Global.asax.cs 中的函数结束`protected void Application_Start()`在 ASP.NET MVC3 中为我修复了类似的问题。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-07-31T00:42:55.530

如果您将**DataContractSerializer**用于您的 Xml 格式化程序或 JSON 格式化程序，则需要摆脱它。我在我的 WebApiConfig 文件中有这个：

```
public static void Register(HttpConfiguration config)
{
     config.Routes.MapHttpRoute(
           name: "DefaultApi",
           routeTemplate: "api/{controller}/{id}",
           defaults: new { id = RouteParameter.Optional }
     );    

     var jsonFormatter = config.Formatters.OfType<JsonMediaTypeFormatter>().First();
     jsonFormatter.UseDataContractJsonSerializer = true;
} 
```

只需我注释掉`jsonFormatter.UseDataContractJsonSerializer = true;`，我的输入参数就不再为空了。感谢'Despertar'给我一个线索。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-11-24T16:04:31.043

对于复杂类型，Web API 尝试使用媒体类型格式化程序从消息正文中读取值。

请检查您是否有任何`[Serializable]`属性装饰您的模型类。

删除该属性以查看它是否有效。这对我有用。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2017-11-22T22:57:21.227

我有同样的问题，将 null 作为参数，但它与大对象有关。原来问题与 IIS 最大长度有关。可以在 web.config 中配置。

```
 <system.web>
    <httpRuntime targetFramework="4.7" maxRequestLength="1073741824" />
  </system.web> 
```

我想知道为什么 Web API 会抑制错误并将空对象发送到我的 API。我使用 Microsoft.AspNet.WebApi.Tracing 发现了错误。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2012-09-08T14:03:30.717

我知道这不是这个问题的答案，但我在寻找我的问题的解决方案时遇到了它。

在我的情况下，复杂类型没有被绑定，但我没有做 POST，我正在做一个带有查询字符串参数的 GET。解决方案是将 [FromUri] 添加到 arg 中：

```
public class MyController : ApiController
{
    public IEnumerable<MyModel> Get([FromUri] MyComplexType input)
    {
        // input is not null as long as [FromUri] is present in the method arg
    }
} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2015-04-13T19:45:01.253

我在 Fiddler 中遇到了同样的问题。我已经有`Content-Type: application/json; charset=utf-8`或`Content-Type: application/json`在请求标头中。

我的请求正文也是一个普通字符串，在 Fiddler 中我写过：`{'controller':'ctrl'}`. 这使得我的 POST 方法中的字符串参数成为`null`.

**修复**：记得使用引号，从而表示一个字符串。也就是说，我通过编写来修复它`"{'controller':'ctrl'}"`。（注意：在编写 JSON 时，请务必使用撇号或转义引号，如下所示：）`"{\"controller\":\"ctrl\"}"`。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2016-09-07T13:48:30.980

我发现处理传递给 MVC 6 的简单 JSON 对象的最简单方法是获取 post 参数的类型，如 NewtonSoft jObject：

```
public ActionResult Test2([FromBody] jObject str)
{
        return Json(new { message = "Test1 Returned: "+ str }); ;
} 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2016-10-09T23:36:15.390

对我来说最好的解决方案是使用完整的 HTTP，如下所示：

```
[Route("api/open")]
[HttpPost]
public async Task<string> open(HttpRequestMessage request)
{
    var json = await request.Content.ReadAsStringAsync();
    JavaScriptSerializer jss = new JavaScriptSerializer();            
    WS_OpenSession param = jss.Deserialize<WS_OpenSession>(json);
    return param.sessionid;
} 
```

然后将字符串反序列化为您期望在帖子正文中的对象。对我来说，WS_OpenSession 是一个包含 sessionid、user 和 key 的类。

您可以从那里使用 param 对象并访问其属性。

非常非常有效。

我确实说过来自这个网址：

[http://bizcoder.com/posting-raw-json-to-web-api](http://bizcoder.com/posting-raw-json-to-web-api)

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2017-01-23T07:14:28.520

我参加聚会有点晚了，但是任何偶然发现在使用控制器时传递的 NULL 值的人只需将“=”添加到您的 POST 请求的前面。

当我使用**application/json** Content-Type 时，控制器还传递了一个 NULL 值。请注意下面的“application/x-www-form-urlencoded”内容类型。然而，API 的返回类型是“application/json”。

```
 public static string HttpPostRequest(string url, Dictionary<string, string> postParameters)
    {
        string postData = "=";

        foreach (string key in postParameters.Keys)
        {
            postData += HttpUtility.UrlEncode(key) + "="
                  + HttpUtility.UrlEncode(postParameters[key]) + ",";
        }

        HttpWebRequest myHttpWebRequest = (HttpWebRequest)HttpWebRequest.Create(url);
        myHttpWebRequest.Method = "POST";

        byte[] data = System.Text.Encoding.ASCII.GetBytes(postData);

        myHttpWebRequest.ContentType = "application/x-www-form-urlencoded";
        myHttpWebRequest.ContentLength = data.Length;

        Stream requestStream = myHttpWebRequest.GetRequestStream();
        requestStream.Write(data, 0, data.Length);
        requestStream.Close();

        HttpWebResponse myHttpWebResponse = (HttpWebResponse)myHttpWebRequest.GetResponse();

        Stream responseStream = myHttpWebResponse.GetResponseStream();

        StreamReader myStreamReader = new StreamReader(responseStream, System.Text.Encoding.Default);

        string pageContent = myStreamReader.ReadToEnd();

        myStreamReader.Close();
        responseStream.Close();

        myHttpWebResponse.Close();

        return pageContent;
    } 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2017-05-26T19:06:39.963

您希望发布的值类型无关紧要，只需将其括在引号内，即可将其作为字符串获取。不适用于复杂类型。

javascript:

```
 var myData = null, url = 'api/' + 'Named/' + 'NamedMethod';

    myData = 7;

    $http.post(url, "'" + myData + "'")
         .then(function (response) { console.log(response.data); });

    myData = "some sentence";

    $http.post(url, "'" + myData + "'")
         .then(function (response) { console.log(response.data); });

    myData = { name: 'person name', age: 21 };

    $http.post(url, "'" + JSON.stringify(myData) + "'")
         .then(function (response) { console.log(response.data); });

    $http.post(url, "'" + angular.toJson(myData) + "'")
         .then(function (response) { console.log(response.data); }); 
```

C＃：

```
 public class NamedController : ApiController
    {
        [HttpPost]
        public int NamedMethod([FromBody] string value)
        {
            return value == null ? 1 : 0;
        }
    } 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2017-08-25T02:38:37.077

如果您放置了 [FromBody] 注释，并且您有一个 Dto 对象作为您的方法的参数，但仍然无法获取数据，请开始查看您的 DTO 的属性和字段。

我遇到了同样的问题，我的 DTO 即将为空。我发现原因是其中一个属性指向一个***无法序列化的对象***:(这导致媒体格式化程序无法解析数据。因此该对象始终为空。希望它也对其他人有所帮助

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2017-09-23T04:27:34.520

仔细检查您的数据类型。dotnet 模型绑定器不会将浮点数转换为整数（我假设其他相关概念）。这将导致整个模型被拒绝。

如果你有这样的json：

```
{
    "shoeSize": 10.5
} 
```

但您的 c# 模型如下所示：

```
class Shoe{
    public int shoeSize;
} 
```

模型绑定器将拒绝模型，您将获得空值。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2017-12-14T10:23:58.660

我对此已经很晚了，但是遇到了类似的问题，经过一天的时间在这里经历了很多答案并获得了背景，我找到了将一个或多个参数传回 Web API 2 Action 的最简单/轻量级的解决方案，如下所示如下：

这假设您知道如何使用正确的路由设置 Web API 控制器/操作，如果不参考：[https ://docs.microsoft.com/en-us/aspnet/web-api/overview/getting-started-with -aspnet-web-api/tutorial-your-first-web-api](https://docs.microsoft.com/en-us/aspnet/web-api/overview/getting-started-with-aspnet-web-api/tutorial-your-first-web-api)。

首先是Controller Action，这个解决方案还需要Newtonsoft.Json 库。

```
[HttpPost]
public string PostProcessData([FromBody]string parameters) {
    if (!String.IsNullOrEmpty(parameters)) {
        JObject json = JObject.Parse(parameters);

        // Code logic below
        // Can access params via json["paramName"].ToString();
    }
    return "";
} 
```

客户端使用 jQuery

```
var dataToSend = JSON.stringify({ param1: "value1", param2: "value2"...});
$.post('/Web_API_URI', { '': dataToSend }).done(function (data) {
     console.debug(data); // returned data from Web API
 }); 
```

我发现的关键问题是确保您只将一个整体参数发送回 Web API，并确保它没有名称，只有值，`{ '': dataToSend }`否则您的值在服务器端将为空。

有了这个，您可以以 JSON 结构向 Web API 发送一个或多个参数，并且您无需在服务器端声明任何额外的对象来处理复杂的数据。JObject 还允许您动态迭代传入的所有参数，以便在您的参数随时间变化时更容易扩展。希望这可以帮助像我一样挣扎的人。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2019-01-22T12:54:35.907

在 ASP.NET Core 中遇到了类似的问题，另一个可能的原因是由于各种原因导致 ASP.NET 绑定（静默）失败，例如**发送 null 以绑定到非 null 属性**：

```
{
    "prop1":1139357,
    "prop2":1139356,

    "items":[
        {"key":"15","someprop":34,"notnullprop":null},
        {"key":"16","someprop":34,"notnullprop":null},
        {"key":"22","someprop":34,"notnullprop":null}]
} 
```

在这种情况下，**不会抛出异常并且整个模型将为 null**，即使这发生在对象层次结构的深处。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2019-05-22T15:35:32.723

JSON.stringify(...) 解决了我的问题

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2015-08-04T08:08:35.730

正确将正文中的单个参数传递给 WebAPI 可以使用此代码`$.post(url, { '': productId }`

并在行动中抓住它`[HttpPost] public ShoppingCartAddRemoveViewModel Delete([FromBody]string value)`

关键是使用神奇的词“价值”。它也可能是 int 或一些原始类型。无论是内容类型还是标题更正 混乱是此代码在 mvc 发布操作中不起作用。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2017-08-23T07:49:13.387

问题是您的操作方法需要一个简单的类型，即字符串参数值。你提供的是一个对象。

*您的问题有 2 个解决方案。*

1.  创建一个具有“ **value** ”属性的简单类，然后将该类用作参数，在这种情况下，Web API 模型绑定将从请求中读取 JSON 对象并将其绑定到您的参数对象“values”属性。

2.  只需传递字符串值“ **test** ”，它就会起作用。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2017-08-26T03:26:39.563

接口：

```
[HttpPost]
public bool UpdateTicketStatus(Ticket t)
{    
    string Id=t.Id;
} 
```

模型：

```
public class Ticket
{
    public int Id { get; set; }
    public string AssignedTo { get; set; }
    public string State { get; set; }
    public string History { get; set; }
} 
```

使用 Post man 工具将内容作为带有原始数据的 json 发送，如下所示。有用

{ "Id":"169248", "AssignedTo":"xxxx", "State":"Committed", "History":"test1" }

请确保您已启用 Cors。

```
[EnableCors(origins: "*", headers: "*", methods: "*")]
    public class TicketController : ApiController
    {
} 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2017-10-18T14:08:33.960

`[JsonObject(MemberSerialization.OptOut)]`在我的例子中，用Newtonsoft的属性装饰参数类就可以了。

例如：

```
[HttpPost]
[Route("MyRoute")]
public IHttpActionResult DoWork(MyClass args)
{
   ...
}

[JsonObject(MemberSerialization.OptOut)]
public Class MyClass
{
    ...
} 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2018-04-30T15:24:27.167

如果你在 Postman 的 json 查询中有这个字符 '\'，如果你需要 json 字符串值中的字符 '\'，你应该转义它。

例子：

```
{
    "path": "C:\\Users\\Test\\Documents\\test.txt"
} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2019-01-04T16:52:45.167

希望这可以帮助。

查看不同的评论和其他论坛，我混合了一些片段，对我来说，这段代码有效......

...在控制器中

```
public HttpResponseMessage Post([FromBody] string jsonData)
    {
        HttpResponseMessage response = Request.CreateResponse(HttpStatusCode.OK, jsonData);            

        try 
        {
            string jsonString = jsonData.ToString();
            JArray jsonVal = JArray.Parse(jsonString) as JArray;
            dynamic mylist= jsonVal;
            foreach (dynamic myitem in mylist)
            {
                string strClave=string.Empty;
                string strNum=string.Empty;
                string strStatus=string.Empty;

                strClave = myitem.clave;
                strNum=myitem.num;
                strStatus = myitem.status; 
            } 
```

...在 WebApiConfig.cs 中包含这一行以避免 [FromBody] 变量中的空值**var jsonFormatter = config.Formatters.OfType().First();**

```
public static void Register(HttpConfiguration config)
    { 
            config.Routes.MapHttpRoute(
                            name: "DefaultApi",
                            routeTemplate: "api/{controller}/{id}",
                            defaults: new { id = RouteParameter.Optional }
                        );
            var jsonFormatter = config.Formatters.OfType<JsonMediaTypeFormatter>().First();  /*this line makes no more null when use [FromBody]*/
} 
```

....在客户端，最重要的是在序列化数据之前连接等号（ **string json = "=" + SerialData;** ）

对于我正在使用的序列化

```
System.Web.Script.Serialization.JavaScriptSerializer serializer = new 
System.Web.Script.Serialization.JavaScriptSerializer();

        List<Dictionary<string, object>> rows = new List<Dictionary<string, object>>();
        Dictionary<string, object> row;
        foreach (DataRow dr in DsCnx.Tables[0].Rows)
        {
            row = new Dictionary<string, object>();
            foreach (DataColumn col in DsCnx.Tables[0].Columns)
            {
                row.Add(col.ColumnName, dr[col]);
            }
            rows.Add(row);
        }
        SerialData= serializer.Serialize(rows);
       PostRequest("http://localhost:53922/api/Demo", SerialData); 
```

这是我的 PostRequest 函数，这里我使用的内容类型是**httpWebRequest.ContentType = "application/x-www-form-urlencoded; charset=utf-8";** ：

```
private static string PostRequest(string url, string SerialData)
    {         
        string result = String.Empty;
        HttpWebRequest httpWebRequest = (HttpWebRequest)WebRequest.Create(url);
        httpWebRequest.ContentType = "application/x-www-form-urlencoded; charset=utf-8";
        httpWebRequest.Method = "POST";

        using (var streamWriter = new StreamWriter(httpWebRequest.GetRequestStream()))
        {
            string json = "=" + SerialData;  
            streamWriter.Write(json);
            streamWriter.Flush();
            streamWriter.Close();
        }
        try
        {
            using (var response = httpWebRequest.GetResponse() as HttpWebResponse)
            {
                if (httpWebRequest.HaveResponse && response != null)
                {
                    using (var reader = new StreamReader(response.GetResponseStream()))
                    {
                        result = reader.ReadToEnd();
                    }
                }
            }
        }
        catch (WebException e)
        {
            if (e.Response != null)
            {
                using (var errorResponse = (HttpWebResponse)e.Response)
                {
                    using (var reader = new StreamReader(errorResponse.GetResponseStream()))
                    {
                        string error = reader.ReadToEnd();
                        result = error;
                    }
                }

            }
        }

        return result.ToString();

    } 
```

这是我找到一个供参考的代码示例的链接：

[https://weblog.west-wind.com/posts/2012/Aug/30/Using-JSONNET-for-dynamic-JSON-parsing#jobject-and-jarray-in-aspnet-web-api](https://weblog.west-wind.com/posts/2012/Aug/30/Using-JSONNET-for-dynamic-JSON-parsing#jobject-and-jarray-in-aspnet-web-api)

[https://blog.codenamed.nl/2015/05/12/why-your-frombody-parameter-is-always-null/](https://blog.codenamed.nl/2015/05/12/why-your-frombody-parameter-is-always-null/)

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2020-02-12T11:18:52.370

我知道 OP 最初发送的是单个字符串，但为了将来参考，还值得注意的是，格式错误的 JSON 也会像`null`post 方法一样到达。就我而言，两个属性之间缺少逗号会导致原本很好的东西中断。

* * *

## 回答 #38

> 赞同：-1
> 
> 时间：2020-06-10T19:39:04.657

我在这个线程中尝试了许多答案，但没有一个对我有用。然后我遇到了一个类似帖子的答案：[https](https://stackoverflow.com/a/40853424/2120023) ://stackoverflow.com/a/40853424/2120023他提到`HttpContext.Request.Body`了另一个搜索，我发现了这个[https://stackoverflow.com/a/1302851/2120023](https://stackoverflow.com/a/1302851/2120023)这给了我`HttpContext.Current`所以我终于让这个工作使用：

```
HttpContext.Current.Request.Form.Get("value"); 
```

我对邮递员的要求：

```
curl --location --request POST 'https://example.com/token' --header 'Content-Type: application/x-www-form-urlencoded' --data-urlencode 'value=test' 
```

* * *

## 回答 #39

> 赞同：-1
> 
> 时间：2021-04-11T10:07:28.570

有一天我遇到了和你一样的问题，就我而言，问题是，我用作 json 容器的类没有 get 和 set 定义，所以 API 不知道如何填充 JSON数据到实例中。

我的示例 json 类将是 .

```
public class Usuario
{
    public int id { get; set; }
    public string nombre { get; set; }
} 
```

如您所见，您分别拥有 get 和 set ，所以它会被填满。

如果您删除它们，您将获得创建该类的空实例的帖子。

* * *

## 回答 #40

> 赞同：-1
> 
> 时间：2021-09-14T13:39:56.823

通过 AJAX 调用发送原始数据上传图像时，我遇到了类似的问题，无论是否带有 [FromBody] 标签。当**请求太大**时，控制器会转储它（变量 = null），因此解决方案是增加最大请求大小、调整图像大小或类似方法。

此处描述了增加请求大小的方法：[https ://stackoverflow.com/a/16403447](https://stackoverflow.com/a/16403447)

* * *

## 回答 #41

> 赞同：-3
> 
> 时间：2015-12-09T16:26:02.420

这个链接帮助了我：[http ://encosia.com/using-jquery-to-post-frombody-parameters-to-web-api/](http://encosia.com/using-jquery-to-post-frombody-parameters-to-web-api/)

基本上它说您应该为参数使用空名称：

```
public string Post([FromBody]string myParameter){ 
...
}  

$.post("/api/dosomething", { '' : "myvalue" }); 
```

# python - Fabric“TypeError：并非所有参数都在字符串格式化期间转换”

> ID：10984044
> 
> 赞同：1
> 
> 时间：2012-06-11T16:29:31.803
> 
> 标签：python, fabric

我有以下织物任务：

```
@task
def deploy_west_ec2_ami(name, puppetClass, size='m1.small', region='us-west-1', basedn='joe', ldap='arch-ldap-01', secret='secret', subnet='subnet-d43b8abd', sgroup='sg-926578fe'):
    execute(deploy_ec2_ami, name='%s',puppetClass='%s',size='%s',region='%s',basedn='%s',ldap='%s',secret='%s',subnet='%s',sgroup='%s' %(name, puppetClass, size, region, basedn, ldap, secret, subnet, sgroup)) 
```

但是，当我运行命令时：

```
fab deploy_west_ec2_ami:test,java 
```

我得到以下回溯：

```
 Traceback (most recent call last):
              File "/usr/local/lib/python2.6/dist-packages/fabric/main.py", line 710, in main
                *args, **kwargs
              File "/usr/local/lib/python2.6/dist-packages/fabric/tasks.py", line 321, in execute
                results['<local-only>'] = task.run(*args, **new_kwargs)
              File "/usr/local/lib/python2.6/dist-packages/fabric/tasks.py", line 113, in run
                return self.wrapped(*args, **kwargs)
              File "/home/bcarpio/Projects/githubenterprise/awsdeploy/fabfile.py", line 35, in deploy_west_ec2_ami
                execute(deploy_ec2_ami, name='%s',puppetClass='%s',size='%s',region='%s',basedn='%s',ldap='%s',secret='%s',subnet='%s',sgroup='%s' %(name, puppetClass, size, region, basedn, ldap, secret, subnet, sgroup))
            TypeError: not all arguments converted during string formatting 
```

我不确定我明白为什么。我很确定我在这里定义的所有值都很好。

另外，当我这样运行执行任务 deploy_ec2_ami 时：

```
deploy_ec2_ami:test,java,m1.small,us-west-1,'dc\=test\,dc\=net',ldap-01,secret,subnet-d43b8abd,sg-926578fe 
```

它工作得很好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:40:18.863

好的，问题是使用执行时必须定义一个主机=。我的其他 fab 任务不需要 host= 所以我只输入了常规 python：

```
deploy_ec2_ami (name, puppetClass, size, region, basedn, ldap, secret, subnet, sgroup) 
```

这一切都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:37:09.417

您将一组关键字参数传递给该`execute`方法，并且只有最后一个值被视为字符串插值的目标：

```
sgroup='%s' %(name, puppetClass
        , size, region, basedn, ldap, secret, subnet, sgroup)) 
```

这里不需要使用字符串插值；只需将所有参数传递给`execute`方法：

```
execute(deploy_ec2_ami, name=name, puppetClass=puppetClass, size=size, region=region, basedn=basedn, ldap=ldap, secret=secret, subnet=subnet, sgroup=sgroup) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T09:48:39.253

从线

```
sgroup='%s' %(name, puppetClass, size, region, basedn, ldap, secret, subnet, sgroup) 
```

字符串插值适用于一个字符串，而不适用于所有参数。我是说

```
'%s %s' % (arg1, arg2) 
```

但如果你尝试

```
'%s' % (arg1, arg2) 
```

arg2 没有空间

如果您想继续进行字符串插值，我建议您这样做：

```
execute(deploy_ec2_ami, name='%s' % name, puppetClass='%s' % puppetClass, size='%s' % size, region='%s' % region, and so on 
```

由于您没有更改参数中的任何内容，因此我肯定会选择 Brian 解决方案

# javascript - js/ajax w/ onkeypress 节流

> ID：10984053
> 
> 赞同：1
> 
> 时间：2012-06-11T16:30:34.097
> 
> 标签：javascript, jquery, keypress, onkeyup

作为人员类型处理动态请求。想尝试限制它，以免每次按键都会触发呼叫。

第一个想法是设置 1 秒的时间，并在每次按键时清除超时，因此等到有 1 秒的延迟，然后再推送请求。

想知道是否有更清洁的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:46:21.177

[Underscore.js](http://underscorejs.org/#throttle)提供了一个节流函数，它创建了一个每 x 毫秒只执行一次的函数版本。你可能想调查一下

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:46:36.450

如果您没有大量同时运行的其他脚本，该解决方案将运行良好。

否则，您可以设置一个`if`循环，例如每 5 次按键触发一次呼叫。像这样的东西：

```
if(i == 5) {
    //Execute your call
} 
```

然后你每次按下一个键时都会增加 i 的值。

但当然还有更多的解决方案。

# css - 有弹性的分段页脚行为不端。给出了紧凑的实时示例

> ID：10984055
> 
> 赞同：0
> 
> 时间：2012-06-11T16:30:38.370
> 
> 标签：css, css-float, footer, css-position, image-segmentation

我需要在浏览器窗口底部固定一个曲线形的可拉伸页脚，其中曲线是图像。我模拟了一个[活生生的例子](http://test.nesevis.info/footer/)。

为了通过页脚图像的透明部分最大限度地减少较低层中“可点击”房地产的损失，我的直觉是将图像切割成几个部分（示例中的红色框）并将它们彼此相邻放置，如下所示：

```
#arc-segment-1,
#arc-segment-2 {
   position: fixed;
   z-index: 2;
   bottom: 0px;
}
#arc-segment-1 {
   width: 5%; /* where this */
   height: 82px;
   left: 0;
   background-image: url(...);
}
#arc-segment-2 {
   width: 5%;
   height: 72px;
   left: 5%; /* matches this */
   background-image: url(...);
} 
```

在大多数主流浏览器（不是 IE 和 FF）中，**随着窗口大小的调整，细线断裂在框之间来来去去**，这是不可接受的。

浮动图像片段可以解决问题，但我还没有找到一种实现方法，仍然将页脚固定到底部并保留提到的“可点击性”。有没有比我更好的方法来解决这个问题，或者可以以某种方式补救？

*关于给出的示例的注意事项：示例中的曲线图像本身尚未被剪切，它仍然是单个图像。此外，蓝色框不是问题，它们不会拉伸，因此不会受到问题的影响。*

我会对这种行为的原因和任何可行的解决方案感兴趣。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:46:19.890

你可以添加所以你可以点击下面[`pointer-events`](https://developer.mozilla.org/en/CSS/pointer-events)`: none;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T00:51:53.717

在 W3C 阅读时，我自己偶然发现了一个可行的解决方案：

如果取出段的宽度属性并给出左右属性，例如屏幕中间的 10% 宽的段：

```
#arc-segment-3 {
   left: 45%;
   right: 45%;
} 
```

尽管现在某些浏览器似乎用细线重叠了这些段，但它的行为将与最初预期的一样。就我而言，这是一个小得多的问题，因为弧线的纹理很弱，不太明显。任何有像素完美方法的人？

# vbscript - 使用简单的 VBScript 从 XMLHTTP 读取 Ajax 响应

> ID：10984057
> 
> 赞同：0
> 
> 时间：2012-06-11T16:30:45.547
> 
> 标签：vbscript, web, download, xmlhttprequest

我正在尝试使用脚本下载一组网站：

```
dim xmlhttp : set xmlhttp = createobject("Msxml2.ServerXMLHTTP")
xmlhttp.open "GET", "http://www.website.com/tags/search-term?page=1, false

xmlhttp.send

text= xmlhttp.ResponseText 
```

Firebug 告诉我响应在 DOM "_result" 中。但是我怎样才能读出来呢？我知道这是一个非常愚蠢的问题，但我只需要为一个研究项目运行大量自动搜索，并且正在努力实现它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:42:44.400

只需像这样读取对象的响应

```
response=xmlhttp.responseText 
```

# javascript - 嵌套的异步调用似乎没有按预期执行

> ID：10984058
> 
> 赞同：1
> 
> 时间：2012-06-11T16:30:45.507
> 
> 标签：javascript, jquery, scope

在尝试 jQuery 时，我有一个可能是新手错误的问题，但我似乎找不到解决方案。这是代码：

```
$.get("index.html", function() {
    var i = 0;
    for (; i < 3; i++)
    {
        var lDiv = document.createElement('div');
        lDiv.id = 'body-' + i;
        document.getElementById('body').appendChild(lDiv);
        $.get('index.html', function(data) {
            lDiv.innerHTML = "<p>Hello World " + i + "</p>";
        });
    }
}); 
```

输出似乎是

```
<div id='body-0'></div>
<div id='body-1'></div>
<div id='body-2'>
    <p>Hello World 3</p>
</div> 
```

我希望`lDiv.innerHTML=`为每个 i 执行代码，但显然它只为最后一个 i 执行？我在看什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:33:35.450

由于`$.get()`是异步的，因此您需要在`$.get()`的`success()`回调函数中执行 append 和 next 调用。

```
var i = 0;
function recursiveLoad() {
       if(i == 3) return;
       var lDiv = document.createElement('div');
       lDiv.id = 'body-' + i;
       document.getElementById('body').appendChild(lDiv);
       $.get('index.html', function(data) {
            lDiv.innerHTML = "<p>Hello World " + i + "</p>";
            i++;
            recursiveLoad();
       });
}
// initial call
recursiveLoad(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T17:24:38.010

发生这种情况是因为循环在任何回调被触发*之前*`i`完成 ( is 2) 。

 *@thecodeparadox 的解决方案有效，但它序列化了 HTTP 请求。（使它们一次触发一个。）这允许请求并行执行，因此更快：

```
for (var i = 0; i < 3; i++)
{
    var lDiv = document.createElement('div');
    lDiv.id = 'body-' + i;
    document.getElementById('body').appendChild(lDiv);
    $.get('index.html', function(i,lDiv) { // the current iteration's `i` and `lDiv` are captured...
        return function(data) {
            lDiv.innerHTML = "<p>Hello World " + i + "</p>";
        }
    }(i,lDiv)); // ...by passing them as an argument to the self-executing function
} 
```*

# .net - 有没有办法加快读取数据的速度？

> ID：10984059
> 
> 赞同：1
> 
> 时间：2012-06-11T16:30:46.527
> 
> 标签：.net, postgresql, sqldatareader, npgsql, data-retrieval

在程序中，我创建了以下逻辑，用于从数据库中读取数据并将其存储到 List<> 中：

```
 NpgsqlCommand cmd = new NpgsqlCommand(query, conn);
                List<UserInfo> result = new List<UserInfo>();
                Npgsql.NpgsqlDataReader rdr = cmd.ExecuteReader();
                while (rdr.Read())
                {
                    string userId = rdr[0].ToString();
                    string sex = rdr[1].ToString();
                    string strDateBirth = rdr[2].ToString();
                    string zip = rdr[3].ToString();

                    UserInfo userInfo = new UserInfo();
                    userInfo.Msisdn = userId;
                    userInfo.Gender = sex;
                    try
                    {
                        userInfo.BirthDate = Convert.ToDateTime(strDateBirth);
                    }
                    catch (Exception ex)
                    {
                    }
                    userInfo.ZipCode = zip;
                    userInfo.DemographicsKnown = true;
                    userInfo.AgeGroup = getAgeGroup(strDateBirth);
                    if (result.Count(x => x.Id== userId) == 0)
                        result.Add(userInfo);
                } 
```

这段代码的性能真的很差。有超过 2M 的记录，半小时后列表 userInfo 仅包含 300.000 条记录。

有谁知道如何加快从数据库读取数据的速度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:45:01.817

`.Count`当你真正的意思时，你正在使用`.Any()`
每当你打电话时`.Count`，你都在枚举整个集合只是为了看看你是否有一个匹配......

考虑一下您要问的问题：
“您有多少行符合这个条件？那个数字等于零吗？”

您真正的意思是：
“是否有任何行符合此条件？”

在这种情况下，您可以创建 userId 值的 Hashset。检查哈希集（或字典）中的存在比检查列表中的存在要快得多。

此外，如果您**已经**拥有 userId，那么您会无缘无故地解析并读取所有值。首先检查`myHashset.Contains(userId)`，然后添加。

**这是它慢的主要原因。对于 n 行，您正在执行集合的第 n 个三角形枚举！**

**编辑：**考虑这个未经测试的更改：我不知道您的读者是否支持像`GetString()`这样的类型化读取方法，如果它不简单地使用您以前拥有的方法。

```
NpgsqlCommand cmd = new NpgsqlCommand(query, conn);
List<UserInfo> result = new List<UserInfo>();
Npgsql.NpgsqlDataReader rdr = cmd.ExecuteReader();
HashSet<string> userHash = new HashSet<string>(); // is this actually an int?

while (rdr.Read())
{
    string userId = rdr.GetString(0);
    If (!userHash.Contains(userId))
    {
        string strDateBirth = rdrGetString(2);
        UserInfo userInfo = new UserInfo();
        userInfo.Msisdn = userId;
        userInfo.Gender = rdr.GetString(1);
        datetime parseddate; // this is not used if the parse fails
        if (Datetime.TryParse(strDateBirth, out parseddate))
        {
            userInfo.BirthDate = parseddate;
            // userInfo.AgeGroup = getAgeGroup(strDateBirth); // why take the string?
            // rewrite your getAgeGroup method to take the datetime
            userInfo.AgeGroup = getAgeGroup(parseddate);
        }
        userInfo.ZipCode = rdr.GetString(3);
        userInfo.DemographicsKnown = true;
        result.Add(userInfo);
        userHash.Add(userId);
    }
} 
```

这将始终保留您找到的用户行的**第一个**实例（这是您当前代码所做的）。如果您想保留**最后一个**实例，那么您可以使用字典并`.Contains()`完全消除调用。

**编辑：**我刚刚注意到我的示例从未将 userId 添加到哈希中...哎呀...将其添加到那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:34:44.927

所有这些 execption 处理都会大大降低您的程序速度。Exceptions are for ***Exceptional Cases***如果你的代码抛出超过 10 个异常，你需要重新考虑你的设计。

而不是每次使用格式错误的日期时都抛出一个执行[`DateTime.TryParse(string, DateTime)`](http://msdn.microsoft.com/en-us/library/ch92fbc1.aspx)。它会大大加快你的代码速度。

```
////Replace This
//try
//{
//    userInfo.BirthDate = Convert.ToDateTime(strDateBirth);
//}
//catch (Exception ex)
//{
//}

//With this
DateTime bithDate;
if(DateTime.TryParse(strDateBirth, out bithDate)
{
    userInfo.BirthDate = bithDate;
} 
```

* * *

还有什么是列的数据类型`rdr[2]`？它已经是日期时间了吗？另一件事是停止在任何地方对对象调用 ToString 并使用正确的方法。

```
while(rdr.Read())
{
    UserInfo userInfo = new UserInfo();
    userInfo.Msisdn = rdr.GetString(0);
    userInfo.Gender = rdr.GetString(1);

    DateTime? birthdate = null; //This is a nullable DateTime see http://msdn.microsoft.com/en-us/library/b3h38hb0.aspx

    if(rdr.IsDbNull() == false)
    {
        birthdate = rdr.GetDateTime(2);
        userInfo.BirthDate = birthdate.Value;
    }
    userInfo.ZipCode = rdr.GetString(3);
    userInfo.DemographicsKnown = true;
    userInfo.AgeGroup = getAgeGroup(birthdate); //You may need to edit getAgeGroup to take in a nullable DateTime

    if (result.Any(x => x.Id== userId)) //Any is much faster than count for your check, see Matthew PK's answer.
        result.Add(userInfo);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-08T22:22:51.490

为了加快从数据库中获取数据的速度，您可能需要考虑使用不同的方式读取数据，而不是通过阅读器循环。

```
DataSet my_dataset = new DataSet();
NpgsqlDataAdapter my_dataadapter = default(NpgsqlDataAdapter);

NpgsqlCommand cmd = new NpgsqlCommand(query, conn);
my_dataadapter = new NpgsqlDataAdapter(cmd);
my_dataadapter.Fill(my_dataset, "mydataset"); 
```

然后对数据集做任何事情。
您可能会对速度的差异感到非常惊讶。

# javascript - 延迟 href 点击，但不使用 SetTimeout

> ID：10984060
> 
> 赞同：1
> 
> 时间：2012-06-11T16:31:04.080
> 
> 标签：javascript, jquery

我正在尝试通过谷歌分析跟踪出站链接，谷[歌建议使用这个](http://support.google.com/googleanalytics/bin/answer.py?hl=en&answer=55527)：

```
<script type="text/javascript">
  function recordOutboundLink(link, category, action) {
    _gat._getTrackerByName()._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100);
  }
</script> 
```

这很好，除了我的出站链接将在新选项卡中打开，我（自然）使用 a `target="_blank"`..

但是，该`setTimeout`方法将其取消，并在同一页面中打开链接..

我试过使用`window.open()`，但我担心它会被浏览器阻止..

那么，无论如何我可以执行这个js函数，并延迟点击一会儿吗？（谷歌建议的 100 毫秒）？

谢谢。

* * *

我已经在 SO 上查看过类似的[其他](https://stackoverflow.com/questions/3032182) [问题](https://stackoverflow.com/questions/351268)，但它们不涉及在新标签/窗口中打开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:34:37.140

很简单，只需删除其中的 setTimeout() 部分。所以它所做的只是调用 _trackEvent 函数。

您的链接应该同时执行 javascript 函数并打开新窗口，如果您只是将它们保留为：

```
<a href="example.com" target="_blank" onclick="recordOutboundLink(foo, bar)">Click here</a>

<script type="text/javascript">
  function recordOutboundLink(category, action) {
    _gat._getTrackerByName()._trackEvent(category, action);
  }
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T10:29:49.317

可以在此处改进上面的答案是一个 Jquery 插件，它可以提供监听链接选择（基于您自己的标准）并为您提供回调它们的方法。

[小提琴](http://jsfiddle.net/EBhKx/)

因此，在 OP 的情况下，设置可能如下所示：

```
<a href="http://www.google.co.uk" target="_blank" data-category="Outbound">Google</a>

$(document).ready(function() {
    $('a').trackOutBound(null,function() {
        var category= $(this).data('category');
        _gat._getTrackerByName()._trackEvent(category, $(this).attr('href'));
    });
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-09-02T19:55:01.090

在继续使用默认浏览器行为之前，我使用它来保持函数等待：

```
var wait_until = new Date().getTime() + 500;
while (new Date().getTime() < wait_until) {
    //Do nothing, wait
} 
```

# delphi - WinAPI -> CryptoAPI -> RSA，用私有加密，用公共解密

> ID：10984064
> 
> 赞同：4
> 
> 时间：2012-06-11T16:31:14.530
> 
> 标签：delphi, winapi, encryption, cryptography, cryptoapi

再会。

我需要教 Windows CryptoAPI 使用密钥的私有（非公共）部分加密消息，并使用公共解密。这是向用户提供他们可以阅读但不能更改的信息所必需的。

**现在如何运作：**

我得到了上下文

```
CryptAcquireContext(@Prov, PAnsiChar(containerName), nil, PROV_RSA_FULL, 0) 
```

生成密钥对

```
CryptGenKey(Prov, CALG_RSA_KEYX, CRYPT_EXPORTABLE, @key) 
```

加密（问题就在这里。“密钥” - 一个密钥对，该函数使用它的公共部分）；

```
CryptEncrypt(key, 0, true, 0, @res[1], @strLen, buffSize) 
```

解密（同样的问题，它使用密钥的私有部分）

```
CryptDecrypt(key, 0, true, 0, @res[1], @buffSize) 
```

感谢您的关注/帮助。

**更新**

是的，我可以使用数字签名和其他方法...

问题是我需要加密一个数据库字段并确保除了我之外没有人可以更改它。只有在我的程序的帮助下才能读取这个字段（直到有人反编译它并获得公钥）。这可以通过对称密钥和数字签名来完成，但是我需要创建另一个字段并存储另一个密钥等等......

我确实希望我们能以某种方式教 WIN API 做我想做的事。我知道我可以用 RSA 做到这一点，我希望 WinAPI 能以某种方式支持这个功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T23:42:49.897

Strictly speaking, when *"signing"* a message:

*   the person with the private key **decrypts** the hash with their **private** key.
*   they then send that *"decrypted"* hash along with the message.
*   the receiver then **encrypts** the signature with the public key

If the *"encrypted"* hash matches the hash of the original message, you know the message has not been altered, and was sent by the person with the private key. The following pseudo-code represents the signing algorithm:

```
//Person with private key generating message and signature
originalHash = GenerateHashOfMessage(message);
signature = RsaDecrypt(originalHash, privateKey);

//Receiver validating signed message
hash = GenerateHashOfMessage(message);
originalHash = RsaEncrypt(signature, publicKey);
messageValid = (hash == originalHash); 
```

This same mechanism can be used to accomplish what you want. Except you don't care about *hashes*, you just want to encrypt some (small) amount of data:

```
//Person with private key
cipherText = RsaDecrypt(plainText, privateKey);

//Person with public key
plainText = RsaEncrypt(cipherText, publicKey); 
```

i'll leave the `CryptoAPI` calls as an excercise - since i'm still trying to figure out Microsoft's Crypto API.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T20:09:20.677

不支持使用私钥加密数据并使用公钥解密数据，因为任何拥有“已发布”公钥的人都可以解密它。那么加密它有什么价值呢？

If you want to verify that data hasn't been changed, you will want to sign the data instead. Signing encrypts a hash of the data with the private key. Look at the signing functions.

You may be able to trick out the signing functions to do what you want. I've done this with other implementations, but I haven't tried with the Microsoft CryptoAPI.

Also, note that with RSA encryption, the plain text message cannot be longer than the key. So, if you are using a 2048 bit key, you can only encrypt a message body of up to 256 bytes (minus a few for overhead).

Consider using asymmetric encryption just to pass a symmetric key, and use the symmetric key to encrypt and decrypt any size data.

**Update**

You may be able to use the [CryptSignHash()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa380280.aspx) function for this. Normally, this is used to "sign" a hash, but you can put any data you want into the hash:

> Set the hash value in the hash object by using the HP_HASHVAL value of the dwParam parameter in CryptSetHashParam.

You might be limited to so many bytes if the input is expected to be a SHA1 hash value.

Alternatively, you may wish to consider using OpenSSL. If I recall correctly, it's pretty straight forward to use its [RSA signing](http://www.openssl.org/docs/crypto/RSA_sign.html) functions to encrypt with the private key.

Also, I accomplished the same thing using the old (freeware) version of SecureBlackbox. You may be able to find the old free version, but it's not Unicode friendly, so you'll have some conversion to do if you're using a new Delphi. I've done this in the past also, so it's not too difficult.

You may also consider trying out the current SecureBlackbox and purchase it if it works for you.

Otherwise, as you stated, sign it to detect tampering, and encrypt it with a symmetric key that only the program knows in order to obfuscate it.

If they crack your code, anything's fair game anyway.

# java - 用一些数字获取并写入行

> ID：10984068
> 
> 赞同：0
> 
> 时间：2012-06-11T16:31:19.290
> 
> 标签：java, swing

我需要从具有多行支持的文本组件中获取某些行。所以它要么`JTextArea`要么`JTextPane`。

如何获得第 1 行、第 2 行或 .. 等？例如`line3`从下面的文本中获取

```
line1
line2
line3
line4 
```

是否可以为某行设置另一个值？例如。设置`lineNew`而不是`line2`

```
line1
lineNew
line3
line4 
```

有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:36:45.833

要获取 a 中的文本`JTextComponent`，请使用`getText()`将返回 a 的方法`String`。

然后要获取行，将字符串拆分为`\n`.

```
JTextArea txt = new JTextArea("line1\nline2\nline3\nline4");
String s = txt.getText();
String[] lines = s.split("\n");
// now to access the second line, use lines[1] 
```

现在如果要修改文本，可以使用`setText(String)`方法。

```
txt.setText("something else"); 
```

您还可以使用其他一些方法来更改文本，例如`insert(String,int)`、`append(String)`和`replaceRange(String,int,int)`。所有这些都记录在[javadocs](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTextArea.html)中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:38:42.120

可以[`JTextArea#replaceRange`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTextArea.html#replaceRange%28java.lang.String,%20int,%20int%29)用来替换某行。

对于检索某行我不完全确定，但我认为[`JTextArea#getLineCount`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTextArea.html#getLineCount%28%29), [`JTextArea#getLineStartOffset`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTextArea.html#getLineStartOffset%28int%29),[`JtextArea#getLineEndOffset`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTextArea.html#getLineEndOffset%28int%29)应该允许您从文本中快速提取某行。或者正如 tskuzzy 已经建议的那样，检索完整的文本并自己拆分

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T16:38:43.037

> 如何获得第 1 行、第 2 行或 .. 等？

`JTextArea`从/ `JTextPane`by `JTextArea.getText()`/获取文本`JTextPane.getText()`。将文本作为字符串后，您可以通过使用换行符作为分隔符拆分文本来获得不同的行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T16:47:43.517

```
JTextArea jText = new JTextArea("line1\nline2\nline3\nline4");

String temp = jText.getText();

String[] tempArr = temp.split("\n"); 
```

// 获取文本的方法

```
public String getText(int lineNos){

             return Str[lineNos].getText();

} 
```

// 设置文本的方法

```
public void setText(int lineNos){

            Str[lineNos].setText("Hello");   // Can also use Scanner here

} 
```

# google-docs-api - API 说明：ClientLogin 的 POST HTTPS 请求中的 accountType 行

> ID：10984073
> 
> 赞同：1
> 
> 时间：2012-06-11T16:31:39.407
> 
> 标签：google-docs-api

我无法理解 ClientLogin 的 POST 请求中 accountType 行的三个值之一。你能帮我吗，“HOSTED”值是什么意思？

ClientLogin POST 请求说明：[https ://developers.google.com/accounts/docs/AuthForInstalledApps#Request](https://developers.google.com/accounts/docs/AuthForInstalledApps#Request)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:42:21.917

托管帐户是属于 Google Apps 服务一部分的用户帐户。您链接的文档页面定义了这些值。

# facebook - 如何通过facebook邀请用户的朋友？

> ID：10984074
> 
> 赞同：1
> 
> 时间：2012-06-11T16:31:39.593
> 
> 标签：facebook, facebook-javascript-sdk, facebook-requests

我正在寻找一种简单的方式让用户能够邀请他们的朋友在我的网站上关注他们。

例如，Bob 邀请 sally 在 mysite.com 上成为 Bob 的追随者。

我正在考虑通过请求来执行此操作，但是我读到它们仅适用于画布应用程序而不适用于常规网站，这意味着如果 Sally 接受了 Bob 的请求，那么我的网站将作为 iframe 加载到 facebook 中，这会破坏布局我的网站，看起来不太好。

是否有任何解决方案，例如向用户显示画布中的链接，他们可以单击以关闭画布并将其发送到我的网站？

在 facebook TOS 中，它说画布不能仅用于重定向用户，但它说应该使用 facebook 请求来邀请用户访问您的站点。

我的问题是，那么网站让用户从 Facebook 邀请他们的朋友的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:45:59.493

我认为您可以使用 facebook 做到这一点的唯一方法是向受邀用户发送私人消息，其中包含指向您的“邀请 url”的链接。

您可以使用带有链接参数的[发送对话框](http://developers.facebook.com/docs/reference/dialogs/send/)作为您网站的邀请页面。
这种方法的问题是您无法控制正在发送的消息，但是您可以将所需的信息放入该链接的 og 标签中，这些标签将添加到消息中。

另一种方法是使用[聊天 API](http://developers.facebook.com/docs/chat/)，您可以完全控制正在发送的消息。
这种方法的问题是您需要额外的权限 (xmpp_login) 并且您需要实现 xmpp 客户端。
这可能是矫枉过正。

# google-app-engine - GAE转换API中BackendError的所有可能原因是什么

> ID：10984076
> 
> 赞同：0
> 
> 时间：2012-06-11T16:31:46.120
> 
> 标签：google-app-engine

[Conversion API](https://developers.google.com/appengine/docs/python/conversion/exceptions?hl=pl)参考资料含糊地说：

```
BackendError 
Error in backend that can't be sent back to application. 
```

HTML到PDF转换出现这种错误的所有可能原因是什么？

列表中的第一项将是：

1.  在 HTML 中引用缺失的资产（如图像）
2.  …

# asp.net - Asp.Net MVC 上的 HttpRequestValidationexception

> ID：10984077
> 
> 赞同：3
> 
> 时间：2012-06-11T16:31:48.793
> 
> 标签：asp.net, asp.net-mvc-3

我收到带有此错误消息的 HttpRequestValidationexception：

> “从客户端检测到潜在危险的 Request.Form 值”。

但是我在出现错误的属性上有 AllowHtml。问题是，稍后在我的代码中，我将以女巫格式获得以下属性，我将展示我的观点`ControllerContext.HttpContext.Request.Params.AllKeys.Contains("format")`。在这个“Param Getter”上，我得到了错误。

假设我的代码类似于以下内容：

```
public class House
{
    [AllowHtml]
    public string Text { get; set; }
    public string Name { get; set; }
}

[HttpPost, ValidateAntiForgeryToken]
public ActionResult CreateTopic(House h)
{
 //business code
 if(ControllerContext.HttpContext.Request.Params.AllKeys.Contains("format"))
 {
    Return view;
 }
 } 
```

我该如何解决这个问题？我已经尝试使用`ValidateInput(false)`控制器操作方法上的属性。任何的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:36:39.810

尝试将此添加到您的 web.config`<system.web>`部分中：

```
<httpRuntime requestValidationMode="2.0"/> 
```

然后在您的操作中包含该`[ValidateInput(false)]`属性。

Scott Hansleman[在这里](http://www.hanselman.com/blog/ExperimentsInWackinessAllowingPercentsAnglebracketsAndOtherNaughtyThingsInTheASPNETIISRequestURL.aspx)解释了这个特性。

# c# - 使用 .Replace() 修复不正确的内联 css

> ID：10984079
> 
> 赞同：2
> 
> 时间：2012-06-11T16:31:58.750
> 
> 标签：c#, css

我有这种将富文本解析为 HTML 的方法。我注意到它在某些地方组成了这样的内联样式：

```
<DIV STYLE="text-align:Left;font-family:Segoe UI;font-style:normal;font-weight:normal;font-size:12;color:#000000;"> 
```

请注意，字体大小最后缺少“pt”，这在我导出为 pdf 时会破坏报告。

这是我处理它的代码：

```
public static string RtfToHtml(string rtfText)
    {
        if (String.IsNullOrEmpty(rtfText)) return rtfText;
        if (!rtfText.Contains(@"{\rtf1")) return rtfText.Replace("\r\n", "<br>").Replace("\r", "<br>");

        Converter converter = new Converter();
        StringBuilder sb = new StringBuilder(converter.ConvertRtfToHtml(rtfText));
        sb.Replace("font-size:12;", "font-size:12pt;");

        try
        {
            HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
            doc.LoadHtml(sb.ToString());
            RemoveStyleTags(doc, "ol");
            RemoveStyleTags(doc, "ul");
            RemoveStyleTags(doc, "li");
            return doc.DocumentNode.InnerHtml;
        }
        catch { }

        return sb.ToString();
    } 
```

我的问题是：有没有更优雅的方式来执行 .Replace() 方法，而不是这样做：

```
sb.Replace("font-size:12;", "font-size:12pt;");
sb.Replace("font-size:13;", "font-size:13pt;");
sb.Replace("font-size:14;", "font-size:14pt;");
...
sb.Replace("font-size:10000;", "font-size:10000pt;"); 
```

显然，我要做的是找到所有输入错误的字体大小声明，附加 pt，同时保持它们已经拥有的整数大小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:37:53.863

使用正则表达式？就像是：

```
var regex = new Regex(@"(font-size:\s?\d+)");
regex.Replace(yourHtml, "$1pt"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:34:41.130

你可以用这样的循环来做到这一点

```
for(int i=12; i < 1001; i++)
{    
    sb.Replace("font-size:"+i.ToString()+";", "font-size:" i.ToString()+ "pt;");    
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T16:41:44.473

您可以使用[Regex.Replace(string input, string pattern, string replacement)](http://msdn.microsoft.com/en-us/library/e7f5w83z.aspx)，如下所示：

```
public static string RtfToHtml(string rtfText)
{
    if (String.IsNullOrEmpty(rtfText)) return rtfText;
    if (!rtfText.Contains(@"{\rtf1")) return rtfText.Replace("\r\n", "<br>").Replace("\r", "<br>");

    Converter converter = new Converter();
    StringBuilder sb = new StringBuilder(converter.ConvertRtfToHtml(rtfText));
    string html = Regex.Replace(sb.ToString(), @"font-size:(\d*(\.\d+)?);", @"font-size:$1pt;");
    try
    {
        HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
        doc.LoadHtml(html);
        RemoveStyleTags(doc, "ol");
        RemoveStyleTags(doc, "ul");
        RemoveStyleTags(doc, "li");
        return doc.DocumentNode.InnerHtml;
    }
    catch { }

    return html;
} 
```

# puppet - 这是使用 puppet 更改配置文件的正确方法吗？

> ID：10984084
> 
> 赞同：1
> 
> 时间：2012-06-11T16:32:39.817
> 
> 标签：puppet

我有一个 Rails 应用程序，我想更改 ./config/environment/production.rb 文件，以根据我希望该服务器执行的操作具有不同的配置。

因此，我将从 .pp 文件进入 .rb 文件并更改一些字符串，然后重新启动服务。这对我来说似乎真的很糟糕。有一个更好的方法吗？我被要求提供*1* RPM 并通过 puppet 更改配置，所以...

```
class Cloud-widget($MServer, $GoogleEarthServer, $CSever) {
package { "Cloud-widget":
    ensure => installed
}

service { "Cloud-widget":
    ensure => running,
}

<%
    file_names = ['./config/environment/production.rb']
    file_names.each do |file_name|
        puts text.gsub(/.*config.mserver(.*)/, "config.mserver_root = \"#{$Merver}\"")
        puts text.gsub(/.*config.google_earth_url(.*)/, "config.google_earth_url( = \"#{$GoogleEarthServer}\"")
        puts text.gsub(/.*config.cserver_base_url(.*)/, "config.cserver_base_url = \"#{$CServer}\"")
    end

    File.open(file_name, "w") {|file| file.puts output_of_gsub}
%>
    service { Cloud-widget:
        ensure => running,
        subscribe => File["./config/environment/production.rb"],
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T06:44:26.623

不，这不是实现您需要的好方法。

您可以查看模板并以这种方式生成配置文件。这样，您可以在配置文件中使用变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-20T09:28:12.670

如果您需要从模式创建 conf，您应该使用 Puppetlabs 的 INI 文件模块

```
ini_setting { "sample setting":
  path    => '/tmp/foo.ini',
  section => 'foo',
  setting => 'foosetting',
  value   => 'FOO!',
  ensure  => present,
} 
```

从 puppet 安装这个模块：

```
puppet module install cprice404-inifile 
```

# python - 在 Matplotlib 中自动重新缩放 ylim 和 xlim

> ID：10984085
> 
> 赞同：54
> 
> 时间：2012-06-11T16:32:43.087
> 
> 标签：python, matplotlib

我正在使用 matplotlib 在 Python 中绘制数据。我正在根据一些计算更新绘图数据，并希望 ylim 和 xlim 自动重新缩放。相反，发生的事情是根据初始图的限制设置比例。MWE 是

```
import random
import matplotlib.pyplot as pyplot

pyplot.ion()

x = range(10)
y = lambda m: [m*random.random() for i in range(10)]

pLine, = pyplot.plot(x, y(1))

for i in range(10):
    pLine.set_ydata(y(i+1))
    pyplot.draw() 
```

第一个绘图命令从中生成一个绘图`[0,1]`，我可以看到一切都很好。最后，y 数据数组的`[0,10)`大部分大于`1`，但该图的 y 限制仍然存在`[0,1]`。

我知道我可以使用 手动更改限制`pyplot.ylim(...)`，但我不知道将它们更改为什么。在`for`循环中，我可以告诉 pyplot 缩放限制，就好像它是第一次被绘制一样？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-06-14T18:34:45.920

您将需要更新坐标区的 dataLim，然后根据 dataLim 更新坐标区的 viewLim。适当的方法是`axes.relim()`和`ax.autoscale_view()`方法。您的示例如下所示：

```
import random
import matplotlib.pyplot as pyplot

pyplot.ion()

x = range(10)
y = lambda m: [m*random.random() for i in range(10)]

pLine, = pyplot.plot(x, y(1))

for i in range(10):
    pLine.set_ydata(y(i+1))

ax = pyplot.gca()

# recompute the ax.dataLim
ax.relim()
# update ax.viewLim using the new dataLim
ax.autoscale_view()
pyplot.draw() 
```

# c# - 如何实现 Telerik 自定义聚合？

> ID：10984092
> 
> 赞同：4
> 
> 时间：2012-06-11T16:33:14.197
> 
> 标签：c#, asp.net-mvc-3, telerik, aggregate, telerik-grid

我有一个 Telerik Grid，它有一个需要显示列总和的页脚。但是，列的数据类型之一是`TimeSpan`Telerik 的 Sum 聚合不支持。我需要使用`GridBoundColumnBuilder.Aggregate()`来添加聚合。**所以我想基本上问题是如何在 Telerik 的 Aggregate() 方法中引用我的自定义聚合。**如果您发现我做错了什么，请随时指出 :) 使用[这篇文章](http://www.telerik.com/support/kb/reporting/designing-reports/implementing-custom-aggregate-functions.aspx)，我为我的自定义聚合创建了一个类，名为`SumAggregate`，如下所示。（请注意，这还没有完成——它取自文章。它实际上实现了一个完全不同的聚合）

**SumAggregate.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using Telerik.Web.Mvc;

namespace TelerikPOC.CustomAggregates
{
    public class SumAggregate : AggregateFunction
    {
        private System.Collections.Generic.List<object> distinctValues;

        /// <summary>
        /// Initializes the current aggregate function to its initial
        /// state ready to accumulate and merge values.
        /// </summary>
        /// <remarks>
        /// This method is called every time the accumulation of values 
        /// must start over for a new subset of records from the data source.
        /// </remarks>
        public void Init()
        {
            this.distinctValues = new System.Collections.Generic.List<object>();
        }

        /// <summary>
        /// Accumulates new argument values to the current aggregate function.
        /// </summary>
        /// <remarks>
        /// This aggregate function accepts one argument:
        /// number - a numeric value to accumulate to the aggregate function;
        /// </remarks>
        public void Accumulate(object[] values)
        {
            if (!distinctValues.Contains(values[0]))
            {
                distinctValues.Add(values[0]);
            }
        }

        /// <summary>
        /// Merges the specified aggregate function to the current one.
        /// </summary>
        /// <param name="Aggregate">
        /// Specifies an aggregate function to be merged to the current one.
        /// </param>
        /// <remarks>
        /// This method allows the reporting engine to merge two accumulated
        /// subsets of the same aggregate function into a single result.
        /// </remarks>
        public void Merge(AggregateFunction aggregate)
        {
            // Accumulate the values of the specified aggregate function.
            System.Collections.Generic.List<object> sums1 =     ((SumAggregate)aggregate).distinctValues;
            foreach (object o in sums1)
            {
                this.Accumulate(new object[] { o });
            }
        }

        /// <summary>
        /// Returns the currently accumulated value of the aggregate function.
        /// </summary>
        /// <returns>
        /// The currently accumulated numeric value of the aggregate function.
        /// </returns>
        public object GetValue()
        {
            return this.distinctValues.Count;
        }
    }
} 
```

这是添加聚合的代码。这与**index.cshtml**中的以下代码冲突，但我想包含两种添加聚合的方法，只是为了给答案提供更多选项。这需要修改为使用自定义聚合而不是内置聚合，就像现在使用的那样。

**GridHelper.cs**（未完成——稍后将添加逻辑以循环遍历列等。顺便说一句，如果有人也想帮助我解决*这个*问题，我将非常感激，尽管我承认我没有还没试过。）

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using Telerik.Web.Mvc.UI.Fluent;
using TelerikPOC.CustomAggregates;

namespace TelerikPOC.Helpers
{
    public class GridHelper
    {
        public static void AddAggregateToColumn(GridBoundColumnBuilder<dynamic> columnBuilder, string Aggregate)
        {
            switch (Aggregate)
            {
                case "Sum":
                    {
                        columnBuilder.Aggregate(aggregates => aggregates.Sum())
                            .GroupFooterTemplate(result => "Sum:" + result.Sum)
                            .ClientFooterTemplate("Sum: <#= Sum #>")
                            .FooterTemplate(result => "Total: " + result.Sum);
                    }
                    break;
            }
        }
    }
} 
```

然后我使用`HtmlHelper`该类来构建/渲染 Telerik 网格，如下所示：

来自**Index.cshtml**：（一定要阅读右边的评论）

```
@{
    Html.Telerik()
    .Grid(Model)
    .Name("statisticalGrid")
    .Columns(columns =>
    {
        columns.Bound(o => o.PlanID).Aggregate(something);         //This is probably going to be where 
        columns.Bound(o => o.SessionID).Aggregate(something);      //I need the help. Just not sure
        columns.Bound(o => o.TimeSpan).Aggregate(something);       //how to reference the custom
        columns.Bound(o => o.TimeSpanDouble).Aggregate(something); //aggregate here, in
    })                                                             //place of `something`
    .Sortable(sortable => sortable.Enabled(true))
    .Filterable()
    .Pageable(page => page.PageSize(25))
    .Reorderable(reorder => reorder.Columns(true))
    .Groupable(groupable => groupable.Enabled(true))
    .ClientEvents(events => events
        .OnColumnReorder("onReorder"))
    .Render();
} 
```

所以我想基本上问题是如何在 Telerik 的`Aggregate()`方法中引用我的自定义聚合。如果您发现我做错了什么，请随时指出:)

编辑：刚刚注意到我必须`CreateAggregateExpression(Expression, bool)`在 SumAggregate 类中实现该方法。不过，不完全确定如何实现它。

最后编辑：我使用自定义列构建器方法来构建列，所以我不确定如何在这里进行格式化。我能够格式化总和，但不能格式化列的其余部分，因为在 Telerik 调用的上下文之外我无权访问该`item`变量。这基本上是我的列构建逻辑的样子：

在 Telerik 代码中，

```
.Columns(a => GridHelper.GenerateColumns(a, Model.SelectedReport)) 
```

并生成列看起来像：

```
public static void GenerateColumns(GridColumnFactory<dynamic> columnFactory, Company.Project.Data.Entity.Report reportStructure)
        {
            foreach (var columnLayout in reportStructure.ReportCols.OrderBy(o => o.ColumnSequence))
            {
                GridBoundColumnBuilder<dynamic> columnBuilder = columnFactory.Bound(columnLayout.ColumnType);
                //do other stuff here (add aggregates, formatting, etc)
            } 
```

那么在这种情况下我将如何进行格式化呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T23:17:11.853

您可以做的一件事是在“天”中添加另一个表示 TimeSpan 的列。那么您就不必使用自定义聚合了。

模型：

```
public List<Objects.Temp> GetTemp()
{
  List<Objects.Temp> ltemp = new List<Objects.Temp>();
  System.Random r = new Random();
  Objects.Temp t = new Objects.Temp();
  t.Name = "One";
  t.start = DateTime.Now;
  t.Value = r.NextDouble();
  t.ts = DateTime.Today.AddDays(25) - t.start;
  t.tsDays = t.ts.Days;
  ltemp.Add(t);
  t = new Objects.Temp();
  t.Name = "Two";
  t.start = DateTime.Now;
  t.Value = r.NextDouble();
  t.ts = DateTime.Today.AddDays(15) - t.start;
  t.tsDays = t.ts.Days;
  ltemp.Add(t);
  t = new Objects.Temp();
  t.Name = "Three";
  t.start = DateTime.Now;
  t.Value = r.NextDouble();
  t.ts = DateTime.Today.AddDays(55) - t.start;
  t.tsDays = t.ts.Days;
  ltemp.Add(t);

  return ltemp;
} 
```

看法：

```
@(Html.Telerik().Grid(Model)
  .Name("Grid")
  .Columns(columns =>
  {
    columns.Bound(o => o.Name)
            .Aggregate(aggregates => aggregates.Count())
            .FooterTemplate(@<text>Total Count: @item.Count</text>)
            .GroupFooterTemplate(@<text>Count: @item.Count</text>);

    columns.Bound(o => o.start)
            .Width(200)
            .Aggregate(aggreages => aggreages.Max())
      //.Format("{0:c}")
            .FooterTemplate(@<text>Max: @item.Max</text>)
            .GroupFooterTemplate(@<text>Max: @item.Max</text>);

    columns.Bound(o => o.Value)
            .Width(200)
            .Aggregate(aggregates => aggregates.Average())
            .FooterTemplate(@<text>Average: @item.Average</text>)
            .GroupFooterTemplate(@<text>Average: @item.Average</text>);

    columns.Bound(o => o.ts)
            .Width(100)
            .Aggregate(aggregates => aggregates.Count().Min().Max())
            .FooterTemplate(
            @<text>
                <div>Min: @item.Min</div>
                <div>Max: @item.Max</div>
            </text>)
            .GroupHeaderTemplate(@<text>@item.Title: @item.Key (Count: @item.Count)</text>);

    columns.Bound(o => o.tsDays)
          .Width(100)
          .Aggregate(aggregates => aggregates.Sum())
          .FooterTemplate(
          @<text>
                <div>Sum: @item.Sum Days</div>
            </text>)
          .GroupHeaderTemplate(@<text>@item.Title: @item.Key (Sum: @item.Sum)</text>);
  })
    .Sortable() 
```

)

你会得到如下所示的东西：

![在此处输入图像描述](../Images/50d8731c4635caf447765f1d58eb0b82.png)

**版本 2**

我更新了我的答案，以便只有一个 TimeSpan 列包含 TimeSpan 的总和并以 TimeSpan 格式显示。列中的数据实际上是 TimeSpan.TotalMilliseconds，但它通过使用模板显示为 TimeSpan，并使用 TimeSpan.FromMilliseconds 方法格式化 TimeSpan。我认为这样做比创建自定义聚合类更容易，如果这甚至可以使用 MVC 扩展。

模型：

```
public class Temp
{
  public string Name { get; set; }
  public DateTime Start { get; set; }
  public double Value { get; set; }
  public TimeSpan ts { get; set; }
  public double tsMilliseconds { get; set; }
}

  List<Objects.Temp> ltemp = new List<Objects.Temp>();
  System.Random r = new Random();
  Objects.Temp t = new Objects.Temp();
  t.Name = "One";
  t.Start = DateTime.Now;
  t.Value = r.NextDouble();
  t.ts = DateTime.Today.AddDays(25) - t.Start;
  t.tsMilliseconds = t.ts.TotalMilliseconds;
  ltemp.Add(t);
  t = new Objects.Temp();
  t.Name = "Two";
  t.Start = DateTime.Now;
  t.Value = r.NextDouble();
  t.ts = DateTime.Today.AddDays(15) - t.Start;
  t.tsMilliseconds = t.ts.TotalMilliseconds;
  ltemp.Add(t);
  t = new Objects.Temp();
  t.Name = "Three";
  t.Start = DateTime.Now;
  t.Value = r.NextDouble();
  t.ts = DateTime.Today.AddDays(55) - t.Start;
  t.tsMilliseconds = t.ts.TotalMilliseconds;
  ltemp.Add(t); 
```

看法：

```
@(Html.Telerik().Grid(Model)
  .Name("Grid")
  .Columns(columns =>
  {
    columns.Bound(o => o.Name)
            .Aggregate(aggregates => aggregates.Count())
            .FooterTemplate(@<text>Total Count: @item.Count</text>)
            .GroupFooterTemplate(@<text>Count: @item.Count</text>);

    columns.Bound(o => o.Start)
            .Template(@<text>@item.Start.ToShortDateString()</text>)
            .Aggregate(aggreages => aggreages.Max())
            .FooterTemplate(@<text>Max: @item.Max.Format("{0:d}")</text>)
            .GroupHeaderTemplate(@<text>Max: @item.Max.Format("{0:d}")</text>)
            .GroupFooterTemplate(@<text>Max: @item.Max.Format("{0:d}")</text>);

    columns.Bound(o => o.Value)
            .Width(200)
            .Aggregate(aggregates => aggregates.Average())
            .FooterTemplate(@<text>Average: @item.Average</text>)
            .GroupFooterTemplate(@<text>Average: @item.Average</text>);

    columns.Bound(o => o.tsMilliseconds)
          .Width(100)
          .Aggregate(aggregates => aggregates.Sum())
          .Template(@<text>@TimeSpan.FromMilliseconds(@item.tsMilliseconds)</text>)
          .Title("TimeSpan")
          .FooterTemplate(
          @<text>
                <div>Sum: @TimeSpan.FromMilliseconds( @Convert.ToDouble( @item.Sum.Value.ToString() ) ) </div>
            </text>)
          //header if you group by TimeSpan
          .GroupHeaderTemplate(@<text>@item.Title: @item.Key (Sum: @TimeSpan.FromMilliseconds(@Convert.ToDouble(@item.Sum.Value.ToString())))</text>)
          //footer for grouping
          .GroupFooterTemplate(@<text>Sum: @TimeSpan.FromMilliseconds(@Convert.ToDouble(@item.Sum.Value.ToString()))</text>);
  })
    .Sortable()
    .Groupable(settings => settings.Groups(groups => groups.Add(o => o.Start)))
) 
```

没有分组会产生这个：

![时间跨度聚合](../Images/5ac6299b68696a7a73a05d083a6bd46c.png)

随着分组产生这个：

![带分组](../Images/57a7c1031785795c9f883be3a02e9c20.png)

# c# - C#：并行表单、多线程和“应用程序中的应用程序”

> ID：10984093
> 
> 赞同：1
> 
> 时间：2012-06-11T16:33:22.893
> 
> 标签：c#, winforms, multithreading, browser

首先，我需要的是 - n WebBrowser-s，每个都在自己的窗口中做自己的工作。用户应该能够看到它们全部，或者只看到它们中的一个（或一个都没有），并在每个上执行命令。有一个主窗体，没有浏览器，这个包含我的应用程序的控制面板。

关键特征是，每个浏览器都登录到安全网页，并且需要尽可能长时间地保持登录状态。好吧，我已经做到了，但我担心我的方法有问题。

问题是：

下面的代码是否有效，或者更确切地说是可能导致问题的讨厌的黑客攻击：

```
internal class SessionList : List<Session> {

    public SessionList(Server main) {
        MyRecords.ForEach(record => {
            var st = new System.Threading.Thread((data) => {
                var s = new Session(main, data as MyRecord);
                this.Add(s);
                Application.Run(s);
                Application.ExitThread();
            });
            st.SetApartmentState(System.Threading.ApartmentState.STA);
            st.Start(record);
        });
    }

    // some other uninteresting methods here...

} 
```

这里发生了什么？Session继承自Form，所以它创建一个表单，将WebBrowser放入其中，并具有对网站进行操作的方法。WebBrowser 需要在 STA 线程中运行，因此我们为每个浏览器提供一个。其中最有趣的部分是`Application.Run(s)`. 它使新创建的表单具有活力和交互性。`Application.ExitThread()`在浏览器窗口关闭并释放其控件后调用下一个。主应用程序保持活动状态以执行其余的清理工作。

当用户选择“退出”或“关闭”选项时 - 首先浏览器线程结束，因此`Application.ExitThread()`被调用。一切正常，但我在任何地方都能读到“主 GUI 线程”——在这里——我创建了许多 GUI 线程。我使用线程安全方法处理主表单和新表单（会话）之间的通信`Invoke()`。这一切都有效，那么它是对还是错？

`Application.Run()`在一个应用程序中多次使用是否一切正常？:) 丑陋的 hack 还是正常的做法？如果我从会话表单线程启动 WebBrowser，此代码将终止。它打败了我为什么。但是，如果我`Url`从任何其他线程启动 WebBrowser（通过更改其属性），它就可以工作。我想更多地了解此类应用程序中真正发生的事情。但最重要的是 - 我想知道我的“应用程序中的应用程序”的想法是否可行。

我不确定到底是`Application.Run()`做什么的。没有它，在新线程中创建的表单将毫无反应。我怎么可能打电话`Application.Run()`多次？它似乎完全按照它应该做的，但对我来说似乎是一个没有记录的功能。我几乎可以肯定，崩溃是由 WebBrowser 组件本身引起的（因为它不是完全“托管”和“原生”的）。但也许是别的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T16:36:34.100

> 在一个应用程序中多次使用 Application.Run() 是否一切正常？:) 丑陋的 hack 还是正常的做法？

两者中的一些；）这是完全可以接受的，因为它将按您的预期运行，但这并不完全是“正常做法”。

> 我不确定 Application.Run() 到底是做什么的。

`Application.Run`基本上做了几件事。首先，它将属性安装`SynchronizationContext`到线程中，以便 Windows 窗体正常运行。然后它在该线程中启动 Windows 消息处理，该线程处理来自 Windows 进入线程的所有消息。这就是允许表单正常工作的原因。

这样做并没有什么特别的*错误*，但这不是标准做法。*鉴于您的设计目标，我确实质疑仅通过启动单独的进程*而不是尝试在单独的线程中运行每个操作是否会更好地服务。

# sql - 用 INNER 诗句 LEFT 加入的建议

> ID：10984101
> 
> 赞同：4
> 
> 时间：2012-06-11T16:34:05.557
> 
> 标签：sql, tsql

对于一个 sql 数据库管理员来说，这可能是一个简单的问题，但我是一个 C# 人，他只涉足数据库足够长的时间，以便在必要时让它们工作。

我有一个我设计的新数据库，里面只有很少的数据。

我需要一个用于生成视图的查询，但我似乎永远无法理解如何/何时使用 INNER 与 LEFT 连接。

A`Packet`可以有多个`Request`条目（一个人请求 5 个不同的部分），每个`Request`条目可以有不同的`Action`条目（暂停、取消、特殊订单、完成等）。

![生产数据库](../Images/80eba43240c1a2effb9cf882f6414b01.png)

我想创建一个生成以下数据表的查询：

```
SELECT
  P.EmpID AS Requestor, P.DateStamp AS Submitted,
  T.Description AS RequestType, L.Description AS Line, R.PartNo, R.Workorder, R.Qty,
  RT.Description AS ReasonType, S.Description AS Status, A.EmpID AS Stator, A.DateStamp AS Stated, R.MTF
FROM Packet AS P
  LEFT OUTER JOIN Request AS R ON (R.PacketID=P.ID)
  LEFT OUTER JOIN Action AS A ON (A.RequestID=R.ID)
  LEFT OUTER JOIN RequestType AS T ON (R.RequestTypeID=T.ID)
  LEFT OUTER JOIN Line AS L ON (R.LineID=L.ID)
  LEFT OUTER JOIN ReasonType AS RT ON (R.ReasonTypeID=RT.ID)
  LEFT OUTER JOIN Status AS S ON (A.StatusID=S.ID) 
```

`Status`这将返回 5 行，但、`Stator`和有一些 NULL 条目`Stated`。

所以，我试着用 INNER JOIN 写这个：

```
SELECT
  P.EmpID AS Requestor, P.DateStamp AS Submitted,
  T.Description AS RequestType, L.Description AS Line, R.PartNo, R.Workorder, R.Qty,
  RT.Description AS ReasonType, S.Description AS Status, A.EmpID AS Stator, A.DateStamp AS Stated, R.MTF
FROM Packet AS P
  INNER JOIN Request AS R ON (R.PacketID=P.ID)
  INNER JOIN Action AS A ON (A.RequestID=R.ID)
  INNER JOIN RequestType AS T ON (R.RequestTypeID=T.ID)
  INNER JOIN Line AS L ON (R.LineID=L.ID)
  INNER JOIN ReasonType AS RT ON (R.ReasonTypeID=RT.ID)
  INNER JOIN Status AS S ON (A.StatusID=S.ID) 
```

NULL 条目现在消失了，但现在我只返回了 3 行。

我怎么知道我应该使用哪个版本？...或者，我应该使用 LEFT 和 INNER 联接的组合吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T16:36:13.817

> 我怎么知道我应该使用哪个版本？

当连接条件无法提供任何匹配项时，您希望缺失列的值为 NULL 还是希望该行在结果集中不存在？

*   如果您想要缺失列的 NULL，请使用外连接。
*   如果您希望整行不存在，请使用内部联接。

> 我应该使用 LEFT 和 INNER 联接的组合吗？

对于每个连接，您应该考虑您希望它是内部连接还是外部连接。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-11T16:37:58.857

> 我怎么知道我应该使用哪个版本？

只有你可以回答那个问题。您想要 5 行带空值还是 3 行不带空值？

正如您从结果中指出的那样，`LEFT JOIN`即使您要加入的表中没有匹配的记录（因此为空值）， a 也会返回一条记录。仅当您要加入的表中有匹配的记录时， An`INNER JOIN`才会返回一条记录（这就是您看到 3 个结果而不是 5 个结果的原因）。

看一下这个关于[连接的一个很好的视觉解释。](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

# c++ - Quartz：为 x86_64 架构构建时未定义的符号

> ID：10984102
> 
> 赞同：0
> 
> 时间：2012-06-11T16:34:18.827
> 
> 标签：c++, xcode, core-graphics, quartz-2d

我创建了一个控制台项目并将 Quartz.Framework、QuartzCore.Framework 添加到我的应用程序中。

但是在链接过程中会出现以下错误

```
Undefined symbols for architecture x86_64:
  "_CGColorCreateGenericRGB", referenced from:
      GifFlippingBook::GifFlippingBookCreator::CreateGifFlippingBook(int, int, double, std::string, int, std::string, std::string, int, std::string, std::string, std::string) in main.o
  "_CGDataProviderCreateWithFilename", referenced from:
      GifFlippingBook::GifFlippingBookCreator::CreateGifFlippingBook(int, int, double, std::string, int, std::string, std::string, int, std::string, std::string, std::string) in main.o
  "_CGImageCreateWithPNGDataProvider", referenced from:
      GifFlippingBook::GifFlippingBookCreator::CreateGifFlippingBook(int, int, double, std::string, int, std::string, std::string, int, std::string, std::string, std::string) in main.o 
```

任何想法为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:38:07.577

您还必须添加 CoreGraphics 框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:57:30.937

哈自己找到了答案

CoreGraphics 框架是 ApplicationServices.Framework 的一部分，所以我只需要将它添加到链接库中。

# twitter - GET statuses/:id/retweeted_by 返回哪 100 个用户

> ID：10984110
> 
> 赞同：0
> 
> 时间：2012-06-11T16:34:40.787
> 
> 标签：twitter

API 说它最多只能返回 100 个用户。

它会返回前一百个转发者，还是返回最新的一百个转发者？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T12:31:02.140

[retweeted_by API](https://dev.twitter.com/docs/api/1/get/statuses/%3aid/retweeted_by)返回**最近的**转发者。

这些是按转推日期排序的——最近的排在第一位。

每页限制为 100 个，但返回的可能少于此（例如，如果有人删除了他们的转推）。

# java - 单击按钮后更改 JPanel

> ID：10984114
> 
> 赞同：3
> 
> 时间：2012-06-11T16:34:53.047
> 
> 标签：java, swing, jframe, jpanel

我正在为我的应用程序构建简单的 GUI。我有几个 JPanel。我想根据通过单击 JButton 执行的操作来显示它们。如何禁用一个 JPanel 并启用另一个？

几个细节。我有一个 JFrame 类，我正在构建起始 gui。我有按钮和一些文字的地方。单击其中一个按钮应更改此 JFrame 中的视图

我的按钮定义

```
 JButton btnStart = new JButton("Start");
    btnStart.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {

        }
    });
    btnStart.setBounds(10, 11, 110, 23);
    contentPane.add(btnStart); 
```

// 编辑

我发现了问题。按钮采用静态方法

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-11T16:40:12.460

简单如：

```
jframe.setContentPane(your_new_panel);
jframe.invalidate();
jframe.validate(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-11T16:37:32.220

1.  您可能想要使用[CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)。
2.  或者您可以简单地删除旧面板并添加新面板：

* * *

```
contentPane.remove(oldPanel);
contentPane.add(newPanel); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-24T18:30:22.090

首先删除 jPanel 并添加新的 jPanel。然后使用 validate 执行重新布局。

```
 jFrame.remove(jPanelOld);
    jFrame.add(jPanelNew);
    jFrame.validate(); 
```

# eclipse - 在 Eclipse 工作区中使用 Scalatra 应用程序？（即构建路径）

> ID：10984116
> 
> 赞同：2
> 
> 时间：2012-06-11T16:35:03.380
> 
> 标签：eclipse, scala, lift, scalatra

我正在试验一个小型 Scalatra Web 应用程序，我已将其作为项目导入 Eclipse。

我以前使用 Eclipse 管理过一些 Lift 应用程序。对于 Lift 项目，SBT 将所有依赖项 JAR 复制到一个`/lib_managed`目录中。因此，我可以将这些 JAR 添加到 Eclipse 的构建路径中，并且它可以与 SBT 共存，而不会抱怨缺少类。

然而，对于 Scalatra，依赖项 JAR 似乎不会在开发周期中被复制到任何有用的地方。如果您构建一个 WAR 文件，那么依赖项就会被捆绑到其中……但似乎没有像 Lift 的`/lib-managed`目录这样的东西。

假设其他人使用 Eclipse 开发 Scalatra 项目，我如何轻松设置 Eclipse 的构建路径？我想我可以手动创建一个一个指向我本地 Ivy 存储库的条目，尽管这看起来有点难看。也许有一种简单的方法可以通过 SBT 在项目目录中设置类似于 Lift 的`/lib-managed`子目录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T18:43:00.187

看起来最好的方法是使用[Eclipse 的 SBT 插件](https://github.com/typesafehub/sbteclipse)。

这不是用于管理 SBT 的“Eclipse 插件”。相反，它是一个“SBT 插件”，用于生成Eclipse 使用的`.project`和文件。`.classpath`在 m2eclipse Eclipse 插件在过去几年达到成熟之前，Maven 世界曾经以类似的方式处理 Eclipse。

安装此插件后（我[将其安装在全局范围内，](https://github.com/typesafehub/sbteclipse/wiki/Installing-sbteclipse)因此不必更改项目文件），您只需`sbt eclipse`在对依赖项进行任何更改后键入即可。然后 SBT 将更新您的 Eclipse 项目文件以匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-11T22:09:51.583

您也可以使用我的 Maven 原型，然后简单地将 Maven 项目导入 Eclipse。非常好，您不必被迫使用 SBT。

[https://github.com/fancellu/scalatra-maven-prototype](https://github.com/fancellu/scalatra-maven-prototype)

# python - 如何将字符串列表转换为数值？

> ID：10984118
> 
> 赞同：-3
> 
> 时间：2012-06-11T16:35:19.193
> 
> 标签：python, string-parsing

我想了解如何将字符串列表转换为数字列表。

我有一个 php 表单，用户通过它输入 x 和 y 的值，如下所示：

```
X: [1,3,4]
Y: [2,4,5] 
```

这些值作为 varchars 存储到数据库中。从那里，这些被一个python程序调用，该程序应该将它们用作数字（numpy）数组。但是，这些被称为纯字符串，这意味着无法对它们执行计算。有没有办法在处理之前将它们转换为数值数组，或者还有其他错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:37:14.020

您可以使用[列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)以及[strip()](http://docs.python.org/library/stdtypes.html?highlight=str.strip#str.strip)和[split()](http://docs.python.org/library/stdtypes.html?highlight=str.split#str.split)函数将其转换为*数值*。

```
x = '[1,3,4]'
new_x = [int(i) for i in x.strip('[]').split(',')]
new_x
[1, 3, 4] 
```

使用你认为合适的这个列表`int`，例如，将它们传递给 numpy 等。

```
from numpy import array

a = array(new_x)
a
array([1, 3, 4])

a * 4
array([ 4, 12, 16]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:43:27.337

这是一种方法：

```
>>> import numpy
>>> block = "[1,3,4]"
>>> block = block.strip("[]")
>>> a = numpy.fromstring(block, sep=",", dtype=int)
>>> a
array([1, 3, 4])
>>> a*2
array([2, 6, 8]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:48:40.997

```
import ast
import numpy as np

def parse_array(s):
    return np.array(ast.literal_eval(s))

s = '[1,2,3]'
data = parse_array(s)    # -> numpy.array([1,2,3]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T16:49:14.897

如果我正确理解您的问题，您可以使用`eval()`和`compile()`内置函数来实现您的目标：

```
>>> lst_str = '[1,2,3]'
>>> lst_obj = compile(lst_str, '<string>', 'eval')
>>> eval(lst_obj)
[1, 2, 3] 
```

但是请记住，`eval()`以这种方式使用可能是不安全的，除非您可以验证输入。

# ruby-on-rails - 机架重写代码以将 https 重定向到 http（在 heroku 上）

> ID：10984120
> 
> 赞同：1
> 
> 时间：2012-06-11T16:35:45.310
> 
> 标签：ruby-on-rails, heroku, rack, rack-rewrite

不知何故，谷歌将我的主页索引为[https://mydomain.com](https://mydomain.com)。当您进行 site:mydomain.com 搜索时，第一个结果是[https://mydomain.com](https://mydomain.com)并且我没有 SSL 证书并且不想执行 https。当然，现在我们的访问者会在他们的浏览器中收到丑陋的警告（因为 heroku 默认提供他们的 *.heroku 证书）。

看来我可以使用 rack-rewrite gem 进行 301 重定向，但我就是找不到方法。

那么，将所有 https:// 重定向到 http:// 的机架重写配方是什么？我能找到的只是关于如何做相反的事情或进行规范重定向的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:48:37.683

嗯，未经测试，但是这样的东西会起作用吗？

```
r301 %r{.*}, 'http://non-secure-domain.com$&', :if => Proc.new {|rack_env|
  rack_env['SERVER_PORT'] != '80'
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-26T17:02:15.990

rack-rewrite 的文档在[https://github.com/jtrupiano/rack-rewrite#scheme提到了一个很好的方法](https://github.com/jtrupiano/rack-rewrite#scheme)

```
# Redirect all https traffic to http
r301 %r{.*}, 'http://www.example.tld$&', :scheme => 'https' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-11T20:18:51.450

使用`scheme`rack-rewrite 的选项只会导致 heroku 上的无限循环。您也不能使用 80 端口，因为 heroku 将代理您的工作人员。由于这一点以及路由层的工作方式，您必须检查`HTTP_X_FORWARDED_PROTO`标头：

```
r301 %r{.*}, 'http://example.com$&', :if => Proc.new { |rack_env|
  rack_env['HTTP_X_FORWARDED_PROTO'] == 'https'
} 
```

# forms - iPad 日期时间输入值格式

> ID：10984124
> 
> 赞同：3
> 
> 时间：2012-06-11T16:35:56.557
> 
> 标签：forms, ipad, html, safari

我正在为 iPad 开发一个网络应用程序，但我遇到了一些应该很基本的东西。我有一个可以编辑的带有日期时间输入的表单，但它应该显示一个默认值。我尝试使用以下标签

```
<input type="datetime" id="xyz" name="xyz" value="1996-12-19T16:39:57" /> 
```

没有显示默认值，选择器工作正常，如果编辑一切都很好，只是没有显示我设置的默认值。如果我改用它（当然我不能使用......）一切正常，默认值会定期显示

```
<input type="date" id="xyz" name="xyz" value="1996-12-19" /> 
```

正如我在网上找到的各种文章所建议的那样，我尝试以多种方式更改日期格式，但没有运气......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T09:57:11.507

经过一天的搜索，我在寻找其他东西的同时找到了解决方案（！！！）对于像我这样陷入困境的人的未来参考，iOS 上 DATETIME 输入类型的正确格式是

yyyy-MM-ddTHH:mm:ss.fffZ

请记住，日期是 GMT+0（我的休息时间为 2 小时）

希望能帮助到你

# php - 通过cron执行外部php

> ID：10984125
> 
> 赞同：0
> 
> 时间：2012-06-11T16:36:06.887
> 
> 标签：php

我的共享主机上有一个脚本。当我执行脚本时，它会检查网站上是否有新成员。如果是这样，带有两个 get 参数和一个脚本的脚本标题到我的 Windows 服务器，那里的脚本将执行并为新用户创建一个 useracount。这可以手动工作，并且对于 1 个用户来说很好，但是，我想在其中添加 cron，以便它每 15 分钟运行一次。当有一个用户时，这不是问题，但是脚本是否有多个用户，由于标题，它不会到达那里。我怎样才能解决这个问题？

我的代码：

```
$array =  $arr->invoices->invoice;
foreach($array as $key => $value) {
    if(!order_is_active($value->id)) {
        $username_win = strtolower($value->firstname) . rand(9,9999);
        $password_win = ucfirst(maakpass(10, TRUE, TRUE));
        if (add_user_to_db($value->id, $value->userid, $value->status, $username_win, $password_win)) {
            header('location: http://ip/adduper/?username=' . htmlspecialchars($username_win) . '&password=' . htmlspecialchars($password_win));
        } else {
            echo 'order bestaat al';
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:44:28.087

而不是做一个标题，我会转向做[CURL](http://www.php.net/manual/en/intro.curl.php)

这将允许您更清晰地从 Windows 机器返回成功或失败状态。与所有远程连接一样，您必须考虑何时一台机器无法连接到另一台机器......这不是这种情况是否会发生的问题，而是何时发生的问题。这就是互联网的本质。

使用 PHP 标头，失败的连接会造成各种混乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:42:08.137

您可以将所有用户存储在一个数组中，然后将[`json encoded`](http://php.net/manual/en/function.json-encode.php)字符串发送到您的其他服务器，然后[`json_decode`](http://www.php.net/manual/en/function.json-decode.php)它将返回一个数组。然后它可以遍历数组并添加每个用户。

# perl - 如何使用 LWP 仅获取网页的开头？

> ID：10984127
> 
> 赞同：2
> 
> 时间：2012-06-11T16:36:10.670
> 
> 标签：perl, lwp

有谁知道在 GET 或 POST 请求中仅获取 50% 网页的最佳方法？我获取的网页需要 10 到 20 秒才能完全加载，我只需要从页面开头过滤几行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-11T17:05:51.427

```
use 5.010;
use strictures;
use LWP::UserAgent qw();

my $content;
LWP::UserAgent->new->get(
    $url,
    ':content_cb' => sub {
        my ($chunk, $res) = @_;
        state $length = $res->header('Content-Length');
        $content .= $chunk;
        die if length($content) / $length > 0.5;
    },
); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T22:04:19.763

如果有问题的网站提供了`Content-Length`标头，您可以只询问将要发送多少数据并只请求其中的一半。

此代码演示。

```
use strict;
use warnings;

use LWP;

my $ua = LWP::UserAgent->new;
my $url = 'http://website.test';

my $resp = $ua->head($url);
my $half = $resp->header('Content-Length') / 2;

$resp = $ua->get($url, Range => "bytes=1-$half");
my $content = $resp->content; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T18:58:12.050

如果 Web 应用程序需要很长时间来呈现页面，您通常无法通过获取页​​面的“一半”来加速该过程。

该页面将在所有数据库查询和实际渲染完成后交付。这些可能是长期延误的原因。

# jquery - 通过 Jquery 获取 jsonString 为空

> ID：10984137
> 
> 赞同：2
> 
> 时间：2012-06-11T16:36:38.430
> 
> 标签：jquery, asp.net-mvc, json, linq

我正在使用 asp mvc，我正在像这样在我的程序的一部分中获取数据

```
 public List<IncidentPerAreaCount> getIncident()
    {
        int RondeboschCounter = 0;
        int ClaremontCounter = 0;
        int AthloneCounter = 0;
        List<IncidentPerAreaCount> IncidentAreaCount = new List<IncidentPerAreaCount>();
        IncidentPerAreaCount Rondebosch = new IncidentPerAreaCount();
        IncidentPerAreaCount Claremont = new IncidentPerAreaCount();
        IncidentPerAreaCount Athlone = new IncidentPerAreaCount();

        List<Report> Reports = GetReports();
        for (int i = 0; i < Reports.Count(); i++)
        {
            if (Reports.AsEnumerable().ElementAt(i).Area == "Rondebosch")
            {
                RondeboschCounter++;
            }
            else if (Reports.AsEnumerable().ElementAt(i).Area == "Claremont")
            {
                ClaremontCounter++;
            }
            else if (Reports.AsEnumerable().ElementAt(i).Area == "Athlone")
            {
                AthloneCounter++;
            }

        }
        Rondebosch.AreaName = "Rondebosch";
        Rondebosch.NumberOfIncidents = RondeboschCounter;
        Claremont.AreaName = "Claremont";
        Claremont.NumberOfIncidents = ClaremontCounter;
        Athlone.AreaName = "Athlone";
        Athlone.NumberOfIncidents = AthloneCounter;

        IncidentAreaCount.Add(Rondebosch);
        IncidentAreaCount.Add(Claremont);
        IncidentAreaCount.Add(Athlone);

        return IncidentAreaCount;
    } 
```

然后我试图通过 Jquery 获取这个字符串

```
 var Reports = [];
    $.ajax({
    url: "Home/getIncident",
    async: false,
    dataType: 'json',
    success: function (json) { Reports = json.whatever; }
    });
    alert(Reports); 
```

然而，警报功能一直是空的（即空文本框），而不是带有数据的 json 格式字符串。

请帮忙...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T06:01:00.037

您可以在 ajax 的成功函数中获取数据，而不是在 ajax 之外。尝试在成功中移动警报，然后您将获得数据。

```
var Reports = [];
        $.ajax({
        url: "Home/getIncident",
        async: false,
        dataType: 'json',
        success: function (json) { 
                 Reports = json.whatever; 
                 alert(Reports); //Right place
        }
        });
        alert(Reports); // Wrong place 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:39:59.507

您将警报放在错误的位置。

```
$.ajax({
    url: "Home/getIncident",
    async: false,
    dataType: 'json',
    success: function (json) {
        Reports = json.whatever; 
        alert(Reports); // should be here.
    }
}); 
```

在你跳入代码之前阅读[这个](http://www.w3schools.com/ajax/default.asp)和[这个。](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-06T21:57:25.407

我看到的第一件事是您没有序列化要返回的对象。你可以那样做

```
 return new JavaScriptSerializer().Serialize(your_object); 
```

在客户端，您必须将 json 字符串转换为有效的 Js 对象，我在 json 响应字符串中使用“d”属性来做到这一点

```
var theObject = $.parseJSON(response.d); 
```

并且 theObject 具有您需要的属性。

最后我看到你的对象是一个列表，你可以使用 $.each 进行迭代

# audio - FMOD 环绕声开放框架

> ID：10984145
> 
> 赞同：3
> 
> 时间：2012-06-11T16:37:03.960
> 
> 标签：audio, openframeworks, fmod, surround

好的，我希望我不要搞砸了，我已经寻找了一些答案，但找不到任何东西。我正在尝试在 3D 模式下使用 FMOD 声音播放器在 openframeworks 中制作一个简单的采样器。我可以使单个实例正常工作（使用 libsndfilerecorder 录制一个新文件，然后播放它并在环绕中移动它。

但是，我想要 8 层循环音频，我可以在现场表演中一次录制和替换一层。一旦我有超过 1 层，我就会遇到很多问题。

我的问题的第一部分与 FMOD 3D 模式有关，它是相对于听者的，所以我必须为每个声音定义听者的位置（我更喜欢头部相对模式，但我根本无法做到这一点。再说一次当我使用单个播放器但使用多个播放器时，这工作正常，只有我更新的最后一个侦听器实际工作。

我遇到的主要问题是，当我使用多个播放器时，我会失真，并且在我的新录音中经常混合其他当前正在播放的声音（即使麦克风听不到它们）。是否与 libsndfilerecorder 和 FMOD 不兼容？

在这里我初始化播放器

```
for (int i=0; i<CHANNEL_COUNT; i++) {  
    lvelocity[i].set(1, 1, 1);  
    lup[i].set(0, 1, 0);  
    lforward[i].set(0, 0, 1);  
    lposition[i].set(0, 0, 0);  
    sposition[i].set(3, 3, 2);  
    svelocity[i].set(1, 1, 1);  
    //player[1].initializeFmod();  
    //player[i].loadSound( "1.wav" );  
    player[i].setVolume(0.75);  
    player[i].setMultiPlay(true);  
    player[i].play();  
    setupHold[i]==false;  
    recording[i]=false;  
    channelHasFile[i]=false;  
    settingOsc[i]=false;  
} 
```

当我录制时，我会卸载文件并确保未加载的播放器的位置没有更新。

无效 fmodApp::recordingStart(int recordingId){

```
if (recording[recordingId]==false) {  
    setupHold[recordingId]=true; //this stops the position updating  
    cout<<"Start recording Channel " + ofToString(recordingId+1)+"  setup hold is true \n";  
    pt=getDateName() +".wav";  
    player[recordingId].stop();  
    player[recordingId].unloadSound();  
    audioRecorder.setup(pt);  
    audioRecorder.setFormat(SF_FORMAT_WAV | SF_FORMAT_PCM_16);  
    recording[recordingId]=true; //this starts the libSndFIleRecorder  

}  
else {  
    cout<<"Channel" + ofToString(recordingId+1)+" is already recording \n";  
} 
```

}

我就这样停止录音。

```
void fmodApp::recordingEnd( int recordingId ){  
if (recording[recordingId]=true) {  
    recording[recordingId]=false;  
    cout<<"Stop recording" + ofToString(recordingId+1)+" \n";  
    audioRecorder.finalize();  
    audioRecorder.close();  
    player[recordingId].loadSound(pt);  
    setupHold[recordingId]=false;  
    channelHasFile[recordingId]=true;  
    cout<< "File recorded channel " + ofToString(recordingId+1) + " file is called " + pt + "\n";  
}  
else {  
    cout << "Sorry track" + ofToString(recordingId+1) + "is not recording";  
} 
```

}

我小心不要中断更新过程，但我看不出哪里出错了。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T12:26:30.000

为了处理失真，我认为您需要在播放时降低每个通道的音量，尝试将音量设置为最大音量的 1/8。没有任何削波，所以如果声音的总和 > 1.0f 你会削波并且听起来很糟糕。

处理录音时的串扰：我猜你有一些输出反馈，即输出声音被反馈到输入通道，可能是由操作系统。如果您运行另一个发出声音的应用程序，您是否也会在录音中得到它？如果是这样，那可能是你的问题。

如果它适用于一个通道，请尝试仅使用 2 个，而不是直接跳到 8 个通道。

一般来说，我会尝试将播放/录制逻辑和 soundPlayer/recorder 抽象到一个单独的类中。你有几个布尔值，使用 >1 布尔值很容易出错。有什么方法可以用枚举或整数状态变量替换布尔值？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T02:23:51.573

编辑：我没有看到你的问题的日期：D 假设你现在设法做到了。也许它可以帮助别人..

我不确定我是否可以回答您的所有问题，但我可以分享我如何在 FMOD 中使用 3D 声音。虽然我没有做过录音。

对于我自己的应用程序，用户可以在自己周围的 3D 空间中放置声音。为此，我只有一个 Listener 和多个 Sounds。在您的代码中，您正在为每个声音制作一个监听器，您确定这是必要的吗？我想这会导致多个听众拾取多个声音并将其输出到您的声卡。那么从第二个声音+听者，两个听者都拾取两个声音？我不是 100% 肯定，但对我来说这听起来很合理。

我创建了一个类来创建声音对象（和一个听众）。然后我使用向量来存储对象并通过它们移动来渲染它们。

我的班级 SoundBox 基本上拥有 FMOD 所需的所有东西

制作一个“SoundBox”对象并将其添加到我的 soundboxes 向量中：

```
SoundBox * box = new SoundBox(box_loc, box_rotation, box_color);
box->loadVideo(ofToDataPath(video_files[soundboxes.size()]));
box->loadSound(ofToDataPath(sound_files[soundboxes.size()]));
box->setVolume(1);
box->setMultiPlay(true);
box->updateSound(box_loc, box_vel);"
box->play();
soundboxes.push_back(box); 
```

SoundBox 的构造函数。我在同一个类中为侦听器使用了类似的构造函数，但是由于侦听器对我来说始终位于原点，因此它不接受任何参数，只是将所有侦听器位置设置为 0。侦听器的构造函数只获取调用一次，而当我想制作一个新的时，就会调用 Sound 的那个。（不要介意 box_color。在这种情况下我正在绘制物理框..）：

```
SoundBox::SoundBox(ofVec3f box_location, ofVec3f box_rotation, ofColor box_color) {

_box_location = box_location; 
_box_rotation = box_rotation;
_box_color = box_color;

sound_position.x = _box_location.x;
sound_position.y = _box_location.y;
sound_position.z = _box_location.z;
sound_velocity.x = 0;
sound_velocity.y = 0;
sound_velocity.z = 0; 
```

然后我只是使用一个for循环来循环它们并在它们不播放时播放它们。我也有一些类似的代码来选择它们然后移动。

```
for(auto box = soundboxes.begin(); box != soundboxes.end(); box++){
    if(!(*box)->getIsPlaying())
        (*box)->play();
} 
```

我真的希望这会有所帮助。我不是一个非常有经验的程序员，但这就是我如何让 FMOD 具有多种声音在 OpenFrameworks 中工作，并希望你可以使用其中的一些。我只是尽可能多地倾倒了我的代码：D

我的主要建议是让一个听众而不是更多。例如，如果您想在初始放置后重新定位声音，那么创建声音的类也很有用。

希望它有所帮助，祝你好运:)

# php - 用openid替换mysql用户认证

> ID：10984150
> 
> 赞同：0
> 
> 时间：2012-06-11T16:37:15.713
> 
> 标签：php, mysql, security, zend-framework, openid

所以，我正在使用一个非常旧的系统，它使用一个人的 mysql 数据库凭据来验证网站（数据库最初只能从命令行访问，但现在可以从 php 前端访问）。由于某些内部原因（并为了保留用户的历史记录），我必须保持旧的身份验证不变。我负责向该系统添加 openid 身份验证。不知何故，我需要能够在通过 openid 登录站点时检索用户 mysql 用户名和密码（顺便说一下，使用 Zend 框架）。我想在第一次登录时简单地要求注册，用户必须提供他们的 mysql 凭据，但我宁愿不存储密码纯文本。我也考虑过清空每个人的 mysql 密码，只设置用户 s mysql 用户名手动（而不是让用户提供这个，因为他们可以提供任何用户名）。这正在变成一场安全噩梦。有人对替代品有任何建议吗？

顺便说一下，这是在 Linux 服务器上运行的。另外，我不能使用mysql可插拔认证，因为mysql版本是5.0（可插拔认证需要mysql 5.5），不，我不能更新它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:47:56.863

[MySQL 密码是散列的](http://dev.mysql.com/doc/refman/5.0/en/password-hashing.html)，因此您将无法从 MySQL 中提取明文密码。我想这给您留下了两种选择，您在问题中都考虑了这两种选择：

*   用户第一次使用 OpenID 登录时，将 MySQL 中的用户密码替换为您的应用程序已知的新密码。您的应用程序使用该密码登录到任何使用 OpenID 的用户的帐户。

    **缺点：**使用 OpenID 的用户无法重新使用直接 MySQL 身份验证，因为他们不再知道自己的密码。甚至不使用 MySQL 命令行工具。这意味着曾经使用过 OpenID 的用户必须永远使用 OpenID。

*   当用户注册使用 OpenID 时，您的应用程序会记住他们的密码。

    **缺点：**您的应用程序保留了一个明文密码列表

    **缺点：**当用户自己更改 MySQL 密码时，您的应用程序会中断。

第三个选项：

*   对于每个使用 OpenID 的用户，为他们创建第二个 MySQL 用户，该用户具有通用密码。将分配给普通帐户的所有权限复制到此“影子”帐户。

    **缺点：**普通用户和影子用户必须保持同步，这样如果某个 MySQL 的某些权限被添加或撤消，它们也应该同时被另一个添加或撤消。忘记这样做会导致一团糟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:46:55.123

鉴于您无法明智地为 CLI 客户端执行 openid 身份验证（即使使用 PAM），我强烈建议您不要尝试将 openid 用户与 mysql 用户协调 - 只需添加一个通过 openid 身份验证的任何人都可以使用的通用用户连接到数据库。

# backbone.js - 带有 itemview 的dirtyFields

> ID：10984153
> 
> 赞同：0
> 
> 时间：2012-06-11T16:37:24.190
> 
> 标签：backbone.js, marionette

我有一个使用骨干木偶构建的主/详细应用程序。当用户单击主行时，详细信息将显示行详细信息。

用户需要能够编辑该行。如果他们在保存之前尝试“离开”该行，我希望通知他们。我在想我会为这个功能使用dirtyFields插件。

有没有其他人一起使用这些？当我换出我的 itemview 时，如何初始化插件？当我关闭视图时，有什么我应该考虑清理视图的吗？

任何想法将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T18:16:00.610

我不熟悉那个插件，但是你应该能够利用 Marionette 的视图的`onShow`和`onRender`方法来做到这一点。

不久前，我写了一篇文章讨论了 jQuery 插件与 Backbone 的使用，希望能对您有所帮助：

[http://lostechies.com/derickbailey/2012/02/20/using-jquery-plugins-and-ui-controls-with-backbone/](http://lostechies.com/derickbailey/2012/02/20/using-jquery-plugins-and-ui-controls-with-backbone/)

# c++ - 为什么我的代码会产生语法错误？

> ID：10984159
> 
> 赞同：5
> 
> 时间：2012-06-11T16:37:53.687
> 
> 标签：c++, visual-c++, syntax-error, identifier

以下 C++ 代码正在生成此错误：

`error C2061: syntax error : identifier 'IObject'`

这是我的代码：

文件：IObject.h

```
#include "IIStreamable.h"
using namespace Serialization;
namespace Object
{
    class IObject : public IIStreamable
    {
        virtual void AcceptReader( IIReader* reader ); 
        virtual void AcceptWriter( IIWriter* writer );
    };
} 
```

文件：IIWriter

```
#include "IObject.h"
#using namespace Object;
namespace Serialization
{
    class ICORE_API IIWriter
 {
public:
    // primitive "built in" value types
    virtual void writeChar(const char) =0;
    virtual void writeUChar(unsigned char) =0;
    virtual void writeCharPtr(const char*) =0;
    virtual void writeUCharPtr(const unsigned char*) =0;
    virtual void writeLong(long) =0;
    virtual void writeULong(unsigned long) =0;
    virtual void writeShort(short) =0;
    virtual void writeUShort(unsigned short) =0;
    virtual void writeInt(int) =0;
    virtual void writeUInt(unsigned int) =0;
    virtual void writeFloat(float) =0;
    virtual void writeDouble(double) =0;
    virtual void writeBool(bool) =0;
    virtual void writeObject(IObject*) =0;
    };
 } 
```

文件：IIStreamable

```
#include "IIReader.h"
#include "IIWriter.h"
namespace Serialization
{

class ICORE_API IIStreamable
    {
    public:
    virtual void AcceptReader(IIReader*) = 0;
    virtual void AcceptWriter(IIWriter*) = 0;
    };
 } 
```

在 vc++ 2010 中编译此代码后，我收到此错误

**错误 C2061：语法错误：标识符“IObject”**

在 IIWriter.h 文件中和

**错误 C2061：语法错误：标识符“IIWriter”**

在 IObject.h 文件中和

**错误 C2061：语法错误：标识符“IIWriter”**

在 IIStreamale.h 文件中。

我不明白为什么会发生这个错误？

请帮我

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:44:15.400

使用 piokuc 建议的 using 指令仍然会给您带来循环包含引用的问题

您最好将 IObject.h 更改为以下内容：

```
namespace Serialization
{
     class ICORE_API IIWriter;
     class ICORE_API IIReader;
}
namespace Object
{
    class IObject : public IIStreamable
    {
        virtual void AcceptReader( Serialization::IIReader* reader ); 
        virtual void AcceptWriter( Serialization::IIWriter* writer );
    };
} 
```

IE 删除#include 并转发声明IIReader 和IIWriter。事实上，你可以通过删除#include IObject.h 来避免更多的混淆，并与上面类似地向前声明......

```
virtual void writeObject( Object::IObject* ) = 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:40:22.550

代替

```
#using namespace Object; 
```

和

```
using namespace Object; 
```

# c# - 文件上传实用程序

> ID：10984163
> 
> 赞同：0
> 
> 时间：2012-06-11T16:37:59.417
> 
> 标签：c#, asp.net-mvc-3, file-upload, image-upload, visual-web-developer-2010

我正在尝试将一个基本的文件、图像上传实用程序实现为一个小而简单的（使用 Visual Web Developer 教程构建）C# MVC3 ASP.Net 网站。我在 StackOverFlow 上看到过这个实用程序在这里指出了几次：

[https://github.com/blueimp/jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload)

...但不确定我是否可以将其插入我的 MVC3 C# 网站？（我对尝试使用 C# 学习 MVC3 非常陌生）。

我还看到很多这样的指南漂浮在这个地方：

*   [http://aspzone.com/tech/jquery-file-upload-in-asp-net-mvc-without-using-flash](http://aspzone.com/tech/jquery-file-upload-in-asp-net-mvc-without-using-flash)
*   [http://davidsonsousa.net/en/post/how-to-upload-a-file-using-mvc-3-and-ajax](http://davidsonsousa.net/en/post/how-to-upload-a-file-using-mvc-3-and-ajax)
*   [http://tomas.epineer.se/archives/3](http://tomas.epineer.se/archives/3)

这些中的任何一个都可以简单地插入我的网站吗？感谢任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:59:35.853

是的。前两个似乎非常适合。

# java - 使用 MapReduce 构建 kd 树？

> ID：10984168
> 
> 赞同：0
> 
> 时间：2012-06-11T16:38:42.740
> 
> 标签：java, hadoop, mapreduce, kdtree

我正在尝试为图像特征构建 KD 树（独立）。我已经提取了图像特征，该特征包含假设 1000 个浮点值。

使用map-reduce根据分类（例如，猫、狗、枪）在集群的节点之间分配图像，即。每个节点将包含一堆相似的图像，然后在每个节点上构建图像的 KD 树。我对如何建造树感到困惑。

**那么如何使用 map-reduce 构建 KD 树呢？每个节点都将包含树，对吗？分发图像的逻辑是什么？在构建 KD 树时，我应该在什么基础上在树中添加图像特征向量（即左子或右子）？**

任何帮助表示赞赏。在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T22:26:46.067

我认为 kd-tree 不适合您的数据。这是[维基百科](http://en.wikipedia.org/wiki/K-d_tree#High-dimensional_data)所说的：

> kd 树不适合在高维空间中有效地找到最近邻。作为一般规则，如果维度为 k，则数据中的点数 N 应为 N >> 2^k。否则，当kd树与高维数据一起使用时，树中的大部分点都会被评估，效率并不比穷举搜索好，应该改用近似最近邻方法。

您的特征向量的维数为 1000，这意味着您应该有大约 10^300 张图像，这不太可能。

我建议您查看[Locality-sensitive hashing](http://en.wikipedia.org/wiki/Locality-sensitive_hashing)，这是提到的用于高维数据的近似最近邻搜索之一。

由于 Wikipedia 并不总是学习复杂事物的最佳场所，因此我建议您查看ETH Zurich[数据挖掘](http://las.ethz.ch/courses/datamining-s12/)课程的[相应讲座幻灯片。](http://las.ethz.ch/courses/datamining-s12/slides/dm-03-lsh-annotated.pdf)碰巧我在本学期选修了这门课。

# python - Python3 json.dumps 给出 TypeError: keys must be a string

> ID：10984173
> 
> 赞同：5
> 
> 时间：2012-06-11T16:38:56.080
> 
> 标签：python, json, python-3.x

我有一个用 Python3 编写的简单 Web 服务器（使用来自 的类`http.server`），我将其从 2 移植到 3。

我有以下代码：

```
# More code here...
postvars = cgi.parse_qs(self.rfile.read(length),
                        keep_blank_values=1)
something.json_run(json.dumps(postvars)) 
```

哪个抛出：

```
TypeError: keys must be a string 
```

通过检查数据，我确定`parse_qs`似乎将键编码为字节，这就是引发错误的原因（`json`显然不喜欢字节）。

```
import json
json.dumps({b'Throws error' : [b"Keys must be a string"]})
json.dumps({'Also throws error': [b'TypeError, is not JSON serializable']})
json.dumps({'This works': ['No bytes!']}) 
```

这里最好的解决方案是什么？在 Python 2 中，代码运行良好，因为`parse_qs`使用`str`了`bytes`. 我最初的想法是我可能需要编写一个 JSON 序列化程序。并不是说这么简单的事情很难，但如果我能以其他方式做到这一点，我宁愿不这样做（例如，将字典翻译成使用字符串而不是字节）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:14:34.690

首先，该`cgi.parse_qs`函数已被弃用，仅是 的别名`urllib.parse.parse_qs`，您可能需要调整导入路径。

其次，您将一个字节字符串传递给 parse 方法。如果您传入常规（unicode）字符串，则该`parse_qs`方法返回常规字符串：

```
>>> from urllib.parse import parse_qs
>>> parse_qs(b'a_byte_string=foobar')
{b'a_byte_string': [b'foobar']}
>>> parse_qs('a_unicode_string=foobar')
{'a_unicode_string': ['foobar']} 
```

因此，您需要先将文件读取的字节字符串解码为常规字符串。

# java - 阻塞读取时，Android LocalSocket 不会关闭

> ID：10984175
> 
> 赞同：2
> 
> 时间：2012-06-11T16:39:09.597
> 
> 标签：java, android, sockets

在 Android 上使用 localsockets。我有一个用户从另一个连接读取。连接被告知通过关闭套接字、关闭输入流和中断它的线程来停止读取。它不会停止尝试读取，直到另一端关闭。那么，有没有办法让它中断阅读？

这是我的问题的一个非常简化的示例。当您尝试使用频道时，问题变得更加严重。它将（分别）阻止线程/通道上的中断/关闭请求。

你应该得到这个日志：

```
V/test    ( 4416): bound
V/test    ( 4416): accepted
V/test    ( 4416): stop
V/test    ( 4416): stop exit
V/test    ( 4416): closing
V/test    ( 4416): done reading?
V/test    ( 4416): all closed 
```

第一类：

```
public class Runner1 implements Runnable
{

public static Runner1       me  = null;

public InputStream          in;
public ReadableByteChannel  rb;
LocalSocket                 ls;
public Thread               thisThread;

public Runner1() {
    me = this;
}

@Override
public void run()
{
    thisThread = Thread.currentThread();
    try
    {
        LocalServerSocket lss = new LocalServerSocket(Test2Activity.location);
        ls = lss.accept();
        Log.v("test", "accepted");

        in = ls.getInputStream();
        byte[] buffer = new byte[10];
        in.read(buffer);
        // rb = Channels.newChannel(in);

        // ByteBuffer bb = ByteBuffer.allocate(100);
        // rb.read(bb);
        Log.v("test", "done reading?");
        ls.close();
        lss.close();
        Log.v("test", "all closed");
    }
    catch (IOException e)
    {
        Log.v("test", "error1");
        e.printStackTrace();
    }
}

public static void stop()
{
    Log.v("test", "stop");
    try
    {
        // me.rb.close();
        me.in.close();
        me.ls.close();
        // me.ls.shutdownInput();
        // me.ls.shutdownOutput();
    }
    catch (IOException e)
    {
        Log.v("test", "error - stop" + e.toString());
        e.printStackTrace();
    }

    me.thisThread.interrupt();

    Log.v("test", "stop exit");
}
} 
```

类2：

```
public class Runner2 implements Runnable
{
@Override
public void run()
{

    try
    {
        sleep(1500);
        LocalSocket ls = new LocalSocket();
        ls.connect(new LocalSocketAddress(Test2Activity.location));
        Log.v("test", "bound");
        WritableByteChannel wc = Channels.newChannel(ls.getOutputStream());
        sleep(3000);
        Runner1.stop();
        sleep(4000);
        Log.v("test", "closing");
        ls.close();
    }
    catch (IOException e)
    {
        Log.v("test", "error" + e.toString());
        e.printStackTrace();
    }
}

public void sleep(int time)
{
    try
    {
        Thread.sleep(time);
    }
    catch (InterruptedException e1)
    {
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-14T23:36:46.773

只需关闭套接字以进行输入。这会将 EOS 传递给 read()。然后读取线程应该关闭套接字本身并退出，这应该已经编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-14T21:21:54.997

我能找到解决此问题的最佳方法是设置超时并检查套接字是否在另一个线程中关闭。

可悲的是，当您设置超时时，您不会收到 TimeoutException :(

# java - 为什么当我尝试写入文件时 Eclipse IDE 会出现终止错误？

> ID：10984179
> 
> 赞同：1
> 
> 时间：2012-06-11T16:39:39.777
> 
> 标签：java, eclipse, file, io

```
import java.io.*;

public class FileWriterDemo {

/**
 * @param args
 */
public static void main(String[] args) throws IOException {
    // TODO Auto-generated method stub

    String source = "Now is the time for all good men\n" +
                    " to come to aid of their country\n" +
                    " and pay their due taxes";

    char buffer[] = new char[source.length()];
    source.getChars(0, source.length(), buffer, 0);

    FileWriter f0 = new FileWriter("file1.txt");
    FileWriter f1 = new FileWriter("file2.txt");
    FileWriter f2 = new FileWriter("file3.txt");

    try{
        for(int i =0; i<buffer.length; i+=2){
            f0.write(buffer[i]);
        }

        f1.write(buffer);
        f2.write(buffer, buffer.length-buffer.length/4, buffer.length/4);

    }catch (IOException e){
        System.out.println("An I/O Error occured.");
    }
} 
```

}

这是我写的程序。我完全从一本书中复制了这个程序，但我的 IDE (Eclipse) 不断给我消息。当我尝试使用 FileOutputStream 类对象创建文件并写入文件时，也会遇到同样的问题。

这是一张图片

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:48:16.167

这只是意味着程序已完成，并且在您的情况下可能成功，因为它没有在控制台上打印任何内容。

只需检查的内容，`file1.txt , file2.txt and file3.txt`看看程序是否成功

# ios - 如何在源代码控制下将本地化添加到设置包

> ID：10984180
> 
> 赞同：0
> 
> 时间：2012-06-11T16:39:40.263
> 
> 标签：ios, version-control, localization, settings.bundle

我正在尝试本地化我的 Settings.bundle。Xcode 4 中似乎没有任何内容允许您将本地化添加到 Settings.bundle，类似于本地化 xib 文件。所以我使用 finder 导航到 Settings.bundle 并复制 en.lproj 目录以在 bundle 中创建名为 fr.lproj 和 de.lproj 的目录。从那里，您可以修改字符串文件以本地化 Root.plist 中的标题。

但问题是新目录不受源代码控制。如果我尝试将目录添加到源代码控制，我会收到以下错误：无法执行操作，因为选择无效。

如何解决此问题并在源代码控制下获取新的 settings.bundle 目录？

![下面是我添加到我的 Settings.bundle 的本地化目录的图像。 如您所见，问号表示该目录不受源代码控制](../Images/8ea39562d4102fcd428562e6883aa0ef.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-27T20:13:47.297

正确的字符串文件格式是：“标题”=“正确语言的标题”；

注意 Root.Plist 中的“标题”而不是“标识符”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T10:35:23.757

你在做什么是对的。我无法解释为什么您无法将新的子文件夹/文件添加到源代码管理中。我在我的一个 iOS 项目中具有完全相同的结构，并且这些文件像所有其他文件一样处于源代码控制之下。我不记得添加它们有困难。

您是否尝试过直接使用 git 命令来添加它们？XCode 中的集成很棒，但根据我的经验，有时您必须使用 git 命令行。

# jquery - 调整窗口大小的元素宽度

> ID：10984185
> 
> 赞同：3
> 
> 时间：2012-06-11T16:39:59.603
> 
> 标签：jquery, window-resize, onresize

我正在使用 jq 计算页面加载时的元素宽度并且工作正常，尝试自动调整窗口大小但有点不起作用。所需效果：框应在窗口调整大小时自动调整大小，而不是下拉。

[http://jsfiddle.net/yMcXm/4/](http://jsfiddle.net/yMcXm/4/)

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T16:43:25.307

试试看`$(window).resize`下面，

```
$(document).ready(function() {
    var cw = $('#container').width();
    $(".box").width(cw / 5);

    $(window).resize(function() {
        var cw = $('#container').width();
        $(".box").width(cw / 5);
    });
}); 
```

还在 and 上使用了溢出属性`container`，`box_in`以便包含/隐藏里面的元素/文本......而不是出去。

**演示**：http: [//jsfiddle.net/skram/yMcXm/7/](http://jsfiddle.net/skram/yMcXm/7/)

# php - 无法理解 in_array()

> ID：10984189
> 
> 赞同：-2
> 
> 时间：2012-06-11T16:40:14.053
> 
> 标签：php, arrays

```
<?php
$whitelist = array('contact', 'about', 'user');
$_GET['page'] = array('contact');
$test = $_GET['page'];
if(isset($test))
{
  if(in_array($whitelist, $test))
  {
    $got = $test;
    echo $got;
  }
  else 
  {
    $got = 'home';
    echo $got;  
  }
}
?> 
```

现在在这里，我应该得到“联系”的结果，但我得到了“家”。这是为什么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:42:47.150

in_array 第一个参数应该是 needle（意思是：你在找什么），第二个应该是 haystack（意思是：我们在哪里寻找）。

我认为您颠倒了这些，并且需要是字符串（或其他变量类型），而不是数组。

所以你的脚本应该是这样的：

```
<?php
$whitelist = array('contact', 'about', 'user');
$test = 'contact';
if(isset($test))
{
  if(in_array($test, $whitelist))
  {
    $got = $test;
    echo $got;
  }
  else 
  {
    $got = 'home';
    echo $got;  
  }
}
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T16:42:52.023

因为白名单是一个字符串数组，而 $_GET['page'] 是一个数组，而不是一个字符串。而且您的参数设置错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:46:40.973

```
<?php
$whitelist = array('contact', 'about', 'user');
$_GET['page'] = 'contact';
$test = $_GET['page'];
if(isset($test))
{
  if(in_array($test, $whitelist))
  {
    $got = $test;
    echo $got;
  }
  else 
  {
    $got = 'home';
    echo $got;  
  }
}
?> 
```

# c++ - 与多个类共享一个对象

> ID：10984190
> 
> 赞同：2
> 
> 时间：2012-06-11T16:40:17.123
> 
> 标签：c++

我有 3 个课程，即棋盘、游戏和 AI

我想让棋盘类的对象 chessBoard 供游戏和 AI 以及棋盘类使用。我希望他们访问那个单一的 chessBoard 对象（共享）

问题是，它给了我臭名昭著的致命错误 LNK1169：找到了一个或多个多重定义的符号。此外，还有 Board.h、Game.h 和 AI.h（其中只有声明），我也有它们对应的 .cpp 文件。每个 .h 文件都包含保护 (#ifndef _XXXXXX_H_)

我试图将 Board chessBoard 包含在 Board.h 文件中（就在班级下方），但似乎警卫不起作用。

```
Error   7   error LNK2005: "class Board chessBoard" (?chessBoard@@3VBoard@@A)     already defined in AI.obj C:\Users\xxxx\Documents\Visual Studio 2010\Projects\CHESSv3\CHESSv3\Board.obj   CHESSv3
Error   8   error LNK2005: "class Board chessBoard" (?chessBoard@@3VBoard@@A)     already defined in AI.obj C:\Users\xxxxx\Documents\Visual Studio 2010\Projects\CHESSv3\CHESSv3\Game.obj   CHESSv3
Error   9   error LNK2005: "class Board chessBoard" (?chessBoard@@3VBoard@@A) already defined in AI.obj C:\Users\xxxxx\Documents\Visual Studio 2010\Projects\CHESSv3\CHESSv3\ProgramEntryPoint.obj  CHESSv3 
```

人工智能.h

```
#ifndef _AI_H_
#define _AI_H_
#include <iostream>
#include <string>
using namespace std;

struct node {
    string position;
    string nextPosition;
    float score;
    int level;
    float totalscore;
    node* up;
    node* right;
    node* left;
    bool approved;
    string move;
};

class AI {
private:
    //string board;
    //string board[8][8];
    int score1;
    int maxscore;
    int totalscore;
public: 
    void GetBoard(string[][8]);
    void AnalyzeMyPositions();
    void ExecuteAdvanceHeuristicMove();
};

#endif 
```

游戏.h

```
#ifndef _GAME_H_
#define _GAME_H_

#include <iostream>
#include <string>
#include <vector>
#include <sstream>
#include <queue>
#include <stack>
#include <cmath>

using namespace std;

class Game {
public:
    char WhosTurn();
    bool Playable();
    bool GetMoveFromPlayer();
    void TurnOver();
    Game();
private:
    char turn;
};

#endif 
```

板子.h

```
#ifndef _BOARD_H_
#define _BOARD_H_
#include <iostream>
#include <string>
#include <vector>
#include <sstream>
#include <queue>
#include <stack>
#include <cmath>
using namespace std;

class Board {
public:
    bool SquareChecker(string);
    bool MoveChecker(string);
    Board();
    void PrintBoard();
    int Execute(string);
    void UnExecute();
    string CB[8][8];
private:
    char turn;
    vector<string> BoardRecord;
    stack<string> CBR;
    //string CB[8][8];
};

Board chessBoard;

#endif 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T16:44:21.163

如果你真的想这样做，你需要`extern`在头文件 Board.h 中声明对象：

```
extern Board chessBoard; 
```

然后在 Board.cpp 中提供声明：

```
Board chessBoard; 
```

更好的是，在封闭代码中创建它并将其（通过引用）传递给其他类的构造函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:46:00.753

您正在寻找的是可以通过以下方式实现的[Singleton设计模式：](http://en.wikipedia.org/wiki/Singleton_pattern)

```
// Board.h
class Board {
  private:
    static instance_;

  public:
    static Board *instance();
}

// Board.cpp

Board *Board::instance_ = NULL;

Board *Board::instance() {
  if (!instance_)
    instance_ = new Board();

  return instance_;
} 
```

请注意，这种模式可以被视为好或坏，如果您不喜欢使用它，您应该考虑将实例化`Board`类的引用传递给所有需要的类，并将其作为实例变量存储在每个对象中。就像是：

```
Game::Game() {
  this->board = new Board();
  this->ai = new AI(board);
  // or better this->ai = new AI(this) so AI can access all game methods
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:45:56.487

您的问题可能是可能有 3 个不同的 chessBoard 定义，因为您可能要添加 3 个不同的 #include "Board.h"。请在您拥有更多控制权的地方只创建一个对象，而不是在 Board.h 中全局创建它

你试过这样吗？仅在 .cpp 文件中包含必要的包含声明。

```
//Board.h

class Board {};

//Game.h

class Board;
class Game {
    Board* myBoard;

public:
    void setBoard(Board*);
};

//AI.h
class Board;
class AI {
    Board* myBoard;

public:
    void setBoard(Board*);
};

void main() {
    Board chessBoard;
    Game g;
    g.setBoard(&chessBoard);

    AI ai;
    ai.setBoard(&chessBoard);
} 
```

# php - SQL 选择用户

> ID：10984192
> 
> 赞同：0
> 
> 时间：2012-06-11T16:40:19.680
> 
> 标签：php, mysql, sql

我有以下查询，它选择了一个朋友请求脚本，该脚本显示了已请求与某个用户成为朋友的用户的个人资料图片、家乡、用户 ID 和全名。

```
SELECT 
    a.hometown, 
    a.first_name, 
    a.uid, 
    a.last_name, 
    b.friend_one, 
    b.friend_two, 
    b.friend_request_id, 
    p.thumbnail 
FROM 
    users a, 
    friend_requester b, 
    profile_pics p 
WHERE 
    a.uid = b.friend_one 
AND b.friend_two = $uid 
AND p.uid_fk = $uid 
ORDER BY b.created DESC LIMIT 5 
```

我的问题是，我没有为在friend_requester 表中找到的每个查询返回1 个用户，而是返回3 个实例，例如具有不同个人资料图片的同一用户。因此，如果用户上传了 3 张个人资料图片，这些图片将被存储为

```
id=1, profile_pic=profile_pic1.jpg...

id=1 profile_pic=profile_pic2.jpg... 

id=1 profile_pic=profile_pic3.jpg... 
```

我得到了 3 个不同的同一用户框，要求与登录用户成为朋友。

正如 Hituptony 提到的，我想选择最新插入的图片，该图片来自“创建”列中的“profile_pics”表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:21:42.643

GROUP BY Uid_FK，获取创建的最大值并将 INNER 加入图片表（在我的名为“MaxPic”的子查询中完成）

```
SELECT  a.hometown, 
        a.first_name, 
        a.uid, 
        a.last_name, 
        b.friend_one, 
        b.friend_two, 
        b.friend_request_id, 
        p.thumbnail 
FROM    users a
        INNER JOIN friend_requester b 
            ON b.friend_one = a.uid
        INNER JOIN profile_pics p 
            ON p.uid_fk = b.frind_two
        INNER JOIN
        (   SELECT  uid_FK, MAX(Created) AS Created
            FROM    Profile_Pics
            GROUP BY uid_FK
        ) MaxPic
            ON MaxPic.UID_FK = p.UID_FK
            AND MaxPic.Created = p.Created
WHERE   p.uid_fk = $uid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:33:25.957

如果您可以将新的派生表添加到联接中，则可以执行以下操作：

```
 SELECT a.hometown, a.first_name, a.uid, a.last_name, 
        b.friend_one, b.friend_two, b.friend_request_id,
        p.thumbnail  
 FROM users a, 
      friend_requester b,
      (Select MAX(Created) as Created, uid_fk from profile_pics) p_date,
      profile_pics p
WHERE      
      a.uid = b.friend_one AND b.friend_two = $uid  AND p.uid_fk = $uid 
      AND p_date.Created=p.Created And p_date.uid_fk=p.uid_fk
ORDER BY b.created DESC LIMIT 5 
```

或者，如果图片是最新的，您可能希望在 pic 表中包含 1 的 'flag' 列，否则为 0， - 这种类型的问题似乎会出现很多，并且作为数据库增长了，而且有更多的旧图片，如果您每次都需要检查每个条目，您会遇到性能问题。使用标志，您可以更轻松地索引性能。此外，此查询只需要添加：where flag=1。每次插入新图片时，将标志设为 1，将所有用户其他图片的标志设为 0。

干杯，大卫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:46:04.163

那你要哪张图？图片应该有一个与之相关的时间戳，也许您可​​以拉出图片的日期并获取最接近 NOW() 或 curdate() 的日期，以显示最近的图片。^^ 我不认为你可以按顺序分组，但你应该选择 b.created，这样你就可以看到它从中检索图片的顺序。

# javascript - jquery.form/validate 插件仅在输入更改时才允许提交

> ID：10984196
> 
> 赞同：0
> 
> 时间：2012-06-11T16:40:52.363
> 
> 标签：javascript, jquery, jquery-validate, jquery-forms-plugin

我想使用 jQuery.Form/Validate 插件只允许在任何输入实际更改时提交我的表单。

对此有回调逻辑：http `beforeSubmit:`: [//jquery.malsup.com/form/#options-object](http://jquery.malsup.com/form/#options-object)。但是，我似乎无法让它工作。

这是我到目前为止所拥有的：

```
$(document.body).on('click', 'input[type="submit"]', function(){
 var $form =$('form');

$form.validate({
  submitHandler: function($form) {
   $($form).ajaxSubmit({
  beforeSubmit: function(arr, $form){           
      var value = '', storedValue='';
      $($form+':input').each(function (index, el) {
  value=$(el).val();
  storedValue=$(el).data("stored");            
      if(value!=storedValue){
      console.log("Changed");   return true;
  } 
      else {
      return false; console.log("NOT changed");
  }
});   

...success handling, etc..

beforeSubmit: function(arr, $form) { 
  var value = '', storedValue='';
  $($form+':input').each(function (index, this) {
    value=this.value;
    storedValue=$(this).data("stored");            
        if(value!=storedValue){
          console.log("Changed");return true;
        } 
        else {
         return false; console.log("NOT changed");
        }
  });                   
} 
```

这是HTML：

```
<form id="myForm">
  <input data-stored="my title" value="my title"/>
  <textarea data-stored="my description">my description</textarea>
  <input type="submit" value="submit/>
</form> 
```

目前console.log 显示，`"Changed"`无论是否`storedValue`等于输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:12:11.977

首先，它永远不会显示“未更改”，因为它`returns false`在到达那部分之前。您也应该过滤掉提交按钮，因为您可能没有检查它的值。

```
$($form+':input').not(':submit').each(function(index, this) {
    value = this.value;
    storedValue = $(this).data("stored");
    if (value != storedValue) {
        console.log("Changed");
        return true;      
    }
    else {       
        console.log("NOT changed");
        return false;
    }
}); 
```

**更新** 在@wirey 的大力协助下，我们（@timrpeterson 和@wirey）一起制定了一个解决方案。我没有在循环中返回真/假`each()`，而是增加了一个值 , `totalChanged`, 并在循环之后评估`each()`它是否大于 0。

这是代码：

```
beforeSubmit: function(arr, $form){   
var value = '', storedValue='', totalChanged=0;
$('#myForm :input').not(':submit,:hidden').each(function (i, el) {
  //console.log($(this));
    console.log($($form));
    value=$(el).val(); 
    storedValue=$(el).data("stored");          
    if (value != storedValue) {  
      totalChanged++;    
    }
    else {     
    }
}); //each

  if(totalChanged>0){
     console.log("at least one changed");
     return true;
  }
  else{
     console.log("All NOT changed");
     return false;
  }
} //beforeSubmit 
```

# css - CSS动画按钮问题-在悬停动画淡入淡出期间，其余按钮移动

> ID：10984197
> 
> 赞同：0
> 
> 时间：2012-06-11T16:40:55.003
> 
> 标签：css, button, navigation

我正在创建一个垂直导航，并且已经为按钮创建了 CSS 属性。

悬停属性淡入使用：

```
-webkit-transition:all .1s;
-moz-transition:all .1s;
-o-transition:all .1s;
-ms-transition:all .1s; 
```

但是，由于悬停按钮比静态按钮大，因此在动画期间按钮堆栈会移动。我能做些什么来阻止这一切吗？

完整的代码如下所示：

```
<div id="nav">
    <form method="post" action="">
        <a>Home</a>
        <a>link 2</a>
        <a>link 3</a>
    </form>
</div>

#nav {
position:absolute;
margin-top:96px;
margin-left:30px;
height: 450px;
width: 140px;
font-family:"Book Antiqua";}

#nav a {
background:url(Images/Button.png);
height:28px;
width:130px;
font-size:14px;
text-align:center;
color:#C60;
text-decoration:none;
background-position:center;
margin:auto;
display:block;
position:relative;
line-height:190%;
}

#nav a:hover {
background:url(Images/Button%20Hover.png);
height:34px;
width:140px;
font-size:16px;
text-align:center;
color:#C60;
text-decoration:none;
margin:-3px;
z-index:2;
line-height:220%;
text-indent:-10px;
-webkit-transition:all .1s;
-moz-transition:all .1s;
-o-transition:all .1s;
-ms-transition:all .1s;}

#nav a:active {
background:url(Images/Button%20Hover.png);
height:34px;
width:140px;
font-size:16px;
text-align:center;
color:#C60;
text-decoration:none;
margin:-3px;
z-index:2;
line-height:210%;
text-indent:-10px;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T12:54:16.740

使用 CSS 变换方法而不是缩放`font-size`，`margin`或者`line-height`：http: [//jsfiddle.net/tovic/KSZsH/4/](http://jsfiddle.net/tovic/KSZsH/4/)

# jsf - 过滤器重定向后阻止 JSF 操作方法执行

> ID：10984199
> 
> 赞同：3
> 
> 时间：2012-06-11T16:40:59.120
> 
> 标签：jsf, redirect, servlet-filters

我已经实现了一个 Servlet 过滤器来执行我的系统授权，并在需要时使用以下命令重定向用户：

```
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {

    ...

    if(!isLoggedIn(currentUser)){
        if(isSecurePage(requestedPage)){
            redirectUser(resp,USER_LOGIN_PAGE);
        }
        else{ // Carry on
            chain.doFilter(request,response);
        }
    }
    else{
        if(!isSecurePage(requestedPage)){
            redirectUser(resp,USER_WELCOME_PAGE);
        }
        else if(!canAccess(currentUser,requestedPage)){
            redirectUser(resp,req.getContextPath() + USER_DENIED_PAGE);
        }
        else{ // Carry on
            chain.doFilter(request,response);
        }
    }
}

private void redirectUser(HttpServletResponse response, String page) throws IOException {
    response.sendRedirect(page);
} 
```

重定向正确发生。我的问题是，虽然显示了 ACCESS_DENIED_PAGE，但原始请求背后的 JSF 操作方法仍然被执行（例如，它创建的 FacesMessage 显示在 ACCESS_DENIED_PAGE 中）。

如何防止这种情况？

# hyperlink - html链接到客户端文件

> ID：10984201
> 
> 赞同：3
> 
> 时间：2012-06-11T16:41:12.367
> 
> 标签：hyperlink, client-side, cloudfiles

我正在 ASP.net 中开发一个 Web 应用程序，其中应列出远程服务器上可用的文档。这适用于我们可以控制最终 PC 的数量非常有限的用户。我需要的是最终用户单击超链接，文件将直接以文字或 excel 格式打开并直接保存到远程服务器。

文件也可以在带有“虚拟驱动器”字母 (x:) 的非常常见的云文件共享系统上使用

google doc 确实为每个文件提供了一个唯一的 url，但是当单击该链接时，它会在线打开，而不是在本地 Microsoft Word 中。这些是 Office 的插件，但文档必须从 word 中打开，而不是从 webapp 中打开。

因此，想法是创建一个指向文件的 Windows 资源管理器链接以打开“file.lnk”。并将浏览器设置为使用资源管理器打开 lnk 扩展。

```
<a href="file:///C:\test.lnk">link</a> 
```

其中 test.lnk 是指向虚拟驱动器上目标文件的资源管理器链接。

这听起来有点狡猾，我同意，因为它只适用于 Windows。

只要 htlm 文件在本地计算机 (d:\app.htlm) 上运行，此实际工作正常，但在远程 Web 服务器 (mydomain.com/app.html) 上提供 html 文件时不起作用

问题：为什么客户端的链接没有从远程 Web 服务器提供？

有没有像sharepoint或Alfresco这样的怪物应用程序编辑从Web浏览器打开的MS Office文档的简单实现？

# ios - MPMusicPlayerController：结合 iPodMusicPlayer 和 applicationMusicPlayer 防止继续下一首曲目

> ID：10984203
> 
> 赞同：1
> 
> 时间：2012-06-11T16:41:35.830
> 
> 标签：ios, mpmusicplayercontroller

我有一个奇怪的问题。我有一个使用`[MPMusicPlayerController iPodMusicPlayer]`. 一切都很好，会触发曲目更改和播放状态更改的通知。

我有一个屏幕，用户需要在其中查看一首歌曲，我不希望他继续播放队列中的下一首歌曲。由于当曲目将更改（只有 DID 更改）时没有委托方法，为了防止音乐播放器继续播放下一首曲目，我使用了一个新的`[MPMusicPlayerController applicationMusicPlayer]`，给它 iPodMusicPlayer 当前正在播放的歌曲，一切都很好。没有要继续播放的新曲目，而且我没有触及原始`iPodMusicPlayer`队列，所以理论上，当我关闭此屏幕并`iPodMusicPlayer`再次使用时，一切都应该很好。

但是，当用户在此屏幕上完成并关闭它时，`iPodMusicPlayer`现在突然坏了，没有调用通知，当我将应用程序置于后台时，音乐停止播放，让我相信`iPodMusicPlayer`现在实际上是`applicationMusicPlayer`.

好的，所以我的问题基本上是：我需要一种方法来防止音乐播放器继续播放队列中的下一首曲目。如上所述，切换到带有一首曲目的 applicationMusicPlayer 似乎会破坏一些东西。最好的解决方案是什么？

**编辑**：因为这可能有点难以理解，我创建了一个小项目来显示问题：[https](https://github.com/kevinrenskers/MPMusicPlayerControllerTest) ://github.com/kevinrenskers/MPMusicPlayerControllerTest 。在播放音乐时打开应用程序，查看播放按钮是否正常运行。现在打开弹出窗口，再次关闭它，播放按钮坏了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T11:58:21.187

我找到了解决问题的方法：设置`repeatMode`为`MPMusicRepeatModeOne`然后捕获`MPMusicPlayerControllerNowPlayingItemDidChangeNotification`通知。您可以停止播放，并且永远不会继续下一个曲目。完成第二个屏幕后，我将其重置`repeatMode`为原始值。

# javascript - 确保我的随机值数组不包含重复值

> ID：10984205
> 
> 赞同：2
> 
> 时间：2012-06-11T16:41:45.950
> 
> 标签：javascript, jquery, random

我想知道是否有人可以建议我如何确保我从另一个数组生成的随机数组不包含重复值，想确保 arr2 包含唯一值？

JS

```
var limit = 5,
    i = 0,
    arr1 = [12, 14, 67, 45, 8, 45, 56, 8, 33, 89],
    arr2 = [];

    for ( i; i < limit; i++ ){
        var rand = Math.floor((Math.random()*9)+1);
        arr2.push( arr1[rand] );
    }

    console.log(arr2); 
```

也许是比较 arr1[rand] 和 arr2[i] 的 if 语句？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T16:44:47.277

创建一个临时数组，它是 arr1 的副本，仅包含唯一值：

```
// Copy unique values in arr1 into temp_arr
var temp_obj = {}, temp_arr = [], i;
for(i = arr1.length; i--;)
    temp_obj[arr1[i]] = 1;
for(i in temp_obj) 
    temp_arr.push(i); 
```

`temp_arr`然后，您可以在每次将元素添加到`arr2`. 由于我们在复制字符串时使用了对象键，因此我们可以`+`在推入时将它们转换回数字`arr2`：

```
arr2.push(+temp_arr.splice(rand, 1)[0]); 
```

您还应该将选择随机数的方式更改为：

```
var rand = Math.floor(Math.random()*temp_arr.length); 
```

整个代码：

```
var limit = 5,
  arr1 = [12, 14, 67, 45, 8, 45, 56, 8, 33, 89],
  arr2 = [],
  rand, 
  temp_obj = {},
  temp_arr = []
  i;

// Copy unique values from arr1 into temp_arr
for(i = arr1.length; i--;)
    temp_obj[arr1[i]] = 1;
for(i in temp_obj)
    temp_arr.push(i);;

// Move elements one at a time from temp_arr to arr2 until limit is reached
for (var i = limit; i--;){
    rand = Math.floor(Math.random()*temp_arr.length);
    arr2.push(+temp_arr.splice(rand, 1)[0]);
}

console.log(arr2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:43:52.333

天真的`O(n^2)`解决方案是简单地检查每个元素并查看数组中的任何其他位置是否具有相同的值。

使用哈希集数据结构可以实现线性时间解决方案。您可以使用对象在 JavaScript 中破解一个：

```
var set = {};
set['0'] = true;
set['1'] = true;

if(set.hasOwnProperty('0')) {
    alert("duplicate 0!");
} 
```

如果数字是整数并且相对较小，那么您可以在布尔值数组中跟踪它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T19:25:56.297

通过使用`jQuery.inArray`功能:)

```
var limit = 5,
arr1 = [12, 14, 67, 45, 8, 45, 56, 8, 33, 89],
l = arr1.length,
arr2 = [];

while( limit ){
      var tmp = arr1[  Math.random() * l | 0 ];  
      // for unsigned numbers '|0' construction works like Math.floor  
      if( !~$.inArray( tmp, arr2 ) ) { 
       // if not found $.inArray returns -1 ( == ~0 ), then !~-1 == true   
          limit--;
          arr2[ arr2.length ] = tmp;
      } 
} 
console.log( arr2 ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T16:44:05.383

尝试这个

```
for ( i; i < limit; i++ ){
        var rand = Math.floor((Math.random()*9)+1);
        for(j=0; j <  arr1.length; j++)
           if(rand == arr1[j]
           { 
                blnfound = true;
                break;
           }
        if(!blnfound)
        arr2.push( arr1[rand] );
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-11T16:48:22.457

有关 Fischer/Yates shuffle 的详细信息，请参阅[http://bost.ocks.org/mike/shuffle/](http://bost.ocks.org/mike/shuffle/)。对于您的问题，您可以采用洗牌后的前五个元素。

# jquery - Google Analytics - 多个配置文件的 _trackEvent

> ID：10984213
> 
> 赞同：0
> 
> 时间：2012-06-11T16:42:14.037
> 
> 标签：jquery, google-analytics

我们正在尝试跟踪主要 Google Analytics（分析）配置文件和次要配置文件的点击事件。两个配置文件的页面浏览量都正确注册。

问题是点击事件只被注册到主要配置文件，而不是次要配置文件。我们已经等了超过 24 小时，看看在 GA 中注册的辅助帐户点击事件是否有延迟，但并不高兴。（为主配置文件正确注册点击事件通常需要大约 15 分钟）。如果有人能在下面的代码中发现问题所在，我们将不胜感激。非常感谢

```
var _gaq = _gaq || []; 

var mainAccount = 'UA-1234567-1';
var secondaryAccount = 'UA-1234567-2';

_gaq.push(  ['_setAccount', mainAccount], 
            ['_trackPageview'],
            ['b._setAccount', secondaryAccount], 
            ['b._trackPageview']);

(function(){
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

jQuery(document).ready(function()
    { 
        jQuery('.home-bottom-right a').click(function(){
            _gaq.push(['_trackEvent', 'Homepage', 'click', 'Home_bottom_right'],['b._trackEvent', 'Homepage', 'click', 'Home_bottom_right']);
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T20:53:22.633

Adding to mike's answer, you can test the length of the _gaq array to see if analytics has finished processing all objects:

```
jQuery('.home-bottom-right a').click(function(e){
    _gaq.push(['_trackEvent', 'Homepage', 'click', 'Home_bottom_right'],['b._trackEvent', 'Homepage', 'click', 'Home_bottom_right']);
    if (this.target !== '_blank') {
        e.preventDefault();
        var url = this.href;
        (function() {
            if (typeof _gaq.length == "undefined" || _gaq.length == 0) {
                location.href = url;
            } else {
                setTimeout(arguments.callee, 0);
            }
        })();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T20:43:34.863

如果您要跟踪的点击是在当前窗口中打开一个新页面，则可能是第二个`_trackEvent`跟踪像素请求在离开当前页面之前尚未完成。

我使用以下代码的变体为在同一窗口中打开的链接添加了 150 毫秒的延迟：

```
jQuery('.home-bottom-right a').click(function(e){
  _gaq.push(['_trackEvent', 'Homepage', 'click', 'Home_bottom_right'],['b._trackEvent', 'Homepage', 'click', 'Home_bottom_right']);
  if (this.target != '_blank') {
    e.preventDefault();
    var url = this.href;
    setTimeout('location.href = "' + url + '"', 150);
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:57:01.183

我会尝试的第一件事是将点击跟踪线变成 2 行

```
_gaq.push(['_trackEvent', 'Homepage', 'click', 'Home_bottom_right']);
_gaq.push(['b._trackEvent', 'Homepage', 'click', 'Home_bottom_right']); 
```

在 google 提供的指南页面上，他们总是在每次推送时跟踪一个事件。所以试一试，也许它会起作用，除此之外代码看起来不错。可能 b 设置不正确

# asp.net-mvc-3 - 未调用 FluentValidation 验证器

> ID：10984214
> 
> 赞同：5
> 
> 时间：2012-06-11T16:42:18.357
> 
> 标签：asp.net-mvc-3, entity-framework-4, partial-classes, fluentvalidation

我有一个 MVC 3 站点，但正在使用非 MVC FluentValidation dll。我创建了一个验证器类，并在构造函数中放置了我所有的 RuleFors，然后在我的模型类上设置了一个属性

```
[FluentValidation.Attributes.Validator(typeof(MyValidator))] 
```

问题是验证器类的构造函数永远不会被调用。我认为这可能是因为我没有使用 dll 的 MVC 版本，但是我也无法让该版本为我工作。

任何帮助，将不胜感激。

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T16:50:52.127

在您`Application_Start`确保您已初始化自定义流式验证模型验证器提供程序，否则将不会发生任何事情：

```
FluentValidation.Mvc.FluentValidationModelValidatorProvider.Configure(); 
```

该类`FluentValidationModelValidatorProvider`在`FluentValidation.Mvc`程序集中定义。请查看[将 FluentValidation 集成到 ASP.NET MVC 站点](http://fluentvalidation.codeplex.com/wikipage?title=mvc&referringTitle=Documentation)的文档。

当您调用一个控制器动作时，验证器将被触发，该动作采用一个装饰有该`[Validator]`属性的模型作为参数：

```
[HttpPost]
public ActionResult Process(MyViewModel model)
{
    ...
} 
```

# indexing - 将网页抓取到索引中的程序

> ID：10984216
> 
> 赞同：0
> 
> 时间：2012-06-11T16:42:29.807
> 
> 标签：indexing, screen-scraping, static-content

我一直在寻找从静态网页创建索引的程序。我不是在寻找像 Solr 或 elasticsearch 这样的程序，因为两者都假设我将以交互方式创建索引。我需要一些基本上可以访问 url，并从它提取的页面创建搜索索引的东西。它可以以任何必要的方式创建索引（db、xml 等） ，在不使用任何这些的网站上。

感谢您提供任何可以帮助我入门的提示或可以解决我的问题的答案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T20:40:20.560

调查[纳奇](http://nutch.apache.org/)。Nutch 可以索引一个 URL，并且您可以索引的内容是非常可配置的。

完成爬网/索引后，该索引即可搜索。不涉及编程。

# c# - 获取 ContextMenuStrip 子菜单的句柄

> ID：10984219
> 
> 赞同：1
> 
> 时间：2012-06-11T16:42:44.400
> 
> 标签：c#, winforms, contextmenu

我正在为一个应用程序开发一个插件，我必须注册我在我的主机应用程序中创建的任何控件，否则它们不会收到任何消息并且被有效地禁用。注册是使用控件的窗口句柄执行的。***（请将此部分视为给定的，这只是我为什么需要它的背景。）***

为了做到这一点，对于我创建的每个 winforms 控件，我使用它的`HandleCreated`事件和`HandleDestroyed`事件递归地注册/注销控件的句柄和它拥有的任何子控件。

我可以用 a 做同样的事情`ContextMenuStrip`，这对于第一级项目来说很好，但是如果这些项目中有任何一个有子菜单，我不知道如何获取已打开的子菜单的句柄以便注册它。

`ToolStripMenuItem`对象继承自而`System.ComponentModel.Component`不是继承自`System.Windows.Forms.Control`，因此它们没有`.Handle`属性，也没有`HandleCreated`和`HandleDestroyed`事件。

请参阅图像以了解我需要处理哪个窗口（在创建时）。 ![在此处输入图像描述](../Images/8a7d8deadafc28086df0b7045e0c24c0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:47:18.307

使用`ToolStripMenuItem.DropDown.Handle`.

# c++ - 用于排序链表而不混乱的继承

> ID：10984222
> 
> 赞同：1
> 
> 时间：2012-06-11T16:42:59.810
> 
> 标签：c++, linked-list, polymorphism

我有一个看起来很简单的问题，但我找不到一个优雅的解决方案。

我正在使用一个需要排序两次的链表：

*   在添加列表元素时一次性添加一个参数，并且
*   经过一些处理后，在不同的参数上一次。

我存储在列表中的对象继承自抽象列表项基类。

问题在于诉诸第二个参数。我不想在列表项基类中为它编写一个纯虚拟访问器，因为我后来在列表中存储了一些其他对象，这些对象也继承自列表项基类，但是第二个访问器对他们。

我缺少一个干净的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:05:35.083

使用谓词：

```
std::list<Base*> myList; /* populate */

myList.sort([](Base * const p1, Base * const p2) -> bool
            { return static_cast<Derived*>(p1)->compare_with(*p2); }
           ); 
```

这假设在您的排序运行期间，所有元素实际上都是指向`Derived`其具有`foo`返回布尔值的成员函数（甚至不需要是虚拟的）的指针。

您当然可以以任何您喜欢的方式调整谓词的细节。如果您使用的是旧编译器，还可以将 lambda 表达式替换为传统的、拼写出来的谓词类。

如果您不能确定所有元素实际上都是`Derived`类型，那么您可以使用 a`dynamic_cast`代替，但是您必须想办法对所有无法比较的对象进行排序。在这种情况下，最好先将您的范围划分为那些存在`Derived`和不存在的东西，并且只对前者进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:09:21.360

如果我理解正确，你有类似的东西：

```
 class Base {
    public:
    int getParam1() const { ... }; 
    virtual void foo() =0;  // this is an abstract class
    virtual ~Base() { ... }
 }
 class Derived : public Base {
    public:
    int getParam1() const { ... }
    int getParam2() const { ... }

 } 
```

你有一个`std::list<Base*> myList`地方。第一次要对列表进行排序时，您可以执行以下操作：

```
sort(list.begin(),list.end(),[](const Base*v1,const Base*v2) {
    return v1->getParam1()<v2->getParam1();
}); 
```

对于第二种，您需要使用特定于 class 的东西`Derived`。您不想将纯虚拟访问器添加`getParam2()`到`Base`并在`Derived`. 但是，如果您知道您的列表*仅*包含Derived 对象，则可以毫无问题地使用强制转换：

```
sort(list.begin(),list.end(),[](const Base*b1,const Base*b2) {
    const Derived * d1 = dynamic_cast<const Derived*>(b1);
    const Derived * d2 = dynamic_cast<const Derived*>(b2);

    return d1->getParam2() < d2->getParam2();
}); 
```

请注意，如果列表中的对象不是`Derived`，则 dynamic_cast 将返回`nullptr`，以便您可以安全地检查它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:09:00.457

我是否正确理解您想要对某些容器（您自己设计的）的元素进行排序，以便在这些元素之间进行比较的不同版本？如果是这样，只需为您的排序算法提供比较函子/函数。

# unit-testing - Scala - 单元测试设置（使用访问修饰符限定符？）

> ID：10984226
> 
> 赞同：7
> 
> 时间：2012-06-11T16:43:26.763
> 
> 标签：unit-testing, scala, scope, tdd

我是 Scala 的新手（来自 Java），我喜欢开发 TDD/BDD。所以在了解 Scala 之前，我已经深入研究了 Scalatest。

从您希望尽可能多地进行测试的角度来看，我想知道您认为什么是单元测试的良好访问策略。

假设我有一个我想测试的类 World 和一个不应该知道关于 World 的一切的类 Agent。

```
package program {
  package world {
    class World {
      private var notForAgent
      def forAgentDuringActing
      // forAgentDuringActing has an important side effect in notForAgent
    } 
  }

  package agent {
    class Agent
    // would call World.forAgentDuringActing
  }

  package world.test {
    class WorldSpec extends FunSpec {
      describe("The world") {
        it("should have side-effect behaviour when the agent acts on it") {
          // ... the test ...
        }
      }
    }
  }
} 
```

请注意，这些包声明对我来说并不神圣。我真正想要的是 WorldSpec 将类似于 World 的伴随对象，以便它可以测试副作用。

我想也许访问修饰符限定符会有所帮助。我可以说`private[world] notForAgent`，但这确实比我想要的更多。我实际上想要的是类似的东西`private[this, test.WorldSpec] notForAgent`，但我认为不允许使用多个限定符。

你会怎么做才能使这个可测试？或者，你能指出我的想法错误的方向吗？

ps 我知道“从不测试私人”的说法。但我也知道“测试比代码本身更重要。如果需要测试，请更改访问修饰符”的观点。但是，我想避免在这个线程中进行讨论。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-11T19:07:55.373

如果您问“如何测试私有方法？”，那么 ScalaTest 实际上支持这一点。见[这里](http://www.scalatest.org/scaladoc/1.0/org/scalatest/PrivateMethodTester.html)。

```
class C {
  private def m(x: Int) = x
}

class CTests extends /*any test suite you like*/ with PrivateMethodTester {
  val decoratedM = PrivateMethod[Int]('m)
  val c = new C
  val actual = c invokePrivate decoratedM(4711)
  val expected = 4711
  actual should be(expected) // this line depends on the test suite you've chosen
} 
```

# ruby-on-rails - 使用 Rspec 和 Shoulda，为什么“设置”未定义？

> ID：10984228
> 
> 赞同：1
> 
> 时间：2012-06-11T16:43:28.620
> 
> 标签：ruby-on-rails, unit-testing, rspec, shoulda

更新 2：require {path_to_spec_helper} 解决了设置未定义的问题，但现在所有的静态变量都突然未定义，并且所有 FactoryGirl 制造的对象都没有通过验证（即使检查表明该对象应该通过验证）。并且将 FactoryGirl 更改为 save_with_validation(false) 只会使我的测试中的对象为零，从而破坏了一切。

更新：我把它扔到我的代码中：

```
 context "some context" do
    ap self.respond_to?(:setup)
    setup do
        raise "stop" 
```

并且respond_to 行打印为true，但随后继续抛出下面的method_missing 错误。所以，我猜它只是在上下文中未定义？以前不是这样的。

原帖：

出于某种原因，我不知道，似乎`context`/ `should`/`setup`在我的测试中未定义。我会将所有设置更改为's ，然后or`before(:each)`就会出现问题。当我将所有 rspec / shoulda 匹配器更改为老式风格的- -时，我的测试将运行，但实际上不会被执行。（控制台中的进度显示没有正在运行的测试（无点））。`should``context``describe``before(:each)``it{}`

那么，我想，如何验证我的测试环境是否设置正确？

**这是我的配置**
gem文件：

```
# can't be in test group because it's required in the rake file
gem "single_test"# because running all the tests all the time takes too long

group :test do
    # helper gems
    gem "rspec-rails", "1.3.4"
    gem "rspec", "1.3.2"
    gem "shoulda"

    gem "database_cleaner"
    gem "crack" #for XML / JSON conversion

    gem "mocha" #required for .requires and .stubs
    gem "factory_girl", :require => false

    # view and functional
    gem "capybara", "1.1.1"
    gem "cucumber", "1.1.0"
    gem "cucumber-rails", "0.3.2"
    gem "culerity"

    gem "launchy"
    gem "hpricot"
    gem "gherkin"
    gem "rack"
    gem "webrat"

    # tools
    gem "json"
    gem "curb"

end 
```

测试 hepler 中需要的东西：

```
require File.expand_path(File.dirname(__FILE__) + "/../config/environment")

require "bundler/setup"
Bundler.require(:test)

require 'test_help'
require 'spec'
require 'spec/expectations'
require 'factory_girl' 
```

*二进制信息*：
ruby 1.8.7
rvm 1.7.2
gem 1.8.21
bundle 1.1.4
rake 0.9.2.2
rails 2.3.14

**我的错误**：

```
`method_missing': undefined method `setup' for Spec::Example::ExampleGroup::Subclass_1:Class (NoMethodError) 
```

堆栈跟踪：

```
from test/unit/my_test.rb:257
from /Users/me/.rvm/gems/ruby-1.8.7-p352/gems/rspec-1.3.2/lib/spec/example/example_group_methods.rb:188:in `module_eval'
from /Users/me/.rvm/gems/ruby-1.8.7-p352/gems/rspec-1.3.2/lib/spec/example/example_group_methods.rb:188:in `subclass'
from /Users/me/.rvm/gems/ruby-1.8.7-p352/gems/rspec-1.3.2/lib/spec/example/example_group_methods.rb:55:in `describe'
from /Users/me/.rvm/gems/ruby-1.8.7-p352/gems/rspec-1.3.2/lib/spec/example/example_group_factory.rb:31:in `create_example_group' 
```

堆栈上最后一个代码位的第 257 行代码：

```
 context "some context" do
    setup do
    ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-02-21T11:25:26.007

如果你没有，首先你必须生成你的 spec/spec_helper.rb 和 spec/rails_helper.rb 文件。您可以使用以下命令执行此操作：

`rails generate rspec:install`.

创建文件后，请确保`rails_helper.rb`requires `spec_helper.rb`，否则它将无法正常工作并且 `require "rails_helper"`位于您的规范文件之上。

`rails_helper.rb`您可以在此处查看更详细的配置`spec_helper.rb`：[https ://kolosek.com/rails-rspec-setup](https://kolosek.com/rails-rspec-setup)

# sql-server - SQL Server 中的 For 循环 - 这是正确的逻辑吗？

> ID：10984241
> 
> 赞同：0
> 
> 时间：2012-06-11T16:44:42.693
> 
> 标签：sql-server, sql-server-2008, for-loop, while-loop

我正在尝试获取事务数据并对其进行清理以满足我的分析需求。如何将事务记录到数据库中存在一些限制，我正在尝试绕过这些限制。

当客户下订单时包含超过 1 个产品，事务数据库不会将多个产品链接在一起。每个产品都有一个唯一的销售 ID，但无法将多个销售 ID 分组到 1 个订单中。这是一个示例：

```
OrderID   MultOrderID   CustomerID  SalesDate   SalesTime   ProductID   ProductCost ShippingCost
6082346                 7661X0A     2012-06-12  959         105         99.99       7.95
6082347   5809812YY6Y   T891002     2012-06-12  1005        222         99.95       7.95
6082348   5809812YY6Z   T891002     2012-06-12  1005        273         22.95       1.00
6082349   5809812YY71   T891002     2012-06-12  1005        285         499.95      1.00
6082350   5809812YY72   T891002     2012-06-12  1005        172         49.95       1.00
6082351   5809812YY73   T891002     2012-06-12  1005        105         99.99       7.95
6082352   5809812YY74   X637251     2012-06-12  1010        285         499.95      7.95
6082353   5809812YY75   X637251     2012-06-12  1010        30          1024.99     1.00
6082354                 T512AT0     2012-06-12  1017        172         49.95       7.95 
```

此交易系统的另一个限制是它不能同时运送超过 4 个产品。如果客户下了 5 件产品的订单，4 件产品一起发货（并收取 1 次运费），其余产品单独发货并收取另一次运费（是的，整体业务想要重建整个遗留系统...... .)。

我要确定的是每个订单运送的产品数量，以及总产品成本和运输成本。

如果您查看 MultOrderID 的最后 4 个字符，您会看到它是连续的，YY6Y 变为 YY6Z，然后滚动到 YY71、YY72。逻辑是标准化的——我知道如果 CustomerID、SalesDate 和 SalesTime 相同，那么我可以将产品配对在一起。我不知道我怎么能做到这一点。

我相信实现这一点的方法是按 CustomerID、SalesDate 和 SalesTime 分解订单。然后，我得到一个`for-loop`, 或类似的东西来循环浏览各个条目。然后，我查找 MultOrderID 的最后 4 个字符并说 - 如果 1,2 和 3 相同，并且第 4 个字符在前一个订单的第 4 个字符之后，那么将它们配对在一起，最多 4 个订单。如果 orderID 是该范围内的第 5 到第 8 个订单，则为货件 2，以此类推。

这可以在 内完成`SQL Server`吗？如果不是那个，我应该写什么？`for-loop`在这种情况下我应该使用什么 ？

编辑：这是我想要得到的输出。请记住，在第 4 个产品发货后，我需要重新开始订购（因此，6 个产品分为 2 个发货 [4 个产品和 2 个产品]，9 个产品分为 3 个发货 [4、4 和 1]。

```
PRODUCTSSHIPPED SALESDATE   SALESTIME   CUSTOMERID  PRODUCTCOST SHIPPINGCOST
4               6/12/12         1005    T891002     672.8       10.95
1               6/12/12         1005    T891002     99.99       7.95
2               6/12/12         1010    X637251     1524.94     8.95
1               6/12/12         1017    T512AT0     49.95       7.95
1               6/12/12         959     7661X0A     99.99       7.95 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:03:05.500

那么从这个陈述看来你想要这个：

> 我要确定的是每个订单运送的产品数量，以及总产品成本和运输成本。

[http://sqlfiddle.com/#!3/e0e71/30](http://sqlfiddle.com/#!3/e0e71/30)

所以我不确定你所说的使用 foreach 循环是什么意思？

更新：

使用子查询和上限函数让它工作

更新了小提琴

仅供参考的 SQL 是：

```
SELECT
SalesDate,
SalesTime,
CustomerID,
SUM(ProductCost),
SUM(ShippingCost)
FROM 

(
SELECT
       SalesDate,
       SalesTime,
       CustomerID,
       ProductCost,
       ShippingCost,
       ROW_NUMBER() OVER (PARTITION BY salesdate, salestime, customerid ORDER BY CustomerID) as ProdNumber
FROM Orders
) as Summary
group by SalesDate, SalesTime, CustomerID, ceiling(ProdNumber / 4.0) 
```

我使用 ROW_NUMBER 来获取每个订单的产品的运行计数，然后将此作为子查询，以便我可以进行分组。分组仅使用产品数除以 4（作为浮点数）并使用上限函数四舍五入到最接近的 int 以将其分组为 4

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:55:53.187

这应该在 NumOrders 字段中为您提供该客户/日期/时间的订单数量。它使用了我最喜欢的新函数 Row_Number：

```
SELECT [CUSTOMERID], [SALESDATE], [SALESTIME], MAX(NumOrders)
FROM (
    SELECT [CUSTOMERID], 
    [SALESDATE],
    [SALESTIME],
    ROW_NUMBER() OVER(PARTITION BY [CUSTOMERID], [SALESDATE], [SALESTIME] ORDER BY [CUSTOMERID]) AS NumOrders
) t1
GROUP BY [CUSTOMERID], [SALESDATE], [SALESTIME] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T16:56:27.413

我认为您在这里不需要循环。通常它被认为是 sql 中的一种不好的做法，除非完全不可避免。您是否可以假设如果用户在同一日期时间下的订单恰好属于相同的逻辑订单（订单组）？[无论如何，使用 SQL server 的partition 和 over 子句](http://msdn.microsoft.com/en-us/library/ms189461.aspx)可能可以解决整个问题。看看那里的样本 D，我认为它正在做一些接近你需要的事情。

**编辑**
range 子句仅在 sql 2012 中可用，但是您仍然可以使用分区和行号，然后通过对返回的行号使用简单计算 (ROWNUMBER / 4) 按您的结果分组

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T16:55:22.750

我不确定为什么根本需要循环..

```
Select count(*) as ProductsOnOrder, LEFT(CustomerID,4), as CID,
       SalesDate, SalesTime, sum(productCost), sum(ShippingCost)
FROM YOUR_TABLENAME
GROUP BY left(CustomerID,4), salesdate, salestime 
```

您要显示什么订单号？敏？最大限度？全部？什么？关于产品的相同问题您要列出产品还是只计算它们？

```
Select count(*) as ProductsOnOrder, LEFT(CustomerID,4), as CID,
       SalesDate, SalesTime, sum(productCost), sum(ShippingCost),
       min(orderID), Max(orderID)
FROM YOUR_TABLENAME
GROUP BY left(CustomerID,4), salesdate, salestime 
```

由于您知道 orderID 对于订单上的每一行都是连续的，因此您可以返回 min/max 并将两者相减以获得计数。

# android - 为 android gridview 注册上下文菜单

> ID：10984243
> 
> 赞同：2
> 
> 时间：2012-06-11T16:44:48.137
> 
> 标签：android, gridview, contextmenu

我正在尝试为我的 gridview 注册一个上下文菜单。目前没有任何反应。令人惊讶的是，我在这里找不到答案。

我的gridview在main.xml relativelayout里面：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android" 
android:layout_width="match_parent"
android:layout_height="match_parent">
<LinearLayout 
    android:id="@+id/bottom_bar"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:gravity="center"
    android:orientation="horizontal">
    <ImageButton 
        android:id="@+id/cameraButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@android:drawable/ic_menu_camera"
        android:onClick="cameraButtonOnClick"/>

    <ImageButton 
        android:id="@+id/addGalleryButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/add_gallery"
        android:onClick="addGalleryButtonOnClick"/>

    <ImageButton 
        android:id="@+id/addDirButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/add_dir"
        android:onClick="addDirButtonOnClick"/>
</LinearLayout>
<GridView 
    android:id="@+id/gridview"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent"

    android:numColumns="auto_fit"
    android:verticalSpacing="10dp"
    android:horizontalSpacing="10dp"
    android:columnWidth="90dp"
    android:stretchMode="spacingWidthUniform"
    android:gravity="center"
    android:layout_above="@id/bottom_bar"  
/> 
```

gridview 用 thmbnail.xml 填充：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"     xmlns:app="http://schemas.android.com/apk/res/com.ninovanhooff.projectv"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<ImageButton
    android:id="@+id/thumbview"
    android:layout_width="90dp"
    android:layout_height="90dp"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"

    android:scaleType="fitCenter"
    android:background="@drawable/thumb_selector" 
    android:src="@drawable/sample_0" />

<!-- <TextView
    android:id="@+id/label"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerInParent="true"
    android:focusable="false"
    android:paddingLeft="3dp"
    android:paddingRight="3dp"
    android:background="@drawable/label_bg"/>

<com.ninovanhooff.projectv.ThreeStateCheckBox
    android:id="@+id/tricheckbox"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:focusable="false"
    app:label=""
    app:shadow="false"
    app:state="0"
    android:layout_alignParentBottom="true"> 
</com.ninovanhooff.projectv.ThreeStateCheckBox>
-->

</RelativeLayout> 
```

请注意，仅保留图像按钮以简化问题

Contextmenu 是这样注册的：

```
adapter = new ThumbnailAdapter(this);
    gridView = (GridView) findViewById(R.id.gridview);
    gridView.setAdapter(adapter);
    registerForContextMenu(gridView); 
```

我怀疑它与 android:focusable 或 android:clickable 有关。但不知道该尝试哪个。我在main.xml的relativelayout和linearlayout上都尝试了focusable = false和clickable = false，但没有效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T07:37:53.017

所以，我得到了这个工作，我的怀疑是正确的。其他从预期的 gridview 元素中窃取触摸事件的元素。确保从布局中删除可点击的对象，如按钮和复选框，以找到罪魁祸首。就我而言，我必须同时删除 ImageButton 和 ThreeStateCheckbox。另一个错误是我将 onclicklisteners 添加到 ImageButton 而不是 gridview (thumbnail.xml) 的直接子级。推荐的方法是使用 gridview.setOnItemClickListener(listener))。现在，这可行，但我仍然需要我的图像和复选框。ImageButton 被 ImageView 取代，我在复选框中添加了 android:focusable="false" 以防止它消耗点击事件。一切正常。

如果你无法弄清楚这些东西，hierarchyviewer 可能会很有启发性。也许您忘记了一些可以窃取您的触摸事件的微小元素。祝你好运！

# excel - 我可以在 VBA 中使用 DPAPI（或类似的东西）吗？

> ID：10984256
> 
> 赞同：2
> 
> 时间：2012-06-11T16:45:52.160
> 
> 标签：excel, dpapi, vba

我关于 VBA 的初学者系列问题中的另一个。

我正在用 VBA 编写 Excel 插件，插件使用本地配置文件。
该文件需要包含远程服务的密码。
显然，将此密码存储为明文并不理想。但我正在寻找一种可以编码/解码文本的算法，因此它至少*看起来*不像配置文件中的纯文本。

我遇到了对 Windows **DPAPI**的引用，但我不确定这是否是 Excel VBA 的合适解决方案。我也不确定如何在 VBA 中使用这个 API，因为我只找到了在 .NET 中使用它的参考资料。此项目无法使用 Visual Studio。

所以两部分的问题是这样的：
1）如果可以在 VBA 中使用 DPAPI，我可以举个例子来说明它的用法吗？
2) 如果在 VBA 中无法使用 DPAPI，您对如何以某种可逆的编码方式存储文本有什么建议吗？

如果重要，该解决方案必须在 Excel 2003 及更高版本中运行。

再一次感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T00:52:29.793

> 如果重要，该解决方案必须在 Excel 2003 及更高版本中运行。

对于 Excel VBA，我建议使用 CAPICOM 库。

[从这里](http://www.microsoft.com/en-us/download/details.aspx?id=25281)下载文件。安装后，请按照这些说明注册 Dll。

**32 位操作系统**

将文件 Capicom.dll 从复制`C:\Program Files\Microsoft CAPICOM 2.1.0.2 SDK\Lib`到`C:\Windows\System32`

*开始菜单*上的下一步| *运行*，输入这个

```
Regsvr32 C:\Windows\System32\Capicom.dll 
```

**64位操作系统**

将文件 Capicom.dll 从复制`C:\Program Files (x86)\Microsoft CAPICOM 2.1.0.2 SDK\Lib\X86`到`C:\Windows\SysWOW64`

*开始菜单*上的下一步| *运行*，输入这个

```
Regsvr32 C:\Windows\SysWOW64\Capicom.dll 
```

现在我们准备在我们的 VBA 项目中使用它

将此代码粘贴到模块中

```
Option Explicit

Sub Sample()
    Dim TextToEncrypt As String, EncryptedText As String
    Dim TextToDeCrypt As String, DeCryptedText As String
    Dim KeyToEncrypt As String

    TextToEncrypt = "Hello World"
    KeyToEncrypt = "JoshMagicWord"

    EncryptedText = EncryptString(TextToEncrypt, KeyToEncrypt)
    DeCryptedText = DecryptString(EncryptedText, KeyToEncrypt)

    Debug.Print "The string " & TextToEncrypt & " after encryption looks like this"
    Debug.Print "-----------------------------------------------------------------"
    Debug.Print EncryptedText
    Debug.Print "-----------------------------------------------------------------"
    Debug.Print "The above string after decrypting looks like this"
    Debug.Print "-----------------------------------------------------------------"
    Debug.Print DeCryptedText

End Sub

Public Function EncryptString(strText As String, ky As String) As String
    Dim Cap As Object
    Dim cryptIt

    Set Cap = CreateObject("CAPICOM.EncryptedData")

    Cap.Algorithm = 3
    Cap.SetSecret ky
    Cap.Content = strText
    EncryptString = Cap.Encrypt
End Function

Public Function DecryptString(strText As String, ky As String) As String
    Dim Cap As Object
    Dim cryptIt

    Set Cap = CreateObject("CAPICOM.EncryptedData")

    Cap.Algorithm = 3
    Cap.SetSecret ky
    Cap.Decrypt strText

    DecryptString = Cap.Content
End Function 
```

函数`EncryptString`加密字符串，函数`DecryptString`解密字符串。运行上述内容时查看结果快照`Sub Sample`

![在此处输入图像描述](../Images/6229b9ae6251ccffbda30cd36be2332c.png)

# visual-studio-2010 - VS2010 MSI设置项目

> ID：10984258
> 
> 赞同：2
> 
> 时间：2012-06-11T16:45:59.367
> 
> 标签：visual-studio-2010, windows-installer, setup-project, setup-deployment

我在浏览网页时没有看到这个问题，所以这里是：

我使用 .msi 文件（与右键单击 -> 安装，安装项目上的选项相比）将“1.0.7 版”产品安装到我的计算机上。

然后我将“版本”更改为 1.0.8 ，并将**所有**项目的 Assembly Version/AssemblyFileVersion 属性更改为 1.0.8.0。我删除了旧的主输出，并在 KeyOutput 扩展列表下添加了一个新的，以确保版本正确。我这样做是因为在我将所有程序集版本更改为 1.0.8.0 后它没有更新，并且它保持在 1.0.7.0（以前的版本）。

我构建了我的安装项目并转到包含新 1.0.8 .msi 文件的文件夹。我双击并得到“应用程序已经存在，在添加/删除程序中删除现有”（或类似）对话框，它停止了安装。

所以我检查了我的：
**ProductCode** - 它们在新/旧版本之间是相同的，
**UpgradeCode** - 也相同，两个版本之间的
**RemovePreviousVersion**属性设置为**True 。**这是我检查的，因为我通常在所有其他搜索中都找到了解决方案，但它不起作用。

所以我卸载了 1.0.7 版本，安装了 1.0.8 并且一切正常。仍然没有解决我不应该得到 unistall 第一个提示的问题。注意：我一直在“所有人”上安装。

我再次卸载了 1.0.8（此时，不存在/未安装任何版本），并尝试了以下操作：
1\. 从 .msi 文件安装 1.0.7**或**通过右键单击其安装项目并使用“安装”安装 1.0.7选项。
2\. 右键单击​​ 1.0.8 安装项目并从那里使用安装选项。
3.没有错误/对话框弹出，老版本好像先卸载了，然后我继续安装，新版本在电脑上。这就是我要的！

正如你在这里看到的，我需要能够使用 1.0.7 .msi 文件来安装，然后当我需要修补/修复/更新时，我需要能够 1.0.8 .msi 不显示“已经存在" 提示并只是覆盖/合并，但除非我使用 VS2010 右键单击​​>，否则这不会发生

任何帮助表示赞赏。

编辑添加粗体

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T05:28:51.620

在两个版本之间更改 ProductCode。阅读有关[重大升级的更多信息](http://msdn.microsoft.com/en-us/library/windows/desktop/aa369786%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T11:36:33.093

当且仅当机器上存在以前的版本时，安装次要升级（当您更改 ProductVersion 而不是 ProductCode 时就是这种情况）需要指定 REINSTALL。对于资源管理器启动的场景，有多种方法可以通过在属性表中指定它并使用自定义操作将其清除，但更常见的是使用启动器或使用主要升级来处理它。

# asp.net - Sitecore：与 Response.Redirect 相比，Sitecore.Web.WebUtil.Redirect 有什么优势？

> ID：10984261
> 
> 赞同：5
> 
> 时间：2012-06-11T16:46:01.870
> 
> 标签：asp.net, redirect, sitecore

使用时有什么优势或区别...

```
Sitecore.Web.WebUtil.Redirect(string path) 
```

...代替...

```
Response.Redirect(string url) 
```

...用于重定向？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-11T16:53:43.633

有一个主要区别。Sitecore 方法将检查是否确实存在`HttpContext`. `Sitecore.Web.WebUtil.Redirect(string path)`除此之外，轮流调用没有区别`HttpContext.Current.Response.Redirect(path, true)`；

但是，如果您调用`Sitecore.Web.WebUtil.Redirect(path, false)`并且您提供的路径与您所在的页面相同，则不会发生重定向。

# python - Python '&' 字符丢失

> ID：10984263
> 
> 赞同：3
> 
> 时间：2012-06-11T16:46:10.913
> 
> 标签：python, wxpython

当我使用 wx python 创建一个以文件名作为按钮标签的按钮时，我丢失了`&`文件名内部的字符。

如果一个文件被命名为: `hello&goodbye.txt`，该按钮将显示为：`hellogoodbye.txt`

我不知道`&`角色去了哪里，希望能在这里得到一点帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:49:00.880

`&`字符是这类按钮的特殊符号。它定义了您按下哪个键来使用键盘快捷键。

&x - [Alt]+[x] 快捷键。您可以使用第二个来逃避它：`&&`-> '&' char

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:49:43.017

& 符号似乎是某种标记。[在这里](http://wxpython-users.1045709.n5.nabble.com/Ampersand-in-static-text-control-td2358418.html)阅读。它基本上是这样说的：

> 找到了答案：两个＆符号。

# c# - HTTPWebRequest.GetResponse() 通过透明代理验证请求失败

> ID：10984264
> 
> 赞同：13
> 
> 时间：2012-06-11T16:46:17.933
> 
> 标签：c#, httpwebrequest, .net-2.0, http-proxy, transparentproxy

我们正在使用这些`HTTPWebRequest`对象向我们的应用程序发出 HTTP 请求，当请求需要身份验证并且存在透明代理 (Squid 3.1.10) 时，我们遇到了问题。

```
string url = "http://www.icode.co.uk/test/auth.php";
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
request.Credentials = new NetworkCredential("username", "password");

HttpWebResponse response = (HttpWebResponse)request.GetResponse();
Stream stream = response.GetResponseStream();
StreamReader reader = new StreamReader(stream);

MessageBox.Show(reader.ReadToEnd());

reader.Close();
stream.Close();
response.Close(); 
```

我们的原始代码使用了同样问题的 WebClient 类。

此代码第一次运行时，它会正确显示结果。当代码第二次运行时，它会失败并显示`GetResponse()`：

```
System.Net.WebException was unhandled
  Message="The server committed a protocol violation. Section=ResponseStatusLine"
  Source="System"
  StackTrace:
       at System.Net.HttpWebRequest.GetResponse()
       at Dummy.DummyForm.button1_Click(Object sender, EventArgs e) in H:\Trial\Dummy\DummyForm.cs:line 42
       at ... 
```

在 Windows 7 上，重新启动进程会使其恢复并运行一次，但 Server 2003 需要完全重新启动。

查看[网络捕获](https://dl.dropboxusercontent.com/u/2931731/StackOverflow/10984264/failed.cap)，两个请求一开始是相同的，发送初始未经身份验证的请求并且服务器回复，但失败的请求在初始回复中间发送第二个经过身份验证的请求，就好像它忽略了`Content-Length`标头（即正确的）。然后它会收到初始回复的其余部分，并因协议错误而失败。

![Wireshark 捕获](../Images/c3ee6db7bc54d020e5c9f56b19a0415b.png)

`HTTPWebRequest`客户端 ( ) 并没有完全关闭连接，这似乎很奇怪。

当代理未使用时（非端口 80 或内部流量），所有请求都按预期工作。当没有身份验证时，它也可以工作，因为它只发出单个请求。

我已经将问题代码减少到最低限度并使用 MSDN 示例对其进行了复制，但是有人知道这是已知问题还是我们（.NET 或 Squid）配置中的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T13:48:15.957

由于它只失败了第二次，会

```
request.KeepAlive = false; 
```

做出改变？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T12:45:09.870

我认为 NTLM 身份验证（NetworkCredential）不能与 SQUID 的透明代理功能同时工作。:-(

[http://www.squid-cache.org/mail-archive/squid-users/201110/0025.html](http://www.squid-cache.org/mail-archive/squid-users/201110/0025.html)

您可以尝试其他身份验证方案吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T16:10:34.447

尝试验证自己，与

```
request.Headers.Add("Authorization", "Basic " + Convert.ToBase64String(Encoding.ASCII.GetBytes(username + ":" + password)); 
```

之前`request.GetResponse();`

这对我有用。首先，我尝试自己放入整个字符串，但没有成功！

# ruby-on-rails-3 - Rails 3在循环内分配容器div

> ID：10984267
> 
> 赞同：1
> 
> 时间：2012-06-11T16:46:27.013
> 
> 标签：ruby-on-rails-3, loops, html

假设我正在遍历一系列产品，我将如何在该循环中分配一个容器 div。例如我想要这样的输出：

```
<div class="page">
  <p>product1</p>
  <p>product2</p>
  <p>product3</p>
  <p>product4</p>
</div>
<div class="page">
  <p>product5</p>
  <p>product6</p>
  <p>product7</p>
  <p>product8</p>
</div> 
```

我试过这样的事情：

```
<% @products.each_with_index do |product, index| %>
  <% if index%4 == 0 %>
    <div class="page">
  <%end%>
  <p><%= product.data %>
  <% if index%4 == 0 %>
    </div>>
  <%end%>
<% end %> 
```

但正如预期的那样，它只会用容器围绕每 4 个产品。我在想我需要两个循环才能使它工作，但是我怎样才能在不复制数据的情况下做到这一点？

**编辑**

当使用 each_with_index 的替代品时，有没有办法使用这种方法来跟踪索引？还有一些基于索引值设置的条件属性。

例如：

```
style=<%= index == 0 ? "top:5px;" : ""%> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:56:50.753

```
<% @products.each_slice(4) do |slice| %>
  <div class="page">
    <% slice.each do |product| %>
      <p><%= product.data %></p>
    <% end %>
  </div>
<% end %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:59:35.843

另一种方法：

```
<% while group = @products.take 4 %>
  <div class="page">

  <% group.each do |product| %>
    <p><%= product.data %></p>
  <% end %>

  </div>
<% end %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T16:51:56.740

```
<div class="page">

<% @products.each_with_index do |product, index| %>
    <p><% product.data %></p>

    <% if index % 4 == 3 %>
        </div><div class="page">
    <% end %>
<% end %>

</div> 
```

（编辑：忘记了我的结束标签！）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T16:58:56.430

Rails 将数组分成大小相等的组的方法是[`ary.in_groups_of(number)`](http://rails.rubyonrails.org/classes/ActiveSupport/CoreExtensions/Array/Grouping.html#M000833)

```
<% @products.in_groups_of(4, false) do |group| %>
  <div class="page">
    <% group.each do |product| %>
      <p><% product.data %></p>
    <% end %>
  </div>
<% end %> 
```

[Haml](http://haml.info/)更好:)

```
- @products.in_groups_of(4, false) do |group|
  .page
    - group.each do |product|
      %p= product.data 
```

您可以获得绝对产品索引`@products.index(product)`或组索引

```
<% @products.in_groups_of(4, false).each_with_index do |group, group_index| %> 
```

# c - 具有参数的宏与具有相同名称的变量的宏扩展

> ID：10984270
> 
> 赞同：5
> 
> 时间：2012-06-11T16:46:36.560
> 
> 标签：c, gcc, macros, c-preprocessor

考虑以下**C**程序（忽略双重副作用问题）：

```
#define max(a, b) (a>b?a:b)

int main(void){
    int max = max(5,6);
    return max;
} 
```

GCC 预处理器把它变成：

```
int main(void){
    int max = (5>6?5:6);
    return max;
} 
```

这非常好，因为您不必担心 和 之间的意外`max`碰撞`max()`。[GCC 手册](http://gcc.gnu.org/onlinedocs/cpp/Function_002dlike-Macros.html#Function_002dlike-Macros)说：

> 只有当它的名称后面带有一对括号时，才会展开类似函数的宏。如果你只写名字，它就会被单独留下

这是标准化的还是只是按惯例完成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:48:10.847

是的，这里的行为是明确定义的。

您的宏`max`是一个类似函数的宏（即，当您定义它时，它的名称后面紧跟一个左括号并接受参数）。

如果使用后跟左括号，则代码中`max`稍后的使用只是对该宏的调用。`max`因此，这些不会调用`max`宏：

```
int max;
max = 42; 
```

但是这些都会调用 max 宏：

```
max(1, 2)
max (1, 2)
max
(
    1, 2
)
max() 
```

（请注意，最后一行格式错误，因为参数的数量与参数的数量不匹配。不过，这仍然是宏调用，会导致编译错误。）

这种行为是由 C 语言标准规定的。C99 §6.10.3/10 指出，在定义了类似函数的宏之后，

> 类似函数的宏名称的每个后续实例后跟`(`作为下一个预处理标记的 a 引入了预处理标记的序列，该序列被定义中的替换列表替换（宏的调用）。

# lua - Lua - 重播按钮？

> ID：10984275
> 
> 赞同：0
> 
> 时间：2012-06-11T16:46:58.713
> 
> 标签：lua, coronasdk

我正在使用 Corona SDK 制作应用程序。在游戏中，您必须及时触摸所有球体，如果您获胜，则会出现您获胜的图像。我在“你赢了”的信息下做了一个重播按钮，但是我怎么说他重新开始整个游戏呢？

这是代码（不是全部）：

```
function winLose(condition)
if condition == "Win" then
    print ("Winner")
    winMSG = display.newImage("media/win.png")

    -- Replay button

    local btnReplay = ui.newButton{
    default = "media/buttonWhite.png",
    over = "media/buttonWhiteOver.png",
    onPress = btnReplayPress,
    onRelease = btnReplayRelease,
    text = "Replay",
    textColor = { 0, 0, 0, 255 },
    size = 26,
    id = "replay",
    emboss = true
    }

    btnReplay.x = _W/2; 
    btnReplay.y = _H/2 + 50;

elseif condition == "Fail" then

    print ("Loser")
    loseMSG = display.newImage("media/lose.png")

    -- Replay Button

    btnReplay = ui.newButton{
    default = "media/buttonWhite.png",
    over = "media/buttonWhiteOver.png",
    onPress = btnReplayPress,
    onRelease = btnReplayRelease,
    textColor = { 0, 0, 0, 255 },
    size = 26,
    text = "Replay"
    id = "replay",
    emboss = true
    }

    -----

    function btnReplay:touch(e)
        if e.phase == "began" then
            --
        elseif e.phase == "moved" then
            --
        elseif e.phase == "ended" then
            -- Here I should say what it has to do to replay
        end
    end

    -----

    btnReplay:addEventListener( "touch", btnReplay);

    -----

    btnReplay.x = _W/2; 
    btnReplay.y = _H/2 + 50;
end
end

local function trackOrbs(obj)
obj:removeSelf()
o = o-1;

if time_up ~= true then
    if (o == 0) then
        timer.cancel(gametmr);
        winLose("Win");
    end
end
end 

local function countDown (e)
if (time_remain == total_secs) then
    ready = true
end
time_remain = time_remain - 1;
countdowntxt.text = time_remain;

if time_remain == 0 then
    time_up = true

    if o ~= 0 then
        winLose("Fail");
        ready = false;
    end
end
end

local function spawnOrb()

local orb = display.newImageRect("media/orb.png", 60, 60);
orb:setReferencePoint(display.CenterReferencePoint);
orb.x = mRand(50, _W-50); orb.y = mRand (50, _H-50);

function orb:touch(e)
    if time_up ~= true then
        if (ready == true) then
            if (e.phase == "ended") then
                trackOrbs(self);
            end 
        end 
    end

    return true
end

o = o + 1;

orb:addEventListener("touch", orb);

if (o == total_orbs) then
    gametmr =   timer.performWithDelay(1000, countDown, total_secs) ;
else
    ready = false
end
 end

 tmr = timer.performWithDelay (20, spawnOrb, total_orbs); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T05:32:35.377

你可以有一个像这样的while循环

```
while true do 
    if mainGame then
        --game code
    elseif done then
        --buttons
        if button.restart then
            mainGame = true
        end
    end
 end 
```

# html - iframe 外的 html 页面必须调用父页面

> ID：10984276
> 
> 赞同：0
> 
> 时间：2012-06-11T16:47:05.513
> 
> 标签：html, url, iframe, parent

好吧，显然我的问题还没有答案。我用 iframe 做了一个网站。在这个 iframe 中，我显示了由菜单按钮激活的页面。这些页面也被搜索引擎找到。但是没有网站，这些页面是“赤裸裸的”。我想要以下。如果找到了“裸”页面，则自动调用父页面来修饰“裸”页面。所以整个网站都是可见的，而不是“裸”页面。与我一起思考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:41:42.663

您需要检测是否直接调用“iframed”子页面，如果是这种情况 - 重定向到父页面。以下是如何在此类子页面中执行此操作的基本示例：

```
<html>
<head>
    <title></title>

    <script type="text/javascript">

        function checkIfInIframe() {
            if (window == window.parent) location.href = 'Parent.html';
        }

    </script>

</head>
<body onload="checkIfInIframe();">

    <!--Child Content-->

</body>
</html> 
```

这里我们在页面主体“onload”事件中调用 JavaScript 函数“checkIfInIframe”。代码检查页面是否在顶层（不应该在的地方）。它通过将“窗口”对象与其父对象进行比较来做到这一点，如果它是同一个对象 - 页面将重定向到它的父对象。您甚至可以在该重定向中的查询字符串中传递参数，以便父级自动知道要在 Iframe 中打开哪个页面

# cocoa-touch - 将 UIView 添加到 UITabBarItem

> ID：10984280
> 
> 赞同：0
> 
> 时间：2012-06-11T16:47:19.927
> 
> 标签：cocoa-touch, uitabbarcontroller

我想在我的 TabBarController 中的 UITabBarItem 中添加一个小红点，以指示触发了某个条件（在这种情况下，内容被过滤），就像 Dock 中的 Mail little number 指示您有多少未读邮件一样。

似乎这不能通过查看文档来完成。所以也许还有另一种方法可以用来完成这项工作。

由于 TabBar 始终锁定在屏幕底部，我只能在顶部覆盖另一个视图，但我愿意知道是否有更智能的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:03:56.827

使用 UITabBarItem 的 badgeValue 属性。在这里阅读：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UITabBarItem_Class/Reference/Reference.html#//apple_ref/occ/instp/UITabBarItem/badgeValue](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITabBarItem_Class/Reference/Reference.html#//apple_ref/occ/instp/UITabBarItem/badgeValue)

# java - NPE使用二维对象数组java

> ID：10984282
> 
> 赞同：0
> 
> 时间：2012-06-11T16:47:37.877
> 
> 标签：java, nullpointerexception

我在这段代码中得到了一个 NPE。我试图初始化每个索引，但似乎也不起作用。你能指出什么是错的吗？谢谢！

```
 package com.js.teachEnglish;

import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.BufferedReader;
import java.io.FileReader;

import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;

public class Piggy_Panel extends JPanel {

    /**
     * 
     */
    private static final long serialVersionUID = 1L;

    int number_lines = getLines(Helper.piggybackResource.getPath());

    protected JLabel title_Label = new JLabel("Piggyback words");

    protected ImageIcon button_image = new ImageIcon(Helper.soundIconResource);

    protected JButton title_Button = new JButton(button_image);

    protected JPanel titlePanel = new JPanel();

    protected JScrollPane pane = new JScrollPane(this);

    protected JLabel[] label_group = new JLabel[number_lines];
    protected JButton[] button_group = new JButton[number_lines];

    protected String[] information = new String[number_lines];

    // Table information
    protected String[] col_titles = new String[] {"",""};
    protected Object[][] table_contents = new Object[number_lines][];

    protected JTable table;

    // constructor
    public Piggy_Panel() {
        setLayout(new GridLayout(number_lines+1,1));

        // scroll pane
        pane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS);
        pane.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);

        // getting the information
        readInformation();

        /*
         * adding the title seperately
         * and also adding characteristics for the label
         *  */

        titlePanel = new JPanel();
        titlePanel.setLayout(new FlowLayout());

        // adding the characteristics for the label
        title_Label.setFont(new Font("Arial",Font.PLAIN,36));

        titlePanel.add(title_Label);
        titlePanel.add(title_Button);

        add(titlePanel);

        // calling the ini_labels_buttons() to initlialise the buttons and labels
        ini_labels_buttons();

        // fill the object[][] in
        fill_table();

        // initialising table and adding specific characteristics
        table = new JTable(table_contents, col_titles);
        table.setFillsViewportHeight(true);
        table.setShowHorizontalLines(false);
        table.setShowVerticalLines(false);

        add(table);

        // calling the ini_panel_group() to add everything

        title_Button.addActionListener(new buttonListener());

    }

    // will read the information from the file
    public String[] readInformation() {
        try {
            String line = null;

            BufferedReader br = new BufferedReader(new FileReader(Helper.piggybackResource.getPath()));

            int i = 0;

            while((line = br.readLine()) != null) {
                information[i] = line;
                i++;
            }

            return information;

        }catch(Exception ex) {
            ex.printStackTrace();
        }

        return null;

    }

    // will put out the sound
    // This will output the sound if a button is clicked
    class buttonListener implements ActionListener {
        public void actionPerformed(ActionEvent e) {
            JButton button = (JButton) e.getSource();

            String sayDynamicPath = Helper.sayDynamicResource.getPath() + " ";

            if(button.equals(title_Button)) {
                try {
                    Runtime.getRuntime().exec(sayDynamicPath +
                            title_Label.getText());
                }catch(Exception ex) {
                    JOptionPane.showMessageDialog(null,""+ex,"Unable to produce sound",
                            JOptionPane.ERROR_MESSAGE);
                    ex.printStackTrace();
                }
            }
        }
    }

    // Initialising the JLabels and JButtons and also adding the relevant functions
    // these include icons and information
    public void ini_labels_buttons() {

        // initialising the buttons first
        for (int i = 0; i < button_group.length; i++) {
            button_group[i] = new JButton(button_image);
        }

        // initialising the labels
        for (int i = 0; i < label_group.length; i++) {
            label_group[i] = new JLabel(information[i]);
        }

    }

    public void fill_table() {
        // fill in the first col
        for (int i = 0; i < table_contents.length; i++) {
            table_contents[i][0] = information[i]; // null pointer here
        }

        // fill in the second the col
        for(int j = 0;j < table_contents.length;j++) {
            table_contents[j][1] = button_group[j];
        }
    }

    // this method will get the number of lines and then send it back
    // to the label group
    public int getLines(String path) {
        int n = 0;

        try {
            BufferedReader br = new BufferedReader(new FileReader(path));

            @SuppressWarnings("unused")
            String line = "";

            while((line = br.readLine()) != null) {
                n++;
            }

        }catch(Exception e) {
            e.printStackTrace();
        }

        return n;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:53:12.220

查看 NPE 的堆栈跟踪会很有用。;)

这会创建一个对数组的引用数组，而不是数组的数组。

```
protected Object[][] table_contents = new Object[number_lines][]; 
```

这意味着

```
table_contents[i][0] = information[i]; 
```

应该抛出一个 NPE，因为 table_contents[i] 将是`null`. 查看调试器将确认这一点。

最简单的解决方案是创建一个或多个数组

```
protected Object[][] table_contents = new Object[number_lines][2]; 
```

顺便说一句，我会使用一个循环而不是两个。

# hyperlink - 跨子报表的 jasper 报表中的超链接

> ID：10984283
> 
> 赞同：3
> 
> 时间：2012-06-11T16:47:39.927
> 
> 标签：hyperlink, jasper-reports, ireport, subreport

我想在我的报告中添加超链接。一个报告中设置的超链接应该将我带到另一个子报告。你能告诉我这是否可行。如果可以，请提供一步一步的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:29:13.467

首先，是的，这是可行的。

其次，这是您的分步说明：

1.  右键单击要链接的元素，然后选择超链接。
2.  选择超链接目标：空白
3.  选择超链接类型：参考
4.  在参考选项卡中，键入 URL 以调用子报告（带参数）。例如，在我的一份报告中，我调用 ReportController servlet 来创建子报告，如下所示： "./ReportController?reportName=ValidationDetailsChart&reportTitle=Validation%20Details&nParms=3&parmName_1=ORD_NUMBER&parmValue_1=" + $F{ORDER_NUMBER} + "&parmName_2=START_TIME_MS&parmValue_2 =&parmName_3=END_TIME_MS&parmValue_3="
5.  在“工具提示”选项卡中添加工具提示（可选）。请注意，您可以在工具提示中引用变量和参数值。

请注意，还有其他方法可以做到这一点，如果您不使用 java 和 servlet 生成报告，您的方法可能会有所不同。我建议查看 ireport 文档以获取更多说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T10:35:46.080

我得到了我的问题的解决方案。我没有要求必须将任何值从一个子报表传递到另一个子报表。所以我只需右键单击我想要链接的文本字段。我将超链接目标设置为“Self”，将超链接类型设置为“LocalPage”，并在超链接页面表达式中设置以下表达式：Integer.valueOf(i)，其中 i 是页码（在我的情况下是工作表编号），其中我想要超链接带我。如果您愿意，还可以使用以下属性：Integer.valueOf($V{REPORT_COUNT})。

感谢大家的回复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-12T11:46:06.327

对于我使用超链接和锚点实现的报告中的导航

下面是带有 hyperlinkAnchorExpression 的文本字段，这将是链接。注意 hyperlinkType="LocalAnchor"

```
<textField isStretchWithOverflow="true" hyperlinkType="LocalAnchor">
            <reportElement positionType="Float" stretchType="RelativeToTallestObject" x="80" y="0" width="80" height="20" forecolor="#3286C7" uuid="9a8313d2-21f3-4cd2-8e40-f9cddeb3cdaf"/>
            <box topPadding="3" leftPadding="3">
                <topPen lineWidth="0.2"/>
                <leftPen lineWidth="0.2"/>
                <bottomPen lineWidth="0.2"/>
                <rightPen lineWidth="0.2"/>
            </box>
            <textElement>
                <font isUnderline="true"/>
            </textElement>
            <textFieldExpression><![CDATA[$F{cAddress}.getId()]]></textFieldExpression>
            <hyperlinkAnchorExpression><![CDATA[$F{cAddress}.getId().toString()]]></hyperlinkAnchorExpression>
        </textField> 
```

下面是anchornameexpression，当单击超链接并且值与报告中任何位置的hyperlinkAnchorExpression 值匹配时，将调用它。

```
</textField>
        <textField isStretchWithOverflow="true">
            <reportElement positionType="Float" stretchType="RelativeToTallestObject" x="80" y="0" width="80" height="20" uuid="9a8313d2-21f3-4cd2-8e40-f9cddeb3cdaf"/>
            <box topPadding="3" leftPadding="3">
                <topPen lineWidth="0.2"/>
                <leftPen lineWidth="0.2"/>
                <bottomPen lineWidth="0.2"/>
                <rightPen lineWidth="0.2"/>
            </box>
            <textFieldExpression><![CDATA[$F{id}]]></textFieldExpression>
            <anchorNameExpression><![CDATA[$F{id}.toString()]]></anchorNameExpression>
        </textField> 
```

我已经实现了这一点来浏览报表和子报表。希望这会有所帮助。

# iphone - 缺少 Xcode 的 OpenGLES.framework

> ID：10984285
> 
> 赞同：3
> 
> 时间：2012-06-11T16:47:43.600
> 
> 标签：iphone, xcode, opengl-es

尽管这听起来很愚蠢，但我在现有框架列表中找不到 OpenGLES.framework。有没有办法恢复框架？重新安装 Xcode 会取代 OpenGLES 吗？我在谷歌上下搜索无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:39:34.693

如果您重新安装 iPhone SDK，它应该重新安装框架。

# c - WM_SIZE 没有按预期工作

> ID：10984289
> 
> 赞同：2
> 
> 时间：2012-06-11T16:48:00.270
> 
> 标签：c, winapi, window

我有一个问题`WM_SIZE`。我想用`PeekMessage`(not `WndProc`) 来捕捉它。`PeekMessage`从不接收`WM_SIZE`，所以我将额外的用户消息发布到窗口以`PeekMessage`像这样捕获它（代码来自`WnProc`）：

```
case WM_SIZE:
  PostMessageW(hwnd, WM_USER + 1, wParam, lParam);
  break; 
```

问题是我仅在窗口最大化或恢复时才收到`WM_USER + 1`使用。`PeekMessage`当窗口被厚框调整大小时没有消息（我收到`WM_SIZE`了`WndProc`）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T17:31:36.797

PeekMessage() 只能看到发布到消息队列的消息。不包括 WM_SIZE，它是发送的，而不是发布的。或者换句话说，它是由SendMessage()传递的，它直接调用窗口过程，绕过消息队列。所以是的，您的代码开始工作，因为您现在使用 PostMessage 重新发布消息，它被放在消息队列中，因此 PeekMessage 可以看到它。

当用户调整窗口大小时，会发生一些不同的事情。这是由*另*一条消息报告的：WM_SIZING。当 Windows 启动模式消息循环以实现调整大小操作时，它会以相当高的速率生成。它给出了适当的通知，当模态循环开始时（用户单击窗口角），您将获得 WM_ENTERSIZEMOVE，完成时（用户释放按钮）获得 WM_EXITSIZEMOVE。您将收到一堆 WM_SIZING 消息，发送到您的窗口过程。未发布。和一个 WM_SIZE 给出最终大小。*看不到*这些消息的这些反映版本的一种方法是在您自己的消息循环中调用 PeekMessage()。当 Windows 模式调整大小循环处于活动状态时，它不会被调用。

很难给出更好的建议，真的不清楚你为什么要这样做。“医生，很痛，那就不要这样做”的医学回答很可能是相关的。我怀疑您可能也想反映 WM_SIZING 消息。最大的问题是，当您从队列中检索这些消息时，窗口大小已经发生了变化，并且通知已经过时了。这就是为什么发送消息而不是发布消息的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:13:26.963

我相信这是适用的：

> [PeekMessage 没有收到消息？](https://stackoverflow.com/questions/6222635/peekmessage-not-getting-the-message)
> 
> 您需要将类指针传递给调用 CreateWindowEx 的最后一个参数，然后从 WM_CREATE 的 LPARAM 中传递给您的 LPCREATESTRUCT 中检索该指针，您的类指针将位于结构的 lpCreateParmas 字段中。将您的类指针设置为窗口的 GWLP_USERDATA，并在任何其他消息调用上调用 GetWindowsLong ，检索您的类指针，然后将消息、wparam 和 lparam 全部传递给您的内部类消息处理程序。
> 
> [http://msdn.microsoft.com/en-us/library/ff381400%28v=VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ff381400%28v=VS.85%29.aspx)

# video - 在 Google Analytics 上更轻松地跟踪 YouTube 视频

> ID：10984291
> 
> 赞同：-2
> 
> 时间：2012-06-11T16:48:04.990
> 
> 标签：video, youtube, google-analytics

有没有更简单的方法可以通过 Google Analytics 跟踪 YouTube 视频流量？在整个网站上部署多个视频似乎是一项乏味的任务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-11T07:29:11.737

您可以使用以下代码来跟踪视频。

```
<script>
  // This code loads the IFrame Player API code asynchronously.
  var tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  //  This function creates an <iframe> (and YouTube player)
  //    after the API code downloads.
  var player;
  function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
      height: '289',
      width: '428',
      videoId: 'VIDEO ID',
      events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange
      }
    });
  }
  //  The API will call this function when the video player is ready. Uncomment the below code to start video when ready
  function onPlayerReady(event) {
    // event.target.playVideo();
    }
  function onPlayerStateChange(event) {
    var lastAction="";
      switch (event.data){
        case YT.PlayerState.PLAYING:
        if (lastAction != 'paused'){
            _gaq.push(['_trackEvent','video', 'Playing', getPercentage()]);
        }
        else{
            lastAction = '';
           }
        break;
        case YT.PlayerState.ENDED:
          _gaq.push(['_trackEvent','video', 'Completed',getPercentage()]);
        break;
        case YT.PlayerState.PAUSED:
         if (lastAction != 'paused'){
            _gaq.push(['_trackEvent','video', 'Paused', getPercentage()]);
            lastAction= "paused";
           }
        break;
        }
    }
    function getPercentage()
    {
    var pecentage =((player.getCurrentTime()/player.getDuration())*100).toFixed();
      if(pecentage > 0 && pecentage <= 25){
       return "0-25%";}
      else if(pecentage > 25 && pecentage <= 50){
       return "25-50%";}
      else if(pecentage > 50 && pecentage <= 75){
       return "50-75%";}
      else if(pecentage > 75){
       return "75-100%";}
    }
    function stopVideo() {
     _gaq.push(['_trackEvent','video', 'Stopped', player.getDuration()]);
      player.stopVideo();
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T13:11:06.903

YouTube 有一个公共分析 API，您可以使用它来检查您的视频的使用情况。

[http://developers.google.com/youtube/analytics](http://developers.google.com/youtube/analytics)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-29T22:26:28.647

如果您可以选择在 Youtube 之外托管视频，那绝对是更好的选择。例如，[http:](http://wistia.com/) //wistia.com/ 在视频前后为您的用户提供了显着改进的分析和更清晰、更可控的体验。

# web-services - WSDL 客户端生成未完成？

> ID：10984301
> 
> 赞同：5
> 
> 时间：2012-06-11T16:48:41.113
> 
> 标签：web-services, wsdl, tibco, xfire

刚刚尝试从 WSDL 文件生成 java 客户端生成（使用 XFire 和 XMLBeans 绑定）

我能够生成客户端+故障消息（没有错误），但是没有生成输入消息和输出消息，它也没有在客户端生成操作。我的 WSDL 文件有什么问题吗，还是有什么我想念的？

更新 ：

1.  我[在这里](https://www.dropbox.com/sh/chiq6oi5uk91i66/X-OQtVnL91)更新了我的测试 XFire 项目。

2.  我开始怀疑问题可以被隔离到 WSDL（因为我可以成功生成其他 WSDL）。我发现了这些警告，我觉得这些警告是相关的：

    > WS-I：(BP2402) wsdl:binding 元素不使用“3 SOAP 绑定”部分中定义的soapbind:binding 元素。WSDL 1.1 规范。
    > 
    > WS-I：（BP2032）有缺陷的soapbind:fault 元素：“name”属性值与父元素wsdl:fault 上的“name”属性值不匹配。
    > 
    > WS-I：（AP2901）描述既不使用 WSDL 1.1 第 5 节中描述的 WSDL MIME 绑定，也没有使用 WSDL 1.1 第 3 节中描述的 WSDL SOAP 绑定，用于 wsdl:binding 的每个 wsdl:input 或 wsdl:output 元素.

3.  刚刚发现soap12可能会导致问题。如果我将 xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap12/" 更改为 xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" 并删除soap中的soapActionRequired :operation 可以成功生成客户端。但是webservice目前只在soap1.2中才有。所以这里不是将wsdl改成使用soap1.1。

这是我的 WSDL 文件：

```
<!--Created by TIBCO WSDL-->
<wsdl:definitions xmlns:tns="http://schemas.ocbc.com/soa/WSDL/service/CBS-CustAccountInfo-I" xmlns:soap1="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:jndi="http://www.tibco.com/namespaces/ws/2004/soap/apis/jndi" xmlns:ns="http://schemas.ocbc.com/soa/emf/common/envelope/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:jms="http://www.tibco.com/namespaces/ws/2004/soap/binding/JMS" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" name="Untitled" targetNamespace="http://schemas.ocbc.com/soa/WSDL/service/CBS-CustAccountInfo-I">

<wsdl:types>
    <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="http://schemas.ocbc.com/soa/emf/common/envelope/" elementFormDefault="qualified" attributeFormDefault="unqualified">
        <xs:include schemaLocation="../Schemas/XML/CBS-CustAccountInfo-I-ServiceEnvelope.xsd"/>
    </xs:schema>
</wsdl:types>
<wsdl:service name="CBS-CustAccountInfo-I">
    <wsdl:port name="CBS-CustAccountInfo-I_HTTP" binding="tns:CBS-CustAccountInfo-I_HTTPBinding">
        <soap:address location="https://localhost:15038/Services/CBS-CustAccountInfo-I/Processes/MainRequestResponse_HTTP"/>
    </wsdl:port>
</wsdl:service>
<wsdl:portType name="PortType">
    <wsdl:operation name="CBS-CustAccountInfo-I">
        <wsdl:input message="tns:InputMessage"/>
        <wsdl:output message="tns:OutputMessage"/>
        <wsdl:fault name="fault1" message="tns:FaultMessage"/>
    </wsdl:operation>
</wsdl:portType>
<wsdl:binding name="CBS-CustAccountInfo-I_HTTPBinding" type="tns:PortType">
    <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsdl:operation name="CBS-CustAccountInfo-I">
        <soap:operation style="document" soapAction="/Services/CBS-CustAccountInfo-I/Processes/MainRequestResponse_HTTP" soapActionRequired="true"/>
        <wsdl:input>
            <soap:body use="literal" parts="InputMessage"/>
        </wsdl:input>
        <wsdl:output>
            <soap:body use="literal" parts="OutputMessage"/>
        </wsdl:output>
        <wsdl:fault name="fault1">
            <soap:fault use="literal" name="fault1"/>
        </wsdl:fault>
    </wsdl:operation>
</wsdl:binding>
<wsdl:message name="InputMessage">
    <wsdl:part name="InputMessage" element="ns:ServiceEnvelope"/>
</wsdl:message>
<wsdl:message name="OutputMessage">
    <wsdl:part name="OutputMessage" element="ns:ServiceEnvelope"/>
</wsdl:message>
<wsdl:message name="FaultMessage">
    <wsdl:part name="FaultMessage" element="ns:ServiceEnvelope"/>
</wsdl:message>
</wsdl:definitions> 
```

这是我要生成的蚂蚁任务：

```
<!-- Generating XML Beans -->   
<target name="gen-xmlbeans">
<java classname="org.apache.xmlbeans.impl.tool.SchemaCompiler"
          classpathref="build.classpath"
          fork="true">
      <arg value="-out"/>
      <arg value="${basedir}/lib/ocbc.jar"/>
      <arg value="${schema.path}"/>
</java>
</target>

<!-- Generating Client -->
<target name="ws-generate">
        <taskdef name="wsgen" classname="org.codehaus.xfire.gen.WsGenTask">
            <classpath>
                <fileset dir="${lib.dir}" includes="*.jar" />
            </classpath>    
        </taskdef>    
        <wsgen outputDirectory="${basedir}/src/" wsdl="${wsdl.path}" package="test.client" overwrite="true" binding="xmlbeans"/>                
</target> 
```

生成的客户端：

```
public class CBS_CustAccountInfo_IClient {

private static XFireProxyFactory proxyFactory = new XFireProxyFactory();
private HashMap endpoints = new HashMap();

public CBS_CustAccountInfo_IClient() {
}

public Object getEndpoint(Endpoint endpoint) {
    try {
        return proxyFactory.create((endpoint).getBinding(), (endpoint).getUrl());
    } catch (MalformedURLException e) {
        throw new XFireRuntimeException("Invalid URL", e);
    }
}

public Object getEndpoint(QName name) {
    Endpoint endpoint = ((Endpoint) endpoints.get((name)));
    if ((endpoint) == null) {
        throw new IllegalStateException("No such endpoint!");
    }
    return getEndpoint((endpoint));
}

public Collection getEndpoints() {
    return endpoints.values();
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T09:40:30.070

@Rudy如果您必须使用XFire，您可能会考虑尝试其他绑定，例如JAXB绑定，看看您是否能够正确生成代码。

# parameters - 向网站传递参数

> ID：10984304
> 
> 赞同：3
> 
> 时间：2012-06-11T16:48:53.837
> 
> 标签：parameters

好吧，我对这个话题完全陌生；我什至不知道这种操作的一般名称，但我会尝试解释一下。（这可能是非常基本的东西）

我正在尝试编写一个自动填写表单的应用程序。为了有一个界面计划在 VisualStudio 上使用 GUI。

它只是一些类似于网站注册表单的文本框和一个用于初始化操作的注册按钮。

用户在这些文本框中输入的信息将被发送到预定网站注册页面上的类似文本框。然后，当我单击应用程序上的注册按钮时，它也会单击网页上的注册按钮。

这就是我想要做的。我该如何开始？我应该阅读哪些主题？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-11T16:56:59.693

将参数传递给网站的主要方式称为“查询字符串参数”。

这个概念是可以通过 url 将变量发送到网页中。

格式附加在您的网页之后：

http...yoursite.com/yourpage.html?x='value'

所以QueryString 是一个变量x，其值为'value'。

> ?x='值'

此时，JavaScript 可以使用 x 的变量。

这是描述设置和使用的[链接。](http://instruct.tri-c.edu/rrichmond/html/querystring.htm)谷歌上还有其他可能更具体到您的环境。

希望能帮助到你。一切顺利！纳什

# python - OpenCV 2.4.1 - 在 Python 中计算 SURF 描述符

> ID：10984313
> 
> 赞同：19
> 
> 时间：2012-06-11T16:49:24.060
> 
> 标签：python, opencv, computer-vision

我正在尝试更新我的代码以使用`cv2.SURF()`而不是`cv2.FeatureDetector_create("SURF")`and `cv2.DescriptorExtractor_create("SURF")`。但是，在检测到关键点后，我无法获取描述符。正确的调用方式是`SURF.detect`什么？

我尝试遵循 OpenCV 文档，但我有点困惑。这就是它在文档中所说的。

```
Python: cv2.SURF.detect(img, mask) → keypoints¶
Python: cv2.SURF.detect(img, mask[, descriptors[, useProvidedKeypoints]]) → keypoints, descriptors 
```

第二次调用时如何传递关键点`SURF.detect`？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-11T20:23:31.723

我不确定我是否正确理解了您的问题。但是如果你正在寻找匹配 SURF 关键点的样本，下面是一个非常简单和基本的样本，它类似于模板匹配：

```
import cv2
import numpy as np

# Load the images
img =cv2.imread('messi4.jpg')

# Convert them to grayscale
imgg =cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)

# SURF extraction
surf = cv2.SURF()
kp, descritors = surf.detect(imgg,None,useProvidedKeypoints = False)

# Setting up samples and responses for kNN
samples = np.array(descritors)
responses = np.arange(len(kp),dtype = np.float32)

# kNN training
knn = cv2.KNearest()
knn.train(samples,responses)

# Now loading a template image and searching for similar keypoints
template = cv2.imread('template.jpg')
templateg= cv2.cvtColor(template,cv2.COLOR_BGR2GRAY)
keys,desc = surf.detect(templateg,None,useProvidedKeypoints = False)

for h,des in enumerate(desc):
    des = np.array(des,np.float32).reshape((1,128))
    retval, results, neigh_resp, dists = knn.find_nearest(des,1)
    res,dist =  int(results[0][0]),dists[0][0]

    if dist<0.1: # draw matched keypoints in red color
        color = (0,0,255)
    else:  # draw unmatched in blue color
        print dist
        color = (255,0,0)

    #Draw matched key points on original image
    x,y = kp[res].pt
    center = (int(x),int(y))
    cv2.circle(img,center,2,color,-1)

    #Draw matched key points on template image
    x,y = keys[h].pt
    center = (int(x),int(y))
    cv2.circle(template,center,2,color,-1)

cv2.imshow('img',img)
cv2.imshow('tm',template)
cv2.waitKey(0)
cv2.destroyAllWindows() 
```

以下是我得到的结果（使用油漆将粘贴的模板图像复制到原始图像上）：

![在此处输入图像描述](../Images/b2919744ce377750f3681b032ee8a384.png)

![在此处输入图像描述](../Images/1c2b4c1b1e2148cd4eda883188a20892.png)

如您所见，**有一些小错误**。但对于一家初创公司来说，希望它是好的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-01T21:56:05.117

上述算法的一个改进是：

```
import cv2
import numpy

opencv_haystack =cv2.imread('haystack.jpg')
opencv_needle =cv2.imread('needle.jpg')

ngrey = cv2.cvtColor(opencv_needle, cv2.COLOR_BGR2GRAY)
hgrey = cv2.cvtColor(opencv_haystack, cv2.COLOR_BGR2GRAY)

# build feature detector and descriptor extractor
hessian_threshold = 85
detector = cv2.SURF(hessian_threshold)
(hkeypoints, hdescriptors) = detector.detect(hgrey, None, useProvidedKeypoints = False)
(nkeypoints, ndescriptors) = detector.detect(ngrey, None, useProvidedKeypoints = False)

# extract vectors of size 64 from raw descriptors numpy arrays
rowsize = len(hdescriptors) / len(hkeypoints)
if rowsize > 1:
    hrows = numpy.array(hdescriptors, dtype = numpy.float32).reshape((-1, rowsize))
    nrows = numpy.array(ndescriptors, dtype = numpy.float32).reshape((-1, rowsize))
    #print hrows.shape, nrows.shape
else:
    hrows = numpy.array(hdescriptors, dtype = numpy.float32)
    nrows = numpy.array(ndescriptors, dtype = numpy.float32)
    rowsize = len(hrows[0])

# kNN training - learn mapping from hrow to hkeypoints index
samples = hrows
responses = numpy.arange(len(hkeypoints), dtype = numpy.float32)
#print len(samples), len(responses)
knn = cv2.KNearest()
knn.train(samples,responses)

# retrieve index and value through enumeration
for i, descriptor in enumerate(nrows):
    descriptor = numpy.array(descriptor, dtype = numpy.float32).reshape((1, rowsize))
    #print i, descriptor.shape, samples[0].shape
    retval, results, neigh_resp, dists = knn.find_nearest(descriptor, 1)
    res, dist =  int(results[0][0]), dists[0][0]
    #print res, dist

    if dist < 0.1:
        # draw matched keypoints in red color
        color = (0, 0, 255)
    else:
        # draw unmatched in blue color
        color = (255, 0, 0)
    # draw matched key points on haystack image
    x,y = hkeypoints[res].pt
    center = (int(x),int(y))
    cv2.circle(opencv_haystack,center,2,color,-1)
    # draw matched key points on needle image
    x,y = nkeypoints[i].pt
    center = (int(x),int(y))
    cv2.circle(opencv_needle,center,2,color,-1)

cv2.imshow('haystack',opencv_haystack)
cv2.imshow('needle',opencv_needle)
cv2.waitKey(0)
cv2.destroyAllWindows() 
```

您可以取消注释打印语句以更好地了解所使用的数据结构。

# svg - SVG：用孔填充图案

> ID：10984315
> 
> 赞同：1
> 
> 时间：2012-06-11T16:49:28.657
> 
> 标签：svg

在 SVG 中，我想使用填充图案，但在绘制其他形状的图案中留下“孔”，例如这个[例子](http://www.freeimagehosting.net/s6xyt "例子")（不是用 SVG 绘制的）。我想我应该使用剪辑和/或蒙版，但我不知道如何。

整个 SVG 将叠加在需要通过“孔”（以及通过背景图案）可见的图像上。所以我不能通过用纯色填充孔来掩盖图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:15:55.630

您可以通过使用奇偶填充来在不使用剪切的情况下执行此操作，或者您可以使用剪切路径[，这两种方法都在此处描述](http://www.w3.org/Graphics/SVG/IG/resources/svgprimer.html#masks_clips)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T21:30:36.580

您应该使用“复合路径”。请参阅[this](http://jsfiddle.net/h5NMP/) fiddle以获得一个非常简单的示例。

![在此处输入图像描述](../Images/6a3a49c18ad8cb3677321cda7d90cb5b.png)

当你有图案时，应用到图像上的叠加层。

Robert Longson 在回答中引用的参考资料确实值得一读。

# php - 如何在mysql中更新用户总分

> ID：10984317
> 
> 赞同：0
> 
> 时间：2012-06-11T16:49:38.103
> 
> 标签：php, mysql, points

我有一个网站，用户可以在其中提交可以被赞成或反对的帖子。

目前，用户从他的所有帖子中获得的总积分没有保存。

最好/常见的方法是什么？像 Reddit 或 StackOverflow 这样的网站是如何做到的？

每次有人对帖子投票时，我是否应该从总用户积分中添加和减去？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:53:27.120

你应该每次都更新这个.. 使用 ajax 以获得更好的用户体验.. 这是一个基本教程[http://www.w3schools.com/php/php_ajax_poll.asp](http://www.w3schools.com/php/php_ajax_poll.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:59:59.377

它可以通过多种方式完成 一个是由 Habeeb 说的 但是如果你想存储每个像 stackoverflow 一样赞成的信息然后制作两个表来存储帖子的 id 另一个来存储支持帖子的用户我的意思是你的两个表应该是

```
POST                                      Upvote
Id     POST                              Id      User_id 
```

1.  现在，当有人投票时，只需将一条新记录添加到表 Upvote 中，引用表 POST 的 id。
2.  检索数据时，您将需要 sql 的 Left Join Method

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:00:47.007

您可以缓存每个用户对所有帖子的投票总和的结果，并在用户获得新投票时使每个用户的缓存无效，或者您可以将总计数存储在数据库中并确保任何赞成或反对票运行作为也更新总数的事务。

无论您是使用缓存还是在 MySQL 中使用额外的表（我不建议将其放在您的`users`表中）来执行此操作，都取决于您的站点有多大以及您想对选票做什么。

# c# - 在 asp.net 应用程序中使用 requestPathInvalidChars

> ID：10984318
> 
> 赞同：0
> 
> 时间：2012-06-11T16:49:38.803
> 
> 标签：c#, web-config

我想允许我网站上的一个页面允许 & 和 . 我网站上的字符。我发现这可以通过将 requestPathInvalidChars 放入您的 webconfig 中来实现。在网上环顾四周，我没有找到任何关于如何做到这一点的好例子。如何在我的网站上允许那些指定的字符？感谢您的任何回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:07:18.007

我相信您只是将其设置为空白：

```
<system.web>
    <httpRuntime requestPathInvalidCharacters="" />
</system.web> 
```

但我也敦促您阅读[Scott](http://www.hanselman.com/blog/ExperimentsInWackinessAllowingPercentsAnglebracketsAndOtherNaughtyThingsInTheASPNETIISRequestURL.aspx)关于此的文章。

# css - CSS粗体不起作用

> ID：10984321
> 
> 赞同：7
> 
> 时间：2012-06-11T16:49:58.040
> 
> 标签：css

对于下面的代码，粗体不起作用。如果我注释掉，`font:inherit;`那么它会按预期工作。

我不明白为什么会这样。我认为`<p>`会继承`<body>`并且粗体会起作用。我在 Firefox、IE、Safari 和 Opera 中看到了完全相同的东西。

我错过了什么？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href='http://fonts.googleapis.com/css?family=Droid+Sans:400,700,bold' rel='stylesheet' type='text/css' />

        <style type="text/css">
            html, body, div, span, applet, object, iframe,
            h1, h2, h3, h4, h5, h6, p, blockquote, pre,
            a, abbr, acronym, address, big, cite, code,
            del, dfn, em, img, ins, kbd, q, s, samp,
            small, strike, strong, sub, sup, tt, var,
            b, u, i, center,
            dl, dt, dd, ol, ul, li,
            fieldset, form, label, legend,
            table, caption, tbody, tfoot, thead, tr, th, td,
            article, aside, canvas, details, embed, 
            figure, figcaption, footer, header, hgroup, 
            menu, nav, output, ruby, section, summary,
            time, mark, audio, video{
                    font:inherit;
            }

            body{
                font-family:'Droid Sans', sans-serif,Arial,Helvetica,'Trebuchet MS';
                font-size:14px;
            }
        </style>

    </head>

    <body>
        <p>this is a normal paragraph</p>
        <p><strong>this is bolded</strong></p>
    </body>

</html> 
```

编辑：'不工作'我的意思是粗体字体没有出现。html有2个段落。第一个par是正常的，第二个是粗体的。当我使用继承时，两条线的字体粗细相同。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-11T16:53:23.390

你的 strong 元素是从你的 p 元素继承的，它是从 body 元素继承的。由于默认字体粗细是正常的，所以一切都得到应用。添加规则`strong {font-weight:bold;}`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-11T16:52:38.740

根据`font:inherit;`，`P`继承`font-weight: normal`自`BODY`，并`STRONG`继承自`P`。这是正确的。

如果您不想重置`font`for `STRONG`，则将其从之前的选择器列表中删除`{font: inherit;}`。

# c# - 将 Silverlight 3.0 控件添加到现有 ASP.NET 项目时遇到问题

> ID：10984322
> 
> 赞同：0
> 
> 时间：2012-06-11T16:50:19.757
> 
> 标签：c#, asp.net, silverlight, silverlight-3.0

所以我准备将我的 Silverlight 控件添加到我现有的 ASP.NET Web 应用程序中。我发现很难理解我从 Google 中找到的一些东西。（这是由于我对 SL 和 MS 删除 SL ASP 标签的经验不足。）

如果有人对我如何让事情顺利进行有任何简单、明确的说明，请提供帮助。谢谢你。

更新：所以我已经部分工作了。我向用户控件 ascx 添加了必要的代码，但由于某种原因它没有出现在页面上。（虽然它在测试页面上工作并且当我将它直接添加到页面时工作。）

此外，由于某种原因，它只有在鼠标悬停在它上面时才会出现......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:43:11.717

> 此外，由于某种原因，它只会在鼠标悬停在它上面时出现

检查以确保在 maxwidth 或 minwidth 中没有零值（设计表面的默认值）。

# jquery - Flash 对象不可点击？

> ID：10984324
> 
> 赞同：0
> 
> 时间：2012-06-11T16:50:23.080
> 
> 标签：jquery, html, browser, flash

我在我的网站上嵌入了第三方 Flash 对象，并尝试通过将 jquery .click 事件绑定到其包装器 div 来添加指向它的链接。在 Firefox 中，这是有效的。然而，在 Chrome 和 IE 中，似乎无法通过 jQuery .click 事件访问 div。我的意思是，当绑定页面上的所有元素以在单击时发出警报时，单击 flash 对象不会引发警报（Firefox 除外）。

```
$("*").each(function() {
    $(this).click(function() {
         alert($(this));
    });
}); 
```

我在别处读到给 flash 对象一个 wmode = "transparent" 的参数......这让它在 FF 中工作。

以下是嵌入 Flash 对象的方式。

```
 <?php if ($post->post_name == 'insurance') {?>
 <script type="text/javascript">
var flashvars = {};
var params = {};
params.wmode = "transparent";
params.menu = "false";
params.allowScriptAccess = "never";
params.allowNetworking = "internal";
swfobject.embedSWF("/wp-content/uploads/2012/06/ad_Imagine_300x250_FLASH1.swf", "myRightRailAd", "300", "250", "10.0.0", false, flashvars, params); 
```

```
<div id="adboxrightcol" class="adHolder" style="z-index: 1000;">
    <div   id="myRightRailAd" style="position: absolute;">
    <img  id="myContent" src="<?php bloginfo('url');?>/wp-content/uploads/2012/06/ad_Imagine_300x250_JPG1.jpg" alt="BMO" width="300" height="250">             
    </div></div> 
```

jQuery click 事件被绑定：

```
$(document).ready(function() {
    $("#adboxrightcol").click(function() {
       location.href="http://www.somesite.com/car-insurance-quotes?utm_source=comparasave_ad&utm_medium=comparasave_insurancelp&utm_campaign=imagine_bb_ad";
   }); 
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:56:11.783

修复了问题...必须在 Flash 对象顶部使用绝对定位的 div，该对象不是 Flash 对象的包装器，并以透明图像作为 IE6 - 8 的背景

# jquery - 从选择菜单中提取选项

> ID：10984325
> 
> 赞同：0
> 
> 时间：2012-06-11T16:50:25.973
> 
> 标签：jquery, html, css, jquery-mobile

这可能非常初级，但我似乎无法理解。我在 Jquery 移动页面上设置了一些选择菜单，需要提取当前选择用于查询字符串的值以传递到搜索页面。我知道`$("#select-choice-1").val()`可以拉它，但我想抓住它并通过它。最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:53:34.000

```
var value = $("#select-choice-1").val(); // store the value within a variable

useValue(value); // call your function with arguments of value

function useValue(val) {
  // use that value through val
  alert(val);
} 
```

或者，在`change`事件处理程序内

```
$("#select-choice-1").change(function() {
  var value = this.value;
  // use value what ever you need
  useValue(value);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:03:55.457

您可以使用`map`创建查询字符串：http: [//jsfiddle.net/imsky/CQ7Cv/](http://jsfiddle.net/imsky/CQ7Cv/)

```
$("select").map(function() {
        return $(this).attr("name") + "=" + $(this).val()
}).toArray().join("&") 
```

# algorithm - 带有附加约束的 0/1 背包的最小化

> ID：10984326
> 
> 赞同：-3
> 
> 时间：2012-06-11T16:50:27.830
> 
> 标签：algorithm

我和这里有同样的问题： [Variation on knapsack - minimum total value exceeded 'W'](https://stackoverflow.com/questions/7949705/variation-on-knapsack-minimum-total-value-exceeding-w) with an **added constraint**。

细节：

我们有一组项目，每个项目 (i) 都有一个重量 (w_i) 和一个价值 (v_i) 和一个价格 (p_i)。我们必须选择这些项目的子组，以便：

*   最小化总总值

英石

1.  总重量至少为*W*。
2.  **总总价格至多为*P。***

如果我们忽略最后一个约束，这相当于 0/1 背包问题，可以像上面链接的问题中*提到*的那样解决。加上最后一个约束，它仍然可以使用动态规划解决吗？

任何提示表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:37:20.833

由于这是一个 NP 难题，您只需测试所有案例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T22:20:02.010

一个明显的解决方案是在您的动态编程状态下使用两个变量，W（当前重量）和 P（当前价格），这样 m[W][P] 可以为这两个参数提供最佳值。这将为您提供一个以 O(nP * 权重总和) 运行的算法。

您可能还需要考虑补充解决方案（反转 W 和 P，如阿米特的回答），具体取决于（权重总和）* P 或 W *（价格总和）是否更大。

# javascript - 为什么当我将数据选项添加到主干模型提取时，它不会触发回调

> ID：10984327
> 
> 赞同：0
> 
> 时间：2012-06-11T16:50:32.063
> 
> 标签：javascript, backbone.js, backbone-relational, marionette

我正在直接在主干中使用模型进行简单的提取。

这完美地工作。

```
model.fetch({
        success: function () {
            alert("success");                
        },
        error: function () {
            alert("error with data!!");
        },
        change: function () {
            alert("change");
        }
    }); 
```

但是我想在请求中发送一个参数，但是当我这样做时，它会停止工作吗？没有错误报告？

```
model.fetch({ data: { userId: userId} },{
        success: function () {
            alert("success");                
        },
        error: function () {
            alert("error with data!!");
        },
        change: function () {
            alert("change");
        }
    }); 
```

任何人都可以帮忙吗？请求看起来像是完美地从服务器返回？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T16:57:43.623

这似乎已经回答过了。

[Backbone.js 带参数获取](https://stackoverflow.com/questions/6659283/backbone-js-fetch-with-parameters)

此外，我认为您不必将回调函数包装在单独的对象中，但它们可以与数据变量存储在同一个对象中。

像这样：

```
...fetch({data: $.param({...}), success: ..., error: ...}); 
```

# android - 如何使 ListView 垂直适合 Button 和 ImageView

> ID：10984333
> 
> 赞同：1
> 
> 时间：2012-06-11T16:50:58.097
> 
> 标签：android

我正在尝试创建一个适合 Button 和 ImageView 的 ListView。我有一个 RelativeLayout，它在顶部有一个 Button，在底部有一个 ImageView。我想要他们之间的 ListView 。这就是我所做的。

我在 Button 下看到了我的 listView，但它与底部的 ImageView 重叠。那么如何才能让ListView在ImageView之上呢？

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/control_panel"
        android:layout_width="@dimen/mywidth"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <Button android:id="@+id/button"
            android:layout_height="@dimen/button_size"
            android:layout_width="@dimen/button_size"
            android:scaleType="center"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:background="@drawable/btn_shutter" />

        <ListView android:id="@+id/image_list"
            android:layout_width="@dimen/button_size"
            android:layout_height="wrap_content"
            android:drawSelectorOnTop="false"
            android:layout_above="@+id/image"
            android:layout_below="@+id/button"/>

        <ImageView
           android:id="@+id/image"
           android:layout_width="@dimen/mywidth"
           android:layout_height="@dimen/image_height"
           android:layout_alignParentRight="true"
           android:layout_alignParentBottom="true"/>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:43:02.480

试试这个

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/control_panel"
        android:layout_width="@dimen/mywidth"
        android:layout_height="match_parent"
        android:orientation="vertical">

        <Button android:id="@+id/button"
            android:layout_height="@dimen/button_size"
            android:layout_width="wrap_content"
            android:layout_alignParentTop="true"
            android:background="@drawable/btn_shutter" />

        <ImageView
           android:id="@+id/image"
           android:layout_width="@dimen/mywidth"
           android:layout_height="wrap_content"
           android:layout_alignParentBottom="true"/>

        <ListView android:id="@+id/image_list"
            android:layout_width="@dimen/button_size"
            android:layout_height="fill_parent"
            android:drawSelectorOnTop="false"
            android:layout_above="@+id/image"
            android:layout_below="@+id/button"/>

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:17:23.143

你在RelativeLayout上设置了吗？如果没有，您可以使用带权重的 LinearLayout。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/control_panel"
    android:layout_width="@dimen/mywidth"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <Button android:id="@+id/button"
        android:layout_height="0px"
        android:layout_width="@dimen/button_size"
        android:scaleType="center"
        android:layout_weight="1"
         />

    <ListView android:id="@+id/image_list"
        android:layout_width="@dimen/button_size"
        android:layout_height="0px"
        android:drawSelectorOnTop="false"
        android:layout_weight="6"/>

    <ImageView
       android:id="@+id/image"
       android:layout_width="@dimen/mywidth"
       android:layout_height="0px"
       android:layout_weight="1"/> 
```

# c# - 使用语句与 IDisposable.Dispose()

> ID：10984336
> 
> 赞同：57
> 
> 时间：2012-06-11T16:51:06.993
> 
> 标签：c#, .net, vb.net, using, idisposable

我的理解是，一旦代码退出块，.NET 中的[`using`语句](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/using-statement)就会调用`IDisposable`对象的方法。`Dispose()`

该`using`声明是否还有其他作用？如果不是，那么以下两个代码示例似乎实现了完全相同的效果：

```
Using Con as New Connection()
    Con.Open()
    'do whatever '
End Using

Dim Con as New Connection()
Con.Open()
'do whatever '
Con.Dispose() 
```

无论谁确认我是正确的或指出我错了并解释原因，我都会给出最佳答案。请记住，我知道某些类可以在其方法*中做不同的事情。*`Dispose()`这个问题是关于语句是否`using`达到与调用对象方法完全相同的结果`Dispose()`。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-06-11T16:52:54.030

`using`基本上相当于：

```
try
{
  // code
}
finally
{
  obj.Dispose();
} 
```

`Dispose()`因此，即使在块内的代码中抛出未处理的异常，它也具有调用的好处。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-12-29T13:36:42.727

正如*Brian Warshaw*在[这里](https://stackoverflow.com/questions/10984336/net-using-using-blocks-vs-calling-dispose)所说的，它只是一个实现`try`和`finally`块，以确保对象被释放。除了他的回答之外，`using`block 还确保即使您使用*scope***返回**内部，该对象也已被处置。

 *我自己曾经对此感到好奇，并使用以下方法对其进行了测试：

**自定义 IDisposable 测试类和 Main**

```
private class DisposableTest : IDisposable
{
    public string Name { get; set; }

    public void Dispose() { Console.WriteLine("{0}.Dispose() is called !", Name); }
}

public static void Main(string[] args)
{
    try
    {
        UsingReturnTest();
        UsingExceptionTest();                
    }
    catch { }

    try
    {
        DisposeReturnTest();
        DisposeExceptionTest();                
    }
    catch { }

    DisposeExtraTest();

    Console.ReadLine();
} 
```

**测试用例实现**

```
private static string UsingReturnTest()
{
    using (DisposableTest usingReturn = new DisposableTest() { Name = "UsingReturn" })
    {
        return usingReturn.Name;
    }
}

private static void UsingExceptionTest()
{
    using (DisposableTest usingException = new DisposableTest() { Name = "UsingException" })
    {
        int x = int.Parse("NaN");
    }
}

private static string DisposeReturnTest()
{        
    DisposableTest disposeReturn = new DisposableTest() { Name = "DisposeReturn" };
    return disposeReturn.Name;
    disposeReturn.Dispose(); // # IDE Warning; Unreachable code detected
}

private static void DisposeExceptionTest()
{
    DisposableTest disposeException = new DisposableTest() { Name = "DisposeException" };
    int x = int.Parse("NaN");
    disposeException.Dispose();
}

private static void DisposeExtraTest()
{
    DisposableTest disposeExtra = null;
    try
    {
        disposeExtra = new DisposableTest() { Name = "DisposeExtra" };
        return;
    }
    catch { }
    finally
    {
        if (disposeExtra != null) { disposeExtra.Dispose(); }
    }
} 
```

**输出**是：

*   UsingReturn.Dispose() 被调用！
*   UsingException.Dispose() 被调用！
*   DisposeExtra.Dispose() 被调用！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-11T18:30:57.903

```
//preceeding code
using (con = new Connection()) {
    con.Open()
    //do whatever
}
//following code 
```

等效于以下内容（请注意 con 的有限范围）：

```
//preceeding code
{
    var con = new Connection();
    try {
        con.Open()
        //do whatever
    } finally {
        if (con != null) con.Dispose();
    }
}
//following code 
```

这在这里描述：http: [//msdn.microsoft.com/en-us/library/yh598w02.aspx](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)

> using 语句可确保调用 Dispose，即使在调用对象上的方法时发生异常也是如此。**您可以通过将对象放在 try 块中，然后在 finally 块中调用 Dispose 来获得相同的结果；事实上，编译器就是这样翻译 using 语句的**。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-11T19:06:24.190

`using`语句比构造更清晰、更简洁，`try...finally{Dispose()}`并且应该用于几乎所有不想让块在不`Dispose`被调用的情况下退出的情况。“手动”处置更好的唯一常见情况是：

1.  一个方法调用一个工厂方法，该方法返回的东西可能实现也可能不实现 `IDisposable`，但如果实现了，则应该是 `Dispose`d（这种情况发生在非泛型 `IEnumerable.GetEnumerator()` 中）。设计良好的工厂接口应该要么返回一个实现 `IDisposable` 的类型（可能是一个无所事事的实现，就像 `IEnumerator` 的典型情况），或者指定调用者不期望 `Dispose` 返回的对象。不幸的是，像非通用的 IEnumerable 等一些接口都不满足任何标准。请注意，在这种情况下不能很好地使用`using`，因为它仅适用于声明类型实现`IDisposable`的存储位置。
2.  `IDisposable` 对象即使在块退出后仍应存在（设置 `IDisposable` 字段或从工厂方法返回 `IDisposable` 时通常是这种情况）。

请注意，当`IDisposable`从工厂方法返回一个时，应该使用如下内容：

```
  布尔确定 = 假；
  DisposableClass myThing;
  尝试
  {
    myThing = new DisposableClass();
    ...
    好=真；
    返回我的东西；
  }
  最后
  {
    如果 (!ok)
    {
      如果（我的东西！= null）
        myThing.Dispose();
    }
  }

```

以确保如果它没有被退回，`myThing`它将得到d 。`Dispose`我希望有一种方法可以`using`与一些“取消处置”方法一起使用，但不存在这样的东西。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-06-11T16:52:38.787

两者的区别在于，如果抛出异常

```
Con.Open()
'do whatever 
```

`Con.Dispose`不会被调用。

我不了解 VB 语法，但在 C# 中，等效代码是

```
try
{
    con = new Connection();
    // Do whatever
}
finally
{
    if (con != null) con.Dispose();
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-11T16:52:31.997

using 块确保`Dispose()`在抛出异常时调用它。

您的第二个样本没有这样做。

如果`Con.Open()`抛出异常，则在第一种情况下，您可以保证`Con.Dispose()`被调用。在第二种情况下，异常向上传播并且`Con.Dispose()`不会被调用。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-11T16:52:49.630

该`using`语句保证在引发异常时释放对象。这相当于在一个`finally`块中调用 dispose。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-06-11T16:54:09.163

Using 将封闭的块包装在 try/finally 中，该块在 finally 块中调用 Dispose。这确保即使发生异常也会调用 Dispose。

出于安全原因，您应该在几乎所有情况下使用*using*

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-06-11T17:42:50.847

如果内存提供服务，则 using 可以保证对象被处置，而不管它周围的代码块如何退出它。它通过将块包围在 try...finally 块中，并检查*使用*的变量是否为空，如果它不为空则将其丢弃。如果抛出异常，则允许它冒泡堆栈。除此之外，它所做的只是保证处置非空一次性对象。

```
try
{
  var myDisposable = new DisposableObject();
  myDisposable.DoSomething();
}
finally
{
  if (myDisposable != null)
    ((IDisposable)myDisposable).Dispose();
} 
```*

# django - 模板多对多 id django

> ID：10984344
> 
> 赞同：0
> 
> 时间：2012-06-11T16:52:09.280
> 
> 标签：django, django-models, django-templates, django-orm

如何获取多对多对象的 id？我有三个模型，媒体，图像和幻灯片。如何通过我的幻灯片对象获取媒体的 ID？

```
class Media(models.Model):
    CONTENT_TYPE_CHOICES = (
        ('photos', _('Photos')),
        ('videos', _('Videos')),
        ('audio', _('Audio')),
        ('Object360', _('360 Object')),
        ('Object3D', _('3D Object')),

    )

    source = models.FileField(upload_to='magazine')
    filename = models.CharField(max_length=50)
    content_type = models.CharField(max_length=10, choices=CONTENT_TYPE_CHOICES)
    created = models.DateTimeField(auto_now=True)

    class Meta:
        verbose_name = _('Media')
        verbose_name_plural = _('Media')

class ImageComponent(BaseComponent):
    media = models.ForeignKey(Media)
    is_embed = models.BooleanField(default=True)
    is_slideshow =models.BooleanField(default=False)

    def __unicode__(self):
        return u'Image Component'

class SlideshowComponent(BaseComponent):
    image = models.ManyToManyField(ImageComponent)
    is_autoplay = models.BooleanField(default=True)
    is_embed = models.BooleanField(default=True)

    def __unicode__(self):
        return u'Slideshow Component' 
```

在我的 view.py 我有：`slideshow = SlideshowComponent.objects.all()` 在模板中我尝试：

```
{% for slide in slideshow %}
{{ slide.image.media.id}} 
```

但不起作用..

编辑：如何通过 media.id 在 vi​​ew.py 中访问幻灯片对象

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:02:31.757

好吧，因为`image`它是一个 ManyToManyField，它链接到*许多*图像（它实际上应该被称为“图像”）。因此，您需要遍历它：

```
{% for slide in slideshow %}
    {% for image in slide.image.all %}
    {{ image.media.id }}
    {% endfor %}
{% endfor %} 
```

# ipad - 仅制作应用句柄OpenURL

> ID：10984347
> 
> 赞同：0
> 
> 时间：2012-06-11T16:52:35.597
> 
> 标签：ipad, url

我有一个应用程序是一组相关应用程序的一部分。它的工作是从其他应用程序接收数据并用它做一些非常具体的事情。一切正常，启动应用程序并使用 handleOpenURL 传递数据。但是，我想让应用程序仅在从另一个应用程序调用时启动。也就是说，不能在主屏幕上点击。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:55:09.067

如果未使用 URL 打开，则显示仪表板显示已安装的其他应用程序，并强制用户启动其中一个。（使用 UIApplication canOpenURL 检查）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T20:47:28.903

谜团解决了：如果应用是从另一个应用启动的，appDidFinishLaunching 中的 launchOptions 包含调用 URL 和调用应用 Bundle ID。所以我只是在那里检查。谢谢。

# python - 如何验证使用随机函数的正确性？

> ID：10984348
> 
> 赞同：5
> 
> 时间：2012-06-11T16:52:38.087
> 
> 标签：python, testing, random, regression-testing

有一些应用程序域（例如 GameDev），其中许多函数应该使用随机值创建以产生它们的输出。示例之一如下所示：

```
def generate_key(monster_key_drop_coef):
    key_letters = string.ascii_uppercase
    rand = random.random()
    if monster_key_drop_coef < rand:
        return None

    button = {}
    button["type"] = random.choice([1,2,3])
    button["letter"] = random.choice(key_letters)
    return button 
```

这个函数根据几个随机操作生成物品的掉落。如果您想自动验证此功能的正确性，则会出现问题。生成的值不是确定性的，编写回归测试似乎是不可能的。

我的问题是：

1.  这是否可以为此类函数编写有用的回归测试？
2.  在这种情况下，是否有任何通用方法可以创建其他类型的测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:52:38.413

下面介绍了一种有用的单元测试：

```
def test_generate_key():
    button_list = []
    for _ in range(1, 1000):
        button_list.append(generate_key(0.2))

    is_all_none = True
    is_not_none = False
    for key in button_list:
        is_all_none &= (key is None)
        is_not_none |= (key is not None)

    assert is_all_none == False
    assert is_not_none == True 
```

它验证函数签名，覆盖函数代码的所有行（很有可能），并且会在 99.999% 的情况下通过。还验证了该函数从 1000 中产生至少一个下降，有时不会产生下降。0.2 是物品掉落的概率。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-24T16:20:44.510

我会重写函数以使用依赖注入（随机数生成器作为参数传递给函数）。然后，您可以传递一个随机数生成器的模拟，以使用不同的确定性“随机”输入来测试您的函数。

当然，您也可以测试不依赖于随机调用结果的断言。如：

*   这些函数返回 None 或带有键“type”和“letter”的dict。
*   如果返回字典，则值具有适当的类型和范围。

我永远不会编写具有不确定结果的单元测试，即使是千分之一。我关心每一次测试失败，随机结果会令人不安。您最好封装您的随机性，以便可以独立于随机数生成器测试该函数。

# php - Godaddy服务器上的PHPMailer，设置正确吗？

> ID：10984352
> 
> 赞同：5
> 
> 时间：2012-06-11T16:52:44.217
> 
> 标签：php, email, smtp, phpmailer

我刚刚注册了一个 Godaddy 服务器来测试我正在编写的 PHP 脚本。我正在使用 PHPMailer 发送电子邮件，它使用 Godaddy 电子邮件主机：relay-hosting.secureserver.net

问题是我想将电子邮件标记为来自“me”@gmail.com

当我在 AddReplyTo 字段中使用我的 gmail 地址发送电子邮件时，收件人电子邮件帐户会将其直接发送到垃圾文件夹。

我知道这里存在一个基本问题，即我发送了相互冲突的标题，这可能就是它被放入垃圾文件夹的原因。

有人可以向我解释如何解决这个问题。谢谢你。

代码：

```
try {
    $mail = new PHPMailer(true);
    $mail->IsSMTP(); // Using SMTP.
    $mail->CharSet = 'utf-8';
    $mail->SMTPDebug = 2; // Enables SMTP debug information - SHOULD NOT be active on production servers!
    $mail->SMTPAuth = false; // Enables SMTP authentication.
    $mail->Host = "relay-hosting.secureserver.net"; // SMTP server host.

    $mail->AddReplyTo('me@gmail.com', 'Me');
    $mail->AddAddress('them@hotmail.co.uk', 'Them'); 
    $mail->SetFrom('me@gmail.com', 'Me');
    $mail->Subject = 'PHPMailer Test Subject via smtp, basic with authentication';
    $mail->AltBody = 'To view the message, please use an HTML compatible email viewer!';
    $mail->MsgHTML("Hi, this is an test email");
    $mail->Send();
} catch (phpmailerException $e) {
    echo $e->errorMessage(); 
} catch (Exception $e) {
    echo $e->getMessage(); 
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T01:06:00.470

亚历克斯是对的。您需要指定域中的发件人地址 me@myhostedexampledomain.com。关于 Pekka 关于将 Google 的服务器用于无法正常工作的电子邮件的评论。使用 Go Daddy 共享主机，您必须使用 relay-hosting.secureserver.net 进行发送。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-12T17:28:25.323

我用这个例子做了一个改变：

$mail->Host = "本地主机"; // SMTP 服务器主机。

GoDaddy 在使用 PHPMailer 时需要使用“localhost”。

# c++ - 排队调用事件循环中由 Qt 以倒序处理的插槽

> ID：10984361
> 
> 赞同：1
> 
> 时间：2012-06-11T16:53:11.827
> 
> 标签：c++, qt

在我正在处理的应用程序中，我有一个 QLineEdit，它附有一个标准 QObject::connect 到一个插槽：

```
QObject::connect(m_searchBar, SIGNAL(textChanged(const QString &)),this,SLOT(slot_searchBar())); 
```

如您所见，它将 textChanged 信号连接到我创建的插槽。此插槽如下所示：

```
 void LibraryWidget::slot_searchBar() 
{
    QString stringToFind = m_searchBar->text();

    m_searchResults->clear();
    if(stringToFind.isEmpty())
    {
        //set stacked widget back to the library when no text in search bar 
        m_libraryAndSearch->setCurrentWidget(libTree);
    } 
    else 
    {
        //show the search results
        QFont headerFont;
        QTreeWidgetItem * searchingMsg = new QTreeWidgetItem;
        headerFont = searchingMsg->font(0);
        headerFont.setBold(false);
        headerFont.setItalic(true);
        searchingMsg->setText(0, "Searching...");
        searchingMsg->setFont(0, headerFont);
        Qt::ItemFlags currentState = searchingMsg->flags();
        Qt::ItemFlags noSelect = (!(Qt::ItemIsSelectable) & currentState);
        searchingMsg->setFlags(noSelect);
        m_searchResults->addTopLevelItem(searchingMsg);
        m_libraryAndSearch->setCurrentWidget(m_searchResults);
        //m_searchThread->setTerminateAndWait();    
        //m_searchThread->beginThread(stringToFind);
        int testTwo = 0;
        for(int testInt = 0; testInt < 1000000000; testInt++)
        {
            testTwo++;
        }
        int testingThree = 0;
    }
} 
```

希望它的重要性有限，但最好向您展示，以防问题的根源在这里。

如果我在搜索栏中输入一个字符串，即有问题的 QLineEdit（很快）并查看附加的调试器（Visual Studio 2010）发生了什么，那么我会看到最奇怪的事情：

如果我在搜索栏中已经有“Jake”（来自之前的搜索，输入缓慢）然后快速输入“gh”，那么`stringToFind`第一次运行时的值为“Jakegh”，第二次运行时的值为“Jakeg” .

就好像 Qt 已将信号发射添加到堆栈而不是队列，然后以相反的顺序将它们送回事件循环。

问题是：有人知道这里发生了什么吗？有没有人经历过类似的结果？

Qt 4.7 版

目前的代码只是为了重现问题，它没有做任何事情。int testTwo -> int testingThree 只是为了减慢代码速度。

谢谢...

**编辑** 当字符串作为函数参数传递到插槽时，观察到相同的行为。线

```
QString stringToFind = m_searchBar->text(); 
```

试图调试和规避这种现象。

**编辑两个**

我试图在家里重新创建这个。在 Mac OS X 10.7 上从终端构建 Qt，因此没有可用的调试器。我正在使用一个非常简单的类和 main.cpp，其格式与上述相同，我无法让 Qt 以相反的顺序为我提供字母。我可以让它错过信号。我已将行编辑连接到文本编辑，这样每次行编辑中的文本更改时，都会使用`QTextEdit::append(( const QString & text ))`.

例如，如果我键入“N”、“e”、“w”，则应将“N”、“Ne”、“New”打印到文本编辑中。但是，有时它只是打印“N”、“New”。我有一个 for 循环减慢一切，并且必须**非常**快地击键。

第一次导致这种现象发生的系统必然比我构建的系统复杂得多，它在调试中运行并且运行缓慢。仍然不明白为什么这会导致这种行为，而且它肯定是这样的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T20:10:20.190

明显的问题是您的延迟循环，据说模拟了实际搜索的作用。这正是处理它的错误方法。搜索应该在一个单独的 QObject 中异步运行，然后您可以将其移动到一个单独的线程。只需将搜索栏中的信号连接到搜索器对象，然后当搜索器有新结果时，它应该返回信号。

您的测试延迟循环应该被替换为类似的东西`QTimer::singleShot(1000, this, SLOT(fakeResults()))`，其中插槽中的代码调用 GUI 中的相关插槽并产生一些虚假结果。

我建议您还将一个“观察者”对象附加到 QLineEdit，以监视事物。就是这样：

```
// in some file, say foo.cpp
class Watcher : public QObject
{
  Q_OBJECT
  QPointer<QLineEdit*> const edit;
public:
  Watcher(QLineEdit * ed, QObject * parent = 0) : QObject(parent), edit(ed) {
    connect(ed, SIGNAL(textChanged(QString)), SLOT(monitor(QString)));
  }
public slots:
  void monitor(const QString & str) {
    qDebug("Line edit signals text: %s", str.toLocal8Bit().constData());
    if (! edit.isNull() && edit->text() != str) {
      qDebug("... but line edit has text %s", edit->text().toLocal8Bit().constData());
    }
  }
}

#include "foo.moc" // replace 'foo' with actual name of the file (sans .cpp) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T20:13:14.463

不要抓取文本，在信号中使用 QString & 。

```
QObject::connect(m_searchBar, SIGNAL(textChanged(const QString &)),this,SLOT(slot_searchBar(const QString &))); 
```

然后稍后

```
void LibraryWidget::slot_searchBar(const QString &stringToFind) {
... 
```

至于你看到你的行为的原因，我几乎可以保证它在某个时候是一个 Qt::QueuedConnection 。您也可以在单线程代码中使用 QueuedConnection，它只会等到下一个事件循环执行其中的代码。查看它的详细信息：http: [//qt-project.org/doc/qt-4.8/qt.html#ConnectionType-enum](http://qt-project.org/doc/qt-4.8/qt.html#ConnectionType-enum)。

# wpf - 非常简单的 WPF 元素绘图

> ID：10984363
> 
> 赞同：0
> 
> 时间：2012-06-11T16:53:15.320
> 
> 标签：wpf, drawing

我必须在 WPF 用户控件或常规 WPF 控件（如图像/画布）上绘制多条线。线条的位置和大小保持不变，但颜色会随着时间而变化。

*   约2000行
*   以后无需引用它们或与它们交互，因为它可以使用形状
*   在颜色更新时，所有线条都将再次绘制（这就是我在 WinForms 中所做的）。
*   更新仅在用户操作时发生，所以就像每隔几秒到几天没有变化
*   更新应该很快，不会对程序性能产生太大影响

使用来自 FrameworkElement 的派生，对于这样一个简单的任务恕我直言，必须覆盖两个属性的开销太大了。

我想用尽可能少的代码来完成它，最好的性能是它只能在屏幕上看到，没有事件或任何交互。

在 WinForms 中这很简单：您将一个图形对象实例化并在其上绘图。在那里，我在位图上画线并将位图分配给 WinForms-Image。我什至可以通过更改图像的大小来缩放线条。

我了解直接绘图 (WinForms) 和保留绘图 (WPF) 之间存在差异。可以尽可能多地保留它，应该有一个简单的解决方案来创建一堆行并将它们分配给用户控件或常规 WPF 控件！？

谢谢你的帮助。

朱利安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:01:38.433

听起来您需要以与 WinForms 中相同的方式使用 OnRender 和 DrawingContext，例如

```
protected override void OnRender(DrawingContext drawingContext)
{
    base.OnRender(drawingContext);

    Pen pen = new Pen(Brushes.Blue, 1);

    foreach(...)
    {
        drawingContext.DrawLine(pen, p1, p2);
    }
} 
```

# ios - How to manage sessions with AFNetworking?

> ID：10984374
> 
> 赞同：55
> 
> 时间：2012-06-11T16:54:02.570
> 
> 标签：ios, session, cookies, afnetworking

As the title implies, I am using AFNetworking in an iOS project in which the application talks to a server. When the user signs in, the server responds by sending back a success flag and the response headers contain the session ID.

I am wondering if AFNetworking automatically sends the session ID with every subsequent request or should I take care of this myself in some way?

For your information, I have no control over the back-end in terms of how requests are authenticated. I am only building a client that talks to the server.

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2012-06-14T19:10:02.663

Yes, your session ID should be sent automatically once you are logged in, as long as the cookie does not expire before the next request is sent (important detail to be sure of). `NSURLConnection`, which AFNetworking uses, takes care of the details for this for you.

On the backend AFNetworking is using `NSURLConnection` which in turn automatically updates `NSHTTPCookieStorage` to store the session. You can manipulate or delete the cookies as you see fit by messing with the cookie storage.

Like if you wanted to appear to the service as not logged in, you could just delete the session cookie associated to that domain. Some services I have worked with will error if you are already logged in and attempt to login again. Additionally there was no way to check login status. Quick fix, get the cookies from URL and delete them :

```
NSArray *cookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL: networkServerAddress];
for (NSHTTPCookie *cookie in cookies) 
{
    [[NSHTTPCookieStorage sharedHTTPCookieStorage] deleteCookie:cookie];
} 
```

[From the developer himself](https://stackoverflow.com/questions/9933688/ios-afnetworking-asp-net-web-api-aspxauth-storage-and-deletion/9934707#9934707)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-14T14:27:49.007

This depends on the specification given by the service you are interacting with. I have worked with similar services and they have explicitly stated in their documentation that, In order to maintain the session valid I must poll the service at every few seconds by sending int "1".

However, If possible could please post the service name or any reference which we can read. If it is any company's private API then they must have described the use of the session id which they are returning.

* * *

Underlying technologies will take care of it, However if you want to persist those cookies then this answer for other question.

[Persisting Cookies In An iOS Application?](https://stackoverflow.com/questions/4597763/persisting-cookies-in-an-ios-application)

# java - 使用 HTMLUnit 的可能重定向

> ID：10984378
> 
> 赞同：0
> 
> 时间：2012-06-11T16:54:18.950
> 
> 标签：java, htmlunit

我正在做一个小程序，可以用谷歌搜索你想要的歌曲并打印它的歌词。为此，我将 HTMLUnit 与 Java 一起使用。我正在搜索目标文本，然后单击第一个 google 结果。但是，当我从浏览器检查结果时，页面会有所不同。

可能我的错误是因为 XPath，但我不确定。因为，我使用了 Google Chrome 的 XPATH 查看器以及 2 个 Firefox 扩展。

在 chrome 中，我右键单击要查看其 XPATH 的元素，然后右键单击底部窗口中的锚点 ()。然后，我选择复制 XPath。然后我将适当的“s”更改为“。

到目前为止，这是我的源代码。我现在写了一首随机的歌。

非常感谢你。

源代码：

（我尝试了很多东西。所以，由于源代码混乱，我很抱歉。我没有删除行来向你展示我到目前为止所做的尝试。再次感谢你。）

```
import java.io.IOException;
import java.net.MalformedURLException;

import com.gargoylesoftware.htmlunit.BrowserVersion;
import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException;
import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.HtmlAnchor;
import com.gargoylesoftware.htmlunit.html.HtmlPage;

public class dsa {
    public static void main(String args[]) throws FailingHttpStatusCodeException, MalformedURLException, IOException {

        WebClient webClient = new WebClient(BrowserVersion.FIREFOX_3_6);
        webClient.setThrowExceptionOnScriptError(false);
        //webClient.setJavaScriptEnabled(false);

        String address = "http://www.google.com/search?q=";
        String searchString = "Metallica - Whiskey In The Jar";
        //String searchString = "testtesttest";
        String someString = address.concat(searchString);
        String lastString = someString.concat(" site:randomlyricswebpageblabla.com");

        // site:anotherrandomlyricswebpage.com

        HtmlPage currentPage = webClient.getPage(lastString);
/*
        HtmlTextInput searchBox = (HtmlTextInput) currentPage.getElementById("search_input");
        searchBox.setTextContent("Amorphis - From The Heaven Of My Heart");

        HtmlButtonInput button = (HtmlButtonInput) currentPage.getElementById("search_button");

        HtmlPage newPage = button.click();
*/      
        //System.out.println(currentPage.asText());

        //

        //

        //HtmlElement element = (HtmlElement)currentPage.getByXPath("//h3").get(0);
        //DomNode result = element.getChildNodes().get(0);
        //HtmlAnchor hede = (HtmlAnchor) element.getFirstChild();
        //HtmlPage newPage = hede.click();

        //HtmlElement firstGoogleResult = (HtmlElement) currentPage.getByXPath("//*[@id='rso']/li[1]/div/h3/a").get(0);
        //HtmlAnchor testAnchor = (HtmlAnchor) firstGoogleResult.getFirstChild();

        HtmlAnchor firstGoogleResult = (HtmlAnchor) currentPage.getByXPath("//*[@id='rso']/li[1]/div/h3/a").get(0);

        HtmlPage newPage = firstGoogleResult.click();

        //HtmlAnchor linkTest = (HtmlAnchor) newPage.getByXPath("//*[@id='contentdiv_left']/div/div[3]/text()[1]");

        //HtmlDivision divContent = (HtmlDivision) newPage.getByXPath("\\div[contains(@class, 'contentdiv_leftbox_data')]");
        //System.out.println(divContent.asText());

        //System.out.print("*************\n\n\n" + newPage.asText());
        System.out.println(newPage.asText());
    }
} 
```

我懂了

> 推文按钮
> 
> 鸣叫

程序执行后在控制台中。

那么，我的第一个 Google 搜索结果的 XPath 是错误的，还是我在其他地方弄错了？

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:09:16.400

你得到错误的数据是因为`userAgent`.

当 google 收到请求时，它会在其数据库中搜索包含此数据的旧搜索：IP + Web 浏览器 + 您的 PC 数据。

我不知道 HTMLUnit 的默认用户代理是什么，但如果你将它设置为与你正在使用的用户代理相同的版本，它应该会得到相同的响应。

另外，我会尝试在适当的歌词网站上搜索，而不是谷歌。我不知道任何美国歌词网站，但应该很容易找到。

希望有帮助！

# coronasdk - 如何在 corona sdk 中设置组的宽度和高度

> ID：10984383
> 
> 赞同：0
> 
> 时间：2012-06-11T16:54:45.087
> 
> 标签：coronasdk

在我的应用程序中创建了一个组。我必须使用滑块来增加组的宽度和高度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T10:26:50.880

尝试增加将插入组中的对象。

# sql-server - SQL Server SSIS 没有当前行

> ID：10984387
> 
> 赞同：2
> 
> 时间：2012-06-11T16:55:06.600
> 
> 标签：sql-server, ssis, buffer, row, bids

我当前的包包含一个 Excel 源、一个脚本组件和一个 OLE DB 目标。我想要完成的只是改造我的一个专栏。对于这个特定的列，我想要该列的子字符串。但是，我不断收到以下错误消息：

```
 There is no current row in the buffer. A row may need to be added using the AddRow method.
 at Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.HandleUserException(Exception e) 
```

这意味着什么？当我所做的只是转换数据时，为什么我需要添加行？我错过了关于 SSIS 的大局吗？

这是我在脚本中的代码：

```
 public override void Input0_ProcessInputRow(Input0Buffer Row)
    {
        OutBuffer.labortypewbs = Row.CopyofLevel2ProjectSegment.Substring(Row.CopyofLevel2ProjectSegment.Length - 2, 2);
    } 
```

感谢所有的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:51:49.827

为什么不使用派生列而不是脚本组件。您可以使用该组件添加一个作为现有列的子字符串的列，而无需编写任何代码或学习脚本组件编程的复杂性。我只会在以下情况下使用脚本组件：

1.  我有一个案例，没有现有的组件可以进行我想要的转换。
2.  我需要使用的组件不够快或不够准确（有证据）无法使用。

我遇到过一些极端情况，其中脚本组件是最好的解决方案，但它们很少见，而且子字符串不是这些情况之一。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-30T16:56:50.360

虽然您可以使用派生列来完成此操作，正如 William 所指出的，但值得一提的是针对实际遇到的问题的解决方案。

在设置输出列的值之前，您首先必须添加一个新行。您的代码应该是：

```
public override void Input0_ProcessInputRow(Input0Buffer Row)
{
    OutBuffer.AddRow();
    OutBuffer.labortypewbs = Row.CopyofLevel2ProjectSegment.Substring(Row.CopyofLevel2ProjectSegment.Length - 2, 2);
} 
```

# jquery - jQuery ajax 加载事件不起作用

> ID：10984388
> 
> 赞同：-1
> 
> 时间：2012-06-11T16:55:06.990
> 
> 标签：jquery, jquery-load

我正在尝试使用 jQuery 的 ajax 加载事件将网站的另一部分加载到 div 中。长话短说——它没有加载任何东西。我尝试使用带有点击事件的链接（出于测试目的）。

这是jQuery代码：

```
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    $(document).ready(function(){
        <script type="text/javascript">
            $('#content-load-ajax').load('http://http://chemswap.com/register.php');
        </script>
    }); 
```

我正在尝试将 registrar.php 放入 div ID content-load-ajax。页面加载时无法加载 php 页面。

更多信息：*URL： http: [//www.chemswap.com/wordpress/registrar/](http://www.chemswap.com/wordpress/registrar/)（正在加载的页面在 iFrame 中）

*我在 WordPress 上运行它。

*registrar.php 是为客户旧站点开发的定制软件。它引用了许多不同的模块等。我们只想将 registrar.php 直接加载到当前页面中。

如果有人知道为什么这不起作用，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:57:51.010

这`$(document).ready() ...`也是Javascript，所以你**也**需要把你的`<script>`标签放在它周围。

```
<script type="text/javascript">
    $(document).ready(function(){
        $('#content-load-ajax').load('http://http://chemswap.com/register.php');
    });
</script> 
```

# batch-file - xcopy 到受密码保护的网络位置

> ID：10984392
> 
> 赞同：1
> 
> 时间：2012-06-11T16:55:36.627
> 
> 标签：batch-file, dos, xcopy

我最近接手了我公司的 IT 职位。我正在尝试设置计算机用户帐户的自动每日备份。我已经让 .bat 文件运行良好，如果我已经通过 Windows 资源管理器连接到备份服务器，它工作正常。

我的意思是，如果我去资源管理器，然后手动输入`\\server-name\folder$\username`它会提示用户和密码，我会输入并连接就好了。

但是，如果他们重新启动，除非他们重新输入密码，否则他们将失去访问权限。那么，我可以编写 xcopy 脚本以在命令行中包含密码，还是有另一种方法可以备份到受网络密码保护的目录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:22:16.747

当您转到资源管理器时，您可以将路径映射`\\server-name\folder$\username`到一个字母驱动器，例如“N:”。当您映射时，有一个选项“登录时重新连接”。这样，每次用户重新启动和登录时，都会自动重新建立与网络共享的连接。

# javascript - 通过 javascript 等效于 @Html.ActionLink 的 MVC

> ID：10984394
> 
> 赞同：12
> 
> 时间：2012-06-11T16:55:50.390
> 
> 标签：javascript, asp.net-mvc

如何通过javascript代码编写@Html.ActionLink的等效代码，即调用一个MVC动作，然后创建一个新视图而不返回调用视图？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-11T16:57:19.847

`javascript`是一种客户端语言，它对您使用的服务器端语言一无所知。因此，使用服务器端路由定义生成 url 的服务器端助手的 javascript 中没有等效项是正常的。

目前尚不清楚您要实现的目标，但如果您想通过 javascript 调用一些 url，您可以使用服务器端帮助程序生成此 url：

```
<script type="text/javascript">
    var url = '@Url.Action("SomeAction", "SomeController")';
    // do something with the url client side variable, for example redirect
    window.location.href = url;
</script> 
```

如果您想在一个单独的 javascript 文件中使用此 url，而您无法访问服务器端助手，您仍然可以根据具体情况将此 url 包含在某些 DOM 元素中。

例如：

```
<div id="foo" data-url="@Url.Action("SomeAction", "SomeController")">Click me</div> 
```

请注意`data-url`我们嵌入到 DOM 中的 HTML5 属性，并使用服务器端帮助程序来确保生成的 url 根据我们的路由定义始终是正确的。现在我们可以在一个单独的 javascript 文件中不显眼地订阅这个 div 的点击事件并检索 url：

```
$('#foo').click(function() {
    var url = $(this).data('url');
    // do something with the url client side variable, for example redirect
    window.location.href = url;
}); 
```

其他示例显然包括应该使用服务器端 HTML 帮助程序生成的标准`<a>`和`<form>`元素，然后您在单独的 javascript 文件中所要做的就是获取它们的对应`href`或`action`属性以检索实际 url 并对其进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-23T21:41:28.260

另一种选择是将 URL 存储在`<div>`页面上隐藏的某个位置，然后通过 Javascript 调用它。它看起来像这样：

**索引.cshtml**：

```
<div style="display: none;" id="url">
   @Url.Action("SomeAction", "SomeController")
</div> 
```

然后，您可以在**Script.js**文件中使用它来构建您想要的任何链接。

```
var url = $("#url").text(); 
```

然后 URL 变量将包含指向`/SomeController/SomeAction`.

# asp.net - 更新到 WebApi 的 RC 导致无法从程序集错误中加载类型“System.Web.Http.Dependencies.IDependencyResolver”

> ID：10984395
> 
> 赞同：9
> 
> 时间：2012-06-11T16:55:52.077
> 
> 标签：asp.net, asp.net-web-api

我最近使用 Nuget 升级到 WebApi 的 RC 版本，但现在出现以下错误。

> 无法从程序集“System.Web.Http，Version=4.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”加载类型“System.Web.Http.Dependencies.IDependencyResolver”。

使用对象浏览器，我可以看到正确的参考。我尝试重建、清理和清除临时 Internet 文件。

谷歌搜索出现了[http://forums.asp.net/t/1810546.aspx/1?Dependency+Resolver+throws+an+error+with+Unity](http://forums.asp.net/t/1810546.aspx/1?Dependency+Resolver+throws+an+error+with+Unity)但这并没有多大帮助。

有谁知道是什么原因造成的？

![来自 Visual Studio 的屏幕截图](../Images/dcf5e4cf23fadb48b1b84a6fe68693d6.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T10:11:06.053

最后的答案是 MVC 4 冲突，我假设它放在 GAC 中的 dll 优先，卸载 MVC 4 为我解决了这个问题。

# symfony - 将文件放在 Symfony2 的 app/cache 文件夹中是不是很糟糕？

> ID：10984401
> 
> 赞同：2
> 
> 时间：2012-06-11T16:56:31.563
> 
> 标签：symfony, swiftmailer

我[要让我的应用程序假脱机邮件](http://symfony.com/doc/current/cookbook/email/spool.html)，并试图找到一个放置邮件假脱机文件的好地方。

我喜欢`%kernel.cache.dir%/foobarmailspool`，因为这意味着我（和我的开发人员）现有的文件系统 ACL 不需要扩充。

**写作`app/cache`形式差吗？**

**如果没有，是否有一些我可以/应该遵循的命名约定？**

再想一想，考虑到在使用 symfony2 时必须发生的`app/cache`所有[缓存被吹走的情况，将电子邮件假脱机可能不是一个好主意。](https://stackoverflow.com/questions/7321773/symfony2-dev-environment-not-clearing-cache-automatically)不过，我的问题不必专门针对假脱机电子邮件，而是更多关于一般写入缓存的内容（如标题中所述）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T18:26:46.950

我认为在缓存文件夹中假脱机电子邮件是个坏主意，因为缓存是您可以随时删除的东西，您可能会丢失尚未发送的假脱机电子邮件。我建议为他们创建一个单独的文件夹——比如`app/spool`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T19:52:29.317

将它们存储在缓存文件夹中似乎是一个好主意，因为您已经在那里拥有写入权限，但是所有缓存位置都应被视为“易失性”，因此不可靠。

如果你只是将它们写入磁盘进行测试，你总是可以使用 /tmp/ 或者如果你在同一个执行线程中使用它们，那么 php 中总是有非常方便的 I/O 流选项，更多关于[http： //php.net/manual/en/wrappers.php.php](http://php.net/manual/en/wrappers.php.php)。

但是，如果您想在生产环境中执行此操作，则需要在磁盘上具有正确的权限集、数据库甚至内存缓存的真实文件夹（如果您计划过期的话）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T17:05:24.607

如果将邮件存储在数据库中，则根本不需要接触文件系统。

# java - 反序列化protobuf java数组

> ID：10984402
> 
> 赞同：2
> 
> 时间：2012-06-11T16:56:31.823
> 
> 标签：java, protocol-buffers

假设我有一个 WCF 服务，它发送使用 protobuf-net 序列化的列表。该函数返回 byte[], application/octet-stream。

现在，在我的 java 应用程序中，我已经将 MyClass.proto 编译成 MyClass.java 并从 http 获取之前发送的数据。

要反序列化 1 个对象，我将使用

```
MyClass MyObject = MyClass.parseFrom(http_input_stream); 
```

但是如果一个数组来了我应该用什么......？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T22:41:37.923

A`List<MyClass>`实际上被序列化为一系列`MyClass`对象，每个对象都有一个标准的`1`. 我不知道Java API向后：如果它有一个“读取一系列项目”API然后：使用它。然而，一个可靠的后备方案是以下完全兼容的“.proto”片段：

```
message Foo {
    repeated MyClass items = 1;
} 
```

将数据加载为`Foo`（您可能想要重命名......）并且：工作完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T13:58:39.203

好吧，我最终创建了另一个原型消息

```
message MyClassCollection {
    repeated MyClass = 1;
} 
```

然后将其编译成java类并反序列化传入的数组，如

```
MyClassCollection MyObjects = MyClassCollection.parseFrom(http_input_stream); 
```

# python - 如何在 mac osx 上更新 python-sqlite

> ID：10984403
> 
> 赞同：3
> 
> 时间：2012-06-11T16:56:38.707
> 
> 标签：python, macos, sqlite, foreign-keys

Mac OS X Snow Leopard 上的 Python 2.7.3（从 python.org 下载）告诉我它正在使用 sqlite 3.6.12 ( `sqlite3.sqlite_version`)。但是，要使用外键，我至少需要 sqlite 3.6.19。

如何单独更新 sqlite？

我已经尝试过`pip install pysqlite`（来自这个问题/答案：[Updating the SQLite3 build on my python install](https://stackoverflow.com/questions/10904629/updating-the-sqlite3-build-on-my-python-install)），但 sqlite_version 没有改变。`pip search sqlite`显示 pysqlite 2.6.3 已安装，但我仍然有，来自命令`python`和`python2.7`

```
>>> import sqlite3
>>> sqlite3.sqlite_version  #3.6.12
>>> sqlite3.version         #2.6.0 (yeah, no 2.6.3) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:01:18.787

您首先需要安装[SQLite](http://www.sqlite.org/download.html)，然后 build 和 install `pysqlite`，确保它是针对您新安装的 sqlite 版本而不是系统的 sqlite 版本构建的。或者，如果 pysqlite 是动态链接的，您可能可以使用`LD_LIBRARY_PATH`现有的 pysqlite 加载更新版本的库。

有关更多信息，请参阅：[https ://groups.google.com/group/python-sqlite/browse_thread/thread/9fb6694c803431eb](https://groups.google.com/group/python-sqlite/browse_thread/thread/9fb6694c803431eb)

# ios - 编译器看不到符合 UIImagePickerControllerDelegate 协议

> ID：10984404
> 
> 赞同：3
> 
> 时间：2012-06-11T16:56:39.923
> 
> 标签：ios, delegates, protocols, compiler-warnings

我错过了一些东西。这段代码运行良好，但我喜欢清除所有编译器警告。

```
Sending 'GSBBuilderImageButton *const __strong' to parameter of incompatible type 'id<UINavigationControllerDelegate,UIImagePickerControllerDelegate>' 
```

在过去使用此警告消息的经验中，我从未注意到警告中提到了*两个*协议——而且很公平，在这种情况下，我不知道为什么会引用 UINavigationControllerDelegate。

但首先是我的界面：

```
#import <UIKit/UIKit.h>
#import "GSBImageButtonDelegate.h"

@interface GSBBuilderImageButton : UIButton <UIImagePickerControllerDelegate>
{
    UIPopoverController *popover;
    UIImage *imageData;
    NSURL *mediaURL;
    id <GSBBuilderImageButtonDelegate> _delegate;
}
@property (strong, nonatomic) NSURL *mediaURL;
@property (strong, nonatomic) UIImage *imageData;
@property (strong, nonatomic) id <GSBBuilderImageButtonDelegate> delegate;
- (void)removePicture;
- (void)setImageData:(UIImage *)theImageData;

@end 
```

重要的是 @interface 声明，其中包括 UIImagePickerControllerDelegate 采用。

在我的实现中，我注意了一个触摸（我想在我写这个的时候我没有使用 setTarget:forAction:forControlState: 因为这个类从 UIView 开始）：

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    // really need to check to see that the touch ended while within our bounds

    UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];

    [imagePicker setSourceType:UIImagePickerControllerSourceTypeSavedPhotosAlbum];
    [imagePicker setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
    [imagePicker setDelegate:self]; 
```

所以我读到的方式是本地对象 imagePicker 被告知它的委托是 GSBBuilderImageButton 的这个实例，它在其接口中声明它符合 UIImagePickerControllerDelegate 协议。这似乎完全有效，也是我们一直在做的事情。虽然我的 GSBBuilderImageButton 确实有自己的委托，但除非我做错了什么，否则不应该对此产生影响。

当然，在那之后还有更多内容，包括可选协议方法的实现

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info 
```

我正在以编程方式构建这个按钮，所以为了完整起见，这是我正在使用的初始化：

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        [[self imageView] setContentMode:UIViewContentModeScaleAspectFill];
        UILongPressGestureRecognizer *longPress = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(removePicture)];
        [self addGestureRecognizer:longPress];
    }
    return self;
} 
```

（注意：不要挂断我对 setImageData 的定义......这是一个调用 UIButton 的 setImage 的包装器方法，还有一些其他任务，它的遗产是相同的 UIView 遗产——对于这个应用程序的 2.0 版，我会覆盖 setImage:!

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-11T18:02:15.293

这正是警告消息所说的：[`UIImagePickerController`'`delegate`属性](http://developer.apple.com/library/ios/documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html#//apple_ref/occ/instp/UIImagePickerController/delegate)需要一个同时符合**和**协议`UIImagePickerControllerDelegate`的`UINavigationControllerDelegate`对象。这是因为图像选择器 UI 包含一个导航控制器；该协议中的方法是可选的，因此如果您不需要对它们执行任何操作，则无需实现它们。

但是您仍然需要声明符合这两种协议：

```
@interface GSBBuilderImageButton : UIButton <UIImagePickerControllerDelegate, UINavigationControllerDelegate> 
```

您的其余代码与编译器警告无关。

* * *

**更新：**这是一个相关的提示。如果仅在类的实现中使用协议一致性，则不需要在头文件中声明它。您可以在`.m`文件中的类扩展中声明一致性：

```
@interface GSBBuilderImageButton () <UIImagePickerControllerDelegate, UINavigationControllerDelegate>
@end 
```

# ios - 如何使用 Flash Builder 对单选按钮值求和

> ID：10984405
> 
> 赞同：0
> 
> 时间：2012-06-11T16:56:41.093
> 
> 标签：ios, apache-flex, flash-builder

假设我有 6 个广播组，例如：

```
<s:RadioButtonGroup id="radiogroup1"/>
<s:RadioButtonGroup id="radiogroup2"/>
<s:RadioButtonGroup id="radiogroup3"/>
<s:RadioButtonGroup id="radiogroup4"/>
<s:RadioButtonGroup id="radiogroup5"/>
<s:RadioButtonGroup id="radiogroup6"/> 
```

如何使用 flash builder 对单选按钮值求和，并设置一些条件，例如如果分数 <10 - 在结果附近显示消息（分数差）；如果分数>= 10（中等分数）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:19:32.483

您可以为每个事件添加一个[CHANGE](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/RadioButtonGroup.html#event%3achange)事件，`RadioButtonGroup`以便在用户更改选择时收到通知。在事件处理程序中，汇总单选按钮组中的值并采取相应措施。

MXML：

```
<s:RadioButtonGroup id="radiogroup1" change="onRadioButtonChange"/>
<s:RadioButtonGroup id="radiogroup2" change="onRadioButtonChange"/> 
```

然后在脚本块中：

```
private function onRadioButtonChange(event:Event):void
{
    var score:Number = 0;
    score += radioGroup1.selectedValue
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:20:15.123

```
 private function sumAll():void
        {
            var totalValue:Number;

            for each(var rbg:RadioButtonGroup in  [radiogroup1, radiogroup2, radiogroup3,radiogroup4, radiogroup5, radiogroup6])
            {
                totalValue+= rbg.selectedValue;  // if these are strings be sure to parseInt(rbg.selectedValue)
            }

            firstLabel.visible = firstLabel.includeInLayout = secondLabel.visible = secondLabel.includeInLayout = thirdLabel.visible = thirdLabel.includeInLayout = false;

            if(totalValue>10)
            {
                //Alert.show("You had more than 10");
                firstLabel.visible = firstLabel.includeInLayout = true;
            }
            else if(totalValue<=10 && totalValue>5)
            {
                //Alert.show("You passed");
                secondLabel.visible = secondLabel.includeInLayout = true;
            }
            else if(totalValue<=5)
            {
                //Alert.show("You failed");
                thirdLabel.visible = thirdLabel.includeInLayout = true;
            }
        }
    ]]>
</mx:Script>
<s:RadioButtonGroup id="radiogroup1"/>
<s:RadioButtonGroup id="radiogroup2"/>
<s:RadioButtonGroup id="radiogroup3"/>
<s:RadioButtonGroup id="radiogroup4"/>
<s:RadioButtonGroup id="radiogroup5"/>
<s:RadioButtonGroup id="radiogroup6"/>
<s:Label text="Winner winner chicken dinner" id="firstLabel" visible="false" includeInLayout="false"/>
<s:Label text="You passed" id="secondLabel" visible="false" includeInLayout="false"/>
<s:Label text="You failed" id="thirdLabel" visible="false" includeInLayout="false"/> 
```

# java - 尝试使用 javac 编译 .java helloworld 程序时出错

> ID：10984408
> 
> 赞同：0
> 
> 时间：2012-06-11T16:56:49.973
> 
> 标签：java

我是 Java 编程新手，我正在自学。

在运行 javac 遇到一些初始问题后，我再次检查了 Windows 地址和类路径，并将它们设置为正确的目录路径。问题已解决，因为现在当我输入“javac-version”时，我得到的版本显示已安装 java 编译器。所以现在我正在尝试从命令提示符运行一个 Helloworld 程序，以检查基本功能！（我没有使用 Eclipse，因为我还没有准备好添加一层额外的复杂性 - 加上我在这个 IDE 中遇到不同的错误）我使用的程序如下：

```
package Program Files.Java.jdk1.7.0_03.bin.namespace;

public class MyTestApplication{
    public static void main(String[]args){
        system.out.println("Hello World!");
    }
} 
```

所以在命令提示符下，我导航到 bin 目录（我的源代码文件所在的位置），即：c:\program files\java\jdk1.7.0_03\bin\javac MyTestApplication.java

我收到以下错误：

MyTestApplication.java:3: 错误';' 预期的包程序^files.java.jdk1.7.0_03.bin.namespace；

请注意：“程序”和“文件”之间的符号是“^”符号，但位于单词的底部而不是顶部 - 当我的键盘出现时，我不得不在其当前的“顶部”位置使用此符号没有这个符号在所需的位置能力。

因此，如果有人能指出我可能忽略的内容！这将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:58:10.660

> 包名不能包含空格和特殊字符

[包命名约定](http://docs.oracle.com/javase/tutorial/java/package/namingpkgs.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:59:52.437

在您的情况下，您可能希望将您的课程留在默认的、无名的包中。完全删除 package 声明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T17:02:44.480

包不能有空格，比如程序和文件之间

```
package Program Files.Java.jdk1.7.0_03.bin.namespace; 
```

包应该是这样的

```
package com.demo.first;

Every file can have one and only 1 package,
and is the 1st statement in the file, 
and all the classes, interfaces, etc in that file belong to only that package 
```

编辑：

`system`.out.println("Hello World!"); //系统是错误的包。

`System`.out.println("你好"); // 系统正确

# c - 为什么内部结构中不允许使用 typedef？

> ID：10984418
> 
> 赞同：8
> 
> 时间：2012-06-11T16:57:37.863
> 
> 标签：c, gcc, struct, typedef

我有一个在现有 typedef 结构中定义 typedef 结构的程序，我想知道为什么会出现编译错误。

这是程序：

```
typedef struct Outer
{
    typedef struct Inner
    {
        int b;
    }INNER;

    INNER inner;
    int a; 

}OUTER;

int main()
{ 
    OUTER obj;
    obj.a = 10;
    obj.inner.b=8;
    return 0;
} 
```

编译时出现以下错误::

```
test.c:3:5: error:expected specifier-qualifier-list before ‘typedef’
test.c: In function ‘main’:
test.c:17:5: error: ‘OUTER’ has no member named ‘a’
test.c:18:5: error: ‘OUTER’ has no member named ‘inner’ 
```

但是，当我将程序更改为

```
typedef struct Outer
{
    struct Inner
    {
        int b;
    };

    struct Inner inner;
    int a; 

 }OUTER;

 int main()
 {
    OUTER obj;
    obj.a = 10;
    obj.inner.b=8;
    return 0;
 } 
```

它编译成功。

为什么内部结构不允许使用 typedef？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-11T17:27:55.297

C 不允许在结构成员的声明中使用存储类说明符（`typedef`, 但也有`static`or `extern`）。这是在 C99 中 6.7.2.1p1 中的结构和联合声明的语法中指定的。

```
/* The compiler will issue a diagnostic for this declaration */ 
struct s {    
    static int a;
}; 
```

您可以将 6.7.2.1p1 语法与声明的语法进行比较，其中声明符不是 6.7p1 中的函数参数或结构/联合成员，并看到在这种情况下允许使用存储类说明符。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-11T20:36:11.483

在`struct`定义中包含 typedef 是一种相当奇怪的风格。

通常，定义的`{`和之间应该出现的唯一内容是结构成员的声明。`}``struct`

正如 ouah 所说，`struct`定义中的声明不能包含存储类说明符；存储类说明符是`typedef`, `extern`, `static`, `auto`, and `register`（和 C11 添加`_Thread_local`）。这种限制是有道理的，因为结构成员的存储完全取决于它所属的结构的存储。

并且`typedef`是特例；它没有指定存储类，但为了语法方便，它被视为*存储类说明符。*

您*可以*在结构定义中包含其他类型的声明；例如，如您所见，您可以将一个结构声明嵌套在另一个内部。例如，这个程序是有效的（据我所知）：

```
struct outer {
    struct inner {
        int x;
    };                        // line 4
    struct inner foo;
};

int main(void) {
    struct outer obj;
    obj.foo.x = 42;
    return 0;
} 
```

但是 gcc 警告嵌套声明：

```
c.c:4:6: warning: declaration does not declare anything [enabled by default] 
```

（在我尝试这个之前，我会认为这是非法的。）

**更新**：`gcc -pedantic-errors`以致命错误拒绝它，表明它是非法的。我会尝试用标准来验证这是非法的。

我认为最好的做法是在结构中*只包含*成员声明。如果需要声明另一种类型，请在结构声明之外声明。例如，我会像这样重写问题中的代码：

```
typedef struct Inner
{
    int b;
} INNER;

typedef struct Outer
{
    INNER inner;
    int a;

} OUTER;

int main(void)
{
    OUTER obj;
    obj.a = 10;
    obj.inner.b=8;
    return 0;
} 
```

（实际上，我会这样写：

```
struct inner {
    int b;
};

struct outer {
    struct inner inner;
    int a;
};

int main(void) {
    struct outer obj;
    obj.a = 10;
    obj.inner.b = 8;
    return 0;
} 
```

# java - 如何在java中获得一个打开的套接字？

> ID：10984426
> 
> 赞同：3
> 
> 时间：2012-06-11T16:58:01.057
> 
> 标签：java, sockets, client-server

在Java中，我怎样才能获得一个开放的套接字？我有 2 个 JFrame；在第一个 JFrame 中，我打开了客户端套接字的连接。在同一个 JFrame 中，我创建了另一个 JFrame (JFrame2) 的实例。现在我想从 JFrame1 获取相同的 Socket 到 JFrame2 以继续与我的服务器 Socket 通信：

## **login.java**（第一个 JFrame）

```
try {
            cliente = new Socket("localhost", 4444);
            salida = new ObjectOutputStream(cliente.getOutputStream());
            entrada = new ObjectInputStream(cliente.getInputStream());
        } catch (UnknownHostException e) {
            System.err.println("Don't know about host: localhost.");
            System.exit(1);
        } catch (IOException e) {
            System.err.println("Couldn't get I/O for the connection to: localhost.");
            System.exit(1);
        } 
```

## **login.java**（第一个 Jframe）

```
try {           

            while ((mensaje_entrada=(String)entrada.readObject()) != null) {
                try {
                    me=td.encrypt(mensaje_entrada);
                    m2=td.decrypt(me);
                } catch (Exception ex) {
                    Logger.getLogger(Login.class.getName()).log(Level.SEVERE, null, ex);
                }
                System.out.println("e:"+ me);
                System.out.println("de:"+ m2);

                System.out.println(mensaje_entrada);
                if(mensaje_entrada.equals("20")){
                    mensaje_salida=""+txt_usuario.getText()+","+txt_password.getText();
                    System.out.println(mensaje_salida);
                    salida.writeObject( mensaje_salida );
                    salida.flush();
                    mensaje_entrada=(String)entrada.readObject();
                    System.out.println(mensaje_entrada);
                    if(mensaje_entrada.equals("1")){
                        m.setLocationRelativeTo(null); <---- **m is another JFrame(Jframe2)**
                        m.setVisible(true);
                        //JOptionPane.showMessageDialog(this,"Funciona!!");
                        break;
                    }else if(mensaje_entrada.equals("2")){
                        JOptionPane.showMessageDialog(this,"Usuario o contraseña incorrecta!","Error!",JOptionPane.ERROR_MESSAGE);
                        break;
                    }
                }

            }

        } catch (EOFException ex) { //This exception will be caught when EOF is reached
            System.out.println("End of file reached.");    
        } catch (ClassNotFoundException ex) {
            JOptionPane.showMessageDialog(this,ex.getMessage());
        } catch (IOException ex) {
            JOptionPane.showMessageDialog(this,ex.getMessage());
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:20:39.537

请看一下[Singleton的实现](http://www.dofactory.com/Patterns/PatternSingleton.aspx)

有了这个，您可以从任何地方以优雅的方式访问您的对象，并保证它将被唯一地实例化。

一个遵循单例方法的简单实现：

```
package foo.bar;

import java.io.IOException;
import java.net.Socket;

public final class MySingletonSocket extends Socket {

    private static Socket clientSocket;

    static {
        try {
            clientSocket = new MySingletonSocket("localhost", 4444);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private MySingletonSocket(final String address, final int port) throws IOException {
        super(address, port);
    }

    public static final Socket getInstance() {
        return clientSocket;
    }

} 
```

从 JFrame1 你可以像这样访问它：

```
MySingletonSocket.getInstance() 
```

从 JFrame2 您可以以相同的方式访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:15:14.790

您能做的最好的事情就是只做与在 JFrame 中显示内容有关的事情。

JFrame 中不应该有套接字。我知道它可以，但它不应该。您应该在 JFrame 之外有一个用于业务逻辑的类。然后你的控制器对象可以生成你的 JFrames 和你的套接字。

可以这样想：想象一下，您正在为命令行编写应用程序，而不是使用 JFrame。然后，当您制作 JFrame 时，让它们向该命令行应用程序发出命令。当您编写具有良好分层的程序时，您会发现这样的问题很容易解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:11:57.397

做那个`client Socket static.`

例如：

```
 static Socket client = new Socket; 
```

由于静态成员用于类，并且所有对象共享相同的静态变量，因此第二帧将具有相同的客户端套接字。

您可以做的另一件事是将客户端套接字的对象引用传递给第二帧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T17:13:25.090

您可以在两个 JFrame 中共享对客户端套接字的引用。

这可以通过以下两种方法之一实现：

1.  将套接字声明为 JFrame1 和 JFrame2 都可以访问的静态变量。
2.  将 Socket 的引用传递给 JFrame2

在 JFrame2 内部，有一个这样的方法：

```
public void setSocket(Socket s) {
    this.socket = s;
} 
```

然后，从 JFrame1 调用此方法，并将套接字传入。

# delphi - 如何取消分配Crt（输出）？

> ID：10984430
> 
> 赞同：5
> 
> 时间：2012-06-11T16:58:13.867
> 
> 标签：delphi, pascal, crt, turbo-pascal

在 TurboPascal 程序中，我利用了 DOS*处理的输出*并使用 Tab*控制字符*在输出中形成列：

```
const Tab = #09;
...
Writeln(X, Tab, F(X)); 
```

但是，当我尝试通过call 和 used模块添加类似`pause`功能时，*处理后的输出*中断，上面说明的语句开始编写通用 Tab 字形，而不是在制表位处形成列。`ReadKey``Crt`

 *正如我所知道的，这种现象的根源是`AssignCrt(Output)`模块初始化时的调用，这重新定义了`Writeln`工作方式 - 它不再使用 DOS 进行输出，而是使用视频 BIOS 或直接访问视频内存（取决于`DirectVideo`值）。

我如何**扭转**任何事情`AssignCrt`？据我从文档中了解到，该`Crt`模块无法提供恢复正常输出的方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-11T17:41:50.613

文本文件驱动程序`Crt`不`tab`支持. `turbo-pascal`要恢复标准`dos`驱动程序，请执行以下操作：

> 分配（输出，''）；//恢复标准dos输出

您可以稍后通过以下方式恢复 Crt 驱动程序：

> 分配Crt（输出）；*

# bash - 如何一次性将文件内容读入变量？

> ID：10984432
> 
> 赞同：39
> 
> 时间：2012-06-11T16:58:18.893
> 
> 标签：bash, shell

在Java中，如果你确定一个文件很小，你可以使用`readBytes()`方法一次性读取内容，而不是逐行读取或使用缓冲区。

只是想知道 shell 脚本，我知道我们可以执行以下操作：

```
 while read line
    do
      echo $line
      LINE = $line
    done < "test.file"
    echo $LINE 
```

如果我的 test.file 是这样的：

```
testline1
testline2
testline3 
```

这只给了我最后一行到`$LINE`. `$LINE`包含“testline3”。

我的问题是：如何将包含多行的整个文件读入一个变量中，这样我才能得到`$LINE="testline1\ntestline2\ntestline3"`？

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2012-06-11T17:04:51.987

处理循环内的行而不是循环之后的行。如果您确实需要变量中的文件：

```
var=$(<file) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-11T19:01:56.427

另一种选择是使用 nice mapfile 内置：

```
mapfile < test.file
echo "${MAPFILE[@]}" 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-06-11T18:10:17.127

作为另一种选择，您可以构建一个行数组。如果您正在运行 bash 4+，则可以使用`mapfile`内置：

```
mapfile -t lines <test.file 
```

如果您希望将行输出和存储，您可以执行以下操作：

```
mapfile -t lines < <(tee /dev/tty <test.file) 
```

然后`"${lines[0]}"`将是文件的第一行，`"${lines[1]}"`第二行，依此类推。`${#lines[@]}`将是行数；`"${lines[@]}"`将是整个数组，而`"${lines[*]}"`将用空格连接在一起的行变成一个大字符串。

对于旧版本的 bash，您可以手动构建数组：

```
lines=()
while IFS= read -r line
do
  printf '%s\n' "$line"
  lines+=("$line")
done < test.file 
```

# extjs - Rally App SDK 2.0：隐藏/删除卡所有者和图像

> ID：10984434
> 
> 赞同：1
> 
> 时间：2012-06-11T16:58:31.357
> 
> 标签：extjs, rally

我在 App SDK 2.0 的卡头中隐藏/删除卡所有者和图像时遇到问题。这在 1.30 中非常简单，只使用 CSS，但类似的 CSS 似乎不起作用，也没有尝试以编程方式从呈现模板中删除 HTML 元素。

CSS：

```
.cardOwner .cardOwnerName {
    display: none !important;
} 
```

JS：

```
header.renderTpl.html = '{template-card owner/image els}';
header.renderTpl.master.body = '{template-card owner/image els}';
header.renderTpl.tpls[0].body = '{template-card owner/image els}';

header.initialConfig.renderTpl.html = '{template-card owner/image els}';
header.initialConfig.renderTpl.master.body = '{template-card owner/image els}';
header.initialConfig.renderTpl.tpls[0].body = '{template-card owner/image els}'; 
```

我不太明白从模板中删除元素时它们是如何呈现的。我不知道指定元素的任何其他位置。

CSS 根本没有出现在开发人员工具中，这很奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T21:03:39.137

用 CSS 删除它应该可以正常工作。有两个单独的类，.cardOwner 和 .cardOwnerName，需要将显示设置为无。

```
.cardOwner, 
.cardOwnerName {
    display: none !important;
} 
```

# java - Java ExcelParser 示例导入 apache 错误

> ID：10984435
> 
> 赞同：-2
> 
> 时间：2012-06-11T16:58:32.717
> 
> 标签：java, apache, import

在我的代码中，我面临 ap​​che 库丢失错误..

我将我的整个代码粘贴在下面..请帮助我找到解决方案...

```
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.*;

// Apache POI - HSSF imports
import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFDateUtil;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.poifs.filesystem.POIFSFileSystem;

public class ExcelParser {

    HSSFSheet m_sheet;
    int m_iNbRows;
    int m_iCurrentRow = 0;
    private static final String JAVA_TOSTRING =
 "EEE MMM dd HH:mm:ss zzz yyyy";

    public ExcelParser(HSSFSheet sheet)
    {
        m_sheet = sheet;
        m_iNbRows = sheet.getPhysicalNumberOfRows();
    }

    /* Returns the contents of an Excel row in the 
form of a String array.
     * @see com.ibm.ccd.common.parsing.Parser#splitLine()
     */
    public String[] splitLine() throws Exception {
        if (m_iCurrentRow == m_iNbRows)
            return null;

        HSSFRow row = m_sheet.getRow(m_iCurrentRow);
        if(row == null)
        {
            return null;
        }
        else
        {
            int cellIndex = 0; 
            int noOfCells = row.getPhysicalNumberOfCells();
            String[] values = new String[noOfCells];        
            short firstCellNum = row.getFirstCellNum();
            short lastCellNum = row.getLastCellNum();

            if (firstCellNum >=0 && lastCellNum >=0) 
            {
                for(short iCurrent = firstCellNum; iCurrent <lastCellNum; iCurrent++) 
            {
                    HSSFCell cell = (HSSFCell)row.getCell(iCurrent);
                    if(cell == null)
                    {
                        values[iCurrent] = "";
                        cellIndex++;                
                        continue;
                    }
                    else
                    {
                        switch(cell.getCellType())
                        {                           
                        case HSSFCell.CELL_TYPE_NUMERIC:
                        double value = cell.getNumericCellValue();
                        if(HSSFDateUtil.isCellDateFormatted(cell)) 

                        {
                            if(HSSFDateUtil.isValidExcelDate(value))
                            {
                                Date date = HSSFDateUtil.getJavaDate(value);
                                SimpleDateFormat dateFormat = new SimpleDateFormat(JAVA_TOSTRING);  
                                values[iCurrent] = dateFormat.format(date);                             
                            }
                            else
                            {
                                throw new Exception("Invalid Date value found at row number " +
                                        row.getRowNum()+" and column number "+cell.getCellNum());   
                            }
                        }
                        else
                        {
                            values[iCurrent] = value + "";
                        }
                        break;

                        case HSSFCell.CELL_TYPE_STRING:
                            values[iCurrent] = cell.getStringCellValue();
                        break;

                        case HSSFCell.CELL_TYPE_BLANK:
                            values[iCurrent] = null;    
                        break;

                        default:
                            values[iCurrent] = null;    
                        }           
                    }                           
                }        
            }
            m_iCurrentRow++;
            return values;              
        }

    }

   public static void main(String args[])
   {
       HSSFWorkbook workBook = null; 
       File file  = new File("/home/sprasad/austin_api/Book1.xls");
       InputStream excelDocumentStream = null;
       try 
       {
           excelDocumentStream = new FileInputStream(file);
           POIFSFileSystem fsPOI = new POIFSFileSystem(new BufferedInputStream(excelDocumentStream));
           workBook = new HSSFWorkbook(fsPOI);         
           ExcelParser parser = new ExcelParser(workBook.getSheetAt(0));
           String [] res;
            while ((res = parser.splitLine()) != null)
            {
                            for (int i = 0; i < res.length; i++)
                {
                    System.out.println("Token Found [" + res[i] + "]");
                }
            }
            excelDocumentStream.close();

        }
        catch(Exception e)
        {
            e.printStackTrace();
        }

   } 
```

上面的示例在我使用此代码时遇到错误..

请向我推荐任何相同的图书馆或教程..提前谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:16:53.830

只需下载[Apache POI](http://www.apache.org/dyn/closer.cgi/poi/release/bin/poi-bin-3.8-20120326.tar.gz)，将其添加到您的类路径中并检查它是否正常工作。

如果您使用的是 Eclipse，只需右键单击项目 > 属性 > Java 构建路径 > 库，然后单击添加外部 JAR。

应添加以下 JAR：

*   poi-3.8-20120326.jar
*   poi-examples-3.8-20120326.jar
*   poi-excelant-3.8-20120326.jar
*   poi-ooxml-3.8-20120326.jar
*   poi-ooxml-schemas-3.8-20120326.jar
*   poi-scratchpad-3.8-20120326.jar

在此之后，您应该能够使用项目类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:12:05.403

如果您有`import`错误，那么您可能忘记在您的[Java 类路径](http://en.wikipedia.org/wiki/Classpath_%28Java%29)中包含您正在使用的 3rd 方库。假设您的 Apache 库有一堆 JAR 文件，您需要将它们包含在应用程序的类路径中，如我提供的 Wikipedia 链接中所述。

或者，您可能正在尝试导入当前库集中不存在的过时或无效的类。

除非您发布错误消息并提及您正在使用*哪些*库文件以及您如何启动应用程序，否则我们无法提供更具体的帮助。

# visual-studio-2010 - 如何使用构建操作“内容”将文件复制到项目中

> ID：10984436
> 
> 赞同：0
> 
> 时间：2012-06-11T16:58:40.377
> 
> 标签：visual-studio-2010, msbuild-4.0

我们有在 VS2010 之外创建的内容（文件/文件夹）。使用项目的“BeforeBuild”，我可以将临时目录中的文件导入到项目的相同目录结构中。导入后，我们如何告诉 VS2010 IDE 将 Build Action 识别为“内容”？在 VS2010 IDE 中，宏“包含在项目中”会为您执行此操作。它与指定文件的元数据有什么关系吗？这是我到目前为止...

```
 <Target Name="BeforeBuild" Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' " DependsOnTargets="ImportProperties;CustomImportsTarget" />
  <Target Name="ImportProperties">
    <PropertyGroup>
      <ImportSrcPath>$(temp)\$(MSBuildProjectName)\Imports</ImportSrcPath>
      <!-- File to save project references to -->
      <ImportLogFile>$(ImportSrcPath)\ImportResults.txt</ImportLogFile>
    </PropertyGroup>
  </Target>
  <Target Name="ImportLogger">
    <Delete Files="$(ImportLogFile)" />
    <WriteLinesToFile File="$(ImportLogFile)" Lines="Import Results%09============" />
  </Target>
  <Target Name="CustomImportsTarget" Condition="Exists('$(ImportSrcPath)')" DependsOnTargets="ImportLogger">
    <!--
        ==============================================================
        Allows for dynamically created content (files/folders) to be imported from our temp directory to our project's same
        directory structure as "Compile Include content"
        i.e. move %temp%\scripts\1.1.0\sample.js to <project>\scripts\1.1.0\sample.js
        ==============================================================
        -->
    <Message Text="==============================================================%0aCustomImportsTarget Begin%0a==============================================================" />
    <!-- Create an Item list that contains the files to import. $(ImportSrcPath) is the property that contains the location where 
            import source files are placed. -->
    <CreateItem Include="$(ImportSrcPath)\**\*" Exclude="$(ImportLogFile)">
      <Output TaskParameter="Include" ItemName="Files2Import" />
    </CreateItem>
    <!-- For testing purposes, Copy the files into our project. TODO:Should be a Move operation so project file modified dates are not constantly changing.  -->
    <Copy SkipUnchangedFiles="false" SourceFiles="@(Files2Import)" DestinationFolder="$(MSBuildProjectDirectory)\%(Files2Import.RecursiveDir)">
      <Output TaskParameter="CopiedFiles" ItemName="Changed" />
    </Copy>
    <!-- Imported files are now located in our project folders, 
        How do we assign properties to the files in @(Changed) so VS2010 IDE recognizes Build Action as "Content"???
        In VS2010 IDE, the macro "Include in Project" does this for you. Does it have anything to do with specifying a file's MetaData???
        -->
    <!-- Now send these values to the logger -->
    <Message Text="Changed:@(Changed->'%(Filename)%(Extension)')" Importance="high" />
    <Message Text="Script:@(Files2Import->'%(Filename)%(Extension)')" Importance="high" />
    <!--<Message Text="MSBuildProjectDirectory:$(MSBuildProjectDirectory)" Importance="high" />-->
    <Message Text="==============================================================%0aCustomImportsTarget End%0a==============================================================" />
  </Target> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:05:23.393

我认为您不能在同一项目的 BeforeBuild 步骤中更改项目。即使有可能，这听起来也不是一个好主意。

即使文件还没有，您也可以提前将这些文件添加到项目文件中。如果您不知道名称 - 只需使用 *.cs 之类的通配符。当构建开始时，它将使用您刚刚在预构建步骤中复制/创建的文件。

# c++ - 如何使用 CMake 检测编译器对 C++11 的支持

> ID：10984442
> 
> 赞同：83
> 
> 时间：2012-06-11T16:59:40.937
> 
> 标签：c++, c++11, cmake

有没有办法让 CMake 自动检测编译器是否支持 C++11？

因为最好在 CMake 运行期间通知用户代码将无法编译，因为编译器不支持 C++11。目前我设置了 C++11 标志。但是，如果编译器不支持它，则用户会在 CMake 运行期间收到编译错误而不是错误。

完美会像`find_package()`. 但是，我还没有找到任何提供所需功能的模块或功能。

另外，如果能够检测编译器是否需要标志`std=c++0x`或`std=c++11`.

有什么可用的，或者我需要自己开发吗？

下面是我目前使用的一些代码，但它只适用于 GNU'c GCC 编译器。如果有更通用的解决方案，那就太好了。

```
if(CMAKE_COMPILER_IS_GNUCXX)
   execute_process(COMMAND ${CMAKE_C_COMPILER} -dumpversion OUTPUT_VARIABLE GCC_VERSION)
   if (GCC_VERSION VERSION_GREATER 4.7 OR GCC_VERSION VERSION_EQUAL 4.7)
        message(STATUS "C++11 activated.")
        add_definitions("-std=gnu++11")
   elseif(GCC_VERSION VERSION_GREATER 4.3 OR GCC_VERSION VERSION_EQUAL 4.3)
        message(WARNING "C++0x activated. If you get any errors update to a compiler which fully supports C++11")
        add_definitions("-std=gnu++0x")
   else ()
        message(FATAL_ERROR "C++11 needed. Therefore a gcc compiler with a version higher than 4.3 is needed.")   
   endif()
else(CMAKE_COMPILER_IS_GNUCXX)
   add_definitions("-std=c++0x") 
endif(CMAKE_COMPILER_IS_GNUCXX) 
```

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2013-11-23T17:02:25.393

如果您有 CMake 3.1.0 或更高版本，您可以检测您的 C++ 编译器支持的 C++ 功能

```
cmake_minimum_required(VERSION 3.1.0 FATAL_ERROR)
project(foobar CXX)
message("Your C++ compiler supports these C++ features:")
foreach(i ${CMAKE_CXX_COMPILE_FEATURES})
  message("${i}")
endforeach() 
```

但通常您不需要在 CMake 脚本中使用 CMake 变量**CMAKE_CXX_COMPILE_FEATURES**。相反，有两种方法可以告诉 CMake 您的 C++ 文件应该在哪个 C++ 标准下编译，通过明确指定 C++ 标准或通过指定所需的 C++ 功能并让 CMake 引入 C++ 标准。CMake 将确保使用正确的命令行标志（例如 -std=c++11）调用 C++ 编译器。

## 1.明确指定C++标准

您可以通过为您的 CMake 目标设置 CMake 属性[**CXX_STANDARD**](http://www.cmake.org/cmake/help/v3.1/prop_tgt/CXX_STANDARD.html) 和 [**CXX_STANDARD_REQUIRED**](http://www.cmake.org/cmake/help/v3.1/prop_tgt/CXX_STANDARD_REQUIRED.html)来明确指定 C++ 标准 。

```
$ cat /tmp/src/CMakeLists.txt
project(foobar CXX)
cmake_minimum_required(VERSION 3.1.0 FATAL_ERROR)
add_executable(prog main.cc)
set_property(TARGET prog PROPERTY CXX_STANDARD 11)
set_property(TARGET prog PROPERTY CXX_STANDARD_REQUIRED ON)
$ cat /tmp/src/main.cc
int main() {
  return 0;
}
$ mkdir /tmp/build
$ cd /tmp/build
$ cmake /tmp/src
-- The CXX compiler identification is GNU 4.8.2
-- Check for working CXX compiler: /usr/bin/c++
-- Check for working CXX compiler: /usr/bin/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done
-- Generating done
-- Build files have been written to: /tmp/build
$ make VERBOSE=1 | grep main.cc | grep -- "-c"
/usr/bin/c++    -std=gnu++11 -o CMakeFiles/prog.dir/main.cc.o -c /tmp/src/main.cc
$ 
```

## 2.指定需要的C++特性，让CMake引入C++标准

您可以使用 CMake 命令[**target_compile_features**](http://www.cmake.org/cmake/help/v3.1/command/target_compile_features.html)指定在 CMake 目标中使用的 C++ 功能。从这个列表中，CMake 将引导使用 C++ 标准。CMake 全局属性[**CMAKE_CXX_KNOWN_FEATURES**](http://www.cmake.org/cmake/help/v3.1/prop_gbl/CMAKE_CXX_KNOWN_FEATURES.html)列出了您可以选择的 C++ 功能。

```
cmake_minimum_required(VERSION 3.1.0 FATAL_ERROR)
message("Your CMake version supports these C++ features:")
get_property(known_features GLOBAL PROPERTY CMAKE_CXX_KNOWN_FEATURES)
foreach(i ${known_features})
  message("${i}")
endforeach() 
```

例如，这个文件**名为 main.cc**的 C++ 程序利用了 C++11 的特性： **cxx_strong_enums**、**cxx_constexpr**、**cxx_auto_type**

```
#include <cstdlib>

int main(int argc, char *argv[]) {
  enum class Color { Red, Orange, Yellow, Green, Blue, Violet };
  constexpr float a = 3.1415f;
  auto b = a;
  return EXIT_SUCCESS;
} 
```

这个 CMakeLists.txt 文件将构建它

```
cmake_minimum_required(VERSION 3.1.0 FATAL_ERROR)
project(foobar CXX)
add_executable(foobar main.cc)                                                                                                                                                                                                                                                     
set(needed_features
    cxx_strong_enums
    cxx_constexpr
    cxx_auto_type)
target_compile_features(foobar PRIVATE ${needed_features}) 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-06-12T20:50:12.460

在这一点上，CMake 还没有一个方便的形式来支持 C++11。理想情况下，您会像这样指定一个 C++11 项目：

```
project(foo CXX11) 
```

在你的开头`CMakeLists.txt`。但`CXX11`项目类型不存在（尚）。在此之前，您可以使用两阶段技术：

1.  确定编译器类型和版本
2.  相应地调整构建标志。

例如，这是我用 Clang 和 GCC 来支持 C++11 的：

```
# Initialize CXXFLAGS.
set(CMAKE_CXX_FLAGS                "-Wall -std=c++11")
set(CMAKE_CXX_FLAGS_DEBUG          "-O0 -g")
set(CMAKE_CXX_FLAGS_MINSIZEREL     "-Os -DNDEBUG")
set(CMAKE_CXX_FLAGS_RELEASE        "-O4 -DNDEBUG")
set(CMAKE_CXX_FLAGS_RELWITHDEBINFO "-O2 -g")

# Compiler-specific C++11 activation.
if ("${CMAKE_CXX_COMPILER_ID}" MATCHES "GNU")
    execute_process(
        COMMAND ${CMAKE_CXX_COMPILER} -dumpversion OUTPUT_VARIABLE GCC_VERSION)
    if (NOT (GCC_VERSION VERSION_GREATER 4.7 OR GCC_VERSION VERSION_EQUAL 4.7))
        message(FATAL_ERROR "${PROJECT_NAME} requires g++ 4.7 or greater.")
    endif ()
elseif ("${CMAKE_CXX_COMPILER_ID}" MATCHES "Clang")
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -stdlib=libc++")
else ()
    message(FATAL_ERROR "Your C++ compiler does not support C++11.")
endif () 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-02T16:28:22.160

在撰写本文时[（GCC 4.8 之前）](https://stackoverflow.com/questions/13383124/g-std-c0x-and-compatibility)，检测 C++11 标志并添加它们可能不是一个好主意。这是因为更改标准（至少对于 GCC）[会破坏 ABI 兼容性](http://gcc.gnu.org/wiki/Cxx11AbiCompatibility)，从而导致链接错误。

[因此，在项目的初始 CMake 配置](http://www.cmake.org/Wiki/CMake_FAQ#I_change_CMAKE_C_COMPILER_in_the_GUI_but_it_changes_back_on_the_next_configure_step._Why.3F)期间，应使用编译器设置明确指定 C++11 标准的使用，例如

`CXX='g++ -std=c++11' cmake /path/to/source`

即 -std=c++11 的使用应被视为单独的编译器，不应在项目中混合或更改。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-09-14T07:17:24.313

采用：

```
include(CheckCXXCompilerFlag)
CHECK_CXX_COMPILER_FLAG("-std=c++11" COMPILER_SUPPORTS_CXX11)
CHECK_CXX_COMPILER_FLAG("-std=c++0x" COMPILER_SUPPORTS_CXX0X)
if(COMPILER_SUPPORTS_CXX11)
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++11")
elseif(COMPILER_SUPPORTS_CXX0X)
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++0x")
else()
    message(FATAL_ERROR "Compiler ${CMAKE_CXX_COMPILER} has no C++11 support.")
endif() 
```

这是来自*[在 CMake 中启用 C++11 (C++0x) 并](http://www.guyrutenberg.com/2014/01/05/enabling-c11-c0x-in-cmake/)*进行了细微更改。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-11-04T15:43:12.877

如果您使用的是 CMake 3.8 或更高版本，则可以使用`cxx_std_11`要求*C++11 或更高*版本的功能：

```
target_compile_features(Hello PUBLIC cxx_std_11) 
```

* * *

在 CMake 3.1* 和更新版本中，正确、简单的方法是使用`CXX_STANDARD`给定目标的属性。例如，给定这个使用`auto`(named `main.cpp`) 的简单示例：

```
#include <iostream>

int main() {
    auto num = 10;
    std::cout << num << std::endl;
    return 0;
} 
```

以下`CMakeLists.txt`将启用 C++11 支持：

```
cmake_minimum_required(VERSION 3.3)
project(Hello CXX)

set(SOURCE_FILES main.cpp)
add_executable(Hello ${SOURCE_FILES})

set_property(TARGET Hello PROPERTY
    CXX_STANDARD 11
    CXX_STANDARD_REQUIRED ON
) 
```

这将添加任何必要的标志，例如`-std=c++11`. 请注意，该`CXX_STANDARD_REQUIRED`属性将防止标准衰减到早期版本。

* * *

指定您使用的另一种正确但不那么简单的方法`CMAKE_CXX_KNOWN_FEATURES`，例如`cxx_auto_type`：

```
cmake_minimum_required(VERSION 3.3)
project(Hello CXX)

set(SOURCE_FILES main.cpp)
add_executable(Hello ${SOURCE_FILES})
target_compile_features(Hello PRIVATE cxx_auto_type) 
```

* * *

[* 我没有在 CMake 3.1 上尝试过，但已经验证它在 CMake 3.3 中有效。[3.1](https://cmake.org/cmake/help/v3.1/prop_tgt/CXX_STANDARD.html)的文档确实记录了这一点，因此它应该可以工作。]

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-14T11:30:35.623

我们编写了一个用于检测和启用 C++11 支持的 CMake 模块，您可以在此处找到它：
[https ://github.com/NitroShare/CXX11-CMake-Macros](https://github.com/NitroShare/CXX11-CMake-Macros)

它仍在进行中，但我们正在将它用于许多针对 Windows/Linux/Mac 的 Qt 项目。目前仅支持 MSVC++、GCC 和 Clang。

**例子：**

```
include(CXX11)

check_for_cxx11_compiler(CXX11_COMPILER)

# If a C++11 compiler is available, then set the appropriate flags
if(CXX11_COMPILER)
    enable_cxx11()
endif() 
```

# java - Android - 对话框 onResume？

> ID：10984448
> 
> 赞同：0
> 
> 时间：2012-06-11T17:00:04.283
> 
> 标签：java, android, dialog

我有一个动作发生在`Dialog`. 该操作启动另一个应用程序，导致我`onActivityResult`进入`Activity`. 现在，我希望在收到结果时发生特殊的“事情”，但在`Dialog`. 是否有类似`onResume`或`onActivityResult`但用于对话框的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:09:14.823

是的。你可以创建一个 Activity 并给它一个 Dialog 主题。它就像一个活动一样工作，但看起来像一个对话框。

只需添加这个

```
<activity android:theme="@android:style/Theme.Dialog" /> 
```

如果你不想走这条路，你也可以使用消息处理程序。这样，您就可以将消息从任何地方发送到任何地方。

这是一个体面的职位。 [http://idlesun.wordpress.com/2010/12/12/android-handler-and-message-tutorial/](http://idlesun.wordpress.com/2010/12/12/android-handler-and-message-tutorial/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:05:55.323

您可以将您包装`Dialog`在 中`Activity`，创建一个变量来容纳您的`Dialog`，然后在`onCreate()`for 中`Activity`，构建实际`Dialog`和`show()`它。当`Activity`收到结果时，它可以`Dialog`通过变量名引用并调用任何必要的方法。

# microsoft-reporting - 在 Microsoft 报告中的列表内添加表格

> ID：10984451
> 
> 赞同：1
> 
> 时间：2012-06-11T17:00:21.013
> 
> 标签：microsoft-reporting

当我在 Microsoft 报告中的列表控件中添加表格时出现错误。错误消息是“tablix 'Tablix1' 有一个带有内部成员的详细信息成员。详细信息成员只能包含静态内部成员。”

如何在列表中添加表格？

# c# - 比较两个数据表在 C# 中的差异？

> ID：10984453
> 
> 赞同：6
> 
> 时间：2012-06-11T17:00:27.367
> 
> 标签：c#, linq, datatable

> **可能重复：**
> [C#，如何比较两个数据表 A + B，如何显示 B 中但不在 A 中的行](https://stackoverflow.com/questions/164144/c-how-to-compare-two-datatables-a-b-how-to-show-rows-which-are-in-b-but-not)

我需要比较 c# 中的两个数据表以找出差异。这两个数据表具有相同的架构。最好的方法是什么？可以使用 linq 查询来完成吗？如果是，如何？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-11T17:13:10.767

您可以使用 LINQ 连接这两个`DataTable`对象，匹配每一列。然后取`IQueryable`并找出前两个`DataTable`对象中所有不在 中的行`IQueryable`。

**示例**：

```
private void SampleSolution(DataTable dt1, DataTable dt2)
{
    //If you have primary keys:
    var results = from table1 in dt1.AsEnumerable()
                    join table2 in dt2.AsEnumerable() on table1.Field<int>("id") equals table2.Field<int>("id")
                    where table1.Field<int>("ColumnA") != table2.Field<int>("ColumnA") || table1.Field<int>("ColumnB") != table2.Field<int>("ColumnB") || table1.Field<String>("ColumnC") != table2.Field<String>("ColumnC")
                    select table1;
    //This will give you the rows in dt1 which do not match the rows in dt2\.  You will need to expand the where clause to include all your columns.

    //If you do not have primarry keys then you will need to match up each column and then find the missing.
    var matched = from table1 in dt1.AsEnumerable()
                    join table2 in dt2.AsEnumerable() on table1.Field<int>("ColumnA") equals table2.Field<int>("ColumnA")
                    where table1.Field<int>("ColumnB") == table2.Field<int>("ColumnB") || table1.Field<string>("ColumnC") == table2.Field<string>("ColumnC") || table1.Field<object>("ColumnD") == table2.Field<object>("ColumnD")
                    select table1;
    var missing = from table1 in dt1.AsEnumerable()
                    where !matched.Contains(table1)
                    select table1;
    //This should give you the rows which do not have a match.  You will need to expand the where clause to include all your columns.
} 
```

上面的代码应该可以工作，虽然我没有测试它。

您还可以查看[DataTable 上的 LINQ 查询，](https://stackoverflow.com/questions/10855/linq-query-on-a-datatable)其中包含一些关于将 LINQ 与 DataTables 一起使用的有用信息。
我还发现[LINQ 示例](http://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b)在编写 LINQ 时很有帮助。

# php - 在业务页面时间轴上发布

> ID：10984456
> 
> 赞同：0
> 
> 时间：2012-06-11T17:00:47.413
> 
> 标签：php, facebook-graph-api

我已经阅读了很多页面，但似乎无法找到正确的方式来发布到商业 Facebook 页面。我可以使用下面的代码发布到我的墙上，但不确定如何使用它发布到业务页面。

```
$user = $facebook->getUser();
$attachment = array(
    'message' => $_GET['message'],
);
// /me/feed/
$result = $facebook->api("/$user/feed/", 'GET', $attachment); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:10:51.430

如果每个人都分别。允许您的精确用户在他们的墙上发帖，然后只需在 API 调用中设置页面的 id 而不是 $user。

否则，您必须先获取[页面访问令牌](https://developers.facebook.com/docs/reference/api/page/#page_access_tokens)，然后在 API 调用中使用它。

# c - 如何在地图上随机放置物品？

> ID：10984459
> 
> 赞同：1
> 
> 时间：2012-06-11T17:00:58.597
> 
> 标签：c, random, map

在网上搜索后，我没有找到可以帮助我的答案。我的程序是 C 语言。

我有一个项目列表（例如：37 a、22 b、29 c、13 d、19 e、2 f 和 0 g），我必须将所有这些项目随机放置在地图上（在我的情况下，一个 int [高度][长度][7]）。我想使用 rand 来放置项目并循环直到放置整个项目，但它使用了太多的时间和资源。

有没有办法轻松正确地放置它们？

这是我的代码：

```
/* allocates the tab in order to place the ressources/items */
void            create_map(t_world *world)   
{
  unsigned int  x;
  unsigned int  y;

  x = 0;
  world->map = xmalloc(world->height * sizeof(int**));
  while (x < world->height)
    {
      y = 0;
      world->map[x] = xmalloc(world->lenght * sizeof(int*));
      while (y < world->lenght)
        {
          world->map[x][y] = xmalloc(7 * sizeof(int));
          bzero(world->map[x][y], 7);
          ++y;
        }
  ++x;
    }
}

/* base defining the number of required item */
t_elevation elevation_tab[] =
{
  {1, {0, 1, 0, 0, 0, 0, 0} },
  {2, {0, 1, 1, 1, 0, 0, 0} },
  {2, {0, 2, 0, 1, 0, 2, 0} },
  {4, {0, 1, 1, 2, 0, 1, 0} },
  {4, {0, 1, 2, 1, 3, 0, 0} },
  {6, {0, 1, 2, 3, 0, 1, 0} },
  {6, {0, 2, 2, 2, 2, 2, 1} }
};

/* calculates the number of item required */
unsigned int    *calc_elevation(t_world *world)
{
  unsigned int  i;
  unsigned int  pos;
  unsigned int  *tab;

  i = 0;
  tab = xmalloc(7 * sizeof(int));
  bzero(tab, 7);
  while (i < 7)
  {
    pos = 0;
    while (pos < 7)
    {
      tab[pos] += (world->population /
               elevation_tab[i].required_players +
               world->population %
               elevation_tab[i].required_players) *
        (elevation_tab[i].required_ressources[pos]);
      ++pos;
    }
  ++i;
  }
  return (tab);
}
void            place_ressources(t_world *world, unsigned int *ressources)
{
//here is my missing code
}

/*First called function*/
void            create_world(t_param *params, t_world *world)
{
  unsigned int  *ressources_needed;

  world->lenght = params->lenght;
  world->height = params->height;
  world->population = params->team_size * 2;
  create_map(world);
  ressources_needed = calc_elevation(world);
  place_ressources(world, ressources_needed);
  show_map(world);
  world->players = NULL;
  free(ressources_needed);
} 
```

世界是由用户决定的具有高度和长度的一定大小的网格。网格的每个案例都有一个 int[7] 传递每个项目的数量。所以我可以在同一个箱子上放置多个物品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:40:28.923

我可以想到 2 种可能的方法来解决这个问题，但这取决于需要处理多少项目。

我首先想到的是一个类似于如何在计算机程序中洗牌的解决方案。取第一个元素，随机生成 x,y 坐标。取下一个元素并生成 x, y 坐标。如果那里没有项目，则将项目放在该位置，否则生成新的 x，y 坐标。继续此操作以放置所有元素。

我能想到的另一件事是，如果你能以某种方式跟踪使用了哪些世界图块，那么随机生成的坐标就不会重复。

您的世界对象是 3d 数组这一事实是指数级增长的计算。绝对有必要吗？当然，我真的不知道你的程序是为什么背景设计的

# objective-c - Phonegap、Livecode 等 - 新手的利弊？我还应该学习Objective-C吗？

> ID：10984460
> 
> 赞同：3
> 
> 时间：2012-06-11T17:00:59.363
> 
> 标签：objective-c, livecode

似乎有很多针对 Objective-C 的“快速构建您的 iPhone 应用程序”的第 3 方解决方案，但不确定它们中的任何一个是否有优势。我正在通过教程学习 Objective-C 并创建示例应用程序。我觉得我在慢慢地学习，但尽管如此，我正在学习它。这些第 3 方解决方案是好是坏？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-09T01:32:01.173

如果您有兴趣在 iOS、android、Windows、OS X、x86 Linux 上部署相同的应用程序并可能对用户界面进行一些细微的调整，那么 LiveCode 是一个很好的解决方案……很快还会在 Windows 8 和 arm Linux 上进行。还有一个服务器端脚本选项，因此可以实现一个可跨多个平台使用的库。该平台现在也是开源的，本月将首次发布代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T18:28:14.880

这是一个“每个人都有自己”的世界，但我倾向于将 LiveCode 作为我的应用程序制作的一站式商店。正如前面提到的，有许多“快速创建一个糟糕的应用程序”的解决方案，但 LiveCode 努力使代码易于学习和使用，同时支持现代功能。使用较低级别的目标 C 并不适合所有人，但是当您需要一个尚不存在的功能时，您可以卷起袖子自己创建一个外部目标，或者联系 LC 社区。有一些专门提供出色的外部设备，例如 Monte。现在 LC 正在开源，引擎盖下的力量只会变得更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-09T02:36:03.153

我会远离快速构建坏应用程序的工具，但我有点偏见。

我唯一的第一手经验是使用 Titanium Appcelerator，但在那短暂的时间内，我不得不编写一个脚本来修补自动生成的项目源以解决崩溃问题（并且它需要是脚本或对 SDK 的修改，因为每次构建都会覆盖自动生成的代码）。UI API 远非易于使用，我发现问题非常难以调试，因为您的代码被转换为在解释器中运行的压缩 JavaScript blob，并且它在 JS 线程和主线程之间传递东西所跳过的令人难以置信的循环几乎排除了用任何缺失的功能扩展它。我*很*这里有偏见，因为这是一个项目恢复（具有讽刺意味的是，最初的开发人员最终以原生方式编写了 Android 版本，并且可能花费了更多时间来尝试制作“跨平台”版本而不是制作原生 iOS 版本）。

我听说过关于 PhoneGap 的好消息，*如果您需要的只是一个*偶尔在本机代码中完成的 web 视图（据报道，用于在 JS 和本机代码之间传递东西的 API 很好），但这是一个很大的“如果”——它可能如果您不关心“原生”用户界面，或者作为添加原生功能的起点，那也没关系。

谷歌搜索 PhoneGap 为 trigger.io 提供了一个广告；我在[示例页面](https://trigger.io/examples/)上测试了我可以使用的应用程序：

*   PlayerPro 的登录屏幕滚动（一个死的赠品），contentSize 太高了 20 像素，并且不使用原生 Facebook 登录。“使用 facebook 注册”按钮图像被拉伸，点击时不会发生明显变化。
*   Fanium 的登录屏幕按钮在点击时不会明显改变。当您按下登录按钮时，导航栏中的“按钮”会消失并重新出现。
*   Hojoki 的按钮不太对劲。登录页面垂直滚动，但只向一个方向滚动（而且它不需要！）。它不使用本机 Facebook 登录。
*   Fetchnotes 的介绍屏幕有左/右按钮（带有未对齐的箭头）可以滚动；你不能只是正常滚动。滚动动画不是原生的。登录/注册屏幕上的后退按钮显然不是原生的，并且太靠近屏幕左侧（所有非原生按钮通常看起来有点不合适）。用户名/电子邮件/密码字段太高。点击一个字段会在键盘顶部显示一个上一个/下一个/完成栏，就像 Safari 一样。在用户名字段中，返回键显示“Go”，点击它会导致错误消息出现*在*prev/next/done 栏后面（该栏是半透明的，但足够暗，用户甚至可能不会注意到它）而不是切换到下一个字段。
*   在所有应用程序中，非原生按钮响应触摸的时间都比原生按钮长（在键盘上方的 prev/next/done 栏或与附属 Facebook/Yahoo/Google 登录 webview 关联的“关闭”按钮上）。

这就是他们的“应用程序展示”，我什至没有走多远，因为我不太关心创建一次性帐户，因为他们不会为支持本机登录（至少对于 Facebook 存在）而烦恼。

当然，如果您不介意古怪的非本地应用程序，那是您的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-11T13:54:37.867

这只是我的观点，但无论是什么程序创建的，我都可以在任何地方发现嵌入在 iPhone 应用程序中的 HTML/Javascript 解决方案。我更喜欢为设备而不是网络设计的应用程序，并且适合设备。我的 2 美分。

HTML/Javascript 应用程序对我的主要优势是调整大小以适应大多数设备。

Livecode 应用程序对我的主要优势是能够完全匹配它所针对的设备。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-11T17:06:16.307

这取决于你想完成什么。

如果您想要跨平台的易用性，[Titanium Mobile 的 Appcelerator](http://www.appcelerator.com/)非常好，尤其是如果您已经了解 JavaScript。然而，就我个人而言，我从未发现这些工具的性能和可扩展性与 Objective-C 的工具一样强大，但它们确实具有跨平台的主要优势。

如果你想要一个只有 iOS 内容驱动的应用程序，[RareWire](http://content.rarewire.com)是一个很好的解决方案。它不需要 Mac，而且都是基于云的。我对 RareWire 唯一真正的问题是缺乏真正的处理能力和控制语句。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-11T17:11:52.117

如果您只针对 IOS，最好使用 Objective C 开发应用程序。但是，如果您针对多个移动平台，如 android、iphone、blackberry，您可以使用其他框架，如 phonegap、kony 等。

电话差距的优势 了解 HTML、javascript 和 CSS 就足够了。

基本 Luva 编码的 Kony Knowledge 的优势就足够了。

如果您正在开发 Web 应用程序，像 phonegap 这样的框架会更好，如果是原生应用程序，使用原生框架会更好。这是我的建议。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-11T19:55:27.103

两个主要原因：

1.  由于缺乏硬件加速导致的性能问题。
2.  您可以创建的应用程序类型缺乏灵活性。即仅受第 3 方支持的功能。而对于原生 Objective C，天空才是极限。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-26T18:12:29.047

任何开发平台的最大优势是最大化您随着时间的推移为相同的工作产生的收入。

使用 Objective-C 定位 iOS 可以让您定位 iPhone、iPod Touch、iPad 的用户。这里没有刻薄的话——您正在学习 C 的面向对象的派生词——仅适用于 Apple 设备的派生词（这里也不要忘记 Mac OS X，尽管您有更多选择）。

多平台（特别是 LiveCode）还打开了所有主要桌面（Windows、Linux、Mac OS X）和 Android 设备。IDE 不是 Web 应用程序，您可以非常非常快速地测试您的想法。

# java - 如何仅在第二位数字之后检查月份的正确性？

> ID：10984469
> 
> 赞同：2
> 
> 时间：2012-06-11T17:01:45.663
> 
> 标签：java, swing, date-format, simpledateformat, jformattedtextfield

我需要 JFormattedTextField 来格式化日期（“dd.MM.yy”）。代码：

```
SimpleDateFormat format= new SimpleDateFormat("dd.MM.yy");
DateFormatter formatter = new DateFormatter(format);
format.setLenient(false);
formatter.setAllowsInvalid(false);
formatter.setOverwriteMode(true);
JForemattedTextField inputText = new JFormattedTextField(formatter);
inputText.setValue(new Date()); 
```

问题是：例如，如果日期是“11/06/12”，如果我尝试在月份输入 12，我不能这样做，因为当我输入 1 时，它会将月份理解为 16 并且不给我输入下一个数字。我需要当我在月份位置键入例如 12 时，JFormattedTextField 将仅在我键入第二个数字后检查月份的正确性，如果不正确，月份将返回到以前的值。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:14:25.727

*   也许更好的是使用[JSpinner](http://docs.oracle.com/javase/tutorial/uiswing/components/spinner.html)和[DateSpinnerModel](https://stackoverflow.com/questions/9532663/formatting-the-date-on-a-jspinner/9532721#9532721)

*   你可以为[JFormattedTextField实现](http://docs.oracle.com/javase/tutorial/uiswing/components/formattedtextfield.html)[InputVerifier](http://docs.oracle.com/javase/tutorial/uiswing/misc/focus.html#inputVerification)

# python - numpy 字符数组到字符串

> ID：10984471
> 
> 赞同：9
> 
> 时间：2012-06-11T17:02:00.540
> 
> 标签：python, arrays, string, numpy, char

我有一个 2D numpy char 数组（来自 NetCDF4 文件），它实际上代表一个字符串列表。我想将其转换为字符串列表。

我知道我可以使用 join() 将字符连接成一个字符串，但我只能找到一种方法一次处理一个字符串：

```
data = np.array([['a','b'],['c','d']])
for row in data[:]:
    print ''.join(row) 
```

但这很慢。如何在单个命令中返回字符串数组？谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-11T17:37:24.057

列表理解是最“pythonic”的方式。

最“numpythonic”的方式是：

```
>>> data = np.array([['a','b'],['c','d']])
# a 2D view
>>> data.view('S2')
array([['ab'],
       ['cd']], 
      dtype='|S2')
# or maybe a 1D view ...fastest solution:
>>> data.view('S2').ravel()
array(['ab', 'cd'], 
      dtype='|S2') 
```

没有循环，没有列表理解，甚至没有副本。缓冲区只是以不同的“视图”保持不变，因此这是可用的最快解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T17:10:11.830

尝试列表理解：

```
>> s = [''.join(row) for row in data]
>> s
['ab', 'cd'] 
```

这只是你`for`重写的循环。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T19:00:09.073

```
[row.tostring() for row in data] 
```

# php - Shanty Mongo 连接组

> ID：10984472
> 
> 赞同：1
> 
> 时间：2012-06-11T17:02:01.530
> 
> 标签：php, zend-framework, mongodb

如何使用 Shanty_Mongo 动态连接到多个 mongodb？根据这里的文档：[https ://github.com/coen-hyde/Shanty-Mongo/wiki/connections](https://github.com/coen-hyde/Shanty-Mongo/wiki/connections)

这就是我写课程的方式

```
class User extends Shanty_Mongo_Document 
{
    protected static $_connectionGroup = 'users';
} 
```

如果我想使用相同的模型来写入/读取不同的数据库怎么办。我无法在构造函数中设置 connectionGroup，因为它是静态的。我如何在使用相同模型的不同 mongodb 之间切换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-20T08:19:29.197

在您的用户类中添加以下功能-

```
public static function _connectionGroup($connectionGroup){
     self::$_connectionGroup = $connectionGroup;
 } 
```

然后将其称为 user::_connectionGroup("your group");

# android - TrueType 字体不会保留在 libGDX 应用程序中

> ID：10984475
> 
> 赞同：2
> 
> 时间：2012-06-11T17:02:11.937
> 
> 标签：android, libgdx, truetype

我在我的 android 应用程序中使用 stb-truetype 库通过将 .ttf 文件转换为 BitmapFont 来将它们呈现到屏幕上。字体在应用程序的初始运行时呈现得非常好。但是，当我按下 Home 按钮并重新打开应用程序时（当我按下按钮时它会从停止的地方继续），程序会在每个字母应该出现的位置呈现白框。这是我用来生成 BitmapFont 的代码：

```
 font = TrueTypeFontFactory.createBitmapFont(Gdx.files.internal("fonts/Quadrats.ttf"), FONT_CHARACTERS, 75, 50, 5.65f, Gdx.graphics.getWidth(), Gdx.graphics.getHeight());
    font.setColor(1f, 0f, 0f, 1f);
    font.setColor(Color.WHITE);
    font.setScale(20 / (float)Gdx.graphics.getWidth(), 17 / (float)Gdx.graphics.getHeight()); 
```

`font`初始化时声明的 libGDX BitmapFont在哪里。

我怀疑问题与整个 Bundle savedInstanceState 事情有关，但我不确定我需要做什么才能使字体在重新打开活动时持续存在。有人有什么想法吗？

或者，是否有人知道将 ttf 转换为 BitmapFont 文件的方法，我可以简单地从我的应用程序中调用该文件，而无需包含 stb 库？

谢谢

# .htaccess - 如何 301 将 Domain1.com 重定向到 Domain1.NL 并排除 https://Domain.com

> ID：10984480
> 
> 赞同：1
> 
> 时间：2012-06-11T17:02:43.793
> 
> 标签：.htaccess, redirect, https

“我忙了一段时间现在解决以下问题：

我有一个带有 SSL 证书的[http://domain.com 。](http://domain.com)我想将此 domain.com 重定向到我的荷兰语 domain.nl。

但是：我还想避免/排除重定向（我需要用于 Facebook 应用程序的 SSL）或重定向 domain.com，除非

到目前为止，我已将此添加到我的 htacces 文件中：

```
RewriteCond %{HTTPS} !=on
RewriteCond %{HTTP_HOST} ^domain\.com$ [OR]
RewriteCond %{HTTP_HOST} ^www\.domain\.com$
RewriteRule ^(.*)$ http://domain.nl/$1 [R=301,L] 
```

感谢大家伸出援助之手。

问候

米歇尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T12:45:11.127

清除浏览器缓存并重新启动浏览器。

**通过**启用 mod_rewrite 和 .htaccess**`httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：**

 **```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com$ [NC]
RewriteRule ^ http://domain.nl%{REQUEST_URI} [R=302,L] 
```

一旦你确定它工作正常，将上述规则中的 302 更改为 301。**

# c++ - 从文件中读取，奇怪的结局

> ID：10984484
> 
> 赞同：2
> 
> 时间：2012-06-11T17:03:13.197
> 
> 标签：c++, printf, ifstream

我找到了一段代码，它给出了一个文本文件的大小：

```
ifstream file("xmlfile.xml",ios::in);
//get size
file.seekg (0, ios::end);
int length = file.tellg();
file.seekg (0, ios::beg);

// allocate memory:
char* buffer = new char [length];

// read data as a block:
file.read (buffer,length);
file.close();
buffer[length-1] = '\0';
printf("%s",buffer); 
```

问题是，我想阅读一个小的 xml 文件，可以完美地阅读它，但最后会留下许多“=”符号，因为我发现它们等于文件中 CR 的数量。将 EOL 切换到 Unix 解决了问题，但为什么在 Windows EOL 中打印会出现问题？

示例 xml：

```
<?xml version="1.0"?>
<catalog>

(EOL) 
```

以及 printf 打印的内容：

```
<?xml version="1.0"?>
<catalog>

══════ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:11:07.697

问题的出现是因为 Windows 在每行的末尾使用回车 + 换行字符，而 Linux 只使用其中一个。

您的 ifstream 以文本模式打开。它返回文本文件的绝对大小，但随后您指示它读取那么多*文本*字符。它似乎正在丢弃 Windows 不会自动使用的额外字符，并且您最终会读取文件末尾的内容。

为了纠正这个问题，可以使用 .gcount() 来获取读取的字符数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T17:17:16.663

有两个问题。

使用`seek`and`tell`获取文件大小将告诉您文件中有多少字节。光盘上的 Windows EOL 是两个字节。`read`但是，当您在以文本模式打开的文件上读取它时，EOL 将成为内存中的一个字节。您可以通过以二进制模式打开文件来解决此问题，如下所示：

```
ifstream file("xmlfile.xml",ios::in | ios::binary); 
```

另一个问题是，如果要将文件的内容视为空终止字符串，则需要为空终止符分配额外的空间。就目前而言，您正在用 NULL 覆盖文件的最后一个字节。你应该做这个：

```
char* buffer = new char [length+1]; 
```

和

```
buffer[length] = '\0'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T17:10:59.113

如果我正确理解发生了什么，`tellg`会告诉您*以 bytes 为单位*的位置，但在读取期间，Windows 行尾将转换为纯`'\n`'; 正因为如此，所指的位置`buffer[length]`是在“丢失” CR 数量的“真实”结尾之后。

为了避免这个问题，读取文件后调用`file.gcount()`获取上次读取时读取的字符数，并将其作为终止缓冲区的位置。

# c++ - 用于增强现实的 OpenCV 相机内在矩阵到 Ogre 投影矩阵

> ID：10984486
> 
> 赞同：3
> 
> 时间：2012-06-11T17:03:17.823
> 
> 标签：c++, opencv, camera, augmented-reality, ogre

我使用*Ogre* + *OpenCV*编写了一个简单的增强现实应用程序。一切正常，但我需要将 Ogre 的虚拟相机与我的真实相机相匹配

我不知道相机参数（这是一个便宜的网络摄像头，供应商没有提供它们）。我可以使用`cvCalibrateCamera2`（在[此处](http://dasl.mem.drexel.edu/~noahKuntz/openCVTut10.html)`cvFindChessboardCorners`描述的一些之后）获得相机内在属性，并使用.`cvSave`

```
cvCalibrateCamera2(objectPoints_, imagePoints_, pointCounts_,
        imageSize, cameraMatrix, distortionCoeffs_, NULL,
        NULL, CV_CALIB_FIX_ASPECT_RATIO );
cvSave(INTRINSIC_XML, intrinsicMatrix_); 
```

AR 应用程序加载内在矩阵：

```
CvMat* intrinsic = (CvMat*) cvLoad(INTRINSIC_XML); 
```

`intrinsic->data.db`一个指向 9 长度的双精度数组（3x3 矩阵）的指针也是如此，我
如何将其转换为`Ogre::Matrix4`可以与`setCustomProjectionMatrix`.

我在[Ogre 的论坛](http://www.ogre3d.org/forums/viewtopic.php?f=5&t=22584&p=214518#p214518)中找到了一些东西，但这不起作用。我猜在 OpenCV 找到的 3x3 矩阵和`Ogre::Camera`.

我希望有一些方法可以使用`cvCalibrateCamera2`. 如果没有，我需要拿一把尺子和一个量角器并（大致）手动获取参数。

这是 3x3 “内在”矩阵：

```
836.391     0.000   460.430 
  0.000   836.391   281.440
  0.000     0.000     1.000 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T10:43:11.577

如下创建投影矩阵。

垫子[0,0] = fx

垫[1,1] = fy

垫子[2,2] = +- .01

垫子[3,2] = +- 1

垫[3,3] = 0

其中 fx = 内在 [0] / imageSize.Width;

fy = 内在 [1*3 + 1] / imageSize.Height;

尝试 mat[2,2] 和 mat[3,2] 的负值和正值组合。

通常两者都有负值。其他参数可以忽略

# javascript - href jQuery Colorbox问题

> ID：10984489
> 
> 赞同：1
> 
> 时间：2012-06-11T17:03:42.810
> 
> 标签：javascript, jquery, asp.net, colorbox, href

我正在尝试让 ColorBox iFrame 窗口从页面中弹出。我成功地将它从页面中弹出，但它几乎立即消失了。我无法让它在我的一生中停留在页面上，更不用说在窗口关闭之前在窗口中加载任何内容了。

这是我所拥有的：

```
 <script type="text/javascript">
    function OpenCBox() 
    {
        $.colorbox({href:"http://www.cnn.com", iframe: true, width: "80%", height: "80%", transition: "elastic"});
    }
</script> 
```

这是我的 JavaScript 函数，它调用执行操作的 OpenCBox()。

这将弹出窗口大约 0.2 秒，然后立即消失。不明白发生了什么。

```
 <asp:Button ID="NewRecordBTN" runat="server" Text="New Material Movement Request" 
        OnClientClick="OpenCBox()" /> 
```

我把自己逼疯了，无法弄清楚这一点。任何帮助都会很棒！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T19:05:57.807

我采用了上述解决方案，即在其中添加纯 HTML 按钮而不是 ASP.NET 按钮，因为正在触发自动回发。

```
<script type="text/javascript">
    function OpenCBox() 
    {
        $.colorbox({href:"NewMMR.aspx", iframe: true, width: "50%", height: "50%", transition: "elastic"});
    }
</script> 
```

此功能将带我到 ColorBox 窗口中的“NewMMR.aspx”。

而不是使用上面的 asp:button，我使用了以下内容：

```
 <input id="NewRecordBTN" type="button" onclick="OpenCBox()"
value="New Material Move Request" /> 
```

这解决了问题，因为普通的 HTML 按钮不会导致自动回发。希望有一天这可以帮助别人。

# c++ - 替代 popen 管道执行程序并读取输出

> ID：10984490
> 
> 赞同：2
> 
> 时间：2012-06-11T17:03:52.493
> 
> 标签：c++, popen

**请建议`popen()`执行 shell 命令然后读取输出的好方法。**

**编辑：**替代方案必须没有`fork()`电话。因为我的服务器已经占用了太多内存。然后`ffmpeg`还需要增加内存和进程大小！`fork()`我每次都会把问题放到内存权重服务器上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T18:13:50.497

如果你担心fork时会复制父进程的内存，那么你需要使用[`vfork()`](http://www.kernel.org/doc/man-pages/online/pages/man2/vfork.2.html)-特殊版本的“fork”，它不会复制父进程的内存，但需要fork的进程立即发出`execve()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:17:52.777

我在学校是这样教的：

```
int main(int argc, char *argv[]) {

    int pipefd[2];
    pid_t cpid;
    char buf;

    if (pipe(pipefd) == -1) {
        perror("pipe");
        exit(EXIT_FAILURE);
    }

    cpid = fork();
    if (cpid == -1) {
        perror("fork");
        exit(EXIT_FAILURE);
    }

    if (cpid == 0) {
        /* Child reads from pipe */
        close(pipefd[1]);

        //make the standard input to be the read end
        pipefd[0] = dup2(pipefd[0], STDIN_FILENO);

        system("more");

        write(STDOUT_FILENO, "\n", 1);
        close(pipefd[0]);

    } else {

        /* Parent writes argv[1] to pipe */
        close(pipefd[0]);
        /* Close unused read end */

        pipefd[1] = dup2(pipefd[1], STDOUT_FILENO);

        system("ps aux");
        /* Wait for child */
        wait(NULL);
        exit(EXIT_SUCCESS);
    }

    return 0;
} 
```

这会产生两个进程，一个执行“ps aux”并将输出提供给另一个运行“more”的进程。

# r - 如何使用 R 的 clusplot 为不同集群中的观察点分配不同的颜色

> ID：10984497
> 
> 赞同：1
> 
> 时间：2012-06-11T17:04:59.710
> 
> 标签：r

[http://stat.ethz.ch/R-manual/R-devel/library/cluster/html/clusplot.default.html](http://stat.ethz.ch/R-manual/R-devel/library/cluster/html/clusplot.default.html)上的 R 文档并没有完全帮助我。代码：

```
somedata = read.data("somefile.tsv")
clustered = kmeans(somedata, 5)
library(cluster)
clusplot(somedata, clustered$cluster, cex=0.1, ..??whatshouldgohere??..) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T17:23:22.173

使用`col.p`参数：

```
clusplot(somedata, clustered$cluster, cex=1, col.p=clustered$cluster) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T07:00:23.683

您可以使用上面大卫已经说过的 col.p 参数：

```
clusplot(somedata, clustered$cluster, cex=1.0, col.p=c ("steelblue", "darkred", "darkgreen")) 
```

这将从列表中指定的颜色为您的观察点分配不同的颜色。

检查这个：

```
data(iris)
iris.x <- iris[, 1:4]
cl3 <- pam(iris.x, 3)$clustering
op <- par(mfrow= c(2,2))
clusplot(iris.x, cl3, color = TRUE, cex=0.7, col.p=c ("steelblue", "darkred", "darkgreen")) 
```

# memory-leaks - 来自 CreateObject 的 VB6 内存泄漏

> ID：10984502
> 
> 赞同：0
> 
> 时间：2012-06-11T17:05:23.417
> 
> 标签：memory-leaks, vb6, createobject

我正在使用一个永恒库（DLL）以某种文件格式加载，并发现加载函数实际上并没有加载。它会在第一次为同一个对象调用时加载，但如果我再次调用它来打开一个新文件，它并不总是加载。这迫使我每次想加载新文件时都调用 CreateObject。问题在于 VB6 似乎根本没有释放旧对象，并且 RAM 和 VM 使用量迅速膨胀到 GB。

有没有办法强制它释放？将变量设置为“Nothing”或“Null”不会做任何事情，并且应用程序会膨胀得如此之多，以至于实际上会耗尽内存并崩溃。（我必须在 VM 中运行它，因为 IDE 太旧了，无法在 Win7 上运行，我无法让它运行）

我已经寻找循环引用，但没有，文件是使用该对象加载的，文件的属性被读入 ADO 对象，实际文件本身从未被引用到 ADO 对象中，只是各种字段从中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T03:06:16.853

无论您在 VB6 项目中有直接引用还是使用“CreateObject”实例化对象引用都无关紧要。如果第三方组件有内存泄漏，无论哪种方式，您都会遇到相同的行为。

如果要实例化非托管资源，则需要调用“Dispose”。除此之外，当方法调用完成并且 Visual Basic 运行时将清理引用（使用引用计数）时，对象实例将“超出范围”。如果第三方组件确实存在内存泄漏，您需要让他们修补 DLL，因为您无法阻止它。

# .net - 在应用程序配置中找不到连接名称“LocalSqlServer”或连接字符串为空

> ID：10984507
> 
> 赞同：7
> 
> 时间：2012-06-11T17:05:52.010
> 
> 标签：.net, visual-studio-2010, iis, windows-7, .net-4.0

所以昨天我在我的开发机器上安装了 PHP 和 MySQL。从那时起，我在尝试运行我的一个 .NET 项目时收到以下错误：

在应用程序配置中找不到连接名称“LocalSqlServer”或连接字符串为空。

它引用了 Machine.Config 的这一行：

```
<add name="AspNetSqlRoleProvider" connectionStringName="LocalSqlServer" applicationName="/" type="System.Web.Security.SqlRoleProvider, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" /> 
```

我在网上搜索过，高低都可以确认我的machine.config有必要的连接字符串：

```
 <connectionStrings>
<add name="LocalSqlServer" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient" />
<add name="LocalMySqlServer" connectionString="" /> 
```

有趣的是，我在生产服务器（服务器 2008）上执行了完全相同的安装 PHP 和 MySQL 的操作，并且没有问题。我的开发机器是 Windows 7。

因此，我的整个开发机器都坏了。如何修复 machine.config 或修复它并解决此问题？有谁之前经历过这个吗？

小块

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-11T17:34:11.397

也许某处有一个 web.config 包含：

```
<connectionStrings>
    <clear/>
    ...
</connectionStrings> 
```

您可能还需要仔细检查您是否正在查看正确的 machine.config。每个框架版本都有单独的 machine.config，对于 32 位和 64 位框架也有单独的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-21T20:06:21.480

`<clear />`由于各种原因，我需要保留在连接字符串的顶部，虽然添加一个名为的虚拟连接字符串的解决方案`LocalSqlServer`有效，但我发现保留它很麻烦，原因是“我不知道为什么我们需要它，但没有它，应用程序将无法运行”。

我的解决方案是删除`roleManager`下面的行，因为它是旧代码遗留下来的，不再需要了。

```
<system.web>
    <roleManager enabled="true" defaultProvider="AspNetWindowsTokenRoleProvider" />
</system.web> 
```

# php - CakePHP 从结果与集合组合关联数组

> ID：10984510
> 
> 赞同：0
> 
> 时间：2012-06-11T17:06:07.737
> 
> 标签：php, cakephp, cakephp-1.3, associative-array

如何使用 set combine 制作关联数组？

我已经设法通过合并来创建一个带有索引的数组，我只是 foreach troughout 结果并将所有 3 个数组合并为一个，但这不是关联数组，我可以用组合来做吗？

例子 ：

```
Array
(
    [0] => Array
        (
            [0] => Array
                (
                    [Year] => 2003
                    [Month] => June
                    [MyCount] => 1
                )

            [MyData1] => Array
                (
                    [type] => 10
                )

            [MyData2] => Array
                (
                    [status] => 1
                )

        )

    [1] => Array
        (

            [0] => Array
                (
                    [Year] => 2003
                    [Month] => June
                    [MyCount] => 32
                )

            [MyData1] => Array
                (
                    [type] => 7
                )

            [MyData2] => Array
                (
                    [status] => 21
                )

        )

) 
```

我怎样才能让它变成这样：

```
 Array
    (
        [0] => Array
            (
                ['SomeName'] => Array
                    (
                        [Year] => 2003
                        [Month] => June
                        [MyCount] => 1
                        [type] => 10
                        [status] => 1
                    )

            )

        [1] => Array
            (

                ['SomeName'] => Array
                    (
                        [Year] => 2003
                        [Month] => June
                        [MyCount] => 32
                        [type] => 7
                        [status] => 21
                    )

            )

    ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:44:33.733

试试这个

```
$a_final =array();
foreach($final as $data)
{
  $a_final[]['SomeName'] = array('Year' => $data[0]['year'], 
                                 'Month' => $data[0]['Month'], 
                                 'MyCount' => $data[0]['MyCount'], 
                                 'type' => $data['MyData1']['type'], 
                                 'status' => $data['MyData2']['status']);
} 
```

# vb.net - 简单VB项目的首选序列化方法

> ID：10984513
> 
> 赞同：0
> 
> 时间：2012-06-11T17:06:19.990
> 
> 标签：vb.net, serialization

这是新手VB问题。
我儿子正在学习 VB，我正在和他一起学习。我们有 RichEdit 控件应用程序（非 WPF），我们在其中输入文本，格式化其样式（粗体、斜体、下划线等）。
我们的下一个任务是将文本连同其属性一起保存到文件中。
问题是：在这种情况下首选哪种类型的序列化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T18:04:49.637

不确定“RichEdit 控件”可能是什么，假设您正在谈论 RichTextBox 控件。您应该非常喜欢 RichTextBox 已经实现的序列化。使用它的 LoadFile 和 SaveFile 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:10:42.140

[DataContractSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)支持范围广泛的对象图，并且具有序列化为 XML 格式的额外学习优势，以便可以检查序列化的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:19:58.317

[在这种情况下，序列化](http://msdn.microsoft.com/en-us/library/ms973893.aspx)可能不是您想要的。

我只是将 RTF 文本直接保存到文件中。例如

```
System.IO.File.WriteAllText("C:\\MyRTFDocument.rtf", rtftextBox.Rtf); 
```

然后您可以在任何 RTF 编辑器（例如 MS Word）中打开该文件

再次读取文件内容

```
rtftextBox.Rtf = System.IO.File.ReadAllText("C:\\MyRTFDocument.rtf"); 
```

希望这可以帮助

# javascript - jQuery 的 `$(this)` 为什么以及如何引用正确的节点？

> ID：10984516
> 
> 赞同：3
> 
> 时间：2012-06-11T17:06:38.327
> 
> 标签：javascript, jquery, this, internals

我知道如何使用 jQuery 的`$(this)`选择器，也了解 Javascript 中的 OOP 原理。我总是接受它只是工作，因为其他人实现了它，但我很想知道它**为什么以及如何**工作。

```
$(function(){
   $('.foo').each(function(){
      console.log($(this));
   });
}); 
```

鉴于此代码。我知道它会`$('.foo')`找到一组 HTML 元素并返回一个*jQuery 对象*，该对象能够使用`.each(...)`. 然后方法的内部结构`each()`可能会调用已作为参数传递的闭包。

但是为什么还要`this`引用闭包内的特定 HTML 元素呢？我一直认为这`this`只会引用一个新的范围，只要它的包装器已经使用`new`. `this`那么如果引用它会不会更加一致`window`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-11T17:09:11.270

最后，您始终可以使用or强制`this`函数中的值。jQuery 这样做；看看[来源](https://github.com/jquery/jquery/blob/master/src/core.js#L592)：`.call``.apply`[`.each`](https://github.com/jquery/jquery/blob/master/src/core.js#L592)

```
if ( callback.call( object[ i ], i, object[ i++ ] ) === false ) {
//                  ^ `this` value 
```

在这里，`this`值将设置为元素 ( `object[i]`)，计数器 ( `i`) 和元素作为参数传递给您的函数，即`callback`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-11T17:09:41.440

它是所有匹配元素与类的简单迭代，`.foo`并使用`.call/.apply`.

检查`.each`实现[http://james.padolsey.com/jquery/#v=git&fn=jQuery.each](http://james.padolsey.com/jquery/#v=git&fn=jQuery.each)

请注意以下代码中的 .call/.apply 调用，以确保`this`作为`.foo[i]`

jQuery`.each`实现

```
function (object, callback, args) {
    var name, i = 0,
        length = object.length,
        isObj = length === undefined || jQuery.isFunction(object);
    if (args) {
        if (isObj) {
            for (name in object) {
                if (callback.apply(object[name], args) === false) {
                    break;
                }
            }
        } else {
            for (; i < length;) {
                if (callback.apply(object[i++], args) === false) {
                    break;
                }
            }
        }
    } else {
        if (isObj) {
            for (name in object) {
                if (callback.call(object[name], name, object[name]) === false) {
                    break;
                }
            }
        } else {
            for (; i < length;) {
                if (callback.call(object[i], i, object[i++]) === false) {
                    break;
                }
            }
        }
    }
    return object;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-11T17:10:00.713

“为什么”是因为这[`jQuery(selector).each`](http://api.jquery.com/each/)是*定义*如何操作的：

> ...回调是在当前 DOM 元素的上下文中触发的，*因此关键字 this 指的是该元素。*

它不需要这样做，但它是。（请参阅[`Function.call`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call)和[`Function.apply`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)了解使用的“如何”机制。）

快乐编码！

# iphone - 修复 main.m 的泄漏

> ID：10984518
> 
> 赞同：0
> 
> 时间：2012-06-11T17:07:04.047
> 
> 标签：iphone, ios, instruments, memory-leaks

Instruments - Leaks 用于分析 myApp。结果如下：

**泄漏**

```
 #    Address     Category      Event Type    RefCt      Timestamp    Size    Responsible Library Responsible Caller
   0    0xe8b8120   Malloc 48 Bytes Malloc        1      00:30.130.300  48             myApp            main 
```

**堆栈跟踪**

```
 0 libsystem_c.dylib 0x36fa9be3
   1 libsystem_c.dylib 0x36fae57c
   2 libnotify.dylib 0x364fe126
   3 libnotify.dylib 0x364ff392
   4 libnotify.dylib 0x364ff4fc
   5 CoreFoundation 0x35276af4
   6 CoreFoundation 0x35278066
   7 UIKit 0x324448d4
   8 UIKit 0x32426648
   9 UIKit 0x324432d4
  10 UIKit 0x324207ba
  11 UIKit 0x323b0f0c
  12 UIKit 0x325e1564
  13 UIKit 0x3232d0fc
  14 UIKit 0x3232bc4a
  15 UIKit 0x32338990
  16 UIKit 0x323387ce
  17 UIKit 0x3233839c
  18 UIKit 0x3231e83c
  19 UIKit 0x3231e0e2
  20 GraphicsServices 0x3655322a
  21 CoreFoundation 0x352d4522
  22 CoreFoundation 0x352d44c4
  23 CoreFoundation 0x352d3312
  24 CoreFoundation 0x352564a4
  25 CoreFoundation 0x3525636c
  26 GraphicsServices 0x36552438
  27 UIKit 0x3234ce7c
  28 myApp main /Developer/+Projects/myApp/myApp/main.m:16
  29 myApp start 
```

实际上我不知道如何修复 main.m 的泄漏。我该如何解决这个问题？提前致谢！

编辑 1

```
#import <UIKit/UIKit.h>

#import "AppDelegate.h"

int main(int argc, char *argv[])
{
    @autoreleasepool {
        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
  //line 16
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T06:21:36.957

这似乎是 iOS 5.1 中的一个错误，我自己已经注意到它并在其他线程中看到它，例如[this one](https://stackoverflow.com/questions/9757956/instruments-show-leak-in-main-m-xcode-4-3-1)。[官方Apple Dev 论坛](https://devforums.apple.com/message/630695)中也提出了这个问题。所以不幸的是，我们现在似乎无能为力，它很可能会在即将到来的 iOS 6 中得到解决。作为一个小小的安慰，泄漏并不大（如果应用程序运行很长时间，每次 48 个字节）它可能会开始影响性能但非常轻微的时间量）并且不应该是一个停止展示的问题。

我们现在所能做的就是等待 Apple 解决问题，同时我们专注于不在我们的应用程序中制造任何其他漏洞！

# ios - IOS - 从另一个类按钮调用一个类的实例方法

> ID：10984521
> 
> 赞同：0
> 
> 时间：2012-06-11T17:07:42.343
> 
> 标签：ios, class, button, instance

我在一个类中实现了一些实例方法来做一些 2D 绘画；并且图像被渲染到我的paintViewController 中声明的视图中。

如果我从同一类中的代码生成按钮调用这些方法（如 clearImage、changeBrushColor），它们将完全正常工作。

但我想要的是使用 UIkit 来制作所有图形、按钮 ecc 和一个空视图来绘制。

我尝试了一些方法来调用其他类的实例方法，但它们似乎都没有工作..

有人可以逐步向我解释如何做到这一点吗？

这些是我已经尝试过的方法：

1.  `PaintViewController.m` 然后我像`#import "Paint.h"`这样调用擦除方法

    ```
    - (IBAction)eraseButton:(id)sender {

         Paint *newInstance = [[Paint alloc]init];
         [newInstance clearImage];
    } 
    ```

    就像调用了该方法但不起作用..（如果我将 NSLog 放在它打印内容的方法中）

2.  我`@class Paint`在我的内部`PaintViewController.h`，将接口中的属性设置为`@property (strong, nonatomic) Paint *paint;`我写的 IBAction 内部`[self.class clearImage];`

这根本行不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T22:49:13.470

如果我正确阅读了您的问题，您需要实现委托方法。在这种情况下，它是 Objective-C 中常用的模式。[在这篇 SO](https://stackoverflow.com/questions/9629417/calling-a-method-from-another-class-in-objective-c/10898471#10898471)帖子中，我对示例代码有类似的回答。

# jquery - 具有动态高度和动态内容的 JScrollPane？

> ID：10984522
> 
> 赞同：0
> 
> 时间：2012-06-11T17:07:48.860
> 
> 标签：jquery, jscrollpane, dynamic-content

我正在开发一个 Java Servlet，它生成带有包含数据库搜索结果的 div 的网页。

此 div 的高度定义为百分比（动态高度），内容具有显示/隐藏按钮（动态内容）。显示和隐藏功能由 div 元素的“onclick”属性激活。

我首先尝试使用此页面（[JScrollPaneDynamicHeight](http://jscrollpane.kelvinluck.com/dynamic_height.html)）中的 javascript 来实现动态高度和此方法：

```
function refreshNav() {  
var pane = $('YOUR SELECTOR');  
var api = pane.data('jsp');  
api.reinitialise();  
} 
```

...由显示/隐藏方法调用，以调用 reinitialise() 方法并允许动态内容。

它不能正常工作 - 在某些点击时它会起作用，在其他点击时滚动窗格会消失而不是重新出现，反之亦然。

我也尝试过使变量“api”成为全局变量——同样的问题。

我尝试使用[此处](http://jscrollpane.kelvinluck.com/dynamic_content.html)找到的 js 的最新内容（仅不附加段落）。在快速响应和 CPU 活动之间进行权衡，所以我添加了一个 if 语句，它检查一个布尔值，描述内容或高度是否发生了变化。我已经使用“console.log()”来检查一切是否正常工作（布尔值更改、正在执行的 if 语句等）。

它是......但我仍然对 JScrollPane 有同样的问题。

我曾经在某处读到使用 html“onclick”属性是不好的做法 - 这可能相关吗？

我将非常感谢任何关于可能出现问题的想法。

干杯，

斯科特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T08:28:11.737

多亏了我在[这里](https://stackoverflow.com/questions/5489946/jquery-how-to-wait-for-the-end-or-resize-event-and-only-than-perform-action)找到的答案，我已经写了一个可以接受的解决方法。

唯一的缺点是它需要一点 CPU 工作，但不需要不断地重新初始化。我尝试使用[这个](http://benalman.com/projects/jquery-resize-plugin/)调整大小插件而不是把所有东西都放在一个计时器上，但由于某种原因，有时我会让它重新初始化两次，这意味着在平滑的 jquery 显示动画中途它会在滚动条重新初始化时停止一段时间。

呃，好吧。它是这样工作的：

- 每 75 毫秒检查一次窗口高度和容器高度是否有变化 - 如果是这样，滚动条设置为在 100 毫秒后重新初始化 - 如果某物继续调整大小，则重新初始化命令再次重置为 100

```
$(document).ready(function(){

var windowHeight = $(window).height();
var containerHeight = $('#container').height();
var resized;

setInterval(function(){

    if(windowHeight!=$(window).height() || containerHeight!=$('#container').height())
    {
        clearTimeout(resized);
        resized = setTimeout(function(){api.reinitialise();}, 100);
    }

    windowHeight = $(window).height();
    containerHeight = $('#container').height();

},75);

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-19T13:17:18.667

我还使用了 Mark Coleman 的脚本（感谢 Mark！），它可以工作。

```
function resizedw() {
        $.each($('.scroll-pane'), function () {
            var api = $(this).data('jsp');
            api.reinitialise();
        });
}
var doit;
window.onresize = function () {
    clearTimeout(doit);
    doit = setTimeout(resizedw, 100);
}; 
```

# objective-c - MKMapView 上触摸事件/注释选择的 Z 顺序

> ID：10984523
> 
> 赞同：1
> 
> 时间：2012-06-11T17:07:51.643
> 
> 标签：objective-c, ios, cocoa-touch, mkmapview, z-order

我有一个 MKMapView，上面有几个注释，一个非常重要的注释位于地图的中心。当地图缩小一点时，所有注释都聚集在一起，我编写了代码以确保主要注释始终在视觉上位于顶部。但是，注释选择似乎不符合此 z 顺序 - 在某些情况下，我尝试选择主要注释，但其后面的次要注释最终被选中并出现在前面。

有没有标准的方法来处理这个问题？欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T08:29:09.083

MKMapView 将注解添加到其内部列表中，然后通过自己的逻辑显示这些注解视图。您可以通过 MKMapView 的属性“注释”检索注释列表。但是，目前没有方法可以更改注释视图的顺序。

我也遇到同样的问题。我的解决方案是自己跟踪触摸事件，然后检测触摸的是哪个注解视图，而不是mapView:didSelectAnnotationView:delegate。

# javascript - jQuery - 遍历 DOM 中的所有类，按间隔分配条件

> ID：10984529
> 
> 赞同：-1
> 
> 时间：2012-06-11T17:08:31.027
> 
> 标签：javascript, jquery, css

好的，所以我正在尝试使用 jQuery（或整个 Javascript，对我来说并不重要。但没有其他 Javascript 框架）来迭代文档中的给定类。

我想知道，有没有一种 jQuery 特定的方法，或者我应该使用 Javascript 吗？

基本上有一个类的 X 个实例。我想遍历 DOM 中类的所有实例，并且随着每个增量，为该元素分配不同的颜色（可能通过在 div 中插入样式标签，这样原始 CSS 就不会成为问题），向上总共有五种颜色，此时下一次迭代将被赋予第一种颜色，然后继续游行，等等。

伪代码：

```
for x in elements
elements[0].inserttag('style = "#color0"')
elements[1].inserttag('style = "#color1"')
elements[2].inserttag('style = "#color2"')
elements[3].inserttag('style = "#color3"')
elements[4].inserttag('style = "#color4"')
elements[5].inserttag('style = "#color5"')
Repeat for elements[6] and beyond, starting with color0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:10:41.173

```
var colors = ['color0', 'color1', 'color2', 'color3', 'color4', 'color5'];

$('.your_class').each(function(i) {
  $(this).css('color', colors[i  % colors.length]);
}); 
```

处理间隔：

```
var i = 0,
    colors = ['red', 'blue', 'orange', 'green', 'black'];

function setColor() {
    $('.your_class').eq(i).css('color', colors[i % colors.length]);
    i++;
    setTimeout(function() {
        setColor();
    }, 2000)
}

setColor(); 
```

**[演示](http://jsfiddle.net/QStkd/191/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:11:46.120

如果您要为其迭代对象的类名是“foo”，那么您可以使用这个 jQuery：

```
var colors = ['color0', 'color1', 'color2', 'color3', 'color4', 'color5'];
$(".foo").each(function(index, el) {
    el.style.color = colors[index % colors.length];
}); 
```

在普通的 javascript 中，这也很容易：

```
var colors = ['color0', 'color1', 'color2', 'color3', 'color4', 'color5'];
var items = document.getElementsByClassName('foo');
for (var i = 0, len = items.length; i < len; i++) {
    items[i].style.color = colors[i % colors.length];
} 
```

如果您尝试在某个时间间隔内定期应用这些颜色值（您的问题在这部分不清楚），那么您可以这样做：

```
var colors = ['color0', 'color1', 'color2', 'color3', 'color4', 'color5'];
var items = document.getElementsByClassName('foo');
var i = 0;
function nextColor() {
    if (i < items.length) {
        items[i].style.color = colors[i % colors.length];
        i++;
        setTimeout(nextColor, 2000);
    }
}
nextColor(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T17:11:58.640

您可以尝试将颜色缓存在一个数组中，然后使用`.each()`它来遍历每个元素：

```
var colors = ['red','white','blue','green','yellow'];
$('.someclass').each(function(i,v) {

    // i is the iteration count,

    $(this).css('color', colors[i % colors.length]);

}); 
```

...或类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T17:12:16.487

```
var colors = ['red', 'blue', 'orange', 'green', 'black'];
var index = 0;
function doIt(){
    $('.foo').css('color', colors[index++ % colors.length]);

}

setInterval(doIt, 500);​ 
```

[**现场演示**](http://jsfiddle.net/2yYqm/1)

# android - 如何停止 AsyncFacebookRunner 或一般停止请求？

> ID：10984531
> 
> 赞同：1
> 
> 时间：2012-06-11T17:08:36.977
> 
> 标签：android, facebook, android-asynctask, facebook-android-sdk

我有一个`AsyncFacebookRunner`可以将图像上传到 Facebook。我想创建一个取消按钮来停止下载。

怎么能做到这一点？

**编辑：**

这就是我使用它的方式：

```
byte[] data = null;
ByteArrayOutputStream baos = new ByteArrayOutputStream();
bitmap.compress(Bitmap.CompressFormat.JPEG, 100, baos);
data = baos.toByteArray();
Bundle params = new Bundle();
params.putByteArray("picture", data);
AsyncFacebookRunner mAsyncRunner = new AsyncFacebookRunner(facebook);
mAsyncRunner.request("me/photos", params, "POST", 
new PhotoUploadListener(dialog), null); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T21:38:31.703

您始终可以扩展`AsyncFacebookRunner`类并覆盖该`request`方法。
像这样的东西：

```
public class CancelableAsyncFacebookRunner extends AsyncFacebookRunner {
    private Thread requestThread;

    public AsyncFacebookRunner(Facebook fb) {
        super(fb);
    }

    @Override
    public void request(final String graphPath,
            final Bundle parameters,
            final String httpMethod,
            final RequestListener listener,
            final Object state) {

        this.requestThread = new Thread() {
            @Override
            public void run() {
                try {
                    String resp = fb.request(graphPath, parameters, httpMethod);
                    listener.onComplete(resp, state);
                } catch (FileNotFoundException e) {
                    listener.onFileNotFoundException(e, state);
                } catch (MalformedURLException e) {
                    listener.onMalformedURLException(e, state);
                } catch (IOException e) {
                    listener.onIOException(e, state);
                }
            }
        };
    }

    public void cancel() {
        this.requestThread.interrupt();
    }
} 
```

它尚未经过测试，但应该给你一个大致的想法。

* * *

# 编辑

现在我想了想，这没什么意义，因为您想使用`AsyncFacebookRunner`发出多个请求，而`cancel`只会取消最后一个请求。

我建议返回线程，然后能够在其他地方中断它，但是您不能像这样更改方法的签名，并且创建新方法将无法使用类`request`中定义的其他方法`AsyncFacebookRunner`。

相反，您可以执行以下操作：

```
public class CancelableAsyncFacebookRunner extends AsyncFacebookRunner {
    private Hashtable<String, Thread> requestThreads;

    public AsyncFacebookRunner(Facebook fb) {
        super(fb);
        this.requestThreads = new Hashtable<String, Thread>();
    }

    @Override
    public void request(final String id, 
            final String graphPath,
            final Bundle parameters,
            final String httpMethod,
            final RequestListener listener,
            final Object state) {
        Thread thread = new Thread() {
            @Override
            public void run() {
                try {
                    String resp = fb.request(graphPath, parameters, httpMethod);
                    requestThreads.remove(id);
                    listener.onComplete(resp, state);
                } catch (FileNotFoundException e) {
                    requestThreads.remove(id);
                    listener.onFileNotFoundException(e, state);
                } catch (MalformedURLException e) {
                    requestThreads.remove(id);
                    listener.onMalformedURLException(e, state);
                } catch (IOException e) {
                    requestThreads.remove(id);
                    listener.onIOException(e, state);
                }
            }
        });

        this.requestThreads.put(id, thread);
        thread.start();
    }

    public void cancel(String id) {
        if (this.requestThreads.containsKey(id) {
            this.requestThreads.get(id).interrupt();
        }
    }
} 
```

您需要以某种方式为请求生成一个 id，可以很简单，例如：

```
String.valueOf(System.currentTimeMillis()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T00:18:32.200

你可以这样做：

```
AsyncFacebookRunner fbRunner;

@Override
public void onClick(View v){
    fbRunner.cancel(true);
} 
```

调用它也不会调用 onPostExecute(Object) 所以你需要注意这一点

[http://developer.android.com/reference/android/os/AsyncTask.html#cancel(boolean](http://developer.android.com/reference/android/os/AsyncTask.html#cancel(boolean) )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:06:21.363

这可能不是一个优雅的解决方案，但您可以中断`AsyncFacebookRunner`正在使用的线程，处理产生的异常并优雅地取消通信。

或者，您是否会考虑从存储库分叉并将您自己的取消方法添加到代码中？

**编辑**

看看`AsyncTask`google 源代码库中是如何实现的。本质上，您需要能够从设置取消标志的任何线程调用方法，这通常是

```
private volatile boolean cancelled = false;
// volatile ensures you always get up to date value when checking across threads

public void cancel() {
    cancelled = true;
}

public boolean isCancelled() {
    return cancelled;
} 
```

当您取消任务时，您的方法会将其设置为 true，并且您会定期从`AsyncFacebookRunner`线程中检查它。

# c++ - 在需要对抽象基础的引用不起作用的情况下传递的临时 concreate 派生对象？

> ID：10984534
> 
> 赞同：0
> 
> 时间：2012-06-11T17:09:07.663
> 
> 标签：c++, constructor, reference

我想我不明白关于临时对象的一些东西。鉴于关系：

```
class C {};

class F {
public:
    C getC() { return C(); };
};

class N {
public:
    N( C & base ){};
}; 
```

这有效：

```
N n(C()); 
```

这不起作用：

```
F f;
N n(f.getC()); //compile error 
```

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:11:16.947

非常量引用（如`B& base`）只能绑定到左值。

`F::getC()`按值返回`C`对象，因此调用表达式`f.getC()`是右值，而不是左值。

* * *

然而，有效的原因`N n(C());`是由于一个不相关的问题。

这不声明对象。它声明了一个名为的函数，该函数`n`返回`N`并接受一个类型为“指向没有参数并返回的函数的指针”的参数`C`。

这是被称为*最令人烦恼的解析*的语言特性的一种表现。要更改它以声明一个对象，您需要以下之一：

```
N n = C();  // Use copy initialization
N n((C())); // Use more parentheses 
```

但是，这两个都无法编译，因为两者都会尝试将右值表达式的结果绑定`C()`到非常量引用`B& base`。

* * *

const 引用（like `B const& base`）可以绑定到右值，就像`B&& base`C++11 中的右值引用（like ）一样。

# shell - 用变量替换模式时出现 Sed 错误

> ID：10984540
> 
> 赞同：0
> 
> 时间：2012-06-11T17:09:37.477
> 
> 标签：shell, variables, sed

我对 Shell 脚本中的“sed”命令有疑问，

我有以下脚本来尝试用我从其他 2 个文件中捕获的信息替换 3 个“标签”：

```
#!/bin/sh

VAR1=$(cat file1.sh | grep --max-count=1 DLC=)
VAR2=$(cat file1.sh | grep --max-count=1 PROPATH=)
VAR3=$(cat file2.sh | grep -e - )

sed 's|PATTERN1|'"$VAR1"'|' < Template.sh > temp1.sh
sed 's|PATTERN2|'"$VAR2"'|' < temp1.sh > temp2.sh
sed 's|PROGRESS_CONNECTION|'"$VAR3"'|' < temp2.sh > Final.sh 
```

请注意，3 个变量的内容是类似字符串（不带双引号）：

```
VAR1="DLC=/user/aaa/bbb;export DLC"
VAR2="PROPATH=/user/ccc/ddd;export PROPATH"
VAR3="-db docdb -trig triggers -H sona01 -S 19001 -N TCP -ld newyork 
      -db docadm -trig triggers -H sona01 -S 19002 -N TCP -ld docadm 
      -db dochelp -trig triggers -H sona01 -S 19003 -N TCP -ld dochelp 
      -yy 1920 -rereadnolock -T /tmp -c 30 -d mdy -Bt 350 -D 100 -mmax 8192 -nb 200 -s 160 -noshvarfix -inp 32000 
      -cpinternal utf-8 -cpstream utf-8 -cpcoll ICU-UCA" 
```

当我运行此脚本时，正确创建了 temp1.sh，正确创建了 temp2.​​sh，但未创建 Final.sh，并且我收到一条 sed 错误消息：

```
sed: -e expression #1, char 91: unterminated `s' command 
```

在这一点上，我不确定是什么导致了问题。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:20:32.610

问题是您的`$VAR3`变量确实包含一些换行符。

```
$ echo "$VAR3"
-db docdb -trig triggers -H sona01 -S 19001 -N TCP -ld newyork 
      -db docadm -trig triggers -H sona01 -S 19002 -N TCP -ld docadm 
      -db dochelp -trig triggers -H sona01 -S 19003 -N TCP -ld dochelp 
      -yy 1920 -rereadnolock -T /tmp -c 30 -d mdy -Bt 350 -D 100 -mmax 8192 -nb 200 -s 160 -noshvarfix -inp 32000 
      -cpinternal utf-8 -cpstream utf-8 -cpcoll ICU-UCA 
```

A`s///`不能包含换行符（除非前面有`\`）。一个解决方案是删除换行符`tr -d '\n'`：

```
$ echo "$VAR3" | tr -d '\n'
-db docdb -trig triggers -H sona01 -S 19001 -N TCP -ld newyork       -db docadm -trig triggers -H sona01 -S 19002 -N TCP -ld docadm       -db dochelp -trig triggers -H sona01 -S 19003 -N TCP -ld dochelp       -yy 1920 -rereadnolock -T /tmp -c 30 -d mdy -Bt 350 -D 100 -mmax 8192 -nb 200 -s 160 -noshvarfix -inp 32000       -cpinternal utf-8 -cpstream utf-8 -cpcoll ICU-UCA 
```

现在在 sed 中使用它：

```
$ sed 's|PAT|'"$(echo $VAR3 | tr -d '\n')"'|' temp2.sh > Final.sh 
```

# css - 偏移 div，同时使用 960

> ID：10984542
> 
> 赞同：0
> 
> 时间：2012-06-11T17:09:48.880
> 
> 标签：css, html, png

我正在尝试抵消一个包含带有徽标的透明 PNG 的 div。类似于本网站使用这种风格。[http://axiswake.com/](http://axiswake.com/)

我假设我不能将 div 偏移超过 960 的包装器。我使用的是 960 网格系统

我想我可以在主包装器的外部制作一个 div 并从中心偏移？我只需要它最终正确对齐。

我是这一切的菜鸟。

只是为了澄清，假设我有我的 960 包装器，我希望这个 .png 包含在我试图偏移的 div 中，让我们说 200px 到包装器左边框的左侧。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:14:10.650

只需使用负边距，如下所示：

```
.logo {
  margin: 0 0 0 -200px;
} 
```

# c++ - 如何提高文本渲染性能。Gdk::Drawable 上的自定义文本视图

> ID：10984543
> 
> 赞同：0
> 
> 时间：2012-06-11T17:09:49.207
> 
> 标签：c++, performance, cairo, gtkmm, text-rendering

我正在尝试使用 Gtkmm 和 Gdk::Drawable 编写一个类似于十六进制编辑器的东西。确切地说，只是一个十六进制视图。

起初我尝试使用糟糕的开罗。我想我也不应该靠近 Pango 的任何地方。

现在我正在使用这样的东西：Using prerendered characters for text。

```
void HexView::on_vScrl_value_changed() {
    drawingArea.queue_draw();
}

bool HexView::DrawingArea::on_expose_event(GdkEventExpose* event) {
    /* */
    Glib::RefPtr<Gdk::Window> window = get_window();
    if(window && data && numBytes) {
        /* */
        unsigned int scrlY = hexView->vScrl.get_value();
        /* */

        for(/*loop visible bytes*/) {
            /* */
            window->draw_pixbuf(char_pixbuf, 0, 0, x, y, 20, 20, Gdk::RGB_DITHER_NONE, 0, 0);
        }
    }
    return true;
} 
```

这使得渲染和滚动可以忍受，但仍然很慢。CPU在一个小弹簧上占用和滚动手柄，有点落后。在一个 800x300 的小区域:(

有什么改进的想法吗？

Gtk::TexView 小部件完美呈现大量文本，并且在 1600x1200 窗口上滚动效果很好。

# asp.net - 在 ASP.NET MVC 3 应用程序中为 ashx 处理程序设置自动化规则

> ID：10984546
> 
> 赞同：0
> 
> 时间：2012-06-11T17:10:06.557
> 
> 标签：asp.net, asp.net-mvc, security, httphandler

我正在我的 MVC 3 应用程序中实现 javascript 文件上传功能，因此我需要使用 Http Handler (.ashx) 来允许大文件上传。现在我需要以某种方式禁止未经身份验证的用户调用处理程序的方法。如果我有一个控制器，我会简单地对它应用 [Authorize] 属性。但是，该属性在应用于 Http Handler 的方法时是否有效？如果没有，我怎样才能只允许拥有当前会话 cookie 的人调用 Http Handler？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T17:11:50.027

您可以使用`<location>`web.config 中的部分来拒绝`~/upload.ashx`匿名用户的访问：

```
<location path="upload.ashx">
    <system.web>
        <authorization>
            <deny users="?" />
        </authorization>
    </system.web>
</location> 
```

备注：**切勿**使用`<location>`标记来控制 ASP.NET MVC 控制器操作和路由的授权。使用内置`[Authorize]`属性来装饰相应的控制器/动作。

# c - 替代嵌套数组（6 维），内存间隙保留 O(1) 访问

> ID：10984551
> 
> 赞同：2
> 
> 时间：2012-06-11T17:10:25.653
> 
> 标签：c, arrays, multidimensional-array

我正在通过运行具有不同配置的程序读取统计数据。假设有 6 种配置（`a`, `b`, ..., `f`）。配置可能不会线性变化，因此如果您将测量值视为表格，则表格中可能存在间隙。问题是关于在内存中构建这些统计数据。

首先想到的是将这些配置读取到动态分配的 6 深数组或数组中：

```
struct data ******measurements; 
```

现在这工作正常。您的内存开销非常小（实际上只会分配具有数据的配置），并且访问时间为`O(1)`.

除了大多数人不喜欢`******`指针这一事实之外，这还有一个缺点，即添加配置意味着向数组添加维度，这可能会变得很难看，除非对数组的读/写封装在函数中。（Write 已经被封装以在必要时处理分配，所以这实际上没什么大不了的）。

想到的另一个想法是使用 AVL 树或其他东西的映射`struct config`（`struct data`我[已经有了](https://github.com/ShabbyX/shDS/blob/master/include/shmap.h)，所以没有实现开销）。这解决了扩展配置参数的问题，但减少了对`O(log(n))`.

`O(log(n))`为了有所作为，测试的数量可能会变得相当大。

**我的问题是：在这里使用 6 深的嵌套数组是否合理？或者有没有更好的方法来做到这一点？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:14:58.503

请注意，您当前的设置不是 O(1)，而是 O(k)，其中 k 是维数。对于平衡树，无论如何它都会达到 O(log 2^k) == O(k) （我假设每个维度都有两个选择；但没关系……这里只是一个常数）。不过，您可能会或可能不会期望在实现平衡树时产生更大的开销。

您可以做的是尝试使用 typedef 和 getter/setter 函数（最好是可内联的）抽象接口，然后使用您想要的任何实现。那么你就不用那么多处理指针了，仍然使用里面的任何结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T17:47:35.277

[X-trees](http://en.wikipedia.org/wiki/X-tree)是高效存储和查找高维数据的常见选择。链接的维基百科文章只是一个存根，但它指向更权威的来源。

它们基本上是 R-Tree 的改进版本，针对最小化重叠进行了优化。

我不知道手头的交流实施。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T08:15:45.113

真正的性能瓶颈（除了浪费内存）不是计算，而是您将遇到的间接次数和缓存未命中数。这些可以主导指数和类似东西的计算的数百到数千倍。因此，您最好的选择是减少间接次数并在计算上投入一些精力。据我所知，这最好通过散列你的 6 个索引来完成。这会将您的间接寻址减少到两个，首先查找存储在哈希表中的值（可能是指针），然后直接获取您感兴趣的数据。

# ruby - 在 Ruby 中使用 mixins 而不是继承

> ID：10984552
> 
> 赞同：0
> 
> 时间：2012-06-11T17:10:27.197
> 
> 标签：ruby, oop

我正在用 Ruby 编写一些工资单软件，它打算被美国和加拿大的公司使用（未来有可能在其他地方扩展。）显然对于像 Employee 这样的一些类，会有一些共享功能，但是也有很多不同之处。例如，一些监管数据和业务逻辑只需要在一个国家或另一个国家使用。

由于公司在此应用程序中只能包含一种类型的员工（即公司的员工只能是加拿大人或美国人），我想在运行时使用 mixins 添加不同的功能，而不是创建继承层次结构这有可能变得非常麻烦。Employee 类将不是唯一在国家/地区之间存在差异的类，因此动态扩充我的所有类以在运行时包含区域功能似乎会有所帮助。

这是组织我的应用程序的有效方式，还是有一些缺点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:58:04.713

这听起来像是一个非常好的模块用例。请注意，尽管 Ruby 在其标准库中也有[委托模式](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/delegate/rdoc/index.html)，但也许您可以简单地使用它来将某些消息转发到通用员工对象。在对需求知之甚少的情况下，总是很难推荐一些东西。

如果你想了解更多关于 mixins 的内容，Russ Olsen 的“Eloquent Ruby”有一个很好的章节（第 16 章，“将模块用作 Mixins”）。我不建议仅仅为此而购买这本书，但无论如何它都是一本好书。我不确定，在那本书的某个地方，甚至似乎有一个与您尝试做的事情有些相似的例子（不同的背景，相同的原则）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T19:30:18.463

一般来说，在大多数情况下，对我来说使用 mixins 而不是继承似乎更好。继承是一种非常特殊的关系，并且通常看起来比它所提供的功能增加了更多的复杂性。通常，继承似乎需要更多地摆弄基类，而不是看起来很健康。当需要一个新的子类时，基类往往会随着一个或多个子类的特殊逻辑而增长。我发现 mixin 往往更易于重用，因为它们往往更小并且更专注于一个问题。

# c# - C#：在 C# 4.5 中等待请求完成

> ID：10984554
> 
> 赞同：6
> 
> 时间：2012-06-11T17:10:41.010
> 
> 标签：c#

我的asp.net 4.0 应用程序中有一个http 请求。我希望线程在继续之前等待。

```
HttpClient client = new HttpClient();
HttpResponseMessage responseMsg = client.GetAsync(requesturl).Result;

// I would like to wait till complete.

responseMsg.EnsureSuccessStatusCode();
Task<string> responseBody = responseMsg.Content.ReadAsStringAsync(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-11T17:13:02.660

在 responseBody 任务上调用 .Wait()

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T17:21:20.927

在 4.5 中（你的标题是这样说的）你可以使用`async/await`

```
public async void MyMethod()
{
    HttpClient client = new HttpClient();
    HttpResponseMessage responseMsg = await client.GetAsync("http://www.google.com");

    //do your work
} 
```

要下载字符串，您可以简单地使用

```
public async void Question83()
{
    HttpClient client = new HttpClient();
    var responseStr = await client.GetStringAsync("http://www.google.com");

    MessageBox.Show(responseStr);

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T17:25:20.423

一种选择是调用 .Wait() 但更好的选择是使用 async

```
public async void GetData()
{
    using(HttpClient client = new HttpClient())
    {
        var responseMsg = await client.GetAsync(requesturl);
        responseMsg.EnsureSuccessStatusCode();
        string responseBody = await responseMsg.Content.ReadAsStringAsync();
    }
} 
```

}

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T17:33:02.633

这可以使用[async 关键字](http://msdn.microsoft.com/en-us/library/hh156513(v=vs.110).aspx)和[await 关键字](http://msdn.microsoft.com/en-us/library/hh156528(v=VS.110).aspx)来完成，如下所示：

```
// Since this method is an async method, it will return as
// soon as it hits an await statement.
public async void MyMethod()
{

    // ... other code ...

    HttpClient client = new HttpClient();
    // Using the async keyword, anything within this method
    // will wait until after client.GetAsync returns.
    HttpResponseMessage responseMsg = await client.GetAsync(requesturl).Result;
    responseMsg.EnsureSuccessStatusCode();
    Task<string> responseBody = responseMsg.Content.ReadAsStringAsync();

    // ... other code ...

} 
```

请注意，await 关键字不会阻塞线程。相反，在异步方法的其余部分排队之后，控制权将返回给调用者，以便它可以继续处理。如果您需要调用者`MyMethod()`也等到 client.GetAsync() 完成，那么您最好使用同步调用。

# r - 有没有办法跟踪 mclapply 的进度？

> ID：10984556
> 
> 赞同：47
> 
> 时间：2012-06-11T17:10:44.463
> 
> 标签：r, progress-bar, mclapply

我喜欢里面的环境`.progress = 'text'`。但是，由于列表项被发送到各个核心，然后在最后进行整理，因此不知道（从 package ）`plyr's` `llply`走了多远，这让我非常焦虑。`mclapply``multicore`

我一直在输出这样`*currently in sim_id # ....*`的消息，但这并不是很有帮助，因为它没有让我知道列表项的完整百分比（尽管知道我的脚本没有卡住并继续移动很有帮助）。

有人可以提出其他想法，让我查看我的`.Rout`文件并获得进步感吗？我考虑过添加一个手动计数器，但看不到我将如何实现它，因为`mclapply`必须在它可以给出任何反馈之前完成所有列表项的处理。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-12T09:11:17.830

由于会`mclapply`产生多个进程，因此可能需要使用 fifos、管道甚至套接字。现在考虑以下示例：

```
library(multicore)

finalResult <- local({
    f <- fifo(tempfile(), open="w+b", blocking=T)
    if (inherits(fork(), "masterProcess")) {
        # Child
        progress <- 0.0
        while (progress < 1 && !isIncomplete(f)) {
            msg <- readBin(f, "double")
            progress <- progress + as.numeric(msg)
            cat(sprintf("Progress: %.2f%%\n", progress * 100))
        } 
        exit()
    }
    numJobs <- 100
    result <- mclapply(1:numJobs, function(...) {
        # Dome something fancy here
        # ...
        # Send some progress update
        writeBin(1/numJobs, f)
        # Some arbitrary result
        sample(1000, 1)
    })
    close(f)
    result
})

cat("Done\n") 
```

在这里，一个临时文件被用作先进先出，主进程分叉一个子进程，其唯一职责是报告当前进度。主进程通过调用`mclapply`where 将被评估的表达式（更准确地说，表达式块）通过`writeBin`.

由于这只是一个简单的示例，您可能必须根据需要调整整个输出内容。！

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-11-12T17:31:32.607

本质上添加了@fotNelson 解决方案的另一个版本，但进行了一些修改：

*   替换 mclapply（支持所有 mclapply 功能）
*   捕获 ctrl-c 调用并优雅地中止
*   使用内置进度条 (txtProgressBar)
*   选择是否跟踪进度并使用指定样式的进度条
*   使用`parallel`而不是`multicore`现在已从 CRAN 中删除
*   强制 X 按照 mclapply 列出（因此 length(X) 给出了预期的结果）
*   顶部的 roxygen2 样式文档

希望这可以帮助某人...

```
library(parallel)

#-------------------------------------------------------------------------------
#' Wrapper around mclapply to track progress
#' 
#' Based on http://stackoverflow.com/questions/10984556
#' 
#' @param X         a vector (atomic or list) or an expressions vector. Other
#'                  objects (including classed objects) will be coerced by
#'                  ‘as.list’
#' @param FUN       the function to be applied to
#' @param ...       optional arguments to ‘FUN’
#' @param mc.preschedule see mclapply
#' @param mc.set.seed see mclapply
#' @param mc.silent see mclapply
#' @param mc.cores see mclapply
#' @param mc.cleanup see mclapply
#' @param mc.allow.recursive see mclapply
#' @param mc.progress track progress?
#' @param mc.style    style of progress bar (see txtProgressBar)
#'
#' @examples
#' x <- mclapply2(1:1000, function(i, y) Sys.sleep(0.01))
#' x <- mclapply2(1:3, function(i, y) Sys.sleep(1), mc.cores=1)
#' 
#' dat <- lapply(1:10, function(x) rnorm(100)) 
#' func <- function(x, arg1) mean(x)/arg1 
#' mclapply2(dat, func, arg1=10, mc.cores=2)
#-------------------------------------------------------------------------------
mclapply2 <- function(X, FUN, ..., 
    mc.preschedule = TRUE, mc.set.seed = TRUE,
    mc.silent = FALSE, mc.cores = getOption("mc.cores", 2L),
    mc.cleanup = TRUE, mc.allow.recursive = TRUE,
    mc.progress=TRUE, mc.style=3) 
{
    if (!is.vector(X) || is.object(X)) X <- as.list(X)

    if (mc.progress) {
        f <- fifo(tempfile(), open="w+b", blocking=T)
        p <- parallel:::mcfork()
        pb <- txtProgressBar(0, length(X), style=mc.style)
        setTxtProgressBar(pb, 0) 
        progress <- 0
        if (inherits(p, "masterProcess")) {
            while (progress < length(X)) {
                readBin(f, "double")
                progress <- progress + 1
                setTxtProgressBar(pb, progress) 
            }
            cat("\n")
            parallel:::mcexit()
        }
    }
    tryCatch({
        result <- mclapply(X, ..., function(...) {
                res <- FUN(...)
                if (mc.progress) writeBin(1, f)
                res
            }, 
            mc.preschedule = mc.preschedule, mc.set.seed = mc.set.seed,
            mc.silent = mc.silent, mc.cores = mc.cores,
            mc.cleanup = mc.cleanup, mc.allow.recursive = mc.allow.recursive
        )

    }, finally = {
        if (mc.progress) close(f)
    })
    result
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-12-07T10:23:58.960

该`pbapply`软件包已针对一般情况实现了这一点（即在类 Unix 和 Windows 上，也适用于 RStudio）。两者`pblapply`都有`pbsapply`争论`cl`。从[文档](https://cran.r-project.org/web/packages/pbapply/pbapply.pdf)中：

> 可以通过`cl`参数启用并行处理。`parLapply` 当`cl`是'<code>cluster'对象时`mclapply`被调用，当`cl`是整数时被调用。与没有进度条的函数的并行等效项相比，显示进度条增加了主进程和节点/子进程之间的通信开销。当进度条被禁用（即`getOption("pboptions")$type == "none"` `dopb()`is `FALSE`）时，这些函数会退回到它们的原始等效项。`interactive()` 这是if时的默认设置`FALSE`（即从命令行 R 脚本调用）。

如果不提供`cl`（或通过`NULL`），则使用默认的非并行`lapply`，还包括进度条。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-10-29T06:19:53.607

这是一个基于[@fotNelton 解决方案](https://stackoverflow.com/a/10993589/1840471)的函数，适用于您通常使用 mcapply 的任何地方。

```
mcadply <- function(X, FUN, ...) {
  # Runs multicore lapply with progress indicator and transformation to
  # data.table output. Arguments mirror those passed to lapply.
  #
  # Args:
  # X:   Vector.
  # FUN: Function to apply to each value of X. Note this is transformed to 
  #      a data.frame return if necessary.
  # ...: Other arguments passed to mclapply.
  #
  # Returns:
  #   data.table stack of each mclapply return value
  #
  # Progress bar code based on https://stackoverflow.com/a/10993589
  require(multicore)
  require(plyr)
  require(data.table)

  local({
    f <- fifo(tempfile(), open="w+b", blocking=T)
    if (inherits(fork(), "masterProcess")) {
      # Child
      progress <- 0
      print.progress <- 0
      while (progress < 1 && !isIncomplete(f)) {
        msg <- readBin(f, "double")
        progress <- progress + as.numeric(msg)
        # Print every 1%
        if(progress >= print.progress + 0.01) {
          cat(sprintf("Progress: %.0f%%\n", progress * 100))
          print.progress <- floor(progress * 100) / 100
        }
      }
      exit()
    }

    newFun <- function(...) {
      writeBin(1 / length(X), f)
      return(as.data.frame(FUN(...)))
    }

    result <- as.data.table(rbind.fill(mclapply(X, newFun, ...)))
    close(f)
    cat("Done\n")
    return(result)
  })
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-05-10T12:13:43.380

您可以使用您的系统回显函数从您的工作人员中写入，因此只需将以下行添加到您的函数中：

```
myfun <- function(x){
if(x %% 5 == 0) system(paste("echo 'now processing:",x,"'"))
dosomething(mydata[x])
}

result <- mclapply(1:10,myfun,mc.cores=5)
> now processing: 5 
> now processing: 10 
```

如果您传递一个索引，这将起作用，例如，不是传递数据列表，而是传递索引并在工作函数中提取数据。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-11-05T15:36:54.227

根据@fotNelson 的回答，使用进度条而不是逐行打印并使用 mclapply 调用外部函数。

```
library('utils')
library('multicore')

prog.indic <- local({ #evaluates in local environment only
    f <- fifo(tempfile(), open="w+b", blocking=T) # open fifo connection
    assign(x='f',value=f,envir=.GlobalEnv)
    pb <- txtProgressBar(min=1, max=MC,style=3)

    if (inherits(fork(), "masterProcess")) { #progress tracker
        # Child
        progress <- 0.0
        while (progress < MC && !isIncomplete(f)){ 
            msg <- readBin(f, "double")
                progress <- progress + as.numeric(msg)

            # Updating the progress bar.
            setTxtProgressBar(pb,progress)
            } 

        exit()
        }
   MC <- 100
   result <- mclapply(1:MC, .mcfunc)

    cat('\n')
    assign(x='result',value=result,envir=.GlobalEnv)
    close(f)
    })

.mcfunc<-function(i,...){
        writeBin(1, f)
        return(i)
    } 
```

必须将 fifo 连接分配给 .GlobalEnv 才能从 mclapply 调用之外的函数中使用它。感谢您的问题和以前的答复，我一直想知道如何做到这一点。

# android - 如何获取 Android openRawResource 作为变量？

> ID：10984557
> 
> 赞同：0
> 
> 时间：2012-06-11T17:10:48.513
> 
> 标签：android, string, variables, resources, arguments

我有一个从一个片段传递到另一个片段的 int/string(s)。对于我编码的每一种方式，我都会在第 67 行得到一个 NPE（参见下面的 67）。我不知道我是否以正确的方式进行操作，所以请查看我的方法并在您的答案中包含一些代码。

谢谢。

什么通过了论点：

```
. . .
        int rawRes = R.raw.regulatory_list;//<--THIS IS THE RES I NEED TO PASS
        args.putInt("KEY_RAW_RES", rawRes);

        boolean isRawRes = true;
    args.putBoolean("KEY_IS_RAW_RES", isRawRes);

        ListViewFragment lvf = new ListViewFragment();
        lcFT.replace(R.id.discriptionListContainer, lvf).commit();
        lvf.setArguments(args);
. . . 
```

ListViewFragment 的 onActivityCreated：

```
. . .
private static final String KEY_URL = "KEY_URL";
    private static final String KEY_IS_RAW_RES = "KEY_IS_RAW_RES";
    private static final String KEY_RAW_RES = "KEY_RAW_RES";
. . .

@Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

// Get the string to query from last Fragment and pass it to this
        // Fragment
        Bundle args = this.getArguments();

        String url = args.getString(KEY_URL);
        boolean rawRes = args.getBoolean(KEY_IS_RAW_RES);

        int fileName = (Integer) null;//<--THIS IS LINE 67!!
        fileName = args.getInt(KEY_RAW_RES);

        this.runJsonFile(url, jsonSrc, fileName);
}

private void runJsonFile(String url, boolean rawRes, int fileName) {

    if (rawRes == true) {
        getFromRawRes(fileName);
    } else {
        getFromURL(url);
    }
}

    private void getFromRawRes(int fileName) {
//      InputStream file = getResources().openRawResource(R.raw.regulatory_list);
        InputStream file = getResources().openRawResource(fileName);
        JSONParser jParser = new JSONParser();
        JSONArray json = jParser.getJSONFromFile(file);
        callback(json);
    } 
```

**编辑：**

根据 Raghav Sood 的回答，我将第 67 - 68 行更改为：

```
//      int fileName = (Integer) null;
        int fileName = args.getInt(KEY_RAW_RES); 
```

这让课程通过了 NPE - Thnx！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:13:36.493

您正在将空值转换为整数变量。没有任何可能的情况不会导致 NullPointerException，因为您首先使用的是 null。在 Java 和其他几种语言中，整数、双精度、字符等原始数据类型不能为空。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T17:21:17.480

还要添加，以及您对`null`to 的转换`Integer`，此方法绝对没有任何逻辑意义：

```
private void runJsonFile(String url, String resType, int fileName) {
        String rawRes = null;
        if (ListViewFragment.KEY_RES_TYPE == rawRes) {
            getFromRawRes(fileName);
        } else {
            getFromURL(url);
        }
    }
} 
```

这将*始终*转到 else 块。您正在初始化`rawRes`为`null`，然后针对`final String`非空值对其进行测试。从来没有一个实例证明此`if`语句的计算结果为真。

# c# - c#连接到vpn。rasdial.exe 似乎不可靠

> ID：10984561
> 
> 赞同：1
> 
> 时间：2012-06-11T17:11:00.930
> 
> 标签：c#, vpn

我每次都可以手动连接到 vpn。

我正在尝试使用 c# 连接到 vpn。我在 SO 上找到了这个，
[如何以编程方式连接到 VPN？](https://stackoverflow.com/questions/7076711/how-can-i-programmatically-connect-to-a-vpn#comment8486414_7079288)
哪个显示使用此连接：

```
System.Diagnostics.Process.Start("rasdial.exe", "VPNName Username Password"); 
```

但这似乎只是有时有效。它要么在大约半秒内连接，然后在接下来的几分钟内在 Connecting to __.... 和 Verifying username and password... 之间来回切换，直到它给出远程访问错误 800。

尝试与 Windows 正常连接时，永远不会发生这种情况。

知道什么可能导致此问题以及如何解决它？

# ios - 过早释放的视图控制器

> ID：10984563
> 
> 赞同：-1
> 
> 时间：2012-06-11T17:11:07.837
> 
> 标签：ios, uiviewcontroller, automatic-ref-counting, nszombie

我正在绘制网格视图并在触发选择器`EXC_BAD_ACCESS`时遇到错误。`UIButton`打开僵尸对象给我的信息是：

```
*** -[FooViewController performSelector:withObject:withObject:]: message sent to deallocated instance 0x91818f0 
```

这是我正在做的事情：

```
BazViewController *baz = [[BazViewController alloc] initDesignatedInitializer];
FooViewController *foo = [[FooViewController alloc] initDesignatedInitializer];
[baz.view addSubview:foo.view]; 
```

我在 ARC 上运行它，所以我可以看到 FooViewController 被过早释放的可能性。

所以我做了这个黑客：

`NSMutableArray`在名为的 BazViewController 中创建一个ivar&property`viewControllers`并改为执行以下操作：

```
BazViewController *baz = [[BazViewController alloc] initDesignatedInitializer];
FooViewController *foo = [[FooViewController alloc] initDesignatedInitializer];
[baz.view addSubview:foo.view];
[baz.viewControllers addObject:foo]; 
```

但我仍然得到上面同样的错误。

我继续在处理网格的视图控制器上执行与上述相同的操作。（创建一个视图控制器数组，并在创建该对象时将对象添加到其中）。还是没有骰子。谁能推荐另一种方法来防止此 vc 过早发布？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T19:17:46.573

我自己解决了这个问题。

我没有创建数组，而是`addChildViewController`添加了对适当 vc 的强引用。没有过早的释放，也没有僵尸对象。

```
BazViewController *baz = [[BazViewController alloc] initDesignatedInitializer];
FooViewController *foo = [[FooViewController alloc] initDesignatedInitializer];
[baz.view addSubview:foo.view];
[baz addChildViewController:foo]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:15:40.220

在创建它的类中创建一个`FooViewController`属性，并为该属性赋予一个`strong`属性。分配给它而不是局部变量。

# php - 如何在 Drupal 中打印分类术语？

> ID：10984571
> 
> 赞同：0
> 
> 时间：2012-06-11T17:11:51.313
> 
> 标签：php, drupal, taxonomy, drupal-taxonomy

我正在尝试使用以下代码打印分类术语：

```
<?php foreach ((array)$taxonomy as $item) { ?>
<a href="<?php print base_path() . "taxonomy/term/" . $item->tid; ?> "class='tags'><?php print $item->name ?>,</a>
<?php } ?> 
```

它在预告片中工作正常，但在完整节点中没有，标签在完整节点中为空。谁能告诉我这是什么原因以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-18T19:51:47.563

我意识到这是一个老问题，但我想发布我的 Drupal 6 解决方案。

用这个

```
$tree = taxonomy_get_tree($vid); 
```

然后遍历它以打印出条款：

```
 foreach ($tree as $term) {
       $path = taxonomy_term_path($term);
       $content .= '<a href="<?php print base_path() . strtolower(str_replace( " ", "-",$term->name)) . '">' . $term->name . '</a>';           
  } 
```

# macos - 从 EFI 禁用 Mac-pro 2008 中的超线程？

> ID：10984576
> 
> 赞同：1
> 
> 时间：2012-06-11T17:12:05.783
> 
> 标签：macos, hyperthreading

有没有办法在固件级别（EFI）禁用 HT？我在 mac-pro 2008 工作站中安装了 server-linux 发行版和 macosx。

在 google 中搜索，我想出了 EFI shell 命令“cpuconfig threads off”，但这似乎只适用于 EFI 附带的 HP 服务器。

mac-pro的解决方案是什么？

作为紧急解决方案，我可以一个一个地手动禁用 ubuntu 中的逻辑 CPU，但我不确定这是否是获得高效性能和最大 cpu 频率的好方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T22:17:51.973

我还没有找到主题中问题的任何解决方案，但可以接受的解决方案是在 /etc/default/grub 的 grub 引导选项中添加“maxcpus=n”（在我的情况下，我只使用 linux for hpc），然后运行重新启动前的“update-grub”。

现在我每次启动 linux 时每个内核都有 1 个线程。

# sql - 为什么 setParameter 不设置参数？

> ID：10984579
> 
> 赞同：2
> 
> 时间：2012-06-11T17:12:12.530
> 
> 标签：sql, hibernate, parameters, hql

我正在使用以下代码（尝试）查询数据库：

```
Query query = session.createQuery("from Trace where service = :service");
query.setParameter("service", clientRequest[0]); 
```

其中 clientRequest[0] 来自字符串数组，服务变量是我的 POJO 中的字符串，映射到我的 MySQL 数据库中的 VARCHAR(45)。

当我运行此代码时，Hibernate 将执行的 SQL 查询显示为：

```
Hibernate: select trace0_.traceId as traceId0_, trace0_.service as service0_, trace0_.longitude as longitude0_, trace0_.latitude as latitude0_, trace0_.timestamp as timestamp0_ from trace trace0_ where trace0_.service=? 
```

这让我相信 clientRequest[0] 的值没有被正确设置为参数。

我已经检查了 clientRequest[0] 包含一个有效的字符串，它确实如此。我尝试了其他创建查询的方法，但这些方法都没有奏效，它们总是将服务显示为“？”，而如果我使用明显的：

```
Query query = session.createQuery("from Trace where service = 21"); 
```

它自然给出了正确的响应

```
Hibernate: select trace0_.traceId as traceId0_, trace0_.service as service0_, trace0_.longitude as longitude0_, trace0_.latitude as latitude0_, trace0_.timestamp as timestamp0_ from trace trace0_ where trace0_.service=21 
```

什么可能会阻止 setParamater 正常工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T17:51:57.100

预计会在日志中输出。Hibernate 不会在查询字符串中记录参数。参数设置正确。未设置参数时，您会看到异常。

如果您还想记录参数值，可以从[此处](http://www.mkyong.com/hibernate/how-to-display-hibernate-sql-parameter-values-log4j/)找到一些说明。

# wordpress - WordPress - 隐藏的图像自定义元字段

> ID：10984582
> 
> 赞同：0
> 
> 时间：2012-06-11T17:12:29.770
> 
> 标签：wordpress, media, custom-fields

我正在尝试向 WordPress 中的媒体上传器添加自定义字段。我可以正常工作，但我想让自定义字段键成为隐藏键。

如果您熟悉 WordPress 处理自定义字段的方式，您就会知道将键设置为“_something”将在用户可见的下拉列表中隐藏该键。

```
/**
 * Add Video URL fields to media uploader
 *
 * http://www.billerickson.net/wordpress-add-custom-fields-media-gallery/
 *
 * @param $form_fields array, fields to include in attachment form
 * @param $post object, attachment record in database
 * @return $form_fields, modified form fields
 */

    function capgun2012_attachment_fields( $form_fields, $post ) {

        $form_fields['capgun2012_video_url'] = array(
            'label' => 'Vimeo URL',
            'input' => 'text',
            'value' => get_post_meta( $post->ID, 'capgun2012_video_url', true ),
            'helps' => 'If provided, photo will be displayed as a video',
        );

        return $form_fields;
    }

    add_filter( 'attachment_fields_to_edit', 'capgun2012_attachment_fields', 10, 2 );

/**
 * Save values of Photographer Name and URL in media uploader
 *
 * @param $post array, the post data for database
 * @param $attachment array, attachment fields from $_POST form
 * @return $post array, modified post data
 */

    function capgun2012_attachment_fields_save( $post, $attachment ) {

        if( isset( $attachment['capgun2012_video_url'] ) ) {
            update_post_meta( $post['ID'], 'capgun2012_video_url', $attachment['capgun2012_video_url'] );
        }

        return $post;
    }

    add_filter( 'attachment_fields_to_save', 'capgun2012_attachment_fields_save', 10, 2 ); 
```

如果我只是用“_capgun2012_video_url”替换所有出现的“capgun2012_video_url”，那么它就行不通了。我开始认为媒体上传器不能很好地处理隐藏的自定义字段。

请参阅**我不希望发生**的附加屏幕截图（自定义字段下拉菜单中显示的自定义键）。

![在此处输入图像描述](../Images/4bc8a494e115a63a05b584d4bb638f83.png)

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T19:47:23.213

这是在这里回答的：http: [//devilsworkshop.org/adding-custom-fields-to-wordpress-media-gallery-upload/](http://devilsworkshop.org/adding-custom-fields-to-wordpress-media-gallery-upload/)

设置字段：

```
 /* For adding custom field to gallery popup */
function rt_image_attachment_fields_to_edit($form_fields, $post) {
    // $form_fields is a an array of fields to include in the attachment form
    // $post is nothing but attachment record in the database
    //     $post->post_type == 'attachment'
    // attachments are considered as posts in WordPress. So value of post_type in wp_posts table will be attachment
    // now add our custom field to the $form_fields array
    // input type="text" name/id="attachments[$attachment->ID][custom1]"
    $form_fields["rt-image-link"] = array(
        "label" => __("Custom Link"),
        "input" => "text", // this is default if "input" is omitted
        "value" => get_post_meta($post->ID, "_rt-image-link", true),
                "helps" => __("To be used with special slider added via [rt_carousel] shortcode."),
    );
   return $form_fields;
}
// now attach our function to the hook
add_filter("attachment_fields_to_edit", "rt_image_attachment_fields_to_edit", null, 2); 
```

这是为了保存它：

```
function rt_image_attachment_fields_to_save($post, $attachment) {
    // $attachment part of the form $_POST ($_POST[attachments][postID])
        // $post['post_type'] == 'attachment'
    if( isset($attachment['rt-image-link']) ){
        // update_post_meta(postID, meta_key, meta_value);
        update_post_meta($post['ID'], '_rt-image-link', $attachment['rt-image-link']);
    }
    return $post;
}
// now attach our function to the hook.
add_filter("attachment_fields_to_save", "rt_image_attachment_fields_to_save", null , 2); 
```

# android - 如何在 Android 应用程序中集成 Web 服务器？

> ID：10984586
> 
> 赞同：0
> 
> 时间：2012-06-11T17:12:50.130
> 
> 标签：android, webserver

我需要在我的应用程序中使用服务器来共享生成的文件。我一直在寻找许多网站，但我什么也没找到。

任何想法？建议、网站、图书馆...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:17:18.347

如果您正在使用一个肥皂网络服务，请参阅[ksoap](http://ksoap2.sourceforge.net/)，对于 json-rpc，请参阅[此 wiki](http://json-rpc.org/wiki/implementations)

# c++ - 有谁知道/有一个库来处理像 PHP 这样的 C++ 中的字符串？

> ID：10984594
> 
> 赞同：-1
> 
> 时间：2012-06-11T17:13:28.413
> 
> 标签：c++, c

一直在寻找这样的东西，并想知道它是否存在。C++ 处理字符串的方式很麻烦而且不是很直观。能够像在 PHP/ 中一样操作 C/C++ 中的字符串会很好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:17:56.123

虽然不准确，但过去证明这对我很有用。

[http://www.boost.org/doc/libs/1_49_0/doc/html/string_algo.html](http://www.boost.org/doc/libs/1_49_0/doc/html/string_algo.html)

希望能帮助到你。

# internet-explorer-9 - 使用 Winnovative HTML 到 PDF 的浏览器仿真

> ID：10984599
> 
> 赞同：1
> 
> 时间：2012-06-11T17:13:45.860
> 
> 标签：internet-explorer-9, winnovative

我正在使用[Winnovative HTML to PDF Converter](http://www.winnovative-software.com/Html-To-Pdf-Converter.aspx)工具将 HTML 输出页面转换为服务器上的 PDF 文件。

为此，它使用服务器的 Internet Explorer 版本。不幸的是，默认情况下这意味着 IE7 模式，无论服务器有什么。我在服务器上有 IE9，需要让转换器使用该模式。

其他讨论，例如[关于 IE9 WebBrowser 控件](https://stackoverflow.com/questions/4612255/regarding-ie9-webbrowser-control)，讨论向此注册表项（或其 64 位版本，或两者）添加值以设置仿真模式：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\MAIN\FeatureControl\FEATURE_BROWSER_EMULATION
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\MAIN\FeatureControl\FEATURE_BROWSER_EMULATION 
```

但是，要添加所需的密钥，您需要知道正在使用的 EXE 或 DLL。我试过“wnvhtmlconvert.dll”，但这似乎不起作用。

有没有人想出在注册表中输入什么值才能使其正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:30:28.973

找到了...

我的 IIS 服务器在 32 位 w3wp.exe 下运行（如 Windows 任务管理器中所示）。

将 DWORD 值、Name=w3wp.exe、Value=9000（十进制）添加到：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\MAIN\FeatureControl\FEATURE_BROWSER_EMULATION 
```

然后回收了 IIS 应用程序池。

现在，转换器正在使用 IE9 将 HTML 处理成 PDF！

# service - 天蓝色服务总线 - 订阅者数量

> ID：10984600
> 
> 赞同：1
> 
> 时间：2012-06-11T17:13:53.173
> 
> 标签：service, azure, bus, subscriber

有什么方法可以查看我的主题的订阅者数量吗？每个订阅者的队列中有多少条消息？它消耗了多少？

如果今天在 azure 中没有针对此的监控解决方案，有没有办法以编程方式执行此操作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:33:01.853

查看 AzureWatch 或其他第三方监控工具之一。我知道 AzureWatch 可以监控许多队列的长度等，但不知道它是否覆盖了服务总线。不过，开发人员对功能请求非常敏感。

# entity-framework - 跨越多个表的自定义实体

> ID：10984601
> 
> 赞同：1
> 
> 时间：2012-06-11T17:13:53.920
> 
> 标签：entity-framework

我迫切需要一些 EF 专家的建议。您将如何创建自定义实体而不是跨越 DDD 中的多个表？据我所知，有3种可能的解决方案：

1.  在模型中创建自定义实体并为其添加 DefiningQuery，它充当该实体的视图，本质上在纯 SQL 中连接多个表，

2.  创建一个自定义实体作为具有其他实体作为其属性的 POCO 类。使用 LINQ 查询时，首先将您需要的数据投射到匿名对象中，然后投射到该自定义实体中，

3.  在数据库中创建一个跨越多个表的视图并将其添加到模型中

第一个选项将创建对特定数据源实现 (Oracle) 的依赖，因为我们需要编写 Oracle 投诉 SQL 查询。

第二种解决方案中的自定义对象是在模型和 TBH 之外定义的，这是我最喜欢的一个，除了必须了解 LINQ 的人之外，它看不到任何真正的缺陷：)

第三种选择意味着创建大量的数据库视图，我不确定我们的 DBA 会不会太高兴。

请分享您的意见，哪种解决方案对您来说听起来更合理。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T19:44:54.403

如果您的数据库表已正确配置一对一关系，您可以使用[实体拆分](http://www.robbagby.com/entity-framework/entity-framework-modeling-entity-splitting/)。如果没有一对一的关系，从 EF 的角度来看，您的表跨越不是确定性的。

除了您提到的选项之外，您还可以尝试使用[QueryView](http://blogs.microsoft.co.il/blogs/gilf/archive/2009/03/12/queryview-element-in-entity-framework.aspx) - ESQL 查询映射到 EDMX 文件中的自定义 POCO。它就像隐藏在映射中的第一个和第二个选项的组合（独立于存储）。问题是 QueryView 仅支持 ESQL 的子集，因此它实际上取决于您要映射的内容。

# ruby-on-rails - 如何使用 Ruby gem 添加产品变体

> ID：10984602
> 
> 赞同：2
> 
> 时间：2012-06-11T17:14:03.467
> 
> 标签：ruby-on-rails, ruby, activeresource, shopify

添加产品变体的正确方法是什么？

我成功创建了产品，它显示在我的 Shopify 后台中。然而，价格总是为零，数量总是无穷大。

我尝试创建一个带有inventory_quantity 和price 集的变体，以及在prefix_options 中设置的product_id。

然而管理员总是显示价格为零和数量无穷大。

```
Rails v3.2.5
shopify_api v3.0.0
shop name: vacation-2 
```

我在执行 API 调用时没有收到错误。我只是在管理员的产品中看不到我的变体数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T23:40:48.953

确保将`:inventory_management`属性设置为`"shopify"`，否则数量将不会持续存在。

我刚刚对此进行了测试，并且效果很好：

```
product.variants << ShopifyAPI::Variant.new(
  :option1              => "Large",
  :price                => 12.95,
  :inventory_management => 'shopify',
  :inventory_quantity   => 10
)
product.save 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-20T20:28:07.227

在不使用产品关联的情况下添加变体：

```
ShopifyAPI::Variant.new(
  :product_id           =>  #enter product id,
  :option1              => "Large",
  :price                => 12.95,
  :inventory_management => 'shopify',
  :inventory_quantity   => 10
)
product.save 
```

这里的优点是变体对象使用 API 返回的值进行更新。

# php - 我需要从 6 个随机记录中提取数据，但我遇到了一些麻烦

> ID：10984603
> 
> 赞同：0
> 
> 时间：2012-06-11T17:14:04.127
> 
> 标签：php, mysql

> **可能重复：**
> [做​​一个while /循环以获得10个随机结果](https://stackoverflow.com/questions/9945691/doing-a-while-loop-to-get-10-random-results)

我正在制作一个网站，人们可以上传他们拍摄或制作的有趣图片。每次加载主页时，从 MySQL 数据库中随机显示一张图片/记录到页面上。这是用...完成的

```
$filename = mysql_fetch_row(mysql_query("SELECT filename FROM pictures ORDER BY RAND() LIMIT 1"));
echo $filename[0]; 
```

这会将随机图片文件名回显到页面上。类似的东西`funny_cat`。但是我需要文件类型，以便我可以将图像回显到页面上。像这样...

```
while ($record = mysql_fetch_array(mysql_query("SELECT * FROM pictures WHERE p='$p'"))) {
    $filetype = $record["filetype"];
}
echo "<img src=\"picture/".$filename[0].".".$filetype."\" />"; 
```

一切都很好。

现在这是我正在努力的一点。我想在页面上显示 6 个其他随机较小的图片。所以我需要得到 6 条随机记录并`filename`为`filetype`每条记录回显 and 。需要考虑的是，由于数据库的设置方式，我只能使用上面使用的技术获取随机记录。我怎么能这样做？

如果您有任何不确定的地方，请说出来，我会尽力解释。另外，请解释您的解决方案。谢谢！！***:-)***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:20:51.753

通过将查询的限制更改为 6 来检索随机列表的前 6 个结果。

```
$result = mysql_query("SELECT filename FROM pictures ORDER BY RAND() LIMIT 6") 
```

然后，您可以调用 mysql_fetch_row 6 次来获取所有 6 个文件名。

```
$filenames = array();
while ($row = mysql_fetch_row($result)) {
    $filesnames[] = $row[0];
} 
```

现在，您拥有全部 6 个文件名，您可以为每个文件名进行图像检索。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-11T17:22:26.530

如果我理解正确，您想“复制”随机提取 6 次。如果是这样，我会这样做：

```
for($i = 0; $i < 6; $i++){
   $filename = mysql_fetch_row(mysql_query("SELECT filename,filetype FROM pictures ORDER BY RAND() LIMIT 1"));
   $file =  $filename[0].'.'.$filename[1];
   echo "<img src=\"picture/".$file."\" />";
} 
```

注意：如果要获取大量数据，请不要使用 rand 函数，而是在 php 中创建一个随机数组并获取相关 id。

**编辑：**

如果您想要一个检索 6 张不同的随机图片的解决方案（这样它们就不会重复自己），我会这样做：

```
$arr_ids = array();
    for($i = 0;$i < 6;$i++){
    $fresh_rand = rand()*$db_row_count;//$db_row_count the number of rows in the data base
     for($j=0;$j <count($arr_ids);$j++){
      if($fresh_rand == $arr_ids[$j]){
        $j =0;
         $fresh_rand = rand()*$db_row_count;
      }
     }
     $arr_ids[$i] = $fresh_rand;
    } 
```

然后我将从数据库中获取 $arr_ids 数组中的 id。
我的解决方案很匆忙，所以请原谅我的不良做法，但我希望你明白你需要做什么。

# hibernate - 如何使用单个查询在具有不同元素的 JSP 表中插入针对同一 ID 的多条记录

> ID：10984607
> 
> 赞同：2
> 
> 时间：2012-06-11T17:14:33.873
> 
> 标签：hibernate, spring-mvc, model, insert

我正在将 Spring MVC 与 Hibernate 一起使用。我的页面有一个按钮，可以创建一个新的表格行（通过 jQuery），它由输入组成，允许用户选择将插入数据库的新数据。其中一些输入是组合框。我的组合框如下所示：

```
<form:select path="ProductName">
  <form:option>some list<form:option>
</form:select> 
```

单个表格行中可能有 4 到 5 个不同的框，我可以通过多次单击按钮来添加多个输入行。单击`Save`后，行中的所有项目都应插入数据库表中。

由于用户一次可以发送多行，我对路径属性感到困惑，因为我们为 JSP 中的每个 spring 标记提供了路径。在这里，我想插入一列，多行和多行可以是任意数量，那么我应该怎么做呢？

请在这件事上给予我帮助; 我真的被困住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:04:34.370

## 更新的答案

看看这个答案：[Spring MVC: processing values from timesheet - multiple objects](https://stackoverflow.com/questions/5403291/spring-mvc-processing-values-from-timesheet-multiple-objects#5405449)

基本思想是您的表单支持对象是一个`List`对象，而不仅仅是一个对象。如果您只让他们编辑现有对象，这对您有用。由于您允许用户根据需要创建任意数量的行，因此您必须做一些特别的事情。

假设您将表单支持对象更改为`List`被调用对象，`products`并且每个`Product`对象都有属性`productName`。您的 JSP 代码将更改为：

```
<c:forEach items="${products}" varStatus="row">
  <form:select path="products[${row.index}].productName">
    <form:option>some list<form:option>
  </form:select>
</c:forEach> 
```

当你的 HTML 被渲染时，你会看到这样的 HTML：

```
<select path="products[0].productName">
  <option>some list<option>
</select>
<select path="products[1].productName">
  <option>some list<option>
</select> 
```

### 想法#1

每次用户单击添加一行时，您都会提交表单。在服务器上，您再向表单支持列表添加一个填充了默认值的对象并重新发送表单。这种方法有点让人头疼，但我知道你可以让它发挥作用。

### 想法#2

*我不知道你能不能像这样破解系统，但如果它有效，它会比想法1更简单。*当你创建一个新的HTML行时，解析`path`属性并将索引加1。

jQuery 示例：

```
// This assumes that each row in the form has the class 'formRow'
function addNewRow() {
  var pathAttr = $(".formRow:last").attr("path");
  var pathIndex = parseIndex(pathAttr);
  var newIndex = parseIndex(pathIndex) + 1;
  var newRow = createNewRow();        //Creates HTML for new row
  // Set the path attribute with new index; would have to operate
  //    on all form elements, since each has a path attribute
  $(newRow).attr("path", "products[" + newIndex + "]");
}

function parseIndex(pathAttr) {
  var start = pathAttr.indexOf('[');
  var end = pathAttr.indexOf(']');
  var indexStr = pathAttr.substring(start + 1, end);
  return new Number(indexStr);
} 
```

### 想法#3

如果以前的想法不起作用或太复杂，我会使用纯 HTML 表单。使用纯 HTML 表单，您可以使用 jQuery 根据行索引为每个元素赋予唯一的`name`参数（类似于想法 2）。框架应该让你的生活更轻松，所以如果你遇到框架比底层语言/平台更难使用的极端情况，回到原始语言/平台是有意义的。

* * *

### 旧答案

首先，您的问题非常基本。您应该从阅读文档、书籍、教程等开始，而不是简单地为您需要的这件事找到一个快速解决方案，以便了解您正在使用的框架背后的架构。

其次，有很多方法可以做你想做的事。如果您只是想获取表单数据并将其发送到您的服务器以进行持久化，您可以进行简单的表单提交。如果您想要一些更复杂的表单处理，使用 Spring MVC`<form:___>`标签可能是一个不错的方法。(**注意：**如果您使用 JavaScript 创建表单，则无法创建`<form:___>`标签，因为它们是 JSP 标签。此外，如果您还不了解更基本的 HTML，您可能不应该使用更复杂的 JSP 表单标签标签。）如果您想提交数据而不刷新整个页面，您可以使用 Ajax 调用。为了让任何人帮助您，*我们需要知道您到底想做什么*. 就目前而言，您的问题似乎是将数据传输到服务器的不同方式的混合。

底线是那里有大量的网络技术。如果您首先不了解基本的 Web 流程，那么您不应该尝试做任何复杂的事情。首先，您需要了解客户端和服务器之间的区别。当涉及到客户端-服务器交互时，您需要了解 JavaScript、JSP 和 Spring MVC 所在的位置。您应该阅读的一些内容是 Spring MVC、HTML 表单提交和 Spring 特定的表单提交。

一些阅读：

[客户端与服务器的解释](http://www.eggheadcafe.com/PrintSearchContent.asp?LINKID=569)

[HTML 表单](http://www.w3schools.com/html/html_forms.asp)

[通过 JavaScript 实现 Ajax](http://www.w3schools.com/ajax/default.asp)

[通过 jQuery 实现 Ajax](http://api.jquery.com/jQuery.ajax/.)

[使用 Spring MVC`form`标签](http://developer.teradata.com/viewpoint/reference/viewpoint-pdk-cookbook/how-to-use-spring-form-tags)（这只是**服务器端**）

[另一个关于 Spring MVC](http://www.skywayperspectives.org/documentation/6.3/chunk/recipes/ch02s20.html)

# jquery - jQuery tablesorter 对逗号分隔的数字进行排序

> ID：10984609
> 
> 赞同：3
> 
> 时间：2012-06-11T17:14:43.123
> 
> 标签：jquery, tablesorter

我正在使用 jQuery Tablesorter 2.0 (http://tablesorter.com/docs/)。排序数字工作正常，但只要我添加

```
number_format($count); 
```

对于我的代码，排序不再起作用。它是这样的：

> 810,208 -> 7,671,897 -> 2,329,439

代替

> 7,671,897 -> 2,329,439 -> 810,208

有任何解决这个问题的方法吗？我需要逗号分隔的数字以便更好地阅读。谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-11T17:38:17.237

[http://www.christianmontoya.com/2008/11/14/extending-jquery-tablesorter-to-support-comma-delimited-numbers/](http://www.christianmontoya.com/2008/11/14/extending-jquery-tablesorter-to-support-comma-delimited-numbers/)

```
jQuery.tablesorter.addParser({
  id: "fancyNumber",
  is: function(s) {
    return /^[0-9]?[0-9,\.]*$/.test(s);
  },
  format: function(s) {
    return jQuery.tablesorter.formatFloat( s.replace(/,/g,'') );
  },
  type: "numeric"
}); 
```

# delphi - 如何使用数据库应用程序处理睡眠模式网络丢失

> ID：10984612
> 
> 赞同：8
> 
> 时间：2012-06-11T17:14:47.310
> 
> 标签：delphi, networking, delphi-xe2

我有几个 Delphi 程序维护与数据库的连接（一些 Oracle，一些 Firebird。）如果程序在 Windows 进入睡眠模式时运行，则与数据库的连接将丢失。处理这种情况的最佳方法是什么？有没有办法在网络进入睡眠模式之前接收事件，以便我可以尝试更好地处理这种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T20:24:22.207

要详细说明 RRUZ，您需要以下内容：

```
procedure WMPowerBroadcast(var AMessage: TMessage); message WM_POWERBROADCAST; 
```

以你的形式。然后`WMPowerBroadcast`会是这样的：

```
procedure TMyForm.WMPowerBroadcast(var AMessage: TMessage);
const
  PBT_APMSUSPEND = 4;
  PBT_APMRESUMESUSPEND = 7;
begin
  case AMessage.WParam of
    PBT_APMSUSPEND:
    begin
      // save your DB stuff. NOTE: IIRC you are pretty limited in the time 
      // you get to do this - 2 seconds ? may be the limit
    end;
    PBT_APMRESUMESUSPEND:
    begin
      // restore your DB connection
    end;
  else
     // you're going to want to handle PBT_APMRESUMECRITICAL (XP and older systems) and PBT_APMRESUMEAUTOMATIC differently
     // IIRC you did not get notification of the suspend in this case
  end;
end; 
```

# ios - 在iphone中创建肖像pdf的缩略图

> ID：10984613
> 
> 赞同：2
> 
> 时间：2012-06-11T17:14:49.183
> 
> 标签：ios, pdf

我是 iPhone 编程的新手。在我的应用程序中，我显示了存储在我的资源文件夹中的 PDF 第一页的缩略图。我正在使用以下代码创建缩略图，它适用于横向 PDF。但是在创建纵向 PDF 的缩略图时，我得到了一个带有一些额外部分的图像，在 web 视图中打开 PDF 时我看不到这些部分。

*这是我用来创建缩略图的代码：*

> NSURL* pdfFileUrl=[NSURLfileURLWithPath:filePath];
> CGPDFDocumentRef pdf = CGPDFDocumentCreateWithURL((CFURLRef)pdfFileUrl);

```
 CGRect aRect = CGRectMake(0, 0, 1024, 768);
            UIGraphicsBeginImageContext(aRect.size);
            CGContextRef context = UIGraphicsGetCurrentContext();                    

            CGContextSaveGState(context);                
            CGContextTranslateCTM(context, 0.0, aRect.size.height);
            CGContextScaleCTM(context, 1.0, -1.0);
            CGContextTranslateCTM(context, -(aRect.origin.x), -(aRect.origin.y));

            CGContextSetGrayFillColor(context, 1.0, 1.0);
            CGContextFillRect(context, aRect);            

            //Grab the first PDF page
            CGPDFPageRef page = CGPDFDocumentGetPage(pdf, 1);
            CGAffineTransform pdfTransform = CGPDFPageGetDrawingTransform(page, kCGPDFCropBox, aRect, 0, false);
            // And apply the transform.
            CGContextConcatCTM(context, pdfTransform);            
            CGContextDrawPDFPage(context, page);

            // Create the new UIImage from the context
            UIImage *thumbnail = UIGraphicsGetImageFromCurrentImageContext();

            CGContextRestoreGState(context);          
            UIGraphicsEndImageContext();    
            CGPDFDocumentRelease(pdf); 
```

使用此代码创建肖像 PDF 的缩略图图像时，我得到的图像不是确切的图像。它有一些额外的部分。我认为，这是该 PDF 的一些隐藏部分。此外，当我在 UIWebView 中加载相同的 PDF 时，我可以查看正确的 PDF 而无需额外的部分。谁能给我一个解决方案？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T07:26:09.853

我发现问题在于使用 CGRect。我用 iPad 对齐对矩形进行了硬编码。实际上，我们必须采用我们正在使用的 PDF 页面的矩形。所以我在我的代码中使用了以下更改来制作正确的 PDF 缩略图。

> CGPDFPageRef page = CGPDFDocumentGetPage(pdf, 1);//抓取第一个PDF页面
> 
> CGRect aRect = CGPDFPageGetBoxRect(page, kCGPDFCropBox);//获取与box类型关联的pdf页面的矩形(kCGPDFCropBox)

# jquery - 向 jQuery 自动完成实时添加值

> ID：10984614
> 
> 赞同：7
> 
> 时间：2012-06-11T17:14:56.567
> 
> 标签：jquery, autocomplete, jquery-ui-autocomplete

我正在制作一个带有自动完成功能的“令牌输入”样式复选框（用户输入某些内容，选择一个响应，这会在 DOM 视图中添加一个“令牌”）。

使用 jQuery 自动完成，有没有办法在用户输入后添加不在`source`列表中的值？

例如，源看起来像`["Apples", "Oranges", "Bananas"]`. 用户在`"plums,"`使用文本字段时输入。如果用户愿意，有没有办法将“李子”添加到来源列表中？我知道有我可以检查`select`的`change`事件，但`select`只有在有选择的情况下才有效（在这种情况下没有），并且`change`需要某种超时检查来验证用户是否已停止输入。

相反，我可以使用另一个插件来完成此行为吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-11T17:37:58.550

这应该适用于`autocomplete`' 更改事件。`add`此代码假定当您想向列表中添加新项目时，会出现一个带有 id 的按钮。如果用户从列表中选择一个项目，它将不会出现。可以进行一些调整，但是这个概念证明应该可以实现：

```
var source = ["Apples", "Oranges", "Bananas"];

$(function () {
    $("#auto").autocomplete({
        source: function (request, response) {
            response($.ui.autocomplete.filter(source, request.term));
        },
        change: function (event, ui) {
            $("#add").toggle(!ui.item);
        }
    });

    $("#add").on("click", function () {
        source.push($("#auto").val());
        $(this).hide();
    });
}); 
```

这是一个例子：http: [//jsfiddle.net/rmGqB/](http://jsfiddle.net/rmGqB/)

* * *

**更新：**听起来我有点误解了这个要求。您还可以利用自动完成填充候选列表的结果，并根据搜索结果是否产生任何完全匹配来提高按钮的可见性：

```
var source = ["Apples", "Oranges", "Bananas"];

$(function () {
    $("#auto").autocomplete({
        source: function (request, response) {
            var result = $.ui.autocomplete.filter(source, request.term);

            $("#add").toggle($.inArray(request.term, result) < 0);

            response(result);
        }
    });

    $("#add").on("click", function () {
        source.push($("#auto").val());
        $(this).hide();
    });
}); 
```

**示例：http:** [//jsfiddle.net/VLLuJ/](http://jsfiddle.net/VLLuJ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-12T22:32:36.770

Andrew 提供的答案会导致 ADD NEW 按钮保留，即使用户随后从数组中选择现有项目而不是添加“新”！

代替在“添加”按钮上包含一个切换，在自动完成中有一个内置的 .change 功能可以使用。

尽管“更改”会等到文本框失去焦点，但如果没有与数组匹配，这可能是一个更好的界面，然后显示 ADD BUTTON。（或者可以创建添加的“确认”）。

如果用户从数组中选择，请参阅实际再次隐藏“添加按钮”的替代代码。Andrew Whitaker 的解决方案没有做的事情：

```
$(function () {

  var source = ["Apples", "Oranges", "Bananas"];

  $("#auto").autocomplete({
    source: function (request, response) {
        var result = $.ui.autocomplete.filter(source, request.term);

        response(result);
    },
    change: function( event, ui ) {
      var $label = $(this);
      // figure out the id of hidden input box from label id
      var $id = $('#'+this.id.replace('label_','id_'));
      if ( ui.item === null && $label.val() != '' ){
        $("#add").show();            
      }
        if( ui.item != null && $label.val() != '' ){
        $("#add").hide();            
      }
    }
  });

  $("#add").on("click", function () {
    source.push($("#auto").val());
    $(this).hide();
  });

}); 
```

请参阅我修改后的小提琴 - [http://jsfiddle.net/VLLuJ/25/](http://jsfiddle.net/VLLuJ/25/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-15T13:56:43.960

老问题，但有用的答案：

要更新自动完成源，请使用 setter：

$("#auto").autocomplete("option", "source", ["Apples","Oranges","Bananas","Plums"]);

见[http://api.jqueryui.com/autocomplete/#option-source](http://api.jqueryui.com/autocomplete/#option-source)

# javascript - 使用 Web Worker 和 D3.js 异步生成图？

> ID：10984615
> 
> 赞同：10
> 
> 时间：2012-06-11T17:14:58.453
> 
> 标签：javascript, svg, d3.js, web-worker

我目前正在处理一个问题，该问题需要我的 Web 应用程序生成一个代表大约 50k 到 60k 数据点的图表。它加载得相当快（约 6 秒），但我想知道是否可以使用 D3.js 在 Web Worker 中生成图形，然后将 SVG 传回以加载到页面中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T21:32:34.773

Web Workers 没有 DOM 访问权限，因此您在这方面所能做的就是构建可用于快速创建 DOM 的东西。工作人员可以例如处理数据集并进行所有繁重的计算，然后将结果作为一组数组传回。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-26T20:30:58.327

[https://github.com/mbostock/d3/commit/43d38773623b52209d2667287a1ae626fb95b0d9](https://github.com/mbostock/d3/commit/43d38773623b52209d2667287a1ae626fb95b0d9)

Jason Davies 最近的一次提交。Mike Bostock 说，未来依赖 DOM 的代码将从 d3.core 中分离出来，这样您就可以制作与 web-workers API 一起使用的自定义 d3 构建。

我有同样的问题，我有一个带有大量节点的力有向图。感觉非常迟钝。我想以某种方式提高性能。我认为在节点服务器上使用 phantomJS 的最后一个线程是个好主意，但是这种方法所涉及的网络延迟会破坏流畅的强制导向感觉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-21T11:59:06.957

通过执行以下操作，我设法使用 Web Worker 计算和弦布局的和弦和组：

1.  创建一个不依赖于文档对象或 DOM 的 d3 自定义构建（参见：[https](https://github.com/mbostock/smash/wiki) ://github.com/mbostock/smash/wiki ）

2.  创建一个 web worker 文件并用于`importScripts`加载自定义 d3 构建

3.  在渲染代码中激活您的工作人员。我使用了一个 promise 来封装与 worker 的通信：

    ```
    calculateChords = (padding, matrix) ->
            deferred = $.Deferred()

            worker = new Worker("worker.js")

            worker.onmessage = (e) ->
                deferred.resolve(e.data.groups, e.data.chords);

            worker.postMessage {
                matrix: matrix
            }

            deferred.promise() 
    ```

    稍后，在渲染函数中：

    ```
    calculateChords(matrix).then (groups, chords) ->
        ... 
    ```

# .net - 显示不正确的密码信息

> ID：10984618
> 
> 赞同：3
> 
> 时间：2012-06-11T17:15:11.650
> 
> 标签：.net, asp.net-mvc-3, validation, c#-4.0, razor

我有以下用 mvc3 razor 编写的表格。我想在用户输入错误密码时显示一条消息。我已经放置了一个标签来显示消息，但不知道如何在 mvc 中完成显示/隐藏。请帮忙。

```
@using (Html.BeginForm("Authenticate", "Authorization", FormMethod.Post, new { autocomplete = "off" }))
{
    < div>
    < fieldset>
        <legend > User Information </legend>

        <div class="editor-label">
            @Html.Label("Password")

            @Html.TextBox("password")
            @Html.ValidationMessageFor(m => m.password)
            @Html.Label("Incorrect Password")
        </div>
        <p>
            @Html.Hidden("tab", ViewData["tab"])
            <input type="submit" value="Submit" />
        </p>

    </fieldset>
</div>
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-11T17:17:59.477

在应该验证凭据的控制器操作中，您可以添加模型状态错误：

```
ModelState.AddModelError("password", "The username or password is incorrect"); 
```

使用 Visual Studio 中的内置向导创建一个新的 ASP.NET MVC 应用程序并导航到`~/Controller/AccountController.cs`. 然后查看`LogOn`POST 操作。当凭据无效时，它会添加一般模型状态错误：

```
ModelState.AddModelError("", "The user name or password provided is incorrect."); 
```

并且在视图中使用 ValidationSummary 助手显示此错误：

```
@Html.ValidationSummary(true, "Login was unsuccessful. Please correct the errors and try again.") 
```

# php - FPDF 在输出中的引号前添加反斜杠

> ID：10984621
> 
> 赞同：0
> 
> 时间：2012-06-11T17:15:24.323
> 
> 标签：php, fpdf

> **可能重复：**
> [“每个引用前的斜线”问题](https://stackoverflow.com/questions/3006407/slash-before-every-quote-problem)

我正在使用 FPDF 为标签生成 pdf。在标签上它们有英寸（即： " ）。在 localhost 上没有问题，但现在在我的生产服务器上，FPDF 在生成的 PDF 中的引号之前输出一个反斜杠。

```
 4 1/2" gets transformed into: 4 1/2\" 
```

尝试了我的谷歌技能，但无济于事。有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:47:45.710

您可以使用[get_magic_quotes_gpc](http://www.php.net/manual/en/function.get-magic-quotes-gpc.php)来确认值是否在发布期间被转义：

**PHP**

```
if (get_magic_quotes_gpc()) {
    $myValue = stripslashes($_POST['myValue']);
}
else {
    $myValue = $_POST['myValue'];
} 
```

如果问题是由 POST 由于[magic_quotes](http://php.net/manual/en/security.magicquotes.php)引起的，这将返回不带斜线的值。

由于[魔术行情](http://php.net/manual/en/security.magicquotes.php)是：

> 自 PHP 5.3.0 起已弃用，自 PHP 5.4.0 起已删除。

让您使用 5.3.4 的 localhost，因此不使用 Magic Quotes，可能生产服务器正在使用它们，因为指定的版本是 5.2.17。

# ruby-on-rails - 为什么我会收到“LoadError”？

> ID：10984626
> 
> 赞同：1
> 
> 时间：2012-06-11T17:15:53.160
> 
> 标签：ruby-on-rails, ruby

我有两个 Ruby 脚本，我正在调用这些文件，但出现错误。

我有`r1.rb`和`r2.rb`。当我打电话时，`r1.rb`我收到此错误：`r2.rb``r3.rb`

```
C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- r1 (LoadError)
        from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from r3.rb:1:in `<main>' 
```

r1.rb 是：

```
def random
    rand(1000000)
end 
```

r2.rb 是：

```
def random
    (rand(26) + 65).chr
end 
```

r3.rb 是：

```
require 'r1'
require 'r2'

puts random 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-11T17:29:30.940

使用 require 时的拇指规则，总是在 require 语句中使用路径 [主要是在使用 windows 平台时]

如果你使用`load`你需要放置`filename.rb`但不需要传递文件路径。[首先检查需求并使用负载，因为每次调用时都会在内存中加载]

在这里我正在修改你的代码

```
require 'C:/PLACE YOUR FILE PATH HERE/r1'
require 'C:/PLACE YOUR FILE PATH HERE/r2'

puts random 
```

请让我知道这是否适合您

让我再补充一件事

使用方式相同，必须使用`irb`相同的方式

```
>irb
irb(main):001:0> require 'c:/rubycode/test.rb'
=> true 
```

@jdoe 建议`require_relative`这是个好方法

但我得到以下错误

```
irb(main):001:0> require_relative 'test'
LoadError: cannot infer basepath
        from (irb):1:in `require_relative'
        from (irb):1
        from C:/Ruby193/bin/irb:12:in `<main>'

irb(main):002:0> require_relative 'rubycode/test'
LoadError: cannot infer basepath
        from (irb):2:in `require_relative'
        from (irb):2
        from C:/Ruby193/bin/irb:12:in `<main>'

irb(main):003:0> require_relative 'c:/rubycode/test'
LoadError: cannot infer basepath
        from (irb):3:in `require_relative'
        from (irb):3
        from C:/Ruby193/bin/irb:12:in `<main>'

irb(main):004:0> require 'c:/rubycode/test'
=> true
irb(main):005:0> 
```

# javascript - window["myvar"] = value 的 node.js 等价物是什么？

> ID：10984629
> 
> 赞同：65
> 
> 时间：2012-06-11T17:16:08.650
> 
> 标签：javascript, node.js

node.js 相当于`window["myvar"] = value`什么？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-06-11T17:17:19.197

要设置全局变量，请使用`global`而不是`window`.

```
global["myvar"] = value 
```

# richfaces - 如何获取richfaces数据表中当前显示的行列表

> ID：10984631
> 
> 赞同：0
> 
> 时间：2012-06-11T17:16:33.640
> 
> 标签：richfaces, jsf-1.2

假设我有 100 条记录，并且我使用分页来每页显示 10 个项目。如果用户对任何列进行排序，显示的行将会改变。我怎样才能找到正在显示的 10 行？我正在使用 Richfaces 3.3.1 和 JSF 1.2。

# c# - 使用按钮单击查找嵌套的 GridView？

> ID：10984632
> 
> 赞同：0
> 
> 时间：2012-06-11T17:16:40.930
> 
> 标签：c#, asp.net, gridview

我想`gvR`在单击按钮时找到嵌套的 GridView，以便我可以向其中添加一行。我将发布 GridView 标记，然后发布将行添加到所选嵌套网格的代码。

```
<asp:LinkButton ID="btnAdd" runat="server" Text="Add Room" 
            onclick="btnAdd_Click"></asp:LinkButton>
        <asp:GridView ID="gvRP" runat="server" AutoGenerateColumns="false" 
            onrowdatabound="gvRP_RowDataBound" 
            onrowediting="gvRP_RowEditing">
        <Columns>
        <asp:TemplateField HeaderText="Room" ItemStyle-Width="100%">
        <ItemTemplate>
        <asp:Label runat="server" Text="Room"></asp:Label>
        <asp:DropDownList ID="ddlRoom" runat="server" AutoPostBack="True" DataTextField="Name"
            DataValueField="Id" AppendDataBoundItems="true" OnSelectedIndexChanged="ddlRoom_SelectedIndexChanged">
            <asp:ListItem Value="-1">Select...</asp:ListItem>
        </asp:DropDownList>
        <asp:Label runat="server" AssociatedControlID="ddlRate" Text="Rate" ID="lblRate"></asp:Label><asp:DropDownList
            ID="ddlRate" runat="server" AppendDataBoundItems="true" DataTextField="Name"
            DataValueField="Id">
            <asp:ListItem Value="-1">Select...</asp:ListItem>
        </asp:DropDownList>

        <asp:Label  runat="server" Text="Adults"></asp:Label>
        <asp:TextBox ID="txtAdults" Text='<%#Bind("Adults") %>' runat="server" Width="25px"></asp:TextBox>
        <asp:Label  runat="server" Text="Children"></asp:Label>
        <asp:TextBox ID="txtChildren" Text='<%#Bind("Children") %>' runat="server"  Width="25px"></asp:TextBox>
        <asp:Label runat="server" Text="Check In"></asp:Label>
        <asp:TextBox ID="txtCheckIn" Text='<%#Bind("CheckIn") %>' runat="server" Width="75px"></asp:TextBox>
        <asp:Label  runat="server" Text="Check Out"></asp:Label>
        <asp:TextBox ID="txtCheckOut" Text='<%#Bind("CheckOut") %>' runat="server"  Width="75px"></asp:TextBox>

        <h3>Rates</h3>
        <asp:GridView ID="gvR" runat="server" AutoGenerateColumns="false">
        <Columns>
        <asp:BoundField DataField="Name" HeaderText="Rate" />
        <asp:BoundField DataField="Effective" HeaderText="Effective" />
        <asp:BoundField DataField="Expire" HeaderText="Expire" />
        <asp:BoundField DataField="Amount" HeaderText="Amount" />
        <asp:BoundField DataField="Code" HeaderText="Currency" />
        </Columns>
        </asp:GridView>
        </ItemTemplate>
        </asp:TemplateField>
        </Columns>
        </asp:GridView> 
```

添加费率的代码：

```
protected void AddRate(object sender, EventArgs e)
{
    lstRateDetails = (List<RateDetail>)ViewState["Rates"];

    lstRateDetails.Insert(0, new RateDetail());
    //Have no idea what to do here? I have also tried gvRatePlans.TemplateControl...
    GridView gvR = (GridView)gvRP.FindControl("gvR");
    gvR.DataSource = lstRateDetails;
    gvR.DataBind();

    ViewState["Rates"] = lstRateDetails;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:20:39.767

如果 gvRP 是父网格，而 gvR 是嵌套网格。由于嵌套网格包含在容器网格的每一行中，因此我们需要在父网格的行中找到它。您可以像这样在第一行中包含嵌套网格

```
GridView gvR = (GridView)gvRP.Rows[0].FindControl("gvR");
gvR.DataSource = lstRateDetails;
gvR.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T18:33:38.910

我最终做的是使用`NamingContainer`LinkBut​​ton 来查找选定的`gvR`GridView。这是代码：

```
 LinkButton lnk = (LinkButton)sender;
    lstRateDetails = (List<RateDetail>)ViewState["Rates"];
    lstRoomDetails = (List<RoomDetail>)ViewState["Rooms"];

    lstRateDetails.Insert(0, new RateDetail());
    GridViewRow gvr = (GridViewRow)lnk.NamingContainer;
    int selectedRow = gvr.RowIndex;
    GridView gvR = (GridView)gvRP.Rows[selectedRow].FindControl("gvR"); 
```

# mysql - Joomla jos_session 表崩溃

> ID：10984639
> 
> 赞同：4
> 
> 时间：2012-06-11T17:17:21.337
> 
> 标签：mysql, joomla

我最近收到以下错误

```
DB function failed with error number 145
'TABLE\ jos_session' is marked as crashed and should be repaired
SQL=SELECT session_id FROM jos_session WHERE session_id .... 
```

这伴随着我的网站崩溃。我通过截断表格来修复它

```
truncate table jos_session 
```

也可以通过修台来修复

```
repair table jos_session 
```

我的问题是，我们如何才能防止这张桌子一开始就崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:29:52.477

从 MySQL 提供给您的信息来看，无法确定，但表崩溃的最常见原因是内存不足。我建议升级你的硬件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:31:42.560

发生这种情况的原因有多种，因此请查看[手册](http://dev.mysql.com/doc/refman/5.0/en/corrupted-myisam-tables.html)以了解您的情况可能发生的情况。我们使用 SQLyog/monYog 来监控我们的数据库，并确保不会发生任何可能触发此类错误的异常情况。底线 - 你必须做一些挖掘，看看是什么可能导致它再次发生。

# java - 如何使用两个或多个包并在清单中声明两者？- 安卓

> ID：10984644
> 
> 赞同：2
> 
> 时间：2012-06-11T17:17:47.803
> 
> 标签：java, android, package, manifest

第一个包是**com.first.one**，第二个包是**com.second.two**

两个包都使用相同的xml文件..

我的问题是我在第一个包中的代码工作正常，但第二个包没有..

我认为问题应该出在 manifest.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.first.one"
    android:versionCode="1"
    android:versionName="1.0" > 
```

因为只使用了第一个包**com.first.one**而没有使用第二个包。如果这是问题所在。如何在清单中声明这两个包？

如果这不是问题，那么为什么我在第二个包中的代码不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-10T13:38:23.797

我想你想要两个 app 。您可以使用允许您更改清单中的包名称的构建文件

目标

```
<target name="name1_2" depends="">
        <replaceregexp file="AndroidManifest.xml" match='com.first.one' replace='com.first.second' byline="true" />
    </target>

<target name="name2_1" depends="">
        <replaceregexp file="AndroidManifest.xml" match='com.first.second' replace='com.first.one' byline="true" />
    </target> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T17:20:43.450

这是不可能的。相反，您可以添加`import com.first.one.R.*;`到第二个包中的类，以允许它们使用与第一个包相同的资源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T18:12:05.910

拥有单独包的想法是辅助包应该补充您的应用程序。例如，如果您正在编写一个使用网站 API 的应用程序，您可以保留该包，例如 com.websiteAPI，并根据需要从其资源中提取，方法是导入：

```
import com.package_name_requested_here.R.* 
```

另一个例子是专门为全局对象编写一个包，比如 com.objects。

相比之下，您自己的包（清单中指定的包）应包含特定于您的应用程序的所有文件。请记住，您可以将包设置为包含子包。例如，如果你做了：

```
package="com.mystuff" 
```

您可以通过以下方式在清单中引用您的活动：

```
<activity android:name=".first.one" </activity>
<activity android:name=".second.two" </activity> 
```

希望这可以帮助。^_^

# php - Codeigniter phpexcel 分配内存的单元格大小

> ID：10984645
> 
> 赞同：0
> 
> 时间：2012-06-11T17:17:51.723
> 
> 标签：php, codeigniter, phpexcel

我们如何增加 excel 文件中分配的单元格内存大小以忽略以下错误：

`Fatal error: Allowed memory size of 134217728 bytes exhausted (tried to allocate 54 bytes)`

虽然我们把指令放在下面： `(init_set(...,'3072M')`

如何在脚本执行期间减少分配内存大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T20:05:16.090

要么增加内存，要么使用单元缓存，或者在从数据库中读取每一行时将其处理到 PHPExcel 中，而不是从数据库中加载所有内容，然后将其全部处理到 PHPExcel 中。

# php - 在 SQL Server Native Client 10.0 中执行查询时出错

> ID：10984651
> 
> 赞同：1
> 
> 时间：2012-06-11T17:18:02.133
> 
> 标签：php, sql-server, codeigniter, activerecord, odbc

我最近又开始使用 php（上次好像是 7 年前），一些朋友推荐我使用 codeigniter 框架。

我尝试使用 odbc 驱动程序连接到 MSSQL 2008 R2 中的数据库服务器，使用 x64 php 版本而不是 x64 IIS。这是原因之一，因为我没有使用微软提供的php原生驱动程序，另一个是因为生产环境将在CentOS中，顺便说一句，使用该驱动程序没有任何意义....

切中要害：尝试使用活动记录/odbc 配置连接到数据库会引发此错误

```
A Database Error Occurred
--------------------------
Error Number: 01000
[Microsoft][SQL Server Native Client 10.0][SQL Server]Executing SQL directly; no cursor.
SELECT * FROM (WebUsers)
Filename: C:\projects\php\test\system\database\DB_driver.php
Line Number: 330 
```

我只执行一个简单的查询来检索表。

```
$query = $this->db->get('WebUsers');
return $query->result_array(); 
```

这些是我的连接设置：

```
$db['default']['hostname'] = 'Driver={SQL Server Native Client 10.0};Server=localhost;Database=XXXXXXXXX;';
$db['default']['username'] = 'WWWWWW';
$db['default']['password'] = 'YYYYYY';
$db['default']['database'] = 'XXXXXXXXX';
$db['default']['dbdriver'] = 'odbc';
$db['default']['dbprefix'] = '';
$db['default']['pconnect'] = FALSE;
$db['default']['db_debug'] = TRUE;
$db['default']['cache_on'] = FALSE;
$db['default']['cachedir'] = '';
$db['default']['char_set'] = 'utf8';
$db['default']['dbcollat'] = 'utf8_general_ci';
$db['default']['swap_pre'] = '';
$db['default']['autoinit'] = TRUE;
$db['default']['stricton'] = FALSE; 
```

不知道如何解决

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T18:32:49.947

我认为这是 CI 中的一个老错误。您必须在**/system/database/drivers/odbc/odbc_driver.php**中修改函数**_form_tables()**

 **```
function _from_tables($tables)
{
    if ( ! is_array($tables))
    {
        return strstr($tables, ',') ? '('.$tables.')' : $tables;
    }
    else
    {
        return count($tables) > 1 ? '('.implode(', ', $tables).')' : end($tables);
    }
} 
```

希望这会奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-09T11:09:23.377

```
$this->db->query($sql); 
```

而不是上面的查询使用波纹管方法在codeigniter中执行过程

```
 $this->db->simple_query($sql); 
```**

# javascript - Javascript 立即调用函数模式

> ID：10984652
> 
> 赞同：12
> 
> 时间：2012-06-11T17:18:02.577
> 
> 标签：javascript, function, design-patterns

你把这些模式叫做什么？它们之间有什么区别？你什么时候使用每个？还有其他类似的模式吗？

```
(function() {
    console.log(this);  // window
})();

(function x() {
    console.log(this);  // window
})();

var y = (function() {
    console.log(this);  // window
})();

var z = function() {
    console.log(this);  // window
}(); 
```

**编辑：**通过命名最后两种情况下的函数，我发现了另外两种看似多余的方法......

```
var a = (function foo() {
    console.log(this);  // window
})();

var b = function bar() {
    console.log(this);
}(); 
```

**EDIT2：** 这是@GraceShao 下面提供的另一种模式，它使函数可以在函数范围之外访问。

```
(x = function () {
    console.log(this);  // window
    console.log(x);     // function x() {}
})();
console.log(x);         // function x() {}

// I played with this as well 
// by naming the inside function 
// and got the following:

(foo = function bar() {
    console.log(this);  // window
    console.log(foo);   // function bar() {}
    console.log(bar);   // function bar() {}
})();
console.log(foo);       // function bar() {}
console.log(bar);       // undefined 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-06-11T17:23:08.773

以下是您的函数，并附有一些注释，描述了它们何时/为什么有用：

```
(function() {
    // Create a new scope to avoid exposing 
    // variables that don't need to be
    // This function is executed once immediately
})();

(function fact(i) {
    // This named immediately invoked function 
    // is a nice way to start off recursion
    return i <= 1 ? 1 : i*fact(i - 1);
})(10);

var y = (function() {
    // Same as the first one, but the return value 
    // of this function is assigned to y
    return "y's value";
})();

var z = function() {
    /* This is the exact same thing as above 
     (except it is assigned to z instead of y, of course).
     The parenthesis in the above example don't do anything
     since this is already an expression
    */
}(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-11T17:31:59.317

在这种情况下，它们在语义上都是相同的。[ECMAScript 规范](http://es5.github.com/)包含完整的生产规则，所以这是一个大体上的简化。

另请注意，我忽略了命名函数的名称 ( `x`)，因为未使用该名称；它可以*在正文*中引用，但由于它是一个[FunctionExpression](http://es5.github.com/#x13)（通过语法产生），它永远不会（在*正确*的JS 实现中）污染包含范围 - 请参阅注释。

```
(function() {
    console.log(this);  // window
})();

(function x() {
    console.log(this);  // window
})();

var y = (function() {
    console.log(this);  // window
})();

var z = function() {
    console.log(this);  // window
}(); 
```

减少（在这种情况下，主体是无关紧要的，它们都“返回未定义”）：

```
(function() {})();

(function x() {})();

var y = (function() {})();

var z = function() {}(); 
```

简化（在 ECMAScript 语法`FunctionExpression`中是生产规则，但在这里我用它来表示“作为函数的表达式”）：

```
FunctionExpression()

FunctionExpression()

var y = FunctionExpression()

var z = FunctionExpression() 
```

忽略结果的赋值（总是`undefined`）可以看出所有的形式都是一样的。

快乐编码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T17:34:32.113

自调用**匿名**函数。函数体将立即被调用。

```
(function() {
    console.log(this);  // window
})(); 
```

自调用函数。函数体将立即被调用。您仍然可以在`x`函数体内引用该函数。所以当你想立即执行某事，然后你可能想迭代它，你可以直接引用它。

```
(function x() {
    console.log(this);  // window
    console.log(x);     // function x() {}
})(); 
```

右侧的自调用匿名函数会立即被调用，并将返回值赋给`y`. 通常当你使用这个模式时它有一个返回值，否则，y 将是`undefined`.

```
var y = (function() {
    console.log(this);  // window
})(); 
```

IMO，它与第三个相同。封闭函数的第三个括号只是为了使函数看起来像一个完整的东西。但是两者的功能是一样的。

```
var z = function() {
    console.log(this);  // window
}(); 
```

与第二个类似，但您可以使用以下方法在函数范围之外引用 x：

```
(x = function () {
    console.log(this);  // window
    console.log(x);     // function x() {}
})();
console.log(x);         // function x() {} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-21T04:07:28.583

(function() { **'use strict';** 可以使用这种类型

为什么？：IIFE 立即调用函数表达式从全局范围中删除变量。这有助于防止变量和函数声明在全局范围内的生存时间超过预期，这也有助于避免变量冲突。

为什么？：当您的代码被压缩并捆绑到一个文件中以部署到生产服务器时，您可能会遇到变量和许多全局变量的冲突。IIFE 通过为每个文件提供可变范围来保护您免受这两种情况的影响。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-23T12:33:48.530

是时候使用 ES06 了，这里是使用 ES06 中箭头函数的函数。

```
 (() => {
    // Create a new scope to avoid exposing variables that don't need to be
    // This function is executed once immediately
})();

(fact = (i)=>(
  // This named immediately invoked function is a nice way to start off recursion
  i <= 1 ? 1 : i*fact(i - 1)
))(10)

const y = (() => (
    // Same as the first one, but the return value of this function is assigned to y
     "y's value"
))();

const z = (() => {
    // This is the exact same thing as above (except it's assigned to z instead of y, of course).
    // The parenthesis in the above example don't do anything since this is already an expression
})(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-24T21:37:26.897

浏览器中的 JavaScript 缺少命名空间。每一段代码都在全局范围内运行；因此，内部应用程序代码或第三方依赖项可能会在暴露自己的功能时污染范围。污染全局命名空间会导致名称冲突。这种名称冲突在大型项目中非常常见，并且可能非常有害。

例如，想象一下第三方库实例化了一个名为 utils 的全局变量。如果任何其他库或应用程序代码本身意外覆盖或更改了 utils，则依赖它的代码可能会以某种不可预知的方式崩溃。如果其他库或应用程序代码意外调用另一个仅供内部使用的库的函数，也可能会发生不可预测的副作用。

```
 (function () {
      // create state variables
      // make some operation
      // then return those
      const export = {
           export1: () => {},
           export2: () => {}
      }
      return exported
})() 
```

它用于创建私有范围，仅导出应公开的部分。

## 函数表达式周围的括号

> 为什么我们甚至需要这些？原因纯粹是语法上的。JavaScript 解析器必须能够轻松地区分函数声明和函数表达式。如果我们省略函数表达式周围的括号，并将我们的直接调用作为单独的语句`function(){}(3)`，JavaScript 解析器将开始处理它，并得出结论，因为它是一个以关键字 function 开头的单独语句，它正在处理一个函数宣言。因为每个函数声明都必须有一个名称（这里我们没有指定一个），所以会抛出一个错误。为了避免这种情况，我们将函数表达式放在括号中，向 JavaScript 解析器发出信号，它正在处理一个表达式，而不是一个语句。

您可能还会在某些项目中看到这一点：

```
+function(){}();
-function(){}();
!function(){}();
~function(){}(); 
```

这一次，我们可以使用一元运算符，而不是在函数表达式周围使用括号来将它们与函数声明区分开来`+ , - , ! , and ~`：我们这样做是为了向 JavaScript 引擎发出信号，表明它正在处理表达式而不是语句。

# c++ - 为什么 sizeof(int) 与 sizeof(int*) 不同？

> ID：10984659
> 
> 赞同：6
> 
> 时间：2012-06-11T17:18:35.160
> 
> 标签：c++, c, sizeof

我想知道为什么在以下程序中`sizeof(int)`返回的值与`sizeof(int*)`.

这是小程序：

```
int main(){
    std::cout<<sizeof(int)<<endl;
    std::cout<<sizeof(int*)<<endl;
    return 0;
} 
```

这是输出：

```
4
8 
```

直到现在我记得一个整数指针的大小是 4byte（gcc 编译器）。如何检查指针的正确大小？是否依赖计算机？

我正在运行 ubuntu 12.04

```
# lsb_release -a

Distributor ID: Ubuntu 
Description: Ubuntu 12.04 LTS 
Release:    12.04 
Codename:   precise 
```

指针的大小是不是恒定的（标准大小）8 字节。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-11T17:20:57.280

an`int`和 an的大小`int*`完全取决于编译器和硬件。如果您看到在 中使用了 8 个字节`int*`，则您可能拥有 64 位硬件，这意味着每个指针有 8 个字节。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-11T17:22:32.940

`sizeof(char) == 1`

没有其他保证（*）。

实际上，指针大小在 16 位系统上为 2，在 32 位系统上为 4，在 64 位系统上为 8。

* * *

(*) 见 James Kanze 的评论。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-11T17:21:25.780

指针的大小取决于系统、编译器和体系结构。在 32 位系统上通常是 32 位，而在 64 位系统上通常是 64 位。

如果您尝试将指针存储到整数中以便以后再次恢复到指针中，则可以使用`intptr_t`整数类型，该类型足够大以容纳（我相信）普通（非函数）指针类型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-11T17:24:25.827

> 对于 32 位系统，“事实上的”标准是 ILP32——也就是说，int、long 和 pointer 都是 32 位的量。
> 
> 对于 64 位系统，主要的 Unix 'de facto' 标准是 LP64 - long 和 pointer 是 64 位（但 int 是 32 位）。Windows 64 位标准是 LLP64 - long long 和 pointer 是 64 位（但 long 和 int 都是 32 位）。
> 
> 曾经，一些 Unix 系统使用 ILP64 组织。
> 
> 这些事实上的标准都没有被 C 标准 (ISO/IEC 9899:1999) 立法，但都被它所允许。

和

> 如果您关心可移植性，或者您希望类型的名称反映大小，您可以查看 header ，其中可以使用以下宏：
> 
> `int8_t int16_t int32_t int64_t`
> 
> `int8_t`保证为8位，`int16_t`保证为16位等。

看到这个[问题](https://stackoverflow.com/questions/589575/size-of-int-long-etc)。

# linux - 如何在 linux 中实现脚本/程序的 cpu 时间超时？

> ID：10984661
> 
> 赞同：2
> 
> 时间：2012-06-11T17:18:52.253
> 
> 标签：linux, timeout, cpu-time

重要的是不要测量某些程序/脚本的用户时间，而是测量 cpu 时间并在超出此时间限制时将其终止。

最好的方法是什么？

最明显的解决方案之一是检查某个时间步长流程树，以查看请求的程序/脚本是否没有超出其限制。它在 perl 脚本 ( [pshved/timeout](https://github.com/pshved/timeout) ) 中实现。我正在寻找其他方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T18:01:56.743

您可以使用`ulimit(1)`或`setrlimit(2)`来限制 cpu 时间。如果该进程使用更多的 cpu 时间，它将被自动杀死。也可以指定一个可以忽略的软限制。

简单的例子：

```
#! /bin/bash
(
    ulimit -t 5
    python -c '
a, b = 0, 1
while True:
    a += b
    b += a
'
    echo $?
)
echo "..." 
```

# android - 如何复制 Android 项目以制作专业版？

> ID：10984662
> 
> 赞同：0
> 
> 时间：2012-06-11T17:18:54.173
> 
> 标签：android

我想制作一个无广告且包含更多功能的应用程序专业版。我曾尝试复制项目并更改类名等，但它不想运行。所以我想知道是否有一种简单的方法可以将其存档，或者我是否必须完成所有操作并复制和粘贴每个文件并更改路径和内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:20:44.720

我不确定，但您可以尝试在 Eclipse 的新项目中使用“从现有源创建”选项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:21:26.310

多年后编辑：这就是构建风味的目的。

* * *

最好的方法是通过图书馆。将你所有的通用代码塞进一个 Android 库项目中，创建两个应用程序 - 免费和专业版，让它们都引用该库。您甚至可以将一些资源放入库中。

您甚至可以在图书馆进行整个活动。只要确保清单正确列出了活动类名称，以防应用程序和库之间的 Java 包名称不同。

至于项目复制，您可能忘记相应地更改清单。

# php - PHP变量在SQL查询中不起作用？

> ID：10984663
> 
> 赞同：2
> 
> 时间：2012-06-11T17:18:57.573
> 
> 标签：php, mysql, sql, database

```
echo $date1u 
```

给我 2010-04-21

当我将该日期硬编码到 SQL 查询中时，它可以正常工作

```
SELECT * FROM phoneappdetail WHERE salebarn = 'OSI' AND saledate = '2010-04-21' 
```

但是当我直接使用 $date1u 时，它根本不起作用。

```
"SELECT * FROM phoneappdetail WHERE salebarn = 'OSI' AND saledate = '".$date1u."' " 
```

我的变量 $date1u 或 SQL 格式有什么问题阻止它工作？

*编辑*

听从了建议并尝试了

```
$result1 = "SELECT * FROM phoneappdetail WHERE salebarn = 'OSI' AND saledate = '".$date1u."' ";
echo $result1; 
```

查看结果以及在这种情况下如何输出

```
 SELECT * FROM phoneappdetail WHERE salebarn = 'OSI' AND saledate = '2010-04-22' 
```

一些当我单独回显 $date1u 时，它的 2010-04-21 但是当我在 SQL 查询中回显 var 时，添加了 1 天

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:28:46.437

变量的两侧是否有任何空格 - 即空格或制表符？如果是这样，这可能是导致问题的原因。

尝试`echo ">>" . $date1u . "<<";`

如果你得到 ">> 2010-04-21<<" 你就会知道你有一个领先的空间。获取可变长度也可能有助于查明问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:20:59.593

我想知道`$date1u`返回的值是否返回一个用引号括起来的值。如果是这样，您需要先删除引号，然后再将其插入 SQL 查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:37:38.373

我在我的服务器上试过这个并且它有效。

```
"SELECT * FROM phoneappdetail WHERE salebarn='OSI' AND saledate='$date1u'" 
```

它可能不是完美的编程，但它确实有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T17:44:28.080

尝试这个

```
"SELECT * FROM phoneappdetail WHERE salebarn = 'OSI' AND saledate = '" . trim($date1u) . "'" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-11T17:26:07.943

我正在猜测

这个：

```
SELECT * FROM phoneappdetail WHERE salebarn = 'OSI' AND saledate = '2010-04-21' 
```

应该是这样的：

```
SELECT * FROM phoneappdetail WHERE salebarn = 'OSI' AND saledate = 2010-04-21 
```

你需要拿出`''`日期。这是针对 sql 查询错误的。

# javascript - 如何在 kendo ui 折线图中对齐类别标签？

> ID：10984665
> 
> 赞同：0
> 
> 时间：2012-06-11T17:19:10.197
> 
> 标签：javascript, kendo-ui

我有一个大约 80 个数据点的剑道 ui 折线图设置。这些数据点跨越 5 个类别。

类别标签全部集中在图表的左侧，我不确定如何让它们分布在图表区域的宽度上。

这是带有演示数据的 jsfiddle：

[http://jsfiddle.net/robotsushi/kETTu/5/](http://jsfiddle.net/robotsushi/kETTu/5/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:13:07.520

供将来参考，上述方案是不可能的。需要用散点图来完成。

# javascript - 使用复选框提交表单

> ID：10984671
> 
> 赞同：-3
> 
> 时间：2012-06-11T17:19:35.237
> 
> 标签：javascript, jquery, forms

我正在尝试使用 jQuery 提交表单。到目前为止我的代码

查询：

```
$(document).ready(function () {
    $("#display").on("change", "input:checkbox", function () {
        $("#display").submit();
    });
}); 
```

PHP：

```
<form id="display">
    <input type="checkbox" name="hd" value="1"
        <?php
        if ($_SESSION['hd'] == 1) {
            echo "checked=\"checked\"";
        }
        ?>>HD
    <input type="checkbox" name="sd" value="1"
        <?php
        if ($_SESSION['sd'] == 1) {
            echo "checked=\"checked\"";
        }
        ?>>SD
</form> 
```

提交功能工作正常，但它不保留表单中的值，似乎提交是在分配值之前触发的。可以做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:22:13.563

> 似乎在分配值之前触发了提交

正在检查`$_SESSION[]`您的价值吗？这根本不会从表单提交中设置。你可能的意思是`$_POST['hd']`。

# asp.net - 如何对我的 asp.net 网站进行版本控制？

> ID：10984682
> 
> 赞同：2
> 
> 时间：2012-06-11T17:20:38.260
> 
> 标签：asp.net, webserver, versioning

我确信这样做有很多策略，但我对网络服务器如何处理事物以及如何处理这个问题的理解相当薄弱。

我们有一个带有 sql server 后端的 asp.net webforms 站点。我们想要完成的是，当我们将站点更新到 1.5 版时，我们希望让所有当前客户查看 1.0 代码，直到我们为他们推出数据库更新。数据库更新后，它们将指向新版本。

有没有一种相当简单的方法可以做到这一点？我们拥有的模型是我们托管了网站，但他们所有的数据库都是本地的。我考虑过可能有几个不同的 Web 服务器，并像这样循环浏览每个服务器：

服务器 A - 版本 1

服务器 B - 版本 2

ServerC - 版本 3

然后一旦我们到达版本，也许会覆盖版本 1 并继续以这种方式循环它们？这就是为什么我提到我受到服务器/硬件挑战的原因，因为这个想法对于有知识的人来说可能是可笑的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:39:25.533

您可以在同一台服务器上运行多个网站，只需使用不同的端口，

*   站点 1 是服务器：81
*   站点 2 是服务器：82
*   站点 3 是服务器：83

等，并在您的数据库上设置多个目录，每个站点一个

# android - sprint Galaxy Nexus 是否支持 USB 主机模式？

> ID：10984688
> 
> 赞同：2
> 
> 时间：2012-06-11T17:20:50.007
> 
> 标签：android, galaxy

我想知道 sprint Galaxy Nexus 是否支持 USB 主机模式？如此处所述[，](http://developer.android.com/guide/topics/usb/host.html)它应该在 3.1 以上的 android 版本上可用。银河系使用冰淇淋三明治（版本 4+），所以它应该有它。 [该视频](http://www.youtube.com/watch?v=Oqq4L44jOM8)显示有人使用连接了 USB 鼠标的 Galaxy Nexus，因此库存 Galaxy Nexus 版本应该具有此功能。我只是想知道 Sprint 是否以某种方式更改了内核，从而禁用了 USB 主机模式功能。 [该网站](http://www.phonearena.com/phones/compare/Samsung-Galaxy-S-III-Sprint,Samsung-GALAXY-Nexus-Sprint/phones/7099,7035)指出，来自 sprint 的 Galaxy s 具有“大容量存储设备、USB 主机、USB 充电”作为一项功能，但对于来自 sprint 的 Galaxy Nexus，列出的唯一功能是“USB 充电”。
我只是意识到这可能是一个缺失的功能，因为当我尝试使用 Usb 主机模式 api 设置一个小型测试应用程序时，我连接的任何设备都无法识别。我尝试在设备启动后和设备启动前插入设备。[我正在按照此处](http://developer.android.com/guide/topics/usb/index.html)定义的方式无线读取 logcat，因此我可以监控在插入 USB 设备并将其移除时会发生什么。Logcat 什么也没显示。任何解释或链接到其他网站说 Sprint Galaxy nexus 支持或不支持 USB 主机模式将不胜感激（只有 Sprint，我相信 Verizon 确实支持它，但我有一个 Sprint 测试设备）。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T09:04:16.087

Stock Galaxy Nexus 适用于我的 USB 主机模式。能够毫无问题地使用 Ant+ 接收器。

# git - 拉/克隆时出现 Git 错误：存储库已损坏？怎么修？

> ID：10984694
> 
> 赞同：1
> 
> 时间：2012-06-11T17:21:09.913
> 
> 标签：git

我的 git 存储库有问题：

```
git pull origin master
error: unable to find fd0b73869242ccaeb279c9e48641b24af5d5e586
fatal: oops (fd0b73869242ccaeb279c9e48641b24af5d5e586)
fatal: The remote end hung up unexpectedly 
```

请注意，存储库位于我的笔记本电脑和台式计算机之间，因此我在另一个目录中有源代码，“删除并重新创建”我的 git 存储库不是问题。

我在 git 上遇到的最后一个问题是一个命名问题，比如将 XCombobox 重命名为 XComboBox，这给我的存储库带来了很多问题。修好后，我很久没有拉到笔记本电脑上了。

现在我试图打开笔记本电脑，但我遇到了这个问题。有没有可能修复存储库？如何最终通过使用我的桌面存储库中的所有数据来重置它？

感谢您的任何建议

**编辑1：**

如果我尝试克隆我得到的存储库`fatal: unable to read tree [...]`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-10T14:30:04.920

我遇到了同样的错误，设置有点相似（通过 Windows 网络在多台计算机之间共享一个中央裸仓库）。

出于某种原因，在其中一台克隆了中央存储库的计算机上，突然之间什么都没有了。拉取和获取导致您描述的错误。奇怪的是，在网络上的另一台计算机上，克隆中央存储库工作正常。所以问题只发生在网络上一个特定开发人员使用的特定计算机上。

原来是Windows共享权限损坏。修复它的是删除受影响用户对中央存储库文件夹的访问权限，应用更改，然后重新添加权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T18:57:25.340

我自己通过网络解决了修复远程存储库： [http ://rewoo.wordpress.com/2012/02/14/recover-a-corrupt-git-bare-repository/](http://rewoo.wordpress.com/2012/02/14/recover-a-corrupt-git-bare-repository/)

这解决了我的问题，我只运行`git fsck --full`和`git gc --prune=today`

现在克隆和拉动再次起作用。

不管怎么说，还是要谢谢你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:25:09.223

某些东西不在正确的位置。您可以查看 .git/config 文件并确保您的路径名正确。您应该能够修改此文件，然后尝试再次拉取。

# python - 跨模块单例

> ID：10984697
> 
> 赞同：4
> 
> 时间：2012-06-11T17:21:17.960
> 
> 标签：python, design-patterns, singleton

我正在尝试实现单例，但在导入模块时遇到了困难。我的设置如下。我正在使用 Python 2.7。

### 模块 1

```
class SingletonClass(object):
    def __new__(self, *args, **kwargs):
        if not self._instance:
            self._instance = super(SingletonClass, self).__new__(
                                self, *args, **kwargs)
        return self._instance

print SingletonClass()  #OUTPUT: 0x00000000030F1630
print SingletonClass()  #OUTPUT: 0x00000000030F1630 (Good, what I want) 
```

### 模块 2

```
import SingletonClass

class AnotherClass:
    print SingletonClass.SingletonClass() #OUTPUT: 0x0000000003292208 
```

在模块中单例正在工作，但在另一个模块中，单例没有返回与第一个模块中相同的对象。知道为什么吗？

### 编辑

现在，我将放置我发现的唯一有效的东西。我确信对此有更好的解决方案，但我认为这可能更好地传达潜在问题是什么。

### 模块 1

```
class SingletonParent(object):
    _instance = None

    def __new__(self, *args, **kwargs):
        if not self._instance:
            self._instance = super(SingletonParent, self).__new__(
                                self, *args, **kwargs)
        return self._instance 
```

### 模块 2

```
import SingletonParent    
class SingletonClass(object):
        def __new__(self, *args, **kwargs):
            if not SingletonParent.SingletonParent._instance:
               SingletonParent.SingletonParent._instance = super(SingletonClass, self).__new__(
                            self, *args, **kwargs)
            return SingletonParent.SingletonParent._instance 

    print SingletonClass()  #OUTPUT: 0x00000000030F1630
    print SingletonClass()  #OUTPUT: 0x00000000030F1630 
```

### 模块 3

```
import SingletonClass

class AnotherClass:
    print SingletonClass.SingletonClass() #OUTPUT: 0x00000000030F1630 
```

# 解决方案（编辑 3）

教训：不要把你的 main 函数和你的 Singleton 放在同一个模块中！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T01:59:33.020

您的问题很可能是模块以两个不同的名称被导入两次。

要对此进行测试，请添加以下内容：

```
print "Being imported..." 
```

在`module1.py`.

如果此消息被打印两次，则模块被导入两次，这就是您的问题。要修复它，请确保您使用相同的名称在任何地方导入模块[0]，并且您没有使用`sys.path`.

[0]：从技术上讲，这不应该是必要的，但这是一个简单的修复。

# html - d3 边缘标记可能吗？

> ID：10984704
> 
> 赞同：5
> 
> 时间：2012-06-11T17:21:49.320
> 
> 标签：html, svg, d3.js

是否可以使用[d3](http://d3js.org/)在图中添加边标签？我查看了示例和一些文档，我可以看到节点标记在哪里是可能的，但是边缘标记在任何地方都没有明确提到（我可以找到）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-09T09:16:27.427

跟随其他人的例子我

*   `path`在每个边缘添加一个，
*   添加`text`到边缘
*   将该文本绑定到`textpath`引用沿边缘的路径的a

这个例子是使用上面的想法：[http ://bl.ocks.org/jhb/5955887](http://bl.ocks.org/jhb/5955887)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T20:21:19.547

简短的回答是“是”，但没有明确的支持。您必须自己确定标签的位置。这样做的一种方法是将标签附加到起始节点并将其平移到目标节点距离的一半，加上一些偏移量以防止它与线重叠。对于更精细的边缘（例如曲线），这将更加困难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T15:05:34.023

我尝试了路径选项上的文本，但它非常复杂并且没有产生我想要的外观。不幸的是，我没有将它检入本地 git 存储库。这来自我的 Eclipse 历史（感谢 Eclipse 开发人员）。您必须将此代码片段更改为您自己的数据结构，但我希望它会有所帮助。特别要注意将`id`值添加到`lines`选择中，然后通过使用`xlink:href`属性在百分比选择中重用它。另外，我在 中添加了一个`tspan`将`textpath`文本向下移动几个像素，使其出现在路径上而不是路径上。

```
 function drawLines(links) {
        var diagonal = d3.svg.diagonal();
        var format = d3.format(".1%");
        var linkKey = function(l) {return l.target.key; };
        var lines = linesGroup.selectAll("path").data(links, linkKey);
        lines.enter()
            .append("path")
            .on("mouseover", select)
            .on("mouseout", unselect)
            .attr("d", diagonal)
            .attr("id", function (l) { return "interaction-path-target-" + l.target.key; })
            .style("stroke-width", 0.000001);
        lines.exit()
            .transition().duration(500)
            .style("stroke-width", 0.000001)
            .remove();

        lines.transition()
            .delay( function(d, i) { return i * 100; })
            .duration(500)
            .style("stroke-width", function(d) { return d.weight == 0 ? 0.000001 : d.weight / 1000; })
            .attr("d", diagonal);

        var percentages = linesGroup.selectAll("text").data(links, linkKey);
        percentages.enter()
            .append("text")
            .attr("opacity", 1)
            .append("svg:textPath")
            .attr("startOffset", "70%")
            .attr("xlink:href", 
                    function(l) { 
                        return "#interaction-path-target-" + l.target.key; 
                    })
            .append("svg:tspan")
            .attr("dy", 3)
            .attr("class", "percentageText")
        percentages.exit()
            .transition().duration(500)
            .attr("opacity", 0)
            .remove();
        percentages
            .transition()
            .delay( function(d, i) { return i * 100; })
            .duration(500)
            .attr("opacity", 1);

        percentages.select(".percentageText").text(function(d) {
                var newvalue = d.weight ?
                    d.incomming ? percentageIn(d.weight) : percentageOut(d.weight) : 0;
                return format(newvalue);
            });
    } 
```

# jmeter - JMeter 的 RegEx 后处理器返回 null

> ID：10984705
> 
> 赞同：0
> 
> 时间：2012-06-11T17:22:04.990
> 
> 标签：jmeter

以下是一个人为的演示，它重现了我在使用更大的真实测试计划时遇到的问题。我有 3 个屏幕截图来演示 RegEx PostProcessor 在执行期间如何从不匹配。

[**编辑**]*请注意，在我的屏幕截图中，要检查的响应字段显示为“响应消息”。正如解释的那样，我已经测试了 Body 并得到了“null”。如果屏幕截图显示选择了空结果的正文会更好，但这应该仍然有意义*）

**1)**这是视图树中采样器响应的 HTML： [图 1](http://www.mobypicture.com/user/stevenerat/view/13018880/sizes/full)。

请注意，我正在使用 Regex [Pp]age\s\d{1} 在第一个采样器响应的 HTML 中成功找到所需的文本“Page 1”。

**2)**这是第一个采样器上的 RegEx 后处理器： [图 2](http://www.mobypicture.com/user/stevenerat/view/13018875/sizes/full)。

请注意，它使用与之前的屏幕截图相同的正则表达式，默认文本是“notfound”，结果变量是“TempVar”。

*   **a)**屏幕截图显示选择了“主要示例”和“响应消息”。这将返回默认文本。
    **b)**未显示 - 我尝试了“主样本”和“正文”，但返回 null。

**3)**这是第二个采样器的路径，其中第一个采样器正则表达式的结果被输入到 URL 参数中，`?MyVar=${TempVar}` [如图 3 所示](http://www.mobypicture.com/user/stevenerat/view/13018877/sizes/full)。

现在回到[图 1](http://www.mobypicture.com/user/stevenerat/view/13018880/sizes/full)，您将看到在执行过程中，第二个采样器上的动态 URL 在使用“Response Message”时变为“MyVar=notfound”（如果使用“Body”，则变为“MyVar=null”） .

请让我知道我做错了什么。我已经尝试了 RegEx Extractor 屏幕中的每个组合，但我从未能够让它从表达式中返回匹配的文本。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T18:11:16.217

将您正在使用的正则表达式更改为：

```
<h3>This\sis\s([^<]*)<\\/h3> 
```

虽然您使用的正则表达式确实有效（它将在第 1 页匹配），因为它没有使用 () 表示法将值返回给变量，但您最终会得到 null。需要大括号来表示返回的内容。

查看[此页面](http://jmeter.apache.org/usermanual/regular_expressions.html)，它提供了有关 JMeter 如何使用正则表达式的更多详细信息。

# javascript - 无法使 CKEditor InsertHTML 在 IE 8 上工作

> ID：10984708
> 
> 赞同：2
> 
> 时间：2012-06-11T17:22:15.367
> 
> 标签：javascript, textarea, ckeditor

这是我为 ckeditor 启动准备的 textarea：

```
<textarea name="Message" id="RFMessage lol" rows="4" class="ckeditor" onkeydown="if(this.value.length&gt;=1024)this.value=this.value.substring(0,1023);">                        
</textarea> 
```

比我有这个html：

```
<textarea id="message" class="message hide" >WORLDWIDE,Any</textarea> 
```

我需要做的是让JS在.message div上工作以摆脱“，Any”，然后将仅“WORLDWIDE”的干净值放入#RFMessage div

因为我不知道如何在 ckeditor 中运行自定义 JS，所以我从这里使用他们的预定义 API：http: [//docs.cksource.com/ckeditor_api/symbols/CKEDITOR.editor.html](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.editor.html)

我使用 InsertHTML 来获取值并插入它。

这是我的整个 JS：

```
<script>
    $(".message").each(function() {
        $(this).html($(this).html().replace(/,Any/g,""));
        $(this).html($(this).html().replace(/Any,/g,""));
    });        
</script> 

<script>
    CKEDITOR.on( 'instanceReady', function( ev ) {
        var oEditor = CKEDITOR.instances.RFMessage;
        var value = document.getElementById('message').value;
        oEditor.insertHtml(value); 
    });            
</script> 
```

当然 CKEditor 必须加载整个内容。

在 Chrome 和 Firefox 上一切正常，但这在 IE8 上不起作用

我已经根据使用他们的 API 的 CKEditor 示例构建了脚本：http: [//nightly.ckeditor.com/7493/_samples/api.html](http://nightly.ckeditor.com/7493/_samples/api.html)

任何想法可能导致这在 IE8 上不起作用？我还尝试在他们的论坛上搜索任何与 IE8 相关的错误，但找不到任何错误。也许我只是在脚本中遗漏了一些东西？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:38:21.547

在处理编辑器内容时，您应该使用 CKEDITOR 的[getData](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.editor.html#getData)和[setData方法。](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.editor.html#setData)这些方法标准化了编辑器中的数据访问。

# java - 在 Mojo 中使用 @requiresDependencyResolution 时，调试 ClassNotFoundException 会抛出我的 Maven Mojo

> ID：10984716
> 
> 赞同：2
> 
> 时间：2012-06-11T17:23:08.630
> 
> 标签：java, maven

在我开发的插件中抛出了 ClassNotFoundException。不能被 founf 的类肯定存在，其关联项目作为依赖包含在执行项目的 pom.xml 文件中，如下所示：

```
<dependency>
    <groupId>com.example</groupId>
    <artifactId>project-one</artifactId>
<version>1.0-SNAPSHOT</version>
</dependency> 
```

我的插件包含在执行 pom.xml 中，如下所示：

```
<build>
<plugins>
 <plugin>
   <groupId>com.example</groupId>
                <artifactId>project-two-plugin</artifactId>
                <version>1.0</version>
                <executions>
                    <execution>
                        <configuration>
                           <customSettingOne>
                               setting
                           </customSettingOne>
                        </configuration>
                        <phase>prepare-package</phase>
                        <goals>
                            <goal>some-task</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>

        </plugins>
    </build> 
```

我的插件类如下：

```
/**
 *  @goal some-task
 *
 *  @requiresDependencyResolution compile
 */

public class MyPluginMojo extends AbstractMojo {

    /**
     * Directory to save the CSV files to.
     *
     * @parameter alias="customSettingOne"
     * @required
     */
    private File customSettingOne;

} 
```

我已经尝试过使用以下代码：

```
Apache Maven 2.2.1 (r801777; 2009-08-06 20:16:01+0100) 
```

以及 Eclipse m2e 使用的嵌入式版本

```
Embedded (3.0.2/1.0.200.20111228-1245 
```

当我的插件代码尝试从 ProjectOne 加载类时，我得到一个 ClassNotFoundException。

任何人有任何想法我怎么能得到这个的底部？是否可以检查或转储插件中使用的类路径？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T18:39:02.983

我会先在这里检查：

[Maven 类加载指南](http://maven.apache.org/guides/mini/guide-maven-classloading.html)

如果这没有帮助，也许是一些诊断代码，如下所示：

```
package stackoverflow;

import java.net.URL;
import java.net.URLClassLoader;

public class PrintClassLoader {
    public static void main(String[] args) {
        PrintClassLoader pcl = new PrintClassLoader();
        pcl.printClassLoader(pcl.getClass().getClassLoader());
    }

    public void printClassLoader(ClassLoader classLoader) {
        if (null == classLoader) {
            return;
        }
        System.out.println("--------------------");
        System.out.println(classLoader);
        if (classLoader instanceof URLClassLoader) {
            URLClassLoader ucl = (URLClassLoader) classLoader;
            int i = 0;
            for (URL url : ucl.getURLs()) {
                System.out.println("url[" + (i++) + "]=" + url);
            }
        }
        printClassLoader(classLoader.getParent());
    }
} 
```

例如将打印如下内容：

```
--------------------
sun.misc.Launcher$AppClassLoader@35ce36
url[0]=file:/D:/dev/workspaces/3.6/all/Z_temp/target/classes/
url[1]=file:/D:/dev/.m2/repository/javax/mail/mail/1.4/mail-1.4.jar
url[2]=file:/D:/dev/.m2/repository/javax/activation/activation/1.1/activation-1.1.jar
url[3]=file:/D:/dev/.m2/repository/commons-io/commons-io/2.1/commons-io-2.1.jar
--------------------
sun.misc.Launcher$ExtClassLoader@757aef
url[0]=file:/C:/java/jdk/jdk1.6.0_31/jre/lib/ext/dnsns.jar
url[1]=file:/C:/java/jdk/jdk1.6.0_31/jre/lib/ext/localedata.jar
url[2]=file:/C:/java/jdk/jdk1.6.0_31/jre/lib/ext/sunjce_provider.jar
url[3]=file:/C:/java/jdk/jdk1.6.0_31/jre/lib/ext/sunmscapi.jar
url[4]=file:/C:/java/jdk/jdk1.6.0_31/jre/lib/ext/sunpkcs11.jar 
```

# vb.net - 被视为 System.EventArg 的变量似乎是 KeyPressEventArg

> ID：10984720
> 
> 赞同：1
> 
> 时间：2012-06-11T17:23:23.157
> 
> 标签：vb.net, richtextbox

```
Private Sub RichTextView_TextChanged(ByVal sender As Object, ByVal e As 
   KeyPressEventArgs) Handles RichTextView.KeyPress, RichTextView.TextChanged

    Dim c As Char = e.KeyChar
    Dim i As Integer = Asc(c)
    Dim h As Char = Chr(i)

capitalise_first_letter.Add(h)
End Sub 
```

上面的代码产生错误：它在（capitalise_first_letter 是一个字符串列表）`Unable to cast object of type 'System.EventArgs' to type 'System.Windows.Forms.KeyPressEventArgs'.` 抛出错误。`capitalise_first_letter.Add(h)`

为什么？既然 h 是 e.KeyChar 进行了转换？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:25:39.660

这是因为您还尝试使用相同的例程来处理`RichTextView.TextChanged`，但没有通过`KeyPressEventArg`。

`TextChanged`如果你想允许它，你需要一个单独的事件处理程序`KeyPressEventArgs`。

# php - 贝宝数字商品不显示“以访客身份购买”选项

> ID：10984721
> 
> 赞同：0
> 
> 时间：2012-06-11T17:23:23.697
> 
> 标签：php, codeigniter, paypal

> **可能重复：**
> [贝宝数字商品集成如何启用以访客身份付款？](https://stackoverflow.com/questions/10774223/paypal-digital-goods-integration-how-to-enable-pay-as-guest)

我正在使用 paypal php 向导 `(https://www.paypal-labs.com/integrationwizard/)`生成代码来处理数字商品支付。但是为什么没有“作为客人购买”的选项（即直接用信用卡支付）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T23:35:44.070

1.  您必须将以下项目添加到 SetExpressCheckout 方法以在实时站点上启用此选项：

    SOLUTIONTYPE=鞋底

# asp.net - Entity Framework4，查看生成的查询？

> ID：10984722
> 
> 赞同：0
> 
> 时间：2012-06-11T17:23:33.263
> 
> 标签：asp.net, asp.net-mvc-3, linq, entity-framework, entity-framework-4

我正在使用 Entity Framework4（代码优先）。

我想查看生成的查询。

我在 Stackoverflow 中找到了这段代码。

```
var trace = ((System.Data.Objects.ObjectQuery)result).ToTraceString(); 
```

但这不起作用，错误消息说，

```
Unable to cast object of type 'System.Data.Entity.Infrastructure.DbQuery`1[PJ.Mysql.Entities.Order]' to type 'System.Data.Objects.ObjectQuery'. 
```

我的代码是，

```
[HttpGet]
public void test()
{
    EFOrdersRepository ordersRepository = new EFOrdersRepository();
    var query = ordersRepository.Orders;

    var result = from x in query
         where x.orderid == 99008326
         select x;

    var trace = ((System.Data.Objects.ObjectQuery)result).ToTraceString(); //it does not work

    Response.Write(trace);
} 
```

EFOrdersRepository.cs

```
 public class EFOrdersRepository
{
private EFMysqlContext context = new EFMysqlContext();

public IQueryable<Order> Orders
{
    get { return context.orders; }
}
} 
```

EFMysqlContext.cs

```
class EFMysqlContext : DbContext
{
     public DbSet<Order> orders { get; set; }
} 
```

我真的很想解决这个问题=3，有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:25:10.380

查看允许您跟踪 SQL 查询的[迷你分析器。](http://miniprofiler.com/)这是一篇[很好的博客文章](http://www.mindscapehq.com/blog/index.php/2011/07/28/using-the-asp-net-mvc-mini-profiler-with-lightspeed/)，详细介绍了它的设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T17:25:44.683

我认为这会起作用：

```
var trace = result.ToString(); 
```

# javascript - 如何覆盖特定数组的方法？

> ID：10984725
> 
> 赞同：0
> 
> 时间：2012-06-11T17:23:53.250
> 
> 标签：javascript

我需要覆盖特定数组的方法，而不是每个数组，只是一个对象，它需要像普通数组一样工作，如下所示：

```
var arr1 = [];
var arr2 = [];

overrideThatWay(arr1);

arr1.push(2); //invoke overrided method
arr2.push(2); //invoke regular method

for(var a1 in arr1){
//act like an array, dont list the overrided methods
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:27:23.583

```
arr1.push = function (item) {
// "overloaded" function
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:34:03.727

也许是这样，但我不知道其中的含义：

```
Object.defineProperty(arr1, "push", {
          enumerable: false
        , configurable: true
        , writable: false
        , value: function(prop) {
                    //do something
                }

}); 
```

# android - 程序不返回任何值

> ID：10984726
> 
> 赞同：0
> 
> 时间：2012-06-11T17:23:58.087
> 
> 标签：android, web-services, return

我是android编程的新手。刚刚编写了这段代码，通过网络服务将公斤转换为克。该程序从用户那里获取输入并在文本框中返回值，但遗憾的是我没有得到任何值。请帮忙。

```
package com.example.Passing;

import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.PropertyInfo;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapPrimitive;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

public class PassingActivity extends Activity
{
private final String NAMESPACE = "http://www.webserviceX.NET/";
private final String URL = "http://www.webservicex.net/ConvertWeight.asmx";
private final String SOAP_ACTION = "http://www.webserviceX.NET/ConvertWeight";
private final String METHOD_NAME = "ConvertWeight";

/** Called when the activity is first created. */

Button   mButton;
EditText mEdit;

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    mButton = (Button)findViewById(R.id.button);
    mEdit   = (EditText)findViewById(R.id.editText);

    mButton.setOnClickListener(

            new View.OnClickListener()
            {

                public void onClick(View view)
                {
                    String weight = mEdit.getText().toString();

                    String fromUnit = "Kilograms";
                    String toUnit = "Grams";

                    SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME); 

                    PropertyInfo weightProp =new PropertyInfo();
                    weightProp.setName("Weight");
                    weightProp.setValue(weight);
                    weightProp.setType(double.class);
                    request.addProperty(weightProp);            

                    PropertyInfo fromProp =new PropertyInfo();
                    fromProp.setName("FromUnit");
                    fromProp.setValue(fromUnit);
                    fromProp.setType(String.class);
                    request.addProperty(fromProp);

                    PropertyInfo toProp =new PropertyInfo();
                    toProp.setName("ToUnit");
                    toProp.setValue(toUnit);
                    toProp.setType(String.class);
                    request.addProperty(toProp);

                    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
                    envelope.dotNet = true;
                    envelope.setOutputSoapObject(request);
                    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

                    try 
                    {
                        androidHttpTransport.call(SOAP_ACTION, envelope);
                        SoapPrimitive response = (SoapPrimitive)envelope.getResponse();
                        Log.i("myApp", response.toString());

                        EditText et = (EditText)findViewById(R.id.my_edit);
                        et.setText("equal"+response.toString());

                        /*  TextView tv = new TextView(this);
                        tv.setText(weight+" "+fromUnit+" equal "+response.toString()+ " "+toUnit);
                        setContentView(tv);*/

                    } 
                    catch (Exception e) 
                    {
                        e.printStackTrace();
                    }
                }
            });
    }} 
```

main.xml如下：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/hello" />

<TextView
    android:id="@+id/textView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<EditText
    android:id="@+id/editText"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10"
    android:inputType="number" >

    <requestFocus />
</EditText>

<EditText 
    android:layout_margin="20dip"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:minLines="15"
    android:maxLines="15"
    android:textSize="12sp"
    android:editable="false"
    android:id="@+id/my_edit"/>

<Button
    android:id="@+id/button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Convert" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:29:26.007

我不熟悉您正在使用的 kSoap 库。但是，您正在调用需要一些时间来处理的 Web 服务，然后尝试立即获取返回值。这看起来有问题。这通常的工作方式是您调用 Web 服务，然后一旦您的服务返回您的数据，就会执行一些回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:35:08.827

SoapPrimitive 并不总是能正常工作。尝试更改获得此类响应的方式：`SoapObject result_xml = (SoapObject) envelope.bodyIn;`

代替`SoapPrimitive response = (SoapPrimitive)envelope.getResponse();`

**编辑：** 这是我使用并完美运行的代码（我使用了 a`Fragment`但你可以在 an 中做同样的事情`Activity`）但请记住，任何长度操作（如互联网，因为它们可能导致网络超时或延迟超过 5 秒）**必须**如果您不想像著名的 ANR 那样产生不需要的副作用，请在线程中完成。

```
 public class TestFragment extends Fragment implements OnClickListener{

    private final String NAMESPACE = "http://www.webserviceX.NET/";
    private final String URL = "http://www.webservicex.net/ConvertWeight.asmx";
    private final String SOAP_ACTION = "http://www.webserviceX.NET/ConvertWeight";
    private final String METHOD_NAME = "ConvertWeight";

    private EditText textToConvert;
    private String weight;
    private Button send;

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        final View view = getView();
        textToConvert = (EditText) view.findViewById(R.id.ammount);
        send = (Button) view.findViewById(R.id.button);
        send.setOnClickListener(this);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        return inflater.inflate( R.layout.main, container, false );
    }

    @Override
    public void onClick(View v) {
        switch (v.getId()) {
        case R.id.button:
            weight = textToConvert.getText().toString();
            new AsyncSendData().execute();
            break;
        default:
            break;
        }
    }

    public class AsyncSendData extends AsyncTask<Void, Void, Void>{

        @Override
        protected Void doInBackground(Void... params) {
            String fromUnit = "Kilograms";
            String toUnit = "Grams";

            SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME); 
            PropertyInfo weightProp =new PropertyInfo();
            weightProp.setName("Weight");
            weightProp.setValue(weight);
            weightProp.setType(double.class);
            request.addProperty(weightProp);            

            PropertyInfo fromProp =new PropertyInfo();
            fromProp.setName("FromUnit");
            fromProp.setValue(fromUnit);
            fromProp.setType(String.class);
            request.addProperty(fromProp);

            PropertyInfo toProp =new PropertyInfo();
            toProp.setName("ToUnit");
            toProp.setValue(toUnit);
            toProp.setType(String.class);
            request.addProperty(toProp);

            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
            envelope.dotNet = true;
            envelope.setOutputSoapObject(request);
            HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

            try 
            {
                androidHttpTransport.call(SOAP_ACTION, envelope);
                SoapObject result_xml = (SoapObject) envelope.bodyIn;
                Log.e("myApp", result_xml.toString());
            } 
            catch (Exception e){
                e.printStackTrace();
            }
            return null;
        }
    }

} 
```

这是我使用的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" 
    >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="From" />

    <EditText
        android:id="@+id/ammount"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:ems="10" 
        android:inputType="number">
        <requestFocus />
    </EditText>

    <Button
        android:id="@+id/button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

</LinearLayout> 
```

所以在 post execute 方法中，您可以更新您的视图...

# asp.net-mvc - 从列表中选择项目 在 MVC 4 中使用模型绑定

> ID：10984727
> 
> 赞同：5
> 
> 时间：2012-06-11T17:24:02.187
> 
> 标签：asp.net-mvc, asp.net-mvc-4, model-binding

给定一个班级

```
public class Person
{
    // Some general properties

    public List<Hobby> Hobbies { get; set; }
}

public class Hobby
{
    // Some properties e.g. Name, etc.
}

static List<Hobby> AllHobbies { get; } 
```

是否可以创建一个允许用户使用模型绑定来选择他的爱好的视图？

当然可以在视图中循环`AllHobbies`并为每个渲染一个`<input type="checkbox" />`，然后在回发控制器中手动连接选定的值。似乎这应该可以通过模型绑定来实现，但我不知道如何。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-11T17:32:32.980

当然，我建议您使用编辑器模板。

让我们假设一个爱好有一个名称和一个布尔字段，指示它是否被用户选择：

```
public class Hobby
{
    public string Name { get; set; }
    public bool Selected { get; set; }
} 
```

然后一个控制器将模型输入视图并处理表单提交：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        var person = new Person
        {
            Hobbies = new[]
            {
                new Hobby { Name = "hobby 1" },
                new Hobby { Name = "hobby 2", Selected = true },
                new Hobby { Name = "hobby 3" },
            }.ToList()
        };
        return View(person);
    }

    [HttpPost]
    public ActionResult Index(Person person)
    {
        var selectedHobbies = person
            .Hobbies
            .Where(x => x.Selected).Select(x => x.Name);
        string message = string.Join(",", selectedHobbies);
        return Content("Thank you for selecting: " + message);
    }
} 
```

然后是一个包含允许用户选择爱好的表单的视图：

```
@model Person

@using (Html.BeginForm()) 
{
    <h2>Hobbies</h2>
    @Html.EditorFor(x => x.Hobbies)
    <button type="submit">OK</button>
} 
```

和一个相应的编辑器模板，它将为集合的每个元素自动呈现`Hobbies`（`~/Views/Home/EditorTemplates/Hobby.cshtml`-> 请注意模板的名称和位置很重要）：

```
@model Hobby

<div>
    @Html.LabelFor(x => x.Selected, Model.Name)
    @Html.HiddenFor(x => x.Name)
    @Html.CheckBoxFor(x => x.Selected)
</div> 
```

对于更高级的编辑场景，我建议您阅读 Steven Sanderson关于此主题的[博客文章。](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)

# java - 在 Android 上将 TextView 动态添加到 ScrollView

> ID：10984729
> 
> 赞同：0
> 
> 时间：2012-06-11T17:24:31.157
> 
> 标签：java, android, android-activity

我尝试让 ScrollView 像 ListView 一样工作。所以每一行都将是一个动态添加的 TextView。但程序崩溃。我在 LinearLayout 中有一个 ScrollView。我做错了什么？谢谢。

这是我的代码

```
 scroll = (ScrollView)findViewById(R.id.scrollView1);
                    layout = (LinearLayout) findViewById(R.id.LinearLayout1);
                    layout.setBackgroundColor(Color.TRANSPARENT);
                    TextView[] tx = new TextView[10];
                    for (int i = 0; i < 10; i++) {
                        tx[i] = new TextView(HelloWorldActivity.this);
                        tx[i].setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
                    tx[i].setText("This is the textviewNo" + i);
                    layout.addView(tx[i]);
                    }

                    scroll.addView(layout); 
```

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/RelativeLayout1"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:gravity="center_horizontal"
android:orientation="vertical" >

<TextView
    android:id="@+id/timeflag"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Large Text"
    android:textAppearance="?android:attr/textAppearanceLarge"
    android:textSize="50sp" 
    android:gravity="center"/>

<Button
    android:id="@+id/pause"
    android:layout_width="match_parent"
    android:layout_height="100dp"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/timeflag"
    android:layout_marginTop="37dp"
    android:text="Start" />

<LinearLayout
    android:id="@+id/LinearLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/pause"
    android:orientation="vertical" >

    <ScrollView
        android:id="@+id/scrollView1"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

    </ScrollView>

</LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:32:14.317

一个 scrollView 只能有一个孩子。如果您尝试向滚动视图添加超过 1 个孩子，那么它将崩溃。您应该在滚动视图中拥有 LinearLayout，然后将 textViews 动态添加到线性布局中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:34:29.970

您正在尝试将其添加`LinearLayout1`为自己孩子的孩子（成为您自己的祖父，这是一个令人困惑的概念）。

像这样改变你的XML：

```
<ScrollView
    android:id="@+id/scrollView1"
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/pause"
    >

    <LinearLayout
        android:id="@+id/LinearLayout1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >

    </LinearLayout>

</ScrollView> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:34:37.393

您不能将视图添加到滚动视图。您只能将它们添加到视图组，例如线性或相对布局。

目前尚不清楚您要实现的目标，但是为此使用列表视图有什么问题？您可以在列表视图上设置最大高度。或者你可以试试 wdziemia 的建议

# ssis - ssis 中的事务隔离级别如何工作？

> ID：10984731
> 
> 赞同：3
> 
> 时间：2012-06-11T17:24:45.420
> 
> 标签：ssis

我对 ssis 事务隔离级别几乎没有疑问。考虑一个场景：我有一个执行 SQL 任务，它在表 A 中插入数据。这个任务指向一个数据流任务，它读取之前插入到 AI 上的数据已经开始分布式事务，如果我在 ssis 中设置事务隔离如已提交，是否首先提交表 A 执行 sql 任务并移动到数据流任务？在这种情况下，其他隔离级别又如何呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T14:09:51.963

从我从您的问题中可以理解的情况来看，如果您想在数据写入表的同一事务中从表中读取数据，那么适当的事务隔离是什么？据我所知，应该没关系。隔离类型仅解决另一个事务想要修改未提交事务正在修改的相同行的情况。换句话说，只是读取表应该没有问题，您应该会看到来自第一个 Execute SQL 任务的数据。事务中写入的数据在事务提交之前可用。

为了进一步阅读，这是来自 Oracle 文档，但相同的定义应该适用于 SQL 和 SSIS 包。请注意，当两个事务想要修改相同的数据时，它们会处理：

SERIALIZABLE：如果可序列化事务尝试执行 SQL 数据操作语句，该语句修改已被未提交事务修改的任何表，则该语句将失败。

READ COMMITTED：如果一个事务包含需要由另一个事务持有的行锁的 SQL 数据操作语句，则该语句会一直等待，直到行锁被释放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-09T22:21:37.210

**不要拒绝这个答案。**我从 MSDN 论坛得到它，我把它放在这里以供参考。

[http://social.msdn.microsoft.com/Forums/en-US/3dcea5f6-32ef-40aa-90d5-0f2fef9e1d38/isolation-level-in-ssis](http://social.msdn.microsoft.com/Forums/en-US/3dcea5f6-32ef-40aa-90d5-0f2fef9e1d38/isolation-level-in-ssis)

一些观察...

SSIS 组件中的 IsolationLevel 属性仅在使用分布式事务时适用（包或其他容器具有 TransactionOption=Required）。所以在这方面，隔离级别在 SSIS 中有点误导。即使您设置了它，除非 SSIS 打开事务，否则它也无济于事。我在这里写了这个限制：http: [//msdn.microsoft.com/en-us/library/microsoft.sqlserver.dts.runtime.dtscontainer.isolationlevel.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.dts.runtime.dtscontainer.isolationlevel.aspx)

如果您正在自定义从 SSIS 调用的 TSQL 中的隔离级别（存储过程或只是在批处理的开头），您可以覆盖默认的 SQL Server 隔离级别 Read_committed，但是如果您只是指向一个表名数据流源或目标，您不能设置隔离级别。

如果您选择在每个查询中以其他方式手动设置隔离级别，有一些技巧： 1\. 如果您要在命令“设置事务隔离级别读取未提交” [http://msdn中运行 SET 选项.microsoft.com/en-us/library/ms173763.aspx](http://msdn.microsoft.com/en-us/library/ms173763.aspx)

小心读取未提交和无锁，因为它可以读取脏数据（通量中的数据更改未完全由其他连接提交。）

1.  使用锁定提示，例如[http://technet.microsoft.com/en-us/library/ms187373.aspx](http://technet.microsoft.com/en-us/library/ms187373.aspx) select * from t1 (nolock)

2.  [如果在驱动程序http://msdn.microsoft.com/en-us/library/ms175909.aspx](http://msdn.microsoft.com/en-us/library/ms175909.aspx)的连接字符串或驱动程序属性中有一个地方可以覆盖它，请在 OLEDB 或 ODBC 中设置自动提交隔离级别'没有测试过，但它可能是可能的。

要查看正在使用的隔离级别，如果您连接的 RDBMS 是 SQL Server 2005/2008，而连接/会话仍处于活动状态，您可以查询 DBCC USEROPTIONS 或从 dm_exec_sessions 中选择

select transaction_isolation_level,* from sys.dm_exec_sessions (0 = Unspecified, 1 = ReadUncomitted, 2 = ReadCommitted, 3 = Repeatable, 4 = Serializable, 5 = Snapshot)

我们还发现快照隔离级别与分布式事务不兼容，因此无法通过 SSIS 属性使用快照隔离级别。一种解决方法是直接在数据源和 ExecuteSqlTask​​ 命令中使用 TSQL 语法进行快照隔离。

祝你好运，Jason 他的 MSDN 个人资料 - [http://social.msdn.microsoft.com/profile/jason%20h%20(hdinsight)/?ws=usercard-mini](http://social.msdn.microsoft.com/profile/jason%20h%20(hdinsight)/?ws=usercard-mini)

# objective-c - 为什么我们不能在当前队列上使用 dispatch_sync？

> ID：10984732
> 
> 赞同：60
> 
> 时间：2012-06-11T17:25:08.090
> 
> 标签：objective-c, multithreading, objective-c-blocks, grand-central-dispatch

我遇到了一个场景，我有一个委托回调，它可能发生在主线程或另一个线程上，直到运行时（使用`StoreKit.framework`）我才知道哪个。

我还有需要在回调中更新的 UI 代码，这需要在函数执行之前发生，所以我最初的想法是有一个这样的函数：

```
-(void) someDelegateCallback:(id) sender
{
    dispatch_sync(dispatch_get_main_queue(), ^{
        // ui update code here
    });

    // code here that depends upon the UI getting updated
} 
```

当它在后台线程上执行时，效果很好。但是，当在主线程上执行时，程序会陷入死锁。

仅这一点对我来说似乎很有趣，如果我`dispatch_sync`正确阅读了文档，那么我希望它直接执行该块，而不用担心将其安排到运行循环中，如此处[所述](https://developer.apple.com/library/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/c/func/dispatch_sync)：

> 作为一种优化，此函数在可能的情况下调用当前线程上的块。

但是，这没什么大不了的，它只是意味着更多的打字，这导致我采用这种方法：

```
-(void) someDelegateCallBack:(id) sender
{
    dispatch_block_t onMain = ^{
        // update UI code here
    };

    if (dispatch_get_current_queue() == dispatch_get_main_queue())
       onMain();
    else
       dispatch_sync(dispatch_get_main_queue(), onMain);
} 
```

然而，这似乎有点倒退。这是 GCD 制作中的错误，还是我在文档中遗漏了什么？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-03-31T02:50:54.313

`dispatch_sync`做两件事：

1.  排队一个块
2.  阻塞当前线程，直到该块完成运行

鉴于主线程是一个串行队列（这意味着它只使用一个线程），如果您在主队列上运行以下语句：

```
dispatch_sync(dispatch_get_main_queue(), ^(){/*...*/}); 
```

将发生以下事件：

1.  `dispatch_sync`将块放入主队列中。
2.  `dispatch_sync`阻塞主队列的线程，直到块完成执行。
3.  `dispatch_sync`永远等待，因为该块应该运行的线程被阻塞了。

理解这个问题的关键是`dispatch_sync`不执行块，它只是将它们排队。执行将在运行循环的未来迭代中发生。

以下方法：

```
if (queueA == dispatch_get_current_queue()){
    block();
} else {
    dispatch_sync(queueA, block);
} 
```

很好，但请注意，它不会保护您免受涉及队列层次结构的复杂场景的影响。在这种情况下，当前队列可能与您尝试发送块的先前阻塞队列不同。例子：

```
dispatch_sync(queueA, ^{
    dispatch_sync(queueB, ^{
        // dispatch_get_current_queue() is B, but A is blocked, 
        // so a dispatch_sync(A,b) will deadlock.
        dispatch_sync(queueA, ^{
            // some task
        });
    });
}); 
```

对于复杂的情况，在调度队列中读/写键值数据：

```
dispatch_queue_t workerQ = dispatch_queue_create("com.meh.sometask", NULL);
dispatch_queue_t funnelQ = dispatch_queue_create("com.meh.funnel", NULL);
dispatch_set_target_queue(workerQ,funnelQ);

static int kKey;

// saves string "funnel" in funnelQ
CFStringRef tag = CFSTR("funnel");
dispatch_queue_set_specific(funnelQ, 
                            &kKey,
                            (void*)tag,
                            (dispatch_function_t)CFRelease);

dispatch_sync(workerQ, ^{
    // is funnelQ in the hierarchy of workerQ?
    CFStringRef tag = dispatch_get_specific(&kKey);
    if (tag){
        dispatch_sync(funnelQ, ^{
            // some task
        });
    } else {
        // some task
    }
}); 
```

解释：

*   我创建了一个`workerQ`指向队列的`funnelQ`队列。在实际代码中，如果您有多个“工作”队列并且想要一次恢复/暂停所有队列（这通过恢复/更新它们的目标`funnelQ`队列来实现），这将很有用。
*   我可能会在任何时间点汇集我的工人队列，所以要知道它们是否被汇集，我`funnelQ`用“漏斗”这个词标记。
*   一路走来，我`dispatch_sync`想去`workerQ`，无论出于何种原因，但`dispatch_sync`要`funnelQ`避免将 dispatch_sync 发送到当前队列，所以我检查标签并采取相应措施。因为 get 沿着层次结构向上走，所以不会在 中找到该值，`workerQ`但会在`funnelQ`. 这是一种找出层次结构中是否有任何队列是我们存储值的队列的方法。因此，要防止 dispatch_sync 到当前队列。

如果您想知道读/写上下文数据的函数，有以下三个：

*   `dispatch_queue_set_specific`: 写入队列。
*   `dispatch_queue_get_specific`: 从队列中读取。
*   `dispatch_get_specific`：从当前队列中读取的便利功能。

键通过指针进行比较，并且从不取消引用。setter 中的最后一个参数是释放键的析构函数。

如果您想知道“将一个队列指向另一个队列”，那就是这个意思。例如，我可以将队列 A 指向主队列，它会导致队列 A 中的所有块都在主队列中运行（通常是为了 UI 更新而这样做）。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2012-06-12T14:02:19.520

我在[文档（最后一章）](http://developer.apple.com/library/ios/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW28)中找到了这个：

> 不要从在传递给函数调用的同一队列上执行的任务调用 dispatch_sync 函数。这样做会使队列死锁。如果您需要分派到当前队列，请使用 dispatch_async 函数异步执行此操作。

另外，我按照您提供的链接在**dispatch_sync**的描述中阅读了以下内容：

> 调用此函数并以当前队列为目标会导致死锁。

所以我认为这不是 GCD 的问题，我认为唯一明智的方法是您在发现问题后发明的方法。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-07-04T00:06:47.323

我知道你的困惑来自哪里：

> 作为一种优化，此函数在可能的情况下调用当前线程上的块。

小心，上面写着*current thread*。

**线程！=队列**

队列不拥有线程，并且线程未绑定到队列。有线程，有队列。每当一个队列想要运行一个块时，它都需要一个线程，但这并不总是同一个线程。它只需要它的任何线程（这可能每次都不同），当它完成运行块时（目前），同一个线程现在可以被不同的队列使用。

这句话讲的优化是关于线程的，不是关于队列的。例如，假设您有两个串行队列，`QueueA`现在`QueueB`您执行以下操作：

```
dispatch_async(QueueA, ^{
    someFunctionA(...);
    dispatch_sync(QueueB, ^{
        someFunctionB(...);
    });
}); 
```

当`QueueA`运行该块时，它将暂时拥有一个线程，任何线程。`someFunctionA(...)`将在该线程上执行。现在在进行同步调度时，`QueueA`不能做任何其他事情，它必须等待调度完成。`QueueB`另一方面，还需要一个线程来运行它的块并执行`someFunctionB(...)`。因此，要么`QueueA`暂时挂起其线程并`QueueB`使用其他线程来运行该块，要么`QueueA`将其线程移交给`QueueB`（毕竟在同步调度完成之前它无论如何都不需要它）并`QueueB`直接使用`QueueA`.

不用说最后一个选项要快得多，因为不需要线程切换。这就是**这**句话所说的优化。所以一个`dispatch_sync()`不同的队列可能并不总是导致线程切换（不同的队列，可能是同一个线程）。

但是`dispatch_sync()`仍然不能发生在同一个队列上（同一个线程，是的，同一个队列，不是）。这是因为一个队列会一个接一个地执行块，当它当前执行一个块时，它不会执行另一个块，直到当前执行完成。所以它在同一个队列上执行`BlockA`并`BlockA`执行 a `dispatch_sync()`of 。只要`BlockB`队列还在运行，它就不会运行，但在运行之前不会继续运行。看到问题了吗？这是一个经典的僵局。`BlockB``BlockA``BlockA``BlockB`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-09T02:08:40.847

文档明确指出，传递当前队列会导致死锁。

现在他们没有说他们为什么要这样设计东西（除了它实际上需要额外的代码才能使它工作），但我怀疑这样做的原因是因为在这种特殊情况下，块会“跳跃”队列，即在正常情况下，您的块最终会在队列中的所有其他块都运行后运行，但在这种情况下它会在之前运行。

当您尝试将 GCD 用作互斥机制时会出现此问题，这种特殊情况相当于使用递归互斥锁。我不想讨论是使用 GCD 还是使用传统的互斥 API（例如 pthreads 互斥锁）更好，甚至使用递归互斥锁是否是个好主意。我会让其他人对此进行争论，但肯定有这种需求，尤其是当它是您正在处理的主队列时。

就个人而言，我认为如果 dispatch_sync 支持这一点或者如果有另一个函数提供了替代行为，它会更有用。我会敦促其他有此想法的人向 Apple 提交错误报告（正如我所做的那样，ID：12668073）。

您可以编写自己的函数来做同样的事情，但这有点小技巧：

```
// Like dispatch_sync but works on current queue
static inline void dispatch_synchronized (dispatch_queue_t queue,
                                          dispatch_block_t block)
{
  dispatch_queue_set_specific (queue, queue, (void *)1, NULL);
  if (dispatch_get_specific (queue))
    block ();
  else
    dispatch_sync (queue, block);
} 
```

[注意 以前，我有一个使用 dispatch_get_current_queue() 的示例，但现在已弃用。]

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-11T19:59:43.503

两者都`dispatch_async`执行`dispatch_sync`将它们的操作推送到所需的队列中。该动作不会立即发生；它发生在队列运行循环的某些未来迭代中。`dispatch_async`和之间的区别在于`dispatch_sync`阻塞`dispatch_sync`当前队列直到动作完成。

想想当你在当前队列上异步执行某事时会发生什么。同样，它不会立即发生。它将它放在一个 FIFO 队列中，并且它必须等到运行循环的当前迭代完成之后（并且可能还等待队列中的其他操作，然后再执行此新操作）。

现在您可能会问，在对当前队列异步执行操作时，为什么不总是直接调用该函数，而不是等到未来某个时间。答案是两者之间有很大的不同。很多时候，你需要执行一个动作，但它需要在当前运行循环的迭代中由堆栈向上的函数执行任何副作用*之后执行；*或者您需要在运行循环中已经安排的一些动画操作等之后执行您的操作。这就是为什么很多时候您会看到代码`[obj performSelector:selector withObject:foo afterDelay:0]`（是的，它不同于`[obj performSelector:selector withObject:foo]`）。

正如我们之前所说，`dispatch_sync`与 相同`dispatch_async`，只是它会阻塞直到动作完成。所以很明显它为什么会死锁——至少在运行循环的当前迭代完成之后，该块才能执行；但我们正在等待它完成，然后再继续。

理论上，`dispatch_sync`当它是当前线程时，可以为 for 制定一个特殊情况，立即执行它。（对于 存在这种特殊情况`performSelector:onThread:withObject:waitUntilDone:`，当线程是当前线程并且`waitUntilDone:`为 YES 时，它会立即执行它。）但是，我猜 Apple 决定最好在这里保持一致的行为，而不管队列如何。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-12-04T06:22:38.900

从以下文档中找到。 [https://developer.apple.com/library/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/index.html#//apple_ref/c/func/dispatch_sync](https://developer.apple.com/library/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/index.html#//apple_ref/c/func/dispatch_sync)

与**dispatch_async**不同，“ **dispatch_sync** ”函数在块完成之前不会返回。调用此函数并以当前队列为目标会导致死锁。

与**dispatch_async**不同，目标队列不执行保留。因为对该函数的调用是同步的，所以它“**借用**”了调用者的引用。此外，不会对块执行**Block_copy 。**

作为一种优化，此函数在可能的情况下调用当前线程上的块。

# c# - C# 声明同一个表的多个实例

> ID：10984737
> 
> 赞同：3
> 
> 时间：2012-06-11T17:25:21.073
> 
> 标签：c#, asp.net

我有一个表格，需要 27 个单元格中的 27 个下拉菜单来接受用户输入。目前，我正在像这样声明所有 27 个：

```
DropDownList DropList1 = new DropDownList();
DropList1.ID = "TrendList1";
DropList1.AutoPostBack = true;
DropList1.SelectedIndexChanged += new EventHandler(this.Selection_Change);
DropList1.DataSource = CreateDataSource();
DropList1.DataTextField = "ColorTextField";
DropList1.DataValueField = "ColorValueField";
DropList1.DataBind();

DropDownList DropList2 = new DropDownList();
DropList2.ID = "TrendList2";
DropList2.AutoPostBack = true;
DropList2.SelectedIndexChanged += new EventHandler(this.Selection_Change);
DropList2.DataSource = CreateDataSource();
DropList2.DataTextField = "ColorTextField";
DropList2.DataValueField = "ColorValueField";
DropList2.DataBind();

etc... 
```

但是我知道必须有比我编写的蛮力代码更好的方法。不幸的是，我是网络编程的新手，我还没有找到更好的方法来做到这一点。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:32:04.847

```
var data = CreateDataSource();

for(x = 1; x < 28; x++)
{
    DropDownList dl = new DropDownList();
    dl.ID = "TrendList" + x.ToString();
    dl.AutoPostBack = true;
    dl.SelectedIndexChanged += new EventHandler(this.Selection_Change);
    dl.DataSource = data;
    dl.DataTextField = "ColorTextField";
    dl.DataValueField = "ColorValueField";
    dl.DataBind();
    // add it to the cell here too
} 
```

# sql - #光标拆分列#

> ID：10984739
> 
> 赞同：0
> 
> 时间：2012-06-11T17:25:30.247
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一张桌子

```
WS_ID WS_WEBPAGE_ID WS_SPONSORS_ID WS_STATUS WS_CREATEDTS
2 3 2 否 2012-06-07 15:32:00
3 3 3 否 2012-06-07 15:37:00
4 3 4 是 2012-06-07 15:41:00
5 1 1 是 2012-06-07 16:05:00
6 2 1 是 2012-06-07 16:05:00
7 2 4 是 2012-06-07 16:05:00
8 4 1 是 2012-06-07 16:05:00
9 1 3 是 2012-06-07 16:05:00
10 1 2 是 2012-06-07 16:05:00
11 1 4 是 2012-06-07 16:05:00
12 2 3 是 2012-06-07 16:05:00
13 2 3 是 2012-06-07 16:05:00
14 2 1 是 2012-06-07 16:05:00
24706 3 8,7,9,5,5 NULL NULL

```

我写了一个游标并将拆分函数调用到该游标中以拆分最后一条记录

```
Declare @splitc varchar(250)
Declare splitcursor cursor for
select ws_sponsors_id from dbo.TBL_WD_SPONSORS 
open splitcursor
fetch next from splitcursor into @splitc
while(@@FETCH_STATUS = 0)
begin
  print '@splitcursor'

--select * from dbo.Comma_Split(@ws_sponsors_id,',')
select dbo.Comma_Split(ws_sponsors_id,',') from dbo.TBL_WD_SPONSORS where ws_id = 24706

--select * from dbo.TBL_WD_SPONSORS where WS_SPONSORS_ID in(select * from dbo.Comma_Split(ws_sponsors_id,','))

    fetch next from splitcursor into @splitc
  end
  close splitcursor
  deallocate splitcursor 
```

我得到了错误

> 找不到列“dbo”或用户定义的函数或聚合“dbo.Comma_Split”，或者名称不明确。

```
WS_ID WS_WEBPAGE_ID WS_SPONSORS_ID WS_STATUS WS_CREATEDTS

 24706 3 8,7,9,5,5 NULL NULL

```

但我需要输出

```
WS_ID WS_WEBPAGE_ID WS_SPONSORS_ID WS_STATUS WS_CREATEDTS
24706 3 8 空 空
24707 3 7 空 空
24708 3 9 空 空
24709 3 5 空空
24710 3 5 空 空

```

如何获得输出

帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:44:58.843

为什么不重新设计您的表，以便您在 WS_SPONSORS_ID 列中只输入 1 个值，因此它是外键关系，那么您就不必执行此拆分功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T18:42:19.937

看起来您尝试使用的功能在您运行它的数据库上不存在。例如，试试这个，你会得到同样的错误：

```
SELECT dbo.This_Function_Most_Certainly_Doesnt_Exist('Unless you''re trying to break my example.') 
```

这将证明它是否存在，这样您就不必相信我的话。在您正在运行基于游标的查询的数据库上运行它：

```
SELECT * FROM INFORMATION_SCHEMA.ROUTINES R WHERE R.ROUTINE_NAME = 'Comma_Split' 
```

如果您没有返回任何行，那是因为该函数在那里不存在。要么你在错误的数据库上，错误的版本，你需要在它上面运行 CREATE FUNCTION，或者类似的东西。

编辑：顺便说一句，至于如何解决实际问题：不要使用游标。游标用作对数据结果集进行迭代的一种形式。在您的光标中，您正在选择单行的值：

```
select dbo.Comma_Split(ws_sponsors_id,',') from dbo.TBL_WD_SPONSORS where ws_id = 24706 
```

你拥有它的方式，你会在该行上调用该函数，为表上的每一行调用一次。这是拆分函数的一个很好的例子：http: [//praveenbattula.blogspot.com/2010/06/best-split-udf-function-with-delimeter.html](http://praveenbattula.blogspot.com/2010/06/best-split-udf-function-with-delimeter.html)

使用它你只需要写：

```
SELECT dbo.fnStringSplitter(ws_sponsors_id, ',') FROM dbo.TBL_WT_SPONSORS WHERE ws_id = 24706 
```

# python - 循环显示除周末以外的日期

> ID：10984741
> 
> 赞同：11
> 
> 时间：2012-06-11T17:25:39.083
> 
> 标签：python, datetime, loops

所以我有一个脚本，其中包含不同函数的日期参数，我希望它循环`01-01-2012`到`06-09-2012`不包括周末。我试图找出一种可以使用时间增量的方法，因为我的脚本输出的文件带有文件名中使用的日期，例如：

```
items = (functions.getItems(item,date)
    print items
    test = sum(abs(l[-1]) for l in items)
    total = open('total' +str(datetime.today- datetime.timedelta(1)),'a') 
```

我希望 timedelta(1) 循环遍历每个日期，以便输出文件具有`total2012-01-01`第一天的格式并循环遍历直到它创建文件`total2012-06-09`。项目的日期参数的格式也为`MM-DD-YYYY`

我认为我可以这样做：

```
sd = 01-01-2012
ed = 06-09-2012
delta = datetime.timedelta(days=1)
diff = 0
while sd != ed
    # do functions 
    # (have output files (datetime.today - datetime.delta(diff))
    diff +=1
    sd+=delta 
```

所以本质上我只是想弄清楚如何让函数以不包括周末开始`01-01-2012`和结束。`06-10-2012`我无法弄清楚如何排除周末以及如何让它以正确的顺序循环

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-11T17:35:09.577

使用[`datetime.weekday()`](http://docs.python.org/library/datetime.html#datetime.date.weekday)方法。它返回与工作日相关的零到六之间的值。周六值为 5，周日值为 6；因此，如果您在这些值出现时跳过操作，您将跳过周末：

```
start = datetime(2012, 1, 1)
end = datetime(2012, 10, 6)
delta = timedelta(days=1)
d = start
diff = 0
weekend = set([5, 6])
while d <= end:
    if d.weekday() not in weekend:
        diff += 1
    d += delta 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-08-13T06:13:52.837

`freq = 'B'`使用for有更简单的方法来做到这一点 `business day frequency`。

```
import pandas as pd
dt = pd.date_range(start=datetime.date.today(), periods=10, freq='B')
dt 
```

这给了你：

```
DatetimeIndex(['2018-08-13', '2018-08-14', '2018-08-15', '2018-08-16',
               '2018-08-17', '2018-08-20', '2018-08-21', '2018-08-22',
               '2018-08-23', '2018-08-24'],
              dtype='datetime64[ns]', freq='B') 
```

您还可以通过以下方式检查日期名称：

```
dt.weekday_name

Index(['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Monday',
       'Tuesday', 'Wednesday', 'Thursday', 'Friday'],
      dtype='object') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-28T01:40:18.443

@brandizzi 的答案在语法上更具美感，但作为替代方案，您可以使用以下内容

```
start = datetime(2012, 1, 1)
end = datetime(2012, 10, 6)
delta = timedelta(days=1)
d = start
diff = 0
SATURDAY = 5
while d <= end:
    if d.weekday() < SATURDAY:
        diff += 1
        d += delta 
```

# jquery - 如何更改活动手风琴段的背景颜色？

> ID：10984745
> 
> 赞同：1
> 
> 时间：2012-06-11T17:25:43.153
> 
> 标签：jquery, colors, background, accordion

**如何更改活动手风琴段的背景颜色？**

我使用以下代码创建了一个手风琴：

```
$(document).ready(function(){
$(".toggle-content").hide();
$(".toggle-title").click(function(){
$(this).next(".toggle-content").slideToggle("normal");
});
}); 
```

这很好用 -**但是我希望我的切换标题的背景颜色在它处于活动状态时改变。**

这是我目前使用的 HTML：

```
 <div class="toggle-box">
      <div class="toggle-title">Toggle 1</div>
      <div class="toggle-content">
        <p>Ut orci lorem, malesuada sed rhoncus quis, dignissim eget erat. Sed accumsan lorem sed libero posuere vitae blandit mi varius. Vestibulum eu dui leo, eget molestie quam. Integer non velit arcu, non tempor nulla.</p>
      </div>
      <div class="toggle-title">Toggle 2</div>
      <div class="toggle-content">
        <p>Ut orci lorem, malesuada sed rhoncus quis, dignissim eget erat. Sed accumsan lorem sed libero posuere vitae blandit mi varius. Vestibulum eu dui leo, eget molestie quam. Integer non velit arcu, non tempor nulla.</p>
      </div>
      <div class="toggle-title">Toggle 3</div>
      <div class="toggle-content">
        <p>Ut orci lorem, malesuada sed rhoncus quis, dignissim eget erat. Sed accumsan lorem sed libero posuere vitae blandit mi varius. Vestibulum eu dui leo, eget molestie quam. Integer non velit arcu, non tempor nulla.</p>
      </div>
    </div> 
```

这是我的 CSS：

```
.toggle-box {
    margin-top: 20px;
}

.toggle-box p {
    margin: 0;
    padding: 0;
}

.toggle-title {
    width: 100%;
    margin-bottom: 10px;
    padding: 10px;
    background: #BBC4D5;
    border: 1px solid #45536C;
    cursor: pointer;
    -moz-border-radius: 6px;
    -webkit-border-radius: 6px;
    border-radius: 6px;
}

.toggle-title:hover,
.toggle-title:active {
    background: #000;
}

.toggle-title a {
    color: #111;
}

.toggle-content {
    padding-bottom: 10px;
} 
```

非常欢迎帮助！

提前致谢，

简

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:32:57.850

为类 ui-accordion-content-active 添加 CSS 样式

请参阅[此处的主题部分](http://docs.jquery.com/UI/Accordion)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:37:57.247

尝试如下，

**CSS：**

```
.toggle-title:hover,
.toggle-title:active,
.active { /* Added .active rule */
    background: #000;
    color: white;
} 
```

**JS：**

```
$(document).ready(function() {
    $(".toggle-content").hide();
    $(".toggle-title").click(function() {
        $(this).next(".toggle-content").slideToggle("normal");
        $(this).toggleClass('active'); //toggle class active
    });
}); 
```

**演示：http:** [//jsfiddle.net/skram/mZhTY/](http://jsfiddle.net/skram/mZhTY/)

# autohotkey - Autohotkey 热字串插入结果两次

> ID：10984747
> 
> 赞同：1
> 
> 时间：2012-06-11T17:25:49.060
> 
> 标签：autohotkey

我有一个插入日期戳的热字符串，如下所示。它工作正常，除了当我输入“ds”然后是触发器（例如空格或制表符）时，它实际上并不包含空格或制表符，然后当我输入另一个时，我会得到另一个副本在原始部分上退格的日期戳。

所以，我输入“ds”，然后输入一次空格，得到：2012-06-11。我输入“ds”，然后空格两次，得到 2012-06-2012-06-11。

帮助？

谢谢。

```
::ds:: ;DateShort
    FormatTime, CurrentDate,, yyyy-MM-dd
    SendInput %CurrentDate%
return 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T19:05:58.510

Knelby，这不是剧本！您的脚本在我的机器上运行良好，并且在输入 ds{space}{space} 后不提供两个日期，但正如预期的那样，它只打印日期和一个空格。我对此进行了测试：Win7*64 Home Premium，在记事本中输出美式键盘布局和荷兰语键盘设置。

只是为了好玩，你可以试试这个：

```
:*:ds/:: ;DateShort 
```

这使得 / 结束字符，只是为了查看脚本如何在您的系统上响应。

# javascript - JavaScript 中的 parseDecimal？

> ID：10984748
> 
> 赞同：3
> 
> 时间：2012-06-11T17:25:49.280
> 
> 标签：javascript, math, floating-point, floating-point-precision

我正在进行一些 JS 计算。由于浮点运算通常使用数字的近似值而不是精确值，因此如果将这些浮点数四舍五入到固定精度，您通常会得到细微的差异。当你处理美元时，人们不喜欢这些细微的差别。

这个jsfiddle概述了我的问题：http: [//jsfiddle.net/rGP8Q/](http://jsfiddle.net/rGP8Q/)。

有谁知道我如何在不引入来自浮点近似的这些舍入误差的情况下进行数学运算（乘法和加法）？

**编辑**

我发现另一个帖子提出了同样的问题，并确认 JS 没有内置的十进制数据类型：[如何处理 JavaScript 中的浮点数精度？](https://stackoverflow.com/questions/1458633/elegant-workaround-for-javascript-floating-point-number-problem).

你可以看看你的JS终端是否

```
626.175.toFixed(2) == 626.17
626.185.toFixed(2) == 626.18
626.195.toFixed(2) == 626.20 
```

这是不一致的。我们需要一个真正的十进制数据类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:28:44.153

是的。始终，始终以最小面额的单位进行交易，最后仅除以 100，仅用于显示目的。

# python - python替换二维numpy数组中的值

> ID：10984750
> 
> 赞同：2
> 
> 时间：2012-06-11T17:26:13.100
> 
> 标签：python, multidimensional-array, max

我想用 -1 替换 2d numpy 数组的每一列的最大值：

```
b = numpy.array([[1,2,3,4],[5,6,7,8], [9,10,11,12]])
#get the max value of each column
maxposcol = b.argmax(axis = 0)
maxvalcol = b.max(axis = 0)
#replace max values with -1 
for i in numpy.arange(b.shape[1]):
    b[maxposcol[i]][i] = -1 
```

有没有其他方法可以替换 maxposcol[i] 给出的位置的最大值？

如果我想找到矩阵每一列的 n 个最大值，你会建议我做什么？使用排序？迭代地重复搜索最大值并在每一步替换它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:47:30.623

你可以这样做：

```
>>> a=np.argmax(b, axis=0)
>>> b[a] = -1
>>> b
array([[ 1,  2,  3,  4],
       [ 5,  6,  7,  8],
       [-1, -1, -1, -1]]) 
```

# javascript - Google maps api v3 地理编码多个地址

> ID：10984751
> 
> 赞同：0
> 
> 时间：2012-06-11T17:26:13.427
> 
> 标签：javascript, google-maps, google-maps-api-3

我正在制作一个小型应用程序，我猜它需要在一个页面加载中对比谷歌限制更多的地址进行地理编码。是否可以`geocoder.geocode( { 'address': addreses[address][1]}, placeOnMap);`使用多个地址发送？因为响应应该给出多个。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T06:37:09.530

JS 地理编码器服务适用于您无法知道页面何时加载的地址（例如，用户提供的数据）。如果您事先知道地址，您应该使用网络服务**并存储坐标**，这样您就不必一遍又一遍地重新地理编码相同的数据。否则会浪费 Google 的资源和用户的时间（因为页面将等待地理编码器完成其工作，而不是让所有数据随页面代码一起提供）。

[这个问题](https://stackoverflow.com/q/10062624/1204258)和我的回答也有关系。您可以使用该解决方案对多个地址进行地理编码并获取它们的坐标，以便存储它们以备将来使用。

请注意，Google 服务条款仅允许您存储他们的数据以在 Google 地图上使用。

# .net - 将字符串参数发布到 WCF 服务会导致反序列化错误

> ID：10984752
> 
> 赞同：2
> 
> 时间：2012-06-11T17:26:15.663
> 
> 标签：.net, json, wcf, rest

我正在尝试将 json 字符串发布到 .net wcf 服务。

这是操作的定义：

```
[WebInvoke(Method = "POST", UriTemplate = "test/")]
[OperationContract]
[Description("Test")]
void Test(string input); 
```

我使用提琴手发送我的测试。这是提琴手信息：

```
POST http://localhost/test.svc/test/ HTTP/1.1
Content-Type: application/json
Host: localhost
Content-Length: 4

test 
```

我总是收到这个 http 400 错误：

**反序列化 System.String 类型的对象时出错。令牌“真”是预期的，但发现是“测试”。**

我究竟做错了什么？我敢肯定这可能是很明显的事情，但我从今天早上就开始了......

问题已被分解为最简单的表达方式。在现实世界中，我们想要发布一个实际上是 JSON 的字符串。但是我们不希望 .net 处理反序列化，我们希望自己在服务中自己完成。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-11T19:25:08.180

请求内容

```
test 
```

不是有效的 JSON。您需要在引号内发送字符串：

```
POST http://localhost/test.svc/test/ HTTP/1.1
Content-Type: application/json
Host: localhost
Content-Length: 6

"test" 
```

# objective-c - 试图理解核心数据关系或处理重复

> ID：10984756
> 
> 赞同：1
> 
> 时间：2012-06-11T17:26:43.433
> 
> 标签：objective-c, core-data, entity-relationship, one-to-many, one-to-one

我正在尝试验证我是否了解核心数据关系和/或可能如何处理重复项。

在下面的示例中，我的实体帐户与实体交易日期存在一对多关系。我在想很多人，因为一个帐户下会有多个日期。

我感到困惑的是，我只想有一个特定的日期......意思是，只有一个日期，没有重复。然后，意图是使实体交易日期与实体事件具有一对多关系。因此帐户 XYZ 将具有 06/11/2012 的交易日期和实体事件的多个条目。然后帐户 XYZ 将具有 06/12/2012 的交易日期和实体事件的多个条目。

Account 和 Trans Date 之间的关系真的是一对多还是一对一？如果是一对多...如何处理重复项？如何在实体 Trans Date 中只保留一个日期？如果我的代码通过条目添加到事件和交易日期中，是否在那里进行了一些处理？如何？

我猜账户到交易日期应该是一对一……但现在真的不确定。

```
/-----------------------\          /----------------------\       /------------------\
| Account               |          | Transaction Date     |       |   Event          |
|-----------------------|          |----------------------|       |------------------|
| name                  |          | addDate              |       |  amount          |
| balance               |          |                      |       |                  |
|-----------------------|          |----------------------|       |------------------|
| heldByAcct            | <-\      |                      |       |                  | 
|                       |     \->> | inAcct               |       |                  |
|                       |          | heldByEvent          |<-\    |                  |
\-----------------------/          \----------------------/   \->>| inTrans          |
                                                                  \------------------/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T21:58:17.327

我不确定我是否理解您要达到的目标，但我会尽力给您一些建议。

*第一的*

如果一个`Account`可以只有一个`Transaction Date`，我认为你应该设置一个一对一的关系。通过这种方式，您可以确定一个人`Account`有一个`Transaction Date`，反之亦然。在后面，Core Data 会设置你的数据库，这样你的`Account`表就会有一个对应`Transaction Date`对象 ID 的字段。

*第二*

如果您正在设置结帐机制并且`Account`可以进行多笔交易（例如，每天只有一笔），您需要设置一对多的关系。如果您需要每天检查单笔交易，则需要手动执行检查。`Transaction Date`使用特定日期的谓词设置请求，`Account`并查看计数是否大于一。如果没有，请添加`Transaction Date`.

```
NSInteger count = [fetchRequest countForFetchRequest:&error]; // query against `Transaction Date`
if(count >= 1) // not allowed
else // allowed 
```

通常当我需要检查重复项时，我使用 guid 作为实体的属性（例如 guid 类型`NSString`）。所以，在你的`Transaction Date`你可以使用这样的机制。然后您可以使用如下谓词设置获取请求：

```
[NSPredicate predicateWithFormat:@"guid == %@ AND inAcct == %@", @"12345", [self currentAccount]]; 
```

每次插入新的 guid 时`Transaction Date`，您都可以根据日期（没有时间）和特定的`Account`（使用您自己的协议来执行此操作）生成一个新的 guid。

考虑一下，您还可以保存并检查没有时间部分的日期（[category-on-nsdate](http://iphonedevelopment.blogspot.it/2009/07/category-on-nsdate.html)）。我认为它会起作用，但你需要尝试。通过这种方式，您可以简单地使用没有指导的谓词。例如：

```
[NSPredicate predicateWithFormat:@"addDate == %@ AND inAcct == %@", [self currentDate], [self currentAccount]]; 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T17:55:38.853

为了对事务寄存器进行建模，我建议将 addDate 设为 Event 的属性并完全删除 Transaction Date。

它显着简化了管理对象图所需的工作，并消除了对日期进行重复数据删除的需要。

如果您需要生成唯一日期列表，您可以使用 distinctUnionOfSets 即时执行此问题的答案： [CoreData get distinct values of Attribute](https://stackoverflow.com/questions/7000768/coredata-get-distinct-values-of-attribute)。

# java - Blackerry 中异步列表字段实现时出现 IllegalThreadState 异常

> ID：10984757
> 
> 赞同：0
> 
> 时间：2012-06-11T17:26:46.553
> 
> 标签：java, multithreading, blackberry, try-catch, threadpool

这个问题是我之前关于堆栈溢出[how-to-download-images-asynchronously-from-web-server 的](https://stackoverflow.com/questions/10912647/how-to-download-images-asynchronously-from-web-server)问题的延续。我正在努力在黑莓中制作异步列表。现在它对我来说工作正常。但它现在给了我另一个问题。

**到目前为止我做了什么**

1.  创建了一个从 XML 提要中获取价值的列表视图
2.  列表加载了默认缩略图
3.  Created `RunnableFactory`，将线程池大小限制为 5，然后将可运行对象添加到其中。可运行对象具有从服务器下载图像的能力。
4.  现在列表异步加载非常好。

**问题场景**

在加载列表屏幕时，它正在初始化`RunnableFactory`，然后开始下载和渲染列表中的图像。但是，假设我在列表中有 50 行。现在已经成功下载了 10 张图片，并且 RunnableFactory 仍在运行。此时按返回键，然后单击下一步。实际上，它应该出现在列表屏幕上，然后重新启动下载过程。但它抛出**IllegalThredState 异常**

**我对这个问题的假设**

由于所有线程都在运行，我可能不得不取消按下后退键的所有线程。如果这是问题，你能告诉我我该怎么做吗？由于我创建了多个线程，我怎么能设法停止所有线程然后导航回来？

这看起来像一个更复杂的系统。谁能帮助我了解还有什么可能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T08:12:32.427

当我在完成运行后第二次尝试启动线程时出现此异常。一旦启动，线程可能不会重新启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:31:38.470

如果您正在使用任何踏板，那么您将关闭，否则您可以在导航到返回时中断所有踏板。

# c# - Headers 和 GetResponseHeader 之间的 HttpWebResponse 区别

> ID：10984758
> 
> 赞同：0
> 
> 时间：2012-06-11T17:27:02.333
> 
> 标签：c#

当我有一个 HttpWebResponse 对象时，有两种方法可以访问响应标头：

```
string dateHeader = webResponse.Headers["Date"];
string dateHeader = webResponse.GetResponseHeader("Date"); 
```

它们都返回相同的值，那么为什么有两种获取头信息的方法呢？查看 .NET 源代码，如果在 HttpWebReponse 中找到两者的实现：

```
 // retreives response header object 
    /// <devdoc>
    ///    <para> 
    ///       Gets 
    ///       the headers associated with this response from the server.
    ///    </para> 
    /// </devdoc>
    public override WebHeaderCollection Headers {
        get {
            CheckDisposed(); 
            return m_HttpResponseHeaders;
        } 
    } 

    /// <devdoc>
    ///    <para> 
    ///       Gets a specified header value returned with the response.
    ///    </para> 
    /// </devdoc> 
    public string GetResponseHeader( string headerName ) {
        CheckDisposed(); 

        string headerValue = m_HttpResponseHeaders[headerName];

        return ( (headerValue==null) ? String.Empty : headerValue ); 
    } 
```

我唯一能看到的是，使用 Headers 属性，我可以枚举所有可用的标题。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T03:44:43.387

根据[MSDN library](http://msdn.microsoft.com/en-us/library/system.net.webresponse.headers.aspx)，该`Headers`属性是所有标题的 WebHeaderCollection。由于它是一个集合，因此对于访问多个标头的名称、值或两者都很有用。`Header[<name>]`它还可以通过在格式中指示名称来访问单个标头的值。

`GetResponseHeader()`另一方面，是一种仅返回单个值的值的方法。

总而言之，区别在于：

1.  属性与方法
2.  多个标题名称和/或值访问与单个标题值访问

# c# - 创建一个匿名类型的数组

> ID：10984762
> 
> 赞同：4
> 
> 时间：2012-06-11T17:27:15.930
> 
> 标签：c#, linq, anonymous-types

我正在尝试从数据库中获取程序中 Google 图表的数据。我想创建一个匿名类型（var）的数组，而不是一遍又一遍地重复我的代码：

```
 public JsonResult GetChartData(int sID, int regionID)
    {

            var testPathOne = from p in _rep.GetMetricsData().GetLHDb().page_loads                                 
                              where p.t_3id == sID && p.test_path_id == 1
                              select new { time = p.time, created_at = p.created_at };

            var testPathTwo = from p in _rep.GetMetricsData().GetLHDb().page_loads
                              where p.t_3id == sID && p.test_path_id == 2
                              select new { time = p.time, created_at = p.created_at };

            var tOne = testPathOne.ToArray();
            var tTwo = testPathTwo.ToArray();
            var name = new { test1 = tOne, test2 = tTwo };
            return Json(name);
        } 
```

我知道我将需要一个 for 循环，这样我就可以遍历所有测试路径 ID，而不是像这样对它们进行硬编码`p.test_path_id == 1`，但我的问题是如何使这部分动态化`var name = new { test1 = tOne, test2 = tTwo };`

**编辑：** 我很抱歉，我想做这样的事情：

```
name is an array

for loop:
    testPath = query
    name.Add(testPath) 
```

我希望这是有道理的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T18:00:38.770

在这种特殊情况下，最简单的解决方案是只为当前匿名的类命名。虽然您可以使用一些变通方法，但当您需要开始非常努力地使用匿名类型时，您可能不应该使用它。它可以使某些任务更快更容易；如果这没有发生，那么你可能会更好地参加真正的课程。

该解决方案看起来像这样：

```
//Please give me a real name
public class ClassToBeRenamed
{
    public DateTime Time { get; set; }
    public DateTime CreatedAt { get; set; }
}

List<ClassToBeRenamed[]> myList = new List<ClassToBeRenamed[]>();

for (int i = 0; i < 10; i++)
{
myList.Add((from p in _rep.GetMetricsData().GetLHDb().page_loads
            where p.t_3id == sID && p.test_path_id == i
            select new ClassToBeRenamed { Time = p.time, CreatedAt = p.created_at })
            .ToArray());
} 
```

说了这么多，还是可以的。

```
var myList = new[]{
                from p in _rep.GetMetricsData().GetLHDb().page_loads
                where p.t_3id == sID && p.test_path_id == 1
                select new { time = p.time, created_at = p.created_at }.ToArray()
}.ToList();

for (int i = 2; i < 10; i++)
{
    myList.Add(from p in _rep.GetMetricsData().GetLHDb().page_loads
                where p.t_3id == sID && p.test_path_id == i
                select new { time = p.time, created_at = p.created_at }.ToArray()
                );
}

var myArray = myList.ToArray(); 
```

如果你有一个数组而不是一个列表真的非常重要，那么你可以在最后调用`ToArray`myList 。从一个列表开始很重要，并且只在最后将其转换为一个数组，因为数组一旦创建就具有固定的大小。你可以改变它们的内容，但你不能让它们变大或变小。另一方面，List 旨在随着时间的推移改变其大小，因此它可以从 0 或 1 个项目开始，然后随着时间的推移添加项目，这在这个特定的上下文中对我们很重要。（实际上它经常很有用，这就是为什么`List`在数组上使用它经常有用的原因。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-17T14:01:25.873

而不是使用 LINQ 使用 foreach 循环。您对 LINQ 的限制更大。还要在开头定义您的 ArrayLists 并随时添加。

```
var test1 = new ArrayList();
var test2 = new ArrayList();
foreach(PageLoad p in _rep.GetMetricsData().GetLHDb().page_loads)
{
    if(p.t_3id == sID)
    {
        var tr = new { time = p.time, created_at = p.created_at };
        switch(p.test_path_id) 
        {
            case 1: test1.Add(tr); break;
            case 2: test2.Add(tr); break;
        }
    }
}
return Json(new { test1, test2, }); 
```

您不需要定义属性匿名类型的名称，因为它们默认为变量名称。

# wpf - WPF ValidationRules 禁用 PropertyChanged

> ID：10984763
> 
> 赞同：5
> 
> 时间：2012-06-11T17:27:16.477
> 
> 标签：wpf, validation, textbox, propertychanged

我有以下文本框，它们在视图模型中更改了属性。当我插入 Binding.ValidationRules 并插入一些错误的值时，它不会触发 propertychanged 事件，我不明白为什么。有什么帮助吗？

```
<TextBox Name="RiskCode" HorizontalAlignment="Left" Margin="101.923,8,0,81" TextWrapping="Wrap" Width="56.077" MaxLength="6" Validation.ErrorTemplate="{StaticResource validationTemplate}"
         Style="{StaticResource textBoxInError}">
    <TextBox.Text>
        <Binding Path="RiskCode" UpdateSourceTrigger="PropertyChanged">
            <Binding.ValidationRules>
                <vm:RiskCodeValidation/>
            </Binding.ValidationRules>
        </Binding>
    </TextBox.Text>
</TextBox> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-11T18:43:48.123

使用`ValidationStep`.

[http://msdn.microsoft.com/en-us/library/system.windows.controls.validationrule.validationstep.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.validationrule.validationstep.aspx)

*   `RawProposedValue`- 在发生任何转换之前运行 ValidationRule。
*   `ConvertedProposedValue`- 在值转换后运行 ValidationRule。
*   `UpdatedValue`- 在源更新后运行 ValidationRule。
*   `CommittedValue`- 在将值提交到源后运行 ValidationRule。

默认情况下，它是`RawProposedValue`，它可以防止与源的绑定发生 - 因此您会感到困惑。请改用其他选项：

```
 <Binding.ValidationRules>
   <vm:RiskCodeValidation ValidationStep="UpdatedValue" />
 </Binding.ValidationRules> 
```

# c# - 如何在后面的代码中访问 DetailsView 的 ItemTemplate 的 TextBox？ASP.Net C#

> ID：10984766
> 
> 赞同：1
> 
> 时间：2012-06-11T17:27:50.173
> 
> 标签：c#, asp.net, page-lifecycle, servercontrols

我有一个 DetailsView，其中 1 个字段转换为 TemplateField，以便能够操作包含 TextBox 的 InsertItemTemplate（参见：下面的代码）。问题是我无法在后面的代码中访问该 TextBox 属性......而且我真的不明白:(这是我的 aspx 代码（它的一部分）：

```
<asp:DetailsView ID="_DetailsView" ClientIDMode="Static" runat="server" Height="50px"
        Width="125px" AllowPaging="True" AutoGenerateRows="False" DataKeyNames="IDUniv"
        DataSourceID="EntityDS" OnModeChanging="_OnModeChanging">
        <Fields>
            <asp:TemplateField HeaderText="DateUpdateUniv" SortExpression="DateUpdateUniv" ConvertEmptyStringToNull="False">
                <InsertItemTemplate>
                    <asp:TextBox ID="TextBoxInsertItem" runat="server" Text='<%# Bind("DateUpdateUniv") %>'></asp:TextBox>
                </InsertItemTemplate>
                <ItemTemplate>
            </asp:TemplateField>
            <asp:CommandField ShowDeleteButton="True" ShowEditButton="True" ShowInsertButton="True" />
        </Fields>
    </asp:DetailsView>
    <asp:EntityDataSource ID="EntityDS"> 
```

在 Page_LoadComplete 事件处理程序中，我有这样的事情：

```
private void Page_LoadComplete(object sender, EventArgs e)
    {
        if (_DetailsView.HasControls())
        {
            Control _InsertDate = _DetailsView.FindControl("TextBoxInsertItem") as TextBox;
            if (_InsertDate != null)
            {
                _InsertDate.Text  = "something";
            }
        }
    } 
```

但以下代码是错误的：_DetailsView.FindControl("TextBoxInsertItem") 而且这也不起作用：_InsertDate.Text = "something";

我发现了一篇有趣的文章，但仍然......： http: [//www.devproconnections.com/article/aspnet2/getting-under-the-detailsview-control](http://www.devproconnections.com/article/aspnet2/getting-under-the-detailsview-control)

有人可以帮我找到我的路吗？如何找到这个 TextBoxInsertItem 控件并与之交互？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T19:19:38.320

```
 TextBox txtB = _DetailsView.FindControl("TextBoxInsertItem") as TextBox;
 string text = txtB.Text; 
```

试试这样？除了声明一个文本框而不是一个控件之外，我看不出有任何区别..我已经使用了这种从子控件获取数据的特殊方式，而且它总是对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T05:27:48.513

我终于找到了解决方案:)并且有很多问题：

1.我的代码没有放在正确的Page_event中，我认为DetailsView必须在尝试“FindControl它们”之前正确呈现控件，所以我将它放在**Page_LoadComplete中，但它是错误**的。
DetailsView 带有一些事件，我们感兴趣的是**OnItemCreated**（在 System.Web.UI.WebControls.DetailsView 控件中创建记录时发生）。

2.我的测试不相关，正确的测试检查简单：

```
if (_DetailsView.FindControl("TextBoxInsertItem") != null) 
```

3.我的Visual Sudio（不是SP1）充满了错误（当我运行相同的代码时，有时会抛出错误，有时不会，直到我关闭VS2010并重新打开它......

4.我必须初始化一个“文本框”而不是像简所说的“控件”

我希望这几行会有所帮助:) 并且正如 MSDN 中所说：您不应该创建依赖于按特定顺序引发的更改事件的应用程序逻辑，除非您对页面事件处理有详细的了解

# c# - 用于 asp.net 网格分页的 SQL 查询

> ID：10984768
> 
> 赞同：6
> 
> 时间：2012-06-11T17:28:09.980
> 
> 标签：c#, asp.net, sql-server, ibatis

我正在使用`iBatis`和`SQLServer`，

使用偏移量和限制进行分页查询的最佳方法是什么？

也许我添加了 column `ROW_NUMBER() OVER (ORDER BY Id) AS RowNum`，但这只会阻止简单查询的数据访问。在某些情况下，我使用选择联合。如何优化这些查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T08:54:39.113

我对ibatis一无所知，但我想你可以在SQL中做到这一点。

如果我对您的理解正确，您希望对 select 语句或几个 select 语句的联合结果进行分页。

我会按照以下方式进行。例如，这可能是一个存储过程，并且可能应该在那里进行一些健全性检查，检查 offset 和 limit 的值是否大于 0。如果你最终做了这样的事情，请确保`*`用你的列名替换也！

下面是一个联合的例子：

```
DECLARE @offset INT;
DECLARE @limit INT;

WITH cte
     AS (SELECT t.*,
                Row_number() OVER (ORDER BY Id) AS RowNum
         FROM   (SELECT *
                 FROM   Table1
                 UNION
                 SELECT *
                 FROM   Table2) t)
SELECT *
FROM   cte
WHERE  RowNum BETWEEN @offset AND @offset + @limit 
```

本质上，我所做的是从两个查询的联合中派生一个新表，正如您所说的那样，您的情况可能会发生。然后，我将带有行号的列添加到[CTE](http://msdn.microsoft.com/en-us/library/ms190766%28v=sql.105%29.aspx)中的结果中，然后仅选择中指定的行`@Offset`并`@limit + @offset`仅取回您要求的行。

例如设置`@offset = 50`and ，你会得到 50-100 的结果（按照over 子句`@limit = 50`中指定的标准排序。`Row_number`

（我希望这是您正在寻找的那种东西！）

**编辑：**这仅适用于 SQL Server 2005 及以后的版本 - 您没有提到您使用的是哪个版本！

# python - argparse - 带有列表/元组的可选参数

> ID：10984769
> 
> 赞同：2
> 
> 时间：2012-06-11T17:28:12.460
> 
> 标签：python, argparse

我有几个可选参数，其中一个需要存储多个值——即它的类型既不是字符串也不是整数。argparse 是否支持其他类型的可选参数？

例如，我想要这个命令：

```
>>> python example1 test_project --name try1 3 
```

相当于这样的代码：

```
args.name = {'try1', '3'} 
```

这可能吗？或者如果他选择此选项，我是否会被迫使用`action='store_true'`然后提示用户提供更多信息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T17:47:32.693

我真的很难听懂你的问题。这是你想要的吗？

```
import argparse

parser=argparse.ArgumentParser()
parser.add_argument('--name',nargs='*',action='store')

print(parser.parse_args('--name try1 3'.split())) #Namespace(name=['try1', '3']) 
```

如果不是，也许您可​​以尝试更清楚地了解您想让 argparse 做什么，以及您已经能够用它做什么。

# jquery - 什么更快？CSS3 过渡还是 jQuery 动画？

> ID：10984771
> 
> 赞同：46
> 
> 时间：2012-06-11T17:28:33.420
> 
> 标签：jquery, ipad, css, css-transitions

我正在开发一个 iPad HTML5 应用程序，并且我已经实现了 ontouch 支持以更快地触发事件，并且我正在使用 jQuery 来更轻松地定位元素，但是对于动画我使用的是 CSS3 过渡

你觉得哪个更快？使用 jQuery 动画，因为我已经导入了库，或者在使用 jQuery 定位元素时使用 CSS3 过渡？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-06-11T17:35:37.613

根据[**这个链接**](http://css3.bradshawenterprises.com/blog/jquery-vs-css3-transitions/)，jQuery 动画比 css 动画慢得多。

**原因**可能是因为 jquery 必须使用计时器和循环来修改 DOM 元素的 props。CSS 是浏览器引擎的一部分。这在很大程度上取决于系统的硬件。您还可以在 Chrome 或 Firefox 的分析中检查这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-11T17:32:05.303

CSS 动画几乎总是更快。

> CSS 过渡和 jQuery 动画的头对头比较。转换不是设置一个重复运行的计时器，而是由浏览器本地处理。在我相当不科学的测试中，过渡总是更快，以更高的帧速率运行，尤其是在大量元素的情况下。它们还具有可以轻松动画颜色的优点，而不必依赖插件。

[http://css.dzone.com/articles/css3-transitions-vs-jquery](http://css.dzone.com/articles/css3-transitions-vs-jquery)

相关问题： [CSS 过渡与 JS 动画包的性能](https://stackoverflow.com/questions/2999749/performance-of-css-transitions-vs-js-animation-packages)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-11T17:32:14.480

CSS3 过渡*应该*更快，因为它们是浏览器原生的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-03-10T17:27:21.463

[这篇文章 (http://css-tricks.com/myth-busting-css-animations-vs-javascript/)](http://css-tricks.com/myth-busting-css-animations-vs-javascript/)对 CSS 转换、jQuery 动画和 GSAP（另一个 JavaScript 库）进行了很好的比较。

> CSS 动画比 jQuery 快得多。然而，在我测试过的大多数设备和浏览器上，基于 JavaScript 的 GSAP 的表现甚至比 CSS 动画还要好

所以**CSS 转换比 jQuery 动画快**，但是不要让这让你认为 CSS 转换比*JavaScript*快。GSAP 表明**JavaScript 可以胜过 CSS**。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-17T09:57:29.803

它的 css3 更快，消耗更少的内存并且更流畅。CSS 处理器是用 C++ 编写的，本机代码执行速度非常快，而 jQuery (JavaScript) 是一种解释性语言，浏览器无法及时预测 JavaScript。 [http://dev.opera.com/articles/view/css3-vs-jquery-animations/](http://dev.opera.com/articles/view/css3-vs-jquery-animations/)

查看上面的链接了解关于 CSS3 与 jQuery 的实验

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-12T00:19:28.847

CSS3 会更快，因为它是浏览器的标准配置，因为 JQuery 是另一个必须加载的文件，但是我发现根据动画，JQuery 可以运行得更流畅。有时，一次又一次地尝试纯 Javascript 也很好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-11T17:35:23.477

[Mozilla 开发者文档提出了一些关于 CSS3 动画的有趣](https://developer.mozilla.org/en/CSS/CSS_animations)观点：

> 让浏览器控制动画序列可以让浏览器优化性能和效率，例如，降低在当前不可见的选项卡中运行的动画的更新频率。

[WebKit（支持 Safari）也利用了硬件加速合成](http://trac.webkit.org/wiki/QtWebKitGraphics#Acceleratedcompositing)，这对性能的影响比 Javascript 目前所能做的任何事情都要大得多。（我认为这将很快改变，尽管随着更多功能被添加来管理计算）这是因为它会利用专用硬件来执行计算，而不是通过像 Javascript 这样的翻译语言来实现。

我不能 100% 确定*iPad 上的*WebKit 是否是硬件加速的；然而，有理由认为，因为它是标准化的并且越来越受欢迎，这只会随着时间的推移而改善。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-11T17:39:48.400

从[这里](http://css.dzone.com/articles/css3-transitions-vs-jquery/)

> CSS 过渡和 jQuery 动画的头对头比较。转换不是设置一个重复运行的计时器，而是由浏览器本地处理。在我相当不科学的测试中，过渡总是更快，以更高的帧速率运行，尤其是在大量元素的情况下。它们还具有可以轻松动画颜色的优点，而不必依赖插件。

[这里](http://css3.bradshawenterprises.com/demos/speed.php/)有一个测试和这个结论。

> 基于计时器的 Javascript 动画永远不会像原生动画那样快，因为它们无法访问足够多的浏览器来进行相同的优化。这些动画应该仅在旧版浏览器中用作后备。

还要注意[这一点](http://www.richardet-design.com/wp/design/webdesign/css3-animation-vs-jquery-animation/)，

> CSS3 动画非常棒，但确实会消耗大量处理器的能力。无法像使用 jQuery 之类的框架一样使用 CSS3 微调动画。所以，只要 CSS3 动画对 CPU 不友好，你最好坚持使用 jQuery。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-06T19:48:22.733

Native 应该更快，但如果浏览器开发人员马虎（或懒惰），他们会编写糟糕的代码，这会导致 CSS 动画（或过渡）效果不佳。

如今，jQuery 有一个插件，它用“改进”的插件覆盖了“动画”功能。见[速度](http://css-tricks.com/improving-ui-animation-workflow-velocity-js/)。我没有涉及使用 javascript 为 DOM 设置动画的其他方式，因为它超出了这个问题的范围。

所以，按原样，jQuery 比 CSS 慢。此外，CSS 更容易编写，因为您可能已经有了元素样式，因此添加一些规则很容易，与您需要在某个地方开始编写 JS 并管理它的情况相比。但是对于复杂、繁重的东西，JS 是更快，可悲的是。

关于这个确切问题的一篇非常好的文章 - [http://davidwalsh.name/css-js-animation](http://davidwalsh.name/css-js-animation)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-22T19:55:55.953

如果您正在使用带有 canvas 标签的 jQuery/javascript 动画（如果我没记错的话，它仍然依赖于计时器......不过是新手），那么它为您提供了使用 javascript 进行硬件加速的优势。如果您只是想在悬停时移动某些东西，那么过渡效果很好。CSS 过渡可能会运行得更流畅一些，但这是一种折衷，您通过使用过渡放弃了对动画的大量 javascript 控制。我喜欢保持 CSS 中的样式和 JS 中的行为——这不就是它应该如何工作的吗？CSS 转换有点打破了这种逻辑......

# php - PHP 文件：文件夹和子文件夹中最近的 11 个文件

> ID：10984775
> 
> 赞同：0
> 
> 时间：2012-06-11T17:28:52.500
> 
> 标签：php, file, directory

我有一个包含大约 100 个子目录的目录（嵌套，大约 3-4 深）。我需要一个小的 PHP 脚本，它将简单地输出 11 个最近添加（或修改，因为它们都是 pdf 文件）文件的列表，每个文件`<br />`之间都有一个简单的文件，每个文件都链接到它们的 URL。

我发现了一些可以执行 1 或全部的脚本，但不知道如何开始专门限制为 11，或者如何应用确切的 href。

我的另一个担忧是该脚本的服务器使用情况，因为它将被放置在一个使用率较低的登录页面上，但是每个用户都会看到它。

任何关于资源的想法或开始的地方，将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:38:35.690

未经测试，但它应该可以工作：

```
<?php

function getFiles($dir)
{
    $arr=scandir($dir);
    $res=array();
    foreach ($arr as $item)
    {
        if ($item=='..' || $item=='.'){continue;}
        $path=$dir.'/'.$item;
        if (is_dir($path))
        {
            $res=array_merge($res,getFiles($path));
        }
        else
        {
            $res[$path]=filemtime($path);
        }
    }
    return $res;
}

$files=getFiles('directory');
arsort($files);
$files=array_slice(array_keys($files),0,11);
foreach ($files as $file)
{
    echo '<a href="'.$file.'">'.$file.'</a><br />';
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T18:05:10.047

提供一个基于网络的上传界面会更有意义。这样您就可以跟踪每个新的上传。

*   用户选择类别（每个类别/子类别映射到一个文件夹）
*   上传文件到服务器
*   脚本转储表格行中的每个文件名、位置和日期

完毕。要获取最新的 11 个文件（在整个系统或特定类别/文件夹中），您只需要查询数据库。

如果您的用户也需要删除文件的能力，只需为该功能添加 Web 界面即可。而不是删除文件，只需在表中将它们标记为“隐藏”即可。

除了解决眼前的问题外，它还将为审核、所有权归属和搜索提供额外的可能性......等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T18:13:54.553

使用递归迭代器。这就是它的设计目的。我添加了一个名为 sortedIterator 的额外迭代器，它扩展了 SPLHeap，以按 getMTim​​e() 排序，这是 dir 的修改时间。

将 $path 更改为目录的完整路径。

```
$path = '.';

class sortedIterator extends SplHeap
{
    public function __construct(Iterator $iterator)
    {
        foreach ($iterator as $item) {
            $this->insert($item);
        }
    }
    public function compare($b,$a)
    {
        return strcmp($a->getMTime(), $b->getMTime());
    }
}

    $recursive = new RecursiveDirectoryIterator($path);
$sortByTime = new sortedIterator($recursive);
$i = 0;
foreach ($sortByTime as $file) {
        if($file->isDir()){
                $dirs[] = $file->getFilename();

                if($i++ == 9){
                        break;
                }
        }
}

print_r(implode("<br />", $dirs)); 
```

编辑，如果您想要创建时间，请将 getMTim​​e 更改为 getCTime。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-11T17:32:04.790

使用列出所有这些的代码，但在输出之前使用[`usort`](http://php.net/usort)调用通过减少修改时间对文件进行排序。然后，你的循环应该从这个开始：

```
$l = count($fileArray);
for( $i=0; $i<11 && $i<$l; $i++) {
    // output file entry
} 
```

# c++ - 使用带有 ATL_BASE64_FLAG_NOPAD 标志的 ATL Base64Encode 解码 base 64 编码字符串

> ID：10984777
> 
> 赞同：0
> 
> 时间：2012-06-11T17:29:00.423
> 
> 标签：c++, base64, atl

如何解码使用带有 ATL_BASE64_FLAG_NOPAD 标志的 Base64Encode 编码的 base 64 编码字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:31:33.840

假设这只是意味着“不要放在`=`最后”，您可以直接添加填充：

```
public static string Base64PadEnd(string unpadded)
{
    switch(unpadded.Length % 4)
    {
        case 0: return unpadded;
        case 2: return unpadded + "==";
        case 3: return unpadded + "=";
        default: throw new ArgumentException("Invalid unpadded base64");
    }
} 
```

（base64 的工作方式，你永远不应该得到一个最终块为 1 个字符的未填充值。）

添加填充后，`Convert.FromBase64String`照常使用。

编辑：如评论中所述，如果您的 base64 字符串包含空格，则应在添加填充*之前先将其删除。*一个简单`text = Regex.Replace(text, @"\s", "")`的应该做的伎俩。

# javascript - AJAX 初始化中的三元运算符未正确设置

> ID：10984779
> 
> 赞同：0
> 
> 时间：2012-06-11T17:29:24.160
> 
> 标签：javascript, jquery, ajax, firefox, ternary

我正在处理一些正确连接的 AJAX 调用，但是如果我尝试在调用初始化中使用三元运算符，则运算符设置不正确。具体来说，我正在尝试动态设置 async 参数。除非事先指定，否则 AJAX 调用拒绝接受异步的三元版本。这是 Firefox 特有的。这是一个例子：

无论我是否指定`async = false;`.

```
function(url, type, async) {
    $.ajax({
        url: url,
        type: type,
        async: async ? async : true
    });
} 
```

正常工作：

```
function(url, type, async) {
    var async = async ? async : true;
    $.ajax({
        url: url,
        type: type,
        async: async
    });
} 
```

尽管代码在我事先指定时可以正常工作，但我不明白为什么三元运算符在这种情况下不起作用。我想解释一下为什么需要事先指定而不是在调用本身中指定。

谢谢你，本

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:31:21.543

你的线

```
async: async ? async : true 
```

...说：如果`async`是真的，使用`async`; 否则，使用`true`. 所以当然它总是真实的。

如果您的目标是默认为`async: true`when`async`根本没有给出，请执行以下操作：

```
async: typeof async === "undefined" ? true : async 
```

这将使用`async`if it's not`undefined`或`true`if it is 的值。

* * *

恕我直言，我认为第二个版本与第一个版本没有什么不同，我认为这一定是观察错误。此代码模拟您正在做的事情，并始终显示`obj.bar`为`true`：

```
jQuery(function($) {

  function foo1(bar) {
    var obj = {
      bar: bar ? bar : true
    };
    display("(1) obj.bar = " + obj.bar);
  }

  function foo2(bar) {
    var bar = bar ? bar : true;
    var obj = {
      bar: bar
    };
    display("(2) obj.bar = " + obj.bar);
  }

  foo1(false);
  foo1(true);
  foo2(false);
  foo2(true);

  function display(msg) {
    $("<p>").html(String(msg)).appendTo(document.body);
  }
}); 
```

[现场复制](http://jsbin.com/ixiced)| [来源](http://jsbin.com/ixiced/edit)

（可能值得注意的是，您的第二个示例中的部分 - 以及我对它的`var`仿真- 被忽略了。没有创建，直接使用参数。）`var async``var bar``var`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:31:06.567

发生这种情况是因为表达式将始终评估为某个真实值。如果你将一个虚假值传递给你的函数，你最终会传递`true`给`$.ajax`. 您可以通过对`false`.

试试`async === false ? false : true`。

当然，[您***永远不***应该使用同步 XHR 请求](http://kellegous.com/j/2007/02/12/no-we-dont-do-s/)。

# c# - 具有 PerWebRequest 生活方式的对象中 WcfService 代理依赖项的发布策略

> ID：10984783
> 
> 赞同：6
> 
> 时间：2012-06-11T17:29:40.780
> 
> 标签：c#, wcf, castle-windsor, wcffacility

如果我有一个`PerWebRequest`具有 PerThread 生活方式的 wcf 代理依赖项的对象，容器会

*   a) 在容器自动释放父对象后使用相同的代理实例？
*   b) PerWebRequest 对象的释放是否会导致代理每次都被释放？

如果a），那么我应该明确释放服务以避免泄漏，或者如果b），如果这是注入它的唯一位置，那么使用PerThread作为代理是否有任何真正的好处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T21:43:14.060

为什么要按线程进行？每个线程是一种非常专业的生活方式，除非你真的需要它，否则我建议你避免它。

使 wcf 代理暂态。

你不必释放它。[这是它的工作原理](http://kozmic.pl/2010/08/27/must-i-release-everything-when-using-windsor/)。

# windows - 如何在 Windows 8 上从 PowerShell 运行 Metro-App？

> ID：10984786
> 
> 赞同：11
> 
> 时间：2012-06-11T17:30:01.017
> 
> 标签：windows, powershell, command-line, windows-8, microsoft-metro

[与Superuser 上的另一个问题](https://superuser.com/q/433477/79358)相关，我正在尝试从命令行运行基于 Metro 的应用程序。根据对我的超级用户问题的评论，我可能会在 PowerShell 命令或脚本上找到答案。我已经尝试过，但在任何有关 PowerShell 和 Windows 8 的互联网参考资料中都找到了任何东西......

那么，有一些特定的方式/命令可以从 Windows 8 上的 PowerShell 命令调用和运行 Metro 风格的应用程序吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T22:39:02.647

没有直接的方法可以做到这一点，但有几种间接的方法。

可以从 PowerShell 调用 Visual Studio 附带的 vsdebuglaunchnotify。

您可以创建自己的使用**IApplicationActivationManager**的 exe 。

如果应用程序与任何文件类型相关联，您可以启动相关文件。

更多信息包含在 MSDN 上的这个线程中：

[http://social.msdn.microsoft.com/Forums/en-US/windowsgeneraldevelopmentissues/thread/8d1b0861-5903-4289-8cb8-541ddaa012fb](http://social.msdn.microsoft.com/Forums/en-US/windowsgeneraldevelopmentissues/thread/8d1b0861-5903-4289-8cb8-541ddaa012fb)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-08T10:09:16.723

这是 Powertoe 的一篇博客文章，它使用 IApplicationActivationManager 方法：

[http://powertoe.wordpress.com/2012/11/02/get-a-list-of-metro-apps-and-launch-them-in-windows-8-using-powershell/](http://powertoe.wordpress.com/2012/11/02/get-a-list-of-metro-apps-and-launch-them-in-windows-8-using-powershell/)

他在这里提供了代码[http://poshcode.org/3740](http://poshcode.org/3740)，它为 powershell 提供了一个 Start-MetroApp 命令行开关。

或者：我认为某些 Metro 应用程序具有协议处理程序，因此您可以通过 URI（例如“appname:dosomething”）与它们通信，但我不确定它的使用范围有多广。

# c# - 使用 MVC 在内部更新 .html() 时，JQuery 对话框显示空白窗口的问题

> ID：10984794
> 
> 赞同：0
> 
> 时间：2012-06-11T17:30:48.823
> 
> 标签：c#, jquery, asp.net-mvc, jquery-ui

我遇到了一个 JQuery 对话框在显示时为空的问题。我知道问题出在哪里，但不知道如何解决。我希望能在这里找到一些帮助。

问题：

我有一个包含简单用户列表的页面。列表中的每个项目/用户都有一个 EDIT 链接。单击编辑时，会弹出一个对话框，其中包含该用户的详细信息。伟大的！听起来很简单。

因此，用户列表初始化将成为对话框的部分视图：

```
@Html.Partial("EditUser", new User()) 
```

这会预加载部分视图，并使用常规初始化对话框：

```
$(function () {
    $("#edit-user-dialog").dialog({
        title: "Edit User",
        autoOpen: false,
        height: 500,
        width: 600,
        modal: true
    });
}); 
```

到现在为止还挺好...

部分视图本身是一个带有 Ajax 表单提交的常规页面，允许我提交修改后的用户信息。与该弹出窗口相关的所有内容（例如其 DIV、连接的 JScript）都必须包含在其中，以便以后可以轻松找到信息。以下是将显示为对话框的部分视图的示例代码：

```
@model MyNamespace.User
<script src="@Url.Content("~/myUserEditScriptScripts.js")" type="text/javascript"></script>

<div id="edit-user-dialog" style="display: none">

@using (Ajax.BeginForm("SaveUserJson", "User", new { id = Model.Id }, new AjaxOptions
        {
            HttpMethod = "post",
            OnSuccess = "editUserSuccess()",
        }))
    {

        <div class="display-field">
            @Html.DisplayFor(model => model.Name) 
        </div>
    .
    .
    .
    Various controls go here...
    .
    .
    .

        <p>
            <input type="submit" value="Detach" />
        </p>
    }

 </div> 
```

到目前为止的标准东西...

因此，当加载初始用户列表时，“编辑用户”部分视图会预加载到页面上，但它不可见，因为 div 设置为 display: none 并且它被初始化为弹出对话框。

接下来，当单击特定用户旁边的“编辑”链接时，我希望该弹出窗口中填充该选定用户的信息。阿贾克斯来救场！

在“编辑”链接上单击我加载带有所选用户数据的部分视图：

```
function editUserLoad(userId) {
    $.ajax({
        url: '/User/EditUser/',
        data: { id: userId },
        type: 'post',
        datatype:'html',
        success: function (data) {
            $("#edit-user-dialog").html(data);
            $("#edit-user-dialog").dialog('open');
        }
    });
} 
```

效果很好！它获取选定的 userId，跳转到我的操作方法，该方法返回填充了我要显示的用户数据的部分视图。

问题是对话框显示为空！嗯，我知道为什么。它是空的，因为对话框 DIV 设置为“显示：无”。但为什么 ？不是 .dialog('open'); 覆盖显示：无，即使它被隐藏，它也不应该显示对话框的内容吗？

我试图让 .show 分开，但它没有用。帮助 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:42:49.310

你可以试试这个方法。只需创建一个空 div，如下所示

```
<script type="text/javascript">
    $(function () {
        $('#dialog').dialog({
            autoOpen: false,
            width: 400,
            resizable: false,
            title: 'Edit User',
            modal: true,
            open: function(event, ui) {
                //Load the Edit User partial View
                $(this).load("@Url.Action("action","controller",new {ID = user_id})");
            },
            buttons: {
                "Close": function () {
                    $(this).dialog("close");
                }
            }
        });

        $('#my-button').click(function () {
            $('#dialog').dialog('open');
        });
    });
</script>
<div id="dialog" title="Edit User" style="overflow: hidden;">

//return partial view
public ActionResult EditUserView(int id)
{
    UserModel um = new UserModel(id);
    return PartialView(um);
} 
```

[这里](http://www.matthidinger.com/archive/2011/02/22/Progressive-enhancement-tutorial-with-ASP-NET-MVC-3-and-jQuery.aspx)有一个很好的例子，你可以用它来

# javascript - 迅雷扩展：打开eml文件

> ID：10984796
> 
> 赞同：0
> 
> 时间：2012-06-11T17:31:03.833
> 
> 标签：javascript, xul, thunderbird, thunderbird-addon

我已经创建了一个扩展，它执行以下操作：

当我使用命令行运行 Thinderbird 时，`thunderbird -MyCustomParam1 "12345"`我的扩展程序将打开一个撰写窗口并将参数添加`"12345"`到窗口中。

我使用的一些代码：

```
// In the calling code
var args = {
  param1: 12345,

};

args.wrappedJSObject = args;
var watcher = Components.classes["@mozilla.org/embedcomp/window-watcher;1"]
                            .getService(Components.interfaces.nsIWindowWatcher);
watcher.openWindow(null, url, windowName, features, args);

// In the window code
var args = window.arguments[0].wrappedJSObject; 
```

当然使用正确的网址和功能。

现在我想做同样的事情，但是对于消息窗口和`eml`选择的 am 文件。

`eml`您可以像这样从命令行打开文件：（`Thunderbird test.eml`这将在新窗口中打开邮件）。

我想要的是以下内容：

`Thunderbird test.eml -MycustomParam1 "1234"`应该打开邮件，并将参数添加`"1234"`到屏幕，这样我就可以在文档窗口中访问它，就像示例 1 一样。

所以基本上我想要类似的东西`watcher.openWindow`，但是有一个给定的`eml`文件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T08:21:45.203

[`MsgOpenFromFile`您可以在函数](http://hg.mozilla.org/comm-central/file/f7a0c097c849/mail/base/content/mailWindowOverlay.js#l1851)中看到这是如何完成的，它正在为 File / Open Saved Message 菜单项调用。您基本上必须获取`eml`文件（[从文件路径获取 nsIFile 实例](https://developer.mozilla.org/en/JavaScript_code_modules/FileUtils.jsm#The_File_constructor)），[将其转换为 URI](https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIIOService#newFileURI%28%29)，然后在打开消息窗口之前更改查询字符串：

```
uri.QueryInterface(Components.interfaces.nsIURL);
uri.query = "type=application/x-message-display";
watcher.openWindow(null, "chrome://messenger/content/messageWindow.xul", "_blank",
                   "all,chrome,dialog=no,status,toolbar", uri); 
```

# java - 读取文本文件数据并写入 TextArea

> ID：10984806
> 
> 赞同：-1
> 
> 时间：2012-06-11T17:31:43.410
> 
> 标签：java, swing, applet, awt, scrollpane

所以我有几个基本问​​题，对你们来说可能很简单。请记住，我不是程序员。我只是一个低级的 IT 支持人员，在高中时上过几门编程课程。

我有一个正在尝试用 Java 构建的 Announcements 程序。该程序将在 Java 小程序中启动，我希望它接受来自“announcements.txt”文件（我们将使用新公告编辑的内容）的输入，然后将其显示在小程序中。我正在使用最新版本的 NetBeans 来解决这个问题。

该程序将添加到 Active Directory 中的组策略中，以便在所有员工登录时启动。

我的问题是：

1.  我可以只使用 FileOutputStream 将“announcements.txt”写入 TextArea 吗？我只处理过控制台应用程序。

2.  我在小程序设计中添加了一个 ScrollPane，并在其顶部放置了一个 TextArea。这就是它的意思吗？当它超出窗口时它会自动插入滚动条还是我应该将文本直接输出到 ScrollPane？

对不起，如果这一切看起来有点基本。我是一个有抱负的程序员，但在我变得半熟练之前，我还有很多工作要做。任何输入表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:40:21.670

1.  不。
    1.  A`JTextArea`可以接受要读取的**输入**流。
    2.  小程序必须通过 URL 访问“应用程序”资源。
2.  使用 Swing 等效项，是的。对于 AWT 等效项，`ScrollPane`不需要 ，因为 a`TextArea`具有内置的可滚动功能。

# android - Android：“更改/拦截网络设置和流量”权限

> ID：10984808
> 
> 赞同：2
> 
> 时间：2012-06-11T17:31:54.650
> 
> 标签：android, android-networking

某些 Android 应用程序中列出了“更改/拦截网络设置和流量”权限，例如：[https ://play.google.com/store/apps/details?id=com.nqmobile.antivirus20&hl=en](https://play.google.com/store/apps/details?id=com.nqmobile.antivirus20&hl=en)

但是从最新的android权限文档：[https](https://developer.android.com/reference/android/Manifest.permission.html) ://developer.android.com/reference/android/Manifest.permission.html根本没有这样的权限。

我正在尝试构建一个应用程序来监控/拦截/更改Android中的网络流量，是否可以在不生根设备的情况下做到这一点？TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:18:11.683

您正在寻找的权限是[WRITE_APN_SETTINGS](http://developer.android.com/reference/android/Manifest.permission.html#WRITE_APN_SETTINGS)

> “更改/拦截网络设置和流量”
> 
> “允许应用程序更改网络设置并拦截和检查所有网络流量，例如更改任何 APN 的代理和端口。恶意应用程序可以在您不知情的情况下监控、重定向或修改网络数据包。”

来源：[http ://androidxref.com/source/raw/frameworks/base/core/res/res/values-en-rGB/strings.xml](http://androidxref.com/source/raw/frameworks/base/core/res/res/values-en-rGB/strings.xml?r=2237e1e7b636651f0ed1efacefa8aaccb21433ca)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T22:04:48.280

我不相信没有根设备这是可能的。

# regex - 使用 RegEx 搜索表以查找缺失信息不会提取所有匹配值

> ID：10984809
> 
> 赞同：1
> 
> 时间：2012-06-11T17:31:56.233
> 
> 标签：regex, vba, ms-access-2010, multiple-matches

我对 VBA 有点陌生，我确实尝试在论坛中搜索这个主题，但我不确定我使用了正确的词来搜索。这是我的问题：

我正在使用 VBA 通过正则表达式提取缺失的信息。假设我有一个包含电话和传真号码的文本表。我想将这些数字收集到一个表格中。到目前为止，我的代码工作正常，但是当我有多个数字（比如常规和 800 #s）由于某种原因时，只检索到一个数字，而不是其他数字。如何将所有结果添加到表中？

询问：

> SELECT regxtr([Table1]![field1]) AS phone FROM Table1;

(regxtr) 函数的 VBA 代码：

```
Option Compare Database

Function regxtr(ByVal Target As String) As String 'Target is the field we are 'extracting from

Dim re As New RegExp
Dim oMatches As Object
Dim oMatch As Object
Dim n As Long
n = 0

'Set re = CreateObject("vbscript.regexp")
With re
.Global = True
.IgnoreCase = True
.Multiline = True
.Pattern = "(\d\d\d.\d\d\d\.\d\d\d\d)" 'keeping the pattern simple for now just to test
End With

    'test before executing
If re.Test(Target) = True Then
Set oMatches = re.Execute(Target)

         'attempt to get all matches. THIS IS WHERE I AM FAILING
For n = 0 To oMatches.Count - 1
Set oMatch = oMatches(n)

   regxtr = oMatch.Value
    n = n + 1  ' does this even belong here?

    Next
End If

End Function 
```

我怎样才能让所有匹配项都填充查询中的字段 [phone]？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:14:36.513

首先是术语的更正。您不是在寻找“子匹配”（在其他正则表达式实现中也称为“捕获组”）。您正在为您的正则表达式寻找“匹配项”，因此您可以删除括号并使用`\d{3}.\d{3}.\d{4}`也就是说，这可能是您需要的：

```
Function regxtr(ByVal Target As String) As String 'Target is the field we are 'extracting from
Dim re As New RegExp
Dim oMatches As Object
Dim oMatch As Object

With re
    .Global = True
    .IgnoreCase = True
    .Multiline = True
    .Pattern = "\d{3}.\d{3}.\d{4}" 'keeping the pattern simple for now just to test
End With

If re.Test(Target) = True Then
    Set oMatches = re.Execute(Target)
    For Each oMatch In oMatches  'Note: you may get multiple matches because you set re.Global = True above, otherwise you would only get the first match
        regxtr = regxtr & " " & oMatch 'Note: this is awkward and not advisable as a way to return the values. This is just an example.
    Next oMatch
End If
End Function 
```

作为测试：

```
?regxtr("foo 993-242.1231bar994.425-1234hello987.234.2424 world 999.342-5252")
 993-242.1231 994.425-1234 987.234.2424 999.342-5252 
```

# java - 在 PDF 中写入 CMYK 图像

> ID：10984811
> 
> 赞同：1
> 
> 时间：2012-06-11T17:32:03.590
> 
> 标签：java, pdf, itext, cmyk

我需要`java.awt.BufferedImage`使用 iText 将 CMYK 图像 () 添加到 Pdf 文档。

我正在尝试这样做：

```
com.lowagie.text.Image img = Image.getInstance(BufferedImage, bgColor); 
```

这会在生成的 PDF 中生成 RGB 图像。（我认为这是一个错误，因为它只是忽略了`ColorModel`）。但是我可以使用：

```
com.lowagie.text.Image img = Image.getInstance(byte[] rawData); 
```

它会在 PDF 中生成正确的 CMYK 图像。但对于第二种情况，我需要转换`java.awt.BufferedImage`为`ByteArray`. 我不能用`ImageIO.write(ByteArrayOutputStream)`. 我也不能这样做，`com.sun.image.codec.jpeg.JPEGImageEncoder`因为我必须使用`OpenJDK`.

任何想法如何实现使用 iText 在 PDF 中编写 CMYK 图像的正确行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T18:13:05.100

所以基本上你要问的是如何将 a 转换`BufferedImage`为 a`byte[]`以打印为 PDF？

```
BufferedImage img; // your image to be printed
String formatName; // name of the image format (see ImageIO docs)
ByteArrayOutputStream baos = new ByteArrayOutputStream();
ImageIO.write( img, formatName, baos);
byte[] rawData = baos.toByteArray(); 
```

您应该能够像在原始帖子中那样将其用于 CMYK 图像：

```
com.lowagie.text.Image img = Image.getInstance(byte[] rawData); 
```

# xml - 在这种情况下，如何在 VB.net 中选择 XML 元素？

> ID：10984817
> 
> 赞同：1
> 
> 时间：2012-06-11T17:32:17.267
> 
> 标签：xml, vb.net, rss, linq-to-xml, xmldocument

所以我有：

```
<rss version="2.0">
    <channel>
        <title>My channel</title>
        <item></item>
        <item></item>
        <item></item>
        <item></item>
    </channel>
</rss> 
```

当我使用 xmlDocument 解析它时，我尝试获取所有项目元素，但如果我使用

```
For Each item As System.Xml.XmlElement In xmlDocument.Item("rss").Item("channel") 
```

它会给我 5 个而不是 4 个结果，因为`<title>My Channel</title>`它被认为是频道下的项目之一。我只是想知道是否有任何方法只循环通过 4 个项目元素。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:56:51.720

您可以使用 XPath 表达式直接向下钻取到您需要的元素。在您的情况下，它将是：

```
For Each item As System.Xml.XmlElement In XmlDocument.SelectNodes("/rss/channel/item") 
```

# javascript - 如何让它淡入？

> ID：10984819
> 
> 赞同：0
> 
> 时间：2012-06-11T17:32:49.930
> 
> 标签：javascript, jquery, html

下面的代码有效，但#wrapperone 只是在屏幕上弹出.. 有没有办法让它淡入？

```
jQuery(window).load(function(){
    function fixDiv() {
        var jQuerydiv = jQuery("#wrapperone");
        if (jQuery(window).scrollTop() > jQuerydiv.data("top")) { 
            jQuery('#wrapperone').css({'position': 'fixed', 'top': '0', 'width': '100%', 'background': 'rgba(255,255,255,0.1)'}); 
        }
        else {
            jQuery('#wrapperone').css({'position': 'static', 'top': 'auto', 'width': '100%', 'background': 'transparent'});
        }
    }

    jQuery("#wrapperone").data("top", jQuery("#wrapperone").offset().top);
    jQuery(window).scroll(fixDiv);    
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:36:01.443

```
 $("#wrapperone").fadeIn(); 
```

我想这就是你要找的。更多关于淡入功能的[信息在这里](http://api.jquery.com/fadeIn/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:40:20.403

尝试使用不透明度并使用 jQuery 的淡入淡出功能。

```
jQuery(window).load(function(){
function fixDiv() {
    var jQuerydiv = jQuery("#wrapperone");
    if (jQuery(window).scrollTop() > jQuerydiv.data("top")) { 
        jQuery('#wrapperone').css({'position': 'fixed', 'top': '0', 'width': '100%', 'background': 'rgba(255,255,255,0.1)', 'opacity': '0'}).fadeIn(100); 
    }
    else {
        jQuery('#wrapperone').css({'position': 'static', 'top': 'auto', 'width': '100%', 'background': 'transparent'});
    }
}

jQuery("#wrapperone").data("top", jQuery("#wrapperone").offset().top);
jQuery(window).scroll(fixDiv);

});` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:40:26.200

尝试如下，

```
function fixDiv() {
   var jQuerydiv = jQuery("#wrapperone");
   if (jQuery(window).scrollTop() > jQuerydiv.data("top")) { 
      jQuery('#wrapperone')
          .hide() //Hide the wrapper
          // v-- Position it
          .css({'position': 'fixed', 'top': '0', 'width': '100%', 'background': 'rgba(255,255,255,0.1)'})
          .fadeIn(); //Fade In
   }
   else {
      jQuery('#wrapperone')
           .hide() //Hide the wrapper
           // v-- Position it
           .css({'position': 'static', 'top': 'auto', 'width': '100%', 'background': 'transparent'})   
           .fadeIn(); //Fade In
    }
} 
```

# html - 有什么方法可以阻止 Visual Studio 在 Ctrl+E+D 之后删除空格

> ID：10984823
> 
> 赞同：2
> 
> 时间：2012-06-11T17:33:08.200
> 
> 标签：html, visual-studio-2010, code-formatting, auto-indent

我有一个包含以下代码的视图：

```
<ul class="nav nav-tabs">
    <li class="active"><a href="#General" data-toggle="tab"><i class="icon-home"></i> General</a></li>
    <li><a href="#Background" data-toggle="tab"><i class="icon-picture"></i> Background</a></li>
    <li><a href="#FormContainer" data-toggle="tab"><i class="icon-edit"></i> Form Container</a></li>
    <li><a href="#Logo" data-toggle="tab"><i class="icon-picture"></i> Logo</a></li>
    <li><a href="#Colors" data-toggle="tab"><i class="icon-tint"></i> Colors</a></li>
    <li><a href="#Fonts" data-toggle="tab"><i class="icon-font"></i> Fonts</a></li>
</ul> 
```

类和 html 属性来自 Twitter Bootstrap，但这并不重要。

按下 Ctrl+E+D 组合后，以下代码将更改：

`<i class="icon-home"></i> General`到`<i class="icon-home"></i>General`

我还尝试在标签之间放置一个空格，`<i>`但它也被剥离了。

这有效地将选项卡标题移动到更靠近图标的位置，虽然它很容易修复，但我不想每次从 Visual Studio 中的自动代码格式化中受益时都必须这样做。

有没有办法改变/调整这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T18:19:37.927

你可以在这里玩东西 :: Tools/Options/Text Editor/HTML/Formatting

有时你会发现要完全按照你想要的方式得到东西有点困难，但如果有办法调整你的间距，那就是它所在的位置。

# jquery - 成功 $.ajax 请求后没有调用成功

> ID：10984824
> 
> 赞同：0
> 
> 时间：2012-06-11T17:33:15.970
> 
> 标签：jquery

我正在尝试在haml模板中编写一些javascript：javascript闭包。它应该根据通过 ajax 调用获得的状态显示/隐藏带有控件的 div。我无法让该代码以正确的方式运行。我不知道为什么。不调用 Ajax 处理程序成功和完成。Firebug 在控制台中显示成功的 ajax 请求并且没有错误。我认为 Thin.ajax 中的“自我”可能会以某种方式被破坏。

```
function Thin() {
  this.ajax = function() {
    $.ajax({ url: "#{check_if_running_user_case_path(@user_case)}", success: this.on_success, error: this.on_error, dataType: "json", complete: this.poll, timeout: 30000 });
  }

  this.poll = function() {
    alert("poll");
    setTimeout(this.ajax, 2000);
  };

  this.manage_divs = function(st) {
    if (st != this.running) {
      if (st == "running") {
        this.hide_div_arr_show_div([this.start_div, this.starting_div, this.stopping_div], this.stop_div);
      } else if (st == "starting"){
        this.hide_div_arr_show_div([this.start_div, this.stop_div, this.stopping_div], this.starting_div);
      } else if (st == "stopping"){
        this.hide_div_arr_show_div([this.start_div, this.stop_div, this.starting_div], this.stopping_div);
      } else {
        this.hide_div_arr_show_div([this.stopping_div, this.stop_div, this.starting_div], this.start_div);
      }
      this.running = st;
    }
  };

  this.setup  = function(start_div, starting_div, stop_div, stopping_div) {
    this.start_div    = start_div;
    this.starting_div = starting_div;
    this.stop_div     = stop_div;
    this.stopping_div = stopping_div;
    // set as stopped
    this.running = "12345";
    this.poll();
  };

  this.on_error   = function(jqXHR, textStatus, errorThrown){
    alert(["Thin polling error", textStatus]);
  };

  this.on_success = function(data, textStatus, jqXHR) {
    alert("success!");
    var st = data.user_case;
    this.manage_divs(st);
  };

  this.hide_div_arr_show_div  = function(div_arr, div){
    for(var i = 0; i < div_arr.length; i++)
        div_arr[i].hide();
    div.show();
  };
};

var thin = new Thin();
thin.setup($("#user_case_stopped"), $("#user_case_starting"), $("#user_case_running"), $("#user_case_stopping"));
thin.manage_divs("#{@running}"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:41:19.810

jQuery 内部的 Ajax 方法`this`将引用全局范围。尝试显式引用您的父对象以确保您使用正确的范围（您的对象）：

```
function Thin() {
    var that = this;

    that.ajax = function() {
                  $.ajax({ url: "#{check_if_running_user_case_path(@user_case)}",
                        success: that.on_success, 
                        error: that.on_error, 
                        dataType: "json", 
                        complete: that.poll, 
                        timeout: 30000 });
                }

    ... 
```

编辑：仅供参考，[这是一篇](http://javascriptplayground.com/blog/2012/04/javascript-variable-scope-this)`this`关于Javascript范围界定的好文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:37:04.910

我在firefox中遇到过这个错误，所以我只是内联了success方法。

而不是成功：this.success

我用了

```
success:function(){}, 
```

# wpf - WPF布局控制问题

> ID：10984826
> 
> 赞同：0
> 
> 时间：2012-06-11T17:33:33.760
> 
> 标签：wpf, layout, controls

我有根据编辑器打印标签的 wpf 项目。项目有 17 个不同的编辑器。这是我当前用于当前标签编辑器的应用程序的小图。

它有几个小控件，如工具箱、尺寸滑块、标尺、画布导航栏、标签定义栏等......它还有一个称为标签编辑器的控件，此控件将根据不同的编辑器 (17) 而有所不同，其他控件将保持原样。

不，我想制作一些通用控件，其中包含除标签编辑器之外的所有控件，因此每次创建新编辑器时，我都不需要每次都重新创建所有控件。我可以使用我所有的 17 个。

我应该采取什么控制措施，内容控制、控制模板、数据模板或用户控制。这是我所拥有的小图。

![在此处输入图像描述](../Images/f417babba87af5340008e124843d7c78.png)

请分享您的建议。

谢谢

迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T19:02:51.980

您可以尝试通过 a 加载标签编辑器`Frame`并为每个标签编辑器创建一个页面。

`LabelEditor`或者，您可以创建一个具有接受对象的属性的自定义控件。不过，这种方法会更加困难。

# javascript - 检测通过另一个 javascript 函数检查的单选按钮

> ID：10984829
> 
> 赞同：0
> 
> 时间：2012-06-11T17:33:43.120
> 
> 标签：javascript, jquery, html

我有一个带有 javascript 函数的页面，该函数可以更改选择的单选按钮，如下所示：

```
if ($('#tables').hasClass('radiobuttons')){
    var tables = $('#tables').find('table'),
        rows = tables.find('tr'),
        radios = $('input[type="radio"]');

    rows.live('click', function(){
        var clicked = $(this);
        clicked.find('input[type=radio]').attr('checked', true);
        clicked.parent().find('tr').removeClass('selected');
        clicked.addClass('selected');
    });
} 
```

基本上，这允许用户单击表格中一行的任意位置，并且将选择相应的单选按钮。

单选按钮都有一个`onchange`附加到它们的事件 - 除了以这种方式选择单选按钮时**不会调用该函数。**

```
<input type="radio" onchange="someFunction();" name="myradiobutton" value="123"> 
```

除了 onchange 事件之外，我如何检测到值已更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:39:36.160

不要在单选按钮上设置属性，而是尝试触发点击事件。

`clicked.find('input[type=radio]').trigger("click");`

或者，您可以尝试将您的单击事件处理程序绑定到用户单击的行，而不是（或除了）实际的单选按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:38:40.053

您可以查找引发事件的目标元素并做出相应决定。您可以使用作为事件处理程序中的第一个参数的事件对象来获取目标元素。

```
rows.live('click', function(e){
    if($(e.target).is(':radio'){
        //radio button clicked
    }
}); 
```

# java - 将“asdfgh”之类的字符串转换为整数值

> ID：10984832
> 
> 赞同：0
> 
> 时间：2012-06-11T17:33:57.593
> 
> 标签：java, string, integer

我想将字符串转换为“asdfgh”而不是“2345”，我知道我们可以使用以下方法转换“2345”：Integer.parseInt("stringOfNumber"); 但我必须在 java 中将“asdfgg”转换为整数值。

请帮我。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:48:12.717

使用方法[hashCode](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#hashCode%28%29)，这将根据文档返回任何字符串的 int 值。

> 返回此字符串的哈希码。String 对象的哈希码计算为
> 
> ```
> s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1] 
> ```
> 
> 使用 int 算术，其中 s[i] 是字符串的第 i 个字符，n 是字符串的长度，^ 表示求幂。（空字符串的哈希值为零。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:40:16.130

假设您要将字符串转换为 ascii，您将执行以下操作：

```
String randomString = "asdfgh";  
byte[] asciiString = randomString.getBytes("US-ASCII"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:44:10.807

你的问题不清楚，但你可能想要这个-

```
 String str = "Abcdefg";
    char[] cArray = str.toCharArray();
    int result=0;

    for (int i=0; i<cArray.length; i++){
        result+=cArray[i]*Math.pow(10,i);
    }

    System.out.println(result); 
```

# java - 正则表达式，组问题

> ID：10984835
> 
> 赞同：1
> 
> 时间：2012-06-11T17:34:04.133
> 
> 标签：java, regex

java中的正则表达式有这样的问题。我编码聊天应用程序和客户端可以发送到服务器只是“消息”或“\命令值”。我想解析这个字符串并检查是否是行中的命令。如果它登录 - 值是必需的，但如果它注销 value.required 应该是假的。我创建了这样的正则表达式

```
"^\\\\(?<comm>login|status|((?=logout)))\\s(?<content>\\w+)" 
```

我应该写什么来注销条件？我想在通讯组中注销。我应该写一些类似 if logout 的东西，而不是阅读之后的任何其他内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:36:22.210

您最好将参数设为可选：

```
^\\(?<command>login|status|logout)(?:\s(?<param>\w+))? 
```

并使用 Java 检查结果的逻辑。

如果你真的想使用正则表达式，你可以这样做：

```
^\\(?<command>login|status|logout(?=$))(?:\s(?<param>\w+))?$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:50:06.007

我可能会检查某个命令是否应该在通用代码（即Java）中而不是在正则表达式中具有参数。也就是说，正则表达式有利于分词，但不利于解析。

但是，如果您有充分的理由这样做，那么我可能会将表达式分成两部分 - 一个命令需要命令，另一个不需要命令。例如：

```
^\\(?:(?<command>login)\s+(?<param>\w+)|(?<command>status|logout)(?<param>))$ 
```

请注意，final`(?<param>)`并不是正则表达式正确运行所必需的，它只是为了让任何后续代码都可以依赖结果中的两个命名组：*command*和*param*。

从逻辑上讲，这可以扩展到三组，其中第三组包含带有可选参数的命令。

如果您将 Groovy（或 Java 7）用于多行字符串，则可以更清楚地写成这样：

```
^\\(?x:
    (?<command>login) \s+ (?<param>\w+)   # Commands that require a parameter
    |                                     # -or-
    (?<command>status|logout) (?<param>)  # Commands that do not require a parameter
)$ 
```

# django - 如何使用 mod-pagespeed 和 Django 缩小 CSS/JS？

> ID：10984837
> 
> 赞同：0
> 
> 时间：2012-06-11T17:34:09.993
> 
> 标签：django, mod-pagespeed

刚刚在我的 django 实例上安装了最新版本的 mod-pagespeed 并尝试使用以下 pagespeed.conf 缩小 CSS/JS 但徒劳无功，即使 remove_comments 和 collapse_whitespace 似乎可行。

```
ModPagespeedEnableFilters rewrite_javascript,rewrite_css,flatten_css_imports
ModPagespeedEnableFilters collapse_whitespace,elide_attributes
ModPagespeedEnableFilters combine_javascript,remove_comments 
```

在 django 模板中，CSS/JS url 由 {{ STATIC_URL }}media/main.js 等指向，并且匹配的文件夹在 apache 设置中设置为别名，但 JS/CSS（及其链接）均未更改一点也不。

我怀疑由于模板引擎的干预，mod-pagespeed 没有获取 js/css ..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T03:15:49.650

我终于找到了会有所作为的选项。

```
# Explicitly tell mod_pagespeed to load some resources from disk.
# This will speed up load time and update frequency.
#
# This should only be used for static resources which do not need
# specific headers set or other processing by Apache.
#
# Both URL and filesystem path should specify directories and
# filesystem path must be absolute (for now).
#
ModPagespeedLoadFromFile "http://example.com/static/" "/var/www/static/" 
```

注释掉 ModPagespeedLoadFromFile 并为您的 js/css 找到静态文件夹

# url - Jquery 显示 url 是否包含

> ID：10984845
> 
> 赞同：0
> 
> 时间：2012-06-11T17:34:47.833
> 
> 标签：url, if-statement, show, contains

我有一个显示和隐藏 div 块的简单 jquery 脚本：

```
<script type="text/javascript">'
    $(document).ready(function(){    
        $(".slidingDiv").hide();
        $('.show_hide').click(function(){
            $(".slidingDiv").slideToggle();
        }); 
    });
</script>

<a class="show_hide" href="#">Show/hide</a>
<div name="gohere" class="slidingDiv">
   ...
</div> 
```

它工作正常，但如果 URL 包含 #gohere 我想自动显示此 div 并仅在`.show_hide`单击时隐藏它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:38:20.760

将divs ID设置为gohere，然后你可以这样做：

```
$('.show_hide').click(function(){
    $($(this).attr('href')).slideToggle();
}); 
```

由于您的 href 属性将包含`#gohere`，因此 slidetoggle 的选择器最终将是`#gohere`，这与您的 div ID 相关。

编辑：对于您问题的第一部分，您可以从`window.location.hash`.

```
if (window.location.hash.length > 0) {
    $(window.location.hash).show();
} 
```

您可能应该在那里放置一些更好的错误检查，但它应该可以工作。

# c# - 第二次回发后，按钮无法触发 OnClick

> ID：10984851
> 
> 赞同：1
> 
> 时间：2012-06-11T17:35:23.660
> 
> 标签：c#, asp.net, events, user-controls

我创建了一个站点，在所有页面后面都有一个 MasterPage，然后是一个带有动态加载我的用户控件的菜单的页面，在其中，一个用户控件具有一个动态加载其他用户控件的菜单...

我的问题是：有菜单的用户控件，在我第一次触发 OnClick 事件后，我无法再次触发它......有人知道为什么吗？

代码如下：

这页纸：

```
 public partial class AboutBrazil : BasePage
{
    private String LastLoadedControl_AboutBrazil
    {
        get
        {
            if (ViewState["LastLoadedControl_AboutBrazil"] != null)
            {
                return ViewState["LastLoadedControl_AboutBrazil"].ToString();
            }
            else
            {
                return "~/UserControl/AboutBrazil/ucIntroduction.ascx";
            }
        }
        set
        {
            ViewState["LastLoadedControl_AboutBrazil"] = value;
        }
    }

    private void LoadUserControl()
    {
        UserControl userControl = (UserControl)Page.LoadControl(LastLoadedControl_AboutBrazil);

        phAboutBrazil.Controls.Clear();
        phAboutBrazil.Controls.Add(userControl);

        userControl.ID = "myUserControl";
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        this.SetTitulo("About Brazil");

        LoadUserControl();
    }

    protected void btnLoadUserControl_Click(object sender, EventArgs e)
    {
        System.Drawing.Color foreColorI = System.Drawing.Color.FromArgb(102, 102, 102);
        System.Drawing.Color foreColorA = System.Drawing.Color.FromArgb(27, 41, 13);

        Button btnSender = (Button)sender;

        btnIntroduction.ForeColor = foreColorI;
        btnHistory.ForeColor = foreColorI;
        btnThePeople.ForeColor = foreColorI;
        btnBrazilianRegions.ForeColor = foreColorI;
        btnBrazilianEcosystem.ForeColor = foreColorI;
        btnGeneralInformation.ForeColor = foreColorI;
        btnTips.ForeColor = foreColorI;

        switch (btnSender.CommandArgument)
        {
            case "Introduction":
                btnSender.ForeColor = foreColorA;

                LastLoadedControl_AboutBrazil = "~/UserControl/AboutBrazil/ucIntroduction.ascx";
                break;
            case "History":
                btnSender.ForeColor = foreColorA;

                LastLoadedControl_AboutBrazil = "~/UserControl/AboutBrazil/ucHistory.ascx";
                break;
            case "The People":
                btnSender.ForeColor = foreColorA;

                LastLoadedControl_AboutBrazil = "~/UserControl/AboutBrazil/ucThePeople.ascx";
                break;
            case "The Brazilian Regions":
                btnSender.ForeColor = foreColorA;

                LastLoadedControl_AboutBrazil = "~/UserControl/AboutBrazil/ucTheBrazilianRegions.ascx";
                break;
            default:
                btnSender.ForeColor = foreColorA;

                LastLoadedControl_AboutBrazil = "~/UserControl/AboutBrazil/ucIntroduction.ascx";
                break;
        }

        this.LoadUserControl();
    }
} 
```

第一个用户控制：

```
 private List<String> listControl = new List<String>(new String[] { "Introduction", "North", "Northeast", "Middle-West", "South", "Southeast" });

    private String LastLoadedControl_TheBrazilianRegions
    {
        get
        {
            if (ViewState["LastLoadedControl_TheBrazilianRegions"] != null)
            {
                return ViewState["LastLoadedControl_TheBrazilianRegions"].ToString();
            }
            else
            {
                return "~/UserControl/AboutBrazil/TheBrazilianRegions/ucIntroduction.ascx";
            }
        }
        set
        {
            ViewState["LastLoadedControl_TheBrazilianRegions"] = value;
        }
    }

    private String LastClickedButton_TheBrazilianRegions
    {
        get
        {
            if (ViewState["LastClickedButton_TheBrazilianRegions"] != null)
            {
                return ViewState["LastClickedButton_TheBrazilianRegions"].ToString();
            }
            else
            {
                return "Introduction";
            }
        }
        set
        {
            ViewState["LastClickedButton_TheBrazilianRegions"] = value;
        }
    }

    private void LoadUserControl()
    {
        UserControl userControl = (UserControl)Page.LoadControl(LastLoadedControl_TheBrazilianRegions);

        phTheBrazilianRegions.Controls.Clear();
        phTheBrazilianRegions.Controls.Add(userControl);

        userControl.ID = "myUserControlNeasted";
    }

    private void LoadClickedButton()
    {
        foreach (String control in this.listControl)
        {
            HtmlTableCell tdControl = (HtmlTableCell)this.FindControl("td" + control.Replace("-", ""));

            if (control == this.LastClickedButton_TheBrazilianRegions)
            {
                tdControl.InnerHtml = "<div class=\"menuAtivoLeft\"></div><div class=\"menuAtivoCenter\"><div class=\"menuAtivoCenterContent\">" + this.LastClickedButton_TheBrazilianRegions + "</div></div><div class=\"menuAtivoRight\"></div>";
            }
            else
            {
                try
                {
                    Button btnButton = new Button();

                    btnButton.ID = "btn" + control.Replace("-", "");
                    btnButton.Text = control;
                    btnButton.CommandArgument = control;
                    btnButton.CssClass = "tableContentMenuContentButton";
                    btnButton.Click += new EventHandler(this.btnLoadUserControl_Click);

                    AsyncPostBackTrigger _Trigger = new AsyncPostBackTrigger();

                    _Trigger.ControlID = btnButton.ID;
                    _Trigger.EventName = "Click";

                    tdControl.Controls.Clear();
                    tdControl.Controls.Add(btnButton);

                    this.upTheBrazilianRegions.Triggers.Clear();
                    this.upTheBrazilianRegions.Triggers.Add(_Trigger);

                    btnButton.Dispose();
                }
                catch (Exception ex)
                {
                    throw ex;
                }
            }

            tdControl.Dispose();
        }
    }

    protected override void OnPreRender(EventArgs e)
    {
        this.LoadUserControl();
        this.LoadClickedButton();
        base.OnPreRender(e);
    }

    protected void Page_Load(object sender, EventArgs e)
    {
    }

    protected void btnLoadUserControl_Click(object sender, EventArgs e)
    {
        Button btnSender = (Button)sender;

        switch (btnSender.CommandArgument)
        {
            case "Introduction":
                LastLoadedControl_TheBrazilianRegions = "~/UserControl/AboutBrazil/TheBrazilianRegions/ucIntroduction.ascx";
                break;
            case "North":
                LastLoadedControl_TheBrazilianRegions = "~/UserControl/AboutBrazil/TheBrazilianRegions/ucNorth.ascx";
                break;
            case "Northeast":
                LastLoadedControl_TheBrazilianRegions = "~/UserControl/AboutBrazil/TheBrazilianRegions/ucNortheast.ascx";
                break;
            case "Middle-West":
                LastLoadedControl_TheBrazilianRegions = "~/UserControl/AboutBrazil/TheBrazilianRegions/usMiddleWest.ascx";
                break;
            case "South":
                LastLoadedControl_TheBrazilianRegions = "~/UserControl/AboutBrazil/TheBrazilianRegions/ucSouth.ascx";
                break;
            case "Southeast":
                LastLoadedControl_TheBrazilianRegions = "~/UserControl/AboutBrazil/TheBrazilianRegions/ucSoutheast.ascx";
                break;
            default:
                LastLoadedControl_TheBrazilianRegions = "~/UserControl/AboutBrazil/TheBrazilianRegions/ucIntroduction.ascx";
                break;
        }

        LastClickedButton_TheBrazilianRegions = btnSender.CommandArgument;

        this.LoadUserControl();
        this.LoadClickedButton();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-19T15:06:13.900

我解决了删除此行的问题：

```
AsyncPostBackTrigger _Trigger = new AsyncPostBackTrigger();

_Trigger.ControlID = btnButton.ID;
_Trigger.EventName = "Click";

this.upTheBrazilianRegions.Triggers.Clear();
this.upTheBrazilianRegions.Triggers.Add(_Trigger); 
```

# javascript - Dojo MVC 的简单登录实现

> ID：10984855
> 
> 赞同：3
> 
> 时间：2012-06-11T17:35:42.667
> 
> 标签：javascript, model-view-controller, dojo

有没有关于如何实现一个简单的登录页面/对话框的例子？我一直在尝试使用 dojo 样板来做到这一点（检查我之前的问题：[Dojo MVC 的布局实现](https://stackoverflow.com/questions/10953316/layout-implementation-for-dojo-mvc)）。到目前为止，我已经能够显示我的对话框。但我希望能够获取我的数据，并且在点击事件时希望有一个警报框（例如他的内容）。

我的观点：

```
<form action="Login" method="post" validate="true" id="loginForm">
  <table width="258">
    &nbsp;
    <tr>
      <td><label>Login</label></td>
      <td><input class="cell" type="text" trim="true" dojoType="dijit.form.TextBox" value="" name="login" id="userId"/></td>
    </tr>
    <tr>
      <td><label>Password</label></td>
      <td><input class="cell" type="password" trim="true" dojoType="dijit.form.TextBox" value="" name="password" id="password"/></td>
    </tr>
    <tr><td colspan="2">&nbsp;</td></tr>
    <tr>
      <td colspan="2" align="center">
      <table border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td align="center" valign="top"><button dojoType="dijit.form.Button" type="submit" id="LoginButton" onClick="connect">Ok</button></td>
            &nbsp;
            <td align="left" valign="top"><button dojoType="dijit.form.Button" type="submit" onclick="document.Login.reset()" id="Cancel">Cancel</button></td>
            &nbsp;
            <td><button dojoType="dijit.form.Button" type="submit" onclick="showDialog();" id="resetPassword"> Show Dialog </button></td>
          </tr>
     </table>
     &nbsp;
     </td>
    </tr>
  </table>
</form> 
```

我的小部件模块/类

```
define([
    "dojo/_base/declare",
    "dijit/_Widget",
    "dijit/_TemplatedMixin",
    "dijit/_WidgetsInTemplateMixin",
    "dojo/text!app/views/Login/Login.html",
    "dijit/Dialog",
    "dijit/form/Button",
    "dijit/form/TextBox"
], function(
    declare,
    _Widget,
    _TemplatedMixin, 
    _WidgetsInTemplateMixin,
    template,
    Dialog
){
    return declare([_Widget, _TemplatedMixin, _WidgetsInTemplateMixin, Dialog], {

        templateString: template
    });
}); 
```

现在，如果您检查 HTML 元素 id LoginButton 在这种情况下应该调用“连接”函数。哪个应该显示（在警报框中）用户名和密码当前输入。

我把我的功能放在哪里？有点儿...

```
 connect : function(){
    alert("username :" + dom.byId("userId").value() 
+ "  Password: " + dom.byId("password").value());
    } 
```

**编辑：新代码**

```
define([
    "dojo/_base/declare",
    "dijit/_Widget",
    "dojo/dom",
    "dijit/_TemplatedMixin",
    "dijit/_WidgetsInTemplateMixin",
    "dojo/text!app/views/Login/Login.html",
    "dijit/Dialog",
    "dijit/form/Button",
    "dijit/form/TextBox"
], function(
    declare,
    dom,
    _Widget,
    _TemplatedMixin, 
    _WidgetsInTemplateMixin,
    template,
    Dialog
){
    return declare("login", [_Widget, _TemplatedMixin, _WidgetsInTemplateMixin, Dialog], {

        templateString: template,

        postCreate: function() {
           this.inherited(arguments);
           // make reference to widget from the node attachment
           this.submitButton = dijit.getEnclosingWidget(this.submitButtonNode);
           // override its onSubmit
           this.submitButton.onClick = function(){
             alert("username :" + dom.byId("userId").value() 
                 + "  Password: " + dom.byId("password").value());
           };
        },
        // and a sample on how to implement widget-in-template stateful get/setter pattern
        // e.g. if submitbutton label should change on some event, call as such:
        // dijit.byId('loginForm').set("submitLabel", "Sendin login, please wait");
        _setSubmitLabelAttr : function(value) {
            return this.submitButton.set("label", value);
        },
        _getSubmitLabelAttr : function() {
            return this.submitButton.get("label");
        },
    });
}); 
```

我的 main.js：

```
define([ 'dojo/has', 'require', 'dojo/_base/sniff'], function (has, require) {
    var app = {};

    if (has('host-browser')) {

        require([ './views/Login', 'dojo/domReady!' ], function (Login) {
            app.login = new Login().placeAt(document.body);

            app.login.startup();

            // And now…
            app.login.show();
        });
    }
    else {
        console.log('Hello from the server!');
    }
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T14:29:56.313

我想添加我的解决方案：http: [//jsfiddle.net/phusick/tG8Sg/](http://jsfiddle.net/phusick/tG8Sg/)

由于 jsFiddle 的限制，它有点扭曲，但主要原则与我在编码中采用的相同。

首先，登录过程（或任何其他表单处理）被封装在对话框中，它与应用程序的其余部分进行通信，认为通过`dojo/Evented`. 这是它的工作原理：

```
var loginDialog = new LoginDialog({ controller: loginController});
loginDialog.startup();
loginDialog.show();

loginDialog.on("cancel", function() {
    console.log("Login cancelled.");        
});

loginDialog.on("error", function() { 
    console.log("Login error.");
});

loginDialog.on("success", function() { 
    console.log("Login success.");
    console.log(JSON.stringify(this.form.get("value")));
}); 
```

正如您在 jsFiddle 中看到的，我在构造函数中组装了两个模板*dialog-template*和*login-form-template 。*`LoginDialog`原因是我通常还会有一个类包装`dijit/form/Form`来做一些超出标准`dijit/form/Form`验证和数据序列化的魔术，但由于登录很简单，而且在 jsFiddle 的单个文件中会很乱，所以我摆脱了它。将表单与对话框分开的优点是您可以在其他地方使用相同的表单（即*View*）以及所有表单即席代码，例如在`ContentPane`. 表单只是用来向用户显示和收集数据，它不应该直接与*Model*通信，即 web 服务，有一个*Controller*为了这个目的：

```
var LoginController = declare(null, {

    constructor: function(kwArgs) {
        lang.mixin(this, kwArgs);
    },

    login: function(data) {
        // simulate calling web service for authentication
        var def = new Deferred();
        setTimeout(lang.hitch(this, function() {
            def.resolve(data.username == this.username && data.password == this.password);                
        }), 1000);
        return def;
    }
}); 
```

创建一个实例`LoginController`：

```
// provide username & password in the constructor
// since we do not have web service here to authenticate against    
var loginController = new LoginController({username: "user", password: "user"}); 
```

并将其传递给`LoginDialog`构造函数，如上所示：

```
var loginDialog = new LoginDialog({ controller: loginController}); 
```

最后`LoginDialog`上课：

```
var LoginDialog = declare([Dialog, Evented], {

    READY: 0,
    BUSY: 1,

    title: "Login Dialog",
    message: "",
    busyLabel: "Working...",

    // Binding property values to DOM nodes in templates
    // see: http://www.enterprisedojo.com/2010/10/02/lessons-in-widgetry-binding-property-values-to-dom-nodes-in-templates/
    attributeMap: lang.delegate(dijit._Widget.prototype.attributeMap, {
        message: {
            node: "messageNode",
            type: "innerHTML"               
        }            
    }),

    constructor: function(/*Object*/ kwArgs) {
        lang.mixin(this, kwArgs);            
        var dialogTemplate = dom.byId("dialog-template").textContent; 
        var formTemplate = dom.byId("login-form-template").textContent;
        var template = lang.replace(dialogTemplate, {
            form: formTemplate                
        });

        var contentWidget = new (declare(
            [_Widget, _TemplatedMixin, _WidgetsInTemplateMixin],
            {
                templateString: template                   
            }
        )); 
        contentWidget.startup();
        var content = this.content = contentWidget;
        this.form = content.form;
        // shortcuts
        this.submitButton = content.submitButton;
        this.cancelButton = content.cancelButton;
        this.messageNode = content.messageNode;
    },

    postCreate: function() {
        this.inherited(arguments);

        this.readyState= this.READY;
        this.okLabel = this.submitButton.get("label");

        this.connect(this.submitButton, "onClick", "onSubmit");
        this.connect(this.cancelButton, "onClick", "onCancel");

        this.watch("readyState", lang.hitch(this, "_onReadyStateChange"));

        this.form.watch("state", lang.hitch(this, "_onValidStateChange"));
        this._onValidStateChange();
    },

    onSubmit: function() {
        this.set("readyState", this.BUSY);
        this.set("message", ""); 
        var data = this.form.get("value");

        // ask the controller to login
        var auth = this.controller.login(data);

        Deferred.when(auth, lang.hitch(this, function(loginSuccess) {
            if (loginSuccess === true) {
                this.onLoginSuccess();
                return;                    
            }
            this.onLoginError();
        }));
    },

    onLoginSuccess: function() {
        this.set("readyState", this.READY);            
        this.emit("success");
    },

    onLoginError: function() {
        this.set("readyState", this.READY);
        this.set("message", "Please try again."); 
        this.emit("error");         
    },

    onCancel: function() {
       this.emit("cancel");     
    },

    _onValidStateChange: function() {
        this.submitButton.set("disabled", !!this.form.get("state").length);
    },

    _onReadyStateChange: function() {
        var isBusy = this.get("readyState") == this.BUSY;
        this.submitButton.set("label", isBusy ? this.busyLabel : this.okLabel);
        this.submitButton.set("disabled", isBusy);
    }            
}); 
```

请参阅上述[jsFiddle](http://jsfiddle.net/phusick/tG8Sg/)中的模板。它们通常应该在单独的文件中`required`。`dojo/text!`我将它们放入`<script type="text/template">`以适应 jsFiddle。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:31:04.540

在 mschr 的帮助下。我遇到了这个特殊的解决方案。

```
define([
"dojo/_base/declare",
"dojo/dom",
"dijit/_Widget",
"dijit/_TemplatedMixin",
"dijit/_WidgetsInTemplateMixin",
"dojo/text!app/views/Login/Login.html",
"dijit/Dialog",
"dijit/form/Button",
"dijit/form/TextBox"

], function(
    declare,
    dom,
 _Widget,
_TemplatedMixin, 
_WidgetsInTemplateMixin,
template,
Dialog
){
    return declare([_Widget, _TemplatedMixin, _WidgetsInTemplateMixin, Dialog], {

        templateString: template,

        postCreate: function() {
           this.inherited(arguments);
           // make reference to widget from the node attachment
           //this.submitButton = this.getChildren()[ButtonIndex];
           // override its onSubmit
             /*alert("username :" + dom.byId("userId").value() 
                 + "  Password: " + dom.byId("password").value());*/
            dojo.connect(this.loginButton, 'onclick', this._login);
        },
        // and a sample on how to implement widget-in-template stateful get/setter pattern
        // e.g. if submitbutton label should change on some event, call as such:
        // dijit.byId('loginForm').set("submitLabel", "Sendin login, please wait");
        _login : function() {
            var value = dom.byId("userId").value;

            if(value)
                alert("username: " + value);
        },
        // and a sample on how to implement widget-in-template stateful get/setter pattern
        // e.g. if submitbutton label should change on some event, call as such:
        // dijit.byId('loginForm').set("submitLabel", "Sendin login, please wait");
        _setSubmitLabelAttr : function(value) {
            return this.submitButton.set("label", value);
        },
        _getSubmitLabelAttr : function() {
            return this.submitButton.get("label");
        },
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T18:21:58.783

当您模板化小部件时，您会想要使用模板化小部件解析。取自[http://dojotoolkit.org/documentation/tutorials/1.6/templated/](http://dojotoolkit.org/documentation/tutorials/1.6/templated/)下面描述了如何将事件附加到一个简单的 domnode。

```
<div 
  data-dojo-attach-point="focusNode"
  data-dojo-attach-event="ondijitclick:_onClick"
  role="menuitem" tabindex="-1">
    <span data-dojo-attach-point="containerNode"></span>
</div> 
```

当您在模板中有小部件时，请引用您的子小部件并通过这些引用设置它们的属性。

```
<td align="center" valign="top">
  <button 
     id="LoginButton"  type="submit" 
     dojoType="dijit.form.Button"
     dojoAttachPoint="submitButtonNode">
        Ok
   </button>
</td> 
```

创建一个文件夹，使其成为 dijit/dojox/dojo 文件夹的“兄弟”，将其称为“app”。并在小部件声明之后，放入一个名为 app/widget/MyWidget.js 的文件；

```
define([
    "dojo/_base/declare",
"dijit/_Widget",
"dijit/_TemplatedMixin",
"dijit/_WidgetsInTemplateMixin",
"dojo/text!app/views/Login/Login.html",
"dijit/Dialog",
"dijit/form/Button",
"dijit/form/TextBox"

], function(
    declare,
 _Widget,
_TemplatedMixin, 
_WidgetsInTemplateMixin,
template,
Dialog

){
    return declare("app.widget.MyWidget", [_Widget, _TemplatedMixin, _WidgetsInTemplateMixin, Dialog], {

        templateString: template
        postCreate: function() {
           this.inherited(arguments);
           // make reference to widget from the node attachment
           this.submitButton = dijit.getEnclosingWidget(dojo.query(".dijitButton")[0], this.domNode);
                 // or simply dijit.byId('LoginButton');
           // override its onSubmit
           this.submitButton.onClick = function(){
             alert("username :" + dom.byId("userId").value() 
                 + "  Password: " + dom.byId("password").value());
           };
        },
        // and a sample on how to implement widget-in-template stateful get/setter pattern
        // e.g. if submitbutton label should change on some event, call as such:
        // dijit.byId('loginForm').set("submitLabel", "Sendin login, please wait");
        _setSubmitLabelAttr : function(value) {
            return this.submitButton.set("label", value);
        },
        _getSubmitLabelAttr : function() {
            return this.submitButton.get("label");
        }
    });
}); 
```

一旦文件到位，请像这样编写您的 html：

```
<head>
   <script src=...dojo...></script>
   <script>
      dojo.require([ 
        "dojo/parser", 
        "app/widget/MyWidget",
        "dojo/domReady!" ] , function(parser) {

          parser.parse();

      });
   </script>
</head>
<body>
   <form dojoType="app.widget.MyWidget"></div>
</body> 
```

这将执行以下操作：

*   加载 dojotoolkit (dojo/dojo.js)
*   创建一个名为“app”的命名空间，它有一个子空间“widget”
*   渲染主体（简单的表单 dom 节点）
*   调用脚本ondomready，需要`app.widget.MyWidget`
*   MyWidget 需要依赖项
*   parser.parse 实例化`<form dojoType="mywidget">`

# javascript - 内部 HTML if 语句无法识别 div 标签

> ID：10984856
> 
> 赞同：0
> 
> 时间：2012-06-11T17:35:42.773
> 
> 标签：javascript, html, onclick, image, innerhtml

我在 IE、Chrome 和 Firefox 中测试了以下代码，但在其中任何一个中都不起作用。我已经阅读了几个关于类似问题的问题，但他们没有提供解决我的例子的解决方案。

我正在尝试创建一个与 JWplayer 交互的暂停/播放按钮（我也希望它与 flowplayer 交互，一旦我让按钮工作）并且图像将根据当前存在的图像而改变。我还有一个停止按钮，可以完全停止播放器并将暂停/播放按钮的图像更改为暂停。

这是我当前的代码：

```
<script type="text/javascript">
function changeimg()
{
  var obj = document.getElementById('image1');
  var imgtag1 = '<img src=\'PLAY.png\'>';
  var imgtag2 = '<img src=\'PAUSE.png\'>';
  if(obj.innerHTML == imgtag2)
  {obj.innerHTML = imgtag1;}
  else
  {obj.innerHTML = imgtag2;}
  return;
}

function playimg()
{
  document.getElementById('image1').innerHTML = '<img src=\'PLAY.png\'>';
  return;
}

</script>

<div id="image1" href="#" onclick="changeimg(); jwplayer('mediaspace1').play(); jwplayer('mediaspace2').play(); jwplayer('mediaspace3').play(); jwplayer('mediaspace4').play();"><img src='PLAY.png'></div>
<div href="#" onclick="playimg(); jwplayer('mediaspace1').stop(); jwplayer('mediaspace2').stop(); jwplayer('mediaspace3').stop(); jwplayer('mediaspace4').stop();"><img src='STOP.png'></div> 
```

播放/暂停功能有效，第一个 div 将变为暂停 img（因此 javascript 正在运行），如果我点击第二个 div（停止功能 - 触发 playimg() ），它将重新开始播放，但它如果我再次单击暂停按钮，将不会变回播放图像。

出于安全原因，我无法链接该网站，但我们将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:43:18.397

看起来您真正想要更改的只是 IMG 标记的 SRC，而不一定是整个 innerHTML。正如 machineghost 在他的评论中提到的那样，可能会添加空格或对完整 HTML 进行其他更改，这可能会使您的比较结果为假。

但是，您可以检查是否 obj.src == "PLAY.png" 并直接设置 SRC 属性。像这样的东西：

```
function changeimg()
{
  var obj = document.getElementById('image1');
  var img1 = 'PLAY.png';
  var img2 = 'PAUSE.png';
  if(obj.src == img2)
  {obj.src = img1;}
  else
  {obj.src = img2;}
  return;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:43:51.557

我认为您要替换的 innerhtml`changeimg()`正在影响整个 obj 元素，这是一个 div。因此，`if(obj.innerHTML == imgtag2)`将返回，`false`因为 div innerhtml 不是 imgtag2，但是下次您要调用`changeimg()`时，“obj”将是未定义的，因为您将其 innerhtml 替换为没有 id 的 HTML 代码：`{obj.innerHTML = imgtag2;}`

检查控制台以查看是否有任何 javascript 错误，它应该在`if(obj.innerHTML == imgtag2)`

rgds。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:47:50.553

只需检查是否`PLAY`存在，然后根据它更改innerHTML

```
function changeimg()
{
    var obj = document.getElementById('image1');
    var imgtag1 = '<img src=\'PLAY.png\'>';
    var imgtag2 = '<img src=\'PAUSE.png\'>';
    if(obj.innerHTML.indexOf('PLAY') != -1)
    {obj.innerHTML = imgtag2;}
    else
    {obj.innerHTML = imgtag1;}
    return;
} 
```

# testing - 在测试环境（Mac OS X）中模拟较差的带宽？

> ID：10984859
> 
> 赞同：9
> 
> 时间：2012-06-11T17:35:58.130
> 
> 标签：testing, nginx, video-streaming, buffering

我们有一个定制的 Flash/HTML5 视频播放器，供我们网站上的用户使用。我目前正在充实带宽“次优”的用户的体验——基本上我们希望客户端代码能够检测到由于过度缓冲而导致的糟糕用户体验。我想在我的本地开发环境中测试这个“低带宽”处理代码。

有没有人知道在本地环境中*模拟*“低带宽”以进行测试的好技术？

更具体地说，我的本地浏览器连接到具有 uWSGI、nginx 和 python/django 实例的虚拟机，并且我希望能够在这些系统的内容交付中注入任意数量的延迟。（我主要关心用 nginx 来做这件事，它负责视频内容交付/流）。

编辑：开发环境是 Mac OS X 可能是相关的。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-11T19:20:11.537

**只需使用 nginx 的配置即可。**

虽然 OS X Lion 的网络链接调节器按预期工作，但当我真的只是想测试 Web 应用程序行为的一个子集时（即慢速视频缓冲处理系统），使用它仍然*很烦人。*

因此，我发现在我的`nginx.conf`文件中设置速率限制要方便得多，例如：

```
location ~ /files/(.*\.(mp4|m4v|mov))$ {
    ...
    limit_rate 50k;  #  <-- Limit download rate per connection to 50kbps
    ...
} 
```

编辑：请参阅[nginx HttpCoreModule 文档](http://wiki.nginx.org/HttpCoreModule#limit_rate)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-13T02:53:50.853

FreeBSD 是 Mac OS 的祖先，因此您可以使用内置强大的防火墙，称为**ipfw**。它可以用于许多不同的情况，例如模拟低带宽。使用您自己的 IP 地址环回 (127.0.0.1) 或远程服务器（在这种情况下为 8.8.8.8）。

我们做了一个视频采访网络应用程序，所以我想分享一下我们模拟坏连接的经验，见下面的例子：

```
$ sudo su

$ ipfw show
$ ipfw pipe 1 config delay 600ms bw 256kbit/s
$ ipfw add pipe 1 dst-ip 8.8.8.8 dst-port 80

$ ipfw flush 
```

**ipfw** pipe 允许您使用*delay*、*bw*甚至*prob*来模拟缓慢和不稳定的连接来模拟数据包丢失。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-11T17:54:21.637

我刚刚找到了 Mac OS X [Network Link Conditioner](http://mattgemmell.com/2011/07/25/network-link-conditioner-in-lion/)，但我还不确定它是否可以正常工作`loopback`，这对于我的目的来说是必需的。

编辑：这似乎适用于环回，所以它似乎解决了我的问题！如果您在 OS X 10.7 上，这可能是要走的路

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T17:51:20.693

我正在使用这个程序[NetLimiter](http://www.netlimiter.com/download.php)来模拟“带宽不足”。它不是免费的，但有一个运行良好的试用版。仅适用于 Windows :(

# ruby-on-rails - Rails routes.rb 中资源的正确顺序

> ID：10984861
> 
> 赞同：0
> 
> 时间：2012-06-11T17:36:07.187
> 
> 标签：ruby-on-rails, routes

由于我的 routes.rb 文件的组织方式，我不断收到奇怪的错误。最新的一个是某些功能在模型关系控制器中找不到动作“显示”（动作显然在那里）。我想这是因为我正在通过集合添加一些自定义操作，并且有关声明路由的顺序的一些东西搞砸了。有人可以看看这个并说出什么问题吗？

```
YApp::Application.routes.draw do

  require 'resque/server'

  match 'login' => 'user_sessions#new', :as => :login
  match 'logout' => 'user_sessions#destroy', :as => :logout
  match '/get_idx',  :to => 'nodes#get_idx'

  resource :relations do
    collection do
      post 'this_relation'
      post "iframize"
    end
  end

  resource :words do
  get 'page/:page', :action => :index, :on => :collection
    collection do
      get 'front'
      get 'index'
    end
  end

    resource :recommendations do
      collection do
        get 'find_votes'
      end
    end

  get "connotation/create"

  get "connotation/edit"

  get "connotation/update"

  root :to => "words#front", :as => :homepage

  resources :users, :user_sessions, :relations,  :evaluation, :phrases, :metawords, :nodes, :recommendations, :words

  mount Resque::Server.new, :at => "/resque"
  match 'about' => 'words#index' , :as => :about
  match 'contact' => 'keywords#index' , :as => :contact

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T19:53:03.950

您可能对`resource :relations`. 经验法则是：如果使用复数`resources`，则资源名称也必须是复数（即`:relations`），如果`resource`使用单数，则资源名称也应使用单数（即`:relation`）。

其他可能的问题：您的缩进已关闭。也许这只是一个复制粘贴问题，但还是要检查一下，因为你可能会遇到一些意想不到的嵌套。

还要检查`rake routes CONTROLLER=relations`。将其与失败请求的日志进行比较，看看每个参数是否匹配。

# php - Cronjob 问题。不识别变量

> ID：10984868
> 
> 赞同：1
> 
> 时间：2012-06-11T17:36:29.267
> 
> 标签：php, cron, crontab, cpanel

作品：

```
php -q /home/site/public_html/cron/file.php 
```

不起作用：

```
php -q /home/site/public_html/cron/file.php?variable=1 
```

有什么建议么？我需要将变量作为 $_GET 发送（或不发送）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:38:32.910

命令行参数被传入[`$argv`](http://php.net/manual/en/reserved.variables.argv.php)而不是普通的`$_GET`/ `$_POST`-Arrays

当然，这不适用于 URI 样式参数（该`?variable=1`部分）。所以你必须这样称呼它：`php -q /path/to/script.php 1`.

作为替代方案，您可以使用[`getopt`](http://www.php.net/manual/en/function.getopt.php)：

```
<?php
$shortopts  = implode("", array(
    "v:"
));

$longopts  = array(
    "variable:",     // Required value
);

$options = getopt($shortopts, $longopts);
var_dump($options); 
```

并称其为`php -q /path/to/script.php --variable=1`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:54:49.623

做这样的事情

```
curl http://hostname/cron/file.php?variable=1 
```

在 file.php 中，您将管理代码以获取 $_GET[variable]

这将表现为一个简单的浏览器调用，但仅在您的外壳/终端中

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:52:47.370

解决这个问题的最简单方法（假设 public_html 是公共 WWW）是让 cron 调用 wget 或 curl 来访问 PHP 文件，因此 URL 变量会正常处理。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-11T17:50:47.510

-q 表示没有头，所以我假设的 get-fields 没有空间，至少我希望如此：D

格雷茨

# c# - 错误：C# XML 序列化/反序列化

> ID：10984869
> 
> 赞同：-2
> 
> 时间：2012-06-11T17:36:32.450
> 
> 标签：c#, serialization, deserialization

这是实际的代码，不是完整的代码，而是它的主要部分。基本上这里我在写一个插件，它实现了一些接口，我需要存储插件的状态，因为它在整个过程中运行了多次。但是通过 xml 存储状态会产生错误

```
using System; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T17:39:23.243

你的代码不会编译。使用`state`您创建的实例，而不是尝试设置非静态字段。还要确保通过将 IDisposable 资源包装在`using`语句中来正确处理它们：

```
using System.IO;
using System.Xml.Serialization;

namespace Plugin
{
    public class state
    {
        public int a;
        public int b;
    }
    public class xyz
    {
        public static void Main()
        {
            state s = new state();
            s.a = 3;
            s.b = 5;
            XmlSerializer x = new XmlSerializer(s.GetType());
            using (StreamWriter sw = new StreamWriter(@"E:\state\state.xml"))
            {
                x.Serialize(sw, s);
            }
        }
    }
} 
```

生成以下 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<state xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <a>3</a>
  <b>5</b>
</state> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:46:25.010

序列化字段也不是一个好主意，您应该使用属性

```
public class state
{
    public int A { get; set; }
    public int B { get; set; }
}

state s = new state() { A = 3, B = 6 };

XmlSerializer x = new XmlSerializer(s.GetType());
using (StreamWriter sw = new StreamWriter(@"E:\state\state.xml"))
{
   x.Serialize(sw, s);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:43:01.950

您的代码不会编译，因为您使用的是类（状态）的名称而不是变量（s）。

以下代码工作并使用*using*来确保即使发生异常也将关闭流：

```
 var s = new state {a = 3, b = 5};

        var x = new XmlSerializer(typeof(state));
        using(var sw = new StreamWriter(@"E:\state\state.xml"))
            x.Serialize(sw, s); 
```

# javascript - 如何使用 HTML5 代码标签美化代码

> ID：10984870
> 
> 赞同：3
> 
> 时间：2012-06-11T17:36:43.507
> 
> 标签：javascript, html, syntax-highlighting

有没有人有关于如何使用 HTML5`code`标签来显示 HTML 代码的示例？

我试图这样做，但失败了。

之后，我尝试使用[highlight.js](http://softwaremaniacs.org/soft/highlight/en/description/)但仍然没有运气。

有什么建议么？

[演示](http://dmsl.github.com/smartbib/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-11T17:42:32.170

HTML`code`标签与美化无关。它只是将其内容指示为计算机代码，并且默认情况下它会使其以等宽字体呈现。就这样。

为了获得美化方面的帮助，我建议您打开一个新问题并发布您迄今为止的最大努力（不是指向一般资源的链接，而是指向您实际尝试过的代码）并解释您希望实现的目标。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-11T17:44:04.367

您需要将`<`标签替换为`&lt;`和。只有将这些字符转义才能看到html代码`>``&gt;`

# ruby - Rally：如何通过 Web 服务 API 访问自定义创建的字段

> ID：10984871
> 
> 赞同：0
> 
> 时间：2012-06-11T17:36:51.473
> 
> 标签：ruby, rally

我已经阅读了位于[http://developer.rallydev.com/help/的 Web 服务站点](http://developer.rallydev.com/help/)

我遇到的基本问题是我正在尝试从 Ruby 脚本更新 Rally 中自定义创建的字段，但我不知道要使用的格式。拉力赛开发人员说这是可能的，并指示我在这里发帖，因为他们不支持用户使用这些东西。

我想知道是否有其他人能够做到这一点。我可以得到这个缺陷，但调试信息没有给我任何关于这些自定义字段可能潜伏在哪里的线索。提前感谢您的帮助，如果您需要任何其他信息，请告诉我。我现在的简单代码是这样的：

```
#!/usr/bin/ruby
require 'rubygems'
require 'rally_rest_api'

defect = "DE677"
logger = Logger.new("debug-rally.txt")
logger.level = Logger::DEBUG

rally = RallyRestAPI.new(:username => "hidden",
                     :password => "hidden",
                     :logger   => logger,
                     :version  => 1.34)
result = rally.find(:defect) { equal :formattedid, defect }

if result.page_length == 0
  puts "The defect "+defect+" was not found"
elsif result.page_length == 1
  puts "Found it"
  res_array = result.results
  thedefect = res_array.at(0)
  puts thedefect.state
  puts thedefect.requirement.defects
else
  puts "Returned more than one result"
  puts result.page_length
  res_array = result.results
  for i in res_array
    puts i
  end
end 
```

编辑：它实际上正盯着我的脸。当我再次检查调试日志时，它们在 xml 中。例如，在 UI 中有一个名为 fu 的自定义字段，在生成的 xml 中它以 bar 的形式出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:46:46.217

创建时有一个显示名称和一个名称属性。在您的示例中，我的猜测是 fu 是您的显示名称，而 bar 是名称。

![在此处输入图像描述](../Images/10f341851e9b796178e7017140b244e6.png)

# php - 在 joomla 模块中添加 JavaScript 文件？

> ID：10984872
> 
> 赞同：0
> 
> 时间：2012-06-11T17:37:01.137
> 
> 标签：php, javascript, joomla

如何在我的 joomla 模块中添加 .js 文件？

目录结构是这样的：

' "模块名"/site/js/thefileIneed.js '

我尝试了以下方法，但这不起作用。

```
$document = &JFactory::getDocument();
$document->addScript(dirname(__FILE__). '/site/js/mainscript.js' ); 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:43:23.117

如果在我们的一个工作模块中找到这个工作示例：

```
$document->addScript(JURI::Root(true)."/modules/mod_ourmodule/charts.js"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T18:05:21.030

你可以沿着

```
$document->addScript('modules/mod_demo/js/jquery-1.7.2.min.js'); 
```

例如（这就是我在我的模块中的做法）并且我还没有发现这是一个问题，即使 joomla 位于子域中

# actionscript-3 - 如何判断一个 MovieClip 在时间轴上跨越多少帧

> ID：10984875
> 
> 赞同：0
> 
> 时间：2012-06-11T17:37:14.383
> 
> 标签：actionscript-3, flash

我们有一个我们喜欢使用的效果，我们将一系列幻灯片与声音同步。随着声音的播放，我们显示每张幻灯片（在影片剪辑中它是它自己的帧），然后慢慢地放大幻灯片以提供一点移动。我们的声音往往相当于父时间轴上的一帧，因此我们查看该帧正在播放什么声音，以计算每张幻灯片应显示多长时间。

我们遇到的问题是，有时我们需要在两张或多张幻灯片上“拉伸”其中一个动画，这意味着我们需要向前看并根据帧跨度期间声音的组合长度计算幻灯片长度，其中显示包含幻灯片图像的 MovieClip。

但是，我无法找到一个属性来告诉我一个 MovieClip 显示了多少时间轴帧（请注意，这将不同于总帧数，即剪辑*包含*的帧数）。存在这样的财产只是一厢情愿，还是有人可以指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:45:15.343

我不确定我是否正确理解了这个问题，但您尝试过 MovieClip.currentFrame 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T03:31:03.260

你能创建一个这样的类，它会跟踪它在 DisplayList 上出现的帧数：

```
package
{

    import flash.display.MovieClip;
    import flash.events.Event;

    public class ExtMovieClip extends MovieClip
    {

        // Properties.
        private var _lifetime:int = 0;

        // Constructor.
        public function ExtMovieClip()
        {
            addEventListener(Event.ADDED_TO_STAGE, _added);
        }

        // Was added to the DisplayList.
        private function _added(e:Event):void
        {
            removeEventListener(Event.ADDED_TO_STAGE, _added);

            addEventListener(Event.ENTER_FRAME, _track);
            addEventListener(Event.REMOVED_FROM_STAGE, _removed);
        }

        // Was removed from the DisplayList.
        private function _removed(e:Event):void
        {
            removeEventListener(Event.REMOVED_FROM_STAGE, _removed);
            removeEventListener(Event.ENTER_FRAME, _track);

            addEventListener(Event.ADDED_TO_STAGE, _added);
        }

        // Increment the lifetime of this MovieClip.
        public function _track(e:Event):void
        {
            _lifetime ++;
        }

        // Retunrns the lifetime of this MovieClip.
        public function get lifetime():int
        {
            return _lifetime;
        }

    }
} 
```

# ios - dispatch_get_global_queue 和 dispatch_queue_create 有什么区别？

> ID：10984885
> 
> 赞同：42
> 
> 时间：2012-06-11T17:38:14.397
> 
> 标签：ios, objective-c, multithreading, grand-central-dispatch

我正在编写一个中等复杂的 iOS 程序，它的一些较长的操作（解析、网络连接等）需要多个线程。但是，我对 和 之间的区别感到`dispatch_get_global_queue`困惑`dispatch_queue_create`。

我应该使用哪一个，你能给我一个简单的解释，说明一般有什么区别吗？谢谢。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-06-11T18:38:28.700

如[文档](https://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW5)所述，全局队列适用于并发任务（即，您将异步调度各种任务，如果它们同时运行，您将非常高兴）并且如果您不想遇到创建和破坏你自己的队列。

如果您需要一个串行队列（即您需要一次执行一个已调度的块），则创建您自己的队列非常有用。这在许多情况下都很有用，例如当每个任务都依赖于前一个任务或协调与来自多个线程的某些共享资源的交互时。

[不太常见，但如果您需要将屏障](http://developer.apple.com/library/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/doc/uid/TP40008079-CH2-SW67)与并发队列结合使用，您还需要创建自己的队列。在这种情况下，创建一个并发队列（即`dispatch_queue_create`使用`DISPATCH_QUEUE_CONCURRENT`选项）并将屏障与该队列一起使用。你永远不应该在全局队列上使用屏障。

我的一般建议是，如果您需要串行队列（或需要使用屏障），请创建一个队列。如果您不这样做，请继续使用全局队列并绕过创建自己的队列的开销。

* * *

如果你想要一个并发队列，但又想控制可以同时运行多少个操作，你也可以考虑使用[`NSOperationQueue`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/NSOperationQueue_class/Reference/Reference.html)which has a `maxConcurrentOperationCount`property。这在进行网络操作并且您不希望向服务器提交太多并发请求时很有用。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-12-16T07:21:05.227

刚刚发布了一个不同的答案，但这是我很久以前写的：

将队列概念化的最好方法是首先意识到在非常低的级别上，只有两种类型的队列：串行和并发。

**串行队列**是一夫一妻制的，但未提交。如果你给每个串行队列分配一堆任务，它会一次运行一个，一次只使用一个线程。未提交的方面是串行队列可能会在任务*之间切换到不同的线程。*串行队列总是在执行下一个任务之前等待一个任务完成。因此，任务按 FIFO 顺序完成。您可以使用`dispatch_queue_create`.

主**队列**是一个特殊的串行队列。与其他未提交的串行队列不同，它们与许多线程“约会”，但一次只与一个线程“约会”，主队列与主线程“结婚”，所有任务都在其上执行。主队列上的作业需要在运行循环中表现良好，这样小操作就不会阻塞 UI 和其他重要位。像所有串行队列一样，任务按 FIFO 顺序完成。

如果串行队列是一夫一妻制的，那么**并发队列**是混杂的。他们会将任务提交到任何可用的线程，甚至根据系统负载创建新线程。他们可以在不同的线程上同时执行多个任务。重要的是提交到全局队列的任务是线程安全的并尽量减少副作用。任务按 FIFO 顺序提交执行，但不保证完成顺序。在撰写本文时，只有三个并发队列，您无法创建它们，您只能使用`dispatch_get_global_queue`.

编辑：博客文章扩展了这个答案：[http ://amattn.com/p/grand_central_dispatch_gcd_summary_syntax_best_practices.html](http://amattn.com/p/grand_central_dispatch_gcd_summary_syntax_best_practices.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T18:07:21.570

一个返回现有的全局队列，另一个创建一个新的。我会考虑使用 NSOperation 和操作队列，而不是使用 GCD。[您可以在本指南](https://developer.apple.com/library/mac/ipad/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008091)中找到有关它的更多信息。通常，您希望操作同时执行，您希望创建自己的队列并将操作放入其中。

# java - Java EE / Struts 持久会话

> ID：10984886
> 
> 赞同：0
> 
> 时间：2012-06-11T17:38:15.723
> 
> 标签：java, jakarta-ee, glassfish

我正在做我的第一个 Java EE Web 应用程序，但我正在努力解决会话问题。

在我的 web.xml 文件中，我放置了以下设置：

```
<session-config>
  <session-timeout>30</session-timeout>
</session-config> 
```

但是，如果我关闭未配置为在关闭时删除 cookie 的浏览器，则在重新打开后会话结束。

我怎样才能有一个“持久”的会话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T19:28:03.640

当 cookie 的过期时间设置为“会话”时，当用户关闭浏览器时，它会被浏览器删除。这与 web.xml`session-timeout`设置无关，如果在指定的时间跨度内没有用户请求，它将强制关闭 Java EE 会话服务器端。

Spring 具有“记住我”的功能：

[http://static.springsource.org/spring-security/site/docs/3.0.x/reference/remember-me.html](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/remember-me.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:41:22.960

检查是否在您的第一个请求期间创建了名为 Jsessionid 的 cookie。并关闭浏览器再次打开它并检查该 cookie 是否仍然存在并且值是否相同。

我认为不会，这就是您的会话到期的原因。

# c# - C#中的静态/单例接口实现类

> ID：10984889
> 
> 赞同：0
> 
> 时间：2012-06-11T17:38:26.080
> 
> 标签：c#, singleton, static-class

我有一个（*现在*）是静态的类：

```
public static class Grob
{
    public static void Frob()
    {
        Foo.Bar();
    }
} 
```

这很好用。代码调用：

```
Grob.Frob(); 
```

世界上一切都很好。现在我希望我的类实现一个接口：

```
public static class Grob : IOldNewGrob
{
    public static void Frob()
    {
       Foo.Bar();
    }
} 
```

不幸的是，这不起作用，因为[原因](https://stackoverflow.com/questions/259026/why-doesnt-c-sharp-allow-static-methods-to-implement-an-interface/7945206)。

所以我会尝试将班级改为[*单身人士*](http://msdn.microsoft.com/en-us/library/ff650316.aspx)：

```
public sealed class Grob
{
   private static volatile Singleton instance;
   private static object syncRoot = new Object();

   private Grob() {}

   public static Singleton Instance
   {
      get 
      { 
         if (instance == null) 
         {
            lock (syncRoot) 
            {
               if (instance == null) 
                  instance = new Singleton();
            }
         }
         return instance;
     }
   }       
} 
```

哪个工作得很好，除了它不起作用 - 代码不再编译：

```
Grob.Frob(); 
```

在其他语言中，这不是问题。我会创建一个全局`Grob`函数（调用`Grob`是因为这是现有代码需要的名称）：

```
function Grob(): GrobSingleton;
{
   return Grob.Instance;
}

//and rename Grob class to something else
public sealed class GrobSinglton
{
   ...
} 
```

除了 C# 没有全局函数。

到底：

*   我**不需要**全局函数
*   我**不需要**静态类来实现接口
*   我**不需要**单身人士

我只是希望一切正常。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-11T17:41:33.200

为什么不创建一个*也*有静态`Frob`方法的单例呢？

```
public sealed class Grob : IOldNewGrob
{
    private static readonly Grob instance = new Grob();

    public static Grob Instance { get { return instance; } }

    // Prevent external instantiation
    private Grob() {}

    public static void Frob()
    {
        Foo.Bar();
    }

    // Implement IOldNewGrob here
} 
```

您可能还应该阅读我[关于在 .NET 中实现单例模式的文章](http://csharpindepth.com/Articles/General/Singleton.aspx)——实际上没有必要实现脆弱的双重检查锁定模式。

这满足了您对`Grob.Frob()`工作和`Grob`实现接口的要求。不过，尚不清楚这些是否是您*唯一*的要求-您还没有真正解释*为什么*要尝试这样做-单例或接口的来源。

编辑：如果这个想法是`Frob`的成员`IOldNewGrob`，您可以像这样使用显式接口实现：

```
public sealed class Grob : IOldNewGrob
{
    private static readonly Grob instance = new Grob();

    public static Grob Instance { get { return instance; } }

    // Prevent external instantiation
    private Grob() {}

    public static void Frob()
    {
        // Implementation
    }

    // Explicit interface implementation to prevent name collisions
    void IOldNewGrob.Frob()
    {
        // Call the static implementation
        Frob();
    }
} 
```

# ruby-on-rails - 如何对通过复选框选择的数组中的项目进行排序？

> ID：10984890
> 
> 赞同：0
> 
> 时间：2012-06-11T17:38:32.037
> 
> 标签：ruby-on-rails, ruby

我想对以前用复选框选择的项目进行排序。如果我通过单击复选框来选择电影评级，它会返回适用的电影。

URL 的结尾如下所示：

```
?ratings[PG-13]=1&ratings[G]=1 
```

如果我单击订购电影的链接，它将获取整个电影列表，而不是我刚刚定位的电影。那么，如何“附加”`"sort=title"`到 URL 中的评级？

我有一种感觉，这是我可以在视图中做的事情。我的 link_to 是这样的：

```
%th#title_header{:class=>("hilite" if @sort == "title")}= link_to "Movie Title", :sort =>   "title" 
```

我`check_box_tag`的是这样的：

```
= check_box_tag "ratings[#{rating}]",rating,@all.include?(rating) 
```

在我的控制器中，我有这个：

```
def index

@movies = Movie.order(params[:sort])
@movies = @movies.where(:rating => params[:ratings].keys) if params[:ratings].present?
@sort = params[:sort]
@all = (params[:ratings].present? ? params[:ratings] : [])

end 
```

（我知道，我的“where”查询容易受到 SQL 注入的影响，它是暂时的，我只是想将整个事情概念化。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T01:00:18.337

您需要在 link_to 的末尾传递一个额外的哈希，它将查询链接到 url：

```
link_to "Movie Title", movies_path(:sort => "title", :ratings => params[:ratings]) 
```

杰出的！

# ios - 使用 AVCaptureSession 时出现内存警告

> ID：10984896
> 
> 赞同：0
> 
> 时间：2012-06-11T17:38:52.540
> 
> 标签：ios, xcode, avcapturesession

我使用默认的 AVCaptureSession 来捕获相机视图。一切正常。但它会运行几秒钟并在调试器中记录消息内存警告并继续工作几秒钟，然后应用程序终止。这可能是我实现的代码中的内存泄漏。但我不知道为什么会发生这种情况，除此之外，我在行中收到警告（将“ViewController *const_strong'发送到不兼容类型'id'的参数

```
[outputsetSampleBufferDelegate:selfqueue:queue]; 
```

..................................................... .......我实现的代码，

```
-(void)setupCaptureSession
{
NSError *error=nil;
AVCaptureSession *session =[[AVCaptureSessionalloc]init];
self.captureSession=session;

self.captureSession.sessionPreset=AVCaptureSessionPresetMedium;

AVCaptureDevice *device =[AVCaptureDevicedefaultDeviceWithMediaType:AVMediaTypeVideo];

AVCaptureDeviceInput *Input=[AVCaptureDeviceInputdeviceInputWithDevice:deviceerror:&error];
if(!Input){
    }

    [[selfcaptureSession] addInput:Input];
AVCaptureVideoDataOutput *output =[[AVCaptureVideoDataOutputalloc]init];

    [[selfcaptureSession]addOutput:output];
dispatch_queue_t queue =dispatch_queue_create("myQueue", NULL);
    [outputsetSampleBufferDelegate:selfqueue:queue];
dispatch_release(queue);

output.videoSettings =[NSDictionarydictionaryWithObjectsAndKeys:[NSNumbernumberWithUnsignedInt:kCVPixelFormatType_32BGRA],(id)kCVPixelBufferPixelFormatTypeKey,nil];

AVCaptureConnection *connection =[output connectionWithMediaType:AVMediaTypeVideo];
    [connectionsetVideoMinFrameDuration:CMTimeMake(1,15)];

[sessionstartRunning];

    [selfsetSession:session];

}

-(UIImage *)imageFromSampleBuffer:(CMSampleBufferRef)sampleBuffer
{
CVImageBufferRefimageBuffer =CMSampleBufferGetImageBuffer(sampleBuffer);
CVPixelBufferLockBaseAddress(imageBuffer,0);

void *baseAddress =CVPixelBufferGetBaseAddress(imageBuffer);

size_tbytesPerRow =CVPixelBufferGetBytesPerRow(imageBuffer);
size_t width =CVPixelBufferGetWidth(imageBuffer);
size_t height=CVPixelBufferGetHeight(imageBuffer);

CGColorSpaceRefcolorSpace =CGColorSpaceCreateDeviceRGB();
CGContextRef context = CGBitmapContextCreate(baseAddress,width,height,8,bytesPerRow,colorSpace,kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedLast);

CGImageRefquartzImage =CGBitmapContextCreateImage(context);
CVPixelBufferUnlockBaseAddress(imageBuffer,0);

CGContextRelease(context);
CGColorSpaceRelease(colorSpace);

UIImage *image =[UIImageimageWithCGImage:quartzImage];
CGImageRelease(quartzImage);

return image;
}
////////////////////

-(void)captureOutput:(AVCaptureOutput *)captureOutput
didOutputSampleBuffer:(CMSampleBufferRef)sampleBufferfromConnection:(AVCaptureConnection *)connection{

UIImage *image = [selfimageFromSampleBuffer:sampleBuffer];
//Here i do my processing with image and display a count, Counter updates for few seconds and
  Log memory warning and then works again, Then application get terminates

}
-(void)setSession:(AVCaptureSession *)session
{
self.captureSession=session;
} 
```

# css - 将所有边距/填充设置为 0，我仍然遇到 CSS 布局问题

> ID：10984897
> 
> 赞同：0
> 
> 时间：2012-06-11T17:39:06.403
> 
> 标签：css

这里的 CSS 初学者，我对一个相对简单的 css 布局束手无策，希望有人能帮我看看它..

我有什么：![在此处输入图像描述](../Images/d2e2803d0d26c0fb44309729cdf5df85.png)

CSS 暂时嵌入，请原谅缩进（我刚从编程中来，缩进帮助我理解它）：

```
<!DOCTYPE HTML>
<html lang="en">

<style>

* {margin: 0; padding:0;}
body
{
    font: normal 100% Helvetica, Arial, sans-serif;
    background-color: LightSkyBlue;
    margin: auto auto;
    max-width: 90%; 
}

#central_container
{
    background-color: Yellow;
    width: 100%;
    margin: auto auto;
    float: left;
}
#leftside_container
{
    background-color: Ivory;
    float: left;
    width: 66%; 
    clear: left;
}
    #header_container
    {
    background-color: DeepSkyBlue;
    width: 100%;
    height: 15em;
    }
        #header_title
        {
            background-color: Lime;
            width: 100%;
            height: 80%;
        }
            #header_title h1{ padding: 0; margin: 0; }

        #navbar_container
        {
            background-color: Coral;
            width: 100%;
            height: 20%;
        }
            .navbar_links{ background-color: HotPink; }

        #currentpage_content
        {
            background-color: grey;
            width: 100%;
            height: 20%;
        }

#rightside_container
{
    background-color: Khaki;
    float: right;
    width: 33%; <!--/* 320 /960 */-->
}
    #register_container
    {
        background-color: LightPink;
        width: 100%;
    }
    #contacts_content
    {
        background-color: SeaGreen;
        width: 100%;
    }

</style>

<head>
    <title>Verge Green IT</title>
    <link rel="stylesheet" href"CSS/base.css" type="text/css" />
</head>

<body>
<div id="central_container">

    <!--Left-side Current-page Content-->
    <div id="leftside_container">

        <!--Header-->
        <div id="header_container">

            <div id="header_title">
            <h1>#header_title</h1>
            </div>

            <!--Navbar-->
            <div id="navbar_container"> 
            <div class="navbar_links">
            </div>
            </div>

        </div>
        <!--Current Page Contents-->
        <div id="currentpage_content">
            <p> #currentpage_content</p>
            <p>"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p><p>
            "Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p>
        </div>

    </div>

    <!--Right-side Every-page Content-->
    <div id="rightside_container">
        <div id="register_container"><p> #register_container </p></div>
        <div id="contacts_content"><p> #contacts_content</p></div>
    </div>

</div>
</body>

</html> 
```

我的目标是：![在此处输入图像描述](../Images/7d216e9541885a779325e6af38ff69a0.png)

（模糊文本替代：register_container 将 rightside_container 填充到 navbar_container 底部的高度。并且 contact_content 填充 rightside_container 的其余部分，就像 current_page 内容在 leftside_container 上一样。）

我想我遇到了一些麻烦，因为我正在尝试做浮动。我不知道为什么 register_container/contacts_content 左侧有空白的黄色空间。也不是为什么我可以为 header_title 之类的东西指定高度，但不能为 register_container 指定高度。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T18:04:23.230

我认为您在“宽度”和“高度”字段中给出的值存在一些小问题。

这对我来说很好。

```
<!DOCTYPE HTML>
<html lang="en">

<style>

* {margin: 0; padding:0;}
body
{
    font: normal 100% Helvetica, Arial, sans-serif;
    background-color: LightSkyBlue;
    margin: 0 auto;
    max-width: 90%; 
    height: auto;
}

#central_container
{
    background-color: Yellow;
    width: 100%;
    margin: 0 auto;
    height: 100%;
    float: left;
}
#leftside_container
{
    background-color: Ivory;
    float: left;
    width: 66%; 
    clear: left;
}
    #header_container
    {
    background-color: DeepSkyBlue;
    width: 100%;
    height: 15em;
    }
        #header_title
        {
            background-color: Lime;
            width: 100%;
            height: 80%;
        }
            #header_title h1{ padding: 0; margin: 0; }

        #navbar_container
        {
            background-color: Coral;
            width: 100%;
            height: 20%;
        }
            .navbar_links{ background-color: HotPink; }

        #currentpage_content
        {
            background-color: grey;
            width: 100%;
            height: 20%;
        }

#rightside_container
{
    background-color: Khaki;
    float: right;
    width: 34%; <!--/* 320 /960 */-->
}
    #register_container
    {
        background-color: LightPink;
        width: 100%;
    height:240px;
    }
    #contacts_content
    {
        background-color: SeaGreen;
        width: 100%;
height:250px;
    }

</style>

<head>
    <title>Verge Green IT</title>
    <link rel="stylesheet" href"CSS/base.css" type="text/css" />
</head>

<body>
<div id="central_container">

    <!--Left-side Current-page Content-->
    <div id="leftside_container">

        <!--Header-->
        <div id="header_container">

            <div id="header_title">
            <h1>#header_title</h1>
            </div>

            <!--Navbar-->
            <div id="navbar_container"> 
            <div class="navbar_links">
            </div>
            </div>

        </div>
        <!--Current Page Contents-->
        <div id="currentpage_content">
            <p> #currentpage_content</p>
            <p>"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p><p>
            "Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p>
        </div>

    </div>

    <!--Right-side Every-page Content-->
    <div id="rightside_container">
        <div id="register_container"><p> #register_container </p></div>
        <div id="contacts_content"><p> #contacts_content</p></div>
    </div>

</div>
</body>

</html> 
```

# jquery - 通过 jQuery 的 Ajax 自动填充选择字段

> ID：10984901
> 
> 赞同：1
> 
> 时间：2012-06-11T17:39:20.703
> 
> 标签：jquery, asp-classic

我正在使用经典 ASP 进行编码，并使用 ADO 访问我的数据库。我有两个选择字段，即：

```
<select name="NBSCourse" class="NBSCourse"></select>
<select name="IndexNo" class="IndexNo"></select> 
```

对于“NBSCourse”，选项字段通过 SQL 请求填充，列出所有可用课程代码的不同结果。我想根据“NBSCourse”的选定值填充下一个选择字段“IndexNo”。

目前，我尝试了以下方法：将 nbsCourseid 的选定字段传递给 ASP 文件“indexnodrop”

```
$("select.NBSCourse").change(function () {
var nbsCourseid;
nbsCourseid = $("select.NBSCourse").val();

 $.ajax({url:"indexnodropdown.asp?q="+nbsCourseid,success:function(result) { 

    $("select.IndexNo").html(result);

}})

 }) 
```

在 indexnodrop.asp 中，我已将脚本执行到数据库中。

```
dim selectedcourseID
selectedcourseID = Request.querystring("q")

oCmd.CommandText = "SELECT DISTINCT IndexNo FROM NBSCourse WHERE CourseId='" &  selectedcourseID & "'"
Set oRS = oCmd.Execute() 

If Not oRS.EOF Then 
response.write("<option value='" & oRS("IndexNo") & "'>" & oRS("IndexNo") & "</option>")
End If 
```

我在这里缺少什么吗？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:41:51.997

```
$("select[name=NBSCourse]").change(function () {
  var nbsCourseid;
  nbsCourseid = this.value; // or $(this).value();
   $.ajax({url:"indexnodropdown.asp?q="+nbsCourseid,success:function(result) { 
     $("select[name=IndexNo]").html(result);
  }};
}); 
```

你不能使用

`select.NBSCourse`因为`.`符号用于 access `class`，但您使用了`name`属性。

### 根据评论

如果你使用`class`, 而不是`name`then 你可以使用

```
$("select.NBSCourse").change(function () {
  var nbsCourseid;
  nbsCourseid = this.value; // or $(this).value();
   $.ajax({url:"indexnodropdown.asp?q="+nbsCourseid,success:function(result) { 
     $("select.IndexNo").html(result);
  }};
}) 
```

# php - 向用户输入数据添加中断的问题

> ID：10984902
> 
> 赞同：1
> 
> 时间：2012-06-11T17:39:21.130
> 
> 标签：php, html, newline, break, line-breaks

我正在制作一个`textarea`，其值应该插入到数据库中，但用户输入可以包含新行，输出也应该包含新行。

我`nl2br($message)`用来实现这一点，但如果用户输入如下内容：

```
<ul>
<li>hi</li>
<li>nice to meet you</li>
<li>bye</li>
</ul> 
```

它在每个文本之间留出了太多空格，因为`<li>`标签本身也包含某种中断，所以这意味着 2 个中断。

**我的问题是：**如何避免这种情况，或者我可以使用哪些其他功能来保存用户输入的中断？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:49:47.020

如果您使用的是 textarea，最好不要允许插入 html 标签。使用 php strip_tags() 函数在插入数据库之前删除 html 标签。

# windows - 如何唯一标识windows上的进程？

> ID：10984908
> 
> 赞同：4
> 
> 时间：2012-06-11T17:39:48.360
> 
> 标签：windows, process

我们以记事本为例。如何在我的应用程序中 100% 确定记事本是否正在运行？100% 我的意思是，如果有另一个名为“notepad.exe”的进程实际上*不是*真正的记事本而是仿制品，我不想检测它。只有真正的记事本。

我已经考虑过读取进程内存，但由于内存位移等原因，它比看起来要困难得多。

标准方式是按名称，对吗？但对我来说*非常*重要的是，它不是任何其他程序，因为我想与它进行交互，如果我发现一个错误的进程，这将导致严重失败。

有谁知道这样做的好方法？

PS：没有特定的编程语言可以做到这一点。如果可能的话，我更喜欢独立的解决方案。但如果需要，我会专门使用 .Net/C#。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T18:16:13.080

^(确保 99.9% 1)确定您正在查看正确的可执行文件的唯一方法是验证文件的[数字签名](http://msdn.microsoft.com/en-us/library/ms537364%28v=vs.85%29.aspx)。例如，您要确保有问题的 notepad.exe 由“Microsoft Corporation”签名。

我会做这样的事情：

1.  获取正在运行的进程列表。
2.  过滤到感兴趣的名称（*notepad.exe*）
3.  获取每个进程的图像[可执行文件]路径。
4.  验证 Authenticode 签名是否有效且受信任。
5.  将签名者的名称与预期值进行比较。
6.  成功！您可以非常确定这是正确的文件。

这种方法避免了诸如必须提前知道文件的位置（这几乎是不可能的——记事本[安装在两个位置](http://blogs.msdn.com/b/oldnewthing/archive/2006/03/28/563008.aspx#563177)）、它的哈希值应该是什么（显然会改变）或奇怪的用户行为（替换带有其他文本编辑器的记事本）。

^(1 - 当然，不可能 100% 确定。有人*真正*确定可以使用预期的签名者名称对可执行文件进行自签名，并将证书添加到他们机器的根存储区，从而使签名看起来有效。)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T17:51:19.073

好吧，我还没有遇到过这种问题，但是您可以首先通过按名称搜索来检查进程是否正在运行（在您的情况下，这将是 notepad.exe），解析`Process.GetProcesses()`列表，然后获取 `Process.StartInfo.FileName` 和看看这是否是记事本可执行文件的路径，这样就可以了，对吧？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T18:34:07.433

您对我们要运行的可执行文件到底了解多少？如果您知道可以用作“黑客”的文件大小。使用@josh3736 的方法，但是通过将文件大小与您知道的文件大小进行比较来替换第 4 点和第 5 点[不同的版本会有不同的大小，但如果没有太多，您可以对它们进行硬编码]。计算 Md5-Hashtag 看起来更专业，但做的事情基本相同。

** 如果您的进程有 GUI：您可以使用 EnumWindows 让孩子们获得编辑框等。找到适合您的“notepad.exe”的东西并检查它是否存在。

# jquery - 这可能吗？将 ASP.NET 文本框中的某些行设为只读

> ID：10984911
> 
> 赞同：1
> 
> 时间：2012-06-11T17:39:58.447
> 
> 标签：jquery, asp.net, user-controls, textbox, html.textbox

我的页面上有一个文本框来接受用户输入，我希望有几行在文本框中显示为只读作为提示。例如，

```
(read-only) Begin Input Category: User
....
....
....
....
(read-only) End Input Category: User 
```

这甚至可以通过 jQuery 或 CSS 中的一些技巧来实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:41:05.880

不，您不能将文本框的各个行设为只读。

但是，您可以将原始文本的单独副本保存在变量中，并且每次用户在文本框中键入时进行比较，如果他们触摸了只读部分，则将其修复回来，但这很可能容易出错。

更好的选择更像是母版页的工作方式，主模板定义用户可编辑区域，并且您为用户提供输入这些用户定义区域（单独的文本框？XML分隔文本？）的地方，然后您可以渲染合并视图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:55:43.130

我相信不可能。尝试使用只读行放置 2 个标签，与顶部和底部的文本框相邻，边距为 0 ，顶部标签的底部边框 0 ，底部标签的顶部边框 0 ，文本框的顶部和底部边框为零。标签和文本框的长度应该相等。这可能会让人感觉文本框的顶行和底行是只读的。发布表单时使用javascript发布顶部标签+文本框+底部标签的数据组合。

或者您最多可以做的是显示上面的文本，当用户将光标输入文本框时，然后删除文本。再次，当他将光标移出（焦点超出文本框）然后检查文本框是否为空，如果为空则放回该文本。在提交表单时，如果文本不存在，您可以将文本附加并添加回文本框数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T18:07:04.290

如何使用 wartermark 或类似技术使水印保持不变（而不是在文本框处于焦点时消失）但只读？

# javascript - 根据当前的 backgroundPosition 改变 backgroundPosition

> ID：10984919
> 
> 赞同：0
> 
> 时间：2012-06-11T17:40:22.870
> 
> 标签：javascript, function, events, conditional, background-position

上周我有一个关于如何构建这个脚本的非常有用的答案，除了一个小问题外，它的效果很好。用视觉辅助来解释是最简单的[http://avalon.eaw.com/#finishes](http://avalon.eaw.com/#finishes)

这使用 backgroundPosition 属性来设置颜色变化的动画。唯一的问题是“号角”选项是硬编码的，因此如果您当前正在查看具有白色驾驶室和彩色号角的扬声器并且想要将箱体更改为黑色，它也会将号角更改为黑色。目前无法查看带有彩色喇叭的黑色驾驶室。

要修复它，我需要做一个条件语句，但不知道如何使它工作。就像是

```
function colorChange() {
    // Use xposition and yposition which are changed by JS function above
    $("#target").css('background-position', xposition+'px '+yposition+'px');
    if$("#target").css('background-position') == {x:-754}
        updatePositions({x:-377});
    if$("#target").css('background-position') == {x:-377}
        updatePositions({x:-754});
} 
```

***////// 编辑 /////// 版主刚刚删除了我发布的这个问题的后续内容，以便尝试帮助找到答案。感谢版主先生阻止任何可能的帮助！我对这个论坛越来越感到沮丧。无论如何，我已经在下面重新发布它，希望有人可以帮助找到解决方案。***

好吧，我有一个不起作用的答案，但希望它会帮助有人找到一个有效的答案。在对 jquery 速记进行了更多阅读之后，我尝试为橱柜钢琴样本制作一个单独的函数：

```
function colorChangePiano() {
    var bp = $("background-position").css;
    $("#target").css("background-position", (bp = {x:-1131}) ? "{x:-377}" : "{x:0}");
} 
```

我知道语法本身有问题，但更大的问题是它没有被绑定到驱动其余样本的函数中：

```
// variable outside of function() scope
var xposition, 
    yposition;

// Update values of xposition and or yposition
function updatePositions(axes) {
    // Check to see which axis was passed in x, y or both, then update values
    if (typeof(axes.x) !== 'undefined') xposition = axes.x;
    if (typeof(axes.y) !== 'undefined') yposition = axes.y;

    //Call function to actually move BG image
    colorChange();
}

// Function move BG image, using variables declared above
function colorChange() {
    // Use xposition and yposition which are changed by JS function above   
    $("#target").css('background-position', xposition+'px '+yposition+'px');
} 
```

为了通过，这里有几个 html 调用的例子：

```
<a href="#" onclick="updatePositions({x:-1131})"><img src="/images/cabinets/swatches/swatch-siren.jpg" /><p>siren</p></a>
<a href="#machine" onclick="updatePositions({y:-999})"><img src="/images/cabinets/swatches/swatch-machine.jpg" /><p>machine</p>
<a href="#" onclick="updatePositions({x:-754})"><img src="/images/cabinets/swatches/swatch-polar.jpg" /><p>polar</p></a></a>
<a href="#" onclick="updatePositions({x:0})"><img src="/images/cabinets/swatches/swatch-piano.jpg" /><p>piano</p></a> 
```

这个网站今晚必须上线，我开始有点吓坏了。有没有人有任何见识？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T02:49:30.603

感谢我的好（而且非常聪明）的朋友 Eli Huntington 有一个答案——尽管是一个非常复杂的答案。这是工作网站的链接，以及与此问题相关的代码片段。希望它可以帮助其他一些可怜的灵魂。这里有一个相关线程（[jquery background change one axis only](https://stackoverflow.com/q/11006709/1284654)）有一个更简单的相关问题，我希望得到回答。*必须*有一种更简单的方法来做到这一点。

网站：[http ://avalon.eaw.com/](http://avalon.eaw.com/)

脚本：（finishScroll 和 finishScroll2 是与这个特定问题无关的 localScroll 插件函数）

```
// FINISHES SCRIPT //
// Make an object to hold various information about the application
finishes = {

cabinets: { // Columns
    colors: ['polar', 'piano'], // Add new cabinet colors here

    /*
     * New cabinet colors are represented in columns and can be 
     * added to the sprite to the right edge.
     * After adding two new columns  to the Sprite
     * add the following after polar_custom: '-1131px' (don't forget comma):
     * 
     *      anycolor_standard: '-1508px' //(i'm guessing)
     *      anycolor_custom:   '-1885px' //(also guessing)
     * 
     */
    piano_standard  : '0px',   // Column where horn matches grill
    piano_custom    : '-377px', // Column where horn is custom color
    polar_standard  : '-754px',
    polar_custom    : '-1131px'
},
colors: { // Rows
    // New colors can be added to the sprite at the bottom and then added last here with the position (from the sprite)
    siren:      '0px',
    medallion:  '-333px',
    starlight:  '-666px',
    machine:    '-999px'
},
current_cabinet_color: 'piano',  // Will be updated by click events to updateCabinet
current_grille_color: 'siren',  // Will be udpated by click events to updateCabinet
current_horn_color: 'standard'  // Will be udpated by click events to updateCabinet

};

function updateCabinet(component, color) {
if(!component || !color) return false;  // Exit if missing values

// Take component and update the 'finishes' object above based on which part we are changing
switch(component) {
    case 'cabinet':
        finishes.current_cabinet_color = color;
        break;
    case 'horn':
        if(color != 'piano' && color != 'polar') {
            finishes.current_horn_color = 'custom';
        } else {
            finishes.current_horn_color = 'standard';
        }
        break;
    case 'grille':
        finishes.current_grille_color = color;
        break;
    default:
        return false;  // Invalid component name passed in
}

// Now that we have updated the 'finishes' object, we can get our xpos and ypos values from it
xpos = finishes.cabinets[finishes.current_cabinet_color + '_' + finishes.current_horn_color];
ypos = finishes.colors[finishes.current_grille_color];

// Finally make sure we have good values for xpos and ypos and do the CSS udpate
if(xpos && ypos) {
    $('#target').css('background-position', xpos+' '+ypos );
}
return true;
} 
```

HTML：

```
<!-- FINISHES -->
<div id="finishes" class="item"><a name="finishes"></a>
    <div id="swatches" class="content">
        <div class="finishscroll">
            <p class="text">Avalon by EAW represents a radical departure from any dance club loudspeaker ever created, including our own original Avalon Series. Everything about Avalon by EAW breaks new ground. The system design turns the loudspeaker inside-out, mounting the MF/HF horn outside the grille. And the grille - concave and sculpted in clean, straight lines - expresses the symmetry that unifies the design.</p>
            <div id="target"></div>
            <div id="label-cab" class="label">cabinet</div>
            <ul id="swatch-cab" class="swatch">
                <li class="patch"><a href="#piano" onclick="updateCabinet('cabinet','piano')"><img src="/images/cabinets/swatches/swatch-piano.jpg" /><p>piano</p></a></li>
                <li class="patch"><a href="#polar" onclick="updateCabinet('cabinet','polar')"><img src="/images/cabinets/swatches/swatch-polar.jpg" /><p>polar</p></a></li>
            </ul>
            <div id="label-horn" class="label">horn</div>
            <div id="content-finishscroll" class="swatch">
                <div class="scroll-section">
                    <ul>
                        <li id="piano" class="patch">
                            <a href="#" onclick="updateCabinet('horn','piano')"><img src="/images/cabinets/swatches/swatch-piano.jpg" /><p>piano</p></a>
                        </li>
                        <li id="polar" class="patch">
                            <a href="#" onclick="updateCabinet('horn','polar')"><img src="/images/cabinets/swatches/swatch-polar.jpg" /><p>polar</p></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="finishscroll2">
            <div id="label-grille" class="label">grille</div>
            <ul id="swatch-grille" class="swatch">
                <li class="patch"><a href="#siren" onclick="updateCabinet('grille','siren')"><img src="/images/cabinets/swatches/swatch-siren.jpg" /><p>siren</p></a></li>
                <li class="patch"><a href="#medallion" onclick="updateCabinet('grille','medallion')"><img src="/images/cabinets/swatches/swatch-medallion.jpg" /><p>medallion</p></a></li>
                <li class="patch"><a href="#starlight" onclick="updateCabinet('grille','starlight')"><img src="/images/cabinets/swatches/swatch-starlight.jpg" /><p>starlight</p></a></li>
                <li class="patch"><a href="#machine" onclick="updateCabinet('grille','machine')"><img src="/images/cabinets/swatches/swatch-machine.jpg" /><p>machine</p></a></li>
            </ul>
            <div id="content-finishscroll2">
                <div class="swatch" style="width:73px;">
                    <ul>
                        <li id="siren" class="patch">
                        <a href="#" onclick="updateCabinet('horn','siren')"><img src="/images/cabinets/swatches/swatch-siren.jpg" /><p>siren</p></a>
                        </li>
                        <li id="medallion" class="patch">
                        <a href="#" onclick="updateCabinet('horn','medallion')"><img src="/images/cabinets/swatches/swatch-medallion.jpg" /><p>medallion</p></a>
                        </li>
                        <li id="starlight" class="patch">
                        <a href="#" onclick="updateCabinet('horn','starlight')"><img src="/images/cabinets/swatches/swatch-starlight.jpg" /><p>starlight</p></a>
                        </li>
                        <li id="machine" class="patch">
                        <a href="#" onclick="updateCabinet('horn','machine')"><img src="/images/cabinets/swatches/swatch-machine.jpg" /><p>machine</p></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div style="position:absolute; top:450px; left:-60px"><img src="http://avalon.eaw.com/images/shadow-finishes.png" /></div>
    </div>
</div><!-- #finishes --> 
```

快乐编码！

# datagrid - iTextSharp asp：DataGrid 不显示在 PDF 中

> ID：10984921
> 
> 赞同：0
> 
> 时间：2012-06-11T17:40:27.877
> 
> 标签：datagrid, itextsharp

使用 iTextSharp 将生成的 html 页面转换为 pdf，我无法让从 asp:DataGrid 创建的表格显示在 PDF 中。数据网格的页面 HTML 输出如下所示：

```
<p>Purchases:</p>
    <table rules="all" id="dg_Purchase" style="font-size: smaller; border-collapse: collapse;" border="1" cellspacing="0">
    <tbody><tr>
        <td>Lot #</td>
        <td>&nbsp;</td>
        <td>Title</td>
        <td align="right">Price</td>
        <td align="right">Buyer's Premium</td>
        <td align="right">Tax</td>
        <td align="right">Sub Total</td>
    </tr><tr>
        <td>118</td>
        <td><input id="dg_Purchase_ctl02_CheckBox1" name="dg_Purchase$ctl02$CheckBox1" type="checkbox"></td>
        <td>Yih-Wen Kuo (1959, Taiwan)</td>
        <td align="right">$1,900.00</td>
        <td align="right">$332.50</td>
        <td align="right">$0.00</td>
        <td align="right">$2,232.50</td>
    </tr><tr>
        <td>119</td>
        <td><input id="dg_Purchase_ctl03_CheckBox1" name="dg_Purchase$ctl03$CheckBox1" type="checkbox"></td>
        <td>Yih-Wen Kuo (1959, Taiwan)</td>
        <td align="right">$1,800.00</td>
        <td align="right">$315.00</td>
        <td align="right">$0.00</td>
        <td align="right">$2,115.00</td>
    </tr>
</tbody></table>

<p>Payments:</p>
    <table rules="all" id="dg_Payment" style="font-size: smaller; border-collapse: collapse;" border="1" cellspacing="0">
    <tbody><tr>
        <td style="width: 120px;">Payment Method</td>
        <td>Date</td>
        <td align="right">Amount&nbsp;&nbsp;</td>
    </tr><tr>
        <td>Total</td>
        <td>&nbsp;</td>
        <td align="right">$0.00</td>
    </tr>
</tbody></table> 
```

当查看 HTML 页面时，表格看起来与它应有的完全一样。但是当我生成 PDF 时，表格（或者更确切地说，表格中的所有内容）没有显示。只有边框是可见的，几乎只是每个表格的 2 px 直线。

因此，在我的普通脚本中，加载整个页面后，我要做的最后一件事是：

```
 StringWriter stringWriter = new StringWriter();
    HtmlTextWriter writer = new HtmlTextWriter(stringWriter);
    Render(writer); 
```

iTextSharp 的功能如下：

```
protected override void Render(HtmlTextWriter writer)
{
    MemoryStream mem = new MemoryStream();
    StreamWriter twr = new StreamWriter(mem);
    HtmlTextWriter myWriter = new HtmlTextWriter(twr);
    base.Render(myWriter);
    myWriter.Flush();
    myWriter.Dispose();
    StreamReader strmRdr = new StreamReader(mem);
    strmRdr.BaseStream.Position = 0;
    string pageContent = strmRdr.ReadToEnd();
    strmRdr.Dispose();
    mem.Dispose();
    writer.Write(pageContent);
    CreatePDFDocument(pageContent);
}

public void CreatePDFDocument(string strHtml)
{

    string strFileName = HttpContext.Current.Server.MapPath("test.pdf");
    // step 1: creation of a document-object
    Document document = new Document();
    // step 2:
    // we create a writer that listens to the document
    PdfWriter.GetInstance(document, new FileStream(strFileName, FileMode.Create));
    StringReader se = new StringReader(strHtml);
    HTMLWorker obj = new HTMLWorker(document);
    document.Open();
    obj.Parse(se);
    document.Close();
    ShowPdf(strFileName);
}

public void ShowPdf(string strFileName)
{
    Response.ClearContent();
    Response.ClearHeaders();
    Response.AddHeader("Content-Disposition", "inline;filename=" + strFileName);
    Response.ContentType = "application/pdf";
    Response.WriteFile(strFileName);
    Response.Flush();
    Response.Clear();
} 
```

同样，页面上以编程方式设置的所有内容都会显示在 PDF 中，但数据网格除外。越过边界，似乎这不是`width`问题。它只是看起来是空的，仅此而已。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T12:58:07.920

好吧，我找不到为什么这行不通的押韵或理由，所以我走了另一条路。我决定将生成 HTML 代码的页面设为辅助页面，并让生成 PDF 的页面直接引用它。我最终得到：

```
String address = "http://address.com/admin/Invoice2.aspx?sale_id=" + sale_id + "&bidder_number=" + bidder_number;

using (WebClient wc = new WebClient())
{
    string content = wc.DownloadString(address);
    CreatePDFDocument(content);
} 
```

在我的页面加载方法中，只保留了其他两个功能：

```
public void CreatePDFDocument(string strHtml)
{

    string strFileName = HttpContext.Current.Server.MapPath("invoice.pdf");
    // step 1: creation of a document-object
    Document document = new Document();
    // step 2:
    // we create a writer that listens to the document
    PdfWriter.GetInstance(document, new FileStream(strFileName, FileMode.Create));
    StringReader se = new StringReader(strHtml);
    HTMLWorker obj = new HTMLWorker(document);
    document.Open();
    obj.Parse(se);
    document.Close();
    ShowPdf(strFileName);
}

public void ShowPdf(string strFileName)
{
    Response.ClearContent();
    Response.ClearHeaders();
    Response.AddHeader("Content-Disposition", "inline;filename=" + strFileName);
    Response.ContentType = "application/pdf";
    Response.WriteFile(strFileName);
    Response.Flush();
    Response.Clear();
} 
```

现在我只需要将表格的样式转换为 PDF 就可以了。但这是另一个问题。

# python - 仅使用一个参数集从旧函数生成新函数

> ID：10984924
> 
> 赞同：1
> 
> 时间：2012-06-11T17:40:36.590
> 
> 标签：python, function, lambda, arguments

假设我有一个功能

```
def oldfunction(arg1,arg2,arg3):
    print(arg1,arg2,arg3) 
```

我想创建一个新函数，其中我将第一个参数设置为 10。新函数的行为将是：

```
>>> new_function(20,"30")
10 20 '30' 
```

一种方法是使用 lambda 函数：

```
>>> newfunction = lambda arg2,arg3: function(10,arg2,arg3)
>>> newfunction("ten",[10])
(10, 'ten', [10]) 
```

但是，假设我事先不知道“oldfunction”需要多少参数。我仍然想创建一个与“oldfunction”相同的新函数，但设置了第一个参数，并且所有后续参数都保持打开状态。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-11T17:44:58.293

试试[functools.partial](http://docs.python.org/library/functools.html#functools.partial)：

```
from functools import partial

new_function = partial( oldfunction, 10 ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T17:45:18.700

以下示例允许您将 10 绑定到 oldfunction 中的第一个参数位置，然后在 *args 中提供剩余的两个参数。所以，试试这个：

```
def newfunction(*args):
    return oldfunction(10, *args) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T18:09:56.473

这可以是一个功能性解决方案，您的代码在您的具体情况下看起来像这样：

```
from functools import partial

def newfunction(*args):
    return oldfunction(10, *args)

newfunction(20, 30)
(10, 20, 30) 
```

10 被绑定为 oldfunction 的第一个参数，然后是 *args。

# css - 可以将尺寸设置为“0”，没有单位吗？

> ID：10984925
> 
> 赞同：0
> 
> 时间：2012-06-11T17:40:45.497
> 
> 标签：css, dimensions, units-of-measurement

css中的维度可以设置为“0”，没有任何单位吗？因为在我的世界里，“0 px”和“0 cm”、“0 em”甚至“0%”一样长。

例子：

```
width:0; 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:42:04.827

是的，它可以：非单位`0`测量绝对没问题：

> `<length>`长度是指距离测量值，在属性定义中用 表示。长度是一个维度。零长度可以表示为`<number>`“0”。（换句话说，*对于零长度，单位标识符是可选的*。）

（*强调*我的）。

参考：

*   [距离单位为' `<length>`'类型](http://www.w3.org/TR/css3-values/#lengths)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:42:01.597

是的。不指定任何单位的设置`0`是完全有效的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T17:55:07.377

是的你可以。对于零值，单位是可选的。

就我个人而言，我实际上更喜欢使用`0`over `0px`，因为更清楚的是它实际上是一个预期的零值，而不仅仅是一个`10px`意外丢失它的`1`.

# c++ - 在 VS2010 控制台应用程序中链接 windows.h (WNDCLASSEX) 代码

> ID：10984926
> 
> 赞同：0
> 
> 时间：2012-06-11T17:40:49.490
> 
> 标签：c++, visual-studio-2010, console-application

我有一个 VS2010 Win32 控制台应用程序。在这个控制台应用程序中，我尝试将一个窗口作为子窗口附加到**另一个**Win32 应用程序。但我没有**链接**应用程序（它编译，只是链接器问题 AFAIK）：

```
Error   1   error LNK2019: unresolved external symbol "long __stdcall viewproc(struct HWND__ *,unsigned int,unsigned int,long)" (?viewproc@@YGJPAUHWND__@@IIJ@Z) referenced in function "void __cdecl createFSXWindow(void)" (?createFSXWindow@@YAXXZ)  H:\Projects\VisualStudioNet2010\FSXTests\Menu Items\Menu Items\MenuItems.obj    Menu Items 
```

我在 Linker/include 下添加了 Win32 Windows 项目中的所有库：

```
kernel32.lib;user32.lib;gdi32.lib;winspool.lib; comdlg32.lib;advapi32.lib;shell32.lib;ole32.lib;oleaut32.lib;uuid.lib;odbc32.lib; odbccp32.lib;%(AdditionalDependencies) 
```

备注：为了澄清，我不（！）尝试将窗口附加到控制台窗口，而是另一个 Win32 应用程序，所以它不是关于[“让 win32 控制台应用程序显示一个窗口”](https://stackoverflow.com/questions/3193433/make-a-win32-console-app-display-a-window)

一旦我添加窗口代码，问题就会出现，例如：

```
#include <windows.h>
#include <tchar.h>
#include <stdio.h>
#include <strsafe.h>
....

// window
WNDCLASSEX wc;
wc.style = CS_HREDRAW | CS_VREDRAW ;
wc.lpfnWndProc = viewproc; 
```

当我检查链接器的命令行时，我的控制台应用程序和 Win32 应用程序之间的唯一区别是`SUBSYSTEM:CONSOLE`vs。`SUBSYSTEM:WINDOWS`

有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:52:49.813

链接器错误只是告诉您忘记*编写*viewproc() 函数。

您声明了它，编译器很高兴，但没有实现它，链接器不高兴。或者你写了它但错误地输入了定义。它不是在某个标准库中实现的功能，您必须提供它。窗口过程是用来给窗口自定义行为的。

# javascript - 未定义的变量作为函数参数javascript

> ID：10984927
> 
> 赞同：0
> 
> 时间：2012-06-11T17:40:52.680
> 
> 标签：javascript, function, error-handling, undefined, ambiguous

我看起来很公平，所以如果这已经得到回答，请原谅我。

我也很好奇实际的术语是什么；我正在处理的论点类型是否“模棱两可”？

无论如何，问题是我希望能够调用这样的函数：

```
prompt(_.define(variable, "DEFAULT VALUE")); 
```

基本上，这样变量就可以有默认值。

但是，每次我尝试这样做时，都会收到此错误：

```
Timestamp: 6/11/2012 1:27:38 PM
Error: ReferenceError: thisvarisnotset is not defined
Source File: http://localhost/js/framework.js?theme=login
Line: 12 
```

这是源代码：

```
function _() {
return this;
};

(function(__) {
__.defined = function(vrb, def) {
    return typeof vrb === "undefined" ? ((typeof def === "undefined") ? null : def) : vrb;
    };
})(_());

prompt(_.defined(thisvarisnotset, "This should work?"), "Can you see this input?"); 
```

不知道它为什么这样做？我之前在函数中将未定义的变量称为参数，它工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:45:22.047

完全未声明的变量不能在 JS 中传递；您只能传递已声明的变量或其他变量的未声明属性。

换句话说：

```
var a; // you can do _.defined(a)
var a = undefined; // you can do _.defined(a)
a.b; // you can do _.defined(a.b), even though we never defined b 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:51:57.777

> 基本上，这样变量就可以有默认值。

为什么不使用默认值初始化变量？

或者，在调用之前初始化变量`defined`。

```
var variable; // Note that this will not overwrite the variable if it is already set. 
```

或者，甚至更好。

```
var variable = variable || 'default'; 
```

# opengl - Hello World OpenGL 程序：“glEnableVertexAttribArray 未在此范围内声明”

> ID：10984928
> 
> 赞同：3
> 
> 时间：2012-06-11T17:40:58.483
> 
> 标签：opengl, freeglut

越来越令人沮丧。我一直在尝试运行一个简单的 hello world 类型的程序，但它并没有发生。

我使用的是 Windows 7，而我的显卡确实支持较新的 OpenGL 东西。使用 freeglut 用 C 语言编写，我正在使用 MinGW 和 Code::Blocks 进行编译。在链接器中，我有 freeglut、opengl32 和 glu32。我将 freeglut 的东西保存在我的 MinGW 文件夹中的 freeglut 文件夹中，所以在我的构建设置中的搜索目录下，我有编译器的“C:\MinGW\freeglut\include”和“C:\MinGW\freeglut\lib " 用于链接器。

这是我的代码：

```
#include <stdlib.h>
#include <GL/glut.h>

void NIAppIdle(void);
void NIAppDisplay(void);

int main(int argc, char *argv[])
{
    // Setup windwing
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE);
    glutInitWindowSize(800, 600);
    glutCreateWindow("HELLO WORLD");

    // Define GLUT callbacks
    glutIdleFunc(NIAppIdle);
    glutDisplayFunc(NIAppDisplay);

    // Enter render loop
    glutMainLoop();
    return 0;
}

void NIAppIdle(void)
{
    glutPostRedisplay();
}

void NIAppDisplay(void)
{
    glClearColor(0.0f, 1.0f, 0.0f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT);

    float geometry[] =
    {
        -0.5f,  0.5f, 0.0f, 1.0f,
         0.5f, -5.0f, 0.0f, 1.0f,
         0.0f,  0.5f, 0.0f, 1.0f
    };
    glEnableVertexAttribArray(0);
    glVertexAttribPointer(0, 4, GL_FLOAT, 0, 0, geometry);
    glDrawArrays(GL_TRIANGLES, 0, 3);
    glutSwapBuffers();
} 
```

问题在于“glEnableVertexAttribArray”和“glVertexAttribPointer”函数。编译器说它们“没有在这个范围内声明”。

程序可以在没有这些行的情况下运行，所以我猜 OpenGL 已正确链接，但由于某种原因我根本无法使用这些函数，而且我知道它们是 OpenGL 的一部分。这与我拥有的 OpenGL 版本有关吗？

无论如何，这是我第一次学习 OpenGL，我可能做错了什么，所以我请求有人帮助我。如果这篇文章看起来有点蹩脚，我很抱歉，这也是我第一次在这个网站上发帖。另外我很抱歉我的语法，英语不是我的第一语言。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:45:42.513

我认为您只能通过手动加载函数指针来访问 glEnableVertexAttribArray 。如果您只想创建一个简单的 hello world 程序，我建议您使用[GLEW](http://glew.sourceforge.net/)来为您处理。

# lambda - 在 D 中使用 lambdas 创建可咖喱函数不能作为 class\struct memebers

> ID：10984930
> 
> 赞同：6
> 
> 时间：2012-06-11T17:41:16.033
> 
> 标签：lambda, d, currying

我一直在玩 D，试图通过链接 lambda 表达式来模仿[Scala 风格的可咖喱函数。](http://www.scala-lang.org/node/135)

我想出了这个：

```
immutable foo=function(immutable int x)=>(immutable int y)=>(x+y);
struct S
{
    static immutable foo=function(immutable int x)=>(immutable int y)=>(x+y);
}
class C     static immutable foo=function(immutable int x)=>(immutable int y)=>(x+y);
}

void main()
{
    writefln("global\t%s",foo(1)(2));
    writefln("struct\t%s",S.foo(1)(2));
    writefln("class\t%s",C.foo(1)(2));
} 
```

这是我运行它时得到的：

```
global  3
struct  1528543170
Segmentation fault 
```

如您所见，我的方法适用于全局函数变量，但结构的静态函数变量给出垃圾结果，并且类的静态函数变量完全失败。如果我`x`从返回表达式中删除 - `function(immutable int x)=>(immutable int y)=>(y)`- 结构版本给出正确的结果（`2`），但类版本仍然失败。

如果我使用常规方法，而不是函数变量：

```
immutable foo=function(immutable int x)=>(immutable int y)=>(x+y);
struct S
{
    static auto foo(immutable int x)
    {
        return (immutable int y)=>(x+y);
    }
}
class C
{
    static auto foo(immutable int x)
    {
        return (immutable int y)=>(x+y);
    }
}

void main()
{
    writefln("global\t%s",foo(1)(2));
    writefln("struct\t%s",S.foo(1)(2));
    writefln("class\t%s",C.foo(1)(2));
} 
```

它工作得很好：

```
global  3
struct  3
class   3 
```

而且我还获得了使用委托的优势（编译器在第一个版本中不允许委托） - 但这种风格不太优雅。

我很清楚 D`curry`在`std.functional`库中有用于 currying 函数的函数，但有时默认情况下使函数可curryable 更舒服，此外 - 我很想知道为什么我的第一个版本不起作用。

有任何想法吗？

**更新**

好的，[我已经提交了一个错误](http://d.puremagic.com/issues/show_bug.cgi?id=8227)。我做了更多的挖掘，结果证明参数列表`foo`被转移了，这就是为什么`x`会得到垃圾数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T18:24:04.993

老实说，看起来您遇到了编译器错误。[请报告](http://d.puremagic.com/issues)。由于结构和类中的变量是静态的，它们的行为应该与模块级变量的行为相同，显然不是。

# android - 在断点上调试器时防止小部件的“计划重新启动崩溃的服务”

> ID：10984936
> 
> 赞同：0
> 
> 时间：2012-06-11T17:41:31.567
> 
> 标签：android, eclipse, debugging, android-widget, breakpoints

按照不同的或多或少的官方教程中的指示，我已经使用 Android 开发工具包 (16.0.1) 设置了 Eclipse (3.7.2)，包括 Dalvik 调试监视器服务 (16.0.1)。

如果我编写一个带有启动器 Activity 的“标准”Android 应用程序，那么我可以在我的代码中设置断点，在虚拟 Android 设备上运行它，并且断点按预期中断，如果出现以下情况，我可以整晚调试代码我想。

当我开始使用没有启动器 Activity 的 Android 主屏幕小部件而不是“标准”Android 应用程序时，问题就出现了。如果我想调试我的代码，我仍然可以轻松设置断点。假设我在我的 AppWidgetProvider 实现的 onUpdate 中直接放置了一个断点，并通过将我的小部件实例添加到 AVD 来测试它。断点不会中断。我想，这是因为在调试配置中，我的小部件的启动操作是“什么都不做”，因为我没有可以选择的活动。

谷歌搜索，我发现当我的 AVD 运行时，我可以转到 Eclipse 中的 DDMS 视图，在它的设备选项卡中，我可以选择我的小部件进程，然后单击一个可爱的绿色错误“调试选定的进程”。如果在那之后，我在 AVD 中创建了我的小部件的一个实例，那么执行确实会在我的断点处中断。

但是我的下一个问题来了：当这种情况发生时，我在调试器中有大约几秒钟的时间，在 Android 决定我的小部件进程已挂起（这是真的）并且应该被拍摄（这不是真的）之前！因此我的问题是：**如何防止系统拍摄我的进程在断点处停止？**

注意：在日志中，我收到了那种通知：

```
06-11 17:02:19.900: W/ActivityManager(59): Scheduling restart of crashed service [...] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T07:35:53.937

`IntentServcie`从您的小部件接收器 ( )启动一个不在主线程上运行的服务 (例如`onUpdate()`)。在那里做你所有的工作。

# java - 如何使用 SIGAR 远程获取另一台机器的系统信息？

> ID：10984938
> 
> 赞同：0
> 
> 时间：2012-06-11T17:41:36.830
> 
> 标签：java, jmx, sigar

我正在开发一个需要显示 CPU 使用率以及远程机器的其他系统信息的项目。人们建议使用 SIGAR 来实现这一点，但我不知道如何使用它。源代码对我来说不太有意义。基本上，我的问题是：如何在提供主机 IP 和 JMX 端口时将 SIGAR 提供的 MBean 注册到服务器，以及之后如何从其他计算机获取系统信息。如果我对 JMX 的工作方式有误，请纠正我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:48:14.160

在我看来，您将不得不编写一些包装对象以将各种 SIGAR 输出公开为 JMX mbean 属性。您如何做到这一点在很大程度上取决于您使用什么来公开您的 JMX bean。我将为各种不同类型的 SIGAR 输出中的每一种编写一个包装对象：内存、磁盘、...

我编写了一个[SimpleJMX 库](http://256stuff.com/sources/simplejmx/)，可能会有所帮助。我将使用它的格式提供一个示例对象，您可以使用它通过 JMX 公开信息。您可以将其调整为用于发布 JMX 的任何机制。我对 SIGAR 不够熟悉，无法知道我下面的 sigar 代码是否正确获取`ProcMem`实例。

```
@JmxResource(description = "Show SIGAR Info", domainName = "foo")
public class SigarProcMem {

    private ProcMem procMem;

    {
      // sorry, I'm not up on sigar so I'm not sure if this works
      Sigar sigar = new Sigar();
      procMem = sigar.getProcMem(sigar.getPid());
    }

    @JmxAttributeMethod(description = "Resident memory")
    public long residentMemory() {
       return procMem.getResident();
    }

    @JmxAttributeMethod(description = "Get the Total process virtual memory")
    public long totalVirtualMemory() {
       return procMem.getSize();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T21:13:03.290

这些是您可以注册的 Sigar 内置 MBean 的类的名称：

*   org.hyperic.sigar.jmx.SigarCpu
*   org.hyperic.sigar.jmx.SigarCpuInfo
*   org.hyperic.sigar.jmx.SigarCpuPerc
*   org.hyperic.sigar.jmx.SigarLoadAverage
*   org.hyperic.sigar.jmx.SigarMem
*   org.hyperic.sigar.jmx.SigarProcess
*   org.hyperic.sigar.jmx.SigarRegistry
*   org.hyperic.sigar.jmx.SigarSwap

但是，远程部署这些将非常复杂，因为 Sigar 依赖于本地库，当加载 MBean 时，该库必须位于目标 JVM 的 lib-path 中。这意味着，您需要在要监控的每个目标主机上主动加载库和 MBean。

您可能能够破解一种通过远程调用使目标 JVM 加载它的方法，但这并不重要，并且需要您绕过 JVM 中的任何安全设置，因为默认情况下，这是您不应该做的能够做到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-24T16:02:54.573

您可以通过破解系统部分来轻松部署 Sigjar：

```
private String before;
private Sigar sigar;

/**
 * Constructor - don't forget to call unload later!
 */
public SetlogSigar() throws Exception {
    before = System.getProperty("java.library.path");

    String path = "";

    String add = getJarFolder();

    if (before.contains(";"))
        path = before + ";./;" + add;
    else
        path = before + ":./:" + add;

    setSystemPath(path);

    sigar = new Sigar();

}

/**
 * This is needed to dynamically update the JAVA Path environment in order to load the needed native library
 * Yes -rather an ugly hack...
 */
private String getJarFolder() {
    // get name and path
    String path = SetlogSigar.class.getProtectionDomain().getCodeSource().getLocation().getPath();
    String decodedPath = path;
    try {
        decodedPath = URLDecoder.decode(path, "UTF-8");
    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
        return null;
    }    

    File f = new File(decodedPath);
    String absolutePath = f.getParentFile().getParentFile().getParentFile().getParent()+"/lib";

    return absolutePath;
}

/**
 * Unloads the JNI bindings
 */
public void unload() {
    this.sigar.close();
    setSystemPath(before);
} 
```

此 hack 将 sigjar.jar 所在的文件夹动态添加到环境变量中。只需将所有本机库放在那里，部署就会变得不那么复杂。

# android - 如何使用android连接数据库并从数据库中检索值？

> ID：10984942
> 
> 赞同：-1
> 
> 时间：2012-06-11T17:41:51.493
> 
> 标签：android

我需要使用 android 在云中创建一个数据库。如何使用android连接该数据库并从数据库中检索值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T18:00:34.477

在我看来，最好的方法是使用**REST webservice**。REST 使用带有 HTTP GET、POST、PUT、DELETE[方法](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)的 HTTP 协议。它有点类似于 SQL CRUD 接口（创建、检索、更新、删除）。**调用 webservice**方法只是针对您的应用程序中的一个 url，例如： `GET http://your-ip/RestService/webserviceMethod` 方法可能返回值。

**Android 部分：** Android 内置了促进 REST Web 服务调用的 http 库。谷歌它（[样本在这里](https://stackoverflow.com/questions/4948152/need-sample-android-rest-client-project-which-implements-virgil-dobjanschi-rest)）。在 android 中使用 ContentProviders 也很好，它可以让一些事情变得更容易。

**服务器部分：** 您将需要服务器上的一些接口，这些接口将对数据库执行操作（SELECT、INSERT、...）并向 Web 服务提供数据。您可以使用 PHP、ASP 或 JSP。[我个人更喜欢 JSP，这里](http://www.vogella.com/articles/REST/article.html)有很好的教程。它不像看起来那么长，并且有一切需要的东西。

**数据通信：** 要通过 Internet 发送数据，您需要定义格式。在我看来，最好的是 JSON。简单地说，它使用键值对。有助于使用它的库类似于那些专用于 xml 操作的库，但是 JSON 非常轻量并且具有类似 xml 的可能性。

**评论：** “云”对于这种架构来说有点大词......你只是在制作标准的客户端-服务器应用程序。

如果您需要更多 - 您必须更准确地询问

# c# - ASP.NET - 添加新行后刷新gridview（DataTable源）（由计时器触发）

> ID：10984946
> 
> 赞同：2
> 
> 时间：2012-06-11T17:41:56.090
> 
> 标签：c#, asp.net, gridview, timer, datatable

我有一个由计时器每分钟触发一次的方法，该方法将一行添加到 DataTable。页面上有一个 GridView，其中有这个 DataTable 作为它的课程。每次添加一行时，我 DataBind() - 新行显示在 DataTable 中（我可以在调试器中看到它），但不在 GridView 上。

我不会用代码让你不知所措，但我会尝试展示所有相关的东西。

以下是**计时器和 DataTable**源的声明：

```
static DataTable logTable;
System.Timers.Timer timeoutTimer; 
```

**以下是Page_Load**上发生的情况：

```
 protected void Page_Load(object sender, System.EventArgs e)
    {
        if (logTable == null)
        {
            logTable = new DataTable();
            logTable.Columns.Add(new DataColumn("Timestamp", typeof(string)));
            logTable.Columns.Add(new DataColumn("Type", typeof(string)));
            logTable.Columns.Add(new DataColumn("Message", typeof(string)));
        }
    } 
```

以下是**定时器的初始化**方式（每分钟都会成功触发）：

```
 StopTime = DateTime.Now.AddMinutes(5);

    timeoutTimer = new System.Timers.Timer(60000);
    timeoutTimer.Interval = 60000;
    timeoutTimer.Elapsed += new ElapsedEventHandler(RunningStatusesTick);
    timeoutTimer.Start();

    GC.KeepAlive(timeoutTimer); 
```

这是**打勾方法**：

```
 private void RunningStatusesTick(object sender, ElapsedEventArgs e){

        try
        {
            string info = GetRawInfo();
            recordResults(info);

        }
        catch (Exception ex)
        {
            // Error thrown?  Catch it and record it.
            recordResults(ex.Message, true);
        }
    } 
```

这是**向 DataTable 添加新行的方法**（并执行 DataBind()）：

```
 private void recordResults(string ResultText, bool IsError = false)
    {
        DataRow logRow = logTable.NewRow();
        logRow["Timestamp"] = DateTime.Now.ToShortDateString() + " " + DateTime.Now.ToShortTimeString();
        logRow["Type"] = (IsError ? "ERROR" : "INFO");
        logRow["Message"] = ResultText;
        logTable.Rows.Add(logRow);

        gvLogTable.DataSource = null;
        gvLogTable.DataSource = logTable;
        gvLogTable.DataBind();
    } 
```

最后，这里是带有 gridview 的 aspx 标签：

```
<body>
    <form id="form1" runat="server">
    <div>
        <asp:GridView runat="server" id="gvLogTable"></asp:GridView>
    </div>
    </form>
</body>
</html> 
```

我已经尝试过的事情：

*   将 DataSource = null 行放在创建新行的行之前
*   添加一个 Response.Redirect （没有工作，因为该方法是由计时器触发的）
*   创建用于数据源的临时表（设置为静态表的信息）

提前非常感谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:53:49.970

在我看来，您的重新绑定不正确。在 recordResults() 函数中，您的最后三行如下：

```
gvLogTable.DataSource = null;
gvLogTable.DataSource = logRow;
gvLogTable.DataBind(); 
```

我认为你想绑定到`logTable`，而不是`logRow`。

或者，您是否尝试过使用[BindingListCollectionView](http://msdn.microsoft.com/en-us/library/system.windows.data.bindinglistcollectionview.aspx)和相关的[Refresh()](http://msdn.microsoft.com/en-us/library/system.windows.data.bindinglistcollectionview.aspx)方法？我不确定它是否能解决您的问题，但可能值得一看。

# php - 从 PHP 调用 Jquery

> ID：10984949
> 
> 赞同：0
> 
> 时间：2012-06-11T17:42:04.583
> 
> 标签：php, jquery

无法从 PHP 中调用 Jquery 函数。使用以下代码时出现语法错误：

```
if(!empty($_POST['selectAGE'])){
     $username = $_POST['selectAGE'];
}

if(empty($_POST['selectAGE'])){
   echo '<script type="text/javascript">'
   ,  '$("#selectAGE").prepend("<option value=''></option>").val('');'
   , '</script>';
} 
```

我是不是逃得不好还是怎么回事？

除此之外，我正在使用

```
if ( form.selectAGE.selectedIndex == 0 ) { alert ( "Enter the correct Age." ); return false; } 
```

但是，一旦提交了表单，它就会消除前面的“空”值，现在您选择的那个是 selectedindex 0。所以上面的检查返回您没有输入它。我如何修改上面的行以考虑到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:43:45.413

在这里转义字符：

```
'$("#selectAGE").prepend("<option value=\'\'></option>").val(\'\');' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:47:26.733

如果转义给您带来麻烦，我只会编写 JS，而不是回显它。

```
if(empty($_POST['selectAGE'])): ?>
   <script type="text/javascript">
       $('#selectAGE').prepend('<option value=""></option>').val('');
   </script>
<?php endif; 
```

我更喜欢在 JS 和 PHP 之间使用 endif 而不是匹配括号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:46:02.303

您需要转义单引号。试试这个：

```
<?
if(!empty($_POST['selectAGE'])){
     $username = $_POST['selectAGE'];
}

if(empty($_POST['selectAGE'])){
   echo '<script type="text/javascript">',
   echo '$("#selectAGE").prepend("<option value=\'\'></option>").val(\'\');'
   , '</script>';
}
?> 
```

# java - SAX 解析器和 XAPI xml

> ID：10984954
> 
> 赞同：1
> 
> 时间：2012-06-11T17:42:24.973
> 
> 标签：java, saxparser

我想用 SAXParser 解析 XAPI xml。但现在我有一个问题。

首先是xml的片段：

```
<node id="24924135" lat="49.8800274" lon="8.6453740" version="12" timestamp="2012-05-25T15:13:47Z" changeset="11699394" uid="61927" user="AlexPleiner">
<tag k="addr:city" v="Darmstadt"/>
<tag k="addr:housenumber" v="41"/>
<tag k="addr:postcode" v="64293"/>
<tag k="addr:street" v="Kahlertstraße"/>
<tag k="amenity" v="pub"/>
<tag k="name" v="Kneipe 41"/>
<tag k="note" v="DaLUG Meeting (4st Friday of month 19:30)"/>
<tag k="smoking" v="no"/>
<tag k="website" v="http://www.kneipe41.de/"/>
<tag k="wheelchair" v="limited"/> 
```

还有我的 SAXParser 代码片段：

```
public void startElement(String uri, String localName, String qName,
        Attributes atts) throws SAXException {
  if (localName.equals("node")) {
    // Neue Person erzeugen
    poi = new POIS();

    poi.setLat(Float.parseFloat(atts.getValue("lat")));
    poi.setLon(Float.parseFloat(atts.getValue("lon")));
  }
}

public void endElement(String uri, String localName, String qName) throws SAXException {

  poi.setHouseNo(currentValue);

  if (localName.equals("addr:street")) {
    poi.setStreet(currentValue);
  }

  if (localName.equals("amenity")) {
    poi.setType(currentValue);
  }

} 
```

纬度和经度不是问题，而是标签“标签”。

我如何检查“k”并获得 v 的值？

任何人的想法？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:49:16.047

您有兴趣查看的值是 xml 属性，将在`startElement(...)`方法中由`Attributes`传入的参数表示。

您需要做的与您为`node`元素所做的非常相似。

```
public void startElement(String uri, String localName, String qName,
          Attributes atts) throws SAXException 
{
    //your other node code        

    if(localname.equals("tag")) {
        String k = atts.getValue("k");
        if(iAmInterestedInThisK(k)) {
            String v = atts.getValue("v");
            doSomethingWithThisV(v);
        }
    }
} 
```

# linux - 在所有行中添加文本

> ID：10984961
> 
> 赞同：4
> 
> 时间：2012-06-11T17:43:02.970
> 
> 标签：linux, bash, scripting

我在 linux 环境中工作，我想获得一些关于 bash 脚本的帮助，以减少简单的重复。

我有一长串文件名（准确地说是 937）。在该文件的一行中，只有一个文件名，因此该文件共有 937 行。

我想在文件名前添加某些文本，并在文件名后按顺序添加数字。

所以我想在文本文件中有这样的东西。

```
aa.exe

bb.exe

cc.exe 
```

至

```
asd aa.exe 1

asd bb.exe 2

asd cc.exe 3 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T18:33:43.177

只是为了好玩，这是一个 awk 版本：

```
awk '{print "foo", $0, NR}' files.lst 
```

如果`files.lst`包括：

```
a.txt
b.txt
c.txt 
```

...然后这将输出：

```
foo a.txt 1
foo b.txt 2
foo c.txt 3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T20:01:58.373

纯重击：

```
while read -r line
do
    echo "asd $line $((++i))"
done < inputfile 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T18:01:10.983

这是一个简单的 Python 解决方案，将其保存在一个名为`so.py`. 由于您仍在使用 Python v 2.4.2，因此此代码应该适用于该早期版本：

```
#!/usr/bin/python

add_text = 'asd'  # the string to put in front

fn  = open('filenames.txt')
outf =  open('outdata.txt', 'w')

i = 1
for filename in fn:
    outf.write('%7s %10s %d\n' % (add_text, filename.strip(), i))
    i += 1

fn.close()
outf.close() 
```

期望文件的名称在 file 中`filenames.txt`，并且生成的输出到 file `outdata.txt`。

```
asd    aa.exe    1
asd    bb.exe    2
asd    cc.exe    3 
```

在文件名之前添加的文本在变量中是固定的`add_text`。

要运行脚本，请在 Linux 提示符下发出以下命令：

```
chmod +x so.py    <-- this is only needed once
./so.py           <-- to run the script 
```

它将使用输入文件生成输出文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T20:34:31.567

在 vim 中：

```
:%s/.\+/\=printf("%s %s %d", "asdf", submatch(0), line("."))/ 
```

# asp.net - 如何在单个 ASP.Net 项目中设置多个站点？

> ID：10984963
> 
> 赞同：1
> 
> 时间：2012-06-11T17:43:16.207
> 
> 标签：asp.net, css

抱歉，如果标题与我的问题的相关性不够好，我不知道如何表达我要查找的内容。

我正在寻找的是一种创建子实体的方法？的一个站点。

示例：我们有一个名为“xyz”的网站，它具有默认样式，您可以通过“www.xyz.com”访问它。

我想要做的是类似'www.xyz.com/a' -> 这将加载具有不同布局/css的同一个站点。

差异可能很简单，只是一些 css 颜色变化，而另一些可能是轻微的 html 结构差异。

但恐怕我不知道从哪里开始寻找解决办法。

任何指导都会有很大帮助

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:51:18.590

这很容易，您将在您的网站*解决方案中拥有单独的**项目*。只需创建一个解决方案并（在解决方案资源管理器中）右键单击并创建一个新项目。看看[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ee817674.aspx)。

 *就 URL 而言，通常接受的方法是设置子域，如下所示：

```
http://site1.xyz.com
http://site2.xyz.com 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T18:06:59.440

为什么不使用单独的站点，而不是使用`Profile`其他持久性机制来在运行时决定使用哪个主题？

例如：

```
protected void Page_PreInit(object sender, EventArgs e)
{
    Page.Theme = Profile.UI.Theme = "Reddish";
} 
```

有关完整的配置文件示例，请参阅[代码颂。](http://odetocode.com/Articles/440.aspx)*

# ruby-on-rails - 来自 Windows 权限的 Capistrano 部署问题被拒绝 Privatekey

> ID：10984970
> 
> 赞同：1
> 
> 时间：2012-06-11T17:43:48.110
> 
> 标签：ruby-on-rails, deployment, github, capistrano

我真的被这个部署困住了，我正在使用来自 railcasts 的 Ryan Bates 代码来部署 capistrano。

这是我的部署

```
require "bundler/capistrano"

load "config/recipes/base"
load "config/recipes/nginx"
load "config/recipes/unicorn"
load "config/recipes/postgresql"
load "config/recipes/nodejs"
load "config/recipes/rbenv"
load "config/recipes/check"

server "37.188.126.99", :web, :app, :db, primary: true

set :user, "deployer"
set :application, "TWL"
set :deploy_to, "/home/#{user}/apps/#{application}"
set :deploy_via, :remote_cache
set :use_sudo, false

set :scm, "git"
#set :repository, "git@github.com:acooperman/#{application}.git"
set :repository, "git@github.com:acooperman/TWL.git"
#set :repository, "https://github.com/acooperman/TWL.git"
set :branch, "master"

default_run_options[:pty] = true
ssh_options[:forward_agent] = true

after "deploy", "deploy:cleanup" # keep only the last 5 releases 
```

这是结果：

```
 $ cap deploy:update
      * executing `deploy:update'
     ** transaction: start
      * executing `deploy:update_code'
        updating the cached checkout on all servers
        executing locally: "git ls-remote git@github.com:acooperman/TWL.git master"
    Permission denied (publickey).
    fatal: The remote end hung up unexpectedly
    *** [deploy:update_code] rolling back
      * executing "rm -rf /home/deployer/apps/TWL/releases/20120611173529; true"
        servers: ["37.188.126.99"]
    Password:
        [37.188.126.99] executing command
        command finished in 340ms
    Command git ls-remote git@github.com:acooperman/TWL.git master returned status code pid 3500 exit 128 
```

如果我交换该行的评论

```
set :repository, "git@github.com:acooperman/TWL.git"
#set :repository, "https://github.com/acooperman/TWL.git" 
```

我得到以下信息：

```
 * executing `deploy:update'
     ** transaction: start
      * executing `deploy:update_code'
        updating the cached checkout on all servers
        executing locally: "git ls-remote https://github.com/acooperman/TWL.git master"
    Username for 'https://github.com':
    Password for 'https://acooperman@github.com':
        command finished in 7893ms
      * executing "if [ -d /home/deployer/apps/TWL/shared/cached-copy ]; then cd /home/deployer/apps/TWL/shared/cached-copy && git
     fetch -q origin && git fetch --tags -q origin && git reset -q --hard 418c9e9b1d7b37427a76e6bf98a17722f3a9e863 && git clean -q
     -d -x -f; else git clone -q https://github.com/acooperman/TWL.git /home/deployer/apps/TWL/shared/cached-copy && cd /home/depl
    oyer/apps/TWL/shared/cached-copy && git checkout -q -b deploy 418c9e9b1d7b37427a76e6bf98a17722f3a9e863; fi"
        servers: ["37.188.126.99"]
    Password:
        [37.188.126.99] executing command
     ** [37.188.126.99 :: out] error: The requested URL returned error: 401 while accessing https://github.com/acooperman/TWL.git/
    info/refs
     **
     ** fatal: HTTP request failed
        command finished in 1590ms
    *** [deploy:update_code] rolling back
      * executing "rm -rf /home/deployer/apps/TWL/releases/20120611173441; true"
        servers: ["37.188.126.99"]
        [37.188.126.99] executing command
          command finished in 331ms
    failed: "sh -c 'if [ -d /home/deployer/apps/TWL/shared/cached-copy ]; then cd /home/deployer/apps/TWL/shared/cached-copy && gi
    t fetch -q origin && git fetch --tags -q origin && git reset -q --hard 418c9e9b1d7b37427a76e6bf98a17722f3a9e863 && git clean -
    q -d -x -f; else git clone -q https://github.com/acooperman/TWL.git /home/deployer/apps/TWL/shared/cached-copy && cd /home/dep
    loyer/apps/TWL/shared/cached-copy && git checkout -q -b deploy 418c9e9b1d7b37427a76e6bf98a17722f3a9e863; fi'" on 37.188.126.99 
```

Git 在我的新 vps 上运行良好，不需要密码。

我真的被困在这里，任何帮助都将不胜感激，我对 capistrano 完全陌生，对 rails 也很陌生，所以这确实让我很难过。

谢谢你的帮助 ：）

亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T18:25:19.963

looks like your ssh key is not in the default location, try setting a pass to your ssh key manually

```
ssh_options[:keys] = ["PATH TO SSH/id_rsa] 
```

# c++ - 为什么人们说使用随机数生成器时存在模偏差？

> ID：10984974
> 
> 赞同：312
> 
> 时间：2012-06-11T17:44:03.120
> 
> 标签：c++, random, language-agnostic, modulo

我看到这个问题被问了很多，但从未见过真正具体的答案。所以我将在这里发布一篇文章，希望能帮助人们理解为什么在使用随机数生成器时会出现“模偏差”，比如`rand()`在 C++ 中。

* * *

## 回答 #1

> 赞同：438
> 
> 时间：2012-06-11T17:44:04.150

`rand()`一个伪随机数生成器也是如此，它在 0 和 之间选择一个自然数`RAND_MAX`，这是一个定义在 中的常数`cstdlib`（请参阅这篇[文章](http://en.cppreference.com/w/cpp/numeric/random/rand)以获得关于 的一般概述`rand()`）。

现在如果你想生成一个介于 0 和 2 之间的随机数会发生什么？为了解释起见，假设`RAND_MAX`是 10，我决定通过调用来生成 0 到 2 之间的随机数`rand()%3`。但是，`rand()%3`不会以相等的概率产生 0 和 2 之间的数字！

**当`rand()`返回 0、3、6 或 9 时，** `rand()%3 == 0` . 因此，P(0) = 4/11

**当`rand()`返回 1、4、7 或 10 时，** `rand()%3 == 1` . 因此，P(1) = 4/11

**当`rand()`返回 2、5 或 8 时，** `rand()%3 == 2` . 因此，P(2) = ***3/11***

这不会以相等的概率生成 0 和 2 之间的数字。当然，对于较小的范围，这可能不是最大的问题，但对于较大的范围，这可能会扭曲分布，使较小的数字产生偏差。

那么什么时候`rand()%n`以相等的概率返回从 0 到 n-1 的数字范围呢？当`RAND_MAX%n == n - 1`. 在这种情况下，除了我们之前的假设`rand()`确实返回了一个介于 0 之间且`RAND_MAX`概率相等的数字，n 的模类也将均匀分布。

那么我们如何解决这个问题呢？一种粗略的方法是不断生成随机数，直到获得所需范围内的数字：

```
int x; 
do {
    x = rand();
} while (x >= n); 
```

但这对于 的低值是低效的`n`，因为您只有`n/RAND_MAX`机会获得范围内的值，因此您需要平均执行对 的`RAND_MAX/n`调用。`rand()`

一种更有效的公式方法是取一些长度可被 整除的大范围`n`，例如`RAND_MAX - RAND_MAX % n`，不断生成随机数，直到得到一个位于该范围内的随机数，然后取模：

```
int x;

do {
    x = rand();
} while (x >= (RAND_MAX - RAND_MAX % n));

x %= n; 
```

对于较小的值`n`，这很少需要多次调用`rand()`.

* * *

作品引用和延伸阅读：

*   [CPlusPlus 参考](http://www.cplusplus.com/reference/clibrary/cstdlib/rand/)

*   [永远的困惑](http://eternallyconfuzzled.com/arts/jsw_art_rand.aspx)

* * *

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-06-12T00:10:56.777

继续随机选择是消除偏见的好方法。

**更新**

如果我们在可被 整除的范围内搜索 x，我们可以加快代码速度`n`。

```
// Assumptions
// rand() in [0, RAND_MAX]
// n in (0, RAND_MAX]

int x; 

// Keep searching for an x in a range divisible by n 
do {
    x = rand();
} while (x >= RAND_MAX - (RAND_MAX % n)) 

x %= n; 
```

上面的循环应该非常快，平均说 1 次迭代。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-11-18T15:32:40.500

@user1413793 关于这个问题是正确的。我不打算进一步讨论这个问题，除了要说明一点：是的，对于 的小值`n`和大的值`RAND_MAX`，模偏差可以非常小。但是使用偏差诱导模式意味着每次计算随机数时都必须考虑偏差，并为不同的情况选择不同的模式。如果你做出错误的选择，它引入的错误是微妙的，几乎不可能进行单元测试。与仅使用适当的工具（例如`arc4random_uniform`）相比，这是额外的工作，而不是更少的工作。做更多的工作并得到一个更糟糕的解决方案是糟糕的工程，尤其是在大多数平台上每次都做对很容易的情况下。

不幸的是，解决方案的实施都是不正确的或效率低于应有的水平。（每个解决方案都有各种注释来解释问题，但没有一个解决方案被修复来解决这些问题。）这可能会使随便的答案寻求者感到困惑，所以我在这里提供了一个已知良好的实现。

同样，最好的解决方案是[`arc4random_uniform`](http://www.openbsd.org/cgi-bin/man.cgi?query=arc4random&sektion=3)在提供它的平台上使用，或者为您的平台使用类似的范围解决方案（例如[`Random.nextInt`](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html#nextInt%28%29)在 Java 上）。它会做正确的事情，而不会给您带来任何代码成本。这几乎总是正确的调用。

如果你没有`arc4random_uniform`，那么你可以使用开源的力量来看看它是如何在更广泛的 RNG 之上实现的（`ar4random`在这种情况下，类似的方法也可以在其他 RNG 之上工作）。

这是[OpenBSD 的实现](http://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/crypt/arc4random.c)：

```
/*
 * Calculate a uniformly distributed random number less than upper_bound
 * avoiding "modulo bias".
 *
 * Uniformity is achieved by generating new random numbers until the one
 * returned is outside the range [0, 2**32 % upper_bound).  This
 * guarantees the selected random number will be inside
 * [2**32 % upper_bound, 2**32) which maps back to [0, upper_bound)
 * after reduction modulo upper_bound.
 */
u_int32_t
arc4random_uniform(u_int32_t upper_bound)
{
    u_int32_t r, min;

    if (upper_bound < 2)
        return 0;

    /* 2**32 % x == (2**32 - x) % x */
    min = -upper_bound % upper_bound;

    /*
     * This could theoretically loop forever but each retry has
     * p > 0.5 (worst case, usually far better) of selecting a
     * number inside the range we need, so it should rarely need
     * to re-roll.
     */
    for (;;) {
        r = arc4random();
        if (r >= min)
            break;
    }

    return r % upper_bound;
} 
```

对于那些需要实现类似事情的人来说，值得注意的是对此代码的最新提交评论：

> 更改 arc4random_uniform() 以计算`2**32 % upper_bound`为 `-upper_bound % upper_bound`。简化代码并使其在 ILP32 和 LP64 架构上相同，并且通过使用 32 位余数而不是 64 位余数，在 LP64 架构上也稍微快一些。
> 
> Jorden Verwer 在 tech@ok deraadt 上指出；djm 或 otto 没有反对意见

Java 实现也很容易找到（参见上一个链接）：

```
public int nextInt(int n) {
   if (n <= 0)
     throw new IllegalArgumentException("n must be positive");

   if ((n & -n) == n)  // i.e., n is a power of 2
     return (int)((n * (long)next(31)) >> 31);

   int bits, val;
   do {
       bits = next(31);
       val = bits % n;
   } while (bits - val + (n-1) < 0);
   return val;
 } 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-04-23T00:10:33.927

# 定义

*模偏差*是使用模算术将输出集减少为输入集子集的固有偏差。通常，只要输入和输出集之间的映射不均匀分布，就会存在偏差，例如在输出集的大小不是输入集大小的除数时使用模算术的情况。

这种偏差在计算中特别难以避免，其中数字表示为位串：0 和 1。找到真正随机的随机源也非常困难，但超出了本文的讨论范围。**对于此答案的其余部分，假设存在无限的真正随机位来源。**

# 问题示例

让我们考虑使用这些随机位来模拟掷骰子（0 到 5）。有 6 种可能性，所以我们需要足够的位数来表示数字 6，也就是 3 位。不幸的是，3 个随机位会产生 8 种可能的结果：

```
000 = 0, 001 = 1, 010 = 2, 011 = 3
100 = 4, 101 = 5, 110 = 6, 111 = 7 
```

我们可以通过取模 6 的值将结果集的大小精确地减小到 6，但是这会出现*模偏差*问题：`110`产生 0，`111`产生 1。**这个 die 已加载。**

# 潜在的解决方案

## 方法 0：

与其依赖随机位，理论上可以雇佣一支小部队整天掷骰子并将结果记录在数据库中，然后每个结果只使用一次。这与听起来一样实用，而且很可能无论如何都不会产生真正的随机结果（双关语）。

## 方法一：

一个简单但数学上正确的解决方案不是使用模数，而是丢弃产生的结果`110`并`111`简单地用 3 个新位重试。不幸的是，这意味着**每次掷骰有 25% 的机会需要重新掷骰，包括每次重新掷骰**本身。除了最微不足道的用途外，这显然对所有用途都是不切实际的。

## 方法二：

使用更多位：使用 4 位而不是 3 位。这会产生 16 种可能的结果。当然，在结果大于 5 的任何时候重新滚动会使情况变得更糟（10/16 = 62.5%），因此仅此一项也无济于事。

请注意，2 * 6 = 12 < 16，因此我们可以安全地取任何小于 12 的结果并减少该模 6 以均匀分布结果。必须丢弃其他 4 个结果，然后像以前的方法一样重新滚动。

一开始听起来不错，但让我们检查一下数学：

```
4 discarded results / 16 possibilities = 25% 
```

> 在这种情况下，**额外的 1 位根本没有帮助**！

这个结果很不幸，但让我们用 5 位再试一次：

```
32 % 6 = 2 discarded results; and
2 discarded results / 32 possibilities = 6.25% 
```

一个明确的改进，但在许多实际情况下还不够好。好消息是，**添加更多位永远不会增加需要丢弃和重新滚动的机会**。这不仅适用于骰子，而且适用于所有情况。

然而，正如演示**的那样，添加一个额外的位可能不会改变任何事情。**事实上，如果我们将滚动增加到 6 位，概率仍然是 6.25%。

这引出了两个额外的问题：

1.  如果我们添加足够多的位，是否可以保证丢弃的概率会减小？
2.  *一般情况下多少位就足够*了？

# 通用解决方案

谢天谢地，第一个问题的答案是肯定的。6 的问题是 2^x mod 6 在 2 和 4 之间翻转，这恰好是 2 的倍数，因此对于偶数 x > 1，

```
[2^x mod 6] / 2^x == [2^(x+1) mod 6] / 2^(x+1) 
```

因此，6 是一个例外而不是规则。可以找到更大的模数，以相同的方式产生连续的 2 次方，但最终这必须回绕，并且丢弃的概率将降低。

> 在不提供进一步证明的情况下，通常使用**所需位数的两倍**将提供更小的、通常是微不足道的丢弃机会。

# 概念证明

这是一个使用 OpenSSL 的 libcrypo 提供随机字节的示例程序。编译时，请务必链接到`-lcrypto`大多数人都应该使用的库。

```
#include <iostream>
#include <assert.h>
#include <limits>
#include <openssl/rand.h>

volatile uint32_t dummy;
uint64_t discardCount;

uint32_t uniformRandomUint32(uint32_t upperBound)
{
    assert(RAND_status() == 1);
    uint64_t discard = (std::numeric_limits<uint64_t>::max() - upperBound) % upperBound;
    uint64_t randomPool = RAND_bytes((uint8_t*)(&randomPool), sizeof(randomPool));

    while(randomPool > (std::numeric_limits<uint64_t>::max() - discard)) {
        RAND_bytes((uint8_t*)(&randomPool), sizeof(randomPool));
        ++discardCount;
    }

    return randomPool % upperBound;
}

int main() {
    discardCount = 0;

    const uint32_t MODULUS = (1ul << 31)-1;
    const uint32_t ROLLS = 10000000;

    for(uint32_t i = 0; i < ROLLS; ++i) {
        dummy = uniformRandomUint32(MODULUS);
    }
    std::cout << "Discard count = " << discardCount << std::endl;
} 
```

我鼓励使用`MODULUS`和`ROLLS`值来查看在大多数情况下实际发生了多少重新滚动。持怀疑态度的人也可能希望将计算值保存到文件中并验证分布是否正常。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2017-10-28T16:32:21.243

马克的解决方案（公认的解决方案）几乎是完美的。

> ```
> int x;
> 
> do {
>     x = rand();
> } while (x >= (RAND_MAX - RAND_MAX % n));
> 
> x %= n; 
> ```
> 
> 2016 年 3 月 25 日 23:16 编辑
> 
> 马克艾默里 39k21170211

但是，它有一个警告，即在`RAND_MAX`( `RM`) 小于 1的任何情况下`N`（其中`N`= 可能的有效结果的数量）的倍数，都会丢弃一组有效的结果。

即，当“丢弃值的计数”( `D`) 等于 时`N`，它们实际上是有效集合 ( `V)`，而不是无效集合 ( `I`)。

`N`造成这种情况的原因是，Mark 在某些时候忽略了和之间的区别`Rand_Max`。

`N`是一个集合，其有效成员仅由正整数组成，因为它包含有效的响应计数。（例如：设置`N`= `{1, 2, 3, ... n }`）

`Rand_max`然而，是一个集合（根据我们的目的定义）包括任意数量的非负整数。

在它最通用的形式中，这里定义为`Rand Max`所有有效结果的集合，理论上可以包括负数或非数值。

因此`Rand_Max`，最好将其定义为“可能的响应”的集合。

然而`N`，对一组有效响应中的值的计数进行操作，因此即使在我们的特定情况下定义，`Rand_Max`它也将是一个比它包含的总数小一的值。

使用 Mark 的解决方案，值在以下情况下被丢弃：X => RM - RM % N

```
EG: 

Ran Max Value (RM) = 255
Valid Outcome (N) = 4

When X => 252, Discarded values for X are: 252, 253, 254, 255

So, if Random Value Selected (X) = {252, 253, 254, 255}

Number of discarded Values (I) = RM % N + 1 == N

 IE:

 I = RM % N + 1
 I = 255 % 4 + 1
 I = 3 + 1
 I = 4

   X => ( RM - RM % N )
 255 => (255 - 255 % 4) 
 255 => (255 - 3)
 255 => (252)

 Discard Returns $True 
```

正如您在上面的示例中所见，当 X（我们从初始函数中获得的随机数）的值为 252、253、254 或 255 时，即使这四个值包含一组有效的返回值，我们也会丢弃它.

**IE：当丢弃值的计数（I）= N（有效结果的数量）时，原始函数将丢弃一组有效的返回值。**

如果我们将值 N 和 RM 之间的差异描述为 D，即：

```
D = (RM - N) 
```

然后随着 D 的值变小，由于这种方法导致的不需要的重新滚动百分比在每个自然乘法处增加。（当 RAND_MAX 不等于质数时，这是值得关注的）

例如：

```
RM=255 , N=2 Then: D = 253, Lost percentage = 0.78125%

RM=255 , N=4 Then: D = 251, Lost percentage = 1.5625%
RM=255 , N=8 Then: D = 247, Lost percentage = 3.125%
RM=255 , N=16 Then: D = 239, Lost percentage = 6.25%
RM=255 , N=32 Then: D = 223, Lost percentage = 12.5%
RM=255 , N=64 Then: D = 191, Lost percentage = 25%
RM=255 , N= 128 Then D = 127, Lost percentage = 50% 
```

由于 N 越接近 RM 所需的 Rerolls 百分比就会增加，因此根据运行代码的系统的约束和正在查找的值，这对于许多不同的值可能是有效的关注点。

**为了否定这一点，我们可以做一个简单的修改如下所示：**

```
 int x;

 do {
     x = rand();
 } while (x > (RAND_MAX - ( ( ( RAND_MAX % n ) + 1 ) % n) );

 x %= n; 
```

这提供了一个更通用的公式版本，它解释了使用模数来定义最大值的额外特性。

**对 RAND_MAX 使用较小值的示例，该值是 N 的乘积。**

*标记'原始版本：*

```
RAND_MAX = 3, n = 2, Values in RAND_MAX = 0,1,2,3, Valid Sets = 0,1 and 2,3.
When X >= (RAND_MAX - ( RAND_MAX % n ) )
When X >= 2 the value will be discarded, even though the set is valid. 
```

*通用版本 1：*

```
RAND_MAX = 3, n = 2, Values in RAND_MAX = 0,1,2,3, Valid Sets = 0,1 and 2,3.
When X > (RAND_MAX - ( ( RAND_MAX % n  ) + 1 ) % n )
When X > 3 the value would be discarded, but this is not a vlue in the set RAND_MAX so there will be no discard. 
```

此外，在 N 应该是 RAND_MAX 中值的数量的情况下；在这种情况下，您可以设置 N = RAND_MAX +1，除非 RAND_MAX = INT_MAX。

循环方式你可以只使用 N = 1，但是任何 X 值都将被接受，并为你的最终乘数放入一个 IF 语句。但也许您的代码可能有正当理由在使用 n = 1 调用函数时返回 1...

因此，当您希望 n = RAND_MAX+1 时，最好使用 0，这通常会提供 Div 0 错误

**通用版本 2：**

```
int x;

if n != 0 {
    do {
        x = rand();
    } while (x > (RAND_MAX - ( ( ( RAND_MAX % n ) + 1 ) % n) );

    x %= n;
} else {
    x = rand();
} 
```

这两种解决方案都解决了当 RM+1 是 n 的乘积时会出现不必要的丢弃有效结果的问题。

当您需要 n 等于 RAND_MAX 中包含的总可能值集时，第二个版本还涵盖了边缘情况。

两者中的修改方法是相同的，并且允许更通用的解决方案来满足提供有效随机数和最小化丢弃值的需求。

重申：

**扩展标记示例的基本通用解决方案：**

```
// Assumes:
//  RAND_MAX is a globally defined constant, returned from the environment.
//  int n; // User input, or externally defined, number of valid choices.

 int x;

 do {
     x = rand();
 } while (x > (RAND_MAX - ( ( ( RAND_MAX % n ) + 1 ) % n) ) );

 x %= n; 
```

**允许另一种 RAND_MAX+1 = n 场景的扩展通用解决方案：**

```
// Assumes:
//  RAND_MAX is a globally defined constant, returned from the environment.
//  int n; // User input, or externally defined, number of valid choices.

int x;

if n != 0 {
    do {
        x = rand();
    } while (x > (RAND_MAX - ( ( ( RAND_MAX % n ) + 1 ) % n) ) );

    x %= n;
} else {
    x = rand();
} 
```

在某些语言（特别是解释型语言）中，在 while 条件之外进行比较操作的计算可能会导致更快的结果，因为无论需要多少次重试，这都是一次性计算。YMMV！

```
// Assumes:
//  RAND_MAX is a globally defined constant, returned from the environment.
//  int n; // User input, or externally defined, number of valid choices.

int x; // Resulting random number
int y; // One-time calculation of the compare value for x

y = RAND_MAX - ( ( ( RAND_MAX % n ) + 1 ) % n) 

if n != 0 {
    do {
        x = rand();
    } while (x > y);

    x %= n;
} else {
    x = rand();
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-06-13T09:54:11.537

使用模数有两个常见的抱怨。

*   一个适用于所有发电机。在极限情况下更容易看到。如果您的生成器的 RAND_MAX 为 2（不符合 C 标准）并且您只需要 0 或 1 作为值，则使用模数生成 0 的频率将是生成器生成 0 和 2 时的两倍生成 1（当生成器生成 1 时）。请注意，只要您不删除值，无论您使用的是从生成器值到所需值的映射，这都是正确的，其中一个的出现频率是另一个的两倍。

*   至少对于它们的某些参数，某种生成器的随机性较低，但遗憾的是这些参数具有其他有趣的特征（例如能够使 RAND_MAX 比 2 的幂小一）。这个问题是众所周知的，很长一段时间库实现可能会避免这个问题（例如，C 标准中的示例 rand() 实现使用这种生成器，但删除了 16 个不太重要的位），但有些人喜欢抱怨那你可能运气不好

使用类似的东西

```
int alea(int n){ 
 assert (0 < n && n <= RAND_MAX); 
 int partSize = 
      n == RAND_MAX ? 1 : 1 + (RAND_MAX-n)/(n+1); 
 int maxUsefull = partSize * n + (partSize-1); 
 int draw; 
 do { 
   draw = rand(); 
 } while (draw > maxUsefull); 
 return draw/partSize; 
} 
```

生成 0 和 n 之间的随机数将避免这两个问题（并且它避免了 RAND_MAX == INT_MAX 溢出）

顺便说一句，C++11 引入了归约和 rand() 之外的其他生成器的标准方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-11T10:06:46.737

如果`RAND_MAX`值为`3`（实际上它应该远高于该值，但偏差仍然存在），那么从这些计算中可以看出存在偏差：

`1 % 2 = 1` `2 % 2 = 0` `3 % 2 = 1` `random_between(1, 3) % 2 = more likely a 1`

在这种情况下，`% 2`当您想要一个介于`0`和之间的随机数时，您不应该这样做`1`。你可以通过这样做得到一个介于`0`和之间的随机数，因为在这种情况下：是 的倍数。`2``% 3``RAND_MAX``3`

**另一种方法**

有更简单的但要添加到其他答案，这是我的解决方案，以获得 和 之间的随机数`0`，`n - 1`因此`n`不同的可能性，没有偏见。

*   编码可能性的数量所需的位数（不是字节）是您需要的随机数据的位数
*   从随机位编码数字
*   如果此数字为`>= n`，则重新启动（不取模）。

真正的随机数据不容易获得，所以为什么要使用比需要更多的位。

下面是 Smalltalk 中的一个示例，使用来自伪随机数生成器的位缓存。我不是安全专家，所以使用风险自负。

```
next: n

    | bitSize r from to |
    n < 0 ifTrue: [^0 - (self next: 0 - n)].
    n = 0 ifTrue: [^nil].
    n = 1 ifTrue: [^0].
    cache isNil ifTrue: [cache := OrderedCollection new].
    cache size < (self randmax highBit) ifTrue: [
        Security.DSSRandom default next asByteArray do: [ :byte |
            (1 to: 8) do: [ :i |    cache add: (byte bitAt: i)]
        ]
    ].
    r := 0.
    bitSize := n highBit.
    to := cache size.
    from := to - bitSize + 1.
    (from to: to) do: [ :i |
        r := r bitAt: i - from + 1 put: (cache at: i)
    ].
    cache removeFrom: from to: to.
    r >= n ifTrue: [^self next: n].
    ^r 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-07-14T20:09:56.660

模减少是使随机整数生成器避免永远运行的最坏情况的常用方法。

然而，当可能的整数范围未知时，通常没有办法在不引入偏差的情况下“修复”这种永远运行的最坏情况。不仅模约归约（`rand() % n`在接受的答案中讨论过）会以这种方式引入偏差，还有 Daniel Lemire 的“乘法和移位”归约，或者如果您在一定次数的迭代后停止拒绝结果。（要清楚，这并不意味着没有办法解决伪随机生成器中存在的偏差问题。例如，即使模数和其他归约通常是有偏差的，如果可能的范围内，它们不会有偏差问题整数是 2 的幂，*如果*随机生成器产生无偏随机位或它们的块。）

该答案的其余部分将显示随机生成器中运行时间和偏差之间的关系。从这里开始，我们将假设我们有一个“真正的”随机生成器，它可以产生无偏且独立的随​​机位。*

1976 年，DE Knuth 和 AC Yao 表明，任何仅使用随机位以给定概率生成随机整数的算法都可以表示为二叉树，其中随机位指示遍历树和每个叶子（端点）的方式对应一个结果。在这种情况下，我们正在处理在 [0, n) 中生成随机整数的算法，其中每个整数的选择概率为 1/n。如果对于所有结果，树中出现相同数量的叶子，则该算法是*无偏的。*但是如果 1/n 有一个非终止的二进制展开式（如果 n 不是 2 的幂，就会出现这种情况），那么该算法只有在以下情况下才是无偏的——</p>

*   二叉树具有“无限”深度，或
*   二叉树最后包括“拒绝”叶子，

在任何一种情况下，算法都不会在恒定时间内运行，并且在最坏的情况下会永远运行。（另一方面，当`n`是 2 的幂时，最优二叉树将具有有限深度且没有拒绝节点。）

二叉树的概念还表明，任何“修复”这种最坏情况时间复杂度的方法通常都会导致偏差。（同样，这并不意味着没有办法解决伪随机生成器中存在的偏差问题。）例如，模约简相当于一棵二叉树，其中拒绝叶被标记的结果替换——但因为有更多可能结果比拒绝叶子，只有一些结果可以代替拒绝叶子，从而引入偏见。如果您在一定次数的迭代后停止拒绝，则会产生相同类型的二叉树 - 以及相同类型的偏差。（但是，根据应用程序，这种偏差可能可以忽略不计。随机整数生成也有安全方面的问题，在这个答案中讨论太复杂了。）

To illustrate, the following JavaScript code implements a random integer algorithm called the [Fast Dice Roller](https://arxiv.org/abs/1304.1916) by J. Lumbroso (2013). Note that it includes a rejection event and a loop which are necessary to make the algorithm unbiased in the general case.

```
function randomInt(minInclusive, maxExclusive) {
 var maxInclusive = (maxExclusive - minInclusive) - 1
 var x = 1
 var y = 0
 while(true) {
    x = x * 2
    var randomBit = (Math.random() < 0.5 ? 0 : 1)
    y = y * 2 + randomBit
    if(x > maxInclusive) {
      if (y <= maxInclusive) { return y + minInclusive }
      // Rejection
      x = x - maxInclusive - 1
      y = y - maxInclusive - 1
    }
 }
} 
```

### Note

* This answer won't involve the `rand()` function in C because it [has many issues](https://stackoverflow.com/questions/52869166/why-is-the-use-of-rand-considered-bad/52881465#52881465). Perhaps the most serious here is the fact that the C standard does not explicitly specify a particular distribution for the numbers returned by `rand()`, not even a uniform distribution.

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-04-15T02:19:03.210

正如[公认的答案](https://stackoverflow.com/a/10984975/111307)所表明的那样，“模偏差”的根源在于`RAND_MAX`. 他使用极小的值`RAND_MAX`(10) 来表明，如果 RAND_MAX 为 10，那么您尝试使用 % 生成介于 0 和 2 之间的数字，将产生以下结果：

```
rand() % 3   // if RAND_MAX were only 10, gives
output of rand()   |   rand()%3
0                  |   0
1                  |   1
2                  |   2
3                  |   0
4                  |   1
5                  |   2
6                  |   0
7                  |   1
8                  |   2
9                  |   0 
```

所以有 4 个 0 的输出（4/10 的机会），只有 3 个 1 和 2 的输出（每个 3/10 的机会）。

所以是有偏见的。较低的数字有更好的机会出来。

***`RAND_MAX`但这只是在很小的时候才表现得如此明显***。或者更具体地说，当您修改的数量与`RAND_MAX`.

比**循环**（效率极低，甚至不应该被建议）更好的解决方案是使用具有更大输出范围的 PRNG。[Mersenne Twister](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html)算法的最大输出为 4,294,967,295。因此，出于所有意图和目的这样做`MersenneTwister::genrand_int32() % 10`，将平均分配，并且模偏差效应将几乎消失。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2014-04-09T17:31:18.447

我刚刚为冯诺依曼的无偏硬币翻转方法编写了一个代码，理论上应该可以消除随机数生成过程中的任何偏差。更多信息可以在（[http://en.wikipedia.org/wiki/Fair_coin](http://en.wikipedia.org/wiki/Fair_coin)）找到

```
int unbiased_random_bit() {    
    int x1, x2, prev;
    prev = 2;
    x1 = rand() % 2;
    x2 = rand() % 2;

    for (;; x1 = rand() % 2, x2 = rand() % 2)
    {
        if (x1 ^ x2)      // 01 -> 1, or 10 -> 0.
        {
            return x2;        
        }
        else if (x1 & x2)
        {
            if (!prev)    // 0011
                return 1;
            else
                prev = 1; // 1111 -> continue, bias unresolved
        }
        else
        {
            if (prev == 1)// 1100
                return 0;
            else          // 0000 -> continue, bias unresolved
                prev = 0;
        }
    }
} 
```

# ruby - Ruby 无法检测到字符串中的换行符

> ID：10984978
> 
> 赞同：6
> 
> 时间：2012-06-11T17:44:20.730
> 
> 标签：ruby, string, newline

我有以下字符串，我想在那里检测换行符。但是 Ruby 的 string 方法`include?`无法检测到它。

我正在跑步`Ruby 1.9.2p290`。我哪里错了？

```
"/'ædres/ \nYour ".include?('\n')
 => false 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-11T17:46:27.717

`\n`需要在双引号字符串中，否则不会转义。

```
>> "\n".include? '\n'
=> false
>> "\n".include? "\n"
=> true 
```

# asp.net - 中继器控制中的条件逻辑？

> ID：10984979
> 
> 赞同：6
> 
> 时间：2012-06-11T17:44:22.290
> 
> 标签：asp.net, vb.net

在 ASP.NET 中，使用 VB，我如何在页面本身而不是在后面的代码中执行此操作？

```
<ItemTemplate>
    <%  If Container.DataItem("filename") <> "" Then
        <a href="/pdf/"><%# Container.DataItem("filename") %>Agenda</a>
    End If%>
</ItemTemplate> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T17:48:38.307

在您的数据源中创建一个布尔属性，例如 filenameExists 并使用它来对 HyperLink 的 Visible 属性进行数据绑定

```
<asp:HyperLink runat="server" Visible='<%# Eval("filenameExists ") %>' NavigateUrl="/pdf/">Agenda</asp:HyperLink> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T18:36:49.410

终于用这个了，谢谢大家的帮助！

在页面上：

```
<asp:Literal ID="ltPDF" runat="server" Visible='<%# showPDF(Container.DataItem("filename")) %>'>Test</asp:Literal> 
```

后面的代码：

```
 Function showPDF(ByVal pdf As String) As Boolean
    If pdf <> "" Then
        Return True
    Else
        Return False
    End If
End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T18:18:07.483

您缺少 and 的左括号`If`和右括号`End If`：

```
<ItemTemplate>
    <%  If Container.DataItem("filename") <> "" Then %>
        <a href="/pdf/"><%# Container.DataItem("filename") %>Agenda</a>
    <% End If %>
</ItemTemplate> 
```

# jquery - 我将如何制作一种堆积面积图？[jQuery、谷歌图表等]

> ID：10984981
> 
> 赞同：5
> 
> 时间：2012-06-11T17:44:24.793
> 
> 标签：jquery, charts, google-visualization

我有一些数据需要制作图表。问题是数据具有价格范围。其中一些价格之间有一些重叠。此外，所有价格范围都有非零值的上限和下限。

这是一张图片来解释我想要完成的事情： ![在此处输入图像描述](../Images/32190a7ff1c4734f8cd9c74f6a0f6f4f.png)

我一直在尝试找到适合我需要的 jQuery Chart 或 Google Chart，但到目前为止还无法做到。有些东西接近我正在寻找的东西，例如阶梯图，但它们都有诸如“没有重叠值”或“从零开始”之类的要求。我也在考虑使用烛台图，但您无法真正区分重叠区域，这对我的数据集很重要。

这是可用的吗？我只是看错地方了吗？提前感谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T12:00:29.283

我对这些类型的图表有相当多的经验。[请参阅我的网站](https://www.allepeilingen.com)的复杂示例。一个简化的解决方案可以这样编码：

```
<html>
  <head>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load('visualization', '1', {packages: ['corechart']});
    </script>
    <script type="text/javascript">
      function drawVisualization() {
        // Fill data object, first row contains legend text, which in 
        // this example contains the calculation rules. 
        var data = google.visualization.arrayToDataTable([
          ['Month', 'min(Dataset1)', 'max(Dataset1)-min(Dataset1)', 
           'min(Dataset2)-max(Dataset1)', 'max(Dataset2)-min(Dataset2)', 
           'min(Dataset3)-max(Dataset2)', 'max(Dataset3)-min(Dataset3)'],
          ['2004/05', 1, 2, 2, 2, 5,4],
          ['2005/06', 2, 3, 1, 1, 3,3],
          ['2006/07', 3, 4, 0, 2, 0,2],
          ['2007/08', 3, 4, -1, 2, -5,2],
          ['2008/09', 4, 4, -2, 3, -9,1]
        ]);

        // Create and draw the visualization.
        var ac = new google.visualization.AreaChart(
         document.getElementById('visualization'));
        ac.draw(data, {
          isStacked: true,
          chartArea:{left:"5%",top:"2%",width:"50%",height:"93%"}, 
          series: {
            0:{color: 'transparent'},
            2:{color: 'transparent'},
            4:{color: 'transparent'},
          }
        });
      }
      google.setOnLoadCallback(drawVisualization);
    </script>
  </head>
  <body>
    <div id="visualization" style="width: 600px; height: 400px;"></div>
  </body>
</html> 
```

我们在上面的代码中所做的是复制系列的数量。每个系列之前都会有一个透明系列层，其高度与前一个系列的距离一样。

简化解决方案的屏幕截图： ![简化解决方案的屏幕截图（如上所示的代码）](../Images/73fc8004d61fa1c8f02560db07cab788.png)

复杂解决方案的屏幕截图： ![在我的网站 allepeilingen.com 上实现的复杂解决方案的屏幕截图](../Images/e177fb816c6b954ebe223c269525f79f.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T22:11:07.803

好像你想做一些类似于可视化天气系列数据的事情，这就是我在过去几个小时里一直试图弄清楚的事情。

不能说我真的知道如何用 Google Charts 做你想做的事，但是[http://dygraphs.com/](http://dygraphs.com/)上的图书馆看起来真的很时髦。

从网站：

![堆积线图。](../Images/d13924ef51793ddfacf9fe5f850d2f6d.png)

# coldfusion - JRUN 进程占用 100% CPU

> ID：10984984
> 
> 赞同：1
> 
> 时间：2012-06-11T17:44:55.097
> 
> 标签：coldfusion, coldfusion-8, jrun

我们经常遇到 ColdFusion 8 的性能问题。在一个由 3 台前端服务器组成的场中，一台服务器不可用：由于某种原因，CPU 运行 100%（在一个核心上）并且从不停机。检查 Windows 任务管理器时，似乎 jrun 进程正在使用 100% 的 CPU。

有人知道如何开始排除故障吗？如何首先找出导致峰值的原因。我对 .net 更感兴趣，在 java/jrun 故障排除时感觉有点迷茫。

我们目前的配置是：CF 8 在 Windows 2008 R2 64 位上运行，带有 Oracle 11g 客户端，具有 4GB RAM 和双核 CPU。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T21:07:31.837

您是否使用客户端变量？三重检查您的代码，如果您确定它们不是在注册表中设置，而是在数据库中设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T14:19:14.530

如果它只有一台服务器，并且您确定代码库是相同的，我会进入 cfadmin 中的坏服务器和一台好的服务器，并逐行比较设置摘要。确保设置之间没有任何明显的差异。请特别注意 DB 驱动程序的版本。

您也没有提到服务器硬件配置是否相同。正如 Mark 指出的那样，4 gig RAM 可能不足以安装 64 位。内存很便宜。RAM 是你的朋友。获得更多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T05:20:05.267

看看这个问题

[奇怪的 JRUN 问题。JRUN 每两个小时消耗 50% 的内存](https://stackoverflow.com/questions/7498172/strange-jrun-issue-jrun-eating-up-50-of-memory-for-every-two-hours)

我定期面临 50% 的 CPU 使用率，这是由于存储在注册表中的客户端变量。即使您没有使用客户端变量，但由于在 Application.cfc/.cfm 文件中添加了设置，它在您不知情的情况下存储在注册表中。

还要尝试找出导致问题的线程并获取它的跟踪信息，这将有助于您对此进行更多调查。在上面链接的答案中，我发布了我的博客文章的链接，并解释了如何使用 visualvm 和 jconsole 来获取恶意线程的堆栈跟踪。

希望这有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T02:50:21.873

将需要更多信息。当您说 4 gigs 的 RAM 时，您的意思是 4Gig 堆，对吗？还是您实际上在运行 4Gig 64 位操作系统？如果是这样，您应该考虑获得更多。CF 64bit 使用 80% 以上的 RAM 来获得相同的效果 - 换句话说，2gig 64bit 堆大致相当于 1gig 32 位堆。

话虽如此，对于我们没有真正看过您的系统的任何人，我不会接受任何关于您的堆大小的全面建议。调优 JVM 需要真正的经验——但也需要对系统、预期流量等有实际的了解。

我的另一条评论是，您绝对应该检查客户端变量。1 个核心被占用的事实让我认为清除任务正在挂起（很可能是由于 Paul 所说的注册表中的客户端变量。或者可能是计划任务（cf 监视器或聚变反应堆可以帮助梳理请求）正在运行）。

还有另一个堆栈溢出线程，上面有一些额外的帮助。忽略所有堆栈跟踪内容并查看特定的“要检查的区域”。建立你要尝试的东西清单，然后按易于实施（或可能的原因）排序，并开始尝试消除清单中的可能性。

# jquery - 如何访问颜色框中的 jquery 函数形式

> ID：10984992
> 
> 赞同：0
> 
> 时间：2012-06-11T17:45:19.907
> 
> 标签：jquery, ajax, colorbox

我正在尝试从颜色框内通过 ajax 提交表单，但是当我提交表单时告诉我该功能不可用。需要帮助理解

/* 内部颜色框 */

```
<div id="messageform" style="display:none;">

<?php echo Form::open(); ?>

<?php echo Form::label('message', 'message'); ?> <br />
<?php echo Form::textarea('message', NULL,array('id'=>'messagecontent')); ?> <br />

<button id="sendmessage" onclick="sendmessage('<?= Auth::instance()->get_user(); ?>', '<?= $user->id; ?>', 'test message');">Send</button>

<?php echo Form::close(); ?>

</div> 
```

/* AJAX 函数位于 body close 之前*/

```
function sendmessage(user_id, to_id, message)
{
var loadUrl= '<?=url::base()?>message/send';

$.post(loadUrl,{uid: user_id, tid: to_id, message: message}, function(code){}); 
} 
```

我收到控制台未找到的“发送消息”

/* 打开彩盒 */

颜色框正在通过链接单击启动

```
$('.openmessagelink').click(function(){

$.colorbox({inline:true, width:"50%", open:true, href:"#messageform",
            onClosed: function() {
                 $('#messageform').hide();
            },
            onOpen: function() {
                 $('#messageform').show();
            }
           }); 

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:51:18.720

您的函数与 butrón id 具有相同的名称。

# ruby-on-rails - after_create 回调：闪烁消息

> ID：10984994
> 
> 赞同：0
> 
> 时间：2012-06-11T17:45:27.450
> 
> 标签：ruby-on-rails, callback, devise

在用户注册我的使用 Devise 的 Rails 3.2.3 应用程序后，会触发 after_create 回调，尝试创建组织记录。

如果`create`验证失败，我如何才能显示错误消息？我应该覆盖设计控制器吗？问题是，错误与组织的创建有关，而不是用户（我有一个非常普通的设计用户模型设置）。

我在用户模型中做这样的事情：

```
# after_create callback method
...
    unless new_org_user.save
      errors.add("Warning", "Organisation is invalid" )
    end
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:19:50.930

由于您在 after_create 回调中触发事件，因此记录已成功创建，因此不会出现任何闪烁消息。

为什么不尝试将其移至关系关联并要求验证孩子喜欢

```
class User < ActiveRecord::Base
  has_one :organization
  accepts_nested_attributes_for :organization
end

class Organization < ActiveRecord::Base
  belongs_to :user
end 
```

这样，如果组织无效，它将无法通过验证

# jquery - jQuery 滚动菜单动画不正确

> ID：10984995
> 
> 赞同：0
> 
> 时间：2012-06-11T17:45:29.330
> 
> 标签：jquery

我正在尝试调试其他人编写的这段 jQuery 代码，但没有取得多大成功。

基本上，它是一个下拉菜单，其中包含的项目比视图中的要多，因此有向上和向下箭头来滚动菜单。发生的情况是，在您向下滚动，然后鼠标移出，然后再次鼠标悬停后，动画会重复，而不是停留在菜单的底部。

我知道这里没有很多细节和代码，但它是一个非常大的应用程序的一部分，并且希望有一个明显的错误可以立即跳出来。有人有什么想法吗？提前致谢。

```
//Menu Scroll Up
            jQuery(this).children("div").children(".learn_more_menu_up").mouseover(function(){
                jQuery(this).siblings("ul").stop().animate({scrollTop: "-" + menuFullHeight}, menuScrollDuration);
                jQuery(this).mouseout(function(){
                    jQuery(this).siblings("ul").stop();
                });
            });

//Menu Scroll Down
            jQuery(this).children("div").children(".learn_more_menu_down").mouseover(function(){                    
                jQuery(this).siblings("ul").stop().animate({scrollTop: menuFullHeight}, menuScrollDuration);
                jQuery(this).mouseout(function(){
                    jQuery(this).siblings("ul").stop();
                });
            }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:17:29.717

从给定的代码中，每次将鼠标悬停在 .learn_more_menu_down 时，scrollTop 都会动画，因此您每次都应该看到动画。您需要检查菜单是否在底部，如果是，请不要做任何事情，如果不是，它应该只从您在菜单中的位置到底部进行动画处理。

如果您可以将我们链接到有问题的页面或有一些示例简化标记，这将有所帮助

# ruby-on-rails - ruby on rails 改变变量

> ID：10984997
> 
> 赞同：0
> 
> 时间：2012-06-11T17:45:36.797
> 
> 标签：ruby-on-rails, ruby

我在 ruby​​ on rails 中遇到问题。当用户访问/homepage/时，我想让当前用户的商店id为0，当用户访问/homepage/：id/时，我想让用户的商店id成为url中的输入id。

我的代码：

```
routes.rb:
  match "/homepage" => "users#access", :as => "store"
  match "/homepage/:id" => "users#homepage", :as => "store"

def access
  @user = current_user
  @user.update_attributes(:store => "0")
  @user.save
end

def homepagestore
  @user = current_user
  @user.update_attribute(:id, user.store = :id)
  @user.save
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:53:19.523

[update_attribute](http://apidock.com/rails/v3.2.1/ActiveRecord/Persistence/update_attribute)更新数据库中的记录。但它跳过了验证检查。[update_attributes](http://apidock.com/rails/ActiveRecord/Persistence/update_attributes)还更新（保存）数据库中的记录。它不会跳过验证。

所以：

1.  你应该`params[:id]`像塞尔吉奥所说的那样使用
2.  您可能想`update_attributes`改用它，因为它不会跳过验证检查
3.  如果您`save`使用`update_attribute`或`update_attributes`

我的建议：

```
def access
  @user = current_user
  @user.update_attributes(:store => "0")
end

def homepagestore
  @user = current_user
  @user.update_attributes(:store => params[:id])
end 
```

**添加**了 update_attributes 使用批量分配保护系统。因此，您需要 User 模型的 attr_accessible 调用中的 :store 字段以允许对其进行更改。或覆盖保护，请参阅 update_attributes 文档。询问您是否有更多问题。