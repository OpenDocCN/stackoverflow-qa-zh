# StackOverflow 问答 000059000-000059999

# asp.net - 在 ashx 处理程序的代码中强制实施 SSL

> ID：59000
> 
> 赞同：3
> 
> 时间：2008-09-12T13:42:29.127
> 
> 标签：asp.net, ssl

我有一个站点，其中包含几个 ashx 处理程序，在我想拒绝非 SSL 请求的几个处理程序上。有没有办法可以在代码中做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-12T13:47:03.360

如果您必须以编程方式执行此操作，我过去做过的一种方法是检查 url 并在其中查找“https”。如果您没有看到，请重定向。但是，Request.IsSecureConnection 应该是首选方法。您可能需要添加额外的逻辑来处理环回地址。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-12T13:50:52.693

我认为正确的方法是检查 Request.IsSecureConnection 属性并重定向或抛出，如果它是假的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-12T13:51:34.067

尝试使用 System.Web.HttpContext.Current.Request.IsSecureConnection 来验证它们是否安全连接，然后执行您想要的任何拒绝（返回错误消息或您的业务需要）。

# tortoisesvn - 如何在 TortoiseSVN 中使用启动提交挂钩来设置自定义日志条目？

> ID：59007
> 
> 赞同：2
> 
> 时间：2008-09-12T13:45:27.170
> 
> 标签：tortoisesvn

我想自动化 TortoiseSVN 作为提交过程的一部分。具体来说，我想为提交对话框动态创建一个日志条目。

我知道我可以从命令行或右键单击文件夹并选择 svncommit 来启动提交对话框。

我想使用启动提交挂钩来设置日志条目。我认为这可以通过在 MESSAGEFILE 变量中传递一个条目文件名来实现，但是当我添加一个挂钩脚本时，它看不到这个变量（在右键单击并选择 svncommit 后挂钩成功启动）。

当我尝试使用命令行时，我使用了 /logmsgfile 参数，但它似乎没有效果。

我正在使用 tortoisesvn 1.5.3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-12T15:40:52.820

看起来这是我自己对由问题引起的API的误解。

解决方案：
1) 我使用右键菜单设置区域中的钩子 gui 向 TortoiseSVN 添加了一个启动提交钩子脚本。

2) 脚本接收 3 条信息： PATH MESSAGEFILE CWD
详情请参阅：[手册](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-bugtracker.html "手动的")
这些作为命令行参数传递给脚本 - 出于某种原因，我认为它们被设置为临时环境变量。

然后，我的脚本只需打开第二个参数指定的文件并添加自定义文本。

当提交对话框出现时，自定义文本就在那里。

3) 如果 tortoisesvn 是从脚本直接启动到提交对话框中最好的：
例如 [ tortoiseproc /command:commit /path:。/closeonend:1 ]
钩子仍然被调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T15:50:24.980

如果您只需要一个静态模板，请设置 tsvn:logtemplate 属性。

对于动态生成，/logmsgfile 参数确实有效，但它似乎需要完整路径。如下所示的批处理文件可能对您有用。

```
GenerateLogMsg.exe > tmp.msg
"C:\Program Files\TortoiseSVN\bin\TortoiseProc.exe" /command:commit /path:. /logmsgfile:"C:\Documents and Settings\User\My Documents\Visual Studio Projects\Project\tmp.msg" 
```

# .net - 如何检查 .NET 应用程序在哪个语言环境下运行，而无需访问其源代码？

> ID：59013
> 
> 赞同：0
> 
> 时间：2008-09-12T13:47:34.310
> 
> 标签：.net, sql-server, windows, locale

上下文：我负责运行一个用 .NET 编写的服务。专有应用程序。它使用 SQL Server 数据库。它作为本地计算机中管理员组的用户成员运行。在我将机器添加到域之前它工作正常。

因此，我将机器添加到域（Win 2003）并将用户更改为 Power Users 组的成员，现在，

问题：它试图执行的一些 SQL 语句在西班牙语本地化中是“神奇的”（其中 , 分隔浮点数而不是 .），从而导致错误。

> INSERT 语句中的列数少于 VALUES 子句中指定的值。VALUES 子句中的值数必须与 INSERT 语句中指定的列数相匹配。在 System.Data.SqlClient.SqlConnection.OnError（SqlException 异常，布尔 breakConnection）

机器中的操作系统和区域设置为英文。我问了应用程序的提供者，他说：

> 看起来您组合了在西班牙语言环境下运行的代码和在英语语言环境下运行的 SQL 服务器。所以 SQL 需要 '15.28' 而不是 '15,28'

在各个级别对我来说都是错误的（SQL Server 如何区分逗号分隔参数和属于浮点数的逗号？）。

因此，代码似乎从某个地方获取了西班牙语言环境，我不知道它是作为它运行的用户，还是其他地方（可能是全局策略？）。但问题是

在机器/用户/域的基础上定义本地化的地方是什么？

我不知道我必须寻找罪魁祸首的所有地方，所以请帮助我找到它！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-12T14:02:34.070

.NET 中有两种类型的本地化，两种文化的设置都可以在这些变量中找到（在机器上启动一个 .NET 命令行应用程序来查看它的内容）：

System.Thread.CurrentThread.CurrentCulture & System.Thread.CurrentThread.CurrentUICulture

[http://msdn.microsoft.com/en-us/library/system.threading.thread_members.aspx](http://msdn.microsoft.com/en-us/library/system.threading.thread_members.aspx)

它们与控制面板中的设置相关（在区域设置部分）。创建一个 .NET 命令行应用程序，然后只需对上述属性调用 ToString()，它应该会告诉您要查看哪个属性。

**编辑：**

事实证明，每个用户的语言环境设置都保存在这里：

```
HKEY_CURRENT_USER\Control Panel\International 
```

可能值得检查具有西班牙语言环境的用户的注册表，并将其与设置为美国或您需要的任何语言环境的用户进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T14:02:26.677

您可以在执行代码的线程上下文中设置它。

System.Threading.Thread.CurrentThread.CurrentCulture

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T14:21:35.227

太好了，我创建了控制台应用程序，确实，该应用程序并不疯狂，CurrentCulture 是西班牙语，但仅限于那台机器上的那个用户。如果我以另一个用户身份运行控制台应用程序，它将返回所有文化的英语。

我应该打开一个新问题，询问用户明智的语言环境设置在哪里？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T14:35:52.320

好吧，如果它是特定于用户的，请查看*区域和语言选项*控制面板。

<rant>顺便说一句，开发人员在使用字符串时没有文化意识。</rant>

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T14:42:50.057

找出为什么它只发生在那台机器上。这是我唯一实际使用该用户登录的地方，然后域控制器将区域设置设置为西班牙语。

# oop - 开放/封闭原则背后的含义和推理是什么？

> ID：59016
> 
> 赞同：55
> 
> 时间：2008-09-12T13:48:42.403
> 
> 标签：oop, definition, solid-principles, design-principles, open-closed-principle

开放/封闭原则指出软件实体（类、模块等）应该对扩展开放，但对修改关闭。这是什么意思，为什么它是良好的面向对象设计的重要原则？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-09-12T14:01:30.640

这意味着您应该将新代码放入新的类/模块中。现有代码应仅用于错误修复。新类可以通过继承重用现有代码。

开放/封闭原则旨在降低引入新功能时的风险。由于您不修改现有代码，因此可以确保它不会被破坏。它降低了维护成本并提高了产品稳定性。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-09-12T16:21:56.823

具体来说，它是关于 OOP 中设计的“圣杯”，即使实体具有足够的可扩展性（通过其单独的设计或通过其参与架构）以支持未来不可预见的变化，而无需重写其代码（有时甚至无需重新编译） **)。

实现这一点的一些方法包括多态/继承、组合、控制反转（又名 DIP）、面向方面的编程、诸如策略、访问者、模板方法等模式，以及 OOAD 的许多其他原则、模式和技术。

** 见6“包原则”，[REP、CCP、CRP、ADP、SDP、SAP](http://www.butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-12T14:01:43.447

比 DaveK 更具体地说，它通常意味着如果你想添加额外的功能，或者改变一个类的功能，创建一个子类而不是改变原来的。这样，任何使用父类的人都不必担心它以后会发生变化。基本上，这都是关于向后兼容性的。

面向对象设计的另一个非常重要的原则是通过方法接口松散耦合。如果您要进行的更改不影响现有界面，那么更改确实非常安全。例如，使算法更有效。面向对象的原则也需要通过常识来调和 :)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-07-04T20:33:40.027

> 软件实体应该对扩展开放但对修改关闭

这意味着任何类或模块都应该以可以按原样使用，可以扩展但不能修改的方式编写

## Javascript中的错误示例

```
var juiceTypes = ['Mango','Apple','Lemon'];
function juiceMaker(type){
    if(juiceTypes.indexOf(type)!=-1)
        console.log('Here is your juice, Have a nice day');
    else
        console.log('sorry, Error happned');
}

exports.makeJuice = juiceMaker; 
```

现在如果你想添加另一种果汁类型，你必须编辑模块本身，这样我们就破坏了 OCP 。

## Javascript中的好例子

```
var juiceTypes = [];
function juiceMaker(type){
    if(juiceTypes.indexOf(type)!=-1)
        console.log('Here is your juice, Have a nice day');
    else
        console.log('sorry, Error happned');
}
function addType(typeName){
    if(juiceTypes.indexOf(typeName)==-1)
        juiceTypes.push(typeName);
}
function removeType(typeName){
  let index = juiceTypes.indexOf(typeName)
    if(index!==-1)
        juiceTypes.splice(index,1);
}

exports.makeJuice = juiceMaker;
exports.addType = addType;
exports.removeType = removeType; 
```

现在，您可以从模块外部添加新的果汁类型，而无需编辑相同的模块。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2020-04-17T11:24:48.580

**开闭原则在面向对象编程**中非常重要，是**SOLID**原则之一。

> *根据这个，一个类应该对扩展开放，对修改关闭。让我们理解为什么。*

```
class Rectangle {
    public int width;
    public int lenth;
}

class Circle {
    public int radius;
}

class AreaService {
    public int areaForRectangle(Rectangle rectangle) {
        return rectangle.width * rectangle.lenth;
    }

    public int areaForCircle(Circle circle) {
        return (22 / 7) * circle.radius * circle.radius;
    }
} 
```

> *如果你看上面的设计，我们可以清楚地观察到它没有遵循**Open/Closed 原则**。每当有新的形状（Tiangle、Square 等）时，必须修改**AreaService 。***

**采用开/关原则：**

```
interface Shape{
    int area();
}

class Rectangle implements Shape{
    public int width;
    public int lenth;

    @Override
    public int area() {
        return lenth * width;
    }
}

class Cirle implements Shape{
    public int radius;

    @Override
    public int area() {
        return (22/7) * radius * radius;
    }
}

class AreaService {
    int area(Shape shape) {
        return shape.area();
    }
} 
```

> *每当有三角形、正方形等新形状时，您都可以轻松适应新形状，而无需修改现有类。通过这种设计，我们可以确保现有代码不会产生影响。*

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-12T13:53:20.207

这是脆弱的基类问题的答案，它表示对基类的看似无辜的修改可能会对依赖于先前行为的继承者产生意想不到的后果。因此，您必须小心封装您不希望依赖的内容，以便派生类遵守基类定义的协定。一旦继承者存在，你必须*非常*小心你在基类中所做的更改。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-10-26T13:01:39.660

让我们将问题分解为三个部分，以便更容易理解各种概念。

* * *

## 开闭原则背后的推理

考虑下面代码中的示例。不同的车辆以不同的方式进行维修。因此，我们有不同的类`Bike`，`Car`因为服务 a 的策略与服务 a`Bike`的策略不同`Car`。该`Garage`课程接受各种车辆进行维修。

**刚性问题**

观察代码，看看`Garage`类在引入新功能时如何表现出僵化的迹象：

```
class Bike {
    public void service() {
        System.out.println("Bike servicing strategy performed.");
    }
}

class Car {
    public void service() {
        System.out.println("Car servicing strategy performed.");
    }
}

class Garage {
    public void serviceBike(Bike bike) {
        bike.service();
    }

    public void serviceCar(Car car) {
        car.service();
    }
} 
```

正如您可能已经注意到的那样，每当需要维修一些新车时`Truck`，`Bus`都`Garage`需要修改 will 以定义一些新方法，例如`serviceTruck()`和`serviceBus()`。这意味着`Garage`班级必须了解所有可能的车辆，例如、`Bike`、`Car`等。因此，它对修改的开放性违反了开闭原则。而且它不开放扩展，因为要扩展新功能，我们需要修改类。`Bus``Truck`

* * *

## 开闭原则背后的意义

**抽象**

为了解决上面代码中的刚性问题，我们可以使用开闭原则。这意味着我们需要`Garage`通过删除它所知道的每辆车的服务实现细节来让这个类变得愚蠢。换句话说，我们应该为每个具体类型（如`Bike`和）抽象出服务策略的实现细节`Car`。

为了抽象出各种类型车辆的服务策略的实现细节，我们使用了一个`interface`被调用的方法，`Vehicle`并在其中有一个抽象方法`service()`。

**多态性**

同时，我们也希望`Garage`类能够接受*多种形式*的车辆，比如`Bus`，`Truck`等等，而不仅仅是`Bike`和`Car`。为此，开闭原则使用*多态性*（多种形式）。

为了让`Garage`类接受多种形式的`Vehicle`，我们将其方法的签名更改`service(Vehicle vehicle) { }`为接受接口而不是像等`Vehicle`的实际实现。我们还从类中删除了多个方法，因为只有一个方法将接受多种形式。`Bike``Car`

```
interface Vehicle {
    void service();
}

class Bike implements Vehicle {
    @Override
    public void service() {
        System.out.println("Bike servicing strategy performed.");
    }
}

class Car implements Vehicle {
    @Override
    public void service() {
        System.out.println("Car servicing strategy performed.");
    }
}

class Garage {
    public void service(Vehicle vehicle) {
        vehicle.service();
    }
} 
```

* * *

## 开闭原则的重要性

**关闭进行修改**

正如您在上面的代码中看到的那样，现在`Garage`该类已关闭以进行修改，因为它现在不了解各种类型车辆的服务策略的实现细节，并且可以接受任何类型的 new `Vehicle`. 我们只需要从`Vehicle`接口扩展新车辆并将其发送到`Garage`. 就是这样！我们不需要更改`Garage`类中的任何代码。

另一个对修改关闭的实体是我们的`Vehicle`接口。我们不必更改界面来扩展我们软件的功能。

**开放扩展**

现在，`Garage`该类在将支持新类型的上下文中对扩展开放`Vehicle`，无需修改。

我们的`Vehicle`接口对扩展是开放的，因为要引入任何新的车辆，我们可以从`Vehicle`接口扩展并提供一个新的实现以及为该特定车辆提供服务的策略。

**策略设计模式**

你注意到我多次使用了*策略这个词吗？*那是因为这也是策略设计模式的一个例子。`Vehicle`我们可以通过扩展实现不同的策略来服务不同类型的s。例如，服务 a`Truck`的策略与服务 a 的策略不同`Bus`。所以我们在不同的派生类中实现这些策略。

策略模式允许我们的软件随着需求随时间的变化而灵活变化。每当客户改变他们的策略时，只需为其派生一个新类并将其提供给现有组件，无需更改其他内容！开闭原则在实现这一模式中起着重要作用。

* * *

就是这样！希望有帮助。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-12T13:54:07.087

该原则意味着添加新功能应该很容易，而无需更改现有的、稳定的和经过测试的功能，从而节省时间和金钱。

通常，多态性，例如使用接口，是实现这一目标的好工具。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-16T21:17:34.627

符合 OCP 的另一个经验法则是使基类相对于派生类提供的功能抽象。或者正如 Scott Meyers 所说的“使非叶类抽象化”。

这意味着在基类中有未实现的方法，并且只在本身没有子类的类中实现这些方法。然后基类的客户端不能依赖基类中的特定实现，因为没有。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-07-28T20:05:40.460

S O LID 原则中的开放封闭**原则**的**目的**是

1.  降低业务变更需求的成本。
2.  减少对现有代码的测试。

> 开放封闭原则指出，在添加新功能时，我们应该尽量不要更改现有代码。这基本上意味着现有代码应该对扩展开放，对修改关闭（除非现有代码中存在错误）。在添加新功能的同时更改现有代码需要再次测试现有功能。

让我通过 AppLogger util 类来解释这一点。

假设我们需要将应用程序范围的错误记录到名为 Firebase 的在线工具中。因此，我们创建了下面的类，并在 1000 多个地方使用它来记录 API 错误、内存不足错误等。

```
open class AppLogger {

    open fun logError(message: String) {
        // reporting error to Firebase
        FirebaseAnalytics.logException(message)
    }
} 
```

假设一段时间后，我们将支付功能添加到应用程序中，并且有一个新要求指出，只有与支付相关的错误，我们必须使用一个名为 Instabug 的新报告工具，并且还像以前一样继续向 Firebase 报告所有功能的错误，包括支付。

现在我们可以通过在现有方法中添加 if else 条件来实现这一点

```
fun logError(message: String, origin: String) {
    if (origin == "Payment") {
        //report to both Firebase and Instabug
        FirebaseAnalytics.logException(message)
        InstaBug.logException(message)
    } else {
        // otherwise report only to Firebase
        FirebaseAnalytics.logException(message)
    }
} 
```

这种方法的问题在于它违反了**单一**责任原则，该原则指出一个方法应该只做一件事。另一种说法是*方法应该只有一个改变的理由*。使用这种方法，这种方法有两个改变的原因（if & else 块）。

更好的方法是通过继承现有的 Logger 类来创建一个新的 Logger 类，如下所示。

```
class InstaBugLogger : AppLogger() {

    override fun logError(message: String) {
        super.logError(message) // This uses AppLogger.logError to report to Firebase.
        InstaBug.logException(message) //Reporting to Instabug
    }
} 
```

现在我们要做的就是在支付功能中使用 InstaBugLogger.logError() 将错误记录到 Instabug 和 Firebase。通过这种方式，我们将新错误报告要求的测试减少/隔离为仅支付功能，因为代码更改仅在支付功能中完成。其余的应用程序功能不需要测试，因为没有对现有 Logger 进行任何代码更改。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-08T13:59:19.213

我只想强调，“Open/Closed”虽然在 OO 编程中显然很有用，但在开发的各个方面都是一种健康的方法。例如，根据我自己的经验，在使用普通 C 时尽可能使用“打开/关闭”是一种很好的止痛药。

/罗伯特

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-12T13:50:30.947

这意味着 OO 软件应该建立在其基础之上，而不是从本质上改变。这很好，因为它确保了基类的可靠、可预测的性能。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-05-18T20:23:51.377

我最近对这个原则的含义有了一个额外的想法：开闭原则立即描述了一种编写代码的方式，以及以一种有弹性的方式编写代码的最终结果。

我喜欢将 Open/Closed 分为两个密切相关的部分：

*   **开放**更改的代码可以更改其行为以正确处理其输入，或者需要最少的修改以提供新的使用场景。
*   如果有任何人工干预来处理新的使用场景，则**关闭**以进行修改的代码不需要太多。这种需求根本不存在。

因此，表现出开放/封闭行为的代码（或者，如果您愿意，满足开放/封闭原则）需要极少或不需要修改以响应超出其最初构建目的的使用场景。

就执行而言？我发现通常所说的解释，“打开/关闭是指代码是多态的！” 充其量是一个不完整的陈述。代码中的多态是实现这种行为的一种工具。继承、实现……真的，每一个面向对象的设计原则对于编写具有该原则所暗示的方式的弹性代码都是必要的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-12-23T06:13:32.760

在设计原则中，SOLID——“SOLID”中的“O”代表开/关原则。

开放封闭原则是一种设计原则，即类、模块和函数应该对扩展开放，对修改关闭。

该原则指出，代码的设计和编写应该以一种在现有代码（测试代码）中添加新功能的方式进行。设计应该以允许添加新功能作为新类的方式完成，尽可能保持现有代码不变。

开放封闭设计原则的好处：

1.  应用程序将更加健壮，因为我们没有更改已经测试过的类。
2.  灵活，因为我们可以轻松满足新要求。
3.  易于测试且不易出错。

我的博客文章：

[http://javaexplorer03.blogspot.in/2016/12/open-closed-design-principle.html](http://javaexplorer03.blogspot.in/2016/12/open-closed-design-principle.html)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-08-03T10:42:23.233

开闭原则有两个版本。

请参阅以下内容以获得对两者的清晰透彻的解释：[https ://www.slideshare.net/pjschwarz/first-expedia-tech-know-how-event-the-openclosed-principle-the-original-version-and-当代版本](https://www.slideshare.net/pjschwarz/first-expedia-tech-know-how-event-the-openclosed-principle-the-original-version-and-the-contemporary-version)

为了激发您的兴趣，以下是前几张幻灯片的屏幕截图：

[![在此处输入图像描述](https://i.stack.imgur.com/SQauo.jpg)](https://i.stack.imgur.com/SQauo.jpg) [![在此处输入图像描述](https://i.stack.imgur.com/9eNIY.jpg)](https://i.stack.imgur.com/9eNIY.jpg) [![在此处输入图像描述](https://i.stack.imgur.com/OaXqw.jpg)](https://i.stack.imgur.com/OaXqw.jpg) [![在此处输入图像描述](https://i.stack.imgur.com/kUCBf.jpg)](https://i.stack.imgur.com/kUCBf.jpg)

# passwords - 替换应用程序的纯文本密码

> ID：59022
> 
> 赞同：6
> 
> 时间：2008-09-12T13:50:42.990
> 
> 标签：passwords

我们目前正在为我们拥有的网络应用程序存储纯文本密码。

我一直提倡使用密码散列，但另一位开发人员说这会不太安全——更多的密码可以匹配散列，字典/散列攻击会更快。

这个论点有任何道理吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-12T13:54:20.160

绝对没有。但这没关系。我之前也发过类似的回复：

不幸的是，人们，甚至是程序员，都太情绪化了，不容易被争论所左右。一旦他投资于他的职位（而且，如果你在这里发帖，他就是）你不可能仅凭事实说服他。你需要做的是转换举证责任。你需要让他出去寻找他希望能说服你的数据，并在这样做的过程中了解真相。不幸的是，他有现状的好处，所以你有一条艰难的道路。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-12T13:56:56.610

来自[维基百科](http://en.wikipedia.org/wiki/Password)

> 一些计算机系统将用户密码存储为明文，用于比较用户登录尝试。如果攻击者获得对此类内部密码存储的访问权限，则所有密码以及所有用户帐户都将受到威胁。如果某些用户对不同系统上的帐户使用相同的密码，那么这些帐户也会受到损害。
> 
> 更安全的系统以加密保护的形式存储每个密码，因此对于获得系统内部访问权限的窥探者来说，访问实际密码仍然很困难，同时验证用户访问尝试仍然是可能的。
> 
> 一种常见的方法仅存储明文密码的“散列”形式。当用户在这样的系统上输入密码时，密码处理软件会运行加密散列算法，如果用户输入生成的散列值与密码数据库中存储的散列值匹配，则允许用户访问。哈希值是通过将加密哈希函数应用于由提交的密码和通常称为盐的另一个值组成的字符串来创建的。salt 可防止攻击者为常用密码构建哈希值列表。MD5 和 SHA1 是常用的加密散列函数。

您可以在该页面上阅读有关该主题的更多内容。在我看来，在我阅读和使用的所有内容中，散列是一个更好的方案，除非您使用非常小的（< 256 位）算法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-12T13:53:30.003

绝对没有理由在 Web 应用程序上保留纯文本密码。使用带有盐值的标准散列算法（SHA-1，而不是 MD5！），这样彩虹攻击就不可能了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-12T13:55:02.620

如果你不加盐你的密码，你怀疑彩虹表攻击（预编译字典对给定的哈希有有效的输入）

如果您以明文形式存储密码，则其他开发人员应该停止谈论安全性并开始阅读有关安全性的内容。

冲突是可能的，但对于密码应用程序来说通常不是一个大问题（它们主要是在使用哈希作为验证文件完整性的方式的领域中的问题）。

所以：给你的密码加盐（通过在密码的右侧添加盐*）并使用良好的散列算法，如 SHA-1，或者最好是 SHA-256 或 SHA-512。

[PS：这里](https://stackoverflow.com/questions/415/decode-email-address-from-gravatar-hash#738)有更多关于哈希的细节。

*我有点不确定 Salt 应该放在字符串的开头还是结尾。问题是，如果您有冲突（具有相同哈希的两个输入），将 Salt 添加到“错误”一侧不会更改生成的哈希。无论如何，Rainbow Tables 不会有大问题，只有碰撞

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-12T13:55:23.557

我不明白您的其他开发人员如何“更多密码可以匹配哈希”。

有一种说法是“散列攻击会更快”，但前提是你没有在密码被散列时加盐。通常，散列函数允许您提供盐，这使得使用已知的散列表成为浪费时间。

就个人而言，我会说“不”。基于上述情况，以及如果您确实以某种方式获得了明文公开，那么加盐的散列值对于试图进入的人来说几乎没有价值。散列还提供了使所有密码“看起来”的好处相同的长度。

即，如果散列任何字符串总是产生 20 个字符的散列，那么如果您只需要查看散列，您就无法判断原始密码是 8 个字符还是 16 个字符。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-12T13:59:45.823

我在工作场所遇到了同样的问题。为了让他相信散列更安全，我所做的就是编写一个 SQL 注入，从我们网站的公共部分返回用户和密码列表。它立即升级为一个主要的安全问题:)

为防止字典/哈希攻击，请务必针对每个用户唯一且静态的令牌进行哈希处理（用户名/加入日期/用户 GUID 效果很好）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-12T15:19:35.150

关于程序员伪装成密码学家有句老话 :)

Jeff Atwood 有一篇关于这个主题的好帖子：[你可能错误地存储了密码](http://www.codinghorror.com/blog/archives/000953.html)

为了更广泛地回答，我同意上述所有内容，哈希*在理论上*更容易获取用户的密码，因为多个密码匹配相同的哈希。但是，与访问您的数据库的人相比，这种情况发生的可能性要小得多。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-12T13:58:31.943

事实是，如果你散列一些东西，是的，会有冲突，所以两个不同的密码可以解锁同一个帐户。

但从实际的角度来看，这是一个糟糕的论点——一个好的散列函数（md5 或 sha1 就可以了）几乎可以保证对于所有有意义的字符串，尤其是短字符串，不会发生冲突。即使有，为一个帐户匹配两个密码也不是什么大问题——如果有人能够以足够快的速度随机猜出密码，以至于他们很可能能够进入，那么你就有更大的问题了。

我认为以纯文本形式存储密码比密码匹配中的哈希冲突带来更大的安全风险。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-12T13:52:54.513

我不是安全专家，但我有一种感觉，如果纯文本更安全，那么一开始就不会存在散列。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-12T13:56:15.817

理论上，是的。密码可以比散列更长（更多信息），因此存在散列冲突的可能性。然而，大多数攻击都是基于字典的，碰撞的概率比成功的直接匹配要小得多。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-12T13:59:27.337

这取决于你要防御什么。如果是攻击者拉下您的数据库（或诱骗您的应用程序显示数据库），那么明文密码是无用的。有许多攻击依赖于说服应用程序泄露它的私有数据——SQL 注入、会话劫持等。通常最好不要保留数据，而是保留散列版本，这样坏人就不能轻易使用它.

正如您的同事所建议的那样，这可以通过对字典运行相同的哈希算法并使用彩虹表来提取信息来轻松解决。通常的解决方案是使用秘密盐加上额外的用户信息来使散列结果独一无二 - 例如：

```
String hashedPass=CryptUtils.MD5("alsdl;ksahglhkjfsdkjhkjhkfsdlsdf" + user.getCreateDate().toString() +  user.getPassword); 
```

只要你的盐是秘密的，或者你的攻击者不知道用户记录的精确创建日期，字典攻击就会失败——即使他们能够拉下密码字段。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-12T14:27:47.520

没有什么比存储纯文本密码更安全的了。如果您使用的是不错的散列算法（至少 SHA-256，但即使 SHA-1 也比没有好），那么是的，冲突是可能的，但没关系，因为给定散列，不可能*计算出什么字符串散列到它。如果您使用密码对用户名进行哈希处理，那么这种可能性也会消失。

* - 技术上并非不可能，但“计算上不可行”

如果用户名是“graeme”，密码是“stackoverflow”，则创建一个字符串“graeme-stackoverflow-1234”，其中 1234 是一个随机数，然后对其进行哈希处理并将“ *hashoutput* 1234”存储在数据库中。在验证密码时，获取用户名、提供的密码和存储值末尾的数字（哈希具有固定长度，因此您始终可以这样做）并将它们哈希在一起，并将其与哈希进行比较部分储值。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-12T13:56:22.353

> 更多的密码可以匹配散列，字典/散列攻击会更快。

是和不是。使用现代散列算法，如 SHA 变体，并且该论点变得非常非常周。如果暴力攻击只需要 352 年而不是 467 年，你真的需要担心吗？（那里的轶事笑话。）获得的价值（没有以纯文本形式存储在系统上的密码）远远超过了您同事的关注。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-17T14:41:39.503

希望您原谅我插入我在此编写的解决方案，使用客户端 JavaScript 在传输密码之前对其进行哈希处理：http: [//blog.asgeirnilsen.com/2005/11/password-authentication-without.html](http://blog.asgeirnilsen.com/2005/11/password-authentication-without.html)

# sql - 如何在 MsSQL 中进行简单的“查找和替换”？

> ID：59044
> 
> 赞同：90
> 
> 时间：2008-09-12T13:56:30.357
> 
> 标签：sql, sql-server

问题很容易解释。我想做一个简单的查找和替换，就像你在我的数据库列中的数据的文本编辑器中一样（这是 MS Windows server 2003 上的 MsSQL）

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2008-09-12T13:59:36.777

以下查询将每个`a`字符替换为一个`b`字符。

```
UPDATE 
    YourTable
SET 
    Column1 = REPLACE(Column1,'a','b')
WHERE 
    Column1 LIKE '%a%' 
```

这不适用于 SQL Server 2003。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-12T13:59:51.503

像这样：

```
BEGIN TRANSACTION; 
UPDATE table_name
  SET column_name=REPLACE(column_name,'text_to_find','replace_with_this'); 
COMMIT TRANSACTION; 
```

示例：将 <script... 替换为 <a ... 以消除 javascript 漏洞

```
BEGIN TRANSACTION; UPDATE testdb
SET title=REPLACE(title,'script','a'); COMMIT TRANSACTION; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-03-14T17:47:21.023

这为我指明了正确的方向，但我有一个源自 MSSQL 2000 的数据库，并且仍在使用`ntext`我要替换的列的数据类型。当您尝试在该类型上运行 REPLACE 时，您会收到以下错误：

> 参数数据类型 ntext 对于替换函数的参数 1 无效。

如果您的列数据适合，最简单的解决`nvarchar`方法是在替换期间强制转换列。[从接受的答案](https://stackoverflow.com/a/59055/108348)中借用代码：

```
UPDATE YourTable
SET Column1 = REPLACE(cast(Column1 as nvarchar(max)),'a','b')
WHERE Column1 LIKE '%a%' 
```

这对我来说非常有效。感谢[这个论坛帖子](http://www.sqlservercentral.com/Forums/FindPost316385.aspx)，我找到了修复程序。希望这对其他人有帮助！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-23T13:36:56.543

## 以下将在您连接到的实例上的每个表上的每个数据库（不包括系统数据库）中查找并替换一个字符串：

只需更改`'Search String'`为您寻求`'Replace String'`的任何内容以及您想要替换的任何内容。

```
--Getting all the databases and making a cursor
DECLARE db_cursor CURSOR FOR  
SELECT name 
FROM master.dbo.sysdatabases 
WHERE name NOT IN ('master','model','msdb','tempdb')  -- exclude these databases

DECLARE @databaseName nvarchar(1000)
--opening the cursor to move over the databases in this instance
OPEN db_cursor
FETCH NEXT FROM db_cursor INTO @databaseName   

WHILE @@FETCH_STATUS = 0   
BEGIN
    PRINT @databaseName
    --Setting up temp table for the results of our search
    DECLARE @Results TABLE(TableName nvarchar(370), RealColumnName nvarchar(370), ColumnName nvarchar(370), ColumnValue nvarchar(3630))

    SET NOCOUNT ON

    DECLARE @SearchStr nvarchar(100), @ReplaceStr nvarchar(100), @SearchStr2 nvarchar(110)
    SET @SearchStr = 'Search String'
    SET @ReplaceStr = 'Replace String'
    SET @SearchStr2 = QUOTENAME('%' + @SearchStr + '%','''')

    DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128)
    SET  @TableName = ''

    --Looping over all the tables in the database
    WHILE @TableName IS NOT NULL
    BEGIN
        DECLARE @SQL nvarchar(2000)
        SET @ColumnName = ''
        DECLARE @result NVARCHAR(256)
        SET @SQL = 'USE ' + @databaseName + '
            SELECT @result = MIN(QUOTENAME(TABLE_SCHEMA) + ''.'' + QUOTENAME(TABLE_NAME))
            FROM    [' + @databaseName + '].INFORMATION_SCHEMA.TABLES
            WHERE       TABLE_TYPE = ''BASE TABLE'' AND TABLE_CATALOG = ''' + @databaseName + '''
                AND QUOTENAME(TABLE_SCHEMA) + ''.'' + QUOTENAME(TABLE_NAME) > ''' + @TableName + '''
                AND OBJECTPROPERTY(
                        OBJECT_ID(
                            QUOTENAME(TABLE_SCHEMA) + ''.'' + QUOTENAME(TABLE_NAME)
                                ), ''IsMSShipped''
                                ) = 0'
        EXEC master..sp_executesql @SQL, N'@result nvarchar(256) out', @result out

        SET @TableName = @result
        PRINT @TableName

        WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
        BEGIN
            DECLARE @ColumnResult NVARCHAR(256)
            SET @SQL = '
                SELECT @ColumnResult = MIN(QUOTENAME(COLUMN_NAME))
                FROM    [' + @databaseName + '].INFORMATION_SCHEMA.COLUMNS
                WHERE       TABLE_SCHEMA    = PARSENAME(''[' + @databaseName + '].' + @TableName + ''', 2)
                    AND TABLE_NAME  = PARSENAME(''[' + @databaseName + '].' + @TableName + ''', 1)
                    AND DATA_TYPE IN (''char'', ''varchar'', ''nchar'', ''nvarchar'')
                    AND TABLE_CATALOG = ''' + @databaseName + '''
                    AND QUOTENAME(COLUMN_NAME) > ''' + @ColumnName + ''''
            PRINT @SQL
            EXEC master..sp_executesql @SQL, N'@ColumnResult nvarchar(256) out', @ColumnResult out
            SET @ColumnName = @ColumnResult 

            PRINT @ColumnName

            IF @ColumnName IS NOT NULL
            BEGIN
                INSERT INTO @Results
                EXEC
                (
                    'USE ' + @databaseName + '
                    SELECT ''' + @TableName + ''',''' + @ColumnName + ''',''' + @TableName + '.' + @ColumnName + ''', LEFT(' + @ColumnName + ', 3630) 
                    FROM ' + @TableName + ' (NOLOCK) ' +
                    ' WHERE ' + @ColumnName + ' LIKE ' + @SearchStr2
                )
            END
        END
    END

    --Declaring another temporary table
    DECLARE @time_to_update TABLE(TableName nvarchar(370), RealColumnName nvarchar(370))

    INSERT INTO @time_to_update
    SELECT TableName, RealColumnName FROM @Results GROUP BY TableName, RealColumnName

    DECLARE @MyCursor CURSOR;
    BEGIN
        DECLARE @t nvarchar(370)
        DECLARE @c nvarchar(370)
        --Looping over the search results   
        SET @MyCursor = CURSOR FOR
        SELECT TableName, RealColumnName FROM @time_to_update GROUP BY TableName, RealColumnName

        --Getting my variables from the first item
        OPEN @MyCursor 
        FETCH NEXT FROM @MyCursor 
        INTO @t, @c

        WHILE @@FETCH_STATUS = 0
        BEGIN
            -- Updating the old values with the new value
            DECLARE @sqlCommand varchar(1000)
            SET @sqlCommand = '
                USE ' + @databaseName + '
                UPDATE [' + @databaseName + '].' + @t + ' SET ' + @c + ' = REPLACE(' + @c + ', ''' + @SearchStr + ''', ''' + @ReplaceStr + ''') 
                WHERE ' + @c + ' LIKE ''' + @SearchStr2 + ''''
            PRINT @sqlCommand
            BEGIN TRY
                EXEC (@sqlCommand)
            END TRY
            BEGIN CATCH
                PRINT ERROR_MESSAGE()
            END CATCH

            --Getting next row values
            FETCH NEXT FROM @MyCursor 
            INTO @t, @c 
        END;

        CLOSE @MyCursor ;
        DEALLOCATE @MyCursor;
    END;

    DELETE FROM @time_to_update
    DELETE FROM @Results

    FETCH NEXT FROM db_cursor INTO @databaseName
END   

CLOSE db_cursor   
DEALLOCATE db_cursor 
```

***注意：这不是理想的，也不是优化的***

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T16:42:45.137

[如果您使用的是 SQL Server 2005 或更高版本，那么http://www.sqlsharp.com/](http://www.sqlsharp.com/)上还有一个 CLR 库，它提供了字符串和 RegEx 函数的 .NET 实现，根据您的数据量和类型，这些函数可能是更易于使用，在某些情况下，.NET 字符串操作函数可能比 T-SQL 更有效。

# excel - 将工作簿中的每张工作表保存为单独的 CSV 文件

> ID：59075
> 
> 赞同：83
> 
> 时间：2008-09-12T14:04:02.600
> 
> 标签：excel, vba, csv

如何将 Excel 工作簿中的每张工作表保存为`CSV`使用宏分隔文件？

我有一个包含多张工作表的 excel，我正在寻找一个可以将每张工作表保存到单独的`CSV (comma separated file)`. Excel 不允许您将所有工作表保存到不同的`CSV`文件中。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2008-09-12T20:44:47.287

@AlexDuggleby：您不需要复制工作表，您可以直接保存它们。例如：

```
Public Sub SaveWorksheetsAsCsv()
Dim WS As Excel.Worksheet
Dim SaveToDirectory As String

    SaveToDirectory = "C:\"

    For Each WS In ThisWorkbook.Worksheets
        WS.SaveAs SaveToDirectory & WS.Name, xlCSV
    Next

End Sub 
```

唯一潜在的问题是，这会将您的工作簿保存为最后一个 csv 文件。如果您需要保留原始工作簿，则需要将其另存为。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2008-09-12T14:23:23.693

这是一个可以为您提供可视文件选择器来选择要将文件保存到的文件夹的工具，还可以让您选择 CSV 分隔符（我使用管道“|”，因为我的字段包含逗号，我不想处理带引号）：

```
' ---------------------- Directory Choosing Helper Functions -----------------------
' Excel and VBA do not provide any convenient directory chooser or file chooser
' dialogs, but these functions will provide a reference to a system DLL
' with the necessary capabilities
Private Type BROWSEINFO    ' used by the function GetFolderName
    hOwner As Long
    pidlRoot As Long
    pszDisplayName As String
    lpszTitle As String
    ulFlags As Long
    lpfn As Long
    lParam As Long
    iImage As Long
End Type

Private Declare Function SHGetPathFromIDList Lib "shell32.dll" _
                                             Alias "SHGetPathFromIDListA" (ByVal pidl As Long, ByVal pszPath As String) As Long
Private Declare Function SHBrowseForFolder Lib "shell32.dll" _
                                           Alias "SHBrowseForFolderA" (lpBrowseInfo As BROWSEINFO) As Long

Function GetFolderName(Msg As String) As String
    ' returns the name of the folder selected by the user
    Dim bInfo As BROWSEINFO, path As String, r As Long
    Dim X As Long, pos As Integer
    bInfo.pidlRoot = 0&    ' Root folder = Desktop
    If IsMissing(Msg) Then
        bInfo.lpszTitle = "Select a folder."
        ' the dialog title
    Else
        bInfo.lpszTitle = Msg    ' the dialog title
    End If
    bInfo.ulFlags = &H1    ' Type of directory to return
    X = SHBrowseForFolder(bInfo)    ' display the dialog
    ' Parse the result
    path = Space$(512)
    r = SHGetPathFromIDList(ByVal X, ByVal path)
    If r Then
        pos = InStr(path, Chr$(0))
        GetFolderName = Left(path, pos - 1)
    Else
        GetFolderName = ""
    End If
End Function
'---------------------- END Directory Chooser Helper Functions ----------------------

Public Sub DoTheExport()
    Dim FName As Variant
    Dim Sep As String
    Dim wsSheet As Worksheet
    Dim nFileNum As Integer
    Dim csvPath As String

    Sep = InputBox("Enter a single delimiter character (e.g., comma or semi-colon)", _
                   "Export To Text File")
    'csvPath = InputBox("Enter the full path to export CSV files to: ")

    csvPath = GetFolderName("Choose the folder to export CSV files to:")
    If csvPath = "" Then
        MsgBox ("You didn't choose an export directory. Nothing will be exported.")
        Exit Sub
    End If

    For Each wsSheet In Worksheets
        wsSheet.Activate
        nFileNum = FreeFile
        Open csvPath & "\" & _
             wsSheet.Name & ".csv" For Output As #nFileNum
        ExportToTextFile CStr(nFileNum), Sep, False
        Close nFileNum
    Next wsSheet

End Sub

Public Sub ExportToTextFile(nFileNum As Integer, _
                            Sep As String, SelectionOnly As Boolean)

    Dim WholeLine As String
    Dim RowNdx As Long
    Dim ColNdx As Integer
    Dim StartRow As Long
    Dim EndRow As Long
    Dim StartCol As Integer
    Dim EndCol As Integer
    Dim CellValue As String

    Application.ScreenUpdating = False
    On Error GoTo EndMacro:

    If SelectionOnly = True Then
        With Selection
            StartRow = .Cells(1).Row
            StartCol = .Cells(1).Column
            EndRow = .Cells(.Cells.Count).Row
            EndCol = .Cells(.Cells.Count).Column
        End With
    Else
        With ActiveSheet.UsedRange
            StartRow = .Cells(1).Row
            StartCol = .Cells(1).Column
            EndRow = .Cells(.Cells.Count).Row
            EndCol = .Cells(.Cells.Count).Column
        End With
    End If

    For RowNdx = StartRow To EndRow
        WholeLine = ""
        For ColNdx = StartCol To EndCol
            If Cells(RowNdx, ColNdx).Value = "" Then
                CellValue = ""
            Else
                CellValue = Cells(RowNdx, ColNdx).Value
            End If
            WholeLine = WholeLine & CellValue & Sep
        Next ColNdx
        WholeLine = Left(WholeLine, Len(WholeLine) - Len(Sep))
        Print #nFileNum, WholeLine
    Next RowNdx

EndMacro:
    On Error GoTo 0
    Application.ScreenUpdating = True

End Sub 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-09-12T14:04:45.330

这是我的解决方案应该适用于 Excel > 2000，但仅在 2007 年测试：

```
Private Sub SaveAllSheetsAsCSV()
On Error GoTo Heaven

' each sheet reference
Dim Sheet As Worksheet
' path to output to
Dim OutputPath As String
' name of each csv
Dim OutputFile As String

Application.ScreenUpdating = False
Application.DisplayAlerts = False
Application.EnableEvents = False

' ask the user where to save
OutputPath = InputBox("Enter a directory to save to", "Save to directory", Path)

If OutputPath <> "" Then

    ' save for each sheet
    For Each Sheet In Sheets

        OutputFile = OutputPath & "\" & Sheet.Name & ".csv"

        ' make a copy to create a new book with this sheet
        ' otherwise you will always only get the first sheet
        Sheet.Copy
        ' this copy will now become active
        ActiveWorkbook.SaveAs FileName:=OutputFile, FileFormat:=xlCSV, CreateBackup:=False
        ActiveWorkbook.Close
    Next

End If

Finally:
Application.ScreenUpdating = True
Application.DisplayAlerts = True
Application.EnableEvents = True

Exit Sub

Heaven:
MsgBox "Couldn't save all sheets to CSV." & vbCrLf & _
        "Source: " & Err.Source & " " & vbCrLf & _
        "Number: " & Err.Number & " " & vbCrLf & _
        "Description: " & Err.Description & " " & vbCrLf

GoTo Finally
End Sub 
```

*（OT：我想知道 SO 是否会取代我的一些小博客）*

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-09-15T12:20:22.963

基于格雷厄姆的回答，额外的代码将工作簿以其原始格式保存回其原始位置。

```
Public Sub SaveWorksheetsAsCsv()

Dim WS As Excel.Worksheet
Dim SaveToDirectory As String

Dim CurrentWorkbook As String
Dim CurrentFormat As Long

 CurrentWorkbook = ThisWorkbook.FullName
 CurrentFormat = ThisWorkbook.FileFormat
' Store current details for the workbook

      SaveToDirectory = "C:\"

      For Each WS In ThisWorkbook.Worksheets
          WS.SaveAs SaveToDirectory & WS.Name, xlCSV
      Next

 Application.DisplayAlerts = False
  ThisWorkbook.SaveAs Filename:=CurrentWorkbook, FileFormat:=CurrentFormat
 Application.DisplayAlerts = True
' Temporarily turn alerts off to prevent the user being prompted
'  about overwriting the original file.

End Sub 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-10T13:37:51.253

[亚历克斯回答的](https://stackoverflow.com/questions/59075/macro-to-save-each-sheet-in-an-excel-workbook-to-separate-csv-files/59078#59078 "哦，那就在这里")一个小修改是打开和关闭自动计算。

令人惊讶的是，未修改的代码在 VLOOKUP 上运行良好，但在 OFFSET 上却失败了。关闭自动计算也可以大大加快保存速度。

```
Public Sub SaveAllSheetsAsCSV()
On Error GoTo Heaven

' each sheet reference
Dim Sheet As Worksheet
' path to output to
Dim OutputPath As String
' name of each csv
Dim OutputFile As String

Application.ScreenUpdating = False
Application.DisplayAlerts = False
Application.EnableEvents = False

' Save the file in current director
OutputPath = ThisWorkbook.Path

If OutputPath <> "" Then
Application.Calculation = xlCalculationManual

' save for each sheet
For Each Sheet In Sheets

    OutputFile = OutputPath & Application.PathSeparator & Sheet.Name & ".csv"

    ' make a copy to create a new book with this sheet
    ' otherwise you will always only get the first sheet

    Sheet.Copy
    ' this copy will now become active
     ActiveWorkbook.SaveAs Filename:=OutputFile, FileFormat:=xlCSV,     CreateBackup:=False
    ActiveWorkbook.Close
Next

Application.Calculation = xlCalculationAutomatic

End If

Finally:
Application.ScreenUpdating = True
Application.DisplayAlerts = True
Application.EnableEvents = True

Exit Sub

Heaven:
MsgBox "Couldn't save all sheets to CSV." & vbCrLf & _
        "Source: " & Err.Source & " " & vbCrLf & _
        "Number: " & Err.Number & " " & vbCrLf & _
        "Description: " & Err.Description & " " & vbCrLf

GoTo Finally
End Sub 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-02-19T22:35:27.697

## 使用 Visual Basic 循环工作表并保存`.csv`文件。

1.  `.xlsx`在 Excel 中打开文件。

2.  按`option`+`F11`

3.  `Insert`→`Module`

4.  将其插入到模块代码中：

    ```
    Public Sub SaveWorksheetsAsCsv()

     Dim WS As Excel.Worksheet
     Dim SaveToDirectory As String

     SaveToDirectory = "./"

     For Each WS In ThisWorkbook.Worksheets
        WS.SaveAs SaveToDirectory & WS.Name & ".csv", xlCSV
     Next

    End Sub 
    ```

5.  运行模块。

    *（即单击顶部的播放按钮，然后单击对话框上的“运行”，如果它弹出。）*

6.  在. `.csv`_`~/Library/Containers/com.microsoft.Excel/Data`

    ```
    open ~/Library/Containers/com.microsoft.Excel/Data 
    ```

7.  关闭`.xlsx`文件。

8.  冲洗并重复其他`.xlsx`文件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-05-19T14:45:26.183

对于像我这样的 Mac 用户，有几个问题：

您无法保存到您想要的任何目录。只有少数人可以接收您保存的文件。[那里有](https://www.rondebruin.nl/mac/mac034.htm)更多信息

这是一个工作脚本，您可以在 Mac 的 Excel 中复制粘贴：

```
Public Sub SaveWorksheetsAsCsv()

 Dim WS As Excel.Worksheet
 Dim SaveToDirectory As String

 SaveToDirectory = "~/Library/Containers/com.microsoft.Excel/Data/"

 For Each WS In ThisWorkbook.Worksheet
    WS.SaveAs SaveToDirectory & WS.Name & ".csv", xlCSV
 Next

End Sub 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-01-09T10:46:50.413

请查看[Von Pookie 的回答](http://www.mrexcel.com/forum/excel-questions/265154-saving-multiple-sheets-separate-csv-files-visual-basic-applications.html)，所有功劳归于他/她。

```
 Sub asdf()
Dim ws As Worksheet, newWb As Workbook

Application.ScreenUpdating = False
For Each ws In Sheets(Array("EID Upload", "Wages with Locals Upload", "Wages without Local Upload"))
   ws.Copy
   Set newWb = ActiveWorkbook
   With newWb
      .SaveAs ws.Name, xlCSV
      .Close (False)
   End With
Next ws
Application.ScreenUpdating = True

End Sub 
```

# asp.net - SqlServer Express 性能缓慢

> ID：59080
> 
> 赞同：0
> 
> 时间：2008-09-12T14:05:35.717
> 
> 标签：asp.net, performance, subsonic, sql-server-express

我正在对 .NET Web 应用程序进行压力测试。我这样做有两个原因：我想看看在现实世界条件下的性能如何，同时确保我们在测试期间没有遗漏任何问题。我们在应用程序中有 30 个并发用户使用它，就像他们在正常工作过程中一样。大多数用户打开了应用程序的多个窗口。

*   10 位用户：还不错
*   20 位用户：放慢速度
*   30 个用户：非常非常慢但没有超时

它已加载到生产服务器上。它是具有 2.66G Hz Xeon 处理器和 2 GB RAM 的虚拟服务器。我们正在使用 Win2K3 SP2。我们已经加载了 .NET 1.1 和 2.0，并且正在使用 SQLExpress SP1。

我们重新检查了所有表的索引，它们都是应有的。

我们如何提高应用程序的性能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-12T14:13:31.627

1.  您可能会遇到并发问题，具体取决于应用程序的运行方式。尝试使用“nolock”关键字进行阅读。

2.  尝试为您的列添加表别名（并避免使用 SELECT *），这有助于 MSSQL，因为它不必“猜测”列来自哪个表。

3.  如果您还没有，请转到 SPROC，这允许 MSSQL 为给定查询的正常结果集更好地索引您的数据。

4.  尝试遵循 SPROCS 的执行计划，以确保它们使用您认为的索引。

5.  对您的数据库运行跟踪以查看传入请求的外观。您可能会注意到一个特定的 SPROC 正在一遍又一遍地运行：如果可能的话，通常是在客户端缓存响应的好兆头。（查找列表等）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-12T14:22:24.070

这只是我想到的，但是当你有 20 个以上的用户时，检查一下 SQL Server 使用了多少内存 - Express 版本的限制之一是它被[限制为 1GB 的 RAM](http://www.microsoft.com/sql/prodinfo/features/compare-features.mspx)。因此，由于 Express 的限制，服务器没有足够的可用内存可能只是一个简单的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T14:14:31.123

更新：看起来 SQL Server express 不是问题，因为他们在以前版本的应用程序中使用相同的产品。我认为您的下一步是确定瓶颈。如果您确定它位于数据库层，我建议您进行分析器跟踪并缩短最昂贵查询的执行时间。

这是我用于从 SQL Server 动态管理视图 (DMV) 和相关动态管理功能 (DMF) 收集统计信息的另一个链接。不确定我们是否可以在 Express 版中使用。 [发现隐藏数据以优化应用程序性能](http://msdn.microsoft.com/en-us/magazine/cc135978.aspx)。

* * *

您是否将 SQL Server Express 用于 Web 应用程序？据我所知，它对生产部署有一些限制。

[SQL Server Express](http://msdn.microsoft.com/en-us/library/ms144275.aspx)是免费的，可以由 ISV 重新分发（根据协议）。**SQL Server Express 是** **学习和构建桌面和小型服务器应用程序的理想选择**。此版本是独立软件供应商、非专业开发人员和构建客户端应用程序的爱好者的最佳选择。如果您需要更高级的数据库功能，SQL Server Express 可以无缝升级到更复杂的 SQL Server 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T14:48:52.577

我会检查虚拟服务器上的磁盘性能。如果这是问题之一，我建议将数据库放在单独的主轴上。

更新：按照 Gulzar 的恰当建议，移动到单独的主轴或升级 SQL Server 版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T14:54:34.590

确保在检索数据后关闭连接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T23:00:14.517

运行 SQL Profiler 以查看发送到数据库的查询。查找以下查询：

*   返回太多数据
*   构造不良
*   被执行太多次

# apache-flex - 什么是 Adob e Flex？它只是Flash II吗？

> ID：59083
> 
> 赞同：82
> 
> 时间：2008-09-12T14:06:10.833
> 
> 标签：apache-flex, flash

## 问题

好吧，我对所有流行语和新闻稿宾果游戏感到困惑。

*   flash和flex是什么关系：
    *   更换闪光灯（不是真的兼容）
    *   增强闪光
    *   下个版本的flash 但还是基本兼容
    *   完全分离技术
    *   ？？？
*   如果我现在开始使用 Flash，我应该直接跳到 Flex 吗？

## 跟进

好的，所以我听到的是这个难题有三个不同的部分：

*   **闪光**
    *   用于制作“Flash 电影”的图形编辑器，即它是一个专注于“Flash”视觉方面的 IDE（正式为 Flash CS3？）
    *   显示插件的正式名称（即“立即下载 Flash！”）
    *   对整个技术堆栈的一般参考
    *   在编辑器方面，它是一个基于线性时间轴的编辑器，最适合用于具有复杂交互性的动画。
*   **动作脚本**
    *   “Flash”编程语言
*   **柔性**
    *   一个专注于“Flash”（Flex Builder？）的编码/编程方面的 Adob​​e Flash IDE
    *   一个 Flash 库，可增强 Flash 并使其更易于*编程*（Flex SDK？）
    *   不受时间线约束（如 Flash IDE 那样），因此更容易实现“标准”应用程序。

它是否正确？

-亚当

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2008-09-16T02:57:46.723

术语**Flash**可以包含下面定义的任何其他术语，我发现说“Flash”而不具体说明您的意思可能会造成混淆和误导。恰当的例子：当您在问题中说“Flash”时，我不确定您的具体含义。是 Flash 播放器吗？创作工具？还是属于 Adob​​e 所谓的“Flash 平台”的全部技术？为了帮助澄清这一切，让我定义创建 Flash 和 Flex 内容所涉及的技术，以便我们在这里都使用相同的术语：

**Flash Player**是浏​​览器中富媒体内容的运行时。还有**Flash Lite**可在较旧或低端的移动设备上运行 Flash 内容，**Adobe AIR**扩展了 Flash Player 以允许内容作者发布可以与文件系统、窗口系统和设备等集成的本地桌面和移动应用程序加速度计和摄像头等传感器。Adobe 将这些统称为**Flash 运行时**。

**Flash Professional**（通常称为**Flash 创作工具**或**Flash IDE**）历来是用于创建在 Flash Player 上运行的内容的主要应用程序。它非常面向设计师，具有时间线、图层和可视化绘图工具。与其他更专注于代码的开发工具（如 Flash Builder（见下文））相比，软件开发人员可能会发现此应用程序令人迷惑和受限。当有人说“我用 Flash 构建了一些东西”时，他们通常指的是 Flash 创作工具，但情况并非总是如此。出于这个原因，最好总是澄清以避免任何混淆。

**ActionScript**是 Adob​​e 支持以 Flash 运行时为目标的主要编程语言。当前版本是 ActionScript 3（缩写为**AS3**），从 Flash Player 9 开始支持。使用旧版本的 ActionScript 创建的内容仍然可以在最新版本的 Flash Player 中运行，但仅在使用 ActionScript 3 时才支持新功能创建新内容。

**Flex**是一组旨在创建针对 Adob​​e Flash 运行时的丰富应用程序的技术。尽管之前说“Flex”与“Flash”有同样的歧义，但 Flex 品牌名称正变得越来越专注于 Flex 框架和 SDK，如下所述。

**Flex SDK**由编译器、命令行调试器和 Flex 框架组成。包含的编译器是： 1\. MXMLC，一个 ActionScript 和 MXML 编译器，用于输出最终的 SWF 文件以部署到 Flash Player。2\. COMPC，ActionScript 的静态库编译器，输出 SWC 文件。3\. ASDOC，一个基于编译器技术的文档生成器。

**Flex 框架**是旨在构建富 Internet 应用程序的 ActionScript 类的集合。它包括用户界面控件、Web 服务和其他连接类、格式化程序和验证程序、拖放、模式窗口和组件状态等内容。这些类在 mx.* 包中。通常，当开发人员在没有任何澄清信息的情况下说“Flex”时，他们指的是 Flex 框架，而不是以前称为 Flex Builder 的产品。

2011 年，Adobe 将 Flex SDK 捐赠给了 Apache 软件基金会。它现在称为**Apache Flex**，完全由社区而不是 Adob​​e 管理。但是，Adobe 员工继续为该项目做出贡献，Flash Builder（见下文）继续支持 Apache Flex 项目发布的新 SDK。

**MXML**是一种基于 XML 的标记语言，Flex 编译器使用它来简化布局和将组件放入容器中。XML 的树状结构使包含层次结构更易于可视化。MXML 实际上是在编译过程中转换为 ActionScript。

**Flash Builder**（以前称为**Flex Builder**）是一种开发环境，允许开发人员构建不同的项目类型以创建部署到 Flash 运行时的 SWF 文件。它建立在 Eclipse 平台之上，软件工程师比较熟悉。Flash Builder 支持使用 Flex 或纯 ActionScript 构建的项目。Flex 项目包括 Flex 框架。ActionScript 项目是您可以使用的最基本的项目，从单个类和一个空画布开始，并且不包括 Flex 框架。

Flash Builder 不会取代 Flash Professional。一些传统上使用 Flash Professional 的人现在可能会选择使用 Flash Builder。通常，这些软件工程师喜欢或需要 Flash Builder 提供的高级开发工具，或者不大量使用在可视化工具中设计的资产。一些开发人员可能会在 Flash Builder 中编写他们的代码，同时选择在 Flash 创作工具中编译他们的项目。通常，这些开发人员也是设计师，或者他们正在与其他设计师合作。在这种情况下，可能在 Flash 创作工具中创建了许多图形资产，将它们引入另一个环境可能很困难或根本不合适。

Flex 框架专为构建应用程序而设计。它包括许多传统的表单控件（按钮、列表、数据网格等），并且大部分代码在用 ActionScript 编写的高级组件框架上运行。并非每个人都在构建 Flex 旨在创建的那种内容，而且 Flex 并没有取代每个人的传统 Flash 开发实践。对于某些开发人员来说，这是一种更好的方法，但可能不适合其他开发人员。更多注重设计的网站，例如那些为电影、音乐、能量饮料、广告活动和类似的东西创建的网站，可能不应该使用 Flex 框架。这些类型的内容可能更适合 Flash Professional 或 Flash Builder 中的纯 ActionScript 项目。相似地，您放入网站侧边栏或社交网站个人资料中的小部件可能需要使用纯 ActionScript（没有 Flex 框架）构建，因为它们需要较小的文件大小，并且可能不需要大的复杂为大型应用程序设计的组件架构。以 Flash 运行时为目标时，应根据项目的要求和目标选择开发环境、框架和工作流程。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-09-12T14:08:11.483

Adobe Flex Builder 是 Adob​​e 的 IDE，用于开发将在 Flash 插件中运行的应用程序。Flex SDK 是指开发人员用来编写应用程序的库。

本质上，术语“Flex”是指开发方面，而“Flash”是 Adob​​e 技术的运行时方面。

**更正：** “Flash”一词也用于指代设计人员使用的 Flash IDE。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-12T14:13:59.470

是的，我也为此困惑了好一阵子。

Flex 似乎是“Flex Builder”IDE（基于 Eclipse）的名称，也是使用[mxml](http://en.wikipedia.org/wiki/MXML)和 ActionScript 而不是普通的 flash 工具构建 flash 文件的一般方法。

我认为 mxml 和 ActionScript 方法（即 Flex）旨在更吸引程序员，而 Flash 方面的设计更吸引图形设计师。

任何一种方法的最终结果都是一个 .swf 文件，它可以在浏览器的 flash 播放器插件中运行（尽管如果您想要访问文件系统并离线运行等，则可以使用 Flex 来定位 Adob​​e Air 运行时）。

我的建议是，如果您有编程背景，请从 Flex 开始。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-16T03:10:20.563

Flex 和 Flash 有什么区别？

我记在心里，向别人解释的方式是这样的：

为您要创建的内容选择正确的工具。

如果您想使用 Flash 技术编写应用程序，请使用 Flex。

如果您想使用 Flash 技术创建动画，请使用传统 Flash。

Flex 已针对应用程序构建进行了优化（但您可以使用状态创建原始动画）并将其编译为 SWF。

Flash 针对动画构造进行了优化，但您也可以通过一些额外的工作创建应用程序，并将其编译为 SWF。

有了 SWF 后，您就可以在 Flash 播放器中播放了，尽管 Flex 需要 Flash 9 或更高版本。

综上所述

应用程序 -> 弹性 -> SWF

动画-> Flash -> SWF

希望这可以帮助。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-12T14:25:25.590

部分困惑是“Flash”意味着多种事物。Flash 可能意味着众多应用程序之一，或者 SWF 背后的一般技术。

Adobe 销售的[Flash CS3](http://www.adobe.com/products/flash/)产品。这通常针对设计人员，并使用基于时间线的方法来创建 SWF。以前，Flash 产品是创建 SWF 的唯一方法，而 SWF 通常仅用于动画和其他浏览器中无法实现的视觉效果。

然后是[Flash Player](http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash)。这是用于运行 SWF 的应用程序/插件。SWF 也可以包装在“投影仪”中，允许它们作为独立应用程序运行，但这并不常见。

在某个时候（我不知道是什么时候）Flash 开始被用于更具交互性的应用程序。Flash 产品不太适合这种工作，因为它是为创建动画而设计的。认识到这一点，Macromedia 创建了[Flex](http://www.adobe.com/products/flex/)。Flex 是另一种用于创建 SWF 的开发环境，但它更多地针对开发人员而不是设计人员。最新版本是[Flex 3](http://www.adobe.com/products/flex/)。[Flex SDK](http://www.adobe.com/products/flex/flexdownloads/index.html#sdk)是免费提供的，包括命令行编译器、调试器和类库。Adobe 还提供（购买）[Flex Builder](http://www.adobe.com/products/flex/flexdownloads/index.html#flex_builder)应用程序，这是一个基于 Eclipse 的 IDE，用于使用 Flex 创建 SWF。有一些免费的 IDE 可以使用 Flex，最著名的是[FlashDevelop](http://www.flashdevelop.org/)，虽然我不知道有任何提供 MXML 的可视化设计器、Flex 用于定义 UI 的标记语言或调试器的可视化包装器。

如果您从开发人员的角度接近 Flash，那么您会想要使用 Flex。它可能更接近于您习惯处理的内容，并且似乎是 Adob​​e 总体上推动 Flash 的方向。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-16T05:59:31.250

**Flash**是一个**运行时环境**- 您使用 Flash 创作工具制作一些 Flash 内容，Flash 播放器处理您的内容、执行脚本并将适当的图片绘制到屏幕上。

**Flex**是一个**开发框架**——您使用 Flex 开发工具来定义基于组件的内容应该如何工作，然后 Flex 为您生成 Flash 内容。您可以使用 Flash 创作工具制作相同的东西，但使用 Flex 可以让您避免重新发明一些轮子。

从功能上来说，Flash 是一个非常通用的运行时；它给了你很多自由去做任何你想做的事情。但是，如果您正在构建一个贷款模拟器，您可能不需要自由地精确定义所有下拉菜单和屏幕转换的工作方式。可能您宁愿只为这些东西使用预制组件，这样您就可以专注于贷款的东西。Flex 可以让您做到这一点，但如果您决定确实需要很大的自由来更改所有精细的细节，这可能会导致大量工作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-08T22:46:23.040

这是另一个基于您如何描述要开发的应用程序的简单视图。

您是否希望它具有工作站（例如 Windows）应用程序所期望的高度精细的 UI 功能，以及相当完整的控件集（列表框、组合框、网格等）？

Flex 为您提供。

您是否希望将其交付给大多数浏览器（即安装/可安装 Flash 的任何地方）？

Flex 为您提供了这一点，因为它在 Flash 虚拟机中运行。

您是否还希望能够提供它在操作系统中运行，而不是在浏览器中运行（代码更改最少？）

Flex 可以通过允许您运行它，而不是在 Flash VM 中，而是在 Adob​​e AIR VM（有 Windows、Mac 和 Linux 版本）中为您提供这一点，它为常见的操作系统资源（如文件系统、操作系统对话框）提供包装器-box UI 组件（例如“打开/文件/等）

您可以使用 javascript 作为开发语言吗？你需要，因为它是唯一支持的语言，以 ActionScript 的形式，它是 javascript 的正确超集 - 它直接接受 javascript 代码。

所以分割的部分是：

1.  运行时环境，Flash 浏览器插件或 AIR 运行时（本机操作系统等效项）。

2.  Actionscript 作为开发语言。

3.  一堆控件库和其他资源，即典型的 Window、Frame、Combobox、Listbox、Image container、TextBox、TextArea、a wysiwyg-y RichTextArea 等）这些都是 Flex 的省。

仅使用上述资源，您就可以使用免费的命令行编译器以与使用任何其他带有库的命令行编译器语言相同的方式构建应用程序。

然后，如果您想要一个花哨的 IDE，可以使用 Flex Builder，它是对优秀 Eclipse 的一组扩展（几百美元）。或者还有其他几个或多或少等效的 IDE。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-02-16T21:07:33.903

Flex 是一个**框架**FlexBuilder 是一个**IDE** （为了解决两者之间的混淆，adobe 正在将 FlexBuilder 重命名为 FlashBuilder）

如果您不知道什么是[框架](http://en.wikipedia.org/wiki/Framework)：

Flex 之于 Flash 就像 CodeIgniter 之于 PHP

或喜欢什么`.net`。

我喜欢将框架视为扩展语言，就像在 OOP 中扩展类一样。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-08T21:56:41.953

Flex 是一个开发框架，将 xml 和 actionscript 编译成 SWF，运行在访问网站的客户端机器上。它还可以使用 Adob​​e AIR 作为桌面应用程序运行。Flash 使用绘图画布而不是 xml。编译后的 SWF 可以称为 Flash，这增加了混淆。您可能会发现 Flex 类似于 ASP.NET，它采用 xml 和 c#（vb.net 等）并编译成 dll。当然，ASP.NET 在 Web 服务器上运行。

如果您为应用程序在 Flex 和 Flash 之间进行选择，请考虑该应用程序是否将基于数据。如果您想制作一个漂亮的电子表格应用程序，Flex 将是您的最佳选择。如果您正在创建视频游戏或某种演示文稿，您可能需要 Flash。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-22T15:10:47.827

在此之后，我发现了一篇关于该主题的非常有用的文章：

[Adobe Flash 和 Flex — 哪个对您的项目最有意义？](http://www.adobe.com/devnet/edu/articles/erik_loyer.html)

> Flash 集成开发环境 (IDE)，在当前版本中也称为 Flash CS3，是开发角色动画或线性动画项目的理想工具。这些项目需要很少的编码，并且可以使用 Flash IDE 时间线有效实施。

换句话说，Flash CS4 与时间线的绑定非常紧密——适用于线性序列或动画。虽然人们可以以跳转到时间轴上的新点的形式添加循环和交互性，但它对于无法轻易根据时间进展进行规划的项目是有限的。

简单来说，它是一种具有非常强大的交互功能的动画工具——动态创建和组合新元素，以及在时间轴上跳转允许创建应用程序，而 Flash CS4 IDE 使这相对容易，但事实并非如此应用风格软件的绝佳平台。

Flex 就是为了解决这个问题而构建的——虽然它使用相同的元素并公开代码，但它不受时间线的约束，并且与面向对象的编程语言相比动画语言有更多的共同点。

Flex Builder IDE 包括编程 IDE，以及用于快速构建界面的 GUI 设计器，以及用于开发在 Flash 播放器上运行的应用程序的一些其他工具。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-12T14:09:48.593

Flex 和 Flash 有不同的目标受众。Flex 更适合开发人员，而 Flash 更适合设计师和艺术家。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-18T06:50:09.457

Flashdeveloper 被称为开发弹性应用程序的免费工具。我只想添加一个免费工具来设计应用程序（使用设计器创建 MXML 文件）：[designview](http://www.adobe.com/cfusion/exchange/index.cfm?event=extensionDetail&loc=en_us&extid=1509018)。它可以直接在 adobe 网站上获得，它是一个基本的空中应用程序，但可以自由轻松地查看 flex 的可能性。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-09-23T11:44:02.513

Flex 是一个基于 ActionScript 的免费开源框架，用于开发 SWF 和 AIR 应用程序。Flex Builder（为了避免混淆，现在重命名为 Flash Builder 第 4 版）是 Adob​​e 的一个商业 IDE，用于使用 flex 框架开发 SWF/AIR。虽然 flash (CS3) 适用于动画相关的东西，但 flex 适用于应用程序/ui 相关的东西。Adobe 将 flex 定位为 RIA（富 Internet 应用程序）框架。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-03-02T15:44:09.377

Flex 也可以在 Linux 上运行，而 Flash 不能。
Flex 有点像 Flash CS 4 第二版。

Flex 的图形化程度较低，因为它将编译器和 IDE 分开，从而允许命令行编译（可以说是 makefile、大型项目），从而允许使用 Flash 的替代 IDE。

**编辑：**
Flex 缺少一些 Flash CSX 具有的类（例如 fl.controls），而 Flash 缺少一些 Flex 具有的类（例如 mx.controls 或 mx.alert）。

总而言之：
您可以通过下载 Flex 4 SDK 和 FlashDevelop 免费拥有自己的 Flash 编译器。但它不能替代 Flash。
Flash 生成的文件要小得多（例如，Flash 将项目编译为 100 kB，而 Flex 将同一项目编译为 500 kB）。所以Flash适用于互联网多媒体应用，而Flex适用于桌面多媒体应用。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-06-05T07:00:49.627

Flex Builder 3 --> Flash Builder 4，即使您将它用于 Flex。您也可以将它用于 Flash。如果你真的想了解所有这些东西，你应该只买一天的老兵午餐，因为它会节省你几个月的时间。Adobe 制作了一些很酷的产品，但同时也是众所周知的[懒惰公司](http://www.blogbros.com?p=116)，这导致文档极差。除非您是“livedocs”的粉丝，这是 Adob​​e 用来描述“缓慢而臃肿的 HTML”的术语。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-12T14:08:55.130

“Adobe Flex 是 Adob​​e Systems 发布的一系列技术，用于开发和部署基于专有 Adob​​e Flash 平台的跨平台富 Internet 应用程序。”

[Adobe Flex](http://en.wikipedia.org/wiki/Adobe_Flex)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-12T14:14:16.600

Flash 是一种编程语言，与 JavaScript 非常相似，但支持静态类型。

Flex 是一个 Flash 库，旨在帮助人们在更高级别上使用 Flash 进行编程。

将这看作是 Flash 上的 Flex 就像 C++ 上的 MFC 对某些人可能会有所帮助。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-19T02:59:37.723

Flex 基本上是一种编译成 Flash“电影”或“小程序”的语言，它们将在 Adob​​e Flash 播放器插件中运行。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-11-20T05:39:33.503

简单来说，Flex 技术使用 MXML 来创建应用程序。MXML 类似于 HTML，而 Flash 组件类似于表单元素。

MXML 基本上允许您指定在应用程序屏幕上显示哪些 Flash 组件（例如表格、下拉列表或您在 Flash 中构建的自定义内容）。

这是一个*非常*简单的答案，但这就是我倾向于解释 Flex 的方式。

（Flex Builder 是您开发 Flex 应用程序和 Flash 应用程序的环境）

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-09-30T18:52:05.337

Flex 不是一种编程语言。flex 是一个用于在 Flash 运行时开发富 Internet 应用程序的框架，包括 ActionScript 和 MXML 作为语言。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-09-30T18:56:54.753

Flex 是用于构建跨平台富 Internet 应用程序的技术、工具和框架的集合。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-04-19T01:01:52.613

我为“什么是 Flex”找到的最佳答案位于此页面： http: [//www.adobe.com/products/flex/faq.html#flex-flash](http://www.adobe.com/products/flex/faq.html#flex-flash)

搜索“Flex 与 Flash 有何不同？”

我对此的解释是，如果您的应用程序是从 Flash Professional 生成的，那么它就是一个“Flash”应用程序。如果它是使用 Flex SDK（Flash Builder、Flash Develop 或直接代码和命令行工具）生成的，则它是一个“Flex”应用程序。“Flash”应用程序和“Flex”应用程序都编译成可以由“Flash Player”或“Adobe AIR”运行的字节码。这两种类型的应用程序都可以包含“Actionscript”代码。

# windows - Windows Server 2003 SP2 是否说出关于免费系统页表条目的真相？

> ID：59098
> 
> 赞同：2
> 
> 时间：2008-09-12T14:16:36.063
> 
> 标签：windows, winapi, windows-server-2003

我们有一些在 Windows Server 2003 Service Pack 2 上运行的 Win32 控制台应用程序，这些应用程序经常会因此而失败：

> 错误 1450 ( `ERROR_NO_SYSTEM_RESOURCES`)：“系统资源不足，无法完成请求的服务。”

我们发现的所有文档都表明它与耗尽的**免费系统页表条目的数量有关。**我们在这些机器中有 16GB 的 RAM，并使用`/3GB`操作系统开关将 Windows 内核压缩到 1GB，并允许我们的进程访问 3GB 的地址空间。这大大减少了空闲系统页表条目的总数，因此结合我们大量使用 MapViewOfFile() ，内核页表条目即将耗尽可能并不奇怪。

但是，当使用性能监视器查看 Free System Page Table Entries 计数器时，重新启动时该值约为 36,000，并且**在我们的应用程序启动时不会下降**。我很难相信我们打开许多大型内存映射文件的应用程序对内核页表没有任何影响。如果我们不能相信计数器，那么要测试我们所做的任何系统更改的效果就会变得更加困难。

有一篇很有前途的知识库文章，[性能工具没有准确显示 Windows Server 2003 中可用的免费系统页表条目](http://support.microsoft.com/kb/894067)，但它说问题已在 Service Pack 1 中修复，我们已经在 Service Pack 2 中。

有没有其他人遇到过或解决过这个问题？

**更新：**我在windbg（调试内核）中检查了!sysptes，该值与性能计数器相匹配，大约为36,000。我想这很可能意味着确实有很多免费的页表条目，而 Windows说的*是*实话。如果 PTE 没有用完，它确实留下了为什么我们会收到 1450 错误的问题。

**进一步更新：**我们从未深入了解为什么会发生 1450 错误。 *但是*，我们将这些服务器上的操作系统升级到了 64 位 Windows。这允许现有的 32 位应用程序（无需重新编译）访问完整的 4GB 虚拟地址空间，并让带有那些讨厌的页表条目的内核内存区域也尽可能大。从那以后，我认为我们没有出现 1450 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-13T21:36:38.977

您可以尝试使用 windbg 命令“！sysptes”来获取系统 PTE 信息吗？我不确定您是否可以通过实时内核调试来做到这一点，您可能需要进行内存转储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-26T13:33:06.733

我不确定您为什么认为这*仅*是由免费的系统页表条目用完`ERROR_NO_SYSTEM_RESOURCES`引起的？据我所知，此类通用错误代码用于不止一种资源类型。事实上，谷歌的第一个命中表明文件缓存内存不足也可能导致它。（KB 上的一个 XP 错误，它触发了这种错误模式）。

 *在你的情况下，我会检查“句柄计数”。另一个可能的问题是地址空间碎片。如果要创建 1GB 的文件映射视图，则需要 1GB 的可用地址空间，并且必须是连续的。如果您映射一个 1GB 文件、一个 800 MB 文件和一个 1GB 文件，关闭 800MB 文件并打开一个 900MB 文件，则 900MB 文件可能无法放入剩下的孔中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T06:23:28.917

MS 有**两种方法**可以让 32 位操作系统“处理”具有 4 GB 或更多 RAM 的硬件。

**选项 1：是您对 Boot.ini 中的 /3GB 开关所做的操作。**

**选项 1 优点和缺点：**

**（缺点）**此选项从正常的 2 GB 内核区域中吸取 1 GB - 因此使操作系统难以满足分页池分配和内核堆栈分配的需求。所以有人可能会认为使用 /3GB 开关会对他们有所帮助，但实际上这个选项正在让 32 位 Window OS 慢慢死去。

**（缺点）**但是，这给了我的应用程序 3GB.... 错误（因此这是一个缺点）问题是，只有从供应商重新编译为“/3GB 开关感知”的应用程序才能真正使用额外的 1 GB . 因此，整个使用 /3GB 开关对每个人来说都是一个非常糟糕的笑话。

阅读此链接以获得更好的文章：

[http://blogs.technet.com/askperf/archive/2007/03/23/memory-management-demystifying-3gb.aspx](http://blogs.technet.com/askperf/archive/2007/03/23/memory-management-demystifying-3gb.aspx)

**选项 2：使用 Boot.ini 中的 /PAE 开关。**

**选项 2 优点和缺点：**

**（优点）**如果您有超过 4GB 的 RAM，这确实是唯一的选择。它通过将完整的应用程序内存占用放在 RAM 中来欺骗应用程序。通常，只有一个应用程序“工作集”内存在 RAM 中，其余的应用程序内存需求进入 Windows 页面文件。什么是应用程序总内存要求？- 它称为“虚拟大小”。

在我的世界里，我处理了一个基于 Java 的大型 IBM 产品。运行“应用程序”的服务器有 16 GB 的 RAM。我只需添加 /PAE 开关并观察（感谢 sysinternals Processes Explorer）应用程序分页请求从每秒 200 KB 增加到每秒 4MB。

**问题：** “为什么”？

**答：**整个应用程序都在 RAM 中。

**问题：** “应用程序是否知道它完全在 RAM 中运行？

**回答：**否 - 它以与始终运行相同的旧方式运行，“认为”它自身的一部分是位于 RAM 中的“工作集”内存，其余的应用程序内存需求进入 Windows 页面文件。

是的，就是这样翻转好。

请注意：Microsoft 在告诉任何人有关出色的 Windows 操作系统选项方面做得很差。呵呵

试试看，然后向 stackoverflow 报告....

# wpf - WPF TextBlock 元素和Label 控件有什么区别？

> ID：59099
> 
> 赞同：102
> 
> 时间：2008-09-12T14:17:11.493
> 
> 标签：wpf

从视觉上看，以下两个片段都产生了相同的 UI。那么为什么有 2 个控件..
**Snippet1**

```
<TextBlock>Name:</TextBlock>
<TextBox Name="nameTextBox" /> 
```

**片段2**

```
<Label>Name:</Label>
<TextBox Name="nameTextBox" /> 
```

（*好吧，我自己来回答这个问题......认为这是我今天从[Programming WPF](https://rads.stackoverflow.com/amzn/click/com/0596510373)*学到的有用的花絮）

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-09-12T17:58:17.653

WPF 文本块继承自**FrameworkElement** ，而不是像标签控件那样从**System.Windows.Control**派生。这意味着 Textblock 更轻量级。使用文本块的缺点是不支持访问/加速键，并且没有链接到其他控件作为目标。

***当您想单独显示文本时，请使用 TextBlock***。好处是显示文本的一种轻便、高效的方式。

***当您想将文本与另一个控件（如 TextBox）相关联时，请使用 Label 控件***。好处是访问密钥和对目标控制的引用。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-12T14:21:03.293

Label 有一个重要的**焦点处理**责任。它的目的是允许您使用访问键放置标题。它有一个**Target**属性，表示访问密钥的目标。像这样...

```
<Label Target="{Binding ElementName=nameTextBox}">_Name:</Label>
<TextBox x:Name="nameTextBox" /> 
```

在没有 Target 属性的情况下，Label 控件没有任何用处。如果您按下指示“无法处理请求”的访问键，您只会听到哔声

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-06T05:36:16.703

关于 TextBlocks 和 Labels 混淆的两个最大原因是 Windows 窗体和常识。

1.  当您想在 Windows 窗体中的表单上添加少量文本时，您使用了标签，因此（错误地）您将使用 WPF 标签执行相同的操作。

2.  常识会让您相信 Label 是轻量级的，而 TextBlock 不是，而事实恰恰相反。

请注意，您可以将 TextBlock 放在标签内。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-30T12:37:45.143

`TextBlock`我猜我们可以很容易地获得多线支持 -使用`TextWrapping`.

在这种情况下使用`Label`，例如显示验证消息，需要使用`<AccessKey>`标签，这比`TextBlock`.

另一方面，使用`TextBlock`不允许我们设置`BorderBrush`属性。

所以，对我来说，这两个控件应该组合成一个文本全功能控件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-09-13T20:34:22.153

Label 接受各种数据输入，如字符串、数字等。TextBlock，顾名思义，只接受文本字符串。

* * *

## 回答 #6

> 赞同：-9
> 
> 时间：2009-07-09T12:13:58.340

对于需要最少文本支持的情况（例如控件的标签），标签可用作 TextBlock 的替代品。使用 Label 可能是有利的，因为它比 TextBlock 需要更少的资源（更轻的重量）。

# coding-style - 编写转换函数的最佳方法

> ID：59102
> 
> 赞同：9
> 
> 时间：2008-09-12T14:19:29.537
> 
> 标签：coding-style

假设我正在编写一个在温标之间转换的函数。我想至少支持摄氏、华氏和开尔文。将源比例和目标比例作为函数的单独参数传递，还是某种组合参数更好？

示例 1 - 单独的参数：函数 convertTemperature("celsius", "fahrenheit", 22)

示例 2 - 组合参数：函数 convertTemperature("cf", 22)

函数内部的代码可能是它重要的地方。使用两个参数，确定我们要使用的公式的逻辑稍微复杂一些，但是单个参数感觉不太对劲。

想法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-12T14:21:43.150

使用第一个选项，而不是允许文字字符串（容易出错），如果您的语言支持，则采用常量值或枚举，如下所示：

```
convertTemperature (TempScale.CELSIUS, TempScale.FAHRENHEIT, 22) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-12T14:33:28.147

取决于语言。

通常，我会对枚举使用单独的参数。

如果它是一种面向对象的语言，那么我会推荐一个温度类，将温度存储在您喜欢的内部，然后以所需的任何单位输出它：

temp.celsius(); // 以摄氏度返回对象 temp 的温度

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-12T14:29:51.070

在编写这样的设计时，我喜欢对自己思考，“如果我需要添加一个额外的单元，那么设计会使其最容易做到吗？” 这样做，我得出的结论是枚举是最简单的，原因如下：

1) 添加新值很容易。2）我避免进行字符串比较

但是，转换方法怎么写呢？3p2 是 6。这意味着摄氏、华氏和开尔文有 6 种不同的组合。如果我想添加一个新的温和格式“foo”怎么办？这意味着 4p2 是 12！还有两个？5p2 = 20 组合。还有三个？6p2 = 30 种组合！

您可以快速查看每个附加修改如何需要对代码进行越来越多的更改。因此，我不进行直接转换！相反，我进行了中间转换。我会选择一种温度，开尔文说。最初，我会转换为开尔文。然后我将开尔文转换为所需的温度。是的，它确实会导致额外的计算。但是，它使代码更容易调用。添加一个新的温度单位总是只会导致对代码进行两次新的修改。简单的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-12T14:25:31.847

一些东西：

*   我会使用语法检查器或编译器可以检查的枚举类型，而不是可能输入错误的字符串。在伪 PHP 中：

    定义（'kCelsius'，0）；定义（'kFarenheit'，1）；定义（'kKelvin'，2）；$a = ConvertTemperature(22, kCelsius, kFarenheit);

另外，对我来说，首先放置您操作的东西似乎更自然，在这种情况下，*首先*要转换的温度。它为您的参数提供了逻辑顺序（转换 - 什么？从？到？），因此有助于助记符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-12T14:30:44.330

如果您使用第一种方法，您的功能将更加强大。如果您需要添加另一个比例，那就是要处理的另一个参数值。在第二种方法中，添加另一个比例意味着添加与列表中已有比例一样多的值，乘以 2。（例如，要将 K 添加到 C 和 F，您必须添加 KC、KF、CK 和CF。）

构建程序的一种体面方法是首先将输入的任何内容转换为任意选择的中间比例，然后从该中间比例转换为输出比例。

更好的方法是为各种尺度建立一个小的斜率和截距库，只需查找传入和传出尺度的数字，然后在一个通用步骤中进行计算。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-12T15:00:59.983

在 C#（可能还有 Java）中，最好创建一个温度类，将温度私下存储为摄氏度（或其他），并具有摄氏度、华氏度和开尔文属性，可以在 get 和 set 语句中为您完成所有转换？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-12T14:24:30.257

取决于您将进行多少次转换。我可能会选择一个参数，以枚举形式给出：考虑这个扩展版本的转换。

```
enum Conversion
{
  CelsiusToFahrenheit,
  FahrenheitToCelsius,
  KilosToPounds
}

Convert(Conversion conversion, X from); 
```

您现在在调用点拥有健全的类型安全性 - 无法给出正确类型的参数，从而给出不正确的运行时结果。考虑替代方案。

```
enum Units
{
  Pounds,
  Kilos,
  Celcius,
  Farenheight
}

Convert(Unit from, Unit to, X fromAmount); 
```

我可以安全地输入电话

```
Convert(Pounds, Celcius, 5, 10); 
```

但是结果是没有意义的，你将不得不在运行时失败。是的，我知道您目前只处理温度，但一般概念仍然成立（我相信）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-12T14:24:52.020

我会枚举温度类型并传入 2 个比例参数。像（在 c# 中）：

```
 public void ConvertTemperature(TemperatureTypeEnum SourceTemp,
                               TemperatureTypeEnum TargetTemp, 
                               decimal Temperature)
{} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-12T14:25:57.227

我会选

> 示例 1 - 单独的参数：函数 convertTemperature("celsius", "fahrenheit", 22)

否则，在您的函数定义中，您将不得不将“cf”解析为“celsius”和“fahrenheit”，以获得所需的转换比例，这可能会变得混乱。

如果您向用户提供诸如 Google 搜索框之类的内容，那么使用“cf”之类的便捷快捷方式对他们来说非常有用。不过，在下面，我会在外部函数中将“cf”转换为“celsius”和“fahrenheit”，然后再调用上面的 convertTemperature()。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-12T14:27:23.167

在这种情况下，单个参数看起来完全模糊；

功能将*温度*从*一个刻度*转换为*另一个刻度*。
IMO 将源和目标比例作为单独的参数传递更为自然。我绝对不想尝试掌握第一个参数的格式。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-12T14:49:34.923

我一直在寻找使用对象来解决我的编程问题的方法。我希望这意味着我比仅使用函数来解决问题时更加面向对象，但这还有待观察。

在 C# 中：

```
interface ITemperature
{
     CelciusTemperature ToCelcius();
     FarenheitTemperature ToFarenheit();
}

struct FarenheitTemperature : ITemperature
{
    public readonly int Value;
    public FarenheitTemperature(int value)
    {
        this.Value = value;
    }

    public FarenheitTemperature ToFarenheit() { return this; }
    public CelciusTemperature ToCelcius()
    {
        return new CelciusTemperature((this.Value - 32) * 5 / 9);
    }

}

struct CelciusTemperature
{
    public readonly int Value;
    public CelciusTemperature(int value)
    {
        this.Value = value;
    }

    public CelciusTemperature ToCelcius() { return this; }
    public FarenheitTemperature ToFarenheit()
    {
        return new FarenheitTemperature(this.Value * 9 / 5 + 32);
    }
} 
```

和一些测试：

```
 // Freezing
        Debug.Assert(new FarenheitTemperature(32).ToCelcius().Equals(new CelciusTemperature(0)));
        Debug.Assert(new CelciusTemperature(0).ToFarenheit().Equals(new FarenheitTemperature(32)));

        // crossover
        Debug.Assert(new FarenheitTemperature(-40).ToCelcius().Equals(new CelciusTemperature(-40)));
        Debug.Assert(new CelciusTemperature(-40).ToFarenheit().Equals(new FarenheitTemperature(-40))); 
```

以及这种方法避免的错误示例：

```
 CelciusTemperature theOutbackInAMidnightOilSong = new CelciusTemperature(45);
        FarenheitTemperature x = theOutbackInAMidnightOilSong; // ERROR: Cannot implicitly convert type 'CelciusTemperature' to 'FarenheitTemperature' 
```

添加开尔文转换留作练习。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-12T15:07:18.283

顺便说一句，正如问题陈述中所建议的那样，实现三参数版本不必做更多的工作。

这些都是线性函数，所以你可以实现类似

```
float LinearConvert(float in, float scale, float add, bool invert); 
```

最后一个布尔值表示您是要进行正向变换还是反转它。

在您的转换技术中，您可以使用 X -> Kelvin 的比例/加法对。当您收到将格式 X 转换为 Y 的请求时，您可以先运行 X -> Kelvin，然后通过反转 Y -> Kelvin 过程（通过将最后一个布尔值翻转为 LinearConvert）运行 Kelvin -> Y。

这种技术在您的转换函数中为您提供了 4 行实际代码，并且为您需要在其之间转换的每种类型提供了一条数据。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-12T15:23:55.530

类似于@Rob @wcm 和@David 解释的...

```
public class Temperature
{
    private double celcius;

    public static Temperature FromFarenheit(double farenheit)
    {
        return new Temperature { Farhenheit = farenheit };
    }

    public static Temperature FromCelcius(double celcius)
    {
        return new Temperature { Celcius = celcius };
    }

    public static Temperature FromKelvin(double kelvin)
    {
        return new Temperature { Kelvin = kelvin };
    }

    private double kelvinToCelcius(double kelvin)
    {
        return 1; // insert formula here
    }

    private double celciusToKelvin(double celcius)
    {
        return 1; // insert formula here
    }

    private double farhenheitToCelcius(double farhenheit)
    {
        return 1; // insert formula here
    }

    private double celciusToFarenheit(double kelvin)
    {
        return 1; // insert formula here
    }

    public double Kelvin
    {
        get { return celciusToKelvin(celcius); }
        set { celcius = kelvinToCelcius(value); }
    }

    public double Celcius
    {
        get { return celcius; }
        set { celcius = value; }
    }

    public double Farhenheit
    {
        get { return celciusToFarenheit(celcius); }
        set { celcius = farhenheitToCelcius(value); }
    }
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-12T17:09:49.580

我想我会全力以赴。您可以编写一种迷你语言，它可以像**单位**一样进行任何类型的转换：

```
$ units 'tempF(-40)' tempC
    -40 
```

或者使用像最近的[Convert::Temperature](http://search.cpan.org/~mopy/Convert-Temperature-0.03/) Perl 模块这样的单个函数：

```
use Convert::Temperature;

my $c = new Convert::Temperature();

my $res = $c->from_fahr_to_cel('59'); 
```

但这带来了一个重要的点——你使用的语言是否已经具有转换功能？如果是这样，他们使用什么编码约定？因此，如果语言是 C，最好遵循 atoi 和 strtod 库函数的示例（未经测试）：

```
double fahrtocel(double tempF){
    return ((tempF-32)*(5/9));
}

double celtofahr(double tempC){
    return ((9/5)*tempC + 32);
} 
```

* * *

在写这篇文章时，我遇到了一篇关于使用 emacs 转换日期的[非常有趣的文章。](http://www.leancrew.com/all-this/2008/04/emacs-lisp-as-a-scripting-language/)这个主题的要点是它使用了每次转换一个函数的风格。此外，转换可能非常模糊。我倾向于使用 SQL 进行日期计算，因为该代码中似乎不太可能有很多错误。将来，我将研究使用 emacs。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-12-15T15:27:32.733

这是我对此的看法（使用 PHP）：

```
function Temperature($value, $input, $output)
{
    $value = floatval($value);

    if (isset($input, $output) === true)
    {
        switch ($input)
        {
            case 'K': $value = $value - 273.15; break; // Kelvin
            case 'F': $value = ($value - 32) * (5 / 9); break; // Fahrenheit
            case 'R': $value = ($value - 491.67) * (5 / 9); break; // Rankine
        }

        switch ($output)
        {
            case 'K': $value = $value + 273.15; break; // Kelvin
            case 'F': $value = $value * (9 / 5) + 32; break; // Fahrenheit
            case 'R': $value = ($value + 273.15) * (9 / 5); break; // Rankine
        }
    }

    return $value;
} 
```

基本上，该`$input`值被转换为标准摄氏刻度，然后再次转换回`$output`刻度 - 一个函数来统治它们。=)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-12T14:22:36.813

我的投票是转换类型的两个参数，一个用于值（如您的第一个示例中所示）。但是，我会使用枚举而不是字符串文字。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-12T14:23:14.317

如果您的语言允许，请使用枚举作为单位规范。

我想说两个里面的代码会更容易。我有一个带有预加、乘法和后加的表，并通过一个单元的项目运行值，然后反向运行另一个单元的项目。基本上将输入温度转换为内部的公共基础值，然后输出到另一个单元。这整个函数将是表驱动的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-13T01:33:08.280

我希望有某种方法可以接受多个答案。根据大家的建议，我想我会坚持使用多个参数，将字符串更改为枚举/常量，并将要转换的值移动到参数列表中的第一个位置。在函数内部，我将使用 Kelvin 作为一个共同的中间立场。

以前我为每个转换编写了单独的函数，整个 convertTemperature() 函数只是一个带有嵌套 switch 语句的包装器。我用经典的 ASP 和 PHP 编写，但我想把这个问题留给任何语言。

# language-agnostic - 您是否精通 Unicode？

> ID：59105
> 
> 赞同：12
> 
> 时间：2008-09-12T14:21:25.757
> 
> 标签：language-agnostic, unicode, internationalization, ascii

大约 5 年前，Joel Spolsky 写了这篇文章，[“每个软件开发人员绝对、肯定必须了解 Unicode 和字符集的绝对最低要求（没有借口！）”](http://www.joelonsoftware.com/articles/Unicode.html)。

像许多人一样，我仔细阅读了它，意识到是时候掌握这个“ASCII 替代品”了。不幸的是，5 年后，我觉得我在这方面又陷入了一些坏习惯。你？

我没有编写很多专门的国际应用程序，但是我帮助建立了许多面向 ASP.NET 互联网的网站，所以我想这不是借口。

因此，为了我的利益（我相信还有很多其他人），我可以从以下人员那里获得一些意见：

*   如何一劳永逸地“克服”ASCII
*   使用 Unicode 时的基本指导。
*   推荐的（最近的）关于 Unicode 的书籍和网站（面向开发人员）。
*   Unicode 的现状（Joels 发表文章 5 年后）
*   未来发展方向。

我必须承认我有 .NET 背景，因此我也很乐意了解 .NET 框架中的 Unicode 信息。当然，这不应该阻止任何具有不同背景的人发表评论。

更新：请参阅之前在 StackOverflow 上提出的[这个相关问题。](https://stackoverflow.com/questions/898/internationalization-in-your-projects)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-12T14:38:56.557

自从我阅读了 Joel 文章和其他一些 I18n 文章以来，我一直密切关注我的字符编码；如果您始终如一地这样做，它实际上会起作用。如果您在一家标准使用 UTF-8 的公司工作，并且每个人都知道/做到这一点，那么它将起作用。

这里有一些关于这个主题的有趣文章（除了 Joel 的文章）：

*   [http://www.tbray.org/ongoing/When/200x/2003/04/06/Unicode](http://www.tbray.org/ongoing/When/200x/2003/04/06/Unicode)
*   [http://www.tbray.org/ongoing/When/200x/2003/04/26/UTF](http://www.tbray.org/ongoing/When/200x/2003/04/26/UTF)

第一篇文章的引述；使用 Unicode 的提示：

*   拥抱 Unicode，不要与之抗争；这可能是正确的做法，如果不是，您可能无论如何都必须这样做。
*   在您的软件中，将文本存储为 UTF-8 或 UTF-16；也就是说，两者选其一并坚持下去。
*   尽可能使用 XML 与外界交换数据；这使得一大堆潜在的问题消失了。
*   尝试使您的应用程序基于浏览器而不是编写您自己的客户端；浏览器在处理世界文本方面变得非常好。
*   如果你正在使用其他人的库代码（当然你是），假设它的 Unicode 处理被破坏，直到被证明是正确的。
*   如果您正在搜索，请尝试将语言和字符处理问题交给了解它们的人。
*   去亚马逊或其他地方购买印刷的 Unicode 标准的最新版本；它包含了您需要知道的所有内容。
*   花一些时间浏览 Unicode 网站并了解代码图表的工作原理。
*   如果您需要认真研究亚洲语言，请购买 Ken Lunde 所著的 O'Reilly 书籍。
*   如果您有 Macintosh，请使用 Lord Pixel 的 Unicode 字体检查工具。非常酷。
*   如果您真的要对数据感到厌烦，请参加一年两次的 Unicode 会议。所有的专家都会去，如果你不知道你需要知道什么，你可以在那里找到知道的人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-12T14:26:19.567

我花了一段时间使用搜索引擎软件——你不会相信有多少网站提供带有 HTTP 标头或元标记的内容，这些内容与页面的编码有关。通常，您甚至会得到一个包含 ISO-8859 字符和 UTF-8 字符的文档。

一旦您解决了其中一些问题，您就开始认真对待您生成的数据的正确字符编码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-12T15:08:56.237

.NET Framework 使用 Windows 默认编码来存储字符串，结果是 UTF-16。如果您在使用大多数文本 I/O 类时没有指定编码，您将编写没有 BOM 的 UTF-8，并通过首先检查 BOM 然后假设 UTF-8 来读取（我肯定知道`StreamReader`并`StreamWriter`以这种方式行事。 ) 这对于无法理解 BOM 的“愚蠢”文本编辑器来说是相当安全的，但对于可以显示 UTF-8 的更智能的文本编辑器或您实际编写标准 ASCII 范围之外的字符的情况来说，这有点粗糙。

通常这是看不见的，但它可以以有趣的方式抬头。昨天我和一个使用 XML 序列化将对象序列化为字符串的人一起工作`StringWriter`，他不明白为什么编码总是 UTF-16。由于内存中的字符串将是 UTF-16 并且由 .NET 强制执行，因此这是 XML 序列化框架唯一可以做的事情。

因此，当我编写的不仅仅是一次性工具时，我会使用 BOM 指定 UTF-8 编码。从技术上讲，在 .NET 中，您总是会意外地意识到 Unicode，但前提是您的用户知道将您的编码检测为 UTF-8。

每次看到有人问“我如何获取字符串的字节数”时，我都会哭笑不得。建议的解决方案使用`Encoding.ASCII.GetBytes()`:(

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-12T14:54:41.620

经验法则：如果您从不研究或查看字符串内部，而是严格将其视为数据块，您的情况会好得多。

如果您想以“Unicode 方式”来做，即使是像拆分单词或小写字符串这样简单的事情也会变得困难。

如果你想以“Unicode 方式”来做，你需要一个非常好的库。这东西非常复杂。

# java - 我可以将以下代码转换为使用泛型吗？

> ID：59107
> 
> 赞同：18
> 
> 时间：2008-09-12T14:21:39.483
> 
> 标签：java, generics, comparison

我正在将应用程序转换为使用 Java 1.5 并找到以下方法：

```
 /**
   * Compare two Comparables, treat nulls as -infinity.
   * @param o1
   * @param o2
   * @return -1 if o1&lt;o2, 0 if o1==o2, 1 if o1&gt;o2
   */
  protected static int nullCompare(Comparable o1, Comparable o2) {
    if (o1 == null) {
      if (o2 == null) {
        return 0;
      } else {
        return -1;
      }
    } else if (o2 == null) {
      return 1;
    } else {
      return o1.compareTo(o2);
    }
  } 
```

理想情况下，我想让该方法采用两个相同类型的 Comparables，是否可以转换它以及如何转换？

我认为以下方法可以解决问题：

```
protected static <T extends Comparable> int nullCompare(T o1, T o2) { 
```

但它未能消除 IntelliJ 中的警告“未检查调用 'compareTo(T)' 作为原始类型 'java.lang.Comparable' 的成员”：

```
return o1.compareTo(o2); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-12T14:24:53.267

将其更改为：

```
protected static <T extends Comparable<T>> int nullCompare(T o1, T o2) { 
```

您需要它，因为 Comparable 本身就是一个泛型类型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T17:42:56.277

这是一个奇怪的案例：

```
static class A {
    ...
}

static class B extends A implements Comparable<A> {
    public int compareTo(A o) {
        return ...;
    }
} 
```

幸运的是，像上面这样的代码很少见，但是 nullCompare() 将不支持 Bs 的比较，除非声明 Comparable 可以应用于 T*或其任何超类*：

```
protected static <T extends Comparable<? super T>> int nullCompare(T o1, T o2) { 
```

尽管大多数人永远不会从上述调整中受益，但在为导出的库设计 API 时它可能会派上用场。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T23:18:25.597

无法编辑，所以我必须发布我的答案。

您需要声明嵌套类型参数，因为 Comparable 是通用的。

```
protected static <T extends Comparable<? super T>> int nullCompare(T o1, T o2) { 
```

请注意**Comparable< ? super T >**，这使得更灵活。您将在 Collections.sort 上看到相同的方法定义

```
public static <T extends Comparable<? super T>> void sort(List<T> list) { 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T15:30:53.343

我不确定泛化这种方法是否有意义。目前该方法适用于任何类型的 Comparable；如果您对其进行泛化，您将不得不多次实现它（使用完全相同的代码）。有时可以比较两个没有共同祖先的对象，但任何通用版本都不允许这样做。

通过添加泛型，您不会给代码增加任何安全性；在调用 compareTo 时会出现任何安全问题。我的建议只是压制警告。它并没有真正警告你任何有用的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T19:51:12.673

为了使其更通用，您甚至可以让它适用于两种不同的类型。=P

```
 /**
   * Compare two Comparables, treat nulls as -infinity.
   * @param o1
   * @param o2
   * @return -1 if o1&lt;o2, 0 if o1==o2, 1 if o1&gt;o2
   */
  protected static <T> int nullCompare(Comparable<? super T> o1, T o2) {
    if (o1 == null) {
      if (o2 == null) {
        return 0;
      } else {
        return -1;
      }
    } else if (o2 == null) {
      return 1;
    } else {
      return o1.compareTo(o2);
    }
  } 
```

# visual-studio-2005 - VS 2005 安装程序项目版本号

> ID：59120
> 
> 赞同：2
> 
> 时间：2008-09-12T14:25:08.697
> 
> 标签：visual-studio-2005, installation

现在我遇到了这个错误，因为我点击了版本号 1.256.0：错误 4 无效的产品版本“1.256.0”。格式必须为 '##.##.####'

安装程序在 1.255.0 上很好，但在 256 (2^8) 上它不喜欢。我在 msdn.com 上发现了这一点：Version 属性必须格式化为 NNN，其中每个 N 代表至少一位且不超过四位数字。( [http://msdn.microsoft.com/en-us/library/d3ywkte8(VS.80).aspx](http://msdn.microsoft.com/en-us/library/d3ywkte8(VS.80).aspx) )

这会让我相信 1.256.0 没有任何问题，因为它符合上述规则。

有没有人知道为什么现在会失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-12T14:38:57.133

您引用的链接显示“此页面特定于 Microsoft Visual Studio 2008/.NET Framework 3.5”，但您说的是 vs2005。

我的猜测：从 0 开始的 256 个数字范围以 255 结尾，因此尝试使用 256 超出了这个范围，也许他们为 VS2008 更改了它

编辑：我又看了一遍，看看该链接在哪里可以切换到谈论 VS2005，并给出了相同的答案。不过，我仍然坚持我的 0-255 理论。这不是本周我第一次在 MSDN 文档中遇到不正确的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T15:03:30.930

这篇文章说主要和次要最大值为 255。

[http://msdn.microsoft.com/en-us/library/aa370859(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa370859(VS.85).aspx)

# java - 我应该用 JUnit 运行什么 GUI（类似于 NUnit gui）

> ID：59128
> 
> 赞同：10
> 
> 时间：2008-09-12T14:27:53.823
> 
> 标签：java, ide, junit

应该使用什么 GUI 来运行我的 JUnit 测试，我该怎么做？我的整个背景都是 .NET，所以我习惯于启动我的 NUnit gui 并运行我的单元测试。如果灯是绿色的，我就干净了。

现在，我必须编写一些 Java 代码并想使用 JUnit 运行类似的东西。JUnit 文档非常清楚地说明了添加创建测试所需的属性，但它非常依赖于如何启动运行程序并查看这些测试的结果。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-12T20:58:38.313

在 JUnit 4 发布之后，JUnit 停止了图形化运行器。

如果您确实有早期版本的 JUnit，您可以通过在命令行 [1] 中输入来使用图形测试运行器：

```
java junit.swingui.TestRunner [可选TestClass]

```

使用可选的测试类，指定的测试将立即运行。没有它，您可以将类输入到 GUI 中。

以这种方式运行测试的好处是您没有整个 IDE 的开销（如果您还没有运行一个）。但是，如果您已经在 Eclipse 等 IDE 中工作，那么集成非常好，而且运行测试的麻烦也少了很多。

如果您确实有 JUnit 4，并且真的不想使用 IDE 来运行测试，或者想要文本反馈，您可以运行文本 UI 测试运行程序。与之前类似，这可以通过在命令行中输入来完成[1]：

```
java junit.textui.TestRunner [TestClass]

```

尽管在这种情况下 TestClass 不是可选的，但原因很明显。

[1] 假设您在正确的工作目录中并且已设置类路径，这可能超出此答案的范围

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-12T15:17:20.380

Eclipse 是迄今为止我用过的最好的。将JUnit 与[代码覆盖率](http://www.eclemma.org/)插件和 Eclipse 结合起来可能是最好的单元测试器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-12T14:30:04.720

有一个具有 UI 的独立 JUnit 运行器，但我建议使用 Java IDE 中的内置测试运行器之一（Eclipse、Netbeans 和 IntelliJ 都有很好的）。它们都支持 JUnit，并且大多数也支持 TestNG。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T05:34:09.533

如果您想要一个独立的测试运行器（而不是内置的 IDE），那么对于 Junit3，您可以使用

*   `junit.textui.TestRunner %your_class%`- 基于命令行的运行器
*   `junit.swingui.TestRunner [%your_class%]`- 带有用户界面的跑步者（摇摆驱动）

对于 Junit4，UI 驱动的运行器已被删除，到目前为止，我还没有找到一个方便的解决方案来在旧的摇摆驱动运行器上运行新的 Junit4 测试，而无需额外的库。但是您可以使用[JUnit 4 Extensions](http://junitext.sourceforge.net/index.html)，它提供了使用 junit.swingui.TestRunner 的解决方法。更多[在这里](http://talkingjas.blogspot.com/2010/07/how-to-run-your-junit-4-tests-using-old.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T15:24:44.480

为什么需要 GUI 运行器？您不能只从 IDE 本身运行测试吗？

在 .Net 中我们有[TestDriven.net](http://testdriven.net/)，在 Java 中必须有等价的东西。您可以查看[IntelliJ IDEA](http://en.wikipedia.org/wiki/IntelliJ_IDEA)，它内置了单元测试支持。

# java - JavaFX 支持/将支持哪些平台？

> ID：59129
> 
> 赞同：4
> 
> 时间：2008-09-12T14:28:14.647
> 
> 标签：java, javafx

我已经阅读了有关 JavaFX 的信息，并且像所有新技术一样，我想让我的手“弄脏”它。然而，虽然它谈到了多平台支持，但我找不到这方面的细节。

哪些平台支持 JavaFX 应用程序？所有使用 Java SE 的人？我？它是否取决于我使用的 JavaFX 中的 API？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-16T18:34:02.933

JavaFX 有三个计划的发行版。

*   JavaFX Desktop 将在 FCS 的 Windows、Mac、~~Linux 和 Solaris~~上运行，并且需要 Java SE。即将支持 Linux 和 Solaris。
*   JavaFX TV 和 JavaFX Mobile 没有公布目标平台。同样未宣布的是它们是否将在 ME 或 SE 上运行，以及如果 ME 是哪些配置文件。

一个重要的平台区别是 JavaFX Desktop 将支持 Swing 组件，而 JavaFX Mobile 不支持（仅用于图形的场景图）。JavaFX TV 目前是三者中最不公开具体的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-12T15:24:03.233

据我所知，JavaFX 是一个全新的运行时和编译器，因此不是 Java 的子集。Sun 将在手机和桌面上支持它。

操作系统方面，它目前是为 Windows/Mac 发布的，但 Solaris/Linux 正在开发中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T17:23:52.717

JavaFx 不是一个新的运行时。它是同一个 JRE，但它是一种新的语言/编译器，带有一些新的 API 以使其一切正常......

使用 Netbeans，您可以在任何平台上构建应用程序。截至今天，这些 API 是测试版。编译器生成的类文件与 JRE 6 兼容。

# asp.net - 全球化 asp.net 应用程序需要了解什么？

> ID：59130
> 
> 赞同：14
> 
> 时间：2008-09-12T14:28:18.220
> 
> 标签：asp.net, unicode, localization, globalization

我正在编写一个 asp.net 应用程序，该应用程序需要本地化到北美以外的几个地区。我需要做些什么来为这种全球化做准备？学习如何编写面向世界的应用程序的前 1 到 2 个资源是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-12T14:54:28.330

我学到的几件事：

*   绝对且残酷地减少您拥有的包含文本的图像数量。这样做将使您的生活轻松 10 亿%，因为您不必为每种该死的语言获取一组新图像。

*   要非常警惕依赖于始终保持相同大小的事物的 css 定位。如果这些东西包含文本，它们将**不会**保持相同的大小，然后您将需要返回并修复您的设计。

*   如果您在 sql 表中使用字符类型，请确保任何可能接收国际输入的字符类型都是 unicode（nchar、nvarchar、ntext）。就此而言，我只是标准化使用 unicode 版本。

*   如果您正在动态构建 SQL 查询，请确保在任何引用的文本之前包含 N 前缀，如果文本有可能是 unicode 的话。如果您最终将垃圾放入 SQL 表中，请检查是否存在。

*   确保您的所有网页都明确声明它们是 unicode 格式。请参阅上面提到的 Joel 的文章。

*   您将在这个项目中大量使用资源文件。这很好——ASP.NET 2.0 对此有很好的支持。您需要查看 App_LocalResources 和 App_GlobalResources 文件夹以及 GetLocalResourceObject、GetGlobalResourceObject 和 meta:resourceKey 的概念。[Professional ASP.NET 2.0](https://rads.stackoverflow.com/amzn/click/com/0470041781)的第 30 章对此有一些很好的内容。这本书的 3.5 版本可能也有很好的内容，但我不拥有它。

*   想想字体。您可能想要使用的许多标准字体不支持 unicode。我一直很幸运使用 Arial Unicode MS、MS Gothic、MS Mincho。不过，我不确定这些是如何跨平台的。另请注意，并非所有字体都支持所有 Unicode 字符定义。再次，测试，测试，测试。

*   现在开始考虑如何将翻译输入到这个系统中。与您的翻译供应商讨论他们希望如何来回传递数据以进行翻译。想想这样一个事实，通过您的本地资源文件，您可能会在系统中重复一些常用的字符串。您是否将它们规范化为全局资源文件，或者您是否有某种数据库层，其中每个使用的文本只生成一个副本。在我们最近的项目中，我们使用了从包含所有翻译和资源文件的原始英文版本的数据库表中生成的资源文件。

*   测试。一般来说，我会用德语、波兰语和亚洲语言（日语、汉语、韩语）进行考试。德语和波兰语很冗长，几乎可以保证会拉伸文本区域，亚洲语言使用完全不同的字符集来测试您的 unicode 支持。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-12T14:30:32.223

了解 System.Globalization 命名空间：

[系统全球化](http://msdn.microsoft.com/en-us/library/system.globalization.aspx)

另外，一本好书是[NET Internationalization: The Developer's Guide to Building Global Windows and Web Applications](https://rads.stackoverflow.com/amzn/click/com/0321341384)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-12T14:33:21.577

如果您针对的是其他文化、语言，那么在 Unicode 上稍微刷新一下会很好。

[每个软件开发人员绝对、绝对必须了解 Unicode 和字符集的绝对最低要求（没有借口！）](http://www.joelonsoftware.com/articles/Unicode.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-12T14:57:59.070

这是一个难题。我住在加拿大，所以多语种是一个大问题。在我从事软件开发的所有这些年中，我从未见过我喜欢的解决方案。我见过很多有效的解决方案，并且完成了工作，但它们总是感觉像是一个大杂烩。我会选择@harriyott，并确保您的所有字符串实际上都不是代码。资源文件适用于桌面应用程序。但是在 ASP.Net 中，我建议使用数据库。@John Christensen 也有一些很好的建议。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-12T15:08:55.080

确保您在打开代码分析的情况下进行编译，并注意它给您的[全球化警告。](http://msdn.microsoft.com/en-us/library/ms182184.aspx)以不变的格式 ( [CultureInfo.InvariantCulture](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.invariantculture.aspx) ) 保存数据，直到将其显示给用户（然后使用[CultureInfo.CurrentCulture](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.currentculture.aspx)）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-13T07:29:52.650

**我会认真考虑阅读以下代码项目文章：**

[ASP.NET 2.0 中的全球化和本地化揭秘](http://www.codeproject.com/Kb/aspnet/localizationByVivekTakur.aspx)

它涵盖了文化和区域设置的所有内容，设置线程当前的文化、资源文件、编码，你可以命名它！

当然，它加载了漂亮的图片和示例:-)。祝你好运！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-12T14:48:21.213

我会建议：

1.  将所有字符串放在数据库或资源文件中。
2.  为翻译的文本留出额外的空间，因为有些（例如德语）比较冗长。

# bug-tracking - Bugzilla 中的错误模板

> ID：59133
> 
> 赞同：4
> 
> 时间：2008-09-12T14:30:09.120
> 
> 标签：bug-tracking, bugzilla

有没有办法在 Bugzilla 中强制使用模板来指导用户填写错误描述？

实际上，我想在错误描述字段中放置一些标记文本，并避免创建自定义字段。

我已经安装了 3.2rc1 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T17:03:00.437

实际上，只需检查 ../enter_bug.cgi?format=guided ，它就构成了模板功能的一个示例。一半的工作已经为你完成了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T14:50:41.817

[6.2.5 特定模板](https://www.bugzilla.org/docs/2.18/html/cust-templates.html)下描述的机制（在 bug/create/create.html.tmpl 和 bug/create/comment.txt.tmpl 部分下）对我们来说非常有效。即使您说您不想创建自定义字段，添加一些任意 HTML 也很容易。

# windows - Subversion 客户端应用程序

> ID：59148
> 
> 赞同：11
> 
> 时间：2008-09-12T14:38:02.520
> 
> 标签：windows, svn

您推荐使用哪个**独立的 Windows GUI 应用程序来访问 Subversion 存储库？**

编辑：很多人都在提到 Tortoise，但是我正在寻找一个应用程序而不是 shell 扩展。人们也在质疑我不想使用 shell 扩展的理由。在我们的环境中，我们宁愿通过管理应用程序与存储库交互（不使用 IDE 插件时），而不是通过 Windows 资源管理器导航文件。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-12T14:48:07.673

**独立客户端**

对于完全独立的[Synchro SVN](http://www.syncrosvnclient.com/)来说，它是一个强大的跨平台解决方案。它看起来像是每个平台上最原生的应用程序。

[Subversion 网站](http://subversion.tigris.org/links.html#clients)包括其他**独立 SVN 客户端**的列表（大多数是跨平台的）。[[以下从http://subversion.tigris.org/links.html#clients](http://subversion.tigris.org/links.html#clients])复制的列表]

**eSvn** - 基于 QT 的跨平台 GUI 前端到 Subversion [http://sourceforge.net/projects/esvn](http://sourceforge.net/projects/esvn)

**FSVS** - 以软件部署为中心的快速颠覆命令行客户端 [http://fsvs.tigris.org/](http://fsvs.tigris.org/)

**KDESvn** - KDE 的 Subversion 客户端 [http://www.alwins-world.de/wiki/programs/kdesvn](http://www.alwins-world.de/wiki/programs/kdesvn)

**QSvn** - 一个跨平台的 GUI Subversion 客户端 [http://ar.oszine.de/projects/qsvn/](http://ar.oszine.de/projects/qsvn/)

**RapidSVN** - Subversion 的跨平台 GUI 前端 [http://rapidsvn.tigris.org/](http://rapidsvn.tigris.org/)

**RSVN** - Python 脚本，允许在单个原子事务中进行多个存储库端操作。 [https://opensvn.csie.org/traccgi/rsvn/trac.cgi/wiki](https://opensvn.csie.org/traccgi/rsvn/trac.cgi/wiki)

**SmartSVN** - Subversion 的跨平台 GUI 客户端（非开源。提供免费和商业版本。） [https://www.smartsvn.com/](https://www.smartsvn.com/)

**Subcommander** - 一个跨平台的 Subversion GUI 客户端，包括一个可视化文本合并工具。 [http://subcommander.tigris.org/](http://subcommander.tigris.org/)

**SvnX** - Mac OS X Panther GUI 客户端。 [http://www.lachoseinteractive.net/en/community/subversion/svnx/](http://www.lachoseinteractive.net/en/community/subversion/svnx/)

**Syncro SVN Client** - 跨平台图形 Subversion 客户端。（非开源。Mac OS X、Windows 和 Linux 提供免费试用版。） [http://www.syncrosvnclient.com](http://www.syncrosvnclient.com)

**WorkBench** - 基于用 Python 编写的 Subversion 构建的跨平台软件开发 GUI [http://pysvn.tigris.org/](http://pysvn.tigris.org/)

**版本**- 适用于 Mac OS X 的 GUI Subversion 客户端。（非开源​​；需要商业许可。） [http://www.versionsapp.com/](http://www.versionsapp.com/)

**ZigVersion** - Mac OS X 的 Subversion 界面。旨在围绕程序员的典型工作流程设计界面。（请注意，这不是开源的。） [http://zigversion.com/](http://zigversion.com/)

**集成客户端**

[TortoiseSVN](http://tortoisesvn.tigris.org/)是最好的通用系统[集成系统不是独立的 - 感谢 Martin Kenny]。它将自身集成到 Windows 资源管理器中（您可以在资源管理器或任何 shell 对话框中使用它），因此它工作得非常好，并为您提供了 SVN 的全部功能。

[Ankhsvn](http://ankhsvn.open.collab.net/)是一个很好的解决方案，可以集成到 Visual Studios（Express Editions 除外）中。

[SVN Notifier](http://svnnotifier.tigris.org/)监控您的存储库，并在任何更改时通知您。它与 TortoiseSVN 集成以向您显示差异和提交日志。在团队环境中工作时非常方便。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-12T14:38:52.937

[TortoiseSVN](http://tortoisesvn.tigris.org/)

从他们的网站：

> 一个 Subversion 客户端，实现为 Windows shell 扩展。
> 
> TortoiseSVN 是一款非常易于使用的 Windows 版本控制/版本控制/源代码控制软件。由于它不是针对特定 IDE 的集成，因此您可以将它与您喜欢的任何开发工具一起使用。TortoiseSVN 可以免费使用。您无需获得贷款或支付全部年薪即可使用它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-12T14:40:44.057

您可以尝试使用 SmartSVN - [https://www.smartsvn.com/](https://www.smartsvn.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-12T15:19:13.980

你能解释一下为什么 TortoiseSVN 不适合你吗？这将帮助我们弄清楚您在应用程序中真正需要什么。

将 TortoiseSVN 与 Windows 资源管理器结合使用，您就拥有了一个很棒的工具，如果您想与 Visual Studio 集成，可以选择 VisualSVN。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-12T14:46:20.360

作为一个外壳扩展，我想它在技术上不是一个独立的应用程序，但是对于 TortoiseSVN 来说是 +1。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-12T14:46:52.013

我建议开始使用[TortoiseSVN](http://tortoisesvn.tigris.org/)（基本上，它向资源管理器添加了与 SVN 相关的上下文菜单），但它可能会非常消耗内存。

我通常在需要时使用它，但也使用 subversion 附带的非常干净和可用的命令行工具以及作为 Eclipse 一部分的 Subclipse。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-12T14:57:19.960

对于完全独立的[Synchro SVN](http://www.syncrosvnclient.com/)（60 美元）来说，它是外观最好、功能最齐全的产品之一。它是跨平台的（Win、Linux、OSX）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-12T14:59:30.017

唯一的[tortoiseSVN](http://tortoisesvn.net/downloads)！

它集成在 Windows 资源管理器中，您可以通过右键单击来调用它。所有命令都在 TortoiseSVN 菜单下，除了经常使用的命令，例如**update**、**commit**或**diff**（它是可配置的）。

出于某种原因，SVN 属性位于属性菜单的选项卡中，而不是 TortoiseSVN 菜单中。这是有道理的，有点，但需要一些时间来适应它。

TortoiseSVN 非常棒，但是当我转移到 Mac（没有 Tortoise 的地方）并试图找到一个像样的工具时，我才意识到它很棒。没有什么能接近。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-12T15:00:25.867

如果您想要一个不与 Explorer 集成的客户端，而是一个独立的应用程序，[SmartSVN就很好。](https://www.smartsvn.com/)（虽然我认为以后的版本也提供了 Explorer 集成。）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-12T15:49:14.720

如果您不喜欢 shell 扩展 TortoiseSVN 可以通过其方便的自动化接口用作应用程序 - 一个可执行多个命令参数。

参见[TortoiseSVN 手册](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-automation.html "TortoiseSVN")

每个命令都会为特定任务引发一个模式对话框。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-11-08T16:22:28.353

我使用JetBrains 的[PHPStorm](http://www.jetbrains.com/phpstorm/)

它可以在MAC或WIN PC环境下使用。它有内部的 subversion/git/mercurial 工具。

尽管您必须为此付费（50 美元），但他们有 30 天的全功能试用期。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-12T15:08:33.413

内存和磁盘 IO 可能是管理 Tortoise 图标覆盖的 TSVNCache 的问题。您可以通过将结帐放在一个或两个目录中并让缓存进程只查看这些目录而不是整个驱动器来修复它。

[有关说明，请参阅此链接。](http://www.paraesthesia.com/archive/2007/09/26/optimize-tortoise-svn-cache-tsvncache.exe-disk-io.aspx)

# visual-studio-2008 - 在 Visual Studio 中将 Google Chrome 设置为调试浏览器

> ID：59154
> 
> 赞同：77
> 
> 时间：2008-09-12T14:39:54.340
> 
> 标签：visual-studio-2008, google-chrome

当我在 Visual Studio 2008 中按 F5 时，我希望启动 Google Chrome 作为我的 ASP.NET 应用程序在其中运行的浏览器。我可以知道如何做到这一点吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-09-12T14:42:25.113

右键单击 .aspx 文件并单击“浏览方式...”，然后选择 Chrome 并单击“设置为默认值”。如果需要，您可以在列表中选择多个浏览器。

还有这个非常棒的[WoVS 默认浏览器切换器 Visual Studio 扩展](http://visualstudiogallery.msdn.microsoft.com/bb424812-f742-41ef-974a-cdac607df921/)。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2017-04-05T19:19:28.860

1.  转到 Visual Studio 工具栏并单击 CPU 旁边的下拉菜单（在屏幕截图中显示 IIS Express）。选项之一应该是“浏览方式...”

    [![Visual Studio 工具栏](https://i.stack.imgur.com/o1oMW.jpg)](https://i.stack.imgur.com/o1oMW.jpg)

2.  选择浏览器，例如 Google Chrome，然后单击设为默认值

    [![浏览...](https://i.stack.imgur.com/baP0N.jpg)](https://i.stack.imgur.com/baP0N.jpg)

3.  单击浏览或取消。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-11-10T23:09:25.923

添加一些东西（因为我在搜索这个问题时发现了它，我的解决方案涉及更多）......

如果您没有 .aspx 文件的“浏览方式...”选项（因为我在 MVC 应用程序中没有），最简单的解决方案是添加一个虚拟 HTML 文件，然后右键单击它以设置答案中描述的选项。之后您可以删除该文件。

该选项实际设置在：C:\Documents and Settings[user]\Local Settings\Application Data\Microsoft\VisualStudio[version]\browser.xml

但是，如果您在 VS 运行时直接修改文件，VS 将在下次运行时使用您之前的选项覆盖它。此外，如果您在 VS 中编辑默认值，则不必担心架构是否正确，因此变通的虚拟文件可能是最简单的方法。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2015-03-19T14:29:38.100

对于 MVC 开发人员，

*   单击解决方案资源管理器中的文件夹（例如，控制器）
*   选择浏览方式...
*   选择所需的浏览器
*   （可选单击）设置为默认值

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-05-04T20:05:51.403

如果您没有看到“Browse With...”选项，请先停止调试。=)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-04T08:35:40.907

在 Visual Studio 2012 中，您只需从代码编辑器上方的下拉框中选择要调试的浏览器

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-07-01T20:34:18.930

对于win7 chrome，可以在以下位置找到：

```
C:\Users\[UserName]\AppData\Local\Google\Chrome\Application\chrome.exe 
```

对于 VS2017，单击在调试/发布模式下运行按钮旁边的小向下箭头以找到“使用...浏览”选项。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-10-30T06:45:41.563

单击开始按钮附近的箭头，您将获得浏览器列表。选择您希望运行应用程序的浏览器，然后单击“设置为默认值”单击确定，您就完成了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-17T06:40:13.497

如果您使用的是 Visual Studio 2019：要更改主页中的默认浏览器类型默认值，然后单击浏览器。

看这张图片：

[![默认应用](https://i.stack.imgur.com/qVaJp.jpg)](https://i.stack.imgur.com/qVaJp.jpg)

[参考/来源](https://docs.microsoft.com/en-us/answers/questions/31013/browser-selection-in-visual-studio-2019.html)

# c# - 你如何声明一个谓词委托内联？

> ID：59166
> 
> 赞同：43
> 
> 时间：2008-09-12T14:45:45.697
> 
> 标签：c#, delegates

所以我有一个包含一些字段的对象，这并不重要。我有这些对象的通用列表。

```
List<MyObject> myObjects = new List<MyObject>();
myObjects.Add(myObject1);
myObjects.Add(myObject2);
myObjects.Add(myObject3); 
```

所以我想根据一些标准从我的列表中删除对象。例如，`myObject.X >= 10.` 我想使用 for 的`RemoveAll(Predicate<T> match)`方法来做到这一点。

我知道我可以定义一个可以传递给 RemoveAll 的委托，但我想知道如何用匿名委托定义这个内联，而不是创建一堆只在一次地方使用的委托函数。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-09-12T14:48:08.563

有两种选择，显式委托或伪装成 Lamba 构造的委托：

显式委托

```
myObjects.RemoveAll(delegate (MyObject m) { return m.X >= 10; }); 
```

拉姆达

```
myObjects.RemoveAll(m => m.X >= 10); 
```

* * *

性能方面两者是相等的。事实上，两种语言结构在编译时都会生成相同的 IL。这是因为 C# 3.0 基本上是 C# 2.0 的扩展，因此它编译为 C# 2.0 结构

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-12T14:49:10.353

lambda C# 3.0 方式：

```
myObjects.RemoveAll(m => m.x >= 10); 
```

匿名委托 C# 2.0 方式：

```
myObjects.RemoveAll(delegate (MyObject m) {
   return m.x >= 10;
}); 
```

而且，对于 VB 人来说，VB 9.0 lambda 方式：

```
myObjects.RemoveAll(Function(m) m.x >= 10) 
```

不幸的是，VB 不支持匿名委托。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-12T14:50:41.193

```
 //C# 2.0
  RemoveAll(delegate(Foo o){ return o.X >= 10; }); 
```

或者

```
 //C# 3.0
  RemoveAll(o => o.X >= 10); 
```

或者

```
 Predicate<Foo> matches = delegate(Foo o){ return o.X >= 10; });
  //or Predicate<Foo> matches = o => o.X >= 10;
  RemoveAll(matches); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-19T09:28:42.110

Predicate 是一个委托，它接受一个参数并返回一个布尔值。

我们可以通过以下方式做同样的事情

1)**使用内联 Lambda 表达式**

```
RemoveAll(p=> p.x > 2); 
```

2)**使用匿名函数**

```
RemoveAll(delegate(myObject obj){

  return obj.x >=10;
}) 
```

3)**使用谓词委托**

```
Predicate<myObject> matches = new Predicate<myObject>(IsEmployeeIsValid);
RemoveAll(matches);

Predicate<Foo> matches = delegate(Foo o){ return o.X >= 20; });
RemoveAll(matches); 
```

3)**显式声明委托并指向函数**

```
public delegate bool IsInValidEmployee (Employee emp);

IsInValidEmployee invalidEmployeeDelegate = new IsInValidEmployee(IsEmployeeInValid);
myObjects.RemoveAll(myObject=>invalidEmployeeDelegate(myObject); 
```

// 实际函数

```
public static bool IsEmployeeInValid(Employee emp)
{
    if (emp.Id > 0 )
        return true;
    else
        return false;
} 
```

# c# - Java 的 JVM 和 .NET 的 CLR 的内部工作方式有什么区别？

> ID：59175
> 
> 赞同：19
> 
> 时间：2008-09-12T14:49:12.553
> 
> 标签：c#, java, .net, clr, jvm

Java 的 JVM 和 .NET 的 CLR 的内部工作方式有什么区别？

也许一个起点是，它们在各自的环境中是否基本相同（Java > JVM > 机器代码）（C# > CLR > IL）。

* * *

**更新：** 有几个人提到了我试图涵盖的要点：

1.  垃圾收集
2.  装箱/拆箱
3.  即时调试
4.  泛型/模板
5.  请随意提出其他区分这两者的好主题。

[@George Mauer](https://stackoverflow.com/users/5056/george-mauer) - 这听起来很有趣：

> 已经发布过一次，但这里是对 c# 首席语言设计师 Anders Hejlsberg的[一系列采访。](http://www.artima.com/intv/anders.html)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-12T15:03:12.443

这应该是一个很棒的线程。

CLR 和 JVM 之间最大的区别之一是 CLR 对泛型的本机集成。

相反，Java 删除了泛型类型，JVM 只能通过自动装箱对象来处理对象，它似乎是伪泛型。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-12T14:55:57.983

从[这里](http://social.msdn.microsoft.com/forums/en-US/clr/thread/38223155-c07c-472a-8903-6cdaf5f110ea/)。我不能说得更好（嗯，除了火焰战争，这是一个没有火焰的地方:-)）。

> 你好，
> 
> 回答你的问题似乎充满了发起火焰战争的危险，所以我会谨慎行事。
> 
> Java 运行时和公共语言运行时之间有许多基本的技术相似之处，包括垃圾收集内存、中间语言（Microsoft IL 与 Java ByteCode）、核心系统库以及对相当高级语言的支持、代码安全性和部署。
> 
> 然而，这些“相似”领域中的每一个也有许多相当大和小的差异，并且超出了简单的论坛帖子的范围来描述其中的大部分。
> 
> 我建议就各种运行时特性和组件领域（例如内存管理、编译、系统库、安全等）提出更有针对性的问题，然后我们可以提供更有针对性的回应（例如博客、技术文章，或一些书籍）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T21:00:38.790

One essential difference is that the JVM is portable across platforms and runs on Linux, Macintosh, and many cell phones and embedded devices.

CLR runs on Microsoft supported platforms with the Mono project providing partial support of older versions of CLR on a few more.

Internally this means the JVM's performance will vary on those different platforms based on capabilities provided by the platforms themselves.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-07T11:47:05.337

CLR 和 JVM 的目标和理念比您想象的要大得多。一般来说，JVM 旨在优化更动态、更高级别的代码，而 CLR 为您提供更多低级工具来自己进行这些优化。

一个很好的例子是堆栈分配。在 CLR 上，您有自定义值类型的显式堆栈分配。在 JVM 上，唯一的自定义类型是引用类型，但 JVM 可以在某些情况下通过逃逸分析将堆分配转换为堆栈分配。

另一个例子。在 Java 中，方法默认是虚拟的。至少在 C# 上，它们不是。优化虚拟方法调用要困难得多，因为在给定调用站点执行的代码无法静态确定。

在引擎盖下，它们的执行系统完全不同。大多数 JVM（特别是 Hotspot）从字节码解释器开始，并且只对代码的执行量很大的部分进行 JIT 编译，例如紧密循环。他们还可以使用从以前的运行中收集的执行统计信息来一遍又一遍地重新编译这些数据，以推动优化。这允许将更多的优化工作应用于程序中最需要它的部分。这称为自适应优化。

CLR 只预先编译所有内容一次。它进行的优化较少，因为它有更多的代码要编译，因此必须要快，而且因为它没有任何实际执行路径的统计信息来进行优化。这种方法确实具有非常显着的优势，即允许您跨进程缓存编译结果，CLR 可以做到这一点，而 JVM 则没有。

很大一部分 Hotspot JVM 代码专门用于这些自适应优化，它们使 Java 在 2000 年代初期的大多数通用计算中处于与本机代码相同的性能范围内。它们也是使 JVM 成为动态语言的体面目标的原因。我在这里排除了动态语言运行时和invokedynamic 的最新发展，因为我对DLR 了解不够。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-12T16:14:03.037

Miguel de Icaza[在这里](http://www.linuxtoday.com/news_story.php3?ltsn=2002-02-06-011-20-OP-GN-MS&tbovrmode=3)提到：

> 经验丰富的行业程序员会注意到，上述内容非常类似于 Java 和 Java VM。他们是对的，上面就像Java一样。
> 
> CIL 有一个 Java 所没有的特性：它是一种足够强大的字节码表示，可以用作许多语言的目标：从 C++、C、Fortran 和 Eiffel 到 Lisp 和 Haskell，包括 Java、C#、JavaScript和 Visual Basic 混合在一起。
> 
> 我希望我有时间更详细地说，但为了这个论点，以上就足够了。

不过，评论涉及一些细节，例如尾调用优化。不过自 2002 年以来发生了很多变化——CLR 和 JVM 现在都有多种语言针对它。但仍然值得一读。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-17T03:14:34.740

据我所知，.Net CLR 仍然在运行时内置了更加灵活和强大的代码访问安全性，允许更细粒度的权限和执行策略。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-12T15:12:27.350

正如 Vinko 所说，完整的细节远远超出了论坛帖子的范围。差异/相似之处归结为：

它们都是运行时环境“沙盒”，包括“即时”编译器，用于将中间语言（MSIL 或字节码）的程序指令翻译成本地机器代码，并提供自动内存管理（垃圾收集）。位于各自运行时环境之上的是一组类库，它们为开发人员提供更高级别的抽象以简化开发任务。

这些运行时环境如何实际实现的内部机制在很大程度上是 Microsoft 和 Sun 专有的。例如，垃圾收集系统使用的算法虽然在技术功能上可能相似，但在实现上却不同。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-01-22T12:38:22.707

垃圾收集也存在差异。JVM 使用 Copying 收集器和标记和清除。.NET 用户复制收集器和标记和压缩（更难实现）。

Flyswat 提到的类型擦除也很重要。JVM 对泛型一无所知，一切都是对象和相关的性能。拳击和拆箱的惩罚。反射也不会为您提供一般信息。CLR 原生支持泛型。

# sql - 如何在 Web Data Administrator 中禁用验证？

> ID：59180
> 
> 赞同：0
> 
> 时间：2008-09-12T14:53:04.930
> 
> 标签：sql, sql-server

我正在尝试使用 Web Data Administrator 运行一些查询以消除我们数据库中的 XSS，但我一直遇到这种潜在危险的请求废话。

如何在 Web Data Administrator 中禁用查询验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-12T14:56:54.703

进入web data admin的安装目录，通常：

`C:\Program Files\Microsoft SQL Server Tools\Microsoft SQL Web Data Administrator`

然后在“Web”文件夹中打开文件“QueryDatabase.aspx”并编辑以下行：

`<%@ Page language="c#" Codebehind="QueryDatabase.aspx.cs" AutoEventWireup="false" Inherits="SqlWebAdmin.query" %>`

像这样添加`ValidateRequest="false"`到它的末尾：

`<%@ Page language="c#" Codebehind="QueryDatabase.aspx.cs" AutoEventWireup="false" Inherits="SqlWebAdmin.query" ValidateRequest="false" %>`

**注意**：这可能很危险！！当心！

# asp.net - WCF服务支持文件jsdebug加载失败

> ID：59181
> 
> 赞同：4
> 
> 时间：2008-09-12T14:53:19.597
> 
> 标签：asp.net, wcf, javascript-debugger

我有一个从客户端 JavaScript 调用的 WCF 服务。调用失败并出现 Service is null JavaScript 错误。WebDevelopment 帮助程序跟踪显示加载 jsdebug 支持文件的调用导致 404（找不到文件）错误。

重新启动 IIS 或清除 Temp ASP.Net 文件或在 web.config 中的编译标记上设置 batch="false" 不能解决问题

从浏览器

[https://Myserver/MyApp/Services/MyService.svc](https://Myserver/MyApp/Services/MyService.svc)显示服务元数据

然而

[https://Myserver/MyApp/Services/MyService.svc/jsdebug](https://Myserver/MyApp/Services/MyService.svc/jsdebug)导致 404。

问题似乎与 https 协议有关。使用 http /jsdebug 下载支持的 JS 文件。

有任何想法吗？

TIA

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-12T19:01:57.953

弄清楚了！

这是 web.config 中的服务配置部分

查看端点上的 bindingConfiguration 属性。值“webBinding”指向绑定中的绑定 name="webBinding" 标记，这就是告诉服务使用 HTTPS 传输级别安全性的原因。在我的情况下，属性值为空，导致通过 HTTPS 对 /js 或 /jsdebug 文件的 Web 服务请求失败并引发 404 错误。

```
<services>
      <service name="MyService">
        <endpoint address="" behaviorConfiguration="MyServiceAspNetAjaxBehavior" binding="webHttpBinding" bindingConfiguration="webBinding" contract="Services.MyService" />
      </service>
    </services>
    <bindings>
      <webHttpBinding>
        <binding name="webBinding">
          <security mode="Transport">
          </security>
        </binding>
      </webHttpBinding>
    </bindings> 
```

请注意，如果通过 http 而不是 https 访问服务，则 bindingConfiguration 属性应该为空（“”）（在没有证书的本地机器上测试时）

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-06T08:22:55.543

如果在完成所有可能的工作后仍然出现相同的错误。只需添加一个“启用 AJAX 的 WCF 服务”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-05T11:57:17.517

对我来说，问题如下；我们将 MVC 添加到带有路由的解决方案中。我们的 WCF 服务没有被忽视。我通过添加以下规则解决了这个问题（其中“WCF”是我们保存服务的文件夹）。

```
routes.IgnoreRoute("WCF/{*pathInfo}"); 
```

希望可以节省几个小时。

# asp.net - 防止 asp:button 在状态栏上显示其 URL 的最佳方法是什么？

> ID：59182
> 
> 赞同：1
> 
> 时间：2008-09-12T14:53:24.760
> 
> 标签：asp.net

防止 asp:button 在浏览器状态栏上显示其 URL 的最佳方法是什么？该按钮当前定义如下：

```
<asp:button id="btnFind" 
            runat="server" 
            Text="Find Info" 
            onclick="btnFind_Click">
</asp:button> 
```

**更新：**

这似乎特定于 IE7，IE6 和 FF 不在状态栏中显示 URL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-12T14:56:51.117

我使用 FF 所以从来没有注意到这一点，但实际上链接确实出现在 IE 的状态栏中。

我不认为你可以覆盖它:(我最初认为也许设置 ToolTip (al la "title") 属性可能会做到这一点.. 似乎它没有..

查看源代码，出现的内容无处可寻，所以我会说这是一个*浏览器*问题，我认为您无法在代码中做任何事情.. :(

## 更新

是的，看起来 IE 总是发布表单操作是什么.. 还看不到覆盖它的方法..

也许尝试通过 JS 显式设置它？

## 更新二

做了更多的谷歌搜索。不要认为真的有一种“好”的方式来做这件事。除非你一起删除表格并以其他方式发布数据。

**真的值那么多钱吗？通常这只是页面名称？**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-12T15:10:50.443

我没有看到链接，我看到了这个：

```
javascript:__doPostBack('btn',''); 
```

**编辑**：抱歉，正在查看 LinkBut​​ton，而不是 ASP:Button。ASP:Button 显示表单 ACTION 元素，如所述。

但是，如果您试图隐藏 DoPostBackCall，唯一的方法是使用 javascript 直接操作 window.status。**缺点是大多数浏览器不再允许这样做。**

为此，请在您的 page_load 中添加：

```
btnFind.Attributes.Add("onmouseover","window.status = '';");
btnFind.Attributes.Add("onmouseout","window.status = '';"); 
```

# sharepoint - 带有 MS Office 2007 页脚的 Sharepoint 2007

> ID：59186
> 
> 赞同：0
> 
> 时间：2008-09-12T14:55:36.737
> 
> 标签：sharepoint, ms-office

我们需要一个**文档管理解决方案**，并希望`SharePoint 2007`能满足我们的需求。我们觉得我们的需求相对简单。我们需要管理**版本控制**、**搜索功能**和**审批工作流程**。

`SharePoint`开箱即用地处理了这三个方面。

但是，我们还要求 Office 2007（Word、Excel 和 PowerPoint）文档的页脚反映文档版本、最后修改人和最后修改日期。这些事情可以通过办公自动化来完成，但我们还没有找到完整的解决方案。

我们首先尝试在签入和签入事件上执行此操作，并遵循此路径一段时间，但是，我们遇到的复杂情况是在我们对文档进行更改后，我们无法阻止保存更新版本号。这导致了与此类似的事情：

已签入文档——文档版本应该是 v0.1，但它是 v0.2，因为我们在替换页脚后保存文档。如果我们查看文档历史记录，我们有 2 个单独的版本 v0.1 没有页脚 v0.2 有页脚，但它说 v0.1 因为这是文档被替换时的版本。

这对我们来说是一个不可接受的解决方案，因为我们希望在用户端完全处理该过程，以便他们可以完全控制恢复到页脚不正确且不包含正确数据的版本。当我们尝试创建自定义批准/签入工作流时，我们发现存在同样的问题。页脚是必需的，以便可以将硬拷贝追溯到其电子副本。

向我们提出的另一个解决方案是为 office 构建插件来处理页脚的替换。这不足以满足我们的需求，因为它需要客户端部署我们的插件，这是我们的客户所不希望的。我们正在寻找的是一个干净的解决方案来解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-12T23:17:01.337

这是一篇[博客文章](http://www.sharepointblogs.com/johnwpowell/archive/2007/07/13/display-version-number-and-other-sharepoint-metadata-in-word-2003-documents.aspx)，似乎正是您的问题的解决方案。

基本上，他们在文档库中创建一个自定义字段，并使用事件接收器将文档的当前版本保存在该字段中。“诀窍”是在客户端，此自定义字段显示为文档的属性，您可以轻松地将其值嵌入到文档的内容中。

我不确定为什么更改字段不会增加文档的版本，但我想这是因为您只更改元数据，而不是实际文档。

他们确实使用了一个在客户端运行的小 VBA 脚本，但它不需要任何客户端部署，因为它与文档一起下载。但是，我不确定是否需要在客户端更改任何安全设置以允许脚本运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T01:46:37.847

这些信息是否需要在页脚中？Office 2007 应用程序中提供了许多信息。如果单击左上角的圆形按钮，然后选择“服务器”，则可以查看版本历史记录，单击圆形按钮并打开“准备”菜单，然后选择属性可以使用许多其他属性。

如果此信息必须显示在文档页脚中，我将研究创建自定义信息管理策略。 [这](http://www.sharepointblogs.com/tonstegeman/archive/2007/02/01/moss-custom-policies-part-1-creating-a-custom-information-management-policy.aspx)可能是一个很好的起点。

# asp.net - 我需要将 .compiled 文件复制到生产服务器吗？

> ID：59191
> 
> 赞同：10
> 
> 时间：2008-09-12T14:57:00.740
> 
> 标签：asp.net, deployment, web-deployment-project

我正在使用部署项目来部署我的 ASP.net Web 应用程序。当我构建部署项目时，所有 .compiled 文件都被重新创建。

我需要将它们 FTP 到生产网络服务器吗？
如果我做了一个小改动，是否需要再次复制所有网站？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-15T15:10:11.590

根据我自己的研究，.compiled 文件必须复制到生产服务器，但不需要每次都复制

来自[Rick Strahl](http://www.west-wind.com/)的优秀博客：

> 合并实用程序的输出可以将所有标记和 CodeBeside 代码组合到一个程序集中，但您仍然会得到 .compiled 文件，ASP.NET 需要这些文件将页面请求与程序集中包含的特定类相关联。但是，由于生成的文件名是固定的，除非您添加或删除页面，否则您不需要更新这些文件。实际上，这意味着在大多数情况下，您可以简单地更新单个程序集来更新您的 Web。
> [来源](http://www.west-wind.com/presentations/AspNetCompilation/AspNetCompilation.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-26T21:11:33.013

您可以使用带有选项的[aspnet_merge](http://msdn.microsoft.com/en-us/library/bb397866.aspx)工具来删除`.compiled`文件。`-r`

> 删除主代码程序集的 .compiled 文件（App_Code 文件夹中的代码）。如果您的应用程序包含对主代码程序集的显式类型引用，请不要使用此选项。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-12T15:15:05.253

.compiled 文件没有什么特别之处：它只是最后带有 .compiled 扩展名的实际文件，因此如果您不小心双击它，什么也不会发生。

但是，如果您看到 .compiled 文件，则说明您发布的应用程序需要正式安装 - 仅将内容复制到生产环境是不够的。您还必须运行安装程序。如果这是您知道已经部署的应用程序，那似乎有点不必要。

# linux - 开发没有信息的驱动程序

> ID：59194
> 
> 赞同：2
> 
> 时间：2008-09-12T14:58:29.770
> 
> 标签：linux, kernel, drivers, bsd

**开源/自由软件社区**如何为不提供文档的产品开发驱动程序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-12T15:17:03.063

你如何对某些东西进行逆向工程？

*   您观察输入和输出，并制定一组描述对象操作的规则或模型。

例子：

假设您要开发一个 USB 摄像头驱动程序。“黑匣子”是软件驱动程序。

1.  在操作系统和/或驱动程序中开发挂钩，以便您可以看到驱动程序的输入和输出
2.  生成典型输入，并记录输出
3.  分析输出并综合描述输入和输出之间关系的模型
4.  测试模型 - 将其替换黑盒驱动程序，然后运行您的测试
5.  如果它完成了你需要的一切，你就完成了，如果没有冲洗并重复

请注意，这只是一个常规的问题解决/科学过程。例如，天气预报员做同样的事情——他们观察天气，根据模型测试当前条件，预测未来几天会发生什么，然后将模型的输出与现实进行比较。当它不匹配时，他们会返回并调整模型。

这种方法比洁净室逆向工程更安全（合法），后者实际上是有人反编译代码，或反汇编产品，彻底分析它，然后根据他们看到的内容制作模型。然后将模型（*AND NOTHING ELSE*）传递给复制产品功能的开发人员。然而，拆开原件的工程师不能参与，因为他可能会带来代码/设计的受版权保护的部分，并无意中将它们放入新代码中。

但是，如果您从不反汇编或反编译产品，那么您应该处于法律安全的水域——唯一剩下的问题是专利问题。

-亚当

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-12T15:02:18.967

通常通过对代码进行逆向工程。不过，在某些国家/地区可能存在法律问题。

*   [逆向工程](http://www.reactivated.net/weblog/archives/2005/08/reverse-engineering/)
*   [逆向工程 Windows USB 设备驱动程序，以便为 Linux 创建兼容的设备驱动程序](http://www.reactivated.net/weblog-content/20050806-reverse-0.2.txt)
*   [Nvidia严厉打击第三方驱动程序开发](http://www.theinquirer.net/en/inquirer/news/2003/07/15/nvidia-cracks-down-on-third-party-driver-development)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T15:02:32.147

这是一个非常模糊的问题，但我会说[逆向工程](http://en.wikipedia.org/wiki/Reverse_engineering)。他们如何做到这一点取决于它是什么类型的设备以及可用的设备。在许多情况下，该设备可能具有与另一台设备类似的核心芯片组，可以对其进行修改以使其正常工作。

# unit-testing - Mocks 是如何使用的？

> ID：59195
> 
> 赞同：23
> 
> 时间：2008-09-12T14:59:14.153
> 
> 标签：unit-testing, mocking

当我最初被介绍给 Mocks 时，我觉得主要目的是模拟来自外部数据源的对象。这样我就不必维护一个自动化的单元测试测试数据库，我可以伪造它。

但现在我开始以不同的方式思考它。我想知道 Mocks 是否更有效地用于将测试方法与其外部的任何东西完全隔离开来。不断浮现在脑海中的图像是您绘画时使用的背景。你想防止油漆弄脏所有东西。我只是在测试那个方法，我只想知道它对这些伪造的外部因素有何反应？

这样做似乎非常乏味，但我看到的优势是当测试失败时，这是因为它被搞砸了，而不是 16 层。但是现在我必须进行 16 次测试才能获得相同的测试覆盖率，因为每个部分都将单独测试。此外，每个测试都变得更加复杂，并且与它正在测试的方法联系更紧密。

这对我来说是正确的，但它也似乎很残酷，所以我有点想知道其他人的想法。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-12T15:20:04.260

我建议你看一下 Martin Fowler 的文章[*Mocks Aren't Stubs*](http://www.martinfowler.com/articles/mocksArentStubs.html)，以获得比我能给你更权威的 Mocks 处理。

模拟的目的是在隔离依赖项的情况下对代码进行单元测试，以便您可以真正在“单元”级别测试一段代码。被测试的代码是真正的交易，它所依赖的每一段代码（通过参数或依赖注入等）都是一个“模拟”（一个空的实现，当它的一个方法被调用时总是返回预期的值。）

模拟一开始可能看起来很乏味，但是一旦你掌握了使用它们的窍门，它们就会使单元测试变得更加容易和健壮。大多数语言都有 Mock 库，这使得模拟相对微不足道。如果您使用 Java，我会推荐我个人最喜欢的：[EasyMock。](http://www.easymock.org/)

让我结束这个想法：您也需要集成测试，但是拥有大量的单元测试可以帮助您找出哪个组件包含错误，何时存在。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-12T15:14:28.717

不要走黑暗的路，卢克大师。:) 不要嘲笑一切。你可以，但你不应该......这就是为什么。

*   如果您继续孤立地测试每种方法，那么当您将它们全部组合在一起时，您就会有惊喜并为您完成工作，就像**BIG BANG**一样。我们构建对象，以便它们可以一起解决更大的问题。它们本身微不足道。您**需要知道所有协作者是否按预期工作**。
*   模拟通过引入重复**使测试变得脆弱**- 是的，我知道这听起来令人震惊。对于您设置的每个模拟期望，您的方法签名存在的地方有 n 个。实际代码和您的模拟期望（在多个测试中）。更改实际代码更容易......更新所有模拟期望很乏味。
*   您的**测试现在已获知内部实施信息**。因此，您的测试取决于您选择如何实施解决方案......不好。测试应该是一个独立的规范，可以通过多种解决方案来满足。我应该可以自由地在代码块上按删除并重新实现**，而**不必重写测试套件。因为要求仍然保持不变。

结束时，我会说“如果它像鸭子一样嘎嘎叫，像鸭子一样走路，那么它可能就是一只鸭子” - 如果感觉不对......它可能是。*使用模拟来抽象出问题子项，例如 IO 操作、数据库、第三方组件等。像盐一样，其中一些是必要的。太多了和 :x *
这是基于状态的测试与基于迭代的测试的圣战.. 谷歌搜索会给你更深入的洞察力。

澄清：我在这里遇到了一些阻力wrt集成测试:)所以澄清我的立场..

*   模拟不在“验收测试”/集成领域中。你只会在单元测试世界中找到它们。这就是我在这里的重点。
*   验收测试是不同的，并且**非常**需要 - 不要贬低它们。但是单元测试和验收测试是不同的，应该保持不同。
*   组件或包中的所有协作者不需要相互隔离。就像过度杀伤的微优化一样。**他们的存在是为了共同**解决问题......凝聚力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-12T15:05:10.520

是的我同意。我认为模拟有时是痛苦的，但通常是必要的，因为你的测试真正成为**单元**测试，即只有你可以让你的测试关注的最小单元在测试中。这使您可以消除任何其他可能影响测试结果的因素。你最终会得到更多的小测试，但是找出你的代码问题出在哪里变得容易得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-12T15:17:16.433

我的理念是你应该编写可测试的代码来适应测试，
而不是编写测试来适应代码。

至于复杂性，我的观点是测试应该写得简单，因为如果是的话，你会写更多的测试。

我可能同意，如果您正在模拟的类没有测试套件，这可能是一个好主意，因为如果他们确实有一个适当的测试套件，您就会知道问题出在哪里而无需隔离。

我使用模拟对象的大部分时间是当我编写测试的代码是如此紧密耦合（阅读：糟糕的设计）时，当它们依赖的类不可用时，我必须编写模拟对象。确实有模拟对象的有效用途，但如果您的代码**需要**使用它们，我会再看一下设计。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-12T15:27:16.877

是的，这是使用模拟测试的缺点。你需要做很多工作，这感觉很残酷。但这就是单元测试的本质。如果你不模拟外部资源，你怎么能孤立地测试一些东西？

另一方面，您正在嘲笑缓慢的功能（例如数据库和 i/o 操作）。如果测试运行得更快，那会让程序员感到高兴。没有什么比等待非常慢的测试更痛苦的了，当您尝试实现一项功能时，这需要超过 10 秒才能完成运行。

如果您项目中的每个开发人员都花时间编写单元测试，那么这 16 层（间接层）不会有那么大的问题。希望您应该从一开始就拥有该测试覆盖率，对吗？:)

另外，不要忘记在协作的对象之间编写功能/集成测试。否则你可能会错过一些东西。这些测试不需要经常运行，但仍然很重要。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-12T15:43:34.310

在一个尺度上，是的，模拟旨在用于模拟外部数据源，例如数据库或 Web 服务。但是，在更细粒度的范围内，如果您正在设计松散耦合的代码，那么您可以几乎任意地在代码中画线，以了解在任何时候可能是“外部系统”。拿一个我目前正在做的项目：

当有人尝试签入时，**CheckInUi**将**CheckInInfo**对象发送到**CheckInMediator对象，该对象使用****CheckInValidator**对其进行验证，然后如果没问题，它会使用**CheckInInfoAdapter**用**CheckInInfo**填充名为**Transaction**的域对象，然后将**Transaction传递给****ITransactionDao**的实例**.SaveTransaction()**用于持久性。

 ******我现在正在编写一些自动化*集成测试*，显然**CheckInUi**和**ITransactionDao**是外部系统的窗口，它们应该被嘲笑。**但是，谁说 CheckInValidator**在某些时候不会调用 Web 服务？这就是为什么当你编写*单元测试*时，你假设除了你的类的特定功能之外的所有东西都是一个外部系统。因此，在我对**CheckInMediator**的单元测试中，我模拟了它与之对话的所有对象。

**编辑：** Gishu 在技术上是正确的，并不是所有的东西都需要被模拟，例如我不模拟**CheckInInfo**，因为它只是一个数据容器。然而，任何你可以看到作为外部服务的东西（它几乎是任何转换数据或具有副作用的东西）都应该被嘲笑。

我喜欢的一个类比是将适当松散耦合的设计视为一个领域，人们站在它周围玩接球游戏。当有人传球时，他可能会向下一个人扔一个完全不同的球，他甚至可能会连续向不同的人扔多个球，或者扔一个球等着接回来再扔给另一个人。这是一个奇怪的游戏。

现在，作为他们的教练和经理，您当然想检查您的团队作为一个整体是如何运作的，因此您可以进行团队练习（集成测试），但您也可以让每个球员自己练习对抗后卫和投球机（单元测试）嘲笑）。这张照片唯一缺少的部分是模拟期望，所以我们的球上涂上了黑色焦油，所以当它们击中后挡板时会弄脏它。每个逆止器都有一个人瞄准的“目标区域”，如果在练习跑结束时目标区域内没有黑色标记，你就知道有问题了，这个人需要调整他的技术。

真的要花时间正确地学习它，我理解 Mocks 的那一天是一个巨大的 a-ha 时刻。将它与控制容器的反转结合起来，我永远不会回去。

顺便说一句，我们的一个 IT 人员刚进来给了我一台免费的笔记本电脑！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T15:39:11.380

正如有人之前所说，如果你模拟所有东西以隔离比你正在测试的类更细化的东西，你就会放弃在被测试的代码中强制执行内聚。

请记住，模拟具有基本优势，即行为验证。这是存根不提供的东西，也是使测试更加脆弱（但可以提高代码覆盖率）的另一个原因。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-18T14:40:36.953

发明模拟部分是为了[回答这个问题](http://peripateticaxiom.blogspot.com/2008/06/tdd-mocks-and-design.html)：如果对象没有 getter 或 setter，你将如何对它们进行单元测试？

这些天来，[推荐](http://www.infoq.com/presentations/Mock-Objects-Nat-Pryce-Steve-Freeman)的做法是模拟角色而不是对象。使用 Mocks 作为一种设计工具来讨论协作和职责分离，而不是作为“智能存根”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-18T16:27:15.887

模拟对象 1) 通常用作隔离被测代码的一种手段，但 2) 正如 keithb 已经指出的那样，对于“[关注协作对象之间的关系](http://blog.dannorth.net/2008/09/14/the-end-of-endotesting/#comment-7954)”很重要。这篇文章给出了一些与主题相关的见解和历史：[Responsibility Driven Design with Mock Objects](http://www.methodsandtools.com/archive/archive.php?id=90)。

# apache-flex - 如何在 Flex 中的 ButtonBar 组件上进行制表符？

> ID：59196
> 
> 赞同：1
> 
> 时间：2008-09-12T14:59:19.707
> 
> 标签：apache-flex, actionscript-3

我有一个按钮栏 inf flex 以及其他几个输入控件，我已经为每个控件设置了 tabIndex 属性，并且一切顺利，直到我切换到 ButtonBar。

ButtonBar 有 3 个按钮，但对它进行制表符，只有第一个按钮获得焦点，再次制表符，焦点回到顶部控件...

如何使选项卡通过 Flex 按钮栏中的所有按钮？有没有办法做到这一点，还是我需要为此创建单独的按钮？

这对我来说似乎是一个可能的错误......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-12T16:48:39.007

该组件是这样编写的，因此当焦点在栏内时，用户必须按下左/右箭头键才能遍历按钮——这是一种相当标准的 GUI 行为（您也可以在单选按钮组等其他地方看到这一点）。如果您查看[ButtonBar 的 SDK 源代码](https://web.archive.org/web/20091214071345/http://opensource.adobe.com/svn/opensource/flex/sdk/tags/3.1.0.2710/frameworks/projects/framework/src/mx/controls/ButtonBar.as)，您可以看到他们在创建每个子按钮时显式禁用选项卡焦点的位置：

```
override protected function createNavItem(
                                        label:String,
                                        icon:Class = null):IFlexDisplayObject
    {
        var newButton:Button = Button(navItemFactory.newInstance());

        // Set tabEnabled to false so individual buttons don't get focus.
        newButton.focusEnabled = false;
    ... 
```

如果你真的想改变这种行为，你可以创建一个子类来做到这一点，如下所示：

```
package {
    import mx.controls.Button;
    import mx.controls.ButtonBar;
    import mx.core.IFlexDisplayObject;

    public class FocusableButtonBar extends ButtonBar {
        public function FocusableButtonBar()
        {
            super();
            this.focusEnabled = false;
        }

        override protected function createNavItem(
                    label:String, icon:Class=null):IFlexDisplayObject
        {
            var btn:Button = Button(super.createNavItem(label, icon));
            btn.focusEnabled = true;
            return btn;
        }
    }
} 
```

# database - 数据加密

> ID：59204
> 
> 赞同：10
> 
> 时间：2008-09-12T15:02:32.600
> 
> 标签：database, security, encryption

存储大量信用卡信息的数据库是我们刚刚完成的系统中不可避免的一部分。我想要的是卡号的最终安全性，我们设置了一种机制来加密和解密，但我们自己无法解密任何给定的号码。

我所追求的是一种即使在数据库级别也能保护这些信息的方法，这样任何人都无法进入并生成卡号文件。其他人是如何克服这个问题的？对此的“标准”方法是什么？

至于数据的使用情况，链接都是私密且安全的，除了创建记录并加密时，不会执行卡号的传输，所以我不担心前端只是后端。

* * *

好吧，数据库是 ORACLE，所以我可以使用 PL/SQL 和 Java。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-12T16:03:26.183

不乏愿意存储您的 CC 信息并将其交换为令牌的处理器，您可以使用该令牌对存储的号码进行计费。这使您摆脱了 PCI 合规性，但仍允许按需计费。根据您需要存储 CC 的*原因，这可能是一个更好的选择。*

大多数公司将此称为“客户资料管理”，实际上费用相当合理。

我知道的一些供应商（排名不分先后）：

*   [授权 .NET 客户信息管理器](http://www.authorize.net/solutions/merchantsolutions/merchantservices/cim/)
*   [信任商务城堡](http://www.trustcommerce.com/citadel.php)
*   [脑树](http://www.braintreepaymentsolutions.com/pci-dss-compliance/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-12T15:32:30.470

除非您是支付处理器，否则您实际上不需要存储任何类型的抄送信息。

查看您的要求，您需要存储CC信息的情况确实不多

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-12T15:13:28.347

不要存储信用卡号，而是存储哈希值。当您需要验证新数字是否与存储的数字匹配时，请获取新数字的哈希值并将其与存储的哈希值进行比较。如果它们匹配，则数字（理论上）相同。

或者，您可以通过让输入卡号的用户输入密码来加密数据；您可以将其用作加密/解密密钥。

但是，任何有权访问您的数据库和源代码的人（即您和您的团队）都会发现解密该数据是微不足道的（即修改实时代码，以便将输入的任何解密密钥通过电子邮件发送到一次性 Hotmail 帐户等）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-12T15:28:31.430

如果您存储信用卡信息是因为您不希望用户重新输入它，那么任何形式的散列都无济于事。

您什么时候需要对信用卡号采取行动？

您可以将信用卡号存储在更安全的数据库中，并且在主数据库中只存储足够的信息以显示给用户，以及对卡的引用。后端系统可以更加锁定并使用实际的信用卡信息来处理订单。如果您愿意，您可以通过一些主密码来加密这些数字，但密码必须由需要获取数字的代码知道。

是的，您只是稍微改变了问题，但很多安全性更多的是减少攻击足迹，而不是消除它。如果您想消除它，请不要将信用卡号存储在任何地方！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-12T18:20:59.910

对于电子商务类型的用例（想想 Amazon 1-Click），您可以使用用户现有的强密码加密 CC（或密钥）。假设您只存储密码的哈希值，只存储用户（或彩虹表 - 但是，它必须在*每个*用户上运行，并且如果它没有提供相同的密码就无法工作 - 不仅仅是1 哈希相同）可以解密它。

当密码更改时，您必须小心重新加密数据，如果他们忘记密码，数据将毫无价值（并且需要用户重新输入） - 但是，如果付款是用户发起的，那么它会很好地工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-12T15:24:07.213

如果您使用 Oracle，您可能对[透明数据加密](http://www.oracle.com/technology/obe/10gr2_db_vmware/security/tde/tde.htm)感兴趣。但仅适用于企业许可证。

Oracle 还具有用于加密-解密的实用程序，例如[DBMS_OBFUSCATION_TOOLKIT](http://download-west.oracle.com/docs/cd/A87860_01/doc/appdev.817/a76936/dbms_obf.htm)。

至于“标准”，您感兴趣的正确标准是[PCI DSS](https://www.pcisecuritystandards.org/security_standards/pci_dss.shtml)标准，该标准描述了需要采取哪些措施来保护敏感的信用卡信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-12T15:06:43.697

了解数据库服务器和语言/平台类型会很有帮助，这样我们就可以更具体，但我会研究[SHA](http://en.wikipedia.org/wiki/SHA)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-12T15:25:08.037

我会对称加密（AES）一个安全的加盐哈希（SHA-256 + salt）。加盐散列对于大盐就足够了，但是加密会增加一些额外的东西，以防数据库而不是代码泄漏，并且到那时或其他方式有加盐散列的彩虹表。当然，将密钥存储在代码中，而不是数据库中。

值得注意的是，没有什么可以保护您免受不正当的队友的伤害，例如，他们还可以在散列之前存储日期的副本。您必须妥善保管代码存储库，并对信用卡处理路径中的所有代码进行频繁的代码修订。还要尽量减少接收数据并对其进行加密/散列处理的时间，手动确保将存储它的变量从内存中清除。

# ruby-on-rails - 如何更改 ActiveScaffold “动作”的显示顺序？

> ID：59207
> 
> 赞同：2
> 
> 时间：2008-09-12T15:03:25.593
> 
> 标签：ruby-on-rails, ruby, activescaffold

我在 Ruby on Rails 应用程序中使用 ActiveScaffold，并用使用 CSS 的图标替换了表中的默认“操作”文本（即“编辑”、“删除”、“显示”）。我还使用 action_link.add（“移动”和“复制”）添加了几个自定义操作。

为清楚起见，**我希望图标以不同的顺序显示**。具体来说，我希望“编辑”成为显示的第一个图标。

我似乎可以通过更改控制器中的定义顺序来更改 action_links 的顺序。我还能够通过首先 config.actions.排除所有内容，然后使用 config.actions.add 以特定顺序添加它们来更改默认操作的顺序。

但是，**我的自定义操作似乎总是出现在列表中的默认操作*之前***。

理想情况下，我希望他们显示“编辑”“复制”“移动”“删除”（即 - 内置、自定义、自定义、内置）。谁能建议我如何做到这一点？

我的一个想法是将“编辑”重新定义为自定义操作（使用默认功能），但我也不知道如何去做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-13T18:20:28.310

**警告：**我不知道*ActiveScaffold*。这个答案是基于我阅读它的源代码。

看起来该`action_links`变量是一个自定义数据结构，称为`ActionLinks`. 它定义在`ActiveScaffold::DataStructures`.

在内部，它有一个`@set`变量，它根本不是 a `Set`，而是一个`Array`。`ActionLinks`有一个`add`, `delete`, 和`each`方法作为这个`@set`变量的看门人。

显示链接时，*ActiveScaffold*会执行此操作（在 中`_list_actions.rhtml`）：

```
<% active_scaffold_config.action_links.each :record do |link| -%>
  # Displays the link (code removed for brevity)
<% end -%> 
```

因此，除了扩展`ActiveScaffold::DataStructures::ActionLinks`以添加一种方法以`@set`不同方式对值进行排序之外，似乎没有办法做到这一点，至少一般情况下没有。

如果我是你，我会添加一个名为 的东西`order_by!`，你可以在其中传递一个符号数组，按照正确的顺序，它会使用`@set`. 这样，您可以在添加自定义操作后调用它。

# .net - 向 Printing.PrintDocument (.Net 2.0) 添加页眉和页脚的最简单方法？

> ID：59213
> 
> 赞同：4
> 
> 时间：2008-09-12T15:05:25.247
> 
> 标签：.net, vb.net, printing, header, printdocument

向 .Net PrintDocument 对象添加页眉和页脚的最简单方法是实用的还是在设计时？

具体来说，我正在尝试打印第 3 方网格控件（Infragistics GridEx v4.3），该控件采用 PrintDocument 对象并将其自身绘制到其中。

生成的页面只包含网格及其内容 - 但是我想添加一个标题或标题来标识打印的报告，并可能添加一个页脚来显示谁打印它，何时打印，理想情况下是页码和总页数。

我正在使用 VB.Net 2.0。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T08:55:32.873

按照[booji-boy](https://stackoverflow.com/questions/59213/easiest-way-to-add-a-header-and-footer-to-a-printingprintdocument-net-20#61809)的回答，这就是我想出的（出于示例目的，我已对其进行了简化）：

```
Private Sub btnPrint_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPrint.Click

        Dim oDoc As New Printing.PrintDocument
        oDoc.DefaultPageSettings.Landscape = True
        AddHandler oDoc.PrintPage, AddressOf PrintPage

        oDoc.DocumentName = "Printout"

        InfragisticsWinGrid.PrintPreview(InfragisticsWinGrid.DisplayLayout, oDoc)

    End If
End Sub

Private Sub PrintPage(ByVal sender As Object, ByVal e As System.Drawing.Printing.PrintPageEventArgs)

    ' Draw title
    e.Graphics.DrawString("Report Title"), New Font("Arial", 16), Brushes.Black, 95, 70)

    ' Draw footer
    e.Graphics.DrawImage(DirectCast(mResources.GetObject("footer_logo"), Drawing.Bitmap), 95, e.PageBounds.Height - 87)
    Dim drawFont As New Font("Arial", 8.75)

    e.Graphics.DrawString("Report Title", drawFont, Brushes.Gray, 190, e.PageBounds.Height - 90)
    e.Graphics.DrawString("Printed", drawFont, Brushes.Gray, 190, e.PageBounds.Height - 76)
    e.Graphics.DrawString("Printed By", drawFont, Brushes.Gray, 190, e.PageBounds.Height - 62)

    ' Draw some grid lines to add structure to the footer information
    e.Graphics.DrawLine(Pens.Gray, 246, e.PageBounds.Height - 90, 246, e.PageBounds.Height - 48)
    e.Graphics.DrawLine(Pens.Gray, 188, e.PageBounds.Height - 75, 550, e.PageBounds.Height - 75)
    e.Graphics.DrawLine(Pens.Gray, 188, e.PageBounds.Height - 61, 550, e.PageBounds.Height - 61)

    e.Graphics.DrawString("Report", drawFont, Brushes.Black, 250, e.PageBounds.Height - 90)
    e.Graphics.DrawString(Date.Now.ToShortDateString & " " & Date.Now.ToShortTimeString, drawFont, Brushes.Black, 250, e.PageBounds.Height - 76)
    e.Graphics.DrawString("Andrew", drawFont, Brushes.Black, 250, e.PageBounds.Height - 62)

End Sub 
```

我必须使用 的值`e.PageBounds.Height - x`才能使绘制的项目对齐。

再次感谢[Booji Boy](https://stackoverflow.com/users/1433)的指点 - 获得 ReportPage.Graphics() 正是我所追求的：o)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-15T02:47:19.020

printdocument 对象为要打印的每一页触发 printpage 事件。您可以使用 printpageeventargs 事件参数将文本/行/等绘制到打印队列中：

[http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument.aspx)

将它传递给网格时使用事件将其调暗，以便您可以处理事件。

# c# - 在 .NET 中合并两个数组

> ID：59217
> 
> 赞同：271
> 
> 时间：2008-09-12T15:07:04.587
> 
> 标签：c#, .net, arrays

.NET 2.0 中是否有一个内置函数可以将两个数组合并到一个数组中？

数组都是相同的类型。我从我的代码库中广泛使用的函数中获取这些数组，并且无法修改函数以返回不同格式的数据。

如果可能的话，我希望避免编写自己的函数来完成此任务。

* * *

## 回答 #1

> 赞同：511
> 
> 时间：2008-09-12T15:19:10.733

在 C# 3.0 中，您可以使用 LINQ 的[Concat](https://msdn.microsoft.com/en-us/library/vstudio/bb302894%28v=vs.100%29.aspx)方法轻松完成此操作：

```
int[] front = { 1, 2, 3, 4 };
int[] back = { 5, 6, 7, 8 };
int[] combined = front.Concat(back).ToArray(); 
```

在 C# 2.0 中，您没有这种直接的方法，但 Array.Copy 可能是最好的解决方案：

```
int[] front = { 1, 2, 3, 4 };
int[] back = { 5, 6, 7, 8 };

int[] combined = new int[front.Length + back.Length];
Array.Copy(front, combined, front.Length);
Array.Copy(back, 0, combined, front.Length, back.Length); 
```

这可以很容易地用于实现您自己的`Concat`.

* * *

## 回答 #2

> 赞同：134
> 
> 时间：2008-09-12T15:16:35.717

如果您可以操作其中一个数组，则可以在执行复制之前调整它的大小：

```
T[] array1 = getOneArray();
T[] array2 = getAnotherArray();
int array1OriginalLength = array1.Length;
Array.Resize<T>(ref array1, array1OriginalLength + array2.Length);
Array.Copy(array2, 0, array1, array1OriginalLength, array2.Length); 
```

否则，您可以创建一个新数组

```
T[] array1 = getOneArray();
T[] array2 = getAnotherArray();
T[] newArray = new T[array1.Length + array2.Length];
Array.Copy(array1, newArray, array1.Length);
Array.Copy(array2, 0, newArray, array1.Length, array2.Length); 
```

[有关 MSDN 上可用数组方法的更多信息](http://msdn.microsoft.com/en-us/library/system.array.aspx)。

* * *

## 回答 #3

> 赞同：120
> 
> 时间：2014-05-23T06:50:23.063

使用[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)：

```
var arr1 = new[] { 1, 2, 3, 4, 5 };
var arr2 = new[] { 6, 7, 8, 9, 0 };
var arr = arr1.Union(arr2).ToArray(); 
```

请记住，这将删除重复项。如果要保留重复项，请使用 Concat。

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2017-04-06T08:56:33.550

如果您不想删除重复项，请尝试此操作

使用 LINQ：

```
var arr1 = new[] { 1, 2, 3, 4, 5 };
var arr2 = new[] { 6, 7, 8, 9, 0 };
var arr = arr1.Concat(arr2).ToArray(); 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-09-12T15:17:03.470

首先，确保你问自己“我真的应该在这里使用数组”这个问题吗？

除非您正在构建速度至关重要的东西，否则键入列表`List<int>`可能是要走的路。我唯一一次使用数组是在通过网络发送东西时使用字节数组。除此之外，我从不碰它们。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2014-07-25T15:14:40.290

更简单的是使用[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)：

```
var array = new string[] { "test" }.ToList();
var array1 = new string[] { "test" }.ToList();
array.AddRange(array1);
var result = array.ToArray(); 
```

首先将数组转换为列表并合并它们......之后只需将列表转换回数组:)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-12T15:09:34.830

我认为您可以为此使用[Array.Copy](http://msdn.microsoft.com/en-us/library/y5s0whfd.aspx)。它需要一个源索引和目标索引，因此您应该能够将一个数组附加到另​​一个数组。如果您需要比仅将一个附加到另一个更复杂，这可能不是适合您的工具。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-03-08T16:58:30.743

每个人都已经有了自己的发言权，但我认为这比“用作扩展方法”的方法更具可读性：

```
var arr1 = new[] { 1, 2, 3, 4, 5 };
var arr2 = new[] { 6, 7, 8, 9, 0 };
var arr = Queryable.Concat(arr1, arr2).ToArray(); 
```

但是，它只能在将 2 个数组组合在一起时使用。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-12T15:10:41.240

假设目标数组有足够的空间，[`Array.Copy()`](https://msdn.microsoft.com/en-us/library/system.array.copy%28v=vs.110%29.aspx)就可以了。您也可以尝试使用 a`List<T>`及其[`.AddRange()`](https://msdn.microsoft.com/en-us/library/z883w3dc%28v=vs.110%29.aspx)方法。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-04-08T16:45:02.120

这就是我想出的。适用于可变数量的数组。

```
public static T[] ConcatArrays<T>(params T[][] args)
    {
        if (args == null)
            throw new ArgumentNullException();

        var offset = 0;
        var newLength = args.Sum(arr => arr.Length); 
        var newArray = new T[newLength];

        foreach (var arr in args)
        {
            Buffer.BlockCopy(arr, 0, newArray, offset, arr.Length);
            offset += arr.Length;
        }

        return newArray;
    } 
```

...

```
var header = new byte[] { 0, 1, 2};
var data = new byte[] { 3, 4, 5, 6 };
var checksum = new byte[] {7, 0};
var newArray = ConcatArrays(header, data, checksum);
//output byte[9] { 0, 1, 2, 3, 4, 5, 6, 7, 0 } 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2013-12-11T22:40:16.223

就个人而言，我更喜欢我自己的语言扩展，我可以随意添加或删除它以进行快速原型设计。

以下是字符串的示例。

```
//resides in IEnumerableStringExtensions.cs
public static class IEnumerableStringExtensions
{
   public static IEnumerable<string> Append(this string[] arrayInitial, string[] arrayToAppend)
   {
       string[] ret = new string[arrayInitial.Length + arrayToAppend.Length];
       arrayInitial.CopyTo(ret, 0);
       arrayToAppend.CopyTo(ret, arrayInitial.Length);

       return ret;
   }
} 
```

它比 LINQ 和 Concat 快得多。更快的是，使用自定义`IEnumerable`类型包装器，它存储传递数组的引用/指针，并允许循环整个集合，就好像它是一个普通数组一样。（在 HPC、图形处理、图形渲染中很有用......）

**您的代码：**

```
var someStringArray = new[]{"a", "b", "c"};
var someStringArray2 = new[]{"d", "e", "f"};
someStringArray.Append(someStringArray2 ); //contains a,b,c,d,e,f 
```

有关整个代码和泛型版本，请参见：[https ://gist.github.com/lsauer/7919764](https://gist.github.com/lsauer/7919764)

**注意：**这将返回一个未扩展的 IEnumerable 对象。返回一个扩展对象有点慢。

*自 2002 年以来，我编译了此类扩展，其中很多功劳用于 CodeProject 和“Stackoverflow”上的有用人员。我将很快发布这些并将链接放在这里。*

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-02-19T21:21:41.260

只是将其作为一个选项注明：如果您正在使用的数组是原始类型 - Boolean (bool)、Char、SByte、Byte、Int16 (short)、UInt16、Int32 (int)、UInt32、Int64 (long )、UInt64、IntPtr、UIntPtr、Single 或 Double——那么您可以（或应该？）尝试使用[Buffer.BlockCopy](https://msdn.microsoft.com/en-us/library/system.buffer.blockcopy.aspx)。根据[Buffer](https://msdn.microsoft.com/en-us/library/system.buffer.aspx)类的 MSDN 页面：

> [与System.Array](https://msdn.microsoft.com/en-us/library/system.array.aspx)类中的类似方法相比，此类为操作原始类型提供了更好的性能。

使用@OwenP 的[答案](https://stackoverflow.com/a/59262/577765)中的 C# 2.0 示例作为起点，它的工作原理如下：

```
int[] front = { 1, 2, 3, 4 };
int[] back = { 5, 6, 7, 8 };

int[] combined = new int[front.Length + back.Length];
Buffer.BlockCopy(front, 0, combined, 0, front.Length);
Buffer.BlockCopy(back, 0, combined, front.Length, back.Length); 
```

`Buffer.BlockCopy`@OwenP 使用的和@OwenP之间的语法几乎没有任何区别`Array.Copy`，但这应该更快（即使只有一点点）。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-03-12T08:28:27.737

我需要一个解决方案来组合未知数量的数组。

很惊讶没有人提供使用`SelectMany`with的解决方案`params`。

```
 private static T[] Combine<T>(params IEnumerable<T>[] items) =>
                    items.SelectMany(i => i).Distinct().ToArray(); 
```

如果您不想要不同的项目，只需删除 distinct。

```
 public string[] Reds = new [] { "Red", "Crimson", "TrafficLightRed" };
 public string[] Greens = new [] { "Green", "LimeGreen" };
 public string[] Blues = new [] { "Blue", "SkyBlue", "Navy" };

 public string[] Colors = Combine(Reds, Greens, Blues); 
```

注意：使用 distinct 时绝对不能保证排序。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-12-04T23:46:21.507

如果其他人正在寻找如何合并两个图像字节数组：

```
 private void LoadImage()
        {
            string src = string.empty;
            byte[] mergedImageData = new byte[0];

            mergedImageData = MergeTwoImageByteArrays(watermarkByteArray, backgroundImageByteArray);
            src = "data:image/png;base64," + Convert.ToBase64String(mergedImageData);
            MyImage.ImageUrl = src;
        }

        private byte[] MergeTwoImageByteArrays(byte[] imageBytes, byte[] imageBaseBytes)
        {
            byte[] mergedImageData = new byte[0];
            using (var msBase = new MemoryStream(imageBaseBytes))
            {
                System.Drawing.Image imgBase = System.Drawing.Image.FromStream(msBase);
                Graphics gBase = Graphics.FromImage(imgBase);
                using (var msInfo = new MemoryStream(imageBytes))
                {
                    System.Drawing.Image imgInfo = System.Drawing.Image.FromStream(msInfo);
                    Graphics gInfo = Graphics.FromImage(imgInfo);
                    gBase.DrawImage(imgInfo, new Point(0, 0));
                    //imgBase.Save(Server.MapPath("_____testImg.png"), ImageFormat.Png);
                    MemoryStream mergedImageStream = new MemoryStream();
                    imgBase.Save(mergedImageStream, ImageFormat.Png);
                    mergedImageData = mergedImageStream.ToArray();
                    mergedImageStream.Close();
                }
            }
            return mergedImageData;
        } 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-01-03T10:11:37.823

如果您在数组本身中有源数组，则可以使用[SelectMany](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.selectmany?view=netframework-4.8)：

```
var arrays = new[]{new[]{1, 2, 3}, new[]{4, 5, 6}};
var combined = arrays.SelectMany(a => a).ToArray();
foreach (var v in combined) Console.WriteLine(v); 
```

给

```
1
2
3
4
5
6 
```

可能这不是最快的方法，但可能适合用例。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-03-18T17:02:50.080

这是一个使用 Array.CopyTo 的简单示例。我认为它回答了您的问题并给出了 CopyTo 用法的示例-当我需要使用此功能时，我总是感到困惑，因为帮助有点不清楚-索引是目标数组中发生插入的位置。

```
int[] xSrc1 = new int[3] { 0, 1, 2 };
int[] xSrc2 = new int[5] { 3, 4, 5, 6 , 7 };

int[] xAll = new int[xSrc1.Length + xSrc2.Length];
xSrc1.CopyTo(xAll, 0);
xSrc2.CopyTo(xAll, xSrc1.Length); 
```

我想你不能让它更简单。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-12T15:15:03.350

我假设您使用的是自己的数组类型，而不是内置的 .NET 数组：

```
public string[] merge(input1, input2)
{
    string[] output = new string[input1.length + input2.length];
    for(int i = 0; i < output.length; i++)
    {
        if (i >= input1.length)
            output[i] = input2[i-input1.length];
        else
            output[i] = input1[i];
    }
    return output;
} 
```

另一种方法是使用内置的 ArrayList 类。

```
public ArrayList merge(input1, input2)
{
    Arraylist output = new ArrayList();
    foreach(string val in input1)
        output.add(val);
    foreach(string val in input2)
        output.add(val);
    return output;
} 
```

这两个示例都是 C#。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-04-14T09:58:44.037

```
int [] SouceArray1 = new int[] {2,1,3};
int [] SourceArray2 = new int[] {4,5,6};
int [] targetArray = new int [SouceArray1.Length + SourceArray2.Length];
SouceArray1.CopyTo(targetArray,0);
SourceArray2.CopyTo(targetArray,SouceArray1.Length) ; 
foreach (int i in targetArray) Console.WriteLine(i + " "); 
```

使用上面的代码可以很容易地合并两个数组。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-10-20T12:57:05.420

创建和扩展方法来处理 null

```
public static class IEnumerableExtenions
{
    public static IEnumerable<T> UnionIfNotNull<T>(this IEnumerable<T> list1, IEnumerable<T> list2)
    {
        if (list1 != null && list2 != null)
            return list1.Union(list2);
        else if (list1 != null)
            return list1;
        else if (list2 != null)
            return list2;
        else return null;
    }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-08-26T14:14:49.020

```
string[] names1 = new string[] { "Ava", "Emma", "Olivia" };
string[] names2 = new string[] { "Olivia", "Sophia", "Emma" };
List<string> arr = new List<string>(names1.Length + names2.Length);
arr.AddRange(names1);
arr.AddRange(names2);
string[] result = arr.Distinct().ToArray();
foreach(string str in result)
{
    Console.WriteLine(str.ToString());
}

Console.ReadLine(); 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2015-04-12T16:29:41.423

此代码适用于所有情况：

```
int[] a1 ={3,4,5,6};
int[] a2 = {4,7,9};
int i = a1.Length-1;
int j = a2.Length-1;
int resultIndex=  i+j+1;
Array.Resize(ref a2, a1.Length +a2.Length);
while(resultIndex >=0)
{
    if(i != 0 && j !=0)
    {
        if(a1[i] > a2[j])
        {
            a2[resultIndex--] = a[i--];
        }
        else
        {
            a2[resultIndex--] = a[j--];
        }
    }
    else if(i>=0 && j<=0)
    { 
        a2[resultIndex--] = a[i--];
    }
    else if(j>=0 && i <=0)
    {
       a2[resultIndex--] = a[j--];
    }
} 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2021-03-22T17:47:33.810

连接多个数组的简单代码：

```
string[] arr1 = ...
string[] arr2 = ...
string[] arr3 = ...    
List<string> arr = new List<string>(arr1.Length + arr2.Length + arr3.Length);
arr.AddRange(arr1);
arr.AddRange(arr2);
arr.AddRange(arr3);
string[] result = arr.ToArray(); 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2021-04-24T13:57:05.560

这是另一种方法：）

```
public static void ArrayPush<T>(ref T[] table, object value)
{
    Array.Resize(ref table, table.Length + 1); // Resizing the array for the cloned length (+-) (+1)
    table.SetValue(value, table.Length - 1); // Setting the value for the new element
}

public static void MergeArrays<T>(ref T[] tableOne, T[] tableTwo) {
    foreach(var element in tableTwo) {
        ArrayPush(ref tableOne, element);
    }
} 
```

这是[片段/示例](https://dotnetfiddle.net/5B5Oyj)

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2012-01-07T15:58:40.123

试试这个：

```
ArrayLIst al = new ArrayList();
al.AddRange(array_1);
al.AddRange(array_2);
al.AddRange(array_3);
array_4 = al.ToArray(); 
```

# c# - 如何在 C# 中在运行时加载程序集及其所有依赖项以进行反射？

> ID：59220
> 
> 赞同：13
> 
> 时间：2008-09-12T15:07:26.643
> 
> 标签：c#, .net, reflection, subsonic

我正在为自己编写一个实用程序，部分是作为学习 C# 反射的练习，部分是因为我实际上想要生成的工具供我自己使用。

我所追求的基本上是将应用程序指向一个程序集并选择一个给定的类，从中选择应该作为字段包含在导出的 HTML 表单中的属性。然后，该表单将在我的 ASP.NET MVC 应用程序中用作视图的开头。

由于我将 Subsonic 对象用于我想要使用的应用程序，这应该是合理的，我认为，通过想要包含诸如根据数据类型而不同的输出 HTML 之类的东西，反射是完成这项工作的方法。

然而，我正在寻找的东西似乎难以捉摸。我试图将通过 OpenFileDialog 选择的 DLL/EXE 作为起点并加载它：

```
String FilePath = Path.GetDirectoryName(FileName);
System.Reflection.Assembly o = System.Reflection.Assembly.LoadFile(FileName); 
```

这很好用，但由于 Subsonic 生成的对象实际上充满了在 Subsonic.dll 等中定义的对象类型，因此不会加载这些依赖对象。进入：

```
AssemblyName[] ReferencedAssemblies = o.GetReferencedAssemblies(); 
```

这也包含了我所期望的内容。但是，我想弄清楚的是如何加载这些程序集，以便我对对象的挖掘能够正常工作。我知道，如果这些程序集位于 GAC 或正在运行的可执行文件的目录中，我可以按它们的名称加载它们，但对于这个用例来说不太可能是这种情况，这是我的主要用例。

因此，它归结为如何加载给定程序集及其所有以文件名开头的任意程序集，并产生一个完全可反射浏览的类型、属性、方法等树。

我知道像 Reflector 这样的工具可以做到这一点，我只是找不到语法。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-12T15:13:56.800

这里有几个选项：

1.  根据请求的程序集附加`AppDomain.AssemblyResolve`并执行另一个。`LoadFile`
2.  以该目录为基础启动另一个`AppDomain`并加载其中的程序集`AppDomain`。

我强烈建议采用选项 2，因为这可能会更干净，并且允许您在之后卸载所有这些程序集。此外，如果您只需要对它们进行反射，请考虑在仅反射上下文中加载程序集（请参阅 参考资料`Assembly.ReflectionOnlyLoad`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-05-05T21:54:53.340

我制定了[Kent Boogaart](https://stackoverflow.com/users/5380/kent-boogaart)的第二个选项。基本上我必须：

1.）`ResolveEventHandler`在一个单独的类中实现，继承`MarshalByRefObject`并添加`Serializable`属性。

2.) 将当前的`ApplicationBase`，本质上是事件处理程序的 dll 所在的位置，添加到`AppDomain` `PrivateBinPath`.

[你可以在github](https://github.com/mathume/ResolveDependencies)上找到代码。

# html - 如何在 html 中的图标上显示简单的工具提示？

> ID：59221
> 
> 赞同：4
> 
> 时间：2008-09-12T15:07:30.187
> 
> 标签：html, ruby-on-rails, ruby, tooltip, activescaffold

我在 Ruby on Rails 应用程序中使用 ActiveScaffold，为了节省表格空间，我已将表格中的默认“操作”文本（即“编辑”、“删除”、“显示”）替换为使用 CSS 的图标。我还使用 action_link.add（“移动”和“复制”）添加了几个自定义操作。

为清楚起见，当我将鼠标悬停在图标上时，**我希望弹出一个带有相关操作（即“编辑”、“复制”）的工具提示。**

我想我可以通过向标签添加一个简单的“alt”定义来做到这一点，但这似乎不起作用。

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-12T15:17:53.593

在图像丢失的情况下或在纯文本浏览器中，该`alt`属性将用作图像的替代品。

当它们`alt`显示为工具提示时，IE 弄错了。它从来都不是那样的。

正确的属性是`title`，它当然不会在 IE 中做工具提示。

因此，要在 IE 和 FireFox/Safari/Chrome/Opera 中都显示工具提示，请同时使用`alt`属性和`title`属性。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-12T21:29:36.913

只是要添加到此线程中的一个小点...没有 alt 标签或标题标签。alt 属性用于图像，但页面上的所有其他元素都可以具有 title 属性，这是跨浏览器兼容性的最佳选择。

```
<span title="Click here to edit the foo">
  Edit
</span> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-12T15:09:04.877

你想要一个“标题”标签。我不确定这是否还有必要，但我通常会同时添加 alt 和 title 标签，以确保所有浏览器都显示相同的工具提示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-12T15:08:56.377

HTML 中的工具提示是`alt`图像标签的文本内容，但如果您使用 CSS 设置它，您可能会使用`background:url(...);`样式而不是图像。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-12T15:09:18.560

`alt`在图像和链接上使用`title`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-12T15:15:29.510

img 标签的 alt 属性在某些浏览器中有效，但不是全部（例如一些基于 mozilla 的浏览器）。

这样做的“[正确方法](http://www.mozilla.org/docs/web-developer/faq.html#alttooltip)”是使用 title 属性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-12T15:14:50.777

正如 Prestaul 指出的那样，alt 标签应该适用于图像和链接的标题。但是，这也取决于浏览器...大多数浏览器**应该**实现将元数据显示为工具提示的功能，但它们不是必须这样做的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-12T21:24:14.367

意识到，正如 Joel Coehoom 所指出的，我的图标实际上是一个背景图像，我创建了一个带有标题和 alt 属性的 transparent.gif 图像在背景之上，瞧 - 工具提示！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-16T07:48:51.503

好工具在这里 [http://www.guangmingsoft.net/htmlsnapshot/html2image.htm](http://www.guangmingsoft.net/htmlsnapshot/html2image.htm)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-17T15:49:46.863

您可以在测试中使用标签缩写和标题属性，例如`<abbr tittle="some text"> </abbr>` 答案[https://stackoverflow.com/a/61601175/9442717](https://stackoverflow.com/a/61601175/9442717)

# sql - 如何在 Oracle 的表中查找重复值？

> ID：59232
> 
> 赞同：298
> 
> 时间：2008-09-12T15:10:27.277
> 
> 标签：sql, oracle, duplicate-data

什么是最简单的 SQL 语句，它将返回给定列的重复值以及它们在 Oracle 数据库表中出现的次数？

例如：我有一个`JOBS`带有列的表`JOB_NUMBER`。我怎样才能知道我是否有任何重复`JOB_NUMBER`的 s，以及它们被重复了多少次？

* * *

## 回答 #1

> 赞同：653
> 
> 时间：2008-09-12T15:13:46.583

按 COUNT 聚合列，然后使用 HAVING 子句查找出现大于一次的值。

```
SELECT column_name, COUNT(column_name)
FROM table_name
GROUP BY column_name
HAVING COUNT(column_name) > 1; 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-09-13T09:35:41.800

其他方式：

```
SELECT *
FROM TABLE A
WHERE EXISTS (
  SELECT 1 FROM TABLE
  WHERE COLUMN_NAME = A.COLUMN_NAME
  AND ROWID < A.ROWID
) 
```

当有索引时工作正常（足够快）`column_name`. 这是删除或更新重复行的更好方法。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-09-12T15:17:14.577

我能想到的最简单的：

```
select job_number, count(*)
from jobs
group by job_number
having count(*) > 1; 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-09-13T14:55:49.440

如果您不需要知道重复的实际数量，您甚至不需要在返回的列中包含计数。例如

```
SELECT column_name
FROM table
GROUP BY column_name
HAVING COUNT(*) > 1 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-12T15:18:28.817

怎么样：

```
SELECT <column>, count(*)
FROM <table>
GROUP BY <column> HAVING COUNT(*) > 1; 
```

要回答上面的例子，它看起来像：

```
SELECT job_number, count(*)
FROM jobs
GROUP BY job_number HAVING COUNT(*) > 1; 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-09-20T07:25:14.333

如果多个列标识唯一行（例如关系表），您可以使用以下

使用行 id 例如 emp_dept(empid, deptid, startdate, enddate) 假设 empid 和 deptid 是唯一的并在这种情况下标识行

```
select oed.empid, count(oed.empid) 
from emp_dept oed 
where exists ( select * 
               from  emp_dept ied 
                where oed.rowid <> ied.rowid and 
                       ied.empid = oed.empid and 
                      ied.deptid = oed.deptid )  
        group by oed.empid having count(oed.empid) > 1 order by count(oed.empid); 
```

如果这样的表有主键，那么使用主键而不是 rowid，例如 id 是 pk 然后

```
select oed.empid, count(oed.empid) 
from emp_dept oed 
where exists ( select * 
               from  emp_dept ied 
                where oed.id <> ied.id and 
                       ied.empid = oed.empid and 
                      ied.deptid = oed.deptid )  
        group by oed.empid having count(oed.empid) > 1 order by count(oed.empid); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-12T15:24:34.997

正在做

```
select count(j1.job_number), j1.job_number, j1.id, j2.id
from   jobs j1 join jobs j2 on (j1.job_numer = j2.job_number)
where  j1.id != j2.id
group by j1.job_number 
```

将为您提供重复行的 ID。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-04-05T06:48:51.973

```
SELECT   SocialSecurity_Number, Count(*) no_of_rows
FROM     SocialSecurity 
GROUP BY SocialSecurity_Number
HAVING   Count(*) > 1
Order by Count(*) desc 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-10-24T08:21:15.677

我通常使用[Oracle 分析](https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions001.htm#i81407)函数[ROW_NUMBER()](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions137.htm#i86310)。

假设您要检查有关基于列 ( `c1`, `c2`, `c3`) 构建的唯一索引或主键的重复项。然后你会走这条路，调出**`ROWID`**s 行，其中行数`ROW_NUMBER()`为`>1`：

```
Select * From Table_With_Duplicates
      Where Rowid In
                    (Select Rowid
                       From (Select Rowid,
                                    ROW_NUMBER() Over (
                                            Partition By c1 || c2 || c3
                                            Order By c1 || c2 || c3
                                        ) nbLines
                               From Table_With_Duplicates) t2
                      Where nbLines > 1) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-07-23T07:57:48.033

我知道它是一个旧线程，但这可能会对某些人有所帮助。

如果您需要在下面检查重复使用时打印表格的其他列：

```
select * from table where column_name in
(select ing.column_name from table ing group by ing.column_name having count(*) > 1)
order by column_name desc; 
```

如果需要，还可以在 where 子句中添加一些额外的过滤器。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-01-12T11:02:40.773

这是执行此操作的 SQL 请求：

```
select column_name, count(1)
from table
group by column_name
having count (column_name) > 1; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-02-10T10:08:45.063

**1.解决方案**

```
select * from emp
    where rowid not in
    (select max(rowid) from emp group by empno); 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2016-01-27T14:23:14.090

你也可以尝试这样的事情来列出表中的所有重复值说reqitem

```
SELECT count(poid) 
FROM poitem 
WHERE poid = 50 
AND rownum < any (SELECT count(*)  FROM poitem WHERE poid = 50) 
GROUP BY poid 
MINUS
SELECT count(poid) 
FROM poitem 
WHERE poid in (50)
GROUP BY poid 
HAVING count(poid) > 1; 
```

# html - ASP.NET MVC 中的 HTML.Button

> ID：59267
> 
> 赞同：13
> 
> 时间：2008-09-12T15:20:14.010
> 
> 标签：html, asp.net-mvc

从 ASP.NET MVC Preview 3 开始，不再支持 HTML.Button（和其他相关的 HTML 控件）。

问题是，它们的等价物是什么？我有一个使用 Preview 2 构建的应用程序，现在我必须使其与最新的 CTP 版本兼容。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-12T15:21:55.987

只需写入`<input type="button" ... />`您的html。html 控件没有什么特别之处。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-12T15:32:46.660

我想到了。它是这样的：

```
<form method="post" action="<%= Html.AttributeEncode(Url.Action("CastUpVote")) %>">
<input type="submit" value="<%=ViewData.Model.UpVotes%> up votes" />
</form> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-14T16:05:50.527

一些扩展方法已移至 Microsoft.Web.Mvc，即 MVC Futures DLL。您可能想在那里寻找丢失的东西。

* * *

## 回答 #4

> 赞同：-12
> 
> 时间：2008-09-12T15:26:32.137

`<asp:Button>`是等效于 HTML.Button 的 ASP.NET。默认情况下，它将生成一个`<input type="button">`. （这是 System.Web.UI.WebControls.Button 类）

# asp.net - 推出 Web 应用程序的最佳方式是什么？

> ID：59270
> 
> 赞同：1
> 
> 时间：2008-09-12T15:21:22.367
> 
> 标签：asp.net, deployment

我正在尝试为我们公司创建一种推出 Web 应用程序的标准方式。目前我们使用 zip 文件、vbscript/javascript 并手动执行一些步骤。

对于胖客户端安装，我们使用 Wise/Wix 生成 MSI 安装程序。我们目前不为网站创建安装程序，因为通常它们只是 xcopy 部署。但是我们有一些需要更改的配置文件，请验证某些处理程序是否已在 IIS 中注册......列表还在继续。

大多数人是否也将 MSI 安装程序用于 Web 应用程序或其他一些工具/脚本语言？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-12T15:27:55.130

我最近花了几天时间在我的公司进行自动化部署。

我们使用 CruiseControl、NAnt、MSBuild 的组合来生成应用程序的发布版本。然后一个单独的脚本使用 MSDeploy 和 XCopy 来备份实时站点并传输新文件。

我们的解决方案在回答这个问题[Automate Deployment for Web Applications？](https://stackoverflow.com/questions/45783/automate-deployment-for-web-applications)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-30T08:09:04.463

请考虑 MSDeploy，这是微软未来投资 Web 应用程序部署的方向......

[在 VS 2010 中 Web 部署的概述帖子中](http://vishaljoshi.blogspot.com/2009/09/overview-post-for-web-deployment-in-vs.html)了解更多关于未来方向的信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-18T08:20:27.147

为此，我们已经使用 FinalBuilder (www.finalbuilder.com) 很长时间了，并且一段时间以来，我们还使用 InstallAce (www.Installace.com) 在 Web Farm 上进行构建部署。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T15:26:03.853

你可能想看看：

1.  [如何使用 ASP.NET 从构建脚本中获取可部署的输出](https://stackoverflow.com/questions/55323/aspnet-web-application-build-output-how-do-i-include-all-deployment-files)
2.  [逐步 ASP.NET 自动构建/部署](https://stackoverflow.com/questions/57762/step-by-step-aspnet-automated-builddeploy#59274)

我们也使用 MSI 为我们的 Web 项目创建基本安装程序，通常使用 VS 中的 Web 设置项目，有时甚至使用完全自定义的安装程序。您可能还想查看[MSDeploy](http://blogs.iis.net/msdeploy/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T15:26:34.493

我们正在转向 MSI 进行安装，到目前为止结果喜忧参半。我是一个控制狂，所以我个人更喜欢我可以更直接控制的一系列脚本。我过去使用过 ANT，效果很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-12T15:28:07.563

你检查过[NAnt](http://nant.sourceforge.net/)和[CruiseControl](http://cruisecontrol.sourceforge.net/)吗？

结合起来，它们可以提供一种简单且自动化的方式来构建和部署您的 Web 应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-13T03:59:07.727

我在一家州机构工作，我们使用名为 RepliWeb 的产品进行所有部署。

它运作良好，因为作为开发人员，我们无法控制网络服务器。但是我们可以部署到一个部署区域并运行 RepliWeb 作业来进行部署。虽然不确定价格...

# c++ - 以编程方式更改组合框

> ID：59280
> 
> 赞同：2
> 
> 时间：2008-09-12T15:25:03.013
> 
> 标签：c++, winapi, mfc, combobox, postmessage

我需要`combobox`使用新值更新 a ，以便更改其中的反射文本。最干净的方法是在`combobox`初始化并带有消息之后。

所以我正在尝试为`postmessage`包含`combobox`.

所以如果我想向它发送一条消息，将当前选中的项目更改为第 n 个项目，`postmessage`会是什么样子？

我猜它会涉及`ON_CBN_SELCHANGE`，但我无法让它正常工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-12T15:33:27.720

你想要[ComboBox_SetCurSel](http://msdn.microsoft.com/en-us/library/bb856484(VS.85).aspx)：

```
ComboBox_SetCurSel(hWndCombo, n); 
```

或者，如果它是 MFC CComboBox 控件，您可能可以这样做：

```
m_combo.SetCurSel(2); 
```

我想如果您手动执行此操作，您还需要 SendMessage 而不是 PostMessage。CBN_SELCHANGE 是控件在选择更改时发*回给您的通知。*

最后，您可能希望将 c++ 标记添加到此问题中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T15:41:03.427

一个简洁的版本：

```
const int index = 0;
m_comboBox.PostMessage(CBN_SELCHANGE, index); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T00:05:49.233

可能出错的是选择更改消息处理程序内部正在更改选择，这会导致另一个选择更改消息。

绕过这个*不需要的反馈循环*的一种方法是向选择更改消息处理程序添加一个哨兵，如下所示：

```
void onSelectChangeHandler(HWND hwnd)
{
  static bool fInsideSelectChange = 0;

  //-- ignore the change message if this function generated it
  if (fInsideSelectChange == 0)
  {
    //-- turn on the sentinel
    fInsideSelectChange = 1;

    //-- make the selection changes as required
    .....

    //-- we are done so turn off the sentinel
    fInsideSelectChange = 0;
  }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-07-21T07:11:17.270

如果您想更改标题 - 这是组合框关闭时显示的行，那么您可以执行以下操作：

m_ComboBox.DeleteString(0); // 如果有的话，首先删除前一个，0 = 视觉字符串 m_ComboBox.AddString(_T("Hello there"));

把它放在 fx 中。在 OnCloseupCombo - 当事件关闭时触发下拉框

```
ON_CBN_CLOSEUP(IDC_COMBO1, OnCloseupCombo) 
```

此更改是一个新字符串，而不是已分配的组合框元素的选择

# sql - 在 SQL 中，count(column) 和 count(*) 有什么区别？

> ID：59294
> 
> 赞同：215
> 
> 时间：2008-09-12T15:27:17.253
> 
> 标签：sql

我有以下查询：

```
select column_name, count(column_name)
from table
group by column_name
having count(column_name) > 1; 
```

如果我替换所有对`count(column_name)`to 的调用会有什么不同`count(*)`？

这个问题的灵感来自[如何在 Oracle 的表中找到重复值？](https://stackoverflow.com/questions/59232/how-do-i-find-duplicate-values-in-a-table-in-oracle).

* * *

为了澄清接受的答案（也许是我的问题），替换`count(column_name)`为`count(*)`将在结果中返回一个额外的行，其中包含 a和列中值`null`的计数。`null`

* * *

## 回答 #1

> 赞同：244
> 
> 时间：2008-09-12T15:28:15.127

`count(*)`计算 NULL 并且`count(column)`不计算

[编辑] 添加此代码以便人们可以运行它

```
create table #bla(id int,id2 int)
insert #bla values(null,null)
insert #bla values(1,null)
insert #bla values(null,1)
insert #bla values(1,null)
insert #bla values(null,1)
insert #bla values(1,null)
insert #bla values(null,null)

select count(*),count(id),count(id2)
from #bla 
```

结果 7 3 2

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-09-12T15:47:56.407

使用 * 和特定列之间的另一个小区别是，在列的情况下，您可以添加关键字 DISTINCT，并将计数限制为不同的值：

```
select column_a, count(distinct column_b)
from table
group by column_a
having count(distinct column_b) > 1; 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-14T03:13:10.137

另一个可能是细微的区别是，在某些数据库实现中，count(*) 是通过查看相关表上的索引而不是实际数据行来计算的。由于没有指定特定的列，因此无需担心实际的行及其值（如果您计算了特定的列，就会出现这种情况）。允许数据库使用索引数据比计算“真实”行要快得多。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-12T15:41:27.297

[文档](https://docs.microsoft.com/en-us/sql/t-sql/functions/count-transact-sql?view=sql-server-ver15)中的解释有助于解释这一点：

> COUNT(*) 返回组中的项目数，包括 NULL 值和重复项。
> 
> COUNT(expression) 计算组中每一行的表达式并返回非空值的数量。

所以 count(*) 包含空值，而另一种方法不包含。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2010-06-14T17:19:38.517

我们可以使用[Stack Exchange Data Explorer](https://data.stackexchange.com/)通过一个简单的查询来说明差异。Stack Overflow 数据库中的 Users 表中的列通常留空，例如用户的网站 URL。

```
-- count(column_name) vs. count(*)
-- Illustrates the difference between counting a column
-- that can hold null values, a  'not null' column, and  count(*)

select count(WebsiteUrl), count(Id), count(*) from Users 
```

如果您在[Data Explorer](https://data.stackexchange.com/stackoverflow/query/new)中运行上面的查询，您会看到计数是相同的`count(Id)`和`count(*)`因为该`Id`列不允许`null`值。但是`WebsiteUrl`，计数要低得多，因为该列允许`null`.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-02-16T19:45:41.593

*   COUNT(*) 语句指示 SQL Server 返回表中的所有行，包括 NULL。
*   COUNT(column_name) 只检索行上具有非空值的行。

请参阅以下代码以执行 SQL Server 2008：

```
-- Variable table
DECLARE @Table TABLE
(
      CustomerId int NULL 
    , Name nvarchar(50) NULL
)

-- Insert some records for tests
INSERT INTO @Table VALUES( NULL, 'Pedro')
INSERT INTO @Table VALUES( 1, 'Juan')
INSERT INTO @Table VALUES( 2, 'Pablo')
INSERT INTO @Table VALUES( 3, 'Marcelo')
INSERT INTO @Table VALUES( NULL, 'Leonardo')
INSERT INTO @Table VALUES( 4, 'Ignacio')

-- Get all the collumns by indicating *
SELECT  COUNT(*) AS 'AllRowsCount'
FROM    @Table

-- Get only content columns ( exluce NULLs )
SELECT  COUNT(CustomerId) AS 'OnlyNotNullCounts'
FROM    @Table 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-05-04T20:47:38.187

基本上，该`COUNT(*)`函数返回表中的所有行，而`COUNT(COLUMN_NAME)`没有；也就是说，它排除了这里的每个人也在这里回答的空值。但最有趣的部分是使查询和数据库优化，`COUNT(*)`除非进行多次计数或复杂查询，否则最好使用它而不是`COUNT(COLUMN_NAME)`. 否则，在处理大量数据时，它确实会降低您的数据库性能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-03-24T19:14:29.980

`COUNT(*)`– 返回表中的记录总数（包括 NULL 值记录）。

`COUNT(Column Name)` – 返回非 NULL 记录的总数。这意味着，它忽略了计算该特定列中的 NULL 值记录。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-16T07:41:40.023

进一步详细说明@SQLMeance 和@Brannon 使用`GROUP BY`OP 提到但@SQLMenace 的回答中没有出现的子句给出的答案

```
CREATE TABLE table1 ( 
id INT 
); 
```

```
INSERT INTO table1 VALUES 
(1), 
(2), 
(NULL), 
(2), 
(NULL), 
(3), 
(1), 
(4), 
(NULL), 
(2); 
```

```
SELECT * FROM table1; 
```

```
+------+
| id   |
+------+
|    1 |
|    2 |
| NULL |
|    2 |
| NULL |
|    3 |
|    1 |
|    4 |
| NULL |
|    2 |
+------+
10 rows in set (0.00 sec) 
```

```
SELECT id, COUNT(*) FROM table1 GROUP BY id; 
```

```
+------+----------+
| id   | COUNT(*) |
+------+----------+
|    1 |        2 |
|    2 |        3 |
| NULL |        3 |
|    3 |        1 |
|    4 |        1 |
+------+----------+
5 rows in set (0.00 sec) 
```

在这里，`COUNT(*)`计算每种类型`id`包括的出现次数`NULL`

```
SELECT id, COUNT(id) FROM table1 GROUP BY id; 
```

```
+------+-----------+
| id   | COUNT(id) |
+------+-----------+
|    1 |         2 |
|    2 |         3 |
| NULL |         0 |
|    3 |         1 |
|    4 |         1 |
+------+-----------+
5 rows in set (0.00 sec) 
```

这里，`COUNT(id)`计算每种类型的出现次数，`id`但不计算出现的次数`NULL`

```
SELECT id, COUNT(DISTINCT id) FROM table1 GROUP BY id; 
```

```
+------+--------------------+
| id   | COUNT(DISTINCT id) |
+------+--------------------+
| NULL |                  0 |
|    1 |                  1 |
|    2 |                  1 |
|    3 |                  1 |
|    4 |                  1 |
+------+--------------------+
5 rows in set (0.00 sec) 
```

这里，只`COUNT(DISTINCT id)`统计每种类型的出现次数`id`（不计算重复），也不统计出现的次数`NULL`

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2011-02-07T19:12:49.323

最好使用

```
Count(1) in place of column name or * 
```

计算表中的行数，它比任何格式都快，因为它永远不会去检查表中的列名是否存在

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2012-09-21T12:06:47.273

如果您的表中固定一列，则没有区别，如果您想使用多于一列，则必须指定需要计算多少列......

谢谢，

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2016-05-02T16:50:05.063

正如前面的答案中提到的，`Count(*)`甚至计算`NULL`列，而`count(Columnname)`仅当列有值时才计算。

最好的做法是避免`*`( `Select *`, `count *`, ...)

# iis - 如何阻止 IIS SMTP 服务器发送退回邮件？

> ID：59296
> 
> 赞同：2
> 
> 时间：2008-09-12T15:27:27.593
> 
> 标签：iis, smtp, pop3

您如何阻止“默认 SMTP 虚拟服务器”为您没有的电子邮件地址发送退回邮件？

即，我正在使用 IIS 的 SMTP 服务器来处理我的电子邮件，如果在 mydomain.com 上发送未知电子邮件，则会将带有“未知地址”（或类似内容）的退回电子邮件发送回发件人。我希望它默默地失败。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-08T05:25:26.180

我发现这篇[文章](http://isorecorder.alexfeinman.com/catchall.htm)有一个脚本，你可以运行它来在你的服务器上配置一个包罗万象的帐户。所有会生成 NDR 的电子邮件都将被定向到此帐户。抱歉，我没有测试过。上面的文章已被删除，它是通过[WayBack 机器](https://web.archive.org/web/20170609215028/http://isorecorder.alexfeinman.com/catchall.htm)

基本上，您的问题的简短回答是否定的。

另一方面，如果您不想花钱，或者没有预算，并且想要一个更好的电子邮件系统，请尝试使用[Smarter Mail](http://www.smartertools.com/SmarterMail/Free-Windows-Mail-Server.aspx)之类的东西，您最多可以免费使用 10 个用户。我确信还有其他人，但我过去成功使用过 Smarter Mail。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T22:39:39.570

这不是 IIS 故障。接收邮件的 SMTP 服务器正在寻找一个有效的电子邮件地址，当它没有找到时，它会向您的电子邮件地址发送一封电子邮件，说明那里没有。让它静默失败的唯一方法是将发件人地址作为虚假电子邮件，如 no-reply@company.com 等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T22:46:39.537

从 SMTP 的角度来看，处理此问题的更好方法是在 SMTP 事务期间的某个时间点拒绝 RCPT 请求。这样，您的服务器不负责向所谓的发件人发送任何反馈。

我不知道如何配置 IIS 来专门执行此操作，但您当然可以使用[Postfix](http://www.postfix.org)（这是我使用的）。

# sql-server - 何时/为什么在 SQL Server 中使用级联？

> ID：59297
> 
> 赞同：166
> 
> 时间：2008-09-12T15:27:36.907
> 
> 标签：sql-server, database-design, foreign-keys, rdbms, cascade

在 SQL Server 中设置外键时，在什么情况下应该在删除或更新时级联，其背后的原因是什么？

这可能也适用于其他数据库。

我最关注的是每种场景的具体示例，最好是来自成功使用它们的人。

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2008-09-12T16:43:57.333

到目前为止我所看到的总结：

*   有些人根本不喜欢级联。

## 级联删除

*   *当关系的语义可能涉及排他的“是*”描述时，级联删除可能是有意义的。例如，OrderLine 记录是其父订单的一部分，并且 OrderLines 永远不会在多个订单之间共享。如果 Order 消失，OrderLine 也应该消失，而没有 Order 的行将是一个问题。
*   Cascade Delete 的典型示例是 SomeObject 和 SomeObjectItems，如果没有相应的主记录，项目记录就没有任何意义。
*   *如果您要保留*历史记录或使用“软/逻辑删除”（仅将已删除位列设置为 1/true），则 不应使用级联删除。

## 级联更新

*   当您跨表使用实键而不是代理键（标识/自动增量列）时，级联更新可能有意义。
*   级联更新的典型示例是当您有一个可变外键时，例如可以更改的用户名。
*   您不应*将*Cascade Update 与身份/自动增量列的键一起使用。
*   级联更新最好与唯一约束结合使用。

## 何时使用级联

*   在允许操作级联之前，您可能希望从用户那里获得额外的强烈确认，但这取决于您的应用程序。
*   如果您错误地设置了外键，级联可能会给您带来麻烦。但如果你做对了，你应该没问题。
*   在完全理解之前使用级联是不明智的。但是，它是一个有用的功能，因此值得花时间去理解。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2008-09-12T15:46:54.007

外键是确保数据库引用完整性的最佳方式。由于魔法而避免级联就像在汇编中编写所有内容一样，因为您不相信编译器背后的魔法。

不好的是错误使用外键，例如反向创建它们。

Juan Manuel 的示例是典型示例，如果您使用代码，则更有可能在数据库中留下虚假的 DocumentItems，它们会来咬您。

级联更新很有用，例如，当您通过可以更改的内容引用数据时，例如用户表的主键是名称，姓氏组合。然后，您希望该组合中的更改传播到它们被引用的任何地方。

@Aidan，您提到的这种清晰度需要付出高昂的代价，在您的数据库中留下虚假数据的机会*并不小*。对我来说，通常只是对 DB 不熟悉，并且在与 DB 合作之前无法找到哪些 FK 会导致这种恐惧。要么，要么不断滥用级联，在实体在概念上不相关的地方使用它，或者你必须保留历史。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-12T15:36:12.753

我从不使用级联删除。

如果我想从数据库中删除一些东西，我想明确地告诉数据库我想要取出什么。

当然，它们是数据库中可用的功能，有时可以使用它们，例如，如果您有一个“订单”表和一个“订单项”表，您可能希望在删除一个命令。

我喜欢通过代码（或存储过程）而不是“魔术”发生而获得的清晰度。

出于同样的原因，我也不喜欢触发器。

需要注意的是，如果您确实删除了“订单”，即使级联删除已删除 50 个“订单项”，您也会收到“受影响的 1 行”报告。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-16T19:07:50.747

我经常使用级联删除。

知道对数据库工作的人可能永远不会留下任何不需要的数据，这感觉很好。如果依赖关系增加，我只需在 Management Studio 中更改图表中的约束，而不必调整 sp 或 dataacces。

也就是说，我在级联删除和循环引用方面有 1 个问题。这通常会导致数据库的某些部分没有级联删除。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-12T15:51:59.173

我做了很多数据库工作，很少发现级联删除有用。我有效地使用它们的一次是在一个由夜间工作更新的报告数据库中。我通过删除自上次导入以来已更改的所有顶级记录，然后重新导入修改后的记录以及与它们相关的任何内容，确保正确导入任何更改的数据。它使我不必编写许多从数据库底部到顶部的复杂删除。

我不认为级联删除与触发器一样糟糕，因为它们只删除数据，触发器内部可能包含各种讨厌的东西。

**一般来说，我完全避免真正的删除，而是使用逻辑删除（即有一个名为 isDeleted 的位列设置为 true）。**

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-09-12T15:33:29.250

一个示例是当您在实体之间存在依赖关系时......即：Document -> DocumentItems（当您删除 Document 时，DocumentItems 没有存在的理由）

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-03-01T11:19:08.410

如果删除了引用 PK 记录，则在您希望删除带有 FK 的记录的地方使用级联删除。换句话说，如果没有引用记录，记录就毫无意义。

我发现级联删除对于确保默认删除死引用而不是导致空异常很有用。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-01-12T16:03:45.787

## ON 删除级联：

当您希望*删除子表中的行时*如果在父表中删除*相应的行。*

如果未使用*on cascade delete*，则会为*引用完整性*引发错误。

## ON 更新级联：

当您希望*在外键*中更新*主键的更改时*

 ** * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-06-23T14:29:05.837

我听说过 DBA 和/或“公司政策”纯粹因为过去的糟糕经历而禁止使用“On Delete Cascade”（和其他）。在一个案例中，一个人写了三个触发器，最终相互调用。三天的恢复导致完全禁止触发器，这一切都是因为一个 idjit 的行为。

当然，有时需要触发器而不是“删除级联”，例如需要保留一些子数据时。但在其他情况下，使用 On Delete 级联方法完全有效。“On Delete cascade”的一个关键优势是它捕获了所有的孩子；如果编码不正确，自定义编写的触发器/存储过程可能不会。

我认为应该允许开发人员根据开发内容和规范说明做出决定。基于糟糕体验的地毯禁令不应成为标准；“从不使用”的思维过程充其量是严厉的。每次都需要做出判断，并随着商业模式的变化而做出改变。

这不就是发展的意义吗？

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-19T11:31:40.670

进行级联删除（而不是在代码中进行）的一个原因是为了提高性能。

案例 1：使用级联删除

```
 DELETE FROM table WHERE SomeDate < 7 years ago; 
```

案例 2：没有级联删除

```
 FOR EACH R IN (SELECT FROM table WHERE SomeDate < 7 years ago) LOOP
   DELETE FROM ChildTable WHERE tableId = R.tableId;
   DELETE FROM table WHERE tableId = R.tableid;
   /* More child tables here */
 NEXT 
```

其次，当您使用级联删除添加额外的子表时，案例 1 中的代码将继续工作。

我只会在关系的语义是“一部分”的情况下放入级联。否则一些白痴会在你这样做时删除一半的数据库：

```
DELETE FROM CURRENCY WHERE CurrencyCode = 'USD' 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-12T15:34:38.420

我尽量避免在 SQL Server 中没有明确请求的删除或更新。

通过级联或使用触发器。他们往往会在一段时间后咬你一口，无论是在试图追踪错误或诊断性能问题时。

我会使用它们的地方是保证一致性，而不是太多的努力。要获得相同的效果，您必须使用存储过程。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-16T19:05:36.210

我和这里的其他人一样，发现级联删除实际上只有一点点帮助（删除其他表中的引用数据实际上并没有那么多工作——如果有很多表，你只需使用脚本自动执行此操作）但真的很烦人当有人不小心级联删除了一些难以恢复的重要数据时。

我会使用的唯一情况是表中的数据是高度控制的（例如，有限的权限），并且只能通过已验证的受控过程（如软件更新）进行更新或删除。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-01-25T00:40:48.627

可以通过以下三种方式之一来处理对 S 的删除或更新，即移除在 R 的某些元组中发现的外键值：

1.  拒绝
2.  传播
3.  作废。

传播称为级联。

有两种情况：

‣ 如果 S 中的元组被删除，则删除引用它的 R 元组。

‣ 如果 S 中的元组已更新，则更新引用它的 R 元组中的值。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-08-05T20:21:04.600

如果您正在使用具有不同版本的许多不同模块的系统，如果级联删除的项目是 PK 持有者的一部分/拥有，这将非常有帮助。否则，在删除 PK 所有者之前，所有模块都需要立即修补以清理其依赖项，否则将完全省略外键关系，如果清理不正确，可能会在系统中留下大量垃圾。

我刚刚为两个已经存在的表之间的新交集表引入了级联删除（仅删除的交集），在很长一段时间内不鼓励级联删除之后。如果数据丢失也不错。

然而，对于类似枚举的列表表来说，这是一件坏事：有人从表“颜色”中删除条目 13 - 黄色，并且数据库中的所有黄色项目都被删除。此外，这些有时会以 delete-all-insert-all 的方式进行更新，导致完全省略参照完整性。当然这是错误的，但是你将如何改变一个已经运行多年的复杂软件，而引入真正的参照完整性可能会带来意想不到的副作用？

另一个问题是，即使在删除主键后，仍应保留原始外键值。可以为原始 FK 创建一个 tombstone 列和一个 ON DELETE SET NULL 选项，但这又需要触发器或特定代码来维护冗余（PK 删除后除外）键值。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-12-09T20:39:33.090

在物理数据库中实现逻辑超类型和子类型实体时，级联删除非常有用。

当单独的超类型和子类型表用于物理实现超类型/子类型（而不是将所有子类型属性汇总到单个物理超类型表中）时，存在一对一-这些表之间的关系，然后问题就变成了如何在这些表之间保持主键 100% 同步。

级联删除可能是一个非常有用的工具：

1) 确保删除一个超类型记录也会删除相应的单个子类型记录。

2) 确保对子类型记录的任何删除也会删除超类型记录。这是通过在子类型表上实现“替代”删除触发器来实现的，该触发器会删除相应的超类型记录，进而级联删除子类型记录。

以这种方式使用级联删除可确保不存在孤立的超类型或子类型记录，无论您是先删除超类型记录还是先删除子类型记录。

# java - 休眠 - 从 EHCache 到 TreeCache 的 maxElementsOnDisk

> ID：59299
> 
> 赞同：1
> 
> 时间：2008-09-12T15:28:01.540
> 
> 标签：java, hibernate, caching, ehcache

我正在将 Hibernate 应用程序的缓存从 EHCache 迁移到 JBoss TreeCache。我正在尝试找到如何配置等效于 maxElementsOnDisk 以限制磁盘上的缓存大小，但我找不到任何类似于在激活钝化的 FileCacheLoader 中配置的东西。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-14T15:04:53.980

[此页面](http://www.junlu.com/msg/179368.html)似乎暗示正确的配置元素是：

```
<attribute name="MaxCapacity">20000</attribute>
```

但是，我自己只使用过 EHCache。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T12:38:32.067

在我正在使用的版本（JBossCache 1.4.1）中，似乎无法配置此参数。

# oracle - 在事务中包装 Oracle 模式更新

> ID：59303
> 
> 赞同：4
> 
> 时间：2008-09-12T15:28:28.280
> 
> 标签：oracle, transactions, ddl

我有一个定期更新其数据库模式的程序。有时，其中一个 DDL 语句可能会失败，如果确实如此，我想回滚所有更改。我将更新包装在这样的事务中：

```
BEGIN TRAN;

CREATE TABLE A (PKey int NOT NULL IDENTITY, NewFieldKey int NULL, CONSTRAINT PK_A PRIMARY KEY (PKey));
CREATE INDEX A_2 ON A (NewFieldKey);
CREATE TABLE B (PKey int NOT NULL IDENTITY, CONSTRAINT PK_B PRIMARY KEY (PKey));
ALTER TABLE A ADD CONSTRAINT FK_B_A FOREIGN KEY (NewFieldKey) REFERENCES B (PKey);

COMMIT TRAN; 
```

在我们执行时，如果其中一个语句失败，我会执行 ROLLBACK 而不是 COMMIT。这在 SQL Server 上效果很好，但对 Oracle 没有预期的效果。Oracle 似乎在每个 DDL 语句之后执行一个隐式 COMMIT：

*   [http://www.orafaq.com/wiki/SQL_FAQ#What_are_the_difference_between_DDL.2C_DML_and_DCL_commands.3F](http://www.orafaq.com/wiki/SQL_FAQ#What_are_the_difference_between_DDL.2C_DML_and_DCL_commands.3F)
*   [http://infolab.stanford.edu/~ullman/fcdb/oracle/or-nonstandard.html#transactions](http://infolab.stanford.edu/~ullman/fcdb/oracle/or-nonstandard.html#transactions)

有*什么*办法可以关闭这个隐式提交？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-12T15:38:10.160

您不能将其关闭。通过设计脚本以在它们已经存在的情况下删除表等，这很容易解决......

您可以查看使用 FLASHBACK 数据库，我相信您可以在架构/对象级别执行此操作，但请查看文档以确认这一点。您需要使用 10G 才能正常工作。

# css - 如何在div中以可变高度垂直居中内容？

> ID：59309
> 
> 赞同：167
> 
> 时间：2008-09-12T15:29:55.000
> 
> 标签：css, vertical-alignment

当内容的高度可变时，将 div 的内容垂直居中的最佳方法是什么。在我的特定情况下，容器 div 的高度是固定的，但是如果有一种解决方案可以在容器也具有可变高度的情况下工作，那就太好了。另外，我希望有一个不使用或很少使用 CSS hack 和/或非语义标记的解决方案。

![替代文字](https://content.screencast.com/users/jessegavin/folders/Jing/media/ba5c2688-0aad-4e89-878a-8911946f8612/2008-09-12_1027.png)

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2014-12-27T00:15:48.383

只需添加

```
position: relative;
top: 50%;
transform: translateY(-50%); 
```

到内部 div。

它所做的是将内部 div 的顶部边框移动到外部 div ( `top: 50%;`) 的一半高度，然后将内部 div 向上移动一半高度 ( `transform: translateY(-50%)`)。这将与`position: absolute`or一起使用`relative`。

请记住这一点，`transform`并`translate`具有为简单起见未包括在内的供应商前缀。

[代码笔： http](http://codepen.io/anon/pen/ZYprdb) ://codepen.io/anon/pen/ZYprdb

* * *

## 回答 #2

> 赞同：159
> 
> 时间：2012-10-25T19:35:36.820

只要您的浏览器支持`::before`伪元素，这似乎是我发现的最佳解决方案：[CSS-Tricks: Centering in the Unknown](http://css-tricks.com/centering-in-the-unknown/)。

它不需要任何额外的标记，而且似乎工作得非常好。我无法使用该`display: table`方法，因为`table`元素不服从该`max-height`属性。

```
.block {
  height: 300px;
  text-align: center;
  background: #c0c0c0;
  border: #a0a0a0 solid 1px;
  margin: 20px;
}

.block::before {
  content: '';
  display: inline-block;
  height: 100%; 
  vertical-align: middle;
  margin-right: -0.25em; /* Adjusts for spacing */

  /* For visualization 
  background: #808080; width: 5px;
  */
}

.centered {
  display: inline-block;
  vertical-align: middle;
  width: 300px;
  padding: 10px 15px;
  border: #a0a0a0 solid 1px;
  background: #f5f5f5;
}
```

```
<div class="block">
    <div class="centered">
        <h1>Some text</h1>
        <p>But he stole up to us again, and suddenly clapping his hand on my
           shoulder, said&mdash;"Did ye see anything looking like men going
           towards that ship a while ago?"</p>
    </div>
</div>
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-09-12T15:34:31.743

这是我需要做很多次的事情，并且一致的解决方案仍然需要您添加一些非语义标记和一些特定于浏览器的 hack。当我们获得对 css 3 的浏览器支持时，您将获得垂直居中而不会犯错。

为了更好地解释该技术，您可以查看[我改编自的文章](http://www.jakpsatweb.cz/css/css-vertical-center-solution.html)，但基本上它涉及添加额外元素并在支持`position:table\table-cell`非表格元素的 IE 和浏览器中应用不同的样式。

```
<div class="valign-outer">
    <div class="valign-middle">
        <div class="valign-inner">
            Excuse me. What did you sleep in your clothes again last night. Really. You're gonna be in the car with her. Hey, not too early I sleep in on Saturday. Oh, McFly, your shoe's untied. Don't be so gullible, McFly. You got the place fixed up nice, McFly. I have you're car towed all the way to your house and all you've got for me is light beer. What are you looking at, butthead. Say hi to your mom for me.
        </div>
    </div>
</div>

<style>
    /* Non-structural styling */
    .valign-outer { height: 400px; border: 1px solid red; }
    .valign-inner { border: 1px solid blue; }
</style>

<!--[if lte IE 7]>
<style>
    /* For IE7 and earlier */
    .valign-outer { position: relative; overflow: hidden; }
    .valign-middle { position: absolute; top: 50%; }
    .valign-inner { position: relative; top: -50% }
</style>
<![endif]-->
<!--[if gt IE 7]> -->
<style>
    /* For other browsers */
    .valign-outer { position: static; display: table; overflow: hidden; }
    .valign-middle { position: static; display: table-cell; vertical-align: middle; width: 100%; }
</style> 
```

有很多方法（hacks）可以在特定的浏览器集中应用样式。我使用了条件注释，但请查看上面链接的文章以了解其他两种技术。

*注意：如果您事先知道一些高度，如果您试图将单行文本居中，或者在其他几种情况下，有一些简单的方法可以实现垂直居中。如果您有更多详细信息，请把它们扔进去，因为可能有一种方法不需要浏览器黑客或非语义标记。*

**更新：**我们开始为 CSS3 获得更好的浏览器支持，将 flex-box 和变换作为获得垂直居中（以及其他效果）的替代方法。有关现代方法的更多信息，请参阅[this other question](https://stackoverflow.com/questions/5412912/align-vertically-using-css-3)，但请记住，浏览器对 CSS3 的支持仍然很粗略。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2020-05-20T21:42:22.477

您可以使用弹性显示，例如以下代码：

```
.example{
  background-color:red;
  height:90px;
  width:90px;
  display:flex;
  align-items:center; /*for vertically center*/
  justify-content:center; /*for horizontally center*/
}
```

```
<div class="example">
    <h6>Some text</h6>
</div>
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-12-06T21:48:17.417

使用子选择器，我采用了[Fadi](https://stackoverflow.com/questions/59309/how-to-vertically-center-content-with-variable-height-within-a-div/13075912#13075912)上面令人难以置信的答案，并将其归结为一个我可以应用的 CSS 规则。现在我要做的就是将`contentCentered`类名添加到我想要居中的元素中：

```
.contentCentered {
  text-align: center;
}

.contentCentered::before {
  content: '';
  display: inline-block;
  height: 100%; 
  vertical-align: middle;
  margin-right: -.25em; /* Adjusts for spacing */
}

.contentCentered > * {
  display: inline-block;
  vertical-align: middle;
}
```

```
<div class="contentCentered">
  <div>
    <h1>Some text</h1>
    <p>But he stole up to us again, and suddenly clapping his hand on my
      shoulder, said&mdash;"Did ye see anything looking like men going
      towards that ship a while ago?"</p>
  </div>
</div>
```

分叉的 CodePen：[http ://codepen.io/dougli/pen/Eeysg](http://codepen.io/dougli/pen/Eeysg)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-11-21T04:30:37.203

到目前为止对我来说最好的结果：

div居中：

```
position: absolute;
top: 50%;
transform: translateY(-50%);
margin: 0 auto;
right: 0;
left: 0; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-05-18T09:00:43.847

您可以使用边距自动。使用 flex，div 似乎也垂直居中。

```
body,
html {
  height: 100%;
  margin: 0;
}
.site {
  height: 100%;
  display: flex;
}
.site .box {
  background: #0ff;
  max-width: 20vw;
  margin: auto;
} 
```

```
<div class="site">
  <div class="box">
    <h1>blabla</h1>
    <p>blabla</p>
    <p>blablabla</p>
    <p>lbibdfvkdlvfdks</p>
  </div>
</div> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-09-27T18:10:37.883

对我来说，最好的方法是：

```
.container{
  position: relative;
}

.element{
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
} 
```

优点是不必明确高度

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-30T16:24:05.760

这是我对于`div`具有动态（百分比）高度的出色解决方案。

**CSS**

```
.vertical_placer{
  background:red;
  position:absolute; 
  height:43%; 
  width:100%;
  display: table;
}

.inner_placer{  
  display: table-cell;
  vertical-align: middle;
  text-align:center;
}

.inner_placer svg{
  position:relative;
  color:#fff;
  background:blue;
  width:30%;
  min-height:20px;
  max-height:60px;
  height:20%;
} 
```

**HTML**

```
<div class="footer">
    <div class="vertical_placer">
        <div class="inner_placer">
            <svg> some Text here</svg>
        </div>
    </div>
</div> 
```

[自己试试这个。](http://jsfiddle.net/hunter74/oosb3s8w/1/)

# windows-xp - Windows XP 中用户启动的内核转储

> ID：59313
> 
> 赞同：7
> 
> 时间：2008-09-12T15:30:24.437
> 
> 标签：windows-xp, kernel, memory-dump

我记得看过 Mark Russinovich 的网络广播，展示了用户启动的内核转储的键盘按键顺序。有人可以按键的确切顺序刷新我的记忆吗？

请注意，这是针对 XP 的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-12T15:54:13.223

[http://psacake.com/web/jr.asp](http://psacake.com/web/jr.asp)包含完整的说明，这里是摘录：

```
虽然考虑故意导致蓝屏死机 (BSOD) 可能看起来很奇怪，但 Microsoft 在 Windows XP 中包含了这样的规定。这对于测试和故障排除您的启动和恢复设置、事件日志记录以及演示目的可能会派上用场。

以下是创建 BSOD 的方法：

启动注册表编辑器 (Regedit.exe)。
转到 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\i8042prt\Parameters。
转到编辑，选择新建 | DWORD 值并将新值命名为 CrashOnCtrlScroll。
双击 CrashOnCtrlScroll DWORD 值，在数值数据文本框中键入 1，然后单击确定。
关闭注册表编辑器并重新启动 Windows XP。
当您想要导致蓝屏时，按住键盘右侧的 [Ctrl] 键，然后点击 [ScrollLock] 键两次。现在您应该看到 BSOD。

如果您的系统重新启动而不是显示 BSOD，您将不得不禁用 Automatically
系统属性对话框中的重启设置。为此，请按照下列步骤操作：

按 [Windows] - 中断。
选择高级选项卡。
单击“启动和恢复”面板中的“设置”按钮。
清除 System Failure 面板中的 Automatically Restart 复选框。
单击确定两次。

以下是删除 BSOD 配置的方法：

启动注册表编辑器 (Regedit.exe)。
转到 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\i8042prt\Parameters。
选择 CrashOnCtrlScroll 值，下拉编辑菜单，然后选择删除命令。
关闭注册表编辑器并重新启动 Windows XP。
注意：编辑注册表是有风险的，因此在进行任何更改之前，请确保您拥有经过验证的备份。

```

我假设你想要 BSOD 可能是错误的，所以这是一个 Microsoft 页面，展示了如何捕获内核转储： https://web.archive.org/web/20151014034039/https: [//support.microsoft.com/fr- ma/kb/316450](https://web.archive.org/web/20151014034039/https://support.microsoft.com/fr-ma/kb/316450)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T15:48:08.777

据我所知，“创建转储”命令仅添加到 Vista 的任务管理器中。我知道的唯一过程是使用[Debugging Tools](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)附带的 adplus VBScript 。没有连接到 dbghelp 并以编程方式自己完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T15:58:27.647

您可以使用热键设置 Microsoft的[用户转储工具来转储进程。](http://support.microsoft.com/kb/241215)但是，这是用户进程转储，而不是内核转储...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T15:43:20.927

我不知道任何键盘快捷键，但是当您右键单击一个进程并选择“创建转储”时，您是否正在寻找像在任务管理器中一样？

# sql - 在 SQL 中，count(*) 和 count('x') 有什么区别？

> ID：59322
> 
> 赞同：14
> 
> 时间：2008-09-12T15:34:16.987
> 
> 标签：sql

我有以下代码：

```
SELECT <column>, count(*)
FROM <table>
GROUP BY <column> HAVING COUNT(*) > 1; 
```

如果我用 COUNT('x') 替换 COUNT(*)，结果或性能有什么不同吗？

（这个问题与上一个问题[有关](https://stackoverflow.com/questions/59294/in-sql-whats-the-difference-between-countcolumn-and-count)）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-12T16:12:59.467

说`SELECT COUNT(*) vs COUNT(1)`导致您的 DBMS 返回“列”的结果纯属扯淡。很久很久以前*可能*就是这种情况，但是任何自尊的查询优化器都会选择一些快速的方法来计算表中的行数——两者之间**没有**性能差异`SELECT COUNT(*), COUNT(1), COUNT('this is a silly conversation')`

此外，`SELECT(1) vs SELECT(*)`INDEX 的使用不会有任何差异——大多数 DBMS 实际上都会优化`SELECT( n ) into SELECT(*)`。`SELECT(n) into SELECT(*)`请参阅 ASK TOM：Oracle在十年的大部分时间里 一直在优化：http://asktom.oracle.com/pls/asktom/f?p=100:11: [0::::P11_QUESTION_ID： 1156151916789](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:1156151916789)

> 问题在于 count(col) 到 count( *) 的转换* ******03/23/00** 05:46 pm *** 一种解决方法是将事件 10122 设置为关闭 count(col) ->count( *) 优化。另一种解决方法是将 count(col) 更改为 count(* )，当 col 具有 NOT NULL 约束时，这意味着相同。错误编号为 1215372。**

 **需要注意的一件事 - 如果您使用 COUNT(col) （不要！）并且 col 标记为 NULL，那么它实际上必须计算表中出现的次数（通过索引扫描、直方图等，如果它们存在，否则进行全表扫描）。

底线：如果您想要的是表中的行数，请使用 COUNT(*)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-12T15:54:51.007

主要的性能差异是 COUNT(*) 可以通过检查表上的主键来满足。

即在下面的简单情况下，查询将立即返回，无需检查任何行。

```
select count(*) from table 
```

我不确定 SQL Server 中的查询优化器是否会这样做，但在上面的示例中，如果您要分组的列具有索引，则服务器应该能够满足查询而根本不触及实际表。

澄清一下：这个答案专门针对 SQL Server。我不知道其他 DBMS 产品如何处理这个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-12T15:57:20.457

这个问题与另一个引用的问题略有不同。在引用的问题中，有人问到使用 count(*) 和 count(SomeColumnName) 时有什么区别，[SQLMenace 的回答](https://stackoverflow.com/questions/59294/in-sql-whats-the-difference-between-countcolumn-and-count#59302)很准确。

要解决这个问题，结果基本上没有区别。count(*) 和 count('x') 和说 count(1) 都将返回相同的数字。不同之处在于，当使用“*”时，就像在 SELECT 中一样，返回所有列，然后计算。当使用常量（例如'x' 或1）时，将返回一行一列，然后进行计数。当“ * ”返回许多列时会看到性能差异。

**更新**：上述关于性能的陈述可能与其他答案中讨论的不太正确，但在使用 EXISTS 和 NOT EXISTS 时确实适用于子选择查询

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-12T20:18:51.357

MySQL：根据 MySQL 网站，`COUNT(*)`使用 MyISAM 时单表查询速度更快：

[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_count](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_count)

我猜有一个带有计数的有子句可能会改变事情。

# stock - 哪些在线经纪人提供 API？

> ID：59327
> 
> 赞同：155
> 
> 时间：2008-09-12T15:34:58.683
> 
> 标签：stock, trading

所以我真的厌倦了 E*TRADE，作为一名开发人员，我很想找到一个提供 API 的在线经纪人。能够编写我自己的交易工具，甚至修改现有的工具，这将是很棒的。

根据我到目前为止的研究，我只找到了一种选择。盈透证券提供多语言 API（Java/C++/ActiveX/DDE），并提供一些相当不错的佣金率。我想确保没有其他我应该考虑的选择。有任何想法吗？

更新：根据到目前为止的答案，这里有一个快速列表......

*   [盈透证券](http://www.interactivebrokers.com/)
    *   爪哇
    *   C++
    *   活动X
    *   Excel 的 DDE
*   [巅峰交易](http://www.pcmtrading.com)
    *   C++
    *   Perl
    *   VB.NET
    *   Excel
*   [MB交易](http://www.mbtrading.com/developersMain.aspx?page=sdk)

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-12T15:45:58.033

我投票给 IB（盈透证券）。我过去使用过它们，非常高兴。Pinnacle Capital Markets 交易也有一个 API (pcmtrading.com)，但我没有使用它们。

**盈透证券：**

[https://www.interactivebrokers.com/en/?f=%2Fen%2Fsoftware%2Fibapi.php](https://www.interactivebrokers.com/en/?f=%2Fen%2Fsoftware%2Fibapi.php)

**巅峰资本市场：**

[http://www.pcmtrading.com/es/technology/api.html](http://www.pcmtrading.com/es/technology/api.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-12-29T21:56:53.230

看起来[E*Trade](https://developer.etrade.com/)现在有一个 API。

对于访问历史数据，我发现[EODData](http://www.eoddata.com/)的数据转储价格合理。对于副项目，我负担不起（宁愿不想负担）巨额订阅费，只是为了修补一些数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-07T11:09:18.003

我一直在使用[marketcetera](http://www.marketcetera.com/site/)平台的一部分。它们支持各种[市场数据源和经纪人](http://www.marketcetera.com/site/products/what%E2%80%99s-supported)，您应该能够轻松添加更多经纪人和/或数据提供者。当然，这不是一个直接的代理 API，但它可以帮助您避免供应商锁定，这可能是一件好事。当然，他们使用的所有工具都是开源的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-01T16:33:25.847

[openecry.com](http://openecry.com)是一个经纪人，拥有大量关于 API 的信息以及如何操作的说明。OEC 平台上还有其他经纪人，以及专业人士可能要求的所有花里胡哨。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-12T15:47:25.037

有几个。我正在寻找一个朋友的[MBTrading 。](http://www.mbtrading.com/sdk.asp "MBTrading SDK")我没有走得太远，因为我的朋友失去了兴趣。使用 C# 和 VB.Net SDK 似乎相对直截了当。他们有一些文档和一切。这是大约 6 个月前，所以现在可能更好（或更糟）。

IIRC，您可以免费创建一个模拟账户。我不记得所有的细节，但它可以让你连接到他们的测试服务器并提取报价并进行虚假交易等，以便对你的软件进行微调。

不太了解实际帐户或任何东西的成本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-25T23:05:50.447

只要您有 Ameritrade 账户，Ameritrade 还提供 API：[http ://www.tdameritrade.com/tradingtools/partnertools/api_dev.html](http://www.tdameritrade.com/tradingtools/partnertools/api_dev.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-11-15T11:54:28.273

[用于TD Ameritrade 交易平台](https://www.tdameritrade.com/api.page)的 .NET 客户端库：

[**TD Ameritrade .NET SDK**](https://github.com/kriasoft/site-sdk)，也可通过[**NuGet获得**](https://www.nuget.org/packages/TDAmeritrade.Client/2.0.0-alpha2)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-22T13:49:00.440

仅与货币交易 (Forex) 相关，但许多外汇经纪商提供 MetaTrader，可让您在 MQL 中编码。它的主要问题（除了它仅限于外汇）是您必须使用 MQL 进行编码，这可能不是您的首选语言。

# c++ - C++ 函数模板特化的可见性

> ID：59331
> 
> 赞同：25
> 
> 时间：2008-09-12T15:36:14.920
> 
> 标签：c++, linux, templates, linker, g++

假设我`fileA.h`声明了一个`classA`带有模板函数的类`SomeFunc<T>()`。该函数直接在头文件中实现（与模板函数一样）。现在，我在（即不在头文件中）添加了`SomeFunc()`（如 for `SomeFunc<int>()`）的专门实现。`fileA.C`

如果我现在`SomeFunc<int>()`从其他代码（可能也来自另一个库）调用，它会调用通用版本还是专业化版本？

我现在有这个问题，类和函数存在于两个应用程序使用的库中。一个应用程序正确地使用了专业化，而另一个应用程序使用了通用形式（这会导致稍后出现运行时问题）。为什么有区别？这可能与链接器选项等有关吗？这是在 Linux 上，使用 g++ 4.1.2。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-12T16:14:26.313

对在调用点不可见的模板进行专门化是**错误的。**不幸的是，编译器不需要诊断这个错误，然后可以用你的代码做他们喜欢的事情（在标准中它是“格式错误，不需要诊断”）。

从技术上讲，您需要在头文件中定义特化，但几乎每个编译器都会按照您的预期处理这个问题：这在 C++11 中通过新的“外部模板”工具修复：

```
extern template<> SomeFunc<int>(); 
```

这明确声明特定专业化在其他地方定义。许多编译器已经支持这一点，有些有，有些没有`extern`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-12T15:44:57.757

您是否在头文件中添加了带有参数的原型？

我的意思是在fileA.h中的某个地方

```
template<> SomeFunc<int>(); 
```

如果不是这可能是原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T18:50:39.470

我对 gcc4 有同样的问题，这就是我解决它的方法。这是一个比我之前的评论所相信的更简单的解决方案。以前的帖子想法是正确的，但它们的语法对我不起作用。

```
 ----------header-----------------
    template < class A >
    void foobar(A& object)
    {
      std::cout << object;
    }

    template <> 
    void foobar(int);

    ---------source------------------
    #include "header.hpp"

    template <>
    void foobar(int x)
    {
      std::cout << "an int";
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-12T15:59:00.547

根据规范，您的专用函数模板永远不应该在外部调用`fileA.C`，除非您`export`的模板定义目前没有编译器（Comeau 除外）支持（或计划在可预见的未来使用）。

另一方面，一旦函数模板被实例化，编译器就会看到一个不再是模板的函数。GCC 可以在不同的编译器单元中重复使用这个定义，因为标准规定每个模板只能针对给定的一组类型参数 [temp.spec] 实例化一次。尽管如此，由于没有导出模板，这应该仅限于编译单元。

我相信 GCC 可能会在跨编译单元共享其实例化模板列表时暴露一个错误。通常，这是一个合理的优化，但它应该考虑到它似乎没有正确执行的函数专业化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-12T16:10:25.777

在 Microsoft C++ 中，我用内联函数做了一个实验。我想知道如果我在不同的来源中定义了不兼容的函数版本会发生什么。根据我使用的是 Debug 构建还是 Release 构建，我得到了不同的结果。在 Debug 中，编译器拒绝内联任何内容，并且链接器正在链接相同版本的函数，无论源代码中的范围是什么。在 Release 中，编译器内联了当时定义的任何版本，并且您得到了不同版本的函数。

在这两种情况下都没有任何警告。我有点怀疑这一点，这就是我做这个实验的原因。

我假设模板函数的行为与其他编译器一样。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-11T13:24:36.677

正如 Anthony Williams 所说，`extern template`构造是执行此操作的正确方法，但由于他的示例代码不完整并且有多个语法错误，这里有一个完整的解决方案。

文件A.h：

```
namespace myNamespace {
  class classA {
    public:
      template <class T> void SomeFunc() { ... }
  };

  // The following line declares the specialization SomeFunc<int>().
  template <> void classA::SomeFunc<int>();

  // The following line externalizes the instantiation of the previously
  // declared specialization SomeFunc<int>(). If the preceding line is omitted,
  // the following line PREVENTS the specialization of SomeFunc<int>();
  // SomeFunc<int>() will not be usable unless it is manually instantiated
  // separately). When the preceding line is included, all the compilers I
  // tested this on, including gcc, behave exactly the same (throwing a link
  // error if the specialization of SomeFunc<int>() is not instantiated
  // separately), regardless of whether or not the following line is included;
  // however, my understanding is that nothing in the standard requires that
  // behavior if the following line is NOT included.
  extern template void classA::SomeFunc<int>();
} 
```

文件AC：

```
#include "fileA.h"

template <> void myNamespace::classA::SomeFunc<int>() { ... } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-12T15:43:32.690

除非头文件中还列出了专用模板功能，否则其他应用程序将不知道专用版本。解决方案也是添加`SomeFunc<int>()`到标题中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-12T15:47:38.327

Brandon：这就是我的想法——永远不应该调用专门的函数。我提到的第二个应用程序也是如此。然而，第一个应用程序清楚地调用了专门化形式，即使在头文件中没有声明专门化！

我主要在这里寻求启发:-)因为第一个应用程序是单元测试，不幸的是有一个没有出现在测试中但在真实应用程序中出现的错误......

（PS：我已经修复了这个特定的错误，实际上是通过在标题中声明专业化；但是还有哪些其他类似的错误可能被隐藏？）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-12T16:35:47.697

@[安东尼-威廉姆斯]，

您确定没有将`extern`模板声明与`extern template`实例化混淆吗？从我所见，`extern template`只能用于显式实例化，而不用于专门化（这意味着隐式实例化）*。*[temp.expl.spec] 没有提到`extern`关键字：

> *显式专业化*：
>     `template`< >*声明*

# sql - 将关系数据从数据库复制到数据库

> ID：59357
> 
> 赞同：5
> 
> 时间：2008-09-12T15:42:57.900
> 
> 标签：sql, sql-server, sql-server-2005, .net-3.5

**编辑**：让我完全改写一下，因为我不确定是否有像我最初描述的那样的 XML 方式。

**另一个编辑**：这需要是一个可重复的过程，并且必须能够以可以在 C# 代码中调用的方式进行设置。

在数据库 A 中，我有一组表，由 PK 和 FK 相关。比方说，一个带有子表和孙表的父表。

我想**将一组行从数据库 A 复制到数据库 B**，该数据库具有相同名称的表和字段。对于每个表，我想插入到数据库 B 中的同一个表中。但我不能被限制使用相同的主键。 **复制例程必须**为数据库 B 中的每一行创建新的 PK，并且必须将它们传播到子行。换句话说，我在数据之间保持相同的关系，但不是完全相同的 PK 和 FK。

你会如何解决这个问题？我愿意接受建议。SSIS 没有被完全排除，但在我看来它不会做这个确切的事情。我也对 LINQ 中的解决方案持开放态度，或者使用类型化的数据集，或者使用一些 XML 的东西，或者任何可以在 SQL Server 2005 和/或 C# (.NET 3.5) 中工作的东西。最好的解决方案不需要 SSIS，也不需要编写大量代码。但我承认，这种“最佳”解决方案可能不存在。

（我没有自己完成这项任务，也没有限制；这就是给我的方式。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T14:10:26.407

我认为 SQL Server 实用程序[tablediff.exe](http://weblogs.sqlteam.com/mladenp/archive/2007/03/03/60125.aspx)可能是您正在寻找的。

另请参阅[此线程](https://stackoverflow.com/questions/121243/hidden-features-of-sql-server)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T16:08:03.533

首先，让我说 SSIS 是您最好的选择。但是，要回答您提出的问题...

我不相信您可以到处创建新的 ID，尽管您可以，但您需要使用原始 ID 进行查找。

你能得到的最好的结果是一个表的插入语句。下面是`SELECT`从 XML 示例中获取数据的代码示例：

```
declare @xml xml 
set @xml='<People Key="1" FirstName="Bob" LastName="Smith">
  <PeopleAddresses PeopleKey="1" AddressesKey="1">
    <Addresses Key="1" Street="123 Main" City="St Louis" State="MO" ZIP="12345" />
  </PeopleAddresses>
</People>
<People Key="2" FirstName="Harry" LastName="Jones">
  <PeopleAddresses PeopleKey="2" AddressesKey="2">
    <Addresses Key="2" Street="555 E 5th St" City="Chicago" State="IL" ZIP="23456" />
  </PeopleAddresses>
</People>
<People Key="3" FirstName="Sally" LastName="Smith">
  <PeopleAddresses PeopleKey="3" AddressesKey="1">
    <Addresses Key="1" Street="123 Main" City="St Louis" State="MO" ZIP="12345" />
  </PeopleAddresses>
</People>
<People Key="4" FirstName="Sara" LastName="Jones">
  <PeopleAddresses PeopleKey="4" AddressesKey="2">
    <Addresses Key="2" Street="555 E 5th St" City="Chicago" State="IL" ZIP="23456" />
  </PeopleAddresses>
</People>
'

select t.b.value('./@Key', 'int') PeopleKey,
    t.b.value('./@FirstName', 'nvarchar(50)') FirstName,
    t.b.value('./@LastName', 'nvarchar(50)') LastName
from @xml.nodes('//People') t(b)

select t.b.value('../../@Key', 'int') PeopleKey,
    t.b.value('./@Street', 'nvarchar(50)') Street,
    t.b.value('./@City', 'nvarchar(50)') City,
    t.b.value('./@State', 'char(2)') [State],
    t.b.value('./@Zip', 'char(5)') Zip
from 
@xml.nodes('//Addresses') t(b) 
```

这样做是从 XML 中获取节点并解析数据。为了从人们那里获取关系 ID，我们使用 ../../ 来上链。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T15:50:21.907

转储 XML 方法并使用导入向导/SSIS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T21:47:16.120

到目前为止，最简单的方法是 Red Gate 的 SQL 数据比较。您可以将其设置为在一两分钟内完成您所描述的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-13T16:38:31.067

我也喜欢 Red Gate 的 SQL 比较和数据比较，但据我所知，它不能满足他对更改主键的要求。

如果跨数据库查询/链接服务器是一个选项，您可以使用存储过程来执行此操作，该存储过程将 DB A 中的父/子记录复制到 DB B 上的临时表中，然后在临时子表中为新主键添加一列插入标题后您将更新。

我的问题是，如果记录没有相同的主键，你如何判断它是否是新记录？还有其他候选键吗？如果这些是新表，为什么它们不能具有相同的主键？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T10:24:45.400

我用一组存储过程创建了同样的东西。

数据库 B 将有自己的主键，但存储数据库 A 的主键，用于调试目的。这意味着我可以拥有多个数据库 A！

数据通过链接服务器复制。不要太快；SSIS 更快。但是 SSIS 不适合初学者，而且要编写适用于更改源表的代码并不容易。

从 C# 调用存储过程很容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-16T11:33:06.953

我会在存储过程中编写脚本，使用插入来完成艰苦的工作。您的代码将从表 A 中获取 PK（可能通过 @@Scope_Identity） - 我假设表 A 的 PK 是一个身份字段？

您可以使用临时表、游标，或者您可能更喜欢使用 CLR——它可能适合这种操作。

我会惊讶地发现一个工具可以通过 a) 预先确定的密钥或 b) 身份字段（显然表 B 和 C 没有它们）来完成此任务。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T06:00:18.743

您是否每次都清除目标表然后重新开始？这将对您需要实施的解决方案产生重大影响。如果您每次都进行完整的重新导入，那么您可以执行以下操作：

创建一个临时表或表变量来记录父表的新旧主键。

将父表数据插入目标并使用[OUTPUT](http://blogs.msdn.com/sqltips/archive/2005/06/13/OUTPUT-clause.aspx)子句捕获新 ID 并将它们与旧 ID 一起插入到临时表中。注意：使用输出子句是有效的，并且允许您进行批量插入，而无需循环遍历要插入的每条记录。

插入子表数据。加入临时表以检索所需的新外键。

上述过程可以使用 T-SQL 脚本、C# 代码或 SSIS 完成。我更喜欢 SSIS。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T00:54:41.747

如果您每次都添加，那么您可能需要保留一个永久表来跟踪源数据库主键和目标数据库主键之间的关系（至少对于父表）。如果您需要将此类数据保留在目标数据库之外，您可以让 SSIS 从某种日志记录数据库甚至平面文件中存储/检索它。

如果父表中存在可用于唯一标识该记录并因此“找到”目标数据库中该记录的主键的字段组合，则您可能会避免上述情况。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T01:54:45.173

我认为我最有可能使用的是类型化数据集。这不会是一个通用的解决方案；如果任何表发生变化，我们将不得不重新生成它们。但根据我被告知的情况，这不是问题。预计表格不会有太大变化。

数据集将使分层循环数据并在插入后刷新数据库中的 PK 变得相当容易。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-30T14:05:32.393

在处理类似任务时，我只是创建了一组存储过程来完成这项工作。

由于您指定的任务非常自定义，因此您不太可能找到“即用型”解决方案。

只是给你一些提示：

*   如果数据库在不同的服务器上，请使用链接服务器，这样您就可以通过 TSQL 访问源表和目标表

在存储过程中：

*   确定需要复制的父项 - 您说主键不同，因此您需要使用唯一约束（如果表被规范化，您应该能够定义它们）
*   根据识别的父项识别需要复制的子项，以检查其中一些是否已经在目标数据库中，再次使用唯一约束方法
*   识别孙子项目（与父子项目相同的逻辑）
*   从最低级别（孙子、孩子、父母）开始复制数据

不需要游标等，只需将即时结果存储在临时表中（或表变量，如果在一个存储过程中工作）

这种方法对我很有效。

您当然可以将参数添加到主存储过程，以便您可以复制所有新记录或仅复制您指定的记录。

让我知道这是否有帮助。

# image-manipulation - 有没有办法使用 GflAx 来合并渐变色？

> ID：59377
> 
> 赞同：0
> 
> 时间：2008-09-12T15:49:58.010
> 
> 标签：image-manipulation, gradient

好的，今天的狭隘问题。我正在使用[GflAx](http://pagesperso-orange.fr/pierre.g/xnview/engfl.html)（来自[xnview](http://www.xnview.com)）创建一些图形图块。不过，我也想加入一些渐变。

有没有办法在这个产品中做到这一点？

还有一个 SDK 是该产品的一部分，但我在那里找不到该信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T16:34:51.293

你不能这样做，但你可以在另一个程序中创建渐变，然后做一个“LoadBitmap”，在那个“背景”上制作你需要的模组，然后保存到一个新文件中。

# php - 通配符子域例外

> ID：59380
> 
> 赞同：5
> 
> 时间：2008-09-12T15:50:38.023
> 
> 标签：php, apache, .htaccess, wildcard-subdomain

我启用了通配符子域，并通过将 URL 按原样传递给我的`index.php`（例如`somecity.domain.com`）来动态解析 URL。

现在，我希望创建一些静态子域，我可以在其中安装不同的应用程序，而不是与我当前的应用程序（例如`blog.domain.com`）混合。

我`.htaccess`目前的阅读：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

我可以操纵它`.htaccess`来实现我的需要吗？可以通过Apache完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-12T16:06:50.450

您的 .htaccess 没有任何用处，因为 Apache 可能配置了 DirectoryIndex index.php。好吧，它确实将 domain.com/a 移动到 domain.com/index.php，但我怀疑这就是你想要的。

您的通配符虚拟主机有效，因为您的配置中可能有 ServerAlias *.domain.com，或者单个虚拟主机和 DNS 指向您的服务器地址。（当你有一个虚拟主机时，它会针对任何请求显示，第一个列出的虚拟主机是默认的）

您必须为静态域创建新的 VirtualHost，将默认的保留为默认的 :)

检查[这些](http://httpd.apache.org/docs/2.2/vhosts/examples.html) 解释这一切的[教程。](http://wiki.apache.org/httpd/ExampleVhosts)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T15:53:53.833

您必须为这些静态子域配置 apache。“catch-all”站点将是配置的默认站点，这样一个站点将捕获另一个站点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T16:05:40.233

我不确定我是否完全理解您需要完成的工作，但在您的 Apache 配置文件中设置虚拟域可能会有所帮助。您可以将它们映射到驱动器上安装了不同应用程序的文件夹。每个虚拟域都被视为一个根目录。我在我的 Windows 机器上本地设置了我的开发环境，如下所示：

```
NameVirtualHost *:80

# Begin virtual host directives.

<VirtualHost *:80>

# myblog.com virtual host.

ServerAdmin webmaster@myblog.com
DocumentRoot "c:/apache_www/myblog.com/www"
ServerName myblog.com
ServerAlias *.myblog.com
ErrorLog "c:/apache_www/myblog.com/logs/log"
ScriptAlias /cgi-bin/ "c:/apache_www/myblog.com/cgi-bin/"

<Directory "c:/apache_www/myblog.com/www">
    Options Indexes FollowSymLinks
    AllowOverride All
    Order allow,deny
    Allow from all
</Directory>

</VirtualHost> 
```

如果这不能帮助您走上正轨，那么请尝试研究 VirtualHost 指令以提出解决方案。我发现尝试在 .htaccess 中完成所有这些操作既麻烦又难以管理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T19:06:55.990

我不知道您的主机上是否安装了 cPanel，但我可以通过添加一个新的子域`*`然后将所有流量发送到特定的子域来做到这一点，例如：`*.domain.com -> master.domain.com`. 然后，您可以读出您在 master.domain.com 中的哪个 URL 并从那里开始。

# coldfusion - ColdFusion：在 CFC 中省略 variables 关键字是否安全？

> ID：59390
> 
> 赞同：5
> 
> 时间：2008-09-12T15:57:04.857
> 
> 标签：coldfusion, cfc

在 ColdFusion 组件 (CFC) 中，是否有必要为变量范围的变量使用完全限定名称？

如果我改变这个，我会不会惹上麻烦：

```
<cfcomponent>
    <cfset variables.foo = "a private instance variable">

    <cffunction name = "doSomething">
        <cfset var bar = "a function local variable">
        <cfreturn "I have #variables.foo# and #bar#.">
    </cffunction>
</cfcomponent> 
```

到这个？

```
<cfcomponent>
    <cfset foo = "a private instance variable">

    <cffunction name = "doSomething">
        <cfset var bar = "a function local variable">
        <cfreturn "I have #foo# and #bar#.">
    </cffunction>
</cfcomponent> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-12T17:22:31.873

创建变量时指定“变量”无关紧要，因为 foo 默认会放在变量范围内；但是当您访问变量时会很重要。

```
<cfcomponent>
    <cfset foo = "a private instance variable">

    <cffunction name="doSomething">
        <cfargument name="foo" required="yes"/>
        <cfset var bar = "a function local variable">
        <cfreturn "I have #foo# and #bar#.">
    </cffunction>

    <cffunction name="doAnotherThing">
        <cfargument name="foo" required="yes"/>
        <cfset var bar = "a function local variable">
        <cfreturn "I have #variables.foo# and #bar#.">
    </cffunction>

</cfcomponent> 
```

doSomething("args") 返回“我有**args**和一个**函数局部变量**”

doAnotherThing("args") 返回“我有**一个变量的私有实例**和一个**函数局部变量**。”

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-24T18:14:17.897

我会说是的。有明确的必要吗？没有。你能不做就逃脱吗？当然。你是在自找麻烦吗？绝对地。如果您在 cffunction 中有以下内容：

```
<cfset foo = "bar" /> 
```

这不会将该变量放在函数 local var 范围内，而是将其放在 CFC 的全局 VARIABLES 范围内，这意味着它可用于该 CFC 的每个方法。有时您可能想要这样做，但大多数时候您会要求竞争条件。

当服务器正在读取任何变量时，如果该变量未明确声明为范围的一部分（REQUEST.、SESSION.等），则 ColdFusion 将运行 ScopeCheck() 来确定变量所在的范围。不仅这是否会给您的应用程序服务器带来不必要的开销，它还引入了劫持的能力，即您的变量在一个范围内，但是 ScopeCheck() 发现了一个同名的变量在优先级顺序中更高。

总是，总是，总是，范围所有变量。不管多么琐碎。甚至查询名称和循环索引之类的东西。从痛苦中拯救你自己，以及那些在你身后的人。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-15T17:52:33.993

特别是在 CFC 中，适当的范围界定很重要。额外的“冗长”值得清晰。让变量滑出它们的预定范围会导致严重的问题并且很难诊断。

冗长并不总是一件坏事。我们以描述性方式命名我们的函数和方法，例如 getAuthenticatedUser()，而不是 gau()。数据库列和表最好保留描述性，如 EmployeePayroll 而不是 empprl。因此，当您的短期记忆中充满项目细节时，简洁可能会“更容易”，但描述性表明您的意图并且在应用程序的维护阶段很有帮助，在您的短期记忆已经充满其他东西很久之后.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-12T17:27:14.343

对您的问题的简短回答是，不，您可能不会在尝试这样做时遇到麻烦。在 UDF 的上下文之外（甚至还在 CFC 内部），一个未限定范围的 set 语句意味着变量范围。

此外，在 CFC 中，Variables 范围可用于其所有功能；它是该 CFC 中的全局范围——类似于“this”范围，除了变量范围类似于“私有”变量，而 this 范围类似于公共变量。

要对此进行测试，请创建 test.cfc：

```
<cfcomponent>
    <cfset foo = "bar" />
    <cffunction name="dumpit" output="true">
        <cfdump var="#variables#" label="cfc variables scope">
        <cfdump var="#this#" label="cfc this scope">
    </cffunction>
</cfcomponent> 
```

和一个测试它的页面，test.cfm：

```
<cfset createObject("component", "test").dumpit() /> 
```

结果将是：

![](https://i.stack.imgur.com/LSoL6.png)

* * *

现在，为了解决我在您的示例代码中看到的另一个问题......

在 CF 中，所有用户定义函数都有一个特殊的未命名范围，通常称为“var”范围。如果您在 UDF 中执行以下操作：

```
<cfset foo = "bar" /> 
```

然后你告诉 CF 将该变量放入 var 范围。

更复杂的是，当您在内联 UDF中***不***使用 var 范围时，您可能会遇到问题（变量值在您不期望的情况下发生变化） 。

因此，经验法则是始终、始终、始终、***始终***var-scope 您的函数内部变量（包括查询名称）。有一个名为[varScoper](http://varscoper.riaforge.org/)的工具可以帮助您找到需要 var-scoped 的变量。最后我检查了它并不完美，但这绝对是一个开始。

但是，在 CFC 甚至标准 CFM 页面中引用（显示/使用）没有范围的变量（显然 var 范围的变量除外，因为您无法指定要读取的范围）是一个*坏主意。*从 CF7 开始，当您在未指定范围的情况下读取变量时，按特定顺序检查了 9 个范围，首先匹配获胜。使用 CF8，该列表中可能有更多范围，我尚未检查。当你这样做时，当你期望从另一个范围获得价值时，你会冒着从另一个范围获得价值的风险。这是调试的噩梦......我向你保证。;)

所以简而言之：*暗示*一个变量的范围（在集合上）并不是一个糟糕的主意（尽管我通常会指定它）；但是*推断*变量的范围（在读取时）是自找麻烦。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-29T12:04:25.797

在变量范围内不明确地确定范围可能有效，但这不是一个好主意，老实说，唯一*不*这样做的原因是 IMO 的懒惰。如果您明确地确定所有内容的范围 1) 您可以避免潜在的问题，并且 2) 它使代码更易于阅读，因为毫无疑问事物在哪个范围内。

对我来说，它不会使代码更冗长（当然也不是不必要的冗长）——它实际上更容易阅读，避免混淆，并避免如果你没有明确范围，可能会出现奇怪的副作用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T13:44:20.890

您的问题的简单答案是：“不，没有必要”

但是，我认为最佳实践会建议您实际上在访问这些变量时使用变量标识符。在我看来，任何将来遇到您的代码并且正在查看函数中间的人都会立即知道变量的范围，而无需扫描函数顶部的局部函数。

事实上，我通过创建一个本地结构为我的 CFC UDF 添加了一些额外的详细信息：

<cfset var local = structNew() />

然后我把我所有的本地变量放在那个结构中并以这种方式引用它们，所以我的代码看起来像这样：

<cfset local.foo = variables.bar + 10 />

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-12T20:38:06.553

看完你的回答后，我的想法是：

**是的，它是安全的。一般来说，明确指定变量范围是没有必要或有用的。它只是给已经冗长的语言增加了混乱。**

[诚然，正如Soldarnal](https://stackoverflow.com/users/3420/soldarnal)指出的那样，有一个小例外，需要限定变量范围的变量。也就是说，如果您有一个同名的函数局部变量。（但你可能无论如何都不应该这样做。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T03:21:53.927

除了最佳实践之外，我相信它还可能取决于您将如何访问您的 cfc，在创建对象和从冷融合访问它们时将它们排除在外没有任何问题。但是我认为在通过 flex/flash 中的 actionscript 远程访问和/或映射它们时可能需要它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-25T02:16:37.220

这是 Raymond Camden 提供的非常好的[CFC 范围参考](http://www.coldfusionjedi.com/downloads/cfcscopes.pdf)。就个人而言，我更喜欢创建一个“自我”哈希以避免所有混淆（注意我不在函数中使用“变量”范围）：

```
<cfcomponent>
  <cfset variables.self = structNew()>
  <cfscript>
    structInsert(variables.self, <key>, <value>);
    ...
  </cfscript>

  <cffunction name="foo">
    self.<key> = <value>
    <cfreturn self.<key> />
  </cffunction>

  ... 
```

# svn - 从 VSS 迁移到 Subversion 的最佳方式？

> ID：59392
> 
> 赞同：25
> 
> 时间：2008-09-12T15:58:19.360
> 
> 标签：svn, version-control, visual-sourcesafe

我是一个单一的开发人员，希望摆脱 Visual Source Safe 并转向 svn。

快速搜索会找到几个工具，但我看不到明显的赢家，而且我不能花很多时间测试不同的工具。

有没有人成功做到这一点，并可以推荐一种方法？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-12T16:01:54.937

我建议只将您的代码添加到新的 Subversion 存储库，而不是从 VSS 导入。VSS 有一个复杂的版本控制模型，它不能很好地转化为许多其他系统，刚开始通常是避免把这些杂乱无章的最好方法。

如果您需要保留历史记录，请将您的 VSS 存储库设为只读。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-12-07T20:55:24.933

VSStoSVN 的 CodePlex 版本是我发现的最好的版本之一。我使用 PumaCode 版本的结果很糟糕，但是这个运行顺利。

[http://vss2svn.codeplex.com/](http://vss2svn.codeplex.com/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-15T14:46:36.187

我们最近在工作中进行了此迁移。我强烈建议：

1.  只需添加来自 VSS 的新代码，接受 pre-svn 历史必须保留在旧 VSS 存储库中的打击。
2.  如果在初始代码转储后您的 VSS 存储库仍在使用中，请使用[Vendor Branches](http://svnbook.red-bean.com/nightly/en/svn.advanced.vendorbr.html)迁移更改。即，假设您的 VSS 存储库是供应商并使用日期标记将更改合并到 SVN 存储库中。

[这里](https://stackoverflow.com/questions/57372/how-do-i-sync-between-vss-and-svn#63513)稍微详细一点。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-08-26T23:44:21.893

我公司开发了一个 Source Safe 到 Subversion 的迁移工具： [http ://www.abstrakti.com/Products/Krepost](http://www.abstrakti.com/Products/Krepost)

当我们不得不迁移客户的存储库时，该工具是在与其他所有工具出现问题后开发的。

如果您有任何问题，请告诉我，我很乐意为您提供帮助。

埃里克。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-29T06:04:52.357

以下工具运行良好： [http ://www.pumacode.org/projects/vss2svn/wiki/RunningTheMigration](http://www.pumacode.org/projects/vss2svn/wiki/RunningTheMigration)

清理导入的存储库需要一些工作，但如果你真的想保留你的历史记录，那可能是值得的。

编辑：pumacode.org 域消失了，代码现在托管在[https://github.com/irontoby/vss2svn](https://github.com/irontoby/vss2svn)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T00:55:48.087

在我目前的工作中，我们刚刚创建了一个 subversion 存储库，设置挂钩脚本以忽略所有 vss 和生成的文件，然后开始使用 tortoiseSVN 导入各种项目。工作得相当不错，我们在几个小时内就启动并运行了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T14:15:34.107

我完全同意 Jon Galloway 的回答。我也尝试过使用[vss2svn](http://www.pumacode.org/projects/vss2svn/wiki/RunningTheMigration)，但发现导入的存储库存在很多问题，最后认为清理它所需的努力是不值得的。我们只是将代码的副本导入到 subversion 中，并在需要查阅旧版本代码的罕见情况下返回到 VSS。

在我以前的公司中，我们也使用相同的方法从 ClearCase 迁移到 Subversion，我不记得我们曾经需要回到 ClearCase 来查看历史的任何场合。

最大的问题是让每个人同时切换到新的存储库，但作为一个开发人员，你应该没有任何问题！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T10:14:28.487

我们下载并测试了几个迁移工具，我推荐[Polarion SVNImporter](http://community.polarion.com/index.php?page=overview&project=svnimporter)。

我们使用它来进行从 VSS6 存储库到 Subversion 的几乎 Gb 的选择性迁移。由于源代码可用，我们能够对其进行修补并根据我们的特定需求进行定制（链接文件检测）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-04-14T19:46:59.777

我使用 vss2svn 取得了巨大成功。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-12T20:40:07.267

我使用了一些脚本（我不记得是哪一个）来帮助进行 VSS 到 SVN 的转换。这有点痛苦和挑剔，但最终奏效了，并保留了所有历史。当时出于政治原因，我不得不保留所有历史；如果我按照自己的方式行事，我可能会丢弃历史并将所有代码导入 SVN。

同样出于政治原因，我编写了一些非常 hacky 的脚本，这些脚本使 VSS 随着 Subversion 的更改保持更新。这些工作了一段时间，但每隔一两个星期就会中断，直到有人重命名目录或其他东西，整个事情就崩溃了。到那时，继续使用 Subversion 就可以了。

# c# - Rhino Mocks：我如何模拟一个转换其输入的方法？

> ID：59396
> 
> 赞同：2
> 
> 时间：2008-09-12T16:00:23.210
> 
> 标签：c#, .net, rhino-mocks

我有一个数据访问对象 TransactionDao。当您调用 TransactionDao.Save(transaction) 时，我希望它设置一个 transaction.IsSaved=true 标志（这是一种简化，我正在尝试做的实际事情并不是那么平庸）。因此，当使用 RhinoMocks 模拟我的 TransactionDao 时，我如何指示它应该转换其输入？

理想情况下，我想写这样的东西：

```
Expect.Call(delegate {dao.Save(transaction);}).Override(x => x.IsSaved=true); 
```

有谁知道如何做到这一点？

* * *

尽管我从下面指定的答案中得到了提示，但实际类型签名已关闭，但您必须执行以下操作：由于 Mark Ingram 发布的内容，尽管没有人明确表示，但似乎最好的答案是做这个：

```
public delegate void FakeSave(Transaction t);
...
Expect.Call(delegate {dao.Save(t); }).Do( new FakeSave(delegate(Transaction t2) { t.IsSaved = true; })); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T07:44:14.640

峡谷，

我发现适用于您的问题的最简单的解决方案如下：

```
Expect.Call(() => dao.Save(transaction))
    .Do(new Action<Transaction>(x => x.IsSaved = true)); 
```

所以你不需要创建一个特殊的委托或其他任何东西。只需使用标准 .NET 3.5 库中的 Action 即可。

希望这有帮助。弗兰蒂塞克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T16:23:44.323

您可以使用 Do 回调完成此操作：

```
Expect.Call(delegate {dao.Save(transaction);})
    .Do(x => x.IsSaved = true); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-12T16:16:41.267

如果您当然可以模拟交易，您应该模拟交易并使其返回真实的 IsSaved。

```
ITransaction transaction = _Mocker.dynamicMock<ITransaction>;
Expect.Call(transaction.IsSaved).IgnoreArguments.Return(true);
_mocker.ReplayAll();
dao.Save(transaction); 
```

# unit-testing - Pex 用户：您对 Pex 和自动探索性测试的总体印象如何？

> ID：59398
> 
> 赞同：22
> 
> 时间：2008-09-12T16:01:02.523
> 
> 标签：unit-testing, testing, automated-tests, pex

那些使用过[Pex](http://research.microsoft.com/Pex/)的人，您认为 Pex 作为工具的优点和缺点是什么？

另外，作为TDD/单元测试**的补充，**您认为“自动化探索性测试”的优缺点是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-16T23:53:55.940

Pex 让您编写*参数化*单元测试。从这个意义上说，它完全符合 TDD/单元测试流程：编写测试，让 Pex “探索”它，找到一些失败的测试，修复代码，等等。

最大的优势是您可以针对输入*类别*表达您的测试，而不仅仅是几个硬编码的值。这为编写测试提供了更多的表现力，也迫使你考虑你的代码应该完成的不变量/期望（即更难编写断言）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-12T18:11:38.230

我认为 Pex 作为一种探索性测试工具真的很有趣。在这方面，我认为它是我想交给 QA 使用的东西。

作为 TDD 工具，它需要一些工作，因为 TDD 是一项设计活动。但是，我确实喜欢 Peli 前进的方向。对于自动化辅助设计，有话要说。例如，仅仅因为 TDD 是一种设计工具，我就没有理由不能让自动化工具在我设计时指出潜在的边缘情况，对吧？从一开始就建立质量。

查看这篇文章，其中 Peli 在 TDD 风格的工作流程中使用 Pex。[http://blog.dotnetwiki.org/TDDingABinaryHeapWithPexPart1.aspx](http://blog.dotnetwiki.org/TDDingABinaryHeapWithPexPart1.aspx)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-11T23:08:05.837

如果您查找有关编写理论的文献（谷歌 David Saff）——这是一种更通用的编写单元测试的方式，并使用 Pex 作为理论探索者，我发现从我目前的经验来看，生产力发生了一步变化。我刚刚写了一篇博文，详细介绍了我在 TDD 中使用 Pex 的经历：http: [//taumuon-jabuka.blogspot.com/2009/01/theory-driven-development-using_11.html](http://taumuon-jabuka.blogspot.com/2009/01/theory-driven-development-using_11.html)

正如我所说 - 我将其视为类固醇的 TDD！它绝不会取代 TDD，而是增强活动。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-07T01:34:07.893

我真的很喜欢 Pex。它将为您从未梦想过的边缘案例提供测试，特别是如果您的团队很小并且编写方法的人与编写测试的人相同。

它还将提供您的方法将遵守的合同义务。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-07-23T16:30:16.400

测试优先的开发使您可以构建代码以实现可测试性。在这方面，Pex 通过您的代码找到巧妙而笨拙的路径，帮助超越简单的覆盖率指标。

Pex with Moles 的主要优点是在进行 Brownfield 开发时能够跟踪副作用：运行 Pex 一次并保存输出，然后应用代码更改，然后再次运行 Pex 以查看损坏的地方。

# vb.net - 在 Visual Studio 2008 中清理 Designer.vb 文件

> ID：59418
> 
> 赞同：2
> 
> 时间：2008-09-12T16:15:27.510
> 
> 标签：vb.net, visual-studio-2008

我注意到我的其中一个表单的 Designer.vb 文件有**很多**控件，这些控件甚至在我的表单上都没有使用或可见。这可能是从我的其他表单中复制控件。有没有办法清理 Designer.vb 文件并摆脱所有未使用的控件？

**更新：这是针对 Windows 窗体项目的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-12T16:26:26.720

我看到的唯一真正的解决方案是通过在设计器中选择它们来将所有控件复制到一个新表单中。这样，所有未创建的控件都不应跟随您进入下一个表单。

# c# - 是 C# 中的 bool 读/写原子

> ID：59422
> 
> 赞同：91
> 
> 时间：2008-09-12T16:19:28.657
> 
> 标签：c#, .net, concurrency, locking, boolean

在 C# 中访问**bool**字段是原子的吗？特别是，我是否需要锁定：

```
class Foo
{
   private bool _bar;

   //... in some function on any thread (or many threads)
   _bar = true;

   //... same for a read
   if (_bar) { ... }
} 
```

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2008-09-12T16:24:02.717

**是的。**

> 以下数据类型的读写是原子的：bool、char、byte、sbyte、short、ushort、uint、int、float 和引用类型。

在[C# Language Spec](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/variables#atomicity-of-variable-references)中找到。

[**编辑：理解volatile**](https://msdn.microsoft.com/en-us/library/x13ttww7(v=vs.140).aspx)关键字可能也值得。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-09-19T23:07:13.070

如上所述，`bool`它是原子的，但您仍然需要记住，它还取决于您想用它做什么。

```
if(b == false)
{
    //do something
} 
```

不是原子操作，这意味着`b`在当前线程执行`if`语句之后的代码之前， 的值可能会发生变化。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-09-12T16:53:24.033

bool 访问确实是原子的，但这还不是全部。

您不必担心读取“未完全写入”的值-在任何情况下都不清楚这可能对 bool 意味着什么-但您确实必须担心处理器缓存，至少如果详细信息时机是一个问题。如果在核心 A 上运行的线程 #1 有您的`_bar`in 缓存，`_bar`并由运行在另一个核心上的线程 #2 更新，则线程 #1 不会立即看到更改，除非您添加锁定、声明`_bar`为`volatile`或显式插入调用以`Thread.MemoryBarrier()`使缓存值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-21T07:52:13.453

我使用的方法，我认为是正确的，是

```
volatile bool b = false;

.. rarely signal an update with a large state change...

lock b_lock
{
  b = true;
  //other;
}

... another thread ...

if(b)
{
    lock b_lock
    {
       if(b)
       {
           //other stuff
           b = false;
       }
     }
} 
```

目标基本上是避免在每次迭代中重复锁定一个对象，只是为了检查我们是否需要锁定它以提供大量很少发生的状态更改信息。我*认为*这种方法有效。如果需要绝对一致性，我*认为*volatile 在 b 布尔值上是合适的。

# css - 每个链接旁边都有一个链接图标。如何从图像中排除链接图标？

> ID：59423
> 
> 赞同：1
> 
> 时间：2008-09-12T16:20:09.620
> 
> 标签：css

我的 .css 文件中有以下内容，在我网站上的每个链接旁边创建了一个小图像：

```
div.post .text a[href^="http:"]
{
    background: url(../../pics/remote.gif) right top no-repeat;
    padding-right: 10px;
    white-space: nowrap;
} 
```

如何修改此片段（或添加新内容）以排除本身是链接的图像旁边的链接图标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-12T16:56:38.440

如果您设置了背景颜色并且在图像上有一个负的右边距，则图像将覆盖外部链接图像。

例子：

```
a[href^="http:"] {
  background: url(http://en.wikipedia.org/skins-1.5/monobook/external.png) right center no-repeat;
  padding-right: 14px;
  white-space: nowrap;
}
a[href^="http:"] img {
  margin-right: -14px;
  border: medium none;
  background-color: red;
}
```

```
<a href="http://www.google.ca">Google</a>
<br/>
<a href="http://www.google.ca">
  <img src="http://upload.wikimedia.org/wikipedia/en/thumb/4/4a/Commons-logo.svg/50px-Commons-logo.svg.png" />
</a>
```

编辑：如果你有一个带图案的背景，这对于具有透明度的图像来说看起来不太好。此外，您的`href^=`选择器不适用于 IE7，但您可能已经知道

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T16:30:41.937

`<a>`向这些标签添加一个类然后添加另一个声明以删除背景可能是值得的：

```
div.post .text a.noimage{
   background:none;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T16:31:56.270

如果您将链接的内容作为一个跨度，您可以这样做，否则我认为您需要为一个场景提供一个类来区分它。

```
a > span {
  background: url(../../pics/remote.gif) right top no-repeat;
  padding-right: 10px;
  white-space: nowrap;
}
a > img {
  /* any specific styling for images wrapped in a link (e.g. polaroid like) */
  border: 1px solid #cccccc;
  padding: 4px 4px 25px 4px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T16:40:38.480

`a`您需要在要包含或排除的元素上使用类名。如果您不想在服务器端代码或文档中执行此操作，则可以在加载页面时使用 javascript 添加类。选择逻辑包含在其他地方，您的规则可能只是：

```
a.external_link
{
    background: url(../../pics/remote.gif) right top no-repeat;
    padding-right: 10px;
    white-space: nowrap;
} 
```

使用 XPath 可以创建像您这样的模式，该模式也将排除`a`具有`img`子元素的元素，但是该功能已多次（[2002 年](http://lists.w3.org/Archives/Public/www-style/2002May/0011.html)、[2006 年](http://lists.w3.org/Archives/Public/www-style/2006Oct/0009.html)、[2007 年](http://lists.w3.org/Archives/Public/www-style/2007Apr/0105.html)）针对 CSS 提出并拒绝，主要是因为它与增量布局背道而驰原则。

因此，虽然可以像使用上下文选择器和`href`属性前缀匹配一样进行简洁的条件内容添加，但 CSS 比通用编程语言弱得多。要执行更复杂的事情，您需要将逻辑上移一层，并写出更简单的指令供样式引擎处理。

# asp.net - 在 ASP.NET 中创建一个适用于 Blackberry、Windows Mobile 和 iPhone 的迷你站点

> ID：59424
> 
> 赞同：14
> 
> 时间：2008-09-12T16:20:24.130
> 
> 标签：asp.net, windows-mobile, mobile

我正在开发一个针对桌面浏览器的 ASP.NET 网站。我们希望启用一个可选的移动视图（例如[http://m.sample.com](http://m.sample.com)），它将提供一些主要是文本的简单页面。不需要 AJAX 甚至 Javascript，也不需要用户输入——它实际上只是带有几个链接的文本表格，用于在页面之间导航。

设置它以使其适用于 Blackberry、Windows Mobile 和 iPhone 的最佳方法是什么？

我应该查看[ASP.NET Mobile](http://www.asp.net/mobile/)支持，还是只是滚动我自己的页面？

**更新**：这是为 m.microsoftpdc.com 准备的。我们采用 /Mobile 子文件夹方法，并使用[Scott Hanselman 的 iPhone 技巧来处理视口和其他内容](http://www.hanselman.com/blog/MakeYourWebsiteMobileAndIPhoneFriendlyAddHomeScreenIPhoneIconsAndAdjustTheViewPort.aspx)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-12T16:36:59.690

我过去曾这样做过，我这样做的方式是通过为桌面创建目录并为移动设备创建目录来分离页面。这使您可以更好地分离视图，因为实际上它们有很大不同。在 ASP.NET Forms 中，我经常使用[Model View Presenter](http://msdn.microsoft.com/en-us/magazine/cc188690.aspx)模式，因为它与 ASP.NET Forms 发挥最佳功能的方式相得益彰。这样我就可以在两个视图之间重用一些代码。然后在站点的 index.aspx 页面中，您只需解析请求的用户代理字符串以找出浏览器并相应地重定向。因此，例如一个拥有 iphone 的人来到您的网站，您解析[用户代理字符串](http://developer.apple.com/documentation/AppleApplications/Reference/SafariWebContent/OptimizingforSafarioniPhone/chapter_3_section_3.html)并弄清楚它是一部iphone。然后您重定向到指向 Mobile/Index.aspx 页面的 m.sample.com。否则，您将重定向到 Desktop/Index.aspx。

我在页面级别解析了用户代理字符串，当然你也可以在 HttpModule 或 HttpHandler 级别执行这种逻辑。

## 编辑

我只是推出了自己的页面，因为我们的目标不是支持 WML 的手机。在我看来，这将是使用 ASP.NET Mobile 支持的唯一原因，如果您还想支持启用 WML 的手机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T17:46:57.967

您只确定了 3 个手机“平台”作为您的目标。需要考虑的一件事是，那里有更多非黑莓/Windows Mobile/iPhone 手机，也许它们将成为您的大多数观众。（？）

从您描述您的应用程序的方式（仅文本）来看，您应该可以使用几乎所有支持 Internet 的手机，这几乎是过去八年销售的所有手机。

滚动您自己的可能会让您更好地控制内容的显示和导航方式，您的用户会喜欢的，但是您将失去像 ASP.NET Mobile 这样的东西可能为您提供的大部分自动格式化和高级交互功能。鉴于您预计您的用户社区在未来 2 年内将采用这种方式，您可能需要考虑这种权衡。

他们是否有可能在移动端要求更多的桌面功能？如果它可能是“是”（当我想到您所针对的 3 个平台时更是如此），那么我会推荐一些自动格式化/启用工具，如 ASP.NET 移动。如果没有，请自行开发并让访问者简单易用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T16:24:58.313

我从个人经验中知道，你真的不需要为 iPhone 做太多事情。我通常宁愿用我的 iPhone 浏览您的常规网站。

只是我的两分钱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T16:26:16.283

基于用户代理的不同样式表将处理“漂亮”。您在使用母版页吗？您还可以使用设备过滤器根据设备设置不同的主设备。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T12:09:50.180

在今年（2009 年）的 Mix上， [mdbf](http://mdbf.codeplex.com/)被宣布。有关使用它来根据需要识别和重定向移动浏览器的示例，请参阅[此视频](http://videos.visitmix.com/MIX09/T20F)或[Scott Hanselman 的此博客文章。](http://www.hanselman.com/blog/MixMobileWebSitesWithASPNETMVCAndTheMobileBrowserDefinitionFile.aspx)

# sql - 如何查找过去 24 小时内添加到我的数据库表中的记录？

> ID：59425
> 
> 赞同：4
> 
> 时间：2008-09-12T16:21:06.810
> 
> 标签：sql

我特别使用 MySQL，但我希望有一个跨供应商的解决方案。我正在使用 NOW() 函数将时间戳添加为每条记录的列。

```
INSERT INTO messages 
(typeId, messageTime, stationId, message) 
VALUES 
(?, NOW(), ?, ?) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-12T16:25:41.090

```
SELECT * FROM messages WHERE DATE_SUB(CURDATE(),INTERVAL 1 DAY) <= messageTime 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-12T16:29:10.707

SQL Server 查询是：

```
Select *
From Messages
Where MessageTime > DateAdd(dd, -1, GetDate()) 
```

据我所知（未经测试！）MySQL 等价物是

```
Select *
From Messages
Where MessageTime > ADDDATE(NOW(), INTERVAL -1 DAY) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T16:41:06.793

对于 Sybase SQL Anywhere：

```
Select * From Messages Where MessageTime > dateadd( day, -1, now() ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-12T16:54:52.113

对于甲骨文

```
SELECT * FROM messages WHERE messageTime > SYSDATE - 1 
```

（伪变量 SYSDATE 包括时间，因此 sysdate -1 将为您提供最后 24 小时）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T16:35:51.220

没有跨数据库解决方案，因为它们中的大多数都有自己的日期处理（主要是区间表示）语法和语义。

在`PostgreSQL`这将是

```
SELECT * FROM messages WHERE messagetime >= messagetime - interval '1 day' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-12T17:08:29.100

如果您从基于 API 的客户端访问它（我猜是因为查询中的“？”），您可以从您的程序而不是通过 SQL 执行此操作。

注意：其余为 JDBC 语法，其他 API/语言将有不同的语法，但在概念上应该相同。

在插入侧做

```
PreparedStatement stmt = connection.prepareStatement( 
    "INSERT INTO messages " +
    "(typeId, messageTime, stationId, message) VALUES " +
    "(?, ?, ?, ?)" );
stmt.setInt(1, typeId);
stmt.setDate(2, new java.sql.Date(System.currentTimeMillis()));
stmt.setInt(3, stationId);
stmt.setString(4, message); 
```

在查询方面做：

```
PrepatedStatement stmt = connection.prepareStatement(
   "SELECT typeId, messageTime, stationId, message " +
   "from messages where messageTime < ?");
long yesterday = System.currentTimeMillis() - 86400000; // 86400 sec/day
stmt.setDate(1,new java.sql.Date(yesterday)); 
```

这应该以便携的方式工作。

# ide - 将哪个环境、IDE 或解释器付诸实践方案？

> ID：59428
> 
> 赞同：19
> 
> 时间：2008-09-12T16:23:12.517
> 
> 标签：ide, scheme, lisp, the-little-schemer

我一直在通过*The Little Schemer*，我想知道最好使用哪种环境、IDE 或解释器来测试我为自己记下的任何 Scheme 代码。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-12T16:25:23.197

[Racket](http://racket-lang.org/)（[以前的 Scheme 博士](http://racket-lang.org/new-name.html)）有一个不错的编辑器、几种不同的 Scheme 方言、可视化调试的尝试、大量的库，并且可以在大多数平台上运行。它甚至有一些专门针对学习语言的模式。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-16T20:02:16.917

我强烈推荐[Chicken](http://www.call-with-current-continuation.org/)和[Gauche](http://practical-scheme.net/gauche/)的方案。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-15T16:02:20.373

[PLT Scheme](http://plt-scheme.org/) (DrScheme) 是目前最好的 IDE 之一，尤其是对于 Scheme。下载时获得的包包含开发 Scheme 代码所需的所有内容 - 库、文档、示例等。强烈推荐。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-16T07:09:16.930

如果您只想测试您的方案代码，我会推荐[PLT Scheme](http://plt-scheme.org/)。它提供了一个非常完整的环境，带有调试器、帮助等，并且可以在大多数平台上运行。

但是，如果您还想了解幕后解释器的工作原理并拥有 Visual Studio，我建议您使用[Tachy](http://www.kenrawlings.com/pages/Tachy)。它是一个用 c# 编写的非常轻量级的方案解释器。它允许您仅调试您的方案代码，或者还可以在幕后单步调试 c# 解释器以查看发生了什么。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-24T07:27:42.067

只是为了记录，我不得不提到 [IronScheme](http://www.codeplex.com/IronScheme)。

> IronScheme 的目标是成为基于 Microsoft DLR 的符合 R6RS 的 Scheme 实现。

版本 1.0 Beta 1 刚刚发布。我认为这对于已经在使用 .NET 框架的人来说应该是一个很好的实现。

**编辑**
当前版本是2009 年 10 月 23 日的**1.0 RC 1**

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-17T05:18:45.177

谷歌搜索该书的作者（丹尼尔弗里德曼和马蒂亚斯费莱森）。查看它们中的任何一个是否涉及流行的、免费的、现有的 Scheme 实现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T10:21:18.840

没关系，只要您订阅相关社区的邮件列表（wiki/irc/online-community-site）即可。可能值得查看列表描述和档案，以确保您是正确的。

其中大多数对新来者都很友好和欢迎，所以不要害怕问。

当您有问题时，也值得搜索他们的邮件列表（或常见问题解答或他们使用的任何东西）的档案 - 以防万一这是一个常见问题。

祝你好运！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-21T14:14:17.943

在[Emacs中的](http://www.gnu.org/software/emacs/)[Geiser](http://nongnu.org/geiser/)下运行的[Guile](http://www.gnu.org/software/guile/)提供了一个很好的、轻量级的实现来进行练习。[Racket](http://racket-lang.org/)也可以在[Geiser](http://nongnu.org/geiser/geiser_2.html#Installation)和 Emacs 下运行，尽管我个人更喜欢[Guile](http://www.gnu.org/software/guile/)和[Chez Scheme](https://github.com/cisco/ChezScheme)。

显然，每个安装都取决于您的操作系统。我建议使用[Emacs 版本 24](http://www.gnu.org/software/emacs/)及更高版本，因为这允许您使用[Melpa](http://melpa.org/#/getting-started)或[Marmalade](https://marmalade-repo.org/)来安装 Geiser 和其他 Emacs 扩展。

当前[版本的 Geiser](http://www.nongnu.org/geiser/geiser_2.html)还可以很好地与[Chicken Scheme](http://www.call-cc.org/)、[Chez Scheme](https://github.com/cisco/ChezScheme)、[MIT Scheme](https://www.gnu.org/software/mit-scheme/)和[Chibi Scheme](https://github.com/ashinn/chibi-scheme)配合使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T06:37:52.560

LispMe 在 Palm Pilot 上工作，可以随身携带，随时随地进行计划。学习计划的好方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-16T19:54:48.387

我已经使用了其他一些帖子中提到的 PLT，它工作得很好。我读过但没有使用过的一个是[Allegro Common LISP Express](http://www.franz.com/downloads/allegrodownload.lhtml)。我阅读了一篇关于他们名为 Allegro Cache 的数据库应用程序的出色评论，发现他们对 LISP 很感兴趣。就像我说的，我不知道它是否有任何好处，但它可能值得一试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-09-16T11:31:02.167

我目前也在通过 Little Schemer 工作，并使用[Emacs](http://www.gnu.org/software/emacs/)作为我的环境，以及[Quack](http://www.neilvandyke.org/quack/)，它为 Emacs 中的方案模式添加了额外的支持和实用程序。

如果您计划尝试使用其他 Lisp（例如 Common Lisp），那么 Emacs 也对这些方言提供了出色的支持（Emacs 本身可以使用自己的 Lisp 方言进行定制，适当地命名为 Emacs Lisp）。

就 Scheme 实现而言，我目前使用的是[Petit Chez Scheme](http://www.scheme.com/petitechezscheme.html)，它是 Chez Scheme 的一个解释的、可免费分发的版本（它使用编译器并且需要花钱才能获得许可证）。

# multilingual - 支持多个使用不同语言编写的相同类型的应用程序是否可行？

> ID：59436
> 
> 赞同：1
> 
> 时间：2008-09-12T16:25:34.600
> 
> 标签：multilingual

正如我们都想说的那样，与语言无关对程序员来说是一个好处，但支持多个相同类型的企业 Web 应用程序都用不同的语言编写真的可行吗？想想一个 CMS 或电子商务系统有多么复杂——现在想象一下支持三个不同的 CMS 平台，这些平台都是用不同的语言编写的。我不想被称为 .NET 或 Java 或 PHP 商店，但我也不想成为声称他们可以支持他们从未使用过的解决方案的供应商，这让客户感到不安，他们想知道为什么我们不能准时把事情做好。任何人都可以从经验中谈谈这件事吗？您的公司是否通常只是接受它，并尝试在飞行中学习一个新平台？您是按时计费，还是吃掉这些费用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-12T16:31:17.957

我认为这完全取决于您的客户是谁以及他们的期望。我认为了解不同的技术是件好事，但实际上，当你被某人雇用时，他们希望你知道自己在做什么。就个人而言，我更希望人们知道我在某种技术方面做得非常好，并且当被雇用时，我能很好地完成工作。

如果你不考虑你的核心能力是什么而试图去追求每一份合同，你就不会成功。你会激怒那些雇用你并犯错误的人，你可能会错过真正闪耀的机会。有时您必须做出妥协才能支付账单，但如果您不小心，最终可能会咬到您。

与我合作过的大型咨询公司会为此投入资源，并希望它们不会激怒太多人。他们这样做主要是因为他们知道那些与顾问一起工作并在他们没有完成工作时生气的人并不是决定让他们继续被雇用的人。对他们（不是我认识的所有人，但肯定有一些），不要在意他们是否搞砸了，因为他们最终知道他们可以说服副总裁和高级副总裁留下他们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T16:39:37.140

老实说，我认为随着时间的推移，你会看到这种事情发生，无论组织多么自律。新方法以新库、框架甚至语言的形式捆绑在一起是很自然的。请记住，.NET 商店很可能曾经是 ASP/VB 商店。他们可能仍会为客户维护旧系统，因为从头开始重写所有内容几乎没有什么好处。

我不确定是否有人可以奢侈地保持一切“相同”，因为与库或框架问题相比，语言问题是次要的——尤其是那些你自己构建的问题。

# sql-server - 如何使用 TSQL 检查数据库的 SQL Server 版本？

> ID：59444
> 
> 赞同：128
> 
> 时间：2008-09-12T16:29:19.507
> 
> 标签：sql-server, database, tsql

是否有系统存储过程来获取版本号？

* * *

## 回答 #1

> 赞同：237
> 
> 时间：2008-09-12T16:33:27.890

尝试

```
SELECT @@VERSION 
```

或者对于 SQL Server 2000 及更高版本，以下更容易解析:)

```
SELECT SERVERPROPERTY('productversion')
     , SERVERPROPERTY('productlevel')
     , SERVERPROPERTY('edition') 
```

来自： http: [//support.microsoft.com/kb/321185](http://support.microsoft.com/kb/321185)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-09-12T16:30:50.970

选择@@版本

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-01-18T00:39:01.233

我知道这是一篇较旧的帖子，但我更新了[Matt Rogish](https://stackoverflow.com/users/2590/matt-rogish)发布的[答案](https://stackoverflow.com/a/59450/15168)中提到的[链接](http://blog.devstone.com/aaron/default,date,2006-12-15.aspx)中的代码（截至 2013 年 12 月 3 日已失效） ：

```
DECLARE @ver nvarchar(128)
SET @ver = CAST(serverproperty('ProductVersion') AS nvarchar)
SET @ver = SUBSTRING(@ver, 1, CHARINDEX('.', @ver) - 1)

IF ( @ver = '7' )
   SELECT 'SQL Server 7'
ELSE IF ( @ver = '8' )
   SELECT 'SQL Server 2000'
ELSE IF ( @ver = '9' )
   SELECT 'SQL Server 2005'
ELSE IF ( @ver = '10' )
   SELECT 'SQL Server 2008/2008 R2'
ELSE IF ( @ver = '11' )
   SELECT 'SQL Server 2012'
ELSE IF ( @ver = '12' )
   SELECT 'SQL Server 2014'
ELSE IF ( @ver = '13' )
   SELECT 'SQL Server 2016'
ELSE IF ( @ver = '14' )
   SELECT 'SQL Server 2017'
ELSE
   SELECT 'Unsupported SQL Server Version' 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-06-23T13:31:24.927

对于 SQL Server 2000 及更高版本，我更喜欢对 Joe 的回答进行以下解析：

```
declare @sqlVers numeric(4,2)
select @sqlVers = left(cast(serverproperty('productversion') as varchar), 4) 
```

给出如下结果：

```
结果服务器版本
8.00 SQL 2000
9.00 SQL 2005
10.00 SQL 2008
10.50 SQL 2008R2
11.00 SQL 2012
12.00 SQL 2014

```

[此处](http://sqlserverbuilds.blogspot.com/)为版本号的基本列表，或[此处](https://support.microsoft.com/en-us/kb/321185?wa=wsignin1.0)为 Microsoft 的详尽列表。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-08-07T17:27:33.743

还有另一个扩展存储过程可用于查看版本信息：

```
exec [master].sys.[xp_msver] 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-11-08T15:02:07.000

```
CREATE FUNCTION dbo.UFN_GET_SQL_SEVER_VERSION 
(
)
RETURNS sysname
AS
BEGIN
    DECLARE @ServerVersion sysname, @ProductVersion sysname, @ProductLevel sysname, @Edition sysname;

    SELECT @ProductVersion = CONVERT(sysname, SERVERPROPERTY('ProductVersion')), 
           @ProductLevel = CONVERT(sysname, SERVERPROPERTY('ProductLevel')),
           @Edition = CONVERT(sysname, SERVERPROPERTY ('Edition'));
    --see: http://support2.microsoft.com/kb/321185
    SELECT @ServerVersion = 
        CASE 
            WHEN @ProductVersion LIKE '8.00.%' THEN 'Microsoft SQL Server 2000'
            WHEN @ProductVersion LIKE '9.00.%' THEN 'Microsoft SQL Server 2005'
            WHEN @ProductVersion LIKE '10.00.%' THEN 'Microsoft SQL Server 2008'
            WHEN @ProductVersion LIKE '10.50.%' THEN 'Microsoft SQL Server 2008 R2'
            WHEN @ProductVersion LIKE '11.0%' THEN 'Microsoft SQL Server 2012'
            WHEN @ProductVersion LIKE '12.0%' THEN 'Microsoft SQL Server 2014'
        END

    RETURN @ServerVersion + N' ('+@ProductLevel + N'), ' + @Edition + ' - ' + @ProductVersion;

END
GO 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-04T09:59:29.417

这是我用来测试服务器是否为 2005 或更高版本的一些脚本

```
declare @isSqlServer2005 bit
select @isSqlServer2005 = case when CONVERT(int, SUBSTRING(CONVERT(varchar(15), SERVERPROPERTY('productversion')), 0, CHARINDEX('.', CONVERT(varchar(15), SERVERPROPERTY('productversion'))))) < 9 then 0 else 1 end
select @isSqlServer2005 
```

注意：从原始答案更新（见评论）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-13T08:00:59.860

[Joe 帖子](https://stackoverflow.com/questions/59444/how-do-you-check-what-version-of-sql-server-for-a-database-using-tsql#59457)中链接的知识库文章非常适合确定已为任何版本安装了哪些服务包。同样，[这篇知识库文章](http://support.microsoft.com/kb/937137)将版本号映射到特定的修补程序和累积更新，但它仅适用于 SQL05 SP2 及更高版本。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-05T11:05:52.297

试试这个：

```
if (SELECT LEFT(CAST(SERVERPROPERTY('productversion') as varchar), 2)) = '10'
BEGIN 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-05-15T17:21:13.387

```
SELECT 
@@SERVERNAME AS ServerName,
CASE WHEN LEFT(CAST(serverproperty('productversion') as char), 1) = 9 THEN '2005'
 WHEN LEFT(CAST(serverproperty('productversion') as char), 2) = 10 THEN '2008'
 WHEN LEFT(CAST(serverproperty('productversion') as char), 2) = 11 THEN '2012'
END AS MajorVersion,
SERVERPROPERTY ('productlevel') AS MinorVersion, 
SERVERPROPERTY('productversion') AS FullVersion, 
SERVERPROPERTY ('edition') AS Edition 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-04-30T10:32:43.897

在一次选择中仅获取主要的 SQL Server 版本：

```
SELECT  SUBSTRING(ver, 1, CHARINDEX('.', ver) - 1)
FROM (SELECT CAST(serverproperty('ProductVersion') AS nvarchar) ver) as t 
```

返回`8`SQL 2000、`9`SQL 2005 等（测试到 2012 年）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-05-03T18:13:18.213

尝试

```
SELECT @@MICROSOFTVERSION / 0x01000000 AS MajorVersionNumber 
```

有关更多信息，请参阅：[查询版本/版本信息](https://social.technet.microsoft.com/wiki/contents/articles/783.sql-server-versions.aspx)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-03-27T12:23:12.803

```
select substring(@@version,0,charindex(convert(varchar,SERVERPROPERTY('productversion')) ,@@version)+len(convert(varchar,SERVERPROPERTY('productversion')))) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-10-21T13:12:39.840

如果出于 T-SQL 的原因您只需要主要版本，以下为您提供 2000 年或更高版本的 SQL Server 版本的年份。

`SELECT left(ltrim(replace(@@Version,'Microsoft SQL Server','')),4)`

此代码优雅地处理各种 SQL Server 版本的额外空格和制表符。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-02-17T07:26:51.623

试试这个：

```
SELECT @@VERSION[server], SERVERPROPERTY('productversion'), SERVERPROPERTY ('productlevel'), SERVERPROPERTY ('edition') 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2016-03-04T02:46:41.460

试试这个：

```
SELECT
    'the sqlserver is ' + substring(@@VERSION, 21, 5) AS [sql version] 
```

# silverlight - 在代码中创建 Silverlight DataTemplate

> ID：59451
> 
> 赞同：28
> 
> 时间：2008-09-12T16:31:06.130
> 
> 标签：silverlight

如何在代码中创建 silverlight 数据模板？我已经看到了很多 WPF 的示例，但没有看到 Silverlight 的示例。

编辑：这是我现在使用的代码，基于下面圣地亚哥的回答。

```
public DataTemplate Create(Type type)
{
  return (DataTemplate)XamlReader.Load(
          @"<DataTemplate
            xmlns=""http://schemas.microsoft.com/client/2007"">
            <" + type.Name + @" Text=""{Binding " + ShowColumn + @"}""/>
            </DataTemplate>"
   );
} 
```

这非常有效，并且允许我动态更改绑定。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-16T13:28:40.483

虽然您无法以编程方式创建它，但您可以使用如下代码从 XAML 字符串加载它：

```
 public static DataTemplate Create(Type type)
    {
        return (DataTemplate) XamlReader.Load(
            @"<DataTemplate
                xmlns=""http://schemas.microsoft.com/client/2007"">
                <" + type.Name + @"/>
              </DataTemplate>"
          );
    } 
```

上面的代码片段创建了一个包含单个控件的数据模板，该控件可能是包含您需要的内容的用户控件。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-10T13:38:31.160

这段代码我遇到了一些问题，得到了 element not foung 异常。仅供参考，我需要将我的命名空间包含在 DataTemplate 中......

```
private DataTemplate Create(Type type)
        {
            string xaml = @"<DataTemplate 
                xmlns=""http://schemas.microsoft.com/client/2007""
                xmlns:controls=""clr-namespace:" + type.Namespace + @";assembly=" + type.Namespace + @""">
                <controls:" + type.Name + @"/></DataTemplate>";
            return (DataTemplate)XamlReader.Load(xaml);
        } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-08-18T01:58:16.423

是的，Silverligt 4 早于 WPF 的当前版本。当您将模板添加为资源时，即像我一样，我在 ResourceDictionary 之间的 Application.xaml MergedResources 中添加了一个 userControl 模板。在 XAML 中，如果标签实现了 IDictionary，您可以使用 x:Key 属性。像那样

```
 <ResourceDictionary>
    <DataTemplate x:Key="TextBoxEditTemplate">
    <Some user control x:Name="myOwnControl" />
    </DataTemplate>
   </ResourceDictionary> 
```

行！您可以通过对**Application.Current.resources["TextBoxEditTemplate"]** 进行编码来访问您的模板，另一方面，某些查找此模板成员的方法将不起作用。除了这个 DataTemplate 没有实现 IDictionary，所以你不能为这个 dataTemplate 中的项目分配 x:Key 属性。作为示例中的 myOwnControl。

如果没有 xaml，当前的 silverlight 对创建完全动态的代码隐藏 DataTemplates 有一些限制。即使它适用于 WPF。

无论如何，此时最好的解决方案是为数据模板创建 XAML 脚本，您可以在 DataTemplate 脚本中添加一些值元素。我们创建了自己的用户控件，它具有一些具有 DependencyObjectProperty 的属性...

最后，如果您的对象没有继承，即不是 MyControl:UserControl，您可以通过这种方式继承***MyObject:DependencyObject***，您可以通过调用 Application.Current.Resources.FirstChilderen... 来访问您的对象。

FindName 仅适用于 WPF

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T13:28:04.330

[来自 MSDN 的引用](http://msdn.microsoft.com/en-us/library/system.windows.datatemplate%28v=vs.95%29.aspx)：

> 定义用于创建数据模板的内容的 XAML 用法不作为可设置属性公开。它是 DataTemplate 对象元素的 XAML 处理中内置的特殊行为。

# wpf - 如何使用加速器在 WPF 中制作自定义 MenuHeaders？

> ID：59456
> 
> 赞同：4
> 
> 时间：2008-09-12T16:32:28.577
> 
> 标签：wpf, xaml, templates, styles, menu

我想在 WPF 中制作一些自定义 MenuHeaders，这样我就可以（例如）在菜单项中拥有一个图标和文本。

通常使用 MenuItems，如果您使用纯文本填充 Header 字段，则可以使用下划线添加加速键。例如，_File

但是，如果我想放入一个 UserControl，我相信这个功能会中断，我将如何做类似以下的事情？

```
<Menu>
<MenuItem>
    <MenuItem.Header>
    <UserControl>
        <Image Source="..." />
        <Label Text="_Open" />
    </UserControl>
    </MenuItem.Header>
</MenuItem>
... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-13T06:34:48.413

我认为 Icon 属性符合您的需求。
但是，要回答最初的问题，可以在编写菜单项的内容时保留加速器功能。**如果您在 MenuItem 中有嵌套内容，则需要明确定义 AccessText 属性**，如下面的第一个。当您使用内联表单时，这会自动得到处理。

```
 <Menu> 
   <MenuItem>
      <MenuItem.Header>
        <StackPanel Orientation="Horizontal">
          <Image Source="Images/Open.ico" />      
          <AccessText>_Open..</AccessText>
        </StackPanel>
      </MenuItem.Header>
    </MenuItem>
    <MenuItem Header="_Close" />
   </Menu> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-12T18:30:17.453

问题是您将图像放在 MenuHeader 的内容中，这意味着您将丢失加速键。如果您只是想在菜单标题中添加图像，请执行以下操作。

```
<MenuItem Header="_Open">
  <MenuItem.Icon>
    <Image Source="images/Open.png"/>
  </MenuItem.Icon>
</MenuItem> 
```

如果您想进一步自定义外观，请修改菜单的控件[模板](http://msdn.microsoft.com/en-us/library/ms747082(VS.85).aspx)和样式。根据经验，设置菜单和菜单项的样式要比设置其他 WPF 控件的样式困难得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-10T09:26:27.567

首先想到，您会认为 Icon 属性只能包含图像。但它实际上可以包含任何东西！当我以编程方式尝试将 Image 属性直接设置为带有图像路径的字符串时，我偶然发现了这一点。结果是它没有显示图像，而是路径的实际文本！然后我发现我必须先创建一个 Image 元素并将其设置为 Icon 属性。这使我认为 Image 属性只是位于菜单左侧图标区域中的任何内容容器，我是对的。我试着在那里放一个按钮，它起作用了！

这在菜单项的图标区域中显示了一个带有文本“i”的按钮。单击按钮时，会触发 Button_Click 事件（单击按钮时不会触发 LanguageMenu_Click）。

```
<MenuItem Name="LanguageMenu" Header="_Language" Click="LanguageMenu_Click">
  <MenuItem.Icon>
    <Button Click="Button_Click">i</Button>
  </MenuItem.Icon>
</MenuItem> 
```

这导致了一种替代方法，不必为图标制作图像，而是使用带有符号字体的文本来显示简单的“图标”。以下示例使用包含软盘符号的 Wingdings 字体。字体中的这个符号映射到 charachter `<`，它在 XAML 中具有特殊含义，因此我们必须使用编码版本`&lt;`来代替。这就像做梦一样！下面将软盘符号显示为菜单项上的图标：

```
<MenuItem Name="mnuFileSave" Header="Save" Command="ApplicationCommands.Save">
  <MenuItem.Icon>
    <Label VerticalAlignment="Center" HorizontalAlignment="Center" 
           FontFamily="Wingdings">&lt;</Label>
  </MenuItem.Icon>                
</MenuItem> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-13T06:15:43.247

@a7an：啊，我之前没有注意到 Icon 属性。这是一个好的开始。

但是，特别是我想在一些 MenuItems 中添加一个额外的“按钮”，这样我就可以拥有一个“Pin”功能（有关该功能的想法，请参阅 Office 2007 中最近加载的文档列表）。

由于还需要代码，我可能需要对控件进行子类化并为按钮添加代码吗？（不怕弄乱 MenuItem 模板，已经必须做一次，如果必须，我会再做一次！;)）

# google-analytics - 为什么 Google Analytics 跟踪代码中的所有方法都以下划线开头？

> ID：59462
> 
> 赞同：2
> 
> 时间：2008-09-12T16:37:00.237
> 
> 标签：google-analytics

使用下划线作为变量和方法名称的前缀是将事物标记为私有的常用约定。为什么 Google Analytics 跟踪代码 ( `ga.js`) 中页面跟踪器类上的所有方法都以下划线开头，即使是明显公开的方法，例如`_getTracker`and `_trackPageView`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-12T19:05:42.203

因为 Google 不愿意遵循[模块模式](http://yuiblog.com/blog/2007/06/12/module-pattern/)，因此他们不希望在全局命名空间中发生意外冲突？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T16:37:53.963

以防万一您在自己的代码或类似代码中有 getTracker() 函数。

换句话说，可能是为了避免与页面的 javascript 代码发生命名冲突。

@Theo：没有意识到（即，没有仔细阅读）它们是方法。那么也许是为了鼓励谨慎或不鼓励使用？不知道，真的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T17:01:19.257

我一直是这样读的：

如果属性/方法带有下划线前缀，则它用于某些“内部”工作。因此，如果您要使用/调用/更改此属性/方法，您最好非常清楚自己在做什么，或者期望它可能在未来的版本中被重命名/删除。

# emacs - 在 Emacs 中，如何将“Stackoverflow”之类的网站添加到我的 webjump 热门列表中？

> ID：59465
> 
> 赞同：0
> 
> 时间：2008-09-12T16:37:52.527
> 
> 标签：emacs, command

默认情况下，webjump hotlist 有以下我经常使用的：

```
M-x webjump RET Google
M-x webjump RET Wikipedia 
```

如何将“Stackoverflow”添加到我的列表中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T10:41:10.190

查找此类问题答案的一般提示：

1.  查找相关功能的帮助。例如。**ch f 网页跳转**
2.  在帮助缓冲区的第一行，在定义函数的文件名上点击 RET。这将带您进入函数定义。
3.  **M-<**跳转到缓冲区的开头。
4.  通读该文件的文档。通常（在这种情况下）这将包括有关如何配置该功能的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T06:33:31.607

您需要找到设置`webjump-sites`变量的位置。这可能是你的`.emacs`文件。然后，您需要向该列表中添加一对，如下所示。

```
("stackoverflow". "www.stackoverflow.com") 
```

将内容放入 .emacs 的完整示例如下。

```
(setq webjump-sites
   (append '(("stackoverflow" . "www.stackoverflow.com"))
      webjump-sample-sites) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T16:43:06.010

[以下是 Apple 运行的网站上 webjump.el 文件](http://www.opensource.apple.com/darwinsource/10.0/emacs-39/emacs/lisp/webjump.el)中的一些示例代码：

```
;;   (require 'webjump)
;;   (global-set-key "\C-cj" 'webjump)
;;   (setq webjump-sites
;;         (append '(
;;                   ("My Home Page" . "www.someisp.net/users/joebobjr/")
;;                   ("Pop's Site"   . "www.joebob-and-son.com/")
;;                   )
;;                 webjump-sample-sites)) 
```

# visual-studio - VS可以配置为在剪切文本后自动删除空白行吗？

> ID：59472
> 
> 赞同：1
> 
> 时间：2008-09-12T16:41:10.240
> 
> 标签：visual-studio, ide, editor

有没有办法（或捷径）告诉 VS 2008 它削减了这样的一行：

**前：**

```
Some Text here  
This gets cut  
Some Code there 
```

**后：**

```
Some Text here

Some Code there 
```

**我想要的是：**

```
Some Text here  
Some Code there 
```

PS：我不想选择整行或类似的东西......只有我要剪切的文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-12T16:58:20.903

除非我误解了你：
只需将光标放在要剪切的行上（无选择），然后按`Ctrl`+ `x`。这会切断行（不留空白）并将文本放入剪贴板。（在*MS VC# 2008 Express*中测试，没有我知道的其他设置）

那是你要的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T18:34:44.197

`Shift`+`Delete` also works. Select a line and hit Shift-Delete it will remove the line and place that line in your clipboard.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T16:58:46.410

不要选择任何东西，只需在光标在线时按`ctrl`+即可。`x`

# c# - 优化 Windows 窗体加载时间

> ID：59479
> 
> 赞同：5
> 
> 时间：2008-09-12T16:44:29.610
> 
> 标签：c#, .net, vb.net, winforms, optimization

我有一个 Windows 窗体，最初加载需要相当长的时间。但是，加载表单的每个后续请求都不会花费很长时间。有没有办法优化表单的加载时间？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-12T16:48:15.920

您可以使用[ngen](http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx)。

我还使用这个技巧来减少[启动时的内存占用](http://www.codeproject.com/KB/smart/rssfeeder.aspx#_Toc109841754)。

本机映像生成器 (Ngen.exe) 是一种提高托管应用程序性能的工具。Ngen.exe 创建本机映像，这些文件包含已编译的特定于处理器的机器代码，并将它们安装到本地计算机上的本机映像缓存中。运行时可以使用缓存中的本机映像，而不是使用即时 (JIT) 编译器来编译原始程序集。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-12T17:23:44.087

您需要先了解时间的去向，然后才能对其进行优化。不要在没有先发现的情况下直接使用它，就好像问题是加载 150MB 背景位图资源一样，那么你就不会对 ngen 做任何有用的事情。

您应该忽略在没有进行任何测量的情况下出现的所有关于优化的具体建议或预感。

# database - 更好的数据库设计是什么：更多的表还是更多的列？

> ID：59482
> 
> 赞同：83
> 
> 时间：2008-09-12T16:45:23.790
> 
> 标签：database, database-design, normalizing

一位前同事坚持认为，具有更多表且每列更少的数据库比具有更少表且每列更多的数据库要好。例如，不是包含名称、地址、城市、州、邮编等列的客户表，而是名称表、地址表、城市表等。

他认为这种设计更加高效和灵活。也许它更灵活，但我没有资格评论它的效率。即使它更有效，我认为这些收益可能会被增加的复杂性所抵消。

那么，与具有更多列的更少表相比，具有更少列的更多表有什么显着的好处吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-09-12T17:02:49.613

在设计数据库时，我遵循了一些相当简单的经验法则，我认为它们可以用来帮助做出这样的决策......

1.  赞成标准化。非规范化是一种优化形式，具有所有必要的权衡，因此应该以[YAGNI](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)的态度来处理它。
2.  确保引用数据库的客户端代码与架构充分分离，从而无需对客户端进行重大重新设计。
3.  当它为性能或查询复杂性提供明显的好处时，不要害怕去规范化。
4.  *当数据量和使用场景允许时，*使用视图或下游表来实现非规范化，而不是非规范化模式的核心。

这些规则的通常结果是，最初的设计将偏爱表而不是列，重点是消除冗余。随着项目的进展和非规范化点的确定，整体结构将朝着平衡的方向发展，以牺牲有限的冗余和列扩散来换取其他有价值的好处。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-12T16:50:10.470

我会赞成更多的桌子，但仅限于某一点。使用您的示例，如果您将用户的信息分成两个表，例如 USERS 和 ADDRESS，这使您可以灵活地为每个用户提供多个地址。一个明显的应用是具有单独帐单和送货地址的用户。

支持使用单独的 CITY 表的论点是您只需存储每个城市的名称一次，然后在需要时引用它。这确实减少了重复，但在这个例子中，我认为这是矫枉过正。它可能更节省空间，但是当您从数据库中选择数据时，您将在连接中付出代价。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-12T16:48:42.970

这听起来不像是关于表格/列的问题，而是关于规范化的问题。在某些情况下，高度[规范化](http://www.devshed.com/c/a/MySQL/An-Introduction-to-Database-Normalization/)（在这种情况下为“更多表”）是好的、干净的，但通常需要大量的 JOIN 才能获得相关结果。如果数据集足够大，这可能会降低性能。

[Jeff 写](http://blog.codinghorror.com/maybe-normalizing-isnt-normal/)了一些关于 StackOverflow 设计的文章。另请参阅[Dare Obasanjo](http://www.25hoursaday.com/weblog/2007/08/03/WhenNotToNormalizeYourSQLDatabase.aspx)的帖子 Jeff 链接。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-12T16:47:27.043

这取决于您的数据库风格。例如，MS SQL Server 往往更喜欢更窄的表。这也是更“规范化”的方法。其他引擎可能更喜欢它。大型机往往属于这一类。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-12T16:54:18.493

完全规范化的设计（即“更多表”）更灵活、更易于维护并避免数据重复，这意味着您的数据完整性将更容易实施。

这些都是正常化的有力理由。我会选择先规范化，然后在您看到性能成为问题*后才对**特定*表进行非规范化。

 *我的经验是，在现实世界中，即使有非常大的数据集，你也不会达到需要非规范化的地步。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-12T17:00:52.770

每个表应仅包含与由主键唯一标识的实体相关的列。如果数据库中的所有列都是同一实体的所有属性，那么您只需要一个包含所有列的表。

但是，如果任何列可能为空，则需要将每个可为空的列放入其自己的表中，并使用主表的外键对其进行规范化。这是一种常见的情况，因此为了更简洁的设计，您可能会向现有表添加比列更多的表。此外，通过将这些可选属性添加到它们自己的表中，它们将不再需要允许空值，并且您可以避免大量与 NULL 相关的问题。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-12T16:50:00.517

如果将来这些一对一关系中的任何一个可能变为一对多或多对多，那么多表数据库会更加灵活。例如，如果您需要为某些客户存储多个地址，如果您有一个客户表和一个地址表，这会容易得多。我真的看不到您可能需要复制地址的某些部分而不是其他部分的情况，因此单独的地址、城市、州和邮政编码表可能有点过分。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-12T16:53:43.237

像其他一切一样：这取决于。

关于列数与表数没有硬性规定。

如果您的客户需要拥有多个地址，那么单独的表格是有意义的。如果您有充分的理由将 City 列标准化为自己的表，那么也可以这样做，但我以前从未见过，因为它是一个自由格式的字段（通常）。

桌子很重，标准化的设计在空间方面是有效的，看起来“教科书式”，但可能会变得非常复杂。它看起来不错，直到您必须执行 12 次连接才能获得客户的姓名和地址。就最重要的性能而言，这些设计并不*自动*出色：查询。

尽可能避免复杂性。例如，如果客户只能有两个地址（不是任意多个），那么将它们全部保存在一个表中（CustomerID、Name、ShipToAddress、BillingAddress、ShipToCity、BillingCity 等）可能是有意义的。

[这是 Jeff](http://www.codinghorror.com/blog/archives/001152.html)关于该主题的帖子。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-12T16:48:49.520

拥有较少列的表有很多好处，但您还需要查看上面的场景并回答以下问题：

是否允许客户拥有超过 1 个地址？如果不是，则不需要单独的地址表。如果是这样，那么单独的表格会很有帮助，因为您可以根据需要轻松添加更多地址，而在表格中添加更多列变得更加困难。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-12T16:48:25.090

我会考虑将标准化作为第一步，因此城市、县、州、国家/地区最好作为单独的列... SQL 语言的强大功能以及今天的 DBMS-es 允许您稍后在需要查看时对数据进行分组它在其他一些非标准化视图中。

在开发系统时，如果您认为这是一种改进，您可能会考虑“非规范化”某些部分。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-12T16:48:35.963

在这种情况下，我认为平衡是有序的。如果将列放入表中有意义，则将其放入表中，如果没有，则不要。您的同事的方法肯定有助于规范化数据库，但如果您必须将 50 个表连接在一起以获得所需的信息，这可能不是很有用。

我想我的答案是，用你最好的判断。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-12T16:49:44.870

这有很多方面，但从应用程序效率的角度来看，mote 表有时可能更有效。如果每次数据库执行操作时都有几个带有一堆列的表，它就有机会锁定，那么在锁定期间会有更多数据不可用。如果锁升级到页面和表（希望不是表:)），您可以看到这会如何降低系统速度。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-12T17:46:46.310

唔。

我认为它是一种洗涤，取决于您的特定设计模型。绝对将具有多个字段的实体分解到自己的表中，或者实体的构成可能会随着应用程序需求的变化而变化（例如 - 我无论如何都会排除地址，因为它有很多字段，但我如果您认为有任何机会需要处理外国地址（可以是不同的形式。电话号码也一样），您会特别*这样做。*

也就是说，当你让它工作时，请注意性能。如果您将一个实体拆分出来，需要您进行大型、昂贵的联接，那么将该表拆分回原始表可能会成为更好的设计决策。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-07-29T07:46:36.360

当您设计数据库时，您应该尽可能接近数据的含义，而不是您的应用程序需要！

一个好的数据库设计应该可以保持 20 多年不变。

一个客户可能有多个地址，这就是现实。如果您决定将您的应用程序限制为第一个版本的一个地址，那么它关注的是您的应用程序的设计而不是数据！

如果您想简化查询，最好有多个表而不是多个列并使用视图。

大多数情况下，数据库的性能问题与网络性能（单行结果的链式查询、获取不需要的列等）有关，而不是与查询的复杂性有关。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-12T16:49:50.563

使用尽可能少的列进行**查询**有很大的好处。但是表本身可以有很大的数字。[杰夫](http://www.codinghorror.com/blog/archives/001152.html)也谈到了这一点。

基本上，确保在进行查询时要求的内容不会超过您的需要 - 查询的性能与您要求的列数直接相关。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-12T16:50:04.930

我认为您必须先查看您存储的数据类型，然后再做出决定。拥有地址表很好，但前提是多个人共享同一地址的可能性很高。如果每个人都有不同的地址，那么将这些数据保存在不同的表中只会引入不必要的连接。

我看不到拥有城市表的好处，除非城市本身就是您在应用程序中关心的实体。或者，如果您想限制用户可用的城市数量。

底线是这样的决定必须在开始提高效率之前考虑应用程序本身。国际海事组织。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-08-11T21:01:02.617

首先，规范化您的表格。这可以确保您避免冗余数据，从而减少要扫描的数据行，从而改进您的查询。然后，如果您遇到要连接的规范化表导致查询需要很长时间来处理（昂贵的连接子句）的点，请在更合适的地方进行非规范化。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-11-21T12:11:41.617

很高兴看到这么多鼓舞人心且基础良好的答案。

我的回答是（不幸的是）：这取决于。

两种情况： * 如果您创建一个要使用多年的数据模型，因此可能必须适应许多未来的变化：使用更多的表和更少的行以及非常严格的规范化。* 在其他情况下，您可以在多表少行或少表多行之间进行选择。特别是对于这个主题相对较新的人来说，最后一种方法可能更直观，更容易理解。

The same is valid for the choosing between the object oriented approach and other options.

# c - 被 gdb print ptr vs print "%s" 弄糊涂了

> ID：59483
> 
> 赞同：1
> 
> 时间：2008-09-12T16:46:41.197
> 
> 标签：c, gdb, buffer-overflow, buffer-overrun

```
1167      ptr = (void*)getcwd(cwd, MAX_PATH_LENGTH-1);
(gdb) n
1168      if (!ptr) {
(gdb) print ptr
$1 = 0xbff2d96c "/media/MMC-SD/partition1/aaaaaaaaaaa"
(gdb) print &cwd
$2 = (char (*)[3500]) 0xbff2d96c
(gdb) print strlen(cwd)
$3 = 36
(gdb) print "%s",cwd
$4 = "/media/MMC-SD/partition1/aaaaaaaaaaa", '\0' <repeats 912 times>, "��O�001\000\000\000\000��027\000\000\000�3����EL鷠3�000��027\000\000\000\000\000\000\000\027\000\000\000\000��/�027\000\000\000�3����N����\230���鷠3�000��027\000\000\000\000\000\000\000��000\000\000\000\001\000\000\000��M鷠3����\000\000\000\000.\231�027��w\005\b\001\000"...
(gdb) print "%s", ptr
$5 = 0xbff2d96c "/media/MMC-SD/partition1/aaaaaaaaaaa"
(gdb) Quit 
```

为什么 ptr 正确打印字符串但 cwd 不正确；这也会影响程序，如果我尝试使用 cwd，它会崩溃......

[编辑：原来崩溃是由这个 var 上的愚蠢缓冲区溢出引起的……grr……不是 gdb，但打印问题仍然有效]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-12T17:22:24.510

我同意姆维尔登。尝试我认为与您的代码类似的东西，我得到：

```
(gdb) print cwd
$1 = "/media", '\0' <repeats 782 times>, "\016���" ...
(gdb) print (char*) cwd
$2 = 0xbfc8eb84 "/media" 
```

来自 gdb，所以看起来既然`cwd`定义为`char cwd[3500]`，gdb 会打印整个数组，而如果您告诉 gdb 将其解释为 a `char*`，它将按您的预期工作。如果您的应用程序崩溃，我会认为这是因为其他原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-12T16:59:27.310

`cwd`以不同方式打印的原因`gdb`是因为`gdb`知道这`ptr`是一个`char *`（我猜）并且`cwd`是一个长度数组`3500`（如您的输出所示）。因此，在打印时`ptr`它会打印指针值（作为服务，它还指向它所指向的字符串），而在打印时`cwd`它会打印*整个*数组。

我看不出使用`cwd`代替`ptr`会导致问题的任何原因，但我需要查看一些代码才能确定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T16:55:51.797

这`ptr`显示为格式良好的字符串，并且`cwd`“字节缓冲区”可能特定于 gdb。无论如何，它不应该影响您的应用程序；根据`man 3 getcwd`,`ptr`应该指向`cwd`（或者如果发生错误，它应该是 NULL ）。你可以在`ptr`不崩溃程序的情况下使用吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T16:58:28.343

cwd 是什么类型的？上面的代码片段并没有告诉我们这一点。可能 ptr 是一个 void* 被 gdb 以不同的方式对待。

# c# - 将此委托转换为匿名方法或 lambda

> ID：59515
> 
> 赞同：21
> 
> 时间：2008-09-12T16:58:32.603
> 
> 标签：c#, .net-3.5, delegates, lambda, anonymous-methods

我是所有匿名功能的新手，需要一些帮助。我已经完成了以下工作：

```
public void FakeSaveWithMessage(Transaction t)
{
    t.Message = "I drink goats blood";
}

public delegate void FakeSave(Transaction t);

public void SampleTestFunction()
{
    Expect.Call(delegate { _dao.Save(t); }).Do(new FakeSave(FakeSaveWithMessage));
} 
```

但这完全是丑陋的，如果可能的话，我希望 Do 的内部成为一个匿名方法，甚至是一个 lambda。我试过：

```
Expect.Call(delegate { _dao.Save(t); }).Do(delegate(Transaction t2) { t2.Message = "I drink goats blood"; }); 
```

和

```
Expect.Call(delegate { _dao.Save(t); }).Do(delegate { t.Message = "I drink goats blood"; }); 
```

但这些给了我

> 无法将匿名方法转换为类型“System.Delegate”，因为它不是委托类型** 编译错误。

我究竟做错了什么？

* * *

由于 Mark Ingram 发布的内容，尽管没有人明确表示，但似乎最好的答案是这样做：

```
public delegate void FakeSave(Transaction t);

Expect.Call(delegate { _dao.Save(t); }).Do( new FakeSave(delegate(Transaction t2) { t.Message = expected_msg; })); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-12T17:20:21.537

这是一个众所周知的错误消息。检查下面的链接以获得更详细的讨论。

[http://staceyw1.wordpress.com/2007/12/22/they-are-anonymous-methods-not-anonymous-delegates/](http://staceyw1.wordpress.com/2007/12/22/they-are-anonymous-methods-not-anonymous-delegates/)

基本上你只需要在你的匿名委托（你的 lambda 表达式）前面加上一个演员。

万一链接断开，这里是帖子的副本：

> **它们是匿名方法，而不是匿名委托。**
> 发表于 2007 年 12 月 22 日由 staceyw1
> 
> 这不仅仅是一个话题，因为我们想要变得困难。它帮助我们推理到底发生了什么。需要明确的是，*没有匿名代表之类的东西。它们不存在（还不存在）。它们是“匿名方法”——句号。重要的是我们如何看待它们以及我们如何谈论它们。让我们看一下匿名方法语句“delegate() {…}”。这实际上是两种不同的操作，当我们这样想的时候，我们就再也不会感到困惑了。编译器做的第一件事是使用推断的委托签名作为方法签名在幕后创建匿名方法。说该方法是“未命名的”是不正确的，因为它确实有一个名称并且编译器分配了它。它只是从正常视图中隐藏。它要做的下一件事是创建一个所需类型的委托对象来包装该方法。这称为委托推理，可能是这种混乱的根源。为此，编译器必须能够弄清楚（即推断）它将创建什么委托类型。它必须是已知的具体类型。让我们写一些代码来看看为什么。

```
private void MyMethod()
{
} 
```

> **不编译：**

```
1) Delegate d = delegate() { };                       // Cannot convert anonymous method to type ‘System.Delegate’ because it is not a delegate type
2) Delegate d2 = MyMethod;                         // Cannot convert method group ‘MyMethod’ to non-delegate type ‘System.Delegate’
3) Delegate d3 = (WaitCallback)MyMethod;   // No overload for ‘MyMethod’ matches delegate ‘System.Threading.WaitCallback’ 
```

> 第 1 行无法编译，因为编译器无法推断任何委托类型。它可以清楚地看到我们想要的签名，但是编译器看不到具体的委托类型。它可以为我们创建一个匿名类型的类型委托，但它不是那样工作的。出于类似原因，第 2 行无法编译。即使编译器知道方法签名，我们也不会给它一个委托类型，它不会只是选择一个会发生工作的方法（而不是可能有什么副作用）。第 3 行不起作用，因为我们故意将方法签名与具有不同签名的委托不匹配（因为 WaitCallback 采用和对象）。
> 
> **编译：**

```
4) Delegate d4 = (MethodInvoker)MyMethod;  // Works because we cast to a delegate type of the same signature.
5) Delegate d5 = (Action)delegate { };              // Works for same reason as d4.
6) Action d6 = MyMethod;                                // Delegate inference at work here. New Action delegate is created and assigned. 
```

> 相比之下，这些工作。第 1 行有效，因为我们告诉编译器使用什么委托类型并且它们匹配，所以它有效。第 5 行的工作原理相同。请注意，我们使用了不带括号的特殊形式的“委托”。编译器从强制转换推断方法签名，并创建与推断的委托类型具有相同签名的匿名方法。第 6 行有效，因为 MyMethod() 和 Action 使用相同的签名。
> 
> 我希望这有帮助。
> 
> 另见：http: [//msdn.microsoft.com/msdnmag/issues/04/05/C20/](http://msdn.microsoft.com/msdnmag/issues/04/05/C20/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-12T17:27:24.950

马克说的。

问题是 Do 需要一个 Delegate 参数。编译器不能将匿名方法转换为委托，只能转换为“委托类型”，即从委托派生的具体类型。

如果该 Do 函数采用了 Action<>、Action<、> ... 等重载，则不需要强制转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T17:47:48.723

问题不在于您的委托定义，而在于 Do() 方法的参数是 System.Delegate 类型，并且编译器生成的委托类型 (FakeSave) 不会隐式转换为 System.Delegate。

尝试在您的匿名代表面前添加演员表：

```
Expect.Call(delegate { _dao.Save(t); }).Do((Delegate)delegate { t.Message = "I drink goats blood"; }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T17:07:57.587

尝试类似：

```
Expect.Call(delegate { _dao.Save(t); }).Do(new EventHandler(delegate(Transaction t2) { t2.CheckInInfo.CheckInMessage = "I drink goats blood"; })); 
```

请注意在委托周围添加的 EventHandler。

编辑：可能不起作用，因为 EventHandler 和委托的函数签名不同......您添加到问题底部的解决方案可能是唯一的方法。

或者，您可以创建一个通用委托类型：

```
public delegate void UnitTestingDelegate<T>(T thing); 
```

因此委托不是特定于事务的。

# algorithm - 同步算法

> ID：59521
> 
> 赞同：10
> 
> 时间：2008-09-12T17:02:02.983
> 
> 标签：algorithm, calendar, sync

同步算法有什么好的参考吗？

我对在多个用户之间同步以下类型的数据的算法感兴趣：

*   日历
*   文件
*   列表和大纲

我不只是在寻找目录内容的同步*la* [rsync](http://en.wikipedia.org/wiki/Rsync)；我对合并单个文件中的数据感兴趣。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-06-05T18:55:41.307

*[对Optimistic Replication](http://www.ece.cmu.edu/~ece845/docs/optimistic-data-rep.pdf)*中的所有同步算法进行了高级且非常广泛的概述（作者 Yasushi Saito 和 Marc Shapiro，[PDF](http://en.wikipedia.org/wiki/Portable_Document_Format)格式）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-12T17:14:03.767

[SyncML](http://en.wikipedia.org/wiki/SyncML)是一种标准，用于对通常与某人的个人组织相关的事物进行数据同步。几年前诺基亚和摩托罗拉都在大量使用它，但我不知道它的现状。

[iCalendar](http://en.wikipedia.org/wiki/ICalendar)是日历同步格式规范，[CalDAV](http://en.wikipedia.org/wiki/CalDAV)是 iCalendar 在 WebDAV 协议之上的实现。谷歌搜索[iCal](http://en.wikipedia.org/wiki/Calendar_%28application%29)或 iCalendar 可能会出现 Apple 提供的 iCal 应用程序，它是 Mac OS X 的一部分。继续向下查看结果列表，直到看到看起来像协议的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T17:06:23.193

我原以为查看任何开源代码控制应用程序都会给你一个正确的想法 - 合并文件之间的更改正是他们所做的......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T02:44:33.260

我相信[Delta Compression](http://en.wikipedia.org/wiki/Binary_delta_compression)是您正在寻找的。

# video - 什么是录制正在屏幕上播放的视频或截屏的好程序？

> ID：59525
> 
> 赞同：5
> 
> 时间：2008-09-12T17:04:44.630
> 
> 标签：video, screen-recording

什么是录制正在屏幕上播放的视频或截屏的好程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-12T17:05:41.650

我在 Camtasia / CamStudio 上取得了成功。查看[http://showmedo.com](http://showmedo.com)获取教程。虽然它有点递归 - 最好从源代码中捕获它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T09:39:12.630

在 Windows 上，您有[CamTasia](http://www.techsmith.com/camtasia.asp)（商业）、[CamStudio](http://camstudio.org/) (GPL)、[FRAPS](http://www.fraps.com/)（免费试用的商业）。

FRAPS 绝对可以胜任您的工作，它旨在捕捉 3D 游戏的视频。CamTasia 可能，它有一个低级的自定义编解码器（TechSmith Capture Codec）。CamStudio 可能不会，至少不会顺利。CamStudio 在 Vista 上有问题，我不知道 FRAPS，CamTasia 在 Vista 上很好。

在 Mac 上试用 ScreenFlow，他们的[示例视频](http://www.flip4mac.com/screenflow.htm)清楚地表明它可以捕获实时视频流。

在 Linux 上你会遇到一些麻烦。如果你重新编译 ffmpeg，你可能会得到它录制视频。我认为recordmydesktop 不会完成这项工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T17:14:33.797

如果您使用的是 Vista，那么最新版本的[Fraps](http://www.fraps.com/)也可以满足您的需求。不过，我还没有尝试过，只是游戏

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-23T02:17:35.260

DemoCreator 可能是一个不错的选择。它易于使用，并且具有强大的编辑功能。

[http://www.sameshow.com/demo-creator.html](http://www.sameshow.com/demo-creator.html#107)

# soa - 面向服务的架构：你会如何定义它

> ID：59537
> 
> 赞同：15
> 
> 时间：2008-09-12T17:10:36.503
> 
> 标签：soa, definition

如今，面向服务的架构似乎越来越热门，但在办公室里四处询问后，我发现我似乎得到了许多不同的定义。你们如何定义 SOA？你认为官方的定义是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-12T17:15:14.403

正如 Martin Fowler 所说，它对不同的人意味着不同的事情。他关于该主题的文章非常好，尽管它不是一个完整的定义。

[http://martinfowler.com/bliki/ServiceOrientedAmbiguity.html](http://martinfowler.com/bliki/ServiceOrientedAmbiguity.html)

它可以解释，很难提出一个具体的定义。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T13:46:49.237

维基百科：“SOA 是一种软件架构，它使用松散耦合的软件服务来支持业务流程和软件用户的需求。SOA 环境中网络上的资源作为独立服务提供，无需了解其底层平台即可访问执行。”

SOA 并不是什么新鲜事物，但它有潜力实现一些令人惊奇的事情。但组织必须为此做好准备：企业必须在流程中思考，这是大问题

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-12T17:19:33.253

我会去：

> 定义一系列无状态、与客户端无关的业务操作，这些操作被创建用于在多个应用程序中使用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-12T17:15:04.030

SOA 设计包括代码可以使用的组件（即*服务），而不管实现如何（即任何操作系统或语言）。*一个服务的单个实例也可能被多个应用程序使用，然而，例如，一个 DLL 必须为每个应用程序复制，并且需要与链接应用程序相同的实现技术。

SOA 设计中的服务通常实现为可互操作的 Web 服务。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-15T18:16:02.500

正如瑞安之前提到的，没有官方定义。然而，我发现 Thomas Erl 对整个面向服务的观点结构良好且相关。以下是他的[SOA Glossary](http://www.soaglossary.com/) ([更多](http://www.soaglossary.com/service_oriented_architecture.asp)) 中对 SOA 的定义：

> 面向服务的架构代表了一种架构模型，旨在提高企业的敏捷性和成本效益，同时减轻组织的 IT 总体负担。

Thomas Erl 是许多 SOA 书籍的作者，其中大部分都得到了 SOA 供应商的认可，包括 IBM、Oracle 和 Microsoft。[他的书的好处](http://www.soabooks.com/)是它们尽可能独立于 SOA 供应商。这意味着您更多地了解面向服务本身，而不是了解一些支持 SOA 的供应商的中间件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T17:03:21.623

我同意所有将你指向福勒的人的观点。基本上它是这样运行的：面向服务的架构以良好而著称，因此人们希望与良好相关的任何事物都称为 SOA。实际上，它有很多缺点，并且可以创建面向服务的僵局或面向依赖的架构。

这是我的定义：面向服务的架构是一种系统集成和代码重用方法，其中应用程序依赖于连接到网络上其他正在运行的应用程序提供的服务。这与组件架构不同，在组件架构中，软件组件以库或 SDK 的形式在应用程序之间静态共享。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-01T07:54:30.463

这里有一个澄清 - “面向服务的架构是一种**系统集成**和代码重用方法，其中应用程序依赖于**连接到网络上其他正在运行的应用程序提供的服务**。”

我有一个场景，其中两个 j2ee 应用程序已使用事件驱动的消息传递进行集成。在这里，上述**系统集成**和**连接到网络上其他正在运行的应用程序提供的服务**的短语很好用。我可以称之为 SOA 吗？

以下原则在这里适用 1) 无状态 2) 面向消息 - 松散耦合事实上解耦 3) 可扩展。

但是，以下内容不适用 1) 平台独立性 - 所集成的应用程序均未设计为在不同平台上工作。2) 应用程序是普通的 j2ee 应用程序，没有使用所有 soa 概念设计。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T17:54:33.287

我试图在[我的一篇博客文章](http://vincentfazio.blogspot.com/2008/07/something-old-something-new.html)中定义 SOA 。这是摘录...

> 多年来，将功能分离为函数、类和模块一直是标准做法。一直以来的想法是，这些更小、高度专业化的组件比单片代码块更容易共享和维护。
> 
> 在功能上，SOA 并没有太大的不同。目标是相同的 - 可重用性和易于维护。最大的区别——在 Web 服务 SOA 的情况下——是应用程序中包含的共享库被 HTTP 调用所取代。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-05T11:13:28.973

这是给你的定义：

SOA - 软件过度架构。在一个漂亮的网站中包含无意义、过度膨胀的功能性界面框架，称为架构，其中 3d 图形文件夹从一侧飞到另一侧，其中“dir /s > a.txt | ftp -s:upload.ftp”做了这项工作。

软件组件不是砖块，不能通过通用的功能模式来概括，企业中出现的架构来自良好的实践，而不是良好的设计。软件不是架构的，它是设计的。

开始吧！

# sql - SQL 递归表

> ID：59544
> 
> 赞同：7
> 
> 时间：2008-09-12T17:15:52.747
> 
> 标签：sql, mysql

我有以下表格，该`groups`表格包含按层次排序的组以及`group_member`存储用户所属的组。

```
groups
---------
id  
parent_id
name

group_member
---------
id
group_id
user_id

ID  PARENT_ID  NAME
---------------------------
1   NULL       Cerebra
2   1          CATS 
3   2          CATS 2.0 
4   1          Cerepedia 
5   4          Cerepedia 2.0
6   1          CMS 

ID GROUP_ID USER_ID
---------------------------
1  1        3
2  1        4
3  1        5
4  2        7
5  2        6
6  4        6
7  5        12
8  4        9
9  1        10 
```

我想检索给定用户的可见组。也就是说，用户所属的组和这些组的子组。比如上面的数据：

```
USER  VISIBLE_GROUPS
9     4, 5 
3     1,2,4,5,6
12    5 
```

我使用递归和几个数据库查询来获取这些值。但我想知道是否可以使用单个 SQL 查询来提高我的应用程序性能。我正在使用 MySQL。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-12T19:04:20.647

想到两件事：

**1 -**您可以反复将表外部连接到自身以递归地向上走您的树，如：

```
SELECT *
FROM
  MY_GROUPS MG1
 ,MY_GROUPS MG2
 ,MY_GROUPS MG3
 ,MY_GROUPS MG4
 ,MY_GROUPS MG5
 ,MY_GROUP_MEMBERS MGM
WHERE MG1.PARENT_ID = MG2.UNIQID (+)
  AND MG1.UNIQID = MGM.GROUP_ID (+)
  AND MG2.PARENT_ID = MG3.UNIQID (+)
  AND MG3.PARENT_ID = MG4.UNIQID (+)
  AND MG4.PARENT_ID = MG5.UNIQID (+)
  AND MGM.USER_ID = 9 
```

这会给你这样的结果：

```
UNIQID PARENT_ID NAME      UNIQID_1 PARENT_ID_1 NAME_1 UNIQID_2 PARENT_ID_2 NAME_2  UNIQID_3 PARENT_ID_3 NAME_3 UNIQID_4 PARENT_ID_4 NAME_4 UNIQID_5 GROUP_ID USER_ID
4      2         Cerepedia 2        1           CATS   1        null        Cerebra null     null        null   null      null       null   8        4        9 
```

这里的限制是，您必须为要向上走的每个“级别”添加一个新连接。如果您的树的级别少于 20 个级别，那么您可以通过创建一个显示每个用户的 20 个级别的视图来摆脱它。

**2 -**我知道的唯一其他方法是创建一个递归数据库函数，并从代码中调用它。您仍然会有一些查找开销（即，您的查询数仍将等于您在树上行走的级别数），但总体而言它应该更快，因为它都发生在数据库中。

我不确定 MySql，但在 Oracle 中，这样的函数将类似于此函数（您必须更改表和字段名称；我只是在复制我过去所做的事情）：

```
CREATE OR REPLACE FUNCTION GoUpLevel(WO_ID INTEGER, UPLEVEL INTEGER) RETURN INTEGER
IS
BEGIN
  DECLARE
    iResult INTEGER;
    iParent INTEGER;
BEGIN
  IF UPLEVEL <= 0 THEN
    iResult := WO_ID;
  ELSE
    SELECT PARENT_ID
    INTO iParent
    FROM WOTREE
    WHERE ID = WO_ID;    
    iResult := GoUpLevel(iParent,UPLEVEL-1);  --recursive
  END;
  RETURN iResult;
  EXCEPTION WHEN NO_DATA_FOUND THEN
    RETURN NULL;
  END;
END GoUpLevel;
/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-13T15:00:18.430

Joe Cleko 的书“SQL for Smarties”和“Trees and Hierarchies in SQL for Smarties”描述了通过使用嵌套集完全避免递归的方法。这使更新复杂化，但使其他查询（通常需要递归）相对简单。Joe 在 1996 年写的这篇文章中有[一些例子。](http://www.dbmsmag.com/9604d06.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T21:18:09.900

我不记得我在哪个 SO 问题下找到了链接，但[sitepoint.com 上的这篇文章](http://www.sitepoint.com/article/hierarchical-data-database/1/)（第二页）显示了另一种将分层树存储在表中的方法，可以轻松找到所有子节点或指向顶，诸如此类。用示例代码很好的解释。

* * *

PS。StackOverflow 的新手，以上是否可以作为答案，或者它真的应该是对问题的评论，因为它只是指向不同解决方案的指针（不完全回答问题本身）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T17:40:25.670

我认为不使用递归就无法做到这一点。您可以使用 mySQL 使用单个存储过程来完成它，但默认情况下，存储过程中不允许递归。 [本文](http://dev.mysql.com/doc/refman/5.0/en/stored-routines.html)包含有关如何启用递归的信息。我不确定与多查询方法相比这会对性能产生多大影响。mySQL 可能会对存储过程进行一些优化，但否则我希望性能相似。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T17:59:31.113

不知道您是否有用户表，所以我通过存储在 Group_Member 表中的 User_ID 获取列表...

```
SELECT GroupUsers.User_ID,
        (
        SELECT 
            STUFF((SELECT ',' + 
            Cast(Group_ID As Varchar(10))
            FROM Group_Member Member (nolock) 
            WHERE Member.User_ID=GroupUsers.User_ID
        FOR XML PATH('')),1,1,'') 
        ) As Groups
FROM (SELECT User_ID FROM Group_Member GROUP BY User_ID) GroupUsers 
```

返回：

```
User_ID    Groups
3          1
4          1
5          1
6          2,4
7          2
9          4
10         1
12         5 
```

根据您表中的数据，这似乎是正确的。但与您的预期值列表不匹配（例如，用户 9 仅在您的表数据中的一组中，但您在结果中将其显示为属于两个）

编辑：当。刚刚注意到您使用的是 MySQL。我的解决方案是针对 SQL Server。对不起。

——凯文·费尔柴尔德

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-13T23:16:44.730

已经有人提出了类似的[问题](https://stackoverflow.com/questions/20426/how-to-maintain-a-recursive-invariant-in-a-mysql-database)。

这是我的答案（有点编辑）：

我不确定我是否正确理解了您的问题，但这可能适用[于我对 SQL 中的树的看法](http://www.depesz.com/index.php/2008/04/11/my-take-on-trees-in-sql/)。

链接的帖子描述了在数据库中存储树的方法——在这种情况下是 PostgreSQL——但该方法足够清晰，因此可以轻松地用于任何数据库。

使用这种方法，您可以使用大约 N 个简单的 SELECT 查询轻松更新所有依赖于修改节点 K 的节点，其中 N 是 K 到根节点的距离。

祝你好运！

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-12T19:02:39.730

~~在 SQL 标准中没有办法做到这一点，但您通常可以找到特定于供应商的扩展，例如`CONNECT BY`在 Oracle 中。~~

更新：正如评论所指出的，这是在 SQL 99 中添加的。

# c# - 有哪些工具可以将 Delphi 7 应用程序转换为 C# 和 .Net 框架？

> ID：59547
> 
> 赞同：17
> 
> 时间：2008-09-12T17:16:27.880
> 
> 标签：c#, delphi, migration

我维护了一个用 Delphi 7 编写的旧的仅限 PC 的应用程序。虽然 Delphi 过去对我很有帮助，但我现在只将它用于这个应用程序，并且发现我的语言技能正在下降。它的语法与我的 Java/Ruby 的“日常工作”语言太不同了，所以我需要更长的时间才能进入编写新代码的凹槽，而且它太旧了，我没有使用很多**interface**，所以代码没有被管理现在对我来说似乎很古老！

我的许多用户正在迁移到 Vista，这可能会在兼容模式下运行应用程序，或者可能会遇到 GPF 问题，具体取决于他们的 IT 部门如何配置他们的 PC，因此我必须对应用程序进行一些维护。我想知道我是否应该跳到更熟悉的堆栈。

是否有一个自动化工具可以完成将代码库转换为 C# 的工作，让我专注于任何非标准组件的转换？我正在使用一个名为[AbsoluteDatabase](http://www.componentace.com/bde_replacement_database_delphi_absolute_database.htm)的嵌入式数据库组件，它与 BDE 兼容并始终使用标准 SQL，以及一个本机 Delphi HTML 浏览器组件，它可以与 Microsoft 世界中的某些东西交换。

这些转换工具有多好？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-12T17:42:12.340

我不知道有任何自动化工具可以进行这种转换。我个人建议你坚持使用 Delphi，也许只是升级到新版本。我见过几个代码 DOM 试图从 Delphi 转换为 C#，但这并没有解决库问题。

CodeGear（以前称为 Borland）有一个[从 C# 到 Delphi](http://dn.codegear.com/article/32338)的工具，可以正常工作。我会假设朝着另一个方向发展的工具也会起作用（需要大量编辑）。这是一个瑞典工具，它使用相同的 CodeDOM 原理从[Delphi 到 C#](http://w1.311.telia.com/~u31115556/desc/programs.htm#BabbelFisken)（和许多其他语言）。还有其他的，我现在找不到。

另一种选择是升级到最新版本的 Delphi for .NET 并以这种方式将您的代码移植到 .NET。一旦你让它在 Delphi for .NET 中工作（这将非常容易，除了嵌入式 DB，除非它们有 .NET 版本）你可以使用[.NET Reflector](http://www.red-gate.com/products/reflector/)和[File Disassembler](http://www.denisbauer.com/NETTools/FileDisassembler.aspx)将 IL 反转为 C#。您仍将使用 VCL，但您可以使用 C# 代替 Object pascal。

另一个类似的解决方案是通过 RemObjects 将其移植到[Oxygene](http://remobjects.com/oxygene)。我相信他们有一个到 WinForms 的 Delphi Win32 迁移路径。然后使用[.NET Reflector](http://www.red-gate.com/products/reflector/)和[File Disassembler](http://www.denisbauer.com/NETTools/FileDisassembler.aspx)将 IL 反转为 C#。

简而言之，没有简单的答案。语言迁移比库迁移更容易。很大程度上取决于您使用的第 3 方组件（AbsoluteDatabase 之外）以及您是否直接在应用程序中进行了任何 Windows API 调用。

另一个完全不同的选择是寻找离岸团队来维护应用程序。他们可能可以很便宜地做到这一点。你可以在国内找人，但毫无疑问会花费更多（尽管美元贬值和就业市场不佳，你永远不知道......）

祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-25T17:08:33.490

John Brant 有一份科学报告，将一个 150 万行的 Delphi 项目成功转换为 C#。他在 AST 上编写了一个 Delphi 解析器、一个 C# 生成器和许多转换规则。逐渐扩展规则集，进行日常构建，大量单元测试，以及一些困难的 Delphi 部分的重写，使他有了一个 4 人的团队，其中一些原始开发人员具有深厚的 Delphi 和 C# 知识，可以迁移软件在 18 个月内。John Brant 是重构浏览器和 SmaCC 编译器构建工具包的原始开发者，您不太可能走得那么快

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-15T09:38:47.313

> 我的许多用户正在迁移到 Vista，这可能会在兼容模式下运行应用程序，或者可能会遇到 GPF 问题，具体取决于他们的 IT 部门如何配置他们的 PC，因此我必须对应用程序进行一些维护。我想知道我是否应该跳到更熟悉的堆栈。

除非您正在做一些非标准的事情，否则 D7 应用程序应该在 Vista 中运行良好。

至于转换为 C#，我认为大多数转换工具都是浪费时间。更好的方法可能是从头开始重写应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T09:46:43.067

没有简单的答案，但请记住，该语言的 Delphi.net 变体以 .net 运行时为目标，并且 .net 上的不同语言可以紧密地互操作。

您可以尝试让它在 Delphi.Net 中编译，分解成不同的程序集，然后手动一个一个地转换程序集。Reflector 可以帮助将编译后的代码逆向工程为 C# 代码的骨架 - 等效但没有注释、内部变量名称等。

另一方面，Delphi.net 对于这个项目来说可能已经足够好了（TM）。

但是除非你有一个好的测试套件（我猜可能没有，考虑到 Delphi 7 的最新技术）你会引入错误。

# user-interface - 母语作为应用程序的默认语言

> ID：59549
> 
> 赞同：3
> 
> 时间：2008-09-12T17:19:01.773
> 
> 标签：user-interface, user-experience

在下载 Firefox 和 Chrome 时，我注意到我得到的默认版本是我的母语希伯来语。我个人不喜欢我的希伯来语应用程序，因为我已经习惯了很久以前嵌入我的英语 UI 约定：

1.  **缺乏选择：**大多数程序不提供多种语言的界面，当它们提供时，这些语言通常是英语和开发人员的母语。
2.  **几乎完全与英语绑定的**编程语言。****

 **那么我的问题是：

1.  如果您翻译您的应用程序，您会将 UI 限制为用户的母语，还是通过默认启用多个语言包来给他们选择？
2.  您的应用程序默认使用哪种语言（如果您的应用程序只安装一个语言包，这很有趣）？

而且一般来说，我想知道您在整体翻译您的应用程序方面投入了多少价值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-12T17:29:04.307

我帮助开发了荷兰语、英语、西班牙语和葡萄牙语用户使用的应用程序。因为从 CD 安装的应用程序我们只是添加了所有的语言包。主要是因为它为我们节省了很多工作，而不必维护 4 个不同的版本。

如果您的应用程序是从网站分发的，并且您必须支持超过 4 种语言，我可以想象您不想让每个人都下载每个语言包。但是只分发下载应用程序的人的母语似乎有点限制。我认识的大多数人实际上都喜欢他们的英文软件。因此，至少在所有版本中添加英语是有意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T17:23:06.070

我从未编写过供大量人使用的应用程序，也从未为不使用英语作为语言的任何人编写过应用程序，但如果我这样做了，我可能会采取在安装时安装所有可用语言包的路线（除非用户进行了自定义安装，否则我将允许他们选择语言包），然后在程序中作为选项在语言之间切换。如果我只能选择一种语言，如果我完成所有工作，我会选择英语，或者如果我有翻译，我会选择用户的母语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T17:40:50.067

在编写用于多语言使用的应用程序时，我使用 Microsoft[开发世界通用应用程序的最佳实践](http://msdn.microsoft.com/en-us/library/w7x1y988.aspx "开发全球通用应用程序的最佳实践")，其中包括从操作系统中检索当前的 CultureInfo 并将其用作默认语言包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-13T03:19:57.553

我通常会尝试使用所有可用的本地化资源来发布产品。在用户首次启动产品时，UI 以最接近其机器上操作系统的本地化呈现。进入应用程序后，用户可以选择将 UI 切换到其他可用的本地化之一。

我认为提供与目标市场相匹配的本地化非常重要。到目前为止，大多数“普通”人（不是软件开发人员！）更喜欢用他们的母语制作 UI。

# java - 使用 Java 将 HTML 转换为 Markdown

> ID：59557
> 
> 赞同：37
> 
> 时间：2008-09-12T17:23:32.277
> 
> 标签：java, markdown

有没有一种简单的方法可以使用 JAVA 将 HTML 转换为 markdown？

我目前正在使用 Java **[MarkdownJ](http://code.google.com/p/markdownj/)**库将 markdown 转换为 html。

```
import com.petebevin.markdown.MarkdownProcessor;
...
public static String getHTML(String markdown) {
    MarkdownProcessor markdown_processor = new MarkdownProcessor();
    return markdown_processor.markdown(markdown);
}

public static String getMarkdown(String html) {
/* TODO Ask stackoverflow */
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2020-05-30T16:30:38.307

有一个很棒的 JS 库，叫做[Turndown](https://github.com/domchristie/turndown)，你可以[在这里](https://domchristie.github.io/turndown/)在线试用。它适用于接受答案错误的html。

我需要它用于 Java（作为问题），所以我移植了它。Java 的库称为[CopyDown](https://github.com/furstenheim/copy-down)，它具有与 Turndown 相同的测试套件，并且我已经通过实际示例进行了尝试，接受的答案是抛出错误。

使用 gradle 安装：

```
dependencies {
        compile 'io.github.furstenheim:copy_down:1.0'
} 
```

然后使用它：

```
CopyDown converter = new CopyDown();
String myHtml = "<h1>Some title</h1><div>Some html<p>Another paragraph</p></div>";
String markdown = converter.convert(myHtml);
System.out.println(markdown);
> Some title\n==========\n\nSome html\n\nAnother paragraph\n 
```

PS。它有 MIT 许可证

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T12:50:26.273

我正在研究同样的问题，并尝试了几种不同的技术。

上面的答案可以工作。您可以使用[jTidy 库](http://jtidy.sourceforge.net/)进行初始清理工作并将 HTML 转换为 XHTML。您使用上面链接的[XSLT 样式表](http://www.lowerelement.com/Geekery/XML/XHTML-to-Markdown.html)。

不幸的是，在 Java 中没有提供一站式功能的库。您可以尝试将 Python 脚本[html2text](http://www.aaronsw.com/2002/html2text/)与 Jython 一起使用，但我还没有尝试过！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T00:36:20.340

如果您正在使用 WMD 编辑器并想在服务器端获取降价代码，只需在加载`wmd.js`脚本之前使用这些选项：

```
wmd_options = {
        // format sent to the server.  can also be "HTML"
        output: "Markdown",

        // line wrapping length for lists, blockquotes, etc.
        lineLength: 40,

        // toolbar buttons.  Undo and redo get appended automatically.
        buttons: "bold italic | link blockquote code image | ol ul heading hr",

        // option to automatically add WMD to the first textarea found.
        autostart: true
    }; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-03T09:33:49.417

有一个名为[pandoc](https://github.com/jgm/pandoc)的 Haskell 库，可以在大多数标记格式之间进行转换。
虽然它不是 Java 库，但可以[通过 Java 中的 CLI 使用它](https://stackoverflow.com/a/8496537/8583692)。

您可以[从此处获取并安装最新版本](https://github.com/jgm/pandoc/releases/latest)。在此处阅读[入门指南](https://pandoc.org/getting-started.html)。

```
var command = "pandoc --to=markdown_strict --output=result.md input.html";
var pandoc = new ProcessBuilder()
        .command(command.split(" "))
        .directory(new File(".")) // Working directory
        .start();
pandoc.waitFor();
// The output result.md will be created in the working directory 
```

此工具也可[用于 GitHub Actions 工作流程](https://github.com/pandoc/pandoc-action-example)。

# captcha - 最有效的验证码形式？

> ID：59560
> 
> 赞同：17
> 
> 时间：2008-09-12T17:24:55.410
> 
> 标签：captcha

在所有可用的 CAPTCHA 形式中，哪一种是“最不容易破解”的，同时又保持相当的人类可读性？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-12T17:35:31.797

> 我相信验证码正在消亡。如果有人真的想打破它，它就会被打破。我读到（在某个地方，不记得在哪里）有一个网站为您提供免费色情内容，以换取他们回答验证码，因为它们可能会被机器人淘汰。那么，何苦呢？

任何真正想打破这把挂锁的人都可以使用一对断线钳，那么为什么要为锁而烦恼呢？
任何真正想偷这辆车的人都可以用拖车开车，所以为什么还要锁我的车呢？
任何真正想打开这个保险箱的人都可以用氧乙炔火炬将它打开，那么为什么还要费心把东西放在保险箱里呢？

因为使用挂锁、锁车、将贵重物品放入保险箱以及使用 CAPTCHA 可以清除大量相对不成熟或没有动机的攻击者。它不能阻止老练的、高度积极的攻击者这一事实并不意味着它根本不起作用。使用验证码不会阻止所有垃圾邮件发送者，但会大大减少需要过滤或人工干预的数量。

看看 Jeff 在[他的博客](http://www.codinghorror.com/blog/)上使用的蹩脚的 CAPTCHA 。即使是这样的弱屏障仍然提供了很多保护。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-12T17:31:05.927

我同意托马斯的观点。验证码即将推出。但是如果你必须使用它，[reCAPTCHA](http://www.recaptcha.net) 是一个非常好的提供者，它有一个简单的 API。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-12T17:27:50.287

我相信验证码正在消亡。如果有人真的想打破它，它就会被打破。我读到（在某个地方，不记得在哪里）有一个网站为您提供免费色情内容，以换取他们回答验证码，因为它们可能会被机器人淘汰。那么，何苦呢？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-12T17:38:52.927

如果你是一个足够小的网站，没有人会打扰。

如果您仍在寻找 CAPTCHA，我喜欢[OCR 研究团队](http://ocr-research.org.ua/index.html)的[tEABAG_3D](http://ocr-research.org.ua/teabag.html)。破解和使用您的 3D 视觉很复杂。另外，它是由为了好玩而破解验证码的人开发的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-07T07:15:28.013

如果您只是在寻找验证码以防止垃圾邮件发送者轰炸您的博客，那么最好的选择是简单但独特的东西。例如，要求将“猫”这个词写到一个盒子里。这样做的好处是没有为这个解决方案开发有针对性的验证码破解器，而且你的小博客对于某人实际开发一个来说还不够重要。几年来，我已经在我的博客上使用了这样的验证码并取得了一些成功。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-12T17:34:32.297

这些信息很难真正知道，因为我相信验证码早在任何人知道它之前就被破坏了。那些破坏他们的人有经济动机保持沉默。

我曾经和一个人一起工作，他的工作主要围绕破解 CAPTCHA 展开，我可以告诉你，目前最适合他们的是[reCAPTCHA](http://recaptcha.net/)。

现在，这是否意味着它将永远存在，请称我为怀疑论者。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-14T07:22:53.907

我想知道一种使用图片拼贴并要求人类输入他在拼贴图像中看到的内容的验证码机制是否会比文本和数字图像更防破解。想象一下，该机制将猫、杯子和汽车的图片拼接成拼贴图像，并期望人类访客勾选（复选框）猫、杯子和汽车。你认为黑客和破解者多久会想出一个算法来破解机制（即从拼贴中提取图像元素并识别每张图片所描绘的对象）......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-14T07:25:42.280

如果您愿意，可以尝试 Microsoft Research 项目 Asirra：[http: //research.microsoft.com/asirra/](http://research.microsoft.com/asirra/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-07-26T15:01:15.273

验证码，我相信在设计 UX 时应该开始认真考虑。它们很慢、很麻烦，而且用户体验很差。它们很有用，不要误会我的意思，但也许你应该考虑设计一个蜜罐。

通过在表单底部添加一个隐藏字段来创建一个蜜罐。因为垃圾邮件机器人会盲目填写页面上的所有字段，您可以进行检查：

```
If honeypotfield <> Empty Then
   "No Spam TY"
Else 
    //Proceed with the form 
End If 
```

这一直有效，直到有专门为您的网站设计的垃圾邮件机器人，因此他们可以选择填写选定的输入字段。

欲了解更多信息：[http ://haacked.com/archive/2007/09/11/honeypot-captcha.aspx/](http://haacked.com/archive/2007/09/11/honeypot-captcha.aspx/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-12T17:38:28.090

据我所知，谷歌是最好的。它还没有被计算机程序破坏。我所知道的破解者一直在做的是复制图像，然后将其发送到许多网络钓鱼网站，在那里人类解决它们以进入这些网站。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-12T17:53:03.440

现在验证码是否被破坏并不重要——[有些印度公司只处理验证码](http://ddanchev.blogspot.com/2008/08/exposing-indias-captcha-solving-economy.html)。我和小组的其他人一样说验证码正在消失。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-14T07:07:36.280

这是创建验证码的一个很酷的链接..... [http://www.codeproject.com/aspnet/CaptchaImage.asp](http://www.codeproject.com/aspnet/CaptchaImage.asp)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-01-22T15:53:47.980

只是..不要.. 不建议使用验证码有几个原因。

[http://www.interfacegeek.com/dont-ever-use-captchas/](http://www.interfacegeek.com/dont-ever-use-captchas/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-02-28T13:47:09.020

我使用[uniqpin.com](http://uniqpin.com) - 它易于使用且不会让用户烦恼。因此，机器人可以识别文本，但无法识别图像。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-07-26T14:53:06.197

**验证码的死亡可以解决任何常规验证码（包括 reCAPTCHA），但不能解决 Speedcoin 加密货币验证码。**

验证码死亡 - [http://deathbycaptcha.com](http://deathbycaptcha.com)

Speedcoin 验证码 - [http://speedcoin.co/info/captcha/Speedcoin_Captcha.html](http://speedcoin.co/info/captcha/Speedcoin_Captcha.html)

# c# - C#中的lock关键字

> ID：59590
> 
> 赞同：43
> 
> 时间：2008-09-12T17:38:49.930
> 
> 标签：c#, multithreading, design-patterns, locking

我从 MSDN 了解 lock 关键字的主要功能

> lock 语句（C# 参考）
> 
> lock 关键字通过获取给定对象的互斥锁、执行语句然后释放锁来将语句块标记为临界区。

什么时候应该使用锁？

例如，它对多线程应用程序很有意义，因为它可以保护数据。但是当应用程序不分离任何其他线程时是否有必要？

使用锁是否存在性能问题？

我刚刚继承了一个在任何地方都使用锁的应用程序，它是单线程的，我想知道我应该把它们留在里面，它们甚至是必要的吗？

请注意，这更像是一个常识性问题，应用程序速度很好，我想知道这是否是将来要遵循的良好设计模式，或者除非绝对需要，否则应该避免这种情况。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-09-12T17:49:43.557

> 什么时候应该使用锁？

应该使用锁来保护多线程代码中的共享资源。不为别的。

> 但是当应用程序不分离任何其他线程时是否有必要？

绝对不。这只是浪费时间。但是请确保您没有隐式使用系统线程。例如，如果您使用异步 I/O，您可能会收到来自随机线程的回调，而不是原始线程。

> 使用锁是否存在性能问题？

是的。它们在单线程应用程序中不是很大，但为什么要进行不需要的调用呢？

> ...如果这是一个很好的设计模式在未来[？]

随意锁定所有内容是一种糟糕的设计模式。如果您的代码被随机锁定弄得杂乱无章，然后您决定使用后台线程进行某些工作，那么您很可能会遇到死锁。在多个线程之间共享资源需要仔细设计，越能隔离棘手的部分越好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-13T04:18:13.203

这里的所有答案似乎都是正确的：锁的用处是阻止线程同时访问锁定的代码。然而，这个领域有很多微妙之处，其中之一是公共语言运行时会自动将锁定的代码块标记为**关键区域**。

代码被标记为关键的影响是，如果整个区域无法完全执行，运行时可能会认为您的整个应用程序域可能受到威胁，因此，将其从内存中卸载。引用[MSDN](http://msdn.microsoft.com/en-us/library/system.threading.thread.begincriticalregion.aspx "Thread.BeginCriticalRegion 方法 (System.Threading)")：

> 例如，考虑一个在持有锁的同时尝试分配内存的任务。如果内存分配失败，中止当前任务并不足以保证 AppDomain 的稳定性，因为域中可能还有其他任务在等待同一个锁。如果当前任务终止，其他任务可能会死锁。

因此，即使您的应用程序是单线程的，这对您来说也可能是一个危险。考虑锁定块中的一种方法会引发异常，该异常最终不会在块内处理。即使异常在调用堆栈中冒泡时得到处理，您的关键代码区域也没有正常完成。谁知道 CLR 会如何反应？

有关更多信息，请阅读[这篇关于 Thread.Abort() 的危险的文章](http://tdanecker.blogspot.com/2007/08/do-never-ever-use-threadabort.html "Thomas Danecker 的博客：永远不要使用 Thread.Abort！")。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-12T17:52:37.933

请记住，您的应用程序不像您想象的那样单线程可能是有原因的。.NET 中的异步 I/O 可以很好地回调池线程，例如，一些不同的计时器类（但不是 Windows 窗体计时器）也是如此。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-12T17:41:23.497

一般来说，如果您的应用程序是单线程的，那么您不会从 lock 语句中获得太多用处。不完全了解您的应用程序，我不知道它们是否有用 - 但我怀疑不是。此外，如果您的应用程序在任何地方都使用锁，我不知道我是否会对它在多线程环境中工作充满信心 - 原始开发人员是否*真的*知道如何开发多线程代码，或者他们只是在模糊的希望中到处添加锁定语句，这样可以解决问题吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-12T17:48:32.200

lock 应该在修改共享状态的代码周围使用，由其他线程同时修改的状态，并且那些其他线程必须采用相同的锁。

锁实际上是一个内存访问序列化器，线程（获取锁）将等待锁进入，直到当前线程退出锁，因此内存访问被序列化。

要回答您的问题，单线程应用程序中不需要锁，并且它确实具有性能副作用。因为 C# 中的锁是基于内核同步对象的，并且您使用的每个锁都会创建从用户模式到内核模式的转换。

如果您对多线程性能感兴趣，那么[MSDN 线程指南是一个不错的起点](http://msdn.microsoft.com/en-us/library/1c9txz50.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-12T17:43:40.637

您*可能*会遇到锁定变量的性能问题，但通常，您会构建代码以最小化在“锁定”代码块内花费的时间长度。

至于拆锁。这将取决于代码到底在做什么。即使它是单线程的，如果您的对象是作为单例实现的，那么您可能会有多个客户端同时使用它的实例（在内存中，在服务器上）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-12T17:44:15.630

是的，使用锁时会有一些性能损失，但通常可以忽略不计。

使用锁（或任何其他互斥语句或构造）通常只在多线程场景中需要，其中多个线程（您自己创建或来自您的调用者）有机会与对象交互并更改底层状态或数据保持。例如，如果您有一个可以被多个线程访问的集合，您不希望一个线程在另一个线程试图读取它时通过删除一个项目来更改该集合的内容。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-12T17:46:06.747

Lock(token) 仅用于标记不应在多个线程中同时运行的一个或多个代码块。如果您的应用程序是单线程的，那么它可以防止出现不存在的情况。

锁定确实会导致性能下降，在执行代码之前添加指令以检查同时访问。它只应在必要时使用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-12T20:08:25.860

请参阅C# 中有关“互斥”的[问题。](https://stackoverflow.com/questions/34524/what-is-a-mutex)然后看看[这](https://stackoverflow.com/questions/42505/thread-safe-use-of-a-singletons-members) [两个](https://stackoverflow.com/questions/41792/instance-constructor-sets-a-static-member-is-it-thread-safe)关于使用'lock(Object)'语句的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-12T17:42:35.820

如果只有一个线程，那么在应用程序中加锁是没有意义的，是的，它会影响性能，尽管确实需要相当多的调用才能使该命中累积成重要的东西。

# asp-classic - VBScript conditional short-circuiting workaround

> ID：59599
> 
> 赞同：15
> 
> 时间：2008-09-12T17:42:05.417
> 
> 标签：asp-classic, vbscript

I have a large classic ASP app that I have to maintain, and I repeatedly find myself thwarted by the lack of short-circuit evaluation capability. E.g., VBScript won't let you get away with:

```
if not isNull(Rs("myField")) and Rs("myField") <> 0 then
... 
```

...because if Rs("myField") is null, you get an error in the second condition, comparing null to 0\. So I'll typically end up doing this instead:

```
dim myField
if isNull(Rs("myField")) then 
    myField = 0
else
    myField = Rs("myField")
end if

if myField <> 0 then
... 
```

Obviously, the verboseness is pretty appalling. Looking around this large code base, the best workaround I've found is to use a function the original programmer wrote, called TernaryOp, which basically grafts in ternary operator-like functionality, but I'm still stuck using a temporary variable that would not be necessary in a more full-featured language. Is there a better way? Some super-secret way that short-circuiting really does exist in VBScript?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-12T17:45:12.770

Nested IFs (only slightly less verbose):

```
if not isNull(Rs("myField")) Then
   if Rs("myField") <> 0 then 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-12T17:50:44.553

Maybe not the best way, but it certainly works... Also, if you are in vb6 or .net, you can have different methods that cast to proper type too.

```
if cint( getVal( rs("blah"), "" ) )<> 0 then
  'do something
end if

function getVal( v, replacementVal )
  if v is nothing then
    getVal = replacementVal
  else
    getVal = v
  end if
end function 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-12T18:26:33.780

I always used Select Case statements to short circuit logic in VB. Something like..

```
Select Case True

Case isNull(Rs("myField"))

    myField = 0

Case (Rs("myField") <> 0)

    myField = Rs("myField")

Case Else

    myField = -1        

End Select 
```

My syntax may be off, been a while. If the first case pops, everything else is ignored.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-03-22T01:37:15.290

If you write it as two inline `IF` statements, you can achieve short-circuiting:

```
if not isNull(Rs("myField")) then if Rs("myField") <> 0 then ... 
```

But your `then` action must appear on the same line as well. If you need multiple statements after `then`, you can separate them with `:` or move your code to a subroutine that you can call. For example:

```
if not isNull(Rs("myField")) then if Rs("myField") <> 0 then x = 1 : y = 2 
```

Or

```
if not isNull(Rs("myField")) then if Rs("myField") <> 0 then DoSomething(Rs("myField")) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-26T13:42:35.917

Or perhaps I got the wrong end of the question. Did you mean something like `iIf()` in VB? This works for me:

```
myField = returnIf(isNothing(rs("myField")), 0, rs("myField")) 
```

where `returnIf()` is a function like so:

```
function returnIf(uExpression, uTrue, uFalse)
    if (uExpression = true) then returnIf = uTrue else returnIf = uFalse : end if
end function 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-12T17:58:59.867

Yeah it's not the best solution but what we use is something like this

```
function ReplaceNull(s)
    if IsNull(s) or s = "" then
        ReplaceNull = "&nbsp;"
    else
        ReplaceNull = s
    end if
end function 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-12T17:49:35.677

Would that there were, my friend -- TernaryOp is your only hope.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-26T13:36:34.853

Two options come to mind:

1) use `len()` or `lenb()` to discover if there is any data in the variable:

```
if not lenb(rs("myField"))=0 then... 
```

2) use a function that returns a boolean:

```
if not isNothing(rs("myField")) then... 
```

where `isNothing()` is a function like so:

```
function isNothing(vInput)
    isNothing = false : vInput = trim(vInput)
    if vartype(vInput)=0 or isEmpty(vInput) or isNull(vInput) or lenb(vInput)=0 then isNothing = true : end if 
end function 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-13T14:11:07.010

You may be able to just use `Else` to catch nulls, ""s, etc.

```
If UCase(Rs("myField")) = "THING" then
  'Do Things
elseif UCase(Rs("myField")) = "STUFF" then
  'Do Other Stuff
else
  'Invalid data, such as a NULL, "", etc.
  'Throw an error, do nothing, or default action
End If 
```

I've tested this in my code and it's currently working. Might not be right for everyone's situation though.

# .net - 使用 .Net 中的 ActiveX 控件检测应用程序挂起

> ID：59622
> 
> 赞同：2
> 
> 时间：2008-09-12T17:53:07.433
> 
> 标签：.net, activex

我正在升级屏幕抓取应用程序。我们正在使用 ActiveX 控件从 IBM 大型机中抓取屏幕。大型机程序经常挂起并使 ActiveX 控件崩溃，从而导致我们的应用程序崩溃。我们无权访问大型机或 ActiveX 源代码。我们不会编写自己的活动 x 控件。

封装 ActiveX 控件以检测应用程序与控件一起挂起以便我们可以终止进程并使用代码重新启动的最糟糕的方法是什么？

我应该创建 2 个单独的应用程序吗？一个作为控制器检查另一个并在进程挂起时终止/重新启动进程？

他们必须在不同的应用程序域上吗？即使它们位于不同的应用程序域中，是否可以让两个程序相互通信？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-12T18:01:22.623

您可以使用 System.Diagnostics.Process.Start() 启动可执行文件。这将返回一个带有 Responding 属性的 Process 对象，您可以使用该属性定期检查进程是否仍处于活动状态。

不过，您需要两个单独的应用程序来执行此操作。并且您正在监视的应用程序需要有一个主窗口，因为监视通过检查应用程序是否仍在处理来自主窗口消息队列的消息来工作。这与 Windows 知道将“不响应”添加到窗口标题的方式相同

# linux - 当我安装 linux 时，如何确定我的特定计算机是否会出现问题？

> ID：59627
> 
> 赞同：1
> 
> 时间：2008-09-12T17:57:10.073
> 
> 标签：linux, installation, drivers

IT女士刚刚给了我一台笔记本电脑让我保留！

我一直想安装 Linux 来玩，所以我做的第一件事是在 stackoverflow 中搜索 Linux Distro 建议并在[这里](https://stackoverflow.com/questions/659/what-is-your-preferred-linux-distribution#6730)找到它。然而，他们还提到，您应该四处搜索，看看是否有人对您的驱动程序和该发行版有任何问题。现在我只知道这是东芝 Tecra A5 - 我什至还没有启动它，但是当我这样做时，我应该如何研究驱动程序是否与 Ubuntu 或我选择使用的任何东西兼容？我应该只搜索 Ubunto+DriverName 还是有更好的资源？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-12T18:00:49.020

许多发行版，包括 Ubuntu，都有“实时”模式。您下载 .iso 映像，刻录 CD，然后从 CD 启动。操作系统将直接从 CD 上运行，无需安装任何东西。它将运行缓慢，因为它是从 CD 读取的，但它应该让您有机会测试您的硬件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-12T18:01:29.113

你可以试试[Linux-On-Laptops](http://www.linux-on-laptops.com)。快速搜索显示此[Tecra A5](http://cuentame.algocorto.com/linux/ubuntu-dapper-tecra-a5.html)。

您还可以下载 LiveCD 版本，它会告诉您是否可以让大部分硬件轻松工作。如果 LiveCD 能正常工作，那就太好了。如果没有，您可以将其从 cd-rom 驱动器中弹出。没有伤害，您可以查看其他选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T18:01:04.620

就个人而言，我不会担心...如果您进行双启动（我推荐），那么您可以轻松地回退到 Windows（或安装的任何东西）。

我已经设置了 3 台带有 linux 的笔记本电脑，2 台 Ubuntu 和 1 台 Fedora 8。其中 2 台出现了无线网卡问题，2 台出现了视频卡问题（1 台更容易修复）。在这两种情况下，我都能通过足够的谷歌搜索来解决问题...... Ubuntu 论坛特别擅长解决您可能面临的问题。

所以...解决您遇到的问题可能需要一些工作，但是通过足够的努力，您应该能够克服这些问题（顺便说一下，努力可能会很高...我花了大约一周的空闲尝试解决第一个无线网卡问题）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-12T18:01:23.670

我喜欢[笔记本电脑上的 Linux，](http://www.linux-on-laptops.com/)你选择笔记本电脑，他们推荐最好的发行版。数据有时有些过时，所以我建议获取他们推荐的品牌的最新发行版。对于[您的笔记本](http://cuentame.algocorto.com/linux/ubuntu-dapper-tecra-a5.html)，他们推荐[Ubuntu](http://www.ubuntu.com)。另一种选择是尝试现场 CD。许多发行版都有它们，包括 Ubuntu。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T17:58:58.293

我会（至少）看这两个地方：

[http://www.linuxcompatible.org/compatibility.html](http://www.linuxcompatible.org/compatibility.html)

[http://www.linux-drivers.org/](http://www.linux-drivers.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-12T18:05:02.257

大多数 Linux 发行版都有 Live CD，可让您在实际安装之前运行操作系统。这就是我找到可以在我的笔记本电脑（Ubuntu）上运行的 Linux 发行版的方式。如果您的笔记本电脑较旧并且您担心它无法处理现代 Linux 桌面，请查看像 Xubuntu、Slax、Damn Small Linux、Puppy Linux 等发行版，因为它们附带的桌面不是资源密集型.

# asp.net - AJAX 部分页面加载？

> ID：59628
> 
> 赞同：1
> 
> 时间：2008-09-12T17:57:51.790
> 
> 标签：asp.net, ajax

我有一个页面结果页面（您在其他地方提交搜索查询后到达那里），其中包含针对不同类型数据对象的一大堆网格视图。

显然，一些查询比其他查询花费更长的时间。如何在每个 gridview 获得所需数据后立即渲染？

这对我来说很棘手，因为它必须在回发和页面加载上工作。此外，对象数据源只是在页面加载/回发时自动触发；我没有以编程方式调用任何方法来获取数据。我必须改变这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-12T18:38:10.990

@加雷斯詹金斯

该页面将在返回第一个更新面板之前执行所有查询，因此他不会在那里节省任何时间。

这样做的诀窍是将每个复杂的网格视图移动到用户控件中，在用户控件中，摆脱 Object DataSource 废话，并在后面的代码中进行绑定。

编写绑定代码，使其仅在这种情况下绑定：

```
if (this.isPostBack && ScriptManager.IsInAsyncPostback) 
```

然后，在页面中，在页面加载后使用 javascript 以编程方式刷新更新面板，一旦准备好，您将获得每个单独的 gridview 渲染。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T18:10:44.910

您能否将 DataGrids 放在其可见性设置为 false 的面板中，然后从主体的 onload 事件调用客户端 javascript 函数，该事件调用将面板的可见性设置为 true 的服务器端函数？

如果你将它与一个 asp:updateProgress 控件结合起来，并将整个东西包装在一个 UpdatePanel 中，你应该得到一些接近你正在寻找的东西 - 特别是如果你将 onload 中调用的 js 函数操纵为只显示一个面板并调用显示下一个等的返回函数。

# c++ - 应用程序不能与 VS 2008 SP1 DLL 一起运行，以前的版本适用于 RTM 版本

> ID：59635
> 
> 赞同：37
> 
> 时间：2008-09-12T17:59:53.767
> 
> 标签：c++, visual-studio-2008, mfc

自从我们从 Visual Studio 6 切换到 Visual Studio 2008 以来，我们一直在使用 MFC90.dll 和 msvc[pr]90.dll 以及私有并排配置中的清单文件，以免担心版本或将它们安装到系统中。

在 SP1 之前，它运行良好（在我们的开发人员机器上仍然运行良好）。既然我们已经在 SP1 后进行了一些测试，我从昨天早上开始就一直在拔头发。

首先，我们的 NSIS 安装程序脚本从 redist 文件夹中提取 dll 和清单文件。这些不再正确，因为该应用程序仍链接到 RTM 版本。

因此，我将定义添加`_BIND_TO_CURRENT_VCLIBS_VERSION=1`到我们所有的项目中，以便他们将使用 redist 文件夹中的 SP1 DLL（或在新服务包出现时使用后续的）。我花了几个小时才找到这个。

我已经从编译中仔细检查了中间文件文件夹中生成的清单文件，它们正确列出了 9.0.30729.1 SP1 版本。我已经两次和三次检查取决于一台干净的机器：它都链接到本地​​ dll，没有错误。

运行应用程序仍然会出现以下错误：

> > 应用程序未能正确初始化 (0xc0150002)。单击确定以终止应用程序。

我在 google 或 microsoft 上进行的搜索都没有找到与我的具体问题相关的任何内容（但有回溯到 2005 年的此错误消息）。

有人对 SP1 有过类似的问题吗？

选项：

*   找到问题并修复它，使其正常工作（首选）
*   安装redist
*   挖出旧的 RTM dll 和清单文件并删除 #define 以使用当前的。（我在较早的安装程序版本中得到了它们，因为 Microsoft 将它们从您的 redist 文件夹中删除！）

**编辑：**我尝试在关闭定义的情况下重新构建（链接到 RTM dll），只要 RTM dll 安装在文件夹中，它就可以工作。如果将 SP1 dll 放入，则会收到以下错误：

> c:\Program Files\...\...\X.exe
> 
> 此应用程序无法启动，因为应用程序配置不正确。重新安装应用程序可能会解决此问题。

没有其他人必须处理这个问题吗？

**编辑：**只是为了笑，我在我的测试机器上下载并运行了 VS2008SP1 的 vcredist_x86.exe。***它***有效。使用 SP1 DLL。还有我的 RTM 链接应用程序。但**不是**在 SP1 之前工作的私有并行分发中。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-09-16T09:47:15.053

上周我自己也解决了这个问题，现在我认为自己有点专家了；）

我 99% 确定并非所有 dll 和静态库都使用 SP1 版本重新编译。你需要把

```
#define _BIND_TO_CURRENT_MFC_VERSION 1
#define _BIND_TO_CURRENT_CRT_VERSION 1 
```

进入您正在使用的*每个项目。*对于每个实际大小的项目，很容易忘记一些没有重新编译的小库。

还有更多的标志来定义要绑定的版本；它记录在[http://msdn.microsoft.com/en-us/library/cc664727%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/cc664727%28v=vs.90%29.aspx)上。作为上述行的替代方案，您还可以将

```
#define _BIND_TO_CURRENT_VCLIBS_VERSION 1 
```

它将绑定到所有 VC 库（CRT、MFC、ATL、OpenMP）的最新版本。

然后，检查嵌入式清单的内容。下载 XM 资源编辑器：http: [//www.wilsonc.demon.co.uk/d10resourceeditor.htm](http://www.wilsonc.demon.co.uk/d10resourceeditor.htm)。打开解决方案中的每个 dll 和 exe。查看“XP 主题清单”。检查右侧的“版本”属性是否为“9.0.30729.1”。如果是“9.0.21022”，则某些静态库正在拉入旧版本的清单。

我发现，在许多情况下，*这两个*版本都包含在清单中。这意味着一些库使用 sp1 版本而其他库不使用。

调试哪些库没有设置预处理器指令的好方法：临时修改平台头文件，以便在尝试嵌入旧清单时停止编译。打开 C:\Program Files\Microsoft Visual Studio 9.0\VC\crt\include\crtassem.h。搜索“21022”字符串。在该定义中，放置一些无效的内容（将“定义”更改为“blehbleh”左右）。这样，当您编译一个`_BIND_TO_CURRENT_CRT_VERSION`未设置预处理器标志的项目时，您的编译将停止，您将知道您需要添加它们或确保它适用于任何地方。

还要确保使用 Dependency Walker，这样您就知道要提取哪些 dll。在虚拟机上安装没有更新（仅 SP2）的全新 Windows XP 副本是最简单的。通过这种方式，您可以确定 SxS 文件夹中没有任何内容正在使用，而不是您提供的并排 dll。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-01-28T08:06:02.030

要理解这个问题，我认为重要的是要意识到**涉及四个版本号**：

*   (A) .exe 编译到的 VC 头文件的版本。
*   (B) 该 .exe 的资源部分中嵌入的清单文件的版本。默认情况下，此清单文件由 Visual Studio 自动生成。
*   (C) 您复制到与 .exe 相同的目录中的 VC .DLL（并行程序集的一部分）的版本。
*   (D) 您复制到与 .exe 相同的目录中的 VC 清单文件（并行程序集的一部分）的版本。

有两个版本的 VC 2008 DLL 正在运行：

*   v1：9.0.21022.8
*   v2：9.0.30729.4148

为清楚起见，我将使用 v1/v2 表示法。下表显示了一些可能的情况：

```
Situation | .exe (A) | embedded manifest (B) | VC DLLs (C) | VC manifests (D)
-----------------------------------------------------------------------------
1         | v2       | v1                    | v1          | v1         
2         | v2       | v1                    | v2          | v2          
3         | v2       | v1                    | v2          | v1
4         | v2       | v2                    | v2          | v2 
```

在干净的 Vista SP1 安装上运行 .exe 时，这些情况的结果是：

*   情况1：弹出一个窗口，说：“程序入口点XYZXYZ不能位于动态链接库中”。

*   情况 2：运行 .exe 时似乎没有发生任何事情，但在 Windows 的“事件查看器/应用程序日志”中记录了以下事件：

    “C:\Path\file.exe”的激活上下文生成失败。清单或策略文件“C:\Path\Microsoft.VC90.CRT.MANIFEST”在第 4 行出现错误。在清单中找到的组件标识与标识不匹配请求的组件。参考是 Microsoft.VC90.CRT,processorArchitecture="x86",publicKeyToken="1fc8b3b9a1e18e3b",type="win32",version="9.0.21022.8"。定义是微软

*   情况3：一切似乎都很好。这是[remicles2 的解决方案](https://stackoverflow.com/questions/59635/app-does-not-run-with-vs-2008-sp1-dlls-previous-version-works-with-rtm-versions/1567715#1567715)。

*   情况4：[应该这样做](https://stackoverflow.com/questions/59635/app-does-not-run-with-vs-2008-sp1-dlls-previous-version-works-with-rtm-versions/70808#70808)。遗憾的是，正如 Roel 所指出的，实施起来可能相当困难。

现在，我的情况（我认为它与[crashmstr's](https://stackoverflow.com/users/1441/crashmstr)相同）是 nr 1。问题是 Visual Studio 出于某种原因为 v2 生成客户端代码 (A)，但出于某种原因，生成了 v1 清单文件 (B)。我不知道可以在哪里配置版本 (A)。

**请注意**，这整个解释仍然是在[私有程序集](http://msdn.microsoft.com/en-us/library/aa375674%28VS.85%29.aspx)的上下文中。

**更新**：终于我开始明白发生了什么。显然，[Visual Studio 默认为 v2 生成客户端代码 (A)](https://stackoverflow.com/questions/2289593/how-to-select-the-version-of-the-vc-2008-dlls-the-application-should-be-linked-to/2289740#2289740)，这与我在一些 Microsoft 博客上读到的相反。_BIND_TO_CURRENT_VCLIBS_VERSION 标志只选择生成的清单文件 (B) 中的版本，但在运行应用程序时会忽略此版本。

## 结论

默认情况下，由 Visual Studio 2008 编译的 .exe 链接到最新版本的 VC90 DLL。您可以[使用 _BIND_TO_CURRENT_VCLIBS_VERSION 标志](https://stackoverflow.com/questions/59635/app-does-not-run-with-vs-2008-sp1-dlls-previous-version-works-with-rtm-versions/70808#70808)来控制将在清单文件中生成哪个版本的 VC90 库。这确实避免了您收到错误消息“清单与请求的组件的身份不匹配”的情况 2。它还解释了为什么情况 3 工作正常，因为即使没有 _BIND_TO_CURRENT_VCLIBS_VERSION 标志，应用程序也链接到最新版本的 VC DLL。

对于运行 vcredist 并将 VC 9.0 DLL 放在 Windows SxS 目录中的公共并行程序集，情况就更加奇怪了。即使 .exe 的清单文件声明应使用旧版本的 DLL（这是未设置 _BIND_TO_CURRENT_VCLIBS_VERSION 标志的情况），Windows默认**忽略**此版本号！相反，Windows 将使用系统上存在的较新版本，除非[使用“应用程序配置文件”](https://stackoverflow.com/questions/2289593/how-to-select-the-version-of-the-vc-2008-dlls-the-application-should-be-linked-to/2289740#2289740)。

我是唯一一个认为这很混乱的人吗？

**总而言之**：_

*   *对于私有程序集，请在 .exe 的项目和所有*依赖的 .lib 项目中使用 _BIND_TO_CURRENT_VCLIBS_VERSION 标志。
*   对于公共程序集，这不是必需的，因为 Windows 会自动从 SxS 目录中选择正确版本的 .DLL。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-16T14:04:12.660

我只记得我用来找出哪些静态库行为不端的另一个技巧：通过字符串“21022”的静态库进行“grep”。但是，不要使用像wingrep 这样的“普通” grep 工具，因为它们不会向您显示这些字符串（他们认为这是一个二进制文件并查找原始的非Unicode 字符串）。使用资源工具包中的“字符串”实用程序（我认为现在在 Russinovich 站点中）。那将通过二进制文件进行 grep 确定。因此，您让这些“字符串”遍历整个源代码树，您将看到包含对错误清单（或其中包含错误版本的清单）的引用的二进制文件（dll 和静态库）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-10-14T17:17:14.450

另一个查看 exe 和 dll 清单的好工具是[Manifest View](http://weblogs.asp.net/kennykerr/archive/2007/07/10/manifest-view-1-0.aspx)，它不能在 XP 的全新安装上运行，因为*它*依赖于 9.0.21022。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-14T17:13:33.317

对于您的第三个选项，您可能可以在开发机器上的 C:\WINDOWS\WinSxS 目录中找到 9.0.21022 版本的 DLL 和清单。如果可以，那么您可以设置自己的 redist 目录并使用您的应用程序安装这些文件。

或者，您可以使用随 Visual Studio 提供的 9.0.30729.1 并伪造您随应用安装的清单，以报告它提供 9.0.21022 DLL，而不是 9.0.30729.1。运行时链接器似乎并不介意。有关更多信息，请参阅这个对解决这些问题非常有帮助的[博客。](http://blog.kalmbach-software.de/2009/05/27/deployment-of-vc2008-apps-without-installing-anything/)

两种解决方法都解决了我在使用 VS2008 Express 将 DLL 部署为私有程序集时遇到的问题。

Roel 的答案是您的第一个选项（“正确修复”），但如果您依赖依赖于 9.0.21022 的库（因此您的清单列出了两个版本），那么第三个选项可能是唯一的如果您不想运行 vcredist_x86.exe，可以走的路。

# compact-framework - 确定已安装的 Compact Framework（和 SP）版本

> ID：59642
> 
> 赞同：2
> 
> 时间：2008-09-12T18:03:47.203
> 
> 标签：compact-framework

确定通过 .NET 应用程序在设备上安装哪个版本的 .NET Compact Frameworks（包括 Service Pack）的最佳方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-14T13:10:37.000

根据 Scott 的链接，有关当前 CF 版本的信息可以在设备的注册表中找到：

```
HKEY_LOCAL_MACHINE\Software\Microsoft\.NETCompactFramework 
```

CF 2.0 的版本是：

```
CompactFrameworks 2.0 RTM - 2.0.5238.00
CompactFrameworks 2.0 SP1 - 2.0.6129.00
CompactFrameworks 2.0 SP2 - 2.0.7045.00 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T18:08:23.900

Neil Cowburn[在他的博客上](http://blog.opennetcf.com/ncowburn/2007/08/22/HOWTODeterminingTheNETCompactFrameworkVersion.aspx)维护了一份相当不错的所有版本号列表。截至目前，列表如下所示：

```
版本发布
---------- ------------------
1.0.2268.0 1.0 RTM
1.0.3111.0 1.0 SP1
1.0.3226.0 1.0 SP2（召回）
1.0.3227.0 1.0 SP2 测试版
1.0.3316.0 1.0 SP2 RTM
1.0.4177.0 1.0 SP3 测试版
1.0.4292.0 1.0 SP3 RTM
2.0.4037.0 2.0 五月 CTP
2.0.4135.0 2.0 测试版 1
2.0.4317.0 2.0 十一月 CTP
2.0.4278.0 2.0 十二月 CTP
2.0.5056.0 2.0 测试版 2
2.0.5238.0 2.0 RTM
2.0.6103.0 2.0 SP1 测试版
2.0.6129.0 2.0 SP1 RTM
2.0.7045.0 2.0 SP2 RTM
3.5.7066.0 3.5 测试版 1
3.5.7121.0 3.5 测试版 2
3.5.7283.0 3.5 RTM

```

# python - 在 Python 中存储多个数组

> ID：59648
> 
> 赞同：3
> 
> 时间：2008-09-12T18:09:02.590
> 
> 标签：python, arrays

我正在编写一个程序来模拟 Gallup 或 Rasmussen 等公司每天发布的实际投票数据：www.gallup.com 和 www.rassmussenreports.com

我正在使用蛮力方法，计算机生成一些随机的每日民意调查数据，然后计算三天的平均值，以查看随机数据的平均值是否与民意调查人数匹配。（大多数公司的民意调查数字是三天的平均值）

目前，它在一次迭代中运行良好，但我的目标是让它产生与平均轮询数据匹配的最常见的模拟。然后，我可以更改从 1 到 1000 次迭代的任何代码。

这是我的问题。在测试结束时，我在单个变量中有一个数组，看起来像这样：

```
[40.1, 39.4, 56.7, 60.0, 20.0 ..... 19.0] 
```

该程序当前为每个正确的模拟生成一个数组。*我可以将每个数组存储在一个变量中，但是我必须有一个程序可以根据我请求的迭代次数生成 1 到 1000 个变量！？*

我该如何避免这种情况？我知道有一种智能方法可以做到这一点，它不需要程序根据我想要的模拟次数生成变量来存储数组。

McCain 的代码测试：

```
 test = [] 

while x < 5: 

   test = round(100*random.random())

   mctest.append(test) 

   x = x +1 

mctestavg = (mctest[0] + mctest[1] + mctest[2])/3 

#mcavg is real data

if mctestavg == mcavg[2]: 
  mcwork = mctest 
```

如何在不创建多个 mcwork 变量的情况下重复？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-12T18:14:01.360

你是在谈论这样做吗？

```
>>> a = [ ['a', 'b'], ['c', 'd'] ]
>>> a[1]
['c', 'd']
>>> a[1][1]
'd' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-12T19:08:38.827

像这样的东西会起作用吗？

```
from random import randint    

mcworks = []

for n in xrange(NUM_ITERATIONS):
    mctest = [randint(0, 100) for i in xrange(5)]
    if sum(mctest[:3])/3 == mcavg[2]:
        mcworks.append(mctest) # mcavg is real data 
```

最后，您会得到一个有效列表的`mctest`列表。

我改变了什么：

*   使用[列表推导](http://docs.python.org/tut/node7.html#SECTION007140000000000000000)来构建数据而不是 for 循环
*   用于`random.randint`获取随机整数
*   使用[切片](http://docs.python.org/tut/node5.html)并`sum`计算前三项的平均值
*   （回答您的实际问题:-)）将结果放入列表中`mcworks`，而不是为每次迭代创建一个新变量

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T18:14:04.060

python 中的列表可以包含任何类型的对象——如果我正确理解了这个问题， a `list`of `list`s 会完成这项工作吗？像这样的东西（假设你有一个`generate_poll_data()`创建数据的函数：

```
data = []

for in xrange(num_iterations):
    data.append(generate_poll_data()) 
```

然后，`data[n]`将是`(n-1)`第一次运行的数据列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-12T18:31:04.860

由于您正在考虑*变量*，因此您可能更喜欢字典而不是列表：

```
data = {}
data['a'] = [generate_poll_data()]
data['b'] = [generate_poll_data()] 
```

等等

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-12T19:01:00.873

我会强烈考虑使用[NumPy](http://numpy.scipy.org)来做到这一点。您可以获得可以快速轻松地处理的高效 N 维数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-20T07:54:33.923

一种巧妙的方法是将列表与 Pandas 结合使用。然后您就可以创建一个 3 天的滚动平均值。这使得搜索结果变得容易，只需将真实的结果添加为另一列，并使用 loc 函数查找匹配的结果。

```
rand_vals = [randint(0, 100) for i in range(5))]
df = pd.DataFrame(data=rand_vals, columns=['generated data'])
df['3 day avg'] = df['generated data'].rolling(3).mean()
df['mcavg'] = mcavg # the list of real data
# Extract the resulting list of values
res = df.loc[df['3 day avg'] == df['mcavg']]['3 day avg'].values 
```

如果您打算对不同的民意调查/人员使用相同的随机值，这也很简洁，只需添加另一列及其真实值并对其执行相同的搜索。

# asp.net - 来自存储过程的 ASP.NET 中的默认整数类型

> ID：59651
> 
> 赞同：0
> 
> 时间：2008-09-12T18:10:16.470
> 
> 标签：asp.net, sql-server, stored-procedures, parameters

我有一个连接到[存储过程](http://en.wikipedia.org/wiki/Stored_procedure)的网页。在这个 SQL 数据源中，我有一个参数，我将其传递回 int 类型的存储过程。

[ASP.NET](http://en.wikipedia.org/wiki/ASP.NET)似乎希望默认为*int32*，但该数字不会高于 6。是否可以覆盖 ASP.NET 默认值并输入 16 或者在未来的某个地方会出现冲突？

规范：数据库字段的长度为 4，精度为 10，如果这对答案有影响的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-12T18:23:10.463

例如，如果您将其强制为一个字节并且该数字超过 255，则您将面临转换错误的风险（并且将引发异常）。但是，如果您知道它不会高于 6，那应该不是问题。

如果是我，我只会将它用作普通的 int，我不确定你是否可以通过将其设为一个字节来节省多少字节。抛出异常的风险太高，如果将其变小，您将失去所有好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T18:26:41.330

坚持使用 int32。无论如何，这就是 vb 的“整数”和 SQL 的 INT。

通过使用 tinyint/byte 或 short/int16 而不是 int/int32，您不会获得任何显着的性能改进。

事实上，未来您可能会遇到的头疼问题是您可能必须为期望 int32 的对象执行所有强制转换，这会让您发疯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T18:26:53.030

当您说 DB 字段的长度为 4 时，这意味着 4 个字节，相当于 Int32（4 个字节 = 32 位）。这就是为什么您的列作为 int32 返回的原因。

SQL Server 中有不同的[整数数据类型](http://msdn.microsoft.com/en-us/library/ms187745.aspx)——如果你确定数字不会超过 6，你应该将数据库中的列声明为“tinyint”，它使用单个字节并且可以保存从 0 到255\. 然后 SQL 数据源应将其转换为“字节”数据类型，这对您的目的来说是可以的。

CLR "byte" == SQL "tinyint" (1 字节) CLR "Short" (或 int16) == SQL "smallint" (2 bytes) CLR "int32" == SQL "int"

编辑：仅仅因为你可以做某事，并不意味着你应该——我同意[Michael Haren](https://stackoverflow.com/questions/59651#59695)的观点，管理这些不太常见的数据类型的开发头痛超过了你将获得的少量性能提升，除非你正在处理非常高性能软件（在这种情况下，您为什么要使用 ASP.NET？）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-12T18:27:09.550

在 ASP 端使用 Int16 并没有节省多少。它最终仍然必须将其加载到 32 位寄存器中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-12T18:28:31.263

仅供参考，无论如何，CLR 在内部都将 int 映射到 Int32。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-12T18:30:26.220

使用您的[SQL Server](http://en.wikipedia.org/wiki/Microsoft_SQL_Server)存储过程定义的任何内容。如果它`int`在 SQL Server 中，则在 .NET 中使用 Int32。SQL 中的 smallint 是`int16`.

否则，SQL Server 将自动对其进行上转换，或者在需要下转换时抛出错误。

# silverlight - 数据绑定时获取 Listbox 的 ItemContainer

> ID：59653
> 
> 赞同：1
> 
> 时间：2008-09-12T18:11:28.497
> 
> 标签：silverlight

有没有办法获取列表框中所选项目的 ItemContaner？在 Silverlight 2.0 Beta 1 中我可以，但容器隐藏在 Silverlight 2.0 的 Beta 2 中。

当未选择特定大小以及选择可变大小时，我正在尝试调整列表框项目的大小。我还想获取动画所选项目的相对位置。增长到可变大小并获得相对热情是我需要进入列表框项目的原因。

我应该澄清我没有明确地将项目添加到列表框中。我在 xaml 和 DataTemplates 中使用数据绑定。我无法访问的是所选项目的 DataTemplate 的 ItemContainer。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T12:40:22.397

有一种方法可以获取包含项目的 UIElement 和项目到 UIElements 的映射的 Panel。您必须从 ListBox 继承（这实际上适用于任何 ItemsControl）并覆盖 PrepareContainerForItemOverride：

```
protected override void PrepareContainerForItemOverride(DependencyObject element, object item)
    {
        base.PrepareContainerForItemOverride(element, item);
        var el = element as FrameworkElement;
        if (el != null)
        {
            // here is the elements's panel:
            _itemsHost = el.Parent as Panel;

            // item is original item inserted in Items or ItemsSource
            // we can save the mapping between items and FrameworElements:
            _elementMapping[item] = el;
        }
    } 
```

这有点骇人听闻，但效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T19:57:37.480

If you are adding non-UI elements to the listbox (such as strings or non-UI data objects), then this is probably pretty difficult. However if you wrap your items in some sort of FrameworkElement-derived object before adding them to the listbox, you can use TransformToVisual to get the relative size and use Height and Width to set the size of the item.

In general you can wrap your objects in a ContentControl like the following. Instead of:

```
_ListBox.Items.Add(obj0);
_ListBox.Items.Add(obj1); 
```

Do this:

```
_ListBox.Items.Add(new ContentControl { Content = obj0 });
_ListBox.Items.Add(new ContentControl { Content = obj1 }); 
```

Now when you get _ListBox.SelectedItem you can cast it to ContentControl and set the size and get the relative position. If you need the original object, simply get the value of the item's Content property.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-30T22:17:53.293

看来您可以使用相对绑定从 ItemTemplate 获取 Item Container。

```
<TextBlock YourTargetProperty="{Binding RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type ListBoxItem}}, Mode=OneWay, Path=YourSourceProperty}" /> 
```

我在[这里](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/fbe80312-67aa-42ca-bd99-89b6d79e06ae)找到了这个解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T04:14:18.370

Silverlight 5 的更新。

```
 <ListBox ItemsSource="{Binding Properties}">
                 <ListBox.ItemTemplate>
                    <DataTemplate>
                       <TextBlock Text="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=ListBoxItem}}" />
                    </DataTemplate>
                 </ListBox.ItemTemplate> 
```

现在支持RelativeSource AncestorType，使这变得更加容易。

# xml - 如何为 XML 方法设置 Rails 集成测试？

> ID：59655
> 
> 赞同：12
> 
> 时间：2008-09-12T18:11:42.817
> 
> 标签：xml, ruby, integration-testing

给定一个控制器方法，如：

```
def show
  @model = Model.find(params[:id])

  respond_to do |format|
    format.html # show.html.erb
    format.xml  { render :xml => model }
  end
end 
```

编写断言返回具有预期 XML 的集成测试的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-13T15:43:54.037

在集成测试中结合使用 format 和 assert_select 效果很好：

```
class ProductsTest < ActionController::IntegrationTest
  def test_contents_of_xml
    get '/index/1.xml'
    assert_select 'product name', /widget/
  end
end 
```

有关更多详细信息，请查看Rails 文档中的[assert_select](http://apidock.com/rails/ActionController/Assertions/SelectorAssertions/assert_select)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-13T02:08:04.810

这是测试来自控制器的 xml 响应的惯用方式。

```
class ProductsControllerTest < ActionController::TestCase
  def test_should_get_index_formatted_for_xml
    @request.env['HTTP_ACCEPT'] = 'application/xml'
    get :index
    assert_response :success
  end
end 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-08-20T15:10:00.973

ntalbott 的回答显示了一个 get 操作。发布动作有点棘手；如果您想将新对象作为 XML 消息发送，并让 XML 属性显示在控制器的 params 散列中，则必须正确设置标题。这是一个示例（Rails 2.3.x）：

```
class TruckTest < ActionController::IntegrationTest
  def test_new_truck
    paint_color = 'blue'
    fuzzy_dice_count = 2
    truck = Truck.new({:paint_color => paint_color, :fuzzy_dice_count => fuzzy_dice_count})
    @headers ||= {}
    @headers['HTTP_ACCEPT'] = @headers['CONTENT_TYPE'] = 'application/xml'
    post '/trucks.xml', truck.to_xml, @headers
    #puts @response.body
    assert_select 'truck>paint_color', paint_color
    assert_select 'truck>fuzzy_dice_count', fuzzy_dice_count.to_s
  end
end 
```

您可以在这里看到 post 的第二个参数不必是参数哈希；**如果**标题正确，它可以是一个字符串（包含 XML） 。第三个论点，@headers，是我经过大量研究才弄清楚的部分。

（还要注意在 assert_select 中比较整数值时使用 to_s。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T01:47:12.373

这两个答案很好，除了我的结果包括日期时间字段，在大多数情况下这些字段是不同的，所以`assert_equal`失败了。看来我需要`@response.body`使用 XML 解析器处理包含，然后比较各个字段、元素数量等。或者有更简单的方法吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T18:32:02.393

设置请求对象接受头：

```
@request.accept = 'text/xml' # or 'application/xml' I forget which 
```

然后您可以断言响应正文等于您的预期

```
assert_equal '<some>xml</some>', @response.body 
```

# security - 为什么要多次覆盖文件以安全地删除文件的所有痕迹？

> ID：59656
> 
> 赞同：16
> 
> 时间：2008-09-12T18:11:51.910
> 
> 标签：security, disk

Eraser 等擦除程序建议覆盖数据可能 36 次。

据我了解，所有数据都以 1 或 0 的形式存储在硬盘上。

如果对整个文件执行一次随机 1 和 0 的覆盖，那为什么还不足以删除原始文件的所有痕迹？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-12T18:15:45.553

曾经为 0，然后变为“1”的硬盘驱动器位的磁场比以前为 1 然后再次写入 1 的硬盘位稍弱。使用敏感设备，通过测量强度的微小差异，可以以合理的准确度识别每个位的先前内容。结果不会完全正确并且会有错误，但是可以检索到以前内容的很大一部分。

当您在这些位上乱写 35 次时，实际上不可能辨别过去存在的内容。

**编辑：** [一项现代分析](http://www.h-online.com/news/Secure-deletion-a-single-overwrite-will-do-it--/112432)表明，一个被覆盖的位只能以 56% 的准确率恢复。尝试恢复整个字节的准确率只有 0.97%。所以我只是在重复一个都市传说。使用软盘或其他介质时可能需要多次覆盖，但硬盘不需要它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-15T21:20:18.237

Daniel Feenberg（私人国家经济研究局的经济学家）声称，从现代硬盘驱动器中恢复被覆盖数据的可能性相当于“都市传说”：

[情报机构可以读取被覆盖的数据吗？](http://www.nber.org/sys-admin/overwritten-data-guttman.html)

所以理论上用零覆盖文件一次就足够了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-12T18:26:12.983

在传统术语中，当一个 1 被写入磁盘时，媒体记录一个 1，而当一个 0 被写入磁盘时，媒体记录一个 0。然而，实际效果更接近于在用 1 覆盖 0 时获得 0.95，在用 1 覆盖 1 时获得 1.05。设置了普通磁盘电路，以便将这两个值都读取为 1，但是使用专用电路可以计算出以前的“层”包含的内容。通过使用高质量数字采样示波器从模拟头电子设备读取信号，将采样波形下载到 PC，并在软件中分析，至少恢复一层或两层覆盖数据并不难恢复先前记录的信号。该软件所做的是生成一个“理想” 读取信号并将其从实际读取的信号中减去，留下前一个信号的残余作为差值。由于商用硬盘驱动器中的模拟电路的质量远不及示波器中用于采样信号的电路质量，因此存在恢复硬盘驱动器电子设备未利用的大量额外信息的能力（尽管使用较新的通道编码技术，如 PRML（进一步解释），需要大量的信号处理，不再可能使用示波器等简单工具直接恢复数据）

[http://www.cs.auckland.ac.nz/~pgut001/pubs/secure_del.html](http://www.cs.auckland.ac.nz/~pgut001/pubs/secure_del.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-12T23:09:55.597

想象一下物理磁盘上的一个数据扇区。在这个扇区内是一个磁性图案（一条带），它对存储在该扇区中的数据位进行编码。这种模式是由一个或多或少静止的写头写入的，而磁盘在其下方旋转。现在，为了让您的硬盘驱动器在每次将新的磁性图案条写入扇区时都能正常用作数据存储设备，它必须重置该扇区中的磁性图案，以便以后可以读取。然而，它不必完全抹去之前磁性图案的所有证据，它只需要足够好（并且今天使用的纠错量足够好，不一定要那么好）。

你得到的是一系列磁性图案层，其中最强的图案对应于最后的数据写入。使用正确的仪器，可以读取具有足够详细信息的模式分层，从而能够确定较旧层中的一些数据。

这有助于数据是数字的，因为一旦您提取了给定层的数据，您就可以准确地确定用于将其写入磁盘并从读数中减去的磁模式（然后在下一个层，下一层）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T12:17:26.240

您想要这个的原因*不是*硬盘，而是**SSD**。他们在不告诉操作系统或文件系统驱动程序的情况下重新映射集群。这样做是出于磨损均衡的目的。因此，写入的 0 位与之前的 1 不同的位置的可能性非常高。移除 SSD 控制器并读取原始闪存芯片甚至是企业间谍活动的范围之内。但是对于 36 次全盘覆盖，磨损均衡可能会在所有备用块中循环几次。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-12T18:26:36.277

我们在这里看到的被称为“数据剩磁”。事实上，大多数重复覆盖的技术（无害地）做的比实际需要的要多。已经尝试从数据被覆盖的磁盘中恢复数据，除了少数实验室案例外，实际上没有这种技术成功的例子。

当我们谈论恢复方法时，主要你会看到磁力显微镜作为解决偶然覆盖的灵丹妙药，但即使这样也没有记录成功，并且无论如何都可以通过在整个区域写入良好的二进制数据模式来取消您的磁性媒体（而不是简单的 0000000000s）。

最后，您所指的 36 次（实际上是 35 次）覆盖在今天被认为是过时且不必要的，因为该技术（称为 Gutmann 方法）旨在适应技术中使用的各种（通常是用户不知道的）编码方法像 RLL 和 MFM 一样，无论如何您都不太可能遇到。即使是美国政府的指导方针，一次覆盖就足以删除数据，尽管出于管理目的，他们认为这对于“清理”是不可接受的。造成这种差异的建议原因是“坏”扇区可能被磁盘硬件标记为坏扇区，并且在进行覆盖时没有正确覆盖，因此有可能通过目视检查磁盘来恢复这些扇区地区。

最后 - 使用 1010101010101010 或相当随机的模式写入足以将数据擦除到已知技术无法恢复的程度。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-12T18:29:51.633

[“Data Remanence”维基百科](http://en.wikipedia.org/wiki/Data_remanence)上有一组关于可能的攻击及其实际可行性的很好的参考资料。 那里也引用了 DoD 和 NIST 标准和建议。最重要的是，从磁性介质中恢复被覆盖的数据是可能的，但变得越来越难。尽管如此，一些（美国政府）标准仍然需要至少多次覆盖。同时，设备内部结构继续变得更加复杂，即使在覆盖之后，驱动器或固态设备也可能有意外的副本（想想坏块处理或闪存磨损均衡（[参见 Peter Gutmann](http://www.cypherpunks.to/~peter/usenix01_slides.pdf)）。所以真正担心的仍然是破坏驱动器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-12T22:48:25.477

我一直想知道为什么不考虑文件先前存储在磁盘上不同物理位置的可能性。

例如，如果刚刚进行了碎片整理，那么很容易有一个文件副本，可以很容易地在磁盘上的其他地方恢复。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-13T00:15:02.147

这是我放在一起的 Gutmann 擦除实现。它使用加密随机数生成器来生成一个强大的随机数据块。

```
public static void DeleteGutmann(string fileName)
{
    var fi = new FileInfo(fileName);

    if (!fi.Exists)
    {
        return;
    }

    const int GutmannPasses = 35;
    var gutmanns = new byte[GutmannPasses][];

    for (var i = 0; i < gutmanns.Length; i++)
    {
        if ((i == 14) || (i == 19) || (i == 25) || (i == 26) || (i == 27))
        {
            continue;
        }

        gutmanns[i] = new byte[fi.Length];
    }

    using (var rnd = new RNGCryptoServiceProvider())
    {
        for (var i = 0L; i < 4; i++)
        {
            rnd.GetBytes(gutmanns[i]);
            rnd.GetBytes(gutmanns[31 + i]);
        }
    }

    for (var i = 0L; i < fi.Length;)
    {
        gutmanns[4][i] = 0x55;
        gutmanns[5][i] = 0xAA;
        gutmanns[6][i] = 0x92;
        gutmanns[7][i] = 0x49;
        gutmanns[8][i] = 0x24;
        gutmanns[10][i] = 0x11;
        gutmanns[11][i] = 0x22;
        gutmanns[12][i] = 0x33;
        gutmanns[13][i] = 0x44;
        gutmanns[15][i] = 0x66;
        gutmanns[16][i] = 0x77;
        gutmanns[17][i] = 0x88;
        gutmanns[18][i] = 0x99;
        gutmanns[20][i] = 0xBB;
        gutmanns[21][i] = 0xCC;
        gutmanns[22][i] = 0xDD;
        gutmanns[23][i] = 0xEE;
        gutmanns[24][i] = 0xFF;
        gutmanns[28][i] = 0x6D;
        gutmanns[29][i] = 0xB6;
        gutmanns[30][i++] = 0xDB;
        if (i >= fi.Length)
        {
            continue;
        }

        gutmanns[4][i] = 0x55;
        gutmanns[5][i] = 0xAA;
        gutmanns[6][i] = 0x49;
        gutmanns[7][i] = 0x24;
        gutmanns[8][i] = 0x92;
        gutmanns[10][i] = 0x11;
        gutmanns[11][i] = 0x22;
        gutmanns[12][i] = 0x33;
        gutmanns[13][i] = 0x44;
        gutmanns[15][i] = 0x66;
        gutmanns[16][i] = 0x77;
        gutmanns[17][i] = 0x88;
        gutmanns[18][i] = 0x99;
        gutmanns[20][i] = 0xBB;
        gutmanns[21][i] = 0xCC;
        gutmanns[22][i] = 0xDD;
        gutmanns[23][i] = 0xEE;
        gutmanns[24][i] = 0xFF;
        gutmanns[28][i] = 0xB6;
        gutmanns[29][i] = 0xDB;
        gutmanns[30][i++] = 0x6D;
        if (i >= fi.Length)
        {
            continue;
        }

        gutmanns[4][i] = 0x55;
        gutmanns[5][i] = 0xAA;
        gutmanns[6][i] = 0x24;
        gutmanns[7][i] = 0x92;
        gutmanns[8][i] = 0x49;
        gutmanns[10][i] = 0x11;
        gutmanns[11][i] = 0x22;
        gutmanns[12][i] = 0x33;
        gutmanns[13][i] = 0x44;
        gutmanns[15][i] = 0x66;
        gutmanns[16][i] = 0x77;
        gutmanns[17][i] = 0x88;
        gutmanns[18][i] = 0x99;
        gutmanns[20][i] = 0xBB;
        gutmanns[21][i] = 0xCC;
        gutmanns[22][i] = 0xDD;
        gutmanns[23][i] = 0xEE;
        gutmanns[24][i] = 0xFF;
        gutmanns[28][i] = 0xDB;
        gutmanns[29][i] = 0x6D;
        gutmanns[30][i++] = 0xB6;
    }

    gutmanns[14] = gutmanns[4];
    gutmanns[19] = gutmanns[5];
    gutmanns[25] = gutmanns[6];
    gutmanns[26] = gutmanns[7];
    gutmanns[27] = gutmanns[8];

    Stream s;

    try
    {
        s = new FileStream(
            fi.FullName,
            FileMode.Open,
            FileAccess.Write,
            FileShare.None,
            (int)fi.Length,
            FileOptions.DeleteOnClose | FileOptions.RandomAccess | FileOptions.WriteThrough);
    }
    catch (UnauthorizedAccessException)
    {
        return;
    }
    catch (IOException)
    {
        return;
    }

    using (s)
    {
        if (!s.CanSeek || !s.CanWrite)
        {
            return;
        }

        for (var i = 0L; i < gutmanns.Length; i++)
        {
            s.Seek(0, SeekOrigin.Begin);
            s.Write(gutmanns[i], 0, gutmanns[i].Length);
            s.Flush();
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-12T18:15:35.723

有一些“磁盘修复”类型的应用程序和服务即使在格式化后仍然可以从硬盘驱动器读取数据，因此如果您确实需要安全地擦除某些内容，简单地用随机的 1 和 0 覆盖一次是不够的。

我想说的是，对于普通用户来说，这已经绰绰有余了，但是如果您处于高度安全的环境（政府、军队等）中，那么您需要更高级别的“删除”，这可以非常有效地保证无法从驱动器中恢复任何数据。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-12T18:31:56.607

美国要求删除敏感信息（即绝密信息）是销毁驱动器。基本上，驱动器被放入带有巨大磁铁的机器中，并且还会物理地破坏驱动器以进行处置。这是因为有可能读取驱动器上的信息，甚至被多次覆盖。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-13T00:22:15.593

看到这个： [格特曼的论文](http://www.cs.auckland.ac.nz/~pgut001/pubs/secure_del.html)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-10-04T15:30:17.460

只需反转位，以便将 1 写入所有 0，将 0 写入所有 1，然后将其全部归零，这应该消除磁场中的任何变量，并且只需要 2 次通过。

# sql - 在 SQL 中选择 CHAR 而不是 VARCHAR 的用例是什么？

> ID：59667
> 
> 赞同：282
> 
> 时间：2008-09-12T18:15:28.097
> 
> 标签：sql, tsql

我意识到如果我的所有值都是固定宽度，则建议使用 CHAR。但是，那又怎样？为了安全起见，为什么不为所有文本字段选择 VARCHAR。

* * *

## 回答 #1

> 赞同：394
> 
> 时间：2008-09-12T18:22:06.927

*一般规则是如果所有行的长度*都接近，则选择**CHAR**。*当长度变化*很大时选择**VARCHAR**（或*NVARCHAR*）。CHAR 也可能会快一点，因为所有行的长度都相同。

 *****它因 DB 实现而异，但通常 VARCHAR （或*NVARCHAR*）除了实际数据外，还使用一两个字节的存储空间（用于长度或终止）。因此（假设您使用的是单字节字符集）存储单词“FooBar”

*   **CHAR(6)** = 6 字节*（无开销）*
*   **VARCHAR(100)** = 8 个字节*（2 个字节的开销）*
*   **CHAR(10)** = 10 字节*（4 字节浪费）*

底线是对于长度相对相同（在两个字符长度差异内）的数据，**CHAR** *可以**更快*，更*节省空间。*

**注意**：Microsoft SQL 对 VARCHAR 有 2 个字节的开销。这可能因数据库而异，但通常至少需要 1 字节的开销来指示 VARCHAR 上的长度或 EOL。

*[正如Gaven](https://stackoverflow.com/users/1106569/gavin-towey)*在评论中指出的那样：当涉及到[多字节字符](http://dev.mysql.com/doc/refman/5.0/en/charset-unicode-utf8.html)集时，情况会发生变化，这是 VARCHAR 成为更好选择的情况。

*关于声明的**VARCHAR***长度的说明：因为它存储实际内容的长度，所以您不会浪费未使用的长度。*因此，在VARCHAR(6)、VARCHAR(100)*或*VARCHAR(MAX)*中存储 6 个字符使用相同的存储量。阅读更多关于使用[VARCHAR(MAX)](https://stackoverflow.com/a/8512232/255)时的差异。您在 VARCHAR 中声明*最大*大小以限制存储的数量。

在评论[AlwaysLearning 中](https://stackoverflow.com/users/10990028/alwayslearning)指出，[Microsoft Transact-SQL 文档](https://docs.microsoft.com/en-us/sql/t-sql/data-types/char-and-varchar-transact-sql?view=sql-server-ver15)似乎相反。我认为这是一个错误，或者至少文档不清楚。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-09-12T18:42:23.070

如果您与我一起工作并且您正在与 Oracle 一起工作，我可能会让您`varchar`在几乎所有情况下都使用它。`char`使用较少处理能力的假设`varchar`可能是真实的......现在......但随着时间的推移，数据库引擎会变得更好，这种一般规则会成为未来的“神话”。

另一件事：我从未见过性能问题，因为有人决定使用`varchar`. 您将更好地利用您的时间编写好的代码（对数据库的调用更少）和高效的 SQL（索引如何工作，优化器如何做出决策，为什么`exists`比`in`通常更快......）。

最后的想法：我已经看到了使用的各种问题`CHAR`，人们在应该寻找 '' 时寻找 ''，或者人们在应该寻找 'FOO (bunch of spaces here)' 时寻找 'FOO' ，或者没有修剪尾随空格的人，或者 Powerbuilder 的错误将多达 2000 个空格添加到它从 Oracle 过程返回的值。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-09-12T18:57:55.530

除了性能优势之外，`CHAR`还可用于指示所有值的长度*应*相同，例如，用于美国州缩写的列。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-09-12T18:17:17.187

Char 有点快，所以如果你有一个你知道会有一定长度的列，请使用 char。例如，为性别存储 (M)ale/(F)emale/(U)nknown，或者为美国的州存储 2 个字符。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2011-03-04T01:31:29.577

NChar 或 Char 是否比他们的 var 替代品表现更好？

好问题。在某些情况下，简单的答案是肯定的。让我们看看这是否可以解释。

显然我们都知道，如果我创建一个包含 varchar(255) 列的表（我们将此列称为 myColumn）并插入一百万行但每行只在 myColumn 中放入几个字符，则表会小得多（总体存储引擎所需的数据页数），而不是我将 myColumn 创建为 char(255)。每当我对该表执行操作 (DML) 并请求大量行时，当 myColumn 为 varchar 时它会更快，因为我不必在最后*移动*所有这些“额外”空格。移动，例如当 SQL Server 执行内部排序时，例如在不同或联合操作期间，或者如果它在查询计划期间选择合并等。

但是使用 varchar 有一些开销。SQL Server 必须在每一行上使用一个两字节指示符（开销）来了解特定行的 myColumn 在其中有多少字节。问题不是额外的 2 个字节，而是必须“解码”每行 myColumn 中数据的长度。

根据我的经验，在查询中连接的列上使用 char 而不是 varchar 是最有意义的。例如表的主键，或将被索引的其他列。人口统计表上的 CustomerNumber，或解码表上的 CodeID，或者订单表上的 OrderNumber。通过使用 char，查询引擎可以更快地执行连接，因为它可以直接进行指针算术（确定性地），而不必在读取页面时将其指针移动可变数量的字节。我知道我可能在最后一句话上失去了你。SQL Server 中的连接是基于“谓词”的概念。谓词是一个条件。例如 myColumn = 1，或 OrderNumber < 500。

因此，如果 SQL Server 正在执行 DML 语句，并且连接的谓词或“键”是固定长度 (char)，则查询引擎不必做太多工作来将一个表中的行匹配到来自另一张桌子。它不必找出数据在行中的长度，然后沿着字符串向下走以找到结尾。这一切都需要时间。

现在请记住，这很容易实施得很差。我已经看到 char 用于在线系统中的主键字段。宽度必须保持较小，即 char(15) 或合理的值。它在在线系统中效果最好，因为您通常只检索或更新少量行，因此必须“修剪”您将在结果集中获得的那些尾随空格是一项微不足道的任务，而不是必须加入数百万行从一个表的行到另一个表上的数百万行。

CHAR 在在线系统上优于 varchar 的另一个原因是它减少了页面拆分。通过使用 char，您实际上是在“保留”（并浪费）该空间，因此如果用户稍后出现并将更多数据放入该列中，SQL 已经为它分配了空间并进入了它。

使用 CHAR 的另一个原因与第二个原因类似。如果程序员或用户对数百万行进行“批量”更新，例如在注释字段中添加一些句子，您将不会在半夜接到 DBA 的电话，想知道为什么他们的驱动器已满。换句话说，它会导致数据库大小的更可预测的增长。

因此，这些是在线 (OLTP) 系统可以从 char 而非 varchar 中受益的 3 种方式。我几乎从不在仓库/分析/OLAP 场景中使用 char，因为通常您拥有如此多的数据，以至于所有这些 char 列加起来会浪费大量空间。

请记住，char 可以使您的数据库变得更大，但大多数备份工具都具有数据压缩功能，因此您的备份往往与使用 varchar 的大小大致相同。例如 LiteSpeed 或 RedGate SQL 备份。

另一个用途是在为将数据导出到固定宽度文件而创建的视图中。假设我必须将一些数据导出到一个平面文件以供大型机读取。它是固定宽度（未定界）。我喜欢将数据作为 varchar 存储在我的“暂存”表中（从而在我的数据库上消耗更少的空间），然后使用视图将所有内容转换为它的 char 等效项，长度对应于该列的固定宽度的宽度. 例如：

```
create table tblStagingTable (
pkID BIGINT (IDENTITY,1,1),
CustomerFirstName varchar(30),
CustomerLastName varchar(30),
CustomerCityStateZip varchar(100),
CustomerCurrentBalance money )

insert into tblStagingTable
(CustomerFirstName,CustomerLastName, CustomerCityStateZip) ('Joe','Blow','123 Main St Washington, MD 12345', 123.45)

create view vwStagingTable AS
SELECT CustomerFirstName = CAST(CustomerFirstName as CHAR(30)),
CustomerLastName = CAST(CustomerLastName as CHAR(30)),
CustomerCityStateZip = CAST(CustomerCityStateZip as CHAR(100)),
CustomerCurrentBalance = CAST(CAST(CustomerCurrentBalance as NUMERIC(9,2)) AS CHAR(10))

SELECT * from vwStagingTable 
```

这很酷，因为在内部我的数据占用的空间更少，因为它使用的是 varchar。但是当我使用 DTS 或 SSIS，甚至只是从 SSMS 剪切和粘贴到记事本时，我可以使用视图并获得正确数量的尾随空格。在 DTS 中，我们曾经有一个功能叫做，该死的，我忘记了，我认为它被称为“建议列”之类的。在 SSIS 中你不能再这样做了，你必须繁琐地定义平面文件连接管理器。但是由于您已经设置了视图，SSIS 可以知道每列的宽度，并且可以在构建数据流任务时节省大量时间。

所以底线......使用varchar。使用 char 的原因很少，而且只是出于性能原因。如果您有一个具有数亿行的系统，如果谓词是确定性的 (char)，您将看到明显的差异，但对于大多数使用 char 的系统来说，只是在浪费空间。

希望有帮助。杰夫

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-09-13T01:28:41.643

有性能优势，但这里没有提到一个：行迁移。使用 char，您提前保留了整个空间。假设您有一个 char(1000)，并且您存储了 10 个字符，您将用完所有 1000 个字符的空间。在 varchar2(1000) 中，您只会使用 10 个字符。当您修改数据时，问题就来了。假设您将列更新为现在包含 900 个字符。当前块中可能没有用于扩展 varchar 的空间。在这种情况下，数据库引擎必须将该行迁移到另一个块，并在原始块中将指针指向新块中的新行。要读取此数据，DB 引擎现在必须读取 2 个块。
没有人可以含糊地说 varchar 或 char 更好。有时间权衡的空间，并考虑数据是否会更新，特别是如果它很有可能会增长。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-12T18:37:52.893

早期性能优化和使用最佳实践类型的规则是有区别的。如果您要创建始终具有固定长度字段的新表，则使用 CHAR 是有意义的，您应该在这种情况下使用它。这不是早期优化，而是实施经验法则（或最佳实践）。

ie - 如果您有 2 个字母的状态字段，请使用 CHAR(2)。如果您有一个包含实际状态名称的字段，请使用 VARCHAR。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-09-12T20:11:03.997

我会选择 varchar ，除非该列存储像美国州代码这样的固定值——它总是 2 个字符长并且有效的美国州代码列表不会经常更改:)。

在所有其他情况下，即使像存储散列密码（固定长度）一样，我也会选择 varchar。

为什么 - char 类型列总是用空格填充，这使得列*my_column*定义为 char(5)，比较内的值为 'ABC'：

```
my_column = 'ABC' -- my_column stores 'ABC  ' value which is different then 'ABC' 
```

错误的。

此*功能*可能会在开发过程中导致许多烦人的错误，并使测试变得更加困难。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-01-21T00:07:14.267

如果该字段中的所有数据值长度相同，则 CHAR 占用的存储空间比 VARCHAR 少。现在，如果您将 VARCHAR 转换为 CHAR，那么在 2009 年，一个 800GB 的数据库在所有意图和目的上都与 810GB 相同，但对于短字符串（1 或 2 个字符），我会说 CHAR 仍然是行业“最佳实践”。

现在，如果您查看大多数数据库甚至仅针对整数（bit、tiny、int、bigint）提供的各种数据类型，就有理由选择其中一种。每次都简单地选择 bigint 实际上有点不了解该领域的目的和用途。如果一个字段仅代表一个人的年龄（以年为单位），那么 bigint 就过分了。现在它不一定是“错误的”，但它不是有效的。

但这是一个有趣的论点，并且随着数据库随着时间的推移而改进，可以说 CHAR 与 VARCHAR 确实变得不那么相关了。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2018-04-13T18:12:00.727

我永远不会使用字符。我与很多人进行过辩论，他们总是提出陈词滥调，即 char 更快。好吧，我说，快多少？我们在这里谈论的是什么，毫秒，秒，如果有的话是多少？你告诉我是因为有人声称它快了几毫秒，我们应该在系统中引入大量难以修复的错误？

所以这里有一些你会遇到的问题：

每个字段都将被填充，因此您最终会得到到处都有 RTRIMS 的代码。对于较长的字段，这也是一个巨大的磁盘空间浪费。

现在假设您有一个典型示例，即只有一个字符的 char 字段，但该字段是可选的。如果有人将一个空字符串传递给该字段，它就会变成一个空格。因此，当另一个应用程序/进程查询它时，如果他们不使用 rtrim，他们会得到一个空格。我们有 xml 文档、文件和其他程序，在可选字段中只显示一个空格并破坏事物。

因此，现在您必须确保将空值而不是空字符串传递给 char 字段。但这不是 null 的正确用法。这里是null的使用。假设您从供应商处获得文件

姓名|性别|城市

鲍勃||洛杉矶

如果未指定性别，则在表中输入 Bob、空字符串和 Los Angeles。现在假设你得到了文件，它的格式发生了变化，性别不再包括在内，而是过去了。

名称|城市

鲍勃|西雅图

好吧，既然不包括性别，我会使用null。Varchars 支持这一点没有问题。

另一方面，Char 则不同。你总是必须发送空值。如果您曾经发送空字符串，您最终会得到一个包含空格的字段。

在大约 20 年的开发过程中，我可以继续解决我必须从字符中修复的所有错误。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-12T18:28:11.670

我支持 Jim McKeeth 的评论。

此外，如果您的表只有 CHAR 列，则索引和全表扫描会更快。基本上，如果每条记录只有 CHAR 列，优化器将能够预测它有多大，同时它需要检查每个 VARCHAR 列的大小值。

此外，如果您将 VARCHAR 列更新为大于其先前内容的大小，您可能会强制数据库重建其索引（因为您强制数据库物理移动磁盘上的记录）。而 CHAR 列永远不会发生。

但是除非您的桌子很大，否则您可能不会关心性能损失。

记住吉克斯特拉的话。早期的性能优化是万恶之源。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-11-04T21:38:19.823

许多人指出，如果您知道值的确切长度，使用 CHAR 会有一些好处。但是，虽然今天将美国各州存储为 CHAR(2) 非常棒，但当您从销售中收到“我们刚刚向澳大利亚进行了第一笔销售”的消息时，您将陷入痛苦的世界。我总是高估我认为字段需要多长时间，而不是做出“准确”的猜测来涵盖未来的事件。VARCHAR 将在这方面给我更多的灵活性。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-18T13:01:25.337

我认为在您的情况下，可能没有理由不选择 Varchar。它为您提供了灵活性，并且正如许多受访者所提到的，现在的性能如此之高，除非在非常特殊的情况下，我们这些普通人（与 Google DBA 不同）不会注意到差异。

当谈到 DB Types 时，值得注意的一件有趣的事情是 sqlite（一个流行的迷你数据库，性能相当令人印象深刻）将所有内容作为字符串和动态类型放入数据库中。

我总是使用 VarChar 并且通常使它比我可能需要的大得多。例如。50 for Firstname，正如你所说，为什么不只是为了安全。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-12T18:18:33.410

在计算列值的实际需要大小并为 Varchar 分配空间时，有一些小的处理开销，因此如果您确定该值将始终保持多长时间，则最好使用 Char 并避免命中。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-14T18:21:53.040

这是经典的空间与性能权衡。

在 MS SQL 2005 中，Varchar（或 NVarchar 用于每个字符需要两个字节的语言，即中文）是可变长度的。如果在将行写入硬盘后添加到行，它会将数据定位在与原始行不连续的位置，并导致数据文件碎片化。这会影响性能。

因此，如果空间不是问题，那么 Char 的性能更好，但如果您想减小数据库大小，那么 varchars 会更好。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2013-10-25T12:11:30.990

碎片化。Char 保留空间，而 VarChar 没有。可能需要页面拆分以适应对 varchar 的更新。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-12T18:22:05.973

当使用 varchar 值时，SQL Server 每行需要额外的 2 个字节来存储有关该列的一些信息，而如果您使用 char，则不需要，除非您

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-12T18:30:52.100

在某些 SQL 数据库中，VARCHAR 将被填充到其最大大小以优化偏移量，这是为了加快全表扫描和索引。

因此，与 CHAR(200) 相比，使用 VARCHAR(200) 不会节省任何空间

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-11-25T03:59:30.270

使用 CHAR (NCHAR) 和 VARCHAR (NVARCHAR) 会导致数据库服务器存储数据的方式有所不同。第一个引入尾随空格；在 SQL SERVER 函数中将它与 LIKE 运算符一起使用时遇到了问题。所以我必须一直使用 VARCHAR (NVARCHAR) 来保证它的安全。

例如，如果我们有一个表**TEST(ID INT, Status CHAR(1))**，并且您编写一个函数来列出具有特定值的所有记录，如下所示：

```
CREATE FUNCTION List(@Status AS CHAR(1) = '')
RETURNS TABLE
AS
RETURN
SELECT * FROM TEST
WHERE Status LIKE '%' + @Status '%' 
```

在这个函数中，我们期望当我们输入默认参数时，函数会返回所有的行，但实际上并没有。将 @Status 数据类型更改为 VARCHAR 将解决此问题。

# c++ - 如何摆脱 GCC 中“不推荐使用的从字符串常量到 'char*' 的转换”警告？

> ID：59670
> 
> 赞同：423
> 
> 时间：2008-09-12T18:15:55.320
> 
> 标签：c++, string, gcc

所以我正在研究一个非常大的代码库，最近升级到 gcc 4.3，现在触发了这个警告：

> 警告：不推荐将字符串常量转换为 'char*'</p>

显然，解决这个问题的正确方法是找到每个声明

```
char *s = "constant string"; 
```

或函数调用，如：

```
void foo(char *s);
foo("constant string"); 
```

并使他们成为`const char`指针。但是，这意味着至少要接触 564 个文件，这不是我目前希望执行的任务。现在的问题是我正在运行`-werror`，所以我需要一些方法来扼杀这些警告。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：577
> 
> 时间：2013-05-31T23:07:31.847

将字符串文字传递给的任何函数`"I am a string literal"`都应用`char const *`作类型，而不是`char*`.

如果您要修复某些东西，请正确修复它。

**解释：**

您不能使用字符串文字来初始化将被修改的字符串，因为它们是`const char*`. 抛弃常量以稍后修改它们是[未定义的行为](https://stackoverflow.com/questions/3801557/can-we-change-the-value-of-an-object-defined-with-const-through-pointers)，因此您必须将`const char*`字符串复制`char`到`char`动态分配`char*`的字符串中才能修改它们。

**例子：**

```
#include <iostream>

void print(char* ch);

void print(const char* ch) {
    std::cout<<ch;
}

int main() {
    print("Hello");
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：238
> 
> 时间：2008-09-12T18:22:10.030

我相信传递`-Wno-write-strings`给 gcc 会抑制这个警告。

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2009-02-12T12:44:01.997

我有一个类似的问题，我是这样解决的：

```
#include <string.h>

extern void foo(char* m);

int main() {
    // warning: deprecated conversion from string constant to ‘char*’
    //foo("Hello");

    // no more warning
    char msg[] = "Hello";
    foo(msg);
} 
```

这是解决这个问题的合适方法吗？我无法将`foo`其调整为接受`const char*`，尽管这将是一个更好的解决方案（因为`foo`不会改变`m`）。

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2008-09-12T18:23:43.600

查看 gcc 的[Diagnostic Pragma](http://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html)支持，以及[-W 警告选项](http://www.redhat.com/docs/manuals/enterprise/RHEL-4-Manual/gcc/warning-options.html)列表（更改：[警告选项的新链接](http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/4/html/Using_the_GNU_Compiler_Collection/warning-options.html)）。

对于 gcc，您可以使用[此处](https://stackoverflow.com/a/8140772/2436175)`#pragma warning`解释的指令。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2008-09-12T18:49:22.133

如果它是一个活动的代码库，您可能仍想升级代码库。`sed`当然，手动执行更改是不可行的，但我相信这个问题可以通过一个命令一劳永逸地解决。不过，我还没有尝试过，所以请对以下内容持保留态度。

```
find . -exec sed -E -i .backup -n \
    -e 's/char\s*\*\s*(\w+)\s*= "/char const* \1 = "/g' {} \; 
```

这可能无法找到所有位置（甚至不考虑函数调用），但它会缓解问题并可以手动执行剩余的少数更改。

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2011-11-15T17:47:40.553

这是在文件中内联的方法，因此您不必修改 Makefile。

```
// gets rid of annoying "deprecated conversion from string constant blah blah" warning
#pragma GCC diagnostic ignored "-Wwrite-strings" 
```

以后可以...

```
#pragma GCC diagnostic pop 
```

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2009-08-21T02:14:26.480

我不能使用编译器开关。所以我把这个变成了：

```
char *setf = tigetstr("setf"); 
```

对此：

```
char *setf = tigetstr((char *)"setf"); 
```

* * *

## 回答 #8

> 赞同：25
> 
> 时间：2015-10-09T19:52:09.817

代替

```
char *str = "hello"; 
```

和

```
char *str = (char*)"hello"; 
```

或者如果您正在调用函数：

```
foo("hello"); 
```

将其替换为

```
foo((char*) "hello"); 
```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2014-10-04T15:06:56.410

代替：

```
void foo(char *s);
foo("constant string"); 
```

这有效：

```
void foo(const char s[]);
foo("constant string"); 
```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2015-05-15T08:37:33.987

在 C++ 中，使用`const_cast`如下

```
char* str = const_cast<char*>("Test string"); 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2010-03-17T10:18:26.257

`Test string`是常量字符串。所以你可以这样解决：

```
char str[] = "Test string"; 
```

或者：

```
const char* str = "Test string";
printf(str); 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-12-21T15:14:35.997

为什么不只使用类型转换？

```
(char*) "test" 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-07-15T12:36:13.200

做从常量字符串到字符指针的类型转换，即

```
char *s = (char *) "constant string"; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-12-21T12:56:22.297

在 C++ 中，替换：

```
char *str = "hello"; 
```

和：

```
std::string str ("hello"); 
```

如果你想比较它：

```
str.compare("HALLO"); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-03-08T20:03:34.157

> 我不明白如何应用您的解决方案:( – kalmanIsAGameChanger

使用 Arduino Sketch，我有一个函数会导致我的警告。

> > 原函数：char StrContains(char *str, char *sfind)

为了停止警告，我在 char *str 和 char *sfind 前面添加了*const 。*

> > 修改：char StrContains(const char *str, const char *sfind)。

所有警告都消失了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-26T05:53:56.303

为什么不使用`-Wno-deprecated`忽略已弃用警告消息的选项？

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-05T20:49:48.093

您还可以通过调用从字符串常量创建可写字符串`strdup()`。

例如，此代码会生成警告：

```
putenv("DEBUG=1"); 
```

但是，以下代码不会（它在将字符串传递给之前在堆上复制字符串`putenv`）：

```
putenv(strdup("DEBUG=1")); 
```

在这种情况下（也许在大多数其他情况下）关闭警告是一个坏主意——它的存在是有原因的。另一种选择（默认情况下使所有字符串可写）可能效率低下。

听听编译器告诉你什么！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-08-24T02:14:08.547

看到这种情况：

```
typedef struct tagPyTypeObject
{
    PyObject_HEAD;
    char *name;
    PrintFun print;
    AddFun add;
    HashFun hash;
} PyTypeObject;

PyTypeObject PyDict_Type=
{
    PyObject_HEAD_INIT(&PyType_Type),
    "dict",
    dict_print,
    0,
    0
}; 
```

观察名称字段，在 gcc 中它编译时没有警告，但在 g++ 中它会，我不知道为什么。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-06-08T16:43:11.687

只需对 g++ 使用 -w 选项

例子：

g++ -w -o simple.o simple.cpp -lpthread

请记住，这并不能避免弃用，而是会阻止在终端上显示警告消息。

现在，如果您真的想避免弃用，请使用 const 关键字，如下所示：

```
const char* s="constant string"; 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-03-05T11:47:49.743

谢谢大家的帮助。从这里和那里挑选这个解决方案。这编译干净。还没有测试代码。也许明天吧...

```
const char * timeServer[] = { "pool.ntp.org" }; // 0 - Worldwide 
#define WHICH_NTP            0 // Which NTP server name to use.
...
sendNTPpacket(const_cast<char*>(timeServer[WHICH_NTP])); // send an NTP packet to a server
...
void sendNTPpacket(char* address) { code } 
```

我知道，timeServer 数组中只有一项。但可能还有更多。其余的暂时被注释掉以节省内存。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-09-13T06:13:49.237

在传递`string constants`给函数时，将其写为：

```
void setpart(const char name[]);

setpart("Hello"); 
```

而不是`const char name[]`，你也可以写`const char \*name`

它对我来说消除了这个错误：

```
[Warning] deprecated conversion from string constant to 'char*' [-Wwrite-strings] 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2008-09-15T22:33:15.813

> 现在的问题是我正在运行 -Werror

这是你真正的问题，IMO。您可以尝试一些从 (char *) 移动到 (const char *) 的自动化方法，但我会为它们投入资金，而不仅仅是工作。您必须至少有人参与其中的一些工作。在短期内，只需忽略警告（但 IMO 将其保持打开状态，否则将永远无法修复）并删除 -Werror。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2012-05-14T13:55:13.170

```
PyTypeObject PyDict_Type=
{ ...

PyTypeObject PyDict_Type=
{
  PyObject_HEAD_INIT(&PyType_Type),
                     "dict",
                     dict_print,
                     0,
                     0
}; 
```

观察名称字段，在 gcc 中它编译时没有警告，但在 g++ 中它会，我不知道为什么。

在`gcc (Compiling C)`, -Wno-write-strings 默认情况下是活动的。

in `g++ (Compiling C++)`-Wwrite-strings 默认激活

这就是为什么会有不同的行为。对于我们使用宏会`Boost_python`产生这样的警告。所以我们`-Wno-write-strings`在编译 C++ 时使用，因为我们总是使用`-Werror`

# wcf - 用于双工回调的 WSDualHttpBinding

> ID：59677
> 
> 赞同：10
> 
> 时间：2008-09-12T18:18:36.920
> 
> 标签：wcf, callback, duplex

将 WSDualHttpBinding 用于双工回调是否适用于实际场景？比如说，我有一个使用随机端口的 .NET 应用程序，该服务是否能够解析客户端的基地址和端口以进行回调？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-08-08T10:07:23.467

您的问题的完整答案取决于“真实世界场景”是 Intranet 还是 Internet 场景。尽管 WSDualHttpBinding 在这两种情况下都有效，但有一些细节需要注意：

**内联网**

WSDualHttpBinding 将在 Intranet 场景中使用预配置的自定义端口与您的 .NET 应用程序一起使用，并且“是”该服务将能够解析客户端的基地址和端口以进行回调：具体方法如下所述。下面解释它的原因是 WSDualHttpBinding 主要设计用于在 Internet 上使用。

在 Intranet 方案中，当您可以在客户端和服务器上使用 WCF 时，最好通过使用 NetTcpBinding 或 NetNamedPipeBinding 来实现双工回调。这些绑定分别使用 TCP 和 ICP 作为传输（而不是 HTTP）和自定义二进制编码，这就是为什么双方都需要 WCF。对于客户端的回调，用于通过绑定连接到服务的相同通道被重新使用，而无需打开新端口。

**互联网**

在 Internet 场景中，有效的 HTTP 请求和响应仅在一个方向传输，HTTP 被设计为单向协议。因此，当使用 WSDualHttpBinding 时，WCF 会为回调创建一个单独的 HTTP 通道。回答您的第二个问题：此回调客户端的目标地址默认由客户端计算机主机名和端口 80 组成。例如，如果客户端是开发机器并且安装了 IIS，80 端口在某些情况下会被独占保留，这将导致与您的原型应用程序发生冲突。这就是[这篇博文](http://blogs.msdn.com/wenlong/archive/2006/10/19/how-to-use-wsdualhttpbinding-on-windows-xp-for-hosted-services.aspx)提供了解决方案以及 ClientBaseAddress 属性旨在帮助解决的问题。无论您使用哪个端口（默认端口或自定义端口），您都必须确保正确配置两侧的所有防火墙和路由器，以允许建立传出通道和单独的回调通道。

.NET 应用程序也可以表示 Silverlight 应用程序。由于在浏览器中运行的 Silverlight 应用程序无法接受新的传入 HTTP 连接，因此带有单独反向通道的 WSDualHttpBinding 将不起作用。因此，PollingDuplexHttpBinding 最初是在 Silverlight 2 中创建的，这可以被认为是一个巧妙的“技巧”，通过保持请求通道长时间打开（长轮询）并将其用作反向通道来解决 HTTP 是单向的这一事实。回电给客户。这对客户端和服务器端都有很多影响，特别是与缩放相关，有关更多详细信息，请参阅[我的博客](http://petermcg.wordpress.com/2008/09/03/silverlight-polling-duplex-part-1-architecture/)中的这篇文章。

了解您特定的“真实世界场景”和您的用例，希望这将帮助您制定正确的绑定以用于双工回调。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-12T19:08:02.307

如果它是防火墙后面的应用程序，理论上是的。这取决于您所说的“现实世界”是什么意思；如果你的意思是“高性能”，也许 NetTcpBinding 是一个更好的方法。

# lotus-domino - 在 LotusScript Agent 中如何获取当前服务器的名称？

> ID：59680
> 
> 赞同：2
> 
> 时间：2008-09-12T18:20:36.337
> 
> 标签：lotus-domino, lotus, lotusscript

在通过 WebQueryOpen 运行的 LotusScript 代理中，如何获取当前服务器的名称？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-12T18:21:20.750

```
Set s = New NotesSession
Set db = s.CurrentDatabase

If db.Server <> "" Then
  Set sName = New NotesName(db.Server)
Else
  Set sName = New NotesName(s.Username)
End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T20:39:02.290

已经提供的示例代码很好，但我也是这样做的，只是获取服务器的分层名称：

```
Set s = New NotesSession
Set db = s.CurrentDatabase
If db.Server <> "" Then
   Set sName = New NotesName(db.Server)
Else
   Set sName = New NotesName(s.Username)
End If
ServerName = sName.Abbreviated 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-15T10:49:55.870

加里的回答是最合适的。您实际上可以使用分层语法来识别服务器名称。

```
dim session as new notesSession
dim strCurrServer as string
dim nmServer as notesName

strCurrServer = session.currentagent.servername
' this bit is optional 
set nmServer = new notesName(strCurrServer)
' then you can do stuff like this
print nmServer.Abbreviated 
```

这将是从 webquery 开放代理获取服务器名称的最快（最脏？）方法。notesName 类是一个方便的对象，用于处理分层名称 [链接文本](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.designer.domino.main.doc/H_NOTESNAME_CLASS.html)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-09-15T13:21:42.443

```
'initialize event of a WebQueryOpen agent

Dim s As New notessession   
Dim servername As String
servername = s.UserName 
```

# .net - .NET 可视化组件

> ID：59684
> 
> 赞同：1
> 
> 时间：2008-09-12T18:21:26.803
> 
> 标签：.net, visual-studio, components

我真的很喜欢[DevX](http://www.devexpress.com/)组件，但它们非常昂贵，也许有人知道免费的等价物吗？或网站，我可以在其中寻找 .NET 的某种免费可视化组件

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-12T18:23:21.697

查看 Component Factory 的免费[Krypton Toolkit](http://www.componentfactory.com/products.php#toolkit)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T05:21:43.353

我还发现 DevExpress 提供了一些[免费的组件](http://www.devexpress.com/Products/Free/WebRegistration/Index.xml)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T18:33:16.370

我同意那个。一路氪金。他们的一些控件实际上也优于相同的 Telerik 控件。

# haskell - F# 中的 Haskell 列表差分运算符

> ID：59711
> 
> 赞同：8
> 
> 时间：2008-09-12T18:31:39.023
> 
> 标签：haskell, f#, functional-programming, operators

`\\`F# 中是否有与 Haskell 的列表差分运算符等效的运算符？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-12T19:41:25.393

不...只需编写它并使其成为中缀运算符-使用一组特殊字符。反斜杠 ( `\`) 不在下面的列表中，因此它不能用作中缀运算符。请参阅[手册](http://research.microsoft.com/fsharp/manual/spec2.aspx#_Toc207785578)：

> 中缀操作：=
> 
> ```
> or || & && <OP >OP $OP = |OP &OP ^OP :: -OP +OP *OP /OP %OP
> 
> **OP 
> ```
> 
> 前缀操作：=
> 
> ```
> !OP ?OP ~OP -OP +OP % %% & && 
> ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-15T08:27:37.520

被退回，但我相信值得在这里写下`( /-/ )`（Haskell 的 F# 版本`\\`）的实现：

```
let flip f x y = f y x

let rec delete x = function
  | [] -> []
  | h :: t when x = h -> t
  | h :: t -> h :: delete x t

let inline ( /-/ ) xs ys = List.fold (flip delete) xs ys 
```

这将像 Haskell 一样运行`\\`，因此`(xs @ ys) /-/ xs = ys`. 例如：`(7 :: [1 .. 5] @ [5 .. 11]) /-/ [4 .. 7]`计算为`[1; 2; 3; 5; 7; 8; 9; 10; 11]`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-22T00:29:08.330

从减数集中过滤项目：

```
let ( /-/ ) xs ys =
    let ySet = set ys
    let notInYSet x = not <| Set.contains x ySet
    List.filter notInYSet xs 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-15T00:58:16.397

我正在使用这个：

```
let (/-/) l1 l2 = List.filter (fun i -> not <| List.exists ((=) i) l2) l1 
```

如果有人看到问题，请告诉我。

用于列表，因此结果中可能存在重复。例如：

```
[1;1;2] /-/ [2;3] would be eq to [1;1] 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-06T02:29:13.457

假设您真的想要传统的集合差异而不是 Haskell 显然提供的奇怪的有序但未排序的多重减法，只需使用内置`set`函数将列表转换为集合，然后使用内置`-`运算符来计算集合差异：

```
set xs - set ys 
```

例如：

```
> set [1..5] - set [2..4];;
val it : Set<int> = seq [1; 5] 
```

# asp.net - 如何在 JavaScript 中检查 IsPostBack？

> ID：59719
> 
> 赞同：47
> 
> 时间：2008-09-12T18:35:25.957
> 
> 标签：asp.net, javascript

我需要运行一个 JavaScript 函数 onLoad()，但只有在页面第一次加载时才这样做（即不是回发的结果）。

基本上，我需要检查 JavaScript 中的 IsPostBack。

谢谢你。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-09-12T18:42:39.153

服务器端，写：

```
if(IsPostBack)
{
   // NOTE: the following uses an overload of RegisterClientScriptBlock() 
   // that will surround our string with the needed script tags 
   ClientScript.RegisterClientScriptBlock(GetType(), "IsPostBack", "var isPostBack = true;", true);
} 
```

然后，在为 onLoad 运行的脚本中，检查该变量是否存在：

```
if(isPostBack) {
   // do your thing
} 
```

* * *

你真的不需要设置变量，就像乔纳森的解决方案一样。客户端 if 语句将正常工作，因为“isPostBack”变量将未定义，在该 if 语句中评估为 false。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2010-08-24T14:26:01.270

还有一种更简单的方法，不需要在后面的代码中编写任何内容：只需将此行添加到您的 javascript 中：

```
if(<%=(Not Page.IsPostBack).ToString().ToLower()%>){//Your JavaScript goodies here} 
```

或者

```
if(<%=(Page.IsPostBack).ToString().ToLower()%>){//Your JavaScript goodies here} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-03-01T14:01:56.427

嗨尝试以下...

```
function pageLoad (sender, args) {

alert (args._isPartialLoad);

} 
```

结果是一个布尔值

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-10-20T19:42:21.620

该解决方案对我不起作用，我必须对其进行调整：

```
protected void Page_Load(object sender, EventArgs e)
{
    string script;
    if (IsPostBack)
    {
        script = "var isPostBack = true;";
    }
    else
    {
        script = "var isPostBack = false;";
    }
    Page.ClientScript.RegisterStartupScript(GetType(), "IsPostBack", script, true);
} 
```

希望这可以帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-12T18:39:53.403

您可以在页面上放置一个隐藏的输入，并在页面加载后给它一个值。然后你可以检查那个字段，如果它在帖子数据中，它是一个回发，否则它不是。

有两种使用服务器端代码（特定于 ASP.NET）作为响应发布的解决方案。我认为值得指出的是，该解决方案与技术无关，因为它仅使用客户端功能，这些功能在所有主要浏览器中都可用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-11-18T21:07:59.657

试试这个，在这个 JS 中，我们可以检查它是否被回发，并相应地在相应的循环中执行操作。

```
 window.onload = isPostBack;

    function isPostBack() {

        if (!document.getElementById('clientSideIsPostBack')) {
            return false;
        }

        if (document.getElementById('clientSideIsPostBack').value == 'Y') {

            ***// DO ALL POST BACK RELATED WORK HERE***

            return true;
        }
        else {

            ***// DO ALL INITIAL LOAD RELATED WORK HERE***

            return false;
        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-12T18:39:57.257

您可以创建一个值为 0 的隐藏文本框。将 onLoad() 代码放在 if 块中，检查以确保隐藏文本框值为 0。如果它是执行代码并将文本框值设置为 1。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-12T18:40:53.947

这是一种方法（将其放入 Page_Load）：

```
if (this.IsPostBack)
{
    Page.ClientScript.RegisterStartupScript(this.GetType(),"PostbackKey","<script type='text/javascript'>var isPostBack = true;</script>");
} 
```

然后只需检查 JS 中的该变量。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-12T18:47:05.383

这里有很多选择。

对于纯 JS 解决方案，让您的页面提交给自身，但带有额外的 URL 参数 (mypage.html?postback=true) - 然后您可以使用 window.location.href 获取页面 url，并使用拆分或正则表达式解析它寻找你的变量。

假设您发送回某种脚本语言来处理页面（php/perl/asp/cf 等），更简单的方法是让它们在页面中回显一行 javascript 设置变量：

```
<html>

<?php
if ($_POST['myVar']) {
    //postback
    echo '<script>var postingBack = true;</script>';
    //Do other processing
} else {
    echo '<script>var postingBack = false;</script>'
 } ?>
<script>
function myLoader() {
     if (postingBack == false) {
          //Do stuff
     }
 }

<body onLoad="myLoader():"> ... 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-12T00:19:38.080

在其中创建一个全局变量并应用该值

```
<script>
       var isPostBack = <%=Convert.ToString(Page.IsPostBack).ToLower()%>;
</script> 
```

然后你可以从其他地方引用它

# networking - 在 .net 中查找网络别名

> ID：59726
> 
> 赞同：1
> 
> 时间：2008-09-12T18:40:05.463
> 
> 标签：networking, .net-2.0, alias

.net 2.0 中有没有办法发现运行我的代码的机器的网络别名？具体来说，如果我的工作组将我的机器视为 //jekkedev01，我如何以编程方式检索该名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T10:14:46.683

由于您可以有多个网络接口，每个网络接口可以有多个 IP，并且任何单个 IP 可以有多个可以解析到它的名称，因此可能不止一个。

如果你想知道你的 DNS 服务器知道你的机器的所有名称，你可以像这样遍历它们：

```
public ArrayList GetAllDnsNames() {
  ArrayList names = new ArrayList();
  IPHostEntry host;
  //check each Network Interface
  foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces()) {
    //check each IP address claimed by this Network Interface
    foreach (UnicastIPAddressInformation i in nic.GetIPProperties().UnicastAddresses) {
      //get the DNS host entry for this IP address
      host = System.Net.Dns.GetHostEntry(i.Address.ToString());
      if (!names.Contains(host.HostName)) {
        names.Add(host.HostName);
      }
      //check each alias, adding each to the list
      foreach (string s in host.Aliases) {
        if (!names.Contains(s)) {
          names.Add(s);
        }
      }
    }
  }
  //add "simple" host name - above loop returns fully qualified domain names (FQDNs)
  //but this method returns just the machine name without domain information
  names.Add(System.Net.Dns.GetHostName());

  return names;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T09:08:13.690

如果您需要计算机描述，它存储在注册表中：

*   钥匙：`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\lanmanserver\parameters`
*   值名称：`srvcomment`
*   数据类型：`REG_SZ (string)`

AFAIK 它与任何域服务器或 PC 所连接的网络无关。

对于与网络相关的任何内容，我使用以下内容：

*   NETBIOS 名称：`System.Environment.MachineName`
*   主机名：`System.Net.Dns.GetHostName()`
*   DNS 名称：`System.Net.Dns.GetHostEntry("LocalHost").HostName`

如果 PC 有多个 NETBIOS 名称，我不知道任何其他方法，只能根据它们解析到的 IP 地址对名称进行分组，如果 PC 有多个网络接口，即使这样也不可靠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T20:43:42.147

我不是 .NET 程序员，但[System.Net.DNS.GetHostEntry](http://msdn.microsoft.com/en-us/library/system.net.dns.gethostentry.aspx)方法看起来像您需要的。它返回包含 Aliases 属性的[IPHostEntry](http://msdn.microsoft.com/en-us/library/system.net.iphostentry.aliases.aspx)[类](http://msdn.microsoft.com/en-us/library/system.net.iphostentry_members.aspx)的实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T18:46:59.627

使用[System.Environment](http://msdn.microsoft.com/en-us/library/system.environment.aspx)类。它有一个用于检索机器名称的属性，该名称是从 NetBios 中检索的。除非我误解了你的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T19:12:00.177

或 My.Computer.Name

# javascript - 使用 IE 和 SSL 编写 Dojo

> ID：59734
> 
> 赞同：6
> 
> 时间：2008-09-12T18:44:44.983
> 
> 标签：javascript, internet-explorer, ssl, dojo

我的应用程序在*仅 SSL 的*网站上使用**Dojo 1.1.1 。**它目前正在利用和一个.*`dijit.ProgressBar``dijit.form.DateTextBox`*

 **在Firefox 2 & 3*中一切正常，但只要我在*IE7*中尝试相同的脚本，结果就是一个烦人的安全信息对话框：

> 此页面包含安全和非安全项目。是否要显示非安全项目？

我已经仔细检查了该页面是否有任何*非 HTTPS*引用无济于事。它似乎是特定于`dojo.js`. 曾经有过设置为空的`iframe`故障`src`，但现在似乎已修复（在查看源代码时）。

还有其他人有这个问题吗？让*Dojo在**仅 SSL 的*Web 服务器上与*IE配合使用的最佳实践是什么？*

 ** * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-16T14:19:24.510

在查看了 Dijit 的 JavaScript 源代码后，我认为错误可能是由于对动态生成的 IFRAME 的“不安全”引用造成的。请注意，脚本文件有两个版本，未压缩的代表原始源 (dijit.js.uncompressed.js) 和标准 (dijit.js) 已被压缩以获得最佳传输时间。

由于未压缩的版本是最易读的，我将以此为基础描述我的解决方案。在第 #1023 行，一个 IFRAME 在 JavaScript 中呈现：

```
if(dojo.isIE){
    var html="<iframe src='javascript:\"\"'"
           + " style='position: absolute; left: 0px; top: 0px;"
           + "z-index: -1; filter:Alpha(Opacity=\"0\");'>";
    iframe = dojo.doc.createElement(html);
}else{... 
```

有什么问题？IE 不知道 IFRAME 的 src 是否“安全” - 所以我将其替换为以下内容：

```
if(dojo.isIE){
    var html="<iframe src='javascript:void(0);'"
           + " style='position: absolute; left: 0px; top: 0px;"
           + "z-index: -1; filter:Alpha(Opacity=\"0\");'>";
    iframe = dojo.doc.createElement(html);
}else{... 
```

这是 IE 中 JavaScript 工具包和 SSL 最常见的问题。由于 IFRAME 被用作垫片，因为对 DIV 的覆盖支持不佳，所以这个问题非常普遍。

我的前 5-10 个页面重新加载很好，但随后安全错误再次开始弹出。这怎么可能？相同的页面在 5 次重新加载时是“安全的”，然后在第 6 次加载时被 IE 选择为“不安全”。

事实证明，在 dijit.wai 的 onload 事件中还设置了一个背景图像（第 1325 行）。这读起来像这样；

```
div.style.cssText = 'border: 1px solid;'
                  + 'border-color:red green;'
                  + 'position: absolute;'
                  + 'height: 5px;'
                  + 'top: -999px;'
                  + 'background-image: url("' + dojo.moduleUrl("dojo", "resources/blank.gif") + '");'; 
```

这不起作用，因为 background-image 标记不包含 HTTP。尽管该位置是相对的，但 IE7 不知道它是否安全，因此会发出警告。

在此特定实例中，此 CSS 用于测试 Dojo 中的可访问性 (A11y)。由于这不是我的应用程序将支持的内容，并且由于此方法存在其他一般错误问题，因此我选择删除 dijit.wai 的 onload() 中的所有内容。

一切都很好！页面加载没有零星的安全问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-13T09:31:50.500

如果您的页面正在从非 https 的 URL 加载文件，Firefox 应该会告诉您同样的事情。底部（在状态栏中）的锁定符号应该被划掉，而不是错误。你确定不是这样吗？

如果您看到该符号，请单击它并检查哪些文件是“不安全的”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-28T20:31:19.343

如果您使用 CDN，您可以通过 HTTPS 包含所有模块，如此[处所示](https://groups.google.com/group/google-ajax-search-api/browse_thread/thread/08f8643c75311d05)。

```
<script type="text/javascript">
djConfig = {
  modulePaths: {
    "dojo": "https://ajax.googleapis.com/ajax/libs/dojo/1.3.2/dojo",
    "dijit": "https://ajax.googleapis.com/ajax/libs/dojo/1.3.2/dijit",
    "dojox": "https://ajax.googleapis.com/ajax/libs/dojo/1.3.2/dojox"
  }
};

</script>
<script src="https://ajax.googleapis.com/ajax/libs/dojo/1.3.2/dojo/dojo.xd.js" type="text/javascript"></script> 
```

如果需要，您可以使用各种版本进行测试。目前最新的是`1.6.1`

# zip - 恢复损坏的 zip 或 gzip 文件？

> ID：59735
> 
> 赞同：5
> 
> 时间：2008-09-12T18:44:47.403
> 
> 标签：zip, gzip, recovery, corrupt

损坏压缩文件的最常见方法是无意中执行 ASCII 模式 FTP 传输，这会导致 CR 和/或 LF 字符的多对一丢弃。

显然，存在信息丢失，解决此问题的最佳方法是再次传输，以 FTP 二进制模式。

但是，如果原件丢失，而且很重要，那么数据的可恢复性如何？

[实际上，我已经知道我认为最好的答案（这非常困难但有时可能 - 我稍后会发布更多），以及常见的非答案（大量用于修复 CRC 而不修复数据的现成程序)，但我认为在 stackoverflow 测试期间尝试这个问题会很有趣，看看是否有其他人走上了成功恢复的道路或发现了我不知道的工具。]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-12T20:05:05.633

来自[Bukys 软件](http://wayback.archive.org/web/jsp/Interstitial.jsp?seconds=5&date=1195189396000&url=http%3A%2F%2Fwww.bukys.com%2Fservices%2Frecovery%2Fexamples%2F&target=http%3A%2F%2Fweb.archive.org%2Fweb%2F20071116050316%2Fhttp%3A%2F%2Fwww.bukys.com%2Fservices%2Frecovery%2Fexamples%2F)

> 已知大约 256 个字节中的 1 个已损坏，并且已知损坏仅发生在值为“\012”的字节中。所以字节错误率为 1/256（输入的 0.39%），2/256 字节（输入的 0.78%）是可疑的。但是由于每个被破坏的字节只有三位受到影响，因此误码率只有 3/(256*8)：0.15% 是坏的，0.29% 是可疑的。
> 
> ...
> 
> 压缩输入中的错误会破坏所有后续字节的解压缩过程......解压缩输出如此之快就可以识别出糟糕的事实是令人希望的原因 - 搜索正确答案可以快速识别错误答案。
> 
> 最终，结合了多种技术，成功地从这些文件中提取了合理的数据：
> 
> *   字段和引用字符串的特定于域的解析
> *   从损坏概率低的先前数据中进行机器学习
> *   容忍其他原因导致的文件损坏（例如，记录时磁盘已满）
> *   引导搜索沿着最高概率路径的前瞻
> 
> 这些技术可以确定地确定 75% 的必要修复，其余的则以最高概率优先进行探索，以便立即确定合理的重建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T18:52:12.157

您可以尝试编写一个小脚本，用 CRLF 替换所有 CR（假设垃圾的方向是 CRLF 到 CR），每个块随机交换它们，直到您获得正确的 crc。假设数据不是特别大，我猜可能不会使用你所有的 CPU，直到宇宙热寂完成。

由于存在一定的信息丢失，我不知道有没有更好的方法。CR 到 CRLF 方向的损失可能更容易回滚。

# captcha - 那么，如果 CAPTCHA 即将退出市场，接下来会发生什么？

> ID：59736
> 
> 赞同：6
> 
> 时间：2008-09-12T18:45:57.837
> 
> 标签：captcha

随着文本识别的改进和 CAPTCHA 破解者使用 Mechanical Turks 来破解其他牢不可破的密钥，下一个技术是什么可以防止脚本对依赖用户输入的网站进行垃圾邮件机器人攻击？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-12T18:51:40.223

我喜欢“隐形验证码”的概念。Phil Haack[在这里](http://haacked.com/archive/2006/09/26/Lightweight_Invisible_CAPTCHA_Validator_Control.aspx)详细介绍了一种实现。

这依赖于机器人、蜘蛛和爬虫不实现 javascript 引擎的事实。这也可能在不久的将来发生变化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-12T18:58:28.820

目前，声誉系统更难被击败。在不久的将来，社区网站将需要依靠其更高级别的成员来删除垃圾邮件。

垃圾邮件的趋势是越来越难以与合法内容区分开来，每一代新一代的机械过滤器都会像过度使用抗生素一样死于无害。

随着垃圾邮件发送者开始维护 sock-puppet 农场以创建自己的高级成员，甚至声誉系统也将变得无用，当社区反击时，垃圾邮件发送者将喂食 sock-puppet 的流失，就好像这只是做生意的另一项成本.

如果您要建立一个接收用户内容的网站，您要么需要订阅永无止境的 CAPTCHA 继任者，要么首先找到一种方法来消除向您的网站发送垃圾邮件的动机。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-12T18:55:28.157

图像识别而不是文本识别。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-12T18:48:26.690

我喜欢使用信用卡或手机短信（如 Craigslist 和 Gmail）限制登录。这些方法成本不高（<1 美元），但可以非常有效地控制垃圾邮件帐户。

然而，这在像 SO 这样的网站上很棘手，因为创始目标之一是尽量减少摩擦并允许匿名用户做出贡献。我想这就是限制和投票发挥作用的地方。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-10T14:46:00.400

机器人很难打败。在我参与的一个网站上，我们甚至没有使用验证码——只是一个标有“将此字段留空”的字段。机器人总是未能通过这个非常简单的测试。

更大的问题是大规模人类解决。有很多实现，用户可以通过解决屏幕抓取的验证码来换取一些东西，比如视频或图像（你知道我的意思）。这意味着有一个真正的人来解决验证码，所以情感、面部和更复杂的模式是没有意义的。

多步骤流程会阻止这种行为，但代价是让真正的访问者变得更难，当我们都在尝试设计更实用的网站时，这是可悲的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-12T21:41:29.380

计算机不擅长而人类擅长的问题将不断提高标准。识别人脸的情绪是人类特别擅长的事情。

另一种选择可能是区分恶心或好。这完全是主观的，但人类往往讨厌腐烂的食物、开放性伤口、便便等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-13T11:52:29.367

[负图灵测试。](http://code.google.com/p/negative-turing-test/)已经在 WordPress、IP.Board 和 MediaWiki 网站上使用了一年多，并且绝对零垃圾邮件。唯一的问题：您必须考虑一个既不常见（否则，机器人会适应）也不过于特定领域（否则潜在用户可能不知道答案）的问题/答案组合。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-03-28T15:46:49.037

城里有一个新工具——Captcha 2.0，它是由一家以色列在线安全初创公司开发的，专门用于检测和验证验证码农场。[您可以在http://www.siteblackbox.com/captchaService.php](http://www.siteblackbox.com/captchaService.php)查看并免费试用

拉兹

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T05:59:35.203

通常，对于需要保护具有任何价值的资源的站点，您需要三管齐下的方法：

*   仅限制来自经过身份验证的用户的响应，禁止匿名帖子。
*   最小化（而不是阻止）来自经过身份验证的用户的少量垃圾帖子 - 例如基于声誉的。
*   使用服务器端启发式逻辑来识别类似垃圾邮件的行为，或者更好的非人类行为。

当然，人工版主也可以提供帮助，但是您还有其他问题 - 即淹没（甚至淹死）版主，并且一些网站更喜欢开放性......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-26T14:24:37.470

基于加密货币的验证码 -

[http://speedcoin.co/info/captcha/Speedcoin_Captcha.html](http://speedcoin.co/info/captcha/Speedcoin_Captcha.html)

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2008-09-12T18:53:09.410

防止人们对用户输入站点进行垃圾邮件攻击的最基本工具是链接上的“nofollow”标签。大多数评论垃圾邮件发送者对 Google 果汁感兴趣，而不是实际看到他们的东西，因此 nofollow 消除了激励。

# puzzle - 可能组合的数量

> ID：59743
> 
> 赞同：5
> 
> 时间：2008-09-12T18:50:34.020
> 
> 标签：puzzle

如果我知道，变量 a、b、c、d、e 有多少种可能的组合：

```
a+b+c+d+e = 500 
```

并且它们都是整数并且> = 0，所以我知道它们是有限的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-12T20:04:30.877

@Torlack，@Jason Cohen：递归在这里是个坏主意，因为存在“重叠的子问题”。即，如果您选择`a`as`1`和`b`as `2`，那么您还有 3 个变量加起来应该是 497；通过选择`a`as`2`和`b`as ，您会得到相同的子问题`1`。（这种巧合的数量随着数字的增长而爆炸式增长。）

解决此类问题的传统方法是[动态规划](http://en.wikipedia.org/wiki/Dynamic_programming)：构建一个自下而上的子问题解决方案表（从“1 个变量的多少组合加起来为 0？”开始）然后通过迭代构建（ “ *n 个*变量的多少组合加起来为*k ？”的解是“* *n-1 个*变量的多少组合加起来为*j*？”的解的总和，其中 0 <= *j* <= *k*）。

```
public static long getCombos( int n, int sum ) {
  // tab[i][j] is how many combinations of (i+1) vars add up to j
  long[][] tab = new long[n][sum+1];
  // # of combos of 1 var for any sum is 1
  for( int j=0; j < tab[0].length; ++j ) {
    tab[0][j] = 1;
  }
  for( int i=1; i < tab.length; ++i ) {
    for( int j=0; j < tab[i].length; ++j ) {
      // # combos of (i+1) vars adding up to j is the sum of the #
      // of combos of i vars adding up to k, for all 0 <= k <= j
      // (choosing i vars forces the choice of the (i+1)st).
      tab[i][j] = 0;
      for( int k=0; k <= j; ++k ) {
        tab[i][j] += tab[i-1][k];
      }
    }
  }
  return tab[n-1][sum];
} 
```

```
$时间java组合
2656615626

实际0m0.151s
用户 0m0.120s
系统 0m0.012s

```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-12T19:57:33.187

**您的问题的答案是 2656615626**。

这是生成答案的代码：

```
public static long getNumCombinations( int summands, int sum )
{
    if ( summands <= 1 )
        return 1;
    long combos = 0;
    for ( int a = 0 ; a <= sum ; a++ )
        combos += getNumCombinations( summands-1, sum-a );
    return combos;
} 
```

在您的情况下，`summands`是 5 并且`sum`是 500。

**请注意，此代码很慢**。如果您需要速度，请缓存对的结果`summand,sum`。

我假设你想要数字`>=0`。如果需要`>0`，请将循环初始化替换为`a = 1`，将循环条件替换为`a < sum`。我还假设您想要排列（例如`1+2+3+4+5`加号`2+1+3+4+5`等）。如果需要，您可以更改 for 循环`a >= b >= c >= d >= e`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-12T20:03:43.453

几个月前，我为我父亲解决了这个问题……扩展供您使用。这些往往是一次性问题，所以我没有选择最可重复使用的......

a+b+c+d = 总和

i = 组合数

```
 for (a=0;a<=sum;a++)
        {
            for (b = 0; b <= (sum - a); b++)
            {
                for (c = 0; c <= (sum - a - b); c++)
                {
                    //d = sum - a - b - c;
                    i++
                }
            }
        } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-12T22:43:34.270

这实际上是一个在面试中问的好问题，因为它很简单，你可以在白板上写下来，但又很复杂，如果他们考虑得不够仔细，可能会绊倒他们。此外，您还可以提供两个不同的答案，这会导致实现完全不同。

**顺序很重要**
如果顺序很重要，那么任何解决方案都需要允许任何变量出现零；因此，最直接的解决方案如下：

```
public class Combos {
    public static void main() {
        long counter = 0;

        for (int a = 0; a <= 500; a++) {
            for (int b = 0; b <= (500 - a); b++) {
                for (int c = 0; c <= (500 - a - b); c++) {
                    for (int d = 0; d <= (500 - a - b - c); d++) {
                        counter++;
                    }
                }
            }
        }
        System.out.println(counter);
    }
} 
```

返回 2656615626。

**顺序**
无关紧要如果顺序无关紧要，那么解决方案并不难，因为您只需要确保零​​是不可能的，除非已经找到总和。

```
public class Combos {
    public static void main() {
        long counter = 0;

        for (int a = 1; a <= 500; a++) {
            for (int b = (a != 500) ? 1 : 0; b <= (500 - a); b++) {
                for (int c = (a + b != 500) ? 1 : 0; c <= (500 - a - b); c++) {
                    for (int d = (a + b + c != 500) ? 1 : 0; d <= (500 - a - b - c); d++) {
                        counter++;
                    }
                }
            }
        }
        System.out.println(counter);
    }
} 
```

返回 2573155876。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-12T19:14:19.017

一种看待问题的方法如下：

首先，a 可以是 0 到 500 之间的任何值。然后如果遵循 b+c+d+e = 500-a。这将问题减少了一个变量。递归直到完成。

例如，如果 a 为 500，则 b+c+d+e=0，这意味着对于 a = 500 的情况，b、c、d 和 e 的值只有一种组合。

如果a是300，那么b+c+d+e=200，其实和原来的问题是同一个问题，只是减少了一个变量。

注意：正如 Chris 所指出的，这是一种实际尝试解决问题的可怕方式。

[链接文本](https://stackoverflow.com/questions/59743/number-of-possible-combinations#59833 "看他的回复")

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-12T18:54:01.547

如果它们是实数，则无限......否则它有点棘手。

（好吧，对于实数的任何计算机表示都会有一个有限的计数......但它会很大！）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-11T17:14:37.240

有通式，如果
a + b + c + d = N
则非负积分解的个数为`C(N + number_of_variable - 1, N)`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-11-05T08:13:18.003

@Chris Conway 的答案是正确的。我已经使用适用于较小金额的简单代码进行了测试。

```
 long counter = 0;
            int sum=25;

            for (int a = 0; a <= sum; a++) {
                for (int b = 0; b <= sum ; b++) {
                    for (int c = 0; c <= sum; c++) {
                        for (int d = 0; d <= sum; d++) {
                             for (int e = 0; e <= sum; e++) {
                           if ((a+b+c+d+e)==sum) counter=counter+1L;

                             }
                       }
                    }
                }
            }
            System.out.println("counter e "+counter); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-06-22T15:35:08.413

数学答案是 504!/(500!* 4!)。

形式上，对于 x1+x2+...xk=n，非负数 x1,...xk 的组合数是二项式系数： (k-1)-combination out of a set of (n+k-1)元素。

直觉是从 (n+k-1) 个点中选择 (k-1) 个点，并使用两个所选点之间的点数来表示 x1,..xk 中的一个数字。

抱歉，我第一次回答 Stack Overflow 的数学版很差。

`Just a test for code block`

```
Just a test for code block

    Just a test for code block 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-12T19:19:45.743

包括底片？无限的。

只包括正面？在这种情况下，它们不会被称为“整数”，而是“自然数”。在这种情况下......我无法真正解决这个问题，我希望我能，但我的数学太生疏了。可能有一些疯狂的整体方法来解决这个问题。我可以为周围的数学高手提供一些指导。

最终结果是 x，a 的范围是从 0 到 x，b 的范围是从 0 到 (x - a)，c 的范围是从 0 到 (x - a - b)，并且依此类推，直到 e。

答案是所有这些可能性的总和。

我正在尝试在 Google 上找到一些更直接的公式，但我今天的 Google-Fu 真的很低......

# internet-explorer-6 - 禁用 IE 6 中的特定键

> ID：59761
> 
> 赞同：0
> 
> 时间：2008-09-12T19:00:32.917
> 
> 标签：internet-explorer-6, kiosk

我需要禁用 Internet Explorer 6 中的特定键（Ctrl 和 Backspace）。是否有注册表黑客可以做到这一点。它必须是IE6。谢谢。

长编辑：

@apandit：哎呀。我需要更具体地说明退格的事情。当我说禁用退格时，我的意思是禁用退格模仿后退浏览器按钮的能力。在 IE 中，当焦点不在文本输入字段中时按 Backspace 相当于按 Back（浏览到上一页）。

至于 Ctrl 键。有些页面具有创建新 IE 窗口的链接。我打开了弹出窗口阻止程序，它阻止了这个。但是，Ctrl 单击会导致新窗口启动。

这是针对信息亭应用程序，目前是基于 Web 的应用程序。客户目前没有资金使他们的站点信息亭友好。URL 过滤和禁用 URL 输入字段之类的事情已经完成。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-12T19:12:16.277

你需要这个有什么目的？因为禁用退格键对于输入 url 或电子邮件等来说是地狱。

如果我们更了解问题，我们可以推荐其他解决方法。

编辑1：
这个网站似乎有一些关于它是如何完成的信息。我目前无法验证，但我会调查一下： [http ://www.ozzu.com/programming-forum/disable-key-and-back-t44867.html](http://www.ozzu.com/programming-forum/disable-key-and-back-t44867.html)

编辑 2：
这个网站有一些关键代码： http: [//www.advscheduler.com/docs/manual/type_sendkeys.html](http://www.advscheduler.com/docs/manual/type_sendkeys.html) 似乎 BACKSPACE 是 08。

编辑 3：
找到更多用于阻塞的代码，请查看：

```
<script type="text/javascript">var sType = "keypress";</script>

<!--[如果是 IE]>
<script type="text/javascript">sType = "keydown";</script>
<![endif]-->

<script type="text/javascript">
fIntercept = 函数（e）{
   // 警报（e.keyCode）；
  e = e || 事件.e;
  如果（e.keyCode == 116）{
   // 当 F5 被按下时
   f取消(e)；
  } else if (e.ctrlKey && (e.keyCode == 0 || e.keyCode == 82)) {
   // 当用 R 按下 ctrl 时
   f取消(e)；
  }
};

fCancel = 函数（e）{
  if (e.preventDefault) {
   e.stopPropagation();
   e.preventDefault();
  } 别的 {
   e.keyCode = 0;
   e.returnValue = 假；
   e.cancelBubble =真；
  }
  返回假；
};

fAddEvent = 函数（obj，类型，fn）{
  如果（obj.addEventListener）{
   obj.addEventListener(type, fn, false);
  } 别的 {
   obj['e'+type+fn] = fn;
   obj[类型+fn] = 函数（）{
    obj['e'+type+fn](window.event);
   }
   obj.attachEvent('on'+type, obj[type+fn]);
  }
};

fAddEvent(document, sType, fIntercept);
</脚本>

```

好的，现在您应该拥有所需的一切。要禁用退格键，键码是 08。您可能只需使用我发布的代码，只需稍作修改...：\

尝试一下，看看它是否是您需要的。（我希望你知道如何使用 Javascript。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T19:17:59.180

你不能从网页上做到这一点。网络浏览器的主要目的之一是保护用户免受互联网的侵害。它们定义了一组非常具体的网站可以做的事情，禁用按钮不在列表中。

另一方面，如果您是网络管理员并且只想惹恼您的用户，您也许可以通过一些桌面软件来做到这一点。但我不会屏住呼吸。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-28T17:14:33.393

我正在使用这个 jQuery 解决方案（在 ie6 和 firefox 3.6 上测试）：

```
$(document).keydown(function(e) {
    var tag = e.target.tagName;
    var ro = e.target.readOnly;
    var type = e.target.type;
    变量标签 = {
        输入 ： ''，
        文本区域：''
    };
    if (e.keyCode == 8) {// 退格
        if (!(tag in tags && !ro && /text/.test(type))) {
            e.stopPropagation();
            e.preventDefault();
        }
    }
});    

```

希望它可以帮助某人

# asp.net - 如何让 JavaScript/jQuery Intellisense 在 Visual Studio 2008 中工作？

> ID：59766
> 
> 赞同：93
> 
> 时间：2008-09-12T19:03:27.293
> 
> 标签：asp.net, javascript, jquery, visual-studio, intellisense

我认为应该使用 SP1 改进 jQuery Intellisense。我什至下载了 jQuery 1.2.6 的注释版本，但智能感知无法在单独的 jscript 文件中工作。我在我的网页上的 <head> 标记中首先引用了 jQuery 库。我做错什么了吗？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-09-12T19:06:09.753

在外部 JavaScript 文件的顶部，添加以下内容：

```
/// <reference path="jQuery.js"/> 
```

确保路径正确，相对于文件在文件夹结构中的位置等。

此外，任何引用都需要位于文件的顶部，在*任何*其他文本之前，包括注释 - 从字面上看，文件中的第一件事。希望 Visual Studio 的未来版本无论它在文件中的什么位置都能正常工作，或者他们可能会做一些完全不同的事情......

完成此操作并*保存文件*后，点击`Ctrl`++`Shift`强制`J`Visual Studio 更新 Intellisense。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-07T06:06:33.757

Visual Studio 2008 有一个官方支持的 jQuery 文档 JavaScript 文件。该文件只是一个临时修复程序，直到 Microsoft 发布更充分地解决该问题的修补程序。

嵌入在 ASPX 中：

```
<% if (false) { %>
    <script src="jquery-1.2.6-vsdoc.js" type="text/javascript"></script>
<% } %> 
```

嵌入在 JavaScript 中：

```
/// <reference path="jquery-1.2.6-vsdoc.js" /> 
```

在这里拿起它：[jquery-1.2.6-vsdoc.js](http://code.google.com/p/jqueryjs/downloads/detail?name=jquery-1.2.6-vsdoc.js)

**参考资料**：

*   [丰富的 jQuery 智能感知](http://blogs.msdn.com/webdevtools/archive/2008/10/28/rich-intellisense-for-jquery.aspx)
*   [Scott Hanselman - ASP.NET 和 jQuery](http://www.hanselman.com/blog/ASPNETAndJQuery.aspx)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-14T03:37:07.390

你会想看看这个链接：

[http://blogs.ipona.com/james/archive/2008/02/15/JQuery-IntelliSense-in-Visual-Studio-2008.aspx](http://blogs.ipona.com/james/archive/2008/02/15/JQuery-IntelliSense-in-Visual-Studio-2008.aspx)

更新：Visual Studio 2008 有一个新的 HotFix 和一个新的 jQuery Intellisense 文档文件，它将完整的 jQuery Intellisense 带入 VS'08。以下是获取这两个的链接：

[http://blogs.msdn.com/webdevtools/archive/2008/11/07/hotfix-to-enable-vsdoc-js-intellisense-doc-files-is-now-available.aspx](http://blogs.msdn.com/webdevtools/archive/2008/11/07/hotfix-to-enable-vsdoc-js-intellisense-doc-files-is-now-available.aspx)

[http://blogs.msdn.com/webdevtools/archive/2008/10/28/rich-intellisense-for-jquery.aspx](http://blogs.msdn.com/webdevtools/archive/2008/10/28/rich-intellisense-for-jquery.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-02T17:23:44.953

对于内联 JavaScript，请使用：

/// <reference path="~\js\jquery-vsdoc.js"/>

注意***反斜杠***。

这将不起作用：

/// <reference path="~/js/jquery-vsdoc.js"/>

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-13T00:56:06.083

您不需要实际引用“-vsdoc”版本。如果将 jquery-1.2.6-vsdoc.js 与 jquery-1.2.6.js 放在同一目录中，则 Visual Studio 将知道将 jquery-1.2.6.js 引用转换为 jquery-1.2.6-vsdoc。 js。

我认为这实际上适用于任何文件。

嗯......这为这个网站上的另一个问题提供了一个很好的解决方法......

编辑：此功能仅适用于 VS2008 Service Pack 1。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-02T15:38:54.803

如果您在源代码中包含带注释的 jQuery 文件仅用于智能感知，我建议在编译时利用预处理器指令将其从视图中删除。翼：

```
<% #if (false) %>
  <!-- This block is here for jquery intellisense only.  It will be removed by the compiler! -->
  <script type="text/javascript" src="Scripts/jquery-1.3.2-vsdoc.js"></script>
<% #endif %> 
```

然后稍后在您的代码中，您可以*真正*引用 jQuery。这在使用[Google AJAX Libraries API](http://code.google.com/apis/ajaxlibs/)时很方便，因为您可以获得 Google 为您提供的所有好处，以及智能感知。

以下是使用库 API 的示例：

```
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
   google.load("jquery", "1.3.2", { uncompressed: false });
</script> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T06:31:00.253

确保您没有使用最小化的 jQuery 文件。

将 JavaScript 文件添加到项目后，使用`Ctrl`++`Shift`使其工作。`J`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-10T12:59:45.057

[Visual Studio 2008 中的 jQuery 智能感知](http://codeasp.net/articles/jquery-intellisense-in-visual-studio-2008/102/tips-tricks-of-visual-studio)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-21T03:19:40.210

如果您想从 Microsoft CDN 获取 Intellisense 文件，您可以使用：

```
/// <reference path="http://ajax.microsoft.com/ajax/jQuery/jquery-1.4.1-vsdoc.js" /> 
```

# visual-studio-2008 - 在 VS2008 中使用 FF3 调试

> ID：59768
> 
> 赞同：5
> 
> 时间：2008-09-12T19:05:27.960
> 
> 标签：visual-studio-2008, firefox, ide

我正在使用 Firefox 3 在 Visual Studio 2008 中调试我的 ASP.NET 应用程序。如何配置 FF3 或 VS2008，以便在退出 Firefox 时不必点击 Visual Studio 中的停止调试按钮？（你用 IE 得到的行为）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T15:08:09.063

我对此的解决方案是手动将调试器附加到相关浏览器和 aspnet_wp 进程。完成后，我只是将所有内容分离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T15:12:44.417

根据 Raithlin 的建议，Ctrl+Alt+P 是打开 Attach to Process 窗口的有用快捷方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T22:49:59.497

我有相同的东西。我假设您正在使用 Cassini（集成的 Web 服务器）。

我还没有找到答案（我只是回到 VS 并按*Shift+F5*停止调试器），但我可以告诉你，如果你选中项目属性中的*“编辑并继续”*框（web选项卡），您的 Web 服务器将在您运行应用程序时停止并重新启动。

它不能解决整个问题，但对我来说已经足够了。

# c# - 如何使用 WPF 在 Visual C# 2008 中获取自定义应用程序名称和启动窗口名称？

> ID：59786
> 
> 赞同：0
> 
> 时间：2008-09-12T19:16:53.207
> 
> 标签：c#, visual-studio-2008

我正在使用 Microsft Visual C# 2008 并正在创建 WPF 应用程序。如果您创建一个新的解决方案并选择 WPF 应用程序模板，它允许您提供一个字符串来命名该解决方案。

然后它会自动将该字符串转换为基本项目名称和使用下划线而不是空格的命名空间。它还生成一个继承自名为 App 的应用程序类的类和一个包含名为 Window1 的 Grid 控件的起始窗口。

我想定制几乎所有东西。

重命名 App、Window1 和不会破坏解决方案的起始命名空间的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-12T20:36:24.827

按着这些次序：

1.  在解决方案资源管理器中重命名应用程序和窗口 .xaml。

2.  编辑应用程序的 .xaml（最初是 App.xaml），使 StartupUri 指向启动窗口的新名称，该行将如下所示：

    StartupUri="Window1.xaml"

3.  在原始窗口的 .cs 代码隐藏窗口中进行编辑，使 Window1 成为新窗口的名称。

4.  在新窗口名称后的下拉列表中使用鼠标将更改的名称复制到其他位置。

5.  编辑窗口的标题。

# java - 如何从正在运行的 JBoss 实例生成和分析线程转储？

> ID：59787
> 
> 赞同：7
> 
> 时间：2008-09-12T19:16:58.010
> 
> 标签：java, multithreading, dump

如何从正在运行的 JBoss 实例生成和分析线程转储？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-12T21:40:41.130

有一个 JBoss 特定的方法，它对用户更加友好：

[http://community.jboss.org/wiki/GenerateAThreadDumpWithTheJMXConsole](http://community.jboss.org/wiki/GenerateAThreadDumpWithTheJMXConsole)

当您无法直接访问主机（“kill”需要）时，这尤其有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-12T19:43:29.803

[http://java.sun.com/developer/technicalArticles/Programming/Stacktrace/](http://java.sun.com/developer/technicalArticles/Programming/Stacktrace/)

...

“在 UNIX 平台上，您可以使用 kill 命令向程序发送信号。这是退出信号，由 JVM 处理。例如，在 Solaris 上，您可以使用命令 kill -QUIT process_id，其中 process_id 是Java 程序的进程号。

或者，您可以在启动 Java 程序的窗口中输入键序列 <ctrl>\。发送此信号指示 JVM 中的信号处理程序，以递归方式打印出有关 JVM 内部线程和监视器的所有信息。”

...

“确定线程状态

您将在来自 JVM 堆栈跟踪的快照中看到处于许多不同状态的许多不同线程。使用的密钥是：

R 正在运行或可运行的线程

S 悬线

CW 线程等待条件变量

MW 线程等待监视器锁

MS 线程挂起等待监视器锁”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-13T02:17:35.067

[此处](http://www.adaptj.com/main/download)找到的 stacktrace 应用程序也很有用，尤其是在未从命令行启动 java 应用程序的 Windows 机器上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T21:54:46.580

`Thread.getAllStackTraces()`（从 Java 1.5 开始）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-21T08:09:18.850

两种选择：

**选项 1** *使用 JMX 控制台生成线程转储*

为了生成线程转储：

1.  打开 JMXConsole（例如`http://localhost:8080`：）
2.  导航到`jboss.system:type=ServerInfo`mbean（***提示：***您可能只需`CTRL`-`F`并在对话框中输入 type=ServerInfo）
3.  单击 Server Info mbean 的链接。
4.  导航到它说的底部`listThreadDump`
5.  单击它并获取您的线程转储

笔记：

如果您使用的是 Internet Explorer，您应该使用它`File > Save As`来保存输出，而不是将数据复制到文本编辑器。由于某种原因，当您从 Internet Explorer 复制文本时，不会复制换行符，并且所有输出都以一行结束。

**选项 2** *使用 Twiddle 生成线程转储*

或者，您可以使用 twiddle 执行该`listThreadDump()`方法并将返回的 HTML 直接通过管道传输到文件。使用这个命令行：

```
<JBOSS_HOME>/bin/twiddle invoke "jboss.system:type=ServerInfo" listThreadDump > threads.html 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-19T18:19:57.183

有时 JBoss 锁定太多，甚至 jmx-concole 都没有响应。在这种情况下，在 Linux 上使用 kill -3，在 Windows 上使用[SendSignal](http://www.latenighthacking.com/projects/2003/sendSignal/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-27T05:36:45.207

[https://community.jboss.org/wiki/ThreadDumpJSP](https://community.jboss.org/wiki/ThreadDumpJSP)页面具有独立的自包含 threaddump.war，可以在没有 JMX 的情况下使用。

# sql-server - 将 xml 传输到 SQL Server 的最佳方式？

> ID：59790
> 
> 赞同：4
> 
> 时间：2008-09-12T19:19:16.540
> 
> 标签：sql-server, xml

我已经听播客博客有一段时间了，我希望我不要打破这个。问题是这样的：我必须将 xml 插入数据库。这将用于已定义的表和字段。那么实现这一目标的最佳方法是什么？到目前为止，我倾向于编程。我一直在看到各种选项，一个是数据传输对象 (DTO)，在 SQL Server 中有用于将 XML 传输到对象和通过代码的 sp_xml_preparedocument。

我正在使用 CSharp 和 SQL Server 2005。这些字段不是 XML 字段，它们是常用的 SQL 数据类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-12T23:15:23.493

为了尝试和帮助，我们可能需要一些澄清。也许通过重述问题，您可以让我们知道这是否是您要问的：

**如何在不依赖内置 xml 类型的情况下将现有 xml 导入 SQL 2005 数据库？**

您已经提到的一个相当直接的解决方案是*sp_xml_preparedocument*与*openxml*结合使用。

希望以下示例说明了正确的用法。有关更完整的示例，请查看有关[Using OPENXML](http://msdn.microsoft.com/en-us/library/ms187897(SQL.90).aspx)的 MSDN 文档。

```
declare @XmlDocumentHandle int
declare @XmlDocument nvarchar(1000)
set @XmlDocument = N'<ROOT>
<Customer>
   <FirstName>Will</FirstName>
   <LastName>Smith</LastName>
</Customer>
</ROOT>'

-- Create temp table to insert data into
create table #Customer 
( 
    FirstName varchar(20),
    LastName varchar(20) 
)
-- Create an internal representation of the XML document.
exec sp_xml_preparedocument @XmlDocumentHandle output, @XmlDocument

-- Insert using openxml allows us to read the structure
insert into #Customer
select 
    FirstName = XmlFirstName,
    LastName = XmlLastName
from openxml ( @XmlDocumentHandle, '/ROOT/Customer',2 )
with 
(
    XmlFirstName  varchar(20) 'FirstName',
    XmlLastName varchar(20) 'LastName'
)
where ( XmlFirstName = 'Will' and XmlLastName = 'Smith' )

-- Cleanup xml document
exec sp_xml_removedocument @XmlDocumentHandle

-- Show the data
select * 
from #Customer

-- Drop tmp table
drop table #Customer 
```

如果您有一个 xml 文件并且正在使用 C#，那么定义一个执行上述操作的存储过程，然后将整个 xml 文件内容作为*字符串*传递给存储过程，应该可以让您以一种相当直接的方式将 xml 导入到您的现有表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T20:06:29.100

您可能希望使用 XSLT 将您的 XML 转换为 SQL 语句...即

```
<xml type="user">
    <data>1</data>
    <data>2</data>
<xml> 
```

然后 XSLT 看起来像

```
<xsl:template match="xml">
    INSERT INTO <xsl:value-of select="@type" /> (data1, data2) VALUES (
       '<xsl:value-of select="data[1]" />',
       '<xsl:value-of select="data[2]" />');
</xsl:template> 
```

match 语句很可能不会是根节点，但希望您明白这一点。您可能还需要将非 xsl:value-of 部分包装在 xsl:text 中，以防止将多余的字符转储到查询中。而且您必须确保 XSLT 的输出是文本。也就是说，您可以获得可以通过数据库运行的 SQL 语句列表。或者您可以使用 XSLT 输出可以作为存储过程加载的 T-SQL 语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T20:34:43.910

如果您的 XML 符合特定的 XSD 架构，您可以研究使用“xsd.exe”命令行工具生成可以将 XML 绑定到的 C# 对象类，然后使用这些对象的属性形成插入语句：[MSDN XSD 文档](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.71).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T20:49:43.547

仔细阅读此文档，它将为您提供以下选项：

MSDN：[Microsoft SQL Server 2005 中的 XML 选项](http://msdn.microsoft.com/en-us/library/ms345110(SQL.90).aspx)

# visual-studio - 技术演示的好技巧

> ID：59793
> 
> 赞同：21
> 
> 时间：2008-09-12T19:20:12.387
> 
> 标签：visual-studio

我计划为我们正在构建的产品进行技术演示。目标受众是技术开发人员。所以，大多数时候，我会通过 Visual Studio 中的代码进行调试、性能分析、一些架构审查等。

我已经阅读了几篇关于要使用的字体大小、在 Visual Studio 上使用的模板、[演示工具](http://weblogs.asp.net/jgalloway/archive/2006/12/05/tips-for-a-technical-presentation.aspx)以及 [其他](http://focs.wordpress.com/2007/09/12/9-tips-how-to-give-a-technical-presentation/)非常[有用的技巧的](http://blogs.msdn.com/kaevans/archive/2005/03/12/394527.aspx)[博客](http://www.hanselman.com/blog/11TopTipsForASuccessfulTechnicalPresentation.aspx)。

我正在寻找的是如何让会话保持有趣而不使其成为枯燥的代码演练？如何避免让人入睡？很高兴听到一些故事..

**更新 1： zoomit**上不错的 youtube 剪辑。[使用 Zoomit 将观众粘合到您的演示文稿中。](http://www.youtube.com/watch?v=4jMLAF-9ACk)

**更新 2 ：Scott Hanselman 在 PDC 演讲后发表的新帖子**-**[准备](http://channel9.msdn.com/pdc2008/TL49/)技术[演示的技巧](http://www.hanselman.com/blog/TipsForPreparingForATechnicalPresentation.aspx)**

 *** * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-12T19:23:51.990

在代码中添加有趣的注释。

// 这最好不要在我的下一次演示中失败，愚蠢的@#$@#%$ 代码。

不要谈论他们，让他们被观众发现。

-亚当

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-12T19:25:41.190

仅供参考，Hanselman 的那篇文章有[更新](http://www.hanselman.com/blog/11TopTipsForASuccessfulTechnicalPresentation.aspx)（您的链接来自 2003 年）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-12T19:33:34.523

使用故事。即使有代码示例，也要有一个背景故事：这就是为什么有人这样做。为了增加观众的参与度，请询问 X 的示例，其中 X 是您知道可以演示的东西，然后用这些术语表达演练。

或者，也许你有关于它有何不同或通常需要更长时间或其他什么的战争故事。我发现人们认同这样的事情，然后当你给出你的例子时，他们会在心理上将其追溯到他们自己的经历。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-12T19:40:57.453

我推荐 Scott Hanselman 的帖子（前面提到过）。我写了一篇带有一些技巧的帖子，主要是出于自私的原因——我每次在做技术演示之前都会回顾它：

[技术演示的提示](http://weblogs.asp.net/jgalloway/archive/2006/12/05/tips-for-a-technical-presentation.aspx)

如果您使用控制台提示符，[请确保字体可读并且尽可能预设路径](http://weblogs.asp.net/jgalloway/archive/2007/07/09/presentation-tricks-command-windows.aspx)。

花 15 分钟安装并学习使用[ZoomIt](https://technet.microsoft.com/en-us/sysinternals/zoomit.aspx)，这样您的观众就可以清楚地看到您在炫耀什么。如果你必须问他们是否能看到一些东西，你已经失败了。

可能最重要的是[使用大的可读字体预先配置单独的 Visual Studio 设置](http://technet.microsoft.com/zh-cn/sysinternals/bb897434(en-us).aspx)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-12T20:22:35.187

我在做演示时得到的最好的建议之一就是提前把它们简单地记录下来，然后回放视频，现场讲述。然后，意想不到的事情私下发生，你会得到尽可能多的刺伤。

您通常仍然需要一些环境来作为问题的参考，但是对于演示部分，提前录制（并在视频中排练您的旁白）几乎可以保证您可以处于游戏的顶端。

我还喜欢在幻灯片和录制的视频中加入一些小笑话，让制作幻灯片的人看起来像是在对现场直播进行评论，或者实际上是其他人在运行幻灯片。通常，我完全没有提及幻灯片中的笑话。

例如，在我[最近的演示演示](http://www.wynia.org/wordpress/2008/09/07/standardized-aspnet-mvc-controller-actions-with-visual-studio-item-templates/)中，我有一张幻灯片，其中以文本“ASP.NET MVC”为中心，我正在谈论我是如何使用该框架的。在较小的字体中，我有文字“Catchy name, huh?”。当我在现场进行演示时，那张幻灯片发出了笑声。它不值得任何想象的站立，但我们经常展示一些非常干燥的东西，每一点都有帮助。

同样，我还包含了幻灯片，这些幻灯片只是来自屏幕外的人对我打算说的内容的简单尖刻评论。所以，我会说，“这个项目的代码库需要一点帮助”，而我身后的幻灯片说“实际上是一堆意大利面和 3 个肉丸”，还有一盘意大利面作为幻灯片背景。再一次，我没有发表任何评论，只是转到下一张幻灯片，好像我什至没有看到它实际上使它变得更有趣。

如果您没有最好的喜剧时机，通过减轻压力同时增加一些轻松感，这也可能会有所帮助。

无论如何，真正归结为我一直在做我的大部分演示/演示工作，就像我在截屏时所做的那样，然后替换为我的现场版本（如果事情发生了，适当暂停视频） rails) 用于当我在观众面前播放音频时。

当然，您随后可以轻松地为需要的人提供*真正的*演示文稿。

对于幻灯片，我通常会尽量不在屏幕上说出确切的单词。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-12T20:28:34.203

如果你展示的是为你准备的代码，那么确保你可以让它工作。我知道这是一个显而易见的问题，但我只是在一个会议上，五分之四的演讲者有代码问题。告诉我它“很酷”甚至“真的很酷”当它不起作用时是很难卖的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-12T19:28:56.033

你应该阅读[Mark Jason Dominus](http://plover.com)关于公开演讲的优秀演讲： [会议演讲柔道](http://perl.plover.com/yak/presentation/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-12T20:45:22.120

我的第一条规则是：不要试图展示太多。

用一段代码生活几个星期很容易，然后想，“该死的，当我向他们展示这个时，他们会吓坏的！” 即使在您的私人排练期间，您也会对事情感觉良好。但是一旦出现在观众面前，你的代码的复杂性就会乘以观众人数的平方。（为每个添加的受众成员解释代码变得更加困难！）

私下看起来如此简单直接的事情很快就变成了一大碗意大利面，压力连你都不明白。不要试图展示生产代码（良好的分解和良好的分区），制作简单的内联示例来传达您的核心信息。

我的规则#1 可以被愤世嫉俗的人解释为不要高估你的观众。作为一个乐观主义者，我认为不要高估你解释代码的能力！

rp

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-12T21:09:00.800

因为听起来你正在做一个现场演示，你将在其中使用真实的系统，而不仅仅是图表（PPT、Impress 等），确保在你开始之前一切正常。它永远不会失败，如果我在开始讲话之前不尝试它，它就不会像我预期的那样起作用。尤其是演示。（我在星期二做一个，所以我可以联系起来。）

另一件有帮助的事情就是练习、练习、练习。尤其是如果您可以在您将要展示的确切环境中做到这一点。这样您就可以了解您需要在哪里，以免阻碍您的听众的视野以及可能存在的任何其他技术问题到房间设置或系统。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-12T19:24:21.690

这是向我解释过的东西，我认为它非常有用。您可能要考虑不要在开始时滑得很重。您想预先向听众展示一些东西（显然可能不是代码），这将使他们保持在座位的边缘，想要了解如何做您刚刚向他们展示的内容。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-12T19:34:02.573

我最近开始使用思维导图工具进行演示，发现效果非常好。

[http://en.wikipedia.org/wiki/Mind_map](http://en.wikipedia.org/wiki/Mind_map)

基本上，我发现人们只是在您开始详细介绍演示文稿的那一刻就开始关注。用思维导图传达信息（至少根据我的经验），为信息的传达和联系提供了一种更简单的方法。

关键是分阶段呈现信息（即，首先是您的高层次想法，然后是更详细的，一次一个）。思维导图工具基本上可以让您扩展您的地图，因为观众观看和您呈现越来越详细的信息。这样做可以让您的受众在较小的阶段逐渐吸收数据，这往往有助于保留。

查看[FreeMind](http://en.wikipedia.org/wiki/FreeMind)以获取免费工具。[Mind Manager](http://www.mindjet.com/products/mindmanager_pro/default.aspx)是一款付费产品，但更加精致和流畅。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-12T19:36:50.133

保持你的“视觉表现”简单和标准。

如果您使用的是 Vista，请隐藏您的桌面图标并使用默认壁纸之一。尽可能让您的 Visual Studio 设置（尤其是工具栏）保持标准和“开箱即用”。您在环境中显示的自定义越多，人们就越有可能关注这些而不是您的内容。

保持幻灯片上的内容尽可能简洁。请记住，您是在与您的听众交谈（在最好的情况下，与）您的听众交谈，因此幻灯片应作为讨论点。如果您想包含更多详细信息，请将它们放在幻灯片注释中。如果您之后可以使用幻灯片，这将特别好。

如果有人问你一个问题而你不知道答案，不要害怕说你不知道。这总是比试图猜测你认为答案应该是什么要好。

此外，如果您使用的是 Vista，请务必将其置于“演示模式”。PowerPoint 也有类似的模式，因此请务必使用它 - 您在一台显示器（投影仪）上有幻灯片放映，幻灯片的较小视图，笔记本电脑显示器上还有笔记和计时器。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-12T20:09:27.400

你听说过[Pecha-Kucha吗？](http://en.wikipedia.org/wiki/Pecha_Kucha)

> Pecha Kucha 背后的理念是保持演讲简洁，提高兴趣，并让许多演讲者在一晚内分享他们的想法。因此，创建了 20x20 Pecha Kucha 格式：每个演示者都可以放映 20 张图片的幻灯片，每张图片显示 20 秒。这导致在下一位演讲者起立之前，在舞台上的总演讲时间为 6 分 40 秒

现在，我不确定这么短的时间是否适合产品演示。但是你可以尝试从概念中得到一些不错的想法，比如简洁明了、有效的时间、空间管理等。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-06-23T02:25:02.233

除了像 Mind Manager 这样的软件来展示你的架构之外，你还可以找到一个屏幕录像机作为演示工具来说明你的技术任务。[**DemoCreator**](http://www.sameshow.com/demo-creator.html#107)可以很好地制作您的屏幕活动视频。您可以添加更多标注以使该过程更易于理解。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-12T20:11:46.383

如果您完全使用幻灯片，请遵循[Guy Kawasaki 的 10/20/30 规则](http://blog.guykawasaki.com/2005/12/the_102030_rule.html)：

*   不超过 10 张幻灯片
*   在幻灯片上花费不超过 20 分钟
*   幻灯片上不少于 30 点类型

-亚当

# java - shell 模式下的 GWT context.xml

> ID：59806
> 
> 赞同：0
> 
> 时间：2008-09-12T19:33:41.573
> 
> 标签：java, gwt

我试图让**GWTShell**模式加载描述我的数据库的*context.xml*文件。

唯一可用的信息可以在[这里](http://gwt-maven.googlecode.com/svn/docs/maven-googlewebtoolkit-plugin/configure_tomcatlite.html)找到，但这似乎不适用于*context.xml*部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T11:40:21.173

我将 Eclipse 与 Cypal Studio（以前称为 Googlipse）一起使用。如果还有其他*更好*的 Eclipse 插件，请推荐。

由于 Shell 模式使用 Tomcat 实例，这与我们在最终部署中使用的目标服务器相同，因此应该可以实现（或伪造）类似的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T00:39:51.773

从 1.4 版开始，我一直在我选择的容器（Glassfish）中运行我所有的服务器端代码，并将 GWTShell 连接到该容器。您使用的是 Netbeans、Eclipse 还是其他？Netbeans 插件 gwt4nb 开箱即用，您只需在调试模式下启动您的 Web 项目。我确信 Eclipse 的 GWT 插件会做同样的事情。

我意识到这并不能直接回答您的问题-> 但我的问题是，您是否有理由让 GWT 获取您的数据库设置，而不仅仅是正常运行您的项目。我发现这种运行 GWTShell 的方法要好得多且健壮。

编辑：对不起，我并没有真正使用 Eclipse，所以我无法帮助你使用插件。我发现 Netbeans 对于 J2EE/web 类型的项目要好得多。它有点慢，但功能更多。该插件称为“GWT4NB”，它是免费的，它会以这样一种方式设置您的 ant 脚本，您只需右键单击您的 Web 项目并选择调试。如果您不想切换 IDE，我可以理解。

# sql-server - MS Access ADP 自动编号

> ID：59809
> 
> 赞同：2
> 
> 时间：2008-09-12T19:36:43.423
> 
> 标签：sql-server, ms-access

尝试在链接到 MS SQL Server 2000 表的表单上添加记录时，我在 MS Access ADP 中收到以下错误：

> 运行时错误“31004”：
> 
> （自动编号）字段的值在保存之前无法检索。
> 
> 请在执行此操作之前保存包含（自动编号）字段的记录。注意：*retrieveed*实际上是在错误中拼写错误。

有谁知道这意味着什么？

我进行了网络搜索，只能在只有专家才能访问的某个站点上找到答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T14:53:17.747

首先，如果您要查看experts-exchange - 在FireFox 中进行，您将在页面底部看到未屏蔽的答案。

其次，您在该表单上是否有使用主表单上的自动编号/键字段的子表单？您是否需要在保存主窗体之前保存该子窗体上的数据（即拥有自己的密钥）。您可能会陷入 A 和 B 的僵局，需要先得救对方。

除此之外，您在保存时必须以某种方式访问​​该自动编号字段。我能建议的最好的方法是逐行遍历代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T21:31:40.480

您是否尝试在保存记录之前将标识字段的值分配给变量或其他内容？

无论出于何种原因，您的应用程序都试图在保存记录之前读取标识字段的值，这就是生成该标识字段的原因。换句话说，在保存行之前，自动编号字段不存在任何值。

我认为我们需要查看更多代码或更多地了解导致此错误的步骤以更详细地解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T21:30:14.193

您应该添加一些代码行来向我们展示您如何管理数据以及您正在做什么。但我怀疑与记录集更新有关的问题。你能确定自动编号值的创建时间吗？它在表单上的控件中可用吗？是否可以添加一个控件来显示该值，以检查添加新记录时它是如何生成的？基础记录集是否正确更新？您能否在某些表单事件上添加类似 me.recordset.update 的内容：我会尝试 OnCurrent 一个...

# c# - MapPoint 2009 负载性能

> ID：59816
> 
> 赞同：3
> 
> 时间：2008-09-12T19:42:26.420
> 
> 标签：c#, winforms, performance, com, mappoint

我在使用 C# 将 MS MapPoint 2009 集成到我的 WinForms .Net 2.0 应用程序时遇到了一些问题。我已将 ActiveX MapPoint 控件添加到表单中，让它显示地图和位置没有问题；我担心的是创建地图后加载地图所需的时间。

我的开发机器上的测试显示平均加载时间在 3 到 5 秒之间，在此期间应用程序完全锁定。虽然这不是完全不可接受的，但失去对应用程序的控制的时间非常长。此外，由于 GUI 线程被锁定，我无法显示加载对话框或其他内容来掩盖加载时间。

挂起的行是这样的：（其中 axMappointControl1 是 MapPoint 控件）

```
axMappointControl1.NewMap(MapPoint.GeoMapRegion.geoMapNorthAmerica); 
```

我尝试在另一个线程上执行 NewMap 方法，但 GUI 线程仍然被阻塞。

我的问题是：

*   MapPoint 加载时我能做些什么来加快它的速度？
*   有什么方法可以加载 MapPoint 使其不会阻塞 GUI 线程？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T20:02:26.167

根据 mapforums.com 上的[这些](http://www.mapforums.com/load-new-map-separate-thread-keep-ui-responsive-4605.html) [线程](http://www.mapforums.com/activex-performance-net-3415.html)，ActiveX 启动的缓慢是众所周知且不可避免的（尽管有助于提高 GUI 响应性的线程问题仍然悬而未决。

建议的一件事是放弃 ActiveX 版本，转而使用 MapPoint.Application 对象。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-04T14:54:12.880

是的，应用程序版本在它自己的线程上运行——所以这应该是一个更快的选择——在它启动时更容易做你自己的事情。但是，MapPoint 2010 在用户启动时往往需要几秒钟才能启动。

我将创建一个临时 GUI 线程并使用它在启动期间显示启动屏幕和/或执行您需要执行的任何线程安全初始化。

对 MapPoint 实例（或 ActiveX 控件）的所有调用必须来自创建 MapPoint 控件或应用程序对象的同一线程。

# powershell - 如何在 PowerShell 中创建自定义类型以供我的脚本使用？

> ID：59819
> 
> 赞同：95
> 
> 时间：2008-09-12T19:43:52.423
> 
> 标签：powershell, scripting

我希望能够在我的一些 PowerShell 脚本中定义和使用自定义类型。例如，假设我需要一个具有以下结构的对象：

```
Contact
{
    string First
    string Last
    string Phone
} 
```

我将如何创建它以便可以在如下函数中使用它：

```
function PrintContact
{
    param( [Contact]$contact )
    "Customer Name is " + $contact.First + " " + $contact.Last
    "Customer Phone is " + $contact.Phone 
} 
```

这样的事情是否可能，甚至在 PowerShell 中被推荐？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2008-09-15T20:36:56.360

## 在 PowerShell 3 之前

PowerShell 的可扩展类型系统最初不允许您创建具体类型，您可以按照您在参数中所做的方式进行测试。如果您不需要该测试，则可以使用上述任何其他方法。

如果您想要一个可以强制转换或类型检查的实际类型，就像在您的示例脚本中一样......如果不使用 C# 或 VB.net 编写并编译，**就无法完成。**在 PowerShell 2 中，您可以使用“Add-Type”命令非常简单：

```
add-type @"
public struct contact {
   public string First;
   public string Last;
   public string Phone;
}
"@ 
```

***历史注释***：在 PowerShell 1 中，它甚至更难。您必须手动使用 CodeDom，PoshCode.org 上有一个非常古老的函数[new-struct](http://poshcode.org/scripts/190)脚本会有所帮助。您的示例变为：

```
New-Struct Contact @{
    First=[string];
    Last=[string];
    Phone=[string];
} 
```

使用`Add-Type`or`New-Struct`将让您实际测试您的课程`param([Contact]$contact)`并使用`$contact = new-object Contact`等等...

# 在 PowerShell 3 中

如果您不需要可以转换为的“真实”类，则不必使用[Steven 和其他人在](https://stackoverflow.com/a/59980/8718)上面演示的 Add-Member 方式。

从 PowerShell 2 开始，您可以对 New-Object 使用 -Property 参数：

```
$Contact = New-Object PSObject -Property @{ First=""; Last=""; Phone="" } 
```

在 PowerShell 3 中，我们可以使用`PSCustomObject`加速器添加 TypeName：

```
[PSCustomObject]@{
    PSTypeName = "Contact"
    First = $First
    Last = $Last
    Phone = $Phone
} 
```

您仍然只得到一个对象，因此您应该创建一个`New-Contact`函数来确保每个对象都相同，但是您现在可以通过使用`PSTypeName`属性装饰参数来轻松验证参数“是”其中一个类型：

```
function PrintContact
{
    param( [PSTypeName("Contact")]$contact )
    "Customer Name is " + $contact.First + " " + $contact.Last
    "Customer Phone is " + $contact.Phone 
} 
```

# 在 PowerShell 5 中

在 PowerShell 5 中，一切都发生了变化，我们终于得到了`class`和`enum`作为定义类型的语言关键字（没有`struct`，但没关系）：

```
class Contact
{
    # Optionally, add attributes to prevent invalid values
    [ValidateNotNullOrEmpty()][string]$First
    [ValidateNotNullOrEmpty()][string]$Last
    [ValidateNotNullOrEmpty()][string]$Phone

    # optionally, have a constructor to 
    # force properties to be set:
    Contact($First, $Last, $Phone) {
       $this.First = $First
       $this.Last = $Last
       $this.Phone = $Phone
    }
} 
```

我们还获得了一种不使用以下方法来创建对象的新方法`New-Object`：`[Contact]::new()`-- 事实上，如果您保持类简单并且不定义构造函数，则可以通过强制转换哈希表来创建对象（尽管没有构造函数，就没有办法强制必须设置所有属性）：

```
class Contact
{
    # Optionally, add attributes to prevent invalid values
    [ValidateNotNullOrEmpty()][string]$First
    [ValidateNotNullOrEmpty()][string]$Last
    [ValidateNotNullOrEmpty()][string]$Phone
}

$C = [Contact]@{
   First = "Joel"
   Last = "Bennett"
} 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-09-12T21:13:15.300

创建自定义类型可以在 PowerShell 中完成。
Kirk Munro 实际上有两篇很棒的帖子详细介绍了这个过程。

*   [命名自定义对象](http://poshoholic.com/2008/07/03/essential-powershell-name-your-custom-object-types/)
*   [定义自定义对象的默认属性](http://poshoholic.com/2008/07/05/essential-powershell-define-default-properties-for-custom-objects/)

Manning所著的[Windows PowerShell In Action](http://www.manning.com/payette/)一书还有一个代码示例，用于创建域特定语言以创建自定义类型。这本书到处都很棒，所以我真的推荐它。

如果您只是在寻找一种快速的方法来执行上述操作，您可以创建一个函数来创建自定义对象，例如

```
function New-Person()
{
  param ($FirstName, $LastName, $Phone)

  $person = new-object PSObject

  $person | add-member -type NoteProperty -Name First -Value $FirstName
  $person | add-member -type NoteProperty -Name Last -Value $LastName
  $person | add-member -type NoteProperty -Name Phone -Value $Phone

  return $person
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-14T13:05:17.047

这是快捷方法：

```
$myPerson = "" | Select-Object First,Last,Phone 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-01-12T10:11:43.897

Steven Murawski 的回答很棒，但是我喜欢更短的（或者更确切地说是更简洁的选择对象，而不是使用 add-member 语法）：

```
function New-Person() {
  param ($FirstName, $LastName, $Phone)

  $person = new-object PSObject | select-object First, Last, Phone

  $person.First = $FirstName
  $person.Last = $LastName
  $person.Phone = $Phone

  return $person
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-09-10T15:56:43.153

惊讶于没有人提到这个用于创建自定义对象的简单选项（vs 3 或更高版本）：

```
[PSCustomObject]@{
    First = $First
    Last = $Last
    Phone = $Phone
} 
```

该类型将是 PSCustomObject，但不是实际的自定义类型。但这可能是创建自定义对象的最简单方法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-12T20:36:22.360

您可以使用 PSObject 和 Add-Member 的概念。

```
$contact = New-Object PSObject

$contact | Add-Member -memberType NoteProperty -name "First" -value "John"
$contact | Add-Member -memberType NoteProperty -name "Last" -value "Doe"
$contact | Add-Member -memberType NoteProperty -name "Phone" -value "123-4567" 
```

这输出如下：

```
[8] » $contact

First                                       Last                                       Phone
-----                                       ----                                       -----
John                                        Doe                                        123-4567 
```

另一种选择（我知道）是在 C#/VB.NET 中定义一个类型并将该程序集加载到 PowerShell 中以直接使用。

绝对鼓励这种行为，因为它允许其他脚本或脚本的部分与实际对象一起工作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-12-15T20:03:19.490

这是创建自定义类型并将它们存储在集合中的艰难路径。

```
$Collection = @()

$Object = New-Object -TypeName PSObject
$Object.PsObject.TypeNames.Add('MyCustomType.Contact.Detail')
Add-Member -InputObject $Object -memberType NoteProperty -name "First" -value "John"
Add-Member -InputObject $Object -memberType NoteProperty -name "Last" -value "Doe"
Add-Member -InputObject $Object -memberType NoteProperty -name "Phone" -value "123-4567"
$Collection += $Object

$Object = New-Object -TypeName PSObject
$Object.PsObject.TypeNames.Add('MyCustomType.Contact.Detail')
Add-Member -InputObject $Object -memberType NoteProperty -name "First" -value "Jeanne"
Add-Member -InputObject $Object -memberType NoteProperty -name "Last" -value "Doe"
Add-Member -InputObject $Object -memberType NoteProperty -name "Phone" -value "765-4321"
$Collection += $Object

Write-Ouput -InputObject $Collection 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-08-13T16:14:27.813

这里还有一个选项，它使用了与 Jaykul 提到的 PSTypeName 解决方案类似的想法[（](https://stackoverflow.com/a/66693/361842)因此也需要 PSv3 或更高版本）。

# 例子

1.  创建一个***TypeName* .Types.ps1xml**文件来定义您的类型。例如`Person.Types.ps1xml`：

```
<?xml version="1.0" encoding="utf-8" ?>
<Types>
  <Type>
    <Name>StackOverflow.Example.Person</Name>
    <Members>
      <ScriptMethod>
        <Name>Initialize</Name>
        <Script>
            Param (
                [Parameter(Mandatory = $true)]
                [string]$GivenName
                ,
                [Parameter(Mandatory = $true)]
                [string]$Surname
            )
            $this | Add-Member -MemberType 'NoteProperty' -Name 'GivenName' -Value $GivenName
            $this | Add-Member -MemberType 'NoteProperty' -Name 'Surname' -Value $Surname
        </Script>
      </ScriptMethod>
      <ScriptMethod>
        <Name>SetGivenName</Name>
        <Script>
            Param (
                [Parameter(Mandatory = $true)]
                [string]$GivenName
            )
            $this | Add-Member -MemberType 'NoteProperty' -Name 'GivenName' -Value $GivenName -Force
        </Script>
      </ScriptMethod>
      <ScriptProperty>
        <Name>FullName</Name>
        <GetScriptBlock>'{0} {1}' -f $this.GivenName, $this.Surname</GetScriptBlock>
      </ScriptProperty>
      <!-- include properties under here if we don't want them to be visible by default
      <MemberSet>
        <Name>PSStandardMembers</Name>
        <Members>
        </Members>
      </MemberSet>
      -->
    </Members>
  </Type>
</Types> 
```

2.  导入您的类型：`Update-TypeData -AppendPath .\Person.Types.ps1xml`
3.  创建自定义类型的对象：`$p = [PSCustomType]@{PSTypeName='StackOverflow.Example.Person'}`
4.  使用您在 XML 中定义的脚本方法初始化您的类型：`$p.Initialize('Anne', 'Droid')`
5.  看它; 您将看到定义的所有属性：`$p | Format-Table -AutoSize`
6.  键入调用 mutator 来更新属性的值：`$p.SetGivenName('Dan')`
7.  再次查看它以查看更新后的值：`$p | Format-Table -AutoSize`

# 解释

*   PS1XML 文件允许您定义类型的自定义属性。
*   正如文档所暗示的那样，它不限于 .net 类型；所以你可以把你喜欢的东西放在'/Types/Type/Name'中，任何用匹配的'PSTypeName'创建的对象都将继承为此类型定义的成员。
*   通过`PS1XML`or添加的成员`Add-Member`仅限于`NoteProperty`, `AliasProperty`, `ScriptProperty`, `CodeProperty`, `ScriptMethod`, 和`CodeMethod`（或`PropertySet`/ `MemberSet`；尽管它们受到相同的限制）。所有这些属性都是只读的。
*   通过定义 a`ScriptMethod`我们可以欺骗上述限制。例如，我们可以定义一个`Initialize`创建新属性的方法（例如 ），为我们设置它们的值；从而确保我们的对象具有我们其他脚本工作所需的所有属性。
*   我们可以使用相同的技巧来允许属性可更新（尽管通过方法而不是直接赋值），如示例的`SetGivenName`.

这种方法并不适合所有场景。但对于向自定义类型添加类似类的行为很有用/可以与其他答案中提到的其他方法结合使用。例如，在现实世界中，我可能只`FullName`在 PS1XML 中定义属性，然后使用函数创建具有所需值的对象，如下所示：

# 更多信息

查看[文档](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_types.ps1xml?view=powershell-6)或 OOTB 类型文件`Get-Content $PSHome\types.ps1xml`以获取灵感。

```
# have something like this defined in my script so we only try to import the definition once.
# the surrounding if statement may be useful if we're dot sourcing the script in an existing 
# session / running in ISE / something like that
if (!(Get-TypeData 'StackOverflow.Example.Person')) {
    Update-TypeData '.\Person.Types.ps1xml'
}

# have a function to create my objects with all required parameters
# creating them from the hash table means they're PROPERties; i.e. updatable without calling a 
# setter method (note: recall I said above that in this scenario I'd remove their definition 
# from the PS1XML)
function New-SOPerson {
    [CmdletBinding()]
    [OutputType('StackOverflow.Example.Person')]
    Param (
        [Parameter(Mandatory)]
        [string]$GivenName
        ,
        [Parameter(Mandatory)]
        [string]$Surname
    )
    ([PSCustomObject][Ordered]@{
        PSTypeName = 'StackOverflow.Example.Person'
        GivenName = $GivenName
        Surname = $Surname
    })
}

# then use my new function to generate the new object
$p = New-SOPerson -GivenName 'Simon' -Surname 'Borg'

# and thanks to the type magic... FullName exists :)
Write-Information "$($p.FullName) was created successfully!" -InformationAction Continue 
```

# python - 如何从集合中检索元素而不删除它？

> ID：59825
> 
> 赞同：571
> 
> 时间：2008-09-12T19:58:33.403
> 
> 标签：python, set

假设如下：

```
>>> s = set([1, 2, 3]) 
```

我如何在不做的情况下获得价值（任何价值`s`）`s.pop()`？我想将项目留在集合中，直到我确定我可以将其删除 - 我只能在异步调用另一个主机之后才能确定。

又快又脏：

```
>>> elem = s.pop()
>>> s.add(elem) 
```

但是你知道更好的方法吗？理想情况下在恒定时间内。

* * *

## 回答 #1

> 赞同：727
> 
> 时间：2008-09-12T20:08:10.167

不需要复制整个集合的两个选项：

```
for e in s:
    break
# e is now an element from s 
```

或者...

```
e = next(iter(s)) 
```

但一般来说，集合不支持索引或切片。

* * *

## 回答 #2

> 赞同：168
> 
> 时间：2008-09-13T01:07:38.043

最少的代码是：

```
>>> s = set([1, 2, 3])
>>> list(s)[0]
1 
```

显然，这将创建一个包含集合中每个成员的新列表，因此如果您的集合非常大，则不是很好。

* * *

## 回答 #3

> 赞同：138
> 
> 时间：2018-02-19T21:52:14.397

我想知道这些功能将如何针对不同的集合执行，所以我做了一个基准测试：

```
from random import sample

def ForLoop(s):
    for e in s:
        break
    return e

def IterNext(s):
    return next(iter(s))

def ListIndex(s):
    return list(s)[0]

def PopAdd(s):
    e = s.pop()
    s.add(e)
    return e

def RandomSample(s):
    return sample(s, 1)

def SetUnpacking(s):
    e, *_ = s
    return e

from simple_benchmark import benchmark

b = benchmark([ForLoop, IterNext, ListIndex, PopAdd, RandomSample, SetUnpacking],
              {2**i: set(range(2**i)) for i in range(1, 20)},
              argument_name='set size',
              function_aliases={first: 'First'})

b.plot() 
```

[![在此处输入图像描述](https://i.stack.imgur.com/7oqB6.png)](https://i.stack.imgur.com/7oqB6.png)

该图清楚地表明，某些方法（`RandomSample`和`SetUnpacking`）`ListIndex`取决于集合的大小，在一般情况下应避免使用（至少在性能*可能*很重要的情况下）。正如其他答案所示，最快的方法是`ForLoop`.

但是，只要使用其中一种恒定时间方法，性能差异就可以忽略不计。

* * *

[`iteration_utilities`](https://iteration-utilities.readthedocs.io/en/latest/index.html)（免责声明：我是作者）包含此用例的便利功能[`first`](https://iteration-utilities.readthedocs.io/en/latest/generated/first.html)：

```
>>> from iteration_utilities import first
>>> first({1,2,3,4})
1 
```

我还将它包含在上面的基准测试中。它可以与其他两种“快速”解决方案竞争，但两者的区别并不大。

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2016-10-15T03:00:43.903

## tl;博士

`for first_item in muh_set: break`仍然是 Python 3.x 中的最佳方法。^(*诅咒你，圭多。*)

## 你这样做

欢迎来到另一组 Python 3.x 时序，从[wr 推断。](https://stackoverflow.com/users/101430/wr)的优秀[Python 2.x 特定响应](https://stackoverflow.com/a/1612654/2809027)。与[AChampion](https://stackoverflow.com/users/2750492/achampion)同样有用的[Python 3.x-specific response](https://stackoverflow.com/a/34973737/2809027)不同，下面的时间*也是*上面建议的时间异常值解决方案——包括：

*   `list(s)[0]`, [John](https://stackoverflow.com/users/2168/john)的新颖[的基于序列的解决方案](https://stackoverflow.com/a/60233/2809027)。
*   `random.sample(s, 1)`, [dF。](https://stackoverflow.com/users/3002/df)的不拘一格[的基于 RNG 的解决方案](https://stackoverflow.com/a/60027/2809027)。

## 快乐的代码片段

打开，收听，计时：

```
from timeit import Timer

stats = [
    "for i in range(1000): \n\tfor x in s: \n\t\tbreak",
    "for i in range(1000): next(iter(s))",
    "for i in range(1000): s.add(s.pop())",
    "for i in range(1000): list(s)[0]",
    "for i in range(1000): random.sample(s, 1)",
]

for stat in stats:
    t = Timer(stat, setup="import random\ns=set(range(100))")
    try:
        print("Time for %s:\t %f"%(stat, t.timeit(number=1000)))
    except:
        t.print_exc() 
```

## 快速过时的永恒计时

**看哪！**按从最快到最慢的片段排序：

```
$ ./test_get.py
Time for for i in range(1000): 
    for x in s: 
        break:   0.249871
Time for for i in range(1000): next(iter(s)):    0.526266
Time for for i in range(1000): s.add(s.pop()):   0.658832
Time for for i in range(1000): list(s)[0]:   4.117106
Time for for i in range(1000): random.sample(s, 1):  21.851104 
```

## 全家人的面部植物

不出所料，**手动迭代的速度至少是次快**解决方案的两倍。尽管与 Bad Old Python 2.x 时代（手动迭代的速度至少快四倍）相比，差距已经缩小，但让[PEP 20](https://www.python.org/dev/peps/pep-0020/)狂热者失望的是，最冗长的解决方案是最好的。至少将一个集合转换为一个列表只是为了提取集合的第一个元素，这和预期的一样可怕。*感谢Guido，愿他的光芒继续指引我们。*

令人惊讶的是，**基于 RNG 的解决方案绝对可怕。**列表转换很糟糕，但`random` *真的*很糟糕。[随机数神](http://catb.org/esr/jargon/html/R/Random-Number-God.html)就这么多。

我只是希望无定形的他们`set.get_first()`已经为我们提供了一种方法。如果您正在阅读本文，他们：“请。做点什么。”

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2009-10-23T10:47:49.297

要提供不同方法背后的一些时序图，请考虑以下代码。 *get() 是我对 Python 的 setobject.c 的自定义添加，它只是一个 pop() 而不删除元素。*

```
from timeit import *

stats = ["for i in xrange(1000): iter(s).next()   ",
         "for i in xrange(1000): \n\tfor x in s: \n\t\tbreak",
         "for i in xrange(1000): s.add(s.pop())   ",
         "for i in xrange(1000): s.get()          "]

for stat in stats:
    t = Timer(stat, setup="s=set(range(100))")
    try:
        print "Time for %s:\t %f"%(stat, t.timeit(number=1000))
    except:
        t.print_exc() 
```

输出是：

```
$ ./test_get.py
Time for for i in xrange(1000): iter(s).next()   :       0.433080
Time for for i in xrange(1000):
        for x in s:
                break:   0.148695
Time for for i in xrange(1000): s.add(s.pop())   :       0.317418
Time for for i in xrange(1000): s.get()          :       0.146673 
```

这意味着***for/break***解决方案是最快的（有时比自定义 get() 解决方案更快）。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2008-09-12T21:43:27.363

由于您想要一个随机元素，这也将起作用：

```
>>> import random
>>> s = set([1,2,3])
>>> random.sample(s, 1)
[2] 
```

该文档似乎没有提到`random.sample`. 从一个非常快速的经验测试来看，一个巨大的列表和一个巨大的集合似乎是一个列表而不是集合的恒定时间。此外，对集合的迭代不是随机的。顺序未定义但可预测：

```
>>> list(set(range(10))) == range(10)
True 
```

如果随机性很重要，并且您需要恒定时间内的一堆元素（大集合），我会`random.sample`先使用并转换为列表：

```
>>> lst = list(s) # once, O(len(s))?
...
>>> e = random.sample(lst, 1)[0] # constant time 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2017-08-21T17:54:43.083

看似**最紧凑**（6 个符号）但获取集合元素的方法**非常缓慢**（由[PEP 3132](https://www.python.org/dev/peps/pep-3132/)实现）：

```
e,*_=s 
```

使用 Python 3.5+，您还可以使用这个 7 符号表达式（感谢[PEP 448](https://www.python.org/dev/peps/pep-0448/)）：

```
[*s][0] 
```

这两个选项在我的机器上比 for-loop 方法慢大约 1000 倍。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2020-10-14T12:04:49.343

Python 3 中的另一种方式：

```
next(iter(s)) 
```

或者

```
s.__iter__().__next__() 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-09-14T04:57:51.413

我使用我编写的实用程序函数。它的名字有点误导，因为它暗示它可能是一个随机项目或类似的东西。

```
def anyitem(iterable):
    try:
        return iter(iterable).next()
    except StopIteration:
        return None 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-01-24T08:38:38.487

关注@wr。发布后，我得到了类似的结果（对于 Python3.5）

```
from timeit import *

stats = ["for i in range(1000): next(iter(s))",
         "for i in range(1000): \n\tfor x in s: \n\t\tbreak",
         "for i in range(1000): s.add(s.pop())"]

for stat in stats:
    t = Timer(stat, setup="s=set(range(100000))")
    try:
        print("Time for %s:\t %f"%(stat, t.timeit(number=1000)))
    except:
        t.print_exc() 
```

输出：

```
Time for for i in range(1000): next(iter(s)):    0.205888
Time for for i in range(1000): 
    for x in s: 
        break:                                   0.083397
Time for for i in range(1000): s.add(s.pop()):   0.226570 
```

但是，当更改底层集合（例如调用）时，可迭代示例（ , ）`remove()`的情况会很糟糕：`for``iter`

```
from timeit import *

stats = ["while s:\n\ta = next(iter(s))\n\ts.remove(a)",
         "while s:\n\tfor x in s: break\n\ts.remove(x)",
         "while s:\n\tx=s.pop()\n\ts.add(x)\n\ts.remove(x)"]

for stat in stats:
    t = Timer(stat, setup="s=set(range(100000))")
    try:
        print("Time for %s:\t %f"%(stat, t.timeit(number=1000)))
    except:
        t.print_exc() 
```

结果是：

```
Time for while s:
    a = next(iter(s))
    s.remove(a):             2.938494
Time for while s:
    for x in s: break
    s.remove(x):             2.728367
Time for while s:
    x=s.pop()
    s.add(x)
    s.remove(x):             0.030272 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-03-22T18:10:36.307

我通常为小集合做的是创建一种像这样的解析器/转换器方法

```
def convertSetToList(setName):
return list(setName) 
```

然后我可以使用新列表并按索引号访问

```
userFields = convertSetToList(user)
name = request.json[userFields[0]] 
```

作为一个列表，您将拥有可能需要使用的所有其他方法

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-10-06T11:16:58.380

**您可以解压缩值以访问元素：**

```
s = set([1, 2, 3])

v1, v2, v3 = s

print(v1,v2,v3)
#1 2 3 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-12-23T19:39:03.763

如果你只想要第一个元素试试这个： b = (a-set()).pop()

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2018-03-06T19:14:06.870

怎么样`s.copy().pop()`？我没有计时，但它应该可以工作而且很简单。然而，它最适合小集合，因为它复制整个集合。

* * *

## 回答 #15

> 赞同：-6
> 
> 时间：2008-09-12T20:52:06.503

另一种选择是使用包含您不关心的值的字典。例如，

```
 poor_man_set = {}
poor_man_set[1] = None
poor_man_set[2] = None
poor_man_set[3] = None
... 
```

您可以将键视为一个集合，但它们只是一个数组：

```
 keys = poor_man_set.keys()
print "Some key = %s" % keys[0] 
```

这种选择的副作用是您的代码将向后兼容较旧`set`的 Python 预版本。这可能不是最好的答案，但它是另一种选择。

编辑：你甚至可以做这样的事情来隐藏你使用字典而不是数组或集合的事实：

```
 poor_man_set = {}
poor_man_set[1] = None
poor_man_set[2] = None
poor_man_set[3] = None
poor_man_set = poor_man_set.keys() 
```

# .net - 回发 vb.net 上选择的单选按钮列表值出现问题

> ID：59829
> 
> 赞同：0
> 
> 时间：2008-09-12T20:01:58.323
> 
> 标签：.net, vb.net, postback, radiobuttonlist, selectedvalue

我在用于配置产品的页面上有一个单选按钮列表。当页面第一次加载时，会显示第一个选项列表。您选择其中一个，然后单击“下一步”按钮，页面回发并显示第 2 步的新单选按钮列表。现在，如果我单击“上一步”按钮，我可以轻松获取要显示的上一个选项列表但由于某种原因，我无法选择其中一个单选按钮。我可以轻松带回我需要的价值。在制作单选按钮列表后，我有一个步骤，它只是说radiobuttonlist.selected =“somevalue”，具体取决于用户第一次完成第一步时选择的任何内容。

当我调试时，我看到该值是正确的并且正在应用中。但是当页面显示时，单选按钮没有被选中。

我注意到，当我在调试时单击“上一个”按钮时，会发生以下步骤：

page.load 处理程序运行并且我的 if not page.ispostback 块中的代码不运行，这是正确的。然后我刚刚单击的按钮的句柄开始运行。但之后 page.load 处理程序再次运行，但这次 if not page.ispostback 块中的代码确实运行...

这正常吗？让 page.onload 块在回发时像这样运行两次？我认为这可能与为什么我的价值没有被应用有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-12T20:05:47.317

听起来您正在导致重定向发生。您不是偶然执行 Response.Redirect 以“返回”原始页面吗？这将导致您描述的功能。您将首先从“上一个”按钮获得回发以离开页面，然后在页面重新加载时获得一个新的请求 (IsPostback = false)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T15:22:18.020

Try to do this

```
yourRadioButonList.Items.FindByValue(YourSavedValue).Selected = true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T20:04:45.527

尝试`AutoEventWireup = False`在页面中设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T20:08:21.570

我确实有一个我正在使用的 response.redirect，但我删除了它。我想我可以做一个彻底的检查，以确保我在任何地方都没有另一个。我也会尝试 autoeventwireup 属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-12T21:24:21.903

好吧，看起来 autoevenwriteup 属性在我开始之前就已经设置为 false。所以我不认为是这样。

我没有看到任何其他重定向发生在任何地方......我想搜索仍在继续。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-13T13:35:13.283

您是否尝试过在页面的预渲染阶段而不是 Page_Load 设置选定的值？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-02T09:33:17.777

I had the same issue, like what Thunder3 mentioned, I did a redirect back to the page, and was calling a method on Page_Load, to set the RadioButtonList selected value. But the selected value was not applied to the RadioButtonList.

I solved the issue by calling the method on Page_Init instead.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-06T19:07:04.500

一个可能的原因，也是我最近遇到的一个原因是，radiobuttonlist 根据值而不是 ID 来区分项目，因此如果存在重复值，就会观察到这个问题。

下面的链接提供了详细的解释。

[RadioButtonList 所选项目不坚持回发](http://www.a2zmenu.com/Blogs/AspNet/RadioButtonList-selected-item-does-not-stick-on-postback.aspx)

# java - 获取java异常：java.net.MalformedURLException：没有协议

> ID：59832
> 
> 赞同：6
> 
> 时间：2008-09-12T20:03:43.657
> 
> 标签：java, url, io

我目前正在调用以下代码行：

```
java.net.URL connection_url = new java.net.URL("http://<ip address>:<port>/path"); 
```

当它执行时我得到了上面的异常。关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-12T20:15:12.350

附带说明一下，您应该使用[URI](http://java.sun.com/javase/6/docs/api/java/net/URI.html)，因为 Java URL 类被搞砸了。（我相信的equals方法）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-12T20:22:36.887

该 url 字符串看起来无效。当然它不应该是' [http://path](http://path) '？或者服务器和端口是空白的？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-12T21:06:22.990

您的代码对我来说非常好：

```
public static void main(String[] args) {
    try {
        java.net.URL connection_url = new java.net.URL("http://:/path");
        System.out.println("Instantiated new URL: " + connection_url);
    }
    catch (MalformedURLException e) {
        e.printStackTrace();
    }
} 
```

> 实例化新 URL：[http://:/path](http://:/path)

确定你有正确的代码行吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-24T13:16:41.917

我也有同样的例外，但在我的情况下，我试图执行的 URL 附加了一个空格。删除空间后，它对我来说很好。在您的情况下，检查 URL 是否没有任何尾随空格。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-07T08:56:56.933

我有同样的错误，它得到了以下解决：

我几天前添加的 jar 文件（JFree）自动损坏并导致此错误。我再次从网上下载了相同的文件，对我来说效果很好。

# asp.net - 免费/便宜的 ASP.NET 组件库

> ID：59834
> 
> 赞同：1
> 
> 时间：2008-09-12T20:04:31.033
> 
> 标签：asp.net, components

今天早些时候，有人询问有关 winforms 的免费/便宜的组件库。我对同样的事情感兴趣，但对于 asp.net。有一些很棒的商业图书馆，比如 Telerik 和 DevExpress，但是有没有免费/便宜的替代品？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-12T20:21:09.307

我不确定你认为什么便宜，但 Peter Blum ASP.NET 控件是一个不错的选择。

[peterblum.com](http://www.peterblum.com/Home.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-12T21:01:14.843

我建议您可以在[codeproject 之](http://www.codeproject.com)类的网站上获得免费组件，但最终您将花费大量时间将小麦从谷壳中分离出来并弄清楚如何使用它们，并且由于它们不是一个统一的库 API集成将是每个不同控件的新学习曲线。

所以我建议，除非你是一个有大量时间的业余爱好者，否则毫无疑问，你的公司从 Peter Blum、DevExpress、Infragistics、Telerik 或其他供应商那里购买东西是值得的。将提供支持和文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T21:11:53.730

我很喜欢用于 asp.net 的[obout.com](http://www.obout.com "奥布特")控制套件 - 200 美元可以为您购买整个套件，而且他们似乎正在积极开发它。

Grid 和 Treeview 在这个套件中非常强大，我对支持印象深刻。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-12T21:10:57.253

查看[ASP.NET 控件库](http://www.asp.net/community/control-gallery/)。

> “Control Gallery 是一个包含 900 多个控件和组件的目录，可在您自己的应用程序中使用。您将找到从简单控件到完整电子商务组件的所有内容。”

并非所有这些都是免费的，但绝对值得一看。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T09:37:52.100

试试这个免费的自定义 Web 控件：[Excentrics World .NET](http://www.eworldui.net/)

# bash - 如何检查 Bash shell 脚本中是否存在目录？

> ID：59838
> 
> 赞同：4107
> 
> 时间：2008-09-12T20:06:25.757
> 
> 标签：bash, shell, unix, posix

在 Bash shell 脚本中，可以使用什么命令来检查目录是否存在？

* * *

## 回答 #1

> 赞同：5558
> 
> 时间：2008-09-12T20:07:06.113

要检查 shell 脚本中是否存在目录，可以使用以下命令：

```
if [ -d "$DIRECTORY" ]; then
  # Control will enter here if $DIRECTORY exists.
fi 
```

或者检查目录是否不存在：

```
if [ ! -d "$DIRECTORY" ]; then
  # Control will enter here if $DIRECTORY doesn't exist.
fi 
```

* * *

但是，正如[Jon Ericson](https://stackoverflow.com/users/1438/jon-ericson)指出的那样，如果您不考虑到目录的符号链接也将通过此检查，则后续命令可能无法按预期工作。例如运行这个：

```
ln -s "$ACTUAL_DIR" "$SYMLINK"
if [ -d "$SYMLINK" ]; then 
  rmdir "$SYMLINK" 
fi 
```

会产生错误信息：

```
rmdir: failed to remove `symlink': Not a directory 
```

因此，如果后续命令需要目录，则可能必须区别对待符号链接：

```
if [ -d "$LINK_OR_DIR" ]; then 
  if [ -L "$LINK_OR_DIR" ]; then
    # It is a symlink!
    # Symbolic link specific commands go here.
    rm "$LINK_OR_DIR"
  else
    # It's a directory!
    # Directory command goes here.
    rmdir "$LINK_OR_DIR"
  fi
fi 
```

* * *

请特别注意用于包装变量的双引号。[8jean在另一个答案](https://stackoverflow.com/a/67458/102401)中解释了其原因。

如果变量包含空格或其他异常字符，则可能会导致脚本失败。

* * *

## 回答 #2

> 赞同：580
> 
> 时间：2008-09-15T22:00:49.730

在 Bash 脚本中引用变量时，请记住始终将变量用双引号括起来。这些天来，孩子们长大后认为他们的目录名称中可以有空格和许多其他有趣的字符。（空间！回到我的时代，我们没有花哨的空间！；））

有一天，其中一个孩子会运行你的脚本，`$DIRECTORY`设置为`"My M0viez"`，你的脚本会爆炸。你不想要那个。所以用这个。

```
if [ -d "$DIRECTORY" ]; then
    # Will enter here if $DIRECTORY exists, even if it contains spaces
fi 
```

* * *

## 回答 #3

> 赞同：252
> 
> 时间：2008-09-12T20:26:04.803

请注意**-d**测试可能会产生一些令人惊讶的结果：

```
$ ln -s tmp/ t
$ if [ -d t ]; then rmdir t; fi
rmdir: directory "t": Path component not a directory 
```

文件下：“什么时候目录不是目录？” 答案是：“当它是目录的符号链接时。” 一个稍微彻底的测试：

```
if [ -d t ]; then 
   if [ -L t ]; then 
      rm t
   else 
      rmdir t
   fi
fi 
```

您可以在 Bash 手册中找到有关[Bash 条件表达式](https://www.gnu.org/software/bash/manual/bash.html#Bash-Conditional-Expressions)以及[`[`内置命令](https://www.gnu.org/software/bash/manual/bash.html#index-_005b)和[`[[`复合](https://www.gnu.org/software/bash/manual/bash.html#index-_005b_005b)命令的更多信息。

* * *

## 回答 #4

> 赞同：234
> 
> 时间：2008-09-12T21:33:08.963

我发现[双括号](http://tldp.org/LDP/abs/html/testconstructs.html#DBLBRACKETS)版本`test`使编写逻辑测试更自然：

```
if [[ -d "${DIRECTORY}" && ! -L "${DIRECTORY}" ]] ; then
    echo "It's a bona-fide directory"
fi 
```

* * *

## 回答 #5

> 赞同：206
> 
> 时间：2008-09-12T21:08:48.977

较短的形式：

```
# if $DIR is a directory, then print yes
[ -d "$DIR" ] && echo "Yes" 
```

* * *

## 回答 #6

> 赞同：144
> 
> 时间：2015-04-08T02:50:09.670

要检查目录是否存在，您可以使用如下简单`if`结构：

```
if [ -d directory/path to a directory ] ; then
# Things to do

else #if needed #also: elif [new condition]
# Things to do
fi 
```

你也可以在否定的情况下这样做：

```
if [ ! -d directory/path to a directory ] ; then
# Things to do when not an existing directory 
```

**注意**：小心。在左大括号和右大括号的两侧留空。

使用相同的语法，您可以使用：

```
-e: any kind of archive

-f: file

-h: symbolic link

-r: readable file

-w: writable file

-x: executable file

-s: file size greater than zero 
```

* * *

## 回答 #7

> 赞同：144
> 
> 时间：2018-05-15T05:36:08.160

1.  一个简单的脚本来测试目录或文件是否存在：

    ```
     if [ -d /home/ram/dir ]   # For file "if [ -f /home/rama/file ]"
     then
         echo "dir present"
     else
         echo "dir not present"
     fi 
    ```

2.  一个简单的脚本来检查目录是否存在：

    ```
     mkdir tempdir   # If you want to check file use touch instead of mkdir
     ret=$?
     if [ "$ret" == "0" ]
     then
         echo "dir present"
     else
         echo "dir not present"
     fi 
    ```

    上面的脚本将检查目录是否存在

    `$?` 如果最后一个命令成功，则返回“0”，否则返回非零值。假设`tempdir`已经存在。然后`mkdir tempdir`会给出如下错误：

    > mkdir: 无法创建目录 'tempdir': 文件存在

* * *

## 回答 #8

> 赞同：107
> 
> 时间：2015-09-12T21:25:05.697

您可以使用`test -d`（请参阅`man test`）。

> `-d file` 如果文件存在并且是目录，则为真。

例如：

```
test -d "/etc" && echo Exists || echo Does not exist 
```

注意：该`test`命令与条件表达式相同`[`（请参阅：）`man [`，因此它可以跨 shell 脚本移植。

> `[`- 这是`test`内置的同义词，但最后一个参数必须是文字`]`，以匹配开头`[`。

有关可能的选项或进一步的帮助，请检查：

*   `help [`
*   `help test`
*   `man test`或者`man [`

* * *

## 回答 #9

> 赞同：60
> 
> 时间：2009-08-17T14:02:43.420

或者对于完全没用的东西：

```
[ -d . ] || echo "No" 
```

* * *

## 回答 #10

> 赞同：59
> 
> 时间：2012-08-09T21:43:52.137

这是一个非常实用的成语：

```
(cd $dir) || return # Is this a directory,
                    # and do we have access? 
```

我通常将它包装在一个函数中：

```
can_use_as_dir() {
    (cd ${1:?pathname expected}) || return
} 
```

或者：

```
assert_dir_access() {
    (cd ${1:?pathname expected}) || exit
} 
```

这种方法的好处是我不必考虑好的错误消息。

`cd`会给我一个标准的单行消息到[标准错误](https://en.wikipedia.org/wiki/Standard_streams#Standard_error_(stderr))。它还将提供比我能够提供的更多的信息。通过在`cd`subshel​​l 内部执行`( ... )`，该命令不会影响调用者的当前目录。如果该目录存在，则此子shell 和函数只是一个空操作。

接下来是我们传递给`cd`:的参数`${1:?pathname expected}`。这是一种更复杂的参数替换形式，下面将更详细地解释。

Tl;dr：如果传递给这个函数的字符串是空的，我们再次退出子shell`( ... )`并从函数返回给定的错误消息。

* * *

从`ksh93`手册页引用：

```
${parameter:?word} 
```

> 如果 `parameter` 已设置且不为空，则替换其值；否则，打印`word`并从 shell 退出（如果不是交互式的）。如果`word`省略，则打印标准消息。

和

> 如果上述表达式中省略了冒号`:`，则 shell 仅检查是否设置了参数。

这里的措辞是 shell 文档特有的，因为它`word`可以指任何合理的字符串，包括空格。

在这种特殊情况下，我知道标准错误消息`1: parameter not set`是不够的，所以我放大了我们在这里期望的值的类型——`pathname`目录的类型。

哲学笔记：

shell 不是面向对象的语言，所以消息说`pathname`，不是`directory`。在这个级别上，我宁愿保持简单——函数的参数只是字符串。

* * *

## 回答 #11

> 赞同：41
> 
> 时间：2010-04-21T06:06:05.000

```
if [ -d "$Directory" -a -w "$Directory" ]
then
    #Statements
fi 
```

上面的代码检查目录是否存在以及是否可写。

* * *

## 回答 #12

> 赞同：32
> 
> 时间：2008-09-12T20:17:12.577

## 更多功能使用`find`

*   检查子目录中是否存在该文件夹：

    ```
     found=`find -type d -name "myDirectory"`
      if [ -n "$found" ]
      then
          # The variable 'found' contains the full path where "myDirectory" is.
          # It may contain several lines if there are several folders named "myDirectory".
      fi 
    ```

*   根据当前目录中的模式检查一个或多个文件夹的存在：

    ```
     found=`find -maxdepth 1 -type d -name "my*"`
      if [ -n "$found" ]
      then
          # The variable 'found' contains the full path where folders "my*" have been found.
      fi 
    ```

*   两种组合。在以下示例中，它检查当前目录中是否存在文件夹：

    ```
     found=`find -maxdepth 1 -type d -name "myDirectory"`
      if [ -n "$found" ]
      then
          # The variable 'found' is not empty => "myDirectory"` exists.
      fi 
    ```

* * *

## 回答 #13

> 赞同：31
> 
> 时间：2019-10-09T06:08:03.883

```
DIRECTORY=/tmp

if [ -d "$DIRECTORY" ]; then
    echo "Exists"
fi 
```

**[在线尝试](https://code.labstack.com/7GMFlEaC)**

* * *

## 回答 #14

> 赞同：27
> 
> 时间：2014-11-05T03:39:01.307

在 Bash 提示符下键入此代码：

```
if [ -d "$DIRECTORY" ]; then
    # If true this block of code will execute
fi 
```

* * *

## 回答 #15

> 赞同：23
> 
> 时间：2010-02-17T17:46:07.773

实际上，您应该使用几种工具来获得防弹方法：

```
DIR_PATH=`readlink -f "${the_stuff_you_test}"` # Get rid of symlinks and get abs path
if [[ -d "${DIR_PATH}" ]] ; Then # Now you're testing
    echo "It's a dir";
fi 
```

只要您使用`"${}"`.

请注意，`[[]]`它不如`[]`.

* * *

## 回答 #16

> 赞同：23
> 
> 时间：2017-12-07T16:24:23.760

你有没有考虑过只做你想做的事，`if`而不是在你跳跃之前先看？

即，如果您想在输入目录之前检查目录是否存在，请尝试这样做：

```
if pushd /path/you/want/to/enter; then
    # Commands you want to run in this directory
    popd
fi 
```

如果您提供的路径`pushd`存在，您将输入它并以 退出`0`，这意味着`then`语句的部分将执行。如果它不存在，则不会发生任何事情（除了一些输出说目录不存在，这对于调试来说可能是一个有用的副作用）。

这似乎比这更好，这需要重复自己：

```
if [ -d /path/you/want/to/enter ]; then
    pushd /path/you/want/to/enter
    # Commands you want to run in this directory
    popd
fi 
```

同样的事情适用于`cd`, `mv`, `rm`, 等...如果您在不存在的文件上尝试它们，它们将退出并显示错误并打印一条消息说它不存在，并且您的`then`块将被跳过。如果您在确实存在的文件上尝试它们，该命令将执行并以 状态退出`0`，从而允许您的`then`块执行。

* * *

## 回答 #17

> 赞同：20
> 
> 时间：2015-04-19T00:54:07.030

```
[[ -d "$DIR" && ! -L "$DIR" ]] && echo "It's a directory and not a symbolic link" 
```

> 注意：引用变量是一种很好的做法。

**解释：**

*   `-d`: 检查是否是目录
*   `-L`: 检查是否是符号链接

* * *

## 回答 #18

> 赞同：17
> 
> 时间：2015-12-29T09:45:14.513

要检查多个目录，请使用以下代码：

```
if [ -d "$DIRECTORY1" ] && [ -d "$DIRECTORY2" ] then
    # Things to do
fi 
```

* * *

## 回答 #19

> 赞同：16
> 
> 时间：2016-03-23T07:25:55.557

检查目录是否存在，否则创建一个：

```
[ -d "$DIRECTORY" ] || mkdir $DIRECTORY 
```

* * *

## 回答 #20

> 赞同：15
> 
> 时间：2013-04-18T22:12:37.013

```
[ -d ~/Desktop/TEMPORAL/ ] && echo "DIRECTORY EXISTS" || echo "DIRECTORY DOES NOT EXIST" 
```

* * *

## 回答 #21

> 赞同：12
> 
> 时间：2016-04-15T18:13:53.633

[这个答案](https://stackoverflow.com/a/59871/26510)包含在一个 shell 脚本中

### 例子

```
$ is_dir ~                           
YES

$ is_dir /tmp                        
YES

$ is_dir ~/bin                       
YES

$ mkdir '/tmp/test me'

$ is_dir '/tmp/test me'
YES

$ is_dir /asdf/asdf                  
NO

# Example of calling it in another script
DIR=~/mydata
if [ $(is_dir $DIR) == "NO" ]
then
  echo "Folder doesnt exist: $DIR";
  exit;
fi 
```

### is_dir

```
function show_help()
{
  IT=$(CAT <<EOF

  usage: DIR
  output: YES or NO, depending on whether or not the directory exists.

  )
  echo "$IT"
  exit
}

if [ "$1" == "help" ]
then
  show_help
fi
if [ -z "$1" ]
then
  show_help
fi

DIR=$1
if [ -d $DIR ]; then 
   echo "YES";
   exit;
fi
echo "NO"; 
```

* * *

## 回答 #22

> 赞同：11
> 
> 时间：2013-07-25T13:12:09.573

使用`-e`检查将检查文件，这包括目录。

```
if [ -e ${FILE_PATH_AND_NAME} ]
then
    echo "The file or directory exists."
fi 
```

* * *

## 回答 #23

> 赞同：9
> 
> 时间：2010-03-18T10:52:57.553

```
if [ -d "$DIRECTORY" ]; then
    # Will enter here if $DIRECTORY exists
fi 
```

这并不完全正确……

如果要进入该目录，还需要对该目录具有执行权限。也许您还需要具有写入权限。

所以：

```
if [ -d "$DIRECTORY" ] && [ -x "$DIRECTORY" ] ; then
    # ... to go to that directory (even if DIRECTORY is a link)
    cd $DIRECTORY
    pwd
fi 
```

* * *

```
if [ -d "$DIRECTORY" ] && [ -w "$DIRECTORY" ] ; then
    # ... to go to that directory and write something there (even if DIRECTORY is a link)
    cd $DIRECTORY
    touch foobar
fi 
```

* * *

## 回答 #24

> 赞同：9
> 
> 时间：2015-09-12T21:21:06.503

根据[乔纳森](https://stackoverflow.com/users/15168/jonathan-leffler)的评论：

如果你想创建目录但它还不存在，那么最简单的技术是使用`mkdir -p`它来创建目录——以及路径上任何缺失的目录——并且如果目录已经存在也不会失败，所以你可以做这一切同时：

```
mkdir -p /some/directory/you/want/to/exist || exit 1 
```

* * *

## 回答 #25

> 赞同：8
> 
> 时间：2017-04-15T13:36:55.640

以一种[三元](https://en.wikipedia.org/wiki/%3F:)形式，

```
[ -d "$directory" ] && echo "exist" || echo "not exist" 
```

并与[`test`](https://linux.die.net/man/1/test)：

```
test -d "$directory" && echo "exist" || echo "not exist" 
```

* * *

## 回答 #26

> 赞同：7
> 
> 时间：2011-09-15T19:47:49.540

该`ls`命令与`-l`（长列表）选项一起返回有关文件和目录的属性信息。
特别是`ls -l`输出的第一个字符通常是一个`d`或一个`-`（破折号）。如果`d`列出的是一个目录，那肯定是一个目录。

仅一行中的以下命令将告诉您给定**`ISDIR`**变量是否包含目录路径：

```
[[ $(ls -ld "$ISDIR" | cut -c1) == 'd' ]] &&
    echo "YES, $ISDIR is a directory." || 
    echo "Sorry, $ISDIR is not a directory" 
```

实际使用：

```
 [claudio@nowhere ~]$ ISDIR="$HOME/Music" 
    [claudio@nowhere ~]$ ls -ld "$ISDIR"
    drwxr-xr-x. 2 claudio claudio 4096 Aug 23 00:02 /home/claudio/Music
    [claudio@nowhere ~]$ [[ $(ls -ld "$ISDIR" | cut -c1) == 'd' ]] && 
        echo "YES, $ISDIR is a directory." ||
        echo "Sorry, $ISDIR is not a directory"
    YES, /home/claudio/Music is a directory.

    [claudio@nowhere ~]$ touch "empty file.txt"
    [claudio@nowhere ~]$ ISDIR="$HOME/empty file.txt" 
    [claudio@nowhere ~]$ [[ $(ls -ld "$ISDIR" | cut -c1) == 'd' ]] && 
        echo "YES, $ISDIR is a directory." || 
        echo "Sorry, $ISDIR is not a directoy"
    Sorry, /home/claudio/empty file.txt is not a directory 
```

* * *

## 回答 #27

> 赞同：6
> 
> 时间：2011-12-12T20:40:01.247

那里有很好的解决方案，但如果您不在正确的目录中，最终每个脚本都会失败。所以这样的代码：

```
if [ -d "$LINK_OR_DIR" ]; then
if [ -L "$LINK_OR_DIR" ]; then
    # It is a symlink!
    # Symbolic link specific commands go here
    rm "$LINK_OR_DIR"
else
    # It's a directory!
    # Directory command goes here
    rmdir "$LINK_OR_DIR"
fi
fi 
```

只有在执行时您所在的目录具有您碰巧检查的子目录，才会成功执行。

我理解这样的初始问题：无论用户在文件系统中的位置如何，都要验证目录是否存在。所以使用命令'find'可能会成功：

```
dir=" "
echo "Input directory name to search for:"
read dir
find $HOME -name $dir -type d 
```

这个解决方案很好，因为它允许使用通配符，这是搜索文件/目录时的一个有用功能。唯一的问题是，如果搜索到的目录不存在，“查找”命令将不会在[标准输出](https://en.wikipedia.org/wiki/Standard_streams#Standard_output_.28stdout.29)中打印任何内容（对我来说这不是一个优雅的解决方案），并且仍然会出现零退出。也许有人可以改进这一点。

* * *

## 回答 #28

> 赞同：6
> 
> 时间：2013-02-22T02:39:07.313

```
file="foo" 
if [[ -e "$file" ]]; then echo "File Exists"; fi; 
```

* * *

## 回答 #29

> 赞同：6
> 
> 时间：2014-08-13T13:41:35.353

`find`可以使用下面的，

```
find . -type d -name dirname -prune -print 
```

* * *

## 回答 #30

> 赞同：6
> 
> 时间：2015-05-13T07:21:10.920

(1)

```
[ -d Piyush_Drv1 ] && echo ""Exists"" || echo "Not Exists" 
```

(2)

```
[ `find . -type d -name Piyush_Drv1 -print | wc -l` -eq 1 ] && echo Exists || echo "Not Exists" 
```

(3)

```
[[ -d run_dir  && ! -L run_dir ]] && echo Exists || echo "Not Exists" 
```

如果使用上述方法之一发现问题：

用`ls`命令；目录不存在的情况 - 显示错误消息

```
[[ `ls -ld SAMPLE_DIR| grep ^d | wc -l` -eq 1 ]] && echo exists || not exists 
```

> -ksh: not: not found [没有这样的文件或目录]

* * *

## 回答 #31

> 赞同：5
> 
> 时间：2018-06-25T06:59:09.197

使用该`file`程序。考虑到 Linux 中的所有目录也是文件，发出以下命令就足够了：

`file $directory_name`

检查不存在的文件：`file blah`

**输出：** `cannot open 'blah' (No such file or directory)`

检查现有目录：`file bluh`

**输出：** `bluh: directory`

* * *

## 回答 #32

> 赞同：4
> 
> 时间：2014-01-07T17:59:56.567

如果要检查目录是否存在，无论它是真实目录还是符号链接，请使用以下命令：

```
ls $DIR
if [ $? != 0 ]; then
        echo "Directory $DIR already exists!"
        exit 1;
fi
echo "Directory $DIR does not exist..." 
```

说明：如果目录或符号链接不存在，“ls”命令会给出错误“ls: /x: No such file or directory”，并将返回码（您可以通过“$?”检索）设置为非-null（通常为“1”）。确保在调用“ls”后直接检查返回码。

* * *

## 回答 #33

> 赞同：3
> 
> 时间：2017-06-29T22:14:25.753

从脚本文件*myScript.sh*：

```
if [ -d /home/ec2-user/apache-tomcat-8.5.5/webapps/Gene\ Directory ]; then
   echo "Directory exists!"
   echo "Great"
fi 
```

*或者*

```
if [ -d '/home/ec2-user/apache-tomcat-8.5.5/webapps/Gene Directory' ]; then
   echo "Directory exists!"
   echo "Great"
fi 
```

* * *

## 回答 #34

> 赞同：3
> 
> 时间：2017-09-13T19:49:19.297

**Git Bash + Dropbox + Windows：**

其他解决方案都不适用于我的 Dropbox 文件夹，这很奇怪，因为我可以将 Git 推送到 Dropbox 符号路径。

```
#!/bin/bash

dbox="~/Dropbox/"
result=0
prv=$(pwd) && eval "cd $dbox" && result=1 && cd "$prv"
echo $result

read -p "Press Enter To Continue:" 
```

您可能还想知道如何从 Bash 成功导航到 Dropbox。所以这里是完整的脚本。

[https://pastebin.com/QF2Exmpn](https://pastebin.com/QF2Exmpn)

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2019-07-26T15:45:48.733

作为 '[ -d ]' 和 '[ -h ]' 选项的替代方案，您可以使用`stat`获取文件类型并对其进行解析。

```
#! /bin/bash
MY_DIR=$1
NODE_TYPE=$(stat -c '%F' ${MY_DIR} 2>/dev/null)
case "${NODE_TYPE}" in
        "directory") echo $MY_DIR;;
    "symbolic link") echo $(readlink $MY_DIR);;
                 "") echo "$MY_DIR does not exist";;
                  *) echo "$NODE_TYPE is unsupported";;
esac
exit 0 
```

测试数据：

```
$ mkdir tmp
$ ln -s tmp derp
$ touch a.txt
$ ./dir.sh tmp
tmp
$ ./dir.sh derp
tmp
$ ./dir.sh a.txt
regular file is unsupported
$ ./dir.sh god
god does not exist 
```

# .net - linq Contains 语句中的错误 - 是否有修复或解决方法？

> ID：59840
> 
> 赞同：2
> 
> 时间：2008-09-12T20:07:19.247
> 
> 标签：.net, linq

我在 Linq 中的 Contains 语句中发现了一个错误（不确定它是否真的在 Linq 或 Linq to SQL 中），并且想知道是否有其他人看到过这个问题以及是否有修复或解决方法。

如果您执行包含的查询源中包含超过 10 个项目，则它不会将项目正确传递给 SQL 查询。很难解释它的作用，一个例子会最好地说明它。

如果您查看原始查询，参数如下所示：

```
@P0 = 'aaa'
@P1 = 'bbb'
@P2 = 'ccc'
... [@P3 through @P9]
@P10 = '111'
@P11 = '222'
... [@p12 through @P19]
@P20 = 'sss'
... [@P21 through @P99]
@P100 = 'qqq' 
```

当值被传递到最终查询（所有参数已解析）时，它已经解析了参数，就好像这些是传递的值一样：

```
@P0 = 'aaa'
@P1 = 'bbb'
@P2 = 'ccc'
...
@P10 = 'bbb'0
@P11 = 'bbb'1
...
@P20 = 'ccc'0
...
@P100 = 'bbb'00 
```

所以看起来参数解析只在第一个数字之后查看`@P`并解析它，然后添加参数名称末尾留下的任何内容。

至少这就是 Visual Studio 的 Sql Server Query Visualizer 插件显示查询所做的事情。

真的很奇怪。

所以如果有人有建议，请分享。谢谢！

**更新：**
我已将原始 linq 语句重写为现在使用联接而不是包含的位置，但仍想知道是否有解决此问题的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-12T20:17:26.463

我看的越多，在运行了更多的测试之后，我认为这个错误可能在 Visual Studio 的 Sql Server Query Visualizer 插件中，而不是在 Linq to SQL 本身中。所以情况并没有我想象的那么糟糕——查询将返回正确的结果，但你不能相信 Visualizer 显示的内容。不是很好，但比我想象的要好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T21:42:47.880

在您通过判断之前，请尝试实际查看数据上下文的输出。

DataContext.Log() 将为您提供生成的 SQL。

# java - 如何为 Java 双原语创建一个 Spring bean？

> ID：59850
> 
> 赞同：9
> 
> 时间：2008-09-12T20:12:52.620
> 
> 标签：java, spring, double

我想创建一个拥有双精度值的弹簧豆。就像是：

```
<bean id="doubleValue" value="3.7"/> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-12T20:28:57.323

像这样声明它：

```
<bean id="doubleValue" class="java.lang.Double">
   <constructor-arg index="0" value="3.7"/>
</bean> 
```

并像这样使用：

```
<bean id="someOtherBean" ...>
   <property name="value" ref="doubleValue"/>
</bean> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-16T15:51:25.507

还值得注意的是，根据您的需要定义自己的 bean 可能不是您的最佳选择。

```
<util:constant static-field="org.example.Constants.FOO"/> 
```

是访问存储在类中的常量值的好方法，默认绑定器也适用于转换，例如

```
<bean class="Foo" p:doubleValue="123.00"/> 
```

我发现自己以这种方式替换了许多 bean，再加上定义我的值的属性文件（用于重用目的）。以前是这样的

```
<bean id="d1" class="java.lang.Double">
  <constructor-arg value="3.7"/>
</bean>
<bean id="foo" class="Foo">
  <property name="doubleVal" ref="d1"/>
</bean> 
```

被重构为：

```
<bean
  id="propertyFile"
  class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"
  p:location="classpath:my.properties"
/>
<bean id="foo" class="Foo" p:doubleVal="${d1}"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T20:15:24.453

你为什么不直接使用**Double**？任何原因？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-14T12:13:04.687

春天 2.5+

**您可以在 Java 配置中这样定义 bean：**

```
@Configuration
public class BeanConfig {
    @Bean
    public Double doubleBean(){
        return  new Double(3.7);
    }
} 
```

**你可以在你的程序中像这样使用这个bean：**

```
@Autowired
Double doubleBean;

public void printDouble(){
    System.out.println(doubleBean); //sample usage
} 
```

# database - 我应该在数据库和应用程序服务器之间使用专用网络通道吗？

> ID：59857
> 
> 赞同：0
> 
> 时间：2008-09-12T20:18:13.387
> 
> 标签：database, performance, networking, latency

我应该在数据库和应用程序服务器之间使用专用网络通道吗？

...或者...

在交换机中连接两者以及所有其他计算机节点完全没有区别吗？

关键是**性能！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-12T20:23:30.487

这完全取决于您的应用程序的吞吐量需求。如果您绝对需要尽可能低的延迟，那么优化路由是有意义的。除了高度可扩展的软件之外，我认为这很少需要，您可以以通用方式连接所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T20:26:01.433

这取决于您的非功能性要求。假设 NIC 以相同的速率运行，那么从带宽的角度来看，让数据库流量远离前端流量只能是一件好事——如果带宽是一个问题的话。

更重要的是，通过将前端和数据端保持在不同的网络上来提高安全性，因为直接访问数据库的唯一方法是破坏应用程序服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T20:31:30.033

使用共享交换机可能会增加延迟，尤其是在交换机繁忙的情况下。此外，您可以连接更快的专用网络通道（例如千兆以太网，如果您的交换机是 100Mbit）。不过，这是否值得做取决于您的应用程序。

您可能还想使用专用通道来提高安全性（使您的数据库服务器更难访问）。

# unit-testing - 在测试基于 MVC 的 UI 时，您常用的测试设置有多少？

> ID：59859
> 
> 赞同：0
> 
> 时间：2008-09-12T20:19:19.000
> 
> 标签：unit-testing, model-view-controller, user-interface, tdd, mvp

我正在尝试测试一个简单的基于 WebForms (asp.net) 的 UI，并遵循 MVP 模式以使我的 UI 更具可测试性。

当我遵循后端算法的 TDD 方法时，我发现有一些单元测试重构是本着 DRY 原则（不要重复自己）的精神发生的。当我尝试使用 Rhino Mocks 将其应用于 UI 以验证我的交互时，在设置视图或模型期望时，我在 Controller 测试中看到了许多共性。

我的问题是：如果有的话，你通常会在多大程度上进行这种重构？我很想知道其他 TDDer 如何测试他们基于 MVC/MVP 的 UI。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T00:00:20.137

我不会像标准代码那样重构测试。当您将事物重构为通用基类、辅助方法等时，测试开始变得更加模糊。测试本身应该足够清晰。

DRY 不是测试问题。

也就是说，有许多管道工作是常见的，应该抽象出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T20:49:52.907

我使用 MVP，在我的测试中，我尝试在标准代码中应用大部分重构。由于测试不同场景所需的细微变化，它通常在测试中效果不佳，但在部分内部可能存在共性，并且在可能的情况下我会进行整合。随着项目的发展，这确实减轻了后期所需的更改；就像在您的标准代码中一样，更改一个位置而不是 20 个位置更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T21:46:53.033

我更愿意将单元测试视为纯功能程序，以避免必须测试它们。如果一个操作在测试之间足够普遍，那么我会为标准代码库评估它，但即便如此我也会避免重构测试，因为我倾向于有很多它们，特别是对于 gui 驱动的 BL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T21:51:35.457

我使用 selenium 进行功能测试，我使用 JUnit 来测试我的控制器。

我将模拟控制器使用的服务或资源并测试以查看控制器重定向到的 URI 等...

在这一点上，我唯一没有真正测试的是视图。但我采用了功能测试来弥补。

# sql - 一般来说，存储过程是否比现代 RDBMS 上的内联语句更有效？

> ID：59880
> 
> 赞同：114
> 
> 时间：2008-09-12T20:32:25.507
> 
> 标签：sql, database, stored-procedures

传统观点认为存储过程总是更快。因此，由于它们总是更快，因此请始终使用**它们**。

我很确定这是基于某种历史背景，而这曾经是这种情况。现在，我并不主张不需要存储过程，但我想知道在 MySQL、SQL Server、Oracle 或 < *Insert_your_DB_here* > 等现代数据库中，在什么情况下需要存储过程。通过存储过程进行所有访问是否过大？

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2008-09-12T20:53:57.390

> **请注意**，这是对未受特定 DBMS 监管的存储过程的一般看法。一些 DBMS（甚至是同一 DBMS 的不同版本！）可能与此相反，因此您需要在假设所有这些仍然存在之前与您的目标 DBMS 进行仔细检查。
> 
> 近十年来，我一直是 Sybase ASE、MySQL 和 SQL Server DBA（以及 C、PHP、PL/SQL、C#.NET 和 Ruby 中的应用程序开发）。所以，在这场（有时）圣战中，我没有什么特别需要磨的。

存储过程的历史性能优势通常来自以下（无特定顺序）：

*   预解析的 SQL
*   预生成的查询执行计划
*   减少网络延迟
*   潜在的缓存优势

**预解析的 SQL** - 与编译代码和解释代码类似的好处，除了在非常微观的层面上。

*还是优势？* 在现代 CPU 上根本不是很明显，但是如果您发送一个非常大的 SQL 语句，每秒 110 亿次，则解析开销可能会增加。

**预先生成的查询执行计划**。如果您有许多 JOIN，则排列可能会变得非常难以管理（现代优化器出于性能原因有限制和截止）。由于优化器试图找出“近乎最佳”的延迟，非常复杂的 SQL 具有明显的、可测量的（在我们调整 DBMS 之前，我已经看到一个复杂的查询需要 10 多秒才能生成计划）延迟并不是未知的“执行计划。存储过程通常会将其存储在内存中，这样您就可以避免这种开销。

*还是优势？* 大多数 DBMS（最新版本）将缓存 INDIVIDUAL SQL 语句的查询计划，从而大大减少存储过程和 ad hoc SQL 之间的性能差异。有一些注意事项和情况并非如此，因此您需要在目标 DBMS 上进行测试。

此外，越来越多的 DBMS 允许您提供优化器路径计划（抽象查询计划）以显着减少优化时间（针对即席和存储过程 SQL ！！）。

> **警告**缓存查询计划不是性能灵丹妙药。有时生成的查询计划不是最佳的。例如，如果您发送`SELECT * FROM table WHERE id BETWEEN 1 AND 99999999`，DBMS 可能会选择全表扫描而不是索引扫描，因为您正在抓取表中的每一行（统计数据如此）。如果这是缓存版本，那么稍后发送 `SELECT * FROM table WHERE id BETWEEN 1 AND 2`. 这背后的原因超出了本文的范围，但进一步阅读请参阅： http: [//www.microsoft.com/technet/prodtechnol/sql/2005/frcqupln.mspx](http://www.microsoft.com/technet/prodtechnol/sql/2005/frcqupln.mspx) 和 [http://msdn.microsoft.com/ en-us/library/ms181055.aspx](http://msdn.microsoft.com/en-us/library/ms181055.aspx) 和[http://www.simple-talk.com/sql/performance/execution-plan-basics/](http://www.simple-talk.com/sql/performance/execution-plan-basics/)
> 
> “总而言之，他们确定在执行编译或重新编译时提供除公共值之外的任何值会导致优化器为该特定值编译和缓存查询计划。然而，当该查询计划被重用于后续执行相同的值时查询公共值（'M'，'R'或'T'），它导致次优性能。这个次优性能问题一直存在，直到重新编译查询。那时，基于@P1提供的参数值，查询可能有也可能没有性能问题。”

**减少网络延迟** A) 如果您一遍又一遍地运行相同的 SQL——并且 SQL 增加了许多 KB 的代码——用简单的“exec foobar”替换它确实可以增加。B) 存储过程可用于将过程代码移动到 DBMS。这节省了将大量数据转移到客户端的过程，只是让它返回少量信息（或根本没有！）。类似于在 DBMS 中与在您的代码中进行 JOIN（每个人都喜欢的 WTF！）

*还是优势？* A) 现代 1Gb（以及 10Gb 及以上！）以太网确实可以忽略不计。B) 取决于您的网络的饱和程度——为什么无缘无故地来回推送几兆字节的数据？

**潜在的缓存优势** 如果您在 DBMS 上有足够的内存并且您需要的数据在服务器的内存中，那么执行服务器端数据转换可能会更快。

*还是优势？* 除非您的应用程序对 DBMS 数据具有共享内存访问权限，否则边缘将始终是存储过程。

当然，如果不讨论参数化 SQL 和即席 SQL，则任何关于存储过程优化的讨论都是不完整的。

**参数化/准备好的 SQL**
是存储过程和即席 SQL 之间的一种交叉，它们是宿主语言中的嵌入式 SQL 语句，使用“参数”作为查询值，例如：

```
SELECT .. FROM yourtable WHERE foo = ? AND bar = ? 
```

这些提供了更通用的查询版本，现代优化器可以使用它来缓存（和重用）查询执行计划，从而获得存储过程的大部分性能优势。

**Ad Hoc SQL** 只需打开 DBMS 的控制台窗口并输入 SQL 语句。在过去，这些是“最差”的执行者（平均而言），因为 DBMS 无法像参数化/存储的 proc 方法那样预先优化查询。

*还是劣势？* 不必要。大多数 DBMS 有能力将临时 SQL “抽象”成参数化版本——因此或多或少地否定了两者之间的差异。有些会隐式执行此操作，或者必须使用命令设置启用（SQL 服务器： http: [//msdn.microsoft.com/en-us/library/ms175037.aspx，Oracle](http://msdn.microsoft.com/en-us/library/ms175037.aspx) ：http : [//www.praetoriate.com/oracle_tips_cursor_sharing。 .htm](http://www.praetoriate.com/oracle_tips_cursor_sharing.htm)）。

**得到教训？** 摩尔定律继续向前发展，DBMS 优化器随着每个版本的发布都变得更加复杂。当然，您可以将每一条愚蠢的 SQL 语句放在存储过程中，但要知道从事优化器工作的程序员非常聪明，并且一直在寻找提高性能的方法。最终（如果还没有的话）即席 SQL 性能将变得与存储过程性能无法区分（平均而言！），因此任何类型的*大规模*存储过程都使用**仅出于“性能原因”**对我来说听起来像是过早的优化.

无论如何，我认为如果您避免边缘情况并使用相当普通的 SQL，您将不会注意到 ad hoc 和存储过程之间的区别。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-16T15:36:27.980

使用存储过程的原因：

*   **减少网络流量**——您必须通过网络发送 SQL 语句。使用sprocs，可以批量执行SQL，效率也更高。
*   **缓存查询计划**——第一次执行 sproc 时，SQL Server 创建一个执行计划，该计划被缓存以供重用。这对于频繁运行的小型查询特别有效。
*   **使用输出参数的能力**——如果你发送返回一行的内联 SQL，你只能返回一个记录集。使用 sprocs，您可以将它们作为输出参数取回，这要快得多。
*   **权限**——当你发送内联 SQL 时，你必须向用户授予对表的权限，这比仅仅授予执行存储过程的权限要多得多
*   **逻辑分离**——删除生成 SQL 的代码并将其隔离在数据库中。
*   **无需重新编译即可编辑的能力**——这可能会引起争议。您可以在存储过程中编辑 SQL，而无需重新编译应用程序。
*   **查找表的使用位置**——使用 sprocs，如果要查找引用特定表的所有 SQL 语句，可以导出 sproc 代码并搜索它。这比试图在代码中找到它要容易得多。
*   **优化**——当使用存储过程时，DBA 更容易优化 SQL 和调整数据库。更容易找到丢失的索引等。
*   **SQL 注入攻击**——正确编写的内联 SQL 可以防御攻击，但存储过程更适合这种保护。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-09-12T20:38:25.663

在许多情况下，存储过程实际上更慢，因为它们更一般化。虽然存储过程可以进行高度调整，但根据我的经验，有足够的开发和制度摩擦，一旦它们工作，它们就会留在原地，所以存储过程通常倾向于“以防万一”返回很多列 - 因为你不每次更改应用程序时都希望部署一个新的存储过程。另一方面，OR/M 只请求应用程序正在使用的列，这减少了网络流量、不必要的连接等。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-12T20:41:20.133

这是一场持续不断的辩论（例如，[这里](https://stackoverflow.com/questions/22907/which-is-better-ad-hoc-queries-or-stored-procedures)）。

编写糟糕的存储过程就像在应用程序中编写糟糕的数据访问逻辑一样容易。

我的偏好是存储过程，但那是因为我通常在企业环境中使用非常大型和复杂的应用程序，其中有专门的 DBA 负责保持数据库服务器的正常运行。

在其他情况下，我很高兴使用 LINQ 等数据访问技术来进行优化。

不过，纯粹的性能并不是唯一的考虑因素。安全和配置管理等方面通常至少同样重要。

编辑：虽然 Frans Bouma 的文章确实很冗长，但它在安全性方面错过了一点。它已有 5 年历史的事实也无助于它的相关性。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-09-12T20:50:34.730

在大多数现代数据库上，存储过程与参数化或准备好的查询没有明显的速度差异，因为数据库还将缓存这些查询的执行计划。

请注意，参数化查询与 ad hoc sql 不同。

imo 今天仍然支持存储过程的主要原因更多地与安全性有关。如果您*专门*使用存储过程，您可以禁用应用程序用户的 INSERT、SELECT、UPDATE、DELETE、ALTER、DROP 和 CREATE 等权限，只保留 EXECUTE。

这提供了一些额外的保护来防止*二阶*sql 注入。参数化查询仅防止*一阶*注入。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-12T20:51:06.583

显然，实际表现应该在个别情况下衡量，而不是假设。但即使在性能*受到*存储过程影响的情况下，也有充分的理由使用它们：

1.  应用程序开发人员并不总是最好的 SQL 编码员。存储过程对应用程序隐藏 SQL。

2.  存储过程自动使用绑定变量。应用程序开发人员经常避免绑定变量，因为它们看起来像是不需要的代码，并且在小型测试系统中几乎没有什么好处。稍后，未能使用绑定变量会限制 RDBMS 的性能。

3.  存储过程创建了一个间接层，以后可能会有用。无需接触应用程序代码即可在数据库端更改实现细节（包括表结构）。

4.  创建存储过程的练习对于记录系统的所有数据库交互很有用。当事情发生变化时，更容易更新文档。

也就是说，我通常在我的应用程序中使用原始 SQL，以便我可以自己控制它。这取决于您的开发团队和理念。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-13T14:59:28.950

尚未有人提到存储过程的好处的一个主题是安全性。如果您通过存储过程专门使用数据访问来构建应用程序，则可以锁定数据库，以便唯一的访问是通过这些存储过程。因此，即使有人获得了数据库 ID 和密码，他们也将受到限制，他们可以查看或针对该数据库执行的操作。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-11-25T14:55:48.353

2007 年，我在一个项目中，我们通过 ORM 使用 MS SQL Server。我们有 2 个不断增长的大表，在 SQL Server 上加载时间长达 7-8 秒。在制作了 2 个大型存储 SQL 过程并通过查询计划器对其进行优化后，每个 DB 加载时间降至不到 20 毫秒，因此显然仍然存在使用存储 SQL 过程的效率原因。

话虽如此，我们发现存储过程最重要的好处是增加了维护便利性、安全性、数据完整性，以及将业务逻辑与中间件逻辑解耦，使所有中间件逻辑受益于这两个过程的重用.

我们的 ORM 供应商通常声称触发许多小型 SQL 查询将比获取大型连接数据集更有效。我们的经历（令我们惊讶的是）显示了其他东西。

当然，这可能因机器、网络、操作系统、SQL 服务器、应用程序框架、ORM 框架和语言实现而异，因此衡量任何收益，您认为您可能会从做其他事情中获得收益。

直到我们进行基准测试，我们才发现问题出在 ORM 和承担所有负载的数据库之间。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-12T20:45:03.870

我更喜欢在有意义的情况下使用 SP。无论如何，在 SQL Server 中，SP 对参数化查询没有性能优势。

然而，在我目前的工作中，我的老板提到我们被迫使用 SP，因为我们的客户需要它们。他们觉得他们更安全。我来这里的时间还不够长，无法查看我们是否正在实施基于角色的安全性，但我有一种感觉。

因此，在这种情况下，客户的感受胜过所有其他论点。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-10-11T16:20:18.690

对我来说，存储过程的一个优点是与宿主语言无关：您可以从 C、Python、PHP 或任何应用程序切换到另一种编程语言，而无需重写代码。此外，诸如批量操作之类的某些功能确实可以提高性能，并且在宿主语言中不容易获得（根本不是？）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-12T20:34:44.517

我不知道他们更快。我喜欢使用 ORM 进行数据访问（不要重新发明轮子），但我意识到这并不总是一个可行的选择。

Frans Bouma 有一篇关于这个主题的好文章：[http ://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx](http://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-12T20:35:26.030

阅读 Frans Bouma 的[精彩文章](http://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx)（如果有点偏颇）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-12T20:39:05.460

我只能说 SQL 服务器。在那个平台上，存储过程很可爱，因为服务器存储了执行计划，这在大多数情况下可以大大提高性能。我说“在大多数情况下”，因为如果 SP 具有广泛不同的执行路径，您可能会获得次优的性能。然而，即使在这些情况下，对 SP 进行一些明智的重构也可以加快速度。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-12T21:01:47.883

为 CRUD 操作使用存储过程可能是大材小用，但这将取决于使用的工具和您自己的偏好（或要求）。我更喜欢内联 SQL，但我确保使用参数化查询来防止 SQL 注入攻击。我保留了这部[xkcd 漫画](http://xkcd.com/327/)的印刷品，以提醒您如果不小心可能会出现什么问题。

当您处理多组数据以返回单组数据时，存储过程可以带来真正的性能优势。在存储过程中处理数据集通常比通过线路发送它们以在客户端处理更有效。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-13T14:51:53.210

意识到这个问题有点离题，但是如果您使用大量存储过程，请确保有一种一致的方式将它们置于某种源代码控制（例如，颠覆或 git）之下，并且能够将更新从您的开发系统迁移到测试系统再到生产系统。

当这是手工完成时，无法轻松审核代码在哪里，这很快就会变成一场噩梦。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-12T20:34:57.450

存储过程非常适合经常运行 SQL 代码的情况，因为数据库将其存储在内存中。如果您在存储过程之外重复运行相同的代码，您可能会因为数据库一遍又一遍地重新解析相同的代码而导致性能下降。

我通常将代码称为存储过程或 SqlCommand (.NET) 对象，并根据需要多次执行。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-12T21:03:08.223

是的，它们大部分时间都更快。SQL 组合也是一个巨大的性能调优领域。如果我正在做一个后台类型的应用程序，我可能会跳过它们，但我肯定会使用它们，因为其他人也说过的所有原因......即安全性。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-13T16:03:53.990

恕我直言...

将“C_UD”操作限制为存储过程可以将数据完整性逻辑保持在一个位置。这也可以通过将“C_UD”操作限制到单个中间件层来完成。

可以向应用程序提供读取操作，以便它们可以仅连接所需的表/列。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-13T22:50:34.213

也可以使用存储过程来代替参数化查询（或临时查询），以获得其他一些优势：

*   如果您需要更正某些内容（排序顺序等），则无需重新编译您的应用程序
*   您可以拒绝访问该用户帐户的所有表，仅授予对存储过程的访问权限，并通过存储过程路由所有访问权限。这样，您可以对所有输入进行自定义验证，比表约束更灵活。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-10-24T16:44:32.727

减少网络流量——SP 通常比动态 SQL 更差。因为人们不会为每个选择创建一个新的 SP，如果你只需要一个列，你会被告知使用包含他们需要的列的 SP，而忽略其余的列。获得一个额外的专栏，并减少您刚刚离开的网络使用量。此外，当使用 SP 时，您往往会有很多客户端过滤。

缓存——MS-SQL 没有区别对待它们，因为 MS-SQL 2000 可能是 7，但我不记得了。

权限——这不是问题，因为我所做的几乎所有事情都是 Web 或有一些中间应用程序层来完成所有数据库访问。我使用的唯一可以直接访问数据库的软件是第 3 方产品，这些产品专为用户直接访问而设计，并且基于授予用户权限。是的，MS-SQL 权限安全模型糟透了！！！（还没有花时间在 2008 年）作为最后一部分，希望看到有多少人仍在进行直接客户端/服务器编程与 Web 和中间应用程序服务器编程的调查；如果他们正在做大型项目，为什么没有 ORM。

分离——人们会质疑你为什么将业务逻辑放在中间层之外。此外，如果您正在寻找分离数据处理代码的方法，则无需将其放入数据库即可。

编辑能力——您无需担心什么测试和版本控制？也只是客户端/服务器的问题，在网络世界中没有问题。

查找表——只有你能识别出使用它的SP，才会坚持使用版本控制系统、agent ransack或visual studio等工具来查找。

优化——您的 DBA 应该使用数据库工具来查找需要优化的查询。数据库可以告诉 DBA 哪些语句占用的时间和资源最多，他们可以从那里修复。对于复杂的 SQL 语句，如果简单的选择不担心，程序员应该被告知与 DBA 交谈。

SQL 注入攻击——SP 没有提供更好的保护。他们唯一得到认可的是，他们中的大多数人使用参数与动态 SQL 进行教学，大多数示例都忽略了参数。

# c# - 混淆或保护 .Net 程序集的最佳方法

> ID：59893
> 
> 赞同：31
> 
> 时间：2008-09-12T20:38:36.317
> 
> 标签：c#, .net, .net-2.0

我正在寻找一种技术或工具，我们可以使用它来混淆或以某种方式保护我们编译的 c# 代码。目标不是为了用户/数据安全，而是为了阻止我们软件中某些技术的逆向工程。

这不是用于网络，而是用于桌面应用程序。

那么，你知道有什么工具可以做这种事情吗？（他们不必是免费的）

如果有的话，它们会对性能产生什么样的影响？

在开发期间使用调试器时，这是否有任何负面影响？

我们记录现场问题的堆栈跟踪。混淆将如何影响这一点？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-09-12T21:56:48.470

[这是来自Visual Studio Marketplace](https://marketplace.visualstudio.com/search?term=.net%20obfuscators&target=VS&category=All%20categories&vsVersion=&sortBy=Relevance) 混淆器的一个很好的混淆器列表

*   [臂点](https://www.armdot.com/)
*   [加密混淆器](http://www.ssware.com/cryptoobfuscator/obfuscator-net.htm)
*   .NET 的[风度](http://www.wiseowl.com/products/products.aspx)
*   [部署 LX CodeVeil](http://xheo.com/products/code-protection)
*   [Dotfuscator](http://www.preemptive.com/) .NET 混淆器
*   [语义设计](http://www.semdesigns.com/products/obfuscators/csharpobfuscator.html)：C# 源代码混淆器
*   [智能装配](http://www.smartassembly.com)
*   [香料网](http://www.9rays.net/Products/Spices.Net/)
*   [Xenocode](http://www.xenocode.com/Products/Postbuild/) Postbuild 2006
*   [.NET 反应堆](http://www.eziriz.com/)

在混淆我的代码时，我没有观察到任何性能问题。如果您只是发送基于文本的堆栈跟踪，则在翻译方法名称时可能会遇到问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T21:02:21.067

有些工具也可以“反混淆”混淆的 DLL - 我建议将需要保护的部分转换为非托管组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T22:15:18.457

[http://xheo.com/products/code-protection](http://xheo.com/products/code-protection)

过去为我完成了这项工作。

* * *

## 回答 #4

> 赞同：-7
> 
> 时间：2008-09-12T22:01:31.843

你走这条路是在浪费时间。如果你有不想让任何人看到的代码，你需要把它关在门后。例如，仅使用 Web 服务接口在您自己的服务器上执行该代码。

混淆你的代码只会阻止最随意的人。由于电子游戏行业很久以前就开始倾斜，没有任何代码可以安全地被破解。

# bash - 如何从脚本本身中获取 Bash 脚本的源目录？

> ID：59895
> 
> 赞同：5658
> 
> 时间：2008-09-12T20:39:56.860
> 
> 标签：bash, directory

如何在该脚本中获取*Bash*[脚本](http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29)所在目录的路径？

 *我想使用 Bash 脚本作为另一个应用程序的启动器。我想将工作目录更改为 Bash 脚本所在的目录，这样我就可以对该目录中的文件进行操作，如下所示：

```
$ ./application 
```

* * *

## 回答 #1

> 赞同：7469
> 
> 时间：2008-10-29T08:36:45.740

```
#!/usr/bin/env bash

SCRIPT_DIR=$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd ) 
```

是一个有用的单行代码，无论从哪里调用它，它都会为您提供脚本的完整目录名称。

只要用于查找脚本的路径的最后一个组件不是符号链接（目录链接正常），它就可以工作。如果您还想解析脚本本身的任何链接，则需要一个多行解决方案：

```
#!/usr/bin/env bash

SOURCE=${BASH_SOURCE[0]}
while [ -h "$SOURCE" ]; do # resolve $SOURCE until the file is no longer a symlink
  DIR=$( cd -P "$( dirname "$SOURCE" )" >/dev/null 2>&1 && pwd )
  SOURCE=$(readlink "$SOURCE")
  [[ $SOURCE != /* ]] && SOURCE=$DIR/$SOURCE # if $SOURCE was a relative symlink, we need to resolve it relative to the path where the symlink file was located
done
DIR=$( cd -P "$( dirname "$SOURCE" )" >/dev/null 2>&1 && pwd ) 
```

最后一个将与别名、、、符号链接等的任意组合一起`source`使用`bash -c`。

**注意：**如果您`cd`在运行此代码段之前转到不同的目录，结果可能不正确！

此外，如果用户巧妙地覆盖 cd 以将输出重定向到 stderr（包括转义序列，例如在 Mac 上调用时） ，请注意[`$CDPATH`gotchas](http://bosker.wordpress.com/2012/02/12/bash-scripters-beware-of-the-cdpath/)和 stderr 输出副作用。在命令末尾`update_terminal_cwd >&2`添加将处理这两种可能性。`>/dev/null 2>&1``cd`

要了解它是如何工作的，请尝试运行这个更详细的表单：

```
#!/usr/bin/env bash

SOURCE=${BASH_SOURCE[0]}
while [ -h "$SOURCE" ]; do # resolve $SOURCE until the file is no longer a symlink
  TARGET=$(readlink "$SOURCE")
  if [[ $TARGET == /* ]]; then
    echo "SOURCE '$SOURCE' is an absolute symlink to '$TARGET'"
    SOURCE=$TARGET
  else
    DIR=$( dirname "$SOURCE" )
    echo "SOURCE '$SOURCE' is a relative symlink to '$TARGET' (relative to '$DIR')"
    SOURCE=$DIR/$TARGET # if $SOURCE was a relative symlink, we need to resolve it relative to the path where the symlink file was located
  fi
done
echo "SOURCE is '$SOURCE'"
RDIR=$( dirname "$SOURCE" )
DIR=$( cd -P "$( dirname "$SOURCE" )" >/dev/null 2>&1 && pwd )
if [ "$DIR" != "$RDIR" ]; then
  echo "DIR '$RDIR' resolves to '$DIR'"
fi
echo "DIR is '$DIR'" 
```

它会打印出如下内容：

```
SOURCE './scriptdir.sh' is a relative symlink to 'sym2/scriptdir.sh' (relative to '.')
SOURCE is './sym2/scriptdir.sh'
DIR './sym2' resolves to '/home/ubuntu/dotfiles/fo fo/real/real1/real2'
DIR is '/home/ubuntu/dotfiles/fo fo/real/real1/real2' 
```

* * *

## 回答 #2

> 赞同：1067
> 
> 时间：2008-09-12T20:49:28.600

使用`dirname "$0"`：

```
#!/bin/bash
echo "The script you are running has basename `basename "$0"`, dirname `dirname "$0"`"
echo "The present working directory is `pwd`" 
```

如果您不是从脚本所在的目录运行脚本，则单独使用`pwd`将不起作用。

```
[matt@server1 ~]$ pwd
/home/matt
[matt@server1 ~]$ ./test2.sh
The script you are running has basename test2.sh, dirname .
The present working directory is /home/matt
[matt@server1 ~]$ cd /tmp
[matt@server1 tmp]$ ~/test2.sh
The script you are running has basename test2.sh, dirname /home/matt
The present working directory is /tmp 
```

* * *

## 回答 #3

> 赞同：603
> 
> 时间：2009-09-26T20:38:02.093

该[`dirname`](https://linux.die.net/man/1/dirname)命令是最基本的，只需从`$0`（脚本名称）变量解析到文件名的路径：

```
dirname "$0" 
```

但是，正如**matt b**所指出的，返回的路径因脚本的调用方式而异。`pwd`不做这项工作，因为它只告诉你当前目录是什么，而不是脚本所在的目录。此外，如果执行脚本的符号链接，你将获得一个（可能是相对的）路径链接所在的位置，而不是实际的脚本。

其他一些人提到了该`readlink`命令，但最简单的是，您可以使用：

```
dirname "$(readlink -f "$0")" 
```

`readlink`将脚本路径解析为文件系统根目录的绝对路径。因此，任何包含单点或双点、波浪线和/或符号链接的路径都将被解析为完整路径。

这是一个演示每一个的脚本，`whatdir.sh`：

```
#!/bin/bash
echo "pwd: `pwd`"
echo "\$0: $0"
echo "basename: `basename $0`"
echo "dirname: `dirname $0`"
echo "dirname/readlink: $(dirname $(readlink -f $0))" 
```

使用相对路径在我的主目录中运行此脚本：

```
>>>$ ./whatdir.sh
pwd: /Users/phatblat
$0: ./whatdir.sh
basename: whatdir.sh
dirname: .
dirname/readlink: /Users/phatblat 
```

同样，但使用脚本的完整路径：

```
>>>$ /Users/phatblat/whatdir.sh
pwd: /Users/phatblat
$0: /Users/phatblat/whatdir.sh
basename: whatdir.sh
dirname: /Users/phatblat
dirname/readlink: /Users/phatblat 
```

现在更改目录：

```
>>>$ cd /tmp
>>>$ ~/whatdir.sh
pwd: /tmp
$0: /Users/phatblat/whatdir.sh
basename: whatdir.sh
dirname: /Users/phatblat
dirname/readlink: /Users/phatblat 
```

最后使用符号链接执行脚本：

```
>>>$ ln -s ~/whatdir.sh whatdirlink.sh
>>>$ ./whatdirlink.sh
pwd: /tmp
$0: ./whatdirlink.sh
basename: whatdirlink.sh
dirname: .
dirname/readlink: /Users/phatblat 
```

* * *

## 回答 #4

> 赞同：195
> 
> 时间：2008-10-07T16:12:14.120

```
pushd . > /dev/null
SCRIPT_PATH="${BASH_SOURCE[0]}"
if ([ -h "${SCRIPT_PATH}" ]); then
  while([ -h "${SCRIPT_PATH}" ]); do cd "$(dirname "$SCRIPT_PATH")";
  SCRIPT_PATH=$(readlink "${SCRIPT_PATH}"); done
fi
cd "$(dirname ${SCRIPT_PATH})" > /dev/null
SCRIPT_PATH=$(pwd);
popd  > /dev/null 
```

它适用于所有版本，包括

*   通过多深度软链接调用时，
*   当文件它
*   当命令“ `source`”又名`.`（点）运算符调用脚本时。
*   `$0`当从调用者修改arg 时。
*   `"./script"`
*   `"/full/path/to/script"`
*   `"/some/path/../../another/path/script"`
*   `"./some/folder/script"`

或者，如果 Bash 脚本本身是一个**相对符号链接**，您*希望*遵循它并返回链接到脚本的完整路径：

```
pushd . > /dev/null
SCRIPT_PATH="${BASH_SOURCE[0]}";
if ([ -h "${SCRIPT_PATH}" ]) then
  while([ -h "${SCRIPT_PATH}" ]) do cd "$(dirname "$SCRIPT_PATH")"; SCRIPT_PATH=`readlink "${SCRIPT_PATH}"`; done
fi
cd "$(dirname ${SCRIPT_PATH})" > /dev/null
SCRIPT_PATH=$(pwd);
popd  > /dev/null 
```

`SCRIPT_PATH`以完整路径给出，无论它如何调用。

只需确保在脚本开始时找到它。

* * *

## 回答 #5

> 赞同：125
> 
> 时间：2008-09-12T20:50:55.930

您可以使用`$BASH_SOURCE`：

```
#!/bin/bash

scriptdir=`dirname "$BASH_SOURCE"` 
```

请注意，您需要使用`#!/bin/bash`而不是`#!/bin/sh`因为它是 Bash 扩展。

* * *

## 回答 #6

> 赞同：123
> 
> 时间：2008-12-03T12:57:40.373

简短的回答：

```
`dirname $0` 
```

或（[最好](http://mywiki.wooledge.org/BashFAQ/082)）：

```
$(dirname "$0") 
```

* * *

## 回答 #7

> 赞同：96
> 
> 时间：2018-11-07T04:30:59.150

Here is an easy-to-remember script:

```
DIR=$(dirname "${BASH_SOURCE[0]}")   # Get the directory name
DIR=$(realpath "${DIR}")    # Resolve its full path if need be 
```

* * *

## 回答 #8

> 赞同：94
> 
> 时间：2016-02-12T23:40:21.017

This should do it:

```
DIR="$(dirname "$(realpath "$0")")" 
```

This works with symlinks and spaces in path.

Please see the man pages for `dirname` and `realpath`.

Please add a comment on how to support MacOS. I'm sorry I can verify it.

* * *

## 回答 #9

> 赞同：73
> 
> 时间：2008-09-15T19:55:06.053

`pwd`可用于查找当前工作目录，以及`dirname`查找特定文件的目录（运行的命令 is `$0`，因此`dirname $0`应该为您提供当前脚本的目录）。

但是，`dirname`准确给出文件名的目录部分，这很可能与当前工作目录相关。如果您的脚本由于某种原因需要更改目录，则输出`dirname`变得毫无意义。

我建议如下：

```
#!/bin/bash

reldir=`dirname $0`
cd $reldir
directory=`pwd`

echo "Directory is $directory" 
```

这样，您将获得一个绝对目录，而不是相对目录。

由于脚本将在单独的 Bash 实例中运行，因此无需在之后恢复工作目录，但如果您出于某种原因确实想在脚本中改回，您可以轻松地将值分配给`pwd`变量在更改目录之前，以备将来使用。

虽然只是

```
cd `dirname $0` 
```

解决了问题中的特定场景，我发现绝对路径更普遍更有用。

* * *

## 回答 #10

> 赞同：42
> 
> 时间：2008-09-13T01:07:11.867

我认为这并不像其他人所说的那么容易。 `pwd`不起作用，因为当前目录不一定是脚本所在的目录。 `$0`也不总是有信息。考虑以下三种调用脚本的方法：

```
./script

/usr/bin/script

script 
```

第一种和第三种方式`$0`没有完整的路径信息。在第二个和第三个，`pwd`不起作用。以第三种方式获取目录的唯一方法是遍历路径并找到具有正确匹配的文件。基本上，代码必须重做操作系统所做的事情。

执行您所要求的一种方法是对`/usr/share`目录中的数据进行硬编码，并通过其完整路径引用它。无论如何，数据不应该在`/usr/bin`目录中，所以这可能是要做的事情。

* * *

## 回答 #11

> 赞同：42
> 
> 时间：2010-10-07T17:34:23.570

```
SCRIPT_DIR=$( cd ${0%/*} && pwd -P ) 
```

* * *

## 回答 #12

> 赞同：39
> 
> 时间：2011-07-27T07:40:31.753

```
$(dirname "$(readlink -f "$BASH_SOURCE")") 
```

* * *

## 回答 #13

> 赞同：38
> 
> 时间：2010-12-30T07:20:59.243

[这将获取Mac OS X v10.6.6](https://en.wikipedia.org/wiki/Mac_OS_X_Snow_Leopard) (Snow Leopard)上的当前工作目录：

```
DIR=$(cd "$(dirname "$0")"; pwd) 
```

* * *

## 回答 #14

> 赞同：29
> 
> 时间：2008-09-16T19:55:33.953

这是特定于 Linux 的，但您可以使用：

```
SELF=$(readlink /proc/$$/fd/255) 
```

* * *

## 回答 #15

> 赞同：25
> 
> 时间：2013-03-06T19:07:19.720

这是一个符合 POSIX 的单行：

```
SCRIPT_PATH=`dirname "$0"`; SCRIPT_PATH=`eval "cd \"$SCRIPT_PATH\" && pwd"`

# test
echo $SCRIPT_PATH 
```

* * *

## 回答 #16

> 赞同：24
> 
> 时间：2019-06-20T22:08:51.397

The shortest and most elegant way to do this is:

```
#!/bin/bash
DIRECTORY=$(cd `dirname $0` && pwd)
echo $DIRECTORY 
```

This would work on all platforms and is super clean.

More details can be found in "[Which directory is that bash script in?](https://www.electrictoolbox.com/bash-script-directory/)".

* * *

## 回答 #17

> 赞同：20
> 
> 时间：2008-09-13T01:28:47.010

```
#!/bin/sh
PRG="$0"

# need this for relative symlinks
while [ -h "$PRG" ] ; do
   PRG=`readlink "$PRG"`
done

scriptdir=`dirname "$PRG"` 
```

* * *

## 回答 #18

> 赞同：19
> 
> 时间：2010-09-09T07:19:22.913

我尝试了所有这些，但都没有奏效。一个非常接近，但它有一个小虫子把它弄坏了；他们忘记将路径用引号引起来。

还有很多人认为你是从 shell 运行脚本，所以他们忘记了当你打开一个新脚本时，它默认为你的家。

试试这个目录的大小：

```
/var/No one/Thought/About Spaces Being/In a Directory/Name/And Here's your file.text 
```

无论您如何或在何处运行它，这都是正确的：

```
#!/bin/bash
echo "pwd: `pwd`"
echo "\$0: $0"
echo "basename: `basename "$0"`"
echo "dirname: `dirname "$0"`" 
```

所以为了让它真正有用，这里是如何切换到运行脚本的目录：

```
cd "`dirname "$0"`" 
```

* * *

## 回答 #19

> 赞同：19
> 
> 时间：2016-02-19T20:30:08.713

Here is the simple, correct way:

```
actual_path=$(readlink -f "${BASH_SOURCE[0]}")
script_dir=$(dirname "$actual_path") 
```

Explanation:

*   **`${BASH_SOURCE[0]}`** - the full path to the script. The value of this will be correct even when the script is being sourced, e.g. `source <(echo 'echo $0')` prints **bash**, while replacing it with `${BASH_SOURCE[0]}` will print the full path of the script. (Of course, this assumes you're OK taking a dependency on Bash.)

*   **`readlink -f`** - Recursively resolves any symlinks in the specified path. This is a GNU extension, and not available on (for example) BSD systems. If you're running a Mac, you can use Homebrew to install GNU `coreutils` and supplant this with **`greadlink -f`**.

*   And of course **`dirname`** gets the parent directory of the path.

* * *

## 回答 #20

> 赞同：18
> 
> 时间：2010-04-13T22:12:31.037

[这是对 e-satis 和 3bcdnlklvc04a 在他们的回答](https://stackoverflow.com/questions/59895/can-a-bash-script-tell-what-directory-its-in/179231#179231 "他们的回答")中指出的解决方案的轻微修改：

```
SCRIPT_DIR=''
pushd "$(dirname "$(readlink -f "$BASH_SOURCE")")" > /dev/null && {
    SCRIPT_DIR="$PWD"
    popd > /dev/null
} 
```

这应该在他们列出的所有情况下仍然有效。

这将防止`popd`发生故障后`pushd`。感谢 konsolebox。

* * *

## 回答 #21

> 赞同：17
> 
> 时间：2012-11-21T03:57:55.027

我会使用这样的东西：

```
# Retrieve the full pathname of the called script
scriptPath=$(which $0)

# Check whether the path is a link or not
if [ -L $scriptPath ]; then

    # It is a link then retrieve the target path and get the directory name
    sourceDir=$(dirname $(readlink -f $scriptPath))

else

    # Otherwise just get the directory name of the script path
    sourceDir=$(dirname $scriptPath)

fi 
```

* * *

## 回答 #22

> 赞同：17
> 
> 时间：2014-05-28T07:16:09.843

For systems having GNU coreutils `readlink` (for example, Linux):

```
$(readlink -f "$(dirname "$0")") 
```

There's no need to use `BASH_SOURCE` when `$0` contains the script filename.

* * *

## 回答 #23

> 赞同：16
> 
> 时间：2012-02-06T10:43:18.737

尝试使用：

```
real=$(realpath "$(dirname "$0")") 
```

* * *

## 回答 #24

> 赞同：14
> 
> 时间：2011-09-16T19:05:51.450

[`$_`](http://www.gnu.org/s/bash/manual/bash.html#Environment)值得一提的是`$0`. 如果您从 Bash 运行脚本，则接受的答案可以缩短为：

```
DIR="$( dirname "$_" )" 
```

请注意，这必须是脚本中的第一条语句。

* * *

## 回答 #25

> 赞同：14
> 
> 时间：2020-02-10T19:46:22.947

## Summary:

```
FULL_PATH_TO_SCRIPT="$(realpath "${BASH_SOURCE[-1]}")"

# OR, if you do NOT need it to work for **sourced** scripts too:
# FULL_PATH_TO_SCRIPT="$(realpath "$0")"

# OR, depending on which path you want, in case of nested `source` calls
# FULL_PATH_TO_SCRIPT="$(realpath "${BASH_SOURCE[0]}")"

# OR, add `-s` to NOT expand symlinks in the path:
# FULL_PATH_TO_SCRIPT="$(realpath -s "${BASH_SOURCE[-1]}")"

SCRIPT_DIRECTORY="$(dirname "$FULL_PATH_TO_SCRIPT")"
SCRIPT_FILENAME="$(basename "$FULL_PATH_TO_SCRIPT")" 
```

## Details:

## How to obtain the *full file path*, *full directory*, and *base filename* of any script being *run* OR *sourced*...

...even when the called script is called from within another bash function!

For many cases, all you need to acquire is the full path to the script you just called. This can be easily accomplished using `realpath`. Note that `realpath` is part of **GNU coreutils**. If you don't have it already installed (it comes default on Ubuntu), you can install it with `sudo apt update && sudo apt install coreutils`.

**get_script_path.sh** (for the latest version of this script, see [get_script_path.sh](https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world/blob/master/bash/get_script_path.sh) in my [eRCaGuy_hello_world](https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world) repo):

```
#!/bin/bash

# A. Obtain the full path, and expand (walk down) symbolic links
# A.1\. `"$0"` works only if the file is **run**, but NOT if it is **sourced**.
# FULL_PATH_TO_SCRIPT="$(realpath "$0")"
# A.2\. `"${BASH_SOURCE[-1]}"` works whether the file is sourced OR run, and even
# if the script is called from within another bash function!
# NB: if `"${BASH_SOURCE[-1]}"` doesn't give you quite what you want, use
# `"${BASH_SOURCE[0]}"` instead in order to get the first element from the array.
FULL_PATH_TO_SCRIPT="$(realpath "${BASH_SOURCE[-1]}")"
# B.1\. `"$0"` works only if the file is **run**, but NOT if it is **sourced**.
# FULL_PATH_TO_SCRIPT_KEEP_SYMLINKS="$(realpath -s "$0")"
# B.2\. `"${BASH_SOURCE[-1]}"` works whether the file is sourced OR run, and even
# if the script is called from within another bash function!
# NB: if `"${BASH_SOURCE[-1]}"` doesn't give you quite what you want, use
# `"${BASH_SOURCE[0]}"` instead in order to get the first element from the array.
FULL_PATH_TO_SCRIPT_KEEP_SYMLINKS="$(realpath -s "${BASH_SOURCE[-1]}")"

# You can then also get the full path to the directory, and the base
# filename, like this:
SCRIPT_DIRECTORY="$(dirname "$FULL_PATH_TO_SCRIPT")"
SCRIPT_FILENAME="$(basename "$FULL_PATH_TO_SCRIPT")"

# Now print it all out
echo "FULL_PATH_TO_SCRIPT = \"$FULL_PATH_TO_SCRIPT\""
echo "SCRIPT_DIRECTORY    = \"$SCRIPT_DIRECTORY\""
echo "SCRIPT_FILENAME     = \"$SCRIPT_FILENAME\"" 
```

**IMPORTANT note on *nested `source` calls*:** if `"${BASH_SOURCE[-1]}"` above doesn't give you quite what you want, try using `"${BASH_SOURCE[0]}"` instead. The first (`0`) index gives you the first entry in the array, and the last (`-1`) index gives you the last last entry in the array. Depending on what it is you're after, you may actually want the first entry. I discovered this to be the case when I sourced `~/.bashrc` with `. ~/.bashrc`, which sourced `~/.bash_aliases` with `. ~/.bash_aliases`, and I wanted the `realpath` (with expanded symlinks) to the `~/.bash_aliases` file, NOT to the `~/.bashrc` file. Since these are *nested* `source` calls, using `"${BASH_SOURCE[0]}"` gave me what I wanted: the expanded path to `~/.bash_aliases`! Using `"${BASH_SOURCE[-1]}"`, however, gave me what I did *not* want: the expanded path to `~/.bashrc`.

**Example command and output:**

1.  *Running* the script:

    ```
    ~/GS/dev/eRCaGuy_hello_world/bash$ ./get_script_path.sh 
    FULL_PATH_TO_SCRIPT = "/home/gabriel/GS/dev/eRCaGuy_hello_world/bash/get_script_path.sh"
    SCRIPT_DIRECTORY    = "/home/gabriel/GS/dev/eRCaGuy_hello_world/bash"
    SCRIPT_FILENAME     = "get_script_path.sh" 
    ```

2.  *Sourcing* the script with `. get_script_path.sh` or `source get_script_path.sh` (the result is the exact same as above because I used `"${BASH_SOURCE[-1]}"` in the script instead of `"$0"`):

    ```
    ~/GS/dev/eRCaGuy_hello_world/bash$ . get_script_path.sh 
    FULL_PATH_TO_SCRIPT = "/home/gabriel/GS/dev/eRCaGuy_hello_world/bash/get_script_path.sh"
    SCRIPT_DIRECTORY    = "/home/gabriel/GS/dev/eRCaGuy_hello_world/bash"
    SCRIPT_FILENAME     = "get_script_path.sh" 
    ```

If you use `"$0"` in the script instead of `"${BASH_SOURCE[-1]}"`, you'll get the same output as above when *running* the script, but this *undesired* output instead when *sourcing* the script:

```
~/GS/dev/eRCaGuy_hello_world/bash$ . get_script_path.sh 
FULL_PATH_TO_SCRIPT               = "/bin/bash"
SCRIPT_DIRECTORY                  = "/bin"
SCRIPT_FILENAME                   = "bash" 
```

And, apparently if you use `"$BASH_SOURCE"` instead of `"${BASH_SOURCE[-1]}"`, it will *not* work if the script is called from within another bash function. So, using `"${BASH_SOURCE[-1]}"` is therefore the best way to do it, as it solves both of these problems! See the references below.

Note that `realpath` also successfully walks down symbolic links to determine and point to their targets rather than pointing to the symbolic link. If you do NOT want this behavior (sometimes I don't), then add `-s` to the `realpath` command above, making that line look like this instead:

```
# Obtain the full path, but do NOT expand (walk down) symbolic links; in
# other words: **keep** the symlinks as part of the path!
FULL_PATH_TO_SCRIPT="$(realpath -s "${BASH_SOURCE[-1]}")" 
```

This way, symbolic links are NOT expanded. Rather, they are left as-is, as symbolic links in the full path.

The code above is now part of my [eRCaGuy_hello_world](https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world) repo in this file here: [bash/get_script_path.sh](https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world/blob/master/bash/get_script_path.sh). Reference and run this file for full examples both with and withOUT symlinks in the paths. See the bottom of the file for example output in both cases.

## References:

1.  [How to retrieve absolute path given relative](https://stackoverflow.com/a/14892459/4561887)
2.  taught me about the `BASH_SOURCE` variable: [Unix & Linux: determining path to sourced shell script](https://unix.stackexchange.com/a/4653/114401)
3.  taught me that `BASH_SOURCE` is actually an array, and we want the last element from it for it to work as expected inside a function (hence why I used `"${BASH_SOURCE[-1]}"` in my code here): [Unix & Linux: determining path to sourced shell script](https://unix.stackexchange.com/a/153061/114401)
4.  `man bash` --> search for `BASH_SOURCE`:

    > **`BASH_SOURCE`**
    > 
    > An array variable whose members are the source filenames where the corresponding shell function names in the `FUNCNAME` array variable are defined. The shell function `${FUNCNAME[$i]}` is defined in the file `${BASH_SOURCE[$i]}` and called from `${BASH_SOURCE[$i+1]}`.

## See also:

1.  [my answer] [Unix & Linux: determining path to sourced shell script](https://unix.stackexchange.com/a/692485/114401)

* * *

## 回答 #26

> 赞同：13
> 
> 时间：2008-10-14T16:39:03.097

这适用于 Bash 3.2：

```
path="$( dirname "$( which "$0" )" )" 
```

如果你有一个`~/bin`目录在你的`$PATH`，你 `A`在这个目录里面。它来源脚本`~/bin/lib/B`。您知道包含的脚本在`lib`子目录中相对于原始脚本的位置，但不知道它相对于用户当前目录的位置。

这是通过以下（内部`A`）解决的：

```
source "$( dirname "$( which "$0" )" )/lib/B" 
```

用户在哪里或他/她如何调用脚本并不重要。这将始终有效。

* * *

## 回答 #27

> 赞同：13
> 
> 时间：2018-03-09T12:56:45.277

These are short ways to get script information:

Folders and files:

```
 Script: "/tmp/src dir/test.sh"
    Calling folder: "/tmp/src dir/other" 
```

Using these commands:

```
 echo Script-Dir : `dirname "$(realpath $0)"`
    echo Script-Dir : $( cd ${0%/*} && pwd -P )
    echo Script-Dir : $(dirname "$(readlink -f "$0")")
    echo
    echo Script-Name : `basename "$(realpath $0)"`
    echo Script-Name : `basename $0`
    echo
    echo Script-Dir-Relative : `dirname "$BASH_SOURCE"`
    echo Script-Dir-Relative : `dirname $0`
    echo
    echo Calling-Dir : `pwd` 
```

And I got this output:

```
 Script-Dir : /tmp/src dir
     Script-Dir : /tmp/src dir
     Script-Dir : /tmp/src dir

     Script-Name : test.sh
     Script-Name : test.sh

     Script-Dir-Relative : ..
     Script-Dir-Relative : ..

     Calling-Dir : /tmp/src dir/other 
```

Also see: [https://pastebin.com/J8KjxrPF](https://pastebin.com/J8KjxrPF)

* * *

## 回答 #28

> 赞同：10
> 
> 时间：2013-04-21T13:40:41.247

我比较了许多给出的答案，并提出了一些更紧凑的解决方案。这些似乎可以处理由您最喜欢的组合引起的所有疯狂边缘情况：

*   绝对路径或相对路径
*   文件和目录软链接
*   调用为`script`, `bash script`, `bash -c script`, `source script`, 或`. script`
*   目录和/或文件名中的空格、制表符、换行符、Unicode 等
*   以连字符开头的文件名

如果您从 Linux 运行，似乎使用`proc`句柄是找到当前运行脚本的完全解析源的最佳解决方案（在交互式会话中，链接指向相应的`/dev/pts/X`）：

```
resolved="$(readlink /proc/$$/fd/255 && echo X)" && resolved="${resolved%$'\nX'}" 
```

这有点难看，但修复程序紧凑且易于理解。我们不仅仅使用 bash 原语，但我对此表示同意，因为这[`readlink`](https://linux.die.net/man/1/readlink)大大简化了任务。将`echo X`一个添加`X`到变量字符串的末尾，这样文件名中的任何尾随空格都不会被吃掉，并且`${VAR%X}`行尾的参数替换去掉了`X`. 因为`readlink`添加了自己的换行符（如果不是我们之前的诡计，通常会在命令替换中被吃掉），我们也必须摆脱它。使用引用方案最容易做到这一点`$''`，它允许我们使用转义序列，例如`\n`表示换行符（这也是您可以轻松制作名称不正确的目录和文件的方法）。

以上内容应满足您在 Linux 上查找当前正在运行的脚本的需求，但如果您没有可用的`proc`文件系统，或者您正在尝试查找其他文件的完全解析路径，那么您可能会发现下面的代码很有帮助。这只是对上述单线的轻微修改。如果您正在使用奇怪的目录/文件名，请检查两者的输出并提供`ls`信息`readlink`，`ls`输出“简化”路径，代替`?`换行符之类的东西。

```
absolute_path=$(readlink -e -- "${BASH_SOURCE[0]}" && echo x) && absolute_path=${absolute_path%?x}
dir=$(dirname -- "$absolute_path" && echo x) && dir=${dir%?x}
file=$(basename -- "$absolute_path" && echo x) && file=${file%?x}

ls -l -- "$dir/$file"
printf '$absolute_path: "%s"\n' "$absolute_path" 
```

* * *

## 回答 #29

> 赞同：9
> 
> 时间：2013-11-28T12:05:56.390

Try the following cross-compatible solution:

```
CWD="$(cd -P -- "$(dirname -- "${BASH_SOURCE[0]}")" && pwd -P)" 
```

As the commands such as `realpath` or `readlink` could be not available (depending on the operating system).

Note: In Bash, it's recommended to use `${BASH_SOURCE[0]}` instead of `$0`, otherwise path can break when sourcing the file (`source`/`.`).

Alternatively you can try the following function in Bash:

```
realpath () {
  [[ $1 = /* ]] && echo "$1" || echo "$PWD/${1#./}"
} 
```

This function takes one argument. If argument has already absolute path, print it as it is, otherwise print `$PWD` variable + filename argument (without `./` prefix).

Related:

*   *[How can I set the current working directory to the directory of the script in Bash?](https://stackoverflow.com/questions/3349105/how-to-set-current-working-directory-to-the-directory-of-the-script)*
*   *[Bash script absolute path with OS X](https://stackoverflow.com/questions/3572030/bash-script-absolute-path-with-osx)*
*   *[Reliable way for a Bash script to get the full path to itself](https://stackoverflow.com/questions/4774054/reliable-way-for-a-bash-script-to-get-the-full-path-to-itself/20265654#20265654)*

* * *

## 回答 #30

> 赞同：9
> 
> 时间：2013-12-21T17:47:37.047

I believe I've got this one. I'm late to the party, but I think some will appreciate it being here if they come across this thread. The comments should explain:

```
#!/bin/sh # dash bash ksh # !zsh (issues). G. Nixon, 12/2013\. Public domain.

## 'linkread' or 'fullpath' or (you choose) is a little tool to recursively
## dereference symbolic links (ala 'readlink') until the originating file
## is found. This is effectively the same function provided in stdlib.h as
## 'realpath' and on the command line in GNU 'readlink -f'.

## Neither of these tools, however, are particularly accessible on the many
## systems that do not have the GNU implementation of readlink, nor ship
## with a system compiler (not to mention the requisite knowledge of C).

## This script is written with portability and (to the extent possible, speed)
## in mind, hence the use of printf for echo and case statements where they
## can be substituded for test, though I've had to scale back a bit on that.

## It is (to the best of my knowledge) written in standard POSIX shell, and
## has been tested with bash-as-bin-sh, dash, and ksh93\. zsh seems to have
## issues with it, though I'm not sure why; so probably best to avoid for now.

## Particularly useful (in fact, the reason I wrote this) is the fact that
## it can be used within a shell script to find the path of the script itself.
## (I am sure the shell knows this already; but most likely for the sake of
## security it is not made readily available. The implementation of "$0"
## specificies that the $0 must be the location of **last** symbolic link in
## a chain, or wherever it resides in the path.) This can be used for some
## ...interesting things, like self-duplicating and self-modifiying scripts.

## Currently supported are three errors: whether the file specified exists
## (ala ENOENT), whether its target exists/is accessible; and the special
## case of when a sybolic link references itself "foo -> foo": a common error
## for beginners, since 'ln' does not produce an error if the order of link
## and target are reversed on the command line. (See POSIX signal ELOOP.)

## It would probably be rather simple to write to use this as a basis for
## a pure shell implementation of the 'symlinks' util included with Linux.

## As an aside, the amount of code below **completely** belies the amount
## effort it took to get this right -- but I guess that's coding for you.

##===-------------------------------------------------------------------===##

for argv; do :; done # Last parameter on command line, for options parsing.

## Error messages. Use functions so that we can sub in when the error occurs.

recurses(){ printf "Self-referential:\n\t$argv ->\n\t$argv\n" ;}
dangling(){ printf "Broken symlink:\n\t$argv ->\n\t"$(readlink "$argv")"\n" ;}
errnoent(){ printf "No such file: "$@"\n" ;} # Borrow a horrible signal name.

# Probably best not to install as 'pathfull', if you can avoid it.

pathfull(){ cd "$(dirname "$@")"; link="$(readlink "$(basename "$@")")"

## 'test and 'ls' report different status for bad symlinks, so we use this.

 if [ ! -e "$@" ]; then if $(ls -d "$@" 2>/dev/null) 2>/dev/null;  then
    errnoent 1>&2; exit 1; elif [ ! -e "$@" -a "$link" = "$@" ];   then
    recurses 1>&2; exit 1; elif [ ! -e "$@" ] && [ ! -z "$link" ]; then
    dangling 1>&2; exit 1; fi
 fi

## Not a link, but there might be one in the path, so 'cd' and 'pwd'.

 if [ -z "$link" ]; then if [ "$(dirname "$@" | cut -c1)" = '/' ]; then
   printf "$@\n"; exit 0; else printf "$(pwd)/$(basename "$@")\n"; fi; exit 0
 fi

## Walk the symlinks back to the origin. Calls itself recursivly as needed.

 while [ "$link" ]; do
   cd "$(dirname "$link")"; newlink="$(readlink "$(basename "$link")")"
   case "$newlink" in
    "$link") dangling 1>&2 && exit 1                                       ;;
         '') printf "$(pwd)/$(basename "$link")\n"; exit 0                 ;;
          *) link="$newlink" && pathfull "$link"                           ;;
   esac
 done
 printf "$(pwd)/$(basename "$newlink")\n"
}

## Demo. Install somewhere deep in the filesystem, then symlink somewhere 
## else, symlink again (maybe with a different name) elsewhere, and link
## back into the directory you started in (or something.) The absolute path
## of the script will always be reported in the usage, along with "$0".

if [ -z "$argv" ]; then scriptname="$(pathfull "$0")"

# Yay ANSI l33t codes! Fancy.
 printf "\n\033[3mfrom/as: \033[4m$0\033[0m\n\n\033[1mUSAGE:\033[0m   "
 printf "\033[4m$scriptname\033[24m [ link | file | dir ]\n\n         "
 printf "Recursive readlink for the authoritative file, symlink after "
 printf "symlink.\n\n\n         \033[4m$scriptname\033[24m\n\n        "
 printf " From within an invocation of a script, locate the script's "
 printf "own file\n         (no matter where it has been linked or "
 printf "from where it is being called).\n\n"

else pathfull "$@"
fi 
```

* * *

## 回答 #31

> 赞同：8
> 
> 时间：2009-01-24T17:01:27.353

嗯，如果在路径中，[`basename`](https://linux.die.net/man/1/basename)并且[`dirname`](https://linux.die.net/man/1/dirname)只是不打算切断它并且走路径很难（如果父级没有导出路径怎么办？！）。

但是，shell 必须对其脚本有一个打开的句柄，而在 Bash 中，句柄是#255。

```
SELF=`readlink /proc/$$/fd/255` 
```

为我工作。

* * *

## 回答 #32

> 赞同：7
> 
> 时间：2013-10-08T14:24:13.443

在我看来，最好的紧凑型解决方案是：

```
"$( cd "$( echo "${BASH_SOURCE[0]%/*}" )"; pwd )" 
```

除了 Bash，不依赖任何东西。使用[`dirname`](https://linux.die.net/man/1/dirname),[`readlink`](https://linux.die.net/man/1/readlink)最终[`basename`](https://linux.die.net/man/1/basename)会导致兼容性问题，因此最好尽可能避免使用。

* * *

## 回答 #33

> 赞同：7
> 
> 时间：2019-08-26T15:01:25.073

You can do that just combining the script name (`$0`) with [`realpath`](https://linux.die.net/man/1/realpath) and/or [`dirname`](https://linux.die.net/man/1/dirname). It works for Bash and Shell.

```
#!/usr/bin/env bash

RELATIVE_PATH="${0}"
RELATIVE_DIR_PATH="$(dirname "${0}")"
FULL_DIR_PATH="$(realpath "${0}" | xargs dirname)"
FULL_PATH="$(realpath "${0}")"

echo "RELATIVE_PATH->${RELATIVE_PATH}<-"
echo "RELATIVE_DIR_PATH->${RELATIVE_DIR_PATH}<-"
echo "FULL_DIR_PATH->${FULL_DIR_PATH}<-"
echo "FULL_PATH->${FULL_PATH}<-" 
```

The output will be something like this:

```
# RELATIVE_PATH->./bin/startup.sh<-
# RELATIVE_DIR_PATH->./bin<-
# FULL_DIR_PATH->/opt/my_app/bin<-
# FULL_PATH->/opt/my_app/bin/startup.sh<- 
```

> $0 is the name of the script itself

*[4.4\. Special Variable Types](https://www.tldp.org/LDP/abs/html/othertypesv.html)*

An example: *[LozanoMatheus/get_script_paths.sh](https://gist.github.com/LozanoMatheus/da96b4e44b89b13ad4af10ac4602ad99)*

* * *

## 回答 #34

> 赞同：5
> 
> 时间：2010-09-22T23:22:34.757

这些其他答案都不适用于[Finder](https://en.wikipedia.org/wiki/Finder_(software))在[OS X](https://en.wikipedia.org/wiki/Mac_OS_X)中启动的 Bash 脚本。我最终使用：

```
SCRIPT_LOC="`ps -p $$ | sed /PID/d | sed s:.*/Network/:/Network/: |
sed s:.*/Volumes/:/Volumes/:`" 
```

它不漂亮，但它完成了工作。

* * *

## 回答 #35

> 赞同：5
> 
> 时间：2010-10-13T07:42:58.977

使用[readlink](https://linux.die.net/man/1/readlink)的组合来规范化名称（如果它是符号链接，则可以将其返回到其源）和[dirname](https://linux.die.net/man/1/dirname)来提取目录名称：

```
script="`readlink -f "${BASH_SOURCE[0]}"`"
dir="`dirname "$script"`" 
```

* * *

## 回答 #36

> 赞同：5
> 
> 时间：2017-04-10T21:49:15.017

This worked for me when the other answers here did not:

```
thisScriptPath=`realpath $0`
thisDirPath=`dirname $thisScriptPath`
echo $thisDirPath 
```

* * *

## 回答 #37

> 赞同：5
> 
> 时间：2019-10-25T16:32:24.617

The top response does not work in all cases...

As I had problems with the BASH_SOURCE with the included 'cd' approach on some very fresh and also on less fresh installed [Ubuntu 16.04](https://en.wikipedia.org/wiki/Ubuntu_version_history#Ubuntu_16.04_LTS_.28Xenial_Xerus.29) (Xenial Xerus) systems when invoking the shell script by means of "sh my_script.sh", I tried out something different that as of now seems to run quite smoothly for my purposes. The approach is a bit more compact in the script and is further much lesser cryptic feeling.

This alternate approach uses the external applications '[realpath](https://linux.die.net/man/1/realpath)' and '[dirname](https://linux.die.net/man/1/dirname)' from the coreutils package. (Okay, not anyone likes the overhead of invoking secondary processes - but when seeing the multi-line scripting for resolving the true object it won't be that bad either having it solve in a single binary usage.)

So let’s see one example of those alternate solution for the described task of querying the true absolute path to a certain file:

```
PATH_TO_SCRIPT=`realpath -s $0`
PATH_TO_SCRIPT_DIR=`dirname $PATH_TO_SCRIPT` 
```

But preferably you should use this evolved version to also support the use of paths with spaces (or maybe even some other special characters):

```
PATH_TO_SCRIPT=`realpath -s "$0"`
PATH_TO_SCRIPT_DIR=`dirname "$PATH_TO_SCRIPT"` 
```

Indeed, if you don’t need the value of the SCRIPT variable then you might be able to merge this two-liner into even a single line. But why really shall you spend the effort for this?

* * *

## 回答 #38

> 赞同：5
> 
> 时间：2021-04-15T08:48:07.263

None of the current solutions work if there are any newlines at the end of the directory name - They will be stripped by the command substitution. To work around this you can append a non-newline character inside the command substitution and then strip just that character off:

```
dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd && echo x)"
dir="${dir%x}" 
```

This protects against two very common situations: Accidents and sabotage. A script shouldn't fail in unpredictable ways just because someone, somewhere, did a `mkdir $'\n'`.

* * *

## 回答 #39

> 赞同：4
> 
> 时间：2009-04-14T16:00:20.273

这是我发现可靠地告诉的唯一方法：

```
SCRIPT_DIR=$(dirname $(cd "$(dirname "$BASH_SOURCE")"; pwd)) 
```

* * *

## 回答 #40

> 赞同：4
> 
> 时间：2019-05-17T12:09:27.027

I usually use:

```
dirname $(which $BASH_SOURCE) 
```

* * *

## 回答 #41

> 赞同：4
> 
> 时间：2021-06-20T13:11:28.417

This is, annoyingly, the only one-liner I've found that works on both Linux and macOS when the executable script is a symlink:

```
SCRIPT_DIR=$(python -c "import os; print(os.path.dirname(os.path.realpath('${BASH_SOURCE[0]}')))") 
```

or, similarly, using python3 pathlib module:

```
SCRIPT_DIR=$(python3 -c "from pathlib import Path; print(Path('${BASH_SOURCE[0]}').resolve().parent)") 
```

Tested on Linux and macOS and compared to other solutions in this gist: [https://gist.github.com/ptc-mrucci/61772387878ed53a6c717d51a21d9371](https://gist.github.com/ptc-mrucci/61772387878ed53a6c717d51a21d9371)

* * *

## 回答 #42

> 赞同：3
> 
> 时间：2017-02-04T08:56:21.853

`$0` is not a reliable way to get the current script path. For example, this is my `.xprofile`:

```
#!/bin/bash
echo "$0 $1 $2"
echo "${BASH_SOURCE[0]}"
# $dir/my_script.sh & 
```

> cd /tmp && ~/.xprofile && source ~/.xprofile

```
/home/puchuu/.xprofile
/home/puchuu/.xprofile
-bash
/home/puchuu/.xprofile 
```

So please use `BASH_SOURCE` instead.

* * *

## 回答 #43

> 赞同：3
> 
> 时间：2019-05-22T19:57:49.640

Here's a command that works under either Bash or zsh, and whether executed stand-alone or sourced:

```
[ -n "$ZSH_VERSION" ] && this_dir=$(dirname "${(%):-%x}") \
    || this_dir=$(dirname "${BASH_SOURCE[0]:-$0}") 
```

# How it works

## The zsh current file expansion: `${(%):-%x}`

`${(%):-%x}` in zsh expands to the path of the currently-executing file.

### The fallback substitution operator `:-`

You know already that `${...}` substitutes variables inside of strings. You might not know that certain operations are possible (in both [Bash](http://tldp.org/LDP/abs/html/parameter-substitution.html) and [zsh](http://zsh.sourceforge.net/Doc/Release/Expansion.html#Parameter-Expansion)) on the variables during substitution, like the fallback expansion operator `:-`:

```
% x=ok
% echo "${x}"
ok

% echo "${x:-fallback}"
ok

% x=
% echo "${x:-fallback}"
fallback

% y=yvalue
% echo "${x:-$y}"
yvalue 
```

### The `%x` prompt escape code

Next, we'll introduce prompt escape codes, a zsh-only feature. In zsh, `%x` will expand to the path of the file, but normally this is only when doing expansion for [prompt strings](http://zsh.sourceforge.net/Doc/Release/Prompt-Expansion.html#Shell-state). To enable those codes in our substitution, we can add a `(%)` flag before the variable name:

```
% cat apath/test.sh
fpath=%x
echo "${(%)fpath}"

% source apath/test.sh
apath/test.sh

% cd apath
% source test.sh
test.sh 
```

### An unlikely match: the percent escape and the fallback

What we have so far works, but it would be tidier to avoid creating the extra `fpath` variable. Instead of putting `%x` in `fpath`, we can use `:-` and put `%x` in the fallback string:

```
% cat test.sh
echo "${(%):-%x}"

% source test.sh
test.sh 
```

Note that we normally would put a variable name between `(%)` and `:-`, but we left it blank. The variable with a blank name can't be declared or set, so the fallback is always triggered.

### Finishing up: what about `print -P %x`?

Now we almost have the directory of our script. We could have used `print -P %x` to get the same file path with fewer hacks, but in our case, where we need to pass it as an argument to `dirname`, that would have required the overhead of a starting a new subshell:

```
% cat apath/test.sh
dirname "$(print -P %x)"  # $(...) runs a command in a new process
dirname "${(%):-%x}"

% source apath/test.sh
apath
apath 
```

It turns out that the hacky way is both more performant and succinct.

* * *

## 回答 #44

> 赞同：2
> 
> 时间：2014-08-31T22:10:46.977

This solution applies only to Bash. Note that the commonly supplied answer `${BASH_SOURCE[0]}` won't work if you try to find the path from within a function.

I've found this line to always work, regardless of whether the file is being sourced or run as a script.

```
dirname ${BASH_SOURCE[${#BASH_SOURCE[@]} - 1]} 
```

If you want to follow symlinks use [`readlink`](https://linux.die.net/man/1/readlink) on the path you get above, recursively or non-recursively.

Here's a script to try it out and compare it to other proposed solutions. Invoke it as `source test1/test2/test_script.sh` or `bash test1/test2/test_script.sh`.

```
#
# Location: test1/test2/test_script.sh
#
echo $0
echo $_
echo ${BASH_SOURCE}
echo ${BASH_SOURCE[${#BASH_SOURCE[@]} - 1]}

cur_file="${BASH_SOURCE[${#BASH_SOURCE[@]} - 1]}"
cur_dir="$(dirname "${cur_file}")"
source "${cur_dir}/func_def.sh"

function test_within_func_inside {
    echo ${BASH_SOURCE}
    echo ${BASH_SOURCE[${#BASH_SOURCE[@]} - 1]}
}

echo "Testing within function inside"
test_within_func_inside

echo "Testing within function outside"
test_within_func_outside

#
# Location: test1/test2/func_def.sh
#
function test_within_func_outside {
    echo ${BASH_SOURCE}
    echo ${BASH_SOURCE[${#BASH_SOURCE[@]} - 1]}
} 
```

The reason the one-liner works is explained by the use of the `BASH_SOURCE` environment variable and its associated `FUNCNAME`.

> BASH_SOURCE

> An array variable whose members are the source filenames where the corresponding shell function names in the FUNCNAME array variable are defined. The shell function ${FUNCNAME[$i]} is defined in the file ${BASH_SOURCE[$i]} and called from ${BASH_SOURCE[$i+1]}.

> FUNCNAME

> An array variable containing the names of all shell functions currently in the execution call stack. The element with index 0 is the name of any currently-executing shell function. The bottom-most element (the one with the highest index) is "main". This variable exists only when a shell function is executing. Assignments to FUNCNAME doesn't have any effect and return an error status. If FUNCNAME is unset, it loses its special properties, even if it is subsequently reset.

> This variable can be used with BASH_LINENO and BASH_SOURCE. Each element of FUNCNAME has corresponding elements in BASH_LINENO and BASH_SOURCE to describe the call stack. For instance, ${FUNCNAME[$i]} was called from the file ${BASH_SOURCE[$i+1]} at line number ${BASH_LINENO[$i]}. The caller builtin displays the current call stack using this information.

[Source: Bash manual]

* * *

## 回答 #45

> 赞同：2
> 
> 时间：2018-04-17T00:03:22.763

This is how I work it on my scripts:

```
pathvar="$( cd "$( dirname $0 )" && pwd )" 
```

This will tell you which directory the Launcher (current script) is being executed from.

* * *

## 回答 #46

> 赞同：2
> 
> 时间：2018-06-01T02:52:46.303

*If your Bash script is a symlink*, then this is the way to do it:

```
#!/usr/bin/env bash

dirn="$(dirname "$0")"
rl="$(readlink "$0")";
exec_dir="$(dirname $(dirname "$rl"))";
my_path="$dirn/$exec_dir";
X="$(cd $(dirname ${my_path}) && pwd)/$(basename ${my_path})" 
```

X is the directory that contains your Bash script (the original file, not the symlink). I swear to God this works, and it is the only way I know of doing this properly.

* * *

## 回答 #47

> 赞同：2
> 
> 时间：2019-10-08T12:37:16.200

### The following will return the current directory of the script

*   works if it's sourced, or not sourced
*   works if run in the current directory, or some other directory.
*   works if relative directories are used.
*   works with bash, not sure of other shells.

```
/tmp/a/b/c $ . ./test.sh
/tmp/a/b/c

/tmp/a/b/c $ . /tmp/a/b/c/test.sh
/tmp/a/b/c

/tmp/a/b/c $ ./test.sh
/tmp/a/b/c

/tmp/a/b/c $ /tmp/a/b/c/test.sh
/tmp/a/b/c

/tmp/a/b/c $ cd

~ $ . /tmp/a/b/c/test.sh
/tmp/a/b/c

~ $ . ../../tmp/a/b/c/test.sh
/tmp/a/b/c

~ $ /tmp/a/b/c/test.sh
/tmp/a/b/c

~ $ ../../tmp/a/b/c/test.sh
/tmp/a/b/c 
```

### test.sh

```
#!/usr/bin/env bash

# snagged from: https://stackoverflow.com/a/51264222/26510
function toAbsPath {
    local target
    target="$1"

    if [ "$target" == "." ]; then
        echo "$(pwd)"
    elif [ "$target" == ".." ]; then
        echo "$(dirname "$(pwd)")"
    else
        echo "$(cd "$(dirname "$1")"; pwd)/$(basename "$1")"
    fi
}

function getScriptDir(){
  local SOURCED
  local RESULT
  (return 0 2>/dev/null) && SOURCED=1 || SOURCED=0

  if [ "$SOURCED" == "1" ]
  then
    RESULT=$(dirname "$1")
  else
    RESULT="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
  fi
  toAbsPath "$RESULT"
}

SCRIPT_DIR=$(getScriptDir "$0")
echo "$SCRIPT_DIR" 
```

* * *

## 回答 #48

> 赞同：2
> 
> 时间：2019-12-26T08:34:40.640

Python was mentioned a few times. Here is the JavaScript (i.e., [Node.js](https://en.wikipedia.org/wiki/Node.js)) alternative:

```
baseDirRelative=$(dirname "$0")
baseDir=$(node -e "console.log(require('path').resolve('$baseDirRelative'))") # Get absolute path using Node.js

echo $baseDir 
```

* * *

## 回答 #49

> 赞同：2
> 
> 时间：2020-12-23T20:55:00.727

One advantage of this method is that it doesn't involve anything outside Bash itself and does not fork any subshell neither.

First, use pattern substitution to replace anything not starting with `/` (i.e., a relative path) with `$PWD/`. Since we use a substitution to *match the first character of `$0`*, we also have to append it back (`${0:0:1}` in the substitution).

Now we have a full path to the script; we can get the directory by removing the last `/` and anything the follows (i.e., the script name). That directory can then be used in `cd` or as a prefix to other paths relative to your script.

```
#!/bin/bash

BIN=${0/#[!\/]/"$PWD/${0:0:1}"}
DIR=${BIN%/*}

cd "$DIR" 
```

If your script may be sourced rather than executed, you can of course replace `$0` with `${BASH_SOURCE[0]}`, such as:

```
BIN=${BASH_SOURCE[0]/#[!\/]/"$PWD/${BASH_SOURCE[0]:0:1}"} 
```

This will work for executable scripts too. It's longer, but more polyvalent.

* * *

## 回答 #50

> 赞同：2
> 
> 时间：2021-01-20T03:20:25.963

I tried the followings with 3 different executions.

### `echo $(realpath $_)`

```
. application         # /correct/path/to/dir or /path/to/temporary_dir
bash application      # /path/to/bash
/PATH/TO/application  # /correct/path/to/dir 
```

### `echo $(realpath $(dirname $0))`

```
. application         # failed with `realpath: missing operand`
bash application      # /correct/path/to/dir
/PATH/TO/application  # /correct/path/to/dir 
```

### `echo $(realpath $BASH_SOURCE)`

`$BASH_SOURCE` is basically the same with `${BASH_SOURCE[0]}`.

```
. application         # /correct/path/to/dir
bash application      # /correct/path/to/dir
/PATH/TO/application  # /correct/path/to/dir 
```

Only `$(realpath $BASH_SOURCE)` seems to be reliable.

* * *

## 回答 #51

> 赞同：2
> 
> 时间：2021-04-18T13:32:21.303

Most answers either don't handle files which are symlinked via a relative path, aren't one-liners or don't handle BSD (Mac). A solution which does all three is:

```
HERE=$(cd "$(dirname "$BASH_SOURCE")"; cd -P "$(dirname "$(readlink "$BASH_SOURCE" || echo .)")"; pwd) 
```

First, cd to bash's conception of the script's directory. Then readlink the file to see if it is a symlink (relative or otherwise), and if so, cd to that directory. If not, cd to the current directory (necessary to keep things a one-liner). Then echo the current directory via `pwd`.

You could add `--` to the arguments of cd and readlink to avoid issues of directories named like options, but I don't bother for most purposes.

You can see the full explanation with illustrations here:

[https://www.binaryphile.com/bash/2020/01/12/determining-the-location-of-your-script-in-bash.html](https://www.binaryphile.com/bash/2020/01/12/determining-the-location-of-your-script-in-bash.html)

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2009-01-24T16:32:59.127

我通常这样做：

```
LIBDIR=$(dirname "$(readlink -f "$(type -P $0 || echo $0)")")
source $LIBDIR/lib.sh 
```

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2013-02-14T18:14:23.373

这是一个纯 Bash 解决方案

```
$ cat a.sh
BASENAME=${BASH_SOURCE/*\/}
DIRNAME=${BASH_SOURCE%$BASENAME}.
echo $DIRNAME

$ a.sh
/usr/local/bin/.

$ ./a.sh
./.

$ . a.sh
/usr/local/bin/.

$ /usr/local/bin/a.sh
/usr/local/bin/. 
```

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2013-11-26T21:10:31.463

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2019-03-26T07:50:18.640

The below stores the script's directory path in the `dir` variable.

(It also tries to support being executed under [Cygwin](https://en.wikipedia.org/wiki/Cygwin) in Windows.)

And at last it runs the `my-sample-app` executable with all arguments passed to this script using `"$@"`:

```
#!/usr/bin/env sh

dir=$(cd "${0%[/\\]*}" > /dev/null && pwd)

if [ -d /proc/cygdrive ]; then
    case "$(uname -s)" in
        CYGWIN*|MINGW32*|MSYS*|MINGW*)
            # We are under Windows, so translate path to Windows format.
            dir=$(cygpath -m "$dir");
            ;;
    esac
fi

# Runs the executable which is beside this script
"${dir}/my-sample-app" "$@" 
```

* * *

## 回答 #56

> 赞同：0
> 
> 时间：2020-06-15T20:35:48.657

I think the simplest answer is a parameter expansion of the original variable:

```
#!/usr/bin/env bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
echo "opt1; original answer: $DIR"
echo ''

echo "opt2; simple answer  : ${BASH_SOURCE[0]%/*}" 
```

It should produce output like:

```
$ /var/tmp/test.sh
opt1; original answer: /var/tmp

opt2; simple answer  : /var/tmp 
```

The variable/parameter expansion `${BASH_SOURCE[0]%/*}"` seems much easier to maintain.

* * *

## 回答 #57

> 赞同：-1
> 
> 时间：2009-11-29T11:44:13.250

```
function getScriptAbsoluteDir { # fold>>
    # @description used to get the script path
    # @param $1 the script $0 parameter
    local script_invoke_path="$1"
    local cwd=`pwd`

    # absolute path ? if so, the first character is a /
    if test "x${script_invoke_path:0:1}" = 'x/'
    then
        RESULT=`dirname "$script_invoke_path"`
    else
        RESULT=`dirname "$cwd/$script_invoke_path"`
    fi
} # <<fold 
```

* * *

## 回答 #58

> 赞同：-1
> 
> 时间：2013-06-09T15:35:27.027

我通常在我的脚本顶部包含以下内容，这在大多数情况下都有效：

```
[ "$(dirname $0)" = '.' ] && SOURCE_DIR=$(pwd) || SOURCE_DIR=$(dirname $0);
ls -l $0 | grep -q ^l && SOURCE_DIR=$(ls -l $0 | awk '{print $NF}'); 
```

第一行根据`pwd`if run from the current path 或[dirname](https://linux.die.net/man/1/dirname)如果从其他地方调用的值分配源。

第二行检查路径以查看它是否是符号链接，如果是，则将 SOURCE_DIR 更新为链接本身的位置。

那里可能有更好的解决方案，但这是我自己想出的最干净的解决方案。

* * *

## 回答 #59

> 赞同：-1
> 
> 时间：2013-10-03T07:35:55.767

尝试这样的事情：

```
function get_realpath() {

if [[ -f "$1" ]]
then
    # The file *must* exist
    if cd "$(echo "${1%/*}")" &>/dev/null
    then
        # The file *may* not be local.
        # The exception is ./file.ext
        # tTry 'cd .; cd -;' *works!*
        local tmppwd="$PWD"
        cd - &>/dev/null
    else
        # file *must* be local
        local tmppwd="$PWD"
    fi
else
    # The file *cannot* exist
    return 1 # Failure
fi

# Reassemble realpath
echo "$tmppwd"/"${1##*/}"
return 0 # Success

}

function get_dirname(){

local realpath="$(get_realpath "$1")"
if (( $? )) # True when non-zero.
then
    return $? # Failure
fi
echo "${realpath%/*}"
return 0 # Success

}

# Then from the top level:
get_dirname './script.sh'

# Or within a script:
get_dirname "$0"

# Can even test the outcome!
if (( $? )) # True when non-zero.
then
    exit 1 # Failure
fi 
```

这些功能和相关工具是我们产品的一部分，已免费提供给社区，可以在 GitHub 上以[realpath-lib 的](http://asymlabs.github.io/realpath-lib/)形式找到。它简单、干净、文档齐全（非常适合学习）、纯 Bash 并且没有依赖项。也适合跨平台使用。因此，对于上面的示例，您可以在脚本中简单地：

```
source '/path/to/realpath-lib'

get_dirname "$0"

if (( $? )) # True when non-zero.
then
    exit 1 # Failure
fi 
```

* * *

## 回答 #60

> 赞同：-1
> 
> 时间：2014-05-24T15:47:25.460

```
cur_dir=`old=\`pwd\`; cd \`dirname $0\`; echo \`pwd\`; cd $old;` 
```

* * *

## 回答 #61

> 赞同：-1
> 
> 时间：2014-07-03T04:58:44.697

No forks (besides subshell) and can handle "alien" pathname forms like those with newlines as some would claim:

```
IFS= read -rd '' DIR < <([[ $BASH_SOURCE != */* ]] || cd "${BASH_SOURCE%/*}/" >&- && echo -n "$PWD") 
```

* * *

## 回答 #62

> 赞同：-1
> 
> 时间：2015-10-09T08:16:09.547

The key part is that I am reducing the scope of the problem: I forbid indirect execution of the script via the path (as in `/bin/sh [script path relative to path component]`).

This can be detected because `$0` will be a relative path which does not resolve to any file relative to the current folder. I believe that direct execution using the `#!` mechanism always results in an absolute `$0`, including when the script is found on the path.

I also require that the pathname and any pathnames along a chain of symbolic links only contain a reasonable subset of characters, notably not `\n`, `>`, `*` or `?`. This is required for the parsing logic.

There are a few more implicit expectations which I will not go into (look at [this answer](https://stackoverflow.com/a/4794711/213180)), and I do not attempt to handle deliberate sabotage of `$0` (so consider any security implications). I expect this to work on almost any Unix-like system with a Bourne-like `/bin/sh`.

```
#!/bin/sh
(
    path="${0}"
    while test -n "${path}"; do
        # Make sure we have at least one slash and no leading dash.
        expr "${path}" : / > /dev/null || path="./${path}"
        # Filter out bad characters in the path name.
        expr "${path}" : ".*[*?<>\\]" > /dev/null && exit 1
        # Catch embedded new-lines and non-existing (or path-relative) files.
        # $0 should always be absolute when scripts are invoked through "#!".
        test "`ls -l -d "${path}" 2> /dev/null | wc -l`" -eq 1 || exit 1
        # Change to the folder containing the file to resolve relative links.
        folder=`expr "${path}" : "\(.*/\)[^/][^/]*/*$"` || exit 1
        path=`expr "x\`ls -l -d "${path}"\`" : "[^>]* -> \(.*\)"`
        cd "${folder}"
        # If the last path was not a link then we are in the target folder.
        test -n "${path}" || pwd
    done
) 
```

* * *

## 回答 #63

> 赞同：-1
> 
> 时间：2016-03-31T00:49:14.143

Look at the test at bottom with weird directory names.

To change the working directory to the one where the Bash script is located, you should try this simple, **tested** and verified with **shellcheck** solution:

```
#!/bin/bash --
cd "$(dirname "${0}")"/. || exit 2 
```

The test:

```
$ ls 
application
$ mkdir "$(printf "\1\2\3\4\5\6\7\10\11\12\13\14\15\16\17\20\21\22\23\24\25\26\27\30\31\32\33\34\35\36\37\40\41\42\43\44\45\46\47testdir" "")"
$ mv application *testdir
$ ln -s *testdir "$(printf "\1\2\3\4\5\6\7\10\11\12\13\14\15\16\17\20\21\22\23\24\25\26\27\30\31\32\33\34\35\36\37\40\41\42\43\44\45\46\47symlink" "")"
$ ls -lb
total 4
lrwxrwxrwx 1 jay stacko   46 Mar 30 20:44 \001\002\003\004\005\006\a\b\t\n\v\f\r\016\017\020\021\022\023\024\025\026\027\030\031\032\033\034\035\036\037\ !"#$%&'symlink -> \001\002\003\004\005\006\a\b\t\n\v\f\r\016\017\020\021\022\023\024\025\026\027\030\031\032\033\034\035\036\037\ !"#$%&'testdir
drwxr-xr-x 2 jay stacko 4096 Mar 30 20:44 \001\002\003\004\005\006\a\b\t\n\v\f\r\016\017\020\021\022\023\024\025\026\027\030\031\032\033\034\035\036\037\ !"#$%&'testdir
$ *testdir/application && printf "SUCCESS\n" ""
SUCCESS
$ *symlink/application && printf "SUCCESS\n" ""
SUCCESS 
```

* * *

## 回答 #64

> 赞同：-2
> 
> 时间：2016-10-24T11:45:41.723

Based on [this answer](https://stackoverflow.com/questions/59895/can-a-bash-script-tell-which-directory-it-is-stored-in/246128#246128), I suggest the clarified version that gets `SCRIPT_HOME` as the containing folder of any currently-running Bash script:

```
s=${BASH_SOURCE[0]} ; s=`dirname $s` ; SCRIPT_HOME=`cd $s ; pwd`
echo $SCRIPT_HOME 
```

* * *

## 回答 #65

> 赞同：-2
> 
> 时间：2019-08-15T05:53:26.790

I want to comment on the previous answer up there (*[How can I get the source directory of a Bash script from within the script itself?](https://stackoverflow.com/questions/59895/how-can-i-get-the-source-directory-of-a-bash-script-from-within-the-script-itsel/201915#201915)*), but don't have enough reputation to do that.

I found a solution for this two years ago on Apple's documentation site: [https://developer.apple.com/library/archive/documentation/OpenSource/Conceptual/ShellScripting/AdvancedTechniques/AdvancedTechniques.html](https://developer.apple.com/library/archive/documentation/OpenSource/Conceptual/ShellScripting/AdvancedTechniques/AdvancedTechniques.html). And I stuck to this method afterwards. It cannot handle soft link, but otherwise works pretty well for me. I'm posting it here for any who needs it and as a request for comment.

```
#!/bin/sh

# Get an absolute path for the poem.txt file.
POEM="$PWD/../poem.txt"

# Get an absolute path for the script file.
SCRIPT="$(which $0)"
if [ "x$(echo $SCRIPT | grep '^\/')" = "x" ] ; then
    SCRIPT="$PWD/$SCRIPT"
fi 
```

As shown by the code, after you get the absolute path of the script, then you can use the [`dirname`](https://linux.die.net/man/1/dirname) command to get the path of the directory.

* * *

## 回答 #66

> 赞同：-2
> 
> 时间：2019-08-27T00:31:07.953

This is what I crafted throughout the years to use as a header on my Bash scripts:

```
## BASE BRAIN - Get where you're from and who you are.
MYPID=$$
ORIGINAL_DIR="$(pwd)" # This is not a hot air balloon ride..
fa="$0" # First Assumption
ta= # Temporary Assumption
wa= # Weighed Assumption
while true; do
    [ "${fa:0:1}" = "/" ] && wa=$0 && break
    [ "${fa:0:2}" = "./" ] && ta="${ORIGINAL_DIR}/${fa:2}" && [ -e "$ta" ] && wa="$ta" && break
    ta="${ORIGINAL_DIR}/${fa}" && [ -e "$ta" ] && wa="$ta" && break
done
SW="$wa"
SWDIR="$(dirname "$wa")"
SWBIN="$(basename "$wa")"
unset ta fa wa
( [ ! -e "$SWDIR/$SWBIN" ] || [ -z "$SW" ] ) && echo "I could not find my way around :( possible bug in the TOP script" && exit 1 
```

At this point, your variables SW, SWDIR, and SWBIN contain what you need.

* * *

## 回答 #67

> 赞同：-3
> 
> 时间：2009-02-12T15:06:33.450

我想确保脚本在其目录中运行。所以

```
cd $(dirname $(which $0) ) 
```

在此之后，如果您真的想知道您正在运行的位置，请运行以下命令。

```
DIR=$(/usr/bin/pwd) 
```

* * *

## 回答 #68

> 赞同：-3
> 
> 时间：2017-02-03T13:57:28.917

This *one-liner* works on [Cygwin](https://en.wikipedia.org/wiki/Cygwin) even if the script has been called from *Windows* with `bash -c <script>`:

```
set mydir="$(cygpath "$(dirname "$0")")" 
```

* * *

## 回答 #69

> 赞同：-3
> 
> 时间：2019-05-07T22:06:25.190

There is no 100% portable and reliable way to request a path to a current script directory. Especially between different backends like [Cygwin](https://en.wikipedia.org/wiki/Cygwin), [MinGW](https://en.wikipedia.org/wiki/MinGW), [MSYS](https://en.wikipedia.org/wiki/MinGW#History), Linux, etc. This issue was not properly and completely resolved in Bash for ages.

For example, this could not be resolved if you want to request the path after the `source` command to make nested inclusion of another Bash script which is in turn use the same `source` command to include another Bash script and so on.

In case of the [`source`](https://linux.die.net/man/1/source) command, I suggest to replace the `source` command with something like this:

```
function include()
{
  if [[ -n "$CURRENT_SCRIPT_DIR" ]]; then
    local dir_path=... get directory from `CURRENT_SCRIPT_DIR/$1`, depends if $1 is absolute path or relative ...
    local include_file_path=...
  else
    local dir_path=... request the directory from the "$1" argument using one of answered here methods...
    local include_file_path=...
  fi
  ... push $CURRENT_SCRIPT_DIR in to stack ...
  export CURRENT_SCRIPT_DIR=... export current script directory using $dir_path ...
  source "$include_file_path"
  ... pop $CURRENT_SCRIPT_DIR from stack ...
} 
```

From now on, the use of `include(...)` is based on previous `CURRENT_SCRIPT_DIR` in your script.

This only works when you can replace all `source` commands by `include` command. If you can't, then you have no choice. At least until developers of the Bash interpreter make an explicit command to request the current running script directory path.

My own closest implementation to this: [https://sourceforge.net/p/tacklelib/tacklelib/HEAD/tree/trunk/bash/tacklelib/bash_tacklelib](https://sourceforge.net/p/tacklelib/tacklelib/HEAD/tree/trunk/bash/tacklelib/bash_tacklelib)
[https://github.com/andry81/tacklelib/tree/trunk/bash/tacklelib/bash_tacklelib](https://github.com/andry81/tacklelib/tree/trunk/bash/tacklelib/bash_tacklelib)

(search for the `tkl_include` function)

* * *

## 回答 #70

> 赞同：-5
> 
> 时间：2019-01-10T16:33:48.727

The [chosen answer](https://stackoverflow.com/questions/59895/how-can-i-get-the-source-directory-of-a-bash-script-from-within-the-script-itsel/246128#246128) works very well. I'm posting my solution for anyone looking for shorter alternatives that still addresses sourcing, executing, full paths, relative paths, and symlinks. Finally, this will work on [macOS](https://en.wikipedia.org/wiki/MacOS), given that it cannot be assumed that GNU's coreutils' version of [readlink](https://linux.die.net/man/1/readlink) is available.

The gotcha is that it's not using Bash, but it is easy to use in a Bash script. While the OP did not place any constraints on the language of the solution, it's probably best that most have stayed within the Bash world. This is just an alternative, and possibly an unpopular one.

PHP is available on macOS by default, and installed on a number of other platforms, though not necessarily by default. I realize this is a shortcoming, but I'll leave this here for any people coming from search engines, anyway.

```
export SOURCE_DIRECTORY="$(php -r 'echo dirname(realpath($argv[1]));' -- "${BASH_SOURCE[0]}")" 
```

* * *

## 回答 #71

> 赞同：-6
> 
> 时间：2020-02-24T17:58:05.090

Keep it simple.

```
#!/usr/bin/env bash
sourceDir=`pwd`
echo $sourceDir 
```

* * *

## 回答 #72

> 赞同：-7
> 
> 时间：2014-11-14T16:35:04.463

```
FOLDERNAME=${PWD##*/} 
```

That is the quickest way I know.

# javascript - 如何在 jQuery 中停止效果

> ID：59896
> 
> 赞同：13
> 
> 时间：2008-09-12T20:40:00.213
> 
> 标签：javascript, jquery

我有一个页面使用

```
$(id).show("highlight", {}, 2000); 
```

在我启动 ajax 请求时突出显示一个元素，这可能会失败，所以我想使用类似的东西

```
$(id).show("highlight", {color: "#FF0000"}, 2000); 
```

在错误处理程序中。问题是，如果第一个亮点还没有完成，第二个会被放入队列中，直到第一个准备好后才会运行。因此，问题是：我能以某种方式阻止第一个效果吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-23T12:42:32.797

**我将此列为已接受答案的评论，但我认为将其作为独立答案发布是个好主意，因为它似乎可以帮助一些遇到问题的人`.stop()`**

* * *

仅供参考 - 我也在寻找这个答案（试图停止脉冲效应），但我的`.stop()`代码中确实有一个。

查看文档后，我需要`.stop(true, true)`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-12T20:42:48.133

来自 jQuery 文档：

[http://docs.jquery.com/Effects/stop](http://docs.jquery.com/Effects/stop)

> *停止匹配元素上当前正在运行的动画。*...
> 
> 当`.stop()`在元素上调用时，当前正在运行的动画（如果有）会立即停止。例如，如果在调用`.slideUp()`when 时隐藏了一个元素`.stop()`，则该元素现在仍将显示，但将是其先前高度的一小部分。不调用回调函数。
> 
> 如果在同一个元素上调用了多个动画方法，则后面的动画将放置在该元素的效果队列中。在第一个动画完成之前，这些动画不会开始。当`.stop()`被调用时，队列中的下一个动画立即开始。如果`clearQueue`参数的值为`true`，则队列中的其余动画将被删除并且永远不会运行。
> 
> 如果`jumpToEnd`参数的值为 true，则当前动画停止，但元素会立即为每个 CSS 属性赋予其目标值。在我们上面的`.slideUp()`示例中，该元素将立即被隐藏。然后立即调用回调函数，如果提供...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-22T11:10:42.407

**.stop(true,true)**将冻结效果，因此如果它当时不可见，则它仍然不可见。如果您使用脉动效应，这可能是个问题。

```
$('#identifier').effect("pulsate", {times:5}, 1000); 
```

为了解决这个问题，我添加了

```
$('#identifier').stop(true, true).effect("pulsate", { times: 1 }, 1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-20T08:26:55.097

就我而言，使用以下代码不起作用并保持不透明度值保持不变：

```
$('#identifier').stop(true, true).effect("pulsate", { times: 1 }, 1); 
```

对我来说，只需删除不透明度即可：

```
$('#identifier').stop(true, true).css('opacity',''); 
```

# asp.net - SQL Server 2005 加密、asp.net 和存储过程

> ID：59926
> 
> 赞同：6
> 
> 时间：2008-09-12T20:51:38.860
> 
> 标签：asp.net, sql-server-2005, encryption

我需要使用 SQL Server 2005、asp.net 和 ado.net 编写一个 Web 应用程序。此应用程序中存储的大部分用户数据都必须加密（读取 HIPAA）。

过去对于需要加密的项目，我在应用程序代码中加密/解密。但是，这通常用于加密密码或信用卡信息，因此在几个表中只有少数列。对于这个应用程序，多个表中的更多列需要加密，因此我怀疑将加密职责推入数据层会更好，特别是考虑到 SQL Server 2005 对多种加密类型的本机支持。（如果有人有真实的经验证据，我可能会被说服。）

我咨询过 BOL，我相当擅长使用 google。所以我不想要在线文章或 MSDN 文档的链接（我可能已经阅读过它）。

到目前为止，我已经想到的一种方法是使用使用证书打开的对称密钥。

所以一次性设置步骤是（理论上由 DBA 执行）：

1.  创建主密钥
2.  将主密钥备份到文件，刻录到 CD 并在异地存储。
3.  打开主密钥并创建证书。
4.  将证书备份到文件，刻录到 CD 并异地存储。
5.  使用证书创建具有所选加密算法的对称密钥。

然后，每当存储过程（或通过 Management Studio 的人类用户）需要访问加密数据时，您必须首先打开对称密钥，执行任何 tsql 语句或批处理，然后关闭对称密钥。

然后就 asp.net 应用程序而言，在我的例子中是应用程序代码的数据访问层，数据加密是完全透明的。

所以我的问题是：

1.  我是否要打开、执行 tsql 语句/批处理，然后关闭存储过程中的所有对称密钥？我看到的危险是，如果 tsql 执行出现问题怎么办，并且代码 sproc 执行永远不会到达关闭密钥的语句。我假设这意味着密钥将保持打开状态，直到 sql 杀死 sproc 执行的 SPID。

2.  我是否应该考虑对我需要执行的任何给定过程进行三个数据库调用（仅在需要加密时）？一次数据库调用打开密钥，第二次调用执行存储过程，第三次调用关闭密钥。（每个调用都包含在自己的 try catch 循环中，以最大化打开密钥最终关闭的几率。）

3.  我需要使用客户端事务（意味着我的代码是客户端，并启动事务，执行几个 sproc，然后假设成功提交事务）有什么注意事项吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-12T22:41:47.177

1) 考虑在 SQL 2005 中使用 TRY..CATCH。不幸的是，没有 FINALLY，因此您必须分别处理成功和错误情况。

2) 如果 (1) 处理清理，则不需要。

3) SQL Server 的客户端和服务器事务之间没有真正的区别。Connection.BeginTransaction() 或多或少在服务器上执行“BEGIN TRANSACTION”（System.Transactions/TransactionScope 也是如此，直到它被提升为分布式事务）。至于在事务中多次打开/关闭密钥的问题，我不知道有什么需要注意的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-13T07:04:49.230

我是选项 3 的忠实粉丝。

假装你要在任何地方建立交易基础设施：

1.  如果现有事务尚未启动，则每当要调用数据存储时，就会创建一个。
2.  如果事务已经到位，则调用数据存储挂钩到该事务。这对于保存/进入数据库事件引发的业务规则通常很有用。IE。如果您有一条规则，即每当您出售一个小部件时，您需要更新一个 WidgetAudit 表，您可能希望将小部件审计插入调用包装在与告诉数据存储小部件已售出的事务相同的事务中。
3.  每当数据存储的原始调用者（来自步骤 1）完成时，它都会提交/回滚事务，这会影响在其调用期间发生的所有数据库操作（使用 try/catch/finally）。

一旦创建了这种类型的交易，那么在开始时（当交易打开时）添加打开的密钥并在结束时（就在交易结束之前）关闭密钥变得很简单。对数据存储进行“调用”并不像打开与数据库的连接一样昂贵。确实是像 SQLConnection.Open() 这样的东西会消耗资源（即使 ADO.NET 正在为您汇集它们）。

如果您想要这些类型代码的示例，我会考虑查看 NetTiers。它为我们刚刚描述的事务提供了一个非常优雅的解决方案（假设您还没有想到什么）。

只需2美分。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T22:10:42.900

1.  您可以使用@@error 查看在调用 SQL 中的存储过程期间是否发生任何错误。

2.  不复杂。

3.  你可以，但我更喜欢在 SQL Server 本身中使用事务。

# web-services - 国庆节网络服务

> ID：59934
> 
> 赞同：19
> 
> 时间：2008-09-12T20:55:32.953
> 
> 标签：web-services, egovernment

是否有公共/政府网络服务可以让我了解特定年份的国定假日是什么？（对于美国和/或世界上的任何国家。）

编辑：有人有一套计算美国假期的公式吗？（如果可以选择，C# 将是我的首选语言。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-16T05:43:30.250

你可以试试[http://kayaposoft.com/enrico/](http://kayaposoft.com/enrico/)。Enrico Service 是一项免费服务，为包括美国在内的多个国家/地区提供公共假期。美国或德国等国家的公共假期分别为每个州提供。您可以使用 Web 服务或 json 从 Enrico 获取公共假期。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-12T22:17:58.387

[http://www.holidaywebservice.com](http://www.holidaywebservice.com)上有一个网络服务，它将提供美国、爱尔兰共和国、英格兰和苏格兰的假期日期。他们还出售 DLL 和源代码。

至于算法的细节，你可能比查看优秀的[日历计算](https://rads.stackoverflow.com/amzn/click/com/0521702380)书（第三版）更糟糕，这是一本非常吸引人的读物，包括日历算法的示例 LISP 代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-12T23:13:28.660

您可以订阅在线日历。例如，谷歌提供美国假期：

[ICAL](http://www.google.com/calendar/ical/usa__en%40holiday.calendar.google.com/public/basic.ics) [HTML](http://www.google.com/calendar/embed?src=usa__en%40holiday.calendar.google.com&ctz=America/Los_Angeles)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-25T20:45:13.890

政府网络服务确实应该提供大量类似的信息。如果美国政府可以通过网络服务提供这样的信息，从长远来看肯定会节省很多钱和错误。哎呀，即使是可下载、可解析的格式，也是朝着正确方向迈出的一大步。

我在寻找一种方法来确保应用程序在工作日计算中跳过所有美国联邦假期时遇到了这个问题。我发现的最好的 .gov 来源是：

[OPM 的运行状态计划](https://www.opm.gov/policy-data-oversight/snow-dismissal-procedures/federal-holidays/)

这包含我们需要到 2020 年的数据，但我们必须将其输入到我们自己的表格中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-12T20:57:14.790

没有人免费放弃这一点（世界上任何国家？变得真实）。最好的来源是 Copp Clark（我不隶属于）。它们为按金融市场、货币等划分的所有国家/地区提供所有假期。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-12T22:00:12.813

可能需要进行一些解析，并且不是 100% 完成，但您可以使用[wikipedia](http://en.wikipedia.org/wiki/List_of_holidays_by_country)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-12T22:16:08.313

对于计算美国假期的方法/组件，基本上只需弄清楚所有主要假期和他们使用的“公式”。

对于那些永远不会改变的人，比如圣诞节，这很容易——12 月 25 日。

对于那些确实有所改变的人，通常有一个公式——比如二月的第三个星期一是总统日。您可以让该方法在给定的一年中解决这个问题。

这不适用于没有任何特定模式的假期（即，某些委员会决定每年的日期），但对于所有主要的假期，都有容易辨别的公式。

这实际上是测试驱动设计的绝佳候选者。您将知道特定年份的所有主要假期日期，因此您应该能够将该年份输入该方法并获得正确的答案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-12-01T19:09:07.490

我正在寻找类似的基于 PL/SQL 的东西。我找到了 jollyday (sourceforge)。它是 java 也许您可以将它与 c# 中的 ikvm 一起使用。遗憾的是，我无法将 java api 加载到我的 oracle rdbms 中……所以……如果您遇到纯 C 或 PL/SQL 解决方案，请告诉我 :-)

干杯克里斯

# java - 在不改变音高的情况下减慢音频文件的播放速度？

> ID：59936
> 
> 赞同：11
> 
> 时间：2008-09-12T20:56:53.700
> 
> 标签：java, audio, media

我正在申请大学音乐专业。我正在考虑的一个功能是在不改变音高的情况下减慢音乐播放速度。我已经在商业软件中看到了这一点，但找不到任何类似的库或开源应用程序。

1.  那里有图书馆吗？
2.  如何从各种文件格式从头开始完成这项工作？

注意：我在 java 中工作，但不反对改变语言。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-12T21:12:42.443

时间延长是相当困难的。您越减慢或加快声音的速度，您获得的伪影就越多。如果你想知道它们听起来像什么，请听 Fat Boy Slim 的“The Rockafeller Skank”。有很多方法可以做到这一点，它们都有自己的长处和短处。数学会变得非常复杂。这就是为什么有这么多专有算法的原因。

这个页面比我能解释的更清楚一些，并链接到 Dirac 库。 [http://www.dspdimension.com/admin/time-pitch-overview/](http://www.dspdimension.com/admin/time-pitch-overview/)

我找到了这个用于进行音高转换/时间拉伸的 Java 代码链接 [http://www.adetorres.com/keychanger/KeyChangerReadme.html](http://web.archive.org/web/20081103052639/http://www.adetorres.com/keychanger/KeyChangerReadme.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-12T21:17:16.397

我使用[soundstretch](http://www.iki.fi/oparviai/soundtouch)来加快播客的速度，效果很好，但还没有在音乐上尝试过。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-12T21:14:35.997

该站点解释了它是如何在物理世界中完成的： [http://www.wendycarlos.com/other/Eltro-1967/index.html](http://www.wendycarlos.com/other/Eltro-1967/index.html)

我不知道你会如何在软件中模拟它......我会继续寻找

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-22T02:19:40.700

一种方法是在不改变源的采样率的情况下将采样率加倍。（低质量示例，但易于实现。注意：您也可以降低采样率）。

查看任何与相位声码器相关的数学。

另一种常见的方法是创建一个 fft bin 数组，用于存储预定声音间隔的数据。然后，您可以选择迭代箱的速度，并且您可以根据您的选择重新合成该音频数据，从而使您可以根据需要延长声音的一小段。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-22T02:50:12.917

Audacity 开箱即用，而且是免费的。还有几个免费的 mp3 播放器插件。显然，使用 mp3 很容易做到，因为它已经在频域中编码。

# terminology - 数据访问层的目的是什么？

> ID：59942
> 
> 赞同：25
> 
> 时间：2008-09-12T20:59:42.507
> 
> 标签：terminology, data-access-layer

我很久以前开始了一个项目，并在我的解决方案中创建了一个**数据访问层**项目，但从未在其中开发过任何东西。数据访问层的目的是什么？有什么好的资源可以让我了解更多关于数据访问层的信息吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-12T21:04:49.500

简而言之：[松散耦合](http://en.wikipedia.org/wiki/Loose_coupling)

将用于从数据存储（数据库、平面文件、Web 服务等）中提取数据的代码与业务逻辑和表示代码分开。这样，如果您必须更改数据存储，您最终不会重写整个事情。

如今，各种 ORM 框架都在将 DAL 与其他层混合在一起。这通常会使开发更容易，但更改数据存储可能会很痛苦。公平地说，像这样更改数据存储是非常少见的。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2010-11-21T09:22:11.023

数据访问层有两个主要用途

1.  抽象实际的数据库引擎或其他数据存储，以便您的应用程序可以从使用 Oracle 切换到使用 MS SQL 服务器

2.  抽象逻辑数据模型，使您的业务层与这些知识分离并且不知道它。使您能够在不影响业务层的情况下修改逻辑数据模型

这里的大多数答案都提供了第一个原因。在我看来，第二个更重要。本质上，您的业务层不应该知道正在使用的逻辑数据模型。今天，使用 ORM 和 Linq #2 似乎已经消失了，人们往往会忘记（或者无法看到确实存在并且应该存在的细线）关于 #2。

本质上，为了更好地理解数据层的目的和功能，您需要从业务层的角度来看待事物，记住业务层应该与数据存储的逻辑数据模型无关。

因此，例如，每次业务层需要数据时，如果应该以一种非常简单的与逻辑数据模型无关的方式来请求它需要的数据。所以它会调用数据访问层，例如：

```
GetOrdersForCustomer(42) 
```

它准确地返回它需要的数据，而不知道哪些表存储了这些信息或存在关系等。

我在我的博客上写了一篇文章，介绍了更多细节。

[数据访问层的目的和功能](http://www.matlus.com/the-purpose-and-function-of-a-data-access-layer/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-12T21:03:13.327

数据访问层遵循“关注点分离”的理念，即业务逻辑与数据层（数据库）交互所需的所有逻辑都被隔离到一组类（层）中。这使您可以更轻松地更改后端物理数据存储技术（例如，从 XML 文件移动到数据库，或从 SQL Server 移动到 Oracle 或 MySQL），而不会对您的商业逻辑。

有很多工具可以帮助您构建数据层。如果您搜索短语“对象关系映射器”或“ORM”，您应该会找到一些更详细的信息。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-12T21:11:36.300

当应用程序的许多不同部分需要以相同的方式访问数据时，数据访问层非常有意义。

当您需要以多种不同方式访问相同数据时，这也很有意义。例如，文字处理器如何读取许多不同的文件类型并将它们静默转换为应用程序的内部格式。

请记住，DAL 也可能适得其反。如果您正在构建一个数据访问性能至关重要的系统，那么将其与业务逻辑分开可能会使一些重要的优化变得不可能。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-12T21:04:26.957

DAL 应该从项目的其余部分中抽象出您的数据库——基本上，除了 DAL 之外的任何代码中都不应该有任何 SQL，并且只有 DAL 应该知道数据库的结构。

目的主要是为了使您的应用程序的其余部分与数据库更改隔离，并使其更容易扩展和支持您的应用程序，因为您将始终知道去哪里修改数据库交互代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-12T21:05:41.993

目的是抽象出应用程序的其他部分不需要关心的数据库访问细节。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-12T21:05:52.913

数据访问层用于从其表示中抽象出数据的存储和检索。[您可以在 1994 年的设计模式](https://rads.stackoverflow.com/amzn/click/com/0201633612)中阅读更多关于这种抽象的信息

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-12T21:06:50.493

目的是从数据使用和操作中抽象出数据存储检索机制。

好处：

*   底层存储可能会发生变化（例如从 Oracle 切换到 MSSQL），您需要一种方法来本地化这些更改
*   架构更改 - 见上文
*   您想要一种与数据库断开连接的运行方式（演示模式）：将文件序列化/反序列化添加到 DAL

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-12T21:02:37.430

我建议您在此处阅读：http: [//msdn.microsoft.com/en-us/practices/default.aspx](http://msdn.microsoft.com/en-us/practices/default.aspx) 使用 DAL 将帮助您将数据访问与演示和业务逻辑隔离开来。我经常使用它，以便我可以轻松地换出（通过反射和动态加载程序集）数据提供者。

阅读，那里有很多很好的信息。

此外，如果您打算使用 .NET ，请查看[数据访问块。](http://msdn.microsoft.com/en-us/library/cc511547.aspx)这可能是一个很大的帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-05-13T23:36:06.997

我想我要补充的一个尚未提出的事情是，拥有 DAL 可以提高系统的安全性。例如，数据库和 DAL 可以在公众无法访问的服务器上运行，而业务逻辑可以在面向公众的服务器上运行，这样公共服务器就不能在数据库上运行原始 SQL。如果公共服务器受到损害，这可以帮助减轻很多损害。

# apache-flex - 从 Flex 3 安全地访问 .NET Web 服务

> ID：59945
> 
> 赞同：3
> 
> 时间：2008-09-12T21:01:37.090
> 
> 标签：apache-flex, actionscript-3, web-services, actionscript

我们可以从 Flex/AS3 应用程序成功使用 .NET 2.0 Web 服务。除了 SSL，我们还能如何使安全性更健壮（即身份验证）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-12T21:26:34.423

你可以利用 ASP.Net 的内置会话管理来装饰你的 webmethods

> `<EnableSession()>`

然后，在您的方法中，您可以检查用户是否仍然具有有效会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T18:29:33.547

您应该能够使用 asp.net 的身份验证（例如表单身份验证）而无需付出太多额外的努力。保护 asmx 文件就像保护 aspx 文件一样。那里有大量关于表单身份验证的信息，只需搜索“asp.net forms authentication”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T22:11:47.640

如果您正在谈论**保护**通过线路传输的信息，您可以使用 Web 服务扩展 (WSE) 来加密 soap 消息的正文，这样您就不必保护通道。这样，消息可以从多个端点传递（即可以转发），并且您不需要多个 https 证书。

如果您正在谈论**autentication**，那么您可以使用正文或soap标头中的密码进行表单身份验证（再次加密正文或通道）。或者，保护 web 服务（如果它是一组内部服务）的最简单方法之一是让 IIS 执行此操作，打开 NTLM 并在那里进行身份验证。您可以稍后在管道中使用 HTTPModule 进行授权，该模块根据他们尝试调用的代码检查人们的凭据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T20:26:12.063

考虑使用 WebOrb 与您的服务进行通信。这是有关[WebOrb 身份验证机制的](http://www.themidnightcoders.com/doc20/security/authentication.htm)一些信息。Adobe 的开发者网站上还有[一篇关于使用 WebOrb 和 .Net 进行身份验证](http://www.adobe.com/devnet/flex/articles/net_security.html)的文章。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-09T17:51:56.420

如果您使用 Microsoft 技术，您可以构建一个小的 Asp.Net/C# 应用程序，该应用程序会在重定向到正确的 swf 之前要求提供凭据。

这样，您可以限制访问并根据用户使用不同的 swf 文件。

# asp.net - ASP 服务器变量在本地 IIS 上不起作用

> ID：59951
> 
> 赞同：0
> 
> 时间：2008-09-12T21:03:39.737
> 
> 标签：asp.net, iis, server-variables

我正在处理一个简单的 ASP.Net 页面（实际上是处理程序），在其中检查 LOGON_USER 服务器变量的值。这可以使用 Visual Studio 的内置 Web 服务器工作，并且可以在部署到实时 Intranet 站点的其他站点中工作。但它不适用于我本地 XP 机器上的 IIS 实例。我该如何解决它，或者如果我不能解决它会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-12T21:13:13.300

您在 IIS 中启用了哪些身份验证？匿名、基本、摘要、集成 Windows？在我看来，匿名访问已启用/允许，仅此而已。这意味着 LOGON_USER 未填充。

当您访问本地 IIS 时，请尝试使用[http://127.0.0.1](http://127.0.0.1)，特别是如果您使用 IE。IE 会将“localhost”识别为您的本地受信任区域，并在启用集成 Windows 身份验证时自动传递您的 XP 登录凭据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T14:10:04.790

除了 Jon 的回答之外，IIRC 即使您启用了集成身份验证，如果启用了匿名身份验证，它将优先...

# wpf - WPF - BitmapEffect 上的编程绑定

> ID：59958
> 
> 赞同：5
> 
> 时间：2008-09-12T21:05:46.253
> 
> 标签：wpf, data-binding, bitmapeffect

我希望能够以**编程方式将一些数据绑定到****BitmapEffect**上的依赖属性。使用像 TextBlock 这样的 FrameworkElement 有一个 SetBinding 方法，您可以在其中以编程方式执行这些绑定，例如：

```
myTextBlock.SetBinding(TextBlock.TextProperty, new Binding("SomeProperty")); 
```

而且我知道您可以直接使用 XAML（如下所示）

```
<TextBlock Width="Auto" Text="Some Content" x:Name="MyTextBlock" TextWrapping="Wrap" >
    <TextBlock.BitmapEffect>
        <BitmapEffectGroup>
            <OuterGlowBitmapEffect x:Name="MyGlow" GlowColor="White" GlowSize="{Binding Path=MyValue}" />
        </BitmapEffectGroup>
    </TextBlock.BitmapEffect>
</TextBlock> 
```

但我不知道如何使用 C# 来完成此操作，因为 BitmapEffect 没有 SetBinding 方法。

我试过了：

```
myTextBlock.SetBinding(OuterGlowBitmapEffect.GlowSize, new Binding("SomeProperty") { Source = someObject }); 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-13T09:16:15.607

您可以使用[BindingOperation.SetBinding](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingoperations.setbinding.aspx)：

```
Binding newBinding = new Binding();
newBinding.ElementName = "SomeObject";
newBinding.Path = new PropertyPath(SomeObjectType.SomeProperty);
BindingOperations.SetBinding(MyGlow, OuterGlowBitmapEffect.GlowSizeProperty, newBinding); 
```

我认为这应该做你想要的。

# orm - 老式 SQL DB 访问与 ORM（NHibernate、EF 等）。谁赢？

> ID：59972
> 
> 赞同：4
> 
> 时间：2008-09-12T21:10:42.793
> 
> 标签：orm, ado.net

我已经成功地编写了自己的 SQL 访问代码，并结合了存储过程和参数化查询以及我编写的一个小包装库，以最大限度地减少 ADO.NET 垃圾。过去，这一切对我来说都非常有效，而且我的工作效率很高。

我正在着手一个新项目——我应该把我的旧学校的东西抛在脑后，深入研究一个基于 ORM 的解决方案吗？（我知道 NHibernate 和 EF 之间存在巨大的高概念差异——我不想在这里讨论。为了争论，我们甚至将 LINQ 与老式替代方案混为一谈。）我正在寻找根据我所知道的（并且非常了解），就 ORM 类型的实际应用提出建议。

老式 ADO.NET 代码还是 ORM？我确定有一条曲线——这条曲线是否有让事情变得有价值的投资回报率？我很焦虑并愿意学习，但确实有截止日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-12T21:15:34.857

当我对代码进行原型设计时，我发现 LINQ to SQL 的速度要快得多。当我现在需要一些东西时，它只会吹走任何其他方法。

但这是有代价的。与手动存储过程相比，LINQ 很慢。特别是如果您不是很小心，因为看似微小的更改可能会突然变成 1+N 查询。

我的建议。首先使用 LINQ to SQL，如果您没有获得所需的性能，然后切换到 procs。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T21:19:30.760

一个很好的问题，但一个非常有争议的话题。

几年前[Frans Bouma 的这篇博客文章引用了动态 SQL（暗示 ORM）优于存储过程的优点，引发了激烈的火焰战争。](http://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T21:25:14.927

在蒙特利尔的 DevTeach 上就这个话题进行了精彩的讨论。如果您访问以下 URL：[http](http://www.dotnetrocks.com/default.aspx?showNum=240) ://www.dotnetrocks.com/default.aspx?showNum= 240，您将能够听到该领域的两位专家（Ted Neward 和 Oren Eini）讨论每种方法的优缺点. 对于没有真正明确答案的主题，您可能会找到最好的答案。

# database-design - 实施大型系统变更

> ID：59974
> 
> 赞同：3
> 
> 时间：2008-09-12T21:11:14.773
> 
> 标签：database-design, testing, architecture, deployment

如果您熟悉“建造一个扔掉”这个短语，那么我们似乎已经做到了；我们正在达到我们在线应用程序版本 1 的限制。是时候清理一下了：

*   重新组织代码和 UI
*   统一 UI 流程
*   添加更多功能
*   为未来而建
*   修改我们的数据库结构以处理上述所有问题

实现这种转变的最佳方式是什么？

我们希望避免将所有用户都扔给一个新系统（一旦完成）......他们会吓坏了，我们无法处理呼叫负载。我们的用户涵盖范围广泛，从技术熟练的用于编写软件的类型到那些不知道 HTML 是什么的用户。

在我们确保这个新设计充分解决了版本 1 的足够问题之后，我们是否应该开始一个新的系统“安装”并逐渐将用户转移到它？

我们是否应该（以某种方式）逐步更改系统的每个模块并进行阶段化？这可能很困难，因为数据库布局会发生变化，导致必须调整“核心代码”和几个周围模块的代码。

拥有一组使用尖端版本的应用程序的受信任、耐心、“beta 测试员”客户是否很常见？（这里的目标是获得反馈并测试新系统上的错误）

还有什么建议吗？第一手经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-12T21:26:24.283

恐怕答案取决于情况。这取决于应用程序的类型和您拥有的用户类型。在不知道系统是什么以及版本更改的范围的情况下，很难提供答案。

也就是说，有一些经验法则。

首先，避免大爆炸。任何系统的启动都会出现问题。该行业充斥着人们认为轰轰烈烈的发射是个好主意的项目，只是因为出现问题而使发射陷入困境。[Cuil](http://en.wikipedia.org/wiki/Anna_Patterson)是近期大爆炸发射的一个备受瞩目的因果关系。

为了使初期问题易于管理，您首先需要与少量用户合作，然后慢慢增加用户数量。

其次，你绝对必须积极做的事情就是*把用户放在第一位*。用户应该做尽可能少的工作来使用系统的 V2。理想的工作量为零。

这意味着，如果您选择将用户从一个系统缓慢迁移到另一个系统，*您*有责任确保迁移他们的所有数据和设置。例如，不要做任何愚蠢的事情，比如告诉用户他们必须对 12/09/2008 之前的所有记录使用 V1，对之后的所有记录使用 V2。

发布 V2 的目的应该是让用户的生活更轻松，而不是让它变得不必要地变得更加困难。

第三，有一个测试程序。这甚至适用于 Intranet 应用程序。开发应用程序很像 Newton-Raphson 的求多项式根的方法。您猜测用户想要什么，将其交付给用户，用户提供反馈，并且每次迭代都会缓慢但肯定地使您更接近问题的解决方案。

一个 beta 程序将帮助您更快地找到根源，而不是仅仅将新版本强加给人们而没有时间让他们对更改发表评论。Beta 有助于让您的用户更早地加入进来，并让他们感到参与到流程中；其中的重要性我怎么强调都不为过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-12T21:16:20.377

我们刚刚为我们的用户完成了一个全新的 CRM 系统，让我告诉你，这样做是一个可怕的想法：这对我的团队和我们的客户来说都是非常痛苦的。

我会尽一切可能进行逐步发布，即使这意味着做更多的工作。您将心存感激，因为您不必费尽心机就可以让所有东西都动起来，而且您的客户会很欣赏能够一次次了解产品的能力。

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-12T21:45:22.973

我同意[Esteban](https://stackoverflow.com/questions/59974/implementing-large-system-changes#59985)的观点，即逐步发布是最好的。这就像改建一所房子：一开始，把它搞定似乎是个好主意。但这意味着你必须提前计划好一切，雇佣一堆承包商然后搬出去。然后计划中的某些变化或承包商消失了，您希望节省的所有时间都消失了。同时，渐进式的变化让每个人都有机会在步骤之间停下来思考。有时，当早期更改的效果比您计划的要好时，您可以避免以后的更改。

我在一个存在巨大扩展问题的系统上工作。我们列出了我们认为需要的所有更改，并根据可能的影响对它们进行了优先排序。然后我们开始一次进行一项更改。大约在列表进行到一半时，我们发现我们已经解决了缩放问题。我仍然有清单，但我可能永远不需要完成它。我可以自由添加功能并解决其他问题。

当然，有时最好硬着头皮把整个事情拆掉。但这比人们倾向于相信的要少得多。对于关键的操作系统，“拆除”决定可能是致命的。看看每个人都同意必须将其带入现代计算时代的大型政府项目，但不能这样做，因为一些重要的服务将会丢失。如果哲学是逐渐改变的，也许它们会一次一个地被现代化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T21:36:09.080

听起来**增量式重新架构**应该是您选择的敏捷流行语。

我从来没有在 Web 应用程序上做过，但我经历了一些相当激进的客户端应用程序更改，这些更改是逐步完成的。如果您预先花一点时间来确保以相当合理的方式对工作进行排序，那么它可以很好地工作。如果您还没有良好的重构辅助工具，那么对它们进行少量投资将非常有帮助。如果您使用的是 .NET，我个人可以推荐[jetBrains Resharper](http://www.jetbrains.com/resharper/index.html)，如果您是基于 Java 的，我相信 IntelliJ IDEA 包含类似的功能。

# c# - C#中的XML序列化

> ID：59986
> 
> 赞同：2
> 
> 时间：2008-09-12T21:16:26.727
> 
> 标签：c#, .net, serialization, interface

我有一个明确实现接口的简单类型。

```
public interface IMessageHeader
{
    string FromAddress { get; set; }
    string ToAddress   { get; set; }
}

[Serializable]
public class MessageHeader:IMessageHeader
{
  private string from;
  private string to;

  [XmlAttribute("From")]
  string IMessageHeade.FromAddress
  {
    get { return this.from;}
    set { this.from = value;}
  }

 [XmlAttribute("To")]
 string IMessageHeade.ToAddress
 {
    get { return this.to;}
    set { this.to = value;}
 }
} 
```

有没有办法序列化和反序列化 IMessageHeader 类型的对象？

尝试时出现以下错误

“无法序列化接口 IMessageHeader”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-12T21:51:58.543

你不能序列化 IMessageHeader 因为你不能做 Activator.CreateInstance(typeof(IMessageHeader)) 这是序列化在幕后要做的事情。你需要一个具体的类型。

你可以做 typeof(MessageHeader) 或者你可以说，有一个 MessageHeader 的实例并做

```
XmlSerializer serializer = new XmlSerializer(instance.GetType()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T21:20:33.410

不，因为序列化程序需要一个可以实例化的具体类。

给定以下代码：

```
XmlSerializer ser = new XmlSerializer(typeof(IMessageHeader));

IMessageHeader header = (IMessageHeader)ser.Deserialize(data); 
```

序列化器创建什么类以从 Deserialize() 返回？

理论上，可以序列化/反序列化接口，只是不能使用 XmlSerializer。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T21:21:39.350

尝试将 IXmlSerializable 添加到您的 IMessageHeader 声明中，尽管我认为这不会起作用。

据我回忆，.net xml 序列化程序仅适用于具有默认构造函数的具体类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T21:26:19.557

问题源于您无法反序列化接口但需要实例化具体类的事实。

XmlInclude 属性可用于告诉序列化程序哪些具体类实现了该接口。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-12T21:20:26.467

您可以创建一个实现 IMessageHeader 并继承 MarshalByRefObject 的抽象基类***********************